define("DS/LifecycleControls/EditPropDialog",["UWA/Class","DS/ApplicationFrame/Command"],function(e,t){"use strict";return t.extend({defaultIsTransient:!1,extraNotif:!1,mergeSupport:!0,init:function(e,t){this._parent(e,t),require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"]),this.editProp=null},beginExecute:function(){},_launchTransientWidget:function(e,t){window.top.performance.mark("end_EP_SelectionTreatment"),window.top.performance.mark("start_EP_TransientLoaded"),!0===window.top.isDebug&&console.log("Launch transient "+window.top.performance.now()),e.showWidget("ENOLCMT_AP","ENOVIA - Properties ",t,{mode:"panel",height:800,width:650})},launchProperties:function(e){window.top.performance.mark("start_EP_FullTime"),window.top.performance.mark("start_ExecuteAndLoadCommand");var t,n,i,o,s,a,l,r,d,c,u=[],h=[];if(null!=e.options&&(e.options,1)){if(null!=(u=e.options.arguments))for(let e=0;e<u.length;e++)void 0!==u[e].facets?h.push(u[e].facets):"true"==u[e].readOnly||"false"==u[e].readOnly?t=u[e].readOnly:void 0!==u[e].appId?n=u[e].appId:void 0!==u[e].multiselection?i=u[e].multiselection:void 0!==u[e].setCloseButton?o=u[e].setCloseButton:void 0!==u[e].setEditButton?s=u[e].setEditButton:void 0!==u[e].editMode?a=u[e].editMode:void 0!==u[e].extraNotif?l=u[e].extraNotif:void 0!==u[e].defaultFacetName?r=u[e].defaultFacetName:void 0!==u[e].infoForFacet?d=u[e].infoForFacet:void 0!==u[e].indexModeParameter&&(c=u[e].indexModeParameter);var m=e.options.infoForFacet;null!=m&&Object.keys(m).length>0&&(d=m);var f=e.options.indexModeParameter;null!=f&&(c=f)}if(widget&&"1"===widget.getValue("debug_me")){for(var g=[],p=window.top.performance.getEntriesByType("mark"),v=0;v<p.length;v++){var C=p[v].name,b=C.replace("start_","").replace("end_","");C!==b&&g.push(C)}g.forEach(function(e){window.top.performance.clearMarks(e)})}var y=this,S=!1;widget&&(widget.setValue("index_mode",!1),S=widget.getValue("index_mode")),require(["DS/WidgetServices/securityContextServices/SecurityContextServices","DS/EditPropWidget/models/EditPropModelMerge","DS/EditPropWidget/models/EditPropModel","DS/EditPropWidget/utils/EditPropUtils","DS/EditPropWidget/constants/ConstantsMapping","DS/EditPropWidget/ajaxRequests/ServicesAjaxRequests","DS/WidgetServices/WidgetServices","DS/TransientWidget/TransientWidget"],function(u,m,f,g,p,v,C,b){window.top.performance.mark("end_ExecuteAndLoadCommand"),window.top.performance.mark("start_EP_SelectionTreatment");var w=y.mergeSupport,x={context:e},D=[],I=[],_=e.model;_&&_.objectId?(_.tenant&&(x.tenant=_.tenant),_.source&&(x.source=_.source),I.push(new f(_))):D=e.getSelectedNodes(),u.getInstance(x).getSecurityContext(),D.length&&D.forEach(function(e){var t=g.getModelFromSelectedNode(e);t&&I.push(t)});var E=C.getWidgetValue("editProperties_readOnly");if(I.length>0){var A=I[0];w||(I=[A]),I=C.removeDuplicate(I,function(e){return e.get("objectId")});var L=y.defaultIsTransient;if("function"==typeof e.isTransient&&(L=e.isTransient()),!1!==(L=!0===L||C.isTransientWidget())||C.isWebInWinEnvironment()||C.isNatifEnvironnement())require(["DS/EditPropWidget/EditPropComponent","DS/EditPropWidget/constants/EditPropConstants"],function(t,n){if(null==y.editProp){var i=function(){},o=C.getWidgetPreference("editProperties_editMode");if(void 0===o){var s={type:"hidden",name:"editProperties_editMode",label:"editProperties_editMode",defaultValue:!1};C.addWidgetPreference(s)}o=!!o&&o.value;var a=!1;S?(a="true",o=!1):void 0!==E&&(a=E),c="true"===c||!0===c;var l=C.getWidgetBody();l=l||UWA.extend(document.body),y.editProp=new t({className:"editProp_popup_fromCmd",readOnly:a,editMode:o,context:e,displayType:n.POPUP,container:l,extraNotif:y.extraNotif,infoForFacet:d,indexModeParameter:c,events:{onCancel:function(){i&&(C.addWidgetResizeEvent(i),y.editProp.controller&&y.editProp.controller.skeleton&&"function"==typeof y.editProp.controller.skeleton.notifyClose&&y.editProp.controller.skeleton.notifyClose()),y.editProp=null}}}),y.editProp.show(I),C.removeWidgetResizeEvent(i)}else y.editProp.centerIt()});else{var k=function(u){var f=window.top.document.body.getElementsByClassName("preview-container")[0],g=!1;if(f){var w=f.getElement(".moduleContent");if(w)if(w.className.indexOf("EditPropWidget")>=0){g=!0,f.show();var x={};u&&(x.securityContext=u.SecurityContext),require(["DS/WidgetServices/commandProxy/CommandProxy"],function(e){e.publishUpdate(I,x)})}}if(!1===g){var D=null;I&&I.length>0&&(D=I[0]);var _=p.getServiceForModel(D),A=!(D&&!0===D.isTransient||!0===_.modelNeeded),L=[];I.forEach(function(e){L.push(e.toJSON())});x={SelectedItem:L,x3dPlatformId:v.getTenantFromModel(D),isTransient:"true",loadData:!0,asynchronousRequest:A,index_mode:C.getWidgetValue("index_mode"),parent_x3dAppId:widget.data.appId};if(u&&u.SecurityContext&&(x.securityContext=u.SecurityContext),void 0!==E&&(x.readOnly=E),S&&(x.readOnly=!0),A){var k=I.length>1;if(k){var N=C.generateUniqueId();x.transactionId=N;var M=I[0],W=UWA.clone(M.getOptions());W.objectId=N;var z={};I.forEach(function(e){z[e.get("objectId")]=e});var T=new m(W);T.setMergingModels(z),I=[T]}require(["DS/EditPropWidget/comm/DistantAjax","DS/EditPropWidget/constants/ConstantsMapping"],function(t,n){t.launchMainRead(I,x),t.getServices(x.x3dPlatformId),t.getRoles(x.x3dPlatformId);var i=n.getDefaultFacets(k,!0),o=[];i.forEach(function(e){if(e){var t=e;if(e.facet&&(t=e.facet.name),null!=h&&h.length>=1)for(let n=0;n<h.length;n++)t===h[n]&&o.push({name:t,inheritance:e.inheritance});else o.push({name:t,inheritance:e.inheritance})}});var s=null;I&&I.length>0&&(s=I[0]),t.launchFacetsVisibility(s,o,{context:e},!0)})}C.isChangeAvailable()?require(["DS/EditPropWidget/changeAction/passThruJS"],function(e){e.onReady(function(e){e.get2(function(u){"function"==typeof e.changeIsSetChecker&&(e.changeIsSetChecker(u)?x.changeControl=u:null!=u&&null!=u.configurationRevision&&(x.changeControl=u)),null!=t&&void 0!==t&&(x.readOnly=t),null!=n&&void 0!==n&&(x.appId=n),null!=i&&void 0!==i&&(x.multiselection=i),null!=o&&void 0!==o&&(x.setCloseButton=o),null!=s&&void 0!==s&&(x.setEditButton=s),null!=a&&void 0!==a&&(x.editMode=a),null!=l&&void 0!==l&&(x.extraNotif=l),null!=r&&void 0!==r&&(x.defaultFacetName=r),null!=d&&void 0!==d&&(x.infoForFacet=d),null!=c&&void 0!==c&&(x.indexModeParameter=c),y._launchTransientWidget(b,x)})})},function(){y._launchTransientWidget(b,x)}):y._launchTransientWidget(b,x)}};u.getSecurityContext({onSuccess:k,onFailure:function(){k(null)}})}}else y._setError(e,UWA.i18n("no content selected"));y.end()})},_setError:function(e,t){if("function"==typeof e.displayNotification){var n={eventID:"error",msg:t};e.displayNotification(n)}else alert(t)},endExecute:function(){}})}),define("DS/LifecycleControls/ProgressDialog",["UWA/Controls/Abstract","UWA/Core","DS/UIKIT/Mask","css!DS/LifecycleControls/LifecycleControls"],function(e,t,n){"use strict";return e.extend({showDelay:function(e,t,n){var i=this;this.timer=setTimeout(function(){i.timer=null,i._createProgress(e,t)},n)},close:function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.progressContainer&&(this.progressContainer.remove(),this.progressContainer=null)},_createProgress:function(e,i){this.progressContainer=t.createElement("div",{class:"lcm-progress-container"});var o=t.createElement("span",{class:"progress-icon-container"});o.inject(this.progressContainer);var s=t.createElement("div",{class:"progress-icon"});s.inject(o);var a=t.createElement("span",{class:"progress-msg"});a.innerHTML=i,a.inject(this.progressContainer),this.progressContainer.inject(e),n.mask(s,"");var l=this.progressContainer;this.progressContainer.remove=function(){e.removeChild(l)}}})}),define("DS/LifecycleControls/DelayedMask",["UWA/Controls/Abstract","DS/UIKIT/Mask"],function(e,t){"use strict";return e.extend({timer:null,element:null,init:function(e,n,i){if(e){this.element=e;var o=this;this.timer=setTimeout(function(){o.timer=null,t.mask(o.element,i)},n)}},unmask:function(){this.element&&(this.timer&&(clearTimeout(this.timer),this.timer=null),t.unmask(this.element),this.element=null)}})}),define("DS/LifecycleControls/CredentialList",["UWA/Controls/Abstract","DS/LifecycleServices/WebReq"],function(e,t){"use strict";const n=e=>e.reduce(function(e,t){return e.concat(Array.isArray(t)?n(t):t)},[]);return{loadCredentials:e=>new UWA.Class.Promise((i,o)=>{t.get("/resources/modeler/pno/person",{tenant:e,params:{current:"true",select:"collabspaces&select=preferredcredentials"}}).then(e=>i((e=>{let t=[];if(!UWA.is(e.collabspaces,"array"))return t;let i=[...new Set(n(e.collabspaces.map(e=>e.couples.map(e=>e.organization.name))))].length>1;return e.collabspaces.forEach(e=>{e.couples.forEach(n=>{var o=null==n.role.nls||""==n.role.nls?n.role.name:n.role.nls,s=n.role.name,a=n.organization.name,l=n.organization.title,r=e.name,d=e.title?e.title:e.name;let c=i?d+" ● "+l+" ● "+o:d+" ● "+o,u="ctx::"+s+"."+a+"."+r;t.push({displayName:c,ctx:u})})}),t.sort((e,t)=>e.displayName.localeCompare(t.displayName,void 0,{numeric:!0,sensitivity:"base"}))})(e)))}),filterCredentials:(e,n,i)=>new UWA.Class.Promise((o,s)=>{t.post("/resources/lifecycle/util/filterValidSCs",((e,t)=>{let n={Command:t,SecurityContexts:e.map(e=>e.ctx)};return JSON.stringify(n)})(n,i),{tenant:e}).then(e=>{e.status&&"success"===e.status?o((e=>e.filter(e=>!(e=>{let t=e.match(/(ctx::)([^.]+)/);return t.length>2&&"VPLMAdmin"===t[2]})(e)))(e.data)):s(e.error?e.error:"/resources/lifecycle/util/filterValidSCs - failed!")}).catch(s)})}}),define("DS/LifecycleControls/Assembly3DViewer",["UWA/Controls/Abstract","DS/LifecycleServices/LifecycleServicesSettings","UWA/Utils/InterCom","DS/Core/Events"],function(e,t,n,i){"use strict";return e.extend({init:function(e,t){var n=this;this._parent({}),this.isViewerReady=!1,this.lang=t,this.tenant=e,this.bufferedModels=null,this.bufferedActiveModel=null,this.pad3dViewerLoaded=!1,window.onPAD3DViewerLoaded=this.onPAD3DViewerLoaded;var o=Date.now().toString();this.id="assembly3dviewer_"+o,this.cmdQueue=[],this.listenFrameEvents(),this.buildUI(),this.onReadyCallback=null,this.onLoadCallback=null,this.onLoadFailCallback=null,i.subscribe({event:"ENOLifecycleSnapshotsHighlightOccurrencesInViewer"},function(e){n.postCommand("highlight",e)})},load:function(e){this.postCommand("load",e)},clear:function(){this.postCommand("clear")},destroy:function(){this.postCommand("destroy")},postCommand:function(e,t){var n={cmd:e,params:t};0==this.isViewerReady?this.cmdQueue.push(n):this.iframe.contentWindow.postMessage(n,"*")},buildUI:function(){this.iframe=UWA.createElement("iframe"),this.iframe.src=t.get3DSpaceWSUrl(this.tenant,"/webapps/LifecycleControls/Assembly3DViewerImpl.html","id="+this.id+"&lang="+widget.lang),this.iframe.className="CGRViewerWidget",this.iframe.width="100%",this.iframe.height="100%",this.iframe.style.border="0px",this.elements.container=this.iframe,this.htmlUnloaded=!0},onPAD3DViewerLoaded:function(){this.pad3dViewerLoaded=!0,this.loadBufferedModels(),this.showBufferedModel()},listenFrameEvents:function(){var e=this;window.addEventListener("message",function(t){var n=t.data,i=n.eventName,o=n.params;e.onEvent(i,o)},!1)},onEvent:function(e,t){switch(e){case"onSelect":this.onSelect(t);break;case"onReady":this.onReady();break;case"onHtmlLoad":this.onHtmlLoad();break;case"onHtmlUnload":this.onHtmlUnload();break;case"onLoad":null!=this.onLoadCallback&&this.onLoadCallback();break;case"onLoadFail":null!=this.onLoadFailCallback&&this.onLoadFailCallback()}},onHtmlLoad:function(){},onHtmlUnload:function(){this.htmlUnloaded=!0},onReady:function(){this.isViewerReady=!0;for(var e=this.cmdQueue.length,t=0;t<e;t++){var n=this.cmdQueue[t];this.iframe.contentWindow.postMessage(n,"*")}this.cmdQueue=[],null!=this.onReadyCallback&&this.onReadyCallback()},onSelect:function(e){console.log("Selected occurenceID List: "+e.toString()),i.publish({event:"ENOLifecycleSnapshotsSelectOccurrencesInTree",data:e})},loadBufferedModels:function(){1==this.pad3dViewerLoaded&&null!=this.iframe.contentWindow&&this.iframe.contentWindow.loadModels(this.bufferedModels)},showBufferedModel:function(){1==this.pad3dViewerLoaded&&null!=this.iframe.contentWindow&&this.iframe.contentWindow.showModel(this.bufferedActiveModel)}})}),define("DS/LifecycleControls/ChooseAttributes",["UWA/Class","UWA/Core","DS/UIKIT/SuperModal","i18n!DS/UIKIT/assets/nls/UIKIT","i18n!DS/LifecycleControls/assets/nls/CommandDialog","css!DS/LifecycleControls/assets/styles/LifecycleModals"],function(e,t,n,i,o,s){"use strict";return e.singleton({init:function(){this._parent({})},showDialog:function(e){var t=this,s=e.parent,a=e.title,l=e.allAttributes,r=e.onOk,d=e.onShow,c=new n({closable:!0,className:"Lifecycle_Modals",events:{onShow:function(){null!=d&&d(t)}},renderTo:s}),u=o.okButton,h=o.cancelButton,m=this.buildDialogBody(l);if(c.dialog({body:m,title:a,buttons:[{className:"primary",value:u,action:function(e){e.hide();var n=t.getSelectedAttributes();r(n)}},{value:h,action:function(e){e.hide()}}]}),c&&c.modals&&c.modals.current&&c.modals.current.elements){var f=c.modals.current.elements.header?c.modals.current.elements.header.getElement(".close.fonticon.fonticon-cancel"):null;f&&(f.setText("×"),f.removeClassName("fonticon"),f.removeClassName("fonticon-cancel"),f.setAttributes({title:i.close})),c.modals.current.elements.closeTooltip&&c.modals.current.elements.closeTooltip.elements&&c.modals.current.elements.closeTooltip.elements.container.addClassName("hideDefaultTooltip")}},getSelectedAttributes:function(){for(var e=[],t=this.checkboxes.length,n=0;n<t;n++){var i=this.checkboxes[n];i.checked&&e.push(i.id)}return e},buildDialogBody:function(e){var n=t.createElement("div",{styles:{position:"relative",height:"100%",overflow:"auto"}}),i=e.length;this.checkboxes=[];for(var o=0;o<i;o++){(s=e[o]).isSelected&&this.addItem(n,s)}for(o=0;o<i;o++){var s;(s=e[o]).isSelected||this.addItem(n,s)}return n},addItem:function(e,n){var i=t.createElement("div",{styles:{width:"100%",overflow:"hidden"}}),o=t.createElement("input");this.checkboxes.push(o),o.type="checkbox";var s=n.name,a=n.displayName,l=n.isSelected;o.id=s,o.checked=l;var r=t.createElement("label",{styles:{"font-weight":"inherit","margin-left":"4px","margin-bottom":"5px",display:"inline-block"}});!0===n.disabled&&(o.disabled=!0),r.htmlFor=s,r.innerHTML=a,o.inject(i),r.inject(i),i.inject(e)}})}),define("DS/LifecycleControls/ResizeMonitor",["UWA/Controls/Abstract","DS/LifecycleServices/EventHandler"],function(e,t){"use strict";var n=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){return window.setTimeout(e,20)};return e.extend({addMonitor:function(e,i){if(e.resizeMonEvents=e.resizeMonEvents||[],!e.resizeMon){e.resizeMon={el:document.createElement("div"),cb:[]},e.resizeMon.cb.push(i);var o="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;",s="position: absolute; left: 0; top: 0; transition: 0s;";e.resizeMon.el.style.cssText=o,e.resizeMon.el.innerHTML='<div style="'+o+'"><div style="'+s+'"></div></div><div style="'+o+'"><div style="'+s+' width: 200%; height: 200%"></div></div>',e.appendChild(e.resizeMon.el),e.resizeMon.el.offsetParent!==e&&(e.style.position="relative");var a,l,r=e.resizeMon.el.childNodes[0],d=e.resizeMon.el.childNodes[1],c=0,u=function(){r.childNodes[0].style.width="100000px",r.childNodes[0].style.height="100000px",r.scrollLeft=1e5,r.scrollTop=1e5,d.scrollLeft=1e5,d.scrollTop=1e5},h=function(){null!=e.resizeMon&&(a=e.offsetWidth,l=e.offsetHeight,c=0,u(),e.resizeMon.cb.forEach(function(e){e.call()}))},m=function(){a==e.offsetWidth&&l==e.offsetHeight||0===c&&(c=n(h))};return u(),e.resizeMonEvents.push(t(r,"scroll",m)),e.resizeMonEvents.push(t(d,"scroll",m)),{detach:function(){if(e.resizeMonEvents.forEach(function(e){e.unbind()}),e.resizeMonEvents=null,e.resizeMon){try{e.removeChild(e.resizeMon.el)}catch(e){}e.resizeMon=null}}}}e.resizeMon.cb.push(i)}})}),define("DS/LifecycleControls/RelatedObjectsControl",["UWA/Controls/Abstract","DS/PlatformAPI/PlatformAPI","DS/LifecycleServices/EventHandler","css!DS/LifecycleControls/assets/styles/RelatedObjectsControl"],function(e,t,n){"use strict";return e.extend({platformAPISubscriptions:[],init:function(e){this._parent(e)},expandCategoryExpanders:function(){[...this.elements.container.querySelectorAll(".accordion-item > .accordion-title")].forEach(e=>{e.click()})},load:function(){var e=this;return new UWA.Promise((i,o)=>{require(["DS/ENORIPE_Relations/RelationsTabSettings"],o=>{e.elements={container:UWA.createElement("div",{class:"lcm-relatedobjects-control-container"})},i();o.setProfile("PowerByCATIAV5_Relations"),this.platformAPISubscriptions.push(t.subscribe("ENORIPE_Relations_ViewReady",function(t){e.dispatchEvent("viewReady",{uniqueIds:t}),e.expandCategoryExpanders(),e.uniqueIds=t})),this.platformAPISubscriptions.push(t.subscribe("DS/PADUtils/PADCommandProxy/select",e=>{if(widget&&e&&e.metadata&&widget.id===e.metadata.originWidgetId){let t=e.data.attrData.map(e=>({id:e.id,type:e.type}));this.dispatchEvent("selectionChange",{selection:t})}}));o.isAvailable({getPlatformID:function(){return"OnPremise"},getServiceID:function(){return"3DSpace"}},{isDraggable:!0,isProfilesVisible:!1,appID:"ENORIPE_ECM",isExternal:!0,noContextualMenu:!0}).then(function(){require(["DS/ENORIPE_Relations/views/RelationsTab"],function(t){let i=new t({defaultProfile:"PowerByCATIAV5_Relations"});i.updateFacetExternal(e.options.model).then(()=>{e.selectAll=(()=>{i.selectNodes(e.uniqueIds)}),e.keydownHandler=new n(document,"keydown",t=>{65===t.keyCode&&t.ctrlKey&&(e.selectAll(),t.preventDefault())})}).catch(e=>{}),i.elements.container.inject(e.elements.container)})}).catch(e=>{console.error("Caught RelationsTab error:",e)})},e=>{o({AMDError:e})})})},destroy:function(){this.platformAPISubscriptions.forEach(e=>{t.unsubscribe(e)}),this.keydownHandler&&this.keydownHandler.unbind(),e.prototype.destroy.call(this)},selectAll:function(){},isAvailable:function(){return new UWA.Promise((e,t)=>{e(!0)})}})}),define("DS/LifecycleControls/WidgetMaximizeHandler",["UWA/Class","UWA/Controls/Abstract"],function(e,t){"use strict";return t.extend({init:function(){if(window&&window.parent&&window.parent.document&&window.frameElement){var e=window.frameElement.id.replace("frame","wi");this.widget=window.parent.document.querySelector("."+e),this.widget&&(this.btnContainer=this.widget.querySelector(".moduleHeader"),this.extrabtnContainer=window.parent.document.querySelector(".topbar-extrabtn"))}this._observeButtons(),this.isMaximized=this._isWidgetMaximized(),this._updateHandlers()},maximize:function(){this._maximize();var e=this;return new UWA.Class.Promise(function(t,n){e._wait(function(){t(null)})})},restore:function(){this._restore();var e=this;return new UWA.Class.Promise(function(t,n){e._wait(function(){t(null)})})},destroy:function(){this.maximizedObserver&&(this.maximizedObserver.disconnect(),this.maximizedObserver=null)},_observeButtons:function(){if(this.btnContainer){var e=this;this.maximizedObserver=new MutationObserver(function(t){e._isWidgetMaximized()!==e.isMaximized&&(e._updateHandlers(),e.dispatchEvent("widget-maxmized-changed",e.isMaximized))}),this.maximizedObserver.observe(this.btnContainer,{attributes:!0,subtree:!0})}},_isWidgetMaximized:function(){return!!this.btnContainer&&(this.widget&&this.widget.hasClassName("ifwe-maximized")||this.btnContainer.isHidden())},_updateHandlers:function(){if(this._maximize=function(){},this._restore=function(){},this._wait=function(e){e()},this.btnContainer&&this.extrabtnContainer){var e=this._isWidgetMaximized(),t=this,n=function(e,i){if(e.gotEl||(t.btnContainer.querySelector(e.cls)||t.extrabtnContainer.querySelector(e.cls))&&(e.gotEl=!0),e.gotNewW){if(1===e.gotNewW){var o;(o=t.widget.getBoundingClientRect().width)===e.oldW?e.gotNewW=2:e.oldW=o}}else(o=t.widget.getBoundingClientRect().width)!=e.oldW&&(e.gotNewW=1,e.oldW=o);e.gotEl&&e.gotNewW&&2===e.gotNewW?(t._updateHandlers(),i()):++e.cnt<30?setTimeout(n,100,e,i):i()},i=this.widget.getBoundingClientRect().width;e?e&&(t.isMaximized=!0,this._restore=function(){var e=t.extrabtnContainer.querySelector(".fonticon-resize-fullscreen-off");e&&(e.click(),t.isMaximized=!1)},this._wait=n.bind(null,{oldW:i,cnt:0,cls:".fonticon-resize-fullscreen"})):(t.isMaximized=!1,this._maximize=function(){var e=t.btnContainer.querySelector(".fonticon-resize-fullscreen");e&&(e.click(),t.isMaximized=!0)},this._wait=n.bind(null,{oldW:i,cnt:0,cls:".fonticon-resize-fullscreen-off"}))}}})}),define("DS/LifecycleControls/NumberModal",["UWA/Controls/Abstract","DS/UIKIT/Modal","DS/Controls/Button","DS/Controls/SpinBox","css!DS/UIKIT/UIKIT","css!DS/LifecycleControls/assets/styles/NumberModal"],function(e,t,n,i){"use strict";return e.extend({name:"numberModal",number:1,init:function(e){this._parent(e);var o=this,s=e.parentContainer||document.body,a=UWA.createElement("div",{class:this.getClassNames()}),l=new i({value:o.number,minValue:1,stepValue:1,pageStepValue:1}).inject(a);l.getContent().addClassName(this.getClassNames("_spinbox")),l.addEventListener("change",function(e){o.number=parseInt(e.dsModel.value)});var r=new n({icon:"check",emphasize:"success"}).inject(a);r.getContent().addClassName(this.getClassNames("_ok")),r.addEventListener("click",function(){o.dispatchEvent("onApply",o.number),d.destroy()}),l.elements.inputField&&l.elements.inputField.addEventListener("keyup",function(e){13===e.keyCode&&(o.dispatchEvent("onApply",o.number),d.destroy())});var d=new t({className:this.getClassNames("_modal"),closable:!1,body:a,visible:!0});d.elements.container.addEventListener("click",function(e){d.destroy()}),d.elements.content.addEventListener("click",function(e){return e.preventDefault(),e.stopPropagation(),!1}),d.inject(s);var c=e.windowPos.y-90+"px";try{var u=parseInt(window.getComputedStyle(d.elements.wrapper).paddingTop),h=d.elements.wrapper.getBoundingClientRect();c=e.windowPos.y-(h.y+u)+"px"}catch(e){}d.elements.wrapper.setStyle("margin-left",e.windowPos.x+"px"),d.elements.wrapper.setStyle("margin-top",c),l.elements.inputField&&l.elements.inputField.focus()}})}),define("DS/LifecycleControls/LifecycleControls",[],function(){return{}}),define("DS/LifecycleControls/DataGridViewContainer",["UWA/Core","UWA/Controls/Abstract","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/TreeModel/DataModelSet","DS/DataGridView/DataGridView","DS/Windows/ImmersiveFrame","DS/Controls/Expander","i18n!DS/LifecycleWidget/assets/nls/LifecycleWidgetNls","i18n!DS/LifecycleServices/assets/nls/LifecycleServicesNls","css!DS/LifecycleControls/assets/styles/DataGridViewContainer"],function(e,t,n,i,o,s,a,l,r,d){"use strict";return t.extend({defaultOptions:{idName:"dgvContainer",clickToShowDGV:!1},init:function(e,t){this._parent(e),this.buildSkeleton(t)},buildSkeleton:function(e){var t=this.options,o=new n,c=[];e.forEach(function(e){if(!e.hasOwnProperty("visible")||0!=e.visible){var t={},n=e["attribute[PLMEntity.V_Name]"]?e["attribute[PLMEntity.V_Name]"]:e.name,i=e.type;e.typeDisplayName?i=e.typeDisplayName:e.displayType&&(i=e.displayType);var o=e.currentFullName?e.currentFullName:e.current;t.title=n,t.type=i,t.revision=e.revision,t.maturity=o,t.imageUrl=e.imageUrl,c.push(t)}}),o.prepareUpdate(),c.forEach(function(e){var t=[];t.push(e.imageUrl);var n=new i({label:e.title,grid:e,icons:t});o.addRoot(n)}),o.pushUpdate();var u=[{text:r.title,dataIndex:"tree"},{text:r.type,dataIndex:"type",width:100},{text:r.revision,dataIndex:"revision",width:70},{text:d.maturitystate,dataIndex:"maturity",width:85}],h=new s({treeDocument:o,columns:u});h.layout.rowsHeader=!1,h.rowSelection="none",h.cellSelection="none";var m=new a;m.setContentInBackgroundLayer(h.getContent()),m.reactToPointerEventsFlag=!1;var f=UWA.createElement("div",{id:t.idName});if(!0===t.clickToShowDGV){f.addClassName("hasExpander");var g=e.length?56+24*e.length:80;e.length>8&&(g=200);var p=!1;let n=void 0===t.expanderText?"Objects selected":t.expanderText;var v=new l({header:n,body:m});v.elements.header.addEvent("click",function(){p?(document.getElementsByClassName("command_dialog")[0].style.height="auto",document.getElementsByClassName("modal-body")[0].style.height="auto",f.removeClassName("open"),p=!1):(document.getElementsByClassName("command_dialog")[0].style.height=240+g+"px",document.getElementsByClassName("modal-body")[0].style.height=128+g+"px",f.addClassName("open"),p=!0)}),v.inject(f)}else m.inject(f);this.elements.container=f}})}),define("DS/LifecycleControls/InputValidation",["UWA/Controls/Abstract","DS/UIKIT/Tooltip","DS/LifecycleServices/EventHandler"],function(e,t,n){"use strict";var i={unknown:0,text:1,number:2,email:3,custom:4,submit:5};function o(){if(!(this instanceof o))return new o}function s(){if(!(this instanceof s))return new s}function a(e){if(!(this instanceof a))return new a;this.min=e}function l(e){if(!(this instanceof l))return new l;this.max=e}function r(){if(!(this instanceof r))return new r}o.prototype={validate:function(e){return"string"==typeof e&&e.length>0},getErrorInfo:function(e){return"Text cannot be empty"}},s.prototype={validate:function(e){return("string"!=typeof e||0!==e.length)&&!isNaN(e)},getErrorInfo:function(e){return"Must be a number"}},a.prototype={validate:function(e){return"string"==typeof e&&e.length>=this.min},getErrorInfo:function(e){return"Must be min "+this.min+" chars"}},l.prototype={validate:function(e){return"string"==typeof e&&e.length<=this.max},getErrorInfo:function(e){return"Must be max "+this.max+" chars"}},r.prototype={validate:function(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)},getErrorInfo:function(e){return"Must be a valid e-mail"}};var d=e.extend({init:function(e,t,n){this.isDebug=!1,this.element=e,this.type=t,this.customCSS=n,this.isOptional=!1,this.isValid=!0,this.customId=-1,this.validators=[]},setGroupId:function(e){this.groupId=e},setOptional:function(e){this.isOptional=e},addValidators:function(e){var t;this.validators=this.validators.concat(e),((t=this.type)===i.text||t===i.number||t===i.email||t===i.custom)&&this.validate()},validate:function(e){var t=this.isValid,n=!1;if(null!=e||null!=this.element){var i="",o=null!=e?e:this.element.value;return this.validators.some(function(e){var t=e.validate(o);return t||(i=e.getErrorInfo(o)),!t})?this.isValid=this.checkOptional(o):this.isValid=!0,t===this.isValid&&i===this.errorText||(this.errorText=i,this.updateUI(),n=!0),n}console.error("validate error")},checkOptional:function(e){return!!this.isOptional&&(!e||"string"==typeof e&&0===e.length)},updateUI:function(){var e;this.element&&(this.isValid?(this.element.classList.remove("inputvalidation-validation-invalid"),this.customCSS&&this.customCSS.inputCSS&&this.element.classList.remove(this.customCSS.inputCSS),(e=this.getInfoElement(this.element,!0))&&(e.style.display="none")):(this.element.classList.add("inputvalidation-validation-invalid"),this.customCSS&&this.customCSS.inputCSS&&this.element.classList.add(this.customCSS.inputCSS),(e=this.getInfoElement(this.element,!0))&&(e.style.display="inline",this.tooltip.elements.body.innerHTML=this.errorText)))},removeValidationElementsFromHost:function(e){if(e){e.classList.remove("inputvalidation-validation-invalid"),this.customCSS&&this.customCSS.inputCSS&&e.classList.remove(this.customCSS.inputCSS);var t=this.getInfoElement(e,!1);t&&e.parentNode.removeChild(t),this.isDebug&&(e.classList.add("debug-inputvalidation-detached"),e.classList.remove("debug-inputvalidation-attached"),e.classList.remove("debug-inputvalidation-create"))}},getInfoElement:function(e,n){if(!e.parentNode)return null;var i=e.parentNode.querySelector(".inputvalidation-info-icon");return!i&&n&&((i=document.createElement("b")).classList.add("inputvalidation-info-icon"),this.customCSS&&this.customCSS.infoIconCSS&&i.classList.add(this.customCSS.infoIconCSS),this.tooltip=new t({target:UWA.extendElement(i),body:"no error yet",position:"bottom"}),this.tooltip.elements.container.classList.add("inputvalidation-tooltip"),this.customCSS&&this.customCSS.tooltipCSS&&this.tooltip.elements.container.classList.add(this.customCSS.tooltipCSS),e.parentNode.appendChild(i)),i}});return e.extend({init:function(e,t){this.validateEl=[],this.customValidators=t;var n,i,o=[];e&&(n=e,i="[data-validation]",o=Array.prototype.slice.apply(n.querySelectorAll(i))),o.forEach(function(e){var t=this._getValidators(e),n=e.getAttribute("data-validation-group"),i="string"==typeof e.getAttribute("data-validation-optional");this.addValidateElement(e,t.validators,i,n,t.type)},this),this._updateSubmit()},setCustomCSS:function(e){this.customCSS=e},_getValidators:function(e){var t,n=[],d=e.getAttribute("data-validation").split("."),c="text"===(t=d[0])?i.text:"number"===t?i.number:"email"===t?i.email:"custom"===t?i.custom:"submit"===t?i.submit:i.unknown;if(c!==i.unknown){c===i.text?n.push(new o):c===i.number?n.push(new s):c===i.email&&n.push(new r);var u=+e.getAttribute("data-validation-minLength");isNaN(u)||0===u||n.push(new a(u));var h=+e.getAttribute("data-validation-maxLength");isNaN(h)||0===h||n.push(new l(h)),m&&n.push(m);var m=null;return c===i.custom&&(m=this._getCustomValidator(this.customValidators,d[1])),m&&n.push(m),{type:c,validators:n}}},updateValidation:function(){this._updateSubmit()},addValidateElement:function(e,t,o,s,a){var l=new d(e,a||i.custom,this.customCSS);l.setGroupId(s),l.setOptional(o||!1),l.addValidators(t),this.validateEl.push(l),l.inputHandler=new n(e,"input",this._onInputChanged.bind(this,l)),this.isDebug&&(e.classList.remove("debug-inputvalidation-attached"),e.classList.remove("debug-inputvalidation-detached"),e.classList.add("debug-inputvalidation-create"));var r=this;return{getValidator:function(){return l},setCustomId:function(e){l.customId=e,l.element.setAttribute("data-custom-id",e)},getElementCustomId:function(){return l.element?l.element.getAttribute("data-custom-id"):-1},removeElementCustomId:function(){l.element.removeAttribute("data-custom-id")},attachElement:function(e){this.detach(e),l.element=e,l.inputHandler=new n(e,"input",r._onInputChanged.bind(r,l)),this.setCustomId(l.customId),l.isValid||l.updateUI(),this.isDebug&&(e.classList.add("debug-inputvalidation-attached"),e.classList.remove("debug-inputvalidation-detached"),e.classList.remove("debug-inputvalidation-create"))},detach:function(e){if(l.element){if(-1!==l.customId&&l.element){var t=this.getElementCustomId();if(l.customId!=t)return console.error("ID mismatch","data-id: "+t+" validator id: "+l.customId),l.removeValidationElementsFromHost(e),this.removeInputHandler(),void(l.element=null)}l.removeValidationElementsFromHost(l.element),this.removeInputHandler(),this.removeElementCustomId(),l.element=null}},removeInputHandler:function(){l.inputHandler&&(l.inputHandler.unbind(),l.inputHandler=null)},updateInputValidation:function(e){return!!l.validate(e)&&(r._updateSubmit(),!0)}}},addSubmitElement:function(e,t){return this.addValidateElement(e,null,!1,t,i.submit)},isInputInvalid:function(e){return this.validateEl.filter(function(e){return e.type!==i.submit}).some(function(t){return!1===t.isValid&&t.groupId===e})},isInputValid:function(e){return!this.isInputInvalid(e)},_getCustomValidator:function(e,t){var n=null;if(e)for(var i=0;i<e.length;++i)if(e[i].name===t){n=e[i];break}return n},_updateSubmit:function(){this.validateEl.filter(function(e){return e.type===i.submit}).forEach(function(e){this.isInputInvalid(e.groupId)?(e.element.disabled=!0,e.element.classList.add("inputvalidation-submit-invalid")):(e.element.disabled=!1,e.element.classList.remove("inputvalidation-submit-invalid"))},this)},_onInputChanged:function(e){e.validate()&&this._updateSubmit()}})}),define("DS/LifecycleControls/Assembly3DViewerImpl",["UWA/Controls/Abstract","UWA/Utils/InterCom","DS/LifecycleServices/AssemblyJson","DS/Selection/CSOManager","DS/Selection/HSOManager"],function(e,t,n,i,o){"use strict";return e.extend({init:function(e,t){this.widget=e,this._parent({}),this.buildUI(),this.listenCommands(),this.postEvent("onHtmlLoad"),this.options=t},buildUI:function(){this.elements.container=new UWA.Element("div",{styles:{position:"absolute",height:"100%",width:"100%"}}),this.build3DViewer(this.elements.container)},build3DViewer:function(e){var t=this;require({baseUrl:"../"},["DS/ENOPAD3DViewer/PAD3DViewer"],function(n){t.viewer3d=new n({widget:t.widget,css_view_class:"windowed",activateProbes:!1,authorizeSet3DStructure:!1,propertiesCommandAvailability:!1,windowOptions:{BIMode:"SLAVE"}}),t.viewer3d.subscribe({event:"onActionBarReady"},function(){var n=t.viewer3d.elements.container.getElementsByClassName("paddnd_invite_container");null!=n&&(0!=n.length&&n[0].setStyle("z-index","-1"));null!=(n=t.viewer3d.elements.container.getElementsByClassName("wux-afr-view-tabbar-parent"))&&(0!=n.length&&n[0].setStyle("display","none"));t.on3DViewerActionBarReady(e)}),t.viewer3d.subscribe({event:"onLoadingComplete"},function(){t.postEvent("onLoad")}),t.viewer3d.subscribe({event:"onLoadingFailure"},function(){t.postEvent("onLoadFail")}),i.onUpdate(function(e){var n=i.get(),o=[];n.forEach(function(e){var n=t.viewer3d._controller.buildArrayFromPath(e.pathElement),i=JSON.stringify(n);null!=t.mapPathToOccurrence[i]&&o.push(t.mapPathToOccurrence[i])}),t.postEvent("onSelect",o)})})},on3DViewerActionBarReady:function(e){this.viewer3d.render().inject(e),this.viewer3d.getLevelSelectorCommand&&this.viewer3d.getLevelSelectorCommand(function(e){e&&e.displayLabels(!1)}),this.postEvent("onReady"),null!=this.options&&null!=this.options.onActionBarReady&&this.options.onActionBarReady()},postEvent:function(e,t){var n={eventName:e,params:t};window.parent.postMessage(n,"*")},listenCommands:function(){var e=this;window.addEventListener("message",function(t){var n=t.data,i=n.cmd,o=n.params;e.onCmd(i,o)},!1)},onCmd:function(e,t){switch(e){case"load":this.load(t);break;case"clear":this.clear();break;case"destroy":this.destroy();break;case"highlight":this.highlightSelectedObjects(t)}},load:function(e){var t=n.getRootPhysicalId(e);if(t!=this.lastSnapshotAssemblyRootId){this.clear();for(var i=(e=JSON.parse(JSON.stringify(e))).nodes.length,o=0;o<i;o++){var s=e.nodes[o],a=s.cgrurl;if(null!=a&&""!=a){a.endsWith("&origin=3DSpace")||(s.cgrurl+="&origin=3DSpace")}}var l=n.convertToViewerFormat(e);this.lastSnapshotAssemblyRootId=t;var r={data:[{rootID:t,structure:{results:l.results}}]};this.viewer3d.loadJSON(r),this.mapPathToOccurrence=l.mapPathToOccurrence,this.mapOccurrenceToPath=l.mapOccurrenceToPath}},clear:function(){null!=this.lastSnapshotAssemblyRootId&&(this.viewer3d.removeRoots({pids:[this.lastSnapshotAssemblyRootId]}),this.lastSnapshotAssemblyRootId=null)},destroy:function(){this.viewer3d.destroy()},highlightSelectedObjects:function(e){var t=this.mapPathToOccurrence,n=this.mapOccurrenceToPath;o.empty();for(var i=0;i<e.length;i++){var s=e[i];if(s>=0&&Array.isArray(n)){var a=n[s];if(Array.isArray(a)){var l=JSON.stringify(a);for(var r in t)if(0===r.indexOf(l)){var d=this.viewer3d._controller.buildPathFromArray(JSON.parse(r));o.add({pathElement:d})}}}}}})});const WebUXDialogFooter={YesNo:1,OkCancel:2};Object.freeze(WebUXDialogFooter);const WebUXDialogButton={Yes:1,No:2,Ok:3,Cancel:4};Object.freeze(WebUXDialogButton),define("DS/LifecycleControls/WebUXDialog",["UWA/Controls/Abstract","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button"],function(e,t,n,i){"use strict";return e.extend({create:function({container:e,content:i,title:o,footer:s=WebUXDialogFooter.OkCancel,zIndex:a,initialSize:l}){var r=new t({});let d=()=>{};if(l){let e={};i&&(e.width=window.getComputedStyle(i).width,e.height=window.getComputedStyle(i).height,i.setStyle("width",l.width+"px"),i.setStyle("height",l.height+"px")),d=(t=>{setTimeout(()=>{let n=t.dsModel.elements.container.querySelector(".wux-windows-window-maincontent.wux-element-contentbox"),o=t.dsModel.elements.container.querySelector(".wux-windows-window-content.wux-element-contentbox");n.setStyle("width",l.width+"px"),o.setStyle("height",l.height+"px"),i&&(i.setStyle("width",e.width),i.setStyle("height",e.height)),d=(()=>{})},100)})}return r.addEventListener("contentVisibleStateChange",e=>{d(e)}),this.dialog=new n({immersiveFrame:r,title:o,resizableFlag:!0,content:i||"null content",activeFlag:!1,buttons:this._createButtons(s)}),a&&r.getContent().setStyle("z-index",a),r.inject(e),new UWA.Promise((e,t)=>{this.dialog.addEventListener("close",()=>{this.dialog.destroy(),r.destroy(),t()}),this.addEvent("buttonClick",n=>{n!==WebUXDialogButton.Cancel&&(t=(()=>{}),e(n)),this.dialog.close()})})},enableButton:function(e,t){this._buttons[e]&&(this._buttons[e].disabled=!t)},_createButtons:function(e){this._buttons={};let t={};return e===WebUXDialogFooter.YesNo?(t={Yes:new i({onClick:e=>{this.dispatchEvent("buttonClick",WebUXDialogButton.Yes)}}),No:new i({onClick:e=>{this.dispatchEvent("buttonClick",WebUXDialogButton.No)}})},this._buttons[WebUXDialogButton.Yes]=t.Yes,this._buttons[WebUXDialogButton.No]=t.No):e===WebUXDialogFooter.OkCancel&&(t={Ok:new i({onClick:e=>{this.dispatchEvent("buttonClick",WebUXDialogButton.Ok)}}),Cancel:new i({onClick:e=>{this.dispatchEvent("buttonClick",WebUXDialogButton.Cancel)}})},this._buttons[WebUXDialogButton.Ok]=t.Ok,this._buttons[WebUXDialogButton.Cancel]=t.Cancel),t}})}),define("DS/LifecycleControls/AssemblyTreeList",["UWA/Controls/Abstract","UWA/Core","UWA/Class/Promise","DS/Tree/TreeListView","DS/Core/PointerEvents","DS/Controls/Toggle","DS/LifecycleServices/AssemblyJson","DS/LifecycleServices/LifecycleServices","DS/LifecycleServices/ArrayFunctions"],function(e,t,n,i,o,s,a,l,r){"use strict";return e.extend({init:function(e){e=e||{},this._parent({}),this.buildUI(),this.options=e,this.colIndexes=["revision","owner","description","modified","originated"],this.defaultWidth=[],this.defaultWidth.revision=72,this.defaultWidth.newTitle=180,this.defaultWidth.maturityNls=110,this.showCheckbox=!1,this.selectOnCheck=!1,this.postUpdateViewCalled=!1,this.enableDragAndDrop=!0,this.selectOnCheck=!1,this.treeColumnSortable=!0,this.enableListSelection=!1,this.options.updateRelatedCombos=void 0===e.updateRelatedCombos||e.updateRelatedCombos,void 0!==e&&(void 0!==e.showCheckbox&&(this.showCheckbox=e.showCheckbox),void 0!==e.selectOnCheck&&(this.selectOnCheck=e.selectOnCheck),void 0!==e.onDropCol&&(this.onDropCol=e.onDropCol),void 0!==e.allCols&&(this.colIndexes=e.allCols),void 0!==e.getTypeIcon&&(this.getTypeIconFunc=e.getTypeIcon),void 0!==e.getChildrenInTreeOrder&&(this.getChildrenInTreeOrder=e.getChildrenInTreeOrder),void 0!==e.treeColumnSortable&&(this.treeColumnSortable=e.treeColumnSortable),void 0!==e.colsSortable&&(this.colsSortable=e.colsSortable),void 0!==e.treeColumnSortable&&(this.treeColumnSortable=e.treeColumnSortable),void 0!==e.colsSortable&&(this.colsSortable=e.colsSortable),void 0!==e.enableDragAndDrop&&(this.enableDragAndDrop=e.enableDragAndDrop),void 0!==e.enableListSelection&&(this.enableListSelection=e.enableListSelection),void 0!==e.onContextualEvent&&(this.onContextualEvent=e.onContextualEvent),this.canMultiSelect=e.canMultiSelect||!1),this.options.useKeyboard&&this.installKeyboardHandlers(),this._configureDropdownCellFactory(),this.columns=this.initColumns()},disableNodesByType:function(e){for(var t=this.tree.getDocument().getAllDescendants(),n=t.length,i=0;i<n;i++){var o=t[i],s=o.options.type;-1==e.indexOf(s)&&this.disableNode(o)}},installKeyboardHandlers:function(){this.elements.container.addEventListener("keydown",e=>{65===e.keyCode&&e.ctrlKey&&(this.getAllNodes().forEach(e=>e._treeNode.select()),e.preventDefault())})},getNodes:function(e,t){t=[];for(var n=this.tree.getDocument().getAllDescendants(),i=n.length,o=0;o<i;o++){var s=n[o];if(e(s)){var a=this.buildAssemblyNode(s);t.push(a)}}return t},getAllNodes:function(){return this.getNodes(function(e){return!0})},getSelectedNodes:function(){var e=this;return this.tree.getDocument().getSelectedNodes().map(function(t){return e.buildAssemblyNode(t)})},clearSelection:function(){this.getSelectedNodes().forEach(e=>{e._treeNode.unselect()})},getSameNodes2:function(e){return this.getNodes(function(t){return e==t.options.nodeId})},getToggledNodes:function(){if(1!=this.showCheckbox)return[];for(var e=[],t=this.tree.getDocument().getAllDescendants(),n=t.length,i=0;i<n;i++){var o=t[i];if(o.toggled){var s=o.options.nodeId;-1==e.indexOf(s)&&e.push(s)}}return e},getDropdownSelectedIndex:function(e,t){var n=this.getSameNodes(e);if(0==n.length)return-1;var i=n[0];return this.getNodeDropdownSelectedIndex(i,t)},onSelect:function(e){this.onSelCallback=e},onUnselect:function(e){this.onUnselCallback=e},onCheck:function(e){this.onCheckCallback=e},onUncheck:function(e){this.onUncheckCallback=e},insertCol:function(e,t){this.columns.splice(e,0,t)},load:function(e,t,n){var o=this;let s=Array.isArray(e)?e:[e];this.filterDuplicates=!1,void 0!==n&&void 0!==n.filterDuplicates&&(this.filterDuplicates=n.filterDuplicates);var a,l=n?n.loadFilter:null,r=n?n.sortFn:null;let d="undefined"!==this.options?this.colIndexes:t,c=this.createNodeUIAttributes(d),u=this.createTreeListUIRoots(s,c.attributeNames,l,r);a=this.getOptions(u,c.customCols),this.tree=new i(a),this.tree.getManager().onPostUpdateView(function(){o.postUpdateViewCalled=!0,o.dispatchEvent("onPostUpdateView")}),this.tree.inject(this.elements.container),void 0!==this.options&&this.customizeColumns(t),this.elements.container.getElement(".wux-tree-treelistview").setStyle("height","100%"),this.elements.container.getElement(".wux-datagrid").setStyle("height","100%"),this.elements.container.getElement(".wux-layouts-gridengine").setStyle("height","100%"),this.elements.container.getElement(".wux-layouts-gridengine").setStyle("min-height","80px");for(var h=this.tree.getDocument().getAllDescendants(),m=h.length,f=0;f<m;f++){var g=h[f];g.onSelect(function(e){e.target;if(null!=o.onSelCallback){var t=o.buildAssemblyNode(e.target);o.onSelCallback(t)}}),g.onUnselect(function(e){e.target;if(null!=o.onUnselCallback){var t=o.buildAssemblyNode(e.target);o.onUnselCallback(t)}}),g.toggle=function(){this.toggled=!0,null!=this.checkbox&&!0!==this.checkbox.checkFlag&&this.checkbox.toggle()},g.untoggle=function(){this.toggled=!1,null!=this.checkbox&&!0===this.checkbox.checkFlag&&this.checkbox.toggle()}}n&&n.noExpandAll||this.tree.getNthRoot(0).expandAll()},insertDropdownListCol:function(e,t,n,i,o,s,a,l){s=void 0!==s?s:130;var r=void 0===a||a,d=this;this.insertCol(e,{text:n,dataIndex:t,isSortable:r,type:"string",width:s,onCellRequest:function(e){e.isHeader||d.insertDropdownListCell(t,e,i,o,l)}})},getRelatives:function(e){return{children:e.getAllDescendants(),parents:e.getParents(),instances:this.getSameNodes(e.options.nodeId)}},setDropdownSelectionIf:function(e,t,n,i){for(var o=0;o<e.length;o++){var s=e[o];if(("function"!=typeof i||i(this.getNodeDropdownSelectedIndex(s,n)))&&(this.setNodeDropdownSelectedIndex(s,n,t),void 0!==s.dropdownList)){var a=s.dropdownList[n];a.selectedIndex=t,a.previouslySelectedIndex=t}}},getNodeDropdownSelectedIndex:function(e,t,n){return void 0!==e.dropdownListSelectedIndex?e.dropdownListSelectedIndex[t]:void 0!==n?(e.dropdownListSelectedIndex={},e.dropdownListSelectedIndex[t]=n,n):0},setNodeDropdownSelectedIndex:function(e,t,n){void 0===e.dropdownListSelectedIndex&&(e.dropdownListSelectedIndex={}),e.dropdownListSelectedIndex[t]=n},onDropdownListChange:function(e){var t,n=e.target,i=n.nodeModel,o=n.dataIndex;"function"==typeof n.onChangeCallback&&n.onChangeCallback(n.previouslySelectedIndex,n.selectedIndex,i),n.previouslySelectedIndex=n.selectedIndex,t=this.options.updateRelatedCombos?this.getRelatives(i).instances:[i];var s=n.selectedIndex;this.setDropdownSelectionIf(t,s,o),i.options.grid[o]=n.options[s].innerHTML},_configureDropdownCellFactory:function(){this.defaultDropdownCellFactory=function(e,n){var i=t.createElement("select",{class:"atl-combo"+(0===e._nodeDepth?" atl-root":""),styles:{width:"100%"}});return i.onChangeCallback=n,i},this.dropdownCellFactory=this.options&&this.options.dropdownCellFactory?this.options.dropdownCellFactory:this.defaultDropdownCellFactory},insertDropdownListCell:function(e,n,i,o,s){var a=this,l=n.nodeModel,r={physicalId:l.options.physicalId,nodeId:l.options.nodeId,occId:l.options.occId},d=this.dropdownCellFactory(l,o);d.dataIndex=e,d.nodeModel=l,l.dropdownList={},l.dropdownList[e]=d,d.addEventListener("change",function(e){a.onDropdownListChange(e)});for(var c=i(r,l),u=c.length,h=0;h<u;h++){var m=t.createElement("option"),f="",g=!1;"object"==typeof c[h]?(f=c[h].text,g=!!c[h].disabled&&c[h].disabled):f=c[h],m.setText(f),g&&(m.disabled=!0),m.inject(d)}var p="function"==typeof s?s(r,l):0;d.selectedIndex=this.getNodeDropdownSelectedIndex(l,e,p),d.previouslySelectedIndex=d.selectedIndex,(u<=1||l.disabled)&&a.disableDropdownList(d),n.cellView.getContent().setHTML(d),null!=(m=d.options[d.selectedIndex])&&(l.options.grid[e]=d.options[d.selectedIndex].innerHTML)},disableDropdownLists:function(e){var t=e.dropdownList;for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];this.disableDropdownList(i)}},disableDropdownList:function(e){null!==e&&(e.disabled=!0,e.setStyle("opacity",".2"))},enableDropdownLists:function(e){var t=e.dropdownList;for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];this.enableDropdownList(i)}},enableDropdownList:function(e){null===e||e.nodeModel.hardDisabled||(e.disabled=!1,e.setStyle("opacity","1"))},buildAssemblyNode:function(e){var t=this,n=e.options,i={occId:n.occId,nodeId:n.nodeId,physicalId:n.physicalId,_treeNode:e,getParent:function(){var e=i._treeNode.getParent(),n=null;return null!=e&&null!=e.options.occId&&(n=t.buildAssemblyNode(e)),n},getChildren:function(){var e=[],n=i._treeNode.getChildren();if(null==n)return[];for(var o=n.length,s=0;s<o;s++){var a=n[s],l=t.buildAssemblyNode(a);e.push(l)}return e}};return i},customizeColumns:function(e){for(var t=this.getColumnsOptions(e),n=this.tree.options.columns.length,i=0;i<n;i++){"toggle"==(o=this.columns[i]).dataIndex||"tree"==o.dataIndex||e&&-1!=e.indexOf(o.dataIndex)||(o.isHidden=!0,t.push(o))}this.tree.loadColumns(t);for(i=0;i<n;i++){var o;(o=this.tree.options.columns[i]).isHidden?this.tree.getManager().hideColumn(o.dataIndex):this.tree.getManager().showColumn(o.dataIndex)}},getColumnsOptions:function(e){var t=[];if(this.showCheckbox){var n=this.getCol("toggle");n.isHidden=!1,t.push(n)}var i=this.getCol("tree");if(i.isHidden=!1,t.push(i),void 0!==e)for(var o=e.length,s=0;s<o;s++){var a=e[s],l=this.getCol(a);l.isHidden=!1,t.push(l)}return t},createNodeUIAttributes:function(e){var t=[];if(this.showCheckbox){this.insertToggleCol();var n=this.getCol("toggle");t.push(n)}var i=this.getCol("tree");t.push(i);var o=["physicalid","Title","type"];if(void 0!==e)for(var s=e.length,a=0;a<s;a++){var l=e[a],r=this.getCol(l);t.push(r);var d=l;"modified"==d&&(d="mod"),o.push(d)}return o.push("type_icon_url"),{attributeNames:o,customCols:t}},createTreeListUIRoots:function(e,t,n,i){var o=[];return e.forEach(e=>{var s=a.getRootOccurenceId(e),l=a.AssemblyHelper(e),r={};this.fillTreeListNode(e,l,s,t,r,n,i),o.push(r)}),o},getOptions:function(e,t){var n=this,i={apiVersion:2,columns:t,roots:e,enableDragAndDrop:this.enableDragAndDrop,resize:{columns:!0,rows:!0},selection:{toggle:!1,enableListSelection:this.enableListSelection,canMultiSelect:this.canMultiSelect},shouldAcceptDrag:function(e){return!1},onDrop:function(e,t,i,o){return n.onDragDropColumn(e,t,i,o)},onDropColumnHeader:function(e,t){return n.onDragDropColumn2(e,t)}};return this.onContextualEvent&&(i.onContextualEvent=this.onContextualEvent),i},getColIndex:function(e,t){for(var n=e.dataIndex,i=t.length,o=0;o<i;o++){if(n==t[o].dataIndex)return o}return-1},calcAfterDropColDataIndexes:function(e,t){for(var n=[],i=t.manager.options.columns,o=this.getColIndex(e,i),s=this.getColIndex(t,i),a=i.length,l=0;l<a;l++){var r=i[l].dataIndex;"toggle"!=r&&"tree"!=r&&(l!=o&&(l==s?o<s?(n.push(r),n.push(e.dataIndex)):o>s?(n.push(e.dataIndex),n.push(r)):n.push(r):n.push(r)))}return n},onDragDropColumn:function(e,t,n,i){if("tree"==t.dataIndex||"toggle"==t.dataIndex||"tree"==n.dataIndex||"toggle"==n.dataIndex)return!1;if(null!=this.onDropCol){var o=this.calcAfterDropColDataIndexes(t,n);this.onDropCol(o)}return!0},onDragDropColumn2:function(e,t){var n=e.dataTransfer.getData("Text"),i=t.dataIndex;if("tree"==n||"toggle"==n||"tree"==i||"toggle"==i)return!1;var o=this.tree.getManager().getColumn(n)[0],s=this.tree.getManager().getColumn(i)[0],a=!1;o.options.columnID>s.options.columnID&&(a=!0);for(var l=this.tree.getManager().getColumns(),r=[],d=l.length,c=0;c<d;c++){var u=l[c],h=u.dataIndex;if(0==u.isHidden&&"tree"!=h&&"toggle"!=h){if(h==n)continue;a?(h==i&&r.push(n),r.push(h)):(r.push(h),h==i&&r.push(n))}}return this.onDropCol(r),!0},fillTreeListNode:function(e,t,n,i,o,s,a){var r=t.getNodeIdFromOccurenceId(n),d=(x=t.getNodeAttributeValues(r,i))[0],c=x[1],u=x[2],h=x[i.indexOf("type_icon_url")];null==h&&null!=this.getTypeIconFunc&&(h=this.getTypeIconFunc(u));for(var m,f={},g=x.length,p=3;p<g;p++){var v=i[p],C=x[p],b=v;"mod"==v&&(b="modified",C=l.formatDate(C,!0)),"originated"==v&&(C=l.formatDate(C,!0)),f[b]=C}o.label=c,o.icons=[h],o.grid=f,o.type=u,o.occId=n,o.nodeId=r,o.physicalId=d,o.assembly=e;var y=(m=this.getChildrenInTreeOrder?t.getChildOccurenceIdsTreeOrder(n,this.filterDuplicates):t.getChildOccurenceIds(n,this.filterDuplicates)).length;if(y>0){o.children=[];for(p=0;p<y;p++){var S=m[p],w=!1;if(s){var x;r=t.getNodeIdFromOccurenceId(S);s({type:(x=t.getNodeAttributeValues(r,["type"]))[0]})&&(w=!0)}if(!w){var D={};o.children.push(D),this.fillTreeListNode(e,t,S,i,D,s,a)}}a&&(o.children=o.children.sort(a))}},addColumn:function(e,t,n,i,o){var s={text:t,dataIndex:n,isSortable:o,width:i};e.push(s)},initColumns:function(){var e=[],t=l.getAttributeDisplayName("title");this.addColumn(e,t,"tree","auto",this.treeColumnSortable);for(var n=this.colIndexes.length,i=0;i<n;i++){var o=this.colIndexes[i],s=l.getAttributeDisplayName(o),a="auto";null!=this.defaultWidth[o]&&(a=this.defaultWidth[o]);var r=!0;null!=this.colsSortable&&null!=this.colsSortable[o]&&(r=this.colsSortable[o]),this.addColumn(e,s,this.colIndexes[i],a,r)}return e},buildUI:function(){this.elements.container=t.createElement("div",{class:"assemblyTreeListContainer",styles:{class:"tree_list",top:"0px",left:"0px",width:"100%",height:"100%","background-color":"white"}})},updateToggleHeader:function(){var e=this.getAllNodesCount(),t=this.getSelectedNodes();this.lastSelected!=e&&0!=this.lastSelected||this.toggleHeader.toggle(),this.lastSelected=t.length},toggleAll:function(){for(var e=this.tree.getDocument().getAllDescendants(),t=e.length,n=0;n<t;n++){var i=e[n];i.disabled||i.toggle()}},untoggleAll:function(){for(var e=this.tree.getDocument().getAllDescendants(),t=e.length,n=0;n<t;n++){var i=e[n];i.disabled||i.untoggle()}},getAllNodesCount:function(){return 10},createToggleHeader:function(){var e=this,t=new s({checkFlag:!1,mixedState:!1});return t.getContent().addEventListener(o.POINTERDOWN,function(e){e.stopPropagation()}),t.getContent().addEventListener("focus",function(e){e.preventDefault(),e.stopPropagation()}),t.getContent().addEventListener("change",function(t){t.preventDefault(),t.stopPropagation(),t.dsModel.checkFlag?e.toggleAll():e.untoggleAll()}),t},getSameNodes:function(e){for(var t=[],n=this.tree.getDocument().getAllDescendants(),i=n.length,o=0;o<i;o++){var s=n[o];e==s.options.nodeId&&t.push(s)}return t},toggleSameNodes:function(e){for(var t=this.getSameNodes(e),n=t.length,i=0;i<n;i++){var o=t[i];this.selectOnCheck&&o.select(),o.toggle()}},untoggleSameNodes:function(e){for(var t=this.getSameNodes(e),n=t.length,i=0;i<n;i++){t[i].untoggle()}},onToggle:function(e){if(this.selectOnCheck&&e.select(),this.toggleSameNodes(e.options.nodeId),null!=this.onCheckCallback){var t=this.buildAssemblyNode(e);this.onCheckCallback(t)}},onUntoggle:function(e){if(this.untoggleSameNodes(e.options.nodeId),null!=this.onUncheckCallback){var t=this.buildAssemblyNode(e);this.onUncheckCallback(t)}},disableNode:function(e){e.disabled=!0,this.disableToggle(e),this.disableDropdownLists(e)},disableToggle:function(e){null!=e.checkbox&&(e.checkbox.disabled=!0)},enableNode:function(e){e.disabled=!1,this.enableToggle(e),this.enableDropdownLists(e)},enableToggle:function(e){null!=e.checkbox&&(e.checkbox.disabled=!1)},insertToggleCell:function(e){var t=this,n=e.nodeModel,i=new s({checkFlag:n.toggled,mixedState:!1});n.checkbox=i,n.disabled&&t.disableToggle(n),i.getContent().addEventListener(o.POINTERDOWN,function(e){e.stopPropagation()}),i.addEventListener("buttonclick",function(e){console.log("buttonclick")}),i.getContent().addEventListener("focus",function(e){e.preventDefault(),e.stopPropagation()}),i.getContent().addEventListener("change",function(e){n.toggled=e.dsModel.checkFlag,n.toggled?t.onToggle(n):t.onUntoggle(n)}),e.cellView.getContent().setHTML(i)},insertToggleCol:function(){var e=this;this.toggleHeader=this.createToggleHeader();var t={text:this.toggleHeader,width:30,dataIndex:"toggle",isSortable:!1,onCellRequest:function(t){t.isHeader||e.insertToggleCell(t)}};this.insertCol(0,t)},getCol:function(e){for(var t=this.columns.length,n=0;n<t;n++){var i=this.columns[n];if(i.dataIndex==e)return i}return null},selectOccurrences:function(e){for(var t=this.tree.getDocument().getAllDescendants(),n=0;n<t.length;n++){var i=t[n],o=i.options.occId;-1!=e.indexOf(o)?i.select():i.isSelected()&&i.unselect()}},onInitialUpdateView:function(){var e=this;return this._onInitialUpdateViewPromise=this._onInitialUpdateViewPromise||new t.Class.Promise(function(t,n){e.postUpdateViewCalled?t():e.addEvent("onPostUpdateView",function(){setTimeout(function(){t()},100)})}),this._onInitialUpdateViewPromise}})}),define("DS/LifecycleControls/CustomizeColumns",["UWA/Class","DS/LifecycleControls/ChooseAttributes","DS/LifecycleServices/LifecycleServices","i18n!DS/LifecycleControls/assets/nls/CustomizeColumns"],function(e,t,n,i){"use strict";return e.extend({init:function(e,t,n,i){this._parent({}),this.allColumns=n,this.defaultCols=i,this.hWidget=e,this.appId=t},getAll:function(){return this.allColumns},getAlldbKeys:function(){return this.allColumns.map(function(e){return e.dbKey})},load:function(){var e=null;return null==(e=this.hWidget?this.hWidget.getValue(this.appId):JSON.parse(window.localStorage.getItem(this.appId)))&&(e=this.defaultCols,this.save(e)),e},save:function(e){this.hWidget?this.hWidget.setValue(this.appId,e):window.localStorage.setItem(this.appId,JSON.stringify(e))},getAttrDispName:function(e){return"newTarget"==e?i.newTarget:n.getAttributeDisplayName(e)},customizeColumns:function(e,n){for(var o=this,s=this.load(),a=[{name:"title",displayName:this.getAttrDispName("title"),isSelected:!0,disabled:!0}],l=0,r=s.length;l<r;l++){var d=this.allColumns.find(function(e){return s[l]===e.dbKey});d&&a.push({name:d.dbKey,displayName:d.columnNLS,isSelected:!0})}var c=this.allColumns.length;for(l=0;l<c;l++)-1==s.indexOf(this.allColumns[l].dbKey)&&a.push({name:this.allColumns[l].dbKey,displayName:this.allColumns[l].columnNLS,isSelected:!1});t.showDialog({title:i.CustomizeColumns,parent:document.body,allAttributes:a,onShow:function(e){n(e)},onOk:function(t){for(var n=[],i=t.length,s=0;s<i;s++)"title"!=t[s]&&n.push(t[s]);o.save(n),e(n)}})},setParams:function(e,t,n){"string"==typeof e&&e.length&&(this.appId=e),Array.isArray(t)&&t.length&&(this.allColumns=t),Array.isArray(n)&&n.length&&(this.defaultCols=n)}})}),define("DS/LifecycleControls/AdaptiveLayout",["UWA/Controls/Abstract","DS/LifecycleControls/ResizeMonitor","DS/LifecycleServices/ArrayFunctions"],function(e,t,n){"use strict";function i(e){var t=parseInt(e,10);return isNaN(t)?0:t}var o=e.extend({init:function(e){if(this.el=e,!this.el.classList){var t=e;this.el.classList={contains:function(e){return-1!==this._getClassList().indexOf(e)},add:function(e){var t=this._getClassList();-1===t.indexOf(e)&&(t.push(e),this._updateClassList(t))},remove:function(e){var t=this._getClassList(),n=t.indexOf(e);-1!==n&&(t.splice(n,1),this._updateClassList(t))},_getClassList:function(){var e=t.getAttribute("class")||"";return e?e.trim().split(/\s+/):[]},_updateClassList:function(e){t.setAttribute("class",e.join(" "))}}}},hasClass:function(e){return this.el.classList.contains(e)},addClass:function(e){this.el.classList.add(e)},removeClass:function(e){this.el.classList.remove(e)}});return e.extend({init:function(e,n){this.cls=e,this.parentEl=n,this.queries=[],this.currentCls=[],this.queryIdCounter=2,this.currentStyle=0,this.onSizeChangedFn=null,this.onStyleChangedFn=null,this.isMain=!1,this.childGroups=[],this.resizeMon=new t,this.monitoredElements=[],this.currentCls.push(e)},query:function(e,t,n){var i={id:this.queryIdCounter++,query:function(e){var t={};return e.split(";").forEach(function(e){var n=e.split(":");2===n.length&&(t[n[0].trim()]=parseInt(n[1].trim(),10))}),t}(e),cls:[],optional:n||[]};return t.forEach?i.cls=t:i.cls.push(t),this.queries.push(i),this},onSizeChanged:function(e){return"function"==typeof e&&(this.onSizeChangedFn=e),this},onStyleChanged:function(e){return"function"==typeof e&&(this.onStyleChangedFn=e),this},start:function(){return this._init(!0)},stop:function(){this.monitoredElements.forEach(function(e){null!=e&&e.detach()}),this.monitoredElements=[]},restart:function(e){e.forEach?e.forEach(function(e){this._restart(e)},this):this._restart(e)},_restart:function(e){this.cls===e?(this._initAdaptiveElements(),this.currentStyle=0,this._sizeChanged()):this.childGroups.forEach(function(t){t.cls===e&&(t._initAdaptiveElements(),t.currentStyle=0,this._sizeChanged())},this)},_init:function(e){if(this.isMain=e,this._initAdaptiveElements(),this.isMain){var t=this,n=this.resizeMon.addMonitor(this.parentEl,function(){t._sizeChanged()});this.monitoredElements.push(n)}return this.childGroups.forEach(function(e){e._initAsChild()}),this},_initAdaptiveElements:function(){this.elements=Array.prototype.slice.apply(this.parentEl.querySelectorAll("."+this.cls)).map(function(e){return{el:new o(e),restoreCls:[],removeCls:[]}})},childGroup:function(e){return this.childGroups.push(e),this},_initAsChild:function(){this.isMain&&console.error("Ambiguous initialization"),this._init(!1)},_matchQueries:function(e,t){var n=this.queries.find(function(n){return!!(n.query["max-height"]&&t<n.query["max-height"])||(!!(n.query["min-height"]&&t>n.query["min-height"])||(!!(n.query["max-width"]&&e<n.query["max-width"])||!!(n.query["min-width"]&&e>n.query["min-width"])))}),i=n||{id:1,cls:[this.cls],optional:[]},o=!1;return this.currentStyle!==i.id&&(this._changeStyle(i),o=!0),o},_changeStyle:function(e){this.elements.forEach(function(t){t.restoreCls.forEach(function(e){t.el.addClass(e)}),t.restoreCls.length=0,t.removeCls.forEach(function(e){t.el.removeClass(e)}),t.removeCls.length=0,this.currentCls.forEach(function(e){t.el.removeClass(e)}),e.cls.forEach(function(e){t.el.addClass(e)}),e.optional.forEach(function(e){t.el.hasClass(e.from)&&(t.el.removeClass(e.from),t.restoreCls.push(e.from),t.el.addClass(e.to),t.removeCls.push(e.to))})},this),this.currentStyle=e.id,this.currentCls.length=0,this.currentCls.push.apply(this.currentCls,e.cls)},_sizeChanged:function(){var e=this.parentEl.offsetWidth,t=this.parentEl.offsetHeight,n=window.getComputedStyle(this.parentEl),o={width:e-(parseInt(n.paddingLeft,10)+parseInt(n.paddingRight,10)+i(n.borderLeft)+i(n.borderRight)),height:t-(parseInt(n.paddingTop,10)+parseInt(n.paddingBottom,10)+i(n.borderTop)+i(n.borderBottom))},s=this._matchQueries(o.width,o.height);if(this.childGroups.forEach(function(e){e._matchQueries(o.width,o.height)&&(s=!0)}),s&&this.onStyleChangedFn){var a=this.queries.find(function(e){return this.currentStyle===e.id},this),l=a?a.cls[0]:this.cls;this.onStyleChangedFn.call(null,l,o)}this.onSizeChangedFn&&this.onSizeChangedFn.call(null,s,o)}})}),define("DS/LifecycleControls/RelatedObjectsDialog",["UWA/Controls/Abstract","DS/LifecycleControls/WebUXDialog","DS/LifecycleServices/EventHandler","DS/LifecycleControls/RelatedObjectsControl","i18n!DS/LifecycleControls/assets/nls/RelatedObjectsDialog"],function(e,t,n,i,o){"use strict";return e.extend({create:function(e){let s=[],a=new t,l=new i({model:e.model,odtOptions:e.odtOptions,events:{selectionChange:e=>{s=e.selection},viewReady:e=>{a.enableButton(WebUXDialogButton.Ok,!0),this.keydownHandler=new n(document,"keydown",e=>{if(!e.shiftKey&&!e.ctrlKey&&13===e.keyCode){let t=a._buttons[WebUXDialogButton.Ok]||{onClick:()=>{}};t.disabled||t.onClick(),e.preventDefault()}})}}});return new UWA.Promise((t,n)=>{l.load().then(()=>{a.create({container:e.parentContainer,content:l.getContent(),title:o.selectRelatedObjs,zIndex:5e4,initialSize:{width:500,height:200}}).then(e=>{t(s)}).catch(e=>{console.log("RelatedObjectsDialog exception: ",e),n()}).finally(()=>{l.destroy(),this.keydownHandler&&this.keydownHandler.unbind()}),a.enableButton(WebUXDialogButton.Ok,!1)}).catch(()=>{console.warn("ENORIPE_Relations not available for selecting related objects"),t([])})})}})}),define("DS/LifecycleControls/DlgMaximizeHandler",["UWA/Controls/Abstract","DS/LifecycleControls/WidgetMaximizeHandler"],function(e,t){"use strict";return e.extend({init:function(e){var n=this;this.dialog=e,this.isUIVisible=!0,this.isMaximized=!1,this.widgetHandler=new t,this.widgetHandler.addEvent("widget-maxmized-changed",function(e){n._updateHeaderButtons(e),n.dispatchEvent("widget-maxmized-changed",e)}),this._insertMinMaxButtons()},destroy:function(){this.widgetHandler.destroy(),this.widgetHandler=null},isWidgetMaximized:function(){return this.widgetHandler.isMaximized},setUIVisibility:function(e){this.isUIVisible!==e&&(this.isUIVisible=e,this._updateHeaderButtons(this.isMaximized))},_insertMinMaxButtons:function(){var e=this.dialog.elements.header.querySelector(".floatingPanel_RightButtons");if(e){var t=this;this.maxBtn=UWA.createElement("span",{class:"right-actions fonticon fonticon-resize-full ",styles:{display:this.widgetHandler.isMaximized?"none":"inline-block"},events:{click:function(){t._maximize()},touchstart:function(){t._maximize()}}}).inject(e,"top"),this.restoreBtn=UWA.createElement("span",{class:"right-actions fonticon fonticon-resize-small ",styles:{display:this.widgetHandler.isMaximized?"inline-block":"none"},events:{click:function(){t._restore()},touchstart:function(){t._restore()}}}).inject(e,"top")}},_updateHeaderButtons:function(e){this.isMaximized=e,this.isUIVisible?e?(this.maxBtn.setStyle("display","none"),this.restoreBtn.setStyle("display","inline-block")):(this.maxBtn.setStyle("display","inline-block"),this.restoreBtn.setStyle("display","none")):(this.maxBtn.setStyle("display","none"),this.restoreBtn.setStyle("display","none"))},_maximize:function(e){this._updateHeaderButtons(!0),this.restoreRect=this.dialog.elements.container.getBoundingClientRect();var t=this;this.widgetHandler.maximize().then(function(){var n=t.dialog.elements.container.parentElement.getBoundingClientRect();t.dialog._changeWidth(n.width),t.dialog._changeHeight(n.height),t.dialog._resizeContainer(),t.dialog.isMaximized=!0,t.dialog.options.resizable&&!e&&(t.dialog._showResizeContainer(!1),t.oldResizeCB=t.dialog.__showResizeContainerCB,t.dialog.__showResizeContainerCB=function(){})})},_restore:function(){this._updateHeaderButtons(!0);var e=this;this.widgetHandler.restore().then(function(){e.restoreRect&&(e.dialog.isMaximized=!1,e.dialog.setNewSize({width:e.restoreRect.width,height:e.restoreRect.height}),e.dialog._changeLeft(e.restoreRect.left),e.dialog._changeTop(e.restoreRect.top),e.dialog.options.resizable&&(e.dialog.__showResizeContainerCB=e.oldResizeCB))})}})}),define("DS/LifecycleControls/CommandDialog",["UWA/Controls/Abstract","UWA/Core","DS/ENOFloatingPanel/ENOFloatingPanel","DS/UIKIT/Input/Button","DS/UIKIT/Mask","DS/LifecycleCmd/ImageUtil","DS/LifecycleControls/DlgMaximizeHandler","i18n!DS/LifecycleControls/assets/nls/CommandDialog","DS/ENO6WPlugins/jQuery","css!DS/LifecycleControls/LifecycleControls"],function(e,t,n,i,o,s,a,l,r){"use strict";return e.extend({buttonStyle:{ok:1,okCancel:2,none:3,cancel:4},init:function(){this._dialog=null,this._okButton=null,this._cancelButton=null,this._closeButton=null},create:function(e,n,i){var o=n||{};this._onOkHandler=o.onOk||function(){},this._onCloseHandler=o.onClose||function(){},this._enableCmdFn=o.enableCmd||null,this._fnContext=i||this,this._OKBtnText=o.OKBtnText||l.okButton;var s=document.getElementsByClassName("floatingPanelComponent");if(s.length>0){var r=s[0];this.overlayMask=t.createElement("div",{class:"modal-overlay fade EFP_overlay in"}).inject(r,"top")}o.onCloseOverride&&(o.events||(o.events={}),o.events.onClose=o.onCloseOverride);var d=this._createFooter(o.buttonStyle||this.buttonStyle.okCancel),c=(r=void 0===o.overlay||o.overlay,this._createDialog(d,e,o.resizable||!1,o.maximizable||!1,o.closeButton,o.settingsButton||!1,o.settingsCallback||null,o.events||{},o.title,r,o.className||"",o.persistId));this.updateUI();var u=this;return o.powerMaximize&&(this.DlgMaximizeHandler=new a(c),this.DlgMaximizeHandler.addEvent("widget-maxmized-changed",function(e){u.dispatchEvent("widget-maxmized-changed",e)})),c},destroy:function(){this.overlayMask&&(this.overlayMask.remove(),this.overlayMask=void 0),this.DlgMaximizeHandler&&(this.DlgMaximizeHandler.destroy(),this.DlgMaximizeHandler=null),this._dialog&&(this._dialog.destroy(),this._dialog=null)},setTitle:function(e){this._dialog&&this._dialog.setTitle(e)},updateUI:function(){this._cancelButton&&this._cancelButton.setDisabled(!1),this._closeButton&&(this._closeButton.disabled=!1),this._okButton&&(this._okButton.isDisabled()&&(this._okButton.events=null),this._enableCmdFn?this._okButton.setDisabled(!this._enableCmdFn.apply(this._fnContext)):this._okButton.setDisabled(!1))},isWidgetMaximized:function(){return!!this.DlgMaximizeHandler&&this.DlgMaximizeHandler.isWidgetMaximized()},setPowermaximizeVisibility:function(e){this.DlgMaximizeHandler&&this.DlgMaximizeHandler.setUIVisibility(e)},maximize:function(e){this.DlgMaximizeHandler&&this.DlgMaximizeHandler._maximize(e)},restore:function(){this.DlgMaximizeHandler&&this.DlgMaximizeHandler._restore()},maskBody:function(e){if(this._dialog){var t=this._dialog.getBody();t&&o.mask(t,e)}},unmaskBody:function(){if(this._dialog){var e=this._dialog.getBody();e&&o.isMasked(e)&&o.unmask(e)}},_onOk:function(){this._disableUI(),this._onOkHandler.apply(this._fnContext)},_onCancel:function(){this._disableUI(),this._onCloseHandler.apply(this._fnContext),this.destroy()},_disableUI:function(){this._okButton&&this._okButton.setDisabled(!0),this._cancelButton&&this._cancelButton.setDisabled(!0),this._closeButton&&(this._closeButton.disabled=!0)},_disableOK:function(){this._okButton&&this._okButton.setDisabled(!0)},_createFooter:function(e){if(e!==this.buttonStyle.none){var t=document.createElement("div");e===this.buttonStyle.ok?this._okButton=new i({value:this._OKBtnText,className:"primary"}):e===this.buttonStyle.cancel?this._cancelButton=new i({value:l.cancelButton,className:"default"}):(this._okButton=new i({value:this._OKBtnText,className:"primary"}),this._cancelButton=new i({value:l.cancelButton,className:"default"}));var n=this;return this._okButton&&(this._okButton.inject(t),this._okButton.addEvent("onClick",function(){n._onOk()})),this._cancelButton&&(this._cancelButton.inject(t),this._cancelButton.addEvent("onClick",function(){n._onCancel()})),t}},_decreaseAllzIndex:function(e){if(e&&""!==e)for(var t=r("."+e),n=0;n<t.length;n+=1){var i=r(t[n]).css("zIndex");r.isNumeric(i)&&r(t[n]).css("zIndex",i-=1)}},_setToTopzIndex:function(e){r(e).css("zIndex",40040)},_createDialog:function(e,t,i,o,s,a,l,r,d,c,u,h){var m=this;r.onClose||(r.onClose=function(){m._onCancel()}),this._decreaseAllzIndex(u),this._dialog=new n({className:"command_dialog "+u,title:d,footer:e,body:t,overlay:c,escapeToClose:s,closable:s,hasSettings:a,settingsCallback:l,animate:!0,resizable:i,maximizable:o,autocenter:!0,visible:!0,events:r,limitParent:!0,persistId:h}),this._setToTopzIndex(this._dialog.elements.container);var f=this,g=function(){f._decreaseAllzIndex(u),f._setToTopzIndex(f._dialog.elements.container)};return this._dialog.elements.content.addEventListener("touchstart",g,!0),this._dialog.elements.content.addEventListener("mousedown",g,!0),this._dialog}})});