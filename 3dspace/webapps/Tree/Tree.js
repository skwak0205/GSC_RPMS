define("DS/Tree/TreeNodeModel",["DS/TreeModel/TreeNodeModel"],function(e){"use strict";return e}),define("DS/Tree/PanelMdlView",["DS/Core/BaseComponent","DS/Windows/Panel","DS/TreeModel/TreeNodeModel"],function(e,t,n){"use strict";function i(e){for(var t=0;t<this.length;t++)if(this[t].nodeModel===e)return{index:t,item:this[t]}}function o(e){var n,i=new t({title:e.options.label,icon:e.options.icons?e.options.icons[0]:void 0,expandedFlag:e.options.state,immersiveFrame:this.immersiveFrame,resizableFlag:!0,autoCloseFlag:!1,closeButtonFlag:this.closeButtonFlag});this._nodesModel.length>0&&(n=this._nodesModel[0].panel),n&&i.attachToWindow(n,WUXSnapAreaEnum.InsideArea),this._nodesModel.push({value:i.identifier,panel:i,nodeModel:e});var o=this;i.addEventListener("close",function(e){(e.target.dsModel.visibleFlag=!1,o.removeChildOnCloseFlag)&&function(e){for(var t=0;t<this.length;t++)if(this[t].panel===e)return this[t]}.call(o._nodesModel,e.target.dsModel).nodeModel.remove()})}return e.inherit({name:"PanelMdlView",_lockUpdate:!1,_modelDepth:0,_nodesModel:[],publishedProperties:{model:{defaultValue:void 0,type:"DS/TreeModel/TreeNodeModel"},immersiveFrame:{defaultValue:void 0,type:Object},closeButtonFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},removeChildOnCloseFlag:{defaultValue:!1,type:"boolean",category:"Behavior"}},_applyModel:function(){var e=this;if(e._nodesModel&&e._nodesModel.forEach(function(e){e.panel.visibleFlag=!1,e.panel.destroy()}),e._nodesModel=[],e.model){e.model.getChildren().forEach(function(t){o.call(e,t)});var t=e.model?e.model._treeDocument||e.model.getTreeDocument():void 0;t&&(t.onNodeModelUpdate(function(t){if(t&&t.target&&t.target.options&&t.target.options.grid){var n=i.call(e._nodesModel,t.target);if(n&&n.item&&n.item.panel){var o=t.target.options;o.label!==n.item.panel.title&&(n.item.panel.title=o.label),o.icons&&o.icons[0]!==n.item.panel.icon&&(n.item.panel.icon=o.icons[0])}}}),t._bindEventOnDocument("addChild",function(t){t&&t.data&&t.data.nodeModel&&t.data.nodeModel._nodeDepth===e._modelDepth&&o.call(e,t.data.nodeModel)}),t._bindEventOnDocument("removeChild",function(t){t&&t.data&&t.data.nodeModel&&t.parent&&t.parent._nodeDepth===e._modelDepth-1&&function(e){var t=i.call(this._nodesModel,e);t&&t.item&&t.item.panel&&(t.item.panel.destroy(),this._nodesModel.splice(t.index,1))}.call(e,t.data.nodeModel)}))}},_applyProperties:function(e){this._parent(e),this.isDirty("model")&&this._applyModel()},setContent:function(e,t){var n=i.call(this._nodesModel,e);n&&n.item&&n.item.panel&&(n.item.panel.content=t,n.item.content=t)}})}),define("DS/Tree/commands/TreeListViewCommands",["DS/Utilities/Dom"],function(e){"use strict";return{"treelistview:collapse-all-node":function(e){var t=this.getActiveNode(),n=this;t.hasChildren()&&!0===t.isExpanded()&&(this._keymapManager.wait(),t._modelEvents.subscribe({event:"postCollapseAll"},function(){n._keymapManager.listen()}),t.collapseAll())},"treelistview:expand-all-node":function(e){var t=this.getActiveNode(),n=this;!1===t.isExpanded()&&(this._keymapManager.wait(),t.expandAll({onExpandComplete:function(){n._keymapManager.listen()}}))},"treelistview:expand-node":function(e){var t=this.getActiveNode(),n=this;t.hasChildren()&&!1===t.isExpanded()&&(this._keymapManager.wait(),t.onPostExpand(function(){n._keymapManager.listen()}),t.expand())},"treelistview:collapse-node":function(e){var t=this.getActiveNode(),n=this;t.hasChildren()&&!0===t.isExpanded()&&(this._keymapManager.wait(),t.onPostCollapse(function(){n._keymapManager.listen()}),t.collapse())},"treelistview:toggle-selection":function(e){var t=this,n=this.getActiveNode();n.selectionChangeIsFromUI(),n.withTransactionUpdate(function(){var e=t.getNodesXSO();e.isIn(n)?e.remove(n):e.add(n)})},"treelistview:edit-label":function(e){var t=this.getActiveNode(),n=this._getCellView(t._getRowID(),"tree");n&&n.switchToWriteView()},"treelistview:edit-cancel":function(e){this._listOfEditedCells.length>0&&this._listOfEditedCells[0].cellView._cancelChanges(),this._giveFocus(!0)},"treelistview:go-to-next-cell-and-focus":function(){var t=this,n=t._keymapManager._getCurrentEvent();n&&(n.preventDefault(),console.log("prevent default tab"));var i=e.firstParentWithClass(document.activeElement,"wux-datagrid-cell");if(i){var o=i.dsView.getCellInfos(),s=function(n){var o=t.getNumberOfColumns(),l=n.virtualRowID*o+n.virtualColumnID+1,a=Math.floor(l/o),r=l%o;console.log("-"),console.log("current cell in focus",n.virtualRowID,n.virtualColumnID),console.log("next cell in focus",l,":",a,r);var d=t._getCellView2(a,r);t.getCellPosition(a,r);if(d){var c=d.getContent().querySelector(".wux-controls-abstract");c?(console.log("--\x3e",c),c.dsModel._giveFocus()):(console.log("--\x3e",d.elements.container),d.getContent().focus()),e.firstParentWithClass(document.activeElement,"wux-datagrid-cell")===i&&s({virtualRowID:a,virtualColumnID:r})}console.log("next cell in focus",document.activeElement)};s(o)}else console.log("no cell")},"treelistview:select-all":function(){return this.selectAllVisibleNodes(),{preventDefault:!0}},"treelistview:unselect-all":function(){return this.unselectAll(),{preventDefault:!0}},"treelistview:go-to-last-visible-node":function(){var e=this._keymapManager._getCurrentEvent(),t=this.getNodesXSO(),n=!1,i=!1;e&&(e.preventDefault(),e.ctrlKey&&(n=!0),e.shiftKey&&(i=!0));var o,s,l=this.getActiveNode(),a=this.getScroller(),r=this.getCellsContainerSize();for(this.prepareUpdateView(),o=i?this._activeNodeAtShift:l;o;)s=o,o=o.getNextVisibleNode(),!0===i&&t.add(s);if(i){for(var d=[],c=l._getRowID(),u=s._getRowID(),h=this._activeNodeAtShift._getRowID(),p=(u-h)*(c-h)<=0?l:void 0,g=void 0;p&&p!==this._activeNodeAtShift;)(g=p)&&g.isSelected()&&p!==s&&d.push(g),p=c>u?p.getPreviousVisibleNode():p.getNextVisibleNode();d.length>0&&t.remove(d)}!1===i&&!1===n&&t.empty(),!1===n&&t.add(s),this.setActiveNode(s),i||(this._activeNodeAtShift=s),this.pushUpdateView(),a.getContent().scrollTop=r.height},"treelistview:go-to-first-visible-node":function(){var e=this._keymapManager._getCurrentEvent(),t=this.getNodesXSO(),n=!1,i=!1;e&&(e.preventDefault(),e.ctrlKey&&(n=!0),e.shiftKey&&(i=!0));var o,s,l=this.getActiveNode(),a=this.getScroller();for(this.prepareUpdateView(),o=i?this._activeNodeAtShift:l;o;)s=o,o=o.getPreviousVisibleNode(),!0===i&&t.add(s);if(i){for(var r=[],d=l._getRowID(),c=s._getRowID(),u=this._activeNodeAtShift._getRowID(),h=(c-u)*(d-u)<=0?l:void 0,p=void 0;h&&h!==this._activeNodeAtShift;)(p=h)&&p.isSelected()&&h!==s&&r.push(p),h=d>c?h.getPreviousVisibleNode():h.getNextVisibleNode();r.length>0&&t.remove(r)}!1===i&&!1===n&&t.empty(),!1===n&&t.add(s),this.setActiveNode(s),i||(this._activeNodeAtShift=s),this.pushUpdateView(),a.getContent().scrollTop=0},"treelistview:go-to-next-page-node":function(){var e=this._keymapManager._getCurrentEvent(),t=this.getNodesXSO(),n=!1,i=!1;e&&(e.preventDefault(),e.ctrlKey&&(n=!0),e.shiftKey&&(i=!0));var o,s,l,a,r,d=this.getActiveNode(),c=this.getScroller(),u=this.getViewportDimensions(),h=this.getCellsContainerSize().width>u.width?20:0;this.prepareUpdateView(),o=d,!1===i&&!1===n&&t.empty(),l=d._getRowID(),a=this.getRowPosition(l),r=this.getRowHeight(l);var p=u.height-(a+r-this.getScrollerPosition().y);for(p<r&&(p=u.height);p>0&&o;)s=o,(o=o.getNextVisibleNode())&&(l=o._getRowID(),a=this.getRowPosition(l),p-=r=this.getRowHeight(l),!0===i&&(o._getRowID()>this._activeNodeAtShift._getRowID()?t.add(s):t.remove(s)));l=s._getRowID(),a=this.getRowPosition(l),r=this.getRowHeight(l),!1===n&&t.add(s),this.setActiveNode(s),i||(this._activeNodeAtShift=s),this.pushUpdateView(),c.getContent().scrollTop=a-u.height+r+h+4},"treelistview:go-to-previous-page-node":function(){var e=this._keymapManager._getCurrentEvent(),t=this.getNodesXSO(),n=!1,i=!1;e&&(e.preventDefault(),e.ctrlKey&&(n=!0),e.shiftKey&&(i=!0));var o,s,l,a,r,d=this.getActiveNode(),c=this.getScroller(),u=this.getViewportDimensions();this.getCellsContainerSize().width,u.width;this.prepareUpdateView(),o=d,console.log("active node is ",o.getLabel()),!1===i&&!1===n&&t.empty(),l=d._getRowID(),a=this.getRowPosition(l),r=this.getRowHeight(l);var h=a-this.getScrollerPosition().y;for(h<r&&(h=u.height);h>=0&&o;)s=o,(o=o.getPreviousVisibleNode())&&(l=o._getRowID(),a=this.getRowPosition(l),h-=r=this.getRowHeight(l),!0===i&&(o._getRowID()<this._activeNodeAtShift._getRowID()?t.add(s):t.remove(s)));l=s._getRowID(),a=this.getRowPosition(l),r=this.getRowHeight(l),!1===n&&t.add(s),this.setActiveNode(s),i||(this._activeNodeAtShift=s),this.pushUpdateView(),c.getContent().scrollTop=a},"treelistview:go-to-next-node":function(e){var t,n=this.getActiveNode(),i=this;n&&(n.getChildren()?n.isExpanded()?(t=n.getNextVisibleNode())&&(i._shouldBeSelected(t)?i.getNodesXSO().unique(t):i.getNodesXSO().empty(),i._setActiveAndScrollToNode(t)):(this._keymapManager.wait(),n.onPostExpand(function(){i._keymapManager.listen()}),n.expand()):(t=n.getNextVisibleNode())&&(i._shouldBeSelected(t)?i.getNodesXSO().unique(t):i.getNodesXSO().empty(),i._setActiveAndScrollToNode(t)))},"treelistview:go-to-previous-parent-node":function(e){var t=this.getActiveNode(),n=this;if(t)if(t.isExpanded())n._keymapManager.wait(),t.onPostCollapse(function(){n._keymapManager.listen()}),t.collapse(),n._shouldBeSelected(t)?n.getNodesXSO().unique(t):n.getNodesXSO().empty(),n._setActiveAndScrollToNode(t);else if(t.isRoot())n._goToNode(t,-1);else{var i=t.getParent();if(i)n._shouldBeSelected(i)?n.getNodesXSO().unique(i):n.getNodesXSO().empty(),n._setActiveAndScrollToNode(i)}},"treelistview:go-to-previous-visible-node":function(e){var t=this.getActiveNode();this._keymapManager.wait(),this._goToNode(t,-1)},"treelistview:go-to-next-visible-node":function(e){var t=this.getActiveNode();this._keymapManager.wait(),this._goToNode(t,1)},"treelistview:go-to-previous-visible-node-no-empty-xso":function(e){var t=this.getActiveNode();this._keymapManager.wait(),this._goToNode(t,-1,1)},"treelistview:go-to-next-visible-node-no-empty-xso":function(e){var t=this.getActiveNode();this._keymapManager.wait(),this._goToNode(t,1,1)}}}),define("DS/Tree/TreeDocument",["DS/TreeModel/TreeDocument"],function(e){"use strict";return e}),define("DS/Tree/TabMdlView",["DS/Controls/Abstract","DS/Controls/Tab","DS/TreeModel/TreeNodeModel"],function(e,t,n){"use strict";function i(e){for(var t=0;t<this.length;t++)if(this[t].nodeModel===e)return{index:t,item:this[t]}}function o(e){var t=this._tab.addTab(e.options.label,new UWA.createElement("div"),void 0,!0,void 0,e.options.icons&&e.options.icons.length>0?e.options.icons[0]:void 0);this._nodesModel.push({value:t.value,button:t.button,nodeModel:e})}return e.inherit({name:"TabMdlView",_tab:void 0,_lockUpdate:!1,_modelDepth:0,_nodesModel:[],publishedProperties:{model:{defaultValue:void 0,type:"DS/TreeModel/TreeNodeModel"}},buildView:function(){this._parent(),this._tab=new t({multiSelFlag:!0,displayStyle:"panel",showComboBoxFlag:!0}),this._tab.tabBar&&(this._tab.tabBar.editableFlag=!0),this._tab.inject(this.elements.container)},_applyModel:function(){var e=this;if(e._tab&&(e._tab.clear(),e._nodesModel=[],e.model)){var t=e.model.getChildren();t&&t.length>0&&t.forEach(function(t){o.call(e,t)});var n=e.model?e.model._treeDocument||e.model.getTreeDocument():void 0;n&&(n.onNodeModelUpdate(function(t){if(t&&t.target&&t.target.options&&t.target.options.grid){var n=i.call(e._nodesModel,t.target);if(n&&n.item&&n.item.button){var o=t.target.options;o.label!==n.item.button.label&&(n.item.button.label=o.label),o.icons&&o.icons[0]!==n.item.button.icon&&(n.item.button.icon=o.icons[0])}}}),n._bindEventOnDocument("addChild",function(t){t&&t.data&&t.data.nodeModel&&t.data.nodeModel._nodeDepth===e._modelDepth&&o.call(e,t.data.nodeModel)}),n._bindEventOnDocument("removeChild",function(t){if(t&&t.data&&t.data.nodeModel&&t.parent&&t.parent._nodeDepth===e._modelDepth-1){var n=i.call(e._nodesModel,t.data.nodeModel);n&&n.item&&(e._tab.removeTabContent(n.item.value),e._nodesModel.splice(n.index,1))}}))}},_applyProperties:function(e){this._parent(e),this.isDirty("model")&&this._applyModel()},setContent:function(e,t){var n=i.call(this._nodesModel,e);n&&void 0!==n.index&&this._tab&&(this._tab.setPageContentFromIndex(n.index,t),n.item.content=t)},getNodeContent:function(e){var t=i.call(this._nodesModel,e);return t&&void 0!==t.index&&this._tab?this._tab.getPageContentFromIndex(t.index):null},handleEvents:function(){var e=this;if(e.elements.container.addEventListener("change",function(t){if(t&&t.target&&t.target.dsModel&&t.target.dsModel===e._tab&&!e._lockUpdate)t.target.dsModel.value}),e._tab){var t=e._tab.tabBar;t&&t.onEndEditTab(function(t){if(t&&t.button){var n=function(e){for(var t=0;t<this.length;t++)if(this[t].button===e)return this[t]}.call(e._nodesModel,t.button);n&&n.nodeModel.updateOptions({label:t.button.label})}})}}})}),define("DS/Tree/TreeNodeView",["UWA/Core","DS/Spreadsheet/CellView","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents","DS/Utilities/Dom","DS/Utilities/Utils","DS/Controls/TooltipModel"],function(e,t,n,i,o,s,l){"use strict";var a={},r=function(e,t){var n=e;if(n)return(" "+n.className+" ").replace(/[\n\t]/g," ").indexOf(" "+t+" ")>-1?n:r(n.parentNode,t)};function d(e){return e.charAt(0).toUpperCase()+e.slice(1)}var c=t.extend({defaultOptions:{width:"100%",rootMargin:20,childrenMargin:25},init:function(t){this._parent(t),this._cachedIcons=[],this._hasIcons=!1,this._modelEvents=new i({parent:this.getGridEngine()._modelEvents,target:this}),this.elements.container.addClassName("wux-layouts-treeview-cell"),this.elements.layout=new e.Element("ul",{class:"wux-ui-stack-h",styles:{height:"100%",display:"block",position:"relative"}}).inject(this.elements.container),this.elements.linksContainer=new e.Element("li",{class:"wux-layouts-treeview-links"}).inject(this.elements.layout),this.elements.nodeContainer=new e.Element("li",{class:"wux-layouts-treeview-node"}).inject(this.elements.layout),this.elements.expanderContainer=new e.Element("li",{class:"wux-layouts-treeview-expander"}).inject(this.elements.nodeContainer),this.elements.iconsContainer=new e.Element("li",{class:"wux-layouts-treeview-icons"}).hide().inject(this.elements.nodeContainer),this.elements.badgeTopRight=new e.Element("li",{class:"wux-layouts-treeview-badge wux-layouts-treeview-badge-top-right"}).inject(this.elements.iconsContainer),this.elements.badgeTopLeft=new e.Element("li",{class:"wux-layouts-treeview-badge wux-layouts-treeview-badge-top-left"}).inject(this.elements.iconsContainer),this.elements.badgeBottomRight=new e.Element("li",{class:"wux-layouts-treeview-badge wux-layouts-treeview-badge-bottom-right"}).inject(this.elements.iconsContainer),this.elements.badgeBottomLeft=new e.Element("li",{class:"wux-layouts-treeview-badge wux-layouts-treeview-badge-bottom-left"}).inject(this.elements.iconsContainer),this.elements.labelContainer=new e.Element("li",{class:"wux-layouts-treeview-label"}).inject(this.elements.nodeContainer),this._observeEvents()},destroy:function(){this._cellInfos&&(this._cellInfos.nodeModel=null,this._cellInfos=null),this._parent()},_resetCell:function(){this._cellReadWriteView&&this._cellWriteModel===this._getNodeModel()&&this._cellReadWriteView.blur(),o.empty(this.elements.container),this.elements.container.setStyle("padding-left",""),this.unsetBadges();var e=this.getCellInfos();!e.isHeader&&e.dataIndex,this._parent()},_observeEvents:function(){var e,t=this,i=0,s=!1;o.addEventOnElement(this,this.elements.container,n.POINTERDOWN,function(e){s=!1,n.isTouchEvent(e)||(s=t._uiNodeUpForTouchOrDownForMouse(e,"down"))}),o.addEventOnElement(this,this.elements.container,"click",function(o){if(!o.target.classList.contains("wux-layouts-treeview-expander")){var l=t.getCellInfos();if(s||!1!==l.isHeader||"selection"===l.dataIndex||t._uiNodeUpForTouchOrDownForMouse(o,"up"),s=!1,void 0!==e&&clearTimeout(e),e=setTimeout(function(){i=0},300),i++,1===o.which){if(1===i||n.isTouchEvent(o)&&0===o.detail){l=t.getCellInfos();t.getGridEngine()._recordInteractionFromUI({event:"node:click",data:{nodeRecordPath:l.nodeModel&&l.nodeModel.getStructurePath?l.nodeModel.getStructurePath():l.nodeModel,virtualRowID:l.virtualRowID,virtualColumnID:l.virtualColumnID}}),t.getGridEngine()._modelEvents.publish({event:"nodeclick",data:l})}2===i&&t.getGridEngine()._modelEvents.publish({event:"nodeDblClick",data:t.getCellInfos()})}}}),this._eventDetailDown=0,this._eventDetailDownTO;var l=function(e){"touchend"===e.type&&e.preventDefault(),1!==e.which&&"touchend"!==e.type||t._uiExpandCollapse()};o.addEventOnElement(this,this.elements.expanderContainer,"mouseup",l),o.addEventOnElement(this,this.elements.expanderContainer,"touchend",l);var a=function(e){e.stopPropagation(),e.preventDefault()};o.addEventOnElement(this,this.elements.expanderContainer,"contextmenu",a),o.addEventOnElement(this,this.elements.expanderContainer,n.LONGHOLD,a)},_selectionAlgorithm:function(e,t){var i=this,o=!1,s=i.getGridEngine().options.selection.canMultiSelect&&(e.ctrlKey||i.getGridEngine().isInMultiSelection()),l=i.getGridEngine().options.selection.canMultiSelect&&e.shiftKey&&i.getGridEngine().options.selection.enableListSelection,a=i.getCellInfos(),d=i.getGridEngine(),c=d.getDocument();if(!e.target.classList.contains("wux-layouts-treeview-expander")&&!r(e.target,"wux-controls-toggle")&&!1===a.isHeader&&!1===d.options.selection.cells){var u=a.nodeModel;if(l||(d._activeNodeAtShift=u),d.options.selection.nodes)if(d.options.selection.toggle&&!l)u.isSelected()?"up"===t&&(i.__unselectNode(u),o=!0):(i.__selectNode(u,!s),o=!0);else if(l){var h,p=c.getXSO().get();h=0===p.length?c.getChildren()[0]:!0===d._getParent().options.enableActiveUI||d.options.selection.toggle?d._activeNodeAtShift?d._activeNodeAtShift:d.getActiveNode():p[0];var g=u;c.withTransactionUpdate(function(){e.ctrlKey||c.getXSO().empty();var t=[];if(h._getRowID()<g._getRowID())for(var n=h._getRowID();n<=g._getRowID();n++)t.push(n);else for(n=h._getRowID();n>=g._getRowID();n--)t.push(n);var s=[];return t.forEach(function(e){var t=d.getTreeNodeModelFromRowID(e);c.options.shouldBeSelected.call(c,t)&&s.push(t)}),i.__selectNodes(s),o=!0,{updateType:WUXModelUpdateTypes.Selection}})}else u.isSelected()?s?n.isTouchEvent(e)&&u.getTreeDocument().getXSO().get().length>0&&u.getTreeDocument().getXSO().isIn(u)?(i.__unselectNode(u),o=!0):"up"===t&&(i.__unselectNode(u),o=!0):0===u.getTreeDocument().getXSO().get().length?(i.__selectNode(u),o=!0):"up"===t&&u.getTreeDocument().getXSO().get().length>1&&(i.__selectNode(u,!s),o=!0):(i.__selectNode(u,!s),o=!0)}return o},_uiNodeUpForTouchOrDownForMouse:function(e,t){var n=!1;return 1!==e.which&&"touchstart"!==e.type||(n=this._selectionAlgorithm(e,t)),n},_uiExpandCollapse:function(){var e=this;e.getGridEngine()._giveFocus();var t=e._cellModel.getCellContent();t.getChildren()&&"noExpandState"!==e._expandState&&"expandingState"!==e._expandState&&(t.isExpanded()&&"partiallyExpandedState"!==t._expandState?t.collapse():(e._setExpanderState("expandingState"),t.expand()));var n=e.getCellInfos();e.getGridEngine()._recordInteractionFromUI({event:"node:expand-collapse",data:{nodeRecordPath:n.nodeModel?n.nodeModel.getStructurePath():n.nodeModel,virtualRowID:n.virtualRowID,virtualColumnID:n.virtualColumnID}})},_isSelected:function(){var e=this.getCellInfos();return e.manager.getNodesXSO().isIn(e.nodeModel)},__selectNodes:function(e){var t=this.getCellInfos();e&&e.length>0&&(e.forEach(function(e){e.selectionChangeIsFromUI()}),t.manager.getNodesXSO().add(e),e.forEach(function(e){t.manager._recordInteractionFromUI({event:"selection:add",data:{nodeRecordPath:e.getStructurePath(),virtualRowID:t.virtualRowID,virtualColumnID:t.virtualColumnID}})}),this.getGridEngine().setActiveNode(e[e.length-1]))},__selectNode:function(e,t){var n=this.getCellInfos(),i=n.manager._shouldBeSelected(n.nodeModel);e&&i&&(e.selectionChangeIsFromUI(),t?(e.withTransactionUpdate(function(){return n.manager.getNodesXSO().unique(e),{updateType:WUXModelUpdateTypes.Selection}}),n.manager._recordInteractionFromUI({event:"selection:unique",data:{nodeRecordPath:e.getStructurePath(),virtualRowID:n.virtualRowID,virtualColumnID:n.virtualColumnID}})):(e.withTransactionUpdate(function(){return n.manager.getNodesXSO().add(e),{updateType:WUXModelUpdateTypes.Selection}}),n.manager._recordInteractionFromUI({event:"selection:add",data:{nodeRecordPath:e.getStructurePath(),virtualRowID:n.virtualRowID,virtualColumnID:n.virtualColumnID}}))),this.getGridEngine().setActiveNode(e)},__unselectNodes:function(e){var t=this.getCellInfos();e&&e.length>0&&(e.forEach(function(e){e.selectionChangeIsFromUI()}),t.manager.getNodesXSO().remove(e),e.forEach(function(e){t.manager._recordInteractionFromUI({event:"selection:remove",data:{nodeRecordPath:e.getStructurePath(),virtualRowID:t.virtualRowID,virtualColumnID:t.virtualColumnID}})}),this.getGridEngine().setActiveNode(e[e.length-1]))},__unselectNode:function(e){var t=this.getCellInfos(),n=t.manager._shouldBeSelected(t.nodeModel);e&&n&&!0===t.manager.getNodesXSO().isIn(e)&&(e.selectionChangeIsFromUI(),e.withTransactionUpdate(function(){return t.manager.getNodesXSO().remove(e),{updateType:WUXModelUpdateTypes.Selection}}),t.manager._recordInteractionFromUI({event:"selection:remove",data:{nodeRecordPath:e.getStructurePath(),virtualRowID:t.virtualRowID,virtualColumnID:t.virtualColumnID}}))},getCellInfos:function(){return this._cellInfos||(this._cellInfos=this._parent(),"tree"===this._cellInfos.dataIndex&&this._cellInfos.virtualRowID>=0?(this._cellInfos.nodeView=this,this._cellInfos.cellModel&&(this._cellInfos.nodeModel=this._cellInfos.cellModel.getCellContent())):this._cellInfos.nodeModel=this._cellInfos.manager.getTreeNodeModelFromRowID(this._cellInfos.virtualRowID)),this._cellInfos},_updateToolTip:function(){var e=this.getCellInfos(),t=this.elements,n=!!this._getParentView().options.shouldDisplayTooltip&&this._getParentView().options.shouldDisplayTooltip(e);!1===n&&t.container.setAttribute("title",""),n?"tree"!==e.dataIndex||e.isHeader?e.cellModel.options.value?"string"==typeof e.cellModel.options.value?this._setTooltip(t.container,n):(e.cellModel.options.value.toString,this._setTooltip(t.container,n)):this._setTooltip(t.container,n):(this._setTooltip(t.container,{shortHelp:""}),this._setTooltip(t.labelContainer,n),this._setTooltip(t.iconsContainer,n)):this._setTooltip(t.container,{shortHelp:""})},_setTooltip:function(e,t){t.longHelp&&(t.shortHelp=t.longHelp,t.longHelp=""),e.tooltipInfos=new l(t)},updateInternalParameters:function(){var e=this.getCellInfos(),t=this.elements;if(this._dataGrid=this.options.parent,this._manager=e.manager,this._cellModel=e.cellModel,e.isHeader||(e.cellModel._isInWriteMode=!1),this._updateToolTip(),!e.isHeader&&e.nodeModel){var n=e.manager._isCellEditable(e);t.container.setAttribute("is-editable",n),e.nodeModel.isMatchingSearch()?(t.labelContainer.addClassName("wux-ui-state-match"),this._hasBeenMatchedForSearch=!0):this._hasBeenMatchedForSearch&&(t.labelContainer.removeClassName("wux-ui-state-match"),this._hasBeenMatchedForSearch=!1)}this._parent();var i=!!this._getParentView().options.selection.preSelection&&this._getParentView().options.selection.preSelection;i&&this.getContent().removeClassName("wux-datagrid-cell-prehighlighted"),this.getContent().removeClassName("wux-datagrid-cell-highlighted"),e.virtualRowID>-1&&(i&&e.nodeModel&&e.nodeModel.isPreSelected()&&this.getContent().addClassName("wux-datagrid-cell-prehighlighted"),(this._isSelected()||this._isHighlighted)&&this.getContent().addClassName("wux-datagrid-cell-highlighted"))},_getParentView:function(){return this.getGridEngine()._getParent()},_getNodeModel:function(){var e=this.getVirtualCoordinates();return this._manager.getCell(e.virtualRowID,"tree").getCellContent()},_getRelativeIncrementFactor:function(e){return this.options.childrenMargin},_setDepth:function(e){var t=this.getCellInfos(),n=t.nodeModel,i=t.manager,o=this.elements;void 0===e&&(e=n.getParents().length);var s=this.options.rootMargin,l=this.options.childrenMargin;o.container.setStyle("padding-left",s);var r=0;if(i.options.performances.buildLinks){var d,c,u,h="",p="<span>";for(g=0;g<e;g++){r+=l=this._getRelativeIncrementFactor(g),h=h+(d=(u=n.getNthParent(e-1-g))&&u.isLastChild()&&g<=e-2?"border-color:transparent":"")+(c=g===e-1&&n.isLastChild()?"50%":"100%"),p=p+'<li class="wux-layouts-treeview-link" data-parentislastchild="'+(n.getParent()&&n.getParent().isLastChild()&&g<=e-1?"true":"false")+'" data-islastchild="'+(n.isLastChild()?"true":"false")+'" data-depth="'+g+"/"+(e-1)+'" style="'+d+";height: "+c+";margin-right:"+((g===e-1?0:l)-1)+"px;margin-left:"+(0===g?l:0)+'px"></li>'}p+="</span>",void 0===a[h]?(o.linksContainer.innerHTML=p,a[h]=p,o.linksContainer.inject(this.elements.layout,"top")):o.linksContainer.innerHTML=a[h],o.linksContainer.setStyle("width",r),o.nodeContainer.setStyle("left",r)}else{for(var g=0;g<e;g++){r+=l=this._getRelativeIncrementFactor(g)}o.linksContainer.setStyle("width",r),o.nodeContainer.setStyle("left",r)}this._nodeOffsetX=r+s+2,o.container.setAttribute("data-node-depth",e)},_updateView:function(){var e=this.getCellInfos(),t=e.cellModel,n=e.nodeModel;t._isInWriteMode?(!0===this._dataGrid.options.enableDragAndDrop&&this.getContent().setAttribute("draggable",!1),"tree"!==e.dataIndex||e.isHeader||(n.options.oldLabel=n.options.label),this._buildWriteView()):(!0===this._dataGrid.options.enableDragAndDrop&&this.getContent().setAttribute("draggable",!0),this._buildReadView())},_setExpanderState:function(e){if(e){this.elements.expanderContainer.setAttribute("data-wux-state",{noExpandState:"noChildren",expandingState:"expanding",partiallyExpandedState:"partiallyExpanded",collapseState:"expanded",expandState:"collapsed",noChildren:"noChildren",noChildrenExpanded:"noChildren",noChildrenCollapsed:"noChildren",expanding:"expanding",partiallyExpanded:"partiallyExpanded",expanded:"expanded",collapsed:"collapsed"}[e])}},notifyModelUpdate:function(){this._getNodeModel().notifyModelUpdate(),this._parent()},_cancelChanges:function(){this._getNodeModel().options.label=this._getNodeModel().options.oldLabel,this.switchToReadView()},setLabel:function(t){var i=this;function l(e){return e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),i.elements.container.scrollLeft=0,!1}if(this.isInEditionMode()){var a=new e.Element("input",{type:"text",value:t,tabindex:"-1",class:"wux-tree-label-input wux-ui-state-clearable",styles:{"box-sizing":"border-box"},events:{dragstart:function(e){e.preventDefault(),e.stopPropagation()},keypress:function(e){i.elements.container.scrollLeft=0},keydown:function(e){r(!0)},keyup:function(e){i.elements.container.scrollLeft=0},change:function(e){},focusin:function(e){e.preventDefault()},focus:function(e){e.preventDefault(),e.stopPropagation()},mousemove:function(e){this.offsetWidth-18<e.clientX-this.getBoundingClientRect().left?this.style.cursor="default":this.style.cursor="text"},click:function(e){e.stopPropagation(),this.offsetWidth-26<e.clientX-this.getBoundingClientRect().left&&(this.value=i._getNodeModel().options.label,i.switchToReadView(),i._lastClickTime=Date.now())},mouseup:function(e){e.stopPropagation()},mousedown:function(e){e.stopPropagation()},touchstart:function(e){e.stopPropagation()},touchend:function(e){e.stopPropagation()}}}),r=function(t){if(i._cellReadWriteView){i.elements.container.scrollLeft=0;var n=i.elements.nodeContainer.getDimensions().width-i.elements.expanderContainer.getDimensions().width-i.elements.iconsContainer.getDimensions().width-24,o=function(t,n,i){var o=window.getComputedStyle(n,null).getPropertyValue("font-size"),l=parseFloat(o),a=new e.Element("span",{styles:{opacity:1,fontSize:l,padding:5}}).inject(n,"top");!0===s.getUnsafeHTMLContentValueToApply(i)?a.innerHTML=t:a.innerText=t;var r=a.offsetWidth;return a.remove(),r}(a.value+" ",i.elements.labelContainer,i.getGridEngine().options.shouldCellAllowUnsafeHTMLContentAt(i.getCellInfos()))+20;a.style.width=o+"px",a.style.maxWidth=n+"px",t||i._cellReadWriteView.setSelectionRange(0,i._cellReadWriteView.value.length)}};a.addEventListener("compositionupdate",function(){r(!0)}),i.elements.container.addEventListener("scroll",l,!0),i.elements.container.scrollLeft=0,setTimeout(function(){r()},0),this.elements.labelContainer.innerHTML="",this.elements.labelContainer.setContent(a),this._cellReadWriteView=a,this._cellWriteModel=this._cellInfos.nodeModel,a.focus(),o.addEventOnElement(this,document.body,n.POINTERDOWN,function e(t){i.isInEditionMode()&&(document.selection&&document.selection.empty?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),i._cellReadWriteView&&i._cellReadWriteView.value!==i._getNodeModel().options.label&&i._cellWriteModel===i._getNodeModel()&&(i._getNodeModel().options.label=i._cellReadWriteView.value,i.notifyModelUpdate()),i.switchToReadView(),setTimeout(function(){i.getGridEngine()._giveFocus()},1)),o.removeEventOnElement(i,document.body,n.POINTERDOWN,e),i._cellWriteModel=void 0})}else{i.elements.container.removeEventListener("scroll",l),"number"==typeof t&&(t=t.toString()),this.elements.labelContainer.layoutDsModel=this._dataGrid;var d=this.getCellInfos();!1===s.getUnsafeHTMLContentValueToApply(this.getGridEngine().options.shouldCellAllowUnsafeHTMLContentAt(d))?this.elements.labelContainer.setText(t):this.elements.labelContainer.setContent(t)}},unsetBadges:function(){this.elements.badgeTopLeft.style.backgroundImage="",this.elements.badgeTopLeft.style.visibility="hidden",this.elements.badgeBottomLeft.style.backgroundImage="",this.elements.badgeBottomLeft.style.visibility="hidden",this.elements.badgeTopRight.style.backgroundImage="",this.elements.badgeTopRight.style.visibility="hidden",this.elements.badgeTopRight.className="",this.elements.badgeTopRight.addClassName("wux-layouts-treeview-badge wux-layouts-treeview-badge-top-right"),this.elements.badgeBottomRight.style.backgroundImage="",this.elements.badgeBottomRight.style.visibility="hidden",this.elements.badgeBottomRight.className="",this.elements.badgeBottomRight.addClassName("wux-layouts-treeview-badge wux-layouts-treeview-badge-bottom-right")},setBadges:function(e){for(var t in e){var n=e[t];n&&(o.generateIcon(n,{target:this.elements["badge"+d(t)]}),this.elements["badge"+d(t)].style.visibility="visible")}},setIcons:function(t){var n=this,i=0;if(this._removeAllIcons(),t){if(Array.isArray(t)){if(this._icons=e.clone(t),t){var o=document.createDocumentFragment();t.forEach(function(e){var t=c._buildIcon(e);n._cachedIcons.push(t),o.appendChild(t)}),this.elements.iconsContainer.appendChild(o)}i=t.length}"string"==typeof t&&(i=1,n.addIcon(t,"css"))}this.elements.iconsContainer.setAttribute("wux-has-icon",i>0),this._hasIcons||(this.elements.iconsContainer.style.display="inline-flex",this._hasIcons=!0)},select:function(){this._lastClickTime=Date.now(),this._parent()},addIcon:function(e,t){var n=c._buildIcon(e,t);this._cachedIcons.push(n),this.elements.iconsContainer.appendChild(n)},_removeAllIcons:function(){this.elements.iconsContainer.removeAttribute("wux-icon-name"),this._cachedIcons.forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)}),this._cachedIcons=[]}});return c._buildIcon=function(e,t){var n=o.createElement("div",{class:"wux-layouts-treeview-icon"});switch(t){case"css":n.setAttribute("icon-type","css"),n.setAttribute("wux-icon-name",e);break;default:if("string"==typeof e)n.setAttribute("icon-type","css"),n.style.backgroundImage="url("+e+")";else if(e instanceof Object&&e.iconPath){n.setAttribute("icon-type","css"),(i=o.generateIcon(e))&&(e.tooltipInfos&&(i.tooltipInfos=new l(e.tooltipInfos)),n.appendChild(i))}else{var i;n.setAttribute("icon-type","fonticon"),(i=o.generateIcon(e))&&(e.tooltipInfos&&(i.tooltipInfos=new l(e.tooltipInfos)),n.appendChild(i))}}return n},c}),define("DS/Tree/AccordionMdlView",["DS/Controls/Abstract","DS/Controls/Accordeon","DS/TreeModel/TreeNodeModel"],function(e,t,n){"use strict";function i(e){for(var t=0;t<this.length;t++)if(this[t].nodeModel===e)return{index:t,item:this[t]}}function o(e){if(this._accordion){var t=this._accordion.addItem({header:e.options.label,icon:e.options.icons&&e.options.icons.length>0?e.options.icons[0]:void 0});this._nodesModel.push({id:t,nodeModel:e})}}return e.inherit({name:"AccordionMdlView",_accordion:void 0,_lockUpdate:!1,_modelDepth:0,_nodesModel:[],publishedProperties:{model:{defaultValue:void 0,type:"DS/TreeModel/TreeNodeModel"},style:{defaultValue:"filled-separate",type:"string",category:"Appearance"}},buildView:function(){this._parent(),this._accordion=new t({exclusive:!1}),this._accordion.inject(this.elements.container)},_applyModel:function(){var e=this;if(e._accordion&&(e._accordion.clear(),e._nodesModel=[],e.model)){var t=e.model.getChildren()&&e.model.getChildren().length>0?e.model.getChildren():e.model.options.asyncChildren;t&&t.length>0&&t.forEach(function(t){o.call(e,t)});var n=e.model?e.model._treeDocument||e.model.getTreeDocument():void 0;n&&(n.onNodeModelUpdate(function(t){if(t&&t.target&&t.target.options&&t.target.options.grid){var n=i.call(e._nodesModel,t.target);if(n&&n.item&&e._accordion){var o=t.target.options,s=e._accordion.getIndexFromId(n.item.id);s>-1&&e._accordion.updateItem(s,{header:o.label,icon:o.icons&&o.icons.length>0?o.icons[0]:void 0})}}}),n.onPostExpand(function(t){if(t&&t.data&&t.data.nodeModel&&t.data.nodeModel._nodeDepth===e._modelDepth){var n=i.call(e._nodesModel,t.data.nodeModel);if(n&&n.item&&e._accordion){var o=e._accordion.getIndexFromId(n.item.id);o>-1&&e._accordion.expandItem(o)}}}),n.onPostCollapse(function(t){if(t&&t.data&&t.data.nodeModel&&t.data.nodeModel._nodeDepth===e._modelDepth){var n=i.call(e._nodesModel,t.data.nodeModel);if(n&&n.item&&e._accordion){var o=e._accordion.getIndexFromId(n.item.id);o>-1&&e._accordion.closeItem(o)}}}),n._bindEventOnDocument("addChild",function(t){t&&t.data&&t.data.nodeModel&&t.data.nodeModel._nodeDepth===e._modelDepth&&o.call(e,t.data.nodeModel)}),n._bindEventOnDocument("removeChild",function(t){if(t&&t.data&&t.data.nodeModel&&t.parent&&t.parent._nodeDepth===e._modelDepth-1){var n=i.call(e._nodesModel,t.data.nodeModel);if(n&&n.item&&e._accordion){var o=e._accordion.getIndexFromId(n.item.id);o>-1&&e._accordion.deleteItem(o),e._nodesModel.splice(n.index,1)}}}))}},_applyStyle:function(e){this._accordion.style=this.style},_applyProperties:function(e){this._parent(e),this.isDirty("model")&&this._applyModel()},setContent:function(e,t){var n=i.call(this._nodesModel,e);if(n&&n.item&&this._accordion){var o={body:t};this._accordion.updateItem(this._accordion.getIndexFromId(n.item.id),o)}},handleEvents:function(){var e=this;function t(t){return function(n){if(n&&n.target&&n.target.dsModel&&n.options&&n.options.expanderIndex>-1&&!e._lockUpdate){var i=function(e){for(var t=0;t<this.length;t++)if(this[t].id===e)return this[t]}.call(e._nodesModel,n.options.expanderIndex);i&&i.nodeModel&&i.nodeModel[t]()}}}e.elements.container.addEventListener("expand",t("expand")),e.elements.container.addEventListener("collapse",t("collapse"))}})}),define("DS/Tree/TreeNavigation",["UWA/Core","UWA/Controls/Abstract","DS/Controls/TreeBase","DS/Controls/TreeNodeBase","DS/Layouts/SlidingViews","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Layouts/ListView","DS/Tree/TreeDocument","DS/Layouts/ListViewCellAbstract","DS/CoreEvents/ModelEvents","DS/Tree/TreeNodeView"],function(e,t,n,i,o,s,l,a,r,d,c,u){"use strict";function h(t){var n,i=t.cellInfos.cellModel||t.cellInfos.nodeModel,o=t.controller;n=i.options.isTerminal?i._nodeDepth:i._nodeDepth+1;var s=o.getView(n);if(s||(s=o.addView({title:e.clone(i.options.label),content:{html:null,iframe:!1,onLoad:function(){}}})),t.cellInfos.node=i,t.cellInfos.nodeModel=i,t.cellInfos.page=s,!i.options.isTerminal){s.setBackTitle(e.clone(i.getParent().options.label)),s.setTitle(e.clone(i.options.label));var l=i.getChildren();s.elements.pageContent.empty(),i.options.content&&s.addContent(i.options.content),l&&(s._listView.inject(s.elements.pageContent),s._listView.updateModel(l));var a=i._nodeDepth+1;o.goToNthView(a)}t.treeNavigation._modelEvents.publish({event:"SELECT",data:t.cellInfos,context:t.context})}function p(e){var t=new a({model:e.model,height:"auto",cellClass:g,defaultCellHeight:40});return t.onCellRequest(function(e){var t=e.cellModel.options.label.toString();e.cellView.getContent().innerHTML=t,"header"===e.cellModel.options.type?e.cellView.getContent().addClassName("wux-layouts-treenavigation-header"):e.cellView.getContent().removeClassName("wux-layouts-treenavigation-header")}),t.onCellClick(function(t){"header"!==t.cellModel.options.type&&(t.cellModel.hasChildren()?t.cellModel.expand():h({cellInfos:t,treeNavigation:e.treeNavigation,controller:e.controller}))}),t}var g=d.extend({init:function(e){this._parent(e)},updateInternalParameters:function(e){var t=this.getCellInfos(),n=t.cellModel,i=t.cellView;t.virtualRowID>-1&&t.virtualColumnID>-1&&(i.getContent().setAttribute("has-children",n.hasChildren()),n.options.type?i.getContent().setAttribute("type",n.options.type):i.getContent().removeAttribute("type"),n.options.keywords&&n.options.keywords.indexOf("new")>-1?i.getContent().setAttribute("is-new",!0):i.getContent().removeAttribute("is-new"),n.options.keywords&&n.options.keywords.indexOf("update")>-1?i.getContent().setAttribute("is-updated",!0):i.getContent().removeAttribute("is-updated"),n.options.keywords&&n.options.keywords.indexOf("dev")>-1?i.getContent().setAttribute("is-dev",!0):i.getContent().removeAttribute("is-dev"),n.options.keywords&&n.options.keywords.indexOf("deprecated")>-1?i.getContent().setAttribute("is-deprecated",!0):i.getContent().removeAttribute("is-deprecated")),this._parent(e)}}),m=t.extend({defaultOptions:{treeNavigation:null,controller:null,model:[]},init:function(e){this._parent(e),this._buildView(),this._buildListView(),this.setBackTitle()},_buildListView:function(){this._listView=p({model:"value",context:this,treeNavigation:this.options.treeNavigation,controller:this.options.controller}),this._listView.inject(this.elements.pageContent)},_buildView:function(){var t=this;this.elements.container=new e.Element("div",{class:"wux-layouts-treenavigation-page-content",styles:{height:"inherit"}}),this.elements.topHeader=new e.Element("ul",{class:"wux-layouts-treenavigation-topheader"}).inject(this.elements.container),this.elements.topHeaderLeft=new e.Element("li",{class:"wux-layouts-treenavigation-topheader-left",styles:{float:"left"}}).inject(this.elements.topHeader),this.elements.topHeaderTitle=new e.Element("li",{class:"wux-layouts-treenavigation-topheader-title wux-font-3dsregular"}).inject(this.elements.topHeader),this.elements.topHeaderRight=new e.Element("li",{class:"wux-layouts-treenavigation-topheader-right"}).inject(this.elements.topHeader),this.elements.pageContent=new e.Element("div",{class:"wux-layouts-treenavigation-pageContent"}).inject(this.elements.container),this.elements.topHeaderLeft.addEventListener(s.POINTERUP,function(e){t.options.controller.goToPreviousView()})},goToChildren:function(t){var n=this.options.controller;if(n){var i=n.getView(t._nodeDepth+1);i||(i=n.addView({title:e.clone(t.options.label),content:{html:null,iframe:!1,onLoad:function(){}}})),i.setBackTitle(t.getParent().options.label),i.setTitle(t.options.label);var o=t.getChildren();i.elements.pageContent.empty(),t.options.content?i.addContent(t.options.content):o&&(i._listView.inject(i.elements.pageContent),i._listView.updateModel(o));var s=t._nodeDepth+1;return n.goToNthView(s),i}},setHTML:function(e){this.elements.pageContent.setHTML(e)},addContent:function(e){this.elements.pageContent.appendChild(e)},empty:function(){},updateLeftTitle:function(){var t=new e.Element("span",{html:this.options.leftTitle}),n=this;l.onNodeRendered(t,function(){setTimeout(function(){t.getDimensions().height>n.elements.topHeaderLeft.getDimensions().height?n.elements.topHeaderLeft.setStyles({lineHeight:"15px",fontSize:10}):n.elements.topHeaderLeft.setStyles({lineHeight:"30px",fontSize:""}),t.getDimensions().width>=n.elements.topHeaderLeft.getDimensions().width-5&&n.elements.topHeaderLeft.setStyles({fontSize:10})},100)}),this.options.leftTitle&&""!==this.options.leftTitle&&(this.elements.topHeaderLeft.show(),this.elements.topHeaderLeft.setHTML(t))},setBackTitle:function(e){this.options.leftTitle=e,this.updateLeftTitle()},setRightTitle:function(t){var n=new e.Element("span",{html:t}),i=this;l.onNodeRendered(n,function(){setTimeout(function(){n.getDimensions().height>i.elements.topHeaderRight.getDimensions().height?i.elements.topHeaderRight.setStyles({lineHeight:"15px",fontSize:10}):i.elements.topHeaderRight.setStyles({lineHeight:"30px",fontSize:""}),n.getDimensions().width>=i.elements.topHeaderRight.getDimensions().width-5&&i.elements.topHeaderRight.setStyles({fontSize:10})},1)}),t?(this.elements.topHeaderRight.show(),this.elements.topHeaderRight.setHTML(n)):this.elements.topHeaderRight.hide()},setTitle:function(e){this.elements.topHeaderTitle.setHTML(e)}});return t.extend({defaultOptions:{defaultCellHeight:60},init:function(t){this._parent(t),this._modelEvents=new c,this._dataModel=new r,this.elements.container=new e.Element("div",{class:"wux-layouts-treenavigation",styles:{}}),this.options.roots&&(this._dataModel.loadModel(this.options.roots),this.loadModel(this._dataModel))},getModel:function(){return this._dataModel},loadModel:function(e){var t=this;this._dataModel=e,this._controller=new o({kinetic:!1,showPager:!1,pageBuilder:function(e){return new m({treeNavigation:t,controller:this})}}),this._controller.getContent().setStyles({height:"inherit"}),this._backID=-1,this._onBack=null,this._buildView(),this._indexTree(),this._getController().onViewChange(function(){t._modelEvents.publish({event:"CHANGE_PAGE"})}),this._dataModel.onPostExpand(function(e){h({cellInfos:e.data,treeNavigation:t,controller:t._getController()})})},_indexNode:function(e,t,n,i){var o=this;void 0===n&&(n=[]),t++;var s=n.slice();void 0!==i&&(s.push(i),e.options["@view"]=e.getContent(),e.options["@path"]=s,this._searchIndex.push(e.options)),e.getChildren()&&(t++,e.getChildren().forEach(function(e,n){o._indexNode(e,t,s,n)}))},_indexTree:function(){this._searchIndex=[];var t=this._getController().getCurrentView();this._searchResults=new e.Element("div",{class:"wux-layouts-treenavigation-search-layer"}).hide(),t.addContent(this._searchResults)},search:function(e){var t=this;if(this._getController().getCurrentView().addContent(this._searchResults),e){this._searchResults.empty(),this._searchResults.show();var n=p({model:this._dataModel.search({match:function(t){if("header"!==t.nodeModel.options.type&&-1!==t.nodeModel.options.label.toLowerCase().indexOf(e))return!0}}),context:this,treeNavigation:this,controller:this._controller});n.onCellClick(function(e){console.log("path",e.cellModel.getPath()),t._searchResults.hide(),e.cellModel.getPath().forEach(function(e){e.expand()})}),n.inject(this._searchResults)}else this._searchResults.hide()},_getController:function(){return this._controller},_buildView:function(){this.elements.container.empty(),this.elements.viewContent=new e.Element("div",{class:"wux-layouts-treenavigation-content",html:"",styles:{height:"inherit"}}).inject(this.elements.container),this._controller.getContent().inject(this.elements.viewContent);this._controller.addView({title:"Root",content:{html:null,iframe:!1,onLoad:function(){}}}),this._controller.getView(0)._listView.updateModel(this._dataModel.getRoots())},onNodeSelection:function(e){return this._modelEvents.subscribe({event:"SELECT"},function(t){e.call(this,t)})},onBack:function(e){return this._modelEvents.subscribe({event:"BACK"},e)},onPageChange:function(e){return this._modelEvents.subscribe({event:"CHANGE_PAGE"},e)},setTitle:function(e){this._dataModel._getTrueRoot().options.label=e,this._getController().getCurrentView().setTitle(e)},setRightTitle:function(e){this._getController().getCurrentView().setRightTitle(e)},_setBackID:function(e){this._backID=e},_getBackID:function(e){return this._backID}})}),define("DS/Tree/Manager",["UWA/Core","UWA/Class","DS/Spreadsheet/Manager","DS/TreeModel/TreeNodeModel","DS/Utilities/Array","DS/Tree/TreeDocument","DS/Core/PointerEvents","DS/Controls/Toggle","DS/Utilities/RAFDispatcher","DS/Tweakers/TypeRepresentationFactory","DS/Utilities/Utils","DS/Utilities/Dom","DS/Selection/XSO","DS/UIBehaviors/KeymapManager","DS/UIBehaviors/CommandsRegistry","DS/Tree/commands/TreeListViewCommands","DS/WebRecordEnabler/Adapter","UWA/Utils/Client"],function(e,t,n,i,o,s,l,a,r,d,c,u,h,p,g,m,v,f){"use strict";function w(e){if(e.hasOwnProperty("offsetX"))return{offsetX:e.offsetX,offsetY:e.offsetY};var t=(e.target||e.srcElement).getBoundingClientRect();return{offsetX:e.clientX-t.left,offsetY:e.clientY-t.top}}return n.extend({defaultOptions:{getValue:function(e){return e.nodeModel.options.grid[e.dataIndex]},onCellChange:function(e){return e.event.dsModel?e.event.dsModel.value:e.event.target.value},setValue:function(e){if("tree"===e.dataIndex)e.nodeModel.updateOptions({label:e.value});else{var t={};t[e.dataIndex]=e.value,e.nodeModel.updateOptions({grid:t})}}},init:function(e,t){var n=this;n._parent(e,t),this._typeRepFactory=new d,n._enableDebouncedSyncModel=!1,n._isInEdition=!1,n._listOfEditedCells=[],n._listOfDragOveredCellView=[],n._lastClickTime=0,n._lastClickRow=-1,n._activeElement=void 0;var i=function(e,t){return e._getID()===t._getID()},o=function(e){return e._getID()};this._listOfModifiedNodes=new h({id:"listOfModifiedNodes",publishOnlyPrePostEvents:!0,getElementID:"adaptive"===this.options.performances.renderingMode?o:void 0,useUniqueID:!0,areEquals:i}),this._xsoNodes=new h({getElementID:o,useUniqueID:!0,areEquals:i}),this._pxsoNodes=new h({getElementID:o,useUniqueID:!0,areEquals:i}),n._numberOfVisibleNodesInDocument=0,n._syncCounter=0,n._isExpandingCounter=0,n._needFullUpdate=!1,n._createDocument(t.options.treeDocument),n.registerReusableCellContent({id:"_selection",buildContent:function(){var e=new a({checkFlag:!1});return e.getContent().addEventListener(l.POINTERDOWN,function(e){e.stopPropagation()}),e.getContent().addEventListener("focus",function(e){e.preventDefault(),e.stopPropagation()}),e}}),n.onCellContentChange(function(e){var t=n.getTreeNodeModelFromRowID(e.virtualRowID);"tree"!==e.dataIndex&&n.getColumnOptions(e.virtualColumnID)&&"selection"!==n.getColumnOptions(e.virtualColumnID).type&&(t.options.grid[e.dataIndex]=e.value)}),this._modelEvents.subscribe({event:"active"},function(){n._activeNode=this,n._setActiveStateForNode(this)}),this._modelEvents.subscribe({event:"inactive"},function(){n._activeNode=null,n._unsetActiveStateForNode(this)}),this._managePreSelection(),this._manageKeyboard()},destroy:function(){this._tree=null,this._activeNodeAtShift=null,this._activeNode=null,this._resetListOfUpdatedNodes(),this._listOfModifiedNodes=null,this._keymapManager.destroy(),this._keymapManager=null,this._typeRepFactory.destroy(),this._typeRepFactory=null,this._updateViewOptions=null,this.getDocument()&&this._cleanBindingOnDocument(),this._treeDocument=null,this._xsoNodes=null,this._pxsoNodes=null,this._selectedColumns=null,this._selectedRows=null,this._highlightedRows=null,this._parent()},getNodesXSO:function(){return this.options.selection.viewBased?this._xsoNodes:this.getDocument().getXSO()},getNodesPXSO:function(){return this.options.selection.viewBased?this._pxsoNodes:this.getDocument().getPXSO()},_observeSelMultiSel:function(){var t=this;this._multiSelModeHasBeenForced||(this._modeIsMultiSel=!1,this._modeIsListSel=!1),u.addEventOnElement(this,document,"keydown",function(n){switch(e.Event.whichKey(n)){case"alt+ctrl+shift":case"shift+alt":case"alt+shift":case"ctrl+shift":case"shift+ctrl":case"shift":t._modeIsListSel=!0,t._allowSettingMultiSelMode&&!t._multiSelModeHasBeenForced&&(t._modeIsMultiSel=!0),t._recordInteractionFromUI({event:"selection:mode",data:{activeNodeAtShift:t.getActiveNode()?t.getActiveNode().getStructurePath():void 0,modeIsListSel:!0,modeIsMultiSel:!0}});break;case"ctrl":t._allowSettingMultiSelMode&&!t._multiSelModeHasBeenForced&&(t._modeIsMultiSel=!0),t._recordInteractionFromUI({event:"selection:mode",data:{activeNodeAtShift:t._activeNodeAtShift,modeIsListSel:t._modeIsListSel,modeIsMultiSel:!0}})}}),u.addEventOnElement(this,document,"keyup",function(n){var i=e.Event.whichKey(n);switch(i){case"alt+ctrl+shift":case"shift+alt":case"alt+shift":case"ctrl+shift":case"shift+ctrl":case"shift":t._multiSelModeHasBeenForced||(t._modeIsListSel=!1,t._modeIsMultiSel=!1),t._recordInteractionFromUI({event:"selection:mode",data:{activeNodeAtShift:null,modeIsListSel:!1,modeIsMultiSel:!1}});break;case"ctrl":t._multiSelModeHasBeenForced||(t._modeIsMultiSel=!1),t._recordInteractionFromUI({event:"selection:mode",data:{activeNodeAtShift:t._activeNodeAtShift,modeIsListSel:t._modeIsListSel,modeIsMultiSel:!0}})}"enter"===i&&t._isInEdition&&(t._isInEdition=!1)})},_managePreSelection:function(){var e=this;if(this.options.selection.preSelection){var t;this.elements.poolContainerRel.addEvent("mouseleave",function(){e.getNodesPXSO().empty()});var n=!1;u.addEventOnElement(this,this,"mousemove",function(i,o){var s=e.getDocument();if(o){var l=o.nodeModel;o&&o.virtualRowID>-1&&(t&&(0==l._getRowID()-t.nodeModel._getRowID()&&!0!==n||(s.prepareUpdate(),e.getNodesXSO().isIn(o.nodeModel)?(e.getNodesPXSO().empty(),e.removeRowClass(t.nodeModel._getRowID(),"wux-datagrid-cell-prehighlighted",!0)):(e.getNodesPXSO().unique(o.nodeModel),e.removeRowClass(t.nodeModel._getRowID(),"wux-datagrid-cell-prehighlighted",!0),e.addRowClass(l._getRowID(),"wux-datagrid-cell-prehighlighted",!0)),e._preventNextUpdateView(),s.pushUpdate(),n=!1)),t=o)}}),u.addEventOnElement(this,this.elements.poolContainerRel,"mouseenter",function(){n=!0})}},_goToNode:function(e,t,n){var i,o;if(e&&(1===t&&(i=e.getNextVisibleNode()),0===t&&(i=e),-1===t&&(i=e.getPreviousVisibleNode())),i){if(this._modeIsListSel||(this._activeNodeAtShift=i),i._getRowID()>-1){var s=this.getNodesXSO(),l=this._shouldBeSelected(i);this.prepareUpdateView(),this.isInMultiSelection()||(n&&!l||s.empty(),l&&s.add(i)),this._modeIsListSel&&(0===s.get().length?o=null:(i._getRowID()>this._activeNodeAtShift._getRowID()&&(o="after"),i._getRowID()===this._activeNodeAtShift._getRowID()&&(o=null),i._getRowID()<this._activeNodeAtShift._getRowID()&&(o="before")),"after"===o&&(1===t?l&&s.add(i):s.remove(e)),"before"===o&&(-1===t?l&&s.add(i):s.remove(e)),null===o&&s.remove(e)),this._setActiveAndScrollToNode(i),this._keymapManager.listen(),this.pushUpdateView()}}else this._keymapManager.listen()},_setActiveAndScrollToNode:function(e){var t=e._getRowID();this.setActiveNode(e);var n=this.getScroller(),i=this.getViewportDimensions(),o=this.getScrollerPosition(),s=this.getRowPosition(t),l=this.getRowHeight(t),a=o.y,r=a+i.height-l,d=this.getCellsContainerSize().width>i.width?20:0;s>r&&(n.getContent().scrollTop=s-i.height+l+d+4),s<=a&&(n.getContent().scrollTop=s)},_manageKeyboard:function(){var t=this,n=this._getParent();if(this._commandRegistry=new g,this._keymapManager=new p({jsModel:t,target:n.getContent(),commandsRegistry:this._commandRegistry,shouldProcessEvent:function(t){var n=t.event,i=e.Event.whichKey(n),o=n.target.tagName.toLowerCase();return"input"!==o&&"textarea"!==o||"tab"===i}}),this._keymapManager.spy(function(e){t._recordInteractionFromUI({event:"keymapmanager:dispatch-command",data:e})}),n.options.enableActiveUI&&n.options.enableKeyboardNavigation){var i=n.options.keymaps;for(var o in i)this._keymapManager.registerKeymap(o,i[o]);for(var s in m)this._commandRegistry.registerCommand(s,m[s])}},getCommandRegistry:function(){return this._commandRegistry},getTypeRepresentationFactory:function(){return this._typeRepFactory},getKeymapManager:function(){return this._keymapManager},_resetListOfUpdatedNodes:function(){this._listOfModifiedNodes.empty()},_listenToClickOnEmptyArea:function(){var t=this,n=!1;this.elements.container.addEvent(l.POINTERDOWN,function(t){n=!1;var i=w(t);if(-1!==t.target.className.indexOf("wux-scroller")){var o=e.extendElement(t.target).getDimensions(),s=o.width,l=o.height;i.offsetX<s-18&&i.offsetY<l-18&&(n=!0)}}),this.elements.container.addEvent(l.POINTERUP,function(i){if(n){if(l.isTouchEvent(i)&&t._preventSelectionForTouchScroll)return;var o=w(i);if(-1!==i.target.className.indexOf("wux-scroller")){var s=e.extendElement(i.target).getDimensions(),a=s.width,r=s.height;if(o.offsetX<a-18&&o.offsetY<r-18)t.getNodesXSO().empty()}}n=!1})},_setRowLastClick:function(e,t){this._lastClickTime=t,this._lastClickRow=e},_getRowLastClick:function(e){return this._lastClickRow===e?this._lastClickTime:0},isEveryVisibleNodeSelected:function(){if(this.getNodesXSO().isEmpty())return!1;var e=0;return this.getNodesXSO().get().forEach(function(t){null!==t._getRowID()&&e++}),this._numberOfVisibleNodesInDocument===e},getDocument:function(){return this._treeDocument},_doesCellNeedToDisplayed:function(e){return!e.cellModel.isMerged()},addRow:function(e,t){return"number"==typeof t||void 0===t?this._parent(e,t):t instanceof i?(console.warn("[DEPRECATED]","DS/Tree/Manager","You must not use anymore the addRow() method but use the TreeDocument or TreeNodeModel API instead"),e instanceof Array?t.addChild(e):e instanceof i?t.addChild(e):t.addChild([e])):-1},removeRow:function(e){e instanceof i?(console.warn("[DEPRECATED]","DS/Tree/Manager","You must not use anymore the removeRow() method but use the TreeDocument or TreeNodeModel API instead"),e.remove()):"number"!=typeof e&&void 0!==e||this._parent(e)},moveColumn:function(e,t,n){"string"==typeof e&&(e=this.getColumnIDFromDataIndex(e)),"string"==typeof t&&(t=this.getColumnIDFromDataIndex(t)),this.prepareUpdateView(),o.array2dMove(this.options.columns,e,t),this.options.model=o.array2dTranspose(this.options.model),o.array2dMove(this.options.model,e,t),this.options.model=o.array2dTranspose(this.options.model),o.array2dMove(this._listOfColumnsWidth,e,t),o.array2dMove(this._columnsList,e,t),this._needToComputeColumnReverseDataIndexes(),this._freeUpPool(2),this._reflectView(),this.pushUpdateView(!0),this._modelEvents.publish({event:"/MANAGER/COLUMNS/MOVE",data:{fromColumnID:e,toColumnID:t}})},removeColumn:function(e){"string"==typeof e&&(e=this.getColumnIDFromDataIndex(e)),this.prepareUpdateView(),this.options.columns.splice(e,1),this._needToComputeColumnReverseDataIndexes(),this._freeUpPool(2),this._reflectView(),this._modelEvents.publish({event:"/MANAGER/DIMENSIONS/UPDATE"}),this._modelEvents.publish({event:"/MANAGER/COLUMNS/REMOVE",data:{columnID:e}}),this.pushUpdateView()},_getTrueRoot:function(){return this._treeDocument._getTrueRoot()},getNthRoot:function(e){return this._getTrueRoot().getChildren()?this._getTrueRoot().getChildren()[e]:null},getRoots:function(){return this._getTrueRoot().getChildren()||[]},_prepareSync:function(){this._syncCounter++},_pushSync:function(){this._syncCounter--,this._syncRowIndexes(!0)},_applyCellsContainerSizeIfNeeded:function(){!0===this._needToApplyCellContainerSize&&this._computeModelSize(),this._parent()},_nodeModelToRowModel:function(e){var t=this,n={},i=e._getNodeInfos();return t.getColumns().forEach(function(e){var o=t._getColumnOptionValue(e.dataIndex,"getValue");i.dataIndex=e.dataIndex,o&&(n[e.dataIndex]=o.call(t,i))}),n},_syncRowIndexes:function(){this.syncModel()},addRoot:function(e){var t=this.getDocument()._getTrueRoot().addChild(e);return this._syncRowIndexes(),t._tree=this._tree,t},removeRoot:function(e){this.prepareUpdateView();var t=this.getDocument()._getTrueRoot().removeChild(e);return this.pushUpdateView(),t},_bindJSEventOnDocument:function(e,t,n){var i=this.addEventListener(t,n);this._jsEventListeners.push({caller:e,eventType:t,callback:i})},_bindEventOnXSO:function(e,t){this._XSOEventListeners.push(this.getNodesXSO()[e](t))},_bindEventOnDocument:function(e,t){this._listeners.push(this.getDocument().subscribe({event:e},t))},_cleanBindingOnDocument:function(){var e=this;this._listeners.forEach(function(t){e.getDocument().unsubscribe(t)}),this._jsEventListeners.forEach(function(e){e.caller.removeEventListener(e.eventType,e.callback)});var t=this.getNodesXSO();t&&this._XSOEventListeners.forEach(function(e){t.unsubscribe(e)}),this._listeners=[],this._jsEventListeners=[],this._XSOEventListeners=[]},search:function(e){return this.getDocument().search(e)},_createDocument:function(e){var t=this;this._treeDocument=e||new s({useAsyncPreExpand:this._instance.options.useAsyncPreExpand}),this._treeDocument._observeEvents(),this._XSOEventListeners=[],this._jsEventListeners=[],this._listeners=[],this._resetListOfUpdatedNodes();var n=0;function i(){if(f.Engine.ie){if(t._activeElement===t._instance.elements.container)return!0;if(t._activeElement)for(var e=t._activeElement.parentNode;e;){if(t._activeElement.parentNode===t._instance.elements.container)return!0;e=e.parentNode}return!1}return!1}this._bindEventOnDocument("preDestroyDocument",function(){t.unloadDocument()}),this._bindEventOnDocument("nodeModelUpdate",function(e){t._unpreventNextUpdateView(),t._syncRowModelWithTreeNodeModel(e.target),t._needFullUpdate||t._listOfModifiedNodes.add(e.target)}),this._bindEventOnDocument("prepareUpdate",function(){t.prepareUpdateView(),n++}),this._bindEventOnDocument("pushUpdate",function(){t.pushUpdateView(),--n<0&&console.error("You pushed too many updates")}),this._bindEventOnDocument("hide",function(){t._requireFullUpdate(),t._reflectView()}),this._bindEventOnDocument("show",function(){t._requireFullUpdate(),t._reflectView()}),this._bindEventOnDocument("filter",function(){t._reflectView()}),this._bindEventOnDocument("removeChild",function(){t._requireFullUpdate(),t._reflectView()}),this._bindEventOnDocument("addChild",function(){t._requireFullUpdate(),t._reflectView()}),this._bindEventOnDocument("empty",function(){t._requireFullUpdate(),t._reflectView()}),this._bindEventOnDocument("expandStateChange",function(e){t.updateCellView(e.target._getRowID(),"tree"),"partiallyExpanded"===e.data.state&&t._reflectView()}),this._bindEventOnDocument("sortChildren",function(){t._reflectView()}),["expandStateChange","matchSearch","unmatchSearch"].forEach(function(e){t._bindEventOnDocument(e,function(e){t._needFullUpdate||t._listOfModifiedNodes.add(e.target)})}),["matchSearch","unmatchSearch"].forEach(function(e){t._bindEventOnDocument(e,function(){t._requireFullUpdate(),t._reflectView()})}),this._bindEventOnDocument("documentPreExpandAll",function(){t.prepareUpdateView()}),this._bindEventOnDocument("documentPostExpandAll",c.debounce(function(){t._reflectView(),t.pushUpdateView()},10)),this._bindEventOnDocument("documentPreCollapseAll",function(){t.prepareUpdateView()}),this._bindEventOnDocument("documentPostCollapseAll",function(){t._reflectView(),t.pushUpdateView()}),this._bindEventOnDocument("preExpandAll",function(e){e.target.setState({state:"expanding"}),t.updateCellView(e.data.virtualRowID,"tree"),t.prepareUpdateView(),t._activeElement=document.activeElement}),this._bindEventOnDocument("postExpandAll",function(){t._reflectView(),t.pushUpdateView(),i()&&t._giveFocus(!0),t._activeElement=void 0}),this._bindEventOnDocument("preCollapseAll",function(e){t.updateCellView(e.data.virtualRowID,"tree"),t.prepareUpdateView(),t._activeElement=document.activeElement}),this._bindEventOnDocument("postCollapseAll",function(){t._reflectView(),t.pushUpdateView(),i()&&t._giveFocus(!0),t._activeElement=void 0}),this._bindEventOnDocument("preExpandPrivate",function(){t.prepareUpdateView(),t._activeElement=document.activeElement}),this._bindEventOnDocument("postExpand",function(){t._reflectView(),t.pushUpdateView(),i()&&t._giveFocus(!0),t._activeElement=void 0}),this._bindEventOnDocument("preCollapse",function(){t.prepareUpdateView(),t._activeElement=document.activeElement}),this._bindEventOnDocument("postCollapse",function(){t._updateViewOptions.generatePool=!0,t._reflectView(),t.pushUpdateView(),i()&&t._giveFocus(!0),t._activeElement=void 0}),this._bindEventOnDocument("highlight",function(e){var n=e.data.nodeModel._getRowID();t.selectRow(n,!1)}),this._bindEventOnDocument("unhighlight",function(e){var n=e.data.nodeModel._getRowID();t.unselectRow(n)});var o=function(){t._toCellWillBeEdited&&(clearTimeout(t._toCellWillBeEdited),t._toCellWillBeEdited=null)};this.addEventListener("dblclick",function(e,t){o()});var l=this.getNodesXSO();function a(){if(1===t._isPreparingView){var e=t.getColumnIDFromDataIndex("selection"),n=t.getCell(-1,e);if(n){var i=n.getView();i&&t._onRequestColumnHeaderCB.call(t,i.getCellInfos())}}}this._bindEventOnXSO("onChange",function(){o()}),!1!==this._getParent().options.enableActiveUI||this.__isComboBox__||delete l.options.getElementID,this._bindEventOnXSO("onPreEmpty",function(){t.prepareUpdateView()}),this._bindEventOnXSO("onEmpty",function(){var e=t.getColumnIDFromDataIndex("selection");t.updateCellView(-1,e),t.pushUpdateView()}),this._bindEventOnXSO("onPostAdd",a),this._bindEventOnXSO("onPostRemove",a),!1!==this._getParent().options.enableActiveUI||this.__isComboBox__?(this._bindEventOnXSO("onAdd",function(e){!1===t.options.selection.viewBased&&e.select()}),this._bindEventOnXSO("onPostAdd",function(e){if(0!==e.length){t.prepareUpdateView();var n=[];e.forEach(function(e){n.push(e._getRowID(!1)),/*!manager._needFullUpdate &&*/e.isSelectionChangeFromUI()&&t._preventNextUpdateView()}),t.selectRows(n,!1),t.options.selection.preselection&&t.getNodesPXSO().remove(e);var i=e[e.length-1];t._setRowLastClick(i._getRowID(!1),Date.now()),t.setActiveNode(i),t._needFullUpdate||t._listOfModifiedNodes.add(e),t.pushUpdateView()}}),this._bindEventOnXSO("onPostRemove",function(e){if(0!==e.length){t.prepareUpdateView(),e.forEach(function(e){var n=e._getRowID();e.isSelectionChangeFromUI()&&t._preventNextUpdateView(),null!==n&&n>=0&&t.unselectRow(n,!1),!1===t.options.selection.viewBased&&e.unselect()});var n=e[e.length-1];t._setRowLastClick(-1,0),t.setActiveNode(n),t._needFullUpdate||t._listOfModifiedNodes.add(e),t.pushUpdateView()}})):(this._bindEventOnXSO("onAdd",function(e){var n=e._getRowID(!1);t.prepareUpdateView(),t.unselectAllColumns(),null!==n&&n>=0&&t.selectRow(n,!1),t.setActiveNode(e),(e.isSelectionChangeFromUI()||!t._needFullUpdate&&t._isPreparingView<=2)&&t._preventNextUpdateView(),t.pushUpdateView()}),this._bindEventOnXSO("onRemove",function(e){var n=e._getRowID();t.prepareUpdateView(),t._setRowLastClick(n,0),e.unselect(),t.unselectRow(n,!1),t.setActiveNode(e),(e.isSelectionChangeFromUI()||!t._needFullUpdate&&t._isPreparingView<=2)&&t._preventNextUpdateView(),t.pushUpdateView()}));var r=this.getNodesPXSO();r.onAdd(function(e){var n=e._getRowID(!1);t._setRowLastClick(n,Date.now()),t.addRowClass(n,"wux-datagrid-cell-prehighlighted")}),r.onRemove(function(e){var n=e._getRowID(!1);t._setRowLastClick(n,Date.now()),t.removeRowClass(n,"wux-datagrid-cell-prehighlighted")})},pushUpdateView:function(e){this._isPreparingView-1==0&&!0===this.__mustSyncModel&&(this.__mustSyncModel=!1,this.syncModel(!1),this._updateViewOptions.generatePool=!0),this._parent(e)},updateView:function(e){if(this.getContent().offsetParent){this.options.performances.minimumScrollDistance=.5*this.options.defaultCellHeight;var t=this;if(t._toCellWillBeEdited&&(clearTimeout(t._toCellWillBeEdited),t._toCellWillBeEdited=null),!this._needFullUpdate){var n=this._listOfModifiedNodes.get();if(n.length>0){t.isPerformanceAnalysis()&&console.time("["+t._name+"]:smart update"),!0===e&&(this._setColumnsWidth(),this._updateViewOptions.generatePool=e),t.getViewportDimensions(!0);var i,o=t._computeVirtualViewport();return this._beginUpdate(),n.forEach(function(e){var n=e._getRowID();null!=n&&n<=o.maxRowID&&n>=o.minRowID?t.updateRowView(n):t.isPerformanceAnalysis()&&console.log("["+t._name+"]:ignore this node outside viewport or hidden",e.getLabel(),o)}),this._resetListOfUpdatedNodes(),this._endUpdate(),t.isPerformanceAnalysis()&&console.timeEnd("["+t._name+"]:smart update"),t._needFullUpdate=!1,this._updateSelectAllCheckBox(),(i=this.getActiveNode())?t._setActiveStateForNode(i):t._unsetActiveStateForNode(i),void this._notifyUpdateViewCompleted()}}(this._enableDebouncedSyncModel&&!this._debounceReflectView||!1===this._enableDebouncedSyncModel)&&(this._parent(e),t._needFullUpdate=!1),(i=this.getActiveNode())?t._setActiveStateForNode(i):t._unsetActiveStateForNode(i),this._resetListOfUpdatedNodes(),this._updateSelectAllCheckBox()}},needToRequestContentAt:function(e){return this._listOfModifiedNodes.get().some(function(t){return t._getRowID()===e.virtualRowID})},updateCellView:function(e,t){e instanceof i?this._parent(e._getRowID(),t):this._parent(e,t)},_syncRowModelWithTreeNodeModel:function(e){var t=this._nodeModelToRowModel(e);for(var n in t)this.setCellContent(e._getRowID(),n,t[n])},updateRowViewWithException:function(e,t){null!=e&&(e instanceof i?(this._syncRowModelWithTreeNodeModel(e),this._parent(e._getRowID(),t)):(this._syncRowModelWithTreeNodeModel(this.getTreeNodeModelFromRowID(e)),this._parent(e,t)),this._requireFullUpdate())},updateRowView:function(e){if(e instanceof i)this._syncRowModelWithTreeNodeModel(e),this._parent(e._getRowID(!0));else if(e>-1){var t=this.getTreeNodeModelFromRowID(e);t&&this._syncRowModelWithTreeNodeModel(t),this._parent(e)}this._requireFullUpdate()},syncModel:function(e,t){var n=this;n.onPostUpdateViewOnce(function(){n._heavyDataColumnModelRequest("syncModel")}),this._requireFullUpdate(),void 0===t&&(t=!0),void 0===e&&(e=!0);var i=this,o=0,s=!1,l=!1;i._computeVirtualViewport();var a=i.getVirtualViewport(),r=function(){i._setColumnsWidth(),i.onPreUpdateViewOnce(function(){i._computeVirtualViewport()}),i._debounceReflectView=null,i.pushUpdateView(),l=!0};i.prepareUpdateView(),i.empty(),i._freeUpPool(2),i._numberOfVisibleNodesInDocument=0,s=!0;var d=0;i.getDocument()._getTrueRoot().processDescendants({onlyVisibleNodes:!1,processNode:function(e){if(e.nodeModel.isVisible()&&!e.nodeModel.hasNoRepresentation()){var n=i._nodeModelToRowModel(e.nodeModel);e.nodeModel._rowID=o,i.addRow(n);var s=i.getRowHeight(o);s!==i.options.defaultCellHeight&&i.setRowHeight(o,s,!1),i._listOfRowsPosition[o]=0===o?0:d,d+=s,(e.nodeModel.isSelected()||e.nodeModel.isHighlighted())&&i.selectRow(o,!1),t&&a.maxRowID===o&&r(),i._numberOfVisibleNodesInDocument++,o++}else e.nodeModel._rowID=null}}),(!t||!1===l&&!0===s)&&r()},_reflectView:function(){this.__mustSyncModel=!0},selectAll:function(){var e=this,t=e.getDocument(),n=[];t.withTransactionUpdate(function(){t._getTrueRoot().processDescendants({processNode:function(e){t.options.shouldBeSelected.call(t,e.nodeModel)&&n.push(e.nodeModel)}}),e.getNodesXSO().add(n)})},selectAllVisibleNodes:function(){if(!0===this.options.selection.canMultiSelect){var e=this,t=e.getDocument(),n=[];t.withTransactionUpdate(function(){t._getTrueRoot().processDescendants({onlyVisibleNodes:!0,processNode:function(e){t.options.shouldBeSelected.call(t,e.nodeModel)&&n.push(e.nodeModel)}}),e.getNodesXSO().add(n)})}},unselectAll:function(){this.withUpdate(function(){this.getNodesPXSO().empty(),this.getNodesXSO().empty()})},_selectRowProcessCB:function(e,t,n,i){this._parent(e,t,n,i),this.getColumnOptions(n)&&"selection"===this.getColumnOptions(n).type&&this.updateCellView(t,n)},_unselectRowProcessCB:function(e,t,n){this._parent(e,t,n),this.getColumnOptions(n)&&"selection"===this.getColumnOptions(n).type&&this.updateCellView(t,n)},_restoreSelection:function(){var e=this;e.prepareUpdateView(),this.getNodesXSO().get().forEach(function(t){var n=t._getRowID();null!==n&&e.selectRow(n,!1)}),e.pushUpdateView()},loadDocument:function(e){this._freeUpPool(2),this._isPreparingView=0,this._updateCounter=0,this.prepareUpdateView(),this._treeDocument&&(this.unloadDocument(),this._cleanBindingOnDocument()),this._createDocument(e),this._syncRowIndexes(!0),this._setColumnsWidth(),this._restoreSelection(),this.pushUpdateView(!0)},unloadDocument:function(){this.prepareUpdateView(),this.empty(),!0===this.options.selection.viewBased&&(this.getNodesPXSO().empty(),this.getNodesXSO().empty()),this._cleanBindingOnDocument(),this._createDocument(),this.pushUpdateView(!0)},scrollToNode:function(e,t,n){void 0===n&&(n=!0);var i=e._getRowID();this.scrollToRow(i,t),!0===n&&this.updateView()},isNodeInVisibleViewport:function(e){return 0===this.nodePositionInVisibleViewport(e)},nodePositionInVisibleViewport:function(e){if(!this._scrollerDimensions)return 0;var t=this.getRowPosition(e._getRowID()),n=this.getScrollerPosition().y;return n>t?-1:t+this.getRowHeight(e._getRowID())>n+this._getScrollerDimensions().height?1:0},expandAll:function(){this.prepareUpdateView();var e=this.unloadDocument(),t=e.getAllDescendants();o.optimizedForEach(t,function(e){e.hasChildren()&&e.expand()}),this.loadDocument(e),this.pushUpdateView()},collapseAll:function(){this.prepareUpdateView();var e=this.unloadDocument(),t=e.getAllDescendants();o.optimizedForEach(t,function(e){e.hasChildren()&&e.collapse()}),this.loadDocument(e),this.pushUpdateView()},getTreeNodeModelFromRowID:function(e){return this.getCellContent(e,"tree")},onNodeDblClick:function(e){return this._modelEvents.subscribe({event:"dblClick"},e)},onNodeClick:function(e){return this.onCellClick(e)},sortColumnContent:function(t,n){this.prepareUpdateView(),"string"!=typeof t&&(t=this.getDataIndexFromColumnID(t));var i=this.getColumnIDFromDataIndex(t),o=this.getColumnOptions(i);n=e.extend({sortOrder:"asc",sortFunction:o.sortFunction||function(e,n){return"tree"===t?e.options.label<n.options.label?-1:1:e.options.grid[t]===n.options.grid[t]?0:null===e.options.grid[t]?-1:null===n.options.grid[t]?1:void 0===e.options.grid[t]?-1:void 0===n.options.grid[t]?1:e.options.grid[t]<n.options.grid[t]?-1:1}},n),this._setColumnState(i,"sort:"+n.sortOrder);for(var s=0;s<this.getRow(-1).length;s++)if(s!==i){var l=this.getRow(-1)[s];l._view&&(l._view.getContent().removeClassName("wux-ui-sort-desc"),l._view.getContent().removeClassName("wux-ui-sort-asc")),l.removeClass("wux-ui-sort-desc"),l.removeClass("wux-ui-sort-asc")}this.getCell(-1,i).removeClass("wux-ui-sort-desc"),this.getCell(-1,i).removeClass("wux-ui-sort-asc"),this.getCell(-1,i).addClass("wux-ui-sort-"+n.sortOrder),this.getDocument()._getTrueRoot().sortChildren({isRecursive:!0,sortFunction:function(e,t){return("asc"===n.sortOrder?1:-1)*n.sortFunction(e,t)}}),this._reflectView(),this.pushUpdateView(!0),this._modelEvents.publish({event:"sort",data:{columnID:i,columnDataIndex:t,sortOrder:n.sortOrder}})},restoreColumnsPreferences:function(e){this._parent(e),this._syncRowIndexes(!0)},_onCellChange:function(e){if(!this._isRequestingCell){var t=u.firstParentWithClass(e.target,"wux-datagrid-cell");if(t){var n=this._getCellViewFromDom(t),i=n.getCellInfos();if(!i.isHeader){var o=this._getColumnOptionValue(i.dataIndex,"setValue"),s=this._getColumnOptionValue(i.dataIndex,"onCellChange"),l=i;l.event=e;var a=s.call(this,l);l.value=a,o.call(this,l),this._recordInteractionFromUI({event:"node:change",data:{nodeRecordPath:i.nodeModel?i.nodeModel.getStructurePath():i.nodeModel,dataIndex:i.dataIndex,virtualRowID:i.virtualRowID,virtualColumnID:i.virtualColumnID,value:a}}),this._giveFocus(),this._preventNextRowUpdateView=!1}}else this._giveFocus()}},_setupColumnType:function(e){var t=this;switch(e.type){case"selection":e.isSortable=!1,e.setValue=function(e){if(e.nodeModel.selectionChangeIsFromUI(),e.value||t._modeIsListSel)if(t.options.selection.canMultiSelect)if(t._modeIsListSel){var n,i=t.getDocument(),o=i.getXSO().get();n=0===o.length?i.getChildren()[0]:!0===t._getParent().options.enableActiveUI?t.getActiveNode():o[0];var s=e.nodeModel;i.withTransactionUpdate(function(){var i=n._getRowID(),o=s._getRowID(),l=i<o?1:-1,a=!0;i===o&&(a=t.getNodesXSO().isIn(n));var r=[];t._shouldBeSelected(n)&&r.push(n);for(var d=i+l;l>0&&d<=o||l<0&&d>=o;d+=l){var c=t.getTreeNodeModelFromRowID(d);t._shouldBeSelected(c)&&r.push(c),a&&!t.getNodesXSO().isIn(c)&&(a=!1)}a?e.cellView.__unselectNodes(r):e.cellView.__selectNodes(r)})}else t.getNodesXSO().add(e.nodeModel);else t.getNodesXSO().unique(e.nodeModel);else t.getNodesXSO().remove(e.nodeModel)},e.getValue=function(e){return t.getNodesXSO().isIn(e.nodeModel)},e.onCellChange=function(e){return t._giveFocus(!0),e.event.target.dsModel.checkFlag},e.onCellRequest=function(e){if(e.isHeader)t.options.selection.canMultiSelect&&(t._selectAllToggleTimer&&clearTimeout(t._selectAllToggleTimer),t._updateSelectAllCheckBox());else{var n=e.cellView.reuseCellContent("_selection");if(n){e.manager.getDocument();var i=e.manager._shouldBeSelected(e.nodeModel);n.disabled=!e.isHeader&&!i,n.checkFlag=e.manager.getNodesXSO().isIn(e.nodeModel)}}};break;case"tree":case"picture":case"boolean":case"color":break;default:void 0!==e.typeRepresentation&&(void 0===e.setValue&&(e.setValue=function(e){var t={};t[e.dataIndex]=e.value,e.nodeModel._isUsingDataModel()?(e.manager.prepareUpdateView(),e.nodeModel._getDataModel().update({grid:t}),e.manager.pushUpdateView()):(e.nodeModel.updateOptions({grid:t}),e.manager.updateRowViewWithException(e.nodeModel,e.dataIndex))}),e.onCellRequest=function(n){if(!n.isHeader){var i=n.manager._getColumnOptionValue(n.dataIndex,"getValue").call(n.manager,n),o=!t._isCellEditable(n);n.cellView._disposeReusableContent(),this._typeRepFactory.generateView(i,{typePath:e.typeRepresentation,readOnly:o,context:"inlinedTemplate",onViewCreated:function(t){n.cellView._setReusableContent(t,"_typeRep-"+e.typeRepresentation),t.readOnly||n.cellView.getContent().setAttribute("draggable",!1)}})}})}},_getViewOptions:function(){return this._instance._parentObject.options},_shouldBeSelected:function(e){var t=this.getDocument();return!0===this._getViewOptions().selection.viewBased?this._getViewOptions().nodeShouldBeSelected.call(t,e):t.options.shouldBeSelected.call(t,e)},_updateSelectAllCheckBox:function(){var e=this,t=this._getCellViewDom(-1,"selection");if(t){var n=t.dsView.getCellInfos();if(void 0===this._selectAllCheckBox&&(this._preventSelectAllCheckBoxListenChange=!1,this._selectAllCheckBox=new a({}),this._selectAllCheckBox.getContent().addEventListener(l.POINTERDOWN,function(e){e.stopPropagation()}),this._selectAllCheckBox.getContent().addEventListener("focus",function(e){e.preventDefault(),e.stopPropagation()}),this._selectAllCheckBox.getContent().addEventListener("change",function(t){e._preventSelectAllCheckBoxUpdate||(e._preventSelectAllCheckBoxUpdate=!0,t.dsModel.checkFlag?e.selectAllVisibleNodes():e.unselectAll(),e._selectAllCheckBox.mixedState=!1,e._giveFocus(),e._preventSelectAllCheckBoxUpdate=!1)})),!this._preventSelectAllCheckBoxUpdate){this._preventSelectAllCheckBoxUpdate=!0;var i=this.getNodesXSO().isEmpty();this._selectAllCheckBox.checkFlag=!i,this._selectAllCheckBox.mixedState=!i&&!e.isEveryVisibleNodeSelected(),this._preventSelectAllCheckBoxUpdate=!1}n.cellView.getContent().setHTML(this._selectAllCheckBox)}},_isCellEditable:function(e){var t=this._getParent(),n=e.manager.getColumnOptions(e.virtualColumnID),i=e.manager.getDocument().options.shouldBeEditable.call(e.nodeModel,e.nodeModel),o=void 0===t.options.shouldBeEditable||"function"==typeof t.options.shouldBeEditable&&t.options.shouldBeEditable.call(e.nodeModel,e);void 0===o&&(o=!0);var s=void 0===n.isEditable||!0===n.isEditable,l=i&&o&&s;return l},setActiveNode:function(e){this._instance.options.enableActiveUI&&(e?this._activeNode!==e&&(this._activeNode=e,this._modelEvents.publish({event:"active",context:e,data:e._getNodeInfos()})):this.unsetActiveNode())},getActiveNode:function(){return this._activeNode},unsetActiveNode:function(e){this.getActiveNode()&&this._modelEvents.publish({event:"inactive",context:e})},_enableActiveStateForNode:function(t){var n=t._getRowID(),i=this;this.disableDragOverStateForRow(),this.disableDragOverStateForBlank(),void 0===i._activeMarkBG?(i._activeMarkBG=new e.Element("div",{class:"wux-tree-active-element-bg wux-tree-treelistview-insertion-mark",styles:{position:"absolute",top:i.getRowPosition(n),left:0,height:i.getRowHeight(n),right:0}}).inject(i.elements.poolContainerRelDettachable),i._activeMarkFG=new e.Element("div",{class:"wux-tree-active-element-fg wux-tree-treelistview-insertion-mark-border",styles:{position:"absolute",top:i.getRowPosition(n),left:0,height:i.getRowHeight(n),right:0}}).inject(i.elements.poolContainerRelDettachable)):(this._activeMarkFG.style.display="block",i._activeMarkBG.style.display="block")},_computeStyleForActiveState:function(e){var t=e._getRowID();return{top:this.getRowPosition(t),left:0,height:this.getRowHeight(t),right:0}},_setActiveStateForNode:function(e){this._enableActiveStateForNode(e);var t=this._computeStyleForActiveState(e);this._activeMarkBG.setAttribute("wux-ui-drop-position","middle"),this._activeMarkBG.setStyles({height:t.height-2,top:t.top+1,left:t.left+1,right:t.right+2,width:t.width,border:"1px solid white",background:"transparent",display:""}),this._activeMarkFG.setAttribute("wux-ui-drop-position","middle"),this._activeMarkFG.setStyles({height:t.height,top:t.top,left:t.left,right:t.right+1,width:t.width,display:""})},_unsetActiveStateForNode:function(e){this._activeMarkBG&&(this._activeMarkBG.removeAttribute("wux-ui-drop-position"),this._activeMarkFG.removeAttribute("wux-ui-drop-position"),this._activeMarkBG.style.display="none",this._activeMarkFG.style.display="none")},enableDragOverStateForRow:function(t){var n=this;this.disableDragOverStateForRow(),this.disableDragOverStateForBlank(),void 0===n._insertNodeMarkBG?(n._insertNodeMarkBG=new e.Element("div",{class:"wux-tree-treelistview-insertion-mark",styles:{position:"absolute",top:n.getRowPosition(t),left:0,height:n.getRowHeight(t),right:0}}).inject(n.elements.poolContainerRelDettachable),n._insertNodeMarkFG=new e.Element("div",{class:"wux-tree-treelistview-insertion-mark-border",styles:{position:"absolute",top:n.getRowPosition(t),left:0,height:n.getRowHeight(t),right:0}}).inject(n.elements.poolContainerRelDettachable)):(this._insertNodeMarkBG.show(),n._insertNodeMarkFG.show())},setDragOverStateForNode:function(e,t){var n=e._getRowID(),i=this;if(i._currentDropPosition!==t){var o,s,l;switch(i.enableDragOverStateForRow(n,t),i._currentDropPosition=t,t){case"top":o=i.getRowPosition(n),s=2,l=i.isColumnHidden("tree")?0:i.getColumnPosition("tree")+i._getCellView2(n,"tree")._nodeOffsetX;break;default:case"middle":o=i.getRowPosition(n),s=i.getRowHeight(n),l=0;break;case"bottom":o=i.getRowPosition(n)+i.getRowHeight(n),s=2,l=i.isColumnHidden("tree")?0:i.getColumnPosition("tree")+i._getCellView2(n,"tree")._nodeOffsetX}this._insertNodeMarkBG&&(this._insertNodeMarkBG.setAttribute("wux-ui-drop-position",t),this._insertNodeMarkBG.setStyles({height:s,top:o,left:l,right:0})),this._insertNodeMarkFG&&(this._insertNodeMarkFG.setAttribute("wux-ui-drop-position",t),this._insertNodeMarkFG.setStyles({height:s,top:o,left:l,right:0}))}},disableDragOverStateForRow:function(){this._currentDropPosition=null,this._insertNodeMarkBG&&this._insertNodeMarkBG.hide(),this._insertNodeMarkFG&&this._insertNodeMarkFG.hide()},_removeAllInteractiveUIFeedBacks:function(){this._lastDragOveredRowID=null,this.disableDragOverStateForRow(),this.disableDragOverStateForBlank()},_recordInteractionFromUI:function(e){v.addCustomInteraction(this._instance._parentObject.getContent(),{type:"webUX_event",reason:e.reason||"",event:e.event||"",data:e.data||{},eventOptions:{}},"DS/TreeRec/TreeListViewRec",{checkAbstract:!1,checkVisibility:!1})}})}),define("DS/Tree/TreeListView",["UWA/Core","DS/Spreadsheet/DataGrid","DS/Core/PointerEvents","DS/Tree/TreeNodeView","DS/TreeModel/TreeNodeModel","DS/Tree/Manager","DS/Utilities/Dom","DS/Utilities/Utils","DS/WebRecordEnabler/Adapter"],function(e,t,n,i,o,s,l,a,r){"use strict";var d=document.createElement("DIV");var c=t.extend({defaultOptions:{apiVersion:2,roots:[],columns:[],cellClass:i,managerClass:s,defaultCellMouseHeight:28,defaultCellTouchHeight:38,defaultCellHeight:28,defaultYDistanceOfTopBadgesFromIconCenter:8,defaultYDistanceOfBottomBadgesFromIconCenter:10,numberOfColumns:1,headersDimensions:{width:void 0,height:void 0},expanderStyle:"classic",changeColorOnFocus:!0,show:{rowHeaders:!1,columnHeaders:!0},selection:{viewBased:!1,nodes:!0,cells:!1,rowHeaders:!0,columnHeaders:!0,unselectAllOnEmptyArea:!0,toggle:!0,canMultiSelect:!0,enableListSelection:!1},enableDragAndDrop:!0,enableActiveUI:!1,enableKeyboardNavigation:!1,keymaps:{"/":"treelistview:collapse-all-node","*":"treelistview:expand-all-node","+":"treelistview:expand-node","-":"treelistview:collapse-node","ctrl+space":"treelistview:toggle-selection","ctrl+right":"treelistview:go-to-next-node","shift+right":"treelistview:go-to-next-node",right:"treelistview:go-to-next-node","ctrl+left":"treelistview:go-to-previous-parent-node","shift+left":"treelistview:go-to-previous-parent-node",left:"treelistview:go-to-previous-parent-node","ctrl+up":"treelistview:go-to-previous-visible-node","shift+up":"treelistview:go-to-previous-visible-node",up:"treelistview:go-to-previous-visible-node","ctrl+down":"treelistview:go-to-next-visible-node","shift+down":"treelistview:go-to-next-visible-node",down:"treelistview:go-to-next-visible-node",esc:"treelistview:edit-cancel"},enableTreeColumnEllipsisOverflow:!1,shouldDisplayTooltip:function(e){let t=e.manager.options.shouldCellAllowUnsafeHTMLContentAt?e.manager.options.shouldCellAllowUnsafeHTMLContentAt(e):void 0;return"tree"!==e.dataIndex||e.isHeader?e.cellModel.options.value?"string"==typeof e.cellModel.options.value?{shortHelp:e.cellModel.options.value,allowUnsafeHTMLShortHelp:t||!1}:e.cellModel.options.value.toString?{shortHelp:e.cellModel.options.value.toString(),allowUnsafeHTMLShortHelp:t||!1}:{shortHelp:""}:{shortHelp:""}:{shortHelp:(n=e.nodeModel.options.label,i=t||!0,a.getUnsafeHTMLContentValueToApply(i)?d.innerHTML=n:d.innerText=n,d.textContent||d.innerText||"")};var n,i},performances:{buildLinks:!0,numberOfRowsFactor:1.4,numberOfColumnsFactor:1,fullUpdateFactor:.95,enableColumnVirtualization:!1,debounceCellInternalUpdateTimer:0,debounceCellRequest:!1},useAsyncPreExpand:!1,showScrollbarsOnHover:!1,enableScrollOnDrag:!1,enableExpandOnDoubleClick:!1,onDragStartCell:function(e,t){var n=[];t.manager.getNodesXSO().get().concat().sort(function(e,t){return e._getRowID()>t._getRowID()?1:-1}).forEach(function(e){n.push(e.dump())}),this.serializeDragAndDropEvent(e,{data:{"dswebux/x-tree.treenodemodel+json":n,"dswebux/x-tree.treenodemodel+number":t.nodeModel._getID()}}),e.dataTransfer.effectAllowed="move"},onDragEnterRowHeaderDefault:function(e,t){t.manager.disableDragOverStateForBlank(),t.manager.disableDragOverStateForRow()},onDragLeaveRowHeaderDefault:function(e,t){t.manager.disableDragOverStateForBlank(),t.manager.disableDragOverStateForRow()},onDragStartColumnHeader:function(e,t){return t.manager.__draggedColumnID=t.virtualColumnID,!0},onDragEnterColumnHeaderDefault:function(e,t){if(t.manager.disableDragOverStateForBlank(),t.manager.disableDragOverStateForRow(),"column"===t.manager.__draggedArea){var n=t.manager.getScroller().getPosition().x+t.manager.getHeadersDimensions().width+t.manager.getColumnPosition(t.dataIndex);t.manager.__draggedColumnID<t.virtualColumnID&&(n+=t.manager.getColumnWidth(t.dataIndex)),this._showColumnInsertionMark(n)}},onDragLeaveColumnHeaderDefault:function(e,t){t.manager.disableDragOverStateForBlank(),t.manager.disableDragOverStateForRow(),this._hideColumnInsertionMark()},onDragEnterCellDefault:function(e,t){t.manager.enableDragOverStateForRow(t.virtualRowID,t.dropPosition)},onDragOverCellDefault:function(e,t){t.manager.setDragOverStateForNode(t.nodeModel,t.dropPosition)},onDragLeaveCellDefault:function(e,t){t.manager.disableDragOverStateForBlank(),t.manager.disableDragOverStateForRow()},onDropCellDefault:function(e,t){t.parent;var n=this.unserializeDragAndDropEvent(e);if(n){var i=n.source.uuid;this._uxid===i?this._dndMode="move":this._dndMode="copy",t.mode=this._dndMode,t.manager._recordInteractionFromUI({event:"drop:node",data:{unserializedData:n,dropPosition:t.dropPosition,mode:this._dndMode,nodeRecordPath:t.nodeModel?t.nodeModel.getStructurePath():t.nodeModel,virtualRowID:t.virtualRowID,virtualColumnID:t.virtualColumnID,dataIndex:t.dataIndex}}),this.getManager()._getParent()._applyDropCell(n,t)}},onDropRowHeaderDefault:function(){},onDragEndCellDefault:function(){},onDragEnterBlankDefault:function(e,t){setTimeout(function(){t.manager.enableDragOverStateForBlank()},10)},onDragLeaveBlankDefault:function(e,t){t.manager.disableDragOverStateForBlank()},onDropBlankDefault:function(e,t){t.manager.disableDragOverStateForBlank();var n=this.unserializeDragAndDropEvent(e);if(n){var i=n.source.uuid;this._uxid===i?this._dndMode="move":this._dndMode="copy",t.mode=this._dndMode,t.manager._recordInteractionFromUI({event:"drop:blank",data:{unserializedData:n,dropPosition:t.dropPosition,mode:this._dndMode,nodeRecordPath:t.nodeModel?t.nodeModel.getStructurePath():t.nodeModel,virtualRowID:t.virtualRowID,virtualColumnID:t.virtualColumnID,dataIndex:t.dataIndex}}),this.getManager()._getParent()._applyDropBlank(n,t)}},onDragStartRowHeaderDefault:function(){},useTransparentScroller:!1},init:function(t){var i=this;void 0===t&&(t={}),t.columns||(t.columns=e.clone(this.defaultOptions.columns));var o=e.extend(e.clone(this.defaultOptions.selection),t.selection);if(t&&t.isEditable){var s={switchToWriteView:{event:n.POINTERHIT,callback:function(e){var t=e.event;if(t&&1===t.multipleHitCount&&!o.toggle||t&&2===t.multipleHitCount&&o.toggle){var s=this;if(!e.isHeader&&("tree"===e.dataIndex&&l.firstParentWithClass(e.event.target,"wux-layouts-treeview-node")||"tree"!==e.dataIndex&&!l.hasClass(e.event.target,"wux-layouts-treeview-node"))){var a=e.manager.getColumnOptions(e.virtualColumnID),r=e.manager._isCellEditable(e);if(void 0===a.typeRepresentation&&r)if(o.toggle)this.switchToWriteView();else if(!i.getManager().isInMultiSelection()&&1===i.getManager().getNodesXSO().get().length||!0===i.getManager().options.selection.cells){var d=e.manager._getRowLastClick(e.virtualRowID),c=Date.now()-d;if((0!==d&&c>300&&e.manager.getNodesXSO().isIn(e.nodeModel)||0!==d&&c>300&&!0===i.getManager().options.selection.cells)&&!e.manager.isInMultiSelection()){var u=function(){s._isCurrentlyEdited=!1,s.switchToWriteView()};void 0!==window.__karma__||n.isTouchEvent(t)?u():(e.manager._toCellWillBeEdited&&clearTimeout(e.manager._toCellWillBeEdited),e.manager._toCellWillBeEdited=setTimeout(u,500))}e.manager._setRowLastClick(e.virtualRowID,Date.now())}}}},view:function(t){if(!t.isHeader&&!t.typeRepresentation){var n=t.cellView;switch(t.dataIndex){case"tree":""!==t.nodeModel&&(n.setLabel(t.nodeModel.options.label),n.setIcons(i.getIconsToDisplay(t.nodeModel)),n.setBadges(t.nodeModel.options.badges),n._setExpanderState(t.nodeModel.getState()),n._setDepth(t.nodeModel.getNodeDepth()));break;default:var o=new e.Element("input",{type:"text",value:t.cellModel.getCellContent().toString(),class:"wux-layouts-treeview-label"});n.getContent().setContent(o),o.select()}}}},switchToReadView:{event:"blur",callback:function(){this.switchToReadView()},setContent:function(){},getContent:function(){},view:function(e){if(!e.isHeader){e.dataIndex;var t=e.cellModel.getCellContent();return null!=t?e.cellModel.getCellContent().toString():""}}},nodesAreDraggable:!0,cells:!0},a={switchToWriteView:{event:n.POINTERHIT,callback:function(e){var t=e.event;if((t&&1===t.multipleHitCount&&!o.toggle||t&&2===t.multipleHitCount&&o.toggle)&&!e.isHeader&&("tree"===e.dataIndex&&l.firstParentWithClass(e.event.target,"wux-layouts-treeview-label")||"tree"!==e.dataIndex&&!l.hasClass(e.event.target,"wux-layouts-treeview-label"))){var n=e.manager.getColumnOptions(e.virtualColumnID),s=e.manager._isCellEditable(e);if(void 0===n.typeRepresentation&&s)if(o.toggle)this.switchToWriteView();else if(!i.getManager().isInMultiSelection()&&1===i.getManager().getNodesXSO().get().length||!0===i.getManager().options.selection.cells){var a=e.manager._getRowLastClick(e.virtualRowID),r=Date.now()-a;(0!==a&&r>300&&e.manager.getNodesXSO().isIn(e.nodeModel)||0!==a&&r>300&&!0===i.getManager().options.selection.cells)&&(e.manager.isInMultiSelection()||(this._isCurrentlyEdited=!1,this.switchToWriteView())),e.manager._setRowLastClick(e.virtualRowID,Date.now())}}},view:function(e){if(!e.isHeader){var t=e.manager.getColumnOptions(e.virtualColumnID);if(!e.typeRepresentation&&"tree"!==e.dataIndex)return t.onCellRequest?(e.readOnly=!1,t.onCellRequest.call(e.manager,e)):e.cellModel.getCellContent().toString()}}},switchToReadView:{event:"blur",callback:function(){this.switchToReadView()},setContent:function(){},getContent:function(){},view:function(e){var t=e.manager.getColumnOptions(e.virtualColumnID);if(!e.isHeader&&!e.typeRepresentation){if("tree"===e.dataIndex){var n=e.cellView;""!==e.nodeModel&&(n.setLabel(e.nodeModel.options.label),n.setIcons(i.getIconsToDisplay(e.nodeModel)),n.setBadges(e.nodeModel.options.badges),n._setExpanderState(e.nodeModel.getState()),n._setDepth(e.nodeModel.getNodeDepth()))}t.onCellRequest&&(e.readOnly=!0,t.onCellRequest.call(e.manager,e))}}},nodesAreDraggable:!0,cells:!0};"auto"===t.isEditable?(t.isEditable=a,this._setEditionMode(2)):(this._setEditionMode(1),!0===t.isEditable?t.isEditable=s:t.isEditable=e.extend(s,t.isEditable,!0))}this._setupColumns(t),this._currentNodeDropArea=null,this._parent(t,this),this.markForRecord(this.getContent()),this.elements.container.dsModel=this,this.elements.container.setAttribute("data-rec-id","treeListView"),this.elements.container.addClassName("wux-tree-treelistview"),this.elements.container.setAttribute("expander-style",this.options.expanderStyle),this.options.changeColorOnFocus||this._datagrid.elements.container.addClassName("wux-ui-state-focused"),this._treeWidth=200,this._depth=-1,this._rowID=-1,this.getManager()._tree=this;var r=this.getManager();this._modelEvents=r._modelEvents,t.roots&&(t.useAsyncPreExpand&&(this.getManager().getDocument().options.useAsyncPreExpand=!0),this.getManager().getDocument().loadModel(t.roots)),this._observeEvents(),t.treeDocument&&this.getManager().loadDocument(t.treeDocument);var d=this.getManager().onReady(function(){i._modelEvents.unsubscribe(d),i._manageColumnsCSS(t)})},getIconsToDisplay:function(e){return e?e.getIcons():[]},_applyDropBlank:function(e,t){var n=e.data["dswebux/x-tree.treenodemodel+json"];"move"===t.mode&&(t.manager.getDocument().prepareUpdate(),t.manager.getNodesXSO().get().forEach(function(e){e.remove()}),t.manager.getDocument().pushUpdate()),n&&n.forEach(function(e){var n=new o(e);t.manager.getDocument().addChild(n)}),t.manager.disableDragOverStateForBlank()},_applyDropCell:function(e,t){var n=e.data["dswebux/x-tree.treenodemodel+number"],i=e.data["dswebux/x-tree.treenodemodel+json"];"middle"===t.dropPosition&&t.nodeModel._getID()===n||i&&i.forEach(function(e,n){var i=new o(e),s=t.nodeModel;if(t.manager.getDocument().options.shouldAcceptDrop({parentTreeNodeModel:"middle"===t.dropPosition?s:s.getParent(),draggedTreeNodeModel:i,dropPosition:t.dropPosition})){t.manager.getDocument().prepareUpdate();var l=s.getParent(),a=l.getChildren().indexOf(s);if("move"===t.mode&&t.manager.getNodesXSO().get().forEach(function(e){e.remove()}),-1!==t.virtualRowID){var r=t.manager;switch(t.dropPosition){case"top":a=l.getChildren().indexOf(s),l.addChild(i,a);break;default:case"middle":r.getDocument().options.insert.call(r.getDocument(),i,s);break;case"bottom":s.getParent().addChild(i,s.getParent().getChildren().indexOf(s)+1+n)}}t.manager.getDocument().pushUpdate()}})},_setEditionMode:function(e){this._editionMode=e},_getEditionMode:function(){return this._editionMode},_shouldAcceptDrag:function(e){var t=this.getManager().getColumnOptions(e.dataIndex);if(!t)return!1;if(e.isHeader){if(-1===e.virtualRowID){var n=t.isColumnMovable;return void 0===n&&(n=!0),n}return!1}var i=t.isColumnDraggable;return void 0===i&&(i=!0),!!i&&this.getDocument().options.shouldAcceptDrag(e.nodeModel,e)},_getTrueRoot:function(){return this.getManager()._getTrueRoot()},getDocument:function(){return this.getManager().getDocument()},getNthRoot:function(e){return this.getManager().getNthRoot(e)},getRoots:function(){return this.getManager().getRoots()},toggle:function(){this.elements.container.toggle()},_syncRowIndexes:function(){return this.getManager()._syncRowIndexes()},addRoot:function(e){return this.getManager().addRoot(e)},_updateTreeColumnWidth:function(e){var t=e.elements.layout.getDimensions().width;this._treeWidth=this._treeWidth<t?t:this._treeWidth,this.getManager().setColumnWidth("tree",this._treeWidth)},_setupColumns:function(t){var n,i=this,o={text:"Tree",dataIndex:"tree",width:"auto",getValue:function(e){return e.nodeModel},onCellRequest:function(e){if(e.virtualRowID>-1){var t=e.cellView;""!==e.nodeModel&&(void 0===i.options.shouldDisplayTooltip&&t.getContent().setAttribute("title",e.nodeModel.getLabel()),t.setLabel(e.nodeModel.getLabel()),t.setIcons(i.getIconsToDisplay(e.nodeModel)),t.setBadges(e.nodeModel.getBadges()),t.elements.badgeTopRight.style.top!==(-i.options.defaultYDistanceOfTopBadgesFromIconCenter).toString()+"px"&&(t.elements.badgeTopRight.style.top=(-i.options.defaultYDistanceOfTopBadgesFromIconCenter).toString()+"px"),t.elements.badgeBottomRight.style.top!==i.options.defaultYDistanceOfBottomBadgesFromIconCenter.toString()+"px"&&(t.elements.badgeBottomRight.style.top=i.options.defaultYDistanceOfBottomBadgesFromIconCenter.toString()+"px"),t.elements.badgeTopLeft.style.top!==(-i.options.defaultYDistanceOfTopBadgesFromIconCenter).toString()+"px"&&(t.elements.badgeTopLeft.style.top=(-i.options.defaultYDistanceOfTopBadgesFromIconCenter).toString()+"px"),t.elements.badgeBottomLeft.style.top!==i.options.defaultYDistanceOfBottomBadgesFromIconCenter.toString()+"px"&&(t.elements.badgeBottomLeft.style.top=i.options.defaultYDistanceOfBottomBadgesFromIconCenter.toString()+"px"),t._setExpanderState(e.nodeModel._expandState),t._setDepth(e.nodeModel._nodeDepth),e.cellView.elements.container.setContent(e.cellView.elements.layout))}},isDraggable:!0};for(n=0;n<t.columns.length&&"tree"!==t.columns[n].dataIndex;n++);n!==t.columns.length?t.columns[n]=e.extend(o,t.columns[n],!0):t.columns.unshift(o)},_manageColumnsCSS:function(e){var t=0;for(t=0;t<e.columns.length;t++)!0===e.columns[t].allowTextCopy&&this.getManager().addColumnClass(t,"wux-ui-allowTextCopy")},loadColumns:function(e){this.getManager().empty(),this.getManager()._needToComputeColumnReverseDataIndexes(),this.getManager().prepareUpdateView(),this._setupColumns({columns:e}),this.options.columns=e,this._datagrid.options.columns=e,this.getManager().options.columns=e,this._datagrid._loadInternalModel(),this.getManager()._syncRowIndexes(!0),this.getManager().pushUpdateView(!0),this.getManager()._syncRowIndexes(),this.getManager()._syncScrollPositionToHeaders()},_observeEvents:function(){!0===this.options.enableTreeColumnEllipsisOverflow&&this.getContent().setAttribute("tree-overflow","true"),this.options.enableExpandOnDoubleClick&&this.getManager().addEventListener("dblclick",function(e,t){t&&!t.isHeader&&(t.nodeModel.isExpanded()?t.nodeModel.collapse():t.nodeModel.expand())})},onExpand:function(e){return this.getManager().getDocument().subscribe({event:"expand"},e)},onCollapse:function(e){return this.getManager().getDocument().subscribe({event:"collapse"},e)},onNodeDragOver:function(e){return this.getManager().getDocument().subscribe({event:"NODE/DRAG_OVER"},e)},onNodeDragStart:function(e){return this.getManager().getDocument().subscribe({event:"NODE/DRAG_START"},e)},onNodeDragLeave:function(e){return this.getManager().getDocument().subscribe({event:"NODE/DRAG_LEAVE"},e)},onNodePreDrop:function(e){return this.getManager().getDocument().subscribe({event:"NODE/PRE_DROP"},e)},onNodePostDrop:function(e){return this.getManager().getDocument().subscribe({event:"NODE/POST_DROP"},e)},onPreExpand:function(e){return this.getManager().getDocument().subscribe({event:"preExpand"},e)},onPostExpand:function(e){return this.getManager().getDocument().subscribe({event:"postExpand"},e)},onPreCollapse:function(e){return this.getManager().getDocument().subscribe({event:"preCollapse"},e)},onPostCollapse:function(e){return this.getManager().getDocument().subscribe({event:"postCollapse"},e)},onNodeClick:function(e){return this.getManager()._modelEvents.subscribe({event:"nodeclick"},e)},onNodeDblClick:function(e){return this.getManager()._modelEvents.subscribe({event:"nodeDblClick"},e)},onLabelChange:function(e){return this.getManager().getDocument().subscribe({event:"UPDATE_LABEL"},e)}}),u={nodeShouldBeSelected:function(e){return!0},allowUnsafeHTMLContent:void 0,shouldCellAllowUnsafeHTMLContentAt:function(e){return e.manager.options.allowUnsafeHTMLContent},enableScrollOnDrag:!0,defaultCellHeight:38,defaultCellWidth:200,changeColorOnFocus:!0,iconsSize:22,roots:[],height:400,infiniteScrolling:!0,useAsyncPreExpand:!0,isEditable:!0,resize:{columns:!0,rows:!0},columns:[{text:"Tree",dataIndex:"tree",width:"auto"}],apiVersion:2,selection:{viewBased:!1,nodes:!0,preSelection:!1,toggle:!1,rowHeaders:!1,unselectAllOnEmptyArea:!0,enableListSelection:!0,canMultiSelect:!0},show:{rowHeaders:!0,columnHeaders:!0},headersDimensions:{width:50,height:24},enableTreeColumnEllipsisOverflow:!0,enableKeyboardNavigation:!0,enableActiveUI:!0,keymaps:{"/":"treelistview:collapse-all-node","*":"treelistview:expand-all-node","+":"treelistview:expand-node","-":"treelistview:collapse-node","ctrl+space":"treelistview:toggle-selection","ctrl+right":"treelistview:go-to-next-node","shift+right":"treelistview:go-to-next-node",right:"treelistview:go-to-next-node","ctrl+left":"treelistview:go-to-previous-parent-node","shift+left":"treelistview:go-to-previous-parent-node",left:"treelistview:go-to-previous-parent-node","ctrl+up":"treelistview:go-to-previous-visible-node","shift+up":"treelistview:go-to-previous-visible-node",up:"treelistview:go-to-previous-visible-node","ctrl+down":"treelistview:go-to-next-visible-node","shift+down":"treelistview:go-to-next-visible-node",down:"treelistview:go-to-next-visible-node",esc:"treelistview:edit-cancel",pageup:"treelistview:go-to-previous-page-node",pagedown:"treelistview:go-to-next-page-node","shift+pageup":"treelistview:go-to-previous-page-node","shift+pagedown":"treelistview:go-to-next-page-node","ctrl+pageup":"treelistview:go-to-previous-page-node","ctrl+pagedown":"treelistview:go-to-next-page-node",home:"treelistview:go-to-first-visible-node",end:"treelistview:go-to-last-visible-node","ctrl+home":"treelistview:go-to-first-visible-node","ctrl+end":"treelistview:go-to-last-visible-node","shift+home":"treelistview:go-to-first-visible-node","shift+end":"treelistview:go-to-last-visible-node","ctrl+a":"treelistview:select-all",f2:"treelistview:edit-label"},performances:{renderingMode:"adaptive",preloadPool:!0,useRequestAnimationFrameRendering:!0,enableColumnVirtualization:!0}};return c.SETTINGS={extend:function(t,n){return"string"==typeof t?e.extend(e.clone(c.SETTINGS[t]),n,!0):e.extend(e.clone(t),n,!0)}},Object.defineProperty(c.SETTINGS,"STANDARD_CHECKBOXES",{get:function(){return e.extend(e.clone(u),{columns:[{text:"",dataIndex:"selection",type:"selection",width:40},{text:"Tree",dataIndex:"tree",width:"auto"}],performances:{renderingMode:"adaptive"}})}}),Object.defineProperty(c.SETTINGS,"STANDARD",{get:function(){return e.clone(u)}}),r.register(c,"DS/TreeRec/TreeListViewRec"),c}),define("DS/Tree/ListView",["DS/Core/Core","DS/Tree/TreeListView"],function(e,t){"use strict";var n=t.extend({defaultOptions:t.SETTINGS.extend("STANDARD",{show:{columnHeaders:!1,rowHeaders:!1}}),init:function(e){this._parent(e),this.getContent().addClassName("wux-tree-listview")}});return n.SETTINGS={extend:t.SETTINGS.extend},Object.defineProperty(n.SETTINGS,"STANDARD",{get:function(){return UWA.extend(t.SETTINGS.STANDARD,{show:{columnHeaders:!1,rowHeaders:!1}})}}),Object.defineProperty(n.SETTINGS,"STANDARD_CHECKBOXES",{get:function(){return UWA.extend(t.SETTINGS.STANDARD_CHECKBOXES,{show:{columnHeaders:!1,rowHeaders:!1}})}}),n}),define("DS/Tree/PropertyListView",["DS/Controls/Abstract","DS/Tree/TreeListView","DS/Tree/TreeNodeView"],function(e,t,n){"use strict";var i=n.extend({init:function(e){this._parent(e)},updateInternalParameters:function(){this._parent();var e=this.getCellInfos();if(e){var t=e.nodeModel,n=t.getNextNode();"category"===t.options.grid.type?this.getContent().addClassName("wux-controls-propertylistview-category"):this.getContent().removeClassName("wux-controls-propertylistview-category"),t.options.grid.value?this.getContent().removeClassName("wux-controls-propertylistview-category-off"):this.getContent().addClassName("wux-controls-propertylistview-category-off"),"category"===t.options.grid.type&&!t.isExpanded()||"category"===t.options.grid.type&&t.isExpanded()&&0===t.getVisibleChildren().length||"category"!==t.options.grid.type&&n&&"category"===n.options.grid.type?this.getContent().addClassName("wux-controls-propertylistview-expander"):this.getContent().removeClassName("wux-controls-propertylistview-expander")}}}),o=void 0,s=e.inherit({name:"propertyListView",publishedProperties:{treeDocument:{defaultValue:void 0,type:"DS/TreeModel/TreeDocument",category:"Behavior"},typeFactory:{defaultValue:void 0,type:"DS/Tweakers/TypeRepresentationFactory",category:"Behavior"}},_applyTreeDocument:function(){if(this.elements.editor){var e=this.elements.editor.getManager();e&&e.loadDocument(this.treeDocument)}},_applyTypeFactory:function(){o=this.typeFactory},handleEvents:function(){if(this.elements.editor){var e=this.elements.editor.getManager();if(e){e.addEventListener("click",function(e,t){if(t&&"tree"===t.dataIndex){var n=t.nodeModel;n&&n.options&&n.options.grid&&"category"===n.options.grid.type&&(n.isExpanded()?n.collapse():n.expand())}});var t=e.getDocument();t&&(t.options.shouldAcceptDrag=function(e){return!1},t.expandAll(),t.onNodeModelUpdate(function(e){if(e&&e.target){var n=e.target;"category"===n.options.grid.type&&(t.prepareUpdate(),n.options.grid.value?n.showChildNodes():n.hideChildNodes(),t.pushUpdate())}}))}}},buildView:function(){this.elements.container.addClassName("wux-controls-propertylistview"),this.elements.editor=new t(r),this.elements.editor.inject(this.elements.container)},_applyProperties:function(e){this._parent(e),this.isDirty("treeDocument")&&this._applyTreeDocument(),this._applyTypeFactory()}});function l(e){if(e.event&&e.event.dsModel)return e.event.dsModel.value}function a(e){e.nodeModel.options.grid.value=e.value,e.manager.updateRowViewWithException(e.nodeModel,e.dataIndex)}var r={apiVersion:2,defaultCellHeight:38,height:"auto",cellClass:i,show:{rowHeaders:!1,columnHeaders:!1},expanderStyle:"triangle",performances:{buildLinks:!1},resize:{columns:!0},selection:!1,columns:[{dataIndex:"tree",text:"Label",isDraggable:!1,isHidden:!1,width:160},{dataIndex:"value",text:"Value",isEditable:!0,width:90,onCellRequest:function(e){if(o){var t=e.cellView;if(e.nodeModel&&e.nodeModel.options){var n=e.nodeModel.options.grid,i=n.value,s=n.type;null!==s&&o.generateView(i,{typePath:s,context:"inlinedTemplate",onViewCreated:function(e){void 0!==e&&(t.getContent().setContent(e),!1===n.available&&(e.disabled=!0,e.elements.internalView&&(e.elements.internalView.disabled=!0)))}})}}},onCellChange:l,setValue:a},{dataIndex:"value2",text:"Detailed Value",isEditable:!0,width:"auto",onCellRequest:function(e){if(o){var t=e.cellView;if(e.nodeModel&&e.nodeModel.options){var n=e.nodeModel.options.grid,i=n.value,s=void 0!==n.detailedType?n.detailedType:n.type;"category"===s&&(s="gfx_category"),s&&o.generateView(i,{typePath:s,context:"detailedTemplate",onViewCreated:function(e){void 0!==e&&(t.getContent().setContent(e),!1===n.available&&(e.disabled=!0,e.elements.internalView&&(e.elements.internalView.disabled=!0)))}})}}},onCellChange:l,setValue:a}]};return s}),define("DS/Tree/GridView",["UWA/Core","UWA/Class","DS/Layouts/GridEngine","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents","DS/Tree/TreeDocument","DS/UIBehaviors/ContextualMenuManager","DS/TreeModel/TreeNodeModel","DS/Menu/ContextualMenu","DS/Utilities/Dom","DS/Utilities/TouchUtils"],function(e,t,n,i,o,s,l,a,r,d,c){"use strict";var u=!1;return n.extend({defaultOptions:{width:"100%",strectchBackgroundImage:!0,checkboxVisibleFlag:!0,checkboxVisibilityFlag:"always",titleDisplayedOnTwoLines:!1,model:[],selection:{unselectAllOnEmptyArea:!0,toggle:!0,canMultiSelect:!0,enableListSelection:!1,canInteractiveMultiselectWithCheckboxClick:!1},enableActiveUI:!1,enableKeyboardNavigation:!1,layoutOnSingleRow:!1,shouldDisplayTooltipFlag:!0,displayBadges:!0,onDragStartCellDefault:function(e,t){var n=void 0,i=t.nodeModel;i&&(n=i.getTreeDocument()),n&&n.options.shouldAcceptDrag(i)?(e.dataTransfer.setData("Text",JSON.stringify(t.nodeModel.dump())),e.dataTransfer.effectAllowed="move"):e.preventDefault()},onDragEnterBlankDefault:function(e,t){t.manager.getScroller().getContent().addClassName("wux-ui-state-drag-over")},onDragLeaveBlankDefault:function(e,t){t.manager.getScroller().getContent().removeClassName("wux-ui-state-drag-over")},onDragOverCellDefault:function(e,t){},onDragOverBlankDefault:function(e,t){e.preventDefault()},onDropBlankDefault:function(e,t){return e.preventDefault(),!1},performances:{numberOfRowsFactor:3,numberOfColumnsFactor:3}},init:function(e){this._parent(e),this.options._firstLoadDone=0,this._modelEventsListener=[],this._xsoEventsListener=[];var t=this;this._isInteractiveMultiSelMode=!1,this._interactiveCumulativeSelection=!1,this.onCellPointerDown(function(e){var n=e.event;return n&&i.isTouchEvent(n)?void 0:t._onCellClickOrPointerDown(e)}),this.onCellClick(function(e){var n=e.event;if(n&&i.isTouchEvent(n))return t._preventSelectionForTouchScroll?void 0:t._onCellClickOrPointerDown(e);!0===t._needToSelectAtRelease&&(!1===t.isInMultiSelection()?(t.options.TreedocModel.getXSO().empty(),t.setActiveNode(e.cellModel,!1),e.cellModel.select(),t.options.lastSelectedNode=e.cellModel):t.options.selection.toggle&&e.cellModel.unselect()),t._needToSelectAtRelease}),this._modelEvents.subscribe({event:"active"},function(e){t._updateAllPoolSelectedViews()}),!this.options.TreedocModel&&this.options.model instanceof s&&this.loadGridViewModel(this.options.model),this.onReady(function(){this.elements.container.addClassName("wux-layout-gridview"),this.elements.container.setAttribute("tabindex","0"),void 0===this.options._observeDragAndDropEvents&&(this._observeDragAndDropEvents(),this.options._observeDragAndDropEvents=!0),void 0===this.options._observeDoubleClickEvent&&(this._observeDoubleClickEvent(),this.options._observeDoubleClickEvent=!0),this._updateCheckBoxVisibility(),this._updateStrectchBackgroundImage(),this._updateTitleDisplayedOnTwoLines();var e=this;if(void 0===this.options._observeContextualEvent){this.options._observeContextualEvent=!0;var t=e.options.onContextualEvent;if(t)r.addEventListener(this.elements.container,{callback:function(n){var i=!!e._cellCtxMenuRequired;return e._cellCtxMenuRequired=!1,t.callback.call(t.this,{context:n.context,infos:n.info,data:n.data,cellInfos:void 0,infoContext:n.context,cellCtxMenuRequired:i})}});else{var n=this.options.onContextualMenuReady,i=n;"function"==typeof n&&(i=function(){return n.call(e,void 0)}),l.onReady({target:this.elements.container,nodes:i})}}this.options.delayedInputModel&&(this.updateModel(this.options.model),this.options.delayedInputModel=null);var o=this.getScroller();if(o&&this.options.responsiveWidthBehavior){var s=o.getContent().getDimensions();this.onTileGridViewResize(s)}})},_onCellClickOrPointerDown:function(e){var t=this;"atCellHover"===t.options.checkboxVisibilityFlag&&("none"===window.getComputedStyle(e.cellView._view.elements.checkbox.getContent()).display&&(t._isTouchWithatCellHover=!0));if(t._needToSelectAtRelease=!1,e.cellModel.isSelected()&&!t.isInShiftSelection()){var n=e.event;if(!n||!i.isTouchEvent(n))return void(t._needToSelectAtRelease=!0);t.options.selection.toggle&&!0===t.isInMultiSelection()&&e.cellModel.unselect()}else t.isInMultiSelection()||t.isInShiftSelection()||t.options.TreedocModel.getXSO().empty(),t.setActiveNode(e.cellModel,!1),e.cellModel.select(),t.isInShiftSelection()||(t.options.lastSelectedNode=e.cellModel);if(t.isInShiftSelection()&&t.options.lastSelectedNode!==e.cellModel){t.options.TreedocModel.prepareUpdate(),t.options.TreedocModel.getXSO().empty();var o=t.options.lastSelectedNode,s=e.cellModel;if(o&&s){var l=o._getRowID(!0),a=s._getRowID(!0),r=a>l?l:a,d=r===l?a:l,c=t.options.model,u=0,h=[];for(u=r;u<=d;u++){var p=c[u];p.isVisible()&&!p.isSelected()&&(t.setActiveNode(p,!1),h.push(p))}t.options.TreedocModel.getXSO().add(h),t.options.TreedocModel.pushUpdate()}}},firstParentWithClass:function(e,t){var n=e;return n?(" "+n.className+" ").replace(/[\n\t]/g," ").indexOf(" "+t+" ")>-1?n:this.firstParentWithClass(n.parentNode,t):void 0},hasClass:function(e,t){return(" "+e.className+" ").replace(/[\n\t]/g," ").indexOf(" "+t+" ")>-1},_observeDragAndDropEvents:function(){this.elements.container.addEvent("dragstart",this._processDragAndDropCallback.bind(this)),this.elements.container.addEvent("drop",this._processDragAndDropCallback.bind(this)),this.elements.container.addEvent("dragover",this._processDragAndDropCallback.bind(this)),this.elements.container.addEvent("drag",this._processDragAndDropCallback.bind(this)),this.elements.container.addEvent("dragend",this._processDragAndDropCallback.bind(this)),this.elements.container.addEvent("dragleave",this._processDragAndDropCallback.bind(this)),this.elements.container.addEvent("dragenter",this._processDragAndDropCallback.bind(this))},_observeDoubleClickEvent:function(){var e=this;e.elements.container.addEventListener("dblclick",function(t){var n=e.firstParentWithClass(t.target,"wux-datagrid-cell");if(1===t.which&&n&&n.dsView){var i=n.dsView.getCellInfos();i.event=t,void 0!==i.cellModel&&e._modelEvents.publish({event:"dblclick",context:i.cellModel,data:i})}})},_processDragAndDropCallback:function(e){var t=this,n=this.firstParentWithClass(e.target,"wux-datagrid-cell"),i={dragstart:"onDragStart",dragend:"onDragEnd",dragenter:"onDragEnter",dragleave:"onDragLeave",drag:"onDrag",dragover:"onDragOver",drop:"onDrop"}[e.type],o=n&&n.dsView?n.dsView.getCellInfos():{manager:this};if("dragstart"===e.type){var s=!0,l=t.options.TreedocModel?t.options.TreedocModel.getXSO():void 0;if(l&&o.nodeModel&&(s=l.isIn(o.nodeModel)),!!t.options.TreedocModel&&t.options.TreedocModel.options.shouldAcceptDrag(o.cellModel)&&s){if(e.dataTransfer){var a=e.target.getBoundingClientRect(),r=e.clientX-a.left,d=e.clientY-a.top;"function"==typeof e.dataTransfer.setDragImage&&e.dataTransfer.setDragImage(e.target,r,d)}}else e.preventDefault()}function c(n,i){var s=!1,l=t.options[n+i];l?(s=l.call(o.parent,e,o),u&&"onDragOver"!==n&&console.info("[dnd]",n+i,">",s,e.target)):u&&console.warn("[dnd]","cannot find",n+i,"callback");var a=t.options[n+i+"Default"];a&&(void 0===l||l&&s)&&(u&&(l&&s?console.info("\t>[dnd]","dev want to continue to the default behavior for ",n+i," callback"):console.info("\t>[dnd]","use the default behavior for ",n+i," callback")),a.call(o.parent,e,o))}o.cellView?c(i,"Cell"):c(i,"Blank")},_updatePoolSelectedViews:function(e){this.processPoolCells(function(t){var n=t.cellView;if(n){var i=n.getCellInfos();if(i){var o=i.cellModel;void 0!==o&&o===e&&(this.options.enableActiveUI&&(o===this.options.activeNode?n.activate():n.deactivate()),e.isSelected()?n.highlight():n.unhighlight())}}})},_updateAllPoolSelectedViews:function(){this.processPoolCells(function(e){var t=e.cellView;if(t){var n=t.getCellInfos();if(n){var i=n.cellModel;void 0!==i&&(this.options.enableActiveUI&&(i===this.options.activeNode?t.activate():t.deactivate()),i.isSelected()?t.highlight():t.unhighlight())}}})},setActiveNode:function(e,t){return this._setActiveNode(e,t)},_setActiveNode:function(e,t){this.options.activeNode=e,!0===t&&this.options.enableActiveUI&&this._modelEvents.publish({event:"active",context:e,data:e._getNodeInfos()})},_flattenTreeDocument:function(e){var t;return e&&(t=e.getAllDescendants().filter(function(e){return e.isVisible()})),!0===this.options.layoutOnSingleRow&&(this.options.numberOfColumns=t.length),t},_observeSelMultiSel:function(){var t=this;this._modeIsMultiSel=!1,this._modeIsListSel=!1,this._modeIsShiftSel=!1;var n=!1;function i(e){var i=t.options.activeNode?t.options.activeNode:t.options.lastSelectedNode;if(i){var o=i._getNodeInfos();if(o){var s=l(o,e);s.node&&(t.options.mutePoolrefresh=!0,t.setActiveNode(s.node,!1),t.options.lastSelectedNode=s.node,t.options.mutePoolrefresh=!1,s.node.select(!0),a(s.node,s.index))}}n=!1}function o(e){var i=t.options.activeNode?t.options.activeNode:t.options.lastSelectedNode;if(i){var o=i._getNodeInfos();if(o){var s=l(o,e);s.node&&(t.setActiveNode(s.node,!0),a(s.node,s.index))}}n=!1}function s(e){var i=t.options.lastSelectedNode._getRowID(!0),o=t.options.activeNode;if(o){var s=o._getNodeInfos();if(s){var r=l(s,e),d=function(e,n,i){var o=[],s=[],l=e,a=void 0;for(;l!==n;)(a=t.getCellModel(l))&&!a.isSelected()&&o.push(a),n>=e?l++:l--;l===n&&(a=t.getCellModel(l))&&!a.isSelected()&&o.push(a);l=(n-e)*(i-n)>=0?n:i;var r=void 0;if(l!==i){for(;l!==i;)(r=t.getCellModel(l))&&r.isSelected()&&l!==n&&s.push(r),i>n?l++:l--;l===i&&(r=t.getCellModel(l))&&r.isSelected()&&s.push(r)}return{toSelect:o,toUnselect:s}}(i,r.index,o._getRowID(!0));if(r.node){t.options.mutePoolrefresh=!0,t.options.TreedocModel.prepareUpdate();var c=t.options.TreedocModel.getXSO();c.add(d.toSelect),c.remove(d.toUnselect),t.setActiveNode(r.node,!1),t.options.mutePoolrefresh=!1,t.options.TreedocModel.pushUpdate(),a(r.node,r.index)}}}n=!1}function l(e,n){for(var i=e.nodeModel._getRowID(!0),o=i+n,s=void 0,l=Math.ceil(t.options.model.length/t._numberOfColumns),a=Math.ceil((i+1)/t._numberOfColumns),r=t._numberOfColumns===n&&l===a||-t._numberOfColumns===n&&1===a;0!==n&&(s=t.getCellModel(o),!r)&&!s;)n>0?(n--,o--):(n++,o++);return{index:o,node:s}}function a(e,n){return t._scrollToNode(e,n)}function r(e){var n=t.options.activeNode?t.options.activeNode:t.options.lastSelectedNode;if(n){var i=n._getNodeInfos().nodeModel._getRowID(!0),o=t.getScrollerPosition(),s=t.getScroller().getContent().getDimensions(),l=o.y,a=o.x,r=Math.ceil(s.height/(t.options.defaultCellHeight+t.options.cellSpacing.vertical)),d=Math.ceil(s.width/(t.options.defaultCellWidth+t.options.cellSpacing.horizontal)),c=0,u=0,h=0,p=1,g=0;if(!1===t.options.layoutOnSingleRow?(u=(i-i%t._numberOfColumns)*(t.options.defaultCellHeight+t.options.cellSpacing.vertical)/t._numberOfColumns-l,h=Math.ceil(u/(t.options.defaultCellHeight+t.options.cellSpacing.vertical))):(i,u=i*(t.options.defaultCellWidth+t.options.cellSpacing.horizontal)-a,h=Math.ceil(u/(t.options.defaultCellWidth+t.options.cellSpacing.horizontal))),"home"===e)return-i;if("end"===e)return t.options.model.length-1-i;if("pageup"===e){if(!1===t.options.layoutOnSingleRow){if(0===(c=-h*t._numberOfColumns)){for(p=1,g=0,p=1;p<=r-1;p++)if(g=p,i-t._numberOfColumns*p<0){g--;break}c=-t._numberOfColumns*g}}else if(0===(c=-h)){for(p=1,g=0,p=1;p<=d-1;p++)if(g=p,i-p<0){g--;break}c=-g}return c}if("pagedown"===e){if(!1===t.options.layoutOnSingleRow){if(0===(c=(r-h-1)*t._numberOfColumns)){for(p=1,g=0,p=1;p<=r-1;p++)if(g=p,i+t._numberOfColumns*p>=t.options.model.length){g--;break}0===(c=t._numberOfColumns*g)&&(t.options.model.length-1)%t._numberOfColumns<i%t._numberOfColumns&&(c=t._numberOfColumns)}}else if(0===(c=d-h-1)){for(p=1,g=0,p=1;p<=d-1;p++)if(g=p,i+p>=t.options.model.length){g--;break}c=g}return c}}return 0}d.addEventOnElement(this,document,"keydown",function(n){var i=e.Event.whichKey(n);!t.options.selection.enableListSelection||"shift"!==i&&"meta+["!==i?!t.options.selection.canMultiSelect||"ctrl"!==i&&"meta+["!==i||(t._modeIsMultiSel=!0):t._modeIsShiftSel=!0,"ctrl+pageup"!==i&&"ctrl+pagedown"!==i||n.preventDefault()}),d.addEventOnElement(this,document,"keyup",function(n){var i=e.Event.whichKey(n);"ctrl"!==i&&"meta+["!==i||(t._modeIsMultiSel=!1),(t.options.selection.enableListSelection&&"shift"===i||"meta+["===i)&&(t._modeIsShiftSel=!1)}),this.options.enableKeyboardNavigation&&d.addEventOnElement(this,t.getContent(),"keydown",function(l){if(!1===n&&(l.target===t.getContent()||l.currentTarget===t.getContent())){var a=t.options.activeNode;if(a){var d=e.Event.whichKey(l);switch([32,33,34,35,36,37,38,39,40].indexOf(l.keyCode)>-1&&(l.preventDefault(),l.stopPropagation()),d){case"ctrl+space":case"space":a.isSelected()?a.unselect():a.select();break;case"ctrl+right":o(1);break;case"shift+right":n=!0,s(1);break;case"right":n=!0,i(1);break;case"ctrl+left":o(-1);break;case"shift+left":n=!0,s(-1);break;case"left":n=!0,i(-1);break;case"ctrl+up":o(-t._numberOfColumns);break;case"shift+up":n=!0,s(-t._numberOfColumns);break;case"up":n=!0,i(-t._numberOfColumns);break;case"ctrl+down":o(t._numberOfColumns);break;case"shift+down":n=!0,s(t._numberOfColumns);break;case"down":n=!0,i(t._numberOfColumns);break;case"home":case"end":case"pageup":case"pagedown":i(r(d));break;case"ctrl+home":o(r("home"));break;case"ctrl+end":o(r("end"));break;case"ctrl+pageup":o(r("pageup"));break;case"ctrl+pagedown":o(r("pagedown"));break;case"shift+home":s(r("home"));break;case"shift+end":s(r("end"));break;case"shift+pageup":s(r("pageup"));break;case"shift+pagedown":s(r("pagedown"))}}}})},isInMultiSelection:function(){return this._modeIsMultiSel||this._isInteractiveMultiSelMode},isInShiftSelection:function(){return this._modeIsShiftSel},loadGridViewModel:function(e){if(e){if(this.options.TreedocModel===e)return;if(this.options.TreedocModel=e,this.options.model=this._flattenTreeDocument(e),this.options.model){var t=this.options.TreedocModel._getTrueRoot();if(t&&t.isVisible())this.options.lastSelectedNode=t;else if(t){var n=t.getVisibleChildren();n&&n.length>0&&(this.options.lastSelectedNode=n[0])}this._destroyPool(),0===this.options._firstLoadDone?this.getScroller()?this.loadModel(this.options.model,!0):(this.options.delayedInputModel=this.options.model,this.loadModel(this.options.model,!0)):this.updateModel(this.options.model),this.options._firstLoadDone=1,this._initSpecializedView()}void 0===this.options._observeSelMultiSel&&(this._observeSelMultiSel(),this.options._observeSelMultiSel=!0),this.AddModelEvents(),this.options._firstLoadDone=1}},unloadGridViewModel:function(){this.RemoveModelEvents(),this.options.TreedocModel=null,this.options.model=[],this._destroyPool(),this.updateView(!0)},AddModelEvents:function(){var e=this,t=this.options.TreedocModel.getXSO().onChange(function(t){!0!==e.options.mutePoolrefresh&&(e._updatePoolSelectedViews(t),e._preventUpdateInternalModel=!0,e._onSelectionChange())});this._xsoEventsListener.push(t),t=this.options.TreedocModel.getXSO().onAdd(function(t){e._modelEvents.publish({event:"selectionAdded",context:t,data:t}),e.setActiveNode(t),e._updatePoolSelectedViews(t),e._preventUpdateInternalModel=!0}),this._xsoEventsListener.push(t),t=this.options.TreedocModel.getXSO().onRemove(function(t){e._modelEvents.publish({event:"selectionRemoved",context:t,data:t}),e._updatePoolSelectedViews(t),e._preventUpdateInternalModel=!0}),this._xsoEventsListener.push(t);var n=0;t=this.options.TreedocModel.addModelEventListener("prepareUpdate",function(e){n++}),this._modelEventsListener.push(t),t=this.options.TreedocModel.addModelEventListener("pushUpdate",function(t){if(--n<0&&console.error("You pushed too many updates"),0===n){if(e.options.mutePoolrefresh)return;if(e.options.TreedocModel){var i=t.data.nodeModel;if(-1===e.options.model.indexOf(i))if(e.options.TreedocModel._getTrueRoot()!==i)e.options.model=e._flattenTreeDocument(e.options.TreedocModel),e.updateView(!0);else{var o,s=e._flattenTreeDocument(e.options.TreedocModel),l=e.options.model,a=!1;if(s.length!==l.length&&(a=!0),!1===a)for(o=0;o<s.length;o++)if(s[o]!==l[o]){a=!0;break}!0===a?(e.options.model=e._flattenTreeDocument(e.options.TreedocModel),e.updateView(!0)):e._updateAllPoolSelectedViews()}else e._updateAllPoolSelectedViews()}}}),this._modelEventsListener.push(t),t=this.options.TreedocModel.onUpdate(function(t){!0!==e.options.mutePoolrefresh&&(e._preventUpdateInternalModel||(e._destroyPool(),e.options.model=e._flattenTreeDocument(e.options.TreedocModel),e.updateView(!0)),e._preventUpdateInternalModel=!1)}),this._modelEventsListener.push(t),t=this.options.TreedocModel.onPostExpand(function(){e.options.model=e._flattenTreeDocument(e.options.TreedocModel),e.updateView(!0)}),this._modelEventsListener.push(t),t=this.options.TreedocModel.onPostCollapse(function(){e.options.model=e._flattenTreeDocument(e.options.TreedocModel),e.updateView(!0)}),this._modelEventsListener.push(t)},RemoveModelEvents:function(){if(this.options.TreedocModel){for(var e=0;e<this._modelEventsListener.length;e++)this.options.TreedocModel.getModelEvents().unsubscribe(this._modelEventsListener[e]);this._modelEventsListener.splice(0,this._modelEventsListener.length);for(e=0;e<this._xsoEventsListener.length;e++)this.options.TreedocModel.getXSO().unsubscribe(this._xsoEventsListener[e]);this._xsoEventsListener.splice(0,this._xsoEventsListener.length)}},_scrollToNode:function(e,t){var n=this;if(e){var i=n.getScrollerPosition(),o=n.getScroller(),s=o.getContent().getDimensions();if(!1===n.options.layoutOnSingleRow){var l=(t-t%n._numberOfColumns)*(n.options.defaultCellHeight+n.options.cellSpacing.vertical)/n._numberOfColumns,a=n.options.defaultCellHeight,r=i.y,d=r+s.height-a,c=n.getCellsContainerSize().width>n.getScroller().getContent().getDimensions().width?20:0;l>d&&(o.getContent().scrollTop=l-s.height+a+c+4),l<=r&&(o.getContent().scrollTop=l)}if(!0===n.options.layoutOnSingleRow){var u=n.options.defaultCellWidth,h=i.x,p=h+s.width-u,g=t*(n.options.defaultCellWidth+n.options.cellSpacing.horizontal),m=n.getCellsContainerSize().height>n.getScroller().getContent().getDimensions().height?20:0;g>p&&(o.getContent().scrollLeft=g-s.width+u+m+4),g<=h&&(o.getContent().scrollLeft=g)}}},_onSelectionChange:function(){},onSelectionAdd:function(e){return this._modelEvents.subscribe({event:"selectionAdded"},e)},onSelectionRemove:function(e){return this._modelEvents.subscribe({event:"selectionRemoved"},e)},onGridViewCellDoubleClick:function(e){return this._modelEvents.subscribe({event:"dblclick"},e)},setCheckBoxesVisible:function(e){!0===e?(this.options.checkboxVisibleFlag=!0,this.options.checkboxVisibilityFlag="always"):(this.options.checkboxVisibleFlag=!1,this.options.checkboxVisibilityFlag="never"),this._updateCheckBoxVisibility()},getCheckBoxesVisible:function(){return this.options.checkboxVisibleFlag},setCheckboxVisibilityFlag:function(e){"always"===e?this.options.checkboxVisibilityFlag="always":"atCellHover"===e?this.options.checkboxVisibilityFlag="atCellHover":"never"===e&&(this.options.checkboxVisibilityFlag="never"),this._updateCheckBoxVisibility()},getCheckboxVisibilityFlag:function(){return this.options.checkboxVisibilityFlag},_updateCheckBoxVisibility:function(){!1===this.options.checkboxVisibleFlag?this.elements.container.setAttribute("has-checkbox","never"):"always"===this.options.checkboxVisibilityFlag?this.elements.container.setAttribute("has-checkbox","always"):"never"===this.options.checkboxVisibilityFlag?this.elements.container.setAttribute("has-checkbox","never"):"atCellHover"===this.options.checkboxVisibilityFlag&&(!0===c.getTouchMode()?this.elements.container.setAttribute("has-checkbox","always"):this.elements.container.setAttribute("has-checkbox","atCellHover"))},setStrectchBackgroundImage:function(e){this.options.strectchBackgroundImage=!!e,this._updateStrectchBackgroundImage()},getStrectchBackgroundImage:function(){return this.options.strectchBackgroundImage},_updateStrectchBackgroundImage:function(){this.options.strectchBackgroundImage?this.elements&&this.elements.container&&this.elements.container.setAttribute("strectch-background-image","true"):this.elements&&this.elements.container&&this.elements.container.setAttribute("strectch-background-image","false")},getTitleDisplayedOnTwoLines:function(){return this.options.titleDisplayedOnTwoLines},setTitleDisplayedOnTwoLines:function(e){this.options.titleDisplayedOnTwoLines=!!e,this._updateTitleDisplayedOnTwoLines()},_updateTitleDisplayedOnTwoLines:function(){this.options.titleDisplayedOnTwoLines?this.elements&&this.elements.container&&this.elements.container.setAttribute("title-multiple-lines","true"):this.elements&&this.elements.container&&this.elements.container.setAttribute("title-multiple-lines","false")},setShouldDisplayTooltipFlag:function(e){!0===e?this.options.shouldDisplayTooltipFlag=!0:!1===e&&(this.options.shouldDisplayTooltipFlag=!1),this.updateView(!0)},getShouldDisplayTooltipFlag:function(){return this.options.shouldDisplayTooltipFlag},destroy:function(){this.options.TreedocModel&&this.unloadGridViewModel(),d.removeAllEventsOnElement(this),this.options.lastSelectedNode=null,this._parent()}})}),define("DS/Tree/ThumbnailGridView",["UWA/Core","UWA/Class","DS/Tree/GridView","DS/Controls/ThumbnailCellView","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents","DS/Utilities/TouchUtils"],function(e,t,n,i,o,s,l){"use strict";return n.extend({defaultOptions:{width:"100%",cellClass:i,defaultCellHeight:160,defaultCellWidth:210,cellSpacing:{horizontal:10,vertical:10},animationFlag:!0},init:function(e){this._parent(e),this._initSpecializedView()},_initSpecializedView:function(){var t=this;this.onCellRequest(function(e){if(!e.isHeader){e.cellView._view.getContent().setStyles({width:"100%",height:"100%"});var n=e.nodeModel;e.cellView.setTitle(n.options.label),e.cellView.setSubtitle(n.options.subLabel),e.cellView.setPicture(n.options.thumbnail),e.cellView.setColor(n.options.color),e.cellView.setDescription(n.options.description),n.options.icons&&n.options.icons.length?e.cellView.setIcon(n.options.icons[0]):e.cellView.setIcon(""),!0===t.options.displayBadges&&e.cellView.setBadges(e.nodeModel.getBadges()),this.options.enableActiveUI&&n===this.options.activeNode&&e.cellView.activate(),n.isSelected()&&e.cellView.highlight(),this._onPostRequestCellCB&&this._onPostRequestCellCB.call(t,e)}}),this.elements.container&&this.elements.container.addEvent(o.POINTERUP,function(n){if(t.options.selection.unselectAllOnEmptyArea){if(o.isTouchEvent(n)&&t._preventSelectionForTouchScroll)return;if(-1===n.target.className.indexOf("wux-controls-thumbnail")){var i=e.extendElement(n.target).getDimensions(),s=i.width,l=i.height;n.offsetX<s-18&&n.offsetY<l-18&&t.options.TreedocModel&&(t._disableInteractiveMultiSelMode(),t.options.TreedocModel.getXSO().empty())}}})},setAnimationOnCartoucheOver:function(e){this.options.animationFlag=!!e,this._updateAnimationOnCartoucheOver()},_updateAnimationOnCartoucheOver:function(e){this.options.animationFlag?this.elements&&this.elements.container&&this.elements.container.setAttribute("animation-on-cartouche-over","true"):this.elements&&this.elements.container&&this.elements.container.setAttribute("animation-on-cartouche-over","false")},onPostCellRequest:function(e){this._onPostRequestCellCB=e},activateInteractiveCumulativeSelection:function(){this._interactiveCumulativeSelection=!0,this._enableInteractiveMultiSelMode()},isInInteractiveCumulativeSelectionFlag:function(){return this._interactiveCumulativeSelection},deactivateInteractiveCumulativeSelection:function(){this._interactiveCumulativeSelection=!1,this._disableInteractiveMultiSelMode()},_enableInteractiveMultiSelMode:function(){!this.options.selection.canInteractiveMultiselectWithCheckboxClick&&!0!==this._interactiveCumulativeSelection||-1!==this.elements.container.className.indexOf("wux-multiselmode-thumbnail")||!1===this._isInteractiveMultiSelMode&&(this._isInteractiveMultiSelMode=!0,this.elements.container.addClassName("wux-multiselmode-thumbnail"))},_disableInteractiveMultiSelMode:function(){!1===this._interactiveCumulativeSelection&&this.elements.container.className.indexOf("wux-multiselmode-thumbnail")&&!0===this._isInteractiveMultiSelMode&&(this._isInteractiveMultiSelMode=!1,this.elements.container.removeClassName("wux-multiselmode-thumbnail"))}})}),define("DS/Tree/Tree",["UWA/Core","UWA/Class","DS/Tree/TreeListView","DS/Tree/TreeNodeView"],function(e,t,n,i){"use strict";var o=n.extend({defaultOptions:{cellClass:i,defaultCellHeight:28,numberOfColumns:1,headersDimensions:{width:void 0,height:void 0},show:{rowHeaders:!1,columnHeaders:!1}},init:function(e){this._parent(e),this.elements.container.addClassName("wux-controls-treebase")}});return o.SETTINGS=n.SETTINGS,o}),define("DS/Tree/FileTreeView",["DS/Tree/Tree","DS/Tree/Manager"],function(e,t){"use strict";var n=t.extend({defaultOptions:{defaultCellMouseWidth:null,defaultCellMouseHeight:26,defaultCellTouchWidth:null,defaultCellTouchHeight:38,defaultCellHeight:26},init:function(e,t){this._parent(e,t)},getRowHeight:function(e){return-1===e?this.options.defaultCellHeight:this.getTreeNodeModelFromRowID(e).isRoot()?this.options.defaultCellHeight+10:this.options.defaultCellHeight},_getVirtualPositionFromScrollPosition:function(e){void 0===e&&(e=this.getScroller()?this.getScrollerPosition():{x:0,y:0});var t=0,n=0;for(t=0;;){var i=this.getTreeNodeModelFromRowID(t);if(i&&i.isVisible())n+=this.getRowHeight(t);else if(!i)break;if(n>=e.y)break;t++}var o={rowID:t,columnID:Math.floor(e.x/this.options.defaultCellWidth)};if(this.options.performances.enableColumnVirtualization)if(this.getColumnPosition(o.columnID)<e.x){for(;this.getColumnPosition(o.columnID)<e.x;)o.columnID++;o.columnID--}else if(this.getColumnPosition(o.columnID)>e.x)for(;this.getColumnPosition(o.columnID)>e.x;)o.columnID--;return o}});return e.extend({defaultOptions:{apiVersion:2,defaultCellHeight:26,managerClass:n,expanderStyle:"triangle",performances:{buildLinks:!1,useRequestAnimationFrameRendering:!1,debounceCellInternalUpdateTimer:1,debounceCellRequest:!1}},init:function(e){if(e.defaultCellHeight=26,void 0===e.columns)this._parent(e);else{if(e.columns.length>1)throw"You should not use multiple columns with this component.";if("tree"!==e.columns[0].dataIndex)throw'You should have a column option with dataIndex "tree" ';this._parent(e)}this.elements.container.addClassName("wux-tree-filetreeview")}})}),define("DS/Tree/CarouselView",["UWA/Core","DS/Core/Core","DS/Controls/Abstract","DS/TreeModel/TreeDocument","DS/Windows/DockingElement","DS/Utilities/Css","DS/Tree/ThumbnailGridView","DS/Tweakers/TypeRepresentationFactory","DS/Utilities/Utils","DS/Controls/ButtonGroup","DS/Controls/Button","DS/Controls/ThumbnailCellView","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Controls/TooltipModel","i18n!DS/Tree/assets/nls/carousel.json"],function(e,t,n,i,o,s,l,a,r,d,c,u,h,p,g,m){"use strict";var v=function(t){if(t.target.classList.contains("wux-layouts-carousel-main-content")){var n=e.Event.wheelDelta(t);n<0&&w(t.currentTarget._mouseWheelArg),n>0&&f(t.currentTarget._mouseWheelArg)}},f=function(e){if(e.treeDocument){var t=e.treeDocument.getXSO().get();if(0===t.length&&e.treeDocument.getRoots()[0].select(),t.length>0){var n=t[t.length-1].getPreviousVisibleNode();n&&(n.select(!0),e.elements.gridView._scrollToNode(n,n._getRowID(!0)))}}},w=function(e){if(e.treeDocument){var t=e.treeDocument.getXSO().get();if(0===t.length&&e.treeDocument.getRoots()[0].select(),t.length>0){var n=t[t.length-1].getNextVisibleNode();n&&(n.select(!0),e.elements.gridView._scrollToNode(n,n._getRowID(!0)))}}},_=new a,C=n.inherit({name:"carousel",publishedProperties:{treeDocument:{defaultValue:null,type:"object",category:"Model"},intervalTimer:{defaultValue:1,type:"number",category:"Appearance"},height:{defaultValue:"auto",type:"number",category:"Appearance"},onTitleRequest:{defaultValue:function(e){e.nodeView.setContent(e.nodeModel.options.label)},type:"function",category:"Appearance"},onSubtitleRequest:{defaultValue:function(e){e.nodeView.setContent(e.nodeModel.options.subLabel)},type:"function",category:"Appearance"},onRightViewRequest:{defaultValue:function(e){_.generateView(e.nodeModel.options.grid,{typePath:"object",readOnly:!0,onViewCreated:function(t){e.nodeView.setContent(t)}})},type:"function",category:"Appearance"},bigPicturePath:{defaultValue:function(e){return e.nodeModel.options.thumbnail},type:"function",category:"Appearance"},onMainViewRequest:{defaultValue:function(e){e.nodeView.setStyles({backgroundImage:"url("+e.view.bigPicturePath(e)+")",backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"50% 50%"})},type:"function",category:"Appearance"},toolbar:{defaultValue:[],type:"array",category:"behavior"},scrollOnMainViewMouseWheel:{defaultValue:!0,type:"boolean",category:"behavior"}},buildView:function(){this.elements.container=new e.Element("div",{class:"wux-layouts-carousel",tabindex:0}),this.elements.header=new e.Element("div",{class:"wux-layouts-carousel-header"}).inject(this.elements.container),this.elements.headerMainContainer=new e.Element("div",{class:"wux-layouts-carousel-header-main-container"}).inject(this.elements.header),this.elements.headerTitleBar=new e.Element("ul",{class:"wux-layouts-carousel-header-titlebar"}).inject(this.elements.headerMainContainer),this.elements.headerTitle=new e.Element("span",{class:"wux-layouts-carousel-header-title",html:"document title"}).inject(this.elements.headerTitleBar),this.elements.headerSubtitle=new e.Element("span",{class:"wux-layouts-carousel-header-subtitle",html:"document subtitle"}).inject(this.elements.headerTitleBar),this.elements.headerToolbar=new e.Element("ul",{class:"wux-layouts-carousel-header-toolbar"}).inject(this.elements.headerMainContainer),this.elements.containerRel=new e.Element("div",{class:"wux-layouts-carousel-rel",styles:{position:"relative",height:"calc( 100% - 70px)",width:"100%"}}).inject(this.getContent()),this.elements.gridView=new l({checkboxVisibleFlag:!1,layoutOnSingleRow:!0,height:"auto",infiniteScrolling:!0,enableActiveUI:!0,enableKeyboardNavigation:!0,showScrollbarsOnHover:!0}),this.elements.gridView.getContent().setStyles({top:6,height:"auto"}),this.elements.rightViewContent=new e.Element("div",{class:"wux-layouts-carousel-right-content"}),this.elements.dockingZoneContentForBottom=new e.Element("div",{class:"wux-layouts-carousel-main-content wux-layouts-carousel-bottom-content",html:this.elements.gridView,styles:{height:"100%",position:"relative"}}),this.elements.mainView=new e.Element("div",{class:"wux-layouts-carousel-main"}),this.elements.bottomDockingElement=new o({side:WUXDockAreaEnum.BottomDockArea,dockingZoneContent:this.elements.dockingZoneContentForBottom,dockingZoneSize:196,resizableFlag:!1,useBordersFlag:!1,collapsibleFlag:!1,collapseDockingZoneFlag:!1,visibleDockingZoneFlag:!0}),this.elements.rightDockingElement=new o({side:WUXDockAreaEnum.RightDockArea,dockingZoneContent:this.elements.rightViewContent,dockingZoneSize:482,resizableFlag:!0,useBordersFlag:!1,collapsibleFlag:!1,collapseDockingZoneFlag:!1,visibleDockingZoneFlag:!0}),this.elements.bottomDockingElement.freeZoneContent=this.elements.mainView,this.elements.rightDockingElement.freeZoneContent=this.elements.bottomDockingElement,this.elements.mainViewContent=new e.Element("div",{class:"wux-layouts-carousel-main-content"}).inject(this.elements.mainView),this.elements.mainViewLeftArrow=new c({icon:{iconName:"open-left",fontIconSize:"2x",fontIconFamily:WUXManagedFontIcons.Font3DS},value:"1",displayStyle:"lite-borders",tooltipInfos:new g({shortHelp:m.previous,mouseRelativePosition:!1}),clickMode:1}),this.elements.mainViewRightArrow=new c({icon:{iconName:"open-right",fontIconSize:"2x",fontIconFamily:WUXManagedFontIcons.Font3DS},value:"1",displayStyle:"lite-borders",tooltipInfos:new g({shortHelp:m.next,mouseRelativePosition:!1}),clickMode:1}),this.elements.bottomViewLeftArrow=new e.Element("div",{class:"wux-layouts-carousel-bottom-prev wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open-left"}).inject(this.elements.dockingZoneContentForBottom),this.elements.bottomViewRightArrow=new e.Element("div",{class:"wux-layouts-carousel-bottom-next wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open-right"}).inject(this.elements.dockingZoneContentForBottom),this._observeEvents(),this.elements.containerRel.appendChild(this.elements.rightDockingElement.elements.container)},_postBuildView:function(){this._parent()},_observeEvents:function(){var e,t,n=this,i=function(){e&&clearInterval(e),t&&clearInterval(t),n.getGridView()._disableAutoScroll()};this.elements.mainViewLeftArrow.addEventListener("buttonclick",function(){i(),f(n),t=setTimeout(function(){e=setInterval(f,n,n.intervalTimer)},500)}),this.elements.mainViewRightArrow.addEventListener("buttonclick",function(){i(),w(n),t=setTimeout(function(){e=setInterval(w,n,n.intervalTimer)},500)}),this.elements.bottomViewLeftArrow.addEvent(h.POINTERDOWN,function(e){e.preventDefault(),e.stopPropagation(),n.getGridView()._enableAutoScroll({x:-10,y:0},10)}),this.elements.bottomViewRightArrow.addEvent(h.POINTERDOWN,function(e){e.preventDefault(),e.stopPropagation(),n.getGridView()._enableAutoScroll({x:10,y:0},10)});var o=function(e,t,i){!0,n.getGridView().onPostUpdateViewOnce(function(){!1,i&&i.call(n)}),e.call(n,n)};this._manageKeyboardNavigation({throttleTime:50,keymap:{left:function(){o(f)},right:function(){o(w)}}});var s=function(e){e.preventDefault()};this.elements.container.addEventListener("MSHoldVisual",s,!1),this.elements.container.addEventListener("contextmenu",s,!1),this.elements.mainViewLeftArrow.addEvent("mouseleave",i),this.elements.mainViewRightArrow.addEvent("mouseleave",i),this.elements.bottomViewLeftArrow.addEvent("mouseleave",i),this.elements.bottomViewRightArrow.addEvent("mouseleave",i),this.elements.bottomViewLeftArrow.addEvent(h.POINTERUP,i),this.elements.bottomViewRightArrow.addEvent(h.POINTERUP,i),document.body.addEventListener("mouseup",i),document.body.addEventListener("mouseleave",i)},_manageKeyboardNavigation:function(t){var n=this;e.Element.addEvent.call(this.getContent(),"keydown",r.throttle(function(i){if(void 0==={input:!0,textarea:!0}[i.target.tagName.toLowerCase()]&&(p.hasClass(i.target,"wux-layouts-carousel")?i.target:p.firstParentWithClass(i.target,"wux-layouts-carousel"))===n.getContent()){var o=e.Event.whichKey(i);void 0!==t.keymap[o]&&t.keymap[o].call(n)}},t.throttleTime))},_applyHeight:function(e){"auto"===this.height?this.elements.container.setStyles({position:"absolute",top:0,bottom:0,right:0,left:0}):"number"==typeof this.height&&this.elements.container.setStyles({position:"",height:this.height}),this._parent(e)},_updateVisibleDescendants:function(){this._listOfVisibleDescendants=this.treeDocument._getTrueRoot().getAllDescendants([],{onlyVisibleNodes:!0}),console.log(this._listOfVisibleDescendants)},_applyTreeDocument:function(e){if(this.elements.gridView.loadGridViewModel(this.treeDocument),this.treeDocument){var t=this,n=this.treeDocument.getXSO(),i=r.debounce(function(e){t.onRightViewRequest(e)},100),o=function(){var e=n.get(),o=e[e.length-1];t.onMainViewRequest({nodeModel:o,nodeView:t.elements.mainViewContent,view:t}),i.call(t,{nodeModel:o,nodeView:t.elements.rightViewContent,view:t}),t.onTitleRequest({nodeModel:o,nodeView:t.elements.headerTitle,view:t}),t.onSubtitleRequest({nodeModel:o,nodeView:t.elements.headerSubtitle,view:t}),t.elements.gridView._setActiveNode(o,!0)};n.get().length>0&&o.call(n),n.onAdd(o);var s=this.treeDocument.getRoots();0===n.get().length&&s.length&&this.treeDocument.getRoots()[0].select()}this._parent(e)},_applyDisabled:function(){this._parent(),this.disabled?this.elements.container.setAttribute("tabindex",-1):this.elements.container.setAttribute("tabindex",0)},_applyToolBar:function(){var e=this;e.elements.headerToolbar.empty(),this.toolbar.forEach(function(t){t.icon.fontIconSize="2x",t.icon.fontIconFamily=WUXManagedFontIcons.Font3DS,new c({type:t.type,tooltipInfos:t.tooltipInfos,icon:t.icon,value:"1",displayStyle:"lite-borders",touchMode:!0,clickMode:1}).inject(e.elements.headerToolbar).addEventListener("click",function(e){e.stopPropagation(),t.callback&&t.callback()})}),this.elements.mainViewLeftArrow.inject(this.elements.headerToolbar),this.elements.mainViewRightArrow.inject(this.elements.headerToolbar)},_applyScrollOnMainViewMouseWheel:function(t){if(this.scrollOnMainViewMouseWheel!==t){this.scrollOnMainViewMouseWheel?(this._mouseWheelsubscriptionDoneOneTimeAtLeast=!0,e.Element.addEvent.call(this.elements.container,"mousewheel",v),this.elements.container._mouseWheelArg=this):!0===this._mouseWheelsubscriptionDoneOneTimeAtLeast&&(this._mouseWheelsubscriptionDoneOneTimeAtLeast=!1,e.Element.removeEvent.call(this.elements.container,"mousewheel",v),this.elements.container._mouseWheelArg=this)}},_applyProperties:function(e){this._parent(e),this._applyHeight(),this._applyTreeDocument(),this._applyToolBar(),this._applyScrollOnMainViewMouseWheel(e.scrollOnMainViewMouseWheel)},getGridView:function(){return this.elements.gridView},getRightDockingElement:function(){return this.elements.rightDockingElement},getBottomDockingElement:function(){return this.elements.bottomDockingElement}});return C.USE_COLLECTION_VIEW=!1,C}),define("DS/Tree/LightBoxView",["UWA/Core","DS/Core/Core","DS/Tree/CarouselView","DS/Controls/Button","DS/Controls/TooltipModel","i18n!DS/Tree/assets/nls/carousel.json"],function(e,t,n,i,o,s){"use strict";return n.inherit({name:"lightbox",publishedProperties:{target:{defaultValue:document.body,type:"HTMLElement"}},_preBuildView:function(){this._parent()},_postBuildView:function(){window._lb=this,this._parent(),this.elements.container.addClassName("wux-layouts-lightbox"),this._applyVisibleFlag()},_applyVisibleFlag:function(t){this.visibleFlag?this.elements.wrapper||(this.elements.wrapper=new e.Element("div",{class:"wux-layouts-lightbox-overlay",html:this.getContent()}),this.elements.wrapper.inject(this.target)):this.elements.wrapper&&(this.elements.wrapper.remove(),this.elements.wrapper=void 0,this.fire("close")),this._parent(t);var i=this;n.USE_COLLECTION_VIEW||setTimeout(function(){i.getGridView().updateView(!0)},1)},_applyToolBar:function(){this._parent();var e=this;new i({icon:{iconName:"close",fontIconSize:"2x",fontIconFamily:WUXManagedFontIcons.Font3DS},value:"1",displayStyle:"lite-borders",tooltipInfos:new o({shortHelp:s.close,mouseRelativePosition:!1}),clickMode:1}).inject(this.elements.headerToolbar).addEventListener("click",function(t){t.stopPropagation(),e.visibleFlag=!1})}})}),define("DS/Tree/TileGridView",["UWA/Core","UWA/Class","DS/Tree/GridView","DS/Controls/TileCellView","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents","DS/Utilities/TouchUtils"],function(e,t,n,i,o,s,l){"use strict";return n.extend({defaultOptions:{width:"100%",cellClass:i,defaultCellHeight:70,defaultCellWidth:260,cellSpacing:{horizontal:10,vertical:10},useSwipableMenu:!0,responsiveWidthBehavior:!1},onTileGridViewResize:function(e){if(this.options.responsiveWidthBehavior){var t=e.width,n=this.options.defaultCellWidth,i=this.options.cellSpacing.horizontal,o=this.getCellsContainerSize().height>this.getScroller().getContent().getDimensions().height?20:0,s=Math.floor((t-i-o)/(n+i));if(t-i-o-s*(n+i)>50){var l=s+1;if((a=(t-i-o)/l-i)>=260)this.options.defaultCellWidth=a,this.updateView(!0);else if(s>0){var a=(t-i-o)/(l=s)-i;this.options.defaultCellWidth=a,this.updateView(!0)}}}},init:function(e){this._parent(e),this._initSpecializedView()},_initSpecializedView:function(){var t=this;this.onCellRequest(function(e){if(!e.isHeader){e.cellView._view.getContent().setStyles({width:"100%",height:"100%"});var n=e.nodeModel;e.cellView.setTitle(n.options.label),e.cellView.setSubtitle(n.options.subLabel),e.cellView.setPicture(n.options.thumbnail),e.cellView.setColor(n.options.color),e.cellView.setDescription(n.options.description),n.options.icons&&n.options.icons.length?e.cellView.setIcon(n.options.icons[0]):e.cellView.setIcon(""),!0===t.options.displayBadges&&e.cellView.setBadges(e.nodeModel.getBadges()),this.options.enableActiveUI&&n===this.options.activeNode&&e.cellView.activate(),n.isSelected()&&e.cellView.highlight(),this._onPostRequestCellCB&&this._onPostRequestCellCB.call(t,e)}}),this.onGridResize(function(e){this.onTileGridViewResize(e)}),this.elements.container&&this.elements.container.addEvent(o.POINTERUP,function(n){if(t.options.selection.unselectAllOnEmptyArea){if(o.isTouchEvent(n)&&t._preventSelectionForTouchScroll)return;if(-1===n.target.className.indexOf("wux-controls-tile")){var i=e.extendElement(n.target).getDimensions(),s=i.width,l=i.height;n.offsetX<s-18&&n.offsetY<l-18&&t.options.TreedocModel&&(t._disableInteractiveMultiSelMode(),t.options.TreedocModel.getXSO().empty())}}})},onPostCellRequest:function(e){this._onPostRequestCellCB=e},activateInteractiveCumulativeSelection:function(){this._interactiveCumulativeSelection=!0,this._enableInteractiveMultiSelMode()},isInInteractiveCumulativeSelectionFlag:function(){return this._interactiveCumulativeSelection},deactivateInteractiveCumulativeSelection:function(){this._interactiveCumulativeSelection=!1,this._disableInteractiveMultiSelMode()},_enableInteractiveMultiSelMode:function(){!this.options.selection.canInteractiveMultiselectWithCheckboxClick&&!0!==this._interactiveCumulativeSelection||-1!==this.elements.container.className.indexOf("wux-multiselmode-tileView")||!1===this._isInteractiveMultiSelMode&&(this._isInteractiveMultiSelMode=!0,this.elements.container.addClassName("wux-multiselmode-tileView"))},_disableInteractiveMultiSelMode:function(){!1===this._interactiveCumulativeSelection&&this.elements.container.className.indexOf("wux-multiselmode-tileView")&&!0===this._isInteractiveMultiSelMode&&(this._isInteractiveMultiSelMode=!1,this.elements.container.removeClassName("wux-multiselmode-tileView"))}})}),define("DS/Tree/MultiViews",["UWA/Core","UWA/Element","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/KeyboardUtils","DS/Controls/ButtonGroup","DS/Controls/Button","DS/Tree/TreeListView","DS/Tree/ThumbnailGridView","DS/Tree/TileGridView"],function(e,t,n,i,o,s,l,a,r,d){"use strict";var c={useRequestAnimationFrameRendering:!0,debounceCellInternalUpdateTimer:0,debounceCellRequest:!1};return n.inherit({name:"multiviews",publishedProperties:{views:{defaultValue:{listview:{id:"listview",icon:"list",buildView:function(t){var n=new a({apiVersion:2,infiniteScrolling:!0,columns:[{text:"",dataIndex:"selection",type:"selection",width:40},{dataIndex:"color2",width:40,getValue:function(e){return e.nodeModel.options.color},onCellRequest:function(e){if(!e.isHeader){var t=e.cellView.reuseCellContent("color2");t&&t.setStyles({backgroundColor:e.nodeModel.options.color})}}},{dataIndex:"ctx",width:40,onCellRequest:function(e){e.isHeader||e.cellView.reuseCellContent("ctx")}},{dataIndex:"tree",width:"auto"},{dataIndex:"subtitle",width:"auto",getValue:function(e){return e.nodeModel.options.subLabel}}],height:"auto",selection:{toggle:!1},useAsyncPreExpand:!0,performances:c});return n.getManager().registerReusableCellContent({id:"color2",buildContent:function(){return new e.Element("div",{styles:{"border-radius":10,display:"inline-block",border:"1px solid #9d9d9d","vertical-align":"middle",position:"absolute",top:5,left:10,width:20,height:20}})}}),n.getManager().registerReusableCellContent({id:"ctx",buildContent:function(){return new e.Element("div",{class:"wux-ui-fa wux-ui-fa-chevron-down"})}}),n},loadModel:function(e){this.getManager().loadDocument(e.treeDocument)},onBeingActive:function(){this.giveFocus()}},tileview:{id:"tileview",icon:"th-list",buildView:function(e){return new d({height:"auto"})},loadModel:function(e){this.loadGridViewModel(e.treeDocument)}},thumbnailview:{id:"thumbnailview",icon:"th-large",buildView:function(e){return new r({height:"auto",performances:c})},loadModel:function(e){this.loadGridViewModel(e.treeDocument)}}},type:"object",category:"Appearance"},activeView:{defaultValue:"listview",type:"string",category:"Appearance"},treeDocument:{defaultValue:null,type:"object",category:"Model"}},_preBuildView:function(){this.elements.container=new e.Element("div",{class:"wux-layouts-multiviews",tabindex:0}),this.elements.containerRel=new e.Element("div",{class:"wux-layouts-multiviews-rel",tabindex:0}).inject(this.elements.container),this.elements.toolbar=new e.Element("div",{class:"wux-layouts-multiviews-toolbar"}).inject(this.elements.containerRel),this.elements.content=new e.Element("div",{class:"wux-layouts-multiviews-content"}).inject(this.elements.containerRel),this.elements.toolbarSelection=new e.Element("div",{class:"wux-layouts-multiviews-toolbar-selection"}).inject(this.elements.toolbar),this.elements.toolbarNumberOfElements=new e.Element("div",{class:"wux-layouts-multiviews-toolbar-numberElements"}).inject(this.elements.toolbar),this.elements.toolbarViews=new e.Element("div",{class:"wux-layouts-multiviews-toolbar-views"}).inject(this.elements.toolbar),this.elements.buttonGroup=new s,this.elements.buttonGroup.inject(this.elements.toolbarViews),this._parent()},_applyActiveView:function(){var e=this;for(var t in this.views){var n=this.views[t];console.warn(e.activeView,n.id,e.activeView===n.id),e.activeView===n.id&&(e.elements.content.setContent(n.view),n.loadModel.call(n.view,{treeDocument:e.treeDocument}),this.elements.buttonGroup.value=e.activeView)}},_applyViews:function(){console.info("apply views"),this._parent(),this.elements.toolbarViews.empty(),this.elements.content.empty(),this.elements.buttonGroup=new s({minWidth:110}),this.elements.buttonGroup.inject(this.elements.toolbarViews);var e=this;for(var t in this.views){var n=this.views[t];e.elements.buttonGroup.addChild(new l({type:"radio",iconSize:"2x",minWidth:110,emphasize:"info",displayStyle:"lite",icon:n.icon,value:n.id})),n.buildView&&void 0===n.view&&(n.view=n.buildView.call(e,{treeDocument:e.treeDocument}))}this.elements.buttonGroup.addEventListener("change",function(t){e.activeView=t.dsModel.value[0],e.views[t.dsModel.value].onBeingActive&&e.views[t.dsModel.value].onBeingActive.call(e.views[t.dsModel.value].view)})},getView:function(e){return this.views[e].view},_applyTreeDocument:function(){if(this.treeDocument){var e=this;for(var t in this.views){var n=this.views[t];n.loadModel&&n.loadModel.call(n.view,{treeDocument:e.treeDocument})}var i=e.treeDocument.getAllDescendants().length,o=e.treeDocument.getXSO();o.onChange(function(){var t=e.treeDocument.getAllDescendants().length;e.elements.toolbarNumberOfElements.setText(t.toString()),e.elements.toolbarSelection.setText(o.get().length.toString())}),e.elements.toolbarNumberOfElements.setText(i.toString()),this.elements.toolbarSelection.setText(o.get().length.toString())}},_applyDisabled:function(){this._parent(),this.disabled?this.elements.container.setAttribute("tabindex",-1):this.elements.container.setAttribute("tabindex",0)},_applyProperties:function(e){this._parent(e),this._applyViews(),this._applyTreeDocument(),this._applyActiveView()}})});