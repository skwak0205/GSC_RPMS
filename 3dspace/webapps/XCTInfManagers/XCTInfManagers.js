define("DS/XCTInfManagers/XCTInfManagers",[],function(){}),define("DS/XCTInfManagers/XCTInfLoaderManager",["UWA/Core","UWA/Class/Model","DS/WebApplicationBase/W3AAManager","DS/XCTInfUtilsWeb/XCTLogger"],function(e,n,o,a){"use strict";return o.extend({init:function(){},postInitialize:function(){this.factory=this._experienceBase.Factory},readString:function(n,o,r){var t;try{t=JSON.parse(n)}catch(n){if(a.error("Invalid JSON"),e.is(r))return void r("Invalid JSON")}this.readJSON(t,o,r)},readJSON:function(n,o,r){e.is(o)?o(n):(a.error("Invalid JSON"),e.is(r)&&r("Invalid JSON"))},readJSONFile:function(n,o,a){var r=this;if(n.name.endsWith(".json")){var t=new FileReader;t.onloadend=function(e){r.readString(e.target.result,o,a)},t.readAsText(n)}else e.error("File must be a JSON")},read3DXContentCSI:function(e,n,o){o("Loading experience currently not supported")},read3DXContent:function(e,n,o){a.log(e,n,o),o("The dependencies to CAT3DExpModelerJavaScript and StudioModelCSIJavaScript had to be removed.")},GetType:function(){return"LoaderManager"}})}),define("DS/XCTInfManagers/XCTInfCommandManager",["UWA/Core","UWA/Class/Promise","DS/CoreEvents/Events","DS/WebApplicationBase/W3AAManager","DS/ApplicationFrame/CommandsManager","DS/XCTInfUtilsWeb/XCTLogger"],function(e,n,o,a,r,t){"use strict";return a.extend({initialize:function(){t.log("Init "+this.GetType()),this._parent()},postInitialize:function(){t.log("Postinit "+this.GetType()),this._parent()},getCommand:function(e,n){return r.getCommands(e)[n]},executeCommand:function(e,n,o){return t.warn("Deprecated. Use XCTInfCommandManager.beginCommand instead."),this.beginAndEndCommand(e,n,o)},disableCommand:function(e,n){this.getCommand(e,n).disable()},enableCommand:function(e,n){this.getCommand(e,n).enable()},enableAllCommands:function(e){var n=r.getCommands(e);Object.values(n).forEach(function(e){e.enable()})},beginCommand:function(n,a,r){r=e.extend({},r,!0);var i=this.getCommand(n,a);return t.log("XCTInfCommandManager.beginCommand",{context:n,commandName:a,command:i,options:r}),i.onEnd&&(this[a+"Token"]=i.onEnd(function(){o.unsubscribe(this[a+"Token"]),delete this[a+"Token"],r&&r.onEnd&&r.onEnd(i)}.bind(this))),i._experienceBase=this._experienceBase,i.appOptions=r,i.begin(),i},beginAndEndCommand:function(e,n,o){var a=this.beginCommand(e,n,o);return a.end(),a},GetType:function(){return"CommandManager"}})}),define("DS/XCTInfManagers/XCTInfDragAndDropManager",["UWA/Core","DS/WebApplicationBase/W3AAManager","DS/DataDragAndDrop/DataDragAndDrop","DS/XCTInfUtilsWeb/XCTLogger"],function(e,n,o,a){"use strict";return n.extend({init:function(){this.dropZones=[]},postInitialize:function(){this.specializationDragRunning=!1,this.specializationDragDropZone=null},register:function(n,r,t){var i=this;n._callbacks={enter:r.enter,leave:r.leave,over:r.over,drop:r.drop,fail:r.fail},n._allowedTypes=r.allowedTypes,n._forbiddenTypes=r.forbiddenTypes,n._owner=t,void 0===i.dropZones&&(i.dropZones=[]),i.dropZones.push(n);var s={enter:function(n,o){var a=i.dropZones.indexOf(n);-1!==a&&e.is(i.dropZones[a]._callbacks.enter)&&(o.origin=i.dragSource,i.dropZones[a]._callbacks.enter.call(i.dropZones[a]._owner,o))},leave:function(n,o){var a=i.dropZones.indexOf(n);-1!==a&&e.is(i.dropZones[a]._callbacks.leave)&&(o.origin=i.dragSource,i.dropZones[a]._callbacks.leave.call(i.dropZones[a]._owner,o))},over:function(n,o){var a=i.dropZones.indexOf(n);-1!==a&&e.is(i.dropZones[a]._callbacks.over)&&(o.origin=i.dragSource,i.dropZones[a]._callbacks.over.call(i.dropZones[a]._owner,o))},drop:function(n,o,r){var t=i.dropZones.indexOf(o);-1!==t&&e.is(i.dropZones[t]._callbacks.drop)&&(r.origin=i.dragSource,i.getFromDataTransfer(r.dataTransfer,function(n){e.is(i.dropZones[t]._callbacks.drop)&&(i.canDrop(n,i.dropZones[t])?i.dropZones[t]._callbacks.drop.call(i.dropZones[t]._owner,r,n):(a.error("cannot drop"),e.is(i.dropZones[t]._callbacks.fail)&&i.dropZones[t]._callbacks.fail.call(i.dropZones[t]._owner,"cannot drop this kind of object")))},function(n){e.is(i.dropZones[t]._callbacks.fail)&&i.dropZones[t]._callbacks.fail.call(i.dropZones[t]._owner,n)})),i.specializationDragRunning&&i.specializationDragDropZone!==o&&i.cancelDrag(i.specializationDragDropZone)}};o.droppable(n,s)},unRegister:function(n){if(e.is(this[n])){o.clean(n);var a=this.dropZones.indexOf(n);this.dropZones.splice(a,1),n._owner=null,n._callbacks=null}},makeDraggable:function(e,n){o.draggable(e,{data:n,start:function(e){this.dragSource=e,e.addClassName("dragged")}.bind(this),stop:function(e){e.removeClassName("dragged"),this.dragSource=void 0}.bind(this)})},canDrop:function(n,o){var a=!0;if(e.is(o._allowedTypes)){a=!1;for(var r=0;r<o._allowedTypes.length;r++)n.isKindOf&&n.isKindOf(o._allowedTypes[r])&&(a=!0)}if(a&&e.is(o._forbiddenTypes))for(var t=0;t<o._forbiddenTypes.length;t++)n.IsKindOf&&n.IsKindOf(o._forbiddenTypes[t])&&(a=!1);return a},cancelDrag:function(e){this.cleanDropZone(e),this.specializationDragRunning=!1,this.specializationDragDropZone=null},getFromFile:function(n,o,r){n.name.endsWith(".json")?this._experienceBase.getManager("LoaderManager").readJSONFile(n,o,r):(a.error("unsuported format "+n.type),e.is(r)&&r("unsuported format "+n.type))},getFromFiles:function(e,n,o){for(var a=0;a<e.length;a++){var r=e[a];this.getFromFile(r,n,o)}},getFromPlainText:function(n,o,r){var t;try{t=JSON.parse(n)}catch(n){if(a.error("Invalid JSON"),e.is(r))return void r()}"3DXContent"===t.protocol?this.getFrom3DXContent(t.version,t.source,t.data,o,r):"STUContent"===t.protocol?this.getFromSTUContent(t.version,t.source,t.data,o,r):(a.error("unknown protocol "+t.protocol),e.is(r)&&r())},getFromDataTransfer:function(e,n,o){this.getFromFiles(e.files,n,o);var a=e.getData("text/plain");a&&this.getFromPlainText(a,n,o)},getFrom3DXContent:function(n,o,a,r,t){for(var i=0;i<a.items.length;i++){var s=a.items[i];if("Stu3DExperience"===s.objectType)this._experienceBase.getManager("LoaderManager").read3DXContentCSI(s.objectId,r);else if("VPMReference"===s.objectType){var d=this._experienceBase.Factory.BuildComponent("Model_VPMReference_Spec");d.QueryInterface("CATI3DExperienceObject").SetValueByName("_varName",s.displayName),d.QueryInterface("CATI3DExperienceObject").SetValueByName("_physID",s.objectId),d.QueryInterface("CATI3DExperienceObject").SetValueByName("_service",s.serviceId),d.QueryInterface("CATI3DExperienceObject").SetValueByName("_objectType",s.objectType),r(d)}else e.is(t)&&t()}},getFromSTUContent:function(n,o,a,r){for(var t=0;t<a.items.length;t++){var i,s=a.items[t],d=s.sessionID;if(i=this._experienceBase.ComponentsMap.GetComponentFromID(d),e.is(i)&&e.is(r))r(i);else{var c=s.inlineContent;this._experienceBase.getManager("LoaderManager").readJSON(c,r)}}},cleanDropZone:function(e){o.clean(e,"drop"),e._evts={}},GetType:function(){return"DragAndDropManager"}})}),define("DS/XCTInfManagers/XCTInfCEFManager",["UWA/Core","DS/WebApplicationBase/W3AAManager","DS/XCTInfUtilsWeb/XCTLogger"],function(e,n,o){"use strict";return n.extend({initialize:function(){o.log("Init "+this.GetType()),this._parent()},postInitialize:function(){o.log("Postinit "+this.GetType()),this._parent(),this.setupInterface()},setupInterface:function(){window.logInConsole=function(e){o.log(e)}},send:function(){window.dscef&&window.dscef.sendString.apply(this,arguments)},GetType:function(){return"CEFManager"}})});