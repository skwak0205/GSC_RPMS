define("DS/WebAppsFoundations/Router",["UWA/Core","UWA/Class","UWA/Class/Events","UWA/Class/Listener","UWA/Class/Options"],function(t,e,i,n,r){"use strict";var s=["routes","History"],o=/\((.*?)\)/g,a=/(\(\?)?:\w+/g,h=/\*\w+/g,u=/[\-{}\[\]+?.,\\\^$|#\s]/g;return e.extend(r,i,n,{init:function(e){var i,n;for(e=t.clone(e||{},!1),n=s.length-1;n>=0;n--)i=s[n],e.hasOwnProperty(i)&&(this[i]=e[i],delete e[i]);this._bindRoutes(),this.setup.apply(this,arguments)},setup:function(){},_routeToRegExp:function(t){return t=t.replace(u,"\\$&").replace(o,"(?:$1)?").replace(a,function(t,e){return e?t:"([^/?]+)"}).replace(h,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return i.map(function(t,e){return e===i.length-1?t||null:t?decodeURIComponent(t):null})},_bindRoutes:function(){var e,i,n,r,s;if(this.routes)for(this.routes=(r="routes",(n=this)&&(s=n[r],t.is(s,"function")&&(s=s.call(n))),s),i=Object.keys(this.routes);null!=(e=i.pop());)this.route(e,this.routes[e])},execute:function(t,e){t&&t.apply(this,e)},navigate:function(t,e){return this.History.navigate(t,e),this},route:function(e,i,n){var r=this;return t.is(e,"regexp")||(e=this._routeToRegExp(e)),t.is(i,"function")&&(n=i,i=""),n||(n=r[i]),r.History.route(e,function(t){var s=r._extractParameters(e,t);r.execute(n,s),r.dispatchEvent.apply(r,["onRoute:"+i].concat(s)),r.dispatchEvent("onRoute",i,s),r.History.dispatchEvent("onRoute",r,i,s)}),r}})}),define("DS/WebAppsFoundations/Views/CollectionView",["DS/WebAppsFoundations/Views/Plugins/Set","UWA/Class/View","UWA/Core"],function(t,e,i){"use strict";return e.extend({_sort:!0,_initVisibleItems:function(){this.visibleItems=[]},_initRenderBuffer:function(){this.elBuffer=document.createDocumentFragment(),this._bufferedChildren=[]},_initChildViewsStorage:function(){var e,i,n;return e=this,i={},n={onAdd:this._onChildViewsAdd,onRemove:this._onChildViewsRemove,onReset:this._onChildViewsReset},this._sort&&(n.onSort=this._onChildViewsSort,i.comparator=function(t){return t===e._emptyView?-1:e.collection.indexOf(t.model)}),this.children=new t(void 0,i),this.listenTo(this.children,n),this},_initialEvents:function(){var t;t={onAdd:this._onCollectionAdd,onRemove:this._onCollectionRemove,onReset:this._onCollectionReset},this.collection&&this.listenTo(this.collection,t)},_toggleElement:function(t,e){return e?t.show():t.hide()},_updateEmptyViewVisibility:function(){var t,e;return t=0===this.visibleItems.length,(e=this._emptyView)&&t!==this._isShowingEmptyView&&(this._isShowingEmptyView=t,this.dispatchEvent("onBeforeToggleEmpty",[e,t]),this._toggleElement(e.container,t),this.dispatchEvent("onToggleEmpty",[e,t])),e},_filterCallback:function(t,e){this._toggleElement(t.container,e)},_filterItemView:function(t){var e,i;return e=t.model,i=!0,void 0!==this._filterer&&("function"==typeof this._filterer&&(i=this._filterer(e)),this._filterCallback(t,i)),this._updateVisibleItems(e,i),i},_updateVisibleItems:function(t,e){var i,n,r;return e===(i=-1!==(r=this.visibleItems.indexOf(t)))?n=!1:(i?this.visibleItems.splice(r,1):this.visibleItems.push(t),n=!0),n},_insertAfter:function(t){this.container.appendChild(t.container)},_insertBefore:function(t,e){var i;return this._sort&&e<this.children.size()-1&&(i=this.children.at(e+1)),!!i&&(this.container.insertBefore(t.container,i.container),!0)},_attachBuffer:function(t){this.container.appendChild(t)},_attachHtml:function(t,e){this.isBuffering?(this.elBuffer.appendChild(t.container),this._bufferedChildren.push(t)):this._insertBefore(t,e)||this._insertAfter(t)},_buildItemView:function(t){var e;return e=this.getItemView(t),this.buildItemView(t,e)},_removeChildView:function(t){this._updateVisibleItems(t.model,!1),t.destroy(),this.isBuffering&&t.container.parentNode===this.elBuffer&&this.elBuffer.removeChild(t.container),this.stopListening(t)},_onCollectionAdd:function(t){var e;e=this._buildItemView(t),this._filterItemView(e),this._updateEmptyViewVisibility(),this.children.add(e)},_onCollectionRemove:function(t){var e;e=this.findChildViewByModel(t),this.children.remove(e)},_onCollectionReset:function(){this.children.reset(this._emptyView?[this._emptyView]:[]),this.render()},_onChildViewsAdd:function(t){t.render(),this._attachHtml(t,this.children.indexOf(t))},_onChildViewsRemove:function(t){this._removeChildView(t),this._updateEmptyViewVisibility()},_onChildViewsReset:function(t,e){var i;i=e.previousItems,this.container.empty(),t.isEmpty()||(this.startBuffering(),t.forEach(function(t,e){-1===i.indexOf(t)&&t.render(),this._attachHtml(t,e)},this),this.endBuffering()),e.previousItems.forEach(function(e){t.contains(e)||this._removeChildView(e)},this),this._updateEmptyViewVisibility()},_onChildViewsSort:function(t,e){e.add||this.render()},init:function(t){return t=i.clone(t||{},!1),["filterer","sort","ItemView","emptyView"].forEach(function(e){t.hasOwnProperty(e)&&(this["_"+e]=t[e])},this),this._initVisibleItems(),this._initChildViewsStorage(),this._initRenderBuffer(),this._parent.apply(this,arguments)},setup:function(){this.addEventOnce("onRender",this._initialEvents)},startBuffering:function(){this._initRenderBuffer(),this.isBuffering=!0},endBuffering:function(){this.isBuffering=!1,this._attachBuffer(this.elBuffer),this._initRenderBuffer()},findChildViewByModel:function(t){return this.children.findWhere({model:t})},getItemView:function(){var t;if(!(t=this._ItemView))throw new Error('A "ItemView" must be specified');return t},buildItemView:function(t,e){return new e({model:t})},render:function(){var t,e;return t=[],this.dispatchEvent("onBeforeRender"),this._emptyView&&t.push(this._emptyView),i.is(this.collection)&&this.collection.forEach(function(i){(e=this.findChildViewByModel(i))||(e=this._buildItemView(i),this._filterItemView(e)),t.push(e)},this),this._updateEmptyViewVisibility(),this.children.reset(t),this.dispatchEvent("onRender"),this},filter:function(t,e){var n;"function"!=typeof t&&null!==t||(this._filterer=t),"function"==typeof e&&(this._filterCallback=e),this.children.isEmpty()||(this.collection.forEach(function(t){n=this.findChildViewByModel(t),i.is(n)&&this._filterItemView(n)},this),this._updateEmptyViewVisibility(),null===this._filterer&&delete this._filterer)},destroy:function(){return this.children.reset(),this.stopListening(),this._parent.apply(this,arguments)}})}),define("DS/WebAppsFoundations/Views/Plugins/Set",["UWA/Core","UWA/Array","UWA/Class","UWA/Controls/Abstract","UWA/Class/Listener","UWA/Class/Events"],function(t,e,i,n,r,s){"use strict";var o={add:!0,remove:!0},a={add:!0,remove:!1};return i.extend(s,r,{init:function(e,i){var n=t.merge({},i);void 0!==n.comparator&&(this.comparator=n.comparator),this._reset(),this._itemListener=function(t,e,i,n){return this._onItemEvent(t,e,i,n)},this.setup(e,n),e&&this.reset(e,t.extend({silent:!0},n))},clone:function(){return new this.constructor(this._items)},setup:function(){},_items:null,_requiredIndexAttr:"cid",_optionalIndexAttr:"id",_index:null,_customKeys:null,comparator:null,length:null,_lookupIterator:function(e){return t.is(e,"function")?e:function(t){return t[e]}},_stackItem:function(t,e,i){if(!t[e])throw new Error('Item has no "'+e+'" property.');return i.push({key:t[e],item:t}),i},add:function(e,i){return this.set(e,t.extend(t.merge({},i),a))},addMap:function(e,i){return this.add(e,t.merge({hashMap:!0},i))},push:function(e,i){return this.add(e,t.merge({at:this.length},i))},unshift:function(e,i){return this.add(e,t.merge({at:0},i))},remove:function(e,i){var n,r,s,o,a,h,u,c,l,f,d,p,m,g=this._index,_=this._customKeys;for(s=t.merge({},i),f=(l=!Array.isArray(e))?[e]:t.clone(e,!1),p=this._requiredIndexAttr,m=this._optionalIndexAttr,a=0,h=f.length;a<h;a++)if(o=f[a]=this.get(f[a])){if(m&&o[m]&&delete g[o[m]],(d=o[p])&&(delete g[d],r=_[d])){for(u=0,c=r.length;u<c;u++)delete g[r[u]];delete _[d]}n=this.indexOf(o),this._items.splice(n,1),this.length--,s.silent||(s.index=n,o.dispatchEvent("onRemove",[o,this,s])),this._removeReference(o)}return l?f[0]:f},pop:function(t){var e;return e=this.at(this.length-1),this.remove(e,t),e},shift:function(t){var e;return e=this.at(0),this.remove(e,t),e},sort:function(e){if(t.is(e)||(e={}),!this.comparator)throw new Error("Cannot sort a set without a comparator");return t.is(this.comparator,"string")||1===this.comparator.length?this._items=this.sortBy(this.comparator,this):this._items.sort(this.comparator.bind(this)),e.silent||this.dispatchEvent("onSort",[this,e]),this},set:function(e,i){var n,r,s,a,h,u,c,l,f,d,p,m,g,_,v,y,w,P,E,A=null,b=null,x=null,V=[],C=e,R={},I=this._customKeys,S=this._index,k=this._items,B=this._requiredIndexAttr,U=this._optionalIndexAttr;if(c=t.merge(t.merge({},i),o),"object"===(w=t.typeOf(e))&&!0!==c.hashMap&&(e=[e],w="array"),"array"===w)for(d=0,p=e.length;d<p;d++)A=e[d],this._stackItem(A,B,V);else if("object"===w&&!0===c.hashMap)for(x in e)e.hasOwnProperty(x)&&(A=e[x],this._stackItem(A,B,V),R[A[B]]=x);for(n=c.at,r=this.comparator&&!t.is(n)&&!1!==c.sort,s=[],a=[],h={},u=c.add,l=c.remove,f=!(r||!u||!l)&&[],d=0,p=V.length;d<p;d++)m=V[d].key,A=V[d].item,(g=this.get(m))?l&&(h[g[B]]=!0):u&&A&&(s.push(A),A.addEvent("onAnyEvent",this._itemListener,this),S[m]=A,(P=R[E=A[B]])&&(S[P]=A,I[E]?I[E].push(P):I[E]=[P]),U&&t.is(A[U])&&(S[A[U]]=A)),f&&(g||A)&&f.push(g||A);if(l){for(d=0,p=this.length;d<p;++d)h[(A=k[d])[B]]||a.push(A);a.length&&this.remove(a,c)}if(s.length||f&&f.length)if(r&&(b=!0),this.length+=s.length,t.is(n))for(v=0,y=s.length;v<y;v++)k.splice(n+v,0,s[v]);else for(f&&(k.length=0),v=0,y=(_=f||s).length;v<y;v++)k.push(_[v]);if(b&&this.sort({silent:!0}),!c.silent){for(d=0,p=s.length;d<p;d++)(A=s[d]).dispatchEvent("onAdd",[A,this,c]);(b||f&&f.length)&&this.dispatchEvent("onSort",[this,c])}return e=C},reset:function(e,i){var n,r,s,o,a;for(a=t.merge({},i),r=0,s=(o=this._items).length;r<s;r++)n=o[r],this._removeReference(n);return a.previousItems=this._items,this._reset(),e=this.add(e,t.extend({silent:!0},a)),a.silent||this.dispatchEvent("onReset",[this,a]),e},get:function(e){if(t.is(e))return this._index[e[this._optionalIndexAttr]]||this._index[e[this._requiredIndexAttr]]||this._index[e]},at:function(t){return this._items[t]},first:function(e){return t.is(e)?this._items.slice(0,e):this._items[0]},last:function(e){return t.is(e)?this._items.slice(Math.max(this._items.length-e,0)):this._items[this._items.length-1]},toArray:function(){return this.slice()},slice:function(t,e){return this._items.slice(t,e)},rest:function(e){return this._items.slice(t.is(e)?e:1)},initial:function(e){return this._items.slice(0,this._items.length-(t.is(e)?e:1))},without:function(){var t;return t=Array.prototype.concat.apply(Array.prototype,Array.prototype.slice.call(arguments)),this._items.filter(function(e){return-1===t.indexOf(e)})},indexOf:function(t,e){return this._items.indexOf(t,e)},lastIndexOf:function(t,e){return this._items.lastIndexOf(t,e)},contains:function(t){return-1!==this.indexOf(t)},size:function(){return this._items.length},isEmpty:function(){return 0===this._items.length},pluck:function(t){return this._items.map(function(e){return e[t]})},shuffle:function(){var t,e;return e=[],this.forEach(function(i,n){t=Math.floor(Math.random()*(n+1)),e[n]=e[t],e[t]=i}),e},where:function(e,i){return t.is(e)?this[i?"find":"filter"](function(t){var i=null;for(i in e)if(e[i]!==t[i])return!1;return!0}):i?void 0:[]},findWhere:function(t){return this.where(t,!0)},invoke:function(){return e.invoke.apply(null,[this._items].concat([].slice.apply(arguments)))},forEach:function(t,e){return this._items.forEach(t,e)},map:function(t,e){return this._items.map(t,e)},every:function(t,e){return this._items.every(t,e)},some:function(t,e){return this._items.some(t,e)},sortBy:function(t,e){var i,n;return i=this._lookupIterator(t),(n=this._items.map(function(t,n,r){return{item:t,index:n,criteria:i.call(e,t,n,r)}})).sort(function(t,e){var i,n;if((i=t.criteria)!==(n=e.criteria)){if(i>n||void 0===i)return 1;if(i<n||void 0===n)return-1}return t.index<e.index?-1:1}),n.map(function(t){return t.item})},groupBy:function(e,i){var n,r,s=this._items;return n=this._lookupIterator(e),r={},this.forEach(function(e,o){var a=n.call(i,e,o,s);t.owns(r,a)||(r[a]=[]),r[a].push(e)}),r},countBy:function(e,i){var n,r,s=this._items;return n=this._lookupIterator(e),r={},this.forEach(function(e,o){var a=n.call(i,e,o,s);t.owns(r,a)||(r[a]=0),r[a]++}),r},find:function(t,e){var i=null;return this.some(function(n,r,s){if(t.call(e,n,r,s))return i=n,!0}),i},filter:function(t,e){return this._items.filter(t,e)},reject:function(t,e){return this.filter(function(e,i,n){return!t(e,i,n)},e)},reduce:function(t,e,i){var n=t;return i&&(n=n.bind(i)),arguments.length>1?this._items.reduce(n,e):this._items.reduce(n)},reduceRight:function(t,e,i){var n=t;return i&&(n=n.bind(i)),arguments.length>1?this._items.reduceRight(n,e):this._items.reduceRight(n)},max:function(t,e){var i,n;if(t&&!this.isEmpty())return n=this._lookupIterator(t),i={computed:-1/0,item:void 0},this.forEach(function(t,r,s){var o;if((o=n.call(e,t,r,s))>=i.computed)return i={item:t,computed:o}}),i.item},min:function(t,e){var i,n;if(t&&!this.isEmpty())return n=this._lookupIterator(t),i={computed:1/0,item:void 0},this.forEach(function(t,r,s){var o;if((o=n.call(e,t,r,s))<i.computed)return i={item:t,computed:o}}),i.item},_reset:function(){return this.length=0,this._items=[],this._index={},this._customKeys={},this._index},_removeReference:function(t){return this===t.set&&delete t.set,t.removeEvent("onAnyEvent",this._itemListener,this)},_onItemEvent:function(t,e,i,n){if("onAdd"!==t&&"onRemove"!==t||i===this)return"onDestroy"===t&&this.remove(e,n),this.dispatchEvent(t,[e,i,n])}})}),define("DS/WebAppsFoundations/Collections/PageableCollection",["UWA/Class/Collection","UWA/Class/Options","UWA/Core"],function(t,e,i){"use strict";var n=/[\s'"]/g,r=/[<>\s'"]/g,s=function(t,e){if("number"!==i.typeOf(t)||isNaN(t)||!isFinite(t)||~~t!==t)throw new TypeError("`"+e+"` must be a finite integer");return t},o=function(t){if(!i.is(t,"object"))return[];var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e},a=function(t){for(var e=o(t),i=e.length,n=new Array(i),r=0;r<i;r++)n[r]=[e[r],t[e[r]]];return n},h=function(t){var e={},i=Array.prototype,n=i.concat.apply(i,i.slice.call(arguments,1));for(var r in t)-1===n.indexOf(r)&&(e[r]=t[r]);return e},u=function(t,e){if(null!=t){var n=t[e];return i.is(n,"function")?n.call(t):n}},c=t.extend(e,{defaultOptions:{stateParseMode:"response",state:{firstPage:1,lastPage:null,currentPage:1,pageSize:25,totalPages:null,totalRecords:null,sortKey:null,order:-1},queryParams:{currentPage:"page",pageSize:"per_page",totalPages:"total_pages",totalRecords:"total_entries",sortKey:"sort_by",order:"order",directions:{"-1":"asc",1:"desc"}}},init:function(t,e){this.setOptions(e);var n=this.state=i.clone(this.options.state);this.queryParams=i.clone(this.options.queryParams),this.links={};n.currentPage=null==n.currentPage?n.firstPage:n.currentPage,this._checkState(this.state),this.initState=i.clone(this.state),this._parent(t,e)},_computeTotalPages:function(t,e){return Math.ceil(t/e)},_checkState:function(t){var e=t.totalRecords,i=t.pageSize,n=t.currentPage,r=t.firstPage,o=t.totalPages;if(null!=e&&null!=i&&null!=n&&null!=r){if(e=s(e,"totalRecords"),i=s(i,"pageSize"),n=s(n,"currentPage"),r=s(r,"firstPage"),i<1)throw new RangeError("`pageSize` must be >= 1");if(o=t.totalPages=this._computeTotalPages(e,i),r<0||r>1)throw new RangeError("`firstPage must be 0 or 1`");if(t.lastPage=0===r?Math.max(0,o-1):o||r,n<r||o>0&&(r?n>o:n>=o))throw new RangeError("`currentPage` must be firstPage <= currentPage "+(r?"<=":"<")+" totalPages if "+r+"-based. Got "+n+".")}return t},hasPreviousPage:function(){var t=this.state;return t.currentPage>t.firstPage},hasNextPage:function(){var t=this.state;return t.currentPage<t.lastPage},getFirstPage:function(t){return this.getPage("first",t)},getPreviousPage:function(t){return this.getPage("prev",t)},getNextPage:function(t){return this.getPage("next",t)},getLastPage:function(t){return this.getPage("last",t)},getPage:function(t,e){var n=this.state,r=n.currentPage,o=n.firstPage,a=n.lastPage,h=t;switch(e=e||{},t){case"first":h=o;break;case"prev":h=r-1;break;case"next":h=r+1;break;case"last":h=a;break;default:h=s(t,"index")}return this.state=this._checkState(i.extend(n,{currentPage:h})),e.from=r,e.to=h,this.fetch(e)},getPageByOffset:function(t,e){var i;if(t<0)throw new RangeError("`offset must be > 0`");return t=s(t),i=Math.floor(t/this.state.pageSize),0!==this.state.firstPage&&i++,i>this.state.lastPage&&(i=this.state.lastPage),this.getPage(i,e)},parse:function(t,e){var n;return(n=this.parseState(t,i.clone(this.options.queryParams),i.clone(this.state),e))&&(this.state=this._checkState(i.extend(this.state,n))),this.parseRecords(t,e)},parseState:function(t,e,i,n){var r=null;switch(n&&(n.stateParseMode||this.options.stateParseMode)){case"headers":r=this.parseHeadersForStateUpdate(t,e,i,n);break;case"response":r=this.parseResponseForStateUpdate(t,e,i,n);break;default:throw new Error("parseState function must the response for state updates, either in the headers or in the response.")}return r},parseResponseForStateUpdate:function(t,e,n,r){if(t&&2===t.length&&i.is(t[0],"object")&&i.is(t[1],"array")){var s=i.clone(n),o=t[0];if(a(h(e,"directions")).forEach(function(t){var e=t[0],i=t[1],n=o[i];UWA.is(n)&&(s[e]=o[i])}),o.order)for(var u in e.directions)if(e.directions[u]===o.order){s.order=u;break}return s}throw new Error("Server data structure does not match the expected one. Please override the function.")},parseHeadersForStateUpdate:function(t,e,n,r){var s,o,a,u=this.links;if(r.request){var c=this.parseLinks(t,r);for(var l in c.first&&(u[this.state.firstPage]=c.first),c.prev&&(u[currentPage-1]=c.prev),c.next&&(u[currentPage+1]=c.next),c.last&&(u[this.state.totalPages]=c.last),i.is(r.request.getAllResponseHeaders,"function")?(s=r.request.getAllResponseHeaders().split("\n")).pop():s=r.responseHeaders?r.responseHeaders:{},s=h(s,c))s.hasOwnProperty(l)&&2===(o=l.split(":")).length&&(a=o[0],-1!==n.indexOf(a)&&(n[a]=o[1]));return{}}},parseRecords:function(t){return t&&2===t.length&&i.is(t[0],"object")&&Array.isArray(t[1])?t[1]:t},parseLinks:function(t,e){var s,o={},a=null;return i.is(e.request.getResponseHeader,"function")?a=e.request.getResponseHeader("Link"):e.responseHeaders&&(a=e.responseHeaders.Link),a&&(s=["first","prev","next","last"],a.split(",").forEach(function(t){var e=t.split(";"),i=e[0].replace(r,"");e.slice(1).forEach(function(t){var e=t.split("="),r=e[0].replace(n,""),a=e[1].replace(n,"");"rel"===r&&_contains(s,a)&&(o[a]=i)})})),o},fetch:function(t){var e,n,r,s=this._checkState(this.state),c={};if((t=t||{}).url||(t.url=this.links[s.currentPage]),e=t.data||{},!UWA.is(e,"object")&&UWA.is(e,"string")&&!i.Json.isJson(e))throw new Error("options.data must be an object or a valid Json string");i.Json.isJson(e)&&(e=i.Json.decode(e)),-1!==(r=(n=u(t,"url")||u(this,"url")||"").indexOf("?"))&&(i.extend(e,function(t){for(var e,i,n,r,s={},o=decodeURIComponent,a=t.split("&"),h=0,u=a.length;h<u;h++)i=o(i=(e=a[h].split("="))[0]),n=o(n=e[1]||!0),r=s[i],Array.isArray(r)?r.push(n):s[i]=r?[r,n]:n;return s}(n.slice(r+1))),n=n.slice(0,r)),t.url=n,t.data=e,c=h(function(t){var e={},i=Array.prototype;return i.concat.apply(i,i.slice.call(arguments,1)).forEach(function(i){i in t&&(e[i]=t[i])}),e}(this.queryParams,o(l.defaultOptions.queryParams)),"directions");var f,d,p,m,g=a(c);for(f=0;f<g.length;f++)p=(d=g[f])[0],m=d[1],m=i.is(m,"function")?m.call(this):m,null!=s[p]&&null!=m&&(e[m]=s[p]);s.sortKey&&s.order?e[i.is(c.order,"function")?c.order.call(this):c.order]=this.queryParams.directions[s.order+""]:s.sortKey||delete e[c.order];var _=a(h(this.queryParams,o(l.defaultOptions.queryParams)));for(f=0;f<_.length;f++)m=(d=_[f])[1],null!=(m=i.is(m,"function")?m.call(this):m)&&(e[d[0]]=m);t.method&&"POST"===t.method&&(t.data=i.Json.encode(e)),this._parent(t)},setPageSize:function(t,e){t=s(t,"pageSize"),e=e||{first:!1};var n=this.state,r=this._computeTotalPages(n.totalRecords,t),o=r?Math.max(n.firstPage,Math.floor(r*n.currentPage/n.totalPages)):n.firstPage;return n=this.state=this._checkState(i.extend(n,{pageSize:t,currentPage:e.first?n.firstPage:o,totalPages:r})),this.getPage(n.currentPage,h(e,["first"]))}}),l=c.prototype;return c}),define("DS/WebAppsFoundations/AbstractHistory",["UWA/Core","UWA/Class","UWA/Class/Events","UWA/Class/Listener","UWA/String"],function(t,e,i,n){"use strict";var r;return r=/^\/+|\/+$/g,e.extend(i,n,{started:!1,init:function(){return this.handlers=[],this},_loadUrl:function(t){return t=this.fragment=this.getFragment(t),this.handlers.some(function(e){if(e.route.test(t))return e.callback(t),!0})},getFragment:function(t){return void 0===t&&(t=""),t.replace(r,"")},route:function(t,e){this.handlers.unshift({route:t,callback:e})},navigate:function(t,e){return!!this.started&&(e&&!0!==e||(e={trigger:!!e}),t=this.getFragment(t||""),this.fragment!==t?(this.fragment=t,e.trigger?this._loadUrl(t):void 0):void 0)},start:function(t){if(t=t||{},this.started)throw new Error("History has already been started");this.root=t.root||"/",this.root=("/"+this.root+"/").replace(r,"/"),this.started=!0,t.silent||this._loadUrl()},stop:function(){this.started=!1}})});