define("DS/DELPPWOperations3DViewerModule/ScopeMfgItemSelectionUI",["UWA/Core"],function(e){"use strict";return function(t,n,i){var o,s,a,l,r=1,c=2,d=n.getComponent("Element"),u=n.getComponent("Accordeon"),f=n.getComponent("Button"),g=n.getComponent("ComboBox"),m=n.getComponent("TooltipModel"),I=null,p=null,v=null;return o=function(o){var s,a,l;s=function(n){switch(n){case r:return function(){p.close()};case c:return function(){var t=v.rootField,n=v.occField,i=v.scopedMfgItemField;e.is(o,"function")&&e.is(t)&&e.is(n)&&e.is(i)&&o(t.value,n.value,i.value),p.close()};default:t.log("wrong option")}},a={No:new f({label:i.getNLSValue("ScopeMfgItemSelectionUI.Close.Title"),onClick:s(r)}),Yes:new f({disabled:!1,label:i.getNLSValue("ScopeMfgItemSelectionUI.Load.Title"),onClick:s(c)})},e.is(n)?(l={title:i.getNLSValue("ScopeMfgItemSelectionUI.Dialog.Title"),domId:"ScopeMfgItemSelectionUI-dialog",content:I,resizableFlag:!0,modalFlag:!1,minWidth:290,width:400,buttons:a,visibleFlag:!1},(p=n.create("Dialog",l)).close=function(){e.is(I)&&I.destroy(),this.destroy(),p=null,v=null}):t.debug("uxFactoryBehavior is not available.")},s=function(t){var n,i;return n=new e.Element("div",{class:"accordeon-section-container"}),i=new d("div",{class:"section-container"}),n.inject(I),new u({items:[{header:t,content:i,expandedFlag:!0}],style:"filled-separate"}).inject(n),i.addEvent("resize",function(){var t,n,o;o=i.getElements(".wux-field-container"),i.clientWidth<290?(t="inline-container",n="block-container"):(t="block-container",n="inline-container"),e.is(o)&&o.forEach(function(e){e.removeClassName(t),e.addClassName(n)})}),i},a=function(t,n){t.forEach(function(t){var i,o;i=new e.Element("div",{class:"wux-field-container inline-container"}),new e.Element("h6",{class:"wux-textElement",text:t.label}).inject(i).tooltipInfos=new m({shortHelp:t.label}),o=new g({elementsList:t.elementsList,actionOnClickFlag:!1,enableSearchFlag:!1,value:t.value,disabled:t.disabled}),e.is(t.onChange,"function")&&o.addEventListener("change",t.onChange.bind(null,v)),v[t.name]=o,o.inject(i),i.inject(n)})},l=function(t){var n,o,l,r,c,d={},u={};Array.isArray(t)&&t.length>0&&(l={name:"rootField",label:i.getNLSValue("ScopeMfgItemSelectionUI.Field.Root.Title"),elementsList:[],disabled:!0,onChange:function(t){var n,i,o,s,a,l,r;n=t.rootField,o=t.occField,l=t.scopedMfgItemField,e.is(n)&&e.is(o)&&e.is(l)&&(i=n.value,e.is(d[i])&&(a=(s=d[i])[0].valueItem,o.setProperties({elementsList:s,value:a}),e.is(u[a])&&(r=u[a],l.setProperties({elementsList:r,value:r[0].valueItem}))))}},r={name:"occField",label:i.getNLSValue("ScopeMfgItemSelectionUI.Field.Occurence.Title"),elementsList:[],disabled:!0,onChange:function(t){var n,i,o,s;n=t.occField,o=t.scopedMfgItemField,e.is(n)&&e.is(o)&&(i=n.value,e.is(u[i])&&(s=u[i],o.setProperties({elementsList:s,value:s[0].valueItem})))}},c={name:"scopedMfgItemField",label:i.getNLSValue("ScopeMfgItemSelectionUI.Field.ScopedMfgItem.Title"),elementsList:[],disabled:!0},t.forEach(function(e){var t=[];e.occurences.forEach(function(e){var n=[];t.push({labelItem:e.label,valueItem:e.pid}),e.scopedMfgItems.forEach(function(e){n.push({labelItem:e.label,valueItem:e.pid})}),u[e.pid]=n}),d[e.pid]=t}),o=t[0],l.disabled=!1,l.value=o.pid,l.elementsList=t.map(function(e){return{labelItem:e.label,valueItem:e.pid}}),e.is(d[l.value])&&(r.disabled=!1,r.elementsList=d[l.value],r.value=r.elementsList[0].valueItem,e.is(u[r.value])&&(c.disabled=!1,c.elementsList=u[r.value],c.value=c.elementsList[0].valueItem)),v=[],n=s(i.getNLSValue("ScopeMfgItemSelectionUI.Section.Process.Title")),a([l,r],n),n=s(i.getNLSValue("ScopeMfgItemSelectionUI.Section.MfgItems.Title")),a([c],n))},{createDialog:function(t){!e.is(p)&&e.is(t)&&e.is(t.data)&&e.is(t.onSelectCallback)&&(I=new d("div",{class:"ScopeMfgItemSelectionUI-Container"}),o(t.onSelectCallback),l(t.data),p.show())},isActive:function(){return!!e.is(p)&&p.visibleFlag},destroyUI:function(){e.is(p)&&p.close()}}}}),define("DS/DELPPWOperations3DViewerModule/Viewer3DModule",["UWA/Core"],function(){"use strict";return{behaviors:["RoutingsViewer3DBehavior","SelectionBehavior","LinkBehavior","ImplementBehavior","ProductAbsPathHelperBehavior"],creator:function(){return{name:"Viewer3DModule",onStart:function(e,t){t()},onStop:function(){}}}}}),define("DS/DELPPWOperations3DViewerModule/Operations3DViewerModule",["UWA/Core","DS/TransientWidget/TransientWidget","DS/DELPPWOperations3DViewerModule/ScopeMfgItemSelectionUI"],function(e,t,n){"use strict";return{behaviors:["InterWidgetComBehavior","UXFactoryBehavior","ResourceBehavior","ModelBehavior","RootsBehavior","LinkBehavior","ImplementBehavior","CapableResourceLinkBehaviour","SelectionBehavior","ExpandFilterBehavior"],creator:function(i,o,s,a,l,r,c,d,u,f,g){var m,I,p,v,h,S,P,D,E,b,L,R,M,y,C,O,w,A,F,k,V,T,W,N,x,U,B,j,_,H,K,Y,z,X="Operations3DViewerModule_Preferences";return v=function(){return i.getPreferenceValue(X)},h=function(e,t){var n={loadedObjInfos:{sysPID:e,scopeMfgItemPID:t}};widget.setValue(X,n)},S=function(){p=v(),widget.setValue(X)},P=function(t){var n,i,o=t.absPath,s=[],a=o[o.length-1],r=e.is(a)?a:t.nodeId,d=null,u=l.getReference(r);if(e.is(u)||(i=l.getInstance(a),u=l.getReferenceModelFromInstance(i),d=i.id,r=u.id),e.is(r))switch(l.getPPRType(u)){case"OPERATION":case"SYSTEM":c.getConnectedObjects(e.is(d)?d:r,o,{relationTypes:["ProcessImplementLink","ProcessImplementLinkOcc"]}).forEach(function(e){var t=l.transformToRIROccurrencePath(e);s.push(t)});break;case"PROCESS":n=l.transformToRIROccurrencePath(o.length>0?o:r),s.push(n)}return s},D=function(t){var n,i,s,a=!1;return o.isWidgetLinked("DELOER_AP")&&(i=v(),e.is(i)&&(s=i.loadedObjInfos,e.is(s.sysPID)&&(t===s.sysPID?a=!0:(n=l.getReference(t),l.isAKindOf(n,"DELLmiHeaderWorkPlanReference")&&l.getInstancesFromCollection(t).forEach(function(e){l.getReferenceModelFromInstance(e).get("PID")===s.sysPID&&(a=!0)}))))),a},E=function(t){var n,i,s,a=!1;return o.isWidgetLinked("DELOER_AP")&&(i=v(),!e.is(i)&&e.is(p)&&(s=p.loadedObjInfos,e.is(s.sysPID)&&(t===s.sysPID?a=!0:(n=l.getReference(t),l.isAKindOf(n,"DELLmiHeaderWorkPlanReference")&&l.getInstancesFromCollection(t).forEach(function(e){l.getReferenceModelFromInstance(e).get("PID")===s.sysPID&&(a=!0)}))))),a},b=function(t,n){var i=[];return Array.isArray(t)&&t.length>0&&t.forEach(function(t){var o,s,a,r,d=[];s=l.getReference(t),l.isAKindOf(s,"DELLmiHeaderWorkPlanReference")?((e.is(n)?n:l.getInstancesFromCollection(t)).forEach(function(e){var t,n,i=[];n=(t=l.getReferenceModelFromInstance(e)).get("PID"),(a=c.getConnectedObjects(n,null,{relationTypes:["ProcessImplementLink"]})).length>0&&(a.forEach(function(e){var t=l.getReference(e);i.push({pid:e,label:t.get("V_Name")})}),d.push({pid:n,label:t.get("V_Name"),scopedMfgItems:i}))}),d.length>0&&(o={pid:t,label:s.get("V_Name"),occurences:d})):(a=c.getConnectedObjects(t,null,{relationTypes:["ProcessImplementLink"]})).length>0&&(r=[],a.forEach(function(e){var t=l.getReference(e);r.push({pid:e,label:t.get("V_Name")})}),o={pid:t,label:s.get("V_Name"),occurences:[{pid:t,label:s.get("V_Name"),scopedMfgItems:r}]}),e.is(o)&&i.push(o)}),i},L=function(t){var o,l,r;if(t.length>0){if(1===t.length&&(l=t[0],e.is(l.occurences)&&1===l.occurences.length&&(r=l.occurences[0],e.is(r.scopedMfgItems)&&1===r.scopedMfgItems.length)))return o=r.scopedMfgItems[0].pid,void M(r.pid,o);(I=new n(i,s,a)).createDialog({data:t,onSelectCallback:function(t,n,i){e.is(t)&&e.is(n)&&e.is(i)&&M(n,i)}})}},R=function(t,n){e.is(t)&&o.publishEvent("DS/DELExternalWidgetCom/"+t,n)},M=function(t,n){var i,o,s;o=l.getReferenceModel(t),e.is(o)&&"SYSTEM"===l.getPPRType(o)&&(h(t,n),i={items:[{id:t,with2DStructure:!1,scopedMfg:{id:n}}]},(s=g.getFilterProxy()).hasFilter(n).hasFilter&&(i.items[0].scopedMfg.withFilter=!0,i.items[0].scopedMfg.biProxyCtx=s.getCtxForSharing()),R("Remove2DStructure"),R("LoadData",i))},y=function(t){var n=l.getReferenceModel(t);e.is(n)&&"PROCESS"===l.getPPRType(n)&&(S(),R("RemoveRoot"))},C=function(){R("RemoveAll")},O=function(e){var t,n,i;o.isWidgetLinked("DELOER_AP")&&(i=(t=e.changed.isSelected)?"Select":"UnSelect",(n=P(e.changed)).length>0&&R(i,{path:n,highlight:t}))},w=function(){C()},A=function(e){var t;(e=Array.isArray(e)?e:e.impactedChildren).some(function(e){return E(e)})&&(t=p.loadedObjInfos,c.getConnectedObjects(t.sysPID,null,{relationTypes:["ProcessImplementLink"]}).indexOf(t.scopeMfgItemPID)>-1&&M(t.sysPID,t.scopeMfgItemPID))},F=function(){var e,t;t=r.getRoots()[0],e=b(t),setTimeout(function(){L(e)},10)},k=function(){e.is(I)&&I.isActive()&&I.destroyUI(),S()},V=function(){o.isWidgetLinked("DELOER_AP")?i.warn(a.getNLSValue("Operations3DViewerModule.OpViewerIsAlreadyAvilable")):t.showWidget("DELOER_AP",{})},T=function(e){var t;o.isWidgetLinked("DELOER_AP")&&(e=Array.isArray(e)?e:[e],t=[],e.forEach(function(e){var n;n=l.getReferenceModelFromInstance(e),"PROCESS"===l.getPPRType(n)&&t.push([e.get("isAggregatedBy"),e.get("PID"),e.get("isInstanceOf")])}),t.length>0&&R("Hide",{path:t}))},W=function(t){var n,i,s,a;o.isWidgetLinked("DELOER_AP")&&(n=v(),e.is(n)&&(i=n.loadedObjInfos,s=i.sysPID,a=i.scopeMfgItemPID,e.is(s)&&e.is(a)&&(t=Array.isArray(t)?t:[t]).forEach(function(e){"ProcessImplementLink"===e.get("type")&&e.get("from")===s&&e.get("to")===a&&C()})))},N=function(t){var n,i;i=v(),e.is(i)||(n=b([t]),L(n))},x=function(t){var n,i;n=v(),e.is(n)&&t.some(function(e){return D(e.get("PID"))})&&(i=n.loadedObjInfos,y(i.scopeMfgItemPID))},U=function(){var e;r.getRoots()[0].some(function(e){return D(e)})?(e=v().loadedObjInfos,c.getConnectedObjects(e.sysPID,null,{relationTypes:["ProcessImplementLink"]}).indexOf(e.scopeMfgItemPID)>-1?M(e.sysPID,e.scopeMfgItemPID):S()):S()},B=function(){S()},_=function(t){var n,o,s,a,r,c,d,u=!1,f=!0;R("Remove2DStructure"),e.is(t)&&e.is(t.items)&&e.is(t.items.length>0)&&"PROCESS"===(o=t.items[0]).pprType&&(c=o.id,d=o.scopedMfg.id,u=!0),u?(n=v(),e.is(n)&&(n=n.loadedObjInfos).sysPID===c&&n.scopeMfgItemPID===d&&(f=!1),f&&(a=function(){s=l.getReferenceModel(c),i.notify("addReference",[s]),h(c,d)},r=function(){},s=l.getReferenceModel(c),e.is(s)?a():l.getDescendantsFromServer([c],a,{onFailure:r,silentMode:!0}))):S()},j=function(){S()},H=function(t){var n,o,s;n=this.isSelected?"selectNodes":"unSelectNodes",e.is(t.path)&&(o=t.path,s=[],o.forEach(function(e){var t=e.filter(function(e,t){var n=!1;return t%2!=0&&"PROCESS"===l.getPPRType(e)&&(n=!0),n});s.push(t)}),i.notify(n,[s]))},K=function(e){var t,n;o.isWidgetLinked("DELOER_AP")&&(n=e.isVisible?"Show":"Hide",(t=P(e)).length>0&&R(n,{path:t}))},Y=function(t){var n,i,s,a,r,c,d;o.isWidgetLinked("DELOER_AP")&&((a=t.absPath).length>0?(r=a[0],c=l.getInstance(r),d=l.getAggregatingReferenceModelFromInstance(c)):d=l.getReference(t.nodeId),"SYSTEM"===l.getPPRType(d)&&(i=[d.get("PID")],e.is(c)&&l.isAKindOf(d,"DELLmiHeaderWorkPlanReference")&&(s=[c]),n=b(i,s),L(n)))},z=function(e){var t;o.isWidgetLinked("DELOER_AP")&&(t=P(e)).length>0&&R("Reframe",{path:t})},{listenTo:function(){return{select:O,addRootNode:N,hideRootNode:x,onRecentContentLoaded:U,ResetRootsStore:B,refreshAll:w,onRefreshedAll:A,refreshImpacted:A,HideAll:w,removeInstance:T,removeConnection:W,Show3DViewerCmd:V,change3DVisibility:K,LoadIn3DViewer:Y,ReframeIn3DViewer:z}},onStart:function(t,n){m=e.extend(m,t),o.addEventListener("link",F),o.addEventListener("unlink",k),o.subscribeEvent("DS/DELExternalWidgetCom/onSelect",H.bind({isSelected:!0})),o.subscribeEvent("DS/DELExternalWidgetCom/onUnSelect",H.bind({isSelected:!1})),o.subscribeEvent("DS/DELExternalWidgetCom/onLoadDataComplete",_),o.subscribeEvent("DS/DELExternalWidgetCom/onHome",j),n()},onStop:function(){}}}}});