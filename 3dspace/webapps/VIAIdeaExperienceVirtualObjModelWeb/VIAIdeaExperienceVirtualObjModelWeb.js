define("DS/VIAIdeaExperienceVirtualObjModelWeb/extensions/VIAEIxpLinearPath",["UWA/Core","DS/Visualization/ThreeJS_DS","DS/MathematicsES/MathsDef"],function(t,e,i){"use strict";return t.Class.extend({init:function(t){this._pathExtension=t},GetLength:function(){var t=[];this._pathExtension.GetDefinePoints(t);var e=0;if(t.length<2)return e;for(var i=0;i<t.length-1;i++)e+=this._getSubSectionLength(t[i],t[i+1]);return e},_getSubSectionLength:function(t,i){var n=t.QueryInterface("CATI3DExperienceObject").GetValueByName("position"),r=i.QueryInterface("CATI3DExperienceObject").GetValueByName("position");return new e.Vector3(r[0]-n[0],r[1]-n[1],r[2]-n[2]).length()},GetValue:function(e,n,r){if(e>1||e<0)t.log("VIAEIxpVirtualPath.GetValue ERROR : iCurvParam not in the range[0,1] !");else{var a=[];if(this._pathExtension.GetDefinePoints(a),!(a.length<2)){for(var o=e*this._pathExtension.GetLength(),s=0,h=0,c=0;s+c<=o&&h<a.length-1;)s+=c,c=this._getSubSectionLength(a[h],a[h+1]),h++;var u=a[h-1].QueryInterface("CATI3DExperienceObject").GetValueByName("position"),l=a[h].QueryInterface("CATI3DExperienceObject").GetValueByName("position"),p=(o-s)/c,_=new i.Vector3D(u[0]+(l[0]-u[0])*p,u[1]+(l[1]-u[1])*p,u[2]+(l[2]-u[2])*p),I=new i.Transformation;if(t.is(n)){this._pathExtension.QueryInterface("CATIMovable").GetAbsPosition(I);var f=new i.Transformation;n.QueryInterface("CATIMovable").GetAbsPosition(f),I=new i.Transformation.multiply(I,f.getInverse())}else this._pathExtension.QueryInterface("CATIMovable").GetAbsPosition(I);_.applyMatrix3x3(I.matrix),_.addVectorToVector(I.vector),r.x=_.x,r.y=_.y,r.z=_.z}}}})}),define("DS/VIAIdeaExperienceVirtualObjModelWeb/extensions/VIAEIxpCubicSubSectionPath",["UWA/Core"],function(t){"use strict";return t.Class.extend({init:function(t,e,i,n){this._Pt1=t,this._Pt2=e,this._Tgt1=i,this._Tgt2=n,this._approximationNbSamplePt=20,this._length=0,this._l=[],this._updateData()},getLength:function(){return this._length},getValueFromLengthRatio:function(t){var e=this._getParametrizationFromLengthRatio(t);return this._Pt1.clone().multiplyScalar(1-3*Math.pow(e,2)+2*Math.pow(e,3)).addVectorToVector(this._Pt2.clone().multiplyScalar(3*Math.pow(e,2)-2*Math.pow(e,3))).addVectorToVector(this._Tgt1.clone().multiplyScalar(e-2*Math.pow(e,2)+Math.pow(e,3))).addVectorToVector(this._Tgt2.clone().multiplyScalar(Math.pow(e,3)-Math.pow(e,2)))},_getParametrizationFromLengthRatio:function(t){var e=-1,i=t*this._length;if(this._l.length>=this._approximationNbSamplePt){var n=0;for(i>=this._l[this._approximationNbSamplePt/2]&&(n=this._approximationNbSamplePt/2);i>=this._l[n]&&n<this._approximationNbSamplePt-1;)n++;n--;var r=this._l[n+1]-this._l[n];if(0!==r){var a=(i-this._l[n])/r;this._P1&&this._P2&&this._P3&&this._P4&&n>=0&&n<this._approximationNbSamplePt-1&&(e=this._P1[n]*Math.pow(a,3)+this._P2[n]*Math.pow(a,2)+this._P3[n]*a+this._P4[n])}}return e},_updateData:function(){var t=this._approximationNbSamplePt-1;this._P1=this._initArray(t),this._P2=this._initArray(t),this._P3=this._initArray(t),this._P4=this._initArray(t);for(var e=2*this._Pt1.x+this._Tgt1.x-2*this._Pt2.x+this._Tgt2.x,i=-3*this._Pt1.x-2*this._Tgt1.x+3*this._Pt2.x-this._Tgt2.x,n=this._Tgt1.x,r=2*this._Pt1.y+this._Tgt1.y-2*this._Pt2.y+this._Tgt2.y,a=-3*this._Pt1.y-2*this._Tgt1.y+3*this._Pt2.y-this._Tgt2.y,o=this._Tgt1.y,s=2*this._Pt1.z+this._Tgt1.z-2*this._Pt2.z+this._Tgt2.z,h=-3*this._Pt1.z-2*this._Tgt1.z+3*this._Pt2.z-this._Tgt2.z,c=this._Tgt1.z,u=9*(Math.pow(e,2)+Math.pow(r,2)+Math.pow(s,2)),l=12*(e*i+r*a+s*h),p=6*(e*n+r*o+s*c)+4*(Math.pow(i,2)+Math.pow(a,2)+Math.pow(h,2)),_=4*(i*n+a*o+h*c),I=Math.pow(n,2)+Math.pow(o,2)+Math.pow(c,2),f=1/(this._approximationNbSamplePt-1),m=this._initArray(this._approximationNbSamplePt),x=this._initArray(this._approximationNbSamplePt),y=this._initArray(this._approximationNbSamplePt),g=0;g<this._approximationNbSamplePt;g++){var V=g*f;m[g]=V,x[g]=0,y[g]=0;var b=u*Math.pow(V,4)+l*Math.pow(V,3)+p*Math.pow(V,2)+_*V+I;if(b>=0&&(x[g]=Math.sqrt(b),0!==x[g]&&(y[g]=(4*u*Math.pow(V,3)+3*l*Math.pow(V,2)+2*p*V+_)/(2*x[g]))),0===g)this._l.push(0);else{var P=f*((f*(y[g]+y[g-1])+2*(x[g-1]-x[g]))/4+(3*(x[g]-x[g-1])-f*(2*y[g-1]+y[g]))/3+y[g-1]*f/2+x[g-1]),A=this._l[this._l.length-1];this._l.push(A+P),0!==x[g-1]&&0!==x[g]&&(this._P1[g-1]=2*m[g-1]+P/x[g-1]-2*m[g]+1/x[g]*P,this._P2[g-1]=-3*m[g-1]-P/x[g-1]*2+3*m[g]-P/x[g],this._P3[g-1]=P/x[g-1],this._P4[g-1]=m[g-1])}}this._length=this._l[this._approximationNbSamplePt-1]},_initArray:function(t){for(var e=[],i=0;i<t;i++)e.push(0);return e}})}),define("DS/VIAIdeaExperienceVirtualObjModelWeb/interfaces/VIAIIxpVirtualPath",["UWA/Class","DS/WebComponentModeler/CATWebInterface"],function(t,e){"use strict";return e.singleton({interfaceName:"VIAIIxpVirtualPath",required:{AddPoint:function(){},RemovePoint:function(){},InsertPoint:function(){},GetDefinePoints:function(){},GetPointAtIndex:function(){},GetNumberOfPoint:function(){},GetLength:function(){},GetValue:function(){}},optional:{Discretize:function(){},SetInterpolationMode:function(){},GetInterpolationMode:function(){}}})}),define("DS/VIAIdeaExperienceVirtualObjModelWeb/extensions/VIAEIxpCubicPath",["UWA/Core","DS/Visualization/ThreeJS_DS","DS/MathematicsES/MathsDef","DS/VIAIdeaExperienceVirtualObjModelWeb/extensions/VIAEIxpCubicSubSectionPath"],function(t,e,i,n){"use strict";return t.Class.extend({init:function(t){this._pathExtension=t,this._subSections={}},GetLength:function(){var t=[];this._pathExtension.GetDefinePoints(t);var e=0;if(t.length<2)return e;for(var i=0;i<t.length-1;i++)e+=this._getSubSection(t[i],t[i+1]).getLength();return e},_getSubSection:function(t,e){var r=t.GetID()+e.GetID();return this._subSections[r]||(this._subSections[r]=new n((new i.Vector3D).setFromArray(t.QueryInterface("CATI3DExperienceObject").GetValueByName("position")),(new i.Vector3D).setFromArray(e.QueryInterface("CATI3DExperienceObject").GetValueByName("position")),this._getTangentFromPoint("RIGHT",t),this._getTangentFromPoint("LEFT",e))),this._subSections[r]},GetValue:function(e,n,r){if(e>1||e<0)t.log("VIAEIxpVirtualPath.GetValue ERROR : iCurvParam not in the range[0,1] !");else{var a=[];if(this._pathExtension.GetDefinePoints(a),!(a.length<2)){var o,s=e*this.GetLength(),h=0,c=0,u=0;do{h+=u=(o=this._getSubSection(a[c],a[c+1])).getLength(),c++}while(h<=s&&c<a.length-1);var l=o.getValueFromLengthRatio((s-h+u)/u),p=new i.Transformation;if(t.is(n)){this._pathExtension.QueryInterface("CATIMovable").GetAbsPosition(p);var _=new i.Transformation;n.QueryInterface("CATIMovable").GetAbsPosition(_),p=new i.Transformation.multiply(p,_.getInverse())}else this._pathExtension.QueryInterface("CATIMovable").GetAbsPosition(p);l.applyMatrix3x3(p.matrix),l.addVectorToVector(p.vector),r.x=l.x,r.y=l.y,r.z=l.z}}},_getTangentFromPoint:function(t,e){var n=new i.Vector3D;return this._pathExtension.QueryInterface("CATI3DExperienceObject").GetValueByName("reversedDirection")?"RIGHT"===t?n.setFromArray(e.QueryInterface("CATI3DExperienceObject").GetValueByName("leftTangent")):"LEFT"===t&&n.setFromArray(e.QueryInterface("CATI3DExperienceObject").GetValueByName("rightTangent")):"RIGHT"===t?n.setFromArray(e.QueryInterface("CATI3DExperienceObject").GetValueByName("rightTangent")):"LEFT"===t&&n.setFromArray(e.QueryInterface("CATI3DExperienceObject").GetValueByName("leftTangent")),n.norm()<1e-10&&(n=this._computeDefaultTangent(e)),n},_computeDefaultTangent:function(t){var e,n,r,a,o=this._pathExtension.QueryInterface("CATI3DExperienceObject").GetValueByName("reversedDirection"),s=t.QueryInterface("CATI3DExperienceObject").GetValueByName("index"),h=o?this._pathExtension.GetNumberOfPoint()-s+1:s,c=[];if(this._pathExtension.GetDefinePoints(c),1===h){a=2;do{void 0!==c[a-1]&&(e=(new i.Vector3D).setFromArray(c[a-1].QueryInterface("CATI3DExperienceObject").GetValueByName("position")),n=(new i.Vector3D).setFromArray(c[h-1].QueryInterface("CATI3DExperienceObject").GetValueByName("position")),r=e.subVectorFromVector(n)),a++}while(0===r.norm()&&a<=c.length())}else if(h===c.length){a=c.length-1;do{void 0!==c[a-1]&&(e=(new i.Vector3D).setFromArray(c[h-1].QueryInterface("CATI3DExperienceObject").GetValueByName("position")),n=(new i.Vector3D).setFromArray(c[a-1].QueryInterface("CATI3DExperienceObject").GetValueByName("position")),r=e.subVectorFromVector(n)),a--}while(0===r.norm()&&a>=1)}else{var u=h-1,l=h+1;do{void 0!==c[l-1]&&(e=(new i.Vector3D).setFromArray(c[l-1].QueryInterface("CATI3DExperienceObject").GetValueByName("position")),n=(new i.Vector3D).setFromArray(c[u-1].QueryInterface("CATI3DExperienceObject").GetValueByName("position")),r=e.subVectorFromVector(n)),l++}while(0===r.norm()&&l<=c.length())}return r.multiplyScalar(.5)}})}),define("DS/VIAIdeaExperienceVirtualObjModelWeb/extensions/VIAEIxpVirtualPath",["UWA/Core","DS/Visualization/ThreeJS_DS","DS/MathematicsES/MathsDef","DS/VIAIdeaExperienceVirtualObjModelWeb/extensions/VIAEIxpLinearPath","DS/VIAIdeaExperienceVirtualObjModelWeb/extensions/VIAEIxpCubicPath"],function(t,e,i,n,r){"use strict";return t.Class.extend({_getLinearImpl:function(){return this._linearImpl||(this._linearImpl=new n(this)),this._linearImpl},_getCubicImpl:function(){return this._cubicImpl||(this._cubicImpl=new r(this)),this._cubicImpl},AddPoint:function(){console.error("Not Implemented")},RemovePoint:function(){console.error("Not Implemented")},InsertPoint:function(){console.error("Not Implemented")},GetDefinePoints:function(e){if(Array.isArray(e)){e.length=0;for(var i=this.QueryInterface("CATI3DExperienceObject").GetValueByName("pointslist"),n=0;n<i.length;n++)e.push(i[n])}else t.log("VIAEIxpVirtualPath.GetDefinePoints ERROR : unable to fill parameters, not an array !")},GetPointAtIndex:function(t){return this.QueryInterface("CATI3DExperienceObject").GetValueByName("pointslist")[t]},GetNumberOfPoint:function(){return this.QueryInterface("CATI3DExperienceObject").GetValueByName("pointslist").length},GetLength:function(){return 0===this.QueryInterface("CATI3DExperienceObject").GetValueByName("interpolationType")?this._getLinearImpl().GetLength():this._getCubicImpl().GetLength()},GetValue:function(t,e,i){return 0===this.QueryInterface("CATI3DExperienceObject").GetValueByName("interpolationType")?this._getLinearImpl().GetValue(t,e,i):this._getCubicImpl().GetValue(t,e,i)}})});