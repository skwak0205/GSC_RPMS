define("DS/XAppLandingPage/XAppLandingPageCoreImpl",["UWA/Core","UWA/Promise","DS/RuntimeView/NLSManager","DS/RuntimeView/RSCManager","DS/WebappsUtils/WebappsUtils","DS/WebUAUtils/WebUAUtils","DS/XAppUXComponents/XAppDragAndDropManager"],function(e,t,i,n,s,o,a){"use strict";var r=function(e){this.options=e,this._dragAndDropManager=new a,this._isHomeVisible=!1,this._isWaitingVisible=!1,this._waitingParams=void 0;var t={fullscreenEnabled:0,fullscreenElement:1,fullscreenchange:2},i=["webkitFullscreenEnabled","webkitFullscreenElement","webkitfullscreenchange"],n=["mozFullScreenEnabled","mozFullScreenElement","mozfullscreenchange"],s=["msFullscreenEnabled","msFullscreenElement","MSFullscreenChange"],o=i[0]in document&&i||n[0]in document&&n||s[0]in document&&s||"fullscreenEnabled"in document&&Object.keys(t)||[];this.fscreen={addEventListener:function(e,i,n){return document.addEventListener(o[t[e]],i,n)},fullscreenEnabled:function(){return Boolean(document[o[t.fullscreenEnabled]])},fullscreenElement:function(){return document[o[t.fullscreenElement]]}}};const p="Home",l="Waiting";return r.prototype.setOptions=function(e){if(this.options=e,this._dragAndDropManager){this._dragAndDropManager.clean();let e=this.buildDDOptions(this.options);this._dragAndDropManager.initalize(e)}this.optionsChanged=!0},r.prototype.buildDDOptions=function(e){return{appId:e.appId,callbacks:{onDrop:e.onDrop,onDragEnter:e.onDragEnter,onDragLeave:e.onDragLeave,onDragOver:e.onDragOver},dragAndDrop:e.dragAndDrop,icons:{dragAndDrop:this.getMedia("DragDrop","FontIcon"),forbidden:this.getMedia("Forbidden","FontIcon")},overlayContainer:e.overlayContainer?e.overlayContainer:this._mainContainer,viewer:e.body}},r.prototype.displayHome=function(){var e;return this._displayHomePromise?e=this._displayHomePromise:!0===(!0!==this._isHomeVisible||!0===this.optionsChanged)?(e=new t(function(e){this.displayType=p,this.resources={},this.internFiles={rsc:"XAppLandingPage/XAppHomePage"};var t=this.loadJsonResources(["i18n!DS/XAppLandingPage/assets/nls/XAppHomePage.json","text!DS/XAppLandingPage/assets/rsc/XAppHomePage.json"]),i=this.loadResource(this.options.nls,!0),n=this.loadResource(this.internFiles.rsc,!1),s=this.loadResource(this.options.rsc,!1);t.then(function(){i.then(function(t){n.then(function(){s.then(function(i){this.nlsResource=t,this.rscResource=i,this.displayType===p&&this.createHomepage().then(function(){if(this._dragAndDropManager){this._dragAndDropManager.clean();let e=this.buildDDOptions(this.options);this._dragAndDropManager.initalize(e)}this._isHomeVisible=!0,this._displayHomePromise=null,e()}.bind(this))}.bind(this))}.bind(this))}.bind(this))}.bind(this))}.bind(this)),this._displayHomePromise=e):e=t.resolve(),this.optionsChanged=!1,e},r.prototype.displayWaiting=function(e){var i;return this._displayWaitingPromise?(!1===this.haveSameValues(e,this._waitingParams)&&(this._waitingParams=e),i=this._displayWaitingPromise):!0===(!0!==this._isWaitingVisible||(!0===this.optionsChanged||!1===this.haveSameValues(e,this._waitingParams)))?(i=new t(function(t){this._waitingParams=e,this.displayType=l,this.resources={};var i=this.loadJsonResources(["i18n!DS/XAppLandingPage/assets/nls/XAppWaitingPage.json"]),n=this.loadResource(this.options.rsc,!1);i.then(function(){n.then(function(e){this.rscResource=e,this.displayType===l&&this.createWaitingPage(this._waitingParams).then(function(){this._isWaitingVisible=!0,this._displayWaitingPromise=null,t()}.bind(this))}.bind(this))}.bind(this))}.bind(this)),this._displayWaitingPromise=i):i=t.resolve(),this.optionsChanged=!1,i},r.prototype.isHomeVisible=function(){return this._isHomeVisible},r.prototype.isWaitingVisible=function(){return this._isWaitingVisible},r.prototype.insertDataView=function(){},r.prototype.removeDataView=function(){},r.prototype.clean=function(){this.displayType=null,this.internFiles=null,this.nlsResource=null,this.rscResource=null,this._displayHomePromise=null,this._displayWaitingPromise=null,this._isHomeVisible=!1,this._isWaitingVisible=!1,this._waitingParams=void 0,this.optionsChanged=!1,this.options.body.empty()},r.prototype.loadResource=function(e,s){return new t(function(t){if(e){var o=s?i:n;o&&(o.onResourceLoaded({resourceFile:e},function(){t(this)}),o.loadResource({resourceFile:e,resourceConverter:null}))}else t()})},r.prototype.loadJsonResources=function(i){return new t(function(t){if(this.options.nlsJson&&(i=i.concat(this.options.nlsJson)),this.options.rscJson&&(i=i.concat(this.options.rscJson)),i&&Array.isArray(i)){var n=function(s){s<i.length?require([i[s]],function(t){"object"!=typeof t&&(t=JSON.parse(t)),this.resources=e.extend(e.clone(this.resources),t),n(s+1)}.bind(this)):t()}.bind(this);n(0)}}.bind(this))},r.prototype.getText=function(e,t){var i="";if(t){var n=t.split("/");n&&Array.isArray(n)&&2===n.length&&this.nlsResource&&(this.nlsResource._resourceKey=t,i=this.nlsResource.getKey({key:n[1]+"."+e}))}else this.resources&&(i=this.resources[e]);return i},r.prototype.getMedia=function(e,t,i,n){var a,r,p;if(this.options.widget?p=this.options.widget.lang:window.widget&&(p=window.widget.lang),n){var l=n.split("/");if(l&&Array.isArray(l)&&2===l.length&&this.rscResource)if(this.rscResource._resourceKey=n,t&&"string"==typeof t)a=this.rscResource.getKey({key:l[1]+"."+e+"."+t+"."+i}),"Image"===t?r=s.getWebappsBaseUrl()+a:"Video"===t&&(r=o.getEmbeddedHelpFullPath(a,p));else if(a=this.rscResource.getKey({key:l[1]+"."+e})){var c={};for(var h in a)if(a.hasOwnProperty(h))for(var g in c[h]={},a[h])a[h].hasOwnProperty(g)&&("Image"===h?c[h][g]=s.getWebappsBaseUrl()+a[h][g]:"Video"===h&&(c[h][g]=o.getEmbeddedHelpFullPath(a[h][g],p)));r=c}}else this.resources&&t&&"string"==typeof t&&(r="FontIcon"===t||"Url"===t?this.resources[e+"."+t]:"Image"===t?{images:this.resources[e+"."+t],baseUrl:s.getWebappsBaseUrl()}:"WebHelp"===t?o.getHelpFullPath(this.resources[e+"."+t],p):"EmbeddedWebHelp"===t?o.getEmbeddedHelpFullPath(this.resources[e+"."+t],p):this.resources[e+"."+t]);return r},r.prototype.haveSameValues=function(e,t){var i=!0;if(typeof e!=typeof t)i=!1;else if(Array.isArray(e)){if(e.length!==t.length)i=!1;else for(var n=0;n<e.length;n++)if(!1===this.haveSameValues(e[n],t[n])){i=!1;break}}else if(e instanceof Object){for(var s in e)if(e.hasOwnProperty(s)&&!1===this.haveSameValues(e[s],t[s])){i=!1;break}}else e!==t&&(i=!1);return i},r}),define("DS/XAppLandingPage/XAppLandingPageCore",["UWA/Promise"],function(e){"use strict";var t=function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];return this.impl?this.impl[t].apply(this.impl,i):function(){var t;return this._implPromise?t=this._implPromise:(t=new e(function(e){require(["DS/XAppLandingPage/XAppLandingPageCoreImpl"+(this._options.version?this._options.version:"V3")],function(t){this.impl=new t(this._options),e(this.impl)}.bind(this))}.bind(this)),this._implPromise=t),t}.call(this).then(function(e){return e[t].apply(e,i)})},i=function(e){this._options=e,this._implPromise=null,this.impl=null};Object.defineProperty(i,"dndOverlayTypes",{value:{forbidden:"Forbidden",overItems:"OverItems",overFullPage:"OverFullPage"},writable:!1});return Object.defineProperty(i,"waitingTypes",{value:{create:"Create",open:"Open",recover:"Recover",restore:"Restore",progress:"Progress"},writable:!1}),i.prototype.setOptions=function(e){this._options=e,t.call(this,"setOptions",e)},i.prototype.displayHome=function(){return t.call(this,"displayHome")},i.prototype.displayItemSubMenu=function(e){t.call(this,"displayItemSubMenu",e)},i.prototype.displayWaiting=function(e){return t.call(this,"displayWaiting",e)},i.prototype.updateProgressWaiting=function(e){t.call(this,"updateProgressWaiting",e)},i.prototype.getProgressWaitingRate=function(){return t.call(this,"getProgressWaitingRate")},i.prototype.isHomeVisible=function(){return t.call(this,"isHomeVisible")},i.prototype.isWaitingVisible=function(){return t.call(this,"isWaitingVisible")},i.prototype.insertDataView=function(e){t.call(this,"insertDataView",e)},i.prototype.removeDataView=function(e){t.call(this,"removeDataView",e)},i.prototype.closeDialog=function(){t.call(this,"closeDialog")},i.prototype.clean=function(){t.call(this,"clean")},i}),define("DS/XAppLandingPage/XAppSessionDataComponent",["DS/PlatformAPI/PlatformAPI","DS/XAppServices/XAppEventsServices","DS/CoreEvents/Events","DS/i3DXCompassServices/i3DXCompassPubSub"],function(e,t,i,n){"use strict";var s=widget.uwaUrl?widget.id:"",o="xappWidgetData_"+s,a="xappWidgetLang_"+s;let r=function(e){return"_"+e.substring(0,1).toLowerCase()+e.substring(1)},p=function(e,t,i){e[t]=i,e.storeDataOnWidget()};var l=function(){this._productName="",this._documentID="",this._contextID="",this._firstAppID="",this._mainPoolName="",this._isPreviouslyConnected=void 0,this._isAutoLoadingStopped=void 0,this._isDocumentNew=void 0};return l.prototype.initialize=function(){this.initializeDataOnWidget();var e=this.getExecutionContext(),n=e?e.getComponent(WAfrStandardComponentKey.ModelEvents):null;n&&(n.subscribe({event:"X3D/SaveDocumentSuccess"},this.onSave.bind(this,!0)),i.subscribe({event:"SWXSaveProduct"},this.onSave.bind(this,!1)),n.subscribe({event:"X3D/NewDocumentSuccess"},this.onDocumentLoaded.bind(this,!0)),n.subscribe({event:"X3D/OpenDocumentSuccess"},this.onDocumentLoaded.bind(this,!1)),n.subscribe({event:t.events.SpecTree_Rename_Success},this.onProductRenamed.bind(this)),n.subscribe({event:"XApp/CloseSuccess"},this.onCloseInSession.bind(this)),n.subscribe({event:"X3D/NewDocumentFailure"},this.deleteDocumentDataFromWidget.bind(this)),n.subscribe({event:"X3D/OpenDocumentFailure"},this.deleteDocumentDataFromWidget.bind(this)),n.subscribe({event:"XApp/CloseFailure"},this.deleteDocumentDataFromWidget.bind(this)))},l.prototype.clean=function(){},l.prototype.destroy=function(){},l.prototype.prefixDataName=function(t){if(widget.uwaUrl){var i=widget.uwaUrl?e.getUser().login:"local";t=s+"/"+this.getStoredValue("x3dPlatformId")+"/"+i+"/"+t}else t="XAppLocal/"+t;return t},l.prototype.storeDataOnWidget=function(){let e,t;const i=["ProductName","DocumentID","ContextID","FirstAppID","MainPoolName"];for(e=0;e<i.length;++e)this[t=r(i[e])]&&this.setStoredValue(this.prefixDataName(i[e]),this[t]);const n=["IsPreviouslyConnected","IsAutoLoadingStopped","IsDocumentNew"];for(e=0;e<n.length;++e)"boolean"==typeof this[t=r(n[e])]&&this.setStoredValue(this.prefixDataName(n[e]),this[t])},l.prototype.getStoredDataOnWidget=function(){const t=["ContextID","FirstAppID","MainPoolName","IsPreviouslyConnected","IsAutoLoadingStopped","IsDocumentNew"],i=["ProductName","DocumentID"],n=t.concat(i);let s,o={},a=0;for(a=0;a<n.length;++a)o[s=n[a]]=this.getStoredValue(this.prefixDataName(s));for(a=0;a<t.length;++a)o[s=t[a]]||(o[s]=this.getStoredValue(s));const r=widget.uwaUrl?e.getUser().login:"";for(a=0;a<i.length;++a)o[s=i[a]]||(o[s]=this.getStoredValue(r+"/"+s));return o},l.prototype.onDocumentLoaded=function(e,t){if(t&&"function"==typeof t.readString){var i=JSON.parse(t.readString("result_output"));this.storeDocumentID(i?i.physical_id:void 0)}this._isDocumentNew=e,e||this.storeDataInMRUData(),this.publishProduct()},l.prototype.onProductRenamed=function(e){e&&!0===e.isRootNode&&this.storeProductName(e.name)},l.prototype.onCloseInSession=function(){this.deleteDocumentDataFromWidget()},l.prototype.onSave=function(e){this._isDocumentNew=!1,e&&(this.storeDataOnWidget(),this.storeDataInMRUData()),this.publishProduct()},l.prototype.deleteDocumentDataFromWidget=function(){this.deleteStoredValue(this.prefixDataName("ProductName")),this.deleteStoredValue(this.prefixDataName("DocumentID")),this.deleteStoredValue(this.prefixDataName("IsDocumentNew")),this._productName="",this._documentID="",this._isDocumentNew=void 0},l.prototype.storeDocumentID=function(e){p(this,"_documentID",e)},l.prototype.getDocumentID=function(){return this._documentID},l.prototype.storeProductName=function(e){p(this,"_productName",e)},l.prototype.getProductName=function(){return this._productName},l.prototype.storeContextID=function(e){p(this,"_contextID",e)},l.prototype.storeFirstAppID=function(e){p(this,"_appID",e)},l.prototype.storeMainPoolName=function(e){p(this,"_mainPoolName",e)},l.prototype.storeIsPreviouslyConnected=function(e){p(this,"_isPreviouslyConnected",e)},l.prototype.storeIsAutoLoadingStopped=function(e){p(this,"_isAutoLoadingStopped",e)},l.prototype.getIsDocumentNew=function(){return this._isDocumentNew},l.prototype.storeIsDocumentNew=function(e){p(this,"_isDocumentNew",e)},l.prototype.initializeDataOnWidget=function(){var e=JSON.parse(localStorage.getItem(o));if(e){const t=["ProductName","DocumentID","ContextID","FirstAppID","MainPoolName","IsPreviouslyConnected","IsDocumentNew"];let i,n;for(i=0;i<t.length;++i)this[n=r(t[i])]=e[t];this.storeDataOnWidget(),localStorage.removeItem(o)}var t=localStorage.getItem(a);t&&t!==widget.lang&&this.deleteDocumentDataFromWidget(),widget.lang&&localStorage.setItem(a,widget.lang)},l.prototype.storeDataOnLocalStorage=function(){var e=this.getStoredDataOnWidget();localStorage.setItem(o,JSON.stringify(e))},l.prototype.storeDataInMRUData=function(){let e=this.getExecutionContext();if(e){let t=e.getComponent("SpecTreeComponent");if(t&&"function"==typeof t.getObjectSubTypeInUIActiveObjectPath){let i=t.getObjectSubTypeInUIActiveObjectPath(["VPMOccurrence"],["VPMRepOccurrence"]),n=i?i.TreeNode:null,s=i&&i.data?i.data:{};if(n&&s&&"string"==typeof s.refPhysicalId&&""!==s.refPhysicalId){let t=e.getComponent("AFR_HandlerComponent");t&&t.executeHandler({id:"XAppMRUDataUpdateAction",args:{pid:s.refPhysicalId,name:n.getCurrentName()}}).then(function(){},function(){})}}}},l.prototype.publishProduct=function(){let e=this.getExecutionContext();if(e){var t=e.getComponent("SpecTreeComponent");if(t&&"function"==typeof t.getObjectSubTypeInUIActiveObjectPath){let e=t.getObjectSubTypeInUIActiveObjectPath(["VPMOccurrence"]),i=e&&e.data?e.data:{};if(i&&"string"==typeof i.refPhysicalId&&""!==i.refPhysicalId){let e={objectId:i.refPhysicalId,objectType:i.refType,envId:this.getStoredValue("x3dPlatformId")};n.publish("setObject",e)}}}},l.prototype.getStoredValue=function(e){if(widget.uwaUrl)return widget.getValue(e);{let t=sessionStorage.getItem(e);if(t){let e=t.toLowerCase();"true"!==e&&"false"!==e||(t="true"===e)}return t}},l.prototype.setStoredValue=function(e,t){return widget.uwaUrl?widget.setValue(e,t):("boolean"==typeof t&&(t=t.toString()),sessionStorage.setItem(e,t))},l.prototype.deleteStoredValue=function(e){return widget.uwaUrl?widget.deleteValue(e):sessionStorage.removeItem(e)},l}),define("DS/XAppLandingPage/XAppLandingPage",["UWA/Element","UWA/Promise","DS/XAppLandingPage/XAppLandingPageCore","DS/XAppServices/XAppTrackers","css!DS/XAppLandingPage/assets/css/XAppLandingPage.css"],function(e,t,i,n){"use strict";var s,o=function(e){s=e,this.options=e,this.homePageContainer=null,this.waitingPageContainer=null,this.homePageCore=null,this.waitingPageCore=null,this._waitingPageStartTime=null,this._waitingPageParams=null;Object.defineProperty(this,"dndOverlayTypes",{value:{forbidden:"Forbidden",overItems:"OverItems",overFullPage:"OverFullPage"},writable:!1});Object.defineProperty(this,"waitingTypes",{value:{create:"Create",open:"Open",recover:"Recover",restore:"Restore",progress:"Progress"},writable:!1})};return o.prototype.initialize=function(){this.options=s},o.prototype.clean=function(){this.isHomeVisible()&&this.homePageCore&&this.homePageCore.closeDialog(),this.isWaitingVisible()&&this.waitingPageCore&&this.waitingPageCore.closeDialog()},o.prototype.destroy=function(){this.isHomeVisible()&&this.cleanHome(),this.isWaitingVisible()&&this.cleanWaiting()},o.prototype.displayHome=function(n){var s=this.getExecutionContext(),o=s.getComponent(WAfrStandardComponentKey.UIFrame);null===this.homePageContainer&&(this.homePageContainer=new e("div",{class:"homepage-container"})),this.homePageContainer.inject(o.getUIFrame());var a=[],r=n||this.options.items,p={executionContext:s,body:this.homePageContainer,version:this.options.version,appInfo:this.options.appInfo,appSwitchAction:this.options.appSwitchAction,itemsTooltip:this.options.itemsTooltip,items:a,dragAndDrop:this.options.dragAndDrop,onDrop:this.onDrop.bind(this),onDragEnter:this.onDragEnter.bind(this),appLinks:this.options.appLinks,nlsJson:this.options.nlsJson,rscJson:this.options.rscJson,nls:this.options.nls,rsc:this.options.rsc,events:{appSwitchClick:this._onAppSwitchClick.bind(this),appOverviewClick:this._onAppOverviewClick.bind(this),actionButtonClick:this._onActionButtonClick.bind(this),linkClick:this._onLinkClick.bind(this)}};if(r&&Array.isArray(r)){var l,c=function(e){return e.name===l};r.forEach(function(e){var t;if(n){l=e;var i=this.options.items.filter(c);t=i.length>0?i[0]:e}else t=e;t&&a.push({name:t.name,onClick:function(){if(this.homePageCore&&!t.doNotDeactivateDD){let e=Object.assign({},p);e.dragAndDrop=!1,this.homePageCore.setOptions(e)}let e=function(){this.homePageCore&&this.isHomeVisible()&&!t.doNotDeactivateDD&&this.homePageCore.setOptions(p)}.bind(this);var i=this.executeAction(t.onClick,this.homePageContainer,null,null,e);!0===t.subMenu&&i.then(function(e){this.homePageCore&&this.homePageCore.displayItemSubMenu(e.itemSubMenu)}.bind(this))}.bind(this),onDrop:this.executeAction.bind(this,t.onDrop,this.homePageContainer),subMenu:t.subMenu})}.bind(this))}return this.homePageCore?this.homePageCore.setOptions(p):this.homePageCore=new i(p),new t(function(e){this.homePageCore.displayHome().then(function(){var t=s.getComponent(WAfrStandardComponentKey.ModelEvents);t&&t.publish({event:"XApp/HomePageDisplayed"}),e(this.homePageContainer)}.bind(this))}.bind(this))},o.prototype.displayWaiting=function(s){this._waitingPageStartTime=Date.now(),this._waitingPageParams=s;var o=this.getExecutionContext(),a=o.getComponent(WAfrStandardComponentKey.UIFrame);null===this.waitingPageContainer&&(this.waitingPageContainer=new e("div",{class:"waitingpage-container"})),this.waitingPageContainer.inject(a.getUIFrame());var r,p={executionContext:o,body:this.waitingPageContainer,version:this.options.version,rscJson:this.options.rscJson,nls:this.options.nls,rsc:this.options.rsc,dragAndDrop:!1};switch(this.waitingPageCore?this.waitingPageCore.setOptions(p):this.waitingPageCore=new i(p),s.waitingType){case this.waitingTypes.create:r=i.waitingTypes.create;break;case this.waitingTypes.open:r=i.waitingTypes.open;break;case this.waitingTypes.recover:r=i.waitingTypes.recover;break;case this.waitingTypes.restore:r=i.waitingTypes.restore;break;case this.waitingTypes.progress:r=i.waitingTypes.progress}return new t(function(e){var t=o.getComponent("SessionData");t&&t.storeIsAutoLoadingStopped(!1);let i=function(){t&&t.storeIsAutoLoadingStopped(!0),document.body.innerHTML="";var e=this._waitingPageStartTime>0?Math.floor((Date.now()-this._waitingPageStartTime)/1e3):null,i=this.waitingPageCore.getProgressWaitingRate();n.trackModelLoadingCancelled(o,{stepName:this._waitingPageParams.progress.stepName,fromAction:this._waitingPageParams.fromAction,stepIndex:this._waitingPageParams.progress.stepIndex,stepsNb:this._waitingPageParams.progress.stepsNb,ellapsedTimeBeforeCancel:e,progressRate:Math.floor(i)}).then(function(){window.location.reload()})}.bind(this),a=this.options&&this.options.cancellableLoading?i:null;this.waitingPageCore.displayWaiting({waitingType:r,progress:s.progress,modelId:s.modelId,cancelAction:a}).then(function(){var t=o.getComponent(WAfrStandardComponentKey.ModelEvents);t&&t.publish({event:"XApp/WaitingPageDisplayed"}),e(this.waitingPageContainer)}.bind(this))}.bind(this))},o.prototype.onDrop=function(e,t){let i;e.preventDefault();var n=e.dataTransfer.getData("text");if(n)try{i=JSON.parse(n).data.items[0]}catch(e){}let s={dataParam:i,text:n,files:e.dataTransfer.files,items:e.dataTransfer.items,types:e.dataTransfer.types};this.options&&this.options.onDrop&&this.executeAction(this.options.onDrop,this.homePageContainer,e,s);let o=!(!i||!i.objectId);this._analyticsOnDrop(o)},o.prototype.onDragEnter=function(e){return new t(function(n){(function(i){return new t(function(t){i&&"string"==typeof i?this.executeAction(i,e).then(t.bind(null)):t(this.dndOverlayTypes.overFullPage)}.bind(this))}).bind(this)(this.options.onDragEnter).then(function(e){var t;switch(e){case this.dndOverlayTypes.forbidden:t=i.dndOverlayTypes.forbidden;break;case this.dndOverlayTypes.overItems:t=i.dndOverlayTypes.overItems;break;case this.dndOverlayTypes.overFullPage:t=i.dndOverlayTypes.overFullPage}n(t)}.bind(this))}.bind(this))},o.prototype.updateProgressWaiting=function(e){this.waitingPageCore&&(this._waitingPageParams=e,this.waitingPageCore.updateProgressWaiting(e))},o.prototype.isHomeVisible=function(){var e=!1;return this.homePageCore&&(e=this.homePageCore.isHomeVisible()),e},o.prototype.isWaitingVisible=function(){var e=!1;return this.waitingPageCore&&(e=this.waitingPageCore.isWaitingVisible()),e},o.prototype.insertDataView=function(e){this.homePageCore&&this.homePageCore.insertDataView(e)},o.prototype.removeDataView=function(e){this.homePageCore&&this.homePageCore.removeDataView(e)},o.prototype.cleanHome=function(){this.homePageCore&&(this.homePageCore.clean(),this.homePageCore=null),this.homePageContainer&&(this.homePageContainer.destroy(),this.homePageContainer=null)},o.prototype.cleanWaiting=function(){this.waitingPageCore&&(this.waitingPageCore.clean(),this.waitingPageCore=null),this.waitingPageContainer&&(this.waitingPageContainer.destroy(),this.waitingPageContainer=null),this._waitingPageStartTime=null,this._waitingPageParams=null},o.prototype.executeAction=function(e,i,n,s,o){return new t(function(t){if(e&&"string"==typeof e){var a=this.getExecutionContext();if(a){var r=a.getComponent(WAfrStandardComponentKey.HandlerComponent);r&&r.executeHandler({id:e,args:{container:i,event:n,data:s,onCancelCB:o}}).then(t.bind(this))}}else t()}.bind(this))},o.prototype._onAppSwitchClick=function(e){if(this.options.appSwitchAction){var t=this.getExecutionContext();if(t){var i=t.getComponent(WAfrStandardComponentKey.HandlerComponent);i&&i.executeHandler({id:this.options.appSwitchAction,args:{fromLandingPage:!0,button:e}})}}n.trackLandingPageAppSwitchClick(this.getExecutionContext())},o.prototype._onAppOverviewClick=function(){n.trackLandingPageAppOverviewClick(this.getExecutionContext())},o.prototype._onActionButtonClick=function(e){n.trackLandingPageActionButtonClick(this.getExecutionContext(),{buttonName:e})},o.prototype._onLinkClick=function(e){n.trackLandingPageLinkClick(this.getExecutionContext(),{linkName:e})},o.prototype._analyticsOnDrop=function(e){n.trackLandingPageOnDrop(this.getExecutionContext(),{isDropOk:e?"true":"false"})},o}),define("DS/XAppLandingPage/XAppLandingPageCoreImplV3",["DS/Core/PointerEvents","DS/Controls/Button","DS/Controls/ProgressBar","DS/UIKIT/Scroller","DS/UIKIT/SuperModal","DS/UIKIT/Spinner","DS/UIKIT/Tooltip","UWA/Core","UWA/Promise","DS/UIKIT/Carousel","DS/XAppLandingPage/XAppLandingPageCore","DS/XAppLandingPage/XAppLandingPageCoreImpl","DS/XAppServices/XAppTrackers","css!DS/UIKIT/UIKIT","css!DS/XAppLandingPage/assets/css/XAppLandingPageCoreV3"],function(e,t,i,n,s,o,a,r,p,l,c,h,g){"use strict";var d=function(e){h.call(this,e),this._startTimeWaitingPageStep=null,this._totalTimeWaitingPage=0,this._waitingPagefromAction=null};(d.prototype=Object.create(h.prototype)).constructor=d,d.prototype.createHomepage=function(){return new p(function(e){this.createMainContainer("Home");var t=new r.Element("div",{class:"xapp-app-container"});t.inject(this._mainContainer);var i=this.getText("App.Title");if(i&&this.options.appSwitchAction){var n=i.split(" "),s={tag:"span",class:"xapp-appswitch-btn fonticon fonticon-chevron-down",title:this.getText("SwitchAppBtn.Hover"),events:{click:function(e){var t=e.currentTarget;this.options&&this.options.events&&"function"==typeof this.options.events.appSwitchClick&&this.options.events.appSwitchClick(t)}.bind(this)}},o=n.pop();i=[{tag:"span",text:n.join(" ")+" "},{tag:"span",html:[{tag:"span",text:o},s],styles:/iPad|iPhone|iPod/.test(navigator.userAgent)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1?{display:"inline-block"}:{"white-space":"nowrap"}}]}var p=new r.Element("div",{class:"xapp-app-identification",html:[{tag:"div",class:"xapp-app-title font-3dsbold",html:i},{tag:"div",class:"xapp-app-motto",html:this.getText("App.Motto")},!0===this.options.appInfo?{tag:"div",class:"xapp-app-overview",html:[{tag:"span",class:this.getMedia("AppOverview","FontIcon")},{tag:"span",class:"xapp-app-overview-title",html:this.getText("AppOverview.Title")}],events:{click:function(e){e.stopPropagation(),this.createAppOverviewModal(),this.options&&this.options.events&&"function"==typeof this.options.events.appOverviewClick&&this.options.events.appOverviewClick()}.bind(this)}}:void 0]});p.inject(t);var l=[];if(this.options.items&&Array.isArray(this.options.items)){this.options.items.forEach(function(e){var t=function(e){var t=new r.Element("div",{class:"xapp-item-button",html:[{tag:"div",class:this.getMedia(e.name,"FontIcon")},{tag:"div",class:"xapp-item-title",html:this.getText(e.name+".Title")}],events:{click:function(t){this.itemSubMenuContainer&&(this.itemSubMenuContainer.destroy(),this.itemSubMenuContainer=null);var i=t.currentTarget;i&&(this.selectedItemButton!==i&&this.selectedItemButton&&(this.selectedItemButton.removeClassName("xapp-item-button-subMenu"),this.selectedItemButton=null),!0===e.subMenu?i.hasClassName("xapp-item-button-subMenu")?i.removeClassName("xapp-item-button-subMenu"):(this.selectedItemButton=i,i.addClassName("xapp-item-button-subMenu"),e.onClick()):(e.onClick(),this.options&&this.options.events&&"function"==typeof this.options.events.actionButtonClick&&this.options.events.actionButtonClick(e.name)))}.bind(this)}});if(!0===this.options.itemsTooltip){var i=this.getText(e.name+".Description");i&&new a({target:t,position:"right",delay:{show:1e3},body:i})}return t}.call(this,e);l.push(t)}.bind(this))}var c=new r.Element("div",{class:"xapp-app-actions",html:[l,void 0===this.options.dragAndDrop||!0===this.options.dragAndDrop?{tag:"div",class:"xapp-app-drop",html:[{tag:"div",class:"xapp-app-drop-text",html:[{tag:"span",class:this.getMedia("DragDrop","FontIcon")},{tag:"span",html:this.getText("DragDrop.Tip")}]}]}:void 0]});c.inject(t);var h,g=[],d=[];if(this.options.appLinks){var u=function(e,t){return new r.Element("div",{class:"xapp-link-item",html:[{tag:"div",class:this.getMedia(e.name,"FontIcon")},{tag:"div",class:"xapp-link-title",html:{tag:"a",class:"xapp-link-anchor",href:this.getMedia(e.name,t),target:"_blank",rel:"noopener noreferrer",html:this.getText(e.name+".Title"),events:{click:function(){this.options&&this.options.events&&"function"==typeof this.options.events.linkClick&&this.options.events.linkClick(e.name)}.bind(this)}}}]})};!0===this.options.appLinks.UserAssistance&&g.push(u.call(this,{name:"UserAssistance"},"WebHelp")),this.options.appLinks.contentAndKnowledge&&Array.isArray(this.options.appLinks.contentAndKnowledge)&&this.options.appLinks.contentAndKnowledge.forEach(function(e){g.push(u.call(this,e,e.mediaType?e.mediaType:"Url"))}.bind(this)),this.options.appLinks.socialNetworks&&Array.isArray(this.options.appLinks.socialNetworks)&&this.options.appLinks.socialNetworks.forEach(function(e){d.push(u.call(this,e,e.mediaType?e.mediaType:"Url"))}.bind(this))}(g.length>0||d.length>0)&&((h=new r.Element("div",{class:"xapp-app-links",html:[{tag:"div",class:"xapp-link-categories xapp-link-column",html:[g.length>0?{tag:"div",class:"xapp-link-category",html:this.getText("ContentAndKnowledge.Title")}:void 0,d.length>0?{tag:"div",class:"xapp-link-category",html:this.getText("SocialNetworks.Title")}:void 0],colNb:g.length>0&&d.length>0?"2":"1"},{tag:"div",class:"xapp-link-items xapp-link-column",html:[g,d],colNb:1===g.length&&0===d.length||0===g.length&&1===d.length?"1":"2"}]})).inject(t),g.length>0&&d.length>0?d[0].addClassName("xapp-link-column-break"):g.length>1&&0===d.length?g[Math.ceil(g.length/2)].addClassName("xapp-link-column-break"):0===g.length&&d.length>1&&d[Math.ceil(d.length/2)].addClassName("xapp-link-column-break"));var m=function(){var e=function(e,t){var i=0;if(e){!0===t&&(i+=parseFloat(e.getStyle("margin-top").replace("px","")),i+=parseFloat(e.getStyle("margin-bottom").replace("px","")));var n=e.getStyle("box-sizing");"content-box"===n?(i+=parseFloat(e.getStyle("border-top-width").replace("px","")),i+=parseFloat(e.getStyle("padding-top").replace("px","")),i+=parseFloat(e.getStyle("height").replace("px","")),i+=parseFloat(e.getStyle("padding-bottom").replace("px","")),i+=parseFloat(e.getStyle("border-bottom-width").replace("px",""))):"border-box"===n&&(i+=parseFloat(e.getStyle("height").replace("px","")))}return i},i=e(this.options.body,!0),n=parseFloat(t.getStyle("margin-top").replace("px",""));n+=parseFloat(t.getStyle("border-top-width").replace("px","")),n+=parseFloat(t.getStyle("padding-top").replace("px",""));var s=parseFloat(t.getStyle("margin-bottom").replace("px",""));s+=parseFloat(t.getStyle("border-bottom-width").replace("px","")),s+=parseFloat(t.getStyle("padding-bottom").replace("px",""));var o=e(p,!0),a=e(c,!1),r=e(h,!0),l=Math.max(30,i/2-(a/2+o+n)),g=Math.max(30,i/2-(a/2+r+s));c.setStyle("margin-top",(l/10).toString()+"rem"),c.setStyle("margin-bottom",(g/10).toString()+"rem")};m.call(this),window.onresize=function(){m.call(this)}.bind(this),e()}.bind(this))},d.prototype.displayItemSubMenu=function(e){if(HTMLDivElement.prototype.isPrototypeOf(e)){this.itemSubMenuContainer=new r.Element("div",{class:"xapp-itemSubMenu-container"}),this.itemSubMenuContainer.inject(this._mainContainer);var t=new r.Element("div",{class:"modal-header"});if(t.inject(this.itemSubMenuContainer),new r.Element("span",{class:"close fonticon fonticon-cancel",events:{click:function(){this.itemSubMenuContainer&&(this.itemSubMenuContainer.destroy(),this.itemSubMenuContainer=null),this.selectedItemButton&&(this.selectedItemButton.removeClassName("xapp-item-button-subMenu"),this.selectedItemButton=null)}.bind(this)}}).inject(t),e.inject(this.itemSubMenuContainer),window.__karma__){var i=new Event("testSubMenuDisplayed");this._mainContainer.dispatchEvent(i)}}},d.prototype.createWaitingPage=function(e){return new p(function(t){switch(this._waitingPagefromAction=e.fromAction,this.createMainContainer("Waiting","xapp-waiting-background"),e.waitingType){case c.waitingTypes.progress:u.call(this,e);break;case c.waitingTypes.create:case c.waitingTypes.open:case c.waitingTypes.recover:case c.waitingTypes.restore:v.call(this,e)}t()}.bind(this))};var u=function(e){var n=new r.Element("div",{class:"xapp-progress-container"}).inject(this._mainContainer),s=new r.Element("div",{class:"xapp-progress-bar"}).inject(n);if(e&&e.modelId&&s.classList.add("xapp-progress-bar-with-title"),this._progressModelId=new r.Element("div",{class:"xapp-progress-modelId"}).inject(s),this._progressBar=new i({statusFlag:!1}).inject(s),this._progressLabel=new r.Element("div",{class:"xapp-progress-label"}),this._progressStep=new r.Element("div",{class:"xapp-progress-info"}),this._progressStepIndex=new r.Element("div",{class:"xapp-progress-stepIndex"}),this._progressStepsNb=new r.Element("div",{class:"xapp-progress-stepsNb"}),this._progressStepTitle=new r.Element("div",{class:"xapp-progress-info"}),this._progressStepName=new r.Element("div",{class:"xapp-progress-stepName"}),this._progressStepNameIdentifier="",e.cancelAction&&"function"==typeof e.cancelAction){var o=new r.Element("div",{class:"xapp-progress-bar-with-stop"}).inject(s);this._progressLabel.setStyle("margin-top","0.9rem"),this._progressLabel.setStyle("max-height","2.2rem"),this._progressLabel.inject(o);let i=new t({label:this.getText("Cancel"),emphasize:"primary",onClick:function(t){e.cancelAction.call(this),t.stopPropagation()}.bind(this)}).inject(o);i.elements.container.classList.add("xapp-progress-bar-stop"),i.getContent().setAttribute("data-rec-id","Cancel_Loading_Button"),this._progressLabel.classList.add("xapp-progress-label-with-stop")}else this._progressLabel.inject(n);this.updateProgressWaiting(e)};d.prototype.getProgressWaitingRate=function(){var e=null;return this._progressBar&&(e=this._progressBar.value),e},d.prototype.updateProgressWaiting=function(e){e.fromAction&&(this._waitingPagefromAction=e.fromAction),this._startTimeWaitingPageStep&&this._trackWaitingPageStepDuration(!1),this._startTimeWaitingPageStep=(new Date).getTime(),this._progressBar&&m.call(this,e).then(f.bind(this,e))};var m=function(e){return new p(function(t){var i=0;e.progress&&(i=e.progress.rateInPercent?e.progress.rateInPercent:0),clearTimeout(this._progressTimeout);var n=function(){if(this._progressBar&&(this._progressBar.value=i,this._progressRate=i,e.progress&&!0===e.progress.simulate)){var t=11,n=function(e){this._progressTimeout=setTimeout(n.bind(this,e),e),i=this._progressRate+(100-this._progressRate)/++t,this._progressBar.value=i,this._progressRate=i};this._progressTimeout=setTimeout(n.bind(this,100),200)}};e.progress&&!0===e.progress.completePrevStep?(this._progressBar&&(this._progressBar.value=100),this._progressTimeout=setTimeout(function(){n.call(this),t()}.bind(this),200)):(n.call(this),t())}.bind(this))},f=function(e){var t="",i="",n="";e.progress&&(t=e.progress.stepIndex?e.progress.stepIndex.toString():"",i=e.progress.stepsNb?"/ "+e.progress.stepsNb.toString():"",n=e.progress.stepName?e.progress.stepName:"",this._progressStepNameIdentifier=e.progress.stepNameIdentifier?e.progress.stepNameIdentifier:"");var s=e.modelId?e.modelId:"";""!==s&&this._progressModelId&&this._progressModelId.setHTML(s);var o=[],a=[],r=[];""!==t||""!==n?(""!==t?(this._progressStepIndex&&this._progressStepIndex.setHTML(t),o.push(this._progressStep),a.push(this._progressStepIndex),""!==i&&(this._progressStepsNb&&this._progressStepsNb.setHTML(i),a.push(this._progressStepsNb)),this._progressStep&&this._progressStep.setHTML(a)):this._progressStep&&this._progressStep.empty(),""!==n?(this._progressStepName&&this._progressStepName.setHTML(n),o.push(this._progressStepTitle),r.push(this._progressStepName),this._progressStepTitle&&this._progressStepTitle.setHTML(r)):this._progressStepTitle&&this._progressStepTitle.empty(),this._progressLabel&&this._progressLabel.setHTML(o)):this._progressLabel&&this._progressLabel.empty()},v=function(t){var i=new r.Element("div",{class:"xapp-waiting-container"});i.inject(this._mainContainer);var n=[];n.push({tag:"span",class:"xapp-spinner-thumbnail",html:new o({className:"msg-animation",visible:!0,animate:!0,spin:!0})});var s=this.getText(t.waitingType+".Title");if(n.push({tag:"span",class:"xapp-waiting-type",html:t.waitingType===c.waitingTypes.create?s+" ...":s}),t.modelId&&"string"==typeof t.modelId&&(t.waitingType===c.waitingTypes.open||t.waitingType===c.waitingTypes.recover||t.waitingType===c.waitingTypes.restore)){var a=t.modelId;n.push({tag:"span",class:"xapp-waiting-model",html:a})}if(new r.Element("div",{class:"xapp-waiting-title",html:n}).inject(i),(t.waitingType===c.waitingTypes.open||t.waitingType===c.waitingTypes.recover||t.waitingType===c.waitingTypes.restore)&&t.cancelAction&&"function"==typeof t.cancelAction){var p=this.getText(t.waitingType+".Cancel");new r.Element("button",{class:"btn btn-default xapp-waiting-cancel",html:p}).inject(i).addEventListener(e.POINTERUP,function(e){t.cancelAction.call(this),e.stopPropagation()}.bind(this))}};return d.prototype.insertDataView=function(){},d.prototype.removeDataView=function(){},d.prototype.createMainContainer=function(e,t){this._landingPageScroll||(this._landingPageScroll=new r.Element("div",{class:"xapp-landingpage-to-scroll"})),this._mainContainer=new r.Element("div",{class:"container xapp-main-container",pageType:e}),this._landingPageScroll&&this._landingPageScroll.setContent(this._mainContainer),this._scroller||(this._scroller=new n({element:this._landingPageScroll}).inject(this.options.body)),this.addBackgroundImageToMainContainer(e,t)},d.prototype.addBackgroundImageToMainContainer=function(e,t){var i="",n="",s="",o=this.getMedia(e+".Background","Image");if(o&&o.images){var a=o.images;if(Array.isArray(a)){a.sort(function(e,t){return(e.width?e.width:0)-(t.width?t.width:0)});for(var p=0;p<a.length;p++)p<a.length-1?i+=o.baseUrl+a[p].url+" "+a[p].width+"w,":i+=o.baseUrl+a[p].url+" "+a[p].width+"w";n="100vw",s=o.baseUrl+a[0].url}else"string"==typeof a&&(s=o.baseUrl+a)}else s=this.getMedia(e,"Image","Medium",this.options.rsc);var l=this.getMedia(e+".Background","Corner"),c=new r.Element("img",{class:"xapp-background-image"+(l?" xapp-background-image-"+l:""),srcset:i,sizes:n,src:s});c.addClassName(t),c.setAttribute("draggable",!1),c.inject(this._mainContainer)},d.prototype.createAppOverviewModal=function(){this._appOverviewModal=new s({renderTo:document.querySelector(".xapp-main-container"),animate:!0,className:"xapp-overview-modal"}),this._appOverviewModal.dialog({body:[{tag:"div",class:"xapp-tip"}],title:this.getText("App.Motto"),buttons:[{className:"primary",value:this.getText("Info.Validate"),action:function(e){e.hide(),this._appOverviewModal=null}.bind(this)}]});for(var e=function(e,t,i){e.removeAttribute("src"),"function"==typeof this.fscreen.fullscreenElement&&this.fscreen.fullscreenElement()===e?e.setAttribute("src",i):e.setAttribute("src",t)},t=[],i=0,n=this.getText("Tips"+i+".Title");void 0!==n;){var o=this.getMedia("Tips"+i,void 0,void 0,this.options.rsc),a=this.getText("Tips"+i+".Content"),p={};if(o.hasOwnProperty("Image"))p=new r.Element("img",{class:"xapp-tip-img",src:o.Image.Medium});else if(o.hasOwnProperty("Video")){var c=o.Video.Small,h=o.Video.Large,g=p=new r.Element("video",{class:"xapp-tip-video",controls:!0,preload:"metadata"});new r.Element("source",{id:"mp4_src",src:c,type:"video/mp4"}).inject(g),"function"==typeof this.fscreen.fullscreenEnabled&&this.fscreen.fullscreenEnabled()&&this.fscreen.addEventListener("fullscreenchange",e.bind(this,g,c,h),!1)}var d=new r.Element("div",{html:[p,{tag:"div",class:"xapp-tip-footer",html:[{tag:"p",class:"xapp-tip-badge",html:n},{tag:"p",class:"xapp-tip-text",html:a}]}]});t.push(d),n=this.getText("Tips"+ ++i+".Title")}var u=new l({autoPlay:!0,autoPlaySpeed:8e3,animation:"slide",pauseOnHover:!0,dots:!0,infinite:!0,arrows:t.length>1,events:{onSlide:function(){if(u){for(var e=u.getSlides(),t=-1,i=0;-1===t&&i<e.length;)e[i].hasClassName("active")&&(t=i),++i;var n=e[t>0?t-1:e.length-1].getElementsByTagName("video");if(n)for(i=0;i<n.length;i++)n[i].pause()}}}});return u.add(t),u.inject(document.querySelector(".xapp-tip")),this._appOverviewModal},d.prototype.clean=function(){this._startTimeWaitingPageStep&&this._trackWaitingPageStepDuration(!0),this._startTimeWaitingPageStep=null,this._totalTimeWaitingPage=0,this._waitingPagefromAction=null,this.closeDialog(),this._progressBar=null,this._progressLabel=null,this._progressStep=null,this._progressStepIndex=null,this._progressStepsNb=null,this._progressStepTitle=null,this._progressStepName=null,this._progressStepNameIdentifier=null,this._progressModelId=null,this._mainContainer=null,this._landingPageScroll=null,this._scroller=null,clearTimeout(this._progressTimeout),this._progressTimeout=null,h.prototype.clean.call(this)},d.prototype.closeDialog=function(){this._appOverviewModal&&this._appOverviewModal.modals&&this._appOverviewModal.modals.current&&(this._appOverviewModal.modals.current.destroy(),this._appOverviewModal=null)},d.prototype._trackWaitingPageStepDuration=function(e){if(this._startTimeWaitingPageStep){var t=(new Date).getTime()-this._startTimeWaitingPageStep;this._totalTimeWaitingPage+=t;var i=t>0?Math.round(t/1e3*10,1)/10:null,n=Math.round(this._totalTimeWaitingPage/1e3*10)/10,s=e;g.trackModelLoadingTime(this.options.executionContext,{fromAction:this._waitingPagefromAction,progressStepNameIdentifier:this._progressStepNameIdentifier,stepDurationInSeconds:i,totalTimeInSeconds:n,isLoadingOver:s?1:0,progressStepIndex:this._progressStepIndex?parseInt(this._progressStepIndex.getText()):null,progressStepsNb:this._progressStepsNb&&this._progressStepsNb.getText()?parseInt(this._progressStepsNb.getText().substring(2)):null})}},d});