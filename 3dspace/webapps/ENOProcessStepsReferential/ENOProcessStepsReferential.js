define("DS/ENOProcessStepsReferential/scripts/ProcessStepsReferential",["DS/WebappsUtils/WebappsUtils","DS/Handlebars/Handlebars4","DS/UIKIT/Accordion","css!DS/ENOProcessStepsReferential/ENOProcessStepsReferential","text!DS/ENOProcessStepsReferential/ProcessStepsReferential.html","DS/ENOProcessStepsUX/scripts/ProcessStepsUtil","DS/UIKIT/IconDropdown","i18n!DS/ENOProcessStepsReferential/assets/nls/ProcessStepsReferential"],function(e,t,o,s,n,i,r,l){"use strict";t.registerHelper("ifeq",function(e,t,o){return e==t?o.fn(this):o.inverse(this)}),t.registerHelper("ifnoteq",function(e,t,o){return e!=t?o.fn(this):o.inverse(this)}),t.registerHelper("ifContains",function(e,t,o){return e.indexOf(t)>=0?o.fn(this):o.inverse(this)}),t.registerHelper("ifNotContains",function(e,t,o){return e.indexOf(t)<0?o.fn(this):o.inverse(this)}),t.registerHelper("get_length",function(e){return e.length}),t.registerHelper("setIndex",function(e){this.index=Number(e+1)});var a={loadReferentialView:function(e,s,r){var c={objectId:s,mcsurl:e.myAppsURL};c=JSON.stringify(c);var d=e.myAppsURL+"/resources/processStepsReferential/ReferentialService/getProcessStepsReferentialData";i.makeWSCall(d,e,c,function(e,s){var i=e.data;s=document.getElementById("recentDocuments");var r=new UWA.Element("div",{styles:{objectFit:"cover",width:"100%",padding:"2px",position:"relative",margin:"6px",display:"inline-grid",gridTemplateColumns:"repeat(auto-fill, minmax(235px, 235px))",gridRowGap:"15px"}});r.setAttributes({id:"boxDiv4"});var c={Box:i},d=t.compile(n)(c);r.addContent(d);new o({className:"styled divided filled",items:[{title:l.MyReferential,content:r,selected:!0}],events:{onOpen:function(){},onClose:function(){}}}).inject(s);a.attachEventHdlrs(s)},function(e,t){console.log("onReferenceViewFailureCallback:errDetailds:"+e)},r)},attachEventHdlrs:function(e){$(".alert_callout_link").click(function(){var e=$(this).attr("id");return i.openViewPage(e),!1}),a.populateStateColor();var t;$(".alertColor").hover(function(){var e=$(this),o=$(this).position().left,s=$(".content").width()-o;console.log(s);return s<290||s<490?(t=setTimeout(function(){var t=$(e).find(".alert_callout_link").text(),o=a.text_truncate(t,85,"...");$(e).find(".alert_callout_link").text(o),a.showCallout($(e)),a.cssTransformInWidth();var s=$(e).parents(".border-container").removeClass("enoprocstpes-disabled");$(".border-container").not(s).addClass("enoprocstpes-disabled"),$(e).find("#arrowCalloutRef").addClass("special2"),$(e).find("#arrowCalloutRef").removeClass("special")},600),!1):(t=setTimeout(function(){var t=$(e).find(".alert_callout_link").text(),o=a.text_truncate(t,85,"...");$(e).find(".alert_callout_link").text(o),a.showCallout($(e)),a.cssTransformOutWidth();var s=$(e).parents(".border-container").removeClass("enoprocstpes-disabled");$(".border-container").not(s).addClass("enoprocstpes-disabled"),$(e).find("#arrowCalloutRef").addClass("special"),$(e).find("#arrowCalloutRef").removeClass("special2")},600),!1)},function(){return clearTimeout(t),!1}),$(".boxcloseRef").click(function(){return a.hideCallout($(this)),$(".border-container").removeClass("enoprocstpes-disabled"),!1}),$(".cmd-slider-left").click(function(){a.showToolbar($(this),"0")}),$(".cmd-slider-right").click(function(){a.showToolbar($(this),"1")}),$(".cmd-starter").mouseover(function(){a.highlightCmd($(this))}),$(".cmd-starter").mouseout(function(){a.unhighlightCmd($(this))}),$(".cmd-starter").mousedown(function(){a.activateCmd($(this))}),$(".cmd-starter").mouseup(function(){a.deactivateCmd($(this))}),$(".cmd-container-dropdown").mouseover(function(){a.highlightCmdDropdown($(this))}),$(".cmd-container-dropdown").click(function(){a.dropdownData($(this))}),$(".outline").on("dragstart",function(e){a.dragBox(e,this)}),$(".outline").on("dragend",function(e){a.dragEndBox(e,this)}),$(".outline").on("dragleave",function(e){a.dragleaveBox(e,this)}),$(".outline").on("dragover",function(e){a.dragoverBox(e,this)}),$(".outline").on("drop",function(e){a.dropbox(e,this)})},cssTransformInWidth:function(){$(".visible-balloonRef").css("margin-left","-292px"),$(".visible-balloonRef").css("margin-top","-21px"),$(".boxcloseRef").css("float","left"),$(".boxcloseRef").css("left","-6px"),$(".boxcloseRef").css("position","relative")},cssTransformOutWidth:function(){$(".boxcloseRef").css("float","right"),$(".boxcloseRef").css("left","-2px")},showCallout:function(e){e.find("#callout").addClass("visible-balloonRef"),e.find("#callout").removeClass("hidden-balloonRef")},hideCallout:function(e){e.closest("#callout").addClass("hidden-balloonRef"),e.closest("#callout").removeClass("visible-balloonRef")},text_truncate:function(e,t,o){return null==t&&(t=15),null==o&&(o="..."),e.length>t?e.substring(0,t-o.length)+o:e},dragBox:function(e,t){var o=t.cloneNode(!0);o.id="dragGhostDiv",o.style.position="absolute",o.style.top="0px",o.style.left="-10000px",o.getElementsByClassName("border-container")[0].getElementsByClassName("cmd-workbench")[0].style.display="none",document.body.appendChild(o),e.originalEvent.dataTransfer.setDragImage(o,0,0),t.style.transform=null,e.originalEvent.dataTransfer.setData("DragObjectId",t.id),e.originalEvent.dataTransfer.setData("Reference Document","true")},dragEndBox:function(e,t){var o=document.getElementById("dragGhostDiv");o&&o.remove()},dragleaveBox:function(e,t){var o=t.getElementsByClassName("hvrbox-layer_top");o[0].style.width="200px",o[0].style.zIndex="-1",o[0].style.opacity="0"},dragoverBox:function(e,t){e.stopPropagation();var o=t.width;console.log(o),e.preventDefault();var s=t.getElementsByClassName("hvrbox-layer_top");"Microsoft Internet Explorer"==navigator.appName||navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/rv:11/)||void 0!==$.browser&&1==$.browser.msie?s[0].style.width="222px":s[0].style.width="220px",s[0].style.zIndex="1",s[0].style.opacity="0.8"},dropbox:function(e,t,o,s,n){var r=t.getAttribute("droptypes"),l=t.getAttribute("droprelationship"),a=t.getAttribute("droptypedirection"),c=t.getAttribute("dropprogram"),d=t.getAttribute("message");null==r&&(r=""),null==l&&(l=""),null==a&&(a=""),null==c&&(c=""),null==d&&(d=""),null==c&&(c="");var u=t.getAttribute("myAppsURL")+"/resources/processStepsReferential/ReferentialService/dropProgram",p={dragObjectId:e.originalEvent.dataTransfer.getData("DragObjectId"),dropObjectId:t.id,program:c,types:r,relationship:l,typedirection:a,message:d};p=JSON.stringify(p);var f={};f.myAppsURL=t.getAttribute("myAppsURL"),f.proxy=o,f.tenant=s,f.securitycontext=n,i.makeWSCall(u,f,p,function(e){console.log("jsonObject:"+e);e.message;e.error&&e.error},"","",!1);var g=t.getElementsByClassName("hvrbox-layer_top");g[0].style.width="200px",g[0].style.opacity="0",g[0].style.zIndex="-1"},getOwnerImageDiv:function(e){var t=e.ownerImageURL,o=e.title,s=e.emailAddress,n=e.title,i="<div";return i+=t?' class="person-image" style="background-image: url("{0}");"'.format(encodeURI(t)):' class="person-solid icon"',s&&(i+=" onclick=\"location.href='mailTo:{0}?subject={1}'\"".format(s,encodeURI(o)),t||(i+=' style="cursor:pointer"')),n&&(i+=' title="{0}"'.format(n)),i+="></div>",t||(i+="    "),elementinnerHTML=i,i},showHalo:function(e){"left"===e?$(".cmd-slider-halo-left").css("visibility","visible"):$(".cmd-slider-halo-right").css("visibility","visible")},clearHalo:function(e){"left"===e?$(".cmd-slider-halo-left").css("visibility","hidden"):$(".cmd-slider-halo-right").css("visibility","hidden")},showToolbar:function(e,t){var o=e[0].id.split("_")[1],s=o+"0",n=o+"1";"1"===t?($("#"+s).css("display","none"),$("#"+n).css("display","inline-flex")):($("#"+n).css("display","none"),$("#"+s).css("display","inline-flex"))},highlightCmd:function(e){e.toggleClass("cmd-state-hover")},unhighlightCmd:function(e){e.toggleClass("cmd-state-hover")},activateCmd:function(e){e.toggleClass("cmd-state-active")},deactivateCmd:function(e){e.toggleClass("cmd-state-active")},highlightCmdDropdown:function(e){e.toggleClass("cmd-state-hover")},dropdownData:function(t){e.getWebappsBaseUrl();for(var o=document.getElementById(t[0].id),s=t[0].id.split("@")[0],n=document.getElementsByClassName(s+"_child-element"),i=[],l=0;l<n.length;l++){var a=n[l],c=a.getAttribute("href"),d=a.getAttribute("src"),u=a.getAttribute("title");i.push({icon:d,description:u,className:"dropdownContainer",href:c,selectable:"true"})}new r({target:o,items:i,events:{onClick:function(e,t){window.location.href=t.href}}})},populateStateColor:function(){$(".title-image").map(function(){var e=$(this),t=$(e).attr("alt");"Draft"===t||"In Work"===t||"In Approval"===t||"Approved"===t?($(e).next(".box-title").css("border","2px solid #56BDEA"),$(e).next(".box-title").css("background-color","#56BDEA")):"Released"===t?($(e).next(".box-title").css("border","2px solid #35D173"),$(e).next(".box-title").css("background-color","#35D173")):"Superseded"!==t&&"Obsolete"!==t||($(e).next(".box-title").css("border","2px solid #FC150A"),$(e).next(".box-title").css("background-color","#FC150A"))}),$(".box-title").css("padding","1px"),$(".box-title").css("border-radius","7px"),$(".title-link").css("color","white")}};return a});