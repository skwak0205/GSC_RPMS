define("DS/CAT3DWSceneObject/CAT3DWSceneObject",["UWA/Class","UWA/Core"],function(e,t){"use strict";var o=e.extend({init:function(){this._parent(),this._isLocked=!1},getID:function(){throw new Error("Must be implemented")},getType:function(){throw new Error("Must be implemented")},lock:function(){this._isLocked=!0},unlock:function(){this._isLocked=!1},isLocked:function(){return this._isLocked},getCreationData:function(){return{locked:this.isLocked()}},getMoveData:function(){throw new Error("Must be implemented")},setMoveData:function(){throw new Error("Must be implemented")},getEditData:function(){return{locked:this.isLocked()}},setEditData:function(e){e.locked?this.lock():this.unlock()}});return t.namespace("DS/CAT3DWSceneObject/CAT3DWSceneObject",o)}),define("DS/CAT3DWSceneObject/CAT3DWConnectableObject",["DS/CAT3DWSceneObject/CAT3DWSceneObject","DS/CAT3DWVisu/CAT3DWTolerance","DS/Visualization/ThreeJS_DS"],function(e,t,o){"use strict";return e.extend({getCenter:function(){throw new Error("Must be implemented")},getCorners:function(){throw new Error("Must be implemented")},get2DPortPosition:function(){throw new Error("Must be implemented")},get2DProjectedPosition:function(){let e=new o.Vector3,n=new o.Vector3,r=new o.Vector3,c=new o.Vector3,i=new o.Vector3,l=new o.Vector3,s=new o.Vector3,a=new o.Vector3,u=new o.Vector3,p=new o.Vector3,m=new o.Vector3,d=new o.Vector3,y=new o.Vector3;return function(f,b){b.projectPoint(this.getCenter(),e),b.projectPoint(f,n),r.copy(n).sub(e),c.copy(n).sub(e).normalize();let h=this.getCorners();a.copy(h.topLeft).sub(e),u.copy(h.topRight).sub(e),p.copy(a).normalize(),m.copy(u).normalize();let w=c.dot(p),S=c.dot(m),D=null;if(w>t.toleranceForUnitaryVectors?D=a.clone():w<-t.toleranceForUnitaryVectors&&(D=a.clone().multiplyScalar(-1)),S>t.toleranceForUnitaryVectors?D=u.clone():S<-t.toleranceForUnitaryVectors&&(D=u.clone().multiplyScalar(-1)),!D)if(i.copy(b.normal),d.crossVectors(m,p).dot(b.normal)<0&&i.multiplyScalar(-1),d.crossVectors(c,p),y.crossVectors(c,m),d.dot(i)<0)if(y.dot(i)<0){l.copy(h.topRight).sub(h.topLeft).multiplyScalar(.5),s.copy(l).normalize();let e=l.length()/Math.abs(r.dot(s));D=r.multiplyScalar(e)}else{l.copy(h.topLeft).sub(h.bottomLeft).multiplyScalar(.5),s.copy(l).normalize();let e=l.length()/Math.abs(r.dot(s));D=r.multiplyScalar(e)}else if(y.dot(i)<0){l.copy(h.topLeft).sub(h.bottomLeft).multiplyScalar(.5),s.copy(l).normalize();let e=l.length()/r.dot(s);D=r.multiplyScalar(e)}else{l.copy(h.topRight).sub(h.topLeft).multiplyScalar(.5),s.copy(l).normalize();let e=l.length()/r.dot(s);D=r.multiplyScalar(e)}let V=b.projectPoint(D.add(e));return new o.Vector2(V.x,V.y)}}()})});