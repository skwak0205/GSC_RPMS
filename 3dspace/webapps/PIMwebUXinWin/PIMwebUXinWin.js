define("DS/PIMwebUXinWin/PIMWiWItfList",["UWA/Core","UWA/Class","DS/PIMwebUX/PIMwebItfListUI","DS/UIKIT/Native/Dropdown","i18n!DS/PIMwebUX/assets/nls/PIMwebItfListUI","css!DS/PIMwebUX/assets/css/PIMwebItfListUI"],function(e,t,n,i,o){"use strict";return t.extend({init:function(t){var s=[],l="object"==typeof t.defOrder?Array.from(t.defOrder):t.defOrder.split(","),d=[],r=[],a=[],c=[],f=[],u={},g=null,p=!0,h=!0,w={},I=null,m=0,S=!0,C=[],y=!1,v=t.currentUnits,x=t.typeOfItf,R=["itfQuantifier","itfPenVec","itfMinDist","itfPenVol","itfTolerance","Time"];function b(){var e,t=0,n=0,i=0;s.forEach(function(e){var o=e.itfUserType,s=e.itfSystemType;"Clash"===o?t++:"Contact"===o?n++:"Clearance"===o?i++:o&&"Undefined"!==o||("Clash"===s?t++:"Contact"===s?n++:"Clearance"===s&&i++)}),(t||n||i)&&(e=t?t+" "+o["Clash"+(t>1?"es":"")]:"",e+=e&&n?" ":"",e+=n?n+" "+o["Contact"+(n>1?"s":"")]:"",e+=e&&i?" ":"",e+=i?i+" "+o["Clearance"+(i>1?"s":"")]:""),e=e||o.noItf,window.dscef.sendString(JSON.stringify({action:"chgTitle",title:e}))}function O(e){if(s[e.id][e.param]=e.newValue,"itfUserType"===e.param&&b(),"itfAnalysis"===e.param&&"NotAnalyzed"===e.newValue){var t=s[e.id].itfPrevAnalysis;e.newValue="OK"===t||"KO"===t?"To_be_ReAnalyzed":"To_be_Analyzed"}window.dscef.sendString(JSON.stringify({action:"onAttributeChange",colValue:e.newValue,col:e.param,itfId:e.id})),setTimeout(function(){g.reApplyFilterAndSort()},100)}function V(){clearTimeout(m),S=!1}function N(e){S=!0,w._lastX=e.clientX,w._lastY=e.clientY,w.launched&&(window.dscef.sendString(JSON.stringify({action:"closeToolTip"})),w.launched=!1),m=setTimeout(function(){if(e.clientX===w._lastX&&w._lastY===e.clientY&&S){var t=g.getRowInfosFromMousePosition({top:w._lastY,left:w._lastX}),n="",i=0;Object.keys(t).forEach(function(e){var o="&nbsp"+e+" : "+t[e]+"&nbsp";o.length>=i&&(i=o.length),n=n+o+"<br>"}),""!==n&&S&&(w.launched=!0,window.dscef.sendString(JSON.stringify({action:"buildtoolTip",tooltipInfoFrmJs:n,width:9*parseInt(i),height:20*(Object.keys(t).length+1)})))}},1500)}function D(e){if("number"==typeof e){var t=g.getNumberOfRows(),n=e<0?t-1:e>=t?0:e;g.selectRows([n])}}function A(e,t,n){if(0!==e.length){var i=0;t.first||e.forEach(function(e){if(e!==n&&!t.first){var o=s[n].itfInstance1Label;if(0===o.localeCompare(s[e].itfInstance1Label)||0===o.localeCompare(s[e].itfInstance1Labe2)){var l=[];l.push(e),window.dscef.sendString(JSON.stringify({action:"onItfSelection",itfId:l})),i++,t.first=1,1!==f.indexOf(e)&&(f.splice(f.indexOf(e),1),f.push(e))}}}),t.second||e.forEach(function(e){if(e!==n&&!t.second){var o=s[n].itfInstance2Label;if(0===o.localeCompare(s[e].itfInstance1Label)||0===o.localeCompare(s[e].itfInstance1Labe2)){var l=[];l.push(e),window.dscef.sendString(JSON.stringify({action:"onItfSelection",itfId:l})),i++,t.second=1,1!==f.indexOf(e)&&(f.splice(f.indexOf(e),1),f.push(e))}}}),t.both=2===i?1:0}}function E(e){var t=e.filter(function(e){return e.options.grid.itfuid});if(t.length){var n=[],i=[],o=[],l=[],d=null;t.forEach(function(e){var t=e.options.grid.itfuid;-1===f.indexOf(t)&&("Clash"===(d=s[t].itfSystemType)?i.push(t):"Contact"===d?o.push(t):"Clearance"===d?l.push(t):(n.push(t),f.push(t)))}),l.forEach(function(e){n.push(e),c.push(e),f.push(e)}),o.forEach(function(e){n.push(e),a.push(e),f.push(e)}),i.forEach(function(e){n.push(e),r.push(e),f.push(e)}),p&&(h?window.dscef.sendString(JSON.stringify({action:"onItfSelection",itfId:f})):window.dscef.sendString(JSON.stringify({action:"onItfSelection",itfId:n}))),p&&y&&"Clash"!==d&&1===t.length&&f.length>1&&function(e,t){var n={both:0,first:0,second:0};"Contact"===e&&A(r,n,t),"Clearance"===e&&(A(r,n,t),n.both||A(a,n,t))}(d,n[0]),u.isDetailUICmdActivated&&(window.dscef.sendString(JSON.stringify({action:"stopDetailUICmd"})),u.isDetailUICmdActivated=!1)}}function J(e){var t=e.filter(function(e){return e.options.grid.itfuid});t.length&&(t.length===f.length?(p&&window.dscef.sendString(JSON.stringify({action:"onAllItfUnselection"})),f.length=r.length=a.length=c.length=0):t.forEach(function(e){var t=e.options.grid.itfuid,n=s[t].itfSystemType;"Clash"===n?r.splice(r.indexOf(t),1):"Contact"===n?a.splice(a.indexOf(t),1):"Clearance"===n&&c.splice(c.indexOf(t),1),f.splice(f.indexOf(t),1);var i=[];i.push(t),p&&window.dscef.sendString(JSON.stringify({action:"onItfUnSelection",itfId:i})),y&&p&&function(e){var t={both:0,first:0,second:0};A(r,t,e),t.both||A(a,t,e),t.both||A(c,t,e)}(t)}),u.isDetailUICmdActivated&&(window.dscef.sendString(JSON.stringify({action:"stopDetailUICmd"})),u.isDetailUICmdActivated=!1))}function U(){I&&(I.destroy(),I=null)}function P(e){if(0!==C.length){var t={items:e,id:"PimWiWMenu",target:document.body,contextual:!0,events:{onHide:function(){U()},onClick:function(){U()},onClickOutside:function(){U()}}};(I=new i(t))&&I.show()}}function T(t,n){C.length=0;var i=t.collectionView.layout.getColumnPinned(t.cellInfos.columnID);C.push({text:o.itfPinCol,items:[{text:o.itfPinLeft,disabled:"left"===i,nativeHandler:function(){t.collectionView.layout.setColumnPinned(t.cellInfos.columnID,"left",{isUserInteraction:!0})}},{text:o.itfPinRight,disabled:"right"===i,nativeHandler:function(){t.collectionView.layout.setColumnPinned(t.cellInfos.columnID,"right",{isUserInteraction:!0})}},{text:o.itfNoPin,disabled:"left"!==i&&"right"!==i,nativeHandler:function(){t.collectionView.layout.setColumnPinned(t.cellInfos.columnID,"unpinned",{isUserInteraction:!0})}}]}),C.push({text:o.itfSizeColFit,nativeHandler:function(){t.collectionView.sizeColumnToFit(t.cellInfos.columnID,!0)}}),C.push({text:o.itfAllSizeColFit,nativeHandler:function(){t.collectionView.sizeAllColumnsToFit(!0)}}),C.push({text:o.itfHideColumn,nativeHandler:function(){var e=t.collectionView.layout.getDataIndexFromColumnIndex(t.cellInfos.columnID);t.collectionView.layout.setColumnVisibleFlag(e,!1,{isUserInteraction:!0})}});var s=t.collectionView.getTreeDocument().getFilterManager(),l=t.collectionView.layout.getDataIndexFromColumnIndex(t.cellInfos.columnID);"tree"===l&&(l="label"),s.filterModel[l]?C.push({text:o.itfRemoveFilter,nativeHandler:function(){var n=e.extend({},s.filterModel);delete n[l],t.collectionView.getTreeDocument().setFilterModel(n)}}):C.push({text:o.itfAddFilter,nativeHandler:function(){s.setPropertyFilterModel(l,{filterId:R.indexOf(l)>-1?"number":"stringRegexp"})}}),C.push({text:o.itfCustomView,nativeHandler:function(){!function(e){parent.getcollectionView=function(){return e};var t=window.open("dsrtv://webapps/PIMwebUXinWin/PIMWiWItfListColumnCustomView.html","","width=505,height=505,top=150,left=300");t.focus(),window.dscef.sendString(JSON.stringify({action:"removeMinimizedBtn"})),parent.closePopUp=function(){t.close(),parent.document.removeEventListener("mousedown",parent.closePopUp)},parent.document.addEventListener("mousedown",parent.closePopUp)}(t.collectionView)}}),n.isQuantiColSubMenu&&"itfQuantifier"===t.collectionView.layout.getDataIndexFromColumnIndex(t.cellInfos.columnID)&&C.push({text:o.itfClashVal,items:[{text:o.itfPenVol,disabled:n.isPenVol,nativeHandler:function(){g.switchQuantifierColumnVal({isPenVolume:!0}),window.dscef.sendString(JSON.stringify({action:"initEnvFromJS",isPenVolInQuantCol:!0}))}},{text:o.itfPenVec,disabled:!n.isPenVol,nativeHandler:function(){g.switchQuantifierColumnVal({isPenVolume:!1}),window.dscef.sendString(JSON.stringify({action:"initEnvFromJS",isPenVolInQuantCol:!1}))}}]}),P(C)}function q(e,t){S=!1,U(),e&&e.collectionView&&e.cellInfos&&-1===e.cellInfos.rowID?T(e,t.column):e.cellInfos&&e.cellInfos.nodeModel.isSelected()&&setTimeout(function(){window.dscef.sendString(JSON.stringify({action:"ctxMenu"}))},2)}this.addInterferences=function(e){Object.keys(e).forEach(function(t){"isObj"!==t&&(s[e[t].itfuid]=e[t],s[t].originated?s[t].originated=new Date(s[t].originated):delete s[t].originated,s[t].modified?s[t].modified=new Date(s[t].modified):delete s[t].modified,-1===s[t].itfPenVol&&delete s[t].itfPenVol,-1===s[t].itfPenVec&&delete s[t].itfPenVec,-1===s[t].itfMinDist&&delete s[t].itfMinDist)}),g.updateInterferences(s),b(),window.dscef.sendString(JSON.stringify({action:"itfListRowBuildDone",penVolInQuantCol:g.IsPenVolInQuantCol()}))},this.refreshView=function(){g.updateDataGridView({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0})},this.isApplySlideShow=function(e){var t;if("onBeginCB"===e.action){var n=g.getVisibleRows(),i=(t=g.getSelectedRows())&&t.length?t.length>1?t[0]:t[0]+1:0;t.length?(window.dscef.sendString(JSON.stringify({action:"setSlideShowValues",inumVisibleRows:n,iselectedRowID:i})),D(i>0?i-1:0)):(D(0),window.dscef.sendString(JSON.stringify({action:"setSlideShowValues",inumVisibleRows:n,iselectedRowID:i+1}))),window.dscef.sendString(JSON.stringify({action:"onSlideShowBegin"}))}else if("onPreviousSlideCB"===e.action){D((t=g.getSelectedRows())&&t.length?t.length>1?t[0]:t[0]-1:0)}else if("onNextSlideCB"===e.action){var o=g.getSelectedRows();D(o&&o.length?o.length>1?o[0]:o[0]+1:0)}else"onFirstSlideCB"===e.action?D(0):"onLastSlideCB"===e.action?D(g.getNumberOfRows()-1):"onCloseCB"===e.action&&window.dscef.sendString(JSON.stringify({action:"onSlideShowEnd"}))},this.removeAllInterference=function(){s.length&&g.removeInterferences(),s.length=0,b()},this.performSelAfterCbChange=function(){window.dscef.sendString(JSON.stringify({action:"onItfSelection",itfId:f}))},this.getItfVisibleRows=function(){var e=g.getVisibleRows();e.length||window.dscef.sendString(JSON.stringify({action:"visibleRows",itfIds:g.getSelectedInterferences(),visibleRows:e,columns:g.getColumns()}))},this.selectItf=function(e){var t=[];Object.keys(e).forEach(function(n){"propogateCb"===n?p="true"===e[n]:t.push(e[n])}),g.selectItf(t),setTimeout(function(){p=!0},50)},this.addInfoForItfList=function(e){e.isDetailedUICmdReq&&(u.detailedCmdReq=e.isDetailedUICmdReq),e.isRefreshCmdReq&&(u.isRefreshCmdReq=e.isRefreshCmdReq),e.isMultiRootCmdReq&&(u.isMultiRootCmdReq=e.isMultiRootCmdReq),e.isChgActionRequired&&(u.chgActionReq=e.isChgActionRequired),e.isGenIssueRequired&&(u.genIssueReq=e.isGenIssueRequired),e.isExportFilteredReq&&(u.isExportFilteredReq=e.isExportFilteredReq),e.isExportSelectedReq&&(u.isExportSelectedReq=e.isExportSelectedReq),e.centreGraphCmdReq&&(u.centreGraphCmdReq=e.centreGraphCmdReq),e.isExploreToItfFinderCmdReq&&(u.isExploreToItfFinderCmdReq=e.isExploreToItfFinderCmdReq),void 0!==e.toolTip&&(e.toolTip?(document.body.addEventListener("mouseover",N),document.body.addEventListener("mouseleave",V)):(document.body.removeEventListener("mouseover",N),document.body.removeEventListener("mouseleave",V))),e.isOldVisu&&(y=!0),e.newCodeVersion&&(h=!0),e.currentUnits&&(g.setUnits(e.currentUnits),g.updateInterferences(s)),e.relaunchPublishCmd&&setTimeout(function(){var e=g.getVisibleRows(),t=g.exportAsCSV({onlySelectedRows:!1});window.dscef.sendString(JSON.stringify({action:"exportFiltered",itfIds:e,csvData:t}))},100),e.buildAgainRowCtxMenu&&function(){U(),C.length=0,u.isRefreshCmdReq&&C.push({text:o.itfRefresh,nativeHandler:function(){setTimeout(function(){window.dscef.sendString(JSON.stringify({action:"refreshCmd"}))},0)}}),"pimExploreClash"===x&&(("pimExploreClash"===x||u.isExploreToItfFinderCmdReq)&&C.push({text:o.itfExploreToItfFinder,nativeHandler:function(){window.dscef.sendString(JSON.stringify({action:"exploreToItfFinder",itfIds:g.getSelectedInterferences()}))}}),u.isMultiRootCmdReq&&C.push({text:o.itfMultiRootOpen,nativeHandler:function(){window.dscef.sendString(JSON.stringify({action:"multiRootOpen",itfIds:g.getSelectedInterferences()}))}})),u.isExportFilteredReq&&C.push({text:o.itfExportFiltered,nativeHandler:function(){var e=g.getVisibleRows(),t=g.exportAsCSV({onlySelectedRows:!1});window.dscef.sendString(JSON.stringify({action:"exportFiltered",itfIds:e,csvData:t}))}}),u.isExportSelectedReq&&C.push({text:o.itfExportSelected,nativeHandler:function(){var e=g.getSelectedInterferences(),t=g.exportAsCSV({onlySelectedRows:!0});window.dscef.sendString(JSON.stringify({action:"exportSelected",itfIds:e,csvData:t}))}}),("pimExploreClash"!==x||u.centreGraphCmdReq)&&C.push({text:o.itfCentreGraph,nativeHandler:function(){window.dscef.sendString(JSON.stringify({action:"centreGraph"}))}}),u.detailedCmdReq&&1===f.length&&(C.push({text:o.itfDetailComp,nativeHandler:function(){window.dscef.sendString(JSON.stringify({action:"onDetailUI"}))}}),u.isDetailUICmdActivated=!0);var e=[];u.genIssueReq&&e.push({text:o.itfGenIssue,icon:"I_DMUIssue.png",nativeHandler:function(){window.dscef.sendString(JSON.stringify({action:"onGenerateIssue"}))}}),u.chgActionReq&&e.push({text:o.itfChgAction,icon:"I_VALCA.png",nativeHandler:function(){window.dscef.sendString(JSON.stringify({action:"onChangeAction"}))}}),0!==e.length&&C.push({text:2===e.length?o.itfTIC:o.itfTIC+" "+e[0].text,items:2===e.length?e:null,nativeHandler:2===e.length?null:function(){u.chgActionReq?window.dscef.sendString(JSON.stringify({action:"onChangeAction"})):window.dscef.sendString(JSON.stringify({action:"onGenerateIssue"}))}}),P(C)}()},this.wiwOdtHelper=function(e){var t=setInterval(function(){var n=g.getVisibleRows();if(n||!s.length){var i=[],o=0;if(e.selectAll)i=Object.keys(s).map(function(){return o++});else if(e.rowSelect)try{i=(i=JSON.parse(e.rowSelect)).filter(function(e){return e<=n.length&&e>0}).map(function(e){return e-1})}catch(e){i=[]}if(i.length&&g.selectRows(i),e.dumpList){var l=g.exportAsCSV({onlySelectedRows:!1,allColumns:!0});window.dscef.sendString(JSON.stringify({action:"odtDumpList",dumpListData:l}))}setTimeout(function(){"Refresh"===e.cxtCmd?window.dscef.sendString(JSON.stringify({action:"refreshCmd"})):"Export Filtered"===e.cxtCmd?window.dscef.sendString(JSON.stringify({action:"exportFiltered",itfIds:n})):"Export Selected"===e.cxtCmd?window.dscef.sendString(JSON.stringify({action:"exportSelected",itfIds:g.getSelectedInterferences()})):"Centre Graph"===e.cxtCmd?window.dscef.sendString(JSON.stringify({action:"centreGraph"})):"Detailed Computation"===e.cxtCmd&&window.dscef.sendString(JSON.stringify({action:"onDetailUI"}))},0),clearInterval(t)}else window.dscef.sendString(JSON.stringify({action:"odtWait"}))},0)},function(e){if(!g){i=e.defCols,Object.keys(i).forEach(function(e){if("V_Itf_Analysis"!==e&&"V_Itf_User_Type"!==e&&"V_description"!==e&&"V_Name"!==e&&"V_Itf_Type"!==e&&"V_Itf_Previous_Analysis"!==e&&"originated"!==e&&"modified"!==e&&"tree"!==e)d[e]="itfLblOldInst1"===e||"itfLblOldInst2"===e?{dataIndex:e,text:i[e],visibleFlag:!1,width:"auto"}:{dataIndex:e,text:i[e],width:"auto"};else{var t=l.indexOf(e);"V_Itf_Analysis"===e?l[t]="itfAnalysis":"V_Itf_User_Type"===e?l[t]="itfUserType":"V_Name"===e?l[t]="itfMetricName":"V_Itf_Type"===e?l[t]="itfSystemType":"V_Itf_Previous_Analysis"===e?l[t]="itfPrevAnalysis":"tree"===e?"object"==typeof i[e]?(d[e]={dataIndex:i[e].dataIndex,text:i[e].text,visibleFlag:!i[e].visibleFlag||i[e].visibleFlag,typeRepresentation:i[e].typeRepresentation?i[e].typeRepresentation:"string"},"double"===i[e].typeRepresentation&&R.push("label")):"tree"===e&&"pimLocalClash"===x?d[e]={dataIndex:e,text:i[e],visibleFlag:!1}:"tree"===e&&"pimIdyClash"===x?(d[e]={dataIndex:e,text:i[e],typeRepresentation:"double"},R.push("label")):"tree"===e&&(d[e]={dataIndex:e,text:i[e]}):"originated"===e||"modified"===e?d[e]={dataIndex:e,text:i[e],typeRepresentation:"datetime",width:"auto"}:"V_description"===e&&(l[t]="itfDescription")}});var t={parent:document.body,suffix:x,cbDnD:{onDragStartColumnHeader:function(){return!0},onDragColumnHeader:function(){return!0},onDragOverColumnHeader:function(){return!0},onDragEnterColumnHeader:function(){return!0},onDragLeaveColumnHeader:function(){return!0},onDragEndColumnHeader:function(){return!0},onDropColumnHeader:function(){return!0}},defCols:d,deforder:l,readOnly:"pimPersistent"!==x,isWebInWin:!0,units:v};(g=new n(t)).onSelect=E,g.onUnselect=J,g.onCellEdit=O,g.contextualEvent=q,window.dscef.sendString(JSON.stringify({action:"itfListColumnBuildDone"}))}var i}(t)}})}),define("DS/PIMwebUXinWin/PIMWiWItfListCtrl",["UWA/Class","UWA/Core","DS/PIMwebUX/PIMwebDetailedItfListUI","DS/UIKIT/Native/Dropdown","i18n!DS/PIMwebUX/assets/nls/PIMwebItfListUI","css!DS/PIMwebUX/assets/css/PIMwebItfListUI"],function(e,t,n,i,o){"use strict";return e.extend({init:function(e){var s=[],l="object"==typeof e.defOrder?Array.from(e.defOrder):e.defOrder.split(","),d=[],r=[],a={},c=null,f=!0,u=!0,g={},p=null,h=0,w=!0,I=e.currentUnits,m=e.typeOfItf,S=["itfQuantifier","itfPenVec","itfMinDist","itfPenVol","itfTolerance","Time"];function C(){var e,t=0,n=0,i=0;s.forEach(function(e){if(!e.isElectrical){var o=e.itfUserType,s=e.itfSystemType;"Clash"===o?t+=e.childIds?e.childIds.length:1:"Contact"===o?n+=e.childIds?e.childIds.length:1:"Clearance"===o?i+=e.childIds?e.childIds.length:1:o&&"Undefined"!==o||("Clash"===s?t+=e.childIds?e.childIds.length:1:"Contact"===s?n+=e.childIds?e.childIds.length:1:"Clearance"===s&&(i+=e.childIds?e.childIds.length:1))}}),(t||n||i)&&(e=t?t+" "+o["Clash"+(t>1?"es":"")]:"",e+=e&&n?" ":"",e+=n?n+" "+o["Contact"+(n>1?"s":"")]:"",e+=e&&i?" ":"",e+=i?i+" "+o["Clearance"+(i>1?"s":"")]:""),window.dscef.sendString(JSON.stringify({action:"chgTitle",title:e||o.noItf}))}function y(e){if(s[e.id][e.param]!==e.newValue){s[e.id].isMetric&&"itfMetricName"===e.param&&(s[e.id].tree=s[e.id].itfName=e.newValue),s[e.id].isContextual&&"itfCtxName"===e.param&&s[e.id].itfName===s[e.id].itfCtxName&&(s[e.id].tree=s[e.id].itfName=e.newValue),s[e.id][e.param]=e.newValue,"itfUserType"===e.param&&C(),"itfAnalysis"===e.param&&"NotAnalyzed"===e.newValue&&(e.newValue="OK"===s[e.id].itfPrevAnalysis||"KO"===s[e.id].itfPrevAnalysis?"To_be_ReAnalyzed":"To_be_Analyzed");for(var t=[],n=s[e.id];n&&n.childOf;)t.push(n.childOf),n=s[n.childOf];window.dscef.sendString(JSON.stringify({action:"onAttributeChange",colValue:e.newValue,col:e.param,itfId:e.id,parents:t})),setTimeout(function(){c.reApplyFilterAndSort()},100)}}function v(){clearTimeout(h),w=!1}function x(e){w=!0,g._lastX=e.clientX,g._lastY=e.clientY,g.launched&&(window.dscef.sendString(JSON.stringify({action:"closeToolTip"})),g.launched=!1),h=setTimeout(function(){if(e.clientX===g._lastX&&g._lastY===e.clientY&&w){var t=c.getRowInfosFromMousePosition({top:g._lastY,left:g._lastX}),n="",i=0;Object.keys(t).forEach(function(e){var o="&nbsp"+e+" : "+t[e]+"&nbsp";o.length>=i&&(i=o.length),n=n+o+"<br>"}),""!==n&&w&&(g.launched=!0,window.dscef.sendString(JSON.stringify({action:"buildtoolTip",tooltipInfoFrmJs:n,width:9*parseInt(i),height:20*(Object.keys(t).length+1)})))}},1500)}function R(e){if("number"==typeof e){var t=c.getNumberOfRows(),n=e<0?t-1:e>=t?0:e;c.selectRows([n])}}function b(e){var t=e.idsSelected;t.length&&(t.forEach(function(e){-1===r.indexOf(e)&&r.push(e)}),f&&u&&window.dscef.sendString(JSON.stringify({action:"onItfSelection",itfId:r,actualIdsSelected:e.actualIdsSelected})),a.isDetailUICmdActivated&&(window.dscef.sendString(JSON.stringify({action:"stopDetailUICmd"})),a.isDetailUICmdActivated=!1))}function O(e,t){if(e.length){if(e.length===r.length)f&&window.dscef.sendString(JSON.stringify({action:"onAllItfUnselection"})),r.length=0;else{var n=[];e.forEach(function(e){r.splice(r.indexOf(e),1),n.push(e)}),f&&window.dscef.sendString(JSON.stringify({action:"onItfUnSelection",itfId:n,actualIdsSelected:t}))}a.isDetailUICmdActivated&&(window.dscef.sendString(JSON.stringify({action:"stopDetailUICmd"})),a.isDetailUICmdActivated=!1)}}function V(){p&&(p.destroy(),p=null)}function N(e,t){if(0!==e.length){var n={items:e,id:"PimWiWMenu"+(t?"Row":"Columns"),target:document.body,contextual:!1,bound:!1,removeOnHide:!0,closeOnClick:!0,events:{onClickOutside:function(){this.hide(),V()}}};(p=new i(n))&&p.show()}}function D(){setTimeout(function(){window.dscef.sendString(JSON.stringify({action:"refreshCmd"}))},0)}function A(){window.dscef.sendString(JSON.stringify({action:"exploreToItfFinder",itfIds:c.getSelectedInterferences()}))}function E(){window.dscef.sendString(JSON.stringify({action:"multiRootOpen",itfIds:c.getSelectedInterferences()}))}function J(){var e=c.getLeafNodeIds(!1),t=c.exportAsCSV({onlySelectedRows:!1});window.dscef.sendString(JSON.stringify({action:"exportFiltered",itfIds:e,csvData:t,penVolInQuantCol:c.IsPenVolInQuantCol()}))}function U(){var e=c.getLeafNodeIds(!0),t=c.exportAsCSV({onlySelectedRows:!0});window.dscef.sendString(JSON.stringify({action:"exportSelected",itfIds:e,csvData:t,penVolInQuantCol:c.IsPenVolInQuantCol()}))}function P(){window.dscef.sendString(JSON.stringify({action:"centreGraph"}))}function T(){window.dscef.sendString(JSON.stringify({action:"onDetailUI"}))}function q(){window.dscef.sendString(JSON.stringify({action:"onGenerateIssue"}))}function F(){window.dscef.sendString(JSON.stringify({action:"onChangeAction"}))}function _(e,t){w=!1,V();let n=[];function i(e){if("SeparatorItem"===e.type)return null;var t={text:e.title};return e.state&&(t.disabled="selected"===e.state),e.action&&e.action.callback&&"customView"!==e.id&&(t.nativeHandler=function(){e.action.callback.call(e.action.this,{context:e.action.context}),window.dscef.sendString(JSON.stringify({action:"penVolInQuantCol",penVolInQuantCol:c.IsPenVolInQuantCol()}))}),e.action&&e.action.context&&"customView"===e.id&&(t.nativeHandler=function(){!function(e){parent.getcollectionView=function(){return e};var t=window.open("dsrtv://webapps/PIMwebUXinWin/PIMWiWItfListColumnCustomView.html","","width=505,height=505,top=150,left=300");t.focus(),window.dscef.sendString(JSON.stringify({action:"removeMinimizedBtn"})),parent.closePopUp=function(){t.close(),parent.document.removeEventListener("mousedown",parent.closePopUp)},parent.document.addEventListener("mousedown",parent.closePopUp)}(e.action.context)}),t}t.forEach(function(e){var t=i(e);e.submenu&&(t.items=[],Object.keys(e.submenu).forEach(function(n){var o=i(e.submenu[n]);o&&t.items.push(o)})),t&&n.push(t)}),e.isHeaderMenu?N(n,!1):window.dscef.sendString(JSON.stringify({action:"ctxMenu"}))}this.addInterferences=function(e){Object.keys(e).forEach(function(t){!function e(t){t.itfuid&&(t.originated&&(t.originated=new Date(t.originated)),t.modified&&(t.modified=new Date(t.modified)),s[t.itfuid]=t),t.hasOwnProperty("row")&&e(t.row),t.hasOwnProperty("children")&&Object.keys(t.children).forEach(function(n){t.children[n].hasOwnProperty("row")&&e(t.children[n])})}(e[t])}),c.updateInterferences(e),C(),window.dscef.sendString(JSON.stringify({action:"itfListRowBuildDone",penVolInQuantCol:c.IsPenVolInQuantCol()}))},this.refreshView=function(){c.updateDataGridView({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0})},this.isApplySlideShow=function(e){var t;if("onBeginCB"===e.action){var n=c.getVisibleRows(),i=(t=c.getSelectedRows())&&t.length?t.length>1?t[0]:t[0]+1:0;t.length?(window.dscef.sendString(JSON.stringify({action:"setSlideShowValues",inumVisibleRows:n,iselectedRowID:i})),R(i>0?i-1:0)):(R(0),window.dscef.sendString(JSON.stringify({action:"setSlideShowValues",inumVisibleRows:n,iselectedRowID:i+1}))),window.dscef.sendString(JSON.stringify({action:"onSlideShowBegin"}))}else if("onPreviousSlideCB"===e.action){R((t=c.getSelectedRows())&&t.length?t.length>1?t[0]:t[0]-1:0)}else if("onNextSlideCB"===e.action){var o=c.getSelectedRows();R(o&&o.length?o.length>1?o[0]:o[0]+1:0)}else"onFirstSlideCB"===e.action?R(0):"onLastSlideCB"===e.action?R(c.getNumberOfRows()-1):"onCloseCB"===e.action&&window.dscef.sendString(JSON.stringify({action:"onSlideShowEnd"}))},this.removeAllInterference=function(){s.length&&c.removeInterferences(),s.length=0,C()},this.performSelAfterCbChange=function(){window.dscef.sendString(JSON.stringify({action:"onItfSelection",itfId:r}))},this.getItfVisibleRows=function(){var e=[],n=[],i=[],o=c.getLeafNodeIds(),s=c.getColumns();if(s.length>0&&s.forEach(function(e){!1!==e.visibleFlag?(e.visibleFlag=void 0===e.visibleFlag||e.visibleFlag,n.push(e)):"itfQuantifier"!==e.dataIndex&&"itfPenVol"!==e.dataIndex&&"itfPenVec"!==e.dataIndex&&"itfMinDist"!==e.dataIndex&&i.push(e)}),o.length){let s;for(let n=0;n<o.length;n++){s=t.clone(c.getInternalChildInfo(o[n]),!0);for(const e of Object.keys(s))i.some(t=>t.dataIndex===e)&&delete s[e],"itfuid"===e&&(s[e]=s[e].toString(),s.isNonPersistentPIM=!0);e.push(s)}window.dscef.sendString(JSON.stringify({action:"visibleRows",itfIds:c.getSelectedInterferences(),visibleRows:e,columns:n}))}else window.dscef.sendString(JSON.stringify({action:"visibleRows",itfIds:[],visibleRows:[],columns:[]}))},this.selectItf=function(e){var t=[];Object.keys(e).forEach(function(n){"propogateCb"===n?f="true"===e[n]:t.push(e[n])}),c.selectRowsByUID(t),setTimeout(function(){f=!0},100)},this.wiwSyncJsFunc=function(e,t,n){var i={error:""};"getSelectedItfs"===e.func&&(i.success={func:"getSelectedItfs",nbSelItf:r.length,selItfList:r}),i.success?t(JSON.stringify(i.success)):n(JSON.stringify(i))},this.addInfoForItfList=function(e){if(e.isDetailedUICmdReq&&(a.detailedCmdReq=e.isDetailedUICmdReq),e.isRefreshCmdReq&&(a.isRefreshCmdReq=e.isRefreshCmdReq),e.isMultiRootCmdReq&&(a.isMultiRootCmdReq=e.isMultiRootCmdReq),e.isChgActionRequired&&(a.chgActionReq=e.isChgActionRequired),e.isGenIssueRequired&&(a.genIssueReq=e.isGenIssueRequired),e.isExportFilteredReq&&(a.isExportFilteredReq=e.isExportFilteredReq),e.isExportSelectedReq&&(a.isExportSelectedReq=e.isExportSelectedReq),e.centreGraphCmdReq&&(a.centreGraphCmdReq=e.centreGraphCmdReq),e.isExploreToItfFinderCmdReq&&(a.isExploreToItfFinderCmdReq=e.isExploreToItfFinderCmdReq),void 0!==e.toolTip&&(e.toolTip?(document.body.addEventListener("mouseover",x),document.body.addEventListener("mouseleave",v)):(document.body.removeEventListener("mouseover",x),document.body.removeEventListener("mouseleave",v))),e.newCodeVersion&&(u=!0),e.currentUnits&&(c.setUnits(e.currentUnits),c.updateInterferences(s)),e.relaunchPublishCmd)var t=[],n=!1,i=setInterval(function(){c&&(clearInterval(i),e.exppandCollpsedReq&&(t=c.expandOrCollapse(!0,!1,!1,!0)),setTimeout(function(){n||(n=!0,window.dscef.sendString(JSON.stringify({action:"exportFiltered",itfIds:c.getLeafNodeIds(!1),csvData:c.exportAsCSV({onlySelectedRows:!1}),penVolInQuantCol:c.IsPenVolInQuantCol()}))),e.exppandCollpsedReq&&c.expandOrCollapse(!1,!1,t,!1)},0))},0);e.buildAgainRowCtxMenu&&function(){let e=[];a.isRefreshCmdReq&&e.push({text:o.itfRefresh,nativeHandler:D}),a.isExploreToItfFinderCmdReq&&e.push({text:o.itfExploreToItfFinder,nativeHandler:A}),a.isMultiRootCmdReq&&e.push({text:o.itfMultiRootOpen,nativeHandler:E}),a.isExportFilteredReq&&e.push({text:o.itfExportFiltered,nativeHandler:J}),a.isExportSelectedReq&&e.push({text:o.itfExportSelected,nativeHandler:U}),a.centreGraphCmdReq&&e.push({text:o.itfCentreGraph,nativeHandler:P}),a.detailedCmdReq&&1===r.length&&(e.push({text:o.itfDetailComp,nativeHandler:T}),a.isDetailUICmdActivated=!0);var t=[];a.genIssueReq&&t.push({text:o.itfGenIssue,icon:"I_DMUIssue.png",nativeHandler:q}),a.chgActionReq&&t.push({text:o.itfChgAction,icon:"I_VALCA.png",nativeHandler:F}),0!==t.length&&e.push({text:2===t.length?o.itfTIC:o.itfTIC+" "+t[0].text,items:2===t.length?t:null,nativeHandler:2===t.length?null:function(){a.chgActionReq?window.dscef.sendString(JSON.stringify({action:"onChangeAction"})):window.dscef.sendString(JSON.stringify({action:"onGenerateIssue"}))}}),N(e,!0)}()},this.wiwOdtHelper=function(e){var t=setInterval(function(){window.dscef.sendString(JSON.stringify({action:"odtCallReceived"}));var n=c.getVisibleRows(),i=c.getSelectedRows();if(n||!s.length){var o=[],l=0;if(e.selectAll)e.NewDlg?c.selectOrUnselectAll(c.getSelectedRows().length!==c.getNumberOfRows()):o=Object.keys(s).map(function(){return l++});else if(e.rowSelect)try{o=(o=JSON.parse(e.rowSelect)).filter(function(e){return e<=n.length&&e>0}).map(function(e){return e-1})}catch(e){o=[]}if(o.length)if(e.NewDlg){if(e.selOrUnSel){var d=e.keepSelection&&-1!==i.indexOf(o[0]);c.selectOrUnselectRows(o,d?!d:e.selOrUnSel,e.keepSelection,e.shift)}}else c.selectRows(o);if(e.expandOrCollapse&&c.expandOrCollapse(!o.length||e.selectAll,0!==o.length&&o,!1,1===e.expandOrCollapse),e.dumpList){var a=c.exportAsCSV({onlySelectedRows:!1,allColumns:!0});window.dscef.sendString(JSON.stringify({action:"odtDumpList",dumpListData:a}))}setTimeout(function(){e.cellEditCombo&&e.cellEditVal&&r.length>0&&(r.forEach(function(t){c.updateModel(t,e.cellEditCombo,e.cellEditVal)}),c.updateDataGridView({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0})),"Refresh"===e.cxtCmd?D():"Export Filtered"===e.cxtCmd?J():"Export Selected"===e.cxtCmd?U():"Centre Graph"===e.cxtCmd?P():"Detailed Computation"===e.cxtCmd?T():"Explore with Interference Finder"===e.cxtCmd?A():"Multi Root Open"===e.cxtCmd?E():"Generate Issue"===e.cxtCmd?q():"Generate Change Action"===e.cxtCmd&&F()},10),clearInterval(t)}else window.dscef.sendString(JSON.stringify({action:"odtWait"}))},0)},function(e){if(!c){i=e.defCols,Object.keys(i).forEach(function(e){if("V_Itf_Analysis"!==e&&"V_Itf_User_Type"!==e&&"V_description"!==e&&"itfCtxName"!==e&&"itfUserType"!==e&&"V_Itf_Type"!==e&&"V_Itf_Previous_Analysis"!==e&&"originated"!==e&&"modified"!==e&&"tree"!==e&&"itfAnalysis"!==e)d[e]={dataIndex:e,text:i[e],width:"auto"},"itfLblOldInst1"!==e&&"itfLblOldInst2"!==e||(d[e].visibleFlag=!1);else{var t=l.indexOf(e);"V_Itf_Analysis"===e?l[t]="itfAnalysis":"V_Itf_User_Type"===e?l[t]="itfUserType":"V_Itf_Type"===e?l[t]="itfSystemType":"V_Itf_Previous_Analysis"===e?l[t]="itfPrevAnalysis":"pimNonPersistent"!==m||"itfAnalysis"!==e&&"itfUserType"!==e?"tree"===e&&"object"==typeof i[e]?(d[e]={dataIndex:i[e].dataIndex,text:i[e].text,visibleFlag:!i[e].visibleFlag||i[e].visibleFlag,typeRepresentation:i[e].typeRepresentation?i[e].typeRepresentation:"string",editableFlag:void 0===i[e].editableFlag||i[e].editableFlag},"double"===i[e].typeRepresentation&&S.push("label")):"originated"===e||"modified"===e?d[e]={dataIndex:e,text:i[e],typeRepresentation:"datetime",width:"auto"}:"V_description"===e&&(l[t]="itfDescription"):d[e]={dataIndex:e,visibleFlag:!1}}});var t={parent:document.body,suffix:m,cbDnD:{onDragStartColumnHeader:function(){return!0},onDragColumnHeader:function(){return!0},onDragOverColumnHeader:function(){return!0},onDragEnterColumnHeader:function(){return!0},onDragLeaveColumnHeader:function(){return!0},onDragEndColumnHeader:function(){return!0},onDropColumnHeader:function(){return!0}},defCols:d,deforder:l,readOnly:"pimPersistent"!==m&&"pimNonPersistent"!==m,isWebInWin:!0,units:I,filterCols:{addColswithNumber:"pimIdyClash"===m?["label"]:void 0,addColsWithSet:"pimNonPersistent"===m?["label"]:void 0}};(c=new n(t)).onSelect=b,c.onUnselect=O,c.onCellEdit=y,c.contextualEvent=_,window.dscef.sendString(JSON.stringify({action:"itfListColumnBuildDone"}))}var i}(e)}})});