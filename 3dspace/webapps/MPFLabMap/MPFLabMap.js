define("DS/MPFLabMap/ShopMarkerBuilder",["UWA/Core","UWA/Class","DS/Leaflet/LeafletLoader","css!DS/MPFUI/MPFUI"],function(e,t,a){"use strict";return t.extend({init:function(e,t){this.shop=e},build:function(){var e,t;return t=new a.Icon.Default,(e=a.marker([this.shop.getLatitude(),this.shop.getLongitude()],{icon:t})).bindPopup(this._createPopupBody(this.shop)).openPopup(),e.on("click",this._onClick.bind(this)),e},_onClick:function(){console.log("marker clicked: "+this.shop.getName())},_createPopupBody:function(){var t,a;return t=e.createElement("h4",{class:"mpf-title",text:this.shop.getName()}),a=e.createElement("div",{class:"mpf-img-container",html:[{tag:"img",class:"mpf-shop-logo",alt:"shop logo",src:this.shop.getLogo()}]}),e.createElement("div",{class:"mpf-marker-popup",html:[t,a]})}})}),define("DS/MPFLabMap/LabMap",["UWA/Class/View","DS/Leaflet/MPMapView","DS/MPFLabMap/ShopMarkerBuilder"],function(e,t,a){"use strict";return e.extend({className:"mpf-lab-map",setup:function(e){var a=this;this.map=new t({onCenterChangedCB:function(){e.onCenterChangedCB(a.map.getBounds()),a._updateClustersLayer()},onMapLoadedCB:this.render.bind(this),defaultZoom:e.defaultZoom}),this.markersLayer=new L.MarkerClusterGroup({chunkedLoading:!0,showCoverageOnHover:!1}),this.markers=[],this.map.loadMap()},render:function(){return this.container.setContent(this.map.getContent()),this.map.onShow(),this},setShopList:function(e){this.markers.forEach(function(e){this.map.removeMarker(e)},this),this.markers=e.map(function(e){return new a(e).build()},this),this.map._map.addLayer(this.markersLayer),this.markersLayer.addLayers(this.markers)},_updateClustersLayer:function(){this.markersLayer.clearLayers(),this.map._map.removeLayer(this.markersLayer),this.markersLayer=new L.MarkerClusterGroup({chunkedLoading:!0,showCoverageOnHover:!1}),this.map._map.addLayer(this.markersLayer),this.markersLayer.addLayers(this.markers)},updateMapWithNewListLab:function(e){this.markers.forEach(function(e){this.map.removeMarker(e)},this),this.markers=e.map(function(e){return new a(e).build()},this),this._updateClustersLayer()},setToDefaultPosition:function(){this.map.setMapPosition(this.map._defaultPosition)}})});