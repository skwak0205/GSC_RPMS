var RTProxyDriver=void 0,RTDriver=void 0,RTSettingController=void 0,webrtcCtrl=void 0,swymURL1=void 0;function initialize(e){require(["DS/RTProxyDriver/RTProxyDriver"],function(i){console.log(" **********************************************\ninitialize\n user_id :"+e+"\n **********************************************\n"),i.dispatch("CONNECTED",{user_id:e})})}function sendNotification(e,i){if("undefined"!=typeof CATCefSendString)CATCefSendString(e+"="+i);else{var n=document.createElement("textarea");n.setAttribute("name",e),n.appendChild(document.createTextNode(i));var r=document.createElement("form");r.setAttribute("method","POST"),r.setAttribute("action","jsnotif://"),r.appendChild(n),document.documentElement.appendChild(r),r.submit(),r.parentNode.removeChild(r),r=null}}function iceCandidateReceived(e,i,n){require(["DS/RTProxyDriver/RTProxyDriver"],function(r){console.log(" **********************************************\nwebrtcIceCandidateReceived\n user_id :"+i+"\n room_id: "+e+"\ncandidate :"+n+"\n **********************************************\n"),r.dispatch("webrtcIceCandidateReceived",{user_id:i,room_id:e,user:{user_id:i},candidate:{candidate:n}})})}function sdpReceived(e,i,n,r,o,t,d,s,a){require(["DS/RTProxyDriver/RTProxyDriver"],function(l){var c,u,m;"true"==o?c=!0:"false"==o&&(c=!1),"true"==t?u=!0:"false"==t&&(u=!1),"true"==d?m=!0:"false"==d&&(m=!1);var g=r.replace(/##r/g,"\r").replace(/##n/g,"\n");console.log(" **********************************************\nSDPReceived\n user.login :"+e+"\n user_id : "+i+"\n room_id : "+n+"\n SDP : "+g+"\n isCaller : "+c+"\n renegotiating : "+u+"\n secondSwitch : "+m+"\n SDPType : "+s+"\n user_from : "+a+"\n **********************************************\n"),l.dispatch("SDPreceived",{user_id:i,room_id:n,sdp:{type:s,sdp:g},isCaller:c,user:{login:e,user_id:i},renegotiating:u,secondSwitch:m,userFrom:a})})}function incomingCallNotification(e,i,n,r,o,t){require(["DS/RTProxyDriver/RTProxyDriver"],function(d){d.dispatch("inviteToCall",{type:t,user_id:e,room_id:i,error:"",room:{room_id:i},user:{login:n,user_id:e,email:r,username:o}})})}function inviteSentNotification(e,i,n,r,o,t,d){require(["DS/RTProxyDriver/RTProxyDriver"],function(s){var a;"true"==d?a=!0:"false"==d&&(a=!1),console.log(" **********************************************\ninviteSentNotification\n isCaller :"+a+"\n callType :"+t+"\n user_id :"+e+"\n room_id :"+i+"\n user_login :"+n+"\n user_username :"+o+"\n **********************************************\n"),s.dispatch("inviteSent",{isCaller:a,type:t,user_id:e,room_id:i,error:"",room:{room_id:i},user:{login:n,user_id:e,email:r,username:o}})})}function callAccepted(e,i,n,r,o,t,d,s,a,l){require(["DS/RTProxyDriver/RTProxyDriver"],function(c){var u;console.log(" **********************************************\ncallAccepted\n isCaller :"+u+"\n type : "+d+"\n user_id : "+t+"\n room_id : "+o+"\n STUN_URL : "+a+"\n TURN_URL : "+l+"\n user_login : "+e+"\n user_username : "+r+"\n **********************************************\n"),"true"==s?u=!0:"false"==s&&(u=!1),c.dispatch("callAccepted",{isCaller:u,type:d,user_id:t,room_id:o,room:{room_id:o},user:{login:e,user_id:i,email:n,username:r},webrtcConfig:{iceServers:[{url:a},{url:l,username:"rtcoturn",credential:"rtcoturntigase"}]}})}),webrtcCtrl.onCallComponents.addEventToView("minimizeNWAY",this.minimize),webrtcCtrl.onCallComponents.addEventToView("maximizeNWAY",this.maximize)}function minimize(){console.log("Inside Minimize"),sendNotification("minimize")}function maximize(){console.log("Inside Maximize"),sendNotification("maximize")}function callEnded(e,i){require(["DS/RTProxyDriver/RTProxyDriver"],function(n){console.log(" **********************************************\ncallEnded\n user_Id :"+e+"\n room_Id :"+i+"\n **********************************************\n"),n.dispatch("callEnded",{user_id:e,room_id:i,room:{room_id:i},user:{user_id:e}})})}require(["DS/RTProxyDriver/RTProxyDriver"],function(e){this.endCallListener=function(e){console.log("inside end call listener");var i=JSON.stringify(e),n=JSON.parse(i),r=n.reason;null==r&&(r=""),sendNotification("EndCall",n.room_id+","+r),console.log(" **********************************************\nendCallListener\n room_id :"+n.room_id+"\n **********************************************\n")},e.addEvent("endCall",this.endCallListener),this.callAcceptedListener=function(e){console.log("inside call Accepted listener");var i=JSON.stringify(e),n=JSON.parse(i);sendNotification("acceptCall",n.room_id+","+n.type+","+n.user_id),console.log(" **********************************************\ncallAcceptedListener\n room_id :"+n.room_id+"\n callType :"+n.type+"\n user_id :"+n.user_id+"\n **********************************************\n")},e.addEvent("acceptCall",this.callAcceptedListener),this.SDPListener=function(e){console.log("inside SDP listener");var i=JSON.stringify(e),n=JSON.parse(i),r=n.renegotiating,o=n.secondSwitch;null==r&&(r=!1),null==o&&(o=!1),sendNotification("SDP",n.user_id+","+n.room_id+","+n.sdp.sdp+","+n.isCaller+","+n.sdp.type+","+r+","+o),console.log(" **********************************************\nSDPListener\n room_id :"+n.room_id+"\n sdp :"+n.sdp.sdp+"\n user_id :"+n.user_id+"\nisCaller : "+n.isCaller+"\nsdpType : "+n.sdp.type+"\nrenegotiating : "+r+"\nsecondSwitch : "+o+"\n **********************************************\n")},e.addEvent("SDP",this.SDPListener),this.ICECandidateListener=function(e){console.log("inside ICE Candidate listener");var i=JSON.stringify(e),n=JSON.parse(i),r=n.renegotiating;null==r&&(r=!1),sendNotification("webrtcIceCandidate",n.user_id+","+n.room_id+","+n.candidate.candidate+","+n.candidate.sdpMid+","+n.candidate.sdpMLineIndex+","+r),console.log(" **********************************************\nICECandidateListener\n room_id :"+n.room_id+"\n user_id :"+n.user_id+"\ncandidate : "+n.candidate.candidate+"\nrenegotiating : "+r+"\n **********************************************\n")},e.addEvent("webrtcIceCandidate",this.ICECandidateListener)});var loadWidget=function(e,i,n){require(["DS/MessageBus/MessageBus","UWA/Drivers/Alone","DS/InstantMessagingWebRTC/InstantMessagingWebRTC","DS/RTProxyDriver/RTProxyDriver","DS/InstantMessagingWebRTC/js/view/RTCallingComponentView"],function(r,o,t,d,s){null==RTProxyDriver&&(RTProxyDriver=d),webrtcCtrl=new t({appName:"",passportUrl:"",topBarId:"",messaging:void 0,userName:"",tenants:{},url:e,platformId:"",swymUrl:i,doLogRTC:!1,ringtoneURL:n})})};"undefined"!=typeof widget?(widget.addEvent("onLoad",function(){sendNotification("LoadWidget",null)}),widget.addEvent("onRefresh",function(){document.location.reload()})):require(["UWA/Drivers/Alone"],function(e){sendNotification("LoadWidget",null)});