define("DS/ENOChgServices/scripts/services/ChgLocalStorage",[],function(){"use strict";return{_appKey:void 0,_prefStructure:void 0,_contextUser:void 0,initialize:function(e){var t;(this._appKey=e.appKey,this._prefStructure=e.prefStructure,this._contextUser=e.contextUser,window.localStorage.getItem(this._appKey))?(t=JSON.parse(window.localStorage.getItem(this._appKey))).hasOwnProperty(this._contextUser)||(t[this._contextUser]=this._prefStructure,window.localStorage.setItem(this._appKey,JSON.stringify(t))):((t={})[this._contextUser]=this._prefStructure,window.localStorage.setItem(this._appKey,JSON.stringify(t)))},destroy:function(){window.localStorage.removeItem(this._appKey)},getLocalStorageValue:function(e){try{if(window.localStorage.getItem(this._appKey)){var t=JSON.parse(window.localStorage.getItem(this._appKey));return t.hasOwnProperty(this._contextUser)?t[this._contextUser][this._appKey][e]:void 0}return}catch(e){return void console.error(e)}},updateLocalStorageValue:function(e,t){try{if(window.localStorage.getItem(this._appKey)){var n=JSON.parse(window.localStorage.getItem(this._appKey));n.hasOwnProperty(this._contextUser)&&(n[this._contextUser][this._appKey][e]=t,window.localStorage.setItem(this._appKey,JSON.stringify(n)))}}catch(e){console.error(e)}}}}),define("DS/ENOChgServices/scripts/services/ChgWidgetPreferencesManager",[],function(){"use strict";return{_appKey:void 0,_prefStructure:void 0,initialize:function(e){this._appKey=e.appKey,this._prefStructure=e.prefStructure,widget.getValue(this._appKey)||widget.setValue(this._appKey,JSON.stringify(this._prefStructure))},updateWidgetPreference:function(e,t){try{var n=widget.getValue(this._appKey);if(n){var i=JSON.parse(n);i[this._appKey][e]=t,widget.setValue(this._appKey,JSON.stringify(i))}}catch(e){console.error(e)}},getWidgetPreference:function(e){try{var t=widget.getValue(this._appKey);return t?JSON.parse(t)[this._appKey][e]:void 0}catch(e){return void console.error(e)}}}}),define("DS/ENOChgServices/scripts/factories/ChangeRequestFactory",["UWA/Core","UWA/Class","UWA/Class/Debug","UWA/Class/Events"],function(e,t,n,i){"use strict";return t.extend(n,i,{init:function(e){console.log(e),alert("In Change Request")},loadWidget:function(){console.log("load Change Request Widget")}})}),define("DS/ENOChgServices/scripts/components/ChgCommonSelectDailog",["UWA/Class/View","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button"],function(e,t,n,i){"use strict";return{launchInfoDailog:function(e){var a=this;console.log("Inside launchInfoDailog >>>>>>>>>>>>>> "+e);var r=e.title,o=e.content,s=e.target;this.buttons=[],e.buttonArray.forEach(function(e){var t=new i({label:e.label,className:e.className,onClick:function(t){e.handler()}});a.buttons.push(t)}),this.immersiveFrame=new t({}),this.myDialog=new n({id:"myinfoDialogId",class:"myinfoclass",immersiveFrame:this.immersiveFrame,title:r,content:o,resizableFlag:!1,modalFlag:!0,height:100,width:400,buttons:{Yes:this.buttons[0],No:this.buttons[1]}}),this.myDialog.addEventListener("close",function(){a.closeDialog()}),this.immersiveFrame.inject(s)},closeDialog:function(){this.myDialog.destroy(),this.immersiveFrame.destroy()}}}),define("DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable",["UWA/Class"],function(e){"use strict";return e.singleton({getIconMap:function(){return this.iconMap},setIconMap:function(e){this.iconMap=e},getPreviewURLArray:function(){return this.previewURLArray},setPreviewURLArray:function(e){this.previewURLArray=e},getGlobalVariable:function(){return this.enoviaCAGlobalVariable||this.setGlobalVariable(),this.enoviaCAGlobalVariable},setGlobalVariable:function(){this.enoviaCAGlobalVariable={serviceName:"3DSpace",tenantMappings:void 0,baseURL:"",swymURL:"",compassURL:"",InterCom:UWA.Utils.InterCom,compassSocket:null,prefIntercomServer:null,compassSocketName:"",prefSocketName:"",arrOid:[],timezone:(new Date).getTimezoneOffset(),wsCallTimeout:12e6,mySecurityContext:"",proxy:window.UWA.Data.proxies.passport?"passport":"ajax",myRole:"",contextUser:"",isNative:!1,isPoweredBy:null,is3DSpace:!1,fromIDCard:!1,referentialsSearchType:"",contextSearchType:"",proposedSearchType:"",datamodel:"new",project_space:"",organization:"",mySkeleton:null,PropWidget:null,NamePref:"Title",ViewPref:"Grid",UXPref:"New",lastSelectedInfoType:"",frameWorkName:"ENOChangeActionUX",TaggerInNative:!0,TriggerCustomeUpdate:!0,CHG_FLOWDOWN:"false",CHG_CHANGE_MATURITY:"false",CHG_CHANGE_SUMMARY_GRID:"false",CHG_OPEN_WITH_COLLAB:"false",CHG_CREATE_CA_AUTO_PROMOTE:"false",CHG_OPENWITH:"false",CHG_CA_VIEWS_ENHANCEMENT:"false",CHG_CHANGE_GROUP:"false",CHG_TRANSFER_REALIZED_CUST_TYPE:"false",CHG_CHANGE_REQUEST:"true",CHG_IA_CUSTOM_VIEW:"true",CHG_IA_COLUMN_ASSESSMENT:"true",CHG_NATIVE_BREADCRUMB:"false",ECMEnableDefaultChangeAnalysis:"false",CHG_OLD_CA_CREATE:"false",indexMode:"true",indexCRMode:"true",isChangeAvailable:!1,supportedOperationMap:new Object,slidePanelTagger:"false",isFullLicence:"false",isLiteLicence:"false",get3DSpaceURL:function(){return this.baseURL},getSwymURL:function(){return this.swymURL},getCompassURL:function(){return this.compassURL},computeUrl:function(e){return this.get3DSpaceURL()+e},computeSwymUrl:function(e){return this.getSwymURL()+e},getSecurityContext:function(){return this.mySecurityContext},getRole:function(){return this.myRole},collabspace:"",tenant:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",tenantnls:"",existingCAIds:null,existingCOIds:[],newlyAssignCAIds:null,changeActionSubTypePresent:!1,changeAnalysisSubTypePresent:!1,changeOrderSubTypePresent:!1,changeRequestSubTypePresent:!1,subTypePresent:!1,subTypes:null,changeActionSubTypes:null,changeAnalysisSubTypes:null,changeOrderSubTypes:null,changeRequestSubTypes:null,ENO_CSRF_TOKEN:"",compassWindow:window.parent}}})}),define("DS/ENOChgServices/scripts/factories/ChangeOrderFactory",["UWA/Core","UWA/Class","UWA/Class/Debug","UWA/Class/Events"],function(e,t,n,i){"use strict";return t.extend(n,i,{init:function(e){console.log(e),alert("In Change Order")},loadWidget:function(){console.log("load Change Order Widget")}})}),define("DS/ENOChgServices/scripts/services/ChgErrors",["DS/UIKIT/Alert"],function(e){"use strict";return{error:function(e){this.message(e,"error")},message:function(t,n,i){null!=this.alertCA&&(this.alertCA.hide(),this.alertCA.destroy());var a=!0;("error"==n||i&&"false"===i)&&(a=!1),this.alertCA=new e({closable:!0,visible:!0,autoHide:a,hideDelay:5e3,className:"wp-alert"}).inject(document.body,"top"),this.alertCA.add({className:n,message:t})},success:function(e){this.message(e,"success")},warn:function(e,t){this.message(e,"warning",t)},info:function(e){this.message(e,"primary")}}}),define("DS/ENOChgServices/scripts/services/ChgInfodialog",["UWA/Class/View","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button"],function(e,t,n,i){"use strict";return{launchInfoDailog:function(e){var a=e.title,r=e.content;r="<span class='fonticon fonticon-wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-attention iconAlert'></span>"+r,this.buttons=[];var o=this;e.buttonArray.forEach(function(e){var t=new i({label:e.label,className:e.className,onClick:function(t){e.handler()}});o.buttons.push(t)}),this.immersiveFrame=new t({}),this.myDialog=new n({id:"myinfo",class:"myinfoclass",immersiveFrame:this.immersiveFrame,title:a,content:r,activeFlag:!1,resizableFlag:!0,height:150,width:400,buttons:{Yes:this.buttons[0],No:this.buttons[1]}}),this.immersiveFrame.inject(widget.body),this.myDialog.addEventListener("close",function(e){o.immersiveFrame.remove()})},closeDialog:function(){this.myDialog.close()}}}),define("DS/ENOChgServices/scripts/components/ChgCommonDailog",["DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button","DS/Controls/Editor","i18n!DS/ENOChgServices/assets/nls/ChgServiceNLS"],function(e,t,n,i,a){"use strict";return{launchInfoDailog:function(r){var o=r.boxTitle,s=(r.subTitle,r.btnId),l=(r.chgPhysicalId,r.chgType);this.buttons=[];var c=this,u=[{label:a.CHG_Done_Button_Label,handler:r.DoneCallback,className:"primary",disabled:"true"},{label:a.CHG_CANCEL_Button_Label,handler:r.CancelCallback,className:"default"}],d="";u.forEach(function(e){var t=new n({label:e.label,className:e.className,disabled:e.disabled,onClick:function(n){if(t&&a.CHG_Done_Button_Label==t.label){var i={chgPhysicalId:r.chgPhysicalId,btnId:s,chgType:l,userComment:h.value};e.handler(i)}else e.handler(s)}});c.buttons.push(t),t&&a.CHG_Done_Button_Label==t.label&&(d=t)});var p=new e({}),g=new UWA.Element("div");g.id="contentDiv";var f=new UWA.Element("div");f.id="divheader";var m=new UWA.Element("label");m.setText(r.subTitle),m.inject(f);var h=new i({placeholder:r.txtPlaceHolder,requiredFlag:!0,widthInCharNumber:80,nbRows:3,newLineMode:"enter"});h.addEventListener("change",function(e){d&&(h.value?d.disabled=!1:d.disabled=!0)}),h.addEventListener("uncommittedChange",function(){d&&(""!=h.valueToCommit?d.disabled=!1:d.disabled=!0)});var v=new UWA.Element("div");v.id="divEditor",h.inject(v),g.appendChild(f),g.appendChild(v),this.CAUpdateDialog=new t({id:"updateCA",immersiveFrame:p,title:o,content:g,activeFlag:!1,resizableFlag:!0,height:160,width:470,buttons:{Yes:this.buttons[0],No:this.buttons[1]}}),p.inject(widget.body),this.CAUpdateDialog.addEventListener("close",function(e){c.CAUpdateDialog.immersiveFrame.remove()})},closeDialog:function(){this.CAUpdateDialog.close()}}}),define("DS/ENOChgServices/scripts/components/ChgCommonCreateDialog",["DS/Controls/Button","DS/Controls/Editor","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","css!DS/ENOChgServices/ENOChgServices"],function(e,t,n,i){"use strict";return{launchCreateChangeOrderDialog:function(a){this.buttons=[];var r=this,o="";a.buttonArray.forEach(function(t){var n=new e({label:t.label,className:t.className,disabled:t.disabled,checkFlag:t.checkFlag,onClick:function(e){var n={titleText:s.value,DescText:l.value};t.handler(n)}});0==r.buttons.length?(n.value="Primary",r.buttons.push(n)):r.buttons.push(n),n&&"Primary"==n.value&&(o=n)});var s=new t({placeholder:a.TitlePlaceHolder,requiredFlag:!0,widthInCharNumber:80,nbRows:1,newLineMode:"enter"}),l=new t({placeholder:a.DescriptionPlaceHolder,requiredFlag:!1,widthInCharNumber:80,nbRows:3,newLineMode:"enter"});s.addEventListener("change",function(e){o&&(s.value?o.disabled=!1:o.disabled=!0)}),s.addEventListener("uncommittedChange",function(){o&&(""!=s.valueToCommit?o.disabled=!1:o.disabled=!0)});var c=new n({}),u=new UWA.Element("div");u.id="commonContentDiv";var d=new UWA.Element("label");d.setText(a.TitleLabel);var p=new UWA.Element("label");p.setText(a.DescriptionLabel);var g=new UWA.createElement("div",{id:"Titlecontainer"}),f=new UWA.createElement("div",{id:"DescrContainer"});g.appendChild(d),s.inject(g),f.appendChild(p),l.inject(f),g.inject(u),f.inject(u),this.CAUpdateDialog=new i({id:"updateCA",immersiveFrame:c,title:a.boxTitle,content:u,activeFlag:!1,resizableFlag:!0,modalFlag:!0,height:240,width:470,buttons:{Yes:this.buttons[0],No:this.buttons[1]}}),c.inject(widget.body)},closeDialog:function(){this.CAUpdateDialog.close()}}}),define("DS/ENOChgServices/scripts/services/ChgPropertiesServices",["UWA/Core","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/EditPropWidget/EditPropComponent","DS/EditPropWidget/constants/EditPropConstants","DS/EditPropWidget/models/EditPropModel","i18n!DS/ENOChgServices/assets/nls/ChgServiceNLS"],function(e,t,n,i,a,r){"use strict";var o={createPropertiesComponent:function(e){this.caEditComp=new n({typeOfDisplay:i.ALL,selectionType:i.ALL_SELECTION,displayType:i.POPUP,setCloseButton:!1,readOnly:this.getPropertyAccess(),extraNotif:!1,editMode:!1});var r=[];if(Array.isArray(e))r=e.map(e=>new a({tenant:t.getGlobalVariable().tenant,objectId:e}));else{var o=e,s=new a({tenant:t.getGlobalVariable().tenant,objectId:o});r.push(s)}this.caEditComp.show(r)},getPropertyAccess:function(){return"ChangeOrder"==t.getGlobalVariable().lastSelectedInfoType&&"false"==t.getGlobalVariable().isFullLicence},getPropertiesComponent:function(){return this.caEditComp},createPropertyPushItem:function(e){return{type:"PushItem",title:r.CHG_Properties_Menu,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-attributes"},action:{callback:function(){o.createPropertiesComponent(e)}}}}};return o}),define("DS/ENOChgServices/scripts/services/ChgApplicationPreferencesManager",["UWA/Class","DS/ENOChgServices/scripts/services/ChgLocalStorage","DS/ENOChgServices/scripts/services/ChgWidgetPreferencesManager","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable"],function(e,t,n,i){"use strict";return e.singleton({init:function(){var e=i.getGlobalVariable();this.contextUser=e.contextUser},initialize:function(e,i,a,r){var o={};o.appKey=e,o.prefStructure=i,o.contextUser=this.contextUser,this._withWidgetPreferences=a,this._withLocalStorage=r,a&&n.initialize(o),r&&t.initialize(o)},updatePreference:function(e,i){this._withWidgetPreferences&&n.updateWidgetPreference(e,i),this._withLocalStorage&&t.updateLocalStorageValue(e,i)},getPreference:function(e){return this._withWidgetPreferences&&null!=n.getWidgetPreference(e)?n.getWidgetPreference(e):this._withLocalStorage?t.getLocalStorageValue(e):void 0}})}),define("DS/ENOChgServices/scripts/services/ChgApplicabilityServices",["UWA/Core","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable"],function(e,t){return{getApplicabilityExpression:function(e){"use strict";var t=!1;if(e&&""===e.expressionXML)t=!0;else if(e&&""!=e.expressionXML){var n=(new DOMParser).parseFromString(e.expressionXML,"text/xml").getElementsByTagName("Expression");if(n.length>0){for(var i=[],a=n[0].getElementsByTagName("Context"),r=0;r<a.length;r++){var o=a[r];if(o){var s=o.textContent;"false"===s&&i.push(s)}}a.length===i.length&&(t=!0)}}return t},refreshApplicabilityView:function(e){require(["DS/CfgEvolutionUX/CfgEvolutionLayoutFactory"],function(n){for(var i=document.querySelector("#FacetDivForApplicabilityContext");i&&i.hasChildNodes();)i.removeChild(i.lastChild);var a=t.getGlobalVariable().isNative?"Native":"Dashboard",r={mode:"Applicability",objectid:e.replace("pid:",""),parent:i,environment:a};r.tenant=t.getGlobalVariable().tenant,r.parent&&n.create(r)})}}}),define("DS/ENOChgServices/scripts/services/ChgNativeInitService",["DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable"],function(e){"use strict";return{DispatchEventToWin:function(t,n){if(e.getGlobalVariable().isNative||"Work_Under"==t&&e.getGlobalVariable().isPoweredBy){var i=window.dscef;if(void 0!==i)"function"==typeof i.sendString&&i.sendString(t+"="+n);else if("undefined"!=typeof CATCefSendString)CATCefSendString(t+"="+n);else{var a=document.createElement("textarea");a.setAttribute("name",t),a.appendChild(document.createTextNode(n));var r=document.createElement("form");r.setAttribute("method","POST"),r.setAttribute("action","jsnotif://"),r.appendChild(a),document.documentElement.appendChild(r),r.submit(),r.parentNode.removeChild(r),r=null}}},getWebInWinParameters:function(t){window.COMPASS_CONFIG&&window.COMPASS_CONFIG.myAppsBaseUrl?t(window.COMPASS_CONFIG):this.getMyappsUrl(function(n){window.COMPASS_CONFIG||(window.COMPASS_CONFIG={}),n&&(window.COMPASS_CONFIG.myAppsBaseUrl=n,window.COMPASS_CONFIG.userId||(window.COMPASS_CONFIG.userId=e.getGlobalVariable().contextUser),window.COMPASS_CONFIG.lang||(window.COMPASS_CONFIG.lang=widget.lang)),t(window.COMPASS_CONFIG)})},getMyappsUrl:function(e){this.isNatifEnvironnement()&&"function"==typeof dscef.getMyAppsURL?dscef.getMyAppsURL().then(function(t){console.log("MyApps URL",t),e.call(null,t)}).catch(function(t){console.error("Failed to fetch MyApps URL: "+t),e.call(null,null)}):e.call(null,null)},isNatifEnvironnement:function(){return"undefined"!=typeof dscef},takeOffFromWorkUnder:function(){this.DispatchEventToWin("Work_Under","FALSE")}}}),define("DS/ENOChgServices/scripts/services/ChgInfraService",["DS/Foundation/WidgetUwaUtils","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/ENOChgServices/scripts/services/ChgErrors","DS/WAFData/WAFData","i18n!DS/ENOChgServices/assets/nls/ChgServiceNLS","DS/UIKIT/Mask","DS/PlatformAPI/PlatformAPI","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/UIKIT/Input/Text","DS/UIKIT/Input/Button","DS/UIKIT/Dropdown"],function(e,t,n,i,a,r,o,s,l,c,u,d,p,g,f){"use strict";var m={URL:null,_SCPreferred:null,_theListSC:null,_theListSC_NLS:null,_SCPreferredDB:null,init:function(){e.setupEnoviaServer(),this.caGlobalObject=s.getGlobalVariable(),this.caGlobalObject||(s.setGlobalVariable(),this.caGlobalObject=s.getGlobalVariable()),this.caGlobalObject.isPoweredBy=this.IsPoweredBy(),this.caGlobalObject.nativeURL=document.location.href},setInfraValue:function(){var e=this;return new Promise(function(t,n){if(!widget.id){var i=Math.random();i.toString(36);var a=i.toString(36).substr(2,9);widget.id="ChangeMgt"+a}window.enoviaServer.widgetName="ChangeActionManagement",window.enoviaServer.widgetId=window.widget.id,window.enoviaServer.tenant=widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",e.caGlobalObject.tenant=widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise";var r="wdg_"+(new Date).getTime();if(e.setupIntercomConnections.call(e,widget,e.caGlobalObject,r),"undefined"==typeof dscef||e.caGlobalObject.isPoweredBy){var l=o.getUser();l&&(e.caGlobalObject.contextUser=l.login),m.populate3DSpaceURL().then(function(e){m.caSubTypesFetched().then(function(e){m.PopulatePreferences().then(function(e){m.populateSecurityContext().then(function(e){m.getSearchForbiddenTypes(),m.getSearchTypes().then(function(e){let i="";i="true"==s.getGlobalVariable().is3DSpace?"WebApp":"ENOWCHA_AP"==widget.getValue("appId")?"CExecution":"CGovernance",m.getLicenceAccess(i).then(function(e){s.getGlobalVariable().isFullLicence=e.data[0].IsFullLicense,s.getGlobalVariable().isLiteLicence=e.data[0].IsLiteLicense,t()},function(e){n(e)})},function(e){n(e)})},function(e){n(e)})},function(e){n(e)})},function(e){n(e)})},function(e){n(e)})}else{e.initializeForNative(function(e){t(e)})}})},fetchSubTypes:function(e){var t=this;t.makeWSCall("/resources/dictionary/getTypeInfo","POST","enovia","application/json",'["Change Action"]',function(n){if(Object.keys(n).length>1){t.caGlobalObject.changeActionSubTypes=[];var i=[];Object.keys(n).forEach(function(e){var n=t.fetchNLSForSubType(e);i.push(n)}),Promise.all(i).then(function(){t.caGlobalObject.changeActionSubTypePresent=!0;var n=[],i=0;Object.keys(t.caGlobalObject.changeActionSubTypes).forEach(function(e){var a=t.caGlobalObject.changeActionSubTypes[e];n[i]={label:a,value:e},i++}),n.sort(function(e,t){return e.label.toUpperCase()>t.label.toUpperCase()?1:-1}),t.caGlobalObject.changeActionSubTypes=n,null!=e&&e()})}else if(1==Object.keys(n).length){var a=Object.keys(n),r={};r[a[0]]=a[0],t.caGlobalObject.changeActionSubTypePresent=!1,t.caGlobalObject.changeActionSubTypes=[],t.caGlobalObject.changeActionSubTypes.push(r),null!=e&&e()}else null!=e&&e()},function(n){t.caGlobalObject.changeActionSubTypePresent=!1,null!=e&&e()},!0)},fetchNLSForSubType:function(e){var t=this;return new Promise(function(n,i){var a="/resources/dictionary/class/"+e+"/attributes";t.makeWSCall(a,"GET","enovia","application/json","",function(i){UWA.is(i.NLSName)&&""!=i.NLSName?t.caGlobalObject.changeActionSubTypes[e]=i.NLSName:t.caGlobalObject.changeActionSubTypes[e]=e,n()},function(i){t.caGlobalObject.changeActionSubTypes[e]=e,n()},!0)})},IsPoweredBy:function(){var e={},t=document.createElement("a");t.href=location.href;for(var n=t.search.substring(1).split("&"),i=0;i<n.length;i++){var a=n[i].split("=");e[a[0]]=decodeURIComponent(a[1])}return!(!e.widgetDomain||!(e.widgetDomain.search("catiav5")>=0||e.widgetDomain.search("solidworks")>=0))},populate3DSpaceURL:function(e){var n=this;return new Promise(function(i,a){var r=null;e&&((r={}).myAppsBaseUrl=e.myAppsBaseUrl,r.userId=e.userId,r.lang=e.lang),t.getPlatformServices({config:r,onComplete:function(e){for(var t=0;t<e.length;t++){if(n.caGlobalObject&&(n.caGlobalObject.tenantMappings=e,n.caGlobalObject.tenant==e[t].platformId)){n.caGlobalObject.baseURL=e[t]["3DSpace"],n.caGlobalObject.federatedURL=e[t]["3DSearch"],n.caGlobalObject.swymURL=e[t]["3DSwym"],n.caGlobalObject.compassURL=e[t]["3DCompass"],n.caGlobalObject.dashboardURL=e[t]["3DDashboard"];var a=n.caGlobalObject.swymURL;n.caGlobalObject.isSwymInstalled=null!=a}if(n.caGlobalObject=s.getGlobalVariable(),n.caGlobalObject&&n.caGlobalObject.tenant==e[t].platformId){n.caGlobalObject.baseURL=e[t]["3DSpace"],n.caGlobalObject.federatedURL=e[t]["3DSearch"],n.caGlobalObject.swymURL=e[t]["3DSwym"],n.caGlobalObject.compassURL=e[t]["3DCompass"],n.caGlobalObject.dashboardURL=e[t]["3DDashboard"];a=n.caGlobalObject.swymURL;n.caGlobalObject.isSwymInstalled=null!=a}}i()},onFailure:a})})},populateSecurityContext:function(){var e=this;return new Promise(function(t,i){var r=widget.getValue("SC");if(null!=r&&null!=r&&""!=r){var o="ctx::"+r;e.caGlobalObject.mySecurityContext=o,o=o.replace("ctx::",""),e.caGlobalObject.myRole=o.substring(0,o.indexOf(".")),window.enoviaServer.myRole=o.substring(0,o.indexOf(".")),e.caGlobalObject.collabspace=o.substring(o.lastIndexOf(".")+1,o.length),t(o)}else e.makeWSCall("/resources/pno/person/getsecuritycontext","GET","enovia","application/json","",function(i){if((o=i.SecurityContext)&&null!=o){if(null!=i&&""!=i&&i.hasOwnProperty("SecurityContext")){var r="";0!=i.SecurityContext.indexOf("ctx::")&&(r="ctx::"),o=r+i.SecurityContext}console.log("Setting security Context: "+o),e.caGlobalObject.mySecurityContext=o,o=o.replace("ctx::",""),UWA.is(window.enoviaServer)&&(window.enoviaServer.context=o),e.caGlobalObject.myRole=o.substring(0,o.indexOf(".")),window.enoviaServer.myRole=o.substring(0,o.indexOf(".")),e.caGlobalObject.collabspace=o.substring(o.lastIndexOf(".")+1,o.length),t(i)}else n.error(a.ECM_CA_Use_Preferences)},i,!0)})},PopulatePreferences:function(){return new Promise(function(e,t){var n=""!=widget.getValue("x3dPlatformId")&&"OnPremise"!=widget.getValue("x3dPlatformId");let i,a=s.getGlobalVariable().changeActionSubTypes;var r=[],o=m.PopulateViewPreferences(),l=m.PopulateSCPreferences();if(n){var c=m.populateTenantPreferences();r.push(l,c,o)}else r.push(l,o);a.length>1&&(i=m.populateChangeActionTypePreferences(a),r.push(i)),Promise.all(r).then(function(t){if(n&&widget.addPreference(t[1].TenantPreference),m.ComputeList(t[0].collabspacesDetails),a.length>1){let e=t.length-1;widget.addPreference(t[e].changeActionSubTypes),null==widget.getValue("DefaultCASubType")&&widget.setValue("DefaultCASubType","Change Action")}e("success")})})},PopulateViewPreferences:function(){var e=a.CHG_CA_Pref_View_Label,t=a.CHG_CA_Pref_Grid_Label,n=a.CHG_CA_Pref_Tile_Label,i={name:"ViewMode",type:"list",label:e,options:[]};return new Promise(function(e,a){i.options.push({value:"Grid",label:t}),i.options.push({value:"Tile",label:n});var r={};r.ViewPreference=i,e(r)})},PopulateSCPreferences:function(){return m._SCPreferredDB="",m._SCPreferred="",new Promise(function(e,t){m.makeWSCall("/resources/modeler/pno/person?current=true&select=collabspaces&select=preferredcredentials","GET","enovia","application/json","",function(t){var n={};n.collabspacesDetails=t,e(n)},t)})},populateChangeActionTypePreferences:function(e){let t={name:"DefaultCASubType",type:"list",label:a.CHG_CA_Pref_Default_SubType_Label,options:[]};return new Promise(function(n,i){for(let n=0;n<e.length;n++)t.options.push({value:e[n].value,label:e[n].label});let a={};a.changeActionSubTypes=t,n(a)})},getExpressionValue:function(){var e=this;return new Promise(function(t,n){m.makeWSCall("/resources/v2/e6w/service/ExpresssionSearch/CHG*,ECM*","GET","enovia","application/json","",function(n){var i=["CHG_CHANGE_MATURITY","CHG_OPEN_WITH_COLLAB","CHG_CREATE_CA_AUTO_PROMOTE","CHG_ADD_MASS_PROPOSED","CHG_CA_VIEWS_ENHANCEMENT","CHG_CHANGE_GROUP","CHG_TRANSFER_REALIZED_CUST_TYPE","CHG_IA_COLUMN_ASSESSMENT","CHG_IA_CUSTOM_VIEW","CHG_IA_COLUMN_ASSESSMEN","ECMEnableDefaultChangeAnalysis","CHG_NATIVE_BREADCRUMB"];n&&n.data&&n.data.forEach(function(t){if(t.dataelements){var n=Object.keys(t.dataelements);for(var a in n)i.indexOf(n[a])>=0&&t.dataelements&&(e.caGlobalObject[n[a]]=t.dataelements[n[a]])}}),t()},n,!0)})},onPnORetrieve:function(e){if(e){var t=a.ECM_CA_SC_CREDENTIALS,n=m.getSCPreference(t);widget.addPreference(n);var i=widget.getValue("SC"),r=m.getSCPreferred(i);widget.setValue("SC",r),widget.setValue("xPref_CREDENTIAL",r)}},onRefresh:function(){var e="ctx::"+widget.getValue("SC");console.log("Setting security Context: "+e),this.caGlobalObject.mySecurityContext=e,e=e.replace("ctx::",""),this.caGlobalObject.myRole=e.substring(0,e.indexOf(".")),this.caGlobalObject.collabspace=e.substring(e.lastIndexOf(".")+1,e.length)},checkValiditySC:function(e){var t=!1,n=0;if(m._theListSC)for(;!t&&n<m._theListSC.length;)e===m._theListSC[n]&&(t=!0),n++;return t},ComputeList:function(e){var t,n,i,a=!1,r=[],o=[],l=e.preferredcredentials;if(l&&l.collabspace&&l.role&&l.organization){var c=l.collabspace,u=l.role,d=l.organization;c.title,t=u.name,d.title,n=c.name,i=d.name,s.getGlobalVariable().organization=i,m._SCPreferredDB=t+"."+i+"."+n}var p=e.collabspaces;if(p&&p.length>0){for(var g=!1,f=0;f<p.length;f++){for(var h=(A=p[f]).couples||[],v=0;v<h.length;v++){var C=h[v];if(void 0===y&&(y=C.organization.name),y!==C.organization.name){g=!0;break}}if(g)break}var S,b,y=void 0,w=[];for(f=0;f<p.length;f++){var A,O=(A=p[f]).title,N=A.name;for(h=A.couples,v=0;v<h.length;v++){var I=h[v],E=I.organization,_=I.role,T=E.name,P=E.title,D=_.name,R=_.nls;w.push({collabspace:N,collabspaceNLS:O,organization:T,organizationNLS:P,role:D,roleNLS:R}),""!=m._SCPreferredDB?i===T&&t===D&&n===N&&(a=!0):a=!0}}g?w.sort(function(e,t){return e.collabspaceNLS.toLowerCase()>t.collabspaceNLS.toLowerCase()?1:e.collabspaceNLS.toLowerCase()===t.collabspaceNLS.toLowerCase()?e.organizationNLS.toLowerCase()>t.organizationNLS.toLowerCase()?1:e.organizationNLS.toLowerCase()===t.organizationNLS.toLowerCase()&&e.roleNLS.toLowerCase()>t.roleNLS.toLowerCase()?1:-1:-1}):w.sort(function(e,t){return e.collabspaceNLS.toLowerCase()>t.collabspaceNLS.toLowerCase()?1:e.collabspaceNLS.toLowerCase()===t.collabspaceNLS.toLowerCase()&&e.roleNLS.toLowerCase()>t.roleNLS.toLowerCase()?1:-1});for(f=0;f<w.length;f++)S=w[f].role+"."+w[f].organization+"."+w[f].collabspace,b=g?w[f].collabspaceNLS+" ● "+w[f].organizationNLS+" ● "+w[f].roleNLS:w[f].collabspaceNLS+" ● "+w[f].roleNLS,r.push(S),o.push(b);m._theListSC=r,m._theListSC_NLS=o}m.onPnORetrieve(a)},getSCPreference:function(e){var t={name:"SC",type:"list",label:e,options:[]};if(m._theListSC)for(var n=0;n<m._theListSC.length;n++)t.options.push({value:m._theListSC[n],label:m._theListSC_NLS[n]});return t},getSCPreferred:function(e){var t;if(null!=e&&""!=e&&m.checkValiditySC(e))t=e;else if(""!=m._SCPreferredDB)t=m._SCPreferredDB;else{t=m._theListSC[0];for(var n=0;n<m._theListSC.length;n++)if(m._theListSC[n].contains("VPLMProjectLeader")){t=m._theListSC[n];break}}return t},populateTenantPreferences:function(){var e={name:"x3dPlatformId",type:"list",label:a.ECM_CA_Pref_3DEXPERIENCE_Platform,options:[]},n=[];return new Promise(function(e,i){t.getGrantedRoles(function(t){t.forEach(function(e){"CSV"!==e.id&&"InternalDS"!==e.id||UWA.is(e.platforms,"array")&&(n=n.concat(e.platforms))}),e()})}).then(function(){return new Promise(function(i,a){t.getPlatformServices({onComplete:function(t){var a;if(n.length>0){var r=[];t.forEach(function(e){n.includes(e.platformId)&&r.push(e)}),a=r}else a=t;a.sort(function(e,t){var n=e.displayName.toLowerCase(),i=t.displayName.toLowerCase();return n<i?-1:n>i?1:0}),a.forEach(function(t){var n=t.platformId,i=t.displayName;e.options.push({value:n,label:i}),widget.getValue("x3dPlatformId")===n&&m.update3DspaceURL(t)}),(t={}).TenantPreference=e,i(t)},onFailure:function(e){console.log("Error getting Tenant details")}})})})},update3DspaceURL:function(e){this.caGlobalObject.baseURL=e["3DSpace"],this.caGlobalObject.federatedURL=e["3DSearch"],this.caGlobalObject.tenant=e.platformId},readyDragContent:function(e,t){var n=[];if(t.nodeModel.getTreeDocument().getSelectedNodes().length>1)t.nodeModel.getTreeDocument().getSelectedNodes().forEach(function(e){var t={envId:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",serviceId:"3DSpace",contextId:s.getGlobalVariable().getSecurityContext(),objectId:e.options.grid.id,objectType:e.options.grid.type,displayName:e.options.grid.name,displayType:e.options.grid.displayType};n.push(t)});else{var i=t.nodeModel.options.grid.id;i.contains("pid:")&&(i=i.replace("pid:",""));var a={envId:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",serviceId:"3DSpace",contextId:s.getGlobalVariable().getSecurityContext(),objectId:i,objectType:t.nodeModel.options.grid.type,displayName:t.nodeModel.options.grid.name,displayType:t.nodeModel.options.grid.displayType};n.push(a)}var r={protocol:"3DXContent",version:"1.1",source:"X3DCSMA_AP",widgetId:widget.id,data:{items:n}};e.dataTransfer.setData("Text",JSON.stringify(r)),e.dataTransfer.effectAllowed="all"},updateWidgetTitle:function(e){var t=a.CHG_CA_Widget_Title;return null!=e&&(t=e),widget.setTitle(t)},getSearchTypes:function(){var e=this;return new Promise(function(t,n){e.makeWSCall("/resources/modeler/change/typeeallowed","GET","enovia","application/json","",function(n){e.caGlobalObject.referentialsSearchType=e.getResultStringFromJSONArrayObj(n.referentials),e.caGlobalObject.contextSearchType=e.getResultStringFromJSONArrayObj(n.context),e.caGlobalObject.proposedSearchType=e.getResultStringFromJSONArrayObj(n.proposed),t(n)},n,!0)})},getSearchForbiddenTypes:function(){var e=this;return new Promise(function(t,n){e.makeWSCall("/resources/modeler/change/typeeallowed/enhanced","GET","enovia","application/json","",function(n){e.caGlobalObject.referentialsSearchForbiddenType=UWA.is(n.referentials)&&UWA.is(n.referentials.forbidden)?e.getResultStringFromJSONArrayObj(n.referentials.forbidden):"",e.caGlobalObject.contextSearchForbiddenType=UWA.is(n.context)&&UWA.is(n.context.forbidden)?e.getResultStringFromJSONArrayObj(n.context.forbidden):"",e.caGlobalObject.proposedSearchForbiddenType=UWA.is(n.proposed)&&UWA.is(n.proposed.forbidden)?e.getResultStringFromJSONArrayObj(n.proposed.forbidden):"",t()},function(){console.log("typeeallowed enhanced web service fails...!"),t()},!0)})},getResultStringFromJSONArrayObj:function(e){var t="";if(null!=e&&""!=e&&e.length>0)for(var n=0;n<e.length;n++)t=""==t?e[n]:t+","+e[n];return t},IsChangeAction:function(e,t){var n=this;return new Promise(function(i,a){var r="/resources/modeler/change/changeaction/pid:"+e;t||(t=!0),n.makeWSCall(r,"GET","enovia","application/json","",function(e){i({isChangeAction:"TRUE"})},function(){i({isChangeAction:"FALSE"})},t)})},createCA:function(e,t,n){this.makeWSCall("/resources/modeler/change/changeaction","POST","enovia","application/json",e,t,n)},createChangeOrder:function(e,t,n){this.makeWSCallWithCSRF("/resources/v1/chguxservices/changeorder","POST","enovia","application/json",e,t,n)},makeWSCall:function(e,t,a,o,l,c,u,d,p=!0){var g=null;if(this.caGlobalObject)g=this.caGlobalObject;else{var f=s.getGlobalVariable();f&&(g=f)}var m="";m=null!=(d=d||null)&&null!=d.isfederated&&1==d.isfederated?g.federatedURL+e:null!=d&&null!=d.isCompass&&1==d.isCompass?g.compassURL+e:g.computeUrl(e);var h="";h=null!=d&&null!=d.acceptType&&""!=d.acceptType?d.acceptType:"application/json";var v="Yes";null!=d&&null!=d.encodeSecurityContext&&""!=d.encodeSecurityContext&&(v=d.encodeSecurityContext);var C=(new Date).getTime();m=-1==m.indexOf("?")?m+"?tenant="+g.tenant+"&timestamp="+C:m+"&tenant="+g.tenant+"&timestamp="+C;var S=g.getSecurityContext();"No"!=v&&(S=encodeURIComponent(S)),c=c||function(){},u=u||function(){};var b=widget.getValue("lang");widget.lang&&(b=widget.lang);var y={};y.method=t,y.timeout=g.wsCallTimeout,null!=d&&null!=d.isSwymUrl&&0!=d.isSwymUrl||(y.type="json"),g.isNative?y.headers=S?{Accept:h,"Content-Type":o,SecurityContext:S,"Accept-Language":b}:{Accept:h,"Content-Type":o,"Accept-Language":b}:(a&&(y.auth={passport_target:a}),y.proxy=g.proxy,y.headers=S?{Accept:h,"Content-Type":o,SecurityContext:S,"Accept-Language":b}:{Accept:h,"Content-Type":o,"Accept-Language":b}),l&&(y.data=l),y.onComplete=function(e){if(e&&e["error report"]&&Array.isArray(e["error report"])){for(var t=e["error report"],i="",a=0;a<t.length;a++){var o=t[a];o&&o.message&&(i=i+o.message+"<br>")}n.error(i);var s=document.getElementById("outer-ca-div");s&&r.unmask(s);var l=document.getElementsByClassName("moduleWrapper")[0];l&&r.isMasked(l)&&r.unmask(l),widget.body&&r.unmask(widget.body)}c(e)},y.onFailure=function(e,i){if(console.log("Error in calling url: "+m),console.log("Additional Details:: httpMethod: "+t+" authentication: "+a+" securityContext: "+S+" ContentType: "+o),console.log("Error Detail: "+e),console.log("Error Data: "+JSON.stringify(i)),m.includes("getapplicability"))var s={blockError:!0};p&&(i&&i.errorMessage?null!=s&&s.blockError?console.log("errorBlocked"):n.error(i.errorMessage):i&&i.error&&i.error.message?n.error(i.error.message):e&&e.message?n.error(e.message):n.error("Something went wrong, please check logs for more details")),u(e,i);var l=document.getElementById("outer-ca-div");l&&r.unmask(l);var c=document.getElementsByClassName("moduleWrapper")[0];c&&r.isMasked(c)&&r.unmask(c),widget.body&&r.unmask(widget.body)},y.onTimeout=function(){console.log("Timedout for url: "+m),n.error("Webservice Timedout, please refresh and try again.");var e=document.getElementById("outer-ca-div");e&&r.unmask(e);var t=document.getElementsByClassName("moduleWrapper")[0];t&&r.isMasked(t)&&r.unmask(t),widget.body&&r.unmask(widget.body)},i.authenticatedRequest(m,y)},makeWSCallWithCSRF:function(e,t,a,o,l,c,u,d){var p=null;if(this.caGlobalObject)p=this.caGlobalObject;else{var g=s.getGlobalVariable();g&&(p=g)}var f="";f=null!=(d=d||null)&&null!=d.isfederated&&1==d.isfederated?p.federatedURL+e:p.computeUrl(e);var m="";m=null!=d&&null!=d.acceptType&&""!=d.acceptType?d.acceptType:"application/json";var h="Yes";null!=d&&null!=d.encodeSecurityContext&&""!=d.encodeSecurityContext&&(h=d.encodeSecurityContext);var v=(new Date).getTime();f=-1==f.indexOf("?")?f+"?tenant="+p.tenant+"&timestamp="+v:f+"&tenant="+p.tenant+"&timestamp="+v;var C=p.getSecurityContext(),S=p.ENO_CSRF_TOKEN;"No"!=h&&(C=encodeURIComponent(C)),c=c||function(){},u=u||function(){};var b=widget.getValue("lang");widget.lang&&(b=widget.lang);var y={};y.method=t,y.timeout=p.wsCallTimeout,null!=d&&null!=d.isSwymUrl&&0!=d.isSwymUrl||(y.type="json"),p.isNative?y.headers=C?{Accept:m,"Content-Type":o,SecurityContext:C,"Accept-Language":b,ENO_CSRF_TOKEN:S}:{Accept:m,"Content-Type":o,"Accept-Language":b}:(a&&(y.auth={passport_target:a}),y.proxy=p.proxy,y.headers=C?{Accept:m,"Content-Type":o,SecurityContext:C,"Accept-Language":b,ENO_CSRF_TOKEN:S}:{Accept:m,"Content-Type":o,"Accept-Language":b}),null!=d&&null!=d.issueVersion&&""!=d.issueVersion&&(y.headers[d.issueVersion]=d.version),l&&(y.data=l),y.onComplete=function(e){if(e.csrf){var t=e.csrf.value;s.getGlobalVariable().ENO_CSRF_TOKEN=t}c(e)},y.onFailure=function(e,i){var s;console.log("Error in calling url: "+f),console.log("Additional Details:: httpMethod: "+t+" authentication: "+a+" securityContext: "+C+" ContentType: "+o),console.log("Error Detail: "+e),console.log("Error Data: "+JSON.stringify(i)),i&&i.errorMessage?n.error(i.errorMessage):i&&i.error&&i.error.message?n.error(i.error.message):i&&i.internalError?n.error(i.internalError):i&&i.error?n.error(i.error):e&&e.message?n.error(e.message):n.error("Something went wrong, please check logs for more details"),u(e,i),widget.body&&r.unmask(widget.body),(s=document.getElementsByClassName("moduleWrapper")[0])&&r.isMasked(s)&&r.unmask(s),(s=document.getElementsByClassName("chg-affectedItems-container")[0])&&r.isMasked(s)&&r.unmask(s),(s=document.getElementsByClassName("chg-orchestration-container")[0])&&r.isMasked(s)&&r.unmask(s),(s=document.getElementById("crAffectedItemsFullViewContainer"))&&r.isMasked(s)&&r.unmask(s)},y.onTimeout=function(){console.log("Timedout for url: "+f),n.error("Webservice Timedout, please refresh and try again."),widget.body&&r.unmask(widget.body)},i.authenticatedRequest(f,y)},setupIntercomConnections:function(e,t,n){t.compassSocketName=n+"EventSocket",t.compassSocket=new t.InterCom.Socket(t.compassSocketName),t.compassSocket.subscribeServer("com.ds.compass",window.parent),t.prefIntercomServer=new t.InterCom.Server("changeaction.intercom.server"),t.prefIntercomServer.addListener("onAddPref",function(n,i){"RefreshMe"!=n.name?n.value?e.setValue(n.name,n.value):e.deleteValue(n.name):t.onRefresh()})},initializeForNative:function(e){this.caGlobalObject.isNative=!0,this.caGlobalObject.callback=e,l.DispatchEventToWin("Native_Init","done")},initNative:function(e){this.caGlobalObject.isNative=!0,this.caGlobalObject.contextUser=e.userid,this.caGlobalObject.tenant=e.active_tenant,widget.setValue("x3dPlatformId",e.active_tenant),this.caGlobalObject.tenantnls=e.tenantDisplayName;let t={contextUser:e.userid,tenant:e.active_tenant,tenantnls:e.tenantDisplayName,isNative:!0};widget.setValue("native_user_info",t),widget.body.setStyle("height",document.body.parentElement.clientHeight+"px"),widget.addEvent("onResize",function(){widget.body.setStyle("height",document.body.parentElement.clientHeight+"px")});var n={},i=this;l.getWebInWinParameters(function(t){n=t||null,i.populate3DSpaceURL(n).then(function(t){i.populateSecurityContext().then(function(t){i.getSearchForbiddenTypes(),i.getSearchTypes().then(function(t){i.caGlobalObject.callback(e);m.getLicenceAccess("Native").then(function(e){return s.getGlobalVariable().isFullLicence=e.data[0].IsFullLicense,s.getGlobalVariable().isLiteLicence=e.data[0].IsLiteLicense,Promise.resolve()},function(e){return Promise.reject(e)})},function(e){return console.log("Search Types failed"),Promise.reject(e)})},function(e){return console.log("Populate Security Context failed"),Promise.reject(e)})},function(e){return console.log("Populate 3DSpace URL failed"),Promise.reject(e)})})},getCSRFToken:function(){var e=this;return new Promise(function(t,n){e.makeWSCallWithCSRF("/resources/v1/application/CSRF","GET","enovia","application/json","",function(e){s.getGlobalVariable().ENO_CSRF_TOKEN=e.csrf.value,t("success")},n,!0)})},getNLSValuesPromise:function(e){return new Promise(function(t,n){null!=e?c.getNlsOfPropertiesValues(JSON.stringify(e),{tenantId:s.getGlobalVariable().tenant,lang:widget.lang,onComplete:function(e){t(e)},onFailure:function(e){n(e)}}):t(e)})},caSubTypesFetched:function(){return new Promise(function(e,t){null!=s.getGlobalVariable().changeActionSubTypes?e():m.fetchSubTypes(e,t)})},iaSubTypesFetched:function(){return new Promise(function(e,t){null!=s.getGlobalVariable().changeAnalysisSubTypes?e():m.fetchIASubTypes(e,t)})},fetchIASubTypes:function(e){var t=this;t.makeWSCall("/resources/dictionary/getTypeInfo","POST","enovia","application/json",'["Change Analysis"]',function(n){if(Object.keys(n).length>1){s.getGlobalVariable().changeAnalysisSubTypes=[];var i=[];Object.keys(n).forEach(function(e){var n=t.fetchNLSForIASubType(e);i.push(n)}),Promise.all(i).then(function(){s.getGlobalVariable().changeAnalysisSubTypePresent=!0;var t=[],n=0;Object.keys(s.getGlobalVariable().changeAnalysisSubTypes).forEach(function(e){var i=s.getGlobalVariable().changeAnalysisSubTypes[e];t[n]={label:i,value:e},n++}),t.sort(function(e,t){return e.label.toUpperCase()>t.label.toUpperCase()?1:-1}),s.getGlobalVariable().changeAnalysisSubTypes=t,null!=e&&e()})}else if(1==Object.keys(n).length){var a=Object.keys(n),r={};r[a[0]]=a[0],s.getGlobalVariable().changeAnalysisSubTypePresent=!1,s.getGlobalVariable().changeAnalysisSubTypes=[],s.getGlobalVariable().changeAnalysisSubTypes.push(r),null!=e&&e()}else null!=e&&e()},function(t){s.getGlobalVariable().changeAnalysisSubTypePresent=!1,null!=e&&e()},!0)},getLicenceAccess:function(e){return new Promise(function(t,n){var i="/resources/v1/chguxservices/connectedChange/license?platform="+e;m.makeWSCallWithCSRF(i,"GET","enovia","application/json","",function(e){t(e)},n,!1)})},fetchNLSForIASubType:function(e){var t=this;return new Promise(function(n,i){var a="/resources/dictionary/class/"+e+"/attributes";t.makeWSCall(a,"GET","enovia","application/json","",function(t){UWA.is(t.NLSName)&&""!=t.NLSName?s.getGlobalVariable().changeAnalysisSubTypes[e]=t.NLSName:s.getGlobalVariable().changeAnalysisSubTyp[e]=e,n()},function(t){s.getGlobalVariable().changeAnalysisSubType[e]=e,n()},!0)})},getCopyLink:function(e){return{type:"PushItem",title:a.LinkCopiedTitle,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-link"},action:{callback:function(){var n=void 0;let i=void 0;1==e.length?(i=e[0].options.grid.typeNLS||e[0].options.grid.type,n=e[0].options.grid.title||e[0].options.grid.name):n="";var r=UWA.createElement("div",{styles:{display:"flex"}}),o=new p("input",{attributes:{readonly:"readonly"}});o.getContent().setStyles({display:"inline-block","border-top-right-radius":0,"border-bottom-right-radius":0}),o.inject(r);var s=new g({value:"Copy Link",className:"block",events:{onClick:function(e){o.setFocus(),o.elements.input.select(),o.elements.input.setSelectionRange(0,99999),document.execCommand("cut"),l.hide(),n&&""!==n?m.showNotification("success",a.get("LinkCopiedTitle"),UWA.String.format(a.get("LinkCopiedMsg"),i,n),"",!1,""):m.showNotification("success",a.get("LinkCopiedTitle"),a.get("LinkCopied"),"",!1,"")}}});s.getContent().setStyles({display:"inline-block","border-top-left-radius":0,"border-bottom-left-radius":0,padding:"0 10px"}),s.inject(r);var l=new f({body:r,closeOnClick:!1,events:{onClickOutside:function(e){console.log("DDClickOutside")}}}),c=widget.widgetDomain;if(null==c&&(c=platformUrls["3DDashboard"]),null==c)t.getPlatformServices({platformId:"OnPremise",onComplete:function(t){let n="",i=0;for(let r of e){var a=m.makeCopyLinkObject(r);let e=t["3DDashboard"]+"#app:"+widget.getValue("appId")+"/content:X3DContentId="+encodeURIComponent(JSON.stringify(a));0==i?(n+=e,i++):n=n+" "+e}l.hide(),l.show(),o.setFocus(),o.setValue(n),o.elements.input.select(),o.elements.input.setSelectionRange(0,99999,"backward"),s.getContent().click()}});else{let t="",n=0;for(let i of e){var u=m.makeCopyLinkObject(i);let e=c+"#app:"+widget.getValue("appId")+"/content:X3DContentId="+encodeURIComponent(JSON.stringify(u));0==n?(t+=e,n++):t=t+" "+e}l.hide(),l.show(),o.setFocus(),o.setValue(t),o.elements.input.select(),o.elements.input.setSelectionRange(0,99999,"backward"),s.getContent().click()}}}}},makeCopyLinkObject:function(e){var t={protocol:"3DXContent",data:{items:[]}};return t.data.items.push({envId:s.getGlobalVariable().tenant,objectId:e.options.grid.id,openLink:!0}),t},showNotification:function(e,t,n,i,a,r,o){var s={level:e,title:t,subtitle:n,message:i,sticky:a,allowUnsafeHTML:o||!1};window.notifs||(window.notifs=u,d.setNotificationManager(window.notifs)),r?d.inject(r):d.elements.container.isInjected()||d.inject(),window.notifs.addNotif(s)}};return m}),define("DS/ENOChgServices/scripts/services/ChgReferentialServices",["UWA/Core","DS/ENOChgServices/scripts/services/ChgInfraService"],function(e,t){"use strict";return{addReferentialToCA:function(e,n,i,a){var r="/resources/modeler/change/changeaction/"+n;t.makeWSCall(r,"PUT","enovia","application/json",e,i,a)},removeReferentialFromCA:function(e,n,i,a){var r="/resources/modeler/change/changeaction/"+n;t.makeWSCall(r,"PUT","enovia","application/json",e,i,a)},getCAReferentialData:function(e){return new Promise(function(n,i){var a="/resources/modeler/change/changeaction/"+e+"?referentials=1";t.makeWSCall(a,"GET","enovia","application/json","",function(e){n(e)},i,!1)})}}}),define("DS/ENOChgServices/scripts/services/ChgIDCardHeaderServices",["UWA/Core","DS/UIKIT/Mask","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/ENOChgServices/scripts/services/ChgErrors","DS/LifecycleCmd/MaturityCmd","DS/PlatformAPI/PlatformAPI","text!DS/ENOChgServices/assets/ChangeActionMapping.json","i18n!DS/ENOChgServices/assets/nls/ChgServiceNLS"],function(e,t,n,i,a,r,o,s,l,c){"use strict";return{populateCOSearchResults:function(e,t,i){if(n.getGlobalVariable().isNative){for(var a=t.split("~"),r=[],o=0;o<a.length;o++)r.push(a[o]);for(var s=[],l=0;l<a.length;l++)s.push(r[l].split(","));t=s}var c=jQuery(".modal-footer")[0];c&&(c.childNodes[0].disabled=!1);var u=e.substr(0,e.indexOf("_")),d=document.getElementById(u),p=document.getElementById(u+"_hidden"),g="",f="",m=d.value.split(",");!i&&t.length>1&&(t=t.slice(0,1));for(o=0;o<t.length;o++){var h=t[o];(i&&-1==m.indexOf(h[1])||!i)&&(""!=g&&(g+=","),g+=h[1],""!=f&&(f+=","),f+=h[0])}i?(""!=g&&(""!=d.value?d.value=d.value+","+g:d.value=g),""!=f&&(""!=p.value?p.value=p.value+","+f:p.value=f)):(d.value=g,p.value=f)},getCompletedTaskDetails:function(e){return new Promise(function(t,n){var a="/resources/modeler/change/inboxtask/"+e;i.makeWSCall(a,"GET","enovia","application/json","",function(e){var n={};n.completedTaskDetail=e,t(n)},null,!1)})},getTaskDetails:function(e){return new Promise(function(t,n){var a="/resources/modeler/change/inboxtask/retrieveForUser/"+e;i.makeWSCall(a,"GET","enovia","application/json","",function(e){var n={};n.taskDetail=e,t(n)},null,!1)})},createLifecycleSpanContent:function(t){var n=this,i=e.extendElement(document.body).getElement("#lifecycleSpan");if(i){i.empty();t.get("current");var a=t.get("currentDisplay"),r=t.get("holdStatus"),o="cursorPointer",s="a",l=t.get("userAccess"),u=!0,d=!0;l&&(u="true"===l.Promote,d="true"===l.Demote),"true"!==r&&(u||d)||("true"===r&&(a=a+" ["+c.CHG_CA_Hold_State+"] "),o="cursorDefault",s="text");var p={hold:"true"===r,promote:u,demote:d},g=[];t.set("objectId",t.get("id")),g.push(t);var f=!1;i.addContent({tag:"span",html:[{tag:"label",text:c.ECM_CA_Maturity_State+" : "},{tag:"span",html:"&nbsp;&nbsp;"},{tag:s,text:a,id:"ca_header_maturity",class:o,events:{click:function(){setTimeout(function(){f||n.changeMaturity(g,t,p),f=!0},500)}}}]})}else;},changeMaturity:function(e,t,i){if(!(!i||i&&i.hold||i&&!i.promote&&!i.demote))if(n.getGlobalVariable().isNative)if("In Work"===t.get("current")){var r={stateName:""};r.caPhysicalId=t.id.replace("pid:","");var o=JSON.stringify(r);a.DispatchEventToWin("CA_MoveFrm_InWork",o)}else this.changeMaturityExecute(e,t);else this.changeMaturityExecute(e,t)},changeMaturityExecute:function(e,i){var a=[],r=[];e.forEach(function(e){var t=e.get("objectId");null!=t&&null!=t&&""!=t||(t=e.get("id")),r.push(t),a.push({physicalid:t.substring(4)})});var l={securityContext:{SecurityContext:n.getGlobalVariable().getSecurityContext(),tenant:n.getGlobalVariable().tenant},getSecurityContext:function(){return this.securityContext}};new o({context:l,ID:"MaturityHdr"}).executeAsync(a).then(function(){var e={};t.mask(widget.body),e.onComplete=function(e){t.unmask(widget.body),t.unmask(widget.body);var n={id:e.id,maturity:e.get("current"),groupId:e.get("groupid")};s.publish("ca-IDCard-on-change-maturity",n)},i.fetch(e),console.log("Maturity  updated")})},getCAthumbnailUrl:function(e){for(var t=e.get("referentials").toArray(),n="",i=JSON.parse(l).IMAGE,a=t.length-1;a>=0;a--){var r=null!=t[a]&&null!=t[a].get("fileExtension")?t[a].get("fileExtension").slice(1):"temp";if(i.includes(r.toUpperCase())){n=a;break}}return""!==n?t[n].get("image"):e.get("image")},getCAThumbnailUrl:function(e,t){for(var n=e.get("referentials").toArray(),i="",a=JSON.parse(l).IMAGE,r=n.length-1;r>=0;r--){var o=null!=n[r]&&null!=n[r].get("fileExtension")?n[r].get("fileExtension").slice(1):"temp";if(a.includes(o.toUpperCase())){i=r;break}}return""!==i?n[i].get("image"):e.get("image")},promoteChangeAction:function(e,t){return new Promise(function(n,a){var o='{ "data" : [{ "physicalid":"'+e+'","tostate":"'+t+'"}]}';i.makeWSCall("/resources/lifecycle/maturity/promote","POST","enovia","application/json",o,function(t){if(null!=t.status&&""!=t.status&&"failure"==t.status)r.error(t.report[0].error);else if(null!=t.status&&""!=t.status&&"success"==t.status)var i={id:e,maturity:t.results[0].current};n(i)},function(e,t){r.error(e),a(e)},!1)})}}}),define("DS/ENOChgServices/scripts/services/ChgProposedServices",["UWA/Core","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable"],function(e,t,n){"use strict";var i={getCAProposedData:function(e){return new Promise(function(n,i){var a="/resources/modeler/change/changeaction/"+e+"?proposed=1&flowdown=1&attributes=1&context=1";t.makeWSCall(a,"GET","enovia","application/json","",function(e){n(e)},i,!1)})},getCAFlowdownData:function(e){return new Promise(function(n,i){var a="/resources/modeler/change/changeaction/"+e+"?flowdown=1&attributes=1";t.makeWSCall(a,"GET","enovia","application/json","",function(e){n(e)},i,!1)})},getDataForProposedFacet:function(e){var t=this;return new Promise(function(n,a){var r=t.getCAProposedData(e),o={context:[],proposedData:[]},s=[],l=[],c=[],u=[];r.then(function(e){e&&e.changeaction&&(e.changeaction.context&&(o.context=e.changeaction.context),e.changeaction.proposed&&(s=e.changeaction.proposed,o.proposedData=o.proposedData.concat(e.changeaction.proposed)),e.changeaction.flowdownActivities&&(l=i._getFlowdownOperations(e.changeaction.flowdownActivities),c=e.changeaction.flowdownActivities,u=e.changeaction.flowdownIgnoreds,o.proposedData=o.proposedData.concat(l),i.cachedFlowdownModels=l)),t.mapping=i._mappedForSlidein(s,c,u),n(o)})})},getSupportedOperations:function(){return"None,NewVersion,NewMinorVersion,NewEvolution,Create,Restore"},getSupportedActivities:function(){return"Modify,Release,Obsolete"},getAllowedOperationActivity:function(e,n,i){var a=this;return new Promise(function(r,o){if(e&&e.length>0){var s=[];if(i&&1==e.length){var l={existingProposedPid:i,objectPid:e[0]};s.push(l)}else for(var c in e){l={objectPid:e[c]};s.push(l)}var u={getOperationForPhysicalIds:s,changeactionid:n};u=JSON.stringify(u);t.makeWSCall("/resources/modeler/change/operation/fromIds","POST","enovia","application/json",u,function(e){var t,n=new Object;UWA.is(e)&&UWA.is(e.listOfOperationPerObject)&&e.listOfOperationPerObject.forEach(function(e){(t=new Object).allowedOperation=[],t.allowedActivity=[],t.defaultOperation="None",t.defaultActivity=void 0,e.allowedOperation.forEach(function(n){-1!=a.getSupportedOperations().indexOf(n)?t.allowedOperation.push(n):-1!=a.getSupportedActivities().indexOf(n)&&t.allowedActivity.push(n),t.allowedOperation.includes("Restore")&&(e.defaultOperation="None",t.allowedActivity.includes("Modify")||t.allowedActivity.push("Modify"))}),UWA.is(e.defaultOperation)&&-1!=a.getSupportedOperations().indexOf(e.defaultOperation)?t.defaultOperation=e.defaultOperation:UWA.is(e.defaultOperation)&&-1!=a.getSupportedActivities().indexOf(e.defaultOperation)&&(t.defaultActivity=e.defaultOperation),n[e.id.replace("pid:","")]=t});var i={};i.allowedOperationActivity=n,r(i)},o,!1)}else r(!0)})},addProposedFromFlowdownPanel:function(e){if(UWA.is(e)){var t=e.proposedArrToAdd;if(t)Object.keys(t)}},setFlowdownMapping:function(e){if(this.flowdownMapping={},UWA.is(e)){var t=e.proposedArrToAdd;if(t){var n=t.map(function(e){return"pid:"+e.proposedId});for(var i in n){var a=n[i];a&&""!=a&&(this.flowdownMapping[a]={flowdownForObjectId:e.proposedArrToAdd[a].flowdownForObjectId,flowdownForObjectTitle:e.proposedArrToAdd[a].flowdownForObjectTitle,flowdownForObjectType:e.proposedArrToAdd[a].flowdownForObjectType,flowdownForObjectTypeNLS:e.proposedArrToAdd[a].flowdownForObjectTypeNLS},e.moreInfo.length>1?this.flowdownMapping[a].moreInfo=e.moreInfo:(this.flowdownMapping[a].upstreamCAId=e.moreInfo[0].caID,this.flowdownMapping[a].upstreamCATitle=e.moreInfo[0].caTitle))}}}},setFlowdownForandFromMappingAndReturnProposedIds:function(e){this.flowdownForandFromMapping={};var t={forFlowdownOp:[],selectedProposedIds:[]};if(UWA.is(e)){var n=Object.keys(e.proposedArrToAdd);for(var i in n){var a=n[i],r=e.proposedArrToAdd[a];if(r){var o=r.selectedItems;if(o)for(var s in o){var l=o[s];l&&(l.fromAddResolutionTab?t.forFlowdownOp.push("pid:"+l.proposedId):t.selectedProposedIds.push("pid:"+l.proposedId),this.flowdownForandFromMapping["pid:"+l.proposedId]={flowdownForObjectId:a,flowdownForObjectTitle:r.objTitle,flowdownForObjectType:r.objType,flowdownForObjectTypeNLS:r.objTypeNLS,upstreamCAId:e.moreInfo.caID,upstreamCATitle:e.moreInfo.caTitle,upstreamAMOId:r.amoID})}}}}return t},getFlowdownForandFromMapping:function(){return this.flowdownForandFromMapping},getFlowdownMapping:function(){return this.flowdownMapping},getCachedFlowdownData:function(){return i.cachedFlowdownModels},_getFlowdownOperations:function(e){var t=[];for(var n in e){var i=e[n];if(UWA.is(i)){var a=i.flowdownElements,r=i.flowdownResolutions,o=(a.map(function(e){return e.elementPointedId}),a.map(function(e){return e.elementIdentifier}));if(r.length>0)for(var s in r){var l=r[s];UWA.is(l)&&o.forEach(function(e,n){-1!=l.resolutionValidIdentifiers.indexOf(e)?l.resolutionObject&&t.push(i):"Flowdown Pending"===a[n].elementStatus&&t.push(i),-1!=l.resolutionRejectedIdentifiers.indexOf(e)&&"Rejected"===a[n].elementStatus&&l.resolutionObject&&t.push(i)})}0===r.length&&t.push(i)}}return t},_mappedForSlidein:function(e,t,n){var a=[],r={};for(var o in t){var s=t[o];if(UWA.is(s)){var l=s.flowdownElements,c=s.flowdownResolutions;if(Array.isArray(c)&&c.length>0){var u=[],d=[],p=[];for(var g in l){var f=l[g];if(f){u.push(f.elementPointedId),d.push(f.elementIdentifier),p.push(f.elementPointedCAId);var m={amoID:f.elementPointedId,caID:f.elementPointedCAId,caTitle:f.elementPointedCATitle,caName:f.elementPointedCAName,flowdownStatus:f.elementStatus};"Complete"!==f.elementStatus&&"Flowdown Complete"!==f.elementStatus||(m.flowdownStatus="Flowdown Complete"),("Complete"!==f.elementStatus&&"Flowdown Complete"!==f.elementStatus||"Updated"!==f.elementSyncStatus)&&"Transferred"!==f.elementSyncStatus||(m.flowdownStatus="Flowdown Pending"),"Started"===f.elementStatus&&(m.flowdownStatus="Flowdown Pending"),"Rejected"===f.elementStatus&&(m.flowdownStatus="Flowdown Pending"),r[f.elementIdentifier]=m}}for(var h in c){var v=c[h];UWA.is(v)&&d.forEach(function(t){if(-1!=v.resolutionValidIdentifiers.indexOf(t))if(v.resolutionObject)a.push(s),r[t]&&(r[t].resolution||(r[t].resolution=[]),r[t].resolution.push({objectData:v.resolutionObject}),r[t].directResolution=!0,r[t].proposedResolution=!1);else{var n=v.resolutionPointedId;for(var i in e){var o=e[i];if(o)if(o.id===n){r[t].resolution||(r[t].resolution=[]),r[t].resolution.push({proposedId:n,objectData:o.where}),r[t].directResolution=!1,r[t].proposedResolution=!0,o.flowdownInfo||(o.flowdownInfo={flowdownFor:[],flowdownFrom:[]}),o.flowdownInfo.flowdownFor.push(s.where);var l={caID:r[t].caID,caTitle:r[t].caTitle,caName:r[t].caName};o.flowdownInfo.flowdownFrom.push(l)}}}-1!=v.resolutionRejectedIdentifiers.indexOf(t)&&v.resolutionObject&&(a.push(s),r[t]&&(r[t].resolution||(r[t].resolution=[]),r[t].resolution.push({objectData:v.resolutionObject}),r[t].directResolution=!0,r[t].proposedResolution=!1))})}}Array.isArray(c)&&0===c.length&&(r=i.setDirectResolvedPropsoed(s,r))}}for(var C in n){var S=n[C];UWA.is(S)&&(r[S.elementIdentifier]={amoID:S.elementPointedId,caID:S.elementPointedCAId,caTitle:S.elementPointedCATitle,caName:S.elementPointedCAName,flowdownStatus:"Ignored"})}return r},getFlowdownMappingForSlideIn:function(){return this.mapping},setDirectResolvedPropsoed:function(e,t){if(UWA.is(e)){var n=e.flowdownElements;for(var i in n){var a=n[i];a&&(t[a.elementIdentifier]={amoID:a.elementPointedId,caID:a.elementPointedCAId,caTitle:a.elementPointedCATitle,caName:a.elementPointedCAName,flowdownStatus:a.elementStatus},"Flowdown Pending"!==a.elementStatus&&"Flowdown Complete"!==a.elementStatus&&"Started"!==a.elementStatus&&"Complete"!==a.elementStatus||(t[a.elementIdentifier].resolution||(t[a.elementIdentifier].resolution=[]),t[a.elementIdentifier].resolution.push({objectData:e.where}),t[a.elementIdentifier].directResolution=!0,t[a.elementIdentifier].proposedResolution=!1))}}return t}};return i}),define("DS/ENOChgServices/scripts/services/ChgPropertiesComponentServices",["DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/TreeModel/DataModelSet","DS/UIKIT/Alert","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgErrors","i18n!DS/ENOChgServices/assets/nls/ChgServiceNLS"],function(e,t,n,i,a,r,o){"use strict";var s={GetChangeRequired:function(e){return new Promise(function(t,n){var i="pid:"+e,r=[];r.push(i);var o={ObjectsListForGetChangeControl:r};o=JSON.stringify(o);a.makeWSCall("/resources/modeler/change/changecontrol","POST","enovia","application/json",o,function(e){var n={};if(e&&e.objectListChangeControlled){var i=e.objectListChangeControlled[0];i&&(n.CCValue=i.changeControlValue)}e&&e.ChangeData&&(n.ChangeData=e.ChangeData[0]),e&&e.GroupChangeData&&(n.GroupChangeData=e.GroupChangeData[0]),t(n)},null)})},SetUnsetChangeRequired:function(e,t){return new Promise(function(n,i){var o="pid:"+e,s=[];s.push(o);var l={};l="Set"==t?{ObjectsListForSetChangeControl:s}:{ObjectsListForUnSetChangeControl:s},l=JSON.stringify(l);a.makeWSCall("/resources/modeler/change/changecontrol","PUT","enovia","application/json",l,function(e){var t={};if(e&&e.objectListChangeControlled){var i=e.objectListChangeControlled[0];i&&(t.CCValue=i.changeControlValue)}e&&e.ChangeData&&(t.ChangeData=e.ChangeData[0]),n(t)},function(e,t){r.error(t.errorMessage);i({})})})},getImpactedCA:function(e){return new Promise(function(t,n){var i="pid:"+e,r=[];r.push(i);var o={};o={"impacted items":r},o=JSON.stringify(o);a.makeWSCall("/resources/modeler/change/impactAnalysis","POST","enovia","application/json",o,function(e){var n={};e.object[0].impacting&&(n=e.object[0].impacting["complete ca"][0]),t(n)},null)})},getRouteFromChangeAction:function(e){return new Promise(function(t,n){var i="/resources/modeler/change/changeaction/"+e+"?lastApprovalRoute=1";a.makeWSCall(i,"GET","enovia","application/json","",function(e){var n={};n.lastApproveRoute=e.changeaction.lastApprovalRoute,t(n)},null,!1)})},getRouteDetails:function(e){return new Promise(function(t,n){var i="/resources/v1/modeler/routes/"+(e=e.replace("pid:",""))+"/tasks";a.makeWSCall(i,"GET","enovia","application/json","",function(e){var n={};n.routeInfo=e,t(n)},null,!1)})},checkIfObjectIsConfigurableAndHasConfigContext:function(e){return new Promise(function(t,n){var i={version:"1.0",pidList:[e]};i=JSON.stringify(i),a.makeWSCall("/resources/modeler/configuration/navigationServices/getMultipleConfigurationContextInfo","POST","enovia","application/ds-json",i,function(e){t(e)},function(e){t({})},!1)})},getConfiguredObjectInfo:function(e){return new Promise(function(t,n){s.checkIfObjectIsConfigurableAndHasConfigContext(e).then(function(e){if(e&&e.referencesInfo&&"YES"==e.referencesInfo[0].isConfigurable&&"YES"==e.referencesInfo[0].hasConfigContext){var n={error:o.ECM_CONFIGURED_DATA_ERR};t(n)}else t({})})})},getCADetails:function(e){return new Promise(function(t,n){var i="/resources/modeler/change/changeaction/"+e+"?people=1&attributes=1&referentials=1";a.makeWSCall(i,"GET","enovia","application/json","",function(e){t(e)},n,!1)})},buildApprovalSummaryDataGridModel:function(t){var i=new n,a=new e({dataModelSet:i,useAsyncPreExpand:!0});return t.forEach(function(e){var t=s.createTreeModel(i,e);a.addChild(t)}),a.prepareUpdate(),a.pushUpdate(),a},createTreeModel:function(e,n){return new t.createTreeNodeDataModel(e,{label:n.get("taskName"),children:[],icons:[],grid:{order:n.get("order"),title:n.get("taskTitle"),approver:n.get("taskApprover"),status:n.get("approvalStatus"),comments:n.get("approvalComments"),approvalDate:n.get("actualComplDate")}})},getChangeActionForGrop:function(e){return new Promise(function(t,n){var i="/resources/modeler/change/group/"+e+"?";a.makeWSCall(i,"GET","enovia","application/json","",function(e){t(e)},n,!1)})}};return s}),define("DS/ENOChgServices/scripts/services/ChgContextServices",["UWA/Core","DS/ENOChgServices/scripts/services/ChgInfraService"],function(e,t){"use strict";return{addContextToCA:function(e,n,i,a){var r="/resources/modeler/change/changeaction/"+n;t.makeWSCall(r,"PUT","enovia","application/json",e,i,a,!0)},removeContextFromCA:function(e,n,i,a){var r="/resources/modeler/change/changeaction/"+n;t.makeWSCall(r,"PUT","enovia","application/json",e,i,a,!0)},getCAContextData:function(e){return new Promise(function(n,i){var a="/resources/modeler/change/changeaction/"+e+"?context=1";t.makeWSCall(a,"GET","enovia","application/json","",function(e){n(e)},i,!1)})}}}),define("DS/ENOChgServices/scripts/services/ChgMembersServices",["UWA/Core","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgInfraService"],function(e,t,n){"use strict";return{reviewerType:{typeOfReviewer:"",labelSelected:!1},addPersonToCA:function(e,t,i,a){var r="";t&&(r="/resources/modeler/change/changeaction/"+t),""!=r&&n.makeWSCall(r,"PUT","enovia","application/json",e,i,a)},removePersonFromCA:function(e,t,i,a){var r="";null!=t&&(r="/resources/modeler/change/changeaction/"+t),""!=r&&n.makeWSCall(r,"PUT","enovia","application/json",e,i,a)},getSuggestionsForRoutesAndMembers:function(e){var t=this,n=e.members?e.members:null;if(n){var i=!1;n.forEach(function(e){e.get("role").indexOf("reviewer")>=0&&(i=!0,t.reviewerType.typeOfReviewer=e.get("type"))}),i||!1!==t.reviewerType.labelSelected||(t.reviewerType.typeOfReviewer="")}this.getSuggestions(e).then(function(t){e.onComplete(t)},function(e){return console.log("Issue in retrieving members"),Promise.reject(e)})},getSuggestions:function(e){var i=e.text,a=e.categoryId,r=e.contextUser,o=this;return new Promise(function(e,s){i.contains("*")||(i+="*");o.CurrModel;var l={with_indexing_date:!0,with_nls:!1,label:"yus-1515078503005",locale:"en",select_predicate:["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:responsible","ds6wg:fullname"],select_file:["icon","thumbnail_2d"],query:"reviewer"!==a||"reviewer"===a&&"Person"===o.reviewerType.typeOfReviewer?'(flattenedtaxonomies:"types/Person" AND policycurrent:"Person.Active" AND fullname:"'+i+'")':"reviewer"===a&&"Route Template"===o.reviewerType.typeOfReviewer?'(flattenedtaxonomies:"types/Route Template" AND route_95_base_95_purpose:"Approval" AND (route_95_template_95_availability: "Enterprise" OR route_95_template_95_availability: "'+r+'" ) AND policycurrent:"Route Template.Active" AND latestrevision:"TRUE" AND name:'+i+")":'(flattenedtaxonomies:"types/Route Template" AND route_95_base_95_purpose:"Approval" AND (route_95_template_95_availability: "Enterprise" OR route_95_template_95_availability: "'+r+'" ) AND policycurrent:"Route Template.Active" AND latestrevision:"TRUE" AND name:'+i+') OR (flattenedtaxonomies:"types/Person" AND policycurrent:"Person.Active" AND fullname:"'+i+'")',order_by:"desc",order_field:"relevance",nresults:1e3,start:"0",source:[],tenant:t.getGlobalVariable().tenant},c=(l=JSON.stringify(l),{isfederated:!0});n.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",l,function(t){var n=[];t&&t.results&&Array.isArray(t.results)&&t.results.forEach(function(e){var t={};e.attributes.forEach(function(e){"ds6w:what/ds6w:type"===e.name&&(t.type=e.value),"resourceid"===e.name&&(t.id=e.value),"ds6w:identifier"===e.name&&(t.identifier=e.value),"Person"===t.type?"ds6wg:fullname"===e.name&&(t.name=e.value):"ds6w:identifier"===e.name&&(t.name=e.value)}),n.push(t)});e(n)},function(e){s(e)},c)})},getListMember:function(e){var i=e.categoryId,a=e.contextUser,r=this;return new Promise(function(e,o){var s="";s="reviewer"!==i||"reviewer"===i&&"Person"===r.reviewerType.typeOfReviewer?'(flattenedtaxonomies:"types/Person" AND policycurrent:"Person.Active" )':"reviewer"===i&&"Route Template"===r.reviewerType.typeOfReviewer?'(flattenedtaxonomies:"types/Route Template" AND route_95_base_95_purpose:"Approval" AND (route_95_template_95_availability: "Enterprise" OR route_95_template_95_availability: "'+a+'" ) AND policycurrent:"Route Template.Active" AND latestrevision:"TRUE")':'(flattenedtaxonomies:"types/Route Template" AND route_95_base_95_purpose:"Approval" AND (route_95_template_95_availability: "Enterprise" OR route_95_template_95_availability: "'+a+'" ) AND policycurrent:"Route Template.Active" AND latestrevision:"TRUE") OR (flattenedtaxonomies:"types/Person" AND policycurrent:"Person.Active" )';let l={"3dspace":{SecurityContext:t.getGlobalVariable().getSecurityContext()}};var c={with_indexing_date:!0,with_nls:!1,label:"yus-1515078503005",locale:"en",select_predicate:["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:responsible","ds6wg:fullname"],select_file:["icon","thumbnail_2d"],query:s,order_by:"desc",order_field:"relevance",nresults:1e3,start:"0",source:[],tenant:t.getGlobalVariable().tenant,login:l},u=(c=JSON.stringify(c),{isfederated:!0});n.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",c,function(t){var n=[];t&&t.results&&Array.isArray(t.results)&&t.results.forEach(function(e){var t={};e.attributes.forEach(function(e){"ds6w:what/ds6w:type"===e.name&&(t.type=e.value),"resourceid"===e.name&&(t.id=e.value),"ds6w:identifier"===e.name&&(t.identifier=e.value),"Person"===t.type?"ds6wg:fullname"===e.name&&(t.name=e.value):"ds6w:identifier"===e.name&&(t.name=e.value)}),n.push(t)});e(n)},function(e){o(e)},u)})},getListCOMember:function(e){var i=e.categoryId,a=e.contextUser;return new Promise(function(e,r){var o="";if("follower"===i||"assignee"===i){o='(flattenedtaxonomies:"types/Person" AND policycurrent:"Person.Active")',o+="OnPremise"==t.getGlobalVariable().tenant?' OR (flattenedtaxonomies:"types/Group" AND current:"active")':" OR ([ds6w:type]:(Group))"}else o="changeCordinator"===i?'(flattenedtaxonomies:"types/Person" AND policycurrent:"Person.Active"  AND (userrole:"Change Coordinator" OR userrole:"VPLMProjectLeader"))':'(flattenedtaxonomies:"types/Route Template" AND route_95_base_95_purpose:"Approval" AND (route_95_template_95_availability: "Enterprise" OR route_95_template_95_availability: "'+a+'" ) AND policycurrent:"Route Template.Active" AND latestrevision:"TRUE")';var s={with_indexing_date:!0,with_nls:!1,label:"yus-1515078503005",locale:"en",select_predicate:["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:responsible","ds6wg:fullname"],select_file:["icon","thumbnail_2d"],query:o,order_by:"desc",order_field:"relevance",nresults:1e3,start:"0",source:[],tenant:t.getGlobalVariable().tenant},l=(s=JSON.stringify(s),{isfederated:!0});n.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",s,function(n){var i=[];n&&n.results&&Array.isArray(n.results)&&n.results.forEach(function(e){var n={},a=e.attributes;"OnPremise"==t.getGlobalVariable().tenant?a.forEach(function(e){"ds6w:what/ds6w:type"===e.name&&(n.type=e.value),"resourceid"===e.name&&(n.id=e.value),"ds6w:identifier"===e.name&&(n.identifier=e.value),"Person"===n.type?"ds6wg:fullname"===e.name&&(n.name=e.value):"Group"===n.type?"ds6w:label"===e.name&&(n.name=e.value):"ds6w:identifier"===e.name&&(n.name=e.value)}):a.forEach(function(e){"ds6w:what/ds6w:type"===e.name&&(n.type=e.value,n.type.includes("foaf")&&(n.type=n.type.slice(5))),"resourceid"===e.name&&(n.id=e.value),"ds6w:identifier"===e.name&&(n.identifier=e.value),"Person"===n.type?"ds6wg:fullname"===e.name&&(n.name=e.value):"ds6w:label"===e.name&&(n.name=e.value)}),i.push(n)});e(i)},function(e){r(e)},l)})},_addFullNameToPersonObject:function(e,t){var n=e.changeaction.people;Array.isArray(n)&&n.forEach(function(e){var n=e.name;if(t&&t[n]){var i=t[n].userDisplayName;e.fullName=i,e.id=t[n].id}})},getAvatarDetails:function(e){var t={},n="",i=[[7,139,250],[249,87,83],[111,188,75],[158,132,106],[170,75,178],[26,153,123],[245,100,163],[255,138,46]],a=e.split(" "),r=a[0].charAt(0),o=a[a.length-1];o&&(n=o.charAt(0));var s=r+n,l=Math.ceil((r.charCodeAt(0)+n.charCodeAt(0))%i.length),c="rgb("+i[l][0]+","+i[l][1]+","+i[l][2]+")";return t.name=e,t.avatarStr=s,t.avatarColor=c,t},getFormatedMemberDetails:function(e){var t=[];return e.forEach(function(e){var n={};n.id=e.get("id"),n.rolesToDisplay=e.get("rolesToDisplay"),n.fullName=e.get("fullName"),n.userName=e.get("userName"),n.type=e.get("type"),n.role=e.get("role"),t.push(n)}),t},createMemberList:function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].name);return t},processedMemberListWithName:function(e){for(var t=e.processList,n=0;n<t.members.length;n++){var i=t.members[n];i.fullname=e[i.name].userDisplayName}return t}}}),define("DS/ENOChgServices/scripts/factories/ChangeActionFactory",["UWA/Core","UWA/Class","UWA/Class/Debug","UWA/Class/Events","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable"],function(e,t,n,i,a,r){"use strict";return t.extend(n,i,{init:function(e){this._options=e,console.log(e)},loadInfraForWidget:function(){return new Promise(function(e,t){a.PopulatePreferences().then(function(t){a.getExpressionValue().then(function(t){a.fetchSubTypes(),e()})})})},loadWidget:function(e){if("undefined"==typeof dscef||r.getGlobalVariable().isPoweredBy){var t=null,n=widget.getValue("X3DContentId")?JSON.parse(widget.getValue("X3DContentId")):null,i=widget.getValue("TransientCAPid"),o=(c=widget.getValue("originatingPid"),u=widget.getValue("objName"),d=widget.getValue("originatingcaName"),p=widget.getValue("status"),widget.getValue("nameTitlePref"));if(null===n||void 0!==widget.getValue("lastRootNodeID")||widget.getValue("clearInPreview"))if(i)UWA.is(i)&&a.IsChangeAction(i).then(function(t){"TRUE"===t.isChangeAction?e({type:"IDCard",options:{transientCAPid:"pid:"+i,originatingCAPid:c,originatingCAName:d,objNametoFilterforFlowDown:u,isFromFlowDown:p,nameTitlePref:o}}):""!=that.caGlobalObject.mySecurityContext&&e({type:"LoadSummary",options:null})});else{if(""!=r.getGlobalVariable().getSecurityContext().mySecurityContext)e({type:"LoadSummary",options:null})}else{var s=n.data;if(null!==s&&s.items.length>0){var l=s.items[s.items.length-1];t=l.objectId,UWA.is(t)&&a.IsChangeAction(t).then(function(n){"TRUE"===n.isChangeAction?e({type:"IDCard",options:{transientCAPid:"pid:"+t,originatingCAPid:c,originatingCAName:d,objNametoFilterforFlowDown:u,isFromFlowDown:p,nameTitlePref:o}}):""!=r.getGlobalVariable().getSecurityContext()&&e({type:"LoadSummary",options:null})},function(e){return console.log("widget initilization failed"),Promise.reject(e)})}}}else{widget.body.empty();var c="",u="",d="",p=!1;this._options&&this._options.flowdown&&(c=this._options.flowdown.originatingPid,u=this._options.flowdown.objName,p=this._options.flowdown.status,d=this._options.flowdown.originatingcaName,nameTitlePref=this._options.flowdown.nameTitlePref);var g="pid:"+this._options.pid;e({type:"IDCard",options:{transientCAPid:g,originatingCAPid:c,originatingCAName:d,objNametoFilterforFlowDown:u,isFromFlowDown:p,nameTitlePref:"Title"}})}}})}),define("DS/ENOChgServices/scripts/services/ChgDataProcess",["i18n!DS/ENOChgServices/assets/nls/ChgServiceNLS","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgMembersServices","WebappsUtils/WebappsUtils","DS/PlatformAPI/PlatformAPI","DS/ENOChgServices/scripts/services/ChgInfraService","DS/WidgetServices/WidgetServices","DS/TreeModel/BaseFilter","text!DS/ENOChgServices/assets/ChangeViewsNLSMapping.json"],function(e,t,n,i,a,r,o,s,l){"use strict";var c={processCASummaryList:function(t){var n=[],i=[],a={},r=[],o=[],s=t.details.owner;null!=s&&null!=s&&s.forEach(function(t){t.contextUserRole=e.ECM_CA_Team_Owner,i.push(t.id),r.push(t.owner),a[t.id]=t});var l=t.details.contributor;null!=l&&null!=l&&l.forEach(function(t){-1==i.indexOf(t.id)?(t.contextUserRole=e.ECM_CA_Summary_Contributor,i.push(t.id),r.push(t.owner),a[t.id]=t):a[t.id].contextUserRole+=", "+e.ECM_CA_Summary_Contributor});var c=t.details.reviewer;null!=c&&null!=c&&c.forEach(function(t){-1==i.indexOf(t.id)?(t.contextUserRole=e.ECM_CA_Summary_Reviewer,i.push(t.id),r.push(t.owner),a[t.id]=t):a[t.id].contextUserRole+=", "+e.ECM_CA_Summary_Reviewer});var u=t.details.follower;return null!=u&&null!=u&&u.forEach(function(t){-1==i.indexOf(t.id)?(t.contextUserRole=e.ECM_CA_Summary_Follower,i.push(t.id),r.push(t.owner),a[t.id]=t):a[t.id].contextUserRole+=", "+e.ECM_CA_Summary_Follower}),i.forEach(function(t){var n=a[t],i=n.id;i=(i=i.split("pid:"))[1];var r=n.name,s=n.owner,l=n.current,c=0;"In Work"==l?c=1:"In Approval"==l?c=2:"Approved"==l&&(c=3),l=n.currentNLS;var u=n.type,d=n.attributes.Severity,p=0;"Medium"==d?p=1:"High"==d&&(p=2),d=e.get("CHG_CA_Severity_"+d);var g=n.attributes.Synopsis,f=n.attributes.EstimatedCompletionDate,m=n.contextUserRole,h=n["Change On Hold"],v=(n.contextUserRole,""),C="";n.group&&(v=n.group.title,C=n.group.id);var S={title:g,name:r,maturity:l,severity:d,responsible:s,userRole:m,id:i,type:u,displayType:u,severityGrade:p,stateGrade:c,recent:"",onHold:h,group:v,groupid:C,policy:"Change Action",icon:"https://vdevpril155plp.dsone.3ds.com:443/3DSpace/snresources/images/icons/large/I_Product_Thumbnail.png"};""!=f&&null!=f&&(S.dueDate=f),o.push(S)}),n.processData=o,n.memberList=r,n},processedListWithName:function(e){var t=e.processList;if(t){e.userDisplayName;for(var n=0;n<t.length;n++){var i=t[n],a=i.responsible;i.responsible=e[a].userDisplayName,i.ownerId=e[a].id,i.trigram=a}return t}},processChangeActionCreateData:function(t){var n=[],i=[],a=[],r=t.changeaction.name,o=t.changeaction.id,s=t.changeaction.policy;"pid"==o.substring(0,3)&&(o=o.substring(4));for(var l=t.changeaction.type,c=t.changeaction.icon,u=t.changeaction.image,d="",p="",g="",f="",m="",h=(f="",""),v=e.CHG_CA_Role_Owner,C=t.changeaction.attributes,S=0;S<C.length;S++)if("current"==C[S].name)d=C[S].value;else if("currentNLS"==C[S].name)p=C[S].value;else if("attribute_Severity"==C[S].name)g=C[S].value;else if("attribute_Synopsis"==C[S].name){f=this.escapeHTML(C[S].value)}else"interface[Change On Hold]"==C[S].name?C[S].value:"attribute_Originator"==C[S].name?m=C[S].value:"attribute_EstimatedCompletionDate"==C[S].name&&(h=C[S].value);h=h?new UWA.Date(h).strftime("%Y-%m-%d"):"";var b=0;"Medium"==g?b=1:"High"==g&&(b=2);var y=0;"In Work"==d?y=1:"In Approval"==d?y=2:"Approved"==d&&(y=3),d=d;var w={title:f,name:r,maturity:p,severity:g=e.get("CHG_CA_Severity_"+g),responsible:m,userRole:v,id:o,type:l,displayType:l,severityGrade:b,stateGrade:y,policy:s,icon:c,thumbnail:u};return""!=h&&null!=h&&(w.dueDate=h),i.push(w),a.push(m),n.processData=i,n.memberList=a,n},escapeHTML:e=>String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),makeObjList:function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n].id;t.push(i)}return t},createIconMap:function(e){var n={},i="",a="",r="";if(null!=e&&e.hasOwnProperty("results"))for(var o=e.results,s=0;s<o.length;s++){for(var l=e.results[s].attributes,c=0;c<l.length;c++){var u=l[c].name;"ds6w:type"==u&&(i=l[c].value),"type_icon_url"==u&&(a=l[c].value),"preview_url"==u&&(r=l[c].value)}n[i]=n[i]||[],n[i].push(a),n[i].push(r)}else{i="Change Action";a=t.getGlobalVariable().computeUrl("/snresources/images/icons/small/I_ECM_CA.png"),r=t.getGlobalVariable().computeUrl("/snresources/images/icons/large/I_ECM_CA108x144.png"),n[i]=n[i]||[],n[i].push(a),n[i].push(r)}t.setIconMap(n)},processCAListIndexed:function(n){var i=n.results,a=[];t.getGlobalVariable().existingCAIds=[];let r=t.getGlobalVariable().customeViewList;const o=function(e){let t,n,i,a;return n=(24+(new Date).getTimezoneOffset()/60)%24,t=e+" "+(i=Math.trunc(n))+":"+(a=n%1*60)+":00 UTC",t=Date.parse(t),new Date(t)};if(null!=i)for(var s=0;s<i.length;s++){for(var l=i[s].attributes,u="",d="",p=[],g=[],f=[],m=[],h="",v="",C="",S="",b="",y="",w="",A="",O="",N="",I="false",E="false",_="false",T="",P="",D=[],R="",j="",x=0;x<l.length;x++)if("current"==l[x].name)u=l[x].value;else if("ds6w:what/ds6w:type"==l[x].name)R=l[x].value;else if("ds6w:what/ds6w:policy"==l[x].name)j=l[x].value;else if("resourceid"==l[x].name)b=l[x].value;else if("type_icon_url"==l[x].name)y=l[x].value;else if("preview_url"==l[x].name)w=l[x].value;else if("ds6w:dueDate"==l[x].name){d=o(l[x].value).toLocaleDateString()}else if("ds6w:who/ds6w:responsible"==l[x].name)N=l[x].value;else if("ds6w:responsible"==l[x].name)N=l[x].value;else if("owner"==l[x].name){(O=l[x].value)==t.getGlobalVariable().contextUser&&(A="Owner")}else"ECM_CHG_ON_HOLD"==l[x].name?S=l[x].value:"ds6w:why/ds6w:fulfills/ds6w:severity"==l[x].name?h=l[x].value:"ds6w:label"==l[x].name?v=l[x].value:"ds6w:identifier"==l[x].name?C=l[x].value:"ECM_CA_ASSIGNEE_FULL_NAME"==l[x].name?p.push(l[x].value):"ECM_CA_FOLLOWERS_FULL_NAME"==l[x].name?g.push(l[x].value):"ECM_CA_DIRECT_REVIEWER_FULL_NAME"==l[x].name?f.push(l[x].value):"ECM_ROUTE_TEMPLATE_LABEL"==l[x].name?D.push(l[x].value):"ECM_CA_ATTACHMENT_ID"==l[x].name?(m.push(l[x].value),E="attach"):"ECM_CHANGE_REJECTION"==l[x].name?"Reject"==l[x].value&&(_="thumbs-down"):"ECM_CHANGE_ACTION_GROUP_NAME"==l[x].name?T=l[x].value:"ECM_CHANGE_ACTION_GROUP_PHYSICALID"==l[x].name&&(P=l[x].value);t.getGlobalVariable().existingCAIds.push(b);d=d?new UWA.Date(d).strftime("%Y-%m-%d"):"";var W=0;"Medium"==h?W=1:"High"==h&&(W=2);var U=0;"In Work"==u?U=1:"In Approval"==u?U=2:"Approved"==u&&(U=3),"TRUE"==S&&(I="true");var L={title:v,name:C,maturity:j+"."+u,severity:h=e.get("CHG_CA_Severity_"+h),responsible:N,userRole:A,id:b,type:R,displayType:R,severityGrade:W,stateGrade:U,recent:"",iconURL:y,previewURL:w,changeReviewer:f,changeFollower:g,changeAssignee:p,owner:O,onHold:I,referential:E,reject:_,referentialList:m,changeApprover:D,group:T,groupId:P,policy:j};""!=d&&null!=d&&(L.dueDate=d);let n=this.updateObjectWithCustom(r,l,L);a.push(n)}return new Promise(function(e,t){c.getNLSForProcessedList("CASummary",a).then(function(){e(a)},function(){e(a)})})},updateObjectWithCustom:function(e,t,n){for(let i of e)for(let e of t)e.name.endsWith(i)&&(n[i]=e.value);return n},getGridColumnNameForIndexTag:function(e){return{current:"state","ds6w:why/ds6w:fulfills/ds6w:severity":"severity","ds6w:what/ds6w:status":"maturity","ds6w:what/ds6w:type":"type","ds6w:who/ds6w:responsible":"responsible"}[e]},getAttribute:function(e,t){if("undefined"!=e.changeaction&&e.changeaction.attributes)for(var n=e.changeaction.attributes,i=0;i<n.length;i++)if(n[i].name==t)return n[i].value;return null},processTimestampData:function(e){var t="";return e.FTS&&(t=e.FTS.allvaultsacl),t},getThumbnailURL:function(e,n){var i={},a=[],r=[];n.forEach(function(e){for(var t=e.attributes,n="",a="",r="",o="",s=0;s<t.length;s++)"resourceid"==t[s].name?n=t[s].value:"ds6w:docextension"==t[s].name?a=t[s].value:"preview_url"==t[s].name?r=t[s].value:"type_icon_url"==t[s].name&&(o=t[s].value);var l={docextension:a,preview_url:r,icon_url:o};i[n]=l});for(var o=["JPG","JPEG","PNG","BMP","GIF"],s=0;s<e.length;s++){var l=!1,c="",u=e[s],d=u.caPhyid,p=u.referentialList;if(0!=p.length)for(var g=p.length-1;g>=0;g--){var f=p[g];if(i.hasOwnProperty(f)){var m=null!=(f=i[f]).docextension?f.docextension:"temp;";if(o.includes(m.toUpperCase())){c=f.preview_url,l=!0;break}}}1==l?(a[d]=c,r[d]=c):r[d]=u.previewURL}return t.setPreviewURLArray(r),a},getThumbnailURLForNonIndexed:function(e,n){for(var i=["JPG","JPEG","PNG","BMP","GIF"],a="",r=!1,o=[],s=e.options.grid.id,l=n.length-1;l>=0;l--){var c=null!=n[l].dataelements&&null!=n[l].dataelements.fileExtension?n[l].dataelements.fileExtension.slice(1):"temp";if(console.log(t),i.includes(c.toUpperCase())){a=n[l].dataelements.image,r=!0;break}}return(o=null!=(o=t.getPreviewURLArray())?o:[])[s]=1==r?a:e.options.grid.previewURL,t.setPreviewURLArray(o),a},processOwnerID:function(e){for(var t=[],n=0;n<e.length;n++)"owner"==e[n].role&&t.push(e[n].name);return t},createCustomOwnerField:function(e){var i="/api/user/getpicture/login/"+e.id+"/format/normal",a=t.getGlobalVariable().computeSwymUrl(i),r=new UWA.Element("div",{class:"members"}),o=new UWA.Element("div",{class:"assignee"}),s="";if(t.getGlobalVariable().isSwymInstalled)s=UWA.createElement("img",{class:"userIcon",src:a});else{var l=n.getAvatarDetails(e.fullName);(s=UWA.createElement("div",{html:l.avatarStr,class:"avatarIcon"})).style.setProperty("background",l.avatarColor)}s.inject(o);var c=UWA.createElement("span",{class:"userName",html:e.fullName});return o.inject(r),c.inject(r),r.outerHTML},processedCOSummaryList:function(e){var n=[],i=e.data;if(t.getGlobalVariable().existingCOIds=[],null!=i)for(var a=0;a<i.length;a++){var r,o,s,l,u,d,p,g,f,m,h,v,C,S,b,y,w,A,O="",N="";let e="ChangeOrder",c="",T="";r=i[a].id,o=i[a].type,A=i[a].typeNLS,l=i[a].name,u=i[a].revision,s=i[a].title,i[a].severity,g=i[a].severityNLS,p=i[a].current,f=i[a].currentNLS,y=i[a].description,m=i[a].project,h=i[a].organization,c=i[a].policy,v=i[a].icon,d=i[a].severity,T=i[a].applicability,i[a].changeCoordinator&&(O=i[a].changeCoordinator),i[a].changeCoordinatorFullName&&(N=i[a].changeCoordinatorFullName),C=i[a].owner,S=i[a].ownerFullName,b=i[a].previewicon,w="TRUE"===i[a].ecm_change_on_hold?"true":"false";var I=0;"Medium"==d?I=1:"High"==d&&(I=2);var E=0;"In Work"==p?E=1:"In Approval"==p?E=2:"Approved"==p&&(E=3),t.getGlobalVariable().existingCOIds.push(r);var _={id:r,type:o,typeNLS:A,title:s,name:l,revision:u,maturity:p,maturityKey:c+"."+p,maturityNLS:f,severity:d,severityNLS:g,description:y,collabspace:m,organization:h,iconURL:v,changeCoordinator:O,changeCoordinatorFullName:N,owner:C,ownerFullName:S,thumbnail:b,severityGrade:I,stateGrade:E,onHold:w,isKindOfType:e,applicabilityNLS:T};n.push(_)}return new Promise(function(e,t){c.getNLSForProcessedList("COSummary",n).then(function(){e(n)},function(){e(n)})})},processedCAList:function(e){var t=[],n=e.data;if(null!=n)for(var i=0;i<n.length;i++){var a,r,o,s,l,c,u,d,p,g;let e="ChangeAction",m="";a=n[i].id,r=n[i].type,s=n[i].name,o=n[i].title,l=n[i].severity,u=n[i].severityNLS,c=n[i].current,d=n[i].currentNLS,p=n[i].project,g=n[i].organization,m=n[i].policy;var f={id:a,type:r,title:o,name:s,maturity:c,maturityNLS:d,severity:l,severityNLS:u,collabspace:p,organization:g,iconURL:n[i].icon,owner:n[i].owner,ownerFullName:n[i].ownerFullName,thumbnail:n[i].previewicon,isKindOfType:e};t.push(f)}return t},getNLSForProcessedList:(e,t)=>new Promise(function(n,i){var a={};if(t&&t.length>0){for(var o=JSON.parse(l)[e],s=0;s<t.length;s++){var c=t[s];Object.keys(o).forEach(function(e){var t=o[e];a[t]?a[t].push(c[e]):a[t]=[c[e]]})}r.getNLSValuesPromise(a).then(function(i){for(var a=0;a<t.length;a++){var r=t[a];Object.keys(o).forEach(function(t){var n=o[t];"CASummary"==e?i[n]&&i[n][r[t]]?r[t]=i[n][r[t]]:r[t]=r[t]:i[n]&&i[n][r[t]]?r[t+"NLS"]=i[n][r[t]]:r[t+"NLS"]=r[t]})}n(t)},function(e){return n(t)})}else n(t)}),processedChangeOrchestrationSummaryList:function(e){var t=[],n=e.data;if(null!=n)for(var i=0;i<n.length;i++){var a,r,o,s,l,u,d,p,g,f,m,h,v,C,S,b,y="",w="",A="";a=n[i].id,r=n[i].type,b=n[i].dataelements.typeNLS,s=n[i].dataelements.name,l=n[i].dataelements.revision,o=n[i].dataelements.title,n[i].dataelements.severity,p=n[i].dataelements.severityNLS,d=n[i].dataelements.current,g=n[i].dataelements.currentNLS,v=n[i].dataelements.description,S=n[i].dataelements.ecm_change_on_hold,f=n[i].dataelements.project,m=n[i].dataelements.organization,h=n[i].dataelements.icon,u=n[i].dataelements.severity,A=1==(C="TRUE"===n[i].dataelements.isChangeAction)?"ChangeAction":"ChangeOrder",n[i].dataelements.changeCoordinator&&(y=n[i].dataelements.changeCoordinator),n[i].dataelements.changeCoordinatorFullName&&(w=n[i].dataelements.changeCoordinatorFullName);var O=0;"Medium"==u?O=1:"High"==u&&(O=2);var N=0;"In Work"==d?N=1:"In Approval"==d?N=2:"Approved"==d&&(N=3);var I={id:a,type:r,typeNLS:b,title:o,name:s,revision:l,maturity:d,maturityNLS:g,severity:u,severityNLS:p,description:v,collabspace:f,organization:m,iconURL:h,changeCoordinator:y,changeCoordinatorFullName:w,owner:n[i].dataelements.owner,ownerFullName:n[i].dataelements.ownerFullName,thumbnail:n[i].dataelements.previewicon,severityGrade:O,stateGrade:N,isKindOfChangeAction:C,ecm_change_on_hold:S,isKindOfType:A};t.push(I)}return new Promise(function(e,n){c.getNLSForProcessedList("COOrchestration",t).then(function(){e(t)},function(){e(t)})})},processChangeOrderRecentList:function(e,t){var n=[],i=e.data;if(null!=i)for(var a=0;a<i.length;a++){var r,o,s,l,c,u,d,p,g,f,m,h,v,C,S,b,y="",w="";r=i[a].id,o=i[a].type,b=i[a].typeNLS,l=i[a].name,c=i[a].revision,s=i[a].title,i[a].severity,p=i[a].severityNLS,d=i[a].current,g=i[a].currentNLS,v=i[a].description,S="TRUE"===i[a].ecm_change_on_hold?"true":"false",f=i[a].project,m=i[a].organization,h=i[a].icon,u=i[a].severity,C="TRUE"===i[a].isChangeAction,i[a].changeCoordinator&&(y=i[a].changeCoordinator),i[a].changeCoordinatorFullName&&(w=i[a].changeCoordinatorFullName);var A=0;"Medium"==u?A=1:"High"==u&&(A=2);var O=0;"In Work"==d?O=1:"In Approval"==d?O=2:"Approved"==d&&(O=3);var N={id:r,type:o,typeNLS:b,title:s,name:l,revision:c,maturity:d,maturityNLS:g,severity:u,severityNLS:p,description:v,collabspace:f,organization:m,iconURL:h,changeCoordinator:y,changeCoordinatorFullName:w,owner:i[a].owner,ownerFullName:i[a].ownerFullName,thumbnail:i[a].previewicon,severityGrade:A,stateGrade:O,isKindOfChangeAction:C,onHold:S,isKindOfType:t};n.push(N)}return n},processedChangeOrderPutOnHOld:function(e){return{id:e.userDisplayName.data[0].id,type:e.userDisplayName.data[0].type,accessBits:e.userDisplayName.data[0].dataelements}},processedChangeOrderOnResume:function(e){return{id:e.userDisplayName.data[0].id,type:e.userDisplayName.data[0].type,accessBits:e.userDisplayName.data[0].dataelements}},processedChangeOrderOnCancel:function(e){return{id:e.userDisplayName.data[0].id,type:e.userDisplayName.data[0].type,accessBits:e.userDisplayName.data[0].dataelements}},processedChangeRequestPutOnHoldResumeCancel:function(e){return{id:e.data[0].id,type:e.data[0].type,accessBits:e.data[0]}},processedChangeActionPutOnHoldResumeCancel:function(e){return{id:e.data[0].id,type:e.data[0].type,accessBits:e.data[0]}},processChangeActionInContext:function(n){var i=[],a=[],r=n.changeaction.name,o=n.changeaction.id;"pid"==o.substring(0,3)&&(o=o.substring(4));var s,l,c=n.changeaction.type,u="",d="",p="",g="",f=(p="","");e.CHG_CA_Role_Owner;for(var m=n.changeaction.attributes,h=0;h<m.length;h++)"current"==m[h].name?u=m[h].value:"attribute_Severity"==m[h].name?d=m[h].value:"attribute_Synopsis"==m[h].name?p=m[h].value:"interface[Change On Hold]"==m[h].name?m[h].value:"attribute_Originator"==m[h].name?g=m[h].value:"attribute_EstimatedCompletionDate"==m[h].name&&(f=m[h].value);f=f?new UWA.Date(f).strftime("%Y-%m-%d"):"";var v=0;"Medium"==d?v=1:"High"==d&&(v=2);var C=0;"In Work"==u?C=1:"In Approval"==u?C=2:"Approved"==u&&(C=3),s=e.get("CHG_CA_State_"+u),l=e.get("CHG_CA_Severity_"+d);var S=t.getGlobalVariable().collabspace,b=t.getGlobalVariable().organization,y=t.getGlobalVariable().computeUrl("/snresources/images/icons/large/I_ECM_CA108x144.png"),w=t.getGlobalVariable().computeUrl("/snresources/images/icons/small/I_ECM_CA.png"),A={title:p,name:r,maturity:u,severity:d,maturityNLS:s,severityNLS:l,owner:g,id:o,type:c,displayType:c,severityGrade:v,stateGrade:C,collabspaceNLS:S,organizationNLS:b,ownerFullName:t.getGlobalVariable().contextUserFullName,changeCoordinator:"",changeCoordinatorFullName:"",iconURL:w,thumbnail:y,isKindOfChangeAction:!0,isKindOfType:"ChangeAction"};return""!=f&&null!=f&&(A.dueDate=f),a.push(A),i.processData=a,i},processedChangeOrderMemberList:function(e){var n=[],i=e.data;if(null!=i)for(var a=0;a<i.length;a++){var r,o,s,l,c,u,d="",p="";d="Group"==(r=i[a].type)&&"OnPremise"!=t.getGlobalVariable().tenant&&i[a].dataelements.hasOwnProperty("groupURI")?i[a].dataelements.groupURI:i[a].id,o="Group"==r?i[a].dataelements.title:i[a].dataelements.name,s=i[a].dataelements.userid,p=i[a].dataelements.roles,l=i[a].dataelements.previewicon,c=i[a].dataelements.icon,u=p.toString();var g={id:d,type:r,fullName:o,userId:s,roles:p,role:u,thumbnail:l,icon:c};n.push(g)}return n},processAllApprovedRoutes:function(e){for(var t="",n=0;n<e.length;n++)if(e[n].routeInfo.data[0].dataelements.actions.indexOf("selectusers.tasks")>-1){t=e[n].routeInfo.data[0].id;break}return t},processFacetDataPromise:function(e){return new Promise(function(t,n){var i={};if(null!=e){for(var a=0;a<e.length;a++){var o=e[a],s=o.sixw,l=s.lastIndexOf("/"),c=s.slice(l+1);i[c]?i[c].push(o.object):i[c]=[o.object]}r.getNLSValuesPromise(i).then(function(n){for(var i=0;i<e.length;i++){var a=e[i],r=a.sixw,o=r.lastIndexOf("/"),s=r.slice(o+1);n[s]&&n[s][a.object]?a.dispValue=n[s][a.object]:a.dispValue=a.object}t(e)},function(e){return n(e)})}else t(e)})},processedCASummaryList:function(e){let t=[],n=e.data;if(null!=n)for(let e=0;e<n.length;e++){let i="",a="",r="",o="",s="",l="",c="",u="",d="",p="",g="",f="",m="",h="",v="",C="",S="",b="",y="false",w="",A="ChangeAction",O="";i=n[e].id,a=n[e].type,w=n[e].typeNLS,o=n[e].name,s=n[e].revision,r=n[e].title,l=n[e].severity,u=n[e].severityNLS,c=n[e].current,d=n[e].currentNLS,b=n[e].description,p=n[e].project,g=n[e].organization,f=n[e].icon,l=n[e].severity,O=n[e].applicability,n[e].changeCoordinator&&(m=n[e].changeCoordinator),n[e].changeCoordinatorFullName&&(h=n[e].changeCoordinatorFullName),v=n[e].owner,C=n[e].ownerFullName,S=n[e].previewicon,y="TRUE"===n[e].ecm_change_on_hold?"true":"false";let N=0;"Medium"==l?N=1:"High"==l&&(N=2);let I=0;"In Work"==c?I=1:"In Approval"==c?I=2:"Approved"==c&&(I=3);let E={id:i,type:a,typeNLS:w,title:r,name:o,revision:s,maturity:c,maturityNLS:d,severity:l,severityNLS:u,description:b,collabspace:p,organization:g,iconURL:f,changeCoordinator:m,changeCoordinatorFullName:h,owner:v,ownerFullName:C,thumbnail:S,severityGrade:N,stateGrade:I,onHold:y,isKindOfType:A,applicabilityNLS:O};t.push(E)}return new Promise(function(e,n){c.getNLSForProcessedList("CRSummary",t).then(function(){e(t)},function(){e(t)})})},processedCRSummaryList:function(e){let t=[],n=e.data;if(null!=n)for(let e=0;e<n.length;e++){let i="",a="",r="",o="",s="",l="",c="",u="",d="",p="",g="",f="",m="",h="",v="",C="",S="",b="",y="false",w="",A="ChangeRequest",O="";i=n[e].id,a=n[e].type,w=n[e].typeNLS,o=n[e].name,s=n[e].revision,r=n[e].title,l=n[e].severity,u=n[e].severityNLS,c=n[e].current,d=n[e].currentNLS,b=n[e].description,p=n[e].project,g=n[e].organization,f=n[e].icon,l=n[e].severity,O=n[e].applicability,n[e].changeCoordinator&&(m=n[e].changeCoordinator),n[e].changeCoordinatorFullName&&(h=n[e].changeCoordinatorFullName),v=n[e].owner,C=n[e].ownerFullName,S=n[e].previewicon,y="TRUE"===n[e].ecm_change_on_hold?"true":"false";let N=0;"Medium"==l?N=1:"High"==l&&(N=2);let I=0;"In Work"==c?I=1:"In Approval"==c?I=2:"Approved"==c&&(I=3);let E={id:i,type:a,typeNLS:w,title:r,name:o,revision:s,maturity:c,maturityNLS:d,severity:l,severityNLS:u,description:b,collabspace:p,organization:g,iconURL:f,changeCoordinator:m,changeCoordinatorFullName:h,owner:v,ownerFullName:C,thumbnail:S,severityGrade:N,stateGrade:I,onHold:y,isKindOfType:A,applicabilityNLS:O};t.push(E)}return new Promise(function(e,n){c.getNLSForProcessedList("CRSummary",t).then(function(){e(t)},function(){e(t)})})},processedChangeRequestNewIssueList:function(e){let n=[],i=t.getGlobalVariable();if(null!=e){let t="",a="",r="",o="",s="",l="",c="",u="",d="",p="",g="",f="",m="",h="";m=e.state,a=i.computeUrl("/"+e.icon),r=e.physicalId,g=e.type,p=e.title,s=e.organization,c=i.computeUrl("/"+e.image),u=e.collaborativeSpace,d=e.revision,o=e.name,l=e.owner.fullName,f=e.type;let v={type:g,state:m,revision:d,title:p,id:r,name:o,thumbnail:c,icon:a,maturity:t=e.policy+"."+e.state,ownerFullName:l,collabSpce:u,organization:s,policy:h=e.policy};n.push(v)}return new Promise(function(e,t){c.getNLSForProcessedList("createIssue",n).then(function(){e(n)},function(){e(n)})})},processCRChangeOrchestration:function(e){let t=[],n=e.data;if(null!=n)for(let e=0;e<n.length;e++){let i="",a="",r="",o="",s="",l="",c="",u="",d="",p="",g="",f="",m="",h="",v="",C="",S="",b="",y="false",w="",A=!1,O="";i=n[e].id,a=n[e].type,w=n[e].typeNLS,o=n[e].name,s=n[e].revision,r=n[e].title,l=n[e].severity,u=n[e].severityNLS,c=n[e].current,d=n[e].currentNLS,b=n[e].description,p=n[e].project,g=n[e].organization,f=n[e].icon,l=n[e].severity,n[e].changeCoordinator&&(m=n[e].changeCoordinator),n[e].changeCoordinatorFullName&&(h=n[e].changeCoordinatorFullName),v=n[e].owner,C=n[e].ownerFullName,S=n[e].previewicon,y="TRUE"===n[e].ecm_change_on_hold?"true":"false";let N=0;"Medium"==l?N=1:"High"==l&&(N=2);let I=0;"In Work"==c?I=1:"In Approval"==c?I=2:"Approved"==c&&(I=3);let E={id:i,type:a,typeNLS:w,title:r,name:o,revision:s,maturity:c,maturityNLS:d,severity:l,severityNLS:u,description:b,collabspace:p,organization:g,iconURL:f,changeCoordinator:m,changeCoordinatorFullName:h,owner:v,ownerFullName:C,thumbnail:S,severityGrade:N,stateGrade:I,ecm_change_on_hold:y,isKindOfType:O=1==(A="TRUE"===n[e].isChangeAction)?"ChangeAction":"ChangeOrder",isKindOfChangeAction:A};t.push(E)}return new Promise(function(e,n){c.getNLSForProcessedList("CROrchestration",t).then(function(){e(t)},function(){e(t)})})},processedChangeOrderDetail:function(e){var t=[],n=e.data;if(null!=n)for(var i=0;i<n.length;i++){var a,r,o,s,l,c,u,d,p,g,f,m,h,v,C="",S="";let e="ChangeOrder";a=n[i].id,r=n[i].type,v=n[i].dataelements.typeNLS,s=n[i].dataelements.name,l=n[i].dataelements.revision,o=n[i].dataelements.title,n[i].dataelements.severity,d=n[i].dataelements.severityNLS,u=n[i].dataelements.current,p=n[i].dataelements.currentNLS,h=n[i].dataelements.description,g=n[i].dataelements.project,f=n[i].dataelements.organization,m=n[i].dataelements.icon,c=n[i].dataelements.severity,n[i].dataelements.changeCoordinator&&(C=n[i].dataelements.changeCoordinator),n[i].dataelements.changeCoordinatorFullName&&(S=n[i].dataelements.changeCoordinatorFullName);var b=0;"Medium"==c?b=1:"High"==c&&(b=2);var y=0;"In Work"==u?y=1:"In Approval"==u?y=2:"Approved"==u&&(y=3);var w={id:a,type:r,typeNLS:v,title:o,name:s,revision:l,maturity:u,maturityNLS:p,severity:c,severityNLS:d,description:h,collabspace:g,organization:f,iconURL:m,changeCoordinator:C,changeCoordinatorFullName:S,owner:n[i].dataelements.owner,ownerFullName:n[i].dataelements.ownerFullName,thumbnail:n[i].dataelements.previewicon,severityGrade:b,stateGrade:y,onHold:"TRUE"===n[i].dataelements.ecm_change_on_hold?"true":"false",isKindOfType:e};t.push(w)}return t},processedChangeRequestMemberList:function(e){var n=[],i=e.data;if(null!=i)for(var a=0;a<i.length;a++){var r,o,s,l,c,u,d="",p="";d="Group"==(r=i[a].type)&&"OnPremise"!=t.getGlobalVariable().tenant?i[a].groupURI:i[a].id,o="Group"==r?i[a].title:i[a].name,s=i[a].userid,p=i[a].roles,l=i[a].previewicon,c=i[a].icon,u=p.toString();var g={id:d,type:r,fullName:o,userId:s,roles:p,role:u,thumbnail:l,icon:c};n.push(g)}return n},processedChangeRequestIssueList:function(e){var t=[],n=e.data;if(null!=n)for(var i=0;i<n.length;i++){var a,r,o,s,l,c,u,d;r=n[i].id,l=n[i].typeNLS,d=n[i].typeNLS,u=n[i].type,c=n[i].title,o=n[i].ownerFullName,s=n[i].previewicon,a=n[i].icon;var p={type:u,typeNLS:d,revision:l,title:c,id:r,name:n[i].name,thumbnail:s,icon:a,maturity:n[i].current,maturityNLS:n[i].currentNLS,ownerFullName:o,collabSpce:n[i].project,organization:n[i].organization,relId:n[i].relId,policy:n[i].policyNLS,policyNLS:n[i].policyNLS};t.push(p)}return t},processedChangeRequestRelatedScope:function(e){var t=[],n=e.data;if(null!=n)for(var i=0;i<n.length;i++){var a,r,o,s,l,c,u,d;r=n[i].id,l=n[i].revision,d=n[i].typeNLS,u=n[i].type,c=n[i].title,o=n[i].ownerFullName,s=n[i].previewicon,a=n[i].icon;var p={type:u,typeNLS:d,revision:l,title:c,id:r,name:n[i].name,previewicon:s,icon:a,maturity:n[i].current,currentNLS:n[i].currentNLS,ownerFullName:o,collabSpce:n[i].project,organization:n[i].organization,relId:n[i].relId};t.push(p)}return t},processCRAffectedItems:function(e){var t=[],n=e.data;if(null!=n)for(var i=0;i<n.length;i++){let e="",a="",r="",o="",s="",l="",c="",u="",d="",p="",g="",f="",m=0,h="",v="";a=n[i].id,r=n[i].type,c=n[i].name,f=n[i].current,g=n[i].currentNLS,e=n[i].title,s=n[i].previewicon,l=n[i].icon,d=n[i].project,p=n[i].organization,o=n[i].typeNLS;let C={id:a,type:r,revision:u=n[i].revision,typeNLS:o,thumbnail:s,maturity:f,maturityNLS:g,icon:l,name:c,title:e,countImpactAnalysis:m=n[i].impactAnalysis.length,collabspace:d,organization:p,reasonForChange:h=n[i].reasonForChange,ownerFullName:v=n[i].ownerFullName};t.push(C)}return new Promise(function(e,n){c.getNLSForProcessedList("CRAffectedItems",t).then(function(){e(t)},function(){e(t)})})},processCRImpactAnalysis:function(t,n){let i=[],a=t.data;if(null!=a)for(let t=0;t<a.length;t++){let r="",o="",s="",l="",c="",u="",d="",p="",g="",f="",m=0,h=0,v=0,C=0,S="ChangeAnalysis",b=0,y="true",w=0,A="true",O=0,N="true",I=0,E="true",_=0,T="true",P="";o=a[t].id,s=a[t].type,p=a[t].name,r=a[t].title;let D={id:o,type:s,thumbnail:l=a[t].previewicon,icon:c=a[t].icon,name:p,title:r,owner:u=a[t].owner,ownerFullName:d=a[t].ownerFullName,maturity:f=a[t].current,maturityNLS:g=a[t].currentNLS,countImpactBasis:m=parseInt(a[t].impactBasisCount),countImpactedItems:h=parseInt(a[t].impactedItemsCount),countAttachment:v=parseInt(a[t].attachmentCount),countContributors:C=parseInt(a[t].contributorsCount),isKindOfType:S,parentCRId:n,benefitImpact:b=a[t]["Default Change Analysis Metrics.Benefit Impact"]?parseInt(a[t]["Default Change Analysis Metrics.Benefit Impact"]):e.CHG_NOT_VALID_VALUE,benefitImpactValid:y=a[t]["Default Change Analysis Metrics.Benefit Impact"]?"true":"false",costImpact:w=a[t]["Default Change Analysis Metrics.Cost Impact"]?parseInt(a[t]["Default Change Analysis Metrics.Cost Impact"]):e.CHG_NOT_VALID_VALUE,costImpactValid:A=a[t]["Default Change Analysis Metrics.Cost Impact"]?"true":"false",validationEffort:O=a[t]["Default Change Analysis Metrics.Validation Effort"]?parseInt(a[t]["Default Change Analysis Metrics.Validation Effort"]):e.CHG_NOT_VALID_VALUE,validationEffortValid:N=a[t]["Default Change Analysis Metrics.Validation Effort"]?"true":"false",riskImpact:I=a[t]["Default Change Analysis Metrics.Risk Impact"]?parseInt(a[t]["Default Change Analysis Metrics.Risk Impact"]):e.CHG_NOT_VALID_VALUE,riskImpactValid:E=a[t]["Default Change Analysis Metrics.Risk Impact"]?"true":"false",implementationEffort:_=a[t]["Default Change Analysis Metrics.Implementation Effort"]?parseInt(a[t]["Default Change Analysis Metrics.Implementation Effort"]):e.CHG_NOT_VALID_VALUE,implementationEffortValid:T=a[t]["Default Change Analysis Metrics.Implementation Effort"]?"true":"false",cancelComment:P=a[t].cancelComment};i.push(D)}return i},processChangeActionDetails:function(t){let n=[],i=t.data;if(null!=i)for(let t=0;t<i.length;t++){let a="",r="",o="",s="",l="",c="",u="",d="",p="",g="",f="",m="",h="",v="",C="",S="",b="",y="",w="false",A="",O="ChangeAction";a=i[t].id,r=i[t].type,A=i[t].typeNLS,s=i[t].name,l=i[t].revision,o=i[t].title,c=i[t].severity,d=i[t].severityNLS,u=i[t].current,p=i[t].currentNLS,S=i[t].description,b=null!=i[t].groupId?"pid:"+i[t].groupId:"",y=null!=i[t].groupName?i[t].groupName:e.CHG_Header_Unassigned,g=i[t].project,f=i[t].organization,m=i[t].icon,c=i[t].severity,h=i[t].owner,v=i[t].ownerFullName,C=i[t].previewicon,w="TRUE"===i[t].ecm_change_on_hold?"true":"false";let N=0;"Medium"==c?N=1:"High"==c&&(N=2);let I=0;"In Work"==u?I=1:"In Approval"==u?I=2:"Approved"==u&&(I=3);let E={id:a,type:r,typeNLS:A,title:o,name:s,revision:l,maturity:u,maturityNLS:p,severity:c,severityNLS:d,description:S,collabspace:g,organization:f,iconURL:m,owner:h,ownerFullName:v,thumbnail:C,severityGrade:N,stateGrade:I,onHold:w,isKindOfType:O,groupId:b,groupName:y};n.push(E)}return n},processedChangeActionContext:function(e){var t=[],n=e.data;if(null!=n)for(var i=0;i<n.length;i++){var a,r,o,s,l,c,u,d;r=n[i].id,l=n[i].typeNLS,d=n[i].typeNLS,u=n[i].type,c=n[i].title,o=n[i].ownerFullName,s=n[i].previewicon,a=n[i].icon;var p={type:u,typeNLS:d,revision:l,title:c,id:r,name:n[i].name,previewicon:s,icon:a,maturity:n[i].current,currentNLS:n[i].currentNLS,ownerFullName:o,collabSpce:n[i].project,organization:n[i].organization,relId:n[i].relId};t.push(p)}return t},processChangeAction:function(e){var t=e;let n="";if(null!=t){let e="",i="",a="",r="",o="",s="",l="",c="",u="";a=t.id,c=t.type,r=t.name,t.current,e=t.currentNLS,l=t.title,s=t.previewicon,i=t.icon,o=t.organization,n={id:a,type:c,typeNLS:u=t.typeNLS,previewicon:s,current:e,currentNLS:e,icon:i,name:r,title:l,organization:o}}return n},processedChangeActionMemberList:function(e){let n=[],i=e.data;if(null!=i)for(let e=0;e<i.length;e++){let a="",r="",o="",s="",l="",c="",u="",d="";a="Group"==(r=i[e].type)&&"OnPremise"!=t.getGlobalVariable().tenant?i[e].groupURI:i[e].id,o="Group"==r?i[e].title:i[e].name,s=i[e].userid,l=i[e].roles,c=i[e].previewicon,u=i[e].icon,d=l.toString();let p={id:a,type:r,fullName:o,userId:s,roles:l,role:d,thumbnail:c,icon:u};n.push(p)}return n},processAccessBitCO:function(e){return"true"==t.getGlobalVariable().isFullLicence?e:("true"==t.getGlobalVariable().isLiteLicence&&(e.Delete&&(e.Delete="false"),e.Edit&&(e.Edit="false"),e.Hold&&(e.Hold="false"),e.Resume&&(e.Resume="false"),e.Cancel&&(e.Cancel="false"),e.SetCoordinator&&(e.SetCoordinator="false"),e.ManageRouteTemplates&&(e.ManageRouteTemplates="false"),e.setApplicability&&(e.setApplicability="false"),e.AddReferential&&(e.AddReferential="false"),e.Promote&&(e.Promote="false"),e.Demote&&(e.Demote="false"),e.ManageGovernedChanges&&(e.ManageGovernedChanges="false"),e.ManageReportedAgainst&&(e.ManageReportedAgainst="false"),e.ManageFollowers&&(e.ManageFollowers="false")),e)},processAccessBitCR:function(e){return"true"==t.getGlobalVariable().isFullLicence?e:("true"==t.getGlobalVariable().isLiteLicence&&(e.Hold&&(e.Hold="false"),e.Resume&&(e.Resume="false"),e.Cancel&&(e.Cancel="false"),e.Promote&&(e.Promote="false"),e.Demote&&(e.Demote="false"),e.ManageImplementingChanges&&(e.ManageImplementingChanges="false"),e.ManageChangeAnalysis&&(e.ManageChangeAnalysis="false")),e)},processAccessBitIA:function(e){return"true"==t.getGlobalVariable().isFullLicence?e:("true"==t.getGlobalVariable().isLiteLicence&&(e.Cancel&&(e.Cancel="false"),e.AddAssignee&&(e.AddAssignee="false"),e.RemoveAssignee&&(e.RemoveAssignee="false"),e.ManageImplementingChanges&&(e.ManageImplementingChanges="false")),e)},processAccessBitCA:function(e){return e.AddToGroup&&e.RemoveFromGroup&&(e.AddToGroup="true"==e.AddToGroup||"true"==e.RemoveFromGroup),"true"==t.getGlobalVariable().isFullLicence?e:("true"==t.getGlobalVariable().isLiteLicence&&(e.Hold&&(e.Hold="false"),e.Resume&&(e.Resume="false"),e.RealizedTransfer&&(e.RealizedTransfer="false"),e.Synchronization&&(e.Synchronization="false"),e.AddToGroup&&(e.AddToGroup="false")),e)},processedChangeActionBOMSync:function(e){return{id:e.userDisplayName.data[0].id,type:e.userDisplayName.data[0].type,accessBits:e.userDisplayName.data[0].dataelements}},getGetCellValueFunction:function(e,t){return"dateTime"===e?(e,n)=>o.formatDate(new Date(e.nodeModel.getAttributeValue(t)),!0):(e,n)=>e.nodeModel.getAttributeValue(t)},identifierNameFilter:s.inherit({isDataFiltered:function(e){const t=t=>{let n=e.options[t];return n?n.toLowerCase():n},n=t("identifier"),i=t("name");if(n&&i&&this.filterModel&&this.filterModel.text){const e=this.filterModel.text.toLowerCase();return!(n.includes(e)||i.includes(e))}return!1},isEmpty:function(){return!this.filterModel.text}}),uniqBy:function(e,...t){return t.filter(e=>e).flatMap(e=>[...e]).filter((n=new Set,function(t){return i=e(t),!n.has(i)&&n.add(i);var i}));var n},searchFromModelAndUniqAndAdd:function(e,t,n){return this.uniqBy(e,t.selectedItems,n.map(e).map(n=>t._model.getRoots().find(t=>e(t)===n))||[])},getDefaultFilter:function(e){var t={};for(let i in e){var n=e[i].dataIndex;"tree"==e[i].dataIndex?t.label={filterId:"stringRegexp",filterModel:""}:e[i].filterId?t[n]={filterId:e[i].filterId,filterModel:e[i].filterModel}:"boolean"==e[i].dataType?t[n]={filterId:"set",filterModel:[]}:"integer"==e[i].dataType||"real"==e[i].dataType?t[n]={filterId:"number",filterModel:""}:"string"==e[i].dataType&&(e[i].range?t[n]={filterId:"set",filterModel:[]}:t[n]={filterId:"stringRegexp",filterModel:""})}return t}};return c}),define("DS/ENOChgServices/scripts/services/ChgSearchConfigServcies",["UWA/Core","UWA/Utils/InterCom","UWA/Class/Model","DS/ENO6WPlugins/jQuery","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgMembersServices"],function(e,t,n,i,a,r){"use strict";var o=function(e){this.multiSelectVal=e,this.socketName="search_socket_"+(new Date).getTime(),this.socket=new t.Socket(this.socketName,{dispatchRetryInterval:5}),this.socket.subscribeServer("SearchComServer"),this.listener=this.objectsSelected.bind(this),this.socket.addListener("Selected_Objects_search",this.listener);var n=this.options();this.socket.dispatchEvent("RegisterContext",n)};return o.prototype.destroy=function(){var e={};e.widget_id=widget&&widget.id?widget.id:this.socketName,this.socket.dispatchEvent("unregisterSearchContext",e),this.socket.unsubscribeServer("SearchComServer"),this.socket.removeListener("Selected_Objects_search",this.listener),this.socket.disconnect()},o.prototype.options=function(e,t,n,o,s,l,c,u,d){var p={};if(p.title=e,p.multiSel=this.multiSelectVal,p.mode="furtive",p.app_socket_id=this.socketName,p.widget_id=widget&&widget.id?widget.id:this.socketName,p.default_with_precond=!0,p.show_precond=!1,p.idcard_activated=!1,p.role=n,p.tenant=a.getGlobalVariable().tenant,t&&"Person"!=t&&(p.precond="(",t=t.split(","),i.each(t,function(t,n){"referentials"==e?(p.precond+=0!==t?" AND ":"flattenedtaxonomies:(",p.precond+='NOT "types/'+n.trim()+'"'):(0!==t&&(p.precond+=" OR "),p.precond+='flattenedtaxonomies:"types/'+n.trim()+'"')}),"referentials"==e&&(p.precond+=")"),p.precond+=")",""!=s&&(p.precond+=s),"Depend"!==e&&"Dependency"!==e||(p.precond+=' AND (NOT flattenedtaxonomies:"interfaces/Change On Hold") AND (NOT current:"On Hold" AND NOT current:"Cancelled")'),null!=d&&"addExistingOrchestration"==d.condition&&(p.precond+=d.extendedQuery),null!=d&&"addExistingCROrchestration"==d.condition&&(p.precond+=d.extendedQuery),null!=d&&"addExistingIssue"==d.condition&&(p.precond+=d.extendedQuery),null!=d&&"addExistingRelatedScope"==d.condition&&(p.precond+=d.extendedQuery),null!=d&&"addExistingAffectedItem"==d.condition&&(p.precond+=d.extendedQuery),null!=d&&"addExistingImpactBasis"==d.condition&&(p.precond="",p.precond+=d.extendedQuery),null!=d&&"addExistingImpactedItems"==d.condition&&(p.precond+=d.extendedQuery),null!=d&&"addExistingContexts"==d.condition&&(p.precond+=d.extendedQuery),null!=d&&"addExistingImpactAnalysis"==d.condition&&(p.precond="",p.precond+=d.extendedQuery),null!=d&&"addExistingChangeAction"==d.condition&&(p.precond="",p.precond+=d.extendedQuery)),"Person"===t){var g="";if(g="reviewer"!==l||"reviewer"===l&&"Person"===r.reviewerType.typeOfReviewer?'(flattenedtaxonomies:"types/Person" AND policycurrent:"Person.Active")':"reviewer"===l&&"Route Template"===r.reviewerType.typeOfReviewer?'(flattenedtaxonomies:"types/Route Template" AND route_95_base_95_purpose:"Approval" AND (route_95_template_95_availability: "Enterprise" OR route_95_template_95_availability: "'+c+'" ) AND policycurrent:"Route Template.Active" AND latestrevision:"TRUE")':'(flattenedtaxonomies:"types/Route Template" AND route_95_base_95_purpose:"Approval" AND (route_95_template_95_availability: "Enterprise" OR route_95_template_95_availability: "'+c+'" ) AND policycurrent:"Route Template.Active" AND latestrevision:"TRUE") OR (flattenedtaxonomies:"types/Person" AND policycurrent:"Person.Active")',"informedUser"===l){g+="OnPremise"==a.getGlobalVariable().tenant?' OR (flattenedtaxonomies:"types/Group" AND current:"active")':" OR ([ds6w:type]:(Group))"}if(p.precond=g,null!=d&&"addExistingIAAssignee"==d.condition&&(p.precond+=d.extendedQuery),null!=d&&"addExistingAssignee"==d.condition){g+="OnPremise"==a.getGlobalVariable().tenant?' OR (flattenedtaxonomies:"types/Group" AND current:"active")':" OR ([ds6w:type]:(Group))",p.precond=g,p.precond+=d.extendedQuery}null!=d&&"addExistingFollower"==d.condition&&(p.precond+=d.extendedQuery)}return o&&(p.default_search_criteria=o),p},o.prototype.activate=function(e,t,n,i,a,r,o,s,l,c){var u=this.options(e,t,n,a,r,o,s,l,c);this.callback&&(this.callback=void 0),this.callback=i;var d={};d.widget_id=widget?widget.id:null,this.socket.dispatchEvent("unregisterSearchContext",d),this.socket.dispatchEvent("RegisterContext",u),this.socket.dispatchEvent("InContextSearch",u);var p=this;this.socket.addListener("onCloseTransient",function(e){p.socket.dispatchEvent("UnregisterContext",{widget_id:d.widget_id})})},o.prototype.isAvailable=function(){return e.is(this.socket)},o.prototype.objectsSelected=function(e){var t=[];if(this.callback){for(var i=0;i<e.length;i++){var a=[],r=new n(e[i]);a.push(r.get("id")),a.push(r.get("ds6w:identifier")),a.push(r.get("ds6w:type")),a.push(r.get("ds6w:policy")),a.push(r.get("type_icon_url")),a.push(r.get("ds6w:label")),a.push(r.get("ds6wg:revision")),a.push(r.get("sourceid_value")),t.push(a)}this.callback(t)}},o}),define("DS/ENOChgServices/scripts/services/ChgIDCardCommonServices",["DS/UIKIT/Mask","DS/ENOChgServices/scripts/services/ChgSearchConfigServcies","DS/UIKIT/Alert","DS/WAFData/WAFData","UWA/Core","UWA/Class/Promise","DS/UIKIT/Native/Dropdown","DS/UIKIT/DropdownMenu","UWA/String","DS/i3DXCompassServices/i3DXCompassPubSub","require","UWA/Utils/InterCom","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/DocumentManagement/DocumentManagement","i18n!DS/ENOChgServices/assets/nls/ChgServiceNLS","DS/i3DXCompassPlatformServices/OpenWith","DS/WebappsUtils/WebappsUtils"],function(e,t,n,i,a,r,o,s,l,c,u,d,p,g,f,m,h,v,C){"use strict";var S={CurrModel:null,ChgIDCardCommonServices_CAModel:null,collectionToFilter:null,caEditComp:null,summaryCloned:null,dependencyElem:{},taggerObject:{},maturityCmd:null,initHandleBarsCalled:!1,selectedItemsArr:[],areCallbacksForOpenWithSet:!1,search:function(e,t,n,i,a,r,o,s){var l="";if("referentials"==i||"context"==i||"Contributors"==i||"Reviewers"==i||"Followers"==i||"proposed"==i||"Dependency"==i){for(var c=i+"ExcludeList",u=null!=r?r:null!=this.CurrModel&&null!=this.CurrModel?this.CurrModel.get(c):null,d=0;null!=u&&null!=u&&d<u.length;d++)if(u[d]){var g=u[d].toString();l=l+"NOT ("+(g=null!=r?"physicalid:"+g:g.replace("pid","physicalid"))+")"}}else if("ChangeOrder"==i||"TransferOwnership"==i){var f="ChangeOrder"==i?this.CurrModel.get("changeOrderId"):this.CurrModel.get("ownerId");UWA.is(f)&&""!=f&&(l="NOT ("+f.replace("pid","physicalid")+")")}var m=p.getGlobalVariable().getRole(),h=p.getGlobalVariable().contextUser,v=null!=this.CurrModel&&null!=this.CurrModel?this.CurrModel.get("id").slice(4):null;a.activate(e,t,m,n,null,l,o,h,v,s)},activateSearch:function(e,n){return new t(null==e||null==e||"Change Order"!=e&&"Issue"!==n&&"IA_Assignees"!=e&&("Person"!==e||"TransferOwnership"!==n)&&"proposed"!=n&&"Dependency"!==n&&"Change Request"!==n&&"Change Action"!==n&&"IA_ImpactAnalysis"!==n&&"resolutionItems"!==n)},createCA:function(e,t,n){u("DS/ENOChgServices/scripts/services/ChgInfraService").makeWSCall("/resources/modeler/change/changeaction","POST","enovia","application/json",e,t,n)},editCA:function(e,t,n,i){var a="/resources/modeler/change/changeaction/"+t;u("DS/ENOChgServices/scripts/services/ChgInfraService").makeWSCall(a,"PUT","enovia","application/json",e,n,i)},getUserFullName:function(e){return new r(function(t,n){var i="";if(Array.isArray(e))for(var a=0;a<e.length;a++)""!=i?-1===i.indexOf(e[a])&&(i=i+"%7C"+e[a]):i=e[a];else i=e;g.makeWSCall("/resources/modeler/change/userdisplayname","GET","enovia","application/json","userNames="+i,function(e){var n={};n.userDisplayName=e,t(n)},null,!1)})},getUserAccess:function(e){return new r(function(t,n){var i="/resources/modeler/change/access/"+e;u("DS/ENOChgServices/scripts/services/ChgInfraService").makeWSCall(i,"GET","enovia","application/json","",function(e){var n={};n.userAccess=e,t(n)},n,!1)})},getCADetails:function(e){return new r(function(t,n){var i="/resources/modeler/change/changeaction/"+e+"?people=1&referentials=1&dependency=1&attributes=1&context=1&changeOrder=1&applicability=1";u("DS/ENOChgServices/scripts/services/ChgInfraService").makeWSCall(i,"GET","enovia","application/json","",function(e){t(e)},n,!1)})},onItemViewDragForContents:function(e,t){var n,i,a,r,o,s,l,c,u=t.caId.substr(4);n=e[1];var d=[],p=Object.keys(n);for(var g in p){var m=n[p[g]];if(m){r=m.get("objectName"),o=m.get("fullName"),!UWA.is(r)&&UWA.is(o)&&""!=o&&(r=o),(a=(s=t.typeOfDrag&&"Proposed"===t.typeOfDrag?m.get("objectId"):m.get("id")).lastIndexOf(":"))>0&&(a+=1,s=s.substring(a)),(l=m.get("objectType"))||(l=m.get("type")),c=m.get("revision");var h={envId:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",serviceId:"3DSpace",objectId:s,objectType:l,displayName:r,Revision:c,ChangeActionID:u,displayType:l,caContextIds:""};t.caContextIds&&0!=t.caContextIds.length&&(h.caContextIds=t.caContextIds),d.push(h)}}i=e[2];var v={protocol:"3DXContent",version:"1.1",source:"X3DCSMA_AP",widgetId:widget.id,data:{items:d}};f.DispatchEventToWin("DragStart",JSON.stringify(v)),i.dataTransfer.setData("Text",JSON.stringify(v))},updateExcludeList:function(e,t){var n=[];if("referentials"==t)e.get(t).forEach(function(e,t){n.push(e.get("id"))});else if("context"==t){e.get(t).forEach(function(e,t){n.push(e.get("id"))})}else"Depend"==t&&n.push(e.get("id"));e.set(t+"ExcludeList",n)},SetSpinnerWait:function(e,t){widget.body.style.pointerEvents="true"==e?"none":"auto"},removeDuplicatesToBeDroppedObjects:function(e){for(var t=0;t<e.data.items.length;t++)for(var n=t+1;n<e.data.items.length;n++)e.data.items[t].objectId==e.data.items[n].objectId&&(e.data.items.splice(n,1),n-=1);return e},getLatestRevisionFlag:function(e){return new r(function(t,n){var i={lastVersionRequests:[]};if(e&&e.length>0){e.forEach(function(e){i.lastVersionRequests.push({id:e})});var a=UWA.Json.encode(i);u("DS/ENOChgServices/scripts/services/ChgInfraService").makeWSCall("/resources/v1/dslc/getlastversions?validIntents=E","POST","enovia","application/json",a,function(e){var n={},i={};if(e.lastVersionRequests&&Array.isArray(e.lastVersionRequests))for(var a=0;a<e.lastVersionRequests.length;a++){var r=e.lastVersionRequests[a];r&&(i[r.id]=r.islast.toString())}n.versionInfo=i,t(n)},n,!1)}else t(!0)})},getFlowdownEnrichedInfo:function(e){var t=this;return new r(function(n,i){var a=[],r={};UWA.is(e)&&e.forEach(function(e){var t=e.id;if(r[t]={},"Cannot be found"!=e.get("flowDownFromTitle")&&""!=e.get("flowDownFromTitle")&&UWA.is(e.get("flowDownFromId"))&&""!=e.get("flowDownFromId")&&(r[t].flowdownFrom=e.get("flowDownFromId").replace("pid:",""),a.push(e.get("flowDownFromId").replace("pid:",""))),"Cannot be found"!=e.get("flowdownForObjectTitle")&&""!=e.get("flowdownForObjectTitle")&&UWA.is(e.get("flowdownForObjectId"))&&""!=e.get("flowdownForObjectId")&&(r[t].flowdownFor=e.get("flowdownForObjectId").replace("pid:",""),a.push(e.get("flowdownForObjectId").replace("pid:",""))),UWA.is(e.get("flowdownInfo"))){var n=e.get("flowdownInfo"),i=n.flowdownFor,o=[];for(var s in i){var l=i[s];l&&"Cannot be found"!=l.info["display name"]&&o.push(l.id.replace("pid:",""))}var c=[],u=n.flowdownFrom;for(var s in u){var d=u[s];d&&"Cannot be found"!=d.caTitle&&c.push(d.caID.replace("pid:",""))}o.length>0&&(a=a.concat(o)),c.length>0&&(a=a.concat(c))}}),a.length>0?t.getAdditionObjectInfo(a).then(function(t){var i=Object.keys(r);for(var a in i){var o=i[a];if(UWA.is(o)){var s=e.findWhere({id:o});if(s){var l=r[o];if(UWA.is(l)){var c=l.flowdownFrom;if(UWA.is(c)){var u=t.additionObjectInfo?t.additionObjectInfo[c]:null;UWA.is(u)&&(s.set("flowdownFromImage",u.image),s.set("flowdownFromIcon",u.icon))}var d=s.get("flowdownInfo");if(UWA.is(d)){var p=d.flowdownFrom;if(UWA.is(p)){var g=p.map(function(e){return e.caID});for(var f in g){(S=t.additionObjectInfo?t.additionObjectInfo[g[f].replace("pid:","")]:void 0)&&(p[f].icon=S.icon,p[f].image=S.image)}}}var m=l.flowdownFor;if(UWA.is(m)){var h=t.additionObjectInfo?t.additionObjectInfo[m]:null;UWA.is(h)&&(s.set("flowdownForImage",h.image),s.set("flowdownForIcon",h.icon))}var v=s.get("flowdownInfo");if(UWA.is(v)){var C=d.flowdownFor;if(UWA.is(C)){g=C.map(function(e){return e.id});for(var f in g){var S;(S=t.additionObjectInfo?t.additionObjectInfo[g[f].replace("pid:","")]:void 0)&&(C[f].info.icon=S.icon,C[f].info.image=S.image)}}}}}}}n(!0)}):n(!0)})},getAdditionObjectInfo:function(e){return new r(function(t,n){if(e&&e.length>0){var i="$ids="+(e=e.toString());u("DS/ENOChgServices/scripts/services/ChgInfraService").makeWSCall("/resources/v2/e6w/service/ObjectInfo?$fields=ownerFullname,collabSpace,collabSpaceTitle,policy,icon,image,synopsis,functionalname,organization,organizationTitle","POST","enovia","application/x-www-form-urlencoded",i,function(e){var n,i=new Object;UWA.is(e)&&UWA.is(e.data)&&e.data.forEach(function(e){var t="";e.dataelements.firstname&&e.dataelements.lastname&&(t=e.dataelements.firstname+" "+e.dataelements.lastname),(n=new Object).pid=e.id,n.type=e.type,n.typeNLS=e.dataelements.typeNLS,n.objectName=e.dataelements.name,n.revision=e.dataelements.revision,n.objectTitle=e.dataelements.title,n.icon=e.dataelements.icon,n.image=e.dataelements.image,n.fileExtension=e.dataelements.fileExtension,n.policy=e.dataelements.policy,n.collabSpace=e.dataelements.collabSpace,n.collabSpaceTitle=e.dataelements.collabSpaceTitle,n.organizationTitle=e.dataelements.organizationTitle,n.ownerFullname=e.dataelements.ownerFullname,n.fullName=t,n.synopsis=e.dataelements.synopsis,n.revision=e.dataelements.revision,n.stateNLS=e.dataelements.stateNLS,i[e.id]=n});var a={};a.additionObjectInfo=i,t(a)},n,!1)}else t(!0)})},getObjectAdditionalInfo:function(e){var t=[];return new r(function(n,i){if(e&&e.data&&e.data.items){var a=e.data.items;if(UWA.is(a)&&UWA.is(a.length)&&a.length>0){for(var r=[],o=[],s=[],l=0;l<a.length;l++)if(a[l].objectId){var c=a[l].serviceId.toLowerCase();"3dspace"==c||c.includes("3dspace")?r.push(a[l].objectId):"3dswym"==c&&"pno:Person"==a[l].objectType&&(o.push(a[l].objectId.replace("iam:","")),s.push(a[l].displayName))}0!=r.length||0!=o.length?S.getAdditionObjectInfo(r).then(function(e){for(var i=0;i<r.length;i++){var a=e.additionObjectInfo[r[i]];t.push(a)}for(i=0;i<o.length;i++){(a={}).label=s[i],a.objectName=o[i],a.name=s[i],a.identifier=o[i],a.type="Person",a.pid=o[i],t.push(a)}n(t)},function(e){return console.log("Failed in getting person id"),i(e)}):ChgErrors.error("Failed in getting person id")}else console.log("Failed in getting search service response")}})},enrichCollection:function(t,n,i){var a=this;return this.UpdateUnAccessibleObject(t),new r(function(o,s){var l=[],c=[],u={};if(UWA.is(n)?t.forEach(function(e){UWA.is(e.get(n))&&""!=e.get(n)&&e.get(n)!=e.get("id")&&1==e.get("Access")&&(c.push(e.id),u[e.id]=e.get(n).replace("pid:",""),l.push(e.get(n).replace("pid:","")))}):t.forEach(function(e){1==e.get("Access")&&(c.push(e.id),u[e.id]=e.id.replace("pid:",""),l.push(e.id.replace("pid:","")))}),l.length>0){var d=[],p=a.getAdditionObjectInfo(l);if(d.push(p),i){var g;g=a.getLatestRevisionFlag(l),d.push(g);var f;f=a.getFlowdownEnrichedInfo(t),d.push(f)}r.all(d).then(function(i){i.forEach(function(e){UWA.is(e)&&UWA.is(e.additionObjectInfo)&&c.forEach(function(n){a=u[n],UWA.is(e.additionObjectInfo[a])&&((i=t.get(n)).set("objectName",e.additionObjectInfo[a].objectName),""==e.additionObjectInfo[a].objectTitle?i.set("objectTitle",e.additionObjectInfo[a].objectName):i.set("objectTitle",e.additionObjectInfo[a].objectTitle),i.get("revision")&&i.set("IdentifierWithRevision",i.get("objectTitle")+i.get("revision")),i.set("icon",e.additionObjectInfo[a].icon),i.set("image",e.additionObjectInfo[a].image),i.set("fileExtension",e.additionObjectInfo[a].fileExtension),i.set("policy",e.additionObjectInfo[a].policy),i.set("collabSpace",e.additionObjectInfo[a].collabSpace),i.set("collabSpaceTitle",e.additionObjectInfo[a].collabSpaceTitle),i.set("organizationTitle",e.additionObjectInfo[a].organizationTitle),i.set("ownerFullname",e.additionObjectInfo[a].ownerFullname))});if(UWA.is(e)&&UWA.is(e.versionInfo)){var i=null,a="",r=e.versionInfo;l.forEach(function(e){if(r[e]){a=UWA.is(n)?u[e]:"pid:"+e,i=t.get(a);var o=r[e];i&&i.set("isLastVersion",o)}})}}),e.unmask(widget.body),o(t)},function(t){return console.log("failed from getting additional info"),e.unmask(widget.body),r.reject(t)})}else e.unmask(widget.body),o(t)})},UpdateUnAccessibleObject:function(e,t){if(!UWA.is(t))t="objectTitle";e.forEach(function(e){if(0==e.get("Access"))for(var n=e.pairs(),i=0;i<n.length;i++)"string"!=typeof n[i][1]||"Cannot be found"!=n[i][1]&&"Access denied"!=n[i][1]||n[i][0]!=t&&e.set(n[i][0],"",{silent:!0})})},activateDeactiveTaggerProxies:function(e,t){var n=this.getTaggerObject(e);n&&n.activateTaggerProxy();var i=this.getTaggerObject(t);i&&i.deactivateTaggerProxy()},killTaggerProxies:function(e){var t=[];t=-1===e?[0,1,2,3,4,5]:[e];for(var n=0;n<t.length;n++){var i=t[n],a=this.getTaggerObject(i);if(a){a.taggerProxy.die();var r=a.viewName;delete this.taggerObject[r]}}},setTaggerObject:function(e,t){this.taggerObject[e]=t,t.activateTaggerProxy()},getTaggerObject:function(e){var t="",n=null;switch(e){case 0:t="Properties";break;case 1:t="Team";break;case 2:t="Proposed";break;case 3:t="Realized";break;case 4:t="Referential";break;case 5:t="Approval";break;case 6:t="Context";break;default:console.log("incorrect view selected")}return""!=t&&this.taggerObject&&(n=this.taggerObject[t]),n},filterInCurrentDashboard:function(e){var t=p.getGlobalVariable().mySkeleton,n=[];if(t){var i=t.getCollectionAt(0);null===this.summaryCloned&&(this.summaryCloned=new UWA.Class.Collection(i.toArray())),""===e&&(i.reset(),i.add(this.summaryCloned.toArray()));for(var a=i.toArray(),r=new UWA.Class.Collection(a),o=0;o<r.length;o++){var s=r.at(o);if(s){s.get("synopsis").indexOf(e)>=0&&n.push(s)}}var l=r.without(n);i.remove(l)}},_initDropDown:function(e,t){this.dropDown&&(this.dropDown.destroy(),this.dropDown=null),0===e.length&&e.push({text:h.ECM_CA_Command_NO_Action});var n={items:e,target:t,className:"CA_ConnectedObj_DropDown"};p.getGlobalVariable().isNative?this.dropDown=new o(n):this.dropDown=new s(n),this.dropDown&&this.dropDown.show()},checkTenantInforamation:function(e){var t=[];if(e){for(var n=e.data.items,i=[],a=[],r=0;r<n.length;r++)""===n[r].envId||void 0===n[r].envId||null===n[r].envId?i.push(n[r].displayName):n[r].envId!=p.getGlobalVariable().tenant&&a.push(n[r].displayName);t.TenantInfoMissing=i,t.DiffTenantData=a}return t},filterBasedOnServiceId:function(e){var t={};if(e){for(var n=e.data.items,i=[],a=[],r=0;r<n.length;r++)n[r].serviceId&&n[r].objectType&&"3DSpace"!=n[r].serviceId&&"pno:Person"!=n[r].objectType?i.push(n[r].displayName):a.push(n[r]);e.data.items=a,t.dataJSON=e,t.incorrectServiceInfo=i}return t},sanitizeText:function(e){return e=e.trim(),UWA.is(e,"string")&&e.length>0?isNaN(parseFloat(e))?e=l.stripScripts(e):e:UWA.is(e,"number")?e:""},openRelationalExplorer:function(e){this.launchAppBasedOnAppId(e,"ENORIPE_AP")},openCompareApp:function(e){this.launchAppBasedOnAppId(e,"ENOCOMP_AP")},launchAppBasedOnAppId:function(e,t){var n=p.getGlobalVariable().getSecurityContext(),i=[];e.forEach(function(e){var t={envId:p.getGlobalVariable().tenant,serviceId:"3DSpace",contextId:n,objectId:e.replace("pid:","")};i.push(t)});var a=widget.getValue("appId");a||(a="ENOWCHA_AP");var r={protocol:"3DXContent",version:"1.1",source:a,widgetId:widget.id,data:{items:i}},o=UWA.is(widget)&&widget.id?"caCompassSocket_"+widget.id:"caCcompassSocket";this._compass_socket||(this._compass_socket=new d.Socket(o),this._compass_socket.subscribeServer("com.ds.compass",p.getGlobalVariable().compassWindow)),this._compass_socket.dispatchEvent("onSetX3DContent",r,o);var s={appId:t};this._compass_socket.dispatchEvent("onLaunchApp",s,o)},launchAppInAppMode:function(e,t,n){let i=p.getGlobalVariable().getSecurityContext(),a=[],r=[];t.forEach(function(e){let t=e.replace("pid:",""),n={envId:p.getGlobalVariable().tenant,serviceId:"3DSpace",contextId:i,objectId:t};r.push(t),a.push(n)});let o=widget.getValue("appId");o||(o="ENOWCHA_AP");let s={protocol:"3DXContent",version:"1.1",source:o,widgetId:widget.id,data:{items:a},inAppMode:!0,inAppOptions:{relationSet:"AutoModeProfile",localUID:e,selectedObjectIds:r}},l=UWA.is(widget)&&widget.id?"caCompassSocket_"+widget.id:"caCcompassSocket";this._compass_socket||(this._compass_socket=new d.Socket(l),this._compass_socket.subscribeServer("com.ds.compass",p.getGlobalVariable().compassWindow)),this._compass_socket.dispatchEvent("onSetX3DContent",s,l);let c={appId:n};this._compass_socket.dispatchEvent("onLaunchApp",c,l)},getContentForCompassInteraction:function(e){var t=p.getGlobalVariable().getSecurityContext(),n=[];return e.forEach(function(e){var i={envId:widget.getValue("x3dPlatformId"),serviceId:"3DSpace",contextId:t,objectId:e.objectId,objectType:e.objectType,displayName:e.displayName,displayType:e.displayType,facetName:e.facetName?e.facetName:"",path:[{resourceid:e.objectId,type:e.objectType}]};n.push(i)}),{protocol:"3DXContent",version:"1.1",source:widget.getValue("appId"),widgetId:widget.id,data:{items:n}}},setSelectedItem:function(e){var t=!1;if(this.selectedItemsArr.forEach(function(n){n.phid!==e.selectedItem.objectId||(t=!0)}),!t){var n={phid:e.selectedItem.objectId,facetName:e.facetName};this.selectedItemsArr.push(n)}},getSelectedItem:function(e){var t={};return this.selectedItemsArr.forEach(function(n){n.facetName!==e||(t=n)}),t},getFacetName:function(e){var t="";if(!e)return t;var n=e.items;if(Array.isArray(n)&&n.length>0)for(var i=0;i<n.length;i++){var a=n[i];a&&(t=a.facetName?a.facetName:"")}return t},setCallbacksForOpenWith:function(e){var t=this;this.areCallbacksForOpenWithSet||c.subscribe("setTypesCallback",function(e){if(e.widgetId===window.widget.id){var n=t.getFacetName(e.data),i=t.buildDataForsetTypes(n),a=JSON.stringify(i),r={appId:e.appId,widgetId:e.widgetId,fileName:"-file",fileContent:a};c.publish("launchApp",r)}t.areCallbacksForOpenWithSet=!0}),c.publish("setTypes",{widgetId:window.widget.id})},buildDataForsetTypes:function(e){var t=this.CurrModel,n={},i=this.getSelectedItem(e),a=[],r=(new Date).valueOf();a.push({id:""+r,phid:i.phid});var o=[{structure:[{id:""+r,show:!0,select:!0,children:[]}]}];if(UWA.is(t)&&t.get("userAccess")){var s=t.get("userAccess").WorkUnder,l={};if("true"===s)l={version:"1.0",AuthoringContextHeader:null,change:{id:t.get("id").replace("pid:",""),name:t.name,title:t.title,description:t.description,severity:t.severity,maturity:t.maturity}};n={version:"2.4",completionOnCAD:"yes",results:a,structures:o,viewpoint:[]},"true"===s&&(n.workUnder=l)}return n},getBlobObject:function(e,t){(0,i.authenticatedRequest)(e,{method:"GET",responseType:"blob",onload:t,onFailure:function(){},onComplete:function(){}})},downloadDocuments:function(e,t){var n=this,i={tenant:p.getGlobalVariable().tenant,securityContext:p.getGlobalVariable().getSecurityContext(),tenantUrl:p.getGlobalVariable().baseURL,autoDownload:!0,onFailure:function(e){t(e)},onComplete:function(t){UWA.is(t,"array")&&t.forEach(function(t){t.downloadUrl&&n.getBlobObject(t.downloadUrl,function(){var n=this.response,i=e.length>1||void 0===t.fileName?"multiple_files.zip":t.fileName;if(window.navigator.msSaveOrOpenBlob){var a=this.getResponseHeader("content-type");window.navigator.msSaveOrOpenBlob(new Blob([n],{type:a}),i)}else{UWA.createElement("a",{href:window.URL.createObjectURL(n),download:i,type:"application/octet-stream"}).dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))}console.log("download docuemnt sucess...!")})})}};e.length>1&&(i.asZip=!0),m.downloadDocuments(e,i)},getCollectionToFilter:function(){return this.collectionToFilter},getSummaryCloned:function(){return this.summaryCloned},setCurrModel:function(e){this.CurrModel=e},getCurrentModel:function(){return this.CurrModel},getUserFullNameMap:function(){return this.userFullNameMap},setUserFullNameMap:function(e){this.userFullNameMap=e},updateUserFullNameMap:function(e){this.setUserFullNameMap(e);var t=this.getUserFullNameMap();Object.keys(e).forEach(function(n){t[n]=e[n]})},getUserFullNameFromIDs:function(e){var t=this,n={};return new r(function(i,a){var r=S.getUserFullNameMap(),o=[];e.forEach(function(e){r&&r[e]?n[e]=r[e]:o.push(e)}),o.length>0?t.getUserFullName(o).then(function(e){var a=e.userDisplayName.userInfo;t.updateUserFullNameMap(a),o.forEach(function(e){a&&a[e]?n[e]=a[e]:o.push(e)}),i(n)}):i(n)})},openWith:function(e){var t=this;return new r(function(n,i){var a=null,r=[];r.push(e);var o=t.getContentForCompassInteraction(r),s=new v;s.set3DXContent(o);var l=[];UWA.is(s.retrieveCompatibleApps,"function")&&s.retrieveCompatibleApps(function(e){e.forEach(function(e){l.push({type:"PushItem",title:e.text,icon:e.icon,action:{callback:function(t){e.handler()}}})});var t=p.getGlobalVariable();l.length>0&&t.isNative?"true"==t.CHG_OPENWITH&&(a={type:"PushItem",title:h.CHG_OpenWith_Menu,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open-menu-dot"},submenu:l}):l.length>0&&(a={type:"PushItem",title:h.CHG_OpenWith_Menu,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open-menu-dot"},submenu:l}),n(a)})})},getExploreMenu:function(e,t){return{type:"PushItem",title:h.ECM_CA_Command_Explore,icon:C.getWebappsAssetUrl("ENOChangeActionUX","images/I_SendToVPMNavigator.png"),action:{callback:function(){var e=t.cellInfos.nodeModel.options.grid.id;f.DispatchEventToWin("Explore",e)}}}},getExploreWithMenu:function(e,t){var n=[];return n.push({type:"PushItem",title:h.ECM_CA_Command_ExploreSys,icon:C.getWebappsAssetUrl("ENOChangeActionUX","images/I_ExploreInRFLPNavigator.png"),action:{callback:function(){var e=t.cellInfos.nodeModel.options.grid.id;f.DispatchEventToWin("ExploreInRFLP",e)}}}),n.push({type:"PushItem",title:h.ECM_CA_Command_ExploreMfg,icon:C.getWebappsAssetUrl("ENOChangeActionUX","images/I_SendToPPRNavigatorWithParent.png"),action:{callback:function(){var e=t.cellInfos.nodeModel.options.grid.id;f.DispatchEventToWin("ExploreInPPR",e)}}}),n.push({type:"PushItem",title:h.ECM_CA_Command_ExploreParents,icon:C.getWebappsAssetUrl("ENOChangeActionUX","images/I_GetParents.png"),action:{callback:function(){var e=t.cellInfos.nodeModel.options.grid.id;f.DispatchEventToWin("ExploreParents",e)}}}),n.push({type:"PushItem",title:h.ECM_CA_Command_ExploreMSB,icon:C.getWebappsAssetUrl("ENOChangeActionUX","images/I_SendToPPRNavigatorWithParent.png"),action:{callback:function(){var e=t.cellInfos.nodeModel.options.grid.id;f.DispatchEventToWin("ExploreInMSB",e)}}}),n.push({type:"PushItem",title:h.ECM_CA_Command_ExploreContext,icon:C.getWebappsAssetUrl("ENOChangeActionUX","images/I_FindInContext.png"),action:{callback:function(){var e=t.cellInfos.nodeModel.options.grid.id;f.DispatchEventToWin("ExploreinContext",e)}}}),{type:"PushItem",title:h.ECM_CA_Command_ExploreWith,submenu:n}},getOpenMenu:function(e,t){return{type:"PushItem",title:h.ECM_CA_Command_Open,icon:C.getWebappsAssetUrl("ENOChangeActionUX","images/I_OpenDB.png"),action:{callback:function(){var e=t.cellInfos.nodeModel.options.grid.id;f.DispatchEventToWin("Open",e)}}}},getOpenWithNativeMenu:function(e,t){var n=[];return n.push({type:"PushItem",title:h.ECM_CA_Command_Explore3DSpace,icon:C.getWebappsAssetUrl("ENOChangeActionUX","images/I_ExploreInCentral_normal.png"),action:{callback:function(){var e=t.cellInfos.nodeModel.options.grid.id;f.DispatchEventToWin("ExploreInCollabNApproval",e)}}}),n.push({type:"PushItem",title:h.ECM_CA_Command_OpenAdv,icon:C.getWebappsAssetUrl("ENOChangeActionUX","images/I_OpenAdvDB.png"),action:{callback:function(){var e=t.cellInfos.nodeModel.options.grid.id;f.DispatchEventToWin("OpenAdv",e)}}}),n.push({type:"PushItem",title:h.ECM_CA_Command_OpenRO,icon:C.getWebappsAssetUrl("ENOChangeActionUX","images/I_OpenInReadOnly.png"),action:{callback:function(){var e=t.cellInfos.nodeModel.options.grid.id;f.DispatchEventToWin("OpenReadOnly",e)}}}),{type:"PushItem",title:h.ECM_CA_Command_OpenWith_RichClient,submenu:n}},setLabelManagerView:function(e){S.labelManagerView=e},getLabelManagerView:function(){return S.labelManagerView},getAdditionSwymPersonInfo:function(e){return new r(function(t,n){if(e&&e.length>0){var i="/resources/v2/e6w/service/PersonSearchByName?searchStr="+(e=e.toString());u("DS/ENOChgServices/scripts/services/ChgInfraService").makeWSCall(i,"GET","enovia","application/json","",function(e){var n,i=new Object;UWA.is(e)&&UWA.is(e.data)&&e.data.forEach(function(e){var t="";e.dataelements.firstname&&e.dataelements.lastname&&(t=e.dataelements.firstname+" "+e.dataelements.lastname),(n=new Object).pid=e.id,n.type=e.type,n.objectName=e.dataelements.name,n.fullName=t,i[e.dataelements.name]=n});var a={};a.additionObjectInfo=i,t(a)},n,!1)}else t(!0)})}};return S}),define("DS/ENOChgServices/scripts/services/ChgDependencyServices",["UWA/Core","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices"],function(e,t,n){"use strict";return{changeActionDependenciesLoaded:!1,changeActionDependencyModel:null,getDependUserAccess:function(e){return new Promise(function(n,i){var a="/resources/changedependencies/services/graph/access/"+e;t.makeWSCall(a,"GET","enovia","application/json","",function(e){var t={};t.dependUserAccess=e,n(t)},i,!1)})},getCADependencies:function(e){return new Promise(function(n,i){var a="/resources/changedependencies/services/graph/"+e+"?depth=1";t.makeWSCall(a,"GET","enovia","application/json","",function(e){n(e)},i,!1)})},addDependencyLink:function(e){var n=this;return new Promise(function(i,a){t.makeWSCall("/resources/changedependencies/services/create","PUT","enovia","application/json",e,function(e){n.getDependencyOwnerFullName(e.elements).then(function(t){i(e)})},function(e){a(e)})})},removeDependencyLink:function(e,n){return new Promise(function(e,i){var a="/resources/changedependencies/services/remove/"+n.options.linkid;t.makeWSCall(a,"PUT","enovia","application/json","",function(t){e(t)},function(e){i(e)})})},syncDependency:function(e){return new Promise(function(n,i){var a=e.getSelectedNodes(),r=[];a&&Array.isArray(a)&&a.forEach(function(e){var t="";e&&(t=e.options.resourceid),""!=t&&r.push(t)});var o={changeToSynchronize:r};t.makeWSCall("/resources/modeler/change/utils/synchronizeChanges","POST","enovia","application/json",JSON.stringify(o),function(e){n(e)},function(e,t){t.errorMessage&&i(t.errorMessage)})})},getDependencyOwnerFullName:function(e){return new Promise(function(t,i){var a=[];e.forEach(function(e){var t=e.owner;a.push(t)}),n.getUserFullNameFromIDs(a).then(function(n){e.forEach(function(e){var t=e.owner;e.ownerFullName=n[t]?n[t].userDisplayName:""}),t(e)})})}}}),define("DS/ENOChgServices/scripts/services/ChgDataService",["DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChangeActionUX/scripts/CASpinner"],function(e,t,n){"use strict";var i={getCASummary:function(t,n){if(null!=n)var i=n.filterView;return new Promise(function(n,a){if("inactiveCA"==i)var r="/resources/modeler/change/changeactions?contributor=1&reviewer=1&follower=1&states=Complete%7CCancelled&startDate="+t;else r="/resources/modeler/change/changeactions?contributor=1&reviewer=1&follower=1&states=Prepare%7CInWork%7CInApproval%7CApproved%7CComplete%7CCancelled&startDate="+t;e.makeWSCall(r,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},getUserFullNameWithProcessData:function(n,i){return new Promise(function(a,r){var o="";if(Array.isArray(n)&&n.length>0)for(var s=0;s<n.length;s++)""!=o?-1===o.indexOf(n[s])&&(o=o+"%7C"+n[s]):o=n[s];else o=n;t.getGlobalVariable().getSecurityContext();e.makeWSCall("/resources/modeler/change/userdisplayname","GET","enovia","application/json","userNames="+o,function(e){var t={};t.userDisplayName=e,t.processList=i,a(t)},null,!1)})},getTypeIcon:function(t,n){return new Promise(function(i,a){var r={physicalid:n,label:"test",select_predicate:["ds6w:type"]},o=JSON.stringify(r);if(n.length>0)e.makeWSCall("/cvservlet/fetch/v2","POST","enovia","application/json",o,function(e){var n={};n.processedCAListWithFullName=t,n.iconDetails=e,i(n)},function(e){a(e)},!0);else{var s={};s.processedCAListWithFullName=t,s.iconDetails=[],i(s)}})},getCAFDData:function(n,i,a){var r=t.getGlobalVariable().getSecurityContext();if(r=encodeURIComponent(r),null!=a)var o=a.filterView;let s=t.getGlobalVariable().customeViewList,l=["ECM_CHG_ON_HOLD","ECM_CHANGE_REJECTION","ECM_CA_ASSIGNEE","ECM_CA_DIRECT_REVIEWER","ECM_CA_FOLLOWERS","ECM_CA_ATTACHMENT_ID","ECM_ROUTE_TEMPLATE_APPROVERS","ECM_ROUTE_TEMPLATE_LABEL","ECM_CA_ASSIGNEE_FULL_NAME","ECM_CA_DIRECT_REVIEWER_FULL_NAME","ECM_CA_FOLLOWERS_FULL_NAME","owner","current","ds6w:dueDate","ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:responsible","ds6w:lastModifiedBy","ds6wg:marketing_Name"];return s.length>0&&null!=s&&(l=[...l,...s]),new Promise(function(a,s){var c=t.getGlobalVariable().contextUser,u={};u=i?"inactiveCA"==o?{with_indexing_date:!0,label:"gn1_Test",locale:"en",select_predicate:l,select_file:["icon","thumbnail_2d"],query:'(flattenedtaxonomies:"types/Change Action" AND  [ds6w:status]:"Cancelled.Cancelled" AND NOT [ds6w:status]:"Change Action.Complete" AND ( owner:'+c+" OR [ECM_CA_ASSIGNEE]:"+c+"  OR [ECM_CA_DIRECT_REVIEWER]:"+c+" OR [ECM_CA_FOLLOWERS]:"+c+" OR [ECM_ROUTE_TEMPLATE_APPROVERS]:"+c+" OR [ECM_ROUTE_APPROVERS_THROUGH_GROUP]:"+c+" OR [ECM_ROUTE_TEMPLATE_APPROVERS_THROUGH_GROUP]:"+c+" OR [ECM_ROUTE_APPROVERS]:"+c+"))",login:{"3dspace":{SecurityContext:r}},nresults:100,next_start:i,source:[],tenant:t.getGlobalVariable().tenant}:{with_indexing_date:!0,label:"gn1_Test",locale:"en",select_predicate:l,select_file:["icon","thumbnail_2d"],query:'(flattenedtaxonomies:"types/Change Action" AND NOT [ds6w:status]:"Cancelled.Cancelled" AND NOT [ds6w:status]:"Change Action.Complete" AND ( owner:'+c+" OR [ECM_CA_ASSIGNEE]:"+c+"  OR [ECM_CA_DIRECT_REVIEWER]:"+c+" OR [ECM_CA_FOLLOWERS]:"+c+" OR [ECM_ROUTE_TEMPLATE_APPROVERS]:"+c+" OR [ECM_ROUTE_APPROVERS_THROUGH_GROUP]:"+c+" OR [ECM_ROUTE_TEMPLATE_APPROVERS_THROUGH_GROUP]:"+c+" OR [ECM_ROUTE_APPROVERS]:"+c+"))",login:{"3dspace":{SecurityContext:r}},nresults:100,next_start:i,source:[],tenant:t.getGlobalVariable().tenant}:"inactiveCA"==o?{with_indexing_date:!0,label:"gn1_Test",locale:"en",select_predicate:l,select_file:["icon","thumbnail_2d"],query:'(flattenedtaxonomies:"types/Change Action" AND ( [ds6w:status]:"Cancelled.Cancelled" OR [ds6w:status]:"Change Action.Complete") AND ( owner:'+c+" OR [ECM_CA_ASSIGNEE]:"+c+"  OR [ECM_CA_DIRECT_REVIEWER]:"+c+" OR [ECM_CA_FOLLOWERS]:"+c+" OR [ECM_ROUTE_TEMPLATE_APPROVERS]:"+c+" OR [ECM_ROUTE_APPROVERS_THROUGH_GROUP]:"+c+" OR [ECM_ROUTE_TEMPLATE_APPROVERS_THROUGH_GROUP]:"+c+" OR [ECM_ROUTE_APPROVERS]:"+c+"))",login:{"3dspace":{SecurityContext:r}},nresults:100,start:0,source:[],tenant:t.getGlobalVariable().tenant}:{with_indexing_date:!0,label:"gn1_Test",locale:"en",select_predicate:l,select_file:["icon","thumbnail_2d"],query:'(flattenedtaxonomies:"types/Change Action" AND NOT [ds6w:status]:"Cancelled.Cancelled" AND NOT [ds6w:status]:"Change Action.Complete" AND ( owner:'+c+" OR [ECM_CA_ASSIGNEE]:"+c+"  OR [ECM_CA_DIRECT_REVIEWER]:"+c+" OR [ECM_CA_FOLLOWERS]:"+c+" OR [ECM_ROUTE_TEMPLATE_APPROVERS]:"+c+" OR [ECM_ROUTE_APPROVERS_THROUGH_GROUP]:"+c+" OR [ECM_ROUTE_TEMPLATE_APPROVERS_THROUGH_GROUP]:"+c+" OR [ECM_ROUTE_APPROVERS]:"+c+"))",login:{"3dspace":{SecurityContext:r}},nresults:100,start:0,source:[],tenant:t.getGlobalVariable().tenant},n&&(u.refine={},u.refine=n.allfilters);u=JSON.stringify(u);e.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",u,function(e){a(e)},function(){},{isfederated:!0})})},getTimestamp:function(){return new Promise(function(n,i){var a=t.getGlobalVariable().getSecurityContext(),r="/cvservlet/indexingdate?SecurityContext="+encodeURIComponent(a),o={select_service:["FTS"]};o=JSON.stringify(o);e.makeWSCall(r,"POST","enovia","application/json",o,function(e){n(e)},i,null)})},getCAMembers:function(t){return new Promise(function(n,i){var a="/resources/modeler/change/changeaction/pid:"+t.options.grid.id+"?people=1&referentials=1&tenant=OnPremise";i=function(e){i(e)};e.makeWSCall(a,"GET","enovia","application/json","",function(e){var i={};i.nodeModel=t,i.members=e.changeaction.people,i.routeTemplate=e.changeaction.routeTemplates,i.referentials=e.changeaction.referentials,n(i)},i,null)})},getDocumentImage:function(t){return new Promise(function(n,i){var a={physicalid:t,label:"test",select_predicate:["resourceid","ds6w:identifier","ds6w:type","preview_url","type_icon_url","ds6w:docextension"]},r=JSON.stringify(a);e.makeWSCall("/cvservlet/fetch/v2","POST","enovia","application/json",r,function(e){var t={};t.referentialInfo=e,n(t)},function(e){i(e)},{encodeSecurityContext:"No"})})},getObjectInfo:function(t,n){return new Promise(function(i,a){if(t&&t.length>0){t=t.toString(),n=n&&n.length>0?n.toString():"name";var r="$ids="+t;r+="&$fields="+n;e.makeWSCall("/resources/v2/e6w/service/ObjectInfo","POST","enovia","application/x-www-form-urlencoded",r,function(e){i(e.data)},a,!1)}else i(!0)})},getCAOwnerForTransfer:function(t){return new Promise(function(n,i){var a="/resources/modeler/change/changeaction/pid:"+t+"?people=1&tenant=OnPremise";i=function(e){i(e)};e.makeWSCall(a,"GET","enovia","application/json","",function(e){var i={};i.members=e.changeaction.people,i.caid=t,n(i)},i,null)})},deleteObjectStructure:function(t){return new Promise(function(n,i){var a={data:t,options:[]},r=JSON.stringify(a);e.makeWSCall("/resources/lifecycle/Delete/structure","POST","enovia","application/json",r,function(e){n(e)},i,!1)})},handleContextMenuClickHold:function(t){return new Promise(function(n,i){var a=t.userComment,r="/resources/v1/chguxservices/changeorder/"+t.chgPhysicalId+"/hold",o={data:[{dataelements:{reason:a}}],definitions:[]},s=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",s,function(e){var t={};t.userDisplayName=e,n(t)},null)})},handleContextMenuClickResume:function(t){return new Promise(function(n,i){var a=t.userComment,r="/resources/v1/chguxservices/changeorder/"+t.chgPhysicalId+"/resume",o={data:[{dataelements:{reason:a}}],definitions:[]},s=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",s,function(e){var t={};t.userDisplayName=e,n(t)},null)})},handleContextMenuClickCancel:function(t){return new Promise(function(n,i){var a=t.userComment,r="/resources/v1/chguxservices/changeorder/"+t.chgPhysicalId+"/cancel",o={data:[{dataelements:{reason:a}}],definitions:[]},s=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",s,function(e){var t={};t.userDisplayName=e,n(t)},null)})},handleContextMenuClickHoldForCR:function(t){return new Promise(function(n,i){var a=t.userComment,r="/resources/v1/chguxservices/changerequest/"+t.chgPhysicalId+"/hold",o={data:[{reason:a}]},s=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",s,function(e){n(e)},null)})},handleContextMenuClickResumeForCR:function(t){return new Promise(function(n,i){var a=t.userComment,r="/resources/v1/chguxservices/changerequest/"+t.chgPhysicalId+"/resume",o={data:[{reason:a}]},s=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",s,function(e){n(e)},null)})},handleContextMenuClickCancelForCR:function(t){return new Promise(function(n,i){var a=t.userComment,r="/resources/v1/chguxservices/changerequest/"+t.chgPhysicalId+"/cancel",o={data:[{reason:a}],definitions:[]},s=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",s,function(e){n(e)},null)})},getChangeOrders:function(){return new Promise(function(t,n){e.makeWSCallWithCSRF("/resources/v1/chguxservices/changeorder","GET","enovia","application/json","",function(e){t(e)},n,!1)})},getConfiguredChangeActionList:function(t){return new Promise(function(n,i){var a="",r="",o="",s="",l="";a=1==t.simplifiedJSON?"$simpleJSON=true":"$simpleJSON=false",t.pageNumber&&(r="&page="+t.pageNumber),t.pageSize&&(o="&pageSize="+t.pageSize),s=1==t.indexed?"&indexed=true":"&indexed=false",t.timestamp&&(l="&lastIndexedTime="+t.timestamp);var c="/resources/v1/chguxservices/changeaction?"+a+r+o+s+l+(null!=t.filter&&"inactiveCA"==t.filter?"&active=false":"&active=true");let u={},d="";t.refine&&(u.refine={},u.refine={data:[t.refine.allfilters]},d="refine="+JSON.stringify(u.refine));e.makeWSCallWithCSRF(c,"POST","enovia","application/x-www-form-urlencoded",d,function(e){n(e)},i,!1)})},getConfiguredChangeOrderList:function(t){return new Promise(function(n,i){var a="",r="",o="",s="",l="";a=1==t.simplifiedJSON?"$simpleJSON=true":"$simpleJSON=false",t.pageNumber&&(r="&page="+t.pageNumber),t.pageSize&&(o="&pageSize="+t.pageSize),s=1==t.indexed?"&indexed=true":"&indexed=false",t.timestamp&&(l="&lastIndexedTime="+t.timestamp);var c="/resources/v1/chguxservices/changeorder?"+a+r+o+s+l+(null!=t.filter&&"inactiveCO"==t.filter?"&active=false":"&active=true");let u={},d="";t.refine&&(u.refine={},u.refine={data:[t.refine.allfilters]},d="refine="+JSON.stringify(u.refine));e.makeWSCallWithCSRF(c,"POST","enovia","application/x-www-form-urlencoded",d,function(e){n(e)},i,!1)})},getConfiguredChangeRequestList:function(t){return new Promise(function(n,i){var a="",r="",o="",s="",l="";a=1==t.simplifiedJSON?"$simpleJSON=true":"$simpleJSON=false",t.pageNumber&&(r="&page="+t.pageNumber),t.pageSize&&(o="&pageSize="+t.pageSize),s=1==t.indexed?"&indexed=true":"&indexed=false",t.timestamp&&(l="&lastIndexedTime="+t.timestamp);var c="/resources/v1/chguxservices/changerequest?"+a+r+o+s+l+(null!=t.filter&&"inactiveCR"==t.filter?"&active=false":"&active=true");let u={},d="";t.refine&&(u.refine={},u.refine={data:[t.refine.allfilters]},d="refine="+JSON.stringify(u.refine));e.makeWSCallWithCSRF(c,"POST","enovia","application/x-www-form-urlencoded",d,function(e){n(e)},i,!1)})},getChangeOrderInfo:function(t,n){return new Promise(function(i,a){var r="/resources/v1/chguxservices/changeorder/"+t;1==n&&(r+="?$simpleJSON=true");e.makeWSCallWithCSRF(r,"GET","enovia","application/json","",function(e){i(e)},a,!1)})},getChangeRequestInfo:function(t){return new Promise(function(n,i){var a="/resources/v1/chguxservices/changerequest/"+t;e.makeWSCallWithCSRF(a,"GET","enovia","application/json","",function(e){n(e)},i,!1)})},getChangeOrchestration:function(t,n){return new Promise(function(i,a){var r="/resources/v1/chguxservices/changeorder/"+t+"/changeorchestration";n&&(r+="?$simpleJSON=true");e.makeWSCallWithCSRF(r,"GET","enovia","application/json","",function(e){i(e)},a,!1)})},getCRChangeOrchestration:function(t){return new Promise(function(n,i){var a="/resources/v1/chguxservices/changerequest/"+t+"/changeOrchestration";e.makeWSCallWithCSRF(a,"GET","enovia","application/json","",function(e){n(e)},i,!1)})},addExistingInCRChangeOrchestration:function(t,n,i){return new Promise(function(a,r){let o;o="Change Request"==n?"/resources/v1/chguxservices/changerequest/"+t+"/changeOrchestration/connect":"/resources/v1/chguxservices/changeorder/"+t+"/changeorchestration/connect?$simpleJSON=true";let s={data:i,definitions:[]};s=JSON.stringify(s);e.makeWSCallWithCSRF(o,"PUT","enovia","application/json",s,function(e){a(e)},r,!1)})},addExistingChangeOrchestration:function(t,n){return new Promise(function(i,a){var r="/resources/v1/chguxservices/changeorder/"+t+"/changeorchestration/connect",o={data:n,definitions:[]};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){i(e)},a,!1)})},removeInCRChangeOrchestration:function(t,n,i){return new Promise(function(a,r){let o;o="Change Request"==n?"/resources/v1/chguxservices/changerequest/"+t+"/changeOrchestration/disconnect":"/resources/v1/chguxservices/changeorder/"+t+"/changeorchestration/disconnect?$simpleJSON=true";let s={data:i,definitions:[]};s=JSON.stringify(s);e.makeWSCallWithCSRF(o,"PUT","enovia","application/json",s,function(e){a(e)},r,!1)})},removeChangeOrchestration:function(t,n){return new Promise(function(i,a){var r="/resources/v1/chguxservices/changeorder/"+t+"/changeorchestration/disconnect",o={data:n,definitions:[]};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){i(e)},a,!1)})},getChangeOrderMembers:function(t){return new Promise(function(n,i){var a="/resources/v1/chguxservices/changeorder/"+t+"/members";e.makeWSCallWithCSRF(a,"GET","enovia","application/json","",function(e){n(e)},i,!1)})},updateChangeOrderMembers:function(t,n){return new Promise(function(i,a){var r="/resources/v1/chguxservices/changeorder/"+t+"/members",o=JSON.stringify(n);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){i(e)},a,!1)})},getApplicabilityData:function(t){return new Promise(function(n,i){let a=`/resources/ecm/modeler/changeorder/pid:${t}/getapplicability`;e.makeWSCall(a,"GET","enovia","application/json","",n,i,null)})},getAttachementData:function(t,n){return null==n&&(n="Reference Document"),new Promise(function(i,a){var r="/resources/v1/modeler/documents/parentId/"+t+"?parentRelName="+n;e.makeWSCall(r,"GET","enovia","application/json","",function(e){i(e)},function(e){a(e)},null)})},getCOChangeRequestData:function(t){return new Promise(function(n,i){var a="/resources/v1/chguxservices/changeorder/"+t+"/changerequest";e.makeWSCallWithCSRF(a,"GET","enovia","application/json","",function(e){n(e)},function(e){i(e)},null)})},getObjectInfo:function(t,n){return new Promise(function(i,a){if(t&&t.length>0){t=t.toString(),n=n&&n.length>0?n.toString():"name";var r="$ids="+t;r+="&$fields="+n;e.makeWSCall("/resources/v2/e6w/service/ObjectInfo","POST","enovia","application/x-www-form-urlencoded",r,function(e){i(e.data)},a,!1)}else i(!0)})},getIssueDetails:function(t){return new Promise(function(n,i){var a={issueVersion:"DS-API-Version",version:"2.0"},r="/resources/issues/"+t;e.makeWSCallWithCSRF(r,"GET","enovia","application/json","",function(e){n(e)},i,a)})},getFinalApprovedRT:function(e){return new Promise(function(t,n){i.getAllApprovedRouteFromCA(e).then(function(e){for(var n=e.allApproveRoute,a=[],r=0;r<n.length;r++){var o=n[r],s=i.getRouteDetails(o);a.push(s)}Promise.all(a).then(function(e){var n={};n.ApprovedRTs=e,t(n)})},function(e){return Promise.reject(e)})})},getAllApprovedRouteFromCA:function(t){return new Promise(function(n,i){var a="/resources/modeler/change/changeaction/"+t+"?allApprovalRoutes=1";e.makeWSCall(a,"GET","enovia","application/json","",function(e){var t={};t.allApproveRoute=e.changeaction.allApprovalRoutes,n(t)},null,!1)})},getRouteDetails:function(t){return new Promise(function(n,i){var a="/resources/v1/modeler/routes/"+(t=t.replace("pid:",""));e.makeWSCall(a,"GET","enovia","application/json","",function(e){var t={};t.routeInfo=e,n(t)},null,!1)})},createGroupForChangeAction:function(t){return new Promise(function(n,i){var a={title:t.title,changeactions:t.changeactions},r=JSON.stringify(a);e.makeWSCall("/resources/modeler/change/group","POST","enovia","application/json",r,function(e){n(e)},null,!1)})},removeGroupFromCA:function(t){return new Promise(function(n,i){var a=t.oldGroupId,r={addChangeActions:[],removeChangeActions:t.changeactions},o="/resources/modeler/change/group/"+a,s=JSON.stringify(r);e.makeWSCall(o,"PUT","enovia","application/json",s,function(e){n(e)},null,!1)})},updateGroupToAddCA:function(t){return new Promise(function(n,i){var a=t.availbleGroupId,r={addChangeActions:t.changeactions,removeChangeActions:[]},o="/resources/modeler/change/group/"+a,s=JSON.stringify(r);e.makeWSCall(o,"PUT","enovia","application/json",s,function(e){n(e)},null,!1)})},getListOfGroups:function(){return new Promise(function(t,n){e.makeWSCall("/resources/modeler/change/group/elligibleGroups","GET","enovia","application/json","",function(e){t(e)},null,!1)})},getRouteBasedOnContentId:function(t){return new Promise(function(n,i){var a="/resources/v1/modeler/routes?whereUsed="+t;e.makeWSCall(a,"GET","enovia","application/json","",function(e){n(e)},function(e){i(e)},null)})},getChangeOrderUserAccess:function(t){return new Promise(function(n,i){var a="/resources/v1/chguxservices/changeorder/"+t+"/access";e.makeWSCall(a,"GET","enovia","application/json","",function(e){n(e)},i,!1)})},getChangeRequestUserAccess:function(t){return new Promise(function(n,i){let a="/resources/v1/chguxservices/changerequest/"+t+"/access?$simpleJSON=false";e.makeWSCall(a,"GET","enovia","application/json","",function(e){n(e)},i,!1)})},getImpactAnalysisUserAccess:function(t){return new Promise(function(n,i){let a=`/resources/v1/chguxservices/impactAnalysis/${t}/access?$simpleJSON=false`;e.makeWSCall(a,"GET","enovia","application/json","",n,i,!1)})},getChangeRequests:function(){return new Promise(function(t,n){e.makeWSCallWithCSRF("/resources/v1/chguxservices/changerequest","GET","enovia","application/json","",function(e){let n={};t(n=e)},n,!1)})},getObjectTypeInformation:function(t){return"string"==typeof t?new Promise(function(n,i){let a=`/resources/v2/e6w/service/ApplicabilityTypeInfo/${t}`;e.makeWSCallWithCSRF(a,"GET","enovia","application/json","",function(e){let t;e.data[0].dataelements&&null!=e.data[0].dataelements.applicabilityType&&(t=e.data[0].dataelements.applicabilityType),n(t)},i,!1)}):"object"==typeof t?new Promise(function(n,i){let a=`/resources/v2/e6w/service/ApplicabilityTypeInfo/${t}`;e.makeWSCallWithCSRF(a,"GET","enovia","application/json","",function(e){n(e)},i,!1)}):void 0},getChangeRequestMembers:function(t){return new Promise(function(n,i){var a="/resources/v1/chguxservices/changerequest/"+t+"/members";e.makeWSCallWithCSRF(a,"GET","enovia","application/json","",function(e){n(e)},i,!1)})},updateChangeRequestMembers:function(t,n){return new Promise(function(i,a){var r="/resources/v1/chguxservices/changerequest/"+t+"/members",o=JSON.stringify(n);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){i(e)},a,!1)})},getCRAffectedItems:function(t,n){return new Promise(function(i,a){var r="/resources/v1/chguxservices/changerequest/"+t+"/affectedItems";r+=!0===n?"?impactAnalysis=1":"?impactAnalysis=0";e.makeWSCall(r,"GET","enovia","application/json","",function(e){i(e)},a,!1)})},addExistingInCRAffectedItems:function(t,n){return new Promise(function(i,a){let r="/resources/v1/chguxservices/changerequest/"+t+"/affectedItems",o={data:n};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){i(e)},a,!1)})},removeCRAffectedItems:function(t,n){return new Promise(function(i,a){let r="/resources/v1/chguxservices/changerequest/"+t+"/affectedItems",o={data:n};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){i(e)},a,!1)})},getCRImpactAnalysis:function(t,n){return new Promise((i,a)=>{let r="",o=`/resources/v1/chguxservices/changerequest/${t}/impactAnalysisSummary`;o+=r=n&&null!=n.filterView&&"inactiveIA"==n.filterView?"?active=false":"?active=true";e.makeWSCallWithCSRF(o,"GET","enovia","application/json","",i,a,!1)})},getCRIssue:function(t){return new Promise(function(n,i){var a="/resources/v1/chguxservices/changerequest/"+t+"/issues";e.makeWSCallWithCSRF(a,"GET","enovia","application/json","",function(e){n(e)},i,!1)})},getCOIssue:function(t){return new Promise(function(n,i){var a="/resources/v1/chguxservices/changeorder/"+t+"/issues";e.makeWSCallWithCSRF(a,"GET","enovia","application/json","",function(e){n(e)},i,!1)})},getIssue:function(t){return new Promise(function(n,i){var a="/resources/v1/chguxservices/";"ChangeOrder"==t.type?a+="changeorder/":"ChangeRequest"==t.type?a+="changerequest/":a+="changeaction/",a=a+t.id+"/issues";e.makeWSCallWithCSRF(a,"GET","enovia","application/json","",function(e){n(e)},i,!1)})},getConnectedCA:function(t){return new Promise(function(n,i){var a="/resources/v1/chguxservices/impactAnalysis/"+t+"/implementingChangeActions";e.makeWSCallWithCSRF(a,"GET","enovia","application/json","",function(e){n(e)},i,!1)})},getCRRelatedScope:function(t){return new Promise(function(n,i){var a="/resources/v1/chguxservices/changerequest/"+t+"/reportedAgainst";e.makeWSCallWithCSRF(a,"GET","enovia","application/json","",function(e){n(e)},i,!1)})},getCORelatedScope:function(t){return new Promise(function(n,i){var a="/resources/v1/chguxservices/changeorder/"+t+"/reportedAgainst";e.makeWSCallWithCSRF(a,"GET","enovia","application/json","",function(e){n(e)},i,!1)})},getChangeGroupData:function(t){return new Promise(function(n,i){var a="/resources/modeler/change/changeaction/pid:"+t+"?attributes=1";e.makeWSCallWithCSRF(a,"GET","enovia","application/json","",function(e){n(e)},i,!1)})},getChangeActionForGroup:function(t){return new Promise(function(n,i){var a="/resources/modeler/change/group/"+t+"?";e.makeWSCall(a,"GET","enovia","application/json","",function(e){n(e)},i,!1)})},updateExistingImpactBasis:function(t,n,i){return new Promise(function(t,a){const r=`/resources/v1/chguxservices/impactAnalysis/${n}/impactBasis`;let o={data:i};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,t,a,!1)})},updateExistingIssue:function(t,n){return new Promise(function(i,a){let r,o="/resources/issues/"+t+"/related";r=JSON.stringify(n);e.makeWSCallWithCSRF(o,"PUT","enovia","application/json",r,function(e){i(e)},a,!1)})},removeExistingIssue:function(t,n){return new Promise(function(i,a){let r,o="/resources/issues/"+t+"/related";r=JSON.stringify(n);e.makeWSCallWithCSRF(o,"DELETE","enovia","application/json",r,function(e){i(e)},a,!1)})},updateExistingImpactItem:function(t,n,i){return new Promise(function(t,a){const r=`/resources/v1/chguxservices/impactAnalysis/${n}/impactedItems`;let o={data:i};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,t,a,!1)})},updateExistingRelatedScope:function(t,n){return new Promise(function(i,a){let r="/resources/v1/chguxservices/changerequest/"+t+"/reportedAgainst",o={data:n};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){i(e)},a,!1)})},updateExistingCORelatedScope:function(t,n){return new Promise(function(i,a){let r="/resources/v1/chguxservices/changeorder/"+t+"/reportedAgainst",o={data:n};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){i(e)},a,!1)})},removeExistingRelatedScope:function(t,n){return new Promise(function(i,a){let r="/resources/v1/chguxservices/changerequest/"+t+"/reportedAgainst",o={data:n};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){i(e)},a,!1)})},duplicateImpactAnalysis:(t,n)=>new Promise((i,a)=>{let r=`/resources/v1/chguxservices/changerequest/${t}/duplicateChangeAnalysis`,o={data:n};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,i,a,!1)}),removeExistingCORelatedScope:function(t,n){return new Promise(function(i,a){let r="/resources/v1/chguxservices/changeorder/"+t+"/reportedAgainst",o={data:n};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){i(e)},a,!1)})},updateExistingContributors:function(t,n,i){return new Promise(function(t,a){const r=`/resources/v1/chguxservices/impactAnalysis/${n}/contributors`;let o={data:i};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,t,a,!1)})},getCAInfoImpactedItems:t=>new Promise((n,i)=>{let a={data:t};a=JSON.stringify(a),e.makeWSCallWithCSRF("/resources/v1/chguxservices/connectedChange?$include=proposedChangeActions","POST","enovia","application/json",a,n,i,!1)}),getImpactAnalysisFromId:function(t,n){return new Promise(function(i,a){let r=`/resources/v1/chguxservices/impactAnalysis/${t}/`;n&&(r+=`?$include=${n}`);e.makeWSCallWithCSRF(r,"GET","enovia","application/json","",i,a,!1)})},getImpactAnalysisFacet:function(t,n){return new Promise(function(i,a){let r=`/resources/v1/chguxservices/impactAnalysis/${t}/?$include=${n}`;e.makeWSCallWithCSRF(r,"GET","enovia","application/json","",i,a,!1)})},getNewCADetails:function(t){return new Promise(function(n,i){var a="/resources/modeler/change/changeaction/pid:"+t+"?people=1&attributes=1";e.makeWSCall(a,"GET","enovia","application/json","",function(e){n(e)},i,!1)})},getChangeActionInfo:function(t){return new Promise(function(n,i){let a="/resources/v1/chguxservices/changeaction/"+t;e.makeWSCallWithCSRF(a,"GET","enovia","application/json","",n,i,!1)})},getChangeActionUserAccess:function(t){return new Promise(function(n,i){let a="/resources/v1/chguxservices/changeaction/"+t+"/access";e.makeWSCall(a,"GET","enovia","application/json","",function(e){n(e)},i,!1)})},handleContextMenuClickHoldForCA:function(t){return new Promise(function(n,i){var a=t.userComment,r="/resources/v1/chguxservices/changeaction/"+t.chgPhysicalId+"/hold",o={data:[{reason:a}]},s=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",s,function(e){n(e)},null)})},handleContextMenuClickResumeForCA:function(t){return new Promise(function(n,i){var a=t.userComment,r="/resources/v1/chguxservices/changeaction/"+t.chgPhysicalId+"/resume",o={data:[{reason:a}]},s=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",s,function(e){n(e)},null)})},handleContextMenuClickCancelForCA:function(t){return new Promise(function(n,i){var a=t.userComment,r="/resources/v1/chguxservices/changeaction/"+t.chgPhysicalId+"/cancel",o={data:[{reason:a}],definitions:[]},s=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",s,function(e){n(e)},null)})},handleContextMenuClickBOMSyncForCA:function(t){return new Promise(function(i,a){var r="/resources/modeler/change/changeaction/"+("pid:"+t.chgPhysicalId)+"/synchronize";n.doWait(widget.body),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json","",function(e){n.endWait(widget.body),i(e)},null)})},getCAContext:function(t){return new Promise(function(n,i){var a="/resources/v1/chguxservices/changeaction/"+t+"/contexts";e.makeWSCallWithCSRF(a,"GET","enovia","application/json","",function(e){n(e)},i,!1)})},updateExistingCAContext:function(t,n){return new Promise(function(i,a){let r="/resources/v1/chguxservices/changeaction/"+t+"/contexts",o={data:n};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){i(e)},a,!1)})},getApplicabilityDataForCA:function(t){return new Promise(function(n,i){let a=`/resources/modeler/change/changeaction/pid:${t}?applicability=1`;e.makeWSCall(a,"GET","enovia","application/json","",n,i,null)})},getChangeActionMembers:function(t){return new Promise(function(n,i){var a="/resources/v1/chguxservices/changeaction/"+t+"/members";e.makeWSCallWithCSRF(a,"GET","enovia","application/json","",function(e){n(e)},i,!1)})},updateChangeActionMembers:function(t,n){return new Promise(function(i,a){var r="/resources/v1/chguxservices/changeaction/"+t+"/members",o=JSON.stringify(n);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){i(e)},a,!1)})},connecteCAwithImpactedItem:(t,n)=>new Promise((i,a)=>{let r="/resources/v1/chguxservices/impactAnalysis/"+n+"/connectImpactedItemsAsProposed",o={data:t};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,i,a,!1)}),moveAffactedItemToOtherCR:(t,n)=>new Promise((i,a)=>{let r="/resources/v1/chguxservices/changerequest/"+n+"/moveAffectedItems",o={data:t};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,i,a,!1)}),orchestrateImpactAnalysis:(t,n)=>new Promise((i,a)=>{let r="/resources/v1/chguxservices/connectedChange/"+n+"/orchestrateItemsForChange",o={data:t};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,i,a,!1)}),orchestrateChangeOrder:(t,n)=>new Promise((i,a)=>{let r="/resources/v1/chguxservices/connectedChange/"+n+"/orchestrateItemsForChange",o={data:t};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,i,a,!1)}),orchestrateChangeAction:(t,n)=>new Promise((i,a)=>{let r="/resources/v1/chguxservices/connectedChange/"+n+"/orchestrateItemsForChange",o={data:t};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,i,a,!1)}),connecteIAwithAffactedItem:t=>new Promise((n,i)=>{let a={data:t};a=JSON.stringify(a),e.makeWSCallWithCSRF("/resources/v1/chguxservices/connectedChange/connectAffectedItemsAsAnalysisBasis","POST","enovia","application/json",a,n,i,!1)}),mergeChangeAction:t=>new Promise((n,i)=>{let a={data:t};a=JSON.stringify(a),e.makeWSCallWithCSRF("/resources/v1/chguxservices/connectedChange/mergeChangeAction","POST","enovia","application/json",a,n,i,!1)}),updateAIReasonForChangeValue:(t,n)=>new Promise((i,a)=>{let r="/resources/v1/chguxservices/changerequest/"+n+"/setWhyForAffectedItems",o={data:t};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,i,a,!1)}),updateImpactItemReasonForChangeValue:(t,n)=>new Promise((i,a)=>{let r="/resources/v1/chguxservices/impactAnalysis/"+n+"/setWhyForImpactedItems",o={data:t};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,i,a,!1)}),updateStatusOfImpactedItem:(t,n)=>new Promise((i,a)=>{let r="/resources/v1/chguxservices/impactAnalysis/"+n+"/setStatusForImpactedItems",o={data:t};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,i,a,!1)}),updateImpactBasisReasonForChangeValue:(t,n)=>new Promise((i,a)=>{let r="/resources/v1/chguxservices/impactAnalysis/"+n+"/setWhyForImpactBasis",o={data:t};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,i,a,!1)}),cancelRelatedImpactAnalysis:function(t,n){return new Promise(function(i,a){var r=`/resources/v1/chguxservices/changerequest/${t}/cancelChangeAnalysis`,o=JSON.stringify(n);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,i,a,!1)})},handleContextMenuClickWorkUnder:function(t){return new Promise(function(n,i){let a="/resources/modeler/change/changeaction/"+("pid:"+t.chgPhysicalId)+"?editability=1&attributes=1";e.makeWSCall(a,"GET","enovia","application/json","",n,i,!1)})}};return i}),define("DS/ENOChgServices/scripts/services/ChgRealizedServices",["UWA/Core","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgDataProcess","DS/ENOChgServices/scripts/services/ChgDataService","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/UIKIT/Mask","DS/PlatformAPI/PlatformAPI","i18n!DS/ENOChgServices/assets/nls/ChgServiceNLS"],function(e,t,n,i,a,r,o,s,l){"use strict";return{getCARealizedFilterMapping:function(){return{ALL:1,DEFAULT:2,TRANSFERRED:8,IGNORED:4}},createCAAndTransferRealized:function(e,i,a,l){var c=r.getCurrentModel();i.originChangeActionId=c.id,i.receivingChangeAction=e,i=JSON.stringify(i);n.makeWSCall("/resources/modeler/change/transfer","PUT","enovia","application/json",i,function(e){if(e&&"success"===e.status&&c){var n={};o.mask(widget.body),e={CADetails:e.receivingChangeAction,isSelect:"false"},s.publish("ca-create-grid-injection",e),n.onComplete=function(n){t.getGlobalVariable().arrOid=[],o.unmask(widget.body),a(e)},c.fetch(n)}},function(){o.unmask(widget.body)})},flowDownToNewChangeAction:function(e,i,a,l){var c=r.getCurrentModel();i.originChangeActionId=c&&c.id?c.id:"",i.receivingChangeAction=e;var u=[];i.receivingChangeAction&&i.receivingChangeAction.synopsis&&u.push({name:"attribute_Synopsis",value:i.receivingChangeAction.synopsis}),i.receivingChangeAction&&i.receivingChangeAction.severity&&u.push({name:"attribute_Severity",value:i.receivingChangeAction.severity}),i.receivingChangeAction&&i.receivingChangeAction.scheduledCompletionDate&&u.push({name:"attribute_EstimatedCompletionDate",value:i.receivingChangeAction.scheduledCompletionDate}),i.receivingChangeAction&&(u.push({name:"current",value:"Prepare"}),u.push({name:"currentNLS",value:"Draft"}),u.push({name:"currentNLS",value:"Draft"}),u.push({name:"attribute_Originator",value:t.getGlobalVariable().contextUser})),i=JSON.stringify(i),o.mask(widget.body);n.makeWSCall("/resources/modeler/change/flowdown","PUT","enovia","application/json",i,function(e){if(e&&e.changeaction){var n="";if(e.changeaction&&e.changeaction.name&&(e.changeaction.attributes=u,e.changeaction.name&&(n=e.changeaction.name)),c){var i={CADetails:e,isSelect:"false"};s.publish("ca-create-grid-injection",i);var r={onComplete:function(i){t.getGlobalVariable().arrOid=[],o.unmask(widget.body),e.caName=n,a(e)}};c.fetch(r)}}},function(){o.unmask(widget.body)})},transferRealized:function(e,i,a,s){var l=r.getCurrentModel();i.originChangeActionId=l.id,i.receivingChangeActionId=e.changeaction.id,i=JSON.stringify(i);n.makeWSCall("/resources/modeler/change/transfer","PUT","enovia","application/json",i,function(e){if(l){var n={};o.mask(widget.body),n.onComplete=function(n){t.getGlobalVariable().arrOid=[],o.unmask(widget.body),a(e)},l.fetch(n)}},function(){o.unmask(widget.body)})},flowDownToExistingChangeAction:function(e,i,a,s){var l=r.getCurrentModel();i.originChangeActionId=l&&l.id?l.id:"",i.receivingChangeActionId=e.id,i.originChangeActionId=e.originChangeActionId,i=JSON.stringify(i),o.mask(widget.body);n.makeWSCall("/resources/modeler/change/flowdown","PUT","enovia","application/json",i,function(n){if(l){var i={onComplete:function(i){t.getGlobalVariable().arrOid=[],o.unmask(widget.body),n.caName=e.name,a(n)}};l.fetch(i)}},function(){o.unmask(widget.body)})},getCARealizedData:function(e,t){return new Promise(function(i,a){var r="/resources/modeler/change/changeaction/"+e+"?realized="+t+"&attributes=1&context=1";n.makeWSCall(r,"GET","enovia","application/json","",function(e){i(e)},a,!1)})},getGroupCARealizedData:function(e){return new Promise(function(t,i){var a="/resources/modeler/change/group/"+e+"?realized=1";n.makeWSCall(a,"GET","enovia","application/json","",function(e){t(e)},i,!1)})},enrichCollectionForRealized:function(e){return r.UpdateUnAccessibleObject(e),new Promise(function(t,n){var i=[],a={};e.forEach(function(e){if(1==e.get("Access")){var t=e.id.replace("pid:","");-1===i.indexOf(t)&&i.push(e.id.replace("pid:","")),a[e.id.replace("pid:","")]=e}e.get("activities").forEach(function(e,t){if(UWA.is(e.get("Afterobject"))&&UWA.is(e.get("Afterobject").id)&&1==e.get("Afterobject").Access){var n=e.get("Afterobject").id.replace("pid:","");-1===i.indexOf(n)&&(i.push(e.get("Afterobject").id.replace("pid:","")),a[e.id.replace("pid:","")]=e)}if(UWA.is(e.get("Beforeobject"))&&UWA.is(e.get("Beforeobject").id)&&1==e.get("Beforeobject").Access){n=e.get("Beforeobject").id.replace("pid:","");-1===i.indexOf(n)&&(i.push(e.get("Beforeobject").id.replace("pid:","")),a[e.id.replace("pid:","")]=e)}})}),i.length>0?r.getAdditionObjectInfo(i).then(function(n){if(UWA.is(n)&&UWA.is(n.additionObjectInfo)){var i=n.additionObjectInfo,a=Object.keys(i);e.forEach(function(e){if(1==e.get("Access")){var t=e.id.replace("pid:",""),n=a.indexOf(t);if(n>-1){var r=i[a[n]];e.set("objectName",r.objectName),e.set("objectTitle",r.objectTitle),e.get("revision")&&e.set("IdentifierWithRevision",e.get("objectTitle")+e.get("revision")),e.set("icon",r.icon),e.set("policy",r.policy),e.set("collabSpace",r.collabSpace),e.set("ownerFullname",r.ownerFullname)}}e.get("activities").forEach(function(e,t){if(UWA.is(e.get("Afterobject"))&&e.get("Afterobject").id&&1==e.get("Afterobject").Access){var n=e.get("Afterobject").id.replace("pid:","");if((t=a.indexOf(n))>-1){var r=i[a[t]];e.get("Afterobject").name=r.objectName,e.get("Afterobject").title=r.objectTitle,e.get("Afterobject").icon=r.icon,e.get("Afterobject").collabSpace=r.collabSpace,e.get("Afterobject").ownerFullname=r.ownerFullname}}if(UWA.is(e.get("Beforeobject"))&&e.get("Beforeobject").id&&1==e.get("Beforeobject").Access){n=e.get("Beforeobject").id.replace("pid:","");if((t=a.indexOf(n))>-1){r=i[a[t]];e.get("Beforeobject").name=r.objectName,e.get("Beforeobject").title=r.objectTitle,e.get("Beforeobject").icon=r.icon,e.get("Beforeobject").collabSpace=r.collabSpace,e.get("Beforeobject").ownerFullname=r.ownerFullname}}})})}t(e)}):t(e)})},getFlowdownCandidatesAndTheirStatus:function(e,t){return new Promise(function(i,a){if(e.length>0&&t.length>0){var r;r="/resources/modeler/change/changeaction/"+t+"?flowdown=1";n.makeWSCall(r,"GET","enovia","application/json",{},function(e){i(e)},function(e){alert("flowdown status failed")})}})},ignoreChangeRealized:function(e,i,a){var s=r.getCurrentModel();""==e.originChangeActionId&&(e.originChangeActionId=s.id),e=JSON.stringify(e);n.makeWSCall("/resources/modeler/change/reject","POST","enovia","application/json",e,function(e){if(s){var n={};o.mask(widget.body),n.onComplete=function(n){t.getGlobalVariable().arrOid=[],o.unmask(widget.body),i(e)},s.fetch(n)}},function(){o.unmask(widget.body)})},setSelectedProposedPerRealizedObject:function(e){this.selectedproposedObjectsArr=[],this.selectedproposedObjectsArr=e},getSelectedProposedPerRealizedObject:function(){return this.selectedproposedObjectsArr}}}),define("DS/ENOChgServices/scripts/factories/RegisteredChangeObjectFactories",["UWA/Core","DS/ENOChgServices/scripts/factories/ChangeActionFactory","DS/ENOChgServices/scripts/factories/ChangeOrderFactory","DS/ENOChgServices/scripts/factories/ChangeRequestFactory"],function(e,t,n,i){"use strict";return{ChangeAction:t,ChangeOrder:n,ChangeRequest:i}}),define("DS/ENOChgServices/scripts/factories/ChangeObjectFactory",["UWA/Core","UWA/Class","UWA/Class/Debug","UWA/Class/Events","DS/ENOChgServices/scripts/factories/RegisteredChangeObjectFactories"],function(e,t,n,i,a){"use strict";return t.extend(n,i,{init:function(e){this._changeObjectFactory=null,this._options=e,this._changeObjectFactory=new a[this._options.type](this._options.information),console.log(e)},getChangeObject:function(){return this._changeObjectFactory}})}),define("DS/ENOChgServices/scripts/services/ChgImpactAnalysisServices",["DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable"],function(e,t){"use strict";return{getCustomAttributesWithUXService:function(n,i){t.getGlobalVariable().customeViewIAList;return new Promise(function(a,r){t.getGlobalVariable().contextUser;let o=[...n],s={data:[{physicalid:i,label:"test",select_predicate:o}]},l=JSON.stringify(s);e.makeWSCallWithCSRF("/resources/v1/chguxservices/connectedChange/genericResourceFetch","POST","enovia","application/json",l,function(e){let t={};a(t=e)},function(e){r(e)})})}}}),define("DS/ENOChgServices/scripts/services/ChgCustomAttributeService",["DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgImpactAnalysisServices"],function(e,t,n,i){"use strict";let a={getCombinedClassList:function(e){let t=this;return new Promise(function(n,i){let a=[],r=[],o=[];for(let n of e)if(n.hasOwnProperty("value")){a.push(n.value);let e=t.getClassExtensionInterface(n.value);o.push(e)}else{a.push(Object.keys(n)[0]);let e=t.getClassExtensionInterface(Object.keys(n)[0]);o.push(e)}Promise.all(o).then(function(e){if("[object Error]"!==Object.prototype.toString.call(e))for(let t of e)if(t.extensions.length>0)for(let e of t.extensions)r.push(e.curi);let t=[...a,...r].join(",");n(t)})})},getPropertyForClassGrid:function(n){return new Promise(function(i,a){let r=e.getGlobalVariable().tenant;var o="en";widget&&widget.getValue("lang")&&(o=widget.getValue("lang"));let s={tenantId:r,lang:o,onComplete:function(e){i(e)},onFailure:function(e){i(e)}};t.getPropertiesForClass(n,s)})},getClassExtensionInterface:function(n){return new Promise(function(i,a){let r={tenantId:e.getGlobalVariable().tenant,lang:"en",onComplete:function(e){i(e)},onFailure:function(e){i(e)}};t.getExtensionsForClass(n,r)})},makeCombinedColumnList:function(e){let t=new Map;if("[object Error]"!==Object.prototype.toString.call(e)){let n=e.classPredicates;for(let e of n){let n=e.vocabularyPredicateInfo;for(let e of n){let n=e.uri,i=e.selectable,a={vocabColumnsNameNLS:e.nlsName,dataType:e.range.dataTypes[0],range:e.hasOwnProperty("rangeValues"),select:i};t.set(n,a)}}}return t},iaSubTypesFetched:function(){return new Promise(function(t,n){null!=e.getGlobalVariable().subTypes?t():a.fetchSubTypes(t,n)})},coSubTypesFetched:function(){return new Promise(function(t,n){null!=e.getGlobalVariable().changeOrderSubTypes?t():a.fetchCOSubTypes(t,n)})},crSubTypesFetched:function(){return new Promise(function(t,n){null!=e.getGlobalVariable().changeRequestSubTypes?t():a.fetchCRSubTypes(t,n)})},fetchCRSubTypes:function(t){var i=this;n.makeWSCall("/resources/dictionary/getTypeInfo","POST","enovia","application/json",'["Change Request"]',function(n){if(Object.keys(n).length>1){e.getGlobalVariable().changeRequestSubTypes=[];var a=[];Object.keys(n).forEach(function(e){var t=i.fetchNLSForCRSubType(e);a.push(t)}),Promise.all(a).then(function(){e.getGlobalVariable().changeRequestSubTypePresent=!0;var n=[],i=0;Object.keys(e.getGlobalVariable().changeRequestSubTypes).forEach(function(t){var a=e.getGlobalVariable().changeRequestSubTypes[t];n[i]={label:a,value:t},i++}),n.sort(function(e,t){return e.label.toUpperCase()>t.label.toUpperCase()?1:-1}),e.getGlobalVariable().changeRequestSubTypes=n,null!=t&&t()})}else if(1==Object.keys(n).length){var r=Object.keys(n),o={};o[r[0]]=r[0],e.getGlobalVariable().changeRequestSubTypePresent=!1,e.getGlobalVariable().changeRequestSubTypes=[],e.getGlobalVariable().changeRequestSubTypes.push(o),null!=t&&t()}else null!=t&&t()},function(n){e.getGlobalVariable().changeRequestSubTypePresent=!1,null!=t&&t()},!0)},fetchCOSubTypes:function(t){var i=this;n.makeWSCall("/resources/dictionary/getTypeInfo","POST","enovia","application/json",'["Change Order"]',function(n){if(Object.keys(n).length>1){e.getGlobalVariable().changeOrderSubTypes=[];var a=[];Object.keys(n).forEach(function(e){var t=i.fetchNLSForCOSubType(e);a.push(t)}),Promise.all(a).then(function(){e.getGlobalVariable().changeOrderSubTypePresent=!0;var n=[],i=0;Object.keys(e.getGlobalVariable().changeOrderSubTypes).forEach(function(t){var a=e.getGlobalVariable().changeOrderSubTypes[t];n[i]={label:a,value:t},i++}),n.sort(function(e,t){return e.label.toUpperCase()>t.label.toUpperCase()?1:-1}),e.getGlobalVariable().changeOrderSubTypes=n,null!=t&&t()})}else if(1==Object.keys(n).length){var r=Object.keys(n),o={};o[r[0]]=r[0],e.getGlobalVariable().changeOrderSubTypePresent=!1,e.getGlobalVariable().changeOrderSubTypes=[],e.getGlobalVariable().changeOrderSubTypes.push(o),null!=t&&t()}else null!=t&&t()},function(n){e.getGlobalVariable().changeOrderSubTypePresent=!1,null!=t&&t()},!0)},fetchNLSForCOSubType:function(t){return new Promise(function(i,a){var r="/resources/dictionary/class/"+t+"/attributes";n.makeWSCall(r,"GET","enovia","application/json","",function(n){UWA.is(n.NLSName)&&""!=n.NLSName?e.getGlobalVariable().changeOrderSubTypes[t]=n.NLSName:e.getGlobalVariable().changeOrderSubTypes[t]=t,i()},function(n){e.getGlobalVariable().changeOrderSubTypes[t]=t,i()},!0)})},fetchNLSForCRSubType:function(t){return new Promise(function(i,a){var r="/resources/dictionary/class/"+t+"/attributes";n.makeWSCall(r,"GET","enovia","application/json","",function(n){UWA.is(n.NLSName)&&""!=n.NLSName?e.getGlobalVariable().changeRequestSubTypes[t]=n.NLSName:e.getGlobalVariable().changeRequestSubTypes[t]=t,i()},function(n){e.getGlobalVariable().changeRequestSubTypes[t]=t,i()},!0)})},fetchSubTypes:function(t){var i=JSON.stringify(["Change Action","Change Order"]);n.makeWSCall("/resources/dictionary/getTypeInfo","POST","enovia","application/json",i,function(n){if(Object.keys(n).length>0){e.getGlobalVariable().subTypes=[];var i=[];Object.keys(n).forEach(function(e){i.push(e)}),e.getGlobalVariable().subTypes=i,e.getGlobalVariable().subTypePresent=!0,null!=t&&t()}},function(n){e.getGlobalVariable().subTypePresent=!1,null!=t&&t()},!0)},updateAsynAttributeColumn:function(e,t,n){window.performance.now();i.getCustomAttributesWithUXService(e,t,n).then(function(t){let i=t.data;if(null!=i)for(let t=0;t<i.length;t++)for(let a=0;a<n.length;a++){let r=[...e],o=i[t];if(o.id==n[a].options.grid.id){n[a].prepareUpdate();for(let e=0;e<r.length;e++)n[a].setAttribute(r[e],o[r[e]]);n[a].pushUpdate()}}})}};return a});