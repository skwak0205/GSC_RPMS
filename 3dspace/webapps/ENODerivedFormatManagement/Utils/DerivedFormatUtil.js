define("DS/ENODerivedFormatManagement/Utils/DerivedFormatUtil",["DS/UIKIT/Alert","DS/UIKIT/Mask","DS/UIKIT/SuperModal","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/WAFData/WAFData","UWA/Promise"],function(e,t,a,n,r,i){return{platformServices:null,maskView:function(){document.getElementsByClassName("edfm-formatlistview")[0]&&t.mask(document.getElementsByClassName("edfm-formatlistview")[0])},unmaskView:function(){document.getElementsByClassName("edfm-formatlistview")[0]&&t.unmask(document.getElementsByClassName("edfm-formatlistview")[0])},alert:function(){return new e({visible:!0,autoHide:!0,hideDelay:3e3}).inject(document.getElementsByClassName("info-section")[0])},confimationModal:function(e,t){var n="";return"delete"==t?n=derivedformatmanagementinfra.getNLSData().label.deleteConfirm+"\n\n":"apply"==t&&(n=derivedformatmanagementinfra.getNLSData().label.applyConfirm+"\n\n"),n+=derivedformatmanagementinfra.getNLSData().label.confirmation,(new a).dialog({closable:!0,body:n,title:derivedformatmanagementinfra.getNLSData().label.warning,buttons:[{className:"primary",value:derivedformatmanagementinfra.getNLSData().button.yes,action:e},{value:derivedformatmanagementinfra.getNLSData().button.no,action:function(e){e.hide()}}]})},toggleTrigger(){(new a).dialog({closable:!0,body:derivedformatmanagementinfra.getNLSData().label.reloadCache,title:derivedformatmanagementinfra.getNLSData().label.important+":"})},get3DSpaceUrl:function(){return this.getPlatformURL("3DSpace")},getPlatformId:function(){return"undefined"!=typeof widget&&widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise"},retrievePlatformUrl:function(){var e=this;return new i(function(t,a){null===e.platformServices?n.getPlatformServices({onComplete:function(a){e.platformServices=a,t()},onFailure:function(e){a(e)}}):t()})},getTenantInfo:function(e){for(var t={},a=0;a<this.platformServices.length;a++)if(this.platformServices[a].platformId===e){t=this.platformServices[a];break}return t},getPlatformURL:function(e){if(!UWA.is(this.platformServices,"array"))throw new Error("Platform services not initialize yet");var t=this.getPlatformId(),a=this.getTenantInfo(t);if(void 0===a[e])throw console.error("No "+e+" URL available for this tenant."),new Error("Unknown service "+e);return a[e]},sendServerRequest:function(e){var t=this,a={},n=derivedformatmanagementinfra.getSecurityContext();a.method=e.method,a.headers={Accept:"application/json","Accept-Language":widget.lang,"Content-Type":"application/json"},n&&(a.headers.SecurityContext=encodeURIComponent(n)),a.type="json",a.proxy="passport",a.timeout=void 0!==e.timeout?e.timeout:3e5,a.onComplete=e.onComplete,a.onFailure=e.onFailure,a.onTimeout=void 0!==e.onTimeout?e.onTimeout:e.onFailure;var i=e.data;a.data=JSON.stringify(i),t.retrievePlatformUrl().then(function(){var n=t.get3DSpaceUrl();r.authenticatedRequest(n+e.url,a)})}}});