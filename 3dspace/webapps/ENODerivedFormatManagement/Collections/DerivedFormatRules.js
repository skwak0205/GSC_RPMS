define("DS/ENODerivedFormatManagement/Collections/DerivedFormatRules",["UWA/Class/Collection","DS/ENODerivedFormatManagement/Models/DerivedFormatRule","DS/ENODerivedFormatManagement/Utils/DerivedFormatUtil"],function(e,a,r){return e.extend({url:"/resources/v1/modeler/conversionAdmin/derivedformatmanagement/derivedoutputrule",model:a,init:function(){this._parent.apply(this,arguments)},fetch:function(e){var a=this;r.maskView();var t={url:a.url,onComplete:function(e){a.postAjaxProcess(a,e)},onFailure:function(e){a.postAjaxProcess(a,e)},method:"GET"};r.sendServerRequest(t)},postAjaxProcess:function(e,t){t.data?(e.add(new a),e.remove(e._models[0]),t.data.forEach(function(r,t){var n=new a(r);e.add(n)}),r.unmaskView()):t.error&&(derivedformatmanagementinfra.servererror=!0,r.unmaskView(),r.alert().add({className:"error",message:derivedformatmanagementinfra.getNLSData()?derivedformatmanagementinfra.getNLSData().label.serverError:"Server Error"}))},setToBeDeleted:function(e){var a=this;e&&e.length>0&&e.forEach(function(e,r){var t=a.get(e);t.set("action","deleted"),a.add(t)})},applyRules:function(){var e=this;r.maskView();var a=[],t=[];if(e.length>0){for(idx=0;idx<e.length;idx++){var n=e._models[idx],o=n.get("action");a.push(n._attributes),"deployed"!=o&&t.push(n)}var s={method:"POST",url:e.url,data:{data:a},onComplete:function(a){e.postApplyProcess(e,a,t)},onFailure:function(e){r.unmaskView(),r.alert().add({className:"error",message:derivedformatmanagementinfra.getNLSData().label.applyFailure})}};r.sendServerRequest(s)}},postApplyProcess:function(e,t,n){e.remove(n),t.data&&t.data.forEach(function(r,t){var n=new a(r);e.add(n)}),t.toggleTrigger&&r.toggleTrigger(),r.unmaskView(),r.alert().add({className:"success",message:derivedformatmanagementinfra.getNLSData().label.applySuccess})}})});