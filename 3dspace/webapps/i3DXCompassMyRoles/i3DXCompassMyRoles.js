define("DS/i3DXCompassMyRoles/Collection/RoleCollection",["UWA/Core","UWA/Class/Model","DS/i3DXCompassCore/Collection/i3DXCompassCollection"],function(e,t,o){"use strict";return o.extend({url:"api/roles/self",model:t,parse:function(e){return e.roles}})}),define("DS/i3DXCompassMyRoles/View/RoleView",["UWA/Core","UWA/Class/View","DS/UIKIT/Modal","DS/i3DXCompass/Controls/IframeLoader","i18n!DS/i3DXCompassMyRoles/assets/nls/i3DXCompassMyRoles"],function(e,t,o,i,s){"use strict";return t.extend({tagName:"div",className:"role-view",render:function(){return this.container.setContent(this._createTemplate()),this.container.addEvent("click",this._openDetail.bind(this)),this},_createTemplate:function(){var e=this;return[{class:"role-header",html:{tag:"p",text:this.model.get("name")}},{class:"role-body",html:[{tag:"i",class:"role-image-shadow"},this.model.get("icon")?{tag:"img",class:"role-image-icon",src:this.model.get("icon"),events:{onerror:function(){e.container.hide()}}}:{tag:"i",class:"role-image fonticon fonticon-role fonticon-2x"},this._buildInformation()]}]},_buildInformation:function(){var e=this.model.get("appsCount")?this.model.get("appsCount"):0;return{class:"role-content",html:[{html:[{tag:"span",class:"fonticon fonticon-drive"},{tag:"span",text:s.apps.format(e)}]},this.model.get("until")?{html:[{tag:"p",html:[{tag:"span",class:"fonticon fonticon fonticon-clock"},{tag:"span",text:s.expire.format(this.model.get("until"))}]}]}:null]}},_openDetail:function(){var e=new o({className:"compass-modal compass-request-modal",closable:!0,visible:!0,events:{onHide:function(){e.destroy()}},header:"<h4>"+this.model.get("name")+"</h4>",body:new i({src:this.model.get("description"),text:s.noAdditional})}).inject(document.body)}})}),define("DS/i3DXCompassMyRoles/Collection/PlatformCollection",["UWA/Core","UWA/Class/Model","DS/i3DXCompassCore/Collection/i3DXCompassCollection","DS/i3DXCompassServices/i3DXCompassServices"],function(e,t,o,i){"use strict";var s=t.extend({idAttribute:"platformId"});return o.extend({url:"",model:s,sync:function(e,t,o){var s=o.onComplete;i.getPlatformServices({onComplete:s})}})}),define("DS/i3DXCompassMyRoles/View/RolesView",["UWA/Core","UWA/Class/View","DS/UIKIT/Spinner","DS/UIKIT/Modal","DS/i3DXCompass/Controls/IframeLoader","DS/i3DXCompassMyRoles/View/RoleView"],function(e,t,o,i,s,n){"use strict";return t.extend({tagName:"div",className:"roles-view",render:function(){return this.container.setContent(this._createTemplate()),this},_createTemplate:function(){return this.collection.map(function(e){return{class:"role-view-wrapper",html:new n({model:e}).render()}})}})}),define("DS/i3DXCompassMyRoles/i3DXCompassMyRoles",["UWA/Core","UWA/Class","DS/UIKIT/Mask","DS/i3DXCompassMyRoles/View/RolesView","DS/i3DXCompassMyRoles/Collection/RoleCollection","DS/i3DXCompassMyRoles/Collection/PlatformCollection","DS/W3DXComponents/Views/Layout/ScrollView","DS/i3DXCompassCore/RequestOptions","css!DS/i3DXCompassMyRoles/i3DXCompassMyRoles","i18n!DS/i3DXCompassMyRoles/assets/nls/i3DXCompassMyRoles"],function(e,t,o,i,s,n,l,a,r){"use strict";return t.extend({widget:null,init:function(e){this.widget=e.widget,this.platform=e.platform,a.setupLanguage(this.widget.lang),this._initWidgetEvents()},_initWidgetEvents:function(){this.widget.addEvents({onLoad:this._initWidgetPreferences.bind(this)})},_initWidgetPreferences:function(){var e=this,t=e.widget,o=[];this.collection=new n,this.collection.fetch({onComplete:function(){e.collection.forEach(function(e){o.push({label:e.get("displayName"),value:e.get("platformId"),id:e.get("platformId")})}),e.collection.size()>1&&t.addPreference({type:"list",id:"x3dPlatformId",name:"x3dPlatformId",label:r.platform,defaultValue:t.getValue("x3dPlatformId"),options:o}),e._onLoad()}})},_getCurrentPlatform:function(){var e,t=this.widget.getValue("x3dPlatformId");return t&&""!==t&&(e=this.collection.get(t)),e||this.collection.first()},_onLoad:function(){var t=this.widget.body,n=this._getCurrentPlatform(),a=new s,r=new i({collection:a});o.mask(t),this.widget.setTitle(n.get("displayName")),t.setContent(e.createElement("div",{class:"i3DXCompass-my-roles",html:new l({useInfiniteScroll:!1,usePullToRefresh:!1,orientation:"vertical",view:r}).render()})),a.fetch({data:{platform:n.get("platformId")},onComplete:function(){o.unmask(t),r.render()},onFailure:function(){o.unmask(t),r.render()}})}})});