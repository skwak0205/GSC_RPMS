define("DS/LifecycleWebInWinSelectorWidget/LifecycleWebInWinSelectorWidget",["css!DS/LifecycleWidget/LifecycleWidget","css!DS/LifecycleWebInWinSelectorWidget/LifecycleWebInWinSelectorWidget","UWA/Controls/Abstract","DS/ENO6WPlugins/jQuery","DS/WAFData/WAFData","DS/WebInWinHelper/WebInWinHelper","DS/HistoryMultiPanel/HistoryMultiPanel","DS/Controls/Button","DS/LifecycleServices/LifecycleAlert","DS/LifecycleServices/LifecycleServicesSettings","i18n!DS/LifecycleWidget/assets/nls/LifecycleWidgetNls"],function(e,t,i,n,o,s,l,c,a,r,d){"use strict";return i.extend({defaultOptions:{wintop:!1},webToWinCom_Socket:null,ContextualMenus:null,context:null,displayNotification:function(e){a.displayNotification(e)},init:function(e,t,i){var o=this;this.widget=e,this.context=this,this.options=i,this.options.NoContextMenu="true",this.options.modelRevisions="true",this.isWebInWinODTMode=i.isWebInWinODTMode,this.securityContext=null,s.getServices(o),r.app_initialization(function(){s.initTenant(o),r.setTenant(o.tenant)}),this.contextMenuObject=null,1==this.options.wintop&&(this.webToWinCom_Socket=s.createWebInWinSocket("webinwinhistory_socket_")),this.options.webToWinComSocket=this.webToWinCom_Socket,this.options.fromWebInWinWrapper=!0,this.parentWidget=t,this._parent(i);var a=UWA.createElement("div");this.elements.container=a,a.className="webinwin_history_frame",a.setAttribute("data-rec-id",a.className),this.titleDiv=UWA.createElement("div"),this.titleDiv.className="webinwin_history_title",this.titleDiv.setAttribute("data-rec-id",this.titleDiv.className),this.titleDiv.inject(this.elements.container),this.titleWidget=UWA.createElement("h4",{class:"ebinwin_history_title_widget","data-rec-id":"ebinwin_history_title_widget",text:UWA.i18n("")}),this.titleWidget.inject(this.titleDiv);var u={setObjects:function(e,t,i){o.updateObjects(e,t,i)},setTitleFromObject:function(e){null!==o.historyMultiPanel.selectedData&&1===o.historyMultiPanel.selectedData.selectedNodes.length?o.setTitleFromObject(e):o.setTitle("  ")},postUpdateHandler:function(e){void 0!==e.selectedNodes&&(e.selectedNodes.length>0?o.okButton.disabled=!1:o.okButton.disabled=!0)},postVersionExplorerLoadedHandler:function(e){!0===e.autoFire&&("true"===o.options.SendResultsToCSO&&o.sendSelection(o.historyMultiPanel.selectedData.selectedNodes),"true"===o.options.SendResultsToCSODirect&&o.sendSelection(o.historyMultiPanel.selectedData.selectedNodes,!0),void 0!==o.options.OnOkFireCommand&&s.fireWintopCommandWithArgs(o.webToWinCom_Socket,o.historyMultiPanel.selectedData,o.options.OnOkFireCommand),s.closePanel(o.webToWinCom_Socket)),s.sendModelLoadedNotif(o.webToWinCom_Socket)}};this.historyMultiPanel=new l(this,e,t,i,u),window.addEventListener("resize",function(e){o.historyMultiPanel.revisionFamily.onResize(e)}),this.historyMultiPanel.inject(this.elements.container),1==this.options.wintop&&n(document).ready(function(){n(window).resize(function(){o.historyMultiPanel.revisionFamily.onResize()})});var h=UWA.createElement("div");h.className="webinwin_version_selector_buttons_div",h.setAttribute("data-rec-id",h.className),this.okButton=new c({label:d.okButton,attributes:{"data-rec-id":"okButton"},displayStyle:"normal",disabled:!0}),this.cancelButton=new c({label:d.cancelButton,attributes:{"data-rec-id":"cancelButton"},displayStyle:"normal"}),this.cancelButton.inject(h),this.okButton.inject(h),h.inject(this.elements.container),this.okButton.addEventListener("buttonclick",function(){"true"===o.options.SendResultsToCSO&&o.sendSelection(o.historyMultiPanel.selectedData.selectedNodes),"true"===o.options.SendResultsToCSODirect&&o.sendSelection(o.historyMultiPanel.selectedData.selectedNodes,!0),void 0!==o.options.OnOkFireCommand&&s.fireWintopCommandWithArgs(o.webToWinCom_Socket,o.historyMultiPanel.selectedData,o.options.OnOkFireCommand),s.closePanel(o.webToWinCom_Socket)}),this.cancelButton.addEventListener("buttonclick",function(){void 0!==o.options.OnCancelFireCommand&&s.fireWintopCommandWithArgs(o.webToWinCom_Socket,o.historyMultiPanel.selectedData,o.options.OnCancelFireCommand),s.closePanel(o.webToWinCom_Socket)})},setTitle:function(e){this.titleWidget.innerHTML=e},setTitleFromObject:function(e){e&&e.displayName&&this.setTitle(e.displayName+" "+e.revision)},sendSelection:function(e,t){s.setCSOSelection(this.options.webToWinComSocket,e,t)},reframeHistoryTree:function(){},updateObjects:function(e,t,i){var n=this;0==i&&this.historyMultiPanel.revisionFamily.setObjects(e),setTimeout(function(){n.reframeHistoryTree()},1);var o=[];s.getJSONArrayFromSelectionData(n.webToWinCom_Socket,e,o);var l=JSON.stringify(o);this.widget.setValue("Custo_roots_pids",l)},initDatafromWin:function(e){var t=this,i=[];e.forEach(function(e){var n={physicalid:e.physicalId,name:e.name,tenant:t.tenant};i.push(n)}),this.historyMultiPanel.setObjects(i,!1,!1)},onResize:function(){},onRefresh:function(){},initEnvfromWin:function(e){},onSetCtxMenuForItem:function(e){this.historyMultiPanel.revisionFamily.onSetCtxMenuForItem(e),null!==this.historyMultiPanel.revisionFamily.contextMenuObject&&this.historyMultiPanel.revisionFamily.contextMenuObject.physicalid}})});