define("DS/DELPPWNavigationServices/NavigationBase",["UWA/Core","UWA/Class"],function(e,t){"use strict";return t.extend({init:function(e){if(!e.collectionUtils)throw new Error("collectionUtils option not defined");this.collectionUtils=e.collectionUtils,this.mandatoryPredicates=e.mandatoryPredicates},splitIntoChunks:function(e,t){var n,i,o=Math.ceil(e.length/t),r=[];for(i=0,n=0;i<o;i++,n+=t)r[i]=e.slice(n,n+t);return r},_addToCollections:function(e,t){t=t||{},e.onComplete=function(e){Object.prototype.hasOwnProperty.call(t,"callback")&&t.callback instanceof Function&&t.callback(e)},this.collectionUtils.addToCollections(e)},_onDocumentComplete:function(e){Object.keys(e).length;return function(){0}},_addDocuments:function(e,t,n){n instanceof Function&&n()}})}),define("DS/DELPPWNavigationServices/PathSRParser",["UWA/Core","DS/DELPPWLoggerModel/LoggerUtils"],function(e,t){"use strict";return function(){var n,i,o,r={DELFmiProcessPrereqMaterializationCnx:{BUS:{name:"scope",type:"ResultingProductLink",from:{role:"R_150",category:"S_7"},to:{role:"R_149",category:"S_5"}}},DELFmiProcessOutputPrereqMaterializationCnx:{BUS:{name:"resultingProduct",type:"ResultingProductLink",from:{role:"R_150",category:"S_7"},to:{role:"R_149",category:"S_5"}}},DELFmiProcessImplementCnx:{BUS:{name:"scope",type:"ProductImplementLink",from:{role:"R_52",category:"S_7"},to:{role:"R_51",category:"S_5"}}},PartialProductImplementLink:{BUS:{name:"partialScope",type:"PartialProductImplementLink",to:{role:"R_51",category:"S_5"}}},MfgProductionPlanning:{BUS:{name:"scope",type:"ProcessImplementLink",from:{role:"R_52",category:"S_7"},to:{role:"R_51",category:"S_5"}},REL:{name:"operationProcessImplement",type:"ProcessImplementLinkOcc",from:{role:"R_52",category:"S_7"},to:{role:"R_51",category:"S_5"}}},PartialProcessImplementLink:{BUS:{name:"PartialProcessImplementLink",type:"PartialProcessImplementLink",to:{role:"R_51",category:"S_1"}}},DELLmiTimeConstraintCnx:{REL:{name:"productFlow",type:"DELLmiTimeConstraintCnx",from:{role:"R_248",category:"S_1"},to:{role:"R_249",category:"S_1"}}},DELLmiMaterialPathCnxCust:{BUS:{name:"Material",type:"DELLmiMaterialPathCnxCust",from:{role:"R_295",category:"S_1"},to:{role:"R_294",category:"S_1"}}},HistorizationLinkRefRef:{BUS:{name:"historization",type:"HistorizationLinkRefRef",from:{role:"R_308",category:"S_7"},to:{role:"R_307",category:"S_5"}}},DELAsmProcessCanUseCnx:{BUS:{name:"candidateResource",type:"DELAsmProcessCanUseCnx",from:{role:"R_203",category:"S_5"},to:{role:"R_204",category:"S_6"}}},SecondaryCandidateResourceLink:{BUS:{name:"secondaryResource",type:"SecondaryCandidateResourceLink",from:{role:"R_461",category:"S_1"},to:{role:"R_247",category:"S_1"}}},CapableResourcesStructureLink:{BUS:{name:"CapableResourcesStructureLink",type:"CapableResourcesStructureLink",to:{role:"R_490",category:"S_1"}}},DELLmiProductionSystemOutputCnxToMBOM:{BUS:{name:"mbomOperationOutput",type:"DELLmiProductionSystemOutputCnxToMBOM",from:{role:"R_296",category:"S_1"},to:{role:"R_363",category:"S_1"},tryToFindFromSide:!0}},PLMDocConnection:{BUS:{name:"document",type:"PLMDocConnection",to:{role:"R_87",category:"S_1"}}},PPRContextSystemCnxDisc:{BUS:{name:"system",type:"PPRContextSystemCnxDisc",to:{role:"R_246",category:"S_6"}}},PPRContextProcessCnxDisc:{BUS:{name:"process",type:"PPRContextProcessCnxDisc",to:{role:"R_115",category:"S_6"}}}},s={ProductImplementLinkOcc:{REL:{name:"productMbomImplement",type:"ProductImplementLinkOcc",to:{role:"R_51",category:"S_5"}}}};return n=function(e){return e.indexOf("LT_BO")>-1},i=function(e){var t,n;return t=e.indexOf("PS"),t+="PS".length+" ".length,n=e.indexOf("PE")-" ".length,e.substring(t,n).split(" ")},o=function(i,o,a,c,l,d,u,f){var p,m,g,h,y,v,P,I,_,S,R=function(e){v.from.role===p&&v.from.category===m?f.from=e:v.to.role===p&&v.to.category===m&&(f.to=e)};return h=i.indexOf("R"),y=i.indexOf(" ",h),p=i.substring(h,y),h=i.indexOf("S"),y=i.indexOf(" ",h),m=i.substring(h,y),h=i.indexOf("I"),y=i.indexOf(" ",h),P=i.substring(h,y),I=parseInt(P.split("_")[1]),v=c?r[a]:s[a],e.is(v)?(v=n(i)?v.BUS:v.REL,e.is(v)&&function(n){var i;switch(n){case"ResultingProductLink":1===o.length&&(_=o[0],I>0&&(e.is(f.isRefRef)||(f.isRefRef=!0),v.from.role===p&&v.from.category===m?f.from=d.physicalid.value:v.to.role===p&&v.to.category===m&&(f.to=o[0]),e.is(f.type)||(f.type=n),e.is(f.from)&&e.is(f.to)&&(f.PID=f.type+"|"+f.from+"|"+f.to)));break;case"ProductImplementLink":o.length>0&&(_=o[o.length-1],I>0&&(e.is(f.isRefRef)||(f.isRefRef=!0),R(_),e.is(f.type)||(f.type=n),e.is(f.from)&&e.is(f.to)&&(f.PID=f.type+"|"+f.from+"|"+f.to)));break;case"ProductImplementLinkOcc":I>0&&(S=o,e.is(f.isRefRef)||(f.isRefRef=!1),v.to.role===p&&v.to.category===m&&(f.to=S,f.from=l.physicalid.value),e.is(f.type)||(f.type=n),f.PID=f.type+"|"+f.from+"|"+e.Json.encode(f.to));break;case"ProcessImplementLink":1===o.length&&(_=o[0],I>0&&(e.is(f.isRefRef)||(f.isRefRef=!0),R(_),e.is(f.type)||(f.type=n),e.is(f.from)&&e.is(f.to)&&(f.PID=f.type+"|"+f.from+"|"+f.to)));break;case"PartialProcessImplementLink":1===o.length&&(_=o[0],I>0&&(e.is(f.isRefRef)||(f.isRefRef=!0),v.to.role===p&&v.to.category===m&&(f.to=_,e.is(l)&&(f.from=l.physicalid.value)),e.is(f.type)||(f.type=n),e.is(f.from)&&e.is(f.to)&&(f.PID=f.type+"|"+f.from+"|"+f.to)));break;case"ProcessImplementLinkOcc":I>0&&(S=o,e.is(f.isRefRef)||(f.isRefRef=!1),R(S),e.is(f.type)||(f.type=n));break;case"DELLmiTimeConstraintCnx":if(I>0&&(S=o,e.is(f.isRefRef)||(f.isRefRef=!1),R(S),e.is(f.type)||(f.type=n),e.is(l.interface))){var r=l.interface.value;r=Array.isArray(r)?r:[r];var s=["DELLmiTimeConstraintAlternative","DELLmiTimeConstraintFailed","DELLmiTimeConstraintScrapped"];r.some(function(e){return s.indexOf(e)>-1&&(f.flowType=e,!0)})}break;case"DELLmiMaterialPathCnxCust":S=o.slice(0,o.length-1),I>0&&(e.is(f.isRefRef)||(f.isRefRef=!1),R(S),e.is(f.type)||(f.type=n));break;case"HistorizationLinkRefRef":case"DELAsmProcessCanUseCnx":case"SecondaryCandidateResourceLink":1===o.length&&(_=o[0],I>0&&(e.is(f.isRefRef)||(f.isRefRef=!0),R(_),e.is(f.type)||(f.type=n)));break;case"CapableResourcesStructureLink":case"PartialProductImplementLink":1===o.length&&(_=o[0],I>0&&(e.is(f.isRefRef)||(f.isRefRef=!0),v.to.role===p&&v.to.category===m&&(f.to=_,e.is(l)&&(f.from=l.physicalid.value)),e.is(f.type)||(f.type=n),e.is(f.from)&&e.is(f.to)&&(f.PID=f.type+"|"+f.from+"|"+f.to)));break;case"DELLmiProductionSystemOutputCnxToMBOM":1===o.length&&(_=o[0],I>0&&(e.is(f.isRefRef)||(f.isRefRef=!0),v.from.role===p&&v.from.category===m?e.is(v.tryToFindFromSide,"boolean")&&!0===v.tryToFindFromSide&&(_!==d.physicalid.value?(i=u.get(_),e.is(i)?i["from.physicalid"].value===d.physicalid.value?f.from=i["from.physicalid"].value:(g=e.is(d)&&e.is(d["ds6w:label"])&&e.is(d["ds6w:label"].value,"string")?d["ds6w:label"].value:"ds6w:label Not Defined",t.log('PathSRParser: Unable to find "from" side of "mbomSystemOutput" link of '+g)):(f.idToResolve=_,f.deferResolution=!0)):f.from=_):v.to.role===p&&v.to.category===m&&(f.to=_),e.is(f.type)||(f.type=n)));break;case"PLMDocConnection":1===o.length&&(_=o[0],I>0&&(e.is(f.isRefRef)||(f.isRefRef=!0),v.to.role===p&&v.to.category===m&&(f.to=_,e.is(d)&&(f.from=d.physicalid.value)),e.is(f.type)||(f.type=n)));break;case"PPRContextSystemCnxDisc":case"PPRContextProcessCnxDisc":1===o.length&&(_=o[0],I>0&&(e.is(f.isRefRef)||(f.isRefRef=!0),v.to.role===p&&v.to.category===m&&(f.to=_,e.is(d)&&(f.from=d.physicalid.value)),e.is(f.type)||(f.type=n),e.is(f.from)&&e.is(f.to)&&(f.PID=f.type+"|"+f.from+"|"+f.to)))}}(v.type)):t.error("PathSRParser: Link currently not supported"),f},{parse:function(t,n){var r,s=n||{},a=e.is(s.type)?s.type:null,c=!e.is(s.isRefRef,"boolean")||s.isRefRef,l=e.is(s.referenceEntity)?s.referenceEntity:null,d=e.is(s.ioPortToPlmPortMap)?s.ioPortToPlmPortMap:null,u=null;return e.is(t.pathsr)&&(r=t.pathsr.value,u={from:null,to:null,type:null,PID:null,isRefRef:null,deferResolution:!1},r.split("Sep").forEach(function(n){var r;r=i(n),c?u=o(n,r,a,c,t,l,d,u):e.is(a)||(u=o(n,r,a="ProductImplementLinkOcc",c,t,null,null,u))}),e.is(u.isRefRef)||(u.isRefRef=!1),!1!==u.deferResolution||e.is(u.from)&&e.is(u.to)||(u=null)),u}}}}),define("DS/DELPPWNavigationServices/SwitchDBModeManager",["UWA/Class","UWA/Core","DS/Core/Events"],function(e,t,n){"use strict";var i=null,o=18e4,r="SwitchDBManager/ChangeMode",s="indexMode";return e.singleton({init:function(){var e=null,a=null;t.is(widget.getPreference("switchDBTimeout"))&&(o=widget.getPreference("switchDBTimeout").defaultValue),t.is(widget.getValue("switchDBManagerEndTimestamp"))&&(e=widget.getValue("switchDBManagerEndTimestamp")),t.is(e)&&e>Date.now()&&(console.log("switchDBManager :  need to set to dbMode because timeout no reached !"),a=e-Date.now(),s="dbMode",n.publish({event:r,data:{mode:s}}),i=setTimeout(function(){s="indexMode",n.publish({event:r,param:{data:s}}),console.log("switchDBManager :  switch back to index mode")},a))},isDbMode:function(){return"dbMode"===s},setDbMode:function(e){var a=Date.now()+o,c=null;t.is(e,"boolean")&&(c=!0===e?"dbMode":"indexMode"),s!==c&&(s=c,n.publish({event:r,data:{mode:s}})),"dbMode"===s?(widget.setValue("switchDBManagerEndTimestamp",a),t.is(i)&&(clearTimeout(i),console.log("switchDBManager : Timeout cleared")),i=setTimeout(function(){s="indexMode",n.publish({event:r,data:{mode:"indexMode"}})},o)):(widget.setValue("switchDBManagerEndTimestamp",0),t.is(i)&&(clearTimeout(i),console.log("switchDBManager : Timeout cleared")))}})}),define("DS/DELPPWNavigationServices/NavigateOnIndex",["UWA/Core","DS/DELPPWNavigationServices/NavigationBase","DS/DELPPWNavigationServices/PathSRParser","DS/DELPPWWebServices/WebserviceUtils","DS/DELPPWDicoServices/DicoUtils","DS/DELPPWIndexServices/IndexParser","DS/DELPPWResourceServices/ResourceUtils","DS/DELPPWModelServices/ModelUtils","DS/DELPPWLoggerModel/LoggerUtils"],function(e,t,n,i,o,r,s,a,c){"use strict";var l=function(e){var t=["ImplementLinkUsageFamily","SymbolicLinkForScope"];return e=1===(e=(e=Array.isArray(e)?e:[e]).filter(function(e){return-1===t.indexOf(e)})).length?e[0]:null};return t.extend({_selectFacet:[],_computeBo:[],_selectPredicates:{},FETCH_CHUNK_SIZE:1e3,init:function(e){e=e||{},this._parent(e),this.selectPredicates={},this.pathSRParser=new n},getSelectUnit:function(t,n){var i,a=r.translatePredicateToAttribute(t,n),c={};return a.forEach(function(n,r){!(i=o.getAttributeInfo(n))||!i.ManipulationUnit||e.is(i.HasRangeDefined)&&"Yes"===i.HasRangeDefined||(c[t[r]]=s.getLabelForUnit(i.Magnitude,i.ManipulationUnit))}),c},fetchRoot:function(t,n){var i=this,o=n||{},r=e.is(o.context)?o.context:null,s=e.is(o.onComplete,"function")?o.onComplete:null,a=e.is(o.onFailure,"function")?o.onFailure:null,c=e.merge({onComplete:function(t){var o,c,l=function(t){var o=i.collectionUtils.addRef(t.attributes,n);return e.is(t.ds6w)&&o.setAdditionalInfo({ds6w:t.ds6w}),o};e.is(t)?e.is(t,"array")?0===t.length?a():(c=t.map(l),e.is(s,"function")&&s.call(r,c)):e.is(t.attributes)&&e.is(t.attributes.PID)?(o=l(t),e.is(s,"function")&&s.call(r,o)):a():a()},onFailure:a},o);i.fetchOnIndex(t,c)},fetchOnIndex:function(t,n){var o=i.get3DSpaceUrl()+"cvservlet/fetch/v2",s=n||{},c=e.is(s.type,"string")?s.type:"entity",l=e.is(s.context)?s.context:null,d=e.is(t)?e.is(t,"array")?t:[t]:null,u=e.is(s.select_predicate)?s.select_predicate:this.getSelectPredicate(c),f=this.getSelectUnit(u),p=!e.is(s.withSynthesisAttribute,"boolean")||s.withSynthesisAttribute,m={label:a.getCVServletLabel(),physicalid:d,select_predicate:u,locale:widget.locale,lang:widget.lang,select_unit:f,with_synthesis_attribute:p};i.webServiceRequest({url:o,method:"POST",headers:i.getHeaders({isJsonOnly:!0}),data:e.Json.encode(m),options:n,onComplete:function(t){var n,i=[];e.is(t)&&e.is(t.results)&&(n=e.is(t.results,"array")?t.results:null),e.is(n,"array")&&n.forEach(function(t){var n=r.parseFetchResult(t),o=r.translatePredicateToAttribute(n.attributes,{type:c});e.merge(o,r.translatePredicateToAttribute(n.ds6w,{type:c,fromExpandService:!0})),n.attributes=o,i.push(n)}),e.is(s.onComplete,"function")&&(i=i.length>0?i.length>1?i:i[0]:[],s.onComplete.call(l,i))},onFailure:function(t){e.is(s.onFailure,"function")&&s.onFailure.call(l,t)}})},setSelectPredicate:function(t,n){var i,o,s=e.is(this.mandatoryPredicates)&&e.is(this.mandatoryPredicates.refMandatoryAttributes,"array")?this.mandatoryPredicates.refMandatoryAttributes:["PID","type","V_Name","PLM_ExternalID","V_discipline","V_usage","description","V_MaterialNeed","interface","V_IsPreferred","V_SequencingMode"],a=e.is(this.mandatoryPredicates)&&e.is(this.mandatoryPredicates.instMandatoryAttributes,"array")?this.mandatoryPredicates.instMandatoryAttributes:["PID","type","V_Name","PLM_ExternalID","V_discipline","V_usage","isAggregatedBy","isInstanceOf","V_TreeOrder"];s.forEach(function(e){-1===n.boAttrName.indexOf(e)&&n.boAttrName.push(e)}),a.forEach(function(e){-1===n.roAttrName.indexOf(e)&&n.roAttrName.push(e)}),i=e.is(this._selectPredicates[t])?this._selectPredicates[t]:{},o={entity:r.translateAttributeToPredicate(n.boAttrName,{type:"entity"}),relation:r.translateAttributeToPredicate(n.roAttrName,{type:"relation"})},e.is(i.entity)||e.is(i.relation)?(o.entity.forEach(function(e){-1===i.entity.indexOf(e)&&i.entity.push(e)}),o.relation.forEach(function(e){-1===i.relation.indexOf(e)&&i.relation.push(e)}),this._selectPredicates[t]=i):this._selectPredicates[t]=o},getSelectPredicate:function(e,t){var n=[],i=this._selectPredicates;if(e=e||"entity",t)switch(e){case"entity":n=i[t].entity;break;case"relation":n=i[t].relation}else switch(e){case"entity":Object.keys(i).forEach(function(e){var t=i[e].entity;Object.keys(t).map(function(e){return t[e]}).forEach(function(e){-1===n.indexOf(e)&&n.push(e)})});break;case"relation":Object.keys(i).forEach(function(e){var t=i[e].relation;Object.keys(t).map(function(e){return t[e]}).forEach(function(e){-1===n.indexOf(e)&&n.push(e)})})}return n},navigateScopes:function(t,n,i){var o={stackedReferences:[],stackedInstances:[],stackedConnections:[],documentIdMap:{}},r=i||{},s=this,a=!1;r=e.merge(r,{callback:n}),t.length>0?this.getProductScopedLinks(t,function(t){var n;e.is(t)&&e.is(t.result,"array")&&e.is(t.result[0])&&(n=t.result[0].outputs.scopes,e.is(n)&&n.forEach(function(e){o.stackedReferences.push(e),a=!0})),!0===a?s._addToCollections(o,r):r.callback(null)},e.extend(i,{context:this})):n(null)},getReferenceFromInstance:function(t,n,o){var r,s,c,l=i.get3DSpaceUrl()+"cvservlet/navigate?SecurityContext="+i.getSecurityContext(),d=[],u={},f=this.getSelectPredicate("entity").concat(this.getSelectPredicate("relation"));for(r=f.length;r--;)u[c=f[r]]||(d.unshift(c),u[c]=!0);o=o||{},t instanceof Array||(t=[t]),o.selectBo instanceof Array&&(d=o.selectBo),d.push("pathsr"),s={label:a.getCVServletLabel(),input_physical_ids:t,primitives:[{navigate_from_rel:{id:1},navigate_to_rel:{id:2}}],patterns:{refsFrom:[{id:1}],refsTo:[{id:2}]},patternTypeFilters:{scopes:{typesToNotReturn:["PLMCoreInstance"],filterLinksOn:"elements"}},attributes:d,fileAttributes:[],version:3},e.is(o.expandIter,"string")&&(s.expand_iter=o.expandIter),s=e.Json.encode(s),i.webServiceRequest({url:l,method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},data:s,onComplete:function(e){n instanceof Function&&n.call(o.context,e)},onFailure:function(e,t){o.onFailure instanceof Function&&o.onFailure(t)}})},getProductScopedLinks:function(t,n,o){var r,s,c,l=i.get3DSpaceUrl()+"cvservlet/navigate?SecurityContext="+i.getSecurityContext(),d=[],u={},f=this.getSelectPredicate("entity").concat(this.getSelectPredicate("relation"));for(r=f.length;r--;)u[c=f[r]]||(d.unshift(c),u[c]=!0);o=o||{},t instanceof Array||(t=[t]),o.selectBo instanceof Array&&(d=o.selectBo),d.push("pathsr"),s={label:a.getCVServletLabel(),input_physical_ids:t,primitives:[{navigate_from_sr:{id:1,mode:"contains",filter:{role:["51"],category:["5"]}},navigate_from_rel:{id:2}}],patterns:{scopes:[{id:1},{id:2}]},patternTypeFilters:{scopes:{typesToNotReturn:["PLMCoreInstance"],filterLinksOn:"elements"}},attributes:d,fileAttributes:[],version:3},e.is(o.expandIter,"string")&&(s.expand_iter=o.expandIter),s=e.Json.encode(s),i.webServiceRequest({url:l,method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},data:s,onComplete:function(e){n instanceof Function&&n.call(o.context,e)},onFailure:function(e,t){o.onFailure instanceof Function&&o.onFailure(t)}})},navigateOnIndex:function(t,n,o){var r,s,c,l=i.get3DSpaceUrl()+"cvservlet/navigate?SecurityContext="+i.getSecurityContext(),d=[],u={},f=this.getSelectPredicate("entity").concat(this.getSelectPredicate("relation"));for(r=f.length;r--;)u[c=f[r]]||(d.unshift(c),u[c]=!0);o=o||{},t instanceof Array||(t=[t]),o.selectBo instanceof Array&&(d=o.selectBo),d.push("pathsr"),s={label:a.getCVServletLabel(),input_physical_ids:t,primitives:[{navigate_to_sr:{id:1,filter:{role:["52"],category:["7"]},mode:"path"},navigate_from_sr:{id:2,mode:"ends",filter:{role:["52"],category:["7"]}}},{navigate_to_sr:{id:3,filter:{role:["51"],category:["5"]},mode:"path"},navigate_from_sr:{id:4,mode:"ends",filter:{role:["51"],category:["5"]}}},{navigate_to_sr:{id:5,filter:{role:["203"],category:["5"]},mode:"path"},navigate_from_sr:{id:6,filter:{role:["203"],category:["5"]}}},{navigate_to_sr:{id:7,filter:{role:["204"],category:["6"]},mode:"path"},navigate_from_sr:{id:8,filter:{role:["204"],category:["6"]}}},{navigate_to_sr:{id:9,filter:{role:["296"],category:["1"]},mode:"path"},navigate_from_sr:{id:10,filter:{role:["296"],category:["1"]}}},{navigate_to_sr:{id:11,filter:{role:["363"],category:["1"]},mode:"path"},navigate_from_sr:{id:12,filter:{role:["363"],category:["1"]}}},{navigate_to_rel:{id:13,filter:{rel_type:["MfgProcessAlternate"]},mode:"return_rel"},navigate_from_rel:{id:14,filter:{rel_type:["MfgProcessAlternate"]},mode:"return_rel"}},{navigate_to_rel:{id:15,filter:{rel_type:["VPLMrel_47_PLMPort_47_V_Owner"]}},navigate_from_rel:{id:16,filter:{rel_type:["VPLMrel_47_PLMPort_47_V_Owner"]},mode:"return_rel"}},{navigate_to_sr:{id:17,filter:{role:["296"],category:["1"]}}},{navigate_to_sr:{id:18,filter:{role:["308"],category:["7"]},mode:"path"},navigate_from_sr:{id:19,filter:{role:["308"],category:["7"]}}},{navigate_to_sr:{id:20,filter:{role:["307"],category:["5"]},mode:"path"},navigate_from_sr:{id:21,filter:{role:["307"],category:["5"]}}},{navigate_to_rel:{id:22,filter:{rel_type:["VPLMrel_47_PLMConnection_47_V_Owner"]}},navigate_to_sr:{id:23,filter:{role:["87"],category:["1"]},mode:"path"}},{navigate_to_sr:{id:24,filter:{role:["248"],category:["1"]},mode:"path"},navigate_from_sr:{id:25,mode:"ends",filter:{role:["248"],category:["1"]}}},{navigate_to_sr:{id:26,filter:{role:["249"],category:["1"]},mode:"path"},navigate_from_sr:{id:27,mode:"ends",filter:{role:["249"],category:["1"]}}},{navigate_to_sr:{id:28,filter:{role:["295"],category:["1"]},mode:"path"},navigate_from_sr:{id:29,filter:{role:["295"],category:["1"]}}},{navigate_to_sr:{id:30,filter:{role:["294"],category:["1"]},mode:"path"},navigate_from_sr:{id:31,filter:{role:["294"],category:["1"]}}},{navigate_to_sr:{id:32,filter:{role:["461"],category:["1"]},mode:"path"},navigate_from_sr:{id:33,filter:{role:["461"],category:["1"]}}},{navigate_to_sr:{id:34,filter:{role:["247"],category:["1"]},mode:"path"},navigate_from_sr:{id:35,filter:{role:["247"],category:["1"]}}},{navigate_to_sr:{id:36,filter:{role:["490"],category:["1"]},mode:"path"},navigate_from_sr:{id:37,mode:"ends",filter:{role:["490"],category:["1"]}}},{navigate_to_sr:{id:38,filter:{role:["51"],category:["5"]},mode:"last"}},{navigate_to_sr:{id:39,filter:{role:["51"],category:["1"]},mode:"path"},navigate_from_sr:{id:40,mode:"ends",filter:{role:["51"],category:["1"]}}}],patterns:{scope_pathSR:[{id:2},{id:3}],scopeInverse_pathSR:[{id:4},{id:1}],partialScope_pathSR:[{id:38}],partialScopeInverse_pathSR:[{id:4}],HeaderOperationPartialScope_pathSR:[{id:39}],HeaderOperationPartialScopeInverse_pathSR:[{id:40}],candidateResource_pathSR:[{id:6},{id:7}],candidateResourceInverse_pathSR:[{id:8},{id:5}],SecondaryResource_pathSR:[{id:33},{id:34}],SecondaryResourceInverse_pathSR:[{id:35},{id:32}],capableResourcesStructure_pathSR:[{id:36}],capableResourcesStructureInverse_pathSR:[{id:37}],mbomSystemOutput_pathSR:[{id:15},{id:10},{id:11}],mbomSystemOutputInverse_pathSR:[{id:12},{id:9}],mbomSystemOutputInverse_relation:[{id:12},{id:17},{id:16}],mbomOperationOutput_pathSR:[{id:10},{id:11}],mbomOperationOutputInverse_pathSR:[{id:12},{id:9}],alternate_relation:[{id:13}],alternateInverse_relation:[{id:14}],historization_pathSR:[{id:19},{id:20}],historizationInverse_pathSR:[{id:21},{id:18}],document_pathSR:[{id:22},{id:23}],productFlow_pathSR:[{id:25},{id:26}],productFlowInverse_pathSR:[{id:27},{id:24}],productMbomImplement_pathSR:[{id:3}],productMbomImplementInverse_pathSR:[{id:4}],Material_pathSR:[{id:29},{id:30}],MaterialInverse_pathSR:[{id:31},{id:28}],operationProcessImplement_pathSR:[{id:2},{id:3}],operationProcessImplementInverse_pathSR:[{id:4},{id:1}]},patternTypeFilters:{mbomSystemOutputInverse_pathSR:{typesReturn:["DELLmiProdSystemIOPort"]},mbomOperationOutputInverse_pathSR:{typesToNotReturn:["DELLmiProdSystemIOPort"]},productMbomImplement_pathSR:{typesToNotReturn:["PLMCoreReference"]},productMbomImplementInverse_pathSR:{typesToNotReturn:["DELFmiProcessImplementCnx","DELFmiFunctionIdentifiedInstance","MfgProductionPlanning","PLMCoreReference"]},scope_pathSR:{typesToNotReturn:["PLMCoreInstance"],filterLinksOn:"elements"},scopeInverse_pathSR:{typesToNotReturn:["PLMCoreInstance"],filterLinksOn:"elements"},partialScope_pathSR:{typesToReturn:["VPMReference"]},partialScopeInverse_pathSR:{typesToNotReturn:["DELFmiProcessImplementCnx","PLMCoreInstance","MfgProductionPlanning","DELLmiHeaderOperationReference"],filterLinksOn:"elements"},HeaderOperationPartialScope_pathSR:{typesToNotReturn:["VPMReference"],filterLinksOn:"elements"},HeaderOperationPartialScopeInverse_pathSR:{typesToReturn:["DELLmiHeaderOperationReference"]},operationProcessImplement_pathSR:{typesToNotReturn:["PLMCoreReference"],filterLinksOn:"elements"},operationProcessImplementInverse_pathSR:{typesToNotReturn:["PLMCoreReference"],filterLinksOn:"elements"}},attributes:d,fileAttributes:[],version:3},e.is(o.expandIter,"string")&&(s.expand_iter=o.expandIter),s=e.Json.encode(s),i.webServiceRequest({url:l,method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},data:s,onComplete:function(e){n instanceof Function&&n.call(o.context,e)},onFailure:function(e,t){o.onFailure instanceof Function&&o.onFailure(t)}})},navigateInverseOnIndex:function(t,n,o){var r,s,c,l=i.get3DSpaceUrl()+"cvservlet/navigate?SecurityContext="+i.getSecurityContext(),d=[],u={},f=this.getSelectPredicate("entity").concat(this.getSelectPredicate("relation"));for(r=f.length;r--;)u[c=f[r]]||(d.unshift(c),u[c]=!0);o=o||{},t instanceof Array||(t=[t]),o.selectBo instanceof Array&&(d=o.selectBo),d.push("pathsr"),s={label:a.getCVServletLabel(),input_physical_ids:t,primitives:[{navigate_to_sr:{id:1,filter:{role:["52"],category:["7"]},mode:"path"}},{navigate_from_sr:{id:4,mode:"ends",filter:{role:["51"],category:["5"]}}},{navigate_to_sr:{id:5,filter:{role:["203"],category:["5"]},mode:"path"}},{navigate_from_sr:{id:8,filter:{role:["204"],category:["6"]}}},{navigate_to_sr:{id:9,filter:{role:["296"],category:["1"]},mode:"path"}},{navigate_from_sr:{id:12,filter:{role:["363"],category:["1"]}}},{navigate_from_rel:{id:14,filter:{rel_type:["MfgProcessAlternate"]},mode:"return_rel"}},{navigate_from_rel:{id:16,filter:{rel_type:["VPLMrel_47_PLMPort_47_V_Owner"]},mode:"return_rel"}},{navigate_to_sr:{id:17,filter:{role:["296"],category:["1"]}}},{navigate_to_sr:{id:18,filter:{role:["308"],category:["7"]},mode:"path"}},{navigate_from_sr:{id:21,filter:{role:["307"],category:["5"]}}},{navigate_to_sr:{id:24,filter:{role:["248"],category:["1"]},mode:"path"}},{navigate_from_sr:{id:27,mode:"ends",filter:{role:["249"],category:["1"]}}},{navigate_to_sr:{id:28,filter:{role:["295"],category:["1"]},mode:"path"}},{navigate_from_sr:{id:31,filter:{role:["294"],category:["1"]}}},{navigate_to_sr:{id:32,filter:{role:["461"],category:["1"]},mode:"path"}},{navigate_from_sr:{id:35,filter:{role:["247"],category:["1"]}}},{navigate_from_sr:{id:37,mode:"ends",filter:{role:["490"],category:["1"]}}},{navigate_from_sr:{id:40,mode:"ends",filter:{role:["51"],category:["1"]}}}],patterns:{scopeInverse_pathSR:[{id:4},{id:1}],partialScopeInverse_pathSR:[{id:4}],HeaderOperationPartialScopeInverse_pathSR:[{id:40}],candidateResourceInverse_pathSR:[{id:8},{id:5}],SecondaryResourceInverse_pathSR:[{id:35},{id:32}],capableResourcesStructureInverse_pathSR:[{id:37}],mbomSystemOutputInverse_pathSR:[{id:12},{id:9}],mbomSystemOutputInverse_relation:[{id:12},{id:17},{id:16}],mbomOperationOutputInverse_pathSR:[{id:12},{id:9}],alternateInverse_relation:[{id:14}],historizationInverse_pathSR:[{id:21},{id:18}],productFlowInverse_pathSR:[{id:27},{id:24}],productMbomImplementInverse_pathSR:[{id:4}],MaterialInverse_pathSR:[{id:31},{id:28}],operationProcessImplementInverse_pathSR:[{id:4},{id:1}]},patternTypeFilters:{mbomSystemOutputInverse_pathSR:{typesReturn:["DELLmiProdSystemIOPort"]},mbomOperationOutputInverse_pathSR:{typesToNotReturn:["DELLmiProdSystemIOPort"]},productMbomImplementInverse_pathSR:{typesToNotReturn:["DELFmiProcessImplementCnx","DELFmiFunctionIdentifiedInstance","MfgProductionPlanning","PLMCoreReference"]},scopeInverse_pathSR:{typesToNotReturn:["PLMCoreInstance"],filterLinksOn:"elements"},partialScopeInverse_pathSR:{typesToNotReturn:["DELFmiProcessImplementCnx","PLMCoreInstance","MfgProductionPlanning","DELLmiHeaderOperationReference"],filterLinksOn:"elements"},HeaderOperationPartialScopeInverse_pathSR:{typesToReturn:["DELLmiHeaderOperationReference"]},operationProcessImplementInverse_pathSR:{typesToNotReturn:["PLMCoreReference"],filterLinksOn:"elements"}},attributes:d,fileAttributes:[],version:3},e.is(o.expandIter,"string")&&(s.expand_iter=o.expandIter),s=e.Json.encode(s),i.webServiceRequest({url:l,method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},data:s,onComplete:function(e){n instanceof Function&&n.call(o.context,e)},onFailure:function(e,t){o.onFailure instanceof Function&&o.onFailure(t)}})},_getMultipleNavigateOnIndexPromise:function(t,n,i){var o=parseInt(widget.getValue("navigateSplitSize")),r=this,s=i||{};return new Promise(function(i,a){var c,l={},d={},u={};n.stackedReferences.forEach(function(t){l[t.PID]=e.clone(t)}),n.stackedInstances.forEach(function(t){d[t.PID]=e.clone(t)}),n.stackedConnections.forEach(function(t){u[t.PID]=e.clone(t)}),c=r.splitIntoChunks(t,o).map(function(e){return new Promise(function(t,n){var i={stackedReferences:[],stackedInstances:[],stackedConnections:[],documentIdMap:{}};e.forEach(function(e){Object.prototype.hasOwnProperty.call(l,e)?i.stackedReferences.push(l[e]):Object.prototype.hasOwnProperty.call(d,e)&&i.stackedInstances.push(d[e])}),s.onFailure=function(){n("Navigate Failure")},r._navigateNodes(e,i,function(e){t({linkedRefIds:e,stackedObjects:i})},s)})}),Promise.all(c).then(function(t){var o,r=[],s={stackedReferences:[],stackedInstances:[],stackedConnections:[],documentIdMap:{}};t.forEach(function(t){r=r.concat(t.linkedRefIds),s.stackedReferences=s.stackedReferences.concat(t.stackedObjects.stackedReferences),s.stackedInstances=s.stackedInstances.concat(t.stackedObjects.stackedInstances),s.stackedConnections=s.stackedConnections.concat(t.stackedObjects.stackedConnections),e.merge(s.documentIdMap,t.stackedObjects.documentIdMap)}),o=function(t,n){var i={},o=[];return t.forEach(function(e){i[e.PID]=e}),e.extend(n,i),Object.keys(n).forEach(function(e){o.push(n[e])}),o},n.stackedReferences=o(s.stackedReferences,l),n.stackedInstances=o(s.stackedInstances,d),n.stackedConnections=o(s.stackedConnections,u),e.merge(n.documentIdMap,s.documentIdMap),i(r)}).catch(function(e){"string"==typeof e&&a(e),a("Navigate Error")})})},navigateNodes:function(e,t,n,i){this._getMultipleNavigateOnIndexPromise(e,t,i).then(function(e){n(e)}).catch(function(e){c.error("ERROR: "+e)})},_navigateNodes:function(t,n,i,o){var r=[],s=this;o=o||{},t.length>0?s.navigateOnIndex(t,function(t){e.is(t)&&e.is(t.result,"array")&&s.onNavigatedNodes(t,r,n,!0),i(r)},e.extend(o,{context:this})):i(r)},navigateInverseNodes:function(t,n,i,o){var r=[],s=this,a={stackedReferences:[],stackedInstances:[],stackedConnections:[],documentIdMap:{}};o=o||{},t.length>0?this.navigateInverseOnIndex(t,function(t){var o={referenceIds:new Set,instanceIds:new Set},c={referenceConnectionsMap:{},instanceConnectionsMap:{}},l=new Set;e.is(t)&&e.is(t.result,"array")&&this.onNavigatedNodesV2(t,r,o,c,n,!1),this._getStackedConnectionsFromMap(c.referenceConnectionsMap).forEach(function(e){"DELAsmProcessCanUseCnx"===e.type&&l.add(e.PID)}),this.navigateNodes(Array.from(l),a,function(e){a.stackedConnections.forEach(function(e){s._addConnectionToMap(e.to,e,c.referenceConnectionsMap)}),e.forEach(function(e){o.referenceIds.add(e)}),i(o,c)})},e.extend(o,{context:this})):i(r)},onNavigatedNodes:function(t,n,i,s){var a=t.result,c=this,d=function(t,s,a,d,u){var f,p,m,g,h=a.physicalid;u=u||{},o.isEntityConnection(s.type)&&(o.isEntityReference(a.type)||o.isEntityInstance(a.type)||"SecondaryCandidateResourceLink"===s.type&&o.isEntityConnection(a.type))&&("Document"===a.type&&i.documentIdMap?(i.documentIdMap[t]instanceof Array||(i.documentIdMap[t]=[]),i.documentIdMap[t].push(h)):(s=e.merge(r.translatePredicateToAttribute(s,{type:"entity"}),r.translatePredicateToAttribute(s,{type:"relation"})),d?(s.from=t,s.to=h):(s.from=h,s.to=t),"ProductImplementLinkOcc"===s.type?u.occurencePath&&(d?s.to=u.occurencePath:s.from=u.occurencePath,s.PID="ProductImplementLinkOcc|"+t+"|"+e.Json.encode(u.occurencePath)):"ProcessImplementLinkOcc"===s.type?(e.is(u.owner)&&e.is(u.owner.pathsr)&&(p=c.getPathsFromSR(u.owner.pathsr),e.is(p)&&e.is(p.from)&&(t=f=p.from),e.is(p)&&e.is(p.to)&&(m=p.to)),u.occurencePath&&(d?(s.to=u.occurencePath,e.is(f)&&(s.from=f)):(s.from=u.occurencePath,e.is(m)&&(s.to=m))),s.V_usage=l(s.V_usage)):"DELLmiTimeConstraintCnx"===s.type?e.is(u.owner)&&e.is(u.owner.pathsr)&&(p=c.getPathsFromSR(u.owner.pathsr),e.is(p)&&e.is(p.from)&&(f=p.from),e.is(p)&&e.is(p.to)&&(m=p.to),d?(s.from=f,s.to=m):(s.to=f,s.from=m)):"CapableResourcesStructureLink"!==s.type&&"SystemImplementLink"!==s.type&&"PartialProductImplementLink"!==s.type&&"ProductImplementLink"!==s.type&&"ProcessImplementLink"!==s.type&&"PartialProcessImplementLink"!==s.type||(s.PID=s.type+"|"+s.from+"|"+s.to),i.stackedConnections.push(s),o.isEntityReference(a.type)&&-1===n.indexOf(h)?n.push(h):o.isEntityInstance(a.type)&&!c.collectionUtils.isInstance(h)&&Object.prototype.hasOwnProperty.call(a,"from.physicalid")&&(g=a["from.physicalid"],e.is(g)&&-1===n.indexOf(g)&&n.push(g))))};a.forEach(function(t){var r,a,l,u,f,p,m,g,h,y=t.outputs,v=t.input_object.physicalid;for(g=0,h=i.stackedReferences.length;g<h;g++)if((p=i.stackedReferences[g]).PID===v){s?(p.queriedForConnections=!0,p.queriedForDocuments=!0):p.inverseConnectionsFetched=!0;break}for(g=0,h=i.stackedInstances.length;g<h;g++)if((m=i.stackedInstances[g]).PID===v){s?m.queriedForConnections=!0:m.inverseConnectionsFetched=!0;break}for(r in y)Object.prototype.hasOwnProperty.call(y,r)&&(a=y[r],f=-1===r.indexOf("Inverse"),-1!==r.indexOf("_pathSR")?a.forEach(function(t){var s,a;t&&-1!==r.indexOf("capableResourcesStructure")?(u={type:"CapableResourcesStructureLink"},l=t.elements?t.elements[0]:t,d(v,u,l,f)):e.is(t)&&r.includes("partialScope")?d(v,u={type:"PartialProductImplementLink"},l=t,f):t&&-1!==r.indexOf("HeaderOperationPartialScope")?(u={type:"PartialProcessImplementLink"},l=t.elements?t.elements[0]:t,d(v,u,l,f)):t&&t.elements&&(-1!==r.indexOf("productMbomImplement")?(s=t.elements.map(function(e){return e.physicalid}),a=t.elements[t.elements.length-1],d(v,u={type:"ProductImplementLinkOcc"},a,f,{occurencePath:s})):-1!==r.indexOf("operationProcessImplement")?(s=t.elements.map(function(e){return e.physicalid}),a=t.elements[t.elements.length-1],(u=t.owner).type="ProcessImplementLinkOcc",d(v,u,a,f,{occurencePath:s,owner:t.owner})):-1!==r.indexOf("productFlow")?(s=t.elements.map(function(e){return e.physicalid}),a=t.elements[t.elements.length-1],u=t.owner,d(v,u,a,f,{occurencePath:s,owner:t.owner})):-1!==r.indexOf("Material")?(l=null,t.elements.reverse().some(function(e){var t=!1;return o.isEntityInstance(e.type)&&(l=e,t=!0),t}),e.is(l)&&(u=t.owner,d(v,u,l,f))):(l=t.elements[0],u=t.owner,d(v,u,l,f),"DELAsmProcessCanUseCnx"===l.type&&(u=c.parsePrimaryLinkFromLinkedObj(l,i),n.push(u.from),n.push(u.to))))}):-1!==r.indexOf("_relation")&&a.forEach(function(e){var t,n;-1!==r.indexOf("alternate")?(u=e,l=f?e.to:e.from,delete e["from.physicalid"],delete e["to.physicalid"],d(v,u,l,f)):-1!==r.indexOf("mbomSystemOutput")&&(t=r.split("_relation")[0],n=y[t+"_pathSR"],l=e.from,n&&(n.forEach(function(t){t&&t.elements&&t.elements[0].physicalid===e.to.physicalid&&(u=t.owner)}),u&&d(v,u,l,f)))}))})},onNavigatedNodesV2:function(t,n,i,s,a,c){var d=t.result,u=this,f=function(t,c,d,f,p){var m,g,h,y,v=d.physicalid;p=p||{},o.isEntityConnection(c.type)&&(o.isEntityReference(d.type)||o.isEntityInstance(d.type)||"SecondaryCandidateResourceLink"===c.type&&o.isEntityConnection(d.type))&&("Document"===d.type&&a.documentIdMap?(a.documentIdMap[t]instanceof Array||(a.documentIdMap[t]=[]),a.documentIdMap[t].push(v)):(c=e.merge(r.translatePredicateToAttribute(c,{type:"entity"}),r.translatePredicateToAttribute(c,{type:"relation"})),f?(c.from=t,c.to=v):(c.from=v,c.to=t),"ProductImplementLinkOcc"===c.type?p.occurencePath&&(f?c.to=p.occurencePath:c.from=p.occurencePath,c.PID="ProductImplementLinkOcc|"+t+"|"+e.Json.encode(p.occurencePath)):"ProcessImplementLinkOcc"===c.type?(e.is(p.owner)&&e.is(p.owner.pathsr)&&(g=u.getPathsFromSR(p.owner.pathsr),e.is(g)&&e.is(g.from)&&(t=m=g.from),e.is(g)&&e.is(g.to)&&(h=g.to)),p.occurencePath&&(f?(c.to=p.occurencePath,e.is(m)&&(c.from=m)):(c.from=p.occurencePath,e.is(h)&&(c.to=h))),c.V_usage=l(c.V_usage)):"DELLmiTimeConstraintCnx"===c.type?e.is(p.owner)&&e.is(p.owner.pathsr)&&(g=u.getPathsFromSR(p.owner.pathsr),e.is(g)&&e.is(g.from)&&(m=g.from),e.is(g)&&e.is(g.to)&&(h=g.to),f?(c.from=m,c.to=h):(c.to=m,c.from=h)):"CapableResourcesStructureLink"!==c.type&&"SystemImplementLink"!==c.type&&"PartialProductImplementLink"!==c.type&&"ProductImplementLink"!==c.type&&"ProcessImplementLink"!==c.type&&"PartialProcessImplementLink"!==c.type||(c.PID=c.type+"|"+c.from+"|"+c.to),a.stackedConnections.push(c),"SecondaryCandidateResourceLink"===c.type?u._addConnectionToMap(c.to,c,s.referenceConnectionsMap):o.isEntityReference(d.type)&&-1===n.indexOf(v)?(u._addConnectionToMap(c.to,c,s.referenceConnectionsMap),n.push(v),i.referenceIds.add(v)):o.isEntityInstance(d.type)&&(u._addConnectionToMap(c.to,c,s.instanceConnectionsMap),i.instanceIds.add(v),!u.collectionUtils.isInstance(v)&&Object.prototype.hasOwnProperty.call(d,"from.physicalid")&&(y=d["from.physicalid"],e.is(y)&&-1===n.indexOf(y)&&n.push(y)))))};d.forEach(function(t){var n,r,l,d,p,m,g,h,y,v=t.outputs,P=t.input_object.physicalid;for(h=0,y=a.stackedReferences.length;h<y;h++)if((m=a.stackedReferences[h]).PID===P){c?(m.queriedForConnections=!0,m.queriedForDocuments=!0):m.inverseConnectionsFetched=!0;break}for(h=0,y=a.stackedInstances.length;h<y;h++)if((g=a.stackedInstances[h]).PID===P){c?g.queriedForConnections=!0:g.inverseConnectionsFetched=!0;break}for(n in v)Object.prototype.hasOwnProperty.call(v,n)&&(r=v[n],p=-1===n.indexOf("Inverse"),-1!==n.indexOf("_pathSR")?r.forEach(function(t){var r,c;t&&-1!==n.indexOf("capableResourcesStructure")?f(P,d={type:"CapableResourcesStructureLink"},l=t,p):e.is(t)&&n.includes("partialScope")?f(P,d={type:"PartialProductImplementLink"},l=t,p):t&&-1!==n.indexOf("HeaderOperationPartialScope")?f(P,d={type:"PartialProcessImplementLink"},l=t,p):t&&t.elements&&(-1!==n.indexOf("productMbomImplement")?(r=t.elements.map(function(e){return e.physicalid}),c=t.elements[t.elements.length-1],f(P,d={type:"ProductImplementLinkOcc"},c,p,{occurencePath:r})):-1!==n.indexOf("operationProcessImplement")?(r=t.elements.map(function(e){return e.physicalid}),c=t.elements[t.elements.length-1],(d=t.owner).type="ProcessImplementLinkOcc",f(P,d,c,p,{occurencePath:r,owner:t.owner})):-1!==n.indexOf("productFlow")?(r=t.elements.map(function(e){return e.physicalid}),c=t.elements[t.elements.length-1],d=t.owner,f(P,d,c,p,{occurencePath:r,owner:t.owner})):-1!==n.indexOf("Material")?(l=null,t.elements.reverse().some(function(e){var t=!1;return o.isEntityInstance(e.type)&&(l=e,t=!0),t}),e.is(l)&&(d=t.owner,f(P,d,l,p))):(l=t.elements[0],d=t.owner,f(P,d,l,p),"DELAsmProcessCanUseCnx"===l.type&&(d=u.parsePrimaryLinkFromLinkedObj(l,a),u._addConnectionToMap(d.to,d,s.referenceConnectionsMap),i.referenceIds.add(d.from),i.referenceIds.add(d.to))))}):-1!==n.indexOf("_relation")&&r.forEach(function(e){var t,i;-1!==n.indexOf("alternate")?(d=e,l=p?e.to:e.from,delete e["from.physicalid"],delete e["to.physicalid"],f(P,d,l,p)):-1!==n.indexOf("mbomSystemOutput")&&(t=n.split("_relation")[0],i=v[t+"_pathSR"],l=e.from,i&&(i.forEach(function(t){t&&t.elements&&t.elements[0].physicalid===e.to.physicalid&&(d=t.owner)}),d&&f(P,d,l,p)))}))})},parsePrimaryLinkFromLinkedObj:function(t,n){var i,o,s;return i={type:{name:"type",value:t.type},pathsr:{name:"pathsr",value:t.pathsr}},o=this.pathSRParser.parse(i,{type:i.type.value,isRefRef:!0}),(s=e.merge(r.translatePredicateToAttribute(t,{type:"entity"}),r.translatePredicateToAttribute(t,{type:"relation"}))).from=o.from,s.to=o.to,e.is(n)&&e.is(n.stackedConnections,"array")&&n.stackedConnections.push(s),s},expandOnIndex:function(t,n,o){var s,c,l,d,u,f=i.get3DSpaceUrl()+"cvservlet/expand",p=this.getSelectPredicate("entity"),m=this.getSelectPredicate("relation"),g=this.getSelectUnit(p),h=this._selectFacet,y=this._computeBo,v=["union","intersection","minus"];if(o=o||{},e.is(o.selectBo,"array")&&(p=o.selectBo),e.is(o.selectRel,"array")&&(m=o.selectRel),e.is(o.selectFacets,"array")&&(h=o.selectFacets),e.is(o.computeBo,"array")&&(y=o.computeBo),e.is(o.filterQuery,"object")&&(s=o.filterQuery),c={label:a.getCVServletLabel(),select_bo:p,select_rel:m,select_ds6w_facet:h,compute_select_bo:y,locale:widget.locale,lang:widget.lang,select_unit:g},l=["MfgProcessAlternate","Alternate"],e.is(s)){for(d in e.merge(c,s),s)if(Object.prototype.hasOwnProperty.call(s,d)&&-1!==v.indexOf(d)&&(u=s[d].expand,e.is(u,"array"))){u.forEach(function(e){e.no_type_filter_rel=l});break}f=i.get3DSpaceUrl()+"cvservlet/multiexpand"}else t instanceof Array?c.multi_root_physicalid=t:c.root_physicalid=t,e.is(o.expandIter,"string")&&(c.expand_iter=o.expandIter),c.no_type_filter_rel=l;c=e.Json.encode(c),i.webServiceRequest({url:f,method:"POST",headers:i.getHeaders({isJsonOnly:!0}),data:c,onComplete:function(e){var t;n instanceof Function&&(t=r.parseNavigateResult(e),n.call(o.context,t))},onFailure:function(e){o.onFailure instanceof Function&&o.onFailure.call(o.context,e)}})},expandOnIndexV2:function(t,n,o){var s,c,l,d,u,f,p=i.get3DSpaceUrl()+"cvservlet/expand",m=this.getSelectPredicate("entity"),g=this.getSelectPredicate("relation"),h=this.getSelectUnit(m,{type:"entity"}),y=this.getSelectUnit(g,{type:"relation"}),v=this._selectFacet,P=this._computeBo,I=["union","intersection","minus"];if(h=e.merge(h,y),o=o||{},e.is(o.selectBo,"array")&&(m=o.selectBo),e.is(o.selectRel,"array")&&(g=o.selectRel),e.is(o.selectFacets,"array")&&(v=o.selectFacets),e.is(o.computeBo,"array")&&(P=o.computeBo),e.is(o.filterQuery,"object")&&(s=o.filterQuery),m.push("pathsr"),g.push("pathsr"),c={label:a.getCVServletLabel(),select_bo:m,select_rel:g,select_ds6w_facet:v,compute_select_bo:P,locale:widget.locale,lang:widget.lang,select_unit:h},l=[],d=["VPMCfgEffectivity"],e.is(o.excludeBOTypes,"array")?d.forEach(function(e){-1===o.excludeBOTypes.indexOf(e)&&o.excludeBOTypes.push(e)}):o.excludeBOTypes=d,e.is(s)){for(u in e.merge(c,s),s)if(Object.prototype.hasOwnProperty.call(s,u)&&-1!==I.indexOf(u)&&(f=s[u].expand,Array.isArray(f))){f.forEach(function(t){t.no_type_filter_rel=l,e.is(o.excludeBOTypes,"array")&&(t.no_type_filter_bo=o.excludeBOTypes)});break}p=i.get3DSpaceUrl()+"cvservlet/multiexpand"}else t instanceof Array?c.multi_root_physicalid=t:c.root_physicalid=t,e.is(o.expandIter,"string")&&(c.expand_iter=o.expandIter),e.is(o.excludeBOTypes,"array")&&(c.no_type_filter_bo=o.excludeBOTypes),c.no_type_filter_rel=l;c=e.Json.encode(c),i.webServiceRequest({url:p,method:"POST",headers:i.getHeaders({isJsonOnly:!0}),data:c,onComplete:function(e){var t;n instanceof Function&&(t=r.parseNavigateResult(e),n.call(o.context,t))},onFailure:function(e){o.onFailure instanceof Function&&o.onFailure.call(o.context,e)}})},expandNodes:function(t,n,i,o){var r,s,l,d,u=this,f=[];o=o||{},r=e.is(o.context)?o.context:this,s=isNaN(o.expandLevel)?a.getPrefExpandLevel():o.expandLevel,l=e.is(o.filterQuery)?o.filterQuery:null,d=function(t){e.is(t,"array")?u.onExpandedNodes(t,f,n,s,l):c.debug("ERROR in expand result"),i.call(r,f)},t.length>0?u.expandOnIndex(t,d,e.extend(o,{context:u,expandIter:s.toString()})):i.call(r,f)},onExpandedNodes:function(t,n,i,s,a,c){var l,d=this;isNaN(c)&&(c=0),(-1===s||c<=s)&&Array.isArray(t)&&t.forEach(function(t){var u,f=r.translatePredicateToAttribute(t,{type:"entity",fromExpandService:!0});(-1===s||c<s)&&(e.is(a)||(f.queriedForChildren=!0)),n.push(f.PID),i.stackedReferences.push(f),t.getChildren().forEach(function(t){(l=t.getChildren().filter(function(e){return o.isEntityReference(e.type.value)&&"MfgProcessAlternate"!==t.type.value})).length>0&&(u=r.translatePredicateToAttribute(t,{type:"relation",fromExpandService:!0}),e.is(a)&&(u.filterQuery=a),n.push(u.PID),i.stackedInstances.push(u),d.onExpandedNodes(l,n,i,s,a,c+1))})})},expandPromise:function(t,n,i){var o=this,r=i||{};return new Promise(function(i,s){var l,d,u,f=!1,p={referenceIds:new Set,instanceIds:new Set},m={referenceConnectionsMap:{},instanceConnectionsMap:{}};l=isNaN(r.expandLevel)?a.getPrefExpandLevel():r.expandLevel,d=e.is(r.filterQuery)?r.filterQuery:null,u=function(t){var r=function(t,n){var i,o,r;if(n.size>0)for(o=0,r=t.length;o<r;o++)i=t[o].PID,e.is(i)&&n.has(i)&&n.delete(i)};e.is(t,"array")?(Object.prototype.hasOwnProperty.call(n,"ioPortToPlmPortMap")||(n.ioPortToPlmPortMap=new Map),o.onExpandedNodesV2Recursive(t,p,m,n,l,d,f),e.is(n.deferredConnections)&&(n.deferredConnections.forEach(function(t){var i=n.ioPortToPlmPortMap.get(t.idToResolve);e.is(i)&&(t.from=i["from.physicalid"].value,delete t.idToResolve,o._addConnectionToMap(t.to,t,m.referenceConnectionsMap),p.referenceIds.add(t.to))}),delete n.deferredConnections),n.ioPortToPlmPortMap.clear(),delete n.ioPortToPlmPortMap,r(n.stackedReferences,p.referenceIds),r(n.stackedInstances,p.instanceIds),i({linkedObjIds:p,stackedObjects:n,connectionsMap:m})):(c.debug("ERROR in expand result"),s("ERROR in expand result"))},t.length>0?(l>-1&&(f=!0,l+=1),o.expandOnIndexV2(t,u,e.extend(r,{context:o,expandIter:l.toString()}))):i({linkedObjIds:p,stackedObjects:n})})},_addConnectedObjIdsToLinkedObj:function(e,t){Array.isArray(e)?e.forEach(function(e){t.add(e)}):t.add(e)},_addConnectionToMap:function(e,t,n){var i,o;o=n[i=Array.isArray(e)?e.toString():e],Array.isArray(o)?o.some(function(e){return e.PID===t.PID})||(n[i]=o.concat(t)):n[i]=[t]},onExpandedNodesV2Recursive:function(t,n,i,s,a,c,d,u){var f,p,m,g,h=this;isNaN(u)&&(u=0),d&&u===a||(m=d&&u===a-1||u===a,p=f=d&&u>=a-1,(-1===a||u<=a)&&Array.isArray(t)&&t.forEach(function(t){var y,v;if(e.is(t.pathsr)){["CapableResourcesStructureLink","PartialProductImplementLink","PartialProcessImplementLink"].forEach(function(o){const r=h.pathSRParser.parse(t,{isRefRef:!0,type:o});e.is(r)&&(h._addConnectedObjIdsToLinkedObj(r.to,n.referenceIds),h._addConnectionToMap(r.to,r,i.referenceConnectionsMap))})}y=r.translatePredicateToAttribute(t,{type:"entity",fromExpandService:!0}),-1!==a&&m||e.is(c)||(y.queriedForChildren=!0),y.directConnectionsFetched=!0,y.queriedForDocuments=!0,s.stackedReferences.push(y),t.getChildren().forEach(function(m){var y,P,I,_=[],S=[];if("MfgProcessAlternate"===m.type.value)I=r.translatePredicateToAttribute(m,{type:"entity",fromExpandService:!0}),(I=e.merge(I,r.translatePredicateToAttribute(m,{type:"relation",fromExpandService:!0}))).from=m["from.physicalid"].value,I.to=m["to.physicalid"].value,h._addConnectedObjIdsToLinkedObj(I.to,n.referenceIds),h._addConnectionToMap(I.to,I,i.referenceConnectionsMap);else if(o.isEntityConnection(m.type.value))S.push(m);else if("SpecificationDocument"===m.type.value||"Reference Document"===m.type.value){const e=m["to.physicalid"].value,t=m["from.physicalid"].value;s.documentIdMap[t]instanceof Array||(s.documentIdMap[t]=[]),s.documentIdMap[t].push({PID:e,type:m.type.value}),g=!0}m.getChildren().forEach(function(e){o.isEntityReference(e.type.value)?"MfgProcessAlternate"!==m.type.value&&"SpecificationDocument"!==m.type.value&&"Reference Document"!==m.type.value&&_.push(e):o.isEntityConnection(e.type.value)?S.push(e):"DELLmiProdSystemIOPort"===e.type.value&&s.ioPortToPlmPortMap.set(e.physicalid.value,m)}),S.forEach(function(o){var a,c,d,u=!1;y=h.pathSRParser.parse(o,{type:o.type.value,isRefRef:!0,referenceEntity:t,ioPortToPlmPortMap:s.ioPortToPlmPortMap}),e.is(y)&&(!p||y.isRefRef)&&(a=r.translatePredicateToAttribute(o,{type:"entity",fromExpandService:!0}),a=e.merge(a,r.translatePredicateToAttribute(a,{type:"relation"})),e.is(y.type)&&(a.type=y.type),e.is(y.PID)&&(a.PID=y.PID),e.is(y.from)&&(a.from=y.from),e.is(y.to)&&(a.to=y.to),"PLMDocConnection"===y.type?(c=a.to,d=a.from,s.documentIdMap[d]instanceof Array||(s.documentIdMap[d]=[]),s.documentIdMap[d].push({PID:c,type:"PLMDocConnection"}),g=!0):"ProcessImplementLinkOcc"===y.type?a.V_usage=l(a.V_usage):"DELLmiTimeConstraintCnx"===y.type&&(a.flowType=y.flowType||""),e.is(y.deferResolution,"boolean")&&y.deferResolution&&(u=!0,a.idToResolve=y.idToResolve,Object.prototype.hasOwnProperty.call(s,"deferredConnections")||(s.deferredConnections=[]),s.deferredConnections.push(a)),g||u||(y.isRefRef?(h._addConnectedObjIdsToLinkedObj(a.to,n.referenceIds),h._addConnectionToMap(a.to,a,i.referenceConnectionsMap)):(h._addConnectedObjIdsToLinkedObj(a.to,n.instanceIds),h._addConnectionToMap(a.to,a,i.instanceConnectionsMap))))}),_.length>0&&(o.isEntityConnection(m.type.value)||(f||(e.is(m.pathsr)&&(P=h.pathSRParser.parse(m,{isRefRef:!1}),e.is(P)&&(h._addConnectedObjIdsToLinkedObj(P.to,n.instanceIds),h._addConnectionToMap(P.to,P,i.instanceConnectionsMap))),v=r.translatePredicateToAttribute(m,{type:"relation",fromExpandService:!0}),e.is(c)&&(v.filterQuery=c),v.directConnectionsFetched=!0,s.stackedInstances.push(v)),h.onExpandedNodesV2Recursive(_,n,i,s,a,c,d,u+1)))})}))},findMissingLinkedObjects:function(t,n){var i,o=this,r={referencesPID:[t],instancesPID:[]},s={stackedReferences:[],stackedInstances:[],stackedConnections:[],documentIdMap:{}};o.collectionUtils.expandOnBackbone(t,r),r.referencesPID.forEach(function(t){var n,i=o.collectionUtils.getReferenceFromCollection(t);e.is(i)&&(n=i.pick("PID"),s.stackedReferences.push(n))}),r.instancesPID.forEach(function(t){var n,i=o.collectionUtils.getInstanceFromCollection(t);e.is(i)&&(n=i.pick("PID"),s.stackedInstances.push(n))}),i=o.collectionUtils._removeDuplicate(r.referencesPID.slice().concat(r.instancesPID.slice())),o.navigateNodes(i,s,function(e){o.expandNodes(e,s,function(){o._addToCollections(s,n)},n)})},getDescendants:function(e,t){var n=this,i={stackedReferences:[],stackedInstances:[],stackedConnections:[],documentIdMap:{}};t=t||{},e instanceof Array||(e=[e]),this.expandNodes(e,i,function(e){n.navigateNodes(e,i,function(e){n.expandNodes(e,i,function(){n._addToCollections(i,t)},t)},t)},t)},getDescendantsV2:function(t,n){var i,o,r,s,a,l=this,d=n||{},u=e.is(d.callback,"function")?d.callback:null;t instanceof Array||(t=[t]),i={stackedReferences:[],stackedInstances:[],stackedConnections:[],documentIdMap:{}},l.expandPromise(t,i,d).then(function(e){var t;return r=e.connectionsMap.instanceConnectionsMap,o=e.connectionsMap.referenceConnectionsMap,s=l._addToCollectionPromise(e.stackedObjects,null,d),t={stackedReferences:[],stackedInstances:[],stackedConnections:[],documentIdMap:{}},l._fetchConnectedInstancesPromise(e.linkedObjIds,r,t)}).then(function(e){var t;return a=s.then(function(t){return e.stackedObjects.stackedConnections=l._getStackedConnectionsFromMap(r),l._addToCollectionPromise(e.stackedObjects,t,d)}),t={stackedReferences:[],stackedInstances:[],stackedConnections:[],documentIdMap:{}},l._fetchConnectedReferencesPromise(e.referenceIds,o,t)}).then(function(e){a.then(function(t){return e.stackedConnections=l._getStackedConnectionsFromMap(o),l._addToCollectionPromise(e,t,d)}).then(function(e){u.call(d.context,e)})}).catch(function(e){c.debug("getDescendants:- failed : "+e)})},_fetchConnectedInstancesPromise:function(t,n,i){var o=this,r=t.referenceIds;return new Promise(function(s,a){var c=[];t.instanceIds.forEach(function(e){c.push(e)}),c.length>0?o.fetchMultipleOnIndexPromise(c,{type:"relation",silent:!0,withSynthesisAttribute:!1,chunkSize:o.FETCH_CHUNK_SIZE}).then(function(o){var a,l,d,u=null;for(c.length!==o.length&&(u=new Set(t.instanceIds)),a=0,l=o.length;a<l;a++)d=o[a].attributes,i.stackedInstances.push(d),d.isInstanceOf&&r.add(d.isInstanceOf),null!==u&&u.delete(d.PID);e.is(u)&&u.size>0&&u.forEach(function(e){Object.keys(n).forEach(function(t){t.indexOf(e)>-1&&delete n[t]})}),s({referenceIds:r,stackedObjects:i})}).catch(function(){a()}):s({referenceIds:r,stackedObjects:i})})},_fetchConnectedReferencesPromise:function(t,n,i){var o=this;return new Promise(function(r,s){var a=[];t.forEach(function(e){a.push(e)}),a.length>0?o.fetchMultipleOnIndexPromise(a,{type:"entity",silent:!0,withSynthesisAttribute:!1,chunkSize:o.FETCH_CHUNK_SIZE}).then(function(o){var s,c,l,d=null;for(a.length!==o.length&&(d=new Set(t)),s=0,c=o.length;s<c;s++)l=o[s].attributes,i.stackedReferences.push(l),null!==d&&d.delete(l.PID);e.is(d)&&d.size>0&&d.forEach(function(e){delete n[e]}),r(i)}).catch(function(){s()}):r(i)})},_getStackedConnectionsFromMap:function(e){var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n=n.concat(e[t]));return n},_mergeCallbackResult:function(t,n){var i,o={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&(Array.isArray(t[i])?o[i]=t[i].concat(n[i]):e.is(t[i],"object")&&(o[i]={},e.merge(o[i],t[i]),e.merge(o[i],n[i])));return o},_addToCollectionPromise:function(t,n,i){var o=this;return new Promise(function(r){i.callback=function(t){var i;i=e.is(n)?o._mergeCallbackResult(n,t):t,r(i)},o._addToCollections(t,i)})},fetchMultipleOnIndexPromise:function(t,n){var i=this,o=n||{},r=e.is(o.type)?o.type:"entity",s=!e.is(o.silent,"boolean")||o.silent,a=e.is(o.chunkSize)?o.chunkSize:i.FETCH_CHUNK_SIZE,c=!e.is(o.withSynthesisAttribute,"boolean")||o.withSynthesisAttribute,l=e.is(o.select_predicate)?o.select_predicate:null;return new Promise(function(e,n){var o;o=i.splitIntoChunks(t,a).map(function(e){return new Promise(function(t,n){i.fetchOnIndex(e,{type:r,withSynthesisAttribute:c,select_predicate:l,silent:s,onComplete:function(e){var n=Array.isArray(e)?e:[e];t(n)},onFailure:function(){n()},context:i})})}),Promise.all(o).then(function(t){var n;n=t.reduce(function(e,t){return e.concat(t)},[]),e(n)}).catch(function(){n()})})},findMissingObj:function(t,n){var i=t.get("from"),o=t.get("to"),r=t.get("type"),s=!0,a=this,c=function(t,i){e.is(t,"array")?t.forEach(function(t){e.is(t,"string")&&!a.collectionUtils.isInstance(t)&&n.missingInstanceObjects.push(t)}):e.is(t,"string")&&(i?a.collectionUtils.isReference(t)||n.missingReferenceObjects.push(t):a.collectionUtils.isInstance(t)||n.missingInstanceObjects.push(t))};"ProductImplementLinkOcc"!==r&&"DELLmiTimeConstraintCnx"!==r&&"DELLmiMaterialPathCnxCust"!==r||(s=!1),"SecondaryCandidateResourceLink"!==r&&c(i,s),c(o,s)},fetchMissingObjects:function(t,n){var i,o,r,s=n||{},a={stackedReferences:[],stackedInstances:[]},l=this,d=parseInt(widget.getValue("navigateFetchSplitSize"));r=function(t,n){var i=function(t){var n=e.is(t.attributes)?t.attributes:t;e.is(t.ds6w)&&(n.ds6w=t.ds6w),a.stackedReferences.push(n)};e.is(n)&&(e.is(n,"array")?n.forEach(i):i(n)),t(a)},o=function(){return new Promise(function(e){t.missingReferenceObjects.length>0?(t.missingReferenceObjects=l.collectionUtils._removeDuplicate(t.missingReferenceObjects),l.fetchMultipleOnIndexPromise(t.missingReferenceObjects,{chunkSize:d}).then(function(t){r(e,t)})):r(e)})},i=function(n,i){var o=function(n){var i=e.is(n.attributes)?n.attributes:n;e.is(n.ds6w)&&(i.ds6w=n.ds6w),a.stackedInstances.push(i),e.is(i.isInstanceOf,"string")&&""!==i.isInstanceOf&&(l.collectionUtils.isReference(i.isInstanceOf)||t.missingReferenceObjects.push(i.isInstanceOf))};e.is(i)&&(e.is(i,"array")?i.forEach(o):o(i)),n()},function(){return new Promise(function(e){t.missingInstanceObjects.length>0?(t.missingInstanceObjects=l.collectionUtils._removeDuplicate(t.missingInstanceObjects),l.fetchMultipleOnIndexPromise(t.missingInstanceObjects,{type:"relation",chunkSize:d}).then(function(t){i(e,t)})):i(e)})}().then(o).then(function(e){l._addToCollections(e,s)}).catch(function(e){c.error("NavigateOnIndex.fetchMissingObjects : FAILURE in bring back missing objects "+e)})},getConnectionsByModel:function(t,n,i,o,r){var s=this,a=[],c=[],l=e.is(t)?t.get("PID"):null,d=e.is(n)?n.get("PID"):null,u={stackedReferences:[],stackedInstances:[],stackedConnections:[],documentIdMap:{}},f={documentIdMap:u.documentIdMap},p=function(){var t=[],n={missingInstanceObjects:[],missingReferenceObjects:[]},a={callback:function(){e.is(r,"function")&&r(t)}};t=s.collectionUtils.getImpactedConnections(l,d,{relationTypes:i,isRefRefOnly:o}),e.is(t,"array")&&t.forEach(function(e){s.findMissingObj(e,n)}),s.fetchMissingObjects(n,a)},m=function(){var i={queriedForConnections:!0},o={callback:function(){e.is(t)&&t.setAdditionalInfo(i),e.is(n)&&n.setAdditionalInfo(i),p()}};s._addToCollections(u,o)};e.is(l)&&s.collectionUtils.needToQueryForConnections(s.collectionUtils.references,t)&&(s.collectionUtils.needToQueryForDirectConnections(s.collectionUtils.references,t)?a.push(l):s.collectionUtils.needToQueryForInverseConnections(s.collectionUtils.references,t)&&c.push(l)),e.is(d)&&s.collectionUtils.needToQueryForConnections(s.collectionUtils.instances,n)&&(s.collectionUtils.needToQueryForDirectConnections(s.collectionUtils.instances,n)?a.push(d):s.collectionUtils.needToQueryForInverseConnections(s.collectionUtils.instances,n)&&c.push(d)),a.length>0&&c.length>0?s.navigateNodes(a.concat(c),u,m,f):a.length>0?s.navigateNodes(a,u,m,f):c.length>0?s.navigateInverseNodes(c,u,m,f):p()},getInverseConnections:function(t,n){var i,o,r=this,s=n||{};i=r.splitIntoChunks(t,1e3).map(function(e){return new Promise(function(t,n){var i={stackedReferences:[],stackedInstances:[],stackedConnections:[],documentIdMap:{}},o={onFailure:function(e){n(e)}};r.navigateInverseNodes(e,i,function(n,o){i.stackedConnections=[],e.forEach(function(e){(r.collectionUtils.getInstanceFromCollection(e)||r.collectionUtils.getReferenceFromCollection(e)).setAdditionalInfo({queriedForConnections:!0})}),t({linkedObjIds:n,connectionsMap:o})},o)})}),Promise.all(i).then(function(t){return new Promise(function(n){var i={referenceIds:new Set,instanceIds:new Set},o={referenceConnectionsMap:{},instanceConnectionsMap:{}};t.forEach(function(t){t.linkedObjIds.referenceIds.forEach(function(e){i.referenceIds.add(e)}),t.linkedObjIds.instanceIds.forEach(function(e){i.instanceIds.add(e)}),e.merge(o.referenceConnectionsMap,t.connectionsMap.referenceConnectionsMap),e.merge(o.instanceConnectionsMap,t.connectionsMap.instanceConnectionsMap)}),n({linkedObjIds:i,connectionsMap:o})})}).catch(function(t){e.is(s.onFailure,"function")&&s.onFailure(t)}).then(function(e){var t,n,i=e.connectionsMap.instanceConnectionsMap,a=e.connectionsMap.referenceConnectionsMap;e.linkedObjIds.referenceIds.size>0||e.linkedObjIds.instanceIds.size>0?(t={stackedReferences:[],stackedInstances:[],stackedConnections:[],documentIdMap:{}},n={referenceIds:new Set,instanceIds:new Set},e.linkedObjIds.referenceIds.forEach(function(e){r.collectionUtils.isReference(e)||n.referenceIds.add(e)}),e.linkedObjIds.instanceIds.forEach(function(e){r.collectionUtils.isInstance(e)||n.instanceIds.add(e)}),r._fetchConnectedInstancesPromise(n,i,t).then(function(e){var t;return e.stackedObjects.stackedConnections=r._getStackedConnectionsFromMap(i),o=r._addToCollectionPromise(e.stackedObjects,null,s),t={stackedReferences:[],stackedInstances:[],stackedConnections:[],documentIdMap:{}},r._fetchConnectedReferencesPromise(e.referenceIds,a,t)}).then(function(e){o.then(function(t){return e.stackedConnections=r._getStackedConnectionsFromMap(a),r._addToCollectionPromise(e,t,s)}).then(function(){s.onComplete()})})):((t={stackedReferences:[],stackedInstances:[],stackedConnections:[],documentIdMap:{}}).stackedConnections=r._getStackedConnectionsFromMap(a),r._addToCollectionPromise(t,null,s).then(function(){s.onComplete(e.stackedConnections)}))}).catch(function(t){e.is(s.onFailure,"function")&&s.onFailure(t)})},getPathsFromSR:function(t){var n,i,o,r,s=null;return n=t.indexOf(" PS "),n+=4,i=t.indexOf(" PE "),-1===n||-1===i?(c.log("Error parsing fromOcc from attribute pathSR: "+t),null):(o=t.substring(n,i).split(" "),n=t.indexOf(" PS ",n),n+=4,i=t.indexOf(" PE",i+4),-1===n||-1===i?(c.log("Error parsing toOcc from attribute pathSR: "+t),null):(r=t.substring(n,i).split(" "),e.is(o)&&e.is(r)&&(s={from:o,to:r}),s))},_getAltSubContextMfgRelations:function(t){var n=this;return new Promise(function(o,r){var s,c,l,d=i.get3DSpaceUrl()+"cvservlet/navigate?SecurityContext="+i.getSecurityContext(),u=[],f={},p=n.getSelectPredicate("entity").concat(n.getSelectPredicate("relation"));for(s=p.length;s--;)f[l=p[s]]||(u.unshift(l),f[l]=!0);t instanceof Array||(t=[t]),u.push("pathsr"),c={label:a.getCVServletLabel(),input_physical_ids:t,primitives:[{navigate_to_rel:{id:1,filter:{bo_type:["DELFmiProcessOutputPrereqMaterializationCnx"]}},navigate_to_sr:{id:2,filter:{role:["51"],category:["5"]},mode:"path"}}],patterns:{resProd_relation:[{id:1}],productMbomImplement_pathSR:[{id:2}]},attributes:u,fileAttributes:[],version:3},c=e.Json.encode(c),i.webServiceRequest({url:d,method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},data:c,onComplete:function(e){o(e)},onFailure:function(e,t){r(t)}})})},_getAltSubContextProducts:function(t){var n,i=this,o=function(e,t){var n,o,r=null;return(n=e.filter(function(e){var t=e["ds6w:kind"];return t.includes("EIN")||t.includes("3D-EIN")}).map(function(e){return e.pathsr})).length>0&&(o={pathsr:{value:n=n[0]}},r={referenceId:i.pathSRParser.parse(o,{type:"DELFmiProcessOutputPrereqMaterializationCnx",isRefRef:!0,referenceEntity:{physicalid:{value:t}}}).to,instanceId:null}),r},r=function(e){var t,n=null;return(t=e.map(function(e){var t=e.elements;return t[t.length-1]})).length>0&&(n={referenceId:(t=t[0])["to.physicalid"],instanceId:t.physicalid}),n};return n=t.reduce(function(t,n){var i=n.referenceId,o=n.instanceId;return e.is(i)&&t.push(i),e.is(o)&&t.push(o),t},[]),new Promise(function(s,a){i._getAltSubContextMfgRelations(n).then(function(n){var i,a,c,l={};i=function(t){var n=t.result,i=new Map,s=new Map;return n.forEach(function(t){var n,a,c,l,d=t.outputs,u=t.input_object.physicalid;for(n in d)Object.prototype.hasOwnProperty.call(d,n)&&(a=d[n],"resProd_relation"===n?(c=o(a,u),e.is(c)&&i.set(u,c)):"productMbomImplement_pathSR"===n&&(l=r(a),e.is(l)&&s.set(u,l)))}),{resultingProductsMap:i,implementedProductsMap:s}}(n),a=i.resultingProductsMap,c=i.implementedProductsMap,t.forEach(function(t){var n=t.referenceId,i=t.instanceId;e.is(n)&&a.has(n)?l[n]=a.get(n):e.is(i)&&c.has(i)&&(l[i]=c.get(i))}),s(l)}).catch(function(e){c.log(e),a(e)})})},getMultipleAltSubContextProductsPromise:function(t){var n=this;return new Promise(function(i,o){var r;r=n.splitIntoChunks(t,25).map(function(e){return n._getAltSubContextProducts(e)}),Promise.all(r).then(function(t){var n;n=t.reduce(function(t,n){return e.merge(t,n)},{}),i(n)}).catch(function(e){o(e)})})}})}),define("DS/DELPPWNavigationServices/NavigateOnDB",["UWA/Core","UWA/Promise","DS/DELPPWNavigationServices/NavigationBase","DS/DELPPWWebServices/WebserviceUtils","DS/DELPPWModelParsers/ConnectionParser","DS/DELPPWModelServices/ModelUtils","DS/DELPPWLoggerModel/LoggerUtils","DS/DELPPWIndexServices/IndexParser"],function(e,t,n,i,o,r,s,a){"use strict";return n.extend({init:function(e){e=e||{},this._parent(e)},_getDescendants:function(t,n,o,s){var a,c,l,d,u=this;s=s||{},c=isNaN(s.expandLevel)?r.getPrefExpandLevel():s.expandLevel,d={pid:Array.isArray(t)?null:t,expandLevel:c,ordered:!e.is(s)||(!e.is(s.ordered,"boolean")||s.ordered)},l=e.is(s.context)?s.context:this,(a={url:"dsmfg/private/V0/invoke/getDescendants",method:"POST",onComplete:function(e){u.onGetDescendants(e,n,c,s,t),o.call(l)}}).data=e.Json.encode(d),e.is(s.onFailure,"function")&&(a.onFailure=s.onFailure),e.is(s.onTimeout,"function")&&(a.onTimeout=s.onTimeout),e.is(s.onCancel,"function")&&(a.onCancel=s.onCancel),i.webServiceRequest(a)},onGetDescendants:function(t,n,i,o,r){var s=-1===i,a=Array.isArray(r)?r:[r],c=e.clone(a);t.forEach(function(e){var t=e.attributesValue;Object.prototype.hasOwnProperty.call(t,"isInstanceOf")?(n.stackedInstances.push(e),2===i&&a.indexOf(t.isAggregatedBy)>-1&&c.push(t.isInstanceOf)):(e.queriedForChildren=s,n.stackedReferences.push(e))}),2===i&&n.stackedReferences.forEach(function(e){c.indexOf(e.attributesValue.PID)>-1&&(e.queriedForChildren=!0)})},_getDescendantsAndLinks:function(t,n,o,s){var a,c,l,d=this,u=[],f={};s=s||{},f={expandLevel:l=isNaN(s.expandLevel)?r.getPrefExpandLevel():s.expandLevel,ordered:!e.is(s)||(!e.is(s.ordered,"boolean")||s.ordered),fetchInverseRelations:!!e.is(s)&&(!!e.is(s.fetchInverseRelations,"boolean")&&s.fetchInverseRelations)},e.is(s.gridIDs)&&Array.isArray(s.gridIDs)&&(f.gridIDs=s.gridIDs),e.is(s.filterQuery)&&(f.cfgFilter=s.filterQuery),c=e.is(s.context)?s.context:this,a={method:"POST",onComplete:function(e){Array.isArray(e)?e.forEach(function(e){d.onGetDescendantsAndLinks(e,u,n,l,s,t)}):d.onGetDescendantsAndLinks(e,u,n,l,s,t),o.call(c,u)}},Array.isArray(t)&&t.length>1?(f.pidArray=t,a.url="dsmfg/private/V0/invoke/getMultipleDescendantsAndLinks"):(a.url="dsmfg/private/V0/invoke/getDescendantsAndLinks",f.pid=Array.isArray(t)?t[0]:t),a.data=e.Json.encode(f),e.is(s.onFailure,"function")&&(a.onFailure=s.onFailure),e.is(s.onTimeout,"function")&&(a.onTimeout=s.onTimeout),e.is(s.onCancel,"function")&&(a.onCancel=s.onCancel),i.webServiceRequest(a)},onGetDescendantsAndLinks:function(t,n,i,r,s,a){var c=e.is(s.withLinksResolved,"boolean")?s.withLinksResolved?n:null:n,l=-1===r,d=!0,u=Array.isArray(a)?a:[a],f=e.clone(u);i.documentIdMap=e.merge(i.documentIdMap,t.documents),Array.isArray(s.gridIDs)&&s.gridIDs.length>0&&(d=!1),e.is(t.instancesAndReferences)&&(t.instancesAndReferences.forEach(function(t){var n=t.attributesValue;Object.prototype.hasOwnProperty.call(n,"isInstanceOf")?(t.queriedForConnections=d,e.is(s.filterQuery)&&(t.filterQuery=s.filterQuery),i.stackedInstances.push(t),2===r&&u.indexOf(n.isAggregatedBy)>-1&&f.push(n.isInstanceOf)):(t.queriedForChildren=l,t.queriedForConnections=d,i.stackedReferences.push(t))}),2===r&&i.stackedReferences.forEach(function(e){f.indexOf(e.attributesValue.PID)>-1&&(e.queriedForChildren=!0)})),t.connections.forEach(function(e){o.parse(e,i,c)})},getDescendants:function(t,n){var i=this,o={},r=n.stackedObjects||{stackedReferences:[],stackedInstances:[],stackedConnections:[],documentIdMap:{}};n=n||{},e.is(n.silentMode)&&(o={silent:!0}),e.is(n.withLinks,"boolean")&&n.withLinks?i._getDescendantsAndLinks(t,r,function(t){(t=Array.from(new Set(t))).length>0?(e.is(n)&&(n.withLinksResolved=!1),n.stackedObjects=r,i.getDescendants(t,n)):(n=e.merge(n,o),i._addToCollections(r,n))},n):i._getDescendants(t,r,function(){n=e.merge(n,o),i._addToCollections(r,n)},n)},getConnectionsByModel:function(t,n,i,o,r){var s,a,c=this,l=e.is(r,"function"),d=e.is(t)?t.id:null,u=e.is(n)?n.id:null;s={relationTypes:i,isRefRefOnly:o,onComplete:function(){a=c.collectionUtils.getImpactedConnections(d,u,s),l&&r(a)},onFailure:function(){l&&r(a)}},c.fetchConnections(d,u,s)},fetchConnections:function(t,n,o,r){var c,l,d,u,f,p,m=this,g=[];o=o||{},d=m.collectionUtils.needToQueryForConnections(m.collectionUtils.references,t)?t:null,u=m.collectionUtils.needToQueryForConnections(m.collectionUtils.instances,n)?n:null,r=!!e.is(r)&&r,e.is(d)||e.is(u)||r?(f=!!e.is(o.isRefRefOnly)&&o.isRefRefOnly,p=e.is(o.relationTypes,"array")?o.relationTypes:[],m.collectionUtils.connections.fetch({data:{parentPID:t,instancePID:n,gridIDs:e.Json.encode(p)},headers:i.getHeaders({serviceName:"3DSpace"}),wait:!0,remove:!1,onComplete:function(i,d){var u;e.is(t)&&!f&&(c=m.collectionUtils.getReferenceFromCollection(t),e.is(c)?("PART"===c.get("PPRTYPE")&&(u=a.translatePredicateToAttribute(c._attributes,{type:"entity"}),c.set(u)),c.setAdditionalInfo({queriedForConnections:!0})):s.debug(m.name,"could not get reference pid %s",t)),e.is(n)&&!f&&(l=m.collectionUtils.getInstanceFromCollection(n),e.is(l)&&l.setAdditionalInfo({queriedForConnections:!0})),e.is(o.onComplete,"function")&&(r?(e.is(d,"array")&&d.forEach(function(n){var i=n["from.attributesValue"],o=n["to.attributesValue"];e.is(i)&&e.is(o)&&e.is(o.physicalid,"string")&&t===o.physicalid&&g.push(i)}),o.onComplete.call(o.context,g)):o.onComplete.call(null))},onFailure:function(){s.debug(m.name,"Fetching of connections failed: %s , %s",t,n),e.is(o.onFailure,"function")&&o.onFailure.call(null)}})):e.is(o.onComplete,"function")&&o.onComplete.call(null)},fetchRoot:function(t,n){var i=n||{},o=e.is(i.context)?i.context:null,r=!e.is(i.silent)||i.silent,s=!!e.is(i.forceDBMode)&&i.forceDBMode,a=e.is(i.onComplete,"function")?i.onComplete:null,c=e.is(i.onFailure,"function")?i.onFailure:null,l={onComplete:function(t){var n,i={forceDBMode:s};e.is(a,"function")&&(e.is(t.instancesAndReferences)?(n=t.instancesAndReferences,i=e.merge(i,{isArray:!0})):n=t,a.call(o,n,i))},onFailure:function(t){e.is(c,"function")&&c.call(o,t)},silent:r};e.is(t,"array")?this.collectionUtils.fetchRefList(t,l):this.collectionUtils.fetchRef({PID:t},l)},fetchInstancesAndTheirReferences:function(e,t){this.collectionUtils.fetchInstancesAndTheirReferences(e,t)},getWhereUsedReferences:function(t,n){var o,r,s=this,a=e.is(n,"function"),c={callback:function(t){var i=[],o=[];e.is(t)&&e.is(t.instancesAndReferences,"array")&&t.instancesAndReferences.forEach(function(e){e.isReference()?i.push(e):o.push(e)}),a&&n(i,o)}},l={stackedReferences:[],stackedInstances:[]};e.is(t)&&(o=t.id),i.webServiceRequest({url:"dsmfg/private/V0/invoke/whereUsed",method:"GET",data:{pid:o},onComplete:function(t){t.forEach(function(t){r=t.attributesValue,e.is(r)&&(Object.prototype.hasOwnProperty.call(r,"isInstanceOf")?l.stackedInstances.push(t):l.stackedReferences.push(t))}),s._addToCollections(l,c)},onFailure:function(){a&&n([])}})},getAltSubContextProductPromise:function(n,o){var r={mfgReferenceId:n,mfgInstanceId:e.is(o,"string")?o:null};return new t(function(t,n){i.webServiceRequest({url:"dsmfg/private/V0/invoke/getAltSubContextProduct",method:"POST",data:e.Json.encode(r),onComplete:function(e){t(e.contextProductInfo)},onFailure:function(e){n(e)}})})},_getAltSubInfo:function(t){return{id:e.result(t,"AlternateItemPhysicalId",null),qualificationStatus:e.result(t,"AlternateQualificationStatus",null),operation:e.result(t,"Operation",null),instanceContextId:e.result(t,"InstanceContextPhysicalid",null),parentContextId:e.result(t,"ParentContextPhysicalid",null)}},getAlternateEnggItemPromise:function(n){const o=this;return new t(function(t,r){const s={PrimaryItemPhysicalId:n};i.webServiceRequest({url:"v1/alternateManagement/getAlternateForEngineeringItem",method:"POST",data:e.Json.encode(s),headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(n){const i=n.status;let s;e.is(i,"string")&&"success"===i?(s=Array.isArray(n.AlternateItemInfo)?n.AlternateItemInfo.map(o._getAltSubInfo):[],t(s)):r('XEN webservice "/getAlternateForEngineeringItem" status is '+i)},onFailure:function(e){r(e)}})})},_getAlternateEnggItemInfoPromise:function(n,o,r){return new t(function(t,s){var a=i.getServiceUrl("3DSpace"),c=i.getSecurityContext(),l={AlternateQualificationFilterStatus:o,referenceObjectsInfo:n};a.endsWith("/")&&(a=a.slice(0,-1)),i.webServiceRequest({url:"v1/alternateManagement/getAlternateInfoEngineeringItems?root3DSpaceUrl="+a,method:"POST",data:e.Json.encode(l),headers:{Accept:"application/json","Content-Type":"application/json",SecurityContext:c,SecurityToken:r+"|"+c+"|preferred"},onComplete:function(n){var i;e.is(n.status,"string")&&"success"===n.status?(i=e.is(n.isAlternateDefinedForEngineeringItem)?n.isAlternateDefinedForEngineeringItem:{},t(i)):s('XEN webservice "/getAlternateForEngineeringItem" status is '+status)},onFailure:function(e){s(e)}})})},getAlternateEnggItemInfoPromise:function(n,i,o){var r=this;return new t(function(s,a){var c;c=r.splitIntoChunks(n,50).map(function(e){return r._getAlternateEnggItemInfoPromise(e,i,o)}),t.all(c).then(function(t){var n;n=t.reduce(function(t,n){return e.merge(t,n)},{}),s(n)}).catch(function(e){a(e)})})},getEngAlternatesFromBLPromise:function(n){const o=function(t){const n=function(e,t){let n=new Map;n.set(!0,[]),n.set(!1,[]);for(const i of e){const e=t(i),o=i;n.set(e,n.get(e).concat(o))}return n}(t,t=>!e.owns(t,"ErrorMessage")),i=n.get(!0),o=n.get(!1);return{altSubInfos:i.map(this._getAltSubInfo),altSubErrors:o.map(function(e){return e.ErrorMessage})}},r=this,a="BLUndefined",c="Success",l="SuccessPartially",d="Failed";return new t(function(t,u){const f={MfgItemOccPath:n};i.webServiceRequest({url:"dsmfg/private/V0/invoke/MfgItem/getEngAlternatesFromBL",method:"POST",data:e.Json.encode(f),onComplete:function(e){const n=e.Status;let i=[],u=!1;if(n===c||n===l){const{altSubInfos:t,altSubErrors:n}=o.call(r,e.ParsedBLOutput);n.length>0&&(u=!0,f=n,Array.isArray(f)&&f.length>0&&f.forEach(e=>{s.log(e)})),i=t}else n===d?(u=!0,s.log(e.ErrorMessage),i=[]):n===a&&(i=[]);var f;s.debug(r.name,'BL webservice "/getEngAlternatesFromBL" status is '+n),t({altSubInfosResult:i,someErrorOccured:u})},onFailure:function(e){u(e)}})})},getMfgItemsFromDesignAlternatesPromise:function(n,o,r){return new t(function(t,s){var a={contextProductId:n,linkTypeNavigated:r,designAlternateIds:o};i.webServiceRequest({url:"dsmfg/private/V0/invoke/mfgItemsFromDesignAlternates",method:"POST",data:e.Json.encode(a),onComplete:function(e){t(e)},onFailure:function(e){s(e)}})})}})}),define("DS/DELPPWNavigationServices/NavigateOnDemand",["UWA/Core","DS/DELPPWNavigationServices/NavigateOnIndex"],function(e,t){"use strict";return t.extend({init:function(e){e=e||{},this._parent(e)},getDescendants:function(e,t){var n={stackedReferences:[],stackedInstances:[],stackedConnections:[],documentIdMap:{}},i=this;t=t||{},e instanceof Array||(e=[e]),this.expandNodes(e,n,function(){i.navigateNodes(e,n,function(e){var o=[];n.stackedConnections.forEach(function(e){"DELAsmProcessCanUseCnx"===e.type&&-1===o.indexOf(e.PID)&&o.push(e.PID)}),i.navigateNodes(o,n,function(o){e=e.concat(o),i.expandNodes(e,n,function(){i._addToCollections(n,t)})})})},t)},getConnections:function(t,n,i){var o=this,r={stackedReferences:[],stackedInstances:[],stackedConnections:[],documentIdMap:{}},s=i||{},a=e.is(s.context)?s.context:null;t instanceof Array||(t=[t]),s=e.merge({callback:function(i){var r={queriedForConnections:!0,queriedForDocuments:!0},s={queriedForConnections:!0},c={missingInstanceObjects:[],missingReferenceObjects:[]},l={callback:function(){e.is(n,"function")&&n.call(a,i)}};t.forEach(function(t){var n,i;n=o.collectionUtils.getInstanceFromCollection(t),e.is(n)||(i=o.collectionUtils.getReferenceFromCollection(t)),e.is(i)?i.setAdditionalInfo(r):e.is(n)&&n.setAdditionalInfo(s)}),i.connections.forEach(function(t){var n=o.collectionUtils.getConnectionFromCollection(t.get("PID"));e.is(n)&&o.findMissingObj(n,c)}),o.fetchMissingObjects(c,l)}},s),this.navigateNodes(t,r,function(){var e=[];r.stackedConnections.forEach(function(t){"DELAsmProcessCanUseCnx"===t.type&&-1===e.indexOf(t.PID)&&e.push(t.PID)}),o.navigateNodes(e,r,function(){o._addToCollections(r,s)})})}})}),define("DS/DELPPWNavigationServices/NavigateUtil",["UWA/Core","UWA/Class","DS/DELPPWWebServices/WebserviceUtils","DS/DELPPWNavigationServices/SwitchDBModeManager","DS/DELPPWModelParsers/ConnectionParser","DS/DELPPWIndexServices/IndexParser","DS/DELPPWModelServices/ModelUtils","DS/DELPPWModelServices/BehaviorUtil","DS/DELPPWModelServices/Navigation/IndexedDBUtils","DS/DELPPWNavigationServices/NavigateOnDB","DS/DELPPWNavigationServices/NavigateOnIndex","DS/DELPPWNavigationServices/NavigateOnDemand","DS/DELPPWModelServices/CollectionUtils","DS/DELPPWLoggerModel/LoggerUtils"],function(e,t,n,i,o,r,s,a,c,l,d,u,f,p){"use strict";var m=t.singleton({name:"NavigateUtil",uninitializedCalls:"throw",init:function(e){if(!(e=e||{}).indexMappingXML)throw new Error("indexMappingXML option not defined");this.options=e,c.init(),m._connectionParser=o.init({collectionUtils:this.options.collectionUtils})},setup:function(t,i){var o=this,s=new Promise(function(e,t){n.getXMLValues(o.options.indexMappingXML,function(t){e(t)},function(e){t(e)})}),a=new Promise(function(t,n){e.is(o.options.mandatoryPredicates,"string")&&o.options.mandatoryPredicates.length>0?require(["text!"+o.options.mandatoryPredicates],function(e){var n=JSON.parse(e);t(n)},function(){n("mandatory Predicates defined but not loaded !!!")}):t(null)});Promise.all([s,a]).then(function(n){var i={collectionUtils:o.options.collectionUtils,mandatoryPredicates:e.is(n[1])?n[1]:null};r.setIndexMapping(n[0]),m.navigateOnDB=new l(i),m.navigateOnIndex=new d(i),m.NavigateOnDemand=new u(i),p.debug("Succesfully initialized navigations."),t()},function(e){p.debug("Failed to initialize Navigations. Failure desc:"+e),i(e)})},getConnectionParser:function(){return m._connectionParser},getConnectionsFromServer:function(t,n,i){var o=i||{},r=e.is(o.context)?o.context:null;s.isNavigateOnDemand()?this.NavigateOnDemand.getConnections(t,n,i):n.call(r)},getDescendantsFromServer:function(t,n,o){var r=o||{},c=s.getNavigateOnDatabasePreference(),l=s.isNavigateOnDemand(),d=i.isDbMode(),u=e.is(r.context)?r.context:null,p=!!e.is(r.forceDBMode,"boolean")&&r.forceDBMode;r=e.merge({callback:function(t){t.instancesAndReferences.forEach(function(e){e.isInstance()&&f.manageLinearProductFlowsOnCreateInstance(e)}),e.is(n,"function")&&n.call(u,t)},fillLinksAndDocuments:!1,withLinks:!0},r),p||c||d?this.navigateOnDB.getDescendants(t,r):l?this.NavigateOnDemand.getDescendants(t,r):a.isExpandFetchFetchEnabled()?this.navigateOnIndex.getDescendantsV2(t,r):this.navigateOnIndex.getDescendants(t,r)},getInverseConnectionsFromServer:function(e,t){this.navigateOnIndex.getInverseConnections(e,t)},setSelectPredicate:function(e,t){this.navigateOnIndex.setSelectPredicate(e,t)},fetchRoot:function(t,n){var i,o,r,a,c,l=this,d=n||{},u=e.is(d.context)?d.context:null,f=!!e.is(n.WithSynthesisAttribute)&&n.WithSynthesisAttribute,p=!!e.is(d.forceDBMode)&&d.forceDBMode;o=e.is(d.onComplete,"function")?d.onComplete:null,i=e.is(d.onFailure,"function")?d.onFailure:null,c=function(t,n){var i=e.is(t,"array")?t.slice():[t];return n=n||[],e.is(n,"array")||(n=[n]),n.forEach(function(e){var t=i.indexOf(e.id);t>-1&&i.splice(t,1)}),i},r=function(n,i){var r;i=i||{},(r=c(t,n)).length>0&&(i.modelsNotRetrieved=r),e.is(o,"function")&&o.call(u,n,i)},!0===f?l.navigateOnIndex.fetchRoot(t,d):!0!==s.getNavigateOnIndex()||p?l.navigateOnDB.fetchRoot(t,e.merge({onComplete:r},d)):(a=function(n){var o,s,a=c(t,n);a.length>0?(o=function(i,o){var s,a=[];(i=e.is(i,"array")?i:[i]).forEach(function(e){a.push(e.id)}),e.is(t,"array")?(s=[],e.is(n)&&(n=e.is(n,"array")?n:[n],s=s.concat(n)),i=e.is(i,"array")?i:[i],s=s.concat(i)):s=i,o.modelsFromForceDB=a,r(s,o)},s=function(){e.is(n)?r(n):i&&i.call(u,"Object not found in index mode for PID:"+t)},l.navigateOnDB.fetchRoot(a,e.merge({onComplete:o,onFailure:s,forceDBMode:!0},d))):r(n)},l.navigateOnIndex.fetchRoot(t,e.merge({onComplete:a,onFailure:a},d)))},fetchMultiplePromise:function(e,t){return this.navigateOnIndex.fetchMultipleOnIndexPromise(e,t)},findMissingLinkedObjects:function(t,n,i){var o=e.merge({callback:n},i);this.navigateOnIndex.findMissingLinkedObjects(t,o)},getConnectionsByModel:function(t,n,i){var o=i||{},r=!!e.is(o.forceDBMode)&&o.forceDBMode;!s.getNavigateOnIndex()&&!s.isNavigateOnDemand()||r?this.navigateOnDB.getConnectionsByModel(t,n,o.relationTypes,o.isRefRefOnly,o.onComplete):this.navigateOnIndex.getConnectionsByModel(t,n,o.relationTypes,o.isRefRefOnly,o.onComplete)},getAltSubContextProductPromise:function(e,t){return this.navigateOnDB.getAltSubContextProductPromise(e,t)},getMultipleAltSubContextProductsPromise:function(e){return this.navigateOnIndex.getMultipleAltSubContextProductsPromise(e)},getAlternateEnggItemPromise:function(e){return this.navigateOnDB.getAlternateEnggItemPromise(e)},getEngAlternatesFromBLPromise:function(e){return this.navigateOnDB.getEngAlternatesFromBLPromise(e)},getAlternateEnggItemInfoPromise:function(e,t,n){return this.navigateOnDB.getAlternateEnggItemInfoPromise(e,t,n)},getMfgItemsFromDesignAlternatesPromise:function(e,t,n){return this.navigateOnDB.getMfgItemsFromDesignAlternatesPromise(e,t,n)},fetchInstancesAndTheirReferences:function(e,t){return this.navigateOnDB.fetchInstancesAndTheirReferences(e,t)},getWhereUsedReferences:function(e,t){this.navigateOnDB.getWhereUsedReferences(e,t)},getProductScopedLinksFromIndex:function(e,t,n){this.navigateOnIndex.getProductScopedLinks(e,t,n)},getProductScopedLinksFromDB:function(t,n){e.is(this.navigateOnDB)||(this.navigateOnDB=new l(this.options)),this.navigateOnDB.fetchConnections(t,null,n,!0)},navigateScopesFromIndex:function(e,t,n){this.navigateOnIndex.navigateScopes(e,t,n)},navigateOnIndex:function(e,t,n){this.navigateOnIndex.navigateOnIndex(e,t,n)},getReferenceFromInstance:function(e,t,n){this.navigateOnIndex.getReferenceFromInstance(e,t,n)}});return m});