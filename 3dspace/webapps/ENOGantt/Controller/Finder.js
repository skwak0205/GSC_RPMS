define("DS/ENOGantt/Controller/Finder",["UWA/Class","DS/ENOGantt/Ven/Ext","DS/ENOGantt/GanttUtil"],function(e,t,i){var n=0,l=null;return e.extend({init:function(e){this.newValue=e.newValue,this.oldValue=e.oldValue,this.field=e.field,this.view=e.view,this.store=e.store,this.models=e.store.toArray(),n=0,l=null},ExpandAndFind:function(e,n){e.finder.currentIndex=0,e.finder.lastMatchedTask=null,new UWA.Promise(function(e,n){var l=t.ComponentQuery.query("#dpmprojectgantt")[0];i.getStoreTaskExpandStatus(l.taskStore),App.Infra.LoadText=App.Nls["emxProgramCentral.Gantt.PerfomFind"],i.isReadyToExpand(void 0,e,0)}).then(function(t){e.finder.find(n)})},reset:function(){this.field.setValue(""),this.field.getTrigger("clear").setVisible(!1);var e=this.view.getSchedulingView(),t=this.view.getSelectionModel(),i=this.view.getSelectedRows(),s=this.view.taskStore.toArray();if(i.length>0)for(var r=0,d=i.length;r<d;r++){var a=i[r];e.unhighlightTask(a),t.deselect(a)}e.scrollEventIntoView(s[1],!1,!1),this.lastMatchIndex=0,this.lastMatchedTask=null,n=0,l=null},find:function(e,i){i||(n=0,l=null);var s=this.newValue,r=this.oldValue,d=this.field.getTrigger("clear");if(s&&s.length>0&&s!=r){d.setVisible(!0);var a=new RegExp(t.String.escapeRegex(s),"i"),h=this.store.find(e,a,s,n);if(h&&h.model&&this.isNodeVisible(h.model))return this.highlightTask(h.model),l=h.model,n=h.index,h}else this.reset()},isNodeRefinedAlready:function(e){return!0},isNodeVisible:function(e){var t=e.get("visible"),i=this.isNodeRefinedAlready(e);return t&&i},highlightTask:function(e){var t=this.view.getSchedulingView(),i=this.view.lockedGrid.getView().getSelectionModel();l&&(t.unhighlightTask(l),i.deselect(l)),t.scrollEventIntoView(e,!1,!1),t.highlightTask(e,!1),i.select(e)},unhighlightTask:function(){if(l){var e=this.view.getSchedulingView(),t=this.view.lockedGrid.getView().getSelectionModel();e.unhighlightTask(l),t.deselect(l)}}})});