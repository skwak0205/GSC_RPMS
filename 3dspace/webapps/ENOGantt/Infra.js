define("DS/ENOGantt/Infra",["UWA/Class","DS/Foundation2/FoundationV2Data","DS/E6WCommonUI/UIHelper","DS/ENOGantt/URLStore","DS/ENOGantt/Ven/Ext","DS/ENOGantt/Ven/Bryntum","DS/ENOGantt/Nls/Eno/"+window.languageGlobalVar,"DS/ENOGantt/Nls/Ext/"+window.languageGlobalVar,"DS/ENOGantt/Nls/Sch/"+window.languageGlobalVar,"DS/ENOGantt/Nls/Gnt/"+window.languageGlobalVar],function(e,a,n,t,r,s,o){r.ns("App"),App.Gantt={},App.csrf={name:"",value:""},App.Gantt.filter={fields:{},filterBy:{}},App.Nls=o;var E=function(e){var a={},n=JSON.parse(e),t={},r=[],s={},o=[];for(a.customeColumnEditableData=s,a.customeColumnDataIndex=r,a.columns=o,i=0,m=n.length;i<m;i++){if((p=n[i]).customColumn){"datecolumn"==p.xtype&&r.push(p.dataIndex);var E=p.name,l=p.editable;s[E]={isEditable:l,xtype:p.xtype}}null==p.name&&(t[p.text]=i),p.columnIndex&&p.columnIndex>0?o.splice(p.columnIndex,0,p):o.push(p)}t={};for(i=0,m=o.length;i<m;i++){var p;t[(p=o[i]).name]=i}var I=o[t.Name];if(I.width=350,App.Infra.ViewId!=App.Infra.Views.VIEW_WBS&&App.Infra.ViewId!=App.Infra.Views.VIEW_TEMPLATE_WBS||(I.width=200,I.layout="vbox",I.items=[{id:"filterField",xtype:"textfield",width:"100%",emptyText:App.Nls["emxProgramCentral.Common.Filter"],enableKeyEvents:!0,reference:"filterByName"}]),App.Infra.ViewId!=App.Infra.Views.VIEW_STATUS_REPORT){var d=o[t.Status];d.sortable=!1,d.renderer=function(e,a,n){var t=n.get("Status"),r=App.Nls["emxProgramCentral.Gantt.TaskStatus."+t];if(r)return'<div title="'+r+'" class="status '+t+'">&nbsp;</div>'},a.columnsIndex=t;var u=t.Dependency;o[u].useSequenceNumber=!0,delete o[u].editor}return a};return e.extend({init:function(e){App.Gantt.filter={fields:{},filterBy:{}};var n=this;enoviaServer.viewId||(enoviaServer.viewId="WBSView");var i=t.getInfraURL();window.isODTRunning?r.Ajax.request({url:i,async:!1,success:function(a){a=JSON.parse(a.responseText.trim()),n.setupInfra(a),e.loadWidget()}}):a.ajaxRequest({url:i,dataType:"json",callback:function(a){n.setupInfra(a),e.loadWidget()}})},setupInfra:function(e){var a=e.data,s=a[0].dataelements,o=a[0].relelements,l="TRUE"==s.kindofTemplate,p="TRUE"==s.kindofBaseline,I="TRUE"==s.kindofExperiment,d="TRUE"==s.kindofConcept,u="TRUE"==s.modifyAccess,S=(n.isMobile(),!0),A=!0,f=!1,V=!0,c=!1,_={VIEW_WBS:"WBSView",VIEW_ACTUAL:"ActualWBSView",VIEW_PLAN_VERSUS_ACTUAL:"PlannedVsActualView",VIEW_BASELINE_WBS:"ProjectBaselineView",VIEW_BASELINE_VERSUS_CURRENT_BASELINE:"BaselineVsCurrentBaselineView",VIEW_BASELINE_VERSUS_CURRENT_BASELINE2:"BaselineVsCurrentBaselineView2",VIEW_EXPERIMENT_VERSUS_PROJECT:"ExperimentVsProjectView",VIEW_TEMPLATE_WBS:"ProjectTemplateView",VIEW_STATUS_REPORT:"StatusReportViewer"};l?enoviaServer.viewId=_.VIEW_TEMPLATE_WBS:p?(enoviaServer.viewId!=_.VIEW_BASELINE_VERSUS_CURRENT_BASELINE2&&enoviaServer.viewId!=_.VIEW_BASELINE_VERSUS_CURRENT_BASELINE||(f=!0,c=!0),enoviaServer.viewId=_.VIEW_BASELINE_WBS,S=!0):enoviaServer.viewId||(enoviaServer.viewId=_.VIEW_WBS);var v=enoviaServer.viewId;_.VIEW_WBS==v?(S=!u,"Cancel"==s.state&&(S=!0),A=!1,(I||d)&&((s.routeId||"Cancel"==s.experimentProjectState||"Hold"==s.experimentProjectState)&&(S=!0),A=!0)):_.VIEW_TEMPLATE_WBS==v?(S=!u,"Released"!=s.state&&"Obsolete"!=s.state||(S=!0)):_.VIEW_PLAN_VERSUS_ACTUAL==v?(A=!1,f=!0):_.VIEW_BASELINE_VERSUS_CURRENT_BASELINE==v?(A=!1,f=!0,c=!0):_.VIEW_BASELINE_VERSUS_CURRENT_BASELINE2==v?(f=!0,c=!0):_.VIEW_EXPERIMENT_VERSUS_PROJECT==v?(f=!0,c=!0):_.VIEW_STATUS_REPORT==v&&(A=!1,V=!1);App.Infra={ViewId:enoviaServer.viewId,ReadOnly:S,HideView:A,BaselineRequired:f,ToolbarRequired:!0,NameFilterRequired:V,TypeOf:{ProjectTemplate:l,ProjectBaseline:p,Experiment:I},Views:_,routeId:s.routeId};var R=s.columns;delete s.columns;var T=E(R),N=T.columns,w=T.columnsIndex;App.Infra.CustomeColumnDataIndex=T.customeColumnDataIndex,App.Infra.customeColumnEditableData=T.customeColumnEditableData,App.Infra.Columns=N,App.Infra.ColumnIndex=w,App.Infra.ExtTaskArray=new Array,App.Infra.expandStatus={},App.Infra.Load={},App.Infra.projectDataElements=s,App.Infra.RootProjectname=s.title,App.Infra.projectRelElements=o,App.Infra.isCustomizedEnvironment=c,App.Infra.DerivativeTypes=a[0].relateddata.subTypesInfo[0].dataelements;var W=s.lagCalendar;for(App.Infra.depLagCalendar="Predecessor Task Calendar"==W?"source":"Project Default Calendar"==W?"project":"target",i=0,m=e.definitions.length;i<m;i++)if("hasDPMAccess"===e.definitions[i].name){App.Infra.hasDPMLicense=!0;break}return r.Ajax.request({url:t.getCustomizationFlagURL(),async:!1,success:function(e){var a=JSON.parse(e.responseText.trim());a.isCustomizedEnvironment&&(App.Infra.isCustomizedEnvironment=a.isCustomizedEnvironment)}}),App}})});