define("DS/ENOGantt/GanttUtil",["DS/ENOGantt/GanttConstants","DS/ENO6WPlugins/jQuery","DS/WAFData/WAFData","DS/ENOGantt/URLStore"],function(e,t,a,n){var r=function(e){var t=e.onFailure||function(t,a){var n=a||{};!1===n.success&&n.error||(n={error:"Network Error: Unable to load widget due to network or authentication error."}),e.callback.call(this,n)},n=e.onTimeout||function(){e.callback.call(this,{error:"Network Error: Unable to load widget due to timeout error."})},r=e.onCancel||function(){e.callback.call(this,{error:"Application Error: Request canceled."})},i=a.authenticatedRequest(e.url,{method:e.type,type:e.dataType,proxy:"passport",timeout:5e5,cache:3600,data:e.data,onComplete:e.callback,onFailure:t,onCancel:r,async:!1,onTimeout:n,headers:e.headers});return i=i||{cancel:Function.prototype}};return{authenticateReqAndCall:function(e){r(e)},checkRepetativeDependancy:function(e){for(var t=new Array,a=e.split(","),n=0;n<a.length;n++){var r="",i=a[n].split(":");if(r=i.length>2?i[0]+":"+i[1]:i[0],-1!=t.indexOf(r))return!0;t.push(r)}return!1},isNumeric:function(e){return!isNaN(e)},getSelectiveItemArray:function(e,t,a,n){for(var r=[],i=App.Nls["emxProgramCentral.Common.All"],o=1,s=e;o<=s;o++)r.push({text:o,id:t.concat(o),itemId:t.concat(o),level:o});return r.push({text:i,id:t.concat("all"),itemId:t.concat("all")}),r},selectiveExpandFromRMB:function(e,t){e.collapse(!0),e.expand(!1),t>1&&e.hasChildNodes&&this.expandNode(e,t,e.data.depth)},selectiveExpand:function(e,t){var a=e.taskStore.getRoot().childNodes[0];a.expanded?e.collapseAll():a.collapse(!0),a.expand(!1),t>a.data.depth&&a.hasChildNodes&&this.expandNode(a,t,null)},expandNode:function(e,t,a){for(var n=e.childNodes,r=0,i=n.length;r<i;r++){var o=n[r],s=o.data.depth;a&&(s=o.data.depth-a+1),t>=s&&o.expand(!1),t>=s&&o.hasChildNodes&&this.expandNode(o,t,a)}},getDataIndex:function(e,t){return e.taskStore.data.items[0].get("ganttConfig")},getGanttLabel:function(e,t){var a,n=Ext.ComponentQuery.query("#dpmprojectgantt")[0],r=this.getDataIndex(n,e);if(t){var i=e.get("Name");a=e.get("EnglishType")+"rb"}else{i="";a=e.get("EnglishType")+"lb"}if(""!=r&&App.Infra.ViewId!=App.Infra.Views.VIEW_STATUS_REPORT){var o=JSON.parse(r)[a];if(null==o||""==o)return i;var s=o.split("#");if("TaskNotes"==s[0]&&(s[0]="Note"),null==(i="Duration"==s[0]?e.get(s[0])+" "+e.get("DurationUnit"):e.get(s[0]))&&(i=""),this.isDateField(s[0])?i=Ext.Date.format(i,this.getDateFormat()):""!==i&&(i=this.truncateValue(i)),o.indexOf("#")>=0){var l="";"TaskNotes"==s[1]&&(s[1]="Note"),null==(l="Duration"==s[1]?e.get(s[1])+" "+e.get("DurationUnit"):e.get(s[1]))&&(l=""),this.isDateField(s[1])?l=Ext.Date.format(l,this.getDateFormat()):""!==l&&(l=this.truncateValue(l)),""!==l&&(i=""===i?l:i+","+l)}}return i},truncateValue:function(e){return e.length>100?e.substring(0,100-"...".length)+"...":e},isDateField:function(e){return"StartDate"==e||"EndDate"==e||"BaselineStartDate"==e||"BaselineEndDate"==e},getDateFormat:function(t){return void 0!==t?e.dateFormat[t.toLowerCase()]:e.dateFormat[window.languageGlobalVar.toLowerCase()]},getLastSequenceIdForProject:function(e){var t=0,a=n.getLastSequenceURL(e),i={url:a,type:"GET",async:!1,dataType:"json",callback:function(e){"200"==e.success&&(t=e.lastSequence)}};return"undefined"==typeof widget?Ext.Ajax.request({url:a,async:!1,success:function(e){var t=JSON.parse(e.responseText.trim());i.callback(t)}}):r(i),t},hasValidSequenceNo:function(e,t){for(var a=Ext.ComponentQuery.query("#dpmprojectgantt")[0],n=App.Nls["emxProgramCentral.Common.Dependency.InvalidSequenceNumber"],r=t.data.Id,i=null,o=e.split(","),s=0;s<o.length;s++){var l,d=o[s].split(":"),p=d.length>2,c=!0;if(p){var u=d[0];if(!this.isValidExternalProject(u))return!1;var f=d[1];null!=(l=this.getSubProjectByName(u))?i=l.get("LastSequence"):c=!1}else{f=d[0];var g=a.taskStore.getModelById(r),m=null,h=g.data.EnglishType;m="ProjectSpace"==h||"ProjectConcept"==h||"Experiment"==h?a.taskStore.toArray()[1].get("Id"):g.get("TaskProjectId"),i=(l=a.taskStore.getModelById(m)).get("LastSequence")}if(!(i&&0==App.Infra.Load.Level||null==l||window.isODTRunning)){m=l.getId();(i=this.getLastSequenceIdForProject(m))||l.set("LastSequence",i)}var y=(f=parseInt(f))<=i;if(0==f||!p&&!y||c&&!y)return n=n.replace("<SequenceNo>",f),alert(n),!1}return!0},getTaskBySequenceId:function(e,t){for(var a=Ext.ComponentQuery.query("#dpmprojectgantt")[0],n=e.get("Id"),r=a.taskStore.toArray(),i=r.length,o=null,s=1;s<i;s++){var l=r[s],d=l.get("TaskSequenceId");d+="";var p=l.get("TaskProjectId");if(t===d&&(!p||p==n)){o=l;break}}if(!o){var c=e.get("Name"),u=this.getExternalProjectTaskBySequenceId(c,t,!0);o={Id:u.taskId,projectPhyId:u.projectPhyId}}return o},getExternalProjectTaskBySequenceId:function(e,t,a){var i=Ext.ComponentQuery.query("#dpmprojectgantt")[0].taskStore.getRoot().childNodes[0].id,o=n.getExternalProjectTaskBySequenceIdURL(e,t,i,a),s={},l={url:o,type:"GET",async:!1,dataType:"json",callback:function(e){if("200"==e.success){var t=e.taskId,a=e.projectPhyId;s={taskId:t,projectPhyId:a}}}};return"undefined"==typeof widget?Ext.Ajax.request({url:o,async:!1,success:function(e){var t=JSON.parse(e.responseText.trim());l.callback(t)}}):r(l),s},hasCircularDependency:function(e,t){var a=Ext.ComponentQuery.query("#dpmprojectgantt")[0],n=[-1,-3,-4,-9],r={SS:0,SF:1,FS:2,FF:3},i=t.data.Id,o=t.data.Name;o+=", id:"+t.data.TaskSequenceId;var s=App.Nls["emxComponents.Task.CircularDependancyDetected"];s=s.replace("{0}",o);for(var l=[],d=a.getDependencyStore(),p=t.getIncomingDependencies(d),c=[],u=0;u<p.length;u++){var f=p[u].data;c.push(f.From)}var g=e.split(",");for(u=0;u<g.length;u++){var m=!0,h=null,y=null,S=g[u].split(":"),v=S.length>2;if(v){var T=S[0],A=S[1];if(y=S[2],null!=(I=this.getSubProjectByName(T)))h=(N=this.getTaskBySequenceId(I,A)).Id||N.get("Id");else m=!1}else{A=S[0];y=S[1];var k=a.taskStore.getModelById(i),x=null,E=k.data.EnglishType;x="ProjectSpace"==E||"ProjectConcept"==E||"Experiment"==E?a.taskStore.toArray()[1].get("Id"):k.get("TaskProjectId");var N,I=a.taskStore.getModelById(x);h=(N=this.getTaskBySequenceId(I,A)).Id||N.get("Id")}if(y=r[(y=y.substring(0,2)).toUpperCase()],m){var C={};C.From=h,C.To=i,C.Type=y,l.push(C)}if(m&&-1==c.indexOf(h)&&(!v||m)){var P=d.getDependencyError(h,i,y);if(-1!=n.indexOf(P))return alert(s),!0}}return!1},validateDependency:function(e,t){if((t=t.trim())&&""!=t){var a=App.Nls.dependencyTypes,n=a[0],r=a[1],i=a[2],o=a[3],s=App.Nls.Active,l=App.Nls.Review,d=App.Nls["emxProgramCentral.Common.InValidProjectSpaceDependency"],p=App.Nls["emxProgramCentral.Common.InValidProjectTemplateDependency"],c=App.Infra.TypeOf.ProjectTemplate?p:d;c=c.replace(/\\n/g,"\n");var u=App.Nls["emxProgramCentral.WBS.editDependency.errorMessage"],f=App.Nls["emxProgramCentral.Common.InValidRepetitionDependency"],g=this.parseDependencyString(t);if(t=g.validationValue,!this.validateDependencySyntax(t))return alert(c),!1;if(t=g.actualValue,this.checkRepetativeDependancy(t))return alert(f),!1;var m=!e.isLeaf(),h=t.toUpperCase(),y=-1!=h.indexOf(r)||-1!=h.indexOf(o);if(m&&y){var S=e.data.Name;return alert(" "+r+" and "+o+" "+u+" "+S),!1}var v=-1!=h.indexOf(n)||-1!=h.indexOf(i);if((e.data.State==s||e.data.State===l)&&v){var T=App.Nls["emxProgramCentral.DependencyNotAllowedNotice"];return T=T.replace("{0}",e.data.State),alert(T),!1}if(!this.hasValidSequenceNo(t,e))return!1;if(this.hasCircularDependency(t,e))return!1}else;return!0},validateDependencySyntax:function(e){var t=/^((([a-zA-Z0-9_-]+((\s\w+)+)?:)?\d+:[FSfs]{2}([\+\-]\d+(\.\d+)?\s[DdHh])?)(\,((\w+((\s\w+)+)?:)?\d+:[FSfs]{2}([\+\-]\d+(\.\d+)?\s[DdHh])?))*)?$/;return App.Infra.TypeOf.ProjectTemplate&&(t=/^((\d+:[FSfs]{2}([\+\-]\d+(\.\d+)?\s[DdHh])?)(\,(\d+:[FSfs]{2}([\+\-]\d+(\.\d+)?\s[DdHh])?))*)?$/),t.test(e)},parseDependencyString:function(e){if(e&&""!=e){e=e.trim();for(var t=new Array("",""),a=":"+App.Nls["emxProgramCentral.KeyinDependency.Default"],n=e.split(","),r=0;r<n.length;r++){var i=n[r];if(i){if(i=i.trim(),isNaN(i))2==i.split(":").length-1&&(i="TestPRJ:"+i.substring(i.indexOf(":")+1,i.length));else n[r]=i+a,i=n[r];0==r?(t[0]=n[r].trim(),t[1]=i.trim()):(t[0]+=","+n[r].trim(),t[1]+=","+i.trim())}}return{actualValue:t[0],validationValue:t[1]}}return{actualValue:"",validationValue:""}},isValidExternalProject:function(e){return!0},getSubProjectByName:function(e){for(var t=Ext.ComponentQuery.query("#dpmprojectgantt")[0].taskStore.toArray(),a=null,n=0,r=t.length;n<r;n++){var i=t[n].data.EnglishType;if(t[n].data.Name==e&&("ProjectSpace"==i||"ProjectConcept"==i||"Experiment"==i)){a=t[n];break}}return a},enableButtons:function(e){for(var t=0;t<e.length;t++)Ext.getCmp(e[t].trim()).enable()},disableButtons:function(e){for(var t=0;t<e.length;t++)Ext.getCmp(e[t].trim()).disable()},isValidRMBOperation:function(t,a){var n=Ext.ComponentQuery.query("#dpmprojectgantt")[0];if(n.crudManager.hasChanges()){if(!confirm(App.Nls["emxProgramCentral.Project.DiscardChanges"]))return!1;n.getCrudManager().reject()}if(!this.isRecordSelectionOkForAddOrDeleteTask(a))return!1;e.actionType;var r=t.data.EnglishType;if(this.isDeleteTask(a))if("ProjectSpace"==r||"ProjectConcept"==r||"Experiment"==r){if(!confirm(App.Nls["emxProgramCentral.Project.ConfirmSubProjectDelete"]))return!1}else if(!confirm(App.Nls["emxProgramCentral.Project.ConfirmTaskDelete"]))return!1;return!(this.isAddAsSubTask(a)&&!this.cnfrmToRemoveSelectedTaskDependency(t))&&(this.isDeleteTask(a)&&this.filterTasksBeforeDelete(),!0)},isValidAddTaskAbove:function(e){return!this.isRootNode(e)&&this.isValidAddSubTask(e.parentNode)},isValidAddSubTask:function(e){var t=Ext.ComponentQuery.query("#dpmprojectgantt")[0].taskStore.getRoot().childNodes[0];return"Project Space Hold Cancel"!=t.data.Policy&&(!!this.isSelTaskInActiveOrPrior(e)&&("Cancel"!=t.data.experimentProjectState&&"Hold"!=t.data.experimentProjectState&&("TRUE"!=e.data.passiveSubtask&&((!e.isMilestone()||!e.isLeaf())&&(e.data.State!=App.Nls.Complete&&("TRUE"==e.data.hasEditAccess&&(App.Infra.Views.VIEW_TEMPLATE_WBS==App.Infra.ViewId||(App.Infra.Views.VIEW_WBS==App.Infra.ViewId?!App.Infra.TypeOf.Experiment||!App.Infra.routeId:1!=App.Infra.ReadOnly))))))))},isValidRemoveSubProject:function(e){if(this.isRootNode(e))return!1;var t=Ext.ComponentQuery.query("#dpmprojectgantt")[0];if("Project Space Hold Cancel"==t.taskStore.getRoot().childNodes[0].data.Policy)return!1;for(var a=t.lockedGrid.getSelectionModel().selected.items,n=0;n<a.length;n++){var r=a[n].data.EnglishType;if("Task"==r||"Phase"==r||"Gate"==r||"Milestone"==r)return!1}return!0},isValidDeleteTask:function(e){var t=App.Nls.Create,a=App.Nls.Assign,n=e.data.State;e.data.EnglishType;if(this.isRootNode(e))return!1;var r=Ext.ComponentQuery.query("#dpmprojectgantt")[0],i=r.taskStore.getRoot().childNodes[0];if("Project Space Hold Cancel"==i.data.Policy)return!1;for(var o=r.lockedGrid.getSelectionModel().selected.items,s=0;s<o.length;s++){var l=o[s].data.EnglishType;if("ProjectSpace"==l||"ProjectConcept"==l||"Experiment"==l)return!1}return"Cancel"!=i.data.experimentProjectState&&"Hold"!=i.data.experimentProjectState&&((t==n||a==n)&&"TRUE"==e.data.deleteAccess)},filterTasksBeforeDelete:function(){this.filterTasksBeyondAssignState()},filterTasksBeyondAssignState:function(){for(var e=Ext.ComponentQuery.query("#dpmprojectgantt")[0],t=App.Nls.Create,a=App.Nls.Assign,n=new Array,r=e.lockedGrid.getSelectionModel().selected.items,i=0,o=r.length;i<o;i++){var s=r[i].id,l=e.taskStore.getModelById(s),d=l.data.State,p=(l.data.isSummaryTask,l.data.EnglishType);t!=d&&a!=d&&"ProjectSpace"!=p&&"ProjectConcept"!=p&&"Experiment"!=p&&(e.lockedGrid.getSelectionModel().deselect(l),n.push(l.data.Name),--i,--o)}n.length>0&&alert(App.Nls["emxProgramCentral.Common.UnableToDeleteTasks"]+"\n"+n)},filterBy_Mandatory_Effort_Effectivity:function(e){var t=e.MandExcludeTaskIds,a="";t.length>0&&((r=this.deSelectAndGetNames(t)).length>0&&(a="\n"+a+App.Nls["emxProgramCentral.Common.CannotDeleteMandatoryTask"]+"\n"+r+"\n"));var n=e.TaskIdsWithEffort;n.length>0&&((r=this.deSelectAndGetNames(n)).length>0&&(a="\n"+a+App.Nls["emxProgramCentral.WeeklyTimeSheet.DeleteTask.TaskWithEffortCannotBeDeleted"]+"\n"+r+"\n"));var r,i=e.MilestoneListUsedInEffectivity;i&&((r=this.deSelectAndGetNames(i)).length>0&&(a="\n"+a+App.Nls["emxProgramCentral.Common.CannotDeleteMilestoneEffectivityTask"]+"\n"+r));if(a.length>0)return a},getAsArr:function(e){return-1!=e.indexOf("[")&&-1!=e.indexOf("]")&&(e=e.substring(1,e.length-1)),e.split(",")},deSelectAndGetNames:function(e){for(var t=Ext.ComponentQuery.query("#dpmprojectgantt")[0],a=new Array,n=t.lockedGrid.getSelectionModel(),r=0,i=e.length;r<i;r++){var o=e[r].trim(),s=t.taskStore.getModelById(o);n.deselect(s),a.push(s.data.Name)}return a},isParentInActiveOrPrior:function(e){App.Nls.Active;var t=App.Nls.Review,a=App.Nls.Complete,n=e.parentNode.data.State;return n!=t&&n!=a},isSelTaskInActiveOrPrior:function(e){var t=App.Nls.Review,a=App.Nls.Complete,n=App.Nls.Archive,r=e.data.State;return App.Infra.Views.VIEW_TEMPLATE_WBS===App.Infra.ViewId||r!=t&&r!=a&&r!=n},cnfrmToRemoveSelectedTaskDependency:function(e){for(var t=Ext.ComponentQuery.query("#dpmprojectgantt")[0],a=e.getIncomingDependencies(t.getDependencyStore()),n=0,r=a.length;n<r;n++){var i=a[n].data.Type;if("1"==i||"3"==i){var o=App.Nls.dependencyTypes,s=o[1],l=o[3],d=App.Nls["emxProgramCentral.WBS.addSubtask.ConfirmToRemoveDependency"];return d=(d=(d=(d=d.replace("<dependencyType1>",s)).replace("<dependencyType3>",s)).replace("<dependencyType2>",l)).replace("<dependencyType4>",l),confirm(d)}}return!0},isRecordSelectionOkForAddOrDeleteTask:function(e){var t=Ext.ComponentQuery.query("#dpmprojectgantt")[0].lockedGrid.getSelectionModel().selected.length;if(this.isAddTask(e)&&1!=t)return alert(App.Nls["emxFramework.Common.PleaseSelectOneItemOnly"]),!1;if(this.isDeleteTask(e)){if(t<1)return alert(App.Nls["emxFramework.Common.PleaseSelectitem"]),!1;if(t>1950)return alert(App.Nls["emxProgramCentral.Common.TooManySelected"]),!1}return!0},isAddAsSubTask:function(t){var a=e.actionType;return a.ADD_SUB_TASK==t||a.ADD_PHASE==t||a.ADD_GATE==t||a.ADD_MILESTONE==t},isAddTask:function(t){var a=e.actionType;return this.isAddAsSubTask(t)||a.ADD_TASK_ABOVE==t},isDeleteTask:function(e){return!this.isAddTask(e)},isRootNode:function(e){return""==e.data.TaskSequenceId||null==e.data.TaskSequenceId},isValidTaskResize:function(e,t,a){var n=Ext.ComponentQuery.query("#dpmprojectgantt")[0];if(!e.isDurationEditable())return!1;var r=t.currentTarget.className.indexOf("start")>-1?"StartStretch":"EndStretch",i=e.get("TaskProjectId");i="null"==i?e.id:i;var o=n.taskStore.getModelById(i),s=o.get("ScheduleFrom");return"Forecast"!==o.get("scheduleBasedOn")&&!("StartStretch"===r&&"Project Start Date"===s||"EndStretch"===r&&"Project Finish Date"===s)},isValidManageResourceAction:function(e){var t=Ext.ComponentQuery.query("#dpmprojectgantt")[0],a=App.Infra.TypeOf.Experiment,n=App.Infra.TypeOf.ProjectTemplate,r=App.Infra.TypeOf.ProjectBaseline,i=e.data.EnglishType;if(a||n||r||"ProjectSpace"==i)return!1;var o=t.taskStore.getRoot().childNodes[0];if("ProjectSpace"==o.data.EnglishType&&"ProjectSpace"!=i){if("Project Space"!=o.data.Policy)return!1;var s=App.Nls.Complete,l=e.data.State;if("TRUE"!=e.data.hasEditAccess||e.isReadOnly()||s==l)return!1}return!0},isGanttChartReadOnly:function(){var e=!1,t=Ext.ComponentQuery.query("#dpmprojectgantt")[0];return t&&(e=t.isReadOnly()),e},validateBadNameChar:function(e){var t=!0,a=n.validateBadNameCharURL(),i={url:a,type:"GET",async:!1,dataType:"json",callback:function(a){if(a.badChars)for(var n=(n=App.Nls["emxProgramCentral.ProjectImport.InvalidCharacterInTaskName"])+"\n"+a.badChars,r=a.badChars.split(" "),i=0;i<r.length;i++){var o=r[i];if(-1!=e.indexOf(o)){t=!1,alert(n);break}}}};return"undefined"==typeof widget?Ext.Ajax.request({url:a,async:!1,success:function(e){if("200"==e.status){var t=JSON.parse(e.responseText.trim());i.callback(t)}}}):r(i),t},getStoreTaskExpandStatus:function(e){for(var t=e.getData().items.length,a=0;a<t;a++){var n=e.getData().items[a];if(0==n.get("leaf"))1==n.get("expanded")&&(App.Infra.expandStatus[n.get("Id")]=!0)}},isValidForOpenInNewTab:function(e){return null==App.Infra.BaselineRequired||1!=App.Infra.BaselineRequired},isValidForCollabTask:function(e){Ext.ComponentQuery.query("#dpmprojectgantt")[0];var t=e.get("EnglishType");return!("ProjectTemplate"==t||"ProjectSpace"==t||"ProjectConcept"==t||"Experiment"==t||!e.isLeaf())},isReadyToExpand:function(e,t,a){var n=this,r=!1,i=Ext.ComponentQuery.query("#dpmprojectgantt")[0],o=a||0;if(null!=App.Infra.Load.Level){var s=App.Infra.Load.Level;if(s>=o&&0!=o||0==s)return t(),!0;App.Infra.Load.Level=o>=5||0==o?0:o}e&&(e.set("expanded",!0),r=!0);var l=i.getTaskStore();new UWA.Promise(function(e,t){i.crudManager.transport.load.resolve=e,r&&n.getStoreTaskExpandStatus(l),console.time("load"),i.crudManager.load(),console.timeEnd("load")}).then(function(e){t()})},isValidForColor:function(e,t){var a=Ext.ComponentQuery.query("#dpmprojectgantt")[0],n=a.taskStore.getRoot().childNodes[0];if("Project Space Hold Cancel"==n.data.Policy)return!1;if("Cancel"==n.data.experimentProjectState||"Hold"==n.data.experimentProjectState)return!1;if("TRUE"==e.data.passiveSubtask)return!1;if(!this.isSelTaskInActiveOrPrior(e))return!1;if("TRUE"!=e.data.hasEditAccess)return!1;var r=a.getSchedulingView(),i=a.lockedGrid.getView().getSelectionModel();if(!t.ctrlKey){for(var o=a.lockedGrid.getSelectionModel().selected.items,s=0,l=o.length;s<l;s++)r.unhighlightTask(o[s]),i.deselect(o[s]);i.select(e)}return r.highlightTask(e,!1),!0},isValidTaskIndentation:function(e,t){for(var a=[],n=0,r=e.length;n<r;n++){for(var i=(A=e[n]).parentNode,o=!1;i;){if(e.indexOf(i)>=0){o=!0;break}i=i.parentNode}o||a.push(A)}(e=a).sort(function(e,t){return e.data.TaskSequenceId-t.data.TaskSequenceId});var s=[],l=[],d=[],p=[],c=!0;for(n=e.length-1;n>=0;n--){var u=(A=e[n]).data.PercentDone;if(A.previousSibling&&("ProjectSpace"==A.previousSibling.get("EnglishType")||"ProjectConcept"==A.previousSibling.get("EnglishType")||"Experiment"==A.previousSibling.get("EnglishType"))&&e.indexOf(A.previousSibling)<0)for(var f=!0;f;){if(A.previousSibling=A.previousSibling.previousSibling,A.previousSibling)"Task"!=(y=A.previousSibling.get("EnglishType"))&&"Phase"!=y&&"Gate"!=y&&"Milestone"!=y||(f=!1);else f=!1}if(A.previousSibling&&100==A.previousSibling.get("PercentDone")&&0==t){c=!1;break}if(100!=u)if(t){if(null==A.parentNode.get("TaskProjectId")){s.push(A.get("Name")),e.splice(n,1);continue}}else{if(null!=A.previousSibling){var g=A.previousSibling,m=g.get("EnglishType");if("Gate"==m||"Milestone"==m||"TRUE"==g.get("passiveSubtask")){if(e.indexOf(g)>=0){for(var h=!0;h;)if(null!=(g=g.previousSibling)){var y=g.get("EnglishType"),S=g.get("passiveSubtask");if(e.indexOf(g)<0){"Gate"==y||"Milestone"==y||"TRUE"==S?c=!1:h=!1;break}}else h=!1;continue}c=!1;break}}if(null==A.previousSibling){l.push(A.get("Name")),e.splice(n,1);continue}}else d.push(A.get("Name")),e.splice(n,1)}var v="",T=!0;if(!c){for(n=0,r=e.length;n<r;n++){var A=e[n];p.push(A.get("Name"))}e=[],v=v+App.Nls["emxProgramcentral.Milestone.SubtaskCreationAlert"]+"\n"+p+"\n"}return s.length>0&&(v=v+App.Nls["emxProgramcentral.TaskIndentaion.NoLeftIndentAlert"]+"\n"+s+"\n"),l.length>0&&(v=v+App.Nls["emxProgramcentral.TaskIndentaion.NoRightIndentAlert"]+"\n"+l+"\n"),d.length>0&&(v=v+App.Nls["emxProgramCentral.TaskDragdrop.TaskInReviewState"]+"\n"+d+"\n"),""!=v&&(T=confirm(v)),T||(e=[]),e},syncAjaxCall:function(e,t){null!=t&&""!=t||(t="GET");var a="",n={url:e,type:t,async:!1,dataType:"json",callback:function(e){a=e}};return"undefined"==typeof widget?Ext.Ajax.request({url:e,async:!1,success:function(e){var t=JSON.parse(e.responseText.trim());n.callback(t)}}):r(n),a},getGanttItem:function(e,t){for(var a=e.items.items,n=0,r=a.length;n<r;n++)if(itemIdValue=a[n].id,t===itemIdValue){var i=a[n];break}return i},getTaskAndProjectModelFields:function(){var e=new Array,t=App.Infra.Columns,a=t.length;for(e.push({name:"TaskProjectId",mapping:"TaskProjectId"}),e.push({name:"ExternalDependencies",mapping:"ExternalDependencies"}),e.push({name:"ExternalRawDependencies",mapping:"ExternalRawDependencies"}),e.push({name:"hasEditAccess",mapping:"hasEditAccess"}),e.push({name:"Color",mapping:"Color",type:"string"}),e.push({name:"Pattern",mapping:"Pattern"}),e.push({name:"EnglishType",mapping:"EnglishType"}),e.push({name:"BaselineDuration",mapping:"BaselineDuration"}),idx=0;idx<a;idx++){var n=t[idx],r=n.dataIndex,i=n.xtype,o=n.excludeInRefinement;"datecolumn"==i?e.push({name:r,mapping:r,excludeInRefinement:o,type:"date",dateFormat:"c"}):e.push({name:r,mapping:r,excludeInRefinement:o})}return e},doBasicEditChecks:function(e){if(0==e.data.hasEditAccess)return!1;var t=Ext.ComponentQuery.query("#dpmprojectgantt")[0].taskStore.getRoot().childNodes[0];return t.data.State!=App.Nls.Cancel&&("Cancel"!=t.data.experimentProjectState&&"Hold"!=t.data.experimentProjectState)}}});