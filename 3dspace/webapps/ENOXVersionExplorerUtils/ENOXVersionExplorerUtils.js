define("DS/ENOXVersionExplorerUtils/VersionExplorerEnums",function(){"use strict";var e={semantics:{E:{tag:"EVOLUTION",icon:"I_MajorVersion.png"},F:{tag:"FIX",icon:"I_Evolution.png"},PS:{tag:"PARTIALSTUDY",icon:"I_Evolution.png"},S:{tag:"STUDY",icon:"I_Evolution.png"},B:{tag:"BRANCH",icon:"I_Evolution.png"},M:{tag:"MAIN",icon:"I_MajorVersion.png"},MI:{tag:"MINOR",icon:"I_MinorVersion.png"},SO:{tag:"SPINOFF",icon:"I_Duplicate.png"},SP:{tag:"SPLIT",icon:"I_Evolution.png"},I:{tag:"INTEGRATE",icon:"I_NewRevisionFrom32.png"},D:{tag:"DERIVATIVE",icon:"I_Evolution.png"},IM:{tag:"IMPORT",icon:"I_NewRevisionFrom32.png"}},historySemantics:{revision:{symbol:"E",icon:"I_MajorVersion.png"},minorRevision:{symbol:"E",icon:"I_MinorVersion.png"},revisionFrom:{symbol:"E",icon:"I_NewRevisionFrom32.png"},minorRevisionFrom:{symbol:"E",icon:"I_NewMinorUsingDistantData.png"},evolution:{symbol:"SP",icon:"I_Evolution.png"},duplicate:{symbol:"SO",icon:"I_Duplicate.png"}},DISPLAY_MODES:{THUMBNAIL_VIEW:1,SUBWAY_VIEW:2},DATA_MODEL_TYPES:{MODEL_P:1,MODEL_ER:2,MODEL_P_PRIME:3,MODEL_RDF:4,MODEL_REVISION:5,MODEL_HISTORY:6,MODEL_CUSTOM:7},SUBTITLE_KEYS:{NONE:"",MATURITY:"maturity",REVISION:"code"},THUMBNAIL_GRAPH_LAYOUT:{ROOT_ON_TOP:0,ROOT_ON_LEFT:1,ROOT_ON_BOTTOM:2,ROOT_ON_RIGHT:3},SELECTION_MODES:{MULTI_SELECT_ONLY:1,SINGLE_SELECT_ONLY:2,WITH_COMMANDS:4,MULTI_SELECT_ACTIVE:8,ALLOW_DND:16},SUBWAY_VIEW_MODE:{SUBWAY_COMPACT_VIEW:26,SUBWAY_COMFORTABLE_VIEW:38}};return e}),define("DS/ENOXVersionExplorerUtils/ArrayFunctions",["DS/LifecycleDAGUtils/ArrayFunctions"],function(e){"use strict";return e}),define("DS/ENOXVersionExplorerUtils/ColumnList",["DS/ENOXVersionExplorerUtils/VersionExplorerEnums","DS/LifecycleServices/LifecycleServices"],function(e,t){return function(e){return{columns:[{dbKey:"thumbnail",outputKey:"thumbnail",columnNLS:t.getAttributeDisplayName("displayThumbnails")},{dbKey:"name",outputKey:"name",columnNLS:t.getAttributeDisplayName("LifecycleObjectList_name")},{dbKey:"revision",outputKey:"code",columnNLS:t.getAttributeDisplayName("revision")},{dbKey:"maturity",outputKey:"maturity_nls",columnNLS:t.getAttributeDisplayName("maturitystate")},{dbKey:"created",outputKey:"creationDate",columnNLS:t.getAttributeDisplayName("creationDate")},{dbKey:"modified",outputKey:"modified",columnNLS:t.getAttributeDisplayName("modified")},{dbKey:"description",outputKey:"description",columnNLS:t.getAttributeDisplayName("description")},{dbKey:"EnterpriseExtension.V_PartNumber",outputKey:"EnterpriseExtension.V_PartNumber",columnNLS:t.getAttributeDisplayName("EnterpriseExtension.V_PartNumber")},{dbKey:"owner",outputKey:"ownerName",columnNLS:t.getAttributeDisplayName("owner")},{dbKey:"policy",outputKey:"policy_nls",columnNLS:t.getAttributeDisplayName("policy")},{dbKey:"type",outputKey:"type_nls",columnNLS:t.getAttributeDisplayName("type")},{dbKey:"project",outputKey:"project_nls",columnNLS:t.getAttributeDisplayName("project")},{dbKey:"ispublished",outputKey:"ispublished",columnNLS:t.getAttributeDisplayName("ispublished")},{dbKey:"reserved",outputKey:"reserved",columnNLS:t.getAttributeDisplayName("reserved")},{dbKey:"reservedby",outputKey:"reservedbyName",columnNLS:t.getAttributeDisplayName("reservedby")},{dbKey:"organization",outputKey:"organization_nls",columnNLS:t.getAttributeDisplayName("organization")},{dbKey:"PLMReference.V_versionComment",outputKey:"PLMReference.V_versionComment",columnNLS:t.getAttributeDisplayName("PLMReference.V_versionComment")},{dbKey:"vault",outputKey:"vault",columnNLS:t.getAttributeDisplayName("vault")}],resetGraphView:[{name:"title",isSelected:!0,disabled:!1,displayName:t.getAttributeDisplayName("LifecycleObjectList_title")}],resetGraphListView:[{name:"title",isSelected:!0,disabled:!0,displayName:t.getAttributeDisplayName("LifecycleObjectList_title")},{name:"revision",isSelected:!0,disabled:!1,displayName:t.getAttributeDisplayName("revision")},{name:"maturity",isSelected:!0,disabled:!1,displayName:t.getAttributeDisplayName("maturitystate")},{name:"created",isSelected:!0,disabled:!1,displayName:t.getAttributeDisplayName("creationDate")},{name:"modified",isSelected:!0,disabled:!1,displayName:t.getAttributeDisplayName("modified")},{name:"description",isSelected:!0,disabled:!1,displayName:t.getAttributeDisplayName("description")}],defaultCols:["revision","maturity","created","modified","description"],excludeFromQuery:["code","thumbnail","maturity","created","modified","description"]}}}),define("DS/ENOXVersionExplorerUtils/VersionExplorerEventArgs",["DS/ENOXVersionExplorerUtils/VersionExplorerEnums"],function(e){return function(e,t,i,n,o){this.id=e,this.tenant=t,this.context=i,this.securityContext=n,this.dataType=dataType,this.onComplete=o}}),define("DS/ENOXVersionExplorerUtils/VersionExplorerSettings",["UWA/Core","UWA/Class","UWA/Promise","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","DS/WidgetServices/WidgetServices","DS/WAFData/WAFData"],function(e,t,i,n,o,s){"use strict";return t.singleton({_userSettingsLoaded:!1,UserSettings:{displayMode:n.DISPLAY_MODES.SUBWAY_VIEW,displayThumbnailOverview:!0,thumbnailGraphLayout:"ROOT_ON_BOTTOM",displayLegend:!0,subtitleKey:n.SUBTITLE_KEYS.REVISION,subwaySortAscending:!1,subwayViewMode:"SUBWAY_COMFORTABLE_VIEW",highlightParentConnectionsOnSelect:!0,displayHelp:!1,displayDuplicates:!1},ENABLE_SUBWAY_VIEW:!0,ENABLE_THUMBNAIL_VIEW:!0,POLL_UPDATE_THUMBNAIL:!1,X_DESIGN:!1,_saveUserSettings:function(e,t,i,n,r){if(e&&null!=t&&(this.UserSettings[e]=t),!0===i){var a=this;o.getCompassUrlAsync({onComplete:function(e){a._widget.getValue("x3dPlatformId");var t=encodeURI(e+"/resources/AppsMngt/user/setPreferences?name="+n+"&value="+JSON.stringify(a.UserSettings));s.authenticatedRequest(t,{method:"GET",timeout:5e3,headers:{Accept:"application/json",SecurityContext:void 0},onComplete:function(e){console.log("PICK COMPARE DIALOG: success setting ")},onFailure:function(e){console.log("PICK COMPARE DIALOG: failed setting ")},cache:!1})}})}else this._widget&&!i&&null==r?this._widget.setValue("ENOXVersionExplorer.UserSettings",this.UserSettings):window.localStorage.setItem("ENOXVersionExplorer.UserSettings",JSON.stringify(this.UserSettings))},_RDF_SETTINGS:{_BASE_URL:"",_DEBUG_MODE:!1,_VERSION_DATAMODEL_TYPE:"dslc:ItemVersion"},loadUserSettingsPromise:function(t,r,a,l,u){var c,p,d=this;return t=t||{},new i(function(i,g){if(!0===a)d=d,o.getCompassUrlAsync({onComplete:function(o){d.tenant=d._widget.getValue("x3dPlatformId");var c=o+"/resources/AppsMngt/user/getPreferences?name="+l;s.authenticatedRequest(c,{method:"GET",timeout:5e3,headers:{Accept:"application/json",SecurityContext:void 0},cache:!1,onComplete:function(o){if(console.log("PICK COMPARE DIALOG: success getting value"),null!=o&&""!=o)d.UserSettings=JSON.parse(o);else{var s=d._widget&&null==u?d._widget.getValue("ENOXVersionExplorer.UserSettings"):window.localStorage.getItem("ENOXVersionExplorer.UserSettings");s&&"string"==typeof s&&(s=JSON.parse(s)),s&&(d.UserSettings=s)}for(var c in t)null==t[c]&&(console.warn("Version Explorer Initial Settings: "+c+" has not been set. Using default"),t[c]=d.UserSettings[c]);d.userSettingsLoaded||(t.subwayViewMode&&s&&!s.subwayViewMode&&(s.subwayViewMode=t.subwayViewMode),t.displayDuplicates&&d.UserSettings&&!d.UserSettings.displayDuplicates&&(d.UserSettings.displayDuplicates=t.displayDuplicates),d._userSettingsLoaded=!0,d.UserSettings.displayMode=!0===d.ENABLE_THUMBNAIL_VIEW?d.UserSettings.displayMode:n.DISPLAY_MODES.SUBWAY_VIEW,d.UserSettings.displayMode=!0===d.ENABLE_SUBWAY_VIEW?d.UserSettings.displayMode:n.DISPLAY_MODES.THUMBNAIL_VIEW),(!0===r||!0===p)&&e.extend(d.UserSettings,t),(!0===r||!0===p)&&d._saveUserSettings(null,null,a,l,u),i()},onFailure:function(e){console.log("PICK COMPARE DIALOG: failed getting value")}})}});else{for(var E in t)null==t[E]&&(console.warn("Version Explorer Initial Settings: "+E+" has not been set. Using default"),t[E]=d.UserSettings[E]);d.userSettingsLoaded||((c=d._widget&&null==u?d._widget.getValue("ENOXVersionExplorer.UserSettings"):window.localStorage.getItem("ENOXVersionExplorer.UserSettings"))&&"string"==typeof c&&(c=JSON.parse(c)),t.subwayViewMode&&c&&!c.subwayViewMode&&(c.subwayViewMode=t.subwayViewMode),t.displayDuplicates&&c&&!c.displayDuplicates&&(c.displayDuplicates=t.displayDuplicates),!c&&(p=!0,c=t),e.extend(d.UserSettings,c),d._userSettingsLoaded=!0,d.UserSettings.displayMode=!0===d.ENABLE_THUMBNAIL_VIEW?d.UserSettings.displayMode:n.DISPLAY_MODES.SUBWAY_VIEW,d.UserSettings.displayMode=!0===d.ENABLE_SUBWAY_VIEW?d.UserSettings.displayMode:n.DISPLAY_MODES.THUMBNAIL_VIEW),(!0===r||!0===p)&&e.extend(d.UserSettings,t),(!0===r||!0===p)&&d._saveUserSettings(null,null,a,l,u),i()}})}})}),define("DS/ENOXVersionExplorerUtils/ENOXVersionExplorerUtils",["DS/ENOXVersionExplorerUtils/VersionExplorerEnums","DS/ENOXVersionExplorerUtils/ArrayFunctions","DS/ENOXVersionExplorerUtils/VersionExplorerSettings","DS/TreeModel/TreeNodeModel"],function(e,t,i,n){var o={getSanitizedID:function(e){if(32===e.length)return e;var t=e.search("pid:");return t>=0?e.slice(t+4):e},getSemanticSymbol:function(t){if(t)for(var i in e.semantics)if(e.semantics[i].tag.toUpperCase()===t.toUpperCase()||i===t.toUpperCase())return i},getSemanticDescription:function(t){if(t)for(var i in e.semantics)if(e.semantics[i].tag.toUpperCase()===t.toUpperCase()||i===t.toUpperCase())return e.semantics[i].tag},getSemanticIcon:function(t){if(t)for(var i in e.semantics)if(e.semantics[i].tag.toUpperCase()===t.toUpperCase()||i===t.toUpperCase())return e.semantics[i].icon},getNextRevision:function(e){for(var i=new t.CircularArray(["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]),n=!1,o=(r=e.split("")).length-1;o>=0;o++)if(i.setCurrent(r[o])>=0){var s=i.next();if(r[o]=s.value,0!==s.index)break;0===o&&(n=!0)}var r;return!0===n&&r.insert("A",0),r=r.join("")},getHistoryCustomAttribute:function(e){var t,o=e instanceof n?e.options.grid:e,s=i.historyConfig;if(null!=e&&s&&Array.isArray(s.historyConfig))for(var r=s.historyConfig,a=r.length,l=0;l<a;l++){var u=r[l];if(null!=o[u.attribute]&&null!=u.value&&o[u.attribute]===u.value||null!=o[u.attribute]&&null==u.value){t=u;break}}return t}};return o}),define("DS/ENOXVersionExplorerUtils/RevisionsTabFacet",["UWA/Core","UWA/Class","UWA/Controls/Abstract","UWA/Widget","DS/EditPropWidget/facets/Common/FacetsBase","DS/ApplicationFrame/ActionBar","DS/ENOXVersionExplorerController/VersionExplorerController","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","DS/ENOXVersionExplorerUtils/VersionExplorerSettings","DS/LifecycleServices/LifecycleServicesSettings","DS/LifecycleServices/LifecycleServices","DS/LifecycleServices/LifecycleAlert","DS/PlatformAPI/PlatformAPI","DS/ApplicationFrame/CommandsManager"],function(UWA,Class,Abstract,Widget,FacetsBase,ActionBar,VersionExplorerController,VersionExplorerEnums,VersionExplorerSettings,LifecycleServicesSettings,LifecycleServices,LifecycleAlert,PlatformAPI,AFRCommandsManager){"use strict";var RevisionsTabFacet=Class.extend(Abstract,FacetsBase,{init:function(e){this._parent(e),this._buildView(e)},_buildView:function(options){var that=this;if(!this.versionExplorer){this.cacheType="",PlatformAPI.subscribe("Lifecycle.Modification",function(e){that.versionExplorer.publishEvent("_ENOXVersionExplorerInternalRefresh",{reframe:!1,contextualMenu:!1})}),this.elements.container=UWA.createElement("div",{class:"revisionsContainer"}),this.widget=new Widget,this.widget.setValue("TemporaryPropertiesWidget",!0);var cmd=AFRCommandsManager.getCommand("RevisionHdr",this.widget);if(!cmd){this._commandGenerationRequired=!0;var action_bar="prop_lifecycle.xml";this._actionBar=new ActionBar({context:this,file:action_bar,module:"LifecycleWidget"})}var selectionType=VersionExplorerEnums.SELECTION_MODES.SINGLE_SELECT_ONLY;selectionType|=VersionExplorerEnums.SELECTION_MODES.WITH_COMMANDS;var WebToWinComSocket=void 0;this.options.context&&this.options.context._context&&this.options.context._context.options&&(WebToWinComSocket=this.options.context._context.options.webToWinComSocket),this.versionExplorer=new VersionExplorerController({versionGraphContainer:this.elements.container,widget:this.widget,webToWinComSocket:WebToWinComSocket,useGlobalStorage:!0,globalStorageName:"PropertiesUserSettings",readOnly:this.options.readOnly,selectionMode:selectionType,autoUpdate:!1}),this.versionExplorer.subscribeEvent("ENOXVersionExplorerLoadCompleted",function(e){!0===that.versionExplorer._setUseWebCommandsOnNative()&&that.versionExplorer.setCheckVersionExternalFunction("ENOXVersionExplorerOpenWith",function(e){return!1})},!1),that.versionExplorer.subscribeEvent("_ENOXVersionExplorerInternalRefreshCompleted",function(e){},!1),this.versionExplorer.setCheckVersionExternalFunction("ENOXVersionExplorerDisplayProperties",function(e){return!1}),this.versionExplorer.setCheckVersionExternalFunction("ENOXVersionExplorerOpenVersion",function(e){return!1});var data=[];"string"==typeof options.infoForFacet?data=JSON.parse(options.infoForFacet):options.infoForFacet?data=options.infoForFacet:options.infoForCustomization&&(data=options.infoForCustomization);var customizations=data.VersionExplorerCustomization?data.VersionExplorerCustomization:data.VersionExplorerFacet,versionExplorer=that.versionExplorer;if(customizations)for(var ii=0;ii<customizations.length;ii++){var func="string"==typeof customizations[ii]?eval("("+customizations[ii]+")"):customizations[ii];"function"==typeof func&&func()}}},updateFacet:function(){var e=this.getModel();if(e){var t=this;LifecycleServices.getHistoryConfigPromise().then(function(e){VersionExplorerSettings.historyConfig=e},function(){VersionExplorerSettings.historyConfig=null}),LifecycleServicesSettings.app_initialization(function(){var i=e.getTenant();void 0===i&&t.options.context&&t.options.context._context&&(i=t.options.context._context.tenant);e.getAllAttributes();var n=e.get("objectId"),o=e.get("type"),s=e.get("_DS_ATTR_type"),r=void 0;null!=s&&(r=null!=s.valueDB?s.valueDB:s),null==r&&(r=null!=o?o.valueDB:t.cacheType),t.cacheType=r;var a=VersionExplorerEnums.DATA_MODEL_TYPES.MODEL_HISTORY;t.widget.setValue("x3dPlatformId",i),LifecycleServices.getSecurityContextPromise(t.widget.getValue("x3dPlatformId")).then(function(e){var o={displayLegend:!1};VersionExplorerSettings.historyConfig&&VersionExplorerSettings.historyConfig.settings&&(VersionExplorerSettings.historyConfig.settings.defaultView&&(o.displayMode=VersionExplorerEnums.DISPLAY_MODES[VersionExplorerSettings.historyConfig.settings.defaultView]),VersionExplorerSettings.historyConfig.settings.thumbnailGraph&&(VersionExplorerSettings.historyConfig.settings.thumbnailGraph.thumbnailGraphLayout&&(o.thumbnailGraphLayout=VersionExplorerSettings.historyConfig.settings.thumbnailGraph.thumbnailGraphLayout),VersionExplorerSettings.historyConfig.settings.thumbnailGraph.displayThumbnailOverview&&(o.displayThumbnailOverview="true"===VersionExplorerSettings.historyConfig.settings.thumbnailGraph.displayThumbnailOverview)),VersionExplorerSettings.historyConfig.settings.subwayGraph&&(VersionExplorerSettings.historyConfig.settings.subwayGraph.subwaySort&&(o.subwaySortAscending="asc"===VersionExplorerSettings.historyConfig.settings.subwayGraph.subwaySort),"SUBWAY_COMPACT_VIEW"!==VersionExplorerSettings.historyConfig.settings.subwayGraph.viewMode&&"SUBWAY_COMFORTABLE_VIEW"!==VersionExplorerSettings.historyConfig.settings.subwayGraph.viewMode||(o.subwayViewMode=VersionExplorerSettings.historyConfig.settings.subwayGraph.viewMode)),VersionExplorerSettings.historyConfig.settings.defaultDisplayDuplicates&&(o.displayDuplicates="true"===VersionExplorerSettings.historyConfig.settings.defaultDisplayDuplicates)),VersionExplorerSettings.loadUserSettingsPromise(o,!1,!0,"PropertiesUserSettings",t.versionExplorer._getWebInWinSocket()).then(function(){t.versionExplorer.publishEvent("ENOXVersionExplorerLoadVersionModel",{id:n,tenantId:i,type:r,securityContext:e,dataModelType:a})})})})}else console.warn("No Model")},hide:function(){this._parent.apply(this,arguments),this._isVisible=!1},show:function(){this._parent.apply(this,arguments),this._isVisible=!0},destroyComponent:function(){this.cacheType="",this.widget=null,this._isVisible=!1,this._actionBar=null,this.onClose()},onClose:function(){if(this.versionExplorer._getWebInWinSocket()){VersionExplorerSettings.loadUserSettingsPromise({displayLegend:!1},!1,!1,"",this.versionExplorer._getWebInWinSocket()).then(function(){})}this._commandGenerationRequired&&delete AFRCommandsManager._commands[this.widget],this._commandGenerationRequired=!1,this._generatedCommands=void 0},onResize:function(){},onRefresh:function(){this.updateFacet()},onAction:function(e){this.getModel()},isActionAvailable:function(e){return!0}});return RevisionsTabFacet});