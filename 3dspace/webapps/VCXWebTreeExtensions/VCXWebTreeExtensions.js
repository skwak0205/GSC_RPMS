define("DS/VCXWebTreeExtensions/VCXATreeNode",["UWA/Class","DS/VCXWebKernelCommands/VCXCmdChangeVisibility","DS/RuntimeView/RSCManager"],function(e,t,n){"use strict";return e.extend({init:function(){this._rscUrlMap={},this._treeNodesModelsMap={}},SetNewTreeNodeModel:function(e,t){this._treeNodesModelsMap[t]||(this._treeNodesModelsMap[t]={});var n=e._getID();if(this._treeNodesModelsMap[t][n])throw new Error("ID already used");this._treeNodesModelsMap[t][n]=e},UnsetTreeNodeModel:function(e,t){var n=e._getID();this._treeNodesModelsMap[t]&&this._treeNodesModelsMap[t][n]===e&&delete this._treeNodesModelsMap[t][n],0===Object.getOwnPropertyNames(this._treeNodesModelsMap[t]).length&&delete this._treeNodesModelsMap[t]},_storeTreeNodeModelsFromTreeType:function(e){var t=[];for(var n in this._treeNodesModelsMap[e])this._treeNodesModelsMap[e].hasOwnProperty(n)&&t.push(this._treeNodesModelsMap[e][n]);return t},GetTreeNodesModelsFromTree:function(e){var t=[];if(e)t=t.concat(this._storeTreeNodeModelsFromTreeType(e));else for(var n in this._treeNodesModelsMap)this._treeNodesModelsMap.hasOwnProperty(n)&&(t=t.concat(this._storeTreeNodeModelsFromTreeType(n)));return t},hasTreeNodeModels:function(e){return"string"!=typeof e?Object.keys(this._treeNodesModelsMap).length>0:void 0!==this._treeNodesModelsMap[e]},SetVisibility:function(e){var n=this.GetObject()._experienceBase,r=n.getManager("VCXScenarioManager"),o=n.getManager("VCXCommandManager"),i=new t(r,n.ComponentsMap,o);return i.ChangeVisibility([this.GetObject()],e),o.Push(i),!0},GetVisibility:function(){var e=null,t=this.GetObject().QueryInterface("VCXIVisibility");return t&&(e=t.GetVisibility()),e},GetName:function(){var e=this.GetObject().QueryInterface("VCXIModifiable"),t=e&&e.GetProperty("Actor.Name"),n=t&&t.GetPropertyValue().GetValue();return n||(n=""),n},GetParent:function(){var e=null,t=this.GetObject().QueryInterface("VCXIModelNavigable"),n=t&&t.getParent();return n&&(e=n.QueryInterface("VCXITreeNode")),e},GetChildren:function(){var e=[],t=this.QueryInterface("VCXIModelNavigable");if(!t)return console.log("Something wrong, no ModelNavigable extension found for specified treenode."),e;for(var n=t.getChildren(),r=0;r<n.length;r++){var o=n[r].QueryInterface("VCXITreeNode");o&&e.push(o)}return e},getTreeNodeComponentIcon:function(){},_loadIconFromFilenameAndKey:function(e,t){if(e&&t){var r=this;this._rscUrlMap[e+"."+t]?this._setIconOnceLoaded(this._rscUrlMap[e+"."+t]):(n.loadResource({resourceFile:e}),n.onResourceLoaded({resourceFile:e},function(){var n=this.getIcon({key:t,size:"Normal"});n&&(r._setIconOnceLoaded(n),r._rscUrlMap[e+"."+t]=n)}))}},_setIconOnceLoaded:function(e){for(var t=this.GetTreeNodesModelsFromTree(),n=0;n<t.length;++n){var r=t[n].options.icons;Array.isArray(r)&&r[0]===e||t[n].updateOptions({icons:[e]})}},getTreeNodeVisibilityIcon:function(){var e=this.GetVisibility(),t=null;if("number"==typeof e){var r=1===e?"Visible":0===e?"Invisible":-1===e?"PartialVisible":console.warn("VisibilityStatus not recognized..");return n.onResourceLoaded({resourceFile:"VCXWebGUI/VCXWebTreeExtensions"},function(){t=this.getIcon({key:r,size:"Normal"})}),t}},Dispose:function(){for(var e in this._treeNodesModelsMap)if(this._treeNodesModelsMap.hasOwnProperty(e)){for(var t in this._treeNodesModelsMap[e])if(this._treeNodesModelsMap[e].hasOwnProperty(t)){this._treeNodesModelsMap[e][t];this._treeNodesModelsMap[e][t]=null}this._treeNodesModelsMap[e]=null}this._treeNodesModelsMap={}}})}),define("DS/VCXWebTreeExtensions/VCXTreeNodeOccurrence",["DS/VCXWebTreeExtensions/VCXATreeNode"],function(e){"use strict";var t={Root:{fileName:"VCXWebTreeGUI/VCXWebTreeGUI",key:"TreeNode.Root"},VCXComponentOccurrenceComposer:{fileName:"VCXWebTreeGUI/VCXWebTreeGUI",key:"TreeNode.GroupAsset"},VCXComponentOccurrenceSMG:{fileName:"VCXWebTreeGUI/VCXWebTreeGUI",key:"TreeNode.GroupAsset"},VCXComponentAssetOccurrenceComposer:{fileName:"VCXWebTreeGUI/VCXWebTreeGUI",key:"TreeNode.GroupAsset"},VCXComponentMesh:{fileName:"VCXWebTreeGUI/VCXWebTreeGUI",key:"TreeNode.Group"},VCXComponentMeshPrimitive:{fileName:"VCXWebTreeGUI/VCXWebTreeGUI",key:"TreeNode.Primitive"},VCXComponentCompositePmi:{fileName:"VCXWebDressup/VCXWebDressup",key:"TreeNode.PMIs.Root"},VCXComponentCurveWire:{fileName:"VCXWebTreeGUI/VCXWebTreeGUI",key:"TreeNode.CurveWire"},VCXComponentPoint:{fileName:"VCXWebTreeGUI/VCXWebTreeGUI",key:"TreeNode.Point"},VCXComponentHotspot:{fileName:"VCXWebTreeGUI/VCXWebTreeGUI",key:"TreeNode.Hotspot"},CXPExperience_Spec:{fileName:"VCXWebTreeGUI/VCXWebTreeGUI",key:"TreeNode.Root"},Model_VPMReference_Spec:{fileName:"VCXWebTreeGUI/VCXWebTreeGUI",key:"TreeNode.GroupAsset"},VCXComponentVPMReference:{fileName:"VCXWebTreeGUI/VCXWebTreeGUI",key:"TreeNode.GroupAsset"},VCXComponentGroupHotspot:{fileName:"VCXWebTreeGUI/VCXWebTreeGUI",key:"TreeNode.Hotspot"}};return e.extend({init:function(){this._parent()},GetName:function(){return this._parent()},getTreeNodeComponentIcon:function(){var e,n,r=this.GetObject().GetType();r?(this.GetParent()||"VCXComponentOccurrenceSMG"!==r&&"VCXComponentOccurrenceComposer"!==r||(r="Root"),this.GetObject().IsMesh&&this.GetObject().IsMesh()&&(r="VCXComponentMesh"),n=t[r].fileName,e=t[r].key,this._loadIconFromFilenameAndKey(n,e)):console.warn("Cannot get the component type. The component icon cannot be fetched.")}})}),define("DS/VCXWebTreeExtensions/VCXTreeNodeStyle",["DS/VCXWebTreeExtensions/VCXATreeNode"],function(e){"use strict";return e.extend({init:function(){this._parent()},getTreeNodeComponentIcon:function(){this._loadIconFromFilenameAndKey("VCXWebDressup/VCXWebDressup","TreeNode.Markups.Root")}})}),define("DS/VCXWebTreeExtensions/VCXTreeNodeDiggerGrp",["DS/VCXWebTreeExtensions/VCXATreeNode"],function(e){"use strict";return e.extend({init:function(){this._parent()},getTreeNodeComponentIcon:function(){var e="TreeNode."+this.GetObject().getName()+".Root";this._loadIconFromFilenameAndKey("VCXWebDigger/VCXWebDigger",e)}})}),define("DS/VCXWebTreeExtensions/VCXTreeNodeDressup",["DS/VCXWebTreeExtensions/VCXATreeNode"],function(e){"use strict";var t={VCXLabel_Spec:{key:"Label"},VCXCallout_Spec:{key:"Callout"},CXPCameraActor_Spec:{key:"Camera"},VCXSection_Spec:{key:"Section"},VCXComponentGround:{key:"Ground"},VCXViewport_Spec:{key:"Viewport"},AmbienceModel_Spec:{key:"AmbienceModel_Spec"},VCXCompass_Spec:{key:"Compass"},VCXLinearArrow_Spec:{key:"LinearArrow"},VCXCircularArrow_Spec:{key:"CircularArrow"},VCXCornerArrow_Spec:{key:"CornerArrow"},VCXCircle_Spec:{key:"Circle"},VCXPolyline_Spec:{key:"Polyline"},VCXComponentMeshPrimitive:{key:"Primitive"},CIDPrimitive_Spec:{key:"Primitive"},VCXRedLine_Spec:{key:"RedLine"},VCXMeasurement_Spec:{key:"Measurement"},VCXBOM_Spec:{key:"BOM"},VCXPanel_Spec:{key:"Panel"},VCXDiggerPanel_Spec:{key:"DiggerPanel"},VCXComponentAssociativePath:{key:"AssociativePath"}};return e.extend({init:function(){this._parent()},getTreeNodeComponentIcon:function(){var e=this._getIconFileName(),t=this._getIconKey(),n=this.GetObject().dressupGroupName;if(n&&t){var r="TreeNode."+n+"."+t;this._loadIconFromFilenameAndKey(e,r)}},_getIconFileName:function(){return"VCXWebDressup/VCXWebDressup"},_getIconKey:function(){var e=this.GetObject().GetType();return e?t[e]?t[e].key:"":(console.warn("Cannot get the component type. The component icon cannot be fetched."),"")}})}),define("DS/VCXWebTreeExtensions/VCXTreeNodeDigger",["DS/VCXWebTreeExtensions/VCXTreeNodeDressup"],function(e){"use strict";return e.extend({init:function(){this._parent()},_getIconFileName:function(){return"VCXWebDigger/VCXWebDigger"},_getIconKey:function(){return"Digger"}})}),define("DS/VCXWebTreeExtensions/VCXTreeNodeAmbience",["DS/VCXWebTreeExtensions/VCXTreeNodeDressup","DS/VCXWebKernelCommands/VCXCmdChangePropertiesAutokey","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyValueLink"],function(e,t,n,r,o){"use strict";return e.extend({SetVisibility:function(e){var i=this.GetObject()._experienceBase,s=i.getManager("VCXContextManager").getActiveViewport();if(s){var a=s.QueryInterface("VCXIModifiable");if(a){var c="";e&&(c=this.GetObject().GetID());var C=new o(c),d=new n(new r("Viewport.ActiveAmbience",0),C),l=new t(i.getManager("VCXScenarioManager"),i.getManager("VCXCommandManager"),!0);l.ChangeProperty(a,d),i.getManager("VCXCommandManager").Push(l)}}return this._parent(1)},GetVisibility:function(){return this.GetObject()._experienceBase.getManager("VCXContextManager").getActiveViewport().getActiveAmbienceID()===this.GetObject().GetID()?1:0}})}),define("DS/VCXWebTreeExtensions/VCXTreeNodeVisibilityFromChildren",["DS/VCXWebTreeExtensions/VCXATreeNode","DS/VCXWebKernelCommands/VCXCmdChangeVisibility"],function(e,t){"use strict";return e.extend({init:function(){this._parent()},getTreeNodeComponentIcon:function(){var e,t,n=this.GetObject().GetType();n?(t=_compTypeRscMap[n].fileName,e=_compTypeRscMap[n].key,this._loadIconFromFilenameAndKey(t,e)):console.warn("Cannot get the component type. The component icon cannot be fetched.")},SetVisibility:function(e){var n=this.GetObject();if(!n)return console.log("There shouldn't be this case..."),!1;if("EnvironmentID"==n.GetID())return!0;var r=n.QueryInterface("VCXIModelNavigable").getChildren(),o=[];if(0===r.length)this._visible=1;else{for(var i=0;i<r.length;++i){var s=r[i];o.push(s.GetObject())}var a=n._experienceBase,c=a.getManager("VCXScenarioManager"),C=a.getManager("VCXCommandManager"),d=new t(c,a.ComponentsMap,C);d.ChangeVisibility(o,e),C.Push(d)}return!0},GetVisibility:function(){var e,t=this.GetObject();if(t){if("EnvironmentID"==t.GetID())return-2;var n=t.QueryInterface("VCXIModelNavigable"),r=n&&n.getChildren();if(r){if(0===r.length)e=this._visible;else for(var o=0;o<r.length&&-1!==e;o++){var i=r[o];if(i){var s=i.QueryInterface("VCXIVisibility");s&&(void 0===e?e=s.GetVisibility():e!==s.GetVisibility()&&(e=-1))}}return e}console.log("No navigable is linked to this component..")}else console.log("This shouldn't happen.")}})}),define("DS/VCXWebTreeExtensions/VCXTreeNodeDressupGrp",["DS/VCXWebTreeExtensions/VCXTreeNodeVisibilityFromChildren"],function(e){"use strict";return e.extend({init:function(){this._parent()},getTreeNodeComponentIcon:function(){var e,t=this.GetObject().getName();e="Diggers"===t?"VCXWebDigger/VCXWebDigger":"VCXWebDressup/VCXWebDressup";var n="TreeNode."+t+".Root";this._loadIconFromFilenameAndKey(e,n)},GetName:function(){return this.GetObject().getNLSName()}})}),define("DS/VCXWebTreeExtensions/VCXTreeNodeSelectionSet",["DS/VCXWebTreeExtensions/VCXTreeNodeVisibilityFromChildren"],function(e){"use strict";var t={VCXComponentSelectionSet:{fileName:"VCXWebTreeGUI/VCXWebTreeGUI",key:"TreeNode.SelectionSet"},VCXComponentGroupSelectionSet:{fileName:"VCXWebTreeGUI/VCXWebTreeGUI",key:"TreeNode.SelectionSet"}};return e.extend({init:function(){this._parent()},getTreeNodeComponentIcon:function(){var e,n,r=this.GetObject().GetType();r?(n=t[r].fileName,e=t[r].key,this._loadIconFromFilenameAndKey(n,e)):console.warn("Cannot get the component type. The component icon cannot be fetched.")}})});