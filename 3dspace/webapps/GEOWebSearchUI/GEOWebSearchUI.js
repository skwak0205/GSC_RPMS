define("DS/GEOWebSearchUI/ContextMenu",["UWA/Controls/Abstract"],function(e){"use strict";var o="dsexploration:SiteVersion",t="dsgeology:GeologicModelVersion",i="dsgeospatial:CompoundSRS",s="dsexploration:TerrainVersion",n="GEOXMD_AP",c="GEOXGDM_AP",a="OpenInGeologyModeling",l="ShowInGEODataExplorer",r="OpenInGEODataExplorer";return e.extend({name:"GEOVIAAction",_compass_socket:null,_action_info:null,_role_check_promise:null,init:function(){},availableForTypes:function(){return[o,t,i,s]},getActionForObject:function(e,n){var c=this;require(["UWA/Class/Promise","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(d,u){if(UWA.is(e.sourceid,"string")&&0===e.sourceid.toLowerCase().indexOf("geovia")){UWA.is(c._role_check_promise)||(c._role_check_promise=new d(function(e,o){u.getGrantedRoles(function(t){if(UWA.is(t,"array"))for(var i=0;i<t.length;i++)if(t[i]&&("GML"===t[i].id||"InternalDS"===t[i].id))return void e();o()})}));c._role_check_promise.then(function(){if(UWA.is(n)){var d=[];require(["DS/RuntimeView/NLSManager"],function(u){u.loadResource({resourceFile:"GEOWebSearchUI/ContextMenu"}),u.onResourceLoaded({resourceFile:"GEOWebSearchUI/ContextMenu"},function(){switch(e["ds6w:type_value"]||e["ds6w:type"]){case t:d.push({title:this.getTitle({key:a}),icon:"level-down",id:"geovia_xmd_open",multisel:!1,callback:c.launchCustoAction.bind(c)}),d.push({title:this.getTitle({key:l}),icon:"level-down",id:"geovia_xgdm_open",multisel:!1,callback:c.launchCustoAction.bind(c)});break;case o:d.push({title:this.getTitle({key:r}),icon:"level-down",id:"geovia_xgdm_open",multisel:!1,callback:c.launchCustoAction.bind(c)});break;case i:case s:d.push({title:this.getTitle({key:l}),icon:"level-down",id:"geovia_xgdm_open",multisel:!1,callback:c.launchCustoAction.bind(c)})}n.call(null,d)})})}})}})},launchCustoAction:function(e){var o=this;require(["UWA/Utils/InterCom"],function(t){if(UWA.is(e)){null===o._compass_socket&&(o._compass_socket=new t.Socket("GEOVIAcompassSocket"),o._compass_socket.subscribeServer("com.ds.compass",window.parent));var i,s=e.model.get("sourceid_value")||e.model.get("sourceid"),a={protocol:"3DXContent",version:"1.1",source:"X3DSEAR_AP",data:{items:[{envId:s=s?s.split(":")[1]:e.model.get("tenant"),objectId:e.model.get("id"),objectType:e.model.get("ds6w:type_value")||e.model.get("ds6w:type"),displayName:e.model.get("ds6w:label").replace(/&gt;/g,">").replace(/&lt;/g,"<"),serviceId:e.model.get("ds6w:where/ds6w:source/ds6w:dataSource_value")||e.model.get("ds6w:where/ds6w:source/ds6w:dataSource")}]}};switch(o._compass_socket.dispatchEvent("onSetX3DContent",a,"GEOVIAcompassSocket"),e.action_id){case"geovia_xmd_open":i={appId:n};break;case"geovia_xgdm_open":i={appId:c}}o._compass_socket.dispatchEvent("onLaunchApp",i,"GEOVIAcompassSocket")}})}})});