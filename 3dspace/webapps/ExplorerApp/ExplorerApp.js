/*!  COPYRIGHT DASSAULT SYSTEMES 2022   */
function ExplorerApp(e){"use strict";var t={init:function(e){this.widget=e.widget,this.widget.addEvent("onLoad",this.onLoad.bind(this)),this.widget.addEvent("onRefresh",this.onRefresh.bind(this)),this.widget.addEvent("onSearch",this.onSearch.bind(this))},onRefresh:function(){this.explorerCmp.refresh()},onSearch:function(e){this.explorerCmp.search(e)},onLoad:function(){this.widget.setValue("tenantAware",!0),this.__buildDOM(),require(["css!DS/ExplorerApp/ExplorerApp","i18n!DS/ExplorerApp/assets/nls/ExplorerApp.json","DS/PADServices/views/private/ENXMask","DS/ExplorerApp/utils/AppCntProxy","DS/PADServices/utils/GlobalModelEvents","DS/PADServices/utils/PADTrackerManager"],(e,t,n,i,o,s)=>{var r=s.getPADTracker({eventCategory:"app",eventAction:"initialization"});r.setEventData({eventLabel:"V2"}),r.trackPageEvent(),n.mask(this.elements.mainBody,t.appLoading),this.widget.addEvent("onViewChange",this.__onResize.bind(this)),this.widget.addEvent("onResize",this.__onResize.bind(this));var a=[];a.push(this.__initializeInfra()),Promise.all(a).then(e=>{var s={};for(let t=0;t<e.length;t++)e[t]&&(s=Object.assign(e[t],s));s.target=this.elements.mainBody,s.title="Product Explorer",s.subtitle=t.appDescription,i.initFromWdg({widget:this.widget,mdlEvts:o.getModelEvents(),configuration:s}).then(()=>{require([s.appCntAMD],e=>{(this.explorerCmp=new e(s)).initialize().then(()=>{n.unmask(this.elements.mainBody),this.widget.dispatchEvent("onExplorerReady",this)})})})})})},__onResize:function(){require("DS/PADServices/utils/GlobalModelEvents").publish({event:"DS/ENX/AppResize"})},__buildDOM:function(){this.elements||(this.elements={},this.elements.appBody=document.createElement("div"),this.elements.appBody.classList.add("enx-app"),this.elements.appBody.classList.add("explorer-root"),this.elements.appBody.id="product-explorer-app",this.elements.appBody.style.position="absolute",this.elements.appBody.style.height="100%",this.elements.appBody.style.width="100%",this.elements.mainBody=document.createElement("div"),this.elements.mainBody.classList.add("enx-root"),this.elements.appBody.classList.add("explorer-root"),this.elements.mainBody.classList.add("enx-appMainBody"),this.elements.mainBody.id="enx-app",this.elements.mainBody.style.position="absolute",this.elements.mainBody.style.height="100%",this.elements.mainBody.style.width="100%",this.elements.appBody.appendChild(this.elements.mainBody),this.__buildTooSmallDiv(),self.widget.setBody(this.elements.appBody))},__initializeInfra:function(){return new Promise(e=>{require(["DS/PADServices/utils/PlatformURL","text!DS/ExplorerApp/assets/configuration/ExplorerConf.json","DS/PlatformAPI/PlatformAPI"],(t,n,i)=>{var o=i.getUser();t.retrievePlatformUrl({addDefaults:!0,initWSAcess:!0}).then(()=>{var t=JSON.parse(n);t.currentUser=o,e(t)})})})},__buildTooSmallDiv:function(){require(["i18n!DS/ExplorerApp/assets/nls/ExplorerApp.json","DS/Utilities/Dom","DS/WebappsUtils/WebappsUtils"],(e,t,n)=>{this.elements.tooSmall=t.createElement("div",{class:"enx-app-small"});let i=n.getWebappsAssetUrl("ExplorerApp","images/ENOSC2D_AP_LandingPage.jpg");this.elements.tooSmall.style.backgroundImage="url("+i+")";let o=t.createElement("div",{class:"enx-app-small-message"}),s=t.createElement("div",{class:"enx-app-small-message-label"});s.innerText=e.apptoosmall,o.appendChild(s),this.elements.tooSmall.appendChild(o),this.elements.appBody.appendChild(this.elements.tooSmall)})}};return t.init(e),t}"function"!=typeof JSON.clone&&(JSON.clone=function(e){return JSON.parse(JSON.stringify(e))}),define("DS/ExplorerApp/utils/AppCntProxy",["i18n!DS/ExplorerApp/assets/nls/ExplorerApp.json","DS/ENOXWidgetPreferences/js/ENOXWidgetPreferences","DS/PADServices/utils/PlatformURL","DS/PADServices/utils/GlobalModelEvents","DS/Utilities/UUID","UWA/Utils"],function(e,t,n,i,o){"use strict";var s=null,r=()=>{if(null===s){s="";let e=decodeURIComponent((new RegExp("[?|&]widgetDomain=([^&;]+?)(&|#|;|$)").exec(location.search)||[null,""])[1].replace(/\+/g,"%20"))||null;e?(e=new URL(e),s=e.search):s=location.search,s=new URLSearchParams(s)}return s},a=e=>{switch(e=e.toLowerCase()){case"true":e=!0;break;case"false":e=!1}return e};function p(e){return"object"==typeof p.instance?p.instance:(p.instance=this,this.appInfos={lang:"en",currentUser:void 0,widgetId:void 0,x3dAppId:void 0,x3dSharedId:void 0,settings:{}},this.cmdProxy={currentLoadRequest:void 0,openStack:void 0},this)}return p.prototype.initFromWdg=function(e){return new Promise((n,i)=>{void 0!==e.widget&&void 0!==e.mdlEvts&&void 0!==e.configuration.currentUser||i("AppCntProxy::initialize - Invalid input"),this.mdlEvts=e.mdlEvts,this.appInfos.lang=e.widget.lang,this.appInfos.widgetId=e.widget.id,this.appInfos.x3dAppId=e.widget.getValue("x3dAppId")?e.widget.getValue("x3dAppId"):e.widget.getValue("appId"),this.appInfos.x3dSharedId=e.widget.getValue("x3dSharedId")?e.widget.getValue("x3dSharedId"):this.getAppId(),this.appCntProxy=e.widget,this.appInfos=Object.assign(this.appInfos,e.configuration),this.isReadOnly=!0,this.appCntProxy.addEvent("endEdit",e=>{e&&!1===e.submitted||this.mdlEvts.publish({event:"DS/ENXPreference/update",data:{preferences:this.appCntProxy.getPreferences()}})});let o=[];if(o.push(t.addPlatformSelectionPreferenceToWidget({roles:this.appInfos.roles.available,mustHaveAll:!1})),this.appCntProxy.addEvents({endEdit:this.__onEndEditPref.bind(this)}),this.appInfos.preferences){let e=Object.keys(this.appInfos.preferences),t=[];for(let n=0;n<e.length;n++){var s=Object.assign({name:e[n],defaultValue:this.appInfos.preferences[e[n]].value},this.appInfos.preferences[e[n]].preference);t.push(s)}t.length&&this.appCntProxy.mergePreferences(t)}let p=r();for(var l of p.keys()){let e=p.get(l);this.setSetting(l,a(e))}Promise.all(o).then(n).catch(e=>console.log("err : "+e))})},p.prototype.getLang=function(){return this.appInfos.lang},p.prototype.getUser=function(){return this.appInfos.currentUser},p.prototype.getUserLogin=function(){var e=this.getUser(),t="";return void 0!==e&&(t=e.login),t},p.prototype.getUserName=function(){var e=this.getUser(),t="";return void 0!==e&&(t=e.firstName+" "+e.lastName),t},p.prototype.getWidget=function(){return this.appCntProxy},p.prototype.getWidgetId=function(){return this.appInfos.widgetId||void 0===this.appCntProxy||null===this.appCntProxy||(this.appInfos.widgetId=this.appCntProxy.id),this.appInfos.widgetId},p.prototype.getAppId=function(){return this.appInfos.x3dAppId},p.prototype.getSharedId=function(){return this.appInfos.x3dSharedId},p.prototype.getRequestLabel=function(){return this.getUserLogin()+"-"+this.getAppId()+"-"+Date.now()},p.prototype.getValue=function(e){return this.appCntProxy.getValue(e)},p.prototype.setValue=function(e,t){this.appCntProxy.setValue(e,t)},p.prototype.mergePreferences=function(e){this.appCntProxy.mergePreferences(e)},p.prototype.setSetting=function(e,t){this.appInfos.settings[e]=t},p.prototype.getSetting=function(e){return this.appInfos.settings[e]},p.prototype.getStoreSetting=function(){return n.getPlatformId()+"-"+this.appInfos.settings.storage},p.prototype.getProperty=function(e){return this.appInfos[e]},p.prototype.getPreference=function(e,t){let n;return n=!0===t||!0===this.getSetting("enx-storepref-locally")?localStorage.getItem(e):this.getValue(e)},p.prototype.setPreference=function(e,t,n){t=!0===n||!0===this.getSetting("enx-storepref-locally")?localStorage.setItem(e,t):this.setValue(e,t)},p.prototype.setPlatformId=function(e){this.setValue("x3dPlatformId",e),this.setValue(t.getPlatformPreferenceKey(),e),t.addPlatformSelectionPreferenceToWidget({roles:this.appInfos.roles.available,mustHaveAll:!1})},p.prototype.__onEndEditPref=function(){t.hasPlatformIdChanged()&&this.mdlEvts.publish({event:"DS/ENXPreference/tenantChange",data:{previousPlatformId:t._lastSavedPlatformId,targetPlatformId:this.appCntProxy.getValue(t.getPlatformPreferenceKey())}})},p.prototype.setCurrentLoadRequest=function(e){this._cmdProxy.currentLoadRequest=e},p.prototype.__setupCrossWidgetCommunication=function(){let e=this;return new Promise(function(t){require(["DS/PADServices/utils/CommandProxy"],function(n){e.cmdProxy=n.create({events:{onLoadStoredObj:function(t,n){if(n.originWidgetId!==e.getWidgetId()){if(e._currentLoadRequest&&UWA.equals(e._currentLoadRequest,t))return void e.setCurrentLoadRequest(null);t&&(t.unserializedData?i.publish({event:"DS/ENX/App/open",data:{dndItems:!0,openFromRecent:!0,behavior:"WITHOUT_CONTEXT",unserializedData:t.unserializedData}}):i.publish({event:"DS/ENX/App/open",data:{openFromRecent:!0,openprevious:t}}),i.publish({event:"DS/ENX/SwitchView",data:{viewId:"app"}}))}},onAppProxyReady:function(t,n){n.originWidgetId!==e.getWidgetId()&&(e.cmdProxy.proxyReady=!0,!0!==e.cmdProxy.handshakeDone&&t.wpUUID!==e.cmdProxy.partnerUUID&&(e.cmdProxy.partnerUUID=t.wpUUID,e.cmdProxy.handshakeDone=!0,e.cmdProxy.wpUUID||(e.cmdProxy.wpUUID="enwwp-"+o.v4(),e.cmdProxy.openStack=void 0),e.cmdProxy.appProxyReady({wpUUID:e.cmdProxy.wpUUID})),e.cmdProxy&&e.cmdProxy.openStack&&e.cmdProxy.openStack.openProxy&&(e.cmdProxy.cmdProxy.loadStoredObj(e.options.openStack.openProxy),e.options.openStack.openProxy=void 0))}}}),e.cmdProxy.appProxyReady({wpUUID:e.cmdProxy.wpUUID}),t()})})},new p}),define("DS/ExplorerApp/views/ExplorerAppHP",["i18n!DS/ExplorerApp/assets/nls/ExplorerApp.json","DS/ExplorerApp/utils/AppCntProxy","DS/PADServices/utils/GlobalModelEvents","DS/PADServices/utils/GlobalUtils","DS/PADServices/views/private/homepage/WelcomeScreen","DS/PADServices/utils/PADTrackerManager"],function(e,t,n,i,o,s){"use strict";function r(e){this.options=e||{},this.options=Object.assign(this.options,{}),this.options.welcomeScreen=t.getProperty("welcomeScreen"),this.options.welcomeScreen.mdlEvts=n.getModelEvents(),this.options.welcomeScreen.appId=t.getProperty("appId"),this.elements={},this.__addListeners()}return r.prototype.initialize=function(){return new Promise(e=>{this.elements.container=new o(this.options.welcomeScreen),this.elements.container.initialize().then(()=>{this.elements.container.getDOM().classList.add("enx-welcomescreen"),e()})})},r.prototype.__addListeners=function(){this.options.welcomeScreen.mdlEvts.subscribe({event:"DS/ENX/WelcomeScreen/Recent"},e=>{this.options.welcomeScreen.mdlEvts.publish({event:"enx-welcomescreen-activate-tab",data:{tabId:"recent"}});let n=t.getValue(t.getStoreSetting());"string"==typeof n&&(n=JSON.parse(n)),this.options.welcomeScreen.mdlEvts.publish({event:"enx-welcomescreen-set-main-container",data:{viewId:"recent",AMD:"DS/ExplorerApp/views/ExplorerRecent",recent:n,noMask:e?e.noMask:void 0}}),e&&!0===e.fromBtn&&s.addCommandHit("recent")});var e=require(this.options.welcomeScreen.i18n.AMD)[this.options.welcomeScreen.i18n.key];this.options.welcomeScreen.mdlEvts.subscribe({event:"DS/ENX/WelcomeScreen/openSearch"},i=>{this.options.welcomeScreen.mdlEvts.publish({event:"enx-welcomescreen-activate-btn",data:{btnId:i.btnId}}),this.options.welcomeScreen.mdlEvts.publish({event:"enx-welcomescreen-hide-currentview"}),require(["DS/PADServices/utils/SearchUtils"],o=>{!0===i.default&&(i.qry=t.getSetting("defaultOpenQry"));let r={title:e[i.btnId],search_criteria_to_display:"",fts_value:i.qry,showApplyButton:!0!==i.noApply,callback:e=>{const t=o.createDropDataFromSearch(e),i="Advanced Filter"===e.at(0)["ds6w:type"];n.publish({event:"DS/ENX/HP/Recent/open",data:{dndItems:!0,unserializedData:t,isOpenFromFiltersPage:i}})},apply:e=>{const t=o.createDropDataFromSearch(e);n.publish({event:"DS/ENX/HP/Recent/open",data:{dndItems:!0,unserializedData:t,behavior:"FILTER",withFilter:!0,isTriggerApply:!0}})},cancel:function(){n.publish({event:"DS/ENX/WelcomeScreen/Recent",data:{}})}};o.inAppsSearch(r),i&&!0===i.fromBtn&&s.addCommandHit("openSearch-"+i.btnId)})}),this.options.welcomeScreen.mdlEvts.subscribe({event:"DS/ENX/WelcomeScreen/LaunchURL"},e=>{i.launchURL(e),e&&!0===e.fromBtn&&s.addCommandHit("launchURL")}),this.options.welcomeScreen.mdlEvts.subscribe({event:"enx-welcomescreen-drop"},this.__onDrop.bind(this)),n.subscribe({event:"DS/ENX/HP/Recent/close"},()=>{n.publish({event:"DS/ENX/SwitchView",data:{viewId:"app"}})})},r.prototype.__onDrop=function(e){n.publish({event:"DS/ENX/App/open",data:{dndItems:!0,openFromRecent:!0,behavior:e.behavior?e.behavior:"FILTER",unserializedData:e.dataTransfer,withFilter:!0}}),n.publish({event:"DS/ENX/SwitchView",data:{viewId:"app"}}),s.addCommandHit("HP.dropContent")},r.prototype.getDOM=function(){return this.elements.container.getDOM()},r}),define("DS/ExplorerApp/views/ExplorerRecent",["i18n!DS/ExplorerApp/assets/nls/ExplorerApp.json","DS/ExplorerApp/utils/AppCntProxy","DS/PADServices/views/private/homepage/Recent"],function(e,t,n){"use strict";function i(){this.options={supportedTypes:t.getSetting("supportedTypes"),recentMaxSize:t.getSetting("recentMaxSize")},n.call(this,this.options)}return i.prototype=Object.assign(i.prototype,n.prototype),i.prototype=Object.create(i.prototype),i}),define("DS/ExplorerApp/views/AppMain",["text!DS/ExplorerApp/assets/xscene_settings.json","i18n!DS/ExplorerApp/assets/nls/ExplorerApp","DS/ExplorerApp/utils/AppCntProxy","DS/PADServices/utils/GlobalModelEvents","DS/Controls/Loader","DS/Utilities/Dom","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices"],function(e,t,n,i,o,s,r,a){"use strict";const p="enx-app-main";var l=JSON.parse(e);function d(e){this.options=e||{},this.options=Object.assign(this.options,{widget:n.appCntProxy,appCmpReady:!1,xnavCmpOpts:{x3dAppId:null,widget:null,active_view:null,action_bar_opts:null,configuration:{dynamicCtxActivated:!1,ctxMenuOpts:{definition:"ExplorerApp/assets/configuration/xsceneCtxMenu.json"},commands:{definition:"ExplorerApp/assets/configuration/xsceneCmds.json"}},layout:{view_customization:null,padshell:!0,withWelcomePanel:!0},amd_custo:{},newHP:!0}}),this.elements={},this.elements.container=s.createElement("div",{class:p}),this.elements.loader=new o({}),this.elements.loader.on(t.appMainLoading),this.elements.container.classList.add("with-loader"),this.elements.container.appendChild(this.elements.loader.getContent())}d.prototype.initialize=function(){return new Promise(e=>{this.__init(),this.__addListeners(),e()})},d.prototype.__addListeners=function(){i.subscribe({event:"DS/ENX/App/open"},e=>{this.options.openWhenReady=e,!0===this.options.appCmpReady&&this.__openContent()}),i.subscribe({event:"DS/ENX/App/closeIds"},e=>{if(this.options.openWhenReady=null,!0===this.options.appCmpReady){var t=e.removeIds,n=t?t.length:0,i=this.appCmp.getPADTreeDocument();i.withTransactionUpdate(function(){for(var e=0;e<n;e++){var o=i.searchRootById(t[e]);o&&i.removeRoot(o)}})}})},d.prototype.__init=function(){var e=this;require(["DS/PADUtils/PADSession","DS/PADServices/utils/AttributesMgtV2","DS/PADServices/utils/GlobalUtils","DS/PADUtils/PADSharedSettings","DS/PADUtils/PADWebInWinServices","UWA/Utils/Client","i18n!DS/ExplorerApp/assets/nls/ExplorerApp.json","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/PADUtils/Configuration","text!DS/ExplorerApp/assets/ProductExplorerConf.json","DS/PADServices/utils/ZipUtils"],function(t,n,i,o,s,p,d,u,h,g,m){t.softInit(!0),e.options.widget.getValue("x3dSharedId")||e.options.widget.getValue("x3dAppId")||e.options.widget.addPreference({name:"x3dAppId",type:"hidden",defaultValue:"ENXScene_appId"}),n.initialize({defaultAttributesJSON:"DS/PADServices/assets/init/AttributesMgt.json",appAttributesJSON:"DS/ExplorerApp/assets/json/AppDefaultAttributes.json"}).then(function(){var t=JSON.parse(g);h.mergeConfig(t),s.initialize({widget:e.options.widget}),o.addSharedSettings(e.options.widget,["synthesisModeOnInstance","autoreload"]),e.options.widget.mergePreferences(r.getWidgetPreferences()),e.options.widget.addEvent("endEdit",function(){void 0!==e.options.widget&&-1!==r.getSetting("webInWin_context_availability").indexOf(e.options.widget.getValue("addinmode"))&&self.options.widget.getValue("X3DContentId")||r.updateWidgetPreferences.call(r)}),e.options.widget.addEvent("onChangeControlUpdate",e.__onChangeControlUpdateHandler.bind(e)),r.updateWidgetPreferences();var i=e.options.xnavCmpOpts,d=!!widget.getValue("forceTouchMode")&&widget.getValue("forceTouchMode")||p.Features.touchEvents&&!p.Features.pointerEvents?l.action_bar.touch:l.action_bar.standard;s.isWebInWinContext()&&(d=l.action_bar.webinwin),i.layout.propertiesFacet=r.getSetting("propertiesFacet"),d.language=e.options.widget.lang,i.x3dAppId=e.options.widget.getValue("x3dAppId"),i.widget=e.options.widget,i.insert_replace=!0,i.active_view=e.options.widget.getValue("default_view"),i.authorize_setStructure=!0,i.insert_replace=!0,i.renderTo=document.body,!0===r.getSetting("activateDropInviteWithFilter")&&(i.layout.drop_invite="inviteWithFilter"),!0===r.getSetting("authorizeChangeControl")&&(i.authorizeChangeControl=!0,void 0!==e.options.widget.getValue("changeControlActivation")&&r.setSetting("changeControlActivation",e.options.widget.getBool("changeControlActivation"))),i.layout.amdTreeView="datagridview","treelistview"===i.active_view&&(i.active_view="datagridview"),i.action_bar_opts=d,i.configuration.toolbarActivated=!1,i.configuration.dynamicCtxActivated=!0,n.updateAttributesList(t.columnsCusto);var u,f,v,S="null"===(u=e.options.widget.getValue("xscene_custoParams"))?null:u;S&&n.updateSelectedParams(JSON.parse(S));var w=r.getSetting("resetCustomization");if(!w){"null"===(f=e.options.widget.getValue("xscene_custo"))&&(f=null);try{f=m.jsonUnzip(f),(f=c(f))&&(v=JSON.parse(f))}catch(e){w=!0}}w||f&&"{"!==f.charAt(0)&&!1===f.startsWith("ZIP:")?(localStorage.removeItem("PADTreeListDefinition."+i.x3dAppId),e.__initCmp(i)):v?(i.layout.view_customization=v,e.__initCmp(i)):require(["DS/PADUtils/PADWSAccess"],function(t){a.app_initialization(function(o){o&&o.success?t.getMyAppsTemplate({preference_name:i.x3dAppId+"-"+a.getPlatformId(),onComplete:function(t){var o=null;try{t.length>0&&(t.startsWith("ZIP:")&&(t=m.jsonUnzip(t)),"{"===(t=c(t)).charAt(0)&&(o=JSON.parse(t)).selectedExtensions&&o.selectedTypes&&(n.updateSelectedParams({selectedExtensions:o.selectedExtensions,selectedTypes:o.selectedTypes}),delete o.selectedExtensions,delete o.selectedTypes))}catch(e){}i.layout.view_customization=o,e.__initCmp(i)},onFailure:function(t){e.__initCmp(i)}}):e.__initializeFailure()})})})})},d.prototype.__onChangeControlUpdateHandler=function(e,t){var n=require("DS/PADUtils/PADSettingsMgt"),i="bottom-right";i=sessionStorage.getItem("changeControlPosition")?sessionStorage.getItem("changeControlPosition"):n.getSetting("changeControlPosition");var o=require("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext");!1===t?(o.hide(),this.options.widget.addPreference({name:"changeControlPosition",type:"hidden",defaultValue:i})):(o.show(),this.options.widget.addPreference({name:"changeControlPosition",defaultValue:i,type:"list",label:"changeControlPosition_label",options:[{label:"bottom-right_label",value:"bottom-right"},{label:"bottom-left_label",value:"bottom-left"},{label:"top-right_label",value:"top-right"}]})),this.options.widget.dispatchEvent("onEdit")},d.prototype.__onChangeControlActivation=function(e){var t=require("DS/PADUtils/PADSettingsMgt"),n=require("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext");this.debouncePrefSynchro?this.debouncePrefSynchro=!1:this._proxy.preferenceModification({name:"changeControlActivation",value:e});var i="bottom-right";i=sessionStorage.getItem("changeControlPosition")?sessionStorage.getItem("changeControlPosition"):t.getSetting("changeControlPosition"),n.setPosition(i),!0===e?(n.show(),this.options.widget.addPreference({name:"changeControlPosition",defaultValue:i,type:"list",label:"changeControlPosition_label",options:[{label:"top-right_label",value:"top-right"},{label:"top-left_label",value:"top-left"},{label:"bottom-right_label",value:"bottom-right"},{label:"bottom-left_label",value:"bottom-left"}]})):(n.hide(),this.options.widget.addPreference({name:"changeControlPosition",type:"hidden",defaultValue:i}))},d.prototype.__initCmp=function(e){var t=this,n=e||{};require(["DS/PADUtils/Configuration","DS/PADUtils/PADProbes","DS/PADUtils/PADSettingsMgt"],function(e,i,o){a.app_initialization(function(){require(["DS/ENXNav/XNavComponent"],function(i){var o=[],s=[],r=new Promise(function(e){Promise.all(s).then(()=>{require(["DS/ENORIPE_RelationsColumns/RelationsColumns"],function(t){t.isAdditionalColumnsAvailable(function(n){!0===n&&o.push(t),t.setPreferenceProxy(),e()}),r.name="Add "+t.getName()},e)})});s.push(r);var a=new Promise(function(r){Promise.all(s).then(function(){!function(o){var s=UWA.extend(n,t.__addEventsCB());o.length?s.additionalColumnsModules=o:s.additionalColumnsModules=[];var r=e.getConfig("TreeDocModelAMD");r&&(s.amd_custo.TreeDocument=r),t.appCmp=new i(s)}(o),r()})});a.name="Launch real initialization",s.push(a)})})})},d.prototype.__initializeFailure=function(){var e=this;require(["css!DS/ENXNav/ENXNav","DS/ENXNav/views/xNavInitError","i18n!DS/ENXNav/assets/nls/ENXNav.json"],function(t,n,i){var o=that.elements.fakeContainer=s.createElement("div",{class:"appCmp"}),r=new n({msg:i.initialization_error});o.setContent(r),this.elements.container.appendChild(o),that.options.widget.dispatchEvent("onXSceneReady",e)})},d.prototype.__addEventsCB=function(){var e=this;return{events:{onReady:function(t){e.elements.container.classList.remove("with-loader"),e.elements.loader.off(),e.elements.container.appendChild(e.appCmp.render()),e.options.widget.addEvent("onViewChange",e.appCmp.onResize.bind(e.appCmp)),e.options.widget.addEvent("onResize",e.appCmp.onResize.bind(e.appCmp));var n=i.getModelEvents();n.subscribe({event:"DS/ENX/AppRefresh"},()=>{e.appCmp.refresh()}),n.subscribe({event:"DS/ENX/AppSearch"},t=>{e.appCmp.onSearch(t)}),n.subscribe({event:"ENXViews/Views/showInWidgetBody"},function(t){t.html?(t.title&&e.options.widget.setTitle(t.title),i.publish({event:"DS/ENX/SwitchView",data:{idHTML:t.idView,html:t.html}})):!0===t.restore&&(e.options.widget.setTitle(e.appCmp.getWidgetTitle()),"welcome"===e.previousBody?i.publish({event:"DS/ENX/SwitchView",data:{viewId:"homepage"}}):"app"!==e.previousBody&&"app"!==t.idView||i.publish({event:"DS/ENX/SwitchView",data:{viewId:"app"}}))}),require("DS/PADUtils/PADSharedSettings").resetDebounceFlags(),e.appCmp.addEvent("onToggleView",function(t){e.options.widget.setValue("default_view",t)}),t&&!0===t.error&&e.__initializeFailure(),e.options.appCmpReady=!0,e.options.openWhenReady&&e.__openContent(),e.options.widget.dispatchEvent("onAppMainReady",e)},onAddPaths:function(e){i.publish({event:"DS/ENX/App/Recent/Upd",data:{products:{addedPaths:e.addedPaths},openDate:(new Date).toISOString()}})},onAddFilters:function(e){e.added=!0,i.publish({event:"DS/ENX/App/Recent/Upd",data:{filters:e,openDate:(new Date).toISOString()}})},onDeleteRoots:function(e){i.publish({event:"DS/ENX/App/Recent/Upd",data:{closeIds:JSON.parse(e),noRefresh:!0}})},onCustoViewChange:function(t,n){var i=require("DS/PADServices/utils/ZipUtils").jsonZip(JSON.stringify(t));if(e.options.widget.setValue("xscene_custo",i),n&&e.options.widget.setValue("xscene_custoParams",JSON.stringify(n)),e.appCmp&&e.appCmp.options){var o=e.appCmp.options.views.datagridview;o&&(o.columnOrdering=!0)}},onAuthoringCtxAvailable:function(t){var n=require("DS/PADUtils/PADSettingsMgt"),i=require("DS/PADUtils/PADCommandProxy");e.debouncePrefSynchro=!1,e._proxy=i.create({events:{onPreferenceModification:function(t){"changeControlActivation"===t.name&&(e.debouncePrefSynchro=!0,e.options.widget.setValue(t.name,t.value),n.setSetting(t.name,t.value))}}}),e.options.widget.addEvent("endEdit",function(t){if(t&&!1===t.submitted){var i="bottom-right";i=sessionStorage.getItem("changeControlPosition")?sessionStorage.getItem("changeControlPosition"):n.getSetting("changeControlPosition");var o=require("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext");!1===e.options.widget.getBool("changeControlActivation")?(o.hide(),e.options.widget.addPreference({name:"changeControlPosition",type:"hidden",defaultValue:i})):(o.show(),e.options.widget.addPreference({name:"changeControlPosition",defaultValue:i,type:"list",label:"changeControlPosition_label",options:[{label:"bottom-right_label",value:"bottom-right"},{label:"bottom-left_label",value:"bottom-left"},{label:"top-right_label",value:"top-right"}]}))}});var o=n.getSetting("changeControlActivation");o=void 0!==e.options.widget.getValue("changeControlActivation")?e.options.widget.getBool("changeControlActivation"):t.isAuthoringContextVisible;var s="bottom-right";s=sessionStorage.getItem("changeControlPosition")?sessionStorage.getItem("changeControlPosition"):n.getSetting("changeControlPosition");var r=require("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext");r.setPosition(s),e.options.widget.addPreference({name:"changeControlActivation",defaultValue:o,type:"boolean",label:"changeControlActivation_label",onchange:"onChangeControlUpdate"}),!0===o?(r.show(),e.options.widget.addPreference({name:"changeControlPosition",defaultValue:s,type:"list",label:"changeControlPosition_label",options:[{label:"bottom-right_label",value:"bottom-right"},{label:"bottom-left_label",value:"bottom-left"},{label:"top-right_label",value:"top-right"}]})):(r.hide(),e.options.widget.addPreference({name:"changeControlPosition",type:"hidden",defaultValue:s})),n.setSetting("changeControlActivation",o,!0),n.addEvent("onChangeControlActivation",e.__onChangeControlActivation.bind(e)),r.addEvent&&r.addEvent("onAuthoringCtxVisible",function(t){n.setSetting("changeControlActivation",t.showAuthoringContext,!0),e.__onChangeControlActivation(t.showAuthoringContext),n.setSetting("changeControlDlgOpen",!0)}),n.addEvent("onChangeControlPosition",function(e){require("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext").setPosition(e),sessionStorage.setItem("changeControlPosition",e)})},onTenantChange:function(e){},onSaveAsTemplate:function(t){t&&t.selectedExtensions&&t.selectedTypes&&e.options.widget.setValue("xscene_custoParams",JSON.stringify({selectedExtensions:t.selectedExtensions,selectedTypes:t.selectedTypes}));var n=require("DS/PADServices/utils/ZipUtils").jsonZip(JSON.stringify(t));e.options.widget.setValue("xscene_custo",n),require(["DS/PADUtils/PADWSAccess"],function(t){t.saveMyAppsTemplate({preference_name:e.options.widget.getValue("x3dAppId")+"-"+a.getPlatformId(),value:n,onComplete:e=>{},onFailure:e=>{}})})}}}},d.prototype.__openContent=function(){if(this.options.openWhenReady){var e=this.options.openWhenReady;delete this.options.openWhenReady;var t=n.getSetting("supportedTypes");if(!0===e.openFromRecent)if(e.broadcast=!0,!0===e.dndItems)this.appCmp.openDroppedObjects(e);else if(e.openprevious)this.appCmp.openStoredObjects(e.openprevious);else{let n=Object.keys(e.toopen);for(let i=0;i<n.length;i++)if(void 0!==t[n[i]]){let o=require(t[n[i]].amd)[t[n[i]].buildOpenParamsFunc](e.toopen[n[i]]);e[n[i]]=o}this.appCmp.openStoredObjects(e)}}},d.prototype.getDOM=function(){return this.elements.container};var c=function(e){return UWA.is(e,"string")&&(e=e.replace(/'label':'((\\'|[^'])*)',/gi,"")),e};return d}),define("DS/ExplorerApp/utils/AppRecentMgt",["i18n!DS/ExplorerApp/assets/nls/ExplorerApp.json","DS/ExplorerApp/utils/AppCntProxy"],function(e,t){"use strict";function n(e){return"object"==typeof n.instance?n.instance:(n.instance=this,this)}return n.prototype.migrateAppSettings=function(){return new Promise(e=>{if("undefined"!=typeof widget&&null!==widget){var n=-1,i=widget.preferences.length;for(let e=0;e<i;e++)if("storedObjectMgt"===widget.preferences[e].name){n=e;break}-1!==n&&widget.preferences.splice(n,1)}var o={version:3},s=t.getValue("xsceneStoredObjects");if("null"===s&&(s=null),s){if(s=JSON.parse(s),t.setValue("xsceneStoredObjects","null"),"undefined"!=typeof widget&&null!==widget){n=-1,i=widget.preferences.length;for(let e=0;e<i;e++)if("xsceneStoredObjects"===widget.preferences[e].name){n=e;break}-1!==n&&widget.preferences.splice(n,1)}var r=t.getSetting("supportedTypes"),a=Object.keys(r);(function(e){return e.reduce((e,t)=>e.then(()=>(function(e){return new Promise(function(t){require([r[e].amd],n=>{let i=n[r[e].convertFunc](s);i.length&&(o[n[r[e].getKeyFunc]()]=i),t()},()=>{console.warn("No AMD found "+r[e].amd),t()})})})(t)),Promise.resolve())})(a).then(()=>{t.setValue(t.getStoreSetting(),JSON.stringify(o)),e()})}else e()})},n.prototype.buildOpenPreviousSession=function(){return new Promise(e=>{var n=t.getValue(t.getStoreSetting()),i={},o=t.getSetting("supportedTypes"),s=Object.keys(o);if(n){n=JSON.parse(n);(function(e){return e.reduce((e,t)=>e.then(()=>(function(e){return new Promise(function(t){require([o[e].amd],s=>{let r=s[o[e].buildOpenParamsFunc](n[s[o[e].getKeyFunc]()],!0);Object.keys(r).length&&(i[s[o[e].getKeyFunc]()]=r),t()},()=>{console.warn("No AMD found "+o[e].amd),t()})})})(t)),Promise.resolve())})(s).then(()=>{e(i)})}})},n.prototype.removeOpenPreviousSessionFlag=function(){return new Promise(e=>{var n=t.getValue(t.getStoreSetting()),i=t.getSetting("supportedTypes"),o=Object.keys(i);if(n){n=JSON.parse(n);(function(e){return e.reduce((e,t)=>e.then(()=>(function(e){return new Promise(function(t){require([i[e].amd],o=>{let s=o[i[e].updInPreferenceFunc](n[o[i[e].getKeyFunc]()],{removeLastOpenSession:!0});s.length&&(n[o[i[e].getKeyFunc]()]=s),t()},()=>{console.warn("No AMD found "+i[e].amd),t()})})})(t)),Promise.resolve())})(o).then(()=>{t.setValue(t.getStoreSetting(),JSON.stringify(n)),e()})}})},new n}),define("DS/ExplorerApp/ExplorerCmp",["css!DS/UIKIT/UIKIT.css","i18n!DS/ExplorerApp/assets/nls/ExplorerApp.json","DS/ExplorerApp/utils/AppCntProxy","DS/ExplorerApp/utils/AppRecentMgt","DS/PADServices/utils/GlobalModelEvents","DS/ENOXInterWdgCom/LinkManager","text!DS/ExplorerApp/assets/xscene_settings.json"],function(e,t,n,i,o,s,r){"use strict";function a(e){this.options=e||{},this.options=Object.assign({allViewsReady:!1,defaultView:!0===n.getValue("showWelcomePanel")?"homepage":"app",views:[],viewsCmp:{},injectedViews:[]},this.options),this.elements={}}return a.prototype.initialize=function(){return new Promise(e=>{this.__initSettingsAndPrefs().then(()=>{var t=[];t.push(this.__initUX()),t.push(this.__initListeners.call(this,this.options)),Promise.all(t).then(()=>{!0===n.getValue("autoreload")?i.buildOpenPreviousSession().then(e=>{Object.keys(e).length&&(this.options.storeUntilReadyToOpen={openFromRecent:!0,openprevious:e},!0===this.options.allViewsReady&&this.__openInApp())}):i.removeOpenPreviousSessionFlag(),e()})})})},a.prototype.refresh=function(){o.publish({event:"DS/ENX/AppRefresh"})},a.prototype.switchView=function(e){e.idHTML?(this.elements[this.options.currentView].setAttribute("hidden",""),this.options.currentView=e.idHTML,this.elements[this.options.currentView]=e.html,this.options.target.appendChild(this.elements[this.options.currentView]),this.elements[this.options.currentView].removeAttribute("hidden")):this.options.viewsCmp[e.viewId]&&(this.elements[this.options.currentView].setAttribute("hidden",""),-1===this.options.injectedViews.indexOf(e.viewId)&&(this.options.target.appendChild(this.elements[e.viewId]),this.options.injectedViews.push(e.viewId)),this.options.currentView=e.viewId,this.elements[this.options.currentView].removeAttribute("hidden"))},a.prototype.search=function(e){o.publish({event:"DS/ENX/AppSearch",data:{query:e}})},a.prototype.__initSettingsAndPrefs=function(){return new Promise(e=>{require(["DS/WebUAUtils/WebUAUtils","DS/PADUtils/PADSettingsMgt"],(t,o)=>{t.setAppid(this.options.appId);const a=JSON.parse(r);o.setApp(a.padsettings,"enxscene",!0),i.migrateAppSettings().then(()=>{s.initializeWidgetLink(n.getWidget(),n.getSetting("widgetLink")).then(()=>{n.__setupCrossWidgetCommunication()}).then(()=>{e()})})})})},a.prototype.__initUX=function(){return new Promise(e=>{var t,n=[];for(let e=0;e<this.options.views.length;e++){var i=this.options.views[e],o=new Promise((e,t)=>{var n=i;require([n.amd],t=>{this.options.viewsCmp[n.id]=new t(n),this.options.viewsCmp[n.id][n.initFunc]().then(()=>{this.elements[n.id]=this.options.viewsCmp[n.id][n.getDOMFunc](),n.id===this.options.defaultView&&(this.options.target.appendChild(this.elements[n.id]),this.options.injectedViews.push(n.id),this.options.currentView=n.id),e()})})});n.push(o),i.id===this.options.defaultView&&(t=o)}t.then(e),Promise.all(n).then(()=>{this.options.allViewsReady=!0,this.__openInApp()})})},a.prototype.__initListeners=function(){o.subscribe({event:"DS/ENX/SwitchView"},this.switchView.bind(this)),o.subscribe({event:"ENXViews/WelcomePanel/activate"},e=>{o.publish({event:"DS/ENX/WelcomeScreen/Recent",data:{}}),this.switchView({viewId:"homepage"})}),o.subscribe({event:"DS/ENX/App/Recent/Upd"},e=>{var t=n.getValue(n.getStoreSetting());void 0===t?t={}:"string"==typeof t&&(t=JSON.parse(t));let i=e.removeIds||[],s=e.noRefresh,r=n.getSetting("supportedTypes");if(Array.isArray(e.closeIds)){let n=Object.keys(r);for(let i=0;i<n.length;i++){let o=require(r[n[i]].amd);if("function"==typeof o[r[n[i]].updInPreferenceFunc]){let s=o[r[n[i]].updInPreferenceFunc](t[n[i]],e);t[n[i]]=s}}}else{let n=Object.keys(e),i=e.openDate;for(let o=0;o<n.length;o++)if(void 0!==r[n[o]]){let s=require(r[n[o]].amd)[r[n[o]].updInPreferenceFunc](t[n[o]],e[n[o]],i);t[n[o]]=s}}if(!0!==s&&o.publish({event:"DS/ENX/HP/Recent/Updated",data:t}),n.setValue(n.getStoreSetting(),JSON.stringify(t)),(i.length&&!0!==e.nocloseInApp||e.closeIds&&e.closeIds.length)&&o.publish({event:"DS/ENX/App/closeIds",data:{removeIds:i.length?i:e.closeIds}}),e.fromProxy||i.length>0){}}),o.subscribe({event:"DS/ENX/HP/Recent/open"},e=>{if(e.isTriggerApply){let t={...e,mode:"welcome"};n.cmdProxy.loadStoredObj(t)}e.openFromRecent=!0,this.options.storeUntilReadyToOpen=e,this.__openInApp()})},a.prototype.__openInApp=function(){this.options.storeUntilReadyToOpen&&(o.publish({event:"DS/ENX/App/open",data:this.options.storeUntilReadyToOpen}),this.switchView({viewId:"app"}),delete this.options.storeUntilReadyToOpen)},a});