define("DS/MPFDebugTools/ConstraintsDebugComponent",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFAddressConstraintsModel/AddressConstraintsCollection","DS/MPFCompanyConstraintsModel/CompanyConstraintsCollection","DS/MPFBankAccountConstraintsModel/BankAccountConstraintsCollection","css!DS/MPFDebugTools/MPFDebugTools"],function(t,e,s,n,r,a){"use strict";var i,o={VISIBLE:"visible",HIDDEN:"hidden",COLLAPSED:"collapsed"},c={};return c.ADDRESS="addressConstraints",c.COMPANY="companyConstraints",c.BANK_ACCOUNT="bankAccountContraints",(i=e.extend({className:"mpf-address-debug-component",setup:function(t){s.requiredOfPrototype(t.addressConstraints,n,"options.addressConstraints must be an AddressConstraintsCollection"),s.requiredOfPrototype(t.companyConstraints,r,"options.companyConstraints must be a CompanyConstraintsCollection"),s.requiredOfPrototype(t.bankAccountConstraints,a,"options.bankAccountConstraints must be a BankAccountConstraintsCollection"),this.addressConstraints=t.addressConstraints,this.companyConstraints=t.companyConstraints,this.bankAccountConstraints=t.bankAccountConstraints,this.state=t.state||o.VISIBLE,this.selection=t.selection||c.ADDRESS},render:function(){var t=[];if(this.state!==o.HIDDEN&&(t.push(this._createMenuBar()),this.state!==o.COLLAPSED)){var e=this._getSelectedCountry();e?(t.push({tag:"h3",text:"Current constraints for "+e}),t.push(this._createAttributeList(e))):t.push({tag:"div",text:"No country selected?"})}return this.container.setContent(t),this},destroy:function(){this.addressConstraints=null,this.companyConstraints=null,this._parent(),this.container=null},expand:function(){this.state=o.VISIBLE,this.render()},collapse:function(){this.state=o.COLLAPSED,this.render()},toggleCollapse:function(){this.state===o.COLLAPSED?this.expand():this.collapse()},showAddressConstraints:function(){this.state=o.VISIBLE,this.selection=c.ADDRESS,this.render()},showCompanyConstraints:function(){this.state=o.VISIBLE,this.selection=c.COMPANY,this.render()},showBankAccountConstraints:function(){this.state=o.VISIBLE,this.selection=c.BANK_ACCOUNT,this.render()},_createMenuBar:function(){return{tag:"div",class:"mpf-menu-bar",html:[{tag:"button",text:"company",events:{click:this.showCompanyConstraints.bind(this)}},{tag:"button",text:"address",events:{click:this.showAddressConstraints.bind(this)}},{tag:"button",text:"bank-account",events:{click:this.showBankAccountConstraints.bind(this)}},{tag:"button",text:this.state===o.COLLAPSED?"expand":"collapse",events:{click:this.toggleCollapse.bind(this)}}]}},_createAttributeList:function(t){var e,s=[];switch(this.selection){case c.ADDRESS:e=this.addressConstraints.get(t);break;case c.COMPANY:e=this.companyConstraints.get(t);break;case c.BANK_ACCOUNT:e=this.bankAccountConstraints.get(t)}if(e)for(var n=e.keys(),r=0;r<n.length;r++){var a=n[r];if("countryCode"!==a&&"country"!==a){var i=e.get(n[r]);i&&(i=Array.isArray(i)?i:[i],s.push(this._createAttributePanel(a,i)))}}return s},_createAttributePanel:function(t,e){return[{tag:"h4",text:t},{tag:"div",class:"mpf-constraints-list",html:this._createAttributeConstraintsList(e)}]},_createAttributeConstraintsList:function(t){for(var e=[],s=0;s<t.length;s++)e.push(this._createConstraintTile(t[s]));return e},_createConstraintTile:function(e){for(var s=[],n=e.keys(),r=0;r<n.length;r++)s.push(t.createElement("div",{text:n[r]+": "+e.get(n[r])}));return{tag:"div",class:"mpf-constraint-tile",html:s}},_getSelectedCountry:function(){for(var t=document.querySelectorAll('select[name="country"]'),e=0;e<t.length;e++)if(t[e].value)return t[e].value}})).States=Object.freeze(o),i.Constraints=Object.freeze(c),i}),define("DS/MPFDebugTools/StateDebugView",["UWA/Core","UWA/Class/View","css!DS/MPFDebugTools/MPFDebugTools"],function(t,e){"use strict";return e.extend({className:"mpf-debug-state",setup:function(t){this._title=t.title,this._currentState=t.currentState,this._states=t.states,this._titleElement=this._createTitleElement()},render:function(){var e,s;return s=this._states.map(function(e){var s="mpf-state";return e===this._currentState&&(s+=" mpf-active"),t.createElement("div",{class:s,text:e})},this),e=t.createElement("div",{class:"mpf-state-wrapper",html:s}),this.container.setContent([this._titleElement,e]),this},_createTitleElement:function(){return t.createElement("h4",{text:this._title})}})}),define("DS/MPFDebugTools/ConstraintsDebugComponentFactory",["UWA/Core","UWA/Class","UWA/Promise","DS/MPFConnector/MarketplaceConnector","DS/MPFServices/MarketplaceServices","DS/MPFModelFactory/MPFFactoriesV2","DS/MPFDebugTools/ConstraintsDebugComponent"],function(t,e,s,n,r,a,i){"use strict";var o=e.extend();return o.create=function(t){var e=(t=t||{}).service||r.MAKE;return n.fetchPromise({service:e}).then(function(t){var e=a.getInstance(t);return s.all([e.getFactory(a.Types.ADDRESS),e.getFactory(a.Types.COMPANY),e.getFactory(a.Types.BANK_ACCOUNT)])}).then(function(t){return new i({addressConstraints:t[0].addressesConstraints,companyConstraints:t[1].companyConstraints,bankAccountConstraints:t[2].bankAccountsConstraints})})},o}),define("DS/MPFDebugTools/OrderDebugComponent",["UWA/Core","UWA/Class/View","DS/MPFCartModel/CartModel","DS/MPFCartModel/CartItemModel","DS/MPFCartPhaseModel/CartPhaseModel","DS/MPFDebugTools/StateDebugView","css!DS/MPFDebugTools/MPFDebugTools"],function(t,e,s,n,r,a){"use strict";return e.extend({className:"mpf-debug-order",setup:function(t){this._cart=t.cart,this._cartItems=t.cartItems,this._cartPhases=t.cartPhases,this._cartDebugStateView=this._createCartStateView(),this._cartItemsStateViews=this._createCartItemsStateViews(),this._cartPhasesStateViews=this._createCartPhasesStateViews()},render:function(){var e,s;return e=t.createElement("div",{class:"mpf-cart-items",html:this._cartItemsStateViews.map(function(t){return t.render()})}),s=t.createElement("div",{class:"mpf-phases",html:this._cartPhasesStateViews.map(function(t){return t.render()})}),this.container.setContent([this._cartDebugStateView.render(),e,s]),this},_createCartStateView:function(){return new a({title:"Cart "+this._cart.id,currentState:this._cart.getState(),states:[s.States.DRAFT,s.States.SUBMITTED,s.States.PAYMENT_INITIATED,s.States.PENDING_PAYMENT,s.States.PROCESSING,s.States.DELIVERED,s.States.CANCELLED]})},_createCartItemsStateViews:function(){return this._cartItems.filter(function(t){return"MP_PhaseItem"!==t.getType()}).map(function(t){return new a({title:t.getType()+" / "+t.id,currentState:t.getState(),states:[n.States.DRAFT,n.States.SUBMITTED,n.States.ACCEPTED,n.States.PENDING_PROCESSING,n.States.PROCESSING,n.States.READY,n.States.SHIPPED,n.States.DELIVERED,n.States.DELETED]})})},_createCartPhasesStateViews:function(){return this._cartPhases.map(function(t){return new a({title:"phase "+t.getNumber()+" / "+t.id,currentState:t.getState(),states:[r.States.DRAFT,r.States.SUBMITTED,r.States.ACCEPTED,r.States.PENDING_PROCESSING,r.States.PROCESSING,r.States.READY,r.States.SHIPPED,r.States.DELIVERED,r.States.DELETED]})})}})}),define("DS/MPFDebugTools/OrderDebugComponentFactory",["UWA/Class","UWA/Promise","DS/MPFDebugTools/OrderDebugComponent","DS/MPFConnector/MarketplaceConnector","DS/MPFModelFactory/MPFFactoriesV2","DS/MPFCartModel/CartFactory","DS/MPFCartModel/CartItemFactory","DS/MPFCartPhaseModel/CartPhaseFactory"],function(t,e,s,n,r,a,i,o){"use strict";var c;return(c=t.extend({init:function(t){this.cartId=t.cartId,this.cartFactory=null,this.cartItemsFactory=null,this.cartPhaseFactory=null,this.cart=null,this.cartItems=null,this.cartPhases=null},fromCart:function(t){return this._fetchConnector().then(this._fetchFactories.bind(this)).then(this._fetchModels.bind(this)).then(this._createComponent.bind(this))},_fetchConnector:function(){return n.fetchPromise()},_fetchFactories:function(t){return r.getInstance(t).getFactories([r.Types.CART,r.Types.CART_ITEM,r.Types.CART_PHASE])},_fetchModels:function(t){var s,n,r;return this.cartFactory=t[0],this.cartItemsFactory=t[1],this.cartPhaseFactory=t[2],(s=this.cartFactory.createModel(a.Types.CART)).set("id",this.cartId),(n=this.cartItemsFactory.createCollection(i.Types.CART_CART_ITEM)).setParentResourceId(this.cartId),(r=this.cartPhaseFactory.createCollection(o.Types.CART_CART_PHASE)).setParentResourceId(this.cartId),e.all([s.fetchPromise(),n.fetchPromise(),r.fetchPromise()])},_createComponent:function(t){return this.cart=t[0],this.cartItems=t[1],this.cartPhases=t[2],new s({cart:this.cart,cartItems:this.cartItems,cartPhases:this.cartPhases})}})).fromCart=function(t){return new c({cartId:t}).fromCart(t)},c});