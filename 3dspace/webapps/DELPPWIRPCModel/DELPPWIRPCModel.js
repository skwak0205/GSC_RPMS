define("DS/DELPPWIRPCModel/Model/AbstractIRPCModel",["UWA/Core","UWA/Date","UWA/Class/Model","UWA/Class/Debug","DS/DELPPWModelServices/ModelUtils","DS/DELPPWWebServices/WebserviceUtils","DS/DELPPWLoggerModel/LoggerUtils","DS/DELPPWDicoServices/DicoUtils","DS/DELPPWModelServices/Navigation/IndexedDBUtils"],function(e,t,n,i,o,s,r,c,d){"use strict";return n.extend(i,{idAttribute:"PID",_modelEvents:{},_attributesDef:{},init:function(e,t){(t=t||{}).parse=!0,this._parent(e,t)},destroy:function(t){return d.removeModel(this),this._parent(e.merge({type:"json"},t))},setup:function(){this._parent.apply(this,arguments)},setAdditionalInfo:function(t){var n,i,o=t;e.is(o)&&e.is(this._additionalInfo)&&(e.is(this._additionalInfo.directConnectionsFetched)&&e.is(this._additionalInfo.inverseConnectionsFetched)&&(Object.prototype.hasOwnProperty.call(o,"queriedForConnections")?Object.prototype.hasOwnProperty.call(o,"directConnectionsFetched")||Object.prototype.hasOwnProperty.call(o,"inverseConnectionsFetched")||(o.directConnectionsFetched=o.queriedForConnections,o.inverseConnectionsFetched=o.queriedForConnections):(Object.prototype.hasOwnProperty.call(o,"directConnectionsFetched")||Object.prototype.hasOwnProperty.call(o,"inverseConnectionsFetched"))&&(n=e.is(o.directConnectionsFetched,"boolean")?o.directConnectionsFetched:this._additionalInfo.directConnectionsFetched,i=e.is(o.inverseConnectionsFetched,"boolean")?o.inverseConnectionsFetched:this._additionalInfo.inverseConnectionsFetched,o.queriedForConnections=n&&i)),e.extend(this._additionalInfo,o))},getAdditionalInfo:function(t){if(t&&e.is(this._additionalInfo)&&e.is(this._additionalInfo[t]))return e.result(this._additionalInfo,t)},sync:function(n,i,c){var l,a,u,h,f,P,C,I=this,p=t.now(),g=I._parent,m=c.onComplete,D=c.onFailure,M=c.onTimeout,v=!!e.is(c.forceRefresh)&&c.forceRefresh,b="START - "+n+" request",R=" / Time: "+new t(p).toISOString(),y="END - "+n+" request";if(l=e.is(i.id)?b+" on "+i.id+R:b+R,r.debug(l),e.is(c)&&e.is(c.logMessage)&&r.debug("AbstractIRPCModel",c.logMessage),c.onComplete=function(n,o){var s=!0,u={code:500,message:"",status:"External Server error",type:""};e.is(n)&&e.is(n.type)&&("Generic Error"!==n.type&&"BL Error"!==n.type||(s=!1,u.message=n.message,u.type=n.type)),s?(a=t.now(),C=" / Duration: "+(a-p)+" ms",l=e.is(i.id)?y+" on "+i.id+C:y+C,r.debug(l),e.is(c)&&(e.is(m)&&(m.call(null,n,o),d.storeModel(I)),e.is(c.logMessage)&&r.debug("AbstractIRPCModel success",c.logMessage))):c.onFailure.call(null,u,n,o)},c.onFailure=function(t,i,o){l="FAILURE during "+n+": "+e.Json.encode(t),r.debug(l),e.is(i)||(i=t),e.is(c)&&(e.is(D)&&D.call(null,i,o),e.is(c.logMessage)&&r.debug("AbstractIRPCModel failed",c.logMessage))},c.onTimeout=function(t,i,o){l="TIMEOUT during "+n+": "+e.Json.encode(t),r.debug(l),e.is(c)&&(e.is(M)&&M.call(null,i,o),e.is(c.logMessage)&&r.debug("AbstractIRPCModel timedout",c.logMessage))},P=o.getTimeoutPreference(),e.is(P)&&(c.timeout=P),c.ajax=function(t,n){var i=n||{},o={url:t||"NOURL",data:e.is(i.data)?i.data:"",headers:e.is(i.headers)?i.headers:"",method:e.is(i.method)?i.method:"GET",type:e.is(i.type)?i.type:null,onComplete:e.is(i.onComplete)?i.onComplete:null,onFailure:e.is(i.onFailure)?i.onFailure:null,onTimeout:e.is(i.onTimeout)?i.onTimeout:i.onFailure};return s.webServiceRequest(o),o},o.isStandAlone()||"read"!==n||!o.getNavigateOnIndexedDB()||v)return I._parent.call(I,n,i,c);h=function(e){u=e._attributesDef,this.set(e),this.setAdditionalInfo({queriedForChildren:!1}),this.setAdditionalInfo({queriedForConnections:!1}),c.onComplete({attributesValue:this._attributes,attributesDef:u})}.bind(this),f=function(){return g.call(I,n,i,c)}.bind(this),d.getModel(i,h,f)},parse:function(t){var n;if(t)return n=e.is(t.attributesValue)?this.setTypeAndPPRTYPE(t.attributesValue):this.setTypeAndPPRTYPE(t),Object.keys(n).forEach(function(e){var t,i=c.getAttributeInfo(e),o=!1,s=/^\+?[1-9]\d*$/.test(n[e]);i&&i.AuthorizedValues&&((t=i.AuthorizedValues).forEach(function(t){t.Name===n[e]&&(n[e]=t.NLS,o=!0)}),!o&&s&&(n[e]=t[Number.parseInt(n[e])-1].NLS))}),n},setTypeAndPPRTYPE:function(t){var n,i,o;return"VPMReference"!==t.type&&"ErgoHuman"!==t.type&&""!==t.type||(t.defType=t.type,o=function(e){if(c.isAKindOf(e,"Resource"))return e},i=(Array.isArray(t.interface)?t.interface:[t.interface]).find(o),e.is(i)?(t.type=i,delete t.interface):e.is(t.V_discipline)&&t.V_discipline.length>0&&"NULL"!==t.V_discipline&&(t.baseType=t.type,t.type=t.V_discipline)),t.type&&(n=c.getPPRType(t.type))&&(t.PPRTYPE=n),t},isReference:function(){return!(this.isInstance()||this.isConnection())},isInstance:function(){return this.has("isInstanceOf")},isConnection:function(){return this.has("to")&&this.has("from")}})}),define("DS/DELPPWIRPCModel/Collections/AbstractIRPCCollection",["UWA/Core","UWA/Date","UWA/Class/Collection","UWA/Class/Debug","DS/DELPPWModelServices/ModelUtils","DS/DELPPWWebServices/WebserviceUtils","DS/DELPPWLoggerModel/LoggerUtils"],function(e,t,n,i,o,s,r){"use strict";return n.extend(i,{comparator:"PID",parse:function(t){var n=this,i=function(t){e.is(t.attributesValue)&&(t[n.model.prototype.idAttribute]=t.attributesValue[n.model.prototype.idAttribute])};return Array.isArray(t)?t.forEach(function(e){i(e)}):i(t),t},sync:function(n,i,c){var d,l,a,u=this._parent,h=c.onComplete,f=c.onFailure,P=c.onTimeout,C=t.now(),I="START - "+n+" request",p=" / Time: "+new t(C).toISOString(),g="END - "+n+" request",m=e.is(i.id)?I+" on "+i.id+p:I+p;m=e.is(i.id)?I+" on "+i.id+p:I+p,r.debug(m),e.is(c)&&e.is(c.logMessage)&&r.debug("AbstractIRPCCollection",c.logMessage),l=o.getTimeoutPreference(),e.is(l)&&(c.timeout=l),c.onComplete=function(n,o){var s=!0,l={code:500,message:"",status:"External Server error",type:""};e.is(n)&&e.is(n.type,"string")&&("Generic Error"!==n.type&&"BL Error"!==n.type||(s=!1,l.message=n.message,l.type=n.type)),s?(d=t.now(),a=" / Duration: "+(d-C)+" ms",m=e.is(i.id)?g+" on "+i.id+a:g+a,r.debug(m),e.is(c)&&(e.is(n,"array")&&n.forEach(function(t){e.is(t.attributesValue)&&(t.PID=t.attributesValue.PID)}),e.is(h,"function")&&h.call(null,n,o),e.is(c.logMessage)&&r.debug("AbstractIRPCModel success",c.logMessage))):c.onFailure.call(null,l,n,o)},c.onFailure=function(t,i,o){m="FAILURE during "+n+": "+e.Json.encode(t),r.debug(m),e.is(i)||(i=t),e.is(c)&&(e.is(f)&&f.call(null,i,o),e.is(c.logMessage)&&r.debug("AbstractIRPCCollection failed",c.logMessage))},c.onTimeout=function(t,i,o){m="TIMEOUT during "+n+": "+e.Json.encode(t),r.debug(m),e.is(c)&&(e.is(P)&&P.call(null,i,o),e.is(c.logMessage)&&r.debug("AbstractIRPCCollection timedout",c.logMessage))},c.ajax=function(t,n){var i=n||{},o={url:t||"NOURL",data:e.is(i.data)?i.data:"",headers:e.is(i.headers)?i.headers:"",method:e.is(i.method)?i.method:"GET",type:e.is(i.type)?i.type:null,onComplete:e.is(i.onComplete)?i.onComplete:null,onFailure:e.is(i.onFailure)?i.onFailure:null,onTimeout:e.is(i.onTimeout)?i.onTimeout:i.onFailure,options:c};return s.webServiceRequest(o),o},u.call(this,n,i,c)}})}),define("DS/DELPPWIRPCModel/Model/BIModel",["DS/DELPPWIRPCModel/Model/AbstractIRPCModel"],function(e){"use strict";return e.extend({name:"BIModel",idAttribute:"id"})}),define("DS/DELPPWIRPCModel/Collections/BIModelCollection",["DS/DELPPWIRPCModel/Collections/AbstractIRPCCollection","DS/DELPPWIRPCModel/Model/BIModel"],function(e,t){"use strict";return e.extend({name:"BIModelCollection",model:t,comparator:"id"})}),define("DS/DELPPWIRPCModel/Model/InstanceModel",["UWA/Core","DS/DELPPWIRPCModel/Model/AbstractIRPCModel","DS/DELPPWWebServices/WebserviceUtils","DS/DELPPWModelServices/Navigation/IndexedDBUtils","DS/DELPPWModelParsers/ConnectionParser"],function(e,t,n,i,o){"use strict";return t.extend({name:"InstanceModel",_logger:null,urlRoot:function(){return n.getWebServicesURL()+"/instance"},defaultAdditionalInfo:{queriedForConnections:!1,directConnectionsFetched:!1,inverseConnectionsFetched:!1},setup:function(t,i){this._parent.apply(this,arguments),this._additionalInfo||(this._additionalInfo=e.clone(this.defaultAdditionalInfo)),e.is(n.instanceModelSetup)&&n.instanceModelSetup(this,i)},parse:function(t,s){var r,c,d={},l=this._parent.apply(this,arguments),a={};if(l){if(this._additionalInfo||(this._additionalInfo=e.clone(this.defaultAdditionalInfo)),e.is(s)&&e.is(s.request)&&e.is(s.request.method,"string")&&"POST"===s.request.method&&this.setAdditionalInfo({queriedForConnections:!0,directConnectionsFetched:!0,inverseConnectionsFetched:!0}),e.is(t.queriedForConnections)&&(a.queriedForConnections=t.queriedForConnections,delete t.queriedForConnections),e.is(t.directConnectionsFetched)&&(a.directConnectionsFetched=t.directConnectionsFetched,delete t.directConnectionsFetched),e.is(t.inverseConnectionsFetched)&&(a.inverseConnectionsFetched=t.inverseConnectionsFetched,delete t.inverseConnectionsFetched),e.is(t.filterQuery)&&(a.filterQuery=t.filterQuery,delete t.filterQuery),Object.keys(a).length>0&&this.setAdditionalInfo(a),e.is(n.referenceModelParse))n.referenceModelParse(this,l,s);else if(e.is(s.request)&&e.is(s.request.method,"string")&&"POST"===s.request.method){for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(r.contains("to.")&&(d[r.substring(r.indexOf("to.")+3)]=t[r]),"connections"===r&&t.connections.forEach(function(e){o.parse(e)}));Object.keys(d).length>0&&(c=this.collection.referenceCollection.add(d,{silent:!0}))&&(c.setAdditionalInfo({queriedForChildren:!0,queriedForConnections:!0}),i.storeModel(c))}return e.is(this.collection)&&e.is(l)&&e.is(l.PID)&&e.is(l.isAggregatedBy)&&e.is(l.isInstanceOf)&&(this.collection.addChildInfo(l.isAggregatedBy,l.PID),this.collection.addRefInfo(l.isInstanceOf,l.PID)),l}}})}),define("DS/DELPPWIRPCModel/Collections/InstanceCollection",["UWA/Core","DS/DELPPWIRPCModel/Collections/AbstractIRPCCollection","DS/DELPPWIRPCModel/Model/InstanceModel","DS/DELPPWWebServices/WebserviceUtils"],function(e,t,n,i){"use strict";return t.extend({name:"InstanceCollection",model:n,childInfoCache:{},refInfoCache:{},comparator:null,setup:function(){this.childInfoCache={},this.refInfoCache={}},url:function(){return i.getWebServicesURL()+"/instance"},remove:function(t,n){var i=this;return(Array.isArray(t)?t:[t]).forEach(function(t){e.is(t)&&e.is(t.has)&&t.has("isAggregatedBy")&&t.has("isInstanceOf")&&t.has("PID")&&(i.removeChildInfo(t.get("isAggregatedBy"),t.get("PID")),i.removeRefInfo(t.get("isInstanceOf"),t.get("PID")))}),this._parent.call(this,t,n)},reset:function(e,t){return this.childInfoCache={},this.refInfoCache={},this._parent.call(this,e,t)},getChildren:function(t){var n=[];return e.is(t)&&e.is(this.childInfoCache[t])&&(n=this._getInstances(this.childInfoCache[t])),n},getInstancesForGivenReference:function(t){var n=[];return e.is(t)&&e.is(this.refInfoCache[t])&&(n=this._getInstances(this.refInfoCache[t])),n},_getInstances:function(t){var n=this,i=[];return Array.isArray(t)&&t.forEach(function(t){var o=n.get(t);e.is(o)&&i.push(o)}),i},addChildInfo:function(e,t){this._addToCache.call(this.childInfoCache,e,t)},addRefInfo:function(e,t){this._addToCache.call(this.refInfoCache,e,t)},_addToCache:function(t,n){e.is(this[t])||(this[t]=[]),this[t].indexOf(n)<0&&this[t].push(n)},removeChildInfo:function(e,t){this._removeFromCache.call(this.childInfoCache,e,t)},removeRefInfo:function(e,t){this._removeFromCache.call(this.refInfoCache,e,t)},_removeFromCache:function(t,n){var i=-1;e.is(this[t])&&(i=this[t].indexOf(n))>-1&&this[t].splice(i,1)}})}),define("DS/DELPPWIRPCModel/Model/ReferenceModel",["UWA/Core","DS/DELPPWIRPCModel/Model/AbstractIRPCModel","DS/DELPPWWebServices/WebserviceUtils","DS/DELPPWIndexServices/IndexParser"],function(e,t,n,i){"use strict";return t.extend({name:"ReferenceModel",idAttribute:"PID",urlRoot:function(){return n.getWebServicesURL()+"/reference"},defaultAdditionalInfo:{queriedForDocuments:!1,queriedForChildren:!1,queriedForConnections:!1,directConnectionsFetched:!1,inverseConnectionsFetched:!1},setup:function(t,i){this._parent.apply(this,arguments),this._additionalInfo||(this._additionalInfo=e.clone(this.defaultAdditionalInfo)),e.is(n.referenceModelSetup)&&n.referenceModelSetup(this,i)},isSystem:function(){var t,n=this.get("PPRTYPE");return e.is(n)&&(t="SYSTEM"===n||"OPERATION"===n),t},isWorkInstruction:function(){var t,n=this.get("PPRTYPE");return e.is(n)&&(t="WORKINSTRUCTION"===n),t},isProcess:function(){var t,n=this.get("PPRTYPE");return e.is(n)&&(t="PROCESS"===n),t},isResource:function(){var t,n=this.get("PPRTYPE");return e.is(n)&&(t="RESOURCE"===n),t},isPart:function(){var t=!1,n=this.get("PPRTYPE");return e.is(n)&&"PART"===n&&(t=!0),t},isProduct:function(){var t=!1,n=this.get("PPRTYPE");return e.is(n)&&"PRODUCT"===n&&(t=!0),t},parse:function(t,o){var s,r=this._parent.apply(this,arguments),c={};if(r)return this._additionalInfo||(this._additionalInfo=e.clone(this.defaultAdditionalInfo)),e.is(n.referenceModelParse)&&n.referenceModelParse(this,r,o),e.is(o)&&e.is(o.request)&&e.is(o.request.method,"string")&&"POST"===o.request.method&&this.setAdditionalInfo({queriedForChildren:!0,queriedForConnections:!0,directConnectionsFetched:!0,inverseConnectionsFetched:!0,queriedForDocuments:!0}),e.is(t.queriedForChildren)&&(c.queriedForChildren=t.queriedForChildren,delete t.queriedForChildren),e.is(t.queriedForConnections)&&(c.queriedForConnections=t.queriedForConnections,delete t.queriedForConnections),e.is(t.directConnectionsFetched)&&(c.directConnectionsFetched=t.directConnectionsFetched,delete t.directConnectionsFetched),e.is(t.inverseConnectionsFetched)&&(c.inverseConnectionsFetched=t.inverseConnectionsFetched,delete t.inverseConnectionsFetched),e.is(t.queriedForDocuments)&&(c.queriedForDocuments=t.queriedForDocuments,delete t.queriedForDocuments),e.is(t.ds6w)&&(c.ds6w=t.ds6w,delete t.ds6w),Object.keys(c).length>0&&this.setAdditionalInfo(c),!r.PID&&e.is(r._results)&&(s=i.translatePredicateToAttribute(r,{type:"entity",fromExpandService:r._results}),r=e.merge(r,s)),r}})}),define("DS/DELPPWIRPCModel/Collections/ReferenceCollection",["DS/DELPPWIRPCModel/Collections/AbstractIRPCCollection","DS/DELPPWIRPCModel/Model/ReferenceModel","DS/DELPPWWebServices/WebserviceUtils"],function(e,t,n){"use strict";return e.extend({name:"ReferenceCollection",comparator:"PID",model:t,_collectionEvents:{},setup:function(){},url:function(){return n.getWebServicesURL()+"/reference"}})}),define("DS/DELPPWIRPCModel/Model/ConnectionModel",["UWA/Core","DS/DELPPWIRPCModel/Model/AbstractIRPCModel","DS/DELPPWWebServices/WebserviceUtils","DS/DELPPWModelParsers/ConnectionParser"],function(e,t,n,i){"use strict";return t.extend({name:"ConnectionModel",defaults:{},getAttribute:function(e){var t=this.get(e);return"to"!==e&&"from"!==e||(t=Array.isArray(t)?t[t.length-1]:t),t},setup:function(t,i){e.is(n.connectionModelSetup)&&n.connectionModelSetup(this,i)},parse:function(t,n){var o;if(t=e.is(t)&&e.is(t.connections)?i.parseAuthoringResponse(t,n):this._parent.apply(this,arguments),e.is(t)&&e.is(t.PID)&&e.is(this.collection)&&(this.collection.get(t.PID)||-1===t.PID.indexOf("ProductImplementLinkOcc|")&&-1===t.PID.indexOf("ProductImplementLink|")||(o=this.collection.findWhere({from:t.from,type:t.type}))&&this.collection.remove(o),e.is(t.from)&&e.is(t.to))){var s=Array.isArray(t.from)?t.from.slice(-1)[0]:t.from,r=Array.isArray(t.to)?t.to.slice(-1)[0]:t.to;this.collection.addImpactInfo(s,t.PID),this.collection.addImpactInfo(r,t.PID)}return t},destroy:function(){var t,o;return arguments[0],e.is(n.connectionModelSetup)||(o=arguments[0].onComplete,t=function(t,n,s){i.parseAuthoringResponse(n),e.is(o)&&o.apply(this,arguments)},arguments[0]=e.merge({onComplete:t},arguments[0])),this._parent.apply(this,arguments)}})}),define("DS/DELPPWIRPCModel/Collections/ConnectionCollection",["UWA/Core","DS/DELPPWIRPCModel/Collections/AbstractIRPCCollection","DS/DELPPWIRPCModel/Model/ConnectionModel","DS/DELPPWWebServices/WebserviceUtils"],function(e,t,n,i){"use strict";return t.extend({name:"ConnectionCollection",model:n,url:function(){var e=i.getWebServicesURL();return this._isER?e+="/erconnection":e+="/connection",e},setup:function(t){var n;e.is(t)&&(n=t.isER,e.is(n,"boolean")&&(this._isER=n)),this.impactedInfo={}},useERObjects:function(t){e.is(t,"boolean")&&(this._isER=t)},isER:function(){return this._isER},remove:function(t,n){var i=this;return(Array.isArray(t)?t:[t]).forEach(function(t){e.is(t)&&e.is(t.has)&&t.has("from")&&t.has("to")&&t.has("PID")&&(i.removeImpactInfo(t.getAttribute("from"),t.getAttribute("PID")),i.removeImpactInfo(t.getAttribute("to"),t.getAttribute("PID")))}),this._parent.call(this,t,n)},reset:function(e,t){return this.impactedInfo={},this._parent.call(this,e,t)},getImpactedConnections:function(t,n,i){var o,s,r=this,c=[];return e.is(t)&&e.is(this.impactedInfo[t])&&this.impactedInfo[t].forEach(function(t){s=r.get(t),e.is(s)&&c.push(s)}),n&&e.is(this._byId)&&0===c.length&&(this.referenceCollection._models.forEach(function(e){"VPMReference"===e.get("type")&&(o=e.id)}),s=this.get(i[0]+"|"+t+"|"+o),e.is(s)&&c.push(s)),c},addImpactInfo:function(t,n){e.is(this.impactedInfo[t])||(this.impactedInfo[t]=[]),this.impactedInfo[t].indexOf(n)<0&&this.impactedInfo[t].push(n)},removeImpactInfo:function(t,n){if(e.is(this.impactedInfo[t])){var i=this.impactedInfo[t].indexOf(n);i>-1&&this.impactedInfo[t].splice(i,1)}}})});