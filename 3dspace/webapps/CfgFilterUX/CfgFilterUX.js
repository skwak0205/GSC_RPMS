define("DS/CfgFilterUX/CfgFilterSlideInComponent",["UWA/Class/View","DS/Controls/Button","DS/Handlebars/Handlebars4","DS/UIKIT/Tooltip","i18n!DS/CfgFilterUX/assets/nls/CfgFilterUX","DS/UIKIT/Mask","css!DS/CfgFilterUX/CfgFilterUX.css"],function(e,t,i,n,o,a,s){return{init:function(e,s,r,l,c,d){var u=UWA.createElement("div",{class:"operations-main-container",id:"operations-container"});r.filterTitle=o.CFG_Filter_Title;var p=i.compile(l);u.innerHTML=p(r),e.appendChild(u);var h=document.querySelector("#cfgslideInBody");c&&h.appendChild(c),s&&h.appendChild(s),d&&h.appendChild(d);var f=[],C=this;C.options=r,r.dialogue.buttonArray.forEach(function(e){var i=new t({label:e.label,id:"cfg"+e.label+"id",emphasize:e.className});i.addEventListener("buttonclick",function(t){e.handler()}),1==C.options.displayCompactMode?i.touchMode=!1:i.touchMode=!0,f.push(i)});var g=document.querySelector("#cfgslideInFooter");if(0!=f.length)for(k=f.length-1;k>=0;k--)g.appendChild(f[k].getContent()),f[k].getContent().setStyle("margin-right","5px");var m=document.querySelector("#checkCfgfilterBtn");if(m&&new n({className:"filterValidate",id:"filterValidateId",position:"top",target:m,body:o.CFG_Configuration_Validate_Filter,trigger:"touch"}),r.dialogue.showButton){document.querySelector("#cfgfilterBackBtn").addEventListener("click",function(e){document.querySelector(".operations-main-container").destroy(),require(["DS/CfgFilterUX/CfgFilterFactory"],function(e){e.showFilter()})},!1),require(["DS/CfgFilterUX/CfgFilterFactory"],function(e){e.hideFilter()})}else a.unmask(e)}}}),define("DS/CfgFilterUX/CfgChangeActionCriteria",["UWA/Drivers/Alone","DS/Core/Core","DS/Controls/TooltipModel","UWA/Class/View","DS/CfgBaseUX/scripts/CfgData","DS/CfgBaseUX/scripts/CfgUtility","UWA/Class/Promise","DS/CfgBaseUX/scripts/CfgXMLServices","DS/UIKIT/Mask","DS/CfgBaseUX/scripts/CfgSearchConfiguration","i18n!DS/CfgFilterUX/assets/nls/CfgFilterUX","css!DS/CfgEvolutionUX/CfgEvolutionUX.css","css!DS/CfgFilterUX/CfgFilterUX.css"],function(e,t,i,n,o,a,s,r,l,c,d){"use strict";return n.extend({editButton:null,textdiv:null,xml:"",xmlDesc:[],caLabelIdentifierMap:null,excludeCAList:[],json:null,displayExpression:"",currentSelectedFilterView:"",setup:function(e){this._parent(e),this.caLabelIdentifierMap=new Map,this.excludeCAList=[]},render:function(){var e=this;e.currentSelectedFilterView=e.options.currentSelectedFilterView,this.textBox=UWA.createElement("div").inject(this.options.parentElement),this.textBox.addClassName("CfgEditor"),this.textBox.set({events:{click:function(t){""==this.innerHTML&&e.onCriteriaClickHandler(t)}}}),this.editButton=UWA.createElement("span").inject(this.options.parentElement),this.editButton.set({events:{click:function(t){e.onCriteriaClickHandler(t)}}}),this.editButton.addClassName("fonticon"),this.editButton.addClassName("fonticon-1.5x"),this.editButton.addClassName("fonticon-search"),this.editButton.addClassName("searchbutton"),o.ModelEvents.subscribe({event:"FilterViewChanged"},function(t){e.currentSelectedFilterView=t.currentSelectedView}),this.applyCompactComfortableMode()},applyCompactComfortableMode:function(){null==this.options.displayCompactMode||!1===this.options.displayCompactMode?(this.textBox.setAttributeNode(document.createAttribute("touch-mode")),this.editButton&&this.editButton.setAttributeNode(document.createAttribute("touch-mode"))):(this.textBox.removeAttribute("touch-mode"),this.editButton&&this.editButton.removeAttribute("touch-mode"))},getAttrValue:function(e,t){var i="";return null!=e&&(i=e.get(t)),i},onCriteriaClickHandler:function(e){var t=this,i=d.selectChangeActionForFilter,n=enoviaServerFilterWidget.myRole,o='(current:"In Work" OR current:"In Approval" OR current:"Approved"';"Source"==this.currentSelectedFilterView.view&&(o+=' OR current:"Complete"'),o+=")";var s=t.excludeCAList;if("Native"==window.enoviaServerFilterWidget.mode){for(var r="",l=0;l<s.length;l++)r=r+"NOT (physicalid:"+s[l]+")";""!=s&&(o+=r);var u={precondition:o},p={eventName:"cfgConfigurationFilter",operation:"ActivateSearchCA",operationVersion:"1.0",content:JSON.stringify(u)};a.sendNotificationWebInWin(p)}else{new c(!0,i).activate(i,"Change Action",n,function(e){t.xml="",e.forEach(function(e,i){var n=t.getAttrValue(e,"ds6w:label"),o=t.getAttrValue(e,"ds6w:identifier"),a=t.getAttrValue(e,"id");t.createCADiv(n),t.caLabelIdentifierMap.set(n,{identifier:o,physicalID:a}),t.excludeCAList.push(a)}),t.buildFilterXML()},"",s,o)}},createCADiv:function(e){var t=this;this.caDiv=new UWA.createElement("span",{class:"caDiv"}).inject(this.textBox),UWA.createElement("span",{class:"caLabelSpan"}).inject(this.caDiv).innerHTML=e,UWA.createElement("span",{class:"fonticon fonticon-cancel"}).inject(this.caDiv).set({events:{click:function(e){e.cancelBubble=!0;var i=this.getParent(),n=this.getParent().getElementsByClassName("caLabelSpan")[0].innerHTML,o=t.caLabelIdentifierMap.get(n);t.caLabelIdentifierMap.delete(n);var a=t.excludeCAList.indexOf(o.physicalID);t.excludeCAList.splice(a,1),i.destroy(),t.buildFilterXML()}}})},clearCAComponent:function(){this.textBox.innerHTML="",this.displayExpression="",this.xml="",this.caLabelIdentifierMap.clear(),this.excludeCAList=[]},updateDisplayExpression:function(e){this.displayExpression=e},buildDisplayExpression:function(){return this.displayExpression},buildFilterJson:function(){return this.options.psJson},getFilterXML:function(){return this.xml},buildFilterXML:function(){var e=this;e.xml="";var t=0,i="";return this.caLabelIdentifierMap.forEach(function(n,o){e.xml+='<OperationHandler Name="'+n.identifier+'" Type="Change" OperationHandlerId="'+t+'"/>',0==t?i+=o:i=i+", "+o,t++}),e.updateDisplayExpression(i),this.xml},setFilterXML:function(e){this.xml=e},buildDescription:function(){return this.xmlDesc},show:function(){this.textBox.show(),this.editButton&&this.editButton.show()},hide:function(){this.textBox.hide(),this.editButton&&this.editButton.hide()},initialiseComponent:function(e){var t,i=this,n="",o="",s="";null==e.caNameArray&&null==e.caNameArray||e.caNameArray.forEach(function(e,t){0==t?s+="([ds6w:identifier]:("+e+"))":s=s+" OR ([ds6w:identifier]:("+e+"))"}),null==e.caIDArray&&null==e.caIDArray||e.caIDArray.forEach(function(e,t){s=0==t?"physicalid:"+e:s+" OR physicalid:"+e});n={with_indexing_date:!0,with_nls:!1,label:"yus-1515078503005",locale:"en",select_predicate:["ds6w:label","ds6w:description","ds6w:identifier"],select_file:["icon","thumbnail_2d"],query:"flattenedtaxonomies:(types/Change Action) AND ("+s+")",order_by:"desc",order_field:"relevance",nresults:1e3,start:"0",source:[],tenant:enoviaServerFilterWidget.tenant};t={isfederated:"true"};n=JSON.stringify(n);a.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",n,function(e){e.results.forEach(function(e,t){if(null!=e&&e.attributes.length>0){for(var n="",a="",s="",r=0;r<e.attributes.length;r++)"ds6w:label"==e.attributes[r].name?(n=e.attributes[r].value,0==t?o+=e.attributes[r].value:o=o+", "+e.attributes[r].value):"ds6w:identifier"==e.attributes[r].name?a=e.attributes[r].value:"resourceid"==e.attributes[r].name&&(s=e.attributes[r].value);i.createCADiv(n),i.caLabelIdentifierMap.set(n,{identifier:a,physicalID:s}),i.excludeCAList.push(s)}}),i.buildFilterXML()},function(e){reject(e)},!0,t)}})}),define("DS/CfgFilterUX/CfgFilterEditor",["UWA/Drivers/Alone","DS/Core/Core","UWA/Class/View","DS/Handlebars/Handlebars4","text!DS/CfgBaseUX/scripts/CfgDialogTemplate.html","DS/UIKIT/Alert","DS/UIKIT/Modal","DS/Controls/Toggle","DS/CfgEvolutionUX/CfgModelSelection","DS/CfgEvolutionUX/CfgProductState","DS/CfgFilterUX/CfgChangeActionCriteria","DS/CfgBaseUX/scripts/CfgData","UWA/Class/Promise","DS/CfgBaseUX/scripts/CfgXMLServices","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgEvolutionUX/CfgDatePicker","DS/CfgEvolutionUX/CfgWUXDatePicker","DS/CfgEvolutionUX/CfgUnit","DS/CfgEvolutionUX/CfgVariants","DS/CfgEvolutionUX/CfgConfigurationRevisionPicker","DS/CfgFilterUX/CfgFilterSlideInComponent","DS/UIKIT/Mask","DS/CfgEvolutionUX/CfgFilterView","DS/CfgEvolutionUX/CfgEvolutionViewSelector","DS/CfgBaseUX/scripts/CfgSearchConfiguration","DS/CfgBaseUX/scripts/CfgDialog","DS/CfgBaseUX/scripts/CfgCacheManager","DS/CfgTracker/CfgTracker","DS/CfgTracker/CfgDimension","DS/CfgTracker/CfgValue","text!DS/CfgBaseUX/assets/CfgUXEnvVariables.json","text!DS/CfgFilterUX/CfgFilterslideInTemplate.html","i18n!DS/CfgFilterUX/assets/nls/CfgFilterUX","i18n!DS/CfgEvolutionUX/assets/nls/CfgEvolutionUX","i18n!DS/CfgEffectivityViewUX/assets/nls/CfgEffectivityView","css!DS/UIKIT/UIKIT.css","css!DS/CfgFilterUX/CfgFilterUX.css"],function(e,t,i,n,o,a,s,r,l,c,d,u,p,h,f,C,g,m,v,b,x,D,F,y,k,S,I,E,P,N,A,w,_,M,U){"use strict";var O=n.compile(o);return i.extend({name:"filter-dialog-view",globalDisplayExpression:"",globalDisplayExpressionNative:"",tagName:"div",ModelSelectionComponent:null,alertDiv:null,productstateCheckbox:null,ProductStateComponent:null,currentSelectedView:{view:""},DateCheckbox:null,DatePicker:null,UnitCheckbox:null,UnitComponent:null,VariantsCheckbox:null,VariantsComponent:null,filter150Checkbox:null,manufacturingplanComponent:null,manufacturingplanCheckbox:null,configurationRevisionCheckbox:null,cfgConfigurationRevisionPicker:null,init:function(e){this.singleProductEvolutionStatus=!0,e.EvolutionLabel=_.Filter_Evolution,e.ModelLabel=_.Filter_Model,e.VariantsLabel=_.Filter_Variants,e.ChangeLabel=_.Filter_Change;var t="";e.expression.filterXML?(t=h.FilterXMLtoJSONConvertor(e.expression.filterXML),h.RetrieveVariantXMLFromFilterXML(e.expression),f.isDefined(e.expression.variants)&&(t[0].expression.iVariantsJson=e.expression.variants),t[0].expression.viewJson={view:e.expression.view},t[0].expression.modelId=e.expression.modelId,e.expression=t[0].expression):f.isDefined(e.expression.variants)&&(e.expression.iVariantsJson=e.expression.variants),0!=Object.keys(e.expression).length&&this.checkSingleProductID(e.expression),this._parent(e),u.clear();var i="Native"==enoviaServerFilterWidget.mode?document.body.querySelector(".wiwFilterAlertDiv"):document.body.querySelector(".f-globalFilter-container");this.alertDiv=new a({visible:!1,autoHide:!0,hideDelay:3e3,closeOnClick:!0,maximumVisibleMessages:3,className:"error"}),this.alertDiv.inject(i,"top")},getDataFromID:function(e){var t=this;return new p(function(i,n){if(!f.isParamDefined(e.physical_id))return void i();let o={id:e.physical_id},a=JSON.stringify(o);f.makeWSCall("/resources/v1/modeler/dspfl/invoke/dspfl:getCriteriaConfigurationInstances?xrequestedwith=xmlhttprequest","POST","enovia","application/json",a,function(n){if(f.isParamDefined(n.modelVersion)||(t.alertDiv.add({message:_.Filter_MVNotFound,style:{position:"absolute"},className:"error"}),t.alertDiv.show(),t.options.expression={},n.modelVersion=!1),!f.isDefined(n.member)||!Array.isArray(n.member))return t.alertDiv.add({message:_.Filter_Error_FetchDataUsing_ConfigID,style:{position:"absolute"},className:"error"}),t.alertDiv.show(),t.options.expression={},n.modelVersion=!1,void i();var o="",a=new v({});o=(o=a.getXMLExpressionFromPCCriteria(n)).replace(/&(?!amp;)/g,"&amp;");var s=a.getDisplayXMLExpressionFromPCCriteria(n);s=s.replace(/&(?!amp;)/g,"&amp;");var r=h.startFilterXML()+s+h.endFilterXML(),l={displayExpression:decodeURIComponent(f.getDisplayExpressionUsingXSLT(r)),xmlExpression:o,basedOnMVID:n.modelVersion,selectedPCPID:e.physical_id,selectedPCDisplayName:n.title,selectedPCMode:n.selectionMode};0!=Object.keys(t.options.expression).length&&f.isParamDefined(l)&&(t.options.expression.iVariantsJson=l,"Refine"===n.selectionMode&&(t.options.expression.refineModecheckbox=!0)),i()},function(e){t.alertDiv.add({message:_.Filter_Error_FetchDataUsing_ConfigID,style:{position:"absolute"},className:"error"}),t.alertDiv.show()},!0,null)})},checkSingleProductID:function(e){return this.promiseSingleMVID=new p(function(t,i){if(""!=e.xmlExpression&&null!=e.xmlExpression&&null!=e.xmlExpression){if(-1!=e.xmlExpression.indexOf("<Tree>")||e.psJson.length>1)return u.singleProductId="",void t();var n=(new DOMParser).parseFromString(e.xmlExpression,"text/xml").getElementsByTagName("Single");if(0!=n.length){var o=n[0].attributes.Name.value,a=n[0].attributes.Revision.value,s=(n[0].attributes.DescId.value,{with_indexing_date:!0,with_nls:!1,label:"yus-1515078503005",locale:"en",select_predicate:["ds6w:label","ds6wg:revision","revision","ds6w:type","ds6w:description","ds6w:identifier","ds6w:modified","ds6w:created","ds6w:responsible","ds6w:lastModifiedBy","ds6wg:marketing_Name"],select_file:["icon","thumbnail_2d"],query:"flattenedtaxonomies:(types/Products) AND ("+("(([name]:("+o+")) AND ([ds6wg:revision]:("+a+")))")+")",order_by:"desc",order_field:"relevance",nresults:1e3,start:"0",source:[],tenant:enoviaServerFilterWidget.tenant});s=JSON.stringify(s);f.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",s,function(e){var n="";if(f.isDefined(e.results)&&f.isDefined(e.results[0])&&f.isDefined(e.results[0].attributes)){if(e.results[0].attributes.length>0)for(var o=0;o<e.results[0].attributes.length;o++)"resourceid"==e.results[0].attributes[o].name&&(n=e.results[0].attributes[o].value);u.singleProductId=n,t()}else i("Filter_MVNotFound")},function(){i("Filter_MVSearchFailed")},!0,{isfederated:"true"})}else t()}else t()}),this.promiseSingleMVID},getModelMarketingName:function(e){for(var t=0;t<e.length;t++)if("Marketing Name"==e[t].name)return e[t].value},getModelName:function(e){for(var t=0;t<e.length;t++)if("name"==e[t].name){if(Array.isArray(e[t].value))return e[t].value;var i=[];return i.push(e[t].value),i}},getCRNodeInfo:function(e){var t="",i="",n="";if(null!=e.data[0]&&0!=Object.keys(e.data[0].dataelements).length&&(t=e.data[0].dataelements.revision,n=e.data[0].dataelements.title,i=e.data[0].dataelements.title),""!=t&&""!=i&&""!=n)return{id:this.options.expression.configurationRevision,physicalid:this.options.expression.configurationRevision,type:"ConfiguredBaseline",displayName:n,revision:t,name:i}},publishFilterViewChangeEvent:function(){u.ModelEvents.publish({event:"FilterViewChanged",data:{currentSelectedView:this.currentSelectedView}})},clearCAComponent:function(){f.isDefined(this.changeActionComponent)&&this.changeActionComponent.clearCAComponent(),f.isDefined(this.changeActionCheckbox)&&(this.changeActionCheckbox.checkFlag=!1,this.changeActionComponent.hide())},render:function(){var e=this;f.rolesAvailable(t=>{e.userGrantedRoles=t,u.renderTo=e.options.renderTo,u.renderToApp=e.options.renderToApp,this.container.setHTML(O(this.options));var i={dialogue:{buttonArray:[],showHeader:!1}};i.displayCompactMode=this.options.displayCompactMode,document.querySelector(".operations-main-container")&&document.querySelector(".operations-main-container").destroy(),x.init(u.renderTo,this.container,i,w);var n=document.querySelector("#checkCfgfilterBtn");n.addEventListener("click",function(t){if(null!=e.UnitComponent&&0==e.UnitComponent.validate())return;""==e.VariantsComponent.textBox.getText()&&(e.VariantsComponent.xmlExpression="",e.VariantsComponent.displayExpression="");null!=e.manufacturingplanComponent&&""==e.manufacturingplanComponent.textBox.getText()&&(e.manufacturingplanComponent.xml="",e.manufacturingplanComponent.displayExpression="");e.onApplyFilter(t,e)},!1),"Native"==enoviaServerFilterWidget.mode&&n.hide();var o=this.options.iModelsList.length,a=[],s="",p=null,h=null,C=!0,b=!1,D=!1,F=!1,k=-1;0!=Object.keys(e.options.expression).length&&(s=e.options.expression.modelId,p=e.options.expression.psJson,h=e.options.expression.mpJson,C=e.options.expression.productstatecheckbox,b=e.options.expression.unitcheckbox,D=e.options.expression.datestatecheckbox,F=e.options.expression.manufacturingplanCheckbox);for(var S=0;S<o;S++){var E=this.getModelMarketingName(this.options.iModelsList[S].data),P=this.getModelName(this.options.iModelsList[S].basicData),N={valueItem:this.options.iModelsList[S].physicalID,labelItem:E,name:P};this.options.iModelsList[S].physicalID==s&&(k=S,N.selected=!0),a.push(N)}if(-1==k&&""!=s)return e.alertDiv.add({message:_.Filter_Error_Models_in_filter,style:{position:"absolute"},className:"error"}),e.alertDiv.elements.container.addClassName("CfgAlertstyle"),e.alertDiv.show(),void e.options.callback([]);-1==k&&""==s&&(k=0);var A={};A.Data=a,A.currentindex=k,A.parentElement=this.container.getElement(".filter-dialog-models"),this.ModelSelectionComponent=new l(A),this.ModelSelectionComponent.render();var L={elementsList:[{labelItem:U.OFFICIAL_LABEL,valueItem:"Official"},{labelItem:U.PROJECTED_LABEL,valueItem:"Projected"}],officialViewHandler:function(){e.officialProjViewHandling()},projectedViewHandler:function(){e.officialProjViewHandling()},changeViewHandler:function(){if(f.isDefined(e.cfgConfigurationRevisionPicker)&&f.isDefined(e.cfgConfigurationRevisionPicker.selectedNode)&&1==e.configurationRevisionCheckbox.checkFlag)return e.viewPanelCombo.set(e.currentSelectedView),void f.showwarning(_.Change_view_not_selectable,"info");e.currentSelectedView=e.viewPanelCombo.get(),e.publishFilterViewChangeEvent(),f.isDefined(e.changeActionCheckbox)&&(e.changeActionCheckbox.checkFlag=!0,e.changeActionCheckbox.visibleFlag=!0),f.isDefined(e.changeActionComponent)&&e.changeActionComponent.show(),f.isDefined(document.getElementsByClassName("filter-dialog-Changelabel")[0])&&document.getElementsByClassName("filter-dialog-Changelabel")[0].setAttribute("style","display:block"),e.container.getElement(".filter-dialog-model-criteria").hide(),e.container.getElement(".filter-dialog-viewpanel2").setContent(e.viewPanelCombo),e.container.getElement(".filter-dialog-viewpanel2").setStyle("display","flex")},displayCompactMode:e.options.displayCompactMode};if(e.userGrantedRoles.isCFGRoleAvail&&(e.userGrantedRoles.isCHGRoleAvail&&L.elementsList.push({labelItem:U.CHANGE_LABEL,valueItem:"Change"}),e.isLicenseValid=!0,e.viewPanelCombo=new y(L),e.container.getElement(".filter-dialog-viewpanel").setContent(e.viewPanelCombo.render()),0!=Object.keys(e.options.expression).length&&null!=e.options.expression.viewJson&&null!=e.options.expression.viewJson&&e.viewPanelCombo.set(e.options.expression.viewJson),e.currentSelectedView=e.viewPanelCombo.get()),e.userGrantedRoles.isCSVRoleAvail&&(e.isLicenseValid=!1),null!=p&&(1!=p.length||1==p.length&&f.isDefined(p[0].start)&&1==p[0].start.isRoot)&&(e.singleProductEvolutionStatus=!1),this.ModelSelectionComponent.getcriteriasAvailable(this.ModelSelectionComponent).then(function(t){u.criteriasAvailable=t.criteria[0],console.log(u.criteriasAvailable);var i={};i.parentElement=e.container.getElement(".filter-dialog-productstates"),i.psJson=p,null!=p&&p.length>1&&(e.singleProductEvolutionStatus=!1),i.expression=e.options.expression,i.mode="PRODUCTS",i.use="FILTER",i.displayCompactMode=e.options.displayCompactMode,e.productstateCheckbox=new r({type:"checkbox",value:"PSComponent",className:"primary",label:_.Filter_Product_State}).inject(e.container.getElement(".filter-dialog-productstates-checkbox")),e.productstateCheckbox.addEventListener("buttonclick",function(){!0===e.productstateCheckbox.checkFlag?e.ProductStateComponent.show():(e.ProductStateComponent.hide(),null!=e.VariantsComponent.configuratorButton&&e.VariantsComponent.configuratorButton.addClassName("disableButton")),null!=e.ProductStateComponent.options.psJson&&null!=e.ProductStateComponent.options.psJson&&Array.isArray(e.ProductStateComponent.options.psJson)&&e.ProductStateComponent.options.psJson.length>0&&(e.isRoot=e.ProductStateComponent.options.psJson[0].start.isRoot,e.length=e.ProductStateComponent.options.psJson.length),u.ModelEvents.publish({event:"ProductStatecheckbox",data:{model:e.productstateCheckbox.checkFlag,isRoot:e.isRoot,psJsonLength:e.ProductStateComponent.options.psJson.length}})}),e.ProductStateComponent=new c(i),e.ProductStateComponent.render(),u.productstateCheckbox=e.productstateCheckbox,u.ProductStateComponent=e.ProductStateComponent;var n=u.CurrentFilterModel={model:a[k]};if(0!=Object.keys(i.expression).length&&i.expression.iVariantsJson.basedOnMVID?(e.ProductStateComponent.setExpression(n),e.ProductStateComponent.setMVAssociatedWithPC(n,i.expression.iVariantsJson.basedOnMVID)):0!=Object.keys(i.expression).length?e.ProductStateComponent.setExpression(n):e.ProductStateComponent.setLastMainEvolution(n),null!=u.criteriasAvailable&&"FALSE"==u.criteriasAvailable.products&&(u.productstateCheckbox.hide(),u.ProductStateComponent.hide(),C=!1),1==C?(e.productstateCheckbox.checkFlag=!0,e.ProductStateComponent.show()):(e.ProductStateComponent.hide(),e.productstateCheckbox.checkFlag=!1,e.singleProductEvolutionStatus=!0,null!=e.VariantsComponent.configuratorButton&&e.VariantsComponent.configuratorButton.addClassName("disableButton")),0!=Object.keys(i.expression).length&&i.expression.iVariantsJson.basedOnMVID&&(e.productstateCheckbox.checkFlag=!0,e.ProductStateComponent.show()),1==e.userGrantedRoles.isCFGRoleAvail){var o={};o.parentElement=e.container.getElement(".filter-dialog-manufacturingplans"),o.psJson=h,o.expression=e.options.expression,o.mode="MANUFACTURINGPLAN",o.use="FILTER",o.displayCompactMode=e.options.displayCompactMode,e.manufacturingplanCheckbox=new r({type:"checkbox",value:"PSComponent",className:"primary",label:M.Manufacturing_Plan}).inject(e.container.getElement(".filter-dialog-manufacturingplans-checkbox")),e.manufacturingplanCheckbox.addEventListener("buttonclick",function(){!0===e.manufacturingplanCheckbox.checkFlag?e.manufacturingplanComponent.show():e.manufacturingplanComponent.hide()}),e.manufacturingplanComponent=new c(o),e.manufacturingplanComponent.render(),u.manufacturingplanComponent=e.manufacturingplanComponent,u.manufacturingplanCheckbox=e.manufacturingplanCheckbox;n=u.CurrentFilterModel={model:a[k]};e.manufacturingplanComponent.setExpression(n),null!=u.criteriasAvailable&&"False"==u.criteriasAvailable.manufacturingPlans&&(u.manufacturingplanCheckbox.hide(),u.manufacturingplanComponent.hide(),F=!1),1==F?(e.manufacturingplanCheckbox.checkFlag=!0,e.manufacturingplanComponent.show()):(e.manufacturingplanComponent.hide(),e.manufacturingplanCheckbox.checkFlag=!1)}if(1==e.userGrantedRoles.isCFGRoleAvail&&1==u.configurationCriteria.unit){e.UnitCheckbox=new r({type:"checkbox",value:"UnitComponent",className:"primary",label:_.Filter_Unit,events:{onChange:function(){}}}).inject(e.container.getElement(".filter-dialog-unit-checkbox")),e.UnitCheckbox.addEventListener("buttonclick",function(){!0===e.UnitCheckbox.checkFlag?(e.UnitComponent.show(),e.UnitComponent.updateDictionary(u.CurrentFilterModel).then(function(){e.UnitComponent.checkUnitsAllocation()})):(e.UnitComponent.hide(),f.isDefined(e.UnitComponent.atLeastOneUnitAllocated)&&1==e.UnitComponent.atLeastOneUnitAllocated&&e.showOrHideComponentsExceptUnit({unitAllocation:!1}))}),u.ModelEvents.subscribe({event:"showOrHideComponentsExceptUnit"},function(t){!0===e.UnitCheckbox.checkFlag&&(null==I.get("bShowFilterUnitAllocWarning")||1==I.get("bShowFilterUnitAllocWarning")?e.showWarning(t):e.showOrHideComponentsExceptUnit(t))}),u.ModelEvents.subscribe({event:"modelUpdated"},function(t){e.showOrHideComponentsExceptUnit({unitAllocation:!1})});var s=null;0!=Object.keys(e.options.expression).length&&(s=e.options.expression.iUnitJson);var l=e.container.getElement(".filter-dialog-unit");if(e.UnitComponent=new m({displayCompactMode:e.options.displayCompactMode,parentElement:l,mode:"UNIT",invokeFrom:"Filter",filterParent:e.options.renderToApp}),e.UnitComponent.render(),u.UnitComponent=e.UnitComponent,u.UnitCheckbox=e.UnitCheckbox,e.UnitComponent.SetJson(s),null!=u.criteriasAvailable&&"FALSE"==u.criteriasAvailable.builds&&(u.UnitCheckbox.hide(),u.UnitComponent.hide(),b=!1),1==b)e.UnitComponent.show(),e.UnitCheckbox.checkFlag=!0,e.UnitComponent.updateDictionary({model:a[k]}).then(function(){e.UnitComponent.checkUnitsAllocation()});else e.UnitComponent.hide()}null!=e.options.FilterType&&"Volatile"!=e.options.FilterType||f.getAllowedSemantics(e.options.rootId).then(function(t){if(f.isBaselineMode(e.options.rootId,t)&&0==f.isFirstSemantic(e.options.rootId,t)){var i=null;if(Object.keys(e.options.expression).length&&""!=e.options.expression.configurationRevision&&null!=e.options.expression.configurationRevision&&null!=e.options.expression.configurationRevision)f.getObjectInfo(e.options.expression.configurationRevision).then(function(t){i=e.getCRNodeInfo(t),e.updateConfigurationRevision(i)});else e.updateConfigurationRevision(i)}}),e.applyCompactComfortableMode(e.options.displayCompactMode)}),1==this.userGrantedRoles.isCFGRoleAvail&&1==u.configurationCriteria.contextualDate){this.DateCheckbox=new r({type:"checkbox",value:"DateComponent",className:"primary",label:_.Filter_Date,checkFlag:!1}).inject(this.container.getElement(".filter-dialog-date-checkbox"));var R=null;e.DateCheckbox.addEventListener("buttonclick",function(){!0===e.DateCheckbox.checkFlag?e.DatePicker.show():e.DatePicker.hide()}),0!=Object.keys(e.options.expression).length&&(R=e.options.expression.iDateJson);var T=this.container.getElement(".filter-dialog-date");this.DatePicker=new g(T,R,{view:"show",defaultDateBehavior:"SingleDate",displayCompactMode:e.options.displayCompactMode}),this.DatePicker.render(),u.DateCheckbox=this.DateCheckbox,u.DatePicker=this.DatePicker,1==D?(e.DatePicker.show(),this.DateCheckbox.checkFlag=!0):(this.DatePicker.hide(),this.DateCheckbox.checkFlag=!1)}var V="";0!=Object.keys(e.options.expression).length&&(V=e.options.expression.iVariantsJson);var X=this.singleProductEvolutionStatus;V&&V.selectedOptionsforConfigurator?u.selectedOptionsforConfigurator=V.selectedOptionsforConfigurator:u.selectedOptionsforConfigurator="";var B={};if(B.status=X,B.iUnitJson=V,B.parentElement=this.container.getElement(".filter-dialog-variants"),B.invokeFrom="Filter",B.filterParent=this.options.renderToApp,B.filterParentContainer=this.options.renderTo,B.userGrantedRoles=this.userGrantedRoles,B.tenant=this.options.tenant,B.displayCompactMode=e.options.displayCompactMode,this.VariantsComponent=new v(B),this.VariantsComponent.render(),this.updateVariantsComponent(),this.filter150Checkbox=new r({type:"checkbox",value:"filter150Component",className:"primary",label:_.filter150,checkFlag:!1}).inject(this.container.getElement(".filter-dialog-150-checkbox")),this.filter150Checkbox.addEventListener("change",t=>{f.isParamDefined(e.VariantsComponent.selectedPCPID)||e.VariantsComponent.clearProductConfLabelInfo(),I.set({bFilterMode150:t.dsModel.checkFlag},!1),1==t.dsModel.checkFlag?f.isParamDefined(e.VariantsComponent.selectedPCPID)&&"Refine"!==e.VariantsComponent.selectedPCMode&&e.VariantsComponent.clearProductConfLabelInfo():f.isParamDefined(e.VariantsComponent.selectedPCPID)&&"Refine"===e.VariantsComponent.selectedPCMode&&e.VariantsComponent.clearProductConfLabelInfo()}),u.filter150Checkbox=this.filter150Checkbox,0==Object.keys(this.options.expression).length?("CfgFilter150"==this.options.filterMode||I.get("bFilterMode150"))&&(u.filter150Checkbox.checkFlag=!0):(I.set({bFilterMode150:this.options.expression.refineModecheckbox},!1),this.options.expression.refineModecheckbox&&(u.filter150Checkbox.checkFlag=!0)),u.ModelEvents.publish({event:"modelUpdated",data:{noEvolutionUpdate:!0,model:a[k]}}),1==this.userGrantedRoles.isCHGRoleAvail&&1==this.userGrantedRoles.isCFGRoleAvail){this.changeActionCheckbox=new r({type:"checkbox",value:"ChangeActionComponent",className:"primary",label:_.Filter_ChangeAction,checkFlag:!1}).inject(this.container.getElement(".filter-dialog-changeaction-checkbox"));var G={displayCompactMode:e.options.displayCompactMode,currentSelectedFilterView:e.currentSelectedView};G.parentElement=e.container.getElement(".filter-dialog-changeaction"),e.changeActionComponent=new d(G),e.changeActionComponent.render(),Object.keys(e.options.expression).length>0&&f.isDefined(e.options.expression.caxml)&&e.changeActionComponent.setFilterXML(e.options.expression.caxml),e.changeActionComponent.hide(),f.isDefined(e.options.expression.configurationRevision)&&""!=e.options.expression.configurationRevision&&e.container.getElement(".filter-dialog-Change").hide();Object.keys(e.options.expression).length>0&&f.isDefined(e.options.expression.caNameArray)&&e.options.expression.caNameArray.length>0&&(e.changeActionComponent.initialiseComponent(e.options.expression),e.changeActionCheckbox.checkFlag=!0,e.changeActionComponent.show()),e.changeActionCheckbox.addEventListener("buttonclick",function(){!0===e.changeActionCheckbox.checkFlag?e.changeActionComponent.show():e.changeActionComponent.hide()}),u.ModelEvents.subscribe({event:"CRSelected"},function(t){e.container.getElement(".filter-dialog-Change").hide()}),u.ModelEvents.subscribe({event:"CRDelected"},function(t){e.container.getElement(".filter-dialog-Change").show()})}else e.container.getElement(".filter-dialog-Change").hide();if("Native"==enoviaServerFilterWidget.mode){var W={};if(f.isDefined(e.options.PCID)&&""!=e.options.PCID){W={id:e.options.PCID};e.onPCSearchOKFilter(W)}}null!=this.options.expression.psJson&&Array.isArray(this.options.expression.psJson)&&this.options.expression.psJson.length>0&&1==this.options.expression.psJson[0].start.isRoot&&document.getElementById("edit").addClassName("disableButton"),f.isParamDefined(e.VariantsComponent)&&f.isParamDefined(e.VariantsComponent.configuratorButton)&&0!=Object.keys(e.options.expression).length&&(e.VariantsComponent.configuratorButton.addClassName("cfgWaitCursor"),e.promiseSingleMVID.then(()=>{e.VariantsComponent.configuratorButton.removeClassName("cfgWaitCursor")},t=>{e.VariantsComponent.configuratorButton.removeClassName("cfgWaitCursor"),e.VariantsComponent.configuratorButton.addClassName("disableButton");let i="";"Filter_MVSearchFailed"==t?i=_.Filter_MVSearchFailed:"Filter_MVNotFound"==t&&(i=_.Filter_MVNotFound),e.alertDiv.add({message:i,style:{position:"absolute"},className:"error"}),e.alertDiv.show()})),u.ModelEvents.subscribe({event:"NoSingleProductId"},function(t){e.VariantsComponent.configuratorButton.hasClassName("cfgWaitCursor")&&(e.alertDiv.add({message:_.Filter_WaitingToComputeSingleMVID,style:{position:"absolute"},className:"error"}),e.alertDiv.show())})})},updateConfigurationRevision:function(e){var t=this;t.configurationRevisionCheckbox=new r({type:"checkbox",value:"ConfigurationRevision",className:"primary",label:M.ConfigurationRevision}).inject(t.container.getElement(".filter-dialog-ConfiguredRevision-checkbox"));var i={parentElement:t.container.getElement(".filter-dialog-ConfiguredRevision"),iSelectedId:e,iRootId:t.options.rootId,displayCompactMode:t.options.displayCompactMode};t.cfgConfigurationRevisionPicker=new b(i),t.cfgConfigurationRevisionPicker.render(),Object.keys(t.options.expression).length&&null!=t.options.expression.configurationRevision?t.configurationRevisionCheckbox.checkFlag=!0:(t.configurationRevisionCheckbox.checkFlag=!1,t.cfgConfigurationRevisionPicker.hide()),0==Object.keys(t.options.expression).length&&(t.configurationRevisionCheckbox.checkFlag=!0,t.cfgConfigurationRevisionPicker.show()),t.configurationRevisionCheckbox.addEventListener("buttonclick",function(){!0===t.configurationRevisionCheckbox.checkFlag?(t.cfgConfigurationRevisionPicker.show(),f.isDefined(t.cfgConfigurationRevisionPicker.selectedNode)&&t.container.getElement(".filter-dialog-Change").hide()):(t.cfgConfigurationRevisionPicker.hide(),t.container.getElement(".filter-dialog-Change").show())})},validateCFFilter:function(){return null==this.UnitComponent||0!=this.UnitComponent.validate()},updateVariantsComponent:function(){this.VariantsComponent.enableDisableEditVariantfromProductEvolution()},getFilterDisplayXML:function(){var e=this.ModelSelectionComponent.getSelectedModelName(),t="";f.isDefined(this.viewPanelCombo)&&"Official"===(t=this.viewPanelCombo.get().view)&&(t="Current");var i="";this.productstateCheckbox&&1==this.productstateCheckbox.checkFlag&&0!=this.productstateCheckbox.visibleFlag&&(i=this.ProductStateComponent.buildDisplayExpression());var n="";this.manufacturingplanCheckbox&&1==this.manufacturingplanCheckbox.checkFlag&&0!=this.manufacturingplanCheckbox.visibleFlag&&(n=this.manufacturingplanComponent.buildDisplayExpression());var o="",a="";this.UnitCheckbox&&1==this.UnitCheckbox.checkFlag&&0!=this.UnitCheckbox.visibleFlag&&""!=(o=this.UnitComponent.buildUnitXML(e[0]))&&(a=f.getDisplayExpressionUsingXSLT(h.startFilterXML()+o+h.endFilterXML()));var s="",r="";this.DateCheckbox&&1==this.DateCheckbox.checkFlag&&0!=this.DateCheckbox.visibleFlag&&""!=(s=this.DatePicker.getXML())&&(r=f.getDisplayExpressionUsingXSLT(h.startFilterXML()+s+h.endFilterXML()));var l=this.VariantsComponent.getDisplayExpression();0==this.VariantsComponent.visibleFlag&&(l="");var c="";f.isDefined(this.changeActionComponent)&&f.isDefined(this.changeActionCheckbox)&&!0===this.changeActionCheckbox.checkFlag&&0!=this.changeActionCheckbox.visibleFlag&&(c=this.changeActionComponent.buildDisplayExpression());var d=!1;return null!=this.cfgConfigurationRevisionPicker&&null!=this.cfgConfigurationRevisionPicker.selectedNode&&1==this.configurationRevisionCheckbox.checkFlag&&(c="",d=!0),"Source"!==t||d||(i="",n="",r="",a="",l=""),this.globalDisplayExpression=i+n+a+r+l+c,"Native"==enoviaServerFilterWidget.mode?(""!=i&&(i=_.Filter_Product_State+" "+i+"\n"),""!=n&&(n=M.Manufacturing_Plan+" "+n+"\n"),""!=a&&(a=_.Filter_Unit+a+"\n"),""!=r&&(r=_.Filter_Date+" "+r+"\n"),""!=l&&(l+="\n"),""!=c&&(c=_.Filter_ChangeAction+" "+c+"\n"),this.globalDisplayExpressionNative=i+n+a+r+l+c,this.globalDisplayExpressionNative):this.globalDisplayExpression},buildFilterXML:function(){var e=this.ModelSelectionComponent.getSelectedModelName(),t=null==this.ProductStateComponent?null:this.ProductStateComponent.buildFilterXML();null==this.productstateCheckbox||0!=this.productstateCheckbox.checkFlag&&0!=this.productstateCheckbox.visibleFlag||(t="");var i=null==this.manufacturingplanComponent?null:this.manufacturingplanComponent.buildFilterXML();null==this.manufacturingplanCheckbox||0!=this.manufacturingplanCheckbox.checkFlag&&0!=this.manufacturingplanCheckbox.visibleFlag||(i="");var n=null==this.UnitComponent?null:this.UnitComponent.buildUnitXML(e[0]);null==this.UnitCheckbox||0!=this.UnitCheckbox.checkFlag&&0!=this.UnitCheckbox.visibleFlag||(n="");var o=this.VariantsComponent.getXml();o=h.getValidXmlWithoutDisplayName(o),0==this.VariantsComponent.visibleFlag&&(o="");var a="",s="";s=1==this.filter150Checkbox.checkFlag?"150%":"Strict",f.isDefined(this.viewPanelCombo)&&"Official"===(a=this.viewPanelCombo.get().view)&&(a="Current");var r=null==this.DatePicker?null:this.DatePicker.getXML();if(null!=r&&(null==this.DateCheckbox||0!=this.DateCheckbox.checkFlag&&0!=this.DateCheckbox.visibleFlag)||(r=""),t&&-1==t.search("TreeSeries"))var l=h.buildTreeSeries("ProductState",e[0],t);else l=t;if(i&&-1==i.search("TreeSeries"))var c=h.buildTreeSeries("ManufPlan",e[0],i);else c=i;var d="";f.isDefined(this.changeActionComponent)&&f.isDefined(this.changeActionCheckbox)&&!0===this.changeActionCheckbox.checkFlag&&0!=this.changeActionCheckbox.visibleFlag&&(d=this.changeActionComponent.getFilterXML()),""!=t&&null!=t||(l=""),""!=i&&null!=i||(c=""),""!=r&&null!=r||(r=""),""!=n&&null!=n||(n=""),""!=o&&null!=o||(o=""),""!=d&&null!=d||(d="");var u=""==l&&""==c&&""==r&&""==n&&""==o&&""==d,p=!1,C="";if(null!=this.cfgConfigurationRevisionPicker&&null!=this.cfgConfigurationRevisionPicker.selectedNode&&1==this.configurationRevisionCheckbox.checkFlag&&(C=this.cfgConfigurationRevisionPicker.selectedNode.id,d="",p=!0),"Source"!==a||p||(l="",c="",r="",n="",o=""),this.crFilter=!1,"Native"==enoviaServerFilterWidget.mode&&""==l&&""==c&&""==r&&""==n&&""==o&&""==d&&1==p&&(this.crFilter=!0),this.finalXML=h.startFilterXML(a,s,C,u)+l+c+r+n+o+d,u||(this.finalXML+="</FilterSelection>"),""!=l||""!=c||""!=o){var g=this;this.finalXML+="<Description>",""!=l&&(Array.isArray(this.ProductStateComponent.xmlDesc)?this.ProductStateComponent.xmlDesc.forEach(function(e){g.finalXML+=e}):this.finalXML+=this.ProductStateComponent.xmlDesc),""!=c&&(Array.isArray(this.manufacturingplanComponent.xmlDesc)?this.manufacturingplanComponent.xmlDesc.forEach(function(e){g.finalXML+=e}):this.finalXML+=this.manufacturingplanComponent.xmlDesc),""!=o&&this.VariantsComponent.xmlDesc&&(Array.isArray(this.VariantsComponent.xmlDesc)?this.VariantsComponent.xmlDesc.forEach(function(e){g.finalXML+=e}):this.finalXML+=this.VariantsComponent.xmlDesc),this.finalXML=this.finalXML+"</Description>"}return this.finalXML=this.finalXML+"</CfgFilterExpression>",this.finalXML=this.finalXML.replace(/&(?!amp;)/g,"&amp;"),console.log(this.finalXML),this.finalXML},officialProjViewHandling:function(){"Source"==this.currentSelectedView.view&&this.clearCAComponent(),f.isDefined(this.UnitCheckbox)&&1==this.UnitCheckbox.checkFlag&&f.isDefined(this.UnitComponent.atLeastOneUnitAllocated)&&1==this.UnitComponent.atLeastOneUnitAllocated&&this.showOrHideComponentsExceptUnit({unitAllocation:!0}),this.currentSelectedView=this.viewPanelCombo.get(),this.publishFilterViewChangeEvent(),this.container.getElement(".filter-dialog-model-criteria").show(),this.container.getElement(".filter-dialog-model-criteria").setStyle("display","flex"),this.container.getElement(".filter-dialog-viewpanel2").setStyle("display","none"),this.container.getElement(".filter-dialog-viewpanel").setContent(this.viewPanelCombo)},applyCompactComfortableMode:function(e){!0===e?this.container.getElements("*").forEach(function(e){e.removeAttribute("touch-mode")}):this.container.getElements("*").forEach(function(e){e.setAttributeNode(document.createAttribute("touch-mode"))}),null!=this.UnitComponent&&(this.UnitComponent.options.displayCompactMode=e),null!=this.manufacturingplanComponent&&(this.manufacturingplanComponent.options.displayCompactMode=e),null!=this.ProductStateComponent&&(this.ProductStateComponent.options.displayCompactMode=e),null!=this.DatePicker&&(this.DatePicker.options.displayCompactMode=e),null!=this.cfgConfigurationRevisionPicker&&(this.cfgConfigurationRevisionPicker.options.displayCompactMode=e)},onApplyFilter:function(e){var t=this,i="";if(f.isDefined(this.viewPanelCombo)&&"Official"===(i=this.viewPanelCombo.get().view)&&(i="Current"),(0==t.filter150Checkbox.checkFlag||1==t.filter150Checkbox.checkFlag&&"Refine"===t.VariantsComponent.selectedPCMode)&&!(""==u.singleProductId||null==t.productstateCheckbox||1!=t.productstateCheckbox.checkFlag||null!=t.manufacturingplanCheckbox&&0!=t.manufacturingplanCheckbox.checkFlag||null!=t.UnitComponent&&0!=t.UnitCheckbox.checkFlag||null!=t.DateCheckbox&&0!=t.DateCheckbox.checkFlag||""==t.VariantsComponent.selectedPCPID||"Projected"==i||null!=t.configurationRevisionCheckbox&&0!=t.configurationRevisionCheckbox.checkFlag)){var n=t.getFilterDisplayXML(),o={};return o[t.options.rootId]={displayExpression:f.isParamDefined(t.VariantsComponent.selectedPCDisplayName)?t.VariantsComponent.selectedPCDisplayName:n,config_filter_id:{physical_id:t.VariantsComponent.selectedPCPID},expression:{modelId:t.ModelSelectionComponent.get(),view:i}},t.options.callback([o]),document.querySelector(".operations-main-container").destroy(),t.sendConfigurationFilterTrackerEvent(),u.singleProductId="",null}return new p(function(e,n){if(!t.userGrantedRoles.isCFGRoleAvail)return t.alertDiv.add({message:_.Filter_AccessRightsError,style:{position:"absolute"},className:"error"}),t.alertDiv.show(),void e(!1);var o=t.buildFilterXML(),a={version:"1.2",output:{targetFormat:"TXT"},expression:{version:"0.1",format:"xml",content:h.removeDescFromXML(o)},dictionary:{version:"0.1",id:{pid:t.ModelSelectionComponent.get()}}};a=JSON.stringify(a);f.makeWSCall("/resources/modeler/configuration/filteringServices/createVolatileFilter","POST","enovia","application/json",a,function(n){var a=t.options.rootId,s=t.getFilterDisplayXML(),r=null==t.configurationRevisionCheckbox?null:t.configurationRevisionCheckbox.checkFlag,l=null==t.cfgConfigurationRevisionPicker||null==t.cfgConfigurationRevisionPicker.selectedNode?null:{id:t.cfgConfigurationRevisionPicker.selectedNode.id};t.configurationRevisionCheckbox&&0==r&&(l=null),t.configurationRevisionCheckbox&&1==r&&null!=l&&(s=t.cfgConfigurationRevisionPicker.selectedNode.displayName+"-"+t.cfgConfigurationRevisionPicker.selectedNode.revision+" "+s);var c={};c[a]={displayExpression:s,compiledBinary:n.filterBinaryForExpand,expression:{configurationRevision:l,modelId:t.ModelSelectionComponent.get(),filterXML:o,view:i,variants:{variant:t.VariantsComponent.getSelectedVariant(),displayExpression:t.VariantsComponent.getJson(),selectedOptionsforConfigurator:u.selectedOptionsforConfigurator,configuratorOptions:t.VariantsComponent.getConfiguratorOptions()}}},t.options.callback([c]),null!=document.querySelector(".operations-main-container")&&document.querySelector(".operations-main-container").destroy(),e(!0),t.sendConfigurationFilterTrackerEvent(o),u.singleProductId=""},function(){t.alertDiv.add({message:_.Filter_Error_CompiledBinary,style:{position:"absolute"},className:"error"}),t.alertDiv.show(),e(!0)},!0)})},getDisplayXMLExpressionForVariants:function(e,t){var i={},n="";if(e.seletedoptionsexist=!1,null!=e.results[0]&&e.results[0].attributes.length>0){for(var o=0;o<e.results[0].attributes.length;o++)if("CONFIGURATION_FEATURE"==e.results[0].attributes[o].name){var a=e.results[0].attributes[o].value.split(":");if(null==i[a[0]]){if(a[0]===t.model.name[0])continue;i[a[0]]=[a[1]],(s=[]).push(a[1]),i[a[0]]=s,e.seletedoptionsexist=!0}else{var s;(s=i[a[0]]).push(a[1]),i[a[0]]=s}}Object.keys(i).forEach(function(e,t){for(var o="",a=0;a<i[e].length;a++){var s=encodeURIComponent(i[e][a]);o+=h.buildOption(s)}if(0!=i[e].length.length){var r=encodeURIComponent(e);n+=h.buildFeature(r,o)}})}return n},applyFilterFromFiringProcess:function(e){var t=this,i=!1;if(t.options.configData.PCID&&(i=!0),!i){var n=t.options.configData.filterXML;if(!f.isParamDefined(n))return;var o=h.removeDescFromXML(t.options.configData.filterXML);if(null==o||""==o)return}return new p(async function(e,a){var s="";s=i?"/search?xrequestedwith=xmlhttprequest":"/resources/modeler/configuration/filteringServices/createVolatileFilter";var r=t.options.configData.context.model.valueItem,l="",c={};i?(l={with_indexing_date:!0,with_nls:!1,label:"yus-1515078503005",locale:"en",select_predicate:["ds6w:label","ds6w:type","ds6wg:marketing_Name"],select_file:["icon","thumbnail_2d"],query:"flattenedtaxonomies:(types/Product Configuration) AND ( physicalid:("+t.options.configData.PCID+") ) ",order_by:"desc",order_field:"relevance",nresults:1e3,start:"0",source:[],tenant:t.options.tenant},c={isfederated:"true"}):l={version:"1.2",output:{targetFormat:"TXT"},expression:{version:"0.1",format:"xml",content:o},dictionary:{version:"0.1",id:{pid:r}}};l=JSON.stringify(l);try{await f.populate3DSpaceURL(),f.isParamDefined(enoviaServerFilterWidget.mySecurityContext)||await f.populateSecurityContext(),await f.populateDisplayExpressionXSLT(),await f.makeWSCall(s,"POST","enovia","application/json",l,function(o){let a="",s=t.options.rootId,r={};if(i)a=new v({}).getAttrValue(o,"ds6w:label"),r[s]={displayExpression:a,config_filter_id:{physical_id:t.options.configData.PCID},expression:{modelId:t.options.configData.context.model.valueItem}},t.options.callback([r]),e(!0),t.sendConfigurationFilterTrackerEvent(n),u.singleProductId="";else{let i="";i=o.filterBinaryForExpand,a=f.getDisplayExpressionUsingXSLT(n),r[s]={filterName:"Configuration Filter ",displayExpression:a,compiledBinary:i,expression:{modelId:t.options.configData.context.model.valueItem,filterXML:n,variants:{}}},t.options.callback([r]),e(!0),t.sendConfigurationFilterTrackerEvent(n),u.singleProductId=""}},function(){t.alertDiv.add({message:_.Filter_Error_CompiledBinary,style:{position:"absolute"},className:"error"}),t.alertDiv.show(),e(!0)},!0,c)}catch(e){console.log(e),a(e)}})},getDataForWIWFilter:function(){var e="",t="";f.isDefined(this.viewPanelCombo)&&"Official"===(t=this.viewPanelCombo.get().view)&&(t="Current"),(0==this.filter150Checkbox.checkFlag||1==this.filter150Checkbox.checkFlag&&"Refine"===this.VariantsComponent.selectedPCMode)&&(""==u.singleProductId||null==this.productstateCheckbox||1!=this.productstateCheckbox.checkFlag||null!=this.manufacturingplanCheckbox&&0!=this.manufacturingplanCheckbox.checkFlag||null!=this.UnitComponent&&0!=this.UnitCheckbox.checkFlag||null!=this.DateCheckbox&&0!=this.DateCheckbox.checkFlag||""==this.VariantsComponent.selectedPCPID||"Projected"==t||null!=this.configurationRevisionCheckbox&&0!=this.configurationRevisionCheckbox.checkFlag||(e=this.VariantsComponent.selectedPCPID));var i="";null==this.configurationRevisionCheckbox||1!=this.configurationRevisionCheckbox.checkFlag||null==this.cfgConfigurationRevisionPicker.selectedNode&&null==this.cfgConfigurationRevisionPicker.selectedNode||(this.cfgConfigurationRevisionPicker.selectedNode.id,i=M.ConfigurationRevision+" "+this.cfgConfigurationRevisionPicker.selectedNode.displayName+"-"+this.cfgConfigurationRevisionPicker.selectedNode.revision+"\n");var n=this.buildFilterXML(),o=this.getFilterDisplayXML(),a={variants:{variant:this.VariantsComponent.getSelectedVariant(),displayExpression:this.VariantsComponent.getJson(),selectedOptionsforConfigurator:u.selectedOptionsforConfigurator,configuratorOptions:this.VariantsComponent.getConfiguratorOptions()},PC:{PCID:e},Tooltip:i+o};1==JSON.parse(A).filterXMLWithoutDescriptionInSetInfo&&(a.filterXMLWithoutDesc=h.removeDescFromXML(n));var s=this.ModelSelectionComponent.get();if(1==this.crFilter){var r={crFilter:"true",crID:this.cfgConfigurationRevisionPicker.selectedNode.id};s=""}return{filterName:"",filterDescription:"",filterXML:n,filterXMLWithoutDesc:h.removeDescFromXML(n),modelId:s,view:t,filterUXData:a,crData:r}},onPCSearchOKFilter:function(e){var t={};t.id=e.id,t.label=e.label;var i={displayExpression:JSON.stringify(t),xmlExpression:""};return this.VariantsComponent.selectedPCPID=e.id,this.VariantsComponent.processProductConfiguration(i,this.VariantsComponent)},onCASearchOKFilter:function(e){this.changeActionComponent.initialiseComponent(e)},showOrHideComponentsExceptUnit:function(e){1==e.unitAllocation?(f.isDefined(this.productstateCheckbox)&&(this.productstateCheckbox.visibleFlag=!1),f.isDefined(this.manufacturingplanCheckbox)&&(this.manufacturingplanCheckbox.visibleFlag=!1),f.isDefined(this.DateCheckbox)&&(this.DateCheckbox.visibleFlag=!1),f.isDefined(this.changeActionCheckbox)&&this.changeActionCheckbox.hide(),f.isDefined(this.ProductStateComponent)&&this.ProductStateComponent.hide(),f.isDefined(this.manufacturingplanComponent)&&this.manufacturingplanComponent.hide(),f.isDefined(this.DatePicker)&&this.DatePicker.hide(),f.isDefined(this.changeActionComponent)&&this.changeActionComponent.hide(),f.isDefined(this.VariantsComponent)&&this.VariantsComponent.hide(),f.isDefined(document.getElementsByClassName("filter-dialog-Changelabel")[0])&&document.getElementsByClassName("filter-dialog-Changelabel")[0].setAttribute("style","display:none")):(f.isDefined(this.productstateCheckbox)&&(this.productstateCheckbox.show(),f.isDefined(this.ProductStateComponent)&&1==this.productstateCheckbox.checkFlag&&this.ProductStateComponent.show()),f.isDefined(this.manufacturingplanCheckbox)&&(this.manufacturingplanCheckbox.show(),f.isDefined(this.manufacturingplanComponent)&&1==this.manufacturingplanCheckbox.checkFlag&&this.manufacturingplanComponent.show()),f.isDefined(this.DateCheckbox)&&(this.DateCheckbox.show(),f.isDefined(this.DatePicker)&&1==this.DateCheckbox.checkFlag&&this.DatePicker.show()),f.isDefined(this.changeActionCheckbox)&&(this.changeActionCheckbox.show(),f.isDefined(this.changeActionComponent)&&1==this.changeActionCheckbox.checkFlag&&this.changeActionComponent.show()),f.isDefined(this.VariantsComponent)&&this.VariantsComponent.show(),f.isDefined(document.getElementsByClassName("filter-dialog-Changelabel")[0])&&document.getElementsByClassName("filter-dialog-Changelabel")[0].setAttribute("style","display:block"))},showWarning:function(e){var t=this,i=function(){t.UnitCheckbox.checkFlag=!1,t.UnitComponent.hide(),t.showOrHideComponentsExceptUnit({unitAllocation:!1}),o.closeDialog()},n={width:539,height:210,isResizable:!1,dialogue:{header:_.warning,buttonArray:[{label:_.Filter_Apply,labelValue:"OK",handler:function(){t.showOrHideComponentsExceptUnit(e),o.closeDialog()},className:"primary"},{label:_.Filter_Cancel,labelValue:"Cancel",handler:i,className:"default"}],target:document.getElementById("cfgslideInBody"),object:null,postCrossHandler:i}},o=new S(n);o.render(),o.container.setStyle("overflow","auto"),o.container.setHTML(_.Cfg_Unit_allocation_warning+"<br><br>"+_.Want_To_Continue+"<br>");var a=new r({label:_.Do_not_show_again});a.addEventListener("change",function(e){1==e.dsModel.checkFlag?I.set({bShowFilterUnitAllocWarning:!1},!0):I.set({bShowFilterUnitAllocWarning:!0},!0)}),a.inject(o.container)},sendConfigurationFilterTrackerEvent:function(e){var t="";t=f.isDefined(enoviaServerFilterWidget)&&"Native"==enoviaServerFilterWidget.mode?"Web In Win":"Dashboard";var i=E.getDeviceUsedForOperation(),n="";n=0!=Object.keys(this.options.expression).length?E.ConfigOperationMode.EDIT:E.ConfigOperationMode.CREATE;var o="Official";let a="";f.isDefined(this.viewPanelCombo)&&(o=this.viewPanelCombo.get().view,a=this.viewPanelCombo.get().view);var s=E.Availability.FALSE;(0==this.filter150Checkbox.checkFlag||1==this.filter150Checkbox.checkFlag&&"Refine"===this.VariantsComponent.selectedPCMode)&&(""==u.singleProductId||null==this.productstateCheckbox||1!=this.productstateCheckbox.checkFlag||null!=this.manufacturingplanCheckbox&&0!=this.manufacturingplanCheckbox.checkFlag||null!=this.UnitComponent&&0!=this.UnitCheckbox.checkFlag||null!=this.DateCheckbox&&0!=this.DateCheckbox.checkFlag||""==this.VariantsComponent.selectedPCPID||"Projected"==a||null!=this.configurationRevisionCheckbox&&0!=this.configurationRevisionCheckbox.checkFlag||(s=E.Availability.TRUE));var r=E.Availability.FALSE,l=E.ConfigCriteriaSelected.NONE,c=E.ConfigCriteriaSelected.NONE,d=E.ConfigCriteriaSelected.NONE,p=E.ConfigCriteriaSelected.NONE,C=E.Availability.FALSE,g=E.ConfigCriteriaSelected.NONE,m=E.Availability.FALSE,v=E.Availability.FALSE,b=E.Availability.FALSE,x=1,D=0,F=0,y=0,k=0,S=0,I=0,A=0,w=0,_=0;if(f.isDefined(e)){let t=h.FilterXMLtoJSONConvertor(e)[0].expression;t.filterXML=e,h.RetrieveVariantXMLFromFilterXML(t),f.isDefined(t.refineModecheckbox)&&(r=t.refineModecheckbox?E.Availability.TRUE:E.Availability.FALSE);var M=!1,U=!1;if(t.psJson.length>0&&(t.psJson.forEach(e=>{1==e.start.isRoot?(U=!0,D++):0==e.start.isRoot&&(M=!0,F++)}),M&&U?l=E.ConfigCriteriaSelected.BOTH:M&&!U?l=E.ConfigCriteriaSelected.SINGLE:!M&&U&&(l=E.ConfigCriteriaSelected.RANGE)),M=!1,U=!1,t.mpJson.length>0&&(t.mpJson.forEach(e=>{1==e.start.isRoot?(U=!0,y++):0==e.start.isRoot&&(M=!0,k++)}),M&&U?c=E.ConfigCriteriaSelected.BOTH:M&&!U?c=E.ConfigCriteriaSelected.SINGLE:!M&&U&&(c=E.ConfigCriteriaSelected.RANGE)),M=!1,U=!1,f.isDefined(t.iUnitJson)){let e=JSON.parse(t.iUnitJson);e.builds.length>0&&(e.builds.forEach(e=>{f.isDefined(e.end)?(U=!0,S++):(M=!0,I++)}),M&&U?d=E.ConfigCriteriaSelected.BOTH:M&&!U?d=E.ConfigCriteriaSelected.SINGLE:!M&&U&&(d=E.ConfigCriteriaSelected.RANGE))}M=!1,U=!1,t.iDateJson.DateRanges.length>0&&(t.iDateJson.DateRanges.forEach(e=>{e.Start==e.End?(M=!0,w++):(U=!0,A++)}),M&&U?p=E.ConfigCriteriaSelected.BOTH:M&&!U?p=E.ConfigCriteriaSelected.SINGLE:!M&&U&&(p=E.ConfigCriteriaSelected.RANGE)),"FALSE"===s&&f.isDefined(t.variants)&&f.isParamDefined(t.variants.xmlExpression)&&(C=E.Availability.TRUE),f.isDefined(t.caNameArray)&&(1==t.caNameArray.length?(g=E.ConfigCriteriaSelected.SINGLE,_=1):t.caNameArray.length>1&&(g=E.ConfigCriteriaSelected.MULTIPLE,_=t.caNameArray.length)),f.isParamDefined(t.configurationRevision)&&(m=E.Availability.TRUE)}if(f.isDefined(this.UnitCheckbox)&&1==this.UnitCheckbox.checkFlag&&f.isDefined(this.UnitComponent)&&1==this.UnitComponent.atLeastOneUnitAllocated&&(v=E.Availability.TRUE),f.isDefined(this.options.configData))b=E.Availability.TRUE;f.isDefined(this.ModelSelectionComponent)&&(x=null==this.ModelSelectionComponent.combobox?1:this.ModelSelectionComponent.combobox.getModel()._allDescendants.length),E.createEventBuilder({category:E.Category.USAGE,action:E.Events.CLICK,tenant:enoviaServerFilterWidget.tenant}).setLabel(E.Labels.CONFIGURATION_FILTER).addDimension(P.CONFIGURATION_FILTER.CONFIGURATION_FILTER_WIDGET,t).addDimension(P.CONFIGURATION_FILTER.CONFIGURATION_FILTER_MEDIA,i).addDimension(P.CONFIGURATION_FILTER.CONFIGURATION_FILTER_MODE,n).addDimension(P.CONFIGURATION_FILTER.CONFIGURATION_FILTER_VIEW,o).addDimension(P.CONFIGURATION_FILTER.CONFIGURATION_FILTER_PRODUCTCONFIGURATION,s).addDimension(P.CONFIGURATION_FILTER.CONFIGURATION_FILTER_150MODE,r).addDimension(P.CONFIGURATION_FILTER.CONFIGURATION_FILTER_MODELVERSION,l).addDimension(P.CONFIGURATION_FILTER.CONFIGURATION_FILTER_MANUFACTURINGPLAN,c).addDimension(P.CONFIGURATION_FILTER.CONFIGURATION_FILTER_UNIT,d).addDimension(P.CONFIGURATION_FILTER.CONFIGURATION_FILTER_DATE,p).addDimension(P.CONFIGURATION_FILTER.CONFIGURATION_FILTER_VARIANTS,C).addDimension(P.CONFIGURATION_FILTER.CONFIGURATION_FILTER_CHANGE,g).addDimension(P.CONFIGURATION_FILTER.CONFIGURATION_FILTER_CONFIGURATIONREVISION,m).addDimension(P.CONFIGURATION_FILTER.CONFIGURATION_FILTER_UNITFIRING,v).addDimension(P.CONFIGURATION_FILTER.CONFIGURATION_FILTER_FIRINGPROCESS,b).addPersonalValue(N.CONFIGURATION_FILTER.CONFIGURATION_FILTER_NO_OF_MODEL,x).addPersonalValue(N.CONFIGURATION_FILTER.CONFIGURATION_FILTER_TOTAL_NO_OF_PRODUCT_RANGE,D).addPersonalValue(N.CONFIGURATION_FILTER.CONFIGURATION_FILTER_TOTAL_NO_OF_PRODUCT_SINGLE,F).addPersonalValue(N.CONFIGURATION_FILTER.CONFIGURATION_FILTER_TOTAL_NO_OF_MANUFACTURING_PLAN_RANGE,y).addPersonalValue(N.CONFIGURATION_FILTER.CONFIGURATION_FILTER_TOTAL_NO_OF_MANUFACTURING_PLAN_SINGLE,k).addPersonalValue(N.CONFIGURATION_FILTER.CONFIGURATION_FILTER_TOTAL_NO_OF_UNIT_RANGE,S).addPersonalValue(N.CONFIGURATION_FILTER.CONFIGURATION_FILTER_TOTAL_NO_OF_UNIT_SINGLE,I).addPersonalValue(N.CONFIGURATION_FILTER.CONFIGURATION_FILTER_TOTAL_NO_OF_DATE_RANGE,A).addPersonalValue(N.CONFIGURATION_FILTER.CONFIGURATION_FILTER_TOTAL_NO_OF_DATE_SINGLE,w).addPersonalValue(N.CONFIGURATION_FILTER.CONFIGURATION_FILTER_TOTAL_NO_OF_CHANGEACTIONS,_).send()}})}),define("DS/CfgFilterUX/CfgFilterFactory",["DS/UIKIT/Alert","DS/CfgFilterUX/CfgFilterEditor","DS/CfgBaseUX/scripts/CfgController","DS/CfgBaseUX/scripts/CfgUtility","UWA/Class/Promise","i18n!DS/CfgFilterUX/assets/nls/CfgFilterUX","DS/CoreEvents/ModelEvents","DS/CfgBaseUX/scripts/CfgData","DS/UIKIT/Mask","text!DS/CfgBaseUX/assets/CfgUXEnvVariables.json","i18n!DS/CfgFilterUX/assets/nls/CfgFilterUX"],function(e,t,i,n,o,a,s,r,l,c,d){"use strict";return{_parameters:null,_callbackAdd:null,alertDiv:null,CfgFilterDialog:null,begin:function(o){if(this._parameters=o,"1"==this._parameters.displayCompactMode?this._parameters.displayCompactMode=!0:this._parameters.displayCompactMode=!1,this._callbackAdd=o.callback,this.alertDiv=new e({visible:!1,autoHide:!0,hideDelay:3e3,closeOnClick:!0,maximumVisibleMessages:3,className:"error"}),this.alertDiv.inject(document.body.querySelector(".f-globalFilter-container"),"top"),l.mask(o.renderTo),null==o.configData)this.filterMode="",this.execute();else{if(this.filterMode="FiringProcess",i.init(),r.ModelEvents=new s,enoviaServerFilterWidget.tenant=this._parameters.tenant,this._parameters&&this._parameters.securityContext){let e={};e.SecurityContext=this._parameters.securityContext,n.setCfgSecurityContext(e)}this.CfgFilterEditor=new t(this._parameters)}},onSecurityContext:function(e,t){var i=null;if(t._parameters&&t._parameters.rootId&&t._parameters.renderTo&&t._callbackAdd&&(console.log(t._parameters.rootId),i=t._parameters.rootId,t._callbackAdd,document.body),null!=i){var o=i,s={};s.parentID=o,n.getConfiguredObjectInfo(s).then(function(e){if(null!=e.contexts.content.results[0]&&null!=e.contexts.content.results[0].notification&&"unaccessible"==e.contexts.content.results[0].notification.code&&"ERROR"==e.contexts.content.results[0].notification.type)return t.alertDiv.add({message:a.Filter_unaccessiblecode_Error,style:{position:"absolute"},className:"error"}),t.alertDiv.elements.container.addClassName("CfgAlertstyle"),t.alertDiv.show(),void t._callbackAdd([]);t.createDialog(e)},function(){t.alertDiv.add({message:a.Filter_Error_Models,style:{position:"absolute"},className:"error"}),t.alertDiv.show(),t._callbackAdd([])})}},execute:async function(){var e,t=this;if(i.init(),r.ModelEvents=new s,enoviaServerFilterWidget.tenant=t._parameters.tenant,this._parameters&&this._parameters.securityContext){let e={};e.SecurityContext=this._parameters.securityContext,n.setCfgSecurityContext(e)}try{await n.populate3DSpaceURL(),n.isParamDefined(enoviaServerFilterWidget.mySecurityContext)||(console.log("If we dont receive SecurityContext in parameter of begin we will call populateSecurityContext service"),await n.populateSecurityContext());r.configurationCriteria=await n.checkDecouplingActivation(),console.log(r.configurationCriteria),n.populateDisplayExpressionXSLT(),t.onSecurityContext(e,t),l.unmask(t._parameters.renderTo)}catch(e){console.log(e),t.alertDiv.add({message:d.CFG_Filter_Failed,style:{position:"absolute"},className:"error"}),t.alertDiv.show()}},applyCompactComfortableMode:function(e){e="1"===e,null!=this.CfgFilterEditor&&this.CfgFilterEditor.applyCompactComfortableMode(e)},hideFilter:function(){this._parameters&&this._parameters.hideFilter()},showFilter:function(){this._parameters.showFilter()},validateConfigurationFilter:function(){if(!1===this.CfgFilterEditor.validateCFFilter())return new o(function(e,t){e(!1)});var e={},t="";return null===(t=null!=this.filterMode&&"FiringProcess"==this.filterMode?this.CfgFilterEditor.applyFilterFromFiringProcess(e):this.CfgFilterEditor.onApplyFilter(e))?new o(function(e,t){e(!0)}):null!=t?t:void 0},createDialog:function(e){var i=this._parameters||{};if("1.2"==e.version?i.iModelsList=e.contexts.content.results:"1.0"==e.version&&(i.iModelsList=e.Contexts.Content.results),i.iModelsList.length>0){var o=this;o.CfgFilterEditor=new t(o._parameters),n.isParamDefined(o._parameters.config_filter_id)?o.CfgFilterEditor.getDataFromID(o._parameters.config_filter_id).then(()=>{o.CfgFilterEditor.render()}):o.CfgFilterEditor.render()}else this._callbackAdd&&(this.alertDiv.add({message:a.Filter_Error_No_Model,style:{position:"absolute"},className:"error"}),this.alertDiv.show(),this._callbackAdd([]))},areConfigurationFiltersCompatible:function(e,t,o){var a=this,s={};s.parentID=e.rootid,i.init(),enoviaServerFilterWidget.tenant=e.tenant,enoviaServerFilterWidget.baseURL=e.url3DSpace;var r="";0!=e.securitycontext.indexOf("ctx::")&&(r="ctx::"),enoviaServerFilterWidget.mySecurityContext=r+e.securitycontext,n.getConfiguredObjectInfo(s).then(function(e){if(null==e.contexts.content.results[0]||null==e.contexts.content.results[0].notification||"unaccessible"!=e.contexts.content.results[0].notification.code||"ERROR"!=e.contexts.content.results[0].notification.type){var i=[];if("1.2"==e.version?i=e.contexts.content.results:"1.0"==e.version&&(i=e.Contexts.Content.results),0==i.length){o({code:"noAttachedModels",type:"ERROR"})}a.processInputFiltersCompatibility(i,t,o)}else o(e.contexts.content.results[0].notification)},function(){o({code:"failedToGetAttachedModels",type:"ERROR"})})},processInputFiltersCompatibility:function(e,t,i){var n=[],o=[];if(Array.isArray(e)){for(var a=0;a<e.length;a++)n.push(e[a].physicalID);for(Array.isArray(t),a=0;a<t.length;a++){var s=t[a];s.expression&&s.expression.modelId?-1==n.indexOf(s.expression.modelId)&&o.push(a):o.push(a)}}i(o)}}}),define("DS/CfgFilterUX/CfgVariantEditor",["UWA/Core","UWA/Controls/Abstract","DS/UIKIT/Input/Button","DS/ConfiguratorPanel/scripts/Presenters/PCPanel","DS/ConfiguratorPanel/scripts/ConfiguratorSolverFunctions","DS/Core/ModelEvents","DS/UIKIT/Modal","DS/UIKIT/Spinner","DS/UIKIT/Mask","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgBaseUX/scripts/CfgContainerView","DS/CfgFilterUX/CfgFilterSlideInComponent","text!DS/CfgFilterUX/CfgFilterslideInDialogTemplate.html","DS/CfgBaseUX/scripts/CfgData","i18n!DS/CfgFilterUX/assets/nls/CfgFilterUX","text!DS/CfgBaseUX/assets/CfgUXEnvVariables.json","css!DS/CfgFilterUX/CfgFilterUX.css"],function(e,t,i,n,o,a,s,r,l,c,d,u,p,h,f,C){"use strict";return t.extend({init:function(t){h.selectedOptionsforConfigurator="",this.options=t?e.clone(t,!1):{};var i={useSolver:!0,configData:{xml:"",displayXml:"",xmlDesc:""},parentContainer:document.body};e.merge(this.options,i),"Filter"==this.options.invokeFrom||this.getModal(),this.modelEvent=new a,e.is(this.options.onOK,"function")&&this.modelEvent.subscribe({event:"onCfgDataChange"},this.options.onOK)},render:function(){this.getProductID()},setDefaultConfigurations:function(e){var t,i,n,o=this;this.options.PCId&&(t="/resources/cfg/configurator/configuration/"+this.options.PCId,o.options.cfgCriteria="{}",i=function(e){o.options.configuration=e.configurationCriteria,o.options.appRulesParams=e.appRuleParam,null!=o.options.startDate&&""!=o.options.startDate&&(o.options.cfgCriteria='{"date":{"startDate":"'+o.options.startDate+'","endDate":""}, "milestone":{"id":""}, "productState":{"productRev":""}}'),o.buildSkeleton()},n=function(){o.buildSkeleton()},c.makeWSCall(t,"GET","enovia","json","",i,n,!0,null))},getProductID:function(){var e,t,i,n=this;this.options.PCId&&!this.options.productId?(e="/resources/cfg/configurator/configuration/parentcontext/"+this.options.PCId,t=function(e){n.options.productId=e.objectDetails.id,n.options.startDate=e.objectDetails.startEffDate,n.options.configuration?n.buildSkeleton():n.setDefaultConfigurations()},i=function(e){n.errorMsg="Failed to get product id for PC id",console.log(n.errorMsg)},c.makeWSCall(e,"GET","enovia","json","",t,i,!0,null)):n.buildSkeleton()},buildSkeleton:function(){var t=this,i=this;return this.configModelEvents=new a,this.ws_pcModel=this.options.configuration,this.VariantsConfigPanelContainer=e.createElement("div",{class:"VariantsConfigPanelContainer"}),new Promise(function(e,n){var o={componentId:i.options.productId,content:{attributes:3,attributeList:["_image"]}},a=JSON.stringify(o);c.makeWSCall("/resources/v1/modeler/dspfl/invoke/dspfl:getVariabilityDefinition?xrequestedwith=xmlhttprequest","POST","enovia","application/json",a,function(n){e(n),i.ws_dictionary=n,t.initializePanel()},n,!0,null)})},initializePanel:function(){var e=this;this.ws_dictionary,this.modal?(this.modal.setBody(this.VariantsConfigPanelContainer),l.unmask(this.modal.elements.body)):window.enoviaServerFilterWidget&&"Native"==window.enoviaServerFilterWidget.mode?this.getLayoutForConfigurator():this.getPanelForConfigurator(),c.isParamDefined(e.options.configuratorOptions)||(e.options.configuratorOptions={initialRuleLevel:"RulesMode_EnforceRequiredOptions",rulesActivation:"true"});let t="selectionMode_Build";c.isDefined(this.options.appRulesParams)&&(t=this.options.appRulesParams.selectionMode);var i={version:"V5",realistic:!1,tenant:enoviaServerFilterWidget.tenant,isWebInWin:!0,"3DSpaceUrl":enoviaServerFilterWidget.baseURL,mvId:e.options.productId,ruleLevels:{RulesMode_ProposeOptimizedConfiguration:!1,RulesMode_SelectCompleteConfiguration:!1,RulesMode_EnforceRequiredOptions:!0,RulesMode_DisableIncompatibleOptions:!0},initalOptions:{initialRuleLevel:e.options.configuratorOptions.initialRuleLevel,initialMode:c.isDefined(h.filter150Checkbox)&&1==h.filter150Checkbox.checkFlag?"selectionMode_Refine":t},rulesActivation:e.options.configuratorOptions.rulesActivation,configCriteria:e.options.cfgCriteria};this.PCPanel1=new n(e.ws_pcModel,this.ws_dictionary,e.configModelEvents,i),e.configModelEvents.subscribe({event:"pc-loaded"},function(){e.PCPanel1.inject(e.VariantsConfigPanelContainer),e.VariantsConfigPanelContainer.getElement("#PC-panel-container").addClassName("variants-configuratorPanel");var t=document.getElementsByClassName("topbar-MidMenu-Container").item(0);null!=t&&t.addClassName("variants-topbarMidMenuContainer"),l.unmask(e.VariantsConfigPanelContainer),"Filter"==e.options.invokeFrom&&(l.unmask(e.options.filterParentContainer),l.unmask(e.options.filterParent))})},publishPanelData:function(){this.formattedInnerXML=void 0===this.formattedInnerXML?"":this.formattedInnerXML,this.modelEvent.publish({event:"onCfgDataChange",data:{displayXml:this.formattedInnerDisplayXML,xml:this.formattedInnerXML,PCId:this.options.PCId,configuration:this.options.configuration,selectionmode:this.PCPanel1.getConfigmodel().getAppRulesParam().selectionMode,xmlDesc:this.options.configData.xmlDesc,configuratorOptions:this.options.configuratorOptions}})},createActionsPresenter:function(){var t=e.createElement("div",{class:"actionsContainer"});if(e.is(this.options.onBack,"function")&&new i({value:f.Filter_VariantEditor_Back}).inject(t).elements.container.addClassName("variant-editor-backBtn"),!n){var n=e.createElement("div",{class:"OKCancelContainer"}).inject(t);new i({value:f.Filter_VariantEditor_Ok,className:"primary btn btn-primary variant-editor-okBtn"}).inject(n);new i({value:f.Filter_VariantEditor_Cancel}).inject(n).elements.container.addClassName("variant-editor-cancelBtn")}return t},destroy:function(){o.releaseSolver(),delete this.configModel,delete this.options.modelEvents,delete this.VariantsConfigPanelContainer},getModal:function(){var t=this;this.modal=new s({className:"site-reset",closable:!0,overlay:!0,escapeToClose:!1,header:"<h4>"+f.Filter_VariantEditor_Header+"</h4>",body:this.VariantsConfigPanelContainer,footer:this.createActionsPresenter(),events:{onShow:function(){l.mask(t.modal.elements.body)}}}).inject(this.options.parentContainer),this.modal.getContent().getElements(".btn").forEach(function(i){i.addEvent("click",function(){if(this.hasClassName("variant-editor-backBtn")||this.hasClassName("variant-editor-cancelBtn")){t.formattedInnerXML="",t.options.configData.xml="";var i={xml:"",PCId:""};e.is(t.options.onCancel,"function")&&(this.hasClassName("variant-editor-backBtn")?t.options.onBack(i):t.options.onCancel(i))}this.hasClassName("variant-editor-okBtn")&&(t.PCPanel1._configModel.getXMLExpression?t.options.configData.xml=t.PCPanel1._configModel.getXMLExpression():t.PCPanel1.getXMLProductConfigurationDefinition&&(t.options.configData.xml=t.PCPanel1.getXMLProductConfigurationDefinition()),t.options.configData.displayXml=t.getDisplayXML(t.options.configData.xml),h.selectedOptionsforConfigurator=t.PCPanel1._configModel.getConfigurationCriteria(),console.log(t.options.configData.xml),t.options.configuration=t.PCPanel1._configurations,t.formattedInnerXML=t.getInnerXML(),t.publishPanelData()),t.destroy(),t.modal.destroy(),console.log("Modal destroyed with all references")})}),this.modal.elements.close.onclick=function(){t.destroy(),t.modal.destroy()},this.modal.elements.body.addClassName("variant-modal-body"),this.modal.elements.content.addClassName("variant-modal-content"),this.modal.show()},getDisplayXML:function(e){for(var t=(new DOMParser).parseFromString(e,"text/xml"),i=t.getElementsByTagName("Feature").length,n=0;n<i;n++)t.getElementsByTagName("Feature")[n].setAttribute("Name",encodeURIComponent(t.getElementsByTagName("Feature")[n].getAttribute("DisplayName"))),t.getElementsByTagName("Feature")[n].removeAttribute("DisplayName");return(new XMLSerializer).serializeToString(t)},convertVariantXMLToXMLWithDescIDs:function(e){for(var t=[],i=(new DOMParser).parseFromString(e,"text/xml"),n=i.getElementsByTagName("FilterSelection")[0].children.length,o=i.getElementsByTagName("FilterSelection")[0].children,a=0;a<n;a++)if("NOT"==o[a].tagName)for(var s=o[a].children.length,r=o[a].children,l=0;l<s;l++)this.addAttributes(r[l],t);else this.addAttributes(o[a],t);var c=(new XMLSerializer).serializeToString(i);this.options.configData.xml=c,this.options.configData.xmlDesc=t},addAttributes:function(e,t){window.DescriptionCount++,e.setAttribute("DescId",window.DescriptionCount);var i='<Feature DescId = "'+window.DescriptionCount+'" DisplayName="'+encodeURIComponent(e.getAttribute("DisplayName"))+'"></Feature>';t.push(i),e.removeAttribute("DisplayName");for(var n=e.children.length,o=e.children,a=0;a<n;a++){window.DescriptionCount++,o[a].setAttribute("DescId",window.DescriptionCount);i='<Option DescId = "'+window.DescriptionCount+'" DisplayName="'+encodeURIComponent(o[a].getAttribute("DisplayName"))+'" SequenceOrder="'+window.DescriptionCount+'"></Option>';t.push(i),o[a].removeAttribute("DisplayName"),o[a].removeAttribute("SelectedBy")}},getLayoutForConfigurator:function(){var e=this;h.ModelEvents.publish({event:"ConfiguratorLaunched"});var t={isHeader:!0,isFooter:!0,firstButtonText:f.Filter_VariantEditor_Ok,secondButtonText:f.Filter_VariantEditor_Cancel,headerText:f.Filter_VariantEditor_Header,onButtonClickCB:function(t){l.unmask(e.VariantsConfigPanelContainer),"Filter"==e.options.invokeFrom&&(l.unmask(e.options.filterParentContainer),l.unmask(e.options.filterParent)),"firstButton"==t.buttonId?(e.PCPanel1._configModel.getXMLExpression?e.options.configData.xml=e.PCPanel1._configModel.getXMLExpression():e.PCPanel1.getXMLProductConfigurationDefinition&&(e.options.configData.xml=e.PCPanel1.getXMLProductConfigurationDefinition()),e.options.configData.displayXml=e.getDisplayXML(e.options.configData.xml),e.convertVariantXMLToXMLWithDescIDs(e.options.configData.xml),h.selectedOptionsforConfigurator=e.PCPanel1._configModel.getConfigurationCriteria(),e.options.configuratorOptions={initialRuleLevel:e.PCPanel1.getConfigmodel().getRulesMode(),rulesActivation:e.PCPanel1.getConfigmodel().getRulesActivation()},console.log(e.options.configData.xml),e.options.configuration=e.PCPanel1._configurations,e.formattedInnerXML=e.getInnerXML(),e.formattedInnerDisplayXML=e.getInnerDisplayXML(),e.publishPanelData(),e.destroy()):"secondButton"==t.buttonId&&(e.formattedInnerXML="",e.formattedInnerDisplayXML="",e.options.configData.xml="",e.options.configData.displayXml="",h.selectedOptionsforConfigurator=e.options.configuration);e.containerView.destroy(),h.ModelEvents.publish({event:"ConfiguratorClosed"})}};this.containerView=new d(t).render(),this.containerView.inject(h.renderTo),this.VariantsConfigPanelContainer.inject(this.containerView._body)},getPanelForConfigurator:function(){var e=this,t={dialogue:{buttonArray:[{label:f.Filter_VariantEditor_Cancel,handler:function(){e.formattedInnerXML="",e.formattedInnerDisplayXML="",e.options.configData.xml="",e.options.configData.displayXml="";h.selectedOptionsforConfigurator=e.options.configuration,require(["DS/CfgFilterUX/CfgFilterFactory"],function(e){document.querySelector(".operations-main-container").destroy(),e.showFilter()})},className:"default"},{label:f.Filter_VariantEditor_Ok,handler:function(t){e.PCPanel1._configModel.getXMLExpression?e.options.configData.xml=e.PCPanel1._configModel.getXMLExpression():e.PCPanel1.getXMLProductConfigurationDefinition&&(e.options.configData.xml=e.PCPanel1.getXMLProductConfigurationDefinition()),e.options.configData.displayXml=e.getDisplayXML(e.options.configData.xml),e.convertVariantXMLToXMLWithDescIDs(e.options.configData.xml),h.selectedOptionsforConfigurator=e.PCPanel1._configModel.getConfigurationCriteria(),e.options.configuratorOptions={initialRuleLevel:e.PCPanel1.getConfigmodel().getRulesMode(),rulesActivation:e.PCPanel1.getConfigmodel().getRulesActivation()},console.log(e.options.configData.xml),e.options.configuration=e.PCPanel1._configurations,e.formattedInnerXML=e.getInnerXML(),e.formattedInnerDisplayXML=e.getInnerDisplayXML(),""==e.formattedInnerXML&&""==e.formattedInnerDisplayXML&&(e.options.configData.displayXml="",e.options.configData.xml=""),e.publishPanelData(),e.destroy(),require(["DS/CfgFilterUX/CfgFilterFactory"],function(e){document.querySelector(".operations-main-container").destroy(),e.showFilter()})},className:"primary"}],showHeader:!0,showButton:!0},HeaderLabel:f.Filter_VariantEditor_Header,displayCompactMode:this.options.displayCompactMode};u.init(h.renderToApp,this.VariantsConfigPanelContainer,t,p)},getInnerXML:function(){var e,t,i,n,o,a,s="";return(e=this.options.configData.xml)&&(t=e.indexOf("<Feature"),i=e.indexOf("</FilterSelection>"),-1!==(a=e.indexOf("<NOT"))&&a<t&&(t=a),n=e.slice(t,i),o=function(e){var t,i,n;t=e.indexOf("SelectedBy"),i=e.indexOf("/",t),-1===(n=e.substr(0,t)+e.substr(i,e.length+1)).indexOf("SelectedBy")?s=n:o(n)},-1!=n.indexOf("SelectedBy")?(o(n),console.log(s)):s=n),s},getInnerDisplayXML:function(){var e,t,i,n,o,a,s="";return(e=this.options.configData.displayXml)&&(t=e.indexOf("<Feature"),i=e.indexOf("</FilterSelection>"),-1!==(a=e.indexOf("<NOT"))&&a<t&&(t=a),n=e.slice(t,i),o=function(e){var t,i,n;t=e.indexOf("SelectedBy"),i=e.indexOf("/",t),-1===(n=e.substr(0,t)+e.substr(i,e.length+1)).indexOf("SelectedBy")?s=n:o(n)},-1!=n.indexOf("SelectedBy")&&(o(n),console.log(s))),s}})}),define("DS/CfgFilterUX/CfgPCChooser",["DS/UIKIT/Modal","DS/UIKIT/Input/Button","DS/W3DXComponents/Views/Layout/GridScrollView","DS/UIKIT/Input/Text","DS/UIKIT/Iconbar","DS/W3DXComponents/Views/Item/TileView","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgFilterUX/CfgVariantEditor","DS/UIKIT/Mask","DS/UIKIT/Tooltip","UWA/Class/Collection","UWA/Class/Model","DS/i3DXCompassServices/i3DXCompassServices","i18n!DS/CfgFilterUX/assets/nls/CfgFilterUX","DS/CfgBaseUX/scripts/CfgData","text!DS/CfgBaseUX/assets/CfgUXEnvVariables.json","css!DS/CfgFilterUX/CfgFilterUX.css"],function(e,t,i,n,o,a,s,r,l,c,d,u,p,h,f,C){"use strict";var g={collectionNew:null,create:function(e){this.options=e?UWA.clone(e,!1):{};var t={pcExpression:{displayExpression:"",xmlExpression:""},parentContainer:document.body};UWA.merge(this.options,t),this.getServiceUrl(),UWA.is(this.options.model_id,"array")&&(this.options.model_id=this.options.model_id[0]),this.MainContainer=new UWA.Element("div",{id:"pcchooser-mainContainer"}),this.getModel(),this.buildToolbar(),this.PClistContainer=new UWA.Element("div",{id:"pcchooser-PClistContainer"}).inject(this.MainContainer),this.getPCCollection()},buildToolbar:function(){var e=new UWA.Element("div",{id:"pcchooser-headerwrapperDiv"}).inject(this.MainContainer),t=new UWA.Element("div",{id:"pcchooser-PCChooserHeader"}).inject(e),i=new UWA.Element("div",{id:"pcchooser-PCSearchContainer"}).inject(this.MainContainer);new o({renderTo:t,items:[{fonticon:"down-bold",text:h.Filter_Sort_oder,handler:function(e){g.sortPCsByName()}},{className:"divider"},{fonticon:"search",text:h.Search,handler:function(e){g.searchPC()}}]}),new UWA.Element("div",{id:"pcchooser-PCSortContainer",html:h.Filter_Sort_By+'<font color="#368ec4">'+h.Filter_Marketing_Name+"</font>"}).inject(t);this.getSearchTextBox(i)},getSearchTextBox:function(e){new n({id:"pcchooser-PCSearchBox",attributes:{placeholder:h.Filter_Search,events:{keyup:function(e){g.enteredText=e.target.value,g.filterSearch()}}}}).inject(e)},getPCCollection:function(){var e=this,t=this.options.model_id;new Promise(function(e,i){var n="";1==f.productstateCheckbox.checkFlag&&(n=f.singleProductId);var o=encodeURIComponent('{"version":"1.0.0","input":{"productPIDs":"')+n+encodeURIComponent('","status":"0","basics":"description,name,current,to[Product Configuration].from.attribute[Marketing Name],to[Product Configuration].from.revision","attributes":"ValidationStatus,CompletenessStatus"}}'),a="/resources/modeler/browsing/model/"+t+"/getproductconfigurations?filteringCriteria="+o;s.makeWSCall(a,"GET","enovia","application/json","",function(t){e(t)},function(){},!0)}).then(function(t){var i=t.productconfigurations,n=[];i&&i.length>0&&i.forEach(function(e){if(e&&e.id){var t=e.id.substr(4);n.push(t)}});var o=JSON.parse(C).pcImageEnabled;n.length>0&&o?s.getpcImage(n).then(function(i){for(var n={},o="",a="",s=i.results,r=0;r<s.length;r++){for(var l=i.results[r].attributes,c=0;c<l.length;c++){var d=l[c].name;"resourceid"==d&&(o=l[c].value),"preview_url"==d&&(a=l[c].value)}n[o]=n[o]||[],n[o].push(a)}e.collectionNew=e.buildTreeDocument(t,n),g.createView(e.collectionNew)}):(e.collectionNew=e.buildTreeDocument(t),g.createView(e.collectionNew))})},buildTreeDocument:function(e,t){var i,n,o=[];n=e.productconfigurations;var a=this;return n&&n.length>0?n.forEach(function(e){if(e&&e.id){var n=e.id.substr(4),s=function(){return a.defaultImage||a.getDefaultImage(),a.defaultImage};null!=t&&(s=t[n]),i={id:n,type:e.type||"",marketingName:e.marketingName||"",name:e.name||"",state:e.attributes.CompletenessStatus,description:e.basics.description||"",label:e.marketingName||e.name,subLabel:e.attributes.CompletenessStatus,icon:s,thumbnail:"",maturity:e.basics.current,basedOn:e.basics["to[Product Configuration].from.attribute[Marketing Name]"]+" "+e.basics["to[Product Configuration].from.revision"]},o.push(i)}}):(this.PClistContainer.setContent('<span class="fonticon fonticon-2x fonticon-doc"></span>'),this.PClistContainer.addContent('<font-size="17px">'+h.Filter_PC_NoContent+'</font><br> <font-size="15px">'+h.Filter_PC_NoPC+"</font>"),this.PClistContainer.setStyle("color","silver"),this.PClistContainer.setStyle("text-align","center"),this.PClistContainer.setStyle("padding-top","90px"),this.PClistContainer.setStyle("display","inline-flex"),this.PClistContainer.setStyle("flex-direction","column"),this.PClistContainer.setStyle("justify-content","center")),new d(o,{model:u.extend({defaults:function(){return{id:null,type:"",marketingName:"",name:"",state:"",description:"",label:"",subLabel:"",icon:"",thumbnail:"",maturity:"",basedOn:""}}})})},launchVariantEditor:function(e){var t=this,i=new r({parentContainer:document.body,modelId:this.options.model_id,PCId:e,tenant:t.options.tenant,onOK:function(e){console.log("On OK Data : "+e.xml),t.options.variantEditorOnOK(e),t.dialog.destroy()},onCancel:function(e){console.log("On Cancel Data : "+e.xml),t.options.variantEditorOnCancel(e),t.dialog.destroy()},onBack:function(e){console.log("On Back Data : "+e.xml),e.closeOnModal?(t.dialog.hide(),t.dialog.destroy()):t.dialog.show(),l.unmask(t.dialog.elements.body)}});this.modelView=i,setTimeout(function(){i.render()},1e3)},getServiceUrl:function(){var e=this;if(!this.serviceUrl){var t={serviceName:"3DSpace",platformId:"",onComplete:function(t){e.serviceUrl="string"==typeof t?t:t[0].url,e.defaultIcon=e.serviceUrl+"/snresources/images/icons/small/ProductConfiguration22.png"},onFailure:function(){console.log("Service initialization failed...")}};p.getServiceUrl(t)}},getDefaultImage:function(){this.serviceUrl&&(this.defaultImage=this.serviceUrl+"/snresources/images/icons/large/iconLargeDefault.png")},createView:function(e){var t=this;this.dialog&&(l.unmask(this.dialog.elements.body),l.unmask(this.PClistContainer)),this.PCListView=new i({collection:e,useInfiniteScroll:!1,scrollDuration:1,itemView:a,layout:{column:{xsmall:1}},itemViewOptions:{className:"item-view",mapping:{title:"marketingName",image:"icon",subtitle:function(){return new UWA.Element("div",{id:"pcSubtitle",html:"<span class=type>"+this.model.get("name")+"</span>"}).innerHTML},content:function(){var e;"Partial"===this.model.get("state")?e=h.Filter_PC_Completeness_Partial:"Complete"===this.model.get("state")?e=h.Filter_PC_Completeness_Complete:"Hybrid"===this.model.get("state")&&(e=h.Filter_PC_Completeness_Hybrid);var t,i=new UWA.Element("div",{id:"pcStatus",html:"<span class=type>"+h.Filter_PC_Completeness_DisplayName+": "+e+"</span>"});"Preliminary"===this.model.get("maturity")?t=h.Filter_PC_Preliminary:"Active"===this.model.get("maturity")?t=h.Filter_PC_Active:"Inactive"===this.model.get("maturity")&&(t=h.Filter_PC_Inactive);var n=new UWA.Element("div",{id:"pcStatus",html:"<span class=type>"+h.Filter_PC_Maturity_DisplayName+": "+t+"</span>"}),o=new UWA.Element("div",{id:"pcBasedOn",html:"<span class=type>"+h.Filter_PC_BasedOn_DisplayName+": "+this.model.get("basedOn")+"</span>",styles:{"white-space":"nowrap","text-overflow":"ellipsis",overflow:"hidden"}}),a=new UWA.Element("div",{id:"pcCont",styles:{color:"#808080"}});return a.appendChild(i),a.appendChild(n),a.appendChild(o),a.innerHTML},icon:"icon"},contextualActions:[{text:h.Filter_Edit,fonticon:"pencil",actionId:"Edit",handler:function(e,i){t.dialog.hide();var n=e.model.get("id");t.launchVariantEditor(n)}}]},withMultisel:!1,events:{onItemViewClick:function(e,i){console.log("selected Item model is:",i.model),t.itemClickHandler(i)}}}),this.PCListView.render().inject(this.PClistContainer),this.PCListView.scrollView.scroller.elements.content.setStyle("bottom","0px"),this.addStyling()},itemClickHandler:function(e){e.model.set("selected",!0);var t=this.getSelectedNodeInfo(e.model);this.addStyling(),this.options.pcExpression.displayExpression=JSON.stringify(t),this.options.pcExpression.xmlExpression=this.json2xml_str(t),console.log("Config Criteria:",this.options.pcExpression),this.pcExpression=this.options.pcExpression},json2xml_str:function(e){var t="";for(var i in e)e.hasOwnProperty(i)&&null!=e[i]&&(t+="<"+i+">","object"==typeof e[i]?t+=json2xml_str(new Object(e[i])):t+=e[i],t+="</"+i+">");return t},addStyling:function(){if(this.PCListView.container){for(var e=this.PCListView.container.getElementsByClassName("actions-inline-container"),t=0;t<e.length;t++){var i=e[t].getElementsByClassName("fonticon-pencil")[0];i&&i.setStyle("font-size","20px")}var n=this.PCListView.container.getElementsByClassName("tile-header"),o=this.PCListView.container.getElementsByClassName("tile-container");for(t=0;t<n.length;t++){var a=n[t];a&&(a.style.height="75px");var s=o[t];s&&(s.style.height="95px")}var r=this.PCListView.container.getElementsByClassName("tile-subtitle");if(r)for(t=0;t<r.length;t++)r[t].style.whiteSpace="nowrap",r[t].style.textOverflow="ellipsis",r[t].style.overflow="hidden",r[t].style.fontSize="13px",r[t].style.marginBottom="2px",r[t].style.color="black",r[t].style.fontFamily="sans-serif";var l=this.PCListView.container.getElementsByClassName("tile-content");if(l)for(t=0;t<l.length;t++)l[t].style.color="#808080",l[t].style.fontFamily="sans-serif"}},getSelectedNodeInfo:function(e){var t={},i=["id","label","description"];return Object.keys(e._attributes).forEach(function(n){-1!==i.indexOf(n)&&(t[n]=e._attributes[n])}),t},getModel:function(){var t=this;this.dialog=new e({closable:!0,header:"<h4>"+h.Filter_Product_Config_Chooser+"</h4>",body:this.MainContainer,footer:this.createActionsPresenter(),events:{onShow:function(){l.mask(t.dialog.elements.body)}}}).inject(this.options.parentContainer),this.dialog.show(),this.dialog.elements.body.setStyle("padding","0px");var i=t.dialog.elements.header.getElementsByTagName("h4");i&&i[0]&&(i[0].style.whiteSpace="nowrap",i[0].style.overflow="hidden",i[0].style.textOverflow="ellipsis",this.headerTooltip=new c({target:i[0],body:i[0].innerHTML,position:"bottom"})),this.dialog.getContent().getElements(".btn").forEach(function(e){e.addEvent("click",function(){this.hasClassName("btn-primary")&&(void 0!==t.pcExpression&&""!==t.pcExpression&&null!==t.pcExpression&&t.options.okCallback(t.pcExpression),require("DS/CfgBaseUX/scripts/CfgData",function(e){e.selectedOptionsforConfigurator="",t.pcExpression="",t.dialog.destroy()})),this.hasClassName("btn-default")&&(t.dialog.hide(),t.pcExpression="",t.dialog.destroy())})}),this.dialog.elements.close.onclick=function(){t.pcExpression="",t.dialog.destroy()}},createActionsPresenter:function(){var e=UWA.createElement("div",{class:"pc-actionsContainer"});new t({value:h.Filter_Apply,className:"primary btn btn-primary okBtn"}).inject(e),new t({value:h.Filter_Cancel}).inject(e);return e},sortPCsByName:function(){var e=document.getElementsByClassName("fonticon fonticon-down-bold"),t=!0;if(0==e.length){t=!1;e=document.getElementsByClassName("fonticon fonticon-up-bold")}if(this.PCListView.collection.length>0){var i=[];i=this.PCListView.collection.sortBy("label"),t||i.reverse(),this.PCListView.collection.reset(i),this.addStyling(),this.changeSortIcon(e,t)}},changeSortIcon:function(e,t){e.length>0&&(e[0].className=t?"fonticon fonticon-up-bold":"fonticon fonticon-down-bold")},searchPC:function(){var e=document.querySelector("#pcchooser-PCSearchContainer");"table-row"==e.getStyle("display")?e.setStyle("display","none"):e.setStyle("display","table-row")},filterSearch:function(){var e;this.PCListView.destroy(),e=this.collectionNew.filter(this.filterNameBased);var t=new UWA.Class.Collection(e);this.createView(t)},filterNameBased:function(e){var t=!1,i=e._attributes.subLabel,n=e._attributes.label,o=g.enteredText;if(o&&o.length){i&&(i=i.toLowerCase()),n&&(n=n.toLowerCase()),o=o.toLowerCase();var a=i.indexOf(o);a<0&&(a=n.indexOf(o)),t=a>=0}if(void 0!==o&&0!==o.length||(t=!0),1==t)return e}};return g});