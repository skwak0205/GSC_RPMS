define("DS/DELPPWMfgItem3DViewerModule/ScopedProductSelectionUI",["UWA/Core"],function(e){"use strict";return function(t,n,i){var o,l,c,s,a=1,r=2,d=n.getComponent("Element"),u=n.getComponent("Accordeon"),f=n.getComponent("Button"),g=n.getComponent("ComboBox"),m=n.getComponent("TooltipModel"),p=null,I=null,v=null;return o=function(o){var l,c,s;l=function(n){switch(n){case a:return function(){I.close()};case r:return function(){var t=v.rootField,n=v.occField,i=v.scopedMfgItemField;e.is(o,"function")&&e.is(t)&&e.is(n)&&e.is(i)&&o(t.value,n.value,i.value),I.close()};default:t.log("wrong option")}},c={No:new f({label:i.getNLSValue("ScopedProductSelectionUI.Close.Title"),onClick:l(a)}),Yes:new f({disabled:!1,label:i.getNLSValue("ScopedProductSelectionUI.Load.Title"),onClick:l(r)})},e.is(n)?(s={title:i.getNLSValue("ScopedProductSelectionUI.Dialog.Title"),domId:"ScopedProductSelectionUI-dialog",content:p,resizableFlag:!0,modalFlag:!1,minWidth:290,width:400,buttons:c,visibleFlag:!1},(I=n.create("Dialog",s)).close=function(){e.is(p)&&p.destroy(),this.destroy(),I=null,v=null}):t.debug("uxFactoryBehavior is not available.")},l=function(t){var n,i;return n=new e.Element("div",{class:"accordeon-section-container"}),i=new d("div",{class:"section-container"}),n.inject(p),new u({items:[{header:t,content:i,expandedFlag:!0}],style:"filled-separate"}).inject(n),i.addEvent("resize",function(){var t,n,o;o=i.getElements(".wux-field-container"),i.clientWidth<290?(t="inline-container",n="block-container"):(t="block-container",n="inline-container"),e.is(o)&&o.forEach(function(e){e.removeClassName(t),e.addClassName(n)})}),i},c=function(t,n){t.forEach(function(t){var i,o;i=new e.Element("div",{class:"wux-field-container inline-container"}),new e.Element("h6",{class:"wux-textElement",text:t.label}).inject(i).tooltipInfos=new m({shortHelp:t.label}),o=new g({elementsList:t.elementsList,actionOnClickFlag:!1,enableSearchFlag:!1,value:t.value,disabled:t.disabled}),e.is(t.onChange,"function")&&o.addEventListener("change",t.onChange.bind(null,v)),v[t.name]=o,o.inject(i),i.inject(n)})},s=function(t){var n,o,s,a,r,d={},u={};Array.isArray(t)&&t.length>0&&(s={name:"rootField",label:i.getNLSValue("ScopedProductSelectionUI.Field.Root.Title"),elementsList:[],disabled:!0,onChange:function(t){var n,i,o,l,c,s,a;n=t.rootField,o=t.occField,s=t.scopedMfgItemField,e.is(n)&&e.is(o)&&e.is(s)&&(i=n.value,e.is(d[i])&&(c=(l=d[i])[0].valueItem,o.setProperties({elementsList:l,value:c}),e.is(u[c])&&(a=u[c],s.setProperties({elementsList:a,value:a[0].valueItem}))))}},a={name:"occField",label:i.getNLSValue("ScopedProductSelectionUI.Field.Occurence.Title"),elementsList:[],disabled:!0,onChange:function(t){var n,i,o,l;n=t.occField,o=t.scopedMfgItemField,e.is(n)&&e.is(o)&&(i=n.value,e.is(u[i])&&(l=u[i],o.setProperties({elementsList:l,value:l[0].valueItem})))}},r={name:"scopedMfgItemField",label:i.getNLSValue("ScopedProductSelectionUI.Field.ScopedMfgItem.Title"),elementsList:[],disabled:!0},t.forEach(function(e){var t=[];e.occurences.forEach(function(e){var n=[];t.push({labelItem:e.label,valueItem:e.pid}),e.scopedPrd.forEach(function(e){n.push({labelItem:e.label,valueItem:e.pid})}),u[e.pid]=n}),d[e.pid]=t}),o=t[0],s.disabled=!1,s.value=o.pid,s.elementsList=t.map(function(e){return{labelItem:e.label,valueItem:e.pid}}),e.is(d[s.value])&&(a.disabled=!1,a.elementsList=d[s.value],a.value=a.elementsList[0].valueItem,e.is(u[a.value])&&(r.disabled=!1,r.elementsList=u[a.value],r.value=r.elementsList[0].valueItem)),v=[],n=l(i.getNLSValue("ImplementUI.Implementing")),c([s,a],n),n=l(i.getNLSValue("Type.VPMReference")),c([r],n))},{createDialog:function(t){!e.is(I)&&e.is(t)&&e.is(t.data)&&e.is(t.onSelectCallback)&&(p=new d("div",{class:"ScopedProductSelectionUI-Container"}),o(t.onSelectCallback),s(t.data),I.show())},isActive:function(){return!!e.is(I)&&I.visibleFlag},destroyUI:function(){e.is(I)&&I.close()}}}}),define("DS/DELPPWMfgItem3DViewerModule/MfgItem3DViewerModule",["UWA/Core","DS/TransientWidget/TransientWidget","DS/DELPPWMfgItem3DViewerModule/ScopedProductSelectionUI"],function(e,t,n){"use strict";return{behaviors:["InterWidgetComBehavior","UXFactoryBehavior","ResourceBehavior","ModelBehavior","RootsBehavior","ImplementBehavior"],creator:function(i,o,l,c,s,a,r){var d,u,f,g,m,p,I,v,h,b,P,S,D,L,E,w,C,F="MfgItem3DViewerModule_Preferences";return S=function(){o.isWidgetLinked("DELOER_AP")?i.warn(c.getNLSValue("MfgItem3DOperationViewer.IsAlreadyAvailable")):t.showWidget("DELOER_AP",{})},D=function(t){if(o.isWidgetLinked("DELOER_AP")){const n=f();if(e.is(n)){if(L(t,n)){const i=n.loadedObjInfos;if(e.is(i)){const e=r.getScopeLinksOfImplementing(i.rootPID);if(e.length>0){const n=e[0].get("to");n===i.scopedPrdPID?h(t,n):m()}}}}else{const e=s.getReference(t).get("PID"),n=r.getScopeLinksOfImplementing(e);if(n.length>0){const t=n[0].get("to");h(e,t)}}}},w=function(e){var t;if(o.isWidgetLinked("DELOER_AP")){const n=e.absPath;if(n.length>0){const e=n[0],i=s.getInstance(e);t=s.getAggregatingReferenceModelFromInstance(i)}else t=s.getReference(e.nodeId);const i=[t.get("PID")],o=p(i);I(o)}},C=function(t){if(o.isWidgetLinked("DELOER_AP")){const n=f();if(e.is(n)&&e.is(t.impactedChildren)){const i=t.impactedChildren,o=n.loadedObjInfos;if(e.is(i)&&e.is(o)){const e=i[i.length-1];e!==o.rootPID&&e!==o.scopedPrdPID||h(o.rootPID,o.scopedPrdPID)}}}},f=function(){return i.getPreferenceValue(F)},g=function(e,t){var n={loadedObjInfos:{rootPID:e,scopedPrdPID:t}};widget.setValue(F,n)},m=function(){widget.setValue(F)},p=function(t){let n=[];return Array.isArray(t)&&t.length>0&&t.forEach(function(t){let i;const o=s.getReference(t),l=r.getScopeLinksOfImplementing(t);if(l.length>0){const e=l[0].get("to");let n=[];const c=s.getReference(e);n.push({pid:e,label:c.get("V_Name")}),i={pid:t,label:o.get("V_Name"),occurences:[{pid:t,label:o.get("V_Name"),scopedPrd:n}]}}e.is(i)&&n.push(i)}),n},I=function(t){if(t.length>0){if(1===t.length){const n=t[0];if(e.is(n.occurences)&&1===n.occurences.length){const t=n.occurences[0];if(e.is(t.scopedPrd)&&1===t.scopedPrd.length){const e=t.scopedPrd[0].pid;return void h(n.pid,e)}}}(u=new n(i,l,c)).createDialog({data:t,onSelectCallback:function(t,n,i){e.is(t)&&e.is(n)&&e.is(i)&&h(t,i)}})}},v=function(t,n){e.is(t)&&o.publishEvent("DS/DELExternalWidgetCom/"+t,n)},h=function(t,n){const i=s.getReferenceModel(t);e.is(i)&&(g(t,n),v("Remove2DStructure"),v("LoadData",{items:[{id:n}]}))},b=function(){var e,t;t=a.getRoots()[0],e=p(t),I(e)},P=function(){e.is(u)&&u.isActive()&&u.destroyUI(),m()},L=function(t,n){let i=!1;const o=n.loadedObjInfos;return e.is(o.rootPID)&&(i=t===o.rootPID||s.getInstancesFromCollection(t).some(function(e){let t=!1;return s.getReferenceModelFromInstance(e).get("PID")===o.rootPID&&(t=!0),t})),i},E=function(t){var n,o,l,c;if(n=this.isSelected?"selectNodes":"unSelectNodes",c=function(e){var t,n=[];for(t=0;t<e.length;t++)t%2==1&&n.push(e[t]);return n},e.is(t.path)){const a=t.path.map(e=>c(e));l=[];for(let t=0;t<a.length;t++){const n=a[t];o=[];for(let t=0;t<n.length;t++){const i=s.getInstance(n[t]);if(!e.is(i)){o=[];break}"VPMInstance"===i.get("type")&&o.push(n[t])}l.push(o)}i.notify(n,[l])}},{listenTo:function(){return{Show3DViewerCmd:S,addRootNode:D,LoadIn3DViewer:w,refreshImpacted:C}},onStart:function(t,n){d=e.extend(d,t),o.addEventListener("link",b),o.addEventListener("unlink",P),o.subscribeEvent("DS/DELExternalWidgetCom/onHighlight",E.bind({isSelected:!0})),o.subscribeEvent("DS/DELExternalWidgetCom/onUnHighlight",E.bind({isSelected:!1})),n()},onStop:function(){}}}}});