define("DS/ENOFrame3DXInfra/Frame3DXController",["UWA/Class","UWA/Core","DS/PlatformAPI/PlatformAPI","DS/Logger/Logger","DS/PubSub/PubSub"],function(e,n,i,r,t){"use strict";var o=null,a=null,l=null,s=null,d={},f=void 0;return e.singleton({init:function(e){if(e.container&&"function"==typeof e.open&&"function"==typeof e.close){this._isFirstOpen=!0,a=e.container,l=e.open,s=e.close,i.subscribe("Frame3DXInfra.Update",this._onUpdate.bind(this)),i.subscribe("Frame3DXInfra.Open",this._onOpen.bind(this)),i.subscribe("Frame3DXInfra.Close",this._onClose.bind(this)),t.add("onViewChange",this._onViewChange.bind(this));require(["DS/TopFrame/TopFrame"],function(e){(o=e).addEvents({onLeftPanelClosed:function(e,n,r){"dataFilterPanelCtn"===r&&i.publish("Frame3DXInfra.onPanelClose",{panel:n,tag:r})},onLeftPanelHidden:function(e,n,r){"dataFilterPanelCtn"===r&&(o._isDataFilterPanelVisible||i.publish("Frame3DXInfra.onPanelClose",{panel:n,tag:r}))}})},function(e){});t.add("widget:remove",function(e){i.publish("Frame3DXInfra.WidgetRemoved",{id:e.id})})}else r.error("Frame3DXController ...... Initialze failure \n\t container = "+e.container+", open = "+e.open+", close = "+e.close)},_onUpdate:function(e){var n,i=e.type;switch(i){case"Filter":n="DS/ENONextGenFilterUX/views/FilterViewManager";break;case"Tagger":case"AdvSearch":break;default:r.error("Frame3DXController ...... Invalid requested panel type: "+i)}n&&require([n],function(i){var t=e.options;t.display=!e.display||e.display;var o=d[n],l=o||new i(t);"function"==typeof l.get3DXViewAsync?(d[n]=l,l.get3DXViewAsync(t).then(function(e){!function(e){if(e){var n="function"==typeof e.get3DXViewId?e.get3DXViewId():e.cid;if(f!==n||void 0===n){var i=a;if(void 0!==i)for(;i.hasChildNodes();)i.removeChild(i.lastChild);e.inject(a),f=n}}}(e)})):r.error("Error Frame3DXController / get3DXView() function is not implemented in "+n)},function(e){r.error("Error Frame3DXController / Error on required module "+n+" : "+e)})},_onOpen:function(e){if(this._isFirstOpen){this._isFirstOpen=!1;["tab:change","tab:add","tab:duplicate"].forEach(function(e){t.add(e,function(e){s()})})}var n=e?e.identifier:void 0;o&&(o._isDataFilterPanelVisible?(this._openerId&&this._openerId===n&&s(),this._openerId=void 0):(l(),this._openerId=n))},_onClose:function(){s(),this._openerId=void 0},_onViewChange:function(e){i.publish("Frame3DXInfra.ViewChange",e)}})});