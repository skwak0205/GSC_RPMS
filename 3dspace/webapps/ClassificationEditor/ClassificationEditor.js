function ClassificationEditor(e){"use strict";var t={leftPanelState:!0,isWelcomePanelCollapsed:!1},i={rightPanelState:!1,size:300},r={widget:null,filterFromWin:null,libraryContent_Cont:null,libraryContentController:null,libraryTree_div:null,libraryTreeDoc_div:null,libraryTree_Cont:null,libraryIdCard_div:null,libraryIdCard_Cont:null,core:null,widthToHideLeftPanel:300,_actionbar:null,libraryTree_W_NotLinked:!1,css_view_class:"windowed",_mouseEventsManager:{unlockMouseMove:!1,draggingXSlider:null,mouseStartXSlider:null,initialMouseStartXSlider:null,dragginDirection:null,cancelDragging:!1,spanPosition:null,widthLeftDiv:null,widthRightDiv:null,widthLeftDivSave:null,widthRightDivSave:null,widthGlobalDiv:null,newWidthGlobalDiv:null},init:function(e){var r=this;require(["DS/ClassificationEditor/utils/ClassificationEditorUtil"],function(e){var r=e.getLeftPanelStatus(),a=e.getRightPanelStatus();Promise.all([r,a]).then(function(e){t=e[0],i=e[1]})}),require(["DS/PADUtils/PADSettingsMgt"],function(e){e.setSetting("columnParametrization",!0),e.setSetting("activateTXO",!0)}),require(["DS/IPClassifyUtil/IPClassifyUtility"],function(e){e.isCustomizedEnv(),e.initURLSAsync().then(function(){r.migratePreferences()})}),this.widget=e.widget,this.dataForActiveClassODT=e.dataForActiveClassODT,e.defaultSelectionPath&&(this.widget.defaultSelectionPathFromWin="root,LibrarySection_AllLibraries,"+e.defaultSelectionPath),this.widget.addEvent("onLoad",this.onLoad.bind(this)),this.widget.addEvent("onRefresh",this.onRefresh.bind(this)),this.widget.addEvent("onDestroy",this.onDestroy.bind(this)),this.widget.addEvent("onResize",this.onResize.bind(this)),this.widget.changeInPreference={};var a={},n={};this.widget.addEvent("onEdit",function(){r.widget.preferences.forEach(function(e){"hidden"!==e.type&&(a[e.name]=r.widget.getValue(e.name))})}),this.widget.addEvent("endEdit",function(e){!(!e||!e.submitted&&!e.needRefresh)&&(r.widget.changeInPreference={},Object.keys(a).forEach(function(e){n[e]=r.widget.getValue(e),a[e]!==n[e]&&(r.widget.changeInPreference[e]=n[e])}))})},onRefresh:function(e){var t=this;require(["DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUtil/IPClassifyAlert","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/PADUtils/PADSettingsMgt","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/IPClassifyUtil/IPClassifyUtility"],function(i,r,a,n,o,s){var l=[];l.push(s.initURLSAsync()),t.widget.changeInPreference.x3dPlatformId&&(t.widget.changeInPreference={}),Promise.all(l).then(function(){var n=s.isIndexedMode();if(o.getContent().updateFilterBI(n),o.getContent().updateComputedColumns(),t.libraryContent_Cont.addEvent("onCompleteRefreshNodes",function(e){this.removeEvent("onCompleteRefreshNodes"),r.displayNotification({message:a.msg_info_refresh,className:"primary"})}),e&&UWA.is(e.authored.deleted,"array")){var l=i.getCurrentLibrary();l.getID()===e.authored.deleted[0]&&l.getParent().select(!0)}o.getTreeCont().refreshLibraryTree(),o.getContent().refreshLibraryContent()})})},onDestroy:function(){},onResize:function(){var e=this;setTimeout(function(){e.libraryGlobal_div&&e.libraryIdCard_Cont&&0!==e.libraryGlobal_div.clientWidth&&e.libraryIdCard_Cont.updateDisplayPath()},500)},migratePreferences:function(){return new Promise(function(e){require(["text!DS/ClassificationEditor/assets/classificationVersion.json","DS/ClassificationEditor/utils/ClassificationMigration","DS/IPClassifyUtil/IPClassifyPreference"],function(t,i,r){let a=JSON.parse(t);var n=[];let o=new Promise(function(e){r.get("LibraryFavPrefVersion",function(t){!t||!t.version||t.version<a.LibraryFavPrefVersion?i.migrateFavPreferences(null,a.LibraryFavPrefVersion).then(function(){e()}):e()},!1)});n.push(o);let s=new Promise(function(e){r.get("LibraryTreeStrcutPrefVersion",function(t){!t||!t.version||t.version<a.LibraryTreeStrcuturePrefVersion?i.migrateTreeStructurePreferences(null,a.LibraryTreeStrcuturePrefVersion).then(function(){e()}):e()})});n.push(s),Promise.all(n).then(function(){e()})})})},onLoad:function(){this.probeHeader=this.widget.id+"_"+this.widget.getTitle()+"_",window.top.performance.mark("onLoad_begin"),window.top.performance.measure(this.probeHeader+"createToOnLoad","createWidget_begin","onLoad_begin");var e=this;require(["DS/PADUtils/Configuration","text!DS/ClassificationEditor/assets/ClassificationEditorConf.json","DS/PADServices/utils/AttributesMgt","DS/ClassificationEditor/utils/ClassificationEditorUtil"],function(t,i,r,a){var n=JSON.parse(i);t.mergeConfig(n),r.updateAttributesList(n.columnsCusto),require(["UWA/Core","DS/PADUtils/PADContext","DS/PADUtils/PADCommandProxy","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADSharedSettings","DS/PADUtils/PADUtilsServices","DS/IPClassifyUX/LibraryContent","DS/ClassificationEditor/dataProvider/LibraryContentDataProvider","DS/IPClassifyUX/LibraryIdCardCont","DS/ClassificationEditor/dataProvider/LibraryIdCardDataProvider","DS/IPClassifyUX/LibraryTree","DS/ClassificationEditor/dataProvider/LibraryTreeDataProvider","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/dataProvider/LibraryCSODataProvider","DS/ClassificationEditor/dataProvider/LibraryDnDServiceProvider","DS/ClassificationEditor/dataProvider/ClassificationCommandsIconBarProvider","DS/ClassificationEditor/ActionBar/LibraryActionBar","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/service/LibraryServices","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/UIKIT/Mask","DS/ClassificationEditor/utils/ClassificationEditorKeyboardListener","DS/ClassificationEditor/utils/ClassificationEditorUtil","DS/IPClassifyUtil/IPClassifyUtility","DS/PADUtils/PADProbes","DS/ClassificationEditor/utils/FilterUtils","DS/IPClassifyUX/IPClassifyUXEvents","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/WidgetServices/WidgetServices","DS/IPClassifyUXUtil/CredentialsView","text!DS/ClassificationEditor/assets/library_settings.json","DS/MessageBus/MessageBus"],function(t,i,r,a,n,o,s,l,c,d,u,f,m,p,C,g,b,y,v,h,_,S,E,A,L,D,x,w,T,I,P,N,U){w.init();var F=e;F.options={},F.addEvent=(()=>{}),F.checkOnCommand=!1,i.set(F),window.top.performance.mark("loadRequire_end"),window.top.performance.measure(e.probeHeader+"loadRequire","createWidget_begin","loadRequire_end"),widget.setValue("tenantAware",!0),a.addEventOnce("onNoSecurityContext",function(e){if(!0!==e){S._isSecurityCTXInitialized=!1,widget.setBody(" ");var t=UWA.createElement("div",{text:y.get("authentication_error")});t.set("styles",{position:"absolute",top:"40%",bottom:"30%",left:"30%",right:"30%"}),t.inject(widget.body)}}),a.addEvent("onPad_security_ctx",function(e){S.getContent()&&S.getContent().getView()&&S.getContent().getView().options&&S.getContent().getView().options.model&&S.getContent().getView().options.model.getModelEvents()&&S.getContent().getView().options.model.getModelEvents().publish({event:"titleRecalc",data:m.getCurrentLibrary()._options.label})}),widget.addPreference({name:"pad_security_ctx",type:"hidden"});var O=JSON.parse(U);if(a.setApp(O.padsettings,"enopad",!0),a.setSetting("activate_padprobes",!0),a.setSetting("add_objects_when_select",!1),x.initialize({padid:widget.id,padtitle:widget.getTitle()}),n.addSharedSettings(widget,["x3dPlatformId"]),widget.setValue("editProperties_readOnly",!1),widget&&widget.lang&&a.setSetting("lang",widget.lang),e.widget.addEvent("endEdit",a.updateWidgetPreferences.bind(a)),a.updateWidgetPreferences(),e.updateSecurityPreference(),I.addModeIntervalPreferences({refreshView:function(){require(["DS/ClassificationEditor/utils/ClassificationEditorcontrol"],function(e){e.getTreeCont().refreshLibraryTree(),e.getContent().refreshLibraryContent()})},updateTaggerAndComputeColumns:function(e){require(["DS/ClassificationEditor/utils/ClassificationEditorcontrol"],function(t){t.getContent().updateFilterBI(e),t.getContent().updateComputedColumns()})}}),e.widget.getValue("x3dSharedId")||e.widget.getValue("x3dAppId")||e.widget.addPreference({name:"x3dAppId",type:"hidden",defaultValue:"ENOFOL3_AP"}),e.widget.getValue("x3dSharedId")||e.widget.addPreference({name:"x3dSharedId",type:"hidden",defaultValue:"ClassificationEditor_"+o.getWidgetId()}),N.render(),null===e.libraryTree_Cont||void 0===e.libraryTree_Cont){e.core=t,e.widget.body.empty(),e._buildSkeleton();e.widget.addEvent("endEdit",function(){e.widget.getPreferences().forEach(function(t){var i="boolean"===t.type&&UWA.is(t.value,"string")?e.convertToBool(t.value):t.value;e.widget.setValue(t.name,i)})}),e.libraryGlobal_div=e.widget.body.container,e.libraryTreeDoc_div=e.widget.body.right_side_div,e.libraryIdCard_div=e.widget.body.top_right_side_div,e.libraryContent_div=e.widget.body.bottom_right_side_div;var M=e._initializeClassificationEditorComponent.bind(e);if(null===e.libraryContent_Cont){var R={x3dAppId:e.widget.getValue("x3dAppId"),lang:e.widget.lang?e.widget.lang:e.widget.getValue("lang"),layout:{view_customization:null,css_view_class:e.css_view_class,store_roots_in_pref:!0,padshell:!0},authorize_setStructure:!0,settings:O};e.widget.getValue("LibraryCusto_treelistview_v1")?(R.layout.view_customization=JSON.parse(D.jsonUnzip(e.widget.getValue("LibraryCusto_treelistview_v1"))),M(R)):o.app_initialization(function(){require(["DS/IPClassifyUtil/service/IPClassifyUtilWebService"],function(t){t.getUserPreferences({name:e.widget.getValue("x3dAppId")+"_Classification_v1",onComplete:function(e){var t=null;e&&e.length>0&&(t=JSON.parse(D.jsonUnzip(e))),R.layout.view_customization=t,M(R)},onFailure:function(e){M(R)}})})}),e.getSelectedNodes=function(){return m.getSelectedNodes()},e.getCurrentLibrary=function(){var e=L.getCurrentSecurityContextAndLibraryData(!0);return JSON.stringify(e)},e.getSecurityContext=function(){return{SecurityContext:a.getSetting("pad_security_ctx"),tenant:widget.getValue("pad_tenant")}},e.beginBlockingTransaction=function(t){E.mask(e.libraryContent_div,t)},e.endBlockingTransaction=function(){E.unmask(e.libraryContent_div)},e.author=function(e){},e.displayNotification=function(e){_.displayNotification({message:e.msg,className:e.eventID})},e.getPADTreeDocument=function(){return S.getContent().getView()?S.getContent().getView().getPADTreeDocument():null},e.toggleView=function(e){UWA.is(S.getContent().getView().toggleView(e))&&S.getContent().getView().toggleView(e)},e.getPADTreeListView=function(){return S.getContent().getView().getPADTreeListView()},e.getContent=function(){return S.getContent()}}}})})},_slidderMoveEndCallback:function(){this.libraryIdCard_Cont&&this.libraryIdCard_Cont.updateDisplayPath()},_buildSkeleton:function(){if(!this.core.is(this.widget.body.container)){this.widget.body.container=UWA.createElement("div",{class:"LibraryEditor_global_container"}).inject(this.widget.body,"top"),this.widget.body.right_side_div=UWA.createElement("div",{class:"LibraryEditor_right_side_div"}).inject(this.widget.body.container),this.widget.body.top_right_side_div=UWA.createElement("div",{class:"LibraryEditor_top_right_side_div"}).inject(this.widget.body.right_side_div),this.widget.body.bottom_right_side_div=UWA.createElement("div",{class:"LibraryEditor_bottom_right_side_div"}).inject(this.widget.body.right_side_div);var e=UWA.createElement("div",{class:"LibraryEditor_containerTools"}),t=this;require(["DS/PADServices/utils/GlobalModelEvents"],function(i){i.getModelEvents().subscribe({event:"AddExistingAttributesCmd/Views/showInWidgetBody"},function(i){i.html?(e.empty(),i.html.inject(e),e.inject(widget.body),i.keepOpacity||t.widget.body.right_side_div.setStyle("opacity",.5)):!0===i.restore&&(e.remove(),t.widget.body.right_side_div.setStyle("opacity",1))})})}},convertToBool:function(e){return"true"===e.toLowerCase()},_initializeClassificationEditorComponent:function(e){var r=this,a=require("DS/IPClassifyUX/LibraryTree"),n=require("DS/ClassificationEditor/dataProvider/LibraryTreeDataProvider"),o=require("DS/ClassificationEditor/utils/ClassificationEditorcontrol"),s=require("DS/IPClassifyUX/LibraryIdCardCont"),l=require("DS/ClassificationEditor/dataProvider/LibraryIdCardDataProvider"),c=require("DS/IPClassifyUX/LibraryContent"),d=require("DS/ClassificationEditor/dataProvider/LibraryContentDataProvider"),u=require("DS/ClassificationEditor/utils/ClassificationEditorKeyboardListener"),f=require("DS/PADUtils/PADUtilsServices"),m=require("DS/ClassificationEditor/dataProvider/LibraryCSODataProvider"),p=require("DS/ClassificationEditor/dataProvider/LibraryDnDServiceProvider"),C=(require("DS/ClassificationEditor/dataProvider/ClassificationCommandsIconBarProvider"),require("i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor")),g=require("DS/ClassificationEditor/service/LibraryTypeService"),b=require("DS/ClassificationEditor/utils/ClassificationEditorUtil"),y=require("DS/PADServices/utils/GlobalModelEvents");f.app_initialization(function(){f.getSecurityContext(function(v){v&&""!==v.securityContext&&v.securityContextList.length>0&&(null===r.libraryTree_Cont&&f.app_initialization(function(){var s=new a({lang:r.widget.lang?r.widget.lang:r.widget.getValue("lang"),css_view_class:r.css_view_class,dataProvider:n,CSOProvider:m,DnDProvider:p,LibraryTypeService:g,events:{onReady:function(){if(o.setTreeCont(this),r.libraryTree_Cont=this._libraryTreeView,null!==r.libraryTree_Cont)r.libraryTree_Cont.setOption("_libraryContentView",this._libraryTreeView);else{if(!0===r.libraryTree_W_NotLinked)throw"LibraryTree are not linked !!!";r.libraryTree_W_NotLinked=!0}var a=r._retrieveinitializationOpts(),n=UWA.extend(e,a);n.placeholderData={},n.placeholderData.multiplePlaceholders=!0,n.placeholderData.placeholders={},n.placeholderData.placeholders.favoriteSection={},n.placeholderData.placeholders.favoriteSection.labelNLS=C.placeholder_Msg_FavoriteSection,n.placeholderData.placeholders.createNewLibrary={},n.placeholderData.placeholders.createNewLibrary.labelNLS=C.placeholder_Msg_CreateOrImportLib,n.placeholderData.placeholders.createNewLibrary.commandNLS=C.placeholder_CMD1_CrteLib,n.placeholderData.placeholders.createNewLibrary.command="CreateNewLibrary",n.placeholderData.placeholders.importLibrary={},n.placeholderData.placeholders.importLibrary.labelNLS=C.placeholder_Msg_CreateOrImportLib,n.placeholderData.placeholders.importLibrary.commandNLS=C.command_importLibrary,n.placeholderData.placeholders.importLibrary.command="ImportLibrary",n.placeholderData.placeholders.addClassAttributes={},n.placeholderData.placeholders.addClassAttributes.labelNLS=C.placeholder_Msg_classAttributes,n.placeholderData.placeholders.addClassAttributes.commandNLS=C.command_addExistingAttribute,n.placeholderData.placeholders.addClassAttributes.command="AddExistingAttributes",n.placeholderData.placeholders.createNewClass={},n.placeholderData.placeholders.createNewClass.labelNLS=C.placeholder_Msg,n.placeholderData.placeholders.createNewClass.labelNLS_Cls=C.placeholder_Msg_Cls,n.placeholderData.placeholders.createNewClass.commandNLS=C.placeholder_CMD1,n.placeholderData.placeholders.createNewClass.command="CreateNewClass",n.leftTriptychElem=r.libraryTree_Cont.elements.container,n.dataProvider=d,n.CSOProvider=m,n.DnDProvider=p,n.libraryEditorUtil=b,n.libraryControl=o,n.leftState=t,n.rightState=i,r.libraryContentController=new c(n),o.setContent(r.libraryContentController),r.widget.dispatchEvent("onClassificationEditorReady")}}});o.setTreeCont(s)}),null===r.libraryIdCard_Cont&&(r.libraryIdCard_Cont=new s({lang:r.widget.lang?r.widget.lang:r.widget.getValue("lang"),css_view_class:r.css_view_class,parentDiv:r.libraryIdCard_div,leftState:t,rightState:i,modelEvents:y.getModelEvents(),libraryCSODataProvider:m,libraryDataProvider:l,events:{onReady:function(){r.libraryIdCard_Cont=this,r.libraryIdCard_Cont.render().inject(r.libraryIdCard_div)}}})),r._keyboardListener||(r._keyboardListener=new u,r._keyboardListener.startObservingKeyboard()))})})},updateSecurityPreference:function(){window.library&&require(["DS/PADUtils/PADSettingsMgt"],function(e){var t="ctx::"+window.library.params.securityContext;e.setSetting("pad_security_ctx",t)})},_retrieveinitializationOpts:function(){var e=this;return{renderTo:e.libraryContent_div,events:{onActionBarReadyToBuild:function(){var r=require("DS/IPClassifyUX/LibraryIdCardCont");window.DEBUG_ActionBar_Require=!0,window.DEBUG_ActionBar_CmdInstantiation=!0,window.DEBUG_ActionBar_Xml=!0,window.DEBUG_ActionBar_ProcessCommandHeader=!0,window.DEBUG_ActionBar_Init=!0,e.elements=this.elements,e.options=this.options,e.togglePanel=this.togglePanel,null===e.libraryIdCard_Cont&&(e.libraryIdCard_Cont=new r({lang:e.widget.lang?e.widget.lang:e.widget.getValue("lang"),css_view_class:e.css_view_class,parentDiv:e.libraryIdCard_div,leftState:t,rightState:i,modelEvents:GlobalModelEvents.getModelEvents(),libraryCSODataProvider:LibraryCSODataProvider,libraryDataProvider:LibraryIdCardDataProvider,events:{onReady:function(){e.libraryIdCard_Cont=this,e.libraryIdCard_Cont.render().inject(e.libraryIdCard_div)}}}))},onReady:function(){e.libraryContent_Cont=this,e.addEvent=e.libraryContent_Cont.addEvent.bind(e.libraryContent_Cont),e.libraryContent_Cont.dropInvitContainer&&(e.libraryContent_Cont._dropInvitContainer=e.libraryContent_Cont.dropInvitContainer),e.libraryContent_Cont.options.renderTo&&(e.libraryContent_Cont._dropInvitContainer.hide(),e.libraryContent_Cont.render().inject(e.libraryContent_Cont.options.renderTo));require("DS/PADUtils/PADSettingsMgt");e.updateSecurityPreference()},onCustoViewChange:function(t){require(["DS/IPClassifyUtil/IPClassifyUtility"],function(i){e.widget.setValue("LibraryCusto_treelistview_v1",i.jsonZip(JSON.stringify(t)))})},onSaveAsTemplate:function(t){require(["DS/IPClassifyUtil/service/IPClassifyUtilWebService","DS/IPClassifyUtil/IPClassifyUtility"],function(i,r){e.widget.setValue("LibraryCusto_treelistview_v1",r.jsonZip(JSON.stringify(t))),i.saveUserPreferences({name:e.widget.getValue("x3dAppId")+"_Classification_v1",value:r.jsonZip(JSON.stringify(t)),onComplete:function(e){console.log("Saved as template")},onFailure:function(e){console.warn("Cannot save customization template")}})})},onSwitchView:function(){require("DS/ClassificationEditor/ActionBar/ClassificationCommandManager").updateCommands()},onToggleView:function(){require("DS/ClassificationEditor/ActionBar/ClassificationCommandManager").updateCommands()}}}}};return r.init(e),r}define("DS/ClassificationEditor/service/LibraryServices",["DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUtil/IPClassifyAlert","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,r,a){"use strict";return{CreateNewLibrary:function(e){if(!UWA.is(e.callbacks,"object"))throw new Error("No callbacks function defined");if(!UWA.is(e.callbacks.onComplete,"function"))throw new Error("No onComplete callback function defined");if(!UWA.is(e.callbacks.onFailure,"function"))throw new Error("No onFailure callback function defined");t.createNewLibrary({onComplete:function(t){var i=t?JSON.parse(t):void 0;if(i&&i.error){var r=i.error;console.log("AddContent WebService Err : "+r),r.length>200&&(r=null),e.callbacks.onFailure(r)}else e.callbacks.onComplete(t)},onFailure:e.callbacks.onFailure})},DeleteLibrary:function(e){if(!UWA.is(e.callbacks,"object"))throw new Error("No callbacks function defined");if(!UWA.is(e.callbacks.onComplete,"function"))throw new Error("No onComplete callback function defined");if(!UWA.is(e.callbacks.onFailure,"function"))throw new Error("No onFailure callback function defined");e.IDs.length>0?t.deleteLibrary({IDs:e.IDs,onComplete:function(t){var i=t?JSON.parse(t):void 0;if(i&&i.error){var r=i.error;console.log("Delete Library WebService Err : "+r),r.length>200&&(r=null),e.callbacks.onFailure(r)}else e.callbacks.onComplete(t)},onFailure:e.callbacks.onFailure}):e.callbacks.onFailure(e)},DeleteClass:function(e){if(!UWA.is(e.callbacks,"object"))throw new Error("No callbacks function defined");if(!UWA.is(e.callbacks.onComplete,"function"))throw new Error("No onComplete callback function defined");if(!UWA.is(e.callbacks.onFailure,"function"))throw new Error("No onFailure callback function defined");e.IDs.length>0?t.deleteClass({IDs:e.IDs,onComplete:function(t){var i=t?JSON.parse(t):void 0;if(i&&i.error){var r=i.error;console.log("Delete Class WebService Err : "+r),r.length>200&&(r=null),e.callbacks.onFailure(r)}else e.callbacks.onComplete(t)},onFailure:e.callbacks.onFailure}):e.callbacks.onFailure(e)},CreateNewClass:function(i){if(!UWA.is(i.callbacks,"object"))throw new Error("No callbacks function defined");if(!UWA.is(i.callbacks.onComplete,"function"))throw new Error("No onComplete callback function defined");if(!UWA.is(i.callbacks.onFailure,"function"))throw new Error("No onFailure callback function defined");var r=e.getCurrentLibrary().getID();t.createNewClass({libpid:r,onComplete:function(e){var t=e?JSON.parse(e):void 0;if(t&&t.error){var r=t.error;console.log("createNewClass WebService Err : "+r),r.length>200&&(r=null),i.callbacks.onFailure(r)}else i.callbacks.onComplete(e)},onFailure:i.callbacks.onFailure})},MoveClass:function(e){if(!UWA.is(e.callbacks,"object"))throw new Error("No callbacks function defined");if(!UWA.is(e.callbacks.onComplete,"function"))throw new Error("No onComplete callback function defined");if(!UWA.is(e.callbacks.onFailure,"function"))throw new Error("No onFailure callback function defined");var i=e.targetLibrary,r=i?i.id:"";r.length&&e.IDs.length?t.moveClass({classPhysicalIds:e.IDs,targetLibraryPhysicalId:r,carryOverAttributeGroups:e.carryOverAttributeGroups,onComplete:function(t){var i=t?JSON.parse(t):void 0;if(i&&i.error){var r=i.error;console.log("MoveClass WebService Err : "+r),r.length>200&&(r=null),e.callbacks.onFailure(r)}else e.callbacks.onComplete(t)},onFailure:e.callbacks.onFailure}):e.callbacks.onFailure(e)}}}),define("DS/ClassificationEditor/utils/LibrarySearch",["UWA/Class","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","text!DS/ClassificationEditor/assets/library_exclude_columns.json"],function(e,t,i){"use strict";return e.singleton({init:function(e){this._parent(e),this._predicateToHeaderMap=null,this._dynamicHeaderMap=[],this._dynamicMapSorted=!1,this._searchInfo=null,this._defaultPredicates=["ds6w:label","physicalid","mxid","ds6w:type"],this._authModePredicates=["ds6w:label","physicalid","mxid","ds6w:description","ds6w:modified","ds6w:created","ds6w:responsible","ds6w:type","ds6w:identifier","ds6w:status","ds6w:reservedBy"],this._authPersonAttributes=["ds6w:reservedby","ds6w:responsible"];this._searchInfo={with_indexing_date:!0,select_predicate:this._defaultPredicates.slice(0),select_file:["icon","thumbnail_2d"],order_field:"ds6w:modified",order_by:"desc",nresults:25}},getSearchInfo:function(e){var t=Object.assign({},this._searchInfo);return!0===e&&(t.select_predicate=this._authModePredicates),t},filterExcludeListColumns:function(e){var t=[],r=JSON.parse(i);if(r){r=r.columnToExclude;for(var a=0;a<e.length;++a)-1==r.indexOf(e[a].dataIndex)&&t.push(e[a])}return t},setPredicates:function(e,t){var r=this,a=JSON.parse(i),n=[];a&&(n=a.predicateToExclude,a=a.columnToExclude),Array.isArray(e)&&e.forEach(function(e){var t=e.ds6w;t||(t=e.dataIndex),"tree"===t||-1===r._searchInfo.select_predicate.indexOf(t)&&-1===a.indexOf(t)&&-1===n.indexOf(t)&&r._searchInfo.select_predicate.push(t)})},removeAllPredicates:function(){this._searchInfo.select_predicate=[],this._searchInfo.select_predicate=this._searchInfo.select_predicate.concat(this._defaultPredicates)},removePredicates:function(e){for(var t=[],i=[],r=0;r<e.length;++r)i.push(e[r].dataIndex);this._searchInfo.select_predicate.forEach(function(e){-1===i.indexOf(e)&&t.push(e)}),this._searchInfo.select_predicate=t},getPersonPredicatesForAuth:function(){return this._authPersonAttributes},setAttrNameToPredMapping:function(e){this._attrNameToPredMapping||(this._attrNameToPredMapping={}),this._attrNameToPredMapping&&e&&(this._attrNameToPredMapping[e.key]=e.value)},getAttrNameToPredMapping:function(){return this._attrNameToPredMapping||(this._attrNameToPredMapping={}),this._attrNameToPredMapping},resetAttrNameToPredMapping:function(){this._attrNameToPredMapping=null},initPredicateToHeaderMap:function(e){if(!this._predicateToHeaderMap){this._predicateToHeaderMap=[];for(var t=0;t<e.length;t++){var i=e[t],r=i.text?i.text.toLowerCase():null;if(r&&i.ds6w){var a={header:r,predicate:i.ds6w};this._predicateToHeaderMap.push(a)}}}},addToPredicateHeaderMap:function(e){for(var t=0;t<e.length;++t){var i=e[t],r=i.text?i.text.toLowerCase():null;if(r&&i.ds6w){var a={header:r,predicate:i.ds6w};this._predicateToHeaderMap.push(a)}}},removeFromPredicateHeaderMap:function(e){this._predicateToHeaderMap=this._predicateToHeaderMap.filter(function(e){for(var t=0;t<this.length;++t)if(this[t].ds6w==e.predicate)return!1;return!0},e)}})}),define("DS/ClassificationEditor/service/LibraryTypeService",["UWA/Controls/Abstract","text!DS/PADUtils/assets/PADOpenCommandsSettings.json"],function(e,t){return e.singleton({TYPE_ROOT_LIBRARY_1:"General Library",TYPE_ROOT_LIBRARY_2:"Part Library",TYPE_ROOT_LIBRARY_3:"RootLibrary",TYPE_LIBRARY_1:"General Class",TYPE_LIBRARY_2:"Library",TYPE_LIBRARIES_SECTION:"LibrarySection_AllLibraries",TYPE_FAVORITES_SECTION:"LibrarySection_favorite",openTypes:[],getOpenAvailableForTypes:function(e){if(0==this.openTypes.length&&e){var i=JSON.parse(t);i["openInCAD_"+e+"_supported_types"]&&(this.openTypes=i["openInCAD_"+e+"_supported_types"])}return this.openTypes},init:function(){},isRootLibrary:function(e){return e===this.TYPE_ROOT_LIBRARY_1||e===this.TYPE_ROOT_LIBRARY_2||e===this.TYPE_ROOT_LIBRARY_3},isLibrary:function(e){return e===this.TYPE_LIBRARY_1||e===this.TYPE_LIBRARY_2},inFamilyLibrary:function(e){return this.isRootLibrary(e)||this.isLibrary(e)},isSection:function(e){return e===this.TYPE_LIBRARIES_SECTION||e===this.TYPE_FAVORITES_SECTION},getPlmTypeFromContentDetails:function(e){if(e&&!(e.length<1)){for(var t,i,r,a,n="Content",o=0,s=e.length;o<s;++o)if("flattenedtaxonomies"===e[o].name){if("types/Classification"===e[o].value?t=!0:"types/General Class"===e[o].value?i=!0:"types/Libraries"===e[o].value?r=!0:"types/General Library"===e[o].value&&(a=!0),"types/Classification"===e[o].value[0]&&"types/General Class"===e[o].value[1]){n="Library";break}if("types/Libraries"===e[o].value[0]&&"types/General Library"===e[o].value[1]){n="RootLibrary";break}}return t&&i&&(n="Library"),r&&a&&(n="RootLibrary"),n}},getPLMTypeOfLibraryTreeNode:function(e){var t="";if(e){var i=e.plmType;t="Library"==i?"General Class":"RootLibrary"==i?"General Library":i}return t}})}),define("DS/ClassificationEditor/commands/ActionBar_ExpandNCmd",["UWA/Core","DS/ApplicationFrame/Command"],function(e,t){"use strict";return t.extend({labelTopBar:e.i18n("Expand N levels"),isInsert:!0,datas:{},init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1}),require(["DS/IPClassifyUtil/IPClassifyAlert","DS/PADUtils/views/PADLevelSel","DS/ClassificationEditor/utils/Library_CSO","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,r){})},beginExecute:function(){},execute:function(){var e=require("DS/IPClassifyUtil/IPClassifyAlert"),t=require("DS/PADUtils/views/PADLevelSel"),i=require("DS/ClassificationEditor/utils/Library_CSO"),r=require("i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"),a=null;null===(a=i.getCurrentLibrary())?e.displayNotification({message:r.msg_warning_noselection,className:"warning"}):new t({css_style:"",events:{onApply:function(e){a.expandNLevels({numberOfLevelsToExpand:parseInt(e),initialLevel:a.getNodeDepth()})}}})},endExecute:function(){}})}),define("DS/ClassificationEditor/utils/FilterUtils",["UWA/Class"],function(e){"use strict";return e.singleton({init:function(e){this.libraryFilter='flattenedtaxonomies:"types/General Library"',this.classFilter=["General Class"],this.classTreeFilter='flattenedtaxonomies:"types/General Class"',this.classTreeFilterAuth="General Class",this.endItemFilter=null,this.excludeBOTypesFromContentView=["Document Family","Part Family"]}})}),define("DS/ClassificationEditor/utils/ClassificationEditorcontrol",["UWA/Controls/Abstract"],function(e){return e.singleton({_Content:null,_TreeCont:null,_IdCardCont:null,getContent:function(){return this._Content},setContent:function(e){this._Content=e},getTreeCont:function(){return this._TreeCont},setTreeCont:function(e){this._TreeCont=e},getIdCardCont:function(){return this._IdCardCont},setIdCardCont:function(e){this._IdCardCont=e}})}),define("DS/ClassificationEditor/utils/ClassificationMigration",["DS/IPClassifyUtil/IPClassifyPreference","DS/IPClassifyUtil/IPClassifyUtility"],function(e,t){return{migrateFavPreferences:function(i,r){return new Promise(function(i){1==r?e.get("ipcFavoriteList_v1",function(a){e.set(t.getTenantAwarePreferenceName("ipcFavoriteList_v1"),a,!1,!1),e.set("LibraryFavPrefVersion",{version:r},!1),i()},!1):i()})},migrateTreeStructurePreferences:function(i,r){return new Promise(function(i){1==r?e.get("ipcTreeStrucure_v1",function(a){e.set(t.getTenantAwarePreferenceName("ipcTreeStrucure_v1"),a),e.get("ipcTreeSelectedNode_v1",function(a){e.set(t.getTenantAwarePreferenceName("ipcTreeSelectedNode_v1"),a),e.set("LibraryTreeStrcutPrefVersion",{version:r}),i()})}):i()})}}}),define("DS/ClassificationEditor/commands/ClassificationIconBar_DeleteLibrary",["UWA/Core","DS/ApplicationFrame/Command","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/IPClassifyUXUtil/IPClassifyConfirmation","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,r,a,n,o){"use strict";return t.extend({labelTopBar:e.i18n("Delete Library"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=require("DS/ClassificationEditor/utils/Library_CSO"),t=require("DS/IPClassifyUtil/IPClassifyAlert"),i=require("DS/ApplicationFrame/CommandsManager"),s=require("DS/ClassificationEditor/service/LibraryServices"),l=require("DS/ClassificationEditor/commands/LibraryCommands"),c=require("DS/IPClassifyUX/events/IPClassifyEvents");n.launch({title:o.confirmation_deleteLibrary_title,content:o.confirmation_deleteLibrary_message},function(){var n=e.getSelectedNodes(),d=n.length;if(d>0){l._startProgressBar(o.deleteLibrary_loading);var u=i.getCommand("DeleteLibrary",a.getContent());u.disable();var f=[],m=null;n.forEach(function(e){null===m&&"noExpandState"!==e._expandState&&!0===widget.getBool("filtered-content")&&(m=!0),f.push(UWA.is(e.id)?e.id:e.options.resourceid)}),s.DeleteLibrary({IDs:f,callbacks:{onComplete:function(e){var t=o.msg_info_librariesDeleted;1===d&&(t=o.replace(o.msg_info_libraryDeleted,{libraryname:n[0]._options.label})),r.setAuthoringMode("authoring",t),r.updateRefreshTime();for(var i=0;i<f.length;i++){var s=f[i],u=a.getTreeCont().getView()._rootNodeLibraries;u.select(),a.getTreeCont().performOperationOnNode(u,"collapse"),a.getTreeCont().performOperationOnNode(u,"expand"),c.notifyRemoveNodeInContent(s)}0===a.getContent()._libraryContentView.options.model.getAllDescendants().length&&a.getContent().getView()._addPlaceHolder(),l._offProgressBar()},onFailure:function(e,i,r){l._offProgressBar(),u.enable();var a=l.extractMyErrorMessage(e,i,r);t.displayNotification({message:a?o.msg_error_deletelibrary+"<br>"+a:o.msg_error_deletelibrary,className:"error"})}}})}})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ClassificationIconBar_CreateClass",["UWA/Core","DS/ApplicationFrame/Command","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/PADUtils/PADProbes","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,r,a,n,o){"use strict";return t.extend({labelTopBar:e.i18n("Create New Class"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=require("DS/ClassificationEditor/service/LibraryServices"),t=require("DS/ClassificationEditor/commands/LibraryCommands"),i=require("DS/ClassificationEditor/utils/Library_CSO"),n=require("DS/IPClassifyUtil/IPClassifyAlert"),s=i.getCurrentLibrary();t._startProgressBar(o.CreateNewClass_loading),e.CreateNewClass({callbacks:{onComplete:function(e){t._offProgressBar(),e="string"==typeof e?JSON.parse(e):e,r.setAuthoringMode("authoring",o.replace(o.msg_info_classCreationSucess,{})),e.createdClassObj&&(a.getTreeCont().addNewNode({physicalid:e.createdClassObj.classPhysicalId,label:e.createdClassObj.className,plmType:"Library",type:e.createdClassObj.classType,mxid:e.createdClassObj.classObjId,parentid:e.createdClassObj.classParentId,icons:[{iconName:"library-class"}]}),setTimeout(function(){a.getContent().loadContentAndSelect(s,e.createdClassObj.classPhysicalId,!1,!1,!0).then(function(e){})},100))},onFailure:function(e,i,r){t._offProgressBar();var a=t.extractMyErrorMessage(e,i,r);n.displayNotification({message:a?o.msg_error_createClass+"<br>"+a:o.msg_error_createClass,className:"error"})}}})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ClassificationIconBar_DeleteClass",["UWA/Core","DS/ApplicationFrame/Command","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/IPClassifyUXUtil/IPClassifyConfirmation","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,r,a,n,o){"use strict";return t.extend({labelTopBar:e.i18n("Delete Class"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=require("DS/ClassificationEditor/utils/Library_CSO"),t=require("DS/IPClassifyUtil/IPClassifyAlert"),i=require("DS/ApplicationFrame/CommandsManager"),s=require("DS/ClassificationEditor/service/LibraryServices"),l=require("DS/ClassificationEditor/commands/LibraryCommands"),c=require("DS/IPClassifyUX/events/IPClassifyEvents");n.launch({title:o.confirmation_deleteClass_title,content:o.confirmation_deleteClass_message},function(){var n=e.getSelectedNodes(),d=!1;d=!!n[0].pathId;var u=n.length;if(u>0){l._startProgressBar(o.deleteClass_loading);var f=i.getCommand("DeleteClass",a.getContent());f.disable();var m=[],p=null;n.forEach(function(e){null===p&&"noExpandState"!==e._expandState&&!0===widget.getBool("filtered-content")&&(p=!0),m.push(UWA.is(e.id)?e.id:e.options.resourceid)}),s.DeleteClass({IDs:m,callbacks:{onComplete:function(t){var i=o.msg_info_classesDeleted;1===u&&(i=o.replace(o.msg_info_classDeleted,{classname:n[0]._options.label})),r.setAuthoringMode("authoring",i),r.updateRefreshTime();for(var s=0;s<m.length;s++){var f=m[s],p=e._currentLibrary;d&&"RootLibrary"!=p.plmType&&(p=p._parentNode),p.select(),a.getTreeCont().performOperationOnNode(p,"collapse"),a.getTreeCont().performOperationOnNode(p,"expand"),c.notifyRemoveNodeInContent(f)}0===a.getContent()._libraryContentView.options.model.getAllDescendants().length&&a.getContent().getView()._addPlaceHolder(),l._offProgressBar()},onFailure:function(e,i,r){l._offProgressBar(),f.enable();var a=l.extractMyErrorMessage(e,i,r);t.displayNotification({message:a?o.msg_error_deleteClass+"<br>"+a:o.msg_error_deleteClass,className:"error"})}}})}})},endExecute:function(){}})}),define("DS/ClassificationEditor/service/ClassificationEditorWebService",["UWA/Core","DS/WAFData/WAFData","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices","DS/ClassificationEditor/utils/LibrarySearch","DS/ClassificationEditor/utils/FilterUtils","DS/IPClassifyUtil/IPClassifyUtility","text!DS/ClassificationEditor/assets/ClassificationEditorProps.json"],function(e,t,i,r,a,n,o,s,l){"use strict";return{_pageCount:50,content:function(e){var t={};UWA.extend(t,e);var i="";t.searchQuery?i="*"+e.searchQuery+'* (flattenedtaxonomies:"types/General Class" AND classification: '+e.mxid+")":(i='flattenedtaxonomies:"types/General Class"',!0===e.isAuthoringMode&&(i='type == "General Class"'),t.isExpand=!0),t.searchPageCount=this._pageCount,this._performSearchQuery(t,i,"content")},roots:function(e){var t='flattenedtaxonomies:"types/Libraries"',i=o.libraryFilter;i&&null!=i&&(t=i),!0===e.isAuthoringMode&&(t='type == "General Library"'),!0!==e.fetchAll&&(e.searchPageCount=this._pageCount),this._performSearchQuery(e,t,"roots")},favourites:function(e){this._performFetchQuery(e,"favourites")},libraries:function(e){var t={};UWA.extend(t,e),t.expand_iter="1",e.isExpandAll&&(t.expand_iter="-1");var i=o.classTreeFilter;e.isAuthoringMode&&(i=o.classTreeFilterAuth),t.filter=i,this._performExpandQuery(t,"libraries")},createNewLibrary:function(e){var t=e;if(!UWA.is(t,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.createNewLibrary");var i=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/library/create";t.headers={"content-type":"application/json"},t.data={type:"General Library",name:" "},t.data=UWA.Json.encode(t.data),t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"createNewLibrary")},deleteLibrary:function(e){var t=e;if(!UWA.is(t,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.deleteLibrary");var i=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/library/"+t.IDs[0]+"/delete";t.headers={"content-type":"application/json"},t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"deleteLibrary")},createNewClass:function(e){var t=e;if(!UWA.is(t,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.createNewClass");if(!UWA.is(t.libpid,"string"))throw new Error("Invalid inputs for ClassificationEditorWebService.createNewClass");var i=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/library/"+t.libpid+"/createClass";t.headers={"content-type":"application/json"},t.data={type:"General Class"},t.data=UWA.Json.encode(t.data),t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"createNewClass")},deleteClass:function(e){var t=e;if(!UWA.is(t,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.deleteClass");var i=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/class/"+t.IDs[0]+"/delete";t.headers={"content-type":"application/json"},t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"deleteClass")},moveClass:function(e){var t=e;if(!UWA.is(t,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.moveClass");var i=s.get3DSpaceUrl()+"/resources/IPClassificationReuse/class/"+t.classPhysicalIds[0]+"/moveClassification?carryOver="+t.carryOverAttributeGroups;t.headers={"content-type":"application/json"},t.data={id:t.targetLibraryPhysicalId},t.data=UWA.Json.encode(t.data),t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"moveClass")},setProperties:function(e){var t={};if(UWA.extend(t,e),!UWA.is(t,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.setProperties");if(!UWA.is(t.pid,"string"))throw new Error("Invalid inputs for ClassificationEditorWebService.setProperties");var i=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/library/"+t.pid+"/updateClassificationProps",r=n.getSearchInfo(e.isAuthoringMode).select_predicate;r=r.concat(["flattenedtaxonomies"]),t.payload={};var o=["svg","bi_color"],l=r.filter(function(e){return o.indexOf(e)<0});t.payload.physicalid=t.pid,t.payload.select_predicate=l,t.payload.properties=t.properties,s.isIndexedMode()?(t.payload.person_predicate=[],t.payload.compute_select_bo=["icon","thumbnail_2d"]):(t.payload.person_predicate=n.getPersonPredicatesForAuth(),t.payload.compute_select_bo=["icon","thumbnail_2d"]),t.method="POST",t.headers={"content-type":"application/json",Accept:"application/json"},t.type="json",t.data={properties:t.properties,fetchPayload:t.payload},t.data=UWA.Json.encode(t.data),this._executeRequest(i,t,"setProperties")},getLibraryPathLength:function(e){e.fetchClassification=!0,this._performFetchQuery(e,"getLibraryPathLength")},getLibraryPath:function(e){var t={};UWA.extend(t,e);for(var i={},r=t.depth,a=1;a<=r;a++)i["GET_PARENT_"+a+"_LIBRARY"]=[{id:2,iter:a}];t.patterns=i,this._performNavigateQuery(t,"getLibraryPath")},_performNavigateQuery:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.content");var t={};UWA.extend(t,e);var i=r.getSetting("pad_security_ctx"),s=a.get3DSpaceUrl()+"/cvservlet/navigate";!0===e.isAuthoringMode&&(s=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/Navigate/navigate"),s+="?SecurityContext="+i;var l=widget.lang?widget.lang:widget.getValue("lang"),c=[];c.push(e.pid),t.payload={},t.payload.input_physical_ids=c;var d=o.classFilter;d&&null!=d&&"RootLibrary"==e.selectedType?t.payload.primitives=[{navigate_to_rel:{id:1,filter:{bo_type:d}},navigate_from_rel:{id:2}}]:t.payload.primitives=[{navigate_to_rel:{id:1},navigate_from_rel:{id:2}}],t.payload.patterns=t.patterns;var u=n.getSearchInfo(!0).select_predicate;if(u=u.concat(["flattenedtaxonomies"]),e.dynamicattrs&&e.dynamicattrs.length>0){var f=u.concat(e.dynamicattrs);t.payload.attributes=f}else t.payload.attributes=u;t.payload.version=3;var m=new Date;return t.payload.label=("LibraryWidgetNavigate_"+m.getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-"),t.method="POST",t.headers={Accept:"application/json","content-type":"application/json","Accept-Language":l},t.type="json",t.data=UWA.Json.encode(t.payload),this._executeRequest(s,t,"searchInLibrary")},_performExpandQuery:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.content");var t={};UWA.extend(t,e);var i=null;!0===e.isAuthoringMode?i=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/Expand/expand":(i=a.get3DSpaceUrl()+"/cvservlet/expand",i+="?SecurityContext="+r.getSetting("pad_security_ctx"));var o=widget.lang?widget.lang:widget.getValue("lang"),s=n.getSearchInfo(!0).select_predicate;s=s.concat(["flattenedtaxonomies"]);var l=["svg","bi_color"],c=s.filter(function(e){return l.indexOf(e)<0});if(t.payload={},t.payload.expand_iter=e.expand_iter,t.children&&t.children.length>0){var d=[];d.push(e.pid);for(var u=0;u<t.children.length;++u)d.push(t.children[u]);t.payload.multi_root_physicalid=d}else t.payload.root_physicalid=e.pid;if(t.filter&&!1===e.isAuthoringMode&&(t.payload["q.iterative_filter_query_bo"]=e.filter),t.filter&&(!0===e.isAuthoringMode?(t.payload.iterative_filter_query_bo=e.filter,t.payload.person_predicate=n.getPersonPredicatesForAuth()):t.payload["q.iterative_filter_query_bo"]=e.filter),e.dynamicattrs&&e.dynamicattrs.length>0){var f=c.concat(e.dynamicattrs);t.payload.select_bo=f}else t.payload.select_bo=c;t.payload.compute_select_bo=["icon","thumbnail_2d"];var m=new Date;return t.payload.label=("LibraryWidgetExpand_"+m.getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-"),t.payload.max_count_path="10000",t.method="POST",t.headers={Accept:"application/json","content-type":"application/json","Accept-Language":o},t.type="json",t.data=UWA.Json.encode(t.payload),this._executeRequest(i,t,"Expand")},_performFetchQuery:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.content");var t={};UWA.extend(t,e);var i=r.getSetting("pad_security_ctx"),o=a.get3DSpaceUrl()+"/cvservlet/fetch/v2";o+="?SecurityContext="+i;var s=widget.lang?widget.lang:widget.getValue("lang"),l=n.getSearchInfo(e.isAuthoringMode).select_predicate;l=l.concat(["flattenedtaxonomies"]),t.payload={},e.dynamicAttrs&&e.dynamicAttrs.length>0&&(t.payload.classification_attribute=e.dynamicAttrs,l=l.concat(e.dynamicAttrs));var c=["svg","bi_color"],d=l.filter(function(e){return c.indexOf(e)<0});!0===e.fetchClassification&&d.push("classification"),t.payload.physicalid=t.ids,t.payload.select_predicate=d,!0===e.isAuthoringMode&&(o=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/classifiedItem/getContentDetails",t.payload.person_predicate=n.getPersonPredicatesForAuth(),t.payload.compute_select_bo=["icon","thumbnail_2d"]);var u=new Date;return t.payload.label=("LibraryWidgetFetch_"+u.getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-"),t.method="POST",t.headers={Accept:"application/json","content-type":"application/json","Accept-Language":s},t.type="json",t.data=UWA.Json.encode(t.payload),this._executeRequest(o,t,"Fetch")},_performSearchQuery:function(e,t){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.content");var i={};UWA.extend(i,e);var o=a.get3DSearchUrl()+"/search",s=widget.lang?widget.lang:widget.getValue("lang");i.payload=Object.assign({},n.getSearchInfo(e.isAuthoringMode));var l=i.payload.select_predicate;!0===e.isAuthoringMode?(o=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/Search/search",i.payload.person_predicate=n.getPersonPredicatesForAuth(),i.payload.root_physicalid=e.pid):i.payload.login={"3dspace":{SecurityContext:r.getSetting("pad_security_ctx")}},l=l.concat(["flattenedtaxonomies"]),e.dynamicattributes&&e.dynamicattributes.length>0&&(l=l.concat(e.dynamicattributes)),i.payload.select_predicate=l;var c=new Date,d=Math.random();d.toString(36);var u=d.toString(36).substr(2,9);return i.payload.label=("LibraryWidgetSearch_"+u+"_"+c.getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-"),i.payload.locale=s,i.payload.query=t,i.payload.tenant=a.getPlatformId(),i.payload.next_start=e.next_start,i.payload.start=e.start,i.method="POST",i.headers={Accept:"application/json","content-type":"application/json","Accept-Language":s},i.type="json",e.order_field&&(i.payload.order_field=e.order_field,i.payload.order_by=e.order_by),e.searchPageCount&&(i.payload.nresults=e.searchPageCount),!0===e.fetchAll&&(i.payload.nresults=1e3),e.isExpand&&!1===e.isAuthoringMode&&(i.payload.source=["3dspace"],i.payload.specific_source_parameter={"3dspace":{search_in_context:{expand:{root_physicalid:e.pid,expand_iter:"1",type_filter_rel:["Subclass","Classified Item"]}},option:{with_Idx_Search:!0}}}),e.filters&&!1===e.isAuthoringMode&&(i.payload.refine=e.filters),i.data=UWA.Json.encode(i.payload),i.securityContextRequired=!1,this._executeRequest(o,i,"searchInLibrary")},_executeRequest:function(e,a,n){var o=Math.round(1e3*Math.random()).toString(),s=widget.id+"_"+widget.getTitle()+"_";window.top.performance.mark("libraryRequest_begin"+o);var l={};if(UWA.extend(l,a),!l.payload&&e.indexOf("cvservlet")>-1){l.payload={};var c=new Date;l.payload.label=("LibraryWidgetExecute_"+c.getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-")}UWA.is(l.onTimeout,"function")||(l.onTimeout=function(){var e={type:"timeout",toString:function(){return i.msg_InfoAction_Timeout}};l.onFailure(e)},l.onComplete=function(e){window.top.performance.mark("libraryRequest_end"+o);var t=window.top.performance.getEntriesByName("libraryRequest_begin"+o);t&&1===t.length&&(window.top.performance.measure(s+"_Request"+n,"libraryRequest_begin"+o,"libraryRequest_end"+o),window.top.performance.clearMarks("libraryRequest_end"+o),window.top.performance.clearMarks("libraryRequest_begin"+o)),a.onComplete(e)});var d={Accept:"application/json","Accept-Language":widget.lang?widget.lang:widget.getValue("lang")};return!1!==l.securityContextRequired&&(d.SecurityContext=r.getSetting("pad_security_ctx")),a.headers?l.headers=UWA.extend(d,a.headers):l.headers=d,t.authenticatedRequest(e,l)},getClassificationAttributes:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.getClassificationAttributes");var t={};UWA.extend(t,e);var i=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/"+t.classid+"/getClassAttributes?timezoneOffset="+(new Date).getTimezoneOffset()/60;return t.method="GET",t.timeout=12e4,this._executeRequest(i,t,"getClassificationAttributes")},fetchAllTheClassificationAttributes:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.fetchAllTheClassificationAttributes");var t={};UWA.extend(t,e);var i=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/fetchAttributes?timezoneOffset="+(new Date).getTimezoneOffset()/60;return t.method="GET",t.timeout=12e4,this._executeRequest(i,t,"fetchAllTheClassificationAttributes")},addClassAttributes:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.addClassAttributes");var t={};UWA.extend(t,e);var i=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/"+t.pid+"/addAttributes";if(t.headers={"content-type":"application/json"},t.attributes){var r=t.attributes,n=[];r.forEach(function(e){n.push(e.name)}),t.data={attributes:n},t.data=UWA.Json.encode(t.data)}t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"addClassAttributes")},removeClassAttributes:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.removeClassAttributes");var t={};UWA.extend(t,e);var i=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/"+t.pid+"/removeAttributes";t.headers={"content-type":"application/json"},t.attributes&&(t.data={attributes:t.attributes},t.data=UWA.Json.encode(t.data)),t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"removeClassAttributes")},exportClassificationAttributes:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.exportClassificationAttributes");var t={};UWA.extend(t,e);var i=JSON.parse(l);t.headers={Accept:"application/zip","Content-Type":"application/zip","Accept-Language":widget.lang},t.package=i.package_name,t.tenant=a.getPlatformId(),t.type="blob",t.method="GET",t.timeout=18e5;var r=a.get3DSpaceUrl()+"/resources/dictionary/ExportData?tenant="+t.tenant+"&package="+t.package;this._executeRequest(r,t,"exportClassificationAttributes")},exportLibraryStructure:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.exportLibraryStructure");var t={};UWA.extend(t,e);var i=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/library/"+t.pid+"/exportStructure";t.headers={"content-type":"application/json",Accept:"application/json"},t.method="GET",t.timeout=18e4,this._executeRequest(i,t,"exportLibraryStructure")},importLibraryStructure:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.importLibraryStructure");var t={};UWA.extend(t,e);var i=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/library/importStructure";t.headers={"content-type":"application/json",Accept:"application/json"},t.fileContent&&(t.data={isValidate:t.isValidate,fileContent:t.fileContent},t.data=UWA.Json.encode(t.data)),t.method="POST",t.timeout=18e4,this._executeRequest(i,t,"importLibraryStructure")},hasLibrarianRole:function(e){var t=e;if(!UWA.is(t,"object"))throw new Error("Invalid inputs for LibraryEditorWebService.hasLibrarianRole");var i=s.get3DSpaceUrl()+"/resources/IPClassificationReuse/library/showAttachmentsTabCommands";return t.method="GET",this._executeRequest(i,t,"hasLibrarianRole")}}}),define("DS/ClassificationEditor/utils/ClassificationEditorDataConversion",["DS/WebappsUtils/WebappsUtils","DS/ClassificationEditor/service/LibraryTypeService","DS/PADServices/utils/AttributesMgt","DS/ClassificationEditor/utils/LibrarySearch","DS/IPClassifyUtil/IPClassifyUtility"],function(e,t,i,r,a){var n=function(e){var t=e.toLowerCase(),r=null;i.getAvailableColumns()&&(r=i.getAvailableColumns());var a=i.getTreeColumn(),n=null;return Array.isArray(r)&&r.every(function(e){return"tree"===e&&(e=a),t==e.toLowerCase()&&(n=e),null===n}),n=n||e},o={convertToExaleadDataFormatFederated:function(e){var t={children:null},i=e.attributes,a=r.getAttrNameToPredMapping(),o={"ds6w:type":"type","ds6w:label":"label"},s={};return i.forEach(function(e){if("resourceid"==e.name||"physicalid"==e.name)t.physicalid=e.value,t.resourceid=e.value;else if("mxid"==e.name)t.mxid=e.value;else if("type_icon_url"===e.name)t.icons=[e.value];else if("preview_url"===e.name)t.thumbnail=e.value;else if(e.name.startsWith("ds6w")){var i=e.name.split("/");"ds6w:type"===(d=i[i.length-1])&&(m=e.value,["CATIA Embedded Component","CATPart","CATProduct","CATProcess","CATDrawing","CATAnalysis","CATShape"].indexOf(m)>=0)?t.children=[]:"ds6w:created"===d&&(t.created=e.value);var r=e.object?e.object:e.value;if(r=r||e.dispValue,a[d]){if(s[d]){r=[r];var l=s[d];Array.isArray(l)||(l=[l]),r=r.concat(l)}d=a[d]}s[d]=r,s[e.name]=r;var c=o[d];c&&(t[c]=r)}else{var d=e.name;a[d]&&(d=a[d]);var u=s[n(e.name)];if(u)if(Array.isArray(u))u.push(e.value);else{var f=[u,e.value];s[n(e.name)]=f,s[d]=f}else s[n(e.name)]=e.value,s[d]=e.value}var m}),e.id||(e.id=t.resourceid),t.grid=s,t.padgrid={"ds6w:leaf":"False","ds6w:root":"True"},t},convertAttributeToExaleadDataFormat:function(t){var i={children:null},r={};for(var a in t)if(t.hasOwnProperty(a))if("nls_label"===a)r["ds6w:label"]=t[a],i.label=t[a];else if("nls_hasDefault"===a)r.hasDefault=t[a];else if("isInDico"===a)r.isInDico=t[a];else if("name"===a)r.Name=t[a];else if("nls_predicate"===a)r.Predicates=t[a];else if("default"===a)r.DefaultValue=t[a];else if("description"===a)r.Description=t[a];else if("nls_type"===a)r.Type=t[a],i.type=t[a];else if("nls_dimension"===a)r.Dimensions=t[a],t.manipulationUnit&&t.manipulationUnit.length>0&&(r.Dimensions+="("+t.manipulationUnit+")");else if("origin"===a)r.origin=t[a],i.origin=t[a];else if("range"===a){var n=t[a];(n="string"==typeof n?JSON.parse(n):n).forEach(function(e){if("between"==e.operator){var t=e.value.split(" ");r.Minimum=t[0],r.Maximum=t[2]}else r.AuthorizedValues?r.AuthorizedValues+=","+e.value:r.AuthorizedValues=e.value})}else"valuetype"===a?r.IsMultivalue=t[a]&&"multival"==t[a]?"True":"False":"nls_isParametric"===a&&(r.attrIsParametric=t[a]);return i.icons=[e.getWebappsAssetUrl("ClassificationEditor","icons/attributes.png")],i.grid=r,i.padgrid={"ds6w:leaf":"False","ds6w:root":"True"},i},convertExpandToSearchFormat:function(e,t){var i=[];return t.forEach(function(t){var r=!1;t.attributes&&t.attributes.forEach(function(t){"physicalid"===t.name&&t.value!=e&&(r=!0)}),r&&i.push(t)}),i},convertNavigateToSearchFormat:function(e){var t=[],i=e[0].outputs.GET_CONTENT;return i&&i.forEach(function(e){var i=[];for(var r in e)i.push({name:r,value:e[r]});t.push({attributes:i})}),t},convertNavigateToFlatFormat:function(e,t){var i=[];if(t.length<=0)return i;for(var r=t[0],a=r.input_object,n=r.outputs,o=e,s=0;o>0;o--){var l=n["GET_PARENT_"+o+"_LIBRARY"];l&&((l=l[0]).level=s++,i.push(l))}return i.push(a),i},getLibraryDepth:function(e){var t=e.results[0].attributes,i=[];return t.forEach(function(e){"classification"===e.name&&i.push(e.value)}),i.length+1},getPathsAndObjectsFromExpand:function(e){if(e&&!(e.length<=0)){for(var t=[],i={},r={},n={},s=0,l=e.length;s<l;++s){var c=e[s];if(c.attributes){for(var d,u,f=!0,m=0,p=c.attributes.length;m<p;++m)"physicalid"===c.attributes[m].name?(f=!1,u=c.attributes[m].value):"did"===c.attributes[m].name&&(d=c.attributes[m].value);f||(i[u]=c,r[d]=u)}else if(c.path)t.push(c.path);else if(c.icon__default_thumbnail_2d)for(var C=0;C<c.icon__default_thumbnail_2d.length;C++)for(var g=c.icon__default_thumbnail_2d[C].did,b=0;b<g.length;b++){var y=[];y.push(c.icon__default_thumbnail_2d[C].icon),y.push(c.icon__default_thumbnail_2d[C].thumbnail_2d),n[g[b]]=y}}for(var v in i)for(var h,_=i[v],S=0;S<_.attributes.length;S++)if("did"===_.attributes[S].name){h=_.attributes[S].value,_.attributes.push({name:"icons",value:n[h]});break}for(var E in i){var A=i[E],L=o.convertToExaleadDataFormatFederated(A);i[E]=L}var D=1;a.isIndexedMode()&&(D=2);var x=[];for(s=0;s<t.length;++s){var w=t[s],T=[];for(m=0;m<w.length;m+=D)T.push(r[w[m]]);x.push(T)}return{paths:x,objects:i}}}};return o}),define("DS/ClassificationEditor/utils/Library_CSO",["DS/Selection/XSO","DS/Logger/Logger","DS/ClassificationEditor/service/LibraryTypeService","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/IPClassifyUX/IPClassifyUXEvents","DS/ClassificationEditor/utils/ClassificationEditorDataConversion","DS/PADUtils/PADProbes","DS/IPClassifyUtil/IPClassifyUtility"],function(e,t,i,r,a,n,o,s){"use strict";var l=e.singleton({name:"library_cso",_logger:null,_currentLibrary:null,init:function(e){var i={areEquals:function(e,t){return e===t}};UWA.extend(i,e),this._parent(i),this._logger=t.getLogger(l);var r=this;this.onPostAdd(function(e){var t="CONTENT",i=e;UWA.is(e,"array")&&(e=e[0]),e&&UWA.is(e.getID,"function")&&e.getID()==r.getCurrentLibraryID()&&(t="TREE"),UWA.is(e)&&a.notifyLibrarySelected({context:t,selectedNode:e,allSelectNodes:i})})},addInLibraryCSO:function(e,t){if(!UWA.is(e))throw new Error("No libraryNode specified");if(!UWA.is(t))throw new Error("No context specified");var l=o.createProbe("library_addInLibraryCSO");if("TREE"==(t=t.toUpperCase())){var c=this;this.empty(!1);var d=this._currentLibrary;this._currentLibrary=e;var u=function(e,t){a.notifyCurrentLibraryChange({previousNode:e,currentNode:t}),c.add(t),l.end()};this._currentLibraryPath=[{id:e.id,type:i.getPLMTypeOfLibraryTreeNode(e),label:e.getLabel(),mxid:e.options.mxid}];var f=!1;if(i.inFamilyLibrary(e.plmType)){if(e.isVisible&&e.isVisible()&&e.getPath){var m=e.getPath();if(Array.isArray(m)&&m.length>=2&&m[0]&&"LibrarySection_AllLibraries"===m[0].plmType){this._currentLibraryPath=[];for(var p=1;p<m.length;p++){var C=m[p];this._currentLibraryPath.push({id:C.id,type:i.getPLMTypeOfLibraryTreeNode(C),label:C.getLabel()})}f=!0}}}else f=!0;f?u(d,e):r.getLibraryPathLength({ids:[e.id],onComplete:function(t){!t.results&&t.error&&(c._logger.warn("Unable to retrieve LibraryPath using Index/Search"),u(d,c._currentLibrary));var i=n.getLibraryDepth(t);if(1===i){var a={};a.id=e.id,a.type=e.plmType,a.label=e.options.label,c._currentLibrary&&a.id==c._currentLibrary.id?(c._currentLibraryPath=[],c._currentLibraryPath.push({id:a.id,type:a.type,label:a.label}),u(d,c._currentLibrary)):c._logger.log("LibraryPath returned by Index do not corresponds to the current Library")}else if(i>1){var o=i-1;r.getLibraryPath({depth:o,pid:e.id,isAuthoringMode:!s.isIndexedMode(),onComplete:function(e){var t=n.convertNavigateToFlatFormat(o,e.result);c._currentLibrary&&t[i-1].physicalid==c._currentLibrary.id&&(c._currentLibraryPath=[],t.forEach(function(e){c._currentLibraryPath.push({id:e.physicalid,type:e["ds6w:type"],label:e["ds6w:label"]})}),u(d,c._currentLibrary))},onFailure:function(e){c._logger.warn("Unable to retrieve LibraryPath using Index/Navigate"),u(d,c._currentLibrary)}})}},onFailure:function(e){c._logger.warn("Unable to retrieve LibraryPathLength using Index/Search"),u(d,c._currentLibrary)}})}else{this.empty(!1);var g=null;0===(g="array"==UWA.typeOf(e)?e:[e]).length?(this.add(this._currentLibrary),l.end()):(this.add(g),l.end())}},removeFromLibraryCSO:function(e){if(!UWA.is(e))throw new Error("No libraryNode specified");this.remove(e),0===this.getSelectedNodes().length&&e!=this._currentLibrary&&this.add(this._currentLibrary)},removeAllFromLibraryCSO:function(){this.empty(!0)},getCurrentLibrary:function(){return this._currentLibrary},getCurrentLibraryID:function(){var e=null;return this._currentLibrary&&this._currentLibrary.getID&&(e=this._currentLibrary.getID()),e},getCurrentLibraryPath:function(){var e=[];return this._currentLibraryPath&&this._currentLibraryPath.forEach(function(t){e.push({id:t.id,type:t.type,label:t.label})}),e},getSelectedNodes:function(){var e=[];return this.get()&&this.get().forEach(function(t){t.getIconUrl=function(){return""},e.push(t)}),e},getSelectedNodesID:function(){var e=[];return this.get()&&this.get().forEach(function(t){e.push(t.getID())}),e},getCAChangeAccessOnClass:function(e){return!!this.CAChangeAccess&&this.CAChangeAccess[e]},setCAChangeAccessOnClass:function(e,t){this.CAChangeAccess={},this.CAChangeAccess[e]=t}});return l}),define("DS/ClassificationEditor/commands/ActionBar_AddToFavoritesCmd",["UWA/Core","DS/ApplicationFrame/CommandCheckHeader","DS/ClassificationEditor/utils/Library_CSO","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/service/LibraryTypeService"],function(e,t,i,r,a,n){"use strict";return t.extend({labelTopBar:r.label_ActionBar_AddToFavorites,isInsert:!0,datas:{},init:function(t){this._parent(t,{});var o=this;i.onChange(function(){o._adaptStateToCurrentLibrary()}),this.onStateChange(function(){if(o.getState()){if(t=i.getCurrentLibrary()){s=t.getID(),l=t.getType(),c=t.options.label;if(s&&n.inFamilyLibrary(l))if(e.is(a.getTreeCont()))0==a.getTreeCont().isLibraryAmongFavoriteLibraries(s)&&a.getTreeCont().addFavorite({id:s,name:c})}o.labelTopBar=r.label_ActionBar_RemoveFromFavorites}else{var t;if(t=i.getCurrentLibrary()){var s=t.getID(),l=t.getType(),c=t.options.label;if(s&&n.inFamilyLibrary(l))if(e.is(a.getTreeCont()))if(1==a.getTreeCont().isLibraryAmongFavoriteLibraries(s))!1===a.getTreeCont().removeFavorite({id:s,name:c})&&o.setState(!0,!1)}o.labelTopBar=r.label_ActionBar_AddToFavorites}})},_adaptStateToCurrentLibrary:function(){var t=i.getCurrentLibrary();if(t&&t.getID){var r=t.getID();if(e.is(a.getTreeCont())){var n=!1;a.getTreeCont().isLibraryAmongFavoriteLibraries(r)&&(n=!0),this.setState(n,!1)}}}})}),define("DS/ClassificationEditor/dataProvider/LibraryCSODataProvider",["UWA/Class","DS/ClassificationEditor/utils/Library_CSO"],function(e,t){"use strict";return e.singleton({getCurrentObject:function(){return t.getCurrentLibrary()},getCurrentObjectPath:function(){return t.getCurrentLibraryPath()},addInCSO:function(e,i){t.addInLibraryCSO(e,i)},getSelectedNodes:function(){return t.getSelectedNodes()},getSelectedNodesID:function(){return t.getSelectedNodesID()}})}),define("DS/ClassificationEditor/utils/ClassificationEditorUtil",["UWA/Utils","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUtil/IPClassifyAlert","DS/IPClassifyUX/events/IPClassifyEvents","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/PADUtils/PADSettingsMgt","DS/IPClassifyUtil/IPClassifyPreference"],function(e,t,i,r,a,n,o,s,l,c,d,u){var f={nameRules:{maxLength:127},shouldBeEditable:function(e){return!1},onNodeModelUpdate:function(e){var s=e.data.nodeModel;if(i.inFamilyLibrary(s.plmType)){var l=s._lastUpdateTime?s._lastUpdateTime:0,d=Date.now()-l;if(s._lastUpdateTime=Date.now(),console.log("lastUpdateTime : "+l+", elapsedTime : "+d),!(0!==l&&d<300))if(s._resetting)s._resetting=!1;else{var u=s.getID(),m=s.options.label,p=s.options.oldLabel;if(void 0===p&&(p=""),m!==p){m&&m.trim&&(m=m.trim());var C=!0;if(m.length>f.nameRules.maxLength&&(r.displayNotification({message:n.replace(n.get("msg_error_name_maxlength"),{name:m,maxLength:f.nameRules.maxLength}),className:"error"}),C=!1),0==m.trim().length&&(r.displayNotification({message:n.get("msg_error_name_empty"),className:"error"}),C=!1),C)if(s.isFavorite){if(UWA.is(o.getTreeCont())){var g={id:u,name:p};o.getTreeCont().renameFavorite(g,m,s)}}else t.setProperties({pid:u,plmType:s.plmType,properties:{title:m},onComplete:function(e){var t;"RootLibrary"===s.plmType?t=n.replace(n.get("msg_info_renameLibrary"),{name1:p,name2:m}):"Library"===s.plmType&&(t=n.replace(n.get("msg_info_renameClass"),{name1:p,name2:m})),c.setAuthoringMode("authoring",t),c.updateRefreshTime(),s.options.oldLabel=m,a.notifyLibraryRename({oldNode:s,newLabel:m});var i={},r=[];r.push(u),i.modified=r,i.fromRenameOp=!0,o.getContent()._libraryContentView.getPADTreeDocument().refreshNodeById(i)},onFailure:function(e){r.displayNotification({message:n.replace(n.get("msg_error_rename"),{name1:p}),className:"error"}),s._resetting=!0,setTimeout(function(){s.withTransactionUpdate(function(){this.setLabel(p)}),s._resetting=!1})}});else s.withTransactionUpdate(function(){this.setLabel(p)})}}}},getCurrentSecurityContextAndLibraryData:function(e){var t=s.getCurrentLibrary(),r=d.getSetting("pad_security_ctx"),a=widget.getValue("pad_tenant"),n={From:"ClassificationEditor",LibraryID:null,LibraryType:null,IsInDeletedItems:!1,Timestamp:Date.now(),Tenant:a,SecurityContext:r};return t&&(i.inFamilyLibrary(t.plmType)||e)&&(n.LibraryID=t.getID(),n.LibraryType=t.getType()),n},sortColumn:function(e,t){var r=i.inFamilyLibrary(e.plmType),a=i.inFamilyLibrary(t.plmType);return r&&!a?-1:!r&&a?1:0},setLeftPanelStatus:function(e){u.set("classEditor_view_status",{leftPanelState:e},!0,!1)},setRightPanelStatus:function(e){u.set("classEditor_view_status",{rightPanelState:e},!0,!1)},getLeftPanelStatus:function(){return new Promise(function(e){u.get("classEditor_view_status",function(t){t&&t.hasOwnProperty("leftPanelState")?e(t.leftPanelState):e({leftPanelState:!0,isWelcomePanelCollapsed:!1})},!0)})},getRightPanelStatus:function(){return new Promise(function(e){u.get("classEditor_view_status",function(t){t&&t.hasOwnProperty("rightPanelState")?e(t.rightPanelState):e({rightPanelState:!1,size:250})},!0)})},sortAttributeColumn:function(e,t,i){var r=e.options.grid[i.order_field]?e.options.grid[i.order_field]:"",a=t.options.grid[i.order_field]?t.options.grid[i.order_field]:"",n=r.localeCompare(a);return"asc"===i.order_by?n:-n},CONTENT_TABS:{CLASSES:0,CLASSIFICATION_ATTRIBUTES:1}};return f}),define("DS/ClassificationEditor/utils/LibraryCommandManager",["DS/ApplicationFrame/CommandsManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/service/LibraryTypeService","DS/WidgetServices/WidgetServices"],function(e,t,i,r){"use strict";var a=["CreateSnapshotHdr"],n={ColumnVisibility:{enable:{view:"datagridview"}}},o={enableAllCommands:function(i){var r,n=e.getCommands();for(r in n)if(this.checkCommandCond(r,i)){var o=e.getCommand(r,t.getContent().getView());UWA.is(o)&&a.indexOf(r)<0&&(i?o.enable():"ListSnapshotsHdr"!==r&&o.disable())}},enableFavoriteCommands:function(t){var i=e.getCommandCheckHeader("AddToFavorites");i&&t?i.enable():i&&i.disable()},ItemSelected:function(e,r,a){var n=[],s=[];if("TREE"===r)i.inFamilyLibrary(e.plmType)?(o.enableAllCommands(!0),o.enableFavoriteCommands(!0),s.push("SelectSiblings")):"LibrarySection_favorite"==e.plmType?(o.enableAllCommands(!1),o.enableFavoriteCommands(!1),n.push("treeview","tileview","thumbnailview","ExpandAll","ExpandN","CollapseAll","SelectAll","SelectInversion")):"LibrarySection_AllLibraries"==e.plmType?(o.enableAllCommands(!1),o.enableFavoriteCommands(!1),n.push("treeview","tileview","thumbnailview","ExpandAll","ExpandN","CollapseAll","SelectAll","SelectInversion")):(o.enableAllCommands(!1),o.enableFavoriteCommands(!1));else if("CONTENT"===r){var l=a.plmType,c=t.getContent().getView().getSelectedNodes();if(o.enableFavoriteCommands(!0),i.inFamilyLibrary(l)&&"Busy"===e.plmType)o.enableAllCommands(!1);else if(i.inFamilyLibrary(l))o.enableAllCommands(!0),s.push("ExpandAll","ExpandN","CollapseAll");else if("LibrarySection_AllLibraries"==l){if(o.enableAllCommands(!0),1===c.length)c[0].plmType||c[0].getType();s.push("ExpandAll","ExpandN","CollapseAll")}else"LibrarySection_favorite"==l?(o.enableAllCommands(!1),n.push("treeview","tileview","thumbnailview","ExpandAll","ExpandN","CollapseAll","SelectAll","SelectInversion","SelectSiblings")):o.enableAllCommands(!1)}this._switchCommands(n,!0),this._switchCommands(s,!1)},getCommand:function(i){return e.getCommand(i,t.getContent().getView())},checkCommandCond:function(e,i){var r=!0;if(n[e]){var a=n[e];i&&a.enable&&a.enable.view&&a.enable.view!=t.getContent().getView().getActiveView()&&(r=!1)}return r},_switchCommands:function(e,t){for(var i=0;i<e.length;++i)if(this.checkCommandCond(e[i],t)){var r=this.getCommand(e[i]);try{t?r.enable():r.disable()}catch(r){console.error("Error "+(t?"enabling":"disabling"),e[i],r)}}}};return o}),define("DS/ClassificationEditor/ActionBar/LibraryActionBar",["UWA/Core","UWA/Controls/Abstract","UWA/Class/Events","UWA/Class/Options","DS/Logger/Logger","DS/ClassificationEditor/utils/LibraryCommandManager","DS/ApplicationFrame/CommandsManager","DS/ApplicationFrame/ActionBar","DS/Core/ModelEvents","DS/ClassificationEditor/utils/Library_CSO","DS/RuntimeView/NLSManager","DS/PADUtils/PADContext","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/PADUtils/PADProbes","DS/WidgetServices/WidgetServices","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/IPClassifyUXEvents"],function(e,t,i,r,a,n,o,s,l,c,d,u,f,m,p,C,g){"use strict";var b=t.extend(r,i,{name:"library_actionbar",_logger:null,_actionBar:null,_language:"en",_context:null,_isReady:!1,_modelEvents:null,init:function(e){this._probeLoadElmt=m.createProbe("loadActionBar");var t=this;e.language&&(this._language=widget.lang?widget.lang:widget.getValue("lang")),e.context?this._context=e.context:this._context=this,this._modelEvents=new l,this._parent(e),this._logger=a.getLogger(b),this.onLoad(e),this.getOption("renderTo")&&this.render().inject(this.getOption("renderTo")),this.onReady(function(){t.syncState(),g.onLibrarySelected(function(e){var t=c.getCurrentLibrary();n.ItemSelected(e.selectedNode,e.context,t)}),g.onContentSearchChange(function(){var e=c.getCurrentLibrary();e&&n.ItemSelected(e,"TREE",e)}),c.onEmpty(function(){n.enableAllCommands(!1)}),UWA.is(e.events)&&UWA.is(e.events.onActionBarReady,"function")&&e.events.onActionBarReady(),t._probeLoadElmt.end()})},render:function(){return this},loadActionBar:function(e){this._actionBar.loadModel(e)},destroy:function(){this._logger.log("destroy"),this._actionBar&&(delete this._actionBar,this._actionBar=null),this._parent()},onLoad:function(t){var i=this;i._context.options=i._context.options||{},UWA.extend(i._context.options,{custo_view_title:f.name_Widget_Title}),i._context.getFolderXSO=function(){return c},u.set(i._context);if(!e.is(this.elements.container)){d.DEFAULT_LANGUAGE=widget.lang?widget.lang:widget.getValue("lang"),this.elements.container=UWA.createElement("div",{class:this.getClassNames()});var r=C.isCustomizedEnv()?"ENOLibraryCusto.xml":"ENOLibrary.xml",a="ClassificationEditor";t.dataForActiveClassODT&&t.dataForActiveClassODT.ActionBarCommandsXML&&t.dataForActiveClassODT.ModuleForCommandsXML&&(r=t.dataForActiveClassODT.ActionBarCommandsXML,a=t.dataForActiveClassODT.ModuleForCommandsXML),this._actionBar=new s({context:null,file:r,module:a,language:widget.lang?widget.lang:widget.getValue("lang")});var n=this._actionBar.onActionBarReady(function(){i._actionBar._modelEvents.unsubscribe(n),i._isReady=!0,i._modelEvents.publish({event:"READY",context:i})})}},onReady:function(e){return this._modelEvents.subscribe({event:"READY"},e)},syncState:function(){var e=c.getCurrentLibrary(),t=c.get();if(e&&t&&t.length>0){var i="CONTENT";e.getID()==t[0].getID()&&(i="TREE"),n.ItemSelected(t[0],i,e)}else n.enableAllCommands(!1)}});return b}),define("DS/ClassificationEditor/ActionBar/ClassificationCommandManager",["UWA/Class","DS/ApplicationFrame/CommandsManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/service/LibraryTypeService","DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUX/IPClassifyUXEvents","DS/IPClassifyUXUtil/ActionBar/IPCommandManager","DS/PADServices/utils/GlobalModelEvents","DS/IPClassifyUX/utils/IPClassifyWidgetData","DS/IPClassifyUX/events/IPClassifyEvents"],function(e,t,i,r,a,n,o,s,l,c){"use strict";var d={};return e.singleton(o,{noSizeToFit:["classificationLocation"],initialize:function(){var e=this;n.onLibrarySelected(()=>{e.updateCommands()}),a.onEmpty(()=>{e.enableAllCommands(!1)}),c.onContentTabChange(function(){e.updateCommands()});var t=new Promise(e=>{require(["text!DS/ClassificationEditor/assets/afr/ClassificationEditor.json"],e)});return new Promise(e=>{t.then(t=>{var i={};if(t)for(var r in(i=JSON.parse(t)).headers){i.headers[r].ID=r}d=i.Rules,e(i)})})},revaluateContentValue:function(e,t){if(!0===e.CONTENT)return!0;if(!t.checkWhiteClick&&!t.isFavoriteNode&&t.isCtxMenu&&!1===e.CONTENT.ctxMenu)return!1;var i=!0;if(!1!==i&&e.CONTENT.filter){var r=e.CONTENT.filter;t.isCtxMenu&&r.ctxMenuRestictTo&&Array.isArray(r.ctxMenuRestictTo)&&(i=r.ctxMenuRestictTo.includes(t.plmType)),!1!==i&&r.ctxMenuOnly&&Array.isArray(r.ctxMenuOnly)&&(i=!r.ctxMenuOnly.includes(t.tab)||1==t.isCtxMenu)}return!1!==i&&1==e.CONTENT.favCtxMenuOnly&&(i=t.isCtxMenu&&!t.isMultiSelect&&t.isFavoriteNode),!1!==i&&(!0===e.CONTENT.FavContent?i=t.isFavSection:!1===e.CONTENT.FavContent&&(i=!t.isFavSection)),!1!==i&&(!0===e.CONTENT.RootLibraries?i=t.isRoot:!1===e.CONTENT.RootLibraries&&(i=!t.isRoot||1==t.isCtxMenu&&1==t.isFavoriteNode)),!1!==i&&(!0===e.CONTENT.Libraries?i=t.isLibrary:!1===e.CONTENT.Libraries&&(i=!t.isLibrary)),!1!==i&&(!0===e.CONTENT.FavNode?i=t.isFavoriteNode:!1===e.CONTENT.FavNode&&(i=!t.isFavoriteNode)),!1!==i&&1==t.isCtxMenu&&t.isFavoriteNode&&e.CONTENT&&!0===e.CONTENT.ctxFavOnMultiSel&&(i=!0),i},revaluateTreeValue:function(e,t){if(!0===e.TREE)return!0;if(!t.checkWhiteClick&&!t.isFavoriteNode&&t.isCtxMenu&&!1===e.TREE.ctxMenu)return!1;var i=!0;if(e.TREE.filter){var r=e.TREE.filter;t.isCtxMenu&&r.ctxMenuRestictTo&&Array.isArray(r.ctxMenuRestictTo)&&(i=r.ctxMenuRestictTo.includes(t.plmType)),!1!==i&&r.ctxMenuOnly&&Array.isArray(r.ctxMenuOnly)&&(i=!r.ctxMenuOnly.includes(t.tab)||1==t.isCtxMenu)}return!1!==i&&(!0===e.TREE.Sections?i=t.isSection:!1===e.TREE.Sections&&(i=!t.isSection)),!1!==i&&(!0===e.TREE.RootLibraries?i=t.isRoot:!1===e.TREE.RootLibraries&&(i=!t.isRoot)),!1!==i&&(!0===e.TREE.Libraries?i=t.isLibrary:!1===e.TREE.Libraries&&(i=!t.isLibrary)),!1!==i&&(!0===e.TREE.FavSection?i=t.isFavSection:!1===e.TREE.FavSection&&(i=!t.isFavSection)),!1!==i&&(!0===e.TREE.FavNode?i=t.isFavoriteNode:!1===e.TREE.FavNode&&(i=!t.isFavoriteNode)),i},_manageSwitchOfCommands:function(e,t,i,a){var n=!1,o=i&&!!t&&0===t.length;!e||t&&0!=t.length||o?t&&t.length>0&&(n=t[0].isFavorite):n=e.isFavorite;var s=l.getWidgetData().currentTab,c=!1,u=!1,f=!1,m=!1,p=!1,C=!1;e&&(p="LibrarySection_favorite"==e.plmType,C="LibrarySection_AllLibraries"==e.plmType,f=r.isRootLibrary(e.plmType),m=r.isLibrary(e.plmType));var g=p||C,b=!1;t&&t.every(function(e){return c=c||r.isRootLibrary(e.plmType),u=u||r.isLibrary(e.plmType),b=b||"Busy"===e.plmType,!c||!u||!b});var y=!0;if((p||b||(C||!e)&&t&&0===t.length)&&(y=!1),i||this.enableAllCommands(y),!b){var v={},h=Object.keys(d);a&&(h=a);var _={};return _.isSection=g,_.isFavSection=p,_.isCtxMenu=i,_.isFavoriteNode=n,_.checkWhiteClick=o,_.tab=s,h.forEach(r=>{var a=d[r];if(a){var l=t&&t.length>0,p=e&&(!l||void 0===a.CONTENT),C=!0;"object"==typeof a&&(C&&a.TABS&&Array.isArray(a.TABS)&&(C=a.TABS.includes(s)),(C&&!1===a.TREE&&p||!1===a.CONTENT&&l)&&(C=!1),C&&o&&(C=1==a.white_click||a.white_click==e.plmType||a.white_click===s),C&&void 0!==a.multisel&&(C=!t||t.length<=1),C&&!1===a.NoSelection&&(C=t&&t.length>0),C&&i&&n&&!0!==a.ctxFavorite&&(C=t&&t.length>1&&1==a.CONTENT.ctxFavOnMultiSel),C&&!1===a.CATIAV6&&(C=!0!==widget.getValue("noCompass")),C&&a.TREE&&p&&(_.plmType=e.plmType,_.isRoot=f,_.isLibrary=m,p=this.revaluateTreeValue(a,_)),C&&a.CONTENT&&l&&(_.plmType=t[0].plmType,_.isRoot=c,_.isLibrary=u,_.isFavoriteNode=n,_.isCtxMenu=i,_.isMultiSelect=t&&t.length>1,l=this.revaluateContentValue(a,_)),C=C&&(!0===l||!0===p||null===l&&null===p)),v[r]=C,(!i||a.TREE.filter&&a.TREE.filter.ctxMenuOnly||a.CONTENT.filter&&a.CONTENT.filter.ctxMenuOnly)&&this._switchCommand(r,C,a.type),i||"openWith"!==r||this.getModelEvents().publish({event:"build_openwith",data:{visible:C,nodes:l?t:[e]}})}}),v}},enableAllCommands:function(e){var i=t.getCommands();for(var r in i){var a=t.getCommand(r);UWA.is(a)&&a.enable&&(e?this._switchCommand(r,!0):this._switchCommand(r,!1))}},getModelEvents:function(){return s.getModelEvents()},updateCommands:function(e,t){if(t||(t=a.getCurrentLibrary()),i.getContent()&&i.getContent().getView().getPADTreeDocument()){var r=i.getContent().getView().getPADTreeDocument().getSelectedNodes();r=r||(e?[e]:[]),this._parent(t,r)}}})}),define("DS/ClassificationEditor/dataProvider/LibraryIdCardDataProvider",["UWA/Class","UWA/Class/Promise","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/utils/ClassificationEditorDataConversion","DS/ClassificationEditor/ActionBar/ClassificationCommandManager","DS/ClassificationEditor/service/LibraryTypeService","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,r,a,n,o,s){"use strict";return e.singleton({getChildrenInfos:function(e){return new t(function(t){var n=i.getTreeCont()._getVisibleNodeById(e);if(n){var o=n.getChildren();t(o)}else r.libraries({pid:e,onComplete:function(i){var r=[];i.results?r=a.convertExpandToSearchFormat(e,i.results):i.result&&(r=a.convertNavigateToSearchFormat(i.result)),r.forEach(function(e){e.plmType=e.plmType||"Library"}),t(r)},onFailure:function(e){console.warn("WebService libraries Err : "+e),t([])}})})},isSection:function(e){return"LibrarySection_favorite"==e||"LibrarySection_AllLibraries"==e},isSearchInContextAvailable:function(){return!1},getLibraryControl:function(){return i},getCommandManager:function(){return n},getLibraryTypeService:function(){return o}})}),define("DS/ClassificationEditor/commands/LibraryCommands",["DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/utils/Library_CSO","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ApplicationFrame/CommandsManager","DS/PADUtils/views/PADProgressBar","DS/WidgetServices/WidgetServices","text!DS/ClassificationEditor/assets/ClassificationProbesCommandMapping.json","DS/ClassificationEditor/ActionBar/ClassificationCommandManager"],function(e,t,i,r,a,n,o,s,l){"use strict";JSON.parse(s);return{_endProgressBarListener:function(){var e=this;r.getContent().getView().addEvent("onCompleteRefreshNodes",function(t){this.removeEvent("onCompleteRefreshNodes"),e._offProgressBar()})},_offProgressBar:function(){if(0===n._counter)return null;n.off()},_commonError:function(t,i,r){console.error(t,r);var a=i;!UWA.is(r)||r instanceof Error||(a+="<br>"+r),e.displayNotification({message:a,className:"error"})},_startProgressBar:function(e){1===n._counter&&n.off(),n.on(e)},_nbItemsNotNull:function(e){var t,i=e.length,r=0;for(t=0;t<i;++t)e&&r++;return r},convertSystemError:function(e){return-1!=e.indexOf("No fromconnect access to business object")?i.error_no_fromconnect_onParent:(console.error("Unexpected Error:: "+e),i.error_unexpected)},extractMyErrorMessage:function(e,t,r){var a=e;return e&&"timeout"===e.type?a=i.msg_InfoAction_Timeout:t&&(r&&"application/json"===r["content-type"]?(t="string"==typeof t?JSON.parse(t):t).error&&t.error.message&&(a=t.error.message):a="User doesnt have Librarian Role"===t?i.error_no_LibrarianRole:"string"==typeof t&&0===t.indexOf("System Error:")?this.convertSystemError(t):t),a},RenameCmd:function(e,t){if("CONTENT"==t){var i=e.manager.layout.getColumnIndex("tree"),r=e.manager.layout.getCellsFromNodeModel(e.nodeModel)[i],a=e.manager.getEditionManager(r);a.onF2&&(e.manager.setActiveCell(r),a.onF2(r))}else{var n=e.manager.layout.getColumnIndex("tree");r=e.manager.layout.getCellIDFromCoordinates({rowID:e.rowID,columnID:n});e.manager.setCellInEdition(r)}},CreateLibraryCmd:function(e,t){var i=a.getCommand("CreateNewLibrary",r.getContent());i&&i.begin()},ImportLibraryCmd:function(e,t){var i=a.getCommand("ImportLibrary",r.getContent());i&&i.begin()},ExportLibraryCmd:function(e,t){var i=a.getCommand("ExportLibrary",r.getContent());i&&i.begin()},DeleteLibraryCmd:function(e,t){var i=a.getCommand("DeleteLibrary",r.getContent());i&&i.begin()},CreateClassCmd:function(e,t){var i=a.getCommand("CreateNewClass",r.getContent());i&&i.begin()},DeleteClassCmd:function(e,t){var i=a.getCommand("DeleteClass",r.getContent());i&&i.begin()},MoveClassCmd:function(e,t){var i=a.getCommand("MoveClass",r.getContent());i&&i.begin()},ExpandAllCmd:function(r,a){r.plmType;var n=[];"TREE"===a&&r?n.push(r):n=t.getSelectedNodes();var o=null;o=t.getCurrentLibrary(),n.length?n.forEach(function(e){null===e.options.children||e.expandAll()}):null===o?e.displayNotification({message:i.msg_warning_nocurrentlibrary,className:"warning"}):o.expandAll()},CollapseAllCmd:function(r,a){r.plmType;var n=[],o=t.getCurrentLibrary();"TREE"===a&&r?n.push(r):n=t.getSelectedNodes(),n.length?n.forEach(function(e){e.collapseAll()}):null===o?e.displayNotification({message:i.msg_warning_noselection,className:"warning"}):o.collapseAll()},ChangeMaturityCmd:function(e,t){var i=a.getCommand("MaturityHdr",r.getContent());i&&i.begin()},AccessRightCmd:function(e,t){var i=a.getCommand("ActionBar_AccessRightCmd",r.getContent());i&&i.begin()},EditPropertiesCmd:function(e,t){var i=a.getCommand("ActionBar_Attributes",r.getContent().getView());i&&i.begin()},RemoveFavoriteCmd:function(e,t){var i=e;if(console.log("  RemoveFavoriteCmd currentFavoriteTreeNode : ",i),i&&i.isFavorite){var a=i.getID(),n=i.options.label;console.log("  currentLibrary Id : ",a),a&&UWA.is(r.getTreeCont())&&r.getTreeCont().removeFavorite({id:a,name:n})}},AddExistingAttributesCmd:function(e,t){var i=a.getCommand("AddExistingAttributes",r.getContent());i&&i.begin()},RemoveAttributesCmd:function(e,t){var i=a.getCommand("RemoveAttributes",r.getContent());i&&i.begin()},GetContextualMenuForAttributes:function(e,i,r){var a=!0===(!!e.white_Click&&e.white_Click)?a=t.getCurrentLibrary():e.nodeModel;return void 0===a&&(a=e),Array.isArray(a)||(a=[a]),"CONTENT"===i?(r||(r={cellInfos:e,data:{event:{pageX:0,pageY:0}}}),Promise.resolve(l.getContextualMenu(a,!1,r))):Promise.resolve([])},GetContextualMenu:function(e,i,a){var n,o=!!e.white_Click&&e.white_Click,s=a?r.getContent().getView().getPADTreeDocument().getSelectedNodes():[];try{n=!0===o?n=t.getCurrentLibrary():s&&s.length>0?s:e.nodeModel}catch(e){n=void 0}return void 0===n&&(n=e),Array.isArray(n)||(n=[n]),a||(a={cellInfos:e,data:{event:{pageX:0,pageY:0}}}),l.getContextualMenu(n,"TREE"===i,a)},_checkTypeAvailability:function(e,i){if(i){var r=i.managedTypes;if(r){var a=null;if(a="TREE"===e?(a=t.getCurrentLibrary())?[a]:[]:t.getSelectedNodes())for(var n=!0,o=0;o<a.length;++o){var s=a[o];if(!(n=!(!s.options||!s.options.type)&&r.indexOf(s.options.type)>-1))return n}}}return!0},_addCtxCmd:function(e,t,i){var r=!0;o.isNatifEnvironnement()?0==i.nativeAvailability?r=!1:o.isWebInWinEnvironment()||0==i.v6Availability&&(r=!1):0==i.dashboardAvailability&&(r=!1),r&&(r=this._checkTypeAvailability(e,i)),r&&t.push(i)},_addCtxCmdAsync:function(e,t,i){var r=this._checkTypeAvailability(e,i);return new Promise(function(e){r?i.addMenus(t).then(function(t){e(t)}):e(t)})},_addHiddenInput:function(e){var t=r.getContent().getView();UWA.createElement("a",{href:e,styles:{display:"hidden"}}).inject(t.elements.container).click()}}}),define("DS/ClassificationEditor/dataProvider/LibraryContentDataProvider",["UWA/Class","UWA/Class/Promise","DS/PADUtils/PADProbes","DS/ClassificationEditor/utils/ClassificationEditorDataConversion","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUtil/IPClassifyPreference","DS/ClassificationEditor/utils/ClassificationEditorUtil","DS/ClassificationEditor/utils/LibrarySearch","DS/ClassificationEditor/commands/LibraryCommands","DS/IPClassifyUtil/IPClassifyAlert","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUtil/IPClassifyUtility","DS/ClassificationEditor/utils/ClassificationEditorcontrol"],function(e,t,i,r,a,n,o,s,l,c,d,u,f,m,p){"use strict";var C={FAVORITES:"ipcFavoriteList_v1",getFavorites:function(){return m.getTenantAwarePreferenceName(this.FAVORITES)}},g=null,b={order_field:"Name",order_by:"asc"},y=e.singleton({getObjectsForRefresh:function(e,i){return new t(function(t){var n=[];i.forEach(function(e){e.isDynamic&&-1===n.indexOf(e.dataIndex)&&n.push(e.dataIndex)}),a._performFetchQuery({ids:e,dynamicAttrs:n,isAuthoringMode:!0,onComplete:function(e){var i=[];e.results&&e.results.length>0&&e.results.forEach(function(e){i.push(r.convertToExaleadDataFormatFederated(e))}),t(i)},onFailure:function(){console.error("Unable to update Content root node, Error in getting content Properties"),t(null)}})})},_getAttributesTabContents:function(e){return b.order_field=e.order_field,b.order_by=e.order_by,new t(function(t,n){var o=i.createProbe("probeFetchClassificationAttrs");a.getClassificationAttributes({classid:e.pid,onComplete:function(i){var a=JSON.parse(i),n=a.attribute;n||(n=a.Attribute),f.setCAChangeAccessOnClass(e.pid,a.changeaccess);var s=function(e){var t={},i=[];e.forEach(function(e){var t=r.convertAttributeToExaleadDataFormat(e);t.plmType="Attribute",i.push(t)}),t.contents=i;var a={};return a.nhits=i.length,a.nresults=i.length,a.next_start="0 0",t.infos=a,t}(n);t({contents:s.contents,infos:s.infos,facets:{}}),o.end()},onFailure:function(e,t,i){var r=u.get("msg_classificationattributes_webservicefailed")+": "+c.extractMyErrorMessage(e,t,i);n({msg:r}),o.end()}})})},_getDefaultTabContents:function(e){return new t(function(t,i){a.content({pid:e.pid,mxid:e.mxid,searchQuery:e.searchQuery,isExactSearch:e.isExactSearch,selectedType:e.selectedType,dynamicattributes:e.dynamicattributes,filters:e.filters,start:e.start,next_start:e.next_start,order_field:e.order_field,order_by:e.order_by,isAuthoringMode:!m.isIndexedMode(),onComplete:function(i){if((i="string"==typeof i?JSON.parse(i):i).result)return a=r.convertNavigateToSearchFormat(i.result),void t({contents:o(a),infos:i.infos,facets:i.facets});var a=function(e,t){var i=[];null!=e&&e.forEach(function(e){var r=!1;e.attributes&&e.attributes.forEach(function(e){"physicalid"===e.name&&e.value!=t&&(r=!0)}),r&&i.push(e)});return i}(i.results,e.pid);function o(e){var t=[];return e.forEach(function(e){var i=r.convertToExaleadDataFormatFederated(e),a=e.attributes;i.plmType=n.getPlmTypeFromContentDetails(a),i.Documentlocked=e.Documentlocked,i.publishOnConnect=e.publishOnConnect,t.push(i)}),t}t({contents:o(a),infos:i.infos,facets:i.facets})},onFailure:function(e,t){i({err:e,serverErr:t,msg:u.msg_error_contentnotavailable})}})})},getObjectContents:function(e){return g=e.widgetData,new t(function(t,i){var r=e.widgetData;r&&r.currentTab&&r.currentTab!==s.CONTENT_TABS.CLASSES?y._getAttributesTabContents(e).then(function(e){t(e)},function(e){i(e)}):y._getDefaultTabContents(e).then(function(e){t(e)},function(e){i(e)})})},getPaginatedSectionContents:function(e){return g=e.widgetData,new t(function(t,i){a.roots({filters:e.filters,start:e.start,next_start:e.next_start,order_field:e.order_field,order_by:e.order_by,isAuthoringMode:!m.isIndexedMode(),onComplete:function(e){var i=[];e.results&&e.results.forEach(function(e){var t=r.convertToExaleadDataFormatFederated(e),a=e.attributes;t.plmType=n.getPlmTypeFromContentDetails(a),t.Documentlocked=e.Documentlocked,t.publishOnConnect=e.publishOnConnect,i.push(t)}),t({results:i,infos:e.infos,facets:e.facets})},onFailure:function(){i()}})})},getPreferenceSectionContents:function(e){return g=e.widgetData,new t(function(t,i){a.favourites({ids:e.ids,onComplete:function(e){for(var i=(e="string"==typeof e?JSON.parse(e):e).results?e.results:[],a=[],o=0;o<i.length;++o){var s=n.getPlmTypeFromContentDetails(i[o].attributes),l=r.convertToExaleadDataFormatFederated(i[o]);l.plmType=s,a.push(l)}t(a)},onFailure:function(e){i(e)}})})},getContextualMenu:function(e,t,i,r){return i&&i.currentTab&&i.currentTab!==s.CONTENT_TABS.CLASSES?i.currentTab===s.CONTENT_TABS.CLASSIFICATION_ATTRIBUTES?c.GetContextualMenuForAttributes(e,t,r):[]:c.GetContextualMenu(e,t,r)},comparator:function(e,t){return g&&g.currentTab&&g.currentTab!==s.CONTENT_TABS.CLASSES?g.currentTab===s.CONTENT_TABS.CLASSIFICATION_ATTRIBUTES?s.sortAttributeColumn(e,t,b):void 0:s.sortColumn(e,t)},getPreferenceSectionName:function(){return C.getFavorites()},isValidType:function(e){return n.inFamilyLibrary(e)},isValidTypeForPlaceholder:function(e,t){return!0},toEnableTreeColumnEdit:function(e,t){return!t||!t.currentTab||t.currentTab===s.CONTENT_TABS.CLASSES},isSection:function(e){return"LibrarySection_favorite"==e||"LibrarySection_AllLibraries"==e},isPreferenceSection:function(e){return"LibrarySection_favorite"==e},isPaginatedSection:function(e){return"LibrarySection_AllLibraries"==e},shouldBeEditable:function(e){return s.shouldBeEditable(e)},onContentUpdate:function(e){return s.onNodeModelUpdate(e)},onAddColumn:function(e){l.filterExcludeListColumns(e).length>0&&(l.setPredicates(e),l.addToPredicateHeaderMap(e))},onRemoveColumn:function(e){l.removePredicates(e),l.removeFromPredicateHeaderMap(e)},onResetColumn:function(e,t){l.removeAllPredicates(),l.setPredicates(e,t)},setColumnNames:function(e,t){l.setPredicates(e,t)},initColumns:function(e){l.initPredicateToHeaderMap(e)},getPageTabs:function(){var e=[];return e.push({label:u.classes_tab,isSelected:!0,value:s.CONTENT_TABS.CLASSES,icon:{iconName:"library-books",fontIconFamily:WUXManagedFontIcons.Font3DS}}),e.push({label:u.classification_attributes_tab,value:s.CONTENT_TABS.CLASSIFICATION_ATTRIBUTES,icon:{iconName:"attributes",fontIconFamily:WUXManagedFontIcons.Font3DS}}),e},getTabsVisOnSelectionChange:function(){if(!f.getCurrentLibrary())return!1;var e=f.getCurrentLibrary().getType();return!this.isSection(e)&&"RootLibrary"!==e},getColumnConfig:function(e){return e&&e.currentTab&&e.currentTab!==s.CONTENT_TABS.CLASSES?[{dataIndex:"Name",text:u.column_Name,defaultSortOrder:"asc"},{dataIndex:"Type",text:u.column_Type},{dataIndex:"Description",text:u.column_Description},{dataIndex:"DefaultValue",text:u.column_DefaultValue},{dataIndex:"hasDefault",text:u.hasDefault},{dataIndex:"Dimensions",text:u.column_Dimensions},{dataIndex:"Predicates",text:u.column_Predicates},{dataIndex:"AuthorizedValues",text:u.column_Authorized_Values},{dataIndex:"attrIsParametric",text:u.column_Is_Parametric},{dataIndex:"IsMultivalue",text:u.column_Is_Multivalue},{dataIndex:"Minimum",text:u.column_Minimum},{dataIndex:"Maximum",text:u.column_Maximum},{dataIndex:"isInDico",text:u.existInDictionary}]:[{dataIndex:"ds6w:type"},{dataIndex:"ds6w:status"},{dataIndex:"ds6w:description"},{dataIndex:"ds6w:responsible"},{dataIndex:"ds6w:modified"},{dataIndex:"ds6w:created"},{dataIndex:"ds6w:identifier"},{dataIndex:"ds6w:reservedBy"}]},isDNDSupported:function(){return!0},showContentPlaceholder:function(){return!0},hasLibrarianRole:function(){return new t(function(e,t){a.hasLibrarianRole({onComplete:function(t){e({readOnly:JSON.parse(t).showAttachmentsTabCommands.readOnly,isLeader:JSON.parse(t).rolesInfo.isLeader,isOwner:JSON.parse(t).rolesInfo.isOwner})},onFailure:function(){t({readOnly:!0,isLeader:!0,isOwner:!1})}})})},getLibraryControl:function(){return p},getLibraryEditorUtil:function(){return s},getLibraryTypeService:function(){return n}});return y}),define("DS/ClassificationEditor/commands/ActionBar_CollapseAllCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/LibraryCommands","DS/ClassificationEditor/utils/Library_CSO"],function(e,t,i,r){"use strict";return t.extend({labelTopBar:e.i18n("Collase All"),isInsert:!0,datas:{},init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=r.getSelectedNodes();if(e.length){var t=e[0];i.CollapseAllCmd(t,"CONTENT")}else{var a=r.getCurrentLibrary();i.CollapseAllCmd(a,"TREE")}},endExecute:function(){}})}),define("DS/ClassificationEditor/utils/ClassificationEditorKeyboardListener",["UWA/Core","UWA/Class","UWA/Event","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/commands/LibraryCommands","DS/ClassificationEditor/utils/LibraryCommandManager","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUX/events/IPClassifyEvents","DS/Logger/Logger"],function(e,t,i,r,a,n,o,s,l,c){var d=t.extend({name:"ClassificationEditorKeyboardListener",init:function(e){this._parent(e),this._logger=c.getLogger(d),this._onKeyDown_binded=this._onKeyDown.bind(this)},startObservingKeyboard:function(){e.Element.addEvent.call(document,"keydown",this._onKeyDown_binded)},_onKeyDown:function(e){var t=this,a=i.whichKey(e);e.ODTENVKeyName&&(a=e.ODTENVKeyName);var c,d,u,f=function(){var e=document.activeElement;return!(!e||"INPUT"!==e.tagName&&"TEXTAREA"!==e.tagName)};switch(a){case"ctrl+a":c=a,d="SelectAll",(u=n.getCommand(d))&&u.isEnabled()?f()?t._logger.log("Info : '"+c+"' key pressed in INPUT field, no command launched"):(u.begin(),i.stop(e)):t._logger.log("Info : '"+c+"' key pressed, but command '"+d+"' is disabled");break;case"alt+return":l.notifyInfoExpand();break;case"ctrl+f":var m=r.getIdCardCont();m._isSearchAvailable()&&(m.switchSearch(!0),i.stop(e));break;case"f2":if(f())t._logger.log("Info : '"+a+"' key pressed in INPUT field, no command launched");else{var p=o.getSelectedNodes(),C=o.getCurrentLibrary();if(1!=(Array.isArray(p)?p.length:0))break;var g=p[0];if(g&&s.inFamilyLibrary(g.plmType)&&r.getTreeCont().getView().isTreeNodeModelInstance(g))if(C.getID()==g.getID()){var b=r.getTreeCont();b&&b.switchLibraryTreeNodeLabelToWriteView&&b.switchLibraryTreeNodeLabelToWriteView(C)}else{var y=r.getContent();y&&y.switchLibraryTreeNodeLabelToWriteView&&y.switchLibraryTreeNodeLabelToWriteView(g)}else t._logger.log("Info : '"+a+"' key pressed but selected element is not a Library, no command launched")}}}});return d}),define("DS/ClassificationEditor/commands/ActionBar_ImportLibraryStructureCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/commands/LibraryCommands","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/PADUtils/PADUtilsServices"],function(e,t,i,r,a,n,o,s,l,c){"use strict";return t.extend({labelTopBar:e.i18n("Add Existing Classification Attributes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1}),this.importPanel=null},beginExecute:function(){},execute:function(){var e=this;require(["DS/PADServices/utils/GlobalModelEvents","DS/IPClassifyUXUtil/FileImportPanel","DS/ClassificationEditor/utils/Library_CSO"],function(t,n,c){var d=c.getCurrentLibrary(),u=t.getModelEvents();e.importPanel=new n({panelHeaderName:l.importLibraryPanelHeader,panelHeaderIcon:{iconName:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-import",fontIconFamily:WUXManagedFontIcons.Font3DS},modelEvents:u,validateFile:e.validateFile,downloadErrorReport:e.downloadErrorReport,closePanelEvent:"AddExistingAttributesCmd/Views/showInWidgetBody",importFileEvent:"ImportLibraryStructureXML/SelectedFileContent",validationInProgressMsg:l.validateLibrary_loading});var f=[];f.push(u.subscribe({event:"ImportLibraryStructureXML/SelectedFileContent"},function(t){t.isValidate||a._startProgressBar(l.importLibrary_loading),e.disable(),i.importLibraryStructure({fileContent:t.selectedFileContent,isValidate:!1,onComplete:function(i){var n=i?JSON.parse(i):void 0;if(n&&n.ErrorDescription){var c=n.ErrorDescription;n.MissingAttributes&&(e.downloadErrorReport(c,t.fileName,n.MissingAttributes),c=l.msg_importLibrary_failedSeeReport+" ImportLibrary_ErrorReport.txt"),r.displayNotification({message:l.msg_importLibrary_failed+c,className:"error"})}else{o.setAuthoringMode("authoring",l.msg_importLibrary_success);var u=s.getTreeCont().getView()._rootNodeLibraries;u.isExpanded()&&(s.getTreeCont().performOperationOnNode(u,"collapse"),s.getTreeCont().performOperationOnNode(u,"expand")),n&&n.LibraryMxID&&u.isSelected()&&s.getContent().loadContentAndSelect(d)}a._offProgressBar(),e.enable()},onFailure:function(t,i,n){var o=a.extractMyErrorMessage(t,i,n);r.displayNotification({message:l.msg_importLibrary_failed+o,className:"error"}),a._offProgressBar(),e.enable()},onTimeout:function(t,i){r.displayNotification({message:l.command_importLibrary+": "+l.msg_InfoAction_Timeout,className:"warning"}),a._offProgressBar(),e.enable()}})})),f.push(u.subscribe({event:"AddExistingAttributesCmd/Views/showInWidgetBody"},function(e){!0===e.restore&&f.forEach(function(e){u.unsubscribe(e)})}))})},validateFile:function(e){var t=this;return new Promise(function(r){var n={};i.importLibraryStructure({fileContent:e.selectedFileContent,isValidate:!0,onComplete:function(i){var a=i?JSON.parse(i):void 0;if(a&&a.ErrorDescription){var o=a.ErrorDescription;a.MissingAttributes&&(t.downloadErrorReport(o,e.fileName,a.MissingAttributes),o=l.msg_importLibrary_failedSeeReport+" ImportLibrary_ErrorReport.txt"),n.success=!1,n.message=l.msg_importLibrary_validationFailed+o}else n.success=!0,n.message=l.msg_importLibrary_validationSucess;r(n)},onFailure:function(e,t,i){var o=a.extractMyErrorMessage(e,t,i);n.success=!1,n.message=l.msg_importLibrary_validationFailed+o,r(n)}})})},downloadErrorReport:function(e,t,i){var r="#############################################\n\t".concat(l.msg_importLibrary_errorReportHeader).concat("\n#############################################\n-----------------------------------------------\n").concat(l.msg_importLibrary_errorReportFile).concat(t).concat("\n-----------------------------------------------\n").concat(l.msg_importLibrary_errorReportMsg).concat(e).concat(": \n");i.forEach(function(e){r=r.concat(e).concat("\n")}),c.downloadfile(r,"ImportLibrary_ErrorReport.txt","text/plain")},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ClassificationIconBar_CreateLibrary",["UWA/Core","DS/ApplicationFrame/Command","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/commands/LibraryCommands","DS/ApplicationFrame/CommandsManager","DS/PADUtils/PADProbes","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,r,a,n,o,s,l){"use strict";return t.extend({labelTopBar:e.i18n("Create New Library"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=require("DS/ClassificationEditor/service/LibraryServices"),t=require("DS/ClassificationEditor/utils/Library_CSO"),i=require("DS/IPClassifyUtil/IPClassifyAlert"),o=t.getCurrentLibrary();n._startProgressBar(l.CreateNewLibrary_loading),e.CreateNewLibrary({callbacks:{onComplete:function(e){n._offProgressBar(),e="string"==typeof e?JSON.parse(e):e,r.setAuthoringMode("authoring",l.replace(l.msg_info_libraryCreationSucess,{})),e.createdLibraryObj&&(a.getTreeCont().addNewNode({physicalid:e.createdLibraryObj.libraryPhysicalId,label:e.createdLibraryObj.libraryName,plmType:"RootLibrary",type:e.createdLibraryObj.libraryType,mxid:e.createdLibraryObj.libraryObjId,icons:[{iconName:"library"}]}),setTimeout(function(){a.getContent().loadContentAndSelect(o,e.createdLibraryObj.libraryPhysicalId,!1,!1,!0).then(function(e){})},100))},onFailure:function(e,t,r){n._offProgressBar();var a=n.extractMyErrorMessage(e,t,r);i.displayNotification({message:a?l.msg_error_createlibrary+"<br>"+a:l.msg_error_createlibrary,className:"error"})}}})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ActionBar_ExpandAllCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/LibraryCommands","DS/ClassificationEditor/utils/Library_CSO"],function(e,t,i,r){"use strict";return t.extend({labelTopBar:e.i18n("Expand All"),isInsert:!0,datas:{},init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=r.getSelectedNodes();if(e.length){var t=e[0];i.ExpandAllCmd(t,"CONTENT")}else{var a=r.getCurrentLibrary();i.ExpandAllCmd(a,"TREE")}},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ActionBar_ExportClassificationAttributes",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/commands/LibraryCommands","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,r,a,n){"use strict";return t.extend({labelTopBar:e.i18n("Export Classification Attributes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},execute:function(){var e=this;a._startProgressBar(n.msg_exportAttributes_loading),e.disable(),i.exportClassificationAttributes({onComplete:function(t){var i=document.createElement("a");i.href=window.URL.createObjectURL(t),i.download="ClassificationAttributesExport.zip",i.dispatchEvent(new MouseEvent("click")),a._offProgressBar(),e.enable()},onFailure:function(t,i,o){var s=n.exportFail;null!=t&&0!==t.length&&(s+=": "+t),r.displayNotification({message:s,className:"error"}),a._offProgressBar(),e.enable()}})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ActionBar_RemoveAttributesCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/LibraryCommands","DS/ClassificationEditor/service/ClassificationEditorWebService"],function(e,t,i,r){"use strict";return t.extend({labelTopBar:e.i18n("Remove Class Attributes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1}),require(["DS/ClassificationEditor/commands/LibraryCommands"],function(e){})},beginExecute:function(){},execute:function(){var t=this;require(["DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUXUtil/IPClassifyConfirmation","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/utils/ClassificationEditorcontrol","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(a,n,o,s,l){var c=a.getCurrentLibrary();if(c){var d=c.getID(),u=a.getCAChangeAccessOnClass(d);if(!u||"true,true"!==u&&"false,true"!==u)i._commonError("RemoveAttributes",l.command_removeAttribute+": ",l.error_noChangeAccessOnCA);else{var f=a.getSelectedNodes();if(f.length>0){var m=[],p=[];if(f.forEach(function(t){"Attribute"===t.plmType&&("Inherited"===t.options.origin||"UserAG"===t.options.origin?p.push(e.is(t.getLabel())?t.getLabel():t.id):(t.getLabel=(()=>t.options.grid.Name),m.push(e.is(t.options.grid.Name)?t.options.grid.Name:t.id)))}),m.length>0){var C=l.confirmation_remove_attributesSure;p.length>0&&(C=p.length<6?l.confirmation_remove_attributesPrefix+"<br>"+p+".<br><br>"+l.confirmation_remove_attributesSuffix:l.replace(l.confirmation_remove_attributesNumber,{number:p.length})),n.launch({title:l.command_removeAttribute,content:C,confirmLabel:l.CMDRemove},function(){i._startProgressBar(l.remove_attributes_loading),t.disable(),r.removeClassAttributes({pid:d,attributes:m,onComplete:function(e){var t={},r=JSON.parse(e),a=r?r.attributes:[];if(a&&a.length>0)for(var n=0;n<a.length;n++)t[a[n]]=!0;if(m.length>5)s.getContent().RefreshProductStructure=!0,s.getContent().loadContentAndSelect(c);else for(var d=0;d<m.length;d++){var u=m[d];t[u]||s.getContent()._libraryContentView.removeNodeInContent(u)}0===s.getContent()._libraryContentView.options.model.getAllDescendants().length&&s.getContent().getView()._addPlaceHolder(),i._offProgressBar(),a&&a.length>0?o.displayNotification({message:l.confirmation_remove_attributesPrefix+"<br>"+a,className:"error"}):o.displayNotification({message:l.replace(l.msg_info_attributeremoved,{number:m.length,libraryname:c.options.label}),className:"success"})},onFailure:function(e,r,a){var n=i.extractMyErrorMessage(e,r,a);i._offProgressBar(),t.enable(),i._commonError("RemoveAttributes",l.msg_error_removeClassAttributes,n)}})})}else{var g=l.msg_warning_noAttributeSelected;p.length>0&&(g=l.msg_remove_attributesNotPossibleHere+"\n"+l.msg_remove_attributesNotPossibleSuffix),o.displayNotification({message:g,className:"warning"})}}else o.displayNotification({message:l.msg_warning_noAttributeSelected,className:"warning"})}}else o.displayNotification({message:l.msg_warning_nocurrentlibrary,className:"warning"})})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ClassificationIconBar_RenameCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/LibraryCommands","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/utils/ClassificationEditorcontrol"],function(e,t,i,r,a){"use strict";return t.extend({labelTopBar:e.i18n("Rename"),datas:{},init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=r.getSelectedNodes(),t="",n={},o="";if(e[0].pathId){t="TREE";var s=(n=a.getTreeCont().getView()._libraries_TreeView).layout.getColumnIndex("tree");o=n.layout.getCellIDFromCoordinates({rowID:e[0]._rowID,columnID:s})}else{t="CONTENT";s=(n=a.getContent().getView().getPADTreeListView().getManager()).layout.getColumnIndex("tree");o=n.layout.getCellsFromNodeModel(e[0])[s]}var l=n.getCellInfosAt(o);l.manager||(l.manager=n),i.RenameCmd(l,t)},endExecute:function(){}})}),define("DS/ClassificationEditor/dataProvider/LibraryTreeDataProvider",["UWA/Class","UWA/Class/Promise","DS/ClassificationEditor/service/LibraryTypeService","DS/ClassificationEditor/utils/ClassificationEditorUtil","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/utils/ClassificationEditorDataConversion","DS/ClassificationEditor/commands/LibraryCommands","DS/WebappsUtils/WebappsUtils","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUtil/IPClassifyAlert"],function(e,t,i,r,a,n,o,s,l,c,d){"use strict";var u={FAVORITES:"ipcFavoriteList_v1",getFavorites:function(){return c.getTenantAwarePreferenceName(this.FAVORITES)}};return e.singleton({expandObject:function(e){return new t(function(t,i){a.libraries({pid:e.pid,mxid:e.mxid,children:e.children,isExpandAll:e.isExpandAll,isAuthoringMode:!c.isIndexedMode(),onComplete:function(i){i="string"==typeof i?JSON.parse(i):i;var r=n.getPathsAndObjectsFromExpand(i.results);if(null==r)t({paths:[],objects:[]});else if(r.paths&&r.paths.length<=0){var a=[];i.results&&(a=n.convertExpandToSearchFormat(e.pid,i.results));var o=[];for(var s in r.objects)r.objects.hasOwnProperty(s)&&s!==e.pid&&o.push(s);t({objects:function(e){var t=[];e&&e.length>0&&e.forEach(function(e){var i=n.convertToExaleadDataFormatFederated(e);i.icons=[{iconName:"library-class"}],i.plmType="Library",t.push(i)});return t}(a),childIds:o,paths:r.paths})}else{for(var s in r.objects)r.objects.hasOwnProperty(s)&&(r.objects[s].icons=[{iconName:"library-class"}],r.objects[s].plmType="Library");t({paths:r.paths,objects:r.objects})}},onFailure:function(e){i(e)}})})},getRootSectionContents:function(e){return new t(function(e,t){a.roots({fetchAll:!0,isAuthoringMode:!c.isIndexedMode(),onComplete:function(t){var i=(t="string"==typeof t?JSON.parse(t):t).results?t.results:[],r=[],a=[];i.forEach(function(e){var t=n.convertToExaleadDataFormatFederated(e);t.icons=[{iconName:"library"}],t.plmType="RootLibrary",a.push(t),r.push(t.physicalid)}),e({objects:a,ids:r,infos:t.infos})},onFailure:function(e){t(e)}})})},getObjectPathLength:function(e){return new t(function(t,i){a.getLibraryPathLength({ids:e.ids,onComplete:function(e){if(e.results){var r=n.getLibraryDepth(e);t(r)}else d.displayNotification({message:l.msg_error_BOdeleted,className:"error"}),i()},onFailure:function(e){that._logger.log("WebService getObjectPathLength Err : "+e),i(e)}})})},getObjectPath:function(e){return new t(function(t,i){a.getLibraryPath({depth:e.depth,pid:e.pid,isAuthoringMode:!c.isIndexedMode(),onComplete:function(i){var r=n.convertNavigateToFlatFormat(e.depth,i.result);t(r)},onFailure:function(e){that._logger.log("WebService getObjectPath Err : "+e),i(e)}})})},getPreferenceSectionContents:function(e){return new t(function(t,r){a.favourites({ids:e.ids,onComplete:function(e){for(var r=(e="string"==typeof e?JSON.parse(e):e).results?e.results:[],a=[],o=0;o<r.length;++o){var s=i.getPlmTypeFromContentDetails(r[o].attributes),l=n.convertToExaleadDataFormatFederated(r[o]);l.plmType=s,"RootLibrary"===l.plmType?l.icons=[{iconName:"library"}]:l.icons=[{iconName:"library-class"}],a.push(l)}t(a)},onFailure:function(e){r(e)}})})},comparator:function(e,t){var i,r="LibrarySection_favorite"===e.getParent().plmType;if(r)return null;if(e.isRoot()&&t.isRoot()||r)return null;if("date"!==widget.getValue("sortMode"))return e.options.label.localeCompare(t.options.label);try{i=new Date(e.options.created)>new Date(t.options.created)?1:new Date(e.options.created)<new Date(t.options.created)?-1:0}catch(r){i=e.options.created<t.options.created?-1:1}finally{return i}},shouldBeEditable:function(e){return r.shouldBeEditable(e)},getContextualMenu:function(e){return o.GetContextualMenu(e,"TREE")},onContentUpdate:function(e){return r.onNodeModelUpdate(e)},isValidType:function(e){return i.inFamilyLibrary(e)},isSection:function(e){return"LibrarySection_favorite"==e||"LibrarySection_AllLibraries"==e},isTreeNodeEditable:function(e){if(e&&e.nodeModel){var t=e.nodeModel.plmType;return!("LibrarySection_favorite"==t||"LibrarySection_AllLibraries"==t)}return!1},isPreferenceSection:function(e){return"LibrarySection_favorite"==e},getSectionsData:function(){var e=[],t={};t.label=l.name_Section_FavoriteLibraries,t.icon=s.getWebappsAssetUrl("ClassificationEditor","icons/libraryfavorites.png"),t.plmType="LibrarySection_favorite",e.push(t);var i={};return i.label=l.name_Section_AllLibraries,i.icon=s.getWebappsAssetUrl("ClassificationEditor","icons/librarysectionall.png"),i.plmType="LibrarySection_AllLibraries",i.defaultSelectedSection=!0,e.push(i),e},getPreferenceSectionName:function(){return u.getFavorites()},getSecurityContextAndData:function(){return r.getCurrentSecurityContextAndLibraryData()},getObjectNotVisiblemessage:function(){return l.msg_error_NoVisibleRootLibrary},isDNDSupported:function(){return!0},isRoot:function(e){return!(!e||!e.flattenedtaxonomies||"types/Libraries"!==e.flattenedtaxonomies[0]||"types/General Library"!==e.flattenedtaxonomies[1])}})}),define("DS/ClassificationEditor/commands/ActionBar_ExportLibraryStructureCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/commands/LibraryCommands","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/PADUtils/PADUtilsServices"],function(e,t,i,r,a,n,o){"use strict";return t.extend({labelTopBar:e.i18n("Add Existing Classification Attributes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},execute:function(){var e=this;require(["DS/ClassificationEditor/utils/Library_CSO"],function(t){var s,l,c,d="No Library Selected",u=!1;if(t.getCurrentLibrary()&&(s=(l=t.getCurrentLibrary()).getID(),d=l.getLabel(),c=l.plmType||l.getType()),"RootLibrary"===c)u=!0;else if("LibrarySection_AllLibraries"==c||"LibrarySection_favorite"==c){var f=t.getSelectedNodes(),m=f.length;if(1===m&&"RootLibrary"===f[0].plmType)u=!0,s=f[0].id,d=f[0].getLabel();else{var p=n.msg_exportLibrary_selectLib;m>1&&(p=n.msg_exportLibrary_selectOneLib),r.displayNotification({message:p,className:"warning"})}}else r.displayNotification({message:n.msg_exportLibrary_selectLib,className:"warning"});u&&(a._startProgressBar(n.msg_exportLibrary_loading+d),e.disable(),i.exportLibraryStructure({pid:s,onComplete:function(t,i,s,l){var c=t?JSON.parse(t):void 0;c&&c.fileContent?o.downloadfile(c.fileContent,c.fileName,"text/xml"):r.displayNotification({message:n.replace(n.msg_exportLibrary_failed,{libraryname:d}),className:"error"}),a._offProgressBar(),e.enable()},onFailure:function(t,i,o){var s=n.replace(n.msg_exportLibrary_failed,{libraryname:d});i&&"User doesnt have Librarian Role"===i&&(s=n.replace(n.error_exportLibrary,{libraryname:d})+"<br>"+n.error_no_LibrarianRole),r.displayNotification({message:s,className:"error"}),a._offProgressBar(),e.enable()}}))})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ClassificationCommandsIconBar",["UWA/Core","UWA/Class/View","DS/UIKIT/Iconbar","DS/ApplicationFrame/CommandsManager","DS/ClassificationEditor/service/LibraryTypeService","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/utils/ClassificationEditorUtil","DS/ClassificationEditor/utils/Library_CSO","DS/WidgetServices/WidgetServices","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,r,a,n,o,s,l,c){"use strict";var d="fonticon fonticon-wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-tree-expand-down",u="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-tree-expand-down",f="fonticon fonticon-wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-tree-expand-down-cog",m="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-tree-expand-down-cog",p="fonticon fonticon-wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-tree-expand-up",C="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-tree-expand-up",g="fonticon fonticon-wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-cascade",b="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-cascade",y="fonticon fonticon-wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-cascade-wrong-2",v="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-cascade-wrong-2",h="fonticon fonticon-wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-cascade-wrong-1",_="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-cascade-wrong-1";return t.extend({name:"DS/ClassificationEditor/commands/ClassiificationCommandsIconBar",_iconBar:null,disabledCommands:[],selectedTab:null,commandsList_inGeneral:{createNewLibrary:{fonticon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-library-add",text:c.command_createNewLibrary,name:"createNewLibrary",handler:function(e,t){var i=r.getCommand("CreateNewLibrary",n.getContent());i&&i.begin()}},exportAttributes:{fonticon:"export-multiple",text:c.command_exportAttributes,name:"exportAttributes",handler:function(e,t){var i=r.getCommand("ExportAttributes",n.getContent());i&&i.begin()}},exportLibrary:{fonticon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-export",text:c.command_exportLibrary,name:"exportLibrary",handler:function(e,t){var i=r.getCommand("ExportLibrary",n.getContent());i&&i.begin()}},importLibrary:{fonticon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-import",text:c.command_importLibrary,name:"importLibrary",handler:function(e,t){var i=r.getCommand("ImportLibrary",n.getContent());i&&i.begin()}},createNewClass:{fonticon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-library-class-add",text:c.command_createNewClass,name:"createNewClass",handler:function(e,t){var i=r.getCommand("CreateNewClass",n.getContent());i&&i.begin()}},deleteGeneric:{fonticon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-trash",text:c.command_deleteGeneric,name:"deleteGeneric",handler:function(e,t){var i=s.getSelectedNodes()[0].getType(),a=null;"RootLibrary"===i?a=r.getCommand("DeleteLibrary",n.getContent()):"Library"===i&&(a=r.getCommand("DeleteClass",n.getContent())),a&&a.begin()}},addRemoveFavs:{fonticon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-favorite-on",text:c.command_addRemoveFavs,name:"addRemoveFavorites",handler:function(t,i){var r=s.getCurrentLibrary(),o=r.getID(),l=r.getType(),c=r.options.label;0==n.getTreeCont().isLibraryAmongFavoriteLibraries(o)?r&&o&&a.inFamilyLibrary(l)&&e.is(n.getTreeCont())&&n.getTreeCont().addFavorite({id:o,name:c}):r&&o&&a.inFamilyLibrary(l)&&e.is(n.getTreeCont())&&n.getTreeCont().removeFavorite({id:o,name:c})}},properties:{fonticon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-attributes",text:c.command_properties,name:"properties",handler:function(e,t){var i=r.getCommand("ActionBar_Attributes",n.getContent());i&&i.begin()}},changeMaturity:{fonticon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-collaborative-lifecycle-management",text:c.command_changeMaturity,name:"changeMaturity",handler:function(e,t){var i=r.getCommand("MaturityHdr",n.getContent());i&&i.begin()}},shareMOA:{fonticon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-topbar-share",text:c.command_shareMOA,name:"shareMOA",handler:function(e,t){var i=r.getCommand("ActionBar_AccessRightCmd",n.getContent());i&&i.begin()}},moveClass:{fonticon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-move-to",text:c.command_moveClass,name:"moveClass",handler:function(e,t){var i=r.getCommand("MoveClass",n.getContent());i&&i.begin()}}},commandsList_AttributesTab:{addExistingAttribute:{fonticon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-attributes-add",text:c.command_addExistingAttribute,name:"addExistingAttribute",handler:function(e,t){var i=r.getCommand("AddExistingAttributes",n.getContent());i&&i.begin()}},removeAttribute:{fonticon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-remove",text:c.command_removeAttribute,name:"removeAttribute",handler:function(e,t){var i=r.getCommand("RemoveAttributes",n.getContent());i&&i.begin()}}},setup:function(e){this._parent(e),this._iconBar=null},render:function(e,t,r,a,n,s){return this.selectedTab=a,this._iconBar=new i({renderTo:this.container,items:[]}),this._iconBar.addItem({className:"divider"}),a?a===o.CONTENT_TABS.CLASSES?(this._iconBar.addItem(this.commandsList_inGeneral.createNewLibrary),this._iconBar.addItem(this.commandsList_inGeneral.createNewClass),this._iconBar.addItem(this.commandsList_inGeneral.deleteGeneric),this._iconBar.addItem(this.commandsList_inGeneral.addRemoveFavs),this._iconBar.addItem(this.commandsList_inGeneral.properties),this._iconBar.addItem(this.commandsList_inGeneral.changeMaturity),this._iconBar.addItem(this.commandsList_inGeneral.shareMOA),this.addCommandsToList()):a===o.CONTENT_TABS.CLASSIFICATION_ATTRIBUTES&&(this._iconBar.addItem(this.commandsList_AttributesTab.addExistingAttribute),this._iconBar.addItem(this.commandsList_AttributesTab.removeAttribute)):(this._iconBar.addItem(this.commandsList_inGeneral.createNewLibrary),this._iconBar.addItem(this.commandsList_inGeneral.createNewClass),this._iconBar.addItem(this.commandsList_inGeneral.deleteGeneric),this._iconBar.addItem(this.commandsList_inGeneral.addRemoveFavs),this._iconBar.addItem(this.commandsList_inGeneral.properties),this._iconBar.addItem(this.commandsList_inGeneral.changeMaturity),this._iconBar.addItem(this.commandsList_inGeneral.shareMOA),this.addCommandsToList()),this._iconBar.addItem({className:"divider"}),a&&a===o.CONTENT_TABS.CLASSIFICATION_ATTRIBUTES||this.addMoreActionsCommandsList(),this.updateCommandVisibilityInIconBar(e,t,r,n,s),this},addMoreActionsCommandsList:function(){this.commandsList_inGeneral.moreActionsMenu={fonticon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-menu-dot",text:c.menu_moreActions,name:"moreActions",content:{type:"dropdownmenu",options:{multiSelect:!1,items:[this.commandsList_inGeneral.exportLibrary,this.commandsList_inGeneral.importLibrary,this.commandsList_inGeneral.moveClass]}}},this._iconBar.addItem(this.commandsList_inGeneral.moreActionsMenu)},addCommandsToList:function(){var e=this;e.commandsList_inGeneral.expandAndClps={fonticon:u,text:c.command_expandAll,name:"expandAndCollapse",content:{type:"dropdownmenu",options:{multiSelect:!1,items:[{fonticon:u,text:c.command_expandAll,name:"expandAll",selectable:!0,selected:!0,handler:function(){var t=e._iconBar.getItem("expandAndCollapse");e.setExpandClpsCmdsIcon(t,"expandAll");var i=r.getCommand("ExpandAll",n.getContent());i&&i.begin()}},{fonticon:m,text:c.command_expandNLevels,name:"expandNLevels",selectable:!0,selected:!1,handler:function(){var t=e._iconBar.getItem("expandAndCollapse");e.setExpandClpsCmdsIcon(t,"expandNLevels");var i=r.getCommand("ExpandN",n.getContent());i&&i.begin()}},{fonticon:C,text:c.command_collapseAll,name:"collapseAll",selectable:!0,selected:!1,handler:function(){var t=e._iconBar.getItem("expandAndCollapse");e.setExpandClpsCmdsIcon(t,"collapseAll");var i=r.getCommand("CollapseAll",n.getContent());i&&i.begin()}}]}}},e.commandsList_inGeneral.selectionCmd={fonticon:b,text:c.command_selectAllVisible,name:"selections",content:{type:"dropdownmenu",options:{multiSelect:!1,items:[{fonticon:b,text:c.command_selectAllVisible,name:"selectAllVisible",selectable:!0,selected:!0,handler:function(){var t=e._iconBar.getItem("selections");e.setSelectionCmdsIcon(t,"selectAllVisible");var i=r.getCommand("SelectAll",n.getContent());i&&i.begin()}},{fonticon:v,text:c.command_selectInversion,name:"selectInversion",selectable:!0,selected:!1,handler:function(){var t=e._iconBar.getItem("selections");e.setSelectionCmdsIcon(t,"selectInversion");var i=r.getCommand("SelectInversion",n.getContent());i&&i.begin()}},{fonticon:_,text:c.command_selectSiblings,name:"selectSiblings",selectable:!0,selected:!1,handler:function(){var t=e._iconBar.getItem("selections");e.setSelectionCmdsIcon(t,"selectSiblings");var i=r.getCommand("SelectSiblings",n.getContent());i&&i.begin()}}]}}},e._iconBar.addItem(e.commandsList_inGeneral.expandAndClps),e._iconBar.addItem(e.commandsList_inGeneral.selectionCmd),e._iconBar.addItem(e.commandsList_inGeneral.exportAttributes)},updateCommandVisibilityInIconBar:function(e,t,i,r,n){var l,c=this;function d(e){c._iconBar.disableItem(e),c.disabledCommands.push(e)}function u(e){try{c._iconBar.overflowMenu&&c._iconBar.overflowMenu.disableItem(e);var t=c._iconBar.menu.getItem("moreActions");if(t.content)if(t.content.component)t.content.component.menus[0].updateItem({id:e,disabled:!0});else for(var i=t.content.options.items,r=0;r<i.length;r++)if(i[r].name===e){i[r].disabled=!0;break}}catch(e){console.log(e)}}if(c.enableCommands(),void 0===e&&(e=s.getCurrentLibrary()),void 0===t&&(t="TREE"),void 0===i&&(i=s.getCurrentLibrary()),"TREE"===t)a.inFamilyLibrary(e.plmType)?"RootLibrary"===e.plmType?(d("createNewLibrary"),u("moveClass")):"Library"===e.plmType&&(c.selectedTab?c.selectedTab===o.CONTENT_TABS.CLASSES?(d("createNewLibrary"),u("exportLibrary")):c.selectedTab===o.CONTENT_TABS.CLASSIFICATION_ATTRIBUTES&&d("removeAttribute"):(d("createNewLibrary"),u("exportLibrary"))):"LibrarySection_favorite"==e.plmType?(d("createNewLibrary"),u("exportLibrary"),u("moveClass"),d("createNewClass"),d("deleteGeneric"),d("addRemoveFavorites"),d("properties"),d("changeMaturity"),d("shareMOA")):"LibrarySection_AllLibraries"==e.plmType&&(d("createNewClass"),u("exportLibrary"),u("moveClass"),d("deleteGeneric"),d("addRemoveFavorites"),d("properties"),d("changeMaturity"),d("shareMOA"));else if("CONTENT"===t){var f=i.plmType;if(a.inFamilyLibrary(f)){if("RootLibrary"===e.plmType)n>1&&(d("changeMaturity"),d("shareMOA")),d("createNewLibrary"),d("createNewClass");else if("Library"===e.plmType)n>1&&(d("deleteGeneric"),d("changeMaturity"),d("shareMOA"),u("moveClass")),d("createNewLibrary"),u("exportLibrary"),d("createNewClass");else if("Attribute"===e.plmType){var m;d("addExistingAttribute"),r.forEach(function(e){"ClassOwned"===e.options.origin&&(m=!0)}),m?(l="removeAttribute",c._iconBar.enableItem(l)):d("removeAttribute")}d("expandAndCollapse")}else"LibrarySection_AllLibraries"==f?(d("createNewLibrary"),n>1&&(d("deleteGeneric"),d("changeMaturity"),d("shareMOA"),u("exportLibrary")),u("moveClass"),d("createNewClass"),d("addRemoveFavorites"),d("expandAndCollapse")):"LibrarySection_favorite"==f&&((n>1||!r||!r[0]||"RootLibrary"!==r[0].plmType)&&u("exportLibrary"),d("createNewLibrary"),d("createNewClass"),d("deleteGeneric"),u("moveClass"),d("addRemoveFavorites"),d("shareMOA"))}c._iconBar.show()},setExpandClpsCmdsIcon:function(e,t){var i=e.elements.icon,r=e.tooltip;"expandAll"===t?(i.hasClassName(f)?i.removeClassName(f).addClassName(d):i.hasClassName(p)&&i.removeClassName(p).addClassName(d),e.fonticon=u,e.text=c.command_expandAll,r.setBody(c.command_expandAll)):"expandNLevels"===t?(i.hasClassName(d)?i.removeClassName(d).addClassName(f):i.hasClassName(p)&&i.removeClassName(p).addClassName(f),e.fonticon=m,e.text=c.command_expandNLevels,r.setBody(c.command_expandNLevels)):"collapseAll"===t&&(i.hasClassName(d)?i.removeClassName(d).addClassName(p):i.hasClassName(f)&&i.removeClassName(f).addClassName(p),e.fonticon=C,e.text=c.command_collapseAll,r.setBody(c.command_collapseAll))},setSelectionCmdsIcon:function(e,t){var i=e.elements.icon,r=e.tooltip;"selectAllVisible"===t?(i.hasClassName(y)?i.removeClassName(y).addClassName(g):i.hasClassName(h)&&i.removeClassName(h).addClassName(g),e.fonticon=b,e.text=c.command_selectAllVisible,r.setBody(c.command_selectAllVisible)):"selectInversion"===t?(i.hasClassName(g)?i.removeClassName(g).addClassName(y):i.hasClassName(h)&&i.removeClassName(h).addClassName(y),e.fonticon=v,e.text=c.command_selectInversion,r.setBody(c.command_selectInversion)):"selectSiblings"===t&&(i.hasClassName(g)?i.removeClassName(g).addClassName(h):i.hasClassName(y)&&i.removeClassName(y).addClassName(h),e.fonticon=_,e.text=c.command_selectSiblings,r.setBody(c.command_selectSiblings))},enableCommands:function(){for(var e=this,t=0;t<e.disabledCommands.length;t++)e._iconBar.enableItem(e.disabledCommands[t]);try{var i=e._iconBar.menu.getItem("moreActions");if(i.content)if(i.content.component)["exportLibrary"].forEach(function(e){i.content.component.menus[0].updateItem({id:e,disabled:!1})}),["moveClass"].forEach(function(e){i.content.component.menus[0].updateItem({id:e,disabled:!1})});else for(var r=i.content.options.items,a=0;a<r.length;a++)r[a].disabled=!1;["exportLibrary"].forEach(function(t){e._iconBar.overflowMenu&&e._iconBar.overflowMenu.enableItem(t)}),["moveClass"].forEach(function(t){e._iconBar.overflowMenu&&e._iconBar.overflowMenu.enableItem(t)})}catch(e){console.log(e)}}})}),define("DS/ClassificationEditor/dataProvider/ClassificationCommandsIconBarProvider",["UWA/Class","DS/ClassificationEditor/commands/ClassificationCommandsIconBar"],function(e,t){"use strict";return e.singleton({getCommandsIconBar:function(){return new(require("DS/ClassificationEditor/commands/ClassificationCommandsIconBar"))}})}),define("DS/ClassificationEditor/dataProvider/ClassAttributesDataProvider",["UWA/Class","UWA/Class/Promise","DS/ClassificationEditor/service/ClassificationEditorWebService","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/IPClassifyUtil/IPClassifyAlert","DS/WebappsUtils/WebappsUtils"],function(e,t,i,r,a,n){"use strict";return e.singleton({hasLibrarianRole:function(){return new t(function(e,t){i.hasLibrarianRole({onComplete:function(t){e({readOnly:JSON.parse(t).showAttachmentsTabCommands.readOnly,isLeader:JSON.parse(t).rolesInfo.isLeader,isOwner:JSON.parse(t).rolesInfo.isOwner})},onFailure:function(){t({readOnly:!0,isLeader:!0,isOwner:!1})}})})},fetchTheObjects:function(){return new t(function(e){i.fetchAllTheClassificationAttributes({onComplete:function(t){var i=JSON.parse(t).attribute||[],r=n.getWebappsAssetUrl("ClassificationEditor","icons/attributes.png"),a=[];i.forEach(function(e){var t="",i="",n="",o="string"==typeof o?JSON.parse(e.range):e.range;o&&o.length>0&&(o.forEach(function(e){if("between"==e.operator){var r=e.value.split(" ");t=r[0],i=r[2]}else n+=","+e.value}),n.length>0&&(n=n.substring(n.indexOf(",")+1))),a.push({label:e.name,icons:[r],grid:{attrName:e.name,attrTitle:e.nls_label,attrDesc:e.description,attrKind:e.nls_type,attrDefault:e.default,attrHasDefault:e.nls_hasDefault,attrDim:e.manipulationUnit&&e.manipulationUnit.length>0?e.nls_dimension+"("+e.manipulationUnit+")":e.nls_dimension,attrPredi:e.nls_predicate,attrAuthorizedValues:n,attrMinimum:t,attrMaximum:i,attrIsMultivalue:e.valuetype&&"multival"==e.valuetype?"True":"False",attrIsParametric:e.nls_isParametric,attrIsInDico:e.isInDico,attrSel:!1}})}),e({objectsList:a})},onFailure:function(t,i,n){var o=r.get("msg_classificationattributes_webservicefailed");i&&"User doesnt have Librarian Role"===i&&(o=o+": <br>"+r.error_no_LibrarianRole),a.displayNotification({message:o,className:"error"}),e({})}})})},fetchPlaceHolder:function(){return r.classAttributesPanel_Placeholder},initialSortModel:function(){return[{dataIndex:"attrTitle",sort:"asc"}]},searchMatchCriteria:function(e,t){var i=!1,r=new RegExp(e,"i");return(r.test(t.nodeModel.options.grid.attrTitle)||r.test(t.nodeModel.getLabel())||r.test(t.nodeModel.options.grid.attrKind)||r.test(t.nodeModel.options.grid.attrDim))&&(i=!0),i},fetchColumns:function(){return{checkBoxColumn:"attrSel",objectIdentifier:"attrName",columns:[{icon:{iconName:"check",fontIconFamily:1},dataIndex:"attrSel",pinned:"left",typeRepresentation:"boolean",alwaysVisibleFlag:!0,width:40,resizableFlag:!1,editableFlag:!0,editionPolicy:"EditionInPlace",getCellEditableState:function(e){return e.nodeModel,!0}},{dataIndex:"tree",text:r.column_ActualName||"Name",tooltip:r.column_ActualName||"Actual Name"},{dataIndex:"attrTitle",text:r.column_DisplayName||"Display Name",tooltip:r.column_DisplayName||"Display Name",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrKind",text:r.column_Type||"Type",tooltip:r.column_Type||"Type",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrDesc",text:r.column_Description||"Description",tooltip:r.column_Description||"Description",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrDefault",text:r.column_DefaultValue||"Default Value",tooltip:r.column_DefaultValue||"Default Value",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrHasDefault",text:r.hasDefault||"Has Default",tooltip:r.hasDefault||"Has Default",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrDim",text:r.column_Dimensions||"Dimension",tooltip:r.column_Dimensions||"Dimension",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrPredi",text:r.column_Predicates||"Predicate",tooltip:r.column_Predicates||"Predicate",editableFlag:!1,sortableFlag:!0,resizableFlag:!1},{dataIndex:"attrAuthorizedValues",text:r.column_Authorized_Values||"Authorized Values",tooltip:r.column_Authorized_Values||"Authorized Values",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrIsParametric",text:r.column_Is_Parametric||"Is Parametric",tooltip:r.column_Is_Parametric||"Is Parametric",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrIsMultivalue",text:r.column_Is_Multivalue||"Is Multivalue",tooltip:r.column_Is_Multivalue||"Is Multivalue",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrMinimum",text:r.column_Minimum||"Minimum",tooltip:r.column_Minimum||"Minimum",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrMaximum",text:r.column_Maximum||"Maximum",tooltip:r.column_Maximum||"Maximum",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrIsInDico",text:r.existInDictionary,tooltip:r.existInDictionary,editableFlag:!1,sortableFlag:!1,resizableFlag:!0}]}}})}),define("DS/ClassificationEditor/commands/ActionBar_AddExistingAttributesCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/dataProvider/ClassAttributesDataProvider","DS/ClassificationEditor/commands/LibraryCommands","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/IPClassificationAttributes/CreateNewAttributes"],function(e,t,i,r,a,n,o,s,l){"use strict";var c=!1,d=!1;return t.extend({labelTopBar:e.i18n("Add Existing Classification Attributes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1}),this.attributesPanel=null,n.hasLibrarianRole().then(function(e){e="string"==typeof e?JSON.parse(e):e,c=e.isLeader,d=e.readOnly})},beginExecute:function(){},execute:function(){var e=this;require(["DS/PADServices/utils/GlobalModelEvents","DS/PADUtils/PADContext","DS/IPClassifyUXUtil/ObjectsSelectionPanel","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/utils/ClassificationEditorcontrol"],function(t,u,f,m,p){var C=m.getCAChangeAccessOnClass(m.getCurrentLibraryID());if(!C||"true,true"!==C&&"true,false"!==C)o._commonError("AddExistingAttributes",s.command_addExistingAttribute+": ",s.error_noChangeAccessOnCA);else{var g,b,y=u.get(),v="No Class Selected";m.getCurrentLibrary()&&(b=m.getCurrentLibrary(),g=b.getID(),v=b.getLabel());var h=[];try{h=p.getContent()._libraryContentView.getPADTreeDocument().getRoots()}catch(e){}var _={};if(h.forEach(function(e){_[e.options.grid.Name]=!0}),y.options.views?y.options.views.datagridview:void 0){var S=t.getModelEvents();e.attributesPanel=new f({panelHeader:s.command_addExistingAttribute+" - "+v,okButtonLabel:s.classAttributesPanel_okButtonLabel,cancelButtonLabel:s.classAttributesPanel_cancelButtonLabel,okEventName:"AddExistingClassificationAttributes/selectedAttributes",cancelOrCloseEventName:"AddExistingAttributesCmd/Views/showInWidgetBody",modelEvents:S,objectsToSkip:_,dataProvider:n,newAttributeUI:l,isLeader:c,isReadOnly:d});var E=[];E.push(S.subscribe({event:"AddExistingClassificationAttributes/selectedAttributes"},function(t){o._startProgressBar(s.command_addExistingAttribute),e.disable(),i.addClassAttributes({pid:g,attributes:t.selectedObjects,onComplete:function(i){var n=i?JSON.parse(i):void 0;if(n&&n.error){var l=n.error;r.displayNotification({message:s.msg_addclassificationattributes_failed+l,className:"error"})}else r.displayNotification({message:s.replace(s.msg_addclassificationattributes_success,{number:t.selectedObjects.length,libraryname:v}),className:"success"}),a.getContent().loadContentAndSelect(b);o._offProgressBar(),e.enable()},onFailure:function(t,i,r){var a=o.extractMyErrorMessage(t,i,r);o._offProgressBar(),e.enable(),o._commonError("AddExistingAttributes",s.msg_addclassificationattributes_failed,a)}}),E.forEach(function(e){S.unsubscribe(e)})})),E.push(S.subscribe({event:"AddExistingAttributesCmd/Views/showInWidgetBody"},function(e){!0===e.restore&&E.forEach(function(e){S.unsubscribe(e)})}))}}})},endExecute:function(){}})}),define("DS/ClassificationEditor/dataProvider/LibraryDnDServiceProvider",["UWA/Class","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/commands/LibraryCommands","DS/ClassificationEditor/service/LibraryServices","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/IPClassifyUXUtil/IPClassifyConfirmation","DS/IPClassifyUXUtil/IPClassifyConfirmationWthCheckBx","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,r,a,n,o,s,l,c,d,u){"use strict";return e.singleton({shouldAcceptDrag:function(){var e=!0,t=n.getSelectedNodes();if(1==t.length){for(var i=0;i<t.length;++i)if("Library"!==t[i].plmType){e=!1;break}}else e=!1;return e},shouldAcceptDrop:function(e){var t=!1;return e||(e=n.getCurrentLibrary()),"LibrarySection_AllLibraries"===e.plmType&&"LibrarySection_Favorites"===e.plmType||!o.inFamilyLibrary(e.plmType)||(t=!0),t},addContentInObject:function(e,i,r,a){t.displayNotification({message:u.msg_warning_dndnotsupported,className:"warning"})},addClassesInLibrary:function(e,s,f,m,p){if(e&&e.plmType&&o.inFamilyLibrary(e.plmType)&&f){var C=f;if(C.length<1)return void console.warn("  Error in LibraryDnDServiceProvider.addClassesInLibrary, lContentId list is empty");if(e.id===s)return i._offProgressBar(),void t.displayNotification({message:u.msg_error_MoveInSamelibrary,className:"error"});for(var g=0;g<C.length;g++){var b=C[g];if(e.id===b)return i._offProgressBar(),void t.displayNotification({message:u.msg_error_MoveInSamelibrary,className:"error"})}var y=p,v=n.getCurrentLibrary();if("LibrarySection_favorite"===v.getType())return i._offProgressBar(),void t.displayNotification({message:u.msg_warning_dndnotsupported,className:"warning"});v.getID()===f[0]&&(v=v.getParent());var h=n.getSelectedNodes(),_=e&&o.inFamilyLibrary(e.plmType)?e:null;function S(e,a,n){r.MoveClass({IDs:e,targetLibrary:a,carryOverAttributeGroups:n,callbacks:{onComplete:function(e){E(e)},onFailure:function(e,r,a){i._offProgressBar();var n=i.extractMyErrorMessage(e,r,a);t.displayNotification({message:n?u.msg_error_moveClass+"<br>"+n:u.msg_error_moveClass,className:"error"})}}})}function E(e){i._offProgressBar();var t=u.replace(u.msg_info_classesmoved,{number:T,libraryname:_._options.label});1===w&&(t=u.replace(u.msg_info_classmoved,{classmovedname:h[0]._options.label,libraryname:_._options.label})),l.setAuthoringMode("authoring",t),a.getContent().loadContentAndSelect(v),v.isExpanded()&&(a.getTreeCont().performOperationOnNode(v,"collapse"),a.getTreeCont().performOperationOnNode(v,"expand")),y?(_=a.getTreeCont()._getNodesById(_.id)[0]).isExpanded()&&(a.getTreeCont().performOperationOnNode(_,"collapse"),a.getTreeCont().performOperationOnNode(_,"expand")):_.isExpanded()&&(a.getTreeCont().performOperationOnNode(_,"collapse"),a.getTreeCont().performOperationOnNode(_,"expand"))}if(_||(_=n.getCurrentLibrary()),!h)return;var A=[],L=[],D=[],x=[],w=h.length;w>0?h.forEach(function(e){A.push(UWA.is(e.id)?e.id:e.options.resourceid),o.isLibrary(e.plmType)?(L.push(UWA.is(e.id)?e.id:e.options.resourceid),D.push(e)):o.isRootLibrary(e.plmType)?"RootLibrary"===e.plmType&&L.push(UWA.is(e.id)?e.id:e.options.resourceid):x.push(UWA.is(e.id)?e.id:e.options.resourceid)}):(A.push(h),"Library"==node.plmType?(L.push(h.id),D.push(h)):o.isRootLibrary(node.plmType)||x.push(h.id));var T=L.length;_?L.length>0&&(!function(e,t,i,r){if(i.id!=t.id){if("MOVE_CLASS"===e&&!o.isRootLibrary(t.plmType)&&UWA.is(r,"array")&&1===r.length&&r[0]===t){var a=t.getParent();if(a&&a.id===i.id)return!1}return!0}}("MOVE_CLASS",v,_,h)?(i._offProgressBar(),t.displayNotification({message:u.msg_error_MoveInSamelibrary,className:"error"})):"RootLibrary"===v.plmType?c.launch({title:u.confirmation_move_title+" - "+h[0].getLabel(),content:u.replace(u.confirmation_move_message,{parentlibrary:_.getLabel()}),confirmLabel:u.confirmMoveYes,cancelLabel:u.confirmMoveNo},function(){i._startProgressBar(u.Move_Class_loading),S(L,_,!1)},null,function(){i._offProgressBar()}):"Library"===v.plmType&&r.MoveClass({IDs:L,targetLibrary:_,carryOverAttributeGroups:"",callbacks:{onComplete:function(e){JSON.parse(e).hasInheritedAttributes?d.launch({title:u.confirmation_move_title+" "+h[0].getLabel(),confirmLabel:u.confirmMoveYes,cancelLabel:u.confirmMoveNo,mainDivContent:{divHeaderShow:u._class+h[0].getLabel()+u.moveClassAttributesLostMsg_Part1+v.getLabel(),divFooterHide:u.moveClassAttributesLostMsg_Part2+JSON.parse(e).noOfClassifiedItemsAffected+u.moveClassAttributesLostMsg_Part3,checkBoxParams:{label:u.includeInheritedAttributes}}},function(){i._startProgressBar(u.Move_Class_loading),d.getChkBoxCheckedFlag()?S(L,_,!0):S(L,_,!1)},null,function(){i._offProgressBar()}):c.launch({title:u.confirmation_move_title+" "+h[0].getLabel(),content:u.replace(u.confirmation_move_message,{parentlibrary:_.getLabel()}),confirmLabel:u.confirmMoveYes,cancelLabel:u.confirmMoveNo},function(){i._startProgressBar(u.Move_Class_loading),S(L,_,!1)},null,function(){i._offProgressBar()})},onFailure:function(e,r,a){i._offProgressBar();var n=i.extractMyErrorMessage(e,r,a);t.displayNotification({message:n?u.msg_error_moveClass+"<br>"+n:u.msg_error_moveClass,className:"error"})}}})):(i._offProgressBar(),t.displayNotification({message:u.msg_warning_nocurrentlibrary,className:"warning"}))}},getDroppedData:function(e){var t=[],i=[],r=[];if(e&&e.data&&e.data.items&&Array.isArray(e.data.items)){for(var a=0;a<e.data.items.length;a++){var n=e.data.items[a],s=n.objectId,l=n.objectType_Internal;if(l||(l=n.objectType),Array.isArray(l)){for(var c=l.length,d=c>0?l[c-1]:void 0,u=0;u<c;++u)if(o.inFamilyLibrary(l[u])){d=l[u];break}l=d}var f=n.displayName;f||(f=l),f||(f=s);var m={droppedItem_id:s,droppedItem_type:l,droppedItem_name:f,droppedSourceLibrary_id:n.libraryId,droppedItem_tenantId:n.envId};o.isRootLibrary(l)?t.push(m):o.isLibrary(l)?i.push(m):r.push(m)}var p={};return p.RootLibrary_itemList=t,p.Library_itemList=i,p.Content_itemList=r,p}},inFamilyLibrary:function(e){return o.inFamilyLibrary(e)}})}),define("DS/ClassificationEditor/commands/ClassificationIconBar_MoveClass",["UWA/Core","DS/ApplicationFrame/Command","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/LibraryActive/LibraryActive","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/dataProvider/LibraryDnDServiceProvider"],function(e,t,i,r,a,n){"use strict";return t.extend({labelTopBar:i.moveClass_ActiveClassify_LabelTopbar,isInsert:!0,datas:{},init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){this.popover?(this.popover.nestedMenuInContext.popover.title=i.confirmation_move_title+" - "+a.getSelectedNodes()[0].getLabel(),this.popover.showPopover()):(this.popover=new r({container:document.body.querySelector('[data-command="ActionBar_ActiveClassificationCmd"]'),topBarLabel:i.confirmation_move_title+" - "+a.getSelectedNodes()[0].getLabel(),selectBtnLabel:i.confirmMoveYes,isChooserPanel:!0,panelIcon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-move-to",couldBeValid:function(e){e&&e.getID&&e.getID();if(e&&e.getType){if(e.getType())return"General Class"===e.getType()||"General Library"===e.getType();if("General Class"===e.plmType||"General Library"===e.plmType)return!0}return!1}}),this.popover.addEvent("onSetActive",function(e){var t=e,i=a.getCurrentLibrary().getID(),r=[a.getSelectedNodes()[0].getID()];n.addClassesInLibrary(t,i,r,!1,!0),require("DS/ClassificationEditor/commands/LibraryCommands")._offProgressBar()}))},endExecute:function(){}})});