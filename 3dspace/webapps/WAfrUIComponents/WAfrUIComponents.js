define("DS/WAfrUIComponents/WAfrPlayerCommands",[],function(){return["SLIDER","EDITOR","WAFRPlayerExitAction","WAFRPlayerOptionsAction","WAFRPlayerFirstAction","WAFRPlayerBackAction","WAFRPlayerPlayPauseAction","WAFRPlayerStopAction","WAFRPlayerNextAction","WAFRPlayerLastAction","WAFRPlayerLoopRun","WAFRPlayerTimeControlAction","WAFRPlayerExportAction"]}),define("DS/WAfrUIComponents/WAfrPlayerView",["UWA/Core","DS/Controls/Slider","DS/Controls/Toolbar","DS/Controls/LineEditor","DS/Controls/ComboBox","DS/Utilities/TouchUtils","DS/Windows/Panel"],function(e,t,n,i,o,r,a){"use strict";var s=-5,l=5,d=1,p=0,c=120,h=1,u=1,m=1e4,w=.03125,f=32;function _(){this.elements={},this.promiseArray=[],this.elements.container=new e.Element("div",{class:"wux-controls-playerview "}),this.elements.rightFixedContainer=new e.Element("div",{class:"wafr-player-command"}),this.elements.extensibleContainer=new e.Element("div",{class:"wafr-player-command"}),this.toolbar._getContainerFromPosition("center").style.width="35%",this.elements.extensibleContainer.setStyle("width","100%"),this._indexesAndViews={};var t=this.elements.rightFixedContainer;let n=this._model.elements;for(let e=0;e<n.length;e++){let i=n[e];t=this.elements.leftOrBottom,"SLIDER"===i&&(t=this.elements.extensibleContainer),"EDITOR"===i&&(t=this.elements.rightFixedContainer);let o=y.call(this,i,t);o=o||"",this._indexesAndViews[i]={index:e,view:o}}this.elements.divider=new e.Element("div",{class:"wafr-section-divider"}),Promise.all(this.promiseArray).then(e=>{e.forEach(e=>{this._indexesAndViews[e.id]&&(this._indexesAndViews[e.id].view=e.data),this.toolbar.add("element",{element:e.data,position:"near"}),"WAFRPlayerExitAction"===e.id&&this.toolbar.add("element",{element:this.elements.divider,position:"near"})})}),this.toolbar.add("element",{element:this.elements.extensibleContainer,position:"center"}),this.toolbar.add("element",{element:this.elements.rightFixedContainer,position:"far"})}function y(t,n){var o=this;switch(t){case"SLIDER":return this.elements.slider=b(1,100,1),this.elements.slider.getContent().addEventListener("change",function(e){C.call(o,e,"EVT_WAfrPlaySlider")}),this.elements.slider.getContent().style.width="100%",this.elements.slider.getContent().inject(n),this.elements.slider;case"EDITOR":let r=function(){let e=this,t=new i({value:"00:00:00",selectAllOnFocus:!0,sizeInCharNumber:5,pattern:"[0-9][0-9]:[0-5][0-9]:[0-5][0-9]",placeholder:"hh:mm:ss"});return t.addEventListener("change",function(t){C.call(e,t,"EDITOR")}),this._model.editableLabel||(t.disabled=!0),t.getContent().getChildren()[0].setStyle("border","hidden"),t.getContent().getChildren()[0].setStyle("background-color","#f1f1f1"),t}.call(this);return this.elements.playerEditor=r,r.inject(n),r;default:let a=t;o.promiseArray.push(function(t){let n=this,i=this.ex.getComponent("Afr_UIComponent");var o=new e.Element("div",{class:"wafr-player-command"});if("WAFRPlayerPlayPauseAction"==t)return i.createCheckHandlerRepresentation({id:t}).then(function(e){return o.appendChild(e),o}).catch(E);if("WAFRPlayerLoopRun"==t)return i.createRadioHandlerRepresentation({id:t,representationType:"singleButton"}).then(function(e){return o.appendChild(e),n.setLoopMode(n.LoopMode),o}).catch(E);if("WAFRPlayerTimeControlAction"==t&&!this._model.FPS&&!this._model.Duration&&!this._model.Speed)return;return i.createDefaultHandlerRepresentation({id:t}).then(function(e){return o.appendChild(e),o}).catch(E)}.call(this,a,t.checkMode).then(function(e){let t={};return t.id=a,t.data=e,Promise.resolve(t)}))}}function g(e){let t=e.split(":");var n=1e3*Number(t[2])+6e4*Number(t[1])+36e5*Number(t[0]);if(!isNaN(n))return n}function v(e){var t="00",n="00",i="00";if(e<6e4)t=(r=Math.floor(e/1e3))<=9?"0"+r:r;else if(e>=6e4&&e<36e5){n=(o=Math.floor(e/6e4))<=9?"0"+o:o,t=(r=Math.floor(e%6e4/1e3))<=9?"0"+r:r}else{var o,r,a=Math.floor(e/36e5);i=a<=9?"0"+a:a,n=(o=Math.floor(e%36e5/6e4))<=9?"0"+o:o,t=(r=Math.floor(e%36e5%6e4/1e3))<=9?"0"+r:r}return i+":"+n+":"+t}function C(e,t){var n=null;if(e&&e.dsModel&&e.dsModel.value)n=e.dsModel.value;else{if(!e||!e.value)throw new Error("WAFRPlayerView.js cannot send Player event without an Value");n=e.value}let i=this.ex.getComponent(WAfrStandardComponentKey.ModelEvents);switch(t){case"DURATION":return n>m&&(n=m),n<u&&(n=u),n=g.call(this,n),void i.publish({event:"EVT_WAfrPlayDuration",data:{value:n}});case"FPS":return n>c&&(n=c),n<h&&(n=h),void i.publish({event:"EVT_WAfrPlayFPS",data:{value:n}});case"SPEED":return n=function(e){let t=e.dsModel.value;var n=1;n=p?0===t?1:t:t>=1?Math.pow(2,t):t<0?1/(1/Math.pow(2,t)):1;return n}.call(this,e),void i.publish({event:"EVT_WAfrPlaySpeed",data:{value:n}});case"EDITOR":return n=g.call(this,n),void i.publish({event:"EVT_WAfrPlayEditor",data:{value:n}})}}function b(e,n,i){return new t({value:0,minValue:e,maxValue:n,stepValue:i,fireOnlyFromUIInteractionFlag:!0})}function E(e){"Impossible to generate the view for"!==e.message&&new Error(e)}function P(){var t=this;let n=new e.Element("div",{width:"100%",height:"100%"}),o=e.createElement("div",{class:"wafr-player-timecontrolpanel-body"});o.inject(n);let r=new e.createElement("div",{class:"wafr-player-timecontrolpanel-leftSection"}).inject(o),a=new e.createElement("div",{class:"wafr-player-timecontrolpanel-RightSection"}).inject(o),c=b(s,l,d);c.getContent().addEventListener("endEdit",function(e){C.call(t,e,"SPEED")}),c.addEventListener("change",function(e){(function(e){var t=this.elements.speedLineEditor;if(e&&e.dsModel&&e.dsModel.value){let n=e.dsModel.value;t.value=p?0===n?"1x":n+"x":n>=1?Math.pow(2,n)+"x":n<0?"1/"+1/Math.pow(2,n)+"x":"1x"}}).call(t,e)}),this.elements.SpeedSlider=c,c.inject(r);let h=new i({value:"1x",sizeInCharNumber:1,disabled:!0,fireOnlyFromUIInteractionFlag:!0});h.inject(a),this.elements.speedLineEditor=h;var u=new e.createElement("div",{class:"wafr-speed-label"});return u.inject(n),new e.createElement("div",{html:"Slow",class:"wafr-slow-label"}).inject(u),new e.createElement("div",{html:"Fast",class:"wafr-fast-label"}).inject(u),n}function S(){r.getTouchMode();var t=[];let n=this;if(this._model.Speed){t.push("Speed");var s=P.call(this)}if(this._model.FPS){t.push("FPS");var l=function(){var t=this;let n=new e.Element("div",{class:"wafr-player-timecontrolpanel-body"});new e.createElement("div",{html:"Number of frames per second",class:"wafr-player-timecontrolpanel-leftSection"}).inject(n);let o=new e.createElement("div",{class:"wafr-player-timecontrolpanel-RightSection"}).inject(n),r=new i({value:"5",selectAllOnFocus:!0,sizeInCharNumber:1,pattern:"[0-9]+",fireOnlyFromUIInteractionFlag:!0});return this.elements.fpsEditor=r,r.addEventListener("change",function(e){C.call(t,e,"FPS")}),r.inject(o),n}.call(this)}if(this._model.Duration){t.push("Duration");var d=function(){var t=this;let n=new e.Element("div",{class:"wafr-player-timecontrolpanel-body"});new e.createElement("div",{html:"Animation playback length",class:"wafr-player-timecontrolDurationpanel-leftSection"}).inject(n);let o=e.createElement("div",{class:"wafr-player-timecontrolDurationpanel-RightSection"});o.inject(n);let r=new i({value:"00:03:15",selectAllOnFocus:!0,sizeInCharNumber:5,pattern:"[0-9][0-9]:[0-5][0-9]:[0-5][0-9]",placeholder:"hh:mm:ss",fireOnlyFromUIInteractionFlag:!0});return r.addEventListener("change",function(e){C.call(t,e,"DURATION")}),this.elements.durationEditor=r,r.inject(o),n}.call(this)}let p=new o({elementsList:t,enableSearchFlag:!1,actionOnClickFlag:!1,fireOnlyFromUIInteractionFlag:!0});return p.addEventListener("change",function(){"Speed"===p.value?n.timeControlPanel.content=s:"FPS"===p.value?n.timeControlPanel.content=l:"Duration"===p.value&&(n.timeControlPanel.content=d)}),this.timeControlPanel=new a({title:"Time Control",header:p,content:s,autoCloseFlag:!1,identifier:"WAFRPlayerTimeControlPanel",width:250,height:100}),this.timeControlPanel.getContent().getChildren()[1].getChildren()[0].getChildren()[1].setStyle("border-bottom","none"),this.timeControlPanel}function x(e,t){this._model=e,this.ex=t,this.toolbar=new n({overflowManagement:"dropdown",direction:"horizontal"}),_.call(this)}return x.prototype.setLoopMode=function(e){this._indexesAndViews.WAFRPlayerLoopRun&&this._indexesAndViews.WAFRPlayerLoopRun.view?this.ex.getComponent(mod_ModelEvents.DEFAULT_COMPONENT_NAME).setRadioItemState({id:e,radioId:"WAFRPlayerLoopRun",state:!0}):this.LoopMode=e},x.prototype.setPlayerPlayPauseState=function(e){this._indexesAndViews.WAFRPlayerPlayPauseAction&&this._indexesAndViews.WAFRPlayerPlayPauseAction?this.ex.getComponent(WAfrStandardComponentKey.HandlerComponent).setCheckState({id:"WAFRPlayerPlayPauseAction",state:e}):this.playPauseState=e},x.prototype.setSliderPosition=function(e){this.elements.slider.value=e},x.prototype.setEditorValue=function(e){e=v.call(this,e),this.elements.playerEditor.value=e},x.prototype.getTimeControlPanel=function(){return S.call(this)},x.prototype.setUserDefinedSpeed=function(e,t,n){t===e||e>t||(d=0===n?1:n,w=min,f=max,p=1)},x.prototype.clean=function(){this.ex=null,this.elements=[],this.toolbar=null},x.prototype.setPlayerSpeed=function(e){e>f&&e<w||(p||(e=Math.log2(e)),this.elements.SpeedSlider.value=e)},x.prototype.setPlayerDuration=function(e){e>m&&e<u||(e=v(e),this.elements.DurationEditor.value=e)},x.prototype.setPlayerFPS=function(e){e>c&&e<h||(this.elements.fpsEditor.value=e)},x.prototype.setMinMaxDuration=function(e,t){t===e||e>t||(u=e,m=t)},x.prototype.setMinMaxFPS=function(e,t){t===e||e>t||(h=e,c=t)},x}),define("DS/WAfrUIComponents/Viewer",["UWA/Core","DS/Visualization/WebGLV6Viewer","DS/Visualization/SceneGraph","DS/Visualization/Viewpoint","DS/Visualization/ModelLoader","DS/SceneGraphTree/SceneGraphTree","DS/CoreEvents/ModelEvents","DS/WAfrUIStandardComponents/UIFrame"],function(e,t,n,i,o,r,a,s){"use strict";var l={pathViewer:null,antiAliasing:"SMAA",useShadowMap:!1,infinitePlane:!0,displayGrid:!0,useVignetting:!1,ssao:!1,dof:!1,deferred:!1,debugShadowLight:!1,debugBSphere:!1,debugBBox:!1,onModelLoaded:null,displayTree:!1},d=function(t){this.options=e.extend(e.clone(l),t),this._modelEvents=new a,this._viewerBuilt=!1};return d.prototype.init3dViewer=function(){var e=this;e._3dViewer.setRenderMode("@Edge",!0),e._3dViewer.setPicking({activated:!0,displayHL:!0,gpu:!0,computeNormalDepth:!0,primitive:!1}),e._3dViewer.setPrePicking({activated:!1,displayHL:!0,gpu:!0,computeNormalDepth:!1,primitive:!1}),window.undoSceneGraphMigration?(e._private_sceneGraph=new n("I solemnly swear that I am up to no good."),e._3dViewer.attachScene(e._private_sceneGraph)):e._private_sceneGraph=e._3dViewer.getRootNode(),e._viewpoint=new i({viewer:e._3dViewer}),e._viewpoint.onMove(e._3dViewer.render),e._3dViewer.addViewpoint(e._viewpoint),e._3dViewer.setVisuEnv("V6"),e._modelLoader=new o,e._modelLoader.setSceneGraph(e._private_sceneGraph),e._modelLoader.setRenderCallback(e._3dViewer.render),e._modelLoader.setOnLoadedCallback(function(){e.options.onModelLoaded?e.options.onModelLoaded.call(e):e._viewpoint.reframe(),e._modelEvents.publish({event:"EVT_VIEWER_MODEL_LOADED",data:e})})},d.prototype._init=function(){var e=this;e.init3dViewer();if(this.getExecutionContext()){e.viewerFrame=null;var t=this.getExecutionContext().getComponent(s.DEFAULT_COMPONENT_NAME);t?e.viewerFrame=t.getViewerLayout():(e.viewerFrame=this.getExecutionContext().getTargetApp().getFrameWindow().elements.viewerFrame,t=this.getExecutionContext().getTargetApp().getFrameWindow().elements.layerSet),e.viewerFrame.hasChildNodes()||e._3dViewer.inject(e.viewerFrame),e._sceneGraphTree=new r(UWA.extendElement(e._3dViewer.div),e._3dViewer),e._sceneGraphTree.setSceneGraph(e._private_sceneGraph),e.options.displayTree?e._sceneGraphTree.tree.show():e._sceneGraphTree.tree.hide(),e._sceneGraphTree.tree.getContent().setStyles({height:"auto",position:"absolute",left:0,top:0,bottom:81}),t.addLayer(e._sceneGraphTree.tree.getContent(),{height:"auto",position:"absolute",left:0,top:0,bottom:0});var n="Visu"+e._3dViewer.getVisuEnv()+"Env",i={VisuNoEnv:"light",VisuNoneEnv:"light",VisuV6Env:"light",VisuCleanSpaceEnv:"light",VisuDarkBlueEnv:"dark",VisuDarkGreyEnv:"dark",VisuShinyEnv:"dark"};t.addRootClassName?t.addRootClassName("wux-ui-ambiance-"+i[n]):this.getExecutionContext().getTargetApp().getFrameWindow().elements.container.addClassName("wux-ui-ambiance-"+i[n]),e._modelEvents.publish({event:"EVT_VIEWER_LOADED",context:e}),this._viewerBuilt=!0}},d.prototype.initialize=function(){if(this._viewerBuilt)return this.injectViewer(),UWA.Class.Promise.resolve();var e=this,n=this.options.pathViewer;return new Promise(function(i,o){if(!n)return e._3dViewer=new t(e.options),e._init(),void i();try{require([n],function(t){e._3dViewer=new t(e.options),e._init(),i()})}catch(e){o(e)}})},d.prototype.injectViewer=function(){var e=this;e.viewerFrame=null;var t=this.getExecutionContext().getComponent(s.DEFAULT_COMPONENT_NAME);t?e.viewerFrame=t.getViewerLayout():(e.viewerFrame=this.getExecutionContext().getTargetApp().getFrameWindow().elements.viewerFrame,t=this.getExecutionContext().getTargetApp().getFrameWindow().elements.layerSet),e.viewerFrame.hasChildNodes()||e._3dViewer.inject(e.viewerFrame)},d.prototype.onViewerModelLoaded=function(e){return this._modelEvents.subscribe({event:"EVT_VIEWER_MODEL_LOADED"},e)},d.prototype.onViewerLoaded=function(e){return this._modelEvents.subscribe({event:"EVT_VIEWER_LOADED"},e)},d.prototype.get3DViewer=function(){return this._3dViewer},d.prototype.getModelLoader=function(){return this._modelLoader},d.prototype.destroy=function(){for(this._modelLoader.abort(),this._modelLoader=null,this.get3DViewer().dispose();this.viewerFrame.firstChild;)this.viewerFrame.removeChild(this.viewerFrame.firstChild);return UWA.Class.Promise.resolve()},d}),define("DS/WAfrUIComponents/PlayerStandardActions",[],function(){"use strict";var e=Object.create(null);return(e=function(){console.log("start")}).OnPlay=function(e,t){t.executionContext.getComponent(WAfrStandardComponentKey.ModelEvents).publish({event:"EVT_WAfrPlay"}),e()},e.OnPause=function(e,t){t.executionContext.getComponent(WAfrStandardComponentKey.ModelEvents).publish({event:"EVT_WAfrPause"}),e()},e.OnGoToEnd=function(e,t){t.executionContext.getComponent(WAfrStandardComponentKey.ModelEvents).publish({event:"EVT_WAfrPlayLast"}),e()},e.OnGoToBegin=function(e,t){t.executionContext.getComponent(WAfrStandardComponentKey.ModelEvents).publish({event:"EVT_WAfrPlayFirst"}),e()},e.OnBack=function(e,t){t.executionContext.getComponent(WAfrStandardComponentKey.ModelEvents).publish({event:"EVT_WAfrPlayBack"}),e()},e.OnNext=function(e,t){t.executionContext.getComponent(WAfrStandardComponentKey.ModelEvents).publish({event:"EVT_WAfrPlayNext"}),e()},e.OnSlider=function(e,t){t.executionContext.getComponent(WAfrStandardComponentKey.ModelEvents).publish({event:"EVT_WAfrPlaySlider"}),e()},e.OnStop=function(e,t){t.executionContext.getComponent(WAfrStandardComponentKey.ModelEvents).publish({event:"EVT_WAfrPlayStop"}),e()},e.OnLoopRunOnce=function(e,t){t.executionContext.getComponent(WAfrStandardComponentKey.ModelEvents).publish({event:"EVT_WAfrPlayLoopOnce"}),e()},e.OnLoopRunContinuously=function(e,t){t.executionContext.getComponent(WAfrStandardComponentKey.ModelEvents).publish({event:"EVT_WAfrPlayLoopContinous"}),e()},e.OnLoopRunContinuouslyBackAndForth=function(e,t){t.executionContext.getComponent(WAfrStandardComponentKey.ModelEvents).publish({event:"EVT_WAfrPlayLoopRCBF"}),e()},e.OnLoopRunReverse=function(e,t){t.executionContext.getComponent(WAfrStandardComponentKey.ModelEvents).publish({event:"EVT_WAfrPlayLoopReverse"}),e()},e.OnOptions=function(e,t){t.executionContext.getComponent(WAfrStandardComponentKey.ModelEvents).publish({event:"EVT_WAfrPlayOptions"}),e()},e.OnExit=function(e,t){t.executionContext.getComponent(WAfrStandardComponentKey.ModelEvents).publish({event:"EVT_WAFRPlayExit"}),e()},e.OnShowPlayer=function(e,t){t.executionContext.getComponent("Player").showPlayer(),e()},e.OnTimeControl=function(e,t){t.executionContext.getComponent("Player").showTimeControlPanel(),e()},e.OnExport=function(e,t){t.executionContext.getComponent(WAfrStandardComponentKey.ModelEvents).publish({event:"EVT_WAFRPlayExport"}),e()},e}),define("DS/WAfrUIComponents/mod_SmallViewportActionBar",["DS/WAfrUIStandardComponents/mod_TreeModel","DS/Core/PointerEvents","DS/Controls/ComboBox","DS/WAfrDebug/mod_Performances"],function(e,t,n,i){"use strict";const o=i.Performances,r="[DS/WAfrUIComponents/mod_SmallViewportActionBar]",a=new o;function s(e){return Object.assign({},e)}function l(e){let t=e.getData(),n=document.createElement("div");return n.classList.add("afr-mab-cmd-grid"),t.view=n,Promise.resolve()}function d(e,t,n,i){let o=e.getData(),s=a.start([r,"[Async] generateTweaker",e.getId()].join(" ")),l=[],d=e.getForwardIterator();for(;d.isValid();){let e=d.get().getData();l.push(e.handler),d.next()}let p=t.handlerSet({value:{items:l},typePath:o.type,touchMode:i,modelEventsCpt:n});return o.view=p.getContent(),o.view.dsModel=p,a.stop(s),Promise.resolve()}function p(e,t,n,i){let o=e.getData(),s=null;if(o.handler){let e=o.handler,l=a.start([r,"[Async] generateTweaker",e.getId()].join(" "));if("radioHandler"!==o.type){let r=t[o.type]({value:e,typePath:o.type,touchMode:i,modelEventsCpt:n}).getContent();o.view=r,a.stop(l),s=Promise.resolve()}else{let r=t[o.type]({value:e,typePath:o.type,touchMode:i,modelEventsCpt:n,displayStyle:"svab"}),a=r.getContent();a.dsModel=r,o.view=a}}else console.error(o.label,"is not a handler"),s=Promise.resolve(new Error(o.label+" is not a handler"));return s}function c(e){e.detail.value?(this._private._views.mabFrame.classList.add("afr-mab-flyout-displayed"),this._private._views.mabFrame.classList.remove("afr-mab-show-section")):(this._private._views.mabFrame.classList.remove("afr-mab-flyout-displayed"),this._private._views.mabFrame.classList.add("afr-mab-show-section"))}let h=Object.create(null);return h.SmallViewportActionBar=class{constructor(e){if(!e)throw new Error("container MUST be defined");this._private=Object.create(null),this._private._container=e,this._private._flyouts=[],this._private._subscriptions=[],this._private._isGenerated=!1,e.classList.add("wafr-mab-hidden"),e.classList.add("wafr-uiframe-mab")}generate(i,o,r,a,h,u){if(this._private._isGenerated)throw new Error("The Small Viewport Action Bar has already been generated.");this._private._model=function(t,n,i){const o=e.TreeModel;let r=new o({identifier:"root"}),a=new o({identifier:"WAfrFront",type:"section"});for(let e=0,n=t.length;e<n;++e){let n=s(t[e].options.grid);if(!n.hasOwnProperty("category")||void 0===n.category)throw new Error("Item must at least have a category property");{let e=n.category;if(Array.isArray(n.category)&&(e=n.category[0],n.category.length>1&&"WAfrFront"===n.category[1])){n.handler.isFrontCmd=!0;let e=s(n);e.view=null,e.set&&(e.set=void 0,"commandFlyout"===e.type&&(e.type=e.typeView)),a.addChild(e)}let t=null,o=r.getChild(e);if(!o){let t=e;i&&i[e]&&i[e].internationalization&&i[e].internationalization.title&&(t=i[e].internationalization.title),o=r.addChild({identifier:e,title:t,type:"section"})}if(t=o,n.hasOwnProperty("set")&&void 0!==n.set){let e=t.getChild(n.set);e||(e=t.addChild({identifier:n.set,type:"set"})),t=e}t.addChild(n)}}if(n&&n.length>0&&!r.reorder(n))throw new Error("A problem ocurred when reordering sections");return r.addChildNode(a),r}(i,o,r);let m=[{id:"mabFrame",elt:"div",class:["afr-mab-frame"]},{id:"mabContainer",elt:"div",class:["afr-mab-container"],parent:"mabFrame"},{id:"mabBurgerButton",elt:"div",class:["afr-mab-burger"],parent:"mabFrame"},{id:"mabBurgerBack",elt:"div",class:["afr-mab-burger-back"],parent:"mabContainer"},{id:"mabFlyoutWrapper",elt:"div",class:["afr-mab-flyout-wrapper"],parent:"mabContainer"},{id:"mabBurgerItem1",elt:"span",parent:"mabBurgerButton"},{id:"mabBurgerItem2",elt:"span",parent:"mabBurgerButton"},{id:"mabBurgerItem3",elt:"span",parent:"mabBurgerButton"},{id:"mabBurgerItem4",elt:"span",parent:"mabBurgerButton"},{id:"mabFrontCmdContainer",elt:"div",class:["afr-mab-front-container"],parent:"mabContainer"},{id:"mabExpandDotButton",elt:"div",class:["afr-mab-dot","wux-ui-3ds","wux-ui-3ds-1x","wux-ui-3ds-menu-dot"],parent:"mabFrontCmdContainer"},{id:"mabExpandedContainer",elt:"div",class:["afr-mab-expanded-container"],parent:"mabFrame"},{id:"mabSectionChooser",elt:"div",class:["afr-mab-sections"],parent:"mabExpandedContainer"}];this._private._views=Object.create(null);let w=this._private._views;for(let e=0,t=m.length;e<t;++e){let t=m[e];if(w[t.id]=document.createElement(t.elt),t.class)for(let e=0,n=t.class.length;e<n;++e)w[t.id].classList.add(t.class[e]);t.parent&&w[t.parent].appendChild(w[t.id])}m=null;let f=[],_=this._private._model.getForwardIterator(),y=null;for(;_.isValid();)"WAfrFront"!==(y=_.get()).getId()&&f.push({labelItem:y.getData().title}),_.next();return w.mabCombo=new n({displayStyle:"lite",expanderIcon:"arrow-combo-vertical",elementsList:f,enableSearchFlag:!1,actionOnClickFlag:!0}),w.mabSectionChooser.appendChild(w.mabCombo.getContent()),this._private._bound_onBurgerClick=function(){let e=this._private._views.mabFrame;e.classList.toggle("afr-mab-open");let t=e.classList.contains("afr-mab-open");t?this._private._container.classList.add("wafr-uiframe-mab-expanded"):this._private._container.classList.remove("wafr-uiframe-mab-expanded"),document.dispatchEvent(new Event("mabBurgerClick",{detail:t}))}.bind(this),w.mabBurgerButton.addEventListener("click",this._private._bound_onBurgerClick),this._private._subscriptions.push({elt:w.mabBurgerButton,evt:"click",cb:this._private._bound_onBurgerClick}),this._private._bound_onDotClick=function(e){this._private._views.mabFrame.classList.add("afr-mab-show-section"),e.stopPropagation()}.bind(this),w.mabExpandDotButton.addEventListener("click",this._private._bound_onDotClick),this._private._subscriptions.push({elt:w.mabExpandDotButton,evt:"click",cb:this._private._bound_onDotClick}),this._private._bound_onOutsideClick=function(e){let t=document.getElementsByClassName("wux-controls-combobox-popup")[0];this._private._views.mabExpandedContainer.contains(e.target)||(!t||t&&!t.contains(e.target))&&this._private._views.mabFrame.classList.remove("afr-mab-show-section")}.bind(this),document.body.addEventListener(t.POINTERUP,this._private._bound_onOutsideClick),this._private._subscriptions.push({elt:document.body,evt:t.POINTERUP,cb:this._private._bound_onOutsideClick}),this._private._bound_onComboBoxChange=function(e){let t=this._private._views,n=this._private._model,i=e.dsModel;if(i){let e=i.currentValue,o=n.getChild(e);if(o){let e=o.getData().view,n=t.mabExpandedContainer.getElementsByClassName("afr-mab-cmd-grid")[0];n&&t.mabExpandedContainer.removeChild(n),t.mabExpandedContainer.appendChild(e)}}}.bind(this),w.mabCombo.addEventListener("change",this._private._bound_onComboBoxChange),this._private._subscriptions.push({elt:w.mabCombo,evt:"change",cb:this._private._bound_onComboBoxChange}),function(e,t,n){let i=Object.assign({},e);i.radioHandler=function(t){return t.displayStyle="svab",t.touchMode=!0,e.radioHandlerFlat(t)},i.handlerSet=function(t){return t.displayStyle="svab",t.touchMode=!0,e.handlerSet(t)};let o=[],r=[],a={section:l,set:d,item:p},s=this._private._model.getForwardIterator();for(;s.isValid();)r.push(s.get()),s.next();let c=[...r],h=null,u=null;for(;c.length>0;)if("section"!==(u=(h=c.pop()).getData().type)&&"set"!==u&&(u="item"),o.push(a[u](h,i,t,n)),"set"!==u)for(s=h.getBackwardIterator();s.isValid();)c.push(s.get()),s.next();return Promise.all(o)}.call(this,a,h,u).then(function(){let e=[],t=null,n=this._private._model.getForwardIterator();for(;n.isValid();)"WAfrFront"===n.get().getId()?t=n.get():e.push(n.get()),n.next();let i=null,o=null,r=null,a=t.getData();a.view=this._private._views.mabFrontCmdContainer;let s=document.createDocumentFragment();n=t.getForwardIterator();let l=null;for(;n.isValid();)(r=(i=n.get()).getData()).view?(o=r.view,(l=document.createElement("div")).classList.add("afr-mab-front-cmd"),l.appendChild(o),s.appendChild(l)):console.error(`No view to append for ${i.getId()}`),n.next();a.view.insertBefore(s,a.view.firstChild);let d=null,p=null;for(let t=0,a=e.length;t<a;++t)for(p=(d=e[t]).getData().view,n=d.getForwardIterator();n.isValid();){if((o=(r=(i=n.get()).getData()).view)?(o.dsModel.showLabelFlag=!0,p.appendChild(o)):console.error(`No view to append for ${i.getId()}`),"set"===r.type||"radioHandler"===r.type){let e=r.view,t=e.dsModel;t.setExpandedContainerParent(this._private._views.mabFlyoutWrapper);let n=c.bind(this);t.onExpandState(n),this._private._subscriptions.push({elt:e,evt:"expandstate",cb:n}),this._private._flyouts.push(t.elements.internalView)}n.next()}return Promise.resolve()}.bind(this)).then(function(){return this._private._container.appendChild(this._private._views.mabFrame),this._private._isGenerated=!0,Promise.resolve()}.bind(this))}isGenerated(){return this._private._isGenerated}show(){this._private._bound_onComboBoxChange({dsModel:this._private._views.mabCombo}),this._private._views.mabFrame.classList.remove("afr-mab-hidden"),this._private._container.removeClassName("wafr-mab-hidden")}hide(){let e=this._private._flyouts;for(let t of e)t.collapse();this._private._bound_onOutsideClick({target:null}),this._private._views.mabFrame.classList.add("afr-mab-hidden"),this._private._container.classList.add("wafr-mab-hidden")}destroy(){this.clean(),this._private._container.classList.remove("wafr-mab-hidden"),this._private._container.classList.remove("wafr-uiframe-mab")}clean(){let e=this._private._subscriptions;for(;e.length>0;){let t=e.pop();t.elt.removeEventListener(t.evt,t.cb)}if(this.isGenerated()){let e=[],t=this._private._model.getForwardIterator();for(;t.isValid();)e.push(t.get()),t.next();for(;e.length>0;){let t=e.pop(),n=t.getData();if(n&&n.view){let e=n.view;e&&(e.dsModel&&e.dsModel.destroy&&e.dsModel.destroy(),e.parentNode&&e.parentNode.removeChild(e),delete n.view)}let i=t.getBackwardIterator();for(;i.isValid();)e.push(i.get()),i.next()}this._private._bound_onBurgerClick&&delete this._private._bound_onBurgerClick,this._private._bound_onDotClick&&delete this._private._bound_onDotClick,this._private._bound_onOutsideClick&&delete this._private._bound_onOutsideClick,this._private._bound_onComboBoxChange&&delete this._private._bound_onComboBoxChange;let n=this._private._views;n.mabFrame.parentNode&&n.mabFrame.parentNode.removeChild(n.mabFrame),n&&Object.keys(n).forEach(function(e){delete n[e]}),delete this._private._model,this._private._isGenerated=!1}}},h}),define("DS/WAfrUIComponents/WAfrMRUController",["DS/WelcomeScreenView/WelcomeScreenMRUController","DS/WAfrControls/WAfrContextualMenu"],function(e,t){"use strict";return class{constructor(e,t,n){if(this._mruController=null,this._handlerComponent=e,this._uiContextComponent=t,this._onHitHandler=null,this._onHitCallback=null,n.hasOwnProperty("onHit")){if(null===n.onHit||"object"!=typeof n.onHit)throw new Error("onHit property has to be an object.");n.onHit.hasOwnProperty("simpleHit")&&"boolean"==typeof n.onHit.simpleHit&&(this._simpleHit=n.onHit.simpleHit),n.onHit.hasOwnProperty("handler")&&"string"==typeof n.onHit.handler?this._onHitHandler=n.onHit.handler:n.onHit.hasOwnProperty("callback")&&"function"==typeof n.onHit.callback&&(this._onHitCallback=n.onHit.callback)}if(n.hasOwnProperty("contextualMenu")){if(null===n.contextualMenu||"object"!=typeof n.contextualMenu)throw new Error("contextualMenu property has to be an object.");n.contextualMenu.hasOwnProperty("content")&&Array.isArray(n.contextualMenu.content)?this._ctxMenuContent=this._uiContextComponent._convertToMenuOptions(n.contextualMenu.content):n.contextualMenu.hasOwnProperty("callback")&&"function"==typeof n.contextualMenu.callback&&(this._contextMenuCallback=n.contextualMenu.callback)}}initialize(){let t={};(this._ctxMenuContent||this._contextMenuCallback)&&(t.onContextualMenu=this._onContextMenuCB.bind(this)),(this._onHitHandler||this._onHitCallback)&&(t.onHit=this._onHitCB.bind(this)),this._simpleHit&&(t.simpleHit=this._simpleHit),this._mruController=new e(t)}getController(){return this._mruController}_onContextMenuCB(e){return this._ctxMenuContent?this._ctxMenuContent:this._contextMenuCallback?this._contextMenuCallback(e):void 0}_onHitCB(e){return this._onHitHandler?this._handlerComponent.executeHandler({id:this._onHitHandler,args:e}):this._onHitCallback?this._onHitCallback(e):void 0}}}),define("DS/WAfrUIComponents/Player",["DS/Windows/Panel","DS/WAfrUIComponents/WAfrPlayerView","DS/WAfrUIStandardComponents/UIFrame","DS/WAfrUIComponents/WAfrPlayerCommands"],function(e,t,n,i){"use strict";let o={editableLabel:!0,Speed:!0,Duration:!0,FPS:!0},r=function(e){this.options=e};return r.prototype.initialize=function(){return this._executionContext=this.getExecutionContext(),Promise.resolve()},r.prototype.clean=function(){return this.hidePlayer(),this._playerView.clean(),this._playerView=null,this._playerContainer=null,this.executionContext=null,Promise.resolve()},r.prototype.destroy=function(){return Promise.resolve()},r.prototype.showTimeControlPanel=function(){let e=this._executionContext.getComponent(n.DEFAULT_COMPONENT_NAME).getImmersiveFrame();var t;this._playerView&&this._playerView.timeControlPanel?t=this._playerView.timeControlPanel:(t=this._playerView.getTimeControlPanel(),this._playerView.timeControlPanel=t),t&&e.addWindow(t);let i=this;this._playerView.timeControlPanel.addEventListener("close",function(){i.hideTimeControlPanel()})},r.prototype.hideTimeControlPanel=function(){this._playerView.timeControlPanel&&this._executionContext.getComponent(n.DEFAULT_COMPONENT_NAME).getImmersiveFrame().removeWindow(this._playerView.timeControlPanel)},r.prototype.setPlayerSpeed=function(e){this._playerView&&this._playerView.setPlayerSpeed(e)},r.prototype.setPlayerDuration=function(e){this._playerView&&this._playerView.setPlayerDuration(e)},r.prototype.setMinMaxDuration=function(e,t){this._playerView&&this._playerView.setMinMaxDuration(e,t)},r.prototype.setMinMaxFPS=function(e,t){this._playerView&&this._playerView.setMinMaxDuration(e,t)},r.prototype.setPlayerFPS=function(e){this._playerView&&this._playerView.setPlayerFPS(e)},r.prototype.setLoopMode=function(e){this._playerView&&this._playerView.setLoopMode(e)},r.prototype.setPlayerPlayPauseState=function(e){this._playerView&&this._playerView.setPlayerPlayPauseState(e)},r.prototype.setSliderPosition=function(e){this._playerView&&this._playerView.setSliderPosition(e)},r.prototype.setEditorValue=function(e){this._playerView&&this._playerView.setEditorValue(e)},r.prototype.setUserDefinedSpeed=function(e,t,n){this._playerView&&this._playerView.setUserDefinedSpeed(e,t,n)},r.prototype.createPlayer=function(){return this._playerModel={},Object.assign(this._playerModel,o),Object.assign(this._playerModel,this.options),this._playerModel.elements=i,this._playerView||(this._playerView=new t(this._playerModel,this._executionContext)),this._playerView},r.prototype.createPlayerContainer=function(){this._playerContainer=new e({title:"Player",identifier:"wafr-player",content:this._playerView.toolbar.getContent(),resizableFlag:!0,movableFlag:!0,currentDockArea:WUXDockAreaEnum.BottomDockArea,closeButtonFlag:!1,usePaddingFlag:!1,pinnedFlag:"Fixed Area"})},r.prototype.insertPlayer=function(){if(!this._executionContext)throw new Error("Player.js cannot show the player without an execution context");let e=this._executionContext.getComponent(n.DEFAULT_COMPONENT_NAME).getImmersiveFrame();if(e._getWindowFromIdentifier("wafr-player"))throw new Error("Application already has an Player. Remove the existing Player using removePlayer API of Player component before adding a new Player");e.addWindow(this._playerContainer)},r.prototype.removePlayer=function(){if(!this._executionContext)throw new Error("Player.js cannot remove the player without an execution context");this._executionContext.getComponent(n.DEFAULT_COMPONENT_NAME).getImmersiveFrame().removeWindow(this._playerContainer)},r.prototype.showPlayer=function(){this._playerView||this.createPlayer(),this._playerContainer||this.createPlayerContainer(),this.insertPlayer();let e=this._executionContext.getComponent(WAfrStandardComponentKey.ModelEvents),t=this;e.subscribeOnce({event:"EVT_WAFRPlayExit"},function(){t.hideTimeControlPanel(),t.hidePlayer()})},r.prototype.hidePlayer=function(){this._playerView&&this._playerContainer&&this.removePlayer()},r.prototype.getExposedComponent=function(){var e=this;return{showPlayer:e.showPlayer.bind(e),hidePlayer:e.hidePlayer.bind(e),setUserDefinedSpeed:function(t,n,i){e.setUserDefinedSpeed(t,n,i)},setPlayerSpeed:function(t){e.setPlayerSpeed(t)},setPlayerDuration:function(t){e.setPlayerDuration(t)},setMinMaxDuration:function(t,n){e.setMinMaxDuration(t,n)},setMinMaxFPS:function(t,n){e.setMinMaxFPS(t,n)},setPlayerFPS:function(t){e.setPlayerFPS(t)},setSliderPosition:function(t){e.setSliderPosition(t)},setEditorValue:function(t){e.setEditorValue(t)},showTimeControlPanel:e.showTimeControlPanel.bind(e)}},r}),define("DS/WAfrUIComponents/mod_WelcomeScreenComponent",["DS/WelcomeScreenView/WelcomeScreen","DS/WAfrHandlers/mod_HandlerComponent","DS/WAfrUIComponents/WAfrMRUController","DS/WAfrUIStandardComponents/mod_UIComponent","DS/WAfrUIStandardComponents/UIFrame","DS/WAfrControls/TaskProgressBar","DS/WebUAUtils/WebUAUtils"],function(e,t,n,i,o,r,a){"use strict";function s(e){let t=[];return e.forEach(e=>{let n=new Promise((t,n)=>{require([e],function(e){return t(e)},function(e){return n(e)})});t.push(n)}),t}class l{constructor(e){if(null==e)throw new Error("Options given to the WelcomeScreen component constructor are undefined or null.");this._rawOptions=e,this._welcomeScreenView=void 0,this._welcomeScreenLayer=void 0,this._controller=null,this._onDropHandlerId=void 0,this._tpb=void 0,this._containerDiv=void 0}initialize(){let t={};if(!this._rawOptions)throw Error("A Welcome Screen applicative component has been defined without any options to configure it. Check the declaration of the Welcome Screen component in the application id card.");if(null!==this._rawOptions&&"object"!=typeof this._rawOptions)throw Error("Options given to the Welcome Screen applicative component are not of type Object. Check the declaration of the Welcome Screen component in the application id card.");return Promise.all([Promise.all(s(this._rawOptions.internationalization)),Promise.all(s(this._rawOptions.resources))]).then(n=>{let i=Object.assign({},...n[0]),r=Object.assign({},...n[1].map(e=>JSON.parse(e)));if(t.title=this._parseTitle(i),t.background=this._parseBackground(r),t.background=this._buildAbsoluteResourcePath(t.background),!i.subtitle||"string"!=typeof i.subtitle)throw new Error("A subtitle (of type string) is mandatory when creating a Welcome Screen applicative component.");t.subtitle=i.subtitle,this._rawOptions.guidedTour&&(t.guidedTour=this._parseGuidedTourSection(i,r)),this._rawOptions.linksCategories&&(t.linksCategories=this._parseLinksCategories(i,r)),this._rawOptions.onDrop&&(t.dragAndDrop=this._parseOnDrop(this._rawOptions.onDrop));let a=this.getExecutionContext();t.MRU={onViewModeChange:function(e){let t=a?a.getComponent("AFR_WidgetProxyComponent"):void 0;t&&t.setValue("WelcomeScreenMRUViewMode",e)}.bind(this)};let s,l=a?a.getComponent("AFR_WidgetProxyComponent"):void 0;l&&(s=l.getValue("WelcomeScreenMRUViewMode")),this._rawOptions.MRU&&(s||"string"!=typeof this._rawOptions.MRU.defaultViewMode||(s=this._rawOptions.MRU.defaultViewMode)),s&&(t.MRU.defaultViewMode=s),Promise.all(this._parseButtons()).then(n=>{0!==n.length&&(t.buttons={items:n});let i=a?a.getComponent("AFR_ModelEvents"):void 0;i&&(t.modelEventsComponent=i),this._welcomeScreenView=new e(t);let r=this._welcomeScreenView.getDOM();this._containerDiv=UWA.Element.create("div",{class:"afr-welcome-screen-layer"}),this._containerDiv.appendChild(r);let s=a?a.getComponent(o.DEFAULT_COMPONENT_NAME):void 0;s&&(this._welcomeScreenLayer=s.addLayer(this._containerDiv,{top:0,bottom:0,right:0,left:0,zIndex:5e4})),this.hideWelcomeScreen(),requestAnimationFrame(function(){this._welcomeScreenView&&!this._isWelcomeScreenViewReady&&(i&&i.publish({event:"EVT_WelcomeScreenReady"}),this._isWelcomeScreenViewReady=!0,a&&a.setContext("welcomeScreenViewReady",!0))}.bind(this))},e=>{throw console.error(e),new Error("Issue when setting buttons to the Welcome Screen. Welcome Screen initialization failed!")}).catch(e=>{throw e})},e=>{throw console.error(e.requireModules),console.error(e),new Error("Issue when requiring an internationalization file. Welcome Screen initialization failed!")}).catch(e=>{throw e})}clean(){return this._welcomeScreenLayer&&this._welcomeScreenLayer.remove(),delete this._welcomeScreenView,delete this._isWelcomeScreenViewReady,delete this._welcomeScreenLayer,Promise.resolve()}destroy(){delete this._rawOptions}setMRU(e){if(void 0===this._welcomeScreenView)throw new Error("The WelcomeScreen component has not been initialized yet.");this._controller&&delete this._controller;let i={items:e.items};if(e.hasOwnProperty("defaultViewMode")&&"string"==typeof e.defaultViewMode&&(i.defaultViewMode=e.defaultViewMode),e.hasOwnProperty("onHit")||e.hasOwnProperty("contextualMenu")){let o=this.getExecutionContext();if(o){let r=o.getComponent(t.DEFAULT_COMPONENT_NAME),a=o.getComponent("Afr_UIComponent"),s=a?a.getContextualUIComponentManager():void 0;r&&s&&(this._controller=new n(r,s,e),this._controller.initialize(),i.controller=this._controller.getController())}}e.hasOwnProperty("isLoading")&&"boolean"==typeof e.isLoading&&(i.isLoading=e.isLoading),this._welcomeScreenView.setMRU(i)}showWelcomeScreen(){if(void 0===this._welcomeScreenView)throw new Error("The WelcomeScreen component has not been initialized yet.");let e=this._welcomeScreenView.show();if(e){this._welcomeScreenLayer&&this._welcomeScreenLayer.setStyle("pointer-events","auto");let e=this.getExecutionContext(),t=e?e.getComponent("AFR_ModelEvents"):void 0;t&&t.publish({event:"EVT_WelcomeScreenShown"})}return e}hideWelcomeScreen(){if(void 0===this._welcomeScreenView)throw new Error("The WelcomeScreen component has not been initialized yet.");let e=this._welcomeScreenView.hide();if(e){this._welcomeScreenLayer&&this._welcomeScreenLayer.setStyle("pointer-events","none");let e=this.getExecutionContext(),t=e?e.getComponent("AFR_ModelEvents"):void 0;t&&t.publish({event:"EVT_WelcomeScreenHidden"})}return e}setDragAndDropCallbacks(e){if(void 0===this._welcomeScreenView)throw new Error("The WelcomeScreen component has not been initialized yet.");this._welcomeScreenView.setDndCallbacks(e)}executeOnDrop(e){let n;e.preventDefault();var i=e.dataTransfer.getData("text");if(i)try{n=JSON.parse(i).data.items[0]}catch(e){}let o={dataParam:n,text:i,files:e.dataTransfer.files,items:e.dataTransfer.items,types:e.dataTransfer.types},r=this.getExecutionContext();if(r){let e=r.getComponent(t.DEFAULT_COMPONENT_NAME);e&&this._onDropHandlerId&&e.executeHandler({id:this._onDropHandlerId,args:o});let i=r.getComponent("AFR_ModelEvents");if(i){let e=!(!n||!n.objectId);i.publish({event:"EVT_WelcomeScreenFileDropped",data:{isDropOk:e}})}}}createTaskProgressBar(e){if(void 0===this._welcomeScreenView)throw new Error("The WelcomeScreen component has not been initialized yet.");let t=this._welcomeScreenView.createTPBOverlay(),n=this.getExecutionContext(),i=n?n.getComponent("AFR_ModelEvents"):void 0;if(i&&(e.modelEventsComponent=i),this._tpb){let e=this._tpb.getContent();t.contains(e)&&t.removeChild(e),delete this._tpb}this._tpb=new r(e),t.appendChild(this._tpb.getContent())}setTaskProgressBarValue(e){if(void 0===this._welcomeScreenView)throw new Error("The WelcomeScreen component has not been initialized yet.");if(void 0===this._tpb)throw new Error("The Task Progress Bar component has not been initialized.");this._tpb.value=e}completeTaskProgressBar(){if(void 0===this._welcomeScreenView)throw new Error("The WelcomeScreen component has not been initialized yet.");if(void 0===this._tpb)throw new Error("The Task Progress Bar component has not been initialized.");this._tpb.complete().then(function(){this._welcomeScreenView.removeTPBOverlay()}.bind(this))}resetCustomContent(){if(void 0===this._welcomeScreenView)throw new Error("The WelcomeScreen component has not been initialized yet.");this._welcomeScreenView.resetCustomContentView()}setButtons(e){let t=this._computeButtonsDefinitionFromHandlersId(e);return Promise.all(t).then(e=>{this._welcomeScreenView.setButtons(e)},e=>{throw console.error(e),new Error("Issue when setting buttons to the Welcome Screen. Welcome Screen initialization failed!")}).catch(e=>{throw e})}viewIsReady(){return!!this._isWelcomeScreenViewReady}_computeButtonsDefinitionFromHandlersId(e){let t=this.getExecutionContext(),n=t?t.getComponent(i.DEFAULT_COMPONENT_NAME):void 0,o=[];return e.forEach(e=>{if("handler"!==e.type)throw new Error("Only handler are currently supported to be displayed in the Welcome Screen buttons.");e.hasCustomContent?o.push(n.createDefaultHandlerRepresentation({id:e.id,representationType:"WelcomeScreenButton",hasCustomContent:!0})):o.push(n.createDefaultHandlerRepresentation({id:e.id,representationType:"WelcomeScreenButton"}))}),o}_parseTitle(e){let t="";if(this._rawOptions.title&&"string"==typeof this._rawOptions.title)t=this._rawOptions.title;else{if(null===e||"object"!=typeof e||!e.title||"string"!=typeof e.title)throw new Error("A title (of type string) is mandatory when creating a Welcome Screen applicative component.");t=e.title}return t}_parseBackground(e){let t="";if(this._rawOptions.background&&"string"==typeof this._rawOptions.background)t=this._rawOptions.background;else{if(null===e||"object"!=typeof e||!e.background||"string"!=typeof e.background)throw new Error("A background (of type string) is mandatory when creating a Welcome Screen component.");t=e.background}return t}_buildAbsoluteResourcePath(e){let t="DS/"+e;return require.toUrl(t)}_parseButtons(){let e=null;return e=this._rawOptions.buttons&&"object"==typeof this._rawOptions.buttons&&this._rawOptions.buttons.items&&Array.isArray(this._rawOptions.buttons.items)?this._computeButtonsDefinitionFromHandlersId(this._rawOptions.buttons.items):[]}_parseGuidedTourSection(e,t){let n={};if(null===e||"object"!=typeof e||!e["guidedTour.Title"]||"string"!=typeof e["guidedTour.Title"])throw new Error("When declaring a guided tour, a title (of type string) for it is mandatory.");n.title=e["guidedTour.Title"];let i=[],o=[];if(null===this._rawOptions.guidedTour||"object"!=typeof this._rawOptions.guidedTour||!this._rawOptions.guidedTour.items||!Array.isArray(this._rawOptions.guidedTour.items))throw new Error("When defining a guided tour, at least one page has to be defined.");if(this._rawOptions.guidedTour.items.forEach(n=>{let r=this._parseGuidedTourPage(n,e,t);i.push(r),o.push(r.id)}),new Set(o).size!=o.length)throw new Error("Can't build the guided tour page as one or several pages have the same id.");return n.items=i,n}_parseGuidedTourPage(e,t,n){let i={};if(null===e||"object"!=typeof e)throw new Error("Can't build a guided tour page from an empty or invalid model.");{if(!e.id)throw new Error("Defining a page in the guided tour requires a mandatory id attribute (of type string).");i.id=e.id;let o="guidedTour."+e.id;if(i.title=t[o+".Title"],null!==i.title&&"string"!=typeof i.title)throw new Error("Defining a page in the guided tour requires a mandatory NLS title.");if(i.text=t[o+".ShortHelp"],null!==i.text&&"string"!=typeof i.text)throw new Error("Defining a page in the guided tour requires a mandatory NLS text.");let r=e;if(n.guidedTour&&null!==n.guidedTour[e.id]&&"object"==typeof n.guidedTour[e.id]&&(r=n.guidedTour[e.id]),!r.type||"string"!=typeof r.type)throw new Error("Defining a page in the guided tour requires a mandatory type attribute (of type string).");if(i.type=r.type,"IMAGE"===r.type){if(!r.img||"string"!=typeof r.img)throw new Error("When defining a page in the guided tour with the type IMAGE, an attribute img (of type string) should contain the image path.");i.img=this._buildAbsoluteResourcePath(r.img)}else{if("VIDEO"!==r.type)throw new Error("Only the type IMAGE or VIDEO is supported when defining a guided tour page.");if(!r.video||"string"!=typeof r.video)throw new Error("When defining a page in the guided tour with the type VIDEO, an attribute video (of type string) should contain the video path.");{let e=window.widget?window.widget.lang:"en";i.video=a.getEmbeddedHelpFullPath(r.video,e)}}}return i}_parseLinksCategories(e,t){if(null===this._rawOptions)throw new Error("The Welcome Screen component has been instantiated without options.");if("object"!=typeof this._rawOptions)throw new Error("The options stored by the Welcome Screen component are not of type object.");if(null===e)throw new Error("The i18n object is not defined.");if("object"!=typeof e)throw new Error("The i18n parameter is not of type object.");let n=[];if(this._rawOptions.hasOwnProperty("linksCategories")){if(null===this._rawOptions.linksCategories||"object"!=typeof this._rawOptions.linksCategories||!this._rawOptions.linksCategories.items||!Array.isArray(this._rawOptions.linksCategories.items))throw new Error("When defining links, at least one category with a link should be defined.");this._rawOptions.linksCategories.items.forEach(i=>{if(!i.hasOwnProperty("id"))throw new Error("A link category has been defined without an id.");if("string"!=typeof i.id)throw new Error("A link category should be defined with an id of type string.");if(""===i.id)throw new Error("A link category can't be defined with an empty string id.");let o="linksCategories."+i.id+".Title";if(!e.hasOwnProperty(o)||"string"!=typeof e[o]||""===e[o])throw new Error("A link category title has not been defined or it is not a non empty string.");let r={id:i.id,i18n:{title:e[o]},links:[]};i.links.forEach(n=>{let o=this._parseLink(i.id,n,e,t);r.links.push(o)}),n.push(r)})}return n}_parseLink(e,t,n,i){if("string"!=typeof e)throw new Error("The given category id is not of type string.");if(""===e)throw new Error("The given category is an empty string.");if(null===t)throw new Error("The given link model is null.");if("object"!=typeof t)throw new Error("The given link model is not of type object.");if(!t.hasOwnProperty("id"))throw new Error("The link model doesn't have a property id.");if("string"!=typeof t.id)throw new Error("The link model doesn't have a property id of type string.");if(""===t.id)throw new Error("The link model has id property equals to empty string.");if(null===n)throw new Error("The given i18n object is null.");if("object"!=typeof n)throw new Error("The given i18n parameter is not of type object.");let o=null;if(null!=i&&"object"==typeof i&&i.hasOwnProperty("linksCategories")&&null!==i.linksCategories&&"object"==typeof i.linksCategories){let e=i.linksCategories;e.hasOwnProperty(t.id)&&null!==e[t.id]&&"object"==typeof e[t.id]&&(o=e[t.id])}let r="";if(t.hasOwnProperty("url"))r=t.url;else{if(null===o||!o.hasOwnProperty("url"))throw new Error("A link has been defined without an URL.");r=o.url}if("string"!=typeof r||""===r)throw new Error("The url defined for the link is not valid (should be a non empty string.");let s,l="";if(t.hasOwnProperty("type")?l=t.type:null!==o&&o.hasOwnProperty("type")&&(l=o.type),"string"!=typeof l)throw new Error("The type defined for the link is not valid (should be a string).");if("webhelp"===l){let e=window.widget?window.widget.lang:"en";s=a.getHelpFullPath(r,e)}else if("embeddedwebhelp"===l){let e=window.widget?window.widget.lang:"en";s=a.getEmbeddedHelpFullPath(r,e)}else{if("absolute"!==l&&""!==l)throw new Error("Unknown type for a link.");s=r}let d="",p=!1;if(t.hasOwnProperty("icon")?(d=t.icon,p=!0):null!=o&&o.hasOwnProperty("icon")&&(d=o.icon,p=!0),p&&("string"!=typeof d||""===d))throw new Error("The icon defined for the link is not valid (should be a non empty string.");let c=n["linksCategories."+e+"."+t.id+".Title"];if("string"!=typeof c||""===c)throw new Error("The title of the link is not defined.");return{id:t.id,i18n:{title:c},icon:d,url:s}}_parseOnDrop(e){if("string"!=typeof e)throw new Error("The given handler id is not of type string.");if(""===e)throw new Error("The given handler is an empty string.");return this._onDropHandlerId=e,{callbacks:{}}}}return l.DEFAULT_COMPONENT_NAME="mod_WelcomeScreen",l});