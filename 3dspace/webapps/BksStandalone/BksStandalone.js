define("DS/BksStandalone/Ajax",["DS/WAFData/WAFData","DS/IPClassifyUtil/IPClassifyAlert","DS/IPClassifyUXUtil/private/CredentialsConverter"],(e,t,n)=>{return{getConnectedUser:function(a){var r=new Promise(async r=>{var i=await function(n){var a=new Promise(t=>{var a=n+"/api/v1/services?cors=true&xrequestedwith=xmlhttprequest",r={method:"GET",headers:{Accept:"application/json"},onComplete:e=>{var n=JSON.parse(e).platforms[0].services,a=null;n.every(e=>("space"===e.id&&(a=e.url),!a)),t(a)}};r.onFailure=t.bind(this,!1),r.onTimeout=t.bind(this,!1),e.authenticatedRequest(a,r)});return a.then(e=>{e||t.displayNotification({message:"Provided my apps url doesn't exist",className:"warning"})}),a}(a);if(i){var s=i+"/resources/modeler/pno/person?current=true&select=preferredcredentials&select=collabspaces",o={method:"GET",headers:{Accept:"application/json"},onComplete:e=>{var t=JSON.parse(e),a=n.computeCredentials(t,null,!1);a.user=t.name,r(a)}};o.onFailure=r.bind(this,!1),o.onTimeout=r.bind(this,!1),e.authenticatedRequest(s,o)}else r(null)});return r.then(e=>{e||null===e||t.displayNotification({message:"Can't find the current user",className:"warning"})}),r}}}),define("DS/BksStandalone/utils/Helper",[],()=>({readFromUrl:function(e){let t={},n="OnPremise",a=(e=e||location).host,r=e.pathname.split("/")[1]+"/";if(r.indexOf(".html")>0&&(r=""),e.host.indexOf("-space")>0){n=e.host.split("-")[0].toUpperCase(),a=e.host.replace("-space","-apps")}return t.myAppsUrl="https://"+a+"/"+r+"resources/AppsMngt",t.userId="all",t.securityContext=[""],t.tenantId=n,t}})),define("DS/BksStandalone/Parametrization",["DS/UIKIT/Form","UWA/Controls/Abstract","DS/Controls/Button"],(e,t,n)=>t.extend({defaultOptions:{oneTry:!1},init:function(){this._parent.apply(this,arguments),this.elements.container=UWA.createElement("div")},render:function(t){let a=[];for(var r in t){let e=t[r];var i={type:"boolean"==typeof e?"boolean":"text",name:r,label:r,value:e};if(Array.isArray(e)){i.type="select";let t=[];e.forEach(e=>{t.push({label:e,value:e})}),i.options=t,i.value=e[0]}a.push(i)}var s=this.elements.form=new e({className:"horizontal",grid:"3 9",fields:a});s.inject(this.elements.container),s.addEvent("onChange",(e,t,n)=>{this.dispatchEvent("onChange",[e,t,n])});var o=new n({label:"execute",onClick:e=>{var n=s.getValues();for(var a in n)"boolean"==typeof t[a]&&(n[a]="true"===n[a]);this.options.oneTry&&o.setProperties({disabled:!0}),this.dispatchEvent("execute",n)}});return o.inject(this.elements.container),this},updateValues:function(e){for(var t in e)if(Array.isArray(e[t])){var n=this.elements.form.getListInput(t),a=[];e[t].forEach(e=>{a.push({label:e,value:e})}),n.remove(),n.add(a),n.setValue(a[0]),delete e[t]}this.elements.form.setValues(e)}})),define("DS/BksStandalone/Standalone",["DS/BksStandalone/Parametrization","DS/Skeleton/SkeletonLayout","DS/BksStandalone/Ajax","DS/BksStandalone/utils/Helper","css!DS/BksStandalone/BksStandalone.css","css!DS/UIKIT/UIKIT.css"],(Parametrization,SkeletonLayout,Ajax,Helper)=>{var parameters={};function buildHistory(){var e=UWA.createElement("div",{class:"eventHistory"});UWA.createElement("div",{text:"Events",styles:{"font-weight":"bold","text-align":"center"}}).inject(e);var t=UWA.createElement("div");return t.inject(e),window.dscef={sendString:e=>{var n=e;try{if(!(n=JSON.parse(e)).event){var a={event:"",content:""};for(var r in n)a.event+=r,a.content+=n[r];n=a}}catch(t){var i=e.indexOf("=");i>0&&(n={event:e.substr(0,i),content:JSON.parse(e.substr(i+1))})}var s=UWA.createElement("div");UWA.createElement("div",{styles:{"font-weight":"bold"},text:n.event}).inject(s),UWA.createElement("pre",{text:JSON.stringify(n.content,void 0,2)}).inject(s),s.inject(t,"top")},getEnv:e=>{if("MX_ONLINE_INSTANCE"===e)return parameters.tenantId}},e}function buildAPIsSelector(){if(window.exportCmd){let elements=[];for(var key in window.exportCmd)elements.push(key);var apiSelector=new Parametrization;return apiSelector.getContent().addClassName("APISelector"),apiSelector.render({API:elements,arguments:""}).addEvent("execute",value=>{var list=value.arguments.split("|"),finalList=[];list.forEach(e=>{var t=e;try{t=JSON.parse(e)}catch(e){}finalList.push(t)}),eval(value.API+".apply(null,"+JSON.stringify(finalList)+")")}),apiSelector}}function computeParams(e){return new Promise(async t=>{var n={},a=await Ajax.getConnectedUser(e);if(a){n.userId=a.user;var r=[];a.credentials.forEach(e=>{r.push(e.translate.value)}),n.securityContext=r}t(n)})}function getI18NAPIs(){return new Promise(e=>{require(["DS/UWPClientCode/I18n"],e)})}return e=>{var t=UWA.createElement("div",{class:"leftContainer",styles:{padding:"10px","text-align":"left"}}),n=UWA.createElement("div",{class:"widgetContainer"});widget.body=n,document.body.getElement("#tempDiv").inject(widget.body);let a=new SkeletonLayout({leftContainerContent:t,centerContainerContent:n,leftContainerCollapsedFlag:!1,leftContainerWidth:document.body.clientWidth/4,leftContainerMinWidth:50,leftContainerMaxWidth:document.body.clientWidth/2,navigationContainerVisibleFlag:!1,idCardContainerVisibleFlag:!1,statusContainerVisibleFlag:!1,identifier:"StandaloneLayout"});return a.getContent().addClassName("standaloneLayout"),a.inject(document.body),new Promise(async n=>{var a=new Parametrization({oneTry:!0}),r={};for(var i in e.myAppsUrl||(r=Helper.readFromUrl()),e)r[i]=e[i];var s=await computeParams(r.myAppsUrl);for(var i in s)r[i]=s[i];r.lang||(r.lang="en"),a.inject(t).render(r).addEvent("execute",async e=>{console.log("Parameters sent to the widget: "),console.log(e),window.dsLang=e.lang?e.lang:navigator.language,(await getI18NAPIs()).setCurrentLanguage(window.dsLang,!0),window.COMPASS_CONFIG={myAppsBaseUrl:e.myAppsUrl,userId:e.userId,lang:window.dsLang},parameters=e,n(e)}),a.getContent().addClassName("paramSelector"),a.addEvent("onChange",async(e,t)=>{if("myAppsUrl"===e){var n=await computeParams(t);a.updateValues(n)}});var o=buildAPIsSelector();o&&o.inject(t),buildHistory().inject(t)})}});