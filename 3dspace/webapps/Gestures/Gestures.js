define("DS/Gestures/BasicGesture",["UWA/Class","DS/Visualization/ThreeJS_DS","DS/CoreEvents/Events"],function(t,e,i){"use strict";var s=0,n=0,a=t.extend({init:function(t){return this.name=t||"",this.id=s++,this.view=[],this.priority=1e3,this._order=0,this._needsUpdate=!1,this.currentEvent=null,this.events=[],this.debugEvents=!1,this.state=a.State.INIT,this.firstChange=!1,this.lastChange=!1,this.gestures=[],this.requiredBy=0,this.maskedBy=[],this.callbacks=[],this.action="",this},setView:function(t){if(t)if(t instanceof Array){this.view=[];for(var e=0;e<t.length;e++)this.view.push(t[e])}else this.view=[t]},setAction:function(t){this.action=t},addView:function(t){t&&this.view.push(t)},removeView:function(t){if(t){var e=this.view.indexOf(t);-1!==e&&this.view.splice(e,1)}},resetView:function(){this.view=[]},setPriority:function(t){this.priority=t},requireGesture:function(t){this.gestures.push(t),t.requiredBy++,this._needsUpdate=!0},maskGesture:function(t){null!==t&&t.maskedBy.push(this)},addCallback:function(t){if("function"==typeof t){for(var e=0;e<this.callbacks.length;e++)if(this.callbacks[e].cb===t)return this.callbacks[e].uid;var i=this._getEventID();return this.callbacks.push({cb:t,uid:i}),i}return null},removeCallback:function(t){if("function"==typeof t)for(var e=0;e<this.callbacks.length;e++)if(this.callbacks[e].cb===t)return this.callbacks[e].cb=null,!0;return!1},removeCallbackFromToken:function(t){for(var e=0;e<this.callbacks.length;e++)if(this.callbacks[e].uid===t&&this.callbacks[e].cb)return this.callbacks[e].cb=null,!0;return!1},executeCallbacks:function(t){var e,i=!1,s=this.callbacks.slice();for(e=0;e<s.length;e++)s[e].cb?s[e].cb.call(this,t):i=!0;i&&this._updateCBArray()},_updateCBArray:function(){if(this.callbacks.length){for(var t=[],e=0;e<this.callbacks.length;e++)this.callbacks[e].cb&&t.push(this.callbacks[e]);this.callbacks=t}},_getEventID:function(){var t=this.id+"_"+n;return n++,t},isUsed:function(){return this.callbacks.length||this.requiredBy},_dispose:function(t){if(this._updateCBArray(),!this.isUsed()){for(var e=0;e<this.gestures.length;e++)this.gestures[e].requiredBy--,!this.gestures[e].requiredBy&&this.gestures[e]._dispose(t);t&&t.apply(this),this.view=[]}},detect:function(t){this.currentEvent=t},execute:function(t){if(this.state===a.State.OK||this.state===a.State.CHANGE){if(!t)for(var e=0;e<this.maskedBy.length;e++){var i=this.maskedBy[e];if(i.state===a.State.OK||i.state===a.State.CHANGE)return}this.triggerEvent(this.currentEvent)}},update:function(){switch(this.state){case a.State.KO:case a.State.OK:case a.State.CANCEL:this.changeState(a.State.INIT);break;case a.State.CHANGE:this.lastChange&&(this.lastChange=!1,this.changeState(a.State.INIT))}},setDebugEvents:function(t){this.debugEvents=t},changeState:function(t,e){this.firstChange=this.state===a.State.BEGIN&&t===a.State.CHANGE,this.lastChange=!!e,this.state=t,this.debugEvents>=5&&console.log("Gesture "+this.name+" change state to "+a.printState(this.state))},getState:function(){return this.state},getName:function(){return this.name},getEvents:function(){return this.events},triggerEvent:function(){var t={eventChannel:"/VISU/",eventType:"@on"+this.name+"Event",eventID:this.id,from:this.currentEvent,gesture:this,state:this.firstChange?"begin":this.lastChange?"end":""};switch(this.debugEvents){case 0:case 1:break;case 2:this.state===a.State.OK&&console.log(t);break;case 3:this.state===a.State.CHANGE&&console.log(t);break;case 4:case 5:case 6:console.log(t)}i.publish({event:"/VISU/on"+this.name,data:t}),a.RecordEventsManager&&(window.WebVisuCurrentGesture=this),this.executeCallbacks(t),a.RecordEventsManager&&(window.WebVisuCurrentGesture=null),a.RecordEventsManager&&a.RecordEventsManager.recordBasicGesture(this)},getElapsedTime:function(){return this.getEvents().length>0?this.getEvents()[0].currentTime-this.getEvents()[0].startTime:null}});return a.State={INIT:0,BEGIN:1,CHANGE:2,OK:3,KO:4,CANCEL:5},a.printState=function(t){switch(t){case a.State.INIT:return"INIT";case a.State.BEGIN:return"BEGIN";case a.State.CHANGE:return"CHANGE";case a.State.OK:return"OK";case a.State.KO:return"KO";case a.State.CANCEL:return"CANCEL";default:return""}},a.RecordEventsManager=null,a.setRecordEventsManager=function(t){this.RecordEventsManager=t},UWA.namespace("THREEDS/Gestures/BasicGesture",a)}),define("Gestures/BasicGesture",["DS/Gestures/BasicGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/BasicGesture"),t}),define("DS/Gestures/SmartEditGesture",["DS/CoreEvents/Events","DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture","DS/WebRecordEnabler/Adapter"],function(t,e,i,s,n){"use strict";var a=s.extend({init:function(){return this._parent("SmartEdit"),this.priority=10,this.identifier=null,this.maxTimeTouch=300,this.maxTimeMouse=300,this.maxDistance=10,this.timer=null,this._type=-1,this.event=null,this},detect:function(t){this._parent(t);var e=this,a=THREEDS.VisuEventsManager.getTouchEventsByStates([i.State.BEGIN,i.State.MOVE,i.State.IDLE]),r=THREEDS.VisuEventsManager.getMouseEvents(null,this.view),h=null;switch(this.state){case s.State.INIT:if(1===a.length||this.onlyLeftMouse(r))if(this.resetTimer(),1===a.length?(h=THREEDS.VisuEventsManager.getTouchEventsByStates([i.State.BEGIN],this.view),this._type=1):r.length&&(h=THREEDS.VisuEventsManager.getMouseEventsByStates([i.State.BEGIN],0,this.view),this._type=0),h&&1===h.length){this.resetTimer();var u=1===this._type?this.maxTimeTouch:this.maxTimeMouse;this.identifier=h[0].identifier,this.event=h[0],u?(n.isReplaying()||(this.timer=setTimeout(function(){e.events=[h[0]],e.changeState(s.State.OK),e.execute(!0),e._type=-1},u)),this.changeState(s.State.BEGIN)):(this.events=[h[0]],this.changeState(s.State.OK),this._type=-1)}else this._type=-1;break;case s.State.BEGIN:var o=null;1===this._type?o=THREEDS.VisuEventsManager.getTouchEventById(this.identifier):0===this._type&&(o=this.event),1===this._type&&1!==a.length||0===this._type&&!this.onlyLeftMouse(r)||null===o||o.state===i.State.END?(this.resetTimer(),this.changeState(s.State.KO)):o.state===i.State.MOVE&&o.offsetPosition.length()>this.maxDistance&&(this.events=[o],this.changeState(s.State.OK),this._type=-1);break;case s.State.KO:case s.State.OK:case s.State.CANCEL:this.changeState(s.State.INIT)}},onlyLeftMouse:function(t){for(var e=0;e<t.length;e++)if(0!==t[e].button&&-1!==t[e].button)return!1;return!0},resetTimer:function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null,this._type=-1)},whenKO:function(){this.resetTimer(),this.changeState(s.State.KO)}});return UWA.namespace("THREEDS/Gestures/SmartEditGesture",a)}),define("DS/Gestures/DragGesture",["DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture","DS/Visualization/ThreeJS_DS"],function(t,e,i){"use strict";var s=e.extend({init:function(){return this._parent("Drag"),this.priority=10,this.identifier=null,this.minDistance=10,this},detect:function(i){switch(this._parent(i),this.state){case e.State.INIT:this.identifier=null;var s=THREEDS.VisuEventsManager.getPrimaryPointerEventsByStates([t.State.BEGIN],this.view);1===s.length&&("Touch"===s[0].type&&(this.identifier=s[0].identifier),this.changeState(e.State.BEGIN));break;case e.State.BEGIN:var n=null;if(null!==this.identifier)1===THREEDS.VisuEventsManager.getTouchEvents(this.view).length&&(n=THREEDS.VisuEventsManager.getTouchEventById(this.identifier));else 1===(h=THREEDS.VisuEventsManager.getMouseEvents(null,this.view,!0)).length&&h[0].getButton()===t.MouseButton.LEFT&&(n=h[0]);if(n)if(n.offsetPosition.length()>this.minDistance){var a=n.getState()===t.State.END,r=i[0].getJSEvent();!a&&r.preventDefault&&r.preventDefault(),this.events=[n],this.changeState(e.State.CHANGE)}else n.getState()===t.State.END&&this.changeState(e.State.KO);else this.changeState(e.State.KO);break;case e.State.CHANGE:var h;n=null;if(null!==this.identifier)1===THREEDS.VisuEventsManager.getTouchEvents(document).length&&(n=THREEDS.VisuEventsManager.getTouchEventById(this.identifier));else 1===(h=THREEDS.VisuEventsManager.getMouseEvents(null,document,!0)).length&&h[0].getButton()===t.MouseButton.LEFT&&(n=h[0]);if(n){a=n.getState()===t.State.END,r=i[0].getJSEvent();!a&&r.preventDefault&&r.preventDefault(),this.events=[n],this.changeState(e.State.CHANGE,a)}else this.changeState(e.State.KO);break;case e.State.KO:case e.State.OK:case e.State.CANCEL:this.changeState(e.State.INIT),this.identifier=null}},getTouchPoint:function(){return this.getEvents().length>0?this.getEvents()[0].getCurrentPosition():null},getDistanceFromOrigin:function(){return this.getEvents().length>0?this.getEvents()[0].getOffsetPosition().length():null},getLastTraveledDistance:function(){return this.getEvents().length>0?this.getEvents()[0].getDeltaPosition().length():null},getTotalTraveledDistFromOrigin:function(){return this.getEvents().length>0?this.getEvents()[0].getTraveledDistance():null},getLastTraveledVector:function(){return this.getEvents().length>0?this.getEvents()[0].getDeltaPosition():null},getDirectionFromOrigin:function(){return this.getEvents().length>0?this.getEvents()[0].getOffsetPosition():null}});return UWA.namespace("THREEDS/Gestures/DragGesture",s)}),define("DS/Gestures/HoldStayGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture","DS/WebRecordEnabler/Adapter"],function(t,e,i,s){"use strict";var n=i.extend({init:function(){return this._parent("HoldStay"),this.priority=11,this.identifier=null,this.maxTime=THREEDS.VisuEventsManager.getHoldTime(),this.stayTimerTime=100,this.maxDistance=10,this.timer=null,this.stayTimer=null,this.startTime=0,this.endTime=0,this},detect:function(t){this._parent(t);var n=this;switch(this.state){case i.State.INIT:1===(a=THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN,e.State.MOVE,e.State.IDLE])).length&&(this.resetAllTimers(),1===(a=THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN],this.view)).length&&(this.identifier=a[0].identifier,s.isReplaying()||(this.timer=setTimeout(function(){n.events=[a[0]],n.endTime=(new Date).getTime(),n.changeState(i.State.CHANGE),n.stayTimer=setInterval(function(){n.events=[a[0]],n.endTime=(new Date).getTime(),n.changeState(i.State.CHANGE),n.execute(!0)},n.stayTimerTime),n.execute(!0)},this.maxTime)),this.startTime=a[0].startTime,this.changeState(i.State.BEGIN)));break;case i.State.BEGIN:var a=THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN,e.State.MOVE,e.State.IDLE]),r=THREEDS.VisuEventsManager.getTouchEventById(this.identifier);1!==a.length||null===r||r.state===e.State.END?(this.resetAllTimers(),this.changeState(i.State.KO)):r.state===e.State.MOVE&&r.offsetPosition.length()>this.maxDistance&&(this.resetAllTimers(),this.changeState(i.State.KO));break;case i.State.CHANGE:a=THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN,e.State.MOVE,e.State.IDLE]),r=THREEDS.VisuEventsManager.getTouchEventById(this.identifier);1!==a.length||null===r||r.state===e.State.END?(this.resetAllTimers(),this.changeState(i.State.KO)):r.state===e.State.MOVE&&(r.offsetPosition.length()>this.maxDistance?(this.resetAllTimers(),this.changeState(i.State.KO)):this.events=[r]);break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this.startTime=0,this.endTime=0,this.changeState(i.State.INIT)}},resetTimer:function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},resetStayTimer:function(){null!==this.stayTimer&&(clearInterval(this.stayTimer),this.stayTimer=null)},resetAllTimers:function(){this.resetStayTimer(),this.resetTimer()},getTouchPoint:function(){return this.getEvents().length>0?this.getEvents()[0].getCurrentPosition():null},getElapsedTime:function(){return this.getEvents().length>0?this.endTime-this.startTime:null}});return UWA.namespace("THREEDS/Gestures/HoldStayGesture",n)}),define("Gestures/HoldStayGesture",["DS/Gestures/HoldStayGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/HoldStayGesture"),t}),define("DS/Gestures/HoldGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture","DS/WebRecordEnabler/Adapter"],function(t,e,i,s){"use strict";var n=i.extend({init:function(){return this._parent("Hold"),this.priority=10,this.identifier=null,this.maxTime=THREEDS.VisuEventsManager.getHoldTime(),this.maxDistance=10,this.timer=null,this.startTime=0,this.endTime=0,this},detect:function(t){this._parent(t);var n=this;switch(this.state){case i.State.INIT:1===(a=THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN,e.State.MOVE,e.State.IDLE])).length&&(this.resetTimer(),1===(a=THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN],this.view)).length&&(this.identifier=a[0].identifier,s.isReplaying()||(this.timer=setTimeout(function(){n.events=[a[0]],n.endTime=(new Date).getTime(),n.changeState(i.State.OK),n.execute(!0)},this.maxTime)),this.startTime=a[0].startTime,this.changeState(i.State.BEGIN)));break;case i.State.BEGIN:var a=THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN,e.State.MOVE,e.State.IDLE]),r=THREEDS.VisuEventsManager.getTouchEventById(this.identifier);1!==a.length||null===r||r.state===e.State.END?(this.resetTimer(),this.changeState(i.State.KO)):r.state===e.State.MOVE&&r.offsetPosition.length()>this.maxDistance&&(this.resetTimer(),this.changeState(i.State.KO));break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this.changeState(i.State.INIT)}},resetTimer:function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},getTouchPoint:function(){return this.getEvents().length>0?this.getEvents()[0].getCurrentPosition():null},getElapsedTime:function(){return this.getEvents().length>0?this.endTime-this.startTime:null}});return UWA.namespace("THREEDS/Gestures/HoldGesture",n)}),define("Gestures/HoldGesture",["DS/Gestures/HoldGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/HoldGesture"),t}),define("DS/Gestures/MouseDownGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(t,e,i){"use strict";var s=i.extend({init:function(t){return this._parent(e.printMouseButton(t)+"MouseDown"),this.priority=0,this.button=t,this},detect:function(t){switch(this._parent(t),this.state){case i.State.INIT:var s=THREEDS.VisuEventsManager.getMouseEventsByStates([e.State.BEGIN],this.button,this.view);if(s.length){var n=s[0];return this.events=[n],void this.changeState(i.State.OK)}break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this.changeState(i.State.INIT)}}});return UWA.namespace("THREEDS/Gestures/MouseDownGesture",s)}),define("Gestures/MouseDownGesture",["DS/Gestures/MouseDownGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/MouseDownGesture"),t}),define("DS/Gestures/EditGesture",["DS/CoreEvents/Events","DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture","DS/WebRecordEnabler/Adapter"],function(t,e,i,s,n){"use strict";var a=s.extend({init:function(){return this._parent("Edit"),this.priority=10,this.identifier=null,this.maxTimeTouch=THREEDS.VisuEventsManager.getHoldTime(),this.maxTimeMouse=THREEDS.VisuEventsManager.getHoldTime(),this.maxDistance=10,this.timer=null,this._type=-1,this.event=null,this},detect:function(t){this._parent(t);var e=this,a=THREEDS.VisuEventsManager.getTouchEventsByStates([i.State.BEGIN,i.State.MOVE,i.State.IDLE]),r=THREEDS.VisuEventsManager.getMouseEvents(null,this.view),h=null;switch(this.state){case s.State.INIT:if(1===a.length||this.onlyLeftMouse(r))if(this.resetTimer(),1===a.length?(h=THREEDS.VisuEventsManager.getTouchEventsByStates([i.State.BEGIN],this.view),this._type=1):r.length&&(h=THREEDS.VisuEventsManager.getMouseEventsByStates([i.State.BEGIN],0,this.view),this._type=0),h&&1===h.length){this.resetTimer();var u=1===this._type?this.maxTimeTouch:this.maxTimeMouse;this.identifier=h[0].identifier,this.event=h[0],u?(n.isReplaying()||(this.timer=setTimeout(function(){e.events=[h[0]],e.changeState(s.State.OK),e.execute(!0),e._type=-1},u)),this.whenBegin()):(this.events=[h[0]],this.changeState(s.State.OK),this.execute(!0),this._type=-1)}else this._type=-1;break;case s.State.BEGIN:var o=null;1===this._type?o=THREEDS.VisuEventsManager.getTouchEventById(this.identifier):0===this._type&&(o=this.event),1===this._type&&1!==a.length||0===this._type&&!this.onlyLeftMouse(r)||null===o||o.state===i.State.END?this.whenKO():o.state===i.State.MOVE&&o.offsetPosition.length()>this.maxDistance&&this.whenKO();break;case s.State.KO:case s.State.OK:case s.State.CANCEL:this.changeState(s.State.INIT)}},onlyLeftMouse:function(t){for(var e=0;e<t.length;e++)if(0!==t[e].button&&-1!==t[e].button)return!1;return!0},setTimerTouch:function(t){this.maxTimeTouch=t},setTimerMouse:function(t){this.maxTimeMouse=t},resetTimer:function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null,this._type=-1)},whenBegin:function(){this.changeState(s.State.BEGIN);var e={eventChannel:"/VISU/",eventType:"@onEditEventBegin",eventID:this.id,from:this.currentEvent,gesture:this};t.publish({event:"/VISU/onEditEventBegin",data:e})},whenKO:function(){this.resetTimer(),this.changeState(s.State.KO);var e={eventChannel:"/VISU/",eventType:"@onEditEventKO",eventID:this.id,from:this.currentEvent,gesture:this};t.publish({event:"/VISU/onEditEventKO",data:e})}});return UWA.namespace("THREEDS/Gestures/EditGesture",a)}),define("Gestures/EditGesture",["DS/Gestures/EditGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/EditGesture"),t}),define("DS/Gestures/HoldTapGesture",["DS/Gestures/BasicGesture","DS/VisuEvents/ScreenEvent"],function(t,e){"use strict";var i=t.extend({init:function(){return this._parent("HoldTap"),this.priority=12,this.identifier_0=-1,this.identifier_1=-1,this._holdElapsedTime=0,this.maxDistance=10,this.maxTime=300,this},changeStateToKO:function(){this.clearStateVariable(),this.changeState(t.State.KO)},clearStateVariable:function(){this.identifier_0=-1,this.identifier_1=-1,this._holdElapsedTime=0},validateOkTapCondition:function(t){return null!==t&&(t.offsetPosition.length()<=this.maxDistance&&t.currentTime-t.startTime<=this.maxTime)},validateKoTapCondition:function(t){return null!==t&&(t.offsetPosition.length()>this.maxDistance||t.currentTime-t.startTime>this.maxTime)},detect:function(i){switch(this._parent(i),this.state){case t.State.INIT:var s=THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN,e.State.MOVE,e.State.IDLE]);if(2===s.length){var n=-1;s[0].getState()==e.State.IDLE?n=0:s[1].getState()==e.State.IDLE&&(n=1),-1!==n&&s[n].getOffsetPosition().length()<this.maxDistance&&(s[1-n].getState()!=e.State.BEGIN&&s[1-n].getState()!=e.State.MOVE||(this.identifier_0=s[n].getIdentifier(),this.identifier_1=s[1-n].getIdentifier(),this.changeState(t.State.BEGIN)))}break;case t.State.BEGIN:if(2!==THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN,e.State.MOVE,e.State.IDLE,e.State.END]).length){this.changeStateToKO();break}var a=THREEDS.VisuEventsManager.getTouchEventById(this.identifier_0),r=THREEDS.VisuEventsManager.getTouchEventById(this.identifier_1);if(null===a||null===r){this.changeStateToKO();break}if(a.getState()===e.State.IDLE&&a.getOffsetPosition().length()<this.maxDistance){if(r.getState()===e.State.END&&this.validateOkTapCondition(r)){this._holdElapsedTime=r.currentTime-a.startTime,this.events=[a,r],this.changeState(t.State.OK);break}if(r.getState()==e.State.MOVE&&this.validateKoTapCondition(r)){this.changeStateToKO();break}}else if(a.getState()==e.State.END||e.State.BEGIN){this.changeStateToKO();break}break;case t.State.KO:case t.State.OK:case t.State.CANCEL:this.clearStateVariable(),this.changeState(t.State.INIT)}},getFirstTouchPosition:function(){return 2===this.getEvents().length?this.getEvents()[0].getCurrentPosition():null},getSecondTouchPosition:function(){return 2===this.getEvents().length?this.getEvents()[1].getCurrentPosition():null},getGestureStartTime:function(){return 2===this.getEvents().length?this.getEvents()[0].startTime:null},getHoldElapsedTime:function(){return this._holdElapsedTime},getTapElapsedTime:function(){return 2===this.getEvents().length?this.getEvents()[1].currentTime-this.getEvents()[1].startTime:null},getElapsedTime:function(){return 2===this.getEvents().length?this.getEvents()[1].currentTime-this.getEvents()[0].startTime:null}});return UWA.namespace("THREEDS/Gestures/HoldTapGesture",i)}),define("Gestures/HoldTapGesture",["DS/Gestures/HoldTapGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/HoldTapGesture"),t}),define("DS/Gestures/RotateGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(t,e,i){"use strict";var s=i.extend({init:function(){return this._parent("Rotate"),this.priority=10,this.touches=[],this.fingersVector=new t.Vector2,this.latencyTime=200,this.initTime=0,this.distance=null,this.lastDistance=0,this.initDistance=0,this.distanceMax=10,this.orientation=null,this.lastOrientation=0,this.deltaOrientation=0,this.initOrientation=0,this.orientationMin=.1,this.barycenter=null,this.lastBarycenter=new t.Vector2,this.initBarycenter=new t.Vector2,this},detect:function(s){if(this.touches=THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN,e.State.MOVE,e.State.IDLE,e.State.END],this.view),2===this.touches.length){var n=s[0].getJSEvent();n.preventDefault&&n.preventDefault(),this.fingersVector.subVectors(this.touches[1].currentPosition,this.touches[0].currentPosition),null===this.distance&&(this.distance=this.fingersVector.length()),null===this.orientation&&(this.orientation=Math.atan2(this.fingersVector.y,this.fingersVector.x)),null===this.barycenter&&(this.barycenter=new t.Vector2,this.barycenter.addVectors(this.touches[0].currentPosition,this.touches[1].currentPosition),this.barycenter.multiplyScalar(.5)),this.lastDistance=this.distance,this.distance=this.fingersVector.length(),this.lastOrientation=this.orientation,this.orientation=Math.atan2(this.fingersVector.y,this.fingersVector.x),this.deltaOrientation=this.orientation-this.lastOrientation;var a=this.deltaOrientation>=0?1:-1;a*=2*Math.PI,Math.abs(this.deltaOrientation-a)<Math.abs(this.deltaOrientation)&&(this.deltaOrientation-=a),this.lastBarycenter.copy(this.barycenter),this.barycenter.addVectors(this.touches[0].currentPosition,this.touches[1].currentPosition),this.barycenter.multiplyScalar(.5)}switch(this.state){case i.State.INIT:2===this.touches.length&&(this.initTime=(new Date).getTime(),this.initDistance=this.distance,this.initOrientation=this.orientation,this.initBarycenter.copy(this.barycenter),this.changeState(i.State.BEGIN));break;case i.State.BEGIN:if(2===THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN,e.State.MOVE,e.State.IDLE],this.view).length){var r=Math.abs(this.orientation-this.initOrientation);r=Math.min(r,Math.abs(r-2*Math.PI)),Math.abs(this.distance-this.initDistance)<this.distanceMax&&r>this.orientationMin&&(this.events=this.touches,this.changeState(i.State.CHANGE))}else this.changeState(i.State.KO);break;case i.State.CHANGE:if(2===this.touches.length){var h=this.touches[0].getState()===e.State.END||this.touches[1].getState()===e.State.END;this.events=this.touches,this.changeState(i.State.CHANGE,h)}else this.changeState(i.State.KO);break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this.changeState(i.State.INIT),this.touches=[],this.distance=null,this.orientation=null,this.barycenter=null}},getAngle:function(){return this.orientation||0},getDeltaAngle:function(){return this.deltaOrientation},getFirstTouchPosition:function(t){return 2===this.getEvents().length?this.getEvents()[0].getCurrentPosition():null},getSecondTouchPosition:function(t){return 2===this.getEvents().length?this.getEvents()[1].getCurrentPosition():null},getOriginDirection:function(t){if(2===this.getEvents().length){var e=this.getEvents()[1].getStartPosition();return e.sub(this.getEvents()[0].getStartPosition()),e}return null},getCurrentDirection:function(t){if(2===this.getEvents().length){var e=this.getEvents()[1].getCurrentPosition();return e.sub(this.getEvents()[0].getCurrentPosition()),e}return null},getLastDirection:function(t){if(2===this.getEvents().length){var e=this.getEvents()[1].getLastPosition();return e.sub(this.getEvents()[0].getLastPosition()),e}return null}});return UWA.namespace("THREEDS/Gestures/RotateGesture",s)}),define("Gestures/RotateGesture",["DS/Gestures/RotateGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/RotateGesture"),t}),define("DS/Gestures/LongEditGesture",["DS/Gestures/EditGesture"],function(t){"use strict";var e=t.extend({init:function(){return this._parent(),this.priority=100,this.name="LongEdit",this.maxTimeTouch=1e3,this.maxTimeMouse=1e3,this},detect:function(t){this._parent(t)}});return UWA.namespace("THREEDS/Gestures/LongEditGesture",e)}),define("Gestures/LongEditGesture",["DS/Gestures/LongEditGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/LongEditGesture"),t}),define("DS/Gestures/PanGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(t,e,i){"use strict";var s=new t.Vector2,n=i.extend({init:function(){return this._parent("Pan"),this.priority=10,this.touches=[],this.fingersVector=new t.Vector2,this.latencyTime=200,this.initTime=0,this.distance=null,this.lastDistance=0,this.initDistance=0,this.distanceMax=10,this.orientation=null,this.lastOrientation=0,this.initOrientation=0,this.orientationMax=.1,this.barycenter=null,this.lastBarycenter=new t.Vector2,this.initBarycenter=new t.Vector2,this.barycenterMin=10,this},detect:function(n){if(this.touches=THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN,e.State.MOVE,e.State.IDLE,e.State.END],this.view),2===this.touches.length){var a=n[0].getJSEvent();a.preventDefault&&a.preventDefault(),this.fingersVector.subVectors(this.touches[1].currentPosition,this.touches[0].currentPosition),null===this.distance&&(this.distance=this.fingersVector.length()),null===this.orientation&&(this.orientation=Math.acos(Math.min(Math.max((this.touches[1].currentPosition.x-this.touches[0].currentPosition.x)/this.distance,-1),1))),null===this.barycenter&&(this.barycenter=new t.Vector2,this.barycenter.addVectors(this.touches[0].currentPosition,this.touches[1].currentPosition),this.barycenter.multiplyScalar(.5)),this.lastDistance=this.distance,this.distance=this.fingersVector.length(),this.lastOrientation=this.orientation,this.orientation=Math.acos(Math.min(Math.max((this.touches[1].currentPosition.x-this.touches[0].currentPosition.x)/this.distance,-1),1)),this.lastBarycenter.copy(this.barycenter),this.barycenter.addVectors(this.touches[0].currentPosition,this.touches[1].currentPosition),this.barycenter.multiplyScalar(.5)}switch(this.state){case i.State.INIT:2===this.touches.length&&(this.initTime=(new Date).getTime(),this.initDistance=this.distance,this.initOrientation=this.orientation,this.initBarycenter.copy(this.barycenter),this.changeState(i.State.BEGIN));break;case i.State.BEGIN:2===THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN,e.State.MOVE,e.State.IDLE],this.view).length?(s.copy(this.initBarycenter),Math.abs(this.distance-this.initDistance)<this.distanceMax&&Math.abs(this.orientation-this.initOrientation)<this.orientationMax&&s.sub(this.barycenter).length()>this.barycenterMin&&(this.events=this.touches,this.changeState(i.State.CHANGE))):this.changeState(i.State.KO);break;case i.State.CHANGE:if(2===this.touches.length){var r=this.touches[0].getState()===e.State.END||this.touches[1].getState()===e.State.END;this.events=this.touches,this.changeState(i.State.CHANGE,r)}else this.changeState(i.State.KO);break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this.changeState(i.State.INIT),this.touches=[],this.distance=null,this.orientation=null,this.barycenter=null}},getFirstTouchPosition:function(t){return 2===this.getEvents().length?this.getEvents()[0].getCurrentPosition():null},getSecondTouchPosition:function(t){return 2===this.getEvents().length?this.getEvents()[1].getCurrentPosition():null},getDistanceFromOrigin:function(){if(this.getEvents().length>0){var t=this.getEvents()[0].getCurrentPosition();return t.sub(this.getEvents()[0].getStartPosition()),t.length()}return null},getLastTraveledDistance:function(){if(this.getEvents().length>0){var t=this.getEvents()[0].getCurrentPosition();return t.sub(this.getEvents()[0].getLastPosition()),t.length()}return null},getTotalTraveledDistFromOrigin:function(){return this.getEvents().length>0?this.getEvents()[0].getTraveledDistance():null},getLastTraveledVector:function(){if(this.getEvents().length>0){var t=this.getEvents()[0]._currentPosition.clone();return t.sub(this.getEvents()[0]._lastPosition),t}return null},getDirectionFromOrigin:function(){if(this.getEvents().length>0){var t=this.getEvents()[0]._currentPosition.clone();return t.sub(this.getEvents()[0]._startPosition),t}return null}});return UWA.namespace("THREEDS/Gestures/PanGesture",n)}),define("Gestures/PanGesture",["DS/Gestures/PanGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/PanGesture"),t}),define("DS/Gestures/HoldMouseDownGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture","DS/Gestures/MouseDownGesture","DS/WebRecordEnabler/Adapter"],function(t,e,i,s,n){"use strict";var a=i.extend({init:function(t,i){return this._parent("Hold"+e.printMouseButton(t)+"MouseDown"),this.priority=10,this.button=t,this.maxTime=i||THREEDS.VisuEventsManager.getHoldTime(),this.maxDistance=10,this.timer=null,this},detect:function(t){this._parent(t);var s=THREEDS.VisuEventsManager.getMouseEvents(null,this.view),a=this;switch(this.state){case i.State.INIT:for(var r=0;r<s.length;r++){var h=s[r];if(h.state===e.State.BEGIN&&h.button===this.button)return this.resetTimer(),this.evt=h,n.isReplaying()||(this.timer=setTimeout(function(){a.events=[h],a.changeState(i.State.OK),a.execute(!0)},this.maxTime)),void this.changeState(i.State.BEGIN)}break;case i.State.BEGIN:(null===this.evt||this.evt.state===e.State.END||this.evt.state===e.State.MOVE&&this.evt.offsetPosition.length()>this.maxDistance)&&(this.resetTimer(),this.changeState(i.State.KO));break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this.changeState(i.State.INIT)}},resetTimer:function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)}});return UWA.namespace("THREEDS/Gestures/HoldMouseDownGesture",a)}),define("Gestures/HoldMouseDownGesture",["DS/Gestures/HoldMouseDownGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/HoldMouseDownGesture"),t}),define("DS/Gestures/MouseUpGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(t,e,i){"use strict";var s=i.extend({init:function(t){return this._parent(e.printMouseButton(t)+"MouseUp"),this.priority=0,this.button=t,this},detect:function(t){switch(this._parent(t),this.state){case i.State.INIT:var s=THREEDS.VisuEventsManager.getMouseEventsByStates([e.State.END],this.button,this.view);if(s.length){var n=s[0];return this.events=[n],void this.changeState(i.State.OK)}break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this.changeState(i.State.INIT)}}});return UWA.namespace("THREEDS/Gestures/MouseUpGesture",s)}),define("Gestures/MouseUpGesture",["DS/Gestures/MouseUpGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/MouseUpGesture"),t}),define("DS/Gestures/PrimaryPointerDownUniqueGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/VisuEvents/TouchEvent","DS/Gestures/BasicGesture"],function(t,e,i,s){"use strict";var n=s.extend({init:function(){return this._parent("PrimaryPointerDownUnique"),this.priority=10,this.identifier=null,this},detect:function(t){switch(this._parent(t),this.state){case s.State.INIT:var i=THREEDS.VisuEventsManager.getPrimaryPointerEventsByStates([e.State.BEGIN],this.view);if(1===i.length){var n=THREEDS.VisuEventsManager.getTouchEvents(),a=THREEDS.VisuEventsManager.getMouseEvents();n.length+a.length<=2&&(this.events=[i[0]],this.changeState(s.State.OK))}break;case s.State.KO:case s.State.OK:case s.State.CANCEL:this.identifier=null,this.changeState(s.State.INIT)}}});return UWA.namespace("THREEDS/Gestures/PrimaryPointerDownUniqueGesture",n)}),define("Gestures/PrimaryPointerDownUniqueGesture",["DS/Gestures/PrimaryPointerDownUniqueGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/PrimaryPointerDownUniqueGesture"),t}),define("DS/Gestures/MediumHoldStayGesture",["DS/Gestures/HoldStayGesture"],function(t){"use strict";var e=t.extend({init:function(){return this._parent(),this.priority=101,this.name="MediumHoldStay",this.maxTime=THREEDS.VisuEventsManager.getMediumHoldTime(),this},detect:function(t){this._parent(t)}});return UWA.namespace("THREEDS/Gestures/MediumHoldStayGesture",e)}),define("Gestures/MediumHoldStayGesture",["DS/Gestures/MediumHoldStayGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/MediumHoldStayGesture"),t}),define("DS/Gestures/LongHoldStayGesture",["DS/Gestures/HoldStayGesture"],function(t){"use strict";var e=t.extend({init:function(){return this._parent(),this.priority=101,this.name="LongHoldStay",this.maxTime=THREEDS.VisuEventsManager.getLongHoldTime(),this},detect:function(t){this._parent(t)}});return UWA.namespace("THREEDS/Gestures/LongHoldStayGesture",e)}),define("Gestures/LongHoldStayGesture",["DS/Gestures/LongHoldStayGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/LongHoldStayGesture"),t}),define("DS/Gestures/ReleaseGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(t,e,i){"use strict";var s=i.extend({init:function(){return this._parent("Release"),this.priority=0,this},detect:function(t){switch(this._parent(t),this.state){case i.State.INIT:var s=THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.END],this.view);if(s.length)return this.events=s.slice(),void this.changeState(i.State.OK);break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this.changeState(i.State.INIT)}}});return UWA.namespace("THREEDS/Gestures/ReleaseGesture",s)}),define("Gestures/ReleaseGesture",["DS/Gestures/ReleaseGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/ReleaseGesture"),t}),define("DS/Gestures/MouseOutGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(t,e,i){"use strict";var s=i.extend({init:function(){return this._parent("MouseOut"),this.priority=0,this},detect:function(t){this._parent(t);var s=THREEDS.VisuEventsManager.getMouseEvents();switch(this.state){case i.State.INIT:for(var n=0;n<s.length;n++){var a=s[n];if(a.state===e.State.CANCEL&&a.button===e.MouseButton.NONE)return this.events=[a],void this.changeState(i.State.OK)}break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this.changeState(i.State.INIT)}}});return UWA.namespace("THREEDS/Gestures/MouseOutGesture",s)}),define("Gestures/MouseOutGesture",["DS/Gestures/MouseOutGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/MouseOutGesture"),t}),define("DS/Gestures/PinchTapGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(t,e,i){"use strict";var s=i.extend({init:function(){return this._parent("PinchTap"),this.priority=10,this.maxTime=300,this.maxDistance=15,this},detect:function(t){switch(this._parent(t),this.state){case i.State.INIT:2===(s=THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN,e.State.MOVE,e.State.IDLE],this.view)).length&&this.changeState(i.State.BEGIN);break;case i.State.BEGIN:var s;if((s=THREEDS.VisuEventsManager.getTouchEvents()).length>2)return void this.changeState(i.State.KO);for(var n=s.length,a=0;a<s.length;a++){var r=s[a],h=r.getState();if(h===e.State.MOVE){if(r.offsetPosition.length()>this.maxDistance||r.currentTime-r.startTime>this.maxTime)return void this.changeState(i.State.KO)}else if(h===e.State.END){if(r.offsetPosition.length()>this.maxDistance||r.currentTime-r.startTime>this.maxTime)return void this.changeState(i.State.KO);if(1===n)return this.events.push(r),void this.changeState(i.State.OK);2===n&&(this.events=[r],n--)}}break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this.changeState(i.State.INIT)}}});return UWA.namespace("THREEDS/Gestures/PinchTapGesture",s)}),define("Gestures/PinchTapGesture",["DS/Gestures/PinchTapGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/PinchTapGesture"),t}),define("DS/Gestures/DoubleTapGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(t,e,i){"use strict";var s=i.extend({init:function(){return this._parent("DoubleTap"),this.priority=100,this.currentTime=0,this.maxTime=400,this.maxDistance=50,this.lastTapTime=0,this.lastTapPosition=new t.Vector2,this.lastTapTimeTemp=0,this.lastTapPositionTemp=new t.Vector2,this.firstTapStartTime=0,this},detect:function(t){this._parent(t);var s=this.gestures[0];if(s)switch(this.currentTime=(new Date).getTime(),this.state){case i.State.INIT:s.getState()===i.State.OK&&(this.lastTapTime=this.currentTime,this.lastTapPosition.copy(s.events[0].currentPosition),this.lastTapTimeTemp=this.currentTime,this.lastTapPositionTemp.copy(s.events[0].currentPosition),this.firstTapStartTime=s.events[0].startTime,this.changeState(i.State.BEGIN));break;case i.State.BEGIN:if(s.getState()===i.State.OK)this.currentTime-this.lastTapTime<this.maxTime&&this.lastTapPosition.sub(s.events[0].currentPosition).length()<this.maxDistance?(this.events=s.getEvents(),this.changeState(i.State.OK)):(this.lastTapTime=this.currentTime,this.lastTapPosition.copy(s.events[0].currentPosition),this.lastTapPositionTemp.copy(s.events[0].currentPosition),this.lastTapTimeTemp=this.currentTime,this.firstTapStartTime=s.events[0].startTime);else{var n=THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN],this.view);if(this.currentTime-this.lastTapTimeTemp<this.maxTime&&this.lastTapPositionTemp.sub(s.events[0].currentPosition).length()<this.maxDistance&&n[0]){var a=n[0].getJSEvent();a&&a.preventDefault&&a.preventDefault()}}break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this.changeState(i.State.INIT)}},getElapsedTime:function(){return this.getEvents().length>0?this.currentTime-this.firstTapStartTime:null},getTouchPoint:function(){return this.getEvents().length>0?this.getEvents()[0].getCurrentPosition():null}});return UWA.namespace("THREEDS/Gestures/DoubleTapGesture",s)}),define("Gestures/DoubleTapGesture",["DS/Gestures/DoubleTapGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/DoubleTapGesture"),t}),define("DS/Gestures/PinchGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(t,e,i){"use strict";var s=new t.Vector2,n=i.extend({init:function(){return this._parent("Pinch"),this.priority=10,this.touches=[],this.fingersVector=new t.Vector2,this.latencyTime=200,this.initTime=0,this.distance=null,this.lastDistance=0,this.initDistance=0,this.distanceMin=10,this.orientation=null,this.lastOrientation=0,this.deltaOrientation=0,this.initOrientation=0,this.orientationMax=.1,this.barycenter=null,this.lastBarycenter=new t.Vector2,this.initBarycenter=new t.Vector2,this.barycenterMax=10,this},detect:function(n){if(this.touches=THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN,e.State.MOVE,e.State.IDLE,e.State.END],this.view),2===this.touches.length){var a=n[0].getJSEvent();a.preventDefault&&a.preventDefault(),this.fingersVector.subVectors(this.touches[1].currentPosition,this.touches[0].currentPosition),null===this.distance&&(this.distance=this.fingersVector.length()),null===this.orientation&&(this.orientation=Math.atan2(this.fingersVector.y,this.fingersVector.x)),null===this.barycenter&&(this.barycenter=new t.Vector2,this.barycenter.addVectors(this.touches[0].currentPosition,this.touches[1].currentPosition),this.barycenter.multiplyScalar(.5)),this.lastDistance=this.distance,this.distance=this.fingersVector.length(),this.lastOrientation=this.orientation,this.orientation=Math.atan2(this.fingersVector.y,this.fingersVector.x),this.deltaOrientation=this.orientation-this.lastOrientation;var r=this.deltaOrientation>=0?1:-1;r*=2*Math.PI,Math.abs(this.deltaOrientation-r)<Math.abs(this.deltaOrientation)&&(this.deltaOrientation-=r),this.lastBarycenter.copy(this.barycenter),this.barycenter.addVectors(this.touches[0].currentPosition,this.touches[1].currentPosition),this.barycenter.multiplyScalar(.5)}switch(this.state){case i.State.INIT:2===this.touches.length&&(this.initTime=(new Date).getTime(),this.initDistance=this.distance,this.initOrientation=this.orientation,this.initBarycenter.copy(this.barycenter),this.changeState(i.State.BEGIN));break;case i.State.BEGIN:if(2===THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN,e.State.MOVE,e.State.IDLE],this.view).length){var h=Math.abs(this.orientation-this.initOrientation);h=Math.min(h,Math.abs(h-2*Math.PI)),s.copy(this.initBarycenter),Math.abs(this.distance-this.initDistance)>this.distanceMin&&h<this.orientationMax&&(this.events=this.touches,this.changeState(i.State.CHANGE))}else this.changeState(i.State.KO);break;case i.State.CHANGE:if(2===this.touches.length){var u=this.touches[0].getState()===e.State.END||this.touches[1].getState()===e.State.END;this.events=this.touches,this.changeState(i.State.CHANGE,u)}else this.changeState(i.State.KO);break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this.changeState(i.State.INIT),this.touches=[],this.distance=null,this.orientation=null,this.barycenter=null}},getAngle:function(){return this.orientation||0},getDeltaAngle:function(){return this.deltaOrientation},getFirstTouchPosition:function(t){return 2===this.getEvents().length?this.getEvents()[0].getCurrentPosition():null},getSecondTouchPosition:function(t){return 2===this.getEvents().length?this.getEvents()[1].getCurrentPosition():null},getInitialDistance:function(t){var e=-1;if(2===this.getEvents().length){var i=this.getEvents()[1].getStartPosition();i.sub(this.getEvents()[0].getStartPosition()),e=i.length()}return e},getDistance:function(t){var e=-1;if(2===this.getEvents().length){var i=this.getEvents()[1].getCurrentPosition();i.sub(this.getEvents()[0].getCurrentPosition()),e=i.length()}return e}});return UWA.namespace("THREEDS/Gestures/PinchGesture",n)}),define("Gestures/PinchGesture",["DS/Gestures/PinchGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/PinchGesture"),t}),define("DS/Gestures/SpreadGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(t,e,i){"use strict";var s=i.extend({init:function(){return this._parent("Spread"),this.priority=10,this.touches=[],this.fingersVector0_1=new t.Vector2,this.fingersVector1_2=new t.Vector2,this.fingersVector2_0=new t.Vector2,this.latencyTime=30,this.initTime=0,this.distance=null,this.lastDistance=0,this.initDistance=0,this.distanceMin=0,this},detect:function(t){switch(this.touches=THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN,e.State.MOVE,e.State.IDLE,e.State.END],this.view),3===this.touches.length&&(this.fingersVector0_1.subVectors(this.touches[1].currentPosition,this.touches[0].currentPosition),this.fingersVector1_2.subVectors(this.touches[2].currentPosition,this.touches[1].currentPosition),this.fingersVector2_0.subVectors(this.touches[0].currentPosition,this.touches[2].currentPosition),null===this.distance&&(this.distance=this.fingersVector0_1.length()+this.fingersVector1_2.length()+this.fingersVector2_0.length()),this.lastDistance=this.distance,this.distance=this.fingersVector0_1.length()+this.fingersVector1_2.length()+this.fingersVector2_0.length()),this.state){case i.State.INIT:this.distance=null,3===this.touches.length&&(this.preventDefault(this.touches),this.initTime=(new Date).getTime(),this.initDistance=this.distance,this.changeState(i.State.BEGIN));break;case i.State.BEGIN:3===this.touches.length?(this.events=this.touches,this.preventDefault(this.events),this.changeState(i.State.CHANGE)):this.changeState(i.State.KO);break;case i.State.CHANGE:if(3===this.touches.length){var s=this.touches[0].getState()===e.State.END||this.touches[1].getState()===e.State.END||this.touches[2].getState()===e.State.END;this.events=this.touches,this.preventDefault(this.events),this.changeState(i.State.CHANGE,s)}else this.changeState(i.State.KO);break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this.changeState(i.State.INIT),this.touches=[],this.distance=null}},preventDefault:function(t){for(var e=0;e<t.length;e++){var i=t[e].getJSEvent();i.preventDefault&&i.preventDefault()}}});return UWA.namespace("THREEDS/Gestures/SpreadGesture",s)}),define("Gestures/SpreadGesture",["DS/Gestures/SpreadGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/SpreadGesture"),t}),define("DS/Gestures/TouchGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(t,e,i){"use strict";var s=i.extend({init:function(){return this._parent("Touch"),this.priority=0,this},detect:function(t){switch(this._parent(t),this.state){case i.State.INIT:var s=THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN],this.view);if(s.length)return this.events=s.slice(),void this.changeState(i.State.OK);break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this.changeState(i.State.INIT)}}});return UWA.namespace("THREEDS/Gestures/TouchGesture",s)}),define("Gestures/TouchGesture",["DS/Gestures/TouchGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/TouchGesture"),t}),define("DS/Gestures/PrimaryPointerClickGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/VisuEvents/TouchEvent","DS/Gestures/BasicGesture"],function(t,e,i,s){"use strict";var n=s.extend({init:function(){return this._parent("PrimaryPointerClick"),this.priority=10,this.identifier=null,this.maxTime=300,this.maxDistance=10,this},detect:function(t){switch(this._parent(t),this.state){case s.State.INIT:this.identifier=null;var n=THREEDS.VisuEventsManager.getPrimaryPointerEventsByStates([e.State.BEGIN],this.view);1===n.length&&(n[0]instanceof i&&(this.identifier=n[0].identifier),this.changeState(s.State.BEGIN));break;case s.State.BEGIN:var a=null;if(null!==this.identifier){if(THREEDS.VisuEventsManager.getTouchEvents(this.view).length>1)return;a=THREEDS.VisuEventsManager.getTouchEventById(this.identifier)}else a=THREEDS.VisuEventsManager.getMouseEvents(e.MouseButton.LEFT,this.view)[0];a?a.state===e.State.MOVE?(a.offsetPosition.length()>this.maxDistance||a.currentTime-a.startTime>this.maxTime)&&this.changeState(s.State.KO):a.state===e.State.END&&(a.offsetPosition.length()>this.maxDistance||a.currentTime-a.startTime>this.maxTime?this.changeState(s.State.KO):(this.events=[a],this.changeState(s.State.OK))):this.changeState(s.State.KO);break;case s.State.KO:case s.State.OK:case s.State.CANCEL:this.identifier=null,this.changeState(s.State.INIT)}}});return UWA.namespace("THREEDS/Gestures/PrimaryPointerClickGesture",n)}),define("Gestures/PrimaryPointerClickGesture",["DS/Gestures/PrimaryPointerClickGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/PrimaryPointerClickGesture"),t}),define("DS/Gestures/ClickGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(t,e,i){"use strict";var s=i.extend({init:function(t){return this._parent(e.printMouseButton(t)+"Click"),this.priority=10,this.button=t,this.maxTime=300,this.maxDistance=10,this},detect:function(t){this._parent(t);var s=THREEDS.VisuEventsManager.getMouseEvents(null,this.view);switch(this.state){case i.State.INIT:for(var n=0;n<s.length;n++){if((a=s[n]).state===e.State.BEGIN&&a.button===this.button)return void this.changeState(i.State.BEGIN)}break;case i.State.BEGIN:for(n=0;n<s.length;n++){var a;if((a=s[n]).button===this.button)if(a.state===e.State.MOVE){if(a.offsetPosition.length()>this.maxDistance||a.currentTime-a.startTime>this.maxTime)return void this.changeState(i.State.KO)}else if(a.state===e.State.END)return void(a.offsetPosition.length()>this.maxDistance||a.currentTime-a.startTime>this.maxTime?this.changeState(i.State.KO):(this.events=[a],this.changeState(i.State.OK)))}break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this.changeState(i.State.INIT)}}});return UWA.namespace("THREEDS/Gestures/ClickGesture",s)}),define("Gestures/ClickGesture",["DS/Gestures/ClickGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/ClickGesture"),t}),define("DS/Gestures/MouseWheelGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(t,e,i){"use strict";var s=i.extend({init:function(){return this._parent("MouseWheel"),this.priority=0,this.delta=0,this},detect:function(t){switch(this._parent(t),this.state){case i.State.INIT:var s=THREEDS.VisuEventsManager.getMouseEventsByStates([e.State.BEGIN],e.MouseButton.WHEEL,this.view);if(s.length){var n=s[0];return this.events=[n],this.delta=UWA.Event.wheelDelta(n.getJSEvent()),void this.changeState(i.State.OK)}break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this.changeState(i.State.INIT)}}});return UWA.namespace("THREEDS/Gestures/MouseWheelGesture",s)}),define("Gestures/MouseWheelGesture",["DS/Gestures/MouseWheelGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/MouseWheelGesture"),t}),define("DS/Gestures/PrimaryPointerDoubleClickGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(t,e,i){"use strict";var s=i.extend({init:function(e){return this._parent("PrimaryPointerDoubleClick"),this.priority=100,this.currentTime=0,this.maxTime=300,this.maxDistance=15,this.lastClickTime=0,this.lastClickPosition=new t.Vector2,this},detect:function(t){this._parent(t);var e=this.gestures[0];if(e)switch(this.currentTime=(new Date).getTime(),this.state){case i.State.INIT:e.getState()===i.State.OK&&(this.lastClickTime=this.currentTime,this.lastClickPosition.copy(e.events[0].currentPosition),this.changeState(i.State.BEGIN));break;case i.State.BEGIN:e.getState()===i.State.OK&&(this.currentTime-this.lastClickTime<this.maxTime&&this.lastClickPosition.sub(e.events[0].currentPosition).length()<this.maxDistance?(this.events=e.getEvents(),this.changeState(i.State.OK)):(this.lastClickTime=this.currentTime,this.lastClickPosition.copy(e.events[0].currentPosition)));break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this.changeState(i.State.INIT)}}});return UWA.namespace("THREEDS/Gestures/PrimaryPointerDoubleClickGesture",s)}),define("Gestures/PrimaryPointerDoubleClickGesture",["DS/Gestures/PrimaryPointerDoubleClickGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/PrimaryPointerDoubleClickGesture"),t}),define("DS/Gestures/PrimaryPointerUpUniqueGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/VisuEvents/TouchEvent","DS/Gestures/BasicGesture"],function(t,e,i,s){"use strict";var n=s.extend({init:function(){return this._parent("PrimaryPointerUpUnique"),this.priority=10,this.identifier=null,this},detect:function(t){switch(this._parent(t),this.state){case s.State.INIT:var i=THREEDS.VisuEventsManager.getPrimaryPointerEventsByStates([e.State.END],this.view);if(1===i.length){var n=THREEDS.VisuEventsManager.getTouchEvents(),a=THREEDS.VisuEventsManager.getMouseEvents();n.length+a.length<=2&&(this.events=[i[0]],this.changeState(s.State.OK))}break;case s.State.KO:case s.State.OK:case s.State.CANCEL:this.identifier=null,this.changeState(s.State.INIT)}}});return UWA.namespace("THREEDS/Gestures/PrimaryPointerUpUniqueGesture",n)}),define("Gestures/PrimaryPointerUpUniqueGesture",["DS/Gestures/PrimaryPointerUpUniqueGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/PrimaryPointerUpUniqueGesture"),t}),define("DS/Gestures/MediumHoldGesture",["DS/Gestures/HoldGesture"],function(t){"use strict";var e=t.extend({init:function(){return this._parent(),this.priority=100,this.name="MediumHold",this.maxTime=THREEDS.VisuEventsManager.getMediumHoldTime(),this},detect:function(t){this._parent(t)}});return UWA.namespace("THREEDS/Gestures/MediumHoldGesture",e)}),define("Gestures/MediumHoldGesture",["DS/Gestures/MediumHoldGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/MediumHoldGesture"),t}),define("DS/Gestures/KeyDownGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(t,e,i){"use strict";var s=i.extend({init:function(){return this._parent("KeyDown"),this.priority=0,this.key=0,this},detect:function(t){switch(this._parent(t),this.state){case i.State.INIT:for(var s=0;s<t.length;s++){var n=t[s];if(!n.view||!(n.view.tagName&&"input"===n.view.tagName.toLowerCase()||"true"===n.view.contentEditable)||n.isInView(this.view)){var a=n.getType(),r=n.getState();if("Keyboard"===a){var h=n.getKey();if(r===e.State.BEGIN)return this.events=[n],this.key=h,void this.changeState(i.State.OK)}}}break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this.changeState(i.State.INIT)}}});return UWA.namespace("THREEDS/Gestures/KeyDownGesture",s)}),define("Gestures/KeyDownGesture",["DS/Gestures/KeyDownGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/KeyDownGesture"),t}),define("DS/Gestures/PunctualSwipeGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(t,e,i){"use strict";var s=i.extend({init:function(){return this._parent("PunctualSwipe"),this},detect:function(t){switch(this._parent(t),this.state){case i.State.INIT:case i.State.BEGIN:case i.State.CHANGE:case i.State.KO:case i.State.OK:case i.State.CANCEL:}}});return UWA.namespace("THREEDS/Gestures/PunctualSwipeGesture",s)}),define("Gestures/PunctualSwipeGesture",["DS/Gestures/PunctualSwipeGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/PunctualSwipeGesture"),t}),define("DS/Gestures/TapGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(t,e,i){"use strict";var s=i.extend({init:function(){return this._parent("Tap"),this.priority=10,this.identifier=null,this.maxTime=300,this.maxDistance=10,this},detect:function(t){switch(this._parent(t),this.state){case i.State.INIT:1===(s=THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN,e.State.MOVE,e.State.IDLE])).length&&1===(s=THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN],this.view)).length&&(this.identifier=s[0].identifier,this.changeState(i.State.BEGIN));break;case i.State.BEGIN:var s;if((s=THREEDS.VisuEventsManager.getTouchEvents()).length>1)return;var n=THREEDS.VisuEventsManager.getTouchEventById(this.identifier);null===n?this.changeState(i.State.KO):n.state===e.State.MOVE?(n.offsetPosition.length()>this.maxDistance||n.currentTime-n.startTime>this.maxTime)&&this.changeState(i.State.KO):n.state===e.State.END&&(n.offsetPosition.length()>this.maxDistance||n.currentTime-n.startTime>this.maxTime?this.changeState(i.State.KO):(this.events=[n],this.changeState(i.State.OK)));break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this.changeState(i.State.INIT)}},getTouchPoint:function(){return this.getEvents().length>0?this.getEvents()[0].getCurrentPosition():null}});return UWA.namespace("THREEDS/Gestures/TapGesture",s)}),define("Gestures/TapGesture",["DS/Gestures/TapGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/TapGesture"),t}),define("DS/Gestures/LongHoldGesture",["DS/Gestures/HoldGesture"],function(t){"use strict";var e=t.extend({init:function(){return this._parent(),this.priority=100,this.name="LongHold",this.maxTime=THREEDS.VisuEventsManager.getLongHoldTime(),this},detect:function(t){this._parent(t)}});return UWA.namespace("THREEDS/Gestures/LongHoldGesture",e)}),define("Gestures/LongHoldGesture",["DS/Gestures/LongHoldGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/LongHoldGesture"),t}),define("DS/Gestures/ClickDownGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(t,e,i){"use strict";var s=i.extend({init:function(i){return this._parent(e.printMouseButton(i)+"ClickDown"),this.priority=100,this.button=i,this.currentTime=0,this.maxTime=300,this.maxDistance=15,this.lastClickTime=0,this.lastClickPosition=new t.Vector2,this},detect:function(t){this._parent(t);var s=THREEDS.VisuEventsManager.getMouseEvents(null,this.view),n=this.gestures[0];if(this.state!==i.State.INIT||n)switch(this.currentTime=(new Date).getTime(),this.state){case i.State.INIT:n.getState()===i.State.OK&&(this.lastClickTime=this.currentTime,this.lastClickPosition.copy(n.events[0].currentPosition),this.changeState(i.State.BEGIN));break;case i.State.BEGIN:for(var a=0;a<s.length;a++){var r=s[a];if(r.button===this.button)return void(r.state===e.State.BEGIN&&this.currentTime-this.lastClickTime<this.maxTime&&this.lastClickPosition.sub(r.currentPosition).length()<this.maxDistance?this.changeState(i.State.OK):this.changeState(i.State.KO))}break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this.changeState(i.State.INIT)}}});return UWA.namespace("THREEDS/Gestures/ClickDownGesture",s)}),define("Gestures/ClickDownGesture",["DS/Gestures/ClickDownGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/ClickDownGesture"),t}),define("DS/Gestures/PrimaryPointerMoveUniqueGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/VisuEvents/TouchEvent","DS/Gestures/BasicGesture"],function(t,e,i,s){"use strict";var n=s.extend({init:function(){return this._parent("PrimaryPointerMoveUnique"),this.priority=10,this},detect:function(t){switch(this._parent(t),this.state){case s.State.INIT:case s.State.CHANGE:var i=!1,n=THREEDS.VisuEventsManager.getScreenEvents(),a=n.length,r=null;if(a>0)if(1===a){var h=n[0].getType(),u=n[0].getState();"Mouse"!==h&&"Touch"!==h||(i=u===e.State.MOVE,r=n[0])}else if(2===a){var o=THREEDS.VisuEventsManager.getMouseEventsByStates([e.State.MOVE],e.MouseButton.NONE,this.view),c=THREEDS.VisuEventsManager.getMouseEventsByStates([e.State.MOVE],e.MouseButton.LEFT,this.view),S=THREEDS.VisuEventsManager.getTouchEvents(this.view);i=1===o.length&&1===c.length||1===S.length&&S[0].getState()===e.State.MOVE&&!o.length&&!c.length,r=c.length?c[0]:S[0]}if(i)return this.events=[r],void this.changeState(s.State.CHANGE);this.changeState(s.State.INIT);break;case s.State.KO:case s.State.OK:case s.State.CANCEL:this.changeState(s.State.INIT)}}});return UWA.namespace("THREEDS/Gestures/PrimaryPointerMoveUniqueGesture",n)}),define("Gestures/PrimaryPointerMoveUniqueGesture",["DS/Gestures/PrimaryPointerMoveUniqueGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/PrimaryPointerMoveUniqueGesture"),t}),define("DS/Gestures/DoublePinchTapGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(t,e,i){"use strict";var s=new t.Vector2,n=new t.Vector2,a=i.extend({init:function(){return this._parent("DoublePinchTap"),this.priority=100,this.currentTime=0,this.maxTime=600,this.maxDistance=20,this.lastTapTime=0,this.lastTapPosition1=new t.Vector2,this.lastTapPosition2=new t.Vector2,this},detect:function(t){this._parent(t);var e=this.gestures[0];if(e)switch(this.currentTime=(new Date).getTime(),this.state){case i.State.INIT:e.getState()===i.State.OK&&(this.lastTapTime=this.currentTime,this.lastTapPosition1.copy(e.events[0].currentPosition),this.lastTapPosition2.copy(e.events[1].currentPosition),this.changeState(i.State.BEGIN));break;case i.State.BEGIN:if(e.getState()===i.State.OK){s.copy(this.lastTapPosition1),n.copy(this.lastTapPosition2);var a=this.lastTapPosition1.sub(e.events[0].currentPosition).length(),r=s.sub(e.events[1].currentPosition).length(),h=this.lastTapPosition2.sub(e.events[0].currentPosition).length(),u=n.sub(e.events[1].currentPosition).length();this.currentTime-this.lastTapTime<this.maxTime&&(a<this.maxDistance||r<this.maxDistance)&&(h<this.maxDistance||u<this.maxDistance)?(this.events=e.getEvents(),this.changeState(i.State.OK)):(this.lastTapTime=this.currentTime,this.lastTapPosition1.copy(e.events[0].currentPosition),this.lastTapPosition2.copy(e.events[1].currentPosition))}break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this.changeState(i.State.INIT)}}});return UWA.namespace("THREEDS/Gestures/DoublePinchTapGesture",a)}),define("Gestures/DoublePinchTapGesture",["DS/Gestures/DoublePinchTapGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/DoublePinchTapGesture"),t}),define("DS/Gestures/PinchPanRotateGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(t,e,i){"use strict";var s=i.extend({init:function(){return this._parent("PinchPanRotate"),this.priority=10,this.touches=[],this.fingersVector=new t.Vector2,this.distance=null,this.lastDistance=0,this.orientation=null,this.lastOrientation=0,this.deltaOrientation=0,this},detect:function(t){if(this.touches=THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN,e.State.MOVE,e.State.IDLE,e.State.END],this.view),2===this.touches.length){this.fingersVector.subVectors(this.touches[1].getCurrentPosition(this.view),this.touches[0].getCurrentPosition(this.view)),null===this.distance&&(this.distance=this.fingersVector.length()),null===this.orientation&&(this.orientation=Math.atan2(this.fingersVector.y,this.fingersVector.x)),this.lastDistance=this.distance,this.distance=this.fingersVector.length(),this.lastOrientation=this.orientation,this.orientation=Math.atan2(this.fingersVector.y,this.fingersVector.x),this.deltaOrientation=this.orientation-this.lastOrientation;var s=this.deltaOrientation>=0?1:-1;s*=2*Math.PI,Math.abs(this.deltaOrientation-s)<Math.abs(this.deltaOrientation)&&(this.deltaOrientation-=s)}switch(this.state){case i.State.INIT:this.distance=null,this.orientation=null,this.touches.length>0&&this.changeState(i.State.BEGIN);break;case i.State.BEGIN:if(2===this.touches.length)(n=t[0].getJSEvent()).preventDefault&&n.preventDefault(),this.events=this.touches,this.changeState(i.State.CHANGE);break;case i.State.CHANGE:if(2===this.touches.length){var n;(n=t[0].getJSEvent()).preventDefault&&n.preventDefault();var a=this.touches[0].getState()===e.State.END||this.touches[1].getState()===e.State.END;this.events=this.touches,this.changeState(i.State.CHANGE,a)}else this.changeState(i.State.KO);break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this.changeState(i.State.INIT),this.touches=[],this.distance=null,this.orientation=null}},getAngle:function(){return this.orientation||0},getDeltaAngle:function(){return this.deltaOrientation}});return UWA.namespace("THREEDS/Gestures/PinchPanRotateGesture",s)}),define("Gestures/PinchPanRotateGesture",["DS/Gestures/PinchPanRotateGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/PinchPanRotateGesture"),t}),define("DS/Gestures/SwipeGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(t,e,i){"use strict";var s=i.extend({init:function(){return this._parent("Swipe"),this.priority=10,this.touches=[],this.identifier=null,this.minDistance=5,this},detect:function(t){switch(this._parent(t),this.touches=THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN,e.State.MOVE,e.State.IDLE,e.State.END]),this.state){case i.State.INIT:1===this.touches.length&&this.touches[0].isInView(this.view)&&this.changeState(i.State.BEGIN);break;case i.State.BEGIN:if(1===this.touches.length){var s=this.touches[0].getState()===e.State.END;if(this.touches[0].offsetPosition.length()>this.minDistance){var n=t[0].getJSEvent();!s&&n.preventDefault&&n.preventDefault(),this.events=this.touches,this.changeState(i.State.CHANGE)}else s&&this.changeState(i.State.INIT)}else this.changeState(i.State.KO);break;case i.State.CHANGE:if(1===this.touches.length){s=this.touches[0].getState()===e.State.END,n=t[0].getJSEvent();!s&&n.preventDefault&&n.preventDefault(),this.events=this.touches,this.changeState(i.State.CHANGE,s)}else if(2===this.touches.length){var a=this.touches[0].getState(),r=this.touches[1].getState();a===e.State.BEGIN||r===e.State.BEGIN?this.changeState(i.State.CHANGE,!0):this.changeState(i.State.KO)}else this.changeState(i.State.KO);break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this.changeState(i.State.INIT),this.touches=[]}},getSwipeOrigin:function(){var t;return this.getEvents().length>0&&(t=this.getEvents()[0].getStartPosition()),t},getSwipeVector:function(){if(this.getEvents().length>0){var t=this.getEvents()[0].getCurrentPosition();return t.sub(this.getEvents()[0].getStartPosition()),t}return null},getSwipeDuration:function(){return this.getEvents().length>0?this.getEvents()[0].currentTime-this.getEvents()[0].startTime:null}});return UWA.namespace("THREEDS/Gestures/SwipeGesture",s)}),define("Gestures/SwipeGesture",["DS/Gestures/SwipeGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/SwipeGesture"),t}),define("DS/Gestures/FlickGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(t,e,i){"use strict";var s=i.extend({init:function(){return this._parent("Flick"),this.priority=15,this._Identifier=-1,this.Flick_Motion=25,this.Flick_Timer=120,this.Flick_Speed=.2,this},changeStateToKO:function(){this._Identifier=-1,this.changeState(i.State.KO)},detect:function(t){this._parent(t);var s=THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN,e.State.MOVE,e.State.IDLE,e.State.END]);switch(this.state){case i.State.INIT:1===s.length&&s[0].isInView(this.view)&&s[0].getState()===e.State.BEGIN&&(this.events=s,this._Identifier=s[0].getIdentifier(),this.changeState(i.State.BEGIN));break;case i.State.BEGIN:if(1!==s.length){this.changeStateToKO();break}var n=THREEDS.VisuEventsManager.getTouchEventById(this._Identifier);if(null===n){this.changeStateToKO();break}if(n.getState()===e.State.END){var a=n.offsetPosition.length(),r=n.currentTime-n.startTime,h=a/r;if(a>=this.Flick_Motion&&r<=this.Flick_Timer&&h>=this.Flick_Speed){this.events=[n],this.changeState(i.State.OK);break}this.changeState(i.State.KO);break}break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this._Identifier=-1,this.changeState(i.State.INIT)}},getFlickOrigin:function(){var t;return this.getEvents().length>0&&(t=this.getEvents()[0].getStartPosition()),t},getFlickVector:function(){if(this.getEvents().length>0){var t=this.getEvents()[0].getCurrentPosition();return t.sub(this.getEvents()[0].getStartPosition()),t}return null},getFlickDuration:function(){return this.getEvents().length>0?this.getEvents()[0].currentTime-this.getEvents()[0].startTime:null}});return UWA.namespace("THREEDS/Gestures/FlickGesture",s)}),define("Gestures/FlickGesture",["DS/Gestures/FlickGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/FlickGesture"),t}),define("DS/Gestures/HoldDragGesture",["DS/Gestures/BasicGesture","DS/VisuEvents/ScreenEvent"],function(t,e){"use strict";var i=t.extend({init:function(){return this._parent(),this.priority=16,this.identifier_0=-1,this.identifier_1=-1,this._holdElapsedTime=0,this.maxDistance=10,this},changeStateToKO:function(){this.clearStateVariable(),this.changeState(t.State.KO)},clearStateVariable:function(){this.identifier_0=-1,this.identifier_1=-1,this._holdElapsedTime=0},detect:function(i){switch(this._parent(i),this.state){case t.State.INIT:var s=THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN,e.State.MOVE,e.State.IDLE]);if(2===s.length){var n=-1;s[0].getState()==e.State.IDLE?n=0:s[1].getState()==e.State.IDLE&&(n=1),-1!==n&&s[n].getOffsetPosition().length()<this.maxDistance&&(s[1-n].getState()!=e.State.BEGIN&&s[1-n].getState()!=e.State.MOVE||(this.identifier_0=s[n].getIdentifier(),this.identifier_1=s[1-n].getIdentifier(),this.changeState(t.State.BEGIN)))}break;case t.State.BEGIN:if(2!==THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN,e.State.MOVE,e.State.IDLE]).length){this.changeStateToKO();break}var a=THREEDS.VisuEventsManager.getTouchEventById(this.identifier_0),r=THREEDS.VisuEventsManager.getTouchEventById(this.identifier_1);if(null===a||null===a){this.changeStateToKO();break}if(a.getState()==e.State.IDLE&&a.getOffsetPosition().length()<this.maxDistance){if(r.getState()===e.State.MOVE&&r.offsetPosition.length()>this.maxDistance){this._holdElapsedTime=r.currentTime-a.startTime,this.events=[a,r],this.changeState(t.State.CHANGE);break}}else this.changeStateToKO();break;case t.State.CHANGE:if(2!==THREEDS.VisuEventsManager.getTouchEvents().length){this.changeStateToKO();break}a=THREEDS.VisuEventsManager.getTouchEventById(this.identifier_0),r=THREEDS.VisuEventsManager.getTouchEventById(this.identifier_1);if(null===a||null===a){this.changeStateToKO();break}(a.getState()===e.State.IDLE||a.getState()===e.State.MOVE)&&a.getOffsetPosition().length()<this.maxDistance?r.getState()===e.State.MOVE?(this._holdElapsedTime=r.currentTime-a.startTime,this.events=[a,r],this.changeState(t.State.CHANGE)):r.getState()===e.State.END&&a.getState()===e.State.IDLE?(this.events=[a,r],this.changeState(t.State.BEGIN)):a.getState()===e.State.MOVE&&a.getOffsetPosition().length()<this.maxDistance?(this.events=[a,r],this.changeState(t.State.BEGIN)):this.changeStateToKO():this.changeStateToKO();break;case t.State.KO:case t.State.OK:case t.State.CANCEL:this.clearStateVariable(),this.changeState(t.State.INIT)}},getFirstTouchPosition:function(){return 2===this.getEvents().length?this.getEvents()[0].getCurrentPosition():null},getSecondTouchPosition:function(){return 2===this.getEvents().length?this.getEvents()[1].getCurrentPosition():null},getHoldTime:function(){return this._holdElapsedTime},getDragTime:function(){return 2===this.getEvents().length?this.getEvents()[1].currentTime-this.getEvents()[1].startTime:null},getDirectionFromOrigin:function(){return 2===this.getEvents().length?this.getEvents()[1].getOffsetPosition():null},getDistanceFromOrigin:function(){return 2===this.getEvents().length?this.getEvents()[1].getOffsetPosition().length():null},getTotalTraveledDistFromOrigin:function(){return 2===this.getEvents().length?this.getEvents()[1].getTraveledDistance():null},getLastTraveledVector:function(){return 2===this.getEvents().length?this.getEvents()[1].getDeltaPosition():null},getLastTraveledDistance:function(){return 2===this.getEvents().length?this.getEvents()[1].getDeltaPosition().length():null},getElapsedTime:function(){return 2===this.getEvents().length?this.getEvents()[1].currentTime-this.getEvents()[0].startTime:null}});return UWA.namespace("THREEDS/Gestures/HoldDragGesture",i)}),define("Gestures/HoldDragGesture",["DS/Gestures/HoldDragGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/HoldDragGesture"),t}),define("DS/Gestures/TwoFingerTapGesture",["DS/Gestures/BasicGesture","DS/VisuEvents/ScreenEvent"],function(t,e){"use strict";var i=t.extend({init:function(){return this._parent("TwoFingerTap"),this.priority=14,this.identifier_0=null,this.identifier_1=null,this._remIdentifier=-1,this._isTwoFingersTapPossible=-1,this._firstTouchEvent=null,this.maxDistance=10,this.maxTime=300,this.maxTimeBetween=this.maxTime,this},changeStateToKO:function(){this.clearStateVariable(),this.changeState(t.State.KO)},clearStateVariable:function(){this._isTwoFingersTapPossible=-1,this._remIdentifier=-1,this.identifier_0=-1,this.identifier_1=-1},validateOkTapCondition:function(t){return null!==t&&(t.offsetPosition.length()<=this.maxDistance&&t.currentTime-t.startTime<=this.maxTime)},validateKoTapCondition:function(t){return null!==t&&(t.offsetPosition.length()>this.maxDistance||t.currentTime-t.startTime>this.maxTime)},detect:function(i){switch(this._parent(i),this.state){case t.State.INIT:var s=THREEDS.VisuEventsManager.getTouchEventsByStates([e.State.BEGIN,e.State.MOVE,e.State.IDLE]);2===s.length&&(s[0].getState()!==e.State.BEGIN&&s[1].getState()!==e.State.BEGIN||(this.identifier_0=s[0].identifier,this.identifier_1=s[1].identifier,this.changeState(t.State.BEGIN)));break;case t.State.BEGIN:var n=THREEDS.VisuEventsManager.getTouchEvents();if(-1===this._isTwoFingersTapPossible){if(2!==n.length){this.changeStateToKO();break}var a=THREEDS.VisuEventsManager.getTouchEventById(this.identifier_0),r=THREEDS.VisuEventsManager.getTouchEventById(this.identifier_1);if(null===a||null===a){this.changeStateToKO();break}if(a.getState()===e.State.END&&this.validateOkTapCondition(a)){this._firstTouchEvent=a,this._remIdentifier=r.getIdentifier(),this._isTwoFingersTapPossible=1;break}if(r.getState()===e.State.END&&this.validateOkTapCondition(r)){this._firstTouchEvent=r,this._remIdentifier=a.getIdentifier(),this._isTwoFingersTapPossible=1;break}if(this.validateKoTapCondition(a)||this.validateKoTapCondition(r)){this.changeStateToKO();break}}else if(1===this._isTwoFingersTapPossible){if(n.length>1){this.changeStateToKO();break}var h=THREEDS.VisuEventsManager.getTouchEventById(this._remIdentifier);if(null===h){this.changeStateToKO();break}if(h.getState()===e.State.END&&this.validateOkTapCondition(h)&&h.currentTime-this._firstTouchEvent.currentTime<=this.maxTimeBetween){this.events=[this._firstTouchEvent,h],this.clearStateVariable(),this.changeState(t.State.OK);break}this.validateKoTapCondition(h)&&this.changeStateToKO()}break;case t.State.KO:case t.State.OK:case t.State.CANCEL:this.clearStateVariable(),this.changeState(t.State.INIT)}},getFirstTouchPosition:function(){return 2===this.getEvents().length?this.getEvents()[0].getCurrentPosition():null},getSecondTouchPosition:function(){return 2===this.getEvents().length?this.getEvents()[1].getCurrentPosition():null}});return UWA.namespace("THREEDS/Gestures/TwoFingerTapGesture",i)}),define("Gestures/TwoFingerTapGesture",["DS/Gestures/TwoFingerTapGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/TwoFingerTapGesture"),t}),define("DS/Gestures/MouseMoveGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(t,e,i){"use strict";var s=i.extend({init:function(){return this._parent("MouseMove"),this.priority=0,this},detect:function(t){this._parent(t);var s=THREEDS.VisuEventsManager.getMouseEvents(e.MouseButton.NONE,this.view);switch(this.state){case i.State.INIT:case i.State.CHANGE:for(var n=0;n<s.length;n++){var a=s[n];return a.state===e.State.MOVE?(this.events=[a],void this.changeState(i.State.CHANGE)):void this.changeState(i.State.INIT)}this.changeState(i.State.INIT);break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this.changeState(i.State.INIT)}}});return UWA.namespace("THREEDS/Gestures/MouseMoveGesture",s)}),define("Gestures/MouseMoveGesture",["DS/Gestures/MouseMoveGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/MouseMoveGesture"),t}),define("DS/Gestures/KeyUpGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(t,e,i){"use strict";var s=i.extend({init:function(){return this._parent("KeyUp"),this.priority=0,this.key=0,this},detect:function(t){switch(this._parent(t),this.state){case i.State.INIT:for(var s=0;s<t.length;s++){var n=t[s];if(!n.view||!(n.view.tagName&&"input"===n.view.tagName.toLowerCase()||"true"===n.view.contentEditable)||n.isInView(this.view)){var a=n.getType(),r=n.getState();if("Keyboard"===a){var h=n.getKey();if(r===e.State.END)return this.events=[n],this.key=h,void this.changeState(i.State.OK)}}}break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this.changeState(i.State.INIT)}}});return UWA.namespace("THREEDS/Gestures/KeyUpGesture",s)}),define("Gestures/KeyUpGesture",["DS/Gestures/KeyUpGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/KeyUpGesture"),t}),define("DS/Gestures/DoubleClickGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(t,e,i){"use strict";var s=i.extend({init:function(i){return this._parent(e.printMouseButton(i)+"DoubleClick"),this.priority=100,this.button=i,this.currentTime=0,this.maxTime=300,this.maxDistance=15,this.lastClickTime=0,this.lastClickPosition=new t.Vector2,this},detect:function(t){this._parent(t);var e=this.gestures[0];if(e)switch(this.currentTime=(new Date).getTime(),this.state){case i.State.INIT:e.getState()===i.State.OK&&(this.lastClickTime=this.currentTime,this.lastClickPosition.copy(e.events[0].currentPosition),this.changeState(i.State.BEGIN));break;case i.State.BEGIN:e.getState()===i.State.OK&&(this.currentTime-this.lastClickTime<this.maxTime&&this.lastClickPosition.sub(e.events[0].currentPosition).length()<this.maxDistance?(this.events=e.getEvents(),this.changeState(i.State.OK)):(this.lastClickTime=this.currentTime,this.lastClickPosition.copy(e.events[0].currentPosition)));break;case i.State.KO:case i.State.OK:case i.State.CANCEL:this.changeState(i.State.INIT)}}});return UWA.namespace("THREEDS/Gestures/DoubleClickGesture",s)}),define("Gestures/DoubleClickGesture",["DS/Gestures/DoubleClickGesture","DS/DSMigration/DSMigration"],function(t,e){return e.deprecateModule("Gestures/DoubleClickGesture"),t});