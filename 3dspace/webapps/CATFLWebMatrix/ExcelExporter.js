function _ExcelExporterModule(e){"use strict";var r={};function t(e,r){var t;switch(typeof r){case"string":t=r;break;case"number":t=r.toString();break;case"boolean":t=r?"1":"0";break;default:return""}return"ss:"+e+'="'+t+'"'}function n(e,r,n){var s,o="<"+e;if(r)for(s in r)r.hasOwnProperty(s)&&(o+=" "+t(s,r[s]));return n&&(o+="/"),o+=">\n"}function s(e,r){var t="<Cell",n=typeof e.value;return r&&(t+=' ss:Index="'+r+'"'),e.style&&(t+=' ss:StyleID="'+e.style+'"'),t+=">","string"===n?t+='<Data ss:Type="String">'+e.value+"</Data>":"number"===n&&(t+='<Data ss:Type="Number">'+e.value+"</Data>"),e.comment&&(t+="<Comment><ss:Data>"+function(e){var r,t,n="";for(t=0;t<e.length;++t)n+=(r=e[t].charCodeAt())<65||r>127||r>90&&r<97?"&#"+r+";":e[t];return n}(e.comment)+"</ss:Data></Comment>"),t+="</Cell>\n"}function o(e){var r,t,o="object"==typeof e.cells,a=n("Row",e.attributes,!o),l=0;if(o){for(r in e.cells)e.cells.hasOwnProperty(r)&&(t=parseInt(r,10),a+=s(e.cells[r],t-l>1?t:void 0),l=t);a+="</Row>\n"}return a}function a(e){var r,t,s=n("Table",e.attributes),a=1;if(e.columns)for(t in e.columns)e.columns.hasOwnProperty(t)&&(s+=n("Column",e.columns[t].attributes,!0));if(e.rows)for(t in e.rows)if(e.rows.hasOwnProperty(t)){for(r=parseInt(t,10);a<r;)s+=o(),++a;s+=o(e.rows[t]),++a}return s+="</Table>\n"}function l(e,r){var t,n='<Worksheet ss:Name="'+(e.name||"Sheet"+(r+1))+'">\n';if(e.tables)for(t=0;t<e.tables.length;++t)n+=a(e.tables[t]);return n+="</Worksheet>\n"}function i(e,r){var n,s,o,a='<Style ss:ID="'+e+'">\n';for(n in r)if(r.hasOwnProperty(n)){for(s in a+="<"+n,r[n])r[n].hasOwnProperty(s)&&("boolean"==typeof(o=r[n][s])&&(o=o?"1":"0"),a+=" "+t(s,o));a+="/>\n"}return a+="</Style>\n"}return r.createXML=function(e){var r,t,n='<?xml version="1.0" encoding="UTF-8"?>\n<?mso-application progid="Excel.Sheet"?>\n<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"\nxmlns:o="urn:schemas-microsoft-com:office:office"\nxmlns:x="urn:schemas-microsoft-com:office:excel"\nxmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"\nxmlns:html="http://www.w3.org/TR/REC-html40">\n';if(e.styles){for(r in n+="<Styles>\n",e.styles)e.styles.hasOwnProperty(r)&&(n+=i(r,e.styles[r]));n+="</Styles>\n"}if(e.sheets)for(t=0;t<e.sheets.length;++t)n+=l(e.sheets[t],t);return n+="</Workbook>\n"},r}if("function"==typeof define)define("DS/CATFLWebMatrix/ExcelExporter",["DS/CATFLWebMatrix/jQueryPlugin"],_ExcelExporterModule);else var ExcelExporter=_ExcelExporterModule($);