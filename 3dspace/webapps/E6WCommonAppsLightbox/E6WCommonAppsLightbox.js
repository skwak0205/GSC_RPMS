define("DS/E6WCommonAppsLightbox/Views/LightboxPreview3DPlay",["UWA/Class/Promise","DS/3DPlaySupport/AssetSupport","DS/3DPlayHelper/3DPlayHelper","DS/DocumentManagement/DriveDocumentManagement","css!DS/E6WCommonAppsLightbox/E6WCommonAppsLightbox.css"],function(e,t,n,i){"use strict";var r,o,a;function s(){var e=document.createElement("div");return e.classList.add("preview-3d"),e}function c(t,s){if(!t)return e.resolve();function c(){var e={loading:"autoplay",fullscreen:{mode:"PLATFORM"},callback:{onAnnotationShared:function(){}}};if(r?t.annotation||(r.informActiveState(!0),r.load({input:s,options:e})):r=new n({container:a,input:s,options:e}),t.annotation){var i,c=t.annotation;delete t.annotation,setTimeout(function(){clearTimeout(i)},25e3),function e(){r.isReady()?(!0,r.loadAnnotations({annotation:c.data.annotationFile},{clean:!0})):i=setTimeout(e,100)}()}return o}return"3DSpace"===t.serviceHosting?t.get("type")?c():new e(function(e){t.fetch({onComplete:function(){return e(c())}})}):"3DDrive"===t.serviceHosting?i.getFileUrl(s.asset.physicalid,{tenant:s.asset.tenant,tenantUrl:s.asset.serverurl}).then(function(e){return s.asset.filename=e,s.asset.serverurl=void 0,c()}):c()}return{init:function(e,t){return e=e||{},o?(c(e.inode),o):(a=s(),o=Object.assign(a,{refresh:c}),c(e.inode,t),o)},createViewer3D:s,is3DPlayType:function(e){var n=!1;return t.checkSupport(e,{usage:"preview"},function(e){n=e}),n},hide3DPlayViewer:function(){r&&r.informActiveState(!1)},getViewer3D:function(){return r}}}),define("DS/E6WCommonAppsLightbox/Views/LightboxPreviewBody",["UWA/Class/Promise","DS/UIKIT/Spinner","css!DS/E6WCommonAppsLightbox/E6WCommonAppsLightbox.css"],function(e,t){"use strict";var n;var i,r=function(t){return function(n){var i=new e(function(e){if(n)return e(n)});return e.all([i,t])}}(new e(function(e){require(["DS/E6WCommonAppsLightbox/Views/LightboxPreview3DPlay"],function(t){n=t,e(t)})}));function o(e,t){var n=function(e,t){var n=e;return n.classList.contains(t)||(n=n.querySelector("."+t)),n}(e,"preview-body");return t?n.classList.add("preview-body--interactive"):n.classList.remove("preview-body--interactive"),e}function a(e,t){var n=e.querySelectorAll(".preview-body__adapter");return o(e,Array.prototype.map.call(n,function(e){return e===t?(e.classList.add("preview-body__adapter--visible"),!0):(e.classList.remove("preview-body__adapter--visible"),!1)}).reduce(function(e,t){return e||t},!1)),e}function s(e,t){return e.contains(t)?t:(t.classList.add("preview-body__adapter"),e.appendChild(t),t)}function c(){var e=new t;return e.elements.container.classList.add("preview-body__spinner"),e}function l(e){var t=document.createElement("div");return t.classList.add("preview-body"),function(e,t){return(t=[].concat(t)).reduce(function(e,t){return e.appendChild(t),e},e)}(t,e)}return{getFileExtension:function(e){var t;return"string"!=typeof(t=e.get("fileExtension"))?t:t.toLowerCase()},isImgType:function(e){return e&&("bmp"===e||"gif"===e||"jpg"===e||"jpeg"===e||"png"===e)},shouldRefreshAdapter:r,togglePreviewBodyVisibility:a,addAdapter:s,getPreviewBodySpinner:c,getPreviewBody:l,hidePreviewBody:function(){require(["DS/E6WCommonAppsLightbox/Views/LightboxPreview3DPlay"],function(e){e.hide3DPlayViewer()})},init:function(t){if(i)return i;t=t||{};var n=c(),u=l([n.elements.container]);function d(t,o){return n.show(),a(i),t?r(t).then(function(e){return e[1]}).then(function(e){var n=e.init();return s(i,n),n.refresh(t,o)}).then(function(e){a(i,e),n.hide()}):e.resolve()}return i=Object.assign(u,{refresh:d,toggleInteraction:function(e){return o(u,e)}}),d(t.inode),i},getPreview3DPlay:function(){return n}}}),define("DS/E6WCommonAppsLightbox/Views/Lightbox",["UWA/Class/Promise","DS/E6WCommonAppsLightbox/Views/LightboxPreviewBody","DS/UIKIT/Iconbar","DS/UIKIT/Tooltip","DS/E6WCommonUI/WidgetUtils","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS","css!DS/E6WCommonAppsLightbox/E6WCommonAppsLightbox.css"],function(e,t,n,i,r,o){"use strict";var a,s;function c(e,t){var n=e;return n.classList.contains(t)||(n=n.querySelector("."+t)),n}function l(e,t){return(t=[].concat(t)).reduce(function(e,t){return e.appendChild(t),e},e)}function u(e){return c(e,"preview__title")}function d(e){return c(e,"preview__iconbar")}function p(e){return c(e,"lightbox__cancel")}function f(e){return c(e,"lightbox__preview-properties-container")}function v(e){return c(e,"lightbox__preview-properties")}function m(e){return c(e,"lightbox")}function g(e,t){if(e){var n=e.querySelector(".iconbar__item--info");n&&(t?n.classList.add("item-info--opened"):n.classList.remove("item-info--opened"))}}function b(e){return e.classList.contains("lightbox__preview-properties-container--visible")}function h(e,t){var n=f(e);if(!n)return e;var i=d(e);return b(n)?t||(n.classList.remove("lightbox__preview-properties-container--visible"),g(i,t)):!1!==t&&(n.classList.add("lightbox__preview-properties-container--visible"),g(i,!0)),e}function w(e,t){var n=m(e);return n?(n.classList.contains("lightbox--visible")?t||(n.classList.remove("lightbox--visible"),h(n,!1)):!1===t?h(n,!1):n.classList.add("lightbox--visible"),e):e}function y(e,t){t=t||{};var n=u(e);return n&&(n.textContent=t.title||""),e}function L(e,t){t=t||{};var n=d(e);return t.iconbarElem?n.parentElement.replaceChild(t.iconbarElem,n):n.parentElement.removeChild(n),e}function P(t,n){return new e(function(e){var i,r=t.elements.container;requestAnimationFrame(function(){n&&((i=n.elements?n.elements.container:n).parentElement&&L(i.parentElement,{iconbarElem:r}),requestAnimationFrame(function(){"function"==typeof n.destroy&&n.destroy()}),e())})})}function _(e){var t=document.createElement("span");return t.classList.add("preview__title"),y(t,{title:e}),t}function x(e,t){var i;return e?(t=t.concat([{id:"info",text:o.get("E6WCommonUI.Label.Infos"),fonticon:"info",className:"iconbar__item--info",handler:function(){h(document.body)}}]),i=new n({className:"preview__iconbar",items:t})):((i=document.createElement("div")).classList.add("preview__iconbar"),i)}function E(e){var t=document.createElement("div");return t.classList.add("preview__header"),l(t,e),t}function C(e){var t=(e=e||{}).child,n=document.createElement("div");return n.classList.add("preview-controller"),t.classList.add("preview-controller__container"),t.classList.add("lightbox__preview-body"),l(n,t)}function D(){var e=!!document.body.querySelector(".lightbox")&&document.body.querySelector(".lightbox");return!!e&&e.classList.contains("lightbox--visible")}function S(){return a}function A(e,t){t=t||{};var n=p(e);return n&&n.setAttribute("href",t.href||""),e}function I(e){e=e||{};var t=document.createElement("a");return t.classList.add("lightbox__cancel"),t.classList.add("fonticon"),t.classList.add("fonticon-cancel"),new i({target:t,body:o.get("E6WCommonUI.Label.Close")}),A(t,e),t}function W(e){return e.classList.add("lightbox__preview-properties"),e}function V(e){var t=document.createElement("div");return t.classList.add("lightbox__preview-properties-container"),l(t,W(e)),t}function T(e,t){var n=v(e);return n&&n.parentElement&&n.parentElement.replaceChild(t,n),n}function U(t,n){var i=new e(function(e){requestAnimationFrame(function(){T(n.container,t.container),e()})});return W(t.container),e.all([i])}function B(e,t,n,i){var r=document.createElement("div");return r.classList.add("lightbox"),n.classList.add("lightbox__preview-controller"),w(r,Boolean(i)),l(r,[e,V(t),n])}return{selectorFromTarget:c,appendChildren:l,selectPreviewTitleElem:u,selectPreviewIconbarElem:d,selectCancelElem:p,selectPreviewPropertiesContElem:f,selectPreviewPropertiesElem:v,selectLightboxElem:m,refreshPreviewTitle:y,getPreviewTitle:_,refreshCancelElem:A,getCancelElem:I,refreshPreviewIconbarElem:L,refreshPreviewIconbar:P,getPreviewIconbar:x,getPreviewHeader:E,wrapLightBoxPreviewProperties:W,refreshPreviewPropertiesElem:T,refreshPreviewProperties:U,getPreviewController:C,isPreviewPropertiesVisible:b,togglePreviewPropertiesVisibility:h,isLightboxVisible:D,toggleLightboxVisibility:w,isTabVisible:function(e){return!(!D()||!b(f(document.body)))&&S().container.querySelector('.navigation__header.navigation__header--selected > span[data-key="'+e+'"]')},getPreviewPropertiesContainer:V,getLightbox:B,getPropertiesView:S,getPreviewBody:function(){return s},init:function(e){e=e||{};var n=x(),i=I(),o=E([_(),n,i]),c=t.init(),l=e.properties,u=C({child:c}),p=B(o,l.container,u,e.visibility);a=l,s=t;var v,m=function(e){return Boolean(e)};function L(){t.hidePreviewBody()}function D(e){return c.toggleInteraction(e),w(p,e)}function S(){h(document.body)}return v=function(e){var t=(e=e||{}).inode,i=e.config3dPlay;if(m(t)||!0===e.force){m=function(){return!!t};var r=e.properties,o=x(t,e.actions);!function(){U.apply(this,arguments)}(r,l),function(){P.apply(this,arguments).then(function(){g(d(p),b(f(p)))})}(o,n),n=o,a=l=r,c.refresh(t,i).then(function(){}),y(p,{title:t.get("alias")||t.get("title")}),A(p,{})}},widget.addEvent("onToggleLightboxPropertiesVisibilityToggled",S),["click","mousedown","touchend"].forEach(function(e){p.addEventListener(e,function(e){!function(e){var t=e.target.classList;t.contains("lightbox__cancel")?(p.animationFrameId&&(window.cancelAnimationFrame(p.animationFrameId),p.animationFrameId=null),D(!1),L(),r.restoreWidgetViewModeBeforePreview(),e.preventDefault()):(t.contains("lightbox_previous")||t.contains("lightbox_next"))&&e.preventDefault(),e.stopPropagation()}(e)})}),Object.assign(p,{destroy:function(){widget.removeEvent("onToggleLightboxPropertiesVisibilityToggled",S)},refresh:v,updatePreviewBody:function(e,t){c.refresh(e,t)},toggleVisibility:D,hideLightbox:L,unbind:m})}}});