define("DS/DMUBaseExperience/EXPToolsContext",[],function(){"use strict";var e=[];return{getParentType:function(t){return e[t]},setParentType:function(t,n){e[t]||(e[t]=n)}}}),define("DS/DMUBaseExperience/EXPUnitManagement",["DS/CATWebUXPreferences/CATWebUXPreferencesUtils"],function(e){"use strict";var t={convert:function(n,r,i,o,a){var s=i&&i.getDMUPreferenceRepository?i.getDMUPreferenceRepository().getPreference(n):null,l=n;switch(l.toLowerCase()){case"length":l="Length";break;case"area":l="Area";break;case"angle":l="Angle";break;case"volume":l="Volume"}return r*=t[l].ratio,e.convertValueToString(r,n,{unit:s,displaySpace:!0!==o&&void 0,displayUnit:!0!==a&&void 0})},getCurrentUnit:function(t){return e.getCurrentUnit(t)},Length:{ratio:Math.pow(10,-3)},Angle:{ratio:Math.PI/180},Volume:{ratio:Math.pow(10,-9)},Area:{ratio:Math.pow(10,-6)}};return Object.freeze(t)}),define("DS/DMUBaseExperience/DMUFactory",["UWA/Class"],function(e){"use strict";var t=e.singleton({init:function(){var e,t=[{name:"Compare3D",library:"DS/DMUPlayCompare/DMUCompare3D"},{name:"Compare2D",library:"DS/DMUPlayCompare/DMUCompare2D"},{name:"Slide",library:"DS/DMUPlaySlide/DMUSlide"},{name:"Format",library:"DS/DMUPlaySlide/DMUFormat"},{name:"Comment",library:"DS/DMUPlayComment/DMUComment"},{name:"Reply",library:"DS/DMUPlayComment/DMUComment"},{name:"CommentHighlight",library:"DS/DMUPlayMarker/DMUCommentHighlight"},{name:"CommentPositioned",library:"DS/DMUPlayMarker/DMUCommentPositioned"},{name:"Marker3DCircle",library:"DS/DMUPlayMarker/DMUMarker3DCircle"},{name:"Marker2DCircle",library:"DS/DMUPlayMarker/DMUMarker2DCircle"},{name:"Marker2DEllipse",library:"DS/DMUPlayMarker/DMUMarker2DEllipse"},{name:"Marker3DEllipse",library:"DS/DMUPlayMarker/DMUMarker3DEllipse"},{name:"Marker2DArrow",library:"DS/DMUPlayMarker/DMUMarker2DArrow"},{name:"Marker3DArrow",library:"DS/DMUPlayMarker/DMUMarker3DArrow"},{name:"Marker3DRectangle",library:"DS/DMUPlayMarker/DMUMarker3DRectangle"},{name:"Marker2DRectangle",library:"DS/DMUPlayMarker/DMUMarker2DRectangle"},{name:"Marker2DPicture",library:"DS/DMUPlayMarker/DMUMarker2DPicture"},{name:"Marker3DPicture",library:"DS/DMUPlayMarker/DMUMarker3DPicture"},{name:"Marker2DText",library:"DS/DMUPlayMarker/DMUMarker2DText"},{name:"Marker3DText",library:"DS/DMUPlayMarker/DMUMarker3DText"},{name:"Marker3DPoint",library:"DS/DMUPlayMarker/DMUMarker3DPoint"},{name:"Marker2DPoint",library:"DS/DMUPlayMarker/DMUMarker2DPoint"},{name:"Marker2DPolyline",library:"DS/DMUPlayMarker/DMUMarker2DPolyline"},{name:"Marker3DPolyline",library:"DS/DMUPlayMarker/DMUMarker3DPolyline"},{name:"Marker2DSpline",library:"DS/DMUPlayMarker/DMUMarker2DSpline"},{name:"Marker3DSpline",library:"DS/DMUPlayMarker/DMUMarker3DSpline"},{name:"Marker2DLine",library:"DS/DMUPlayMarker/DMUMarker2DLine"},{name:"Marker3DLine",library:"DS/DMUPlayMarker/DMUMarker3DLine"},{name:"Marker2DHyperlink",library:"DS/DMUPlayMarker/DMUMarker2DHyperlink"},{name:"Marker3DHyperlink",library:"DS/DMUPlayMarker/DMUMarker3DHyperlink"},{name:"Marker3DStamp",library:"DS/DMUPlayMarker/DMUMarker3DStamp"},{name:"MeasureItem",library:"DS/DMUPlayMeasure/DMUMeasure"},{name:"MeasureBetween",library:"DS/DMUPlayMeasure/DMUMeasure"},{name:"MeasureThickness",library:"DS/DMUPlayMeasure/DMUMeasure"},{name:"Measure3PointsCircle",library:"DS/DMUPlayMeasure/DMUMeasure"},{name:"Measure3PointsAngle",library:"DS/DMUPlayMeasure/DMUMeasure"},{name:"Section",library:"DS/DMUPlaySection/DMUSection"},{name:"ExternalLinks",library:"DS/DMUBaseReview/DMULinksManager"},{name:"OccurrenceOverloader",library:"DS/DMUBaseReview/DMUOccurrenceOverloader"},{name:"Environment",library:"DS/DMUBaseReview/DMUEnvironment"},{name:"Review",library:"DS/DMUDeprecatedReview/DMUDeprecatedReview"},{name:"Markup",library:"DS/DMUPlayMarkup/DMUMarkup"}],n=[];this.initFactory=function(r,i){e=r,n.length!==t.length?function(e,t){var r=[];e.forEach(function(e){n.includes(e.name)||r.push(e.library)}),require(r,function(){e.forEach(function(e){e.module=require(e.library),n.push(e.name)}),t()})}(t,i):i()},this.initFactoryOf=function(r,i){e=r;for(var o=0;o<i.length;o++)if(!n.includes(i[o]))for(var a=0;a<t.length;a++)if(t[a].name===i[o]&&(t[a].module=require(t[a].library),t[a].module)){n.push(t[a].name);break}},this.buildComponent=function(n,r,i,o){var a;this.initFactoryOf(e,[n]);for(var s=0;s<t.length;s++)if(n===t[s].name)return t[s].module?(a="Section"===t[s].name||t[s].name.contains("Measure")?new t[s].module(e,i,o):new t[s].module(e,i),r&&r.addDMUObject?r.addDMUObject(a):"Comment"===t[s].name&&r&&r.addDMUComment?r.addDMUComment(a):"Reply"===t[s].name&&r&&r.deprecatedAddDMUReply&&r.deprecatedAddDMUReply(a),a):null;return null}},initFactory:function(){},initFactoryOf:function(){},buildComponent:function(){}});return{initFactory:function(e,n){return t.initFactory(e,n)},initFactoryOf:function(e,n){return t.initFactoryOf(e,n)},buildComponent:function(e,n,r,i){return t.buildComponent(e,n,r,i)}}}),define("DS/DMUBaseExperience/EXPManagerSet",["UWA/Class"],function(e){"use strict";return e.singleton({init:function(){var e=[];this.getManager=function(t){for(var n=0;n<e.length;n++)if(e[n].context===t.context&&e[n].name===t.name)return e[n].mng},this.addManager=function(t){if(t&&t.name&&t.context&&t.manager){for(var n=0;n<e.length;n++)if(e[n].context===t.context&&e[n].name===t.name)return;e.push({context:t.context,name:t.name,mng:t.manager})}},this.removeManager=function(t){for(var n=0;n<e.length;n++)e[n].context===t.context&&e[n].name===t.name&&(e[n].mng.clean&&e[n].mng.clean(),e.splice(n,1))}},getManager:function(){},addManager:function(){},removeManager:function(){}})}),define("DS/DMUBaseExperience/EXPToolsVisualization",["require","exports","DS/Visualization/ThreeJS_DS","DS/DMUMeasurable/DMUMathsInfiniteGeometry","DS/DMUMeasurable/DMUToolsMaths"],function(e,t,n,r,i){"use strict";let o;class a{static getViewpointInfo(e){if(e){let t=(new n.Matrix4).lookAt(new n.Vector3,e.getSightDirection(),e.getUpDirection()),r=(new n.Quaternion).setFromRotationMatrix(t),o=i.quaternionToAxisSystem(r);return{position:e.getEyePosition(),target:e.getTarget(),sight:e.getSightDirection(),right:o.X,up:e.getUpDirection(),distance:e.getTargetDistance(),angle:e.getAngle(),projectionType:e.getProjectionType()}}}static moveViewpoint(e){if(!e||e&&!e.viewpoint)return;let t=a.getViewpointInfo(e.viewpoint),r=e.target?e.target.clone():new n.Vector3;r.sub((new n.Vector3).copy(e.sightDirection).multiplyScalar(e.targetDistance)),!t||t.position.equals(e.eyePosition?e.eyePosition:r)&&t.sight.equals(e.sightDirection)&&t.up.equals(e.upDirection)&&t.distance===e.targetDistance||(e.duration?e.viewpoint.moveTo({eyePosition:e.eyePosition?e.eyePosition:r,upDirection:e.upDirection,sightDirection:e.sightDirection,distanceToTarget:e.targetDistance,duration:e.duration}):(e.viewpoint.setEyePosition(e.eyePosition?e.eyePosition:r),e.viewpoint.setSightDirection(e.sightDirection),e.viewpoint.setUpDirection(e.upDirection),e.viewpoint.setTargetDistance(e.targetDistance)))}static getPickingInfo(e,t){let n,r,i=e.pick(e.getMousePosition(t),"mesh",!0);return void 0!==i&&(void 0!==i.position&&null!==i.position&&(n=i.position.clone()),void 0!==i.normal&&null!==i.normal&&(r=i.normal.clone())),{point:n,normal:r,paths:null==i?void 0:i.path}}static getNearPositionFrom2DCoordinates(e,t,n,r){if(!e||r&&!n)return;let i,o;if((i=a.getPickingInfo(t,e)).point&&i.paths&&i.paths.length&&!r)return i.point;if(n)return a.getPositionFromIntersection(t,i.point,n);let s=a.getMMPerPixelRatio(t,i.point);return s>1&&(s=1),o=t.currentViewpoint.getSightDirection().multiplyScalar(t.SCREEN_HEIGHT/2*window.devicePixelRatio*s).add(t.currentViewpoint.position),a.getPositionFromIntersection(t,i.point,o)}static getSelectedPathElement(e,t){let n=null,r=e.pick(e.getMousePosition(t),"mesh",!1);return r&&r.path&&r.path[0]&&(n=r.path[0]),n}static getWindowPositionFromPoint(e,t,r){let i=(new n.Projector).projectVector(t.clone(),e.viewpoints[0].getCamera()),o=Math.round((0-i.y)*(r.getContent().offsetHeight/2))+r.getContent().offsetHeight/2,a=Math.round(i.x*(r.getContent().offsetWidth/2))+r.getContent().offsetWidth/2,s=o>0&&o<r.getContent().offsetWidth&&a>0&&a<r.getContent().offsetWidth;return{top:o,left:a,bottom:r.getContent().offsetHeight-o,right:r.getContent().offsetWidth-a,inWindow:s}}static getViewerPositionFromPoint(e,t){if(!e||!e.currentViewpoint||!t)return;let r=(new n.Projector).projectVector(t.clone(),e.currentViewpoint.getCamera()),i=Math.round((0-r.y)*(e.canvas.offsetHeight/2)+e.canvas.offsetHeight/2),o=Math.round(r.x*(e.canvas.offsetWidth/2)+e.canvas.offsetWidth/2);return{top:i,left:o,bottom:e.canvas.offsetHeight-i,right:e.canvas.offsetWidth-o,inWindow:i>0&&i<e.canvas.offsetHeight&&o>0&&o<e.canvas.offsetWidth}}static get3DPositionFromScreenCoordinates(e){if(e.coords&&e.viewer){let t=a.getLineFromWindowPosition(e.viewer,e.coords.x,e.coords.y);if(t&&t.position&&t.direction&&t.position.x&&t.position.y&&t.position.z){let i=e.viewer.currentViewpoint.getSightDirection(),o=r.computeLinePlaneDistance(t.position.toArray(),t.direction.toArray(),[0,0,0],i.toArray()).aPosition;return new n.Vector3(o[0],o[1],o[2])}}return new n.Vector3(1,0,0)}static getLineFromWindowPosition(e,t,r){let i=new n.Vector3((t-window.pageXOffset)/e.canvas.offsetWidth*2-1,-(r-window.pageYOffset)/e.canvas.offsetHeight*2+1,.5),o=(new n.Projector).pickingRay(i,e.currentViewpoint.camera);return{position:o.ray.origin,direction:o.ray.direction}}static getDistanceFromPixel(e,t,n){let i=a.getViewerPositionFromPoint(e,t)||{left:0,top:0},o=a.getLineFromWindowPosition(e,i.left+n,i.top);return r.computePointLineDistance(t.toArray(),o.position.toArray(),o.direction.toArray()).distance}static getPositionFromIntersection(e,t,i,o){let a,s;if(t instanceof n.Vector3){if(a=this.getViewerPositionFromPoint(e,t)){if(o&&"false"!==localStorage.getItem("DMUSnapHandlesToGrid")){let e=parseFloat(localStorage.getItem("DMUSnapHandlesGridValue")||""),t=this.convertModelToPixels({sizeInMM:isNaN(e)?1:e});a.left=Math.round(Math.round(a.left/t)*t),a.top=Math.round(Math.round(a.top/t)*t)}s=this.getLineFromWindowPosition(e,a.left||0,a.top||0)}}else t instanceof n.Vector2&&(s=this.getLineFromWindowPosition(e,t.x,t.y));let l=this.getViewpointInfo(e.currentViewpoint),c=r.computeLinePlaneDistance(null==s?void 0:s.position.toArray(),null==s?void 0:s.direction.toArray(),i.toArray(),null==l?void 0:l.sight.toArray());return new n.Vector3(c.aPosition[0],c.aPosition[1],c.aPosition[2])}static get2DSnappedPosition(e,t){let r=e.clone();if("false"!==localStorage.getItem("DMUSnapHandlesToGrid")){let e=parseFloat(localStorage.getItem("DMUSnapHandlesGridValue")||""),i=this.convertModelToPixels({sizeInMM:isNaN(e)?1:e});if("number"==typeof t){let e=new n.Vector2(r.x*Math.cos(t)-r.y*Math.sin(t),r.x*Math.sin(t)+r.y*Math.cos(t)),o=Math.round(Math.round(e.x/i)*i),a=Math.round(Math.round(e.y/i)*i);r=new n.Vector2(o*Math.cos(-t)-a*Math.sin(-t),o*Math.sin(-t)+a*Math.cos(-t))}else r.x=Math.round(Math.round(r.x/i)*i),r.y=Math.round(Math.round(r.y/i)*i)}return r}static getMMPerPixelRatio(e,t){let r,i=e.currentViewpoint;if(1===i.getProjectionType())r=i.camera.top-i.camera.bottom;else{let e=i.getAngle()*Math.PI/180,o=i.getEyePosition(),a=(new n.Vector3).copy(t),s=(new n.Vector3).subVectors(a,o);r=2*Math.tan(.5*e)*s.dot(i.getSightDirection())}return Math.abs(r/e.SCREEN_HEIGHT)}static getMMPerPtRatio(){return 2.83465}static convertModelToPixels(e){return e.coords?e.sizeInMM/a.getMMPerPixelRatio(e.viewer,e.coords):e.sizeInMM*(96/25.4)}static convertPixelToModel(e){return e.coords?e.sizeInPixels*a.getMMPerPixelRatio(e.viewer,e.coords):e.sizeInPixels/(96/25.4)}static async computeImage(e){if(!e||e&&(!e.viewer||!e.width||!e.height))return;o||(o=document.createElement("canvas"));let t=e.viewer.SCREEN_HEIGHT,n=Math.round(t*(e.width/e.height)),r=2*e.height,i=2*e.width,a=new ImageData(n,t);e.viewer.renderToTarget(a,e.viewpoint?e.viewpoint:e.viewer.currentViewpoint),o.height=r,o.width=i;let s=o.getContext("2d");if(s){let e=await createImageBitmap(a,0,0,a.width,a.height);s.clearRect(0,0,o.width,o.height),s.scale(1,-1),s.drawImage(e,0,0,o.width,-o.height),e.close()}let l=new Image;return l.src=o.toDataURL("image/jpeg"),l}}return a}),define("DS/DMUBaseExperience/EXPToolsMaterial",["DS/Visualization/ThreeJS_DS","DS/Mesh/Mesh","DS/Visualization/MaterialManager"],function(e,t,n){"use strict";var r,i={createBasicMaterial:function(t){return new e.MeshBasicMaterial({color:!t.color||isNaN(t.color.r)||isNaN(t.color.g)||isNaN(t.color.b)?t.color?new e.Color(t.color):new e.Color:t.color,side:e.DoubleSide,transparent:!0,opacity:t.opacity||0===t.opacity?t.opacity:1,force:!0})},getDashType:function(e){var n=e;return isNaN(n)&&n.toUpperCase?(n=n.toUpperCase(),n={SOLID:t.LinePatternEnum.SOLID,DOTTED:t.LinePatternEnum.DOTTED,DASHED:t.LinePatternEnum.DASHED,DOT_DASHED:t.LinePatternEnum.DOTDASHED,PHANTOM:t.LinePatternEnum.PHANTOM,SMALL_DOT:t.LinePatternEnum.SMALLDOTTED,JIS_AXIS:t.LinePatternEnum.JISAXIS}[n]):n=parseFloat(n),n},createLineMaterial:function(t){return new e.LineBasicMaterial({color:!t.color||isNaN(t.color.r)||isNaN(t.color.g)||isNaN(t.color.b)?t.color?new e.Color(t.color):new e.Color:t.color,lineWidth:isNaN(t.lineWidth)?1:t.lineWidth,opacity:"number"==typeof t.opacity?t.opacity:1,transparent:!0,force:!0,dashType:i.getDashType(t.pattern),isCPUPattern:!0,polygonBorderMode:!0})},retrieveMaterialFromGAS:function(e){if(r||(r=new n),e.lineWidth||e.pattern)return i.createLineMaterial(e);if(e.symbol)return r.createPointMaterial(e);var t=r.getMaterialFromGAS({color:e.color,opacity:"number"==typeof e.opacity?e.opacity:1,transparent:!0,pattern:e.pattern,isCPUPattern:!0,polygonBorderMode:!0,size:e.size});return t&&(t.force=!0),t}};return i}),define("DS/DMUBaseExperience/EXPControllerEvents",[],function(){"use strict";var e={REVISION:"1",Events:{EXPRootDetachedEvent:"EXPRootDetachedEvent",EXPRootAttachedEvent:"EXPRootAttachedEvent",EXPRootAddedEvent:"EXPRootAddedEvent",EXPRootRemovedEvent:"EXPRootRemovedEvent",EXPBeginRootLoadingEvent:"EXPBeginRootLoadingEvent",EXPRootAlreadyExistingEvent:"EXPRootAlreadyExistingEvent",EXPLoadingStartedEvent:"EXPLoadingStartedEvent",EXPAssetChangedEvent:"EXPAssetChangedEvent",EXPExperienceDisposed:"EXPExperienceDisposed",EXPLoadingCompleteEvent:"EXPLoadingCompleteEvent",EXPLoadingFailureEvent:"EXPLoadingFailureEvent",EXPMoveEvent:"EXPMoveEvent",EXPEndReparentEvent:"EXPEndReparentEvent",EXPBeginReparentEvent:"EXPBeginReparentEvent",EXPReparentFailureEvent:"EXPReparentFailureEvent",EXPInsertExistingFailureEvent:"EXPInsertExistingFailureEvent",EXPInsertExistingEvent:"EXPInsertExistingEvent",EXPEndDeleteEvent:"EXPEndDeleteEvent",EXPBeginDeleteEvent:"EXPBeginDeleteEvent",EXPDefaultStreamChangedEvent:"EXPDefaultStreamChangedEvent",EXPStartProgressiveLoad:"EXPStartProgressiveLoad",EXPEndProgressiveLoad:"EXPEndProgressiveLoad",EXPApplyFilterBeginEvent:"EXPApplyFilterBeginEvent",EXPFilterAppliedEvent:"EXPFilterAppliedEvent",EXPRemoveFilterBeginEvent:"EXPRemoveFilterBeginEvent",EXPFilterRemovedEvent:"EXPFilterRemovedEvent",EXPRefreshEvent:"EXPRefreshEvent",EXPRefreshBeginEvent:"EXPRefreshBeginEvent",EXPRefreshCompletedEvent:"EXPRefreshCompletedEvent",EXPHideEvent:"EXPHideEvent",EXPShowEvent:"EXPShowEvent",EXPExclusiveShowEvent:"EXPExclusiveShowEvent",EXPHideShowEvent:"EXPHideShowEvent",EXPRootModifiedEvent:"EXPRootModifiedEvent",EXPLineLayoutComputationBeginEvent:"EXPLineLayoutComputationBeginEvent",EXPLineLayoutComputationEndEvent:"EXPLineLayoutComputationEndEvent",EXPModelUpdatedEvent:"EXPModelUpdatedEvent"},mapPadEvent:{EXPRootDetachedEvent:["onRootDetached"],EXPRootAttachedEvent:["onRootAttached"],EXPRootAddedEvent:["onRootAdded"],EXPRootRemovedEvent:["onRootRemoved"],EXPBeginRootLoadingEvent:["onBeginRootLoading"],EXPRootAlreadyExistingEvent:["onRootAlreadyExisting"],EXPLoadingStartedEvent:["ASSET/LOADINGSTARTED"],EXPAssetChangedEvent:["ASSET/CHANGE"],EXPExperienceDisposed:["EXPERIENCE/DISPOSE"],EXPLoadingCompleteEvent:["onLoadingComplete","ASSET/LOADINGFINISHED"],EXPLoadingFailureEvent:["onLoadingFailure"],EXPMoveEvent:["onMove"],EXPEndReparentEvent:["onEndReparent"],EXPBeginReparentEvent:["onBeginReparent"],EXPReparentFailureEvent:["onReparentFailure"],EXPInsertExistingFailureEvent:["onInsertExistingFailure"],EXPInsertExistingEvent:["onInsertExisting"],EXPEndDeleteEvent:["onEndDelete"],EXPBeginDeleteEvent:["onBeginDelete"],EXPDefaultStreamChangedEvent:["onDefaultStreamChanged"],EXPStartProgressiveLoad:["onStartProgressiveLoad"],EXPEndProgressiveLoad:["onEndProgressiveLoad"],EXPApplyFilterBeginEvent:["onBeginFilterApplied"],EXPFilterAppliedEvent:["onFilterApplied"],EXPRemoveFilterBeginEvent:["onBeginFilterRemoved"],EXPFilterRemovedEvent:["onFilterRemoved"],EXPRefreshEvent:["onRefresh"],EXPRefreshBeginEvent:["onRefreshBegin"],EXPRefreshCompletedEvent:["onRefreshCompleted"],EXPHideShowEvent:["onHide","onShow","onExclusiveShow"],EXPRootModifiedEvent:["onRootDetached","onRootAttached","onRootAdded","onRootRemoved"],EXPLineLayoutComputationBeginEvent:["onLayoutComputationBegin"],EXPLineLayoutComputationEndEvent:["onLayoutComputationEnd"],EXPModelUpdatedEvent:["onModelUpdated"]}};return e}),define("DS/DMUBaseExperience/EXPController",["UWA/Class","DS/Core/ModelEvents","DS/DMUBaseExperience/EXPControllerEvents"],function(e,t,n){"use strict";return e.extend({init:function(e){this._parent(e);var r=this,i=new t,o={};function a(e,t,n){return n?n.subscribe({event:e},function(e){if(r&&e)if(e.nodes)for(var n=0;n<e.nodes.length;n++)r.fireEvent(t,e.nodes[n]);else e.paths&&e.paths.length&&e.paths[0].length&&"function"!=typeof e.paths[0].getLastElement&&(e.areIdPaths=!0),r.fireEvent(t,e);else r&&r.fireEvent(t)}):null}this.fireEvent=function(e,t){i&&e&&i.publish({event:e,data:t})},this.addEvent=function(t,s){var l=n.mapPadEvent[t],c=[],u=function(e,t){if(i&&e&&t)return i.subscribe(e,t)}({event:t},s);switch(t){case n.Events.EXPHideShowEvent:e.context&&e.context.getHideShowController()&&l.forEach(function(n){c.push({PADShowController:a(n,t,e.context.getHideShowController())})});break;case n.Events.EXPRefreshEvent:case n.Events.EXPRefreshBeginEvent:case n.Events.EXPRefreshCompletedEvent:case n.Events.EXPRootAddedEvent:case n.Events.EXPRootRemovedEvent:case n.Events.EXPApplyFilterBeginEvent:case n.Events.EXPFilterAppliedEvent:case n.Events.EXPRemoveFilterBeginEvent:case n.Events.EXPFilterRemovedEvent:case n.Events.EXPRootAttachedEvent:case n.Events.EXPRootDetachedEvent:case n.Events.EXPMoveEvent:case n.Events.EXPBeginRootLoadingEvent:case n.Events.EXPRootAlreadyExistingEvent:case n.Events.EXPLoadingStartedEvent:case n.Events.EXPExperienceDisposed:case n.Events.EXPAssetChangedEvent:case n.Events.EXPLoadingCompleteEvent:case n.Events.EXPLoadingFailureEvent:case n.Events.EXPEndReparentEvent:case n.Events.EXPBeginReparentEvent:case n.Events.EXPReparentFailureEvent:case n.Events.EXPInsertExistingFailureEvent:case n.Events.EXPInsertExistingEvent:case n.Events.EXPEndDeleteEvent:case n.Events.EXPBeginDeleteEvent:case n.Events.EXPDefaultStreamChangedEvent:case n.Events.EXPRootModifiedEvent:case n.Events.EXPStartProgressiveLoad:case n.Events.EXPEndProgressiveLoad:e.context&&e.context.getController()&&l.forEach(function(n){c.push({PADController:a(n,t,e.context.getController())})});break;case n.Events.EXPLineLayoutComputationBeginEvent:case n.Events.EXPLineLayoutComputationEndEvent:case n.Events.EXPModelUpdatedEvent:l.forEach(function(n){c.push({PAD3DViewer:function(t,n){return e.context?e.context.subscribe({event:t},function(e){r&&r.fireEvent(n,e)}):null}(n,t,e.context)})})}return c&&c.length&&(o[u]=c),u},this.removeEvent=function(t){var n,r=o[t],a=e.context.getController(),s=e.context.getHideShowController();if(r&&r.length){for(var l=0;l<r.length;l++)a&&r[l].PADController&&a.unsubscribe(r[l].PADController),s&&r[l].PADShowController&&s.unsubscribe(r[l].PADShowController),e.context&&r[l].PAD3DViewer&&e.context.unsubscribe(r[l].PAD3DViewer);delete o[t]}n=t,i&&n&&i.unsubscribe(n)},this.destroy=function(){for(var e=Object.keys(o),t=e.length-1;t>=0;t--)r.removeEvent(e[t]);r=i=o=null}}})}),define("DS/DMUBaseExperience/DMUContextManager",["UWA/Class","DS/DMUBaseExperience/EXPController"],function(e,t){"use strict";var n=e.singleton({init:function(){var e=this,n=[],r=[];let i;this.getReviewContext=function(e){return function(e,t){if(e.viewer||e.context)for(var n=0;n<t.length;n++)if(e.context&&t[n].context===e.context||e.viewer&&e.viewer===t[n].context.getViewer())return t[n].controller}(e,n)},this.setCurrentReviewContext=function(e){i=e},this.getCurrentReviewContext=function(){return i},this.setReviewContext=function(e){!function(e,t){if(e.viewer||e.context){for(var n=0;n<t.length;n++)if(e.context&&t[n].context===e.context||e.viewer&&t[n].context.getViewer()===e.viewer)return void(e.controller?t[n].controller=e.controller:t.splice(n,1));t.push({context:e.context,controller:e.controller})}}(e,n)},this.removeReviewContext=function(e){!function(e,t){for(var n=0;n<t.length;n++)if(e.context&&t[n].context===e.context||e.viewer&&e.viewer===t[n].context.getViewer()){t[n].controller&&(t[n].controller.remove(),t[n].controller=null),t.splice(n,1);break}}(e,n)},this.getContextViewer=function(e){var t;for(t=0;t<n.length;t++)if(e.reviewContext&&n[t].controller===e.reviewContext||e.viewer&&n[t].context.getViewer()===e.viewer)return n[t].context;var r=require("DS/PADUtils/PADContext").get();return r&&r.getViewer()===e.viewer?r:null},this.getEventsController=function(n){if(n){var i={context:n.context};if(n.context||(i.context=e.getContextViewer(n)),i.context){for(var o=0;o<r.length;o++)if(r[o].context===i.context)return r[o].counter++,r[o].controller;var a=new t(i);return r.push({context:i.context,controller:a,counter:1}),a}}},this.giveEventsController=function(e){if(e.context||e.viewer)for(var t=0;t<r.length;t++)if(r[t].context===e.context||r[t].context.getViewer()===e.viewer)return r[t].controller},this.unreferenceEventsController=function(e){for(var t=0;t<r.length;t++)r[t].context!==e.context&&r[t].context.getViewer()!==e.viewer||(r[t].counter--,r[t].counter<=0&&(r[t].controller.destroy(),r.splice(t,1)))};var o=[];this.setAuthoringFeatureTypes=function(e){-1===o.indexOf(e)&&o.push(e)},this.getAuthoringFeatureTypes=function(){return o}}});return n.init(),n}),define("DS/DMUBaseExperience/EXPUtils",["require","exports","DS/Visualization/ThreeJS_DS","DS/DMUBaseExperience/DMUContextManager","DS/ApplicationFrame/CommandsManager","DS/WebSystem/Settings"],function(e,t,n,r,i,o){"use strict";let a;class s{static getValue(e,t){let n,r=e.getParameters().length,i=e.getAttribute(t);for(let o=0;o<r&&void 0===n;o++){let r=e.getParameters()[o];r.name===t&&(n="bool"===r.type?i:"Color"===r.type?s.colorToHex(i):s.typeToStr(i,r.type))}return"sSectionRender"===t&&(n="CutOneSide"===i),"vTranslationValue"===t&&e.getTranslationValue&&void 0!==e.getTranslationValue()&&(n=e.getTranslationValue()),n}static setValue(e,t,n){let r,i;for(let o=0;o<t.getParameters().length;o++)if((i=t.getParameters()[o]).name===n){r="bool"===i.type?e:"Color"===i.type?s.hexToColor(e):s.strToType(e,i.type);break}i&&i.name===n&&("sSectionRender"===n&&(r=r?"CutOneSide":"NoCut"),"sTextContents"===n&&r&&!Array.isArray(r)&&(r=[e]),t.set({attribute:i.name,value:r}),"vTranslationValue"===n&&t.setTranslationValue&&t.setTranslationValue(r),t.refreshNode())}static cleanJSONString(e){let t=e;return t=(t=t.replace(/\\n/g,"\\n").replace(/\\'/g,"\\'").replace(/\\"/g,'\\"').replace(/\\&/g,"\\&").replace(/\\r/g,"\\r").replace(/\\t/g,"\\t").replace(/\\b/g,"\\b").replace(/\\f/g,"\\f")).replace(/[\u0000-\u0019]+/g,"")}static convertImageDataUrl(e){let t={type:"",data:""};if(e&&0===e.indexOf("data:image/")){let n=e.indexOf(";base64,");-1!==n&&(t.type=e.substr("data:image/".length,n-"data:image/".length),t.data=e.substr(n+";base64,".length,e.length-(n+";base64,".length)))}return t}static getImageDataUrl(e,t){if(e&&t)return"data:image/"+e+";base64,"+t}static colorToHex(e){if(e&&void 0!==e.r&&void 0!==e.g&&void 0!==e.b){if(e.r<0||e.g<0||e.b<0)return null;let t=Math.round(255*e.r).toString(16);t=t.length<2?"0"+t:t;let n=Math.round(255*e.g).toString(16);n=n.length<2?"0"+n:n;let r=Math.round(255*e.b).toString(16);return"#"+t+n+(r=r.length<2?"0"+r:r)}return""}static hexToRgb(e,t){let n;if(void 0!==e)if("#"!==e.substr(0,1)){let r=/(.*?)rgb\((\d+), *(\d+), *(\d+)\)/.exec(e);r&&(n="rgba("+r[2]+","+r[3]+","+r[4]+","+t+")")}else{let r=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(r,function(e,t,n,r){return t+t+n+n+r+r});let i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(i){let e={r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)};n="rgba("+e.r+","+e.g+","+e.b+","+t+")"}}return n}static strToType(e,t){if(null==e||""===e||null==t||""===t)return;let n=null;switch(t){case"bool":n=s.strToBool;break;case"int":n=s.strToInt;break;case"float":n=s.strToFloat;break;case"Color":n=s.strToColor;break;case"Vector3":n=s.strToVect;break;case"ListVector3":n=s.strToListVect;break;case"Vector2":n=s.strToVect2;break;case"ListVector2":n=s.strToListVect2;break;case"Matrix4":n=s.strToMat4;break;case"AABB":n=s.strToAABB;break;case"ImageURL":n=s.strToImageURL;break;case"string":return e;case"listStrings":n=s.strToListStrings;break;default:return e}return n(e)}static typeToStr(e,t){if(null==e||""===e||null==t||""===t)return;let n=null;switch(t){case"bool":n=s.boolToStr;break;case"int":n=s.intToStr;break;case"float":n=s.floatToStr;break;case"Color":n=s.colorToStr;break;case"Vector3":n=s.vectToStr;break;case"ListVector3":n=s.listVectToStr;break;case"Vector2":n=s.vect2ToStr;break;case"ListVector2":n=s.listVect2ToStr;break;case"Matrix4":n=s.mat4ToStr;break;case"AABB":n=s.aabbToStr;break;case"ImageURL":n=s.imageURLToStr;break;case"string":return e;case"listStrings":n=s.listStringsToStr;break;default:return e}return n(e)}static cloneType(e,t){let n;if(void 0!==e)if(null===e)n=e;else switch(t){case"Matrix4":n=e.clone();break;case"listStrings":case"listObjects":n=(n=n=[]).concat(e);break;default:n=e}return n}static strToColor(e){let t=e.replace(/[RGB( )]/gi,"").split(",");return(new n.Color).setRGB(parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2]))}static colorToStr(e){return!e||"object"!=typeof e||isNaN(e.r)||isNaN(e.g)||isNaN(e.b)?null:"RGB("+e.r+","+e.g+","+e.b+")"}static hexToColor(e){if(!e)return null;let t=new n.Color;return t.r=parseInt(e[1]+e[2],16)/255,t.g=parseInt(e[3]+e[4],16)/255,t.b=parseInt(e[5]+e[6],16)/255,t}static strToVect(e){let t="string"==typeof e?e.split(" "):null;return t?new n.Vector3(parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2])):3===e.length?new n.Vector3(e[0],e[1],e[2]):void 0}static vectToStr(e){if(e)return isNaN(e.x)||isNaN(e.y)||isNaN(e.z)?null:[e.x,e.y,e.z]}static strToListVect(e){let t=[];for(let n=0;n<e.length;n++)t.push(s.strToVect(e[n]));return t}static listVectToStr(e){let t=[];for(let n=0;n<e.length;n++)t.push(s.vectToStr(e[n]));return t}static strToVect2(e){let t="string"==typeof e?e.split(" "):null;return t?new n.Vector2(parseFloat(t[0]),parseFloat(t[1])):2===e.length?new n.Vector2(e[0],e[1]):void 0}static vect2ToStr(e){if(e)return isNaN(e.x)||isNaN(e.y)?null:[e.x,e.y]}static strToListVect2(e){let t=[];for(let n=0;n<e.length;n++)t.push(s.strToVect2(e[n]));return t}static listVect2ToStr(e){let t=[];for(let n=0;n<e.length;n++)t.push(s.vect2ToStr(e[n]));return t}static strToBool(e){return"string"==typeof e?"true"===e||"false"!==e&&null:e}static boolToStr(e){return e}static strToFloat(e){return parseFloat(e)}static floatToStr(e){return isNaN(e)?null:e}static strToInt(e){return parseInt(e,10)}static intToStr(e){return isNaN(e)?null:e}static strToMat4(e){let t;if("object"==typeof e&&e.X){let r=s.strToVect(e.X),i=s.strToVect(e.Y),o=s.strToVect(e.Z),a=s.strToVect(e.Origin);t=new n.Matrix4(r.x,i.x,o.x,a.x,r.y,i.y,o.y,a.y,r.z,i.z,o.z,a.z,0,0,0,1)}else if("string"==typeof e){t=new n.Matrix4;let r=e.split(" ");for(let e=0;e<16;e++)t.elements[e]=parseFloat(r[e])}return t}static mat4ToStr(e){let t=e.elements;return{Origin:[t[12],t[13],t[14]],X:[t[0],t[1],t[2]],Y:[t[4],t[5],t[6]],Z:[t[8],t[9],t[10]]}}static strToAABB(e){let t=[0,0,0,0,0,0];if(e.split){let n=e.split(",");for(let e=0;e<n.length&&e<6;e++)t[e]=parseFloat(n[e])}else t=e;return t}static aabbToStr(e){return e}static strToImageURL(e){return e&&0===e.indexOf('"')?JSON.parse(e):e}static imageURLToStr(e){return e&&0===e.indexOf('"')?JSON.parse(e):e}static strToListStrings(e){let t=e.split?e.split(" "):null;return t||e}static listStringsToStr(e){return e&&e.length?e:null}static isEqual(e,t){return JSON.stringify(e)===JSON.stringify(t)}static getUrlVariables(){let e={};return window.location.href.replace(/[?&]+([^=&]+)(=([^&]*))?/gi,function(t,n,r,i){e[n]=void 0===i?null:i}),e}static isEnvActivated(e,t){let n=!1;return(void 0!==s.getUrlVariables()[e]||t&&void 0!==o.get(e))&&(n=!0),n}static isPersistenceAllowed(t){if(!t||"function"!=typeof t.onPersistenceAllowed||"function"!=typeof t.onPersistenceNotAllowed)return;let n=e("DS/DMUReadPersistence/DMUReviewPersistenceServicesSetting");n&&n.getServerContext({onComplete:function(e){let n=function(e,t){return!(t.length>e.length)&&-1!==e.indexOf(t)};if(e){if(n(e,"VPLMSecuredCrossAccess")||n(e,"VPLMViewer"))return void t.onPersistenceNotAllowed();t.onPersistenceAllowed()}},onFailure:t.onPersistenceNotAllowed})}static checkIfCommandIsRunning(e){let t=!1;return s.getCurrentCommand(e)&&(t=!0),t}static allowManipulation(e){let t=r.getContextViewer({reviewContext:r.getReviewContext({viewer:e.viewer})}),n=i.getCommand(i._getCurrent(t.getCommandContext()),t.getCommandContext());return n&&n.allowManipulation?n.allowManipulation(e):void 0}static getCurrentCommand(e){let t,n=r.getContextViewer({reviewContext:r.getReviewContext({viewer:e})}),o=i._getCurrent(n.getCommandContext());return o&&(t=i._getDefaultCommand(n.getCommandContext())),o&&t&&(o=o!==t._id?o:null),o}static _sendUsageProbe(e,t,n){if(!a)return void window.require(["DS/PADServices/utils/PADTrackerManager"].concat([]),function(e,t,n,r){a=r,s._sendUsageProbe(e,t,n)}.bind(s,e,t,n));let r=a.getPADTracker({eventCategory:"usage",eventAction:e}),i={eventLabel:t};void 0!==n&&(i.eventValue=n),r.setEventData(i),r.trackPageEvent()}}return s}),define("DS/DMUBaseExperience/EXPObject",["UWA/Class","DS/DMUBaseExperience/EXPUtils","DS/DMUBaseExperience/DMUContextManager"],function(e,t,n){"use strict";return e.extend({init:function(e,r){var i=this;this._viewer=e;var o=e,a=n.getContextViewer({viewer:e});a&&(this._frmWindow=a.getFrameWindow());var s,l=!1,c=!1,u=!0,g=!1,f=!0,d=!1,v=!0,E=[],h=null,D=[];function p(e,t){var n=typeof e;if(typeof t!==n)return!1;if("string"===n||"number"===n||"boolean"===n)return e===t;if(Array.isArray(e)){if(!Array.isArray(t))return!1;if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!p(e[r],t[r]))return!1}else if("object"===n)return e.toArray?!!t.toArray&&p(e.toArray(),t.toArray()):e.toString?!!t.toString&&p(e.toString(),t.toString()):e===t;return!0}this.getViewer=function(){return o},this.getFrameWindow=function(){return a.getFrameWindow()},this.fireEvent=function(t,r){s||(s=n.giveEventsController({viewer:e})),s&&s.fireEvent(t,r)},this.makeDirty=function(){r&&r.setDirtyFlag&&!r.isReadOnly()&&r.setDirtyFlag(!0)},this.addParameters=function(e){E=E.concat(e);for(var n=0;n<e.length;n++)void 0!==e[n].defaultValue&&(i["_"+e[n].name]=t.cloneType(e[n].defaultValue,e[n].type))},this.getParameters=function(){return E},this.removeParameters=function(e){for(let t=0;t<e.length;t++){for(let n=E.length-1;n>=0;n--)if(E[n].name===e[t]){E.splice(n,1);break}delete i["_"+e[t]]}},this.getNode=function(){return h},this.setNode=function(e){h||(h=e)},this.refreshNode=function(){},this.setInEdition=function(e){e!==g&&(g=e,i.fireEvent("onDMUObjectEdited",{dmuObject:i,flag:g}))},this.isInEdition=function(){return g},this.setActiveFlag=function(e){e!==f&&(f=e,i.fireEvent("onDMUObjectActiveFlagChanged",{dmuObject:i,flag:f}))},this.getActiveFlag=function(){return f},this.setVisibleFlag=function(e,t){(e!==v||t)&&(v=e,i.fireEvent("onDMUObjectVisibleFlagChanged",{dmuObject:i,flag:v}))},this.isVisible=function(){return v},this.setDisplayedFlag=function(e){e!==d&&(d=e,i.fireEvent("onDMUObjectDisplayedFlagChanged",{dmuObject:i,flag:d}))},this.isDisplayed=function(){return d},this.setReadOnly=function(e,t){e!==c&&(!e&&i.initAuthoringData?i.initAuthoringData():e&&i.removeAuthoringData&&i.removeAuthoringData(),c=e,i.fireEvent("onDMUObjectReadOnlyFlagChanged",{dmuObject:i,flag:c}),t&&i.getNode()&&i.getNode().setReadOnly&&i.getNode().setReadOnly(c))},this.isReadOnly=function(){return c},this.setEditable=function(e){e!==u&&(u=e)},this.isEditable=function(){return u},this.setTemporary=function(e){if(e!==l){var t;l=e;for(var n=E.length-1;n>=0;n--)if((t=i.getAttribute(E[n].name))&&"listObjects"===E[n].type&&t.length)for(var r=t.length-1;r>=0;r--)t[r].setTemporary&&t[r].setTemporary(e)}},this.isTemporary=function(){return l},this._internalRemove=function(){var e;if(h&&h.remove(),E){for(var t=E.length-1;t>=0;t--)if(e=i.getAttribute(E[t].name))if("listObjects"===E[t].type&&e.length){for(var n=e.length-1;n>=0;n--){let t=e[n];e.splice(n,1),t.remove&&t.remove()}e.splice(0,e.length)}else e.remove&&e.remove(),e=null;E.length=0}i.makeDirty(),i.isTemporary()||i.fireEvent("onDMUObjectDeleted",{dmuObject:i}),h=s=null,d=v=f=!1},this._internalGetAttribute=function(e){return void 0!==e&&void 0!==i["_"+e]?i["_"+e]:void 0},this._internalSetAttribute=function(e,t){e&&i.hasAttribute(e)&&i["_"+e]!==t&&(i["_"+e]=t,i.makeDirty(),i.fireEvent("onDMUObjectAttributeModified",{dmuObject:i,attrName:e,value:t}))},this.setAttributes=function(e){if(e&&e.length)for(var t=0;t<e.length;t++)i.setAttribute(e[t].name,e[t].value)},this.hasAttribute=function(e){for(var t=0;t<E.length;t++)if(E[t].name===e)return!0;return!1},this.isAttributeReadOnly=function(e){for(var t=0;t<D.length;t++)if(D[t]===e)return!0;return!1},this.setListOfReadOnlyAttributes=function(e){D=e||[]},this.compareAttributes=function(e){if(!e||!e.length)return!1;for(var t=0;t<e.length;t++)for(var n=0;n<E.length;n++)if(E[n].name===e[t].name&&!p(e[t].value,i.getAttribute(e[t].name)))return!1;return!0},this.getType=function(){return"DMU"+i.getAttribute("sType")},this.getParent=function(){return r},this._internalSet=function(e){if(e){var t=function(e){e&&(e.mode?"addValue"===e.mode&&(null!==e.index&&void 0!==e.index?i["_"+e.attribute].splice(e.index,0,e.value):i["_"+e.attribute].push(e.value),i.makeDirty(),i.fireEvent("onDMUObjectAttributeModified",{dmuObject:i,attrName:e.attribute,value:i["_"+e.value]})):i.setAttribute(e.attribute,e.value))};if(Array.isArray(e))for(var n=0;n<e.length;n++)t(e[n]);else t(e)}},setTimeout(function(){i.fireEvent("onDMUObjectCreated",{dmuObject:i})})},remove:function(){this._internalRemove&&this._internalRemove()},set:function(e){this._internalSet&&this._internalSet(e)},setAttribute:function(e,t){this._internalSetAttribute&&this._internalSetAttribute(e,t)},getAttribute:function(e){if(this._internalGetAttribute)return this._internalGetAttribute(e)}})}),define("DS/DMUBaseExperience/DMUObject",["require","exports","DS/DMUBaseExperience/DMUContextManager","DS/DMUBaseExperience/EXPUtils"],function(e,t,n,r){"use strict";class i{constructor(e,t){let o,a=this,s=n.getContextViewer({viewer:e}),l=!1,c=!1,u=!1,g=!0,f=!1,d=!0,v=[],E=null,h=[],D={};function p(e,t){let n=typeof e;if(typeof t!==n)return!1;if("string"===n||"number"===n||"boolean"===n)return e===t;if(Array.isArray(e)){if(!Array.isArray(t))return!1;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!p(e[n],t[n]))return!1}else if("object"===n)return e.toArray?!!t.toArray&&p(e.toArray(),t.toArray()):e.toString?!!t.toString&&p(e.toString(),t.toString()):e===t;return!0}this.getFrameWindow=function(){return null==s?void 0:s.getFrameWindow()},this.fireEvent=function(t,r){o||(o=n.giveEventsController({viewer:e})),o&&o.fireEvent(t,r)},this.makeDirty=function(){t&&t.setDirtyFlag&&!t.isReadOnly()&&t.setDirtyFlag(!0)},this.addParameters=function(e){v=v.concat(e);for(let t=0;t<e.length;t++)void 0!==e[t].defaultValue&&a.setAttribute(e[t].name,r.cloneType(e[t].defaultValue,e[t].type))},this.getParameters=function(){return v},this.removeParameters=function(e){for(let t=0;t<e.length;t++){for(let n=v.length-1;n>=0;n--)if(v[n].name===e[t]){v.splice(n,1);break}delete D[e[t]]}},this.getNode=function(){return E},this.setNode=function(e){E||(E=e)},this.refreshNode=function(){},this.setInEdition=function(e){e!==u&&(u=e,a.fireEvent("onDMUObjectEdited",{dmuObject:a,flag:u}))},this.isInEdition=function(){return u},this.setActiveFlag=function(e){e!==g&&(g=e,a.fireEvent("onDMUObjectActiveFlagChanged",{dmuObject:a,flag:g}))},this.getActiveFlag=function(){return g},this.setVisibleFlag=function(e,t){(e!==d||t)&&(d=e,a.fireEvent("onDMUObjectVisibleFlagChanged",{dmuObject:a,flag:d}))},this.isVisible=function(){return d},this.setDisplayedFlag=function(e){e!==f&&(f=e,a.fireEvent("onDMUObjectDisplayedFlagChanged",{dmuObject:a,flag:f}))},this.isDisplayed=function(){return f},this.setReadOnly=function(e,t){e!==c&&(!e&&a.initAuthoringData?a.initAuthoringData():e&&a.removeAuthoringData&&a.removeAuthoringData(),c=e,a.fireEvent("onDMUObjectReadOnlyFlagChanged",{dmuObject:a,flag:c}),t&&a.getNode()&&a.getNode().setReadOnly&&a.getNode().setReadOnly(c))},this.isReadOnly=function(){return c},this.isEditable=function(){return!0},this.setTemporary=function(e){if(e===l)return;let t;l=e;for(let n=v.length-1;n>=0;n--)if((t=a.getAttribute(v[n].name))&&"listObjects"===v[n].type&&Array.isArray(t))for(let n=t.length-1;n>=0;n--)t[n].setTemporary&&t[n].setTemporary(e)},this.isTemporary=function(){return l},this.remove=function(){let e;if(E&&E.remove(),v){for(let t=v.length-1;t>=0;t--)if(e=a.getAttribute(v[t].name))if("listObjects"===v[t].type&&Array.isArray(e)){for(let t=e.length-1;t>=0;t--){let n=e[t];e.splice(t,1),n.remove&&n.remove()}e.splice(0,e.length)}else e instanceof i&&(e.remove(),e=null);v.length=0}a.makeDirty(),a.isTemporary()||a.fireEvent("onDMUObjectDeleted",{dmuObject:a}),E=o=null,f=d=g=!1},this.getAttribute=function(e){return D[e]},this.setAttribute=function(e,t){e&&a.hasAttribute(e)&&D[e]!==t&&(D[e]=t,a.makeDirty(),a.fireEvent("onDMUObjectAttributeModified",{dmuObject:a,attrName:e,value:t}))},this.setAttributes=function(e){if(e&&e.length)for(let t=0;t<e.length;t++)a.setAttribute(e[t].name,e[t].value)},this.hasAttribute=function(e){for(let t=0;t<v.length;t++)if(v[t].name===e)return!0;return!1},this.isAttributeReadOnly=function(e){for(let t=0;t<h.length;t++)if(h[t]===e)return!0;return!1},this.setListOfReadOnlyAttributes=function(e){h=e||[]},this.compareAttributes=function(e){if(!e||!e.length)return!1;for(let t=0;t<e.length;t++)for(let n=0;n<v.length;n++)if(v[n].name===e[t].name&&!p(e[t].value,a.getAttribute(e[t].name)))return!1;return!0},this.getType=function(){return"DMU"+a.getAttribute("sType")},this.getParent=function(){return t},this.set=function(e){if(e){let t=function(e){if(e){let t=D[e.attribute];e.mode?"addValue"===e.mode&&Array.isArray(t)&&(null!==e.index&&void 0!==e.index?t.splice(e.index,0,e.value):t.push(e.value),a.makeDirty(),a.fireEvent("onDMUObjectAttributeModified",{dmuObject:a,attrName:e.attribute,value:t})):a.setAttribute(e.attribute,e.value)}};if(Array.isArray(e))for(let n=0;n<e.length;n++)t(e[n]);else t(e)}},setTimeout(function(){a.fireEvent("onDMUObjectCreated",{dmuObject:a})})}}return i}),define("DS/DMUBaseExperience/DMUModelServices",["require","exports","DS/DMUBaseExperience/EXPUtils"],function(e,t,n){"use strict";const r={DMUFormat:"DS/DMUFormatEdition/DMUFormatExport",DMUSlide:"DS/DMUFormatEdition/DMUFormatExport",DMUMeasure:"DS/DMUMeasure/DMUMeasureExport",DMUExternalLinks:"DS/DMUBaseReview/DMULinksManagerExport"};class i{static async getObjectBaseDefinition(e){async function t(e,t){let r;if(void 0!==e)switch(t){case"object":e&&(r=await i.getObjectDefinition(e));break;case"listObjects":if(e&&e.length>0){r=[];for(let t=0;t<e.length;t++){let n={};n=await i.getObjectDefinition(e[t]),r.push(n)}}break;default:r=n.typeToStr(e,t)}return r}let r={},o=e.getParameters();if(o)for(let n=0;n<o.length;n++){let i=o[n];if(i.JSONname){let n,o,a=r,s=i.JSONname.split("."),l=!0;for(;l;)if(n=s.shift()){if(0===s.length){null!=(o=await t(e.getNominalAttribute?e.getNominalAttribute(i.name):e.getAttribute(i.name),i.type))&&""!==o&&(a[n]=o),l=!1;break}void 0===a[n]&&(a[n]={}),a=a[n]}}}return r}static getObjectDefinition(e){return new Promise((t,n)=>{i.getObjectBaseDefinition(e).then(i=>{if(i){let n=r[e.getType()];n?window.require([n],n=>{if("getObjectDefinition"in n){let r=n.getObjectDefinition(e);t(Object.assign(i,r))}else t(i)}):t(i)}else n(new Error("Object definition not generated"))},n)})}}return i}),define("DS/DMUBaseExperience/EXPImportServices",["UWA/Class","DS/DMUBaseExperience/EXPUtils","DS/DMUBaseExperience/DMUFactory"],function(e,t,n){"use strict";return e.extend({init:function(e){var r,i=this,o=[],a=e?e.experience:null,s=e?e.markupRepRef:null,l=e?e.appType:null;function c(e,n,r,o){switch(n){case"object":return i.importData(e,r,o);case"listObjects":for(var a=[],s=0;s<e.length;s++)a.push(i.importData(e[s],r,o));return a;default:return t.strToType(e,n)}}this.importDataModel=function(t,r){n.initFactory(e.viewer,function(){var e=[];if(t&&t.Model&&t.Model.length)for(var n=0;n<t.Model.length;n++)e.push(i.importData(t.Model[n],a,a));r(e)})},this.importData=function(e,t,o){var a=null,s=null!=e?e.type:null;return s&&(a=n.buildComponent(s,t,o,l))&&a.importData&&(a.importData(e,i,o),a.getUUIDMappingTable&&(r=a.getUUIDMappingTable())),a},this.fillObjectAttributes=function(e,t,n){if(e&&t)for(var r=e.getParameters(),i=0;i<r.length;i++){var o=r[i];if(o.JSONname)for(var a=t,s=o.JSONname.split(".");null!=a&&""!==a;)0===s.length&&e.setAttribute(o.name,c(a,o.type,e,n)),a=a[s.shift()]}},this.registerForPostImport=function(e){e&&e.afterImport&&o.push(e)},this.postImport=function(){for(var e=0;e<o.length;e++)o[e]&&o[e].afterImport(s);o.length=0},this.getUUIDMappingTable=function(){return r}}})});