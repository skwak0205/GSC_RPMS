function getHostName(e){var t=e.match(/:\/\/(www[0-9]?\.)?(.[^/:]+)/i);return null!=t&&t.length>2&&"string"==typeof t[2]&&t[2].length>0?t[2]:null}function getHostName(e){var t=e.match(/http[s]?:\/\/(www[0-9]?\.)?(.[^/:]+)/i);return null!=t&&t.length>2&&"string"==typeof t[2]&&t[2].length>0?{domain:t[0],domainToDisplay:t[2]}:null}define("DS/SwymUIComponents/script/feature/core/ui-components/edit-view-mode-switcher/edit-view-mode-switcher",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/macro/user-aboutme-view","DS/SwymUICore/script/lib/view/generic/swym-view","DS/UIKIT/Input/Button","DS/WebappsUtils/Console","DS/PubSub/PubSub"],function(e,t,i,n,o,s){"use strict";var a=i.extend({name:" edit-view-mode-switch",className:"",_doNotReactToEditAllEvent:!1,_mode:null,_readView:null,_editable:null,_editView:null,_modes:["edit","read"],_actionOnSave:null,domEvents:{"click .cancelButton":"onCancelClick","click .saveButton":"onSaveClick","click .fonticon-trash":"onDestroyClick","focusin .edit-content":"_onFocus","focusout .edit-content":"_onBlur"},_onBlur:function(){this.container.removeClassName("block-color-editall")},_onFocus:function(){this.container.addClassName("block-color-editall")},onDestroyClick:function(){this._actionOnDestroy()},onSaveClick:function(){var e=this.getControl("save-button");e&&e.load(),!1===this._actionOnSave()?e.load(!1):(this._dispatchEvent(!1),this.model.dispatchEvent("onSave"))},_dispatchEvent:function(e){this.model.collection&&(this.model.has("mid")||!0!==e||this.model.collection.remove(this.model))},onCancelClick:function(){if(this.model.get("mid")){this.model.removeChanges();var e=this.getChildView("editview");e&&e.refresh(),this.setMode("read")}else this.model.collection.remove(this.model);this.model.dispatchEvent("onCancel"),this._dispatchEvent(!0)},onIconEditClick:function(){this.setMode("edit")},_createContent:function(){var e;return e=[{class:"edit-content",html:[this.addChildView("editview",this._editView),this.addChildView("readview",this._readView)]},{class:"actionBar edit-style",styles:{display:"edit"===this._mode?"block":"none"},html:[this.addControl("save-button",new n({value:t.Save,className:"saveButton primary"})),this.addControl("cancel-button",new n({value:t.Cancel,className:"cancelButton default"}))]}],this.getChildView("editview").hide(),e},_addEventsOnModel:function(){this.model.addEvent("onPencilIconClicked",function(){this.onIconEditClick()}.bind(this)),this.model.addEvent("onTrashIconClicked",function(){this.onDestroyClick()}.bind(this))},setup:function(e){return this._addEventsOnModel(),this.addEvent("onDestroy",function(){var e=a.instances.indexOf(this);e>-1&&a.instances.splice(e,1)}.bind(this)),a.instances.push(this),s.add("editAll",function(e){if(this.isRendered()){var t=this.getElement(".actionBar");!0===e&&!1===this._doNotReactToEditAllEvent?(this.setMode("edit"),t&&t.hide()):!1===e&&this.setMode("read")}}.bind(this),null,!0),this._parent.apply(this,arguments)},init:function(e){try{if(!(e=e||{}).editView)throw new Error("editview undefined");if(this._editView=e.editView,!e.readView)throw new Error("readView undefined");if(this._readView=e.readView,e.doNotReactToEditAllEvent&&(this._doNotReactToEditAllEvent=e.doNotReactToEditAllEvent),!e.actionOnSave)throw new Error("actionOnSave undefined");return this._actionOnSave=e.actionOnSave,this._editable=!!e.editable,e.actionOnDestroy&&(this._actionOnDestroy=e.actionOnDestroy),this._mode=this.isModeValid(e.mode)?e.mode:"read",this._parent.apply(this,arguments)}catch(e){return o.error("Error initializing view mode switch: "+e.message),!1}},isModeValid:function(e){return!!(e&&this._modes.indexOf(e)>-1)},getMode:function(){return this._mode},setMode:function(i){this._mode=i;var o=this.container?this.getElement(".edit-content"):"";if("edit"===i){if(this._parentView.container.addClassName("edition"),o&&o.addClassName("edit-style"),this.getChildView("editview")){if(!0===a.editAllActivated&&this.model.collection){var s=this.getChildView("editview"),r=e.createElement("div",{class:"user-edit-all-delete-button",html:this.addControl("button-delete",new n({value:t.Delete,events:{onClick:function(){this.onDestroyClick()}.bind(this)}}))});s.addEvent("onLanguageRefresh",function(){r.inject(s.container,"after")}),r.inject(s.container,"after")}this.getChildView("editview").show(),this.getChildView("readview").hide()}!1===a.editAllActivated&&this.getElement(".actionBar").setStyle("display","block"),(l=this.getElement(".fonticon-pencil"))&&l.setStyle("visibility","hidden"),this.dispatchEvent("onEdit")}else{if("read"!==i)throw new Error("mode undefined");var l,c=this.getControl("save-button");c&&c.previousValue&&c.load(!1),this._parentView.container.removeClassName("edition"),o&&o.removeClassName("edit-style"),this.getChildView("readview").show(),this.getChildView("editview").hide(),this.getElement(".actionBar").setStyle("display","none"),(l=this.getElement(".fonticon-pencil"))&&l.setStyle("visibility","visible"),this.dispatchEvent("onRead")}}});return a.editAllActivated=!1,a.instances=[],s.add("editAll",function(e){a.editAllActivated=e},null,!0),a}),define("DS/SwymUIComponents/script/lib/ckeditor/customlink/dialogs/customlink",["require","exports","i18n!DS/SwymUIComponents/assets/nls/lib/ckeditor/customlink/customlink","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/context/context-constants","DS/SwymUICore/script/utils/compass-proxy","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/Logger/Logger"],function(e,t,i,n,o,s,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=["/","."],c=null,d=null,m=null,u=null,h=RegExp(".*\\/?#app:".concat("X3DMCTY_AP",".*community=.*")),p=RegExp(".*(community|dm):(".concat(o.BASE64_REGEXP,").*")),g=RegExp(".*(community|dm):(".concat(o.BASE64_REGEXP,")/").concat(o.CONTENT_REGEXP_PATTERN,".*")),w=o.COMMUNITY_CONTENT_LIST_REGEXP,C=a.getInstance().get("config").tenant.online_instance_id.toLowerCase();s.getServiceUrl({platformId:C,serviceName:"3DDashboard",onComplete:function(e){e&&(c=e)&&(m=Array.prototype.map.call(c,function(e){return l.includes(e)?"\\".concat(e):e}).join(""),h=RegExp("".concat(m,".*app:").concat("X3DMCTY_AP",".*community=.*")))},onFailure:function(e){r.log(e)}}),s.getServiceUrl({platformId:C,serviceName:"3DSwym",onComplete:function(e){e&&(d=e,u=Array.prototype.map.call(d,function(e){return l.includes(e)?"\\".concat(e):e}).join(""),p=RegExp("".concat(u,".*(community|dm):(").concat(o.BASE64_REGEXP,").*")),g=RegExp("".concat(u,".*(community|dm):(").concat(o.BASE64_REGEXP,")/").concat(o.CONTENT_REGEXP_PATTERN,".*")))},onFailure:function(e){r.log(e)}}),CKEDITOR.dialog.add("customlinkDialog",function(e){return{title:i.LinkProperties,minWidth:400,minHeight:100,resizable:!1,contents:[{id:"linkBuilder",elements:[{type:"text",id:"desc",label:i.Description},{type:"text",id:"url",label:i.URL}]}],buttons:[{type:"button",className:"cke_dialog_ui_button_ok",label:i.Ok,title:i.Ok,onClick:function(){(function(){var t,n,o,s,a=this.getDialog(),r=null,l={desc:a.getValueOf("linkBuilder","desc").trim(),url:a.getValueOf("linkBuilder","url").trim()},c=e.document.createElement("a"),d=!1;if(h.test(l.url)?(d=!0,t=(t=l.url.match(/.*contentId=(.*?)(&|$)/))?t[1]:null,o=(o=l.url.match(/.*community=(.*?)(&|$)/))?o[1]:null,n=(n=l.url.match(/.*contentType=(.*?)(&|$)/))?n[1]:null,s=(s=l.url.match(/.*communityType=(.*?)(&|$)/))?s[1]:null):p.test(l.url)&&(d=!0,s=(r=l.url.match(p))[1],o=r[2],g.test(l.url)&&(n=(r=l.url.match(g))[3],t=r[4]),w.test(l.url)&&(d=!1)),"dm"===s&&(s="direct-message"),o&&!s&&(s="community"),!d&&!new RegExp(/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/).test(l.url))return alert(i.PleasecheckyourURL),!1;return l.desc?l.url?(t||n||(n=s,t=o,s=null,o=null),d?(n&&c.setAttribute("data-content-type",n),c.setHtml(l.desc),t&&c.setAttribute("data-content-id",t),o&&s&&("community"===s?c.setAttribute("data-community-id",o):c.setAttribute("data-dm-id",o)),c.setAttribute("target","_self"),c.setAttribute("data-type","internal"),c.setAttribute("href","#")):(c.setHtml(l.desc),c.setAttribute("href",l.url),c.setAttribute("data-type","external")),e.customLink?e.customLink.outerHTML=c.$.outerHTML:e.insertElement(c),void a.hide()):(alert(i.TheURLfieldcannotbeempty),!1):(alert(i.Thedescriptionfieldcannotbeempty),!1)}).apply(this)}},{type:"button",className:"cancel-button-link-properties",label:i.Cancel,title:i.Cancel,onClick:function(){(function(e){this.getDialog().hide()}).apply(this)}}],onShow:function(){var e,t=this.getParentEditor(),i=t.getSelection(),o=null;if((o=CKEDITOR.plugins.link.getSelectedLink(t))&&"a"===o.getName()?i.getSelectedElement()||i.selectElement(o):o=t.customLink?t.customLink:i.getStartElement()&&"a"===i.getStartElement().getName()?i.getStartElement():null,o)if(o.getHtml?e=o.getHtml():""===(e=o.getHTML())&&(e=o.outerHTML),t.customLink&&this.setValueOf("linkBuilder","desc",e),o.hasAttribute("data-content-id")){var s=n.get3DDTransientAppUrl({appId:n.getMyCommunitiesAppKey(),contentId:o.getAttribute("data-content-id"),community:o.getAttribute("data-community-id"),contentType:o.getAttribute("data-content-type")});this.setValueOf("linkBuilder","url",s),this.setValueOf("linkBuilder","desc",e)}else this.setValueOf("linkBuilder","desc",e||o.getAttribute("href")),this.setValueOf("linkBuilder","url",o.getAttribute("url")||o.getAttribute("href"));else i.getSelectedText()&&this.setValueOf("linkBuilder","desc",i.getSelectedText())},onHide:function(){var e=this.getParentEditor();e.customLink&&(delete e.customLink,this.getContentElement("linkBuilder","desc").getElement().show(),this.getContentElement("linkBuilder","desc").getElement().show())}}})}),define("DS/SwymUIComponents/script/feature/core/network/view/activity-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/network/model/activity-model","DS/WebappsUtils/Console"],function(e,t,i,n){"use strict";return t.extend({_modelClass:i,name:"activity-view",domEvents:{},_createContent:function(){try{if(this.model){var t=this.model.get("feed_text",{escapeHTML:!1});return window.ds&&"3DD"===ds.env&&(t=t.split("<a").join("<i").split("</a>").join("</i>")),e.createElement("div",{html:t})}throw new Error("Model does not exist")}catch(e){n.error(e.message)}}})}),define("DS/SwymUIComponents/script/feature/core/user/view/mail/user-mail-read-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/user/model/user-model","DS/WebappsUtils/Console","DS/UIKIT/Input/Button"],function(e,t,i,n,o){"use strict";return t.extend({_modelEventsForAutoRefresh:["onChange"],_modelClass:i,domEvents:{"click a":"_onClickLink"},_onClickLink:function(){window.location.href="mailto:"+this.model.get("email")},name:"user-mail-read-view",_createContent:function(){return e.createElement("a",{html:this.model.get("email")})}})}),define("DS/SwymUIComponents/script/feature/core/auto-save/view/auto-save-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/feature/core/auto-save/model/auto-save-model","DS/UWPClientCode/PublicAPI","DS/UIKIT/Tooltip","DS/SwymUICore/script/utils/utils","i18n!DS/SwymUIComponents/assets/nls/feature/core/auto-save/view/auto-save-view"],(e,t,i,n,o,s,a)=>{const r=["message","wedo","media","social-event"],l=n.getApplicationConfiguration("app.swymfeature.autoSaveFrequency");return t.extend({name:"auto-save",_isRunning:!1,_frequency:l?parseInt(l,10):30,_lastContentSaved:"",_currentContent:"",_autoSaveModel:null,_floppyIcon:null,_leavingSecurityOn:!1,_timeoutId:null,_createContent(){return this._floppyIcon=e.createElement("span",{class:"auto-save fonticon fonticon-refresh",styles:{cursor:"default"}}),this._setTooltip(a.TheContentIsStoredForALaterRecovery),this._floppyIcon},_setTooltip(e){const t=this.getControl("floppyTooltip");t?t.setBody(e):this.addControl("floppyTooltip",new o({target:this._floppyIcon,body:e}))},init(...e){return this._parent(...e)},setup(){return clearTimeout(this._timeoutId),this._parent.apply(this,arguments)},clear(e){this._lastContentSaved="",this._currentContent="",this.cancelAutoSaveInProgress(),this._removeAutoSave(e),this.updateIconStatus("reset"),clearTimeout(this._timeoutId),this._timeoutId=void 0},cancelAutoSaveInProgress(){clearTimeout(this._timeoutId)},_canContentBeAutosaved(){const e=this._currentContent;return!!e&&-1===r.indexOf(e.content_type)},updateIconStatus(e){const t={saved:"#57B847",unsaved:"#f4f5f6",reset:"#f4f5f6",error:"#EA4F37"};if(this.isDestroyed())return;const i=this.getElement(".auto-save");if(i)if(this._canContentBeAutosaved()&&(!i.hasClassName("error")||i.hasClassName("error")&&"saved"===e)){switch(i.removeClassName("saved"),i.removeClassName("unsaved"),i.removeClassName("error"),e){case"saved":i.addClassName(e),i.removeClassName("fonticon-refresh"),i.addClassName("fonticon-check"),this.container.show(),this._setTooltip(a.TheContentIsStoredForALaterRecovery);break;case"unsaved":i.addClassName(e),i.removeClassName("fonticon-check"),i.addClassName("fonticon-refresh"),this.container.show();break;case"error":i.addClassName(e),i.removeClassName("fonticon-check"),i.addClassName("fonticon-refresh"),this.container.show(),this._setTooltip(a.TheContentCouldNotBeStoredForALaterRecovery);break;default:this.container.hide()}this.container.setStyle("background-color",t[e])}else i.hasClassName("error")&&"reset"!==e||(this.container.hide(),i.removeClassName("error"))},onContentChanged(e){this._getCurrentContent(e),this._canContentBeAutosaved()&&(this.updateIconStatus("unsaved"),this._isRunning||s.compareObjects(this._currentContent,this._lastContentSaved)||this._startAutoSave())},_startAutoSave(){const e=this;this._isRunning||(this._isRunning=!0,this._currentContent!==this._lastContentSaved&&this._canContentBeAutosaved()&&this._performAutoSave(),this._isRunning=!0,this._timeoutId=setTimeout(()=>{e._currentContent!==e._lastContentSaved&&e._canContentBeAutosaved()?e._performAutoSave():e._isRunning=!1},1e3*this._frequency))},_performAutoSave(){this._lastContentSaved=this._currentContent,this._setAutoSave(),this._isRunning=!1},destroy(...e){this._parent(...e)},_getCurrentContent(t){const i=t.getBodyAttributes();let n=null;Object.hasOwnProperty.call(i,"content")&&(n=i.content,delete i.content),this._currentContent={content_type:t.getCurrentContentType(),community_id:t.getSelectedCommunityID(),content_id:t.model?t.model.get("mid"):null,content_title:t._titleContent,content_message:n,content_options:{}},e.extend(this._currentContent.content_options,i)},_setAutoSave(){const e=this._lastContentSaved,t=this,n={onComplete(){t.updateIconStatus("saved")},onFailure(){t.updateIconStatus("error")}};e.content_options=JSON.stringify(e.content_options),this._autoSaveModel||(this._autoSaveModel=i.getInstance()),this._autoSaveModel.addChanges(e),this._autoSaveModel.save({},n)},_removeAutoSave(e){this._autoSaveModel=i.getInstance(),this._autoSaveModel&&(i.deleteInstance(e),this._autoSaveModel=null)}})}),define("DS/SwymUIComponents/script/lib/ckeditor/customtable/dialogs/customtable",["i18n!DS/SwymUIComponents/assets/nls/lib/ckeditor/customtable/customtable"],function(e){var t=CKEDITOR.tools.cssLength,i=function(e){var t=this.id;e.info||(e.info={}),e.info[t]=this.getValue()},n=function(e){return function(){var t=this.getValue(),i=!!(CKEDITOR.dialog.validate.integer()(t)&&t>0);return i||(alert(e),this.select()),i}};CKEDITOR.dialog.add("customtableDialog",function(o){var s=o.editable(),a=(o.plugins.dialogadvtab,function(e){return new CKEDITOR.dom.element(e,o.document)});return{title:e.TableProperties,minWidth:310,minHeight:CKEDITOR.env.ie?310:280,resizable:!1,onLoad:function(){var e=this,t=e.getContentElement("advanced","advStyles");t&&t.on("change",function(){var t=this.getStyle("width",""),i=e.getContentElement("info","txtWidth");i&&i.setValue(t,!0);var n=this.getStyle("height",""),o=e.getContentElement("info","txtHeight");o&&o.setValue(n,!0)})},onShow:function(){var e,t=o.getSelection(),i=t.getRanges(),n=this.getContentElement("info","txtRows"),s=this.getContentElement("info","txtCols"),a=this.getContentElement("info","txtWidth"),r=this.getContentElement("info","txtHeight"),l=t.getSelectedElement();l&&l.is("table")?e=l:i.length>0&&(CKEDITOR.env.webkit&&i[0].shrink(CKEDITOR.NODE_ELEMENT),e=o.elementPath(i[0].getCommonAncestor(!0)).contains("table",1)),this._.selectedElement=e,e?(this.setupContent(e),n&&n.disable(),s&&s.disable()):(n&&n.enable(),s&&s.enable()),a&&a.onChange(),r&&r.onChange()},onCancel:function(){this.hide()},onOk:function(){var e=o.getSelection(),t=this._.selectedElement&&e.createBookmarks();wrapper=a("div"),wrapper.setAttribute("class","responsive-table");var i=this._.selectedElement||wrapper.append(a("table")),n={};if(this.commitContent(n,i),n.info){var s=n.info;if(!this._.selectedElement)for(var r=i.append(a("tbody")),l=parseInt(s.txtRows,10)||0,c=parseInt(s.txtCols,10)||0,d=0;d<l;d++)for(var m=r.append(a("tr")),u=0;u<c;u++){m.append(a("td")).appendBogus()}var h=s.selHeaders;if(!i.$.tHead&&("row"==h||"both"==h)){var p=i.getElementsByTag("thead").getItem(0),g=(r=i.getElementsByTag("tbody").getItem(0)).getElementsByTag("tr").getItem(0);for(p||(p=new CKEDITOR.dom.element("thead")).insertBefore(r),d=0;d<g.getChildCount();d++){var w=g.getChild(d);w.type!=CKEDITOR.NODE_ELEMENT||w.data("cke-bookmark")||(w.renameNode("th"),w.setAttribute("scope","col"))}p.append(g.remove())}if(null!==i.$.tHead&&"row"!=h&&"both"!=h){p=new CKEDITOR.dom.element(i.$.tHead);for(var C=(r=i.getElementsByTag("tbody").getItem(0)).getFirst();p.getChildCount()>0;){for(g=p.getFirst(),d=0;d<g.getChildCount();d++){var f=g.getChild(d);f.type==CKEDITOR.NODE_ELEMENT&&(f.renameNode("td"),f.removeAttribute("scope"))}g.insertBefore(C)}p.remove()}if(!this.hasColumnHeaders&&("col"==h||"both"==h))for(m=0;m<i.$.rows.length;m++)(f=new CKEDITOR.dom.element(i.$.rows[m].cells[0])).renameNode("th"),f.setAttribute("scope","row");if(this.hasColumnHeaders&&"col"!=h&&"both"!=h)for(d=0;d<i.$.rows.length;d++)"tbody"==(m=new CKEDITOR.dom.element(i.$.rows[d])).getParent().getName()&&((f=new CKEDITOR.dom.element(m.$.cells[0])).renameNode("td"),f.removeAttribute("scope"));s.txtHeight?i.setStyle("height",s.txtHeight):i.removeStyle("height"),s.txtWidth?i.setStyle("width",s.txtWidth):i.removeStyle("width"),i.getAttribute("style")||i.removeAttribute("style")}if(this._.selectedElement)try{e.selectBookmarks(t)}catch(e){}else o.insertElement(wrapper),setTimeout(function(){var e=new CKEDITOR.dom.element(i.$.rows[0].cells[0]),t=o.createRange();t.moveToPosition(e,CKEDITOR.POSITION_AFTER_START),t.select()},0)},contents:[{id:"info",label:e.TableProperties,elements:[{type:"hbox",widths:[null,null],styles:["vertical-align:top"],children:[{type:"vbox",padding:0,children:[{type:"text",id:"txtRows",default:3,label:e.Rows,required:!0,controlStyle:"width:5em",validate:n(o.lang.table.invalidRows),setup:function(e){this.setValue(e.$.rows.length)},commit:i},{type:"text",id:"txtCols",default:2,label:e.Columns,required:!0,controlStyle:"width:5em",validate:n(o.lang.table.invalidCols),setup:function(e){this.setValue(function(e){for(var t,i=0,n=0,o=0,s=e.$.rows.length;o<s;o++){i=0;for(var a=0,r=(t=e.$.rows[o]).cells.length;a<r;a++)i+=t.cells[a].colSpan;i>n&&(n=i)}return n}(e))},commit:i},{type:"select",id:"selHeaders",requiredContent:"th",default:"",label:e.Headers,items:[[e.None,""],[e.FirstRow,"row"],[e.FirstColumn,"col"],[e.Both,"both"]],setup:function(e){var t=this.getDialog();t.hasColumnHeaders=!0;for(var i=0;i<e.$.rows.length;i++){var n=e.$.rows[i].cells[0];if(n&&"th"!=n.nodeName.toLowerCase()){t.hasColumnHeaders=!1;break}}null!==e.$.tHead?this.setValue(t.hasColumnHeaders?"both":"row"):this.setValue(t.hasColumnHeaders?"col":"")},commit:i},{id:"cmbAlign",type:"select",requiredContent:"table[align]",default:"",label:e.Alignment,items:[[e.NotSet,""],[e.Left,"left"],[e.Center,"center"],[e.Right,"right"]],setup:function(e){this.setValue(e.getAttribute("align")||"")},commit:function(e,t){this.getValue()?t.setAttribute("align",this.getValue()):t.removeAttribute("align")}},{id:"caption",type:"text",default:"",label:e.Caption,setup:function(e){e.$.caption&&this.setValue(e.$.createCaption().innerHTML)},commit:function(e,t){this.getValue()?t.$.createCaption().innerHTML=this.getValue():t.$.deleteCaption()}}]},{type:"vbox",padding:0,children:[{type:"hbox",widths:["5em"],children:[{type:"text",id:"txtWidth",requiredContent:"table{width}",controlStyle:"width:5em",label:e.Width,title:o.lang.common.cssLengthTooltip,default:o.filter.check("table{width}")?s.getSize("width")<500?"100%":500:0,getValue:t,validate:CKEDITOR.dialog.validate.cssLength(o.lang.common.invalidCssLength.replace("%1",o.lang.common.width)),onChange:function(){var e=this.getDialog().getContentElement("advanced","advStyles");e&&e.updateStyle("width",this.getValue())},setup:function(e){var t=e.getStyle("width");this.setValue(t)},commit:i}]},{type:"hbox",widths:["5em"],children:[{type:"text",id:"txtHeight",requiredContent:"table{height}",controlStyle:"width:5em",label:e.Height,title:o.lang.common.cssLengthTooltip,default:"",getValue:t,validate:CKEDITOR.dialog.validate.cssLength(o.lang.common.invalidCssLength.replace("%1",o.lang.common.height)),onChange:function(){var e=this.getDialog().getContentElement("advanced","advStyles");e&&e.updateStyle("height",this.getValue())},setup:function(e){var t=e.getStyle("height");t&&this.setValue(t)},commit:i}]},{type:"hbox",widths:["5em"],children:[{type:"select",id:"cmbBorder",requiredContent:"table[border]",default:o.filter.check("table[border]")?1:0,label:e.DisplayBorder,items:[[e.Yes,1],[e.No,0]],setup:function(e){this.setValue(e.getAttribute("border")||1)},commit:function(e,t){this.getValue()?t.setAttribute("border",this.getValue()):t.removeAttribute("border")}}]}]}]}]}]}})}),define("DS/SwymUIComponents/script/feature/core/link/view/account-link-read-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/experience/view/experience-read-view","DS/SwymUICore/script/feature/core/link/model/link-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/UIKIT/Tooltip","DS/UIKIT/DropdownMenu"],function(e,t,i,n,o,s){"use strict";return n.extend({})}),define("DS/SwymUIComponents/script/feature/community/community/view/community-visibility-settings-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-visibility-settings-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/UIKIT/Input/Toggle","DS/UIKIT/Tooltip","DS/WebappsUtils/Console"],function(e,t,i,n,o,s,a,r,l){"use strict";var c=function(e,t){var i;return(i=e.getChanges(t))||(i=e.get(t)),i};return i.extend({_modelClass:n,attributes:{tag:"div"},onExtranetVisibilityChange:function(){var e=this.view,t=e.model,i=this.toggle;i===e.extranetToggleControls[0]?(l.log("onExtranetVisibilityChange public",i.getValue()),t.addChanges("extranet_access",i.getValue()),t.addChanges("extranet_access_enabled",1)):i===e.extranetToggleControls[1]?(l.log("onExtranetVisibilityChange private",i.getValue()),t.addChanges("extranet_access",i.getValue()),t.addChanges("extranet_access_enabled",1)):i===e.extranetToggleControls[2]?(l.log("onExtranetVisibilityChange secret",i.getValue()),t.addChanges("extranet_access",i.getValue()),t.addChanges("extranet_access_enabled",1)):i===e.extranetToggleControls[3]&&(l.log("onExtranetVisibilityChange disabled",i.getValue()),t.addChanges("extranet_access",null),t.addChanges("extranet_access_enabled",0))},onIntranetVisibilityChange:function(){var e,t=this.view,i=t.model,n=this.toggle;n===t.intranetToggleControls[0]?(l.log("onIntranetVisibilityChange public",n.getValue()),i.addChanges("access",n.getValue()),t.extranetToggleControls[0].isDisabled()&&t.extranetToggleControls[0].enable(),t.extranetToggleControls[1].isDisabled()&&t.extranetToggleControls[1].enable(),t.optinToggle.isDisabled()&&t.optinToggle.setDisabled(!1)):n===t.intranetToggleControls[1]?(l.log("onIntranetVisibilityChange private",n.getValue()),i.addChanges("access",n.getValue()),t.extranetToggleControls[1].isDisabled()&&t.extranetToggleControls[1].enable(),t.extranetToggleControls[0].isChecked()&&(t.extranetToggleControls[1].setCheck(!0),e=t.extranetToggleControls[1].getValue(),l.log("onIntranetVisibilityChange set extranet visibility to private",e),i.addChanges("extranet_access",e)),t.optinToggle.isDisabled()||(t.optinToggle.setDisabled(!0),t.optinToggle.setCheck(!1)),t.extranetToggleControls[0].setDisabled(!0)):n===t.intranetToggleControls[2]&&(l.log("onIntranetVisibilityChange secret",n.getValue()),i.addChanges("access",n.getValue()),(t.extranetToggleControls[0].isChecked()||t.extranetToggleControls[1].isChecked())&&(t.extranetToggleControls[2].setCheck(!0),e=t.extranetToggleControls[2].getValue(),l.log("onIntranetVisibilityChange set extranet visibility to secret",e),i.addChanges("extranet_access",e)),t.optinToggle.isDisabled()||(t.optinToggle.setDisabled(!0),t.optinToggle.setCheck(!1)),t.extranetToggleControls[0].setDisabled(!0),t.extranetToggleControls[1].setDisabled(!0))},createExtranetVisibilityUI:function(i,n,o){switch(i=parseInt(i,10),n=parseInt(n,10),this.extranetToggleControls=[],this.extranetVisibilityUI=e.createElement("div",{class:"col-xs-12 col-sm-6",styles:{display:"none"},html:[{tag:"div",html:{tag:"h5",html:t.Communityvisibilityforcontractors}},this.extranetToggleControls[0]=new a({name:"optionsPartners",className:"primary",value:1,label:t.Public,checked:1===i}),this.extranetToggleControls[1]=new a({name:"optionsPartners",className:"primary",value:0,label:t.Private,checked:0===i}),this.extranetToggleControls[2]=new a({name:"optionsPartners",className:"primary",value:4,label:t.Secret,checked:4===i}),this.extranetToggleControls[3]=new a({name:"optionsPartners",className:"primary",value:"disabled",label:t.Disabled,checked:!n})]}),o){case 4:this.extranetToggleControls[1].setDisabled(!0);case 0:this.extranetToggleControls[0].setDisabled(!0)}return this.extranetToggleControls[0].addEvent("onChange",this.onExtranetVisibilityChange.bind({view:this,toggle:this.extranetToggleControls[0]})),this.extranetToggleControls[1].addEvent("onChange",this.onExtranetVisibilityChange.bind({view:this,toggle:this.extranetToggleControls[1]})),this.extranetToggleControls[2].addEvent("onChange",this.onExtranetVisibilityChange.bind({view:this,toggle:this.extranetToggleControls[2]})),this.extranetToggleControls[3].addEvent("onChange",this.onExtranetVisibilityChange.bind({view:this,toggle:this.extranetToggleControls[3]})),this.extranetVisibilityUI},createIntranetVisibilityUI:function(i){var n=this;return this.intranetToggleControls=[],s.getInstance().isFeatureActivated("active_community_blacklist")&&(n.active_community_blacklist=e.createElement("span",{class:"community-blacklist-optin-wrapper",html:[this.optinToggle=new a({type:"checkbox",name:"optin",className:"optin-toggle primary",label:t.Optin,checked:"1"===this.model.get("blacklist_by_default"),disabled:1!==i}),this.helpIcon=e.createElement("span",{class:"fonticon fonticon-help",styles:{"margin-left":"10px"}})]})),this.intranetVisibilityUI=e.createElement("div",{class:"col-xs-12 col-sm-6",styles:{display:"none"},html:{tag:"div",class:"",html:[{tag:"div",html:{tag:"h5",html:t.Communityvisibilityforemployees}},{class:"public-optin-wrapper",html:[this.intranetToggleControls[0]=new a({name:"optionsEmployees",className:"primary",value:1,label:t.Public,checked:1===i}),n.active_community_blacklist]},this.intranetToggleControls[1]=new a({name:"optionsEmployees",className:"primary",value:0,label:t.Private,checked:0===i}),this.intranetToggleControls[2]=new a({name:"optionsEmployees",className:"primary",value:4,label:t.Secret,checked:4===i})]}}),this.intranetToggleControls[0].addEvent("onChange",this.onIntranetVisibilityChange.bind({view:this,toggle:this.intranetToggleControls[0]})),s.getInstance().isFeatureActivated("active_community_blacklist")&&this.optinToggle.addEvent("onChange",function(e){n.model.addChanges("blacklist_by_default",e.currentTarget.checked?"1":"0")}),this.intranetToggleControls[1].addEvent("onChange",this.onIntranetVisibilityChange.bind({view:this,toggle:this.intranetToggleControls[1]})),this.intranetToggleControls[2].addEvent("onChange",this.onIntranetVisibilityChange.bind({view:this,toggle:this.intranetToggleControls[2]})),this.intranetVisibilityUI},_createContent:function(){var i=this.model,n=parseInt(c(i,"access"),10),s=parseInt(c(i,"extranet_access"),10),a=parseInt(c(i,"extranet_access_enabled"),10),l=UWA.createElement("div",{class:"col-xs-12",styles:{padding:"0px","margin-top":"20px"},html:[this.createIntranetVisibilityUI.call(this,n),this.createExtranetVisibilityUI.call(this,s,a,n)]});return o.getInstanceFetched(function(e){e&&e.get("tenant_admin")&&"1"===e.get("tenant_admin")&&(this.intranetVisibilityUI.show(),this.extranetVisibilityUI.show())}.bind(this)),e.is(this.helpIcon)&&this.addControl("MenuTooltip",new r({target:this.helpIcon,body:t.IfSelectedUsersWillNotSeeTheCommunitysContributionsInTheWhatsNew})),l}})}),define("DS/SwymUIComponents/script/feature/community/community/view/rss-feed-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/UIKIT/Input/Button","DS/UIKIT/Tooltip","DS/SwymUICore/script/utils/utils","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-detailed-view"],function(e,t,i,n,o,s){"use strict";return t.extend({name:"rss-feed-view",domEvents:{"click .rss-feed-action":"_getRssFeed"},setup:function(t){this.button=e.createElement("span",{class:"rss-feed-action fonticon fonticon-rss"}),this.addControl("rssTooltip",new n({target:this.button,body:s.SubscribeToRSSFeed})),this._parent.call(this,t)},_createContent:function(){return this.button},_getRssFeed:function(){"wiki"===this.options.mode?window.open(o.getBaseUrl()+"/rss/filter/feed/community_id/"+this.options.communityId+"/model/wiki/"):window.open(o.getBaseUrl()+"/rss/filter/"+this.options.mode+"/community_id/"+this.options.communityId)}})}),define("DS/SwymUIComponents/script/feature/community/template/model/content-template-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/media/collection/media-collection"],(e,t,i)=>{return t.extend({_modelName:"content-template-model",_associations:{embeddedMedia:{Class:i,sourceAttribute:"thumbnailsInfos",options:{limit:2,mode:"communityMedia"}}},_services:{create:{url:"api/templates",method:"POST",wrapData:!1,dataFn:e=>({community_id:e.communityId,title:e.title,message:e.message,content_type:e.contentType})},update:{urlFn:e=>`api/templates/${e.templateId}`,method:"PATCH",dataType:"json",dataFn:e=>({title:e.title,message:e.message})},delete:{urlFn:e=>`api/templates/${e.templateId}`,method:"DELETE",dataType:"json"}},populateEmbeddedMediaAssociation(){const e=this.get("thumbnailsInfos");Array.isArray(e)&&e.length>0&&this.getAssociated("embeddedMedia")},getCurrentTypeMapping(e){let t=e.toLowerCase();return"question"===t&&(t="iquestion"),"ideation"===t&&(t="idea"),"wikipage"===t&&(t="wiki"),t}})}),define("DS/SwymUIComponents/script/feature/core/ui-components/sortable/new-sortable-list-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-view","UWA/Controls/Drag","DS/SwymUICore/script/utils/utils"],function(e,t,i,n){"use strict";return{_expanded:!0,_mode:"full",setMode:function(e){this._mode="restricted"===e?e:"full"},_configureSortableComponent:function(){this.dragMoveComponent&&this.destroyComponent(),this.dragMoveComponent=new i.Move({container:document.body,zones:[this.sortableContainer,this.trashZone,this.pushBottomZone],delegate:".draggable-community, .draggable-community *",centerHandles:!0,handles:this._handles.bind(this),move:this._move.bind(this),fixed:this._fixed.bind(this),enter:this._enter.bind(this),leave:this._leave.bind(this),drop:this._drop.bind(this),stop:this._stop.bind(this),start:this._start.bind(this)})},appendNewItem:function(t){var i=t.get("position"),n=this.container.getElement(".item-list-body"),o=n.getChildren(),s=e.createElement("div",e.extend({html:this.addChildView("sortable-item-"+t.get("mid"),new this.modelViewClass({model:t}))},this.modelViewsCfg(t)));i&&o.hasOwnProperty(i-1)?n.insertBefore(s,o[i-1]):n.appendChild(s),this.defaultZone.hide()},removeItem:function(e){var t=this.container.querySelector('.draggable-sortable-item[data-content-id="'+e+'"]');t&&t.destroy(),0===this.container.getElementsByClassName("draggable-sortable-item").length&&this.defaultZone.show()},isEmpty:function(){return!1},viewAllAction:function(){if(this.viewAllPlaceholder){var e,t=this.container.getElementsByClassName("draggable-sortable-item");for(e in t)t.hasOwnProperty(e)&&t[e].isHidden()&&t[e].show();this._expanded=!0,this.viewAll.hide()}},isExpanded:function(){return this._expanded},_addPersistentPlaceholder:function(t){this.persistentPlaceholder=e.createElement("div",{class:"placeholder "+this.itemClassName,html:this.placeHolderHtml}),t.placeholder&&t.placeholder.isInjected()?this.persistentPlaceholder.inject(t.placeholder,"before"):this.persistentPlaceholder.inject(this.sortableContainer)},_start:function(e){if(e.target.getClosest(this.itemCssSelector).hasClassName("draggable-sortable-item")&&"restricted"===this._mode)return!1},_handles:function(t){var i,o=[{tag:"span",class:"fonticon fonticon fonticon-drag-drop fonticon-2x"},{tag:"span",class:"drop-zone-placeholder",html:this.reorderPlaceholder}],s=t.target.getClosest(this.itemCssSelector);return this.isFromDraggableList=s.getClosest(".sortable-list-view-container"),this.isDragState=this.isAllowed=!0,this.hasBeenAdded=this.hasBeenDropped=!1,this.dispatchEvent("onDragStart",t),this.defaultZone.hide(),i=(i=this.ghostBuilder(t))||s,this.isAllowedToDrop(i)||this.isFromDraggableList||(this.isAllowed=!1,this.container.addClassName("forbidden"),this.forbiddenZone.show()),(!t.placeholder||!t.placeholder.isInjected()&&!this.persistentPlaceholder.isInjected())&&this.isAllowed&&"full"===this._mode&&this._addPersistentPlaceholder(t),this.isFromDraggableList&&this.isAllowed&&(this.trashZone.setStyle("display","block"),this.trashZone.setStyle("opacity",1)),!this.isFromDraggableList&&this.isAllowed&&"restricted"===this._mode&&(this.container.addClassName("restricted-mode"),this.pushBottomZone.show()),t.placeholder=e.createElement("div",{class:"placeholder hover-placeholder "+this.itemClassName,html:this.isFromDraggableList?o:this.placeHolderHtml}),this.oldHandlesHTML=i,this.currentHandles=n.cloneNode(i,!0),e.extendElement(this.currentHandles),i.hide(),this.currentHandles.addClassName("dragged custom-ghost"),this.currentHandles.inject(document.body).show(),this.currentHandles.style.width=this.container.offsetWidth+"px",this.currentHandles},_move:function(e){e.refreshCache()},_fixed:function(e,t){return!(!t.hasClassName("draggable-sortable-trash")&&!t.hasClassName("default-drop-zone"))},_enter:function(e){if(this.isAllowed&&"full"===this._mode){if(e.zone.hasClassName("item-list-body"))return this.persistentPlaceholder&&this.persistentPlaceholder.destroy(),e.placeholder;!e.placeholder.isInjected()&&!this.persistentPlaceholder.isInjected()&&this._addPersistentPlaceholder(e),e.zone.hasClassName("draggable-sortable-trash")&&e.zone.addClassName("hover-trash")}else this.isAllowed&&"restricted"===this._mode&&e.zone.hasClassName("push-bottom-zone")&&e.zone.addClassName("hover-placeholder")},_leave:function(e){this.isAllowed&&"full"===this._mode?(e.zone.hasClassName("draggable-sortable-trash")&&e.zone.removeClassName("hover-trash"),e.zone.hasClassName("item-list-body")&&this._addPersistentPlaceholder(e)):this.isAllowed&&"restricted"===this._mode&&e.zone.hasClassName("push-bottom-zone")&&e.zone.removeClassName("hover-placeholder")},_drop:function(e){if(this.hasBeenDropped=!0,this.isAllowed){var t,i,n=0;e.zone.hasClassName("push-bottom-zone")&&"restricted"===this._mode?(this.onChange(e.handles,this.sortableContainer.getChildren().length),this.hasBeenAdded=!0):e.zone.hasClassName("draggable-sortable-trash")?this.onRemove(e.handles):e.zone.hasClassName("item-list-body")&&(t=this.sortableContainer.getChildren(),i=e.target.getClosest(this.itemCssSelector),e.handles.getClosest(this.itemCssSelector).hasClassName("draggable-sortable-item")&&t.indexOf(i)<t.indexOf(e.placeholder)&&(n=-1),this.isFromDraggableList&&this.oldHandlesHTML.destroy(),this.onChange(e.handles,t.indexOf(e.placeholder)+n),this.hasBeenAdded=!0)}},_stop:function(e){var t=e.handles.getClosest(this.itemCssSelector);this.dispatchEvent("onDragStop",e),this.hasBeenDropped||e.handles.destroy(),this.isAllowed?(this.trashZone.setStyle("opacity",0),this.trashZone.removeClassName("hover-trash"),this.trashZone.hide(),this.persistentPlaceholder&&this.persistentPlaceholder.destroy(),this.pushBottomZone.hide(),this.pushBottomZone.removeClassName("hover-trash"),e.placeholder.destroy(),e.handles.destroy(),0===this.sortableContainer.getChildren().length&&this.defaultZone.show()):(t&&(t.removeClassName("dragged"),t.setStyles({left:null,top:null})),this.container.removeClassName("forbidden"),this.forbiddenZone.hide(),e.handles.destroy()),this.hasBeenAdded||this.oldHandlesHTML.show(),this.isFromDraggableList=this.isDragState=this.hasBeenAdded=!1},showItemsView:function(){this.getElements(".thread-view > *:first-child").forEach(function(e){e.show()})},destroyComponent:function(){return this.dragMoveComponent.destroy(),this._parent.apply(this,arguments)}}}),define("DS/SwymUIComponents/script/feature/core/user/view/user-privacy-policies-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/user/model/user-model","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/user-privacy-policies-view","DS/PlatformAPI/PlatformAPI","DS/UIKIT/Input/Toggle","DS/WebappsUtils/Console","DS/SwymUICore/script/utils/platform-utils"],function(e,t,i,n,o,s,a,r){"use strict";return t.extend({_modelClass:i,name:"user-privacy-policies-view",toggleDS:null,setup:function(){return this._parent.apply(this,arguments)},_createContent:function(){var t=this;return e.createElement("div",{html:[{tag:"h4",class:"titleProfile",html:n.PrivacyPolicies},{class:"margin-top-20px",styles:{display:"flex"},html:[t.toggleDS=new s({type:"checkbox",value:"dpp_validation",className:"primary legal-checkbox",label:"",events:{onClick:function(){require(["DS/SwymUIComponents/script/feature/core/modal/super-modal"],function(e){new e({closable:!1,renderTo:t._widget.body}).confirm({title:n.LogOut,message:n.AllOptionsMustBeCheckedToUseThePlatform+n.YouWillBeLoggedOut,callback:function(e){!0===e?t._disagree():t.toggleDS.check()}})})}}}).check(),{tag:"span",class:"fonticon fonticon-doc-log",styles:{"margin-right":"10px"}},{tag:"a",href:"https://www.3ds.com/privacy-policy/",html:n.PrivacyPolicies+" - "+n.DassaultSystemes}]}]})},_disagree:function(){require(["DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/lib/request/data","DS/WAFData/WAFData","DS/SwymUICore/script/feature/core/config/bootstrap-model"],function(e,t,i,n){let o=this;r.getPassportURLPromise().then(n=>{n&&r.get3DPassportCSRFToken(function(s){i.authenticatedRequest(n+"/api/authenticated/user/fields",{data:JSON.stringify({fields:{dpp_consent:!1}}),type:"json",method:"POST",timeout:6e4,headers:{"X-DS-IAM-CSRFTOKEN":s,Accept:"application/json","Content-Type":"application/json"},onComplete:function(){t.request({url:"/uwp/logout"}),window.location.href=e.getBaseUrl()+"/api/passport/logout?service="+encodeURIComponent(document.URL)},onFailure:function(e,t){a.log(e),a.log(t),a.log("3dpassport server error"),o.toggleDS.check(),require(["DS/UWPClientControls/PlatformNotify"],function(e){e.error("There is an issue with 3DPassport server. Please try again later.")})}})})})})}})}),define("DS/SwymUIComponents/script/feature/community/content/view/media-thumbnail-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/img-view","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/feature/core/sprite/sprite","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/feature/core/tenant/model/tenant-model"],function(e,t,i,n,o,s,a,r){"use strict";var l=window.ds&&window.ds.isMDE;return t.extend({_modelClass:[o,n],_modelEvents:{"onChange:preview_fingerprint":"onChangePreviewFingerprint"},defaultOptions:{refreshOnFingerprintChange:!0},name:"media-thumbnail-view",onChangePreviewFingerprint:function(){!0===this.options.refreshOnFingerprintChange?this.refresh():console.log("no refresh()")},_createContent:function(){var t,i=this.model,n=i.getModelName();if(t="community"===n&&i.get("picture_update")||i.get("update"),!l)return s.renderMediaThumbnail(e.merge({mediaType:i.get("media_type"),imageUpdateTime:t,imageFingerprint:i.get("preview_fingerprint"),modelId:i.get("mid"),modelName:n,deletedMedia:!0===this.model.get("_deleted")},e.merge(this._imageRenderingOptions||{},this.imageReloadOptions)));var o,a=this,r=i.get("preview_url",{escapeHTML:!0}),c=e.merge({mediaType:i.get("media_type"),imageUpdateTime:t,imageFingerprint:i.get("preview_fingerprint"),modelId:i.get("mid"),modelName:n,deletedMedia:!0===this.model.get("_deleted")},e.merge(this._imageRenderingOptions||{},this.imageReloadOptions));if(!i.isDriveFile||!i.isDriveFile())return s.renderMediaThumbnail(c);if(o=i.getDriveFileUrl(!1),r=i.get("preview_url",{escapeHTML:!0}),o)o.then(function(t){e.createElement("img",{src:t.unescapeHTML(),"data-type":"MediaNoPicture"}).inject(a.container.getElement(".interactive-media-wrapper").empty())});else if(r)return{tag:"img",src:r.unescapeHTML(),"data-type":"MediaNoPicture"}},getInitialModel:function(){return this.model},updatePreviewFingerPrintOnCommunityLogoChange:function(){var e,t=this.model;t instanceof o&&!(t instanceof i)&&(e=t.getCommunity(),this.reactTo(e,"onChange:thumbnail",function(){var i=t.hasAssociated("thumbnail")?t.getAssociated("thumbnail"):null;i&&!i.isNew()||e.get("preview_fingerprint")&&this.model.set({preview_fingerprint:e.get("preview_fingerprint")})}))},updatePreviewFingerPrintOnTenantLogoChange:function(){var e=this.model,t=this;a.getInstanceFetched(function(i){var n=new r({id:i.get("tenant_uuid")});t.reactTo(n,"onChange:preview_fingerprint",function(){var t=e.hasAssociated("thumbnail")?e.getAssociated("thumbnail"):null;t&&!t.isNew()||n.get("preview_fingerprint")&&e.set({preview_fingerprint:n.get("preview_fingerprint")})})})},onSetModel:function(){this.updatePreviewFingerPrintOnCommunityLogoChange(),this.updatePreviewFingerPrintOnTenantLogoChange()}})}),define("DS/SwymUIComponents/script/feature/core/experience/view/experience-edit-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/experience/view/experience-edit-view","DS/SwymUICore/script/feature/core/experience/model/experience-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/UIKIT/Form","DS/WebappsUtils/Console"],function(e,t,i,n,o,s){"use strict";return n.extend({_modelClass:i,name:"experience-edit-view",_createContent:function(){var e=this.model,i=this,n=(new Date).getTimezoneOffset(),s=this._getValueToNeutralizeDate("date_begin"),a=this._getValueToNeutralizeDate("date_end");return this.addControl("form-aboutme",new o({fields:[{type:"text",label:t.jobtitle,required:!0,value:e.get("title",{escapeHTML:!1}),events:{onChange:function(){e.addChanges("title",this.getValue())}}},{type:"text",label:t.company,required:!0,value:e.get("work_name",{escapeHTML:!1}),events:{onChange:function(){e.addChanges("work_name",this.getValue())}}},{type:"text",label:t.industry,value:e.get("industry",{escapeHTML:!1}),events:{onChange:function(){e.addChanges("industry",this.getValue())}}},{type:"text",label:t.location,value:e.get("place",{escapeHTML:!1}),events:{onChange:function(){e.addChanges("place",this.getValue())}}},{type:"date",name:"dateBegin",label:t.from,placeholder:t.selectADate,required:!0,yearRange:50,renderTo:window.document.body.getElement(".user-app-view-container"),value:s,max:new Date,events:{onChange:function(){var t=new Date(this.getDate()),i=new Date(t.getTime()-6e4*n);e.addChanges("date_begin",i)}}},{type:"date",name:"dateEnd",disabled:"1"===e.get("not_finished"),label:t.to,placeholder:t.selectADate,required:!0,yearRange:50,renderTo:window.document.body.getElement(".user-app-view-container"),value:"1"===e.get("not_finished")?s:a,events:{onChange:function(){var t=new Date(this.getDate()),i=new Date(t.getTime()-6e4*n);e.addChanges("date_end",i)}}},{type:"checkbox",label:t.Icurrently,checked:"1"===e.get("not_finished"),events:{onChange:function(){var t=i.getControl("form-aboutme").dates[1];this.isChecked()?(t.disable(),e.addChanges("date_end",null)):(t.enable(),e.addChanges("date_end",new Date(i.getControl("form-aboutme").getField("dateBegin").value)));var n=this.isChecked()?"1":"0";e.addChanges("not_finished",n)}}},{type:"textarea",label:t.description,rows:5,placeholder:t.describeyourposition,value:e.get("description",{escapeHTML:!1}),events:{onChange:function(){e.addChanges("description",this.getValue())}}}]}))},_getValueToNeutralizeDate:function(e){var t=this.model.get(e,{escapeHTML:!1}),i=new Date(t);return t?new Date(i.getTime()+6e4*(new Date).getTimezoneOffset()):""}})}),define("DS/SwymUIComponents/script/feature/core/tenant/view/tenant-stats-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/tenant/view/tenant-stats-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/WebappsUtils/Console"],function(e,t,i,n){return i.extend({model:null,_el:null,_createContent:function(){var i=this.model;if(i&&i.stats)return e.createElement("table",{class:"table table-hover",html:{tag:"tbody",html:[{tag:"tr",html:[{tag:"td",styles:{"border-top":"none"},html:"<strong>"+t.DiskSpace+"</strong>"},{tag:"td",styles:{"border-top":"none"},html:i.stats.disk_used_in_bytes<104857600?(parseInt(i.stats.disk_used_in_bytes)/1048576).toFixed(2)+" MB":(parseInt(i.stats.disk_used_in_bytes)/1073741824).toFixed(2)+" GB"}]},{tag:"tr",html:[{tag:"td",html:"<strong>"+t.NbCommunities+"</strong>"},{tag:"td",html:i.stats.nb_communities}]},{tag:"tr",html:[{tag:"td",html:"<strong>"+t.NbConversations+"</strong>"},{tag:"td",html:i.stats.nb_directmessages}]},{tag:"tr",html:[{tag:"td",html:"<strong>"+t.NbUsers+"</strong>"},{tag:"td",html:i.stats.nb_users}]},{tag:"tr",html:[{tag:"td",html:"<strong>"+t.EmployeeVsPartner+"</strong>"},{tag:"td",html:(100*parseInt(i.stats.nb_users_employees)/(parseInt(i.stats.nb_users_partners)+parseInt(i.stats.nb_users_employees))).toFixed(2)+" %"}]}]}})}})}),define("DS/SwymUIComponents/script/feature/core/conversation/view/topic-modal",["UWA/Core","DS/UIKIT/Modal","DS/UIKIT/Input/Button","DS/UIKIT/Input/Text","i18n!DS/SwymUIComponents/assets/nls/feature/core/conversation/view/topic-modal"],function(e,t,i,n,o){"use strict";return t.extend({_dmModel:null,_topicText:null,_okButton:null,_cancelButton:null,_resetButton:null,init:function(e){this._dmModel=e.model,e.className="topic-modal",this._parent(e),this.setHeader("<h4>"+o.ConversationTopic+"</h4>"),this._buildBody(),this._buildButtons(),this.setFooter([this._resetButton,this._okButton,this._cancelButton]),this.elements.body.addEvent("keydown",this._onKeyDown.bind(this))},_onKeyDown:function(e){var t=null;13===e.keyCode&&(t=this._topicText.getValue(),this._saveTopic(t),this.hide())},onShow:function(){this._topicText.elements.input.focus()},_buildBody:function(){var t=this,i=this._dmModel.get("topic");this._topicText=new n({placeholder:o.TopicName,value:i||""}),this._topicText.elements.input.addEvent("input",function(){""!==event.currentTarget.value?(t._clearButton.show(),i&&t._resetButton.show()):(t._clearButton.hide(),t._resetButton.hide())}),this._clearButton=e.createElement("span",{class:"clear-button fonticon fonticon-clear"}),this._clearButton.addEvent("click",function(){t._topicText.setValue(""),t._clearButton.hide(),t._resetButton.hide()}),i||this._clearButton.hide();var s=e.createElement("div",{class:"wrapper",html:[this._topicText,this._clearButton]});this.setBody([{class:"topic-message",html:o.EnterTopic},s])},_buildButtons:function(){var e=this,t=this._dmModel.get("topic");this._okButton=new i({value:o.Ok,className:"primary",events:{onClick:function(){var t=e._topicText.getValue();e._saveTopic(t)}.bind(this)}}),this._cancelButton=new i({value:o.Cancel,events:{onClick:function(){this.hide()}.bind(this)}}),this._resetButton=new i({value:o.ResetTopic,className:"error",events:{onClick:function(){e._saveTopic("")}.bind(this)}}),t||this._resetButton.hide()},_saveTopic:function(e){var t=this;e!==this._dmModel.get("topic")?this._dmModel.setTopic({topic:e,onComplete:function(){t.hide(),require(["DS/UWPClientControls/PlatformNotify"],function(t){t.success(""!==e?o.TopicSaveOk:o.TopicResetOk)})},onFailure:function(){t.hide(),require(["DS/UWPClientControls/PlatformNotify"],function(e){e.error(o.TopicSaveFailure)})}}):t.hide()}})}),define("DS/SwymUIComponents/script/feature/community/social-event/view/speakers-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/social-event/social-event-view","DS/SwymUICore/script/utils/utils"],function(e,t,i,n){"use strict";return t.extend({name:"speakers-view",setup(e){return this.speakers=e.speakers,this._parent.apply(this,arguments)},_createContent(){const t=this.speakers&&this.speakers.length;let i=[];return t?(this.speakers.forEach(t=>{let o=e.createElement("div",{class:"topic-owner"});const s=n.getBaseUrl()+"/api/user/getpicture/login/"+t.login;o.setStyle("background-image",'url("'+s+'")'),o.dataset.contentType="person",o.dataset.login=t.login,i.push(o)}),i):null}})}),define("DS/SwymUIComponents/script/feature/community/social-event/view/social-event-details-view",["DS/SwymUICore/script/feature/community/social-event/model/social-event-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/UIKIT/Input/Button","DS/UWPClientCode/I18n","i18n!DS/SwymUIComponents/assets/nls/feature/community/social-event/social-event-view"],function(e,t,i,n,o){"use strict";return t.extend({_modelClass:e,name:"social-event-details-view",defaultOptions:{mode:"summary-view"},_modelEvents:{"onChange:start_date":"refresh"},setup:function(){return!this.getControl("joinButton")&&this.addControl("joinButton",new i({value:o.JoinMeeting,className:"primary",events:{onClick:e=>{e.stopPropagation(),this.onJoinButtonClick()}}})),this._parent.apply(this,arguments)},onJoinButtonClick:function(){var e=this.model.get("app_join_uri");window.open(e,"_blank")},_createContent:function(){let e="",t=this.model,i=!1,s=new Date(this.model.get("start_date")),a=this.model.get("duration");if(a){let e=Math.floor(a/60),t=a-Math.floor(60*e),i=new Date(s);i.setHours(s.getHours()+e),i.setMinutes(s.getMinutes()+t)}if(t.get("app_join_uri")||t.get("provider")){let e=(s.getTime()-Date.now())/36e5;e>=-3&&(i=!0,Math.abs(e)<3?this.getControl("joinButton").enable():this.getControl("joinButton").disable())}if(t){let t,a=this.model.has("recurrence");if(a)switch(this.model.get("recurrence").frequency){case"daily":t=o.Daily;break;case"weekly":t=o.Weekly;break;case"monthly":t=o.Monthly}e="summary-view"===this.getOption("mode")?[{tag:"div",class:"schedule-time",html:[{tag:"span",class:"fonticon fonticon-calendar"},{tag:"span",class:"text",html:s.toDateString()+" "+s.toLocaleTimeString(n.getCurrentLanguage()||"en",{hour:"2-digit",minute:"2-digit"})},a?{tag:"span",class:"schedule-frequency",html:t}:""]},i&&this.getControl("joinButton")]:[{tag:"div",class:"schedule-bar",html:[{tag:"span",class:"schedule-text",html:o.Scheduled},{tag:"span",class:"fonticon fonticon-calendar"},{tag:"span",class:"schedule-time",html:s.toDateString()+" "+s.toLocaleTimeString(n.getCurrentLanguage()||"en",{hour:"2-digit",minute:"2-digit"})},a?{tag:"span",class:"schedule-frequency",html:t}:""]},i&&this.getControl("joinButton")]}return e}})}),define("DS/SwymUIComponents/script/feature/core/ui-components/layout/layout-definition",["UWA/Core","UWA/Class/Options","DS/Logger/Logger"],function(e,t,i){"use strict";var n=void 0,o=void 0,s="/",a=new RegExp("\\:([A-Za-z0-9-%_.:]+)?","g");function r(t,i,a){var r={},l=t.pages,c=Array.isArray(l)?l:Object.keys(l);c&&i.forEach(function(e,t){r[c[t]]=e}),n=e.extend(t.branches?e.clone(t.branches):{},r,!0),o=function t(i,n,o,a){return n=n||"",o=o||{},a=a||{},Object.keys(i).forEach(function(r){var l=i[r],c=n+(n&&r?s:"")+r,d=new RegExp("(^"+c+")(\\"+s+".*|$.*)");l.config=e.extend(e.clone(o),l.config,!0),a[c]=l.config,l.branches&&t(l.branches,c,l.config,a),l.aliases&&l.aliases.forEach(function(e){var t=n+(n&&e?s:"")+e;Object.keys(a).forEach(function(e){var i;e.match(d)&&((i=e.replace(d,t+"$2")).length>1&&"/"===i.substr(0,1)&&(i=i.substr(1)),a[i]=a[e])})})}),a}(e.clone(n),"",t.config),a.callback.call(null,o)}return t.singleton({defaultOptions:{root:null},parseRoute:function(t){var i=[],n=t||"";return e.is(t,"string")&&((i=t.match(a))?(n=t.replace(a,"")).endsWith(s)&&(n=n.slice(0,n.length-1)):i=[]),{route:n,values:i}},getRootViewsDefinition:function(t){var i,n,o=this.getOption("root");if(o)return n=this.getNode(t).layoutDefinition,i=e.extend({},o.views),Object.keys(i).forEach(function(t){e.owns(n,t)&&n[t]||delete i[t]}),i;throw new Error("Layout tree has not been created yet")},getAliasedLayoutDefinition:function(e){if(o)for(const[t,n]of Object.entries(o))try{if(!0===n.regexp&&e.match(new RegExp(t)))return n}catch(e){i.Error("Invalid regexp in layout",e)}},getNode:function(t){var i,n,a,r,l=this.getOption("root").homePage;if(o)return n=this.parseRoute(t).route,(a=o[n]||this.getAliasedLayoutDefinition(n))?r={layoutDefinition:a,layoutRoute:n,initialLayoutRoute:n,failedToFindRequestedNode:!1}:(i=t.split(s),t&&i.length>1?r=this.getNode(i.slice(0,i.length-1).join(s)):e.is(l)&&(r={layoutDefinition:o[l],layoutRoute:l}),r.initialLayoutRoute=n,r.failedToFindRequestedNode=!0),r;throw new Error("Layout tree has not been created yet")},getTree:function(t){var i=this,n=[];e.is(o)&&!0!==t.reset?t.callback.call(null,o):(t.pageModulesPath.endsWith("/")||(t.pageModulesPath+="/"),require([t.pageModulesPath+"root"],function(e){i.setOption("root",e),Array.isArray(e.pages)?n=e.pages.map(function(e){return t.pageModulesPath+e}):"object"==typeof e.pages&&(n=Object.keys(e.pages).map(function(i){return 0===e.pages[i].indexOf("DS/")?e.pages[i]:t.pageModulesPath+i})),n.length>0?require(n,function(){r(e,Array.prototype.slice.call(arguments),t)},function(){throw new Error("Could not load page definitions")}):r(e,[],t)},function(){throw new Error("Could not load root page definition")}))}})}),define("DS/SwymUIComponents/script/feature/core/ui-components/box-view/box-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/ui-components/box-view/box-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/utils/utils","DS/UIKIT/Input/Button","DS/UIKIT/DropdownMenu","DS/WebappsUtils/Console"],function(e,t,i,n,o,s,a){"use strict";return i.extend({name:"box-view",_modelEventsForAutoRefresh:["onChange"],_createContent:function(){var i,n="";return this.model.collection.getAssociated("user").isCurrentUser()&&(n='<span class ="fonticon fonticon-2x cursor-pointer fonticon-down-open"></span>'),i=e.createElement("div",{class:"border-box-view row",html:[{class:"col-xs-12 box-view-line",html:[{class:"box-view-title",html:String(this._getHTMLContent())},{class:"box-view-icons level-"+this.model.getLevelFromDBToJS(),html:this._getStarsHtml()+n}]},{class:"profile-box-details",html:this._getDetails()}]}),this.addControl("dropdown",new s({target:i.getElement(".fonticon-down-open"),items:[{text:t.Edit,fonticon:"pencil"},{text:t.Delete,fonticon:"trash"}],events:{onClick:function(e,t){"pencil"===t.fonticon?this.model.dispatchEvent("onPencilIconClicked"):"trash"===t.fonticon&&this.model.dispatchEvent("onTrashIconClicked")}.bind(this)}})),i},_getHTMLContent:function(){return this.model.get("title")||this.model.get("translated")||this.model.get("lang_english")},_getStarsHtml:function(){for(var e="",t=this.model.getLevelFromDBToJS(),i=0;i<t;i++)e+='<span class="fonticon fonticon-1-5x active-blue fonticon-star"></span>';for(var n=0,o=3-t;n<o;n++)e+='<span class="fonticon fonticon-1-5x unactive-blue fonticon-star"></span>';return e},_getDetails:function(){return this.model.get("description")||""}})}),define("DS/SwymUIComponents/script/lib/ckeditor/highlight/plugin",["DS/SwymUICore/script/utils/utils","DS/WebappsUtils/WebappsUtils","i18n!DS/SwymUIComponents/assets/nls/lib/ckeditor/highlight/highlight"],function(e,t,i){CKEDITOR.plugins.add("highlight",{icons:"highlight",style:{element:"span",attributes:{class:"marker"}},init:function(e){var n=this;e._.menuItems.link&&delete e._.menuItems.link,e.addCommand("highlight",{contextSensitive:!0,exec:function(e,t){this.state===CKEDITOR.TRISTATE_ON?(e.removeStyle(new CKEDITOR.style(n.style)),this.setState(CKEDITOR.TRISTATE_OFF)):e.applyStyle(new CKEDITOR.style(n.style))},refresh:function(e,t){for(var i=e.getSelection().getRanges()[0].startContainer.$,n=!0;i.parentNode&&i.parentNode.getAttribute&&i.parentNode.getAttribute("id")!==e.name&&n;)i&&"SPAN"===i.nodeName&&"marker"===i.getAttribute("class")?(this.setState(CKEDITOR.TRISTATE_ON),n=!1):this.setState(CKEDITOR.TRISTATE_OFF),i=i.parentNode}}),e.ui.addButton("Highlight",{label:i.highlight,command:"highlight",toolbar:"basicstyles",icon:t.getWebappsBaseUrl()+"SwymUIComponents/assets/ckeditor/highlight.png"})}})}),define("DS/SwymUIComponents/script/feature/core/ui-components/tooltip/responsive-button-tooltip",["UWA/Core","DS/UIKIT/Tooltip"],function(e,t){"use strict";return t.extend({defaultOptions:{btnMaxWidth:42},show:function(){if(this.getOption("target")&&this.getOption("target").getSize().width<=this.getOption("btnMaxWidth"))return this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/media/library/DriveInSwymView",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-view"],function(e,t){return t.extend({className:"target-3ddrive",_createContent:function(){return e.createElement("div",{})},destroy:function(){this.container.remove()}})}),define("DS/SwymUIComponents/script/feature/community/media/library/media-library-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/library/media-library-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/view/upload-manager-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/edit/content-creation-view","DS/SwymUICore/script/utils/i18n","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/feature/community/media/collection/media-collection","DS/SwymUIComponents/script/feature/community/media/library/media-filters-toolbar-view","DS/W3DXComponents/Views/Layout/ScrollView","DS/SwymUIComponents/script/feature/community/media/library/library-list-view","DS/UIKIT/Input/Button","DS/i3DXCompassServices/i3DXCompassPubSub","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUIComponents/script/feature/community/media/library/DriveInSwymView","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/core/context/context-model"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w){"use strict";return s.extend({name:"media-library-view",domEvents:{"click .close.fonticon-cancel":"_destroy"},_lastScrollPosition:null,_mediaSelectedCollection:null,_createContent:function(){return[{class:"library-header",html:'<span class="fonticon close fonticon-cancel fonticon-2x"></span>'},this.getChildView("filtersToolbarView"),this.getChildView("driveInSwymView").hide(),this.getControl("scrollView"),this.getChildView("backToTopView"),{class:"library-action-buttons",html:[{html:[this.addControl("add-button",new d({className:"primary",value:t.SelectMedia,disabled:!0,events:{onClick:function(){this._dispatchMediaCollection([],this._mediaSelectedCollection)}.bind(this)}})),this.addControl("cancel-button",new d({value:n.Cancel,events:{onClick:function(){this._destroy()}.bind(this)}}))]}]}]},_dispatchMediaCollection:function(e,t){this.dispatchEvent("newMediaAdded",{newMedia:e,existingMedia:t})},_updateActionBar:function(e){var i=this.getControl("add-button"),n=e.length;i&&(i.setDisabled(0===n),i.setValue(o.replace(t.AddMedia,{number:n})))},_destroy:function(){this.isDestroyed()||this.destroy()},setup:function(e){this._parent.apply(this,arguments),window.document.onkeydown=function(e){("key"in(e=e||window.event)?"Escape"==e.key||"Esc"==e.key:27==e.keyCode)&&this._destroy()}.bind(this),this._lastScrollPosition||(this._lastScrollPosition={x:0,y:0}),this.context=w.getInstance(),this.context.addListener("onContextChange",this._destroy,this,!1),this._collection=new a([],{mode:"all",limit:10});var t=this.addChildView("library-list-view",new c({collection:this._collection,communityId:this.getOption("communityId")}));this.addControl("scrollView",new l({view:this.getChildView("library-list-view"),useInfiniteScroll:!0,usePullToRefresh:!1,events:{onInfiniteScroll:function(e){this.getChildView("library-list-view").dispatchEvent("onInfiniteScroll",[this.getControl("scrollView")])}.bind(this)}})).container.addClassName("scroll-library-list"),this.addChildView("backToTopView",{Class:"DS/SwymUIComponents/script/feature/core/ui-components/layout/back-to-top-view",manager:this,events:{onInit:function(e){this.listenTo(e,{onScrollToTopRequest:function(e){this.onScrollToTopRequest(e)}})}.bind(this)}});var i=this.addChildView("filtersToolbarView",{Class:r,collection:this._collection,communityId:this.getOption("communityId"),threadType:this.getOption("threadType")});this.addChildView("driveInSwymView",{Class:p});return this.listenTo(t,{newMediaAdded:function(){this._dispatchMediaCollection(arguments[0],arguments[1])}.bind(this),newMediaSelected:function(e){this._mediaSelectedCollection=e,this._updateActionBar(e)}.bind(this)}),this.listenTo(i,{onActivateDrive:this._activateDrive,onActivateInfiniteScroll:this._activateInfiniteScroll}),this._on3DDriveSelectionChangeBound=this._on3DDriveSelectionChange.bind(this),this},_on3DDriveSelectionChange:function(e){var n,o,s,a=this.getChildView("library-list-view")._uploadManager;this._mediaSelectedCollection=[];for(var r=0,l=e.length;r<l;r++)o=(n=e[r]).displayName,a&&((s=o.split(".")).length>1?(s=s[s.length-1],a._getType(s)?"dropbox"===n.serviceId||"google2"===n.serviceId?this.alert("error",t.ExternalDriveError):this._mediaSelectedCollection.push(new h(n)):this.alert("error",i.replace(i.get("FileTypeError"),{FileName:o}))):console.error("Issue while file extension extraction, ",o));this._updateActionBar(this._mediaSelectedCollection)},_activateDrive:function(e){var t=this.getElement(".target-3ddrive"),i=this.getChildView("driveInSwymView"),n=this.getControl("scrollView"),o=this.getChildView("filtersToolbarView"),s=g.getInstance();n&&i&&t&&(e?(n.hide(),o.hideFilters(),i.show(),require(["DS/W3DDrive/w3DDriveMainView"],function(e){this._driveInstance||(this._driveInstance=e.initInstance({platformId:s.get("config").tenant.online_instance_id,showAllPlatforms:!1,showExternalDrives:!1}),this._driveInstance.addEvent("onSelectionChange",this._on3DDriveSelectionChangeBound)),this._driveInstance.inject({targetElement:t})}.bind(this))):(n.show(),o.showFilters(),i.hide()))},_activateInfiniteScroll:function(){var e=this.getControl("scrollView");e&&e.useInfiniteScroll(!0)},onRedraw:function(){this.renderScrollView()},destroy:function(){this._driveInstance&&this._driveInstance.removeEvent("onSelectionChange",this._on3DDriveSelectionChangeBound),this._parent.apply(this,arguments)},onScrollToTopRequest:function(e){this.getControl("scrollView")&&this.getControl("scrollView").scroller.scrollTo(0,0,e||0)},onScroll:function(){var e=this.getChildView("backToTopView"),t=this.getControl("scrollView").scroller.getPosition(),i={position:t,delta:{x:t.x-this._lastScrollPosition.x,y:t.y-this._lastScrollPosition.y}};0===t.y?(this.container.addClassName("scroll-to-top"),e.hide()):(this.container.removeClassName("scroll-to-top"),i&&i.delta.y<0&&-1*t.y>document.body.getSize().height&&e.show()),this._lastScrollPosition=t},renderScrollView:function(){var e=this.getControl("scrollView");e&&"function"==typeof e.render&&(e.render(),this.listenTo(e.scroller.elements.content,"scroll",this.onScroll.bind(this)))},injectInDom:function(){this.inject(document.body).show()}})}),define("DS/SwymUIComponents/script/feature/community/survey/view/answer-result-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/survey/view/answer-result-view","DS/SwymUICore/script/lib/view/generic/swym-model-view"],function(e,t,i){return i.extend({_modelEventsForAutoRefresh:["onChange"],_createContent:function(){var i=this.model;if(i)return e.createElement("div",{class:"answer-result",html:[{class:"answer-wrapper",html:[(1===parseInt(i.get("is_open"),10)?'<div class="answer-description">'+t.OpenAnswers+"</div>":'<div class="answer-description">'+i.get("description"))+'</div><div class="poll-report-stats">('+this.model.getRoundedPercentage()+"%, "+i.get("nbVotes")+" "+(0===parseInt(i.get("nbVotes"),10)?t.votezero:i.get("nbVotes")>1?t.votes:t.vote)+")</div>"]},{class:"poll-result-bar",styles:{width:0}}]})},surveyRedraw:function(){!this.isDestroyed()&&this.model&&this.model.collection&&this.getElement(".poll-result-bar").setStyle("width",this.model.getRoundedPercentage()+"%")}})}),define("DS/SwymUIComponents/script/feature/community/idea/view/pipeline-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/idea/view/pipeline-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/lib/view/generic/swym-view","DS/UIKIT/Tooltip","DS/SwymUICore/script/feature/community/idea/model/idea-model","DS/SwymUICore/script/feature/community/idea/model/status-model","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/utils/date","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/core/context/context-model","UWA/Utils/Client","UWA/String"],function(e,t,i,n,o,s,a,r,l,c,d,m,u){"use strict";function h(e){return e.isOut()}function p(e){return!e.isOut()}var g=document,w=i.extend({name:"idea-tooltip-view",_modelClass:s,_modelEventsForAutoRefresh:["onChange:title","onChange:thumbnail"],_createContent:function(){var t=this.model,i=null;if(t)return i=t.get("thumbnail")&&t.get("thumbnail").mid?r.getBaseUrl()+"/api/media/streammedia/id/"+t.get("thumbnail").mid+"/type/thumb/key/m_thumb/update/"+t.get("thumbnail").preview_fingerprint:r.getBaseUrl()+"/api/media/streammedia/model/idea/model_id/"+t.get("mid")+"/type/thumb/key/m_thumb/update/"+l.getDateInMilliSec(t.get("update")),e.createElement("div",{styles:{"text-align":"left"},html:(i?'<img style="min-height: 170px; margin-bottom: 5px; width: 228px;" src="'+i+'" />':'<div style="padding-top: 10px;"></div>')+'<div class="idea-tooltip-title" style="font-size: 18px; line-height: 32px; padding: 0 10px;">'+t.get("title")+'</div><div class="idea-tooltip-author" style="padding: 0 10px; margin-top: 10px;">'+t.get("author").nickname+"</div>"})}});return n.extend({name:"pipeline-view",config:null,out:!1,zoom:0,maxIdeasByStatus:15,_maxIdeasByZoomStatusAndOut:15,singleIdeaModel:null,ideaCollection:null,statusCollection:null,_cachedWidth:null,_createContent:function(){var i,n,s,a,r,l,c,d,u,h,p,w,C,f,y,v,A,_=this,S=_.config,b=_.statusCollection,I=S.height,D=S.heightDiff,T=S.className,E=S.outClickable,U=S.containerId,k=!0===S.legend,x=this._cachedWidth?this._cachedWidth:1e3;if(b&&b.hasBeenFetched()){i=b.slice(),this.container&&this.container.getParent()&&this.container.getParent().getSize().width>0&&0!==this.container.getParent().getSize().width&&(x=this.container.getParent().getSize().width,this._cachedWidth=x),S.width=x,(n=g.createElementNS("http://www.w3.org/2000/svg","svg")).setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),n.setAttribute("viewBox","0 0 "+x+" "+(I+(k?55:0))),n.setAttribute("preserveAspectRatio","none meet"),n.setAttribute("class","svg-content"),n.setAttribute("width","100%"),n.setAttribute("height",I+(k?55:0)),n.setAttribute("id",U+"_pipeline"),n.setAttribute("xmlns","http://www.w3.org/2000/svg"),n.setAttribute("transform","scale(1)"),!0===e.Utils.Client.Engine.ie10&&n.setAttribute("style","overflow: hidden;"),(r=g.createElementNS("http://www.w3.org/2000/svg","g")).setAttribute("id","w_"+U+"_status_titles"),i.forEach(function(e){l=g.createElementNS("http://www.w3.org/2000/svg","polygon"),d=Math.floor(x/i.length*(e.get("status_nb")-1)),u=Math.floor(x/i.length*e.get("status_nb")),i.length===e.get("status_nb")&&u--,l.setAttribute("points",d+",0 "+u+",0 "+u+","+I+" "+d+","+I),l.setAttribute("shape",!0),l.setAttribute("class",T),l.setAttribute("id","w_"+U+"_"+e.get("mid")+"_status"),l.setAttribute("fill",e.get("color")),l.setAttribute("name",e.get("title",{escapeHTML:!1})),E||l.setAttribute("style","cursor:pointer;"),n.appendChild(l),k&&((A=g.createElementNS("http://www.w3.org/2000/svg","title")).appendChild(g.createTextNode(e.get("title",{escapeHTML:!1}))),l.appendChild(A),p=u-d,(f=g.createElementNS("http://www.w3.org/2000/svg","g")).setAttribute("id","w_"+U+"_status_title_group"),f.setAttribute("clip-path","url(#w_"+U+e.get("mid")+"_clip_mask)"),f.setAttribute("style","cursor:pointer"),p>80&&((w=g.createElementNS("http://www.w3.org/2000/svg","clipPath")).setAttribute("id","w_"+U+e.get("mid")+"_clip_mask"),(C=g.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",d+5),C.setAttribute("y",I+25-13),C.setAttribute("width",p-10),C.setAttribute("height",33),w.appendChild(C),(c=g.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",d+p/2),c.setAttribute("y",I+25),c.setAttribute("id","w_"+U+"_"+e.get("mid")+"_status_title"),c.setAttribute("text-anchor","middle"),c.setAttribute("class","status-title"),c.appendChild(g.createTextNode(e.get("title",{escapeHTML:!1}))),f.appendChild(c),f.appendChild(w)),(v=g.createElementNS("http://www.w3.org/2000/svg","title")).appendChild(g.createTextNode(e.get("title",{escapeHTML:!1}))),f.appendChild(v),(y=g.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",d+p/2),y.setAttribute("y",I+25+15),y.setAttribute("id","w_"+U+"_"+e.get("mid")+"_status_title_count"),y.setAttribute("text-anchor","middle"),y.setAttribute("class","status-title"),y.setAttribute("title",e.get("title",{escapeHTML:!1})),f.appendChild(y),r.appendChild(f))}),k&&n.appendChild(r);var M=g.createElementNS("http://www.w3.org/2000/svg","text");M.setAttribute("x",x/2),M.setAttribute("y",I+25),M.setAttribute("id","w_"+U+"_zoomed_status"),M.setAttribute("text-anchor","middle"),M.setAttribute("class","status-title"),M.setAttribute("style","cursor:pointer"),M.appendChild(g.createTextNode("")),n.appendChild(M);var V=m.Engine.firefox?1:0;if((s=g.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d","M0,0 Q"+x/2.5+","+D+" "+(x+V)+","+(D-V)+" Q"+(x+V)+",0 "+(x+V)+",-"+V),s.setAttribute("class","curve-shape"),s.setAttribute("id",U+"_top_curve"),s.setAttribute("shape",!0),n.appendChild(s),(a=g.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d","M0,"+(I+V)+" Q"+x/2.5+","+(I-D)+" "+(x+V)+","+(I-D+V)+" Q"+(x+1)+","+I+" "+(x+1)+","+(I+V)),a.setAttribute("class","curve-shape"),a.setAttribute("id",U+"_bottom_curve"),a.setAttribute("shape",!0),n.appendChild(a),!E){const i="fonticon fonticon-lightbulb-thumbs-up",n="fonticon fonticon-lightbulb-thumbs-down";h=e.createElement("span",{class:this.out?n:i+" checked",events:{click:function(){_._viewOut(),_.out?(this.removeClassName(i),this.removeClassName("checked"),this.addClassName(n)):(this.removeClassName(n),this.addClassName(i),this.addClassName("checked"))}}}),this._inAndOutButtonTooltip=new o({target:h,body:t.ViewOutIdeas})}return{html:[e.extendElement(n),{class:"pipeline-icon-bar",html:[null,h||null]}]}}},createListIdeasByStatus:function(e,t){var i=this,n=[],o=0;return e.forEach(function(e){for(var s,a,r,l,c=0,d=[],m=0,u=(s=t.filter(function(t){return t.get("status_id")===e.get("mid").toString()})).length;u--;)a=d[d.length-1],l=!(r=s[u]).isOut(),a&&a.date===r.get("crdate").substring(0,10)||(a={date:r.get("crdate").substring(0,10),ideas:[],ideasZoom:[],ideasOut:[]},d.push(a)),c<i.maxIdeasByStatus&&l&&(a.ideas.push(r),c++),l?m<i._maxIdeasByZoomStatusAndOut&&(a.ideasZoom.push(r),m++):o<i._maxIdeasByZoomStatusAndOut&&(a.ideasOut.push(r),o++);n.push(d)}),n},computeScoreList:function(e){var t=this,i=[],n=[],o=[];return e.forEach(function(e,s){var a=[],r=[],l=[],c=s+1;e.forEach(function(e){var i=[],n=[],o=[];e.ideas.forEach(function(e){i=t.computeAllScores(e,i,c)}),a.push(i),e.ideasZoom.filter(function(e){return!e.isOut()}).forEach(function(e){n=t.computeAllScores(e,n,c)}),r.push(n),e.ideasOut.filter(function(e){return e.isOut()}).forEach(function(e){o=t.computeAllScores(e,o,c)}),l.push(o)}),i.push(a),n.push(r),o.push(l)}),[i,n,o]},drawIdeas:function(){var t=this,i=function(e){var t,i=(e=e.toString()).length,n=parseInt(e[0],10);for(t=1;t<i;t++)n+=parseInt(e[t],10);return n},n=function(e){var t,i=0;if(0===e.length)return i;for(t=0;t<e.length;t++)i=(i<<5)-i+e.charCodeAt(t),i|=0;return i},o=function(e){var o=(n(e.get("mid"))%2?t.config.heightDiff:t.config.height/2)+4,s=(n(e.get("mid"))%2?t.config.height/2:t.config.height-t.config.heightDiff)-4,a=Math.abs(n(e.get("mid"))).toString();e.isOut()&&(o=(window.ds&&window.ds.isiPad?16:18)/2+4,s=t.config.height/2-4);for(;1!==a.length;)a=i(a).toString();return Math.floor(a/10*(s-o+1)+o)};if(t.container.getElements(".idea-circle").forEach(function(e){e.destroy()}),t.ideaCollection){var s,a,r,l,c,d=this.ideaCollection.slice();if(d.sort(function(e,t){return new Date(e.get("update"))-new Date(t.get("update"))}),c=t.createListIdeasByStatus(t.statusCollection,d),s=t.computeScoreList(c),a=s[0],r=s[1],l=s[2],c.forEach(function(i,n){var s=[];s=d.filter(function(e){return e.get("status_id")===t.statusCollection._models[n].get("mid").toString()});var c,m=0,u=0,g=0,w=s.length,C=t.statusCollection.length,f=parseInt(t.statusCollection._models[n].get("status_nb")),y=t.config.width/C,v=(f-1)*y,A=v,_=t.config.width/C/2>50?t.config.width/C/2:50,S=1===f?50:_+50,b=t.config.width-(1!==f&&f!==C?2:1)*_-100;i.forEach(function(i,d){v+=m,m=y*(i.ideas.length/(w<t.maxIdeasByStatus?w:t.maxIdeasByStatus)),i.ideas.forEach(function(i,s,r){c=Math.floor(v+(s+1)*m/(r.length+1)),e.is(c)&&a[n][d]&&t.addIdea(t.getElement("svg"),i,c,o(i),!1,y,n,a,a[n][d][s])}),S+=u,u=b*(i.ideasZoom.length/(t._maxIdeasByZoomStatusAndOut<s.filter(p).length?t._maxIdeasByZoomStatusAndOut:s.filter(p).length)),i.ideasZoom.filter(p).forEach(function(i,s,a){c=S+(s+1)*u/(a.length+1),c=Math.floor(c),e.is(c)&&r[n][d]&&t.addIdea(t.getElement("svg"),i,c,o(i),!0,y,n,r,r[n][d][s])}),A+=g,g=y*(i.ideasOut.length/(t._maxIdeasByZoomStatusAndOut<s.filter(h).length?t._maxIdeasByZoomStatusAndOut:s.filter(h).length)),i.ideasOut.filter(h).forEach(function(i,s,a){c=A+(s+1)*g/(a.length+1),c=Math.floor(c),e.is(c)&&l[n][d]&&t.addIdea(t.getElement("svg"),i,c,o(i),!1,y,n,l,l[n][d][s])})})}),t.ideaCollection&&"filter"===t.ideaCollection.lastCalledService&&t._parentView&&t._parentView.model){var m=t._parentView._ideaTypeModel&&t._parentView._ideaTypeModel.getStatusCollection&&t._parentView._ideaTypeModel.getStatusCollection(),g=t._parentView.model.get("ideation_status_filtered_array");m&&m.map(function(e){var t=g&&g.find(function(t){return u.unescapeHTML(e.get("title"))===t.title});return t?e.set("nb_ideas",t.status_nb):e.set("nb_ideas",0),e}).forEach(function(e){t._createStatusTooltip(e)})}else t._parentView&&t._parentView._ideaTypeModel&&t._parentView._ideaTypeModel.getNbIdeasPerStatus({onComplete:function(){t._parentView._ideaTypeModel.getStatusCollection().forEach(function(e){t._createStatusTooltip(e)})}})}},_createStatusTooltip:function(e){var i=e.get("mid"),n=e.get("nb_ideas");this.container&&this.config.legend&&this.container.getElement("#w_"+this.config.containerId+"_"+i+"_status_title_count").setContent("("+n+")"+(e.get("is_mature")?" ("+t.Mature+")":""))},addSingleIdea:function(e){var t,i,n,o,s,a=e.getAttributes();if(this.statusCollection.length>1){for(i=0;i<this.statusCollection.length;i++)a.status_id===this.statusCollection.at(i).get("mid").toString()&&(a.status_nb=parseInt(this.statusCollection.at(i).get("status_nb"),10));if((s=g.createElementNS("http://www.w3.org/2000/svg","circle")).setAttribute("cx",(a.status_nb-.5)*(this.config.width/this.statusCollection.length)),s.setAttribute("cy",this.config.height/2),s.setAttribute("r",10),s.setAttribute("title",a.title),s.setAttribute("class","idea-circle"),s.setAttribute("id","w_"+this.config.containerId+"_"+a.mid+"_idea"),s.setAttribute("fill","#FFFFFF"),this.container.firstChild.appendChild(s),this.singleIdeaModel=e,this.initial_status_nb=a.status_nb,this.initial_out="1"===a.out,this.current_status_nb=this.initial_status_nb,this.current_out=this.initial_out,!0===this.initial_out){for(n=0,o=(t=this.container.firstChild.childNodes).length;n<o;n++)"true"===t[n].getAttribute("shape")&&t[n].setAttribute("transform","translate(0,"+(this.config.height/2-this.config.heightDiff/2)+")");s.cy.baseVal.value=(parseInt((a.status_nb-1)*this.config.heightDiff/this.statusCollection.length,10)+parseInt(a.status_nb*this.config.heightDiff/this.statusCollection.length,10))/2+20}}},setIdeaCollection:function(e){var t=this;t.ideaCollection&&t.stopReactingTo(t.ideaCollection),t.ideaCollection=e,t.reactTo(t.ideaCollection,["onChange:status_id","onChange:out"],function(){0!==t.zoom&&t._zoomStatus(t,t.zoom).call(),t.drawIdeas()}),t.config&&t.config.collectionEventsForAutoRefresh&&t.reactTo(t.ideaCollection,t.config.collectionEventsForAutoRefresh,function(){t.drawIdeas()}),t.drawIdeas()},onShow:function(){},onRedraw:function(){this.ideaCollection?this.drawIdeas():this.singleIdeaModel&&this.addSingleIdea(this.singleIdeaModel)},showIdeaTooltip:function(t,i){var n,o=this,s=null,a={};function r(){t.removeEvent("mouseout",l),e.extendElement(window.document).removeEvent("click",l)}function l(){clearTimeout(s),a.showTooltip=!1,r()}!e.Utils.Client.Features.touchEvents&&t.addEvent("mouseout",l),!e.Utils.Client.Features.touchEvents&&e.extendElement(window.document).addEvent("click",l),a.target=t,a.callback=r,s=setTimeout(function(){a.model=i,n=o.createIdeaTooltip(a),e.Utils.Client.Features.touchEvents&&n.getContent().addEvent("click",function(){d.getInstance().reset({contentId:i.get("mid"),contentType:i.getModelName(),communityId:i.getCommunity().get("mid")})})},500)},createIdeaTooltip:function(t){var i,n=this;return!1!==t.showTooltip&&(i=n.addControl("tooltip_"+n.cid+"_"+t.model.cid,new o({className:"idea-pipeline-tooltip",target:t.target,position:"left",offset:{x:-(t.target.getAttribute("r")?parseInt(t.target.getAttribute("r")):0),y:t.target.getAttribute("r")?parseInt(t.target.getAttribute("r")):0},body:[new w({model:t.model,widget:this._widget}),{class:"social-features-wrapper"}],delay:{show:500},events:{onShow:function(){n.getControl("tooltip_"+n.cid+"_"+t.model.cid).getBody().getElement(".social-features-wrapper").setHTML(n.addChildView("socialFeatures_"+n.cid+"_"+t.model.cid,{model:t.model,comments:!0,forceCommentFetchIfNotDoneYet:!1,commentsNumberAtInit:0,socialToolbarMode:"light",Class:"DS/SwymUIComponents/script/feature/community/content/social-interactions/social-toolbar-view",modelName:t.model.getModelName(),enableShare:!1,widget:n._widget})),this.updatePosition()},onHide:function(){n.getChildView("socialFeatures_"+n.cid+"_"+t.model.cid)&&n.removeChildView("socialFeatures_"+n.cid+"_"+t.model.cid),n.removeControl("tooltip_"+n.cid+"_"+t.model.cid)}}})),!1!==t.showTooltip&&e.extendElement(t.target).isInjected(document.body)?i.show():i.destroy()),t.callback&&t.callback(),i},computeAllScores:function(e,t){var i,n,o,s=e.getAttributes();return i=Number(s.nb_comments),n=Number(s.nb_endorse),s.nb_endorse||(n=0),s.nb_comments||(i=0),o=(i?i+2:0)+(n?n+1:0),t.push(o),t},addIdea:function(t,i,n,o,s,a,r,l,c){var m,u,h,p,w,C=this,f=e.extendElement(g.createElementNS("http://www.w3.org/2000/svg","circle")),y=n-Math.floor(a)*r,v=[];m=i.getAttributes(),u=window.ds&&window.ds.isiPad?4:6,h=window.ds&&window.ds.isiPad?16:18,s?l[r].forEach(function(e){v=v.concat(e)}):l.forEach(function(e){e.forEach(function(e){v=v.concat(e)})}),(w=Math.max.apply(null,v))>h-u&&(c=Math.round((h-u)*c/w)),p=u+c,s||(y<=p&&(n=p+r*a+2),a-y<=p&&(n=(r+1)*a-p-2)),f.setAttribute("r",p),f.setAttribute("cx",n),f.setAttribute("cy",o),f.setAttribute("id","w_"+C.config.containerId+"_"+m.mid+"_idea"+(s?"_zoom":"")),f.setAttribute("fill","#FFFFFF"),f.setAttribute("class","idea-circle"+("1"===m.out?" out":"")+(s?" zoom":" notzoom")),f.setAttribute("name",m.title),f.setAttribute("status",m.status_title),f.addEvent("mouseenter",function(){C.showIdeaTooltip(f,i)}),f.addEvent("click",function(){e.Utils.Client.Features.touchEvents?C.showIdeaTooltip(f,i):d.getInstance().reset({contentId:this.get("mid"),contentType:this.getModelName(),communityId:this.getCommunity().get("mid")})}.bind(i)),C.out?s||"1"!==m.out?C._hideIdea(f):C._showIdea(f):"1"===m.out?C._hideIdea(f):s?0!==C.zoom&&C.zoom===parseInt(m.status_nb,10)?C._showIdea(f):C._hideIdea(f):0===C.zoom?C._showIdea(f):C._hideIdea(f),t&&t.appendChild(f)},_diff:function(e,t){return e/1e3*t},_updateZoomedStatusNbIdeas:function(e){var t,i=this.getElement("#w_"+this.config.containerId+"_zoomed_status"),n=this.getElement("#w_"+this.config.containerId+"_status_titles");!0===this.out?(i.setContent(""),i.hide(),n&&n.hide()):e?(t=e.get("nb_ideas"),i.setContent(e.get("title")+(t?" ("+t+")":" (0)")),n&&n.hide(),i.show()):(i.setContent(""),i.hide(),n&&n.show())},_zoomStatus:function(e,t){return function(){if(!e.out){var i,n,o,s,a=0,r=0,l=5e3,c=null,d=e.statusCollection.slice(),m=e.container.getElements("polygon");if(e.stopRight=!1,e.stopLeft=!1,0===e.zoom?e.zoom=t:e.zoom=0,0!==e.zoom){var u,g=d[t-1],w=g.get("title");e._updateZoomedStatusNbIdeas(g),e.dispatchEvent("ZoomIdeaStatus",{status_title:w,out:!1}),u=function(){if(l+=300,e.rightMax>e.xRight?(e.xRight+=e._diff(l,10),e.rightMax<e.xRight&&(e.xRight=e.rightMax),r=-(e.config.width/d.length*t-e.xRight),e.stopRight=!1):!1===e.stopRight&&(e.stopRight=!0,r=-(e.config.width/d.length*t-e.rightMax)),e.leftMin<e.xLeft?(e.xLeft-=e._diff(l,10),e.leftMin>e.xLeft&&(e.xLeft=e.leftMin),a=e.config.width/d.length*(t-1)-e.xLeft,e.stopLeft=!1):!1===e.stopLeft&&(e.stopLeft=!0,a=e.config.width/d.length*(t-1)-e.leftMin),e.stopRight&&e.stopLeft)clearInterval(i);else for(n=0;n<d.length;n++)"true"===m[n].getAttribute("shape")&&(c=m[n],t===parseInt(d[n].getAttributes().status_nb,10)?c.setAttribute("points",e.xLeft+",0 "+e.xRight+",0 "+e.xRight+","+parseInt(e.config.height,10)+" "+e.xLeft+","+parseInt(e.config.height,10)):parseInt(d[n].getAttributes().status_nb,10)<t?c.setAttribute("points",parseInt(e.config.width/d.length*(d[n].getAttributes().status_nb-1)-a,10)+",0 "+parseInt(e.config.width/d.length*d[n].getAttributes().status_nb-a,10)+",0 "+parseInt(e.config.width/d.length*d[n].getAttributes().status_nb-a,10)+","+parseInt(e.config.height,10)+" "+parseInt(e.config.width/d.length*(d[n].getAttributes().status_nb-1)-a,10)+","+parseInt(e.config.height,10)):parseInt(d[n].getAttributes().status_nb,10)>t&&c.setAttribute("points",parseInt(e.config.width/d.length*(d[n].getAttributes().status_nb-1)+r,10)+",0 "+parseInt(e.config.width/d.length*d[n].getAttributes().status_nb+r,10)+",0 "+parseInt(e.config.width/d.length*d[n].getAttributes().status_nb+r,10)+","+parseInt(e.config.height,10)+" "+parseInt(e.config.width/d.length*(d[n].getAttributes().status_nb-1)+r,10)+","+parseInt(e.config.height,10)))},function(){e.xRight=parseInt(e.config.width/d.length*t,10),e.leftMin=1===t?0:e.config.width/d.length/2>50?parseInt(e.config.width/d.length/2,10):50,e.xLeft=parseInt(e.config.width/d.length*(t-1),10),e.rightMax=parseInt(e.config.width-(t===d.length?0:e.config.width/d.length/2>50?e.config.width/d.length/2:50),10),i=setInterval(u,10)}(),e.ideaCollection.forEach(function(i){(h(i)&&!0===e.out||p(i)&&!1===e.out)&&(o=e.container.getElement("#w_"+e.config.containerId+"_"+i.get("mid")+"_idea"),s=e.container.getElement("#w_"+e.config.containerId+"_"+i.get("mid")+"_idea_zoom"),parseInt(i.get("status_nb"),10)===t?(this._hideIdea(o),this._showIdea(s)):(this._hideIdea(o),this._hideIdea(s)))},e)}else{for(e._updateZoomedStatusNbIdeas(),e.dispatchEvent("ZoomIdeaStatus",{status_title:null,out:!1}),n=0;n<d.length;n++)"true"===m[n].getAttribute("shape")&&(c=m[n]).setAttribute("points",parseInt(e.config.width/d.length*(d[n].getAttributes().status_nb-1),10)+",0 "+parseInt(e.config.width/d.length*d[n].getAttributes().status_nb,10)+",0 "+parseInt(e.config.width/d.length*d[n].getAttributes().status_nb,10)+","+e.config.height+" "+parseInt(e.config.width/d.length*(d[n].getAttributes().status_nb-1),10)+","+e.config.height);e.ideaCollection.forEach(function(t){o=e.container.getElement("#w_"+e.config.containerId+"_"+t.get("mid")+"_idea"),s=e.container.getElement("#w_"+e.config.containerId+"_"+t.get("mid")+"_idea_zoom"),h(t)&&!0===e.out||p(t)&&!1===e.out?this._showIdea(o):this._hideIdea(o),this._hideIdea(s)},e)}}}},_showIdea:function(e){e&&e.removeClassName("hidden")},_hideIdea:function(e){e&&e.addClassName("hidden")},_viewOut:function(){var e,i,n,o,s,a=this,r=a.container,l=r.getElements("polygon"),c=l.concat(r.getElements("path"));0!==a.zoom&&a._zoomStatus(a,a.zoom).call(),a.out=!a.out,s=a.out,i=s?-600:600,r.getElements(".idea-circle.notzoom, .idea-circle.out").forEach(function(e){e.isHidden()?a._showIdea(e):a._hideIdea(e)}),a._inAndOutButtonTooltip.setBody(s?t.ViewInIdeas:t.ViewOutIdeas),l.forEach(function(e){e.setAttribute("style",s?"":"cursor:pointer;")}),a._updateZoomedStatusNbIdeas(null),a.dispatchEvent("ZoomIdeaStatus",{status_title:null,out:s}),n=function(){var t;if(i>0){if(i+=50,a.translate-=a._diff(i,10),a.translate>0)for(t=0;t<c.length;t++)"true"===c[t].getAttribute("shape")&&c[t].setAttribute("transform","translate(0,"+a.translate+")");if(a.translate<0){for(clearInterval(e),t=0;t<c.length;t++)"true"===c[t].getAttribute("shape")&&c[t].setAttribute("transform","translate(0,0)");a.ideaCollection.forEach(function(e){o=a.container.getElement("#w_"+a.config.containerId+"_"+e.get("mid")+"_idea"),p(e)&&o&&this._showIdea(o)},a)}}else{if(i-=50,a.translate+=-1*a._diff(i,10),a.translate<33+a.config.height/2)for(t=0;t<c.length;t++)"true"===c[t].getAttribute("shape")&&c[t].setAttribute("transform","translate(0,"+a.translate+")");if(a.translate>33+a.config.height/2){for(clearInterval(e),t=0;t<c.length;t++)"true"===c[t].getAttribute("shape")&&c[t].setAttribute("transform","translate(0,"+(33+a.config.height/2)+")");a.ideaCollection.forEach(function(e){o=r.getElement("#w_"+a.config.containerId+"_"+e.get("mid")+"_idea"),h(e)&&this._showIdea(o)},a)}}};a.out?a.translate=0:a.translate=a.config.height/2-a.config.heightDiff/2,e=setInterval(n,10)},setup:function(t){var i,n=this._parent.apply(this,arguments);return i=t&&t.config?t.config:{},t&&t.config&&e.is(t.config.maxIdeasByStatus)&&(this.maxIdeasByStatus=t.config.maxIdeasByStatus),i&&i.statusCollection&&this.statusCollection!==i.statusCollection&&(this.statusCollection&&this.stopReactingTo(this.statusCollection,"onEdit"),this.statusCollection=i.statusCollection,this.reactTo(this.statusCollection,["onEdit"],function(){this.ideaCollection?this.ideaCollection.fetch({onComplete:function(){this.refresh()}.bind(this)}):this.singleIdeaModel&&this.refresh()}.bind(this))),this.config=i,this.addEventOnce("onInjected",function(){this.refresh()},this),n},setConfigAttribute:function(e,t){this.config[e]=t},bindEvents:function(){var e,t,i,n,o=this.container.getElements("polygon");if(this.container.getElements("g")&&(e=this.container.getElements("g"),t=this.getElement("#w_"+this.config.containerId+"_zoomed_status")),o.length>0&&!1===this.config.outClickable)for((n=this.getElement("rect"))&&n.addEvent("click",this._viewOut.bind(this)),i=0;i<o.length;i++)o[i].addEvent("click",this._zoomStatus(this,i+1)),e.length&&(e[i+1].addEvent("click",this._zoomStatus(this,i+1)),t.addEvent("click",this._zoomStatus(this,this.zoom)))}})}),define("DS/SwymUIComponents/script/feature/core/user/view/interest/user-interest-read-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/interest/model/interest-model","DS/WebappsUtils/Console"],function(e,t,i,n){"use strict";return t.extend({name:"interest-read-view",_modelClass:i,_modelEventsForAutoRefresh:["onChange"],_createContent:function(){var e="";return this.model.collection.getAssociated("user").isCurrentUser()&&(e='<span class ="fonticon fonticon-1-5x cursor-pointer fonticon-trash"></span>'),this.model.get("title")+e}})}),define("DS/SwymUIComponents/script/feature/core/user/view/macro/user-column-details-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-view","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/macro/user-column-details-view","DS/WebappsUtils/Console","DS/UIKIT/Popover"],function(e,t,i,n,o){"use strict";return t.extend({name:"user-column-details-view",domEvents:{"click .user-completion-container:not(button)":"_activateCompletionInfo"},setup:function(){return this.listenTo(this.model,{onPassportSynced:this.refresh}),this._parent.apply(this,arguments)},_activateCompletionInfo:function(){var e=this.getChildView("profileCompletion");e&&e.getChildView("mainView").toggleInfoOnCompletion()},_createContent:function(){var t=this.model;if(t){var n=t.getAssociated("links"),o=t.isEditableByPassport("company")||t.isEditableByPassport("zip")||t.isEditableByPassport("country_code")||t.isEditableByPassport("address")||t.isEditableByPassport("city");n.sort();var s=this.model.isCurrentUser()?this.addChildView("profileCompletion",{_title:i.Profilecompletion,Class:"DS/SwymUIComponents/script/feature/core/ui-components/profile-element-container/profile-element-container-view",_mainView:"DS/SwymUIComponents/script/feature/core/user/view/user-completion-view",_userModel:t,_model:t,_otherIcon:"info-circled",_hasBackground:!0}):{},a=this.addChildView("Summary",{_title:i.Summary,Class:"DS/SwymUIComponents/script/feature/core/ui-components/profile-element-container/profile-element-container-view",_userModel:t,_model:t,_hasPencilIcon:!0,_mainView:"DS/SwymUIComponents/script/feature/core/user/view/summary/user-summary-view",_defaultMessage:i.AddSummary,_checkEmptyAttributes:["tenant_more_about_me"],_hasBackground:!0}),r=this.addChildView("Links",{_title:i.Websites,Class:"DS/SwymUIComponents/script/feature/core/ui-components/profile-element-container/profile-element-container-view",_userModel:t,_model:t,_hasPlusIcon:!0,_mainView:"DS/SwymUIComponents/script/feature/core/link/view/link-view",_defaultMessage:i.Addawebsite,_collection:n,_iconSection:"link",_hasBackground:!0}),l=this.addChildView("Location",{_title:i.Location,Class:"DS/SwymUIComponents/script/feature/core/ui-components/profile-element-container/profile-element-container-view",_userModel:t,_model:t,_hasPencilIcon:o,_mainView:"DS/SwymUIComponents/script/feature/core/user/view/location/user-location-view",_iconSection:"map",_hasBackground:!0}),c=this.addChildView("mail",{_title:i.Mail,Class:"DS/SwymUIComponents/script/feature/core/ui-components/profile-element-container/profile-element-container-view",_userModel:t,_model:t,_hasPencilIcon:t.isEditableByPassport("email"),_mainView:1==t.isEditableByPassport("email")?"DS/SwymUIComponents/script/feature/core/user/view/mail/user-mail-view":"DS/SwymUIComponents/script/feature/core/user/view/mail/user-mail-read-view",_iconSection:"mail",_hasBackground:!0,_defaultMessage:i.AddMail,_checkEmptyAttributes:["email"]}),d=this.addChildView("phone",{_title:i.Phone,Class:"DS/SwymUIComponents/script/feature/core/ui-components/profile-element-container/profile-element-container-view",_userModel:t,_model:t,_hasPencilIcon:this.model.isEditableByPassport("tel"),_mainView:"DS/SwymUIComponents/script/feature/core/user/view/phone/user-phone-view",_iconSection:"phone",_checkEmptyAttributes:["tel"],_defaultMessage:i.AddPhone,_hasBackground:!0});return e.createElement("div",{html:[{class:"col-xs-12 user-completion-container cursor-pointer",html:s},{class:"col-xs-12 user-summary-container",html:a},this.model.isCurrentUser()?{class:"col-xs-12",html:c}:{},this.model.isCurrentUser()?{class:"col-xs-12",html:d}:{},{class:"col-xs-12 links-container",html:r},{class:"col-xs-12 user-location-container",html:l}]})}}})}),define("DS/SwymUIComponents/script/feature/core/ui-components/sortable/sortable-list-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-view","UWA/Controls/Drag","DS/SwymUICore/script/utils/utils"],function(e,t,i,n){"use strict";return t.extend({name:"sortable-list-view",_expanded:!0,_mode:"full",init:function(e){return this.itemView=e.itemView,this.itemClassName=e.itemClassName,this.collection=e.collection,this.onRemove=e.onRemove,this.onChange=e.onChange,this.addPlaceholder=e.addPlaceholder,this.reorderPlaceholder=e.reorderPlaceholder,this.removePlaceholder=e.removePlaceholder,this.defaultPlaceholder=e.defaultPlaceholder,this.ghostBuilder=e.ghostBuilder,this.isAllowedToDrop=e.isAllowedToDrop,this.forbiddenPlaceholder=e.forbiddenPlaceholder,this.viewAllPlaceholder=e.viewAllPlaceholder,this.limit=e.limit,this.contentType=e.contentType,this.contentId=e.contentId,this._parent.apply(this,arguments)},setMode:function(e){this._mode="restricted"===e?e:"full"},setCollection:function(e){this.collection=e,this.refresh()},appendNewItem:function(t){var i=t.get("position"),n=this.container.getElement(".draggable-list"),o=n&&n.getChildren(),s=e.createElement("div",{class:"draggable-sortable-item thread-view "+this.itemClassName,"data-content-id":t.get("mid"),"data-content-type":t.get("users")?"direct-message":"community",styles:this._expanded?"":{display:"none"},html:this.addChildView("sortable-item-"+t.get("mid"),new this.itemView({model:t}))});n&&(i&&o.hasOwnProperty(i-1)?n.insertBefore(s,o[i-1]):n.appendChild(s),this.defaultZone.hide())},removeItem:function(e){var t=this.container.querySelector('.draggable-sortable-item[data-content-id="'+e+'"]');t&&t.destroy(),0===this.container.getElementsByClassName("draggable-sortable-item").length&&this.defaultZone&&this.defaultZone.show()},isEmpty:function(){return!1},displayNextPage:function(){var e,t=this.container.getElementsByClassName("draggable-sortable-item"),i=0,n=!1;for(e in t)t.hasOwnProperty(e)&&t[e].isHidden()&&(i<=this.limit?(t[e].show(),i+=1):n=!0);return this._expanded=!n,i<this.limit},viewAllAction:function(){if(this.viewAllPlaceholder){var e,t=this.container.getElementsByClassName("draggable-sortable-item");for(e in t)t.hasOwnProperty(e)&&t[e].isHidden()&&t[e].show();this._expanded=!0,this.viewAll.hide()}},isExpanded:function(){return this._expanded},_addPersistentPlaceholder:function(t){this.persistentPlaceholder=e.createElement("div",{class:"placeholder "+this.itemClassName,html:this.placeHolderHtml}),t.placeholder&&t.placeholder.isInjected()?this.persistentPlaceholder.inject(t.placeholder,"before"):this.persistentPlaceholder.inject(this.sortableContainer)},_createContent:function(){var t,n=this,o=0;return n.placeHolderHtml=[{tag:"span",class:"fonticon fonticon-plus fonticon-2x"},{tag:"span",class:"drop-zone-placeholder",html:n.addPlaceholder}],n.itemCssSelector="."+n.itemClassName,n.defaultZone=e.createElement("div",{class:"default-drop-zone",html:[{tag:"span",class:"fonticon fonticon-drag-drop fonticon-2x"},{tag:"span",class:"drop-zone-placeholder",html:n.defaultPlaceholder}]}),n.forbiddenZone=e.createElement("div",{class:"forbidden-zone",html:[{tag:"span",class:"fonticon fonticon-block fonticon-3x"},{tag:"span",class:"drop-zone-placeholder",html:n.forbiddenPlaceholder}]}),n.pushBottomZone=e.createElement("div",{class:"push-bottom-zone",html:[{tag:"span",class:"fonticon fonticon-plus fonticon-2x"},{tag:"span",class:"drop-zone-placeholder",html:"Add favorite here"}]}),n.trashZone=e.createElement("div",{class:"draggable-sortable-trash",html:[{tag:"span",class:"fonticon fonticon-trash fonticon-2x"},{tag:"span",class:"drop-zone-placeholder",html:n.removePlaceholder}]}),n.viewAll=n.viewAllPlaceholder?e.createElement("div",{class:"view-all",html:n.viewAllPlaceholder,events:{click:n.viewAllAction.bind(n)}}):"",n.collection.length>0&&(t=[n.collection.map(function(t){var i="";return!n.limit||n.limit&&o<n.limit?o+=1:i={display:"none"},e.createElement("div",{class:"draggable-sortable-item thread-view "+n.itemClassName,"data-content-id":n.contentId?n.contentId(t):t.get("mid"),"data-content-type":n.contentType?n.contentType:"community",styles:i,html:n.addChildView("sortable-item-"+t.get("mid"),new n.itemView({model:t}))})})],n.defaultZone.hide()),"restricted"===n._mode&&n.defaultZone.hide(),n._expanded=!(n.limit&&n.collection.length>n.limit),n.forbiddenZone.hide(),n.pushBottomZone.hide(),t=[n.forbiddenZone,n.defaultZone,n.sortableContainer=e.createElement("div",{class:"draggable-list",html:t}),n.trashZone,n.pushBottomZone,n._expanded?"":n.viewAll],n.isDragState=!1,n.dragMoveComponent&&n.dragMoveComponent.destroy(),n.dragMoveComponent=new i.Move({container:document.body,zones:[n.sortableContainer,n.trashZone,n.pushBottomZone],delegate:n.itemCssSelector+", "+n.itemCssSelector+" *",centerHandles:!0,handles:n._handles.bind(n),move:n._move.bind(n),fixed:n._fixed.bind(n),enter:n._enter.bind(n),leave:n._leave.bind(n),drop:n._drop.bind(n),stop:n._stop.bind(n),start:n._start.bind(n)}),t},_start:function(e){if(e.target.getClosest(this.itemCssSelector).hasClassName("draggable-sortable-item")&&"restricted"===this._mode)return!1},_handles:function(t){var i,o=[{tag:"span",class:"fonticon fonticon fonticon-drag-drop fonticon-2x"},{tag:"span",class:"drop-zone-placeholder",html:this.reorderPlaceholder}],s=t.target.getClosest(this.itemCssSelector);return this.isFromDraggableList=s.hasClassName("draggable-sortable-item"),this.isDragState=this.isAllowed=!0,this.hasBeenAdded=this.hasBeenDropped=!1,this.dispatchEvent("onDragStart",t),this.defaultZone.hide(),i=(i=this.ghostBuilder(t))||s,this.isAllowedToDrop(i)||this.isFromDraggableList||(this.isAllowed=!1,this.container.addClassName("forbidden"),this.forbiddenZone.show()),(!t.placeholder||!t.placeholder.isInjected()&&!this.persistentPlaceholder.isInjected())&&this.isAllowed&&"full"===this._mode&&this._addPersistentPlaceholder(t),this.isFromDraggableList&&this.isAllowed&&(this.trashZone.setStyle("display","block"),this.trashZone.setStyle("opacity",1)),!this.isFromDraggableList&&this.isAllowed&&"restricted"===this._mode&&(this.container.addClassName("restricted-mode"),this.pushBottomZone.show()),t.placeholder=e.createElement("div",{class:"placeholder hover-placeholder "+this.itemClassName,html:this.isFromDraggableList?o:this.placeHolderHtml}),this.oldHandlesHTML=i,this.currentHandles=n.cloneNode(i,!0),e.extendElement(this.currentHandles),i.hide(),this.currentHandles.addClassName("dragged custom-ghost no-rich-tooltip"),this.currentHandles.inject(document.body.getParent()).show(),this.currentHandles.style.width=this.container.offsetWidth+"px",this.currentHandles},_move:function(e){e.refreshCache()},_fixed:function(e,t){return!(!t.hasClassName("draggable-sortable-trash")&&!t.hasClassName("default-drop-zone"))},_enter:function(e){if(this.isAllowed&&"full"===this._mode){if(e.zone.hasClassName("draggable-list"))return this.persistentPlaceholder&&this.persistentPlaceholder.destroy(),e.placeholder;!e.placeholder.isInjected()&&!this.persistentPlaceholder.isInjected()&&this._addPersistentPlaceholder(e),e.zone.hasClassName("draggable-sortable-trash")&&e.zone.addClassName("hover-trash")}else this.isAllowed&&"restricted"===this._mode&&e.zone.hasClassName("push-bottom-zone")&&e.zone.addClassName("hover-placeholder")},_leave:function(e){this.isAllowed&&"full"===this._mode?(e.zone.hasClassName("draggable-sortable-trash")&&e.zone.removeClassName("hover-trash"),e.zone.hasClassName("draggable-list")&&this._addPersistentPlaceholder(e)):this.isAllowed&&"restricted"===this._mode&&e.zone.hasClassName("push-bottom-zone")&&e.zone.removeClassName("hover-placeholder")},_drop:function(e){if(this.hasBeenDropped=!0,this.isAllowed){var t,i,n=0;e.zone.hasClassName("push-bottom-zone")&&"restricted"===this._mode?(this.onChange(e.handles,this.sortableContainer.getChildren().length),this.hasBeenAdded=!0):e.zone.hasClassName("draggable-sortable-trash")?this.onRemove(e.handles):e.zone.hasClassName("draggable-list")&&(t=this.sortableContainer.getChildren(),i=e.target.getClosest(this.itemCssSelector),e.handles.getClosest(this.itemCssSelector).hasClassName("draggable-sortable-item")&&t.indexOf(i)<t.indexOf(e.placeholder)&&(n=-1),this.isFromDraggableList&&this.oldHandlesHTML.destroy(),this.onChange(e.handles,t.indexOf(e.placeholder)+n),this.hasBeenAdded=!0)}},_stop:function(e){var t=e.handles.getClosest(this.itemCssSelector);this.dispatchEvent("onDragStop",e),this.hasBeenDropped||e.handles.destroy(),this.isAllowed?(this.trashZone.setStyle("opacity",0),this.trashZone.removeClassName("hover-trash"),this.trashZone.hide(),this.persistentPlaceholder&&this.persistentPlaceholder.destroy(),this.pushBottomZone.hide(),this.pushBottomZone.removeClassName("hover-trash"),e.placeholder.destroy(),e.handles.destroy(),0===this.sortableContainer.getChildren().length&&this.defaultZone.show()):(t&&(t.removeClassName("dragged"),t.setStyles({left:null,top:null})),this.container.removeClassName("forbidden"),this.forbiddenZone.hide(),e.handles.destroy()),this.hasBeenAdded||this.oldHandlesHTML.show(),this.isFromDraggableList=this.isDragState=this.hasBeenAdded=!1},showItemsView:function(){this.getElements(".thread-view > *:first-child").forEach(function(e){e.show()})},destroy:function(){return this.dragMoveComponent&&this.dragMoveComponent.destroy(),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/core/user/view/idcard/user-idcard-bottom-bar",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/UIKIT/Input/Button","DS/WebappsUtils/Console","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/edit-all-bar/edit-all-bar","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/idcard/user-idcard-bottom-bar"],function(e,t,i,n,o,s){"use strict";return t.extend({_idcardInstance:null,name:"user-idcard-bottom-bar",setup:function(e){if(!(e=e||{}).idcardInstance)throw new Error("idcard undefined for user-idcard-bottom-bar");return this._idcardInstance=e.idcardInstance,this._parent.apply(this,arguments)},_createContent:function(){return{class:"idcard-bottom-bar",html:[this.addControl("idcard-bottom-save-button",new i({value:o.validate,className:"saveButton primary",events:{onClick:function(e){var t=this._idcardInstance._controls.editView,i=this.getControl("idcard-bottom-save-button");if(i&&i.load(),t){var n=t.getControl("idcard1-form").validate(),o=this._idcardInstance.model,a=o.getChanges("first_name"),r=o.getChanges("last_name"),l=!0,c={};if(a&&(l=a.trim()),r&&(l=l&&r.trim()),!(n&&o&&l))return i.load(!1),this.alert("error",s.pleaseFillTheFieldsCorrectly),n;a||r?(a&&(c.firstName=a),r&&(c.lastName=r),o.updatePassportFields({data:c,onComplete:function(e,t){this._idcardInstance.switchToViewMode();var n=o.getChanges("first_name");void 0!==n&&o.set("first_name",n.escapeHTML()),void 0!==(n=o.getChanges("last_name"))&&o.set("last_name",n.escapeHTML()),i.load(!1);var a=this._idcardInstance.options.attributesMapping.title.call(o),r=this._idcardInstance.getElement(".title-section span");window.ds&&"3DD"!==window.ds.env?(this.alert("success",s.personalInfoUpdated),require(["DS/TopBar/TopBar"],function(e){e.set({userName:o.getNickname().unescapeHTML()})}.bind(this))):window.ds&&"3DD"===window.ds.env&&window.widget&&(widget.onRefresh(),widget.setTitle(o.getNickname().unescapeHTML())),a&&r&&(r.textContent=a),window.ds&&"3DD"===window.ds.env&&require(["DS/PlatformAPI/PlatformAPI"],function(e){e&&e.publish("profile:update")})}.bind(this)})):(this.alert("info",s.noChangeDetected),i.load(!1))}}.bind(this)}})),new i({value:o.cancel,className:"cancelButton default",events:{onClick:function(e){this._idcardInstance.switchToViewMode()}.bind(this)}})]}}})}),define("DS/SwymUIComponents/script/lib/ckeditor/customlink/plugin",["DS/SwymUICore/script/utils/utils","i18n!DS/SwymUIComponents/assets/nls/lib/ckeditor/customlink/customlink"],function(e,t){CKEDITOR.plugins.add("customlink",{init:function(e){e._.menuItems.link&&delete e._.menuItems.link,e.addCommand("customlink",new CKEDITOR.dialogCommand("customlinkDialog")),e.ui.addButton("CustomLink",{label:t.InsertALink,command:"customlink",toolbar:"links"}),CKEDITOR.dialog.add("customlinkDialog",this.path+"dialogs/customlink.js"),e.on("doubleclick",function(e){e.data.element.is("a")&&(e.data.dialog="customlinkDialog")},null,null,100)}})}),define("DS/SwymUIComponents/script/feature/core/user/view/mail/user-mail-edit-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/user/model/user-model","DS/UIKIT/Input/Text","DS/UIKIT/Form","DS/WebappsUtils/Console"],function(e,t,i,n,o,s){"use strict";return t.extend({_modelClass:i,name:"user-mail-edit-view",_createContent:function(){var t=this.model,i=t.getPassportAttributeConstraints("email");return this.addControl("form-aboutme",new o({fields:[e.merge({type:"email",value:t.get("email",{escapeHTML:!1}),events:{onChange:function(){t.addChanges("email",this.getValue())}}},i)]}))}})}),define("DS/SwymUIComponents/script/feature/core/conversation/view/persistency-modal",["DS/UIKIT/Modal","DS/UIKIT/Input/Button","DS/UIKIT/Input/Toggle","i18n!DS/SwymUIComponents/assets/nls/feature/core/conversation/view/persistency-modal"],function(e,t,i,n){"use strict";return e.extend({_dmModel:null,_activeToggle:null,_unlimitedToggle:null,_saveButton:null,_cancelButton:null,_isPersistent:null,init:function(e){this._dmModel=e.model,e.className="persistency-modal",this._parent(e),this._isPersistent=this._dmModel.get("is_persistent"),this.setHeader("<h4>"+n.ModalTitle+"</h4>"),this._buildBody(),this._buildButtons(),this.setFooter([this._saveButton,this._cancelButton])},_buildBody:function(){var e=this;this._activeToggle=new i({name:"persistency",value:"active",className:"primary",label:n.PersistencyWithActivity,checked:!this._isPersistent,events:{onChange:function(){e._isPersistent=!1}}}),this._unlimitedToggle=new i({name:"persistency",value:"unlimited",className:"primary",label:n.UnlimitedPersistency,checked:this._isPersistent,events:{onChange:function(){e._isPersistent=!0}}}),this.setBody([this._activeToggle,{class:"toggle-explanation",html:n.PersistencyWithActivityExplanation},this._unlimitedToggle,{class:"toggle-explanation",html:n.UnlimitedPersistencyExplanation}])},_buildButtons:function(){var e=this;this._saveButton=new t({value:n.Save,className:"primary",events:{onClick:function(){e._savePersistency()}.bind(this)}}),this._cancelButton=new t({value:n.Cancel,events:{onClick:function(){this.hide()}.bind(this)}})},_savePersistency:function(){var e=this;this._dmModel.setPersistency({isPersistent:this._isPersistent,onComplete:function(){e.hide(),require(["DS/UWPClientControls/PlatformNotify"],function(e){e.success(n.SaveOk)})},onFailure:function(){e.hide(),require(["DS/UWPClientControls/PlatformNotify"],function(e){e.error(n.SaveKo)})}})}})}),define("DS/SwymUIComponents/script/feature/core/education/view/education-read-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/experience/view/experience-read-view","DS/SwymUICore/script/feature/core/education/model/education-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/utils/date","DS/UIKIT/DropdownMenu","DS/SwymUICore/script/utils/i18n"],function(e,t,i,n,o,s,a){"use strict";return n.extend({_modelEventsForAutoRefresh:["onChange:place","onChange:date_begin","onChange:date_end","onChange:degree","onChange:not_finished","onChange:description","onChange:field_of_study","onChange:school_name"],_modelClass:i,name:"education-read-view",_createContent:function(){var i=this.model.collection.getAssociated("user").isCurrentUser()?'<span class="fonticon fonticon-2x cursor-pointer fonticon-down-open"></span>':"",n=this.model.get("degree")?a.replace(t.degreein,{degree:this.model.get("degree"),fieldOfStudy:this.model.get("field_of_study")}):this.model.get("field_of_study"),r=this.model.get("place")?"("+this.model.get("place")+")":"",l="1"==this.model.get("not_finished")?'<span class="profile-date-experience">'+t.since+" "+o.textDate(this.model.get("date_begin"))+"</span>":'<span  class="profile-date-experience">'+o.textDate(this.model.get("date_begin"))+" - "+o.textDate(this.model.get("date_end"))+"</span>",c=e.createElement("div",{html:'<span class="profile-title-experience">'+n+"</span>"+i+'<br><span class="profile-location-experience">'+this.model.get("school_name")+" "+r+"</span>"+l+'<span class="profile-description-experience">'+(this.model.get("description",{breakline:!0})||"")+"</span>"});return this.addControl("dropdown",new s({target:c.getElement(".fonticon-down-open"),items:[{text:t.Edit,fonticon:"pencil"},{text:t.Delete,fonticon:"trash"}],events:{onClick:function(e,t){"pencil"===t.fonticon?this.model.dispatchEvent("onPencilIconClicked"):"trash"===t.fonticon&&this.model.dispatchEvent("onTrashIconClicked")}.bind(this)}})),c}})}),define("DS/SwymUIComponents/script/feature/community/social-event/edit/oauth-provider-manager",["require","exports","DS/SwymUICore/script/lib/request/data","DS/WAFData/WAFData","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/utils"],function(e,t,i,n,o,s){"use strict";var a=null,r=null,l=null;return{getProviderAuthenticationInformation:function(e){return new Promise(function(t,n){var o="/api/passport/oauth/".concat(e),s=i.request({url:o,type:"json",method:"GET",timeout:6e4,headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(e){e&&e.identity_provider_hint&&t({email:e.identity_provider_hint})},onFailure:function(e){n(s&&s.xhr)}})})},focusAuthentificationWindow:function(){r&&!r.closed&&r.focus()},authenticate:function(e,t){var i=this;return a||(a=this.getProviderAuthenticationInformation(e).catch(function(o){return!o||401!==o.status&&400!==o.status?Promise.reject("Error"):new Promise(function(e,i){n.authenticatedRequest(t,{type:"json",method:"GET",timeout:6e4,headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(t){t&&t.identity_provider_hint?e({email:t.identity_provider_hint}):t&&t.redirect_uri&&e(t)},onFailure:function(e){i(e)}})}).then(function(t){return new Promise(function(i,n){if(t&&t.redirect_uri){var o=t.redirect_uri;r=window.open(o,e,"left=160,top=120,width=750,height=750,resizable=yes");var s=setInterval(function(){r&&r.closed&&(r=null,clearInterval(s),i("OK"))},1e3)}})}).then(function(){return i.getProviderAuthenticationInformation(e)})}).finally(function(){a=null})),a},disconnect:function(e){return new Promise(function(t,n){var o="/api/passport/oauth/".concat(e);i.request({url:o,type:"json",method:"DELETE",timeout:6e4,headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(e){t(e)},onFailure:function(e){n(e)}})})},retrieveActivatedConferenceProvider:function(){var e=s.getBaseUrl()+"/api/conferences/providers",t=o.getInstance().getCSRFToken();i.request({url:e,method:"GET",timeout:6e4,headers:{"X-DS-SWYM-CSRFTOKEN":t,Accept:"application/json","Content-Type":"application/json"},onComplete:function(e){if(e&&e.result){var t=e.result.filter(function(e){return!0===e.active_on_tenant});t.length>0&&(l=t[0])}},onFailure:function(e){console.error(e)}})},getActivatedConferenceProvider:function(){return l}}}),define("DS/SwymUIComponents/script/feature/core/user/view/user-group/user-group-nbmembers-view",["i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/users-group-tile-view"],function(e){"use strict";return{getUserGroupMembersText:function(t){var i,n=parseInt(t.get("nb_members"),10);switch(n>0||(n=0),n){case 0:i=e.get("noMember");break;case 1:i=e.get("1member");break;default:i=e.get("Nmembers",{nbMembers:n})}return i}}}),define("DS/SwymUIComponents/script/utils/ui-constants",["require","exports"],function(e,t){"use strict";return{DeviceWidth0:319,DeviceWidth1:799}}),define("DS/SwymUIComponents/script/feature/community/media/video/model-interface/interactive-media",[],function(){"use strict";return{}}),define("DS/SwymUIComponents/script/feature/community/social-event/webex-space-widget-iframe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getIframeHtml=void 0,t.getIframeHtml=function(e,t,i){return'\n    <!DOCTYPE html>\n    <html>\n        <head>\n            \n        </head>\n        <body>\n            <div id="webex-space-widget"></div>\n            \x3c!-- init code --\x3e\n            <script type="text/javascript">\n            function loadWidget() {                \n                var widgetEl = document.getElementById(\'webex-space-widget\');\n                if (widgetEl) {\n                    webex.widget(widgetEl).spaceWidget('.concat(JSON.stringify(i),');\n                }\n            }\n            <\/script>\n            <script src="').concat(e,'" onload=loadWidget()><\/script>\n            <link rel="stylesheet" href="').concat(t,'">\n        </body>\n    </html>\n\n    ')}}),window.require.config({paths:{vuejs:window.dsDefaultWebappsBaseUrl+"vuejs/2.6.10/vue.min","vu-kit":window.dsDefaultWebappsBaseUrl+"vuekit/vu-kit.umd",vuex:window.dsDefaultWebappsBaseUrl+"vuex/3.1.1/vuex.min",SwymUIVueComponents:window.dsDefaultWebappsBaseUrl+"SwymUIVueComponents/dist/SwymUIVueComponents.umd",SwymUIVueComponentsCSS:window.dsDefaultWebappsBaseUrl+"SwymUIVueComponents/dist/SwymUIVueComponents",Vuetify:window.dsDefaultWebappsBaseUrl+"vuetify-2.4.9/dist/vuetify.min"}}),define("vue",["vuejs"],e=>e),define("DS/SwymUIComponents/script/utils/swym-vue",["vuejs","vuex","vu-kit","Vuetify","SwymUIVueComponents","i18n!DS/SwymUIVueComponents/assets/nls/i18n","css!SwymUIVueComponentsCSS","css!vuekit/vu-kit"],function(e,t,i,n,o,s){return e.use(i),e.use(n),e.use(o,s),e.use(t),{Vue:e,VueKit:i,Vuetify:n,Vuex:t}}),define("DS/SwymUIComponents/script/feature/core/stats/view/daterange-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/stats/view/daterange-view","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/lib/request/data","DS/UIKIT/Input/Date","DS/UIKIT/Input/Button","DS/UIKIT/Tooltip","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/feature/core/tenant/model/tenant-model","DS/SwymUICore/script/utils/date","DS/WebappsUtils/Console"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h){return i.extend({_community:null,_tenant:null,className:"daterange-view",_createContent:function(){var e,i=new Date,d=this,m=new Date("2008","0","01");return this._community&&(e=this._community.get("crdate"))&&(e=e.split(" ")[0]),this.addControl("allButton",new a({value:t.All,events:{onClick:function(){this.getControl("startDatePicker").setDate(this._community&&e?new Date(e.split("-")[0],e.split("-")[1]-1,e.split("-")[2]):d._tenantModel?u.convertDate(d._tenantModel.get("crdate")):m),this.getControl("endDatePicker").setDate(i),this.dispatchEvent("bothDateChanged",[this.getControl("startDatePicker").getDate(),this.getControl("endDatePicker").getDate()])}.bind(this)}})),c.getInstance().isFeatureActivated("activate_export_stats")&&(this.addControl("exportButton",new a({className:"primary exportButton",icon:"fonticon-1-5x fonticon-export",attributes:{title:this._community?t.ExportAllTheStatisticsOfTheCommunityAvailableFromTheDateOfItsCreation:t.ExportAllTheStatisticsOfTheTenantAvailableFromTheDateOfItsCreation},events:{onClick:function(){require(["DS/SwymUICore/script/feature/core/user/model/currentuser-model"],function(e){e.getInstanceFetched(function(e){var i=n.adaptService({url:l.getBaseUrl()+"/api/analytics/addexportbatch",data:{tenant_id:this._tenant?this._tenant.id:null,community_id:this._community?this._community.get("mid"):null,as_admin:"1"===e.get("tenant_admin")},onComplete:function(){this.alert("info",t.AnEmailWillBeSentWhenAllStatisticsWillBeReadyToBeDownloaded)}.bind(this),onFailure:function(){this.alert("warning",t.AnEmailWillBeSentWhenAllStatisticsWillBeReadyToBeDownloaded)}.bind(this)});o.request(i)}.bind(this))}.bind(this))}.bind(this)}})),new r({trigger:"hover",target:this.getControl("exportButton").getContent(),position:"left"})),this.addControl("startDatePicker",new s({placeholder:t.SelectAStartDate,events:{onChange:this._onStartDateChange.bind(this)},min:this._community&&e?new Date(e.split("-")[0],e.split("-")[1]-1,e.split("-")[2]):d._tenantModel?u.convertDate(d._tenantModel.get("crdate")):m,max:i})).setDate(new Date(i.getFullYear(),i.getMonth()-1,i.getDate())),this.addControl("endDatePicker",new s({placeholder:t.SelectAnEndDate,events:{onChange:this._onEndDateChange.bind(this)},min:this.getControl("startDatePicker").getDate(),max:i})).setDate(new Date(i.getFullYear(),i.getMonth(),i.getDate())),[{tag:"div",styles:{display:"inline-block"},html:[{tag:"span",html:t.From},this.getControl("startDatePicker")]},{tag:"div",styles:{display:"inline-block"},html:[{tag:"span",html:t.To},this.getControl("endDatePicker")]},this.getControl("allButton"),this.getControl("exportButton")?{class:"export-stats-button-wrapper",html:this.getControl("exportButton")}:""]},setup:function(e){var t=this;return e&&(e.hasOwnProperty("tenant")&&(this._tenant=e.tenant),e.hasOwnProperty("community")&&e.community?this._community=e.community:d.getInstanceFetched(function(e){t._tenantModel=new m({id:e.get("tenant_uuid")}),t._tenantModel.fetch({onComplete:function(e){var i=t.getControl("startDatePicker");i&&i.setMinDate(u.convertDate(e.get("crdate")))}})})),this._parent.apply(this,arguments)},_onStartDateChange:function(){this.dispatchEvent("startDateChanged",this.getControl("startDatePicker").getDate()),this.getControl("endDatePicker")&&this.getControl("endDatePicker").setMinDate(this.getControl("startDatePicker").getDate())},_onEndDateChange:function(){this.dispatchEvent("endDateChanged",this.getControl("endDatePicker").getDate()),this.getControl("startDatePicker")&&this.getControl("startDatePicker").setMaxDate(this.getControl("endDatePicker").getDate())}})}),define("DS/SwymUIComponents/script/feature/community/community/view/community-request-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/utils/date","DS/WebappsUtils/Console","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-request-view"],function(e,t,i,n,o){"use strict";return t.extend({domEvents:{"click td":"_onCommunityRequestClicked"},_createContent:function(){var e=this.model,t=e.get("status"),n=this._parentView.name;if(e){if("community-request-collection-view"===n)return[{tag:"td",html:e.get("user_creator_request").first_name+" "+e.get("user_creator_request").last_name},{tag:"td",html:e.get("title")},{tag:"td",html:i.simpleDate(e.get("update"))},{tag:"td",html:e.get("community_id")?o.ConversationTransformation:o.CommunityCreation}];if("community-history-request-collection-view"===n){var s="3"===t?"bg-request-pending":"";return[{tag:"td",html:e.get("title"),class:s},{tag:"td",html:i.simpleDate(e.get("update")),class:s},{tag:"td",html:"0"===t?o.Declined:"1"===t||"4"===t?o.Created:"2"===t?o.UnderReview:o.NewUpdates,class:s},{tag:"td",html:"4"===t||e.get("community_id")&&"1"!==t?o.ConversationTransformation:o.CommunityCreation,class:s}]}}},_onCommunityRequestClicked:function(){this.dispatchEvent("onCommunityRequestClicked",[this.model,this])}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/internal-rich-link-processing-utils",["DS/SwymUICore/script/lib/request/data","DS/SwymUICore/script/utils/utils","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/edit/rich-link-preview/rich-link-preview-generator"],function(e,t,i){"use strict";return{getSearchData:function(n,o,s){var a,r;if(n.contains("#app"))r=n.match(/contentType=([^&]*)/i)[1],a=n.match(/contentId=([^&]*)/i)[1];else if(n.contains("post")){r="posts";let e=n.match(/post:([^/]{0,})/i);e||(e=n.match(/dt-post-(?:[^/]{0,}):([^/]{0,})/i)),a=e[1]}else if(n.contains("iquestion"))r="iquestion",a=n.match(/iquestion:([^/]{0,})/i)[1];else if(n.contains("idea")){r="idea";let e=n.match(/idea:([^/]{0,})/i);e||(e=n.match(/dt-idea-(?:[^/]{0,}):([^/]{0,})/i)),a=e[1]}else n.contains("wiki")?(r="wiki",a=n.match(/wiki:([^/]{0,})/i)[1]):n.contains("media")?(r="media",a=n.match(/media:([^/]{0,})/i)[1]):n.contains("survey")?(r="survey",a=n.match(/survey:([^/]{0,})/i)[1]):n.contains("wedo")&&(r="WeDo",a=n.match(/wedo:([^/]{0,})/i)[1]);e.request({url:t.getBaseUrl()+"/api/exalead/search?xrequestedwith=xmlhttprequest",data:{legacyFormat:!1,query:"#all",contentType:r,refineUsingQuery:'id:"'+a+'"',nresults:1,start:0},onComplete:function(e,t){var o;if(0!==e.nhits){var l,c,d,m,u,h,p,g,w,C=e.hits[0].metas,f={};"posts"===r?f.parent="POST":"idea"===r&&(f.parent="IDEATION");for(var y=0;y<C.length;y++){if("id"===C[y].name&&a!==C[y].value)return void require(["DS/UWPClientControls/PlatformNotify"],function(e){e.warn(i.previewcouldnotbegenerated)});"title"===C[y].name&&(l=C[y].value),"name"===C[y].name&&(c=C[y].value),"ds6w_58_community"===C[y].name&&(d=C[y].value),"enhanced_summary"===C[y].name&&(m=C[y].value.replace(/<[^>]+>/g," ")),"preview_url"===C[y].name&&(u=C[y].value),"preview_media_type"===C[y].name&&(w=C[y].value),"qna_answer_status"===C[y].name&&"ds6w:status.swym_validated"===C[y].value&&(g=!0),"hash_key"===C[y].name&&(h=C[y].value),"community_id"===C[y].name&&(p=C[y].value),"ds6w_58_kind"===C[y].name&&(f.label=C[y].value),"ds6w_58_typeId"===C[y].name&&(f.id=C[y].value),"ds6w_58_typeFontIcon"===C[y].name&&(f.icon=C[y].value),"ds6w_58_typeColor"===C[y].name&&(f.color=C[y].value),"survey"===r&&(m="Check out this survey"),void 0===u&&(u="null")}o||(o={type:r,title:l,description:m,image:u,tenantURL:n,communityName:d,communityID:p,authorName:c,authorID:h,answerValidated:g,mediaType:w},f.id&&(o.derived_type={...f}),s(o))}else o={type:"noAccess",title:i.previewcouldnotbegenerated},s(o)}})}}}),define("DS/SwymUIComponents/script/feature/core/ui-components/controls/wikitree-node",["UWA/Core","DS/Controls/TreeNodeBase"],function(e,t){"use strict";return t.implement({init(t){this._parent(t),this.options=e.extend(this.options,t),this._uuid=e.Utils.getUUID(),this._nodeDepth=-1,this._childrenSlots=[],this._children="array"===e.typeOf(this.options.children)?[]:null,this._childID=null,this._isExpanded=!1,this._isInTreeListView=!1,this._hasBeenAttached=!1,this._rowIndex=null,this._isInWriteMode=!1,this._updateViewTimeout=null,this._modeIsExpandAll=!1,this._modeIsMultiSel=!1,this.buildSkeleton(),this.options.isRoot&&this._attachToView()}})}),define("DS/SwymUIComponents/script/feature/community/content/view/label-in-title-mixin",["UWA/Core"],function(e){"use strict";return{_renderLabel:function(){return{tag:"strong",class:"idea-status-label",styles:{"background-color":this.model.getLabelColor()},text:this.model.getLabelTitle()}}}}),define("DS/SwymUIComponents/script/feature/core/user/view/badge-view",["UWA/Core","DS/UIKIT/Tooltip","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/utils/i18n","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/badge-view","DS/WebappsUtils/WebappsUtils"],function(e,t,i,n,o,s,a){return i.extend({name:"badge-view",_contentLevels:[0,10,20],_interactionLevels:[0,15,30],_badgesConfig:{nb_comment:{color:"#368EC4",secondColor:"#005686",iconCode:"&#xe082;",icon:"comment",type:"interaction"},nb_post:{color:"#d1d4d4",secondColor:"#77797C",iconCode:"&#xe055;",icon:"newspaper",type:"content"},nb_media:{color:"#9B2C98",secondColor:"#4E164D",iconCode:"&#xe009;",icon:"picture",type:"content"},nb_question:{color:"#EA4F37",secondColor:"#844138",iconCode:"&#xe019;",icon:"help",type:"content"},nb_ideation:{color:"#00B8DE",secondColor:"#0087A3",iconCode:"&#xe123;",icon:"lamp",type:"content"},nb_answer:{color:"#57B847",secondColor:"#477738",iconCode:"&#xe019;",icon:"help",type:"interaction"}},getConfigValue:function(e){return this._badgesConfig[this._attributeName][e]},_createContent:function(){var i=this.model;if(i){var n=parseInt(i.get(this._attributeName),10);svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg"),svgContainer.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");var r,l,c,d,m,u=12;switch(svgContainer.setAttribute("class","svg-badge"),svgContainer.setAttribute("width","64px"),svgContainer.setAttribute("height","55px"),svgContainer.setAttribute("xmlns","http://www.w3.org/2000/svg"),badgeShape=document.createElementNS("http://www.w3.org/2000/svg","path"),badgeShape.setAttribute("d",this._createBadgePath(64,55,9)),badgeShape.setAttribute("fill",this.getConfigValue("color")),badgeShape.setAttribute("stroke",this.getConfigValue("color")),badgeShape.setAttribute("stroke-linejoin","round"),badgeShape.setAttribute("stroke-width",9),svgContainer.appendChild(badgeShape),e.Utils.Client.Engine.ie||(icon=document.createElementNS("http://www.w3.org/2000/svg","text"),icon.setAttribute("x",32),icon.setAttribute("y",36.5),icon.setAttribute("font-size",28),icon.setAttribute("fill","white"),icon.setAttribute("class","fonticon"),icon.setAttribute("font-weight","bold"),icon.setAttribute("text-anchor","middle"),icon.innerHTML=this.getConfigValue("iconCode"),svgContainer.appendChild(icon)),n<("content"===this.getConfigValue("type")?this._contentLevels[2]:this._interactionLevels[2])?(52,39.25,n<("content"===this.getConfigValue("type")?this._contentLevels[1]:this._interactionLevels[1])?((d=document.createElementNS("http://www.w3.org/2000/svg","circle")).setAttribute("cx",52),d.setAttribute("cy",39.25),d.setAttribute("r",u),d.setAttribute("fill",this.getConfigValue("secondColor"))):((m=document.createElementNS("http://www.w3.org/2000/svg","polygon")).setAttribute("x",0),m.setAttribute("y",0),m.setAttribute("width",24),m.setAttribute("height",24),m.setAttribute("fill",this.getConfigValue("secondColor")),m.setAttribute("points","12,0 14.588,2.341 18,1.607 19.07,4.929 22.392,6 21.659,9.412 24,12 21.659,14.589 22.392,18 19.07,19.071 18,22.393 14.588,21.659 12,24 9.411,21.659 6,22.393 4.929,19.071 1.607,18 2.34,14.589 0,12 2.34,9.412 1.607,6 4.929,4.929  6,1.607 9.411,2.341"),r=40,l=27,(d=document.createElementNS("http://www.w3.org/2000/svg","svg")).setAttribute("x",r),d.setAttribute("y",l),d.setAttribute("width",24),d.setAttribute("height",24),d.appendChild(m)),badgeLevelValue=document.createElementNS("http://www.w3.org/2000/svg","text"),badgeLevelValue.setAttribute("x",52),badgeLevelValue.setAttribute("y",43.25),badgeLevelValue.setAttribute("font-size",12),badgeLevelValue.setAttribute("fill","white"),badgeLevelValue.setAttribute("font-weight","bold"),badgeLevelValue.setAttribute("text-anchor","middle"),badgeLevelValue.appendChild(document.createTextNode(n<10?n:"+9")),svgContainer.appendChild(d),svgContainer.appendChild(badgeLevelValue)):(r=39,l=23,(d=document.createElementNS("http://www.w3.org/2000/svg","image")).setAttribute("x",r),d.setAttribute("y",l),d.setAttribute("width",24),d.setAttribute("height",30),d.setAttribute("href",a.getWebappsBaseUrl()+"SwymSCI/assets/images/badge-gold.png"),svgContainer.appendChild(d)),this._attributeName){case"nb_comment":c=s.ToolTipComment;break;case"nb_post":c=s.ToolTipPost;break;case"nb_media":c=s.ToolTipMedia;break;case"nb_question":c=s.ToolTipQuestion;break;case"nb_answer":c=s.ToolTipAnswer;break;case"nb_ideation":c=s.ToolTipIdeation}return c=o.replace(c,{nickname:i.get("nickname"),number:i.get(this._attributeName)}),this.addControl("badgeTooltip",new t({target:this.getContent(),body:c,delay:{show:500}})),[e.extendElement(e.Utils.Client.Engine.ie?[{tag:"span",class:"badge-fonticon-for-ie fonticon fonticon-2x fonticon-"+this.getConfigValue("icon")},svgContainer]:svgContainer)]}},_createBadgePath:function(e,t,i){var n=function(e,t){return e+" "+t+" "},o="";return o+="M"+n(0+(i/=2),t/2),o+="L"+n(1*e/3-i/2,t-i),o+="L"+n(2*e/3+i/2,t-i),o+="L"+n(e-i,t/2),o+="L"+n(2*e/3+i/2,0+i),o+="L"+n(1*e/3-i/2,0+i),o+="Z"},setup:function(e){this._attributeName=e.attributeName,this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/core/stats/view/analytics-view",["UWA/Core","i18n!DS/SwymUICore/assets/nls/feature/core/stats/model/table-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/W3DXComponents/Views/GraphView","DS/SwymUICore/script/utils/date","DS/WebappsUtils/Console"],function(e,t,i,n,o,s){return i.extend({_modelEvents:{onRequest:"_onRequest",onSync:"unmask",onChange:"refresh",onError:"_onError"},_graph:null,_type:null,domEvents:{},_createContent:function(){if(this.model)return e.createElement("div",{class:"analytics",events:{resize:function(){this._graph&&this._graph.reflow()}.bind(this)}})},_onRequest:function(){this.model._attributes={},this.mask()},_onError:function(){var i=e.createElement("div",{html:t.NoDataToDisplay,styles:{"text-align":"center","line-height":"38px"}});this.container.children[0].setContent(i),this.unmask()},setup:function(e){this._parent.apply(this,arguments),this._type=this.model.getModelName()},onRender:function(){var i=this.model,o=this.getElement(".analytics");this.mask(),this._type===n.TYPE_TABLE&&o.setHTML(e.createElement("span",{html:t[i.getTitle()]}))},onRefresh:function(){var i,s=this.model,a=this.getElement(".analytics"),r=[],l=s.getAttributes();if(this._type===n.TYPE_PIE){for(i in l)l.hasOwnProperty(i)&&l[i]>0&&r.push([t[i],l[i]]);this._graph=new n({type:n.TYPE_PIE,series:[{data:r}],expertOpts:{title:{text:t[s.getTitle()],style:{color:"#333"}}}}).render().inject(a)}else if(this._type===n.TYPE_COLUMN){var c,d=[],m={};for(i in l)if(l.hasOwnProperty(i))for(c in l[i])m.hasOwnProperty(c)||(m[c]=0),m[c]+=l[i][c];for(i in l)if(l.hasOwnProperty(i))for(c in d[i]=[],l[i])l[i].hasOwnProperty(c)&&m.hasOwnProperty(c)&&(splitedDate=c.split("-"),d[i].push({x:Date.UTC(splitedDate[0],splitedDate[1]-1,splitedDate[2]),y:parseInt(s.get(i)[c]),percentage:parseInt(s.get(i)[c])/m[c]*100}));for(i in l)l.hasOwnProperty(i)&&r.push({name:t[i],data:d[i]});this._graph=new n({xAxis:{type:n.XAXIS_TYPE_DATETIME},type:n.TYPE_LINE,series:r,expertOpts:{title:{text:t[s.getTitle()],style:{color:"#333"}},plotOptions:{line:{marker:{enabled:1===r[0].data.length}},series:{turboThreshold:r[0].data.length>1e3?0:1e3}}}}).render().inject(a)}else if(this._type===n.TYPE_TABLE){for(i in l)l.hasOwnProperty(i)&&("Average answer time for iQuestions"===i?r.push([i.escapeHTML(),o.getAverageElapsedTime(s.get(i))]):r.push([i.escapeHTML(),l[i]]));a.setHTML(e.createElement("span",{html:t[s.getTitle()]})),r.forEach(function(e){e.length>1&&"object"==typeof e[1]&&(e[0]='<a data-content-type="person" class="link" data-login="'+e[1].login+'">'+e[0]+"</a>",e[1]=e[1].counter)}),this._graph=new n({type:n.TYPE_TABLE,series:[{data:r}]}).render().inject(a)}this.unmask()}})}),define("DS/SwymUIComponents/script/feature/core/ui-components/back-arrow-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/core/history/history-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/utils/navigation","i18n!DS/SwymUIComponents/assets/nls/feature/core/ui-components/back-arrow-view","i18n!DS/SwymUIComponents/assets/nls/topframe-init"],function(e,t,i,n,o,s,a,r,l,c){"use strict";return t.extend({name:"back-arrow-view",className:"unmaximize-button",_modelText:l.Home,_modelEvents:{"onChange:title":"_onTitleChange"},domEvents:{"click .arrow":"_onClick","click .back-arrow-heading":"_onClick"},_onClick:function(){var e=n.getInstance();this.navigateToPreviousContext(),e.dispatchEvent("onBack")},_getCurrentThreadFromMid:function(e){return new s({mid:e})},_getThreadLabel:function(e){return e.get("title")},_getCommunityPageNameFromContextPage:function(e){var t="";switch(e){case"blog":t=l.COMMUNITY_BLOG;break;case"media":t=l.COMMUNITY_MEDIA;break;case"ideas":t=l.COMMUNITY_IDEAS;break;case"questions":t=l.COMMUNITY_QUESTIONS;break;case"wiki":t=l.COMMUNITY_WIKI;break;case"members":t=l.COMMUNITY_MEMBERS;break;case"settings":t=l.COMMUNITY_SETTINGS;break;case"stats":t=l.COMMUNITY_STATS;break;case"mycontributions":t=l.COMMUNITY_MY_CONTRIBUTIONS;break;case"surveys":t=l.COMMUNITY_SURVEYS}return t},_onTitleChange:function(e){var t=n.getInstance(),i=o.getStateListing(),s=t.isInTemporaryState()?t.getData():i&&i.previousContext,a=s&&s.path,r=this._getCommunityPageNameFromContextPage(a?t.getCommunityPageContext(a):null);this._modelText=this._getThreadLabel(e)+(r?" - "+r:""),this.refresh()},_onContextChange:function(){var t,s,d,m=n.getInstance(),u=o.getStateListing(),h=m.isInTemporaryState()?m.getData():u&&u.previousContext,p=h&&h.path;this.isDestroyed()||(window.ds&&!0===window.ds.swymIM&&m.isCommunityContext()&&(!p&&!m.isContentContext()||m.extractContextInfoFromRoute(p).communityId||!m.isContentContext())?(d=this._getCurrentThreadFromMid(m.communityId,e.is(m.dmId)),this._modelText=this._getThreadLabel(d),this.setModel(d),this.updateView()):h?h.contentId&&h.contentType?(t=this,require([i.getModuleNameFromModelName(h.contentType)],function(e){t.model&&(d=new e({mid:h.contentId}),t._modelText=t.model.get("title")+(!0===h.editionMode?" - "+l.Edit:""),t.setModel(d),t.updateView())})):h.communityId&&!h.contentId?(s=this._getCommunityPageNameFromContextPage(h.path?m.getCommunityPageContext(h.path):null),d=this._getCurrentThreadFromMid(h.communityId,e.is(h.dmId)),this._modelText=this._getThreadLabel(d)+(s?" - "+s:""),this.setModel(d),this.updateView()):h.userHashKey?(d=new a({hash_key:h.userHashKey,login:h.userHashKey}),this._modelText=d.get("nickname"),this.setModel(d),this.updateView()):(this.model&&(this.stopListening(this.model),this.model=null),0===p.indexOf(r.SEARCH)?this._modelText=l.SEARCH+(h.query?" - "+decodeURI(h.query):""):0===p.indexOf(r.ADMIN_TENANT)?this._modelText=c.Manage:0===p.indexOf(r.MY_COMMUNITIES)?this._modelText=l.MY_COMMUNITIES:0===p.indexOf(r.DISCOVER_COMMUNITIES)?this._modelText=l.DISCOVER_COMMUNITIES:0===p.indexOf(r.MY_BOOKMARKS)&&m.path!==r.MY_BOOKMARKS?this._modelText=l.MY_BOOKMARKS:this._modelText=l.Home,this.updateView()):(this.model&&(this.stopListening(this.model),this.model=null),this._modelText=l.Home,this.updateView()))},updateView:function(){this.isRendered()?this.refresh():this.render()},_createRightButton:function(){return""},_createContent:function(){var t=e.createElement("span",{class:"arrow",html:{class:"fonticon fonticon-1-5x fonticon-left-open"}});return this.elements.lastContext=e.createElement("span",{class:"back-arrow-heading",html:this.options.backArrowText?[{tag:"span",class:"no-color-effect"},this.options.backArrowText]:[this._modelText]}),[t,this.elements.lastContext,this._createRightButton()]},init:function(){this._parent.apply(this,arguments),this._onContextChange=this._onContextChange.bind(this),n.getInstance().addListener("onContextChange",this._onContextChange,this,!0),n.getInstance().addListener("onTemporaryStateChange",this._onContextChange,this,!0)},navigateToPreviousContext:function(){var e=n.getInstance();e.isInTemporaryState()||!0===e.editionMode||o.backToListing()},destroy:function(){return n.getInstance().removeListener("onContextChange",this._onContextChange,this),n.getInstance().removeListener("onTemporaryStateChange",this._onContextChange,this),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/core/user/view/components/user-stars-edit-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/WebappsUtils/Console","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/components/user-stars-edit-view"],function(e,t,i,n){"use strict";return t.extend({_modelEventsForAutoRefresh:["onChange"],_labelNameInput:"",setup:function(t){return t=t||{},e.extend(this,t),this._parent.apply(this,arguments)},domEvents:{"click .result-option:nth-child(2)":"_clickOnFirstStar","click .result-option:nth-child(3)":"_clickOnSecondStar","click .result-option:nth-child(4)":"_clickOnThirdStar"},_clickOnFirstStar:function(e){var t=this.getControl("form-box-view");t&&!1!==e&&t.setValue("level","1")},_clickOnSecondStar:function(e){var t=this.getControl("form-box-view");t&&!1!==e&&t.setValue("level","2")},_clickOnThirdStar:function(e){var t=this.getControl("form-box-view");t&&!1!==e&&t.setValue("level","3")},_getLevelFromJSToDB:function(e){var t=parseInt(e);return 3===t&&t++,t},_createContentInputStars:function(){return"skill"===this.model._modelName?(this.labelLow=n.skillLow,this.labelMedium=n.skillMedium,this.labelHigh=n.skillHigh):"language"===this.model._modelName&&(this.labelLow=n.languageLow,this.labelMedium=n.languageMedium,this.labelHigh=n.LanguageHigh),{required:!0,type:"select",label:n.Evaluation,placeholder:"",name:"level",options:[{label:this.labelLow,value:"1",selected:1===this.model.getLevelFromDBToJS()},{label:this.labelMedium,value:"2",selected:2===this.model.getLevelFromDBToJS()},{label:this.labelHigh,value:"3",selected:3===this.model.getLevelFromDBToJS()}],template:{setOption:function(e,t){var i='<span class="fonticon fonticon-star active-blue fonticon-1-5x"></span>',n='<span class="fonticon fonticon-star unactive-blue fonticon-1-5x"></span>',o=i;t===this.labelLow?o+=n+n:t===this.labelMedium?o+=i+n:o+=i+i,o&&t.unescapeHTML().trim()?e.addContent({class:"select-evaluation-container",html:'<div class="option-evaluation">'+t+'</div class="fonticons-select-evaluation"><div>'+o+"</div>"}):e.setStyle("display","none")}.bind(this),getOption:function(e,t){if(e.hasClassName("select-evaluation-container"))return e.getParent(".result-option")}},custom:!0,events:{onChange:function(){var e=this.getControl("form-box-view");if(e){var t=e.getValue("level");this.model.addChanges("level",this._getLevelFromJSToDB(t)),"1"===t?this._clickOnFirstStar(!1):"2"===t?this._clickOnSecondStar(!1):this._clickOnThirdStar(!1)}}.bind(this)}}}})}),define("DS/SwymUIComponents/script/feature/core/ui-components/profile-element-container/profile-element-container-view",["UWA/Core","DS/SwymUICore/script/utils/i18n","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/UIKIT/Input/Button","DS/WebappsUtils/Console","DS/PubSub/PubSub"],function(e,t,i,n,o,s,a){"use strict";var r=i.extend({name:"profile-container",domEvents:{"click .header-profile-element .fonticon-plus":"_onClickAddIcon","click .icon-section .fonticon-pencil":"_onClickPencilIcon","click .icon-section .other-icon":"_otherIconAction","click .engaging-div":"_onClickEngagingDiv"},_onClickEngagingDiv:function(){this._collection?this._onClickAddIcon():this._onClickPencilIcon();var e=this.getControl("default-view");e&&e.hide()},_engagingUX:!1,_editAllActivated:!1,_userModel:null,_hasPencilIcon:!1,_hasPlusIcon:!1,_title:"",_mainView:null,_model:null,_collection:null,_hasBackground:!1,_otherIcon:null,_iconSection:null,_modelColor:null,_otherIconAction:function(){s.log("action to be performed on action to be clicked")}.bind(this),_defaultMessage:null,_checkEmptyAttributes:[],_additionElementInProgress:!1,_onClickPencilIcon:function(){this._showHeader(),this._hideIcon("pencil");var e=this.getControl("default-view");e&&e.hide();var t,i=this.getChildView("mainView");i&&((t=i.getChildView("edition-switch")).setMode("edit"),t.addEvent("onRead",function(){var e=this.getControl("default-view");!this._collection&&this._attributesAreEmpty()?(e&&e.show(),this._hideHeader()):(e&&e.hide(),this._showIcon("pencil"))}.bind(this)))},_onClickAddIcon:function(){if(this._showHeader(),!0!==this._additionElementInProgress||!0===this._editAllActivated){var e=new(0,this._collection.model)({}),t=this.getChildView("mainView");t&&(e.addEvents({onCancel:this._onAddElementPossible.bind(this),onSave:this._onAddElementPossible.bind(this)}),t.addEventOnce("onRefresh",function(){t.getModelViews()[0].getChildView("edition-switch").setMode("edit")}),this._collection.add(e,{at:0})),this._additionElementInProgress=!0,this._showIcon("plus"),!1===this._editAllActivated&&this._hideIcon("plus")}},_onAddElementPossible:function(){if(this._collection&&0===this._collection.length){var e=this.getControl("default-view");e&&e.show(),this._hideHeader()}else this._showIcon("plus");this._additionElementInProgress=!1},setup:function(t){return t=t||{},e.extend(this,t),!0===this._rendered&&this.refresh(),this._reactToEditAllEvent(),this._addListenersToCollection(),this._addListenerToView(),this._parent.apply(this,arguments)},_reactToEditAllEvent:function(){a.add("editAll",function(e){this.isRendered()&&(!0===e?(!0===this._hasPencilIcon&&this._onClickPencilIcon(),this._showIcon("plus"),this._editAllActivated=!0):!1===e&&(this._editAllActivated=!1))}.bind(this),null,!0)},_postRenderOrRefresh:function(){this._collection&&0===this._collection.length&&this._hideHeader(),!this._collection&&this._attributesAreEmpty()&&(this._hideIcon("pencil"),this._userModel.isCurrentUser()&&this._hideHeader())},_addListenerToView:function(){this.addEvent("onRender",this._postRenderOrRefresh),this.addEvent("onRefresh",this._postRenderOrRefresh)},_addListenersToCollection:function(){this._collection&&(this._collection.addEvent("onDestroy",function(e,t){if(t.length<=1){this._hideIcon("plus"),this._hideHeader();var i=this.getControl("default-view");i&&i.show()}}.bind(this)),this._collection.addEvent("onRemove",function(e,t){this._sendEventToUserCompletion(!1,t.length,e._modelName)}.bind(this)),this._collection.addEvent("onAdd",function(e,t){this._sendEventToUserCompletion(!0,t.length,e._modelName)}.bind(this)))},_sendEventToUserCompletion:function(e,t,i){var n=0,o=this._userModel.getCustomProperty("computedProfileCompletion");if(!0===e)switch(i){case"interest":case"language":case"experience":t<3&&(n=5);break;case"education":t<2&&(n=5);break;case"skill":t<4&&(n=10)}else switch(i){case"interest":case"language":case"experience":t<2&&(n=-5);break;case"education":t<1&&(n=-5);break;case"skill":t<3&&(n=-10)}this._userModel.dispatchEvent("usercompletionUpdate",o+n)},_createFonticonCodeOther:function(e){return'<span class="fonticon cursor-pointer other-icon fonticon-'+e+'"></span>'},_createFonticonCode:function(e,t){return'<span class="fonticon fonticon-1-5x cursor-pointer fonticon-'+e+'"'+(t?'style="display:none;"':"")+"></span>"},_createFonticonCodeForSection:function(e){return'<span  class="pull-left fonticon-section-profile fonticon fonticon-2x fonticon-'+e+'"></span>'},_showIcon:function(e){var t=this.getElement(".fonticon-"+e);t&&t.show()},_hideIcon:function(e){var t=this.getElement(".fonticon-"+e);t&&t.hide()},_hideHeader:function(){var e=this.getElement(".header-profile-element");e&&e.hide()},_showHeader:function(){var e=this.getElement(".header-profile-element");e&&e.show()},_createIconsAction:function(){var e="";return this._userModel.isCurrentUser()&&(!0===this._hasPlusIcon&&(e+=this._createFonticonCode("plus",!0)),!0===this._hasPencilIcon&&(this._checkEmptyAttributes.length>0&&!0!==this._userModel.isEditableByPassport(this._checkEmptyAttributes[0])&&"tenant_more_about_me"!==this._checkEmptyAttributes[0]||(e+=this._createFonticonCode("pencil"))),this._otherIcon&&(e+=this._createFonticonCodeOther(this._otherIcon))),e},_attributesAreEmpty:function(){for(var e=!1,t=0,i=this._checkEmptyAttributes.length;t<i;t++){var n=this._checkEmptyAttributes[t];if(null===this._model.get(n)||!/\S/.test(this._model.get(n))){e=!0;break}}return e},_createEmptyView:function(){var t="";if(this._defaultMessage){if(this._model.isCurrentUser())if(!0===this._engagingUX){var n=this,s=i.extend({_createContent:function(){return e.createElement("div",{class:"engaging-div",html:[{class:"engaging-message",html:[{tag:"span",class:"fonticon engaging-icon fonticon-4x fonticon-"+n._iconSection},{class:"engaging-text",html:[{class:"engaging-title profile-element-title",html:n._defaultMessage},{class:"engaging-content",html:n._engagingText}]},{class:"plus-container",html:'<span class="cursor-pointer fonticon fonticon-3x fonticon-plus"></span>'}]}]})}});t=this.addControl("default-view",new s)}else(t=this.addControl("default-view",new o({value:this._defaultMessage?this._defaultMessage:"",className:"block default default-message-profile",icon:this._iconSection?this._iconSection:"",events:{onClick:function(){this._collection?this._onClickAddIcon():this._onClickPencilIcon(),t.hide()}.bind(this),onShow:function(){this.container.addClassName("button-displayed")}.bind(this),onHide:function(){this.container.removeClassName("button-displayed")}.bind(this)}}))).show();else(this._collection&&0===this._collection.length||!this._collection&&this._attributesAreEmpty())&&this.hide();(this._collection&&0!==this._collection.length||!this._collection&&!this._attributesAreEmpty())&&t&&t.hide(),this._hideIcon("plus"),this._hideIcon("pencil")}return t},_createMainViewforCollection:function(){var e=null,t=this;return"string"==typeof this._mainView?(require([this._mainView],function(e){this._mainView=e,this.addChildView("mainView",{Class:n.extend({name:"profile-element-collection",modelViewClass:e,onInjected:function(){t._collection&&t._collection.length>0&&"edit"!==this.getModelViews()[0].getChildView("edition-switch").getMode()&&t._showIcon("plus")}}),collection:this._collection})}.bind(this)),e=this.addChildView("mainView",this.createDummyView())):e=this.addChildView("mainView",{Class:this._mainView,collection:this._collection}),e},_createContent:function(){return!0===this._hasBackground&&(this.container.className=this.container.className+" profile-background"),[{class:"header-profile-element",html:[{html:this._iconSection?this._createFonticonCodeForSection(this._iconSection):""},{html:this._title,class:"profile-element-title pull-left margin-bottom-20px"},{class:"icon-section",html:this._createIconsAction()}]},{class:"clearboth"},this._collection?this._createMainViewforCollection():this.addChildView("mainView",{Class:this._mainView,model:this._model}),this._createEmptyView()]}});return r.editAllMode=!1,r}),define("DS/SwymUIComponents/script/feature/community/content/edit/paragraph-formatter",["UWA/Core","UWA/Utils/Client","UWA/Event","DS/SwymUICore/script/lib/view/generic/swym-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/edit/paragraph-formatter"],(e,t,i,n,o)=>{let s=null;return n.extend({name:"paragraph-formatter-view",domEvents:{"click .paragraph-formatter-btn":"_onButtonClick"},className:"cke_ltr",defaultOptions:{extraEditor:null},_commandList:{bold:{command:"bold",type:"formatting"},italic:{command:"italic",type:"formatting"},underline:{command:"underline",type:"formatting"},strike:{command:"strike",type:"formatting"},highlight:{command:"highlight",type:"action"},removeFormat:{command:"removeFormat",type:"action"},"bulleted-list":{command:"bulletedlist",type:"formatting"},"numbered-list":{command:"numberedlist",type:"formatting"},blockquote:{command:"blockquote",type:"formatting"},outdent:{command:"outdent",type:"action"},indent:{command:"indent",type:"action"},table:{command:"customtable",type:"action"}},_styleList:{h1:"h1",h2:"h2",formatted:"pre"},setup(...e){const t=this._parent(...e);return"popover"===this.getOption("mode")?this.setOption("editorView",this.options.extraEditor.getOption("editorView")):"touch"===this.getOption("mode")?(this.listenTo(this.options.extraEditor,"onSelectionChange",e=>{this.options.extraEditor.setOption("editionTarget",e),this.refresh()}),this.setOption("editorView",this.options.extraEditor)):this.setOption("editorView",this.options.extraEditor),this.setOption("rteView",this.options.editorView.getRTEView()),t},_createContent(){let e,t=!1,i=!1,n=!1,s=!1,a=!1,r=!1,l=!1,c=!1,d=!1,m=!1,u=!1,h=!1;const{rteView:p}=this.options,g=p.ckeditor;return this.options.extraEditor.getOption("editionTarget")&&(t=(e=this.options.extraEditor.getOption("editionTarget")).match("h1")||e.getParent("h1"),i=e.match("h2")||e.getParent("h2"),n=e.match("ul")||e.getParent("ul"),s=e.match("ol")||e.getParent("ol"),a=e.match("blockquote")||e.getParent("blockquote"),r=e.match("pre")||e.getParent("pre"),l=e.match("table")||e.getParent("table"),c=e.match("strong")||e.getParent("strong"),d=e.match("em")||e.getParent("em"),m=e.match("u")||e.getParent("u"),u=e.match("s")||e.getParent("s"),h=e.match("span.marker")||e.getParent("span.marker"),g.selectionChange()),[{class:`paragraph-formatter-btn${t?" selected":""}`,"data-name":"h1",title:o.Heading1,html:{class:"fonticon fonticon-text-h1"}},{class:`paragraph-formatter-btn${i?" selected":""}`,"data-name":"h2",title:o.Heading2,html:{class:"fonticon fonticon-text-h2"}},{class:`paragraph-formatter-btn${n?" selected":""}`,"data-name":"bulleted-list",title:o.InsertRemoveBulletedList,html:{class:"fonticon fonticon-list"}},{class:`paragraph-formatter-btn${s?" selected":""}`,"data-name":"numbered-list",title:o.InsertRemoveNumberedList,html:{class:"fonticon fonticon-list-ordered"}},{class:`paragraph-formatter-btn${a?" selected":""}`,"data-name":"blockquote",title:o.BlockQuote,html:{class:"fonticon fonticon-text-quote"}},{class:`paragraph-formatter-btn${r?" selected":""}`,"data-name":"formatted",title:o.Formatted,html:{class:"fonticon fonticon-code"}},{class:"paragraph-formatter-btn","data-name":"outdent",title:o.DecreaseIndent,html:{class:"fonticon fonticon-indentation-decrease"}},{class:"paragraph-formatter-btn","data-name":"indent",title:o.IncreaseIndent,html:{class:"fonticon fonticon-indentation-increase "}},{class:`paragraph-formatter-btn${l?" selected":""}`,"data-name":"table",title:o.Table,html:{class:"fonticon fonticon-table"}},{class:`paragraph-formatter-btn${c?" selected":""}`,"data-name":"bold",title:o.Bold,html:{class:"fonticon fonticon-text-bold"}},{class:`paragraph-formatter-btn${d?" selected":""}`,"data-name":"italic",title:o.Italic,html:{class:"fonticon fonticon-text-italic"}},{class:`paragraph-formatter-btn${m?" selected":""}`,"data-name":"underline",title:o.Underline,html:{class:"fonticon fonticon-text-underline"}},{class:`paragraph-formatter-btn${u?" selected":""}`,"data-name":"strike",title:o.Strike,html:{class:"fonticon fonticon-text-strikethrough"}},{class:`paragraph-formatter-btn${h?" selected":""}`,"data-name":"highlight",title:o.Highlight,html:{class:"fonticon fonticon-highlighter"}},{class:"paragraph-formatter-btn","data-name":"removeFormat",title:o.RemoveFormat,html:{class:"fonticon fonticon-text-formatted-off"}}]},_applyStyle(i){if(this.options){let n;const o=this.container.getChildren(),{rteView:a}=this.options,r=a.ckeditor,l=i.getAttribute("data-name");let c=!1;const d={localName:"p"};this.haveParagraphCommandsBeenOverridden||(r.getCommand("bulletedlist").editorFocus=!1,r.getCommand("numberedlist").editorFocus=!1,r.getCommand("blockquote").editorFocus=!1,this.haveParagraphCommandsBeenOverridden=!0),(Object.hasOwnProperty.call(this._styleList,l)||Object.hasOwnProperty.call(this._commandList,l)&&"action"!==this._commandList[l].type)&&Object.keys(o).forEach(e=>{o[e].hasClassName("selected")&&(n=o[e].getAttribute("data-name"),l===n&&"table"!==n&&(c=!0),Object.hasOwnProperty.call(this._styleList,n)&&Object.hasOwnProperty.call(this._styleList,l)?(o[e].removeClassName("selected"),r.removeStyle(new s.style({element:this._styleList[n]})),a.updatePlaceHolderVisibility()):l===n&&Object.hasOwnProperty.call(this._commandList,l)&&"formatting"===this._commandList[n].type&&(o[e].removeClassName("selected"),r.execCommand(this._commandList[n].command)))}),!c&&e.is(l)?(Object.hasOwnProperty.call(this._styleList,l)?(r.applyStyle(new s.style({element:this._styleList[l]})),a.updatePlaceHolderVisibility(),t.Engine.ie&&r.focus(),d.localName=this._styleList[l]):Object.hasOwnProperty.call(this._commandList,l)&&(r.execCommand(this._commandList[l].command),"formatting"===this._commandList[l].type&&(d.localName=this._commandList[l].command)),-1===["indent","outdent"].indexOf(i.dataset.name)&&(i.toggleClassName("selected"),"popover"===this.getOption("mode")&&this.options.extraEditor.updateIcon(d))):"popover"===this.getOption("mode")&&this.options.extraEditor.updateIcon(d),setTimeout(()=>{this.dispatchEvent("onApplyStyle")},50)}},_onButtonClick(e){let t=i.getElement(e);t.hasClassName("paragraph-formatter-btn")||(t=t.getParent(".paragraph-formatter-btn"));const n=()=>{this._applyStyle(t),this.options.editorView&&this.options.editorView.dispatchEvent("onContentChange")};s?n():require(["DS/SwymUIComponents/script/lib/ckeditor/ckeditor"],e=>{s=e.CKEditor,n()})}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/rich-link-preview-utils",["UWA/Core"],function(e){"use strict";function t(e){return Boolean(e&&0===e.innerHTML.length)}function i(e){return Boolean(e&&"p"===e.tagName.toLowerCase())}function n(e){var n=e&&e.previousElementSibling,o=e&&e.nextElementSibling;i(n)&&t(n)&&n.remove(),i(o)&&t(o)&&o.remove()}return{convertURLPreviewToLink:function(t,i){var o,s,a,r,l,c,d,m,u=!1;!1===i?(s=e.createElement("div",{html:t}),u=!0):s=t;var h=0,p=s.getElements(".external-rich-link-preview"),g=s.getElements(".rich-link-embedded-preview"),w=s.getElements(".rich-link-internal-preview");for(o=0;o<p.length;o++)d=p[o],u&&n(d),h=0,l=null!=(l=d.getElement(".preview-thumbnail"))?d.getElement(".preview-thumbnail").src:"null",a=d.getElement(".preview-title").getText(),r=d.getElement(".preview-description").getText(),c=d.getElement(".preview-container").dataset.url,(l=l.replace(/^http:\/\//i,"https://")).contains("null")&&(l=null),null!=l&&d.getElement(".preview-thumbnail").hasClassName("preview-thumbnail-hidden")&&(h=1),d.getElement(".preview-description").hasClassName("preview-desc-is-hidden")&&(h=1===h?3:2),(m=document.createElement("a")).className="preview-link",m.href=c,m.setAttribute("data-title",a),m.setAttribute("data-uri",c),m.setAttribute("data-desc",r),m.setAttribute("data-img",l),m.setAttribute("data-prefs",h),m.innerHTML="&nbsp;",d.outerHTML=m.outerHTML;for(o=0;o<g.length;o++){var C=g[o];u&&n(C),l="",a="",h="",r="embedded-youtube-video",c=C.children[0].dataset.url,(m=document.createElement("a")).className="preview-link",m.href=c,m.setAttribute("data-uri",c),m.innerHTML="&nbsp;",C.outerHTML=m.outerHTML}for(o=0;o<w.length;o++){var f=w[o];u&&n(f),l="",a="",h=0,r="internal-content",c=f.children[0].dataset.url,f.getElement(".preview-thumbnail")&&f.getElement(".preview-thumbnail").hasClassName("preview-thumbnail-hidden")&&(h=1),f.getElement(".preview-description")&&f.getElement(".preview-description").hasClassName("preview-desc-is-hidden")&&(h=1===h?3:2),(m=document.createElement("a")).className="preview-link",m.href=c,m.setAttribute("data-title","&nbsp;"),m.setAttribute("data-uri",c),m.setAttribute("data-desc","&nbsp;"),m.setAttribute("data-img","&nbsp;"),m.setAttribute("data-prefs",h),m.innerHTML="&nbsp;",f.outerHTML=m.outerHTML}return!1===i?s.innerHTML:s},containsPreview:function(e){if(e instanceof HTMLElement)return Boolean(e.getElement(".rich-link-preview"));throw new Error("Only an HTMLElement is accepted")},containsYoutubePreview:function(e){if(e instanceof HTMLElement)return Boolean(e.getElement(".rich-link-embedded-preview"));throw new Error("Only an HTMLElement is accepted")},containsExternalURLPreview:function(e){if(e instanceof HTMLElement)return Boolean(e.getElement(".external-rich-link-preview"));throw new Error("Only an HTMLElement is accepted")},containsInternalURLPreview:function(e){if(e instanceof HTMLElement)return Boolean(e.getElement(".rich-link-internal-preview"));throw new Error("Only an HTMLElement is accepted")},containsURLPreview:function(e){if(e instanceof HTMLElement)return Boolean(this.containsExternalURLPreview(e)||this.containsInternalURLPreview(e));throw new Error("Only an HTMLElement is accepted")},extractLinkData:function(e){var t,i,n,o=e.dataset.title,s=e.dataset.desc,a=e.dataset.img,r=e.href,l=e.dataset.prefs,c=r.match(/http[s]?:\/\/(www[0-9]?\.)?(.[^/:]+)/i);return null!=c&&c.length>2&&"string"==typeof c[2]&&c[2].length>0?(n="youtube.com"===c[2]?"youtube":"html",i=c[2],t=c[0]):(i=null,t=null),{type:n,title:o,description:s,image:a,url:r,domain:t,domainToDisplay:i,prefs:l}}}}),define("DS/SwymUIComponents/script/feature/community/content/social-interactions/social-features-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/post/model/post-model","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/community/iquestion/model/iquestion-model","DS/SwymUICore/script/feature/community/idea/model/idea-model","DS/SwymUICore/script/feature/community/wiki/model/wiki-model","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/community/instant-message/model/instant-message-model","DS/SwymUICore/script/feature/community/instant-comment/model/instant-comment-model","DS/SwymUICore/script/feature/community/wedo/model/wedo-model"],function(e,t,i,n,o,s,a,r,l,c,d){"use strict";return t.extend({defaultOptions:{actionBar:!0,actionBarViewClass:"DS/SwymUIComponents/script/feature/community/content/social-interactions/action-bar-view",actionBarViewOptions:null,comments:!0,commentsViewClass:"DS/SwymUIComponents/script/feature/community/content/social-interactions/comment-collection-view",mainCollectionViewName:"comments",commentsNumberAtInit:void 0},name:"social-features-view",setup:function(e){var t=e.widget||e._widget||window.widget;if(!t)throw new Error("No widget instance provided");this._widget=t,this._parent.apply(this,arguments),!0===this.getOption("actionBar")&&this._createActionBar(),!0===this.getOption("comments")&&this._createComments()},_createComments:function(){var e=this.model.getComments();e.isBeingFetched()||e.hasBeenFetched()||((!this.model.hasBeenFetched()&&r.getInstance().isContentContext()||parseInt(this.model.get("nb_comments"),10)>0||!0===this.getOption("forceCommentFetchIfNotDoneYet"))&&e.fetch({}),e.setAssociated("commented",this.model)),this.addChildView(this.getOption("mainCollectionViewName"),{collection:e,Class:this.getOption("commentsViewClass"),modelName:this.model.getModelName(),model:this.model,modelViewsToDisplay:this.getOption("commentsNumberAtInit")})},_createActionBar:function(){var t=this,i=this.getOption("actionBarViewOptions")||{},n={onCommentCreatorFocusRequest:n=function(){var e=t.getChildView(t.getOption("mainCollectionViewName"));e&&e.focusOnCommentCreator(),t.dispatchEvent("onCommentCreatorFocusRequest")},onActionBarRendered:function(){t.dispatchEvent("onActionBarRendered")}};e.extend(i,{enableLike:!1,enableShare:!1}),i.events=i.events||{},e.extend(i.events,n),this.addChildView("actionBar",e.extend({model:this.model,Class:this.getOption("actionBarViewClass"),modelName:this.model.getModelName(),widget:this._widget,isCompactView:!!this.getOption("isCompactView"),events:n},i))},_createContent:function(){var e=this.getChildView("actionBar"),t=this.getChildView(this.getOption("mainCollectionViewName"));return[e||"",t||""]}})}),define("DS/SwymUIComponents/script/feature/community/content/view/content-list-mobile-mixin",["UWA/Core","DS/SwymUICore/script/feature/core/mobile/app-foreground-subscriber-mixin","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/core/context/context-constants","DS/SwymUICore/script/constants/community-constants"],function(e,t,i,n,o){"use strict";return e.extend({setup:function(){var e=i.getInstance();return this.threadChangeListenerForMobileApp&&!this.threadChangeListenerForMobileAppBound&&(this.threadChangeListenerForMobileAppBound=this.threadChangeListenerForMobileApp.bind(this),e.addListener("onThreadChange",this.threadChangeListenerForMobileAppBound,this,!0)),this._previous.apply(this,arguments)},threadChangeListenerForMobileApp:function(){var e=i.getInstance();!this.isDestroyed()&&e.isCommunityContext()&&e.getPreviousPath()===n.HOME&&this.isVisible()&&this.isInContextToBeRefreshed()&&this.refreshList()},onAppBroughtToForeground:function(){this.isInContextToBeRefreshed()&&this.refreshList()},isInContextToBeRefreshed:function(){var e=i.getInstance(),t=e.feedMode,n=e.isFilterableContentListsContext()&&t===o.CTY_CONTENT_LIST_MODE.WHATSNEW_MODE||e.isHomePageContext(),s=this.container.getClosest(".center-section"),a=e.isInTemporaryState();return!(!n||!s||a)},refreshList:function(){this.updateCollection({collectionClass:this.options.collectionClass})},destroy:function(){var e=i.getInstance();return this.threadChangeListenerForMobileAppBound&&e.removeListener("onThreadChange",this.threadChangeListenerForMobileAppBound),this._previous.apply(this,arguments)}},t)}),define("DS/SwymUIComponents/script/feature/community/media/view/document-office-viewer",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/UIKIT/Spinner","DS/OfficeDocumentEditorClient/Editor","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/utils/usage-tracker","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/Logger/Logger","i18n!DS/SwymUIComponents/assets/nls/lib/OfficeDocumentEditor/officeDocumentEditor"],function(e,t,i,n,o,s,a,r,l){"use strict";return t.extend({name:"document-office-viewer",on3DPlayerReadyBound:null,init:function(e){return e.annotationsEventBus&&(this.annotationsEventBus=e.annotationsEventBus,this.annotationsEventBus.addEvent("onLoadAnnotationRequest",this.onLoadAnnotationRequestCallback,this)),e.editorStateEventBus&&(this.editorStateEventBus=e.editorStateEventBus,this.editorStateEventBus.addEvent("onEditorIsModifiedStateRequest",this.onEditorIsModifiedStateRequestCallback,this)),this._parent.apply(this,arguments)},setup:function(){return"edit"===this.getOption("viewMode")?(this.addEvent("onPublishing",this.onPublishCallback),s.trackPageEvent({category:"Collaboration",label:"editOfficeDocumentInODE",view:"document-office-viewer",event:"click",contentType:this.model.getFileExtension()})):s.trackPageEvent({category:"Collaboration",label:"readOfficeDocumentInODE",view:"document-office-viewer",event:"click",contentType:this.model.getFileExtension()}),this.on3DPlayerReadyBound=this._on3DPlayerReady.bind(this),this._parent.apply(this,arguments)},_getDownloadUrl:function(){if(!this._downloadUrl&&this.model){var e=this.model.get("play");this._downloadUrl=e&&e.download_original_url&&e.download_original_url.transient_url_as_attachment}return this._downloadUrl||""},_toggleFullscreen:function(){this.container.getElement("#ode-fullscreen").toggleClassName("fonticon fonticon-resize-full fonticon-2x"),this.container.getElement("#ode-fullscreen").toggleClassName("fonticon fonticon-resize-small fonticon-2x"),this.container.toggleClassName("fullscreen"),this.container.hasClassName("fullscreen")?this._onFullScreenActivate():this._onFullScreenDeactivate()},_onFullScreenActivate:function(){var e=this.container.getClosest(".center-section-view-container .scroller-root");e&&(this.scrollViewElOriginalStyle=e.getStyle("transform"),e.setStyle("transform","none"));var t=this.container.getClosest(".center-section-view-container .scroller-content");t&&(this.scrollContentElOriginalStyle=t.getAttribute("style"),t.setAttribute("style","-webkit-overflow-scrolling:auto !important"));var i=this.container.getClosest(".content-overlay-view-container");i&&(this._contentOverlaViewContainerOriginalHeight=i.getStyle("height"),i.setStyle("height","auto"))},onPublishCallback:function(t,i){var s=this,a=e.extend({community_id:this.model.get("community").id,id_media:this.model.get("mid")});n.save({callbackUrl:o.getBaseUrl()+"/api/media/editmedia",params:a,headers:{"X-DS-SWYM-CSRFTOKEN":"ode:{csrfToken}"},filenameForUpload:"userFile",firstCallUrl:o.getBaseUrl()+"/api/session/info"}).then(function(e){e&&200===e.endpoint_status_code?s.model.save(t,i):(i.onFailure&&i.onFailure(),r.error("Error in ODE save callback"),s.alert("error",l.unknownError))},function(e){switch(i.onFailure&&i.onFailure(),e){case n.ERROR.NO_DOCUMENT_Url_PROVIDED:s.alert("error",l.noDocumentUrlProvided);break;case n.ERROR.SERVICE_NOT_FOUND:s.alert("error",l.serviceNotFound);break;default:s.alert("error",l.unknownError)}})},_onFullScreenDeactivate:function(){var e=this.container.getClosest(".center-section-view-container .scroller-root");e&&e.setStyle("transform",this.scrollViewElOriginalStyle);var t=this.container.getClosest(".center-section-view-container .scroller-content");t&&t.setAttribute("style",this.scrollContentElOriginalStyle);var i=this.container.getClosest(".content-overlay-view-container");i&&this._contentOverlaViewContainerOriginalHeight&&i.setStyle("height",this._contentOverlaViewContainerOriginalHeight)},_getWidgetParam:function(){return this._widget?this._widget:""},_onAnnotationShared:function(e){var t=e.screenshot,i=e.annotation,n=this.model.get("subject6wuri");this.annotationsEventBus&&n&&this.annotationsEventBus.dispatchEvent("onAnnotationShared",{annotation:{type:"annotation",file:t,data:{annotationFile:i},relatedMediaUri:n}})},_on3DPlayerReady:function(){this._playerObj3DPlay&&this.loadedAnnotation&&setTimeout(()=>{this.loadAnnotation(this.loadedAnnotation),delete this.loadedAnnotation},1e3)},_set3DPlayInstance:function(e){this._playerObj3DPlay=e},_dispose3DPlayInstance:function(){this._playerObj3DPlay.dispose()},loadAnnotation:function(e){var t=this._playerObj3DPlay;if(t){var i={};e&&"annotation"===e.type&&e.data&&e.data.annotationFile&&(i.annotation=e.data.annotationFile,t.loadAnnotations&&t.isReady&&t.isReady()&&t.loadAnnotations(i,{clean:!0}))}},onRedraw:function(){var t=this;this._playerObj3DPlay&&this._dispose3DPlayInstance(),n&&("edit"!==this.getOption("viewMode")&&e.extendElement(window.top.document).addEvent("3DPLAYREADY",this.on3DPlayerReadyBound),n.init({docKeyToUse:`3dswym_${this.model.get("mid")}`,title:this.model.get("orig_name"),ext:this.model.getFileExtension(),url:this._getDownloadUrl(),platformId:a.getInstance().get("config").tenant.online_instance_id,readOnly:"edit"!==this.getOption("viewMode"),useIframe:!0,rootElem:this.container.getElement(".ode-viewer"),playerConfig:{widget:this._getWidgetParam(),options:{callback:{onAnnotationShared:t._onAnnotationShared.bind(t)}}},on3DPlayerReady:t._set3DPlayInstance.bind(t)}).then(function(e){t.dispatchEvent("mediaViewReady",t)},function(e){switch(e){case n.ERROR.NO_DOCUMENT_URL_PROVIDED:t.alert("error",l.noDocumentUrlProvided);break;case n.ERROR.SERVICE_NOT_FOUND:t.alert("error",l.serviceNotFound);break;default:t.alert("error",l.unknownError)}}))},onHide:function(){this._playerObj3DPlay&&this._dispose3DPlayInstance()},destroy:function(){return this._playerObj3DPlay&&this._dispose3DPlayInstance(),this._parent.apply(this,arguments)},_createContent:function(){var e=this.model;return this.container&&this.container.empty(),void 0!==e.get("preview")?{tag:"div",class:"ode-viewer"}:{styles:{"text-align":"center",height:"40px",margin:"10px"},html:new i({className:"msg-animation",visible:!0,animate:!0,spin:!0})}},onLoadAnnotationRequestCallback:function(e){this._playerObj3DPlay&&this._playerObj3DPlay.isReady()?this.loadAnnotation(e):this.loadedAnnotation=e},onEditorIsModifiedStateRequestCallback:function(){n.state().then(e=>{this.editorStateEventBus.dispatchEvent("onEditorIsModifiedStateResponse",[e&&e.is_modified])},()=>{this.editorStateEventBus.dispatchEvent("onEditorIsModifiedStateResponse",[!1])})},onDestroy:function(){if(this.annotationsEventBus&&this.annotationsEventBus.removeEvent("onLoadAnnotationRequest",this.onLoadAnnotationRequestCallback,this),this.editorStateEventBus&&this.editorStateEventBus.removeEvent("onEditorIsModifiedStateRequest",this.onEditorIsModifiedStateRequestCallback,this),this.on3DPlayerReadyBound)try{e.extendElement(window.top.document).removeEvent("3DPLAYREADY",this.on3DPlayerReadyBound)}catch(e){r.error(e)}return n.close(),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/core/user/view/summary/user-summary-read-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/user/model/user-model","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/user-summary-view","DS/WebappsUtils/Console"],function(e,t,i,n,o){"use strict";return t.extend({_modelEventsForAutoRefresh:["onChange:tenant_more_about_me"],_modelClass:i,name:"user-summary-read-view",setup:function(e){return e=e||{},this._parent.apply(this,arguments)},_createContent:function(){var t=this.model.get("tenant_more_about_me",{breakline:!0});return e.createElement("div",{html:t})}})}),define("DS/SwymUIComponents/script/feature/core/ui-components/top-back-arrow-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/core/history/history-model","DS/UIKIT/SuperModal","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/edit/content-creation-view","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","DS/SwymUICore/script/feature/core/user/model/currentuser-model"],function(e,t,i,n,o,s,a,r,l,c){"use strict";return t.extend({name:"top-back-arrow-view",className:"maximized community-header-view",domEvents:{"click .back-header-wrapper":"_onClick","click .close-header-button":"_onClick"},setup:function(){this._parent.apply(this,arguments),this._context=i.getInstance(),this._onContextChange=this._onContextChange.bind(this),this._context.addListener("onContextChange",this._onContextChange,this,!0),this._context.addListener("onTemporaryStateChange",this._onContextChange,this,!0)},_onClick:function(){var e=this._context.getRoute();["storycreation","sketchcreation","whiteboardcreation"].includes(e)?new o({closable:!1}).confirm({className:"sywm-confirmation-modal",title:s.Cancel,message:s.AreYouSure,callback:function(e){!0===e&&n.backToListing()}.bind(this)}):n.backToListing()},_getCurrentThreadFromMid:function(e,t){return t?new l({mid:e}):new a({mid:e})},_getThreadLabel:function(e){return e.get("title")},_onContextChange:function(){var t,i=this._context,n=i.previousAttributes,o=n&&n.path;if(!this.isDestroyed()){if(n&&n.communityId&&!n.contentId)if(e.is(n.dmId)){if(t=this._getCurrentThreadFromMid(n.communityId,!0)){var a=t.get("topic");if(a)this._modelText=a;else{var l=t.get("users"),d="";if(c.getInstanceFetched(function(e){d=e.get("login")}),l){var m=l.filter(e=>e.login!=d).map(e=>e.first_name+" "+e.last_name);this._modelText=m.join(", ")}}}}else t=this._getCurrentThreadFromMid(n.communityId),this._modelText=this._getThreadLabel(t);else 0===o.indexOf(r.MY_BOOKMARKS)&&i.path!==r.MY_BOOKMARKS?this._modelText=s.MY_BOOKMARKS:this._modelText=s.Home;this.refresh()}},_createContent:function(){var t=e.createElement("div",{class:"fonticon fonticon-2x fonticon-left-open back-header-button"}),i=e.createElement("div",{class:"fonticon fonticon-1-5x fonticon-close close-header-button"});return[{class:"back-header-wrapper",html:[t,{class:"basic-information",html:[{class:"title",html:this.options.backArrowText?[{tag:"span",class:"no-color-effect"},this.options.backArrowText]:[this._modelText]}]}]},i]},destroy:function(){return i.getInstance().removeListener("onContextChange",this._onContextChange),i.getInstance().removeListener("onTemporaryStateChange",this._onContextChange),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/abstract-content-editor-body-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view"],function(e,t){"use strict";return t.extend({_communityId:null,setCommunityId:function(e){this.setOption("communityId",e),this.onCommunityIdChange()},getCommunityId:function(){return this.getOption("communityId")},_createContent:function(){return{}},contentChanged:function(){this.dispatchEvent("onContentChange")},getContentAttributes:function(){},isContentEmpty:function(){},resetContent:function(){},_getDndView:function(){},refreshDragDetection:function(){},stopDragDetection:function(){},resetEditorViews:function(){},clearUndoTextInEditor:function(){},onExitingMode:function(){},onEnteringMode:function(){},refreshContent:function(){},getMediaCollectionLength:function(){},getMediaCollection:function(){},uploadMedia:function(){},onCommunityIdChange:function(){},addMedia:function(){},validateContent:function(){var e=!0;return this.isContentEmpty()&&(e=!1),e}})}),define("DS/SwymUIComponents/script/feature/community/media/edit/upload/drag-and-drop-upload-view",["UWA/Core","UWA/Event","UWA/Utils/Client","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/feature/community/media/model/media-model","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/edit/upload/drag-and-drop-upload-view","DS/Logger/Logger"],function(e,t,i,n,o,s,a){"use strict";return n.extend({name:"drag-n-drop-upload",_dragZoneCounter:0,_dropZoneCounter:0,_rteContainer:null,defaultOptions:{multipleFileUpload:!0},domEvents:{"dragover .drop-zone":"_onDropZoneOver","dragenter .drop-zone":"_onDropZoneEnter","dragleave .drop-zone":"_onDropZoneLeave","drop .drop-zone":"_onDropZoneDrop"},init:function(){return this._onDragZoneEnterBound=this._onDragZoneEnter.bind(this),this._onDragZoneOverBound=this._onDragZoneOver.bind(this),this._onDragZoneLeaveBound=this._onDragZoneLeave.bind(this),this._onDragZoneDropBound=this._onDragZoneDrop.bind(this),this._parent.apply(this,arguments)},setup:function(){this._parent.apply(this,arguments)},_createContent:function(){return{tag:"div",class:"drop-zone",html:{tag:"div",class:"drop-zone-text",html:s.DropHere}}},_draggedFile:function(e){var t,i,n=(e.event||e).dataTransfer.types,o=!0;if(n)for(o=!1,t=0,i=n.length;t<i;t++)if("Files"===n[t]||"text/plain"===n[t]||"Text"===n[t]){o=!0;break}return o},_draggedContentFromDragZone:function(i){var n=e.extendElement(t.getElement(i));return n.match(".being-dragged")||n.getParent(".being-dragged")},_isCursorTraversingDragDetectionZoneBorders:function(t,n){var o,s,a=t.relatedTarget;return a?!n.contains(a)&&n!==a:(o=e.extendElement(document.body).getSize(),s=n.getBoundingClientRect(),i.Engine.ie||t.clientX>=o.width||t.clientX<=0||t.clientY>=o.height||t.clientY<=0||s.top<=0||s.left<=0||s.right>=Math.floor(o.width)||s.bottom>=Math.floor(o.height))},_onDragZoneDragStart:function(){e.extendElement(this).addClassName("being-dragged")},_onDragZoneEnter:function(e){var t,i=e.event||e;if(i.stopPropagation&&i.stopPropagation(),!this._draggedContentFromDragZone(i)&&(i.preventDefault&&i.preventDefault(),this._draggedFile(e))){if(t=this.getOption("dragDetectionZone"),0===this._dragZoneCounter){if(!this._rteContainer&&this._parentView._parentView){let e=this._parentView._parentView.container;this._rteContainer=e.getChildren()[0]}this.container.addClassName("show-drop-zone"),this._rteContainer&&this._rteContainer.addClassName("show-drop-zone")}(this._isCursorTraversingDragDetectionZoneBorders(i,t)||0===this._dragZoneCounter)&&(a.log("====== dragenter ========",t),this._dragZoneCounter++)}},_onDragZoneLeave:function(e){var t,i=e.event||e;this._draggedContentFromDragZone(i)||(t=this.getOption("dragDetectionZone"),i.preventDefault&&i.preventDefault(),this._isCursorTraversingDragDetectionZoneBorders(i,t)&&(a.log("====== dragleave ========",t),this._dragZoneCounter--),this._dragZoneCounter<=0&&(this.container.removeClassName("show-drop-zone"),this._rteContainer&&this._rteContainer.removeClassName("show-drop-zone"),this._dragZoneCounter=0))},_onDragZoneOver:function(e){var t=e.event||e;if(t.stopPropagation&&t.stopPropagation(),!this._draggedContentFromDragZone(t))return t.preventDefault&&t.preventDefault(),t.dataTransfer.dropEffect="none",!1},_onDragZoneDragEnd:function(t){e.extendElement(this).removeClassName("being-dragged")},_onDragZoneDrop:function(e){var t=e.event||e,i=!0,n=t.dataTransfer.files,s={};try{s=JSON.parse(t.dataTransfer.getData("text")||"{}")}catch(t){console.log("we are probably in firefox, in DND scenario inside embedded media--\x3e  fail silently")}if(!this._draggedContentFromDragZone(t))if(this._dragZoneCounter=0,this.container.hasClassName("show-drop-zone")&&(this.container.removeClassName("show-drop-zone"),this._rteContainer&&this._rteContainer.removeClassName("show-drop-zone"),t.preventDefault(),i=!1),0===n.length&&"3DXContent"===s.protocol){var a=s.data&&s.data.items;n=[];a.forEach(function(e){"text/directory"!==e.objectType&&n.push(new o(e))}),this.dispatchEvent("on3DDriveMediaSelected",[n])}else this.dispatchEvent("onFilesSelected",[n]);return i},_onDropZoneEnter:function(e){var t=e.event||e;this._draggedContentFromDragZone(t)||(t.preventDefault&&t.preventDefault(),0===this._dropZoneCounter&&this.container.addClassName("highlight-drop-zone"),this._dropZoneCounter++)},_onDropZoneLeave:function(e){var t=e.event||e;this._draggedContentFromDragZone(t)||(t.preventDefault&&t.preventDefault(),this._dropZoneCounter--,this._dropZoneCounter<=0&&this.container.removeClassName("highlight-drop-zone"))},_onDropZoneOver:function(e){var t=e.event||e;if(t.stopPropagation&&t.stopPropagation(),!this._draggedContentFromDragZone(t))return t.preventDefault&&t.preventDefault(),t.dataTransfer.dropEffect="copy",!1},_onDropZoneDrop:function(e){var t=e.event||e;t.dataTransfer.files;this._draggedContentFromDragZone(t)||(this._dropZoneCounter=0,this.container.hasClassName("highlight-drop-zone")&&this.container.removeClassName("highlight-drop-zone"))},addDragDetectionZone:function(e){e&&e instanceof HTMLElement&&this.getOption("dragDetectionZone")!==e&&(this.setOption("dragDetectionZone",e),e.addEvents({dragstart:this._onDragZoneDragStart,dragenter:this._onDragZoneEnterBound,dragover:this._onDragZoneOverBound,dragleave:this._onDragZoneLeaveBound,dragend:this._onDragZoneDragEnd,drop:this._onDragZoneDropBound}))},removeDragDetectionZone:function(){var e=this.getOption("dragDetectionZone");e&&(e.removeEvents({dragstart:this._onDragZoneDragStart,dragenter:this._onDragZoneEnterBound,dragover:this._onDragZoneOverBound,dragleave:this._onDragZoneLeaveBound,dragend:this._onDragZoneDragEnd,drop:this._onDragZoneDropBound}),this.setOption("dragDetectionZone",void 0))},onDestroy:function(){var e;(e=this.getOption("dragDetectionZone"))&&e instanceof HTMLElement&&(e.removeEvents({dragstart:this._onDragZoneDragStart,dragenter:this._onDragZoneEnterBound,dragover:this._onDragZoneOverBound,dragleave:this._onDragZoneLeaveBound,dragend:this._onDragZoneDragEnd,drop:this._onDragZoneDropBound}),this.setOption("dragDetectionZone",null))}})}),define("DS/SwymUIComponents/script/feature/core/search/view/bot-search-factory",["UWA/Core","UWA/Class","DS/UIKIT/Autocomplete","DS/SwymUICore/script/feature/core/command/commands-controller","i18n!DS/SwymUIComponents/assets/nls/feature/core/search/view/user-search-view","DS/WebappsUtils/Console","UWA/Class/Promise"],function(e,t,i,n,o,s,a){"use strict";return{Factory:t.extend({_defaultValue:null,_label:"",_events:{},_disabled:!1,_getConfiguration:function(){return{filterEngine:function(e,t){return t},templateEngine:function(t,i,n){var o=e.createElement("div",{html:[{class:"bot-search-result-container",html:[{tag:"img",src:n.appIconURL},{class:"bot-search-second-column",html:[{class:"app-title",html:n.label},{class:"bot-description",html:n.desc}]}]}]});t.addClassName("default-template bot-search-template"),t.setHTML(o.getHTML())},remoteSearchEngine:function(e,t,i){var o={};return t=t?t.toLowerCase():"",new a(function(i){o.dataset=e,o.matchingItems=[],n._getCommands(function(e,s){n.executeWhenNlsIsReady(function(){s.forEach(function(e){var i=n.getNlsValue(e.appId,e.desc);(e.appName.toLowerCase().indexOf(t)>-1||i&&i.toLowerCase().indexOf(t)>-1)&&o.matchingItems.push({label:e.appName,value:e.botUsername||e.appName,desc:i,appIconURL:e.appIconURL})}),i(o)})})})}}},_setupConfig:function(t){t&&(e.is(t.label)&&(this._label=t.label),e.is(t.defaultValue)&&(this._defaultValue=t.defaultValue),e.is(t.events)&&(this._events=t.events),e.is(t.disabled)&&(this._disabled=t.disabled))},_getEvents:function(){var e=this,t=e._events,i=t.onSelect,n=t.onUnselect,o=t.onInjected;t.onFocus;return t.onInjected=function(){e._defaultValue&&!0!==e.injected&&(e.configuration.remoteSearchEngine(e,e._defaultValue,function(t){t&&t.hasOwnProperty(0)?this.onSelect(t[0]):this.dispatchEvent("onNoResults",e,e._defaultValue)}.bind(this)),e.injected=!0),o&&o.apply(this,arguments)},t.onSelect=function(){this.onClickOutside(),i&&i.apply(this,arguments)},t.onUnselect=function(){n&&n.apply(this,arguments)},t},_getAutocompleteOptions:function(){return this.configuration=this._getConfiguration(),{required:!0,datasets:[{configuration:this.configuration}],disabled:this._disabled,typeDelayBeforeSearch:300,minLengthBeforeSearch:1,placeholder:o.SearchForBots,label:this._label,multiSelect:!0,events:this._getEvents()}}}),getFormConfig:function(t){var i=new(0,this.Factory);return i._setupConfig(t),e.extend({type:"autocomplete",name:"search-bot-autocomplete"},i._getAutocompleteOptions())},createBotSearchControl:function(e){var t=new(0,this.Factory);return t._setupConfig(e),new i(t._getAutocompleteOptions())}}}),define("DS/SwymUIComponents/script/feature/community/social-event/view/pres-support-editor",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/UIKIT/Input/Button","DS/UIKIT/Input/Text"],function(e,t,i,n){return t.extend({_modelEvents:{onChange:"refresh"},domEvents:{"click .input-button-right-part":"delete","change .pres-url-input":"_onUrlChange"},name:"presentation-support-editor",delete:function(){this.model.destroy()},_onUrlChange:function(e){const t=e.target.value;this.model.addChanges("id",t)},_createContent:function(){const t=this.model,o=new i({className:"input-button-right-part",icon:"close"});let s;if("url"===t.get("type")){const t=new n({className:"pres-url-input",value:this.model.get("id")||"",placeholder:"Enter presentation url"});s=e.createElement("div",{class:"pres-support-url-input",html:[t,o]})}else{const i=e.createElement("img",{class:"type-icon",src:t.get("preview_url").unescapeHTML()}),n=e.createElement("span",{class:"file-label",html:t.get("label")});s=e.createElement("div",{class:"pres-support-from-search",html:[i,n,o]})}return s},destroy:function(){return this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/core/user/view/user-picture-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/img-view","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/core/sprite/sprite","DS/SwymUICore/script/utils/utils","DS/WebappsUtils/Console"],function(e,t,i,n,o,s){return t.extend({_modelEventsForAutoRefresh:["onChange:user_picture_fingerprint"],_imageRenderingOptions:null,_modelClass:i,name:"user-picture-view",defaultOptions:{displayPresence:!0},_createContent:function(){var t=n.renderUserPicture(e.merge({login:this.model.get("login"),hash_key:this.model.get("hash_key"),imageUpdateTime:this.model.get("picture_update"),imageFingerprint:this.model.get("user_picture_fingerprint")},this._imageRenderingOptions||{}));return t instanceof HTMLElement&&(this.elements.image=t),t},init:function(){return this._refresh=o.getDelayedSyncTask(t.prototype._refresh),this._parent.apply(this,arguments)},onRedraw:function(){!0===this.getOption("displayPresence")&&require(["DS/RTUserPresenceAPI/RTUserPresenceAPI","DS/SwymUICore/script/feature/core/config/bootstrap-model"],function(e,t){var i=t.getInstance().get("config").tenant;this.model&&(this._userPresenceView=new e({size:"40px",login:this.model.get("login"),tenantId:i.id,noAvatar:!0,username:"",swymUrl:o.getBaseUrl()}),this._userPresenceView.render().inject(this.container))}.bind(this))},setup:function(t){var n=null;return t&&(n=t.hash_key?e.merge({model:new i({hash_key:t.hash_key,login:t.hash_key,nickname:t.nickname?t.nickname:null})},t):t),this._parent.call(this,n)},destroy:function(){try{this._userPresenceView&&("function"==typeof this._userPresenceView.destroy&&this._userPresenceView.destroy(),this._userPresenceView=null)}catch(e){}return this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/media/view/3dsto-viewer",["DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/lib/event-manager","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/utils/usage-tracker"],function(e,t,i,n,o,s,a,r){"use strict";return e.extend({_modelEventsForAutoRefresh:["onSync:read","onSync:update"],_storyObj:null,name:"3dsto-viewer",_mode:null,onHide:function(){this._clean()},destroy:function(){this._clean(),this._parent.apply(this,arguments)},_clean:function(){!this.isDestroyed()&&this._storyObj&&(this._storyObj.destroy(),this._storyObj=null)},onShow:function(){this._launchStory(this._getStoryParams())},_getCommonParams:function(){return{onActivateFullscreen:function(){this.container.addClassName("media-viewer-fullscreen")}.bind(this),onDeactivateFullscreen:function(){this.container.removeClassName("media-viewer-fullscreen")}.bind(this)}},_getParamsForEdit:function(){var e=this.model,t=this._getCommonParams();return t=Object.assign(t,{model:e,wakeUpUrl:e.get("play").wake_up_url,fileUrl:e.get3DFileURL(),edit:!0,currentCommunityId:e.getThreadId(),threadType:e.getThreadType(),threadId:e.getThreadId()})},_getParamsForCreation:function(){var e=new n,t=null,l=a.getInstance().getData(),c=Object.assign({},this._getCommonParams(),{onContentPublishedInSwym:function(t,o){const s=e.getThreadId(),a=i.COMMUNITY_MY_CONTRIBUTIONS,l=e.getCommunity&&e.getCommunity()&&e.getCommunity().isDirectMessage();r.trackPageEvent({category:"ContentCreation",label:"publishStory",view:"3dsto-viewer",event:"click"}),!0===o?new Promise(function(e){s?e(s):new n({mid:t},{autoPopulate:!0,onPopulate:function(t){let i=t.getCommunity(),n=i.get("mid")||i.id;e(n)}})}).then(function(e){i.goToCommunity(e,a,!1,l)}):i.goToContent(t,"media",e.getThreadId(),null,null,null,e.getCommunity&&e.getCommunity()&&e.getCommunity().isDirectMessage())}});if(!this._communitySelected||l.previousAttributes.communityId||l.previousAttributes.dmId)if(l.previousAttributes.communityId&&!l.previousAttributes.dmId)t=new o({mid:l.previousAttributes.communityId});else{if(!l.previousAttributes.dmId)return c;t=new s({mid:l.previousAttributes.dmId})}else(t=new o({mid:this._communitySelected})).set("community_type","community");return e.setAssociated("community",t),c=Object.assign(c,{model:e,currentCommunityId:e.getThreadId(),threadType:e.getThreadType(),threadId:e.getThreadId()})},_getStoryParams:function(){var e=null;return this.model?(this._mode="edit",e=this._getParamsForEdit()):(this._mode="creation",e=this._getParamsForCreation()),e},getBlob:function(e,t){this._storyObj.startPublish(e,t)},_launchStory:function(e){var t=this;require(["DS/XCT3DStoryIFrame/XCT3DStoryIFrame"],function(i){t._storyObj=new i,t._storyObj.create(t.container,e)})},onRender:function(){this.container.setStyle("height","100%")},setup:function(){var e=this;t.addEvent("onCommunitySelected",function(t){e._communitySelected=t.split(":")[4]}),this._parent.apply(this,arguments),this._launchStory(this._getStoryParams())}})}),define("DS/SwymUIComponents/script/feature/core/pagination/view/paging-toolbar-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUICore/script/feature/core/pagination/collection/paginated-collection","DS/WebappsUtils/Console"],function(e,t,i,n){return t.extend({_collectionClass:i,_collectionEventsForAutoRefresh:["onAfterPageChange"],name:"paging-toolbar-view",nbPrevPagesToDisplay:3,nbNextPagesToDisplay:3,activePageNum:null,lastPageNum:null,domEvents:{"click .page":"goToPage","click .dsnext":"goToNextPage","click .dsprev":"goToPrevPage"},_createContent:function(){var t,i,n,o,s,a,r,l,c,d,m=!1,u=!1,h=this.collection,p=h.getCurrentPage(),g=this.nbPrevPagesToDisplay,w=this.nbNextPagesToDisplay;if(p){if(this.container.show(),this.activePageNum=a=p,this.lastPageNum=s=h.getLastPageNum(),m=h.hasPrevious(),u=s!==p,"PREV_NEXT"===h.paginationMode?(o=a,n=a,d=!1,c=!1,r=!1,l=!1):((o=a-g)>2?(l=!0,d=!0):2===o?(l=!0,d=!1):(o=1,l=!1,d=!1),(n=a+w)<s-1?(r=!0,c=!0):n===s-1?(r=!0,c=!1):(n=s,r=!1,c=!1)),!1===m&&!1===u)return this.container.hide(),"";var C=[];if(m&&C.push({tag:"span",class:"link dsprev",styles:{"margin-right":"3px"},html:{tag:"span",styles:{padding:"0px 3px"},html:"<"}}),l&&C.push({tag:"span",class:"link page",page:1,html:"&nbsp;1&nbsp;"}),d&&C.push({tag:"span",styles:{padding:"0px 10px"},html:"..."}),"PREV_NEXT"===h.paginationMode)C.push({tag:"span",class:"link current_page",html:"&nbsp;"+a+"&nbsp;"});else for(t=o,i=n;t<=i;t++)t===a?C.push({tag:"span",class:"link current_page",html:"&nbsp;"+t+"&nbsp;"}):C.push({tag:"span",class:"link page",page:t,html:"&nbsp;"+t+"&nbsp;"});return c&&C.push({tag:"span",styles:{padding:"0px 10px"},html:"..."}),r&&C.push({tag:"span",class:"link page",page:s,html:"&nbsp;"+s+"&nbsp;"}),u&&C.push({tag:"span",class:"link dsnext",styles:{"margin-right":"3px"},html:{tag:"span",styles:{padding:"0px 3px"},html:">"}}),e.createElement("div",{class:"paging_toolbar",html:C})}return this.container.hide(),""},setup:function(e){return this._parent.apply(this,arguments),this.activePageNum=1,this},goToPage:function(t){var i=e.Event.getElement(t).getAttribute("page");i&&this.collection.goToPage(i)},goToPrevPage:function(){var e=this.activePageNum-1;e>0&&this.collection.goToPage(e)},goToNextPage:function(){var e=this.activePageNum+1;e<=this.lastPageNum&&this.collection.goToPage(e)}})}),define("DS/SwymUIComponents/script/feature/core/education/view/education-edit-view",["i18n!DS/SwymUIComponents/assets/nls/feature/core/education/view/education-edit-view","DS/SwymUICore/script/feature/core/education/model/education-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/UIKIT/Form"],function(e,t,i,n){"use strict";return i.extend({_modelClass:t,name:"experience-edit-view",_createContent:function(){var t=this.model,i=this,o=(new Date).getTimezoneOffset(),s=this._getValueToNeutralizeDate("date_begin"),a=this._getValueToNeutralizeDate("date_end");return this.addControl("form-aboutme",new n({fields:[{type:"text",label:e.degree,placeholder:e.enterIndustry,value:t.get("degree",{escapeHTML:!1})||"",events:{onChange:function(){t.addChanges("degree",this.getValue())}}},{type:"text",label:e.field,required:!0,value:t.get("field_of_study",{escapeHTML:!1}),events:{onChange:function(){t.addChanges("field_of_study",this.getValue())}}},{type:"text",label:e.institution,required:!0,value:t.get("school_name",{escapeHTML:!1}),events:{onChange:function(){t.addChanges("school_name",this.getValue())}}},{type:"text",label:e.location,placeholder:e.wheredidyouwork,value:t.get("place",{escapeHTML:!1}),events:{onChange:function(){t.addChanges("place",this.getValue())}}},{type:"date",name:"dateBegin",label:e.from,max:new Date,yearRange:50,placeholder:e.selectADate,required:!0,renderTo:window.document.body.getElement(".user-app-view-container"),value:s,events:{onChange:function(){var e=new Date(this.getDate()),i=new Date(e.getTime()-6e4*o);t.addChanges("date_begin",i)}}},{type:"date",name:"dateEnd",disabled:"1"===t.get("not_finished"),label:e.to,placeholder:e.selectADate,required:!0,renderTo:window.document.body.getElement(".user-app-view-container"),yearRange:50,value:"1"===t.get("not_finished")?s:a,events:{onChange:function(){var e=new Date(this.getDate()),i=new Date(e.getTime()-6e4*o);t.addChanges("date_end",i)}}},{type:"checkbox",label:e.Icurrently,checked:"1"===t.get("not_finished"),events:{onChange:function(){var e=i.getControl("form-aboutme").dates[1];this.isChecked()?(e.disable(),t.addChanges("date_end",null)):(e.enable(),t.addChanges("date_end",new Date(i.getControl("form-aboutme").getField("dateBegin").value)));var n=this.isChecked()?"1":"0";t.addChanges("not_finished",n)}}},{type:"textarea",label:e.description,rows:5,placeholder:e.describeyourposition,value:t.get("description",{escapeHTML:!1})||"",events:{onChange:function(){t.addChanges("description",this.getValue())}}}]}))},_getValueToNeutralizeDate:function(e){var t=this.model.get(e,{escapeHTML:!1}),i=new Date(t);return t?new Date(i.getTime()+6e4*(new Date).getTimezoneOffset()):""}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/abstract-rich-link-preview-view",["UWA/Core","UWA/Class/View","DS/UIKIT/DropdownMenu"],function(e,t,i){"use strict";return t.extend({className:"rich-link-preview",domEvents:{"click .preview-close":"_deletePreview","click .preview-domain-link":"_redirectTo","click .preview-container":"_redirectTo"},_redirectTo:function(e){return e.target.className.includes("preview-domain-link")?(window.open("https://www."+this.model.get("domain")),null):e.target.className.includes("preview-close")||e.target.className.includes("preview-toggle")?(e.stopPropagation(),null):(e.stopPropagation(),void window.open(this.model.get("url")))},_deletePreview:function(e){e.stopPropagation(),this.destroy()},formatTitle:function(e){var t;return e.length>60&&(t=(t=e.replace(/^(.{60}[^\s]*).*/,"$1")).concat("...")),t.length>120&&(t=(t=t.replace(/^(.{120}[\s]*).*/,"$1")).concat("...")),e},createDeleteIcon:function(){return e.createElement("span",{class:"preview-close fonticon fonticon-wrong"})},createPreferencesMenu:function(t){var n=this,o=e.createElement("span",{class:"preview-toggle fonticon fonticon-chevron-down",html:"&nbsp;"}),s=[];return"null"!=t.get("image")&&s.push({name:"Toggle image",text:"Toggle image",fonticon:"picture"}),""!=t.get("description")&&s.push({name:"Toggle description",text:"Toggle description",fonticon:"text"}),0===s.length?"":(new i({items:s,events:{onClick:function(e,t){if("Toggle image"===t.name){var i=n.container.getElement(".preview-thumbnail");"0px"===i.getStyle("width")?(i.setStyle("width","100%"),i.classList.add("preview-thumbnail-visible"),i.classList.remove("preview-thumbnail-hidden")):(i.setStyle("width","0px"),i.classList.add("preview-thumbnail-hidden"),i.classList.remove("preview-thumbnail-visible"))}else{var o=n.container.getElement(".preview-description");"none"===o.getStyle("display")?(o.setStyle("display",""),o.classList.add("preview-desc-is-visible"),o.classList.remove("preview-desc-is-hidden")):(o.setStyle("display","none"),o.classList.add("preview-desc-is-hidden"),o.classList.remove("preview-desc-is-visible"))}e.stopPropagation()}},renderTo:n.container.getElement(".scroll-content"),target:o}),o)},render:function(){return""},destroy:function(){this.stopListening(),this.model=null,this._parent()}})}),define("DS/SwymUIComponents/script/feature/core/network/view/request-received-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/network/view/request-received-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/network/model/request-model","DS/SwymUICore/script/feature/core/user/model/user-model","DS/UIKIT/Input/Button","DS/PubSub/PubSub","DS/W3DXComponents/Views/Item/TileView","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/sprite/sprite","UWA/Class/Model","DS/WebappsUtils/WebappsUtils"],function(e,t,i,n,o,s,a,r,l,c,d,m){"use strict";return i.extend({_modelClass:n,name:"request-received-view",_getAddrEl:function(e,t){return e[t]?e[t]+" ":""},_createContent:function(){if(this.model){var i=this.model.collection.getAssociated("groups"),n=this.model.collection.getAssociated("users");i&&(this._idGroupPro=i.getIdGroupProfessional()),n&&(this._users=n);var l=this,m=this.model.getAssociated("user"),u=this.model.getAttributes(),h=new d({title:function(){return'<a data-login="'+(m.get("login")?m.get("login"):"")+'" data-content-type="person" data-hash-key="'+(m.get("hash_key")?m.get("hash_key"):"")+'" class="link">'+m.get("first_name")+" "+m.get("last_name")+"<a>"},subtitle:this._getAddrEl(u,"company")+this._getAddrEl(u,"address")+this._getAddrEl(u,"zip")+this._getAddrEl(u,"city")+this._getAddrEl(u,"country"),imgAttrs:function(){return c.getUserPictureAttributes({format:"normal",cls:"width-60px",hash_key:m.get("hash_key"),imageUpdateTime:m.get("picture_update")})},image:function(){return o.constructUserPictureUrl(null,null,m.get("hash_key"))}}),p=new r({model:h}),g=(e.createElement("div",{html:p.render()}),'<div class="invitation-message"><span class="fonticon fonticon-2x fonticon-comment" ></span> <span class="notifier-message">"'+this.model.get("notifier_message")+'"</span></div>'),w=e.createElement("div",{class:"actionBar edit-style",html:[this.addControl("invite-button",new s({value:t.Accept,className:"saveButton primary",events:{onClick:function(){var e=l.getControl("invite-button");if(e){e.load();var i=l.model.get("user").hash_key,n={group_id:l._idGroupPro,accept_status:"acceptAdd"};if(i)var o=l._users.where({hash_key:i});o&&o.length>0&&(n={group_id:l._idGroupPro,accept_status:"accept"}),l.model.moderate({data:n,onComplete:function(e,i){"acceptAdd"===n.accept_status?(this.alert("success",t.RequestModerated),a.dispatch("refreshNetwork",[e.getAssociated("user"),!0],!0)):this.alert("success",t.youHaveBeenAddedToTheUsersNetwork),a.dispatch("refreshPendingInvitations",!0),this.destroy()}.bind(l),onFailure:function(){e.load(!1),this.alert("error",t.errorOccuredWhileModeratingInvitationRequest)}.bind(l)})}}}})),this.addControl("cancel-button",new s({value:t.Decline,className:"cancelButton default",events:{onClick:function(){var e=l.getControl("invite-button");if(e){e.load();var i={group_id:l._idGroupPro,accept_status:"decline"};l.model.moderate({data:i,onComplete:function(e,i){this.alert("info",t.InvitationRequestDeclined),a.dispatch("refreshPendingInvitations"),this.destroy()}.bind(l),onFailure:function(){e.load(!1),this.alert("error",t.errorOccuredWhileModeratingInvitationRequest)}.bind(l)})}}}}))]});return[e.createElement("div",{class:"edit-content edit-style",html:[{html:p.render(),styles:{height:"70px"}},this.model.get("notifier_message")?g:""]}),w]}},setup:function(e){return this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/core/modal/super-modal",["UWA/Core","DS/UIKIT/SuperModal"],function(e,t){"use strict";return t.extend({init:function(){return arguments.hasOwnProperty("0")&&(window.ds&&"3DD"!==ds.env?arguments[0].renderTo=window.document&&window.document.body:arguments[0].renderTo=window.widget&&window.widget.body),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/media/edit/upload/media-upload-queue",["UWA/Core","UWA/Utils"],function(e,t){"use strict";return function(){var i,n,o={},s=[],a=[],r=[],l=[],c=function(e,t){var i=e.indexOf(t);return e.splice(i,1)},d=function(e){0===s.length&&0===a.length?0===l.length?i&&i():n&&n(e):s.length>0&&p()},m=function(e){c(a,e),r.push(e),d()},u=function(e,t){c(a,e),l.push(e),d(t)},h=function(e){var t=!1;return!t&&r.some(function(i,n){if(i===e)return t=r.splice(n,1)[0],!0}),!t&&l.some(function(i,n){if(i===e)return t=l.splice(n,1)[0],!0}),t},p=function(r){var l;for((o=e.merge(r||{},o))&&(i=o.onUploadsComplete,n=o.onUploadsFailure,Array.isArray(o.mediaToBeUploaded)&&o.mediaToBeUploaded.forEach(function(e){(function(e){return s.some(function(t){return t===e})})(e)||function(e){return a.some(function(t){return t===e})}(e)||(h(e),e.addEventOnce("removeFromUploadQueue",h),s.push(e))}),delete o.mediaToBeUploaded);s.length>0&&a.length<5;){l=s.shift(),a.push(l);var c=e.merge({onComplete:m,onFailure:u,onTimeout:u},o);const i="X-Request-ID";if(!l.get(i)){const e=t.getUUID();l.set(i,e)}c.headers||(c.headers={}),c.headers[i]=l.get(i),l.get("objectId")&&!l.has("mid")?l.publishFrom3DDriveToSwym(c):l.save({},c)}};return p}}),define("DS/SwymUIComponents/script/feature/community/media/view/media-tooltip-view",["DS/SwymUICore/script/lib/view/generic/swym-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/view/media-tooltip-view","DS/UIKIT/Tooltip","UWA/Controls/DataGrid"],function(e,t,i,n){"use strict";function o(e,t){return+parseFloat(e).toFixed(t)}function s(e){return e&&e<1073741824?o(parseInt(e)/1048576,2)+" MB":o(parseInt(e)/1073741824,2)+" GB"}var a=e.extend({name:"mediaTooltip",_mediaFileExtension:null,_targetElement:null,_displayedFileTypes:["image","video","audio","3dmodel","document","drawing"],setup:function(e){this._targetElement=e.target,e.displayedFileTypes&&(this._displayedFileTypes=e.displayedFileTypes),void 0!==this.model.get("documentedFormats")?this._createTooltip():this.reactTo(this.model,"onDocumentedFileExtensionsCreated",this._createTooltip),this.reactTo(this.model,"onChange:maxSizes",this._createTooltip)},_createTooltip:function(){var e=this.model.get("documentedFormats");this.addControl("supportedFileExtensionsTooltip",new i({className:"dropzone-tooltip",target:this._targetElement,body:this._createTooltipContent(e),position:"right"}))},_createTooltipContent:function(e){var i=this.model.get("maxSizes"),o=this.model.get("maxpixels"),a=[];return this._displayedFileTypes.forEach(function(n){switch(n){case"image":a.push({type:t.Image,extension:e.image.join(", "),size:s(i.picture)+" "+t.Or+" "+Math.floor(o.picture/1e6)+"Mpx"});break;case"video":a.push({type:t.Video,extension:e.video.join(", "),size:s(i.video)});break;case"audio":a.push({type:t.Audio,extension:e.audio.join(", "),size:s(i.sound)});break;case"3dmodel":a.push({type:t.ThreeDModel,extension:e["3dmodel"].join(", "),size:s(i["3d_model"])});break;case"document":a.push({type:t.Document,extension:e.document.join(", "),size:s(i.document)});break;case"drawing":a.push({type:t.Drawing,extension:e.drawing.join(", "),size:s(i.drawing)})}}),new n({className:"mediaTooltip",columns:[{text:t.Type,dataIndex:"type"},{text:t.Supportedfileextensions,dataIndex:"extension"},{text:t.Maxsize,dataIndex:"size"}],data:a})}});return a.getSizeWithUnits=s,a}),define("DS/SwymUIComponents/script/feature/community/media/view/video/player-behaviors",["UWA/Data"],function(e){"use strict";function t(){return window.ds&&"MOBILE"===window.ds.env}return{getLoopBehavior:function(e){return"animatedPicture"===e&&!t()},getAutoPlayBehavior:function(e,i){return"animatedPicture"===i?!t():e||!1},getControlsBehavior:function(e,t){return"animatedPicture"!==t&&(e||!0)},getAVStream:function(i){return t()?e.proxifyUrl(i,{proxy:"passport"}):i}}}),define("DS/SwymUIComponents/script/feature/community/question/question-view-mixin",[],function(){"use strict";return{_modelEvents:{"onChange:nb_validate":"_updateAnswerIcon"},onRedraw:function(){this._parent.apply(this,arguments),this._updateAnswerIcon()},_updateAnswerIcon:function(){if(this.hasOwnProperty("model")&&"iquestion"===this.model.getModelName()){var e=this.model,t=this.container.getParent()||this.container,i=e.isValidated(),n=e.get("ds6w_58_status");void 0!==i?i?t.addClassName("question-validated"):t.removeClassName("question-validated"):void 0!==n&&("ds6w:status.swym_validated"===n?t.addClassName("question-validated"):t.removeClassName("question-validated"))}}}}),define("DS/SwymUIComponents/script/feature/core/modal/modal",["DS/UIKIT/Modal"],function(e){"use strict";return e.extend({init:function(){return window.ds&&"3DD"!==window.ds.env?arguments[0].renderTo=window.document&&window.document.body:arguments[0].renderTo=window.widget&&window.widget.body,this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/lib/ckeditor/autoDetectInlineTagOnPaste/plugin",["UWA/Core"],function(e){"use strict";var t=["ds6w:who","ds6w:when","ds6w:what","ds6w:where","ds6w:why","ds6w:how"];CKEDITOR.plugins.add("autoDetectInlineTagOnPaste",{init:function(e){var t=this;e.on("paste",function(e){t.autoDetectTag(e)})},autoDetectTag:function(i){var n,o=!1,s=!1;if(console.log(i),"paste"===i.name&&"html"===i.data.type){switch(n=i.data.dataValue,e.typeOf(n)){case"string":n=e.createElement("div",{html:n}),o=!0;break;case"element":e.extendElement(n),o=!0}o&&(n.getElements("a[data-predicate]").forEach(function(e){var i=e.dataset.predicate;t.indexOf(i)>=0&&(s=!0,!e.hasClassName("s6m-tag-link")&&e.addClassName("s6m-tag-link"),!e.hasClassName("s6m-link")&&e.addClassName("s6m-link"))}),s&&(i.cancel(),i.editor&&i.editor.insertHtml(n.innerHTML)))}}})}),define("DS/SwymUIComponents/script/feature/core/pubsub/ui-component-pubsub",["require","exports","DS/SwymUICore/script/lib/view/generic/swym-view"],function(e,t,i){"use strict";var n={setLabelRequest:["navigation-bar-im-view"]};return function(){function e(){this._subscribedViews=[]}return e.prototype.dispatchEvent=function(e,t,i){if(Object.keys(n).indexOf(e)>=0){var o=n[e];this._subscribedViews.forEach(function(n){n.name&&n.name===t&&n.name.indexOf(o)>=0&&n.dispatchEvent&&n.dispatchEvent(e,i)})}},e.prototype.addViewForSubscription=function(e){e&&e instanceof i&&this._subscribedViews.push(e)},e.prototype.removeViewFromSubscription=function(e){if(e&&e instanceof i){var t=this._subscribedViews.indexOf(e);t>=0&&this._subscribedViews.splice(t,1)}},e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e}()}),define("DS/SwymUIComponents/script/feature/community/community/view/proxy-search-widget",["UWA/Core","UWA/Utils","UWA/Utils/InterCom"],function(e,t,i){"use strict";const n=["swym","3dspace","drive","usersgroup","3dplan","globe","dashboard"];var o=["3dspace","drive"],s=function(e={}){this.socketName="search_socket_"+t.getUUID(),this.socket=new i.Socket(this.socketName,{dispatchRetryInterval:5}),this.socket.subscribeServer("SearchComServer"),this.listener=this.objectsSelected.bind(this),this.socket.addListener("Selected_Objects_search",this.listener);var n=this;this.socket.addListener("onCloseTransient",function(){n.unregister()}),this._widget=window.widget||e.widget;var o=this.options({title:"iTitle"});e.iShowIdCard&&(o.idcard_activated=!0)};return s.prototype.destroy=function(){var e={};e.widget_id=this._widget&&this._widget.id||enoviaServer.widgetId,this.socket.dispatchEvent("UnregisterContext",e),this.socket.unsubscribeServer("SearchComServer"),this.socket.removeListener("Selected_Objects_search",this.listener),this.socket.removeListener("onCloseTransient"),this.socket.disconnect()},s.prototype.options=function(t){var i,o=e.clone(t||{},!1),a={title:"",types:"",role:"",default_search_criteria:"",app_socket_id:(i=this).socketName,mode:"furtive",widget_id:i._widget.id,default_with_precond:!0,show_precond:!1,idcard_activated:!1,select_result_max_idcard:!1,source:[...n],tenant:window.enoviaServer?enoviaServer.tenant:i._widget.getValue("x3dPlatformId"),precond:"",excluded_types:{},callback:null};return o.excludedSearchTypes&&(a.excluded_types=o.excludedSearchTypes),e.extend(a,o),function(t){if(e.is(t.types,"object")){var i="Config not supported by 3dsearch. If you specify types for any source, you must do so for all sources",n=e.is(t.source,"array")?t.source:[t.source],o=Object.keys(t.types);if(o.length!==n.length)throw new Error(i);for(var s=0;s<o.length;s++)if(-1===n.indexOf(o[s]))throw new Error(i)}}(a),a.precond||(a.precond=s.buildSearchTypeQuery(a.types,a)),a},s.prototype.activate=function(t){var i=this,n=i.options(t),o=n.callback;e.is(o,"function")||(n.mode="default"),i.callback=o;var s={};s.widget_id=this._widget&&this._widget.id||enoviaServer.widgetId,i.socket.dispatchEvent("UnregisterContext",s),i.socket.addListener("RegisterContext_Response",function(){i.socket.dispatchEvent("InContextSearch",n),i.socket.removeListener("RegisterContext_Response")}),i.socket.dispatchEvent("RegisterContext",n)},s.prototype.isAvailable=function(){return e.is(this.socket)},s.prototype.objectsSelected=function(e){this.callback&&this.callback(e)},s.prototype.unregister=function(){var e={widget_id:this._widget&&this._widget.id||enoviaServer.widgetId};this.socket.dispatchEvent("UnregisterContext",e)},s.buildSearchTypeQuery=function(t,i){var n;if(t){if(e.is(t,"string")){var o=i.source||["3dspace"];if(-1===(o=e.is(o,"array")?o:[i.source]).indexOf("3dspace")&&o.length)throw new Error("types as string only supported for 3dspace source as it is a backward compatibility feature");t={"3dspace":t.split(",")}}var a=Object.keys(t),r=a.length;n="(";for(var l=0;l<r;l++){0!==l&&(n+=" OR ");var c=a[l],d=t[c];e.is(d,"string")&&(d=[d]),n+=s.buildSearchTypeQueryForSource(c,d,i)}if(i.excluded_types)n+=Object.keys(i.excluded_types).length>0?") AND NOT "+s.buildSearchTypeQuery(i.excluded_types,{exclude:!0}):")";else n+=")"}else i.excluded_types&&(n=" NOT "+s.buildSearchTypeQuery(i.excluded_types,{exclude:!0}));return n},s.buildSearchTypeQueryForSource=function(e,t,i){var n,o=s.isM1BasedSource(e);n=o?"flattenedtaxonomies:":"[ds6w:type]:",n+="(","swym"===e&&-1!==t.indexOf("pno:Person")&&i&&!i.exclude&&i.excludePendingUser&&(n="ut_state:1 && "+n);for(var a=0;a<t.length;a++){var r=t[a];0!==a&&(n+=" OR "),n+=o?'"types/'+r.trim()+'"':'"'+r.trim()+'"'}return n+=")"},s.isM1BasedSource=function(e){return-1!==o.indexOf(e)},s.computeSourceParameters=function(t){var i=e.clone(t.excludeSearchTypes||{},!1),n={};o.forEach(function(n){(e.is(t.searchSource,"array")&&-1!==t.searchSource.indexOf(n)||t.searchSource===n)&&(i[n]||(i[n]=["Person","Security Context"]))});var a,r=t.searchSourceTypes;return r&&(a={types:r,specificSourceParameter:n,excludePendingUser:t.excludePendingUser},s._buildSpecificSourceParameter(a)),s._buildSpecificSourceParameter(a={types:i,specificSourceParameter:n,exclude:!0}),n},s._buildSpecificSourceParameter=function(e){for(var t=e.specificSourceParameter,i=e.types,n=Object.keys(i),o=n.length,a=0;a<o;a++){var r=n[a],l=i[r],c=t[r],d=c&&c.additional_query||"";d&&(d+=" AND "),e.exclude&&(d+="NOT "),d+=s.buildSearchTypeQueryForSource(r,l,e),t[r]={additional_query:d}}return t},s}),define("DS/SwymUIComponents/script/feature/community/social-event/utils/social-event-constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.REPORT_MODE=t.VIEW_MODE=t.BOTTOM_SECTION_CLASS=t.TOP_SECTION_CLASS=void 0,t.TOP_SECTION_CLASS="viewer-top-section",t.BOTTOM_SECTION_CLASS="viewer-bottom-section",t.VIEW_MODE="View",t.REPORT_MODE="Report"}),define("DS/SwymUIComponents/script/feature/community/social-event/edit/external-users-edit-view",["UWA/Core","DS/SwymUICore/script/feature/community/social-event/model/social-event-model","DS/SwymUICore/script/feature/community/ritual/model/ritual-model","DS/UIKIT/Autocomplete","DS/UIKIT/Tooltip","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/UWPClientControls/PlatformNotify","i18n!DS/SwymUIComponents/assets/nls/feature/community/social-event/social-event-view"],function(e,t,i,n,o,s,a,r){"use strict";const l={9:"tab",13:"enter"},c=[",",";"];function d(e){return/^([a-zA-Z0-9_.\-'+])+@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e)}function m(e){return!d(e)}return s.extend({name:"external-users-edit-view",_externalUsersSet:null,_externalUsersExpanded:!1,_modelClass:[t,i],domEvents:{"click .external-users .first-line":"toggleExternalUsersEl","click .email-remove":"onRemoveEmailClicked"},init:function(){const e=this;this._parent.apply(this,arguments),this.resetExternalUsersArray(),this.addControl("extUsersInput",new n({className:"email-input",placeholder:r.EnterEmail,noResultsMessage:!1,allowFreeInput:!0,events:{onEmailSelected:function(t,i){this.reset(),i&&(this.elements.input.value=i),e.dispatchEvent("onEmailAdded",[t])},onKeyDown:function(t){let i,n,o,s,u=!1,h=l[t.keyCode];("enter"===h||"tab"===h)&&(i=this.elements.input.value,n=(u=c.some(function(e){return i.includes(e)}))&&c.reduce(function(e,t){return e||i.includes(t)&&i.split(t)},!1)||i.split(" "),(n=Array.isArray(n)&&n.map(e=>e.trim()).filter(e=>e.length>0))&&n.length>0&&(e.getExternalUsersArray().length+n.length>50?a.error(r.replace(r.YouCannotAddMoreThanNUsers,{n:50})):(o=n.filter(d),s=n.filter(m),o.length!==n.length&&a.error(r.SomeOfTheEmailsEnteredWereNotValid),o.length>0&&this.dispatchEvent("onEmailSelected",[o.join(","),s.join(",")]))))}}})),this.model&&this.model.has("external_users")&&this.model.get("external_users").length>0&&(this.addExternalUser(this.model.get("external_users")),this._externalUsersExpanded=!0)},onEmailAdded:function(e){this._externalUsersSet.has(e)?a.error(r.get(r.EmailEnteredAlreadyExists)):(this.addExternalUser(e),this.updateExternalUsersText(),this.refresh())},onRemoveEmailClicked:function(e){let t=e._uwaTarget||e.target,i=t&&t.getClosest(".email-card"),n=i&&i.getElement(".email-text"),o=n&&n.getText();o&&this.removeExternalUser(o),this.updateExternalUsersText(),this.refresh()},addExternalUser:function(e){const t=e.split(",");Array.isArray(t)&&t.forEach(e=>this._externalUsersSet.add(e))},removeExternalUser:function(e){this._externalUsersSet.delete(e)},getExternalUsersArray:function(){return Array.from(this._externalUsersSet)},resetExternalUsersArray:function(){this._externalUsersSet=new Set},updateExternalUsersText:function(){let e=this.getExternalUsersArray(),t=e&&e.length||0;this.externalUserLimitationReminderEl.setHTML(r.replace(r.YouCanAddNMoreUsers,{n:50-t}))},toggleExternalUsersEl:function(){this._externalUsersExpanded=!this._externalUsersExpanded,this.updateExternalUsersEl()},updateExternalUsersEl:function(){if(!this.externalUsersEl){this.externalUserLimitationReminderEl=e.createElement("span",{class:"ext-user-limit-text",html:""});const t=e.createElement("span",{class:"fonticon fonticon-help-circled"});new o({target:t,body:r.externalUsersTooltipMessage}),this.externalUsersEl=e.createElement("div",{class:"external-users",html:[{tag:"div",class:"first-line heading",html:[{tag:"span",class:"fonticon fonticon-expand-down"},{tag:"span",class:"fonticon fonticon-expand-right"},{tag:"span",class:"ext-users-heading",html:r.ExternalUsers},t]},this.getControl("extUsersInput"),this.externalUserLimitationReminderEl]})}return this._externalUsersExpanded?(this.externalUsersEl.getElement(".fonticon-expand-down").show(),this.externalUsersEl.getElement(".fonticon-expand-right").hide(),this.externalUserLimitationReminderEl.show(),this.getControl("extUsersInput").show()):(this.externalUsersEl.getElement(".fonticon-expand-down").hide(),this.externalUsersEl.getElement(".fonticon-expand-right").show(),this.externalUserLimitationReminderEl.hide(),this.getControl("extUsersInput").hide()),this.updateExternalUsersText(),this.externalUsersEl},createEmailCardsArray:function(t){let i=this.getExternalUsersArray();return i.length?{tag:"div",class:"ext-users-section",html:i.map(function(t){const i=e.createElement("div",{class:"email-card",html:[{tag:"span",class:"fonticon fonticon-user"},{tag:"span",class:"email-text",text:t},this&&this.hideClose?"":{tag:"span",class:"fonticon fonticon-close email-remove"}]});return new o({target:i,body:t}),i}.bind(t))}:{}},reset:function(){this.resetExternalUsersArray(),this.getControl("extUsersInput").reset(),this.updateExternalUsersText(),this.refresh()},_createContent:function(){return[{class:"ext-users-edit",html:[this.updateExternalUsersEl(),this.createEmailCardsArray()]}]}})}),define("DS/SwymUIComponents/script/feature/community/media/editor/view/control-point-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/WebappsUtils/Console"],function(e,t,i){"use strict";return t.extend({type:null,cropboxRect:null,width:20,beingDragged:!1,svgWrapper:null,x:null,y:null,offsetX:null,offsetY:null,rectOffsetX:null,rectOffsetY:null,rect:null,rectElt:null,svgWrapperElt:null,render:function(){throw new Error("This class instances must not use render.")},setup:function(e){var t,n;switch(this.type=e.type,this.rect=document.createElementNS("http://www.w3.org/2000/svg","rect"),this.rect.setAttribute("width",this.width),this.rect.setAttribute("height",this.width),this.rect.setAttribute("class","media-editor-cropbox-pointcontrol"),this.rectElt=UWA.extendElement(this.rect),e.type){case"NW":this.rectOffsetX=0,this.rectOffsetY=0,this.rectElt.setStyle("cursor","nw-resize");break;case"NE":this.rectOffsetX=-this.width,this.rectOffsetY=0,this.rectElt.setStyle("cursor","ne-resize");break;case"SW":this.rectOffsetX=0,this.rectOffsetY=-this.width,this.rectElt.setStyle("cursor","sw-resize");break;case"SE":this.rectOffsetX=-this.width,this.rectOffsetY=-this.width,this.rectElt.setStyle("cursor","se-resize")}t=e.pointCoord[0]+this.rectOffsetX,n=e.pointCoord[1]+this.rectOffsetY,this.rectElt.setAttribute("x",t),this.rectElt.setAttribute("y",n),i.log("x: "+t+", y:"+n),this.rectElt.inject(e.renderTo),this.svgWrapperElt=e.svgWrapper,this.updateOffsets(),i.log("x: "+t+", y:"+n)},updateOffsets:function(){var t,i,n=e.Utils.Client.Engine;n.firefox||n.ie?(t=document.documentElement.scrollLeft,i=document.documentElement.scrollTop):(t=document.body.scrollLeft,i=document.body.scrollTop);var o=this.svgWrapperElt.getOffsets();this.offsetX=o.x-t,this.offsetY=o.y-i},setCoordinate:function(e,t){this.rectElt.setAttribute(e,t)},isControlPoint:function(e){return this.rect===e},onMouseDown:function(e){this.beingDragged=!0},onMouseUp:function(e){this.beingDragged=!1},onMouseOut:function(){this.beingDragged=!1},onMouseMove:function(e){this.updateOffsets();var t=e.clientX-this.offsetX,i=e.clientY-this.offsetY;this.beingDragged&&(this.rect.setAttribute("x",t),this.rect.setAttribute("y",i),this.dispatchEvent("ControlPointMoved",this))},getCoordsInSvgSpace:function(e){return{x:e.clientX-this.offsetX,y:e.clientY-this.offsetY}}})}),define("DS/SwymUIComponents/script/feature/core/user/view/location/user-location-read-view",["UWA/Core","UWA/String","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/user/model/user-model"],function(e,t,i,n){"use strict";return i.extend({name:"user-location-read-view",_modelEventsForAutoRefresh:["onChange"],_modelClass:n,_getParamInHTML:function(e){var i="";return/\S/.test(this.model.get(e)||"")&&(i=t.unescapeHTML(this.model.get(e,{escapeHTML:!0}))+"</br>"),i},_createContent:function(){return e.createElement("div",{html:'<span class="company">'+this._getParamInHTML("company")+'</span><span class="address">'+this._getParamInHTML("address")+'</span><span class="zip">'+(this.model.get("zip")||"")+' </span><span class="city">'+this._getParamInHTML("city")+'</span><span class="country">'+(this._getParamInHTML("countryForRead")||this._getParamInHTML("country"))+"</span>"})}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/tag-autocomplete",["UWA/Core","UWA/Json","UWA/Utils","UWA/String","UWA/Promise","DS/WAFData/WAFData","DS/UWPClientCode/I18n","DS/SocialUserMention/Controls/AbstractAutocomplete","DS/Logger/Logger"],function(e,t,i,n,o,s,a,r,l){"use strict";return r.extend({SUGGESTIONS_MAX_HEIGHT:238,defaultOptions:{defaultClassName:"s6m-tag-autocomplete",typeDelayBeforeSearch:0},_initSocialMentionDataSet:function(){var t=this;this.addDataset({name:"6WTags",items:[],searchEngine:function(e,t){var n,o;return["what","when","where","who","why","how"].map(function(e){return{label:t,predicateWithoutNamespace:e,predicate:o="ds6w:"+e,value:n=o+"/"+t,id:i.getCheckSum(n)}})}},{templateEngine:function(t,i,o){var s;t.addClassName("default-template"),(s=e.createElement("span",{class:"s6m-tag-literal"})).setText(o.label),t.setContent(e.createElement("span",{class:"item-label",html:[{tag:"span",title:n.ucfirst(o.predicateWithoutNamespace),class:"item-label-icon fonticon fonticon-3ds-"+o.predicateWithoutNamespace},s]}))},onError:function(){t.hide()},onTimeout:function(){t.hide()}})}})}),define("DS/SwymUIComponents/script/feature/community/wedo/view/wedo-project-details-view",["UWA/Core","DS/UWPClientCode/I18n","DS/SwymUICore/script/feature/community/wedo/model/wedo-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/wedo/view/wedo-detailed-view","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/utils/compass-proxy","DS/SwymUICore/script/feature/core/config/bootstrap-model"],(e,t,i,n,o,s,a,r)=>{const l=r.getInstance();return n.extend({_modelClass:i,name:"wedo-project-details-view",_modelEvents:{onSync:"refresh"},domEvents:{"click span.wedo-project-hyperlink":"_goToProject"},_goToProject(){const t=this.model.get("projectId"),i=l.get("config").tenant.online_instance_id.toUpperCase();window.ds&&"3DD"!==window.ds.env?this._buildRedirectURL(t,i).then(t=>{const i=e.createElement("a",{href:t,target:"_blank"});i.click(),i.destroy()}).catch(()=>{}):s.showTransientWidget("ENXPLAN_AP","",{ids:t,tenant:i,x3dPlatformId:i})},_showProjectDetails(){return this.model&&this.model.has("projectDetails")},_getProjectLink(){const{model:e}=this;return`<span class="wedo-project-hyperlink">${e.get("projectName")}</span>`},_buildRedirectURL:(e,t)=>new Promise((i,n)=>{a.getServiceUrl({platformId:t,serviceName:"3DDashboard",onComplete(o){try{const s=o;s.lastIndexOf("/")===s.length-1&&s.pop(),i(`${s}#app:ENXPLAN_AP/content:ids=%3C${encodeURIComponent(e)}%3E&tenant=${t}&x3dPlatformId=${t}`)}catch(e){n(e)}}})}),_createContent(){const e=this._showProjectDetails();let i=o.ThisProjectIsAssociatedToAProject;return e?(this.model.get("projectAccessible")&&(i=t.replace(o.ThisProjectIsAssociatedToTheProject,{project:this._getProjectLink()})),[{class:"wedo-header-details",html:[{class:"wedo-header-details-title",html:o.RelatedProjects}]},{class:"wedo-project-details-panel",html:i}]):""}})}),define("DS/SwymUIComponents/script/feature/community/media/view/abstract-lightbox-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/view/interactive-media-thumbnail-view","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/UIKIT/Tooltip"],function(e,t,i,n,o){"use strict";var s=n.extend({_modelClass:i,name:"lightbox-header-media-view",_modelEventsForAutoRefresh:["onSync"],_shouldPlay360IconBeDisplayed:function(){return this.model.isConsideredAsA360MediaModel()&&!1===this._parentView._isAutoplayActivated},_getHeaderTitle:function(){return this.model.getChanges("title")||this.model.get("title")},_createContent:function(){var i=this.getOption("displayActionsOnHeader"),n=i&&this._shouldPlay360IconBeDisplayed(),s=i&&("1"==this.model.get("download_original_file")||"document"===this.model.get("media_type")),a=this.getOption("titleInteraction")?"text":"",r=this._getHeaderTitle()||"",l=e.createElement("div",{class:"header",html:[{class:"title",html:r?'<span class="'+a+'">'+r+"</span>":""},{class:"action-icons",html:[s?{tag:"span",class:"fonticon fonticon-download fonticon-2x"}:{},n?{tag:"span",class:"fonticon fonticon-media-360 play-360-experience fonticon-2x"}:{},{tag:"span",class:"fonticon fonticon-cancel fonticon-2x"}]}]});return n&&this.addControl("play-tooltip",new o({target:l.getElement(".play-360-experience"),body:t.Play,position:"left"})),s&&this.addControl("download-tooltip",new o({target:l.getElement(".fonticon-download"),body:t.Download,position:"left"})),this.addControl("cancel-tooltip",new o({target:l.getElement(".fonticon-cancel"),body:t.Close,position:"left"})),l}});return n.extend({_modelClass:i,name:"abstract-lightbox-view",domEvents:{"click .fonticon-cancel":"_destroy"},_destroy:function(e){this.destroy()},setup:function(e){window.addEventListener("orientationchange",this.refresh.bind(this)),window.document.onkeydown=function(e){("key"in(e=e||window.event)?"Escape"==e.key||"Esc"==e.key:27==e.keyCode)&&this._destroy(e)}.bind(this),window.widget&&(this._widget=widget),this._widget&&this._widget.addEventOnce("onRefresh",function(){this.destroy()}.bind(this))},getContentView:function(){return[]},displayActionsOnHeader:!0,titleInteraction:!0,removeContentView:function(){},_createContent:function(){return this.model.hasBeenFetched()||this.model.isNew()||this.model.fetch(),this.removeContentView(),e.createElement("div",{class:"media-full-screen",html:[this.addChildView("header",{Class:s,model:this.model,displayActionsOnHeader:this.displayActionsOnHeader,titleInteraction:this.titleInteraction}),{class:"content","media-type":this.model.get("media_type"),html:this.getContentView()}]})},injectInDom:function(){this.inject(document.body).show()}})}),define("DS/SwymUIComponents/script/utils/media-utils-v1",["UWA/Core","DS/SwymUICore/script/utils/utils","DS/Logger/Logger","DS/SwymUICore/script/feature/community/media/model/media-model"],function(e,t,i,n){"use strict";function o(e,t){return"function"==typeof e.get?e.get(t):e[t]}function s(e){var t=o(e,"status")||o(e,"preview_media_processing_status"),i=parseInt(o(e,"width")||o(e,"preview_original_width"),10),s=parseInt(o(e,"height")||o(e,"preview_original_height"),10);return t===n.MEDIA_PROCESSING_STATUS.OK&&i>0&&s>0}var a={};return a.MEDIA_THUMBNAIL=n.MEDIA_THUMBNAIL,a.PICTUREVIEW_V0=n.PICTUREVIEW_V0,a.PICTUREVIEW_V1=n.PICTUREVIEW_V1,a.isPictureViewAvailable=function(e){return s(e)},a.getLargestMediaDisplayDimensions=function(t){var i,n,r,l=o(t,"width")||o(t,"preview_original_width"),c=o(t,"height")||o(t,"preview_original_height"),d=l/c,m=l>c,u=o(t,"processing_version");if(1!==(u=parseInt(e.is(u)?u:o(t,"preview_media_processing_version"),10)))throw new Error("V1 picture view expected");return s(t)?(i=t.get("pictureviewConfig"))&&(i.xl1?(n=i.xl1.width,r=i.xl1.height):i.o1&&(n=i.o1.width,r=i.o1.height)):m?r=(n=a.MEDIA_THUMBNAIL.DIMENSIONS.LARGE.WIDTH)/d:n=(r=a.MEDIA_THUMBNAIL.DIMENSIONS.LARGE.HEIGHT)*d,{width:n,height:r}},a.getBestMediaViewConfig=function(t,i,r,l){var c,d,m,u,h,p,g,w,C,f,y,v,A,_,S,b,I,D,T,E,U,k,x,M=a.MEDIA_THUMBNAIL;if(t&&(w=o(t,"width")||o(t,"preview_original_width"),C=o(t,"height")||o(t,"preview_original_height"),T=o(t,"processing_version"),T=parseInt(e.is(T)?T:o(t,"preview_media_processing_version"),10)),w=parseInt(w,10)||0,C=parseInt(C,10)||0,y=w?w/C:4/3,_=(v=w>C)?w:C,i=parseInt(i,10)||a.MEDIA_THUMBNAIL.DIMENSIONS.LARGE.WIDTH,r=parseInt(r,10)||i/y,A=v?i:r,1===T&&s(t))u=a.PICTUREVIEW_V1.DIMENSIONS.M1,h=a.PICTUREVIEW_V1.DIMENSIONS.L1,p=a.PICTUREVIEW_V1.DIMENSIONS.XL1,U="picture",_<A?t&&(E=t.get("pictureviewConfig"))&&(E.xl1?g="xl1":E.o1&&(g="o1")):g=A<=u?_<=u?"o1":"m1":A<=h?_<=h?"o1":"l1":_<=p?"o1":"xl1",b=a.PICTUREVIEW_V1.KEY[g.toUpperCase()],S=a.PICTUREVIEW_V1.TYPE,"o1"===g?(I=w,D=C):v?D=(I=a.PICTUREVIEW_V1.DIMENSIONS[g.toUpperCase()])/y:I=(D=a.PICTUREVIEW_V1.DIMENSIONS[g.toUpperCase()])*y,f=n.constructPictureViewUrl(t.get("mid"),g,o(t,"preview_fingerprint"));else{if(v?(c=a.MEDIA_THUMBNAIL.DIMENSIONS.SMALL.WIDTH,d=a.MEDIA_THUMBNAIL.DIMENSIONS.MEDIUM.WIDTH,m=a.MEDIA_THUMBNAIL.DIMENSIONS.LARGE.WIDTH):(c=a.MEDIA_THUMBNAIL.DIMENSIONS.SMALL.HEIGHT,d=a.MEDIA_THUMBNAIL.DIMENSIONS.MEDIUM.HEIGHT,m=a.MEDIA_THUMBNAIL.DIMENSIONS.LARGE.HEIGHT),U="thumb","whats-new-mode"===l)if(_)g=_<c?"s":_<d?A<=c?"s":"m":A<=c?"s":A<=d?"m":"l";else{if(!A)throw new Error("Dimensions not available to calculate the best thumbnail");g=A<=c?"s":A<=d?"m":"l"}else if(_)g=_<d?"s":_<m?A<d?"s":"m":A<d?"s":A<m?"m":"l";else{if(!A)throw new Error("Dimensions not available to calculate the best thumbnail");g=A<d?"s":A<m?"m":"l"}switch(f=n.constructThumbnailUrl("media",t.get("mid"),g+"_thumb",o(t,"preview_fingerprint")),S=M.TYPE,k=M.KEY,x=a.MEDIA_THUMBNAIL.DIMENSIONS,y=4/3,g){case"s":b=k.SMALL,v?D=(I=x.SMALL.WIDTH)/y:I=(D=x.SMALL.HEIGHT)*y;break;case"m":b=k.MEDIUM,v?D=(I=x.MEDIUM.WIDTH)/y:I=(D=x.MEDIUM.HEIGHT)*y;break;case"l":b=k.LARGE,v?D=(I=x.LARGE.WIDTH)/y:I=(D=x.LARGE.HEIGHT)*y}}return{previewType:U,url:f,size:g,width:I,height:D,spriteKey:b,spriteType:S}},a}),define("DS/SwymUIComponents/script/utils/media-utils-v0",["UWA/Core","DS/SwymUICore/script/utils/utils","DS/Logger/Logger","DS/SwymUICore/script/feature/community/media/model/media-model"],function(e,t,i,n){"use strict";function o(e,t){return"function"==typeof e.get?e.get(t):e[t]}function s(e){var t=o(e,"status")||o(e,"preview_media_processing_status"),i=o(e,"media_type"),s=parseInt(o(e,"width")||o(e,"preview_original_width"),10),a=parseInt(o(e,"height")||o(e,"preview_original_height"),10);return t===n.MEDIA_PROCESSING_STATUS.OK&&"picture"===i&&s>0&&a>0}var a={};return a.MEDIA_THUMBNAIL=n.MEDIA_THUMBNAIL,a.PICTUREVIEW_V0=n.PICTUREVIEW_V0,a.PICTUREVIEW_V1=n.PICTUREVIEW_V1,a.isPictureViewAvailable=function(e){return s(e)},a.getLargestMediaDisplayDimensions=function(t){var i,n,r=o(t,"width")||o(t,"preview_original_width"),l=o(t,"height")||o(t,"preview_original_height"),c=r/l,d=r>l,m=o(t,"processing_version");if(1===(m=parseInt(e.is(m)?m:o(t,"preview_media_processing_version"),10)))throw new Error("V0 picture view expected");return d?n=(i=s(t)?a.PICTUREVIEW_V0.DIMENSIONS.LARGE.WIDTH:a.MEDIA_THUMBNAIL.DIMENSIONS.LARGE.WIDTH)/c:i=(n=s(t)?a.PICTUREVIEW_V0.DIMENSIONS.LARGE.HEIGHT:a.MEDIA_THUMBNAIL.DIMENSIONS.LARGE.HEIGHT)*c,{width:i,height:n}},a.getBestMediaViewConfig=function(t,i,r,l){var c,d,m,u,h,p,g,w,C,f,y,v,A,_,S,b,I,D,T,E,U,k,x=a.PICTUREVIEW_V0,M=a.MEDIA_THUMBNAIL;if(t&&(o(t,"media_type"),p=o(t,"width")||o(t,"preview_original_width"),g=o(t,"height")||o(t,"preview_original_height"),D=o(t,"processing_version"),D=parseInt(e.is(D)?D:o(t,"preview_media_processing_version"),10)),p=parseInt(p,10)||0,g=parseInt(g,10)||0,C=p?p/g:4/3,v=(f=p>g)?p:g,i=parseInt(i,10)||320,r=parseInt(r,10)||i/C,y=f?i:r,1!==D){if(f?s(t)?(S="picture",c=a.PICTUREVIEW_V0.DIMENSIONS.SMALL.WIDTH,d=a.PICTUREVIEW_V0.DIMENSIONS.MEDIUM.WIDTH,m=a.PICTUREVIEW_V0.DIMENSIONS.LARGE.WIDTH):(S="thumb",c=a.MEDIA_THUMBNAIL.DIMENSIONS.SMALL.WIDTH,d=a.MEDIA_THUMBNAIL.DIMENSIONS.MEDIUM.WIDTH,m=a.MEDIA_THUMBNAIL.DIMENSIONS.LARGE.WIDTH,u=a.MEDIA_THUMBNAIL.DIMENSIONS.XLARGE.WIDTH):s(t)?(S="picture",c=a.PICTUREVIEW_V0.DIMENSIONS.SMALL.HEIGHT,d=a.PICTUREVIEW_V0.DIMENSIONS.MEDIUM.HEIGHT,m=a.PICTUREVIEW_V0.DIMENSIONS.LARGE.HEIGHT):(S="thumb",c=a.MEDIA_THUMBNAIL.DIMENSIONS.SMALL.HEIGHT,d=a.MEDIA_THUMBNAIL.DIMENSIONS.MEDIUM.HEIGHT,m=a.MEDIA_THUMBNAIL.DIMENSIONS.LARGE.HEIGHT,u=a.MEDIA_THUMBNAIL.DIMENSIONS.XLARGE.HEIGHT),"whats-new-mode"===l)if(v)h=v<c?"s":v<d?y<=c?"s":"m":y<=c?"s":y<=d?"m":"l";else{if(!y)throw new Error("Dimensions not available to calculate the best thumbnail");h=y<=c?"s":y<=d?"m":"l"}else if(v)h=v<d?"s":v<m?y<d?"s":"m":u?v<u?y<d?"s":y<m?"m":"l":y<d?"s":y<m?"m":y<u?"l":"xl":y<d?"s":y<m?"m":"l";else{if(!y)throw new Error("Dimensions not available to calculate the best thumbnail");h=y<d?"s":y<m?"m":u?y<u?"l":"xl":"l"}if(s(t))switch(w=n.constructPictureViewUrl(t.get("mid"),h,o(t,"preview_fingerprint")),A=x.TYPE,T=x.KEY,E=a.PICTUREVIEW_V0.DIMENSIONS,h){case"s":_=T.SMALL,f?I=(b=E.SMALL.WIDTH)/C:b=(I=E.SMALL.HEIGHT)*C;break;case"m":_=T.MEDIUM,f?I=(b=E.MEDIUM.WIDTH)/C:b=(I=E.MEDIUM.HEIGHT)*C;break;case"l":_=T.LARGE,f?I=(b=E.LARGE.WIDTH)/C:b=(I=E.LARGE.HEIGHT)*C}else switch(w=n.constructThumbnailUrl("media",t.get("mid"),h+"_thumb",o(t,"preview_fingerprint")),A=M.TYPE,U=M.KEY,k=a.MEDIA_THUMBNAIL.DIMENSIONS,C=4/3,h){case"s":_=U.SMALL,f?I=(b=k.SMALL.WIDTH)/C:b=(I=k.SMALL.HEIGHT)*C;break;case"m":_=U.MEDIUM,f?I=(b=k.MEDIUM.WIDTH)/C:b=(I=k.MEDIUM.HEIGHT)*C;break;case"l":_=U.LARGE,f?I=(b=k.LARGE.WIDTH)/C:b=(I=k.LARGE.HEIGHT)*C;break;case"xl":_=U.XLARGE,f?I=(b=k.XLARGE.WIDTH)/C:b=(I=k.XLARGE.HEIGHT)*C}}return{previewType:S,url:w,size:h,width:b,height:I,spriteKey:_,spriteType:A}},a}),define("DS/SwymUIComponents/script/feature/community/media/view/document/empty-xlsx-data-uri",[],function(){"use strict";return"data:application/vndopenxmlformats-officedocumentspreadsheetmlsheet;base64,UEsDBBQABgAIAAAAIQB2pmxuTgEAAAgEAAATAAgCW0NvbnRlbnRfVHlwZXNdLnhtbCCiBAIooAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACsk81OAjEUhfcmvkPTrZkpuDDGMLDwZ6ks8AFqe4dp6F96C8Lbe6eAC4OIgc000/ae7/TcdjRZO8tWkNAE3/BhPeAMvAra+HnD32cv1T1nmKXX0gYPDd8A8sn4+mo020RARtUeG97lHB+EQNWBk1iHCJ5W2pCczPSb5iJKtZBzELeDwZ1QwWfwucq9Bh+PnqCVS5vZ85qmt04SWOTscbuxZzVcxmiNkpmcipXXPyjVjlBTZdmDnYl4Qza4OEjoV34H7OreKJpkNLCpTPlVOrIh1lZ8hrT4CGFRHxc54DK0rVGgg1o6SqDGmEBq7ACys3UZayeN3/s+xKfiaQoRKcYE/3ewz6mvriIJQcoGvpM6SqQWnH1k6JusQZ/I3qVdokFRhuGFY++7WYSPpU4+Mt1u2H7Pt1DE/gBi3ljAS1+yIroni/KOx18AAAD//wMAUEsDBBQABgAIAAAAIQC1VTAj9AAAAEwCAAALAAgCX3JlbHMvLnJlbHMgogQCKKAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArJJNT8MwDIbvSPyHyPfV3ZAQQkt3QUi7IVR+gEncD7WNoyQb3b8nHBBUGoMDR3+9fvzK2908jerIIfbiNKyLEhQ7I7Z3rYaX+nF1ByomcpZGcazhxBF21fXV9plHSnkodr2PKqu4qKFLyd8jRtPxRLEQzy5XGgkTpRyGFj2ZgVrGTVneYviuAdVCU+2thrC3N6Dqk8+bf9eWpukNP4g5TOzSmRXIc2Jn2a58yGwh9fkaVVNoOWmwYp5yOiJ5X2RswPNEm78T/XwtTpzIUiI0Evgyz0fHJaD1f1q0NPHLnXnENwnDq8jwyYKLH6jeAQAA//8DAFBLAwQUAAYACAAAACEAMEZWt7QCAACXBgAADwAAAHhsL3dvcmtib29rLnhtbKRVbW+bMBD+Pmn/wfJ3apsAIahJtTRBq9RW1Zq1HysXTGIVMDKmoar633cmIVmWaYo6BDb2nZ977oXj/KItcvQqdC1VOcbsjGIkykSlslyO8c9F7IQY1YaXKc9VKcb4TdT4YvL1y/la6ZdnpV4QAJT1GK+MqSJC6mQlCl6fqUqUIMmULriBpV6SutKCp/VKCFPkxKU0IAWXJd4gRPoUDJVlMhEzlTSFKM0GRIucG6Bfr2RV92hFcgpcwfVLUzmJKiqAeJa5NG8dKEZFEl0tS6X5cw5ut8xHrYY7gIdRGNzeEoiOTBUy0apWmTkDaLIhfeQ/o4SxgxC0xzE4DckjWrxKm8MdKx18klWwwwr2YIz+NxqD0upqJYLgfRLN33Fz8eQ8k7l42JQu4lV1ywubqRyjnNdmnkoj0jEewlKtxX7Dw0g31bSROUhdz2MMk8munO80SkXGm9wsoJB7ePgygmDk+laz1VEf7DujEbxfza7B4D1/BfPgZLqtzivAD5/e599o6HnewBnOhzPHYy5zpkHgOfPAi6k//OZeDrwPCI0OokTxxqy2LlnMMfaA/5Hohre9hNGokene/jvdXo6d/xh62Yf1w368D1Ks673zdonaR1mmam1jA8689StGfYzWnehRpmYFIfHC/d53IZcr4BvSLs/atbTG+IDObEMnhsuxwwEd8hufrkcAr25GZZfXe9s3GDQjO9vQwruOrA19lXYpJP2xhOcJ5NFOneKIUTe0LovWXNemm1GjJdCb+uGUDkau48UshuSMqDOdQnL8WTzwh2x2Ofdjmxzb46LWImafLN2QdKcFN42GHgp11K0jO8bb3d1mttnYun7QA6Ifs64KN6f/pXgPPTwXJyrHDycqXt7eLG5O1L2eL54eY6tM/uotgYSArE8L6f8pk18AAAD//wMAUEsDBBQABgAIAAAAIQCNh9pw4AAAAC0CAAAaAAgBeGwvX3JlbHMvd29ya2Jvb2sueG1sLnJlbHMgogQBKKAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACskctqwzAQRfeF/oOYfT12CqWUyNmUQrbF/QAhjx/EloRmktZ/X+GC3UBINtkIrgbdcyRtdz/joE4UufdOQ5HloMhZX/eu1fBVfTy9gmIxrjaDd6RhIoZd+fiw/aTBSDrEXR9YpRbHGjqR8IbItqPRcOYDuTRpfByNpBhbDMYeTEu4yfMXjP87oDzrVPtaQ9zXz6CqKSTy7W7fNL2ld2+PIzm5gECWaUgXUJWJLYmGv5wlR8DL+M098ZKehVb6HHFei2sOxT0dvn08cEckq8eyxThPFhk8++TyFwAA//8DAFBLAwQUAAYACAAAACEA6eHjsNoBAACNAwAAGAAAAHhsL3dvcmtzaGVldHMvc2hlZXQxLnhtbAAAAP//AAAA//+ckktrwzAMgO+D/Qfje+s4bccakpbBKOtt7HV3HCUx9SPYTh+M/fc56doOcik1fsrWJ8lSutwribZgnTA6w3QcYQSam0LoKsOfH6vRI0bOM10waTRk+AAOLxf3d+nO2I2rATwKBO0yXHvfJIQ4XoNibmwa0OGmNFYxH462Iq6xwIpeSUkSR9EDUUxofCQk9hqGKUvB4dnwVoH2R4gFyXzw39WicSea4tfgFLObthlxo5qAyIUU/tBDMVI8WVfaWJbLEPeeThlHext6HMbkZKaXDywpwa1xpvTjQCZHn4fhz8mcMH4mDeO/CkOnxMJWdAm8oOLbXKKzMyu+wCY3wh7OsO67bNKKIsPf0V8bhZV2U3SZTnc/eJEWImS4iwpZKDP8RDFZpH3xfAnYuX975Fn+DhK4h2CAYtTVZm7Mpnu4DqKoUyUD3VVfm68WFVCyVvo3s3sBUdU+QGZB5RcAAP//AAAA//+yKc5ITS1xSSxJ1LcDAAAA//8AAAD//7IpSExP9U0sSs/MK1bISU0rsVUy0DNXUijKTM+AsUvyC8CipkoKSfklJfm5MF5GamJKahGIZ6ykkJafXwLj6NvZ6JfnF2UXZ6SmltgBAAAA//8DAFBLAwQUAAYACAAAACEAwRcQvk4HAADGIAAAEwAAAHhsL3RoZW1lL3RoZW1lMS54bWzsWc2LGzcUvxf6Pwxzd/w1448l3uDPbJPdJGSdlBy1tuxRVjMykrwbEwIlOfVSKKSll0JvPZTSQAMNvfSPCSS06R/RJ83YI63lJJtsSlp2DYtH/r2np/eefnrzdPHSvZh6R5gLwpKWX75Q8j2cjNiYJNOWf2s4KDR8T0iUjBFlCW75Cyz8S9uffnIRbckIx9gD+URsoZYfSTnbKhbFCIaRuMBmOIHfJozHSMIjnxbHHB2D3pgWK6VSrRgjkvhegmJQe30yISPsDZVKf3upvE/hMZFCDYwo31eqsSWhsePDskKIhehS7h0h2vJhnjE7HuJ70vcoEhJ+aPkl/ecXty8W0VYmROUGWUNuoP8yuUxgfFjRc/LpwWrSIAiDWnulXwOoXMf16/1av7bSpwFoNIKVprbYOuuVbpBhDVD61aG7V+9Vyxbe0F9ds7kdqo+F16BUf7CGHwy64EULr0EpPlzDh51mp2fr16AUX1vD10vtXlC39GtQRElyuIYuhbVqd7naFWTC6I4T3gyDQb2SKc9RkA2r7FJTTFgiN+VajO4yPgCAAlIkSeLJxQxP0AiyuIsoOeDE2yXTCBJvhhImYLhUKQ1KVfivPoH+piOKtjAypJVdYIlYG1L2eGLEyUy2/Cug1TcgL549e/7w6fOHvz1/9Oj5w1+yubUqS24HJVNT7tWPX//9/RfeX7/+8OrxN+nUJ/HCxL/8+cuXv//xOvWw4twVL7598vLpkxffffXnT48d2tscHZjwIYmx8K7hY+8mi2GBDvvxAT+dxDBCxJJAEeh2qO7LyAJeWyDqwnWw7cLbHFjGBbw8v2vZuh/xuSSOma9GsQXcY4x2GHc64Kqay/DwcJ5M3ZPzuYm7idCRa+4uSqwA9+czoFfiUtmNsGXmDYoSiaY4wdJTv7FDjB2ru0OI5dc9MuJMsIn07hCvg4jTJUNyYCVSLrRDYojLwmUghNryzd5tr8Ooa9U9fGQjYVsg6jB+iKnlxstoLlHsUjlEMTUdvotk5DJyf8FHJq4vJER6iinz+mMshEvmOof1GkG/CgzjDvseXcQ2kkty6NK5ixgzkT122I1QPHPaTJLIxH4mDiFFkXeDSRd8j9k7RD1DHFCyMdy3CbbC/WYiuAXkapqUJ4j6Zc4dsbyMmb0fF3SCsItl2jy22LXNiTM7OvOpldq7GFN0jMYYe7c+c1jQYTPL57nRVyJglR3sSqwryM5V9ZxgAWWSqmvWKXKXCCtl9/GUbbBnb3GCeBYoiRHfpPkaRN1KXTjlnFR6nY4OTeA1AuUf5IvTKdcF6DCSu79J640IWWeXehbufF1wK35vs8dgX9497b4EGXxqGSD2t/bNEFFrgjxhhggKDBfdgogV/lxEnatabO6Um9ibNg8DFEZWvROT5I3Fz4myJ/x3yh53AXMGBY9b8fuUOpsoZedEgbMJ9x8sa3pontzAcJKsc9Z5VXNe1fj/+6pm014+r2XOa5nzWsb19vVBapm8fIHKJu/y6J5PvLHlMyGU7ssFxbtCd30EvNGMBzCo21G6J7lqAc4i+Jo1mCzclCMt43EmPycy2o/QDFpDZd3AnIpM9VR4MyagY6SHdSsVn9Ct+07zeI+N005nuay6mqkLBZL5eClcjUOXSqboWj3v3q3U637oVHdZlwYo2dMYYUxmG1F1GFFfDkIUXmeEXtmZWNF0WNFQ6pehWkZx5QowbRUVeOX24EW95YdB2kGGZhyU52MVp7SZvIyuCs6ZRnqTM6mZAVBiLzMgj3RT2bpxeWp1aaq9RaQtI4x0s40w0jCCF+EsO82W+1nGupmH1DJPuWK5G3Iz6o0PEWtFIie4gSYmU9DEO275tWoItyojNGv5E+gYw9d4Brkj1FsXolO4dhlJnm74d2GWGReyh0SUOlyTTsoGMZGYe5TELV8tf5UNNNEcom0rV4AQPlrjmkArH5txEHQ7yHgywSNpht0YUZ5OH4HhU65w/qrF3x2sJNkcwr0fjY+9AzrnNxGkWFgvKweOiYCLg3LqzTGBm7AVkeX5d+JgymjXvIrSOZSOIzqLUHaimGSewjWJrszRTysfGE/ZmsGh6y48mKoD9r1P3Tcf1cpzBmnmZ6bFKurUdJPphzvkDavyQ9SyKqVu/U4tcq5rLrkOEtV5Srzh1H2LA8EwLZ/MMk1ZvE7DirOzUdu0MywIDE/UNvhtdUY4PfGuJz/IncxadUAs60qd+PrK3LzVZgd3gTx6cH84p1LoUEJvlyMo+tIbyJQ2YIvck1mNCN+8OSct/34pbAfdStgtlBphvxBUg1KhEbarhXYYVsv9sFzqdSoP4GCRUVwO0+v6AVxh0EV2aa/H1y7u4+UtzYURi4tMX8wXteH64r5c2Xxx7xEgnfu1yqBZbXZqhWa1PSgEvU6j0OzWOoVerVvvDXrdsNEcPPC9Iw0O2tVuUOs3CrVyt1sIaiVlfqNZqAeVSjuotxv9oP0gK2Ng5Sl9ZL4A92q7tv8BAAD//wMAUEsDBBQABgAIAAAAIQBdXZmTlgIAAD0GAAANAAAAeGwvc3R5bGVzLnhtbKRUW2vbMBR+H+w/CL27st04i4PtsjQ1FLoxSAd7VWw5EdMlSEpwNvbfd2Q7iUPHNtoX6+j46DvfuWZ3rRTowIzlWuU4ugkxYqrSNVebHH99LoMZRtZRVVOhFcvxkVl8V7x/l1l3FGy1ZcwhgFA2x1vndnNCbLVlktobvWMK/jTaSOrgajbE7gyjtfWPpCBxGE6JpFzhHmEuq/8BkdR83++CSssddXzNBXfHDgsjWc0fN0obuhZAtY0mtEJtNDUxas3JSad94UfyymirG3cDuEQ3Da/YS7opSQmtLkiA/DqkKCFhfBV7a16JNCGGHbgvHy6yRitnUaX3ykExB0WR2R/oQAVoIkyKrNJCG+SgSpCkTqOoZL3FPRV8bbg3a6jk4tirY6/oCjvYSQ5p9kriXQ6HhUdciDOB2BMARZFBpRwzqoQLGuTn4w7cK2iqHqaz+4f1xtBjFCejB6RzWGRrbWpo4nHovarIBGscEDV8s/Wn0zv4rrVzUOgiqzndaEWFD+X0YhAgnIoJsfKN/q25wm4bpPaylO6xzjGMjE/CSYRABrHH6y8ef4zWY78ZFrXNNT4gjmhfkT67R77eOf7sJ1NANw8QaL3nwnH1B8KAWbeXFIS+As5PWZecsxfIRM0auhfu+fwzxxf5E6v5XsZnqy/8oF0HkeOL3Ful3gdr3ZOF9oIT7Q3P8c+HxYd0+VDGwSxczILJLUuCNFksg2Ryv1guyzSMw/tfo1l/w6R3q6nIYGHMrYB9YIZghxBXF12OR5cn32jdWBGgPeaextPwYxKFQXkbRsFkSmfBbHqbBGUSxcvpZPGQlMmIe/LKjRCSKOp3iyefzB2XTHB1qtWpQmMtFAmufwnCh9JVglz2fvEbAAD//wMAUEsDBBQABgAIAAAAIQB/JspIhgEAABYDAAARAAgBZG9jUHJvcHMvY29yZS54bWwgogQBKKAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACUUk1P4zAQvSPtf4h8T520iI+oDdLuihNIK1G0K25mPBRDYlv2lNB/v5M4pC3iws1v3punmedZXr23TfaGIRpnV6KcFSJDC04bu1mJ+/V1fiGySMpq1TiLK7HDKK7qHydL8BW4gH+C8xjIYMzYycYK/Eo8E/lKygjP2Ko4Y4Vl8smFVhHDsJFewavaoJwXxZlskZRWpGRvmPvJUYyWGiZLvw3NYKBBYoMtWoqynJVyryUMbfyyYWAOlK2hneedxnEPvTUkclK/RzMJu66bdYthDJ6/lP9ub+6GVXNj+6wARb3UUJGhBuul3D/5FbePLwiUyhNgAgIqciERE+CYX3HXuaAjM0eIezRGCMYTf17qOyqwulGRbvk3nwzqn7vk8LnGsoBvpr+AJNgjDUNmaTbUGadQpcw+mL+LX7/X16KeF/MyLy7y8nJdnFenRTU/f+g3P+rvU0mFdpzpO46niwPHD4N6OERFuHFh3A8mNNyoJT6SO1K0HRME90Xp8JLr/wAAAP//AwBQSwMEFAAGAAgAAAAhAB+bXYvvAAAAigEAABAACAFkb2NQcm9wcy9hcHAueG1sIKIEASigAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAnJBNT8MwDIbvSPyHKPc1GUgTmtJM40tcJjiM3aPU7SJaO0rC1P57DBMFceRm+7Ufv7bZjEMvTpByIKzlstJSAHpqAna1fN0/Lm6kyMVh43pCqOUEWW7s5YV5SRQhlQBZMAJzLY+lxLVS2R9hcLliGVlpKQ2ucJo6RW0bPNyTfx8Ai7rSeqVgLIANNIs4A+WZuD6V/0Ib8p/+8mE/RTZszTbGPnhX+Eq7Cz5RpraIh9FDL56xDwhG/e4xO4eug2SNmqM7GqLDiUtz9MT4xNNvty4DC39yJh7Or7XLVaWvtf7a8l0z6ueJ9gMAAP//AwBQSwECLQAUAAYACAAAACEAdqZsbk4BAAAIBAAAEwAAAAAAAAAAAAAAAAAAAAAAW0NvbnRlbnRfVHlwZXNdLnhtbFBLAQItABQABgAIAAAAIQC1VTAj9AAAAEwCAAALAAAAAAAAAAAAAAAAAIcDAABfcmVscy8ucmVsc1BLAQItABQABgAIAAAAIQAwRla3tAIAAJcGAAAPAAAAAAAAAAAAAAAAAKwGAAB4bC93b3JrYm9vay54bWxQSwECLQAUAAYACAAAACEAjYfacOAAAAAtAgAAGgAAAAAAAAAAAAAAAACNCQAAeGwvX3JlbHMvd29ya2Jvb2sueG1sLnJlbHNQSwECLQAUAAYACAAAACEA6eHjsNoBAACNAwAAGAAAAAAAAAAAAAAAAACtCwAAeGwvd29ya3NoZWV0cy9zaGVldDEueG1sUEsBAi0AFAAGAAgAAAAhAMEXEL5OBwAAxiAAABMAAAAAAAAAAAAAAAAAvQ0AAHhsL3RoZW1lL3RoZW1lMS54bWxQSwECLQAUAAYACAAAACEAXV2Zk5YCAAA9BgAADQAAAAAAAAAAAAAAAAA8FQAAeGwvc3R5bGVzLnhtbFBLAQItABQABgAIAAAAIQB/JspIhgEAABYDAAARAAAAAAAAAAAAAAAAAP0XAABkb2NQcm9wcy9jb3JlLnhtbFBLAQItABQABgAIAAAAIQAfm12L7wAAAIoBAAAQAAAAAAAAAAAAAAAAALoaAABkb2NQcm9wcy9hcHAueG1sUEsFBgAAAAAJAAkAPgIAAN8cAAAAAA=="}),define("DS/SwymUIComponents/script/feature/core/user/view/summary/user-summary-edit-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/user/model/user-model","DS/UIKIT/Input/Text","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/user-summary-edit-view","DS/UIKIT/Form","DS/WebappsUtils/Console"],function(e,t,i,n,o,s,a){"use strict";return t.extend({_modelClass:i,name:"user-summary-edit-view",_createContent:function(){var e=this.model;return this.addControl("form-aboutme",new s({fields:[{type:"textarea",id:"user-summary",multiline:!0,placeholder:o.placeholder,rows:10,value:e.get("tenant_more_about_me",{escapeHTML:!1})||"",events:{onChange:function(){e.addChanges("user_infos",this.getValue())}}}]}))}})}),define("DS/SwymUIComponents/script/feature/core/link/view/link-edit-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/link/view/link-edit-view","DS/SwymUICore/script/feature/core/link/model/link-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/UIKIT/Form"],function(e,t,i,n,o){"use strict";return n.extend({_modelClass:i,name:"link-edit-view",_createContent:function(){var i=this.model,n=this,s=this.addControl("form-aboutme",new o({fields:[{type:"url",label:t.url,name:"link-url",placeholder:t.enteranURL,required:!0,value:i.get("url",{escapeHTML:!1}),events:{onChange:function(){i.addChanges("url",this.getValue());var o=n.model.getTypeFromUrl(),s=n.getControl("form-aboutme"),a=s.getInput("type"),r=s.getInput("title");if(o&&s){if(a&&a.getValue()[0]!==o&&(//!=type is here to prevent a uikit bug, when we do same select twice , the input is fucked up
a.setValue(o),a.setDisabled(!0)),r){var l=t.title+" "+this.getValue();r.setValue(l),n.model.addChanges("title",l)}}else a&&"0"!==a.getValue()[0]&&(a.setValue("0"),a.setDisabled(!1));if(n.model.isSocialUrl()&&r){l=t.title+" "+this.getValue();r.setValue(l),n.model.addChanges("title",l)}s.validate(!0);s.getInput("link-url").focus();var c=n.container.getElement(".form-group"),d=e.createElement("div",{class:"url-example",html:t.urlErrorMessage}),m=c.getElement(".url-example");c&&!m?(d.inject(c),c.hasClassName("has-error")||d.hide()):c.hasClassName("has-error")?m.show():m.hide(),n._hideAndShowProperInputs()},onKeyDown:function(e){9!==(e.keyCode||e.which)&&setTimeout(function(){this.dispatchEvent("onChange")}.bind(this),50)}}},{type:"select",required:!0,name:"type",label:t.type,placeholder:t.selectyourwebsite,options:[{value:"0",selected:"0"===i.get("type"),label:t.other},{value:"1",selected:"1"===i.get("type"),label:"Facebook"},{value:"2",selected:"2"===i.get("type"),label:"Linkedin"},{value:"3",selected:"3"===i.get("type"),label:"Viadeo"},{value:"4",selected:"4"===i.get("type"),label:"Youtube"},{value:"5",selected:"5"===i.get("type"),label:"Certification"},{value:"6",selected:"6"===i.get("type"),label:"Flickr"},{value:"7",selected:"7"===i.get("type"),label:"Google+"},{value:"8",selected:"8"===i.get("type"),label:"Twitter"}],events:{onChange:function(){var e=i.isSocialLink();if(i.addChanges("type",this.getValue()[0]),e!==i.isSocialLink()){var t=n.getControl("form-aboutme");t&&t.getInput("title").setValue("")}n._hideAndShowProperInputs()}}},{type:"text",label:t.title,name:"title",required:!0,value:i.get("title",{escapeHTML:!1}),events:{onChange:function(){i.addChanges("title",this.getValue()),n._hideAndShowProperInputs()}}},{type:"textarea",label:t.description,rows:5,value:i.get("description",{escapeHTML:!1}),events:{onChange:function(){i.addChanges("description",this.getValue()),n._hideAndShowProperInputs()}}}]}));return this._hideAndShowProperInputs(),s},_hideAndShowProperInputs:function(){var e=this.getControl("form-aboutme");if(e){var t=e.elements.container.getElements(".form-group"),i=(t[0],t[1]),n=t[2],o=t[3],s=this.model,a=s.getChanges("url")||s.get("url",{escapeHTML:!1});s.getChanges("type")||s.get("type"),s.getChanges("description")||s.get("description");a?(i.show(),s.isSocialLink()?(n.hide(),e.getInput("title").setValue(""+a),o.hide()):(n.show(),o.show())):(i.hide(),n.hide(),o.hide())}}})}),define("DS/SwymUIComponents/script/lib/ckeditor/ckeditor-command-creator",["i18n!DS/SwymUIComponents/assets/nls/lib/ckeditor/ckeditor"],function(e){return{commandList:{h1Style:{command:"h1Command",toolbar:"paragraph",label:e.Heading1,style:"h1",type:"style"},h2Style:{command:"h2Command",toolbar:"paragraph",label:e.Heading2,style:"h2",type:"style"},formattedStyle:{command:"formattedCommand",toolbar:"paragraph",label:e.FormattedStyle,style:"pre",type:"style"},BulletedListStyle:{command:"BulletedListCommand",toolbar:"paragraph",ckCommand:"bulletedlist",label:e.BulletList,style:"ul",type:"command"},NumberedListStyle:{command:"NumberedListCommand",ckCommand:"numberedlist",toolbar:"paragraph",label:e.NumberedList,style:"ol",type:"command"},BlockquoteStyle:{command:"BlockquoteCommand",toolbar:"paragraph",ckCommand:"blockquote",label:e.BlockQuote,style:"blockquote",type:"command"}},createCommand(){var e=this;Object.keys(e.commandList).forEach(t=>CKEDITOR.plugins.add(t,{init(t){var{name:i}=this;t.addCommand(e.commandList[i].command,{contextSensitive:!0,exec(t,n){n||Object.keys(t.toolbar).forEach(n=>{if(Object.hasOwn(t.toolbar[n],"name")&&Object.hasOwn(t.toolbar[n],"items")&&"paragraph"===t.toolbar[n].name){const{items:o}=t.toolbar[n];Object.keys(o).forEach(n=>{Object.hasOwn(o[n],"type")&&"button"===o[n].type&&o[n].getState()===CKEDITOR.TRISTATE_ON&&o[n].command!==e.commandList[i].command&&t.execCommand(o[n].command,!0)})}}),this.state===CKEDITOR.TRISTATE_ON?("command"===e.commandList[i].type?t.execCommand(e.commandList[i].ckCommand):t.removeStyle(new CKEDITOR.style({element:e.commandList[i].style})),this.setState(CKEDITOR.TRISTATE_OFF)):("command"===e.commandList[i].type?t.execCommand(e.commandList[i].ckCommand):t.applyStyle(new CKEDITOR.style({element:e.commandList[i].style})),this.setState(CKEDITOR.TRISTATE_ON))},refresh(t,n){var o=n;o.block&&o.block.getName()&&("p"!==(o=o.block.getName())&&"li"!==o||(o=n.block.getParent().getName()),o===e.commandList[i].style?this.setState(CKEDITOR.TRISTATE_ON):this.setState(CKEDITOR.TRISTATE_OFF))}}),t.ui.addButton(e.commandList[i].command,{label:e.commandList[i].label,command:e.commandList[i].command,toolbar:e.commandList[i].toolbar})}}))}}}),define("DS/SwymUIComponents/script/feature/community/content/view/community-content-overlay-view",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/W3DXComponents/Views/Layout/ScrollView","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/utils/utils","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/view/abstract-content-view"],function(e,t,i,n,o,s,a,r){"use strict";var l=s.getInstance();return i.extend({_delegateSpriteReloadToParentView:!1,name:"content-overlay-view",className:"fade-in-animation",imageReloadOptions:{size:"xl"},_lastScrollPosition:{x:0,y:0},defaultOptions:{itemView:null,ContentListClass:"DS/SwymUIComponents/script/feature/community/content/view/content-list-view",MediaEditViewClass:"DS/SwymUIComponents/script/feature/community/media/view/shared-lightbox-edit-view",MediaViewClass:"DS/SwymUIComponents/script/feature/community/media/view/shared-lightbox-view",addBackArrow:!0},_onContextChange:function(){var t=this;if(l.isContentContext()){let i=this.getModuleNameAndContentType(),o=i.ModelName,s=i.ContentType;"media"===s||l.mediaId?(this.defaultContentListClass||(this.defaultContentListClass=this.getOption("ContentListClass")),l.isContentEditionContext()?this.setOption("ContentListClass",this.getOption("MediaEditViewClass")):this.setOption("ContentListClass",this.getOption("MediaViewClass"))):this.defaultContentListClass&&this.setOption("ContentListClass",this.defaultContentListClass),require([o,this.getOption("ContentListClass"),"DS/SwymUICore/script/feature/community/media/model/media-model"],function(i,o,r){if(l.isContentContext()&&!t.isDestroyed()){var c=new i({mid:l.contentId,community_id:l.communityId}),d=t.getChildView("backArrowView");if(l.isContentEditionContext()?t.container&&t.container.addClassName("edit-mode"):t.container&&t.container.removeClassName("edit-mode"),"media"===s||l.mediaId){let i=new n;if(l.mediaId)var m=new r({mid:l.mediaId,community_id:l.communityId});if(c.get("thumbnails_infos")){e.createElement("div",{html:c.get("content")}).getElements("img[data-media-id]").forEach(function(e){let t=new r({mid:e.dataset.mediaId,community_id:l.communityId});i.add(t)})}var u,h;if(window&&"3DD"===window.ds.env)t._widget.getAppName()===a.getContentReaderAppKey()?(u=e.extendElement(document.body).getElement(".content-overlay-view-container"),""===l.previousAttributes.path&&(h=!0),d&&d.show()):u=e.extendElement(document.body).getElement(".layout-im-view-container");if(t.removeChildView("mediaView"),t.getChildView("mediaView"))t.getChildView("mediaView")&&t.getChildView("mediaView").model.get("mid")!==c.get("mid")&&(t.getChildView("mediaView").setModel(c),t.getChildView("mediaView").render());else{let e="0"===c.get("published"),n=m?m.get("media_type"):c.get("media_type");t.addChildView("mediaView",{Class:o,collection:i||void 0,model:m||c,contentModel:m?c:void 0,isAutoplayActivated:!0,elementToInjectIn:u,hideCloseIcon:h,editProperties:e}),t.getChildView("mediaView").render(),l.dataAnnotation&&!l.isContentEditionContext()&&"document"===n&&t.getChildView("mediaView").loadAnnotation(l.dataAnnotation)}}else{var p=t.getChildView("itemView"),g=t._widget.getAppName()===a.getContentReaderAppKey(),w=l&&l.isContentContext()&&"wiki"===s,C=l.commentUri||l.replyUri||l.answerUri;c=new i({mid:l.contentId,community_id:l.communityId}),p&&c.equals(p.model)&&!C||(w?(p&&"wiki"===p.model.getModelName()&&c.get("mid")?(t.getChildView("itemView").removeChildView("editView"),t.getChildView("itemView").setModel(c)):p=t.createItemView(o.prototype.createItemView(c)),(window.ds&&!0===window.ds.swymIM||g)&&t.listenTo(p,"onScrollToElement",function(e){t.getControl("scrollView")&&t.getControl("scrollView").scroller&&t.getControl("scrollView").scroller.scrollToElement(e)})):(t.container&&t.container.empty(),p=t.createItemView(o.prototype.createItemView(c)))),p&&(l.isContentEditionContext()?p.switchToEditView(!0):p.switchToDetailedView(!0)),t.isRendered()?t.container.contains(p.container)||(t.refresh(),t.getChildView("itemView").refresh()):t.render(),w||l.isContentEditionContext()?d&&d.hide():d&&d.show()}}})}},getModuleNameAndContentType:function(){return{ModelName:t.getModuleNameFromModelName(l.contentType),ContentType:l.contentType}},createMediaView:function(e){return this.addChildView("mediaView",e)},createItemView:function(e){var t=e;l.isContentEditionContext()?t.options.mode=t.MODES.EDIT:t.options.mode=t.MODES.DETAILED;var i=this.addChildView("itemView",t);return this.addControl("scrollView",new o({view:i,useInfiniteScroll:!1,usePullToRefresh:!1})),i},setup:function(){this._parent.apply(this,arguments),this._onContextChange=this._onContextChange.bind(this),!1!==this.getOption("addBackArrow")&&(this._widget.getAppName()===a.getContentReaderAppKey()?l.previousAttributes.path&&this.addChildView("backArrowView",{Class:"DS/SwymUIComponents/script/feature/core/ui-components/back-arrow-view",model:this.model,backArrowText:r.ContentList}):this.addChildView("backArrowView",{Class:"DS/SwymUIComponents/script/feature/core/ui-components/back-arrow-view",model:this.model})),!0===l.addListener("onContextChange",this._onContextChange,this,!0)&&this._onContextChange()},_createContent:function(){var e=l&&l.isContentContext()&&"wiki"===l.contentType||l.isContentEditionContext(),t=this.getChildView("backArrowView"),i=this.getControl("scrollView");return e&&t&&t.hide(),[t||"",i||"",this.addChildView("backToTopView",{Class:"DS/SwymUIComponents/script/feature/core/ui-components/layout/back-to-top-view",manager:this})]},onRedraw:function(){var e=this.getControl("scrollView");e&&"function"==typeof e.render?(e.render(),this.listenTo(e.scroller.elements.content,"scroll",this.onScroll.bind(this))):this.getChildView("mediaView")&&this.getChildView("mediaView").render()},onScrollToTopRequest:function(e){this.getControl("scrollView")&&this.getControl("scrollView").scroller.scrollTo(0,0,e||0)},onScroll:function(){var e=this.getChildView("backToTopView"),t=this.getControl("scrollView").scroller.getPosition(),i={position:t,delta:{x:t.x-this._lastScrollPosition.x,y:t.y-this._lastScrollPosition.y}};0===t.y?(this.container.addClassName("scroll-to-top"),e.hide()):(this.container.removeClassName("scroll-to-top"),i&&i.delta.y<0&&-1*t.y>document.body.getSize().height&&e.show()),this._lastScrollPosition=t},onUnMaximize:function(){var e=this.getChildView("itemView");e&&(this.container.empty(),e.destroy())},destroy:function(){return l.removeListener("onContextChange",this._onContextChange),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/core/user/view/idcard/user-idcard-edit-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/UIKIT/Form","DS/WebappsUtils/Console","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/idcard/user-idcard-edit-view"],function(e,t,i,n,o){"use strict";return t.extend({name:"user-idcard-edit-view",_createContent:function(){var t=this.model,n=t.getPassportAttributeConstraints("first_name"),s=t.getPassportAttributeConstraints("last_name");return[this.addControl("idcard1-form",new i({className:"inline",fields:[e.merge({type:"text",label:o.firstName,placeholder:o.firstName,value:t.get("first_name")?t.get("first_name").unescapeHTML():"",events:{onChange:function(){t.addChanges("first_name",this.getValue(),{force:!0})}}},n),e.merge({type:"text",label:o.lastName,placeholder:o.lastName,value:t.get("last_name")?t.get("last_name").unescapeHTML():"",events:{onChange:function(){t.addChanges("last_name",this.getValue(),{force:!0})}}},s)]}))]}})}),define("DS/SwymUIComponents/script/feature/community/wedo/view/wedo-change-status-view",["UWA/Core","DS/SwymUICore/script/feature/community/wedo/model/wedo-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/wedo/view/wedo-detailed-view","i18n!DS/SwymUICore/assets/nls/lib/model/generic/community-content","DS/SwymUICore/script/utils/date","DS/UIKIT/Input/Date"],function(e,t,i,n,o,s,a){"use strict";return i.extend({_modelClass:t,name:"wedo-change-status-view",_modelEvents:{onSync:"refresh"},_maturityId:null,_estimatedEndDate:null,defaultOptions:{onlyDatePicker:!1,mode:"read"},domEvents:{"click .status-container:nth-child(1)":"_onTodoClick","click .status-container:nth-child(2)":"_onInProgressClick","click .status-container:nth-child(3)":"_onDoneClick","click .fonticon-calendar":"_onPlannedEndDateClick","click .link-date":"_onPlannedEndDateClick","click .mobile-set-a-date":"_onPlannedEndDateClick"},_onTodoClick:function(){this._saveNewMaturity(t.maturityConstants.OPEN_MATURITY)},_onInProgressClick:function(){this._saveNewMaturity(t.maturityConstants.IN_PROGRESS_MATURITY)},_onDoneClick:function(){this._saveNewMaturity(t.maturityConstants.DONE_MATURITY)},_saveNewMaturity:function(e){this._canEditWedo()&&("edit"===this.getOption("mode")?(this._setMaturityId(e),this.refresh()):(this.mask(),this.model.save({maturity:e},{onComplete:function(){this.unmask()}.bind(this)})))},_indexActivated:0,_canEditWedo:function(){var e=this.model;return!e||e.get("_acl")&&e.get("_acl").update&&e.get("_acl").update.access},_generateHTMLForStatus:function(e,t,i){return{class:"status-container"+(i===this._indexActivated?" activated":"")+(i<this._indexActivated?" before-activated":"")+(this._canEditWedo()?" can-edit-wedo":""),html:[{tag:"span",class:"fonticon fonticon-"+e},{html:t}]}},getMaturityId:function(){return this.model?this.model.getChanges("maturityId")||this.model.get("maturityId"):this._maturityId},_setMaturityId:function(e){this.model?this.model.addChanges({maturityId:e}):this._maturityId=e},getEstimatedEndDate:function(){return this.model?this.model.getChanges("estimatedEndDate")||this.model.get("estimatedEndDate"):this._estimatedEndDate},setEstimatedEndDate:function(e,t){this.model?this.model.addChanges({estimatedEndDate:e}):(this._estimatedEndDate=e,this._refresh()),this.dispatchEvent("estimatedEndDateSet",[e,t])},resetContent:function(){this.model?(this.model.removeChanges("estimatedEndDate"),this.model.removeChanges("maturityId")):(this._setMaturityId(t.maturityConstants.OPEN_MATURITY),this.setEstimatedEndDate("")),this.refresh()},_setIndexActivated:function(){var e=this.getMaturityId(),i=t.maturityConstants;e===i.OPEN_MATURITY?this._indexActivated=0:e===i.IN_PROGRESS_MATURITY?this._indexActivated=1:e===i.DONE_MATURITY&&(this._indexActivated=2)},_getDateIcon:function(){return[{tag:"span",class:"end-date-label-open",html:n.PlannedEnd},{tag:"span",class:"fonticon fonticon-calendar"},{tag:"a",class:"mobile-set-a-date",html:n.PlannedEnd}]},_onPlannedEndDateClick:function(e){if(this._canEditWedo()){var t=this.getElement(".estimated-end-date"),i=this.getEstimatedEndDate();t&&!1===this.getOption("onlyDatePicker")&&t.addClassName("end-date-input-open"),i?this._showInputDatePicker(e,t):setTimeout(function(){this._showInputDatePicker(e,t)}.bind(this),300)}},_showInputDatePicker:function(e,t){var i=this.getControl("input-end-date");i&&(i.elements.picker.show(),i.elements.picker.onHide=function(){t.removeClassName("end-date-input-open")},e.stopPropagation())},_onNewDateIsSelected:function(){var e=this.getControl("input-end-date"),t=e&&e.getDate();e&&("edit"===this.getOption("mode")?(this.setEstimatedEndDate(t),this._refresh()):(this.mask(),this.model.save({plannedEnd:t},{onComplete:function(){this.unmask()}.bind(this)})))},_createContent:function(){var e=this.getEstimatedEndDate(),t=!0===this.getOption("onlyDatePicker");return this._setIndexActivated(),[t?"":this._generateHTMLForStatus("clipboard",o.TODO,0),t?"":this._generateHTMLForStatus("tools",o.InProgress,1),t?"":this._generateHTMLForStatus("check",o.Done,2),{tag:"span",class:"estimated-end-date "+(e?"date-is-defined":"")+(this._canEditWedo()?" can-edit-wedo":""),html:[this.addControl("input-end-date",new a({min:new Date,value:e,events:{onChange:function(){this._onNewDateIsSelected()}.bind(this)}})),e?'<span class="end-date-label">'+n.PlannedEnd+'</span><a class="link-date">'+s.conciseDay(e)+"</a>":this._getDateIcon()]}]}})}),define("DS/SwymUIComponents/script/utils/scrollview-utils",["UWA/Core"],function(e){"use strict";var t={},i=function(t,i){var n=i||{};t=t||1,e.is(this.getFilteringOptions,"function")&&e.merge(n,this.getFilteringOptions(this.taggerFilters,this.exaleadFilters,{data:"filter"===this.lastCalledService?{query:this.exaleadQuery}:{}})),this.fetchPage(t,n)};return t.onInfiniteScroll=function(){var t,n=this,o=this.collection,s=o.getCurrentPage(),a=null===s?1:s+1,r=n&&n.constructor===Object?n.options:null,l=r&&r.hasNext?r.hasNext:"hasNext",c=r&&r.endLoading?r.endLoading:"endLoading",d=r&&r.useInfiniteScroll?r.useInfiniteScroll:"useInfiniteScroll";o[l]()?((t=e.extend({reset:!1,add:!0,remove:!1},r||{})).onComplete=function(){n.container&&n.container.removeClassName("hidden-empty-view"),n.scrollView&&n.scrollView.scroller&&o.addEventOnce("onSync",function(){o[l]()?(n.scrollView[c](),n.scrollView[d](!0)):n.scrollView[d](!1)}),r&&r.onComplete&&r.onComplete.apply(o,arguments)},t.onFailure=function(){n.container&&n.container.removeClassName("hidden-empty-view"),n.scrollView&&n.scrollView.scroller&&n.scrollView[d](!1),r&&r.onFailure&&r.onFailure.apply(o,arguments)},i.call(o,a,t)):(n.container&&n.container.removeClassName("hidden-empty-view"),n.scrollView&&n.scrollView.scroller&&(o.hasBeenFetched()?n.scrollView[d](!1):o.addEventOnce("onSync",function(){o[l]()?(n.scrollView[c](),n.scrollView[d](!0)):n.scrollView[d](!1)})))},t.fetchWithSavedFilters=i,t.onPullToRefresh=function(){var e=this;this.collection.fetchPage(1,{reset:!0,onComplete:function(){e.scrollView&&e.scrollView.endLoading()},onFailure:function(){e.scrollView&&e.scrollView.endLoading()}})},t}),define("DS/SwymUIComponents/script/feature/core/ui-components/list/dynamic-grid",["UWA/Core","UWA/Class","UWA/Array"],function(e,t,i){"use strict";var n={autoResize:!1,itemSelector:void 0,layout:"medium",offset:5,outerOffset:0,onLayoutChanged:void 0,resizeDelay:50,verticalOffset:void 0,variableSizeItem:!0},o={small:[{min:0,columns:1},{min:500,columns:2},{min:768,columns:3},{min:1024,columns:4}],medium:[{min:0,columns:1},{min:768,columns:2},{min:1024,columns:3}],large:[{min:0,columns:1},{min:768,columns:2}]},s=window.requestAnimationFrame||function(e){e()};return t.extend({items:null,container:null,columns:null,resizeTimeoutID:null,activeItemCount:0,itemHeightsInitialized:!1,itemHeightsDirty:!1,autoResize:!1,_oldContainerWidth:null,layout:null,offset:null,verticalOffset:null,_collectionHasBeenReset:!1,init:function(e,t){return t=t||{},"string"==typeof e&&(e=document.querySelector(e)),this.updateOptions(n),this.updateOptions(t),this._setContainer(e),this.fetchItems(),this.autoResize&&window.addEventListener("resize",this.onResize.bind(this)),this},_getWidth:function(e){return e.getSize().width},_bulkSetStyles:function(e){s(function(){e.forEach(function(e){e.el.setStyles(e.css)})})},_isHidden:function(e){return null===e.offsetParent},_setContainer:function(e){return this.container=e,this.container.addClassName("dynamic-grid "+this.getLayout()+"-layout"+(!0===this.variableSizeItem?" variable-size-items":"")),this},fetchItems:function(){return this.handledView&&!0===this.modelViewsAsItems?this.items=this.handledView.getModelViews().map(function(e){return e.isRendered()||e.render(),e.container}):void 0===this.itemSelector?this.items=this.container.getElement(".item-list-body")?this.container.getElement(".item-list-body").getChildren():null:this.items=this.container.getElements(this.itemSelector),this.itemHeightsDirty=!0,this},_getItemDataHeight:function(e,t){return e.getAttribute("data-dyngrid"+t)},_setItemDataHeight:function(e,t,i){e.setAttribute("data-dyngrid"+t,i)},updateOptions:function(e){var t;for(t in e=e||{},this.itemHeightsDirty=!0,e)e.hasOwnProperty(t)&&(this[t]=e[t]);return this.verticalOffset=this.verticalOffset||this.offset,this},onResize:function(){document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled||(clearTimeout(this.resizeTimeoutID),this.resizeTimeoutID=setTimeout(this.render.bind(this),this.resizeDelay))},onRefresh:function(){this.itemHeightsDirty=!0,this.render()},getLayout:function(){return!0===this.variableLayout&&this.items&&this.items.length<3?"large":this.layout||"medium"},_getColumnsLayout:function(){return o[this.getLayout()]},_getColumnNumber:function(e){var t=this._getColumnsLayout();return i.detect(t,function(i,n){return n===t.length-1||t[n+1].min>e}).columns},_getItemWidth:function(){var e=this._getWidth(this.container)-2*this.outerOffset,t=this._getColumnNumber(e);return Math.floor((e-(t-1)*this.offset)/t)},render:function(e,t,i){if(console.info("dyngrid::render"),console.info("this._oldContainerWidth === this._getWidth(this.container): ",this._oldContainerWidth===this._getWidth(this.container)),console.info("this.items.length === this.activeItemCount: ",this._oldContainerWidth===this._getWidth(this.container)),!this.items||this._isHidden(this.container)||this._oldContainerWidth===this._getWidth(this.container)&&(!i||!0!==i.incrementalUpdateForExistingColumns)&&this.items.length===this.activeItemCount&&!1===this._collectionHasBeenReset)return this;var n,o=this._getItemWidth(),s=o+this.offset,a=this._getWidth(this.container),r=a-2*this.outerOffset,l=Math.floor((r+this.offset)/s),c=this.outerOffset,d=this.items.length,m=this.container.getElement(".container-column"),u=this;return console.info("layout:"+this.layout+", nbColumns:"+l),this._oldContainerWidth!==a&&(console.info("this.itemHeightsDirty set to true;"),this.itemHeightsDirty=!0),!this.itemHeightsDirty&&this.itemHeightsInitialized||(console.info("itemHeightsDirty"),this.items.forEach(function(e){m&&!0===this.variableSizeItem||e.setStyle("width",o),u._setItemDataHeight(e,"height",e.offsetHeight),!0===this.variableSizeItem&&e.setStyle("width","")},this),this.itemHeightsDirty=!1,this.itemHeightsInitialized=!0),n=this._renderFull(s,l,c,i),this.activeItemCount=d,!0!==this.variableSizeItem&&this.container.setStyle("height",n),console.info("maxColumnHeight: ",n),void 0!==this.onLayoutChanged&&"function"==typeof this.onLayoutChanged&&this.onLayoutChanged(),"function"==typeof t&&t(this.items),this._oldContainerWidth=a,this},_renderFull:function(t,i,n,o){console.info("_renderFull");var s,a,r,l,c,d,m=0,u=this,h=this.items,p=null,g=null,w=null,C=[],f=[],y=[],v=null,A=[],_=null,S=this.container.getElements(".container-column"),b=S[0],I=o&&!0===o.incrementalUpdateForExistingColumns,D=[];for(this.columns=[];C.length<i;)C.push(this.outerOffset),this.columns.push([]);if(_="function"==typeof(this.handledView&&this.handledView.getBody)?this.handledView.getBody():b?b.getParent():h[0]&&h[0].getParent(),!0===this.variableSizeItem){for(y=[].concat(S),m=0;m<i;m++)y[m]||(y[m]=e.createElement("div",{class:"container-column"}),_&&y[m].inject(_,"bottom"));if(i<S.length)for(;y.length>i;)y.pop().remove();y.forEach(function(e,t){a=e.getChildren(),D[t]=a})}return h.forEach(function(e){for(p=C[0],g=0,m=0;m<i;m++)C[m]<p&&(p=C[m],g=m);w=g,d=n,g>0&&(d+=g*t),!0===u.variableSizeItem?(!0===I?(s=e.getParent(),-1!==(c=s&&s.hasClassName("container-column")?y.indexOf(s):-1)&&C[c]===C[g]&&(w=c),l=u.columns[w].length,r=D[w]&&D[w][l],v=y[w],r?e!==r&&(e.inject(r,"before"),-1!==c&&D[c].splice(D[c].indexOf(e),1),D[w].splice(l,0,e)):v&&(e.inject(v,"bottom"),-1!==c&&D[c].splice(D[c].indexOf(e),1),D[w].push(e))):e.inject(y[w],"bottom"),C[w]+=parseInt(u._getItemDataHeight(e,"height"),10)+u.verticalOffset):(f.push({el:e,css:{position:"absolute",top:p,left:d}}),C[w]+=parseInt(u._getItemDataHeight(e,"height"),10)+u.verticalOffset),u.columns[w].push(e)}),!0===this.variableSizeItem?(u.columns.forEach(function(e,t){e.length>0&&A.push(y[t])}),_&&A.length>0&&y.forEach(function(e){e.parentElement!==_&&e.inject(_)})):this._bulkSetStyles(f),Math.max.apply(Math,C)},_renderColumns:function(e,t){console.info("_renderColumns");for(var i,n,o,s,a=[],r=[],l=0,c=this.columns.length;c--;){for(i=this.outerOffset,a.push(i),n=this.columns[c],s=c*e+t,l=0;l<n.length;l++)o=n[l],r.push({el:o,css:{top:i,left:s}}),i+=parseInt(this._getItemDataHeight(o,"height"),10)+this.verticalOffset;a[c]=i}return this._bulkSetStyles(r),Math.max.apply(Math,a)},clear:function(){clearTimeout(this.resizeTimeoutID),this.autoResize&&window.removeEventListener("resize",this.onResize.bind(this))},setCollectionHasBeenReset:function(e){this._collectionHasBeenReset=e}})}),define("DS/SwymUIComponents/script/feature/core/tenant/view/super-user-button-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/tenant/view/super-user-button-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/UIKIT/Input/Button"],function(e,t,i,n){return i.extend({_modelEvents:{onChange:"refresh"},name:"super-user-button-view",_createContent:function(){var e=this.model;if(e)return this.addControl("superUserButton",new n({className:("1"===e.get("tenant_su")?"warning":"primary")+" become-a-super-user",value:"1"===e.get("tenant_su")?t.ExitSuperUserMode:t.EnterSuperUserMode,events:{onClick:function(){"0"===e.get("tenant_su")?e.setAccess({onComplete:function(){this.getControl("superUserButton").setClassName("warning become-a-super-user"),this.getControl("superUserButton").setValue(t.ExitSuperUserMode),this.getElement(".message-box").setHTML(t.Ifyouwanttoremove),e.set("tenant_su","1"),this.alert("success",t.Youenteredmoderationmode),window.location.reload()}.bind(this)}):e.unsetAccess({onComplete:function(){this.getControl("superUserButton").setClassName("primary become-a-super-user"),this.getControl("superUserButton").setValue(t.EnterSuperUserMode),this.getElement(".message-box").setHTML(t.Ifyouwanttoaccess),e.set("tenant_su","0"),this.alert("success",t.Youexitedmoderationmode),window.location.reload()}.bind(this)})}.bind(this)}})),{html:[{class:"message-box",styles:{"margin-bottom":"10px"},html:"1"===e.get("tenant_su")?t.Ifyouwanttoremove:t.Ifyouwanttoaccess},this.getControl("superUserButton")]}}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/emoji-selector-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/utils/utils","DS/WebappsUtils/WebappsUtils","text!DS/i3DXUXEmojis/assets/configuration/emoji-configuration.json","css!DS/i3DXUXEmojis/i3DXUXEmojis"],function(e,t,i,n,o){"use strict";return t.extend({name:"emoji-selector-view",_emojiConf:null,_emojiKeys:[],domEvents:{"click [data-emoji-unicode]":"_onEmojiClick"},arrayMove:function(e,t,i){if(i>=e.length)for(var n=i-e.length+1;n--;)e.push(void 0);return e.splice(i,0,e.splice(t,1)[0]),e},setup:function(e){this._emojiConf=JSON.parse(o).emojis,this._emojiKeys=Object.keys(this._emojiConf),this._emojiKeys.filter(function(e){return!isNaN(e)}).forEach(function(e,t){for(var i=0,n=this._emojiConf[e].group,o=1;o<this._emojiKeys.length;o++)if(this._emojiConf[this._emojiKeys[o]].group===n){i=o;break}this.arrayMove(this._emojiKeys,this._emojiKeys.indexOf(e),i)}.bind(this)),this._parent.apply(this,arguments)},_onEmojiClick:function(e){var t,i=e.target;i&&(t=i.getAttribute("data-emoji-unicode"),this.dispatchEvent("onEmojiClick",{unicode:this._emojiConf[t].unicode}))},_createContent:function(){var e=[];return this._emojiKeys.forEach(function(t){e.push({tag:"span","data-emoji-unicode":t})}),e}})}),define("DS/SwymUIComponents/script/utils/dnd-utils",["DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/community/media/model/media-model","DS/WebappsUtils/Console","DS/SwymUICore/script/feature/core/config/bootstrap-model"],function(e,t,i,n){"use strict";const o=n.getInstance();return{generateDnDDataStructure:function(i){var n,s,a,r="undefined"!=typeof widget&&widget.getAppName?widget.getAppName():e.getMyCommunitiesAppKey(),l=null,c=i.getContentType(),d=i.get("mid");"media"===c?l=i.get("media_type"):"iquestion"===c&&(c="question"),n=e.getBaseUrl()+i.getRelativePath(),s=e.get3DDTransientAppUrl({appId:r,community:i.get("community->mid")||i.get("community").mid||i.get("community").id,contentType:c,contentId:d}),a=t.constructThumbnailUrl("question"===c?"iquestion":c,d,"m_thumb",i.get("preview_fingerprint"));let m=window.widget?e.getTenantIdFromUrlPreference(window.widget):"";return m||(m=o.get("config").tenant.online_instance_id.toUpperCase()),{protocol:"3DXContent",version:"1.0",source:r,data:{items:[{envId:m,serviceId:"3DSwym",contextId:"",objectId:i.get("subject6wuri"),objectType:"wedo"===c?"swym:WeDo":c,objectSubType:l||void 0,displayName:i.get("title"),displayType:l||c,displayIcon:"fonticon:"+e.getIconFromModel(i),displayPreview:a,defaultApp:r,urlContent:{"3DSwym":n,"3DD":s}}]}}},onItemDrag:function(e,t,n){if(window.widget=n||window.widget,window.widget){var o,s=t.srcElement||t.target;e&&t&&t.dataTransfer&&(o=this.generateDnDDataStructure(e),t.dataTransfer.setData("text",JSON.stringify(o)),i.log("ContentDragStarted",[o]),widget.dispatchEvent("ContentDragStarted",[o]),s&&"function"==typeof s.addEvent&&s.addEvent("dragend",function(){s.removeEvent("dragend"),widget.dispatchEvent("ContentDragEnded",[o])}))}}}}),define("DS/SwymUIComponents/script/feature/core/user/view/user-visibility-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/user/model/user-model","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/user-visibility-view","DS/UIKIT/Input/Select","DS/UIKIT/Input/Button","DS/SwymUICore/script/utils/utils","DS/WebappsUtils/Console"],function(e,t,i,n,o,s,a,r){"use strict";return t.extend({_modelClass:i,name:"user-visibility-view",setup:function(e){return e=e||{},this._parent.apply(this,arguments)},_createContent:function(){this._visibilityOptions=[];var t=this.model.get("tenant_visibility"),i=a.getClientInformation(),r=i.isIphone||i.isIpad;return this._visibilityOptions.push({value:0,selected:"0"==t,label:n.noshare}),this._visibilityOptions.push({value:1,selected:"1"==t,label:n.everyone}),this._visibilityOptions.push({value:2,selected:"2"==t,label:n.networkOnly}),this._visibilityOptions.push({value:3,selected:"3"==t,label:n.shareCompany}),this._visibilityOptions.push({value:4,selected:"4"==t,label:n.shareNetwork}),e.createElement("div",{html:[{tag:"h4",class:"titleProfile",html:n.titleSettings},{class:"margin-top-20px ",html:[{html:[{tag:"label",for:"#selectVisibility",html:n.labelVisibility}]},{class:"row change-visibility-container",html:[{class:"col-md-6",html:this.addControl("combobox",new o({name:"visibility",id:"selectVisibility",multiple:!1,placeholder:n.SelectYourProfileVisiblity,options:this._visibilityOptions,custom:!r,events:{onChange:function(){var e=this.getElement(".changingCell"),t=this.getControl("combobox").getValue()[0],i=this.getControl("saveButton");e&&t?(e.setHTML(this._visibilityOptions[parseInt(t)+1].label),i&&i.setDisabled(!1)):(this.alert("error",n.pleaseSelectAVisibility),i&&i.setDisabled(!0))}.bind(this)}}))},{class:"col-md-6",html:this.addControl("saveButton",new s({value:n.save,className:"primary",events:{onClick:function(){this.getControl("saveButton").load();var e=this.getControl("combobox").getValue()[0];e&&this.model.setvisibility({data:{visibility:e},onComplete:function(e,t){this.getControl("saveButton").load(!1),this.alert("success",n.visibilitySetSuccess)}.bind(this)})}.bind(this)}}))}]}]},{class:"margin-top-20px",html:this._createTable()}]})},_firstElementBuild:function(t){return e.createElement("tr",{html:[{tag:"td",html:t},{tag:"td",styles:{"text-align":"center"},html:'<span class="fonticon fonticon-check"></span>'},{tag:"td"},{tag:"td"}]})},_secondElementBuild:function(t){return e.createElement("tr",{html:[{tag:"td",html:t},{tag:"td"},{tag:"td",styles:{"text-align":"center"},html:'<span class="fonticon fonticon-check"></span>'},{tag:"td"}]})},_thirdElementBuild:function(t){return e.createElement("tr",{html:[{tag:"td",html:t},{tag:"td"},{tag:"td"},{tag:"td",styles:{"text-align":"center","background-color":"lightsteelblue"},html:'<span class="fonticon fonticon-check"></span>'}]})},_createTable:function(){var t=this.getControl("combobox").getValue()[0];return e.createElement("table",{class:"table table-striped table-bordered",html:[{tag:"thead",html:[{tag:"tr",html:[{tag:"th",styles:{"text-align":"center"},html:n.informationSharedWith},{tag:"th",styles:{"text-align":"center"},html:n.onlyme},{tag:"th",styles:{"text-align":"center"},html:n.everyone},{tag:"th",class:"changingCell",styles:{"text-align":"center","background-color":"lightsteelblue"},html:t?this._visibilityOptions[parseInt(t)+1].label:""}]}]},{tag:"tbody",html:[this._firstElementBuild(n.Login),this._firstElementBuild(n.Email),this._firstElementBuild(n.Password),this._firstElementBuild(n.Title),this._firstElementBuild(n.Phone),this._firstElementBuild(n.StateProvince),this._secondElementBuild(n.firstName),this._secondElementBuild(n.lastName),this._secondElementBuild(n.photo),this._secondElementBuild(n.city),this._secondElementBuild(n.country),this._thirdElementBuild(n.jobtitle),this._thirdElementBuild(n.company),this._thirdElementBuild(n.address),this._thirdElementBuild(n.zip)]}]})}})}),define("DS/SwymUIComponents/script/feature/community/wedo/view/fedsearch-interactive-thumb-view",["DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/utils/utils","UWA/Utils/InterCom","DS/WebappsUtils/WebappsUtils","DS/SwymUICore/script/utils/navigation"],function(e,t,i,n,o){"use strict";return e.extend({name:"media-thumbnail-view",domEvents:{click:"_onClick"},contentModel:null,setup:function(e){this._parent.apply(this,arguments),e&&e.contentModel&&(this.contentModel=e.contentModel)},_createContent:function(){var e=this.model.get("preview_url",{escapeHTML:!1});return{class:"interactive-media-wrapper"+(e?" has-preview":""),html:[{tag:"img",src:e||n.getWebappsBaseUrl()+"SwymSCI/assets/images/l_thumb_waiting_processing.png","data-type":"MediaNoPicture"}]}},_getShowNThumbnailsClassName:function(e){return"show-"+e+"-thumbnails"},_getRowWithNThumbnailsClassName:function(e){return"row-with-"+e+"-thumbnails"},_onClick:function(){var e,t,i,n=!1,o=this.container.getClosest(".media-zone");if(o&&o.contains(this.container)&&this.container.dataset.remainingMedia){for(e=1;e<=6;e++)if(t=this._getShowNThumbnailsClassName(e),o.hasClassName(t)){(i=o.getElement(".media-thumbnail-view-container:nth-child(1n+"+e+")"))&&this.container===i&&(o.removeClassName(t),o.addClassName("show-all"),o.addClassName(this._getRowWithNThumbnailsClassName(e)),n=!0);break}n||this._openObject()}else this._openObject()},_openObject:function(){var e=this.model,t=this,n=this.contentModel.getCommunity();if(this._widget){var s=window.ds&&window.ds.isMDE?"M3DESCI-"+this._widget.id:"SwymSCI-"+this._widget.id;this._widget.socket=new i.Socket(s),this._widget.socket.subscribeServer("com.ds.compass",window.parent);var a={objectType:e.get("ds6w:type"),objectId:e.get("resourceid")||e.get("id"),envId:e.get("sourceid")?e.get("sourceid").split(":")[1]:e.get("dscom:Tenant")};this._widget.socket.dispatchEvent("onSetX3DContent",{protocol:"3DXContent",version:"1.1",source:"USASWYM_AP",widgetId:this._widget.id,data:{items:[a]}});require(["DS/SwymUnifiedSearch/script/utils"],function(e){e.getSwymModelFromSearchData(this.model.getAttributes(void 0,{escapeHTML:!1}),{onComplete:function(e){o.goToContent(t.contentModel.get("mid"),t.contentModel.getModelName(),n.get("mid"),!1,void 0,void 0,"dm"===n.get("community_type"),{mediaId:e.get("mid")})}})}.bind(this))}}})}),define("DS/SwymUIComponents/script/feature/community/content/view/sort-by-latest-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/utils/date","DS/UIKIT/Tooltip","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/view/abstract-content-view","DS/SwymUICore/script/utils/i18n","DS/WebappsUtils/Console"],function(e,t,i,n,o,s,a){"use strict";return t.extend({name:"sort-by-latest-section",_modelEventsForAutoRefresh:["onSync","onChange:author","onChange:community","onChange:originalAuthor"],_getLatestActivityEvent:function(t){let i,n=t.get("ds6w_58_lastcontributed_event"),s=this._formatLastcontributedEvent(n),a=this._getLatestActivityEventByStatus(s);return i=e.createElement("span",{class:"content-latest-event",html:["&nbsp;-&nbsp;",a.text,a.byPerson?["&nbsp;",this._getLatestContributorLink(t)]:a.byTime?"&nbsp;&nbsp;&nbsp;&nbsp;"+t.get("endDate")+"&nbsp;-&nbsp;"+o.Ending:" "]})},_getLatestActivityEventByStatus:function(e){let t={text:o.Created,byPerson:!1,byTime:!1};return"Published"===e?t={text:o.Created,byPerson:!1,byTime:!1}:"Commented"===e?t={text:o.Commented,byPerson:!0,byTime:!1}:"Answered"===e?t={text:o.Answered,byPerson:!0,byTime:!1}:"Revised"===e?t={text:o.Revised,byPerson:!1,byTime:!1}:"Ended"===e?t={text:o.Ended,byPerson:!1,byTime:!1}:"Started"===e?t={text:o.Started,byPerson:!1,byTime:!0}:"StatusChanged"===e?t={text:o.StatusChanged,byPerson:!1,byTime:!1}:"Validated"===e&&(t={text:o.Validated,byPerson:!1,byTime:!1}),t},_addLatestActivityEventTooltip:function(e,t){let i=e.get("ds6w_58_lastcontributed_event"),s=this._formatLastcontributedEvent(i),a=this._getLatestActivityEventByStatus(s),r=["- ",a.text,a.byPerson?this._getLatestContributorLink(e):a.byTime?"&nbsp;&nbsp;&nbsp;"+e.get("endDate")+" - "+o.Ending:" "];this.addControl("moderation-status-tooltip",new n({target:t,body:r,position:"bottom"}))},_formatLastcontributedEvent:function(e){switch(e){case"swym:eventAction.swym_event_action_publish":return"Published";case"swym:eventAction.swym_event_action_comment":return"Commented";case"swym:eventAction.swym_event_action_answer":return"Answered";case"swym:eventAction.swym_event_action_edit_wiki":return"Revised";case"swym:eventAction.swym_event_action_survey_closed":return"Ended";case"swym:eventAction.swym_event_action_survey_opened":return"Started";case"swym:eventAction.swym_event_action_change_status":return"StatusChanged";case"swym:eventAction.swym_event_action_validate":return"Validated";default:return"Published"}},_getLatestActivityDate:function(t){return e.createElement("span",{class:"content-latest-date",html:i.prettyDate(t.get("ds6w_58_lastcontributed_date"))})},_getLatestContributorLink:function(t){let i=t.get("ds6w_58_lastcontributed_user_login")||null;return e.createElement("a",{tag:"a",class:"link","data-content-type":"person","data-login":i,html:(t.get("ds6w_58_lastcontributed_user_firstname")||"anonymous")+" "+(t.get("ds6w_58_lastcontributed_user_lastname")||"")})},setup:function(e){this._parent.call(this,e)},_createContent:function(){let e,t=this.model,i=(e=[this._getLatestActivityDate,this._getLatestActivityEvent]).map(function(e){return e.apply(this,[t])}.bind(this));if(t.get("ds6w_58_lastcontributed_event"))return{class:"sort-by-latest-section",html:i};a.error("ds6w_58_lastcontributed_event with no return")}})}),define("DS/SwymUIComponents/script/feature/community/content/view/content-small-view-factory",["UWA/Core","UWA/Class","i18n!DS/SwymUIComponents/assets/nls/feature/community/generic/view/content-small-view-factory","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/UIKIT/Tooltip","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/community/iquestion/model/iquestion-model","DS/SwymUICore/script/feature/community/iquestion/model/iq-answer-model","DS/SwymUICore/script/feature/community/wiki/model/wiki-model","DS/SwymUICore/script/feature/core/user/collection/commenters-collection","DS/SwymUICore/script/feature/core/context/context-model"],function(e,t,i,n,o,s,a,r,l,c,d,m){"use strict";var u=n.extend({_modelClass:a,_createContent:function(){return this.model.getNickname()}}),h=o.extend({modelViewClass:u,_collectionClass:d,_createContent:function(){var t=this.collection?this._parent({modelViewsToDisplay:10,showSubsetOfModelViews:!0}):"";return this.collection&&this.collection.length>10&&e.createElement("div",{html:i.andmore}).inject(t,"bottom"),t}}),p=s.extend({defaultOptions:{containerView:null},show:function(){var e=this.getOption("containerView"),t=this.getOption("usersTooltipView"),i=e._getCollectionToUse();if(i&&t&&t.setCollection(i),e&&e._getNb()>0)return i&&!i.isBeingFetched()&&i.fetch(),this._parent.apply(this,arguments)}}),g=n.extend({name:"nb-comments-view",_modelClass:r,attributes:{tag:"button",class:"count-info counter",styles:{"background-color":"transparent",outline:"none"}},_createContent:function(){var e=this.model.get("nb_answers");return e>0?(this.container.addClassName("count-info-pos"),this.container.setStyle("cursor","pointer")):(this.container.removeClassName("count-info-pos"),this.container.setStyle("cursor","default")),[{html:""+e}]}}),w=n.extend({defaultOptions:{titleNlsKey:"Peoplewhoansweredthisquestion"},name:"nb-comments-view",_modelClass:r,domEvents:{click:"showModal"},attributes:{tag:"button",class:"count-info counter",styles:{"background-color":"transparent",outline:"none"}},setup:function(){var e;if(this.stopListening(),"iquestion"===this.model.getModelName()&&(e=this.model.getAssociated("validatedAnswers"),this.listenTo(e,"onRemove",this.refresh.bind(this))),this.model.getAnswerCollection){var t=this.model.getAnswerCollection();this.listenTo(t,"onCollectionChange",this.refresh.bind(this))}!0!==this.model._customProperties.answersFetched&&this.listenToOnce(this.model,"onSync:fetchAllAnswers",this.refresh.bind(this)),this._parent.apply(this,arguments)},_getNb:function(){var e;return"iquestion"===this.model.getModelName()?(e=this.model.getAssociated("validatedAnswers"),this.model.getAnswerCollection().length+e._models.length):this.model.getNbComments()},_getCollectionToUse:function(){return this.model.getWhoAnswered()},_createContent:function(){var e=this._getNb();return e>0?(this.container.addClassName("count-info-pos"),this.container.setStyle("cursor","pointer")):(this.container.removeClassName("count-info-pos"),this.container.setStyle("cursor","default")),[{html:""+e}]},_getPosition:function(){return document.body.getDimensions().width<=500?"right":"bottom"},showModal:function(){require(["DS/SwymUIComponents/script/feature/core/user/view/user-mini-view","DS/SwymUIComponents/script/feature/core/modal/modal"],function(e,t){var n=this,s=m.getInstance();if(this._getNb()>0){var a=this._getCollectionToUse();a.isBeingFetched()||a.hasBeenFetched()||a.fetch(),this.addControl("userListModal",new t({closable:!0,header:i.get(this.getOption("titleNlsKey")),body:[{html:this.getChildView("usersList")?this.getChildView("usersList"):this.addChildView("usersList",{collection:a,Class:o,attributes:{styles:{"min-height":"350px"}},modelViewClass:e,modelViewsCfg:{attributes:{class:"float-left",styles:{"margin-bottom":"10px","min-width":"50%"}}}})},{html:'<div style="clear:both;"></div>'}],events:{onHide:function(){n.getChildView("usersList")&&n.getChildView("usersList").destroy(),this.elements&&this.getContent()&&n.removeControl("userListModal")}}})).show(),s.addListener("onContextChange",this._onContextChange,this)}}.bind(this))},_onContextChange:function(){var e=m.getInstance();this.getControl("userListModal").destroy(),e.removeListener("onContextChange",this._onContextChange)},onRender:function(){var e=this.addChildView("usersTooltipView",new h({collection:this._getCollectionToUse()}));this.addControl("usersTooltip",new p({target:this.container,containerView:this,position:"bottom",className:"st-interactor-tooltip",usersTooltipView:e,body:e,offset:{x:0,y:5}}))}}),C=w.extend({defaultOptions:{titleNlsKey:"Peoplewhocontributededtothispage"},name:"nb-contributors-view",_modelClass:c,_modelEventsForAutoRefresh:["onChange:nb_contributors"],domEvents:{click:"showModal"},attributes:{tag:"a",class:"link",styles:{"background-color":"transparent",outline:"none"}},_getNb:function(){return this.model.get("nb_contributors")},_getCollectionToUse:function(){return this.model.getContributors()},_createContent:function(){return this._getNb()+" members"}}),f=w.extend({defaultOptions:{titleNlsKey:"Peoplewhovotedforthiscontent"},name:"nb-endosers-view",_modelClass:l,_modelEventsForAutoRefresh:["onChange:rate"],domEvents:{click:"showModal"},_getNb:function(){return this.model.get("rate")},_getCollectionToUse:function(){return this.model.getWhoRated()},_createContent:function(){return this._getNb()>0?this._getNb():"0"}});return t.extend({_views:{nbAnswersNextGen:w,nbContributors:C,nbEndorsementsNextGen:f,NbAnswersViewNextGenForCompactView:g},createView:function(e,t){var i=this._views[e];if(i.prototype instanceof n)return new i(t);throw new Error("The requested view is not available")},getViewClass:function(e){return this._views[e]}}).singleton()}),define("DS/SwymUIComponents/script/feature/core/ui-components/layout/column-view",["UWA/Core","UWA/Utils/Client","DS/SwymUICore/script/lib/view/generic/swym-view"],function(e,t,i){"use strict";return e.extendElement(document.body),i.extend({viewWrapperClass:"views-wrapper",init:function(){this._requestParentHeightAlignment=this._requestParentHeightAlignment.bind(this),this._parent.apply(this,arguments)},_createContent:function(){return this.elements.viewsWrapper=e.createElement("div",{class:this.viewWrapperClass})},_requestParentHeightAlignment:function(){this.dispatchEvent("onRequestForParentsHeightAlignment",[this])},getViewsWrapper:function(){return this.elements.viewsWrapper},onRedraw:function(){this.elements.viewsWrapper.addEvent("resize",this._requestParentHeightAlignment)}})}),define("DS/SwymUIComponents/script/feature/community/media/view/document/empty-pptx-data-uri",[],function(){"use strict";return"data:application/vndopenxmlformats-officedocumentpresentationmlpresentation;base64,UEsDBBQABgAIAAAAIQDfzBj1rQEAAEYMAAATAAgCW0NvbnRlbnRfVHlwZXNdLnhtbCCiBAIooAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADMl1tPwjAUx99N/A5LXw0roCIaBg9enryQiB+gbgeodm3TFoRv79kFgoSbArEvS87O+f/Pr2u3dq3OJBXBGIzlSkakFlZJADJWCZeDiLz1HipNEljHZMKEkhCRKVjSaZ+etHpTDTZAtbQRGTqnbyi18RBSZkOlQWKmr0zKHIZmQDWLP9kAaL1abdBYSQfSVVzmQdqtO+izkXDB/QRvFyQfGgYkuC0Ks14R4WlmkCfoSo0BYZc0TGvBY+YwT8cyWSKrlFQhKvMaO+TanmHBmg5ZZn2DUveCj9PwBIIuM+6ZpVhFtXZUG7Coy2vDzU4rUFW/z2NIVDxKURIumqXiRximjMvZINbBWIE3n5h1OPWLQe3QZAveOzGVNMfh2EaQabpGaXuM+cmNtxGMOXwdhWBuvI3A4TsMxXX/SchttnZk7wJe3VTAwUe9YL3T6ntkUzVy5RosguOsxML7r0x1D5nOPWS68JDp0kOmhodMVx4yNT1kuvaQqVb1Eeq/vuQoz3dePPca+D3D7JCaqSsajcA4vnk/m3dE670HDdn5N4FkRW+a/wW0vwEAAP//AwBQSwMEFAAGAAgAAAAhAGj4dKEDAQAA4gIAAAsACAJfcmVscy8ucmVscyCiBAIooAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACskttKAzEQhu8F3yHMfTfbKiLSbG9E6J3I+gBjMrsb3RxIptK+vaHgYWEtgr3MzD8f3yRZb/ZuFO+Usg1ewbKqQZDXwVjfK3huHxa3IDKjNzgGTwoOlGHTXF6sn2hELkN5sDGLQvFZwcAc76TMeiCHuQqRfOl0ITnkcky9jKjfsCe5qusbmX4yoJkwxdYoSFtzBaI9RPofWzpiNMgodUi0iKlMJ7ZlF9Fi6okVmKAfSzkfE1Uhg5wXWp1XiIede/FoxxmVr171Gqn/TWj5d6HQdVbTfdA7R57nvKaJb6cYWcZEuRSP6VM3dH1OIdozeUPm9KNhjJ9GcvIzmw8AAAD//wMAUEsDBBQABgAIAAAAIQA2DVvcjAIAADQNAAAUAAAAcHB0L3ByZXNlbnRhdGlvbi54bWzsl91umzAUx+8n7R2QbydKzFdIFFI166gmdVLUdA/ggtOgGhvZTpp02rvvGEygqSb1AbjC9vmfD/+w4HhxfayYc6BSlYKnCF9NkEN5LoqSP6fo92PmJshRmvCCMMFpik5Uoevl1y+Lel5LqijXRIOrA2G4mpMU7bSu556n8h2tiLoSNeVg2wpZEQ1T+ewVkrxC+Ip5/mQSexUpObL+8jP+Yrstc3or8n0F6dsgkrKmDrUra9VFqz8TbbiL9yUpcqCb/ZOiOhNcK6CDlrBtxYpfRGkqfxb3Sl+sOGWRIh+H0zAJ4hhgyrlZAQtG3nLh/cf9/bgNEsUDb7/3Hmo3b05+hMJ8PIPCIV1+SlGcRImZeEbEhabKyjpDo5rhMDyrCrole6Yf6VFv9InR5YKYtfVa2tHDWjqMmDNBuXu3aqoZStiB4Ro0FZH3KYIUhD3DeWLIAc0jedq8dRlhU5o1Ekru+Uq+GK6OeXvcTsG0g1RwRNZ7nuuW+7kKBZFwYuK8UGmOLGy8sSvByiIrGWsm5oXT70w6BwLZ9LHFf6Fqsjr6VMP2czjc3yruMm2UZE7JhYGS1pCrC0OuehwPBod35mHR+D2aMJqagkc+DRTLJ+j5dBBGPgaK5RP2fHAwxfEIqKNiAUUDQImfNNWPgAwVCyjuAfl+Ejd/gRGQoWIBTQeApmEwfqPPVCygpAdk6Iwf6TMVC2g2ABRH0/EjfabSdK4fW8x6DmPby8LI2csyRX9+ZDfZyg8CdxIHmRv6q8hN4Kfnzm6zIIvw6gZPbv6aRhxHpgO+25cFhSBdy4+jD01/VeZSKLHVV7mo7O3Bq8UrlbUomwsE9tuWv+2xoZbu2VTnvb/qLP8BAAD//wMAUEsDBBQABgAIAAAAIQAPkkArFAIAAOcEAAAVAAAAcHB0L3NsaWRlcy9zbGlkZTEueG1sxJTdbtsgFIDvJ+0dEPcOifPTxKpb1WlTTerWaMkegGASW8OAgLiOpr77AEOzrZ3Ui0m78YHD+fuOOVxedw0DLVW6FjyHo8EQAsqJKGt+yOG37SqZQ6AN5iVmgtMcnqiG11cfP1zKTLMSWG+uM5zDyhiZIaRJRRusB0JSbs/2QjXY2K06oFLhJxu1YSgdDmeowTWHwV+9x1/s9zWht4IcG8pNH0RRho2tXFe11DGafE80qai2Ybz3byVdWTKyYaWTWm4VpW7F23slN3Kt/PGXdq1AXdp+QcBxY9sCUTgIZn7LW79Af7gf4hJn3V41Tlo20OXQNv/kvsjpaGcA6ZXkrCXV4xu2pLp7wxrFBOiXpI6qL+41ThpxtrVhFIxeqGK9Wj4I8l0DLiyPw+/xXix6ZidlBcxJ2lDEKB8tmPbnfnGuJ/TLdIUoTy7PzkqvxBnTZmNOjPqN9I3h5Ror/NUWzbC7ppQn90UAlj54jIQi7d+Zx5F5c9wZj53+C2x93PXYNkl3dvkv+F7Em2yv1YM2YQWOqs7hj6JYzNLlvEiK0WSVTG4XF8nNajZNVtPxZLIs5jfL8d2zm4zRJCOK+qH5FIffKl8NXFMTJbTYmwERTZhcJMUTVVLUfnhHw/ACtJjZ9gwX8+lFmvrWI19alL5Y1+wwk4Spz1g+tv7H2FyGqqVXSfu4hP9yNnHo1u8nAAAA//8DAFBLAwQUAAYACAAAACEAGy41BwwBAADQAwAAHwAIAXBwdC9fcmVscy9wcmVzZW50YXRpb24ueG1sLnJlbHMgogQBKKAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACsk0FOwzAQRfdI3MGaPXFSoEKoTjcIqQskBOEAJpkkFo5teUwht8dqoSRVFXWR5f/2/HmasVfr706zLXpS1gjIkhQYmtJWyjQC3orHqztgFKSppLYGBfRIsM4vL1YvqGWIRdQqRyymGBLQhuDuOaeyxU5SYh2aeFJb38kQpW+4k+WHbJAv0nTJ/TAD8lEm21QC/Ka6Blb0Ds/JtnWtSnyw5WeHJpxowZ1HevY2NmOF9A0GAQcriWnAT0Ms5oQgrSr8B9jJXzebgshmh3iSFNAfoezN0Y1JrOWcWEG+a3wNvcbBigbmFMjtrCCxdrCkndybk8O4mZNhq/Dr6LUerD8IPvqH+Q8AAAD//wMAUEsDBBQABgAIAAAAIQBjXCO0wAAAADcBAAAgAAAAcHB0L3NsaWRlcy9fcmVscy9zbGlkZTEueG1sLnJlbHOMz71qwzAQB/A90HcQt1eyO4QQLGUpBUOnkD7AIZ1tUVsSOrnEbx+NMXTIeF+/P9dd7sss/iizj0FDKxsQFGx0Powafm5f7ycQXDA4nGMgDRsxXMzbobvSjKUe8eQTi6oE1jCVks5KsZ1oQZYxUaiTIeYFSy3zqBLaXxxJfTTNUeVnA8zOFL3TkHvXgrhtiV6x4zB4S5/RrguF8k+E4tk7+sYtrqWymEcqGqR87u+WWlkjQJlO7d41DwAAAP//AwBQSwMEFAAGAAgAAAAhAHAsDRtFBwAAQzIAACEAAABwcHQvc2xpZGVNYXN0ZXJzL3NsaWRlTWFzdGVyMS54bWzsWmtu4zYQ/l+gdxDUn4XXeks21iliJ94ukG6DJj0ALdG2GppSKdqbbFFgz9JbtMfZk3Q4JG05id2kuwskgWHAooaj0XC+b4YP+/UP1wvmrKhoyooPXP+V5zqU51VR8tnA/fVy3Mlcp5GEF4RVnA7cG9q4Pxx9+83rut+w4ifSSCocsMGbPhm4cynrfrfb5HO6IM2rqqYc+qaVWBAJt2LWLQR5D7YXrBt4XtJdkJK75nnxkOer6bTM6UmVLxeUS21EUEYk+N/My7qx1uqHWKsFbcAMPr3l0hGML79ghbpOZvr7Fzp1yuIaouR5PmiQPlqmIyacFWEDdzLz3e7R665RNi31cFNfCkpVi6/eiPqiPhf4hnercwE2waTrcLKA+CoD2GHU8JavsNG99fjMNkn/eioW6grhccBDQPFGfXeVjF5LJ9fCfCPN5z/fo5vPT+/R7toXdFsvVaPSzt0dTmCHc1lKRp1zRnI6r1gBXMEQoa71vanPqvyqcXgFY1Oh0ENda+jxq2s9d+RNDWalMmv0dCc2No7dG5UszABhHG6YxH4Qb8fH92I/TpSCGrgfBnGchFvDJ/1aNPINrRaOagxcQXOJTCCrs0ZqVauCPmlP6r68HlbFjdKcwBWiBCkHz88r8cF12FveDNyeH0Xwbok3UZwGcCPaPZOtHslGFUOYCM/BzsDNpUBfOBD8eCmraWk80q9UXayRF/KGURx3rb5QLMAhRlTGU955M9RhkUcjVuZXjqwcWpTSMbmOoYeSAFaUbYlvQCuUF+dEkF9uGXOKUsgWk2oMjA0Ixmg/mcI1mRRSbS4FX4JLKjquSezPoZSfBXGyn1NRGPthmD19Tj2aRrUCfYXPovDxtFIRQ1Y1W7TShLn9FgRq/1suaF7xwmF0RdkDLCKV9lu8nJfi4Qaxcuw3OK6WQs4fbDF6gMVyeq/Br5eckU3OEyK3Cz0G4HOTs5Cw/PgApCZsapIUkfq/SZqEUNPjWxNjkEYhKqgc3cwMz6js43BsVmJ7xXxFHMJmsKxj6GxBpwp+FU5fDRchqVhZjEvG7lnOyGu9ypEll1qSxp5nmbJW1ncbO137JmwaR3S75SBSe8oKJNEfWZSMTtOTuDMax2knSk7HnWHmpZ3xyYkXe0HkZyfRn67lBDBNlgs6LmdLQX9eaihuZ4TTLOSIUcLXNUke+b2ul8EqL/A32TFVi7yd+fE/syK2WTGuKlXd2nmBafy5eTEF0BHJ35dEwBtMbujlymNyI/LCDOenXckR+X6UveTksMump5ceX5aTieXkBfhCnXfLxeQWMxHYz2Um7ArB9H3kROI/rnAnvreXnC++cj9Vaq4rdxh6p8dJ5nVOwjDpRONx2smG6XGnl0XZcOgd+6MwWFfuRjGPAzseWrA/ffz7u08f//kC1RovdhMO9AH0TctZihIGMhz2kmCUDTtDPxp3opNe2jkeJ3FnHIdRNBpmx6Pw9E91LuBH/VxQPDJ4W9jDBj+6c9ywKHNRNdVUvsqrhTm36NbVeyrqqsSjC98z5x8IURAlXi+OvFTjhL7ZK3qrEs8cSeRM/ERqZzLzYXKXPsT3GlrFFbQms0DJAiULlAxaJM8pl6BhGlYSWMlaJ7SS0EoiK4msJLaS2EoSK4EaM2clv4JgqIvrTCv2oxbYlq4xUCXOyE21lG8Lg0RLoo8Q/CiNsjBJwFvRVxLxtjCHBzt1g5au2Rzu1A1bumatulM3auma+XunbtzSNRV1p27S0k3+Qzdt6ab/oZu1dHG7uUe319Lt7ddNVR1bY4E83aO8BZydOu4CL6+xtDTYVocLOxexDlSnSzK5+GAqrK6qWFIpOeNDcYUHaeowkJtb6JpDgSj57HzJc6n60TK/qHM9weXnuamRPW9TI9sKQ3WUt626LqXr3snyXcX1hrhVrbWTV1Sos9WHVm5juq2FQ8IiOoXpeuB+v/itw6SZC8mtDkrMWV5zqyNvjO17q/x29Guc9+5AsSDiDCAO9Jqx5FDOIagdK3g6SMlGq/qtea8F1riCmXETnWNREvC6Jrxq4NYLvCEsPCK42g9UgLqU+XxMFiVTiw0Q5HMiGirX89VkOQIJigfup49/aWmLDgEupL8GHfguOvBddOD76YDNYAN5ksXo/DOAPH5KiH+1AvAFEVcwG8TDDeKw7wtVzA+QPxJyDNoTh1zhbCCPWpADvLidOkD+KMj951DXFc4G8rg1lXtxijAeIH95kCucDeRJC/LYj57L8u0A+SMhVzgbyNMW5L1Ue3+A/OVBrnA2kGcbyMMoUEE/QP4SIVc4G8h7LcizLDks314o5Apn/Y+yzblM3a/knIr1KQ08ca6JYUZ393B8o7J9pPNVSPLcYnz/0Qf+gHOIz86DAhuEQ3x27KrDVG2sDwHatQf1syBD7w8B2rFjw2n8EKDd+xv7P4BDgHbsBsDdQ5Het3ZO4vRQpLdXmu3FJf6jwv5Qq3/H1f/cPfoXAAD//wMAUEsDBBQABgAIAAAAIQAo1d9nOgQAAFUOAAAhAAAAcHB0L3NsaWRlTGF5b3V0cy9zbGlkZUxheW91dDEueG1svJfdbts2FMfvB+wdBO1akahvG7ULy7aKAWkS1NkD0BJtC6VIjaRde0OBvtb2OH2SkpRkyUmaJbGxG5GiyB/P4f/wiHz3fl9iY4cYLygZmeDKMQ1EMpoXZD0y/7hPrdg0uIAkh5gSNDIPiJvvx7/+8q4acpxfwwPdCkMyCB/CkbkRohraNs82qIT8ilaIyG8rykoo5Ctb2zmDXyS7xLbrOKFdwoKYzXj2kvF0tSoyNKPZtkRE1BCGMBTSfr4pKt7SqpfQKoa4xOjRpyaJQyW9FYXAyDR0N7aTDcAcS8+zBc4NAkvZcK96GAtc5Eh/4tU9Q0jVyO4DqxbVHdMjbnZ3zChyRWhGmnbzoemmX8lOV+wHw9dtFQ73K1aqUi6EsR+ZUq+DetqqDe2FkdWNWdeabW6f6Jtt5k/0ttsJ7N6kyqvauMfuuK079UKAo1etvby6ptlnbhAq/VHu1+4de9Q+q7LaNKueCaZpTdf6u6509jy5GCBwfcep3QTAdb3QO12YAfDrDsph14uj0Hnkds2uhmKf0PygRi9lKd2FJNtQGaTLmom5WIgDRrq+w6BSXfCaaPtN1Zqj1SfZyP8amaGatZ6o6VvXe4xKPbRXTA7CUG1ARKwPST2dGE9xkX02BDVQXgjjI+QCMUNHqNyhEqKAQmM1BZH8DjKoLOjDjLxgoid3pZ1undX+P6+41yq+2C7r2d1LiM63y1p0OYmS8izxvdBxHS9+RnwQBkEUastfIv5PFS8hu9ZbqCC5zCS6ehoFy+2NzJwa0AsIZevDgNBVt6P6QeQqe1+LPok1xWvQXoeu1+LVaBD30YrXoP0ODbwIqG31ana3Fxtgww567NiNlQnnsRWwYYcd23VjvUvPYytgw4567Mj33iLlKVsBG3bcsRX4TVqesBWwYQ967DDQKfI8tgJeKN3xNuf8nxnPbzPeDApk3GGYoQ3FuTRH/17OzXy5MPWibSBetdmvtvWn6U/P+myO0i96jVfyrKK8+Dv2w+k8mgXWNA0iyw/nqZXETmSls5kTOK4P4pn/tT355NJVUZQoLdZbhm63Qqv9UCqDl2KKESTHY4UYg4HtxPIo5YJOHmnDMwK9UZaglSWlVMVGXxj/EsKsZIxrZf7cQiZnaMX5j3/Ta8S57IqEx1+zOo8aN9ty+WBdgov8qnEu0U8uTf1DvWzcep4zn4SxY808L7T8NI2sOIkm1iD24yRxJmDquce45cpzIq17abh+//bPb9+//XuBWNVFe/qXh45rLpqasWWFdCRJBqE7jRMrAX5q+bNBZE3SMLDSwPP9aRJPpt78q7pFAH+YMaRvJb/n7X0G+I9uNGWRMcrpSlxltGyuRnZFvyBW0ULfjoDT3Gd2EOsTbyAPvfGgTS/StrbU1irhF8p/WWL2EVa3Ox0kpc6+U91UyetbEyNdF+V7ex0c/wAAAP//AwBQSwMEFAAGAAgAAAAhAEmXn1WIAwAAXwsAACEAAABwcHQvc2xpZGVMYXlvdXRzL3NsaWRlTGF5b3V0Mi54bWy0VtuO2zYQfS/QfyDUZ60kS7ZlI3ZgyVZQYJNdxNsP4ErUig0lsiTt2C0C5Lfaz8mXZEhJ9t66dbvui3jR8HDmzCE5b97uaoa2RCrKm5kTXPgOIk3OC9rczZxfbjI3dpDSuCkw4w2ZOXuinLfzH394I6aKFZd4zzcaAUajpnjmVFqLqeepvCI1VhdckAb+lVzWWMNQ3nmFxJ8Bu2bewPdHXo1p43Tr5SnreVnSnCx5vqlJo1sQSRjW4L+qqFA9mjgFTUiiAMaufuiS3guIlt/+6iBrJLcwDJw5xJ2vWYEaXMPEDdWMIGAHpbzRgGQNlLiRhJhes30nxVpcS7vuw/ZaIloYnG6943U/OjM7bLa24z1aftd38XRXytq0QAbazRzI2d58PTNHdhrl7WR+nM2rq2ds82r1jLXXb+Dd29RE1Tr3NJxBH05LR3CIqvdXiUuef1Ko4RCPCb8N72DRxmxaUXXMawPV2bU/befoTEeW3iW82JtNbqG1k3jKlF7rPSN2IMzHuiHBX4aNsEnjvktaDvQ8ZTT/hDRHpKAavcdKE4ns/qB8QDGEaEuLRSFNcY0l/vgIDBVU6nsUCutx757X8/f3LIY9i52U0DXDOak4K8Cdwes4pcXuaHIGOoUJfssOQvr39BqZWnbVA3pb4h7vYj1/eZc1yTkcQ0a2hJ2AaPl8GfGmovJ0wPCfATO+kbo6GTE6AZGWzwL+fyKNepEusSYPFGoJeO2pLzS8Nr/DzY1Z6XSqbX09i2xLuLhNFH/E0ShdjZdDN82GYzcarTI3if2xmy2X/tAfREG8jL70j0ABoWpak4zebSS52phL/mlKkKp1yghuDodCz4OJ58fwqgyCY3rAhxcS9B/TMuzTknFujtf9xFgdvTYxpZZtZn7bYAk79Mk5451yXkZGPSNrRguCPmzq20e8DM/BC9RAAP0sNfaKObNuw9BfLUax7y7DcORGWTZ242S8cCdxFCeJvwjScHDQrTKRN+DdqXL99vXPn759/esMWrVNXwTBVX+pdNdDG0khkCSZjAZpnLhJEGVutJyM3UU2GrrZMIyiNIkXabj6YoqpIJrmktgC7eeiL+2C6ElxV9NccsVLfZHzuqsSPcE/Eyk4tYVi4Hel3RbD7TqJJkEYR8M+S+Ba31pnTd7XJnxomXyPxdXWaqS271dqpwQUsp1EjiYm9L4wnn8HAAD//wMAUEsDBBQABgAIAAAAIQBAxvT9eQQAACsRAAAhAAAAcHB0L3NsaWRlTGF5b3V0cy9zbGlkZUxheW91dDMueG1szFjbbts4EH1fYP+B0D4rEnWljTpFZEfdBdIkqNMPYCQ6FkpdlqRdexcF+lu7n9MvWQ4lWU6aZt3WCPJiXjQzPGdmyCH96vWm5GjNhCzqamLhE9dCrMrqvKjuJtb7m9QmFpKKVjnldcUm1pZJ6/Xpr7+8asaS5xd0W68U0jYqOaYTa6lUM3YcmS1ZSeVJ3bBKf1vUoqRKD8Wdkwv6UdsuueO5buSUtKisTl8col8vFkXGZnW2KlmlWiOCcao0frksGtlbaw6x1ggmtRmjfR+S2jaarWTZ74zmFjKCYq2nsHWquWdznqOKlnpizjJQRyDIhPkqmxvBGPSq9RvRzJtrYZQu19cCFTkY6ZQtp/vQiZlhtTYd54H6Xd+l481ClNBqb6DNxNJB28KvA3Nso1DWTmbDbLa8ekQ2W54/Iu30Czh7iwKrFtzXdLyezk2hOEN4x6rHK5uLOvsgUVVrPkC/pbeTaDlD2yw71ysw1cm1H01nAPOoJ4iPSdhSxLE7in1y3ynYDXEYuR1bj4Re7McPObe2m7HaJHW+BfVb3WqutMqWtU7T29Yol2qutpyZ/prjDlLOFu+0sPxrYumVeo/uBKC/p9jAj9ETWolT2Hesst8k7RrqdMqL7ANSNWJ5odBbKhUTyHhHb0xtBAwqY9ZYYVV+TQUFBPvGUF4ItRfgxjDtGRrST8fY38UYfHnNacaWNdcZj7xjhBs8bOmFIEY/E/UgJKMg8p+KOg5dF5ODo/6tUKOSiguzcYoq14cIdI3W6lKflEZrLxO8wG0/y5oXeVpwbgZwNLEpF2hNuc75DZwuOpxFpdqZOBwyaCfcjgY7Tr/S/UQzXW9AGoSxBz44CC4s+1xwAWMH1x/gjnAAPjsILibPCBcwdnCDAS72Y2xS7CC8IPlceAFkhzfcw0s8Al57eXgBZIc3GvB6HjGn6cvDCyA7vPEe3jjwD95uz4oXQHZ4yYAXwB6+354TL4Ds8I728EZh/DL3G4B8vMwDei2wu359f9mHimaqvrxX9n+koAd9QZ9Rxe4VdFM9f7ag58oyrl9SvugLe+vLb1Z2s+qT5dcMjCsX+v4NLP4mQTQ9j2ehPU3D2A6i89ROiBvb6Wzmhq4XYDILPvX3+VxTVUXJ0uJuJdjVSpmAP4wAkqWackarXaDUKR45LtEPBA8PjtcYnrhx/eA9K+zDktY1hHw/MMExArNQoo3Mnysq9Ap9cP7n2vU9wTmuR6LeI3O95xi6XJW3D/wSHsMv+jmrTT/qGnPDPXLe+r57fhYR1575fmQHaRrbJInP7BEJSJK4Z3jqe7u8lcC80ugOTdcvn//57cvnf4+Qq6bpn7P6+LmQquuhlSg0kSQZRd6UJHaCg9QOZqPYPkuj0E5DPwimCTmb+uef4FmMg3EmmHlr/5H3r3QcfPVOL4tM1LJeqJOsLrsHv9PUH5lo6sK8+bHbvdLNKe2FIxx6Qej1x4vG1rcGLQR+Dvx1y8Vb2lytTZKU5lCdmqmmqO66HBlEgHv/J8fpfwAAAP//AwBQSwMEFAAGAAgAAAAhAOSkc3rPAwAAyw4AACEAAABwcHQvc2xpZGVMYXlvdXRzL3NsaWRlTGF5b3V0NC54bWzsV91u2zYUvh+wdyC0a0X/smzULizZKgakTTB7D8BIdKyVIjmSduwOBfpa2+P0SUZSkp04buI03q56I1IU+fGc7ztH5HnzdlNjsEZcVJQMLe/CtQAiBS0rcju0fp/ndmIBISEpIaYEDa0tEtbb0c8/vWEDgctLuKUrCRQGEQM4tJZSsoHjiGKJaiguKENEfVtQXkOpXvmtU3J4p7Br7PiuGzs1rIjVruenrKeLRVWgCS1WNSKyAeEIQ6nsF8uKiQ6NnYLGOBIKxqx+aJLcMuWtvKNXN39YwMzjazXiWSPlejHDJSCwVgPzOwoySqSCMZ8Em3OEdI+s33E2Y9fcrPiwvuagKjVCu9Jy2g/tNPNK1qbjHCy/7bpwsFnwWreKCbAZWkqwrX46egxtJCiawWI/WiyvjswtltMjs51uA+feptqrxrjH7vidO/NKYgS8nVedvYJd0uKjAIQqf7T7jXu7GY3PumXLjnYN1c5rPprO3piWLLlJabnVm9yo1gzCARZyJrcYmRemH8YMruzFUEc1Iva7tOFAjjJcFR+BpACVlQTvoZCIA7O/CnuFogmRhhaDgkh5DTn87QAMlBWX9yhkxuLOPKfj79ssBh2LbSiBawwLtKS4VOb4r+NUfFKpAPHCUjtt9pO/QeyREEuCRGWGiR0v8aPYjx5GW+QlXqwn6CgKg8gLguQwlhrokyVjmuA13gXryyXUxhkFxQMJG3EOdzGcPL3LDBWUlACjNcInIBrNnkacLyt+OmDwPGBOV1wuT0YMT0CsFkcB/7tECJ9KBMPB2RLBSPSiRIi9nv8jE35kwv+SCVGXCRMo0YM0MOa+9owtpfXoZGhsPcuZu1AXJO3FX0kYZ9PeJLKzPOrZYTzN7TRxe3Y+mbiR64deMgk/d/etUrkqqxrl1e2Ko6uVvlI9lgSIWmYYQbJLCjny+o6bqAuc7+3lUTY8IdB3yhJ3suSU6vS6L4z5G7xWmIXkjTJ/riBXO3TiPHNuv0Sc8zLS6xiZ4apE4MOqvjngJT4HL6rcUNBHqXnmT/5dcRsE7nQcJ649CYLYDvO8Zydpb2z3kzBJU3fsZYG/i1uhPSfKulPD9euXv3/5+uWfM8SqabqSQ/3qL4Vse2DFK+VImvZjP0tSO/XC3A4n/Z49zuPIzqMgDLM0GWfB9LMuXbxwUHBkaqFfy66K8sJHdVRdFZwKupAXBa3bgsxh9A5xRitTk3luW0WtoT5SfDdw++rRb2VStnWtsVYLP9P+qxbz95BdrU2Q1OYAy8wQU0VjGyP7Kdr3rggd/QsAAP//AwBQSwMEFAAGAAgAAAAhAEs4bnj1BAAArBgAACEAAABwcHQvc2xpZGVMYXlvdXRzL3NsaWRlTGF5b3V0NS54bWzsmV1u4zYQx98L9A6C+qyVqE/a2GQR2dGiQDYJavcAjETH6kqkStKO3WKBvVZ7nD1JSUryVxyvYnufmhdLlsgfZ+bPmXGY9x8WZWHMMeM5JRcmeOeYBiYpzXLyeGH+Pk4saBpcIJKhghJ8YS4xNz9c/vzT+6rPi+wGLelMGJJBeB9dmFMhqr5t83SKS8Tf0QoT+W5CWYmE/Moe7YyhJ8kuC9t1nNAuUU7MZj7rMp9OJnmKhzSdlZiIGsJwgYS0n0/zire0qgutYphLjJ69bZJYVtJb8UTHi/ETvXv4wzT0YDaXj4F5Kf1PR0VmEFTKBwNaVojlnBL9hldjhrG6I/OPrBpV90xPuJ3fMyPPFKCZaNrNi2aY/krm+sbemf7Y3qL+YsJKdZXRMBYXphRtqT5t9QwvhJHWD9P103R6t2dsOr3eM9puF7A3FlVe1cY9d8dt3RnnosAGWHnV2surG5p+5gah0h/lfu3eakTts7pW0zb0CtWMq1/qm7UxeyMBvV4EoXbRCwPgBtsxAU4AgtBpnAWeGwSht+tyja76YhHTbKmmP8irlgT1Cy5GYllg/aVSH9oMJiNRIJUzmFgf43pVcTko8vSzIaiBs1wYnxAXmBnaM5lUkqLWFXp1TcEku0cM/bYDM7KciQ1xKm1ma562+LA+3kofFYj7AqV4SotM2uKeQyoVHlMupAJ8imIghADUeqwlk4JFEYxqxaDr9YC2uYtgBiLplMqy8lAjW+30/bwAcppRInajd39OMlkJ1K0GzG5ludOzMjxRgvC/5D731dZ5aN1cURqguwb6QeSqsZ2oznOqQjVUb03tAV9b0IUK4HOqQjVUf00FXgR0TnTC6pHbWMVqsMEGFrpQ23AsVrEabLjGui4MdcCOxSpWg402sJHvdVZsH1axGixcYxWzu2R7sIrVYHsb2DCITpJMser7jZzQ5UwtIgesWsTry5vKXF3d+FZ5O6Zw+W3hGlAipKNbtUsXiuNrlwrNFBWTpnLVVeXIyuUGTuBEO81mq3J5IfQDOfq0XvODxdldRQfw8CojnFKSGQWe46IDUUf5MHE8zVl3YNMtDgETOmNi2pnodyDmk73AH9fBgxc7uDb3PB1cZcSfM8TkRmmSov5t9JqkCEHk6jr6cj+HHlBp89bP3/r5Wz//f/Xz8FA/1+3ztH6+Xb10aTy6er3Q0zeq11tPf+vpJ/T0qE2GIRJ4KxPCc/T0TNQdfeM3LqhtfTEj9Kodt+2kyLQXf0M/HFxHw8AaJEFk+eF1YsXQiaxkOJQJ5PoADv0v7YFaJl0VeYmT/HHG8N1M6Dq3K4nBSzEoMCKrpBCXoGc70HYdF6zlkTYcEOhIWWArS0KpSq9NYaJzCDMRbN9vLfCds5PXiHPeiPTaiIyKPMPG7ax82ImLroGnxoUXmUTvDc13/jg7at96nnN9FULHGnpeaPlJElkwjq6sHvRhHDtXYOC5q33LledEWtd1u377+s8v377+e4a9qi/tebIs9TdcNHfGjOXSkTjuhe4AxlYM/MTyh73IukrCwEoCz/cHMbwaeNdf1Lk08Pspw/qw+9esPSYH/rOD8jJPGeV0It6ltGxO3O2KPmFW0VwfugOnOSafI1WvI8+TjdPzeo1M0rb2qq1Vwo+U//JasE+oupvrTVLqBjbQj6qcPDZ7ZD1E+d7+l+HyPwAAAP//AwBQSwMEFAAGAAgAAAAhANaIglQrAwAAuggAACEAAABwcHQvc2xpZGVMYXlvdXRzL3NsaWRlTGF5b3V0Ni54bWysVu1u0zAU/Y/EO1jhd5bPtlm1dmrSZkIabKLjAUzirtEc29hu14KQeC14nD0J1068jTHQhPondq6vr8859zo3J6e7lqItkarhbOJFR6GHCKt43bDriffxqvQzDymNWY0pZ2Ti7YnyTqevX52IsaL1Od7zjUYQg6kxnnhrrcU4CFS1Ji1WR1wQBmsrLlus4VVeB7XEtxC7pUEchsOgxQ3z+v3yJfv5atVUZM6rTUuY7oJIQrEG/GrdCOWiiZdEE5IoCGN3/w5J7wWw1Y2m5ILRvYesq9yCMfKmwL5a0hox3ILhyngh62ZWlLiShJgZ255JsRSX0m54v72UqKlNgH6jF/QLvZt9ZVs7CZ5sv3ZTPN6tZGtG0ALtJh6kbG+egbGRnUZVZ6werNX64hnfar14xjtwBwSPDjWsOnB/0okdnU6H6J6Vw6vEOa9uFGIc+Bj6Hb17j46zGcX6sfC9X7doJw9gerH0Luf13hzyCUZrxGOq9FLvKbEvwjwsDAl4KTZ1TZh/lnca6GlBm+oGaY5I3Wj0DitNJLLnQ+FDFCOItrLYKITVl1jiD0+CobqR+pGEwiJ28AKn399VTJyKc6wJuqS4ImtOa8ASH0LQWsM9/gJ3AtOVBwdC0qMO60EEXsFlMCy+ZumwWIzmA78oByM/HS5KP8/CkV/O5+EgjNMom6ff3PWqgapuWlI21xtJLjbaey5PSLW6oASz+8LV0+g4CDO4r3H0kB7A8I8E/WdaUpeWknNTGI8TkxwiMSstu8x83mAJJ7jkuL0HSM5hFRk4RZa0qQl6v2k/PdElPYQu0F0g9LPS2Atx4LpNknAxG2ahP0+SoZ+W5cjP8tHMP87SLM/DWVQk8X3dKsOcAbqXluvd9x9v7r7/PECt2sH1F/jYnyvdz9BGNkAkz4+HcZHlfh6lpZ/Oj0f+rBwO/HKQpGmRZ7MiWXwzfSpKx5UktvW9rV3TjNI/2mbbVJIrvtJHFW/7/hsIfkuk4I1twVHYN80tpvAhi6MwieLBIOvTBNjcaNGaxC8NfxipfIfFxdYWSWs/vYU1CfhH6GvkwcVwd/8c018AAAD//wMAUEsDBBQABgAIAAAAIQAZklI58AIAAGsHAAAhAAAAcHB0L3NsaWRlTGF5b3V0cy9zbGlkZUxheW91dDcueG1srFXhbpswEP4/ae+A2G8KBEJI1KQKEKpJXRst3QO4YBpUsD3byZJNlfpa2+P0SXY2OO3aTuqP/MHmuDvf933H+fRs1zbWFnNRUzK1/RPPtjApaFmT26n97Tp3YtsSEpESNZTgqb3Hwj6bffxwyiaiKS/Qnm6kBTmImKCpvZaSTVxXFGvcInFCGSbwraK8RRJe+a1bcvQDcreNO/C8yG1RTew+nr8nnlZVXeCMFpsWE9kl4bhBEuoX65oJk429JxvjWEAaHf1vSXLPAO1Ng8idbWk3vgWDb88AebFqSougFgyJ9lBGwa45xmpHtuecrdiSa9/L7ZJbdali+xjb7T/0bvqVbPXGfRF+a7Zosqt4q1agwNpNbVBqr56usuGdtIrOWDxZi/XVG77FevGGt2sOcJ8dqlB1xb2GMzBwMiSxtWxQgde0KTG3/ANAU7pgF7S4ExahAE0x0SE9eHTw1crWPfWlhMb7CSKiprLhQCjX7wo1znrzVGfPo9wltNyrQ29g1UY0aYRcyX2D9QtTjwoUVCh+xWGULkbZ0Enz4cgJo0XuJLE3cvIs84beIPTjLLw3/VACVFm3OK9vNxxfbaStcnFgBNoAfhhMnPME6m5l2mBEDpTLmT92vRgabOArpqXmG2rQ2pFyiTj6+iJLpwnTOA0o1wjyf1kCI0tOqQQxngszOIYwleSdMt83iMMJRhwTewRxjstIaBhZNXWJrctNe/OCl+AYvMA4hNRvUqN5P3LfBoG3mEex52RBEDlhno+cOBnNnXEcxknizf00GBz6VijkBKp7b7s+Pvz+9Pjw5wi9qhczGWFMXQjZ76wNrwFIkoyjQRonTuKHuRNm45Ezz6Ohkw+DMEyTeJ4Gi3s1Yf1wUnCsZ/Xn0kx5P3w159u64FTQSp4UtO0vDJfRH5gzWus7w/f6Kb9FDfwxfhgFcQzE9TJBbWbV1SrhVwo/rA3/gtjVVjcJHAYip9rE4FLre+TJRWE3l+TsLwAAAP//AwBQSwMEFAAGAAgAAAAhAB9gs7fRBAAAdhIAACEAAABwcHQvc2xpZGVMYXlvdXRzL3NsaWRlTGF5b3V0OC54bWzEWN1yozYYve9M30FDrwkIBMieTXZiO+x0Jptk6vQBFJBjuoCokB17Ozuzr9U+zj5JJYH8F8cmTjq9MR/46Ejfd6Qj0IePiyIHc8rrjJXnFjxzLUDLhKVZ+Xhu/X4f29gCtSBlSnJW0nNrSWvr48XPP32o+nWeXpMlmwkgOcq6T86tqRBV33HqZEoLUp+xipbyvwnjBRHylj86KSdPkrvIHc91Q6cgWWm17XmX9mwyyRI6YsmsoKVoSDjNiZDjr6dZVRu2qgtbxWktaXTr7SGJZSWzZQ9/3C8soGF8Lh9A60JmnozzFJSkkA+GrBSSATxlYgqGpFJMGlNX95xSFZXzT7waV3dcN72Z33GQpYqqpbCc9o8Wpm/LuQ6cneaPJiT9xYQX6iorAhbnlhRuqX4d9YwuBEiah8n6aTK93YNNpld70I7pwNnoVGXVDO55Op5J5z4TOQVwlZUZb11ds+RLDUom81HpN+mtEE3O6lpN2/ILRdXimj91sB7M3kpgvxdhrFNEQSQ13a6J3/M9z4+aXGHoui1iM+OGueqLxYClS9X6QV5lpqRMpkxO1IeGM6/FWCxzquN5DtsBpXTymwTXX2Vva/YVQMUbDSv1o9tx2SgnauXR0v40aPoQF8M8S74AwQBNMwE+k1pQDnRt5NKUJIpQaFrNQsv0jnCiRrBJBtKMiw15K52pyVAnfVhh3yhs5vxdThI6ZXkqh+O9Te8sXawh3aUOIPZhq3UPR8gLtrUOYeQpAbTWCEd+2CC6aP0GgXXoPcd6eBNrADL092DRJtYAZIj2YN1NrAHIMDiGNQAZhsewBiDD6BjWAGSIj2ENQIa9Y9gGsG8BVWq6z/OVrb1+QalJo9dTvbWgmqWy24ueq4d7GdOElSnI6ZzmHRj1CjrMeD/NeHdC/zhhzGZc7ltdGVEHxmyyl/C/syW02niUgJuepAvw1j1ImYGlZ+KU5BOrcSqt1ambkucGUbu4X9iVfAxhINFvdCpQEH6tt/WsTKVhq1C3mt3IdzndamOhqa3wRSNrqdr9tBvfloHtmF3L14NIobrxbRntjiG2fNCPdBrdCA+5piHEHlamfQLhjrW2hJ6HQwU7gXDHfw1hhPQWdALhjkm3hIqtuyiHnNwQhkF0oij/m92/zoICY0EjIuiWBWnHfKsFpeKZAcGmSC86kO71oE/oG13KifyYUVn8hVE4vIpGgT2Mg8hG4VVsD7Ab2fFo5AauhyAeoW/m0yiVqYqsoHH2OOP0dia0qLsKgLoQw5ySciWUuIA9x8XyW8uD68LLMRzYI07cGUIjS8yYknxTGP0a+FZhJoI3yvw5I1z2YMQ58iL7GnHetyKRqcg4z1IKbmbFw05dwveoS52nknpvaY7snCfNW993ry5D7Noj3w9tFMeRjQfRpd3DCA8G7iUc+t5q3tYq81KOrut0/fH9719+fP/nHeaqvphTAWk/17VoIzDjmUxkMOiF3hAP7AFEsY1Gvci+jMPAjgMfoeEAXw79q2/qdAGifsKpPrb4NTUHHhA9O/IosoSzmk3EWcKK9uzEqdgT5RXL9PEJdNsDjzlRr4wwghhBFGjfcvTYzFWPVgk/VvnLa84/k+p2ridJoU11qB9VWfnYzpE1ROVuzosu/gUAAP//AwBQSwMEFAAGAAgAAAAhAC69lGe8BAAAhxIAACEAAABwcHQvc2xpZGVMYXlvdXRzL3NsaWRlTGF5b3V0OS54bWy8mFlu4zYYx98L9A6E+qxI1Eobkwy8xIMCmSRo0gMwEh0Lo4UlaceeYoC5VnucOUlJirKkrI5H6ItFyR9/5LfwT4kfPm6LHGwI41lVnlrwxLUAKZMqzcr7U+vP24WNLMAFLlOcVyU5tXaEWx/Pfv3lAx3zPL3Au2otgGSUfIxPrZUQdOw4PFmRAvOTipJS/resWIGFvGX3Tsrwg2QXueO5buQUOCst058d0r9aLrOEzKtkXZBS1BBGcizk/Pkqo7yh0UNolBEuMbp3f0piR6W3NEtutxbQZmwjH0DrTHqe3OQpKHEhH1xniVgzAh4ysQIzTBVJ23B6ywhRrXLzidEbes1018vNNQNZqlAGYTnmD2Omb8uNbjiPut83TTzeLlmhrjIiYHtqycTt1K+jnpGtAEn9MGmfJqurZ2yT1fkz1k4zgNMZVHlVT+6pO17jzm0mcgLg3qtmvpxeVMkXDspK+qPcr93bW9Q+qytdmfALhTJ29Z+60U7m2UggfxQjpF0MwljmtB8Tf+R7nh/XvsLIdY1F1+OaTMdiO63Snep9J6/SU1wmq0oW6l3NzLm4Ebuc6PYmh2ZCKVn+IY35VzlaS98bqHanI1U/uh+TnXKsVh4p7U/TegxxNsuz5AsQFSBpJsBnzAVhQMdGLk0JUUChsZpCyvQaM6xm0IWBNGOik16qPW081E6/nmG/yXBT89c5TsiqylM5He/tfMvWbCUnRCackkQcVgJyBVpy9G1rfXghhBD50FTCCMWBF/YrIYKxp9KjKyFAsR/VFu+qBPFiJYACswu9qrIylSqjmhqwvpRSqnu9USi66bUoU84H8TzU5SmI4fktbwSD4GCestzzFMTwgpYH/VgtqAOBbheoKAYYdoDIQ8qPI4CKYoBRC/Q8FCmzI4CKYoBxBxgHOnNHABXFAFELVLTDk9IDKooBjjrAKIyPTIqiHCtXWVKVSrNwmgJaC8b/pFPBfidSC70rUv4Qm5Ja/5YO1grnSyNOWv6O3aU8N4zN6nphm/IRhKG0PlCchlEkvZQHVCTYU5CfVyTYU8wBFAkOrUh94ACK1AcOoEh94ACK1AcOoEh94MuKpPDSYP9a+/4XKrXy9PsU7wnVMRIUNhI0x6L/nhQMIUGpeCJAsA7SiwqkR31VJ/SNDuVSft0oL/5GQTQ7j+ehPVuEsR1E5wt7itzYXsznbuh6AUTz4FvzrZRKV0VWkEV2L7X+ai10Uh9nAPBCzHKCy32ixBkcOS6SH18ebAMv5/DKHnHkzhA1aVlUlUp5NzH6ze9nE7MUrM7MX2vM5AhNct54d31PcoaNSNxE5CbPUgIu18Xdo7hEQ8SF56lEPxuaN3bOo+rW993zSYRce+77kR0sFrGNpvHEHqEATafuBM58b1+3XHleytkdWq4/vv/z24/v/w5Qq/rSHBNI+bngwrTAmmXSkel0FHkzNLWnMFjYwXwU25NFFNqL0A+C2RRNZv75N3XcAINxwog+x/g9bU5AYPDkDKTIElbxailOkqowhykOrR4Io1Wmz1Oga05ANliKKYwhGoVI7ikmTXJuzVXPViX+Rvkvrzn7jOnVRhdJoUV1ph/RrLw3NdKaKN+bA6Sz/wAAAP//AwBQSwMEFAAGAAgAAAAhAHKCiv6mAwAAlwsAACIAAABwcHQvc2xpZGVMYXlvdXRzL3NsaWRlTGF5b3V0MTAueG1stFbdjto4FL5fqe9gpdeZJBAgoEJFgFQrTTujQvfeTczEqhO7tqHQVaW+1u7j9En22Ilh/jpLW3oT/+T48znfd2yfFy93FUNbIhXl9diLLkIPkTrnBa1vxt67VeYnHlIa1wVmvCZjb0+U93Ly7I8XYqRYcYn3fKMRYNRqhMdeqbUYBYHKS1JhdcEFqeHfmssKaxjKm6CQ+BNgVyzohGE/qDCtvXa9PGU9X69pTuY831Sk1g2IJAxr8F+VVCiHJk5BE5IogLGr77qk9wKiBWL0auchaye3MBN5Ewg9X7IC1biCiRXVjCAgCP0FxjTHDK3ITlszJVaSENOrt6+kWIpraVe/2V5LRAuD1qJ4QfujNbPDems7wb3lN66LR7u1rEwLrKDd2APx9uYbmDlwAuXNZH6czcurR2zzcvGIdeA2CG5taqJqnHsYTseF05ASHaJy/ipxyfMPCtUc4jHhN+EdLJqYTSvKVgJtoFq75qftHJ1pydK7lBd7s8l7aO0kHjGll3rPiB0I87FuSPCXYZPhpPZfpQ0HejJjNP+ANEekoBq9xkoTiez+cAQAxRCiLS0WhdTFNZb47T0wVFCpb1EorMfOvcDx930Wu47FOwmFrhnOSclZAU51zsGs4clDXFI4AU2qe7D/7rj4R+g2dwigEGycbgh9SL4wVG3ZIe1+XAxDhNVC3RGjofn+LjaOp3dZkpzD0WVkS9gJiJb3pxFXJZWnA3b/HzDjG6nLkxHjExDp+lHA35fSsUvpOdbkTiZbAn41kwvIXPUZLnzM1i6HG1/Pcmes4bI3UfydxP3ZYjDv+bOsN/Dj/iLz0yQc+Nl8HvbCThwl8/iLezsKCFXTimT0ZiPJ1cY8CQ8lQarSM0ZwfTgUehINgzCBx6gTHeUBH54Q6Cdl6TlZMs7N8botjM2jXxVmrWWjzMcNlrCDE+dnbpjviHNeRvqOkSWjBUFvNtX7e7z0zsELlE4A/Sg19oo5c952u+Fi2k9Cf97t9v04ywZ+kg6m/jCJkzQNp9Gs2znkrTKR1+Ddqen67es/z799/fcMuWobVzLBVX+pdNtDG0khkDQd9juzJPXTKM78eD4c+NOs3/OzXjeOZ2kynXUXX0zpFcWjXBJb1/1ZuIowih/UhBXNJVd8rS9yXrXFZSD4JyIFp7a+jMK2Itxi8wDAqRyGvbjnVAbfXGu9NcIvTfzQMvkai6utTZLKPmAzOyWgAG5z5GhiYncF9eQ/AAAA//8DAFBLAwQUAAYACAAAACEA/A1DZtsDAAB3DAAAIgAAAHBwdC9zbGlkZUxheW91dHMvc2xpZGVMYXlvdXQxMS54bWy0V8uO2zYU3RfoPxDqWqP3w0bswLKtoMAkM4jd7hmJHhOhRJWkHbtFgPxW+zn5klxS0jw8juPpTDamRF0ennsOL0m/er2rGNoSISmvR5Z34VqI1AUvaX0zsv5Y5nZqIalwXWLGazKy9kRar8e//vKqGUpWXuI93ygEGLUc4pG1VqoZOo4s1qTC8oI3pIZvKy4qrOBV3DilwJ8Au2KO77qxU2FaW914cc54vlrRgsx4salIrVoQQRhWwF+uaSN7tOYctEYQCTBm9ENKat9AtiCMWlLFyKQulzsLmXixhS+eNQYJigUrUY0r6PgTQmmBGTLxCBRDS7JTJkw2S0GIfqq3b0SzaK6FGf1uey0QLTVah2I53YcuzLzWW/PgHAy/6R/xcLcSlW5BHbQbWWDiXv86ug9IoKLtLO56i/XVkdhiPT8S7fQTOPcm1Vm15B6n4/fpHIji3abXE5fNJS8+SlRzSEzr0OZ5G9Emr9tm3XmiNJSFuKDgXGtRN6oNNQ93HI8KlCZ+OHDb1IM48vzooVZ+7Kfmu9YgSj0vDdJDJVroZqh2GS/3evQHaEEBzWhkEayTb2GZVAu1Z8S8NPrHkBIQzLAuNFLbb7I2Vo2njBYfkeKIlFSht1gqIpDJGioRUDQLZbgYFFKX11jg9wdgqKRC3XOwMaR7sob/aRODxyZqea4ZLsiasxJI+S/hp1btwE6Yf3c3+Am2Bql/wtUkCcLgZ7raaA+27Lacnu6ypmpMlg9cbv07nMUIdHqWBSk47ESMbAk7A9EYehpxuabifMDgx4A53wi1PhsxPAORro4C/rxaCftamWFFHpSIEeC5JVJCSci/4UDDbNUXR8v1u9VhZj1cxN9Ztis4xHQW/6RhPJ0ns8ie5lFih/E8t7PUTex8NnMj1w+9dBZ+7s/GElJVtCI5vdkIcrXRR91jS5Cs1JQRXN8WhRp7A8dN4bD1vTt7gMMJg/6nLVFvS865Lq/7xph19FxjVkq0zvy1wQJm6M35wdb1FHNeVpG4V2TBaEnQu0314UAXs2c+Vxe4GgL0UWnMFvPC6zYI3PkkTl17FgSxHeZ5YqdZMrEHaZhmmTvxpoF/u26lzrwGducu169f/v3t65f/XmCtmqa/CsJWfylV94Q2gkIiWTaI/Wma2ZkX5nY4GyT2JI8jO4+CMJxm6WQazD/rK6UXDgtBzL3197K/8XrhoztvRQvBJV+pi4JX3eXZafgnIhpOzf3Zc7sb7xbr/TpMBmEYxVHS2QTc+taw1cYvdP7QMvEWN1dbs0gqc4BNTVcDF/xujdyF6Nz7PwzjbwAAAP//AwBQSwMEFAAGAAgAAAAhAGmiXyEVAQAAxwcAACwAAABwcHQvc2xpZGVNYXN0ZXJzL19yZWxzL3NsaWRlTWFzdGVyMS54bWwucmVsc8TVTWrDMBAF4H2hdzCzjyU7iZOUyNmEQqCrkh5AWOMfaktGUkp9+4qWQgxhaCGgjcCS9ebjbbQ/fA598oHWdUYLyFIOCerKqE43At7Oz4stJM5LrWRvNAqY0MGhfHzYv2Ivfbjk2m50SUjRTkDr/fjEmKtaHKRLzYg6nNTGDtKHT9uwUVbvskGWc14we50B5SwzOSkB9qTC/PM04l+yTV13FR5NdRlQ+xsjmOs7hS9yMhcfYqVt0AtI0+v92U/bNIwAdlu2jClbUrJNTNmGkmX5PWk+3MUZ6nvnZ80ox10Z/20oJxuKKSM7K2LKCrKzuKWRra1j0tZkazxqa5yyrWLSVpRsF1O2+5Wx2fNbfgEAAP//AwBQSwMEFAAGAAgAAAAhANXRkvG8AAAANwEAACwAAABwcHQvc2xpZGVMYXlvdXRzL19yZWxzL3NsaWRlTGF5b3V0MS54bWwucmVsc4zPvQrCMBAH8F3wHcLtJq2DiDR1EcHBRfQBjuTaBtsk5KLo25vRgoPjff3+XLN/TaN4UmIXvIZaViDIm2Cd7zXcrsfVFgRn9BbH4EnDmxj27XLRXGjEXI54cJFFUTxrGHKOO6XYDDQhyxDJl0kX0oS5lKlXEc0de1Lrqtqo9G1AOzPFyWpIJ1uDuL4j/WOHrnOGDsE8JvL5R4Ti0Vk6I2dKhcXUU9Yg5Xd/tlTLEgGqbdTs3fYDAAD//wMAUEsDBBQABgAIAAAAIQDV0ZLxvAAAADcBAAAsAAAAcHB0L3NsaWRlTGF5b3V0cy9fcmVscy9zbGlkZUxheW91dDIueG1sLnJlbHOMz70KwjAQB/Bd8B3C7Satg4g0dRHBwUX0AY7k2gbbJOSi6Nub0YKD4339/lyzf02jeFJiF7yGWlYgyJtgne813K7H1RYEZ/QWx+BJw5sY9u1y0VxoxFyOeHCRRVE8axhyjjul2Aw0IcsQyZdJF9KEuZSpVxHNHXtS66raqPRtQDszxclqSCdbg7i+I/1jh65zhg7BPCby+UeE4tFZOiNnSoXF1FPWIOV3f7ZUyxIBqm3U7N32AwAA//8DAFBLAwQUAAYACAAAACEA1dGS8bwAAAA3AQAALAAAAHBwdC9zbGlkZUxheW91dHMvX3JlbHMvc2xpZGVMYXlvdXQzLnhtbC5yZWxzjM+9CsIwEAfwXfAdwu0mrYOINHURwcFF9AGO5NoG2yTkoujbm9GCg+N9/f5cs39No3hSYhe8hlpWIMibYJ3vNdyux9UWBGf0FsfgScObGPbtctFcaMRcjnhwkUVRPGsYco47pdgMNCHLEMmXSRfShLmUqVcRzR17Uuuq2qj0bUA7M8XJakgnW4O4viP9Y4euc4YOwTwm8vlHhOLRWTojZ0qFxdRT1iDld3+2VMsSAapt1Ozd9gMAAP//AwBQSwMEFAAGAAgAAAAhANXRkvG8AAAANwEAACwAAABwcHQvc2xpZGVMYXlvdXRzL19yZWxzL3NsaWRlTGF5b3V0NC54bWwucmVsc4zPvQrCMBAH8F3wHcLtJq2DiDR1EcHBRfQBjuTaBtsk5KLo25vRgoPjff3+XLN/TaN4UmIXvIZaViDIm2Cd7zXcrsfVFgRn9BbH4EnDmxj27XLRXGjEXI54cJFFUTxrGHKOO6XYDDQhyxDJl0kX0oS5lKlXEc0de1Lrqtqo9G1AOzPFyWpIJ1uDuL4j/WOHrnOGDsE8JvL5R4Ti0Vk6I2dKhcXUU9Yg5Xd/tlTLEgGqbdTs3fYDAAD//wMAUEsDBBQABgAIAAAAIQDV0ZLxvAAAADcBAAAsAAAAcHB0L3NsaWRlTGF5b3V0cy9fcmVscy9zbGlkZUxheW91dDUueG1sLnJlbHOMz70KwjAQB/Bd8B3C7Satg4g0dRHBwUX0AY7k2gbbJOSi6Nub0YKD4339/lyzf02jeFJiF7yGWlYgyJtgne813K7H1RYEZ/QWx+BJw5sY9u1y0VxoxFyOeHCRRVE8axhyjjul2Aw0IcsQyZdJF9KEuZSpVxHNHXtS66raqPRtQDszxclqSCdbg7i+I/1jh65zhg7BPCby+UeE4tFZOiNnSoXF1FPWIOV3f7ZUyxIBqm3U7N32AwAA//8DAFBLAwQUAAYACAAAACEA1dGS8bwAAAA3AQAALAAAAHBwdC9zbGlkZUxheW91dHMvX3JlbHMvc2xpZGVMYXlvdXQ2LnhtbC5yZWxzjM+9CsIwEAfwXfAdwu0mrYOINHURwcFF9AGO5NoG2yTkoujbm9GCg+N9/f5cs39No3hSYhe8hlpWIMibYJ3vNdyux9UWBGf0FsfgScObGPbtctFcaMRcjnhwkUVRPGsYco47pdgMNCHLEMmXSRfShLmUqVcRzR17Uuuq2qj0bUA7M8XJakgnW4O4viP9Y4euc4YOwTwm8vlHhOLRWTojZ0qFxdRT1iDld3+2VMsSAapt1Ozd9gMAAP//AwBQSwMEFAAGAAgAAAAhANXRkvG8AAAANwEAACwAAABwcHQvc2xpZGVMYXlvdXRzL19yZWxzL3NsaWRlTGF5b3V0Ny54bWwucmVsc4zPvQrCMBAH8F3wHcLtJq2DiDR1EcHBRfQBjuTaBtsk5KLo25vRgoPjff3+XLN/TaN4UmIXvIZaViDIm2Cd7zXcrsfVFgRn9BbH4EnDmxj27XLRXGjEXI54cJFFUTxrGHKOO6XYDDQhyxDJl0kX0oS5lKlXEc0de1Lrqtqo9G1AOzPFyWpIJ1uDuL4j/WOHrnOGDsE8JvL5R4Ti0Vk6I2dKhcXUU9Yg5Xd/tlTLEgGqbdTs3fYDAAD//wMAUEsDBBQABgAIAAAAIQDV0ZLxvAAAADcBAAAsAAAAcHB0L3NsaWRlTGF5b3V0cy9fcmVscy9zbGlkZUxheW91dDgueG1sLnJlbHOMz70KwjAQB/Bd8B3C7Satg4g0dRHBwUX0AY7k2gbbJOSi6Nub0YKD4339/lyzf02jeFJiF7yGWlYgyJtgne813K7H1RYEZ/QWx+BJw5sY9u1y0VxoxFyOeHCRRVE8axhyjjul2Aw0IcsQyZdJF9KEuZSpVxHNHXtS66raqPRtQDszxclqSCdbg7i+I/1jh65zhg7BPCby+UeE4tFZOiNnSoXF1FPWIOV3f7ZUyxIBqm3U7N32AwAA//8DAFBLAwQUAAYACAAAACEA1dGS8bwAAAA3AQAALAAAAHBwdC9zbGlkZUxheW91dHMvX3JlbHMvc2xpZGVMYXlvdXQ5LnhtbC5yZWxzjM+9CsIwEAfwXfAdwu0mrYOINHURwcFF9AGO5NoG2yTkoujbm9GCg+N9/f5cs39No3hSYhe8hlpWIMibYJ3vNdyux9UWBGf0FsfgScObGPbtctFcaMRcjnhwkUVRPGsYco47pdgMNCHLEMmXSRfShLmUqVcRzR17Uuuq2qj0bUA7M8XJakgnW4O4viP9Y4euc4YOwTwm8vlHhOLRWTojZ0qFxdRT1iDld3+2VMsSAapt1Ozd9gMAAP//AwBQSwMEFAAGAAgAAAAhANXRkvG8AAAANwEAAC0AAABwcHQvc2xpZGVMYXlvdXRzL19yZWxzL3NsaWRlTGF5b3V0MTAueG1sLnJlbHOMz70KwjAQB/Bd8B3C7Satg4g0dRHBwUX0AY7k2gbbJOSi6Nub0YKD4339/lyzf02jeFJiF7yGWlYgyJtgne813K7H1RYEZ/QWx+BJw5sY9u1y0VxoxFyOeHCRRVE8axhyjjul2Aw0IcsQyZdJF9KEuZSpVxHNHXtS66raqPRtQDszxclqSCdbg7i+I/1jh65zhg7BPCby+UeE4tFZOiNnSoXF1FPWIOV3f7ZUyxIBqm3U7N32AwAA//8DAFBLAwQUAAYACAAAACEA1dGS8bwAAAA3AQAALQAAAHBwdC9zbGlkZUxheW91dHMvX3JlbHMvc2xpZGVMYXlvdXQxMS54bWwucmVsc4zPvQrCMBAH8F3wHcLtJq2DiDR1EcHBRfQBjuTaBtsk5KLo25vRgoPjff3+XLN/TaN4UmIXvIZaViDIm2Cd7zXcrsfVFgRn9BbH4EnDmxj27XLRXGjEXI54cJFFUTxrGHKOO6XYDDQhyxDJl0kX0oS5lKlXEc0de1Lrqtqo9G1AOzPFyWpIJ1uDuL4j/WOHrnOGDsE8JvL5R4Ti0Vk6I2dKhcXUU9Yg5Xd/tlTLEgGqbdTs3fYDAAD//wMAUEsDBBQABgAIAAAAIQA313VzHwYAAKkaAAAUAAAAcHB0L3RoZW1lL3RoZW1lMS54bWzsWU+LGzcUvxf6HcTcHY/tGf9Z4g3jsZ202U1CdpOSozwjzyjWjIwk764JgZIcC4XStPRS6K2H0jaQQC/pp9k2pU0hX6Eajcce2XKXNBtYaGzwSG9+7+mn956eNJ7LV04SAo4Q45imXat2ybYASgMa4jTqWncOh5W2BbiAaQgJTVHXmiNuXdn98IPLcEfEKEFA6qd8B3atWIjpTrXKAymG/BKdolTeG1OWQCG7LKqGDB5Luwmp1m27WU0gTi2QwkSapeMxDhBQJq3dwviAyJ9U8EwQEHaQmUYLjZu5xuFSI5zUsgufc58wcARJ15KjhfT4EJ0ICxDIhbzRtWz1saq7l6tLJSK26Jb0huqz0FsohJO60mPRaKnoOK7T9Jb2FYCITdygNWgOmkt7CgCDQM4356LbbNV9Z4EtgfKmwXa/1W/UNHzJfmMD77nZV8MrUN50NvDDob/yYQmUN90NvNvr9Pq6fQXKm80NfMv2+k5LwytQTHA62UDbbrPhF7NdQsaUXDPCO64zbNUX8BWqWsqxXD8V/55xCbxP2VDCVIihwCkQ8ykaw0CifUjwiGGwh6NYpt8UppRLsV23h3ZD/mZfR7VUXOEOgiXtXBTwDVHGCvCA4anoWh9Lq1YJ8vrFj69fPAOvXzw9ffT89NEvp48fnz762aB4DaZRWfHV91/8/e2n4K9n37168pUZz8v433/67LdfvzQDRRn48uunfzx/+vKbz//84YkB7jE4KsMPcYI4uIGOwW2ayLkZBkAj9mYahzHEZQ0vjThMYaZjQA9ErKFvzCGBBlwP6R68y2S9MAGvzu5rhA9iNhPYALweJxpwn1LSo8w4p+vZWGUvzNLIPDiblXG3ITwyje2vxXcwm8osxyaTfow0mreIDDmMUIoEyO7RCUIGtXsYa37dxwGjnI4FuIdBD2KjSw7xSMumldI1nMi4zE0EZbw13+zfBT1KTOb76EhHylUBickkIpobr8KZgImRMUxIGbkHRWwieTBngeZwLmSkI0QoGISIc5POTTbX6F6XFcYc9n0yT3QkE3hiQu5BSsvIPp34MUymRs44jcvYj/hEpigEt6gwkqD6Csn6Mg4w3Rruuxhp4T57bd+RxdWcINmdGTMtCUT19TgnY4iU8epaSU9wemZ9X6vs7vvKbq7sHsPGpbVez7fh1qu4T1mIL34R78NZegvJdfO+hr+v4f/HGr5tPZ9/5V4Va3WsLw7vykxyxkl+jAk5EHOC9rgq9lxOMhxKoeoo1eXjwzSWzcWgGi5iULUBo+ITLOKDGE7lYDU1QsQXpiMOppTL7UKJjbbVdjNL9mmYS2u14olVKkCxksvtppDLzUnk0mZr9Wi2NK96kXqQLghkum9CojSYTqJhINEqhGeQUDM7FxYdA4t2Zn4rC3VZREWuQgCzvzxcJ2cksw4SFGZxyvWL6J57pLc5U5923TC9Tsb1fCKtkSilm06ilIYxDNG6+Jxj3VmFVKOXuWKTRqv9LmKdlZK12kBSvQeO5ZpruNJMAKddaywPirKZTKU9nlVPSKK0awVi4ej/UlmmjIs+5HEOU7fy+SdYIAYITmSul8NA0hW3Wr2VzfGCkuvYF89z6lIOMhqPUSC2SFZdeS83Yrz7luCsQ2eS9EEcHoMRmbHbUDrKbdUyB4aYi6U3Q8xKyb3y4lq5WixF7Z+01RKFZBrDxY5SLuY5XLWXdErzUEzXZ6X3F5MZRVmQ3nrXPVtprWhu2UCyXdNcP97dJl9itar7Gqu8dK/Xuk5R67btEm+/IZSorQbTqGWMDdS27R3neCAoDbdMzW17xHnvButZm20QxelS9TZeXNDRfZn5fXlonRHB8z8ETuSTgl/82ZxXAiUtqsuJADOGu9YD2/Ucv+76FbvtDipOw7ErbddrVDzXbdQGbs3u9+oPpVNEnNTcfOyhfKoh88V7GSXfeDeTFIftSwFNqvm7l6pSVu9manXt3Yx2WgZYeuZBsz7sNDq9ZqXT8IYVp99rVzp+s1fpN/1Wf9j33XZn+NACRwrseA3faQ7alWbN9ytO087otzuVllOve07Law8c7+HC13LmxbVwr+K1+w8AAAD//wMAUEsDBAoAAAAAAAAAIQBCx70KswQAALMEAAAXAAAAZG9jUHJvcHMvdGh1bWJuYWlsLmpwZWf/2P/gABBKRklGAAEBAQBgAGAAAP/bAEMAAwICAwICAwMDAwQDAwQFCAUFBAQFCgcHBggMCgwMCwoLCw0OEhANDhEOCwsQFhARExQVFRUMDxcYFhQYEhQVFP/bAEMBAwQEBQQFCQUFCRQNCw0UFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFP/AABEIAJABAAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/AP1TooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9lQSwMEFAAGAAgAAAAhABgLERuKAQAAMAMAABEAAABwcHQvcHJlc1Byb3BzLnhtbKzSzYrbMBAA4Huh72B0V/Rj2YlNnEWOFCj0UMr2AYQtJ6K2ZCRld0vpu1d1sku2pbCUnkZCzOgbabZ3T9OYPWgfjLMNICsMMm071xt7bMCX+wPcgCxEZXs1Oqsb8E0HcLd7/24717PXQduoYkr95LNUyIZaNeAU41wjFLqTnlRYuVnbdDY4P6mYtv6Ieq8e0wXTiCjGJZqUseCa79+S74bBdFq47jwlwKWI1+MiCSczh+dq81uq3fbxirRLTeqn+DHE6yo7e9OA73Jd7mXFOCxxvoeMMArbSrawFCRfY0wwp+sfv7IJq3sTOuX7D5M6atmbKFRUzzjC/uBNpvMuuCGuOjdd+0Sze9R+dmZpleDrez2osQEYoN0WLbjXRpETjkvK4bracMhyWkHeCgHblm+KsqS4IPjFqAd1HuNiFLP5jzxK/wo8iEIeOBcQy72ErMglrDY5gaxsad7KFHJ2ARZ1d1I+3nvVfU1T81kPrQq6f2EW/8Kkt0xyi7zE5dPR70O++wkAAP//AwBQSwMEFAAGAAgAAAAhAKx/WCiHAQAAKgMAABEAAABwcHQvdmlld1Byb3BzLnhtbIySwU7DMAyG70i8Q5Q7a4dQt1XrEAjBhQPSBvco8bqgNonibHR7ety0G53GYbfa/v37s5v5Y1NXbAcetTUFH49SzsBIq7QpC/65er2bcoZBGCUqa6Dge0D+uLi9mbt8p+HnwzMyMJiLgm9CcHmSoNxALXBkHRiqra2vRaDQl4ny4oeM6yq5T9MsqYU2vO/31/Tb9VpLeLFyW4MJnYmHSgSCx412eHRz17g5D0g2sfsMaUHLmVZYfXUrbqw/PAu/JC2doBaNrvUBVBSSSbAe1DusA8MD3XA2m9xzJrbBPqnvLYaCpzwZSlfWReXsIctiKTmf12qx0gr+QrmsVA+DRriVffNatcax2Fd2hChFRYjjmMc2WMxFjg2jnzvNOKOecRpnUnZ/mU1OXS63XpfasIZASbMn6XTaa/qJrarcEug7hr5w4uy8zrcwNgCuoAmDxQYrn+OOO64h6yD1P2gaOY+bnLzjfS9Gl3TCpROSXiST1DzJ6AlwJvfHz86le+aLXwAAAP//AwBQSwMEFAAGAAgAAAAhANj9jY+sAAAAtgAAABMAAABwcHQvdGFibGVTdHlsZXMueG1sDMxJDoIwGEDhvYl3aP59LUNRJBTCICt36gEqlCHpQGijEuPdZfnyki/NP0qil1jsZDQD/+ABEro13aQHBo97g2NA1nHdcWm0YLAKC3m236U8cU95c6sUV+vQpmibcAajc3NCiG1Hobg9mFno7fVmUdxtuQykW/h705UkgecdieKTBtSJnsE3qoIgorTAp8vliGlIA1x6NMZxVNbVuan9Kix+QLI/AAAA//8DAFBLAwQUAAYACAAAACEA1I3ebFUBAACZAgAAEQAIAWRvY1Byb3BzL2NvcmUueG1sIKIEASigAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAjJLPa8IwFIDvg/0PJfc2bR3ThbbCNjxNEObY2C0kTw1rk5C8Wf3vl1atCh52fO99+Xg/Ukx3TR1twXlldEmyJCURaGGk0uuSfCxn8YREHrmWvDYaSrIHT6bV/V0hLBPGwcIZCw4V+CiYtGfClmSDaBmlXmyg4T4JhA7FlXENxxC6NbVc/PA10DxNH2kDyCVHTjthbAcjOSqlGJT219W9QAoKNTSg0dMsyeiZRXCNv/mgr1yQjcK9hZvoqTjQO68GsG3bpB31aOg/o1/zt/d+1FjpblcCSFVIwVBhDdXCtOAWRmmMFg586JhjWHZBB6JjhQOOxlV9egjCkmvucR7usVIgn/ehfiMXUg62qrthlffEEBbHhRycIKMwCDuMfap8jl5elzNS5Wmexekkzp6W6ZiNxuwh/+7auXp/FjbHBv5vnLA0uzCeBIeZrj9T9QcAAP//AwBQSwMEFAAGAAgAAAAhANrY+ITmAQAAaAQAABAACAFkb2NQcm9wcy9hcHAueG1sIKIEASigAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAApFTBbtswDL0P2D8Yujd2iqIYAllFkaLIYVkDxG3PmkXHwmRJkDiv3ddPlmLHWYsd1pweyRfq8YkyvXnpVNaD89LokiwXBclA10ZIfSjJY3V/8YVkHrkWXBkNJXkFT27Y509054wFhxJ8FlpoX5IW0a7y3NctdNwvQlmHSmNcxzGE7pCbppE13Jn6Zwca88uiuM7hBUELEBd2akhSx1WP/9tUmHrQ55+qVxv6MVpBZxVHYImdYWgHNJ/StDLIVSU7YEVITwF9Nk74IZcAvbVWyZpjsIttZe2MNw1mD6nrzvwCtzNSI83nxGAW+CAuRvdRO3uWAnztADTN3ynTHXf84Lht4+mziO7V8Fe2pPkR0W8GIdISoBspBOhjNaTPYrrdrpW0sTBCuq+5gnWwjDVc+eDMKUE3wId12HHpArPHVQ81Gpd5+TssxBXJvnMPg9El6bmTXCNJtBRErKxHx6rk+hRHOKfNsbwaRkzgn8TUK06XVRIV+I8fEYM4ZsDnBqQjHppwJfiOH5dzP6KG5EaSc75+J5UTOq1QNt+KNxON2v5S81XqH/7RVuZu2OrjXZ4n6b7lDkR4MNNdTwm6CbKdGvjrlusDiJHztjA8haf04WDL60URfnHrx9yw1uOLZn8AAAD//wMAUEsBAi0AFAAGAAgAAAAhAN/MGPWtAQAARgwAABMAAAAAAAAAAAAAAAAAAAAAAFtDb250ZW50X1R5cGVzXS54bWxQSwECLQAUAAYACAAAACEAaPh0oQMBAADiAgAACwAAAAAAAAAAAAAAAADmAwAAX3JlbHMvLnJlbHNQSwECLQAUAAYACAAAACEANg1b3IwCAAA0DQAAFAAAAAAAAAAAAAAAAAAaBwAAcHB0L3ByZXNlbnRhdGlvbi54bWxQSwECLQAUAAYACAAAACEAD5JAKxQCAADnBAAAFQAAAAAAAAAAAAAAAADYCQAAcHB0L3NsaWRlcy9zbGlkZTEueG1sUEsBAi0AFAAGAAgAAAAhABsuNQcMAQAA0AMAAB8AAAAAAAAAAAAAAAAAHwwAAHBwdC9fcmVscy9wcmVzZW50YXRpb24ueG1sLnJlbHNQSwECLQAUAAYACAAAACEAY1wjtMAAAAA3AQAAIAAAAAAAAAAAAAAAAABwDgAAcHB0L3NsaWRlcy9fcmVscy9zbGlkZTEueG1sLnJlbHNQSwECLQAUAAYACAAAACEAcCwNG0UHAABDMgAAIQAAAAAAAAAAAAAAAABuDwAAcHB0L3NsaWRlTWFzdGVycy9zbGlkZU1hc3RlcjEueG1sUEsBAi0AFAAGAAgAAAAhACjV32c6BAAAVQ4AACEAAAAAAAAAAAAAAAAA8hYAAHBwdC9zbGlkZUxheW91dHMvc2xpZGVMYXlvdXQxLnhtbFBLAQItABQABgAIAAAAIQBJl59ViAMAAF8LAAAhAAAAAAAAAAAAAAAAAGsbAABwcHQvc2xpZGVMYXlvdXRzL3NsaWRlTGF5b3V0Mi54bWxQSwECLQAUAAYACAAAACEAQMb0/XkEAAArEQAAIQAAAAAAAAAAAAAAAAAyHwAAcHB0L3NsaWRlTGF5b3V0cy9zbGlkZUxheW91dDMueG1sUEsBAi0AFAAGAAgAAAAhAOSkc3rPAwAAyw4AACEAAAAAAAAAAAAAAAAA6iMAAHBwdC9zbGlkZUxheW91dHMvc2xpZGVMYXlvdXQ0LnhtbFBLAQItABQABgAIAAAAIQBLOG549QQAAKwYAAAhAAAAAAAAAAAAAAAAAPgnAABwcHQvc2xpZGVMYXlvdXRzL3NsaWRlTGF5b3V0NS54bWxQSwECLQAUAAYACAAAACEA1oiCVCsDAAC6CAAAIQAAAAAAAAAAAAAAAAAsLQAAcHB0L3NsaWRlTGF5b3V0cy9zbGlkZUxheW91dDYueG1sUEsBAi0AFAAGAAgAAAAhABmSUjnwAgAAawcAACEAAAAAAAAAAAAAAAAAljAAAHBwdC9zbGlkZUxheW91dHMvc2xpZGVMYXlvdXQ3LnhtbFBLAQItABQABgAIAAAAIQAfYLO30QQAAHYSAAAhAAAAAAAAAAAAAAAAAMUzAABwcHQvc2xpZGVMYXlvdXRzL3NsaWRlTGF5b3V0OC54bWxQSwECLQAUAAYACAAAACEALr2UZ7wEAACHEgAAIQAAAAAAAAAAAAAAAADVOAAAcHB0L3NsaWRlTGF5b3V0cy9zbGlkZUxheW91dDkueG1sUEsBAi0AFAAGAAgAAAAhAHKCiv6mAwAAlwsAACIAAAAAAAAAAAAAAAAA0D0AAHBwdC9zbGlkZUxheW91dHMvc2xpZGVMYXlvdXQxMC54bWxQSwECLQAUAAYACAAAACEA/A1DZtsDAAB3DAAAIgAAAAAAAAAAAAAAAAC2QQAAcHB0L3NsaWRlTGF5b3V0cy9zbGlkZUxheW91dDExLnhtbFBLAQItABQABgAIAAAAIQBpol8hFQEAAMcHAAAsAAAAAAAAAAAAAAAAANFFAABwcHQvc2xpZGVNYXN0ZXJzL19yZWxzL3NsaWRlTWFzdGVyMS54bWwucmVsc1BLAQItABQABgAIAAAAIQDV0ZLxvAAAADcBAAAsAAAAAAAAAAAAAAAAADBHAABwcHQvc2xpZGVMYXlvdXRzL19yZWxzL3NsaWRlTGF5b3V0MS54bWwucmVsc1BLAQItABQABgAIAAAAIQDV0ZLxvAAAADcBAAAsAAAAAAAAAAAAAAAAADZIAABwcHQvc2xpZGVMYXlvdXRzL19yZWxzL3NsaWRlTGF5b3V0Mi54bWwucmVsc1BLAQItABQABgAIAAAAIQDV0ZLxvAAAADcBAAAsAAAAAAAAAAAAAAAAADxJAABwcHQvc2xpZGVMYXlvdXRzL19yZWxzL3NsaWRlTGF5b3V0My54bWwucmVsc1BLAQItABQABgAIAAAAIQDV0ZLxvAAAADcBAAAsAAAAAAAAAAAAAAAAAEJKAABwcHQvc2xpZGVMYXlvdXRzL19yZWxzL3NsaWRlTGF5b3V0NC54bWwucmVsc1BLAQItABQABgAIAAAAIQDV0ZLxvAAAADcBAAAsAAAAAAAAAAAAAAAAAEhLAABwcHQvc2xpZGVMYXlvdXRzL19yZWxzL3NsaWRlTGF5b3V0NS54bWwucmVsc1BLAQItABQABgAIAAAAIQDV0ZLxvAAAADcBAAAsAAAAAAAAAAAAAAAAAE5MAABwcHQvc2xpZGVMYXlvdXRzL19yZWxzL3NsaWRlTGF5b3V0Ni54bWwucmVsc1BLAQItABQABgAIAAAAIQDV0ZLxvAAAADcBAAAsAAAAAAAAAAAAAAAAAFRNAABwcHQvc2xpZGVMYXlvdXRzL19yZWxzL3NsaWRlTGF5b3V0Ny54bWwucmVsc1BLAQItABQABgAIAAAAIQDV0ZLxvAAAADcBAAAsAAAAAAAAAAAAAAAAAFpOAABwcHQvc2xpZGVMYXlvdXRzL19yZWxzL3NsaWRlTGF5b3V0OC54bWwucmVsc1BLAQItABQABgAIAAAAIQDV0ZLxvAAAADcBAAAsAAAAAAAAAAAAAAAAAGBPAABwcHQvc2xpZGVMYXlvdXRzL19yZWxzL3NsaWRlTGF5b3V0OS54bWwucmVsc1BLAQItABQABgAIAAAAIQDV0ZLxvAAAADcBAAAtAAAAAAAAAAAAAAAAAGZQAABwcHQvc2xpZGVMYXlvdXRzL19yZWxzL3NsaWRlTGF5b3V0MTAueG1sLnJlbHNQSwECLQAUAAYACAAAACEA1dGS8bwAAAA3AQAALQAAAAAAAAAAAAAAAABtUQAAcHB0L3NsaWRlTGF5b3V0cy9fcmVscy9zbGlkZUxheW91dDExLnhtbC5yZWxzUEsBAi0AFAAGAAgAAAAhADfXdXMfBgAAqRoAABQAAAAAAAAAAAAAAAAAdFIAAHBwdC90aGVtZS90aGVtZTEueG1sUEsBAi0ACgAAAAAAAAAhAELHvQqzBAAAswQAABcAAAAAAAAAAAAAAAAAxVgAAGRvY1Byb3BzL3RodW1ibmFpbC5qcGVnUEsBAi0AFAAGAAgAAAAhABgLERuKAQAAMAMAABEAAAAAAAAAAAAAAAAArV0AAHBwdC9wcmVzUHJvcHMueG1sUEsBAi0AFAAGAAgAAAAhAKx/WCiHAQAAKgMAABEAAAAAAAAAAAAAAAAAZl8AAHBwdC92aWV3UHJvcHMueG1sUEsBAi0AFAAGAAgAAAAhANj9jY+sAAAAtgAAABMAAAAAAAAAAAAAAAAAHGEAAHBwdC90YWJsZVN0eWxlcy54bWxQSwECLQAUAAYACAAAACEA1I3ebFUBAACZAgAAEQAAAAAAAAAAAAAAAAD5YQAAZG9jUHJvcHMvY29yZS54bWxQSwECLQAUAAYACAAAACEA2tj4hOYBAABoBAAAEAAAAAAAAAAAAAAAAACFZAAAZG9jUHJvcHMvYXBwLnhtbFBLBQYAAAAAJQAlAE0LAAChZwAAAAA="}),define("DS/SwymUIComponents/script/feature/community/community/view/community-dummy-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-view"],function(e,t){"use strict";return t.extend({name:"community-dummy-view",nbItems:1,setup:function(e){this.nbItems=e.nbItems?e.nbItems:this.nbItems,this._parent.apply(this,arguments)},update:function(e){this.nbItems=e.nbItems?e.nbItems:this.nbItems,this.refresh()},_createContent:function(){for(var t=[],i=0,n=e.createElement("div",{class:"community-dummy-view",html:[{tag:"div",class:"community-dummy-thumbnail"},{tag:"div",class:"community-dummy-title"}]});i<this.nbItems&&i<100;)t.push(e.clone(n)),i+=1;return t}})}),define("DS/SwymUIComponents/script/feature/core/link/view/account-link-edit-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/link/view/link-edit-view","DS/SwymUICore/script/feature/core/link/model/link-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/UIKIT/Form"],function(e,t,i,n,o){"use strict";return n.extend({})}),define("DS/SwymUIComponents/script/feature/community/template/view/content-template",["require","exports","UWA/Core"],function(e,t,i){"use strict";return function(e){var t={trash:"fonticon fonticon-trash",pencil:"fonticon fonticon-pencil "};return function(n,o,s){var a;n.addClassName("default-template"),n.addClassName("template-custom-template"),s.parent?((a=i.createElement("span",{class:"item-parent-label"})).setText(s.label),s.parentReference&&(a.setStyle("margin-left",s.parentReference.level+"em"),a.addClassName("sub-item")),a.inject(n)):((a=i.createElement("span",{class:"item-label"})).setText(s.label),s.parentReference&&a.addClassName("sub-item"),a.inject(n),t[e]&&(console.log("item ",s.value),i.createElement("span",{class:"fonticon item-icon "+t[e]}).inject(n)),console.log("ytype",e))}}}),define("DS/SwymUIComponents/script/feature/core/search/view/community-selector/community-template",["require","exports","UWA/Core","DS/SwymUICore/script/feature/community/media/model/media-model"],function(e,t,i,n){"use strict";return function(e){var t={recent:"fonticon-navigation-history",favorite:"fonticon-favorite-off"};return function(o,s,a){var r,l;o.addClassName("default-template"),o.addClassName("community-custom-template"),a.parent?((r=i.createElement("span",{class:"item-parent-label"})).setText(a.label),a.parentReference&&(r.setStyle("margin-left",a.parentReference.level+"em"),r.addClassName("sub-item")),r.inject(o)):((r=i.createElement("span",{class:"item-label"})).setText(a.label),a.parentReference&&r.addClassName("sub-item"),(l=i.createElement("img",{class:"item-logo"})).src=n.constructThumbnailUrl("community",a.value,"m_thumb"),l.inject(o),r.inject(o),t[e]&&i.createElement("span",{class:"fonticon item-icon "+t[e]}).inject(o),console.log("ytype",e))}}}),define("DS/SwymUIComponents/script/lib/creation-statistics-persistence",["UWA/Core","UWA/Class/Events","DS/SwymUICore/script/lib/model/model-manager","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/utils/localstorage-manager"],function(e,t,i,n,o,s,a){"use strict";var r=null,l=o.getInstance(),c={post:[],media:[],idea:[],iquestion:[],survey:[],wiki:[],wedo:[]},d=t.extend({
//! LastPostedCommunities local storage is shared between widgets with the same tenant
_localStorageData:null,_getTenantId:function(){var e,t,i=window.widget;if(i&&i.getPreference("url"))e=i.getPreference("url").id;else{if(!(t=n.getInstance())||!t.get("config"))throw new Error("No tenant found");e=t.get("config").tenant.online_instance_id}return e},_getLocalStorageKey:function(){return[this._getTenantId(),"lastPostedCommunities"].join(":")},populateModelFromLocalStorage:function(){var e=this._getLocalStorageKey(),t=a.getItem(e);this._localStorageData=t||c,this._migrateLocalStorageData()},_saveToLocalStorage:function(){var e=this._getLocalStorageKey();a.setItem(e,this._localStorageData)},_migrateLocalStorageData:function(){var e,t=!1;for(var i in this._localStorageData)for(var n=(e=this._localStorageData[i]).length-1;n>=0;n--)"string"==typeof e[n]&&(t=!0,e.splice(n,1));t&&this._saveToLocalStorage()},_removeFromLocalStorage:function(){var e=this._getLocalStorageKey();a.removeItem(e)},_onPublishing:function(e){var t=!1,i=e.getCommunity(),n=i.get("subject6wuri"),o=e.getModelName(),s=i.isDirectMessage(),a=i.get("title",{escapeHTML:!1}),r=this._localStorageData[o];r&&!s&&(r[0]&&r[0].communityId===n&&"creation"===r[0].status||(5===r.length&&r.pop(),(r=this._removeCommunity(r,n)).unshift({communityId:n,status:"creation",communityTitle:a}),t=!0),!0===t&&(this._saveToLocalStorage(),this.dispatchEvent("CommunitiesUpdated",[o])))},_onCommunityChange:function(e){if(e&&e.communityId){var t=new s({mid:e.communityId});if(t.hasBeenFetched()){if("community"===t.get("community_type")){let e=!1,s=t.get("subject6wuri"),l=t.get("title",{escapeHTML:!1}),c=this._localStorageData,d=!1,m=!1,u=0,h=[],p=[];for(var i in c){switch(h=c[i],i){case"post":m=t.canCreatePosts();break;case"media":m=t.canCreateMedia();break;case"idea":m=t.canCreateIdeas();break;case"iquestion":m=t.canCreateQuestions();break;case"survey":m=t.canCreateSurveys();break;case"wiki":m=t.canCreateWikiPages();break;case"wedo":m=t.canCreateWedo()}if(d=!this._areCommunitiesAllWithStatusCreation(h),h=this._removeCommunity(h,s),d&&m&&"creation"!==this._getStatusOfCommunityInlist(h,s)){if(h.length<5)h.push({communityId:s,status:"visit",communityTitle:l});else{for(var n=0,o=h.length;n<o;n++)if("VISITED"===h[n].status){u=n;break}h.splice(u,0,{communityId:s,status:"visit",communityTitle:l}),h.pop()}c[i]=h,e=!0,p.push(i)}}if(e){this._saveToLocalStorage();for(var a=0,r=p.length;a<r;a++)this.dispatchEvent("CommunitiesUpdated",[p[a]])}}}else t.addEvent("onSync",function(){this._onCommunityChange(e)}.bind(this))}},_getStatusOfCommunityInlist:function(e,t){for(var i,n=null,o=0,s=e.length;o<s;o++)if((i=e[o]).communityId===t){n=i.status;break}return n},_removeCommunity:function(e,t){for(var i=e.length-1;i>=0;i--)if(e[i]&&e[i].communityId===t){e.splice(i,1);break}return e},_areCommunitiesAllWithStatusCreation:function(e){var t=!0;if(5===e.length){for(var i=0,n=e.length;i<n;i++)if("creation"!==e[i].status){t=!1;break}}else t=!1;return t},clear:function(){this._localStorageData=e.clone(c)},init:function(){this._parent.apply(this,arguments),this._onPublishingBound||(this._onPublishingBound=this._onPublishing.bind(this),i.addListenerOnPublishing(this._onPublishingBound)),this._onCommunityChangeBound||(this._onCommunityChangeBound=this._onCommunityChange.bind(this),!0===l.addListener("onCommunityChange",this._onCommunityChangeBound,this,!0)&&this._onCommunityChangeBound()),this.populateModelFromLocalStorage()},getRecentCommunitiesForContentType:function(t){var i=this._localStorageData[t]||[];return e.clone(i)},removeCommunitiesForContentType:function(e,t){var i=this._localStorageData[e];t.forEach(function(e){i=this._removeCommunity(i,e.communityId)}.bind(this)),this._saveToLocalStorage(),this.dispatchEvent("CommunitiesUpdated",[e])}});return{getInstance:function(){return null===r&&(r=new d),r}}}),define("DS/SwymUIComponents/script/feature/community/media/view/document/empty-docx-data-uri",[],function(){"use strict";return"data:application/vndopenxmlformats-officedocumentwordprocessingmldocument;base64,UEsDBBQAAAAAACtYilMAAAAAAAAAAAAAAAAJAAAAZG9jUHJvcHMvUEsDBBQAAAAIAONYilM0lSs00QEAAOgDAAAQAAAAZG9jUHJvcHMvYXBwLnhtbJ1TwW7bMAy9D9g/GLo3SoqhGAJFRZBk6KFbA9hpsaMmM4kwWRIkNmj29aPlJnbTnuoT3yP99EhK4valscUBYjLezdhkNGYFOO1r43Yztql+XH1nRULlamW9gxk7QmK38usXsY4+QEQDqSAJl2ZsjximnCe9h0alEaUdZbY+NgoJxh33263RsPT6uQGH/Ho8vuHwguBqqK/CWZB1itMDfla09rr1lx6rYyA9KSpoglUI8lf7px3VHhvBTyzlPSpbmQbkmOgzEGu1gyQngneBePKxTm1NF4jFXkWlEWImB0jMQ7BGK6S5yodssTh5LFa1QR8FH9YIypagn6PBY6s1hOLeOMgn5IBs0Tm7qMI+kwMkSq0sLKh3uVU2geA9Ie5AtXtdK9MaPOD0AJp8FMn8o81es+KPSkATI3BQ0SiHLJe9ghzbkDDKyqAl7TNuw77sIjbf2gHm4KKQnz1Q/NZdPiE9bKk3/MDsZGg2e2ADe72zizMuVBe+Ccod5XJelvPNfVWUv8tq9XNVCt6lutH/TZtQ+SVdlNNQ35DDW/BkcF8GpbttfciLklioab8ntZ4Qd9RQtK06/et2UJ9q3iXyDXvsHq6c3IzG9Anec9Rt/0Tlf1BLAwQUAAAACAA9dCNU5lErgGkBAAADAwAAEQAAAGRvY1Byb3BzL2NvcmUueG1spZJdT8IwFIbvTfwPS++3bpAYs2wjUeRKookYjXe1PYPK1jZtYezf2w7YRPDKpBfn4znvTt8um+zqKtiCNlyKHCVRjAIQVDIuljl6XczCWxQYSwQjlRSQoxYMmhTXVxlVKZUanrVUoC0HEzglYVKqcrSyVqUYG7qCmpjIEcI1S6lrYl2ql1gRuiZLwKM4vsE1WMKIJdgLhqpXRAdJRntJtdFVJ8AohgpqENbgJErwwFrQtbk40HV+kDW3rYKL6LHZ0zvDe7BpmqgZe9Tvn+D3+eNLd9WQC+8VBVRkjKaW2wqKDA+hi8zm8wuo7cpD4mKqgVipi6ey5BSCqaQbf73ggXFXdviAePPX0DZSM+OETjKHMTBUc2Xdk7ruaaGbrYixc/fGJQd21/75xTOyG9aw5cYrJZ4Y0uxg/X5LYIGzLN0bfOy8je+nixkqRvEoCWN/FnGcducjw7/mB8G6W+AfikcB58bZb1t8A1BLAwQUAAAAAAArWIpTAAAAAAAAAAAAAAAABQAAAHdvcmQvUEsDBBQAAAAIAAAAIQCJd9LeQQIAAA8HAAARAAAAd29yZC9kb2N1bWVudC54bWyllUuP2yAQx++V+h0s7hvsNMmm1iar5rHRHiqtmvZcEYxtFAMWkFc/fQc/YmvTh717MjAzv/kPA/jh8Swy78i04UrOUDDwkcckVRGXyQz9+P50N0WesURGJFOSzdCFGfQ4//jh4RRGih4Ek9YDhDThKaczlFqbhxgbmjJBzEBwqpVRsR1QJbCKY04ZPikd4aEf+MUo14oyYyDfksgjMajC0XM3WqTJCYIdcIRpSrRl54YR9IaM8Wc8fQ0St6WpnEkwxkoLYmGqEyyI3h/yO+DmxPIdz7i9ANKf1Bg1Qwctwwpxd5XiQsJSSvWpI3SXvGXIqmpHkRFrloEGJU3Kc3Mt4600MKY15PivIo4iQ9fzEIy67f7fDsSq7EoD7CK/aqXICuX/IQZ+h444xDWii4R2zkaJIFxeMW/bmtbmBuN+gOENYGJYP8S4QmBzEezcdCXph3nd5Y1Wh7yh8ffRnuX+ypL9CqxOS/sEm16AGzHblORwlQUNnxOpNNlloAh670H7vKIDnrslaA6v6U5FF/fNvVMIr3H0bYZ8fz0drr8sUb20YjE5ZNZZnpbj+8WiilR79/RsLbxZ4MojcHAxkgjI93OjFoTuEW77rmVUezoDhrzObBi1L/oPCgplyfYXmOAKBMPhqMiQwng8hTEuHb4SF2xVDuuj0kXzJLX11AmwVolmnrG4ZU0ZiRi8effDYhorZVvT5GCLaZWOqszAqskJZc7HLZe/pY3mkWNzyV64paDy06Sssy4RhvWW4+ZPNv8NUEsDBBQAAAAIAAAAIQD/ncAxsAEAADwFAAASAAAAd29yZC9mb250VGFibGUueG1s3ZLLbtswEEX3BfoPBPexqIedVIgcoG0MFCi6KNIPoGlKGpQPgUNb8d939LCzcArEmywiAgR5L3k4vOL9w7M17KADgncVTxeCM+2U34FrKv7naXNzxxlG6XbSeKcrftTIH9afP933Ze1dREb7HZZWVbyNsSuTBFWrrcSF77Qjs/bBykjT0CRWhr/77kZ528kIWzAQj0kmxIrPmPAWiq9rUPq7V3urXRz3J0EbInqHLXR4ovVvofU+7LrglUakO1sz8qhScGdMWlyALKjg0ddxQZeZKxpRtD0V48iaF8DyOkB2AVihvg6xnBEJHq1+5syq8kfjfJBbQyS6EqOq2Ajm6/lnsr500pL9TRrYBhiNTjqPOiXvIE3FRSY2Ykn90AqRDz1PhoWqlQF1PC8Uk1xLC+Z4UrEHxMnoIKr2pB9kgKG0yUJoyNjjVlT8sRAie9xs+KSkVJ0gpbj9OisZnTV9X2YlPytiUNTIGacpcSYlfVkznJlMCVwk8QRWI/ule/bbW+leT4TaSuSUSjEmk1+VSBi41yUiXkvk9m75LonMb4P9hKaN/30h+cd9IfMA1/8AUEsDBBQAAAAIAAAAIQBiXuxfmwMAAPwJAAARAAAAd29yZC9zZXR0aW5ncy54bWy1VtuO0zAQfUfiH6I8E3JpWkpEQbRLuYgCIssHOLHTWuubbKfdgvh3xkncdFmECoinOnNmzozn5j57cctZsCfaUCkWYfo4CQMiaomp2C7CL9fraB4GxiKBEZOCLMIjMeGL5w8fPDsUhlgLaiYACmEKXi/CnbWqiGNT7whH5rFURADYSM2RhU+9jTnSN62KaskVsrSijNpjnCXJLBxo5CJstSgGiojTWksjG+tMCtk0tCbDj7fQl/jtTa5k3XIibOcx1oQhC/c2O6qMZ+N/ywbgzpPsf3eJPWde75AmF1z3IDU+WVwSnjNQWtbEGCgQZz5AKkbH+T2ik+/H4Hu4YkcF5mnSnc4jn/4ZQXaPYGbIn1FMB4rYHDm59USGXZKSHnpPK4308TwfvC7eboXUqGIQDuQlgKsFXXThc+jyr1Ly4FAoomsoNYxIloSxAzBpUMvsNapKKxWo7BFE8sTD9Q5pVFuiS4VqqMJKCqsl83pYfpB2BVOgoUi9RT8T46ns5wssBOIQ252Z2UhMQoBaTS9PYui9p9PR5X1HEvaBpphcu5yU9sjIGoIv6VfyUuB3rbEUGLvJ+YcIfhcAEc7zR6ji9VGRNUG2hTT9J2ddJdaMqg3VWuq3AkOd/5sz2jREgwOKLNlA+1AtD12e3xCEif5Xv/F5G8FSx8YfPktpvWqSTOZP5vMZWAzoiKTzycv18lfIJMlnyasRuYRtvZo+WXZs8SkeXrhV+Un7k2uugPcWK8QrTVGwccs0dhqVvllS4fGKwFCTc6RsKw9GUQ8Yjhhbw/R5IOnlmBp1RZruzDZIbwfeUUP/Suom/d2Jy20Bol9r2aoePWik+qbxKmmeD5ZU2PeUe7lpq9JbCVhDZ1Ar8Me97vI0pudQWCh+N3zvkWuiXpeI6Es5NBnTZe10Nkipvs+qbboIGd3ubOpaw8IXhjcXPhyWDVjWYVmPdR+ohps57eEwyjIvO9ObeNlklOVelo+yqZdNR9nMy2ZOtoMJ14yKm0V4Ojp5IxmTB4LfjPg9UZ8Es0OKXPXbGNpL9gI8CIJ9QW4tZA1TC39lFMUc3UKNkgwa9qTN0FG29o6uw5yyusuAkUV+2O4Yw/dPsfSvRE2hHcsjr8bl/7gPnFEDC0LBO2Gl9tijDkun3QNir6GLb6Cwn0mzRIbgAcOyfovdQ9XbfMvzZZalk0n0crJ8FeUvr1bRHI7R/Ok0X01n89lk/eR7F/L4t+35D1BLAwQUAAAACAAAACEAn+aUElwKAABTcAAADwAAAHdvcmQvc3R5bGVzLnhtbL2dyZLTMBCG71TxDq6c4AAh3oZQLMUOxU4GOCu2kghsK9gOEJ4etbeEOIvj/uE046U/La1fUku2c/fBrziyfsg0Uzq5NxjdvDWwZBLoUCXze4NPl89u3B5YWS6SUEQ6kfcGa5kNHty/euXuzztZvo5kZhlAkt2Jg3uDRZ4v7wyHWbCQschu6qVMzMWZTmORm8N0PoxF+m21vBHoeClyNVWRytdD+9Ytf1Bh0i4UPZupQD7RwSqWSV7YD1MZGaJOsoVaZjXtZxfaT52Gy1QHMstMoeOo4JmcqqTBjNwWKFZBqjM9y2+awlQ5KlDGfHSr+C+ONgDvPIDdAviZPA/hVYhhto7lr4EVB3dezhOdimlkSKZIlsmVVYAH9403Qx08kTOxivKMDtP3aXVYHRV/nukkz6yfd0QWKHVpcmFQsTLUFw+TTA3MFSmy/GGmxN6LC/pn75Ugy7dOP1KhGgwpxey3ufhDRPcGtl2feZztnotEMq/PyeTGp8l2TrZOTQ333kCkNyYPyXBYFWy4W9zl7lGR8FIEqkhHzHKZGrH4twgaKdKF7Y3rg48rqmGxynWVyLJI5G/ssFXjpv2a1jwpRWWuytlrHXyT4SQ3F+4NTFrFyU8v36dKp0Y49wbjcXVyImP1QoWhTLZuTBYqlF8WMvmUyXBz/sOzovFXJwK9Ssz/zsVoUGQiC5/+CuSSpGSuJoJ88pYMIrp7perEK/PvNWw0GB60X0gRUs2NdhHjsxE2WWRbpd3PXO2UfXR2Qs7/Ssj9Xwl5/ysh/38ldPG/Err9vxIa/+uEVBLKX9aolUyb2oVjgzgOiOOCOB6I44M4FyDObRBnzObkOrBGJxu7M+7DPT1G9OOeHhL6cU+PAP24pzv8ftzT/Xs/7unuvB/3dO/dj3u6sz6fW061rJeJAeZslc20zhOdSyuXv/g0kRhWEWRheDToyZSNoUICMGXPVg3EbFogiuPTLcTjjec5hXOWnlkzNV+lMmNnXCY/ZGSiZEuEoeEBganMV2nC5lVtmngzmZq1CslGbho2EEqRoJWs4imgbS7FHMaSSQiuPkPEdTJNgzbx84JEogCNOhZmoYRNybWA9Q+vVcavK4JYj1ZRJEGst5gmRixAbEAYQGhAGEBkQBhAYLDxGayKChqspgoarMIKGqzeyvaJqreShqq3koaqt5IGqLdLlUdyd9Yx6r529zjSGaLDm6h5IswEgD/cVGum1nuRinkqlguLVqVPzrTOTueRDtfWJWJMa0ioeX3RRB6bUqtkxa/Qv2gocdU8lLxqHkpgNQ8gsTdmmkwTtBeYeGaymuZ7Rds9KpiIaFVMaPnT7Sci57ewjQCeqTSDyWAvFjGsvqXp7AvQVK/OJSJjNQsx2tcsYL3tICG5jMwmGKYbfrFeytSEZd/YpGc6ivRPGeKIkzzVyXxX8rbdWfJP4+VCZCprIboP9fWGuvVGLNkFeh+ZDXSM357eMJvxkYWbQby4fPPautRLCjOpYjDARzrPdQxjViuB177I6XU2rMjgw8C0sTU/ZyUMtDxUwB4rwCBTknQIIplppkoUZAwteK/keqpFGmJo71NZPsOSSxBxIuJlBKq7S9Mv/kwVYlm24H0WqRJTQO4qUV1CYFvLhtlq+lUG/K7urbYgK0PvVjmtPxYwwG5vjQMt7NQ40AJP4U0zPFD7BRR2C4eIhrZwiGCoxD2OhHlaLYCVtuLBilvx4OXlB38VT0c6na0iXAVWQFwNVkBcFepoFScZssTEQxaYePDyApsM8QDrBSXveapCmDMIBvMEwWBuIBjMBwTDOoD/hM4GBnhMZwMDPKtDMNgUgGCwCQDBwMM/aJenhIH2ejYwWDsjGKydEQzWzpwnlpzNzCQYN8Q0SNwo0yCRA02Sy3hpnqxP1yDk00jOBWCBtKS9T/XMhOrmgohASFqjRk62DQ442TZLJrCsGRY0X/xW90iYxUcNWlvbDDjtZ9dOmtGbHPww2qwUBnKhI7N3sqdMJ+PlSflaxt/ZP+cRqtdqvsityUKEezD+rZOW1Iu2zE4nuK/OffvoNlOoVnGdUWvUMna6G9stY/e0MRV0T7JeR8t2mv5pS6qlPWledLRsp3m7o6XTshwf3SVLv+1tCBfH2k8d4x1qfBejLsZ7k7W7WO5rghfOyZZbN6KHQUC7BaOemmnse4qnsWepqKIw5dRQ+uuqRJwrsI/yh6KR/ZxOk9LbPD3R6vfdzj3nh5XZJ21tOHV/qeulmTglmbT2cpzuG1fb9bhxRf/upkJw+p0G0b8DahD9eqLGnNUlNZT+fVOD6N9JNQh+b2Uzeyub2VvZkN7KhvRWjFlAgzirt9ojVNa8oEHwhcqYKTQInlBtiFBtvlBtvlBtvlAdplAdplAdiFAdiFAdvlAdvlAdvlAdvlAdvlB7zu0bc4hQHb5QHb5QHb5QXaZQXaZQXYhQXYhQXb5QXb5QXb5QXb5QXb5QXZ5QXYhQXb5QXb5QXb5QPaZQPaZQPYhQPYhQPb5QPb5QPb5QPb5QPb5QPZ5QPYhQPb5QPb5QPb5QfaZQfaZQfYhQfYhQfb5Qfb5Qfb5Qfb5Qfb5QfZ5QfYhQfb5Qfb5Q/bOEWm1RHnrMfnT+qufBJ/a7b11VmfpYvcrdXkPtjipzdYzV/V2ER1p/s/a+eOg43SFqGildLFGvT77c51ycu+t4+e5x/YbPaTrzo0vluxDlnmkL7na1tFuWdkdLp2XpdLR0W5ZuR0uvZXms0yVdVobFcNQyvtXNeHTA3O9m3q7ii26G7Rq+3c2wXcHjboaeRZ3zrrXXsZ785vnSFmHUjXBxmGB3I5S+2mwP9HZaQ+jtvYbQ240NgefPBsN3bIPie7hBgVxts13dX6gNge1qG+NqG+dqG+dqG+Rqh+1qh+3q/p1zQ8C42sG52sG52gG52mW72mW72mW7mjkgNxicq12cq12Qqz22qz22qz22qz2Mqz2cqz2cqz2Qq322q322q322q32Mq32cq32cq/2zXE2rKIxoicx7RUtk2CtaIsNe0RIZ9o+WyJoXLRGBFy0RAREtEYcXLRGBFy0RgRctEQEQLREGFC0RChQtEQoRLRGHFy0RgRctEYEXLREBEC0RBhQtEQoULREKES0RhxctEYEXLRGBFy0RARAtEQYULREKFC0RChEtEYcXLRGBFy0RgRctEQEQLREGFC0RChQtEQoRLRGHFy0RgRctEYEXLREBEC0RBhQtEQoULREKES0RhxctEYEXLRGBFy0RARAtEQYULRHq3Ghp+PcPMN2vf9/M3Jyvl/QN7u0XZsLyG6TFJmB148uw+aEkY1zkpPxJqvo0pdJsGFKKlWE7qWBh0grM15OOJPWkPN28xkPfQN1J+OCnUk3i21VQ311V6WYr1Bzubnseznf97e4jeS5ccrSOSq8dyuB43C2HJj/T6H1a/WM+RWgAP+kHq5qchr/EoL7xsYyiN6K8Wy8P3xrJWV5eHd26vef6tPj+22H71HQURwDDvzMzrApxrL7LL8KbHeyjTZLUsKe6LTrPrek6b5v/svt/AFBLAwQUAAAAAAArWIpTAAAAAAAAAAAAAAAACwAAAHdvcmQvdGhlbWUvUEsDBBQAAAAIAAAAIQAHt0Cq6wUAAI8aAAAVAAAAd29yZC90aGVtZS90aGVtZTEueG1s7Vlb69MwFH8X/A6l77PtetvEKVu3eb/gFR/z77I1mjYjydQhguiTL4Kg4oOCbz6IKCgovvhhBMXLh/C0nWu7ZjpFRdANtuTkd05+OSc5Sdpdey7FVLuAuSAs6ejWDlPXcBKyEUkmHf3UyWGjpWtComSEKEtwR59joe/ZvX3bLrRTRjjGGugnYifq6JGU052GIUIQI7GDTXECbWPGYyShyifGiKOLYDemRtM0PSNGJNG1BMVg9uh4TEKsnUxN6ru/Gh9Q+EmkSAUh5SfCVFjWyLGj81b6J+YioFy7gGhHh35G7OJJfEnqGkVCQkNHN7OPbuzeZSyVqFyjW9IbZp9Mb6GQqjczPT7ZWio6jut43aX9Zm6/jhv4A2/gZbglAIUhjNSqYd1eu9d3c2wBWhRVtvt+37bK+LJ9u4bvuum3grcLvFPDD4fB0ocF6GvRVfjEbwZOBe8WeK+G981u3/G/4gtQRElyvoY2Xc8OFqMtIGNG9ynhbdcZ+s0FvEAZpdmV6ydy3VyL0TnGhwDIgoskSTQ5n+IxCgEXIEq2ONEOkUkEE2+KEiZAbDbNoWnDb/p1shJ4JDWAUUk7F4WiIvrKRxMhJ1PZ0Q+AVb0Eeffq1dtrL95ee/n2+vW3154u+q7r7UPJpKz36dGtzw+uah+fP/x0+44aL8r4909uvH/95lvmZYXW3WfvXzx7d+/mh8e3FfAuR1tl+EkSY6EdwRe14yxGiaoDvMV/TONkhEhZo5tMBEpQqqNAD2RUQR+ZI4oUuB6u+vE0h3ShAu6dnasQPhHxmSQK4MEorgAPM0Z7jCvHdBD6qnhhlkzUnfNZGXccoQuqvoOVKA9mU5j3BKmgEa7QPEYh5GiCEyy1tI2dx1ihdpYQUhkdCTkTbCy1s0TrIaJ0yUmyJdVK+0gMcZkjdbxRRem01mNUZb6PL1SRCLxIVSYxrbhxL5pJFCsZo5iWkYeQjFQkT8x5WHG4kBx6x5RpgxEWQqVzlM8rdA9CmlGH/TCdx1Ukl+R8HZnyY6yM7LPzQYTiqZIzSaIydr84D1MUaceYVJJg5RWS1yEOKFkb7tMEyx9b26cgDaknSNoy46olgVl1Pc7pGOHMuLGS12OSfDfJr6R39/eld0ii7+4/+G0p/dcn8y4niG6QwjPcBok7YHxE/v683Uez5BhOov9p+3/a/ifTdrae/0iyLvKzkSuWDu/x2rP7mFB6Qs4pPiSyzC5geKMhCLNKprS8KkwjKGbdreAmHGVljTN5hsjoRISm0I2lZ40CTOcFbcoE7A36WtvZ3jKLD7NRLrWs/HaaKSBZyE13KYedSOZSz19ewwrzUEu7LhNIdX+ExKKzOglbQcK3NyNhmb+KRVvBomV9i4VRigqsPw1WLXjFyRnBfEMUjzp6rp9F9/dEWuXM+rCbiuG1nc2cvEGkKyQscw2J0jSM0AgvxZvR+NFYt9vqUDeVNPzW74i1Uc8NNKnWtIuw5mwXzIRo2tHHcCqEYjwFeyLNm4hO4PlZKLn+05llyoXsIxHlsKwpH39MJOYaJTHM9SIMKauCm9X0zb+XXNv8+zxnrAYZj8c4lGskRRXaUiOV1l8GTitsBqRPRKOL2had8eMIHOX6VurAEREy82Ze4cvJXfbiSroy9fpTs2KJIjqN0GJHWSbzJTwtF3TSWsG0PipD5cKtyfBX7LrfV1pJmms2EF+VxX7zJl9iZatZucpc126t2yU2y8QbbAglai01NVtNbd3e8QsPBKXuPHvdHvGbdoPVWWuUzpVprf56gm2dg5nfh+PqjEqR3/4vwR0hWDxYTu18lUJxUdJmnHT0y6bbdYKmGzTMljtoOLZjNlpu1250Xde2Bq5l9nvNK+AUGcWWm/c9hPsMnS/evmTy2huY+Osxe0fIYoNl52AjU87ewFjN9W9gNDICWl5z2LbbPa/RtrvDhtPvtRrtwOs1+l7g94f9wG21h1d07UIGdrp24HiDVsOzgqDheCbQB0DDd5rNruN3WwOneyXzdTbyr/8L9+aD2v0FUEsDBBQAAAAIAAAAIQCTdtZJEgEAAEACAAAUAAAAd29yZC93ZWJTZXR0aW5ncy54bWyV0cFKAzEQBuC74DuE3Ntsiy2ydFsQqXgRQX2ANJ1tg0kmzKRu69M7LlWRXtpbJsl8zM/MFvsY1AcQe0yNHg0rrSA5XPu0afTb63JwqxUXm9Y2YIJGH4D1Yn59NevqDlYvUIr8ZCVK4jq6Rm9LybUx7LYQLQ8xQ5LHFinaIiVtTLT0vssDhzHb4lc++HIw46qa6iND5yjYtt7BPbpdhFT6fkMQRMTEW5/5R+vO0TqkdSZ0wCx5Yug9mdSnX2Z0cwJF7wgZ2zKUMMeJekraR1V/iuEPmFwGjE+AKcNlxORIGD5E2GsVXf24SUh2FUSSSEqmUj2s57JSzMVH/wlLpDvCjoHM97UNAbvnpwcpzL+9z78AUEsDBBQAAAAAACtYilMAAAAAAAAAAAAAAAALAAAAd29yZC9fcmVscy9QSwMEFAAAAAgAAAAhANZks1HtAAAAMQMAABwAAAB3b3JkL19yZWxzL2RvY3VtZW50LnhtbC5yZWxzrZLLasMwEEX3hf6DmH0tO31QSuRsSiHb1v0ARR4/qCwJzfThv69IaeKQELLwcq6Yc49glqufwYovjNR7p6DIchDojK971yp4r15uHkEQa1dr6x0qGJFgVV5fLV/Rak5L1PWBRKI4UtAxhycpyXQ4aMp8QJdeGh8HzWmMrQzafOgW5SLPH2ScMqA8YIp1rSCu61sQ1RjwErZvmt7gszefAzo+USG/cfOGzOlzlLA6tsgKJmGWiCBPiyzmFKEjC7pAoZhVgUeLE4HtfLb+fs56Tru4b9+Of2FxzuFuTofGO670xk48dtG/hDw49PIXUEsDBBQAAAAIAAAAIQDfpNJsUQEAACAFAAATAAAAW0NvbnRlbnRfVHlwZXNdLnhtbLWUzW7CMBCE75X6DpGvFTH0UFUVgUN/ji1S6QMYewNWHdvyLn9v3w2hHBAi0MIlUrwz840t2f3hqnLZAhLa4AvRy7siA6+DsX5aiK/xW+dRZEjKG+WCh0KsAcVwcHvTH68jYMZuj4WYEcUnKVHPoFKYhwieJ2VIlSL+TVMZlf5WU5D33e6D1METeOpQnSEG/Rco1dxR9rri5aZJAocie26EzGK0itFZrYjncuHNHqWzJeTs3GhwZiPesUDIgwSeHAFsfR98NMkayEYq0buqWCWXIRlpgp5X7MxZeF7PUJZWw85fp8UUNCDymVcu300qZf1dWw+ktQO8fIsmtx0PRGy4RoEmub3CEiafV2tRh59apAwMVRMHl6+xi24tQXwDofn2/t2jjjmKZOUohYh8o9Mftv17ZWt3JyaeJrKAJxE5+nzg3v6gfg0MmANsuXnfBj9QSwMEFAAAAAAAK1iKUwAAAAAAAAAAAAAAAAYAAABfcmVscy9QSwMEFAAAAAgAAAAhAB6RGrfpAAAATgIAAAsAAABfcmVscy8ucmVsc42S20oDQQxA3wX/Ych7N9sKItLZvojQN5H6AWEme8GdCzNR2793EMUu9LKPk0lOTkLWm70b1SenPASvYVnVoNibYAffaXjbPS8eQGUhb2kMnjUcOMOmub1Zv/JIUopyP8SsCsVnDb1IfETMpmdHuQqRfflpQ3Ik5Zk6jGTeqWNc1fU9pmMGNBOm2loNaWvvQO0OkeewQ9sOhp+C+XDs5UQL5L2wt2wXMZX6JAPngqfUsWiwwbyUcEaKsSpowNNGq/lG56dFx0KWhNCExBd9fjIuCS3nC11f0TTj3+YrJIv2N/xng5MraL4BUEsBAj8AFAAAAAAAK1iKUwAAAAAAAAAAAAAAAAkAJAAAAAAAAAAQAAAAAAAAAGRvY1Byb3BzLwoAIAAAAAAAAQAYACQ/++Gs7dcB4KdB7aUA2AEQt+fhrO3XAVBLAQI/ABQAAAAIAONYilM0lSs00QEAAOgDAAAQACQAAAAAAAAAIAAAACcAAABkb2NQcm9wcy9hcHAueG1sCgAgAAAAAAABABgAhp5drq3t1wGhRQNvpgDYAZhG7uGs7dcBUEsBAj8AFAAAAAgAPXQjVOZRK4BpAQAAAwMAABEAJAAAAAAAAAAgAAAAJgIAAGRvY1Byb3BzL2NvcmUueG1sCgAgAAAAAAABABgAs9GIjqYA2AFrYZGOpgDYASQ/++Gs7dcBUEsBAj8AFAAAAAAAK1iKUwAAAAAAAAAAAAAAAAUAJAAAAAAAAAAQAAAAvgMAAHdvcmQvCgAgAAAAAAABABgAVCQJ4qzt1wFsI0fopQDYAVD8j+Gs7dcBUEsBAj8AFAAAAAgAAAAhAIl30t5BAgAADwcAABEAJAAAAAAAAACAAAAA4QMAAHdvcmQvZG9jdW1lbnQueG1sCgAgAAAAAAABABgAABgRgJfnqAGhRQNvpgDYAQZbo+Gs7dcBUEsBAj8AFAAAAAgAAAAhAP+dwDGwAQAAPAUAABIAJAAAAAAAAACAAAAAUQYAAHdvcmQvZm9udFRhYmxlLnhtbAoAIAAAAAAAAQAYAAAYEYCX56gBoUUDb6YA2AH0187hrO3XAVBLAQI/ABQAAAAIAAAAIQBiXuxfmwMAAPwJAAARACQAAAAAAAAAgAAAADEIAAB3b3JkL3NldHRpbmdzLnhtbAoAIAAAAAAAAQAYAAAYEYCX56gBoUUDb6YA2AFybMHhrO3XAVBLAQI/ABQAAAAIAAAAIQCf5pQSXAoAAFNwAAAPACQAAAAAAAAAgAAAAPsLAAB3b3JkL3N0eWxlcy54bWwKACAAAAAAAAEAGAAAGBGAl+eoAaFFA2+mANgBVCQJ4qzt1wFQSwECPwAUAAAAAAArWIpTAAAAAAAAAAAAAAAACwAkAAAAAAAAABAAAACEFgAAd29yZC90aGVtZS8KACAAAAAAAAEAGABqPLPhrO3XAWwjR+ilANgBUjGu4azt1wFQSwECPwAUAAAACAAAACEAB7dAqusFAACPGgAAFQAkAAAAAAAAAIAAAACtFgAAd29yZC90aGVtZS90aGVtZTEueG1sCgAgAAAAAAABABgAABgRgJfnqAGhRQNvpgDYAWo8s+Gs7dcBUEsBAj8AFAAAAAgAAAAhAJN21kkSAQAAQAIAABQAJAAAAAAAAACAAAAAyxwAAHdvcmQvd2ViU2V0dGluZ3MueG1sCgAgAAAAAAABABgAABgRgJfnqAGhRQNvpgDYAUrN3eGs7dcBUEsBAj8AFAAAAAAAK1iKUwAAAAAAAAAAAAAAAAsAJAAAAAAAAAAQAAAADx4AAHdvcmQvX3JlbHMvCgAgAAAAAAABABgAWtyW4azt1wFsI0fopQDYAUhrkuGs7dcBUEsBAj8AFAAAAAgAAAAhANZks1HtAAAAMQMAABwAJAAAAAAAAACAAAAAOB4AAHdvcmQvX3JlbHMvZG9jdW1lbnQueG1sLnJlbHMKACAAAAAAAAEAGAAAGBGAl+eoAaFFA2+mANgBWtyW4azt1wFQSwECPwAUAAAACAAAACEA36TSbFEBAAAgBQAAEwAkAAAAAAAAAIAAAABfHwAAW0NvbnRlbnRfVHlwZXNdLnhtbAoAIAAAAAAAAQAYAAAYEYCX56gBoUUDb6YA2AHYP3nhrO3XAVBLAQI/ABQAAAAAACtYilMAAAAAAAAAAAAAAAAGACQAAAAAAAAAEAAAAOEgAABfcmVscy8KACAAAAAAAAEAGAAaIofhrO3XAbWAQe2lANgBBkCC4azt1wFQSwECPwAUAAAACAAAACEAHpEat+kAAABOAgAACwAkAAAAAAAAAIAAAAAFIQAAX3JlbHMvLnJlbHMKACAAAAAAAAEAGAAAGBGAl+eoAaFFA2+mANgBGiKH4azt1wFQSwUGAAAAABAAEAARBgAAFyIAAAAA"}),define("DS/SwymUIComponents/script/feature/core/ui-components/view-mode-switcher/view-mode-switcher",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/ui-components/view-mode-switcher/view-mode-switcher","DS/UIKIT/Tooltip","DS/SwymUICore/script/lib/view/generic/swym-view","DS/WebappsUtils/Console","DS/SwymUICore/script/utils/localstorage-manager"],function(e,t,i,n,o,s){return n.extend({name:"view-mode-switch",_context:null,_mode:null,_modes:{whatsNew:["list","tiles"],communityMediaTab:["small","large"]},_classPrefix:{whatsNew:"box-",communityMediaTab:"wrapper-"},_layoutClasses:{whatsNew:{list:["col-lg-12","col-md-12","col-sm-12","col-xs-12"],tiles:["col-lg-4","col-md-6","col-sm-6","col-xs-12"]},communityMediaTab:{small:["col-lg-2","col-md-3","col-sm-4","col-xs-6"],large:["col-lg-3","col-md-4","col-sm-6","col-xs-12"]}},_target:null,_dimensions:null,attributes:{styles:{position:"absolute",top:"5px",right:"25px"}},_createContent:function(){var n=null;"whatsNew"===this._context&&(n=e.createElement("div",{class:"view-toolbar",html:[{tag:"div",styles:{background:"transparent",display:"inline-block"},html:{tag:"span",class:"apply_tiles_mode fonticon fonticon-2x fonticon-layout"+("tiles"!==this._mode?" unselect-view":""),styles:{margin:"0"}}},{tag:"div",styles:{background:"transparent",display:"inline-block","margin-left":"0px"},html:{tag:"span",class:"apply_list_mode fonticon fonticon-2x fonticon-menu"+("list"!==this._mode?" unselect-view":""),styles:{margin:"0"}}}]}),e.Utils.Client.Features.touchEvents||(this.addControl("tilesModeTooltip",new i({target:n.getElement(".apply_tiles_mode"),body:t.TilesView,position:"bottom"})),this.addControl("listModeTooltip",new i({target:n.getElement(".apply_list_mode"),body:t.ListView,position:"bottom"}))));return n},init:function(e){try{return(e=e||{}).target&&this.setTarget(e.target),this._dimensions=e.dimensions?e.dimensions:null,this._context=e.viewModeContext||"whatsNew",this._mode=this.isModeValid(e.mode)?e.mode:this._modes[this._context][0],this._parent.apply(this,arguments)}catch(e){return o.error("Error initializing view mode switch: "+e.message),!1}},applyMode:function(){var e,t,i,n,o,s,a,r,l=this._target,c=l.container,d=l.getModelViews(),m=this._modes[this._context],u=this._classPrefix[this._context],h=this._layoutClasses[this._context],p=h[this._mode];if(!c.hasClassName(u+this._mode)){for(e=0,t=m.length;e<t;e++)c.removeClassName(u+m[e]);c.addClassName(u+this._mode)}for(e=0,t=d.length;e<t;e++){for(a=(s=d[e].container).className,i=0,n=m.length,r=[];i<n;i++)(o=m[i])!==this._mode&&(r=r.concat(h[o]));a=a.replace(new RegExp(r.join("|").replace(/-/g,"\\ -"),"g"),""),a+=" "+p.join(" "),s.setAttribute("class",a.replace(/\s{1,}/g," "))}return this._mode},bindEvents:function(){return this._modes[this._context].forEach(function(e){this.getElement(".apply_"+e+"_mode").addEvent("click",this.setMode.bind(this,e))},this),!0},isModeValid:function(e){return!!(e&&this._modes[this._context].indexOf(e)>-1)},getMode:function(){return this._mode},setMode:function(e){if(!this.isModeValid(e))throw new Error("Mode is not valid");if(this._mode!==e){var t,i=null,n=this.getElement(".apply_"+e+"_mode");"whatsNew"===this._context?i=this.getElement(".apply_"+("tiles"===e?"list":"tiles")+"_mode"):"communityMediaTab"===this._context&&(i=this.getElement(".apply_"+("large"===e?"small":"large")+"_mode"),document.cookie="mediaListMode="+e+"; path=/"),i&&i.addClassName("unselect-view"),n&&n.removeClassName("unselect-view"),this.dispatchEvent("onBeforeModeChange",[e]),this._mode=e,this.applyMode(),this.dispatchEvent("onModeChange",[this,this._mode]),"whatsNew"===this._context&&((t=s.getItem("viewModes"))||(t={}),t[this._context]=e,s.setItem("viewModes",t))}return this},setTarget:function(e){if(!e||!e.container)throw new Error("Provided target is invalid");return this._target=e,this._target},getImagesReloadOptionsForTarget:function(){return"tiles"===this.getMode()?{size:"xl"}:{}}})}),define("DS/SwymUIComponents/script/feature/core/search/view/community-selector/community-selector-autocomplete",["require","exports","DS/UIKIT/Autocomplete","DS/UIKIT/Spinner","UWA/Core"],function(e,t,i,n,o){"use strict";return i.extend({_appendItem:function(e,t,i){var n;(this._parent.apply(this,arguments),n=e.suggests||e.items,"other-communities"===e.name&&n.indexOf(t)===n.length-1)&&(i.getElement(".loading-div")||o.createElement("li",{class:"autocomplete-item default-template loading-div"})).inject(i)},loadNextSuggests:function(e,t){var i=this,s=i.getDataset("other-communities").collection,a=i.getDataset("recent-communities")&&i.getDataset("recent-communities").items;e.forEach(function(e){e.isIntersecting&&(e.target&&!e.target.getElement(".spinner")&&(new n).inject(e.target).show(),function(e,t){var i=e.getCurrentPage(),n=null===i?1:i+1;e.fetchPage(n,o.extend({serviceName:"filter",ignoreCache:!0,reset:!1,add:!0,remove:!1},t))}(s,{data:{favorite_communities:"without",select_predicate:["title","id","resourceid"]},onComplete:function(e,t,n){var o=e.parse(t,n);if(o.length>0){var s=i.getDataset("other-communities"),r=o.flatMap(function(e){return a.find(function(t){return t.value===e.mid})?[]:[{value:e.mid,label:e.title}]});if(r.length>0)i.addItems(r,s),s.items.slice(0-r.length).forEach(function(e){i._appendItem(s,e,i.elements.suggests)});e.hasNext()||i.endLoading()}else i.endLoading()}}))})},endLoading:function(){var e=this.elements.suggests.getElement(".loading-div");e&&e.remove()},onUpdateSuggests:function(){var e=this;this._parent.apply(this,arguments),setTimeout(function(){e.observerTarget=e.elements.suggests.getElement(".loading-div"),e.observerTarget&&(e.observer=function(e,t,i){var n=new IntersectionObserver(i,{root:null,threshold:.01});return n.observe(t),n}.call(e,e.elements.suggests,e.observerTarget,e.loadNextSuggests.bind(e)))},10)},onAppendSuggests:function(){},destroy:function(){return this.observer&&this.observer.disconnect?this.observer.disconnect():this.observer&&this.observer.unobserve&&this.observerTarget&&this.observer.unobserve(this.observerTarget),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/utils/feature-preferences",["require","exports"],function(e,t){"use strict";return["allowODECreationFeature","allowODEViewerFeature"]}),define("DS/SwymUIComponents/script/feature/core/user/view/phone/user-phone-edit-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/user/model/user-model","DS/UIKIT/Form","DS/WebappsUtils/Console"],function(e,t,i,n,o){"use strict";return t.extend({_modelClass:i,name:"user-phone-edit-view",_createContent:function(){var t=this.model,i=t.getPassportAttributeConstraints("tel");return this.addControl("form-aboutme",new n({fields:[e.merge({type:"text",value:t.get("tel",{escapeHTML:!1}),events:{onChange:function(){t.addChanges("tel",this.getValue())}}},i)]}))}})}),define("DS/SwymUIComponents/script/utils/content-upload-error",["DS/UWPClientControls/PlatformNotify","i18n!DS/SwymUIComponents/assets/nls/utils/content-upload-error"],function(e,t){"use strict";return{printErrorMessage:function(i,n){var o;switch(i&&i.errorcode||i&&i.errorID){case"ERROR_MEDIA_TYPE_MISMATCH":case"ERROR_FILE_EXTENSION_MISMATCH":o=t.ERROR_FILE_EXTENSION_MISMATCH;break;case"ERROR_FILE_FORMAT_UNAUTHORIZED":o=t.ERROR_FILE_FORMAT_UNAUTHORIZED;break;case"shareSwymInvalidSize":case"ERROR_FILE_SIZE_EXCEEDED":o=t.ERROR_FILE_SIZE_EXCEEDED;break;case"ERROR_PICTURE_RESOLUTION_EXCEEDED":o=t.ERROR_PICTURE_RESOLUTION_EXCEEDED;break;case"ERROR_MEMBER_CSV_FORMAT_MISMATCH":o=t.ERROR_MEMBER_CSV_FORMAT_MISMATCH;break;case"ERROR_MEMBER_CSV_MAX_LINE_REACH":o=t.ERROR_MEMBER_CSV_MAX_LINE_REACH;break;default:switch(n){case"csv":o=t.anerroroccurredduringtheoperation;break;case"media":o=t.CertainmediacouldnotbeuploadedPleasetryagain}}o&&e.info(o)}}}),define("DS/SwymUIComponents/script/feature/core/search/view/user-search-factory",["UWA/Core","UWA/Class","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/lib/request/data","DS/UIKIT/Autocomplete","DS/UWPClientCode/I18n","i18n!DS/SwymUIComponents/assets/nls/feature/core/search/view/user-search-view","DS/WebappsUtils/Console","UWA/Class/Promise"],function(e,t,i,n,o,s,a,r,l,c,d,m){"use strict";return{Factory:t.extend({_defaultValue:null,_communityId:null,_disableUserGroup:!1,_mailAllowed:!1,_multiSelect:!1,_label:"",_events:{},_disabled:!1,_pendingUsersAllowed:!1,_loginsToExcludeFromSearch:[],_getConfiguration:function(){var t=this;return{filterEngine:function(e,i){var n=t;return n._loginsToExcludeFromSearch.length>0&&(i=i.filter(function(e){return-1===n._loginsToExcludeFromSearch.indexOf(e.login)})),i},templateEngine:function(e,i,n){var s=t,a=!0===s._mailAllowed&&s._isAMail(n.label)?n.label:n.login,r=o.constructUserPictureUrl(a,n.picture_update),l=s._isAPhoneNumber(n.label)?'<span class="fonticon fonticon-phone people-search-img"></span>':'<img class="people-search-img" src="'+r+'"/>';e.addClassName("default-template people-search-template with-sub-label"),e.setHTML(l+'<div class="item-label">'+n.label+'</div> <div class="sub-label">'+(n.subLabel?n.subLabel:"")+"</div>")},remoteSearchEngine:function(e,i,o){var r,c,d,u,h,p=t;return""!==i.trim()&&(r=s.getBaseUrl()+"/api/user/search",(c={limit:5,start:0,locale:l.getCurrentLanguage()}).query=i,p._communityId&&(c.community_id=p._communityId,c.restricttocommunity=p._restricted),h=new m(function(t){d=n.adaptService({url:r,data:c,onComplete:function(n){n=n.result,(u={}).dataset=e,u.matchingItems=n&&e.configuration.dataParser&&e.configuration.dataParser.call(this,e,n,i),t(u),o&&o(u.matchingItems)}.bind(this)}),a.request(d)})),h},dataParser:function(i,n,o){var s,a=[],r=t,l=e.is(r._communityId),d=r._loginsToDisableInSuggestions;return n.forEach(function(e){s={resourceUid:e.uid,label:e.nickname,nickname:e.nickname,value:e.nickname,hash_key:e.hash_key,login:e.login,ut_state:e.ut_state,subtitle:e.job_title,disabled:d&&d.indexOf(e.login)>=0||Boolean(l&&!e.acc),picture_update:e.picture_update},"0"===e.ut_state&&""===e.nickname.trim()&&(s.label=s.value=e.ut_invitation_email+" ("+c.Pending+")",s.disabled=!r._pendingUsersAllowed),"1"===e.user_tenant_status&&(s.label+=" ("+c.Contractor+")",s.value=s.label),a.push(s)}),r._mailAllowed&&0===a.length&&r._isAMail(o)&&a.push({hash_key:o,label:o,value:o}),0===a.length&&r._phoneAllowed&&r._isAPhoneNumber(o)&&a.push({hash_key:o,label:o,value:o,resourceId:o}),a}}},_isAMail:function(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)},_isAPhoneNumber:function(e){return/^\+\d{2,15}$/.test(e)},_setCommunityId:function(t,i){this._communityId=t,e.is(i)&&(this._restricted=i)},_setupConfig:function(t){if(!t.parentSwymView&&!0===t.mailAllowed)throw Error("Please provide a parentSWymView so the component can be refreshed. UIKIT controls cannot be refreshed");t&&(e.is(t.community_id)&&this._setCommunityId(t.community_id,t.restricted),e.is(t.disableUserGroup)&&(this._disableUserGroup=t.disableUserGroup),e.is(t.label)&&(this._label=t.label),e.is(t.pendingUsersAllowed)&&(this._pendingUsersAllowed=t.pendingUsersAllowed),e.is(t.parentSwymView)&&(this._parentSwymView=t.parentSwymView),e.is(t.mailAllowed)&&!this._alreadyRefreshed&&(this._mailAllowed=t.mailAllowed),e.is(t.phoneAllowed)&&(this._phoneAllowed=t.phoneAllowed),e.is(t.loginsToExcludeFromSearch)&&(this._loginsToExcludeFromSearch=t.loginsToExcludeFromSearch),e.is(t.loginsToDisableInSuggestions)&&(this._loginsToDisableInSuggestions=t.loginsToDisableInSuggestions),e.is(t.defaultValue)&&(this._defaultValue=t.defaultValue),e.is(t.multiSelect)&&(this._multiSelect=t.multiSelect),e.is(t.events)&&(this._events=t.events),e.is(t.disabled)&&(this._disabled=t.disabled))},_getEvents:function(){var e=this,t=e._events,i=t.onSelect,n=t.onUnselect,o=t.onInjected;return t.onInjected=function(){e._defaultValue&&!0!==e.injected&&(e.configuration.remoteSearchEngine(e,e._defaultValue,function(t){if(Array.isArray(t)&&t.length)return this.onSelect(t.find(t=>t.login===e._defaultValue)||t[0]);this.dispatchEvent("onNoResults",e,e._defaultValue)}.bind(this)),e.injected=!0),o&&o.apply(this,arguments)},t.onSelect=function(){this.onClickOutside(),i&&i.apply(this,arguments)},t.onUnselect=function(){n&&n.apply(this,arguments)},t},_getAutocompleteOptions:function(){return this.configuration=this._getConfiguration(),{required:!0,datasets:[{configuration:this.configuration}],disabled:this._disabled,typeDelayBeforeSearch:300,minLengthBeforeSearch:3,placeholder:this._phoneAllowed?c.EnterANameOrPhoneNumberOrEmail:this._mailAllowed?c.EnterAName:c.Users,label:this._label,multiSelect:this._multiSelect,events:this._getEvents()}}}),getFormConfig:function(t){var i=new(0,this.Factory);return i._setupConfig(t),e.extend({type:"autocomplete",name:"search-user-autocomplete"},i._getAutocompleteOptions())},createUserSearchControl:function(e){var t=new(0,this.Factory);return t._setupConfig(e),new r(t._getAutocompleteOptions())}}}),define("DS/SwymUIComponents/script/feature/core/user/view/interest/user-interest-edit-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/interest/model/interest-model","DS/UIKIT/Form","DS/WebappsUtils/Console"],function(e,t,i,n,o){"use strict";return t.extend({_modelClass:i,name:"user-interest-edit-view",_createContent:function(){var e=this.model;return this.addControl("form-aboutme",new n({fields:[{type:"text",value:e.get("title",{escapeHTML:!1}),required:!0,events:{onChange:function(){e.addChanges("title",this.getValue())}}}]}))}})}),define("DS/SwymUIComponents/script/feature/core/tenant/view/tenant-media-max-size-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/tenant/view/tenant-media-max-size-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/media/model/media-file-extension-model","DS/UWPClientControls/PlatformNotify","DS/UIKIT/Form","DS/UIKIT/Spinner","DS/UIKIT/Mask"],function(e,t,i,n,o,s,a,r){"use strict";var l=1048576;return console.log("DS/SwymUIComponents/script/feature/core/tenant/view/tenant-media-max-size-view"),i.extend({name:"tenant-media-max-size",_mediaFileExtension:null,_platformMinSize:1*l,_platformMaxSize:null,_maxSizes:null,_form:null,_submitBtnEl:null,_submitSpinnerEl:null,_toggleSubmitSpinnerState:!0,domEvents:{resize:"_onResize"},postModelSyncInit:function(){var e=this.model.get("media_upload_config");this._maxSizes=e.currentMaxUploadSize,this._renderCurrentValues(),"1"===e.isMaxUploadSizeEditable&&(this._platformMaxSize=e.maxMaxUploadSize,this._form.enable()),r.unmask(this.container)},setup:function(){return window.ds&&"3DD"!==window.ds.env&&(this.model.get("media_upload_config")?this.addEventOnce("onRender",this.postModelSyncInit.bind(this)):this.model.addEventOnce("onSync:read",this.postModelSyncInit.bind(this))),this._mediaFileExtension=n.getInstance(),this._submitSpinnerEl=new a({className:"small"}).show(),this._parent.apply(this,arguments)},_createContent:function(){var i=e.createElement("div",{class:"form-group help",text:t.help});return this._form=new s({className:"horizontal",grid:"2 10",fields:[{type:"text",name:"document",label:t.document,pattern:"^[0-9]+$"},{type:"text",name:"video",label:t.videoOnly,pattern:"^[0-9]+$"},{type:"text",name:"picture",label:t.picture,pattern:"^[0-9]+$"},{type:"text",name:"sound",label:t.sound,pattern:"^[0-9]+$"},{type:"text",name:"3d_model",label:t["3d_model"],pattern:"^[0-9]+$"},{type:"text",name:"drawing",label:t.drawing,pattern:"^[0-9]+$"}],buttons:[{type:"submit",value:t.save},{type:"reset",value:t.cancel}],events:{onValid:function(){this._validate(!0)}.bind(this),onInvalid:function(){this._validate(!1)}.bind(this),onReset:function(){this._form.unvalidate()}.bind(this)}}),this._form.disable(),[i,this._form]},onRender:function(){r.mask(this.container);for(var t=this.container.getElement("form").getElements(".form-group label"),i=["doc-text","play","picture","note","database","picture"],n=-1,o=i.length;++n<o;){var s=e.createElement("span",{class:"fonticon fonticon-"+i[n]}),a=e.createElement("span",{class:"label-text",text:t[n].getText()});t[n].setContent(s),t[n].addContent(a)}this._submitBtnEl=this.getElement(".btn-primary"),this.postModelSyncInit.call(this)},_onResize:function(){var e=this.getElement(".col-sm-offset-2"),t=e.getElement(".btn-default"),i=this.getElements(".form-group"),n=this.container.getDimensions().width-30,o=this._submitBtnEl.getDimensions().width+t.getDimensions().width+5;if(211>n)for(var s=-1,a=i.length;++s<a;)a-2>s&&i[s].setStyle("margin-bottom","5px");else for(s=-1,a=i.length;++s<a;)a-2>s&&i[s].setStyle("margin-bottom","15px");n<o+1?(this._submitBtnEl.setStyle("margin","5px 0 0 0"),e.setStyle("padding-left","7px"),this._submitBtnEl.inject(e)):(this._submitBtnEl.setStyle("margin","0 5px 0 0"),e.setStyle("padding-left",0),this._submitBtnEl.inject(e,"top"))},_convertInByte:function(e){return e*l},_convertInMByte:function(e){return e/l},_renderCurrentValues:function(){for(var e=this._form.getFields(),t=-1,i=e.length;++t<i;)this._maxSizes&&e[t].setAttributes({placeholder:this._convertInMByte(parseInt(this._maxSizes[e[t].name],10))})},_validate:function(e){this._form.disable();var i=!1,n=!1,s="";this._form.getFields().forEach(function(e){var o=e.getParent(".form-group");if(!o.hasClassName("has-error")&&""!==e.value){var a=this._convertInByte(parseInt(e.value,10));this._platformMinSize>a?(i=!0,o.addClassName("has-error")):this._platformMaxSize[e.name]<a&&(n=!0,o.addClassName("has-error"),s+='<span class="'+this.name+'-container errMaxMediaMsg">',s+=t[e.name]+" : "+Math.floor(this._platformMaxSize[e.name]/l),s+="</span>")}},this),i&&o.error(t.errorMin+Math.floor(this._convertInMByte(this._platformMinSize))),n&&o.error('<span class="'+this.name+'-container errMaxMsg">'+t.errorMax+"</span>"+s),!e||i||n?this._form.enable():this._submit()},_submit:function(){this._toggleSubmitSpinner();var e=this._form.getValues(),i=0,n=0,s={};for(var a in e)if(e.hasOwnProperty(a)){if(""===e[a])++i;else{var r=this._convertInByte(parseInt(e[a],10));this._maxSizes[a]===r?++i:s[a+"_maxsize"]=r}++n}n>i?this.model.save(s,{wait:!0,onComplete:function(){for(var e in s)s.hasOwnProperty(e)&&"update"!==e&&(this._maxSizes[e.slice(0,-8)]=parseInt(s[e],10));this._mediaFileExtension.set("maxSizes",this._maxSizes),this._renderCurrentValues(),this._form.reset(),this._toggleSubmitSpinner(),this._form.enable(),o.success(t.submitComplete)}.bind(this),onFailure:function(){o.error(t.submitFailure),this._form.reset(),this._toggleSubmitSpinner(),this._form.enable()}.bind(this)}):(this._form.reset(),this._toggleSubmitSpinner(),this._form.enable())},_toggleSubmitSpinner:function(){this._toggleSubmitSpinnerState?this._submitBtnEl.setContent(this._submitSpinnerEl):this._submitBtnEl.setText(t.save),this._toggleSubmitSpinnerState=!this._toggleSubmitSpinnerState},setPlatformMinSize:function(e){this._platformMinSize=e*l}})}),define("DS/SwymUIComponents/script/feature/core/user/view/user-3dpassport-buttons-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/utils/utils","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/user-3dpassport-buttons-view","DS/PlatformAPI/PlatformAPI","DS/UIKIT/Input/Button","DS/WebappsUtils/Console","DS/UIKIT/Input/Toggle","DS/SwymUICore/script/utils/platform-utils","DS/SwymUICore/script/feature/core/config/bootstrap-model"],function(e,t,i,n,o,s,a,r,l,c,d){"use strict";return t.extend({_modelClass:i,name:"user-3dpassport-buttons-view",setup:function(){return this._parent.apply(this,arguments)},_createContent:function(){var t,i=this,s=this.model,r=n.isCloud()&&void 0!==s.marketing_consent||s.passwordEditUrl||s.twoFAURL||s.adminURL||s.emailValidationURL;return c.getPassportURLPromise().then(e=>{t=e}),r?e.createElement("div",{html:[{tag:"h4",class:"titleProfile",html:o.threeDPassport},{class:"margin-top-20px",html:[s.passwordEditUrl?new a({value:o.resetpassword,events:{onClick:function(){window.open(t+s.passwordEditUrl)}.bind(this)}}):"",s.twoFAURL?new a({value:o.twoFAauth,events:{onClick:function(){window.open(t+s.twoFAURL)}.bind(this)}}):"",s.adminURL?new a({value:o.AdminTools,events:{onClick:function(){window.open(t+s.adminURL)}.bind(this)}}):"",s.emailValidationURL?new a({value:o.SendEmailValidation,events:{onClick:function(){window.open(t+s.emailValidationURL)}.bind(this)}}):""]},n.isCloud()&&void 0!==s.marketing_consent?new l({type:"checkbox",className:"primary margin-top-20px",label:o.AcceptNewsletters,checked:"true"===s.marketing_consent||!0===s.marketing_consent,events:{onClick:function(){var e=this.isChecked();s.updatePassportFields({data:{marketing_consent:e},onComplete:function(){i.alert("success",o.settingChanged)}})}}}):""]}):""}})}),define("DS/SwymUIComponents/script/feature/community/media/edit/upload/copy-paste-upload-view",["UWA/Core","UWA/Data","DS/SwymUICore/script/lib/view/generic/swym-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/library/media-library-view","DS/Logger/Logger"],function(e,t,i,n,o){"use strict";return i.extend({name:"copy-paste-upload",_createContent:function(){return{}},_dataURLtoFile:function(e){for(var t=e.split(","),i=t[0].match(/:(.*?);/)[1],n=atob(t[1]),o=n.length,s=new Uint8Array(o);o--;)s[o]=n.charCodeAt(o);return new Blob([s],{type:i})},_dispatchEvents:function(e,t,i){e.length+t.length===i.length&&(e.length===i.length?this.dispatchEvent("onFilesSelected",[e]):(this.alert("warn",n.MediaProxyError),this.dispatchEvent("onFilesSelected",[e]),this.dispatchEvent("onUploadFailed",[t])))},getAndTransformMediaPasted:function(e){var i,o,s,a=this,r=[],l=[];if(e.length>0&&e[0]instanceof File)this.dispatchEvent("onFilesSelected",[e]);else for(var c=0,d=e.length;c<d;c++)if(s={src:i=(o=e[c]).src,mediaPastedId:o.mediaPastedId},i.startsWith("data:image")){var m=a._dataURLtoFile(i);const t=m.type.match(new RegExp(/(?:image\/)([a-zA-Z0-9]+)/)),n=t&&t[1];m.lastModifiedDate=new Date,m.info=s,m.name=`${s.mediaPastedId}-title.${n||"png"}`,r.push(m),a._dispatchEvents(r,l,e)}else this.dispatchEvent("onMediaUploadsStart"),t.request(i,{type:"blob",onComplete:function(t,i){var n=new Blob([i]);n.info=t,n.lastModifiedDate=new Date,i.type&&i.type.split("/").length>0?n.name=t.mediaPastedId+"-title."+i.type.split("/")[i.type.split("/").length-1]:n.name=t.mediaPastedId+"-title.jpg",r.push(n),a._dispatchEvents(r,l,e)}.bind(this,s),onFailure:function(t,i,o){l.push(t),r.length+l.length===e.length&&(r.length===e.length?a.dispatchEvent("onFilesSelected",[r]):(t.src.startsWith("data:image")||a.alert("warn",n.MediaProxyError),a.dispatchEvent("onFilesSelected",[r]),a.dispatchEvent("onProxyFailed",[l]))),this.dispatchEvent("onMediaUploadsFailure")}.bind(this,s),onTimeout:function(t,i,o){l.push(t),r.length+l.length===e.length&&(r.length===e.length?a.dispatchEvent("onFilesSelected",[r]):(t.src.startsWith("data:image")||a.alert("warn",n.MediaProxyError),a.dispatchEvent("onFilesSelected",[r]),a.dispatchEvent("onProxyFailed",[l]))),this.dispatchEvent("onMediaUploadsFailure")}.bind(this,s)})}})}),define("DS/SwymUIComponents/script/feature/community/survey/view/answer-editor-view",["UWA/Core","UWA/String","i18n!DS/SwymUIComponents/assets/nls/feature/community/survey/view/answer-editor-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/UIKIT/Input/Text"],function(e,t,i,n,o){return n.extend({_modelEvents:{onChange:"contentChanged",onVirtualChange:"contentChanged"},domEvents:{"change .answer-description-editor-input":"onDescriptionChange","click .answer-delete-button":"onDeleteAnswerClick"},contentChanged:function(){this.model.collection.dispatchEvent("onChange")},_createContent:function(){var n=this.model;if(n&&1!==n.get("is_open")){var s="1"==n.get("is_open");return viewEl=e.createElement("div",{class:"answer-wrapper",html:[this.addControl("answer-description-editor-input",new o({className:"answer-description-editor-input",placeholder:i.Answer,disabled:s,value:t.unescapeHTML(n.getChanges("description")||n.get("description")||""),events:{onChange:this.validate.bind(this)}})),s?"":{class:"answer-delete-button fonticon fonticon-trash",tag:"span",styles:{display:2===this._parentView.collection.length?"none":"block"}}]}),viewEl}},onDescriptionChange:function(e){this.model.addChanges("description",t.escapeHTML(e.target.value))},onDeleteAnswerClick:function(){this._parentView.collection.length>2&&(this._parentView.collection.remove(this.model),2===this._parentView.collection.length?this._parentView.getElements(".answer-delete-button").forEach(function(e){e.hide()}):this._parentView.getElements(".answer-delete-button").forEach(function(e){e.show()}))},validate:function(){var e=this.getControl("answer-description-editor-input");""===e.getValue().trim()?e.getContent().addClassName("field-error"):e.getContent().removeClassName("field-error")}})}),define("DS/SwymUIComponents/script/feature/community/media/view/edit-file-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/view/edit-file-view","UWA/Element","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/media/model/media-file-extension-model","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/error/error"],function(e,t,i,n,o,s,a,r){"use strict";return o.extend({name:"edit-file-view",className:"container-fluid editor-border",baseUrl:null,_fileName:"",domEvents:{"click .editFile-cancel-button":"onCancel","change #form-file-file":"_filesSelected"},_modelEvents:{"onVirtualChange:userFile":"refresh"},_mediaFileExtension:null,_createContent:function(){if(this.model)return[{tag:"span",class:"replace-file",html:[t.changeFile,{tag:"span",class:"replace-file-filename",html:this._fileName}]},{tag:"div",class:"replace-file-btn",html:[{tag:"span",class:"btn btn-default btn-file",html:[t.browse,{tag:"input",id:"form-file-file",class:"media-uploader-file-input",type:"file",name:"media-path"}],styles:{position:"relative"}},{tag:"button",type:"button",class:"btn btn-default editFile-cancel-button",html:t.cancel,styles:{display:"none"}}]}]},setup:function(){this._parent.apply(this,arguments),this.baseUrl=a.getBaseUrl(),this._mediaFileExtension=s.getInstance()},onCancel:function(e){e&&"function"==typeof e.stopPropagation&&e.stopPropagation(),e&&"function"==typeof e.preventDefault&&e.preventDefault(),this.model.removeChanges("userFile"),this._fileName="",this.refresh()},_filesSelected:function(e){this._handleFile(e.target.files[0])},_handleFile:function(e){if(void 0===e.fileName&&(e.fileName=e.name),this._isExtensionAllowed(e))this.file=e,this._fileName=e.fileName,this.model.addChanges("userFile",e),this.getElement(".editFile-cancel-button").show();else{var i=this.model.get("orig_name"),n=i.substr(i.lastIndexOf(".")+1);this.alert("error",t.fileTypeError+t.fileExtensionMustBe+n)}},_isExtensionAllowed:function(e){var t=this.model.get("orig_name"),i=e.fileName,n=this._getType(t),o=this._getType(i),s=t.substr(t.lastIndexOf(".")+1),a=i.substr(i.lastIndexOf(".")+1);return"image"===n&&"image"===o||s.toLowerCase()===a.toLowerCase()},_getType:function(e){for(var t=this._mediaFileExtension.get("authorizedFormats"),i=e.substring(e.lastIndexOf(".")+1,e.length).toLowerCase(),n=t.image,o=t.video,s=t.audio,a=t.document,r=t["3dmodel"],l=-1,c=n.length;++l<c;)if(n[l]===i)return"image";for(l=-1,c=o.length;++l<c;)if(o[l]===i)return"video";for(l=-1,c=a.length;++l<c;)if(a[l]===i)return"document";for(l=-1,c=s.length;++l<c;)if(s[l]===i)return"audio";for(l=-1,c=r.length;++l<c;)if(r[l]===i)return"3dmodel"},onSetModel:function(e,t,i){this.reactTo(i,"onSync:update",this.onCancel)}})}),define("DS/SwymUIComponents/script/feature/core/search/view/community-selector/user-template",["require","exports","UWA/Core"],function(e,t,i){"use strict";return function(e){return function(e,t,n){e.addClassName("default-template people-search-template"),i.createElement("span",{class:"item-label",html:[{tag:"img",class:"people-search-img",src:n.preview_url},{class:"item-label",html:n.label}]}).inject(e)}}}),define("DS/SwymUIComponents/script/feature/core/tenant/view/users-management-process-detail-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/tenant/view/users-management-process-detail-view","i18n!DS/SwymUIComponents/assets/nls/feature/core/tenant/view/users-management-processes-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/UIKIT/Input/Button","DS/SwymUICore/script/utils/utils","DS/UWPClientCode/I18n"],function(e,t,i,n,o,s,a){return n.extend({_modelEventsForAutoRefresh:["onChange"],_asAdmin:!1,_createContent:function(){var e=this,n=e.model;if(n&&n.processResults){var r,l='<table class="table table-hover"><tr><th>'+t.login+"</th><th>"+t.email+"</th><th>"+t.firstname+"</th><th>"+t.lastname+"</th><th>"+t.community+"</th><th>"+t.status+"</th><th>"+t.details+"</th></tr>";switch(n.processResults.forEach(function(e){var i="";[{id:0,text:t.success},{id:1,text:t.nonexistingusers},{id:2,text:t.alreadyexistingmembers},{id:3,text:t.incorrectinformationprovided},{id:4,text:t.additionofexternalmembers},{id:5,text:t.errorswhileprocessing},{id:6,text:t.usercannotberemoved},{id:7,text:t.accountcreationfailed},{id:8,text:t.additionofusertotenantfailed},{id:9,text:t.additionofuserastenantadministratorfailed},{id:10,text:t.useralreadypresentontenant},{id:11,text:t.userstatuschangefailed},{id:12,text:t.usernotfoundintenant},{id:13,text:t.userstatusisalreadychanged}].forEach(function(t){parseInt(e.details,10)==t.id&&(i=t.text)}),l+="<tr><td>"+e.user_login+"</td><td>"+e.user_email+"</td><td>"+e.user_first_name+"</td><td>"+e.user_last_name+"</td><td>"+e.communityName+"</td><td>"+("1"==e.result?t.success:t.failure)+"</td><td>"+i+"</td></tr>"}),l+="</table>",Number(n.get("process"))){case 11:r=i.adduserstocommunity;break;case 14:r=i.importnewusers;break;case 13:r=i.removeusersfromcommunity;break;case 15:r=i.changeuserstatus;break;default:r=""}var c="";return 3==Number(n.get("type"))?n.get("details")&&(c=a.replace(i.nofnsuccessful,{num1:n.get("details")[0],num2:n.get("details")[1]})):1==Number(n.get("type"))&&n.get("rank")&&(c=a.replace(i.positioninqueue,{num:n.get("rank")})),[{styles:{border:"1px solid #d8d8d8","border-radius":"10px","margin-bottom":"10px",padding:"10px"},html:[{styles:{"margin-bottom":"20px"},html:"<b>"+n.get("processName")+"'s details:</b> ("+r+" - "+c+")"},{styles:{padding:"10px"},html:l},{html:new o({value:t.Export,events:{onClick:function(){window.open(s.getBaseUrl()+"/api/member/exportusers/id/"+this.get("real_id")+(e._asAdmin?"/as_admin/"+e._asAdmin:""))}.bind(n)}})}]}]}},setup:function(e){this._parent.apply(this,arguments),e&&e.asAdmin&&(this._asAdmin=e.asAdmin)}})}),define("DS/SwymUIComponents/script/feature/community/media/view/interactive-action-menu-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/utils/navigation","DS/UIKIT/DropdownMenu","DS/UIKIT/Tooltip","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/view/interactive-media-thumbnail-view"],function(e,t,i,n,o,s,a,r){"use strict";return t.extend({name:"action-menu-view",_modelClass:n,_actionMenu:null,_isModelFetched:!1,setup:function(e){this._parent.call(this,e)},_createContent:function(){var t=e.createElement("span",{class:"fonticon fonticon-1-5x fonticon-open-down"}),i=t.getElement(".fonticon-open-down"),n=[];return i&&this.addControl("MenuTooltip",new a({target:i,body:r.Menu})),n.push({name:"goto",fonticon:"level-down",text:r.goToThisMedia,handler:function(){this._onGoToThisItem()}.bind(this)}),this._actionMenu=this.addControl("dropdownMenu",new s({target:t,position:"bottom left",items:n,className:"contextual-actions",events:{onShow:this._onActionsMenuShow.bind(this)}})),t},_onActionsMenuShow:function(){var e=this._isModelFetched,t=this.model,i=!1;if(e)this._buildActionsMenu();else{this._actionMenu;t.hasBeenFetched()&&(i=!0),t.fetch({fromCache:i,onComplete:function(){this._buildActionsMenu(),this._isModelFetched=!0}.bind(this)})}},_buildActionsMenu:function(){for(var e=this.model,t=this._actionMenu,i=!0===e.isConsideredAsA360MediaModel();t.items.length>0;)t.removeItem(0);i&&t.addItem({name:"play360",fonticon:"media-360",text:r.Play,handler:function(e){this.dispatchEvent("onPlay",[e])}.bind(this)}),t.addItem({name:"goto",fonticon:"level-down",text:r.goToThisMedia,handler:function(){this._onGoToThisItem()}.bind(this)}),"1"!=e.get("download_original_file")&&"document"!==e.get("media_type")||t.addItem({name:"download",fonticon:"download",text:r.Download,handler:function(){this._parentView.download()}.bind(this)})},_onGoToThisItem:function(){var e=this.model,t=e.get("mid"),i=e.getCommunity().get("mid"),n=e.getModelName();o.goToContent(t,n,i)}})}),define("DS/SwymUIComponents/script/lib/ckeditor/sticky/plugin",["UWA/Utils/Client"],e=>{const t=CKEDITOR.tools.cssLength;CKEDITOR.plugins.add("sticky",{init(i){e.Features.touchEvents||i.on("loaded",()=>{!function(e){const i=e.fire("uiSpace",{space:"top",html:""}).html,n=document.querySelector(`#sticky_${e.name}`),o=document.querySelector(`#placeholder_${e.name}`),s=document.querySelector(`#${e.name}`);i&&n&&o&&s&&(n.innerHTML=i,requestAnimationFrame(()=>{const{height:e}=n.getBoundingClientRect();o.style.setProperty("top",t(e)),s.style.setProperty("min-height",`calc(100% - ${t(e)})`)}))}(i)},null,null,19)}})}),define("DS/SwymUIComponents/script/feature/core/link/view/link-read-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/experience/view/experience-read-view","DS/SwymUICore/script/feature/core/link/model/link-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/UIKIT/Tooltip","DS/UIKIT/DropdownMenu"],function(e,t,i,n,o,s){"use strict";return n.extend({_modelEventsForAutoRefresh:["onChange:url","onChange:description","onChange:title","onChange:type"],_modelClass:i,domEvents:{"click .font-social":"_onLinkClicked"},_onLinkClicked:function(){window.open(this.model.get("url",{escapeHTML:!1}))},name:"link-read-view",_createContent:function(){var i=this.model.collection.getAssociated("user").isCurrentUser()?'<span class="fonticon fonticon-2x cursor-pointer fonticon-down-open"></span>':'<div style="margin-bottom: 10px;"></div>',n=this.getWebsite(this.model.get("type")),o=(n.icon&&n.icon,"");return o=!0===this.model.isSocialLink()?e.createElement("div",{class:"social-link",html:'<span class="fonticon cursor-pointer font-social fonticon-2x fonticon-'+this.model.getIconName()+'"></span>'+i}):e.createElement("div",{styles:{"margin-top":"20px"},html:[{html:'<span class="fonticon fonticon-link"></span><a class="user-link" target="_blank" href="'+this.model.get("url",{escapeHTML:!0})+'">'+this.model.get("title")+"</a>"+i},{class:"user-link-description",html:this.model.get("description",{breakline:!0})||""}]}),this.addControl("dropdown",new s({target:o.getElement(".fonticon-down-open"),items:[{text:t.Edit,fonticon:"pencil"},{text:t.Delete,fonticon:"trash"}],events:{onClick:function(e,t){"pencil"===t.fonticon?this.model.dispatchEvent("onPencilIconClicked"):"trash"===t.fonticon&&this.model.dispatchEvent("onTrashIconClicked")}.bind(this)}})),o},getWebsite:function(e){var t={};switch(e){case"0":t.name=this.model.get("title");break;case"1":t.name="Facebook",t.icon="fonticon-facebook";break;case"2":t.name="Linkedin",t.icon="fonticon-linkedin";break;case"3":t.name="Viadeo";break;case"4":t.name="Youtube";break;case"5":t.name="Certification";break;case"6":t.name="Flickr";break;case"7":t.name="Google",t.icon="fonticon-gplus";break;case"8":t.name="Twitter",t.icon="fonticon-twitter"}return t}})}),define("DS/SwymUIComponents/script/feature/core/network/view/invitation-layer-form-view",["i18n!DS/SwymUIComponents/assets/nls/feature/core/network/view/invitation-layer-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/UIKIT/Input/Text"],function(e,t,i,n,o){"use strict";return t.extend({_modelClass:i,name:"invitation-layer-form-view",_createContent:function(){var t=n.getInstance().get("user");return[{tag:"label",for:"invitationSent",html:e.descriptionField},{html:this.addControl("inputMessage",new o({multiline:!0,id:"invitationSent",rows:5,value:t.first_name+" "+t.last_name+" "+e.textByDefaultInvitation}))}]}})}),define("DS/SwymUIComponents/script/feature/community/content/view/properties-editor-view",["UWA/Core","UWA/String","i18n!DS/SwymUIComponents/assets/nls/feature/community/generic/view/properties-editor-view","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/context/context-model","DS/UIKIT/Form","DS/UIKIT/Input/Button","DS/UIKIT/Input/Toggle","DS/UIKIT/Tooltip"],function(e,t,i,n,o,s,a,r,l,c){"use strict";return o.extend({name:"properties-editor-view",_withoutCategory:!1,_videoThumbnailEditorIsIntanciated:!1,domEvents:{"click .capture-thumbnail-button":"_onCaptureThumbnailButtonClicked","click .cancel-thumbnail-edition":"_onCancelForThumbnailEdition"},_onCancelForThumbnailEdition:function(){this.model.removeChanges("thumbnail_time_ms"),this.getElement(".cancel-thumbnail-edition").hide()},_onCaptureThumbnailButtonClicked:function(){this.model.hasVirtuallyChanged("userFile")?this.alert("info",i.PleaseWaitForTheNewVideoToBeProcessed):this.dispatchEvent("getPlayerStateRequest")},instantiateVideoThumbnailEditor:function(){var e=this.getElement(".thumbnail-image-editor"),t=this.addChildView("thumbnailVideoEdit",{model:this.model,autoplay:!1,controls:!1,Class:"DS/SwymUIComponents/script/feature/community/media/view/video-thumbnail-editor-view"});e.setContent([t.render(),{class:"cancel-thumbnail-edition",html:i.Cancel}]),this._videoThumbnailEditorIsIntanciated=!0},manageThumbnailEdition:function(e){if(e)switch(e.state){case"readyForThumbnail":var t=1e3*e.offset;t=Math.round(t),this.model.addChanges("thumbnail_time_ms",t),this._videoThumbnailEditorIsIntanciated||this.instantiateVideoThumbnailEditor(),this.getElement(".cancel-thumbnail-edition").show();break;default:this.alert("info",i.PauseThePlayerBeforeChoosingANewThumbnail)}},setup:function(e){return e.withoutCategory&&(this._withoutCategory=!0),this.addEvent("playerStatusInfo",this.manageThumbnailEdition.bind(this)),this._parent.apply(this,arguments)},_createContent:function(){var n,o=this.model,a=[];return n=e.createElement("span",{styles:{"margin-left":"10px"},class:"fonticon fonticon-help-circled"}),this.addControl("helpIconTooltip",new c({target:n,body:t.format(i.get("IfSelectedTheMediaWillBeDisplayedOnTheWhatsNew"),"<b>","</b>")})),this.addControl("displayonwhatsnewCheckbox",new l({type:"checkbox",name:"displayonwhatsnew",className:"primary",label:i.get("DisplayOnWhatsNew"),checked:!(!0===o.get("is_illustration")||"1"===o.get("is_illustration")),disabled:"1"===(this.model.get("community")&&this.model.get("community")["this->getCurrentUserRights"]),events:{onChange:function(){o.addChanges("is_illustration",!1===this.isChecked())}}})).getContent().setStyle("display","inline-block"),this._withoutCategory,s.getInstance().isDirectMessageContext()||a.push({html:[this.getControl("displayonwhatsnewCheckbox"),n]}),"document"===o.get("media_type")||o.hasExtensionType("3dsto")||o.hasExtensionType("3dskt")||o.hasExtensionType("3dwb")||o.hasExtensionType("sldprt")||o.hasExtensionType("sldasm")||o.hasExtensionType("slddrw")||a.push(this.addControl("downloadCheckbox",new l({type:"checkbox",name:"download",className:"primary",label:i.Authorizedownloadoforiginalfile,checked:"1"===o.get("download_original_file"),events:{onChange:function(){o.addChanges("download_original_file",!0===this.isChecked()?"1":"0")}}}))),["media"===o.getModelName()?a.concat(["video"===o.get("media_type")?{class:"video-thumb",html:[this.addControl("captureThumbnailButton",new r({value:i.CaptureTheThumbnailFromThePlayer,disabled:!1,className:"default capture-thumbnail-button"})),{class:"thumbnail-image-editor",html:e.createElement("img",{src:this.model.get("preview").thumbnails[2].transient_url})}]}:""]):""]},resetPropertiesView:function(){this._videoThumbnailEditorIsIntanciated=!1,this.refresh()},onModeChange:function(e){for(var t in this._childViews)this._childViews.hasOwnProperty(t)&&this._childViews[t].dispatchEvent("onModeChange",[e])}})}),define("DS/SwymUIComponents/script/utils/progressive-disclosure-manager",["DS/SwymUICore/script/lib/pub-sub"],e=>{"use strict";let t=null;const i="conversation",n="community",o=e=>!e.isHidden(),s=e=>e.isFavorite()&&!e.isHidden(),a=e=>!e.isBlacklisted(),r=e=>e.isFavorite()&&!e.isBlacklisted(),l=e.extend({_displayStates:{conversation:{},community:{}},_checkDisclosureDM(e,t){let i=!1,n=!1,a=!0;const r=e.filter(o).length,l=e.filter(s).length;("filter"===t&&l>0||"unreadonly"===t&&l>0||l>0||r>0)&&(i=!0),r>0&&(n=!0),"filter"===t||"unreadonly"===t?a=!this._displayStates.shouldDisplaySuggestions:r>15&&(a=!1),this._triggerDisplayChangeEventsDM({shouldDisplayFavorites:i,shouldDisplayOthers:n,shouldDisplaySuggestions:a})},_checkDisclosureCty(e,t){let i=!1,n=!1;const o=e.filter(a).length,s=e.filter(r).length;("filter"===t&&s>0||"unreadonly"===t&&s>0||s>0||o>0)&&(i=!0),o>0&&(n=!0),this._triggerDisplayChangeEventsCty({shouldDisplayFavorites:i,shouldDisplayOthers:n})},checkDisclosure(e,t){const o=e.mode;switch(o){case i:this._checkDisclosureDM(e,t);break;case n:this._checkDisclosureCty(e,t);break;default:console.log(`Unsupported mode: ${o}`)}},_triggerDisplayChangeEventsDM({shouldDisplayFavorites:e,shouldDisplayOthers:t,shouldDisplaySuggestions:n}){const o=this._displayStates.conversation,s=[];o.shouldDisplayFavorites!==e&&(s.push("favoritesDisplayChange"),o.shouldDisplayFavorites=e),o.shouldDisplayOthers!==t&&(s.push("othersDisplayChange"),o.shouldDisplayOthers=t),o.shouldDisplaySuggestions!==n&&(s.push("suggestionsDisplayChange"),o.shouldDisplaySuggestions=n);for(let e of s)this.dispatchEvent(e,[i])},_triggerDisplayChangeEventsCty({shouldDisplayFavorites:e,shouldDisplayOthers:t}){const i=this._displayStates.community,o=[];i.shouldDisplayFavorites!==e&&(o.push("favoritesDisplayChange"),i.shouldDisplayFavorites=e),i.shouldDisplayOthers!==t&&(o.push("othersDisplayChange"),i.shouldDisplayOthers=t);for(let e of o)this.dispatchEvent(e,[n])},getCurrentDisplayState(e){const t=this._displayStates[e];return t?{...t}:{}}});return l.getInstance=(()=>(t||(t=new l),t)),l}),define("DS/SwymUIComponents/script/feature/community/survey/view/scale-answer-view",["DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/UIKIT/Input/Toggle"],function(e,t){return e.extend({_modelEventsForAutoRefresh:["onChange"],domEvents:{"change .scale-answer-radio":"onRadioChange","click .radio-label":"onRadioLabelClick"},_createContent:function(){for(var e=[],i=this.getOption("questionModel")?this.getOption("questionModel"):null,n=i?i.get("index_min"):this.getOption("indexMin"),o=i?i.get("index_max"):this.getOption("indexMax"),s=i?i.get("label_min"):this.getOption("minLabel").escapeHTML(),a=i?i.get("label_max"):this.getOption("maxLabel").escapeHTML(),r=n;r<o+1;r++)e.push({class:"radio-wrapper",html:[{class:"radio-label",html:r+""},this.addControl("answerToggle_"+r,new t({name:i?i.get("mid")+"_radio":null,disabled:!i,value:r,className:"scale-answer-radio primary",label:"",checked:!!i&&parseInt(i.getChanges("selected_index"),10)===r}))]});return{class:"toggles-wrapper",html:s||a?[{class:"min-max-label",html:""+s||""},e,{class:"min-max-label",html:""+a||""}]:e}},onRadioChange:function(e){this.getOption("questionModel").addChanges("selected_index",e.target.value)},onRadioLabelClick:function(e){this.getOption("questionModel").addChanges("selected_index",e.target.innerText),this.getControl("answerToggle_"+e.target.innerText).check()}})}),define("DS/SwymUIComponents/script/utils/vuex-modules/typing-indicator-module",["DS/RTStore/api/vuex-modules/rtchannel","DS/RTStore/api/vuex-modules/rtusers"],(e,t)=>{"use strict";return{namespaced:!0,modules:{channels:e,users:t},state:{activeThreadId:"",currentUser:""},mutations:{updateActiveThreadId(e,t){e.activeThreadId=t},setCurrentUser(e,t){e.currentUser=t}},actions:{addThread({dispatch:e,commit:t},{threadId:i}){t("updateActiveThreadId",i),e("channels/add",{channel_id:i})},addThreads({dispatch:e},{threadIds:t}){e("channels/addSeveral",{channel_id_array:t})},startTyping({state:e,dispatch:t}){t("channels/IAmTyping",{channel_id:e.activeThreadId,isTyping:!0})},stopTyping({state:e,dispatch:t}){t("channels/IAmTyping",{channel_id:e.activeThreadId,isTyping:!1})}},getters:{usersTyping:(e,t)=>i=>{const n="all"===i?e.activeThreadId:i,o=t["channels/typers"],s=t["users/username"];return o(n).filter(t=>t!==e.currentUser).map(e=>{return s(e)||e})},isChannelPresent:(e,t)=>i=>{const n="all"===i?e.activeThreadId:i;return t["channels/list"].indexOf(n)>=0}}}}),define("DS/SwymUIComponents/script/feature/core/user/view/location/user-location-edit-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/user/model/user-model","DS/UIKIT/Input/Text","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/location/user-location-edit-view","DS/UIKIT/Form","DS/UIKIT/Spinner","DS/WebappsUtils/Console"],function(e,t,i,n,o,s,a,r){"use strict";return t.extend({_modelClass:i,name:"user-location-edit-view",_createContent:function(){var t=new a({className:"msg-animation",visible:!0,animate:!0,spin:!0}),i=this.addControl("form-aboutme",t),n=this.model;return this.container.setStyle("text-align","center"),n.fetchCountries({onComplete:function(t){var i;i="label",t=t.sort(function(e,t){var n=e[i],o=t[i];return n<o?-1:n>o?1:0});var a=n.getPassportAttributeConstraints("company"),r=n.getPassportAttributeConstraints("address"),l=n.getPassportAttributeConstraints("zip"),c=n.getPassportAttributeConstraints("city"),d=n.getPassportAttributeConstraints("country_code"),m=this.addControl("form-aboutme",new s({fields:[e.merge({type:"text",label:o.Company,value:(n.get("company",{escapeHTML:!1})||"").unescapeHTML(),disabled:!n.isEditableByPassport("company"),events:{onChange:function(){n.addChanges("company",this.getValue())}}},a),e.merge({type:"text",label:o.Address,value:(n.get("address",{escapeHTML:!1})||"").unescapeHTML(),disabled:!n.isEditableByPassport("address"),events:{onChange:function(){n.addChanges("address",this.getValue())}}},r),e.merge({type:"text",label:o.ZipCode,disabled:!n.isEditableByPassport("zip"),value:(n.get("zip",{escapeHTML:!1})||"").unescapeHTML(),events:{onChange:function(){n.addChanges("zip",this.getValue())}}},l),e.merge({type:"text",label:o.City,disabled:!n.isEditableByPassport("city"),value:(n.get("city",{escapeHTML:!1})||"").unescapeHTML(),events:{onChange:function(){n.addChanges("city",this.getValue())}}},c),e.merge({type:"select",label:o.Country,disabled:!n.isEditableByPassport("country_code"),value:n.get("country_code",{escapeHTML:!1}),options:t,events:{onChange:function(){this.getSelection()[0]&&n.addChanges("countryForRead",this.getSelection()[0].text),n.addChanges("country_code",this.getSelection()[0].value)}}},d)]}));this.container.setStyle("text-align","inherit"),m.inject(this.container.empty());var u=t.filter(function(e){return e.value===n.get("country_code")});u[0]&&n.set("country",u[0].label)}.bind(this)}),i}})}),define("DS/SwymUIComponents/script/lib/ckeditor/ckeditor-config",["DS/CKEditor/CKEditor"],e=>{const t=e;return t.disableAutoInline=!0,require(["DS/SwymUIComponents/script/lib/ckeditor/customlink/plugin","DS/SwymUIComponents/script/lib/ckeditor/customtable/plugin","DS/SwymUIComponents/script/lib/ckeditor/autohyperlink/plugin","DS/SwymUIComponents/script/lib/ckeditor/customtable/dialogs/customtable","DS/SwymUIComponents/script/lib/ckeditor/customlink/dialogs/customlink","DS/SwymUIComponents/script/lib/ckeditor/highlight/plugin","DS/SwymUIComponents/script/lib/ckeditor/sticky/plugin","DS/SwymUIComponents/script/lib/ckeditor/usageTracker/plugin","DS/SwymUIComponents/script/lib/ckeditor/autoDetectInlineTagOnPaste/plugin"],()=>{t.plugins.addExternal("customlink","../../SwymUIComponents/script/lib/ckeditor/customlink/","plugin.js"),t.plugins.addExternal("customtable","../../SwymUIComponents/script/lib/ckeditor/customtable/","plugin.js"),t.plugins.addExternal("autohyperlink","../../SwymUIComponents/script/lib/ckeditor/autohyperlink/","plugin.js"),t.plugins.addExternal("highlight","../../SwymUIComponents/script/lib/ckeditor/highlight/","plugin.js"),t.plugins.addExternal("sticky","../../SwymUIComponents/script/lib/ckeditor/sticky/","plugin.js"),t.plugins.addExternal("usageTracker","../../SwymUIComponents/script/lib/ckeditor/usageTracker/","plugin.js"),t.plugins.addExternal("autoDetectInlineTagOnPaste","../../SwymUIComponents/script/lib/ckeditor/autoDetectInlineTagOnPaste/","plugin.js")}),t}),define("DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/oembed-providers-list",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProvidersList=void 0,t.ProvidersList=[{provider_name:"YouTube",provider_url:"https://www.youtube.com/",endpoints:[{url:"https://www.youtube.com/oembed",discovery:!0}]},{provider_name:"SoundCloud",provider_url:"http://soundcloud.com/",endpoints:[{schemes:["http://soundcloud.com/*"],url:"https://soundcloud.com/oembed"}]},{provider_name:"Ted",provider_url:"https://www.ted.com",endpoints:[{schemes:["http://ted.com/talks/*"],url:"http://www.ted.com/talks/oembed.json"}]},{provider_name:"The New York Times",provider_url:"https://www.nytimes.com",endpoints:[{schemes:["https://www.nytimes.com/svc/oembed","https://nytimes.com/*","https://*.nytimes.com/*"],url:"https://www.nytimes.com/svc/oembed/json/",discovery:!0}]},{provider_name:"Twitch",provider_url:"https://www.twitch.tv",endpoints:[{schemes:["http://clips.twitch.tv/*","https://clips.twitch.tv/*","http://www.twitch.tv/*","https://www.twitch.tv/*","http://twitch.tv/*","https://twitch.tv/*"],url:"https://api.twitch.tv/v4/oembed",formats:["json"]}]},{provider_name:"VEVO",provider_url:"http://www.vevo.com/",endpoints:[{schemes:["http://www.vevo.com/*","https://www.vevo.com/*"],url:"https://www.vevo.com/oembed",discovery:!1}]},{provider_name:"Vimeo",provider_url:"https://vimeo.com/",endpoints:[{schemes:["https://vimeo.com/*","https://vimeo.com/album/*/video/*","https://vimeo.com/channels/*/*","https://vimeo.com/groups/*/videos/*","https://vimeo.com/ondemand/*/*","https://player.vimeo.com/video/*"],url:"https://vimeo.com/api/oembed.{format}",discovery:!0}]}]}),define("DS/SwymUIComponents/script/feature/core/experience/view/experience-read-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/experience/view/experience-read-view","DS/SwymUICore/script/feature/core/experience/model/experience-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/utils/date","DS/UIKIT/DropdownMenu"],function(e,t,i,n,o,s){"use strict";return n.extend({_modelEventsForAutoRefresh:["onChange:place","onChange:date_begin","onChange:date_end","onChange:industry","onChange:not_finished","onChange:description","onChange:title","onChange:work_name"],_modelClass:i,name:"experience-read-view",_createContent:function(){var i=this.model.collection.getAssociated("user").isCurrentUser(),n=this.model.get("place")?" - ":"",a=this.model.get("industry")?" ("+this.model.get("industry")+")":"",r=i?'<span class="fonticon fonticon-2x cursor-pointer fonticon-down-open"></span>':"",l="1"==this.model.get("not_finished")?'<span class="profile-date-experience">'+t.since+" "+o.textDate(this.model.get("date_begin"))+"</span>":'<span  class="profile-date-experience">'+o.textDate(this.model.get("date_begin"))+" - "+o.textDate(this.model.get("date_end"))+"</span>",c=e.createElement("div",{html:'<span class="profile-title-experience">'+this.model.get("title")+"</span>"+r+'<br><span class="profile-location-experience">'+this.model.get("work_name")+a+n+(this.model.get("place")||"")+"</span>"+l+'<span class="profile-description-experience">'+(this.model.get("description",{breakline:!0})||"")+"</span>"});return this.addControl("dropdown",new s({target:c.getElement(".fonticon-down-open"),items:[{text:t.Edit,fonticon:"pencil"},{text:t.Delete,fonticon:"trash"}],events:{onClick:function(e,t){"pencil"===t.fonticon?this.model.dispatchEvent("onPencilIconClicked"):"trash"===t.fonticon&&this.model.dispatchEvent("onTrashIconClicked")}.bind(this)}})),c}})}),define("DS/SwymUIComponents/script/feature/core/user/view/phone/user-phone-read-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/user/model/user-model","DS/WebappsUtils/Console"],function(e,t,i,n){"use strict";return t.extend({_modelEventsForAutoRefresh:["onChange"],_modelClass:i,name:"user-phone-read-view",_createContent:function(){return e.createElement("div",{html:this.model.get("tel")})}})}),define("DS/SwymUIComponents/script/feature/community/social-event/view/badge-in-title-mixin",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/social-event/social-event-view","DS/SwymUICore/script/feature/core/context/context-constants"],function(e,t,i){"use strict";function n(e){const t=new Date(e.getFullYear(),0,1),i=Math.floor((e-t)/864e5);return Math.ceil(i/7)}return{_renderLabel:function(){const e=this.model&&this.model.get("start_date");if(e){const o=new Date(e);let s="",a="",r=new Date,l=n(r),c=n(new Date(o)),d=o.getFullYear(),m=c-l,u=Math.abs(d-r.getFullYear()),h=this.model.getModelName()===i.SOCIAL_EVENT&&this.model.isSocialEventNow();return u>0?(a="future-weeks",s=1===m?t.NextWeek:t.FutureWeeks):m>0?(a="future-weeks",s=1===m?t.NextWeek:t.FutureWeeks):m<0?(s=t.PastWeeks,a="past-weeks"):h?(s=t.Now,a="now"):Date.now()>o.getTime()?(s=t.ThisWeek,a="past-weeks"):(s=t.ThisWeek,a="current-week"),{tag:"strong",class:"idea-status-label rdv-badge "+a,text:s}}return{}}}}),define("DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/abstract-rich-link-preview-model",["UWA/Core","UWA/Class/Model"],function(e,t){"use strict";return t.extend({defaults:{type:"",title:"",description:"",image:"",url:"",prefs:""}})}),define("DS/SwymUIComponents/script/feature/community/media/view/3dskt-viewer",["DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/lib/event-manager","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/utils/usage-tracker","DS/SwymUICore/script/feature/core/context/context-constants","UWA/Data"],function(e,t,i,n,o,s,a,r,l,c){"use strict";var d=window.ds&&"MOBILE"===window.ds.env;return e.extend({_modelEventsForAutoRefresh:["onSync:read","onSync:update"],_sketchObj:null,_whiteboardEnabled:null,_communitySelected:null,_isCoreviewActivated:null,name:"3dskt-viewer",className:"x3dskt-wrapper",onHide:function(){this._clean()},destroy:function(){this._clean(),this._parent.apply(this,arguments)},_clean:function(){!this.isDestroyed()&&this._sketchObj&&(this._sketchObj.destroy(),this._sketchObj=null)},onShow:function(){this._launchSketch(this._getSketchParams())},_getParamsForEdit:function(){var e=this.model,t={model:e,onActivateFullscreen:function(){this.container.addClassName("media-viewer-fullscreen")}.bind(this),onDeactivateFullscreen:function(){this.container.removeClassName("media-viewer-fullscreen")}.bind(this),threadType:e.getThreadType(),threadId:e.getThreadId(),wakeUpUrl:e.get("play").wake_up_url,edit:i.getInstance().isContentEditionContext()},o=null;return"picture"===e.get("media_type")?(o=e.get("play->2d_streams")[0].transient_url,d&&(o=c.proxifyUrl(o,{proxy:"passport"})),t.imageUrl=o):(o=e.get3DFileURL(),d&&(o=c.proxifyUrl(o,{proxy:"passport"})),t.modelUrl=o),this._isCoreviewActivated&&(t.coreview=i.getInstance().getCoreviewData()),t.fileUrl=t.imageUrl||t.modelUrl,t.onContentPublishedInSwym=function(t){"whiteboardcreation"===i.getInstance().path?r.trackPageEvent({category:"ContentCreation",label:"publishWhiteboard",view:"3dskt-viewer",event:"click"}):r.trackPageEvent({category:"ContentCreation",label:"publishSketch",view:"3dskt-viewer",event:"click"}),new Promise(function(e){new n({mid:t},{autoPopulate:!0,onPopulate:function(t){let i=t.getCommunity(),n=i.get("mid")||i.id,o="0"===t.get("published");e([n,o])}})}).then(function([i,n]){if(n){const t=a.COMMUNITY_MY_CONTRIBUTIONS,n=!1,o=e.getCommunity&&e.getCommunity()&&e.getCommunity().isDirectMessage();a.goToCommunity(i,t,n,o)}else a.goToContent(t,"media",e.getThreadId(),null,null,null,e.getCommunity&&e.getCommunity()&&e.getCommunity().isDirectMessage())})},t},_getParamsForCreation:function(){var e=null,t=null,l=null;if(e=new n,this._communitySelected)(t=new o({mid:this._communitySelected})).set("community_type","community");else if((l=i.getInstance().getData()).previousAttributes.communityId&&!l.previousAttributes.dmId)t=new o({mid:l.previousAttributes.communityId});else{if(!l.previousAttributes.dmId)return{onContentPublishedInSwym:function(t,o){const s=i.getInstance().path,l=a.COMMUNITY_MY_CONTRIBUTIONS,c=e.getCommunity&&e.getCommunity()&&e.getCommunity().isDirectMessage();e=new n({mid:t}),"whiteboardcreation"===s?r.trackPageEvent({category:"ContentCreation",label:"publishWhiteboard",view:"3dskt-viewer",event:"click"}):r.trackPageEvent({category:"ContentCreation",label:"publishSketch",view:"3dskt-viewer",event:"click"}),new Promise(function(e){new n({mid:t},{autoPopulate:!0,onPopulate:function(t){let i=t.getCommunity(),n=i.get("mid")||i.id,o="0"===t.get("published");e([n,o])}})}).then(function([e,i]){i?a.goToCommunity(e,l,!1,c):a.goToContent(t,"media",o)})}};t=new s({mid:l.previousAttributes.dmId})}return e.setAssociated("community",t),e.set("play",{}),{model:e,threadType:e.getThreadType(),threadId:e.getThreadId(),onContentPublishedInSwym:function(t){"whiteboardcreation"===i.getInstance().path?r.trackPageEvent({category:"ContentCreation",label:"publishWhiteboard",view:"3dskt-viewer",event:"click"}):r.trackPageEvent({category:"ContentCreation",label:"publishSketch",view:"3dskt-viewer",event:"click"}),e=new n({mid:t}),new Promise(function(e){new n({mid:t},{autoPopulate:!0,onPopulate:function(t){let i=t.getCommunity(),n=i.get("mid")||i.id,o="0"===t.get("published");e([n,o])}})}).then(function([i,n]){if(n){const t=a.COMMUNITY_MY_CONTRIBUTIONS,n=!1,o=e.getCommunity&&e.getCommunity()&&e.getCommunity().isDirectMessage();a.goToCommunity(i,t,n,o)}else a.goToContent(t,"media",e.getThreadId(),null,null,null,e.getCommunity&&e.getCommunity()&&e.getCommunity().isDirectMessage())})}}},_getSketchParams:function(){var e=null,t=this,o=i.getInstance().getData().path,s=o&&o.split("sketchcreation:")||[],a=s.length>1?s[1]:null,r=a||i.getInstance().isContentEditionContext()?this.model:null;return r&&r.get("mid")===a||i.getInstance().isContentEditionContext()?e=this._getParamsForEdit():s.length>1?(a=s[1],this.model=new n({mid:a}),this.model.fetch({onComplete:function(){t._launchSketch(t._getSketchParams())}})):e=this._getParamsForCreation(),(this._whiteboardEnabled||this.model&&"3dwb"===this.model.getFileExtension())&&(e.whiteboard=!0),e&&(e.onShowMediaLib=function(e,t,i,n){require(["DS/SwymUIComponents/script/feature/community/media/library/media-library-view"],function(o){var s=new o({communityId:e,threadType:t||"community"});s.injectInDom(),this.listenTo(s,{newMediaAdded:function(e){const t=e.existingMedia.filter(e=>"3DDrive"!==e.get("serviceId")).map(e=>e.get("subject6wuri")),n=e.newMedia.map(e=>e.getChanges()),o=e.existingMedia.filter(e=>"3DDrive"===e.get("serviceId")).map(e=>({envId:e.get("envId"),objectId:e.get("objectId")}));s.destroy(),i(t,n,o)},onDestroy:function(){n&&n()}})}.bind(this))}.bind(this)),e},getBlob:function(e,t){this._sketchObj.startPublish(e,t)},_launchSketch:function(e){var t=this;e&&require(["DS/CAT3DSKBootstrap/CAT3DSketchBootstrap"],function(i){t._sketchObj=new i,t._sketchObj.create(t.container,e)})},setup:function(e){var n=this;e.whiteboard&&(this._whiteboardEnabled=!0),t.addEvent("onCommunitySelected",function(e){n._communitySelected=e.split(":")[4]}),this._isCoreviewActivated=null!==i.getInstance().getCoreviewData(),this._parent.apply(this,arguments),this._launchSketch(this._getSketchParams())}})}),define("DS/SwymUIComponents/script/feature/core/ui-components/layout/back-to-top-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-view","DS/UIKIT/Tooltip","i18n!DS/SwymUIComponents/assets/nls/feature/community/generic/view/item-list"],function(e,t,i,n){"use strict";return t.extend({name:"back-to-top-view",domEvents:{click:"_goToTop"},defaultOptions:{manager:"DS/SwymUIComponents/script/feature/core/ui-components/layout/layout-manager"},_createContent:function(){var t=e.createElement("div",{class:"to-top",html:{class:"fonticon fonticon-2x fonticon-move-to-top"}});return this.getOption("manager")&&this.addControl("tooltip-go-back-to-top",new i({target:t,body:this.getOption("manager").isScrollReversed?n.GoBackToBottom:n.GoBackToTop})),t},_goToTop:function(){var e=this.getOption("manager");e instanceof t?(e.dispatchEvent("onScrollToTopRequest",[250]),this.hide()):require([e],function(e){e.dispatchEvent("onScrollToTopRequest",[250]),this.hide()}.bind(this))},onRender:function(){this.hide()}})}),define("DS/SwymUIComponents/script/lib/ckeditor/customtable/plugin",["i18n!DS/SwymUIComponents/assets/nls/lib/ckeditor/customtable/customtable"],function(e){CKEDITOR.plugins.add("customtable",{init(t){t.addCommand("customtable",new CKEDITOR.dialogCommand("customtableDialog")),t.ui.addButton("AddCustomTable",{label:e.TableProperties,command:"customtable",toolbar:"paragraph",className:"table"}),t.contextMenu&&(t.addMenuGroup("abbrGroup"),t.addMenuItem("abbrItem",{label:e.TableProperties,icon:"table",command:"customtable",group:"abbrGroup"}),t.contextMenu.addListener(function(e){if(e.getAscendant("table",!0))return{abbrItem:CKEDITOR.TRISTATE_OFF}})),CKEDITOR.dialog.add("customtableDialog",`${this.path}dialogs/customtable.js`),t.element.$.addEvent("touchforcechange",function(e){1===e.changedTouches[0].force&&t.contextMenu.open(new CKEDITOR.dom.element(e.target))})}})}),define("DS/SwymUIComponents/script/feature/community/social-event/view/pres-support-viewer",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/UIKIT/Tooltip","DS/i3DXCompassPlatformServices/OpenWith","DS/UIKIT/DropdownMenu","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/utils/utils"],function(e,t,i,n,o,s,a,r){const l={post:"post",picture:"media",document:"media",video:"media",idea:"ideation",wikitreepage:"wiki",survey:"survey",question:"iquestion",wedo:"wedo",conference:"social-event"};return t.extend({_modelEvents:{onChange:"refresh"},domEvents:{"click .input-button-right-part":"delete","change .pres-url-input":"_onUrlChange",click:"navigate"},name:"presentation-support-viewer",setup:function(e){this._widget=e.widget,this._widgetId=this._widget&&this._widget.id,this._parent(e)},delete:function(){this.model.destroy()},navigate:function(){if("url"===this.model.get("type")){const e=this.model.get("id");window.open(e.startsWith("http")?e:"//"+e,"_blank")}},_onUrlChange:function(e){const t=e.target.value;this.model.addChanges("id",t)},_getMappingType:function(e){return l[e.toLowerCase()]},_createContent:function(){const t=this.model.get("type"),l=this;if("url"===t){const t=this.model.get("id"),n=e.createElement("span",{class:"pres-support-url",html:t});return new i({target:n,body:t}),[{tag:"span",class:"fonticon fonticon-link"},n,{tag:"span",class:"fonticon fonticon-window"}]}{const t=this.model.get("label"),c=e.createElement("span",{class:"fonticon fonticon-chevron-down"}),d=this.model.get("source"),m=e.createElement("span",{tag:"span",class:"pres-support-label",html:t});let u;if(new i({target:m,body:t}),"3DSwym"===d)u=new o({target:c,items:[{text:"Open",fonticon:"play",handler:function(){const e=a.getInstance(),t=l.model.get("id"),i=l.model.get("type").split(":")[1],n=e.communityId;path=e.getRoute({contentId:t,contentType:l._getMappingType(i),communityId:n,editionMode:!1}),window.open(`${r.getBaseUrl()}/#${path}`,"_blank")}}]});else{const e=s.getInstance().get("config").tenant.id;c.addEventListener("click",()=>{let t={protocol:"3DXContent",version:"1.1",source:"ENORIPE_AP",widgetId:l._widgetId,data:{items:[{objectType:l.model.get("type"),objectId:l.model.get("id"),envId:e}]}};u=new o({target:c,items:[],events:{onHide:function(e,t){this.destroy()}}}),(new n).set3DXContent(t).render(u),setTimeout(function(){u.show()}.bind(this),50)})}return[e.createElement("img",{class:"type-icon",src:this.model.get("preview_url").unescapeHTML()}),m,c]}},destroy:function(){return this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/survey/view/survey-stats-view",["DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/utils/date"],function(e,t){return e.extend({_modelEventsForAutoRefresh:["onChange"],_createContent:function(){var e=this.model;if(e)return[{tag:"td",html:e.get("title")},{tag:"td",html:e.get("nb_voters")},{tag:"td",html:t.simpleDate(e.get("start_date"),"en")},{tag:"td",html:t.simpleDate(e.get("end_date"),"en")}]}})}),define("DS/SwymUIComponents/script/feature/core/tenant/view/users-management-processes-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/tenant/view/users-management-processes-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/UIKIT/Input/Button","DS/UWPClientCode/I18n"],function(e,t,i,n,o){return i.extend({_modelEventsForAutoRefresh:["onChange"],asAdmin:!1,_createContent:function(){var e=this.model;if(e){var i="",s=Number(this.batchIds.ADD_TO_COMMUNITIES),a=Number(this.batchIds.REMOVE_FROM_COMMUNITIES),r=Number(this.batchIds.CREATE_NEW_USERS),l=Number(this.batchIds.CHANGE_USER_STATUS);switch(Number(e.get("process"))){case s:i=t.adduserstocommunity;break;case r:i=t.importnewusers;break;case a:i=t.removeusersfromcommunity;break;case l:i=t.changeuserstatus;break;default:i=""}var c="";switch(Number(e.get("type"))){case 1:c="<b>"+t.waiting+"</b>";break;case 2:c="<b>"+t.running+"</b>";break;case 3:c="<b>"+t.completed+"</b>";break;default:c="--"}var d="";return 3==Number(e.get("type"))?e.get("details")&&(d=o.replace(t.nofnsuccessful,{num1:e.get("details")[0],num2:e.get("details")[1]})):1==Number(e.get("type"))&&e.get("rank")&&(d=o.replace(t.positioninqueue,{num:e.get("rank")})),[{tag:"td",html:e.get("processName")},{tag:"td",html:i},{tag:"td",html:c},{tag:"td",html:d},{tag:"td",html:3==Number(e.get("type"))?new n({value:t.Delete,className:"link",events:{onClick:function(){var e=0,t=Number(this.batchIds.ADD_TO_COMMUNITIES),i=Number(this.batchIds.REMOVE_FROM_COMMUNITIES),n=Number(this.batchIds.CREATE_NEW_USERS),o=Number(this.batchIds.CHANGE_USER_STATUS);switch(Number(this.model.get("process"))){case t:e=1;break;case n:e=2;break;case i:e=1;break;case o:e=2;break;default:e=0}this.model.deleteProcess({data:{asAdmin:this.asAdmin,processType:e},onComplete:function(){this.model.dispatchEvent("onProcessDeleted")}.bind(this),onFailure:function(){alert("failure delete")}})}.bind(this)}}):""}]}}})}),define("DS/SwymUIComponents/script/feature/core/user/view/summary/user-summary-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/summary/user-summary-view","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/core/ui-components/edit-view-mode-switcher/edit-view-mode-switcher","DS/SwymUIComponents/script/feature/core/user/view/summary/user-summary-read-view","DS/SwymUIComponents/script/feature/core/user/view/summary/user-summary-edit-view","DS/WebappsUtils/Console"],function(e,t,i,n,o,s,a,r){"use strict";return n.extend({_modelClass:i,name:"summary-view",_createContent:function(){var i=new s({model:this.model,widget:this._widget}),n=new a({model:this.model,widget:this._widget});return e.createElement("div",{html:this.addChildView("edition-switch",{Class:o,model:this.model,editView:n,readView:i,actionOnSave:function(e){return!!e||(void 0===this.model.getChanges("user_infos")?(this.alert("info",t.noChangeDetected),!1):void this.model.saveuserinfos({data:{user_infos:this.model.getChanges("user_infos")},onComplete:function(e){this.alert("success",t.alertMessage);var i=e.getChanges("user_infos");void 0!==i&&e.set("tenant_more_about_me",i);var n=this.getChildView("edition-switch");n&&n.setMode("read")}.bind(this)}))}.bind(this)})})}})}),define("DS/SwymUIComponents/script/feature/core/user/view/macro/user-settings-view",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUIComponents/script/feature/core/user/view/user-visibility-view","DS/SwymUIComponents/script/feature/core/user/view/user-privacy-policies-view","DS/SwymUICore/script/utils/utils","DS/SwymUIComponents/script/feature/core/user/view/user-3dpassport-buttons-view"],function(e,t,i,n,o,s,a,r){"use strict";return i.extend({_modelClass:n,name:"user-settings-view",_createContent:function(){var t=this.model;return e.createElement("div",{class:"row",styles:{padding:"10px"},html:[{class:"col-md-6",styles:{padding:"20px","border-right":"none"},html:this.addChildView("visibilitySettings",{Class:o,model:t})},{styles:{padding:"20px"},class:"col-md-6",html:[this.addChildView("passport-buttons",{Class:r,model:t})]},{styles:{padding:"20px"},class:"col-md-6",html:[a.isCloud()&&t.dppConsent?this.addChildView("privacy-policies",{Class:s,model:t}):{}]}]})}})}),define("DS/SwymUIComponents/script/feature/core/user/view/interest/user-interest-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/interest/user-interest-view","DS/SwymUICore/script/feature/core/interest/model/interest-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/core/ui-components/edit-view-mode-switcher/edit-view-mode-switcher","DS/SwymUIComponents/script/feature/core/user/view/interest/user-interest-read-view","DS/SwymUIComponents/script/feature/core/user/view/interest/user-interest-edit-view","DS/SwymUIComponents/script/feature/core/modal/super-modal","DS/WebappsUtils/Console"],function(e,t,i,n,o,s,a,r,l){"use strict";return n.extend({_modelClass:i,name:"user-interest-view",_createContent:function(){var e=new s({model:this.model,widget:this._widget}),i=new a({model:this.model,widget:this._widget});return this.addChildView("edition-switch",{Class:o,doNotReactToEditAllEvent:!0,model:this.model,editView:i,readView:e,actionOnSave:function(e){var i=this.getChildView("edition-switch").getChildView("editview").getControl("form-aboutme").validate(),n=this.model.isNew();return!0===e?i:i?void this.model.save({},{onComplete:function(e,i){var o=n?t.interestCreated:"";this.alert("success",o),e.set(e.getChanges());var s=this.getChildView("edition-switch");s&&s.setMode("read")}.bind(this),onFailure:function(e,i){"IllegalArgumentException"===i.errorcode&&(this.alert("error",t.interestDuplicate),this.destroy())}.bind(this)}):(this.alert("error",t.pleaseFillTheFieldsCorrectly),i)}.bind(this),actionOnDestroy:function(){new r({closable:!0,renderTo:this._widget.body}).confirm(t.deletewarning,t.deletequestion,function(e){if(!0===e)if(!1===this.model.isNew())this.model.destroy({onComplete:function(){this.alert("success",t.InterestDeletedSucess)}.bind(this),onFailure:function(){this.alert("error",t.YourchangescouldnotbesavedPleasetryagainlater)}.bind(this)});else{var i=this.getChildView("edition-switch");i&&i.onCancelClick()}}.bind(this))}.bind(this)})}})}),require.config({paths:{"webex-space-widget":"https://code.s4d.io/widget-space/production/bundle","webex-space-widget-css":"https://code.s4d.io/widget-space/production/main"}}),define("DS/SwymUIComponents/script/feature/community/social-event/view/webex-space-widgets-modal",["DS/UIKIT/Modal","DS/SwymUIComponents/script/feature/community/social-event/webex-space-widget-iframe","webex-space-widget","css!webex-space-widget-css"],function(e,t,i){"use strict";return e.extend({init:function(e){this._parent(e),this.addEvent("onPostInject",this.onRender),this.setHeader("<h4>Webex Meeting</h4>"),this._buildBody()},onRender:function(){var e=document.getElementById("webex-space-widget");e&&window.webex&&window.webex.widget(e).spaceWidget({accessToken:window.webexAccessToken||"MGY3ZWY2M2EtNTg2ZS00YzRlLTk1NGQtNTVmMzZmY2JkNjA3YmJkZWM3MzMtN2Ri_PE93_cb22bf91-b84e-4c50-ab49-cd704940b921",destinationId:"1639675600@meet22.webex.com",destinationType:"sip",spaceActivities:{files:!1,meet:!0,message:!1,people:!1},initialActivity:"meet",secondaryActivitiesFullWidth:!0,composerActions:{files:!1,meet:!0,message:!1,people:!1}})},_buildBody:function(){this.setBody([{tag:"div",styles:{width:"100%",height:"500px"},id:"webex-space-widget"}])}})}),define("DS/SwymUIComponents/script/feature/core/user/view/phone/user-phone-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/phone/user-phone-view","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/core/ui-components/edit-view-mode-switcher/edit-view-mode-switcher","DS/SwymUIComponents/script/feature/core/user/view/phone/user-phone-read-view","DS/SwymUIComponents/script/feature/core/user/view/phone/user-phone-edit-view","DS/WebappsUtils/Console"],function(e,t,i,n,o,s,a,r){"use strict";return n.extend({_modelClass:i,name:"mail-view",_createContent:function(){var i=new s({model:this.model,widget:this._widget}),n=new a({model:this.model,widget:this._widget});return e.createElement("div",{html:this.addChildView("edition-switch",{Class:o,model:this.model,editView:n,readView:i,actionOnSave:function(e,i){var n=this.getChildView("edition-switch").getChildView("editview").getControl("form-aboutme").validate();return!0===e?n:n?void 0===this.model.getChanges("tel")?(i||this.alert("info",t.noChangeDetected),!1):void this.model.updatePassportFields({data:{telephone:this.model.getChanges("tel")},onComplete:function(e,i){this.alert("success",t.alertMessage);var n=this.model.getChanges("tel");void 0!==n&&this.model.set("tel",n);var o=this.getChildView("edition-switch");o&&o.setMode("read"),this.model.removeChanges("tel")}.bind(this)}):(this.alert("error",t.pleaseFillTheFieldsCorrectly),n)}.bind(this)})})}})}),define("DS/SwymUIComponents/script/feature/direct-message/view/suggested-item-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","DS/SwymUIComponents/script/feature/core/user/view/user-picture-view","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/lib/model/model-manager","DS/SwymUICore/script/utils/usage-tracker","DS/Logger/Logger","i18n!DS/SwymUIComponents/assets/nls/feature/direct-message/direct-messages","DS/UIKIT/Tooltip"],function(e,t,i,n,o,s,a,r,l,c,d,m,u){"use strict";return t.extend({name:"suggested-view",modes:["conversation"],domEvents:{click:"_onActionIconClick","click .suggested-action-icon":"_onActionIconClick"},defaultOptions:{mode:"conversation"},modeIconMap:{conversation:"topbar-chat-add"},modeNLSMap:{conversation:m},_modelClass:n,setup(e){return this._boostrapInstance=i.getInstance(),this._context=a.getInstance(),this._parent.call(this,e)},_getFonticon(){const e=this.getOption("mode"),t=this.modeIconMap[e];return t?`fonticon fonticon-${t}`:""},_getNLS(e){const t=this.getOption("mode"),i=this.modeNLSMap[t];return i?i[e]:""},_getUserPicture(){const e=this.model;return e?new s({displayPresence:!1,model:e,imageRenderingOptions:{dataIsLink:!1}}):this.createDummyView()},_getIconView(){return this.addChildView("icon-view",this._getUserPicture())},_createContent(){const t=this.model.getNickname();return this.elements.addConversationIcon=e.createElement("span",{class:this._getFonticon()}),this.addControl("suggestedIconTt",new u({target:this.elements.addConversationIcon,body:this._getNLS("StartAConversationFromSuggestions")})),[{class:"icon-section",html:this._getIconView()},{class:"other-info",html:[{class:"first-line",html:[{class:"title",html:`<span class="title-span">${t}</span>`},{class:"suggested-action-icon",html:this.elements.addConversationIcon}]}]}]},_onActionIconClick(){"conversation"===this.getOption("mode")&&this._createNewConversation()},_createNewConversation(){const e=new o,t=this._boostrapInstance.get("user").login,i=this.model.get("login");if(!i)throw new Error("Cannot find login for a user",this.model);e.addChanges({users:[t,i]}),e.save({},{onComplete(e){r.goToDM(e.get("mid")),e=new o(e.toJSON()),l.notify("onCreate",e)},onFailure(e,t){if(!(t&&t.result&&t.result.id))throw new Error("Error in DM creation",this.model);{r.goToDM(t.result.id);const e=new o(t.result);e.set("is_hidden",!1),l.notify("onCreate",e)}}})}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/paragraph-formatter-popover",["DS/UIKIT/Popover","DS/SwymUIComponents/script/feature/community/content/edit/paragraph-formatter"],function(e,t){"use strict";return e.extend({defaultOptions:{className:"flex-display paragraph-formatter",position:"bottom",delay:{show:100,hide:300},extraEditor:null},init:function(e,i){var n=this;e.body=this.innerView=new t({extraEditor:e.extraEditor,mode:"popover",events:{onApplyStyle:function(){n.dispatchEvent("onApplyStyle")}}}),this._parent.apply(this,arguments)},show:function(){var e=this;if(this.elements)return this.isVisible||(this.isVisible=!0,this.inject(this.options.target),this.elements.container.addClassName("in"),this.options.animate?setTimeout(function(){e.elements&&e.isVisible&&e.dispatchEvent("onShow")},150):this.dispatchEvent("onShow")),this},destroy:function(){!1===this._destroyed&&(this._destroyed=!0,this.innerView.destroy(),this.innerView=null,this._parent.apply(this,arguments))}})}),define("DS/SwymUIComponents/script/feature/community/members/view/small-members-list-view",["UWA/Core","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUICore/script/feature/core/sprite/sprite","DS/SwymUIComponents/script/feature/core/user/view/user-picture-view","DS/SwymUICore/script/feature/core/context/context-model"],function(e,t,i,n,o,s){"use strict";var a=o.extend({_createContent:function(){var t=this.model;return n.renderUserPicture(e.merge({login:t.get("login"),hash_key:t.get("hash_key"),imageUpdateTime:t.get("picture_update"),imageFingerprint:t.get("user_picture_fingerprint"),dataIsLink:!0},this._imageRenderingOptions||{}))}});return i.extend({name:"small-members-list",modelViewClass:a,setup:function(){var e=this;e._parent.apply(e,arguments),require(["DS/SwymUICore/script/lib/event-manager"],function(i){e.listenTo(i,"onCommunityMembersUpdate",function(i){var n=s.getInstance(),o=i.filter(function(e){if(e instanceof t)return e});e.collection.reset(n.isDirectMessageContext()?o:o.slice(0,8))})})}})}),define("DS/SwymUIComponents/script/feature/core/experience/view/experience-view",["i18n!DS/SwymUIComponents/assets/nls/feature/core/experience/view/experience-view","DS/SwymUICore/script/feature/core/experience/model/experience-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/core/ui-components/edit-view-mode-switcher/edit-view-mode-switcher","DS/SwymUIComponents/script/feature/core/experience/view/experience-read-view","DS/SwymUIComponents/script/feature/core/experience/view/experience-edit-view","DS/SwymUIComponents/script/feature/core/modal/super-modal"],function(e,t,i,n,o,s,a){"use strict";return i.extend({_modelClass:t,name:"experience-view",_createContent:function(){var t=new o({model:this.model,widget:this._widget}),i=new s({model:this.model,widget:this._widget});return this.addChildView("edition-switch",{Class:n,model:this.model,editView:i,readView:t,actionOnSave:function(t){var i=this.getChildView("edition-switch").getChildView("editview").getControl("form-aboutme").validate(),n=this.model.isNew();return!0===t?i:i?this.model.save({},{onComplete:function(t,i){var o=n?e.experiencecreated:e.experienceUpdated;this.alert("success",o),t.set(t.getChanges());var s=this.getChildView("edition-switch");s&&s.setMode("read")}.bind(this),onFailure:function(e,t){}}):(this.alert("error",e.pleaseFillTheFieldsCorrectly),i)}.bind(this),actionOnDestroy:function(){new a({closable:!0,renderTo:document.body}).confirm(e.deletewarning,e.deletequestion,function(t){if(!0===t)if(!1===this.model.isNew())this.model.destroy({onComplete:function(){this.alert("success",e.experienceDeletedSuccess)}.bind(this),onFailure:function(){this.alert("error",e.YourchangescouldnotbesavedPleasetryagainlater)}.bind(this)});else{var i=this.getChildView("edition-switch");i&&i.onCancelClick()}}.bind(this))}.bind(this)})}})}),define("DS/SwymUIComponents/script/feature/core/education/view/education-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/experience/view/experience-view","DS/SwymUICore/script/feature/core/education/model/education-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/core/ui-components/edit-view-mode-switcher/edit-view-mode-switcher","DS/SwymUIComponents/script/feature/core/education/view/education-read-view","DS/SwymUIComponents/script/feature/core/education/view/education-edit-view","DS/SwymUIComponents/script/feature/core/modal/super-modal","DS/WebappsUtils/Console"],function(e,t,i,n,o,s,a,r,l){"use strict";return n.extend({_modelClass:i,name:"education-view",_createContent:function(){var i=new s({model:this.model,widget:this.widget}),n=new a({model:this.model,widget:this.widget});return e.createElement("div",{html:this.addChildView("edition-switch",{Class:o,model:this.model,editView:n,readView:i,actionOnSave:function(e){var i=this.getChildView("edition-switch").getChildView("editview").getControl("form-aboutme").validate(),n=this.model.isNew();return!0===e?i:i?this.model.save({},{onComplete:function(e,i){var o=n?t.educationcreated:t.educationUpdated;this.alert("success",o),e.set(e.getChanges());var s=this.getChildView("edition-switch");s&&s.setMode("read")}.bind(this),onFailure:function(e,t){}}):(this.alert("error",t.pleaseFillTheFieldsCorrectly),i)}.bind(this),actionOnDestroy:function(){new r({closable:!0,renderTo:document.body}).confirm(t.educationdeletewarning,t.educationdeletequestion,function(e){if(!0===e)if(!1===this.model.isNew())this.model.destroy({onComplete:function(){this.alert("success",t.educationDeletedSuccess)}.bind(this),onFailure:function(){this.alert("error",t.YourchangescouldnotbesavedPleasetryagainlater)}.bind(this)});else{var i=this.getChildView("edition-switch");i&&i.onCancelClick()}}.bind(this))}.bind(this)})})}})}),define("DS/SwymUIComponents/script/feature/community/content/social-interactions/patched-social-toolbar/patched-st-sprite",["DS/SocialToolbar/Utils/Sprite","DS/SwymUIComponents/script/feature/core/user/view/user-picture-view","DS/SwymUICore/script/feature/core/user/model/user-model"],function(e,t,i){"use strict";e.constructor.prototype.renderUserPicture=function(e){var n=new t({imageRenderingOptions:{cls:"swym-user-picture"+(e.cls?" "+e.cls:"")},model:new i({login:e.login,username:""})});return n.render(),n}}),define("DS/SwymUIComponents/script/feature/community/media/view/small-media-list-view",["UWA/Core","UWA/Event","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUIComponents/script/feature/community/content/view/media-thumbnail-view","DS/SwymUICore/script/feature/core/sprite/sprite","DS/SwymUICore/script/feature/core/context/context-model"],function(e,t,i,n,o,s){"use strict";var a=n.extend({_delegateSpriteReloadToParentView:!1,_createContent:function(){var t=this.model;return[o.renderMediaThumbnail(e.merge({mediaType:t.get("media_type"),imageUpdateTime:t.get("update"),imageFingerprint:t.get("preview_fingerprint"),modelId:t.get("mid"),modelName:t.getModelName(),title:t.get("title",{escapeHTML:!1})},e.merge(this._imageRenderingOptions||{},this.imageReloadOptions))),{class:"more-item",html:"..."}]}});return i.extend({name:"small-media-list",modelViewClass:a,domEvents:{"click img":"onItemClick"},onItemClick:function(e){var i=s.getInstance(),n=t.getElement(e),o=n.getAttribute("data-content-id"),a=n.getAttribute("data-content-type");o&&i.set({contentId:o,contentType:a})}})}),define("DS/SwymUIComponents/script/feature/core/user/view/mail/user-mail-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/mail/user-mail-view","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/core/ui-components/edit-view-mode-switcher/edit-view-mode-switcher","DS/SwymUIComponents/script/feature/core/user/view/mail/user-mail-read-view","DS/SwymUIComponents/script/feature/core/user/view/mail/user-mail-edit-view","DS/WebappsUtils/Console"],function(e,t,i,n,o,s,a,r){"use strict";return n.extend({_modelClass:i,name:"mail-view",_createContent:function(){var i=new s({model:this.model,widget:this._widget}),n=new a({model:this.model,widget:this._widget});return e.createElement("div",{html:this.addChildView("edition-switch",{Class:o,model:this.model,editView:n,readView:i,actionOnSave:function(e,i){var n=this.getChildView("edition-switch").getChildView("editview").getControl("form-aboutme").validate();if(!0===e)return n;if(!n)return this.alert("error",t.pleaseFillTheFieldsCorrectly),n;if(!this.model.getChanges("email"))return i||this.alert("info",t.noChangeDetected),!1;{const e=this.getChildView("edition-switch").getControl("save-button");this.model.updatePassportFields({data:{email:this.model.getChanges("email")||this.model.get("email")},onComplete:function(e,i){this.alert("success",t.alertMessage);var n=this.model.getChanges("email");void 0!==n&&this.model.set("email",n);var o=this.getChildView("edition-switch");o&&o.setMode("read"),this.model.removeChanges("email")}.bind(this),onFailure:function(){e.load(!1)}})}}.bind(this)})})}})}),define("DS/SwymUIComponents/script/feature/core/link/view/link-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/experience/view/experience-view","DS/SwymUICore/script/feature/core/link/model/link-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/core/ui-components/edit-view-mode-switcher/edit-view-mode-switcher","DS/SwymUIComponents/script/feature/core/link/view/link-read-view","DS/SwymUIComponents/script/feature/core/link/view/link-edit-view","DS/SwymUIComponents/script/feature/core/link/view/account-link-edit-view","DS/SwymUIComponents/script/feature/core/link/view/account-link-read-view","DS/SwymUICore/script/utils/utils","DS/SwymUIComponents/script/feature/core/modal/super-modal","DS/WebappsUtils/Console"],function(e,t,i,n,o,s,a,r,l,c,d,m){"use strict";return n.extend({_modelClass:i,name:"link-view",_createContent:function(){this.model.isSocialLink()&&this.container.addClassName("is-social-link");var i=new s({model:this.model,widget:this.widget}),n=new a({model:this.model,widget:this.widget});return e.createElement("div",{html:this.addChildView("edition-switch",{Class:o,model:this.model,editView:n,readView:i,actionOnSave:function(e){var i=this.getChildView("edition-switch").getChildView("editview").getControl("form-aboutme").validate();return this.model.isSocialLink()?this.container.addClassName("is-social-link"):this.container.removeClassName("is-social-link"),!0===e?i:i?void this.model.save({},{onComplete:function(e,i){this.alert("success",t.linkUpdated),e.set(e.getChanges());var n=this.getChildView("edition-switch");n&&n.setMode("read")}.bind(this),onFailure:function(e,t){}}):(this.alert("error",t.pleaseFillTheFieldsCorrectly),i)}.bind(this),actionOnDestroy:function(){new d({closable:!0,renderTo:document.body}).confirm(t.deletewarningLink,t.deletequestionLink,function(e){if(!0===e)if(!1===this.model.isNew())this.model.destroy({onComplete:function(){this.alert("success",t.linkdeletedsuccess)}.bind(this),onFailure:function(){this.alert("error",t.YourchangescouldnotbesavedPleasetryagainlater)}.bind(this)});else{var i=this.getChildView("edition-switch");i&&i.onCancelClick()}}.bind(this))}.bind(this)})})}})}),define("DS/SwymUIComponents/script/feature/community/media/view/3d-creation-manager",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUIComponents/script/utils/swym-vue","DS/SwymUIComponents/script/feature/core/modal/super-modal","DS/SwymUICore/script/feature/core/history/history-model","DS/SwymUIComponents/script/feature/community/media/view/3dskt-viewer","DS/SwymUIComponents/script/feature/community/media/view/3dsto-viewer","DS/SwymUICore/script/feature/core/mobile/communication-manager","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/edit/content-creation-view","text!DS/SwymUIComponents/assets/template/vuekit-lightbox-3dcreation.vue"],function(e,t,i,n,o,s,a,r,l,c,d){"use strict";const{Vue:m}=n,u=window.ds&&"MOBILE"===window.ds.env;return t.extend({_mediaType:null,setup:function(e){return this._mediaType=e.mediaType,this._parent.apply(this,arguments)},onShow:function(){this.view.isVisible=!0,u&&l.sendLightboxIsShown()},onHide:function(){this.view.isVisible=!1,u&&l.sendLightboxIsHidden()},onRedraw:function(){let t,n=this;t=window&&"3DD"===window.ds.env?e.extendElement(document.body).getElement(".layout-im-view-container"):e.extendElement(document.body),this.container.inject(t,"bottom"),!this.view&&(this.view=new m({el:this.container,template:d,methods:{onClose:function(e){if(e){n.getChildView("mediaEditorView").destroy(),s.back(),this.isVisible=!1}else{n.addControl("removeConfirmationModal",new o({closable:!1,renderTo:window.document.body||this._widget.body})).confirm({title:c.Cancel,message:c.AreYouSure,callback:function(e){!0===e&&this.onClose(!0)}.bind(this)})}}},data:()=>({userId:i.getInstance().get("user").login,isVisible:!0,title:"3DEXPERIENCE | "+n._mediaType,objectType:n._getObjectType(),is3DDWidget:window.ds&&"3DD"===window.ds.env,primaryActions:[],sideActions:[],lightboxStyle:{height:"100%"},closeLabel:c.Close,moreActionsLabel:c.More}),watch:{isVisible:function(){this.isVisible&&this.$nextTick(function(){n._displayPrimaryContent(this.$refs.lightboxContentContainer)})}},mounted(){u&&l.sendLightboxIsShown(),n._displayPrimaryContent(this.$refs.lightboxContentContainer)}}))},_displayPrimaryContent:function(t){var i=this.getChildView("mediaEditorView"),n=e.extendElement(t);if(!i)switch(this._mediaType){case"3DSketch":i=this.addChildView("mediaEditorView",{model:this.model,Class:a});break;case"3DWhiteboard":i=this.addChildView("mediaEditorView",{model:this.model,Class:a,whiteboard:!0});break;case"3DStory":i=this.addChildView("mediaEditorView",{model:this.model,Class:r})}i.container.empty(),i.inject(n,"bottom")},_getObjectType:function(){var e;switch(this._mediaType){case"3DSketch":e={name:"sketch",icon:"app-3dsketch",backgroundColor:"#70036b"};break;case"3DWhiteboard":e={name:"whiteboard",icon:"app-whiteboard",backgroundColor:"#70036b"};break;case"3DStory":e={name:"story",icon:"app-3dstory",backgroundColor:"#70036b"}}return e}})}),define("DS/SwymUIComponents/script/feature/community/content/view/community-contributions-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/generic/view/community-contributions-view","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUICore/script/lib/collection/mixed-collection","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/utils/date","DS/SwymUIComponents/script/feature/core/pagination/view/paging-toolbar-view","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/utils/utils","DS/UIKIT/Input/Button","DS/SwymUICore/script/lib/model/model-manager","DS/UIKIT/DropdownMenu"],function(e,t,i,n,o,s,a,r,l,c,d,m,u){"use strict";var h=null;return window.ds&&"3DD"===ds.env&&require(["DS/SwymUIComponents/script/utils/dnd-utils"],function(e){h=e}),i.extend({_collectionClass:n,_collectionEvents:{onSync:"unmask",onError:"unmask","onChange:published":"updateModelState",onRequest:"mask"},_addScroller:!1,_state:"max",_displayActions:!0,_displayTitle:!0,_superModal:null,_selectedModelType:null,_selectedModelId:null,name:"community-contributions-view",attributes:{styles:{padding:"0 20px"}},updateModelState:function(e){e.has("published")&&1===parseInt(e.get("published"),10)&&e.set("state","published")},onContributionEdit:function(e){let t=!1,i=e.get("state")&&"0"===e.get("published")||"draft"===e.get("state").toLowerCase();("media"!==e.getModelName()||"media"===e.getModelName()&&(i||["picture","whiteboard","sketch","story"].includes(e.get("media_type"))))&&(t=!0),l.goToContent(e.get("mid"),e.getModelName(),e.get("community").id,t,void 0,void 0,Boolean(s.getInstance().isDirectMessageContext()),{editProperties:!t})},_buildDropDownMenu:function(e,i){var n=this.getControl("dropDownMenu-"+i.get("mid"));n||(n=this.addControl("dropDownMenu"+i.get("mid"),new u({className:"my-contributions-item-dropdown-menu",target:e,renderTo:window.document.body.getElement(".scroll-content"),items:[{name:"edit",text:t.Edit,fonticon:"pencil"},{name:"delete",text:t.Delete,fonticon:"trash"}],events:{onClick:function(e,t){switch(t.name){case"edit":this.onContributionEdit(i);break;case"delete":this.onContributionDelete(i)}}.bind(this)}}))),n.show()},_onContributionDownOpenClick:function(e,t){this._buildDropDownMenu(t.target,e)},onContributionLinkClick:function(e){var t=!1,i=e.get("mid"),n=e.getModelName();(e.get("state")&&"0"===e.get("published")||"draft"===e.get("state").toLowerCase())&&(t=!0),this.dispatchEvent("onItemViewSelect",[e,t]),e.getRelativePath(),l.goToContent(i,n,e.get("community->mid"),t,void 0,void 0,Boolean(s.getInstance().isDirectMessageContext()))},onContributionDelete:function(e){var i=this;require(["DS/SwymUIComponents/script/feature/core/modal/super-modal"],function(n){var o=new n({closable:!0,renderTo:i._widget.body}),s=i.collection;o.confirm(t.Areyousureyouwanttodelete,t.Confirm,function(n){!0===n&&(i.mask(),e.deleteContribution({onComplete:function(){this.alert("success",t.Thiscontributionwassuccessfullydeleted),this.unmask(),s.fetchPage(s._currentPage)}.bind(i),onFailure:function(){this.alert("error",t.AnerrorhasoccurredPleasetryagainlater),this.unmask()}.bind(i)}))}.bind(i))})},onContributionDrag:function(e){h.onItemDrag(this.model,e,this.view._widget)},setSelectedModel:function(e){e&&(this._selectedModelId=e.get("mid"),this._selectedModelType=e.getModelName())},getSelectedModelType:function(){return this._selectedModelType},getSelectedModelId:function(){return this._selectedModelId},_createContent:function(){var i,n,l,m,u,h,p=!1,g=!1,w=null,C=this._state,f=this.collection,y=f.first();return f&&(!w&&f.length>0&&((w=y.getCommunity()).isDirectMessage()&&(w=new o(w.toJSON())),!1!==w.hasBeenFetched()||w.isDirectMessage()?l=w.getCommunityFeaturesAccess():this.listenToOnce(w,"onSync:read",this.refresh)),l?(i=e.createElement("table",{class:"table table-hover"}),f.forEach(function(o){switch(p=!1,o.getModelName()){case"post":case"media":case"wedo":p=!0;break;case"survey":p=l.survey_feature;break;case"iquestion":p=l.qna_feature;break;case"idea":p=l.ideation_feature;break;case"wiki":p=l.wiki_feature}n=i.insertRow(-1);var s=o.get("mid"),r=o.getContentType();if(n.dataset.modelId=s,n.dataset.modelType=r,o.get("state")&&(g="published"===o.get("state").toLowerCase()),m=e.createElement("div",{class:"contrib-desc-container"+(p?"":" disabled"),html:[{tag:"span",class:"fonticon fonticon-2x fonticon-"+c.getIconFromModel(o)+" content-icon "+r,styles:{float:"left","margin-right":"10px"}},{html:'<a onclick="return false;" href="'+o.getRelativePath()+'">'+(o.get("title")?o.get("title"):"<i>"+t.NoTitleYet+"</i>")+"</a>"+(g?"":'<span class="draft-label">'+t.Draft.toUpperCase()+"</span>")}],events:p?{click:this.onContributionLinkClick.bind(this,o)}:{}}),window.ds&&"3DD"===ds.env&&(m.addEventListener("dragstart",this.onContributionDrag.bind({view:this,model:o})),m.setAttribute("draggable","true")),!1===p&&m.set("title",t.Thiscommunityfeatureiscurrentlydisabled),n.insertCell(-1).appendChild(m),"max"===C){var d=g?"":'style="color:#E87B00"';n.insertCell(-1).innerHTML='<div class="td-body"'+d+">"+(g?a.prettyDate(o.get("time")):t.Draft.toUpperCase())+"</div>",!0===this._displayActions&&(u=e.createElement("div",{class:"contrib-actions td-body",html:[{tag:"span",class:"contrib-down-open"+(p?"":" disabled"),html:{tag:"span",class:"fonticon fonticon-1-5x fonticon-down-open"},events:p?{click:this._onContributionDownOpenClick.bind(this,o)}:{}},{tag:"span",class:"contrib-edit-action"+(p?"":" disabled"),html:{tag:"span",class:"fonticon fonticon-1-5x fonticon-pencil"},events:p?{click:this.onContributionEdit.bind(this,o)}:{}},{tag:"span",class:"contrib-delete-action"+(p?"":" disabled"),html:{tag:"span",class:"fonticon fonticon-1-5x fonticon-trash"},events:p?{click:this.onContributionDelete.bind(this,o)}:{}}]}),n.insertCell(-1).appendChild(u))}else!0===this._displayActions&&(u=e.createElement("div",{class:"contrib-actions",html:[{tag:"span",class:"contrib-edit-action"+(p?"":" disabled"),html:{tag:"span",class:"fonticon fonticon-1-5x fonticon-pencil"},events:p?{click:this.onContributionEdit.bind(this,o)}:{}}]}),n.insertCell(-1).appendChild(u));u&&!1===p&&u.set("title",t.Thiscommunityfeatureiscurrentlydisabled)}.bind(this)),h={html:[{tag:"div",class:"table-responsive",html:i},"max"===C?this.addChildView("pagingToolbar",new r({collection:f})):{}]}):f.hasBeenFetched()&&0===f.length&&(h={class:"dsi-noresult",styles:{margin:"10% 0","text-align":"center",width:"100%"},html:[{class:"fonticon fonticon-5x fonticon-feather"},{html:Boolean(s.getInstance().isDirectMessageContext())?t.get("Itseemsyoudidnotpublishanycontentinthisconversationyet"):t.Itseemsyoudidnotpublishanycontentinthiscommunityyet},new d({value:t.StartNow,className:"link",events:{onClick:function(){var e,t=this;require(["DS/SwymUICore/script/feature/core/context/context-model"],function(i){var n=i.getInstance();e=n.isDirectMessageContext()?{communityId:t.collection.communityId,dmId:n.dmId}:{communityId:t.collection.communityId},n.reset(e)})}.bind(this)}})]})),{class:"community-contrib-wrapper",styles:{"min-height":"50px"},html:[this._displayTitle?{tag:"h4",class:"",html:t.MyContributions}:"",h]}},getModelType:function(e){var i="";switch(e){case"post":i=t.Post;break;case"media":i=t.Media;break;case"iquestion":i=t.iQuestion;break;case"idea":i=t.Idea;break;case"wiki":i=t.Wiki;break;case"survey":i=t.Survey}return i},onPublishing:function(e){var t=!1,i=!1;this.collection&&e&&((this.collection instanceof n||e instanceof this.collection.model)&&(t=!0),this.collection.communityId?e.get("community->mid")===this.collection.communityId&&(i=!0):i=!0),!0===t&&!0===i&&this.collection.resetCollection("1")},setup:function(t){return t&&(this.mode=t.mode,e.is(t.displayTitle)&&(this._displayTitle=t.displayTitle),e.is(t.addScroller)&&(this._addScroller=t.addScroller)),this._parent.apply(this,arguments),m.addListenerOnPublishing(this.onPublishing.bind(this)),m.addListenerOnDraftCreation(this.onPublishing.bind(this)),this},destroy:function(){m.removeListenerOnPublishing(this.onPublishing.bind(this)),m.removeListenerOnDraftCreation(this.onPublishing.bind(this)),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/core/user/view/location/user-location-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/location/user-location-view","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/core/ui-components/edit-view-mode-switcher/edit-view-mode-switcher","DS/SwymUIComponents/script/feature/core/user/view/location/user-location-read-view","DS/SwymUIComponents/script/feature/core/user/view/location/user-location-edit-view","DS/WebappsUtils/Console"],function(e,t,i,n,o,s,a,r){"use strict";return n.extend({_modelClass:i,name:"location-view",_createContent:function(){var i=new s({model:this.model,widget:this._widget}),n=new a({model:this.model,widget:this._widget});return e.createElement("div",{html:this.addChildView("edition-switch",{Class:o,model:this.model,editView:n,readView:i,actionOnSave:function(e){var i=this.getChildView("edition-switch").getChildView("editview").getControl("form-aboutme").validate(),n={},o=this.model;return e?i:i?(void 0!==o.getChanges("zip")&&(n.zip=o.getChanges("zip")),void 0!==o.getChanges("address")&&(n.address=o.getChanges("address")),void 0!==o.getChanges("city")&&(n.city=o.getChanges("city")),void 0!==o.getChanges("country_code")&&(n.country=o.getChanges("country_code")),void 0!==o.getChanges("company")&&(n.company=o.getChanges("company")),Object.keys(n).length>0&&void o.updatePassportFields({data:n,onComplete:function(e,i){var n=e.fields;this.alert("success",t.personalInfoUpdated),void 0!==o.getChanges("zip")&&o.set("zip",n.zip.value),void 0!==o.getChanges("address")&&o.set("address",n.address.value),void 0!==o.getChanges("city")&&o.set("city",n.city.value),o.getChanges("country_code")&&(o.set("country_code",o.getChanges("country_code")),o.set("countryForRead",o.getChanges("countryForRead"))),void 0!==o.getChanges("company")&&o.set("company",n.company.value);var s=this.getChildView("edition-switch");s&&s.setMode("read"),o.removeChanges(["zip","address","city","country_code","company"])}.bind(this)})):(this.alert("error",t.pleaseFillTheFieldsCorrectly),i)}.bind(this)})})}})}),define("DS/SwymUIComponents/script/feature/community/wiki/view/revision-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/wiki/view/revision-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/view/abstract-content-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/wiki/model/wiki-model","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/utils/date","DS/UIKIT/Input/Button","DS/SwymUIComponents/script/feature/core/modal/super-modal","DS/UIKIT/Input/Toggle","DS/UIKIT/Tooltip"],function(e,t,i,n,o,s,a,r,l,c,d){"use strict";var m=n.extend({name:"revision-description-view",_currentRevisionAttributes:null,_modelEventsForAutoRefresh:["onSync"],setup:function(){this._parent.apply(this,arguments),this.stopReactingTo(this.model,"onRevisionReceived"),this.reactTo(this.model,"onRevisionReceived",function(){this.refresh()})},_createContent:function(){var e,n,o=this.model,s=o.get("diff");return this.currentRev=this._parentView.currentRev,(n=(e=o.getRevisionData(this.currentRev,s))&&e.revision_description)&&(n=n.escapeHTML()),e?{id:"revision_description_wrapper",html:[{class:"current-revision",html:t.Currentrevisiondescription},{class:"current-revision",html:[i.by+" ",{tag:"a",class:"link","data-content-type":"person","data-hash-key":e.last_publisher.hash_key,"data-login":e.last_publisher.login,html:e.last_publisher.first_name+" "+e.last_publisher.last_name},' - <span class="revision-date">'+a.prettyDate(e.update)+"</span>"]},{class:"current-revision",styles:{display:n&&""!==n?"":"none"},id:"revision_description",html:n}]}:""}});return n.extend({_modelClass:o,name:"revision-view",currentRev:-1,_modelEventsForAutoRefresh:["onSync:update","onSync"],_modelEvents:{"onSync:read":"unmask","onChange:nb_revisions":"updateRevisionButtons"},domEvents:{"click .prev-first-button":"onFirstButtonClick","click .next-last-button":"onLastButtonClick","click .prev-button":"onPrevButtonClick","click .next-button":"onNextButtonClick","click .revert-button":"onRevertButtonClick"},onSetModel:function(){var e=this.model,i=this.getControl("prev-first-button"),n=this.getControl("prev-button"),o=this.getControl("next-button"),s=this.getControl("next-last-button"),a=this.getControl("revert-button"),l=this.getControl("show-diff-checkbox");e.get("diff")&&e.goToNthRevision(-1,!1),i||(i=this.addControl("prev-first-button",new r({className:"default prev-first-button",icon:"to-start"}))),n||(n=this.addControl("prev-button",new r({className:"default prev-button",icon:"fast-backward"}))),i.enable(),n.enable(),o||(o=this.addControl("next-button",new r({className:"default next-button",icon:"fast-forward",disabled:!0}))),s||(s=this.addControl("next-last-button",new r({className:"default next-last-button",icon:"to-end",disabled:!0}))),o.disable(),s.disable(),this.getControl("prev-first-button-tooltip")||this.addControl("prev-first-button-tooltip",new d({target:this.getControl("prev-first-button").getContent(),body:t.FirstRevision})),this.getControl("prev-button-tooltip")||this.addControl("prev-button-tooltip",new d({target:this.getControl("prev-button").getContent(),body:t.PreviousRevision})),this.getControl("next-button-tooltip")||this.addControl("next-button-tooltip",new d({target:this.getControl("next-button").getContent(),body:t.NextRevision})),this.getControl("next-last-button-tooltip")||this.addControl("next-last-button-tooltip",new d({target:this.getControl("next-last-button").getContent(),body:t.LastRevision})),a||(a=this.addControl("revert-button",new r({className:"default revert-button",icon:"ccw",value:t.Revert}))),a&&a.hide(),l||(l=this.addControl("show-diff-checkbox",new c({type:"checkbox",className:"show-diff-checkbox primary",checked:!1,id:"show-diff-checkbox",label:t.Showdifferences,events:{onChange:function(){e.goToNthRevision(this.currentRev,{diff:this.getControl("show-diff-checkbox").isChecked()})}.bind(this)}}))),l.setCheck(!1),this.currentRev=e.getCurrentRevision()},onHide:function(){var e=this.model,t=this.getControl("show-diff-checkbox");e.get("diff")&&(t.setCheck(!1),e.goToNthRevision(this.currentRev,{diff:!1}),this.currentRev=e.getCurrentRevision())},_createContent:function(){var t,i=this.model;if(i.hasBeenFetched()){if(this._getNbRevisions()!==this._getRevisionNumber()){var n=this.getControl("next-button"),o=this.getControl("next-last-button");n&&n.enable(),o&&o.enable()}if(1===this._getRevisionNumber()){var s=this.getControl("prev-button"),a=this.getControl("prev-first-button");s&&s.disable(),a&&a.disable()}parseInt(i.get("nb_revisions"),10)+("0"===i.get("is_minor_edit")?1:0)>1?(this.container.removeClassName("hidden"),t=e.createElement("div",{class:"revision-view-wrapper",html:{class:"revision-panel",html:[{class:"heading",html:{class:"wikitree-header",html:{class:"revision-counter-panel",styles:{"margin-bottom":"10px"},html:this._computeWidgetTitle()}}},{class:"player",html:[this.getControl("prev-first-button"),this.getControl("prev-button"),this.getControl("next-button"),this.getControl("next-last-button")]},{html:[this.getControl("show-diff-checkbox"),this.addChildView("revisionDescription",{Class:m,model:i})]},this.getControl("revert-button")]}}),this._setWidgetTitle(this._computeWidgetTitle())):this.container.addClassName("hidden")}return t},onRender:function(){this._setWidgetTitle(this._computeWidgetTitle())},_getNbRevisions:function(){return parseInt(this.model.get("nb_revisions"),10)+("0"===this.model.get("is_minor_edit")?1:0)},_getRevisionNumber:function(){return-1===this.currentRev?parseInt(this._getNbRevisions(),10):parseInt(this.currentRev,10)+1},_computeWidgetTitle:function(){var e=this._getRevisionNumber(),i=this._getNbRevisions();return'<span class="fonticon fonticon-rotate-ccw"></span>'+t.Revision+(e===parseInt(i,10)&&1===e?"":" ("+e+" / "+parseInt(i,10)+")")},_setWidgetTitle:function(e){this.getElement(".revision-counter-panel")&&this.getElement(".revision-counter-panel").setHTML(e)},_resetWikiTreeWrapperHeight(){this._parentView&&setTimeout(()=>{const e=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0),t=Math.max(this._parentView.getElement(".revision-view-container")&&this._parentView.getElement(".revision-view-container").offsetHeight||-20);this._parentView.getElement(".wikitree-wrapper").setStyle("height",e-t-272)},500)},onFirstButtonClick:function(){this.mask(),this.currentRev=0,this._setWidgetTitle(this._computeWidgetTitle()),this.getControl("prev-first-button").disable(),this.getControl("prev-button").disable(),this.getControl("next-button").enable(),this.getControl("next-last-button").enable(),this.model.get("_acl").update.access&&this.getControl("revert-button")&&this.getControl("revert-button").show(),this.model.goToFirstRevision({diff:this.getControl("show-diff-checkbox").isChecked()}),this._resetWikiTreeWrapperHeight()},updateRevisionButtons:function(){this.mask(),this.currentRev=-1,this._setWidgetTitle(this._computeWidgetTitle()),this.getControl("prev-first-button").enable(),this.getControl("prev-button").enable(),this.getControl("next-button").disable(),this.getControl("next-last-button").disable(),this.getControl("revert-button")&&this.getControl("revert-button").hide()},onLastButtonClick:function(){this.updateRevisionButtons();var e=this.getControl("show-diff-checkbox").isChecked();this.model.get("nb_revisions")>0&&this.model.goToLastRevision({diff:e}),this._resetWikiTreeWrapperHeight()},onPrevButtonClick:function(){this.mask(),-1===this.currentRev?(this.currentRev=parseInt(this.model.get("nb_revisions"),10)-1,"1"===this.model.get("is_minor_edit")&&this.currentRev--):this.currentRev--,this._setWidgetTitle(this._computeWidgetTitle()),0===parseInt(this.currentRev,10)?(this.getControl("prev-first-button").disable(),this.getControl("prev-button").disable()):(this.getControl("prev-first-button").enable(),this.getControl("prev-button").enable()),this.getControl("next-button").enable(),this.getControl("next-last-button").enable(),this.model.get("_acl").update.access&&this.getControl("revert-button")&&this.getControl("revert-button").show(),this.model.goToNthRevision(this.currentRev,{diff:this.getControl("show-diff-checkbox").isChecked()}),this._resetWikiTreeWrapperHeight()},onNextButtonClick:function(){this.mask(),this.currentRev++;var e=parseInt(this.model.get("nb_revisions"),10);"1"===this.model.get("is_minor_edit")&&e--,this.currentRev===e&&(this.currentRev=-1),this._setWidgetTitle(this._computeWidgetTitle()),-1===this.currentRev?(this.getControl("next-button").disable(),this.getControl("next-last-button").disable(),this.getControl("revert-button")&&this.getControl("revert-button").hide()):(this.getControl("next-button").enable(),this.getControl("next-last-button").enable(),this.model.get("_acl").update.access&&this.getControl("revert-button")&&this.getControl("revert-button").show()),this.getControl("prev-first-button").enable(),this.getControl("prev-button").enable(),this.model.goToNthRevision(this.currentRev,{diff:this.getControl("show-diff-checkbox").isChecked()}),this._resetWikiTreeWrapperHeight()},onRevertButtonClick:function(){this.addControl("confirmModal",new l({closable:!1,renderTo:this._widget.body})).confirm(t.Areyousureyouwanttorevertthepagetothisrevision,t.Confirm,function(e){!0===e&&(this.mask(),this.model.revert({onComplete:function(){this.alert("success",t.Thepagehasbeenrevertedtotheselectedrevision),this.nbRevisions++,this.onLastButtonClick(),this.unmask()}.bind(this),onFailure:function(){this.unmask(),this.alert("error",t.Anerroroccuredwhilerevertingthepage)}.bind(this)}))}.bind(this)),this._resetWikiTreeWrapperHeight()},setup:function(){var e=this;this._parent.apply(this,arguments),this.stopReactingTo(this.model,"onRevisionReceived"),this.reactTo(this.model,"onRevisionReceived",function(){e.unmask()})}})}),define("DS/SwymUIComponents/script/feature/core/stats/view/static-stats-collection-view",["DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUICore/script/feature/core/stats/collection/stats-collection","DS/SwymUIComponents/script/feature/core/stats/view/analytics-view"],function(e,t,i){return e.extend({_collectionClass:t,name:"static-stats-collection-view",modelViewClass:i,bodyAttributes:{tag:"div",styles:{"overflow-x":"hidden"}},modelViewsCfg:{attributes:{class:ds&&"3DD"===ds.env?"graph col-xs-12 col-md-6 col-sm-6 col-lg-4":"graph"}}})}),define("DS/SwymUIComponents/script/utils/media-utils",["UWA/Core","DS/SwymUICore/script/feature/community/media/model/media-model","DS/WAFData/WAFData","DS/SwymUICore/script/utils/utils","DS/SwymUIComponents/script/utils/media-utils-v0","DS/SwymUIComponents/script/utils/media-utils-v1","DS/Logger/Logger"],function(e,t,i,n,o,s,a){"use strict";function r(e){return new t({mid:e})}function l(e){return"function"==typeof e.get?e.get("processing_version"):e.processing_version||e.preview_media_processing_version}function c(){return window.ds&&"MOBILE"===window.ds.env}var d={};d.MEDIA_THUMBNAIL=t.MEDIA_THUMBNAIL,d.PICTUREVIEW_V0=t.PICTUREVIEW_V0,d.PICTUREVIEW_V1=t.PICTUREVIEW_V1,d.MEDIA_TYPE={PICTURE:"picture",IMAGE:"picture",SOUND:"sound",AUDIO:"sound",VIDEO:"video",DRAWING:"drawing",DOCUMENT:"document","3D_MODEL":"3d_model","3DMODEL":"3d_model",SIMULATION:"simulation"},d.MEDIA_PROCESSING_STATUS=t.MEDIA_PROCESSING_STATUS,d.CONTENT_SECTION_MAX_WIDTH=740,d.CONTENT_SMALL_IMAGE_MAX_WIDTH_RATIO=.31,d.CONTENT_SMALL_IMAGE_MAX_WIDTH=Math.ceil(d.CONTENT_SECTION_MAX_WIDTH*d.CONTENT_SMALL_IMAGE_MAX_WIDTH_RATIO),d.CONTENT_LARGE_IMAGE_MIN_WIDTH=Math.max(d.PICTUREVIEW_V0.DIMENSIONS.SMALL.WIDTH,d.CONTENT_SMALL_IMAGE_MAX_WIDTH),d.isPictureViewAvailable=function(e){var t,i,n;return e&&(i=l(t=r(e)),n=1===parseInt(i,10)?s.isPictureViewAvailable(t):o.isPictureViewAvailable(t)),n},d.getBestMediaViewConfig=function(e,t,i,n){var a,c;return e&&(c=l(a=r(e))),1===parseInt(c,10)?s.getBestMediaViewConfig(a,t,i,n):o.getBestMediaViewConfig(a,t,i,n)},d.getLargestMediaDisplayDimensions=function(e){var t;return t=l(e),1===parseInt(t,10)?s.getLargestMediaDisplayDimensions(e):o.getLargestMediaDisplayDimensions(e)},d.getMediaViewerModuleByMediaType=function(e,t,i){var n=null,o="DS/SwymUIComponents/script/feature/community/media/view/";switch((!t||i&&!0===i.prevent3DPlayInstantiation||window.ds&&"3DSearch"===window.ds.env)&&(t="view"),window.ds&&"3DSearch"===window.ds.env&&(e="picture"),e){case"picture":n=o+"picture-viewer";break;case"animatedPicture":if(c()){n=o+"animated-picture/mobile/gif-video-viewer";break}case"video":case"sound":n=o+"video-viewer";break;case"document":n=o+"document-viewer";break;case"sketch":case"story":case"whiteboard":case"3d_model":case"drawing":if(i&&!0===i.prevent3DPlayInstantiation)n=o+"picture-viewer";else{var s=i&&i.mediaExtension;n=o+"media-3d-viewer","3dsto"===s&&(n=o+"3dsto-viewer"),"3dskt"!==s&&"3dwb"!==s||(n=o+"3dskt-viewer"),console.log("module name - "+n)}break;case"simulationMedia":n=o+"media-3d-viewer"}return"edit"===t&&"picture"===e&&(n="DS/SwymUIComponents/script/feature/community/media/editor/view/image-editor-view"),"360Activated"===t&&"picture"===e&&(n=o+"media-360-viewer"),n},d.getMediaViewerModule=function(e,i,n){var o=e.get("media_type")||window.ds&&!0===window.ds.isMDE&&e.get("drive_media_type");if(!e)throw new Error("No media model provided");if(!(e instanceof t))throw new Error("The provided model is not a MediaModel");return e.hasExtensionType("svg")&&(o="3d_model"),d.getMediaViewerModuleByMediaType(o,i,n)},d.getImageRenderingOptionsForMedia=function(e,t,i,o,s){var a,r,l,c,d,m={};return e&&t&&i&&o&&(e=parseInt(e,10),t=parseInt(t,10),e&&t&&(e<i&&t<o?m={extraAttributes:{styles:{width:e+"px",height:t+"px","background-color":"#e2e4e3"},"data-styles-to-remove-after-load":"width, height, background-color"}}:((d=e/t)<=i/o?l=(c=t>o?o:t)*d:c=(l=e>i?i:e)/d,m={extraAttributes:{styles:{"max-height":o+"px","max-width":i+"px",width:l+"px",height:c+"px","background-color":"#e2e4e3"},"data-styles-to-remove-after-load":"width, height, background-color"}}),s&&m&&m.extraAttributes&&(a=m.extraAttributes.styles)&&(a["background-image"]='url("'+n.getMediaDefaultThumbnail(s)+'")',a["background-size"]="contain",a["background-position"]="center center",(r=m.extraAttributes["data-styles-to-remove-after-load"])&&(m.extraAttributes["data-styles-to-remove-after-load"]=r.concat(", background-image, background-size, background-position"),m.extraAttributes["data-media-width"]=l,m.extraAttributes["data-media-height"]=c)))),m},d.request3DSAAuthentification=function(t){var n=t&&t.authenticationUrl,o=t&&t.successCallback,s=t&&t.failureCallback,r=0,l={method:"GET",type:"json",onComplete:function(e,t,i){c()&&this.xhr&&200===this.xhr.status?(a.log("3DSA authentification successful on mobile"),o&&o()):200===i.status?(a.log("3DSA authentification successful"),o&&o()):(a.log("3DSA response contains an error"),s&&s())},onFailure:function(){r++,a.error("Basic user info failure call, nbFailure:",r),r<2?(a.error("Basic user info extra call"),i.authenticatedRequest(n,l)):(a.error("No more Basic user info call"),s&&s())}};n?i.authenticatedRequest(n,e.extend(l,t)):o?o():s&&s()},d.getBestDimensionsDisplayForVideo=function(e,t,i){var n=e.get("media_type");if("video"===n||"animatedPicture"===n){if(t&&i){var o,s,r=parseInt(e.get("width"),10),l=parseInt(e.get("height"),10),c=r/l;return(l>t||r<i)&&(r/i>l/t?o=Math.min(r,i):(o=Math.min(t*c,r),s=t)),!o||o>=244||"animatedPicture"===n?{height:s,width:o}:{height:244/c,width:244}}a.error("_getBestDimensionsDisplayForVideo - Please provide a valid container height and container width")}else a.error("_getBestDimensionsDisplayForVideo requires a media of type Video")};var m=function(e,t){var i=null;return e&&t&&(i=e.getChanges(t)||e.get(t)),i};return d.getImageTagFromMedia=function(t,i){if(!e.is(i,"function"))throw new Error("A callback is expected");var o=m(t,"media_type"),s=m(t,"preview_fingerprint"),a="video"===o||"3d_model"===o?"520px":"320px";if(m(t,"mid"))i.call(this,e.createElement("img",{"data-media-id":m(t,"mid"),"data-fingerprint":s||void 0,"data-media-type":o,"data-source":"swym",styles:"picture"!==o?{width:a}:{}}));else if("picture"===o){require(["DS/SwymUIComponents/script/feature/community/media/edit/thumbnail/upload-progress-media-thumbnail-view"],function(o){o.renderUploadingMedia(t,function(o,s){var r=e.createElement("img",{"data-media-type":"picture","data-new_media":"true","data-media_cid":t.cid});r.onload=function(){r.height?r.setStyles({width:r.width+"px",height:r.height+"px"}):(r.set({src:n.getMediaDefaultThumbnail("picture")}),r.setStyles({width:a})),i.call(this,r)},s?r.set({src:s}):e.is(t.getChanges().userFile.type)&&"image/tiff"===t.getChanges().userFile.type&&(r.onload=null,r.set({src:n.getMediaDefaultThumbnail("picture")}),r.setStyles({width:a}),i.call(this,r))}.bind(this))}.bind(this))}else m(t,"objectId")?i.call(this,e.createElement("img",{src:t.get("displayPreview",{escapeHTML:!1}),class:"text-editor-media-placeholder","data-new_media":"true","data-media_cid":t.cid,styles:{width:a}})):i.call(this,e.createElement("img",{src:n.getMediaDefaultThumbnail(o),class:"text-editor-media-placeholder","data-media-type":o,"data-new_media":"true","data-media_cid":t.cid,styles:{width:a}}))},d.generateBestThumbnailForContentView=function(e,t,i,n){var o,s,a,r,l,c,m,u,h,p=n&&n.imgTag,g={};if(e=parseInt(e,10),t=parseInt(t,10),e||(e=d.MEDIA_THUMBNAIL.DIMENSIONS.LARGE.WIDTH),t||(t=e/void 0),!i&&!p)throw new Error("Both Model and Image tag are missing from arguments");return i?(m=i.get("media_type"),u=i.get("mid"),h=i.get("preview_fingerprint")):(m=n.mediaType,u=n.mediaId,h=n.previewFingerprint),a=(r=d.getBestMediaViewConfig(u,e,t,"whats-new-mode")).size,l=r.width,c=r.height,s=r.spriteKey,o=r.spriteType,g["data-size"]=p&&p.getAttribute("data-size"),g["data-size"]||delete g["data-size"],g["data-position"]=p&&p.getAttribute("data-position"),g["data-position"]||delete g["data-position"],{mediaId:u,mediaType:m,previewType:r.previewType,useVariableSizeSprite:!0,width:l,height:c,widthToDisplay:e,heightToDisplay:t,spriteKey:s,spriteType:o,imageFingerprint:h,sizeCategory:a,url:r.url,extraAttributes:g}},d.generateImageReloadOptionsForMedia=function(e){var t,i,n,o,s,a,r,l;return i=e.mediaId,n=parseInt(e.mediaWidth,10)||0,s=parseInt(e.mediaHeight,10)||0,o=n?n/s:4/3,l=parseInt(e.containerWidth,10)||0,r=parseInt(e.containerHeight,10)||l&&l/o,a=(t=d.getBestMediaViewConfig(i,l,r,"whats-new-mode")).size,"picture"===t.previewType?{size:a,imageKind:"picture"}:{size:a,imageKind:"thumb"}},d.getPreviewThumbnail=function(e){var t,i,n,o,s,a,r,l=parseInt(e.container.getSize().width),c=e.containerHeight||parseInt(e.container.getSize().height),m=e.model,u=m.get("media_type"),h={};if("sound"!==u)if(i=parseInt(m.get("width"),10),o=m.get("ratio",{escapeHTML:!1})||"4/3",t=parseInt(o.split("/")[0]),n=i*parseInt(o.split("/")[1])/t,"picture"===u&&e.useOriginal&&l>=i&&c>=n)(h=m.get("play").download_original_url).url=h.transient_url;else{r=m.get("mid");for(var p=0,g=(a="picture"===(s=d.getBestMediaViewConfig(r,l,c)).previewType&&m.get("play")&&m.get("play").view?m.get("play").view:m.get("preview").thumbnails).length;p<g;p++)if(a[p].alias===s.size){h=a[p];break}h.url=s.url}return h},d.getContainerForJoinCallAlert=function(){return document.body.getElement(".community-central-list-view-container")},d}),define("DS/SwymUIComponents/script/feature/community/media/view/document-default-viewer",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/UIKIT/Spinner","DS/SwymUIComponents/script/utils/media-utils"],function(e,t,i,n){"use strict";return t.extend({name:"document-default-viewer",_getDownloadUrl:function(){if(!this._downloadUrl&&this.model){var e=this.model.get("play");this._downloadUrl=e&&e.download_original_url&&e.download_original_url.transient_url_as_attachment}return this._downloadUrl||""},_createContent:function(){var t=null;return void 0!==this.model.get("preview")?(t=n.getPreviewThumbnail(this).url,e.createElement("div",{class:"docpreview",html:[{tag:"a",href:this._getDownloadUrl(),target:"_blank",download:"",styles:{outline:"none"},html:{tag:"img",styles:{height:"100%","margin-bottom":"5px",border:"1px solid #C4C4C4"},src:t}}],styles:{height:"100%"}})):{styles:{"text-align":"center",height:"40px",margin:"10px"},html:new i({className:"msg-animation",visible:!0,animate:!0,spin:!0})}}})}),define("DS/SwymUIComponents/script/feature/community/content/view/media-download-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/generic/view/content-details-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUIComponents/script/utils/media-utils","DS/UIKIT/Input/Button","DS/Logger/Logger"],function(e,t,i,n,o,s,a){"use strict";var r=window.ds&&"MOBILE"===window.ds.env;return i.extend({_modelClass:n,_modelEventsForAutoRefresh:["onChange:download_original_file","onSync:read"],name:"media-download-view",domEvents:{"click #download-link":"_onDownloadLink"},_createContent:function(){var i=[],n=this.model;return(n.hasBeenFetched()&1===parseInt(n.get("download_original_file"),10)||"document"===n.get("media_type"))&&(i=e.createElement("div",{class:"download-wrapper",html:["3d_model"===n.get("media_type")?{class:"download-3dfile-icon",html:[{class:"wrapper-3dfile-formats",html:this.createDownloadUIFor3DModel()}]}:{html:[{tag:"button",class:"btn btn-primary",id:"download-link",html:t.Download}]}]})),i},createDownloadUIFor3DModel:function(){var i=this.model,n=i.get("status"),l=null;if(i.get("play")&&i.get("play")["3d_streams"]){l=i.get("play")["3d_streams"];var c=i.get("play").download_original_url;if(c&&"1"===c.authorized_by_owner&&l.push(e.merge(c,{alias:c.format})),n===o.MEDIA_PROCESSING_STATUS.OK){var d={className:"primary"};if(l.length>1){var m={},u=[];for(var h in l.forEach(function(e){m[e.alias]=e.transient_url_as_attachment}),m)u.push({text:h});d=e.merge(d,{value:t.DownloadAs,dropdown:{items:u},events:{onDropdownClick:function(e,t){t.text?r?require(["DS/SwymUICore/script/feature/core/mobile/communication-manager"],function(e){e.sendDownloadMediaRequest({transientURL:m[t.text],extension:t.text})}):window.open(m[t.text],"_self"):a.log("item value is undefined")}}})}else d=e.merge(d,{value:t.Download,events:{click:function(){window.open(l[0].transient_url_as_attachment,"_self")}}});return new s(d)}}},_onDownloadLink:function(){var e=this.model,t=e.get("play").download_original_url.transient_url_as_attachment;return r?require(["DS/SwymUICore/script/feature/core/mobile/communication-manager","DS/SwymUICore/script/feature/core/mobile/utils"],function(t,i){t.sendDownloadMediaRequest({transientURL:i.getTransientUrlForDownload(e),extension:i.getExtensionForDownload(e)})}):window.open(t,"_blank"),this.dispatchEvent("onMediaDownload"),!1}})}),define("DS/SwymUIComponents/script/feature/community/media/view/media-details-view",["UWA/Core","UWA/Utils/Client","i18n!DS/SwymUIComponents/assets/nls/feature/community/generic/view/content-details-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUIComponents/script/utils/media-utils","DS/SwymUICore/script/utils/utils"],function(e,t,i,n,o,s,a){"use strict";return n.extend({_modelClass:o,_modelEventsForAutoRefresh:["onChange"],name:"media-details-view",_showDownloadButton:!1,setup:function(e){e&&(void 0!==e.showDownloadButton&&(this._showDownloadButton=e.showDownloadButton),e.createCounterView&&(this.createCounterView=e.createCounterView)),this._parent.apply(this,arguments)},onRender:function(){this._addDownloadButtonView()},onRefresh:function(){this._addDownloadButtonView()},_createCounterView:function(){return this.addChildView("viewCounter",{Class:"DS/SwymUIComponents/script/feature/community/content/social-interactions/counter-view",model:this.model})},_addDownloadButtonView:function(){if(!0===this._showDownloadButton){var e=this.addChildView("media-download-view",{Class:"DS/SwymUIComponents/script/feature/community/content/view/media-download-view",model:this.model,events:{onInit:function(e){this.listenTo(e,"onMediaDownload",this._onMediaDownload.bind(this))}.bind(this)}}),t=this.container.getElement(".media-right");e&&t&&e.inject(t)}},_onMediaDownload:function(){this.dispatchEvent("onMediaDownload")},_createContent:function(){var e,t=this.model,n=null,o=null,a=null,r=t.get("format_3dsa");return t?((e=t.get("status")===s.MEDIA_PROCESSING_STATUS.OK)&&(n=this.getOriginalNameDetails(),o=this.getResolutionDetails(),a=this.getDurationDetails()),[this.getMediaDescription(),["3dskt","3dsto"].includes(r)?{html:this.createCounterView?this._createCounterView():""}:{class:"media-globals",html:[{class:"media-left",html:e?[this.createCounterView?{class:"media-title-counter",html:[{class:"media-details-title",html:i.Properties},this._createCounterView()]}:{class:"media-details-title",html:i.Properties},{class:"media-display-flex",html:[{class:"media-label-details",html:[n.label,o.label,a.label]},{class:"media-content-details",html:[n.value,o.value,a.value]}]}]:this.getRelatedPost()},{class:"media-right"}]},e?this.getRelatedPost():""]):""},getMediaDescription:function(){var e=this.model;return e.has("content")&&"<p><br></p>"!==e.get("content")?{class:"description content-body",html:e.get("content",{stripTags:!0})}:""},getOriginalNameDetails:function(){var e,t=this.model;return t.get("orig_name")?(e=a.prettySize(t.get("size")),{label:{class:"media-details-label",html:i.FileDetails},value:{html:"1"===t.get("download_original_file")||"document"===t.get("media_type")?t.get("orig_name")+(e?" ("+e+")":""):t.get("orig_name")}}):{label:"",value:""}},getResolutionDetails:function(){var e=this.model;return"video"===e.get("media_type")||"picture"===e.get("media_type")?{label:{class:"media-details-label",html:i.Resolution},value:{html:e.get("width")+"x"+e.get("height")+(" ("+e.get("ratio")+")"||"")}}:{label:"",value:""}},getDurationDetails:function(){var e=this.model;return"video"!==e.get("media_type")&&"sound"!==e.get("media_type")||!e.get("duration")?{label:"",value:""}:{label:{class:"media-details-label",html:i.Length},value:{html:e.get("duration")}}},getRelatedPost:function(){var e=this.model;if(e.get("related_post_count")&&0!==e.get("related_post_count")&&e.get("related_post")){var t={class:"wraper_related_post",html:e.get("related_post").map(function(e){return{html:[{tag:"span",class:"fonticon fonticon-newspaper"},{tag:"a",class:"related-post-link","data-content-id":e.c_post_id,"data-content-type":"post","data-community-id":e.community_id,html:e.post_title.escapeHTML()}]}})};return[{class:"media-details-title",html:i.Relatedposts},t]}return""}})}),define("DS/SwymUIComponents/script/feature/core/ui-components/layout/layout-manager",["UWA/Core","UWA/Class/Options","DS/SwymUICore/script/lib/pub-sub","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUIComponents/script/feature/core/ui-components/layout/layout-definition","DS/WebappsUtils/Console"],function(e,t,i,n,o,s){"use strict";var a=0;return i.singleton(t,{_alreadyCleanedManager:null,_taggingContextManager:null,_realTimeEventManager:null,defaultOptions:{layoutView:null,pageModulesPath:null,resetLayout:!1},_createView:function(t,i,o,a,r,l){var c=this,d=e.extend({},this.getOption("viewsDefaultParams"));r.getChildView(t)||l.layoutPath!==n.getInstance().getLayoutPath()||(l=l||{},e.extend(d,a[t]),d&&d.Class?r.isDestroyed()||r.addChildView(t,d,{callback:function(e){var n=l.containerSelector?r.container.getElement(l.containerSelector):r.container,s=function e(t,i,n,o){var s;return 0===t?null:(s=n[i[t-1]])&&s.container&&o.contains(s.container)?s:e(t-1,i,n,o)}(o,i,r.getChildViews(),n);s?e.inject(s.container,"after"):e.inject(n,"top"),"function"==typeof l.callback&&l.callback.call(c,e,t),e.isVisible()&&c.dispatchEvent("onViewShow",[e])}}):s.warn("Child view definition is incorrect. The class is missing."))},_handleChildViewsVisibility:function(t,i,n,o,s){var r=t.getChildViews();i||(i={}),Object.keys(r).forEach(function(e){const t=r[e];i[e]?(t.show(),this.dispatchEvent("onViewShow",[t])):(t.hide(),this.dispatchEvent("onViewHide",[t]))},this),(o||Object.keys(i)).forEach(function(o,r,l){if(i[o]){var c,d,m,u=null,h=null,p=t.getChildViews()[o];p?s&&"function"==typeof s.callback&&("dummy-view"===p.name?t.addEventOnce("onChildViewAdd:"+o,function(e){s.callback.call(this,e,o)}.bind(this)):s.callback.call(this,p,o)):(c=s?e.extend({},s):{},n&&(m=n[o])&&(c.containerSelector=m.containerSelector,h=m.widthThreshold),e.is(h,"number")?(c.callback=function(){if(e.is(s.callback,"function"))return s.callback.apply(this,arguments)},d=this._createView.bind(this,o,l,r,i,t,c),!0!==(u=function(){if(document.body.getSize().width>h)return document.body.removeEvent("resize",u),d(),!0})()&&(document.body.addEvent("resize",u,!1,a),this.addEventOnce("onViewCreationRequest:"+o,d,this,!1,a),++a)):this._createView(o,l,r,i,t,c))}},this)},_onContextChange:function(){var e=n.getInstance(),t=e.getLayoutPath(),i=o.getNode(t),s=i.layoutDefinition;(!1===i.failedToFindRequestedNode||i.initialLayoutRoute.endsWith("/edit")||e.path.indexOf("/comment")>=0||e.path.indexOf("/reply")>=0||e.path.indexOf("/answer")>=0||e.path.indexOf("/message")>=0)&&this._handleChildViewsVisibility(this.options.layoutView,o.getRootViewsDefinition(t),s,null,{layoutPath:t,callback:function(e,i){var o=s[i];t===n.getInstance().getLayoutPath()&&this._handleChildViewsVisibility(e,o.views,null,o.viewsOrder,{layoutPath:t,containerSelector:o.viewsContainerSelector})}})},setTaggingContextManagerInstance:function(e){this._taggingContextManager=e},getTaggingContextManagerInstance:function(){return this._taggingContextManager},setRealTimeEventManager:function(e){this._realTimeEventManager=e},getRealTimeEventManager:function(){return this._realTimeEventManager},applyLayoutDefinition:function(t){var i=this;if(!t.pageModulesPath)throw new Error("Root path of page modules is required");this.setOptions(t),o.getTree({pageModulesPath:this.options.pageModulesPath,reset:this.options.resetLayout,callback:function(){e.extendElement(document.body),e.is(t.layoutSetupFunction,"function")&&t.layoutSetupFunction.call(),n.getInstance().addListener("onContextChange",i._onContextChange,i,!0)}})},clean:function(){this._alreadyCleanedManager||(this.removeEvents(),this.stopListening(),delete this.options,n.getInstance().removeListener("onContextChange",this._onContextChange),this._taggingContextManager=null,this._realTimeEventManager=null,this._alreadyCleanedManager=!0)}})}),define("DS/SwymUIComponents/script/feature/core/ui-components/list/list-item/item-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUIComponents/script/feature/core/ui-components/layout/layout-manager"],function(e,t,i,n){"use strict";var o={UNDEFINED:-1,SUMMARY:0,DETAILED:1,EDIT:2},s={SUMMARY:"summaryView",DETAILED:"detailedView",EDIT:"editView"},a=function(e,t){void 0!==this.getOption(t)&&(e[t]=this.getOption(t))},r=i.extend({name:"dummy-item-view",_createContent:function(){return e.createElement("div",{class:"dummy-content-view",html:[{tag:"div",class:"dummy-content-header"},{tag:"div",class:"dummy-content-author-picture"},{tag:"div",class:"dummy-content-author-section"},{tag:"div",class:"dummy-content-line"},{tag:"div",class:"dummy-content-line"},{tag:"div",class:"dummy-content-line"},{tag:"div",class:"dummy-content-line"}]})}}),l=["comments","showAnswers","ActionMenuClass","iconCls","socialToolbarMode","showAuthorSection","showThreadLink","onAfterSocialToolbarRendered"];return t.extend({MODES:o,defaultOptions:{iconCls:"",mode:o.UNDEFINED,summaryViewClass:"DS/SwymUIComponents/script/feature/community/content/view/content-summary-view",detailedViewClass:"DS/SwymUIComponents/script/feature/community/content/view/content-detailed-view",editViewClass:"DS/SwymUIComponents/script/feature/community/content/edit/content-editor-view",summaryViewOptionsAttributes:l,detailedViewOptionsAttributes:l,editViewOptionsAttributes:["iconCls"],summaryViewEvents:void 0,detailedViewEvents:void 0,editViewEvents:void 0,comments:!0,showAnswers:!0},name:"content-in-feed-view",getClassNames:function(){var e=this._parent.apply(this,arguments)||"";return e+=" community-content-wrapper content-item "+(this.model?this.model.getIconWrapperClass():"")},_createSummaryView:function(){var e=this.model,t=this,i=null,n={Class:this.getOption("summaryViewClass"),model:e};return this.getOption("summaryViewOptionsAttributes").forEach(function(e){a.call(t,n,e)}),void 0!==this.getOption("summaryViewEvents")&&(n.events=this.getOption("summaryViewEvents")),e&&(i=this.addChildView("summaryView",n)),i},_createDetailedView:function(){var e=this.model,t=this,i=null,n={Class:this.getOption("detailedViewClass"),model:e};return this.getOption("detailedViewOptionsAttributes").forEach(function(e){a.call(t,n,e)}),void 0!==this.getOption("detailedViewEvents")&&(n.events=this.getOption("detailedViewEvents")),e&&(i=this.addChildView("detailedView",n)),i},_createEditView:function(){var e=this.model,t=this,i=null,n={Class:this.getOption("editViewClass"),model:e};return e&&(this.mask(),this.getOption("editViewOptionsAttributes").forEach(function(e){a.call(t,n,e)}),void 0!==this.getOption("editViewEvents")&&(n.events=this.getOption("editViewEvents")),i=this.addChildView("editView",{Class:"DS/SwymUICore/script/lib/view/generic/swym-view"}),e.fetch({fromCache:"wiki"!==this.model.getModelName(),onComplete:function(){t.unmask(),t.addChildView("editView",n)},onFailure:function(){t.unmask()}})),i},onRedraw:function(){this.isMasked()&&this.mask()},_createContent:function(){if(this.model)switch(this.getOption("mode")){case o.DETAILED:return this._createDetailedView();case o.EDIT:return this._createEditView();case o.SUMMARY:default:return this._createSummaryView()}},_switchToModeView:function(e){var t,i,n;const a=this;if(this.getOption("mode")===o[e])return!1;if(this.setOption("mode",o[e]),this.model&&!this.model.isNew()&&"wiki"==this.model.getModelName()&&"EDIT"===e&&this.model.fetch({onComplete:function(){a.refresh()}}),this._rendered){for(var r in n=s[e],i=this.getChildView(n),s)Object.prototype.hasOwnProperty.call(s,r)&&r!==n&&(t=this.getChildView(s[r]))&&t.hide();i||(i=this._createContent()),this.container.contains(i.container)||i.inject(this.container),i.show(),i.refresh()}else this.render();return this},switchToDetailedView:function(e){(this._switchToModeView("DETAILED")||e)&&(this.container.removeClassName("edit-mode"),this.container.addClassName("full-content"),n.dispatchEvent("onSetInstanceTagsRequest",[this.model]))},switchToEditView:function(e){(this._switchToModeView("EDIT")||e)&&(this.container.addClassName("edit-mode"),this.container.addClassName("full-content"),n.dispatchEvent("onSetInstanceTagsRequest",[this.model]))},switchToSummaryView:function(){this._switchToModeView("SUMMARY")&&(this.container.removeClassName("edit-mode"),this.container.removeClassName("full-content"))},onUnMaximize:function(){this.switchToSummaryView()},createDummyView:function(){return new r}})}),define("DS/SwymUIComponents/script/feature/core/ui-components/list/item-list",["UWA/Core","UWA/Event","UWA/Array","UWA/Class/View","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUIComponents/script/utils/scrollview-utils","DS/SwymUIComponents/script/feature/core/ui-components/layout/layout-manager","DS/SwymUIComponents/script/utils/dnd-utils","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/utils","DS/UIKIT/Spinner","DS/SwymUIComponents/script/feature/core/ui-components/list/dynamic-grid","DS/SwymUICore/script/feature/core/context/context-model","i18n!DS/SwymUIComponents/assets/nls/feature/community/generic/view/item-list"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h){"use strict";var p=null,g={layout:"small",offset:25,verticalOffset:25,align:"left"};return o.extend({name:"item-list",className:"item-list fade-in-animation",_containerWidth:null,_delegateSpriteReloadToParentView:!1,_onlyBodyUpdateOnIncrementalRefresh:!0,_toBeTemporarilyRemovedFromDomOnRefresh:!1,_linkGeneration:!0,_collectionEvents:{onRequest:"_onRequest",onSync:"_onSync","onSync:read":"_refreshIfEmpty","onSync:filter":"unmask","onError:filter":"unmask",onServerFilteringRequest:"_onServerFilteringRequest",onRemove:"_removeModelView"},_modelsBeforeCommentCallMutualizerDiff:null,_nbCommentCallsToMutualize:0,_removeModelView:function(e){},itemViewSelector:"",defaultOptions:{maximizeItemViewOnSelection:!1,debounceDelay:50,mutualizeCommentsInitCalls:!1,commentCallMutualizerOptions:null,sendCollectionTagsToTagger:void 0,commentsNumberAtInit:2},domEvents:{resize:"_onResize"},_refreshIfEmpty:function(){this.collection&&0===this.collection.length&&this.refresh()},setup:function(e){this.view=e.view||n,e.useDynamicGrid&&(this._useDynamicGrid=e.useDynamicGrid),this._dynamicGridOptions=this.getOption("dynamicGridOptions")||{},this._dynamicGridOptions.handledView=this,this._dynamicGridOptions.modelViewsAsItems=!0,this.newItems=[],this._useDynamicGrid&&(this._syncGrid=c.debounce(this._syncGrid,this.options.debounceDelay)),this._parent.apply(this,arguments);var t=this;t.reactTo(a,{onPullToRefresh:t.onPullToRefresh.bind(t),onInfiniteScroll:t.onInfiniteScroll.bind(t),GetItemListCollection:function(){t.isVisible()&&(t.collection?a.dispatchEvent("ReturnItemListCollection",t.collection):t.addEventOnce("onSetCollection",function(){a.dispatchEvent("ReturnItemListCollection",t.collection)}))}})},modelViewsCfg:function(){var t={};return this._useDynamicGrid?{attributes:e.extend(t,{styles:{opacity:"0"}})}:{attributes:t}},_getNbCommentCallsToMutualize:function(){return this._nbCommentCallsToMutualize},_onRequest:function(e,t,i){e===this.collection&&(i&&!0===i.reset&&(this.requestInfiniteScrollActivation(),e.hasBeenFetched()&&this.mask()),this._modelsBeforeCommentCallMutualizerDiff=this.collection.toArray())},_onSync:function(t){var i,n=this,o=this._modelsBeforeCommentCallMutualizerDiff,s=function(){i>0&&p.openCallWindow(e.extend({nbInitCallsToMutualize:i,tenantId:l.getInstance().get("config").tenant.online_instance_id,serviceUrl:l.getInstance().get("3dcommentUrl")||c.getBaseUrl(),commentsNumberAtInit:n.getOption("commentsNumberAtInit")},n.getOption("commentCallMutualizerOptions")))};t===this.collection&&!0===this.getOption("mutualizeCommentsInitCalls")&&(i=0,this.collection.forEach(function(e){"survey"!==e.getModelName()&&o&&-1===o.indexOf(e)&&++i}),this._nbCommentCallsToMutualize=i,this._modelsBeforeCommentCallMutualizerDiff=this.collection.toArray(),i>0&&(p?s():require(["DS/SocialToolbar/CallMutualizer"],function(e){p=e,s()}))),this.unmask()},_onServerFilteringRequest:function(){var e=u.getInstance(),t=this.collection.exaleadFilters.length>0||"#all"!==this.collection.exaleadQuery;e.dispatchEvent("onFilteringChange",[t],!0),a.dispatchEvent("onScrollToTopRequest")},_getIncrementallyCreatedModelViewContainer:function(e,t){var i=this.container&&this.container.getElements(".container-column")||[];return i.length>0?i[t%i.length]:this._parent.apply(this,arguments)},_createContent:function(){var t,i,n,o=u.getInstance(),s=this.collection,r={padding:"30% 0","text-align":"center",width:"100%"};if(s)return 0===s.length?s.hasBeenFetched()?(n="filter"===s.lastCalledService?h.NoSearchResultToDisplay:"mixed-collection"===s.getCollectionName()?(o.isDirectMessageContext()?h.EngageConversation:h.Engage)+"</br></br>"+h.Start:h.ThereIsNothingToDisplayYet,t=e.createElement("div",{class:"dsi-noresult",styles:r,html:{tag:"span",styles:{color:"#B4B6BA","font-size":"16px"},html:n}}),"mixed-collection"===s.getCollectionName()&&a.dispatchEvent("onCommunityWhatsnewEmpty")):((i=this.addControl("spinner",new d)).show(),i.getContent().setStyles(r),t=i):t=this._parent.apply(this,arguments),t},onPullToRefresh:function(e){this.isVisible()&&this.collection&&s.onPullToRefresh.apply({collection:this.collection,scrollView:e})},onInfiniteScroll:function(e){this.isVisible()&&this.collection&&s.onInfiniteScroll.apply({collection:this.collection,scrollView:e})},hasStructureDummyViews:function(e){var t=Object.keys(e._childViews),i=t.length,n=!1,o=null;if(e===this&&(i=(t=t.slice(-e.collection.getLimit())).length),0===i&&"dummy-view"===e.name)n=!0;else for(var s=0;s<i;s++)o=e.getChildView(t[s]),n=n||this.hasStructureDummyViews(o);return n},_updateBodyCompletelyWithModelViews:function(){this._parent.apply(this,arguments),!0===this._useDynamicGrid&&this._syncGrid()},_updateBodyIncrementalyWithModelViews:function(){this._parent.apply(this,arguments),!0===this._useDynamicGrid&&this._syncGrid({incrementalUpdateForExistingColumns:!0})},_syncGrid:function(t){if(!0!==this._useDynamicGrid){if(this.hasStructureDummyViews(this))return setTimeout(function(){this._syncGrid(t)}.bind(this),100),!1;if(0===Object.keys(this._childViews).length)return!1}var i=this.container,n=function(e){e&&e.length>0&&e.forEach(function(e){e.setStyle("opacity",1)})};i&&(this.dyngrid?(this.dyngrid.fetchItems(),this.dyngrid.render(!1,n,t)):(this.dyngrid=new m(i,e.merge(this._dynamicGridOptions,g)),this.collection&&this.collection.addEvent("onReset",this.dyngrid.setCollectionHasBeenReset.bind(this.dyngrid,!0)),this.addEvent("onSetCollection",this.dyngrid.setCollectionHasBeenReset.bind(this.dyngrid,!0)),this.dyngrid.render(!1,n,t)))},_onResize:c.debounce(function(){var e=this.container?this.container.getSize().width:null,t=document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled;this._useDynamicGrid&&e&&!t&&(this._containerWidth!==e?(this._syncGrid(),this._containerWidth=e):this._syncGrid({incrementalUpdateForExistingColumns:!0}))},200),requestInfiniteScrollActivation:function(){a.dispatchEvent("onInfiniteScrollActivationRequest")},onItemSelect:function(e,t){e&&(this.setOption("selectedItemView",e),e.dispatchEvent("onItemSelect",[t]),this.options.maximizeItemViewOnSelection&&(e.listenToOnce(this,"onUnMaximize",function(){e.dispatchEvent("onUnMaximize")}),this.maximize(this)))},onItemClick:function(e){var n,o,s;if(this.itemViewSelector){if(s=t.getElement(e),window.getSelection().toString().length>0)return null;if(s&&e&&e.target&&e.target.tagName&&"a"!==e.target.tagName.toLowerCase())e.preventDefault(),e.stopPropagation(),o=s.getClosest(this.itemViewSelector),n=this.getModelViews?i.detect(this.getModelViews(),function(e){return e.container===o}):this,this.dispatchEvent("onItemSelect",[n,{event:e}]);else if(s&&e&&e.target&&e.target.tagName&&"a"===e.target.tagName.toLowerCase()){if(window.ds&&window.ds.env&&"3DD"===window.ds.env)return e.preventDefault(),e.stopPropagation(),"external"===e.target.getAttribute("data-type")&&window.open(e.target.href,"_blank"),null;if(e&&e.target&&"internal"===e.target.getAttribute("data-type"))return e.stopPropagation(),null}}},onItemDragStart:function(e){var n,o,s;this.itemViewSelector&&(s=t.getElement(e))&&(o=s.getClosest(this.itemViewSelector),n=this.getModelViews?i.detect(this.getModelViews(),function(e){return e.container===o}):this,this.dispatchEvent("onItemDrag",[n,e,this._widget]))},onItemDrag:function(e,t){var i=e.model;r.onItemDrag(i,t,this._widget)},maximize:function(){a.dispatchEvent("onMaximizeRequest",arguments)},unMaximize:function(){a.dispatchEvent("onUnMaximizeRequest",[this])},createItemView:function(e){return this._createModelView(e)},sendCollectionTagsToTagger:function(){!1!==this.options.sendCollectionTagsToTagger&&a.dispatchEvent("onSetInstanceTagsRequest",[this.collection,this.options.taggerSuffix])},show:function(){this.container&&(this.requestInfiniteScrollActivation(),this.container.addClassName("fade-in-animation")),this._parent.apply(this,arguments)},onUnMaximize:function(){this.setOption("selectedItemView",null)},onSetCollection:function(){return this.sendCollectionTagsToTagger(),this._parent.apply(this,arguments)},onShow:function(){return this.sendCollectionTagsToTagger(),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/content/view/author-section-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/utils/date","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUIComponents/script/feature/community/content/view/content-small-view-factory","DS/UIKIT/Tooltip","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/view/abstract-content-view","DS/SwymUICore/script/utils/i18n","DS/SwymUIComponents/script/feature/core/user/view/user-picture-view","DS/SwymUICore/script/constants/community-constants","DS/WebappsUtils/Console","DS/SwymUIComponents/script/feature/community/content/view/sort-by-latest-view","DS/SwymUICore/script/utils/utils"],function(e,t,i,n,o,s,a,r,l,c,d,m,u){return t.extend({name:"content-author-section",_modelEventsForAutoRefresh:["onSync","onChange:author","onChange:community","onChange:originalAuthor"],_getAuthorPicture(e){var t=e.getAuthor();return t.get("login")&&this.addChildView("userPicture",{tagName:"span",Class:l,model:t,imageRenderingOptions:{format:"normal"}})},_getPeopleLink(t){var i=t.getAuthor();return e.createElement("a",{tag:"a",class:"link","data-content-type":"person","data-login":"9"===t.get("ut_state")?"anonymous":i.get("login"),html:i.getNickname()})},_getAuthorView(t){return e.createElement("span",{class:"content-detail-author",html:[`${a.by} `,this._getPeopleLink(t)]})},_getThreadLink(t){var i=t.getCommunity();return i&&i.get("title")&&!1!==this.getOption("showThreadLink")&&!i.isDirectMessage()?e.createElement("span",{class:"content-detail-thread",html:{tag:"a",class:"link","data-content-type":"community","data-content-id":i.get("mid"),html:`<span class="fonticon fonticon-expand-right"></span>${i.get("title")}`}}):""},_getActivityDate(t){var n=t.get("update")&&"wiki"===t.getModelName(),o=t.get("update")&&"wiki"===t.getModelName();return e.createElement("span",{class:"content-detail-activity-date",html:(o?`${a.LastUpdate}:`:"")+i.prettyDate(n&&t.get("update")||t.getPublishingDate())})},_sortByLatestModeView(){let e;return e="simple"===this.mode?[this._getPeopleLink,this._getActivityDate]:"multiContributors"===this.mode?[this._getMultiContributorsView,this._getThreadLink,this._getActivityDate,this._getModificationDate]:[this._getAuthorPicture,this._getAuthorView,this._createSortByLatestSection]},_createSortByLatestSection(){return this.addChildView("sortByLatestView",new m({model:this.model,sortMode:this.getOption("sortMode")}))},_getModificationDate(t){var i,n=t.get("moderation_status"),o="updated_by_author"===n?a.Edited:"updated"===n?a.Moderated:null;return i=o?e.createElement("span",{class:"content-detail-moderation-status",html:`- ${o}`}):{},o&&this._addModerationTooltip(t,i),i},_getMultiContributorsView(t){var i=e.createElement("span",{class:"multi-contributors fonticon fonticon-users"});return this.getChildView("nbContributors")&&this.removeChildView("nbContributors"),[i,e.createElement("span",{class:"content-detail-author",html:[`${a.by} `,this.addChildView("nbContributors",{Class:o.getViewClass("nbContributors"),model:t})]})]},_addModerationTooltip(e,t){var n=e.get("moderation_status"),o="updated_by_author"===n?a.EditedTooltip:"updated"===n?a.ModeratedTooltip:null;this.addControl("moderation-status-tooltip",new s({target:t,body:r.replace(o,{prettyDate:i.prettyDate(e.get("moderation_date"))}),position:"bottom"}))},_getOriginalAuthorLink(){const t=this.model.has("originalAuthor")&&this.model.getAssociated&&this.model.getAssociated("originalAuthor");return t&&!t.isNew()&&t.get("ds6w:resourceUid")!==this.model.getAuthor().get("ds6w:resourceUid")&&"wiki"!==this.model.getContentType()?e.createElement("div",{class:"original-author-link",html:[{html:a.ForwardedFrom},{tag:"a",class:"link","data-content-type":"person","data-login":"9"===this.model.get("ut_state")?"anonymous":t.get("login"),html:t.getNickname()}]}):""},setup(e){this.mode=e.mode,this.isSortByLatestMode=this.getOption("sortMode")===c.CTY_CONTENT_LIST_SORT_MODE.LATEST_CONTRIBUTIONS_DATE&&!this.getOption("contentId"),this._parent.call(this,e)},_createContent(){var{model:e}=this;return[{class:"author-left-section",html:(this.isSortByLatestMode?this._sortByLatestModeView():"simple"===this.mode?[this._getPeopleLink,this._getActivityDate]:"multiContributors"===this.mode?[this._getMultiContributorsView,this._getThreadLink,this._getActivityDate,this._getModificationDate]:[this._getAuthorPicture,this._getAuthorView,this._getThreadLink,this._getActivityDate,this._getModificationDate]).map(function(t){return t.apply(this,[e])}.bind(this))},this._getOriginalAuthorLink()]}})}),define("DS/SwymUIComponents/script/feature/community/wiki/view/wikitree-view",["UWA/Core","UWA/Element","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/wiki/model/wikitree-model","DS/SwymUICore/script/feature/community/wiki/model/wiki-model","DS/SwymUICore/script/utils/utils","i18n!DS/SwymUIComponents/assets/nls/feature/community/wiki/view/wikitree-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/wiki/edit/wiki-creator-view","DS/Controls/Tree","DS/Controls/TreeBase","DS/Controls/TreeNode","DS/SwymUIComponents/script/feature/core/ui-components/controls/wikitree-node","DS/UIKIT/Alert","DS/SwymUICore/script/feature/core/error/error","DS/Logger/Logger","DS/WebappsUtils/WebappsUtils","DS/UIKIT/Spinner","DS/UIKIT/Scroller","DS/UIKIT/Tooltip","DS/SwymUICore/script/constants/community-constants"],(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w,C,f,y)=>{const v=".wux-treenode-label";function A(e){let t;if(e instanceof HTMLElement&&!e.getData("tooltip")&&!e.getElement(v))return t=e.getText(),p.log("nodeText",t),e.setData("tooltip","true"),new f({target:e,body:t.escapeHTML()})}const _={switchToWriteView:{event:"dblclick",callback(){this.switchToWriteView()},view:e=>new t("div",{class:"wux-tree-label",html:e.getLabel()})},switchToReadView:{event:"blur",callback(){this.switchToReadView()},view:e=>new t("div",{class:"wux-tree-label",html:e.getLabel()})},nodesAreDraggable:!0,cells:!0},S={class:"NoExpander Link",text:"",styles:{backgroundColor:"transparent",borderTop:"1px none #F66",cursor:"pointer",zIndex:1e3}};return i.extend({_modelClass:n,_modelEvents:{onRequest:"mask",onSync(){this.refresh(),this.unmask()},onError:"unmask",onModelUpdated:"onModelUpdated",onCurrentPageChange:"onCurrentPageChange"},_addScrollerVertical:!1,_scrollerContentSelector:".wikitree-wrapper",_currentSubject6wuri:null,domEvents:{"dragover .WUXTree":"_onWikiTreeDragOver",drop:"_onDrop"},_onDrop(t){const i=e.Utils.Client.Engine.firefox,n=window.ds&&"3DSwym"===window.ds.env;i&&n&&t.preventDefault&&t.preventDefault()},name:"wikitree-view",treeData:null,treeEl:null,currentNode:null,currentPageId:null,_wikiTreeWrapper:null,_wikiTreeScroller:null,globalNodeArr:null,facetView:!1,on3DDPlusClicked(){},state:null,editable:!1,creation:!1,disableNavigationOnNodeSelection:!1,disablePrivatePage:!1,_moveOnlyCurrentNode:!1,_privateNodes:[],creationModeLastNode:null,creationModeDragNdropTempNode:!1,creationModeDragNdropTargetNode:null,creationModeTempNodeTitle:"",creationModeTempNodeTooltip:"",creationModeTempNodeTooltipEl:null,creationModeTempNodeIcon:"<span class='fonticon fonticon-pencil'></span> ",currentNodeTooltipEl:null,ui:{expander:{size:10,borderSize:1},icon:{size:20},shadow:!1,link:{size:1,color:"#F66",bgColor:"white",style:"none"},label:{borderRadius:10,"font-size":"11px","font-family":"arial,tahoma,helvetica,sans-serif",color:"#77797C","font-weight":"normal","margin-right":"5px","margin-left":"5px"},layout:{nodeMargin:20,btMargin:2,lrMargin:0},asyncState:{class:"Expander",html:"",styles:{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",zIndex:1e3}},noExpandState:S},_onWikiTreeDragOver(e){const t=e.event||e;if(t.stopPropagation&&t.stopPropagation(),this.editable)return t.preventDefault&&t.preventDefault(),t.dataTransfer.dropEffect="move",!1},createTooltipForNode(e){let t=A(e.elements.container.getElement(v));e.options.id===y.TEMP_ID.TEMP_NODE_ID&&(this.creationModeTempNodeTooltipEl=t),e.options.id===this.currentPageId&&(this.currentNodeTooltipEl=t)},onNodeExpand(e){const t=e.getChildren(),i=e.elements.container,n=!this._moveOnlyCurrentNode&&this.editable,o=this;this.changeSubNodesDraggability(i,n),t&&t.forEach(e=>{e.elements.container.getElement(v)&&o.createTooltipForNode(e)})},_createNode(e,t,i){let n;const o=this;return e&&!e.onPostExpand&&(e.onPostExpand=function(){o.onNodeExpand(this)}),e&&!e.onPostCollapse&&(e.onPostCollapse=function(){}),i&&e.id===i?(n=new m(e),this.setCurrentNode(n,!0)):n=new m(e),Array.isArray(this.globalNodeArr)&&this.globalNodeArr.push(n),n},_createTree(e,t){let i;const n=this;return e&&!e.onPostExpand&&(e.onPostExpand=function(){n.onNodeExpand(this)}),i=new c({roots:[e],UI:t,isEditable:!!this.editable&&_,isScrollable:!1,nodeClass:m}),this.setCurrentNode(i._treeRoot.getChildren()[0],!0),Array.isArray(this.globalNodeArr)&&this.globalNodeArr.push(i),i},_addDisableClass(){const e=this.treeEl._treeRoot.getAllDescendants();let t,i,n,o,s;for(let a=0;a<e.length;a++)(t=e[a].options.icons)&&((i=e[a].elements.container).addClassName("disabled"),(n=e[a].elements.expander)&&n.setStyle("pointer-events","none"),(o=e[a].elements.label)&&o.addClassName("disabled"),(s=e[a].elements.icons)&&s[0].addClassName("disabled"))},containsPrivatePage(){return this._privateNodes.length>0},toggleEdit(){this.editable=!this.editable,this.refresh()},init(e){e.editable&&(this.editable=e.editable),e.creation&&(this.creation=e.creation),e.disableNavigationOnNodeSelection&&(this.disableNavigationOnNodeSelection=e.disableNavigationOnNodeSelection),e.disablePrivatePage&&(this.disablePrivatePage=e.disablePrivatePage),e.moveOnlyCurrentNode&&(this._moveOnlyCurrentNode=e.moveOnlyCurrentNode),e.addVerticalScroller&&(this._addScrollerVertical=e.addVerticalScroller);const t={class:"Expander open",html:"",styles:{background:`url(${g.getWebappsBaseUrl()}SwymUIComponents/assets/wiki/arrows.png) no-repeat -19px -2px`,borderColor:"transparent",cursor:"pointer",zIndex:1e3,height:"20px"}},i={class:"Expander closed",html:"",styles:{background:`url(${g.getWebappsBaseUrl()}SwymUIComponents/assets/wiki/arrows.png) no-repeat -4px -2px`,borderColor:"transparent",cursor:"pointer",zIndex:1e3}};this.ui.expandState=i,this.ui.collapseState=t,this.globalNodeArr=[],this._parent.apply(this,arguments)},formatTree2(e,t,i){let n,o,s,a,r,l,c,d,m,u=e.length;const h=[],w=[];for(n=0;n<u;n++){if(o=e[n],c=parseInt(o.visibility,10),o={id:o.id,value:o.id,label:o.title,depth:o.depth,dfsLeftValue:o.dfs_left_value,dfsRightValue:o.dfs_right_value,UI:i},this.model.getCustomProperty("currentPage")&&(s=this.model.getCustomProperty("currentPage").get("mid")),1!==c&&(o.icons=[`${g.getWebappsBaseUrl()}SwymUIComponents/assets/wiki/privatepage.png`],this.disablePrivatePage&&this._privateNodes.push(o)),0===(d=parseInt(o.depth,10)))t?(o.children=[],w[d]=o):h[d]=this._createTree(o,i,s);else if(d===m+1)t?(o.children=[],w[d]=o):h[d]=this._createNode(o,i,s);else if(d===m)t?(a=w.pop(),(r=w[d-1]).children.push(a),o.children=[],w[d]=o):(a=h.pop(),(r=h[d-1]).addChild?r.addChild(a):r.getNthRoot(0).addChild(a),h[d]=this._createNode(o,i,s));else{if(!(d<m))throw console.error("currentDepth",d,"lastDepth",m),console.error("node error",o),new Error("Error in tree traversal");l=m;do{l--,t?(a=w.pop(),(r=w[l]).children.push(a)):(a=h.pop(),(r=h[l]).addChild?r.addChild(a):r.getNthRoot(0).addChild(a))}while(l>=d);t?(o.children=[],w[d]=o):h[d]=this._createNode(o,i,s)}m=d}if((u=t?w.length:h.length)>=2)for(n=u-1;n>0;)t?(a=w.pop(),(r=w[n-1]).children.push(a)):(a=h.pop(),(r=h[n-1]).addChild?r.addChild(a):r.getNthRoot(0).addChild(a)),n--;return t?(p.log("Tree Json Array: ",w),p.log("Tree: ",w[0]),w):(p.log("Tree Array: ",h),p.log("Tree: ",h[0]),h[0])},addChildRecursively(e,t){let i,n;const o=new m(e);if(t.addChild(o),e.children&&Array.isArray(e.children)&&(n=e.children.length)>0)for(i=0;i<n;i++)this.addChildRecursively(e.children[i],o)},_createContent(){const t=this;let i,n,o;const{model:s}=t;if(Array.isArray(t.globalNodeArr)&&(t.globalNodeArr=[]),s){if(s&&(n=s.get("tree")))return t.treeData=e.clone(n),t.treeData&&t.treeData.length>0&&t.treeData.forEach(e=>{e.title=e.title.escapeHTML()}),t.treeEl=t.formatTree2(t.treeData,!1,t.ui),p.log("Tree structure",t.treeData,t.treeEl.elements.container),t.creation?(this.creationModeLastNode=this.currentNode,this.insertTempNode(),p.log("-----------new treeEl in the create function",t.treeEl),o={class:"creation edition single",html:[{class:"wikitree-editable-text",html:r.Wheredoyouwanttoaddyourpage+" "+a.Youcandraganddropcurrentpage},t.treeEl]}):o=t.editable?{class:t._moveOnlyCurrentNode?"edition notOwner":"edition",html:[{class:"wikitree-editable-text",html:t._moveOnlyCurrentNode?" ":a.Reorganize},t.treeEl]}:t.treeEl,e.Utils.Client.Engine.ie?window.requestAnimationFrame(t._expandRootNode.bind(t)):t._expandRootNode(),t._wikiTreeWrapper=e.createElement("div",{class:"wikitree-wrapper",html:o}),t._wikiTreeWrapper.getElements(v).forEach(A),t._wikiTreeScroller=this.addControl(`scroller-${this.cid}`,new C({element:t._wikiTreeWrapper})),t.resetWikiTreeWrapperHeight(),this.disablePrivatePage&&this._privateNodes.length>0&&this._addDisableClass(),t._wikiTreeScroller;{const i=e.createElement("div",{html:new w({className:"msg-animation",visible:!0,animate:!0,spin:!0}),styles:{"text-align":"center",height:"60px","line-height":"60px"}});t._wikiTreeWrapper=e.createElement("div",{class:"wikitree-spinner-wrapper",html:i})}}else t._wikiTreeWrapper=e.createElement("div",{class:"wikitree-wrapper",styles:{height:"150px"}}),i=this.addControl("noCommunityAlert",new u({closable:!1,visible:!1,autoHide:!1,closeOnClick:!1,fullWidth:!0,messageClassName:"primary",messages:[a.PleaseSelectACommunity],renderTo:t._wikiTreeWrapper,events:{onInjected(){i.show()}}}));return t._wikiTreeWrapper},resetWikiTreeWrapperHeight(){const e=this;this._parentView&&setTimeout(()=>{try{const t=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0),i=Math.max(this._parentView.getElement(".revision-view-container")&&this._parentView.getElement(".revision-view-container").offsetHeight||-20);p.log("-=-=-=-view port height",t),p.log("-=-=-=-view revision height",i),e._wikiTreeScroller.getContent().setStyle("height",t-i-272)}catch(e){p.log("resetWikiTreeWrapperHeight",e)}},500)},_expandRootNode(){const e=this;let t,i;e.treeEl.getNthRoot(0).expand(),e.model.getCustomProperty("currentPage")&&e.currentNode&&(e.expandNode(e.currentNode),e.currentNode.elements&&((i=e.currentNode.elements.container)&&i.addClassName("current-node-wrapper"),(t=e.currentNode.elements.label)&&(t.setStyle("font-weight","bold"),t.setStyle("color","#3d3d3d"),t.addClassName("current-node"))))},onDrag(e){let t,i,n,o,a;(a=(t=(t=e.target||e.srcElement).hasClassName("Node")||t.hasClassName("Horizontal")?t:t.getParent(".Node.Horizontal")).getElement(".wux-treenode-label"))&&a.triggerEvent("mouseout"),!1===this.editable&&Array.isArray(this.globalNodeArr)&&(i=this.globalNodeArr.filter(e=>e.elements.container.getElement(".Node.Horizontal")===t))&&i.length>0&&(n=i[0]).options&&(n.options.id||n.options.roots&&n.options.roots.length>0&&n.options.roots[0].id)&&(o={protocol:"3DXContent",version:"1.0",source:s.getMyCommunitiesAppKey(),data:{items:[{envId:s.getTenantIdFromUrlPreference(window.widget),serviceId:"3DSwym",contextId:"",objectId:n.options.id||n.options.roots[0].id,objectType:"wiki"}]}},e.dataTransfer.setData("text",JSON.stringify(o)),p.log("wiki page dragData ---",o),window.widget&&(widget.dispatchEvent("ContentDragStarted",[o]),t&&t.addEvent("dragend",()=>{t.removeEvent("dragend"),widget.dispatchEvent("ContentDragEnded",[o])})))},setDraggable(e,t){e&&e.setAttribute&&e.setAttribute("draggable",!0===t?"true":"false")},changeSubNodesDraggability(e,t){const i=this;if(e.getElements(".Node.Horizontal").forEach(e=>{i.setDraggable(e,t)}),i.creation){const e=i&&i.searchTree(i.treeEl,y.TEMP_ID.TEMP_NODE_ID).elements;i.setDraggable(e.view,!0)}},resizeWikiTreeScroller(){const e=this,t=e.treeEl.elements.container.getSize().height;setTimeout(()=>{!0!==e._addScrollerVertical&&0!==t&&e._wikiTreeScroller.getContent().setStyle("height",`${t+50}px`)},15)},onRedraw(){const t=this;let i;if(t.treeEl&&(i=t.treeEl.elements.container,setTimeout(()=>{if(t.creation){const e=t&&t.searchTree(t.treeEl,y.TEMP_ID.TEMP_NODE_ID).elements;t.setDraggable(e.view,!0),i.addEvent("dragstart .Node.Horizontal",t.onDrag.bind(t))}else t.editable&&!t._moveOnlyCurrentNode?t.changeSubNodesDraggability(i,!0):(t.changeSubNodesDraggability(i,!1),i.setAttribute("ondragstart","return false"))},0),t.treeEl.onNodeClick(e=>{t.expandNode(e),t.resetWikiTreeWrapperHeight(),t.editable||t.creation||t.disableNavigationOnNodeSelection?t.disableNavigationOnNodeSelection&&t.setCurrentNode(e,!0):t.setCurrentNode(e)}),t.treeEl.onNodePostDrop(function(e){const i=e.from;t.onNodePostDrop.call(t,{from:i,to:this})}),t.currentNode&&t.currentNode.elements&&t.currentNode.elements.container&&!e.Utils.Client.Engine.ie11)){t.currentNode.elements.container.scrollIntoView(!1)}},insertTempNode(){this.editable=!0,this._moveOnlyCurrentNode=!0;const e=this,t=y.TEMP_ID.TEMP_NODE_ID;let i,n=0,o=0,s=this.creationModeLastNode.options;this.creationModeDragNdropTempNode?(s=this.creationModeDragNdropTargetNode.options,p.log("-=-=-target node: ",s),p.log("-=-=-old tree data: ",e.treeData),i=e.treeData.findIndex(e=>{if(e.id===s.id)return!0}),"above"===this.dragNdropTargetPos?(n=s.depth,o=i=e.treeData.findIndex(e=>{if(e.id===s.id)return!0})):"below"===this.dragNdropTargetPos?(n=s.depth,o=i=e.treeData.findIndex(e=>{if(e.dfs_left_value===s.dfsRightValue)return!0}),i<1&&(o=(i=e.treeData.findIndex(e=>{if(e.id===s.id)return!0}))+1)):"append"===this.dragNdropTargetPos&&(n=s.depth+1,i=e.treeData.findIndex(e=>{if(e.id===s.id)return!0}),o=this.calculateTempNodePosition(i,s)),p.log("-=-=-temp node title: ",this.creationModeTempNodeTitle),this.creationModeDragNdropTempNode=!1):(i=e.treeData.findIndex(e=>{if(e.id===s.id)return!0}),this.creationModeTempNodeTitle=(this._parentView.getTitleValue()||"").escapeHTML(),n=s.depth+1,o=this.calculateTempNodePosition(i,s)),p.log("-=-=-target index: ",o),p.log("-=-=-target depth: ",n);const a={id:t,title:this.creationModeTempNodeIcon+this.creationModeTempNodeTitle,depth:n,visibility:1};e.treeData.splice(o,0,a);const r=e.treeData;p.log("-=-=-the new tree==-=-: ",r),e.treeEl=e.formatTree2(r,!1,e.ui);const l=this.searchTree(this.treeEl,y.TEMP_ID.TEMP_NODE_ID);this.setCurrentNode(l,!0)},calculateTempNodePosition(e,t){const i=this;let n=e+1;if(0===e)n=i.treeData.length;else{const e=i.treeData.slice(n);if(e.length>0)for(let o=0;o<e.length;o++){if(e[o].depth<=t.depth){n=i.treeData.findIndex(t=>{if(t.id===e[o].id)return!0}),p.log("=-=-=-=-target index",n);break}n=i.treeData.findIndex(t=>{if(t.id===e[o].id)return!0}),n+=1,p.log("=-=-=-=-target index",n)}}return n},onContentTitleChange(e,t){this._parent.apply(this,arguments),this.creationModeTempNodeTitle=e.escapeHTML();const i=this&&this.searchTree(this.treeEl,y.TEMP_ID.TEMP_NODE_ID);if(i&&(i.setLabel(this.creationModeTempNodeIcon+this.creationModeTempNodeTitle),this.creationModeTempNodeTooltipEl.setBody(this.creationModeTempNodeTitle)),t){const e=this.searchTree(this.treeEl,t);e&&(e.setLabel(this.creationModeTempNodeIcon+this.creationModeTempNodeTitle),this.currentNodeTooltipEl&&this.currentNodeTooltipEl.setBody(this.creationModeTempNodeTitle))}},onNodePostDrop(e){const t=e.from;let i=e.to;const n=t.options.dfsLeftValue,s=t.options.dfsRightValue,a=i.options.dfsLeftValue,r=i.options.dfsRightValue,l=i.getParent().getChildren().indexOf(i);let c=-1,d=null;p.log("droppedNode",t.options.label,t.options.id),p.log("refNode",i.options.label,i.options.id),p.log("refNode",i),p.log("refNodeIndex",l);const m=this.treeEl.getRoots();if(m&&m.length>0){if(1!==m.length)return 0===c?(h.displayError("Apagecannotbeaddedabovethewikirootpage"),void this.refresh()):(h.displayError("Apagecannotbeaddedatthesamelevelofthewikirootpage"),void this.refresh());if((c=i.getParent().getChildren().indexOf(t))>=0)c===l-1?d="above":c===l+1?d="below":(p.log("Dropped node is neither above nor below the reference node"),p.log("Changing reference node... "),c===i.getParent().getChildren().length-1?c>0&&(i=i.getParent().getNthChild(c-1),d="below"):c<i.getParent().getChildren().length-1&&(i=i.getParent().getNthChild(c+1),d="above"),p.log("NEW refNode",i.options.label,i.options.id));else if(i.getChildren()&&(c=i.getChildren().indexOf(t))>=0)d="append";else{if(!(a>n&&r<s))throw new Error("Dropped node is neither in the siblings or the children of the ref node");h.displayError("Apagecannotbemovedtoitsdescendant"),this.refresh()}}else{if(0!==n||1!==s)throw new Error("No root node found for this wiki tree");h.displayError("Apagecannotbemovedtoitsdescendant"),this.refresh()}if(p.log("droppedNodeIndex",c),p.log("dropPos",d),c>-1&&null!==d)if(a>n&&r<s)h.displayError("Apagecannotbemovedtoitsdescendant"),this.refresh();else{if(t.options.id===y.TEMP_ID.TEMP_NODE_ID)return p.log("...all infos about drop node...",t,d,i),this.dragNdropTargetPos=d,this.creationModeDragNdropTargetNode=i,p.log("...drop target node...",this.creationModeDragNdropTargetNode),this.creationModeDragNdropTempNode=!0,void this.refresh();new o({mid:t.options.id}).action("move",{data:{id:t.options.id,relation:d,targetid:i.options.id}})}},setCurrentNode(e,t){let i,n;this.currentNode&&!this.currentNode.options||(this.currentNode&&this.currentNode.elements&&((n=this.currentNode.elements.container)&&n.removeClassName("current-node-wrapper"),(i=this.currentNode.elements.label)&&(i.setStyle("font-weight","normal"),i.setStyle("color","#77797C"),i.removeClassName("current-node"))),e&&(this.currentNode=e,this.currentPageId=e.options.id,this._currentSubject6wuri=this.model&&this.model.getSubject6wuri(this.currentPageId),p.log("Changed current node to ",e),this.currentNode.elements&&((n=this.currentNode.elements.container)&&n.addClassName("current-node-wrapper"),(i=this.currentNode.elements.label)&&(i.setStyle("font-weight","bold"),i.setStyle("color","#3d3d3d"),i.addClassName("current-node"))),!0!==t&&this.model.setCurrentPage(this.currentPageId,!0),this.currentPageId===y.TEMP_ID.TEMP_NODE_ID?this.dispatchEvent("currentPageChange",{id:this.currentNode._parentNode.options.id||this.currentPageId,isPrivate:Boolean(e.options.icons),dontSetModel:t}):this.dispatchEvent("currentPageChange",{id:this.currentPageId,subject6wuri:this._currentSubject6wuri,isPrivate:Boolean(e.options.icons),dontSetModel:t}),setTimeout(()=>{this.currentNode.elements.container.scrollIntoView(!1)},600)))},expandNode(e){const t=[];let i,n;for(;e&&!e.options.isRoot&&!e.isExpanded();)t.push(e),e=e.getParent();for(i=t.length;i>0;)(n=t.pop()).expand(),i--},searchTree(e,t){let i,n,o,s=!1;if(e){const a=e.getRoots(),r=a.length;for(n=0;n<r;n++)if(i=a[n],o=this.searchSubtree(i,t)){s=o;break}}return s},searchSubtree(e,t){let i,n,o,s,a=!1;if(!t||!e)throw new Error("Incorrect parameters provide to search tree");if(e.options&&e.options.id&&e.options.id===t)a=e;else if((o=e.getChildren())&&(n=o.length)>0)for(i=0;i<n&&(s=o[i],!(a=this.searchSubtree(s,t)));i++);return a},onCurrentPageChange(e){let t,i;const n=this.treeEl;n&&e&&e.id&&this.currentPageId!==e.id&&((t=this.searchTree(n,e.id))?(this.expandNode(t),this.setCurrentNode(t,!0)):p.log("Current page node not found")),window.ds&&"3DD"===window.ds.env&&e&&e.id&&(i=new o({id:e.id}),this.dispatchEvent("onItemViewSelect",[null,{model:i}]))},selectItemView(e){p.log("in selectItemView",e),(!this.currentPageId||this.currentPageId!==e||"object"==typeof e&&this.currentPageId!==e.get("mid"))&&this.model.setCurrentPage(e)},onModelUpdated(e,t,i){let n,o;e&&this.currentNode&&this.currentPageId&&this.currentPageId===e.get("mid")&&i&&"object"==typeof i.data&&(void 0!==(o=i.data).title?this.onCurrentPageTitleUpdated(o.title.escapeHTML()):this.currentNode.getLabel()!==e.get("title")&&this.onCurrentPageTitleUpdated(e.get("title")),void 0!==o.visibility&&(n=parseInt(o.visibility,10),this.onCurrentPageVisibilityChanged(n),this.refresh()))},onCurrentPageTitleUpdated(e){this.currentNode.setLabel(e),this.currentNode.elements.container.getElement(v).setData("tooltip",""),this.refresh()},onCurrentPageVisibilityChanged(e){let t,i,n;i=this.currentNode.getAllDescendants(),t=this.currentNode.getChildren(),i&&i.length>0&&(n=i.map(e=>e.options.id),this.model.updateTreeNodeVisibility(n,2===e?0:1)),t&&i&&t.length<i.length?this.refresh():(this.changeNodeVisibility(this.currentNode,e),this.changeVisibilityOfDescendantNodes(this.currentNode,e))},changeVisibilityOfDescendantNodes(e,t){let i;const n=this,o=function(e){n.changeNodeVisibility(e,t)};e&&"function"==typeof e.getAllDescendants&&e.hasChildren()&&(i=e.getAllDescendants()).forEach(o)},changeNodeVisibility(e,t){e&&e.elements&&(1===t?Array.isArray(e.elements.icons)&&e.elements.icons[0]&&e.elements.icons[0].remove():Array.isArray(e.elements.icons)&&e.elements.icons[0]?e.setIcon({picture:`${g.getWebappsBaseUrl()}SwymUIComponents/assets/wiki/privatepage.png`}):e._buildIcons({picture:`${g.getWebappsBaseUrl()}SwymUIComponents/assets/wiki/privatepage.png`}))},getCommunityId(){return this.model?this.model.get("mid"):null}})}),define("DS/SwymUIComponents/script/feature/core/modal/rss-feed-modal",["DS/SwymUIComponents/script/utils/swym-vue","i18n!DS/SwymUIComponents/assets/nls/feature/core/share/view/share-content-view","i18n!DS/SwymUIComponents/assets/nls/feature/core/ui-components/community-contextual-action-menu","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/view/abstract-content-view"],function(e,t,i,n){const{Vue:o}=e;return{createModal:function(e,s){let a=new(o.component("SwymRssFeedModal"))({propsData:{title:s?i.CommunityRSSFeed:n.ContentRSSFeed,rssUrl:e,copyLinkButtonText:t.CopyLink,okButtonText:i.Ok,alertMessage:t.LinkHasBeenCopiedInYourClipboard}}).$mount();document.body.appendChild(a.$el)}}}),define("DS/SwymUIComponents/script/feature/core/network/view/invitation-layer-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/network/view/invitation-layer-view","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/macro/user-app-view","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUIComponents/script/feature/core/network/view/invitation-layer-form-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUIComponents/script/feature/core/modal/modal","DS/UIKIT/Input/Button","DS/UIKIT/Input/Text"],function(e,t,i,n,o,s,a,r,l,c){"use strict";var d={userLoginInvitationAlreadySent:[]},m=s.extend({name:"user-idcard-bottom-bar",_createContent:function(){return{class:"idcard-bottom-bar",html:[this.addControl("invite-button",new l({value:t.Invite,className:"saveButton primary",events:{onClick:function(){var e=this.getControl("invite-button");e&&e.load();var i=this._parentView.getChildView("invitation-form").getControl("inputMessage");i&&this.model.sendInvitation({data:{message:i.getValue(),groupIdProfessionnal:n.getInstance().getAssociated("groups").getIdGroupProfessional()},onComplete:function(e,i){this._parentView.callbackSave&&this._parentView.callbackSave(),this.alert("success",t.addSuccess),this.container.parentElement.parentElement.destroy()}.bind(this)})}.bind(this)}})),new l({value:t.cancel,className:"cancelButton default",events:{onClick:function(){var e=this.container.parentElement.parentElement,t=e.getElement(".invitation-inline-active"),i=e.getElement(".add-connection-active .tile-container");e.removeClassName("invitation-inline"),t.destroy(),i.show()}.bind(this)}})]}}}),u=s.extend({_modelClass:a,_invitationAlreadySent:null,name:"invitation-layer-view",launch:function(s,a,c){if(this.model&&d.userLoginInvitationAlreadySent.indexOf(this.model.get("login"))>-1)this.alert("info",i.alreadySentInvitation);else{this.callbackSave=s;var u=new l({className:"default",value:t.cancel,events:{onClick:function(){this.getControl("invitation-modal").hide()}.bind(this)}}),h=this.addControl("saveButton",new l({className:"primary",value:t.Invite,disable:!0,events:{onClick:function(){var e,i=this.getChildView("invitation-form");i&&(e=i.getControl("inputMessage")),h.load(),this.model.sendInvitation({data:{message:e?e.getValue():"",groupIdProfessionnal:n.getInstance().getAssociated("groups").getIdGroupProfessional()},onComplete:function(e,i){d.userLoginInvitationAlreadySent.push(e.get("login")),s&&s(),C.hide(),this.alert("success",t.addSuccess)}.bind(this)})}.bind(this)}})),p=n.getInstance().getAssociated("groups");p.isEmpty()?(p.setAssociated("currentUser",n.getInstance()),p.fetch({onComplete:function(){h.enable()}})):h.enable();var g=this.addChildView("invitation-form",new o({model:this.model})),w=this.addChildView("user-tile-view-invitation",new d.userTileViewClass({model:this.model}));if(!0===a){c.addClassName("invitation-inline"),e.createElement("div",{class:"invitation-inline-active",html:[w,g,this.addChildView("invitation-bottom-bar",new m({model:this.model}))]}).inject(c)}else{var C=this.addControl("invitation-modal",new r({body:"",closable:!1,footer:[h,u]})),f=C.getBody();w.inject(f),g.inject(f),C.inject(document.body),C.show()}}}});return require(["DS/SwymUIComponents/script/feature/core/user/view/small-user-tile-view"],function(e){d.userTileViewClass=e}),u}),define("DS/SwymUIComponents/script/feature/community/members/view/member-tile-view",["UWA/Core","i18n!DS/SwymUICore/assets/nls/feature/core/user/collection/member-collection","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/user-tile-view","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/member-set-view","i18n!DS/SwymUIComponents/assets/nls/feature/core/search/view/user-search-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/context/context-model","DS/UIKIT/DropdownMenu","DS/SwymUIComponents/script/feature/core/user/view/user-picture-view","DS/SwymUIComponents/script/feature/core/user/view/badge-view","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/utils/utils","DS/UIKIT/Tooltip"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h){"use strict";return s.extend({name:"member-tile-view",className:"swym-tile",domEvents:{"click .action-toolbar .role + .fonticon-down-open":"_onToolbarClick"},defaultOptions:{displayBadges:!0,displayActionToolbar:!0,displayRole:!0},_modelEventsForAutoRefresh:["onChange:relation"],_onToolbarClick:function(e){if(this._isCurrentUserOwner()&&(e.stopPropagation(),e.target.getParent().className.indexOf("action-toolbar")>-1||e.target.getParent().className.indexOf("role")>-1)){var t=this.getControl("dropdownMenu");t&&t.show()}},_isCurrentUserOwner:function(){return parseInt(this.model.getAssociated("community").get("this").getCurrentUserRights,10)>=3},_isCurrentUserMainOwner:function(){return!(!this.model.getAssociated("community").get("owner")||!Object.hasOwnProperty.call(this.model.getAssociated("community").get("owner"),"hash_key"))&&this.model.get("hash_key")===this.model.getAssociated("community").get("owner").hash_key},_getExtraClassForAccountActivation:function(){return"member-tile user-tile"},_getTileWrapperExtraAttributes:function(){return{class:this._getExtraClassForAccountActivation()}},_createPictureView:function(){return""},_displayBasicInfo:function(){return""},_createBadges:function(){return!1!==this.getOption("displayBadges")&&d.getInstance().isFeatureActivated("active_stats_info_on_community_members")?{class:"badges-container",html:[this.model.get("nb_comment")>0?this.addChildView("badgeComment",{Class:c,model:this.model,attributeName:"nb_comment"}):"",this.model.get("nb_post")>0?this.addChildView("badgePost",{Class:c,model:this.model,attributeName:"nb_post"}):"",this.model.get("nb_media")>0?this.addChildView("badgeMedia",{Class:c,model:this.model,attributeName:"nb_media"}):"",this.model.get("nb_question")>0?this.addChildView("badgeQuestion",{Class:c,model:this.model,attributeName:"nb_question"}):"",this.model.get("nb_answer")>0?this.addChildView("badgeAnswer",{Class:c,model:this.model,attributeName:"nb_answer"}):"",this.model.get("nb_ideation")>0?this.addChildView("badgeIdea",{Class:c,model:this.model,attributeName:"nb_ideation"}):""]}:""},_createActionToolbar:function(){var t="",n=this.model;return this._isCurrentUserOwner()&&!this._isCurrentUserMainOwner()&&(t=e.createElement("span",{class:"fonticon fonticon-down-open"}),this.addControl("menu-dropdown-tooltip",new h({target:t,position:"bottom",body:i.Menu})),m.getInstanceFetched(function(e){e.get("hash_key")===n.get("hash_key")&&t.hide()})),t},_createContent:function(){var t,i=this.model,n=(a.getInstance(),null);if(i&&i.get("mid"))return n=this.getOption("displayActionToolbar")?this._createActionToolbar():"",t=e.createElement("div",{class:"member-tile user-tile",html:[this._createPictureView(),this._displayBasicInfo(),this._createBadges()]}),n&&this._buildDropDownMenu(n),[t,this.getOption("displayRole")?{class:"action-toolbar",html:[{class:"role",html:'<span style="font-weight: bold;">'+this._getCurrentRoleName()+"</span>"},n||""]}:""]},_getCurrentRoleName:function(){var e=this.model;return"3"===e.get("relation")?this._isCurrentUserMainOwner()?n.MainOwner:n.Owner:"2"===e.get("relation")?n.Author:n.Contributor},_getInlineActionsUpdate:function(e){var i=null;switch(e){case"1":i=[{name:"author",text:t.Setasauthor,fonticon:"pencil"},{name:"owner",text:t.Setasowner,fonticon:"user-key"},{name:"delete",text:t.Remove,fonticon:"trash"}];break;case"2":i=[{name:"contributor",text:t.Setascontributor,fonticon:"eye"},{name:"owner",text:t.Setasowner,fonticon:"user-key"},{name:"delete",text:t.Remove,fonticon:"trash"}];break;case"3":i=[{name:"contributor",text:t.Setascontributor,fonticon:"eye"},{name:"author",text:t.Setasauthor,fonticon:"pencil"},{name:"delete",text:t.Remove,fonticon:"trash"}]}return i},_onDropdownmenuItemClick:function(e,t){var n=this,o=t.name,s=void 0,a=this.model.get(this.model.getModelIdAttribute(),{escapeHTML:!1});if("contributor"===o||"author"===o||"owner"===o){switch(o){case"contributor":s="1";break;case"author":s="2";break;case"owner":s="3"}var r=";update,"+a+","+s;r.length>0&&(n.mask(),n._parentView.collection.getAssociated("owned").action("editmembers",{data:{settings_members:r},onComplete:function(){n.alert("success",i.Yourchangeshavebeensaved),n.model.set("relation",s),n.refresh(),n.unmask()},onFailure:function(e,t){require(["DS/SwymUICore/script/feature/core/error/error"],function(e){e.displayError(t&&t.errorcode)}),n.refresh(),n.unmask()}}))}else if("delete"===o){var l=";delete,"+a;l.length>0&&(n.mask(),n._parentView.collection.getAssociated("owned").action("editmembers",{data:{settings_members:l},onComplete:function(){n.alert("success",i.Yourchangeshavebeensaved),n.dispatchEvent("memberDeleted",[n.model])},onFailure:function(e,t){require(["DS/SwymUICore/script/feature/core/error/error"],function(e){e.displayError(t&&t.errorcode)}),n.refresh(),n.unmask()}}))}},_buildDropDownMenu:function(e){var t=this._getInlineActionsUpdate(this.model.get("relation"));t&&this.addControl("dropdownMenu",new r({target:e,renderTo:e,items:t,events:{onClick:this._onDropdownmenuItemClick.bind(this)}}))}})}),define("DS/SwymUIComponents/script/feature/community/community/view/community-request-become-author-modal-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-become-author-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/core/modal/modal","DS/UIKIT/Input/Button","DS/UIKIT/Input/Text","DS/WebappsUtils/Console"],function(e,t,i,n,o,s,a){"use strict";return i.extend({name:"community-request-become-author-modal-view",_createContent:function(){var i=this.model,a=this;if(i){var r=new o({value:t.Send,className:"primary create",events:{onClick:function(){this.load(),a.model.changerolerequest({data:{message:a.message},onComplete:function(){d.destroy(),a.alert("success",t.yourRequestHasBeenSent)}})}}}),l=new o({value:t.cancel,events:{onClick:function(){d.hide()}}}),c=e.createElement("div",{html:new s({multiline:!0,placeholder:t.placeholder+" "+t.placeholderInfo,id:"messageToSend",rows:5,value:"",events:{onChange:function(){a.message=this.getValue()}}})}),d=this.addControl("shareModal",new n({footer:[r,l],header:t.roleRequestFor+" "+i.get("title",{escapeHTML:!1}),draggable:!0,closable:!0,maximizable:!1,events:{onHide:function(){this.destroy()}}}));return d.setBody([c]),d}},show:function(){this.getControl("shareModal").show()}})}),define("DS/SwymUIComponents/script/feature/community/community/view/request-become-author-view",["UWA/Core","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUIComponents/script/feature/community/community/view/community-request-become-author-modal-view","i18n!DS/SwymUIComponents/assets/nls/feature/core/search/view/community-selector-view"],function(e,t,i,n,o,s){"use strict";return i.extend({name:"request-become-author-view",className:"content-item",domEvents:{"click .icon-and-link":"_onBecomeAuthorClick"},setup:function(){this._parent.apply(this,arguments),this.context=n.getInstance()},_createContent:function(){return e.createElement("div",{class:"no-creation-rights err-msg",styles:{"word-break":"normal","overflow-wrap":"break-word","word-wrap":"break-word","padding-top":"13px"},html:{class:"icon-and-link",tag:"span",html:[{tag:"span",class:"fonticon fonticon-feather"},{tag:"a",class:"become-author",html:s.BecomeAuthor}]}})},_onBecomeAuthorClick:function(){var e=new t({id:this.context.communityId});new o({model:e}).render(document.body).show()}})}),define("DS/SwymUIComponents/script/feature/core/user/view/user-tile-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/search/view/user-search-view","DS/SwymUIComponents/script/feature/community/members/view/member-tile-view","DS/SwymUIComponents/script/feature/core/user/view/user-picture-view","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/utils/utils"],function(e,t,i,n,o,s){"use strict";return i.extend({name:"user-tile-view",defaultOptions:{displayBadges:!0},_modelEventsForAutoRefresh:["onChange:nb_answer","onChange:nb_comment","onChange:nb_media","onChange:nb_post","onChange:nb_question"].concat(i.prototype._modelEventsForAutoRefresh),_createActionToolbar:function(){var e=this._parent.apply(this,arguments),t=this.model;return e&&o.getInstanceFetched(function(i){i.get("hash_key")===t.get("hash_key")&&e.hide()}),e},_createPictureView:function(){return this.addChildView("userPicture",{Class:n,model:this.model,className:"member-picture",imageRenderingOptions:{format:"square",size:"large"}})},_displayBasicUserInfoOldTile:function(){var e=this.model;return{styles:{"text-align":"center"},html:[{class:"user-name member-name",html:'<a data-content-type="person" data-hash-key="'+(e.get("hash_key")?e.get("hash_key"):"")+'"data-login="'+e.get("login")+'" class="link" >'+e.getNickname()+(e.isPendingUser()?" ("+t.Pending+")":"")+"</a>"},{styles:{margin:"10px 0","font-style":"italic"},html:(e.has("job_title")&&""!==e.get("job_title").trim()?e.get("job_title"):"")+(e.has("company")&&""!==e.get("company").trim()?(e.has("job_title")&&""!==e.get("job_title").trim()?", ":"")+e.get("company"):"")}]}},_displayBasicInfo:function(){return this._displayBasicUserInfoOldTile()}})}),define("DS/SwymUIComponents/script/feature/core/search/view/community-selector/community-selector-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/feature/community/community/collection/community-collection","DS/SwymUIComponents/script/lib/creation-statistics-persistence","DS/SwymUIComponents/script/feature/core/search/view/community-selector/community-template","DS/SwymUIComponents/script/feature/core/search/view/community-selector/community-selector-autocomplete","DS/WebappsUtils/Console","i18n!DS/SwymUIComponents/assets/nls/feature/core/search/view/community-selector-view"],function(e,t,i,n,o,s,a,r){"use strict";var l=50;function c(e){return{value:e.get("subject6wuri")+"",label:e.get("title",{escapeHTML:!1})}}function d(t){var n=this,o=new i([],{mode:"findCommunity",limit:l});return function(i,s){return new Promise(function(a,r){o.setModel(u[n.getOption("modelParam")]),o.fetch({data:e.merge({query:s,select_predicate:["title","id","resourceid"]},t),reset:!0,onComplete:function(){const e=this.getDataset(m);let t=o.filter(function(t){const i=t.get("subject6wuri");return 0===e.items.filter(e=>e.value===i).length});var n={dataset:i,matchingItems:t.map(c)};a(n)}.bind(this),onFailure:function(e){r(e)}})}.bind(this))}}var m="recent-communities",u={post:"post",media:"media",idea:"ideation",wiki:"wikitree",wikitree:"wikitree",survey:"survey",iquestion:"iquestion",wedo:"wedo","social-event":"conference",ritual:"conference"};return t.extend({name:"community-selector-view",communityCollections:null,_contentCreationPersistence:null,communitySyncComplete:!1,isCommunitySyncComplete:function(){return this.communitySyncComplete},validate:function(){var e=this.getControl("communitySelector").getValue().length>0;return!1===e?this.container.addClassName("invalid"):this.container.removeClassName("invalid"),e},selectCommunity:function(e){var t,i=this.getControl("communitySelector");if(e)return(t=i.getItem(e))&&t.id?(i.onSelect(t),!0):(a.log("could not select community",t,t.id,e),!1)},unselectCommunity:function(){var e=this.getControl("communitySelector");e&&e.reset(),this.onCommunityUnselected()},onCommunityUnselected:function(){this.dispatchEvent("onCommunitySelectChange",[])},populateCommunityCollection:function(t){var i,n,o=this.getControl("communitySelector"),s=o.getDataset("other-communities"),a=o.getDataset("favorite-communities"),r=!t||!e.is(t.fetchCommunityCollection)||t.fetchCommunityCollection,l=this,c=t&&t.communityId||null;if(i=s.collection,n=a.collection,i.setModel(u[this.getOption("modelParam")]),n.setModel(u[this.getOption("modelParam")]),(this._contentCreationPersistence.getRecentCommunitiesForContentType(this.options?this.getOption("modelParam"):"")||[]).length>0&&l.onCommunityListSync([],[],{showAlert:!1,displayOnlyRecentCommunities:!0,isCollectionSynced:!1,communitySelected:c}),r){this.communitySyncComplete=!1;var d=new Promise(function(e){i.fetchPage(1,{headers:{"X-DS-SWYM-CSRFTOKEN":t?t.csrfToken:""},serviceName:"filter",ignoreCache:!0,reset:!0,data:{favorite_communities:"without",select_predicate:["title","id","resourceid"],..."instant-message"!==l.getOption("modelParam")&&{creation_granted_for:[u[l.getOption("modelParam")]]}},onComplete:function(){e()}})}),m=new Promise(function(e){n.fetch({headers:{"X-DS-SWYM-CSRFTOKEN":t?t.csrfToken:""},reset:!0,data:{favorite_communities:"only",select_predicate:["title","id","resourceid"]},onComplete:function(){e()}})});Promise.all([d,m]).then(function(){l.onCommunityListSync(i,n,{showAlert:!0,communitySelected:c,isCollectionSynced:!0})})}else l.onCommunityListSync(i,n,{showAlert:!0,isCollectionSynced:!1,communitySelected:c})},setModelParam:function(e,t){this.getOption("modelParam")!==e&&(this.setOption("modelParam",e),this.populateCommunityCollection(t))},setup:function(){var e=this;this._parent.apply(this,arguments),this._contentCreationPersistence=n.getInstance();var t=void 0===this.getOption("disabled")||this.getOption("disabled");this.listenTo(this._contentCreationPersistence,"CommunitiesUpdated",function(e){this.getOption("modelParam")===e&&this.populateCommunityCollection({fetchCommunityCollection:!1})}.bind(this)),this.addControl("communitySelector",new s({placeholder:r.SelectACommunity,disabled:t,noResultsMessage:r.NoMatchFound,typeDelayBeforeSearch:400,minLengthBeforeSearch:3,showSuggestsOnFocus:!0,allowFreeInput:!0,datasets:[{name:m,items:[],configuration:{templateEngine:o("recent")}},{name:"favorite-communities",items:[],collection:new i([],{mode:"findCommunity",limit:100,modelParam:u[this.getOption("modelParam")]}),configuration:{templateEngine:o("favorite")},remoteSearchEngine:d.call(this,{favorite_communities:"only"})},{name:"other-communities",items:[],collection:new i([],{mode:"findCommunity",limit:l,modelParam:u[this.getOption("modelParam")]}),configuration:{templateEngine:o()},remoteSearchEngine:d.call(this,{favorite_communities:"without"})}],events:{onSelect:function(t){e.dispatchEvent("onCommunitySelectChange",[t.value]),!0!==t.disabled&&e.dispatchEvent("enablePublishRequest"),require(["DS/SwymUICore/script/lib/event-manager"],function(e){e.dispatchEvent("onCommunitySelected",[t.value],!0)})},onUnselect:function(){a.log("onUnselect"),e.onCommunityUnselected()},onFocus:function(){e.container&&e.container.addClassName("expanded"),e.dispatchEvent("communitySelectorExpanded",[!0])},onBlur:function(){e.container&&e.container.removeClassName("expanded"),e.dispatchEvent("communitySelectorExpanded",[!1])}}}))},onCommunityListSync:function(e,t,i){var n=[],o=[],s=[],a=i.communitySelected,r=this.getControl("communitySelector"),l=this._contentCreationPersistence.getRecentCommunitiesForContentType(this.options?this.getOption("modelParam"):"")||[];e.forEach(function(e){var t=e.get("subject6wuri"),i=c(e);0===l.filter(function(e){return e.communityId===t}).length&&(a&&i.value===a&&(i.selected=!0),n.push(i))}),t.forEach(function(e){var t=e.get("subject6wuri"),i=c(e);0===l.filter(function(e){return e.communityId===t}).length&&(a&&i.value===a&&(i.selected=!0),o.push(i))}),l.length>0&&l.forEach(function(e){var t={value:e.communityId+"",label:e.communityTitle};a&&t.value===a&&(t.selected=!0),s.push(t)}),n.length>0||o.length>0||s.length>0?(r&&(r.cleanDataset("other-communities"),r.cleanDataset("favorite-communities"),r.cleanDataset(m),s.length>0&&r.addItems(s,r.getDataset(m)),o.length>0&&r.addItems(o,r.getDataset("favorite-communities")),n.length>0&&r.addItems(n,r.getDataset("other-communities")),r.enable()),this.container&&this.container.removeClassName("ask-author-rights"),!0===i.isCollectionSynced&&(this.communitySyncComplete=!0,this.dispatchEvent("onCommunitySyncComplete"))):(this.container.addClassName("ask-author-rights"),this.dispatchEvent("disablePublishRequest"))},enable:function(){var e=this.getControl("communitySelector");e&&e.enable()},disable:function(){var e=this.getControl("communitySelector");e&&e.disable()},getSelectedCommunity:function(){var e=this.getControl("communitySelector");return e?e.getValue():null},_createContent:function(){return this.getControl("communitySelector")},isEmpty:function(){const e=this.getControl("communitySelector").getItems();return!(e&&e.length>0)},onDestroy:function(){var e=this.getControl("communitySelector");e&&e.destroy()}})}),define("DS/SwymUIComponents/script/feature/community/idea/view/idea-converter-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/idea/view/idea-converter-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/UIKIT/Input/Toggle","DS/UIKIT/Input/Select","DS/SwymUIComponents/script/feature/core/search/view/community-selector/community-selector-view","DS/SwymUICore/script/feature/community/community/collection/community-collection","DS/SwymUICore/script/feature/community/idea/collection/idea-collection","DS/SwymUICore/script/feature/community/idea/model/idea-model","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/feature/core/context/context-model","DS/UIKIT/Mask"],function(e,t,i,n,o,s,a,r,l,c,d,m){return i.extend({name:"idea-converter-view",mode:"create",modal:null,_displayInfoMessageAboutEmbeddedImage:function(e){var t=this.getElement(".alert-images-info");t&&(!0===e&&this._isAnIssueWithEmbeddedMediaPossible()?t.show():t.hide())},_isAnIssueWithEmbeddedMediaPossible:function(){var e=this.model.get("thumbnail")&&this.model.get("thumbnail").mid,t="1"==this.model.getAssociated("community").get("access"),i=this.getChildView("communityCreateCombo").getSelectedCommunity()===this.model.getAssociated("community").get("mid");return e&&!t&&!i},_createContent:function(){var i=this.model,o=this.getChildView("communityCreateCombo"),s=this.getChildView("communityLinkCombo"),a=this;if(i){var r={html:[{html:[a.addControl("createToggle",new n({name:"create-link-radio-"+a.cid,checked:!0,label:t.Createanewideain,className:"primary",events:{onChange:function(){var e=a.getChildView("communityCreateCombo");a.mode="create",a.getControl("ideaCombo").disable(),a.getChildView("communityLinkCombo").disable(),e&&!e.isEmpty()&&(e.enable(),a._displayInfoMessageAboutEmbeddedImage(!0))}}}))]},{styles:{"margin-bottom":"10px"},html:o},{styles:{"margin-bottom":"10px"},class:"alert-warning alert-message alert-images-info",html:t.WarningMessageForEmbeddedMedia},{html:[a.addControl("linkToggle",new n({name:"create-link-radio-"+a.cid,checked:!1,label:t.Linktoanexistingideain+" *",className:"primary",events:{onChange:function(){var e=a.getChildView("communityLinkCombo");a.mode="link",a._ideaCollection&&!1===a._ideaCollection.isEmpty()&&a.getControl("ideaCombo").enable(),e&&!e.isEmpty()&&e.enable(),a.getChildView("communityCreateCombo").disable(),a._displayInfoMessageAboutEmbeddedImage(!1)}}}))]},{styles:{"margin-bottom":"10px"},html:a.addControl("communityLinkSelectContainer",e.createElement("div",{html:s}))},{styles:{"margin-bottom":"10px"},html:a.addControl("ideaSelectContainer",e.createElement("div",{html:a.getControl("ideaCombo")}))},{styles:{"margin-bottom":"10px",display:"none",position:"relative"},id:"link-message",class:"alert-message alert-warning",html:t.ThereIsNoIdeaInThisCommunity},"* "+t.Linknondisplayedifmembersdoesntgotrights]};return o.isCommunitySyncComplete()||(o.addEventOnce("onCommunitySyncComplete",function(){o.isEmpty()&&(o.disable(),a.alert("info",t.ThereIsNoCommunityWhereYouCanAddOrLinkIdea)),"link"===a.mode&&o.disable()}),o&&o.populateCommunityCollection()),s.isCommunitySyncComplete()||(s.addEventOnce("onCommunitySyncComplete",function(){s.isEmpty()&&s.disable(),"create"===a.mode&&s.disable()}),s&&s.populateCommunityCollection()),r}},setup:function(){var e=this;this.addControl("ideaCombo",new o({placeholder:t.Selectanidea,className:"idea-combo",disabled:!0})),this.addChildView("communityCreateCombo",{Class:s,className:"create-community-combo",modelParam:"idea"}).addEvent("onCommunitySelectChange",function(){this._displayInfoMessageAboutEmbeddedImage(!0)}.bind(this));var i=this.addChildView("communityLinkCombo",{Class:s,className:"link-community-combo",modelParam:"idea"});i.disable(),i.addEvent("onCommunitySelectChange",function(){var t;e.getControl("ideaCombo").remove(),e.getChildView("communityLinkCombo").getSelectedCommunity()?(e.getControl("ideaCombo").show(),e._ideaCollection?e._ideaCollection.setup([],{communityId:e.getChildView("communityLinkCombo").getSelectedCommunity()}):e._ideaCollection=new r([],{mode:"transfer-to-idea-list",communityId:i.getSelectedCommunity(),limit:999}),e.fetchIdeaCombo(e._ideaCollection)):(e.getControl("ideaCombo").hide(),(t=e.getContent().getElement("#link-message"))&&t.hide())}),this._context=d.getInstance(),this._parent.apply(this,arguments)},fetchIdeaCombo:function(e){var t,i=this;i.isDestroyed()||(m.mask(i.getControl("ideaSelectContainer")),i.getControl("ideaCombo").disable(),i.getControl("ideaCombo").add([]),i.getControl("ideaCombo").show(),i.getChildView("communityLinkCombo").disable(),(t=i.getContent().getElement("#link-message"))&&t.hide(),e.fetch({onComplete:function(e){if(!i.isDestroyed()){var t,n=[];e.length>0?(e.forEach(function(e){e.get("id")!=i.model.get("id")&&n.push({label:e.get("title",{escapeHTML:!1}),value:e.get("mid")})}),n[0]?(n[0].selected=!0,i.getControl("ideaCombo").add(n)):(i.getControl("ideaCombo").hide(),(t=i.getContent().getElement("#link-message"))&&t.show()),"link"==i.mode&&(i.getControl("ideaCombo").enable(),i.getChildView("communityLinkCombo").enable())):("link"==i.mode&&i.getChildView("communityLinkCombo").enable(),i.getControl("ideaCombo").hide(),(t=i.getContent().getElement("#link-message"))&&t.show()),m.unmask(i.getControl("ideaSelectContainer"))}}}))},convertIdea:function(e){var i;switch(this.mode){case"create":var n=this.model.toJSON();"Media"==this.model.getTableName()?n.message='<p><img data-source="swym" class="media" width="240" data-media-type="'+this.model.get("media_type")+'" data-media-id="'+this.model.get("mid")+'"/></p>'+(this.model.get("content")?"<p>"+this.model.get("content")+"</p>":""):n.message=this.model.get("content"),this.getChildView("communityCreateCombo").getSelectedCommunity()?(this.getControl("create")&&this.getControl("create").load(),(i=new l({})).addChanges({title:n.title,message:n.message,community_id:this.getChildView("communityCreateCombo").getSelectedCommunity()}),i.save({},{onComplete:function(){this.idea.addLink({type:"internal",model_id:this.model.get("mid"),model:this.model.getTableName()},{onComplete:function(){}}),this.convertLayer.hide(),this.view.getControl("create")&&this.view.getControl("create").load(!1),c.goToContent(i.get("mid"),i.getModelName(),i.get("community->mid"),!0)}.bind({idea:i,convertLayer:e,model:this.model,view:this})}),this._context.transferredToIdea=!0):this.alert("error",t.Pleaseselectacommunity);break;case"link":this.getChildView("communityLinkCombo").getSelectedCommunity()?this.getControl("ideaCombo").getValue()[0]?(this.getControl("create")&&this.getControl("create").load(),i=new l({id:this.getControl("ideaCombo").getValue()[0]},{autoPopulate:!1}),this.convertLayer=e,i.addLink({type:"internal",model_id:this.model.get("mid"),model:this.model.getTableName()},{onComplete:function(){this.alert("success",t.Yourlinkhasbeencreated),this.convertLayer.hide(),this.getControl("create")&&this.getControl("create").load(!1)}.bind(this),onFailure:function(e,i){"ERROR_IDEATION_CONTENT_ALREADY_LINKED"==i.errorcode?this.alert("error",t.Thiscontentisalreadylinkedtothisidea):"ERROR_CANNOT_LINK_IDEATION_TO_ITSELF"==i.errorcode?this.alert("error",t.Cannotlinkanideatoitself):this.alert("error",t.Youdonthaverightstocreatelinkonthisidea),this.getControl("create")&&this.getControl("create").load(!1)}.bind(this)})):this._ideaCollection&&!1===this._ideaCollection.isEmpty()&&this.alert("error",t.Pleaseselectanideaintheselectedcommunity):this.alert("error",t.Pleaseselectacommunity)}}})}),define("DS/SwymUIComponents/script/feature/community/template/collection/content-template-collection",["UWA/Core","DS/SwymUICore/script/feature/core/pagination/collection/paginated-collection","DS/SwymUIComponents/script/feature/community/template/model/content-template-model"],(e,t,i)=>{return t.extend({_collectionName:"content-template-collection",model:i,_communityId:null,_contentType:null,modes:["getTemplatesByContentType","getTemplates"],_services:{read:{getTemplatesByContentType:{urlFn(){return`api/templates/list/${this._communityId}/type/${this._contentType}`},method:"GET",dataFn:()=>({})},getTemplates:{urlFn(){return`api/templates/list/${this._communityId}`},method:"GET",dataFn:()=>({})}}},setup(e,t){this._communityId=t.communityId?t.communityId:this.errorParams("communityId"),this._contentType=t.contentType?t.contentType:null,this._parent.apply(this,arguments)},errorParams:e=>`A ${e} is required`})}),define("DS/SwymUIComponents/script/feature/community/media/edit/thumbnail/content-edition-media-thumbnail-view",["UWA/Core","DS/SwymUIComponents/script/feature/community/content/view/media-thumbnail-view","DS/UIKIT/Tooltip","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/edit/thumbnail/content-edition-media-thumbnail-view"],function(e,t,i,n){"use strict";return t.extend({name:"media-edition-thumbnail-view",domEvents:{"click .fonticon-close":"removeThumbnail"},_justUploaded:function(){return"justUploaded"===this.getOption("uploadStatus")},_createCancelTopRightContent:function(){return{tag:"span",class:"fonticon fonticon-2x fonticon-close top-right"}},_createContent:function(){var e=this._parent();return e.setAttribute("draggable","false"),[e,this._createCancelTopRightContent(),this._justUploaded()?{tag:"span",class:"fonticon fonticon-2x fonticon-check bottom-right dot success"}:""]},removeThumbnail:function(){this._justUploaded()&&this.model.destroy(),this.dispatchEvent("onRemoveRequest",[this.model]),this.destroy()},onRender:function(){var e,t;"justUploaded"===this.getOption("uploadStatus")&&(e=this.getElement(".fonticon-check"))&&this.addControl("newlyUploadedTooltip",new i({target:e,body:n.NewlyUploaded})),(t=this.getElement(".fonticon-trash"))&&this.addControl("removeMediaTooltip",new i({target:t,body:n.RemoveMedia}))}})}),define("DS/SwymUIComponents/script/feature/community/wedo/view/content-edition-attachment-thumbnail-view",["UWA/Core","DS/SwymUIComponents/script/feature/community/media/edit/thumbnail/content-edition-media-thumbnail-view","DS/SwymUICore/script/feature/community/wedo/model/attachment-model","DS/WebappsUtils/WebappsUtils"],function(e,t,i,n){"use strict";return t.extend({_modelClass:i,_createContent:function(){var e=this.model.get("preview_url",{escapeHTML:!1});return{class:"interactive-media-wrapper",html:[{tag:"img",src:e||n.getWebappsBaseUrl()+"SwymSCI/assets/images/l_thumb_waiting_processing.png","data-type":"MediaNoPicture"},this._createCancelTopRightContent()]}}})}),define("DS/SwymUIComponents/script/feature/community/wedo/view/wedo-author-section-view",["UWA/Core","DS/SwymUIComponents/script/feature/community/content/view/author-section-view","DS/SwymUIComponents/script/feature/core/user/view/user-picture-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/wedo/view/wedo-detailed-view"],function(e,t,i,n){"use strict";return t.extend({name:"wedo-content-author-section",defaultOptions:{onlyShowAttachmentsAndAssignees:!1},_getNumberOfAttachments:function(){var e=0;return this.model.get("attachments")&&(e=this.model.get("attachments").filter(function(e){return"3DSwym"===e["dscom:ServiceHosting"]}).length),e},_getAttachmentsAndAssignees:function(){var t=this.model,o=t.getAssociated("assignees"),s=this._getNumberOfAttachments(),a=o.length;return o.reset(o.shuffle(),{silent:!0}),e.createElement("div",{class:"attachments-and-assignees","data-content-id":t.get("mid"),"data-content-type":"wedo","data-community-id":t.get("community->mid"),html:[s>0?{class:"attachments",html:[{tag:"span",class:"fonticon fonticon-attach"},{tag:"a",class:"attachment-number",html:s}]}:"",a>0?{class:"assignees",html:[{class:"assignee-label",html:n.Assignees},this.addChildView("firstAssignee",new i({displayPresence:!1,model:o.at(0),className:"tiny-assignee-picture"})),a>1?this.addChildView("secondAssignee",new i({displayPresence:!1,model:o.at(1),className:"tiny-assignee-picture"})):"",a>2?{class:"assignee-more-counter",html:"+"+(a-2)}:""]}:""]})},_createContent:function(){var e=this.model;return[{class:"author-left-section",html:(!1===this.getOption("onlyShowAttachmentsAndAssignees")?[this._getAuthorPicture,this._getAuthorView,this._getThreadLink,this._getActivityDate,this._getModificationDate]:[]).map(function(t){return t.apply(this,[e])}.bind(this))},this._getAttachmentsAndAssignees()]}})}),define("DS/SwymUIComponents/script/feature/community/community/view/community-signup-request-view",["i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-signup-request-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUIComponents/script/feature/core/modal/modal","DS/UIKIT/Input/Button","DS/UIKIT/Form","DS/SwymUIComponents/script/feature/community/content/view/media-thumbnail-view"],function(e,t,i,n,o,s,a){"use strict";return t.extend({_modelClass:i,name:"community-signup-request-view",_createContent:function(){var t=this.model;if(t){var i=this.addControl("cancelButton",new o({value:e.Cancel,events:{onClick:function(){this.getControl("communitySignupModal").hide()}.bind(this)}})),r=this.addControl("sendButton",new o({value:e.Send,className:"primary",events:{onClick:function(){var i=this;i.getControl("communitySignupForm").validate()&&(i.getControl("sendButton").setDisabled(),i.getControl("cancelButton").setDisabled(),i.getControl("communitySignupForm").setDisabled(),require(["DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/lib/request/data"],function(n,o){var s=n.adaptService({url:"/api/notification/joincommunity",data:{community_access_wish:i.getControl("communitySignupForm").getValue("community_access_wish"),related_model_id:t.get("mid")},onComplete:function(){this.getControl("communitySignupModal").hide(),this.alert("success",e.AnEmailHasBeenSentToTheCommunityAdministrators)}.bind(i)});o.request(s)}))}.bind(this)}}));return this.addControl("communitySignupModal",new n({closable:!0,header:"<h4>"+e.CommunitySignupRequestFor+"</h4>",body:[{class:"community-info",html:[this.addChildView("communityLogo",new a({model:t,imageRenderingOptions:{size:"l"}})),{class:"wrapper-name-description",html:[{class:"community-name",html:t.get("title")},{class:"community-description",html:t.get("description")}]}]},this.addControl("communitySignupForm",new s({fields:[{type:"textarea",name:"community_access_wish",placeholder:e.PleaseExplainTheReasonsWhyYouWantToJoinThisCommunity,rows:4,required:!0},{type:"html",html:e.ThisInformationWillBeSentToTheCommunityOwnersInAdditionToYourFirstNameLastNameJobTitleCompanyCountryAndEmail}]}))],footer:[r,i],events:{onHide:function(){this.destroy()}.bind(this)}}))}},show:function(){this.getControl("communitySignupModal").show()}})}),define("DS/SwymUIComponents/script/feature/core/user/view/user-mini-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/core/user/view/user-picture-view","DS/WebappsUtils/Console"],function(e,t,i,n){return t.extend({model:null,_el:null,_createContent:function(){var e=this.model;if(e)return[{html:{class:"user-mini-table",tag:"table",html:{tag:"tr",html:[{tag:"td",html:{styles:{"margin-right":"10px"},html:this.addChildView("userPicture",{Class:i,model:e,imageRenderingOptions:{format:"mini"}})}},{styles:{"vertical-align":"middle"},tag:"td",html:{tag:"span",class:"content-details nickname-elm",styles:{"border-left":"none"},html:{tag:"a",html:e.getNickname(),"data-content-type":"person","data-hash-key":e.get("hash_key")||"","data-login":e.get("login")||""}}}]}}}]}})}),define("DS/SwymUIComponents/script/feature/core/user/view/users-mini-list-view",["UWA/Core","UWA/Event","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUIComponents/script/feature/core/user/view/user-picture-view","DS/SwymUIComponents/script/feature/core/user/view/user-mini-view","DS/UIKIT/Input/Button","DS/SwymUIComponents/script/feature/core/modal/modal","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/users-mini-list-view"],function(e,t,i,n,o,s,a,r,l){"use strict";return i.extend({title:"",showViewMore:!0,collection:null,_viewMoreModal:null,_createContent:function(){var e=this,t=this.addControl("viewMoreBtn",new a({className:"link",value:l.Viewmore,attributes:{styles:{width:"100%"}},events:{onClick:function(){this._viewMoreModal||(this._viewMoreModal=e.addControl("moreModal",new r({closable:!0,header:this.title,body:[{html:this.addChildView("usersList",{collection:this.collection,Class:n,modelViewClass:s,modelViewsCfg:{attributes:{class:"float-left",styles:{"margin-bottom":"10px","min-width":"50%"}},modal:this._viewMoreModal}})},{html:'<div style="clear:both;"></div>'}],events:{onShow:function(){document.body.addEvent("click",e._hideModal)},onHide:function(){document.body.removeEvent("click",e._hideModal)}}})).inject(this._widget.body)),this._viewMoreModal.show()}.bind(this)}}));return[{html:this.addChildView("usersView",{collection:this.collection,Class:n,modelViewClass:o,modelName:this.model.getModelName(),modelViewsCfg:{imageRenderingOptions:{format:"mini"},attributes:{class:"float-left",styles:{"margin-right":"5px"}}}})},'<div style="clear:both;"></div>',this.showViewMore?{styles:{"margin-top":"10px"},html:t}:""]},init:function(){return this._hideModal=function(e){var i=this.getControl("viewMoreBtn"),n=t.getElement(e);this._viewMoreModal&&i&&n!==i.elements.container&&this._viewMoreModal.hide()}.bind(this),this._parent.apply(this,arguments)},setup:function(e){return this._parent.apply(this,arguments),e.title&&(this.title=e.title),e.collection&&(this.collection=e.collection),e.showViewMore&&(this.showViewMore=e.showViewMore),this}})}),define("DS/SwymUIComponents/script/feature/core/user/view/shared-contacts-small-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/contacts-small-view","DS/UIKIT/Tooltip","DS/UIKIT/Spinner","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUIComponents/script/feature/core/user/view/user-picture-view","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/SwymUIComponents/script/feature/core/modal/modal","DS/SwymUIComponents/script/feature/core/user/view/user-mini-view"],function(e,t,i,n,o,s,a,r,l){"use strict";var c=s.extend({_imageRenderingOptions:{format:"mini"},defaultOptions:{displayPresence:!1},_createContent:function(){var e=this._parent();return this.addControl("tooltip",this._createTooltip(e,this.model)),e},_createTooltip:function(t,n){if(n){var o=n.get("company"),s=n.get("job_title"),a=n.get("city"),r=n.get("country"),l={html:[{html:{tag:"b",html:n.getNickname()}},o?{html:o}:{},s?{html:s}:{},a?{html:a}:{},r?{html:r}:{}]};return new i(e.merge({target:t,position:"bottom",body:e.createElement("div",l).getHTML()},this.options.tooltipOptions))}return!1}});return o.extend({_collectionClass:a,modelViewClass:c,domEvents:{"click .view-more-link":"_viewMoreLinkClicked"},name:"shared-contacts-small-view",limit:5,showMore:!0,showBorder:!0,tooltipOptions:null,_viewMoreLinkClicked:function(){if(!this._viewMoreModal){this._viewMoreModal=new r({closable:!0,header:t.SharedContacts,body:[{html:new o({collection:this.collection,modelViewsCfg:{attributes:{class:"float-left",styles:{"margin-bottom":"10px","min-width":"50%"}},modal:this._viewMoreModal},modelViewClass:l})},{html:'<div style="clear:both;"></div>'}],events:{onShow:function(){setTimeout(function(){document.body.addEvent("click",e)},0)},onHide:function(){document.body.removeEvent("click",e),this.destroy()}}}).inject(document.body);var e=function(){this.hide()}.bind(this._viewMoreModal)}this._viewMoreModal.show()},_getSharedContacts:function(){var t;this.model&&this.collection&&(t=this.model.get("ut_state"),e.is(t)?2!=t&&3!=t?this.collection.goToPage(1,{onFailure:function(){this.hide()}.bind(this)}):this.hide():this.listenToOnce(this.model,"onChange:ut_state",this._getSharedContacts))},_createContent:function(){var e,i,o,s=this.model,a="",r=[],l=this.collection;if(!l&&s&&(s.isCurrentUser()||(l=s.getAssociated("contactsSharedWithCurrentUSer"),this.setCollection(l,{refresh:!1}),l.hasBeenFetched()||this._getSharedContacts())),l)if(e=l.length,l.hasBeenFetched()){if(e>0){this.removeControl("spinner");for(var c=0,d=Math.min(this.limit,e);c<d;c++)o=this._createModelView(l.at(c)),r.push(this.addChildView(this.MODEL_VIEWS_INDEX_PREFIX+o.cid,o));a=[{styles:{"font-size":"11px","font-weight":"bold"},html:t.SharedContacts},r],e>this.limit&&!0===this.showMore&&a.push({class:"dsi-communityhome-link",styles:{clear:"both",float:"right","margin-right":"10px"},html:{tag:"a",class:"dsi-communitylink-all view-more-link",html:t.ViewMore}}),a={class:this.showBorder?"border-top":"",html:a}}}else(i=this.addControl("spinner",new n)).show(),a={class:"flex-display",styles:{"justify-content":"center"},html:i};return a},setup:function(e){return e&&(!1===e.showMore&&(this.showMore=!1),e.limit&&(this.limit=e.limit),e.hasOwnProperty("showBorder")&&(this.showBorder=e.showBorder),e.tooltipOptions&&(this.modelViewsCfg=this.modelViewsCfg||{},this.modelViewsCfg.tooltipOptions=e.tooltipOptions)),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/social-event/edit/visio-provider-editor-view",["require","exports","DS/SwymUICore/script/lib/view/generic/swym-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/social-event/social-event-view","UWA/Core","DS/SwymUIComponents/script/feature/community/social-event/edit/oauth-provider-manager","DS/UWPClientControls/PlatformNotify"],function(e,t,i,n,o,s,a){"use strict";function r(e){return"string"==typeof e?e.charAt(0).toUpperCase()+e.slice(1):""}return i.extend({name:"visio-provider-editor",_activatedProvider:null,_authenticationInProgress:!1,_providerEmail:null,domEvents:{"click .link.connect":"authenticate","click .link.disconnect":"disconnect"},setup:function(){this._activatedProvider=s.getActivatedConferenceProvider(),this.authenticate(),this._parent.apply(this,arguments)},getConferenceProvider:function(){return this._providerEmail?this._activatedProvider&&this._activatedProvider.type:null},authenticate:function(){var e=this;this._authenticationInProgress?s.focusAuthentificationWindow():(this._authenticationInProgress=!0,s.authenticate(e._activatedProvider.type,e._activatedProvider.authenticate_uri).then(function(t){t&&t.email&&(e._providerEmail=t.email)},function(){var t=e._activatedProvider.type,i=t.charAt(0).toUpperCase()+t.slice(1);a.error(n.get("AnErrorOccurredWhileConnectingTo".concat(i,"PleaseTryLater"))),e._providerEmail=null}).finally(function(){e._authenticationInProgress=!1,e._updateProviderAccountEl()}))},disconnect:function(){var e=this;s.disconnect(this._activatedProvider.type).then(function(){e._providerEmail=null,e._activatedProvider=null,e._updateProviderAccountEl()})},onConnectProviderLinkClick:function(){this.authenticate()},onDisconnectProviderLinkClick:function(){this.reauthenticate()},_updateProviderAccountEl:function(){var e=this._providerEmail;return this.providerAccountEl||(this.providerToConnectEl=o.createElement("div",{class:"account-to-connect",html:[{tag:"span",class:"link connect",html:n.get("ConnectTo".concat(r(this._activatedProvider.type),"Account"))}]}),this.connectedProviderAccountEl=o.createElement("div",{class:"connected-account",html:[{tag:"span",class:"account-info",html:e?n.replace(n.get("Creating".concat(r(this._activatedProvider.type),"ConferenceWithEmail")),{email:e}):""},{tag:"span",html:" | "},{tag:"span",class:"link disconnect",html:n.get("Disconnect")}]}),this.providerAccountEl=o.createElement("div",{class:"account-details",html:[this.providerToConnectEl,this.connectedProviderAccountEl]})),this._authenticationInProgress||!e?(this.providerToConnectEl.show(),this.connectedProviderAccountEl.hide()):(this.providerToConnectEl.hide(),this.connectedProviderAccountEl.getElement(".account-info").setHTML(n.replace(n.get("Creating".concat(r(this._activatedProvider.type),"ConferenceWithEmail")),{email:e})),this.connectedProviderAccountEl.show()),this.providerAccountEl},_createContent:function(){return[{tag:"div",class:"heading",html:n.get("ConferenceVousSupport")},{tag:"div",class:"provider-selection",html:[this._updateProviderAccountEl()]}]},refreshContent:function(e){this.refresh()},resetContent:function(){this._providerEmail=null,this._activatedProvider=null,this._updateProviderAccountEl(),this._parent()}})}),define("DS/SwymUIComponents/script/feature/community/community/view/community-signup-request-launcher",["DS/SwymUIComponents/script/feature/community/community/view/community-signup-request-view"],function(e){"use strict";var t=null;return{show:function(i){var n;t&&t.model&&t.model.equals(i)?t.show():((n=new e({model:i})).render(document.body),n.show(),t&&!t.isDestroyed()&&t.destroy(),t=n)}}}),define("DS/SwymUIComponents/script/feature/community/social-event/edit/social-event-common-editor",["UWA/Core","DS/SwymUICore/script/feature/community/social-event/model/social-event-model","DS/UIKIT/Input/Date","DS/UIKIT/Input/Select","DS/SwymUIComponents/script/feature/community/social-event/edit/external-users-edit-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/social-event/social-event-view","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUIComponents/script/feature/community/social-event/edit/visio-provider-editor-view","DS/SwymUIComponents/script/feature/community/social-event/edit/oauth-provider-manager","DS/UWPClientControls/PlatformNotify","DS/SwymUICore/script/feature/core/user/model/currentuser-model"],function(e,t,i,n,o,s,a,r,l,c,d){"use strict";function m(e){const t=""+e;return 1===t.length?"0"+t:t}return a.extend({name:"social-event-common-editor",_modelClass:t,_isProviderActive:!1,setup:function(){new Date;const t=this;this.startHourInput=e.createElement("input",{type:"time",placeholder:s.SelectATime,class:"form-control time-input"}),this.endHourInput=e.createElement("input",{type:"time",placeholder:s.SelectATime,class:"form-control time-input"}),this.addControl("providerSelector",new n({custom:!1,placeholder:s.SelectProvider,options:[{value:"Platform visio",selected:!0},{value:"Zoom"},{value:"WebEx"}]})),this.addControl("extUsersEditView",new o({model:this.model})),this.addControl("datePicker",new i({placeholder:s.SelectADate})),this.addControl("timeError",e.createElement("div",{class:"time-error",html:s.DatePast11pmError}));const a=this.model;if(a){let e=a&&a.getAssociated("author"),i=e&&e.get("login");d.getInstanceFetched(function(e){i&&i!==e.get("login")&&(t.getControl("datePicker")&&t.getControl("datePicker").disable(),t.startHourInput&&(t.startHourInput.disabled=!0),t.endHourInput&&(t.endHourInput.disabled=!0))})}return this._isProviderActive=null!==l.getActivatedConferenceProvider(),this._parent.apply(this,arguments)},refreshContent(e){const t=this.getControl("extUsersEditView"),i=this.getControl("datePicker");if(t.resetExternalUsersArray(),e.external_users&&t.addExternalUser(e.external_users),t.refresh(),e.start_date){const t=new Date(e.start_date),n=this.getControl("timeError"),o=new Date,s=t.getTime()+6e4*e.duration;let a=new Date(s);i.setDate(t),this.startHourInput.value=m(t.getHours())+":"+m(t.getMinutes()),this.endHourInput.value=m(a.getHours())+":"+m(a.getMinutes()),23===o.getHours()?n.show():n.hide()}},resetDate(){const e=this.getControl("datePicker"),t=new Date,i=this.getControl("timeError");if(e.setMinDate(new Date(0)),this.model){const n=new Date(this.model.get("start_date")),o=this.model.getEndDate();e.setDate(n),this.startHourInput.value=m(n.getHours())+":"+m(n.getMinutes()),this.endHourInput.value=m(o.getHours())+":"+m(o.getMinutes()),23===t.getHours()?i.show():i.hide()}else if(23===t.getHours()){i.show();let n=new Date;n.setDate(t.getDate()+1),e.setDate(n),this.startHourInput.value="00:00",this.endHourInput.value="01:00"}else e.setDate(t),this.startHourInput.value=m(t.getHours()+1)+":"+m(0),this.endHourInput.value=m(t.getHours()+2)+":"+m(0),i.hide();e.setMinDate(t)},_createContent:function(){const e=this.getControl("datePicker");return this.resetDate(),[{class:"social-event-editor",html:[{tag:"div",class:"schedule",html:[{tag:"div",class:"date",html:[{tag:"div",class:"heading",html:s.Date},e]},{tag:"div",class:"time startHour",html:[{tag:"div",class:"heading",html:s.startHour},this.startHourInput]},{tag:"div",class:"time endHour",html:[{tag:"div",class:"heading",html:s.endHour},this.endHourInput]}]},this.getControl("timeError"),this._isProviderActive&&this.addChildView("visioProviderEditorView",{Class:r}),this.getControl("extUsersEditView")]}]},getContentAttributes:function(){const t=this._parent.apply(this,arguments)||{},i=this.getControl("extUsersEditView").getExternalUsersArray();if(e.merge(t,{duration:this.getDuration(),start_date:this.getScheduleDate()||"",external_users:i.join(",")}),this._isProviderActive){const e=this.getChildView("visioProviderEditorView");e&&(t.provider=e.getConferenceProvider())}return t},getScheduleDate:function(){let e,t,i,n=this.getControl("datePicker").getDate(),o=this.startHourInput.value;return!(!n||!o)&&(e=o.split(":")[0],t=o.split(":")[1],n.setHours(e),n.setMinutes(t),(i=n.toISOString()).slice(0,-5)+"Z")},getDuration:function(){let e=new Date(this.getScheduleDate()),t=this.endHourInput.value,i=this.getControl("datePicker").getDate();if(t&&i){let n=t.split(":")[0],o=t.split(":")[1];i.setHours(n),i.setMinutes(o);let s=i.getTime()-e.getTime();return Math.floor(s/1e3/60)}return null},isStartEndHoursValid:function(){let e=this.startHourInput.value,t=this.endHourInput.value;return!(!e||!t)&&e.split(":").join("")<t.split(":").join("")},_setInvalid:function(e,t){t?e.hasClassName("invalid")||e.addClassName("invalid"):e.hasClassName("invalid")&&e.removeClassName("invalid")},_isScheduleDateValid:function(){let e=Date.now(),t=this.getScheduleDate(),i=new Date(t);return this.isContentEmpty()?(c.error(s.StartAndEndHoursNotProvided),!1):e>i.getTime()?(c.error(s.RdvScheduledInThePast),!1):!(i.getTime()<=e||!this.isStartEndHoursValid())||(this._setInvalid(this.startHourInput,!0),this._setInvalid(this.endHourInput,!0),c.error(s.startHourGreaterThanEndHour),!1)},isContentEmpty:function(){const e=this.getControl("datePicker");let t=!1;return e.getDate()?this._setInvalid(e.getContent(),!1):(t=!0,this._setInvalid(e.getContent(),!0)),""===this.startHourInput.value?(t=!0,this._setInvalid(this.startHourInput,!0)):this._setInvalid(this.startHourInput,!1),""===this.endHourInput.value?(t=!0,this._setInvalid(this.endHourInput,!0)):this._setInvalid(this.endHourInput,!1),t},validateContent:function(){return!!this._isScheduleDateValid()},reset:function(){this.resetDate(),this.getControl("extUsersEditView").reset()}})}),define("DS/SwymUIComponents/script/feature/community/community/view/community-new-request-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-new-request-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-creation-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUICore/script/feature/community/community/model/community-request-model","DS/SwymUIComponents/script/feature/core/search/view/user-search-factory","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUIComponents/script/feature/core/modal/modal","DS/UIKIT/Form","DS/UIKIT/Input/Button"],function(e,t,i,n,o,s,a,r,l,c,d){"use strict";return n.extend({_modelClass:s,_mode:null,name:"community-new-request-view",defaultOptions:{possibleOwners:null},_getModalHeader:function(){return this.model.isDMTransformationExpected()?t.communityFromConversationCreationRequest:t.communityCreationRequest},_getAutocompleteConfigForUsers:function(){var e=r.getInstance().get("user"),n=this._mode,o=this.model,s=o.get("primary_community_owner"),l=this;return a.getFormConfig({label:t.communityOwner,defaultValue:"edit"===n?s.first_name+" "+s.last_name:e.first_name+" "+e.last_name,events:{onSelect:function(t){"0"===t.ut_state?(this.resetInput(),o.addChanges("primary_community_owner_hash_key",e.hash_key),l.alert("error",i.Apendingusercannotbechosenasacommunitymainowner)):o.addChanges("primary_community_owner_hash_key",t.hash_key)}}})},_getUsersSelectOptions:function(){var e=r.getInstance().get("user"),t=[],i=this.getOption("possibleOwners");return i&&i.forEach(function(i){t.push({label:i.first_name+" "+i.last_name,value:i.login,selected:i.login===e.login})}.bind(this)),t},_getUsersSelectForConversationTransformation:function(){var e=this.model;return{type:"select",label:t.communityOwner,options:this._getUsersSelectOptions(),events:{onChange:function(){e.addChanges("hash_key",this.getValue()[0])}}}},_createContent:function(){var e=this.model,i=this._mode;if(e){var o="edit"===i?{tag:"div",styles:{padding:"10px","margin-bottom":"10px"},class:"bg-request-pending",html:e.get("additional_comment")}:null,a=n.extend({_modelClass:s,attributes:{tag:"div",class:"first-step"},_createContent:function(){return{html:[o,this.addControl("firstForm",new c({fields:[{type:"text",name:"title",maxlength:255,label:t.communityName,placeholder:t.chooseName,value:"edit"===i?e.get("title",{escapeHTML:!1}):"",required:!0,events:{onChange:function(){e.addChanges("title",this.getValue().trim())}}},{type:"radio",name:"visiblity",label:t.Public,checked:"edit"===i&&"1"===e.get("access"),events:{onChange:function(){e.addChanges("intranet_access",1)}}},{type:"radio",name:"visiblity",label:t.Private,checked:"edit"===i&&"0"===e.get("access"),events:{onChange:function(){e.addChanges("intranet_access",0)}}},{type:"radio",name:"visiblity",label:t.Secret,checked:"edit"!==i||"4"===e.get("access"),events:{onChange:function(){e.addChanges("intranet_access",4)}}}]}))]}}.bind(this)}),m=n.extend({_modelClass:s,attributes:{tag:"div",class:"second-step"},_createContent:function(){var n=r.getInstance().get("user");return"edit"!==i&&e.isNew()?e.addChanges("primary_community_owner_hash_key",n.hash_key):e.addChanges("primary_community_owner_hash_key",e.get("primary_community_owner_user_hash_key")),{html:[o,this.addControl("secondForm",new c({fields:[{type:"textarea",name:"description",maxlength:250,label:t.communityDescription,placeholder:t.giveDescription,value:"edit"===i?e.get("description",{escapeHTML:!1}):"",required:!0,events:{onChange:function(){e.addChanges("description",this.getValue().trim())}}},{type:"textarea",name:"benefits",maxlength:250,label:t.expectedBenefits,placeholder:t.keyBenefits,value:"edit"===i?e.get("benefits",{escapeHTML:!1}):"",required:!0,events:{onChange:function(){e.addChanges("benefits",this.getValue().trim())}}},this.getOption("possibleOwners")?this._getUsersSelectForConversationTransformation():this._getAutocompleteConfigForUsers()]}))]}}.bind(this)}),u=this.addControl("previousButton",new d({value:t.Previous,events:{onClick:function(){this.getControl("requestModal").setHeader("<h4>"+this._getModalHeader()+" (1/2)</h4>"),this.getControl("previousButton").hide(),this.getControl("nextButton").show(),this.getControl("sendButton").hide(),this.getChildView("secondStep").hide(),this.getChildView("firstStep").show()}.bind(this)}})),h=this.addControl("nextButton",new d({value:t.Next,events:{onClick:function(){this.getControl("firstForm").validate()&&(e.getChanges("title")&&""!==e.getChanges("title")?e.checktitleuniqueness({onComplete:function(e,i){!0===i.result?(this.getControl("requestModal").setHeader("<h4>"+this._getModalHeader()+" (2/2)</h4>"),this.getControl("previousButton").show(),this.getControl("nextButton").hide(),this.getControl("sendButton").show(),this.getChildView("firstStep").hide(),this.getChildView("secondStep").show()):(this.getControl("firstForm").getFields()[0].getParent(".form-group").addClassName("has-error"),this.alert("error",t.similarCommunityNameAlreadyExists))}.bind(this)}):e.isNew()||""===e.getChanges("title")||(this.getControl("requestModal").setHeader("<h4>"+this._getModalHeader()+" (2/2)</h4>"),this.getControl("previousButton").show(),this.getControl("nextButton").hide(),this.getControl("sendButton").show(),this.getChildView("firstStep").hide(),this.getChildView("secondStep").show()))}.bind(this)}})),p=this.addControl("sendButton",new d({value:"edit"===i?t.Update:t.Send,className:"primary",events:{onClick:function(){this.getControl("secondForm").validate()&&(e.isNew()&&e.getChanges("description")&&e.getChanges("benefits")&&e.getChanges("primary_community_owner_hash_key")?(this.getControl("previousButton").setDisabled(),this.getControl("sendButton").load(),e.save({},{onComplete:function(){this.getControl("requestModal").hide(),this.alert("success",t.thankYouWeAreGoingToAnalizeYourRequest)}.bind(this),onFailure:function(){this.getControl("requestModal").hide(),this.alert("error",t.TranformationRequestAlreadyDone)}.bind(this)})):e.isNew()||"edit"!==i||""===e.getChanges("description")||""===e.getChanges("benefits")||(this.getControl("previousButton").setDisabled(),this.getControl("sendButton").load(),e.set(e.getChanges()),e.action("update",{onComplete:function(){this.getControl("requestModal").hide(),this.alert("success",t.thankYouWeAreGoingToAnalizeYourRequest)}.bind(this)})))}.bind(this)}}));return"edit"!==i&&e.isNew()?e.addChanges("intranet_access",4):e.addChanges("intranet_access",e.get("access")),this.addControl("requestModal",new l({header:"<h4>"+this._getModalHeader()+" (1/2)</h4>",body:[this.addChildView("firstStep",{Class:a,model:e}),this.addChildView("secondStep",{Class:m,model:e,possibleOwners:this.getOption("possibleOwners")})],footer:[p,u,h],closable:!0,events:{onShow:function(){this.getControl("previousButton").hide(),this.getControl("nextButton").show(),this.getControl("sendButton").hide(),this.getChildView("firstStep").show(),this.getChildView("secondStep").hide()}.bind(this),onHide:function(){this.destroy()}.bind(this)}}))}},show:function(){this.getControl("requestModal").show()},setup:function(e){return e&&Object.hasOwnProperty.call(e,"mode")&&(this._mode=e.mode),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/community/view/community-request-status-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-request-status-view","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUICore/script/feature/community/community/collection/community-request-collection","DS/SwymUIComponents/script/feature/community/community/view/community-request-view","DS/SwymUIComponents/script/feature/community/community/view/community-new-request-view","DS/SwymUIComponents/script/feature/core/pagination/view/paging-toolbar-view","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/navigation","DS/SwymUIComponents/script/feature/core/modal/modal"],function(e,t,i,n,o,s,a,r,l,c,d){"use strict";return i.extend({_communityRequestCollection:null,name:"community-request-status-view",_createContent:function(){var i,m,u,h=l.getInstance().get("config").tenant,p=n.extend({_collectionClass:o,name:"community-history-request-collection-view",modelViewClass:s,_createModelView:function(){var e=this._parent.apply(this,arguments);return e.addEvent("onCommunityRequestClicked",this._onCommunityRequestClicked,this),e},_onCommunityRequestClicked:function(e,t){if("1"===e.get("status"))c.goToCommunity(e.get("mid")),this.getControl("communityRequestStatusModal").hide();else if("2"===e.get("status")||"0"===e.get("status"));else if("3"===e.get("status")){var i=new a({model:e,mode:"edit"});i.render(this._widget.body),i.show(),this.getControl("communityRequestStatusModal").hide()}}.bind(this),attributes:{tag:"table",class:"table table-reset table-hover table-condensed",styles:{"margin-bottom":"0"}},bodyAttributes:{tag:"tbody"},modelViewsCfg:{attributes:{tag:"tr",styles:{cursor:"pointer"}}}});return!0===h.plan_a_community?(i=this._communityRequestCollection&&this._communityRequestCollection.length>0?new p({collection:this._communityRequestCollection}):e.createElement("div",{styles:{padding:"10px","text-align":"center"},html:t.NoCommunityRequest}),m=new r({collection:this._communityRequestCollection}),u=this.addControl("communityRequestStatusModal",new d({closable:!0,header:"<h4>"+t.MyCommunityRequests+"</h4>",body:[i,m],events:{onHide:function(){this.destroy()}.bind(this)}}))):(i=e.createElement("div",{styles:{padding:"10px","text-align":"center"},html:t.TheCommunityPlanningFunctionalityIsDisabled}),u=this.addControl("communityRequestStatusModal",new d({closable:!0,header:"<h4>"+t.MyCommunityRequests+"</h4>",body:i,events:{onHide:function(){this.destroy()}.bind(this)}}))),u},show:function(){this.getControl("communityRequestStatusModal").show()},setup:function(e){return e&&e.hasOwnProperty("communityRequestCollection")&&(this._communityRequestCollection=e.communityRequestCollection),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/core/user/view/edit-all-bar/edit-all-bar",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-view","DS/UIKIT/Input/Button","DS/PubSub/PubSub","DS/SwymUIComponents/script/feature/core/ui-components/edit-view-mode-switcher/edit-view-mode-switcher","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/edit-all-bar/edit-all-bar"],function(e,t,i,n,o,s){"use strict";var a={},r=t.extend({name:"edit-all-bar",_createContent:function(){var e=this;return{class:"bottom-bar",html:[new i({value:s.validate,className:"saveButton primary",events:{onClick:function(t){this.load();for(var i,n=!0,r={},l=o.instances.length,c=0;c<l;c++)(i=o.instances[c])&&(n=n&&i._actionOnSave(!0));if(n){for(l=o.instances.length,c=0;c<l;c++)(i=o.instances[c])&&(i.model&&delete(r=i.model.getChanges()).countryForRead,(i.model&&Object.keys(r).length>0||"language"===i.model.getModelName())&&i._actionOnSave(!1,!0));setTimeout(this.load.bind(this,!1),1e3),a.hide()}else e.alert("error",s.pleaseFillTheFieldsCorrectly),setTimeout(this.load.bind(this,!1),1e3)}}}),this.addControl("cancel-button",new i({value:s.cancel,className:"cancelButton default",events:{onClick:function(e){for(var t,i=o.instances.length,n=0;n<i;n++)(t=o.instances[n])&&t.isRendered()&&t.onCancelClick();a.hide()}.bind(this)}}))]}}}),l=null;return a.getEditAllBarInstance=function(){return null===l&&(l=new r).render(document.body.getElement(".user-app-view-with-scroll-container")),l},a.show=function(){var e=this.getEditAllBarInstance(),t=document.body.getElement(".user-app-view-with-scroll-container");e.show(),n.dispatch("editAll",!0,!0),t&&(t.addClassName("edit-all-activated"),t.removeClassName("edit-all-deactivated"),t.setStyle("margin-bottom","50px"))},a.hide=function(){if(null!==l){var e=this.getEditAllBarInstance(),t=document.body.getElement(".user-app-view-with-scroll-container");e.hide()}t&&(t.hasClassName("edit-all-activated")&&n.dispatch("editAll",!1,!0),t.removeClassName("edit-all-activated"),t.addClassName("edit-all-deactivated"),t.setStyle("margin-bottom","0px"))},a}),define("DS/SwymUIComponents/script/feature/community/content/social-interactions/patched-social-toolbar/patched-st-utils",["DS/SwymUIComponents/script/feature/core/user/view/user-picture-view","DS/SwymUICore/script/feature/core/user/model/user-model"],function(e,t){"use strict";var i={renderUserPicture:function(){var i=this.model,n=new e({imageRenderingOptions:{cls:i.get("parentCommentUri")?"reply-author st-user-picture":"comment-author st-user-picture"},model:new t({login:i.get("author")?i.get("author").login:i.get("login"),username:""})});return n.render(),this.components.add(n),n}};return i}),define("DS/SwymUIComponents/script/feature/community/content/social-interactions/patched-social-toolbar/patched-interactor-view",["DS/SocialToolbar/Views/InteractorView","DS/SwymUIComponents/script/feature/community/content/social-interactions/patched-social-toolbar/patched-st-utils"],function(e,t){e.prototype._renderUserPicture=function(){return t.renderUserPicture.apply(this,arguments)}}),define("DS/SwymUIComponents/script/utils/swym-vuex-store",["DS/SwymUIComponents/script/utils/swym-vue","DS/SwymUIComponents/script/utils/vuex-modules/typing-indicator-module"],(e,t)=>{"use strict";const{Vue:i,Vuex:n}=e;return new n.Store({modules:{typingIndicator:t}})}),define("DS/SwymUIComponents/script/feature/core/ui-components/typing-indicator-view",["DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUIComponents/script/utils/swym-vue","DS/SwymUIComponents/script/utils/swym-vuex-store","i18n!DS/SwymUIComponents/assets/nls/feature/core/ui-components/typing-indicator-view"],(e,t,i,n)=>{"use strict";const{Vue:o}=t,s=!isNaN(document&&document.RTStore&&document.RTStore.apiVersion),a="oneUserWithName",r="oneUserWithoutName",l="multipleUsers",c="none",d=(e,t)=>{switch(e){case a:return n.replace(n.get("UserIsTyping"),{user:t.split(" ").shift()});case r:return n.get("IsTyping");case l:return n.replace(n.get("UsersAreTyping"),{n:t});case c:default:return""}};return e.extend({indicator:null,onRender(){this._parent.apply(this,arguments),this.indicator||(this.indicator=this.getVueInstance())},toggleContainerClass(e){this.container&&(e?this.container.hasClassName("third-line")&&this.container.addClassName("with-status"):this.container.removeClassName("with-status"))},_createContent:()=>'<div class="typing-indicator-container"></div>',getVueInstance(){const e=this,t=this.getOption("threadId"),n=this.getOption("users")||[],c=this.getOption("isTimeline"),m=`\n\t\t\t\t<${c?"SwymTypingIndicator":"SwymText"} :displayText="typingText" />\n\t\t\t\t`;return new o({el:e.container.getElement(".typing-indicator-container"),template:m,store:i,mounted(){if(s){const e=c?this.$store.state.activeThreadId:t,i=n.map(e=>e.get("login"));this.$store.dispatch("typingIndicator/channels/setUserList",{channel_id:e,login_array:i})}},computed:{typingText(){if(!s){if(!this.$store.getters["typingIndicator/isChannelPresent"](c?"all":t))return e.toggleContainerClass(null),null}const i=this.$store.getters["typingIndicator/usersTyping"](c?"all":t);if(!i.length)return e.toggleContainerClass(null),null;let o="";return o=1===i.length?c||n.length>2?d(a,i[0]):d(r):d(l,i.length),e.toggleContainerClass(o),o}}})}})}),define("DS/SwymUIComponents/script/feature/core/ui-components/tile-contextual-action-menu",["DS/SwymUICore/script/lib/event-manager","DS/UIKIT/DropdownMenu","DS/SwymUIComponents/script/feature/core/modal/super-modal","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/utils/usage-tracker","DS/SwymUIComponents/script/feature/core/ui-components/layout/layout-manager","i18n!DS/SwymUIComponents/assets/nls/feature/core/ui-components/community-contextual-action-menu","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-detailed-view","DS/UWPClientControls/PlatformNotify","DS/SwymUICore/script/feature/community/timeline/mark/marks-manager","i18n!DS/SwymUIComponents/assets/nls/feature/direct-message/direct-messages","DS/SwymUICore/script/utils/navigation","DS/SwymUIComponents/script/utils/progressive-disclosure-manager","DS/Logger/Logger"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h){"use strict";return t.extend({position:"left",defaultOptions:{maxItemsBeforeScroll:20,responsiveMode:!0,scrollMode:!0},_context:null,_widget:null,_contentCreated:!1,init:function(e){if(e.items=[{name:"loading",text:a.Loading}],e.className="tile-contextual-action-menu",this.model=e.model,!e.target)throw new Error("The target must be specified!");this._widget=e.widget,this._parent.call(this,e),this._context=n.getInstance()},_unselectItem:function(){var e=this.getSelectedItems().pop();e&&(e.elements.container.removeClassName("selected"),e.selected=!1)},_communityPageHandler:function(e){this._context.getCommunityPageContext()===e?(this._unselectItem(),this._navigateTo("")):this._navigateTo(e)},_addItems:function(e,t){var i=this.model.get("id").startsWith("dm");const n=this.model.isBlacklisted(),o=this.model.isFavorite(),s=!!this.model.has("is_hidden")&&this.model.get("is_hidden");for(;this.items.length>0;)this.removeItem(0);this.model.get("_containsContentUnreadByCurrentUser")&&!s&&this.addItem({name:"mark",text:r.MarkAsRead,fonticon:"eye",handler:this._onMarkAsReadItemClick.bind(this,t)}),!s&&e&&this.addItem({name:"favorite",text:o?r.RemoveFromFavorites:r.AddAsFavorite,fonticon:o?"favorite-delete":"favorite-add",handler:this._onFavoriteToggleItemClick.bind(this,t)}),i?s?this.addItem({name:"Restore Conversation",text:d.RestoreConversation,fonticon:"eye",handler:this._onRestoreDirectMessage.bind(this)}):this.addItem({name:"close",text:r.CloseConversation,fonticon:"times",handler:this._onCloseConversationItemClick.bind(this)}):this.addItem({name:"follow-toggle",className:"follow-toggle",text:n?r.Follow:r.Unfollow,fonticon:n?"eye":"eye-slash",handler:this._onFollowToggleItemClick.bind(this)})},_navigateTo:function(e){var t=this._context;t.reset({dmId:t.dmId,communityId:t.communityId,path:(t.dmId?"dm":"community")+":"+t.communityId+"/"+e}),s.dispatchEvent("onScrollToTopRequest")},_onFollowToggleItemClick:function(){const t=this.model,n=new i({closable:!0,renderTo:window.document.body||this._widget.body});if(!1===t.get("isBlacklisted")){let i=`${r.Hideallupdates}  ${t.get("title").unescapeHTML()}`;n.confirm({title:i,message:r.Youwillstillbe,callback:function(i){!0===i&&t.unfollow({onFailure:function(){},onComplete:function(){l.success(r.nownotfollowing),t.set("isBlacklisted",!0),e.dispatchEvent("requestContentListUpdate",{contextPath:"home"}),o.trackPageEvent({category:"MyCommunities",label:"unFollowThroughContextualMenu",view:"community-item-view",event:"click",device:"desktop"})}})}})}else t.follow({onFailure:function(){},onComplete:function(){l.success(r.nowfollowing),t.set("isBlacklisted",!1),e.dispatchEvent("requestContentListUpdate",{contextPath:"home"})}})},_onFavoriteToggleItemClick:function(e){var t;const i="community"==e?"MyCommunities":"MyConversations",n="community"==e?"community-item-view":"direct-message-view";!1===this.model.get("is_favorite")?(this.model.updateFavorite(!0),t="createFavoriteThroughContextualMenu"):(this.model.updateFavorite(!1),t="deleteFavoriteThroughContextualMenu"),o.trackPageEvent({category:i,label:t,view:n,event:"click",device:"desktop"})},_onCloseConversationItemClick:function(){new i({closable:!0,renderTo:window.document.body||this._widget.body}).confirm({title:d.HideDMConfirmationModalTitle,message:d.HideDMConfirmationModalMsg,callback:function(e){!0===e&&this.model.hide({onComplete:function(){this.alert("success",d.ConversationHidden),o.trackPageEvent({category:"MyConversations",label:"closeThroughContextualMenu",view:"direct-message-view",event:"click"})}.bind(this),onFailure:function(){h.log("an error occured while hiding the DM")}})}.bind(this)})},_onMarkAsReadItemClick:function(e){const t="community"==e?"MyCommunities":"MyConversations",i="community"==e?"community-item-view":"direct-message-view";this.model.set("mark",{message_id:this.model.get("last_message").message_id}),c.push(this.model),o.trackPageEvent({category:t,label:"markAsReadThroughContextualMenu",view:i,event:"click",device:"desktop"})},_onRestoreDirectMessage:function(){this.model.unhide({onComplete:function(e){h.log("is unhidden now"),m.goToDM(e.get("mid")),o.trackPageEvent({category:"MyConversations",label:"restoreThroughContextualMenu",view:"direct-message-view",event:"click",device:"desktop"})}.bind(this),onFailure:function(){h.log("an error occured while hiding the DM")}})},_drawMenu:function(e){this.progressiveDisclosureManager=u.getInstance(),this.isFavoriteDisplay=this.progressiveDisclosureManager.getCurrentDisplayState(e).shouldDisplayFavorites,this._addItems(this.isFavoriteDisplay,e)},onShow:function(){this.model.isBlacklisted(),this.model.isFavorite();const e="community"===this.model._modelName?"community":"conversation";for(;this.items.length>0;)this.removeItem(0);this.addItem({name:"loading",text:a.Loading}),this._drawMenu(e),this.dispatchEvent("MenuDrawn"),this._contentCreated=!0},onHide:function(e){this.dispatchEvent("deactivateChevron")},destroy:function(e){return this._widget=null,this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/direct-message/view/direct-message-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","DS/SwymUIComponents/script/feature/core/user/view/user-picture-view","DS/SwymUICore/script/utils/date","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/utils/usage-tracker","DS/Logger/Logger","DS/SwymUIComponents/script/feature/core/modal/super-modal","i18n!DS/SwymUIComponents/assets/nls/feature/direct-message/direct-messages","DS/SwymUIComponents/script/feature/core/ui-components/tile-contextual-action-menu","DS/SwymUIComponents/script/utils/progressive-disclosure-manager","UWA/Utils/Client","DS/UIKIT/Tooltip"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w){let C=null,f=null;return t.extend({name:"direct-message-view",_modelEvents:{"onChange:last_message":"_updateLastMessage","onChange:users":"refresh"},_modelEventsForAutoRefresh:["onChange:topic"],domEvents:{touchstart:"_startTouch",touchmove:"_moveTouch",touchend:"_endTouch","click .favorite-dm":"_addFavoriteDMClick","click .close-dm":"_closeDMClick","click .show-dm":"_onRestoreDirectMessage"},defaultOptions:{displayHideDMIcon:!0,displayCallIcons:!1,displaySecondLine:!0},_modelClass:n,setup(e){this._boostrapInstance=i.getInstance(),this._context=r.getInstance();const t=p.getInstance();return this.isFavoriteDisplay=t.getCurrentDisplayState("conversation").shouldDisplayFavorites,t.addEvent("favoritesDisplayChange",this._progressiveRefresh,this),this.isMobile=g.Features.touchEvents,this._parent.call(this,e)},_progressiveRefresh(e){if("conversation"===e&&!this.isDestroyed()){if(this.isMobile){const e=this.container;e.setStyles({transform:""}),e.setStyles({transition:""})}this.refresh()}},onSetModel(){this._resetRTAudioVideoApi()},_updateLastMessage(){var t=this.container.getElement(".second-line"),i=this.model.get("last_message")&&this.model.get("last_message").message_details,n="";t&&(n=this.model.getLastUnreadContentSummary()?e.createElement("div",{html:this.model.getLastUnreadContentSummary()}).getText():"",t.setContent(n.escapeHTML()),i&&i.media_type&&e.createElement("span",{class:`fonticon fonticon-${a.getMediaIconName(i.media_type)}`}).inject(t,"top"))},_onRestoreDirectMessage(){this.model.unhide({onComplete:function(e){d.log("is unhidden now"),l.goToDM(e.get("mid")),this.refresh()}.bind(this),onFailure(){d.log("an error occured while hiding the DM")}})},_filterUserCollection(){var e=this,t=e.model.getAssociated("users");e._userCollectionWithoutMe=t.filter(function(t){return t.get("login")!==e._boostrapInstance.get("user").login}),e._currentUserModel=t.filter(function(t){return t.get("login")===e._boostrapInstance.get("user").login})[0],e.listenTo(t,"onCollectionChange",e._filterUserCollection)},_getUserPictureViewWithoutMe(e,t){var i=this._userCollectionWithoutMe[e];return i?new o({displayPresence:!0===t,model:i}):this.createDummyView()},_getCurrentUserPictureView(e){return this._currentUserModel?new o({displayPresence:!0===e,model:this._currentUserModel}):this.createDummyView()},_getIconView(){var e;switch(this._userCollectionWithoutMe.length){case 0:e=this.addChildView("icon-view",this._getCurrentUserPictureView(!0));break;case 1:e=this.addChildView("icon-view",this._getUserPictureViewWithoutMe(0,!0));break;case 2:e=[{class:"tiny-pictures two-picture-view",html:[this.addChildView("first-icon-view",this._getUserPictureViewWithoutMe(0)),this.addChildView("second-icon-view",this._getUserPictureViewWithoutMe(1))]}];break;case 3:e=[{class:"tiny-pictures three-picture-view",html:[this.addChildView("first-icon-view",this._getUserPictureViewWithoutMe(0)),this.addChildView("second-icon-view",this._getUserPictureViewWithoutMe(1)),this.addChildView("third-icon-view",this._getUserPictureViewWithoutMe(2))]}];break;case 4:e=[{class:"tiny-pictures four-picture-view",html:[this.addChildView("first-icon-view",this._getUserPictureViewWithoutMe(0)),this.addChildView("second-icon-view",this._getUserPictureViewWithoutMe(1)),this.addChildView("third-icon-view",this._getUserPictureViewWithoutMe(2)),this.addChildView("fourth-icon-view",new o({displayPresence:!1,model:this._currentUserModel}))]}];break;default:e=[{class:"tiny-pictures four-picture-view",html:[this.addChildView("first-icon-view",this._getUserPictureViewWithoutMe(0)),this.addChildView("second-icon-view",this._getUserPictureViewWithoutMe(1)),this.addChildView("third-icon-view",this._getUserPictureViewWithoutMe(2)),{class:"number-of-items",html:`+${this._userCollectionWithoutMe.length-2}`}]}]}return e},_startTouch(e){C=e.touches[0].clientX,f=e.touches[0].clientY},_moveTouch(e){if(null===C)return;if(null===f)return;this.progressiveDisclosureManager=p.getInstance(),this.isFavoriteDisplay=this.progressiveDisclosureManager.getCurrentDisplayState("conversation").shouldDisplayFavorites;const t=e.touches[0].clientX,i=e.touches[0].clientY,n=C-t,o=f-i,s=this.isFavoriteDisplay?"-144px":"-72px",a=this.isFavoriteDisplay?"grid":"none";if(Math.abs(n)>Math.abs(o))if(n>0){const t=e.target.getClosest(".thread-view");t.setStyles({transform:`translate(${s}, 0px)`}),t.setStyles({transition:"all 1s ease-in"}),t.setStyles({opacity:"1"}),t.setStyles({"animation-duration":"0.2s"});const i=t.querySelector("[class=tile-menu]");i.setStyles({right:s}),i.querySelector("[class=favorite-dm]").setStyles({display:a})}else{e.target.getClosest(".thread-view").setStyles({transform:"translate(0px, 0px)"})}},_endTouch(e){console.log("touched event end")},_addFavoriteDMClick(){let e;!1===this.model.get("is_favorite")?(this.model.updateFavorite(!0),e="createFavoriteThroughContextualMenu"):(this.model.updateFavorite(!1),e="deleteFavoriteThroughContextualMenu"),c.trackPageEvent({category:"MyConversations",label:e,view:"direct-message-view",event:click,device:"touch"})},_closeDMClick(){new m({closable:!0,renderTo:window.document.body||this._widget.body}).confirm({title:u.HideDMConfirmationModalTitle,message:u.HideDMConfirmationModalMsg,callback:function(e){!0===e&&this.model.hide({onComplete:function(){this.alert("success",u.ConversationHidden),c.trackPageEvent({category:"MyConversations",label:"closeThroughContextualMenu",view:"direct-message-view",event:"click",device:"touch"})}.bind(this),onFailure(){d.log("an error occured while hiding the DM")}})}.bind(this)})},_onRestoreDirectMessage(){this.model.unhide({onComplete(e){l.goToDM(e.get("mid")),c.trackPageEvent({category:"MyConversations",label:"restoreThroughContextualMenu",view:"direct-message-view",event:"click",device:"touch"})},onFailure(){d.log("an error occured while hiding the DM")}})},getLabel(){return this._filterUserCollection(),this.model.getMembersTitle(this._boostrapInstance.get("user").login)},_resetRTAudioVideoApi(){this._context.isDirectMessageContext()&&this.model instanceof n&&this._rtAudioVideoApi&&(this._rtAudioVideoApi.destroy(),this._rtAudioVideoApi=null)},_onContextualMenuShow(e){e.getElement(".fonticon-down-open").addClassName("active"),this.model.get("_containsContentUnreadByCurrentUser")&&(e.getClosest(".thread-view").getElement(".other-info .first-line").setStyles({"font-weight":"bold"}),e.getClosest(".thread-view").removeClassName("with-unread-content"))},_createContent(){var t,i,n=this;return i=e.createElement("div",{class:"tile-action-menu",html:{tag:"span",class:"fonticon fonticon-down-open"}}),this._filterUserCollection(),t=this.model.getMembersTitle(this._boostrapInstance.get("user").login),this.addChildView("third-line",{Class:"DS/SwymUIComponents/script/feature/core/ui-components/typing-indicator-view",className:"third-line typing-indicator-timeline-wrapper",isTimeline:!1,users:this.model.getAssociated("users"),threadId:this.model.get("mid")}),this.model&&this.addControl("tileContextualActionMenu",new h({target:i,widget:this._widget,model:this.model,events:{onShow(){n._onContextualMenuShow(i)},onClick(){c.trackPageEvent({category:"ThreadPage",label:"clickItemInContextualMenu",view:"direct-message-view",event:"click"})},deactivateChevron(){i.getElement(".fonticon-down-open").removeClassName("active"),this.model.get("_containsContentUnreadByCurrentUser")&&(i.getClosest(".thread-view").getElement(".other-info .first-line").setStyles({"font-weight":""}),i.getClosest(".thread-view").addClassName("with-unread-content"))}}})),[{class:"icon-section",html:this._getIconView()},{class:"other-info",html:[{class:"first-line",html:[{class:"title",html:`<span class="title-span">${this.model.get("topic")?this.model.get("topic"):t}</span><span class="rt-icons"></span>`}]},this.getChildView("third-line"),!1!==this.getOption("displaySecondLine")?{class:"second-line",html:""}:""]},this.isMobile?"":i,{class:"tile-menu",html:[this.model.get("is_hidden")?{class:"show-dm",html:{tag:"span",class:"fonticon fonticon-eye"}}:[{class:"favorite-dm",html:{tag:"span",class:this.model.isFavorite()?"fonticon fonticon-favorite-delete":"fonticon fonticon-favorite-add"}},{class:"close-dm",html:{tag:"span",class:"fonticon fonticon-times"}}]]}]},_createRTAudioVideoViews(){var t=this,i=t.model;if(this._context.isDirectMessageContext()&&i instanceof n){var o=i.getAssociated("users").pluck("login");o.length>1&&require(["DS/RTAudioVideoAPI/RTAudioVideoAPI","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUIComponents/script/utils/media-utils"],function(n,s,r){var l=s.getInstance().get("user").login,{tenant:c}=s.getInstance().get("config"),d=o.filter(function(e){return e!==l});if(t._rtAudioVideoApi||(t._rtAudioVideoApi=new n({logins:d,tenantId:c.id,size:"24px",svgIcon:!1,dmId:i.get("mid"),renderAlertTo:r.getContainerForJoinCallAlert()})),a.isFeatureActivated("activateRTOptionsForAllUsersInConversation")||o.length<=15)t._rtAudioVideoApi.renderTo({container:t.container.getElement(".rt-icons"),type:"all"});else{const i=e.createElement("span",{class:"fonticon fonticon-phone noRTHelp"});t.addControl("noRTHelp",new w({target:i,body:u.NoRTHelp,position:"left"})),t.container.getElement(".rt-icons").addContent(i)}})}},onDestroy(){return this._rtAudioVideoApi&&this._rtAudioVideoApi.destroy(),p.getInstance().removeEvent("favoritesDisplayChange",this._progressiveRefresh),this._parent.apply(this,arguments)},onRedraw(){!0===this.getOption("displayCallIcons")&&this._createRTAudioVideoViews(),this._updateLastMessage()}})}),define("DS/SwymUIComponents/script/feature/core/user/view/small-user-tile-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/small-user-tile-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUIComponents/script/feature/core/network/view/invitation-layer-view","DS/W3DXComponents/Views/Item/TileView","DS/SwymUICore/script/feature/core/sprite/sprite","UWA/Class/Model","DS/W3DXComponents/Collections/ActionsCollection"],function(e,t,i,n,o,s,a,r,l,c,d){"use strict";return i.extend({_modelClass:n,name:"user-tile-view",className:"swym-tile",_addConnection:!1,_nicknameIsALink:!0,_invitationAlreadySent:null,setup:function(e){return(e=e||{}).addConnection&&(this._addConnection=!0),void 0!==e.nicknameIsALink&&(this._nicknameIsALink=e.nicknameIsALink),this._parent.apply(this,arguments)},removeSuggestion:function(){var e=this;this.model.removeSuggestion({onComplete:function(t,i){if("completed"===i.result.status){var n=[],s=e.model.collection;if(!s.idsToFilterArr){for(var a=0,r=s._models.length;a<r;a++)n.push(s._models[a].get("ID"));s.idsToFilterArr=n}if(s.memory&&0!==s.memory.length){var l=s.memory.indexOf(t);l>-1&&s.memory.splice(l,1),t=s.memory.shift(),e.setModel(t)}else{new o([],{mode:"getpeoplefamiliartocurrentuser",limit:6}).fetch({data:{idsToFilterArr:s.idsToFilterArr},onComplete:function(i){if(i.length>0){for(var n=0,o=i._models.length;n<o;n++)s.idsToFilterArr.push(i._models[n].get("ID")),i._models[n].collection=s;s.memory=i._models,t=s.memory.shift(),e.setModel(t)}else 1===Object.keys(e._parentView._childViews).length&&e.model.collection.dispatchEvent("noMoreRecommendation"),e.destroy()}})}}}})},invitLayer:function(){this.model.getInvitationStatus({onComplete:function(e,i){if(this._invitationStatus=i.result,"new"==this._invitationStatus.connected_user_to_user)this.alert("info",t.alreadySentInvitation);else if("0"==this._invitationStatus.user_in_network){var n=new a({model:this.model}),o=function(){this._invitationAlreadySent=!0}.bind(this);if(!0!==this._invitationAlreadySent){var s=this.container.getElement(".tile-container");s&&s.hide(),n.launch(o,!0,this.container)}else this.alert("info",t.alreadySentInvitation)}}.bind(this)})},_createContent:function(){var i;s.getInstance().isFeatureActivated("activate_user_network")&&(i=new d([{id:"invitemember",title:t.InviteMember,icon:"user-add",context:!0,overflow:!1},{id:"removemember",title:t.removefromsuggestions,icon:"cancel-squared",context:!0,overflow:!1}]));var o=new c({title:function(){var e='<a data-login="'+(this.model.get("login")?this.model.get("login"):"")+'" data-content-type="person" data-hash-key="'+(this.model.get("hash_key")?this.model.get("hash_key"):"")+'" class="link">'+this.model.getNickname()+"<a>",t='<a" class="link">'+this.model.getNickname()+"<a>";return this._nicknameIsALink?e:t}.bind(this),imgAttrs:function(){return l.getUserPictureAttributes({format:"normal",cls:"width-60px",hash_key:this.model.get("hash_key"),imageUpdateTime:this.model.get("picture_update"),dataIsLink:this._nicknameIsALink})}.bind(this),image:function(){return n.constructUserPictureUrl(this.model.get("login"),this.model.get("picture_update"),this.model.get("hash_key"),"normal")}.bind(this)});!0===this._addConnection&&s.getInstance().isFeatureActivated("activate_user_network")&&(o.actions=i);var a=new r({model:o,events:{onActionClick:function(e,t){var i=t.model;i&&!0===this._addConnection&&("removemember"===i.id?this.removeSuggestion():this.invitLayer())}.bind(this),onClick:function(){!0===this._addConnection&&this.invitLayer()}.bind(this)}});return e.createElement("div",{class:!0===this._addConnection?"add-connection-active":"",html:a.render()})}})}),define("DS/SwymUIComponents/script/feature/core/user/view/bot-tile-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/search/view/user-search-view","DS/SwymUIComponents/script/feature/community/members/view/member-tile-view","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/feature/core/command/commands-controller","DS/SwymUICore/script/utils/utils","i18n!DS/SwymUICore/assets/nls/feature/core/user/collection/member-collection"],function(e,t,i,n,o,s,a){"use strict";return i.extend({name:"bot-tile-view",_appIconUrl:"",domEvents:{"click .member-tile":"_onDoNothing"},_onDoNothing:function(){},_createPictureView:function(){var t=this;return t._appIconUrl||o._getCommands(function(e,i){i.forEach(function(e){e.botUsername===t.model.get("uri")&&(t._appIconUrl=e.appIconURL,t.refresh())})}),t._appIconUrl?e.createElement("div",{class:"bot-picture",html:[{tag:"img",src:t._appIconUrl}]}):""},_getCurrentRoleName:function(){return a.Bot||"Bot"},_getInlineActionsUpdate:function(e){return[{name:"delete",text:a.Delete,fonticon:"trash"}]},_displayBasicInfo:function(){var e=this.model;return{styles:{"text-align":"center"},html:[{class:"user-name member-name",html:"<a>"+e.get("first_name")+"</a>"},{styles:{margin:"10px 0","font-style":"italic"},html:(e.has("job_title")&&""!==e.get("job_title").trim()?e.get("job_title"):"")+(e.has("company")&&""!==e.get("company").trim()?(e.has("job_title")&&""!==e.get("job_title").trim()?", ":"")+e.get("company"):"")}]}}})}),define("DS/SwymUIComponents/script/feature/community/template/view/content-template-selector-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-view","DS/UIKIT/Autocomplete","DS/SwymUIComponents/script/feature/community/template/view/content-template","DS/SwymUIComponents/script/feature/community/template/collection/content-template-collection","DS/SwymUICore/script/lib/event-manager","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-feature-settings-view"],function(e,t,i,n,o,s,a){"use strict";return t.extend({name:"content-template-selector",_contentTemplateSelector:null,_templateDatasetName:null,_currentIdTemplateModel:null,_currentIdTemplateDataset:null,domEvents:{"click span.fonticon.item-icon.fonticon-trash":"onTemplateDelete","click span.fonticon.item-icon.fonticon-pencil":"onTemplateEdit"},getTemplateSuggestion:(e,t,i)=>({value:e,label:t,message:i}),_createContent:function(){return this.getControl("contentTemplateSelector")},setup:function(){this._parent.apply(this,arguments),this._templateDatasetName="templates",this.addControl("contentTemplateSelector",new i({placeholder:a.AvailableTemplates,disabled:!0,allowFreeInput:!0,showSuggestsOnFocus:!0,maxHeight:80,datasets:[{name:this._templateDatasetName,items:[],collection:new o([],{mode:"getTemplatesByContentType",limit:30}),configuration:{templateEngine:this.getOption("modeSettings")?n("trash"):n()}}],events:{onSelect:e=>{this.getOption("modeSettings")||s.dispatchEvent("onTemplateChange",[e]),this.container.getElement(".fonticon-trash")&&(this._currentIdTemplateModel=e.value,this._currentIdTemplateDataset=e.datasetId)}}}))},populateContentTemplateCollection:function(){const e=this,t=this.getControl("contentTemplateSelector"),i=t.getDataset(this._templateDatasetName).collection;let n=null,o=null;i.fetchPage(1,{data:{communityId:this.getOption("communityId"),contentType:this.getOption("contentType")},onComplete:i=>{if(console.log("success populate content template selector ",i),i.length>0){let a=[];i.forEach(e=>{const t=e.get("mid");n=e.get("title"),o=e.get("message"),a.push(this.getTemplateSuggestion(t,n,o)),s.dispatchEvent("onTemplateChange",[a])}),t.datasets&&t.cleanDataset(e._templateDatasetName),t.addItems(a,t.getDataset(e._templateDatasetName)),t.setDisabled(!1)}else s.dispatchEvent("onTemplateChange",[n,o])},onFailure:e=>{console.log("error to populate content template collection ",e)}})},onTemplateCreated:function(e,t,i){const n=this.getTemplateSuggestion(e,t,i),o=this.getControl("contentTemplateSelector");o.getDataset(this._templateDatasetName).collection.add(n),o.addItems(n,o.getDataset(this._templateDatasetName)),o.isDisabled()&&o.setDisabled(!1)},onTemplateDelete:function(){let e=null,t=this.getControl("contentTemplateSelector");t.getDataset(this._templateDatasetName).collection.forEach(t=>{t.get("mid")===this._currentIdTemplateModel&&(e=t)}),e.destroy({data:{templateId:this._currentIdTemplateModel},onComplete:()=>{t.removeDataset(this._currentIdTemplateDataset),t.onHideSuggests(),this.isEmpty()&&t.setDisabled(!0)},onFailure:()=>{console.log("error to delete model in template selector")}})},onTemplateEdit:function(){},setCommunityId:function(e){this.setOption("communityId",e)},setContentType:function(e){this.setOption("contentType",e)},show:function(){this.container.hasClassName("hidden")&&this.container.removeClassName("hidden")},hidden:function(){this.container.addClassName("hidden")},isEmpty:function(){const e=this.getControl("contentTemplateSelector").getItems();return!(e&&e.length>0)},removeItem:function(e){this.getControl("contentTemplateSelector").getItems().filter(t=>t.mid!==e)}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/external-rich-link-processing-utils",["UWA/Data","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/oembed-providers-list","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/edit/rich-link-preview/external-rich-link-processing-utils"],function(e,t,i){"use strict";var n={_parseHtml:function(e,t){var i,n,o,s,a,r=/<meta[^>]*?property\s*="?og:(image|description|title)"?[^<]*?>/gi,l=[];for(a=0;a<3&&null!=(s=r.exec(t));a++)l.push(s);for(a=0;a<l.length;a++){var c=l[a],d=new DOMParser,m=c[0].replace(/&nbsp;/g," "),u=m.length;"/"!=m.charAt(u-2)&&(m=m.substring(0,u-1)+"/"+m.substring(u-1));var h=d.parseFromString(m,"text/xml");switch(h.firstChild.getAttribute("property")){case"og:title":i=h.firstChild.getAttribute("content");break;case"og:description":n=h.firstChild.getAttribute("content");break;case"og:image":(o=h.firstChild.getAttribute("content"))&&(o=o.replace(/^http:\/\//i,"https://"))}}if(void 0===i){var p=t.match(/<title>?[\s\S].*?[\s\S]<\/title>/gi),g=getHostName(e);i=p&&p.toString().replace(/<[^>]*>/g,"")}return void 0===o&&(o="null"),{type:"html",title:i,description:n,image:o,url:e,domain:g&&g.domain,domainToDisplay:g&&g.domainToDisplay}},getURLInformation:function(t,o){e.request(t,{proxy:"ajax",onFailure:function(){require(["DS/UWPClientControls/PlatformNotify"],function(e){e.warn(i.urlNotReachable)})},onComplete:function(e,i){for(var s,a=Object.keys(i),r=a.length,l={};r--;)l[(s=a[r]).toLowerCase()]=i[s];(l["content-type"].match(/text\/html/g)||l["content-type"].match(/application\/xhtml/g))&&o(n._parseHtml(t,e,i))}})}};return n}),define("DS/SwymUIComponents/script/feature/core/network/view/multi-invitation-layer-view",["UWA/Core","DS/SwymUIComponents/script/feature/core/search/view/user-search-factory","DS/UIKIT/Form","i18n!DS/SwymUIComponents/assets/nls/feature/core/network/view/invitation-layer-view","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/components/user-search-config","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/user/model/user-model","DS/UIKIT/Input/Button","DS/SwymUICore/script/feature/core/notification/collection/notification-collection","DS/UWPClientCode/I18n"],function(e,t,i,n,o,s,a,r,l,c,d,m){"use strict";return r.extend({name:"multi-invitation-layer-view",_createContent:function(){var e=a.getInstance().get("user"),r=this;return[{class:"edit-content edit-style",html:this.addControl("autocomplete-form",new i({fields:[t.getFormConfig({loginsToExcludeFromSearch:[e.login],label:o.People,excludePendingUsers:!0,parentSwymView:this,multiSelect:!0}),{type:"textarea",name:"message",label:n.Message,value:e.first_name+" "+e.last_name+" "+n.textByDefaultInvitation}]}))},{class:"actionBar edit-style",html:[new c({value:n.Invite,className:"saveButton primary",events:{onClick:function(){var t=r.getControl("autocomplete-form");if(t){var i=t.validate(),o=t.autocompletes[0].getSelection();if(i){this.load();var a=new d([],{mode:"sendInvitations"}),c=function(){for(var i="",c=o.length,d=0,m=0;m<c;m++)new l({hash_key:o[m].hash_key,login:o[m].login}).getInvitationStatus({onComplete:function(o,l){d++;var m=l.result,u=!0;"0"==m.user_in_network&&"new"!==m.connected_user_to_user&&(i+=o.get("hash_key")+";",u=!1),d===c&&(!0===u?(r.alert("info",n.alreadyInNetwork),this.load(!1)):a.sendInvitations({data:{message:t.getField("message").value,groupIdProfessionnal:s.getInstance().getAssociated("groups").getIdGroupProfessional(),hash_keys:i},onComplete:function(){t.reset(),t.setValue("message",e.first_name+" "+e.last_name+" "+n.textByDefaultInvitation),this.load(!1),r.hide(),r.alert("success",n.invitationsSent)}.bind(this),onFailure:function(){}}))}.bind(this)})}.bind(this);s.getInstanceFetched(function(e){var t=s.getInstance().getAssociated("groups");t.setAssociated("currentUser",e),t.fetch({onComplete:function(){c()}})})}else r.alert("error",n.Pleasefillthefieldscorrectly)}}}}),new c({value:n.cancel,className:"cancelButton default",events:{onClick:function(){var t=r.getControl("autocomplete-form");t&&(t.reset(),t.setValue("message",e.first_name+" "+e.last_name+" "+n.textByDefaultInvitation)),r.hide();var i=r._parentView.getElement(".no-connection-engaging");i&&i.show()}}})]}]}})}),define("DS/SwymUIComponents/script/feature/community/report-abuse/view/report-abuse-view",["i18n!DS/SwymUIComponents/assets/nls/feature/community/report-abuse/view/report-new-abuse-view","UWA/Core","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/utils/date","DS/SwymUIComponents/script/feature/core/modal/super-modal","DS/SwymUICore/script/utils/utils"],function(e,t,i,n,o,s,a,r,l){"use strict";var c=n.getInstance();i.getInstance();return o.extend({_lastSubjectUri:null,_contentInfo:null,domEvents:{"click .content-link":"_onContentLinkClick"},_updateContentInfo:function(){var e,t,i=this.model;return this._lastSubjectUri=i.get("subjectUri"),e=(e=i.get("subjectUrl",{escapeHTML:!1})||i.get("linkUri",{escapeHTML:!1})).replace(/&#47;/g,"/"),this._contentInfo=c.extractContextInfoFromRoute(e),!this._contentInfo.communityId&&this._contentInfo.contentId&&i.get("contextUri")&&(t=i.get("contextUri").split(":")).length>1&&(this._contentInfo.communityId=t[t.length-1]),this._contentInfo},getModelName:function(){var t="",i=this.model;switch((i.get("model")||i.get("subjectType")||"").toLowerCase()){case"qnaquestion":case"iquestion":case"question":t=e.Iquestion;break;case"post":t=e.Post;break;case"media":t=e.Media;break;case"wiki":case"wikitree":t=e.Wiki;break;case"survey":case"poll":t=e.Survey;break;case"qnaanswer":case"answer":t=e["Iq-answer"];break;case"ideation":case"idea":t=e.Idea;break;case"qnacomment":case"comment":t=e.Comment;break;case"instantmessage":t=e.Message}return t},getContentType:function(){this.model;return this._updateContentInfo(),this._contentInfo.contentType||""},getContentId:function(){this.model;return this._updateContentInfo().contentId||""},getCommunityId:function(){this.model;return this._updateContentInfo().communityId||""},getReportType:function(){var i,n="",o=this.model;return i=o.get("reasons"),t.is(i,"array")&&(n=o.get("reasons").map(function(t){return e.get(t)}).join(" & ")),n},_createContent:function(){var e=this.model;if(e){this._confirmModal=new r({closable:!1,renderTo:this._widget.body});var t=e.getAssociated("author");return[{tag:"td",html:'<a data-content-type="person"'+(t.get("login")?' data-login="'+t.get("login")+'"':"")+(t.get("hash_key")?' data-hash-key="'+t.get("hash_key")+'"':"")+">"+t.getNickname()+"</a>"},{tag:"td",html:a.simpleDate(e.get("creationDate"))},{tag:"td",html:this.getModelName()},{tag:"td",html:'<a class="content-link" data-content-type="'+this.getContentType()+'" data-content-id="'+this.getContentId()+'"  data-community-id="'+this.getCommunityId()+'" >'+e.get("subjectTitle")+"</a>"},{tag:"td",html:this.getReportType()},{tag:"td",html:e.get("description")}]}},_displayConfirmationModal:function(t,i){if(!t)throw new Error("Current user instance is expected");this._confirmModal.confirm(e.Youdont,e.Confirm,function(e){!0===e&&t.setAccess({onComplete:function(){t.set("tenant_su","1"),s.goToUrl(i)}})})},_onContentLinkClick:function(e){e.stopPropagation(),e.preventDefault();var t,i=this,n=this.model,o=this.getContentType(),a={mid:i.getContentId()};this._updateContentInfo(),t=c.computeRoute(this._contentInfo),require(["DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/lib/model/generic/swym-model"],function(e,r){e.getInstanceFetched(function(e){"1"===e.get("tenant_su")?s.goToUrl(t):require([r.getModuleNameFromModelName(o),"DS/SwymUICore/script/feature/community/community/model/community-model"],function(r,c){if(!i.isDestroyed()){if("instantmessage"===o){var d=l.extractDataFromSubject6wURI(n.get("subjectUri"));r=c,a.mid=d.extraAttrs?d.extraAttrs.mid:""}new r(a,{autoPopulate:!0,onPopulate:function(n){i.isDestroyed()||("instantmessage"===o||n&&n.get("_acl")&&!0===n.get("_acl").update.access&&!0===n.get("_acl").delete.access?s.goToUrl(t):i._displayConfirmationModal(e,t))},onFailure:function(){i._displayConfirmationModal(e,t)}})}})})})}})}),define("DS/SwymUIComponents/script/feature/core/ui-components/list/list-item/compact-item-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUIComponents/script/feature/core/ui-components/layout/layout-manager"],function(e,t,i,n){"use strict";var o={UNDEFINED:-1,SUMMARY:0,DETAILED:1,EDIT:2},s={SUMMARY:"summaryView",DETAILED:"detailedView",EDIT:"editView"},a=function(e,t){void 0!==this.getOption(t)&&(e[t]=this.getOption(t))},r=i.extend({name:"dummy-item-view",_createContent:function(){return e.createElement("div",{class:"dummy-content-view",html:[{tag:"div",class:"dummy-content-header"},{tag:"div",class:"dummy-content-author-picture"},{tag:"div",class:"dummy-content-author-section"},{tag:"div",class:"dummy-content-line"},{tag:"div",class:"dummy-content-line"},{tag:"div",class:"dummy-content-line"},{tag:"div",class:"dummy-content-line"}]})}}),l=["comments","showAnswers","ActionMenuClass","iconCls","socialToolbarMode","showAuthorSection","showThreadLink","onAfterSocialToolbarRendered"];return t.extend({MODES:o,defaultOptions:{mode:o.UNDEFINED,summaryViewClass:"DS/SwymUIComponents/script/feature/community/content/view/compact-content-summary-view",detailedViewClass:"DS/SwymUIComponents/script/feature/community/content/view/content-detailed-view",editViewClass:"DS/SwymUIComponents/script/feature/community/content/edit/content-editor-view",summaryViewOptionsAttributes:l,detailedViewOptionsAttributes:l,editViewOptionsAttributes:["iconCls"],summaryViewEvents:void 0,detailedViewEvents:void 0,editViewEvents:void 0,comments:!0,showAnswers:!0},name:"content-in-feed-view",className:"community-content-wrapper content-item",_createSummaryView:function(){var e=this.model,t=this,i=null,n={Class:this.getOption("summaryViewClass"),model:e,socialFeaturesViewOptions:{enableComment:!0,enableShare:!1,isCompactView:!0}};return this.getOption("summaryViewOptionsAttributes").forEach(function(e){a.call(t,n,e)}),void 0!==this.getOption("summaryViewEvents")&&(n.events=this.getOption("summaryViewEvents")),e&&(i=this.addChildView("summaryView",n)),i},_createDetailedView:function(){var e=this.model,t=this,i=null,n={Class:this.getOption("detailedViewClass"),model:e};return this.getOption("detailedViewOptionsAttributes").forEach(function(e){a.call(t,n,e)}),void 0!==this.getOption("detailedViewEvents")&&(n.events=this.getOption("detailedViewEvents")),e&&(i=this.addChildView("detailedView",n)),i},_createEditView:function(){var e=this.model,t=this,i=null,n={Class:this.getOption("editViewClass"),model:e};return e&&(this.mask(),this.getOption("editViewOptionsAttributes").forEach(function(e){a.call(t,n,e)}),void 0!==this.getOption("editViewEvents")&&(n.events=this.getOption("editViewEvents")),i=this.addChildView("editView",{Class:"DS/SwymUICore/script/lib/view/generic/swym-view"}),e.fetch({fromCache:!0,onComplete:function(){t.unmask(),t.addChildView("editView",n)},onFailure:function(){t.unmask()}})),i},onRedraw:function(){this.isMasked()&&this.mask()},_createContent:function(){if(this.model)switch(this.getOption("mode")){case o.DETAILED:return this._createDetailedView();case o.EDIT:return this._createEditView();case o.SUMMARY:default:return this._createSummaryView()}},_switchToModeView:function(e){var t,i,n;if(this.getOption("mode")===o[e])return!1;if(this.setOption("mode",o[e]),this._rendered){for(var a in n=s[e],i=this.getChildView(n),s)Object.prototype.hasOwnProperty.call(s,a)&&a!==n&&(t=this.getChildView(s[a]))&&t.hide();i||(i=this._createContent()),this.container.contains(i.container)||i.inject(this.container),i.show(),i.refresh()}else this.render();return this},switchToDetailedView:function(e){(this._switchToModeView("DETAILED")||e)&&(this.container.removeClassName("edit-mode"),this.container.addClassName("full-content"),n.dispatchEvent("onSetInstanceTagsRequest",[this.model]))},switchToEditView:function(e){(this._switchToModeView("EDIT")||e)&&(this.container.addClassName("edit-mode"),this.container.addClassName("full-content"),n.dispatchEvent("onSetInstanceTagsRequest",[this.model]))},switchToSummaryView:function(){this._switchToModeView("SUMMARY")&&(this.container.removeClassName("edit-mode"),this.container.removeClassName("full-content"))},onUnMaximize:function(){this.switchToSummaryView()},createDummyView:function(){return new r}})}),define("DS/SwymUIComponents/script/feature/community/wiki/compact-wiki-view",["DS/SwymUICore/script/feature/community/wiki/model/wiki-model","DS/SwymUIComponents/script/feature/core/ui-components/list/list-item/compact-item-view"],function(e,t){return t.extend({_modelClass:e,name:"wiki-view",className:"community-content-wrapper content-item new",defaultOptions:{detailedViewClass:"DS/SwymUIComponents/script/feature/community/wiki/view/wiki-detailed-view",editViewClass:"DS/SwymUIComponents/script/feature/community/wiki/edit/wiki-edit-view"},_createDetailedView(...e){const t=this;if(this.setOption("detailedViewEvents",{onScrollToElement(e){t.dispatchEvent("onScrollToElement",e)}}),void 0!==this.getOption("showTreeIcon")){let e=this.getOption("detailedViewOptionsAttributes")||[];Array.isArray(e)||(e=[e]),this.setOption("detailedViewOptionsAttributes",[...e,"showTreeIcon"])}return this._parent(...e)}})}),define("DS/SwymUIComponents/script/feature/community/community/view/community-item-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUIComponents/script/feature/community/content/view/media-thumbnail-view","DS/SwymUIComponents/script/feature/core/ui-components/tile-contextual-action-menu","DS/SwymUICore/script/utils/usage-tracker","DS/SwymUIComponents/script/feature/core/modal/super-modal","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-detailed-view","DS/UWPClientControls/PlatformNotify","DS/SwymUIComponents/script/utils/progressive-disclosure-manager","DS/SwymUICore/script/lib/event-manager","UWA/Utils/Client"],function(e,t,i,n,o,s,a,r,l,c,d,m){var u=null,h=null;return t.extend({_modelClass:i,name:"community-item-view",domEvents:{touchstart:"_startTouch",touchmove:"_moveTouch",touchend:"_endTouch","click .favorite-community":"_addFavoriteClick","click .unfollow-community":"_onFollowToggleItemClick"},_modelEvents:{"onChange:_containsContentUnreadByCurrentUser":"_updateReadUnreadStatus"},_modelEventsForAutoRefresh:["onChange:logo_media_id","onChange:title"],init(e){e&&!1===e.delegateSpriteReloadToParentView&&(this._delegateSpriteReloadToParentView=!1);const t=c.getInstance();this.isFavoriteDisplay=t.getCurrentDisplayState("community").shouldDisplayFavorites,t.addEvent("favoritesDisplayChange",this._progressiveRefresh,this),this.isMobile=m.Features.touchEvents,this._parent.apply(this,arguments)},_progressiveRefresh(e){if("community"===e&&!this.isDestroyed()){if(this.isMobile){const e=this.container;e.setStyles({transform:""}),e.setStyles({transition:""})}this.refresh()}},_updateReadUnreadStatus(){var e=this;setTimeout(function(){e.container.parentElement&&(!0===e.model.get("_containsContentUnreadByCurrentUser")?e.container.parentElement.addClassName("with-unread-content"):e.container.parentElement.removeClassName("with-unread-content"))},1)},_startTouch(e){u=e.touches[0].clientX,h=e.touches[0].clientY},_moveTouch(e){if(null===u)return;if(null===h)return;this.progressiveDisclosureManager=c.getInstance(),this.isFavoriteDisplay=this.progressiveDisclosureManager.getCurrentDisplayState("community").shouldDisplayFavorites;const t=e.touches[0].clientX,i=e.touches[0].clientY,n=u-t,o=h-i,s=this.isFavoriteDisplay?"-144px":"-72px",a=this.isFavoriteDisplay?"grid":"none";if(Math.abs(n)>Math.abs(o))if(n>0){const t=e.target.getClosest(".thread-view");t.setStyles({transform:`translate(${s}, 0px)`}),t.setStyles({transition:"all 1s ease-in"}),t.setStyles({opacity:"1"}),t.setStyles({"animation-duration":"0.2s"});const i=t.querySelector("[class=tile-menu]");i.setStyles({right:s}),i.querySelector("[class=favorite-community]").setStyles({display:a})}else{const t=e.target.getClosest(".thread-view");t.setStyles({transform:"translate(0px, 0px)"}),t.setStyles({transition:"all 1s ease-in"})}},_endTouch(e){},_addFavoriteClick(){let e;!1===this.model.get("is_favorite")?(this.model.updateFavorite(!0),e="createFavoriteThroughContextualMenu"):(this.model.updateFavorite(!1),e="deleteFavoriteThroughContextualMenu"),s.trackPageEvent({category:"MyCommunities",label:e,view:"community-item-view",event:"click",device:"touch"})},_onFollowToggleItemClick(){const e=this.model,t=new a({closable:!0,renderTo:window.document.body||this._widget.body});if(!1===e.get("isBlacklisted")){const i=`${r.Hideallupdates}  ${e.get("title").unescapeHTML()}`;t.confirm({title:i,message:r.Youwillstillbe,callback(t){!0===t&&e.unfollow({onFailure(){},onComplete(){l.success(r.nownotfollowing),e.set("isBlacklisted",!0),d.dispatchEvent("requestContentListUpdate",{contextPath:"home"}),s.trackPageEvent({category:"MyCommunities",label:"unFollowThroughContextualMenu",view:"community-item-view",event:"click",device:"touch"})}})}})}else e.follow({onFailure(){},onComplete(){l.success(r.nowfollowing),e.set("isBlacklisted",!1),d.dispatchEvent("requestContentListUpdate",{contextPath:"home"})}})},_onContextualMenuShow(e){e.getElement(".fonticon-down-open").addClassName("active"),this.model.get("_containsContentUnreadByCurrentUser")&&(e.getClosest(".thread-view").getElement(".info-section").setStyles({"font-weight":"bold"}),e.getClosest(".thread-view").removeClassName("with-unread-content"))},_createContent(){var t,i=this,{model:a}=i;return t=e.createElement("div",{class:"tile-action-menu",html:{tag:"span",class:"fonticon fonticon-down-open"}}),this.model&&this.addControl("tileContextualActionMenu",new o({target:t,widget:this._widget,model:this.model,events:{onShow(){i._onContextualMenuShow(t)},onClick(){s.trackPageEvent({category:"ThreadPage",label:"clickItemInContextualMenu",view:"community-item-view",event:"click"})},deactivateChevron(){t.getElement(".fonticon-down-open").removeClassName("active"),this.model.get("_containsContentUnreadByCurrentUser")&&(t.getClosest(".thread-view").getElement(".info-section").setStyles({"font-weight":""}),t.getClosest(".thread-view").addClassName("with-unread-content"))}}})),[i.addChildView("contentThumbnail",{Class:n,model:a,className:"no-community-rich-tooltip",imageRenderingOptions:{cls:"img-community-home"},refreshOnFingerprintChange:!1}),{class:"info-section",html:[{class:"title",html:a.get("title")}]},this.isMobile?"":t,{class:"tile-menu",html:[{class:"favorite-community",html:{tag:"span",class:this.model.isFavorite()?"fonticon fonticon-favorite-delete":"fonticon fonticon-favorite-add"}},{class:"unfollow-community",html:{tag:"span",class:this.model.isBlacklisted()?"fonticon fonticon-eye":"fonticon fonticon-eye-slash"}}]}]},destroy(){c.getInstance().removeEvent("favoritesDisplayChange",this._progressiveRefresh),this._parent.call(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/embedded-rich-link-preview-model",["UWA/Core","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/abstract-rich-link-preview-model"],function(e,t){"use strict";return t.extend({defaults:{iframe:""}})}),define("DS/SwymUIComponents/script/feature/community/community/view/community-creation-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-creation-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUIComponents/script/feature/core/search/view/user-search-factory","DS/SwymUICore/script/utils/navigation","DS/SwymUIComponents/script/feature/core/modal/modal","DS/UIKIT/Form","DS/UIKIT/Input/Button","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/lib/model/model-manager","DS/WebappsUtils/Console"],function(e,t,i,n,o,s,a,r,l,c,d,m){"use strict";return i.extend({_modelClass:n,name:"community-creation-view",_currentUser:null,defaultOptions:{possibleOwners:null},_getUsersSelectOptions:function(){var e=[],t=this.getOption("possibleOwners");return t&&t.forEach(function(t){e.push({label:t.first_name+" "+t.last_name,value:t.login,selected:t.login===this._currentUser.login})}.bind(this)),e},_getUsersSelectForConversationTransformation:function(){var e=this.model;return{type:"select",label:t.CommunityOwner,options:this._getUsersSelectOptions(),events:{onChange:function(){e.addChanges("hash_key",this.getValue()[0]),m.log("community owner has changed")}}}},_getUserSearchForm:function(){var e=this;return o.getFormConfig({label:t.CommunityOwner,defaultValue:this._currentUser.login,events:{onSelect:function(t){e.model.addChanges("hash_key",t.hash_key),m.log("community owner has changed"),e.getControl("createButton").enable()},onNoResults:function(i,n){console.warn("No result founds",i,n),require(["DS/UWPClientControls/PlatformNotify"],function(e){e.error(t.CurrentUserNotFound)}),e.getControl("createButton").disable()}}})},_createContent:function(){var e=this,i=this.model;if(i)return i.addChanges("hash_key",this._currentUser.hash_key),this.addControl("communityCreationForm",new r({fields:[{type:"text",name:"title",pattern:"(?:\\s*[^\\s]+\\s*)+",maxlength:255,label:t.Title,required:!0,value:i.getChanges("title",{escapeHTML:!1})?i.getChanges("title",{escapeHTML:!1}):"",events:{onChange:function(){i.addChanges("title",this.getValue().trim())},onKeyDown:function(){this.getContent().getParent(".form-group").removeClassName("has-error")}}},{type:"textarea",name:"description",label:t.Description,pattern:"(?:\\s*[^\\s]+\\s*)+",maxlength:250,required:!0,events:{onChange:function(){i.addChanges("description",this.getValue().trim())}}},this.model.isDMTransformationExpected()?this._getUsersSelectForConversationTransformation():this._getUserSearchForm()]})),this.addControl("cancelButton",new l({value:t.Cancel,events:{onClick:function(){this.getControl("communityCreationModal").hide()}.bind(this)}})),this.addControl("createButton",new l({value:t.Create,className:"primary",events:{onClick:function(){this.getControl("communityCreationForm").validate()&&i.checktitleuniqueness({onComplete:function(i,o){!0===o.result?(this.getControl("cancelButton").setDisabled(),this.getControl("createButton").load(),i.save({},{onComplete:function(i){this.alert("success",t.communityhasbeencreated),((i=new n(i.toJSON(),{areModelDataFromServer:!0})).get("owner").hash_key===e._currentUser.hash_key||i.isDMTransformationExpected())&&(d.notify("onCreate",i),this._widget&&"X3DOPSW_AP"===this._widget.getAppName()||s.goToCommunity(i.get("mid"),s.COMMUNITY_SETTINGS)),this.getControl("communityCreationModal").hide()}.bind(this),onFailure:function(){this.alert("error",t.AnerroroccurredwhilecreatingthecommunityPleasetryagainorcontactyouradministrator),this.getControl("cancelButton").setDisabled(!1),this.getControl("createButton").load(!1)}.bind(this)})):(this.getControl("communityCreationForm").getFields()[0].getParent(".form-group").addClassName("has-error"),this.alert("error",t.similarCommunityNameAlreadyExists))}.bind(this)})}.bind(this)}})),this.addControl("communityCreationModal",new a({header:"<h4>"+(this.model.isDMTransformationExpected()?t.TransformADMIntoACommunity:t.CreateACommunity)+"</h4>",className:"fancy",body:[this.getControl("communityCreationForm")],footer:[this.getControl("createButton"),this.getControl("cancelButton")],closable:!0,events:{onHide:function(){this.destroy()}.bind(this)}}))},setup:function(){this._currentUser=c.getInstance().get("user"),this._parent.apply(this,arguments)},show:function(){this.getControl("communityCreationModal").show()}})}),define("DS/SwymUIComponents/script/feature/community/wiki/view/wiki-access-editor-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/wiki/view/wiki-properties-editor-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/community/model/community-model","DS/UIKIT/Input/Select","DS/UIKIT/Tooltip","DS/SwymUIComponents/script/feature/core/search/view/user-search-factory"],function(e,t,i,n,o,s,a){"use strict";return i.extend({name:"wiki-access-editor-view",_modelEventsForAutoRefresh:["onSync:update"],domEvents:{"change .wiki-editing-editor-combo":"onWikiEditingChange","change .wiki-access-editor-combo":"onWikiVisibilityChange"},privateUserToAdd:[],privateUserToRemove:[],_communityModel:null,_wikiData:{},_onSelectUser:function(i){var n,o,s,a=this.getControl("user-search-control"),r=!0;if(this.model&&(s=this.model.getAssociated("authorizedusers").findWhere({hash_key:i.hash_key}),r=!e.is(s)),r){for(n=0;n<this.privateUserToAdd.length;n++)this.privateUserToAdd[n]===i.hash_key&&(r=!1);if(!0===r&&i.hash_key){for(this.privateUserToAdd.push(i.hash_key),this._addWikiChanges("users_to_add",this.privateUserToAdd),o=[],n=0;n<this.privateUserToRemove.length;n++)this.privateUserToRemove[n]!=i.hash_key&&o.push(this.privateUserToRemove[n]);this.privateUserToRemove=o,this._addWikiChanges("users_to_remove",this.privateUserToRemove),a.resetInput()}}else{for(o=[],n=0;n<this.privateUserToRemove.length;n++)this.privateUserToRemove[n]!==i.hash_key?o.push(this.privateUserToRemove[n]):r=!0;this.privateUserToRemove.length!==o.length&&(this.privateUserToRemove=o,this._addWikiChanges("users_to_remove",this.privateUserToRemove)),r||(this.alert("info",t.Thisuseralreadyhasaccesstothispage),a.toggleSelect(a.selectedItems.find(function(e){return e.hash_key===i.hash_key}),null,!1))}},_onUnselectUser:function(e){var t,i=e.hash_key||e.value;this.model&&(t=this.model.getAssociated("authorizedusers").findWhere({hash_key:e.hash_key}));for(var n=[],o=0;o<this.privateUserToAdd.length;o++)this.privateUserToAdd[o]!==i&&n.push(this.privateUserToAdd[o]);this.privateUserToAdd.length!==n.length?(this.privateUserToAdd=n,this._addWikiChanges("users_to_add",this.privateUserToAdd)):(!t||t&&!1===t.get("is_admin"))&&(this.privateUserToRemove.push(i),this._addWikiChanges("users_to_remove",this.privateUserToRemove))},_createContent:function(){var i,n=this,r=n.model,l=e.createElement("span",{class:"fonticon fonticon-help"}),c=e.createElement("span",{class:"fonticon fonticon-help"});if(r&&(n._communityModel=r.getCommunity()),n._communityModel&&(parseInt(n._communityModel.get("user_access"),10)>=3||parseInt(n._communityModel.getUserRole(),10)>=3)){n.privateUserToAdd=[],n.privateUserToRemove=[];var d=!1;r?r&&1===parseInt(r.get("visibility"),10)?d=!0:n._wikiData&&1===parseInt(n._wikiData.visibility,10)&&(d=!0):d=!0,i=n.addControl("user-search-control",a.createUserSearchControl({multiSelect:!0,community_id:n._communityModel?n._communityModel.get("mid"):null,disabled:d,events:{onSelect:function(e){this._onSelectUser(e)}.bind(n),onUnselect:function(e){this._onUnselectUser(e)}.bind(n)}})),r&&1!==parseInt(r.get("visibility"),10)&&r.getAssociated("authorizedusers").fetch({data:{community_id:n._communityModel.get("mid")},onComplete:function(e){var t=[];e.forEach(function(e){!0!==e.get("is_admin")&&t.push({value:e.get("hash_key"),label:e.getNickname(),selected:!0})}),t.length>0&&(n.getControl("user-search-control").reset(),n.getControl("user-search-control").addItems(t,n.getControl("user-search-control").getDataset(0)))}}),n.addControl("helpEditingIconTooltip",new s({target:l,body:t.PageEditingTooltip})),n.addControl("helpAccessIconTooltip",new s({target:c,body:t.NotePrivatewillseteverysubpageofthispageasprivate+"</br>"+t.Forprivatewikipages}));var m=r&&("1"===r.get("locked")||!0===r.get("locked")||1===r.get("locked"));return this.dispatchEvent("displayAccessIcon",!0),[{class:"properties",html:[{class:"access-row",html:[{class:"access-label",html:[t.Pageediting,l]},n.addControl("editingSelect",new o({placeholder:!1,className:"wiki-editing-editor-combo",options:[{selected:!m,label:t.Enablepageediting,value:"1"},{selected:!!m,label:t.Disablepageediting,value:"2"},{label:t.Enablepageandsubpagesediting,value:"3"},{label:t.Disablepageandsubpagesediting,value:"4"}]}))]},r&&!0===(r&&r.get("is_root"))?null:{class:"access-row",html:[{class:"access-label",html:[t.Pageaccess,c]},n.addControl("accessSelect",new o({placeholder:!1,className:"wiki-access-editor-combo",disabled:!(!r||0!==parseInt(r.get("visibility"),10)),options:[{selected:!(r&&(!r||1!==parseInt(r.get("visibility"),10))),label:t.Public,value:"1"},{selected:!(!r||1===parseInt(r.get("visibility"),10)),label:t.Private,value:"2"}]})),i]}]}]}return this.dispatchEvent("displayAccessIcon",!1),""},_addWikiChanges:function(e,t){var i=this.model;i?i.addChanges(e,t):this._wikiData[e]=t,this.dispatchEvent("onContentChange")},_removeWikiChanges:function(t,i){var n=this.model;n?n.removeChanges(t):e.is(this._wikiData[t])&&delete this._wikiData[t]},getWikiData:function(){var e=this.model;return e?e.getChanges():this._wikiData},getCommunityId:function(){return this._communityModel&&this._communityModel.get("mid")},setCommunityId:function(e){!this.model&&e&&""!==e&&(!this._communityModel||this._communityModel&&this._communityModel.get("mid")!==e)&&(this._communityModel=new n({id:e},{autoPopulate:!0}),this.refresh())},resetEditorViews:function(){this.model||(this._wikiData={}),this.refresh()},onWikiEditingChange:function(e){switch(e.target.value){case"1":this._addWikiChanges("locked","0"),this._removeWikiChanges("lockedAll");break;case"3":this._addWikiChanges("locked","0"),this._addWikiChanges("lockedAll",!1);break;case"2":this._addWikiChanges("locked","1"),this._removeWikiChanges("lockedAll");break;case"4":this._addWikiChanges("locked","1"),this._addWikiChanges("lockedAll",!0)}},onWikiVisibilityChange:function(e){this._addWikiChanges("visibility",e.target.value),this.getControl("user-search-control").setDisabled("2"!==e.target.value)}})}),define("DS/SwymUIComponents/script/feature/core/user/view/user-network-tile-view",["UWA/Core","DS/SwymUIComponents/script/feature/core/user/view/user-tile-view","DS/UIKIT/DropdownMenu","DS/SwymUIComponents/script/feature/core/modal/super-modal","DS/UWPClientCode/I18n","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/member-set-connections-view","DS/SwymUIComponents/script/feature/core/user/view/user-picture-view","DS/PubSub/PubSub"],function(e,t,i,n,o,s,a,r){"use strict";return t.extend({domEvents:{"click .action-toolbar":"_onToolbarClick","click .user-tile":"_onUserClick"},setup:function(e){e.modelUser&&(this._modelUser=e.modelUser)},_onUserClick:function(e){e.target.hasClassName("action-toolbar")?e.stopPropagation():this._parent.apply(this,arguments)},_onToolbarClick:function(e){e.stopPropagation();var t=this.getControl("dropdownMenu");t&&t.show()},_buildDropDownMenu:function(e){this.addControl("dropdownMenu",new i({target:e,position:"bottom right",offset:{x:17,y:8},items:[{name:"delete",fonticon:"trash",text:s.deleteheader}],events:{onClick:function(e,t){new n({closable:!0,renderTo:this._widget.body}).confirm(o.replace(s.deleteconnectionLink,{nickname:this.model.get("nickname")}),s.deleteheader,function(e){!0===e&&this.model.deleteuserfromnetwork({onComplete:function(e,t){this.hide(),r.dispatch("refreshNetwork",[e,!1],!0),this.alert("success",e.getNickname()+s.hasBeenRemovedfromyournetwork)}.bind(this)})}.bind(this))}.bind(this)}}))},_createContent:function(){var t=this.model,i="";return this._modelUser.isCurrentUser()&&(i=e.createElement("span",{class:"action-toolbar network fonticon fonticon-2x fonticon-down-open"}),this._buildDropDownMenu(i)),{class:"member-tile "+this._getExtraClassForAccountActivation(),html:[i,this.addChildView("userPicture",{Class:a,className:"member-picture",model:t,imageRenderingOptions:{format:"square"}}),this._displayBasicInfo()]}}})}),define("DS/SwymUIComponents/script/feature/community/idea/idea-view",["UWA/Core","DS/SwymUICore/script/feature/community/idea/model/idea-model","DS/SwymUIComponents/script/feature/core/ui-components/list/list-item/item-view"],function(e,t,i){"use strict";return i.extend({_modelClass:t,name:"idea-view",getClassNames:function(){return(this._parent.apply(this,arguments)||"")+" one-column"},defaultOptions:{summaryViewClass:"DS/SwymUIComponents/script/feature/community/idea/view/idea-summary-view",detailedViewClass:"DS/SwymUIComponents/script/feature/community/idea/view/idea-detailed-view",editViewClass:"DS/SwymUIComponents/script/feature/community/idea/edit/idea-edit-view"}})}),define("DS/SwymUIComponents/script/feature/community/wiki/view/private-user-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/wiki/view/private-user-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/core/user/view/user-picture-view","DS/SwymUIComponents/script/feature/core/modal/super-modal","DS/UWPClientCode/I18n"],function(e,t,i,n,o,s){return i.extend({model:null,_el:null,_confirmModal:null,mode:"view",_createContent:function(){var t=this.model;if(t){this._confirmModal=new o({closable:!1,renderTo:this._widget.body}),userPic=this.addChildView("userPicture",{Class:n,model:t,imageRenderingOptions:{format:"mini"}});var i=[{styles:{float:"left",margin:"10px",padding:"10px",border:"2px solid #D8D8D8",width:"200px","max-height":"55px",overflow:"hidden"},html:{styles:{width:"100%"},tag:"table",html:{tag:"tr",html:[{tag:"td",styles:{"vertical-align":"top"},html:{styles:{"margin-right":"10px"},html:userPic}},{styles:{"vertical-align":"top"},tag:"td",html:t.get("nickname")},1!=t.get("is_admin")?{tag:"td",styles:{"vertical-align":"top"},html:'<div class="delete-icon" style="cursor: pointer; padding: 7px 0 0 10px; float:right;">X</div>'}:""]}}}];e.createElement("div",{html:userPic});return i}},bindEvents:function(){var e=this.container.getElement(".delete-icon");e&&e.addEvent("click",function(){this._confirmModal.confirm(s.replace(t.Areyousure,{nickname:this.model.get("nickname")}),t.Confirm,function(e){1==e&&this.dispatchEvent("privateUserRemoved",this.model)}.bind(this))}.bind(this))}})}),define("DS/SwymUIComponents/script/feature/community/wiki/view/private-users-collection-view",["DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/SwymUIComponents/script/feature/community/wiki/view/private-user-view"],function(e,t,i){return e.extend({_collectionClass:t,modelViewClass:i,_createModelView:function(){var e=this._parent.apply(this,arguments);return e.addEvent("privateUserRemoved",function(e){this.dispatchEvent("privateUserRemoved",e)},this),e}})}),define("DS/SwymUIComponents/script/feature/community/media/view/media-view",["UWA/Core","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUIComponents/script/feature/core/ui-components/list/list-item/item-view","DS/SwymUICore/script/utils/utils"],function(e,t,i,n){"use strict";return i.extend({_modelClass:t,name:"media-view",defaultOptions:{summaryViewClass:"DS/SwymUIComponents/script/feature/community/media/view/media-summary-view",detailedViewClass:"DS/SwymUIComponents/script/feature/community/media/view/media-detailed-view",editViewClass:"DS/SwymUIComponents/script/feature/community/media/edit/media-edit-view"},getIconClass:function(){return n.getMediaIconName(this.model)}})}),define("DS/SwymUIComponents/script/feature/community/media/editor/view/cropbox-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/community/media/editor/view/control-point-view","DS/WebappsUtils/Console"],function(e,t,i,n){"use strict";return t.extend({name:"cropbox",xOrigin:null,yOrigin:null,centralRectElt:null,width:null,height:null,widgetId:null,svgWrapper:null,pointCoords:null,domEvents:{"mousedown svg.cropbox-svg-wrapper":"onMouseDown","mouseup svg.cropbox-svg-wrapper":"onMouseUp"},setup:function(e){if(console.info("setup, config:",e),!e.width)throw new Error("A width is required for the cropbox view.");if(this.width=Math.floor(e.width),!e.height)throw new Error("A height is required for the cropbox view.");this.height=Math.floor(e.height),e.widgetId&&(this.widgetId=e.widgetId),this.pointCoords=[]},_createContent:function(){return'<svg class="cropbox-svg-wrapper" height="'+this.height+'" width="'+this.width+'" xmlns="http://www.w3.org/2000/svg" version="1.1"><g class="rect-group"></g><g class="cp-group"></g></svg>'},onRender:function(){this.container.setStyles({height:this.height+"px",width:this.width+"px",position:"relative",top:"-"+this.height+"px"}),this.svgWrapper=this.getElement("svg.cropbox-svg-wrapper"),this.rectGroup=this.getElement("g.rect-group"),this.cpGroup=this.getElement("g.cp-group");var e=Math.floor(.25*this.width/2),t=Math.floor(.25*this.height/2);this.pointCoords.push([e,t]),n.log("cropbox------\x3e width:"+this.width+", height: "+this.height+", horizontalMargin: "+e+", verticalMargin: "+t),this.pointCoords.push([this.width-e,t]),this.pointCoords.push([e,this.height-t]),this.pointCoords.push([this.width-e,this.height-t]),this.drawLayer(this.pointCoords,!0),this.drawControlPoints(this.pointCoords)},onMouseDown:function(e){n.log("cropbox onMouseDown");var t=e.target;this.draggedControlPoint=this.getClickedControlPoint(t),this.draggedControlPoint&&(this.draggedControlPoint.onMouseDown(e),this.svgWrapper.addEvent("mousemove",this.onMouseMove.bind(this)))},onMouseUp:function(e){this.draggedControlPoint&&(n.log("cropbox onMouseDown"),this.draggedControlPoint.onMouseUp(e),this.svgWrapper.removeEvent("mousemove",this.onMouseMove))},getClickedControlPoint:function(e){for(var t=-1,i=this.controlPoints.length;++t<i;){var n=this.controlPoints[t];if(n.isControlPoint(e))return n}return null},createSVGElement:function(e,t){var i=document.createElementNS("http://www.w3.org/2000/svg",e);for(var n in t)i.setAttribute(n,t[n]);return this.rectGroup.appendChild(i),i},updateSVGElement:function(e,t){for(var i in t)e.setAttribute(i,t[i])},drawLayer:function(e,t){var i,n=e[0],o=e[1],s=e[2],a=n[1];t?this.leftRect=this.createSVGElement("rect",{width:n[0],height:this.height,x:0,y:0,class:"media-editor-cropbox-dark-rectangle"}):this.updateSVGElement(this.leftRect,{width:n[0]}),t?this.topMiddleRect=this.createSVGElement("rect",{width:o[0]-n[0],height:a,x:n[0],y:0,class:"media-editor-cropbox-dark-rectangle"}):this.updateSVGElement(this.topMiddleRect,{width:o[0]-n[0],height:a,x:n[0]}),t?this.rightRect=this.createSVGElement("rect",{width:this.width-o[0],height:this.height,x:o[0],y:0,class:"media-editor-cropbox-dark-rectangle"}):this.updateSVGElement(this.rightRect,{width:this.width-o[0],x:o[0]});var r=s[1]-n[1];t?(this.centralRect=this.createSVGElement("rect",{width:o[0]-n[0],height:r,x:n[0],y:n[1],class:"media-editor-cropbox-bright-rectangle"}),this.centralRectElt=this.getElement(".media-editor-cropbox-bright-rectangle"),this.centralRectSetup()):this.updateSVGElement(this.centralRect,{width:o[0]-n[0],height:r,x:n[0],y:n[1]});var l=this.height-s[1];t?this.bottomMiddleRect=this.createSVGElement("rect",{width:o[0]-n[0],height:l,x:s[0],y:s[1],class:"media-editor-cropbox-dark-rectangle"}):this.updateSVGElement(this.bottomMiddleRect,{width:o[0]-n[0],height:l,x:s[0],y:s[1]});var c=(o[0]-n[0])/3;i={x1:n[0]+c,y1:n[1],x2:n[0]+c,y2:s[1]},t?(i.class="media-editor-cropbox-line",this.leftVerticalLine=this.createSVGElement("line",i)):this.updateSVGElement(this.leftVerticalLine,i),i={x1:n[0]+2*c,y1:n[1],x2:n[0]+2*c,y2:s[1]},t?(i.class="media-editor-cropbox-line",this.rightVerticalLine=this.createSVGElement("line",i)):this.updateSVGElement(this.rightVerticalLine,i);var d=(s[1]-n[1])/3;i={x1:n[0],y1:n[1]+d,x2:o[0],y2:n[1]+d},t?(i.class="media-editor-cropbox-line",this.topHorizontalLine=this.createSVGElement("line",i)):this.updateSVGElement(this.topHorizontalLine,i),i={x1:n[0],y1:n[1]+2*d,x2:o[0],y2:n[1]+2*d},t?(i.class="media-editor-cropbox-line",this.bottomHorizontalLine=this.createSVGElement("line",i)):this.updateSVGElement(this.bottomHorizontalLine,i)},centralRectSetup:function(){this.centralRectElt.setStyle("cursor","move");var e=function(){n.log("stopDrag"),this.centralRectBeingDragged=!1,this.centralRectElt.removeEvents(),this.centralRectElt.addEvent("mousedown",t.bind(this))}.bind(this),t=function(t){n.info("central rect onMouseDown"),this.centralRectBeingDragged=!0,this.centralRectElt.oldX=t.clientX,this.centralRectElt.oldY=t.clientY,this.centralRectElt.addEvent("mouseup",function(t){e()}.bind(this)),this.centralRectElt.addEvent("mousemove",this.centralRectOnMove.bind(this))}.bind(this);this.centralRectElt.addEvent("mousedown",t.bind(this))},centralRectOnMove:function(e){if(this.centralRectBeingDragged){var t=e.clientX-this.centralRectElt.oldX,i=e.clientY-this.centralRectElt.oldY;if(this.centralRectElt.oldX=e.clientX,this.centralRectElt.oldY=e.clientY,this.pointCoords[0][0]+t>0&&this.pointCoords[1][0]+t<this.width)for(var n=0;n<4;n++)this.pointCoords[n][0]+=t;if(this.pointCoords[0][1]+i>0&&this.pointCoords[2][1]+i<this.height)for(n=0;n<4;n++)this.pointCoords[n][1]+=i;var o=this.controlPoints[0].width;this.updateControlPointCoordinates("NW",this.pointCoords[0][0],this.pointCoords[0][1]),this.updateControlPointCoordinates("NE",this.pointCoords[1][0]-o,this.pointCoords[1][1]),this.updateControlPointCoordinates("SW",this.pointCoords[2][0],this.pointCoords[2][1]-o),this.updateControlPointCoordinates("SE",this.pointCoords[3][0]-o,this.pointCoords[3][1]-o),this.drawLayer(this.pointCoords,!1)}},updateControlPointCoordinates:function(e,t,i){for(var n=-1,o=this.controlPoints.length;++n<o;){var s=this.controlPoints[n];if(e===s.type){s.setCoordinate("x",t),s.setCoordinate("y",i);break}}},updateControlPointCoordinate:function(e,t,i){for(var n=-1,o=this.controlPoints.length;++n<o;){var s=this.controlPoints[n];if(e===s.type){s.setCoordinate(t,i);break}}},drawControlPoints:function(e){var t=new i({pointCoord:e[0],type:"NW",svgWrapper:this.svgWrapper,renderTo:this.cpGroup,events:{ControlPointMoved:this.onControlPointMoved.bind(this)}}),n=new i({pointCoord:e[1],type:"NE",svgWrapper:this.svgWrapper,renderTo:this.cpGroup,events:{ControlPointMoved:this.onControlPointMoved.bind(this)}}),o=new i({pointCoord:e[2],type:"SW",svgWrapper:this.svgWrapper,renderTo:this.cpGroup,events:{ControlPointMoved:this.onControlPointMoved.bind(this)}}),s=new i({pointCoord:e[3],type:"SE",svgWrapper:this.svgWrapper,renderTo:this.cpGroup,events:{ControlPointMoved:this.onControlPointMoved.bind(this)}});this.controlPoints=[t,n,o,s]},onMouseMove:function(e){if(n.log("cropbox onMouseMove"),this.draggedControlPoint){var t=!0,i=this.draggedControlPoint.getCoordsInSvgSpace(e);switch(n.log("newCoords:",i),this.draggedControlPoint.type){case"NW":i.x>=this.pointCoords[1][0]-2*this.draggedControlPoint.width?t=!1:i.y>=this.pointCoords[2][1]-2*this.draggedControlPoint.width?t=!1:i.x<0&&(t=!1);break;case"NE":i.x<=this.pointCoords[0][0]+2*this.draggedControlPoint.width?t=!1:i.y>=this.pointCoords[3][1]-2*this.draggedControlPoint.width&&(t=!1);break;case"SW":i.x>=this.pointCoords[3][0]-2*this.draggedControlPoint.width?t=!1:i.y<=this.pointCoords[0][1]+2*this.draggedControlPoint.width&&(t=!1);break;case"SE":i.x<=this.pointCoords[0][0]+2*this.draggedControlPoint.width?t=!1:i.y<=this.pointCoords[0][1]+2*this.draggedControlPoint.width&&(t=!1)}t&&this.draggedControlPoint.onMouseMove(e)}},onControlPointMoved:function(e){var t,i=parseInt(e.rect.getAttribute("x"),10),n=parseInt(e.rect.getAttribute("y"),10);switch(e.type){case"NW":t=0,this.pointCoords[2][0]=i,this.pointCoords[1][1]=n,this.updateControlPointCoordinate("NE","y",n),this.updateControlPointCoordinate("SW","x",i),this.pointCoords[t][0]=i,this.pointCoords[t][1]=n;break;case"NE":t=1,this.pointCoords[3][0]=i+e.width,this.pointCoords[0][1]=n,this.updateControlPointCoordinate("NW","y",n),this.updateControlPointCoordinate("SE","x",i),this.pointCoords[t][0]=i+e.width,this.pointCoords[t][1]=n;break;case"SW":t=2,this.pointCoords[0][0]=i,this.pointCoords[3][1]=n+e.width,this.updateControlPointCoordinate("NW","x",i),this.updateControlPointCoordinate("SE","y",n),this.pointCoords[t][0]=i,this.pointCoords[t][1]=n+e.width;break;case"SE":t=3,this.pointCoords[1][0]=i+e.width,this.pointCoords[2][1]=n+e.width,this.updateControlPointCoordinate("NE","x",i),this.updateControlPointCoordinate("SW","y",n),this.pointCoords[t][0]=i+e.width,this.pointCoords[t][1]=n+e.width}this.drawLayer(this.pointCoords,!1)},getInfos:function(){return{left:this.pointCoords[0][0],top:this.pointCoords[0][1],width:this.pointCoords[1][0]-this.pointCoords[0][0],height:this.pointCoords[2][1]-this.pointCoords[0][1]}}})}),define("DS/SwymUIComponents/script/feature/community/media/video/model-interface/drive-interactive-media",["UWA/Core","DS/SwymUIComponents/script/feature/community/media/video/model-interface/interactive-media"],function(e,t){"use strict";function i(t){var i="";return e.is(t.get("media_file_ext"))&&(i=t.get("media_file_ext")),i}return e.extend(e.extend({},t),{getMediaViewerModule:function(e){var t=null,i="DS/SwymUIComponents/script/feature/community/media/view/";switch(e.get("media_file_ext")){case"pdf":case"3dxml":case"stl":case"step":t=i+"media-3d-viewer";break;default:t=i+"picture-viewer"}return t},shouldAddPlayIconOverlay:function(e){var t=!1,n=i(e);return["3dxml","stl","pdf","step"].indexOf(n)>-1&&(t=!0),t},getFileExtension:i,shouldAddDownloadIconOverlay:function(e){var t=!1,n=i(e);return"document"===e.get("media_type")&&"pdf"!==n&&(t=!0),t},modelFetchNeeded:function(){return!1}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/embedded-rich-link-processing-utils",["require","exports","UWA/Data","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/oembed-providers-list"],function(e,t,i,n){"use strict";return{getOEmbedJson:function(e,t,o){var s=n.ProvidersList.find(function(t){return t.provider_name.toLowerCase()===e.toLowerCase()}).endpoints[0].url+"?url="+t+"&format=json";i.request(s,{proxy:"ajax",type:"json",onComplete:function(e){var i,n;o((n=t,{type:"video",title:(i=e).title,image:i.thumbnail_url,iframe:i.html,url:n}))}})}}}),define("DS/SwymUIComponents/script/feature/community/content/view/thumbnail-in-content-view",["UWA/Core","DS/SwymUIComponents/script/feature/community/content/view/media-thumbnail-view","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/feature/core/sprite/sprite","DS/SwymUIComponents/script/utils/media-utils"],function(e,t,i,n,o,s,a){"use strict";return t.extend({widthToDisplay:320,heightToDisplay:null,existingImg:null,name:"thumbnail-in-content",setup:function(t){if(this._parent.apply(this,arguments),this.existingImg=t.existingImg,this.existingImg){var i=this.existingImg.getStyle("width"),n=this.existingImg.getStyle("height"),o=this.existingImg.getAttribute("data-size"),s=this.existingImg.getAttribute("data-position"),a={};i&&(this.widthToDisplay=parseInt(i,10)),n&&(this.heightToDisplay=parseInt(n,10)),o&&(a["data-size"]=o),s&&(a["data-position"]=s),(o||s)&&(this._imageRenderingOptions=this._imageRenderingOptions||{},this._imageRenderingOptions.extraAttributes=e.extend(this._imageRenderingOptions.extraAttributes||{},a))}this._imageRenderingOptions&&(this._imageRenderingOptions.widthToDisplay&&(this.widthToDisplay=this._imageRenderingOptions.widthToDisplay),this._imageRenderingOptions.heightToDisplay&&(this.heightToDisplay=this._imageRenderingOptions.heightToDisplay))},_createContent:function(){var t=a.generateBestThumbnailForContentView(this.widthToDisplay,this.heightToDisplay,this.model,{imgTag:this.existingImg});return this.heightToDisplay||(this.heightToDisplay=t.height),s.renderMediaThumbnail(e.merge(t,e.merge(this._imageRenderingOptions||{},this.imageReloadOptions)))},refresh:function(){}})}),define("DS/SwymUIComponents/script/feature/community/idea/view/idea-transferred-link-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/idea/view/idea-transfer-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/UIKIT/Input/Button","DS/SwymUIComponents/script/feature/core/modal/super-modal","DS/UWPClientCode/I18n","DS/SwymUICore/script/feature/community/idea/model/enovia-object-model","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/utils/platform-utils"],function(e,t,i,n,o,s,a,r,l,c){"use strict";return i.extend({name:"idea-transferred-link-view",domEvents:{"click .delete-enovia-link":"_onDeleteButtonClick"},_enoviaLinkModel:null,_deleted:!1,_error:!1,_isCommunityOwner:!1,_viewReadyToBeRendered:null,_isIdeaTransferredToEnovia:null,_createContent:function(){if(this._viewReadyToBeRendered){console.warn("------ transferred-link-view, createContent");var e=this._enoviaObject.getObjectUrl();if(e)return this._isCommunityOwner&&!this.getControl("deleteTransferredObjectButton")&&this.addControl("deleteTransferredObjectButton",new o({className:"delete-button default",value:t.Deletethislink})),[{class:"enovia-link-text",html:this._deleted?a.replace(t.Yourobjecthasbeendeleted,{atag:'<a target="_blank" href="'+e+'">'+this._enoviaLinkModel.get("content_title")+"</a>",object:this._enoviaObjectDisplayableName}):this._error?{class:"alert-message alert-warning",styles:{margin:"0px",position:"relative"},html:a.replace(t.AnerroroccuredwhilecontactingtheEnoviaserverbutyou,{object:this._enoviaObjectDisplayableName})+' <a target="_blank" href="'+e+'">'+this._enoviaLinkModel.get("content_title")+"</a>"}:a.replace(t.ThisideahasbeenusedtocreatethisEnoviaobject,{object:this._enoviaObjectDisplayableName})+' <a class="transferred-object-title" target="_blank" href="'+e+'">'+this._enoviaLinkModel.get("content_title")+"</a>"},this._isCommunityOwner?{class:"fonticon fonticon-1x fonticon-close delete-enovia-link"}:""];console.error("Impossible to get the url of the enovia object")}},setup:function(){var e=this;this._parent.apply(this,arguments),this._viewReadyToBeRendered=!1,this._isIdeaTransferredToEnovia=!1,this._isCommunityOwner=this.model.getCommunity().getUserRole()>=3,this.addControl("confirmModal",new s({closable:!0,renderTo:e._widget.body})),this.model.isTransferredToEnovia().then(function(t){e._isIdeaTransferredToEnovia=t,t&&e.model.getEnoviaLink().then(function(t){e._enoviaLinkModel=t,c.get3DSpaceUrl(n.getInstance().get("config").tenant.online_instance_id).then(function(t){e._enoviaObject=new r({mid:e._enoviaLinkModel.get("content_key"),threeDSpaceUrl:t}),e._enoviaObject.fetchObjectURL().then(function(i){if(i){var n=e._enoviaLinkModel.get("type").replace("enovia-object:","").replace("enovia_","");"project"===n&&(n="BusinessInitiativeProject"),e._getEnoviaObjectDisplayableName(n,t).then(function(t){e._enoviaObjectDisplayableName=t,e._viewReadyToBeRendered=!0,e.refresh()},function(){console.error("There is no license matching the link of type "+e._enoviaLinkModel.get("type"))})}})})})})},_getEnoviaObjectDisplayableName:function(e,t){return new Promise(function(i,n){require(["DS/SwymUICore/script/feature/community/idea/collection/license-collection"],function(o){var s=o;function a(t){let o=null;for(let i=0;i<t._models.length;i++){const n=t._models[i],s=n.get("subtypes");if(s&&s.length>1){const t=s.find(t=>t.name.toLowerCase()===e.toLowerCase());if(t){o=t.name.toLowerCase();break}}else if(n.get("name").toLowerCase()===e.toLowerCase()){o=n.get("label").toLowerCase();break}}o?i(o):n()}s.set3DSpaceUrl(t),s.hasBeenFetched()?a(s):s.fetch({onComplete:function(e){a(e)}})})})},_onDeleteButtonClick:function(){var i=this;this.getControl("confirmModal").confirm(a.replace(t.DeleteInfos,{object:i._enoviaObjectDisplayableName}),t.Confirm,function(t){!0===t&&i.model.removeEnoviaLink().then(function(){var t=e.clone(i.model.get("_acl"));t.update.access=!0,t.delete.access=!0,i.model.set("_acl",t),i.model.set("acl_status",!0)})})}})}),define("DS/SwymUIComponents/script/feature/community/report-abuse/view/report-new-abuse-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/report-abuse/view/report-new-abuse-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/report-abuse/model/report-abuse-model-v2","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUIComponents/script/feature/core/modal/modal","DS/UIKIT/Form","DS/UIKIT/Input/Button","DS/WebappsUtils/Console"],function(e,t,i,n,o,s,a,r,l,c){"use strict";return i.extend({_modelClass:n,_reportedModel:null,name:"report-new-abuse-view",_createContent:function(){var i,n,c,d,m,u,h,p,g,w=this,C=t.Title,f=this.model,y=s.getInstance(),v=this._reportedModel,A=null,_=[],S=null===v?"":"instant-message"===v.getModelName()||"comment"===v.getModelName()||"iq-answer"===v.getModelName()||"iqa-comment"===v.getModelName()?v.get("comment")||v.get("answer"):v.get("comment")||v.get("title");if(S=e.is(S,"string")?(p=S,(g=document.createElement("div")).innerHTML=p,u=g.textContent||g.innerText||"",h=50,u.length>h?u.substring(0,h)+"...":u):"",f&&v){switch(v.getModelName()){case"iquestion":C=t.Iquestion,n="Question";break;case"post":C=t.Post,n="Post";break;case"media":C=t.Media,n="Media";break;case"wiki":C=t.Wiki,n="Wiki";break;case"survey":C=t.Survey,n="Survey";break;case"idea":C=t.Idea,n="Idea";break;case"social-event":C=t.RendezVous,n="Conference";break;case"iq-answer":C=t["Iq-answer"],n="Answer",A=v.getAssociated("answeredFor");break;case"iqa-comment":C=t["Iqa-comment"],n="Comment",A=v.getAssociated("commented").getAssociated("answeredFor");break;default:C=t.Comment,n="Comment","instant-message"===(A=v.getAssociated("commented")).getModelName()&&(n="InstantMessage",C=t.Message)}return A||(A=v),c=A.get("community->mid")||y.communityId,d=A.getModelName()||y.contentType,m=A.get("mid")||y.contentId,i=window.ds&&"3DD"===ds.env?o.get3DDTransientAppUrl({appId:o.getMyCommunitiesAppKey(),community:c,contentType:d,contentId:m}):o.getBaseUrl()+A.getRelativePath(),f.addChanges({subjectType:n,subjectTitle:S,subjectUri:v.get("subject6wuri"),parentCommentUri:v.get("parentCommentUri")}),this.addControl("cancelButton",new l({value:t.Cancel,events:{onClick:function(e){this.getControl("reportAbuseModal").hide()}.bind(this)}})),this.addControl("confirmButton",new l({value:t.Ok,className:"primary",events:{onClick:function(){var e=this;if(this.getControl("reportAbuseForm").validate()&&_.length>0){this.getControl("confirmButton").load(),this.getControl("cancelButton").setDisabled();f.addChanges("reasons",_);require(["DS/SwymUICore/script/feature/community/community/model/community-model"],function(i){new i({mid:c},{autoPopulate:!0,onPopulate:function(i){f.addChanges("contextUri",i.get("subject6wuri")),f.save({},{onComplete:function(i,n){e.getControl("reportAbuseModal").hide(),e.alert("success",t.YourReportHasBeenSent)},onFailure:function(i,n){e.alert("error",t.YourReportHasNotBeenSent)}})}})})}}.bind(this)}})),this.addControl("reportAbuseModal",new a({header:"<h4>"+t.ReportAnAbuse+"</h4>",body:this.addControl("reportAbuseForm",new r({fields:[{type:"text",name:"page",label:t.AbusePage,value:i,disabled:!0},{type:"text",name:"title",label:C,value:S,disabled:null!==v,required:!0,events:{onChange:function(e){f.addChanges("subjectTitle",this.getValue())}}},{type:"html",html:"<label>"+t.Reason+' <span class="label-field-required"> *</span></label>'},{type:"checkbox",name:"reason",label:t.ConfidentialContent,events:{onChange:function(e){if(this.isChecked())_.push("confidentialContent");else{var t=_.indexOf("confidentialContent");_.splice(t,1)}}}},{type:"checkbox",name:"reason",label:t.InappropriateBehaviour,events:{onChange:function(e){if(this.isChecked())_.push("inappropriateBehaviour");else{var t=_.indexOf("inappropriateBehaviour");_.splice(t,1)}}}},{type:"checkbox",name:"reason",label:t.PersonalAttacksHarassment,events:{onChange:function(e){if(this.isChecked())_.push("personalAttacksHarassment");else{var t=_.indexOf("personalAttacksHarassment");_.splice(t,1)}}}},{type:"checkbox",name:"reason",label:t.Other,events:{onChange:function(e){if(this.isChecked())_.push("other");else{var t=_.indexOf("other");_.splice(t,1)}}}},{type:"textarea",name:"comment",label:t.Comments,required:!0,styles:{"max-width":"100%","min-width":"100%"},events:{onChange:function(e){f.addChanges("description",this.getValue())}}}]})),footer:[this.getControl("confirmButton"),this.getControl("cancelButton")],closable:!0,events:{onHide:function(){w.destroy()}}})),this.getControl("reportAbuseModal")}},show:function(){this.getControl("reportAbuseModal").show()},setup:function(e){return e&&e.hasOwnProperty("reportedModel")&&(this._reportedModel=e.reportedModel),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/idea/view/idea-transfer-form-modal",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/idea/view/idea-transfer-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/utils","DS/UIKIT/Input/Button","DS/UIKIT/Input/Select","DS/UIKIT/Spinner","DS/UWPClientCode/I18n","DS/SwymUICore/script/feature/community/idea/collection/license-collection","DS/SwymUICore/script/feature/community/idea/model/enovia-object-model","DS/SwymUIComponents/script/feature/core/modal/modal","DS/SwymUICore/script/utils/platform-utils","DS/Logger/Logger"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h){"use strict";var p=i.extend({name:"idea-transfer-form-view",_objectToTransfer:"",_currentTypeLicenseModel:"",_subType:null,_currentCollabSpace:null,_currentSelectedAttributes:[],_saveBtn:null,_viewReadyToBeRendered:null,_modelEvents:{"onChange:status_id":"_onStatusIdChanged","onChange:out":"refresh"},_licenseCollection:null,_collabSpaceCollection:null,_3dspaceURL:null,_createContent:function(){var t,i=null;return this._viewReadyToBeRendered?this._licenseCollection&&this._licenseCollection.length>0&&!this.model.isOut()&&(this.getControl("objectSelect")||this._createObjectSelect(),this.getControl("subTypeSelect")||this._createSubTypeSelect(),i=this._createAttributesUI(),this.getControl("cspacesSelect")||this._createCollabSpaceSelect(),t=e.createElement("div",{styles:{margin:"0 10px 10px"},html:[{styles:{"margin-bottom":"10px"},class:"object-type-select-wrapper",html:this.getControl("objectSelect")},{styles:{"margin-bottom":"10px"},class:"subtype-select-wrapper",html:this.getControl("subTypeSelect")},{class:"attributes-wrapper",styles:{"margin-bottom":"10px"},html:i},{styles:{"margin-bottom":"10px"},class:"collab-space-select-wrapper",html:this.getControl("cspacesSelect")}]})):t=e.createElement("div",{styles:{margin:"auto","text-align":"center"},html:new r({className:"msg-animation",visible:!0,animate:!0,spin:!0})}),t},_createObjectSelect:function(){var e=this,i=this.addControl("objectSelect",new a({placeholder:t.Whatdoyouwanttocreate,options:[],events:{onChange:function(t){e._onObjectSelectChange.call(e,t,i)}}}));this._populateObjectSelect()},_populateObjectSelect:function(){var e=[],t=this.getControl("objectSelect");this._licenseCollection.forEach(function(t){e.push({value:t.get("name"),label:t.get("label")})}),e[0].selected=!0,t.remove(),t.add(e),1===e.length&&t.disable()},_onObjectSelectChange:function(e,i){var n=e.target.value,o=this;""!==n?(this._objectToTransfer=n,this._currentTypeLicenseModel=this._licenseCollection.find(function(e){return e.get("name")===o._objectToTransfer}),this._saveBtn&&this._saveBtn.getContent().setText(l.replace(t.TransferyourideatoanEnoviaobject,{object:t.get(this._currentTypeLicenseModel.get("label").toLowerCase())})),i.elements&&i.elements.choices&&i.elements.choices.removeClassName("field-error")):(this._saveBtn.setDisabled(!0),this._objectToTransfer="",i.elements&&i.elements.choices&&i.elements.choices.addClassName("field-error")),this.getControl("subTypeSelect")&&(this._populateSubTypeSelect(),this._createAttributesUI()),this.getControl("cspacesSelect")&&this._populateCollabSpaceSelect()},_createSubTypeSelect:function(){var e=this;this.addControl("subTypeSelect",new a({placeholder:t.Whatdoyouwanttocreate,events:{onChange:function(t){e._currentTypeLicenseModel.setSelectedSubType(t.target.value),e._subType=t.target.value}}})),this._populateSubTypeSelect()},_populateSubTypeSelect:function(){var e=[],t=this.getControl("subTypeSelect"),i=this._currentTypeLicenseModel.get("subtypes");this._currentTypeLicenseModel.setSelectedSubType(i[0].name),i.length>1?(i.forEach(function(t,i){e.push({selected:0===i,label:t.label,value:t.name})}),t.show(),t.remove(),t.add(e)):t.hide(),this._subType=i[0].name},_createAttributesUI:function(){var e=this,t=null;this._currentTypeLicenseModel.getAttributes().fetch({onComplete:function(i){e._saveBtn.setDisabled(!1),(t=e.getElement(".attributes-wrapper")).empty(),i.toArray().forEach(function(i){var n=i.get("options"),o=null;if(0===n.length)require(["DS/UWPClientControls/PlatformNotify"],function(t){t.error("Options for the attribute "+i.get("label")+" are required."),e._saveBtn.setDisabled(!0)});else if(1===n.length)o=n[0],e._currentSelectedAttributes.push({name:i.get("name"),value:o.value});else{-1===(o=n.findIndex(function(e){return e.selected}))&&(n[0].selected=!0),e._currentSelectedAttributes.push({name:i.get("name"),value:o.value});var s=new a({options:[],placeholder:i.get("label"),events:{onChange:function(){var t=this.getValue()[0],n=e._currentSelectedAttributes.findIndex(function(e){return e.name===i.get("name")});e._currentSelectedAttributes[n].value=t}}});s.add(n),t.addContent(s)}})},onFailure:function(i){h.error("the attributes collection could not be fetched",i),(t=e.getElement(".attributes-wrapper")).empty(),e._saveBtn.setDisabled(!0)}})},_createCollabSpaceSelect:function(){var e=this;this.addControl("cspacesSelect",new a({options:[],className:"margin-0",placeholder:t.Selectasecuritycontext,styles:{display:"none"},events:{onChange:function(){e._currentCollabSpace=this.getValue()[0]}}})),this._populateCollabSpaceSelect()},_populateCollabSpaceSelect:function(){var e=[],t=this,i=this.getControl("cspacesSelect"),n=null;this._currentTypeLicenseModel.getCollabSpaces().fetch({onComplete:function(o){0===(n=o.toArray()).length?t._saveBtn.setDisabled(!1):(n.forEach(function(t,i){e.push({selected:0===i,label:t.get("label"),value:t.get("name")})}),i.show(),i.remove(),i.add(e))}})},_onStatusIdChanged:function(){var e=this;u.get3DSpaceUrl(n.getInstance().get("config").tenant.online_instance_id).then(function(i){e._3dspaceURL=i,e._licenseCollection.set3DSpaceUrl(i),e._licenseCollection.fetch({onComplete:function(t){0===t.size()?e.dispatchEvent("NoLicensesError"):(e._viewReadyToBeRendered=!0,e.refresh())},onFailure:function(i,n){e.alert("error",t.LicenceFetchKO),h.error("The call to fetch the licenses failed:",n&&n.error),e.dispatchEvent("LicenseFetchError")}})})},setup:function(e){var t=this._parent.apply(this,e);return this._viewReadyToBeRendered=!1,this._saveBtn=e.saveBtn,this._saveBtn.addEvent("onClick",this._onTransferButtonClick.bind(this)),this._statusCollectionInstance=this.model.getIdeaType().getStatusCollection(),this._licenseCollection=c,this._statusCollectionInstance.hasBeenFetched()&&this._onStatusIdChanged(),this.reactTo(this._statusCollectionInstance,"onSync:read",this._onStatusIdChanged,this),t},_getProcessedContent:function(){var i,n=this.model;this._statusCollectionInstance.forEach(function(e){n.get("status_id")==e.get("mid")&&(i=e.get("title"))});var s,a,r,l,c,d,m,u=n.get("content")+"<p>"+t.Originalidea+' <a target="_blank" href="'+o.getBaseUrl()+n.getRelativePath()+'">'+n.get("title")+"</a> "+t.instatus+' "'+i+'"</p>',h=e.createElement("div",{html:u}),p=h.getElements("img[data-media-id]");for(d=0,m=p.length;d<m;d++)l=(s=p[d]).attributes,a=s.dataset.mediaId,r=s.dataset.communityId,s.removeAttribute("style"),s.removeAttribute("alt"),(c=document.createAttribute("style")).value="width: 300px;",l.setNamedItem(c),a&&(r&&((c=document.createAttribute("onclick")).value="window.open('"+o.getBaseUrl()+"/#community:"+r+"/media:"+a+"')",l.setNamedItem(c)),l.getNamedItem("src")||((c=document.createAttribute("src")).value=o.getBaseUrl()+"/api/media/streammedia/id/"+a+"/type/picture/key/o1/",l.setNamedItem(c)));return h},_onTransferButtonClick:function(){""!==this.getControl("cspacesSelect").getValue()[0]?(this._saveBtn.load(),this._createEnoviaObject()):(this.getControl("cspacesSelect").elements.choices.addClassName("field-error"),this.alert("warn",t.Pleaseselectasecuritycontext))},_createEnoviaObject:function(){var e={type:this._subType?this._subType:this._objectToTransfer,title:this.model.get("title"),content:this.model.get("content",{escapeHTML:!1}),fields:this._currentSelectedAttributes,threeDSpaceUrl:this._3dspaceURL},i=null,n=this,o=null;this._statusCollectionInstance.find(function(e){n.model.get("status_id")==e.get("mid")&&(i=e.get("title"))}),(o=new d(e)).setAssociated("idea",this.model),o.save({serviceURI:this._currentTypeLicenseModel.getServiceURI(),collabSpace:this._currentCollabSpace,dsCSRFToken:this._licenseCollection.getDSCSRFToken(),ideaStatusTitle:i,ideaModelRelativePath:this.model.getRelativePath(),objectLabel:this._currentTypeLicenseModel.get("label"),onComplete:function(){n.alert("success",l.replace(t.Yourobjecthasbeencreated,{object:t.get(n._currentTypeLicenseModel.get("label"))})),n._saveBtn.load(!1)},onFailure:function(){n.dispatchEvent("EnoviaObjectCreationFailed")}})}});return m.extend({_ideaTransferFormView:null,init:function(i){var n=this;i.className="fancy idea-transfer-modal",this._parent(i),delete i.className;var o=new s({className:"transfer-button default",value:t.Transfer});i=e.merge(i,{saveBtn:o}),this._ideaTransferFormView=new p(i),this._ideaTransferFormView.addEvent("LicenseFetchError",function(){n.destroy()}),this._ideaTransferFormView.addEvent("NoLicensesError",function(){require(["DS/UWPClientControls/PlatformNotify"],function(e){e.error(t.NoLicensesError)}),n.destroy()}),this._ideaTransferFormView.addEvent("EnoviaObjectCreationFailed",function(){n.destroy()}),i.model.addEvent("TransferChange",function(){n.destroy()}),this.setHeader("<h4>"+t.TransferModalTitle+"</h4>"),this.setBody([this._ideaTransferFormView]),this.setFooter([o,new s({value:t.Cancel,events:{onClick:function(){this.destroy()}.bind(this)}})])},closable:!0})}),define("DS/SwymUIComponents/script/feature/community/idea/view/link-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/idea/view/link-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/idea/model/link-model","DS/SwymUICore/script/feature/core/sprite/sprite","DS/SwymUIComponents/script/feature/core/modal/super-modal","DS/SwymUICore/script/feature/community/idea/model/idea-model","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/utils/utils"],function(e,t,i,n,o,s,a,r,l){"use strict";return i.extend({_modelClass:n,_modelEventsForAutoRefresh:["onChange"],_modelEvents:{"onRequest:delete":"mask","onError:delete":"unmask"},name:"link-view",_userCanDeleteLink:!0,domEvents:{"click .delete-link":"onDeleteLinkClick"},_createContent:function(){var i=this.model;if(i){var n,s,r,c,d=i.get("content_title"),m=i.get("model_title"),u=i.get("url",{escapeHTML:!1}),h=i.get("type"),p=i.get("model_id"),g=(i.get("model"),i.get("ideation_id")),w=i.getAssociated("community");i.get("leaf_model");return!0===i.get("community_accessible")?n=e.createElement("div",{class:"dsi-result-direct-wrapper",html:[{tag:"a",target:"_blank","data-content-type":"community","data-content-id":w.get("mid"),html:t.Linktoacontentofthiscommunity+w.get("title")}]}):"internal"===h&&i.hasAssociation("linkedModel")?(this._contentTypeUrlPart=i.get("contentTypeUrlPart"),c=w.get("mid"),r=(s=i.getAssociated("linkedModel")).getContentType&&s.getContentType()||s.getModelName(),new a({id:g}),n=e.createElement("div",{html:[{tag:"div",class:"dsi-result-direct-wrapper",html:[this._userCanDeleteLink?{tag:"div",class:"delete-link",styles:{float:"right",margin:"0 0 10px 10px"},title:t.Deletethislink,html:[{class:"red-cancel-communities"}]}:"",{tag:"div",html:[{tag:"a",class:"content-thumbnail-link","data-type":"internal","data-content-type":r,"data-content-id":p,"data-community-id":c,href:"#",html:o.renderMediaThumbnail({width:46,height:34,id:p,modelId:p,modelName:this._contentTypeUrlPart,cls:"dsi-communities-home-list-picture"})}]},{tag:"div",html:[{tag:"span",class:"content-link",html:[{tag:"span",class:"fonticon fonticon-"+l.getIconFromModel(i.get("contentTypeUrlPart"))},{tag:"a","data-type":"internal","data-content-type":r,"data-content-id":p,"data-community-id":c,href:"#",html:m}]}]},{tag:"div",class:"link-title community-link",html:[{tag:"span",html:t.In+" "},{tag:"span",html:{tag:"a","data-type":"internal","data-content-type":"community","data-content-id":c,href:"#",html:w.get("title")}}]}]}]})):"external_url"===h&&(n=e.createElement("div",{class:"dsi-result-direct-wrapper",html:[this._userCanDeleteLink?{tag:"div",class:"delete-link",styles:{float:"right",margin:"0 0 10px 10px"},title:t.Deletethislink,html:[{class:"red-cancel-communities"}]}:"",{tag:"span",class:"content-link",html:{tag:"a",target:"_blank",href:u,html:d}}]})),n}},onCommunityLinkClick:function(e){e.stopPropagation(),e.preventDefault();var t=this.model.get("community");this._context.reset({contentId:t.mid,contentType:"community"})},onContentLinkClick:function(e){e.stopPropagation(),e.preventDefault();var t=this.model;this._context.reset({contentId:t.get("model_id"),contentType:this._contentTypeUrlPart,communityId:t.get("community").mid})},onDeleteLinkClick:function(){var e=this.getControl("deleteConfirmationModal");e||(e=this.addControl("deleteConfirmationModal",new s({closable:!1,renderTo:this._widget.body}))),e.confirm(t.Doyouwanttodeletethislink,t.Confirm,function(i){!0===i?(this.alert("success",t.Thelinkhasbeendeleted),this.model.destroy()):e.dispatchEvent("onCancel")}.bind(this))},setup:function(e){return e.hasOwnProperty("userCanDeleteLink")&&(this._userCanDeleteLink=e.userCanDeleteLink),this._context=r.getInstance(),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/core/tenant/view/user-admin-view",["i18n!DS/SwymUIComponents/assets/nls/feature/core/tenant/view/user-admin-view","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/core/user/view/user-picture-view","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/lib/request/data","DS/SwymUIComponents/script/feature/core/modal/super-modal","DS/UWPClientCode/I18n"],function(e,t,i,n,o,s,a,r){"use strict";return i.extend({model:null,mode:"view",name:"user-admin-view",_confirmModal:null,domEvents:{"click .delete-icon":"_deleteAdmin"},_createContent:function(){if(this.model){var e=this.model;return{class:"user-admin-item",html:[{class:"user-admin-pic",html:this.addChildView("userPicture",{Class:n,model:e,imageRenderingOptions:{format:"mini"}})},{styles:{float:"left"},html:'<div class="nickname" title="'+e.getNickname()+'">'+e.getNickname()+"</div>"},"0"===e.get("is_inherited_acl")?{styles:{float:"left",width:"17px"},html:'<div class="delete-icon" style="cursor: pointer; padding: 7px 0 0 10px; float:right;">X</div>'}:""]}}},_deleteAdmin:function(){this._confirmModal.confirm(r.replace(e.Areyousure,{nickname:this.model.getNickname()}),e.Confirm,function(e){if(!0===e){var i=t.adaptService.call({},{url:o.getBaseUrl()+"/api/User/unsetTenantModeratorACL",data:{hash_key:this.model.get("hash_key")},onComplete:function(){this.model.collection.remove(this.model)}.bind(this)});s.request(i)}}.bind(this))},setup:function(){this._parent.apply(this,arguments),this._confirmModal=new a({closable:!1,renderTo:this._widget.body})}})}),define("DS/SwymUIComponents/script/feature/community/social-event/edit/external-users-view",["UWA/Core","DS/SwymUIComponents/script/feature/community/social-event/edit/external-users-edit-view","DS/UWPClientControls/PlatformNotify","i18n!DS/SwymUIComponents/assets/nls/feature/community/social-event/social-event-view"],function(e,t,i,n){"use strict";return t.extend({name:"external-users-view",domEvents:{"click .external-users .first-line .fonticon-user-add":"toggleExternalUsersEl"},_modelEvents:{"onChange:external_users":"refresh"},init:function(){this._parent.apply(this,arguments),this._externalUsersExpanded=!1},onEmailAdded:function(){this._parent.apply(this,arguments),this.saveExternalUsers({add:!0})},onRemoveEmailClicked:function(){this._parent.apply(this,arguments),this.saveExternalUsers({remove:!0})},saveExternalUsers:function(e){const t=this,o=this.getExternalUsersArray();this.model.save({external_users:o.join(",")},{onComplete:function(){t.refresh()},onFailure:function(){e&&e.add&&i.error(n.TheEmailCouldNotBeAddedPleaseTryAgainLater),e&&e.remove&&i.error(n.TheEmailCouldNotBeRemovedPleaseTryAgainLater)}})},toggleExternalUsersEl:function(e){const t=e.target;t&&t.hasClassName("fonticon-user-add")&&(this._externalUsersExpanded=!0,this.updateExternalUsersEl())},hasEditRights:function(){const e=this.model.get("_acl");return e.update&&e.update.access},updateExternalUsersEl:function(){return this.externalUsersEl||(this.externalUserLimitationReminderEl=e.createElement("span",{class:"ext-user-limit-text",html:""}),this.updateExternalUsersText(),this.externalUsersEl=e.createElement("div",{class:"external-users",html:[{tag:"div",class:"first-line heading",html:[{tag:"span",class:"ext-users-heading",html:n.ExternalUsers}]},this.getControl("extUsersInput")]})),this._externalUsersExpanded?(this.externalUserLimitationReminderEl.show(),this.getControl("extUsersInput").show()):(this.externalUserLimitationReminderEl.hide(),this.getControl("extUsersInput").hide()),this.externalUsersEl},reset:function(){this.resetExternalUsersArray(),this.getControl("extUsersInput").reset(),this.updateExternalUsersText()},createEmailCardsArray:function(e){return this.resetExternalUsersArray(),this.model.get("external_users")&&this.addExternalUser(this.model.get("external_users")),this._parent.apply(this,arguments)},_createContent:function(){return[{class:"ext-users-edit",html:[this.updateExternalUsersEl(),this.createEmailCardsArray({hideClose:!0})]}]}})}),define("DS/SwymUIComponents/script/feature/community/content/view/compact-author-section-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/utils/date","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUIComponents/script/feature/community/content/view/content-small-view-factory","DS/UIKIT/Tooltip","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/view/abstract-content-view","DS/SwymUICore/script/utils/i18n","DS/SwymUIComponents/script/feature/core/user/view/user-picture-view","DS/SwymUICore/script/constants/community-constants","DS/WebappsUtils/Console","DS/SwymUIComponents/script/feature/community/content/view/sort-by-latest-view","DS/SwymUICore/script/utils/utils"],function(e,t,i,n,o,s,a,r,l,c,d,m,u){return t.extend({name:"content-author-section",_modelEventsForAutoRefresh:["onSync","onChange:author","onChange:community","onChange:originalAuthor"],_getAuthorPicture(e){var t=e.getAuthor();return t.get("login")&&this.addChildView("userPicture",{tagName:"span",Class:l,model:t,imageRenderingOptions:{format:"normal"}})},_getPeopleLink(t){var i=t.getAuthor();return e.createElement("a",{tag:"a",class:"link","data-content-type":"person","data-login":"9"===t.get("ut_state")?"anonymous":i.get("login"),html:i.getNickname()})},_getAuthorView(t){return e.createElement("span",{class:"content-detail-author",html:this._getPeopleLink(t)})},_getThreadLink(t){var i=t.getCommunity();return i&&i.get("title")&&!1!==this.getOption("showThreadLink")&&!i.isDirectMessage()?e.createElement("span",{class:"content-detail-thread",html:{tag:"a",class:"link","data-content-type":"community","data-content-id":i.get("mid"),html:`<span class="fonticon fonticon-expand-right"></span>${i.get("title")}`}}):""},_getActivityDate(t){var n=t.get("update")&&"wiki"===t.getModelName(),o=t.get("update")&&"wiki"===t.getModelName();return e.createElement("span",{class:"content-detail-activity-date",html:(o?`${a.LastUpdate}:`:"")+i.prettyDate(n&&t.get("update")||t.getPublishingDate())})},_getModificationDate(t){var i,n=t.get("moderation_status"),o="updated_by_author"===n?a.Edited:"updated"===n?a.Moderated:null;return i=o?e.createElement("span",{class:"content-detail-moderation-status",html:`- ${o}`}):{},o&&this._addModerationTooltip(t,i),i},_getMultiContributorsView(t){var i=e.createElement("span",{class:"multi-contributors fonticon fonticon-users"});return this.getChildView("nbContributors")&&this.removeChildView("nbContributors"),[i,e.createElement("span",{class:"content-detail-author",html:[`${a.by} `,this.addChildView("nbContributors",{Class:o.getViewClass("nbContributors"),model:t})]})]},_addModerationTooltip(e,t){var n=e.get("moderation_status"),o="updated_by_author"===n?a.EditedTooltip:"updated"===n?a.ModeratedTooltip:null;this.addControl("moderation-status-tooltip",new s({target:t,body:r.replace(o,{prettyDate:i.prettyDate(e.get("moderation_date"))}),position:"bottom"}))},_getOriginalAuthorLink(){const t=this.model.has("originalAuthor")&&this.model.getAssociated&&this.model.getAssociated("originalAuthor");return t&&!t.isNew()&&t.get("ds6w:resourceUid")!==this.model.getAuthor().get("ds6w:resourceUid")&&"wiki"!==this.model.getContentType()?e.createElement("div",{class:"original-author-link",html:[{html:a.ForwardedFrom},{tag:"a",class:"link","data-content-type":"person","data-login":"9"===this.model.get("ut_state")?"anonymous":t.get("login"),html:t.getNickname()}]}):""},_sortByLatestModeView(){let e;return e="simple"===this.mode?[this._getPeopleLink,this._getActivityDate]:"multiContributors"===this.mode?[this._getMultiContributorsView,this._getThreadLink,this._getActivityDate,this._getModificationDate]:1===u.getNbLayoutColumns()?[this._getAuthorPicture,this._getAuthorView]:[this._getAuthorPicture,this._getAuthorView,this._createSortByLatestSection]},_createSortByLatestSection(){return this.addChildView("sortByLatestView",new m({model:this.model,sortMode:this.getOption("sortMode")}))},setup(e){this.mode=e.mode,this.isSortByLatestMode=this.getOption("sortMode")===c.CTY_CONTENT_LIST_SORT_MODE.LATEST_CONTRIBUTIONS_DATE&&!this.getOption("contentId"),this._parent.call(this,e)},_createContent(){var{model:e}=this;return[{class:"author-left-section",html:(this.isSortByLatestMode?this._sortByLatestModeView():"simple"===this.mode?[this._getPeopleLink,this._getActivityDate]:"multiContributors"===this.mode?[this._getMultiContributorsView,this._getThreadLink,this._getActivityDate,this._getModificationDate]:[this._getAuthorPicture,this._getAuthorView,this._getActivityDate]).map(function(t){return t.apply(this,[e])}.bind(this))},this._getOriginalAuthorLink()]}})}),define("DS/SwymUIComponents/script/feature/community/wiki/view/vuetify/vuetify-wiki-treeview",["DS/SwymUIComponents/script/utils/swym-vue"],function(e){const{Vue:t,Vuetify:i}=e;return t.extend({props:{treeModel:{type:Array,default:()=>[]},activatable:{type:Boolean},multipleActive:{type:Boolean},isVisible:{type:Boolean}},vuetify:new i({icons:{iconfont:"fonticon",values:{expand:"fonticon-expand-right",checkboxOff:"fonticon-checkbox-off",checkboxOn:"fonticon-checkbox-on",privatePage:"fonticon-user-key"}}}),template:'<template>\n\t\t\t\t\t\t\t\t<vu-scroller v-show="isVisible">\n\t\t\t\t\t\t\t\t\t<v-treeview\n\t\t\t\t\t\t\t\t\t\t:items="items"\n\t\t\t\t\t\t\t\t\t\t:activatable="activatable"\n\t\t\t\t\t\t\t\t\t\t:multiple-active="multipleActive"\n\t\t\t\t\t\t\t\t\t\tdense\n\t\t\t\t\t\t\t\t\t\t:active.sync="selection"\n\t\t\t\t\t\t\t\t\t\tref="tree"\n\t\t\t\t\t\t\t\t\t\t:open="initiallyOpen"\n\t\t\t\t\t\t\t\t\t\titem-key="subject6wuri"\n\t\t\t\t\t\t\t\t\t\texpand-icon=$expand\n\t\t\t\t\t\t\t\t\t\t@update:active="updateSelection">\n\t\t\t\t\t\t\t\t\t\t<template v-slot:label="{item}">\n\t\t\t\t\t\t\t\t\t\t\t<v-icon \n\t\t\t\t\t\t\t\t\t\t\t\tv-if="item.isPrivate === true">\n\t\t\t\t\t\t\t\t\t\t\t\t$privatePage\n\t\t\t\t\t\t\t\t\t\t\t</v-icon>\n\t\t\t\t\t\t\t\t\t\t\t{{item.name}}\n\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t\t<template v-slot:append="{ item, active }">\n\t\t\t\t\t\t\t\t\t\t\t<v-icon>\n\t\t\t\t\t\t\t\t\t\t\t\t{{ active ? \'$checkboxOn\' : \'$checkboxOff\' }}\n\t\t\t\t\t\t\t\t\t\t\t</v-icon> \n\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t</v-treeview>\n\t\t\t\t\t\t\t\t</vu-scroller>\n\t\t\t\t\t\t\t</template>',data:()=>({selection:[],selectionCheckBox:[]}),computed:{items(){return this._formatTreeSelectable(this.treeModel)},initiallyOpen(){return this.treeModel.filter(e=>0===e.depth).map(e=>e.subject6wuri)},checkBox:()=>[{}]},watch:{isVisible(){return this.isVisible}},methods:{_formatTreeSelectable(e=[]){const t=[...e],i=[];for(;t.length;){const e=t.shift(),n={name:e.title,id:e.id,subject6wuri:e.subject6wuri,isPrivate:1!==e.visibility};if(t[0]&&t[0].depth!==e.depth){const o=[];for(;t[0]&&t[0].depth>e.depth;)o.push(t.shift());i.push({...n,children:this._formatTreeSelectable(o)})}else i.push(n)}return i},getActiveSelection(){return this.treeModel.filter(e=>this.$refs.tree.nodes[e.subject6wuri].isActive).map(e=>e.subject6wuri)},updateSelection(e){let t=!1;e.length>0&&(t=!0),this.$emit("onSelectionChange",t,e)}}})}),define("DS/SwymUIComponents/script/feature/core/user/view/language/user-language-edit-view",["UWA/Core","DS/SwymUIComponents/script/feature/core/user/view/components/user-stars-edit-view","DS/SwymUICore/script/feature/core/language/model/language-model","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/components/user-stars-edit-view","DS/UIKIT/Form","DS/UIKIT/Spinner","DS/SwymUICore/script/feature/core/language/collection/language-list-collection"],function(e,t,i,n,o,s,a){"use strict";return t.extend({_modelClass:i,name:"user-language-edit-view",_languagesOptions:[],_getForm:function(){var e=this.model;return e.get("mid")||e.get("language_id")||e.set("language_id",this._languagesOptions[0].value),new o({fields:[{type:"select",options:this._languagesOptions,label:n.Language,value:e.get("language_id"),required:!0,events:{onChange:function(){for(var t,i=this.options.options,n=0,o=i.length;n<o&&(t=i[n]).value!==this.getValue()[0];n++);t.lang_english!==e.get("lang_english")&&(e.addChanges("language_id",t.value),e.addChanges("lang_native",t.lang_native),e.addChanges("lang_english",t.lang_english),e.addChanges("translated",t.translated))}}},this._createContentInputStars(),{type:"textarea",label:n.Details,value:e.get("description",{escapeHTML:!1}),name:"details",events:{onChange:function(){e.addChanges("description",this.getValue())}}}]})},_createContent:function(){this.container.setStyle("text-align","center");var e=this.addControl("form-box-view",new s({className:"msg-animation",visible:!0,animate:!0,spin:!0})),t=this;return new a([],{mode:"getlanglist"}).fetchOnce({onComplete:function(i){this._languagesOptions=new Array,i.sort();for(var n=i._models,o=function(e){return!(!e.get("mid")||e.get("iso_code")!==this.get("iso_code"))},s=t.model?t.model.collection.getAssociated("user").getAssociated("languages"):[],a=s.clone(),r=0,l=n.length;r<l;r++){var c=(m=n[r]).get("translated")?m.get("translated"):m.get("lang_english");(!a.find(o,m)||this.model.get("mid")&&m.get("iso_code")===this.model.get("iso_code"))&&this._languagesOptions.push({label:c+" ("+m.get("lang_native")+")",value:""+m.get("mid"),lang_native:m.get("lang_native"),lang_english:m.get("lang_english"),translated:c})}var d=0;for(l=s.length;d<l;d++){var m=s.at(d),u=i.where({iso_code:m.get("iso_code")});m.set("translated",u[0].get("translation"))}if(t.container){if(!t.model.get("mid")){var h="",p=this.model.collection.filter(function(e){return e.get("language_id")!=t.model.get("language_id")});for(r=0,l=this._languagesOptions.length;r<l;r++)if(h=this._languagesOptions[r].value,0===p.filter(function(e){return e.get("language_id")===h}).length){h=this._languagesOptions[r];break}t.model.set({lang_english:h.lang_english,iso_code:h.value,lang_native:h.lang_native,language_id:h.value})}t.container.setStyle("text-align","inherit");var g=t._getForm();e=t.addControl("form-box-view",g),g.inject(t.container),t.dispatchEvent("onLanguageRefresh",[t])}}.bind(this)}),e}})}),define("DS/SwymUIComponents/script/feature/core/user/view/language/user-language-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/language/user-language-view","DS/SwymUICore/script/feature/core/language/model/language-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/core/ui-components/edit-view-mode-switcher/edit-view-mode-switcher","DS/SwymUIComponents/script/feature/core/ui-components/box-view/box-view","DS/SwymUIComponents/script/feature/core/user/view/language/user-language-edit-view","DS/SwymUIComponents/script/feature/core/modal/super-modal"],function(e,t,i,n,o,s,a,r){"use strict";return n.extend({_modelClass:i,name:"language-view",_createContent:function(){var i=new s({model:this.model,widget:this._widget}),n=new a({model:this.model,widget:this._widget,_labelNameInput:"language test to pick"});return e.createElement("div",{html:this.addChildView("edition-switch",{Class:o,model:this.model,editView:n,readView:i,actionOnSave:function(e){var i=this.getChildView("edition-switch").getChildView("editview").getControl("form-box-view").validate(),n=this.model.isNew();return!0===e?i:i?void((n||Object.keys(this.model.getChanges()).length)&&this.model.save({},{onComplete:function(e,i){var o=n?t.languageCreated:t.languageUpdated;this.alert("success",o),e.set(e.getChanges());var s=this.getChildView("edition-switch");s&&s.setMode("read")}.bind(this),onFailure:function(){}})):(this.alert("error",t.pleaseFillTheFieldsCorrectly),i)}.bind(this),actionOnDestroy:function(){new r({closable:!0,renderTo:this._widget.body}).confirm(t.deletewarning,t.deletequestion,function(e){if(!0===e)if(!1===this.model.isNew())this.model.destroy({onComplete:function(){this.alert("success",t.languageDeletedSucess)}.bind(this),onFailure:function(){this.alert("error",t.YourchangescouldnotbesavedPleasetryagainlater)}.bind(this)});else{var i=this.getChildView("edition-switch");i&&i.onCancelClick()}}.bind(this))}.bind(this)})})}})}),define("DS/SwymUIComponents/script/feature/community/wedo/wedo-view",["UWA/Core","DS/SwymUICore/script/feature/community/wedo/model/wedo-model","DS/SwymUIComponents/script/feature/core/ui-components/list/list-item/item-view"],function(e,t,i){"use strict";return i.extend({_modelClass:t,name:"wedo-view",getClassNames:function(){return(this._parent.apply(this,arguments)||"")+" one-column"},defaultOptions:{summaryViewClass:"DS/SwymUIComponents/script/feature/community/wedo/view/wedo-summary-view",detailedViewClass:"DS/SwymUIComponents/script/feature/community/wedo/view/wedo-detailed-view",editViewClass:"DS/SwymUIComponents/script/feature/community/wedo/edit/wedo-edit-view"}})}),define("DS/SwymUIComponents/script/feature/core/tenant/view/user-admin-collection-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/SwymUIComponents/script/feature/core/tenant/view/user-admin-view","DS/WebappsUtils/Console"],function(e,t,i,n,o){return t.extend({_collectionClass:i,modelViewClass:n})}),define("DS/SwymUIComponents/script/feature/core/tenant/view/role-assignment-home-view",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","i18n!DS/SwymUIComponents/assets/nls/feature/core/tenant/view/role-assignment-home-view","i18n!DS/SwymUIComponents/assets/nls/feature/core/tenant/view/user-admin-view","DS/SwymUICore/script/utils/i18n","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/SwymUIComponents/script/feature/core/search/view/user-search-factory","DS/SwymUIComponents/script/feature/core/tenant/view/user-admin-collection-view","DS/SwymUIComponents/script/feature/core/modal/super-modal","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/lib/request/data","DS/WebappsUtils/Console"],function(e,t,i,n,o,s,a,r,l,c,d,m,u){return s.extend({model:null,_el:null,_confirmModal:null,_adminCollection:null,name:"role-assignment-home-view",_createContent:function(){return this._confirmModal=new c({closable:!1,renderTo:this._widget.body}),this._adminCollection=new a([],{mode:"listtenantmoderators",limit:999,tenantId:this.model.get("tenant_uuid")}),this._adminCollection.addEvent("onRemove",function(){this.alert("success",i.Admindeletedsuccessfully)},this),this._adminCollection.fetch(),e.createElement("div",{styles:{padding:"10px"},html:[{styles:{"margin-bottom":"10px"},html:i.AddTAdmin},this.addControl("user-search-control",r.createUserSearchControl({events:{onSelect:function(e){var s=o.replace(n.AreyousureAdd,{nickname:e.label});this._confirmModal.confirm(s,i.Confirm,function(n){if(1==n){var o=t.adaptService.call({},{url:d.getBaseUrl()+"/api/User/setTenantModeratorACL",data:{hash_key:e.hash_key},onComplete:function(e){var t=this.view,n=t.getControl("user-search-control");this.user.is_inherited_acl="0",t._adminCollection.add(this.user),n&&n.reset(),t.alert("success",i.Adminaddedsuccessfully)}.bind({view:this,user:e}),onFailure:function(e){"ERROR_TENANT_ACL_ALREADY_SET"==e.errorcode?this.alert("warn",i.Thisuserisalreadyadministrator):this.alert("error",i.Theadmincouldnotbeadded)}.bind(this)});m.request(o)}}.bind(this))}.bind(this)}})),{styles:{"margin-top":"10px"},html:i.Administratorlist},{html:this.addChildView("usersList",new l({collection:this._adminCollection,widget:this._widget}))}]})}})}),define("DS/SwymUIComponents/script/feature/community/post/post-view",["UWA/Core","DS/SwymUICore/script/feature/community/post/model/post-model","DS/SwymUIComponents/script/feature/core/ui-components/list/list-item/item-view"],function(e,t,i){"use strict";return i.extend({_modelClass:t,name:"post-view",getClassNames:function(){return(this._parent.apply(this,arguments)||"")+" one-column"},defaultOptions:{summaryViewClass:"DS/SwymUIComponents/script/feature/community/post/view/post-summary-view",detailedViewClass:"DS/SwymUIComponents/script/feature/community/post/view/post-detailed-view",editViewClass:"DS/SwymUIComponents/script/feature/community/post/edit/post-edit-view"}})}),define("DS/SwymUIComponents/script/feature/core/user/view/author-view",["UWA/Core","UWA/String","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/small-user-tile-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/utils/utils","DS/SwymUIComponents/script/feature/core/user/view/user-picture-view","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUIComponents/script/feature/core/network/view/invitation-layer-view","DS/UIKIT/Tooltip","DS/RTUserPresenceAPI/RTUserPresenceAPI","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/navigation"],function(e,t,i,n,o,s,a,r,l,c,d,m){"use strict";return n.extend({_modelClass:a,_modelEvents:{onChange:"refresh"},_invitationStatus:null,_invitationAlreadySent:null,imageReloadOptions:{useSprite:!1},attributes:{styles:{"margin-right":"0px","margin-left":"0px","padding-bottom":"10px","padding-top":"10px"}},defaultOptions:{invitationFeature:!0,pictureCls:"width-80px",userInfosResponsivenessCls:"col-xs-8"},domEvents:{"click .fonticon-user-add":"invitLayer"},name:"author-view",invitLayer:function(){!0===this._invitationAlreadySent||"new"===this._invitationStatus.connected_user_to_user?this.alert("info",i.alreadySentInvitation):new r({model:this.model}).launch(function(){this._invitationAlreadySent=!0}.bind(this))},getUserPictureView:function(){var e=d.getInstance().get("config").tenant,t=this;return this.model.get("login")?(this._userPresenceView||(this._userPresenceView=new c({size:"80px",login:this.model.get("login"),tenantId:e.id,username:"",swymUrl:o.getBaseUrl(),onclick:function(){m.goToProfile({login:t.model.get("login")})}})),this._userPresenceView.render(),this._userPresenceView):this.addChildView("userPicture",{Class:s,model:this.model,imageRenderingOptions:{format:"normal",cls:this.options.pictureCls}})},_createContent:function(){var e,i,n,o=this.model,s=this.getUserPictureView();if(o){e=o.get("city"),i=o.get("country"),n=o.get("address");const a=[];return e&&a.push(t.unescapeHTML(e)),i&&a.push(i),[s,{class:"user-data-section",html:[{class:this.options.userInfosResponsivenessCls,html:[{class:"object-title",html:["9"===o.get("ut_state")?{tag:"span",html:(o.get("first_name")+o.get("last_name")||"")+" "}:{tag:"a","data-content-type":"person","data-hash-key":o.get("hash_key"),"data-login":o.get("login"),html:(o.getNickname()||"")+" "},{tag:"span",class:"fonticon hidden"}]}]},{class:this.options.userInfosResponsivenessCls,html:[o.get("job_title")?{class:"detail",html:t.unescapeHTML(o.get("job_title"))}:"",o.get("company")?{class:"detail",html:t.unescapeHTML(o.get("company"))}:"",n?{class:"detail",html:t.unescapeHTML(n)}:"",e||i?{class:"detail",html:a.join(", ")}:""]}]}]}},_handleInvitationIconDisplay:function(){var t;this._rendered&&this._invitationStatus&&"0"==this._invitationStatus.user_in_network&&(t=this.getElement(".user-data-section .fonticon"))&&(t.addClassName("fonticon-user-add"),t.removeClassName("hidden"),e.Utils.Client.Features.touchEvents||this.addControl("addTooltip",new l({className:"addToNetwork",target:t,body:i.addtoyourconnections})))},_getUserInvitationStatus:function(){var t=this;this.model&&(e.is(this.model.get("ut_state"))?this.model.getInvitationStatus({set:!1,onComplete:function(e,i){t._invitationStatus=i.result,t._handleInvitationIconDisplay()}}):this.listenToOnce(this.model,"onChange:ut_state",this._getUserInvitationStatus))},onSetModel:function(e,t,i){!1!==this.options.invitationFeature&&d.getInstance().isFeatureActivated("activate_user_network")&&!i.isCurrentUser()&&i.get("login")&&(this._invitationStatus=null,this._getUserInvitationStatus())},onRedraw:function(){d.getInstance().isFeatureActivated("activate_user_network")&&this._handleInvitationIconDisplay()},destroy:function(){try{this._userPresenceView&&this._userPresenceView.destroy()}catch(e){}this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/survey/view/answer-editor-collection-view",["DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUICore/script/feature/community/survey/collection/answer-collection","DS/SwymUIComponents/script/feature/community/survey/view/answer-editor-view"],function(e,t,i){return e.extend({_collectionClass:t,modelViewClass:i,_collectionEvents:{onChange:"_onContentChanged",onRemove:"_onRemove"},bodyAttributes:{tag:"div"},_onRemove:function(e){"1"===e.get("is_open")&&this.dispatchEvent("onRemoveOpenAnswer")},_onContentChanged:function(){this.dispatchEvent("onContentChange")}})}),define("DS/SwymUIComponents/script/feature/core/auto-save/recovery-modal",["UWA/Core","DS/SwymUICore/script/feature/core/auto-save/auto-save-manager","DS/SwymUIComponents/script/feature/core/modal/modal","DS/UIKIT/Input/Button","i18n!DS/SwymUIComponents/assets/nls/feature/core/auto-save/auto-save"],function(e,t,i,n,o){"use strict";let s=!1;var a={getAutoSaveRecoveryHandledStatus:function(){return s},init:function(){var e=t.getInstance(),a=document.getElementsByClassName("site-container")[0];e.isAvailable(function(t){if(t){var r=new i({header:"<h4>"+o.ContentRecover+"</h4>",className:"fancy auto-save-modal",closable:!1,body:o.YouHaveNotPublishedYourLastContentCreation,footer:[new n({className:"primary",value:o.Recover,events:{onClick:function(){e.restoreContent(),r.destroy(),s=!0}}}),new n({value:o.Ignore,events:{onClick:function(){r.destroy(),e.ignore(),s=!0}}})]}).inject(document.body);r.show()}else s=!0;a&&a.addClassName("currentuser-call-done")})}};return a}),define("DS/SwymUIComponents/script/feature/community/thread/thread-list-view-mixin",["DS/SwymUIComponents/script/feature/community/community/view/community-item-view","DS/SwymUIComponents/script/feature/direct-message/view/direct-message-view","DS/SwymUICore/script/utils/usage-tracker","DS/SwymUICore/script/feature/thread/collection/thread-lite-collection"],function(e,t,i,n){"use strict";var o={_modelEvents:{"onChange:_containsContentUnreadByCurrentUser":"_updateReadUnreadStatus"},_updateReadUnreadStatus:function(){var e,t=this;setTimeout(function(){e=t.container&&t.container.getClosest(".thread-view"),t.container&&e&&(!0===t.model.get("_containsContentUnreadByCurrentUser")?e.addClassName("with-unread-content"):e.removeClassName("with-unread-content"))},1)},onRedraw:function(){return this._updateReadUnreadStatus(),this._parent.apply(this,arguments)}},s=e.extend(o),a=t.extend(o);return s=s.extend({domEvents:{click:"_trackClick"},_trackClick:function(e){var t=e.target.getParent(".with-unread-content");e.target.getClosest(".tile-action-menu")||i.trackPageEvent({category:"MyCommunities",label:t?"navigateToActiveCommunity":"navigateToCommunity",view:"thread-list-view",event:"click"})}}),a=a.extend({domEvents:{click:"_trackClick"},_trackClick:function(e){var t=e.target.getParent(".with-unread-content");e.target.getClosest(".tile-action-menu")||i.trackPageEvent({category:"MyConversations",label:t?"navigateToActiveConversation":"navigateToConversation",view:"thread-list-view",event:"click"})}}),{_collectionClass:n,_onlyBodyUpdateOnIncrementalRefresh:!0,_toBeTemporarilyRemovedFromDomOnRefresh:!1,_customCommunityItem:s,_customDirectMessageItem:a,imageReloadOptions:{size:"s",useSprite:!1},_collectionLastMode:"read",className:"list-container",_isNotFavoriteOrHiddenConversationOrBlacklistedCommunity:function(e){return!e.get("is_favorite")&&(!e.get("users")&&!e.get("isBlacklisted")||e.get("users")&&!e.get("is_hidden"))},_isNotFavoriteOrHiddenOrWithoutUnreadContent:function(e){return this._isNotFavoriteOrHiddenConversationOrBlacklistedCommunity(e)&&this._hasUnreadContent(e)},_isFavorite:function(e){return e.get("is_favorite")},_isNotFavorite:function(e){return!e.get("is_favorite")},_hasFavorites:function(){return!!this.originalCollection.find(function(e){return e.get("is_favorite")})},_hasOnlyHiddenConversations:function(){return!this.originalCollection.find(function(e){return!e.get("is_hidden")})},_hasUnreadContent:function(e){return e.get("_containsContentUnreadByCurrentUser")},_loadLastMessage:function(e){e instanceof n&&this.collection.getLastMessage()},showContainer:function(){this.container.getChildren()[0]&&this.container.getChildren()[0].show()},onSearchReset:function(){this._collectionLastMode="read",this._resetCollection(this.originalCollection),this.showContainer()},onUnfilterByUnreadOnly:function(){this._collectionLastMode="read",this._resetCollection(this.originalCollection),this.showContainer()}}}),define("DS/SwymUIComponents/script/feature/core/user/view/skill/user-skill-edit-view",["UWA/Core","DS/SwymUIComponents/script/feature/core/user/view/components/user-stars-edit-view","DS/SwymUICore/script/feature/core/skill/model/skill-model","DS/UIKIT/Form","DS/WebappsUtils/Console","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/components/user-stars-edit-view"],function(e,t,i,n,o,s){"use strict";return t.extend({_modelClass:i,name:"user-skill-edit-view",_createContent:function(){var e=this.model;return this.addControl("form-box-view",new n({fields:[{type:"text",label:s.Skill,value:e.get("title",{escapeHTML:!1}),required:!0,events:{onChange:function(){e.addChanges("title",this.getValue())}}},this._createContentInputStars(),{type:"textarea",multiline:!0,rows:4,label:s.Details,value:e.get("description",{escapeHTML:!1}),name:"details",events:{onChange:function(){e.addChanges("description",this.getValue())}}}]}))}})}),define("DS/SwymUIComponents/script/feature/core/user/view/skill/user-skill-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/skill/user-skill-view","DS/SwymUICore/script/feature/core/skill/model/skill-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/core/ui-components/edit-view-mode-switcher/edit-view-mode-switcher","DS/SwymUIComponents/script/feature/core/ui-components/box-view/box-view","DS/SwymUIComponents/script/feature/core/user/view/skill/user-skill-edit-view","DS/SwymUIComponents/script/feature/core/modal/super-modal"],function(e,t,i,n,o,s,a,r){"use strict";return n.extend({_modelClass:i,name:"skill-view",_createContent:function(){var e=new s({model:this.model,widget:this._widget}),i=new a({model:this.model,widget:this._widget,_labelNameInput:"nls to be added"});return this.addChildView("edition-switch",{Class:o,model:this.model,editView:i,readView:e,actionOnSave:function(e){var i=this.getChildView("edition-switch").getChildView("editview").getControl("form-box-view").validate(),n=this.model.isNew();return!0===e?i:i?void this.model.save({},{onComplete:function(e,i){var o=n?t.skillCreated:t.skillUpdated;this.alert("success",o),e.set(e.getChanges());var s=this.getChildView("edition-switch");s&&s.setMode("read")}.bind(this),onFailure:function(e,i){"IllegalArgumentException"===i.errorcode&&(this.alert("error",t.skillDuplicate),this.destroy())}.bind(this)}):(this.alert("error",t.pleaseFillTheFieldsCorrectly),i)}.bind(this),actionOnDestroy:function(){new r({closable:!0,renderTo:this._widget.body}).confirm(t.deletewarning,t.deletequestion,function(e){if(!0===e)if(!1===this.model.isNew())this.model.destroy({onComplete:function(){this.alert("success",t.SkillDeletedSucess)}.bind(this),onFailure:function(){this.alert("error",t.YourchangescouldnotbesavedPleasetryagainlater)}.bind(this)});else{var i=this.getChildView("edition-switch");i&&i.onCancelClick()}}.bind(this))}.bind(this)})}})}),define("DS/SwymUIComponents/script/feature/community/social-event/social-event-view",["DS/SwymUICore/script/feature/community/social-event/model/social-event-model","DS/SwymUIComponents/script/feature/core/ui-components/list/list-item/item-view"],function(e,t){"use strict";return t.extend({_modelClass:e,name:"social-event-view",getClassNames:function(){return(this._parent.apply(this,arguments)||"")+" one-column"},defaultOptions:{summaryViewClass:"DS/SwymUIComponents/script/feature/community/social-event/view/social-event-summary-view",detailedViewClass:"DS/SwymUIComponents/script/feature/community/social-event/view/social-event-detailed-view",editViewClass:"DS/SwymUIComponents/script/feature/community/social-event/edit/social-event-edit-view"}})}),define("DS/SwymUIComponents/script/feature/core/rich-tooltip/view/rich-tooltip-view",["DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/community/content/view/media-thumbnail-view","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/utils/date","DS/SwymUIComponents/script/feature/community/community/view/community-signup-request-view","DS/SwymUIComponents/script/feature/core/user/view/author-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-signup-request-view"],function(e,t,i,n,o,s,a,r,l,c){"use strict";var d=null;var m=t.extend({_modelClass:o,_modelEventsForAutoRefresh:["onChange"],name:"rtt-community-infos-summary-view",_createContent:function(){var e=this.model,t=e.get("content_update"),n=e.get("update")>t?e.get("update"):t,o=e.getVisibility(),a=e.hasCurrentUserAccess();return[this.addChildView("communityLogo",{Class:i,model:e,imageRenderingOptions:{isLink:!0}}),{html:[{class:"object-title dsi-communitylist-title"+(!1===a?"-noaccess":""),html:{tag:"a",class:"link","data-content-type":"community","data-content-id":e.get("mid"),html:e.get("title")}},e.get("owner")?{class:"detail",html:[{tag:"span",html:l.OwnedBy+" "},e.getAssociated("owner").getNickname()||""]}:"",n?{class:"detail",html:[{tag:"span",html:l.LastUpdate+" "},s.prettyDate(n)]}:"",o&&"Unknown"!==o?{class:"detail",html:[{tag:"span",html:l.Visibility+" "},o]}:""]}]}}),u=t.extend({_modelClass:o,_modelEventsForAutoRefresh:["onChange"],name:"rtt-community-description-view",domEvents:{"click button.btn":"requestCommunityAccess","click .description.detail":"goToCommunity"},goToCommunity:function(){var e=this.model;require(["DS/SwymUICore/script/utils/navigation"],function(t){t.goToCommunity(e.get("mid"))})},_createContent:function(){var t=this.model,i=t.hasCurrentUserAccess(),n=t.get("description"),o=e.getInstance().isFeatureActivated("activate_community_join_request");return n||!1===i?[n?{class:"detail description",html:n}:"",!1===i&&!0===o?{class:"border-top community-access-request-btn",styles:{"text-align":"center"},html:{tag:"button",class:"btn btn-primary",styles:{"font-size":"12px"},html:c.RequestAccessToThisCommunity}}:""]:""},requestCommunityAccess:function(){var e,t;e=this.model,d&&d.model&&d.model.equals(e)?d.show():((t=new a({model:e})).render(document.body).show(),d&&!d.isDestroyed()&&d.destroy(),d=t)}});return t.extend({_modelClass:[n,o],_displayRichTooltips:!1,name:"rich-tooltip-view",defaultOptions:{contactsLimit:8},imageReloadOptions:{size:"m"},_createContent:function(){var e=this.model,t=e.getModelName();return[this.addChildView("topView",{className:"rich-tooltip-top flex-display",Class:"user"===t?r:m,model:e,userInfosResponsivenessCls:"col-xs-12"}),"user"!==t||e.get("login")?this.addChildView("bottomView",{className:"rich-tooltip-bottom",Class:"user"===t?"DS/SwymUIComponents/script/feature/core/user/view/shared-contacts-small-view":u,model:e,showBorder:!1,limit:this.options.contactsLimit,tooltipOptions:{className:"rich-tooltip-inner-tooltip"}}):{}]}})}),define("DS/SwymUIComponents/script/feature/core/rich-tooltip/rich-tooltip",["UWA/Core","DS/UIKIT/Popover","DS/SwymUICore/script/utils/utils","DS/SwymUIComponents/script/feature/core/rich-tooltip/view/rich-tooltip-view","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/RTAudioVideoAPI/RTAudioVideoAPI","DS/UIKIT/Tooltip","i18n!DS/SwymUIComponents/assets/nls/feature/direct-message/direct-messages"],function(e,t,i,n,o,s,a,r){"use strict";var l=t.extend({_destroyed:!1,defaultOptions:{className:"rich-tooltip flex-display",position:"bottom",closeOnClick:!0,autoHideOnClickOutside:!1,animate:!0,trigger:"",delay:{show:700,hide:100}},timeout:null,_enter:function(e){var t=this;return function(){var i=void 0===e?"toggle":e?"show":"hide",n=t.options.delay&&(void 0===e&&!t.isVisible||!0===e?t.options.delay.show:t.options.delay.hide);t.timeout&&clearTimeout(t.timeout),n?t.timeout=setTimeout(function(){!0!==t._destroyed&&t[i]()},n):t[i]()}},_hideIfTargetIsAbsentFromPage:function(){this.options&&!e.extendElement(this.options.target).isInjected(document.body)&&this.hide()},init:function(e){if(!e.viewOptions)throw new Error("Missing arguments");return e.timeout&&(this.timeout=e.timeout),e.body=this.innerView=new n(e.viewOptions),e.target.addClassName("rich-tooltip-target"),this.destroy=this.destroy.bind(this),this._parent.call(this,e)},buildSkeleton:function(e){var t=this._parent.call(this,e);return this.innerView.container.addEvent("resize",i.getDelayedSyncTask(this.updatePosition.bind(this),2e3)),t},getCoordinatesForPosition:function(e){var t=this.options,i=t.offset,n=t.target.getPosition(document.body),o=t.target.getSize(),s=this.elements.container.getSize(),a=e;return a.split(" ").length>1&&((a=e.indexOf("top")>-1?["top"]:["bottom"]).push(e.indexOf("left")>-1?"left":"right"),a=a[0]+" "+a.join("-")),/-right/.test(a)?n.x+=o.width-s.width:/(top|bottom)$/.test(a)&&(n.x+=o.width/2-s.width/2),/bottom/.test(a)?n.y+=o.height:/^(left|right)$/.test(a)?(n.x-=s.width,n.y+=o.height/2-s.height/2,"right"===a&&(n.x+=o.width+s.width)):n.y-=s.height,{left:Math.round(n.x+i.x+parseInt(t.target.getStyle("marginLeft"),10)),top:Math.round(n.y+i.y+parseInt(t.target.getStyle("marginTop"),10))}},updatePosition:function(){if(this.isVisible&&this.options){this._hideIfTargetIsAbsentFromPage();var e,t,i,n,o,s,a,r,l,c=this.options,d=this.elements,m=c.target,u=!1,h=!1,p={},g={};if(c.target){if(this._position||(this._position=c.position),e=d.container.offsetWidth,t=d.container.offsetHeight,p.offsets=m.getOffsets(),p.viewportWidth=document.documentElement.clientWidth||window.innerWidth,p.viewportHeight=document.documentElement.clientHeight||window.innerHeight,p.scrollTop=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop,p.offsets.y+=m.offsetHeight,u=p.offsets.x,h=p.offsets.y,"top"===this.defaultOptions.position?(o="top",s="bottom"):(o="bottom",s="top"),a=(l=this.getCoordinatesForPosition(o)).left>=0,r=p.viewportWidth-(l.left+e)>=0,g={bottom:p.viewportHeight+p.scrollTop-(h+t),top:h-(t+m.offsetHeight),right:p.viewportWidth-(u+e),left:u+m.offsetWidth-e},a&&r&&(g[o]>=10?n=o:g[s]>=10&&(n=s)),n||(g.right>=10?n="right":g.left>=10&&(n="left")),!n){for(var w in g)g[w]&&(!i||g[i]<g[w])&&(i=w);n=i}return this._position!==n&&(this.elements.container.removeClassName(this._position),this.elements.container.addClassName(n),this._position=n),this.elements.container.setStyles(n===o?l:this.getCoordinatesForPosition(n)),this}return this._parent.apply(this,arguments)}},handleEvents:function(){var e=this.options.target;!this.events&&e&&(!0===this.options.closeOnClick?this.events={mouseover:this._enter(!0),mouseout:this._enter(!1),click:this._enter(!1)}:this.events={mouseover:this._enter(!0),mouseout:this._enter(!1)},e.addEvents(this.events),this.elements.container.addEvents(this.events))},onShow:function(){window.document.body.addEvent("click",this.destroy)},onHide:function(){window.document.body.removeEvent("click",this.destroy);var t=this;this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(function(){t.destroy()},e.is(this.options.delay&&this.options.delay.destroy,"number")?this.options.delay.destroy:1e3)},destroy:function(){!1===this._destroyed&&(this._destroyed=!0,this.options.target.removeClassName("rich-tooltip-target"),this.innerView.destroy(),this.innerView=null,this.destroyRtAudioVideoApi&&this.destroyRtAudioVideoApi(),this._parent.apply(this,arguments))}});l.SHOW_DELAY=700,l.HIDE_DELAY=100,l.DESTROY_DELAY=1e3;return function(t){return{addIMSpecificOverrides:function(){t.implement({buildSkeleton:function(t){var i=this.innerView&&this.innerView.model;if(!i||"user"!==i.getModelName())return this._previous.apply(this,arguments);var n=i&&i.get("login"),l=o.getInstance(),c=l.get("config").tenant,d=l.get("user").login,m=this._previous(t),u=e.createElement("div",{class:"dm",html:{tag:"span",class:"fonticon fonticon-comment"},events:{click:function(){var e;e=[n,d],require(["DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/lib/model/model-manager","DS/UWPClientControls/PlatformNotify"],function(t,i,n,o){var s;Array.isArray(e)&&e.length>1&&e.length<=t.MAX_NB_USERS_IN_DM&&((s=new t).addChanges({users:e}),s.save({},{onComplete:function(e){i.goToDM(e.get("mid")),e=new t(e.toJSON()),n.notify("onCreate",e)},onFailure:function(e,s){s&&s.result&&s.result.id?(i.goToDM(s.result.id),n.notify("onCreate",new t(s.result))):o.error(r.AnErrorOccurred)}}))})}}});return n&&!i.isAnonymized()&&n!==d&&2!=i.get("ut_state")&&3!=i.get("ut_state")&&(this._rtAudioVideoApi=new s({logins:[n],tenantId:c.id,size:"15px",svgIcon:!1,onClick:function(e,t){!function(e,t,i,n){require(["DS/SwymUICore/script/feature/thread/collection/thread-lite-collection"],function(o){new o([],{mode:"conversation"}).fetch({onComplete:function(o){var s=o.find(function(e){var t=e.get("users");return 2===t.length&&t.find(function(e){return e.login===i})});!s||s&&!0===s.get("is_hidden")?require(["DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model"],function(o){var s=new o({});s.addChanges({users:[i,n]}),s.save({},{onComplete:function(i){t.startCall(e,{dmId:i.get("mid")})},onFailure:function(i,n,o){n&&n.result&&n.result.id?t.startCall(e,{dmId:n.result.id}):console.error("The conversation failed",i,n,o)}})}):t.startCall(e,{dmId:s.get("mid")})}})})}(e,t,n,d)}}),e.createElement("div",{class:"rt-options",html:[{class:"rt-icons"},u]}).inject(this.innerView.container.getElement(".rich-tooltip-top"),"after"),this._rtAudioVideoApi.renderTo({container:this.innerView.container.getElement(".rt-icons"),type:"all"})),this.innerView.addControl("conversationTooltip",new a({className:"startConversation",target:u,body:r.get("StartAConversation")})),m},destroyRtAudioVideoApi:function(){this._rtAudioVideoApi&&this._rtAudioVideoApi.destroy()}})}}}(l).addIMSpecificOverrides(),l}),define("DS/SwymUIComponents/script/feature/core/rich-tooltip/rich-tooltip-factory",["UWA/Core","UWA/Event","UWA/Class/Events","i18n!DS/SwymUICore/assets/nls/feature/core/user/model/user-model","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUIComponents/script/feature/core/rich-tooltip/rich-tooltip","DS/SwymUICore/script/feature/core/user/model/currentuser-model"],function(e,t,i,n,o,s,a,r,l){"use strict";var c=window.ds&&"3DD"===ds.env,d=window.ds&&"MOBILE"===window.ds.env?"mousedown ":"mouseover ",m=".no-community-rich-tooltip",u=".no-rich-tooltip",h=".rich-tooltip-target",p=c?o.URLPART_PEOPLE_IN_3DD:o.URLPART_PEOPLE,g=(o.URLPART_COMMUNITY,{user:d+('a[href*="'+p+'"]:not([target="_blank"]):not('+h+"):not("+u+")")}),w={user:d+('[data-login]:not([data-login^="_ANONYMISED_"]):not('+h+"):not("+u+")"),community:d+("[data-content-type=community]:not("+h+"):not("+u+"):not("+m+")")},C={user:"data-login",community:"data-content-id"},f=r.SHOW_DELAY;function y(t,i){t.stopPropagation();var o=null,c=null,d=null,p=null,g=t._uwaTarget,w={},y=h+", "+u;function v(){g.removeEvent("mouseout",A),window.document.body.removeEvent("mousedown",_)}function A(e,t){var i=e&&"mouseout"===e.type&&e.relatedTarget;if(!0!==t&&i&&i!==g&&g.contains(i))return null;clearTimeout(c),w.showTooltip=!1,v()}function _(e){return A(e,!0)}switch(i){case"community":y+=", "+m;case"user":d="login",p=C[i],(o=g.getAttribute(p))||"data-hash-key"===p||(d="hash_key",o=g.dataset.hashKey)}if(!o||g.getParent(y)||"anonymous"===g.dataset.login)return null;g.addEvent("mouseout",A),window.document.body.addEvent("mousedown",_),w.target=g,w.callback=v,c=setTimeout(function(){var t,m,u,h;"community"===i?(t=a,h={mid:o}):(t=s,(h={})[d]=o),"anonymous"===g.dataset.login?(m=new t({nickname:g.innerText,ut_state:"9"}),u=Promise.resolve()):u=new Promise(function(i,o){m=new t(h,{autoPopulate:!0,data:{as_admin:e.is(g)&&"true"===g.getAttribute("data-as-admin")||null},onPopulate:function(){i()},onFailure:function(e,t){t.errorcode&&"ERROR_USER_NOT_FOUND"===t.errorcode&&e.set("nickname",n.anonymizedUser),i()}})}),u.then(function(){var t;w.model=m,w.timeout=c,t=w,l.getInstanceFetched(function(){if(!1!==t.showTooltip&&!t.target.hasClassName("dragged")){var i=new r({target:t.target,timeout:t.timeout,viewOptions:{model:t.model}});!1!==t.showTooltip&&e.extendElement(t.target).isInjected(document.body)?i.show():i.destroy()}t.callback&&t.callback()})})},f)}function v(e){y(e,"user")}function A(e){"person"!==e.target.dataset.contentType&&y(e,"community")}function _(t,i){e.extendElement(window.document.body);var n={},o=i.view&&i.view.container||i.widget&&i.widget.body||i.domElt;if(!o)throw new Error("Invalid arguments");n[g.user]=n[w.user]=v,n[w.community]=A,!0===t?e.extendElement(o).addEvents(n):e.extendElement(o).removeEvents(n)}return i.singleton({activateTooltipDisplay:function(e){return _(!0,e)},deactivateTooltipDisplay:function(e){return _(!1,e)}}).init()}),define("DS/SwymUIComponents/script/feature/community/media/edit/upload/file-browser-upload-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/library/media-library-view","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUIComponents/script/feature/community/media/view/media-tooltip-view","DS/SwymUICore/script/feature/community/media/model/media-file-extension-model","DS/Logger/Logger"],function(e,t,i,n,o,s,a){"use strict";return i.extend({name:"file-browser-upload",_mediaFileExtension:null,defaultOptions:{multipleFileUpload:!0,thumbnailMode:!1},domEvents:{"change .file-browser-upload-input":"_filesSelected","click .fonticon-attach":"_onAttachmentIconClick","click .thumbnail-plus-wrapper":"_onAttachmentIconClick"},_onAttachmentIconClick:function(){var e=this.getElement(".file-browser-upload-input");e&&e.click()},setup:function(){this._parent.apply(this,arguments),this._mediaFileExtension=s.getInstance()},_filesSelected:function(e){var t=(e.event||e).target.files;this.dispatchEvent("onFilesSelected",t)},_createFileInput:function(){var t=this.getOption("multipleFileUpload");return e.merge(t?{multiple:"multiple"}:{},{tag:"input",class:"file-browser-upload-input",type:"file",name:"file-browser-file",styles:{display:"none"}})},_createContent:function(){var o="";!0===this.getOption("thumbnailMode")?o=[new(i.extend({name:"plus-thumbnail",_createContent:function(){return{tag:"div",class:"thumbnail-plus-wrapper",html:[this.addChildView("thumbnail",{Class:"DS/SwymUIComponents/script/feature/community/content/view/media-thumbnail-view",model:new n,events:{onRender:function(e){a.log("plus-thubnail is rendered");var t=e.container.getElement("img");t&&t.setAttribute("data-status","Reloaded")}}}),{tag:"div",class:"icon-upload-container",html:[{tag:"div",html:{tag:"span",class:"fonticon fonticon-upload-cloud fonticon-4x"}},{tag:"div",class:"upload-label",html:[{tag:"span",html:t.UploadNewMedia},e.Utils.Client.Features.touchEvents?"":{tag:"span",class:"fonticon fonticon-help"}]}]}]}}}))({}),this._createFileInput()]:o={tag:"span",class:"fonticon fonticon-attach",html:this._createFileInput()};return o},onRender:function(){this.getElement(".fonticon-help")&&this.addChildView("mediaTooltipView",new o({model:this._mediaFileExtension,target:this.getElement(".fonticon-help")})).addEvent("render",this.unmask)}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/external-rich-link-preview-model",["UWA/Core","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/abstract-rich-link-preview-model"],function(e,t){"use strict";return t.extend({defaults:{domain:"",domainToDisplay:"",type:"html"}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/media-layout-editor",["UWA/Core","UWA/Event","UWA/Utils/Client","DS/UIKIT/Popover","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/edit/media-layout-editor","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/utils/utils","DS/SwymUIComponents/script/utils/media-utils","DS/SwymUIComponents/script/feature/core/rich-tooltip/rich-tooltip","DS/Logger/Logger"],(e,t,i,n,o,s,a,r,l,c)=>{const d="media-layout-editor",m={sl:{"data-layout":"sl","data-size":"small","data-position":"left"},sc:{"data-layout":"sc","data-size":"small","data-position":"center"},lc:{"data-layout":"lc","data-size":"large","data-position":"center"},sr:{"data-layout":"sr","data-size":"small","data-position":"right"}},u=s.extend({name:`${d}-view`,domEvents:{"click .media-layout-btn":"_onLayoutChangeRequest","click .caption-btn":"_onCaptionChange","click .link-btn":"_onLinkChange","click .unlink-btn":"_onUnlink","click .fonticon-pencil":"_onPictureEditionRequest","click .thumbnail-selector-btn:not(.disabled)":"_onThumbnailSelectorClick"},defaultOptions:{image:null,imageInfos:null,editorView:null},_updateImageAttributes(e){let t={};Object.keys(m).forEach(i=>{i===e&&(t=m[i])});const i=this.options.image.getParent();i&&i.match("figure")?(delete t.styles,i.set(t)):this.options.image.set(t),this.options.image.focus(),this._placeCursorAfterImage()},_placeCursorAfterImage(){try{const{ckeditor:e}=this.options.editorView.getRTEView(),t=e.createRange(),i=e.getSelection(),n=this.options.editorView,{image:o}=this.options,s=e?new CKEDITOR.dom.node(o):o;i&&n&&(o.focus(),t.setStart(s,0),t.collapse(!0),i.removeAllRanges(),t.moveToPosition(s,CKEDITOR.POSITION_AFTER_END),i.selectRanges([t]))}catch(e){c.log(e)}},_onThumbnailSelectorClick(e){const i=this.options.editorView.getElement('img[data-content-thumbnail="true"]'),n=t.getElement(e),s=this.options.image;let a=!1;n.hasClassName("selected")?(s.removeAttribute("data-content-thumbnail"),n.removeClassName("selected"),n.title=this._getContentThumbnailSelectorNls(!1)):(i!==s&&(i&&i.removeAttribute("data-content-thumbnail"),s.setAttribute("data-content-thumbnail","true")),n.addClassName("selected"),(a=s===this.options.editorView.getElement('img:not([data-deleted-media="true"])'))&&n.addClassName("disabled"),n.title=a?o.get("DefaultThumbnail"):this._getContentThumbnailSelectorNls(!0)),this.options.editorView.dispatchEvent("onContentChange")},_onPictureEditionRequest(){this.options.editorView.mask(),require(["DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUIComponents/script/feature/community/media/edit/content-edit-media-lightbox"],(e,t)=>{const i=this.options.image.getAttribute("data-new_media");if(i){const e=this.options.editorView.getMediaCollection();if(e.length>0){const n=this.options.image.getAttribute("data-media_cid"),o=this.options.image.getAttribute("data-media-id"),s=n?e.get(n):e.get(o);new t({isNewMedia:i,model:s,viewToUpdate:this.options.editorView}).injectInDom(),this.options.editorView.unmask()}}else{new e({id:this.options.image.getAttribute("data-media-id")}).fetch({onComplete:e=>{const i=e.get("_acl");if(i.update&&i.update.access){new t({isNewMedia:!1,model:e,viewToUpdate:this.options.editorView}).injectInDom(),this.options.editorView.unmask()}else this.options.editorView.unmask(),this.alert("warn",o.YouDontHaveEditingRights)}})}})},_onLayoutChangeRequest(e){const{image:i}=this.options,n=this.getElement(".media-layout-btn.selected"),o=t.getElement(e);let s;n&&n.removeClassName("selected"),o!==n?(o.addClassName("selected"),this._updateImageAttributes(o.getAttribute("data-layout"))):this._getImageMaxWidth()>=r.CONTENT_SECTION_MAX_WIDTH?this._updateImageAttributes("lc"):(i.removeAttribute("data-size"),i.removeAttribute("data-position"),i.removeAttribute("data-layout"),(s=i.getParent())&&s.match("figure")&&(s.removeAttribute("data-size"),s.removeAttribute("data-position"),s.removeAttribute("data-layout"))),this.options.editorView&&(this.options.editorView.getRTEView().saveSnapShot(),this.options.editorView.dispatchEvent("onContentChange")),this.dispatchEvent("onMediaLayoutChange")},_onCaptionChange(){let{image:e}=this.options,t=this.options.image.getParent();const i=this.getElement(".caption-btn");let n=e.getParent().match("figure");const s=e.getParent().match("a"),a=e.getAttribute("data-layout")?e.getAttribute("data-layout"):t.getAttribute("data-layout"),r=e.getAttribute("data-position")?e.getAttribute("data-position"):t.getAttribute("data-position"),l=e.getAttribute("data-size")?e.getAttribute("data-size"):t.getAttribute("data-size");if(s&&(e=e.getParent(),t=t.getParent(),n=e.getParent().match("figure")),n?(e.setAttribute("data-layout",a),e.setAttribute("data-position",r),e.setAttribute("data-size",l),t.outerHTML=e.outerHTML):(e.removeAttribute("data-position"),e.removeAttribute("data-layout"),e.removeAttribute("data-size"),e.outerHTML=`<figure ${a?`data-layout="${a}"`:""}\n          ${r?`data-position="${r}"`:""}\n          ${l?`data-size="${l}"`:""}\n          contenteditable="false">${e.outerHTML}\n          <figcaption class="figcaption-placeholder" contenteditable="true" data-placeholder="${o.get("Caption")}"></figcaption></figure>`),i.title=n?o.get("AddACaption"):o.get("RemoveCaption"),this.options.editorView&&(this.options.editorView.getRTEView().saveSnapShot(),this.options.editorView.dispatchEvent("onContentChange")),n)this.options.image.focus(),this._placeCursorAfterImage();else{const[e]=t.getChildren();e.getChildren()[1].focus()}},_onLinkChange(){const{ckeditor:e}=this.options.editorView.getRTEView();let{image:t}=this.options;const i=t.getParent();i&&i.match("a")&&(t=i),e&&(e.customLink=t,e.execCommand("customlink"))},_onUnlink(){const{image:e}=this.options,t=e.getParent();t&&t.match("a")&&(t.outerHTML=e.outerHTML)},_getImageLayout(e){let t;const i=e||this.options.image,n=i.getAttribute("data-size"),o=i.getAttribute("data-position");if(!n&&!o&&(t=i.getParent())&&t.match("figure"))return this._getImageLayout(t);switch(n){case"small":switch(o){case"left":return"sl";case"center":return"sc";case"right":return"sr"}break;case"large":if("center"===o)return"lc"}return""},_getImageMaxWidth(){return parseInt(this.options.imageInfos.width,10)},_getContentThumbnailSelectorNls(e){let t,i=null;const{model:n}=this.options.editorView;if(n?i=n.getModelName():(t=this.options.editorView.getOption("contentEditorView"))&&(i=t.getCurrentContentType()),!0===e)return o.get("RestoreDefaultThumbnail");switch(i){case"post":return o.get("UseAsPostThumbnail");case"iquestion":return o.get("UseAsQuestionThumbnail");case"idea":return o.get("UseAsIdeaThumbnail");case"wiki":return o.get("UseAsWikiPageThumbnail");default:return o.get("UseAsContentThumbnail")}},_createContent(){let e;const{image:t}=this.options,{editorView:n}=this.options,s=this._getImageMaxWidth(),a=t.getAttribute("data-layout")||this._getImageLayout(),l=n.getElements('img:not([data-deleted-media="true"])'),c=t===l[0],d="true"===t.dataset.contentThumbnail||c&&!n.getElement('img[data-content-thumbnail="true"]'),m=t.getParent();let u,h=!1,p=!1;const g=[];let w=0;i.Platform.ios||(g[w]=[],u=g[w],(e=s>r.CONTENT_LARGE_IMAGE_MIN_WIDTH&&s<r.CONTENT_SECTION_MAX_WIDTH?["sl","sc","lc","sr"]:["sl","sc","sr"]).forEach(e=>{let t,i;switch(e){case"sl":t="Left",i="picture-wrapping-left";break;case"sc":t="SmallAndCentered",i="picture-inline-small";break;case"lc":t="Centered",i="picture-inline-large";break;case"sr":t="Right",i="picture-wrapping-right";break;default:throw new Error("This layout is not supported!")}u.push({class:`media-action-btn media-layout-btn ${"mle-btn-"+e} fonticon fonticon-2x fonticon-${i}${a===e?" selected":""}`,"data-layout":e,title:o.get(t)})},this)),m&&(h=(p=m.match("a"))?m.getParent().match("figure"):m.match("figure")),g[w+=1]=[],(u=g[w]).push({class:"media-action-btn fonticon fonticon-2x fonticon-feather fonticon-text-caption caption-btn",title:h?o.get("RemoveCaption"):o.get("AddACaption")}),u.push({class:"media-action-btn fonticon fonticon-2x fonticon-link link-btn",title:o.get("InsertALink")}),u.push({class:`media-action-btn fonticon fonticon-2x fonticon-link-off unlink-btn${p?"":" disabled"}`,title:o.get("Unlink")}),"picture"===t.getAttribute("data-media-type")&&(g[w]||(g[w]=[]),(u=g[w]).push({class:"media-action-btn fonticon fonticon-2x fonticon-pencil",title:o.get("Edit")})),l.length>1&&(g[w+=1]=[],(u=g[w]).push({class:`media-action-btn thumbnail-selector-btn${d?` selected${c?" disabled":""}`:""}`,html:{tag:"span",class:"fonticon fonticon-2x fonticon-picture-favorite"},title:d&&c?o.get("DefaultThumbnail"):this._getContentThumbnailSelectorNls(d)}));const C=g.reduce((e,t)=>(e.push({class:"btn-group-divider"}),e.concat(t)),[]);return C.shift(),C}}),h=n.extend(l,{_targetPresenceCheckInterval:null,defaultOptions:{className:`flex-display ${d}`,position:"top",closeOnClick:!1,delay:{show:300,hide:150,destroy:0},viewOptions:null,timeout:null},_hideThenShowAgainAfterUpdate(){this.getContent()&&(this.hide(),setTimeout(()=>{!0!==this._destroyed&&(this.show(),this.updatePosition())},0))},init(e,...t){const i=e;if(!i.viewOptions)throw new Error("Missing arguments");i.timeout&&(this.timeout=i.timeout),i.target.mediaLayoutEditorTarget=!0,i.viewOptions.image=i.target,i.target.addEvent("dragstart",()=>{this.destroy()}),this.innerView=new u(i.viewOptions),i.body=this.innerView,this.innerView.addEvent("onMediaLayoutChange",this._hideThenShowAgainAfterUpdate,this),this._parent(i,...t)},buildSkeleton(...e){return this._parent(...e)},handleEvents(...e){const t=this.options&&this.options.target,i=this._previous(...e);return t&&t.addEvent("dragstart",()=>{t.removeClassName("highlighted")}),i},onShow(){const e=this.options&&this.options.viewOptions&&this.options.viewOptions.image;e&&(this._targetPresenceCheckInterval||(this._targetPresenceCheckInterval=setInterval(()=>{!0===this._destroyed?clearInterval(this._targetPresenceCheckInterval):document.body.contains(e)||this.destroy()},100)),e.addClassName("highlighted"))},onHide(...e){const t=this.options&&this.options.viewOptions&&this.options.viewOptions.image;return t&&t.removeClassName("highlighted"),this._previous(...e)},destroy(...e){return!1===this._destroyed&&(clearInterval(this._targetPresenceCheckInterval),this.options.target.mediaLayoutEditorTarget=void 0,this.options.target.removeEvent("resize",this._onTargetResize),this.options.target.removeEvent("dragstart",this.destroy)),this._previous(...e)}});return h.SHOW_DELAY=300,h.HIDE_DELAY=150,h.DESTROY_DELAY=0,h.TARGET_FLAG_PROPERTY="mediaLayoutEditorTarget",h.NAME=d,h.BTN_EFFECTS=m,h}),define("DS/SwymUIComponents/script/feature/community/content/edit/media-layout-editor-factory",["UWA/Core","UWA/Array","UWA/Event","UWA/Class/Events","UWA/Class/Listener","DS/SwymUIComponents/script/feature/community/content/edit/media-layout-editor"],(e,t,i,n,o,s)=>{const a=s.TARGET_FLAG_PROPERTY,r=`.no-${s.NAME}`,l=["click","touchstart"].map(e=>`${e} img:not(${r})`),c=s.SHOW_DELAY,d=(n,o,l)=>{let d,m,u;n.stopPropagation();let h=null,p=null;const{target:g}=n,w={};let C;function f(){e.extendElement(window.document).removeEvent("click",C)}if(C=(()=>{clearTimeout(p),w.showEditor=!1,f()}),g===i.getElement(n)&&!g[a]){if(m=g.dataset.mediaId,u=o&&o.get("thumbnails_infos")){if(h=t.detect(u,e=>e.media_id===m),"true"===g.dataset.deletedMedia)return;d=!0,h&&(h=e.clone(h,!1))}else d=!0;!0!==d&&"picture"===g.dataset.mediaType||(h=e.merge(h||{},{width:g.style.width||g.width,height:g.style.height||g.height})),parseInt(h.width,10)>=0&&!g.getParent(r)&&(g.addEvent("mouseout",C),e.extendElement(window.document).addEvent("click",C),w.target=g,w.callback=f,w.imageInfos=h,w.editorView=l,p=setTimeout(()=>{w.timeout=p,(e=>{if(!1!==e.showEditor){const t=new s({target:e.target,timeout:e.timeout,viewOptions:{model:e.model,imageInfos:e.imageInfos,editorView:e.editorView}});!1!==e.showEditor?t.show():t.destroy()}e.callback&&e.callback(),e.editorView.dispatchEvent("mediaLayoutHasBeenCreate")})(w)},c))}};return o.singleton(n,{_handleEditorDisplay(t,i){const{domElt:n}=i;if(!n||!i.getContent)throw new Error("Invalid arguments");!0===t?l.forEach(t=>{this.listenTo(e.extendElement(n),t,e=>{d.call(this,e,i.getContent.call(this),i.editorView)})}):l.forEach(t=>{this.stopListening(e.extendElement(n),t)}),i.editorView.dispatchEvent("mediaLayoutIsReady")},activateEditorDisplay(e){return this._handleEditorDisplay(!0,e)},deactivateEditorDisplay(e){return this._handleEditorDisplay(!1,e)}}).init()}),define("DS/SwymUIComponents/script/feature/community/survey/view/answer-view",["UWA/Core","UWA/String","i18n!DS/SwymUIComponents/assets/nls/feature/community/survey/view/answer-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/community/survey/view/scale-answer-view","DS/UIKIT/Input/Text","DS/UIKIT/Input/Toggle"],function(e,t,i,n,o,s,a){return n.extend({_modelEventsForAutoRefresh:["onChange"],domEvents:{"change .survey-is-open":"onTextfieldChange","change .answer-radio":"onRadioChange"},_createContent:function(){var n=this.model;if(n){this._controls["answer-checkbox"]||this.addControl("answer-checkbox",new a({type:"checkbox",label:n.get("description")||"",className:"answer-checkbox",attributes:{checked:!0===n.get("selected"),name:"checkbox_answer_"+n.get("mid"),id:"answer_"+n.get("mid")}}));var r=this._parentView.collection.getAssociated("question").get("type"),l=t.unescapeHTML(n.get("custom_text")||"");return e.createElement("div",{html:[{tag:"div",styles:{"margin-bottom":"10px","padding-bottom":"10px"},html:["Multiple"==r?this._controls["answer-checkbox"]:"","Single"==r?this.addControl("openRadio",new a({className:"answer-radio",checked:!0===n.get("selected"),label:n.get("description")||"",attributes:{name:"radio_answer_"+n.get("questionId"),id:"answer_"+n.get("mid")}})):"","Scale"==r?{html:new o({model:n,questionModel:this._parentView.collection.getAssociated("question")})}:"",1===parseInt(n.get("is_open"),10)?"Open"===r?this.addControl("openText",new s({multiline:!0,className:"multiline survey-is-open",allowBlank:!1,value:l||""})):['<label class="cursor-pointer" for="answer_'+n.get("mid")+'">'+i.Other+"</label>",this.addControl("openText",new s({className:"survey-is-open",allowBlank:!1,value:l||"",disabled:!0!==n.get("selected")}))]:""]}]})}},onTextfieldChange:function(e){this.model.set("custom_text",t.escapeHTML(e.target.value))},onRadioChange:function(e){this._parentView.collection.forEach(function(e,t){e.set("selected",!1)}),this.model.set("selected",!0)}})}),define("DS/SwymUIComponents/script/feature/core/network/view/network-list-view",["UWA/Core","DS/SwymUIComponents/script/feature/core/ui-components/list/item-list","DS/SwymUIComponents/script/feature/core/user/view/user-network-tile-view","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/member-set-connections-view","DS/UWPClientCode/I18n"],function(e,t,i,n,o){"use strict";return t.extend({name:"community-members-view",modelViewsCfg:function(t){var i=this._parent.apply(this,arguments);return e.merge({modelUser:this._modelUser},i)},modelViewClass:i,setup:function(e){e.useDynamicGrid=!0,e.modelUser&&(this._modelUser=e.modelUser),this._parent.apply(this,arguments)},_createContent:function(){var t="",i=this.collection;if(i&&0===i.length){var s=!1,a="1"==this._modelUser.get("user_in_network");this._modelUser.isCurrentUser()||"new"!==this._modelUser.get("connected_user_to_user")||(s=!0);var r=[{class:"network-default-message",html:this._modelUser.isCurrentUser()?n.currentUserNoContact:s?o.replace(n.getBackToYouSoon,{firstName:this._modelUser.get("first_name")}):a?o.replace(n.useralreadyinyournetwork,{firstName:this._modelUser.get("first_name")}):o.replace(n.otherUserNoContact,{firstName:this._modelUser.get("first_name")})},{html:'<span class="fonticon fonticon-'+(this._modelUser.isCurrentUser()?"user-add":s?"users":a?"users":"user-add")+' fonticon-nocontent"></span>'}],l=s?"":" cursor-pointer";t=e.createElement("div",{class:"network-view no-connection-engaging"+l,styles:{"text-align":"center",height:"100%",width:"100%"},html:r})}else t=this._parent.apply(this,arguments);return t}})}),define("DS/SwymUIComponents/script/feature/core/user/view/macro/user-connections-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/macro/user-connections-view","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/core/network/collection/request-collection","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/SwymUIComponents/script/feature/core/network/view/request-received-view","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUIComponents/script/feature/core/pagination/view/paging-toolbar-view","DS/SwymUICore/script/feature/core/network/model/network-model","DS/SwymUIComponents/script/feature/core/user/view/small-user-tile-view","DS/PubSub/PubSub","DS/WebappsUtils/Console","DS/SwymUIComponents/script/feature/core/network/view/multi-invitation-layer-view","DS/SwymUICore/script/feature/core/sprite/sprite","DS/UIKIT/Accordion","DS/SwymUICore/script/utils/i18n","DS/SwymUICore/script/feature/community/community/collection/community-collection","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/macro/user-app-view","DS/SwymUIComponents/script/feature/core/network/view/invitation-layer-view","DS/UIKIT/Spinner","DS/UIKIT/Tooltip","DS/SwymUICore/script/feature/community/community/model/community-model","DS/W3DXComponents/Views/Item/TileView","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/utils/date","DS/SwymUIComponents/script/feature/core/network/view/network-list-view","UWA/Class/Model","DS/SwymUICore/script/utils/navigation","DS/WebappsUtils/WebappsUtils"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w,C,f,y,v,A,_,S,b,I,D,T,E,U,k,x){"use strict";var M=n.extend({_modelClass:b,name:"community-tile-view",_createContent:function(){var t=this.model,i=new U({title:function(){return'<a href="'+t.getRelativePath()+'">'+t.get("title")+"</a>"},imgAttrs:function(){return w.getMediaThumbnailAttributes({id:t.get("mid"),communityLogo:!0,imageUpdateTime:t.get("settings_update")||t.get("update"),cls:"dsi-communities-home-list-picture",modelId:t.get("mid"),modelName:"community"})},image:function(){return s.constructThumbnailUrl(t.getModelName(),t.get("mid"),"m_thumb")},subtitle:T.prettyDate(t.get("update")),content:t.get("description")}),n=new I({model:i,events:{onClick:function(){k.goToCommunity(this.model.get("mid"))}.bind(this)}});return e.createElement("div",{html:n.render()})}});return n.extend({_modelClass:o,name:"userconnections-view",domEvents:{"click #connectionsMemberSetView .icon-section .fonticon-user-add":"_addInviteMultiLayer","click .network-view.cursor-pointer":"_onEmptyNetworkClick","click .fonticon-info-circled":"_onInfoSharedCommunitiesClick"},_onInfoSharedCommunitiesClick:function(){var e=this.getControl("tooltip-shared-communities");e&&e.show()},_onEmptyNetworkClick:function(){if(this.model.isCurrentUser())this._addInviteMultiLayer();else if("new"!==this.model.get("connected_user_to_user")){var e=new A({model:this.model}),t=function(){this._invitationAlreadySent=!0}.bind(this);!0!==this._invitationAlreadySent?e.launch(t):this.alert("info",v.alreadySentInvitation)}},_addInviteMultiLayer:function(){var e,t=this.getChildView("multi-layer-invite"),i=this.getElement(".no-connection-engaging");t?t.show():(t=this.addChildView("multi-layer-invite",new g),(e=this.getElement(".multi-layer-invit-target"))&&t.render(e)),i&&i.hide()},_createContent:function(){var t=this.model;if(t)return t.isCurrentUser()&&this._preparePeopleYouMightKnow(),this._prepareNetwork(),h.add("refreshPendingInvitations",function(){this._prepareReceivedRequests()}.bind(this)),h.add("refreshNetwork",function(e,t){if(this.model&&(e.getRelativePath=this.model.getRelativePath),this._users){!0===t?this._users.add(e):!1===t&&this._users.remove(e);var i=this.getElement(".profile-element-title"),n=this._getNetworkTitle();i&&n&&i.setText(n)}}.bind(this),null,!0),e.createElement("div",{html:[t.isCurrentUser()?{class:"col-sm-4 col-md-3 second-column",html:[{id:"connectionsReceivedRequest"},{id:"peopleyoumightknow"}]}:{class:"col-sm-4 col-md-3 second-column",html:[{class:"sharedContactsContainer"},{class:"sharedCommunitiesContainer"}]},{class:"col-sm-8 col-md-9",id:"connectionsMemberSetView"}]})},_prepareSharedContacts:function(){var e=new r([],{mode:"getmysharedcontacts",limit:1}),i=c.extend({modelViewClass:u});e.fetch({data:{hash_key:this.model.get("hash_key")},onComplete:function(e){var n=this.getElement(".sharedContactsContainer"),o=e.length;if(o>0&&n){var s=new i({collection:e});new C({className:"filled profile-background",items:[{title:1===o?t.OnePersonInCommon:f.replace(t.ManyPersonsInCommon,{number:e.length}),content:[s.render()],selected:!0}],events:{onClose:function(e){e.content.style.marginTop="-"+e.content.offsetHeight+"px"}}}).inject(n)}}.bind(this)})},_prepareSharedCommunities:function(){var i=new y([],{mode:"my-communities-people",limit:5,hash_key:this.model.get("hash_key")}),n=c.extend({modelViewClass:M});i.addEventOnce("onAfterPageChange",function(i){var o=this.getElement(".sharedCommunitiesContainer"),s=i.length;if(s>0){if(o){var a=new n({collection:i}),r=new d({widget:this._widget,collection:i}),l=e.createElement("div",{styles:{clear:"both"}});o.grab(l),r.render(o),new C({className:"filled profile-background",items:[{title:1===s?t.OneSharedCommunity:f.replace(t.ManySharedCommunities,{number:i.getTotalItems()}),content:[a.render(),l,r.render()],selected:!0}],events:{onClose:function(e){e.content.style.marginTop="-"+e.content.offsetHeight+"px"}}}).inject(o);var c=o.getElement(".accordion-title"),m=e.createElement("span",{class:"fonticon cursor-pointer fonticon-info-circled"});c&&(m.inject(c),this.addControl("tooltip-shared-communities",new S({target:m,body:t.privateandsecretonly})))}}else o&&(o.hide(),this._checkIfEmpyLeftColumn())}.bind(this)),i.goToPage(1)},_preparePeopleYouMightKnow:function(){var n=new r([],{mode:"getpeoplefamiliartocurrentuser",limit:6}),o=c.extend({modelViewClass:u}),s=i.extend({_createContent:function(){return e.createElement("div",{styles:{"margin-top":"15px","text-align":"center"},html:t.nosuggestion})}});n.addEvent("noMoreRecommendation",function(){var e=this.getElement("#peopleyoumightknow");e&&(new s).render(e)}.bind(this)),n.fetch({onComplete:function(e){var i,n=this.getElement("#peopleyoumightknow");n&&((i=e.length>0?new o({collection:e,modelViewsCfg:{addConnection:!0}}):new s).addEvent("onRender",function(){}),new C({className:"filled profile-background",items:[{title:t.peopleyoumayknow,content:[i.render()],selected:!0}],events:{onClose:function(e){e.content.style.marginTop="-"+e.content.offsetHeight+"px"}}}).inject(n))}.bind(this)})},_collectionReceivedRequestView:c.extend({name:"user-sentrequests-collection-view",modelViewClass:l}),_prepareReceivedRequests:function(){new a([],{mode:"receivedRequests",limit:5,Hashkey:this.model.get("hash_key")}).fetch({onComplete:function(e){e.setAssociated("groups",this._groups),e.setAssociated("users",this._users);var i=new this._collectionReceivedRequestView(e),n=this.getElement("#connectionsReceivedRequest"),o=e.length;0!==o?n&&(i.addEvent("onRender",function(){}),new C({className:"filled profile-background",items:[{title:1===o?t.OnePendingInvitation:f.replace(t.ManyPendingInvitations,{number:e.length}),content:[i.render()],selected:!0}],events:{onClose:function(e){e.content.style.marginTop="-"+e.content.offsetHeight+"px"}}}).inject(n.empty())):(n=this.getElement("#connectionsReceivedRequest"))&&(n.hide(),this._checkIfEmpyLeftColumn())}.bind(this)})},_prepareNetwork:function(){2!=this.model.get("ut_state")&&3!=this.model.get("ut_state")&&new m({id:this.model.get("hash_key"),hash_key:this.model.get("hash_key")}).fetch({onComplete:function(e){this._drawNetwork(e)}.bind(this)})},_checkIfEmpyLeftColumn:function(){var e=this.getElement(".sharedContactsContainer"),t=this.getElement(".sharedCommunitiesContainer");if(e&&t&&"none"===e.getStyle("display")&&"none"===t.getStyle("display")){e.parentElement.hide();var i=this.getElement("#connectionsMemberSetView");i&&(i.className="col-md-12")}},_getNetworkTitle:function(){var e="",i=this._users.length;return 1===i?e=f.replace(t.contact,{number:i}):0===i?!0===this.model.isCurrentUser()&&(e=t.addAContact):e=f.replace(t.contacts,{number:i}),e},_drawNetwork:function(t){this._users=t.getAssociated("users"),this._groups=t.getAssociated("groups");var i=this.getElement("#connectionsMemberSetView");i&&(this.addChildView("network-view",new E({modelUser:this.model,widget:this._widget,collection:this._users})).render(i),e.createElement("div",{styles:{overflow:"auto"},html:[{class:"profile-element-title pull-left",html:this._getNetworkTitle()},!0===this.model.isCurrentUser()?{class:"icon-section",html:' <span class="fonticon fonticon-2x cursor-pointer fonticon-user-add"></span>'}:{},{class:"multi-layer-invit-target col-lg-6 col-lg-offset-3 col-md-offset-2 col-md-8"}]}).inject(i,"top"));this.model.isCurrentUser()?this._prepareReceivedRequests():(this._users.length>0?this._prepareSharedContacts():(i=this.getElement(".sharedContactsContainer"))&&i.hide(),this._prepareSharedCommunities())}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/extra-text-editor",["UWA/Core","DS/UIKIT/Popover","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUIComponents/script/feature/core/rich-tooltip/rich-tooltip","DS/UIKIT/Tooltip","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/edit/extra-text-editor"],(e,t,i,n,o,s)=>{const a="extra-text-editor",r=i.extend({name:`${a}-view`,domEvents:{},defaultOptions:{extraEditor:null,editorView:null},_createContent(){const t=e.createElement("div",{class:"extra-text-editor-btn fonticon fonticon-attach attachment"});return this.addControl("attachmentIconTooltip",new o({target:t,body:s.AddMedia})),[t]},_openMediaLibrary(){}});return t.extend({defaultOptions:{className:`flex-display ${a}`,position:"top-right",delay:{show:100,hide:300},offset:{y:0},editionTarget:null,editorView:null,viewOptions:null},init(e,...t){const i=e;this.updatePosition=this.updatePosition.bind(this);const n=()=>this.dispatchEvent("onApplyStyle");this.innerView=new r({extraEditor:this,events:{onApplyStyle:()=>{n()}}}),i.body=this.innerView,this._parent(e,...t)},handleEvents(){const{target:e}=this.options;!this.events&&e&&(this.events={click:n.prototype._enter.call(this,!0),resize:this.updatePosition},e.addEvents(this.events),this.elements.container.addEvents(this.events))},updatePosition(){const t=window.getSelection();if(0===t.rangeCount)return this;const i=t.getRangeAt(0),n=!(!e.is(i.startContainer)||!e.is(i.startContainer.parentElement)||i.startContainer.parentElement.className===this.innerView.className||0!==i.startOffset||0!==i.endOffset||"p"!==i.startContainer.localName),o=this.options&&this.options.editionTarget&&document.documentElement.contains(this.options.editionTarget);if(this.isVisible&&(o||n)){let t;const{options:i}=this,{offset:n}=i,{editionTarget:o}=i,{editorView:s}=this.options;let a,r;s&&!s.isDestroyed()&&(t=o.getPosition(s.container),a=parseInt(o.getStyle("marginTop"),10),r=parseInt(o.getStyle("paddingTop"),10),e.is(r)||(r=9),e.is(a)||(a=0),this.elements.container.setStyles({top:Math.max(10,Math.round(t.y+n.y+a+r-2))}))}return this},show(){const{editorView:e}=this.options;if(e&&!e.isDestroyed()){const{elements:t}=this;return t?(this.isVisible||(this.isVisible=!0,this.inject(e.container),this.updatePosition(),this.elements.container.addClassName("in"),this.options.animate?setTimeout(()=>{this.elements&&this.isVisible&&this.dispatchEvent("onShow")},150):this.dispatchEvent("onShow")),this):this}return this},setEditionTarget(e){e!==this.getOption("editionTarget")&&(this.setOptions({editionTarget:e}),this.innerView.refresh(),this.updatePosition())},getEditionTarget(){return this.getOption("editionTarget")},destroy(...e){!1===this._destroyed&&(this._destroyed=!0,this.innerView.destroy(),this.innerView=null,this._parent(...e))}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/extra-text-editor-factory",["UWA/Core","UWA/Event","UWA/Class/Events","UWA/Class/Listener","DS/Logger/Logger","DS/SwymUICore/script/utils/utils","DS/SwymUIComponents/script/feature/community/content/edit/extra-text-editor"],function(e,t,i,n,o,s,a){"use strict";var r="blockquote,h1,h2,i,ul,ol,p,table,pre,tr,div",l=["keydown .editable-container","paste .editable-container"].concat(["click","touchend"].map(function(e){return e+" "+r}));function c(e,t,i,n){var o;if(!t||!i)throw new Error("Missing arguments");(o=t.getControl(n))?o.getEditionTarget()!==e?o.setEditionTarget(e):o.innerView:o=t.addControl(n,new a({target:i,editionTarget:e,editorView:t,events:{onApplyStyle:function(){u(t,i,n)}}})),o.show()}var d=function(t,i,n){var o=null,s=t.parentElement;return s&&(e.extendElement(s),s.match(i)?o=s:(o=s.getParent(i),n.contains(o)||(o=null))),o},m=s.getDelayedSyncTask(function(t,i,n,o){var s=null,a=e.extendElement(t).getElement(r);if(a)for(;a;)s=a,a=a.getElement(r);else s=t.match(r)?t:d(t,r,n);if(s)return c(s,i,n,o)},100),u=s.getDelayedSyncTask(function(t,i,n){var o=window.getSelection().getRangeAt(0),s=o&&o.startContainer;s&&(s.nodeType===s.TEXT_NODE&&(s=d(s,r,i)),s&&s.nodeType===Node.ELEMENT_NODE&&(e.extendElement(s),m.call(this,s,t,i,n)))},200);return n.singleton(i,{_handleEditorDisplay:function(i,n){var o,s,a=n.domElt,d=!0;if(!a||!n.editorView||!n.extraTextEditorId)throw new Error("Invalid arguments");e.extendElement(a),!0===i?(s=function(){d=!1,u.call(this,n.editorView,a,n.extraTextEditorId)},o=function(e){var i=e.target;if(e.target.hasClassName("editable-container")||e.target.hasClassName("scroller-content")){var o,r,l=e.target.getBoundingClientRect();for(o=e.x;o<l.left+l.width;o+=40)if((r=document.elementFromPoint(o,e.y))!==e.target){i=r;break}}if(("touchend"!==e.type||e.cancelable)&&n.editorView.dispatchEvent("onSelectionChange",[i]),"keydown"===e.type)switch(t.whichKey(e)){case"return":case"ctrl+v":case"up":case"down":case"left":case"right":s()}else"paste"===e.type?s():(d=!1,m.call(this,i,n.editorView,a,n.extraTextEditorId))},l.forEach(function(e){this.listenTo(a,e,o)},this),n.editorView.addEvents({onEnterKeyPressed:s,onBackspaceKeyPressed:s}),n.editorView.executeWhenRTEIsReady(function(){if(!0===d){d=!1;var e=a.getElement(r);e&&c.call(this,e,n.editorView,a,n.extraTextEditorId)}})):l.forEach(function(e){this.stopListening(a,e)},this)},activateEditorDisplay:function(e){return this._handleEditorDisplay(!0,e)},deactivateEditorDisplay:function(e){return this._handleEditorDisplay(!1,e)}}).init()}),define("DS/SwymUIComponents/script/feature/community/survey/survey-view",["UWA/Core","DS/SwymUICore/script/feature/community/survey/model/survey-model","DS/SwymUIComponents/script/feature/core/ui-components/list/list-item/item-view"],function(e,t,i){"use strict";return i.extend({_modelClass:t,name:"survey-view",defaultOptions:{summaryViewClass:"DS/SwymUIComponents/script/feature/community/survey/view/survey-summary-view",detailedViewClass:"DS/SwymUIComponents/script/feature/community/survey/view/survey-detailed-view",editViewClass:"DS/SwymUIComponents/script/feature/community/survey/edit/survey-edit-view"},_createEditView:function(){var e=this.model,t=null;return e&&(e.fetch({fromCache:!0}),t=this.addChildView("editView",{Class:this.getOption("editViewClass"),model:e,mode:"surveyCreator"})),t}})}),define("DS/SwymUIComponents/script/feature/community/idea/view/idea-transfer-view",["DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUIComponents/script/feature/community/idea/view/idea-transferred-link-view","DS/SwymUIComponents/script/feature/community/idea/view/idea-transfer-form-modal","i18n!DS/SwymUIComponents/assets/nls/feature/community/idea/view/idea-transfer-view"],function(e,t,i,n,o){"use strict";return e.extend({name:"idea-transfer-view",_transferFormViewDisplayed:null,_transferredLinkViewDisplayed:null,_ideaTransferredLinkView:null,_ideaTransferFormView:null,_isTransferredCallDone:null,_isIdeaTransferredToEnovia:null,domEvents:{"click .transfer-link-wrapper:not(.disabled) .transfer-link":"onTransferLinkClick"},_modelEvents:{TransferChange:"_onIdeaTransfer"},_createContent:function(){var e=this.model.getCommunity().getUserRole()>=3;if(this._isTransferredCallDone)return this._isIdeaTransferredToEnovia&&(this._ideaTransferredLinkView&&this._ideaTransferredLinkView.destroy(),this._ideaTransferredLinkView=this.addChildView("IdeaTransferredLinkView",new i({model:this.model,widget:this._widget}))),[{class:"wrapper",html:[{tag:"span",html:o.TransferThisIdea+"<span>|</span>"},e?{class:"transfer-link-wrapper link"+(this._isIdeaTransferredToEnovia?" disabled":""),html:[{class:"fonticon fonticon-right"},{class:"transfer-link",html:o.Transfer}]}:{}]},this._isIdeaTransferredToEnovia?this._ideaTransferredLinkView:{}]},setup:function(){var e=this;this._parent.apply(this,arguments),this._isTransferredCallDone=!1,this.model.isTransferredToEnovia().then(function(t){e._isTransferredCallDone=!0,e._isIdeaTransferredToEnovia=t,e.refresh()}),new t({mid:this.model.getCommunity().get("mid")},{autoPopulate:!0,onPopulate:function(){e.isRendered()&&e.refresh()}})},_onIdeaTransfer(e){this._isIdeaTransferredToEnovia=e,this.refresh()},onTransferLinkClick:function(){var e=this;this.model.isMature().then(function(t){t?e.showTransferModal():e.alert("warn",o.IdeaMustBeMature)})},showTransferModal:function(){new n({model:this.model,widget:this._widget}).show()}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/internal-rich-link-preview-model",["UWA/Core","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/abstract-rich-link-preview-model"],function(e,t){"use strict";return t.extend({defaults:{communityName:"",communityID:"",tenantURL:"",authorName:"",authorID:"",answerValidated:"",mediaType:""}})}),define("DS/SwymUIComponents/script/feature/container/content/cockpit/cockpit-view",["UWA/Core","DS/My3DExpUICore/script/feature/cockpit/cockpit-model","DS/SwymUIComponents/script/feature/core/ui-components/list/list-item/item-view"],function(e,t,i){"use strict";return i.extend({_modelClass:t,name:"cockpit-view",defaultOptions:{summaryViewClass:"DS/My3DExpUIComponents/script/feature/container/content/cockpit/cockpit-summary-view",showAuthorSection:!1}})}),define("DS/SwymUIComponents/script/feature/core/tenant/view/community-users-management-home-view",["UWA/Core","DS/SwymUICore/script/feature/core/user/model/currentuser-model","i18n!DS/SwymUIComponents/assets/nls/feature/core/tenant/view/community-users-management-home-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/community/collection/community-collection","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUIComponents/script/utils/content-upload-error","DS/UIKIT/Form","DS/UIKIT/Input/Button","DS/SwymUIComponents/script/feature/core/modal/modal","DS/SwymUIComponents/script/feature/core/modal/super-modal","DS/SwymUICore/script/utils/utils","DS/WAFData/WAFData"],function(e,t,i,n,o,s,a,r,l,c,d,m,u){"use strict";return n.extend({name:"community-users-management-home-view",model:null,_el:null,_currentUser:null,_addUsersToCommunitiesModal:null,_removeUsersFromCommunitiesModal:null,_exportListOfCommunityUsersModal:null,_selectedFile:null,_confirmModal:null,_communityCollection:null,_communitySelectOptions:null,_currentModal:null,_asAdmin:!1,domEvents:{"click .add-users-to-communities":"onAddUsersToCommunities","click .remove-users-from-communities":"onRemoveUsersFromCommunities","click .export-list-of-community-users":"onExportListOfCommunityUsers"},_filesSelected:function(e){var t=e.target.files;if(t.length){for(var i=-1,n=t.length;++i<n;){var o=t[i];void 0===o.fileName&&(o.fileName=o.name),this.view._selectedFile={browserFileData:o}}this.view.getControl(this.mode+"-csv-file-input").elements.text.removeClassName("field-error")}},_resetForm:function(e,t){e.getControl(t+"-form").reset(),e.getControl(t+"-form").unvalidate(),"export"!==t&&(e.getControl(t+"-csv-file-input").setValue(""),e.getControl(t+"-csv-file-input").elements.text.removeClassName("field-error"),e._selectedFile=null),e._currentModal.hide()},_createContent:function(){return this._controls["add-users-to-communities"]||(s.getInstance().isFeatureActivated("activate_import_community_users")&&this.addControl("add-users-to-communities",new l({className:"default add-users-to-communities",value:this.model?i.adduserstothiscommunity:i.adduserstocommunities})),this.addControl("remove-users-from-communities",new l({className:"default remove-users-from-communities",value:this.model?i.removeusersfromthiscommunity:i.removeusersfromcommunities})),s.getInstance().isFeatureActivated("activate_export_community_users")&&this.addControl("export-list-of-community-users",new l({className:"default export-list-of-community-users",value:i.exportListOfCommunityUsers}))),e.createElement("div",{styles:{padding:"0 10px 10px 10px","min-height":"48px"},html:[this._controls["remove-users-from-communities"],s.getInstance().isFeatureActivated("activate_import_community_users")?this._controls["add-users-to-communities"]:"",s.getInstance().isFeatureActivated("activate_export_community_users")?this._controls["export-list-of-community-users"]:""]})},onRender:function(){this.model||this.mask()},_createModal:function(t,n){var o=this,s=[];!0!==n.hideName&&s.push({type:"text",name:"name-input",pattern:"(?:\\s*[^\\s]+\\s*)+",label:i.name,required:!0}),o.model||s.push({type:"select",name:"communities-select",className:"communities-select",label:i.Selectacommunity,required:!0,multiple:!0!==n.hideFile,options:this._communitySelectOptions}),!0!==n.hideRole&&(s.push({type:"select",name:"role-select",label:i.selectrole,required:!0,options:"export"===t?[{value:0,label:i.all,selected:!0},{value:1,label:i.contributor},{value:2,label:i.author},{value:3,label:i.owner}]:[{value:1,label:i.contributor,selected:!0},{value:2,label:i.author},{value:3,label:i.owner}]}),"add"===t&&s.push({type:"html",html:'<div style="font-style: italic;">'+(o.model?i.rolechangeinfosingle:i.rolechangeinfo)+"</div>"})),!0!==n.hideFormat&&s.push({type:"select",name:"format-select",label:i.Format,required:!0,options:[{value:"csv",label:"CSV"},{value:"xls",label:"MS Excel (.xls)"}]});var d=new r({fields:s}),u=this.addControl(t+"Modal",new c({closable:!0,header:"<h4>"+n.title+"</h4>",className:t+"-users-modal",body:[!0===n.hideWarning?"":{html:'<div style="margin-bottom:10px;">'+i.oncesubmittedthisformwillbesenttotheservertobeprocessed+"<br/>"+i.detailsandresultsofthisprocesscanbeviewedonthepage+"</div>"},this.addControl(t+"-form",d),!0===n.hideFile?"":e.createElement("div",{class:"upload-csv-file-container",html:[this.addControl(t+"-csv-file-input",new e.Controls.Input.File({className:"csv-file-input",type:"file",placeholder:i.selectcsv,events:{onChange:this._filesSelected.bind({view:this,mode:t})}})),new l({className:"see-example-button default",value:i.seeExample,events:{onClick:function(){window.open(m.getBaseUrl()+"/api/community/getimportmembercsvsample/import-community-members-sample.csv")}}})]}),!0===n.hideFile?"":{styles:{"margin-top":"10px","font-style":"italic"},html:"add"===t?i.formatofthecontentsofthecsvfile+"<br/>"+i.formatofthecontentsofthecsvfileSecondLine:i.formatofthecontentsofthecsvfile+"<br/>"+i.thecsvfileshouldcontaininthefollowingorder+": <br/> <b>"+i.login+", "+i.email+"</b> <br/> "+i.thecsvfilecancontainafirstlinewithcolumntitlesbutonlyinEnglish}],footer:[new l({className:"primary",value:i.submit,events:{onClick:function(){var e=this.view;if("export"!==this.mode)e.getControl(this.mode+"-form").validate()&&this.view._selectedFile?e._confirmModal.confirm(i.oncelaunchedprocesscannotbecanceleddoyouwishtocontinue,i.confirm,function(n){if(!0===n){var o=new FormData,s=function(e,n){var o;"add"===this.mode?this.view._addUsersToCommunitiesModal.hide():this.view._removeUsersFromCommunitiesModal.hide(),e.currentTarget&&(e=e.currentTarget.responseText),(o="object"==typeof e&&"object"==typeof n?JSON.parse(JSON.stringify(n)):JSON.parse(e)).errorcode?a.printErrorMessage(o,"csv"):(this.view.alert("success",i.processaddedmsg),this.view.getControl(this.mode+"-form").reset(),this.view.getControl(t+"-csv-file-input").setValue(null)),this.view._currentUser.dispatchEvent("refreshUserManagementProcesses")}.bind(this);o.append("processName",this.view.getControl(this.mode+"-form").getValue("name-input")),o.append("communityId",e.model.get("mid")),o.append("operationType",this.mode),o.append("userType",4),o.append("as_admin",e._asAdmin),"add"===this.mode&&o.append("roleId",this.view.getControl(this.mode+"-form").getValue("role-select")),o.append("file-path",this.view._selectedFile?this.view._selectedFile.browserFileData:""),e.model.createImportBatch({data:{fd:o},onComplete:s})}}.bind({view:e,mode:this.mode})):(this.view._selectedFile||this.view.getControl(t+"-csv-file-input").elements.text.addClassName("field-error"),this.view.alert("warn",i.Pleasecheckyourform));else if(e.getControl(this.mode+"-form").validate()){var n,o=function(e){var t=function(e){var t,i=typeof e;if("object"===i&&!e)return"null";if("object"===i){if(!e.constructor)return"object";var n=e.constructor.toString();(t=n.match(/(\w+)\(/))&&(n=t[1].toLowerCase());var o=["boolean","number","string","array"];for(var s in o)if(o.hasOwnProperty(s)&&n===o[s]){i=o[s];break}}return i},i=t(e),n=null;switch(i){case"function":n="";break;case"undefined":n="N";break;case"boolean":n="b:"+(e?"1":"0");break;case"number":n=(Math.round(e)===e?"i":"d")+":"+e;break;case"string":n="s:"+e.length+':"'+e+'"';break;case"array":case"object":n="a";var s,a=0,r="";for(var l in e)if(e.hasOwnProperty(l)){if("function"===t(e[l]))continue;s=l.match(/^[0-9]+$/)?parseInt(l,10):l,r+=o(s)+o(e[l]),a++}n+=":"+a+":{"+r+"}"}return"object"!==i&&"array"!==i&&(n+=","),n},s=null,r=e.getControl(this.mode+"-form").getValue("role-select");r>0&&r<4?s=[{type:"team_role_filter",values:r}]:0===r&&(s=[]),n=e.model?e.model.get("mid"):e.getControl(this.mode+"-form").getValue("communities-select");var l=m.getBaseUrl()+"/api/community/getteamfile/as_admin/"+e._asAdmin+"/community_id/"+n;s&&(l+="/filters/"+encodeURI(o(s)));var c=e.getControl(this.mode+"-form").getValue("format-select");c&&(l+="/format/"+c),window.open(l),e._exportListOfCommunityUsersModal.hide()}else this.view.alert("warn",i.Pleasecheckyourform)}.bind({view:this,mode:t})}}),new l({value:i.cancel,events:{onClick:function(){o._resetForm(o,t)}}})]}));switch(t){case"add":o._addUsersToCommunitiesModal=u;break;case"remove":o._removeUsersFromCommunitiesModal=u;break;case"export":o._exportListOfCommunityUsersModal=u}return u},onAddUsersToCommunities:function(){this._addUsersToCommunitiesModal?this._addUsersToCommunitiesModal.show():this._createModal("add",{title:this.model?i.adduserstothiscommunity:i.adduserstocommunities,hideFormat:!0}).show(),this._currentModal=this._addUsersToCommunitiesModal},onRemoveUsersFromCommunities:function(){this._removeUsersFromCommunitiesModal?this._removeUsersFromCommunitiesModal.show():this._createModal("remove",{title:this.model?i.removeusersfromthiscommunity:i.removeusersfromcommunities,hideRole:!0,hideFormat:!0}).show(),this._currentModal=this._removeUsersFromCommunitiesModal},onExportListOfCommunityUsers:function(){this._exportListOfCommunityUsersModal?this._exportListOfCommunityUsersModal.show():this._createModal("export",{title:i.exportListOfCommunityUsers,hideWarning:!0,hideName:!0,hideFile:!0}).show(),this._currentModal=this._exportListOfCommunityUsersModal},setup:function(e){var i=this;i._parent.apply(i,arguments),i._currentUser=t.getInstance(),e&&e.asAdmin&&(i._asAdmin=e.asAdmin),i.model||(i._communitySelectOptions=[],i._pageIndex=1,i._communityCollection=new o([],{mode:"tenant-communities",pageMode:"start",limit:500}),i._communityCollection.fetchPage(i._pageIndex),i._communityCollection.addEvent("onAfterPageChange",function(){for(var e=this._models,t=0,n=e.length;t<n;t++)i._communitySelectOptions.push({label:e[t].get("title",{escapeHTML:!1}),value:e[t].get("mid")});this.getNbLoadedModels()<this.getTotalItems()?(i._pageIndex++,i._communityCollection.fetchPage(i._pageIndex)):i.unmask()},i._communityCollection)),i._confirmModal=new d({closable:!1,renderTo:i._widget.body})}})}),define("DS/SwymUIComponents/script/feature/community/content/view/content-viewer-view",["DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/utils/media-utils"],function(e,t){"use strict";var i=e.extend({});return e.extend({name:"content-viewer-view",className:"container-fluid",mediaDescription:null,defaultOptions:{bodyViewMode:"view",innerBodyViewMode:"",prevent3DPlayInstantiation:!1},setModel:function(e,t){return(t=t||{}).refresh=!1,this._parent.call(this,e,t)},setup:function(e){var t=e.model||this.model,i=t.getModelName();if(t){var n=this._parent.apply(this,arguments);return e||(e={}),this._addBodyView(),"media"===i&&(this.listenTo(t,"onChange:media_type",this._addBodyView),this.listenTo(t,{"onSync:read":function(){var e=this.getChildView("mediaDetailsView");e&&e.refresh()}}),this.addChildView("mediaDetailsView",{model:t,Class:"DS/SwymUIComponents/script/feature/community/media/view/media-details-view",widget:this._widget,showDownloadButton:!0})),"wedo"===i&&(this.addChildView("wedoChangeStatusView",{model:t,Class:"DS/SwymUIComponents/script/feature/community/wedo/view/wedo-change-status-view",widget:this._widget}),this.addChildView("wedoAttachments",{Class:"DS/SwymUIComponents/script/feature/community/wedo/view/simple-content-attachment-view",model:t,widget:this._widget}),this.addChildView("wedoProjectDetails",{Class:"DS/SwymUIComponents/script/feature/community/wedo/view/wedo-project-details-view",model:t,widget:this._widget}),this.addChildView("wedoMoreDetailsView",{model:t,assigneeCollection:t.getAssociated("assignees"),Class:"DS/SwymUIComponents/script/feature/community/wedo/view/wedo-more-details-view",widget:this._widget})),!0===this._rendered&&!1!==e.refresh&&this.refresh(),n}},_addBodyView:function(){var e=this._getBodyViewClass();e&&this.addChildView("bodyView",{model:this.model,Class:e,viewMode:this.getOption("bodyViewMode"),innerBodyViewMode:this.getOption("innerBodyViewMode")})},_getBodyViewClass:function(){var e,n=this.model;return n&&"media"===n.getModelName()?(e=t.getMediaViewerModule(n,null,{prevent3DPlayInstantiation:this.options.prevent3DPlayInstantiation}))||(e=i):e=n&&"survey"===n.getModelName()?"DS/SwymUIComponents/script/feature/community/survey/view/legacy-survey-view":"DS/SwymUIComponents/script/feature/community/content/view/content-body-view",e},_createContent:function(){var e="",t=this.model,i=t&&t.getModelName();return t&&(e=["wedo"===i?this.getChildView("wedoChangeStatusView"):"",this.getChildView("bodyView"),"media"===i?this.getChildView("mediaDetailsView"):"","wedo"===i?this.getChildView("wedoAttachments"):"","wedo"===i?this.getChildView("wedoProjectDetails"):"","wedo"===i?this.getChildView("wedoMoreDetailsView"):""]),e},editComment:function(e,t){this.model.dispatchEvent("CommentEditing",[e,t])}})}),define("DS/SwymUIComponents/script/feature/core/user/mixin/view-with-users-group-link",["UWA/Core","DS/SwymUIComponents/script/feature/core/modal/modal","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/UWPClientCode/I18n","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/users-group-tile-view"],function(e,t,i,n,o){"use strict";return{_showUsersGroup:function(e){var s=this;require(["DS/i3DXRDFGroupViewer/js/GroupViewer"],function(a){var r=new a({language:n.getCurrentLanguage(),groupId:e,platformId:i.getInstance().get("config").tenant.online_instance_id});r.render(),s.addControl("modal",new t({header:o.GroupDetails,body:r,className:"group-viewer-modal"})).show()},function(){console.error("Viewer module is not present on disk!")})}}}),define("DS/SwymUIComponents/script/feature/community/content/view/abstract-content-view",["UWA/Core","UWA/Event","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/navigation","DS/SwymUIComponents/script/feature/community/content/view/author-section-view","DS/SwymUIComponents/script/feature/community/content/view/compact-author-section-view","DS/SwymUIComponents/script/feature/core/user/mixin/view-with-users-group-link","DS/SwymUICore/script/feature/core/context/context-constants","DS/SwymUICore/script/feature/container/container-utils","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/lib/pub-sub","DS/SwymUICore/script/lib/event-manager","DS/SwymUICore/script/utils/usage-tracker","DS/SwymUIComponents/script/feature/community/content/view/sort-by-latest-view","DS/SwymUICore/script/constants/community-constants"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w){"use strict";var C=window.ds&&window.ds.isMDE;return i.extend(l,{_socialFeaturesWrapperSelector:"",_contentBodySelector:"",domEvents:{"click a[data-users-group-uri]":"_onUsersGroupClick","click .content-title":"onContentTitleClick"},defaultOptions:{SocialFeaturesClassV2:"DS/SwymUIComponents/script/feature/community/content/social-interactions/social-toolbar-view",socialFeaturesViewOptions:null,ActionMenuClass:"DS/SwymUIComponents/script/feature/community/content/view/action-menu-view",actionMenuOptions:null,comments:!0,socialToolbarMode:"normal",forceCommentFetchIfNotDoneYet:!1,commentsNumberAtInit:2,sendCommentsInitCallInPool:!1,showCommentsSummaryFirst:!0,showNonValidatedAnswersAtInit:!0},BLANK_TITLE_CODE:"__blank__",getClassNames:function(){var e=this._parent.apply(this,arguments)||"";return e+=" abstract-content "+this.model.getIconWrapperClass()},onContentTitleClick:function(e){window.getSelection()&&window.getSelection().toString()&&window.getSelection().focusNode&&e&&e.target&&e.target.contains(window.getSelection().focusNode)&&(e.preventDefault(),e.stopPropagation())},_getIconWrapperCls:function(){return this.model.getIconWrapperClass()},_createSocialToolbarForCompactView:function(){let t="DS/SwymUIComponents/script/feature/community/content/social-interactions/compact-social-toolbar-view",i={sendCommentsInitCallInPool:!0,commentsNumberAtInit:0,enableComment:!0,enableShare:!1,isCompactView:!0};if((this.getOption("isQuestionType")||!1)&&(t="DS/SwymUIComponents/script/feature/community/question/social-interactions/compact-social-features-for-question-view",i={sendCommentsInitCallInPool:!0,showAnswers:!1,enableComment:!1,enableShare:!1,isCompactView:!0}),!(this.getOption("isSurveyType")||!1))return this.addChildView("social-toolbar-view",e.extend({Class:t,model:this.model},i))},_createActionMenu:function(){var t=this.getOption("ActionMenuClass"),i=this.getOption("actionMenuOptions")||{};return t?this.addChildView("",e.extend({Class:t,model:this.model},i)):""},_renderTitle:function(){var e,t,i,n,o,s,a=this.model.get("mid"),r=this.model.get("subject6wuri"),l=this.model.getContentType&&this.model.getContentType()||this.model.getModelName();let m="social-event"===this.model.getModelName()&&r||a;return C?(t=(e=this.model.getCommunity&&this.model.getCommunity())&&e.get("mid"),i=e&&e.isDirectMessage(),s=this.model.getSource&&this.model.getSource(),a=this.model.get("mid"),n={tag:"a",class:"content-title",draggable:!1,"data-content-id":this._context.quadrant===c.NORTH_QUADRANT?m:this.model.get("subject6wuri"),"data-content-type":l,"data-quadrant":this._context.quadrant,html:[{tag:"span",class:"content-title-no-label",html:this.model.get("title")},this._renderLabel()]},t&&this._context.quadrant===c.NORTH_QUADRANT?i?n["data-dm-id"]=t:n["data-community-id"]=t:s&&(o=d.getContainerTypeFromSource(s),n["data-container-type"]=o,n["data-container-id"]=d.getContainerIdFromSource(o,this.model),a===n["data-container-id"]&&delete n["data-content-id"]),n):(t=(e=this.model.getCommunity()).get("mid"),i=e.isDirectMessage(),n={tag:"a",class:"content-title",draggable:!1,"data-content-id":m,"data-content-type":l,html:[{tag:"span",class:"content-title-no-label",html:this.model.get("title")},this._renderLabel()]},i?n["data-dm-id"]=t:n["data-community-id"]=t,n)},_renderLabel:function(){},_isDraggable:function(){return!0},_getIconElement:function(){var e=this.model,t=this.model.getContentType&&this.model.getContentType()||this.model.getModelName();return{class:"content-icon "+this._getIconWrapperCls(),draggable:this._isDraggable(),"data-content-id":e.get("mid"),"data-content-type":t,html:{tag:"span",class:"fonticon fonticon-"+this.model.getIconClass()}}},_createTitleSection:function(){var e=this.model,t=null,i=e.get("title"),n=this._createActionMenu(),o=e.getCommunity&&e.getCommunity(),s=o&&o.get("mid"),a=o&&o.isDirectMessage(),r=this.model.getSource&&this.model.getSource(),l=this._getIconElement();return C?s?a?l["data-dm-id"]=s:l["data-community-id"]=s:r&&(t=d.getContainerTypeFromSource(r),l["data-container-type"]=t,l["data-container-id"]=d.getContainerIdFromSource(t,this.model)):a?l["data-dm-id"]=s:l["data-community-id"]=s,[{class:"content-title-section",draggable:!1,html:[l,"__blank__"===i?{class:"content-title",html:""}:this._renderTitle(),n]}]},_createCompactViewSection:function(){var e=this.model,t=null,i=e.get("title"),n=this._createSocialToolbarForCompactView(),o=this._createActionMenu(),s=e.getCommunity&&e.getCommunity(),a=s&&s.get("mid"),r=s&&s.isDirectMessage(),l=this.model.getSource&&this.model.getSource(),c=this._getIconElement();return C?a?r?c["data-dm-id"]=a:c["data-community-id"]=a:l&&(t=d.getContainerTypeFromSource(l),c["data-container-type"]=t,c["data-container-id"]=d.getContainerIdFromSource(t,this.model)):r?c["data-dm-id"]=a:c["data-community-id"]=a,{class:"compact-content-section",draggable:!1,html:[{class:"left-content-group",html:c},{class:"right-content-group",html:[{class:"upper-group",html:["__blank__"===i?{class:"content-title",html:""}:this._renderTitle(),o]},{class:"lower-group",html:[this._createCompactAuthorSection(),n]},1===m.getNbLayoutColumns()?{class:"footer-group",html:[this._createSortByLatestSection()]}:null]}]}},_createSortByLatestSection:function(){return this.addChildView("sortByLatestView",new g({model:this.model,sortMode:this._context.sortMode}))},_createCompactAuthorSection:function(){return this.addChildView("authorSectionView",new r({model:this.model,showThreadLink:this.getOption("showThreadLink"),sortMode:this._context.sortMode,contentId:this._context.contentId}))},_createAuthorSection:function(){return this.addChildView("authorSectionView",new a({model:this.model,showThreadLink:this.getOption("showThreadLink"),sortMode:this._context.sortMode,contentId:this._context.contentId}))},_onUsersGroupClick:function(e){return this._showUsersGroup(t.getElement(e).dataset.usersGroupUri)},onRedraw:function(){if(this._socialFeaturesWrapperSelector){var t=this,i=this.getElement(this._socialFeaturesWrapperSelector);i&&t.getOption("SocialFeaturesClassV2")&&t._bootstrapModel.executeWhenReady(function(){t.addChildView("socialFeatures",e.extend({model:t.model,comments:t.getOption("comments"),showAnswers:t.getOption("showAnswers"),forceCommentFetchIfNotDoneYet:t.getOption("forceCommentFetchIfNotDoneYet"),Class:t.getOption("SocialFeaturesClassV2"),modelName:t.model.getModelName(),socialToolbarMode:t.getOption("socialToolbarMode"),widget:t._widget,commentsNumberAtInit:t.getOption("commentsNumberAtInit"),sendCommentsInitCallInPool:t.getOption("sendCommentsInitCallInPool"),showCommentsSummaryFirst:t.getOption("showCommentsSummaryFirst"),showNonValidatedAnswersAtInit:t.getOption("showNonValidatedAnswersAtInit"),events:{},annotationsEventBus:t.annotationsEventBus},t.getOption("socialFeaturesViewOptions")||{})).inject(i,"bottom")})}},init:function(){return this.annotationsEventBus=new u,this.annotationsEventBus.addEvent("onLoadAnnotationRequest",this.onLoadAnnotationRequestCallback,this),this._parent.apply(this,arguments)},setup:function(e){this._context=n.getInstance(),this._bootstrapModel=o.getInstance(),this._context.communityId||this._context.set({sortMode:w.CTY_CONTENT_LIST_SORT_MODE.CREATION_DATE}),this._parent.call(this,e)},onLoadAnnotationRequestCallback:function(e){var t=this.model,i=this;return p.trackPageEvent({category:"Annotation",label:"loadAnnotation",view:"abstract-content-view",event:"click",contenType:t&&t.getModelName()}),new Promise(function(e){t.hasBeenFetched()?e():t.fetch({onComplete:e})}).then(function(){var t,n,o=e&&e.relatedMediaUri,a=o&&o.split(":").pop();if(a||(a=(n=(t=r.getAssociated("embeddedMedia"))&&t.at(0))&&n.get("mid")),a){var r=i.model,l=r.getCommunity();s.goToContent(r.get("mid"),r.getModelName(),l.get("mid"),!1,void 0,void 0,"dm"===l.get("community_type"),{mediaId:a!==r.get("mid")?a:void 0,dataAnnotation:e})}})},openMedia:function(e){var t=this;return new Promise(function(i){var n=t.model,o=n.getCommunity();s.goToContent(n.get("mid"),n.getModelName(),o.get("mid"),!1,void 0,void 0,"dm"===o.get("community_type"),{mediaId:e}),i()})}})}),define("DS/SwymUIComponents/script/feature/community/content/view/content-detailed-view",["UWA/Core","UWA/Event","DS/SwymUIComponents/script/feature/community/content/view/abstract-content-view","DS/SwymUICore/script/lib/event-manager"],function(e,t,i,n){"use strict";var o=null;window.ds&&"3DD"===window.ds.env&&require(["DS/SwymUIComponents/script/utils/dnd-utils"],function(e){o=e});var s=i.extend({_socialFeaturesWrapperSelector:".viewer-bottom-section",_contentBodySelector:".content-body-section",_contentDetailSelector:".content-detail-section",_modelEvents:{"onSync:update":"refresh","onChange:title":"updateTitleSection","onSync:read":"updateContentOwnSections"},name:"content-in-feed-detailed-view",className:"detailed-content fade-in-animation",defaultOptions:{fetchItemOnClick:!0,modelFetchOptions:{fromCache:!0},commentsNumberAtInit:5,sendCommentsInitCallInPool:!1,showCommentsSummaryFirst:!1},init:function(){return n.addEvent("commentIconClickedInCompactView",this.commentIconClickedInCompactView.bind(this)),this.addEvent("onChildViewAdd:socialFeatures",this.onSocialFeaturesChildViewAdded.bind(this)),this._parent.apply(this,arguments)},scrollToCommentsAndFocusAFterRender:!1,commentIconClickedInCompactView:function(){this.scrollToCommentsAndFocusAFterRender=!0,n.removePersisted("commentIconClickedInCompactView")},onSocialFeaturesChildViewAdded:function(){let e=this.getChildView("socialFeatures"),t=null,i=this;if(this.scrollToCommentsAndFocusAFterRender){function n(e){setTimeout(function(){(t=i.getElement(e))&&(t.click(),i.scrollToCommentsAndFocusAFterRender=!1)},2e3)}"iquestion"===this.model.getModelName()?e.addEvent("onActionBarRendered",function(){n(".action-bar-view-container .fonticon-comment")}):e.addEvent("onSocialToolbarInjected",function(){n(".st-action-toolbar-buttons .fonticon-comment")})}},domEvents:{"dragstart .content-title-section":"onTitleDragStart"},onTitleDragStart:function(e){var t=this.model;o.onItemDrag(t,e,this._widget)},_createDetailedView:function(){var e=this.model,t=null;return e&&(t=this.addChildView("detailedView",{Class:"DS/SwymUIComponents/script/feature/community/content/view/content-viewer-view",className:"content-detail-section",model:e})),t},_createViewCounter:function(){var e=this.model,t=null;return e&&(t=this.addChildView("viewCounter",{Class:"DS/SwymUIComponents/script/feature/community/content/social-interactions/counter-view",model:e})),t},_createLeftColumn:function(){return{class:"content-body-section",html:[{class:"content-subtitle-section",html:[this._createAuthorSection(),this._createViewCounter()]},this._createDetailedView()]}},_createContent:function(){if(this.model)return[{class:"viewer-header",html:this._createTitleSection()},{class:"viewer-body",html:[{class:"viewer-top-section",html:this._createLeftColumn()},{class:"viewer-bottom-section"}]}]},updateTitleSection:function(){var e=this.getElement(".viewer-header");e&&e.setContent(this._createTitleSection())},updateContentOwnSections:function(){var e=this.getElement(".viewer-top-section");e&&e.setContent(this._createLeftColumn())},onSetModel:function(){!0===this.getOption("fetchItemOnClick")&&(this.model.fetch(this.options&&this.options.modelFetchOptions),this.setOption("fetchItemOnClick",!1))}});return s.TOP_SECTION_CLASS="viewer-top-section",s.BOTTOM_SECTION_CLASS="viewer-bottom-section",s}),define("DS/SwymUIComponents/script/feature/community/survey/view/survey-detailed-view",["UWA/Core","DS/SwymUICore/script/feature/community/survey/model/survey-model","DS/SwymUIComponents/script/feature/community/content/view/content-detailed-view"],function(e,t,i){"use strict";return i.extend({_socialFeaturesWrapperSelector:"",_modelClass:t,name:"survey-detailed-view",_createLeftColumn:function(){return{class:"content-body-section",html:[{class:"content-subtitle-section",html:this._createAuthorSection()},this._createDetailedView()]}},_createContent:function(){if(this.model)return[{class:"viewer-header",html:this._createTitleSection()},{class:"viewer-body",html:[{class:i.TOP_SECTION_CLASS,html:this._createLeftColumn()}]}]}})}),define("DS/SwymUIComponents/script/feature/community/social-event/view/social-event-detailed-view",["DS/SwymUICore/script/feature/community/social-event/model/social-event-model","DS/SwymUIComponents/script/feature/community/content/view/content-detailed-view","DS/SwymUIComponents/script/feature/community/social-event/view/badge-in-title-mixin","DS/SwymUICore/script/lib/event-manager","DS/UIKIT/Input/Button","DS/WAFData/WAFData","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/community/social-event/collection/takeaway-collection","DS/SwymUIComponents/script/feature/core/modal/super-modal","i18n!DS/SwymUIComponents/assets/nls/feature/community/social-event/social-event-view","DS/SwymUIComponents/script/feature/community/social-event/utils/social-event-constants","DS/UWPClientControls/PlatformNotify","DS/SwymUICore/script/utils/usage-tracker","DS/SwymUICore/script/feature/community/social-event/model/takeaway-model","DS/SwymUICore/script/utils/utils"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p){"use strict";return t.extend({_modelClass:e,name:"social-event-detailed-view",defaultOptions:{actionMenuOptions:{ReportAbuse:!1,Edit:!0,Delete:!0,ConvertToIdea:!1,FollowUnfollow:!0,Bookmark:!0,LeaveCommunity:!0,RssFeed:!0,pinToThisTab:!0,Subscribe:!0,highlight:!0}},_modelEvents:{"onSync:update":"_retrieveReportingData"},isReportEventBind:!1,mode:null,isReportPublished:!1,previousGlobalMinutes:{},setup:function(){return this.isReportEventBind||(this.mode=d.VIEW_MODE,this._retrieveReportingData(),this.listenTo(n,"switchToReportMode",function(){this.switchToReportMode()}.bind(this)),this.isReportEventBind=!0),this._parent.apply(this,arguments)},switchToViewMode(){this.mode=d.VIEW_MODE,this._socialFeaturesWrapperSelector="."+d.BOTTOM_SECTION_CLASS,this.refresh()},switchToReportMode(){this.isReportEventBind&&(this.previousGlobalMinutes=this.model.get("minutes"),this.model.getAssociated("topics").forEach(e=>e.savePreviousAttributes()),this.mode=d.REPORT_MODE,this.refresh())},_createContent(){let e=this.model.get("publication_state");if(this.mode===d.REPORT_MODE){let t;return this._socialFeaturesWrapperSelector="",t="PUBLISHED"===e?[new o({value:"Publish",className:"primary",events:{onClick:()=>this._saveReport("published")}}),new o({value:"Exit Report",className:"default",events:{onClick:()=>{new l({closable:!1}).confirm({title:c.Cancel,message:c.AreYouSure,callback:function(e){!0===e&&this.cancelReport()}.bind(this)})}}})]:[new o({value:"Save as draft",className:"primary",events:{onClick:()=>this._saveReport("draft")}}),new o({className:"primary",dropdown:{items:[{text:"Publish"}]},events:{onDropdownClick:()=>this._saveReport("published")}}),new o({value:"Exit Report",className:"default",events:{onClick:()=>{new l({closable:!1}).confirm({title:c.Exit,message:c.AreYouSure,okButtonText:"Exit anyway",koButtonText:c.Cancel,callback:function(e){!0===e&&this.cancelReport()}.bind(this)})}}})],[{class:"viewer-header",html:this._createTitleSection()},{class:"viewer-body",html:[{class:d.TOP_SECTION_CLASS,html:this._createLeftColumn()},{class:`${d.BOTTOM_SECTION_CLASS} report ${e.toLowerCase()}`,html:t}]}]}return this._parent.apply(this,arguments)},cancelReport(){u.trackPageEvent({category:"Rendezvous",label:"exitReportMode",view:"social-event-detailed-view",event:"click"}),this.model.set("minutes",this.previousGlobalMinutes),this.model.getAssociated("topics").forEach(e=>e.restorePreviousTopicAttributes()),this.switchToViewMode()},_sendReport(e,t,i){let n=a.getInstance();const o=p.getBaseUrl()+`/api/conferences/${this.model.get("subject6wuri")}/report`,r=n.getCSRFToken();s.authenticatedRequest(o,{type:"json",method:"POST",timeout:6e4,data:JSON.stringify(e),headers:{Accept:"application/json","Content-Type":"application/json","X-DS-SWYM-CSRFTOKEN":r},onComplete:t,onFailure:i})},_retrieveReportingData(){let e=a.getInstance();const t=p.getBaseUrl()+`/api/conferences/${this.model.get("subject6wuri")}/report`,i=e.getCSRFToken();s.authenticatedRequest(t,{method:"GET",timeout:6e4,headers:{Accept:"application/json","Content-Type":"application/json","X-DS-SWYM-CSRFTOKEN":i},onComplete:e=>{let t=e&&JSON.parse(e),i=t&&t.result;i&&(this.processReportingData(i),this.refresh())},onFailure:function(e){return!1}})},processReportingData(e){this.isReportPublished="PUBLISHED"===e.publication_state,this.model.set("publication_state",e.publication_state),e.global&&e.global.minutes&&this.model.set("minutes",e.global.minutes),e.topics&&e.topics.length&&this.model.getAssociated("topics").forEach(t=>{let i=e.topics.filter(e=>e.uri===t.get("subject6wuri")),n=i.length&&i[0];t.set("minutes",n&&n.minutes);const o=n&&n.takeaways.map(e=>new h(e,{}));t.getAssociated("takeaways").set(o)})},_saveReport(e){const t=this.getChildView("detailedView"),i=t&&t.getChildView("topicViewerCollectionView");if("draft"===e?u.trackPageEvent({category:"Rendezvous",label:"saveReportAsDraft",view:"social-event-detailed-view",event:"click"}):"published"===e&&u.trackPageEvent({category:"Rendezvous",label:"publishReport",view:"social-event-detailed-view",event:"click"}),i){let n={},o=[];n.publication_state=e,n.global={minutes:t&&t.getChildView("rdvMinutesView")&&t.getChildView("rdvMinutesView").getRTEContent()||""};Object.values(i.getChildViews()).forEach(e=>{let t={uri:e.model.get("subject6wuri"),minutes:e.getChildView("MinutesView")&&e.getChildView("MinutesView").getRTEContent()},i=e.getChildView("takeawayViewerCollectionView");if(i){let e=Object.values(i.getChildViews());t.takeaways=e.filter(e=>e.isValid()).map(e=>e.getContentAttributes()||[]),o.push(t)}}),n.topics=o,this._sendReport(n,e=>{this.processReportingData(e.result),this.isReportPublished?this.switchToViewMode():(m.success(c.get("saveAsDraftOK")),this.previousGlobalMinutes=this.model.get("minutes"),this.model.getAssociated("topics").forEach(e=>e.savePreviousAttributes()))},()=>{m.error(c.get("saveAsDraftKO"))})}},_createDetailedView:function(){var e=this.model,t=null;return e&&(t=this.addChildView("detailedView",{Class:"DS/SwymUIComponents/script/feature/community/social-event/view/social-event-viewer-view",className:"content-detail-section",model:e,widget:this._widget,mode:this.mode,isReportPublished:this.isReportPublished})),t}},i)}),define("DS/SwymUIComponents/script/feature/community/question/view/question-detailed-view",["UWA/Core","DS/SwymUICore/script/feature/community/iquestion/model/iquestion-model","DS/SwymUIComponents/script/feature/community/content/view/content-detailed-view","DS/SwymUIComponents/script/feature/community/question/question-view-mixin","DS/SwymUICore/script/feature/core/context/context-model"],function(e,t,i,n,o){"use strict";return i.extend({_modelClass:t,name:"question-detailed-view",validated:null,defaultOptions:{SocialFeaturesClass:"DS/SwymUIComponents/script/feature/community/question/social-interactions/social-features-for-question-detailed-view",SocialFeaturesClassV2:"DS/SwymUIComponents/script/feature/community/question/social-interactions/social-features-for-question-detailed-view",socialFeaturesViewOptions:null},setup:function(t){var i=o.getInstance();return i.answerUri&&!i.commentUri&&this.setOption("socialFeaturesViewOptions",e.extend({answerToScrollTo:i.answerUri},t&&t.socialFeaturesViewOptions)),this._parent.apply(this,arguments)}}).extend(n)}),define("DS/SwymUIComponents/script/feature/community/wedo/view/wedo-detailed-view",["DS/SwymUICore/script/feature/community/wedo/model/wedo-model","DS/SwymUIComponents/script/feature/community/content/view/content-detailed-view","DS/SwymUIComponents/script/feature/community/wedo/view/wedo-author-section-view"],function(e,t){"use strict";return t.extend({_modelClass:e,name:"wedo-detailed-view",defaultOptions:{actionMenuOptions:{ConvertToIdea:!1,RssFeed:!0,ReportAbuse:!1,highlight:!1}}})}),define("DS/SwymUIComponents/script/feature/community/post/view/post-detailed-view",["UWA/Core","DS/SwymUICore/script/feature/community/post/model/post-model","DS/SwymUIComponents/script/feature/community/content/view/content-detailed-view"],function(e,t,i){"use strict";return i.extend({_modelClass:t,name:"post-detailed-view"})}),define("DS/SwymUIComponents/script/feature/community/media/view/media-tile-view",["UWA/Core","DS/SwymUIComponents/script/feature/community/content/view/abstract-content-view","DS/SwymUIComponents/script/feature/community/content/view/media-thumbnail-view","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUIComponents/script/utils/media-utils","DS/SwymUICore/script/utils/utils","DS/SwymUIComponents/script/feature/community/content/view/author-section-view","DS/SwymUICore/script/lib/view/generic/swym-view"],function(e,t,i,n,o,s,a,r){"use strict";var l=i.extend({name:"custom-media-thumbnail",setup:function(e){return e&&void 0!==e.delegateSpriteReloadToParentView&&(this._delegateSpriteReloadToParentView=e.delegateSpriteReloadToParentView,this._bufferImagesReload=!1),this._parent.apply(this,arguments)},_createContent:function(){var e=this.model,t=parseInt(e.get("width"),10)||0;return{styles:{"max-width":"100%",width:t>0?t+"px":n.MEDIA_THUMBNAIL.DIMENSIONS.LARGE.WIDTH+"px",margin:"auto",flex:"none"},html:this._parent()}}}),c=r.extend({name:"media-selected-tile-view",_createContent:function(){return e.createElement("div",{html:'<span class="fonticon fonticon-check fonticon-4x"></span>'})}});return t.extend({name:"media-tile-view",_modelClass:n,_modelEventsForAutoRefresh:["onChange:title","onChange:description","onChange:update"],_showToolbar:!1,defaultOptions:{canBeSelected:!1,comments:!1,sendCommentsInitCallInPool:!0},domEvents:{click:"_onClick",resize:"_onResize","click .st-endorse-btn-wrapper":"_stopPropagate","click .st-share-btn-wrapper":"_stopPropagate","click .st-counter":"_stopPropagate",'click .link[data-content-type="person"]':"_onUserClick"},className:"swym-tile",_onClick:function(){this.dispatchEvent("onClick",[this])},_stopPropagate:function(e){e.stopPropagation()},_onUserClick:function(e){e.stopPropagation(),e.preventDefault(),require(["DS/SwymUICore/script/utils/link-builder-utils"],function(t){t.displayProfile(e)})},_onResize:function(){var e=this.getElement(".media-tile");e&&(e.getSize().width<=269?e.addClassName("without-counters"):e.removeClassName("without-counters"))},_createAuthorSection:function(){return this.addChildView("contentAuthorSection",new a({model:this.model,mode:"simple",showThreadLink:this.getOption("showThreadLink")}))},_createContent:function(){var t=this.model,i=e.Utils.Client.Engine.ie11,n=t.get("title"),o=t.get("content");return e.createElement("div",{class:"media-tile",html:[this.getChildView("thumbnail"),{class:"content-body-section block-except-logo",styles:{padding:"10px"},html:[n?{class:"title",styles:i?{"font-size":"18px","line-height":"32px"}:{},html:n}:"",!0===this._showToolbar?this._createActionMenu():"",this._createAuthorSection(),{class:"visibility",html:'<span class="fonticon fonticon-1-5x fonticon-'+s.getMediaIconName(t)+'"></span>'},o?{class:"description",html:o}:""]},{class:"media-social-toolbar",styles:i?{"min-height":"48px"}:{}}]})},setup:function(e){var t={},i=this.model;if(e&&e.showToolbar&&(this._showToolbar=e.showToolbar),this._showToolbar&&(this._socialFeaturesWrapperSelector=".media-social-toolbar"),i){var n=i.get("media_type"),s="picture"===n?parseInt(i.get("width"),10)/parseInt(i.get("height"),10):4/3,a=o.generateBestThumbnailForContentView(500,500/s,i);t={Class:l,model:i,delegateSpriteReloadToParentView:e.delegateSpriteReloadToParentView,events:{onRender:function(e){!0===this.getOption("canBeSelected")&&this.addChildView("media-selected",{Class:c}).render(e.container)}.bind(this)}};var r={},d=i.get("width"),m=i.get("height");(r=n&&d&&m?{size:a.sizeCategory,imageKind:a.previewType}:{size:"l",imageKind:"thumb"}).useSprite=!1,t.imageReloadOptions=r,this.addChildView("thumbnail",t),this._parent.apply(this,arguments)}}})}),define("DS/SwymUIComponents/script/feature/community/media/view/uploader/upload-manager-view",["UWA/Core","UWA/Element","UWA/Class/Events","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/view/upload-manager-view","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/community/media/model/media-file-extension-model","DS/SwymUIComponents/script/utils/media-utils","DS/SwymUICore/script/utils/utils","DS/UWPClientCode/I18n","DS/WAFData/WAFData","UWA/Utils"],function(e,t,i,n,o,s,a,r,l,c,d,m){"use strict";var u=i.extend({init:function(e){this.file=e.file}}),h=window.ds&&"3DD"===ds.env;return o.extend({name:"upload-manager-view",_authorizedFilesTypes:null,_ajaxUploadService:"/api/media/addmedia",_formUploadService:"/html/media/addmedia",_mediaFileExtension:null,_communityId:null,_preUploadErrors:null,_createContent:function(){return[]},setup:function(e){this._parent.apply(this,arguments),void 0!==e.communityId&&(this._communityId=e.communityId),void 0!==e.showCollection&&(this._showCollection=e.showCollection),!0===e.autoPublish&&(this.autoPublish=!0),void 0!==e.ajaxUploadService&&(this._ajaxUploadService=e.ajaxUploadService),void 0!==e.formUploadService&&(this._formUploadService=e.formUploadService),void 0!==e.authorizedFilesTypes&&(this._authorizedFilesTypes=e.authorizedFilesTypes)},setCommunityId:function(e){this._communityId=e},getCommunityId:function(){return this._communityId},checkFiles:function(e,t){var i=[],n=[];this._preUploadErrors=[];for(var o=-1,s=e.length;++o<s;){var a=e[o];void 0===a.fileName&&(a.fileName=a.name),n.push({browserFileData:a,customData:{}})}this._getFilesOkToBeUploaded(n,function(e){for(o=0,s=e.length;o<s;o++)i.push(new u({file:e[o]}));t(i)})},uploadMedia:function(e,t,i){var o,s,a,r=this,m=!0===this.autoPublish?"1":"0";s=void 0!==i&&i.hasOwnProperty("title")?i.title:e.file.customData.title;var u=new FormData;if(a=void 0!==i&&i.hasOwnProperty("fileName")?i.fileName:e.file.browserFileData.fileName,u.append("fileName",a),void 0!==i&&i.hasOwnProperty("userFile")?u.append("userFile",i.userFile):u.append("userFile",e.file.browserFileData),u.append("title",s),void 0!==i)for(var p in i)i.hasOwnProperty(p)&&"title"!==p&&"fileName"!==p&&"userFile"!==p&&u.append(p,i[p]);if("/api/media/addmedia"===this._ajaxUploadService&&(u.append("published",m),u.append("category_id","0"),u.append("description",""),u.append("is_illustration","true"),u.append("community_id",this._communityId)),o=l.getBaseUrl()+this._ajaxUploadService,h)d.authenticatedRequest(o,{data:u,method:"POST",timeout:432e5,onTimeout:function(){var t=c.replace(n.MEDIA_UPLOAD_TIMEOUT,{Title:s,FileName:a});r.alert("error",t),e.dispatchEvent("uploadFailed")},onComplete:function(i){var n=JSON.parse(i);r.onMediaLoaded(n,e,t)}});else{var g=new XMLHttpRequest;g.upload&&g.upload.addEventListener&&g.upload.addEventListener("progress",function(t){e.dispatchEvent("uploadProgress",t)}.bind(this)),g.ontimeout=function(){var t=c.replace(n.MEDIA_UPLOAD_TIMEOUT,{Title:s,FileName:a});r.alert("error",t),e.dispatchEvent("uploadFailed")},g.open("POST",o,!0),g.timeout=432e5,g.send(u),g.addEventListener&&g.addEventListener("load",function(i){var n=JSON.parse(i.target.responseText);r.onMediaLoaded(n,e,t)},!1)}},onMediaLoaded:function(e,t,i){var n,o;void 0!==e.errorcode?(this.dispatchEvent("uploadFailed"),t.dispatchEvent("uploadFailed"),this._displayUploadErrorMsg(e)):(o=e.result.id,"/api/media/addmedia"===this._ajaxUploadService?n=new s({id:o},{autoPopulate:!0,onComplete:function(e){this.dispatchEvent("mediaLoaded",[e])}.bind(this)}):this.dispatchEvent("mediaLoaded"),t.dispatchEvent("fileIsUploaded",n),!0===i&&this.dispatchEvent("multipleUploadComplete"))},_getMediaFileExtension:function(){return this._mediaFileExtension||(this._mediaFileExtension=a.getInstance()),this._mediaFileExtension},populateMediaFileExtension:function(e){e||console.error("Please provide a callback !"),a.getInstance(function(){this._mediaFileExtension=a.getInstance(),e&&e()}.bind(this))},_getFilesOkToBeUploaded:function(e,t){for(var i=[],n=this,o=0,s=-1,a=e.length;++s<a;){var r=e[s],l=r.browserFileData.fileName,c=l.substring(l.lastIndexOf(".")+1,l.length).toLowerCase(),d=this._getType(c),m=null;if(m=-1!==l.lastIndexOf(".")?l.substring(0,l.lastIndexOf(".")):l,r.customData={title:m,extension:c,type:d},r.customData.customId=r.customData.title,null!==d){if(null!==this._authorizedFilesTypes){for(var u=!1,h=-1,p=this._authorizedFilesTypes.length;++h<p;)d===this._authorizedFilesTypes[h]&&(u=!0);if(!u){this._preUploadErrors.push({fileName:l,errorType:"fileType"}),o++,A();continue}}var g=this._getMediaFileExtension().get("maxSizes"),w=g[d],C=this._getMediaFileExtension().get("maxpixels").picture;if("image"===d&&(w=g.picture),"audio"===d&&(w=g.sound),"3dmodel"===d&&(w=g["3d_model"]),r.browserFileData.size>parseInt(w,10))this._preUploadErrors.push({fileName:l,errorType:"fileSize",fileType:d,maxSizeInKBytes:parseInt(w,10)/1048576}),o++,A();else if("picture"===d&&r.customData&&r.customData.extension&&"tiff"!==r.customData.extension&&"tif"!==r.customData.extension){var f=window.URL,y=new Image;function v(e,t){y.onload=function(){this.width*this.height>C?n._preUploadErrors.push({fileName:t,errorType:"resolution",maxResolutionInMPixels:parseInt(C,10)/1e6}):i.push(e),o++,A()},y.src=f.createObjectURL(e.browserFileData)}v(r,l)}else o++,i.push(r),A()}else this._preUploadErrors.push({fileName:l,errorType:"fileType"}),o++,A();function A(){o===a&&(n._preUploadErrors.length>0&&(n.dispatchEvent("uploadFailed"),n._displayPreUploadErrors()),t(i))}}},_getType:function(e){e=e?e.toLowerCase():"";var t,i,n=this._getMediaFileExtension().get("authorizedFormats"),o=n.image;for(t=-1,i=o.length;++t<i;)if(o[t]===e)return r.MEDIA_TYPE.IMAGE;for(t=-1,i=(o=n.video).length;++t<i;)if(o[t]===e)return r.MEDIA_TYPE.VIDEO;for(t=-1,i=(o=n.audio).length;++t<i;)if(o[t]===e)return r.MEDIA_TYPE.AUDIO;for(t=-1,i=(o=n.drawing).length;++t<i;)if(o[t]===e)return r.MEDIA_TYPE.DRAWING;for(t=-1,i=(o=n.document).length;++t<i;)if(o[t]===e)return r.MEDIA_TYPE.DOCUMENT;for(t=-1,i=(o=n.simulation).length;++t<i;)if(o[t]===e)return r.MEDIA_TYPE.SIMULATION;for(t=-1,i=(o=n["3dmodel"]).length;++t<i;)if(o[t]===e)return r.MEDIA_TYPE["3DMODEL"];return null},_displayPreUploadErrors:function(){var t="";if(1===this._preUploadErrors.length)t+=this._createErrorMessage(this._preUploadErrors[0]);else{for(var i=this._preUploadErrors.length-1;i>=0;i--)t+="<li>"+this._createErrorMessage(this._preUploadErrors[i])+"</li>";t=e.createElement("ul",{html:t})}this.alert("error",t)},_displayUploadErrorMsg:function(e){var t;t="ERROR_FILE_UPLOAD_ERROR"===e.errorcode?n.get("Yourfileiseitheremtpyorexceedsthemaximumallowedsize"):n.replace(n.get("Anerroroccuredduringupload"),{errorcode:e.errorcode}),this.alert("error",n.get("Uploadfailed")+":"+t)},_createErrorMessage:function(e){var t="";return"fileSize"===e.errorType?t=n.replace(n.get("FileSizeError"),{FileName:e.fileName,FileType:e.fileType,maxSizeInKBytes:e.maxSizeInKBytes}):"fileType"===e.errorType?t=n.replace(n.get("FileTypeError"),{FileName:e.fileName}):"resolution"===e.errorType&&(t=n.replace(n.get("FileResolutionError"),{FileName:e.fileName,maxResolution:e.maxResolutionInMPixels})),t}})}),define("DS/SwymUIComponents/script/feature/community/media/edit/upload/upload-manager",["UWA/Core","UWA/Class","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUIComponents/script/feature/community/media/view/uploader/upload-manager-view","DS/SwymUICore/script/feature/community/media/model/media-file-extension-model","DS/SwymUICore/script/feature/core/context/context-model","DS/Logger/Logger"],function(e,t,i,n,o,s,a){"use strict";function r(e,t){var i=new FileReader;i.onload=function(i){var n=new DataView(i.target.result);if(65496!==n.getUint16(0,!1))return t(-2,e,n.buffer);for(var o=n.byteLength,s=2;s<o;){var a=n.getUint16(s,!1);if(s+=2,65505===a){if(1165519206!==n.getUint32(s+=2,!1))return t(-1,e,n.buffer);var r=18761===n.getUint16(s+=6,!1);s+=n.getUint32(s+4,r);var l=n.getUint16(s,r);s+=2;for(var c=0;c<l;c++)if(274===n.getUint16(s+12*c,r)){const i=n.getUint16(s+12*c+8,r);return n.setUint16(s+12*c+8,1,r),t(i,e,n.buffer)}}else{if(65280!=(65280&a))break;s+=n.getUint16(s,!1)}}return t(-1,e,n.buffer)},i.readAsArrayBuffer(e)}function l(t,i,n){let o=e.createElement("img");try{var s,r,l,y,v,A,_=1,S=t;o.src=S,o.onload=function(){switch(y=this.height,l=this.width,s=e.createElement("canvas"),r=s.getContext("2d"),i===p||i===u||i===g||i===h?(v=s.width=y,A=s.height=l):i!==c&&i!==m&&i!==d||(v=s.width=l,A=s.height=y),r.translate(v/2,A/2),i){case p:_=-1;case g:_*=f,r.rotate(_*Math.PI/180);break;case m:_=-1;case d:_*=w,r.rotate(_*Math.PI/180);break;case u:_=-1;case h:_*=C,r.rotate(_*Math.PI/180)}i!==g&&i!==p&&i!==u&&i!==h||(v=l,A=y),r.translate(-v/2,-A/2),i!==c&&i!==p&&i!==u&&i!==m||(!0,r.translate(v,0),r.scale(-1,1)),r.drawImage(o,0,0),n({dataURI:s.toDataURL()})}}catch(e){a.warn("exception")}}var c=2,d=3,m=4,u=5,h=6,p=7,g=8,w=180,C=90,f=-90;return n.extend({_uploaders:null,setup:function(e){if(this._parent.apply(this,arguments),this._uploaders={},e&&e.uploaders)for(var t in e.uploaders)e.uploaders.hasOwnProperty(t)&&e.uploaders[t].Class&&this.addUploader(t,e.uploaders[t])},getUploader:function(e){return this._uploaders[e]},addUploader:function(e,t){var n,o=this;t&&(t instanceof i?(o._uploaders[e]=t,o.listenTo(o._uploaders[e],"onFilesSelected",o._filesSelected),o.listenTo(o._uploaders[e],"onProxyFailed",o._proxyFailed),o.listenTo(o._uploaders[e],"on3DDriveMediaSelected",o._3DDriveMediaSelected)):"string"==typeof t.Class?require([t.Class],function(i){delete t.Class,o.addUploader(e,new i(t||{}))}):t.Class.prototype instanceof i&&(n=new t.Class(t.options||{}),this.addUploader(e,n)))},_filesSelected:function(e){if(!(e.length>0))return!1;var t=o.getInstance();t.get("authorizedFormats")?this._handleFiles(e):this.listenToOnce(t,"onDocumentedFileExtensionsCreated",this._handleFiles.bind(this,e))},_3DDriveMediaSelected:function(e){e.length>0&&this.dispatchEvent("on3DDriveMediaSelected",[e])},_proxyFailed:function(e){e.length>0&&this.dispatchEvent("onProxyFailed",[e])},_handleFiles:function(e){var t,i=this;e&&e.length>0&&this.checkFiles(e,function(e){if(e.length>0)for(var n=0,o=e.length;n<o;n++)(t=e[n]).file&&(t=t.file.browserFileData)&&"image/jpeg"===t.type?r(t,function(t,n,o){t>1?(a.log("Image has an EXIF orientation tag",t,n),l("data:image/jpeg;base64,"+btoa(new Uint8Array(o).reduce((e,t)=>e+String.fromCharCode(t),"")),t,function(t){t&&t.dataURI&&(n.dataURI=t.dataURI,n.treated=!0,i.onReadyForUpload(e))})):(n.treated=!0,i.onReadyForUpload(e))}):(t.treated=!0,i.onReadyForUpload(e))})},render:function(){},onReadyForUpload:function(e){var t,i,n,o;if(e.reduce(function(e,t){return e+(t.file&&t.file.browserFileData&&!0===t.file.browserFileData.treated?1:0)},0)===e.length){let a=s.getInstance().getData().path;for(t=0,i=e.length;t<i;t++)o={title:(n=e[t]).file.customData.title,media_type:n.file.customData.type,fileName:n.file.fileName||n.file.browserFileData.fileName,userFile:!n.file.browserFileData.dataURI||a.contains("sketchcreation")||a.contains("whiteboardcreation")?n.file.browserFileData:n.file.browserFileData.dataURI},n.attributes=o;this.dispatchEvent("onUpload",[e])}},onDestroy:function(){var e,t=this._uploaders;for(e in t)t.hasOwnProperty(e)&&this.stopListening(t[e],"onUpload")}})}),define("DS/SwymUIComponents/script/feature/community/survey/view/survey-tile-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/survey/view/survey-tile-view","DS/SwymUIComponents/script/feature/community/content/view/abstract-content-view","DS/SwymUICore/script/feature/community/survey/model/survey-model","DS/SwymUIComponents/script/feature/core/user/view/user-picture-view","DS/SwymUICore/script/utils/i18n","DS/SwymUICore/script/feature/core/context/context-model","DS/UIKIT/Input/Button","DS/SwymUICore/script/utils/utils"],function(e,t,i,n,o,s,a,r,l){return i.extend({_modelClass:n,domEvents:{"click .survey-link":"_onClick","click .title":"_onClick"},_modelEventsForAutoRefresh:["onChange:userHasAlreadyAnswered"],name:"survey-tile-view",className:"swym-tile",_onClick:function(e){var t=a.getInstance();t&&t.reset({contentId:this.model.get("mid"),contentType:this.model.getModelName(),communityId:this.model.getCommunity().get("mid")})},setup:function(e){this.model.isansweredbyme({}),this._parent.apply(this,arguments)},_createContent:function(){var i=this.model,n="",a=e.createElement("div",{styles:{"min-height":"48px"}});if(i){var l=i.get("title"),c=i.getAssociated("author"),d=i.isOpen(),m=i.hasStarted(),u=d?"open-survey":"closed-survey";if(i.has("userHasAlreadyAnswered")){var h="";(h=i.get("userHasAlreadyAnswered")||!d?t.CheckResults:t.Answer)&&(a=e.createElement("div",{styles:{"text-align":"center","margin-top":"10px"},html:this.addControl("call-to-action",new r({className:h===t.Answer?"primary":"default",value:h,icon:h===t.Answer?"":"chart-bar",events:{onClick:function(){this._onClick()}.bind(this)}}))}))}n=e.createElement("div",{class:"survey-tile",html:[{class:"header-tile-block",html:[this.addChildView("userPicture",{Class:o,model:c,imageRenderingOptions:{format:"square"}}),l?{class:"title",html:l}:"",{html:'<span class="fonticon fonticon-1-5x '+u+' fonticon-clock"></span>'+(d?t.SurveyisOpen:m?t.SurveyisClosed:t.SurveyYetToOpen)}]},{styles:{clear:"both"}},{class:"survey-tile-text",html:s.replace(t.authorCreatedSurvey,{nickname:'<span class="link" data-content-type="person" data-hash-key="'+c.get("hash_key")+'">'+c.getNickname()+"</span>",surveyTitle:'<span class="link survey-link">'+l+"</span>"})},m?a:""]})}return n}})}),define("DS/SwymUIComponents/script/feature/community/survey/view/survey-list-view",["UWA/Core","DS/SwymUIComponents/script/feature/core/ui-components/list/item-list","DS/SwymUIComponents/script/feature/community/survey/view/survey-tile-view","DS/SwymUICore/script/lib/model/model-manager"],function(e,t,i,n){"use strict";return t.extend({name:"community-survey-list",modelViewClass:i,_onPublishing:function(e){"survey"===e.getModelName()&&e.getCommunity().get("mid")===this.collection.communityId&&this.collection.unshift(e)},itemViewSelector:".survey-tile-view-container",domEvents:{"dragstart .survey-tile-view-container":"onItemDragStart"},modelViewsCfg:function(){var t=this._parent.apply(this,arguments);return e.merge({attributes:{draggable:!0}},t)},setup:function(e){e.useDynamicGrid=!0,this._onPublishingBound||(this._onPublishingBound=this._onPublishing.bind(this),n.addListenerOnPublishing(this._onPublishingBound)),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/media/view/media-list-view",["UWA/Core","DS/SwymUIComponents/script/feature/core/ui-components/list/item-list","DS/SwymUIComponents/script/feature/community/media/view/media-tile-view","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/lib/model/model-manager","DS/SwymUICore/script/utils/utils"],function(e,t,i,n,o,s){"use strict";var a;return t.extend({name:"community-media-list",itemViewSelector:".media-tile-view-container",domEvents:{click:"onItemClick","dragstart .media-tile-view-container":"onItemDragStart"},defaultOptions:{debounceDelay:500,commentCallMutualizerOptions:{commentsNumberAtInit:0}},imageReloadOptions:(a={nonReloadedImagesOnly:!0,useVariableSizeSprite:!0,selector:'img[data-type="VariableSizeMediaThumbnail"]'},a),_onPublishing:function(e){"media"===e.getModelName()&&e.getCommunity().get("mid")===this.collection.communityId&&this.collection.unshift(e)},onItemClick:function(e){var t=n.getInstance(),i=e.target,o=i.getClosest(".media-tile");!o||!o.getElement("img").getAttribute("data-content-id")||i.childNodes[0]&&i.childNodes[0].className&&i.childNodes[0].className.contains("fonticon-forward")||i.className.contains("fonticon-forward")||i.className.contains("fonticon-down-open")||t.set({contentId:e.target.getClosest(".media-tile").getElement("img").getAttribute("data-content-id"),contentType:e.target.getClosest(".media-tile").getElement("img").getAttribute("data-content-type")})},modelViewClass:i,modelViewsCfg:function(){var t=this._parent.apply(this,arguments);return t.delegateSpriteReloadToParentView=!1,e.extend(t,{attributes:{draggable:!0},isTileModeActivated:!0,showToolbar:!1},!0)},setup:function(e){e.useDynamicGrid=!0,this._onPublishingBound||(this._onPublishingBound=this._onPublishing.bind(this),o.addListenerOnPublishing(this._onPublishingBound)),this._parent.apply(this,arguments)},destroy:function(){return this._onPublishingBound&&o.removeListenerOnPublishing(this._onPublishingBound),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/media/editor/view/image-editor-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/media/editor/collection/operation-collection","DS/SwymUICore/script/feature/community/media/editor/model/operation-model","DS/SwymUIComponents/script/feature/community/media/editor/view/cropbox-view","DS/SwymUICore/script/utils/utils","DS/SwymUIComponents/script/utils/media-utils","UWA/Utils/Client","DS/WebappsUtils/Console","DS/WebappsUtils/WebappsUtils","DS/UIKIT/Tooltip","DS/Controls/Slider","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/editor/view/image-editor-view"],function(e,t,i,n,o,s,a,r,l,c,d,m,u){"use strict";return t.extend({name:"image-editor-view",domEvents:{"click .editor-toolbar button":"buttonClicked"},canvasCopy:[],currentOperationIndex:null,previousBrightnessValue:null,lastBrightnessOperationId:null,originalImageUsedInEditor:!1,bnwDone:!1,setup:function(){return this._parent.apply(this,arguments),this.listenTo(this,"saveMediaEdited",this.saveOriginalMediaToModel),this._operations=new i,this.currentOperationIndex=0,this.previousBrightnessValue=0,this.keypressCropHandlerBound=this.keypressCropHandler.bind(this),this},getParentViewContainer:function(){return this.options.parentContainerElement?this.options.parentContainerElement:this._parentView.container},_createContent:function(){var t,i=this.options.isInLightbox?this.getParentViewContainer().getElement(".content").getSize().width:this.getParentViewContainer().getSize().width,n=this.options.isInLightbox?this.getParentViewContainer().getElement(".content").getSize().height-100:this.getParentViewContainer().getSize().height,o=this.model,s=null,a=o.getChanges("width")||o.get("width"),r=o.getChanges("height")||o.get("height"),l=parseInt(a,10),m=parseInt(r,10),h=l/m;this.options.isInLightbox?l<=i&&m<=n?(s=l,this.originalImageUsedInEditor=!0):l>i&&m>n?s=i/n>l/m?n*h:i:l<i&&m>n?s=n*h:l>i&&m<n&&(s=i):l>=i||!l?s=i:l<i?(s=l,m<n&&(this.originalImageUsedInEditor=!0)):0===i&&(s=960),this.imageWidth=this.options.isInLightbox?s:s-30;var p=l/m;return this.imageHeight=p?this.imageWidth/p:null,t=e.createElement("div",{html:[{tag:"div",class:"editor-toolbar",html:['<button id="undo" disabled class="undo-btn btn btn-default"></button>','<button id="redo" disabled class="redo-btn btn btn-default"></button>','<button id="crop" class="crop-btn btn btn-default"></button>','<button id="rotate" class="rotate-btn btn btn-default"></button>','<button id="bnw" class="bnw-btn btn btn-default"></button>','<button id="flip" class="flip-btn btn btn-default"></button>',e.createElement("span",{class:"brightness-bar",html:[{tag:"img",src:c.getWebappsBaseUrl()+"SwymUIComponents/assets/media/media-editor/brightness-icon.png",alt:""},this._getBrightnessControl()]})]},{tag:"div",class:"canvas-editor-container",styles:{"min-height":this.options.isInLightbox?0:this.imageHeight},html:[{tag:"img",id:"editor-img",class:"img-responsive",styles:{"border-radius":0}},{tag:"canvas",id:"editor-canvas",styles:{display:"none"},width:this.options.isInLightbox?"none":this.imageWidth}]}]}),this.addControl("undoButtonTooltip",new d({target:t.getElement(".undo-btn"),body:u.Undo})),this.addControl("redoButtonTooltip",new d({target:t.getElement(".redo-btn"),body:u.Redo})),this.addControl("cropButtonTooltip",new d({target:t.getElement(".crop-btn"),body:u.Crop})),this.addControl("rotateButtonTooltip",new d({target:t.getElement(".rotate-btn"),body:u.Rotate})),this.addControl("bnwButtonTooltip",new d({target:t.getElement(".bnw-btn"),body:u.Bnw})),this.addControl("flipButtonTooltip",new d({target:t.getElement(".flip-btn"),body:u.Flip})),this.addControl("brightnessBarTooltip",new d({target:t.getElement(".brightness-bar"),body:u.Brightness})),t},_getBrightnessControl:function(){var e=this.getControl("brightnessSlider");return e||(e=this.addControl("brightnessSlider",new m({minValue:-40,maxValue:40,stepValue:1,value:0,domId:"brightness"}))).addEventListener("endEdit",this.brightnessChange.bind(this)),e},getBase64FromImgFile:function(e,t){var i=new FileReader;t=t.bind(this);i.onload=function(){var e=i.result;t(e)},i.readAsDataURL(e)},onRedraw:function(){var e=this.model;if(this.options.isNewMedia){var t=e.getChanges("userFile")||e.get("userFile");"string"==typeof t?this.createNewImgTag(t):this.getBase64FromImgFile(t,function(t){e.addChanges("userFile",t),this.createNewImgTag(t)})}else{var i,n,o=e.get("width"),s=e.get("height");if(this.options.isInLightbox){var r,l,c=a.generateImageReloadOptionsForMedia({mediaId:e.get("mid"),mediaType:e.get("media_type"),mediaWidth:o,mediaHeight:s,containerWidth:this.getParentViewContainer().getSize().width,containerHeight:document.body.getSize().height}),d=e.get("play").view;for(r=0,l=d.length;r<l;r++)d[r].alias===c.size&&(i=d[r].transient_url,n=d[r].size.split("x"),o>=s?(this.imageWidth=n[0],this.imageHeight=this.imageWidth*s/o):(this.imageHeight=n[1],this.imageWidth=this.imageHeight*o/s))}else i=a.getPreviewThumbnail({model:e,useOriginal:!0,container:this.getParentViewContainer(),containerHeight:document.body.getSize().height}).url;this.createNewImgTag(i)}},createNewImgTag:function(e){this.canvasEl=this.getElement("canvas"),this.context=this.canvasEl.getContext("2d");var t=new Image,i=this;t.crossOrigin="use-credentials",t.src=e,t.width=this.imageWidth,t.height=this.imageHeight,t.onload=function(){var e;i.isDestroyed()||(i.saveFirstPictureStateAsCanvas(this),i.options.isNewMedia||(i.imageHeight=this.height),(e=i.getElement("#editor-canvas"))&&(e.parentElement.setStyle("min-height","0px"),e.setAttribute("height",i.imageHeight),e.setAttribute("width",i.imageWidth)),i.context.drawImage(this,0,0,i.imageWidth,i.imageHeight),i.refreshImgTag(),i.setSize(i.imageWidth,i.imageHeight))}},refreshImgTag:function(){this.getElement("#editor-img").src=this.getElement("#editor-canvas").toDataURL()},_getImageAsDataUrl:function(){return this.getElement("#editor-canvas").toDataURL()},saveFirstPictureStateAsCanvas:function(t){var i=e.createElement("canvas",{id:"original-canvas",width:t.width,height:t.height,styles:{display:"none"}});i.getContext("2d").drawImage(t,0,0,t.width,t.height),this._operations.add(new n({type:"originalCanvas",id:this.currentOperationIndex,canvas:i})),l.log("----- currentOperationIndex first operation added",this.currentOperationIndex,"orig canvas")},buttonClicked:function(e){e.stopPropagation(),e.preventDefault();var t=e.target;switch(t.id){case"undo":this.undoOperation();break;case"redo":this.redoOperation();break;case"crop":this.startCrop();break;case"rotate":case"bnw":case"flip":this.addAndExecuteOperation(t.id)}},setViewCanvas:function(e){var t=this.getElement("#editor-canvas");t.height=e.height,t.width=e.width,t.getContext("2d").drawImage(e,0,0)},brightnessChange:function(e){var t=(e.dsModel||e.target).value,i=[],n=this._operations.at(this.currentOperationIndex).get("type");null===this.lastBrightnessOperationId&&"brightness"!==n||(this._operations.remove(this._operations.at(this.lastBrightnessOperationId)),this.setViewCanvas(this._operations.at(this.lastBrightnessOperationId-1).getCanvas()),i=this._operations.getOperationsAfterBrightness(this.lastBrightnessOperationId),this.currentOperationIndex=this._operations.length-1,l.log("----- currentOperationIndex to -1 total ops",this.currentOperationIndex,"brightness"),this.replayOperationsWithoutBrightness(i)),this.addAndExecuteOperation("brightness",{brightness:t})},replayOperationsWithoutBrightness:function(t){for(var i=0,n=t.length;i<n;i++)this.addAndExecuteOperation(t[i].get("type"),e.merge({replay:!0},t[i].get("params")))},addAndExecuteOperation:function(t,i){var o,s=null,a=!1,r=this.getElement("#"+t);r.disabled=!0,i&&i.brightness&&(s=i.brightness),i&&i.replay&&(a=i.replay),o=i&&i.canvas&&i.canvas instanceof HTMLCanvasElement?i.canvas:this.getElement("canvas"),this.currentOperationIndex++,l.log("----- currentOperationIndex incremented",this.currentOperationIndex,"----",t),this._operations.at(this.currentOperationIndex)&&this._operations.resetCollection(this.currentOperationIndex);var c=new n({id:this.currentOperationIndex,type:t,brightnessValue:s,params:i});"brightness"===t&&(this.lastBrightnessOperationId=this.currentOperationIndex),this._operations.add(c),this.executeOperation(c,o);var d=e.createElement("canvas",{width:o.width,height:o.height});d.getContext("2d").drawImage(o,0,0),c.setCanvas(d),this.model.dispatchEvent("onPictureHasChanged",[!0,this._getImageAsDataUrl()],this.model),a||this.refreshImgTag(),this.updateUndoRedoButtons(this.currentOperationIndex),r.disabled=!1},executeOperation:function(e,t){var i=t.getContext("2d");switch(e.get("type")){case"crop":this.cropOperation(t,i,e);break;case"rotate":this.rotateOperation(t,i);break;case"bnw":this.bnwOperation(t,i);break;case"flip":this.flipOperation(t,i);break;case"brightness":this.brightnessOperation(t,i,e.get("brightnessValue"))}},makeCanvasCopy:function(t){var i=e.createElement("canvas",{width:t.width,height:t.height});return i.getContext("2d").drawImage(t,0,0),i},rotateOperation:function(e,t){var i=this.makeCanvasCopy(e),n=Math.PI/2;e.width=i.height,e.height=i.width,t.save(),t.translate(i.height,0),t.rotate(n),t.drawImage(i,0,0),t.restore(),this.setSize(e.width,e.height)},flipOperation:function(e,t){var i=this.makeCanvasCopy(e);t.save(),t.scale(-1,1),t.translate(-e.width,0),t.fillStyle="#FFFFFF",t.clearRect(0,0,e.width,e.height),t.drawImage(i,0,0),t.restore()},bnwOperation:function(e,t){for(var i=t.getImageData(0,0,e.width,e.height),n=0;n<i.data.length;n+=4){var o=i.data[n]+i.data[n+1]+i.data[n+2];o/=3,i.data[n]=o,i.data[n+1]=o,i.data[n+2]=o}t.putImageData(i,0,0),this.bnwDone=!0,this.getElement("#bnw").disabled=!0},brightnessOperation:function(e,t,i){for(var n=t.getImageData(0,0,e.width,e.height),o=i/100*255,s=0;s<n.data.length;s+=4)n.data[s]=n.data[s]+o,n.data[s+1]=n.data[s+1]+o,n.data[s+2]=n.data[s+2]+o;t.putImageData(n,0,0)},undoOperation:function(){if(this.currentOperationIndex>0){var e=this.getElement("canvas"),t=e.getContext("2d"),i=this._operations.at(this.currentOperationIndex).get("type"),n=this._operations.at(this.currentOperationIndex-1).getCanvas();this.setCanvasDimensions(e,{width:n.width,height:n.height}),"crop"===i&&this.setSize(n.width,n.height),t.drawImage(n,0,0),this.refreshImgTag(),"bnw"===i&&(this.bnwDone=!1,this.getElement("#bnw").disabled=!1),"brightness"===i&&(this.lastBrightnessOperationId=null,this.getElement("#brightness").value=0),this.currentOperationIndex--,l.log("----- currentOperationIndex decremented",this.currentOperationIndex,"undo"),0===this.currentOperationIndex&&this.model.dispatchEvent("onPictureHasChanged",[!1,this._getImageAsDataUrl()],this.model),this.setSize(e.width,e.height)}this.updateUndoRedoButtons(this.currentOperationIndex)},redoOperation:function(){if(this.currentOperationIndex<this._operations.length){var e=this.getElement("canvas"),t=e.getContext("2d"),i=this._operations.at(this.currentOperationIndex+1),n=i.get("type"),o=i.getCanvas();switch(this.setCanvasDimensions(e,{width:o.width,height:o.height}),t.drawImage(o,0,0),this.refreshImgTag(),n){case"bnw":this.bnwDone=!0,this.getElement("#bnw").disabled=!0;break;case"brightness":this.lastBrightnessOperationId=this.currentOperationIndex,this.getElement("#brightness").value=i.get("brightnessValue");break;case"crop":this.setSize(o.width,o.height)}this.currentOperationIndex++,l.log("----- currentOperationIndex incremented",this.currentOperationIndex,"redo"),this.model.dispatchEvent("onPictureHasChanged",[!0,this._getImageAsDataUrl()],this.model),this.setSize(e.width,e.height)}this.updateUndoRedoButtons(this.currentOperationIndex)},setCanvasDimensions:function(e,t){e.width=t.width,e.height=t.height},updateUndoRedoButtons:function(e){var t=this.getElement("#undo"),i=this.getElement("#redo"),n=this._operations.length-1;e>0&&!0===t.disabled&&(t.disabled=!1),0===e&&!1===t.disabled&&(t.disabled=!0),e<n&&(i.disabled=!1),e===n&&(i.disabled=!0)},applyEditOperationsOnOriginalMedia:function(t){var i,n,o=this,s=this.model,a=new Image,r=this.options.isNewMedia?s.getChanges("userFile"):s.get("play").download_original_url.transient_url;a.crossOrigin="use-credentials",a.onload=function(){var s=e.createElement("canvas",{width:a.width,height:a.height});for(s.getContext("2d").drawImage(a,0,0,a.width,a.height),i=0,n=o.currentOperationIndex+1;i<n;i++)o.executeOperation(o._operations.at(i),s);t(s)},a.src=r},saveOriginalMediaToModel:function(){!0===this.originalImageUsedInEditor?this.saveCanvasToModel(this.getElement("canvas")):this.applyEditOperationsOnOriginalMedia(this.saveCanvasToModel.bind(this))},getMediaFileExtension:function(){var e,t=this.model;return t.has("media_file_ext")?t.has("media_file_ext"):t.has("preview_media_file_ext")?t.has("preview_media_file_ext"):(e=t.get("orig_name")||t.get("fileName")||t.getChanges("fileName"))?e.substring(e.lastIndexOf(".")+1):void 0},saveCanvasToModel:function(e){this._parentView&&this._parentView.unmask();var t=this.model;["jpeg","jpg"].indexOf(this.getMediaFileExtension())>=0?t.addChanges("userFile",e.toDataURL("image/jpeg")):t.addChanges("userFile",e.toDataURL()),t.addChanges("width",e.width),t.addChanges("height",e.height),this.options.isInLightbox?this._parentView&&this._parentView.dispatchEvent("mediaEdited",[{isNewMedia:this.options.isNewMedia,model:this.model}]):t.dispatchEvent("mediaFileSavedToModel")},startCrop:function(){var e=this.getElement("#editor-img");this.getElement(".editor-toolbar").addClassName("crop-mode");var t=this.getElement(".canvas-editor-container");this.cropView=new o({widgetId:this._widget?this._widget.id:null,width:e.width,height:e.height}),this.cropView.render(t),this.disableButtons(),this.addCropButtons(),this.addCropKeyboardShortcuts()},keypressCropHandler:function(e){l.log("event.keyCode: "+e.keyCode),13===e.keyCode&&this.applyCrop(),27===e.keyCode&&this.cancelCrop()},addCropKeyboardShortcuts:function(){l.warn("addCropKeyboardShortcuts"),e.extendElement(document.body).addEvent("keyup",this.keypressCropHandlerBound)},removeCropKeyboardShortcuts:function(){l.warn("removeKeyboardShortcuts"),e.extendElement(document.body).removeEvent("keyup",this.keypressCropHandlerBound)},disableButtons:function(){for(var e=this.getElements("button.btn.btn-default"),t=0,i=e.length;t<i;t++)e[t].setAttribute("disabled",!0);this.getElement("#brightness").setAttribute("disabled",!0)},addCropButtons:function(){var t=this.getElement(".editor-toolbar");e.createElement("button",{class:"apply-crop-btn btn btn-default",events:{click:this.applyCrop.bind(this)}}).inject(t),e.createElement("button",{class:"cancel-crop-btn btn btn-default",events:{click:this.cancelCrop.bind(this)}}).inject(t)},applyCrop:function(){this.cropView.destroy(),this.addAndExecuteOperation("crop",this.cropView.getInfos()),this.updateToolbarAfterCrop(),this.removeCropKeyboardShortcuts(),this.getElement(".editor-toolbar").removeClassName("crop-mode")},cancelCrop:function(){this.cropView.destroy(),this.updateToolbarAfterCrop(),this.updateUndoRedoButtons(this.currentOperationIndex),this.removeCropKeyboardShortcuts(),this.getElement(".editor-toolbar").removeClassName("crop-mode")},updateToolbarAfterCrop:function(){this.getElement("button.apply-crop-btn").remove(),this.getElement("button.cancel-crop-btn").remove();for(var e=this.getElements("button.btn.btn-default"),t=0,i=e.length;t<i;t++)"bnw-btn btn btn-default"===e[t].getAttribute("class")&&this.bnwDone||(e[t].disabled=!1);this.getElement("#brightness").disabled=!1},cropOperation:function(e,t,i){var n,o,s,a,r,l=this.makeCanvasCopy(e),c=this.getElement("#editor-canvas").getSize().width,d=this.getElement("#editor-img").getSize().width,m=i.params;if(c!==d&&(r=c/d,m.width*=r,m.height*=r,m.left*=r,m.top*=r),this.getElement("#editor-canvas")!==e){var u=i.get("beforeCropCanvas"),h=e.width/u.width;n=m.width*h,o=m.height*h,s=m.left*h,a=m.top*h}else n=m.width,o=m.height,s=m.left,a=m.top,i.set("beforeCropCanvas",this.makeCanvasCopy(e)),this.setSize(n,o);e.width=n,e.height=o,t.drawImage(l,-s,-a)},setSize:function(e,t){this.options.isInLightbox||(e+=22,t+=22),e<560&&(e=560),t+=50,this.container.setStyles({width:e,height:t})},onSetModel:function(e,t,i){this.reactTo(i,"saveEditedMediaFileToModel",this.saveOriginalMediaToModel),this.reactTo(i,"onNewMediaUploaded",this.onRedraw),this.reactTo(i,"onSync:update",this.onRedraw)}})}),define("DS/SwymUIComponents/script/feature/community/media/edit/content-edit-media-lightbox",["UWA/Core","UWA/Event","UWA/Utils/Client","DS/SwymUIComponents/script/feature/community/media/view/abstract-lightbox-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/view/media-lightbox","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/edit/content-edit-media-lightbox","DS/SwymUIComponents/script/feature/community/media/editor/view/image-editor-view","DS/SwymUICore/script/lib/view/generic/swym-view","DS/UIKIT/SuperModal","DS/UIKIT/Input/Button"],function(e,t,i,n,o,s,a,r,l,c){"use strict";return n.extend({name:"content-edit-media-lightbox",_viewToUpdate:null,displayActionsOnHeader:!1,titleInteraction:!1,getContentView:function(){return[this._getImageEditor(),this._createPublishBar()]},_getImageEditor:function(){var e=this.getChildView("imageEditorView");return e||(e=this.addChildView("imageEditorView",{Class:"DS/SwymUIComponents/script/feature/community/media/editor/view/image-editor-view",model:this.model,isNewMedia:this.options.isNewMedia,isInLightbox:!0})),e},removeContentView:function(){var e=this.getChildView("imageEditorView");e&&e.destroy()},setup:function(e){this._parent.apply(this,arguments),e.hasOwnProperty("viewToUpdate")&&(this._viewToUpdate=e.viewToUpdate),this.addEvent("mediaEdited",this._onMediaEdited)},_onMediaEdited:function(e){this.destroy(),this._viewToUpdate&&this._viewToUpdate.dispatchEvent("mediaEdited",e)},_saveNewMediaEdited:function(){if(this.options.isNewMedia)this.getChildView("imageEditorView").dispatchEvent("saveMediaEdited"),this.mask();else{var e=new l({renderTo:window.document&&window.document.body}),t=this;e.confirm(o.DefinitiveChangement,o.AreYouSure,function(e){e&&(t.getChildView("imageEditorView").dispatchEvent("saveMediaEdited"),t._viewToUpdate.mask(),t.mask())})}},_createPublishBar:function(){return{class:"publish-section",html:{class:"right-elements",html:[{tag:"div",class:"buttons",html:[this.addControl("publishButton",new c({value:s.Publish,className:"primary publish-button",icon:"check",events:{onClick:function(){this.getChildView("imageEditorView").currentOperationIndex?this._saveNewMediaEdited():this.destroy()}.bind(this)}})),this.addControl("cancelButton",new c({value:s.Cancel,className:"default btn-cancel",styles:{width:""},icon:"wrong",events:{onClick:function(){this.destroy()}.bind(this)}}))]}]}}}})}),define("DS/SwymUIComponents/script/feature/community/media/library/library-list-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/library/media-library-view","DS/SwymUIComponents/script/feature/community/media/view/media-list-view","DS/SwymUIComponents/script/feature/community/media/view/media-tile-view","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUIComponents/script/feature/community/media/edit/upload/file-browser-upload-view","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/community/media/model/media-file-extension-model","DS/SwymUIComponents/script/feature/community/media/view/media-tooltip-view","DS/SwymUIComponents/script/feature/community/media/edit/upload/upload-manager","DS/SwymUIComponents/script/feature/community/media/edit/upload/drag-and-drop-upload-view","DS/Logger/Logger"],function(e,t,i,n,o,s,a,r,l,c,d,m){"use strict";var u=o.extend({_modelName:"plus-media"});return i.extend({name:"library-list-view",modelViewClass:{media:n,"plus-media":s},domEvents:{"click .media-no-result":"_onEmptyMediaClick"},imageReloadOptions:{useVariableSizeSprite:!0,selector:'img[data-type="VariableSizeMediaThumbnail"]',nonReloadedImagesOnly:!0},onItemClick:function(){},_onEmptyMediaClick:function(){var e=this._uploadManager.getUploader("fileExplorer");e&&e._onAttachmentIconClick()},_mediaToBeUploadedArray:[],_mediaCollectionSelected:[],_mediaFileExtension:null,_addEmptyView:!0,modelViewsCfg:function(t){var i=this._parent.apply(this,arguments),n={};switch(t.getModelName()){case"media":n={canBeSelected:!0,events:{onRender:function(e){m.log("is being rendered");var t=e.container;if(t){for(var i=!1,n=e.model.get("mid"),o=0,s=this._mediaCollectionSelected.length;o<s;o++)if(this._mediaCollectionSelected[o].get("mid")===n){i=!0;break}i&&t.addClassName("media-selected")}}.bind(this),onClick:function(e){m.log("media has been clicked and selected");var t=e.container;n=e.model,t&&t.toggleClassName("media-selected");var i=t.hasClassName("media-selected");if(n)if(i)this._mediaCollectionSelected.push(n);else{for(var n="",o=e.model.get("mid"),s=-1,a=0,r=this._mediaCollectionSelected.length;a<r;a++)if((n=this._mediaCollectionSelected[a]).get("mid")===o){s=a;break}s>-1&&this._mediaCollectionSelected.splice(s,1)}this.dispatchEvent("newMediaSelected",[this._mediaCollectionSelected])}.bind(this)}};break;case"plus-media":n={thumbnailMode:!0,events:{onRender:function(e){m.log("plus media has been rendered"),this._uploadManager.addUploader("fileExplorer",e)}.bind(this)}}}return e.merge(n,i)},_collectionEvents:{onSync:"_addPlusModel"},_communityId:null,_uploadManager:null,defaultOptions:{uploadManagerClass:c,dragZoneSelector:".scroll-library-list",debounceDelay:500},setup:function(e){e.useDynamicGrid=!0;var t=this.getOption("uploadManagerClass");this._uploadManager=new t({view:this,model:this.model}),this._mediaFileExtension=r.getInstance(),this.listenTo(this._uploadManager,"onUpload",this._newMediaUploaded),this._mediaToBeUploadedArray=[],this._mediaCollectionSelected=[],this._parent.apply(this,arguments)},_addPlusModel:function(){if(this.collection){var e=this.collection.at(0);if(!e||"plus-media"!==e.getModelName()){var t=new u({id:"fakeid",mid:"fakeid"});return this.collection.add(t,{at:0}),!0}}},_updateContainer:function(){if(!0!==this._addPlusModel())return this._parent.apply(this,arguments)},_getDndView:function(){var e=this.getChildView("dnd");return e||(e=this.addChildView("dnd",{Class:d,events:{onInjected:function(){m.log("dnd view got injected"),this._getDndView().addDragDetectionZone(this.container.getClosest(this.getOption("dragZoneSelector")));var e=this.getElement(".media-no-result")?this.getElement(".media-no-result").getElement(".fonticon-help"):this.getElement(".fonticon-help");if(e)this.addChildView("mediaTooltipView",new l({model:this._mediaFileExtension,target:e}))}.bind(this)}}),this._uploadManager.addUploader("dnd",e)),e},addUploader:function(e,t){this._uploadManager.addUploader(e,t)},_isCollectionEmpty:function(){return!(this.collection&&(1===this.collection.length&&"plus-media"!==this.collection.first().getModelName()||this.collection.length>1))},_getEmptyContentContainer:function(){return this.container},_refreshBodyIncrementally:function(e){return this._checkEmptyness(e),this._parent.apply(this,arguments)},_createEmptyContent:function(){return e.createElement("div",{class:"media-no-result",html:[{html:{tag:"span",class:"fonticon fonticon-upload-cloud fonticon-6x"}},{class:"upload-label",html:[{tag:"span",html:this.collection&&"#all"===this.collection.exaleadQuery?t.NoMediaAvailable:t.NoMediaSearch},e.Utils.Client.Features.touchEvents?{}:{tag:"span",class:"fonticon fonticon-1-5x fonticon-help"}]}]})},_createContent:function(){return[this._parent.apply(this,arguments),this._getDndView()]},_newMediaUploaded:function(t){var i,n,o,s,r=t?t.length:0;for(m.log("_newMediaUploaded",t),i=0;i<r;i++)s={title:(o=t[i]).file.customData.title,media_type:o.file.customData.type,fileName:o.file.fileName||o.file.browserFileData.fileName,userFile:o.dataURI?o.dataURI:o.file.browserFileData},(n=new a({})).addChanges(e.extend(s,o.attributes)),this._mediaToBeUploadedArray.push(n);this.dispatchEvent("newMediaAdded",[this._mediaToBeUploadedArray,this._mediaCollectionSelected])},sendCollectionTagsToTagger:function(){}})}),define("DS/SwymUIComponents/script/feature/community/community/view/community-tags-update-view",["DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUIComponents/script/utils/swym-vue","DS/SwymUIComponents/script/feature/core/modal/super-modal","DS/TagNavigator/userTags/UserTagsModel","DS/TagNavigator/userTags/UserTagsView","DS/SwymUICore/script/lib/6wpanel/community-tags-manager","DS/SwymUICore/script/utils/usage-tracker","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-tags-update-view"],(e,t,i,n,o,s,a,r)=>{const{Vue:l}=t,c=l.extend({template:`<vu-btn color="primary" @click="addTags" class="add-tag-btn">${r.Add}</vu-btn>`}),d=l.extend({template:'<SwymCommunityTagsSelected :tags="tags" :NLS="NLS" @tagSelected="tagSelected" @tagClosed="tagClosed" />'});return e.extend({tagsManager:null,selectedTags:null,userTagsView:null,addTagsButton:null,superModal:null,setup(...e){return this.tagsManager=s.getInstance(),this._parent(...e)},_createContent(){const e=this,{model:t}=this;return this.selectedTags||(this.selectedTags=new d({mounted(){this.fetchTags()},data:()=>({tags:[],NLS:r}),methods:{tagSelected(e){console.log("SELECTED",e)},tagClosed(t){e.deleteTag(t,()=>{const e=this.tags.findIndex(e=>e.object===t.object);this.tags.splice(e,1),a.trackPageEvent({category:"CommunityTags",label:"removeCommunityTagsInSettings",view:"community-tags-update-view",event:"click"})})},async fetchTags(){this.tags=await e.tagsManager.getCommunityTags({communitySubjectURI:t.getSubjectURI()})},pushTags(e){e.forEach(e=>{const t=this.tags.findIndex(t=>t.object===e.object);t>-1?this.tags.splice(t,1,e):this.tags.push(e)})}}}),this.selectedTags.$mount()),this.userTagsView||(this.userTagsView=new o({onCommit:(...e)=>{console.log("COMMITTING?",...e)},model:new n({subjects:[{uri:t.getSubjectURI()}]}),labelInfo:{title:r.AddTags,required:!1},fedSearchSuggestions:!0}).render()),this.addTagsButton||(this.addTagsButton=new c({methods:{addTags(){if(e.userTagsView){const i=e.tagsManager.getInputTags(e.userTagsView);if(e.selectedTags){if(i.length+e.selectedTags.tags.length>30)return void e.alert("error",r.replace(r.MaxTagsError,{number:30}));a.trackPageEvent({category:"CommunityTags",label:"addCommunityTagsInSettings",view:"community-tags-update-view",event:"click"}),e.selectedTags.pushTags(i),e.userTagsView.clear(),t.addChanges("tagsChanged",!0)}}}}}),this.addTagsButton.$mount()),[{tag:"h5",html:r.CommunityTags},{tag:"p",html:r.CommunityTagsDescription},{class:"tags-wrapper",html:[{class:"add-tags-wrapper",html:[this.userTagsView,{class:"add-tags-btn-wrapper",html:[this.addTagsButton.$el]}]},this.selectedTags.$el]}]},deleteTag(e,t){this.superModal||(this.superModal=new i({closable:!0})),this.superModal.confirm(r.WarningDescription,r.WarningTitle,e=>{!0===e&&(this.model.addChanges("tagsChanged",!0),t())},r.Yes,r.No)},async save(){try{const e=this.model.getSubjectURI(),t=[];return this.selectedTags&&this.selectedTags.tags.forEach(e=>{t.push({sixw:e.sixw,object:e.object})}),await this.tagsManager.saveTags({communitySubjectURI:e,tags:t}),!0}catch(e){return console.error("err",e),!1}},async resetAllViews(){return this.selectedTags&&await this.selectedTags.fetchTags(),this.userTagsView&&this.userTagsView.clear(),this.model.removeChanges("tagsChanged"),!0},destroy(...e){return this.userTagsView.destroy(),this.userTagsView=null,this.addTagsButton.$destroy(),this.addTagsButton=null,this.selectedTags.$destroy(),this.selectedTags=null,this._parent(...e)}})}),define("DS/SwymUIComponents/script/feature/community/community/view/community-edit-request-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-edit-request-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-visibility-settings-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/community/model/community-request-model","DS/SwymUIComponents/script/feature/core/modal/modal","DS/UIKIT/Input/Button","DS/UIKIT/Input/Text","DS/UIKIT/Input/Toggle","DS/UIKIT/Form"],function(e,t,i,n,o,s,a,r,l,c){"use strict";return n.extend({_modelClass:o,name:"community-edit-request-view",defaultOptions:{readOnly:!1},_createContent:function(){var d=this.model;if(d){var m;(!1===this.getOption("readOnly")||d.get("additional_comment")&&this.getOption("readOnly"))&&(m=this.addControl("commentsForm",new c({fields:[{type:"textarea",name:"additional_comment",placeholder:t.ThisFieldIsMandatoryOnlyIfTheRequestIsNotAccepted,rows:3,required:!0,disabled:this.getOption("readOnly"),value:this.getOption("readOnly")?new String(d.get("additional_comment",{escapeHTML:!1})):"",events:{onChange:function(){d.addChanges("additional_comment",this.getValue().trim())}}}]})));var u,h,p,g,w=n.extend({_modelClass:o,attributes:{tag:"div"},_createContent:function(){return e.createElement("div",{html:[{tag:"label",html:t.CommunityName,for:"title"},{tag:"div",styles:{margin:"10px"},html:new r({name:"title",className:"title",disabled:!0,value:new String(d.get("title",{escapeHTML:!1}))})},{tag:"label",html:t.VisibilityPreferences,for:"visibility"},{tag:"div",styles:{margin:"10px"},html:[new l({name:"visiblity",value:"Public",label:i.Public,className:"primary",disabled:!0,checked:"1"===d.get("access")}).check(),new l({name:"visiblity",value:"Private",label:i.Private,className:"primary",disabled:!0,checked:"0"===d.get("access")}),new l({name:"visiblity",value:"Secret",label:i.Secret,className:"primary",disabled:!0,checked:"4"===d.get("access")})]},{tag:"label",html:t.CommunityDescription,for:"description"},{tag:"div",styles:{margin:"10px"},html:new r({name:"description",className:"description",multiline:!0,disabled:!0,value:new String(d.get("description",{escapeHTML:!1}))})},{tag:"label",html:t.ExpectedBenefits,for:"benefits"},{tag:"div",styles:{margin:"10px"},html:new r({name:"benefits",className:"benefits",multiline:!0,disabled:!0,value:new String(d.get("benefits",{escapeHTML:!1}))})},{tag:"label",html:t.CommunityOwner,for:"owner"},{tag:"div",styles:{margin:"10px"},html:new r({name:"owner",className:"owner",disabled:!0,value:d.get("primary_community_owner").first_name+" "+d.get("primary_community_owner").last_name})},m?{tag:"label",html:t.GeneralCommentsRemarks,for:"additional_comment"}:"",m?{tag:"div",styles:{margin:"10px"},html:m}:""]})}});return this.getOption("readOnly")?"1"===d.get("status")&&(g=this.addControl("acceptButton",new a({value:t.Gotothiscommunity,className:"primary",events:{onClick:function(){var e=this,t=this.model;require(["DS/SwymUICore/script/utils/navigation"],function(i){e.getControl("editRequestModal").hide(),i.goToUrl("admin-tenant/community:"+t.get("community_id"))})}.bind(this)}}))):(u=this.addControl("declineButton",new a({value:t.DeclineRequest,className:"error",events:{onClick:function(){this.getControl("commentsForm").validate()&&(this.getControl("acceptButton").setDisabled(),this.getControl("reviewButton").setDisabled(),this.getControl("declineButton").setDisabled(),d.set(d.getChanges()),d.action("decline",{onComplete:function(){this.dispatchEvent("CommunityRequestRejected",d),this.getControl("editRequestModal").hide(),this.alert("success",t.TheCommunityRequestHasBeenSuccessfullyDeclined)}.bind(this),onFailure:function(){}.bind(this)}))}.bind(this)}})),h=this.addControl("reviewButton",new a({value:t.SendBackForReview,events:{onClick:function(){this.getControl("commentsForm").validate()&&(this.getControl("acceptButton").setDisabled(),this.getControl("reviewButton").setDisabled(),this.getControl("declineButton").setDisabled(),d.set(d.getChanges()),d.action("sendback",{onComplete:function(){this._parentView.destroy(),this.getControl("editRequestModal").hide(),this.alert("success",t.TheCommunityRequestHasBeenSuccessfullySentBackForReview)}.bind(this),onFailure:function(){}.bind(this)}))}.bind(this)}})),p=this.addControl("acceptButton",new a({value:t.AcceptCreate,className:"primary",events:{onClick:function(){this.getControl("acceptButton").setDisabled(),this.getControl("reviewButton").setDisabled(),this.getControl("declineButton").setDisabled(),d.action("accept",{onComplete:function(e,i){this.dispatchEvent("CommunityRequestAccepted",d),this.getControl("editRequestModal").hide(),this.alert("success",t.TheCommunityHasBeenSuccessfullyCreated),i.result&&i.result.community_id&&require(["DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/feature/core/user/model/currentuser-model"],function(e,t){t.getInstanceFetched(function(t){var n="settings";"1"!==t.get("tenant_su")&&(n="members"),e.goToUrl("admin-tenant/community:"+i.result.community_id+"/"+n)})})}.bind(this),onFailure:function(){}.bind(this)})}.bind(this)}}))),this.addControl("editRequestModal",new s({header:"<h4>"+t.CommunityRequestDetails+"</h4>",body:[this.addChildView("communityRequestDetailsView",{Class:w,model:d})],footer:this.getOption("readOnly")?"1"===d.get("status")?[g]:null:[u,h,p],closable:!0,events:{onHide:function(){this.destroy()}.bind(this)}}))}},show:function(){this.getControl("editRequestModal").show()},setup:function(e){return e&&Object.prototype.hasOwnProperty.call(e,"parentView")&&(this._parentView=e.parentView),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/core/tenant/view/whats-new-tab-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/tenant/view/swym-control-center-view","DS/SwymUICore/script/feature/community/community/collection/community-request-collection","DS/SwymUICore/script/feature/community/report-abuse/collection/report-abuse-collection-v2","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUIComponents/script/feature/community/community/view/community-edit-request-view","DS/SwymUIComponents/script/feature/community/community/view/community-request-view","DS/SwymUIComponents/script/feature/community/report-abuse/view/report-abuse-view","DS/SwymUIComponents/script/feature/core/pagination/view/paging-toolbar-view","DS/SwymUIComponents/script/feature/core/tenant/view/super-user-button-view","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/utils/navigation","DS/UIKIT/Mask"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g){"use strict";return s.extend({name:"whats-new-tab-view",_communityRequest:null,_communityHistoryRequest:null,_superUserButton:null,_reportAbuse:null,_wrapperEl:null,setup:function(){this._parent.apply(this,arguments),this._init(),a.getInstance().isFeatureActivated("activate_community_request")&&this._communityRequest.handler(),this._communityHistoryRequest.handler(),this._superUserButton.handler(),a.getInstance().isFeatureActivated("activate_report_abuse_management")&&this._reportAbuse.handler()},_maskSectionViewWrapper:function(e){e&&e.wrapperEl&&g.mask(e.wrapperEl)},_unmaskSectionViewWrapper:function(e){e&&e.wrapperEl&&g.unmask(e.wrapperEl)},_maskReportAbuseViewWrapper:function(){this._reportAbuse&&this._reportAbuse.wrapperEl&&g.mask(this._reportAbuse.wrapperEl)},_unmaskReportAbuseViewWrapper:function(){this._reportAbuse&&this._reportAbuse.wrapperEl&&g.unmask(this._reportAbuse.wrapperEl)},_init:function(){var s=this;s._communityRequest={CommunityRequestCollectionView:o.extend({name:"community-request-collection-view",_collectionClass:i,modelViewClass:l,_collectionEvents:{onRequest:function(){s._maskSectionViewWrapper(s._communityRequest)},onSync:function(){s._unmaskSectionViewWrapper(s._communityRequest)}},_createModelView:function(){var e=this._parent.apply(this,arguments);return e.addEvent("onCommunityRequestClicked",this._onCommunityRequestClicked,this),e},_onCommunityRequestClicked:function(e,t){var i=new r({model:e,parentView:t}),n=function(e){s._communityRequest.communityRequestCollection.remove(e),s._communityHistoryRequest&&s._communityHistoryRequest.communityRequestCollection.refresh()};i.render(document.body),i.show(),i.addEvents({CommunityRequestAccepted:n,CommunityRequestRejected:n})},bodyAttributes:{tag:"table",class:"table-container"},modelViewsCfg:{attributes:{tag:"tr",class:"row-container"}}}),rearrangeTable:function(i){if(i.getModelViews().length>0){if(!i._body.getElement("thead")){var n=e.createElement("thead",{html:{tag:"tr",class:"report-abuse title",html:[{tag:"th",text:t.Name},{tag:"th",text:t.Communityname},{tag:"th",text:t.Date},{tag:"th",text:t.CommunityRequestType}]}}),o=e.createElement("tbody",{html:i._body.getElements("tr")});i._body.setContent([n,o])}}else i._body.setContent(t.Thereisnopendingcommunityrequest);s._unmaskSectionViewWrapper(s._communityRequest)},handler:function(){s._communityRequest.communityRequestCollection=new i(null,{mode:"all",limit:10}),s._communityRequest.communityRequestCollectionView=new s._communityRequest.CommunityRequestCollectionView({collection:s._communityRequest.communityRequestCollection,widget:s._widget}),s._communityRequest.pagingToolbar=new d({collection:s._communityRequest.communityRequestCollection}),s._communityRequest.communityRequestCollection.goToPage(1),s._communityRequest.wrapperEl=e.createElement("div",{class:"whats-new-community-wrapper",styles:{"min-height":"200px"}}),s._maskSectionViewWrapper(s._communityRequest),e.createElement("h4",{html:t.Pending}).inject(s._communityRequest.wrapperEl),s._communityRequest.communityRequestCollectionView.addEvent("onRefresh",s._communityRequest.rearrangeTable),s._communityRequest.communityRequestCollectionView.render(s._communityRequest.wrapperEl),s._communityRequest.pagingToolbar.render(s._communityRequest.wrapperEl)}},s._communityHistoryRequest={CommunityRequestCollectionView:o.extend({name:"community-history-request-collection-view",_collectionClass:i,modelViewClass:l,_collectionEvents:{onRequest:function(){s._maskSectionViewWrapper(s._communityHistoryRequest)},onSync:function(){s._unmaskSectionViewWrapper(s._communityHistoryRequest)}},_createModelView:function(){var e=this._parent.apply(this,arguments);return e.addEvent("onCommunityRequestClicked",this._onCommunityRequestClicked,this),e},_onCommunityRequestClicked:function(e,t){var i=new r({model:e,parentView:t,readOnly:!0});i.render(document.body),i.show()},bodyAttributes:{tag:"table",class:"table-container"},modelViewsCfg:{attributes:{tag:"tr",class:"row-container"}}}),rearrangeTable:function(i){if(i.getModelViews().length>0){if(!i._body.getElement("thead")){var n=e.createElement("thead",{html:{tag:"tr",class:"report-abuse title",html:[{tag:"th",text:t.Name},{tag:"th",text:t.Date},{tag:"th",text:t.Status},{tag:"th",text:t.CommunityRequestType}]}}),o=e.createElement("tbody",{html:i._body.getElements("tr")});i._body.setContent([n,o])}}else i._body.setContent(t.Thereisnocommunityrequesttreated);s._unmaskSectionViewWrapper(s._communityHistoryRequest)},handler:function(){s._communityHistoryRequest.communityRequestCollection=new i(null,{mode:"all",limit:10,status:[0,1,4]}),s._communityHistoryRequest.communityRequestCollectionView=new s._communityHistoryRequest.CommunityRequestCollectionView({collection:s._communityHistoryRequest.communityRequestCollection,widget:s._widget}),s._communityHistoryRequest.pagingToolbar=new d({collection:s._communityHistoryRequest.communityRequestCollection}),s._communityHistoryRequest.communityRequestCollection.goToPage(1),s._communityHistoryRequest.wrapperEl=e.createElement("div",{class:"whats-new-community-wrapper",styles:{"min-height":"200px"}}),s._maskSectionViewWrapper(s._communityHistoryRequest),e.createElement("h4",{html:t.Treatedcommunitycreationrequests}).inject(s._communityHistoryRequest.wrapperEl),s._communityHistoryRequest.communityRequestCollectionView.addEvent("onRefresh",s._communityHistoryRequest.rearrangeTable),s._communityHistoryRequest.communityRequestCollectionView.render(s._communityHistoryRequest.wrapperEl),s._communityHistoryRequest.pagingToolbar.render(s._communityHistoryRequest.wrapperEl)}},s._superUserButton={handler:function(){u.getInstanceFetched(function(i){s._superUserButton.superUserButtonView=new m({model:i,widget:s._widget}),s._superUserButton.wrapperEl=e.createElement("div",{class:"whats-new-su-wrapper"}),e.createElement("h4",{html:t.Community}).inject(s._superUserButton.wrapperEl),s._superUserButton.superUserButtonView.render(s._superUserButton.wrapperEl)})}},s._reportAbuse={ReportAbuseCollectionView:o.extend({_collectionClass:n,_collectionEvents:{onRequest:s._maskReportAbuseViewWrapper.bind(s),onSync:s._unmaskReportAbuseViewWrapper.bind(s)},name:"report-abuse-collection-view",modelViewClass:c,bodyAttributes:{tag:"table",class:"table-container"},modelViewsCfg:{attributes:{tag:"tr",class:"row-container"}}}),rearrangeTable:function(i){if(i.getModelViews().length>0){if(!i._body.getElement("thead")){var n=e.createElement("thead",{html:{tag:"tr",class:"report-abuse title",html:[{tag:"th",text:t.Name},{tag:"th",text:t.Date},{tag:"th",text:t.Type},{tag:"th",text:t.Title},{tag:"th",text:t.ReportType},{tag:"th",text:t.Comment}]}}),o=e.createElement("tbody",{html:i._body.getElements("tr")});i._body.setContent([n,o])}}else i._body.setContent(t.Thereisnoreportabuse);s._unmaskReportAbuseViewWrapper()},handler:function(){s._reportAbuse.reportAbuseCollection=new n(null,{mode:"all",limit:10,pageMode:"pageStartAtZero"}),s._reportAbuse.reportAbuseCollectionView=new s._reportAbuse.ReportAbuseCollectionView({collection:s._reportAbuse.reportAbuseCollection,widget:s._widget}),s._reportAbuse.pagingToolbar=new d({collection:s._reportAbuse.reportAbuseCollection}),s._reportAbuse.reportAbuseCollection.goToPage(1),s._reportAbuse.wrapperEl=e.createElement("div",{class:"whats-new-report-wrapper",styles:{"min-height":"200px"}}),s._maskReportAbuseViewWrapper(),e.createElement("h4",{html:t.Report}).inject(s._reportAbuse.wrapperEl),s._reportAbuse.reportAbuseCollectionView.addEvent("onRefresh",s._reportAbuse.rearrangeTable),s._reportAbuse.reportAbuseCollectionView.render(s._reportAbuse.wrapperEl),s._reportAbuse.pagingToolbar.render(s._reportAbuse.wrapperEl)}}},_createContent:function(){return[a.getInstance().isFeatureActivated("activate_community_request")?e.createElement("div",{styles:{"padding-bottom":"20px"},html:this._communityRequest.wrapperEl}):"",a.getInstance().isFeatureActivated("activate_community_request")?e.createElement("div",{styles:{"padding-bottom":"20px"},html:this._communityHistoryRequest.wrapperEl}):"",e.createElement("div",{class:"row",styles:{margin:"0px"},html:[a.getInstance().isFeatureActivated("activate_report_abuse_management")?{class:"col-md-9",styles:{"padding-left":"0px"},html:this._reportAbuse.wrapperEl}:"",{class:a.getInstance().isFeatureActivated("activate_report_abuse_management")?"col-md-3":"",html:this._superUserButton.wrapperEl}]})]}})}),define("DS/SwymUIComponents/script/feature/community/wiki/wiki-view",["DS/SwymUICore/script/feature/community/wiki/model/wiki-model","DS/SwymUIComponents/script/feature/core/ui-components/list/list-item/item-view"],function(e,t){return t.extend({_modelClass:e,name:"wiki-view",className:"community-content-wrapper content-item new",defaultOptions:{detailedViewClass:"DS/SwymUIComponents/script/feature/community/wiki/view/wiki-detailed-view",editViewClass:"DS/SwymUIComponents/script/feature/community/wiki/edit/wiki-edit-view"},_createDetailedView(...e){const t=this;if(this.setOption("detailedViewEvents",{onScrollToElement(e){t.dispatchEvent("onScrollToElement",e)}}),void 0!==this.getOption("showTreeIcon")){let e=this.getOption("detailedViewOptionsAttributes")||[];Array.isArray(e)||(e=[e]),this.setOption("detailedViewOptionsAttributes",[...e,"showTreeIcon"])}return this._parent(...e)}})}),define("DS/SwymUIComponents/script/feature/community/social-event/view/note-takers-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUIComponents/script/utils/swym-vue","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/user/model/currentuser-model","i18n!DS/SwymUIComponents/assets/nls/feature/community/social-event/social-event-view","DS/SwymUICore/script/lib/event-manager","DS/SwymUICore/script/utils/usage-tracker"],function(e,t,i,n,o,s,a,r){"use strict";const{Vue:l}=i,c=l.extend({props:{noteTaker:{type:Object,default:()=>{}},baseUrl:String,currentUser:{type:Object,default:()=>{}},publicationState:String},data(){return{noteTakerImgUrl:this.baseUrl+"/api/user/getpicture/login/"+this.noteTaker.login,Nls:s,currentUserLogin:this.currentUser.get("login")}},computed:{backgroundStyle(){return{"background-image":`url("${this.noteTakerImgUrl}")`}}},methods:{},template:'\n\t\t\t\t<div>\n\t\t\t\t\t<div class="heading">{{ Nls.NoteTaker }}</div>\n\t\t\t\t\t<div class="section-wrapper">\n\t\t\t\t\t\t<div class="note-taker-img"\n\t\t\t\t\t\t\tdata-content-type="person"\n\t\t\t\t\t\t\t:data-login="noteTaker.login"\n\t\t\t\t\t\t\t:style="backgroundStyle">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<a class="note-taker-name link" data-content-type= "person" :data-login = "noteTaker.login">\n\t\t\t\t\t\t\t{{noteTaker.first_name}}  {{noteTaker.last_name}}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t<div v-if="currentUserLogin === noteTaker.login || publicationState === \'PUBLISHED\'" class="reporting-wrapper">\n\t\t\t\t\t\t\t<span class="drafted"> {{ publicationState === \'DRAFT\' ? Nls.Drafted : \'\' }} </span>\n\t\t\t\t\t\t\t<vu-btn @click="$emit(\'switch-to-report-mode\')">\n\t\t\t\t\t\t\t\t<span class="fonticon fonticon-doc-text-add">\n\t\t\t\t\t\t\t\t</span>{{ publicationState === \'PUBLISHED\' ? Nls.EditReport : Nls.Report }}\n\t\t\t\t\t\t\t</vu-btn>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>'});return t.extend({name:"note-takers-view",component:null,setup(e){return this.currentUser=o.getInstance(),this.model=e.model,this._parent.apply(this,arguments)},_createContent(){return this.component||(this.component=new c({propsData:{noteTaker:this.model.get("scribe"),baseUrl:n.getBaseUrl(),currentUser:this.currentUser,publicationState:this.model.get("publication_state")}}),this.component.$mount()),this.component.$on("switch-to-report-mode",()=>{const e=this.model.get("publication_state"),t="PUBLISHED"!==e,i=t&&"DRAFT"===e;t&&"DRAFT"!==e?r.trackPageEvent({category:"Rendezvous",label:"startReport",view:"note-takers-view",event:"click"}):i&&r.trackPageEvent({category:"Rendezvous",label:"startEditDraftReport",view:"note-takers-view",event:"click"}),a.dispatchEvent("switchToReportMode",[],!0)}),this.component.$el}})}),define("DS/SwymUIComponents/script/feature/community/social-event/view/pres-support-viewer-collection-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUICore/script/feature/community/social-event/collection/pres-support-collection","DS/SwymUIComponents/script/feature/community/social-event/view/pres-support-viewer","DS/WAFData/WAFData","DS/SwymUICore/script/utils/platform-utils","DS/SwymUICore/script/feature/core/config/bootstrap-model","i18n!DS/SwymUIComponents/assets/nls/feature/community/social-event/social-event-view"],function(e,t,i,n,o,s,a,r){return t.extend({_collectionClass:i,modelViewClass:n,hasSetup:!1,modelViewsCfg:function(){return{widget:this.widget}},_collectionEvents:{onChange:"_onContentChanged",onRemove:"_onRemove"},setup:function(e){if(this.widget=e.widget,!this.hasSetup){this.hasSetup=!0;const e=this,t=this.collection.buildFedSearchQuery(),i=a.getInstance().get("config").tenant.id;s.getFedsearchURL(i).then(function(n){o.authenticatedRequest(n+"/search",{type:"json",method:"POST",timeout:6e4,data:JSON.stringify({with_indexing_date:!0,with_synthesis:!0,with_nls:!1,label:"3DSearch-skd1",locale:"en",with_synthesis_hierarchical:!0,query:t,refine:{},order_by:"desc",order_field:"relevance",nresults:40,start:"0",source:["swym","3dplan","drive"],tenant:i}),headers:{"Content-Type":"application/json"},onComplete:t=>{e.hasSetup=!1;const i=t&&t.results;e.collection&&i&&i.length&&e.collection._models.filter(e=>"url"!==e.get("type")).forEach(t=>{let n=e._getDataById(i,t.get("id"));n&&(n.label&&t.set("label",n.label),n.preview_url&&t.set("preview_url",n.preview_url))})},onFailure:e=>{console.error(e)}})})}this._parent.apply(this,arguments)},_getDataById:function(e,t){let i=e.find(e=>{return this._getFacetByName(e.attributes,"resourceid").value===t});if(i&&i.attributes){const e=this._getFacetByName(i.attributes,"ds6w:label"),t=this._getFacetByName(i.attributes,"preview_url");return{label:e&&e.value,preview_url:t&&t.value}}return{}},_getFacetByName:function(e,t){return e.find(e=>e.name===t)},_createContent:function(){const t=this._parent.apply(this,arguments),i=this.collection.length;return 0===i?null:{class:"presentation-support-viewer-collection-view",html:[e.createElement("div",{class:"heading",html:i>1?r.PresentationSupports:r.PresentationSupport}),t]}},_onRemove:function(e){this.dispatchEvent("onPresentationSupportRemove")},_onContentChanged:function(){this.dispatchEvent("onContentChange")}})}),define("DS/SwymUIComponents/script/feature/community/survey/view/answer-result-collection-view",["DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUICore/script/feature/community/survey/collection/answer-collection","DS/SwymUIComponents/script/feature/community/survey/view/answer-result-view","UWA/Object"],function(e,t,i,n){return e.extend({_collectionClass:t,modelViewClass:i,surveyRedraw:function(){setTimeout(function(){n.keys(this._childViews).forEach(function(e){this._childViews[e].dispatchEvent("surveyRedraw")},this)}.bind(this),5)},onRefresh:function(){this.surveyRedraw()}})}),define("DS/SwymUIComponents/script/feature/core/ui-components/scrollable-view/infinitely-scrollable-view-mixin",["UWA/Core","UWA/Utils/Client","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUIComponents/script/feature/core/ui-components/layout/layout-manager","DS/SwymUICore/script/utils/utils","DS/SwymUIComponents/script/utils/scrollview-utils","DS/W3DXComponents/Views/Layout/ScrollView","DS/SwymUICore/script/feature/core/context/context-model"],function(e,t,i,n,o,s,a,r,l){"use strict";var c=l.getInstance();return{_firstInfiniteScrollRequest:null,_lastScrollInScrollDirectionTime:null,_lastScrollPosition:null,_scrollViewInjected:!1,_scrollerPositionBeforeContextChange:null,_addScrollViewEvents:!0,_lastOnPageLoadRequestOptions:null,name:"ifntl-scrl-view",className:"scroll-to-top",defaultOptions:{scrollableBodyCls:"",reverseScroll:!1,scrollviewClass:r},init:function(){this.onScroll=s.getDelayedSyncTask(this.onScroll.bind(this),200),this.onContextChange=this.onContextChange.bind(this),l.getInstance().addListener("onContextChange",this.onContextChange,this,!0),this._parent.apply(this,arguments)},setup:function(e){this._parent(e),this._lastScrollPosition||(this._lastScrollPosition={x:0,y:0}),this._addScrollViewWithContentList()},resetLastScrollPosition:function(){this._lastScrollPosition={x:0,y:0}},getLastScrollPosition:function(){return{x:this._lastScrollPosition.x,y:this._lastScrollPosition.y}},_createContentView:function(){throw new Error('This method is meant to be overridden and should dispatch a "onContentViewCreation" event once the content view is created.')},_getContentView:function(){throw new Error("This method is meant to be overridden")},_getContentViewCollection:function(e){var t=e||this._getContentView();return t&&(t.collection||t._collection)},_addScrollViewWithContentList:function(){this._createContentView()},_createContent:function(){return[this.getControl("scrollView"),this.getChildView("backToTopView")||""]},_dispatchOnInfiniteScrollIfNeeded:function(){var e=null,i=!1;return!this._firstInfiniteScrollRequest&&this.scrollView&&(this._lastScrollInScrollDirectionTime||this.scrollView.scroller&&1===this.scrollView.scroller.getProgress("y")||t.Engine.ie&&this.scrollView.scroller.getProgress("y")>.995)&&(i=!0,this._lastScrollInScrollDirectionTime=null,(e=this._getContentView())&&e.dispatchEvent("onInfiniteScroll",[this.scrollView])),i},renderScrollView:function(){var e=this.getControl("scrollView");if(!e||"function"!=typeof e.render)return!1;e.render(),this.getOption("scrollableBodyCls")&&e.getElement(".scrollable-body").addClassName(this.getOption("scrollableBodyCls")),this.listenTo(e.scroller.elements.content,"scroll",this.onScroll),this.listenTo(e,"onInjected",this.onScrollViewInjected)},getScrollerPosition:function(){var e=null;return this.scrollView&&this.scrollView.scroller&&(e=this.scrollView.scroller.getPosition()),e},onContentViewCreation:function(e){var t,i=this;this.listenTo(e,{onPageLoadRequest:this.onPageLoadRequest,onLoadingEndRequest:this.onLoadingEndRequest,onInfiniteScrollActivationRequest:this.onInfiniteScrollActivationRequest,onInfiniteScrollDeactivationRequest:this.onInfiniteScrollDeactivationRequest}),!1!==this._addScrollViewEvents&&e.addEvents({onPullToRefresh:function(e){var t=i._getContentViewCollection(this);this.isVisible()&&t&&a.onPullToRefresh.apply({collection:t,scrollView:e})},onInfiniteScroll:function(e){var t=i._getContentViewCollection(this);this.isVisible()&&t&&a.onInfiniteScroll.apply({collection:t,scrollView:e})}}),this.scrollView?this.scrollView.setOption("view",e):(t=new this.options.scrollviewClass({view:e,reverseScroll:this.options.reverseScroll,twoWayScrolling:this.options.twoWayScrolling,useInfiniteScroll:void 0===this.options.useInfiniteScroll||this.options.useInfiniteScroll,usePullToRefresh:void 0===this.options.usePullToRefresh||this.options.usePullToRefresh}),this.scrollView=this.addControl("scrollView",t),this.listenTo(this.scrollView,{onPullToRefresh:this.onPullToRefresh,onInfiniteScroll:this.onInfiniteScroll}),this.getOption("backToTop")&&this.addChildView("backToTopView",{Class:"DS/SwymUIComponents/script/feature/core/ui-components/layout/back-to-top-view",manager:this,events:{onInit:function(e){this.listenTo(e,{onScrollToTopRequest:function(e){this.onScrollToTopRequest(e)}})}.bind(this)}})),this.dispatchEvent("onScrollViewCreation")},onScrollToTopRequest:function(e){this.options.reverseScroll?this.scrollToBottom&&this.scrollToBottom():this.isVisible()&&this.scrollView&&this.scrollView.scroller&&this.scrollView.scroller.scrollTo(0,0,e||0)},onLoadingEndRequest:function(){this.scrollView&&this._scrollViewInjected&&this.scrollView.endLoading()},onInfiniteScrollActivationRequest:function(){this.scrollView&&this._scrollViewInjected&&this.scrollView.useInfiniteScroll(!0)},onInfiniteScrollDeactivationRequest:function(){this.scrollView&&this._scrollViewInjected&&this.scrollView.useInfiniteScroll(!1)},onRedraw:function(){!1===this.renderScrollView()&&this.addEventOnce("onScrollViewCreation",this.refresh),this.dispatchEvent("onScrollViewRedraw")},onContextChange:function(){this.isVisible()&&(this._lastScrollInScrollDirectionTime=null,this.scrollView&&this.scrollView.scroller&&(this._scrollerPositionBeforeContextChange=this.getScrollerPosition()))},onScrollViewInjected:function(){this._scrollViewInjected=!0},onScroll:function(){var e,t=this.getScrollerPosition(),i=this._getContentView();t&&i&&(e={position:t,delta:{x:t.x-this._lastScrollPosition.x,y:t.y-this._lastScrollPosition.y}},i.dispatchEvent("onScroll",[this.scrollView,e]),(!0===this.options.reverseScroll&&e.delta.y>0||!0!==this.options.reverseScroll&&e.delta.y<0)&&this.scrollView.scroller.getProgress("y")>=this.scrollView.scrollMaxProgress&&(this._lastScrollInScrollDirectionTime=new Date,this._dispatchOnInfiniteScrollIfNeeded()),this.showOrHideBackToTop(e)),this._lastScrollPosition=t},showOrHideBackToTop:function(e){var t=this.getChildView("backToTopView");t&&(0===e.position.y?(this.container.addClassName("scroll-to-top"),t&&t.hide()):(this.container.removeClassName("scroll-to-top"),e&&e.delta.y<0&&-1*e.position.y>document.body.getSize().height&&t&&t.show()))},onInfiniteScroll:function(){null===this._firstInfiniteScrollRequest?this._firstInfiniteScrollRequest=!0:this._firstInfiniteScrollRequest=!1,this._dispatchOnInfiniteScrollIfNeeded()},onPullToRefresh:function(){var e=this._getContentView();e&&this.scrollView&&this._scrollViewInjected&&e.dispatchEvent("onPullToRefresh",[this.scrollView])},onFirstServerFilteringRequestDone:function(){this._firstInfiniteScrollRequest=!0},onPageLoadRequest:function(e,t){this.scrollView&&this.scrollView.scroller?(e instanceof n||!this._lastOnPageLoadRequestOptions||(e=this._lastOnPageLoadRequestOptions[0],t=this._lastOnPageLoadRequestOptions[1]),this.isVisible()?(this._lastOnPageLoadRequestOptions=null,null===this._firstInfiniteScrollRequest?this._firstInfiniteScrollRequest=!0:this._firstInfiniteScrollRequest=!1,this.isScrollReversed||this.scrollView.scroller.scrollTo(0,0),a.onInfiniteScroll.apply({collection:e,scrollView:this.scrollView,options:t})):(this._lastOnPageLoadRequestOptions=[e,t],this.addEventOnce("onShow",this.onPageLoadRequest))):(this._lastOnPageLoadRequestOptions=[e,t],this.addEventOnce("onScrollViewRedraw",this.onPageLoadRequest))},destroy:function(){return this.scrollView=null,c.removeListener("onContextChange",this.onContextChange),this._parent.apply(this,arguments)}}}),define("DS/SwymUIComponents/script/feature/core/ui-components/scrollable-view/infinitely-scrollable-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUIComponents/script/feature/core/ui-components/scrollable-view/infinitely-scrollable-view-mixin"],function(e,t,i){"use strict";return t.extend(i)}),define("DS/SwymUIComponents/script/feature/core/user/view/assignee-view",["UWA/Core","DS/SwymUIComponents/script/feature/core/user/view/user-picture-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/wedo/view/wedo-detailed-view"],function(e,t,i,n){"use strict";return i.extend({name:"assignee-view",defaultOptions:{editable:!1},domEvents:{"click .fonticon-close":"_onRemoveAssignee"},_onRemoveAssignee:function(){this.dispatchEvent("onRemoveRequest",[this.model])},setup:function(e){this.addChildView("userPicture",{Class:t,model:this.model}),this._parent.call(this,e)},_createContent:function(){var e=this.model;return[{class:"absolute-layer"},this.getChildView("userPicture"),{tag:"a","data-content-type":"person","data-hash-key":e.get("hash_key")?e.get("hash_key"):"","data-login":e.get("login"),class:"link",html:e.getNickname()},!0===this.getOption("editable")?{class:"fonticon fonticon-close",tag:"span"}:{}]}})}),define("DS/SwymUIComponents/script/feature/core/user/view/uploadPicture-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/uploadPicture-view","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/utils/date","DS/SwymUIComponents/script/feature/core/modal/modal","DS/UIKIT/Input/Button","DS/UWPClientControls/PlatformNotify","DS/SwymUICore/script/utils/utils","DS/UIKIT/Input/File","UWA/Controls/Flash","DS/WebappsUtils/WebappsUtils"],function(e,t,i,n,o,s,a,r,l,c,d,m){"use strict";return n.extend({_modelClass:i,name:"uploadPicture-view",launch:function(i){var n=this.model,o=i,d=new a({value:t.UploadPicture,className:"primary"}),m=new a({value:t.TakeApicture,className:"primary"}),u=new a({value:t.UploadPicture,className:"primary"}),h=new a({value:t.TakePhoto,className:"primary"}),p=new a({value:t.PreviewScreenshot,className:"primary"}),g=this.addControl("ok-button",new a({value:t.ok,className:"primary",events:{onClick:function(){this.getControl("modal-control").hide()}.bind(this)}})),w=this.addControl("modal-control",new s({header:t.ChangePicture,body:"",closable:!0,footer:[d,m],events:{onHide:function(){C&&(C.getTracks()[0].stop(),C&&C.stop&&(C.stop(),C=null))}}}));p.addEvent("onClick",function(){w.dispatchEvent("onUploading",!1)}),d.addEvent("onClick",function(){w.dispatchEvent("onUpload")}),m.addEvent("onClick",function(){w.dispatchEvent("onTake")}),u.addEvent("onClick",function(){w.dispatchEvent("onUploading",!0)}),h.addEvent("onClick",function(){var e=!1;isNaN(_)&&(_=I.videoHeight/(I.videoWidth/A)),b.width=A,b.height=_,b.getContext("2d").drawImage(I,0,0,A,_);var t=b.toDataURL("image/png");v.setAttribute("src",t),e||(w.setFooter([this,p]),e=!0)});var C,f=new c({buttonPosition:"right",placeholder:t.selectAFile,buttonText:t.browse,attributes:{accept:"image/*"},events:{onChange:function(e){this.fileToUpload=e.target.files[0]}.bind(this)}}),y=new e.createElement("img",{styles:{"margin-left":"35%",width:"123px",height:"123px"},alt:t.MyImage,src:"#"}),v=new e.createElement("img",{styles:{float:"right"},class:"webcamtarget"}),A=150,_=0,S=!1,b=new e.createElement("canvas",{id:"canvas"}),I=new e.createElement("video",{id:"video"}),D=this;const T=e.createElement("div",{class:"upload-message-info",html:t.NoteUploadPicture});w.addEventOnce("onUpload",function(){this.setBody([f,T]),this.elements.body.setStyle("height",null),this.setFooter(u)});var E=this.launchPhotobooth;w.addEventOnce("onTake",function(){this.setFooter(),this.setBody([I,v]),this.elements.body.setStyle("height",null),navigator.mediaDevices?(navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then(function(e){e.addEventListener&&e.addEventListener("ended",function(){this.setBody(t.camAlreadyRunning),this.elements.body.setStyle("height",null),this.setFooter(g)}.bind(this)),"live"!==e.getVideoTracks()[0].readyState&&e.getVideoTracks()[0].readyState?(this.setBody(t.camAlreadyRunning),this.elements.body.setStyle("height",null),this.setFooter(g)):(C=e,I.srcObject=C,I.onloadedmetadata=function(e){I.play()})}.bind(this)).catch(function(e){console.error("error message dispatched by native API : ",e),this.setBody(t.noCamAvailable),this.elements.body.setStyle("height",null),this.setFooter()}.bind(this)),I.addEventListener("canplay",function(){S||(_=I.videoHeight/(I.videoWidth/A),I.setAttribute("width",A),I.setAttribute("height",_),this.setAttribute("width",A),this.setAttribute("height",_),S=!0)}.bind(b),!1),this.setFooter(h)):E(this)}),w.addEvent("onUploading",function(i){var o=this.getBody().getElement(".text-error"),s=D.fileToUpload,c=new FileReader;if(o&&o.remove(),c.onload=function(e){this.setBody(y),this.elements.body.setStyle("height",null),n.uploadpreviewpicture({data:{base64_encoded:!0,file_content:e.target.result},onComplete:function(e,i){y.setAttribute("src",l.getBaseUrl()+"/api/user/getpreviewpicture/filekey/"+i.result),this.setFooter();var n=new a({value:t.Save,className:"primary"});n.addEvent("onClick",function(){var e,t=f.getValue(),n=null;e=""!==t?(n=t.split("\\"))[n.length-1]:"uploadPicture.jpg",this.dispatchEvent("onCreating",[i.result,e])}.bind(this)),this.setFooter([n])}.bind(this),onFailure:function(){r.error(t.anErrorOccuredPleaseTryLater)}})}.bind(this),i)i&&(s?s.type.indexOf("image/")>-1?(this.setFooter(),c.readAsDataURL(s)):(o=e.createElement("p",{class:"text-error",html:t.pleaseUploadAnImage}),this.getBody().grab(o,"top")):(o=e.createElement("p",{class:"text-error",html:t.pleaseSelectAfile}),this.getBody().grab(o,"top")));else{this.setFooter();var d={target:{result:v.getAttribute("src")}};c.onload(d)}}),w.addEventOnce("onCreating",function(e,i){this.setBody(t.pleaseWait),this.elements.body.setStyle("height",null),this.setFooter(),n.uploadpicture({data:{filekey:e,filename:i},onComplete:function(e,i){void 0!==i.errorcode?(r.error(t.anErrorOccuredPleaseTryLater),w.hide()):(require(["DS/SwymUICore/script/utils/date"],function(t){e.set("picture_update",t.getCurrentDate()),e.set("user_picture_fingerprint",t.getCurrentDate())}),this.hide(),o&&o(e))}.bind(this),onFailure:function(){r.error(t.anErrorOccuredPleaseTryLater)}})}),w.show()},launchPhotobooth:function(i){var n="<p>To view this page ensure that Adobe Flash Player version 10.0.0 or greater is installed.</p>";n+='<a href="http://www.adobe.com/go/getflashplayer">"'+t.GetAdobeFlashplayer+'"</a>';var o=new e.createElement("div",{id:"photoboothContainer",styles:{width:"233px",height:"291px","margin-left":"105px",border:"1px solid #CCCCCC"},html:'<div id="photoboothWrapper">'+n+"</div>"});i.setFooter(),i.elements.body.getElement("#video").remove(),i.elements.body.grab(o,"bottom"),ds.photobooth={createWebcamPreview:function(e){var n="data:image/png;base64,"+e[0];i.elements.body.getElement("#photoboothContainer").remove();var o=i.elements.body.getElement(".webcamtarget");o&&(o.setAttribute("src",n),o.setStyle("float","none"),o.setStyle("margin-left","25%"),i.elements.body.setStyle("height","320px"));var s=new a({value:t.UploadPicture,className:"primary"});s.addEvent("onClick",function(){i.dispatchEvent("onUploading",!1)}),i.setFooter([s])}};var s=new d({url:m.getWebappsBaseUrl()+"SwymUIComponents/assets/swf/photobooth.swf",width:"233",height:"291",className:"photoboothWrapper",flashVars:"noCamDetected="+t.noCamDetected+"&camAlreadyRunning="+t.camAlreadyRunning+"&webcamError="+t.webcamError+"&allowWebcam="+t.allowWebcam,allowScriptAccess:"always",bgcolor:"#ffffff",allowfullscreen:!1,quality:"high"});s.getFlashVersion().major>=10&&o.setContent(s)}})}),define("DS/SwymUIComponents/script/feature/core/tenant/view/users-management-processes-collection-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/tenant/view/users-management-processes-collection-view","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUICore/script/feature/core/tenant/collection/users-processes-collection","DS/SwymUIComponents/script/feature/core/tenant/view/users-management-processes-view","DS/WebappsUtils/Console"],function(e,t,i,n,o,s){return i.extend({_collectionClass:n,modelViewClass:o,batchIds:{},attributes:{tag:"table",class:"table table-hover users-management-processes-table"},bodyAttributes:{tag:"tbody"},modelViewsCfg:{attributes:{tag:"tr",class:"cursor-pointer"}},_asAdmin:!1,_createModelView:function(){var e=this._parent.apply(this,arguments);return e.asAdmin=this._asAdmin,e.batchIds=this.batchIds,e.container.addEvent("click",function(e){"button"!=e.target.getTagName()&&(this.collectionView.dispatchEvent("processClicked",[this.modelView.model]),this.collectionView.getModelViews().forEach(function(e){e.container.removeClassName("trSelected")}),this.modelView.container.addClassName("trSelected"))}.bind({collectionView:this,modelView:e})),e},_createContent:function(){return this.collection.length>0?[{tag:"thead",html:"<th>"+t.Title+"</th><th>"+t.Type+"</th><th>"+t.Status+"</th><th>"+t.Details+"</th><th></th>"},this._parent.apply(this,arguments)]:t.Thereisnoprocessesresult},setup:function(e){this._parent.apply(this,arguments),e&&e.batchIds&&(this.batchIds=e.batchIds),e&&e.asAdmin&&(this._asAdmin=e.asAdmin)}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/embedded-rich-link-preview-view",["UWA/Core","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/abstract-rich-link-preview-view"],function(e,t){"use strict";return t.extend({className:"rich-link-embedded-preview",rendered:!1,domEvents:{resize:"onResize"},onResize:function(){var e,t,i;t=(e=this.container).getElement("iframe"),this.rendered&&e&&t&&this.container&&this.container.offsetHeight+this.container.offsetWidth>0&&(i=t.width/t.height,t.style.height=t.offsetWidth/i+"px",this.options&&this.options.previewSize&&void 0!==this.options.previewSize.height?(t.style.height=this.options.previewSize.height+"px",t.style.width=this.options.previewSize.height*i+"px"):(t.style.minHeight="150px",t.style.minWidth=150*i+"px"))},render:function(){return this.container.setContent({html:this.model.iframe,class:"embedded-preview-container","data-url":this.model.url}),this.onResize(),this.rendered=!0,this}})}),define("DS/SwymUIComponents/script/feature/core/tenant/view/users-management-processes-home-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/tenant/view/users-management-processes-home-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/core/tenant/collection/users-processes-collection","DS/SwymUIComponents/script/feature/core/tenant/view/users-management-processes-collection-view","DS/SwymUIComponents/script/feature/core/tenant/view/users-management-process-detail-view","DS/SwymUIComponents/script/feature/core/pagination/view/paging-toolbar-view","DS/UIKIT/Tooltip","DS/SwymUIComponents/script/feature/core/modal/super-modal","DS/SwymUICore/script/lib/request/data","DS/SwymUICore/script/feature/core/user/model/currentuser-model"],function(e,t,i,n,o,s,a,r,l,c,d,m){"use strict";return i.extend({name:"users-management-processes-home-view",model:null,_asAdmin:!1,_createContent:function(){var i=e.Utils.Client.Features.touchEvents;if(this._usersManagementProcessesCollectionView)return this._pagingToolbar=new r({collection:this._usersProcessesCollection,widget:this._widget,asAdmin:this._asAdmin}),this._refreshBtn=e.createElement("span",{class:"fonticon fonticon-2x fonticon-arrows-ccw",styles:{position:"relative",float:"right","margin-right":"15px",cursor:"pointer"},events:{click:function(){this.mask(),this._usersManagementProcessDetailView&&this._usersManagementProcessDetailView.hide(),this._usersProcessesCollection.resetCollection(1),this.unmask()}.bind(this)}}),i||new l({target:this._refreshBtn,body:t.Refresh,position:"bottom"}),e.createElement("div",{styles:{padding:"10px"},html:[{styles:{"margin-bottom":"10px"},html:[this._refreshBtn]},this._usersManagementProcessesCollectionView,this._pagingToolbar,{id:"users-management-processes-details-wrapper",html:""}]})},setup:function(e){var i=this;i._parent.apply(i,arguments),e&&e.asAdmin&&(i._asAdmin=e.asAdmin),m.getInstanceFetched(function(e){e.addEvent("refreshUserManagementProcesses",function(){i._usersProcessesCollection.fetch(),i.refresh()})}),i._usersProcessesCollection=new o(null,{mode:"processes",community_id:i.model?i.model.get("mid"):null,limit:10,asAdmin:i._asAdmin}),i._usersProcessesCollection.addEvent("onProcessDeleted",function(){i._usersProcessesCollection.fetch(),i.refresh()}),i._usersProcessesCollection.addEvent("onSync",i.unmask);e=n.adaptService.call({},{url:"api/member/getbatchids",type:"json",data:{},onComplete:function(e){var i=e.result;this._usersProcessesCollection.addEventOnce("onAfterPageChange",function(e){this._usersManagementProcessesCollectionView=new s({collection:e,batchIds:i,widget:this._widget,asAdmin:this._asAdmin}),this._usersManagementProcessesCollectionView.addEvent("processClicked",function(e){3===Number(e.get("type"))?0===e.get("total")?new c({renderTo:this._widget.body}).alert(t.Errorbatch):(this.mask(),this._showDetails(e)):this._hideDetails()}.bind(this)),this.isRendered()&&this.refresh(),this.unmask()}.bind(this)),this._usersProcessesCollection.goToPage(1)}.bind(this)});d.request(e)},_hideDetails:function(e){this._usersManagementProcessDetailView&&this._usersManagementProcessDetailView.hide()},_showDetails:function(e){e.getResults({data:{asAdmin:this._asAdmin},onComplete:function(t,i){const n=this.container.getElement("#users-management-processes-details-wrapper");e.processResults=i.result,this._usersManagementProcessDetailView?this._usersManagementProcessDetailView.setModel(e):this._usersManagementProcessDetailView=new a({model:e,widget:this._widget,asAdmin:this._asAdmin}),this._usersManagementProcessDetailView.inject(n),this._usersManagementProcessDetailView.show(),this.unmask()}.bind(this),onFailure:function(){this._usersManagementProcessesCollectionView.getModelViews().forEach(function(e){e.container.removeClassName("trSelected")}),this._usersManagementProcessDetailView&&this._usersManagementProcessDetailView.hide(),this.unmask()}.bind(this)})}})}),define("DS/SwymUIComponents/script/feature/community/idea/view/link-collection-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUICore/script/feature/community/idea/collection/link-collection","DS/SwymUIComponents/script/feature/community/idea/view/link-view"],function(e,t,i,n){return t.extend({_collectionClass:i,name:"link-collection-view",_userCanDeleteLink:!0,_createContent:function(){var t=this.collection;if(t){var i=e.createElement("div",{class:"comments"});return t.forEach(function(e){"internal"!==e.get("type")||e._associations.linkedModel.hasOwnProperty("associated")?new n({model:e,userCanDeleteLink:this._userCanDeleteLink,widget:this._widget}).render({target:i}):this.collection.addEvent("onAddIdeaLink",function(e){new n({model:e,userCanDeleteLink:this._userCanDeleteLink,widget:this._widget}).render({target:i})}.bind(this))},this),i}},setup:function(e){e.hasOwnProperty("userCanDeleteLink")&&(this._userCanDeleteLink=e.userCanDeleteLink),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/idea/view/idea-status-admin-view",["UWA/Core","DS/UIKIT/Input/Button","DS/UIKIT/Input/Select","DS/UIKIT/Input/Text","DS/SwymUIComponents/script/feature/core/modal/modal","DS/UIKIT/DropdownMenu","DS/UWPClientControls/PlatformNotify","DS/SwymUICore/script/feature/community/idea/collection/status-collection","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/lib/request/data","DS/SwymUICore/script/utils/utils","DS/SwymUIComponents/script/feature/community/idea/view/pipeline-view","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/idea/model/idea-type-model","i18n!DS/SwymUIComponents/assets/nls/feature/community/idea/view/idea-status-admin-view","UWA/Utils/Client"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g){"use strict";return l.extend({name:"idea-status-admin",defaultOptions:{asAdmin:!1},_statusCollection:null,_statusDeletion:[],domEvents:{"click .add-button":"_onAddStatusButtonClick","click .save-status-edition-button":"_onSaveStatusButtonClick","click .cancel-status-edition-button":"_onCancelButtonClick"},_createContent:function(){var e,n=[],o=!1,s=[];return this._statusCollection&&this._statusCollection.length>0&&(this._statusDeletion=[],this.addChildView("pipelineView",new m({widget:this._widget,config:{height:150,heightDiff:30,className:"",outClickable:!0,curveColor:"#f4f5f6",containerId:this._widget.id,legend:!1,statusCollection:this._statusCollection}})),this._statusCollection.forEach(function(e){s.push(this._pushStatus(e.toJSON())),e.get("is_mature")&&(o=!0),n.push({selected:Boolean(e.get("is_mature")),label:e.get("title",{escapeHTML:!1}),value:e.get("mid")})}.bind(this)),!1===o&&(n[n.length-1].selected=!0),this.addControl("matureStatusSelect",new i({options:n,className:"margin-0",placeholder:!1,events:{onChange:function(e){var t=e.target.value;this._statusCollection.forEach(function(e){""!==t&&(t==e.get("mid")?e.set("is_mature",!0):e.set("is_mature",!1),this.dispatchEvent("hasChanged",!0))}.bind(this))}.bind(this)}})),e={styles:{padding:"10px","min-height":"50px"},html:[this.getChildView("pipelineView"),{styles:{padding:"10px 0px",height:"53px",clear:"both"},html:["<b>"+p.StatusList+"</b> ("+p.Youcannotgetlessthanthreestatus+")",{styles:{float:"right"},html:[new t({className:"primary add-button",value:p.Add})]}]},{class:"status-panel",styles:{clear:"both","margin-bottom":"10px"},html:s},{styles:{clear:"both","margin-bottom":"10px"},class:"mature-status-panel",html:[{html:'<div style="margin-bottom: 5px;"><b>'+p.MatureStatusTitle+"</b></div>"},this.getControl("matureStatusSelect")]}]},this._widget&&(this._widget.onResize=function(){this.getChildView("pipelineView")&&this.getChildView("pipelineView").refresh()}.bind(this))),e},_rdnColor:function(e){var t=this._statusCollection.length;if("pastel"===e)return"#"+(Math.round(127*Math.random())+127).toString(16)+(Math.round(127*Math.random())+127).toString(16)+(Math.round(127*Math.random())+127).toString(16);var i=function(e){return String("0123456789ABCDEF".substr(e>>4&15,1))+"0123456789ABCDEF".substr(15&e,1)},n=2*Math.PI/this._statusCollection.length,o=127*Math.sin(n*(t+1)+2+0)+128,s=127*Math.sin(n*(t+1)+0)+128,a=127*Math.sin(n*(t+1)+4+0)+128;return"#"+i(o)+i(s)+i(a)},_deleteStatus:function(e,t,i){var n=this.getControl("matureStatusSelect");e.remove(),e.destroy(),this._statusCollection.remove(t),n.remove(t.get("mid").toString()),n.getValue()[0],t.get("is_mature")&&i?n.select(i):t.get("is_mature")&&n.select(this._statusCollection.at(this._statusCollection.length-1).get("mid")),this._statusCollection.forEach(function(e,t){e.set("status_nb",t+1)}),this.getChildView("pipelineView").refresh(),this._statusCollection.length<4&&this._refreshStatusPanel(),this.dispatchEvent("hasChanged",!0)},_moveLeft:function(e){var t=parseInt(e.get("status_nb"),10);this._statusCollection.forEach(function(e){parseInt(e.get("status_nb"),10)===t-1&&e.set("status_nb",t)}),e.set("status_nb",t-1),this._statusCollection.sort(),this.getChildView("pipelineView").refresh(),this._refreshStatusPanel(),this.dispatchEvent("hasChanged",!0)},_moveRight:function(e){var t=parseInt(e.get("status_nb"),10);this._statusCollection.forEach(function(e){parseInt(e.get("status_nb"),10)===t+1&&e.set("status_nb",t)}),e.set("status_nb",t+1),this._statusCollection.sort(),this.getChildView("pipelineView").refresh(),this._refreshStatusPanel(),this.dispatchEvent("hasChanged",!0)},_pushStatus:function(i){var o=this;i||(i={mid:(new Date).getTime(),title:p.Status+" "+(o._statusCollection.length+1),status_nb:o._statusCollection.length+1,color:o._rdnColor("pastel"),new_status:!0,is_mature:!1},o._statusCollection.add(i),o.getControl("matureStatusSelect").add({label:i.title,value:i.mid}));var a,r=this.addControl("statusEditPanel"+i.mid,e.createElement("div",{styles:{"margin-bottom":"10px"},class:"col-lg-3 col-md-4 col-sm-6 col-xs-12",html:{html:[new n({className:"title-textfield",value:i&&i.title?i.title:null,placeholder:p.Title}),{tag:"input",placeholder:p.Color,class:"safari"===g.Engine.name&&g.Platform.ios&&!0===g.Platform.ipad?"color-input":"btn color-input color-textfield",type:"color",name:"favcolor",value:i&&i.color?i.color:""},a=new t({icon:"chevron-down",className:"default down-button"})]}})),l=o._statusCollection.get("status:"+i.mid),c=[{text:p.Movetoleft,fonticon:"expand-left",name:"move-left",disabled:1===parseInt(l.get("status_nb"),10),handler:function(){o._moveLeft(l)}},{text:p.Movetoright,fonticon:"expand-right",name:"move-right",disabled:parseInt(l.get("status_nb"),10)===o._statusCollection.length,handler:function(){o._moveRight(l)}},{text:p.Delete,fonticon:"trash",name:"delete",disabled:o._statusCollection.length<4,handler:function(){o._onDeleteStatusButtonClick(l,r)}}],d=(o.addControl("dropdownMenu-"+l.get("mid"),new s({target:a.getContent(),items:c,position:"top"})),r.getElement(".color-input"));return d&&d.style&&(r.getElement(".color-input").style.backgroundColor=l.get("color")),d.addEvent("change",function(){var e=d.value;this.statusModel.set("color",e),o.getChildView("pipelineView").refresh(),d&&d.style&&(d.style.backgroundColor=e),o.dispatchEvent("hasChanged",!0)}.bind({statusModel:l})),r.getElement(".title-textfield").addEvent("change",function(){o.getElements(".title-textfield").forEach(function(e,t,i){var n=!0;i.forEach(function(i,o){e.value.trim()===i.value.trim()&&t!==o&&(e.getParent().addClassName("has-error"),n=!1)}),n&&""!==e.value.trim()?e.getParent().removeClassName("has-error"):e.getParent().addClassName("has-error")}),this.statusModel.set("title",r.getElement(".title-textfield").value);var e=[];o.getControl("matureStatusSelect").getOptions().forEach(function(t){e.push({value:t.getAttribute("value"),label:t.getText(),selected:t.selected})}),e[parseInt(this.statusModel.get("status_nb"),10)-1].label=r.getElement(".title-textfield").value,o.getControl("matureStatusSelect").remove(),o.getControl("matureStatusSelect").add(e)}.bind({statusModel:l})),r},_onDeleteStatusButtonClick:function(e,i){var n=this,s=e,a=null,r=null;if(n._statusCollection.length>3)if(n._statusCollection.at(s.get("status_nb")-2)&&(a=n._statusCollection.at(s.get("status_nb")-2).get("mid")),n._statusCollection.at(s.get("status_nb"))&&(r=n._statusCollection.at(s.get("status_nb")).get("mid")),!0!==s.get("new_status")){(c=this.addControl("myModal",new o({header:p.Confirm,body:'<div style="margin-bottom:10px;">'+p.Inwhichstatusdoyouwanttoputtheideaswhichareinstatus+" <b>"+s.get("title")+'</b></div><div><form style="margin-left:30px;" id="new_status_panel">'+(a?'<span id="prev_radio_wrapper"></span><label class="cursor-pointer" for="prev_status">'+n._statusCollection.get("status:"+a).get("title")+"</label></br>":"")+(r?'<span id="next_radio_wrapper"></span><label class="cursor-pointer" for="next_status">'+n._statusCollection.get("status:"+r).get("title")+"</label>":"")+"</form></div>"+(s.get("is_mature")?'<div style="margin-top:10px; font-style: italic;">'+p.NoteMature+" </div>":""),footer:[new t({value:p.OK,className:"primary",key:"return",events:{onClick:function(){var e,t=null;if(c.getContent().getElement("#new_status_panel").getElement("#prev_status")&&c.getContent().getElement("#new_status_panel").getElement("#prev_status").checked?t=c.getContent().getElement("#new_status_panel").getElement("#prev_status").value:c.getContent().getElement("#new_status_panel").getElement("#next_status")&&c.getContent().getElement("#new_status_panel").getElement("#next_status").checked&&(t=c.getContent().getElement("#new_status_panel").getElement("#next_status").value),t){for(e=0;e<n._statusDeletion.length;e++)n._statusDeletion[e].new_status_id==this.get("mid")&&(n._statusDeletion[e].new_status_id=t);n._deleteStatus(i,this,t),n._statusDeletion.push({deleted_status_id:this.get("mid"),new_status_id:t}),c.hide(),c.destroy()}}.bind(s)}}),new t({value:p.Cancel,key:"esc",events:{onClick:function(){c.hide(),c.destroy()}}})]}))).show(),a&&new UWA.Controls.Input.Radio({attributes:{id:"prev_status",name:"new_status",value:n._statusCollection.get("status:"+a).get("mid")}}).inject(c.getContent().getElement("#prev_radio_wrapper")),r&&new UWA.Controls.Input.Radio({attributes:{id:"next_status",name:"new_status",value:n._statusCollection.get("status:"+r).get("mid")}}).inject(c.getContent().getElement("#next_radio_wrapper"))}else{var l,c,d=!1;for(l=0;l<n._statusDeletion.length;l++)n._statusDeletion[l].new_status_id==s.get("mid")&&(d=!0);if(d)(c=this.addControl("myModal2",new o({header:p.Confirm,body:'<div style="margin-bottom:10px;">'+p.Inwhichstatusdoyouwanttoputtheideaswhichareinstatus+"<b>"+s.get("title")+'</b></div><div><form style="margin-left:30px;" id="new_status_panel">'+(a?'<span id="prev_radio_wrapper"></span><label class="cursor-pointer" for="prev_status">'+n._statusCollection.get("status:"+a).get("title")+"</label></br>":"")+(r?'<span id="next_radio_wrapper"></span><label class="cursor-pointer" for="next_status">'+n._statusCollection.get("status:"+r).get("title")+"</label>":"")+"</form></div>"+(s.get("is_mature")?'<div style="margin-top:10px; font-style: italic;">'+p.NoteMature+"</div>":""),footer:[new t({value:p.OK,className:"primary",key:"return",events:{onClick:function(){var e,t=null;if(c.getContent().getElement("#new_status_panel").getElement("#prev_status")&&c.getContent().getElement("#new_status_panel").getElement("#prev_status").checked?t=c.getContent().getElement("#new_status_panel").getElement("#prev_status").value:c.getContent().getElement("#new_status_panel").getElement("#next_status")&&c.getContent().getElement("#new_status_panel").getElement("#next_status").checked&&(t=c.getContent().getElement("#new_status_panel").getElement("#next_status").value),t){for(e=0;e<n._statusDeletion.length;e++)n._statusDeletion[e].new_status_id==this.get("mid")&&(n._statusDeletion[e].new_status_id=t);c.hide(),c.destroy()}n._deleteStatus(i,s,t)}.bind(s)}}),new t({value:p.Cancel,key:"esc",events:{onClick:function(){c.hide(),c.destroy()}}})]}))).show(),a&&n._statusCollection.get("status:"+a)&&new UWA.Controls.Input.Radio({attributes:{id:"prev_status",name:"new_status",value:n._statusCollection.get("status:"+a).get("mid")}}).inject(c.getContent().getElement("#prev_radio_wrapper")),r&&n._statusCollection.get("status:"+r)&&new UWA.Controls.Input.Radio({attributes:{id:"next_status",name:"new_status",value:n._statusCollection.get("status:"+r).get("mid")}}).inject(c.getContent().getElement("#next_radio_wrapper"));else n._deleteStatus(i,s)}},_onCancelButtonClick:function(){this.mask(),this._statusDeletion=[],this.getChildView("pipelineView").statusCollection.fetch({onComplete:function(){this.getControl("matureStatusSelect").remove();var t=[],i=!1,n=[];this.getElement(".status-panel").setContent(""),this._statusCollection.forEach(function(e){n.push(this._pushStatus(e.toJSON())),e.get("is_mature")&&(i=!0),t.push({selected:Boolean(e.get("is_mature")),label:e.get("title",{escapeHTML:!1}),value:e.get("mid")})}.bind(this)),0==i&&(t[t.length-1].selected=!0),e.createElement("div",{html:n}).inject(this.getElement(".status-panel")),this.getControl("matureStatusSelect").add(t),this.getChildView("pipelineView").refresh(),this.unmask()}.bind(this)})},_onAddStatusButtonClick:function(){this._pushStatus().inject(this.getElement(".status-panel")),this.getChildView("pipelineView").refresh(),this._statusCollection.length>3&&this._refreshStatusPanel(),this.dispatchEvent("hasChanged",!0)},_refreshStatusPanel:function(t){var i=this,n=[],o=i._statusCollection.length>3;i._statusCollection.forEach(function(e,t,s){0===t?i.getControl("dropdownMenu-"+e.get("mid")).disableItem("move-left"):t===s.length-1?i.getControl("dropdownMenu-"+e.get("mid")).disableItem("move-right"):(i.getControl("dropdownMenu-"+e.get("mid")).enableItem("move-left"),i.getControl("dropdownMenu-"+e.get("mid")).enableItem("move-right")),o?i.getControl("dropdownMenu-"+e.get("mid")).enableItem("delete"):i.getControl("dropdownMenu-"+e.get("mid")).disableItem("delete"),n.push(i.getControl("statusEditPanel"+e.get("mid")))}),i.getElement(".status-panel").setContent(""),e.createElement("div",{html:n}).inject(i.getElement(".status-panel"))},pipelineValidation:function(){var e=!0,t=!1;return this._ideaStatusArray=[],this._statusCollection.forEach(function(i,n,o){""!==i.get("title").trim()&&""!=i.get("color").trim()||(e=!1),i.get("is_mature")&&(t=!0),o.forEach(function(t){i.get("title")===t.get("title")&&i.get("mid")!==t.get("mid")&&(e=!1)});var s=i.toJSON(),a={id:s.mid,title:s.title,status_nb:n+1,color:s.color,new_status:s.new_status,is_mature:s.is_mature};this._ideaStatusArray.push(a)},this),!t&&a.error(p.SomethingWentWrongWithYourMatureStatusPleaseSelectAgainAMatureStatus),!e&&a.error(p.IdeaStatusTitleMustBeUnique),1==e&&1==t},saveStatus:function(){this.mask();var t=u.adaptService({url:"/api/Ideation/updatestatus",data:{community_id:this.model.get("mid"),status_list:this._ideaStatusArray,status_deletion:this._statusDeletion,as_admin:this.getOption("asAdmin")},onComplete:function(t){if(t.result){this._statusDeletion=[],this._confirmationModal&&this._confirmationModal.hide(),this._statusCollection.reset(t.result),this.getControl("matureStatusSelect").remove();var i=[],n=[];this.getElement(".status-panel").setContent(""),this._statusCollection.forEach(function(e){n.push(this._pushStatus(e.toJSON())),i.push({value:e.get("mid"),label:e.get("title"),selected:Boolean(e.get("is_mature"))})}.bind(this)),e.createElement("div",{html:n}).inject(this.getElement(".status-panel")),this.getControl("matureStatusSelect").add(i),this._statusCollection.dispatchEvent("onEdit"),this.dispatchEvent("onStatusSaveCallback",!0)}this.unmask()}.bind(this),onFailure:function(e){this.dispatchEvent("onStatusSaveCallback",!1),e&&"ERROR_UPDATING_IDEA_STATUSES_WITHOUT_MATURE"===e.errorcode?a.error(p.ErrorUpdatingIdeaStatusesWithoutMature):a.error(p.Errorwhilesavingyournewstatuslist),this.unmask()}.bind(this)});c.request(t)},_onSaveStatusButtonClick:function(){this.pipelineValidation()?(this._confirmationModal||(this._confirmationModal=this.addControl("myModal3",new o({header:p.Confirm,body:"<div>"+p.Areyousureyouwanttoupdatestatuslist+"<div>",footer:[new t({value:p.OK,className:"primary",key:"return",events:{onClick:this.saveStatus.bind(this)}}),new t({value:p.Cancel,key:"esc",events:{onClick:function(){this._confirmationModal.hide()}.bind(this)}})]}))),this._confirmationModal.show()):a.error(p.Pleasecheckyourform)},setup:function(e){var t=this._parent.apply(this,arguments),i=new h({name:0,communityId:this.model.get("mid")});return this._statusCollection=i.getStatusCollection(),this.reactTo(this._statusCollection,"onSync","refresh"),t}})}),define("DS/SwymUIComponents/script/feature/community/idea/view/idea-links-view",["i18n!DS/SwymUIComponents/assets/nls/feature/community/idea/view/idea-links-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/community/idea/view/link-collection-view","DS/UIKIT/Input/Button","DS/SwymUIComponents/script/feature/core/modal/modal","DS/UIKIT/Input/Select","DS/UIKIT/Input/Text","DS/UIKIT/Input/Toggle","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/community/derived-type/derived-type-data-utils"],function(e,t,i,n,o,s,a,r,l,c,d){return t.extend({name:"idea-links-view",modal:null,_createContent:function(){var t=this.model;if(t){var o=t.getAuthor().get("hash_key")===c.getInstance().get("user").hash_key||t.getCommunity().getUserRole()>=3,s=o;return this.addChildView("linkCollectionView",{collection:t.getLinks(),Class:i,userCanDeleteLink:o,widget:this._widget}),{html:[s?new n({value:"+ "+e.Addalink,className:"link add-link",key:"return",events:{onClick:function(){this.linkLayer.show()}.bind(this)}}):"",{class:"link-list-wrapper",html:this.getChildView("linkCollectionView")}]}}},setup:function(){var t=this._parent.apply(this,arguments),i=this;this.internalTypeCombo=new s({placeholder:e.Type,className:"margin-10-0",options:[{value:"CommunityPost",label:e.Post,selected:!0},{value:"Media",label:e.Media},{value:"QnaQuestion",label:e.iQuestion},{value:"Dsi_Ideation_Ideation",label:e.Idea},{value:"Poll",label:e.Survey},{value:"Dsi_DFSTree_WikiTree",label:e.Wiki}]}),this.internalIdTextfield=new a({placeholder:e.Link,className:"margin-10-0",allowBlank:!1,attributes:{name:"link"}}),this.externalTitleTextfield=new a({placeholder:e.Title,className:"margin-10-0",allowBlank:!1,attributes:{name:"title"}}),this.externalTitleTextfield.disable(),this.externalUrlTextfield=new a({placeholder:e.URL,className:"margin-10-0",allowBlank:!1,type:"url",attributes:{name:"url"}}),this.externalUrlTextfield.disable(),this.addControl("internalRadio",new r({name:"link_type_radio",value:"internal",label:e.Internal,className:"primary internal-radio",checked:!0,events:{onChange:function(){this.externalTitleTextfield.setValue(""),this.externalUrlTextfield.setValue(""),this.internalTypeCombo.enable(),this.internalIdTextfield.enable(),this.externalTitleTextfield.disable(),this.externalUrlTextfield.disable()}.bind(this)}})),this.addControl("externalRadio",new r({name:"link_type_radio",value:"external",label:e.External,className:"primary external-radio",checked:!1,events:{onChange:function(){this.internalTypeCombo.select("CommunityPost"),this.internalIdTextfield.setValue(""),this.internalTypeCombo.disable(),this.internalIdTextfield.disable(),this.externalTitleTextfield.enable(),this.externalUrlTextfield.enable()}.bind(this)}})),this.linkLayer=this.addControl("linkLayer",new o({header:e.Addalink,className:"link-modal",body:{html:[this.getControl("internalRadio"),this.internalIdTextfield,this.getControl("externalRadio"),this.externalTitleTextfield,this.externalUrlTextfield]},footer:[this.addControl("add",new n({value:e.Add,className:"primary add-link",key:"return",events:{onClick:function(){if(this.getControl("internalRadio").isChecked()&&""!==this.internalIdTextfield.getValue().trim()){var t,n=null,o=null,s={post:"CommunityPost",media:"Media",iquestion:"QnaQuestion",idea:"Dsi_Ideation_Ideation",ideation:"Dsi_Ideation_Ideation",survey:"Poll",wiki:"Dsi_DFSTree_WikiTree",wedo:"wedo"};this.getControl("add").load();var a=this.internalIdTextfield.getValue();if(a.match(/.*contentId=(.*?)(&|$)/)?(n=(n=a.match(/.*contentId=(.*?)(&|$)/))&&n.hasOwnProperty(1)?n[1]:null,o=(o=a.match(/.*contentType=(.*?)(&|$)/))&&o.hasOwnProperty(1)?o[1]:null):a.match(/.*community:.*?\/.*:(.*)$/)?(t=a.match(/.*community:.*?\/(.*?)(?=\:):(.*)/)).length>2&&(o=t[1],n=t[2]):require(["DS/UWPClientControls/PlatformNotify"],function(t){t.error(e.YourInternalLinkIsNotValid),i.getControl("add").load(!1)}),o&&n){const t="internal",i=decodeURIComponent(n);let a=s[o];if(!a){a=s[d.getParentFromDerivedTypeName(o)]}this.model.addLink({type:t,model_id:i,model:a},{onComplete:function(){this.internalTypeCombo.select("CommunityPost"),this.internalIdTextfield.setValue(""),this.externalTitleTextfield.setValue(""),this.externalUrlTextfield.setValue(""),this.linkLayer.hide(),this.getControl("add").load(!1),this.refresh()}.bind(this),onFailure:function(t,i){this.getControl("add").load(!1),"ERROR_IDEATION_CONTENT_ALREADY_LINKED"==i.errorcode?this.alert("error",e.Thiscontentisalreadylinkedtothisidea):"ERROR_CANNOT_LINK_IDEATION_TO_ITSELF"==i.errorcode?this.alert("error",e.Cannotlinkanideatoitself):this.alert("error",e.Thiscontentdoesntexist)}.bind(this)})}}else""!==this.externalUrlTextfield.getValue().trim()&&""!==this.externalTitleTextfield.getValue().trim()?!0===l.validateURL(this.externalUrlTextfield.getValue())?(this.getControl("add").load(),this.model.addLink({type:"external_url",url:this.externalUrlTextfield.getValue(),content_title:this.externalTitleTextfield.getValue()},{onComplete:function(){this.internalTypeCombo.select("CommunityPost"),this.internalIdTextfield.setValue(""),this.externalTitleTextfield.setValue(""),this.externalUrlTextfield.setValue(""),this.linkLayer.hide(),this.getControl("add").load(!1),this.refresh()}.bind(this),onFailure:function(t,i){this.getControl("add").load(!1),"ERROR_IDEATION_CONTENT_ALREADY_LINKED"==i.errorcode&&this.alert("error",e.Thiscontentisalreadylinkedtothisidea)}.bind(this)})):this.alert("warn",e.Pleaseenteravalidurl):this.alert("warn",e.Pleasecheckyourform)}.bind(this)}})),new n({value:e.Cancel,key:"esc",events:{onClick:function(e){this.internalTypeCombo.select("CommunityPost"),this.internalIdTextfield.setValue(""),this.externalTitleTextfield.setValue(""),this.externalUrlTextfield.setValue(""),this.linkLayer.hide()}.bind(this)}})]})),this.getControl("internalRadio").check();var c=this.model.getLinks();return c.hasBeenFetched()||c.fetch(),t}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/internal-rich-link-preview-view",["UWA/Core","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/abstract-rich-link-preview-view","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/community/derived-type/derived-type-styles-manager"],function(e,t,i,n){"use strict";return t.extend({className:"rich-link-internal-preview",rendered:!1,getIcon:function(){if(this.model.has("derived_type")){const e=this.model.get("derived_type");return n.addDerivedTypeStyle(e),{icon:e.icon.replace("fonticon-",""),className:n.getClassNameFromTypeName(e)}}switch(this.model.get("type")){case"posts":case"post":return{icon:"newspaper",className:"post-icon-color"};case"idea":return{icon:"lightbulb",className:"idea-icon-color"};case"iquestion":return this.model.get("answerValidated")?{icon:"i-question",className:"iquestion-validated-icon-color"}:{icon:"i-question",className:"iquestion-icon-color"};case"survey":return{icon:"clipboard",className:"survey-icon-color"};case"media":return{icon:i.getMediaIconName(this.model.get("mediaType")),className:"media-icon-color"};case"wiki":return{icon:"book-open",className:"wiki-icon-color"};default:return{}}},domEvents:{"click .preview-close":"_deletePreview","click .preview-container":"_redirectTo",resize:"onResize"},_redirectTo:function(e){return e.target.className.includes("toAuthor")?(e.stopPropagation(),null):e.target.className.includes("toCommunity")?(e.stopPropagation(),null):e.target.className.includes("preview-close")||e.target.className.includes("preview-toggle")?(e.stopPropagation(),null):(e.stopPropagation(),void window.open(this.model.get("tenantURL")))},_deletePreview:function(e){e.stopPropagation(),this.destroy()},onResize:function(){var e,t,i,n;this.rendered&&(t=(e=this.container)&&e.hasClassName("rich-link-internal-preview")&&e.offsetWidth,i=this.container.getElement(".preview-title"),n=this.container.getElement(".preview-description"),t&&(t<650?(i.classList.contains("two-lines-title")||i.classList.add("two-lines-title"),n.classList.contains("single-line-description")||n.classList.add("single-line-description")):t>=650&&(i.classList.contains("two-lines-title")&&i.classList.remove("two-lines-title"),n.classList.contains("single-line-description")&&n.classList.remove("single-line-description"))))},render:function(){return this.container.setContent({"data-url":this.model.get("tenantURL"),tag:"div",style:"padding-bottom:1px",html:[{tag:"div",class:"preview-container",contenteditable:!1,"data-url":this.model.get("url"),html:[{tag:"div",class:"icon-type-container "+this.getIcon().className,html:[{tag:"span",class:"fonticon fonticon-"+this.getIcon().icon}]},{tag:"img",contenteditable:!1,class:"1"===this.model.get("prefs")||"3"===this.model.get("prefs")?"preview-thumbnail-hidden preview-thumbnail no-media-layout-editor":"preview-thumbnail no-media-layout-editor",src:this.model.get("image")},{tag:"div",class:"preview-data-container",html:[{tag:"div",class:"preview-menu",html:[!0===this.options.editable?this.createPreferencesMenu(this.model):"",!0===this.options.editable?this.createDeleteIcon():""]},{tag:"div",class:"preview-title-container",html:[{tag:"div",class:"preview-title crop-title",html:((this.model.get("title").length>=63?this.formatTitle(this.model.get("title")):this.model.get("title"))||"").escapeHTML()+"<i class='fonticon fonticon-"+this.getIcon()+"'>"}]},{tag:"div",class:"preview-domain",html:[{tag:"span",class:"preview-domain",html:"by <a class='toAuthor' href='#people:"+this.model.get("authorID")+"'>"+this.model.get("authorName")+"</a> in <a class='toCommunity' href='#community:"+this.model.get("communityID")+"'>"+(this.model.get("communityName")||"").escapeHTML()+"</a>"}]},{tag:"span",class:"2"===this.model.get("prefs")||"3"===this.model.get("prefs")?"preview-desc-is-hidden preview-description no-media-layout-editor":"preview-description no-media-layout-editor crop-description",html:this.model.get("description").length>=150?this.model.get("description").replace(/^(.{150}[^\s]*).*/,"$1"):this.model.get("description")}]},{tag:"span",class:"url",html:{tag:"a",href:this.model.get("domain")}}]}]}),this.rendered=!0,this}})}),define("DS/SwymUIComponents/script/feature/core/ui-components/layout/sticky-column-view",["UWA/Core","UWA/Utils/Client","DS/SwymUIComponents/script/feature/core/ui-components/layout/column-view"],function(e,t,i){"use strict";var n=document.body.getSize();return i.extend({_lastTop:"",_wheelTimeout:null,name:"sticky-column-view",defaultOptions:{widget:null},domEvents:{"wheel .views-wrapper":"_triggerScrollingOnWholePage"},_ignoreMouseEvents:function(){var e=this.elements&&this.elements.viewsWrapper;e&&e.addClassName("ignore-mouse-events")},_stopIgnoringMouseEvents:function(){var e=this.elements&&this.elements.viewsWrapper;e&&e.removeClassName("ignore-mouse-events")},_triggerScrollingOnWholePage:function(e){this._wheelTimeout&&clearTimeout(this._wheelTimeout),this._ignoreMouseEvents(),this._wheelTimeout=setTimeout(this._stopIgnoringMouseEvents,1e3)},init:function(){this.updatePositioning=this.updatePositioning.bind(this),this.onWindowResize=this.onWindowResize.bind(this),this._stopIgnoringMouseEvents=this._stopIgnoringMouseEvents.bind(this),this._parent.apply(this,arguments),document.body.addEvent("resize",this.onWindowResize)},updatePositioning:function(e){var i,o,s,a,r,l="",c=this.getOption("widget"),d=this.elements.viewsWrapper,m=d.getSize(),u=this.container&&this.container.parentElement;if(d&&u)if(r=u.getBoundingClientRect(),(i=m.height-(c&&"3DSwym"===window.ds.env?c.body.getSize().height-(document.documentElement.clientWidth<969?0:39):n.height))<=0)d.style.position="",t.Platform.ios&&(d.style["-webkit-transform"]=""),d.style.transform="",this._lastTop=0;else{if(e&&!0===e.syncWithMainScroller&&this._mainScrollerContent)this._parentLastBoundingRect=r,s=-this._mainScrollerContent.scrollTop;else{if(a=d.getBoundingClientRect(),o=r.top-(this._parentLastBoundingRect&&this._parentLastBoundingRect.top||0),this._parentLastBoundingRect=r,o<0?l="down":o>0&&(l="up"),"up"===l?0===a.top&&(l=""):"down"===l&&a.top<-i&&(l=""),"down"!==l&&"up"!==l)return;s=(this._lastTop||0)+o}s>0?s=0:s<-i&&(s=-i),s!==this._lastTop&&(this._lastTop=s,t.Platform.ios&&(d.style["-webkit-transform"]="translate3d(0px,"+this._lastTop+"px,0px)"),d.style.transform="translate3d(0px,"+this._lastTop+"px,0px)")}},onParentHeightAlignment:function(){n=document.body.getSize(),this.updatePositioning({syncWithMainScroller:!0})},onWindowResize:function(){n=document.body.getSize(),this.updatePositioning()},onInjected:function(){var e=!1,t=this;this._mainScrollerContent=this.container.getParent(".scroller-content"),this._mainScrollerContent&&(this.onMainContentScroll=function(){window.requestAnimationFrame?(e||window.requestAnimationFrame(function(){t.updatePositioning(),e=!1}),e=!0):t.updatePositioning()},this._mainScrollerContent.addEvent("scroll",this.onMainContentScroll))},destroy:function(){return this._mainScrollerContent&&this._mainScrollerContent.removeEvent("scroll",this.onMainContentScroll),this._mainScrollerContent=null,document.body.removeEvent("resize",this.onWindowResize),this._parent.apply(this,arguments)}})});var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},__spreadArray=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var n,o=0,s=t.length;o<s;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};function getHostName(e){var t=e.match(/:\/\/(www[0-9]?\.)?(.[^/:]+)/i);return null!=t&&t.length>2&&"string"==typeof t[2]&&t[2].length>0?t[2]:null}define("DS/SwymUIComponents/script/utils/typing-indicator-manager",["require","exports","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUIComponents/script/utils/swym-vuex-store"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendUsersInThread=t.addThreadIds=t.onMessagePublish=t.typeIn=t.setThreadId=void 0;var o,s=document&&document,a=!isNaN(s&&s.RTStore&&s.RTStore.apiVersion);!function(e){e.THROTTLE="throttleId",e.DEBOUNCE="debounceId"}(o||(o={}));var r=void 0,l=new Map,c=function(e,t){var i,n=l.get(r);l.set(r,__assign(__assign({},n),((i={})[e]=t,i)))},d=function(e){return l.get(r)[e]};i.getInstanceFetched(function(e){n.commit("typingIndicator/setCurrentUser",e.get("login"))});var m=function(){n.dispatch("typingIndicator/startTyping")},u=function(){n.dispatch("typingIndicator/stopTyping")};t.setThreadId=function(e){e&&((0,t.onMessagePublish)(),r=e,l.set(r,{throttleId:void 0,debounceId:void 0}),a?(n.commit("typingIndicator/updateActiveThreadId",e),n.commit("typingIndicator/channels/push",{channel_id:e})):n.dispatch("typingIndicator/addThread",{threadId:e}))};t.typeIn=function(){!function(e){if(!d(o.THROTTLE)){var t=setTimeout(function(){e(),c(o.THROTTLE,void 0)},500);c(o.THROTTLE,+t)}}(m),function(e){var t=d(o.DEBOUNCE);clearTimeout(t);var i=setTimeout(e,1e3);c(o.DEBOUNCE,+i)}(u)};t.onMessagePublish=function(){!function(){if(r){var e=l.get(r),t=e.throttleId,i=e.debounceId;clearTimeout(t),clearTimeout(i),l.set(r,{throttleId:void 0,debounceId:void 0})}}(),u()},t.addThreadIds=function(e){a?n.commit("typingIndicator/channels/pushSeveral",{channel_id_array:e}):n.dispatch("typingIndicator/addThreads",{threadIds:e})};t.sendUsersInThread=function(e,t){a&&n.dispatch("typingIndicator/channels/setUserList",{channel_id:e,login_array:__spreadArray([],t,!0)})}}),define("DS/SwymUIComponents/script/feature/community/survey/view/answer-collection-view",["DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUICore/script/feature/community/survey/collection/answer-collection","DS/SwymUIComponents/script/feature/community/survey/view/answer-view"],function(e,t,i){return e.extend({_collectionClass:t,modelViewClass:i})}),define("DS/SwymUIComponents/script/feature/core/ui-components/layout/layout-view",["UWA/Core","UWA/Event","UWA/Array","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUIComponents/script/feature/core/ui-components/layout/layout-definition","DS/SwymUIComponents/script/feature/core/ui-components/layout/layout-manager","DS/SwymUIComponents/script/feature/core/ui-components/layout/column-view","DS/SwymUIComponents/script/feature/core/ui-components/layout/sticky-column-view","DS/WebappsUtils/Console","DS/SwymUICore/script/feature/core/config/bootstrap-model"],function(e,t,i,n,o,s,a,r,l,c,d){"use strict";const m=["community/mycontributions","community/stats","community/settings","people/aboutme","people/connections","people/settings","community/post","community/media","community/idea","community/iquestion","community/wiki","community/survey","community/post/edit","community/media/edit","community/idea/edit","community/iquestion/edit","community/wiki/edit","community/survey/edit","community/wedo","community/wedo/edit","community/social-event","community/social-event/edit"],u=["community/stats","community/settings","people/aboutme","people/connections","people/settings","community/post","community/media","community/idea","community/iquestion","community/wiki","community/survey","community/post/edit","community/media/edit","community/idea/edit","community/iquestion/edit","community/wiki/edit","community/survey/edit","community/wedo","community/wedo/edit","community/social-event","community/social-event/edit"],h=["people","admin-tenant","search"];return n.extend({className:"scroll-content",domEvents:{"animationend .fade-in-animation":"_onElementFadeIn","webkitAnimationEnd .fade-in-animation":"_onElementFadeIn"},defaultOptions:{setActiveTaggerProxyManagerUponNavigation:!0,pageModulesPath:null,alignHeightToChildViews:!1},_onElementFadeIn:function(e){var t=e.srcElement||e.target;t&&t.hasClassName("fade-in-animation")&&e.type.toLowerCase().indexOf("animationend")>=0&&t.removeClassName("fade-in-animation")},_createContent:function(){},_createProxyManager:function(e,t){var i=o.getInstance(),n=this.options.taggingContextManager.isProxyManager(e);return!n&&(n=this.options.taggingContextManager.createProxyManager(e,{persistTags:!i.isContentEditionContext()||!1===d.getInstance().isFeatureActivated("activate_explicit_tags_thru_server"),client:t}))},_onRequestForHeightAlignment:function(e){if(this.isVisible()){var t,i,n,o=0,s=void 0,a=this.getChildViews(),c=!1;if(this.container)for(s in a)a.hasOwnProperty(s)&&(t=a[s]).container&&t instanceof r&&(i=t.getViewsWrapper().getSize().height,t instanceof l?i>=o&&(o=i,c=!0):i>o&&(o=i,c=!1));0!==o&&!1!==c||(o=""),n=this.container.style.minHeight,!o&&n||o&&parseFloat(n)!==o?(this.container.setStyle("min-height",o),this._notifyChildViewsOfHeightAlignment()):e&&e.dispatchEvent("onParentHeightAlignment")}else this.addEventOnce("onShow",this._onRequestForHeightAlignment)},_notifyChildViewsOfHeightAlignment:function(){for(var e in this._childViews)this._childViews.hasOwnProperty(e)&&this._childViews[e].dispatchEvent("onParentHeightAlignment")},setup:function(t){if(this._parent.call(this,t),!this.options.pageModulesPath)throw new Error('The option "pageModulesPath" is compulsory and needs to be provided!');e.extendElement(document.body)},addChildView:function(t,i,n){if(!0===this.getOption("alignHeightToChildViews")){var o=this,s=e.clone(n,!1)||{},a=s.callback;return s.callback=function(e){if(e instanceof r&&o.reactTo(e,"onRequestForParentsHeightAlignment",o._onRequestForHeightAlignment),a)return a.apply(this,arguments)},this._parent.call(this,t,i,s)}return this._parent.apply(this,arguments)},maximize:function(e,t){var i=this.getChildView("center");e instanceof n&&!e.container.hasClassName("maximized")&&i.container.contains(e.container)&&(this.unMaximize(),this.dispatchEvent("onBeforeMaximize",[e,t]),this.container.addClassName("maximized"),e.container.addClassName("maximized"),e.listenToOnce(this,"onUnMaximize",function(){this.container.removeClassName("maximized"),this.dispatchEvent("onUnMaximize")}),e.dispatchEvent("onMaximize"),this.dispatchEvent("onMaximize",[e,t]))},onRender:function(){var e=o.getInstance();a.applyLayoutDefinition({layoutView:this,resetLayout:this.getOption("resetLayout"),pageModulesPath:this.getOption("pageModulesPath"),viewsDefaultParams:{taggingContextManager:this.getOption("taggingContextManager"),widget:this._widget},layoutSetupFunction:this.getOption("layoutSetupFunction")}),this.reactTo(a,{onMaximizeRequest:this.maximize,onUnMaximizeRequest:this.unMaximize,onViewShow:this.onViewShow,onViewHide:this.onViewHide,onSetInstanceTagsRequest:this.onSetInstanceTagsRequest}),this.onContextChange=this.onContextChange.bind(this),!0===e.addListener("onContextChange",this.onContextChange,this,!0)&&this.onContextChange()},unMaximize:function(){this.container.hasClassName("maximized")&&(this.container.removeClassName("maximized"),this.dispatchEvent("onUnMaximize"))},onViewShow:function(e,t){!0===e.getOption("toBeMaximized")&&this.maximize(e,e.getOption("maxizationOptions"))},onViewHide:function(e,t){!0===e.getOption("toBeMaximized")&&e.container.hasClassName("maximized")&&this.unMaximize(e)},onSetInstanceTagsRequest:function(e){var t,i,n,a=o.getInstance(),r=d.getInstance();if(window.ds&&"3DSwym"===window.ds.env&&!r.isBootstrapConditionMet("TopFrameInit"))return r.executeWhenBootstrapConditionIsMet("TopFrameInit",this.onSetInstanceTagsRequest.bind(this,e)),null;this.isVisible()&&this.options.taggingContextManager&&e&&(i=n=s.parseRoute(a.getLayoutPath()).route,(window.ds&&"3DSwym"!==window.ds.env||!n.startsWith("people"))&&((t=this.options.taggingContextManager.isProxyManager(i))?t.setClient(e):this._createProxyManager(i,e)))},onContextChange:function(e){const t=this,n=this.options.taggingContextManager;if(n&&!0===this.options.setActiveTaggerProxyManagerUponNavigation){const a=s.parseRoute(o.getInstance().getLayoutPath()).route;if(!i.detect(h,function(e){return a.match(e)})){window.ds&&"3DSwym"===window.ds.env?d.getInstance().executeWhenBootstrapConditionIsMet("TopFrameInit",function(){t._createProxyManager(a),n.setProxyManagerAsCurrent(a)}):(t._createProxyManager(a),n.setProxyManagerAsCurrent(a));const i=e&&e.previousAttributes&&(e.communityId&&e.previousAttributes.communityId!==e.communityId||e.dmId&&e.previousAttributes.dmId!==e.dmId),o=n.getProxyManager(a);o&&i&&o.refresh()}}-1===m.indexOf(void 0)?a.dispatchEvent("onInfiniteScrollActivationRequest"):a.dispatchEvent("onInfiniteScrollDesactivationRequest"),-1===u.indexOf(void 0)?a.dispatchEvent("onPullToRefreshActivationRequest"):a.dispatchEvent("onPullToRefreshDeactivationRequest")},propagateEvents:function(){c.log("in propagateEvents",arguments)},destroy:function(){return o.getInstance().removeListener("onContextChange",this.onContextChange),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/core/ui-components/layout/layout-with-scroll-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-view","DS/W3DXComponents/Views/Layout/ScrollView","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/utils/utils","DS/SwymUIComponents/script/feature/core/ui-components/layout/layout-manager","DS/SwymUIComponents/script/feature/core/ui-components/layout/layout-view"],function(e,t,i,n,o,s,a){"use strict";var r={x:0,y:0};return t.extend({_scrollerPositionBeforeMaximize:null,_scrollerPositionBeforeContextChange:null,_useInfiniteScroll:null,_lastScrollPosition:null,_lastScrollDownTime:null,_firstInfiniteScrollRequest:null,_needToDispatchOnInfiniteScroll:null,_managerAlreadyCleaned:null,name:"layout-with-scroll",className:"scroll-to-top",defaultOptions:{setActiveTaggerProxyManagerUponNavigation:!0,taggingContextManager:null,pageModulesPath:void 0,layoutSetupFunction:null,resetLayout:!1,useInfiniteScroll:!0,usePullToRefresh:!0,layoutExtraOptions:null},setup:function(e){this._lastScrollPosition||(this._lastScrollPosition={x:0,y:0}),this.onScroll=o.getDelayedSyncTask(this.onScroll.bind(this),200),this._parent.call(this,e),s.clean(),s.setTaggingContextManagerInstance(this.options.taggingContextManager),this.addScrollViewWithLayout(),this.addOtherViews(),this.reactTo(s,{onScrollToTopRequest:this.onScrollToTopRequest,onScrollToElement:this.onScrollToElement,onInfiniteScrollActivationRequest:this.onInfiniteScrollActivationRequest,onInfiniteScrollDesactivationRequest:this.onInfiniteScrollDesactivationRequest,onPullToRefreshActivationRequest:this.onPullToRefreshActivationRequest,onPullToRefreshDeactivationRequest:this.onPullToRefreshDeactivationRequest,onPageLoadRequest:this.onPageLoadRequest}),this.onContextChange=this.onContextChange.bind(this),n.getInstance().addListener("onContextChange",this.onContextChange,this,!0)},addOtherViews:function(){this.addChildView("backToTopView",{Class:"DS/SwymUIComponents/script/feature/core/ui-components/layout/back-to-top-view"})},addScrollViewWithLayout:function(){var t,n=this,o={taggingContextManager:this.options.taggingContextManager,setActiveTaggerProxyManagerUponNavigation:this.options.setActiveTaggerProxyManagerUponNavigation,widget:this._widget,events:{onBeforeMaximize:function(t,i){n.scrollView&&(n._useInfiniteScroll=n.scrollView.getOption("useInfiniteScroll"),i&&!1===i.deactivateInfiniteScroll||n.scrollView.setOption("useInfiniteScroll",!1),n._scrollerPositionBeforeMaximize=n._scrollerPositionBeforeContextChange||e.clone(r),n.scrollView.scroller&&n.scrollView.scroller.scrollTo(0,0))},onMaximize:function(){n.scrollView&&n.scrollView.usePullToRefresh(!1),n.dispatchEvent("onMaximize")},onUnMaximize:function(){n.scrollView&&(n._scrollerPositionBeforeMaximize||(n._scrollerPositionBeforeMaximize=e.clone(r)),n.scrollView.usePullToRefresh(!0),n.scrollView.setOption("useInfiniteScroll",n._useInfiniteScroll),setTimeout(function(){n.scrollView&&n.scrollView.scroller&&n.scrollView.scroller.scrollTo(-1*n._scrollerPositionBeforeMaximize.x,-1*n._scrollerPositionBeforeMaximize.y)},0)),n.dispatchEvent("onUnMaximize")}}};this.options.pageModulesPath&&(o.pageModulesPath=this.options.pageModulesPath),this.options.resetLayout&&(o.resetLayout=this.options.resetLayout),this.options.layoutSetupFunction&&(o.layoutSetupFunction=this.options.layoutSetupFunction),this.options.layoutExtraOptions&&e.merge(o,this.options.layoutExtraOptions),t=this.addChildView("layout",new a(o)),this.scrollView=this.addControl("scrollView",new i({view:t,useInfiniteScroll:void 0===this.options.useInfiniteScroll||this.options.useInfiniteScroll,usePullToRefresh:void 0===this.options.usePullToRefresh||this.options.usePullToRefresh})),this.listenTo(this.scrollView,{onPullToRefresh:this.onPullToRefresh,onInfiniteScroll:this.onInfiniteScroll})},_createContent:function(){return[this.getControl("scrollView"),this.getChildView("backToTopView")]},_dispatchOnInfiniteScrollIfNeeded:function(){var e=!1;return!this._firstInfiniteScrollRequest&&(this._lastScrollDownTime||this.scrollView&&this.scrollView.scroller&&1===this.scrollView.scroller.getProgress("y"))&&(e=!0,this._lastScrollDownTime=null,s.dispatchEvent("onInfiniteScroll",[this.scrollView])),e},onContextChange:function(){this.isVisible()&&(this._lastScrollDownTime=null,this._needToDispatchOnInfiniteScroll=!1,this.scrollView&&this.scrollView.scroller&&(this._scrollerPositionBeforeContextChange=this.getScrollerPosition()),s.dispatchEvent("onScrollToTopRequest"))},onPullToRefresh:function(){s.dispatchEvent("onPullToRefresh",[this.scrollView])},onInfiniteScroll:function(){null===this._firstInfiniteScrollRequest?this._firstInfiniteScrollRequest=!0:this._firstInfiniteScrollRequest=!1,this._dispatchOnInfiniteScrollIfNeeded()||(this._needToDispatchOnInfiniteScroll=!0)},onScrollToTopRequest:function(e){this.isVisible()&&this.scrollView&&this.scrollView.scroller&&this.scrollView.scroller.scrollTo(0,0,e||0)},onScrollToElement:function(e,t){this.isVisible()&&this.scrollView&&this.scrollView.scroller&&this.scrollView.scroller.scrollToElement(e,null,t||250)},onInfiniteScrollActivationRequest:function(){this.isVisible()&&this.scrollView&&this.scrollViewInjected&&"deactivated"!=this.scrollView.infiniteScrollState&&this.scrollView.useInfiniteScroll(!0)},onInfiniteScrollDesactivationRequest:function(){this.isVisible()&&this.scrollView&&this.scrollViewInjected&&"deactivated"==this.scrollView.infiniteScrollState&&this.scrollView.useInfiniteScroll(!1)},onPullToRefreshActivationRequest:function(){this.isVisible()&&this.scrollView&&this.scrollViewInjected&&this.scrollView.usePullToRefresh(!0)},onPullToRefreshDeactivationRequest:function(){this.isVisible()&&this.scrollView&&this.scrollViewInjected&&this.scrollView.usePullToRefresh(!1)},onPageLoadRequest:function(e,t){this.isVisible()&&this.scrollView&&this.scrollView.scroller&&(null===this._firstInfiniteScrollRequest?this._firstInfiniteScrollRequest=!0:this._firstInfiniteScrollRequest=!1,require(["DS/SwymUIComponents/script/utils/scrollview-utils"],function(i){i.onInfiniteScroll.apply({collection:e,scrollView:this.scrollView,options:t})}.bind(this)))},getScrollerPosition:function(){var e=null;return this.scrollView&&this.scrollView.scroller&&(e=this.scrollView.scroller.getPosition()),e},onScroll:function(){var e,t=this.getChildView("backToTopView"),i=this.getScrollerPosition();i&&(e={position:i,delta:{x:i.x-this._lastScrollPosition.x,y:i.y-this._lastScrollPosition.y}},s.dispatchEvent("onScroll",[this.scrollView,e]),!0===this._needToDispatchOnInfiniteScroll&&e.delta.y<0&&(this._lastScrollDownTime=new Date,this._dispatchOnInfiniteScrollIfNeeded(),this._needToDispatchOnInfiniteScroll=!1),0===i.y?(this.container.addClassName("scroll-to-top"),t&&t.hide()):(this.container.removeClassName("scroll-to-top"),e&&e.delta.y<0&&-1*i.y>document.body.getSize().height&&t&&t.show())),this._lastScrollPosition=i},onRedraw:function(){this.renderScrollView()},renderScrollView:function(){var e=this.getControl("scrollView");e&&"function"==typeof e.render&&(e.render(),this.listenTo(e.scroller.elements.content,"scroll",this.onScroll),this.listenTo(e,"onInjected",this.onScrollViewInjected))},onScrollViewInjected:function(){this.scrollViewInjected=!0},usePullToRefresh:function(e){this.scrollView&&this.scrollViewInjected&&this.scrollView.usePullToRefresh(e)},destroy:function(){return this.scrollView=null,n.getInstance().removeListener("onContextChange",this.onContextChange),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/question/question-view",["UWA/Core","DS/SwymUICore/script/feature/community/iquestion/model/iquestion-model","DS/SwymUIComponents/script/feature/core/ui-components/list/list-item/item-view"],function(e,t,i){"use strict";return i.extend({_modelClass:t,name:"question-view",getClassNames:function(){return(this._parent.apply(this,arguments)||"")+" one-column"},defaultOptions:{summaryViewClass:"DS/SwymUIComponents/script/feature/community/question/view/question-summary-view",detailedViewClass:"DS/SwymUIComponents/script/feature/community/question/view/question-detailed-view",editViewClass:"DS/SwymUIComponents/script/feature/community/question/edit/question-edit-view"}})}),define("DS/SwymUIComponents/script/feature/community/content/view/content-list-view",["UWA/Core","UWA/Array","DS/SwymUICore/script/lib/event-manager","DS/SwymUIComponents/script/feature/core/ui-components/list/item-list","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/core/context/context-constants","DS/SwymUICore/script/lib/model/model-manager","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUIComponents/script/feature/community/post/post-view","DS/SwymUIComponents/script/feature/community/media/view/media-view","DS/SwymUIComponents/script/feature/community/question/question-view","DS/SwymUIComponents/script/feature/community/idea/idea-view","DS/SwymUIComponents/script/feature/community/wiki/wiki-view","DS/SwymUIComponents/script/feature/community/wedo/wedo-view","DS/SwymUIComponents/script/feature/community/survey/survey-view","DS/SwymUIComponents/script/feature/community/social-event/social-event-view","DS/SwymUIComponents/script/feature/core/ui-components/layout/layout-manager","DS/SwymUIComponents/script/feature/community/content/view/content-list-mobile-mixin","DS/UIKIT/Alert","DS/UWPClientCode/I18n","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/view/content-list-view","DS/SwymUICore/script/feature/core/context/context-constants","DS/SwymUIComponents/script/feature/container/content/cockpit/cockpit-view"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w,C,f,y,v,A,_){"use strict";var S=window.ds&&"MOBILE"===window.ds.env,b=o.getInstance(),I=window.ds&&window.ds.isMDE,D=n.extend({name:"content-list-view",modelViewClass:{post:l,media:c,iquestion:d,idea:m,survey:p,wiki:u,wedo:h,"social-event":g,cockpit:_},imageReloadOptions:{size:"xl",optimiseUserPictures:!0},defaultOptions:{comments:!0,showAnswers:!0,realtime:!0,mutualizeCommentsInitCalls:!0,showAuthorSection:!0},_alert:null,modelViewsCfg:function(t){var i=this._parent.apply(this,arguments),n={},o=t.getContainerType(),s=t.getModelName();return this.options?(n.showAnswers=this.getOption("showAnswers"),n.comments="iquestion"!==s&&this.getOption("comments"),n.showAuthorSection=this.getOption("showAuthorSection"),n.showThreadLink=!b.isDirectMessageContext()&&(e.is(b.contentType)||"home"===b.path||e.is(b.userHashKey)||""===b.path)||this.getOption("showThreadLink")||"rituals"===b.path||b.path.startsWith("ritual:"),n.socialToolbarMode=this.getOption("socialToolbarMode")||null):(n=e.clone(this.defaultOptions),"iquestion"===s&&(n.comments=!1)),o&&o!==A.COMMUNITY_URL_PART&&(n.ActionMenuClass=null),e.merge(n,i)},domEvents:{"click .content-in-feed-summary-view-container .content-icon":"onItemClick","click .content-in-feed-summary-view-container .content-summary-section":"onItemClick","click .content-in-feed-summary-view-container .validated-answer":"onItemClick","dragstart .content-in-feed-summary-view-container":"onItemDragStart"},itemViewSelector:".content-in-feed-view-container",_communityId:null,_feedMode:null,_prevConfig:null,_onPublishing:function(t,i){var n,o=t.getModelName(),s=t.getContentType&&t.getContentType()||t.getModelName(),a=this.collection,r=this.collection.comparator&&(!i||!1!==i.sort);!o||null!==a.communityId&&t.getCommunity().get("mid")!==a.communityId||(null===a.communityId?!0===t.getCommunity().get("isBlacklisted")?(this._alert||(this._alert=new f({className:"wp-alert",visible:!0}).inject(document.body,"top")),this._alert.add({className:"primary",message:y.replace(v[t.getModelName()+"CreationMessage"],{TitleLink:'<a data-content-type="'+s+'" data-content-id="'+t.get("mid")+'">'+t.get("title")+"</a>"})})):("media"===o&&!0!==t.get("is_illustration")&&"1"!==t.get("is_illustration")||"wiki"===o&&0!==parseInt(t.get("visibility"),10)&&2!==parseInt(t.get("visibility"),10)||"media"!==o&&"wiki"!==o)&&a[r?"add":"unshift"](t):("media"===o&&!0!==t.get("is_illustration")&&"1"!==t.get("is_illustration")||"wiki"===o&&0!==parseInt(t.get("visibility"),10)&&2!==parseInt(t.get("visibility"),10)||"media"!==o&&"wiki"!==o)&&(!(n=e.is(this.collection.model.prototype.getModelName))||n&&this.collection.model.prototype.getModelName()===o)&&a[r?"add":"unshift"](t))},_onDestroy(e){const t="wiki"===e.getModelName(),i=this.collection;i&&t&&(null===i.communityId||e.getCommunity().get("mid")===i.communityId)&&require(["DS/SwymUICore/script/feature/community/wiki/model/wiki-model","DS/SwymUICore/script/feature/community/wiki/model/wikitree-model"],(t,n)=>{const o=e._subPages||[];i.remove(o.map(e=>new t({mid:e})));const s=new n({community_id:e.getCommunity().get("mid")});s.hasBeenFetched()&&s.fetch()})},_updateCollection:function(t,i){var n,o;this.isDestroyed()||(this.setCollection(new t([],e.merge({communityId:b.communityId||b.ritualId,ritualId:b.ritualId,infiniteScroll:!0},i&&i.collectionOptions?e.extend(this.options.collectionOptions,i.collectionOptions):this.options.collectionOptions))),n=this.collection,o=e.merge(i?e.extend({},i):{},this.options.fetchOptions||{}),w.dispatchEvent("onPageLoadRequest",[n,o]),this.dispatchEvent("onPageLoadRequest",[n,o]),window.ds&&"3DSwym"===window.ds.env&&b.dispatchEvent("onPageLoad",[],!0))},updateCollection:function(e){var t=this;t.options.collectionClass&&(t.container&&t.container.empty(),"string"==typeof t.options.collectionClass?require([t.options.collectionClass],function(i){t._updateCollection(i,e)}):t._updateCollection(t.options.collectionClass,e))},onAfterInit:function(){this.options.refreshOnCommunityChange?(b.removeListener("onCommunityChange",this.onCommunityChange),this.onCommunityChange=this.onCommunityChange.bind(this),b.addListener("onCommunityChange",this.onCommunityChange,this,!0),this.onFeedModeChangeBound||(this.onFeedModeChangeBound=this.onFeedModeChange.bind(this)),b.removeListener("onFeedModeChange",this.onFeedModeChangeBound),b.addListener("onFeedModeChange",this.onFeedModeChangeBound,this,!0),b.removeListener("onContextChange",this.onContextChange),this.onContextChange=this.onContextChange.bind(this),b.addListener("onContextChange",this.onContextChange,this,!0)):this.updateCollection()},setup:function(){this._parent.apply(this,arguments),this._prevConfig={},this.addEventOnce("onInit",this.onAfterInit,this,-10),this._onPublishingBound||(this._onPublishingBound=this._onPublishing.bind(this),a.addListenerOnPublishing(this._onPublishingBound)),this._onDestroyBound||(this._onDestroyBound=this._onDestroy.bind(this),a.addListenerOnDestroy(this._onDestroyBound)),this.reactTo(i,"requestContentListUpdate",this.onRequestContentListUpdate),this.reactTo(w,{goToMainWhatsnew:function(){this.isVisible()&&(w.dispatchEvent("onScrollToTopRequest"),this.updateCollection({reset:!0,remove:!0,add:!0}))}})},_getBlacklistedCommunities:function(e){var t=this;require(["DS/SwymUICore/script/feature/community/community/collection/community-collection"],function(i){t._communityCollection=new i([],{mode:"my-communities-detailed",limit:999}),t._communityCollection.getmyblacklist({onComplete:function(i){t._blacklistedCommunities=i,t._showRealtimeAlertMessage(e)},onFailure:function(){t._blacklistedCommunities=[],t._showRealtimeAlertMessage(e)}})})},_isInBlacklistedCommunity:function(e){var t=!1;return this._blacklistedCommunities.forEach(function(i){e.target.id.toString()===i.get("mid").toString()&&(t=!0)}),t},_showRealtimeAlertMessage:function(e){var t=this;require(["DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/UIKIT/Alert"],function(i,n){i.getInstanceFetched(function(i){i.get("login")!==e.author.login&&(t.realtimeAlert||(t.realtimeAlert=new n({visible:!0,autoHide:!0,hideDelay:5e3,icon:"up",events:{onClick:function(e){e.target.className.indexOf("close")<0&&(t.updateCollection(),w.dispatchEvent("onScrollToTopRequest"))}},className:"wp-alert alert alert-root cursor-pointer"}).inject(document.body||t.container||window.body,"top")))})})},onRequestContentListUpdate:function(e){("home"===e.contextPath&&!this.options.refreshOnCommunityChange||!0===e.reloadAfterMediaVisibilityChange)&&(this.isVisible()?this.updateCollection():this.addEventOnce("onShow",this.updateCollection))},findModelView:function(e){return t.detect(this.getModelViews(),function(t){if(t&&t.model)return t.model.equals(e)})},onItemSelect:function(){return this.goToContent.apply(this,arguments),this._parent.apply(this,arguments)},goToContent:function(e){var t=e&&e.model;I?require(["DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/feature/container/container-utils","DS/SwymUICore/script/feature/core/context/context-model"],function(e,i,n){if(t.getSource&&t.getSource()&&-1===t.getSource().indexOf("swym")){var o=i.getContainerTypeFromSource(t.getSource()),s=n.getInstance();e.goToContentInContainer({containerType:o,containerId:i.getContainerIdFromSource(o,t),quadrant:s.quadrant,contentId:t.get("mid")})}else e.goToContent(t.get("mid"),t.getModelName(),t.get("community->mid"))}):require(["DS/SwymUICore/script/utils/navigation"],function(e){e.goToContent(t.get("mid"),t.getModelName(),t.get("community->mid"))})},onFeedModeChange:function(){this.isVisible()&&b.isCommunityContext()&&this._feedMode!==b.feedMode&&(this._feedMode=b.feedMode,this.updateCollection())},onCommunityChange:function(){(b.isCommunityContext()||b.isRitualContext())&&this._communityId!==(b.communityId||b.ritualId)&&(this.isVisible()?(this._communityId=b.communityId,this.updateCollection()):this.addEventOnce("onShow",this.onCommunityChange))},onContextChange:function(){const e=b.getCommunityDerivedTypePageContext(),t=e&&e.startsWith(s.COMMUNITY_POST_DERIVED_TYPE_PAGE_PREFIX),i=e&&e.startsWith(s.COMMUNITY_IDEA_DERIVED_TYPE_PAGE_PREFIX),n=this.collection&&"post-dt-collection"===this.collection.getCollectionName(),o=this.collection&&"idea-dt-collection"===this.collection.getCollectionName(),a=this._prevConfig.derivedTypeModel,r=a&&a.startsWith(s.COMMUNITY_POST_DERIVED_TYPE_PAGE_PREFIX),l=a&&a.startsWith(s.COMMUNITY_IDEA_DERIVED_TYPE_PAGE_PREFIX);e&&(a&&(r&&t&&e!==a||l&&i&&e!==a)&&this.updateCollection(),n&&t&&(this._prevConfig.derivedTypeModel=e),o&&i&&(this._prevConfig.derivedTypeModel=e))},destroy:function(){return b.removeListener("onCommunityChange",this.onCommunityChange),this.collection&&this.collection.clean&&this.collection.clean(),this._onPublishingBound&&a.removeListenerOnPublishing(this._onPublishingBound),this._onDestroyBound&&a.removeListenerOnDestroy(this._onDestroyBound),this._parent.apply(this,arguments)}});return S&&(D=D.extend(C)),D}),define("DS/SwymUIComponents/script/feature/core/ui-components/list/list-item/item-highlight-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUIComponents/script/feature/core/ui-components/list/list-item/item-view","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUIComponents/script/feature/core/ui-components/list/item-list","DS/SwymUIComponents/script/feature/community/content/view/content-list-view","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/lib/model/generic/swym-model"],function(e,t,i,n,o,s,a,r,l,c){"use strict";var d=o.getInstance(),m=n.extend({name:"item-highlight-view",itemViewSelector:".content-in-feed-view-container",defaultOptions:{summaryViewClass:"DS/SwymUIComponents/script/feature/community/content/view/content-highlight-view",comments:!1,showAnswers:!1},onItemClick:function(){var e=this.model;require(["DS/SwymUICore/script/utils/navigation"],function(t){t.goToContent(e.get("mid"),e.getModelName(),e.get("community->mid"))})},_onContentHighlightedUpdate:function(){var e=this.communityModel.get("highlighted_content_uri"),t="";this.communityModel.isContentHighlightHidden({onComplete:function(i,n){n&&(e=""),e?(t=l.extractDataFromSubject6wURI(e),(!this.model||this.model&&this.model.get("mid")!==t.extraAttrs.mid)&&require([c.getModuleNameFromModelName(t.modelName,t.modelAMDModuleRoot)],function(i){this.model=new i({mid:"social-event"===t.modelName?e:t.extraAttrs.mid}),this.model.fetch({fromCache:!0,onComplete:function(){this.onContextChange(),this.refresh()}.bind(this)})}.bind(this))):(this.model=null,this.hide())}.bind(this)})},_onContentHighlightMaskUpdate:function(){},onShow:function(){this.model&&d.communityId===this.model.getCommunity().get("mid")||this.hide()},onCommunityChange:function(e){!e.ritualId&&e.communityId&&(this.hide(),this.communityModel=new s({mid:e.communityId}),this.listenTo(this.communityModel,{"onSync:read":this._onContentHighlightedUpdate,"onSync:update":this._onContentHighlightedUpdate,"onSync:contentHighlightMask":this._onContentHighlightMaskUpdate}),this._onContentHighlightedUpdate())},onFilteringChange:function(e){this.communityModel&&d.communityId===this.communityModel.get("mid")&&(this._filteringActive=e,e?this.hide():this.show())},onContextChange:function(){d.isCommunityHomePageContext()?this.show():this.hide()},hide:function(){this.container&&this.container.addClassName("hidden"),this._parent()},show:function(){this.container&&this.container.removeClassName("hidden"),this._parent()},init:function(){this._parent.apply(this,arguments),this.onCommunityChange=this.onCommunityChange.bind(this),d.addListener("onCommunityChange",this.onCommunityChange,this,!0),this.onFilteringChange=this.onFilteringChange.bind(this),d.addListener("onFilteringChange",this.onFilteringChange,this,!0),this.onContextChange=this.onContextChange.bind(this),d.addListener("onContextChange",this.onContextChange,this,!0)},createDummyView:function(){return new(i.extend({name:"dummy-view"}))},destroy:function(){return d.removeListener("onContextChange",this.onContextChange,this),d.removeListener("onFilteringChange",this.onFilteringChange,this),d.removeListener("onCommunityChange",this.onCommunityChange,this),this._parent.apply(this,arguments)}});return m.implement({_onResize:r.prototype._onResize,domEvents:r.prototype.domEvents,onItemDragStart:a.prototype.onItemDragStart,onItemDrag:a.prototype.onItemDrag}),m}),define("DS/SwymUIComponents/script/feature/core/user/view/macro/user-app-view",["UWA/String","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/macro/user-app-view","DS/W3DXComponents/IdCard","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUIComponents/script/feature/core/user/view/uploadPicture-view","DS/SwymUIComponents/script/feature/core/network/view/invitation-layer-view","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/navigation","DS/PubSub/PubSub","DS/SwymUIComponents/script/feature/core/user/view/edit-all-bar/edit-all-bar","DS/SwymUICore/script/utils/i18n","DS/SwymUIComponents/script/feature/core/user/view/idcard/user-idcard-bottom-bar","DS/SwymUIComponents/script/feature/core/user/view/macro/user-column-details-view","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUIComponents/script/feature/community/content/view/content-list-view","DS/SwymUIComponents/script/feature/core/ui-components/layout/layout-definition","DS/SwymUIComponents/script/feature/core/ui-components/layout/layout-manager","DS/WebappsUtils/WebappsUtils"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w,C,f,y){"use strict";var v=p.extend({attributes:{id:"facet-target-1",class:"col-lg-9 col-md-9 col-sm-8 col-xs-12"}}),A=p.extend({attributes:{id:"facet-target-2",class:"col-lg-9 col-md-9 col-sm-8 col-xs-12"}}),_=p.extend({attributes:{id:"facet-target-3",class:"facet-profile"}}),S=p.extend({attributes:{id:"facet-target-4",class:"facet-profile"}});return n.extend({name:"user-app-view",_modelClass:o,_facetInstanciated:[!1,!1,!1,!1],_idCardInstance:null,_invitationStatus:null,_updateTopBar:function(){window.ds&&"3DD"!==window.ds.env&&require(["DS/TopBar/TopBar","DS/SwymUICore/script/feature/core/user/model/currentuser-model","i18n!DS/SwymUIComponents/assets/nls/feature/core/tenant/view/super-user-button-view"],function(e,t,i){e&&t.getInstanceFetched(function(t){var n="";if(this.model){t.get("login")===this.model.get("login")&&"1"===t.get("tenant_su")&&(n=i.Browsingallcontent);try{e._model&&e.set({userName:this.model.getNickname().unescapeHTML()+n})}catch(e){console.error(e)}}}.bind(this))}.bind(this))},_onPeopleTabChange:function(e){var t=this.getIdCardInstance(),i=parseInt(e.tabNumber,10)||0;t.container&&t.getSelectedFacet()!==i&&t.selectFacet(i)},onSetInstanceTagsRequest:function(e){var t,i,n=g.getInstance(),o="";if(this.isVisible()&&this.options&&this.options.taggingContextManager&&e&&"user-collection"!==e._collectionName&&(t=C.parseRoute(n.getLayoutPath()).route,window.ds&&"3DSwym"!==window.ds.env||t.startsWith("people"))){for(var s in this.proxyManager=null,i=this.options.taggingContextManager.getActiveProxiesManagers())if(i.hasOwnProperty(s)&&s.startsWith("people")){o=s,this.proxyManager=i[s];break}this.proxyManager||(this.proxyManager=this.options.taggingContextManager.isProxyManager(o||t)),this.proxyManager?this.proxyManager.setClient(e):this.proxyManager=this.options.taggingContextManager.createProxyManager(o||t,{persistTags:!n.isContentEditionContext(),client:e})}},init:function(){return this._onPeopleTabChange=this._onPeopleTabChange.bind(this),this._parent.apply(this,arguments)},setup:function(e){return!0===this.model.isCurrentUser()&&(this.listenTo(this.model,{onPassportSynced:this._updateTopBar}),this._updateTopBar()),this.reactTo(f,{onSetInstanceTagsRequest:this.onSetInstanceTagsRequest}),this.context=g.getInstance(),this.context.addListener("onPeopleTabChange",this._onPeopleTabChange,this,!0),e=e||{},this._parent.apply(this,arguments)},domEvents:{"click .facets-list .facet:nth-child(1)":"clickFirstFacet","click .facets-list .facet:nth-child(2)":"clickSecondFacet","click .facets-list .facet:nth-child(3)":"clickThirdFacet","click .facets-list .facet:nth-child(4)":"clickFourthFacet"},clickFirstFacet:function(){g.getInstance().getPathFromUrl()!==this.model.getRelativePath()&&l.goToUrl(this.model.getRelativePath())},clickSecondFacet:function(){g.getInstance().getPathFromUrl()!==this.model.getRelativePathToActivities()&&l.goToUrl(this.model.getRelativePathToActivities())},clickThirdFacet:function(){g.getInstance().getPathFromUrl()!==this.model.getRelativePathToConnections()&&l.goToUrl(this.model.getRelativePathToConnections())},clickFourthFacet:function(){g.getInstance().getPathFromUrl()!==this.model.getRelativePathToSettings()&&l.goToUrl(this.model.getRelativePathToSettings())},_createContent:function(){return this._idCardInstance=this.getIdCardInstance(),this._facetInstanciated=[!1,!1,!1,!1],[{html:this.addControl("idcard",this._idCardInstance)},{id:"facet-target-1-and-2",class:"facet-profile row",styles:{"padding-top":"10px"},html:[{id:"facet-fixed-column",class:"col-lg-3 col-md-3 col-sm-4 col-xs-12"},this.addChildView("facet-target-1",new v),this.addChildView("facet-target-2",new A)]},this.addChildView("facet-target-3",new _),this.addChildView("facet-target-4",new S)]},displayView:function(e){for(var t,i=this.getElement("#facet-target-1-and-2"),n=1;n<5;n++){if(!(t=this.getChildView("facet-target-"+n)))throw new Error("Facet view not found");n!==e?t.hide():t.show()}e>2?i.hide():i.show(),i&&(1===e?i.addClassName("first-tab-selected"):i.removeClassName("first-tab-selected")),2!==e&&d.hide()},getIdCardInstance:function(){return null!==this._idCardInstance?this._idCardInstance:this.buildIdCard()},buildIdCard:function(){var n=this,c=!0===this.model.isCurrentUser()&&!1===r.getInstance().get("config").tenant.block_userpicture_upload;return new i({model:this.model,attributesMapping:{title:function(){var e="",i="";return e=this.get("login")!==this.get("hash_key")?this.get("login")&&!0===this.isCurrentUser()?" - "+this.get("login"):"":this.get("username")&&!0===this.isCurrentUser()?" - "+this.get("username"):"",2==this.get("ut_state")?i="("+t.get("hasNoAccessTo3DSwymAnymore")+")":3==this.get("ut_state")&&(i="("+t.get("wasRemoved")+")"),this.getNickname()+e+" "+i},description:function(){var t=this.get("job_title")||"",i=this.get("company")||"",n=this.get("city")||"",o=this.get("country")||"",s="",a="";return s=""!==t?t+" - "+i:i,n?a="("+n+", "+o+")":o&&(a="("+o+")"),e.unescapeHTML(s+" "+a)}},bannerUrl:function(){return y.getWebappsBaseUrl()+"SwymUIComponents/assets/profile/ProfileBanner.jpg"},thumbnail:{url:o.constructUserPictureUrl(this.model.get("login"),this.model.get("user_picture_fingerprint")),squareFormat:!0,alwaysEditable:c},editableElements:[c?"thumbnail":"","title"],editView:"DS/SwymUIComponents/script/feature/core/user/view/idcard/user-idcard-edit-view",actions:function(){var e=[];if(this.model)return this._invitationStatus&&!this.model.isCurrentUser()&&"0"==this._invitationStatus.user_in_network&&(e="new"==this._invitationStatus.connected_user_to_user?[{text:t.pendinginvitation,icon:"user-add",handler:function(){this.alert("info",t.alreadySentInvitation)}.bind(this)}]:[{text:t.addToYourConnections,icon:"user-add",handler:function(){var e=new a({model:this.model}),i=function(){this._invitationAlreadySent=!0}.bind(this);!0!==this._invitationAlreadySent?e.launch(i):this.alert("info",t.alreadySentInvitation)}.bind(this)}]),this.model.isCurrentUser()&&(this.model.isEditableByPassport("first_name")||this.model.isEditableByPassport("last_name"))&&e.push({text:t.updateyourprofileinfo,icon:"pencil",handler:function(){var e=this.getIdCardInstance();e&&e.switchToEditMode()}.bind(this)}),e}.bind(this),facets:function(){var e=[{text:t.OverView,icon:"home",handler:function(){this.displayDefaultFacet(),this.options.taggingContextManager&&this.options.taggingContextManager.setProxyManagerAsCurrent(l.USER_PROFILE+"/"+l.PEOPLE_ABOUTME)}.bind(n)},{text:t.About,icon:"user",handler:function(){this._facetInstanciated[1]||(this.instantiateFacetTwo(),this._facetInstanciated[1]=!0),this._facetInstanciated[9]||(this.instantiateFixedColumn(),this._facetInstanciated[9]=!0),this.displayView(2),this.options.taggingContextManager&&this.options.taggingContextManager.setProxyManagerAsCurrent(l.USER_PROFILE+"/"+l.PEOPLE_ACTIVITIES),this.model.readwithoutcache({onComplete:function(){f.dispatchEvent("onSetInstanceTagsRequest",[n.model])}})}.bind(n)}];return r.getInstance().isFeatureActivated("activate_user_network")&&e.push({text:t.Network,icon:"users",handler:function(){this._facetInstanciated[2]||(this.instantiateFacetThree(),this._facetInstanciated[2]=!0),this.displayView(3),this.options.taggingContextManager&&this.options.taggingContextManager.setProxyManagerAsCurrent(l.USER_PROFILE+"/"+l.PEOPLE_CONNECTIONS)}.bind(n)}),this.isCurrentUser()&&e.push({text:t.ProfileManagement,icon:"cog",handler:function(){this._facetInstanciated[3]||(this.instantiateFacetFour(),this._facetInstanciated[3]=!0),this.displayView(4),this.options.taggingContextManager&&this.options.taggingContextManager.setProxyManagerAsCurrent(l.USER_PROFILE+"/"+l.PEOPLE_SETTINGS)}.bind(n)}),e},events:{onSwitchToEditMode:function(e){var t=this.getChildView("bottom-bar");t?t.show():(t=this.addChildView("bottom-bar",new u({idcardInstance:e}))).render(e.container)}.bind(this),onSwitchToViewMode:function(){var e=this.getChildView("bottom-bar");e&&e.hide()}.bind(this),onFacetSelect:function(){this.dispatchEvent("onFacetSelect",arguments)}.bind(this),onThumbnailChangeRequest:function(){var e,t=new s({widget:this._widget,model:this.model}),i=this.getControl("idcard");t.launch(function(){if(i){var t=(e=i.getElement(".thumbnail")).getStyle("background-image");e&&e.setStyle("background-image",t.replace("update/","update/7"))}window.ds&&"3DD"!==window.ds.env&&require(["DS/TopBar/TopBar"],function(e){try{e.set({picture:o.constructUserPictureUrl(n.model.get("login"),Math.random())})}catch(e){console.error(e)}})})}.bind(this)}})},displayDefaultFacet:function(){this._facetInstanciated[0]||(this.instantiateFacetOne(),this._facetInstanciated[0]=!0),this._facetInstanciated[9]||(this.instantiateFixedColumn(),this._facetInstanciated[9]=!0),this.displayView(1)},instantiateFixedColumn:function(){this.addChildView("left-column",{Class:h,model:this.model}).render(this.getElement("#facet-fixed-column"))},instantiateFacetOne:function(){if(!this.isDestroyed()){var e=new(w.extend({_createContent:function(){for(var e=this.getModelViews(),t=0,i=e.length;t<i;t++)e[t].container.setStyle("opacity","0");return this._parent.apply(this,arguments)},onItemSelect:function(){return this._parent.apply(this,arguments)}}))({widget:this._widget,useDynamicGrid:!0,dynamicGridOptions:{layout:"medium",variableSizeItem:!0,itemSelector:".content-in-feed-view-container"},collectionClass:"DS/SwymUICore/script/lib/collection/mixed-collection",collectionOptions:{mode:"whats-new",limit:8,hash_key:this.model.get("hash_key"),fetchTagsSeparatelyOnRefresh:!0}});e.render(this.getElement("#facet-target-1")),this.getChildView("facet-target-1").addChildView("activitiesView",e)}},instantiateFacetTwo:function(){require(["DS/SwymUIComponents/script/feature/core/user/view/macro/user-aboutme-view"],function(e){if(!this.isDestroyed()){var t=new e({model:this.model,widget:this._widget});t.render(this.getElement("#facet-target-2")),this.getChildView("facet-target-2").addChildView("userView",t)}}.bind(this))},instantiateFacetThree:function(){require(["DS/SwymUIComponents/script/feature/core/user/view/macro/user-connections-view"],function(e){if(!this.isDestroyed()){var t=new e({model:this.model,widget:this._widget});t.render(this.getElement("#facet-target-3")),this.getChildView("facet-target-3").addChildView("connectionsView",t)}}.bind(this))},instantiateFacetFour:function(){require(["DS/SwymUIComponents/script/feature/core/user/view/macro/user-settings-view"],function(e){if(!this.isDestroyed()){var t=new e({model:this.model,widget:this._widget});t.render(this.getElement("#facet-target-4")),this.getChildView("facet-target-4").addChildView("settingsView",t)}}.bind(this))},onSetModel:function(e,t,i){var n=this;i.isCurrentUser()||(this._invitationStatus=null,i.getInvitationStatus({onComplete:function(e,t){n._invitationStatus=t.result,n._idCardInstance&&n._idCardInstance.render()}}))},destroy:function(){return this.context.removeListener("onPeopleTabChange",this._onPeopleTabChange),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/content/social-interactions/action-bar-view",["UWA/Core","UWA/Utils/Client","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/social-interactions/action-bar-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/post/model/post-model","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/community/iquestion/model/iquestion-model","DS/SwymUICore/script/feature/community/idea/model/idea-model","DS/SwymUICore/script/feature/community/wiki/model/wiki-model","DS/SwymUICore/script/feature/community/wedo/model/wedo-model","DS/SwymUICore/script/feature/community/social-event/model/social-event-model","DS/SwymUICore/script/feature/community/iquestion/model/iq-answer-model","DS/SwymUIComponents/script/feature/community/content/view/content-small-view-factory","DS/SwymUIComponents/script/feature/core/ui-components/tooltip/responsive-button-tooltip","DS/UIKIT/Input/Button","DS/UIKIT/DropdownMenu","DS/SwymUICore/script/utils/localstorage-manager","DS/Logger/Logger"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w,C){"use strict";var f=m.LocalStorageKeyForSort,y=m.DateField,v=m.VoteField;return n.extend({_modelClass:[o,s,a,r,m,l,c,d],name:"action-bar-view",defaultOptions:{enableLike:!0,enableShare:!0},_modelEventsForAutoRefresh:["onChange:current_user_endorse","onChange:nb_answers","onChange:nb_comments"],domEvents:{"click .comments > button":"_focusComment","click .share":"_share","click .answer-sort":"_onAnswerSortClick"},setup:function(e){var t=e.widget||e._widget||window.widget;if(!t)throw new Error("No widget instance provided");this._widget=t,this._parent.apply(this,arguments)},_onAnswerSortClick:function(e){this._buildDropDownMenu(e.target)},_buildDropDownMenu:function(e){var t,n=this.getControl("answerSortDropDownMenu");n||(t=w.getItem(f),n=this.addControl("answerSortDropDownMenu",new g({target:e.getParent(),bound:!0,renderTo:window.document.body.getElement(".scroll-content"),items:[{name:"date",text:i.ByDate,selected:t!==v,selectable:!0},{name:"vote",text:i.ByVote,selected:t===v,selectable:!0}],events:{onClick:function(e,t){try{switch(t.name){case"date":this.changeSortingField(y);break;case"vote":this.changeSortingField(v)}}catch(e){C.error("Could not save sort field to local storage",e)}}.bind(this)}}))),n.show()},_share:function(){var e=this.model,t=this._widget;require(["DS/SwymUIComponents/script/feature/core/share/view/share-content-view"],function(i){new i({model:e,widget:t}).launchModal()})},_focusComment:function(){this.dispatchEvent("onCommentCreatorFocusRequest")},onRender:function(){var e=w.getItem(f)||y;this.changeSortingField(e),this.dispatchEvent("onActionBarRendered")},_createContent:function(){var e,n=this.model,o=!0===n.get("current_user_endorse"),s=i.Answer,a=this.addControl("commentButton",new p({value:s,icon:"comment"}));return e=w.getItem(f)||y,t.Features.touchEvents||this.addControl("commentButtonTooltip",new h({target:a.getContent(),position:"bottom",body:s,offset:{x:0,y:5}})),this.removeControl("answerSortDropDownMenu"),[{html:[this.options.enableLike?{html:[this.addControl("likeButton",new p({value:i.Like,icon:"thumbs-up",active:Boolean(o)})),{html:this.addChildView("nbEndorsementsNextGen",{Class:u.getViewClass("nbEndorsementsNextGen"),model:n}),tag:"span"}],class:"endorse"}:"",a,{html:this.getChildView("nbAnswersNextGen")||this.addChildView("nbAnswersNextGen",{Class:this.getOption("isCompactView")?u.getViewClass("NbAnswersViewNextGenForCompactView"):u.getViewClass("nbAnswersNextGen"),model:n}),tag:"span",class:"st-counter"},"iquestion"===n.getModelName()?{tag:"span",class:"answer-sort "+e,html:[{html:i.SortedbyVote,tag:"span",class:"answer-sort-text "+v},{html:i.SortedbyDate,tag:"span",class:"answer-sort-text "+y},{tag:"span",class:"fonticon fonticon-open-down answer-sort-dropdown"}]}:""],class:"comments"},this.options.enableShare?{html:this.addControl("shareButton",new p({value:i.Share,icon:"forward"})),class:"share"}:""]},changeSortingField:function(e){var t;w.setItem(f,e),(t=this.getElement(".answer-sort"))&&(e===y?t.removeClassName(v):e===v&&t.removeClassName(y),t.addClassName(e)),this.dispatchEvent("sortAnswersRequest",[e])}})}),define("DS/SwymUIComponents/script/feature/community/content/social-interactions/counter-view",["UWA/Core","DS/SwymUIComponents/script/feature/community/content/social-interactions/action-bar-view"],function(e,t){"use strict";return t.extend({name:"counter-view",_modelEventsForAutoRefresh:["onChange:nb_views"],domEvents:null,_createContent:function(){var e=this.model,t=parseInt(e.get("nb_views"),10);return{html:[{tag:"span",class:"fonticon fonticon-eye"},{html:t>0?t+"":"0",tag:"span",class:"counter"}],class:"views"}}})}),define("DS/SwymUIComponents/script/feature/community/media/video/model-interface/swym-interactive-media",["UWA/Core","DS/SwymUIComponents/script/feature/community/media/video/model-interface/interactive-media","DS/SwymUIComponents/script/utils/media-utils"],function(e,t,i){"use strict";function n(t){var i="",n=t.get("userFile");return e.is(t.get("media_file_ext"))?i=t.get("media_file_ext"):e.is(t.get("play"))?i=t.get("play").download_original_url.format:n&&n.fileName&&n.fileName.match(/.pdf$/i)&&(i="pdf"),i}return e.extend(e.extend({},t),{getMediaViewerModule:i.getMediaViewerModule,shouldAddPlayIconOverlay:function(e){var t=!1,i=e.get("media_type"),n=this.getFileExtension(e),o=e.isMediaAPlayableGIF();return(["video","3d_model","story","sketch","whiteboard","sound","drawing"].indexOf(i)>-1||"document"===i&&"pdf"!==n||o)&&(t=!0),t},getFileExtension:n,shouldAddDownloadIconOverlay:function(e){var t=!1,i=n(e);return"document"===e.get("media_type")&&"pdf"!==i&&(t=!0),t},modelFetchNeeded:function(e){return!e.has("media_type")&&"read"!==e.lastCalledService&&!1!==e.get("user_access")}})}),define("DS/SwymUIComponents/script/feature/community/media/video/model-interface/factory",["DS/SwymUIComponents/script/feature/community/media/video/model-interface/drive-interactive-media","DS/SwymUIComponents/script/feature/community/media/video/model-interface/swym-interactive-media"],function(e,t){"use strict";return{getInterfaceModule:function(i){return i.isDriveFile&&i.isDriveFile()?e:t}}}),define("DS/SwymUIComponents/script/feature/core/tenant/view/tenant-media-processes-view",["i18n!DS/SwymUIComponents/assets/nls/feature/core/tenant/view/tenant-media-processes-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/report-abuse/view/report-new-abuse-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/community/content/view/media-thumbnail-view","DS/SwymUICore/script/utils/date","UWA/Element","DS/SwymUIComponents/script/utils/media-utils","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUIComponents/script/feature/core/modal/super-modal"],function(e,t,i,n,o,s,a,r,l,c,d){"use strict";var m=c.getInstance();return i.extend({_modelEventsForAutoRefresh:["onChange"],domEvents:{"click a.link-restart":"_onRestartMediaProcessingButtonClick","click a.link-dl-log":"_onDlLogClick","click a.link-dl-orig":"_onDlOrigClick","click .media-process-thumbnail-container":"_onContentLinkClick"},_onRestartMediaProcessingButtonClick:function(){var e=this;this.model.reprocess({onComplete:function(){var t=e.getChildView("mediaThumbnail");t&&t.refresh()}})},_onDlLogClick:function(){window.open([l.getBaseUrl(),"/api/media/get3dsalogzip/id_media/",this.model.get("mid")].join(""))},_onDlOrigClick:function(){window.open([l.getBaseUrl(),"/api/media/streammedia/id/",this.model.get("mid"),"/type/original/output/download/admin/true/"].join(""))},_displayConfirmationModal:function(e,i){if(this._confirmModal||(this._confirmModal=new d({closable:!1,renderTo:this._widget.body})),!e)throw new Error("Current user instance is expected");this._confirmModal.confirm(t.Youdont,t.Confirm,function(t){!0===t&&e.setAccess({onComplete:function(){e.set("tenant_su","1"),r.goToUrl(i)}})})},_updateContentInfo:function(){var e,t=this.model;return this._lastSubjectUri=t.get("subjectUri"),e=(e=t.get("subject6wuri",{escapeHTML:!1})).replace(/&#47;/g,"/"),this._contentInfo=m.extractContextInfoFromRoute(e),this._contentInfo.communityId||(this._contentInfo.communityId=t.get("community_id")),this._contentInfo},_onContentLinkClick:function(e){var t,i=this,n=this.model,o={mid:n.get("mid")};this._updateContentInfo(),t=m.computeRoute(this._contentInfo),require(["DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/lib/model/generic/swym-model"],function(n,s){n.getInstanceFetched(function(n){"1"!==n.get("tenant_su")&&(e.stopPropagation(),e.preventDefault(),require([s.getModuleNameFromModelName("media"),"DS/SwymUICore/script/feature/community/community/model/community-model"],function(e,s){i.isDestroyed()||new e(o,{autoPopulate:!0,onPopulate:function(e){i.isDestroyed()||(e&&e.get("_acl")&&!0===e.get("_acl").update.access&&!0===e.get("_acl").delete.access?r.goToUrl(t):i._displayConfirmationModal(n,t))},onFailure:function(){i._displayConfirmationModal(n,t)}})}))})})},_createContent:function(){var t,i=this.model,r=l.getClientInformation();if(i){switch(i.get("status")){case a.MEDIA_PROCESSING_STATUS.OK:t=e.processed;break;case a.MEDIA_PROCESSING_STATUS.KO:t=e.error;break;case a.MEDIA_PROCESSING_STATUS.NOT_PROCESSED:t=e.nonprocessed;break;case a.MEDIA_PROCESSING_STATUS.READY:t=e.readytoprocess;break;default:t=i.get("status")}return[{tag:"td",html:i.get("mid")+""},{tag:"td",html:o.simpleDate(i.get("crdate"))},{tag:"td",html:i.get("media_type")},{tag:"td",html:{styles:{width:"70px",cursor:"pointer"},class:"media-process-thumbnail-container","data-content-id":i.get("mid"),"data-content-type":"media","data-community-id":i.get("community").mid,"data-edition-mode":"0"===i.get("published"),html:this.addChildView("mediaThumbnail",{Class:n,model:i,imageReloadOptions:{isAdmin:!0}})}},{tag:"td",html:i.get("title")},{tag:"td",html:i.get("created_by")||i.get("author->nickname")},{tag:"td",html:t},{tag:"td",html:new s("a",{html:e.Restartprocessing,class:"link-restart"})},r.isIos?"":{tag:"td",html:i.get("status")!==a.MEDIA_PROCESSING_STATUS.KO&&i.get("status")!==a.MEDIA_PROCESSING_STATUS.OK||!0!==i.get("conversionLogged")?"":new s("a",{html:e.Downloadprocessinglogs,class:"link-dl-log"})},{tag:"td",html:new s("a",{html:e.Downloadoriginalmedia,class:"link-dl-orig"})}]}}})}),define("DS/SwymUIComponents/script/feature/core/tenant/view/tenant-media-processes-collection-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/tenant/view/tenant-media-processes-collection-view","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUICore/script/feature/community/media/collection/media-collection","DS/SwymUIComponents/script/feature/core/tenant/view/tenant-media-processes-view","DS/SwymUICore/script/utils/utils"],function(e,t,i,n,o,s){"use strict";return i.extend({_collectionClass:n,_collectionEvents:{onRequest:"mask",onSync:"unmask",onError:"unmask"},modelViewClass:o,attributes:{tag:"table",class:"table-container"},bodyAttributes:{tag:"tbody"},modelViewsCfg:{attributes:{tag:"tr"}},imageReloadOptions:{isAdmin:!0},_createContent:function(){var e=s.getClientInformation().isIos?"":"<th></th>";return[{tag:"thead",html:"<th>"+t.ID+"</th><th>"+t.Date+"</th><th>"+t.Type+"</th><th>"+t.Preview+"</th><th>"+t.Title+"</th><th>"+t.Owner+"</th><th>"+t.Status+"</th>"+e+"<th></th><th></th>"},this._parent.apply(this,arguments)]}})}),define("DS/SwymUIComponents/script/utils/w3dxcomponents-utils",["UWA/Core","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/sprite/sprite","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/utils/date","DS/SwymUIComponents/script/utils/scrollview-utils","DS/UIKIT/Mask","DS/WebappsUtils/WebappsUtils"],function(e,t,i,n,o,s,a,r,l){"use strict";return{checkOptions:function(t){if(!t)throw new Error("Missing arguments");if(!t.widget)throw new Error("Please provide a widget instance");if(!t.skeleton)throw new Error("Please provide a skeleton instance");return e.extend({},t)},getComponentSpritesReloadFn:function(){return t.getDelayedSyncTask(function(){var e;!0!==this.isDestroyed&&(e={el:this.container,nonReloadedImagesOnly:!0},this._tempModelWithLogoChanged&&(e.modifiedId=this._tempModelWithLogoChanged,this._tempModelWithLogoChanged=void 0))},100)},getEmptyViewDefaultOptions:function(){return null},getComponentListeners:function(){return null},_maskViewWhenFirstPageIsRequested:function(e){this.collection===e&&this.container&&this.collection&&1===this.collection.getCurrentPage()&&r.mask(this.container)},_unmaskView:function(e){this.collection===e&&this.container&&r.unmask(this.container)},getViewListeners:function(e){var t=e,i=this.reloadSprites,n=this;return{onRender:function(){if(t.view!==this){t.view=this;var e=this.collection;e&&this.listenTo(e,{onRequest:n._maskViewWhenFirstPageIsRequested,onSync:n._unmaskView,onError:n._unmaskView})}i.call(this,t)},onPullToRefresh:a.onPullToRefresh,onInfiniteScroll:a.onInfiniteScroll}},reloadSprites:function(e){var t=e.view;"function"==typeof e.reloadCmpSprites&&t&&!0!==t.isDestroyed&&e.reloadCmpSprites.call(t)},getItemViewOptions:function(e){var t=e,i=this.reloadSprites;return{mapping:this._itemViewMapping(e),templateHelpers:{imgAttrs:this._imgAttrsForItemView},events:{onRender:function(){i.call(this,t)}}}},_imgAttrsForItemView:function(){var e,t,o,s,a,r,l=this.model;if(l instanceof n){switch(o=l.getModelName()){case"media":e=l.get("mid"),a=!1,r=l.get("update")||l.get("publish_date");break;case"community":e=l.get("mid"),a=!0,r=l.get("settings_update")||l.get("update");break;default:(e=l.get("thumbnail->mid"))?(a=!1,r=(t=l.getAssociated("thumbnail")).get("update")||t.get("publish_date")||l.get("update")||l.get("publish_date")):(a=!0,e=l.get("community->mid"),r=(s=l.getAssociated("community")).get("settings_update")||s.get("update")||l.get("update")||l.get("publish_date"))}var c={id:e,communityLogo:a,imageUpdateTime:r,imageFingerprint:l.get("preview_fingerprint"),cls:"dsi-communities-home-list-picture",modelId:l.get("mid"),modelName:o,size:"m",imageKind:"thumb"};return this.options.as_admin&&(c.as_admin=this.options.as_admin),i.getMediaThumbnailAttributes(c)}},_itemViewMappingForEndorseCount:"nb_endorse",_itemViewMappingForCommentCount:function(){var e=0,t=this.model;return t instanceof n&&(e="iquestion"===t.getModelName()?t.get("nb_answers"):t.get("nb_comments")),e},_itemViewMappingForIcon:function(){var e="";return this.model instanceof n&&(e=t.getContentIconUrl(this.model)),e},_itemViewMappingForFontIcon:function(){var e="",i=this.model;return i instanceof n&&(e="media"===i.getModelName()?t.getMediaIconName(i):t.getIconFromModel(i)),e},_itemViewMapping:function(e){var t=e&&!0===e.fontIcon?this._itemViewMappingForFontIcon:this._itemViewMappingForIcon;return{title:this._itemViewMappingForTitle,image:this._itemViewMappingForImage,content:this._itemViewMappingForContent,subtitle:this._itemViewMappingForSubtitle,ownerName:this._itemViewMappingForOwnerName,endorseCount:this._itemViewMappingForEndorseCount,commentCount:this._itemViewMappingForCommentCount,icon:t}},_itemViewMappingForTitle:function(){return this.model.get("title")||""},_itemViewMappingForContent:function(){var e="",t=this.model;return t instanceof n&&(e="community"===t.getModelName()?t.get("description"):t.get("summary")),e},_itemViewMappingForSubtitle:function(){var e,t="",i=this.model;return i instanceof n&&("community"===i.getModelName()?t=s.prettyDate(i.get("content_update")):(t=i.get("community->title"),e=s.prettyDate(i.getPublishingDate()),t?t+=" - "+e:t=e)),t},_itemViewMappingForOwnerName:function(){var e="",t=this.model;return t instanceof n&&(e="community"===t.getModelName()?t.get("owner->nickname"):t.get("author->nickname")),e},_itemViewMappingForImage:function(){var e=this.model;return o.constructThumbnailUrl(e.getModelName&&e.getModelName(),e.get("mid"),"m_thumb",e.get("preview_fingerprint"))},getFacetViewPanelIndex:function(e){var t=null,i=e.facetView;return e.skeleton.displayedNodes?e.skeleton.displayedNodes.detect(function(e,n){var o;if(e.activeNode&&(o=e.activeNode.activeFacet)&&(o.views.main===i||o.views.small===i))return t=n,!0}):e.skeleton.currentRouteSteps.detect(function(i,n){var o,s,a;if(i.get("isPanelRendered")&&(s=(a=(o=i.get("panelNode"))?o.get("activeNode"):null)?a.get("activeFacet"):null)&&s.view===e.facetView)return t=n,!0}),t}}}),define("DS/SwymUIComponents/script/utils/contentset-options-utils",["UWA/Core","UWA/Array","DS/W3DXComponents/Collections/ActionsCollection","DS/W3DXComponents/Views/Item/ActionsInlineView","DS/SwymUIComponents/script/utils/w3dxcomponents-utils","i18n!DS/SwymUIComponents/assets/nls/utils/utils","DS/W3DXComponents/ContentSet","DS/W3DXComponents/Views/EmptyView","DS/W3DXComponents/Views/Layout/ListView"],function(e,t,i,n,o,s,a,r,l){"use strict";return e.merge({getViewList:function(i){var n,o=[],s=a.prototype.defaultOptions.contents.views,r=t.isArray(i.contentSetViewsId)?i.contentSetViewsId:["list"],l=e.is(i.defaultViewId,"string")?i.defaultViewId:i.facetViewMode?i.facetViewMode:r[0];return r.forEach(function(t,i){var a={view:null,fontIcon:!0,reloadCmpSprites:this.getComponentSpritesReloadFn()};switch(n={id:t,default:l===t,selectionMode:window.ds&&"3DSwym"===ds.env?"":"oneToOne",className:"hidden-empty-view",events:this.getViewListeners(a)},t){case"tile":case"thumbnail":case"list":case"table":a.fontIcon=!1,e.merge(n,s.detect(function(e){return e.id===t}))}e.extend(n,{itemViewOptions:this.getItemViewOptions(a)}),o.push(n)},this),o},getContentSetOptions:function(e){var t=this.checkOptions(e),i=!1===t.isActions?{}:this.getNewActionsViewConfig(t.hideRssIcon),n=this.getEmptyViewDefaultOptions();return t.skeletonOptionsInstance=this,t.switchEvent=!0,{actions:i,contents:{emptyView:n?r.extend({defaultOptions:n}):r,views:this.getViewList(t)},events:this.getComponentListeners(t)}},getNewActionsViewConfig:function(e){var t=[];return t.push({id:"add-content",title:s.AddContent,icon:"plus",context:!0,overflow:!1}),!0!==e&&t.push({id:"rss-feed",icon:"rss",context:!0,overflow:!1}),{view:n,collection:new i(t)}}},o)}),define("DS/SwymUIComponents/script/feature/community/media/view/media-home-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/community/content/view/media-thumbnail-view","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/utils/date","DS/SwymUICore/script/utils/navigation"],function(e,t,i,n,o,s,a){"use strict";return t.extend({_modelClass:n,_modelEventsForAutoRefresh:["onChange"],name:"media-home-view",domEvents:{click:function(e){this.clickHandler?this.clickHandler(this.model):a.goToContent(this.model.get("mid"),"media",this.model.get("community->mid"))}},_createContent:function(){var e=this.dimensions,t=this.model;if(t)return{class:"thumb-wrap",html:[{class:"date-detail",html:{tag:"span",html:s.prettyDate(t.get("update"))}},this.addChildView("mediaThumbnail",{Class:i,model:t,imageRenderingOptions:{width:e.width,height:e.height}}),{class:"details",styles:{padding:"5px 8px 0 5px"},html:[{class:"thumb-origin-picto"},{class:"timeAndViews",html:t.get("author->nickname")},{tag:"p",class:"timeAndViews",html:[{tag:"span",html:[{class:"bulleimg",styles:{margin:"0 3px 0 0",border:"0"}},String(t.get("nb_comments"))]},{tag:"span",html:[{class:"endorseimg",styles:{margin:"0 3px 0 10px",border:"0"}},String(t.get("nb_endorse"))]}]}]},{class:"detail-hidden titleicon",html:{title:t.get("title"),html:[{tag:"span",class:"fonticon fonticon-"+o.getMediaIconName(t)},{tag:"span",styles:{"line-height":"25px","word-break":"normal","overflow-wrap":"break-word","word-wrap":"break-word"},html:t.get("title")}]}}]}},setup:function(t){return e.is(t,"object")&&(this.setCurrentViewMode(t.currentViewMode),this.setDimensions(t.dimensions),t.clickHandler&&(this.clickHandler=t.clickHandler)),this._parent(t)},setCurrentViewMode:function(e){return this.currentViewMode=e,this.currentViewMode},setDimensions:function(e){return this.dimensions=e,this.dimensions},getCssClassMediaType:function(e,t){if("string"==typeof e){var i=new RegExp("(_)","g"),n=["i_",e.replace(i,"")].join("");return 1===t&&(n="i_smart_object"),n}return""}})}),define("DS/SwymUIComponents/script/feature/community/community/view/community-card-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/core/context/context-model","i18n!DS/SwymUICore/assets/nls/feature/community/community/model/community-model","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-detailed-view","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUIComponents/script/feature/community/community/view/community-signup-request-launcher","DS/SwymUIComponents/script/feature/community/content/view/media-thumbnail-view","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/utils","DS/SwymUIComponents/script/feature/community/community/view/community-request-become-author-modal-view","DS/UIKIT/DropdownMenu","DS/SwymUIComponents/script/feature/core/modal/super-modal","DS/UIKIT/Input/Button","DS/UIKIT/Spinner","DS/SwymUICore/script/lib/event-manager","DS/UIKIT/Tooltip","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-card-view"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w,C,f,y){"use strict";var v={};return v[s.Public]="fonticon fonticon-globe",v[s.Private]="fonticon fonticon-lock-open",v[s.Secret]="fonticon fonticon-lock",t.extend({_modelClass:i,_modelEvents:{"onSync:setlogo":"refresh","onChange:title":"refresh","onChange:description":"refresh","onChange:owner":"refresh","onChange:access":"refresh","onChange:is_favorite":"refresh","onChange:isBlacklisted":"refresh"},domEvents:{'click *[data-content-type="person"][data-hash-key]':"_onUserClick","click .card-thumbnail-title-bar .fonticon-down-open":"_onToolbarClick","click .community-action-toolbar.discover-communities":"_stopPropagate","click .title .fonticon.fonticon-down-open":"_onOpenIconClick"},name:"community-card-view",className:"swym-tile col-extralg-2 col-lg-3 col-md-4 col-sm-6 col-xs-12",isListUsage:!1,showActionToolbar:!1,_requestToBecomeAuthor:function(){var e=this.addControl("requestBecomeAuthorModal",new u({model:this.model}));e.render(document.body),e.show()},_onUserClick:function(e){e.stopPropagation(),e.preventDefault(),require(["DS/SwymUICore/script/utils/link-builder-utils"],function(t){t.displayProfile(e)})},_onToolbarClick:function(e){e.stopPropagation();var t=this.getControl("dropdownMenu");t&&t.show()},_stopPropagate:function(e){e.stopPropagation()},_onOpenIconClick:function(e){e.stopPropagation()},_favorite:function(){this.model.updateFavorite(!0)},_unfavorite:function(){this.model.updateFavorite(!1)},_follow:function(){this.model.set("isBlacklisted",!1),this.model.follow({onComplete:function(){this.alert("success",a.nowfollowing),C.dispatchEvent("requestContentListUpdate",{contextPath:"home"})}.bind(this),onFailure:function(){this.alert("error",a.NowFollowingErrorMsg),this.model.set("isBlacklisted",!0)}})},_unfollow:function(){this.model.set("isBlacklisted",!0),this.model.unfollow({onComplete:function(){this.alert("success",a.nownotfollowing),C.dispatchEvent("requestContentListUpdate",{contextPath:"home"})}.bind(this),onFailure:function(){this.alert("error",a.NowNotFollowingErrorMsg),this.model.set("isBlacklisted",!1)}})},_onLeaveCommunityClicked:function(){this.addControl("removeConfirmationModal",new p({closable:!0,renderTo:this._widget.body})).confirm({title:a.deletequestion,message:a.removeMyAccessToThisCommunity,callback:function(e){!0===e&&this.model.deletecurrentuserfromcommunity({onComplete:function(){this.alert("success",a.Youhavebeendeletedfromthiscommunity),this.model&&this.model.collection&&this.model.collection.remove(this.model)}.bind(this),onFailure:function(e,t){"ERROR_TRY_TO_LEAVE_COMMUNITY_WITH_IMPLICIT_ROLE"===t.errorcode&&this.alert("error",y.ErrorTryToLeaveCommunity)}.bind(this)})}.bind(this)})},setup:function(e){this._parent(e);var t=o.getInstance();e&&(void 0!==e.isListUsage&&(this.isListUsage=e.isListUsage),void 0!==e.showActionToolbar&&(this.showActionToolbar=e.showActionToolbar),this._displayAccessors=void 0!==e.displayAccessors&&e.displayAccessors,this._responsive=!(void 0===e.responsive||!e.responsive)&&e.responsive,this.isListUsage||this.container.addClassName("community-idcard")),this._context=t,this.onCommunityChange=this.onCommunityChange.bind(this),!1===this.isListUsage&&t.addListener("onCommunityChange",this.onCommunityChange,this,!0)},onCommunityChange:function(e){e&&e.communityId&&this.setModel(new i({id:e.communityId}))},_displaySprite:function(){var e=!1===this.isListUsage?{size:"l"}:{},t=this.getChildView("communityLogo");return t&&t.getInitialModel().equals(this.model)?t:this.addChildView("communityLogo",new c({model:this.model,imageRenderingOptions:e}))},_getLogoURL:function(){return n.constructThumbnailUrl("community",this.model.get("mid"),"l_thumb",this.model.get("preview_fingerprint"))},_addBadge:function(t,i,n){return e.createElement("span",{class:"badge badge-corporate "+n,html:t?{tag:"span",class:t}:i||""})},_createJoinCommunityButton:function(){var t=this.model;return!("0"!==t.get("user_access"))&&e.createElement("div",{class:"community-action-toolbar discover-communities",html:this.addControl("join-button",new g({value:a.Join,className:"small primary",icon:"login",events:{onClick:function(){l.show(t)}}}))})},_createFollowBadge:function(){var e=this.model;return"0"!==e.get("user_access")&&this._addBadge("fonticon fonticon-"+(e.get("isBlacklisted")?"eye-off":"eye"),null,"blacklist")},_createContent:function(){var t,i=this.model,n=[],o=e.createElement("span",{class:"fonticon fonticon-2x fonticon-down-open"});return i&&i.get("owner")?(t="0"!==i.get("user_access"),this.roleBadge=t&&this._addBadge(!1,i.getTranslatedRole(),"role"),this.followBadge=this._createFollowBadge(),this.favoriteBadge=i.get("is_favorite")&&this._addBadge("fonticon fonticon-favorite-on",null,"favorite"),this.visibilityBadge=this._addBadge(v[i.getVisibility()],null,"visibility"),this.joinCommunityButton=this._createJoinCommunityButton(),n=e.createElement("div",{class:"card card-thumbnail"+(t?" draggable-community":""),"data-is-link":!1,"data-content-id":i.get("mid"),html:[{tag:"img",class:"card-img logo","data-content-type":"community","data-content-id":i.get("mid"),src:this._getLogoURL()},{tag:"div",class:"card-block card-thumbnail-title-bar",html:[{tag:"a",class:"card-title","data-content-type":"community","data-content-id":i.get("mid"),html:[{tag:"li",class:"fonticon fonticon-users-alt"},i.get("title")]},{tag:"h5",class:"card-subtitle",html:[{tag:"span",class:"owner-subtitle","data-content-type":"person","data-hash-key":i.get("owner").hash_key,"data-login":i.get("owner").login,html:i.getMainOwner()?i.getMainOwner().getNickname():""},t?o:""]}]},{tag:"div",class:"card-footer",html:[this.roleBadge,this.visibilityBadge,this.followBadge,this.favoriteBadge,this.joinCommunityButton]}]}),this.roleBadge&&this.addControl("RoleTooltip",new f({target:this.roleBadge,body:y.Role+" : "+i.getTranslatedRole()})),this.followBadge&&this.addControl("FollowTooltip",new f({target:this.followBadge,body:i.get("isBlacklisted")?y.UnfollowedCommunity:y.FollowedCommunity})),this.favoriteBadge&&this.addControl("FavoriteTooltip",new f({target:this.favoriteBadge,body:y.FavoriteCommunity})),this.visibilityBadge&&this.addControl("VisibilityTooltip",new f({target:this.visibilityBadge,body:i.getVisibility()})),this.addControl("MenuTooltip",new f({target:o,body:y.Menu})),r.getInstanceFetched(this._buildDropDownMenu(o))):n=e.createElement("div",{styles:{margin:"auto","text-align":"center",height:"40px"},html:new w({className:"msg-animation",visible:!0,animate:!0,spin:!0})}),n},getBecomeAuthorView:function(){var e=this.getChildView("becomeAuthorView");return e||(e=this.addChildView("becomeAuthorView",{Class:"DS/SwymUIComponents/script/feature/community/community/view/request-become-author-view"})),e},destroy:function(){return o.getInstance().removeListener("onCommunityChange",this.onCommunityChange),this._parent.apply(this,arguments)},_buildDropDownMenu:function(e){var t=this.model.get("isBlacklisted"),i=[];d.getInstance().isFeatureActivated("active_community_blacklist")&&i.push({name:t?"follow":"unfollow",text:t?a.Follow:a.Unfollow,fonticon:t?"eye":"eye-off"}),i.push({name:this.model.get("is_favorite")?"unfavorite":"favorite",text:this.model.get("is_favorite")?a.RemoveFromFavorites:a.AddAsFavorite,fonticon:this.model.get("is_favorite")?"favorite-delete":"favorite-add"}),"Contributor"===this.model.get("role")&&d.getInstance().isFeatureActivated("activate_community_change_role_request")&&i.push({name:"becomeAuthor",text:a.BecomeAuthor,fonticon:"user"}),!0===this.model.getDeleteRight()&&i.push({name:"leave",text:a.LeaveCommunity,fonticon:"logout"}),i.length>0?this.addControl("dropdownMenu",new h({target:e,renderTo:window.document.body.getElement(".scroll-content"),position:"bottom right",offset:{x:17,y:8},items:i,events:{onClick:function(e,t){switch(t.name){case"leave":this._onLeaveCommunityClicked();break;case"follow":this._follow();break;case"unfollow":this._unfollow();break;case"favorite":this._favorite();break;case"unfavorite":this._unfavorite();break;case"becomeAuthor":this._requestToBecomeAuthor()}}.bind(this)}})):e.hide()}})}),define("DS/SwymUIComponents/script/feature/community/community/view/community-list-view",["UWA/Core","DS/SwymUIComponents/script/feature/core/ui-components/list/item-list","DS/SwymUIComponents/script/feature/community/community/view/community-card-view"],function(e,t,i){"use strict";return t.extend({name:"community-list",modelViewClass:{community:i},modelViewsCfg:function(){var t=this._parent.apply(this,arguments);return e.merge({isListUsage:!0,showActionToolbar:!0},t)},setup:function(e){e.useDynamicGrid=!1,this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/media/edit/thumbnail/upload-progress-media-thumbnail-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/utils/media-utils","DS/SwymUICore/script/utils/utils","DS/WebappsUtils/WebappsUtils","DS/UIKIT/Tooltip","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/edit/thumbnail/upload-progress-media-thumbnail-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/edit/thumbnail/content-edition-media-thumbnail-view"],function(e,t,i,n,o,s,a,r){"use strict";var l=function(e,t){var i=null;return e&&t&&((i=e._changes[t])||(i=e.get(t))),i},c=function(e,t,i){e&&e.set("width",t)&&e.set("height",i)},d=function(e){return{border:"1px solid #e2e4e3","border-radius":"5px","background-image":"url("+e+")","background-size":"cover","background-position":"center center",display:"block"}},m=function(t,s){var a,r,m,u,h,p,g,w=l(t,"userFile");if(l(t,"media_type")!==i.MEDIA_TYPE.PICTURE||w&&w.type&&"image/tiff"===w.type)if(l(t,"objectId")){var C=t.get("displayPreview",{escapeHTML:!1});(u=e.createElement("img")).setAttribute("src",o.getWebappsBaseUrl()+"SwymUIComponents/assets/s.gif"),u.setStyles(d(C)),s.call(this,u,C)}else(h=e.createElement("span")).className="uploading-img default-img fonticon-3x fonticon-"+n.getMediaIconName(t),s.call(this,h,null);else if((u=e.createElement("img",{"data-media-type":t.get("media_type")||""})).className="uploading-img",e.is(w,"string")&&(m=e.createElement("div").setHTML(w).getText())&&(r=m.split(","))&&"data:image/png;base64"===r[0]){var f=new Image;f.onload=function(){c(t,f.width,f.height)}.bind(this),f.src=m,u.setAttribute("src",o.getWebappsBaseUrl()+"SwymUIComponents/assets/s.gif"),u.setStyles(d(m)),s.call(this,u,m)}else u.file=w,(a=new FileReader).onload=(p=u,g=t,function(e){var t=e.target.result,i=new Image;i.onload=function(){c(g,i.width,i.height)}.bind(this),i.src=t,p.setAttribute("src",o.getWebappsBaseUrl()+"SwymUIComponents/assets/s.gif"),p.setStyles(d(t)),s.call(this,p,t)}),a.readAsDataURL(w)},u=t.extend({name:"upload-progress-media-thumbnail-view",_modelEvents:{onUploadProgress:"onProgressUpdate","onRequest:create":"onStartUpload","onRequest:update":"onStartUpload","onRequest:patch":"onStartUpload","onError:create":"refresh","onError:update":"refresh","onError:patch":"refresh"},_modelEventsForAutoRefresh:[],_objectURL:null,domEvents:{"click .fonticon-close":"removeThumbnail"},setup:function(){this._parent.apply(this,arguments)},_createContent:function(){var e=this.model;return[{class:"uploading-thumbnail"},e.isUploading()?this.createProgressMarkup():[{tag:"span",class:"fonticon fonticon-2x fonticon-close top-right"},{tag:"span",class:"fonticon bottom-right dot "+(e.getCustomProperty("uploadRequest")&&3===e.getCustomProperty("uploadRequest").status?"warning fonticon-attention":"pending fonticon-refresh"),title:e.getCustomProperty("uploadRequest")&&3===e.getCustomProperty("uploadRequest").status?a.Mediauploadfailed:a.Mediauploadpending}]]},onRender:function(){var e,t,i;(e=this.getElement(".fonticon-attention"))&&this.addControl("mediauploadfailedTooltip",new s({target:e,body:a.Mediauploadfailed})),(i=this.getElement(".fonticon-refresh"))&&this.addControl("mediauploadpendingTooltip",new s({target:i,body:a.Mediauploadpending})),(t=this.getElement(".fonticon-close"))&&this.addControl("removeMediaTooltip",new s({target:t,body:r.RemoveMedia}))},createProgressMarkup:function(){return{class:"progress-wrap",html:[{class:"progress-bar",styles:{width:"5%"}}]}},onStartUpload:function(){var t=this.container?this.container.getElement(".uploading-thumbnail"):null,i=this.container?this.container.getElement(".fonticon-trash"):null,n=this.container?this.container.getElement(".fonticon.dot"):null;t&&e.createElement("div",this.createProgressMarkup()).inject(t,"after"),n&&n.remove(),i&&i.remove()},removeThumbnail:function(){this.dispatchEvent("onRemoveRequest",[this.model])},onUploadComplete:function(){this.setProgressStatus("100%")},onProgressUpdate:function(e){var t=Math.round(100*e.loaded*"0.9"/e.total)+"%";this.setProgressStatus(t)},setProgressStatus:function(e){var t;(t=this.getElement(".progress-bar"))&&t.setStyle("width",e)},renderUploadingMedia:m,onRedraw:function(){var e=this;this.renderUploadingMedia(this.model,function(t){!e.isDestroyed()&&e.container.getElement(".uploading-thumbnail").appendChild(t)})},onDestroy:function(){this._objectURL&&window.URL.revokeObjectURL(this._objectURL),this.stopListening(this.model,"onSync:create",this.onUploadComplete)}});return u.renderUploadingMedia=m,u}),define("DS/SwymUIComponents/script/feature/core/search/view/user-and-users-group-search-factory",["UWA/Core","DS/SwymUIComponents/script/feature/core/search/view/user-search-factory","DS/SwymUICore/script/feature/core/user/collection/user-and-users-group-collection","DS/WebappsUtils/WebappsUtils","DS/SwymUICore/script/feature/core/user/model/user-model","DS/UWPClientCode/I18n"],function(e,t,i,n,o,s){"use strict";var a=t.Factory.extend({_getConfiguration:function(){var t=this,a=this._parent.apply(this,arguments);return e.merge({templateEngine:function(e,t,i){e.addClassName("default-template people-search-template with-sub-label"),e.setHTML('<img class="'+("users_group"===i.type?"users-group-default-picture":"people-search-img")+'" src="'+("users_group"===i.type?n.getWebappsBaseUrl()+"SwymUIComponents/assets/s.gif":i.preview_url)+'"/> <div class="item-label">'+i.label+'</div> <div class="sub-label">'+(i.subLabel?i.subLabel:"")+"</div>")},remoteSearchEngine:function(e,n,o){var a=this;if(""!==n.trim())return this._userAndUsersGroupCollection||(this._userAndUsersGroupCollection=new i([],{limit:5,mode:"searchbyname"})),new Promise(function(i,r){a._userAndUsersGroupCollection.fetchPage(1,{data:{disableUserGroup:t._disableUserGroup,query:n,locale:s.getCurrentLanguage()},onComplete:function(){var t=a._userAndUsersGroupCollection.toJSON(),s={dataset:e,matchingItems:t&&e.configuration.dataParser&&e.configuration.dataParser.call(this,e,t,n)};i(s),o&&o(s.matchingItems)},onFailure:function(){r({})}})})},dataParser:function(e,i,n){var s,a=[],r=t;return i.forEach(function(e){s={resourceUid:e["ds6w:resourceUid"],uri:e.subject6wuri,label:e["ds6w:label"],nickname:e["ds6w:label"],value:e["ds6w:label"],preview_url:e.preview_url},a.push(s)}),r._mailAllowed&&0===a.length&&r._isAMail(n)&&a.push({uri:n,label:n,value:n,preview_url:o.constructUserPictureUrl(n,"")}),a}},a)}});return e.merge({Factory:a},t)}),define("DS/SwymUIComponents/script/feature/community/media/edit/thumbnail/smart-media-edition-thumbnail-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUIComponents/script/feature/community/media/edit/thumbnail/upload-progress-media-thumbnail-view","DS/SwymUIComponents/script/feature/community/media/edit/thumbnail/content-edition-media-thumbnail-view"],function(e,t,i,n,o,s){"use strict";return t.extend({_modelClass:i,name:"smart-media-edition-thumbnail-view",_modelEventsForAutoRefresh:["onRequest:create","onRequest:update","onRequest:patch","onSync:create","onSync:update","onSync:patch"],_uploadStatus:null,defaultOptions:{uploadViewClass:o,displayViewClass:s},_getUploadView:function(){var e=this.getChildView("upload");return e||(e=this.addChildView("upload",{model:this.model,Class:this.getOption("uploadViewClass"),modelName:this.model.getModelName(),events:{onRemoveRequest:function(){this.dispatchEvent("onRemoveRequest",arguments)}.bind(this)}})),e},_getDisplayView:function(){var e=this.getChildView("display");return e||(e=this.addChildView("display",{model:this.model,Class:this.getOption("displayViewClass"),modelName:this.model.getModelName(),uploadStatus:this._uploadStatus,events:{onRemoveRequest:function(){this.dispatchEvent("onRemoveRequest",arguments)}.bind(this)}})),e},_createContent:function(){var e,t=this.model;return t.isUploading()||t.isNew()?(e=this._getUploadView(),t.isUploading()?this._uploadStatus="uploading":t.isNew()&&(this._uploadStatus="toBeUploaded")):("uploading"===this._uploadStatus&&(this._uploadStatus="justUploaded"),e=this._getDisplayView()),e}})}),define("DS/SwymUIComponents/script/feature/core/user/view/users-group-tile-view",["i18n!DS/SwymUICore/assets/nls/feature/core/user/collection/member-collection","DS/SwymUIComponents/script/feature/core/user/view/user-group/user-group-nbmembers-view","DS/SwymUIComponents/script/feature/community/members/view/member-tile-view","DS/SwymUIComponents/script/feature/core/user/mixin/view-with-users-group-link"],function(e,t,i,n){"use strict";return i.extend(n,{name:"users-group-tile-view",defaultOptions:{displayBadges:!1},domEvents:{"click .member-tile":"_onUsersGroupClick"},_createPictureView:function(){return{class:"member-picture",html:{tag:"span",class:"fonticon fonticon-users-group fonticon-5x"}}},_displayBasicInfo:function(){var e=t.getUserGroupMembersText(this.model);return{styles:{"text-align":"center"},html:{class:"member-name",html:this.model.get("name")+" ("+e+")"}}},_getInlineActionsUpdate:function(){var t=this._parent.apply(this,arguments);return t.push({name:"viewUserGrpMembers",text:e.ViewMembers,fonticon:"eye"}),t},_onDropdownmenuItemClick:function(e,t){return"viewUserGrpMembers"===t.name?this._showUsersGroup(this.model.get("subject6wuri",{escapeHTML:!1})):this._parent.apply(this,arguments)},_onUsersGroupClick:function(){return this._showUsersGroup(this.model.get("subject6wuri",{escapeHTML:!1}))}})}),define("DS/SwymUIComponents/script/feature/community/wedo/view/wedo-more-details-view",["DS/SwymUICore/script/feature/community/wedo/model/wedo-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/core/user/view/assignee-view","DS/SwymUICore/script/lib/view/generic/swym-collection-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/wedo/view/wedo-detailed-view","DS/SwymUIComponents/script/feature/core/search/view/user-search-factory","DS/SwymUIComponents/script/feature/core/search/view/user-and-users-group-search-factory","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/SwymUICore/script/feature/core/user/collection/assignee-collection","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/core/user/model/assignee-model","UWA/Core"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h){"use strict";return t.extend({_modelClass:e,name:"wedo-more-details-view",domEvents:{"click .fonticon-user-add":"_onAddAssignee"},_modelEventsForAutoRefresh:["onChange:_acl"],defaultOptions:{assigneeCollection:null,mode:"read"},setAssigneeCollection:function(e){this._assignees=e||new d([],{mode:null,limit:10}),this._initialAssigneeCollection=this.model?new d(this._assignees.toJSON(),{mode:null,limit:10}):new d([],{mode:null,limit:10}),this.reactTo(this._assignees,{onAdd:this._checkIfMaxWarningMustBeDisplayed,onRemove:this._checkIfMaxWarningMustBeDisplayed,onReset:this.refresh})},getAssigneeCollection:function(){return this._assignees},resetContent:function(){this.model?this._assignees.reset(this.model.get("assignees")):this._assignees.reset([])},setup:function(){this._parent.apply(this,arguments),this._context=r.getInstance(),this.setAssigneeCollection(this.getOption("assigneeCollection")),this.getControl("assignees-search-control")||this._addAssigneeControl(),this._context.addListener("onThreadChange",this._threadChange.bind(this),this,!0)},_threadChange:function(){this.isRendered()&&(this.resetContent(),this._addAssigneeControl(),this.refresh())},_onAddAssignee:function(){this.getControl("assignees-search-control").show(),this._checkIfMaxWarningMustBeDisplayed()},_addAssigneeControl:function(){var e=this,t="dm"===new l({mid:this._context.communityId}).get("community_type"),i=t?s:a,n={mailAllowed:!0,disableUserGroup:!0,multiSelect:!0,itemMultiSelect:!1,parentSwymView:this,loginsToDisableInSuggestions:this._assignees.map(function(e){return e.get("login")}),events:{onInjected:function(){this.elements&&this.elements.input&&this.elements.input.focus()},onSelect:function(){e._userSelected()},onUnselect:function(){}}};return t&&(n.community_id=this._context.communityId,n.restricted=!0),this.addControl("assignees-search-control",i.createUserSearchControl(n))},getAssigneeDiffStructure:function(){var e=[];return this._assignees.forEach(function(t){this._initialAssigneeCollection.findWhere({login:t.get("login")})||e.push({operation:"add",value:t.get("mid")})}.bind(this)),this._initialAssigneeCollection.forEach(function(t){this._assignees.findWhere({login:t.get("login")})||e.push({operation:"remove",value:t.get("mid")})}.bind(this)),e},_userSelected:function(){var e=this._getAssigneeInAutocompleteControl();e.login||(e.login=e.uri.split(":")[1]),delete e.id,delete e.elements,delete e.datasetId,delete e.hash_key;var t,i=this.getControl("assignees-search-control");0===this._assignees.filter(function(t){return t.get("mid")===e.resourceUid}).length&&(t=new u(e,{areModelDataFromServer:!0}),this._assignees.add(t),this._addAssignee(t)),i.reset()},_removeAssignee:function(e){"read"===this.getOption("mode")&&this._assignees.getAssociated("wedo").save({diffAssignees:[{operation:"remove",value:e.get("mid")}]},{onComplete:function(){}.bind(this),onFailure:function(){this.alert("error",o.AssigneeCouldNotbeRemovedPleaseTryAgainLater)}.bind(this)});this._assignees.remove(e),"edit"===this.getOption("mode")&&this._getAssigneeCollectionView().refresh()},_addAssignee:function(e){"read"===this.getOption("mode")&&this.model.save({diffAssignees:[{operation:"add",value:e.get("mid")}]},{onComplete:function(){}.bind(this),onFailure:function(t,i){this._assignees.remove(e),"ERROR_ASSIGNEE_IS_NOT_PART_OF_COMMUNITY"===i.errorcode&&this.alert("error",o.AssigneeCouldNotbeAddedPleaseTryAgainLater)}.bind(this)})},_getAssigneeInAutocompleteControl:function(){var e,t=this.getControl("assignees-search-control")&&this.getControl("assignees-search-control").getSelection();return t&&t[0]&&(e=t&&t[0]),e},_getAssigneeCollectionView:function(){var e=n.extend({_createEmptyContent:function(){return h.createElement("div",{html:o.NoAssigneesYet})},_toBeTemporarilyRemovedFromDomOnRefresh:!1,_addEmptyView:!0,_getEmptyContentContainer:function(){return this.container}});return this.addChildView("assignees-tiles",new e({collection:this._assignees,bodyAttributes:{class:"wedo-assignees-wrapper"},modelViewClass:i,modelViewsCfg:{editable:this._canEdit(),events:{onRemoveRequest:this._removeAssignee.bind(this)}}}))},_checkIfMaxWarningMustBeDisplayed:function(){var e=this._assignees.length,t=this.getElement(".max-assignees-number-message"),i=this.getControl("assignees-search-control");t&&(e>=10?(t.removeClassName("hidden"),this.container.addClassName("hide-autocomplete"),i.disable()):(t.addClassName("hidden"),this.container.removeClassName("hide-autocomplete"),i.enable())),"edit"===this.getOption("mode")&&this._getAssigneeCollectionView().refresh()},_canEdit:function(){return this.model?this.model.hasCurrentUserEditRights():"edit"===this.getOption("mode")},_createContent:function(){var e=this._canEdit(),t=this.getControl("assignees-search-control"),i="edit"===this.getOption("mode");return[{class:"wedo-header-details",html:[{class:"wedo-header-details-title",html:o.Assignees},e&&!i?{class:"separator",html:"|"}:{},e&&!i?{tag:"span",class:"fonticon fonticon-user-add"}:{}]},e?{class:"max-assignees-number-message hidden",html:o.AssigneesErrorMessage}:{},i?t:t.hide(),{class:"wedo-assignees",html:this._getAssigneeCollectionView()}]}})}),define("DS/SwymUIComponents/script/feature/community/social-event/view/takeaway-viewer",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/UIKIT/Input/Text","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/utils/utils","DS/SwymUIComponents/script/feature/community/social-event/utils/social-event-constants"],function(e,t,i,n,o,s){"use strict";return t.extend({_modelEvents:{onChange:"refresh"},domEvents:{"change .decision-input":"onDecisionTitleChange","click .takeaway-delete":"deleteTakeaway","click .wedo-link":"navigateToWedo"},name:"takeaway-viewer",setup:function(e){this.mode=e.mode,this.isReportPublished=e.isReportPublished,this._parent(e)},_createContent:function(){let t;return"wedo"===this.model.get("type")?(this.container.addClassName("wedo"),t={tag:"div",class:"takeaway-wrapper",html:['<span class="fonticon fonticon-task"></span>',this.mode===s.VIEW_MODE?e.createElement("a",{class:"wedo-link",html:this.model.get("title"),"data-content-id":this.model.get("uri")}):`<span>${this.model.get("title")}</span>`,this.mode===s.REPORT_MODE?{class:"takeaway-delete fonticon fonticon-clickable fonticon-trash",tag:"span"}:null]}):(this.container.addClassName("decision"),t={tag:"div",class:"takeaway-wrapper",html:['<span class="fonticon fonticon-legal"></span>',this.mode===s.REPORT_MODE?new i({className:"decision-input",value:this.model.get("title",{escapeHTML:!1})||"",placeholder:"Enter your decision"}):`<span>${this.model.get("title")}</span>`,this.mode===s.REPORT_MODE?{class:"takeaway-delete fonticon fonticon-clickable fonticon-trash",tag:"span"}:null]}),t},onDecisionTitleChange:function(e){const t=e.target.value;this.model.addChanges("title",t),this.isValid()},isValid(){if("decision"===this.model.get("type")){if(""===this.container.getElement(".decision-input").value)return!1}return!0},getContentAttributes(){let e=this.model.get("type");return"wedo"===e?{type:e,uri:this.model.get("uri")}:{type:e,title:this.model.getChanges("title")||this.model.get("title")}},deleteTakeaway(){this.model.destroy()},navigateToWedo(e){let t=e.target.getAttribute("data-content-id"),i=n.getInstance(),s=i.communityId,a=i.getRoute({contentId:t,contentType:"wedo",communityId:s,editionMode:!1});window.open(`${o.getBaseUrl()}/#${a}`,"_blank")},destroy:function(){return this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/social-event/view/pres-support-editor-collection-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUICore/script/feature/community/social-event/collection/pres-support-collection","DS/SwymUIComponents/script/feature/community/social-event/view/pres-support-editor"],function(e,t,i,n){return t.extend({_collectionClass:i,modelViewClass:n,bodyAttributes:{tag:"div",class:"presentation-support-editor-collection-view"},_collectionEvents:{onChange:"_onContentChanged",onRemove:"_onRemove"},_createContent:function(){let e=this._parent.apply(this,arguments);return 0===this.collection.length?null:e},_onRemove:function(e){this.dispatchEvent("onPresentationSupportRemove")},_onContentChanged:function(){let e=null;for(e in this._childViews)this._childViews.hasOwnProperty(e)&&this._childViews[e].refresh()}})}),define("DS/SwymUIComponents/script/feature/direct-message/room/recent-dms-list-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUIComponents/script/feature/direct-message/view/direct-message-view","DS/SwymUICore/script/feature/thread/collection/thread-lite-collection","DS/UWPClientCode/I18n","i18n!DS/SwymUIComponents/assets/nls/feature/direct-message/direct-messages"],function(e,t,i,n,o,s){"use strict";return t.extend({_collectionClass:n,_selectedDM:null,name:"recent-dms-list-view",modelViewClass:i,modelViewsCfg:{displayHideDMIcon:!1,displayCallIcons:!1,displaySecondLine:!1},domEvents:{"click .direct-message-view-container":"_onDMClick"},_collectionEvents:{onCollectionChange:"conversationUpdated"},bodyAttributes:{tag:"div",class:"recent-conv-list-body"},attributes:{styles:{margin:"10px"}},_onDMSelect:function(e,t){var i=this.getElements(".selected-dm");i&&i.forEach(function(e){e.removeClassName("selected-dm")}),t&&t.addClassName("selected-dm"),e&&e.model&&(this._selectedDM=e.model,this.dispatchEvent("onDMSelected",[this._selectedDM]))},_onDMClick:function(e){var t,i,n=e&&e._uwaTarget;n&&(i=n,t=this.getModelViews().find(function(e){return e.container===i}),this.dispatchEvent("_onDMSelect",[t,i]),e.preventDefault(),e.stopPropagation())},setup:function(e){var t=e&&e.users;this.setCollection(new n([],{mode:"conversation"})),this.updateUsers(t)},getSelectedDM:function(){return this._selectedDM},updateUsers:function(e){var t,i=o.getCurrentLanguage();e.length>0&&(t=e.map(function(e){return'"'+e.resourceId+'"'}),o.getCurrentLanguage(),this.collection.onServerFilteringRequest(null,null,{data:{query:"conversations:("+t.join(" ")+")",locale:i}}))},conversationUpdated:function(){this.dispatchEvent("onConversationUpdated")},_createContent:function(){return[this.collection.length>0?{tag:"div",class:"heading",html:s.RecentConversations}:"",this._parent()]}})}),define("DS/SwymUIComponents/script/feature/community/social-event/view/takeaway-viewer-collection-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUICore/script/feature/community/social-event/collection/takeaway-collection","DS/SwymUIComponents/script/feature/community/social-event/view/takeaway-viewer"],function(e,t,i,n){return t.extend({_collectionClass:i,modelViewClass:n,_collectionEvents:{onChange:"_onContentChanged",onRemove:"_onRemove"},modelViewsCfg:function(){return{widget:this._widget,mode:this.mode,isReportPublished:this.isReportPublished}},setup:function(e){this.mode=e.mode,this.isReportPublished=e.isReportPublished,this._parent.apply(this,arguments)},_createContent:function(){let e=this._parent.apply(this,arguments);return 0===this.collection.length?null:[e]},bodyAttributes:{tag:"div",class:"takeaway-collection-view"},resetChanges(e){e.length&&this.collection.remove(e)},_onRemove:function(e){this.dispatchEvent("onTakeawayRemove")},_onContentChanged:function(){this.dispatchEvent("onContentChange")}})}),define("DS/SwymUIComponents/script/feature/core/search/view/community-selector/conversation-template",["require","exports","UWA/Core","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","DS/SwymUIComponents/script/feature/direct-message/view/direct-message-view"],function(e,t,i,n,o){"use strict";return function(e){var t={favorite:"fonticon-favorite-off"};return function(s,a,r){s.addClassName("default-template"),s.addClassName("conversation-custom-template");var l=r.value.split(":"),c=new n({mid:l[l.length-1]},{}),d=new o({model:c,displayHideDMIcon:!1,displaySecondLine:!1});i.createElement("span",{class:"item-label",html:d.render()}).inject(s),t[e]&&i.createElement("span",{class:"fonticon item-icon "+t[e]}).inject(s),console.log("ytype",e)}}}),define("DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/external-rich-link-preview-view",["UWA/Core","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/abstract-rich-link-preview-view"],function(e,t){"use strict";return t.extend({className:"external-rich-link-preview",rendered:!1,domEvents:{"click .preview-domain-link":"_redirectTo","click .preview-container":"_redirectTo",resize:"onResize"},_redirectTo:function(e){return e.target.className.includes("preview-domain-link")?(window.open(this.model.get("domain")),null):e.target.className.includes("preview-close")||e.target.className.includes("preview-toggle")?(e.stopPropagation(),null):(e.stopPropagation(),void window.open(this.model.get("url")))},onResize:function(){var e,t,i,n;this.rendered&&(t=(e=this.container)&&e.hasClassName("external-rich-link-preview")&&e.offsetWidth,i=this.container.getElement(".preview-title"),n=this.container.getElement(".preview-description"),t&&(t<650?(i.classList.contains("two-lines-title")||i.classList.add("two-lines-title"),n.classList.contains("single-line-description")||n.classList.add("single-line-description")):t>=650&&(i.classList.contains("two-lines-title")&&i.classList.remove("two-lines-title"),n.classList.contains("single-line-description")&&n.classList.remove("single-line-description"))))},render:function(){return this.container.setContent({tag:"div",style:"padding-bottom:1px",html:[{tag:"div",class:"preview-container",contenteditable:!1,"data-url":this.model.get("url"),html:[{tag:"div",class:"icon-type-container external-icon-color",html:[{tag:"span",class:"fonticon fonticon-globe"}]},"null"!==this.model.get("image")?{tag:"img",contenteditable:!1,class:"1"===this.model.get("prefs")||"3"===this.model.get("prefs")?"preview-thumbnail-hidden preview-thumbnail no-media-layout-editor":"preview-thumbnail no-media-layout-editor",src:this.model.get("image")}:{},{tag:"div",class:"preview-data-container",html:[{tag:"div",class:"preview-menu",html:[!0===this.options.editable?this.createPreferencesMenu(this.model):"",!0===this.options.editable?this.createDeleteIcon():""]},{tag:"div",class:"preview-title-container",html:[{tag:"div",class:"preview-title crop-title",html:this.model.get("title").length>=63?this.formatTitle(this.model.get("title")):this.model.get("title")}]},{tag:"div",class:"preview-domain",html:[{tag:"a",class:"preview-domain preview-domain-link",html:this.model.get("domainToDisplay")}]},{tag:"span",class:"2"===this.model.get("prefs")||"3"===this.model.get("prefs")?"preview-desc-is-hidden preview-description no-media-layout-editor":"preview-description no-media-layout-editor crop-description",html:this.model.get("description").length>=150?this.model.get("description").replace(/^(.{150}[^\s]*).*/,"$1"):this.model.get("description")}]},{tag:"span",class:"url",html:{tag:"a",href:this.model.get("domain")}}]}]}),this.rendered=!0,this}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/rich-link-preview-generator",["UWA/Core","UWA/String","UWA/Class/Events","UWA/Class/Listener","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/external-rich-link-processing-utils","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/embedded-rich-link-processing-utils","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/internal-rich-link-processing-utils","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/external-rich-link-preview-model","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/internal-rich-link-preview-model","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/embedded-rich-link-preview-model","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/external-rich-link-preview-view","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/internal-rich-link-preview-view","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/embedded-rich-link-preview-view","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/rich-link-preview-utils","DS/Logger/Logger","DS/UIKIT/Spinner","DS/SwymUICore/script/utils/utils","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/edit/rich-link-preview/rich-link-preview-generator"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w,C){"use strict";function f(e){var t,i=!1,n=w.getBaseUrl().replace(/:443\/?$/,""),o=0===e.indexOf(n);return o||(i=n===(t=(t=null!==e.match("#app:X3DMCTY_AP")&&2===e.match(/content:url=(.*?(?=&))/i).length&&e.match(/content:url=(.*?(?=&))/i)[1].replace(/%3A/g,":").replace(/%2F/g,"/").replace(/%2e/g,"."))&&t.replace(/:443\/?$/,""))),i||o}return n.singleton(i,{createPreview:function(e){var t=e.pastedURL,i=e.editorEl,n=e.callback,h=f(t);"youtube.com"===getHostName(t)||"youtu.be"===getHostName(t)?new c(s.getOEmbedJson("youtube",t,function(e){var t=new u({model:e,editable:!0});n(t)})):h?t&&a.getSearchData(t,i,function(e){if(p.log("getURLInformation callback",e),"noAccess"===e.type)require(["DS/UWPClientControls/PlatformNotify"],function(e){e.warn(C.contentNotIndexedYet)});else{var t=new l(e),i=new m({model:t,editable:!0});n(i)}}):o.getURLInformation(t,function(e){if(p.log("getURLInformation callback",e),"html"===e.type&&e.title){var t=new r(e),i=new d({model:t,editable:!0});n(i)}else require(["DS/UWPClientControls/PlatformNotify"],function(e){e.warn(C.unsupportedUrlType)})})},createPreviewFromLink:function(t,i,n,o){var w,C,y,v,A,_=function(n){(new g).inject(n).show(),new c(s.getOEmbedJson("youtube",n.href,function(s){var a=e.extend({model:s,editable:!1},o&&o.youtube||{}),r=new u(a);i?r.render().inject(t,"bottom"):r.render().inject(n,"after"),e.Utils.Client.Engine.ie11?n.parentElement.removeChild(n):n.remove()}))},S=function(o){o.href&&a.getSearchData(o.href,t,function(s){p.log("getURLInformation callback",s);var a=new l(s);a.set("prefs",o.getAttribute("data-prefs"));var r=new m({model:a,editable:n});let c=o.parentElement,d=!1;i?r.render().inject(t,"bottom"):c&&"p"===c.tagName.toLowerCase()&&1===c.children.length?(r.render().inject(c,"after"),d=!0):r.render().inject(o,"after"),e.Utils.Client.Engine.ie11?o.parentElement.removeChild(o):(o.remove(),d&&c&&(d=!1,c.remove()))})},b=!1;if(e.is(t,"string")||t instanceof Text)w=function(t){var i;if(e.is(t,"string")||t instanceof Text)return 1===(i=e.createElement("div",{html:t})).childNodes.length&&i.childNodes[0]instanceof HTMLElement?i.childNodes[0]:i;throw new Error("Only strings or text nodes are accepted")}(t);else{if(!(t instanceof HTMLElement))throw new Error("Unknown type of content");w=t}if((C=w.getElementsByClassName("preview-link")).length>0){for(var I=C.length-1;I>=0;I--){var D=f(C[I].href);if("youtube.com"===getHostName(C[I].href)||"youtu.be"===getHostName(C[I].href)?_(C[I]):D?S(C[I]):(y=new r(h.extractLinkData(C[I])),v=new d({model:y,editable:n}),i?v.render().inject(t,"bottom"):(A=C[I].parentElement)&&"p"===A.tagName.toLowerCase()&&1===A.children.length?(v.render().inject(A,"after"),b=!0):v.render().inject(C[I],"after"),e.Utils.Client.Engine.ie11?C[I].parentElement.removeChild(C[I]):(C[I].remove(),b&&A&&(b=!1,A.remove()))),i)break}return w}return t}})}),define("DS/SwymUIComponents/script/lib/ckeditor/autohyperlink/plugin",["UWA/Utils/Client","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/rich-link-preview-generator"],(e,t)=>{CKEDITOR.plugins.add("autohyperlink",{exclusion:[37,38,39,40,1114129],getUrlType:e=>e.includes(document.location.host)?"internal":"external",moveAfterAnchor(e){if(e.data&&-1===this.exclusion.indexOf(e.data.keyCode)){const t=e.editor.getSelection(1),i=t&&t.getRanges();if(i&&1===i.length&&i[0].collapsed){const e=i[0],t=e.startPath().contains("a"),{startContainer:n}=e;if(t&&n&&(n.type===CKEDITOR.NODE_ELEMENT&&1===e.startOffset||n.type===CKEDITOR.NODE_TEXT&&e.startOffset===n.getLength())){let i=n;for(;i&&!i.equals(t);){if(null!=i.getNext())return;i=i.getParent()}e.moveToPosition(t,CKEDITOR.POSITION_AFTER_END),e.select()}}}},autoDetectLink(e){const i=/\bhttps?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:;%_\+.~#?&\/=]*)\b/i,n=/^\s*https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:;%_\+.~#?&\/=]*)\s*$/i,o=/(?!<a[^>]*>[^<])\bhttps?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:;%_\+.~#?&\/=]*)\b(?![^<]*<\/a>)/gi,{editor:s}=e,a=s.getSelection(),r=a?a.getRanges()[0]:null;let l,c,d=null;const m=(e,t)=>{e.createPreview({editorEl:s.container.$,pastedURL:t,previewGenerationTriggers:["paste"],callback(e){const t=new CKEDITOR.dom.element("p");s.insertElement(t),e.render().inject(t.$,"before"),t.focus()}})};if(r&&e)if(c=r.startOffset,l=e.data&&(13===e.data.keyCode||32===e.data.keyCode||2228237===e.data.keyCode||"blur"===e.name),e.data&&r.endContainer.$.parentNode&&"A"!==r.endContainer.$.parentNode.tagName&&l){if(r.endContainer.$.nodeValue){const e=r.endContainer.$.nodeValue.trim(),n=r.endContainer.$.parentNode,o=e.slice(0,c).split(" ").pop().trim();let a="";o.match(i)&&(d=s.getSelection().createBookmarks(!0),c-o.length>0?a=n.innerHTML.match(`&nbsp;${o}`)?"&nbsp;":" ":n.innerHTML.match(`<br>${o}`)&&(a="<br>"),n.innerHTML=n.innerHTML.replace(a+o,`${a}<a data-type="external" href="${o}">${o}</a>`),r.moveToBookmark(d[0]),r.select(),m(t,o))}}else if("paste"===e.name&&["html","text"].includes(e.data.type)){if(r.endContainer.$.parentNode){const a=/(<([^>]+)>)/gi,r=/^<a([\s\S]*?)href="([^"]*)"/g;let l;const c=e.data.dataValue&&e.data.dataValue.replace(a,"");if("text"===e.data.type&&new RegExp(i).test(c)){if(!n.test(c)){e.cancel();const t=e.data.dataValue.replaceAll(o,e=>{return`<a data-type="${this.getUrlType(e)}" href="${e}">${e}</a>`});return void s.insertHtml(t)}l=c}else if("html"===e.data.type)if(new RegExp(r).test(e.data.dataValue)){const t=new RegExp(r).exec(e.data.dataValue).pop();new RegExp(i).test(t)&&(l=t)}else if(new RegExp(i).test(c)){if(!n.test(c)){e.cancel();const t=e.data.dataValue.replaceAll(o,e=>{return`<a data-type="${this.getUrlType(e)}" href="${e}">${e}</a>`});return void s.insertHtml(t)}l=c}if(c&&l){const i=this.getUrlType(l);e.cancel(),s.insertHtml(`<a data-type="${i}" href="${l}">${c}</a>`),m(t,l)}}}else if(r.endContainer.$.parentNode&&"A"===r.endContainer.$.parentNode.tagName&&e.data&&-1===this.exclusion.indexOf(e.data.keyCode)&&!l){const t=r.endContainer.$.parentNode.innerText,n=e.data.domEvent.$.key;let o="";(o=n.length>1?t.substr(0,c-1)+t.substr(c):t.substr(0,c)+n+t.substr(c)).match(i)&&(d=s.getSelection().createBookmarks2(!0),r.endContainer.$.parentNode.outerHTML=`<a data-type="external" href="${o}">${t}</a>`,r.moveToBookmark(d[0]),r.select())}},init(t){const i=this;t.on("key",e=>{i.autoDetectLink(e),i.moveAfterAnchor(e)},null,null,1),t.on("blur",e=>{i.autoDetectLink(e),i.moveAfterAnchor(e)},null,null,1),e.Engine.ie||t.on("paste",e=>{i.autoDetectLink(e),i.moveAfterAnchor(e)})}})}),define("DS/SwymUIComponents/script/utils/content-process",["UWA/Core","UWA/Array","DS/SwymUICore/script/utils/utils","DS/SwymUIComponents/script/utils/media-utils","DS/Logger/Logger","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/rich-link-preview-generator","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/rich-link-preview-utils"],(e,t,i,n,o,s,a,r)=>{const l={processImages(t,o,s,a){if(t){let s,r,l,c,d,m,u,h,p,g,w,C,f,y,v=null;const A=["data-content-id","data-to-width","data-crop","data-type","data-width_for_sprite_cut","data-height_for_sprite_cut","data-status","data-to-height","data-cls-over","data-sprite-key","data-sprite_resizing","data-image-timestamp"];a=a||{},"string"==typeof t?y=e.createElement("div",{html:t}):(y=t,!1!==o&&(f=i.removeForFutureReinsertion(y.container||y)));try{g=y.getElements('img[data-media-id], img[data-content-id]:not([data-type="CommunityNoPicture"])')}catch(e){g=y.getElements("img[data-media-id], img[data-content-id]")}for(s=0,c=g.length;s<c;s++)if(w=(h=g[s]).attributes,h.style.backgroundImage="",h.style.backgroundSize="",h.style.backgroundPosition="",h.style.backgroundRepeat="","0px"!==h.style.height&&"0"!==h.style.height||(h.style.height=""),h.style.padding="",h.style.height="",h.style.width="",h.removeAttribute("width"),h.removeAttribute("height"),(v=w.getNamedItem("data-content-id"))?(v=v.value,(d=document.createAttribute("data-media-id")).value=v,w.setNamedItem(d)):(v=w.getNamedItem("data-media-id"))&&(v=v.value),v){if((C=w.getNamedItem("data-to-width")||w.getNamedItem("width"))&&(C=C.value)&&(w.getNamedItem("width")?w.getNamedItem("width").value=C:((d=document.createAttribute("width")).value=C,w.setNamedItem(d))),(p=w.getNamedItem("data-fingerprint"))?p=p.value:(u=w.getNamedItem("data-image-timestamp"))&&(u=u.value),C||(C=parseInt(h.style.width,10)),a.mediaPictureUrl)m=a.mediaPictureUrl;else{m=n.getBestMediaViewConfig(v,n.CONTENT_SECTION_MAX_WIDTH).url}for(w.getNamedItem("src")?w.getNamedItem("src").value=m:((d=document.createAttribute("src")).value=m,w.setNamedItem(d)),i.hasMediaBeenDeleted(v,a.imagesInfo,t)&&(h.removeAttribute("data-content-thumbnail"),h.setAttribute("data-deleted-media","true")),l=0,r=A.length;l<r;l++)h.removeAttribute(A[l])}return"string"==typeof t?y.getHTML():(f&&f(),y)}},contentProcessTables(e){let t,i,n,o;const s=e.getElements("table");for(o in s)s.hasOwnProperty(o)&&!s[o].getParent().hasClassName("responsive-table")&&(i=s[o].getParent(),(t=document.createElement("div")).setAttribute("class","responsive-table"),n=s[o].cloneNode(!0),t.appendChild(n),i.replaceChild(t,s[o]));return e},getInlineTagElsInHtml:e=>e&&e.getElements&&e.getElements("a.s6m-tag-link[data-predicate]"),updateInlineTagsLookAccordingToTagsList(i,n,o=[]){let s=!1;switch(e.typeOf(i)){case"string":i=e.createElement("div",{html:i}),s=!0;break;case"element":e.extendElement(i);break;case!1:default:throw new Error("The HTML content is invalid!")}if(!Array.isArray(n))throw new Error("Tag list is missing!");return this.getInlineTagElsInHtml(i).forEach(e=>{const i=e.getText(),{predicate:s,tagValue:a}=e.dataset;if(i)if(t.detect(n,e=>{const t=null==a?i:a;return e.predicate===s&&e.tag===t})){if(e.removeClassName("disabled-link"),null!=a){o.find(e=>e.object===a)?e.dataset.communityTag=!0:delete e.dataset.communityTag}}else e.addClassName("disabled-link")}),!0===s?i.getHTML():i},contentPostProcess(t,n){let o=t&&t.container||t;if(e.is(o,"element")){let e,t,a,r,c,d,m;const u=["mce_href","_nodup"];(!n||n&&!1!==n.removeAndReinsert)&&(m=i.removeForFutureReinsertion(o));const h=o.getElements("a");(!n||n&&!1!==n.imageProcessing)&&l.processImages(o,!1,null,n),n&&!0===n.updateInlineTagsLookAccordingToTagsList&&n.tagList&&(o=l.updateInlineTagsLookAccordingToTagsList(o,n.tagList,n.communityTags));for(let i=0,n=h.length;i<n;i+=1)if(d=(t=h[i]).attributes,r="internal"!==(a=t.dataset.type)?"external":"internal",t.removeEvent("click"),"external"===r){(e=document.createAttribute("desc")).value=t.getText(),d.setNamedItem(e),d.getNamedItem("type")?d.getNamedItem("type").value=r:((e=document.createAttribute("type")).value=r,d.setNamedItem(e)),c=null,d.getNamedItem("url")?c=d.getNamedItem("url").value:(e=document.createAttribute("url"),(c=t.innerHTML).contains("http://")||c.contains("https://")||(c=`http://${c}`),e.value=c,d.setNamedItem(e)),d.getNamedItem("onclick")&&(t.onclick=null);let i=null;d.getNamedItem("href")||(i=t.innerHTML,(e=document.createAttribute("href")).value=c,d.setNamedItem(e),t.innerHTML=i),d.getNamedItem("target")?d.getNamedItem("target").value="_blank":((e=document.createAttribute("target")).value="_blank",d.setNamedItem(e));for(let e=0,i=u.length;e<i;e+=1)t.removeAttribute(u[e])}return m&&m(),s.createPreviewFromLink(o,!1,!1),o}if(o)throw new Error("This function now expects a DOM Element")},ckeditorContentPreProcess(e,t){let i=e.element.$;!1===a.getInstance().editionMode&&(i=r.convertURLPreviewToLink(i,!0)),s.createPreviewFromLink(i,!1,!0)}};return l}),define("DS/SwymUIComponents/script/lib/ckeditor/ckeditor",["UWA/Core","DS/SwymUIComponents/script/lib/ckeditor/ckeditor-config","DS/SwymUIComponents/script/utils/content-process","DS/UWPClientCode/I18n","UWA/Utils/Client","DS/SwymUIComponents/script/lib/ckeditor/ckeditor-command-creator","DS/SwymUICore/script/utils/utils","i18n!DS/SwymUIComponents/assets/nls/lib/ckeditor/ckeditor"],(e,t,i,n,o,s,a,r)=>{const l=a.debounce((e,t)=>{const{config:i}=e,{model:n}=i,{modelAttribute:o}=i;n&&o&&("function"==typeof n.addChanges?n.addChanges(o,t||e.getData()):n.set(o,t||e.getData()))},2e3),c="safari"===o.Engine.name&&o.Platform.ios&&!1===o.Platform.ipad,d="p;h1;h2;ul;li;ol;i;u;s;strong;blockquote;em;table[*]{*};caption;thead[*]{*};tbody[*]{*};th[*]{*};tr[*]{*};td[*]{*};br;figcaption;pre;b;a[data-type,data-content-type,data-content-id,data-community-id,data-login,data-users-group-uri,desc,url,href,target,contenteditable,data-predicate,data-tag-value,data-desc,data-title,data-img,data-prefs](*);figure[data-size,data-position](*){*};img[data-media-pasted-id,data-content-id, data-media-id,data-community-id,data-media-type, data-file-extension, style,class,title,longDesc,src,data-size,data-position,data-media_cid,data-new_media,data-content-thumbnail,data-deleted-media](*){*};div[contenteditable,class,data-url](*);span[contenteditable,class, data-emoji-unicode](*);iframe(*){*}[*];",m={change(e){l(e.editor)},contentDom(t){const{editor:i}=t;i.container&&i.container.$&&void 0===i.config.skipUIKitFormControlClass&&e.extendElement(i.container.$).addClassName("swym-rte"),i.editable().on("contextmenu",e=>{const t=i.getSelection();if(!t||t.isLocked)return;const n=t.getStartElement();n&&n.is&&n.getAscendant("table")||(e.cancel(),e.stop())},null,null,1)},paste(e){const{data:i}=e,{dataProcessor:n}=e.editor,o=new(0,t.filter)(d);o.disallow("font;img[width,height]{width,height,padding-top};");let s=n.toHtml(i.dataValue,{filter:o,fixForBody:!1});s.match("^<table.*?</table>$")&&(s=`<div class="responsive-table">${s}</div>`),i.dataValue=s},customConfigLoaded(e){const{editor:t}=e;t.config.removeButtons="Subscript,Superscript"},key(e){let t,i,n,o;e&&e.data&&e.data.domEvent&&e.data.domEvent.$&&("pageup"!==(i=(t=e.data.domEvent.$).key&&t.key.toLowerCase())&&"pagedown"!==i||(e.cancel(),n=(o=e.editor).createRange(),"pageup"===i?n.moveToElementEditStart(n.root):n.moveToElementEditEnd(n.root),o.getSelection().selectRanges([n]),n.scrollIntoView()))}},u=e.extend(e.extend({},t.config),{language:n.getCurrentLanguage(),removePlugins:"elementspath,autolink",removeButtons:"Superscript",disableNativeSpellChecker:!1,extraAllowedContent:d,disallowedContent:"font;img[width,height]{width,height,padding-top};",toolbar:[{name:"clipboard",groups:["undo"],items:["Undo","Redo"]},{name:"basicstyles",groups:["basicstyles","cleanup"],items:["Bold","Italic","Underline","Strike","-","RemoveFormat"]}],contentsCss:[t.getUrl("contents.css"),require.toUrl("DS/UIKIT/UIKIT.css"),require.toUrl("DS/SwymUIComponents/SwymUIComponents.css")]}),h=e.extend(e.extend({},u),{height:350,resize_minHeight:350,autoGrow_minHeight:350,bodyClass:"content-body",extraPlugins:"customlink,indentblock,pastefromword,customtable,autohyperlink",toolbar:[{name:"clipboard",groups:["undo"],items:["Undo","Redo"]},{name:"basicstyles",groups:["basicstyles","cleanup"],items:["Bold","Italic","Underline","Strike","-","RemoveFormat"]},{name:"paragraph",groups:["list","indent","blocks","align","bidi"],items:["NumberedList","BulletedList","-","Outdent","Indent","-","Blockquote","CreateDiv","-","JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"]},e.Utils.Client.Platform.ios?"/":"",{name:"links",items:["CustomLink","Unlink"]},{name:"insert",items:["Image","Table","HorizontalRule","SpecialChar"]},{name:"styles",items:["Styles","Format","Font","FontSize"]},{name:"colors",items:["TextColor","BGColor"]}]}),p=e.extend(e.extend({},u),{height:150,resize_minHeight:150,autoGrow_minHeight:150,removePlugins:`${u.removePlugins?`${u.removePlugins},`:""}image`,extraPlugins:"usageTracker,customlink,pastefromword,customtable,autohyperlink,highlight, autoDetectInlineTagOnPaste",skipUIKitFormControlClass:!0,toolbar:[{name:"basicstyles",items:["Bold","Italic","Underline","Strike","Highlight","-","RemoveFormat"]},c?"":{name:"links",items:["CustomLink","Unlink"]}]}),g=e.extend(e.extend({},u),{height:150,resize_minHeight:150,autoGrow_minHeight:150,removePlugins:`${u.removePlugins?`${u.removePlugins},`:""}image`,extraPlugins:"usageTracker,sticky,customlink,pastefromword,customtable,autohyperlink,h1Style,h2Style,formattedStyle,BulletedListStyle,NumberedListStyle,BlockquoteStyle,highlight, autoDetectInlineTagOnPaste",skipUIKitFormControlClass:!0,toolbar:[{name:"paragraph",groups:["paragraph","cleanup"],items:["h1Command","h2Command","BulletedListCommand","NumberedListCommand","BlockquoteCommand","formattedCommand","-","Outdent","Indent","AddCustomTable"]},{name:"basicstyles",items:["Bold","Italic","Underline","Strike","Highlight","-","RemoveFormat"]},c?"":{name:"links",items:["CustomLink","Unlink"]}]}),w=e.extend(e.extend({},u),{height:150,resize_minHeight:150,autoGrow_minHeight:150}),C=t.editor.prototype.setData;s.createCommand(t),t.config=h,t.disableAutoInline=!0,t.dtd.$removeEmpty.span=0,t.editor.prototype.setData=function(t,n,o){let s,a=t,l=null;return o||((s=this.extraOptions&&this.extraOptions.view&&this.extraOptions.view.model)&&(l={imagesInfo:s.get("thumbnails_infos")}),a=i.processImages(a,null,!1,l),function(t){let i,n;t&&t!==this._lastSetSwymData&&(n='strike, small, big, h3, h4, h5, h6, tt, code, kbd, samp, var, del, ins, cite, q, hr, p[style*="text-align"], h2[style*="font-style"], h3[style*="font-style"], h3[style*="color"], span[dir]',(i=e.createElement("div",{html:t})).getElement('strike, small, big, h3, h4, h5, h6, tt, code, kbd, samp, var, del, ins, cite, q, hr, p[style*="text-align"], h2[style*="font-style"], h3[style*="font-style"], h3[style*="color"], span[dir]')&&require(["DS/UWPClientControls/PlatformNotify"],e=>{e.warn(r.get("Yourcontentdisplaymayhavechanged"))}))}.call(this,a),this._lastSetSwymData=a),C.call(this,a,n,o)},window.document.addEventListener("dragstart",e=>{e.dataTransfer.setData("text/html",i.processImages(e.dataTransfer.getData("text/html"),null,!1))});const f={CKEditor:t,getDefaultConfig:()=>e.extend({},h),getSimpleFormattingEditorConfig:()=>e.extend({},p),getNewCommentEditorConfig(){const t=e.extend({},p);return t.removePlugins+=`${t.removePlugins?", ":""}magicline`,t},getExtendedCommentEditorConfig:()=>e.extend({},g),getSurveyEditorConfig:()=>e.extend({},w),getDefaultListeners:()=>m,addListeners(e){e&&(Object.keys(m).forEach(t=>{e.on(t,m[t])}),Object.keys(e.customListeners).forEach(t=>{e.on(t,e.customListeners[t])}))}};return t.on("dialogDefinition",e=>{const i=e.data.name,n=e.data.definition;if("image"===i){n.removeContents("Link");const e=n.getContents("info");e.remove("txtAlt"),e.remove("txtBorder"),e.remove("txtHSpace"),e.remove("txtVSpace"),e.remove("cmbAlign"),n.onLoad=(()=>{t.dialog.getCurrent().getContentElement("info","txtUrl").getElement().hide()})}}),t.on("instanceReady",e=>{const{editor:t}=e,i=t.commands;t.removeMenuItem("paste"),t.removeMenuItem("cut"),t.removeMenuItem("copy"),t.removeMenuItem("table"),document.execCommand("enableInlineTableEditing",null,!1),document.execCommand("enableObjectResizing",null,!1),i.indent.editorFocus=0,i.outdent.editorFocus=0,i.table.editorFocus=0,i.customlink.editorFocus=0,i.customtable.editorFocus=0}),f}),define("DS/SwymUIComponents/script/feature/community/media/view/picture-viewer",["UWA/Core","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/lib/model/generic/swym-model","DS/UIKIT/Spinner","DS/SwymUIComponents/script/utils/media-utils","DS/SwymUIComponents/script/utils/content-process"],function(e,t,i,n,o,s,a){"use strict";var r=null;return i.extend({_modelEventsForAutoRefresh:["onSync:read","onSync:update","onVirtualChange:content"],_modelEvents:window.ds&&"3DD"===window.ds.env?{onNewMediaUploaded:"refresh"}:{},name:"picture-viewer",widthToLoad:null,_createContent:function(){return void 0===this.model.get("preview")?e.createElement("div",{styles:{margin:"auto","text-align":"center",height:"40px"},html:new o({className:"msg-animation",visible:!0,animate:!0,spin:!0})}):{styles:{clear:"both","padding-top":"5px","padding-bottom":"10px"},html:[{tag:"img",class:"img-responsive",src:this.pictureHasChanged?r:s.getPreviewThumbnail(this).url}]}},init:function(e){if(e&&e.model instanceof n)return this.addEvent("onRedraw",function(){a.contentPostProcess(this)}),this._parent.apply(this,arguments);throw new Error("Provided argument is not an instance of Swym Class")},setup:function(){this._parent.apply(this,arguments),this.pictureHasChanged=!1,"preview"===this.options.viewMode&&this.model.addEvent("onPictureHasChanged",this._onPictureChanged,this),this.container.addEvent("resize",this.refresh.bind(this))},_onPictureChanged:function(e,t){this.pictureHasChanged=!0,r=t}})}),define("DS/SwymUIComponents/script/feature/community/media/view/media-3dplay-viewer",["UWA/Core","UWA/Promise","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/config/bootstrap-model","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/view/media-3d-viewer","DS/UIKIT/Spinner","DS/SwymUIComponents/script/utils/media-utils","DS/SwymUICore/script/utils/utils","DS/SwymUIComponents/script/utils/content-process","DS/SwymUICore/script/feature/core/context/context-model","DS/WebappsUtils/WebappsUtils","DS/WAFData/WAFData","DS/SwymUIComponents/script/utils/dnd-utils","DS/i3DXCompassServices/i3DXCompassPubSub","DS/Logger/Logger"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p){"use strict";var g=window.ds&&window.ds.isMDE;return i.extend({_playerObj:null,_modelEventsForAutoRefresh:["onSync:read"],_contentOverlaViewContainerOriginalHeight:null,_modelEvents:window.ds&&"3DD"===window.ds.env?{onNewMediaUploaded:"refresh"}:{},name:"media-3dplay-viewer",domEvents:{},on3DPlayerReadyBound:null,init:function(e){return e.annotationsEventBus&&(this.annotationsEventBus=e.annotationsEventBus,this.annotationsEventBus.addEvent("onLoadAnnotationRequest",this.onLoadAnnotationRequestCallback,this)),this._parent.apply(this,arguments)},_createContent:function(){var t,i=this.model;if(i){if(this._fileViewable){this.reinitView();
//! I do not know what usecase the following code is for... I have commented it to fix the issue of redirection to 3dplay or story when clicking on the 3DSwym app from compass
var n="",r={position:"relative","z-index":"0",width:"100%",height:"100%"};i.get("status")===a.MEDIA_PROCESSING_STATUS.KO?n=o.mediaError:this._fileViewable||(n=o.mediaNotProcessed),t=[],this._fileViewable&&t.push({id:"canvas-wrapper-"+this.cid,class:"x3dplay-wrapper"+(this.height?" specific-height":""),styles:r}),n&&t.push({class:"warning-wrapper",styles:{margin:"15px 0px 5px 0px"},html:n})}else t=e.createElement("div",{styles:{margin:"auto","text-align":"center",height:"40px"},html:new s({className:"msg-animation",visible:!0,animate:!0,spin:!0})});return t}},setup:function(e){this.addEvent("onRedraw",function(){l.contentPostProcess(this)}),void 0!==e.height&&(this.height=e.height),this.onAnnotationSharedBound||(this.onAnnotationSharedBound=this._onAnnotationShared.bind(this)),void 0!==e.width&&(this.width=e.width),this._parent.apply(this,arguments),window.ds&&"3DD"===ds.env&&this._widget&&this._widget.addEvent("contentDroppedInWidget",this.reinitView.bind(this)),g&&this.model.isDriveFile()?(this._fileViewable=!0,this._3dsaInitDone=!0):this._fileViewable=this._isFileViewable(),this.on3DPlayerReadyBound=this.on3DPlayerReady.bind(this),this.instantiatedInDetailedView=c.getInstance().isContentContext(),this.addEvent("ShareTo3DSwYm",function(){this._playerObj.performAction("ShareTo3DSwYm")}),this.addEvent("Share3DComment",function(){this._playerObj.performAction("Share3DComment")})},loadAnnotation:function(e){var t=this._playerObj;if(t){var i={};e&&"annotation"===e.type&&e.data&&e.data.annotationFile&&(i.annotation=e.data.annotationFile,t.loadAnnotations&&t.isReady&&t.isReady()&&t.loadAnnotations(i,{clean:!0}))}},onLoadAnnotationRequestCallback:function(e){this._playerObj&&this._playerObj.isReady()?this.loadAnnotation(e):this.loadedAnnotation=e},_onAnnotationShared:function(e){p.log("----------------------",e);var t=e.screenshot,i=e.annotation,n=this.model.get("subject6wuri");this.annotationsEventBus&&n&&this.annotationsEventBus.dispatchEvent("onAnnotationShared",{annotation:{type:"annotation",file:t,data:{annotationFile:i},relatedMediaUri:n}})},_getOptions:function(){var t=this.model,i=c.getInstance(),n=t.get("ratio")?a.getPreviewThumbnail(this).url:null,o={topBar:{id:this._widget?this._widget.id:" "},loading:"autoplay",activeState:Boolean(i.isContentContext()),callback:{onAnnotationShared:this.onAnnotationSharedBound}};if(n&&(o.splashscreen={custom:new e.createElement("div",{styles:{"background-image":"url("+n+")","background-size":"contain","background-position":"center","background-repeat":"no-repeat",height:"100%","background-color":"white"}})}),window.ds&&"3DSwym"===ds.env){o.topBar={id:"3DPlayTopBarProxy"};try{require("DS/TopBar/TopBar").MainMenuBar.setActiveMenuProviders(["topBarProxyDefault","3DPlayTopBarProxy"])}catch(e){require(["DS/TopBar/TopBar"],function(e){e.MainMenuBar.setActiveMenuProviders(["topBarProxyDefault","3DPlayTopBarProxy"])})}}return o},instantiate3DPlay:function(){if(this._fileViewable){if(!this.getElement("#canvas-wrapper-"+this.cid))return void p.error("3DPlay container does not exist!");var t={container:"canvas-wrapper-"+this.cid,input:this._getInputOptions(),options:this._getOptions(),widget:this._getWidgetParam()};null===this._playerObj&&this.on3DPlayerReadyBound&&require(["DS/3DPlayHelper/3DPlayHelper"],function(i){try{e.extendElement(window.top.document).addEvent("3DPLAYREADY",this.on3DPlayerReadyBound),this._playerObj=i(t)}catch(e){p.error(e)}}.bind(this))}},_getWidgetParam:function(){return this._widget?this._widget:""},on3DPlayerReady:function(){this.dispatchEvent("mediaViewReady",this),this.show(),this.loadedAnnotation&&setTimeout(()=>{this.loadAnnotation(this.loadedAnnotation),delete this.loadedAnnotation},3e3)},onDestroy:function(){if(this.annotationsEventBus&&this.annotationsEventBus.removeEvent("onLoadAnnotationRequest",this.onLoadAnnotationRequestCallback,this),this.on3DPlayerReadyBound)try{e.extendElement(window.top.document).removeEvent("3DPLAYREADY",this.on3DPlayerReadyBound)}catch(e){p.error(e)}return this.reinitView(),this._parent.apply(this,arguments)},onHide:function(){return p.info("media-3d-viewer, widget.onHide"),this.instantiatedInDetailedView&&this.reinitView(),this._parent.apply(this,arguments)},onShow:function(){},reinitView:function(){if(window.ds&&"3DSwym"===ds.env)try{require("DS/TopBar/TopBar").MainMenuBar.setActiveMenuProviders(["topBarProxyDefault"])}catch(e){require(["DS/TopBar/TopBar"],function(e){e.MainMenuBar.setActiveMenuProviders(["topBarProxyDefault"])})}this._playerObj&&this._playerObj.informActiveState&&(this._playerObj.informActiveState(!1),this._playerObj.dispose())}})}),define("DS/SwymUIComponents/script/feature/community/media/view/media-360-viewer",["DS/SwymUIComponents/script/feature/community/media/view/media-3dplay-viewer"],function(e){"use strict";return e.extend({name:"media-360-viewer",_isFileViewable:function(){return!0},setup:function(e){e.width=null,e.height=null,this._parent.apply(this,arguments)},_getMediaURL:function(){var e,t=this.model.get("play");return t&&(e=t.download_original_url.transient_url),e},_getImageFormat:function(){var e,t=this.model.get("play");return t&&(e=t.download_original_url.format),e},_getInputOptions:function(){return{experience:{provider:"FILE",filename:"DS/3DPlay360Experiences/3DPlay360Experience"},asset:{provider:"FILE",format:this._getImageFormat(),filename:this._getMediaURL(),requiredAuth:null,proxyurl:"none",withCredentials:!0}}},onRedraw:function(){this.instantiate3DPlay()}})}),define("DS/SwymUIComponents/script/feature/community/media/view/media-3d-viewer",["UWA/Core","DS/SwymUIComponents/script/feature/community/media/view/media-3dplay-viewer","DS/SwymUIComponents/script/utils/media-utils","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/view/media-3d-viewer","DS/WebappsUtils/Console","UWA/Data","DS/SwymUICore/script/utils/utils"],function(e,t,i,n,o,s,a){"use strict";var r=window.ds&&window.ds.isMDE;return t.extend({_3dsaInitDone:!1,name:"media-3d-viewer",setup:function(e){e.width=null,this._parent.apply(this,arguments)},_isFileTypeWhiteListed:function(e){var t=this.model;return t.get("format_3dsa")===e||t.get("fileName")&&t.get("fileName").contains("."+e)},_isFileViewable:function(){var e=this.model;return!(!e||null!==this._playerObj||!(e.get("status")===i.MEDIA_PROCESSING_STATUS.OK&&void 0!==e.get("preview")&&void 0!==e.get("play")||this._isFileTypeWhiteListed("3dxml")||this._isFileTypeWhiteListed("3dsto")||this._isFileTypeWhiteListed("3dskt")||this._isFileTypeWhiteListed("3dwb")||this._isFileTypeWhiteListed("udl")))},_getInputOptions:function(){var e=this.model,t={},i=window.ds&&"MOBILE"===window.ds.env;return r&&e.isDriveFile()?(t.physicalid=e.get("mid"),t.provider="3DDRIVE",t.dtype=e.get("ds6w:what/ds6w:type"),t.tenant=a.getCurrentTenantId()):(t.asset={provider:"FILE",format:e.get3DFileFormat(),filename:i?s.proxifyUrl(e.get3DFileURL(),{proxy:"passport"}):e.get3DFileURL(),requiredAuth:null,proxyurl:"none",withCredentials:!0,requestsOptions:{proxy:i?"passport":"none"}},t.usage="3DSwYm"),t},onRedraw:function(){this._3dsaInitDone?this.instantiate3DPlay():(o.log("media-3d-viewer - will call 3dsa"),i.request3DSAAuthentification({authenticationUrl:this.model.get("play").wake_up_url,successCallback:this.instantiate3DPlay.bind(this),failureCallback:function(){o.error("basic user info is KO"),require(["DS/UWPClientControls/PlatformNotify"],function(e){e.error(n.The3DFilecannotbeviewed)})}}),this._3dsaInitDone=!0)}})}),define("DS/SwymUIComponents/script/feature/community/media/view/document-pdf-viewer",["DS/SwymUIComponents/script/feature/community/media/view/media-3dplay-viewer","UWA/Data"],function(e,t){"use strict";return e.extend({name:"document-pdf-viewer",setup:function(e){this.instantiatedInSummaryView=e.instantiatedInSummaryView,this._parent.apply(this,arguments)},_isFileViewable:function(){return!0},_getInputOptions:function(){var e=window.ds&&"MOBILE"===window.ds.env;return{asset:{provider:"FILE",format:this.model.get("play").download_original_url.format,filename:e?t.proxifyUrl(this.model.get("play").download_original_url.transient_url,{proxy:"passport"}):this.model.get("play").download_original_url.transient_url,requiredAuth:null,proxyurl:"none",withCredentials:!0,requestsOptions:{proxy:e?"passport":"none",withCredentials:!0}}}},onRedraw:function(){this.instantiate3DPlay()}})}),define("DS/SwymUIComponents/script/feature/community/media/view/video-viewer",["UWA/Core","UWA/Class","UWA/Utils","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/view/video-viewer","DS/SwymUIComponents/script/feature/community/media/view/video/player-behaviors","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/DSVideoJS/DSVideoJS","DS/SwymUICore/script/utils/i18n","DS/UIKIT/Spinner","DS/SwymUIComponents/script/utils/content-process","DS/SwymUIComponents/script/utils/media-utils","DS/WebappsUtils/Console"],function(e,t,i,n,o,s,a,r,l,c,d,m,u){"use strict";var h=window.ds&&"3DD"===window.ds.env,p=t.singleton({_playerInstanceIds:[],setup:function(e){if(e&&e.id){if(e.id){var t,i=this,n=videojs(e.id);i._playerInstanceIds.push(e.id),n&&(n.on("play",function(){u.log("an instance is playing");for(var e=0,n=i._playerInstanceIds.length;e<n;e++)i._playerInstanceIds[e]!==this.id_&&(t=videojs(i._playerInstanceIds[e]))&&t.pause&&!0!==t.loop()&&(u.log("is player playing before being paused : ",!t.paused()),t.pause())}),n.on("pause",function(){u.log("an instance has been paused"),this&&!0===this.loop()&&(u.log("instance relaunched"),this.play())}))}e.isFluid&&this.setOption("isFluid",e.isFluid)}},hasPlayer:function(e){return this._playerInstanceIds.indexOf(e)>-1},remove:function(e){this._playerInstanceIds.pop(e)}});return a.extend({_modelEventsForAutoRefresh:[],_modelEvents:{"onVirtualChange:content":"_onVirtualChange"},_offset:null,_iOSVersionError:!1,_useHTML5:!1,_clientInfo:null,_onVirtualChange:function(){"preview"===this.viewMode&&this.refresh()},_onVideoDownload:function(){},getState:function(){var e=videojs(this._getVideoId());return{offset:e.currentTime(),state:e.paused()&&e.hasStarted()?"readyForThumbnail":"notReadyForThumbnail"}},name:"video-viewer",_checkIOSVersion:function(){if(/iP(hone|ad)/.test(navigator.platform)){var e=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d)?/);return parseInt(e[1],10)+"."+parseInt(e[2],10)}return!1},_createContent:function(){var e,t;return u.info("_createContent",this.model.get("status")),this._clientInfo.isIos&&(t=this._checkIOSVersion()),!t||"10.0"!==t&&"10.1"!==t?(this._useHTML5=!0,e={tag:"sound"===this.model.get("media_type")?"audio":"video",class:"video-js vjs-big-play-centered",id:this._getVideoId()}):(this._iOSVersionError=!0,e={class:"video-iOS-error",html:[{class:"fonticon fonticon-4x fonticon-attention "},{html:n.iOSDoesNotSupport3DSwymVideos}]}),this.dispatchEvent("mediaViewReady"),e},_getVideoId:function(){return"video"+this.cid},defaultOptions:{isLightboxContext:!1},setup:function(e){return this._parent.apply(this,arguments),this.height=this.model.get("height")||e.height,this._clientInfo=s.getClientInformation(),this.viewMode=this.options.viewMode,"edit"===this.viewMode&&(this.options.autoplay=!1),this.addEvent("onRedraw",function(){d.contentPostProcess(this)}),this.addEvent("onMediaDownload",this._onVideoDownload),this},createFileLevel:function(){var e=this.model,t=e.get("media_type"),i=e.get("nb_video_streams_3dsa"),n=e.get("play").av_streams,o=e.get("ratio"),s=[];"video"===t&&(o=-1!==o.indexOf("Nan")?"4:3":o.replace("/",":")),parseInt(i,10)>0&&"sound"===t&&(t="video");for(var a=0,r=n.length;a<r;a++){var l=n[a];s.push({file:l.transient_url,format:l.format,label:"video"===t?l.alias:"",default:"480p"===l.alias})}this.fileUrls=s},authenticate:function(e,t){m.request3DSAAuthentification({authenticationUrl:this.model.get("play").wake_up_url,successCallback:e,failureCallback:t})},initVideoHTML5:function(){var t,n=this._getVideoId(),s=[],a=[],r={oncontextmenu:"return false;"},l=this.model,c=l.get("play").preview_scans,d=l.get("play").subtitles,u=l.get("play").chapters,g=l.get("media_type"),w="",C="";this.createFileLevel();for(var f=0,y=this.fileUrls.length;f<y;f++)a.push({tag:"source",src:o.getAVStream(this.fileUrls[f].file),label:this.fileUrls[f].label,res:this.fileUrls[f].label,type:("sound"===g?"audio":"video")+"/"+("sound"===g?"mpeg":this.fileUrls[f].format)}),0===f&&"animatedPicture"!==g&&(w=this.fileUrls[f].label,C=this.fileUrls[parseInt(y/2,10)-1].label);f=0;for(var v=d.length;f<v;f++)s.push({tag:"track",kind:"subtitles",src:d[f]?d[f].transient_url:"",label:d[f]?d[f].alias:""});const A=c.filter(e=>"jpg"===e.format),_=c.filter(e=>"vtt"===e.format),S=A.length>0;(S||_.length>0)&&(s.push({tag:"track",kind:"metadata",src:_[0].transient_url}),t=S?A[0].transient_url:(t=(t=_[0].transient_url.split("/")).slice(0,t.length-1)).join("/")+"/");for(f=0,v=u.length;f<v;f++)s.push({tag:"track",src:u[f]?u[f].transient_url:"",kind:"chapters"});h&&(r.crossoriginvjs="use-credentials"),this.height&&(r.height=this.height+""),"video"===g&&(r.poster=m.getPreviewThumbnail(this).transient_url);var b=this.getElement("video")||this.getElement("audio");b&&(b.setAttributes(r),b.addContent(a),b.addContent(s),"animatedPicture"===g&&b.setAttribute("muted",""));var I=videojs(n,{fluid:this.getOption("isFluid"),controls:e.is(this.options.controls)?this.options.controls:"animatedPicture"!==g,autoplay:!e.is(this.options.autoplay)||this.options.autoplay,preload:"auto",loop:o.getLoopBehavior(g),controlBar:{fullscreenToggle:"video"===g,volumePanel:{inline:!1}},playsinline:i.Client.Features.touchEvents&&"animatedPicture"===g,textTrackSettings:!1,plugins:"video"===g?{thumbnails:{basePath:t},videoJsResolutionSwitcher:{default:!0===this.getOption("isLightboxContext")?w:C,dynamicLabel:!0}}:{}});I.one("ready",this._onReady.bind(this)),I.on("fullscreenchange",function(){var e,t=I.currentResolution().label;I.isFullscreen()?(t!==w&&(this.previousRes=t,I.currentResolution(w)),(e=this.container.getClosest(".scroller-root"))&&e.setStyle("transform",this.scrollViewElOriginalStyle)):(t!==this.previousRes&&I.currentResolution(this.previousRes),(e=this.container.getClosest(".scroller-root"))&&(this.scrollViewElOriginalStyle=e.getStyle("transform"),e.setStyle("transform","none")))}.bind(this)),p.setup({id:n})},_onReady:function(){this.show()},onRender:function(){u.info("video onrendered"),this._iOSVersionError?this.show():this._useHTML5&&(this.authenticate(function(){this.model&&(this._loaded||(this._loaded=!0,u.log("authenticated !"),"sound"===this.model.get("media_type")?this.initVideoHTML5():require(["DS/DSVideoJS/DSVideoResolutionSwitcherPlugin","DS/DSVideoJS/DSVideoThumbnailPlugin"],function(e,t){this.initVideoHTML5()}.bind(this))))}.bind(this),function(){u.error("basic user info is KO"),require(["DS/UWPClientControls/PlatformNotify"],function(e){e.error(n.Thevideocannotbeviewed)})}.bind(this)),this.show())},onHide:function(){if(p.hasPlayer(this._getVideoId())){var e=videojs(this._getVideoId());e&&"animatedPicture"!==this.model.get("media_type")&&e.pause()}},onShow:function(){if(p.hasPlayer(this._getVideoId())){var e=videojs(this._getVideoId());e&&"animatedPicture"===this.model.get("media_type")&&e.play().then(function(){},function(){e.controls(!0)})}},onDestroy:function(){p.remove(this._getVideoId());try{var e=videojs(this._getVideoId());e&&e.dispose()}catch(e){u.log("Error in getting videoInstance on video viewer destroy. This means it is possible that there is no videoInstance")}this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/media/view/animated-picture/mobile/gif-video-viewer",["DS/SwymUIComponents/script/feature/community/media/view/video-viewer"],function(e){"use strict";return e.extend({_playIndex:0,_maxTimesToPlay:3,name:"gif-video-viewer",initVideoHTML5:function(){this._parent(),videojs(this._getVideoId()).on("ended",this.onAnimatedPicturePlayEnded.bind(this))},onAnimatedPicturePlayEnded:function(){var e=videojs(this._getVideoId());this._playIndex++,console.log("------",this.playIndex),this._playIndex===this._maxTimesToPlay?(e.pause(),this.playIndex=0,this.dispatchEvent("onRefreshRequest")):e.play()}})}),define("DS/SwymUIComponents/script/feature/community/media/view/video-thumbnail-editor-view",["DS/SwymUIComponents/script/feature/community/media/view/video-viewer"],function(e){"use strict";return e.extend({name:"video-thumbnail-editor",_modelEvents:{onVirtualChange:"_onChangeThumbnailTime"},_convertBackendDateInMs:function(e){var t=e.split(":"),i=0;return t[0],t[1],t[2]&&(i=3600*parseInt(t[0])+60*parseInt(t[1])+parseInt(t[2])),1e3*i},_onChangeThumbnailTime:function(){var e=this.model.hasVirtuallyChanged("thumbnail_time_ms")?this.model.getChanges("thumbnail_time_ms"):this._convertBackendDateInMs(this.model.get("thumbnail_time")),t=videojs(this._getVideoId());t&&(t.one("play",function(){t.readyState()?(t.currentTime(e/1e3),t.pause()):t.one("loadedmetadata",function(){t.pause(),t.currentTime(e/1e3)})}),t.play())},_onReady:function(){this._onChangeThumbnailTime()}})}),define("DS/SwymUIComponents/script/feature/community/content/view/swym-editor-view",["UWA/Core","UWA/Event","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/utils/content-process","DS/SwymUIComponents/script/utils/media-utils","UWA/Utils/Client"],function(e,t,i,n,o,s){return i.extend({name:"swym-editor-view",addMediaButton:null,ckeditor:null,_isSafariIpad:"safari"===s.Engine.name&&s.Platform.ios&&!0===s.Platform.ipad,getImgTagToInsertIntoEditor(t,i){var s,a,r,l,c=null,d=this,m=null,u=e.extendElement(t.cloneNode()),h=320;if(u.setStyles({backgroundImage:"",backgroundSize:"",backgroundPosition:"",backgroundRepeat:""}),a=u,!e.is(i,"function"))throw new Error("A callback is expected");if((s=u.dataset.mediaId)||(s="media"===u.getAttribute("data-content-type")&&u.getAttribute("data-content-id"))&&(u.dataset.mediaId=s),l=u.getAttribute("data-media-type"),u.removeAttribute("data-to-width"),u.removeAttribute("data-to-height"),"picture"===l)c=function(){var t,s,l,u,p;m?(u=parseInt(m.get("width"),10),p=parseInt(m.get("height"),10)):(u=a.naturalWidth||parseInt(a.style.width,10),p=a.naturalHeight||parseInt(a.style.height,10),u>0||(u=(t=a.getSize()).width,p=t.height)),p>0&&!d.isDestroyed()&&(s=u/p,u>o.PICTUREVIEW_V0.DIMENSIONS.LARGE.WIDTH||p>o.PICTUREVIEW_V0.DIMENSIONS.LARGE.HEIGHT?s>1?(h=o.PICTUREVIEW_V0.DIMENSIONS.LARGE.WIDTH,r=h/s):(r=o.PICTUREVIEW_V0.DIMENSIONS.LARGE.HEIGHT,h=r*s):(h=u,r=p),a.dataset.mediaId&&(l=o.generateBestThumbnailForContentView(h,r,null,{mediaId:a.dataset.mediaId,mediaType:"picture",mediaWidth:u,mediaHeight:p,imgTag:a}),a=n.processImages(e.createElement("div",{html:a}),null,!1,{mediaPictureKey:l.sizeCategory,mediaPictureUrl:l.url}).getElement("img")),a.removeEvent("load",c),a.set(e.merge(h>o.CONTENT_LARGE_IMAGE_MIN_WIDTH?{"data-size":"large","data-position":"center"}:{},{styles:{width:h,height:""}})),a.remove(),a.removeClassName("loading-image"),i.call(this,a,{heightToDisplay:r,widthToDisplay:h,imageWidth:u,imageHeight:p}))},s?require(["DS/SwymUICore/script/feature/community/media/model/media-model"],function(e){(m=new e({mid:s})).fetch({fromCache:!0,onComplete:c})}):a.complete?c():(a.addClassName("loading-image"),a.addEvent("load",c),a.inject(document.body));else{const t=()=>{let s,l;if(a=n.processImages(e.createElement("div",{html:u}),null,!1).getElement("img"),m)s=parseInt(m.get("width"),10),l=parseInt(m.get("height"),10);else if(s=parseInt(a.naturalWidth||a.getStyle("width")||a.width||320,10),l=parseInt(a.naturalHeight||a.getStyle("height")||a.height||320,10),s<=0){const e=a.getSize();s=e.width,l=e.height}const c=s/l;s>o.PICTUREVIEW_V0.DIMENSIONS.LARGE.WIDTH||l>o.PICTUREVIEW_V0.DIMENSIONS.LARGE.HEIGHT?c>1?(h=o.PICTUREVIEW_V0.DIMENSIONS.LARGE.WIDTH,r=h/c):(r=o.PICTUREVIEW_V0.DIMENSIONS.LARGE.HEIGHT,h=r*c):h=s,a.removeEvent("load",t),h>o.CONTENT_LARGE_IMAGE_MIN_WIDTH&&a.set({"data-size":"large","data-position":"center",styles:{width:h}}),a.remove(),a.removeClassName("loading-image"),i.call(this,a)};s?require(["DS/SwymUICore/script/feature/community/media/model/media-model"],function(e){(m=new e({mid:s})).fetch({fromCache:!0,onComplete:t})}):a.complete?t():(a.addClassName("loading-image"),a.addEvent("load",t),a.inject(document.body))}},_insertBase64ImageStyle(t,i,n){if(!i)throw new Error("Media CID is missing!");if(!n)throw new Error("Image dimensions info are missing!");this.elements[`swym-b64-img-style-${i}`]=e.createElement("style",{type:"text/css",id:`swym-b64-img-style-${i}`,html:`.swym-b64-img[data-media_cid="${i}"] {`+`    background-image: url(${t.src});`+"}"}).inject(document.head)},replaceBase64ImageSrcWithCSSClass(t,i,n){var o;"picture"===t.dataset.mediaType&&e.is(i,"object")&&(o=t.src)&&o.indexOf(";base64")>=0&&(this._insertBase64ImageStyle(t,n.cid,i),t.addClassName("swym-b64-img"),t.setAttribute("data-media_cid",n.cid),t.src=`data:image/svg+xml,${encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${i.imageWidth} ${i.imageHeight}" width="${i.imageWidth}" height="${i.imageHeight}"></svg>`)}`)},insertMediaIntoTextEditor(e,t,i){var n=this,o=e&&e.target||t,s=this.getChildView("textEditorView"),a=s?s.ckeditor:this.ckeditor;this.getImgTagToInsertIntoEditor(o,function(e,t){n.replaceBase64ImageSrcWithCSSClass(e,t,i),!1===n._isSafariIpad?a.insertElement(new CKEDITOR.dom.element(e)):a.container.appendHtml(e.outerHTML)})},createTagImageForEditor(t){var i=t.getCommunity(),n=i.get("mid"),o=i.isDirectMessage(),s={"data-media-id":t.get("mid"),"data-media-type":t.get("media_type"),"data-source":"swym","data-to-width":"320"};o?s["data-dm-id"]=n:s["data-community-id"]=n,this.insertMediaIntoTextEditor({target:e.createElement("img",s)},null,t)},hideAddMediaView(){var e=this.getElement(".add-media-container"),t=this.getElement(".attached-media");e&&e.hide(),t&&t.setContent(""),this.addMediaButton&&this.addMediaButton.setState(2)},updateEditor(){},onInjected(){this.dispatchEvent("onNodeInject")},onNodeInject(){this.updateEditor()},saveSnapShot(){return!this.isDestroyed()&&this.ckeditor?(this.ckeditor.fire("saveSnapshot"),this):null},destroy(){var e=this;return null!==this.ckeditor&&setTimeout(function(){try{e.ckeditor.destroy(!0)}catch(e){}e.ckeditor=null},0),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/content/view/simple-editor-view",["UWA/Core","UWA/Event","UWA/Utils/Client","i18n!DS/SwymUIComponents/assets/nls/feature/community/generic/view/simple-editor-view","DS/SwymUIComponents/script/feature/community/content/view/swym-editor-view","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/utils","DS/UIKIT/Scroller","DS/Logger/Logger","DS/SwymUIComponents/script/utils/content-process","DS/SocialUserMention/Utils/Generic","DS/UIKIT/Popover"],(e,t,i,n,o,s,a,r,l,c,d,m,u)=>{function h(e,t){const i=a.getInstance(),n=i.get("user"),{editableElement:o}=t;return{editableElement:o,containerElement:document.body,boundingElement:!0===e.getOption("restrictUserMentionAutocompleteDisplayZoneToTextEditor")?o.parentElement:null,tenantId:i.get("config").tenant.online_instance_id,"3DSwymUrl":r.getBaseUrl(),"3DSwymServerToken":i.getCSRFToken(),linksExtraAttributes:{"data-type":"internal"},userLogin:n.login,userName:`${n.first_name} ${n.last_name}`,events:{onInsert(t){t&&t.cursorPosition&&e.placeCursorAt(t.cursorPosition.offset,{node:t.cursorPosition.node}),e.saveSnapShot(),setTimeout(()=>{e.ckeditor&&(e.dispatchEvent("onRTEContentChanged",[e.ckeditor.getData()]),e.dispatchEvent("onMentionInsert"))},0)}}}}let p=null,g=null,w=null;return o.extend({_modelClass:s,_modelEventsForAutoRefresh:[],name:"simple-editor-view",_editorIsUpdated:!1,editionMode:!1,_switchedToRTE:!1,_placeholderEl:null,_iosTextarea:null,_observer:null,domEvents:{"keydown .editable-container":"_onKeydown","keyup .editable-container":"_onKeyup","mousedown .editable-container":"_onContentMousedown","cut .editable-container":"_onContentCutOrPaste","paste .editable-container":"_onContentCutOrPaste","focusin .editable-container":"_focusOnEditor","click .placeholder":"_focusOnEditor","focusout .editable-container":"_focusOutEditor",input:"_onInpuEditor"},defaultOptions:{overrideDefaultEnterBehaviour:!1,overrideDefaultCtrlEnterBehaviour:!1,overrideToolbarStickiness:!1,modelAttr:"content",rtePlaceholder:n.StartWriting,useFocusStyle:!1,focusOnEditorInit:!0,mandatory:!0,activateUserMention:!0,activateInline6WTagging:!1,cssPlaceholder:!1,enableEmojis:!1},init(...e){this._focusOnEditor=this._focusOnEditor.bind(this),this._focusOutEditor=this._focusOutEditor.bind(this),this.onResizeObserved=this.onResizeObserved.bind(this),this._parent(...e)},_onContentMousedown(){this._onContentMouseupBound||(this._onContentMouseupBound=this._onContentMouseup.bind(this)),document.body.addEvent("mouseup",this._onContentMouseupBound),this.shouldToolbarFloat()&&this.hideRTEToolbar()},_focusOnEditor(){if(this.options.useFocusStyle){const e=this.container;e.hasClassName("focused")||e.addClassName("focused")}},_focusOutEditor(){if(this.options.useFocusStyle){const e=this.container;e.hasClassName("focused")&&e.removeClassName("focused")}},shouldToolbarFloat(){return"advancedRTE"!==this.getOption("mode")||this.getOption("overrideToolbarStickiness")},_onInpuEditor(){(this.getTextArea()&&i.Platform.ios||!this.isEmptyRTEContent())&&this.removePlaceholder()},_onContentMouseup(t){if(document.body.removeEvent("mouseup",this._onContentMouseupBound),!this.shouldToolbarFloat())return;const i=window.getSelection(),n=i.toString();n.length>0&&"\n"!==n||i.rangeCount>0&&!e.extendElement(t.target).match("img")?setTimeout(this.displayContextualToolbarWRTTextSelection.bind(this),0):this.hideRTEToolbar()},setup(...e){this._parent(...e)},generatePlaceholderText(){return this.options.rtePlaceholder},displayContextualToolbarWRTTextSelection(){let e,t,i,n,o,s,a;const r=window.getSelection(),l=r.toString(),c=!(window.innerWidth>869);if(l.length>0||r.rangeCount>0){if(e=r.getRangeAt(0),l.length<=0&&r.rangeCount>0){const t=e.cloneContents(),i=document.createElement("div");if(i.appendChild(t),!t.firstChild||i.innerHTML.length<=0)return}i=(t=e.getBoundingClientRect()).top,n=t.bottom,o=t.left,a=i>52?i-52:(s=this._widget.getViewportDimensions().height)-n>42?n+10:10,c&&"advancedRTE"===this.options.mode&&(a-=30),window.innerWidth<o+290&&(o=window.innerWidth-290)<0&&(o=0),this.positionRTEToolbar(a,o),this.showRTEToolbar()}},positionRTEToolbar(e,t){const i=document.body.getElement(`#cke_${this.getTextAreaId()}`);i&&(i.style.setProperty("top",`${e}px`,"important"),i.style.setProperty("left",`${t}px`,"important"),i.setStyle("position","absolute"))},_onKeydown(e){const i=t.whichKey(e);let n;const o=e.ctrlKey||e.metaKey;if("ctrl+return"===i&&!e.shiftKey)return this.dispatchEvent("onCtrlEnterKeyPressed"),!0!==this.getOption("overrideDefaultCtrlEnterBehaviour");if("return"===i&&!e.shiftKey)return this.dispatchEvent("onEnterKeyPressed"),!0!==this.getOption("overrideDefaultEnterBehaviour");switch(e.keyCode){case 27:this.dispatchEvent("onEscKeyPressed");break;case 8:this.dispatchEvent("onBackspaceKeyPressed")}return!o||86!==e.keyCode&&88!==e.keyCode||(n=this.ckeditor?this.ckeditor.getData():"",this.dispatchEvent("onRTEContentChanged",[n])),!0},_onContentCutOrPaste(){const{ckeditor:e}=this,t=e?e.getData():"";t.length>0&&setTimeout(this.dispatchEvent.bind(this,"onRTEContentChanged",[t]),100,this)},_onKeyup(e){let t,n;const o=e.ctrlKey||e.metaKey,{ckeditor:s}=this,a=s?s.getData():"";i.Engine.ie&&this.updatePlaceHolderVisibility(a),this.shouldToolbarFloat()&&(16===e.keyCode||17===e.keyCode||e.shiftKey||o?((n=(t=window.getSelection()).toString()).length>0||t.rangeCount>0&&!e.target.match("img"))&&this.displayContextualToolbarWRTTextSelection():(this.hideRTEToolbar(),this.dispatchEvent("onRTEContentChanged",[a])))},_onKeydownInCKEditor(e){let t,i,n,o;e&&e.data&&e.data.domEvent&&e.data.domEvent.$&&(i=e.data.domEvent.$,t=this._onKeydown(i),e.editor&&""===e.editor.getData()&&(o=(n=e.data.keyCode)>47&&n<58||n>64&&n<91||n>95&&n<112||n>185&&n<193||n>218&&n<223)&&this.removePlaceholder(),!1===t&&e.cancel())},_onInsertElementInCKEditor:r.getDelayedSyncTask(function(){this.dispatchEvent("onInsertElementInCKEditor")},1e3),_onChangeInCKEditor:r.throttle(function(e){const t=p.getDefaultListeners().change;e&&(t&&t.call(this,e),this.updatePlaceHolderVisibility(e.editor&&e.editor.getData()),e.cancel())},200),_onPasteInSimpleCKEditor(e){e&&e.editor&&""===e.editor.getData()&&e.data&&e.data.dataValue&&e.data.dataValue.length>0&&this.removePlaceholder()},_onPasteInCKEditor(e){const t=e;let i;this._onPasteInSimpleCKEditor();const{dataProcessor:n}=t.editor,o=new(0,CKEDITOR.htmlParser.filter)({elements:{img(e){e.remove()},table:function(e){!0===this.getOption("enableEmojis")&&e.remove()}.bind(this)}}),s=n.toHtml(t.data.dataValue,{filter:o,fixForBody:!1});!0===this.getOption("enableEmojis")?(i=this._detectAndWrapEmojis(s),t.data.dataValue=i.newText):t.data.dataValue=s},_detectAndWrapEmojis(e,t){let i=null;const{dataProcessor:n}=this.ckeditor,o=new(0,CKEDITOR.htmlParser.filter)({text(e,n){let o=e;return n&&!n.parent.attributes["data-emoji-unicode"]&&(o=e.replace(/([\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2300-\u27BF]|\uD83E[\uDD10-\uDDFF])/g,(o,s,a)=>(i=n,`<span contenteditable="false" data-emoji-unicode="${(e=>{let t;return 1===e.length&&(t=e.charCodeAt(0)),((t=1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)<0||Number.isNaN(t))&&(t=e.charCodeAt(0)),t.toString("16").toUpperCase()})(s)}">${s}</span>${a===e.length||t&&!0===t.addNonBreakableSpaceAtTheEnd?"":""}`))),i&&o.match(/\u200B$/)&&(o=o.replace(/\u200B$/,"")),o}});return{text:e,newText:n.toHtml(e,{filter:o,fixForBody:!1}),hasTextBeenAltered:Boolean(i)}},hideRTEToolbar(){const e=document.body.getElement(`#cke_${this.getTextAreaId()}`);e&&e.addClassName("hidden")},showRTEToolbar(){const e=document.body.getElement(`#cke_${this.getTextAreaId()}`);e&&e.hasClassName("hidden")&&(e.removeClassName("hidden"),e.addClassName("shown"))},setFocus(){if(!i.Platform.ios){if(this.ckeditor)this.ckeditor.focus();else{const e=this.getTextArea();e&&e.focus()}this._focusOnEditor()}},switchedToRTE(){return this._switchedToRTE},switchToRTE(e,t,i,n){let o="";const s=this.getTextArea();i&&(this.options.mode=i),this.switchedToRTE()||(this._switchedToRTE=!0,this.ckeditor||e?"<p><br></p>"!==e&&(o=e):o=s?s.getHTML():"",this.isEmptyRTEContent(o)||this.removePlaceholder(),!0!==t&&!1!==this._editorIsUpdated||this.updateEditor(o,n))},_createInput(){return i.Platform.ios&&(!this._parentView||this._parentView&&"advancedRTE"!==this._parentView.options.mode)?e.createElement("div",{id:this.getTextAreaId(),class:"editable-container content-body",styles:{"-webkit-user-select":"text","user-select":"text"},html:{tag:"textarea",class:"iosTextArea",styles:{opacity:"0",width:"100%",height:"38px",position:"absolute",top:"0",left:"0"}}}):e.createElement("div",{id:this.getTextAreaId(),class:"editable-container content-body",contenteditable:"false",html:i.Engine.firefox||i.Engine.ie?"<p><br></p>":""})},_listenClickOutside(e){let t;const i=this.getControl("emojiPopover");i&&i.elements&&this._listenClickOutsideBound&&((t=i.elements.container.contains(e.target))||(i.hide(),window.removeEventListener("click",this._listenClickOutsideBound)))},_createEmojiInput(){const t=e.createElement("span",{class:"fonticon fonticon-1-5x fonticon-emoji-smile"});return this.addControl("emojiPopover",new u({target:t,trigger:"touch",className:"emoji-popover",position:"top right",body:"Loading...",autoHide:!1,offset:{x:3,y:5},events:{onInjected:function(){if(!this._emojiPopoverInitiated){const e=this.addChildView("emoji-selector",{Class:"DS/SwymUIComponents/script/feature/community/content/edit/emoji-selector-view",events:{onEmojiClick:this._onEmojiClick.bind(this)}});this.getControl("emojiPopover").setBody([e]),this._emojiPopoverInitiated=!0}}.bind(this),onShow:function(){this._listenClickOutsideBound=this._listenClickOutside.bind(this),window.addEventListener("click",this._listenClickOutsideBound)}.bind(this),onHide(){this._listenClickOutsideBound&&(window.removeEventListener("click",this._listenClickOutsideBound),delete this._listenClickOutsideBound)}}})),t},_insertEmoji(e){const t=this._detectAndWrapEmojis(e,{addNonBreakableSpaceAtTheEnd:!0}).newText;this.ckeditor.insertHtml(t),this.saveSnapShot(),this.dispatchEvent("onEmojiInsert",[this,e,t])},_onEmojiClick(e){const{unicode:t}=e;t&&(this.ckeditor?(this._insertEmoji(t),this.dispatchEvent("onRTEContentChanged")):(this.addEventOnce("editorIsReady",()=>{this._insertEmoji(t),this.placeCursorAt(),this.dispatchEvent("onRTEContentChanged",[])}),this.switchToRTE()))},_createContent(){const t=[];let i;return this.elements.editableContainer=this._createInput(),i=this.getOption("isSimpleRTE")||this.getOption("isInstantMessageRTE")?e.createElement("div",{class:"editable-container-wrapper",styles:{position:"relative","min-height":this.getOption("isInstantMessageRTE")?"44px":"56px"},html:this.elements.editableContainer}):this.elements.editableContainer,t.push({id:`sticky_${this.getTextAreaId()}`,class:`cke_editor_${this.getTextAreaId()}`,styles:{position:"sticky",top:"0"}}),t.push(this.getPlaceholderEl()),!0===this.getOption("enableEmojis")&&(i.addClassName("editor-with-emojis"),t.push(this._createEmojiInput())),t.push(i),t},onResizeObserved(){const e=this.getElement(".editable-container"),t=this.getElement(".editable-container-wrapper"),i=t&&parseInt(t.getStyle("height",10),10),n=e&&e.getSize().height;0!==n&&(i!==n||i>200)&&(n<200?t.setStyle("height",`${n}px`):t.setStyle("height","200px"))},bindEvents(){const e=this.getTextArea();e&&i.Engine.firefox&&e.addEvents({focus:this._focusOnEditor,blur:this._focusOutEditor})},updatePlaceHolder(e){const t=this._placeholderEl.getElement(".placeholder-text");t&&e&&t.setHTML(e)},getPlaceholderEl(){let t;return!0!==this.options.cssPlaceholder?this._placeholderEl||(t=this.generatePlaceholderText(),this._placeholderEl=e.createElement("div",{class:`placeholder${!1===this.getOption("mandatory")?" not-mandatory":""}`,id:`placeholder_${this.getTextAreaId()}`,html:[{tag:"span",class:"placeholder-text",html:t},!0===this.options.mandatory?{tag:"span",class:"invalid",html:" *"}:""]})):this.elements.editableContainer&&(this.elements.editableContainer.dataset.placeholder=this.generatePlaceholderText(),this.elements.editableContainer.hasClassName("show-placeholder")||(this.elements.editableContainer.addClassName("show-placeholder"),this.dispatchEvent("onPlaceholderAdded"))),this._placeholderEl},onRender(){const t=this.getTextToBeDisplayed(),n=this.container.getElement(".editable-container"),o=i.Platform.ios;o&&(!this._parentView||this._parentView&&"advancedRTE"!==this._parentView.options.mode)&&(this._iosTextarea=this.elements.editableContainer.innerHTML),e.is(this.model)?this.switchToRTE(t):t.length>0&&(this.removePlaceholder(),o?this.getTextArea().innerHTML+=t:this.getTextArea().innerHTML=t),!this._observer&&(this.getOption("isSimpleRTE")||this.getOption("isInstantMessageRTE"))&&n&&(this._observerTarget=n,this._observer=new MutationObserver(this.onResizeObserved),this._observer.observe(this._observerTarget,{characterData:!0,childList:!0,subtree:!0}))},getTextToBeDisplayed(){let e="";const{model:t}=this;return t?e=t.hasVirtuallyChanged(this.options.modelAttr)?t.getChanges(this.options.modelAttr):t.get(this.options.modelAttr):this.options.initialText&&(e=`<p>${this.options.initialText}</p>`),e},enableMentions(){let e=null;const t=this.getTextArea();if(t){const i=h(this,{editableElement:t});g&&!1!==this.getOption("activateUserMention")&&(e=i.linksExtraAttributes,i.linksExtraAttributes=(t=>("user"===t.memberType&&(e["data-content-type"]="person"),e)),g.enableFeature(i)),w&&!0===this.getOption("activateInline6WTagging")&&w.enableFeature(h(this,{editableElement:t}))}},updateEditor(t,n={}){let o=!1;this._editorIsUpdated=!0,setTimeout(()=>{o||(this.mask(),o=!0)},1e3),require(["DS/SwymUIComponents/script/lib/ckeditor/ckeditor","DS/SocialUserMention/SocialUserMention","DS/SwymUIComponents/script/feature/community/content/edit/inline-6wtagging"],(a,r,l)=>{if(p=a,g=r,w=l,!this.isDestroyed()){let a,{ckeditor:r}=this;const l=this.getTextArea();let m;if(l&&(l.setAttribute("contenteditable","true"),this.enableMentions()),l&&l.isInjected()&&(a=t||this.getTextToBeDisplayed(),r&&r.element.$===l||(m="advancedRTE"===this.options.mode?p.getExtendedCommentEditorConfig(s):p.getNewCommentEditorConfig(s),this.ckeditor=p.CKEditor.inline(l,m),(r=this.ckeditor).on("instanceReady",()=>{let e;if("advancedRTE"===this.options.mode&&(e=document.body.getElement(`.cke_editor_${r.name}`))&&e.addClassName("cke_editor_advanced_editor"),(this.shouldToolbarFloat()||i.Features.touchEvents)&&this.hideRTEToolbar(),this.ckeditor&&(this.ckeditor.container&&this.ckeditor.container.$.removeAttribute("title"),this.dispatchEvent("editorIsReady"),this.getOption("focusOnEditorInit")&&"advancedRTE"!==this.getOption("mode")&&n.focus))try{this.placeCursorAt()}catch(e){c.log(e)}}),r.on("insertElement",this._onInsertElementInCKEditor,this,void 0,100),e.extend(r.config,{model:this.model,modelAttribute:this.options.modelAttr}),r.extraOptions={view:this},r.customListeners={key:this._onKeydownInCKEditor.bind(this),change:this._onChangeInCKEditor.bind(this),paste:this._onPasteInCKEditor.bind(this),focus:()=>{this.container&&this.container.getElement(".editable-container")&&"<p><br></p>"===this.container.getElement(".editable-container").innerHTML&&(c.log("setting cursor position on focus!"),this.placeCursorAt())}},p.addListeners(r)),r)){const e=this.isEmptyRTEContent(a);!e||e&&r.getData()?(r.setData(a,()=>{this.mask(),d.ckeditorContentPreProcess(r,{model:this.model}),this.unmask(),n.focus&&this.placeCursorAt()}),e||this.removePlaceholder()):n.focus&&this.setFocus()}o?this.unmask():o=!0}})},showPlaceholder(){const e=this.getPlaceholderEl();this.isEmptyRTEContent()&&(e&&e.show(),this.elements.editableContainer.addClassName("show-placeholder"),this.dispatchEvent("onPlaceholderAdded"))},removePlaceholder(){const e=this.getPlaceholderEl();e&&e.hide(),this.elements.editableContainer.removeClassName("show-placeholder"),this.dispatchEvent("onPlaceholderRemoved")},isPlaceholderShown(){return this.elements.editableContainer.hasClassName("show-placeholder")},updatePlaceHolderVisibility(t){let i=t;if(!e.is(i,"string")){const e=this.getTextArea();e&&(i=e.getHTML())}e.is(i,"string")&&(this.isEmptyRTEContent(i)?this.showPlaceholder():this.removePlaceholder())},isEmptyRTEContent(t){let i=t,n=!1;const o=this.getTextArea();e.is(i,"string")||(i=o?o.getHTML():"");const s=i.replace(/\s|&nbsp;|\u200B|&#8203;/gm,"").trim();return("<p><br></p>"===s||""===s||i===this._iosTextarea||i.match('^<textarea class=\\"iosTextArea\\".+</textarea>$'))&&(n=!0),n},getTextAreaId(){return`simple_editor_textarea_${this.cid}`},getTextArea(){return this.elements.editableContainer||this.getElement(`#${this.getTextAreaId()}`)},resetEditor(){if(this.shouldToolbarFloat()&&this.hideRTEToolbar(),this.ckeditor){try{this.ckeditor.setData(i.Engine.firefox||i.Engine.ie?"<p><br></p>":"")}catch(e){c.error(e)}this.showPlaceholder()}else this.getTextArea()&&this.getTextArea().empty(),this.showPlaceholder();this.dispatchEvent("onResetEditor")},removeTagsInContent(){const e=this.getTextArea();e&&e.getElements(".s6m-tag-link").forEach(e=>{e.remove()}),this.ckeditor&&this.ckeditor.updateElement()},placeCursorAt(t,i){try{let n=t;const o=(this.ckeditor||document).createRange(),s=(this.ckeditor||document).getSelection(),a=i&&i.node||this.getTextArea();let r,l;if(s&&a){const t=CKEDITOR.dom.node;r=this.ckeditor?new t(a):a,e.is(n,"number")?o.setStart(r,n):(n=(l=a.lastElementChild||a).childNodes.length,this.isEmptyRTEContent()&&(n=0),o.setStart(this.ckeditor?new t(l):l,n)),o.collapse(!0),s.removeAllRanges(),this.ckeditor?s.selectRanges([o]):s.addRange(o)}}catch(e){c.log(e)}},onInjected(){const e=this.getElement(".editable-container-wrapper");!this.getControl(`scroller-test${this.cid}`)&&e&&this.addControl(`scroller-test${this.cid}`,new l({element:e})).inject(this.container)},destroy(...e){this.onDocumentBodyClickBound&&document.body.removeEvent("click",this.onDocumentBodyClickBound);const t=this.getTextArea();t&&(g&&g.disableFeature({editableElement:t}),w&&w.disableFeature({editableElement:t})),this.model&&this.model.removeChanges(this.options.modelAttr),this._observer&&this._observer.disconnect(),this._parent(...e)}})}),define("DS/SwymUIComponents/script/feature/community/content/view/simple-editor-with-media-view",["DS/SwymUIComponents/script/feature/community/content/view/simple-editor-view"],e=>{return e.extend({name:"simple-editor-with-media-view",_onPasteInCKEditor(e){this._onPasteInSimpleCKEditor(e);const t=e.data&&e.data.dataTransfer&&e.data.dataTransfer._&&e.data.dataTransfer._.files;let i;const n=[];let o=0,s=!0;const{dataProcessor:a}=e.editor,r=new CKEDITOR.htmlParser.filter({elements:{img(e){if(!e.attributes["data-media-type"]){const t=Math.random().toString(36).substring(7),{attributes:i}=e,o={src:i.src,mediaPastedId:t};i["data-media-pasted-id"]=t,n.push(o)}o+=1},table:function(e){!0===this.getOption("enableEmojis")&&e.remove()}.bind(this)}}),l=a.toHtml(e.data.dataValue,{filter:r,fixForBody:!1});e.data.dataValue=l,n.length>0&&this.dispatchEvent("onMediaPaste",n);for(let e=0,t=n.length;e<t;e+=1)n[e].src.startsWith("data:image")||(s=!1);const c=e.data&&e.data.dataTransfer&&e.data.dataTransfer._&&e.data.dataTransfer._.data&&e.data.dataTransfer._.data["text/html"];c&&c.test(/(class="?Mso|style=["'][^"]*?\bmso-|w:WordDocument|<o:\w+>|<\/font>)/)&&t.length&&t.shift(),0===n.length&&t.length>0&&s&&this.dispatchEvent("onMediaPaste",t),!0===this.getOption("enableEmojis")?(i=this._detectAndWrapEmojis(l),e.data.dataValue=i.newText):e.data.dataValue=l,0===n.length&&0===t.length&&o>0&&!0===this.getOption("isInstantMessageRTE")&&this.dispatchEvent("onSwymImgPaste")},removeMediaIntoTextEditor(e){const t=this.getChildView("textEditorView"),i=(t?t.ckeditor:this.ckeditor).editable().findOne(`img[data-media-pasted-id="${e}"]`);i&&i.remove()},replaceMediaIntoTextEditor(e,t){const i=this.getChildView("textEditorView"),n=i?i.ckeditor:this.ckeditor;this.getImgTagToInsertIntoEditor(t,((e,t)=>{const i=n.editable().findOne(`img[data-media-pasted-id="${e}"]`);let o;i&&((o=i.getParent())&&o.append(new CKEDITOR.dom.element(t)),i.remove())}).bind(this,e))},triggerActionOnMediaIntoTextEditor(e,t){require(["DS/SwymUIComponents/script/utils/media-utils","DS/SwymUICore/script/feature/community/media/model/media-model"],(i,n)=>{const o=this;let s,a;e&&e.length>0&&e.forEach(e=>{e instanceof n?(s=e.get("userFile")||e.getChanges("userFile"),a=s&&s.info&&s.info.mediaPastedId,"remove"===t?o.removeMediaIntoTextEditor(a):"replace"===t&&i.getImageTagFromMedia(e,function(e){o.replaceMediaIntoTextEditor(this,e)}.bind(a))):o.removeMediaIntoTextEditor(e.mediaPastedId)},this)})}})}),define("DS/SwymUIComponents/script/feature/community/media/edit/media-editor-body-view",["UWA/Core","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUIComponents/script/feature/community/content/edit/abstract-content-editor-body-view","DS/SwymUIComponents/script/feature/community/content/view/simple-editor-view","DS/SwymUIComponents/script/feature/community/media/view/edit-file-view","DS/SwymUIComponents/script/feature/community/content/view/properties-editor-view","DS/SwymUIComponents/script/utils/media-utils","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/edit/media-editor-body-view"],function(e,t,i,n,o,s,a,r){"use strict";return i.extend({_modelClass:t,name:"media-edit-view",pictureHasChanged:!1,_modelEvents:{onVirtualChange:"onMediaChange",onPictureHasChanged:"onPictureHasChanged","onSync:read":"refresh"},defaultOptions:{descriptionAttr:"content"},setup:function(){this.addEvent("onPublishing",function(e,t){this.getChildView("mediaEditorView").dispatchEvent("onPublishing",[e,t])}),this._parent.apply(this,arguments)},domEvents:{},_createContent:function(){return this.model&&this.model.get("media_type")?{class:"media-content-edition",html:[this._createMediaEditor()]}:{class:"media-content-edition",tag:"div"}},_createMediaEditor:function(){return[{class:"container-fluid",html:[this._getEditorWrapperContent(),this._getRTEView()]},{class:"row container-fluid",html:[{class:"col-md-6 col-xs-12",html:this._getMediaPropertiesView()},{class:"col-md-6 col-xs-12",html:this._getFileUploadView()}]}]},_getRTEView:function(){var e=this.getChildView("rte");return e||((e=this.addChildView("rte",{Class:n,model:this.model,modelAttr:this.options.descriptionAttr,rtePlaceholder:r.AddADescription,mandatory:!1,useFocusStyle:!0,cssPlaceholder:!0})).switchToRTE(),this.listenTo(e,"onRTEContentChanged",this.onMediaChange.bind(this))),e},_getFileUploadView:function(){var e=this.model,t=this.getChildView("fileUploadView");return!e||t||e.is3DSketchExtension()||e.is3DStoExtension()||e.hasExtensionType("3dwb")||(t=this.addChildView("fileUploadView",{model:e,Class:o,attributes:{class:"editor-border"}})),t},_getMediaPropertiesView:function(){var e=this.getChildView("propertiesEditorView"),t=this.model;return!e&&t&&(e=this.addChildView("propertiesEditorView",{model:t,Class:s,withoutCategory:!0,attributes:{class:"editor-border",styles:{"margin-top":"10px"}}}),this.listenTo(e,"getPlayerStateRequest",this._onGetPlayerStateRequest.bind(this,e))),e},_onGetPlayerStateRequest:function(e){var t=this._getEditorWrapperContent().getState()?this._getEditorWrapperContent().getState():null;e.dispatchEvent("playerStatusInfo",[t])},_getEditorWrapperContent:function(){var e=this.getChildView("mediaEditorView");if(!e){var t;t=a.getMediaViewerModule(this.model,"edit",{mediaExtension:this.model.getFileExtension()}),e=this.addChildView("mediaEditorView",{model:this.model,Class:t,viewMode:"edit"})}return e},isContentEmpty:function(){return!1},getContentAttributes:function(){return{}},resetContent:function(){this.model.removeChanges(),this.pictureHasChanged=!1;var e=this.model?this.model.get(this.options.descriptionAttr):"",t=this._getFileUploadView();e?this._getRTEView().updateEditor(e):this._getRTEView().resetEditor(),this._getMediaPropertiesView().resetPropertiesView(),t&&t.onCancel(),this._getEditorWrapperContent().refresh()},refreshContent:function(e){this.refresh()},onPictureHasChanged:function(){this.pictureHasChanged=!0,this.model.addChanges("pictureHasChanged",!0),this.onMediaChange()},getBlob:function(e){this._getEditorWrapperContent().getBlob(e)},onMediaChange:function(){this.dispatchEvent("onContentChange")},getMediaCollectionLength:function(){},getMediaCollection:function(){},uploadMedia:function(){},addMedia:function(){}})}),define("DS/SwymUIComponents/script/feature/core/search/view/community-selector/dm-selector-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/thread/collection/thread-lite-collection","DS/SwymUICore/script/feature/core/direct-message/collection/direct-message-collection","DS/SwymUIComponents/script/feature/core/search/view/community-selector/community-selector-autocomplete","DS/SwymUIComponents/script/feature/core/search/view/community-selector/conversation-template","DS/SwymUIComponents/script/feature/core/search/view/community-selector/user-template","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","DS/WebappsUtils/Console","i18n!DS/SwymUIComponents/assets/nls/feature/core/search/view/dm-selector-view"],function(e,t,i,n,o,s,a,r,l,c,d){"use strict";var m=50,u=s.extend({loadNextSuggests:function(){}});function h(e){var t=e.getModelName();return{value:e.get("subject6wuri")||e.get("mid"),label:"dm"===t?e.getConsolidatedTitle():e.get("ds6w:label"),modelName:t,is_favorite:e.get("is_favorite"),preview_url:e.get("preview_url",{escapeHTML:!1})||null}}var p="favorite-communities";return t.extend({name:"dm-selector-view",_dmSelectorCollection:null,_selectedItem:null,dmSyncComplete:!1,setup:function(){var t=this;this._parent.apply(this,arguments);var i=void 0===this.getOption("disabled")||this.getOption("disabled");this._dmSelectorCollection=new n([],{mode:"conversation",limit:m}),this.addControl("dmSelector",new u({placeholder:d.SelectAConversation,disabled:i,noResultsMessage:d.NoMatchFound,typeDelayBeforeSearch:400,minLengthBeforeSearch:3,showSuggestsOnFocus:!0,allowFreeInput:!0,datasets:[{name:p,items:[],configuration:{templateEngine:a("favorite")}},{name:"other-communities",items:[],collection:this._dmSelectorCollection,configuration:{templateEngine:function(...e){return"dm"===e[2].modelName?a()(...e):r()(...e)}},remoteSearchEngine:function(t){var i=this,n=new o([],{mode:"findConversation",limit:m});return function(o,s){return new Promise(function(a,r){n.fetch({data:e.merge({query:'([ds6w:type]:"swym:DirectMessage" AND ('+s+") AND (NOT dm_type:private)) OR ((topicConversations:("+s+")) AND (dm_type:private)) OR (personOrGroup:("+s+"))",select_predicate:["ds6w:type","ds6w:label","title","id","resourceid"]},t),reset:!0,onComplete:function(){const e=i.getControl("dmSelector").getDataset(p);let t=n.filter(function(t){let i=null;return i="swym:DirectMessage"===t.get("ds6w:type")?t.get("topic"):t.get("ds6w:label"),0===e.items.filter(e=>e.label===i).length});var s={dataset:o,matchingItems:t.map(h)};a(s)},onFailure:function(e){r(e)}})})}}.call(this)}],events:{onSelect:function(e){t.dispatchEvent("onDMSelectChange",[e])},onUnselect:function(){t.onDMUnselected()}}}))},validate:function(){var e=this.getControl("dmSelector").getValue().length>0;return!1===e?this.container.addClassName("invalid"):this.container.removeClassName("invalid"),e},createConversation:function(e){var t=this,n=new l,o=i.getInstance().get("user").login;n.addChanges({users:[o,e.value]}),n.save({},{onComplete:i=>{t.dispatchEvent("onDMSelectChange",[i.get("mid"),e.label,"dm"]),t.dispatchEvent("onConversationCreated")}})},populateDMCollection:function(e){var t=this;return new Promise(function(i,n){t._dmSelectorCollection.fetch({headers:{"X-DS-SWYM-CSRFTOKEN":e?e.csrfToken:""},onComplete:i,onFailure:n})}).then(function(){t.onDMListSync({showAlert:!0,isCollectionSynced:!0})})},onDMListSync:function(e){var t=[],i=[],n=this.getControl("dmSelector");this._dmSelectorCollection.forEach(function(e){var n=e.get("is_favorite"),o=h(e);n?t.push(o):i.push(o)}),i.length>0||t.length>0?(n&&(n.cleanDataset("other-communities"),n.cleanDataset(p),t.length>0&&n.addItems(t,n.getDataset(p)),i.length>0&&n.addItems(i,n.getDataset("other-communities")),n.enable()),this.container&&this.container.removeClassName("ask-author-rights"),!0===e.isCollectionSynced&&(this.dmSyncComplete=!0,this.dispatchEvent("onDMSyncComplete"))):(this.container.addClassName("ask-author-rights"),this.dispatchEvent("disablePublishRequest"))},isDMSyncComplete:function(){return this.dmSyncComplete},selectDM:function(e){var t,i=this.getControl("dmSelector");if(e)return!(!(t=i.getItem(e))||!t.id)&&(i.onSelect(t),!0)},reset:function(){this.getControl("dmSelector").datasets.filter(function(e){e.items&&e.items.length>0&&(e.items.length=0)})},onDMUnselected:function(){this.dispatchEvent("onDMSelectChange",[])},enable:function(){var e=this.getControl("dmSelector");e&&e.enable()},disable:function(){var e=this.getControl("dmSelector");e&&e.disable()},getDMSelected:function(){var e=this.getControl("dmSelector");return e?e.selectedItems[0]:null},_createContent:function(){return this.getControl("dmSelector")},isEmpty:function(){return this.getControl("dmSelector").isEmpty()},onDestroy:function(){var e=this.getControl("dmSelector");e&&e.destroy()}})}),define("DS/SwymUIComponents/script/feature/core/search/view/thread-picker-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUIComponents/script/feature/core/search/view/community-selector/community-selector-view","DS/SwymUIComponents/script/feature/core/search/view/community-selector/dm-selector-view","DS/SwymUIComponents/script/feature/community/content/view/media-thumbnail-view","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","DS/UIKIT/Toggler","DS/SwymUICore/script/utils/i18n","i18n!DS/SwymUIComponents/assets/nls/feature/core/search/view/thread-picker-view"],function(e,t,i,n,o,s,a,r,l,c,d){"use strict";return t.extend({defaultOptions:{displayConversationTab:!0},domEvents:{"click .edit-content-link":"_onEditContentLinkClick"},name:"thread-picker-view",_communitySelector:null,_conversationSelector:null,_selectedConversation:null,_bootstrapModel:null,_onEditContentLinkClick:function(){this.dispatchEvent("editContentLinkClicked")},setup:function(){const e=this.model.getModelName&&this.model.getModelName();"iquestion"!==e&&"idea"!==e&&"wiki"!==e&&"wikitree"!==e||this.setOption("displayConversationTab",!1),this._bootstrapModel=i.getInstance(),this._initCommunitySelector(),!0===this.getOption("displayConversationTab")&&this._initConversationSelector(),this._parent.apply(this,arguments)},getSelectedThread:function(){return this._communitySelector.isVisible()?this._communitySelector.getSelectedCommunity():this._selectedConversation},isSelectedThreadACommunity:function(){return this._communitySelector.isVisible()&&this._communitySelector.getSelectedCommunity()},_getNavHTML:function(){const t=this.getOption("displayConversationTab"),i=e.createElement("nav",{class:"tab-picker tab",html:[{tag:"a",class:"tab-item "+(t?"":"active"),html:[{tag:"span",class:"fonticon fonticon-users-alt"},d.Communities]},t?{tag:"a",class:"tab-item active",html:[{tag:"span",class:"fonticon fonticon-chat"},d.Conversations]}:""]});return this.addControl("tab-bar",new l({container:i,events:{onToggle:function(e,t){this._setTab(t)}.bind(this)}})),i},_setTab:function(e){1===e?(this._conversationSelector.show(),this.getControl("tab-bar")&&(this._conversationSelector.isEmpty()?this.dispatchEvent("enableForward",!1):this.dispatchEvent("enableForward",!0)),this._communitySelector.hide()):0===e&&(this._conversationSelector.hide(),this._communitySelector.show(),this.getControl("tab-bar")&&(this._communitySelector.isEmpty()?this.dispatchEvent("enableForward",!1):this.dispatchEvent("enableForward",!0)))},_initCommunitySelector:function(){this._communitySelector=this.addChildView("communitySelector",{Class:n,disabled:!1,modelParam:this.model.getModelName?this.model.getModelName():null}),this._communitySelector.addEvent("onCommunitySelectChange",function(e){e?(this.dispatchEvent("enableForward",!0),this._checkPermission(e)):(this._warningMessageTarget&&this._warningMessageTarget.empty(),this.dispatchEvent("enableForward",!1))}.bind(this)),this._communitySelector.populateCommunityCollection({communityId:null})},_checkPermission:function(e){const t=this;this._containsEmbeddedMedia()&&e&&"wikitree"!==this.model.getModelName()&&(this.dispatchEvent("enableForward",!1),this.model.forwardPermissions({data:{threadUri:e},onComplete:function(e){t._displayWarningOnMedia(e)}}))},_displayWarningOnMedia:function(t){const i=this.container.getElement(".target-warning-media");let n=[];if((t.get("media")||[]).forEach(function(e){!1===e.read&&n.push(new s({model:new a({mid:e.uri}),imageRenderingOptions:{size:"s"}}))}),n.length>0){const o=e.createElement("div",{class:"warning-media",html:[{class:"header-warning-message",html:[{class:"fonticon fonticon-attention",tag:"span"},{class:"label-warning-message",html:[d.userHasNoRightsOnThisMessage,c.replace(d.youCanEditTheContent,{spanOpen:'<a class="edit-content-link" data-content-id="'+t.get("mid")+'" data-content-type="'+t.getModelName()+'" data-edition-mode="true">',spanClose:"</a>"})]}]},{class:"copied-media",html:n}]});i.empty(),o.inject(i),n.forEach(t=>{e.createElement("div",{class:"red-line"}).inject(t.container)})}else i.empty();this.dispatchEvent("enableForward",!0)},_initConversationSelector:function(){var e=this;this._conversationSelector=this.addChildView("conversationSelector",{Class:o,disabled:!1}),this._conversationSelector.addEvent("onDMSelectChange",function(t){e._warningMessageTarget&&e._warningMessageTarget.empty(),t&&("dm"===t.modelName?e._getUriFromConversationSelected(t.value):e._createADMIfNecessary(t)),this.dispatchEvent("enableForward",!1)}),this._conversationSelector.populateDMCollection({csrfToken:this._bootstrapModel.getCSRFToken()})},_getUriFromConversationSelected:function(e){var t=this;this.dispatchEvent("enableForward",!1),new r({mode:"read",id:e}).fetch({onComplete:function(e){t._selectedConversation=e.get("subject6wuri"),t._checkPermission(t._selectedConversation),t.dispatchEvent("enableForward",!0)}})},_createADMIfNecessary:function(e){const t=new r,i=this._bootstrapModel.get("user").login;this.dispatchEvent("enableForward",!1),t.addChanges({users:[i,e.value]}),t.save({},{onComplete:function(e){this._selectedConversation=e.get("subject6wuri"),this._checkPermission(this._selectedConversation),this.dispatchEvent("enableForward",!0)}.bind(this),onFailure:function(e,t){t&&t.result&&t.result.uri&&(this._selectedConversation=t.result.uri,this._checkPermission(this._selectedConversation),this.dispatchEvent("enableForward",!0))}.bind(this)})},_containsEmbeddedMedia:function(){return this.model&&(this.model.hasEmbeddedMedia&&this.model.hasEmbeddedMedia()||this.model.is3DStoExtension&&this.model.is3DStoExtension())},_createContent:function(){const t=this.getOption("displayConversationTab");return this._warningMessageTarget=e.createElement("div",{class:"target-warning-media"}),t&&this._communitySelector.hide(),[t?this._getNavHTML():"",t?this._conversationSelector:"",this._communitySelector,this._warningMessageTarget]}})}),define("DS/SwymUIComponents/script/feature/community/content/forward-modal",["UWA/Core","UWA/String","DS/SwymUIComponents/script/feature/core/modal/modal","DS/UIKIT/Alert","DS/UIKIT/Input/Button","DS/UIKIT/Input/ButtonGroup","DS/SwymUIComponents/script/feature/core/search/view/thread-picker-view","DS/SwymUIComponents/script/feature/community/wiki/view/vuetify/vuetify-wiki-treeview","DS/SwymUICore/script/utils/usage-tracker","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/utils/utils","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/view/abstract-content-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/wiki/edit/wiki-creator-view"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p){"use strict";const g=Object.freeze({WIKI_SINGLE_PAGE:"wikiSinglePage",WIKI_MULTI_PAGE:"wikiMultiPage",INSTANT_MESSAGE:"instantMessage",DEFAULT:"default"});return i.extend({_mode:null,_currentModel:null,_threadPickerView:null,_communitySelector:null,_conversationSelector:null,_wikiTreeView:null,_wikiTreeSelectable:null,_forwardButton:null,_forwardAndDisplayButton:null,_forwardButtonGroup:null,_cancelButton:null,_nextButton:null,_backButton:null,_destinationWikiPageSubject6wuri:null,_infoMessageWiki:null,_isSinglePageSelection:!1,_isMultiPageSelection:!1,_forwardMessageElement:null,_forwardMessageWikiElement:null,_forwardAlertPrivatePageElement:null,_wikiHeaderElement:null,_forwardWikiTreeElement:null,_forwardAsync:null,init:function(e){e.className=window.ds&&"3DD"===window.ds.env?"forward-modal in3DD":"forward-modal",e.closable=!0,this._parent(e),this._currentModel=e.model,this._mode="wikitree"===this._currentModel.getModelName()?g.WIKI_MULTI_PAGE:"instant-message"===this._currentModel.getModelName()?g.INSTANT_MESSAGE:"wiki"===this._currentModel.getModelName()?g.WIKI_SINGLE_PAGE:g.DEFAULT,this._forwardAsync=this._mode===g.WIKI_MULTI_PAGE,this._setHeaderWithNumberPage("1/2"),this._initThreadPickerView(),this._mode===g.WIKI_MULTI_PAGE&&this._initWikiTreeSelectable();const t=this._createBody();this.setBody(t),this._mode!==g.WIKI_MULTI_PAGE&&this._mode!==g.WIKI_SINGLE_PAGE||this._getElementsOfWikiTree(),this._setButtons(),this._createFooter()},_setHeaderWithNumberPage:function(t){this.setHeader(e.createElement("div",{class:"forward-header",html:[{class:"forward-title",html:h.ForwardContent},this._mode===g.WIKI_MULTI_PAGE?e.createElement("div",{class:"forward-number-page",html:t}):""]}))},_createBody:function(){const e=!(this._mode!==g.WIKI_SINGLE_PAGE||!this._currentModel.get("visibility")||1===parseInt(this._currentModel.get("visibility")));return[this._mode===g.WIKI_MULTI_PAGE||e?{class:"forward-private-wiki-page-info",html:this._toggleAlertPrivatePageWiki(e)}:"",{class:"forward-message-info",html:this._initInfoMessageForward()},this._threadPickerView,this._mode===g.WIKI_MULTI_PAGE||this._mode===g.WIKI_SINGLE_PAGE?{class:"forward-wiki-tree",html:[this._getInfoMessageForwardWiki(),this._getHeaderWikiTree(),this._mode===g.WIKI_MULTI_PAGE?this._wikiTreeSelectable.$el:""]}:""]},_getElementsOfWikiTree:function(){this._forwardAlertPrivatePageElement=this.getBody().getElement(".forward-private-wiki-page-info"),this._forwardMessageElement=this.getBody().getElement(".forward-message-info"),this._forwardMessageWikiElement=this.getBody().getElement(".forward-wiki-message-info"),this._forwardWikiTreeElement=this.getBody().getElement(".forward-wiki-tree"),this._wikiHeaderElement=this.getBody().getElement(".heading")},_initThreadPickerView:function(){this._threadPickerView=new a({model:this._currentModel}),this._communitySelector=this._threadPickerView.getChildView("communitySelector"),this._conversationSelector=this._threadPickerView.getChildView("conversationSelector"),this._communitySelector.addEvent("onCommunitySelectChange",this._onCommunitySelectChange.bind(this)),this._threadPickerView.addEvent("enableForward",this._enableForwardButtons.bind(this)),this._threadPickerView.addEvent("editContentLinkClicked",this._editContentLinkClicked.bind(this)),this._mode===g.WIKI_MULTI_PAGE&&this._threadPickerView.hide()},_onCommunitySelectChange:function(e){this._mode!==g.WIKI_MULTI_PAGE&&this._mode!==g.WIKI_SINGLE_PAGE||(e?(this._forwardWikiTreeElement.mask(),this._forwardMessageWikiElement.show(),this._wikiHeaderElement.show(),this._addWikiTreeView(e)):(this._wikiTreeView&&this._wikiTreeView.destroy(),this._forwardMessageWikiElement.hide(),this._wikiHeaderElement.hide(),this._enableForwardButtons(!1)))},_addWikiTreeView:function(e){const t=this;require(["DS/SwymUIComponents/script/feature/community/wiki/view/wikitree-view","DS/SwymUICore/script/feature/community/wiki/model/wikitree-model"],function(i,n){const o=new n({community_id:e});o.fetch({fromCache:!1,onComplete:()=>{t._wikiTreeView=new i({addVerticalScroller:!0,model:o,disableNavigationOnNodeSelection:!0,disablePrivatePage:!0}),t._wikiTreeView.inject(t._forwardWikiTreeElement),t._forwardWikiTreeElement.unmask(),t._wikiTreeView.addEvent("currentPageChange",function(e){t._destinationWikiPageSubject6wuri=e.subject6wuri,t._enableForwardButtons(!0)})}})})},_initWikiTreeSelectable:function(){this._isMultiPageSelection=!0,this._wikiTreeSelectable=new r({propsData:{treeModel:this._currentModel.get("tree"),isVisible:!0,activatable:!0,multipleActive:!0}}),this._wikiTreeSelectable.$mount(),this._wikiTreeSelectable.$on("onSelectionChange",(e,t)=>{let i=!1;if(e){this._currentModel.get("tree").forEach(e=>{t.includes(e.subject6wuri)&&1!==e.visibility&&(i=!0)})}this._toggleAlertPrivatePageWiki(i),this._nextButton.setDisabled(!e)})},_toggleAlertPrivatePageWiki:function(t){const i=new e.createElement("div",{class:"header-forward-private-wiki-page-info",html:[{class:"fonticon fonticon-user-key"},{class:"label-private-page-info",html:this._mode===g.WIKI_MULTI_PAGE&&t?h.AlertPrivatePageSelected:h.AlertPrivatePageForwarded}]});if(!this._forwardAlertPrivatePageElement&&t)return i;this._forwardAlertPrivatePageElement&&!t?this._forwardAlertPrivatePageElement.empty():this._forwardAlertPrivatePageElement&&0===this._forwardAlertPrivatePageElement.getChildren().length&&t&&i.inject(this._forwardAlertPrivatePageElement)},_initInfoMessageForward:function(){const e=this._threadPickerView.getOption("displayConversationTab");return this._mode===g.WIKI_MULTI_PAGE&&this._isMultiPageSelection?h.SelectThePagesToForward:e?h.InfoMessageAboutForwardFeatureWithConversation:h.InfoMessageAboutForwardFeatureInCommunity},_updateInfoMessageForward:function(){let e;return this._isSinglePageSelection?e=h.InfoMessageAboutForwardFeatureInCommunity:this._isMultiPageSelection&&(e=h.SelectThePagesToForward),e},_getHeaderWikiTree:function(){const t=e.createElement("div",{class:"heading",html:[{class:"wikitree-header",html:[{tag:"span",class:"fonticon fonticon-tree-view-flattened"},{tag:"span",html:p.Wikitree}]}]});return this._mode!==g.WIKI_MULTI_PAGE&&t.hide(),t},_getInfoMessageForwardWiki(){const t=e.createElement("div",{class:"forward-wiki-message-info",html:h.SelectDestinationPage});return(this._mode===g.WIKI_SINGLE_PAGE||this._mode===g.WIKI_MULTI_PAGE&&this._isMultiPageSelection)&&t.hide(),t},_setButtons:function(){this._forwardButton=new o({value:h.Forward,className:"primary",events:{onClick:()=>{this._forwardButton.load(),this._disableFooter(),this._forwardContent().then(()=>{this.onHide()})}}}),this._mode!==g.WIKI_MULTI_PAGE?(this._forwardAndDisplayButton=new o({className:"primary",dropdown:{items:[{text:h.ForwardAndDisplay}]},events:{onDropdownShow:function(){this._forwardAndDisplayButton.dropdown.getBody().setStyle("z-index",1040)}.bind(this),onDropdownClick:function(){this._forwardAndDisplayContent()}.bind(this)}}),this._forwardButtonGroup=new s({buttons:[this._forwardButton,this._forwardAndDisplayButton]})):(this._nextButton=new o({value:h.Next,className:"primary",events:{onClick:()=>{this._isMultiPageSelection=!this._isMultiPageSelection,this._isSinglePageSelection=!0,this._setHeaderWithNumberPage("2/2"),this._forwardAlertPrivatePageElement.hide(),this._forwardMessageElement.setText(this._updateInfoMessageForward()),this._threadPickerView.show(),this._wikiTreeView&&!this._wikiTreeView.isVisible()?(this._wikiHeaderElement.show(),this._wikiTreeView.show(),this._forwardMessageWikiElement.show()):(this._wikiHeaderElement.hide(),this._forwardMessageWikiElement.hide()),this._wikiTreeSelectable.isVisible=!1,this.setFooter([this._forwardButton,this._backButton,this._cancelButton])}}}),this._backButton=new o({value:h.Back,events:{onClick:()=>{this._isSinglePageSelection=!this._isSinglePageSelection,this._isMultiPageSelection=!0,this._setHeaderWithNumberPage("1/2"),this._forwardMessageElement.textContent=this._updateInfoMessageForward(),this._wikiTreeSelectable.isVisible=!0,this._forwardAlertPrivatePageElement.show(),this._wikiHeaderElement.show(),this._forwardMessageWikiElement.hide(),this._threadPickerView.hide(),this._wikiTreeView&&this._wikiTreeView.isVisible()&&this._wikiTreeView.hide(),this.setFooter([this._nextButton,this._cancelButton])}}}),this._nextButton.setDisabled(!0),this._backButton.setDisabled(!1)),this._cancelButton=new o({value:h.Cancel,key:"esc",events:{onClick:()=>{this.onHide()}}}),this._enableForwardButtons(!1)},_createFooter:function(){this._mode===g.WIKI_MULTI_PAGE?this.setFooter([this._nextButton,this._cancelButton]):this.setFooter([this._forwardButtonGroup,this._cancelButton])},_disableFooter:function(){this._enableForwardButtons(!1),this._cancelButton.disable(),this._isSinglePageSelection?this._nextButton.disable():this._isMultiPageSelection&&this._backButton.disable()},_enableForwardButtons:function(e){this._forwardButton.setDisabled(!e),this._forwardAsync||this._forwardButtonGroup.setDisabled(!e)},_forwardAndDisplayContent:function(){this._disableFooter(),this._forwardContent().then(e=>{if(this.onHide(),this._mode===g.INSTANT_MESSAGE)this._navigateToTimelineView();else{const t=new c(e._community),i=m.getInstance(),n=(e.id,this._currentModel.getContentType(),t.get("community_type"),i.getRoute({contentId:e.id,contentType:this._currentModel.getContentType(),communityId:t.get("mid"),editionMode:!1}));window.open(`${u.getBaseUrl()}/#${n}`,"_blank")}})},_forwardContent:function(){return new Promise((e,t)=>{this.getBody().mask();const i=this._threadPickerView.getSelectedThread();this._currentModel.forwardToThread({set:!1,data:{threadUri:i,...(this._mode===g.WIKI_MULTI_PAGE||this._mode===g.WIKI_SINGLE_PAGE)&&{target:this._destinationWikiPageSubject6wuri},...this._mode===g.WIKI_MULTI_PAGE&&{sourceList:this._wikiTreeSelectable.getActiveSelection()}},onComplete:(t,i)=>{const n=this._getResultSuccessForward(t,i);e(n)},onFailure:()=>{this._onFailureForward(),t()}})})},_getResultSuccessForward:function(e,i){l.trackPageEvent({category:"ContentContextualActionMenu",label:"forwardContent",view:"action-menu-view",event:"click",contentType:e.getModelName()});let o=this._forwardAsync?h.ForwardMultiplePageWikiSuccess:h.YourContentHasBeenForwarded;return new n({closable:!0,visible:!0,autoHide:!0,maximumVisibleMessages:1,hideDelay:this._forwardAsync?5e3:2e3,className:"wp-alert"}).inject(document.body,"top").add({className:"success",message:UWA.is(o,"string")?t.escapeHTML(o):o}),!(!this._forwardAsync&&this._mode!==g.INSTANT_MESSAGE)||i.result},_onFailureForward:function(){l.trackPageEvent({category:"ContentContextualActionMenu",label:"forwardFailed",view:"action-menu-view",event:"click",contentType:this._currentModel.getModelName()}),this._cancelButton.enable(),require(["DS/UWPClientControls/PlatformNotify"],e=>{e.error(h.ForwardFailure)})},_editContentLinkClicked:function(){const e=this._currentModel.getCommunity(),t={communityModel:e,contentId:this._currentModel.get("mid"),contentType:this._currentModel.getContentType(),communityId:e.get("mid"),dmId:e.get("community_type"),editMode:!0};this._navigateToContent(t)},_navigateToContent:function(e){if(window.ds&&"3DD"===window.ds.env)d.goToContent(e.contentId,e.contentType,e.communityModel.get("mid"),e.editMode,void 0,void 0,e&&"dm"===e.dmId);else{m.getInstance().reset({contentId:e.contentId,contentType:e.contentType,communityId:e.communityModel.get("mid"),dmId:e&&"dm"===e.dmId||void 0,editionMode:e.editMode})}},_navigateToTimelineView:function(){require(["DS/SwymUICore/script/constants/community-constants"],function(e){const t=this._threadPickerView.getSelectedThread();d.goToCommunity(t,void 0,void 0,!this._threadPickerView.isSelectedThreadACommunity(),{feedMode:e.CTY_CONTENT_LIST_MODE.TIMELINE_MODE})}.bind(this))},onHide:function(){this.destroy(),this._wikiTreeSelectable&&this._wikiTreeSelectable.$destroy()}})}),define("DS/SwymUIComponents/script/utils/feature-preferences-manager",["require","exports","DS/SwymUIComponents/script/utils/feature-preferences","DS/Logger/Logger"],function(e,t,i,n){"use strict";return{customAppPreferences:null,setCustomAppPreferences:function(e){this.customAppPreferences&&n.log("Swym app custom preferences is about to be overrided! Make sure you know what you are doing."),this.customAppPreferences=e},checkFeaturePreference:function(e){return i&&i.includes(e)&&this.customAppPreferences&&"function"==typeof this.customAppPreferences[e]?this.customAppPreferences[e]():null}}}),define("DS/SwymUIComponents/script/utils/feature-activation-manager",["require","exports","DS/UWPClientCode/PublicAPI","DS/PlatformAPI/PlatformAPI","DS/OfficeDocumentEditorClient/Editor","DS/SwymUICore/script/utils/feature-activation-constants","DS/Logger/Logger","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUIComponents/script/utils/feature-preferences-manager","DS/SwymUICore/script/utils/localstorage-manager"],function(e,t,i,n,o,s,a,r,l,c){"use strict";return{initFeaturesActivated:function(e){window.ds&&"3DD"===window.ds.env?window.top.require(["DS/UWPClientCode/PublicAPI"],function(t){this._setFeaturesActivated(t,e)}.bind(this)):this._setFeaturesActivated(i,e)},isUsersGroupFeatureAvailable:function(e){window.require(["DS/SwymUICore/script/utils/compass-proxy","DS/SwymUICore/script/feature/core/config/bootstrap-model"],function(t,i){t.getServiceUrl({serviceName:"usersgroup",platformId:i.getInstance().get("config").tenant.online_instance_id,onComplete:function(t){e("string"==typeof t&&""!==t)},onFailure:function(){e(!1)}})})},_setFeaturesActivated:function(e,t){for(var i,n=Object.keys(s.FEATURES_ACTIVATED),o=0,a=n.length;o<a;o++)i=n[o],void 0!==e.getApplicationConfiguration("app.swymfeature.".concat(i))?s.FEATURES_ACTIVATED[i]="enabled"===e.getApplicationConfiguration("app.swymfeature.".concat(i)):s.FEATURES_ACTIVATED[i]=s.FEATURES_ACTIVATED[i];this.isUsersGroupFeatureAvailable(function(e){s.FEATURES_ACTIVATED.activateUsersGroup=e}),this.checkBetaFeatureAvailableForCurrentUser("rdv"),this.checkBetaFeatureAvailableForCurrentUser("rdvInConversation"),this.checkBetaFeatureAvailableForCurrentUser("ritual"),this.checkBetaFeatureAvailableForCurrentUser("wbcollab"),this.checkBetaFeatureAvailableForCurrentUser("phoneCall"),this.checkBetaFeatureAvailableForCurrentUser("forwardWiki"),this.isMemberOfSuggestionGroup().then(function(e){s.FEATURES_ACTIVATED.activateSuggestions=e}),this.isODEServiceAvailable().then(function(e){var t=l.checkFeaturePreference("allowODEViewerFeature");"boolean"==typeof t?(s.FEATURES_ACTIVATED.activateODEViewer=t,!0===t&&this.checkBetaFeatureAvailableForCurrentUser("odecollab")):e?(s.FEATURES_ACTIVATED.activateODEViewer=e,this.checkBetaFeatureAvailableForCurrentUser("odecollab")):(s.FEATURES_ACTIVATED.activateODEViewer=e,s.ACTIVATED_BETA_FEATURES.odecollab.isActivated=e)}.bind(this)),this.isODEServiceGranted().then(function(e){var t=l.checkFeaturePreference("allowODECreationFeature");s.FEATURES_ACTIVATED.activateODEEditor="boolean"==typeof t?t:e}),this.checkBetaFeatureAvailableForCurrentUser("workforce"),this.is3DPlanServiceAvailable().then(function(e){s.FEATURES_ACTIVATED.activateWedo=e}),t&&t()},isFeatureActivated:function(e){return s.FEATURES_ACTIVATED[e]},isBetaFeatureActivated:function(e){return s.ACTIVATED_BETA_FEATURES[e].isActivated},isBetaFeatureActivatedForPhoneCall:function(){var e=c.getItem(s.PHONE_CALL_GROUP_BETA_NAME);return this.isBetaFeatureActivated("phoneCall")||e},checkBetaFeatureAvailableForCurrentUser:function(t){var i=s.ACTIVATED_BETA_FEATURES[t].uwpAdminActivationVariableName,o=String(n.getApplicationConfiguration("app.swymfeature.".concat(i)));"undefined"!==o&&("false"===o||s.ACTIVATED_BETA_FEATURES[t].isCloudOnly&&!this.isCloud()?s.ACTIVATED_BETA_FEATURES[t].isActivated=!1:"true"===o?s.ACTIVATED_BETA_FEATURES[t].isActivated=!0:e(["DS/SwymUICore/script/feature/core/user/model/currentuser-model"],function(e){e.getInstanceFetched(function(e){var i="".concat(e.get("first_name")," ").concat(e.get("last_name"));e.isMember(i,o).then(function(e){s.ACTIVATED_BETA_FEATURES[t].isActivated=e})})}))},isSuggestionsActivatedByURL:function(e){var t=new URL(e);return Boolean(JSON.parse(t.searchParams.get("showsuggestions")))},isPhoneCallAvailableForCurrentUser:function(){return new Promise(function(t){e(["DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/utils/localstorage-manager"],function(e,i){e.getInstanceFetched(function(e){var n="".concat(e.get("first_name")," ").concat(e.get("last_name"));e.isMember(n,s.PHONE_CALL_GROUP_BETA_NAME).then(function(e){var n=i.getItem(s.PHONE_CALL_GROUP_BETA_NAME);t(e||n)})})})})},isMemberOfSuggestionGroup:function(){return new Promise(function(t){e(["DS/SwymUICore/script/feature/core/user/model/currentuser-model"],function(e){e.getInstanceFetched(function(e){var i="".concat(e.get("first_name")," ").concat(e.get("last_name"));e.isMember(i,s.SUGGESTIONS_GROUP_BETA_NAME).then(function(e){t(e)})})})})},isODEServiceAvailable:function(){return new Promise(function(t){e(["DS/OfficeDocumentEditorClient/Utils","DS/SwymUICore/script/feature/core/config/bootstrap-model"],function(e,i){var n=i.getInstance().get("config").tenant.online_instance_id;e&&e.getOfficeDocumentEditorServiceUrl?e.getOfficeDocumentEditorServiceUrl(n).then(function(){t(!0)}):t(!1)})})},is3DPlanServiceAvailable:function(){var t=this;return new Promise(function(i){t.isCloud()?e(["DS/SwymUICore/script/utils/compass-proxy","DS/SwymUICore/script/feature/core/config/bootstrap-model"],function(e,t){e.getServiceUrl({serviceName:"3dplan",platformId:t.getInstance().get("config").tenant.online_instance_id,onComplete:function(e){i(!!e)},onFailure:function(e){a.log("Cannot detect 3DPlan service presence",e),i(!1)}})}):(a.error("Cannot detect 3DPlan service presence"),i(!1))})},is3DOrganizationServiceAvailable:function(){return new Promise(function(t){e(["DS/SwymUICore/script/utils/compass-proxy","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/ENXWFLoader/ENXWFLoader"],function(i,n,o){i.getServiceUrl({serviceName:"3dorganization",platformId:n.getInstance().get("config").tenant.online_instance_id,onComplete:function(i){i?e(["DS/ENXWFLoader/core/ENXWFCommonUILoader"],function(e){e.checkAndEnableWorkForce({platformId:n.getInstance().get("config").tenant.online_instance_id}).then(function(e){t({is3DWFEnabled:!0,orgUrl:i,ENXLoaderModules:e})},function(){a.log("Cannot detect 3DOrganization service presence"),t({is3DWFEnabled:!1,orgUrl:null})})}):(a.log("Cannot detect 3DOrganization service presence"),t({is3DWFEnabled:!1,orgUrl:null}))},onFailure:function(e){a.log("Cannot detect 3DOrganization service presence",e),t({is3DWFEnabled:!1,orgUrl:null})}})})})},isCloud:function(){var e=n.getAllApplicationConfigurations();return e&&e.length>0&&"true"===e.filter(function(e){return"app.build.isCloud"===e.propertyKey})[0].propertyValue},areCommunityTagsAvailable:function(){return this.isCloud()},isODEServiceGranted:function(){var e=this;return new Promise(function(t){return e.isODEServiceAvailable().then(function(e){e?o.isGranted({platformId:r.getInstance().get("config").tenant.online_instance_id}).then(function(){t(!0)}).catch(function(e){e===o.ERROR.NOT_GRANTED&&(console.log("ODE is not granted for this tenant"),t(!1))}):t(!1)})})}}}),define("DS/SwymUIComponents/script/feature/community/media/view/document-viewer",["DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/utils/content-process","DS/SwymUIComponents/script/utils/feature-activation-manager"],function(e,t,i,n){"use strict";return t.extend({_modelEventsForAutoRefresh:["onSync:read","onChange:content"],_modelEvents:window.ds&&"3DD"===window.ds.env?{onNewMediaUploaded:"refresh"}:{},name:"document-viewer",init:function(e){return e.annotationsEventBus&&(this.annotationsEventBus=e.annotationsEventBus),e.editorStateEventBus&&(this.editorStateEventBus=e.editorStateEventBus),this._parent.apply(this,arguments)},_isPDFModel:function(){return this.model.isPDFExtension()},_getDocumentViewerPath:function(){var e="DS/SwymUIComponents/script/feature/community/media/view/";return this._isPDFModel()?e+"document-pdf-viewer":this.model.isDocumentOfficeExtension()&&n.isFeatureActivated("activateODEViewer")?e+"document-office-viewer":e+"document-default-viewer"},_createContent:function(){var e=this,t=this._getDocumentViewerPath();return this.addChildView("document-viewer",{Class:t,model:this.model,viewMode:this.getOption("viewMode"),height:this.container.parentElement.offsetWidth,events:{onInit:function(){e.listenTo(this,"mediaViewReady",function(){this.dispatchEvent("mediaViewReady",this),this.container.setStyle("display",this._displayPropertyBeforeHide),this._hidden=!1})}},annotationsEventBus:this.annotationsEventBus,editorStateEventBus:this.editorStateEventBus,instantiatedInSummaryView:this.instantiatedInSummaryView})},setup:function(e){this._parent.apply(this,arguments),this.addEventOnce("onRender",function(){i.contentPostProcess(this),this._isPDFModel||this.dispatchEvent("mediaViewReady",this)}),this.addEvent("onPublishing",function(e,t){this.getChildView("document-viewer").dispatchEvent("onPublishing",[e,t])}),this.addEvent("ShareTo3DSwYm",function(){this.getChildView("document-viewer").dispatchEvent("ShareTo3DSwYm")}),this.addEvent("Share3DComment",function(){this.getChildView("document-viewer").dispatchEvent("Share3DComment")}),this.instantiatedInSummaryView=e.instantiatedInSummaryView},onSetModel:function(){this._downloadUrl=e.getBaseUrl()+"/api/media/streammedia/id/"+this.model.get("mid")+"/type/original/output/download/"}})}),define("DS/SwymUIComponents/script/feature/core/user/view/user-completion-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/user-completion-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/user/model/user-model","DS/UIKIT/Input/Button","DS/SwymUIComponents/script/feature/core/user/view/edit-all-bar/edit-all-bar","DS/WebappsUtils/Console","DS/PubSub/PubSub","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/platform-utils","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUIComponents/script/utils/feature-activation-manager"],function(e,t,i,n,o,s,a,r,l,c,d,m,u){"use strict";return i.extend({_workforceIntegrationEnabled:null,_is3DOrganizationServiceAvailable:null,_3DOrganizationServiceUrl:null,_currentTab:null,_modelClass:n,name:"user-completion-view",className:"",_ontologySkillsPercentage:0,_ontologyLanguagesPercentage:0,_profileCompletionPercentage:0,_legacySkillsPercentage:0,_legacyLanguagesPercentage:0,calculateSkillPercentage:function(e){return 10*(e>=3?3:e)},calculateLanguagePercentage:function(e){return 5*(e>=2?2:e)},setup:function(t){var i=this,n=m.getInstance();return ds&&"3DSwym"===ds.env&&n.path.startsWith("people")?(this._currentTab=n.path.split("/")[1],this._currentTab="activities"==this._currentTab?0:1):this._currentTab=t.widget.data.facet,t=t||{},e.extend(this,t),this._workforceIntegrationEnabled=!0,u.is3DOrganizationServiceAvailable().then(function(e){c.getPassportURLPromise().then(t=>{if(i._3DOrganizationServiceUrl=e.orgUrl,e.is3DWFEnabled){i._is3DOrganizationServiceAvailable=!0,i._workforceIntegrationEnabled=!0;var n=l.getInstance().get("config").tenant.online_instance_id,o={"3DOrganization":i._3DOrganizationServiceUrl,"3DSwym":d.getBaseUrl(),"3DPassport":t};i._is3DOrganizationServiceAvailable&&0==i._currentTab&&(i.model.setCustomProperty("computedProfileCompletion",i.model.get("profile_completion")),e.ENXLoaderModules.getWFIDataProxy(function(e){new e({serviceUrls:o,platformId:n,userLogin:i.model.get("ds6w:resourceUid"),onSkillsLoaded:function(e){console.log("skill, onSkillsLoaded",e);let t=i.model.get("skills").length;i._legacySkillsPercentage=i.calculateSkillPercentage(t),i._ontologySkillsPercentage=i.calculateSkillPercentage(e.nbSkills),console.info("points added to completion:",i._ontologySkillsPercentage);let n=i.model.getCustomProperty("computedProfileCompletion")-i._legacySkillsPercentage;i._profileCompletionPercentage=parseInt(n)+parseInt(i._ontologySkillsPercentage),i.model.dispatchEvent("usercompletionUpdate",i._profileCompletionPercentage),i.model.setCustomProperty("nbSkills",e.nbSkills)},onLanguagesLoaded:function(e){console.log("Language, onLanguagesLoaded",e);let t=i.model.get("languages").length;i._legacyLanguagesPercentage=i.calculateLanguagePercentage(t),i._ontologyLanguagesPercentage=i.calculateLanguagePercentage(e.nbLanguages),console.info("points added to completion:",i._ontologyLanguagesPercentage);let n=i.model.getCustomProperty("computedProfileCompletion")-i._legacyLanguagesPercentage;i._profileCompletionPercentage=parseInt(n)+parseInt(i._ontologyLanguagesPercentage),i.model.dispatchEvent("usercompletionUpdate",i._profileCompletionPercentage),i.model.setCustomProperty("nbLanguages",e.nbLanguages)}})}))}else i._readyToRender=!0,i._is3DOrganizationServiceAvailable=!1,i._workforceIntegrationEnabled=!1,i.refresh()})}),r.add("editAll",function(e){!1===e&&this.getControl("edit-all-button")&&this.getControl("edit-all-button").show()}.bind(this)),this._addListenerToModel(),this._parent.apply(this,arguments)},_addListenerToModel:function(){this.model.addEvent("usercompletionUpdate",function(e){this.model&&this.model.setCustomProperty("computedProfileCompletion",e),this.refresh&&this.refresh()}.bind(this))},_createContent:function(){var e=void 0===this.model.getCustomProperty("computedProfileCompletion")?this.model.get("profile_completion"):this.model.getCustomProperty("computedProfileCompletion");return[this._buildFillProfilPercent(e),this._buildInfoOnCompletion(),this._buildButtonEditAll()]},toggleInfoOnCompletion:function(){var e=this.getElement(".profile-completion-info");e&&e.toggleClassName("hidden")},_buildInfoOnCompletion:function(){return'<div class="profile-completion-info hidden">'+(this._workforceIntegrationEnabled?t.CompletionDetailBodyWithWorkforce:t.CompletionDetailBody)+"</div>"},_buildButtonEditAll:function(){if(!this._workforceIntegrationEnabled)return this.addControl("edit-all-button",new o({value:t.editAll,className:"edit-all-button default",icon:"pencil",events:{onClick:function(e){s.show()}.bind(this)}}))},_buildFillProfilPercent:function(e){for(var t=Math.ceil(e/5),i="",n=20-t,o="",s="",a=-1;++a<t;)t>18&&(a===t-2||a===t-1)?a===t-2?i=i+='<span style="word-wrap: normal; text-align : right; width : 9%;" class="profile-completion-elm"> <b> '+e+"%</b></span>":a===t-1&&(19===a&&(o="border-bottom-right-radius: 5px; border-top-right-radius: 5px;",s="last-element"),i=i+='<span style="word-wrap: normal; '+o+' width : 3%;" class="profile-completion-elm '+s+' "> &nbsp;</span>'):i+="<span "+(0===a?'style="border-bottom-left-radius: 5px; border-top-left-radius: 5px; width : 3%;"':"")+' class="profile-completion-elm"> &nbsp;</span>';for(a=-1;++a<n;)i+=a===n-1?'<span style="border-bottom-right-radius: 5px; border-top-right-radius: 5px; width: 3%;" class="last-element profile-completion-elm-empty"> &nbsp;</span>':a===n-2?'<span style="word-wrap: normal; width : 9%;" class="profile-completion-elm-empty"> <b> '+e+"%</b></span>":'<span class="profile-completion-elm-empty"> &nbsp;</span>';return i}})}),define("DS/SwymUIComponents/script/feature/core/user/view/macro/user-aboutme-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-view","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/macro/user-aboutme-view","DS/UWPClientCode/I18n","DS/Logger/Logger","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/compass-proxy","DS/SwymUICore/script/utils/platform-utils","DS/SwymUICore/script/utils/utils","DS/SwymUIComponents/script/utils/feature-activation-manager"],function(e,t,i,n,o,s,a,r,l,c){"use strict";return t.extend({_is3DOrganizationServiceAvailable:null,_3DOrganizationServiceUrl:null,_readyToRender:null,_userProfileCompletionWithoutSkills:null,_3dwfDataLoaded:null,name:"useraboutme-view",_ontologySkillsPercentage:0,_ontologyLanguagesPercentage:0,_profileCompletionPercentage:0,_legacySkillsPercentage:0,_legacyLanguagesPercentage:0,_isProfileCompletionComputed:!0,_wfiComponent:null,_userLogin:null,_createContent:function(){var o=this.model;if(this._readyToRender&&o){var s,a,r=this.model.getAssociated("interests"),l=this.model.getAssociated("skills"),c=this.model.getAssociated("languages"),d=this._is3DOrganizationServiceAvailable?{}:this.addChildView("languages",{_title:i.Languages,className:"languages-container",Class:"DS/SwymUIComponents/script/feature/core/ui-components/profile-element-container/profile-element-container-view",_mainView:"DS/SwymUIComponents/script/feature/core/user/view/language/user-language-view",_hasPlusIcon:!0,_model:this.model,_userModel:this.model,_collection:c,_iconSection:"language",_defaultMessage:i.Addlanguage,_engagingUX:!0,_engagingText:i.EngagingLanguage,_modelColor:"#005686"}),m=this._is3DOrganizationServiceAvailable?this.elements.htmlWFContentWrapper:this.addChildView("skills",{_title:i.Skills,className:"skills-container",Class:"DS/SwymUIComponents/script/feature/core/ui-components/profile-element-container/profile-element-container-view",_mainView:"DS/SwymUIComponents/script/feature/core/user/view/skill/user-skill-view",_hasPlusIcon:!0,_model:this.model,_userModel:this.model,_collection:l,_iconSection:"tools",_defaultMessage:i.Addskill,_engagingUX:!0,_engagingText:i.EngagingSkill,_modelColor:"#368ec4"}),u=this.addChildView("experiences",{_title:i.professionalXP,className:"experiences-container",Class:"DS/SwymUIComponents/script/feature/core/ui-components/profile-element-container/profile-element-container-view",_mainView:"DS/SwymUIComponents/script/feature/core/experience/view/experience-view",_hasPlusIcon:!0,_model:this.model,_userModel:this.model,_collection:this.model.getAssociated("works"),_iconSection:"briefcase",_defaultMessage:i.Addexperience,_engagingUX:!0,_engagingText:i.EngagingExperience,_modelColor:"#42a2da"}),h=this.addChildView("educations",{className:"educations-container",_title:i.educationXP,Class:"DS/SwymUIComponents/script/feature/core/ui-components/profile-element-container/profile-element-container-view",_mainView:"DS/SwymUIComponents/script/feature/core/education/view/education-view",_hasPlusIcon:!0,_model:this.model,_userModel:this.model,_collection:this.model.getAssociated("schools"),_iconSection:"graduation-cap",_defaultMessage:i.Addeducation,_engagingUX:!0,_engagingText:i.EngagingEducation,_modelColor:"#003c5a"}),p=t.extend({_createContent:function(){var e=this.collection.length,t="";if(e>0)for(var i=0;i<e;i++){t+=this.collection.at(i).get("title"),i<e-1&&(t+=", ")}return t}}),g=this.addChildView("interests",{className:"interests-container",_title:i.Interests,Class:"DS/SwymUIComponents/script/feature/core/ui-components/profile-element-container/profile-element-container-view",_mainView:this.model.isCurrentUser()?"DS/SwymUIComponents/script/feature/core/user/view/interest/user-interest-view":p,_hasPlusIcon:!0,_model:this.model,_userModel:this.model,_collection:r,_iconSection:"heart",_defaultMessage:i.Addinterest,_engagingUX:!0,_engagingText:i.EngagingInterest,_modelColor:"#78befa"}),w=r.length+l.length+this.model.getAssociated("schools").length+c.length+this.model.getAssociated("works").length===0,C=l.length,f=r.length,y=c.length,v=[],A=[];this._is3DOrganizationServiceAvailable&&(C=1,w=!1),0===C?v.push(m):A.push(m),this._is3DOrganizationServiceAvailable||(0===y?v.push(d):A.push(d)),0===f?v.push(g):A.push(g),s=[{class:"col-md-6 col-lg-4",html:m},{class:"col-md-6 col-lg-4",html:d},{class:"col-xs-12 col-lg-4",html:g}],this._is3DOrganizationServiceAvailable&&(s=[{class:"col-md-12 col-lg-8",html:m},{class:"col-xs-12 col-lg-4",html:g}]),a=[{class:"col-xs-12",html:[{class:"col-md-6",html:u},{class:"col-md-6",html:h}]}],0===this.model.getAssociated("works").length&&(a=[{class:"col-xs-12",html:[{class:"col-md-6",html:h},{class:"col-md-6",html:u}]}]),1===v.length?s=!0===this.model.isCurrentUser()?[{class:"col-md-6 col-lg-4",html:A[0]},{class:"col-md-6 col-lg-4",html:A[1]},{class:"col-lg-4",html:v[0]}]:[{class:"col-md-6",html:A[0]},{class:"col-md-6",html:A[1]}]:2===v.length&&(s=!0===this.model.isCurrentUser()?[{class:"col-md-6 col-lg-4",html:A[0]},{class:"col-md-6 col-lg-4",html:v[0]},{class:"col-md-6 col-lg-4",html:v[1]}]:[{class:"col-xs-12 col-lg-6",html:A[0]}]),!0===this.model.isCurrentUser()&&this._is3DOrganizationServiceAvailable&&(s=[{class:"col-md-8",html:m},{class:"col-md-4",html:g}]),!1!==this.model.isCurrentUser()||1!==A.length||0!==this.model.getAssociated("works").length&&0!==this.model.getAssociated("schools").length||(s=[{class:"col-md-8",html:A[0]},{class:"col-md-4",html:0===this.model.getAssociated("works").length?h:u}],a=[]);var _=e.createElement("div",{styles:{"text-align":"center"},html:[{class:"network-default-message",html:n.replace(i.hasnotfilledprofileyet,{firstName:this.model.get("first_name")})},{html:'<span class="fonticon fonticon-vcard fonticon-nocontent"></span>'}]}),S=[s,a];return!0===w&&!1===this.model.isCurrentUser()&&(S=_),S}},init:function(t){try{var i=this._parent.apply(this,arguments);return this.elements.htmlWFContentWrapper=e.createElement("div",{class:"wfi-content-wrapper"}),this.widget=t.widget,i}catch(e){return o.error("Error initializing rich user view:"+e.message),!1}},setup:function(){var e=this;this.model;this._parent.apply(this,arguments),this._readyToRender=!1,void 0===e.model.getCustomProperty("computedProfileCompletion")&&(e._isProfileCompletionComputed=!1,e.model.setCustomProperty("computedProfileCompletion",e.model.get("profile_completion"))),c.is3DOrganizationServiceAvailable().then(function(t){e._3DOrganizationServiceUrl=t.orgUrl,t.is3DWFEnabled?t.ENXLoaderModules.getWFIWrapper(function(t){e._wfComponent=t,e._readyToRender=!0,e._is3DOrganizationServiceAvailable=!0,e.refresh()}):(e._readyToRender=!0,e._is3DOrganizationServiceAvailable=!1,e.refresh())})},_updateCompletion:function(e){this.model.dispatchEvent("usercompletionUpdate",e)},calculateSkillPercentage:function(e){return 10*(e>=3?3:e)},calculateLanguagePercentage:function(e){return 5*(e>=2?2:e)},buildWFIComponent:function(){let e=this,t=s.getInstance().get("config").tenant.online_instance_id;r.getPassportURLPromise().then(i=>{const n={"3DOrganization":this._3DOrganizationServiceUrl,"3DSwym":l.getBaseUrl(),"3DPassport":i};this._is3DOrganizationServiceAvailable&&(e._wfiComponent=new this._wfComponent({serviceUrls:n,platformId:t,userLogin:this.model.get("ds6w:resourceUid"),onSkillsLoaded:function(t){if(!e._isProfileCompletionComputed){console.log("skill, onSkillsLoaded",t);let i=e.model.get("skills").length;e._legacySkillsPercentage=e.calculateSkillPercentage(i),e._ontologySkillsPercentage=e.calculateSkillPercentage(t.nbSkills),console.info("points added to completion:",e._ontologySkillsPercentage);let n=e.model.getCustomProperty("computedProfileCompletion")-e._legacySkillsPercentage;e._profileCompletionPercentage=parseInt(n)+parseInt(e._ontologySkillsPercentage),e.model.dispatchEvent("usercompletionUpdate",e._profileCompletionPercentage),e.model.setCustomProperty("nbSkills",t.nbSkills)}},onLanguagesLoaded:function(t){if(!e._isProfileCompletionComputed){console.log("Language, onLanguagesLoaded",t);let i=e.model.get("languages").length;e._legacyLanguagesPercentage=e.calculateLanguagePercentage(i),e._ontologyLanguagesPercentage=e.calculateLanguagePercentage(t.nbLanguages),console.info("points added to completion:",e._ontologyLanguagesPercentage);let n=e.model.getCustomProperty("computedProfileCompletion")-e._legacyLanguagesPercentage;e._profileCompletionPercentage=parseInt(n)+parseInt(e._ontologyLanguagesPercentage),e.model.dispatchEvent("usercompletionUpdate",e._profileCompletionPercentage),e.model.setCustomProperty("nbLanguages",t.nbLanguages)}},onSkillsUpdated:function(t){console.log("skill, onSkillsUpdated",t);let i=e.calculateSkillPercentage(e.model.getCustomProperty("nbSkills")),n=e.model.getCustomProperty("computedProfileCompletion")-i;e._ontologySkillsPercentage=e.calculateSkillPercentage(t.nbSkills),console.info("points added to completion:",e._ontologySkillsPercentage),e._profileCompletionPercentage=n+e._ontologySkillsPercentage,e._updateCompletion(e._profileCompletionPercentage),e.model.setCustomProperty("nbSkills",t.nbSkills)},onLanguagesUpdated:function(t){console.log("Language, onLanguagesUpdated",t);let i=e.calculateLanguagePercentage(e.model.getCustomProperty("nbLanguages")),n=e.model.getCustomProperty("computedProfileCompletion")-i;e._ontologyLanguagesPercentage=e.calculateLanguagePercentage(t.nbLanguages),console.info("points added to completion:",e._ontologyLanguagesPercentage),e._profileCompletionPercentage=n+e._ontologyLanguagesPercentage,e._updateCompletion(e._profileCompletionPercentage),e.model.setCustomProperty("nbLanguages",t.nbLanguages)},renderTo:this.elements.htmlWFContentWrapper}))})},onRedraw:function(){this._is3DOrganizationServiceAvailable&&(null===this._userLogin&&null===this._wfiComponent?(o.log("User is logging first time, We are initializing WFIComponent"),this.buildWFIComponent()):this._userLogin!=this.model.get("ds6w:resourceUid")?(o.log("User is different, We are initializing WFIComponent"),this.buildWFIComponent()):o.log("User is same, We are using existing WFIComponent"),this._userLogin=this.model.get("ds6w:resourceUid"))}})}),define("DS/SwymUIComponents/script/utils/content-creation-types-manager",["UWA/Core","DS/SwymUICore/script/lib/pub-sub","DS/SwymUICore/script/utils/i18n","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/utils","DS/Logger/Logger","DS/SwymUICore/script/constants/community-constants","DS/SwymUICore/script/feature/core/context/context-constants","DS/SwymUICore/script/feature/community/derived-type/derived-type-data-utils","DS/SwymUICore/script/feature/community/derived-type/derived-type-styles-manager","DS/SwymUIComponents/script/utils/feature-activation-manager","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/edit/content-creation-view"],(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p)=>{const g=c.CONTENT.post,w=c.CONTENT.iquestion,C=c.CONTENT.idea,f=c.CONTENT.media,y=c.CONTENT.survey,v=c.CONTENT.wiki,A=c.CONTENT.wedo,_=c.CONTENT.ritual,S=c.CONTENT["social-event"],b=c.CONTENT.message,I=window.ds&&!0===window.ds.swymIM?[b,"comment",g,f,C,w,y,v,A,S]:[g,f,C,w,y,v,A],D=[b,"comment",g,f,A,S];let T=null;const E={},U={},k={};U[g]="newspaper",U[C]="lamp",U[w]="help",U[b]="chat-alt",U[f]="picture",U[y]="clipboard",U[v]="book-open",U.comment="comment",U[A]="task",U[_]="calendar-clock",U[S]="calendar",k[b]={fonticon:U[b],className:b,name:b,description:p.Message,text:p.Message,placeholder:"",placeholder_focused:p.AddATitle},k[g]={fonticon:U[g],className:g,name:g,description:p.Post,text:p.Post,placeholder:p.Addapost,placeholder_focused:p.AddATitle},k[f]={fonticon:U[f],className:f,name:f,text:p.ThreeDPhotoVideo,description:p.ThreeDPhotoVideo,placeholder:p.Addamedia,placeholder_focused:p.AddATitle},h.isFeatureActivated("activateWedo")&&(k[A]={fonticon:U[A],className:A,name:A,text:p.Wedo,description:p.Wedo,placeholder:p.AddAWedo,placeholder_focused:p.AddATitle}),k[C]={fonticon:U[C],className:C,name:C,text:p.Idea,description:p.Idea,placeholder:p.Addanidea,placeholder_focused:p.AddATitle},k[w]={fonticon:U[w],className:w,name:w,text:p.Question,description:p.Question,placeholder:p.Addaquestion,placeholder_focused:p.AddATitle},k[y]={fonticon:U[y],className:y,name:y,text:p.Survey,description:p.Survey,placeholder:p.Addasurvey,placeholder_focused:p.AddATitle},k[v]={fonticon:U[v],className:v,name:v,text:p.Wiki,description:p.Wiki,placeholder:p.Addawiki,placeholder_focused:p.AddATitle},k[S]={fonticon:U[S],className:S,name:S,text:p.RendezVous,description:p.RendezVous,placeholder:p.AddARendezvous,placeholder_focused:p.AddATitle},h.isBetaFeatureActivated("ritual")&&(k[_]={fonticon:U[_],className:_,name:_,text:"Ritual",description:p.Ritual,placeholder:p.AddARitual,placeholder_focused:p.AddATitle});const x=t.extend({_types:null,_typeItems:null,_typeIcons:null,_isCurrentTypeSelectedByUser:!1,_currentType:null,_previousType:null,_currentCommentSubjectContentType:null,_communityMode:null,_programmaticallyChanged:!1,getDefaultContentType(){let e=null;return this._types.length>0&&([e]=this._types),e},_setIsCurrentTypeSelectedByUser(e){this._isCurrentTypeSelectedByUser=Boolean(e)},isCurrentTypeSelectedByUser(){return this._isCurrentTypeSelectedByUser},getCurrentCommentSubjectContentType(){return this._currentCommentSubjectContentType},_setCurrentCommentSubjectContentType(e){e&&(e=e.toLowerCase()),e!==this._currentCommentSubjectContentType&&(this._currentCommentSubjectContentType=e,this.dispatchEvent("onCommentSubjectContentTypeChange",{commentSubjectContentType:this._currentCommentSubjectContentType},!0))},getPreviousContentType(){return this._previousType},getCurrentContentType(){return this._currentType},_setCurrentContentType(e,t,i,n,o){const s=this._currentType,a=this._types.indexOf(e)>=0,r=a&&e!==s;return r&&(this._previousType=this._currentType,this._currentType=e),a&&!0===i&&this.dispatchEvent("onContentTypeIconChange",{oldType:s,newType:e},!0),(a&&!0===n||r&&!0!==t)&&this.dispatchEvent("onCurrentContentTypeChange",{forceFocus:n,leftColumnTrigger:o,currentType:this._currentType,communityId:this._context.communityId},!0),!!r&&this._currentType},getContentTypes(){return e.clone(this._types)},getAllPossibleContentTypes:()=>e.clone(I),init(...t){const i=this._parent(...t);this._types=e.clone(I),this._typeItems=e.clone(k),this._typeIcons=e.clone(U);const[o]=this._types;return this._currentType=o,this.onContextChangeBound=this.onContextChange.bind(this),this._onFeedModeChange=this._onFeedModeChange.bind(this),this._context=n.getInstance(),this._context.addListener("onContextChange",this.onContextChangeBound,this,!0),this._context.addListener("onFeedModeChange",this._onFeedModeChange),i},_onFeedModeChange(t){const{feedMode:i}=t,n=this._types.indexOf(b),o=this._types.indexOf("comment");(o>=0&&i===c.CTY_CONTENT_LIST_MODE.WHATSNEW_MODE||o>=0&&i===c.CTY_CONTENT_LIST_MODE.COMPACTVIEW_MODE)&&this._types.splice(o,1),o>=0&&i===c.CTY_CONTENT_LIST_MODE.WHATSNEW_MODE||o>=0&&i===c.CTY_CONTENT_LIST_MODE.COMPACTVIEW_MODE?(this._communityMode=i,this._types.splice(n,1)):n<0&&i===c.CTY_CONTENT_LIST_MODE.TIMELINE_MODE&&(this._communityMode=i,this._types.unshift(b)),this._context.previousAttributes.path.contains("search")&&"social-event"===this._currentType||(this.setContentTypeRequest({type:this._types[0],silent:!0}),this.dispatchEvent("onContentTypesChange",{contentTypes:e.clone(this._types)},!0))},onContextChange(){let t,n,a,r,T,E,U,k=!1;const x=e.clone(this._types);let M,V=null,P=null,N=null,O=[];if(this._communityMode=this._context.feedMode,"social-event"!==this._currentType||!this._context.path.contains("search")){if(!this._context.isContentContext()||this._context.getCommunityPageContext()===S)if(this._context.isCommunityContext()||this._context.isDirectMessageContext()||this._context.isRitualContext())if(this._context.isDirectMessageContext()){switch(a=this._context.getDirectMessagePageContext(),r=new o({mid:this._context.communityId}),T=new s({mid:this._context.communityId}),a){case d.COMMUNITY_BLOG:V=g;break;case d.COMMUNITY_MEDIA:V=f;break;case d.COMMUNITY_WEDO:V=A;break;case d.COMMUNITY_SOCIAL_EVENTS:V=S}if(V)V===S?this.isContentCreationAllowed(V,T)?this._types=[V]:this._types=[]:this._types=[V];else for(this._types=[],E=0,U=D.length;E<U;E+=1)(M=D[E])===S?this.isContentCreationAllowed(M,T)&&this._types.push(M):(this._communityMode===c.CTY_CONTENT_LIST_MODE.TIMELINE_MODE||this._communityMode===c.CTY_CONTENT_LIST_MODE.WHATSNEW_MODE&&M!==b&&"comment"!==M||this._communityMode===c.CTY_CONTENT_LIST_MODE.COMPACTVIEW_MODE&&I[E]!==b&&"comment"!==I[E])&&this._types.push(M)}else if(this._context.isCommunityContext()){if(t=this._context.getCommunityPageContext(),n=this._context.getCommunityDerivedTypePageContext(),!1===(r=new o({id:this._context.communityId})).creationRightsAvailable())return this._types=[...x],void r.addEventOnce("onSync",this.onContextChangeBound);if(r.isBusinessExperienceCommunity()){if(!r.derivedTypesListAvailable())return this._types=[...x],r.addEventOnce("onSync:getDerivedTypes",this.onContextChangeBound),void r.action("getDerivedTypes");P=r.getDerivedTypesList(),N=r.get("derivedTypes"),Object.assign(this._typeItems,N.reduce((e,t)=>({...e,[t.id]:{fonticon:t.icon.replace("fonticon-",""),className:u.getClassNameFromTypeName(t),name:t.id,text:t.label,description:t.label,placeholder:i.replace(p.Addatype,{type:t.label}),parent:t.parent,placeholder_focused:p.AddATitle}}),{})),Object.assign(this._typeIcons,N.reduce((e,t)=>({...e,[t.id]:t.icon.replace("fonticon-","")}),{})),N.forEach(e=>u.addDerivedTypeStyle(e))}if(r.removeEvent("onSync",this.onContextChangeBound),r.removeEvent("onSync:getDerivedTypes",this.onContextChangeBound),n)V=m.getDerivedTypeIdFromCommunityPageName(n);else switch(t){case d.COMMUNITY_BLOG:V=g;break;case d.COMMUNITY_IDEAS:V=C;break;case d.COMMUNITY_QUESTIONS:V=w;break;case d.COMMUNITY_SURVEYS:V=y;break;case d.COMMUNITY_WIKI:V=v;break;case d.COMMUNITY_MEDIA:V=f;break;case d.COMMUNITY_WEDO:V=A;break;case d.COMMUNITY_SOCIAL_EVENTS:V=S}if(V)this.isContentCreationAllowed(V,r)?this._types=[V]:this._types=[];else for(this._types=[],E=0,U=(O=P&&P.length>0?P.concat(I):I).length;E<U;E+=1)this.isContentCreationAllowed(O[E],r)&&(this._communityMode===c.CTY_CONTENT_LIST_MODE.TIMELINE_MODE||this._communityMode===c.CTY_CONTENT_LIST_MODE.WHATSNEW_MODE&&O[E]!==b&&"comment"!==O[E]||this._communityMode===c.CTY_CONTENT_LIST_MODE.COMPACTVIEW_MODE&&O[E]!==b&&"comment"!==O[E])&&this._types.push(O[E])}else this._types=[_];else{const e=this.getAllPossibleContentTypes();if(window.ds&&!0===window.ds.swymIM&&e.splice(0,2),!h.isBetaFeatureActivated("rdv")){const t=e.indexOf(S);t>=0&&e.splice(t,1)}this._types=e}if(!0!==k)if(x.length!==this._types.length)k=!0;else if(x.length>0&&this._communityMode===c.CTY_CONTENT_LIST_MODE.COMPACTVIEW_MODE)k=!0;else for(E=0,U=x.length;E<U;E+=1)if(this._types.indexOf(x[E])<0){k=!0;break}!0===k&&((this._types.indexOf(this._currentType)<0||window.ds&&!0===window.ds.swymIM&&"home"===this._context.previousAttributes.path&&this._context.isCommunityContext()||this._context.isDirectMessageContext()&&this._context.isPreviousContextACommunity()||this._context.isCommunityContext()&&!this._context.isDirectMessageContext()&&this._context.isPreviousContextADM())&&this.setContentTypeRequest({type:this._types[0],resetUserAction:!0}),this.dispatchEvent("onContentTypesChange",{contentTypes:e.clone(this._types)},!0),l.log("new _types",this._types))}},getTypeItemData(e){return e&&this._typeItems[e]||this._typeItems},getTypeIconClasses(){return this._typeIcons},isContentCreationAllowed(e,t){let i=!1;if(e)if(I.includes(e)){const n=h.isFeatureActivated("activateWedo");switch(e.toLowerCase()){case"comment":i=!0;break;case"message":i=!t||t&&!0===t.canCreateMessages();break;case"post":i=!t||t&&!0===t.canCreatePosts();break;case"media":i=!t||t&&!0===t.canCreateMedia();break;case"question":case"iquestion":i=!t||t&&!0===t.canCreateQuestions();break;case"idea":case"ideation":i=!t||t&&!0===t.canCreateIdeas();break;case"survey":i=!t||t&&!0===t.canCreateSurveys();break;case"wedo":i=!!(n&&t&&t.canCreateWedo());break;case"social-event":i=h.isBetaFeatureActivated("rdv")&&t&&t.canCreateSocialEvent()||h.isBetaFeatureActivated("rdvInConversation")&&this._context.dmId;break;case"wiki":case"wikipage":i=!t||t&&!0===t.canCreateWikiPages()}}else t.canCreateDerivedType(e)&&(i=!0);return i},setContentTypeRequest(e){(e.userAction||e.resetUserAction||!this.isCurrentTypeSelectedByUser())&&(e.userAction?this._setIsCurrentTypeSelectedByUser(e.userAction):this._setIsCurrentTypeSelectedByUser(!1),this._programmaticallyChanged=Boolean(e.programmaticallyChanged),this._setCurrentContentType(e.type,e.silent||!1,e.updateIcon,e.forceFocus,e.leftColumnTrigger),this._setCurrentCommentSubjectContentType(e.commentSubjectContentType))},wasProgrammaticallyChanged(){return this._programmaticallyChanged},destroy(...e){this._context.removeListener("onCommunityChange",this.onCommunityChangeBound),this._context.removeListener("onContextChange",this.onContextChangeBound),this._context.removeListener("onFeedModeChange",this._onFeedModeChange),this._parent(...e)}});return E.POST=g,E.IDEA=C,E.QUESTION=w,E.MEDIA=f,E.SURVEY=y,E.MESSAGE=b,E.COMMENT="comment",E.WIKI=v,E.WEDO=A,E.RITUAL=_,E.SOCIAL_EVENT=S,E.ALL_TYPES=I,E.getInstance=(()=>(null===T&&(T=new x),T)),E}),define("DS/SwymUIComponents/script/feature/community/content/edit/replied-content-view",["UWA/Core","UWA/Event","UWA/String","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/lib/event-manager","DS/SwymUICore/script/utils/im-core-utils","DS/SwymUICore/script/utils/i18n","DS/SwymUIComponents/script/utils/content-creation-types-manager","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/edit/replied-content-view"],function(e,t,i,n,o,s,a,r,l){"use strict";var c=s.TYPES.POST_MODEL_TYPE_TABLE,d=s.TYPES.IDEA_MODEL_TYPE_TABLE,m=s.TYPES.QUESTION_MODEL_TYPE_TABLE,u=(s.TYPES.MEDIA_MODEL_TYPE_TABLE,s.TYPES.WIKI_MODEL_TYPE_TABLE),h=s.TYPES.SURVEY_MODEL_TYPE_TABLE,p=s.TYPES.POST_MODEL_TYPE,g=s.TYPES.IDEA_MODEL_TYPE,w=s.TYPES.QUESTION_MODEL_TYPE,C=s.TYPES.MEDIA_MODEL_TYPE,f=s.TYPES.WIKI_MODEL_TYPE,y=s.TYPES.SURVEY_MODEL_TYPE;return n.extend({name:"replied-content-view",defaultOptions:{creationMode:!1},className:"hidden",domEvents:{"click .fonticon-close":"cancel"},cancel:function(){this.model=null,this.refresh(),this._typesManager.setContentTypeRequest({type:"message",updateIcon:!0,forceFocus:!0})},_replyToIMCreateContent:function(){var e,t,i="";return this.model&&(e=this.model.getAssociated("author"),t=this.model.getInstantMessage(),i=[{class:"replied-message",html:[{tag:"span",class:"replied-message-content",html:[{tag:"span",class:"fonticon fonticon-chat-alt"},{tag:"a","data-content-type":"person","data-login":e.get("login")||"",html:e.getNickname()},{tag:"span",class:"semi-colon",html:":"},{tag:"span",class:"ellipsis-text",html:t.get("richMessage")||""}]}]},!0===this.getOption("creationMode")?{class:"fonticon fonticon-close"}:""]),i},_getCommentedNls:function(){var e=this.model.get("message_details->subject_model"),t=this.model.has("message_details->parent_uri"),i="";if(e)switch(e.toLowerCase()){case"post":i=t?l.RepliedOnPost:l.CommentedOnPost;break;case"ideation":i=t?l.RepliedOnIdea:l.CommentedOnIdea;break;case"wiki":i=t?l.RepliedOnWiki:l.CommentedOnWiki;break;case"question":i=t?l.RepliedOnQuestion:l.CommentedOnQuestion;break;case"media":i=t?l.RepliedOnMedia:l.CommentedOnMedia}return i},_getSubjectLink:function(){var e=this.model,t=e.getCommunity().get("mid"),i=e.getCommunity().isDirectMessage(),n={tag:"a",class:"link","data-content-id":e.get("message_details->subject_id"),"data-content-type":function(e){var t;switch(e.toLowerCase()){case p.toLowerCase():case c.toLowerCase():t="post";break;case g.toLowerCase():case d.toLowerCase():t="idea";break;case w.toLowerCase():case m.toLowerCase():t="iquestion";break;case C.toLowerCase():t="media";break;case y.toLowerCase():case h.toLowerCase():t="survey";break;case f.toLowerCase():case u.toLowerCase():t="wiki"}return t}(e.get("message_details->subject_model")),html:e.get("message_details->subject_title")};return i?n["data-dm-id"]=t:n["data-community-id"]=t,n},_replyToCommentCreateContent:function(){var e,t,i="",n=this._typesManager.getCurrentCommentSubjectContentType();return this.model&&(e=this.model.getAssociated("author"),t=this.model.getInstantComment(),i=[{class:"comment-reply-first-line",html:[{class:"comment-reply-message",html:[{tag:"span",class:"fonticon fonticon-comment"},{class:"reply-action",html:l.ReplyTo},{tag:"a","data-content-type":"person","data-login":e.get("login")||"",html:e.getNickname()},{class:"reply-action",html:this._getCommentedNls()},this._getSubjectLink()]},{class:"fonticon fonticon-close"}]},{class:"comment-reply-second-line "+n,html:t.get("content")||""}]),i},_createContent:function(){var e="";if(this.model){var t=this.model.get("message_type");"INTERNAL_EVENT"===t?(this.container.addClassName("comment"),e=this._replyToCommentCreateContent()):"INSTANT_MESSAGE"!==t&&!1!==this.getOption("creationMode")||(this.container.removeClassName("comment"),e=this._replyToIMCreateContent())}return e},setup:function(){return this._typesManager=r.getInstance(),!0===this.getOption("creationMode")&&this.listenTo(o,"onEventReply",function(e){e&&e.model&&(this.container.removeClassName("hidden"),this.setModel(e.model))}.bind(this)),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/lib/ckeditor/usageTracker/plugin",["UWA/Utils/Client","DS/SwymUICore/script/utils/usage-tracker","DS/SwymUIComponents/script/utils/content-creation-types-manager"],(e,t,i)=>{const n="ContentFormat",o=e.Features.touchEvents?"mobile":"desktop",s={h1Command:"h1Command",h2Command:"h2Command",bulletedlist:"BulletedListCommand",numberedlist:"NumberedListCommand",blockquote:"BlockquoteCommand",formattedCommand:"formattedCommand",outdent:"Outdent",indent:"Indent",customtable:"AddCustomTable",bold:"Bold",italic:"Italic",underline:"Underline",strike:"Strike",highlight:"Highlight",removeFormat:"RemoveFormat",customlink:"CustomLink",unlink:"Unlink"};function a(e){const a=e.data.name,r=s[a];r&&t.trackPageEvent({category:n,label:r,view:"content-editor-view",event:"click",device:o,contentType:i.getInstance().getCurrentContentType()})}CKEDITOR.plugins.add("usageTracker",{init(e){e.on("afterCommandExec",a)}})}),define("DS/SwymUIComponents/script/feature/community/media/view/interactive-media-thumbnail-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/view/interactive-media-thumbnail-view","DS/SwymUIComponents/script/feature/community/content/view/media-thumbnail-view","DS/SwymUIComponents/script/feature/community/media/view/video/player-behaviors","DS/SwymUIComponents/script/utils/media-utils","DS/SwymUICore/script/feature/core/mobile/utils","DS/SwymUICore/script/utils/utils","DS/UIKIT/Spinner","DS/Logger/Logger","DS/SwymUIComponents/script/feature/community/media/video/model-interface/factory","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/lib/event-manager","DS/SwymUIComponents/script/utils/feature-activation-manager"],(e,t,i,n,o,s,a,r,l,c,d,m,u)=>{const h=window.ds&&"MOBILE"===window.ds.env,p=["3dxml","mp4","stl","pdf","step","udl"],g=window.ds&&window.ds.isMDE;return i.extend({name:"interactive-media-thumbnail-view",_autoplay:!1,_interactionActivated:!1,_lightboxContext:!1,_displayNext:!1,_displayPrevious:!1,_useOriginalMediaDimensions:!1,_displayIconsOnTopRightCorner:!1,modelInterface:null,showDownloadIconForSLD:!1,domEvents:{click:"_interactAfterClickOnThumbnail","click .thumbnail-previous":"_goToPreviousMedia","click .thumbnail-next":"_goToNextMedia","click .thumbnail-previous-next":"_goToNextMediaIfPicture"},_modelEvents:{"onChange:userFile":"refresh"},setup(e){this._parent.apply(this,arguments),this.showDownloadIconForSLD=e.showDownloadIconForSLD,this.modelInterface=g?c.getInterfaceModule(this.model):null,this._autoplay=n.getAutoPlayBehavior(e.autoplay,this.model.get("media_type")),window.ds&&"3DSearch"===window.ds.env&&this.model.set("media_type","picture"),e.useOriginalMediaDimensions&&(this._useOriginalMediaDimensions=e.useOriginalMediaDimensions),e.displayIconsOnTopRightCorner&&(this._displayIconsOnTopRightCorner=e.displayIconsOnTopRightCorner&&"sound"!==this.model.get("media_type")),("video"===this.model.get("media_type")||this._hasExtensionType("3dsto"))&&(this._useOriginalMediaDimensions=!0),e&&void 0!==e.delegateSpriteReloadToParentView&&(this._delegateSpriteReloadToParentView=e.delegateSpriteReloadToParentView,this.instantiatedInSummaryView=e.instantiatedInSummaryView,this._bufferImagesReload=!1),e&&void 0!==e.imageReloadOptions&&(this.imageReloadOptions=e.imageReloadOptions),e&&void 0!==e.imageRenderingOptions&&(this._imageRenderingOptions=e.imageRenderingOptions),e.displayNext&&(this._displayNext=e.displayNext),e.displayPrevious&&(this._displayPrevious=e.displayPrevious),e.forcePlayInContext&&(this._lightboxContext=e.forcePlayInContext),this.instantiatedInDetailedView=d.getInstance().isContentContext()},_goToPreviousMedia(){console.log("go to previous media test"),this.dispatchEvent("goToPreviousMedia")},_goToNextMedia(){console.log("go to next media test"),this.dispatchEvent("goToNextMedia")},_goToNextMediaIfPicture(){console.log("go to next media test"),this.dispatchEvent("goToNextMediaIfPicture")},_displayMediaView(){const e=this,{model:t}=this,i=t.get("media_type")||t.get("drive_media_type"),n=this.getElement(".thumbnail-icon-overlay")||this.getElement(".sound-thumbnail .fonticon-play"),s=this.getChildView("interactive-action-menu");let a=this.getElement("img[data-content-id]")||this.getElement(".sound-thumbnail")||this.getElement("img[data-type]")||this.getElement(".img-full-picture");"3d_model"!==i&&"picture"!==i&&"drawing"!==i||!0!==this._lightboxContext||(a=this.container.parentElement),n&&n.remove(),"3d_model"===i&&s&&s.hide();let r=null;r=g?this.modelInterface.getMediaViewerModule(t,"360Activated"):o.getMediaViewerModule(t,"360Activated"),require([r],n=>{if(!this.isDestroyed()){const r=a.offsetHeight,c=a.offsetWidth,d=c,m=r;let u;var s=this.addChildView("mediaView",new n({model:t,height:m,width:d,isLightboxContext:this._lightboxContext,isFluid:"sound"!==t.get("media_type"),events:{onRefreshRequest(){s.destroy(),e._interactionActivated=!1,e.refresh()}},instantiatedInSummaryView:this.instantiatedInSummaryView}));let h;const p=this.container.getSize();s.addEventOnce("mediaViewReady",()=>{this.dispatchEvent("onMediaReady"),h=this.container.parentElement,("video"===i||"animatedPicture"===i)&&h.offsetHeight>0&&h.offsetWidth>0&&((u=h&&h.offsetHeight>=p.height&&h.offsetWidth>=p.width?o.getBestDimensionsDisplayForVideo(t,h.offsetHeight,h.offsetWidth):o.getBestDimensionsDisplayForVideo(t,p.height,p.width))&&u.height&&this.container.setStyle("height",`${u.height}px`),u&&u.width?(this.container.setStyle("width",`${u.width}px`),this.container.setStyle("height",`${u.width*m/d}px`)):this.container.setStyle("width","100%")),"3d_model"!==i&&"drawing"!==i||this.getElement(".interactive-media-wrapper").removeClassName("cursor-pointer"),l.log("the media is ready"),this._spinnerElement&&this._spinnerElement.remove(),["sound"].indexOf(i)>-1&&c?this.container.style.width=`${c}px`:["3d_model","simulationMedia","sketch","story","whiteboard","drawing"].indexOf(i)>-1&&(this._useOriginalMediaDimensions&&0!==t.get("width")?this.container.style.width=`${Math.min(t.get("width"),h.offsetWidth)}px`:c&&(this.container.style.width=`${c}px`)),a.hide(),this.container.addClassName("media-initialized")}),a&&this.container.contains(a)||(a=this.getElement("img")||this.getElement(".sound-thumbnail")),a&&s.inject(a,"after"),s.hide(),this.addEvent("onMediaDownload",()=>{s.dispatchEvent("onMediaDownload")}),this._interactionActivated=!0}})},_hasExtensionType(e){const{model:t}=this;return t.get("format_3dsa")===e||t.get("media_file_ext")===e||t.get("fileName")&&t.get("fileName").endsWith(`.${e}`)||t.get("orig_name")&&t.get("orig_name").endsWith(`.${e}`)},play(){this._play()},_play(){this._interactionActivated=!0;const t=this.getElement(".thumbnail-icon-overlay")||this.getElement(".sound-thumbnail .fonticon-play")||this.getElement(".thumbnail-icon-play-360");let i=this.getElement("img[data-content-id]")||this.getElement(".sound-thumbnail")||this.getElement("img[data-type]");"3d_model"!==this.model.get("media_type")&&"drawing"!==this.model.get("media_type")||!0!==this._lightboxContext||(i=this.container.parentElement),t&&t.remove(),i&&!this._spinnerElement&&(this._spinnerElement=e.createElement("div",{class:"spinner-thumbnail",html:new r({className:"msg-animation",visible:!0,animate:!0,spin:!0})}).inject(i,"before"));const{model:n}=this,s=n.get("status"),a=this._hasExtensionType("3dxml"),l=this._hasExtensionType("3dsto"),c=this._hasExtensionType("3dskt"),d=this._hasExtensionType("3dwb"),m=this._hasExtensionType("svg"),u=this._hasExtensionType("udl"),h="pdf"===n.get("media_file_ext")||n.get("fileName")&&n.get("fileName").endsWith(".pdf");s!==o.MEDIA_PROCESSING_STATUS.KO&&s!==o.MEDIA_PROCESSING_STATUS.READY||a||l||c||d||m||u||h?s===o.MEDIA_PROCESSING_STATUS.OK&&a&&(!(a||l||c||d)||n.get("format_3dsa"))||n.isConsideredAsA360MediaModel()||h||m?this._displayMediaView():setTimeout(()=>{const e=this;g&&n.isDriveFile()?n.getDriveFileUrl().then(t=>{e._displayMediaView()}):n.fetch({onComplete:function(e){if(!this.isDestroyed()){const t=e.get("status");t===o.MEDIA_PROCESSING_STATUS.OK||a||l||c||d||u?"animatedPicture"!==e.get("media_type")||e.isMediaAPlayableGIF()?this._displayMediaView():(this._spinnerElement.remove(),this._spinnerElement=null):this._displayErrorMessage(t,i)}}.bind(this)})},1):this._displayErrorMessage(s,i)},_displayErrorMessage(e,i){let n,s;const a=this._getIconOverlay();this._interactionActivated=!1,e===o.MEDIA_PROCESSING_STATUS.KO?(n=t.AnErrorOccuredWhileProcessing,s="error"):(n=t.ThisMediaHasNotBeenProcessedYet,s="warn"),this.alert(s,n),a&&a.inject(i,"before"),this._spinnerElement.remove(),this._spinnerElement=null},download(){const{model:e}=this;h?s.downloadMediaInNativeMobileDevice(e):this._download()},_download(){let e;const{model:t}=this;if(h)s.openMediaInNativeMobileDevice(t);else{if(this.model.isSolidworksFileExtension()||this.showDownloadIconForSLD){if(!this.model.hasBeenFetched())return this.model.addEventOnce("onSync:read",this._download.bind(this)),void this.model.fetch();{const e=this.model.get("play")&&this.model.get("play")["3d_streams"]&&this.model.get("play")["3d_streams"][0]||this.model.get("play")["2d_streams"]&&this.model.get("play")["2d_streams"][0];this._downloadUrl=e&&(e.transient_url_as_attachment||e.transient_url)}}else this._downloadUrl=`${a.getBaseUrl()}/api/media/streammedia/id/${this.model.get("mid")}/type/original/output/download/`;((e=a.getClientInformation()).isIphone||e.isIpad)&&e.isSafari&&this._myNewWindow&&this._myNewWindow.location?this._myNewWindow.location=this._downloadUrl:window.ds&&"3DD"===window.ds.env?window.open(this._downloadUrl,"_blank"):window.open(this._downloadUrl,"_self")}this._interactionActivated=!1},_isViewerOpeningNeeded(){const{model:e}=this,t=e.get("media_type"),i=this.model.isPDFExtension(),n=this.model.isDocumentOfficeExtension();return h?s.shouldBePlayedInLightbox(t):!1!==e.get("user_access")&&!1===this._lightboxContext&&!this.model.isSolidworksFileExtension()&&(this.container.offsetWidth<300||"picture"===t||"drawing"===t||"document"===t&&(i||n&&u.isFeatureActivated("activateODEViewer"))||"3d_model"===t||"simulationMedia"===t||"sketch"===t||"story"===t||"whiteboard"===t||"animatedPicture"===t)},_isModelShouldBeDownloaded(){return this.model.isDownloadDefaultBehaviour()},_initializeWindowTrickForSafari(){const e=a.getClientInformation();!this.model.has("media_file_ext")||"pdf"===this.model.get("media_file_ext")||!e.isSafari||!e.isIphone&&!e.isIpad||this.model.isDocumentOfficeExtension()&&u.isFeatureActivated("activateODEViewer")||(this._myNewWindow=window.open("","_blank"))},_interactAfterClickOnThumbnail(i){const n=this,o=i.target.getParent(".interactive-media-thumbnail-view-container");if(g&&this.model.getSource&&this.model.getSource()&&-1===this.model.getSource().indexOf("swym")&&this.model.getSource().indexOf("drive")>-1&&"picture"===this.model.get("drive_media_type"))return;if(o&&"A"===o.getParent().tagName&&!i.target.hasClassName("thumbnail-icon-play-360")&&!i.target.hasClassName("fonticon-open-down"))return;if(i.target.hasClassName("fonticon-open-down"))return i.preventDefault(),void i.stopPropagation();if("true"===i.target.dataset.deletedMedia)return void this.alert("info",t.get("Thismediahasbeendeleted"));const{model:a}=this,r=a.get("media_type");if(this._shouldActivateAutoplay=!0,"document"!==r||e.is(a.get("play"))){let t=!1;e.extendElement(i.target),i.target.hasClassName("arrow-navigation")||i.target.hasClassName("thumbnail-navigation")?t=!0:i.stopPropagation();const o=this._isViewerOpeningNeeded();if(console.log("is viewer opening needed - "+this._isViewerOpeningNeeded()),!0===o&&("picture"!==r||a.isConsideredAsA360MediaModel()||(this._shouldActivateAutoplay=!1),i.preventDefault(),this.dispatchEvent("onOpenInViewerRequest",[a,this])),!1===this._interactionActivated&&!1===o&&!1===t)if(h&&s.isFormatNativelyPlayable(r)&&"3d_model"!==r)g||"video"!==r?s.openMediaInNativeMobileDevice(a):(i.stopPropagation(),s.authenticateForPlayOnNativeMobileDevice(a).then(()=>{n._play()}));else switch(r){case"document":"pdf"===a.get("play").download_original_url.format||a.isDocumentOfficeExtension()&&u.isFeatureActivated("activateODEViewer")?this._play():(i.stopPropagation(),this._download());break;case"picture":break;case"simulationMedia":case"3d_model":if("3DSearch"===window.ds.env)break;this.model.isSolidworksFileExtension()&&(i.stopPropagation(),this._download());break;case"animatedPicture":case"video":case"sound":i.stopPropagation(),this._play();break;default:if(g&&p.indexOf(a.get("media_file_ext"))>-1){this._play();break}}else o&&this.showDownloadIconForSLD&&(i.stopPropagation(),this._download())}else i.preventDefault(),i.stopPropagation(),this._initializeWindowTrickForSafari(),a.fetch({onComplete:function(){this.isDestroyed()||this._interactAfterClickOnThumbnail(i)}.bind(this)})},_getSoundThumbnail:()=>({class:"thumbnail sound-thumbnail"}),_getIconOverlay(){let t="";const{model:i}=this,n=i.get("media_type");if(g)"animatedPicture"===n&&h?t=e.createElement("span",{class:"fonticon thumbnail-icon-overlay fonticon-4x fonticon-picture-animated"}):this.modelInterface.shouldAddPlayIconOverlay(i)?t=e.createElement("span",{class:"fonticon thumbnail-icon-overlay fonticon-4x fonticon-play"}):this.modelInterface.shouldAddDownloadIconOverlay(i)&&(t=e.createElement("span",{class:"fonticon thumbnail-icon-overlay fonticon-4x fonticon-download"}));else{const i=this.model.getFileExtension(),o=this.model.isMediaAPlayableGIF();if("animatedPicture"===n&&h)t=e.createElement("span",{class:"fonticon thumbnail-icon-overlay fonticon-4x fonticon-picture-animated"});else if(["video","3d_model","sound","simulationMedia","sketch","story","whiteboard","drawing"].indexOf(n)>-1||"document"===n&&"pdf"!==i||o){this.model;const i=this.model.getFileExtension();t=["sldprt","sldasm","slddrw",""].includes(i.toLowerCase())?e.createElement("span",{class:`fonticon thumbnail-icon-overlay fonticon-4x fonticon-${this.showDownloadIconForSLD?"download":""}`}):e.createElement("span",{class:`fonticon thumbnail-icon-overlay fonticon-4x fonticon-${this._isModelShouldBeDownloaded()?"download":"play"}`})}}return t},_getIconsOverlayTopRightCorner(){let t="";const i=[];return i.push(this.addChildView("interactive-action-menu",{Class:"DS/SwymUIComponents/script/feature/community/media/view/interactive-action-menu-view",model:this.model,events:{onPlay:function(e){this._interactAfterClickOnThumbnail(e)}.bind(this)}})),t=e.createElement("div",{class:"icons-top-right-container",html:i})},_getDisplayPrevious(){let e="";return!0===this._displayPrevious&&(e={class:"thumbnail-previous thumbnail-navigation",html:'<span class="fonticon arrow-navigation fonticon-4x fonticon-left-open "></span>'}),e},_getDisplayNext(){let e="";return!0===this._displayNext&&(e={class:"thumbnail-next thumbnail-navigation",html:'<span class="fonticon arrow-navigation fonticon-4x fonticon-right-open "></span>'}),e},_addSpecialAttributesForEditionMode(e){let t,i,n=null;t=e.getAttribute("data-position"),i=e.getAttribute("data-size"),t&&(e.removeAttribute("data-position"),(n=n||{})["data-position"]=t),i&&(e.removeAttribute("data-size"),(n=n||{})["data-size"]=i),n&&this.container.setAttributes(n)},_createContent(){let t="",i=e.createElement("div",{class:"thumbnail-overlay"}),n=this._getDisplayPrevious(),s=this._getDisplayNext();const a=this._getIconOverlay(),c=this._displayIconsOnTopRightCorner?this._getIconsOverlayTopRightCorner():"",{model:d}=this;let m;if(this._previousNextContainer="",g&&this.modelInterface.modelFetchNeeded(d)||!d.has("media_type")&&"read"!==d.lastCalledService&&!1!==d.get("user_access"))l.log("no media type is defined !"),n="",s="",d.fetch({onFailure:function(){l.log("get media has failed - probably due to access rights"),this.isDestroyed()||(d.set("media_type",""),this.refresh())}.bind(this),onComplete:function(){this.isDestroyed()||(this.removeControl("fullscreenSpinner"),this.refresh())}.bind(this)});else{let e,i,a,c,m;const u=d.get("mid"),h=d.get("media_type");o.isPictureViewAvailable(u)&&!0===this._lightboxContext?d.get("preview")?(e=parseInt(d.get("width"),10),i=parseInt(d.get("height"),10),a=(m=this.container.parentElement.getDimensions())&&parseInt(m.width,10),c=m&&parseInt(m.height,10),this._imageRenderingOptions=o.getImageRenderingOptionsForMedia(e,i,a,c),this._imageRenderingOptions.extraAttributes&&(this._imageRenderingOptions.extraAttributes["data-styles-to-remove-after-load"]="",this.imageReloadOptions=o.generateImageReloadOptionsForMedia({mediaId:u,mediaType:h,mediaWidth:e,mediaHeight:i,containerWidth:a,containerHeight:c})),this._delegateSpriteReloadToParentView=!1,t=this._parent(),this.container&&this.container.parentElement.addEvent("resize",()=>{const e=this.container.parentElement.getElement(".media-360-viewer-container"),t=this.container.parentElement.getElement(".video-viewer-container"),i=this.container.parentElement.getElement(".media-3dplay-viewer-container");this._interactionActivated||e||t||i||this.refresh()})):(n="",s="",t=this.addControl("fullscreenSpinner",new r({className:"msg-animation",visible:!0,animate:!0,spin:!0})),this.model.fetch({onComplete:function(){this.isDestroyed()||(this.removeControl("fullscreenSpinner"),this.refresh())}.bind(this),onFailure:function(){l.log("get media has failed - probably due to access rights"),this.isDestroyed()||(this.removeControl("fullscreenSpinner"),d.set("media_type",""),this.refresh())}.bind(this)})):t=d.get("status")!==o.MEDIA_PROCESSING_STATUS.OK&&("3dxml"===d.get("format_3dsa")||d.get("fileName")&&d.get("fileName").contains(".3dxml"))?this._create3DXMLThumbnail():this._parent()}return(n||s)&&(this._previousNextContainer=e.createElement("div",{class:"thumbnail-previous-next ",html:[n,s]}),this._previousNextContainer.addClassName("thumbnail-navigation")),t&&e.is(t.getAttribute,"function")&&this._addSpecialAttributesForEditionMode(t),a&&"picture"!==d.get("media_type")?i.setContent([this._previousNextContainer,a,c,t]):i=[this._previousNextContainer,a,c,t],m=e.createElement("div",{class:"interactive-media-wrapper",html:i}),!0===this._lightboxContext&&!s||!1===d.get("user_access")?m.setStyle("cursor","default"):m.addClassName("cursor-pointer"),m},_create3DXMLThumbnail(){return e.createElement("img",e.merge({src:a.getMediaDefaultThumbnail("3d_model"),"data-type":"MediaNoPicture",styles:{width:"100%"}},this._imageRenderingOptions&&this._imageRenderingOptions.extraAttributes||{}))},onRender(){const{model:t}=this,i=t.get("media_type"),n=t.get("play")&&t.get("play").download_original_url&&t.get("play").download_original_url.format;let o=!0;if(e.is(window.widget)&&e.is(window.widget.getAppName)&&window.widget.getAppName()===a.getContentReaderAppKey()&&(o=!1),t.has("media_type")){if(this.container.addClassName(`${i}-container`),"3d_model"===i&&this.container.addClassName("ds-3d_model-container"),"document"!==i||e.is(t.get("play"))||!0!==this._autoplay&&!0!==this._lightboxContext||t.fetch({onComplete:function(){this.isDestroyed()||this.onRender()}.bind(this)}),!0===this._lightboxContext&&"3d_model"===i){const e=4*this.container.parentElement.offsetHeight/3;this.container.setStyle("width",`${e}px`)}(!0===this._autoplay&&(o||"animatedPicture"===i)&&["animatedPicture","video","3d_model","sound","simulationMedia","sketch","story","whiteboard"].indexOf(i)>-1||(!0===this._autoplay||!0===this._lightboxContext)&&("pdf"===n||"svg"===n))&&this._play()}},onRefresh(){this._interactionActivated=!1,this.container&&this.container.removeClassName("media-initialized"),this._spinnerElement&&(this._spinnerElement.remove(),this._spinnerElement=null),this.onRender()},updateModel(){this.model.fetch({onComplete:function(){this.isDestroyed()||this.refresh()}.bind(this)})}})}),define("DS/SwymUIComponents/script/feature/community/content/view/content-summary-view",["UWA/Core","DS/UIKIT/Alert","DS/SwymUIComponents/script/feature/community/content/view/abstract-content-view","DS/SwymUIComponents/script/feature/community/media/view/interactive-media-thumbnail-view","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUIComponents/script/utils/media-utils","DS/SwymUICore/script/utils/utils","i18n!DS/SwymUIComponents/assets/nls/feature/community/survey/view/survey-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/view/abstract-content-view","DS/SwymUICore/script/lib/view/generic/swym-view","DS/UIKIT/Input/Button","DS/SwymUICore/script/utils/i18n","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/rich-link-preview-generator","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/rich-link-preview-utils","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/lib/model/generic/6wtaggable-model","DS/SwymUIComponents/script/utils/content-process","DS/SwymUICore/script/feature/container/container-utils","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/constants/community-constants"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w,C,f,y,v){"use strict";var A=window.ds&&window.ds.isMDE,_=i.extend({_socialFeaturesWrapperSelector:".content-body-section",_contentBodySelector:".content-body-section",_contentSummarySelector:".content-summary-section",name:"content-in-feed-summary-view",_modelEvents:{"onSync:create":"refresh","onChange:title":"refresh","onChange:maturity":"refresh","onChange:community":"refresh","onChange:summary":"refresh","onChange:preview_fingerprint":"refresh","onChange:tags6w":"_updateInlineTagsLookAccordingToTagsList","onChange:status_title":"refresh","onChange:status_color":"refresh","onChange:color":"refresh"},defaultOptions:{sendCommentsInitCallInPool:!0,showAuthorSection:!0,showThreadLink:!1,socialToolbarMode:"normal",dynamicLayout:!0,contentTypesForDynamicLayout:["post","idea","iquestion","wiki","social-event"]},_createThumbnail:function(){return{class:"thumbnail",html:this._createThumbnailContent()}},isDynamicLayoutCompatible:function(){return Boolean(this.getOption("dynamicLayout"))&&this.getOption("contentTypesForDynamicLayout").indexOf(this.model.getModelName())>=0&&(""!==this.model.get("summary").trim()||this.model.get("enhanced_summary")&&""!==this.model.get("enhanced_summary").trim())},_createSurveySummary:function(){var e,t="",i="",n=this.model,o=!0===n.get("showResultsAfterVote"),s=p.getInstance().get("user"),a=n.get("author").login===s.login||n.getAssociated("community").getUserRole()>2;if(n.isOpen())!1===n.get("userHasAlreadyAnswered")?(t=m.replace(r.QuestionTitleSummary,{number:"1"}),e=r.Answer,i=n.get("enhanced_summary",{escapeHTML:!1})):!0===o?(e=r.SeeTheResults,i=r.ThankYouForParticipating):a?(e=r.SeeTheResults,i=r.ThankYouForParticipating):i=r.ThankYouForParticipatingButWait;else if(n.hasStarted())e=r.SeeTheResults,i=r.SurveyIsClosed;else{var l=n.getSurveyOpeningTimeRemaining(),c=l.minutes,u=r.SurveyOpenInMinutes;l.months?(u=r.SurveyOpenInMonths,c=l.months):l.days?(u=r.SurveyOpenInDays,c=l.days):l.hours&&(u=r.SurveyOpenInHours,c=l.hours),i=m.replace(u,{number:c+1})}var h=n.getCommunity(),g=this.model.getContentType&&this.model.getContentType()||this.model.getModelName(),w=n.get("community->mid"),C=h.isDirectMessage(),f={class:"content-summary survey-content-summary","data-content-id":n.get("mid"),"data-content-type":g,html:[{class:"header",html:t},{class:"survey-content-container",html:[{class:"description",html:i},e?new d({className:e===r.Answer?"primary":"default",icon:e===r.Answer?"":"chart-bar",value:e}):{}]}]};return C?f["data-dm-id"]=w:f["data-community-id"]=w,f},_createSummary:function(){var t,i,n,o,s="",a=this.model,r=this.model.getContentType&&this.model.getContentType()||this.model.getModelName();if("survey"===this.model.getModelName())this._socialFeaturesWrapperSelector=null,s=this._createSurveySummary();else if(A){if(i=(t=this.model.getCommunity&&this.model.getCommunity())&&t.get("mid"),n=this.model.get("enhanced_summary",{escapeHTML:!1}),s={"data-content-id":this.model.get("mid"),"data-content-type":r,class:"content-summary enhanced",html:n},t&&i&&(s["data-community-id"]=i,s["data-dm-id"]=t.isDirectMessage()?i:""),a.has("sourceid")){var c=C.getContainerTypeFromSource(a.getSource()),d=C.getContainerIdFromSource(c,a);s["data-quadrant"]=this._context.quadrant,s["data-container-type"]=c,s["data-container-id"]=d,a.get("mid")===d?delete s["data-content-id"]:s["data-content-id"]=a.get("subject6wuri")}}else{i=(t=this.model.getCommunity()).get("mid");let a=!1;(n=this.model.get("enhanced_summary",{escapeHTML:!1}))&&(a=n.length>140),o=e.createElement("div",{class:"enhanced-description"+(a?" add-see-more":""),html:[{class:"content-summary-body",html:n},{class:"seeMore",html:"... <span>"+l.SeeMore+"</span>"}]}),s={"data-content-id":this.model.get("mid"),"data-content-type":r,"data-community-id":i,"data-dm-id":t.isDirectMessage()?i:"",class:"content-summary enhanced",html:o}}return s},_goToMedia:function(){let e=this.model.getCommunity(),t=this.model.get("mid"),i=this.mediaThumbnailModel&&this.mediaThumbnailModel.get("mid")!==t?this.mediaThumbnailModel.get("mid"):null,n=this.model.getModelName(),o=e.get("mid");y.goToContent(t,n,o,!1,void 0,void 0,"dm"===e.get("community_type"),{mediaId:i})},getMediaThumbnailContainerMaxHeight:function(){return 395},getImageRenderingOptionsForMedia:function(e){var t,i,n,o,a,r,l;return e&&(r=this.container.getSize(),t=e.get("media_type"),i=parseInt(e.get("width"),10),n=parseInt(e.get("height"),10),o=r&&r.width>0?Math.min(r.width,520):520,this.isDynamicLayoutCompatible()?(a=parseInt(this.getMediaThumbnailContainerMaxHeight(),10),o=parseInt(236,10)):a=parseInt(this.getMediaThumbnailContainerMaxHeight(),10),(l=s.getImageRenderingOptionsForMedia(i,n,o,a,t))&&l.extraAttributes&&l.extraAttributes.styles&&l.extraAttributes.styles["max-width"]&&(l.extraAttributes.styles["max-width"]="100%")),l},getImageReloadOptionsForThumbnail:function(e){var t,i,n,o,a,r,l=null;return e&&(t=e.get("mid"),i=e.get("media_type"),n=e.get("width"),o=e.get("height"),a=520,this.isDynamicLayoutCompatible()?(r=parseInt(200,10),a=parseInt(236,10)):r=parseInt(this.getMediaThumbnailContainerMaxHeight(),10),l=i&&n&&o?s.generateImageReloadOptionsForMedia({mediaId:t,mediaType:i,mediaWidth:n,mediaHeight:o,containerWidth:a,containerHeight:r}):{size:"l",imageKind:"thumb"}),l},_createThumbnailContent:function(){this.mediaThumbnailModel=this.model,"media"!==this.mediaThumbnailModel.getModelName()&&(this.mediaThumbnailModel=new o(this.model.get("thumbnail")));var e=this;return this.addChildView("contentThumbnail",{Class:n,model:this.mediaThumbnailModel,widget:this._widget,delegateSpriteReloadToParentView:!1,imageReloadOptions:this.getImageReloadOptionsForThumbnail(this.mediaThumbnailModel,this.model),imageRenderingOptions:this.getImageRenderingOptionsForMedia(this.mediaThumbnailModel,this.model),events:{onInit:function(){e.listenTo(this,"onOpenInViewerRequest",e._goToMedia)}},instantiatedInSummaryView:this.model.get("mid")})},_createUnavailableMsg:function(){return new t({closable:!1,closeOnClick:!1,visible:!0,fullWidth:!0,className:"content-not-available-error-msg",messageClassName:"primary",messages:[l.ContentNotAvailable],renderTo:this.container})},_createSummaryView:function(){var t=this.model,i=null,n=t.get("thumbnail"),o=!1;return this.isDynamicLayoutCompatible()&&(o=!0),t&&(this.elements.summaryView=i=e.createElement("div",{class:"content-summary-section"+(o?" dynamic":""),html:["media"===t.getModelName()||n&&n.mid?this._createThumbnail():null,"UNAVAILABLE"===t.get("status")?this._createUnavailableMsg():this._createSummary()]}),t.hasFirstMedia()||u.createPreviewFromLink(i,!0,!1),h.containsPreview(i)&&this.elements.summaryView.addClassName("contains-preview")),i},_updateInlineTagsLookAccordingToTagsList:function(){!this.isDestroyed()&&this.model instanceof g&&w.updateInlineTagsLookAccordingToTagsList(this.container,this.model.get("tags6w")||[])},checkInlineTagsInSummary:function(){var t=this.model,i=t.get("subject6wuri"),n=t.get("enhanced_summary",{escapeHTML:!1}),o=e.createElement("div",{html:n}).getElements("a.s6m-tag-link[data-predicate]"),s=t.get("tags6w")||[];o.length>s.length&&require(["DS/SwymUICore/script/utils/compass-proxy","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/core/6wtag/collection/6wtag-collection"],function(e,n,o){e.getServiceUrl({serviceName:"6WTags",platformId:n.getInstance().get("config").tenant.online_instance_id,onComplete:function(e){new o([],{mode:"6wtaggingserver:subject"}).fetch({url:e+"/resources/6w/tags/",type:"json",data:{tenant:n.getInstance().get("config").tenant.online_instance_id,subject:i},noCsrfToken:!0,parse:!0,headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(e){t.set("tags6w",e.toJSON())}})}})})},render:function(){return this.checkInlineTagsInSummary(),this._parent.apply(this,arguments)},_createContent:function(){var e=f.getInstance(),t=e.isCommunityContext()&&e.feedMode===v.CTY_CONTENT_LIST_MODE.COMPACTVIEW_MODE,i=this.getOption("isTimelineView")||!1,n="",o="",s=this.model.get("tags6w"),a=this.model;return a&&(t&&!i?o=this._createCompactViewSection():(n=this._createSummaryView(),Array.isArray(s)&&a instanceof g&&w.updateInlineTagsLookAccordingToTagsList(n,s),o=[this._createTitleSection(),this.getOption("showAuthorSection")?this._createAuthorSection():"",{class:"content-body-section",html:n}])),o}});return _.MediaThumbnailContainerMaxHeight=395,_.MediaThumbnailContainerMaxWidth=520,_.MediaThumbnailContainerMaxHeightDynamic=200,_.MediaThumbnailContainerMaxWidthDynamic=236,_}),define("DS/SwymUIComponents/script/feature/community/survey/view/survey-summary-view",["DS/SwymUICore/script/feature/community/survey/model/survey-model","DS/SwymUIComponents/script/feature/community/content/view/content-summary-view"],function(e,t){"use strict";return t.extend({_modelClass:e,name:"survey-summary-view",defaultOptions:{isSurveyType:!0},_modelEventsForAutoRefresh:["onChange:title","onChange:community","onChange:summary","onChange:preview_fingerprint","onChange:userHasAlreadyAnswered"],setup:function(){this.model.isansweredbyme({}),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/content/view/content-highlight-view",["UWA/Core","DS/SwymUIComponents/script/feature/community/content/view/content-summary-view","DS/UIKIT/Tooltip","DS/SwymUIComponents/script/feature/core/modal/super-modal","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/view/abstract-content-view","DS/Logger/Logger","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/constants/community-constants"],function(e,t,i,n,o,s,a,r){"use strict";return t.extend({domEvents:{"click .unhighlight-icon":"_unhighlight","click .hide-icon":"_hideHighlightConfirmation"},name:"content-highlight-view",_unhighlight:function(){var e=this.model.getCommunity();e.addChanges("highlighted_content_uri",""),e.save({},{onComplete:function(){this.alert("success",o.UnhighlightSuccess)}.bind(this),onFailure:function(){this.alert("error",o.UnhighlightFailure)}.bind(this)})},_hideHighlightConfirmation:function(){new n({closable:!0,renderTo:window.document.body||this._widget.body}).confirm({title:o.HideHighlightConfirmationTitle,message:o.HideHighlightConfirmationModalMsg,callback:function(e){!0===e&&this._hideHighlight()}.bind(this)})},_hideHighlight:function(){this.model.getCommunity().hideContentHighlight({onComplete:function(){this.hide(),this.alert("success",o.HideHighlightSuccess)}.bind(this),onFailure:function(){this.alert("error",o.HideHighlightFailure)}.bind(this)})},_createActionMenu:function(){var t=this.model.getCommunity().getUserRole()>2,n=e.createElement("span",{class:"unhighlight-icon fonticon fonticon-megaphone-off"}),s=e.createElement("span",{class:"hide-icon fonticon fonticon-eye-off"});return this.addControl("UnhighlightTooltip",new i({target:n,body:o.Unhighlight})),this.addControl("hideTooltip",new i({target:s,body:o.HideHighlight})),t?n:s},onRedraw:function(){},_createIconBackgroundSection:function(){return{tag:"span",class:"highlight-icon-background fonticon fonticon-megaphone"}},setup:function(e){this.hide(),this.model.getCommunity().isContentHighlightHidden({onComplete:function(e,t){t||this.show()}.bind(this)}),this._parent.call(this,e)},_createSummary:function(){var e=this._parent(),t=e.html;return"social-event"===this.model.getModelName()&&(e.html=[this.addChildView("details",{model:this.model,Class:"DS/SwymUIComponents/script/feature/community/social-event/view/social-event-details-view"}),t]),e},_createCompactViewSection:function(){let t=this._parent();const i=this.model.get("content");let n=e.createElement("div",{class:"highlight-description",html:i});if(t&&t.html){let e=t.html.filter(e=>e&&"right-content-group"===e.class).map(e=>e&&e.html);(e=e.length&&e[0].filter(e=>e&&"lower-group"===e.class))&&e[0].html.push(n)}return t},_createContent:function(){var e=this.model,t=a.getInstance().feedMode===r.CTY_CONTENT_LIST_MODE.COMPACTVIEW_MODE;if(e)return this.show(),t?[this._createIconBackgroundSection(),this._createCompactViewSection()]:[this._createIconBackgroundSection(),this._createTitleSection(),{class:"content-body-section",html:this._createSummaryView()}];s.log("no model defined yet")}})}),define("DS/SwymUIComponents/script/feature/community/post/view/post-summary-view",["UWA/Core","DS/SwymUICore/script/feature/community/post/model/post-model","DS/SwymUIComponents/script/feature/community/content/view/content-summary-view"],function(e,t,i){"use strict";return i.extend({_modelClass:t,name:"post-summary-view"})}),define("DS/SwymUIComponents/script/feature/community/social-event/view/social-event-summary-view",["DS/SwymUICore/script/feature/community/social-event/model/social-event-model","DS/SwymUIComponents/script/feature/community/content/view/content-summary-view","DS/SwymUIComponents/script/feature/community/social-event/view/social-event-details-view","DS/SwymUICore/script/constants/community-constants","DS/SwymUIComponents/script/feature/community/social-event/view/badge-in-title-mixin"],function(e,t,i,n,o){"use strict";return t.extend({_modelClass:e,name:"social-event-summary-view",defaultOptions:{iconCls:"calendar",actionMenuOptions:{ReportAbuse:!1,Edit:!0,Delete:!0,ConvertToIdea:!1,FollowUnfollow:!0,Bookmark:!0,LeaveCommunity:!0,RssFeed:!0,pinToThisTab:!0,Subscribe:!0,highlight:!0}},setup:function(){return this.addChildView("details",{model:this.model,Class:i}),this._parent.apply(this,arguments)},_createSummary:function(){var e=this._parent(),t=e.html;return e.html=[this.getChildView("details"),t],e},_createContent:function(){var e=this._parent();return this._context.feedMode!==n.CTY_CONTENT_LIST_MODE.COMPACTVIEW_MODE&&e.push({tag:"div",class:"bottom-wrapper"}),e}},o)}),define("DS/SwymUIComponents/script/feature/community/wedo/view/wedo-summary-view",["UWA/Core","DS/SwymUICore/script/feature/community/wedo/model/wedo-model","DS/SwymUIComponents/script/feature/community/content/view/content-summary-view","DS/SwymUIComponents/script/feature/community/content/view/label-in-title-mixin","DS/SwymUIComponents/script/feature/community/wedo/view/wedo-author-section-view"],function(e,t,i,n,o){"use strict";return i.extend({_modelClass:t,name:"wedo-summary-view",defaultOptions:{onlyShowAttachmentsAndAssignees:!1,actionMenuOptions:{ConvertToIdea:!1,RssFeed:!0,ReportAbuse:!1,highlight:!1}},_createAuthorSection:function(){return this.addChildView("authorSectionView",new o({model:this.model,showThreadLink:this.getOption("showThreadLink"),onlyShowAttachmentsAndAssignees:!0===this.getOption("onlyShowAttachmentsAndAssignees")}))}},n)}),define("DS/SwymUIComponents/script/feature/community/wiki/view/wiki-summary-view",["DS/SwymUICore/script/feature/community/wiki/model/wiki-model","DS/SwymUIComponents/script/feature/community/content/view/content-summary-view"],function(e,t){"use strict";return t.extend({_modelClass:e,name:"wiki-summary-view"})}),define("DS/SwymUIComponents/script/feature/community/question/view/question-summary-view",["UWA/Core","DS/SwymUICore/script/feature/community/iquestion/model/iquestion-model","DS/SwymUIComponents/script/feature/community/content/view/content-summary-view","DS/SwymUIComponents/script/feature/community/question/question-view-mixin"],function(e,t,i,n){"use strict";return i.extend({_modelClass:t,name:"question-summary-view",validated:null,defaultOptions:{SocialFeaturesClassV2:"DS/SwymUIComponents/script/feature/community/question/social-interactions/social-features-for-question-view",isQuestionType:!0}}).extend(n)}),define("DS/SwymUIComponents/script/feature/community/idea/view/idea-summary-view",["UWA/Core","DS/SwymUICore/script/feature/community/idea/model/idea-model","DS/SwymUIComponents/script/feature/community/content/view/content-summary-view","DS/SwymUIComponents/script/feature/community/content/view/label-in-title-mixin"],function(e,t,i,n){"use strict";return i.extend({_modelClass:t,name:"idea-summary-view"},n)}),define("DS/SwymUIComponents/script/feature/community/content/utils/content-media-renderer",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUIComponents/script/feature/community/media/view/interactive-media-thumbnail-view","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/Logger/Logger","DS/WebappsUtils/WebappsUtils"],function(e,t,i,n,o,s,a,r){"use strict";var l={},c=null,d=t.extend({name:"content-media-renderer",defaultOptions:{createMediaView:{inContent:!0,position:"previous"},mediaViewClass:i,mediaInContentSelector:"img[data-media-id]",mediaIdAttributeInContent:"data-media-id",dataAttributesInContent:["creation_source"]},replaceStreammediaUrl:function(e){return e.replace(/src=".+?\/streammedia\/.+?"/gi,['src="',r.getWebappsBaseUrl(),'SwymUIComponents/assets/thumb.png"'].join(""))},_createMediaViews:function(e,t,i){var n,r,l,c,d={content:t},m=[],u=[],h={},p=this,g=void 0!==i.createMediaView?i.createMediaView:p.getOption("createMediaView"),w=i.mediaViewClass||p.getOption("mediaViewClass");if(e&&e.length>0&&e.forEach(function(e){(n=e.getAttribute(p.getOption("mediaIdAttributeInContent")))?(h.id=n,h.community_id=e.dataset.communityId,h.media_type=e.dataset.mediaType,h.media_file_ext=e.dataset.fileExtension?e.dataset.fileExtension:null,m.push(new o(h))):a.error("The id is not present for this media",e)}),m.length>0&&(c=new s(m),!1!==g))if(g&&!0===g.inContent&&"previous"===g.position)e.forEach(function(e){(n=e.getAttribute(p.getOption("mediaIdAttributeInContent")))&&t.contains(e)&&(r=c.get("media:"+n)||c.get(n))&&u.push(new w(r).render().inject(e,"before"))});else if(l=this._createMediaCollectionView(c,i),g&&!0===g.inContent){if("top"!==g.position&&"bottom"!==g.position&&"before"!==g.position&&"after"!==g.position)throw new Error("The content media could not be injected. Unknown position.");l.inject(t,g.position)}return e.forEach(function(e){e.destroy()}),void 0!==i.toReturn?(!0===i.toReturn.mediaCollection&&(d.mediaCollection=c),!0===i.toReturn.mediaZone&&(d.mediaZone=l),!0===i.toReturn.mediaViews&&(d.mediaViews=u),d):t},_createMediaCollectionView:function(e,t){return new(n.extend({bodyAttributes:{class:"content-media-collection-view media-zone"},modelViewClass:t.mediaViewClass||this.getOption("mediaViewClass")}))(e)},_renderMedia:function(t,i){var n,o;if("string"!=typeof t)throw new Error("The content to be processed should be a string");return t=this.replaceStreammediaUrl(t),o=(n=e.createElement("div",{html:t})).getElements(i.mediaInContentSelector||this.getOption("mediaInContentSelector")),(n=this._createMediaViews(o,n,i))instanceof HTMLElement&&1===n.childNodes.length&&(n=n.childNodes[0])instanceof HTMLElement&&(n=e.extendElement(n)),n},process:function(e,t){if(e)return this._renderMedia(e,t||{})}});return l.getInstance=function(){return c||(c=new d),c},l}),define("DS/SwymUIComponents/script/feature/community/content/utils/content-renderer",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUIComponents/script/feature/community/content/utils/content-media-renderer"],function(e,t,i){"use strict";var n,o,s=null,a={},r=(o=t.extend({processText:function(e){return e}}),{getInstance:function(){return n||(n=new o),n}}),l=t.extend({name:"content-renderer",_contentView:null,_contentViewModel:null,_renderers:null,defaultOptions:{contentAttributeInModel:"content",contentRenderers:["text","media"],textRenderer:r,mediaRenderer:i},setup:function(){var e,t=this;this._parent.apply(this,arguments),this._renderers=this._renderers||{},this.getOption("contentRenderers").forEach(function(i){!t._renderers[i]&&(e=t.getOption(i+"Renderer"))&&(t._renderers[i]=e.getInstance())}),this._parent.apply(this,arguments)},reset:function(){for(var e in this._renderers)this._renderers.hasOwnAttribute(e)&&this._renderers[e].destroy()},renderMedia:function(e,t){return this._renderers.media.process(e,t)},renderText:function(e,t){return this._renderers.text.processText(e,t)},render:function(e,t){var i,n,o=t||{};if(e)for(i in this._renderers)this._renderers.hasOwnProperty(i)&&(n=this["render"+i.substr(0,1).toUpperCase()+i.substr(1)](n||e,o));else n=e;return n}});return a.getInstance=function(){return s||(s=new l),s},a}),define("DS/SwymUIComponents/script/feature/community/content/social-interactions/patched-social-toolbar/patched-comment-editor-view",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SocialToolbar/Views/CommentEditorView","DS/SwymUIComponents/script/feature/community/content/utils/content-renderer","DS/SwymUICore/script/utils/localstorage-manager","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/rich-link-preview-generator","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/rich-link-preview-utils","DS/Logger/Logger"],function(e,t,i,n,o,s,a,r,l){t.extend({_modelName:"dummy-comment-model-for-3dcomment",_associations:{community:{Class:i}},getCommunity:function(){return this.getAssociated("community")}});var c=function(){var e=this.container&&this.container.getElement(".wait-upload-message-3dcomment");e&&e.destroy()},d=function(e,t){var i,n={},o=this.components.get("contentEditorMediaView"),s=(this.model||this.collection).getSubject().getSharedOptions().getOption("swymOptions");return s&&(!o||t&&!0===t.forceCreation)&&(n[s.commentTextAttribute]=e,(i=new s.commentModelClass(n,{commentType:s.model.getModelName()})).setAssociated(s.commentAssociationToParentModel,s.model),o=this.components.addMap({contentEditorMediaView:new s.mediaEditionViewClass({contentModel:i,contentAttributeInModel:s.contentAttributeInModel,parentModelAssociation:s.commentAssociationToParentModel,communityId:s.model.getCommunity()&&s.model.getCommunity().get("mid"),dragZoneSelector:s.dragZoneSelector,widget:s.widget})}).contentEditorMediaView,this.listenTo(o,{onMediaCollectionChange:function(){this._containsMedia()?this.container.addClassName("st-has-media"):this.container.removeClassName("st-has-media"),setTimeout(this._handleSendButtonVisibility.bind(this),100)}.bind(this),onMediaUploadsStart:function(){this._swymMediaUploadComplete=!1},onMediaUploadsComplete:function(){this._swymMediaUploadComplete=!0,c.call(this)},onCopyPaste:function(){this._triggerActionOnMediaIntoTextEditor(arguments[0],"remove")}.bind(this),onThumbnailRemoval:function(){this.placeCursorAt()},onInjected:function(){o._addDragDetection()}})),o},m=function(){var e;e=(this.collection?this.collection._target.id+"new":this.model?this.model.get("id")?this.model.get("id"):this.model.get("commentUri"):null)+"-comment",s.removeItem(e)},u=n.prototype._setRteData;n.prototype._setRteData=function(e){var t=this._getEditorElement();return t&&this.rte&&e instanceof HTMLElement?(t.setContent(e),void this.rte.updateElement()):u.apply(this,arguments)};var h=n.prototype._getMessageToDisplay;n.prototype._getMessageToDisplay=function(t){var i,n,a,r=o.getInstance().render(h.apply(this,arguments),{createMediaView:!1});return"string"==typeof r?(n=r,a=!0):n=e.createElement("div",{html:r}).getHTML(),this.extraAllowedContent&&n&&(n=this._filterContent(n,this.extraAllowedContent)),1===(r=e.createElement(!0===a?"p":"div",{html:n})).childNodes.length&&(r=e.extendElement(r.childNodes[0])),!e.is(t)&&this._isEditorEmpty({editorContent:r.outerHTML})&&(i=function(){var e=(this.collection?this.collection._target.id+"new":this.model?this.model.get("id")?this.model.get("id"):this.model.get("commentUri"):null)+"-comment",t=s.getItem(e);return t&&t.length>0&&(t=t.replace(/\n/gm,"<br />")),t}.call(this))?i:r};var p=n.prototype._getMessageToSave;n.prototype._getMessageToSave=function(){var e=p.apply(this,arguments);return e=r.convertURLPreviewToLink(e,!1)},n.prototype._removeMediaIntoTextEditor=function(e){var t;this.rte&&(t=this.rte.editable().findOne('img[data-media-pasted-id="'+e+'"]'))&&t.remove()},n.prototype._triggerActionOnMediaIntoTextEditor=function(e,t){require(["DS/SwymUICore/script/feature/community/media/model/media-model"],function(i){var n,o,s=this;e&&e.length>0&&e.forEach(function(e){e instanceof i?(n=e.get("userFile")||e.getChanges("userFile"),o=n&&n.info&&n.info.mediaPastedId,"remove"===t?s._removeMediaIntoTextEditor(o):"replace"===t&&l.log("impossible use case for comments on onpremise")):s._removeMediaIntoTextEditor(e.mediaPastedId)},this)}.bind(this))},n.prototype._onPaste=function(e){var t=[],i=e.data&&e.data.dataTransfer&&e.data.dataTransfer._&&e.data.dataTransfer._.files,n=e.editor.dataProcessor,o=new CKEDITOR.htmlParser.filter({elements:{img:function(e){var i=Math.random().toString(36).substring(7),n=e.attributes,o={src:n.src,mediaPastedId:i};n["data-media-pasted-id"]=i,t.push(o)}}}),s=n.toHtml(e.data.dataValue,{filter:o,fixForBody:!1});if(e.data.dataValue=s,t.length>0||i.length>0){var a,r=d.call(this,h.apply(this,arguments));t=t.length>0?t:i,r&&(a=r.getUploader("copyPaste"))&&a.getAndTransformMediaPasted(t)}},n.prototype._onOpenMediaLibraryRequest=function(){var e=this,t=(this.model||this.collection).getSubject().getSharedOptions().getOption("swymOptions");require(["DS/SwymUIComponents/script/feature/community/media/library/media-library-view"],function(i){var n=new i({communityId:t.model.getCommunity().get("mid"),widget:t.widget});n.injectInDom(),this.listenTo(n,{newMediaAdded:function(t){var i=t.newMedia,o=t.existingMedia,s=e.components.get("contentEditorMediaView");i&&Array.isArray(i)&&i.length>0&&s.addNMediaModels(i),o&&Array.isArray(o)&&o.length>0&&s.addNMediaModels(o),n.destroy(),e.placeCursorAt()}})}.bind(this))};var g=n.prototype._getMediaListToDisplay;n.prototype._getMediaListToDisplay=function(){var e=g.apply(this,arguments),t=d.call(this,h.apply(this,arguments),{forceCreation:!0});return[e,t?t.render():""]};var w=n.prototype._containsMedia;n.prototype._containsMedia=function(){var e=w.apply(this,arguments),t=this.components.get("contentEditorMediaView");return e||t&&t.collection&&t.collection.length>0};var C=n.prototype._getMediaHtmlToSave;n.prototype._getMediaHtmlToSave=function(){var e=C.apply(this,arguments),t=this.components.get("contentEditorMediaView");return e+(t?t.getHTMLToBeSaved():"")};var f=function(e,t){var i;!e||t&&t!==e.rte||(i=e._getEditorContent(),e._isEditorEmpty({editorContent:i})?m.call(e):function(e){var t,i,n=this._modelInstance?this._modelInstance.get("mid"):"";(i=this.collection?this.collection._target.id+"new":this.model?this.model.get("id")?this.model.get("id"):this.model.get("commentUri"):null)&&"string"==typeof e&&(t=i+"-comment"+n,s.setItem(t,e))}.call(e,i))},y=n.prototype.saveComment,v=n.prototype.onRteReady,A=n.prototype.cancelEdition,_=n.prototype.saveSnapShot,S=n.prototype.onSetRTEData;n.prototype.saveComment=function(){if(m.call(this),!1!==this._swymMediaUploadComplete||0===this.components.get("contentEditorMediaView").collection.length)return c.call(this),y.apply(this,arguments);(function(){var t,i,n=this.container;n&&(t=n.getElement(".st-editor-footer"),i=n.getElement(".wait-upload-message-3dcomment"),t&&!i&&(i=e.createElement("div",{class:"wait-upload-message-3dcomment",styles:{clear:"both"},html:CommentEditorViewNls.PleaseWaitMediaUploadNotOver}),t.addContent(i)))}).call(this)},n.prototype.onRteReady=function(){var e=this;return this.rte.on("change",function(){f(e,this)}),v.apply(this,arguments)},n.prototype.cancelEdition=function(){return m.call(this),A.apply(this,arguments)},n.prototype.saveSnapShot=function(){return f(this),_.apply(this,arguments)},n.prototype.onSetRTEData=function(){var e=this._getEditorElement();return a.createPreviewFromLink(e,!1,!0),S&&S()}}),define("DS/SwymUIComponents/script/feature/community/content/edit/content-edition-media-view",["UWA/Core","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUIComponents/script/feature/community/media/edit/thumbnail/smart-media-edition-thumbnail-view","DS/SwymUIComponents/script/feature/community/content/utils/content-media-renderer","DS/SwymUIComponents/script/feature/community/media/edit/upload/upload-manager","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/community/wedo/collection/attachment-collection","DS/SwymUIComponents/script/feature/community/media/edit/upload/drag-and-drop-upload-view","DS/SwymUIComponents/script/feature/community/media/edit/upload/copy-paste-upload-view","DS/SwymUIComponents/script/feature/community/media/edit/upload/media-upload-queue","DS/Logger/Logger","DS/SwymUIComponents/script/utils/content-upload-error","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/edit/content-creation-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/view/upload-manager-view"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g){"use strict";var w=function(e){return e.isUploading()};return i.extend({name:"content-edition-media-view",modelViewClass:n,mediaUploadQueue:null,_collectionEvents:{onRemove:"_onRemove","onSync:create":"onModelUploadComplete","onError:create":"onModelUploadFailure",onAdd:"_onAdd"},_collectionEventsForAutoRefresh:["onReset","onRemove","onSort"],_collectionClass:a,_simpleContent:null,_communityId:null,_uploadManager:null,_mediaRenderer:null,_context:null,defaultOptions:{uploadManagerClass:s,contentAttributeInModel:"content",allowDragNDrop:!0,dragZoneSelector:".content-edition",parentModelAssociation:null,contentModel:null,displayDragZoneView:!0},modelViewsCfg:function(e){var t={events:{onRemoveRequest:function(){this.removeThumbnail.apply(this,arguments)}.bind(this)}};return"attachment"===e.getModelName()&&(t.displayViewClass="DS/SwymUIComponents/script/feature/community/wedo/view/content-edition-attachment-thumbnail-view"),t},_onCommunityChange:function(){this.isDestroyed()||(this._context.isCommunityContext()?this._communityId=this._context.getData().communityId:this._communityId=null)},imageReloadOptions:{size:"m",imageKind:"thumb"},getMediaUploadQueue:function(){return this.mediaUploadQueue},setup:function(e){var i,n,s,r,l=[];if(i=this.getOption("uploadManagerClass"),this._uploadManager=new i({view:this,model:this.model}),this.listenTo(this._uploadManager,"onUpload",this._receivedFilesFromUploadManager),this.listenTo(this._uploadManager,"onProxyFailed",this._proxyFailed),this.listenTo(this._uploadManager,"on3DDriveMediaSelected",this._on3DDriveMediaSelected),this.mediaUploadQueue=m(),this._context=t.getInstance(),this._context.addListener("onCommunityChange",this._onCommunityChange,this),this._addCopyPasteUploader(),e.contentModel){if(this._simpleContent=e.contentModel,this._simpleContent.getModelName().contains("comment")||"iq-answer"===this._simpleContent.getModelName())if("iq-answer"===(r=this._simpleContent.getAssociated(this.getOption("parentModelAssociation"))).getModelName())s=r.getAssociated("answeredFor").getCommunity();else s=r.getCommunity();else s=this._simpleContent.getCommunity();this._communityId=s&&(s.get("mid")||s.id),delete e.contentModel}else this._context.isCommunityContext()?this._communityId=this._context.getData().communityId:e.communityId&&(this._communityId=e.communityId,delete e.communityId);this._simpleContent&&"attachments"===this.getOption("contentAttributeInModel")?(l=this._simpleContent.getAssociated("attachments").clone(),this._simpleContent.getAssociated("attachments").hasBeenFetchedAtLeastOnce||l.fetchDataFromFederatedSearch()):this._simpleContent&&(this._mediaRenderer=o.getInstance(),l=(n=this._mediaRenderer.process(this._simpleContent.getChanges(this.getOption("contentAttributeInModel"))||this._simpleContent.get(this.getOption("contentAttributeInModel")),{createMediaView:!1,toReturn:{mediaCollection:!0}}))&&n.mediaCollection),l&&l.length>0?this.setCollection(l):this.setCollection(new a),this._parent.apply(this,arguments)},setCommunityId:function(e){this._communityId=e},_on3DDriveMediaSelected:function(e){var t,i,n,o=!0;this._uploadManager.populateMediaFileExtension(function(){for(var s=0,a=e.length;s<a;s++)if(t=e[s],i=t.get("title"),1===(n=i?i.split("."):[]).length||!this._uploadManager._getType(n[n.length-1])){o=!1;break}e.length>0&&o?(this.addNMediaModels(e),this._dispatchMediaEvent(e)):o||this.alert("error",g.replace(g.get("FileTypeError"),{FileName:t.get("displayType")}))}.bind(this))},_receivedFilesFromUploadManager:function(t){var i,n,o,s,a=[],l=t?t.length:0;for(u.log("_receivedFilesFromUploadManager",t),i=0;i<l;i++)o=t[i],s={is_illustration:"media"!==this.getOption("contentAttributeInModel")},this._communityId&&(s.community_id=this._communityId),(n=new r({})).addChanges(e.extend(s,o.attributes)),a.push(n);this.addNMediaModels(a),a.length>0&&this._dispatchMediaEvent(a)},_proxyFailed:function(e){this.dispatchEvent("onCopyPaste",[e])},_dispatchMediaEvent:function(e){var t=e[0].get("userFile")||e[0].getChanges("userFile"),i=t&&t.info&&t.info.mediaPastedId?"onCopyPaste":"onDragAndDrop";this.dispatchEvent(i,[e])},_uploadMediaViaQueue:function(e){var t,i=this;(t=(e=e||{}).mediaToBeUploaded||[]).length>0?(this.dispatchEvent("onMediaUploadsStart"),this.mediaUploadQueue({mediaToBeUploaded:t,onUploadsComplete:function(){e.onUploadsComplete&&e.onUploadsComplete({mediaMarkup:i.getHTMLToBeSaved()})},onUploadsFailure:function(t){e.onUploadsFailure&&e.onUploadsFailure(t)},wait:!0})):e.onUploadsComplete&&e.onUploadsComplete()},addNMediaModels:function(e){var t,i,n,o=[];if(Array.isArray(e)&&e.length>0&&(this.collection.add(e),this._appendNewModelView.apply(this,arguments),this.dispatchEvent("onMediaCollectionChange",[this.collection]),this._communityId)){for(t=0,i=e.length;t<i;t++)(n=e[t]).isNew()&&(n.set("community_id",this._communityId),o.push(n));this._uploadMediaViaQueue({mediaToBeUploaded:o,onUploadsFailure:function(e){u.log("onUploadsFailure"),h.printErrorMessage(e,"media")}.bind(this)}),this.dispatchEvent("newMediaAdded")}},getCollectionLength:function(){var e=0;return this.collection&&(e=this.collection.length),e},getCollection:function(){return this.collection},_addCopyPasteUploader:function(){var e;this.getChildView("copyPaste")||(e=this.addChildView("copyPaste",{Class:d,events:{onMediaUploadsStart:function(){this.dispatchEvent("onMediaUploadsStart",[!0])}.bind(this),onMediaUploadsComplete:function(){this.dispatchEvent("onMediaUploadsComplete")}.bind(this),onMediaUploadsFailure:function(){this.dispatchEvent("onMediaUploadsFailure")}.bind(this)}}),this.addUploader("copyPaste",e))},_getDndView:function(){var e=this.getChildView("dnd");return e||!0!==this.getOption("allowDragNDrop")||(e=this.addChildView("dnd",{Class:c}),this._uploadManager.addUploader("dnd",e)),e},refreshDragDetection:function(){this.getChildView("dnd")&&(this._removeDragDetection(),this._addDragDetection())},stopDragDetection:function(){this.getChildView("dnd")&&this._removeDragDetection()},getDndView:function(){return this._getDndView()},addUploader:function(e,t){this._uploadManager.addUploader(e,t)},getUploader:function(e){return this._uploadManager.getUploader(e)},_onRemove:function(){this.dispatchEvent("onMediaCollectionChange",[this.collection])},_onAdd:function(e){"attachment"===e.getModelName()&&this._appendNewModelView([e])},_appendNewModelView:function(e){var t;this._body&&this.container.contains(this._body)?(t=this,e&&e.forEach(function(e){var i=t._createAndAddModelView(e);t._modelViewsKeys.push(t.MODEL_VIEWS_INDEX_PREFIX+i.cid),i.render({target:t._body,position:"bottom"})})):this.refresh()},_createContent:function(){var e=this._getDndView();return[this._parent.apply(this,arguments),!0===this.getOption("displayDragZoneView")?e:""]},_addDragDetection:function(){!0===this.getOption("allowDragNDrop")&&this.getOption("dragZoneSelector")&&this._getDndView().addDragDetectionZone(this.container.getClosest(this.getOption("dragZoneSelector")))},_removeDragDetection:function(){var e=this._getDndView();e&&e.removeDragDetectionZone()},getHTMLToBeSaved:function(){var e,t,i,n,o,s,a,r,l,c,d,m,u="",h=!0===this.getOption("isMediaForSimpleContent");for(e=0,t=this.collection.length;e<t;e++)s=(n=(i=this.collection.at(e)).getCommunity()).isDirectMessage(),l=(o=n.get("mid")||n.id)?s?'data-dm-id="'+o+'"':' data-community-id="'+o+'"':"",r=i.get("mid")?' data-media-id="'+i.get("mid")+'"':' data-new_media="true"',r+=' data-media_cid="'+i.cid+'"',c=1===t&&h?"large":"small",d=1===t&&h?"center":"left",a="pdf"===i.get("media_file_ext")||i.get("userFile")&&"application/pdf"===i.get("userFile").type||i.get("orig_name")&&i.get("orig_name").match(/.pdf$/gi)?"pdf":"",m=1===t&&h?"520":"320",u+='<img data-source="swym" '+l+r+" data-position="+d+" data-size="+c+' data-media-type="'+i.get("media_type")+(""!==a?'" data-file-extension="'+a:"")+'" style="width:'+(i.get("width")||m)+"px;"+(i.get("height")?"height:"+i.get("height")+"px":"")+'">';return u},reset:function(){this.collection.length>0&&this.setCollection(new a),this.mediaUploadQueue=m()},removeThumbnail:function(e){e&&(this.collection.remove(e),e.isNew()&&e.dispatchEvent("removeFromUploadQueue",[e]),this.dispatchEvent("onThumbnailRemoval",[e]))},onModelUploadComplete:function(){0===this.collection.filter(w).length?(this.dispatchEvent("onMediaUploadsComplete"),u.log("Uploads complete")):u.log("still uploading....")},onModelUploadFailure:function(e){this.dispatchEvent("onMediaUploadsFailure",[e])},uploadAllMediaInCommunity:function(e){var t=this,i=(e=e||{}).communityId||this._communityId,n=e.onUploadsFailure;i?(e.mediaToBeUploaded=this.collection.filter(function(e){var n=e.isNew(),o=e.hasVirtuallyChanged();return n&&!t._communityId&&e.set("community_id",i),n||o}),this._uploadMediaViaQueue(e)):(n&&n(),u.error("No community found to upload media in"))},destroy:function(){this._onCommunityChange&&this._context.removeListener("onCommunityChange",this._onCommunityChange,this),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/content-editor-body-view-with-rte",["UWA/Core","UWA/Event","UWA/String","DS/SwymUICore/script/utils/utils","DS/SwymUIComponents/script/feature/community/content/edit/abstract-content-editor-body-view","DS/SwymUIComponents/script/feature/community/content/view/simple-editor-with-media-view","DS/SwymUIComponents/script/feature/community/content/edit/content-edition-media-view","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/rich-link-preview-utils","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/edit/content-creation-view"],function(e,t,i,n,o,s,a,r,l){"use strict";return o.extend({_rteContent:null,_context:null,_editorIsReady:!1,_modelEvents:{"onChange:content":"_setEditorContent"},name:"content-editor-body-view-with-rte",domEvents:{"click .rte-wrapper .editable-container":"onRTEFocus","focusin .rte-wrapper .editable-container":"onRTEFocus","click .rte-wrapper .placeholder":"onRTEFocus","focusin .rte-wrapper .placeholder":"onRTEFocus","blur .rte-wrapper .editable-container":"onRTEInput","keyup .rte-wrapper .editable-container":"onRTEInput","paste .rte-wrapper .editable-container":"onRTEInput","drop .rte-wrapper .editable-container":"onRTEInput","input .rte-wrapper .editable-container":"onRTEInput"},defaultOptions:{allowDragNDrop:!0,modelAttr:"content",modelAttrForMedia:"content",contentEditorView:null,mediaInsertion:!0,mode:"simpleRTE"},_setEditorContent:function(e){var t=this.getChildView("rte");t&&("string"==typeof e?t.switchToRTE(e):t.switchToRTE(this.model.get("content")))},_getMediaEditionView:function(){var e,t=this.getChildView("mediaEdition");return t||(e={communityId:this.getCommunityId()||void 0,Class:a,contentAttributeInModel:this.getOption("modelAttrForMedia"),isMediaForSimpleContent:"simpleRTE"===this.getOption("mode"),dragZoneSelector:this.getOption("dragZoneSelector"),displayDragZoneView:"simpleRTE"===this.getOption("mode"),contentModel:this.model},(t=this.addChildView("mediaEdition",e))&&this.listenTo(t,{onMediaCollectionChange:this.onMediaCollectionChange,onMediaUploadsStart:function(){this.dispatchEvent("onMediaUploadsStart",arguments)},onMediaUploadsComplete:function(){this.dispatchEvent("onMediaUploadsComplete")},onMediaUploadsFailure:function(e){this.dispatchEvent("onMediaUploadsFailure",[e])},onDragAndDrop:function(){this.dispatchEvent("onDragAndDrop",arguments)},onCopyPaste:this._onCopyPaste})),t},_getRTEElt:function(){return this.getElement(".rte-wrapper .editable-container")},clearUndoTextInEditor:function(){var e=this.getRTEView().ckeditor;e&&e.resetUndo&&e.resetUndo()},_isRTEContentEmpty:function(){var e=!0;return(i.unescapeHTML(this.getRTEContent()).trim().length>0||this.getElement(".rte-wrapper .editable-container img"))&&(e=!1),e},isContentEmpty:function(){var e=!0,t=this.getMediaCollectionLength();return(!this._isRTEContentEmpty()||t>0)&&(e=!1),e},getContentAttributes:function(){return{content:this.getRTEContent()+this._getMediaEditionView().getHTMLToBeSaved()}},treatHTML:function(e){return e.replace(/\u200B/g,"").replace(/(\u00A0|&nbsp;)(?!$)(?!<br>)(?!<\/)/g," ")},getRTEContent:function(){var e=this._getRTEElt(),t="";return e&&(t=this.treatHTML(e.getHTML())),t},resetContent:function(){this.model&&!this.model.get("mid")&&(this.stopReactingTo(this.model),this.model=null),this.getRTEView().resetEditor(),this._getMediaEditionView().reset()},removeTagsFromContent:function(){this.getRTEView().removeTagsInContent()},_getDndView:function(){var e="";return this._getMediaEditionView()&&(e=this._getMediaEditionView().getDndView()),e},refreshDragDetection:function(){return this._getMediaEditionView().refreshDragDetection()},stopDragDetection:function(){if(this._getMediaEditionView())return this._getMediaEditionView().stopDragDetection()},refreshContent:function(e,t){var i=this.getRTEView();i.switchedToRTE()?i.updateEditor(e.content):i.switchToRTE(e.content,!0,"simpleRTE"),t&&(this._getMediaEditionView().setCollection(t),this._getMediaEditionView().refresh())},getMediaCollection:function(){return this._getMediaEditionView().collection},getMediaCollectionLength:function(){return this._getMediaEditionView().getCollectionLength()},uploadMedia:function(e){var t=this._getMediaEditionView();e=e||{},this.getMediaCollectionLength()>0&&t.uploadAllMediaInCommunity({communityId:e.communityId||this.getCommunityId(),onUploadsComplete:e.onUploadsComplete,onUploadsFailure:e.onUploadsFailure})},addMedia:function(e){var t,i,n=this._getMediaEditionView();if(this.getCommunityId())for(t=0,i=e.length;t<i;t++)e[t].set("community_id",this.getCommunityId());n.addNMediaModels(e)},onMediaCollectionChange:function(){this.contentChanged()},_onCopyPaste:function(e){var t=this.getRTEView();t&&t.triggerActionOnMediaIntoTextEditor(e,"remove"),this.dispatchEvent("onCopyPaste",arguments)},_createRTESection:function(){return{class:"rte-wrapper","data-height":"20px",html:this.getRTEView()}},_createContent:function(){return[this._createRTESection(),this.getOption("mediaInsertion")?this._getMediaEditionView():""]},onRTEFocus:function(e){var i=t.getElement(e).getHTML();this.getRTEView().switchToRTE(void 0,void 0,void 0,{focus:!0}),this._rteContent=i},onRTEInput:n.throttle(function(e){var i=t.getElement(e).getHTML(),n=!1;i!==this._rteContent&&(n=!0),this._rteContent=i,n&&this.contentChanged()},200),getRTEView:function(){var t=this,i=this.getChildView("rte");return i||(i=this.addChildView("rte",e.extend({Class:s,model:this.model,modelAttr:this.options.modelAttr,activateInline6WTagging:!0},this.getOption("rteViewOptions"))))&&(i.addEventOnce("editorIsReady",function(){t._editorIsReady=!0,t.dispatchEvent("editorIsReady")}),t.listenTo(i,{onMediaPaste:function(){if(!0===this.getOption("mediaInsertion")){var e=this._getMediaEditionView().getUploader("copyPaste");e&&e.getAndTransformMediaPasted(arguments)}else this.alert("warn",l.MediaPasteInsertionNoRights)}.bind(this),onEnterKeyPressed:function(){t.dispatchEvent("onEnterKeyPressed")},onSwymImgPaste:function(){t.dispatchEvent("onSwymImgPaste")},onBackspaceKeyPressed:function(){t.dispatchEvent("onBackspaceKeyPressed")},onInsertElementInCKEditor:function(){t.contentChanged()},onEmojiInsert:function(){t.contentChanged()},onMentionInsert:function(){t.contentChanged()},onPlaceholderAdded:function(){this.dispatchEvent("onPlaceholderAdded")},onPlaceholderRemoved:function(){this.dispatchEvent("onPlaceholderRemoved")}}),i.render()),i},executeWhenRTEIsReady:function(e){!0===this._editorIsReady?e.call(this):this.addEventOnce("editorIsReady",e)},validateContent:function(){var e=this._parent();return!1===e?this.container.addClassName("invalid"):this.container.removeClassName("invalid"),e}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/content-editor-body-view-with-advanced-rte",["UWA/Core","DS/SwymUIComponents/script/feature/community/content/edit/content-editor-body-view-with-rte","DS/SwymUIComponents/script/utils/media-utils"],(e,t,i)=>{function n(t,i){const n=i;let o,s;e.Utils.Client.Engine.ie&&t&&t.dataset.containerWidth&&(o=parseInt(t.dataset.containerWidth,10),n&&n.getStyle("width")&&(s=parseInt(n.getStyle("width"),10))>o&&(n.dataset.originalWidth=n.getStyle("width"),n.setStyle("width",`${t.dataset.containerWidth}px`)))}return t.extend({name:"content-editor-body-view-with-advanced-rte",defaultOptions:{mode:"advancedRTE",rteViewOptions:{mode:"advancedRTE",restrictUserMentionAutocompleteDisplayZoneToTextEditor:!0,events:{onResetEditor(){const e=this.elements;e&&Object.keys(e).forEach(t=>{t.indexOf("swym-b64-img-style-")>=0&&e[t].destroy()})}}}},domEvents:{resize:"updateContainerSize"},updateContainerSize(){const e=this.container&&this.container.getSize();e&&e.width&&(this.container.dataset.containerWidth=e.width,this.container.getElements("img").forEach(e=>{n(this.container,e)}))},init(...e){this._parent(...e),this.addEventOnce("editorIsReady",()=>{this.getRTEView()&&require(["DS/SwymUIComponents/script/feature/community/content/edit/extra-text-editor-factory","DS/SwymUIComponents/script/feature/community/content/edit/media-layout-editor-factory"],(e,t)=>{t.activateEditorDisplay({domElt:this.getRTEView()&&this.getRTEView().container,editorView:this,getContent:()=>this.model}),e.activateEditorDisplay({domElt:this.getRTEView()&&this.getRTEView().container,extraTextEditorId:"extra_text_editor",editorView:this})})}),this.addEvent("mediaEdited",this._saveImageChanges.bind(this))},_saveImageChanges(e){const{model:t}=e,i=()=>{this.alert("error","an error has occured"),this.unmask()};e.isNewMedia?this._updateImageTagAfterEdition(e):t.save({published:1,notify:"publish"},{onComplete:this._updateImageTagAfterEdition.bind(this,e),onFailure:i.bind(this)})},_updateImageTagAfterEdition(t){const i=e.createElement("div",{html:this.getRTEContent()}),{model:n}=t,o=n.get("mid"),{cid:s}=n,a=n.getChanges("userFile")||n.get("userFile"),r=n.getChanges("width")||n.get("width"),l=i.getElement(`img[data-media-id="${o}"]`)||i.getElement(`img[data-media_cid="${s}"]`);if(l.src=a,l.setStyle("width",r),t.isNewMedia){i.getElements("img").forEach(e=>{e.getAttribute("data-new_media")||e.setAttribute("data-image-timestamp",(new Date).getTime())})}else l.setAttribute("data-image-timestamp",(new Date).getTime());this.getRTEView().updateEditor(i.innerHTML),this.unmask()},_createContent(){return[!0===this.getOption("allowDragNDrop")?this._getDndView():null,this._createRTESection(),this.getControl("extra_text_editor")]},refreshDragDetection(){this._getDndView()&&(this.stopDragDetection(),this._addDragDetection())},_addDragDetection(){!0===this.getOption("allowDragNDrop")&&this._getDndView().addDragDetectionZone(this.getOption("dragZoneSelector")?this.container.getClosest(this.getOption("dragZoneSelector")):this.container)},onMediaUploadsFailure(e){if(e&&e.cid){const t=this.container.getElement(`img[data-new_media="true"][data-media_cid=${e.cid}]`);t&&t.remove()}},getModelAttribute(e,t){let i=null;return e&&t&&(i=e.getChanges(t)||e.get(t)),i},getContentAttributes(){let t=this.getRTEContent();const i=this.getMediaCollection();let n,o,s,a;const r=[],l=e.createElement("div",{html:t}),c=l.getElements("table[data-cke-table-faked-selection-table]");c.forEach(e=>{e.removeAttribute("data-cke-table-faked-selection-table")});const d=l.getElements(".cke_table-faked-selection");return d.forEach(e=>{e.removeClassName("cke_table-faked-selection")}),i&&i.length>0?((o=[...l.getElements('img[data-new_media="true"][data-media_cid]'),...l.getElements("img[data-media-id]")]).forEach(e=>{const t=e;s=t.getAttribute("data-media_cid")||t.getAttribute("data-media-id"),r.push(s),(n=i.get(s)||i.find(e=>e.get("mid")===s))&&((a=this.getModelAttribute(n,"mid"))&&(t.dataset.mediaId=a),(t.src&&t.src.contains("data:image/")||a)&&t.setAttribute("src",""),t.removeAttribute("style"),t.removeAttribute("class"),t.removeAttribute("data-new_media"),t.removeAttribute("data-media_cid"),t.removeAttribute("data-cke-saved-src"))}),i.forEach(e=>{!e.isBeingFetched()&&e.isNew()&&-1===r.indexOf(e.cid)&&i.remove(e)},this),t=l.getHTML()):(c.length||d.length)&&(t=l.getHTML()),{content:t}},treatHTML:e=>e,isContentEmpty(){return this._isRTEContentEmpty()},updateImgTagsLayout(t,n,o){if(!e.is(o,"function"))throw new Error("A callback is required");const s=this.getRTEView();let a=0;const r=t&&t[this.options.modelAttr];let l=r;const c=this.getMediaCollection(),d=e.createElement("div",{html:r}),m=d.getElements("img[data-media_cid]");n&&c&&c.reset(n.toArray()),m.length>0?m.forEach(e=>{const t=c.get(e.getAttribute("data-media_cid"));if(!t)throw new Error("New image is not present in uploaded media collection!");i.getImageTagFromMedia(t,i=>{s.getImgTagToInsertIntoEditor(i,(i,n)=>{const r={};s.replaceBase64ImageSrcWithCSSClass(i,n,t),e.dataset.size&&(r["data-size"]=e.dataset.size),e.dataset.position&&(r["data-position"]=e.dataset.position),i.set(r),i.inject(e,"before"),setTimeout(()=>{e.remove(),(a+=1)===m.length&&(l=d.getHTML(),o.call(this,l))},0)})})},this):o.call(this,l)},resetContent(){const e=this.model?this.getModelAttribute(this.model,this.options.modelAttr):"";this.getRTEView().isEmptyRTEContent(e)?this.getRTEView().resetEditor():this.getRTEView().updateEditor(e)},refreshContent(e,t){this.updateImgTagsLayout(e,t,e=>{const t=this.getRTEView();t.switchedToRTE()?t.updateEditor(e):t.switchToRTE(e,!0,this.options.mode)})},insertMediaIntoTextEditor(e){const t=this.getRTEView();e&&e.length>0&&e.forEach(e=>{i.getImageTagFromMedia(e,i=>{n(this.container,i),t.insertMediaIntoTextEditor(null,i,e)})})},addMedia(e,...t){let i;return e&&e.length>0&&(i=this._parent(e,...t),this.insertMediaIntoTextEditor(e)),i},_onCopyPaste(e){const t=this.getRTEView();t&&t.triggerActionOnMediaIntoTextEditor(e,"replace")},onDragAndDrop(e){this.insertMediaIntoTextEditor(e)},onMediaCollectionChange(){}})}),define("DS/SwymUIComponents/script/feature/core/user/view/add-member-panel-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/member-set-view","i18n!DS/SwymUIComponents/assets/nls/feature/core/search/view/user-search-view","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/SwymUICore/script/feature/community/member/model/mixin/community-member","DS/W3DXComponents/Views/Item/PanelAddMemberView","DS/SwymUIComponents/script/feature/core/search/view/bot-search-factory","DS/SwymUICore/script/utils/utils","DS/SwymUIComponents/script/utils/feature-activation-manager","DS/UWPClientCode/I18n"],function(e,t,i,n,o,s,a,r,l,c,d){"use strict";return n.extend({name:"add-member-panel-view",_asAdmin:!1,_mailAllowed:!0,_userCollection:null,setup:function(t){var i;if(t&&e.is(t.asAdmin)&&(this._asAdmin=t.asAdmin),t&&e.is(t.mailAllowed,"boolean")&&(this._mailAllowed=t.mailAllowed),i=this._parent.apply(this,arguments),!this.collection)throw new Error("Member collection is required");return i},_parseUserData:function(e){return"0"===e.ut_state&&""===e.nickname.trim()&&(e.nickname=e.ut_invitation_email),"1"===e.user_tenant_status&&(e.nickname+=" ("+i.Contractor+")"),e},_findPotentialMembers:function(e){var t=this;if(this.collection){if(this._userCollection||(this._userCollection=new o([],{communityId:this.collection.getAssociated("owned").get("mid"),limit:10,mode:"searchbyname"})),!e.onComplete)throw new Error("onComplete option is missing");return this._userCollection.fetch({data:e.data,onComplete:function(i,n){n.result.forEach(t._parseUserData),e.onComplete.call(this,n&&n.result)},onFailure:e.onFailure})}},_getBasicOptions:function(){var e=this;return{categories:[{id:"contributor",name:t.Contributor},{id:"author",name:t.Author,isDefault:"true"},{id:"owner",name:t.Owner}],minLength:3,unlockDistinctClick:!0,getSuggestions:function(t,i,n){if(t){if(this._suggestRequest&&this._suggestRequest.cancel(),!i[t])return this.options.suggestRequestData[this.options.suggestTextAttribute]=t,this._suggestRequest=e._findPotentialMembers({data:this.options.suggestRequestData,onComplete:function(e){n(JSON.stringify(e||[]))}}),this._suggestRequest;n(i[t])}},suggestDistinction:function(e){var i=!1;if(!0===e.is_member||e["ds6w:role"]){switch(e.acc&&parseInt(e.acc,10)||e["ds6w:role"]&&parseInt(s.getCommunityRoleFromExaleadRole(e["ds6w:role"]),10)){case 1:i=t.Contributor;break;case 2:i=t.Author;break;case 3:i=t.Owner}return i}},saveProcess:function(i){for(var o,s,a="",r=0;r<i.length;r++){switch((o=i[r]).categoryId){case"contributor":s=1;break;case"author":s=2;break;case"owner":s=3;break;default:continue}a=a+";"+(o.prevDistinction?"update":"add")+","+o.selection+","+s}var l=e.getControl("bot-search-control");l&&l.getValue()&&l.getValue().split(";").forEach(function(e){a=a+";add,"+e+",1"}),a.length>0&&e.collection.getAssociated("owned").action("editmembers",{data:{settings_members:a,as_admin:!!e._asAdmin&&e._asAdmin},onComplete:function(){this.collection.dispatchEvent("onRefreshing"),n.prototype.alert("success",t.Yourchangeshavebeensaved)}.bind(e),onFailure:function(e,t){i.length>1&&"ERROR_COMMUNITY_MAIN_OWNER_CHANGE_ROLE_FORBIDDEN"===t.errorcode&&this.collection.dispatchEvent("onRefreshing")}.bind(e)})}}},_onEmailAddress:function(t){return e.is(this._mailAllowed,"function")&&(this._mailAllowed=this._mailAllowed()),e.is(this._mailAllowed)?{nickname:t,"ds6w:label":t,hash_key:t}:null},_getExtraOptions:function(){return{suggestUrl:l.getBaseUrl()+"/api/user/search",suggestRequestData:{locale:d.getCurrentLanguage(),as_admin:this._asAdmin},suggestTextAttribute:"query",suggestFormat:"{nickname}",suggestKey:"hash_key",labelFormat:"{nickname}",onEmailAddress:this._onEmailAddress.bind(this)}},getOptionsForW3DXAddMemberPanelView:function(){return e.extend(this._getBasicOptions(),this._getExtraOptions())},_getAddPanelBot:function(){return e.createElement("div",{class:"add-bot-panel",html:[{tag:"h4",html:t.Addbots},this.addControl("bot-search-control",r.createBotSearchControl({events:{onSelect:function(){console.log("A bot has been selected")}.bind(this)}}))]})},_createContent:function(){var e;if(this.collection){if((e=new a(this.getOptionsForW3DXAddMemberPanelView())).show(),this._childViews&&this._childViews.w3dxAddMemberPanelView){if("function"!=typeof this._childViews.w3dxAddMemberPanelView.destroy)throw new Error('The old child view "members" cannot be destroyed');this._childViews.w3dxAddMemberPanelView.destroy()}return this._childViews.w3dxAddMemberPanelView=e,[e,c.isFeatureActivated("activateBots")?this._getAddPanelBot():""]}throw new Error("User Collection does not exist")}})}),define("DS/SwymUIComponents/script/feature/community/content/social-interactions/edit/comment-edition-media-view",["UWA/Core","DS/SwymUIComponents/script/feature/community/content/edit/content-edition-media-view","DS/SwymUIComponents/script/utils/content-upload-error","DS/Logger/Logger"],function(e,t,i,n){"use strict";return t.extend({name:"comment-edition-media-view",onMediaUploadsFailure:function(e,t){i.printErrorMessage(t,"media")},addNMediaModels:function(e){for(var t=0,i=e.length;t<i;t++)e[t].addChanges("published","1");this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/content/social-interactions/social-toolbar-view",["UWA/Core","UWA/Class/Events","UWA/Promise","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/constants/community-constants","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUIComponents/script/feature/community/content/social-interactions/social-features-view","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUIComponents/script/feature/community/content/social-interactions/edit/comment-edition-media-view","DS/SwymUICore/script/feature/community/comment/model/comment-model","DS/SwymUICore/script/utils/usage-tracker","DS/SwymUICore/script/utils/platform-utils","DS/SwymUIComponents/script/utils/feature-activation-manager","DS/SwymUICore/script/utils/compass-proxy"],(e,t,i,n,o,s,a,r,l,c,d,m,u,h)=>{let p=null,g=!1,w=!1;const C=r.getInstance(),f=s.getInstance(),y=window.ds&&window.ds.isMDE,v=t.singleton({});return a.extend({_modelEvents:{"onChange:subject6wuri":"refresh","onChange:status_id":"onModelStatusIdChange","onChange:out":"onOutStatusChange"},_lastSubjectUri:"",name:"social-toolbar-view",defaultOptions:{actionBar:!1,comments:!1,socialToolbarMode:"normal",enableShare:null,enableComment:!0,enableLike:!0,commentsNumberAtInit:2,showCommentsSummaryFirst:!0,sendCommentsInitCallInPool:!1,commentButtonClickEventIsOverrided:!1,serviceURL:null,socialToolbarExtraOptions:{commentModelClass:c,commentTextAttribute:"comment",contentAttributeInModel:"comment",commentAdditionEvent:"addComment",commentAssociationToParentModel:"commented",mediaEditionViewClass:l,dragZoneSelector:".st-comment-editor"}},init(e){return this._recreateSocialToolbarOnNavigationRequest=this._recreateSocialToolbarOnNavigationRequest.bind(this),this.onAnnotationShared=this.onAnnotationShared.bind(this),e.annotationsEventBus&&(this.annotationsEventBus=e.annotationsEventBus,this.annotationsEventBus.addEvent("onAnnotationShared",this.onAnnotationShared)),this._parent.apply(this,arguments)},setup(e){return e&&(e.actionBar=!1,e.comments=!1,this.setOptions(e)),this.model&&this.model.getCommunity()&&"dm"===this.model.getCommunity().get("community_type")&&this.setOption("enableShare",!1),this._parent.apply(this,arguments)},onMediaClick(e){e&&"annotation"===e.type&&this.annotationsEventBus&&this.annotationsEventBus.dispatchEvent("onLoadAnnotationRequest",e,!0)},_createContent(){return this.elements.wrapper||(this.elements.wrapper=e.createElement("div",{class:"social-toolbar-wrapper"})),this.elements.wrapper},_share(){const{model:e}=this,t=this._widget;require(["DS/SwymUIComponents/script/feature/core/share/view/share-content-view"],i=>{new i({model:e,widget:t}).launchModal()}),d.trackPageEvent({category:"SocialToolbar",label:"share",view:"social-toolbar-view",event:"click",contentType:this.model.getModelName()})},_recreateSocialToolbarOnNavigationRequest(){this.model&&f.contentId&&f.commentUri&&f.commentUri.indexOf(this.model.get("subject6wuri"))>=0&&this.isVisible()&&this.getControl("socialToolbar")&&this._createSocialToolbar()},onAnnotationShared(e){const t=this.getControl("socialToolbar"),i=e&&e.annotation;let n;t&&i&&(t.setActiveFieldContent({media:[e.annotation],replace:!1}),setTimeout(()=>{(n=t.getElement(".st-comment-creator-root"))&&n.scrollIntoView()},100))},_createSocialToolbar(t){if(y){const e=this.model.get("sourceid");if(e){const i=e.split(":");if("drive"===i[0])m.get3DDriveURL(i[1],e=>{this.options.serviceURL=`${e}/resources`,this._createSocialToolbarWithProperServiceUrl(t)});else if("dashboard"===i[0]){this.options.enableShare=!1;const e=C.get("config").tenant.online_instance_id;h.getServiceUrl({platformId:e,serviceName:"3DDashboard",onComplete:e=>{this.options.serviceURL=e,this._createSocialToolbarWithProperServiceUrl(t)}})}else this._createSocialToolbarWithProperServiceUrl(t)}else this._createSocialToolbarWithProperServiceUrl(t)}else{let i,o,s,a;this.isVisible()?(a=this.model&&this.model.get("subject6wuri"),this.model&&this.model.get("model_uri")&&(a=this.model.get("model_uri")),this.elements&&this.elements.wrapper&&a&&(this._lastSubjectUri!==a||t&&!0===t.force)&&(o=this,s=n.getBaseUrl(),require(["DS/SwymUIComponents/script/lib/ckeditor/ckeditor"],r=>{o.isDestroyed()||(o._lastSubjectUri=a,i=C.get("user"),o.addControl("socialToolbar",new p({sendInitCallInPool:o.options.sendCommentsInitCallInPool,tenantId:C.get("config").tenant.online_instance_id,"3DSwymURL":s,"3DSwymServerToken":C.getCSRFToken(),userLogin:i.login,userName:`${i.first_name} ${i.last_name}`,serviceURL:C.get("3dcommentUrl")||n.getBaseUrl(),mode:o.options.socialToolbarMode,subjectURI:a,commentsNumberAtInit:o.options.commentsNumberAtInit,enableShare:e.is(o.getOption("enableShare"),"boolean")?o.getOption("enableShare"):C.isFeatureActivated("activate_share"),enableComment:o.getOption("enableComment"),enableLike:o.getOption("enableLike"),enableCommentLike:!0,showSendButton:Boolean(u.isFeatureActivated("activateCommentSendButton")),showUserProfile(e){require(["DS/SwymUICore/script/utils/navigation"],t=>{t.goToProfile({login:e})})},commentButtonClickEventIsOverrided:o.getOption("commentButtonClickEventIsOverrided"),enableUpload:!(o.model&&"wedo"===o.model.getModelName()),RTEConfig:r.getNewCommentEditorConfig(),showCommentsSummaryFirst:o.getOption("showCommentsSummaryFirst"),sendInitCallEvenIfSubjectIsInCache:t&&!0===t.force,commentToScrollToAtInit:f.commentUri&&f.commentUri.indexOf(a)>=0?{commentUri:f.replyUri||f.commentUri,parentCommentUri:f.replyUri&&f.commentUri}:null,commentProxyToken:{header:"X-DS-CSRFTOKEN"},events:{onShareRequest:o._share.bind(o),onMediaClick:o.onMediaClick.bind(o),onBeforeRender(){this.model?this.model.getSharedOptions().setOptions({swymOptions:e.merge({model:o.model,widget:this._widget||window.widget},o.getOption("socialToolbarExtraOptions"))}):console.error("Failed to initialize Social toolbar instance")},onRender(){const{model:e}=this;this.dispatchEvent("onCommentCountChange",[e.getCommentsTotalCount()]),this.listenTo(e,`onChange:${e.COMMENTS_COUNT_ATTRIBUTE}`,function(e,t){this.dispatchEvent("onCommentCountChange",[t])}),this.dispatchEvent("onEndorsementCountChange",[e.getEndorsementsTotalCount()]),this.listenTo(e,`onChange:${e.ENDORSEMENT_COUNT_ATTRIBUTE}`,function(e,t){this.dispatchEvent("onEndorsementCountChange",[t])}),o.dispatchEvent("onSocialToolbarInjected")},onCommentCountChange(e){e>0?o.container.addClassName("is-already-commented"):o.container.removeClassName("is-already-commented")},onEndorsementCountChange(e){e>0?o.container.addClassName("is-already-endorsed"):o.container.removeClassName("is-already-endorsed")},onEndorseButtonClick(){this.model.getEndorsementsTotalCount()?d.trackPageEvent({category:"SocialToolbar",label:"like",view:"social-toolbar-view",event:"click",contentType:o.model.getModelName()}):d.trackPageEvent({category:"SocialToolbar",label:"unlike",view:"social-toolbar-view",event:"click",contentType:o.model.getModelName()})},onCommentButtonClick(){o._onCommentButtonClick&&o._onCommentButtonClick(),d.trackPageEvent({category:"SocialToolbar",label:"instant-message"===o.model.getModelName()?"reply":"comment",view:"social-toolbar-view",event:"click",contentType:o.model.getModelName()})},onCommentSavedWithCtrlEnterKey(){d.trackPageEvent({category:"SocialToolbar",label:"commentSavedWithEnterKey",view:"social-toolbar-view",event:"input",contentType:o.model.getModelName()})},onCommentSavedWithSendButton(){d.trackPageEvent({category:"SocialToolbar",label:"commentSavedWithSendButton",view:"social-toolbar-view",event:"click",contentType:o.model.getModelName()})}}})).inject(o.elements.wrapper,"bottom"),f.addListener("onContextChange",o._recreateSocialToolbarOnNavigationRequest,o,!1))}))):this.addEventOnce("onShow",this._createSocialToolbar,this)}},_createSocialToolbarWithProperServiceUrl(t){let i,s,a,r;const{model:l}=this,c=l.get("sourceid"),m=l.getModelName&&Object.keys(o.CONTENT).indexOf(l.getModelName())>=0||c&&c.startsWith("swym");this.isVisible()?(r=this.model&&this.model.get("subject6wuri"),this.model&&this.model.get("model_uri")&&(r=this.model.get("model_uri")),this.model&&this.model.isDriveFile&&this.model.isDriveFile()&&(r=this.model.isOfSource3DDrive()?`driveid:${this.model.get("mid")}`:this.model.get("mid")),this.elements&&this.elements.wrapper&&r&&(this._lastSubjectUri!==r||t&&!0===t.force)&&(s=this,a=n.getBaseUrl(),require(["DS/SwymUIComponents/script/lib/ckeditor/ckeditor"],n=>{s.isDestroyed()||(s._lastSubjectUri=r,i=C.get("user"),s.addControl("socialToolbar",new p({sendInitCallInPool:!1,tenantId:C.get("config").tenant.online_instance_id,"3DSwymURL":a,"3DSwymServerToken":C.getCSRFToken(),userLogin:i.login,userName:`${i.first_name} ${i.last_name}`,serviceURL:s.options.serviceURL||C.get("3dcommentUrl")||a,mode:s.options.socialToolbarMode,subjectURI:r,commentsNumberAtInit:s.options.commentsNumberAtInit,enableShare:e.is(s.getOption("enableShare"),"boolean")?s.getOption("enableShare"):C.isFeatureActivated("activate_share"),enableComment:s.getOption("enableComment"),enableLike:s.getOption("enableLike"),enableCommentLike:!0,showSendButton:Boolean(u.isFeatureActivated("activateCommentSendButton")),showUserProfile(e){require(["DS/SwymUICore/script/utils/navigation"],t=>{t.goToProfile({login:e})})},commentButtonClickEventIsOverrided:s.getOption("commentButtonClickEventIsOverrided"),enableUpload:!(s.model&&"wedo"===s.model.getModelName()),RTEConfig:n.getNewCommentEditorConfig(),showCommentsSummaryFirst:s.getOption("showCommentsSummaryFirst"),sendInitCallEvenIfSubjectIsInCache:t&&!0===t.force,commentToScrollToAtInit:f.commentUri&&f.commentUri.indexOf(r)>=0?{commentUri:f.replyUri||f.commentUri,parentCommentUri:f.replyUri&&f.commentUri}:null,commentProxyToken:m?{header:"X-DS-CSRFTOKEN"}:void 0,events:{onShareRequest:s._share.bind(s),onMediaClick:s.onMediaClick.bind(s),onBeforeRender(){this.model?this.model.getSharedOptions().setOptions({swymOptions:e.merge({model:s.model,widget:this._widget||window.widget},s.getOption("socialToolbarExtraOptions"))}):console.error("Failed to initialize Social toolbar instance")},onRender(){const{model:e}=this;this.dispatchEvent("onCommentCountChange",[e.getCommentsTotalCount()]),this.listenTo(e,`onChange:${e.COMMENTS_COUNT_ATTRIBUTE}`,function(e,t){this.dispatchEvent("onCommentCountChange",[t])}),this.dispatchEvent("onEndorsementCountChange",[e.getEndorsementsTotalCount()]),this.listenTo(e,`onChange:${e.ENDORSEMENT_COUNT_ATTRIBUTE}`,function(e,t){this.dispatchEvent("onEndorsementCountChange",[t])}),s.dispatchEvent("onSocialToolbarInjected")},onCommentCountChange(e){e>0?s.container.addClassName("is-already-commented"):s.container.removeClassName("is-already-commented")},onEndorsementCountChange(e){e>0?s.container.addClassName("is-already-endorsed"):s.container.removeClassName("is-already-endorsed")},onEndorseButtonClick(){this.model.getEndorsementsTotalCount()?d.trackPageEvent({category:"SocialToolbar",label:"like",view:"social-toolbar-view",event:"click",contentType:s.model.getModelName()}):d.trackPageEvent({category:"SocialToolbar",label:"unlike",view:"social-toolbar-view",event:"click",contentType:s.model.getModelName()})},onCommentButtonClick(){s._onCommentButtonClick&&s._onCommentButtonClick(),d.trackPageEvent({category:"SocialToolbar",label:"instant-message"===s.model.getModelName()?"reply":"comment",view:"social-toolbar-view",event:"click",contentType:s.model.getModelName()})},onCommentSavedWithCtrlEnterKey(){d.trackPageEvent({category:"SocialToolbar",label:"commentSavedWithCtrlEnterKey",view:"social-toolbar-view",event:"input",contentType:s.model.getModelName()})},onCommentSavedWithSendButton(){d.trackPageEvent({category:"SocialToolbar",label:"commentSavedWithSendButton",view:"social-toolbar-view",event:"click",contentType:s.model.getModelName()})}}})).inject(s.elements.wrapper,"bottom"),f.addListener("onContextChange",s._recreateSocialToolbarOnNavigationRequest,s,!1))}))):this.addEventOnce("onShow",this._createSocialToolbar,this)},onRedraw(){const t=this;e.is(this.model.getCommunity,"function")&&!this.model.isNew()&&(g?this._createSocialToolbar():(v.addEventOnce("onSocialToolbarPatch",()=>{t._createSocialToolbar()}),w||(w=!0,require(["DS/SocialToolbar/SocialToolbar","DS/SwymUIComponents/script/feature/community/content/social-interactions/patched-social-toolbar/patched-st-sprite","DS/SwymUIComponents/script/feature/community/content/social-interactions/patched-social-toolbar/patched-comment-view","DS/SwymUIComponents/script/feature/community/content/social-interactions/patched-social-toolbar/patched-interactor-view","DS/SwymUIComponents/script/feature/community/content/social-interactions/patched-social-toolbar/patched-comment-editor-view"],e=>{p=e,g=!0,w=!1,v.dispatchEvent("onSocialToolbarPatch")}))))},onModelStatusIdChange(){this.getControl("socialToolbar")&&this.model&&"idea"===this.model.getModelName()&&this._createSocialToolbar({force:!0})},onOutStatusChange(){this.getControl("socialToolbar")&&this.model&&"idea"===this.model.getModelName()&&this._createSocialToolbar({force:!0})},onDestroy(){return this.annotationsEventBus&&this.annotationsEventBus.removeEvent("onAnnotationShared",this.onAnnotationShared),f.removeListener("onContextChange",this._recreateSocialToolbarOnNavigationRequest),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/content/social-interactions/compact-social-toolbar-view",["DS/SwymUIComponents/script/feature/community/content/social-interactions/social-toolbar-view","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/lib/event-manager","DS/SwymUICore/script/utils/app-navigation-state"],function(e,t,i,n){"use strict";return e.extend({className:"compact-social-toolbar-view",defaultOptions:{commentButtonClickEventIsOverrided:!0},_onCommentButtonClick:function(){var e=this.model,o=e.get("mid"),s=e.getModelName(),a=e.getCommunity(),r=a.get("mid")||a.id,l=a.isDirectMessage();"media"===s&&n.saveLightboxPanelState("comment"),t.goToContent(o,s,r,!1,null,null,l),i.dispatchEvent("commentIconClickedInCompactView",[],!0)}})}),define("DS/SwymUIComponents/script/feature/community/content/social-interactions/edit/comment-editor-view",["UWA/Core","UWA/Utils/Client","i18n!DS/SwymUIComponents/assets/nls/feature/community/comment/view/comment-editor-view","DS/SwymUIComponents/script/feature/community/content/view/swym-editor-view","DS/SwymUIComponents/script/feature/core/user/view/user-picture-view","DS/SwymUIComponents/script/feature/community/content/social-interactions/edit/comment-edition-media-view","DS/SwymUIComponents/script/feature/community/content/utils/content-renderer","DS/SwymUIComponents/script/feature/community/content/view/simple-editor-with-media-view","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/community/comment/model/comment-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/localstorage-manager","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/rich-link-preview-utils","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/rich-link-preview-generator","DS/SwymUIComponents/script/utils/ui-constants","DS/UIKIT/Tooltip"],(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w,C)=>{return n.extend({_modelClass:c,_modelEventsForAutoRefresh:["onSync:update"],name:"editor-view",_modelInstance:null,_uploadComplete:!0,_editorIsReady:!1,_isFocused:!1,_tenantId:null,defaultOptions:{itemModelClass:m,itemTextAttribute:"comment",itemAdditionEvent:"addComment",itemAssociationToParentModel:"commented",mediaEditionViewClass:s},domEvents:{'click .editable-container[contenteditable="false"]':"_focusOnEditor","click .trigger-library":"_onOpenMediaLibrary","click .send-button":"onSaveRequest","mousedown .cancel-clickable":"cancelItemEditing","focusin .content.editable":"_focusOnEditor","click .placeholder":"_focusOnEditor","focusout .content.editable":"_focusOutEditor"},init(){return this._focusOnEditor=this._focusOnEditor.bind(this),this._focusOutEditor=this._focusOutEditor.bind(this),this._parent.apply(this,arguments)},bindEvents(){this.elements.contentEditable&&t.Engine.firefox&&this.elements.contentEditable.addEvents({focus:this._focusOnEditor,blur:this._focusOutEditor})},setup(){this._bootstrapModel=u.getInstance(),this._tenantId=this._bootstrapModel.get("config").tenant.id,this._parent.apply(this,arguments),this.options&&this.options.itemModelInstance&&(this._modelInstance=this.options.itemModelInstance)},_onOpenMediaLibrary(){require(["DS/SwymUIComponents/script/feature/community/media/library/media-library-view"],e=>{let t;const i=new e({communityId:t=this.model.get("community")?this.model.get("community").mid:this.model.getAssociated("answeredFor").get("community").mid});i.injectInDom(),this.listenTo(i,{newMediaAdded:function(e){const{newMedia:t}=e,{existingMedia:n}=e,o=this._getMediaEditionView();t&&Array.isArray(t)&&t.length>0&&o.addNMediaModels(t),n&&Array.isArray(n)&&n.length>0&&o.addNMediaModels(n),i.destroy(),this.getRTEView().setFocus()}.bind(this)})})},_focusOnEditor(){const e=this.container.getElement(".cancel-message");if(!this._isFocused){this._isFocused=!0;const i=this.getRTEView(),n=this.getCommentDraftFromLocalStorage();setTimeout(function(){t.Platform.ios&&this.container&&this.container.scrollIntoView()},100),i.switchToRTE(n,void 0,void 0,{focus:!0}),e&&e.getElement(".cancel-on-focus").removeClassName("hidden")}},_focusOutEditor(){this._isFocused=!1;const e=this.container.getElement(".cancel-message");e&&e.getElement(".cancel-on-focus").addClassName("hidden")},getCommentDraftFromLocalStorage(){const e=this.model.get("id"),t=`${this._tenantId}-${e}-`+"comment";let i=h.getItem(t);return i&&i.length>0&&(i=(i=i.replace(/<&nbsp;/gm,"").trim()).replace(/\n/gm,"<br />")),i},clearCommentDraftFromLocalStorage(){const e=this.model.get("id"),t=`${this._tenantId}-${e}-`+"comment";h.removeItem(t)},addCommentDraftToLocalStorage(e){let t,i,n;t=this.model?this.model.get("id"):null,i=this._modelInstance?this._modelInstance.get("mid"):"",this._tenantId&&t&&"string"==typeof e&&(n=`${this._tenantId}-${t}-`+`comment${i}`,h.setItem(n,e))},_createMediaEditionView(e){let t,i,n;const o=this;if(e instanceof this.getOption("itemModelClass"))n={contentModel:t=e,Class:this.getOption("mediaEditionViewClass"),contentAttributeInModel:this.getOption("itemTextAttribute"),parentModelAssociation:this.getOption("itemAssociationToParentModel"),dragZoneSelector:".editor-view-container",modelName:t.getModelName()};else{if("string"!=typeof e)throw new Error("Unknown parameter provided");n={communityId:i=e,Class:this.getOption("mediaEditionViewClass"),contentAttributeInModel:this.getOption("itemTextAttribute"),dragZoneSelector:".editor-view-container"}}return n.events={onInit(){o.listenTo(this,{onMediaUploadsStart:o.onMediaUploadsStart,onMediaUploadsComplete:o.onMediaUploadsComplete,onMediaCollectionChange:o.onMediaCollectionChange,onCopyPaste:o._onCopyPaste})},onInjected(){this._addDragDetection()}},this.addChildView("mediaEdition",n)},_onCopyPaste(e){const t=this.getRTEView();t&&t.triggerActionOnMediaIntoTextEditor(e,"remove")},_getMediaEditionView(){let e=this.getChildView("mediaEdition");if(!(e&&e instanceof s)){const t=this.getOption("communityId")||this.model.getCommunity().get("mid");e=!0===this.getOption("mediaEditionViewInstantiated")&&t?this._createMediaEditionView(t):this.addChildView("mediaEdition",new l)}return e},onMediaCollectionChange(e){let t;e&&e.length>0?(this.container.addClassName("st-has-media"),this.addSendButton()):(t=this.getChildView("rte"))&&t.isPlaceholderShown()&&this.removeSendButton()},onMediaUploadsComplete(){this._uploadComplete=!0,this.deleteWaitMessage()},onMediaUploadsStart(){this._uploadComplete=!1},onSaveRequest(){this._uploadComplete?this.createItem():this.addWaitMessage()},onCtrlEnterKeyPressed(){!0===this.getOverrideDefaultCtrlEnterBehaviourOption()&&this.onSaveRequest()},onPlaceholderAdded(){!0===this.getOption("activateSendButton")&&(this.removeSendButton(),this.addUserPicture())},removeSendButton(){this.container.removeClassName("with-send")},addUserPicture(){this.container.removeClassName("without-user-pic")},addSendButton(){this.container.addClassName("with-send")},removeUserPicture(){const e=(t=this.container).getSize&&t.getSize().width;var t;e&&e<=w.DeviceWidth0&&this.container.addClassName("without-user-pic")},onPlaceholderRemoved(){!0===this.getOption("activateSendButton")&&(this.addSendButton(),this.removeUserPicture())},addWaitMessage(){if(!this.container.getElement(".wait-upload-message")){const{container:t}=this,n=e.createElement("div",{class:"wait-upload-message",html:i.PleaseWaitToComment});t.addContent(n)}},deleteWaitMessage(){const e=this.container.getElement(".wait-upload-message");e&&e.destroy()},getOverrideDefaultCtrlEnterBehaviourOption:()=>!0,getRTEView(){let e=this.getChildView("rte");const t=this.getCommentDraftFromLocalStorage(),n=this.getOverrideDefaultCtrlEnterBehaviourOption(),o="comment"===this.getOption("itemTextAttribute")?i.WriteAComment:i.WriteAnAnswer;return e||(e=this.addChildView("rte",{Class:r,className:"form-control",rtePlaceholder:o,modelAttr:"content",initialText:t||void 0,overrideDefaultCtrlEnterBehaviour:n,useFocusStyle:!0,focusOnEditorInit:!t,cssPlaceholder:!0,overrideToolbarStickiness:!0}),this.reactTo(e,"onCtrlEnterKeyPressed",this.onCtrlEnterKeyPressed),this.reactTo(e,"onRTEContentChanged",this.addCommentDraftToLocalStorage,this),this.reactTo(e,"onEscKeyPressed",e.resetEditor.bind(e)),this.reactTo(e,"onMediaPaste",function(){const e=this._getMediaEditionView().getUploader("copyPaste");e&&e.getAndTransformMediaPasted(arguments)}.bind(this)),this.reactTo(e,"onPlaceholderAdded",this.onPlaceholderAdded),this.reactTo(e,"onPlaceholderRemoved",this.onPlaceholderRemoved)),e},_createSendButton(){const t=e.createElement("span",{class:"fonticon fonticon-send"});return{tag:"div",class:"send-button",html:[t,new C({target:t,body:`${i.Send}</br>${i.CtrlEnter}`})]}},_createContent(){const t=this._modelInstance?this._modelInstance.getAuthor():new d(u.getInstance().get("user")),{model:i}=this;if(i)return this.addChildView("userPicture",{Class:o,model:t,imageRenderingOptions:{format:"normal"}}),this.elements.contentEditable=e.createElement("div",{class:"content editable",html:[this.getRTEView(),{tag:"span",class:"trigger-library fonticon fonticon-attach"},this._getMediaEditionView()]}),e.createElement("div",{class:"comment-editor",html:[this.elements.contentEditable,this._createSendButton()]})},getTextAreaId(){return`comment_editor_textarea_${this.cid}`},editItem(e){const t=this.getRTEView();t.editionMode=!0,this._modelInstance=e;const i=this.getCommentDraftFromLocalStorage();t.switchedToRTE()&&t.ckeditor?this.launchEdition():(this.reactTo(t,"editorIsReady",this.launchEdition),t.switchToRTE(i,void 0,void 0,{focus:!0})),this.addCancelMessage()},launchEdition(){const t=this.getRTEView();let i;t.removePlaceholder(),this._contentRenderer||(this._contentRenderer=a.getInstance()),i=this._contentRenderer.render(this._modelInstance.getChanges(this.getOption("itemTextAttribute"))||this._modelInstance.get(this.getOption("itemTextAttribute")),{createMediaView:!1}),i=g.createPreviewFromLink(i,!1,!0),e.is(i,"string")?t.ckeditor.setData(i,()=>{t.placeCursorAt()}):(t.getTextArea().setHTML(i),t.ckeditor.updateElement(),t.placeCursorAt()),t.ckeditor.setReadOnly(!1),this._createMediaEditionView(this._modelInstance)},addCancelMessage(){if(!this.container.getElement(".cancel-message")&&!t.Features.touchEvents){const{container:t}=this,n=e.createElement("div",{class:"cancel-message",html:i.PleaseClickOnEscapeToCancel.format('<span class="cancel-on-focus">','</span><span class="cancel-clickable">',"</span>")});t.addContent(n)}},createItem(){let e,n;const o={};let s="";const a=this.getOption("itemModelClass"),r=this._getMediaEditionView(),l=this,c=this.getRTEView(),d=c.getTextArea();if(e=d.getHTML(),e=p.convertURLPreviewToLink(e,!1),r&&(s=r.getHTMLToBeSaved()),""!==e.replace(/<(?:.|\n)*?>|&nbsp;/gm,"").trim()||s.length>0){if(null===this._modelInstance){o[this.getOption("itemTextAttribute")]=e+s,o.parentId=this.model.get("mid"),n=new a(o,{commentType:this.model.getModelName()});const c=function(){let e;e="iq-answer"===n.getModelName()?i.TheanswercouldnotbesavedPleasetryagain:i.ThecommentcouldnotbesavedPleasetryagain,l.alert("error",e),this.removeEvent("onSync:create",m)};var m=function(){this.removeEvent("onError:create",c)};n.addEventOnce("onSync:create",m),n.addEventOnce("onError:create",c),t.Platform.ios&&t.Engine.safari&&d&&(d.blur(),this._focusOutEditor()),this.dispatchEvent("hideAddMediaView"),this.dispatchEvent("newItemCreated",[n]),this.model.dispatchEvent(this.getOption("itemAdditionEvent"),[n]),r&&r.reset(),this.clearCommentDraftFromLocalStorage()}else if(this._modelInstance instanceof this.getOption("itemModelClass")){this._modelInstance.addChanges(this.getOption("itemTextAttribute"),e+s),this._modelInstance.getChanges()[this.getOption("itemTextAttribute")]&&this._modelInstance.save({},{onComplete(){l.alert("success",i.Yourmodificationshavebeensuccessfullysaved),l._modelInstance=null},onFailure(){l.alert("error",i.Errorsavingmodifications),l.dispatchEvent("switchToEditModeRequest")}});const t=this._parentView.container.getElement(".menu-button"),n=this._parentView.container.getElement(".infos"),o=this._parentView.container.getElement(".content"),a=this._parentView.container.getElement(".user-picture-view-container.hidden"),r=this._parentView.getElement(".content-media-display-manager-container"),c=this.container.parentElement,d=this.container.getParent(".comment-wrapper").getChildren(".editor-view-container").pop();a&&a.removeClassName("hidden"),r&&r.show(),t.show(),n.show(),o.show(),d.show(),c.hide()}c.resetEditor(),setTimeout(c.placeCursorAt.bind(c,null,{programmaticFocus:!0}),100)}},cancelItemEditing(){let e;if(this._modelInstance instanceof this.getOption("itemModelClass")&&this._parentView&&this._parentView.container){const e=this._parentView.container.getElement(".menu-button"),t=this._parentView.container.getElement(".infos"),i=this._parentView.container.getElement(".content"),n=this._parentView.container.getElement(".user-picture-view-container.hidden"),o=this._parentView.getElement(".content-media-display-manager-container"),s=this.container.parentElement,a=this.container.getParent(".comment-wrapper").getChildren(".editor-view-container").pop();n&&n.removeClassName("hidden"),o&&o.show(),e.show(),t.show(),i.show(),a.show(),s.hide()}else(e=this.getChildView("mediaEdition"))&&e.reset(),this.clearCommentDraftFromLocalStorage();this._modelInstance=null;const t=this.getRTEView();t.ckeditor.setData(""),t.resetEditor},destroy(){this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/core/user/view/member-set-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/member-set-view","i18n!DS/SwymUIComponents/assets/nls/feature/core/search/view/user-search-view","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/W3DXComponents/MemberSet","DS/W3DXComponents/Collections/ActionsCollection","DS/W3DXComponents/Views/Item/PanelAddMemberView","DS/W3DXComponents/Views/Layout/GridView","DS/W3DXComponents/Views/Layout/TableView","DS/W3DXComponents/Views/Item/TileView","DS/SwymUIComponents/script/feature/core/user/view/add-member-panel-view","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/sprite/sprite","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/error/error","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUIComponents/script/utils/scrollview-utils","DS/SwymUICore/script/feature/core/context/context-model","DS/UWPClientCode/I18n","DS/WebappsUtils/Console","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/WebappsUtils/WebappsUtils"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w,C,f,y,v,A,_,S,b){"use strict";return o.extend({name:"member-set-view",attributes:{styles:{height:"100%"}},_asAdmin:!1,_mailAllowed:!0,_userCollection:null,domEvents:{"click .memberset-view .tile-header":"userPhotoClick"},defaultOptions:{addMemberPanelViewClass:h},setup:function(t){var i,n=this;return t&&e.is(t.asAdmin)&&(n._asAdmin=t.asAdmin),t&&e.is(t.mailAllowed)&&(n._mailAllowed=t.mailAllowed),i=n._parent.apply(n,arguments),n.collection.addEvent("onRefreshing",function(e){var t,i,n=null,o=this,s=o.getChildView("members");s&&s.currentViewId&&(i=s.contentsViews[s.currentViewId],o.mask(),t=function(){o.unmask(),e.removeEvent("onFailure",n),_.info("syncCb, collection.hasNext():",e.hasNext()),i.scrollView&&(e.hasNext()?i.scrollView.useInfiniteScroll(!0):i.scrollView.useInfiniteScroll(!1))},n=function(){o.unmask(),C.displayError(),e.removeEvent("onSync",t)},e.addEventOnce("onSync",t),e.addEventOnce("onFailure",n),y.onPullToRefresh.call(i))}.bind(n,n.collection)),!0!==n._asAdmin&&v.getInstance().addListener("onCommunityChange",n.onCommunityChange,n,!0),n._bootstrapModel=f.getInstance(),!0===n._mailAllowed&&S.getPlatformConfig({platformId:n._bootstrapModel.get("config").tenant.online_instance_id,key:"share",onComplete:function(e){!1===e&&(n._mailAllowed=e)}}),i},onCommunityChange:function(e){var t;null!=(t=new p({id:e.communityId})).getUserRole()?this.onCommunitySync(t):this.listenTo(t,"onSync",function(){this.onCommunitySync(t),this.stopListening(t,"onSync")})},onCommunitySync:function(e){var i=v.getInstance(),n=e.getUserRole(),o=this.getChildView("members");i.removeListener("onCommunityChange",this.onCommunityChange),n>=3&&o&&o.actionsView&&o.actionsView.collection&&0===o.actionsView.collection.length&&o.actionsView.collection.add({id:"addmember",title:t.AddMember,icon:"user-add",context:!0,overflow:!1})},_getContentsHeaders:function(){return[{property:"user_name",label:t.Name},{property:"subtitle",label:t.Role},{property:"company",label:t.Company},{label:t.Actions,actions:!0}]},_getItemViewAttributesMapping:function(){return{user_name:function(){return this.model.getNickname()},company:"company",title:function(){var e=this.model;return'<a data-content-type="person" data-hash-key="'+e.get("hash_key")+'"'+(e.get("login")?' data-login="'+e.get("login")+'"':"")+">"+e.getNickname()+"</a>"},content:function(){var e=this.model;return(e.get("nb_post")&&"0"!==e.get("nb_post")?"<span class='input'><span class='input_nb'>"+e.get("nb_post")+"</span><span class='fonticon fonticon-newspaper'></span></span>":"")+(e.get("nb_comment")&&"0"!==e.get("nb_comment")?"<span class='input'><span class='input_nb'>"+e.get("nb_comment")+"</span><span class='fonticon fonticon-comment'></span></span>":"")+(e.get("nb_media")&&"0"!==e.get("nb_media")?"<span class='input'><span class='input_nb'>"+e.get("nb_media")+"</span><span class='fonticon fonticon-picture'></span></span>":"")+(e.get("nb_question")&&"0"!==e.get("nb_question")?"<span class='input'><span class='input_nb'>"+e.get("nb_question")+"</span><span class='fonticon fonticon-help'></span></span>":"")+(e.get("nb_answer")&&"0"!==e.get("nb_answer")?"<span class='input'><span class='input_nb'>"+e.get("nb_answer")+"</span><span class='fonticon fonticon-check'></span></span>":"")},subtitle:function(){var e=void 0,i=0,n=this.model;if(n)switch(i=parseInt(n.get("relation"),10)){case 1:i=t.Contributor;break;case 2:i=t.Author;break;case 3:i=t.Owner,n.collection&&n.collection.getAssociated("owned")&&n.collection.getAssociated("owned").get("owner")&&(e=n.collection.getAssociated("owned").get("owner").hash_key),n.get("hash_key")===e&&(i=t.MainOwner)}return i},image:function(){return s.constructUserPictureUrl(this.model.get("login"),this.model.get("user_picture_fingerprint"),this.model.get("hash_key"))}}},_createContent:function(){var i,s,a,d,m,u,h,p,C,f,v=this,A=this.collection,S=this.getOption("addMemberPanelViewClass");if(A){if((s=A.getAssociated("owned"))&&s.get("mid")&&v.reactTo(s,"onChange:main_owner_hash_key",function(e,t){var i=A.findWhere({mid:"user:"+t});i&&A.getAssociated("owned").set("owner",i.getAttributes()),this.collection.dispatchEvent("onRefreshing")}),p=this,C=null,f=w.getDelayedSyncTask(function(){this.isDestroyed},100),a={itemViewOptions:{templateHelpers:{imgAttrs:function(){switch(this.model.getModelName()){case"user":return g.getUserPictureAttributes({format:"normal",login:this.model.get("login"),hash_key:this.model.get("hash_key"),imageFingerprint:this.model.get("user_picture_fingerprint")});case"users-group":return{class:"users-group-default-picture"};default:return{}}}},events:{onClick:function(){"row"===this.name&&"user"===this.model.getModelName()&&n.goToProfile({login:this.model.get("login"),hash_key:this.model.get("hash_key")})},onRender:function(){this.container.hasClassName("tile-container")&&C&&f.call(C)},onActionClick:function(e,i){var n,s=i.model.get("id"),a="",r=this.model.get(this.model.getModelIdAttribute(),{escapeHTML:!1}),l=(this.model.get("id"),this);if("contributor"===s||"author"===s||"owner"===s){switch(s){case"contributor":a="1";break;case"author":a="2";break;case"owner":a="3";break;default:_.log(s+" is not defined.")}(n=";update,"+r+","+a).length>0&&C.collection.getAssociated("owned").action("editmembers",{data:{settings_members:n,as_admin:!(!p||!p._asAdmin)&&p._asAdmin},onComplete:function(){l.model.set("relation",a),l.model.updateActions(p._asAdmin),e.render(),o.prototype.alert("success",t.Yourchangeshavebeensaved)}})}else if("delete"===s){var c=";delete,"+r;c.length>0&&C.collection.getAssociated("owned").action("editmembers",{data:{settings_members:c,as_admin:!(!p||!p._asAdmin)&&p._asAdmin},onComplete:function(){C.collection.remove(l.model),o.prototype.alert("success",t.Yourchangeshavebeensaved)}})}else _.log(s+" is not take in charge.")}}},events:{onRender:function(){this.container.hasClassName("grid-scroll-container")&&(C=this,f.call(C))},onInfiniteScroll:y.onInfiniteScroll,onPullToRefresh:y.onPullToRefresh}},i=this.addChildView("addMemberPanelView",new S({asAdmin:this._asAdmin,mailAllowed:function(){return v._mailAllowed},collection:this.collection})),d=new r({collection:A,actions:{collection:(m=A,u=this._asAdmin,(h=m.getAssociated("owned").getUserRole())&&h>=3||!0===u?new l([{id:"addmember",title:t.AddMember,icon:"user-add",context:!0,overflow:!1}]):new l)},slidepanel:{view:c,viewOptions:i.getOptionsForW3DXAddMemberPanelView()},events:{onActionClick:function(e,t,i){var n=i.model.get("id");switch(n){case"addmember":this.togglePanel();break;default:_.log(n+" is not permitted.")}}},contents:{headers:this._getContentsHeaders(),itemViewOptions:{mapping:this._getItemViewAttributesMapping(),templateHelpers:a.itemViewOptions.templateHelpers,events:a.itemViewOptions.events},events:a.events}}),this._childViews&&this._childViews.members){if("function"!=typeof this._childViews.members.destroy)throw new Error('The old child view "members" cannot be destroyed');this._childViews.members.destroy()}return this._childViews.members=d,e.createElement("div",{class:"memberset-view",styles:{height:"100%",width:"100%"},html:[d]})}throw new Error("User Collection does not exist")},userPhotoClick:function(){var e=arguments[0].target.dataset.hashKey;e&&window.ds&&"3DSwym"===window.ds.env&&n.goToProfile({hash_key:e})},onRedraw:function(){this.renderMemberSetView()},renderMemberSetView:function(){this._childViews&&this._childViews.members&&this._childViews.members.render()}})}),define("DS/SwymUIComponents/script/feature/community/wiki/view/wiki-tree-expanded-modal",["UWA/Core","UWA/Utils/Client","DS/UIKIT/Input/Button","DS/SwymUIComponents/script/feature/core/modal/modal","DS/SwymUICore/script/feature/community/wiki/model/wikitree-model","DS/SwymUICore/script/feature/community/wiki/model/wiki-model","DS/SwymUIComponents/script/feature/community/wiki/view/wikitree-view","DS/SwymUIComponents/script/utils/content-creation-types-manager","DS/SwymUIComponents/script/feature/core/ui-components/layout/layout-manager","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUIComponents/script/feature/community/content/forward-modal","i18n!DS/SwymUIComponents/assets/nls/feature/community/wiki/edit/wiki-creator-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/wiki/view/wikitree-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/edit/content-creation-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/view/abstract-content-view"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g){"use strict";return n.extend({_destroyed:!1,_context:null,_wikiTreeModel:null,defaultOptions:{className:"wiki-tree-expanded",closable:!0},init:function(e){const n=this;let r;e&&e.communityId&&e.widget&&(this._wikiTreeModel=new o({community_id:e.communityId},{autoPopulate:e.forceAutoPopulate||!1}),this.innerView=new a({addVerticalScroller:!1,model:this._wikiTreeModel,widget:e.widget,moveOnlyCurrentNode:e.moveOnlyCurrentNode,creation:e.creation,editable:!1,events:{onInit:function(){this.reactTo(this,"currentPageChange",function(e){!0!==e.dontSetModel&&n&&n.hide()})}}}),e.contentId&&this._wikiTreeModel.setCurrentPage(new s({mid:e.contentId})),r=e.enterEditMode&&!t.Platform.ios&&!t.Platform.android,e.header="<h4>"+u.Wikitree+"</h4>",e.body="edit"===e.mode?this.innerView:[{class:"wiki-tree-expanded-modal-toolbar",styles:{"text-align":"right"},html:[e.addWiki?new i({value:p.Addawiki,className:"link",icon:"doc-add",events:{onClick:function(){n.hide(),n._createWikiPage()}}}):"",e.addWiki&&r?"|":"",r?new i({value:h.Enterwikitreeeditmode,className:"link",icon:"pencil",events:{onClick:function(){this.setValue(n.innerView.editable?h.Enterwikitreeeditmode:h.Exitwikitreeeditmode),n.innerView.toggleEdit()}}}):"",e.addWiki&&r?"|":"",r?new i({value:g.Forward,className:"link",icon:"import",events:{onClick:function(){new m({model:n._wikiTreeModel}).show()}}}):""]},this.innerView],e.renderTo=e.widget.body,"edit"===e.mode&&this.innerView.toggleEdit()),this._parent.apply(this,arguments)},_createWikiPage:function(){var e=this,t=d.getInstance();l.dispatchEvent("hideLayout"),new Promise(function(i){if("wiki"===t.getCommunityContentListContext())return i();t.addOnce("onContextChange",i),c.goToCommunity(e.options.communityId,d.COMMUNITY_WIKI)}).then(function(){var e=r.getInstance();setTimeout(function(){e.setContentTypeRequest({type:"wiki",updateIcon:!0,forceFocus:!0,userAction:!0})},100)})},destroy:function(){!1===this._destroyed&&(this._destroyed=!0,this.innerView.destroy(),this.innerView=null,this._parent.apply(this,arguments))}})}),define("DS/SwymUIComponents/script/feature/community/media/view/media-zone-view",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUIComponents/script/feature/community/media/view/interactive-media-thumbnail-view","DS/Logger/Logger"],function(e,t,i,n,o){"use strict";var s=function(e){return"show-"+e+"-thumbnails"},a=function(e){return"row-with-"+e+"-thumbnails"},r=n.extend({_interactAfterClickOnThumbnail:function(){o.log("on click");var e,t,i,n=!1,r=this.container.getClosest(".media-zone");if(r&&r.contains(this.container)&&this.container.dataset.remainingMedia)for(e=1;e<=6;e++)if(t=s(e),r.hasClassName(t)){(i=r.getElement(".media-thumbnail-view-container:nth-child(1n+"+e+")"))&&this.container===i&&(r.removeClassName(t),r.addClassName("show-all"),r.addClassName(a(e)),n=!0);break}!1===n&&this._parent.apply(this,arguments)}});return i.extend({name:"media-zone-view",resizeTimeout:null,_delegateSpriteReloadToParentView:!1,_collectionClass:t,imageReloadOptions:{size:"m",imageKind:"thumb"},bodyAttributes:{class:"content-media-collection-view media-zone"},domEvents:{resize:"_updateRemainingThumbnailsCounter"},modelViewClass:r,nbThumbnailsShowingCurrently:null,contentModel:null,setup:function(e){this._parent.apply(this,arguments),e&&e.contentModel&&(this.contentModel=e.contentModel)},modelViewsCfg:function(){return{contentModel:this.contentModel,events:{onOpenInViewerRequest:function(){this.dispatchEvent("onOpenInViewerRequest",arguments)}.bind(this)}}},_updateRemainingThumbnailsCounter:function(e){var t,i,n,r,l=this.nbThumbnailsShowingCurrently,c=this.container,d=c.getElement(".media-zone");if(c&&d&&(i=c.getSize().width)&&i>0)if(n=parseInt((i+2)/122,10),d.hasClassName("show-all")){for(t=1;t<=6;t++)if(r=a(t),d.hasClassName(r)){if(t===n)break;d.removeClassName(r)}r=a(n),d.hasClassName(r)||d.addClassName(r)}else{if(o.log("width",i,"nbThumbnails",n),!0===e)for(l=null,t=1;t<=6;t++)r=s(t),d.hasClassName(r)&&d.removeClassName(r);l?l!==n&&(o.log("old",l,"new",n,"cid",this.cid),d.removeClassName(s(l)),this.nbThumbnailsShowingCurrently=n,d.addClassName(s(n))):(this.nbThumbnailsShowingCurrently=n,d.addClassName(s(n)))}},onRedraw:function(){var e,t,i,n,s=this.getModelViews();if(s&&(t=s.length)>0)for(this.collection.length!==t&&o.error("Thumbnails don't match the collection length"),e=0;e<t;e++)i=s[e],(n=t-e-1)>0&&(i.container.dataset.remainingMedia="+"+n);this._updateRemainingThumbnailsCounter(!0)}})}),define("DS/SwymUIComponents/script/feature/community/wedo/view/simple-content-attachment-view",["UWA/Core","DS/SwymUICore/script/feature/community/wedo/model/wedo-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/community/media/view/media-zone-view","DS/SwymUICore/script/feature/community/wedo/collection/attachment-collection","DS/SwymUICore/script/feature/community/wedo/model/attachment-model","DS/SwymUIComponents/script/feature/community/wedo/view/fedsearch-interactive-thumb-view"],function(e,t,i,n,o,s,a){"use strict";return i.extend({name:"simple-content-attachment-view",_attachmentCollection:null,_modelClass:t,defaultOptions:{},setup:function(){this._parent.apply(this,arguments),this._setupAttachmentCollection()},_getAttachmentCollection:function(){var e=this.model.getAssociated("attachments");return e.fetchDataFromFederatedSearch(),e},_setupAttachmentCollection:function(){this._attachmentCollection=this._getAttachmentCollection();this.addChildView("attachment-zone",{Class:n,modelViewClass:a,collection:this._attachmentCollection,contentModel:this.model})},_createContent:function(){return this.getChildView("attachment-zone")},onDestroy:function(){this.stopListening(this.getChildView("media-zone"))}})}),define("DS/SwymUIComponents/script/feature/community/wiki/view/wikitree-buttons-view",["UWA/Core","UWA/Utils/Client","DS/UIKIT/DropdownMenu","DS/SwymUIComponents/script/feature/core/modal/modal","DS/UIKIT/Tooltip","DS/UIKIT/Input/Button","i18n!DS/SwymUIComponents/assets/nls/feature/community/wiki/edit/wiki-creator-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-detailed-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/wiki/view/wikitree-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/edit/content-creation-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/view/abstract-content-view","DS/SwymUIComponents/script/feature/community/wiki/view/wikitree-view","DS/SwymUIComponents/script/utils/content-creation-types-manager","DS/SwymUIComponents/script/feature/core/ui-components/layout/layout-manager","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/wiki/model/wiki-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/community/wiki/model/wikitree-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUIComponents/script/feature/community/wiki/view/wiki-tree-expanded-modal","DS/SwymUIComponents/script/feature/core/modal/rss-feed-modal","DS/SwymUIComponents/script/feature/community/content/forward-modal"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w,C,f,y,v,A,_,S,b){"use strict";return w.extend({_mode:"view",editable:!1,_context:null,_modelEvents:{onSync:"refresh"},domEvents:{"click .fonticon-doc-add":"_createWikiPage","click .fonticon-resize-full":"_showModal"},_createWikiPage:function(){var e=this,t=A.getInstance();h.dispatchEvent("hideLayout"),new Promise(function(i){if(!0===window.ds.swymIM&&"wiki"===t.getCommunityContentListContext())return i();t.addOnce("onContextChange",function(){i()}),g.goToCommunity(e.model.get("mid"),!0===window.ds.swymIM?A.COMMUNITY_WIKI:void 0)}).then(function(){var e=u.getInstance();setTimeout(function(){e.setContentTypeRequest({type:"wiki",updateIcon:!0,forceFocus:!0,programmaticallyChanged:!0,userAction:!0})},100)})},_buildDropDownMenu:function(e){var n=this,o=[];o.push({name:"rss",text:r.SubscribeToRSSFeed,fonticon:"rss"}),v.getInstance().isFeatureActivated("activate_wiki_move")&&!t.Platform.ios&&!t.Platform.android&&n.model&&n.model.getUserRole()>=f.COMMUNITY_OWNER_ROLE&&o.push({name:"edit",text:n.editable?l.Exitwikitreeeditmode:l.Enterwikitreeeditmode,fonticon:n.editable?"erase":"pencil"},{name:"forward",text:d.Forward,fonticon:"import"}),o.length>0&&e?n.addControl("dropdownMenu",new i({target:e,renderTo:window.document.body.getElement(".scroll-content"),position:"bottom right",offset:{x:17,y:8},items:o,events:{onClick:function(e,t){switch(t.name){case"rss":n._subscribeToRssFeed();break;case"edit":n.editable=!n.editable,t.elements.icon.setAttribute("class",n.editable?"fonticon fonticon-erase":"fonticon fonticon-pencil"),t.elements.content.setHTML(n.editable?l.Exitwikitreeeditmode:l.Enterwikitreeeditmode),n.dispatchEvent("WikiEditToggle");break;case"create":n._createWikiPage();break;case"forward":n._showModal({forwardModal:!0})}}}})):e&&e.hide()},_createContent:function(){var t,i,n,s;return this.model&&(i=e.createElement("span",{class:"fonticon fonticon-down-open"}),t={class:"wiki-action-bar",html:[(n=this.model.canCreateWikiPages()&&"view"===this._mode?e.createElement("span",{class:"fonticon fonticon-doc-add"}):null)||null,(s=!0!==this.getOption("creation")?e.createElement("span",{tag:"span",class:"fonticon fonticon-resize-full"}):null)||null,"view"===this._mode?i:null]},"view"===this._mode&&this._buildDropDownMenu(i),n&&this.addControl("addPageIconTooltip",new o({target:n,body:c.Addawiki})),s&&this.addControl("expandTreeIconTooltip",new o({target:s,body:a.Expand}))),t},_showModal:function(e){var t,i=new y({community_id:this.model.get("mid")},{autoPopulate:!1});t=new f({mid:i.getCommunity().get("mid")},{autoPopulate:!0}),(e.forwardModal?new b({model:i}):this.addControl("wikiTreeExpandedModal",new _({communityId:this._context.communityId,widget:this._widget,moveOnlyCurrentNode:!1,creation:!1,addWiki:t.canCreateWikiPages()||void 0,enterEditMode:t.canReorganizeWikiPages()||void 0}))).show()},setup:function(e){return e&&e.mode&&(this._mode=e.mode),this._context=A.getInstance(),this._parent.apply(this,arguments)},_subscribeToRssFeed:function(){const e=`${p.getBaseUrl()}/rss/filter/feed/community_id/${this.model.get("mid")}/model/wiki/`;S.createModal(e)}})}),define("DS/SwymUIComponents/script/feature/community/wiki/view/wiki-detailed-view",["UWA/Core","UWA/Utils/Client","DS/SwymUICore/script/feature/community/wiki/model/wiki-model","DS/SwymUICore/script/feature/community/wiki/model/wikitree-model","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUIComponents/script/feature/community/wiki/view/wikitree-view","DS/SwymUIComponents/script/feature/community/content/view/content-detailed-view","DS/SwymUIComponents/script/feature/core/ui-components/layout/layout-manager","DS/SwymUIComponents/script/feature/community/wiki/view/wikitree-buttons-view","DS/SwymUIComponents/script/feature/community/content/view/author-section-view","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/utils/utils","i18n!DS/SwymUIComponents/assets/nls/feature/community/wiki/edit/wiki-creator-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/generic/view/content-title-view","DS/UIKIT/DropdownMenu","DS/UIKIT/Tooltip","DS/SwymUIComponents/script/feature/community/wiki/view/wiki-tree-expanded-modal"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w,C){"use strict";return r.extend({_modelClass:i,name:"wiki-detailed-view",_modelEvents:{"onSync:update":"refresh","onChange:title":"updateTitleSection","onChange:visibility":"updateTitleSection","onChange:locked":"updateTitleSection","onSync:read":"updateContentOwnSections","onChange:mid":"setWikiRootModel"},domEvents:{"click .fonticon-book-open":"_expandWiki","click .fonticon-tree-view-flattened":"_expandWiki"},defaultOptions:{showTreeIcon:!0},_addWikiTreeView:function(){var e=this;e._context=o.getInstance();var t=e.addChildView("wikiTreeView",{addVerticalScroller:!1,model:new n({community_id:e.model.getCommunity().get("mid")},{autoPopulate:!0}),Class:a,widget:e._widget,events:{onInit:function(){e.reactTo(this,"onItemViewSelect",function(t,i){var n=i.model.get("mid"),o=i.model.getModelName(),s=i.model.getCommunity().get("mid");e._context.contentId===n&&e._context.contentType===o&&e._context.communityId===s||e._context.reset({contentId:n,communityId:s,contentType:o})})}}});return t.selectItemView(e.model,!1),t},_createTreeSection:function(){var e,t,i,o=this,s=o.getChildView("wikiTreeView");return s?(e=o.model.getCommunity().get("mid"),t=s.model&&s.model.getCommunity().get("mid"),e&&t?t!==e?s.setModel(new n({community_id:o.model.getCommunity().get("mid")},{autoPopulate:!0,onPopulate:function(){s.selectItemView&&s.selectItemView(o.model,!1)}})):s.selectItemView&&s.selectItemView(o.model,!1):o.model.addEventOnce("onSync:read",function(e){o.model=e,s&&s.refresh()&&s.selectItemView(o.model,!1)})):o.model.getCommunity().get("mid")?s=o._addWikiTreeView():(i=m.extend({name:"dummy-view"}),s=o.addChildView("wikiTreeView",new i),o.model.addEventOnce("onSync:read",function(e){o.model=e,s=o._addWikiTreeView()})),s},_addAnchor:function(){var e,t,i=this,n=i.model,o=n.generateToc(n.get("content")),s=[],a=[];for(n.set("content",o),e=n.getToc(),t=0;t<e.length;t++)"&nbsp;"!==e[t].name&&a.push(e[t]);if(a.length>0){for(t=0;t<a.length;t++)s.push({text:a[t].name.replace(/<(?:.|\n)*?>/gm,""),name:a[t].id,className:a[t].level.toLowerCase()+"-toc",selectable:!0});i.anchor.show()}else i.anchor.hide();i.addControl("tocView",new g({items:s,className:"toc-dropdown",target:i.anchor,events:{onClick:i._onTocTitleClick.bind(i),onShow:function(){i.anchor.addClassName("checked")},onHide:function(){i.anchor.removeClassName("checked")}}}))},_expandWiki:function(){var e;e=new s({mid:this.model.getCommunity().get("mid")},{autoPopulate:!0}),this._widget&&this._widget.getAppName()===u.getMyCommunitiesAppKey()&&this.addControl("wikiTreeExpandedModal",new C({communityId:this._context.communityId,widget:this._widget,moveOnlyCurrentNode:!1,creation:!1,addWiki:e.canCreateWikiPages()||void 0,enterEditMode:e.canReorganizeWikiPages()||void 0})).show()},_createContent:function(){var t=this.model;if(this.anchor=e.createElement("div",{class:"toc-button",html:'<span class="fonticon fonticon-anchor"></span>'}),this.addControl("MenuTooltip",new w({target:this.anchor,body:p.Toc})),t.getToc()&&0===t.getToc().length&&this.anchor.hide(),this._addAnchor(),t)return[{class:"col-md-3 viewer-main-left-column",html:this._createMainLeftColumn.call(this)},{class:"col-md-9 wiki-viewer-body",html:[{class:"viewer-header",html:this._createTitleSection.call(this)},{tag:"div",class:"icon-mobile-content",html:[this.anchor,this.getOption("showTreeIcon")?{tag:"div",class:"expand-mobile-button",html:[{tag:"span",class:"fonticon fonticon-tree-view-flattened"}]}:""]},{class:"viewer-body",html:[{class:"viewer-top-section",html:this._createLeftColumn.call(this)},{class:"viewer-bottom-section"}]}]}]},_createAuthorSection:function(){return this.model.get("nb_contributors")&&this.model.get("nb_contributors")>1?this.addChildView("authorSectionView",new d({model:this.model,mode:"multiContributors",showThreadLink:this.getOption("showThreadLink")})):this._parent.call(this)},_createTitleSection:function(){var t,i,n=this,o=this.model,s=o.get("title"),a=this._createActionMenu();return"1"!==o.get("locked")&&!0!==o.get("locked")&&1!==o.get("locked")||(t=e.createElement("span",{class:"fonticon fonticon-lock"}),this.addControl("lockTooltip",new w({target:t,body:p.PageLocked}))),2!==parseInt(o.get("visibility"),10)&&0!==parseInt(o.get("visibility"),10)||(i=e.createElement("span",{class:"fonticon fonticon-user-key",events:{click:function(){require(["DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUIComponents/script/feature/core/user/view/user-mini-view","DS/SwymUIComponents/script/feature/core/modal/modal"],function(e,t,i){var s=o.getAssociated("authorizedusers");s.hasBeenFetched()||s.fetch({data:{community_id:o.getCommunity().get("mid")}});var a=n.addControl("privateUsersModal",new i({closable:!0,header:h.Peoplewhocanaccesstothisprivatepage,body:[{class:"private-users-modal",html:n.addChildView("usersList",{collection:s,Class:e,modelViewClass:t,modelViewsCfg:{attributes:{class:"float-left",styles:{"margin-bottom":"10px","min-width":"50%"}},modal:a}})},{html:'<div style="clear:both;"></div>'}]}));a.show()})}}}),this.addControl("visibilityTooltip",new w({target:i,body:p.PagePrivate}))),[{class:"content-title-section",html:[{class:"content-icon "+this._getIconWrapperCls(),draggable:this._isDraggable(),html:{tag:"span",class:"fonticon fonticon-2x fonticon-"+this.model.getIconClass()}},s===n.BLANK_TITLE_CODE?{class:"content-title",html:""}:this._renderTitle(),{class:"wiki-icon-wrapper",html:[t||null,i||null]},a]}]},_getBackArrowView:function(){var e=this.getChildView("backArrowView");return e||(e=this.addChildView("backArrowView",{Class:"DS/SwymUIComponents/script/feature/core/ui-components/back-arrow-view",model:this.model})),e},_createMainLeftColumn:function(){var e,i=this,n=i.model;if(n)return e=i.addChildView("wikiTreeButtonsView",new c({model:new s({mid:i.model.getCommunity().get("mid")},{autoPopulate:!0})})),t.Platform.ios||t.Platform.android||i.reactTo(e,"WikiEditToggle",function(){i.getChildView("wikiTreeView")&&i.getChildView("wikiTreeView").toggleEdit()}),{class:"wikitree-view-wrapper-container",html:[window.ds&&!0===window.ds.swymIM?"":i._getBackArrowView(),[{class:"wikitree-view-wrapper",styles:{"margin-right":"auto"},html:[{class:"heading",html:[{class:"wikitree-header",html:[{tag:"span",class:"fonticon fonticon-tree-view-flattened"},{tag:"span",html:h.Wikitree}]},e]},{class:"tree-wrapper",html:this._createTreeSection()}]}],this.addChildView("revisionView",{model:n,Class:"DS/SwymUIComponents/script/feature/community/wiki/view/revision-view"})]}},updateContentOwnSections:function(){var e=this.getElement(".viewer-main-left-column");e&&e.setContent(this._createMainLeftColumn());var t=this.getElement(".viewer-top-section");t&&t.setContent(this._createLeftColumn()),this._addAnchor()},_onTocTitleClick:function(e,t){var i=document.body.getElement("#"+t.name),n=this._widget.getAppName()===u.getContentReaderAppKey();"TD"===i.parentElement.tagName&&(i.style.position="relative"),window.ds&&!0===window.ds.swymIM||n?this.dispatchEvent("onScrollToElement",i):l.dispatchEvent("onScrollToElement",i)},_onRevisionReceived:function(t){this.model.set("content",t.attributes.message?t.attributes.message:t.attributes.content),this.model.set("title",t.attributes.title),this.getElement(".content-title-section").addClassName("diff-enabled"),e.is(this.getElement(".content-title-section").getElement(".content-title").getElement("span"))&&this.getElement(".content-title-section").getElement(".content-title").getElement("span").setHTML(t.attributes.title),this._addAnchor()},onSetModel:function(e,t,i){this.reactTo(i,"onRevisionReceived",this._onRevisionReceived),this._parent.call(this)},setWikiRootModel:function(){var e=this.model.get("mid"),t=this.model.get("is_root");if(e&&t){var n=new i(this.model.toJSON());n._attributes!==this.model._attributes&&(window.REALWIKITREEMODEL=n,this.setModel(n,{ignoreEquality:!0}))}}})}),define("DS/SwymUIComponents/script/feature/core/share/view/share-content-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/share/view/share-content-view","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUIComponents/script/feature/core/search/view/user-search-factory","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUIComponents/script/feature/core/modal/modal","DS/UIKIT/Input/Button","DS/UIKIT/Input/Text","DS/UIKIT/Toggler","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/lib/request/data","DS/Logger/Logger","DS/SwymUIComponents/script/utils/feature-activation-manager","DS/SwymUICore/script/feature/community/derived-type/derived-type-data-utils","i18n!DS/SwymUICore/assets/nls/feature/community/community/model/community-model"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w,C){"use strict";var f=i.extend({setup:function(){var e=this,t=this.model,i=t?"community"===t.getModelName()?t:t.getCommunity():null,n=i?i.get("mid"):null;g.isUsersGroupFeatureAvailable(function(t){require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/SwymUIComponents/script/feature/core/search/view/user-and-users-group-search-factory"],function(o,r){o.getPlatformConfig({platformId:s.getInstance().get("config").tenant.online_instance_id,key:"share",onComplete:function(o){e.addControl("user-search-control",(t?r:a).createUserSearchControl({mailAllowed:o,pendingUsersAllowed:!0,community_id:i&&i.getVisibility()===C.Secret?n:null,restricted:!1,multiSelect:!0,parentSwymView:e,events:{onSelect:function(){this.dispatchEvent("onSelectUser",arguments)}.bind(e),onUnselect:function(){this.dispatchEvent("onUnselectUser",arguments)}.bind(e)}})),e.refresh()}})})}),this._parent.apply(this,arguments)},_createContent:function(){var i=this.model,n=i?"community"===i.getModelName()?i:i.getCommunity():null,o=this.cid,s=this.getControl("user-search-control");return e.createElement("div",{html:[{tag:"label",html:t.CommunityOwner,for:"communityowner"+o},{styles:{margin:"10px"},html:[n&&n.getVisibility()===C.Secret?{html:t.SecretCommunityContent,class:"secret-community-message"}:"",s||{},{styles:{"margin-top":"10px"}}]}]})}});return n.extend({_modelClass:o,name:"share-content-view",modal:null,shareFb:!1,shareLinkedin:!1,shareTwitter:!1,communityId:0,contentId:0,contentType:null,url:null,shareTitle:"",shareMsg:"",serverModelName:null,selectedToggle:null,selectedUsersArray:[],getEndOfUrl:function(e){let t=e.contentType;return e.isDerivedType&&e.derivedTypeData&&(t=w.createTypeNameForDerivedType(e.derivedTypeData)),`/#${e.threadType}:${e.communityId}${e.contentId?`/${t}:${e.contentId}`:""}`},setup:function(i){var n,o=!0,a=this;a._parent.apply(a,arguments),a.selectedUsersArray=[],!0!==i.shareOnSocialNetworks&&!1!==i.shareOnSocialNetworks||(o=i.shareOnSocialNetworks),(n=s.getInstance().get("config").tenant)&&!0===o&&(a.shareFb=n.share_facebook,a.shareLinkedin=n.share_linkedin,a.shareTwitter=n.share_twitter);var l=a.model,d=l.getModelName();const m=void 0!==l.get("derived_type")&&null!==l.get("derived_type")&&null!==l.get("derived_type").id,h=m?l.get("derived_type"):void 0;switch(d){case"post":case"media":case"wiki":case"iquestion":case"idea":case"wedo":case"survey":case"social-event":a.contentType=d,a.contentId=l.get("mid"),l.get("community")&&(l.get("community").id||l.get("community").mid)&&(a.communityId=l.get("community").id||l.get("community").mid);break;case"im-event":a.contentType="message",a.contentId=l.get("mid"),(l.get("community")&&l.get("community").id||l.get("community").mid)&&(a.communityId=l.get("community").id||l.get("community").mid);break;case"community":a.communityId=l.get("mid")}switch(d){case"post":a.shareTitle=t.Sharethispost,a.serverModelName="Post";break;case"media":a.shareTitle=t.Sharethismedia,a.serverModelName="Media";break;case"wiki":a.shareTitle=t.Sharethiswiki,a.serverModelName="WikiTree";break;case"iquestion":a.shareTitle=t.Sharethisiquestion,a.serverModelName="iQuestion";break;case"idea":a.shareTitle=t.Sharethisidea,a.serverModelName="Ideation";break;case"community":a.shareTitle=t.Sharethiscommunity,a.serverModelName="community";break;case"survey":a.shareTitle=t.Sharethissurvey,a.serverModelName="Poll";break;case"im-event":a.shareTitle=t.Sharethismessage,a.serverModelName="InstantMessage";break;case"wedo":a.shareTitle=t.ShareThisWedo,a.serverModelName="Wedo";break;case"social-event":a.shareTitle=t.ShareThisRendezVous,a.serverModelName="conference"}var g={appId:u.getMyCommunitiesAppKey()};a.communityId&&a.contentType&&a.contentId?e.merge(g,{community:a.communityId,contentType:a.contentType,contentId:encodeURIComponent(a.contentId),communityType:r.getInstance().isDirectMessageContext()?"dm":"community"}):a.communityId&&e.merge(g,{community:a.communityId});const w=(new Date).getTime(),C=r.getInstance().isDirectMessageContext()?"dm":"community",y=a.getEndOfUrl({threadType:C,communityId:a.communityId,contentType:a.contentType,contentId:a.contentId,isDerivedType:m,derivedTypeData:h});window.ds&&window.ds.isMDE&&l.isDriveFile&&l.isDriveFile()?p.log("TODO"):(a.urlForLinkedin=`${u.getBaseUrl()}?${w}${y}`,a.url=`${u.getBaseUrl()}${y}`,a.fakeUrlInput&&a.fakeUrlInput.setValue(a.url||t.ShareUrlCannotBeComputed)),a.shareButton=new c({value:t.Share,className:"primary share",disabled:!0,events:{onClick:function(){a.dispatchEvent("onShare")}}}),a.cancelButton=new c({value:t.Cancel,className:"default cancel",events:{onClick:function(){a.modal.hide()}}}),a.okButton=new c({value:t.Ok,className:"primary share",events:{onClick:function(){a.modal.hide()}},attributes:{styles:{display:"none"}}});var v=a.addChildView("userSearchView",{Class:f,model:this.model});v.addEvent("onSelectUser",a.onSelectUser.bind(a)),v.addEvent("onUnselectUser",a.onUnselectUser.bind(a))},onSelectUser:function(e){var t=g.isFeatureActivated("activateUsersGroup")?e.uri:e.hash_key;this.selectedUsersArray.indexOf(t)<0&&(this.selectedUsersArray.push(t),this.shareButton.enable())},onUnselectUser:function(e){var t=g.isFeatureActivated("activateUsersGroup")?e.uri:e.hash_key,i=[];this.selectedUsersArray.forEach(function(e){e!=t&&i.push(e)}),this.selectedUsersArray=i},createBody:function(){var i=this,n=e.createElement("nav",{id:"share-tabs-navigation",class:"tab",html:[{tag:"a",class:"tab-item",html:'<span class="fonticon fonticon-users-add "></span>'+t.ShareWithUsers},{tag:"a",class:"tab-item",html:'<span class="fonticon fonticon-link "></span>'+t.ShareByLink},this.shareLinkedin||this.shareFb||this.shareTwitter?{tag:"a",class:"tab-item",html:'<span class="fonticon fonticon-share-alt "></span>'+t.ShareOnSocialNetworks}:{}]}),o=e.createElement("section",{id:"share-tabs-section",html:[{tag:"section",class:"hide",html:[{tag:"div",class:"share-user",html:[{tag:"span",html:t.ShareThisContentWithAnyUserOfYour3DEXPERIENCEPlatform,styles:{margin:"10px"}},this.getChildView("userSearchView"),{tag:"div",styles:{margin:"10px"},class:"share-message",html:i.shareMsg=new d({name:t.Message,className:"share-msg-swym-textarea",placeholder:t.EnterAMessage,multiline:!0,rows:4})}]}]},{tag:"section",class:"hide",html:[{tag:"span",html:t.AnyoneWithTheFollowingLinkWillAccessThisContent,styles:{margin:"10px"}},{class:"share-url-input",html:[this.fakeUrlInput=new d({value:this.url||t.ShareUrlCannotBeComputed,className:"left-text",disabled:"disabled"}),new c({value:t.CopyLink,buttonClassName:"default",className:"right-button default",events:{onClick:function(){navigator.clipboard.writeText(i.fakeUrlInput.getValue()).then(function(){require(["DS/UWPClientControls/PlatformNotify"],function(e){e.success(t.LinkHasBeenCopiedInYourClipboard)}),i.modal.hide()},function(){})}}})]}]},{tag:"section",class:"hide share-social-networks",html:[this.shareLinkedin?{tag:"div",class:"share-option linkedin",html:[this.linkedinShareToggle=new c({value:t.ShareToLinkedin,icon:"linkedin",className:"default large-icon"})]}:"",this.shareFb?{tag:"div",class:"share-option facebook",html:[this.fbShareToggle=new c({value:t.ShareToFb,icon:"facebook",className:"default large-icon"})]}:"",this.shareTwitter?{tag:"div",class:"share-option twitter",html:[this.twitterShareToggle=new c({value:t.ShareToTwitter,icon:"twitter",className:"default large-icon"})]}:""]}]}),s=e.createElement("div",{class:"share-tabs",html:[n,o]});return this.linkedinShareToggle&&this.linkedinShareToggle.addEvent("onClick",this.onShare.bind(this,this.linkedinShareToggle)),this.fbShareToggle&&this.fbShareToggle.addEvent("onClick",this.onShare.bind(this,this.fbShareToggle)),this.twitterShareToggle&&this.twitterShareToggle.addEvent("onClick",this.onShare.bind(this,this.twitterShareToggle)),s},onShare:function(e){if(0===this.selectedToggle){this.shareButton.load();var t=this.selectedUsersArray,i=o.adaptService({url:u.getBaseUrl()+"/api/notification/send",data:{type:this.serverModelName,recipient_hash:t.join(";"),do:"share",message:this.shareMsg.getValue(),related_model_id:"InstantMessage"===this.serverModelName&&this.model.getInstantMessage()?this.model.getInstantMessage().get("subject6wuri"):this.model.get("mid")},onComplete:this.onShareSuccessful.bind(this),onFailure:this.onShareFailed.bind(this)});h.request(i)}else this.linkedinShareToggle&&e===this.linkedinShareToggle?window.open("https://www.linkedin.com/shareArticle?mini=true&url="+escape(this.urlForLinkedin),"_blank","width=600,height=343,resizable=yes"):this.fbShareToggle&&e===this.fbShareToggle?window.open("http://www.facebook.com/sharer.php?u="+escape(this.url),"_blank","width=600,height=268,resizable=yes"):this.twitterShareToggle&&e===this.twitterShareToggle&&window.open("https://twitter.com/intent/tweet?url="+escape(this.url),"_blank","width=600,height=343,resizable=yes"),this.modal.hide()},onShareSuccessful:function(){this.modal.hide(),this.shareButton.load(!1),this.alert("success",t.Sharesuccessful)},onShareFailed:function(e){var i=t.Sharefailed,n=e&&e.errorcode;n&&"ERROR_COMMUNITY_SHARE_CONTENT_NOT_AUTHORIZED"===n&&(i=t.Shareaccesserror),this.shareButton.load(!1),this.alert("error",i)},onShareToggle:function(e,t){if(this.selectedToggle=t,this.modal)switch(t){case 0:this.shareButton.show(),this.cancelButton.show(),this.okButton.hide();break;case 1:case 2:this.shareButton.hide(),this.cancelButton.hide(),this.okButton.show()}},launchModal:function(){var e=this;this.modal=this.addControl("shareContentModal",new l({renderTo:window.widget&&window.widget.body,closable:!0,header:"<h4>"+this.shareTitle+"</h4>",body:this.createBody(),footer:[this.shareButton,this.cancelButton,this.okButton],events:{onHide:function(){this.modal.destroy(),this.destroy()}.bind(this),onShow:function(){new m({container:document.querySelector("#share-tabs-navigation"),bind:document.querySelector("#share-tabs-section"),events:{onToggle:function(t,i){e.onShareToggle(t,i)}}})}.bind(this)}})).inject(document.body).show()}})}),define("DS/SwymUIComponents/script/feature/community/media/view/lightbox-top-bar-actions/primary-actions-mixin",["require","exports","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/mobile/utils","DS/SwymUIComponents/script/feature/core/share/view/share-content-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/view/shared-lightbox-view","DS/UWPClientControls/PlatformNotify"],function(e,t,i,n,o,s,a){"use strict";var r=window.ds&&"MOBILE"===window.ds.env;return{launchDisabledEditModalCallback:function(e){a.warn("edit"===e?s.get("ODEEditNotAvailable"):s.get("ODECreationNotAvailable"))},_shareModalLaunchCallback:function(e){new o({model:e}).launchModal()},download:function(e){r?n.downloadMediaInNativeMobileDevice(e):this._download(e)},_download:function(e){var t;this._downloadUrl=i.getBaseUrl()+"/api/media/streammedia/id/"+e.get("mid")+"/type/original/output/download/",((t=i.getClientInformation()).isIphone||t.isIpad)&&t.isSafari&&this._myNewWindow&&this._myNewWindow.location?this._myNewWindow.location=this._downloadUrl:window.ds&&"3DD"===window.ds.env?window.open(this._downloadUrl,"_blank"):window.open(this._downloadUrl,"_self")}}}),define("DS/SwymUIComponents/script/feature/community/content/view/action-menu-view",["UWA/Core","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/lib/event-manager","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/community/community/collection/community-collection","DS/UIKIT/DropdownMenu","DS/SwymUIComponents/script/feature/core/modal/super-modal","DS/SwymUIComponents/script/feature/core/modal/modal","DS/UIKIT/Tooltip","DS/UIKIT/Input/Toggle","DS/UIKIT/Input/Button","DS/SwymUICore/script/utils/navigation","DS/Bookmark/script/BookmarkManager","UWA/Promise","DS/SwymUIComponents/script/feature/community/content/forward-modal","DS/SwymUICore/script/feature/community/wiki/model/wiki-model","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/view/abstract-content-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/generic/view/content-title-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-detailed-view","i18n!DS/SwymUIComponents/assets/nls/feature/core/tenant/view/tenant-media-processes-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-card-view","DS/SwymUICore/script/utils/usage-tracker","DS/SwymUICore/script/feature/core/context/context-constants","DS/SwymUICore/script/feature/core/history/history-model","DS/Logger/Logger","DS/SwymUICore/script/constants/community-constants","DS/SwymUIComponents/script/feature/core/modal/rss-feed-modal","DS/SwymUIComponents/script/utils/feature-activation-manager","DS/SwymUICore/script/feature/core/mobile/utils","DS/SwymUIComponents/script/feature/community/media/view/lightbox-top-bar-actions/primary-actions-mixin"],(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w,C,f,y,v,A,_,S,b,I,D,T,E,U,k,x,M,V,P)=>{const N=window.ds&&window.ds.isMDE,O=window.ds&&"MOBILE"===window.ds.env;return n.extend({name:"action-menu-view",_modelClass:a,_actionMenu:null,_isModelFetched:!1,_convertLayerView:null,_convertLayer:null,_limit:10,_isBookmarked:!1,_bookmark:null,defaultOptions:{ReportAbuse:!0,Edit:!0,Delete:!0,ConvertToIdea:!0,FollowUnfollow:!0,Bookmark:!0,LeaveCommunity:!0,RssFeed:!0,pinToThisTab:!0,Subscribe:!0,highlight:!0,forward:!0},setup(e){this._bootstrapModel=s.getInstance(),this._parent(e),this.model&&"media"===this.model.getContentType()&&this.setMediaEditable()},_reportAbuse(){const e=this;require(["DS/SwymUIComponents/script/feature/community/report-abuse/view/report-new-abuse-view","DS/SwymUICore/script/feature/community/report-abuse/model/report-abuse-model-v2"],(t,i)=>{const n=e.addChildView("reportNewAbuseView",new t({model:new i,reportedModel:e.model})),o=window.document||e._widget;n.render(o.body).show()})},_createContent(){const t=this,{model:i}=this,n=i.getCommunity();let o=e.createElement("div",{class:"content-available-actions",html:{tag:"span",class:"fonticon fonticon-2x fonticon-down-open"}});const s=o.getElement(".fonticon-down-open");return this.getOption("ReportAbuse")||this.getOption("Edit")||this.getOption("Delete")||this.getOption("ConvertToIdea")||this.getOption("FollowUnfollow")||this.getOption("Bookmark")||!n.isDirectMessage()&&!0===n.getDeleteRight()&&this.getOption("LeaveCommunity")||this.getOption("RssFeed")||this.getOption("pinToThisTab")||this.getOption("Subscribe")||this.getOption("highlight")||this.getOption("forward")?(s&&this.addControl("MenuTooltip",new h({target:s,body:A.Menu})),t._actionMenu=t.addControl("dropdownMenu",new d({target:this.container,renderTo:this.container,items:[{name:"loading",text:A.Loading}],className:"contextual-actions",events:{onShow:t._onActionsMenuShow.bind(t)}}))):o="",o},_onActionsMenuShow(){const e=this,t=[];let i;const n=r.getInstance();new f((t,n)=>{(i=c.prototype.getBlacklistedCommunitiesCollection(e._onActionsMenuShowFetchModels.bind(e,t,n))).hasBeenFetched()&&e._onActionsMenuShowFetchModels(t,n)}).then(()=>{t.push(new f(t=>{C.isContentBookmarked(e.model.get("subject6wuri"),i=>{i?i.message?e.model.deleteCustomProperty("bookmark"):(e.model.setCustomProperty("bookmark",i),e._isBookmarked=!0,e._bookmark=i):(e.model.setCustomProperty("bookmark",!1),e._isBookmarked=!1),t()})})),"media"!==e.model.getModelName()||n.hasBeenFetched()||t.push(new f(e=>{r.getInstanceFetched(()=>{e()})})),e.getOption("Subscribe")&&void 0===e.model.getCustomProperty("currentUserSubscribed")&&t.push(new f(t=>{const i={onComplete:t,onFailure:t};e.model.hasCurrentUserSubscribed(i)})),t.length>0&&f.all(t).then(()=>{e._buildActionsMenu()},function(){U.log("Promises failed",arguments)})})},_onActionsMenuShowFetchModels(e){const t=this,i=this._isModelFetched,{model:n}=this,o=this;let s=!1;if(i)e();else{const i=t._actionMenu;n.hasBeenFetched()&&(s=!0),n.fetch({fromCache:s,onComplete(){o.isDestroyed()||(i.removeItem(1),e(),o._isModelFetched=!0)}})}},_onSubscribeToggleItemClick(){this.model.getCustomProperty("currentUserSubscribed")?this.model.unsubscribe():this.model.subscribe()},_addCommonActions:function(e,i,n,s){let a=this,r=o.getInstance(),l=!r.isDirectMessageContext(),c=this._widget&&this._widget.getAppName&&this._widget.getAppName()===t.getProfileAppKey(),d=this._widget&&this._widget.getAppName&&this._widget.getAppName()===t.getMyCommunitiesAppKey();r.feedMode===k.CTY_CONTENT_LIST_MODE.COMPACTVIEW_MODE&&e.addItem({name:"share",className:"share",text:A.Share,fonticon:"forward",handler:this._onShareClick.bind(this)}),!1!==a.getOption("Bookmark")&&void 0!==this.model.getCustomProperty("bookmark")&&e.addItem({name:"bookmark-toggle",className:"bookmark-toggle",text:a._isBookmarked?S.RemoveFromBookmarks:S.Bookmark,fonticon:a._isBookmarked?"bookmark-delete":"bookmark-add",handler:a._onBookmarkToggleItemClick.bind(a)});const m=this._getDownloadItem();m&&e.addItem(m);const u=this._getForwardItem();u&&e.addItem(u),this.getOption("Subscribe")&&this.model.getAuthor().get("hash_key")!==this._bootstrapModel.get("user").hash_key&&void 0!==this.model.getCustomProperty("currentUserSubscribed")&&e.addItem({name:"subscribe",className:"subscribe-toggle",text:this.model.getCustomProperty("currentUserSubscribed")?S.UnsubscribeToActivities:S.SubscribeToActivities,fonticon:"bell-alt",handler:a._onSubscribeToggleItemClick.bind(a)}),"survey"!==n&&!1!==this.getOption("ConvertToIdea")&&l&&!c&&e.addItem({name:"convertToIdea",className:"convertToIdea",text:A.ConvertToIdea,fonticon:"lamp",handler:this._onConvertToIdeaItemClick.bind(this)}),d&&"media"===n&&("picture"===i.get("media_type")||"3d_model"===i.get("media_type")&&"3dskt"!==i.getFileExtension()&&"3dsto"!==i.getFileExtension())&&e.addItem({name:"convertToSketch",className:"convertToSketch",text:A.SketchIt,fonticon:"app-3dsketch",handler:this._onConvertToSketchClick.bind(this)}),N&&"media"===n&&M.isFeatureActivated("activateSketchCoreview")&&e.addItem({name:"sketchCoreview",className:"sketchCoreview",text:A.SketchCoreview,fonticon:"brush",handler:this._onSketchCoreviewClick.bind(this)}),!(s.get("highlighted_content_uri")===i.get("subject6wuri"))&&l&&s.getUserRole()>2&&!1!==this.getOption("highlight")&&e.addItem({name:"highlight-item",className:"highlight-item",text:A.Highlight,fonticon:"megaphone",handler:a._onHighlightItemClick.bind(a)}),"survey"!==n&&!1!==this.getOption("RssFeed")&&this._bootstrapModel.isFeatureActivated("active_rss")&&l&&e.addItem({name:"rssfeed-toggle",className:"rssfeed-toggle",text:S.SubscribeToRSSFeed,fonticon:"rss",handler:this._subscribeToRssFeed.bind(this,[s])}),M.isBetaFeatureActivated("wbcollab")&&"media"===n&&i.is3DWhiteboardExtension()&&i.getCommunity()&&i.getCommunity().isDirectMessage()&&e.addItem({name:"collaborate-toggle",className:"collaborate-toggle",text:A.Collaborate,fonticon:"user-change",handler:this._activateWhiteboardCollab.bind(this)}),M.isFeatureActivated("activateODEEditor")&&M.isBetaFeatureActivated("odecollab")&&"media"===n&&i.isDocumentOfficeExtension()&&i.getCommunity()&&i.getCommunity().isDirectMessage()&&e.addItem({name:"collaborate-toggle",className:"collaborate-toggle",text:A.Collaborate,fonticon:"user-change",handler:this._activateODECollab.bind(this)}),!1!==this.getOption("ReportAbuse")&&this._bootstrapModel.isFeatureActivated("activate_report_abuse_request")&&i.getAuthor().get("hash_key")!==this._bootstrapModel.get("user").hash_key&&l&&e.addItem({name:"reportAbuse",className:"reportAbuse",fonticon:"flag",text:A.ReportAbuse,handler:a._reportAbuse.bind(a)});let h=r.isCommunityContext(),p=r.isContentContext();!l||h&&!p||(!1!==this.getOption("FollowUnfollow")&&e.addItem({name:"follow-toggle",className:"follow-toggle",text:s.get("isBlacklisted")?S.Follow:S.Unfollow,fonticon:s.get("isBlacklisted")?"eye":"eye-slash",handler:a._onFollowToggleItemClick.bind(a)}),!0===s.getDeleteRight()&&!1!==this.getOption("LeaveCommunity")&&e.addItem({name:"leave",className:"leave",text:S.LeaveCommunity,fonticon:"logout",handler:this._onLeaveCommunityClick.bind(this,[s])}))},_onShareClick:function(){let e=this.model,t=this._widget;require(["DS/SwymUIComponents/script/feature/core/share/view/share-content-view"],function(i){new i({model:e,widget:t}).launchModal()})},_getForwardItem:function(){let e=null;const t=this.model.get("_acl");this.model.getModelName();return!0===this.getOption("forward")&&t&&t.forward&&!0===t.forward.access&&(e={name:"forward",classname:"forward",text:A.Forward,fonticon:"import",handler:this._onForwardItemClick.bind(this)}),e},_getDownloadItem:function(){let e=null;return this.model&&"media"===this.model.getContentType()&&(this.model.isDocumentOfficeExtension()&&!M.isFeatureActivated("activateODEViewer")||"1"===this.model.get("download_original_file")||"document"===this.model.get("media_type")&&!this.model.isDocumentOfficeExtension())&&(e={name:"download",classname:"download",text:A.Download,fonticon:"download",handler:this._onDownloadItemClick.bind(this)}),e},_getDeleteItem:function(){let e=null,t=!0,i=this.model.getModelName();return this.model.canDelete()&&!1!==this.getOption("Delete")&&("wiki"!==i||this._bootstrapModel.isFeatureActivated("activate_wiki_delete")||(t=!1),t&&(e={name:"delete",className:"delete",text:A.Delete,fonticon:"trash",handler:this._onDeleteItemClick.bind(this)})),e},_getPinToThisTabItem:function(e){let i=null,n=this.model.getCommunity();return!1!==this.getOption("pinToThisTab")&&window.ds&&"3DD"===window.ds.env&&window.widget&&widget.getAppName()===t.getMyCommunitiesAppKey()&&(i={name:"pinToThisTab-toggle",className:"pinToThisTab-toggle",text:S.PinToThisTab,fonticon:"pin",handler:this._pinToThisTab.bind(this,[n])}),i},_getRestartProcessing:function(){let e=null,t=this.model.getModelName(),i=this.model.getCommunity(),n=r.getInstance();return"media"!==t||!0!==this.model.get("reprocessable")||!this.model.getAuthor().isCurrentUser()&&i.getUserRole()!==l.COMMUNITY_OWNER_ROLE&&"1"!==n.get("tenant_admin")||(e={name:"restartProcessing",text:b.get("Restartprocessing"),fonticon:"refresh",handler:this.model.reprocess.bind(this.model)}),e},_addSpecialRightActions(e,t,i){if(t.canUpdate()&&!1!==this.getOption("Edit")&&("survey"!==i||"survey"===i&&!t.hasEnded()))if(this.model.get("_revisionToDisplay")>=0)e.addItem({name:"recover",className:"recover",text:A.RevertToThisRevision,fonticon:"ccw",handler:this._onEditItemClick.bind(this)});else{"media"===this.model.getModelName()&&(this.model.is3DSketchExtension()||this.model.is3DStoExtension());e.addItem({name:"edit",className:"edit",text:A.Edit,fonticon:"pencil",handler:this._onEditItemClick.bind(this)})}const n=this._getDeleteItem();n&&e.addItem(n);const o=this._getPinToThisTabItem();o&&e.addItem(o);const s=this._getRestartProcessing();s&&e.addItem(s)},_buildActionsMenu(){const{model:e}=this,t=e.getModelName(),i=r.getInstance(),n=e.get("_acl"),o=e.getCommunity(),s=this._actionMenu;if(!n)throw new Error("No acl in the current model!");for(;s.items.length>0;)s.removeItem(0);this._addCommonActions(s,e,t,o),s.addItem({className:"divider"}),this._addSpecialRightActions(s,e,t,o,i),0===s.items.length?s.options.target.hide():(s.options.target.show(),s.updatePosition())},_onEditItemClick(){const{model:e}=this,i=e.getCommunity(),n=e.get("mid"),s=e.getContentType(),a=i.get("mid"),r=o.getInstance();D.trackPageEvent({category:"ContentContextualActionMenu",label:"editClicked",view:"action-menu-view",event:"click",contentType:e.getModelName()}),"wiki"!==e.getContentType()?t.isMobile()&&"media"===e.getContentType()&&e.isDocumentOfficeExtension()?P.launchDisabledEditModalCallback("edit"):window.ds&&"3DD"===window.ds.env?w.goToContent(n,s,a,!0,void 0,void 0,"dm"===i.get("community_type")):r.reset({contentId:n,contentType:s,communityId:a,dmId:"dm"===i.get("community_type")?a:void 0,editionMode:!0}):require(["DS/SwymUICore/script/feature/core/edit-info/edit-info-manager"],t=>{t.isContentLockedForEdit(e.getSubjectURI()).then(e=>{e.length?t.showConcurrentEditionModal(!1,{view:"action-menu-view",users:e}):r.reset({contentId:n,contentType:s,communityId:a,dmId:"dm"===i.get("community_type")?a:void 0,editionMode:!0})})})},_onForwardItemClick(){this.addControl("forwardModal",new y({model:this.model})).show()},_onDownloadItemClick(){O?V.downloadMediaInNativeMobileDevice(this.model):this._download(this.model)},_download(e){this._downloadUrl=`${t.getBaseUrl()}/api/media/streammedia/id/${e.get("mid")}/type/original/output/download/`,window.ds&&"3DD"===window.ds.env?window.open(this._downloadUrl,"_blank"):window.open(this._downloadUrl,"_self")},_onDeleteItemClick(){const e=this;"wiki"===e.model.getModelName()?e.model.isLeafNode().then(t=>{!0===t?e._displayConfirmationModal(!1,_.Areyousureyouwanttodeletethispage):(e.deletionTypeModal||(e.addControl("onlyToggle",new p({className:"primary",checked:!1,value:_.Onlythispage,name:"deletionType"})),e.deletionTypeModal=e.addControl("deletionTypeModal",new u({header:`<h4>${_.Doyouwanttodelete}</h4>`,className:"fancy",body:[new p({className:"primary",checked:!0,value:_.Thispageanditssubpages,name:"deletionType"}),e.getControl("onlyToggle")],footer:[new g({className:"primary",value:A.Confirm,events:{onClick(){e.deletionTypeModal.hide(),e._displayConfirmationModal(!e.getControl("onlyToggle").isChecked(),e.getControl("onlyToggle").isChecked()?_.Areyousureyouwanttodeletethispage:_.Areyousureyouwanttodeletethispageanditssubpages)}}}),new g({value:_.Cancel,events:{onClick(){e.deletionTypeModal.hide()}}})],closable:!1}))),e.deletionTypeModal.show())}):e._displayConfirmationModal()},_displayConfirmationModal(e,t){const i=this;(this.getControl("confirmModal")||this.addControl("confirmModal",new m({closable:!0,renderTo:window.document.body||this._widget.body}))).confirm({title:A.Confirm,message:t||A.ContentDeletionMsg,callback(t){if(!0===t){let t;(t="wiki"===i.model.getModelName()&&e?i.model.setSubPages():Promise.resolve()).then(()=>{i.model.destroy({data:e?{mustDeleteSubpages:e}:null,onComplete(){const e=o.getInstance();i.alert("success",A.ContentDeleted),e.isContentContext()&&("wiki"===e.contentType?e.reset({communityId:e.communityId,path:`community:${e.communityId}`}):E.backToListing())},onFailure(){console.error("error",arguments),i.alert("error",A.ContentNotDeleted)}})})}}})},_onConvertToSketchClick(){if(N){o.getInstance().reset({quadrant:T.WEST_QUADRANT,path:`${T.WEST_QUADRANT}/${T.SKETCH_CREATION_URL_PART}:${this.model.get("mid")}`})}else w.goToSketchCreation(this.model.get("mid"))},_onSketchCoreviewClick(){const e=this,t=o.getInstance();let i=null;window.require(["DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model"],n=>{i=new n({mid:e.model.getAssociated("community").get("mid")}),t.reset({quadrant:T.WEST_QUADRANT,path:`${T.WEST_QUADRANT}/${T.SKETCH_CREATION_URL_PART}:${e.model.get("mid")}`,coreviewData:{action:"initCoreview",data:{communityId:e.model.get("community->mid"),mediaId:e.model.get("mid"),login:i.getAssociated("users").toJSON()}}})})},_onConvertToIdeaItemClick(){const e=this;require(["DS/SwymUIComponents/script/feature/community/idea/view/idea-converter-view","DS/SwymUIComponents/script/feature/core/modal/modal","i18n!DS/SwymUIComponents/assets/nls/feature/community/generic/view/content-title-view","DS/UIKIT/Input/Button"],(t,i,n,o)=>{e._convertLayerView?e._convertLayerView.setModel(e.model):(e._convertLayerView=e.addChildView("convertLayerView",new t({model:e.model})),e._convertLayer=e.addControl("convertLayer",new i({header:n.Contenttoidea,className:"convert-idea-modal-wrapper",body:[e._convertLayerView],footer:[e._convertLayerView.addControl("create",new o({value:n.Create,className:"primary",key:"return",events:{onClick(){e._convertLayerView.convertIdea(e._convertLayer)}}})),new o({value:n.Cancel,key:"esc",events:{onClick(){e._convertLayer.hide()}}})]}))),e._convertLayer.show()})},_onHighlightItemClick(){const{model:e}=this,t=e.getCommunity();e&&t&&(t.addChanges("highlighted_content_uri",e.get("subject6wuri")),t.save({},{onComplete:function(){this.alert("success",A.HighlightSuccess)}.bind(this),onFailure:function(){this.alert("error",A.HighlightFailure)}.bind(this)}))},_onFollowToggleItemClick(){const e=this,t=this.model.getCommunity(),n=this.getControl("confirmModal")||this.addControl("confirmModal",new m({closable:!0,renderTo:window.document.body||this._widget.body}));!1===t.get("isBlacklisted")?n.confirm({title:`${S.Hideallupdates} ${t.get("title").unescapeHTML()}`,message:S.Youwillstillbe,callback(n){!0===n&&t.unfollow({onFailure(e,t){console.error("error",t)},onComplete(){e.alert("success",S.nownotfollowing),t.set("isBlacklisted",!0),i.dispatchEvent("requestContentListUpdate",{contextPath:"home"})}})}}):t.follow({onFailure(e,t){console.error("error",t)},onComplete(){e.alert("success",S.nowfollowing),t.set("isBlacklisted",!1),i.dispatchEvent("requestContentListUpdate",{contextPath:"home"})}})},_onBookmarkToggleItemClick(){let e;const i=/^.*(\/#app.*)url.*(community=.*)/;this._isBookmarked?(C.remove(this._bookmark),D.trackPageEvent({category:"Bookmark",label:"deleteBookmark",view:"action-menu-view",event:"click"})):(e=(e=t.get3DDTransientAppUrl({appId:t.getMyCommunitiesAppKey(),community:this.model.get("community->mid")||this.model.get("community->id"),contentType:this.model.getContentType(),contentId:this.model.get("mid"),communityType:this.model.get("community").users?"dm":"community"})).match(i),C.add({title:this.model.get("title"),subjectUri:this.model.get("subject6wuri"),serviceName:"3DSwym",linkServiceName:"3DSwym",linkUri:e[1]&&e[2]?e[1]+e[2]:""}),D.trackPageEvent({category:"Bookmark",label:"createBookmark",view:"action-menu-view",event:"click"}))},_subscribeToRssFeed(){const e=`${t.getBaseUrl()}${this.model.getRssLink(this._limit)}`;x.createModal(e,!1)},_activateODECollab(){const{model:e}=this;require(["DS/RTAudioVideoAPI/RTAudioVideoAPI","DS/SwymUICore/script/feature/core/config/bootstrap-model"],(t,i)=>{const{users:n}=e.get("community"),o=e.get("community").mid;let s=n&&n.map(e=>e.login);const a=e.get("play"),r=i.getInstance().get("user").login;s=s.filter(e=>e!=r),t.startCall({logins:s,type:"ode",dmId:o,data:{mediaId:e.get("mid"),title:e.get("orig_name"),ext:e.get("media_file_ext"),url:a&&a.download_original_url&&a.download_original_url.transient_url_as_attachment}})})},_activateWhiteboardCollab(){const{model:e}=this;require(["DS/RTAudioVideoAPI/RTAudioVideoAPI","DS/SwymUICore/script/feature/core/config/bootstrap-model"],(t,i)=>{const{users:n}=e.get("community"),o=e.get("community").mid;let s=n&&n.map(e=>e.login);const a=e.get3DFileURL(),r=i.getInstance().get("user").login;s=s.filter(e=>e!=r),t.startCall({logins:s,type:"whiteboard",dmId:o,data:{fileUrl:a,edit:!0,modelUrl:a,wakeUpUrl:e.get("play")&&e.get("play").wake_up_url,model:e,threadType:e.getThreadType(),threadId:e.getThreadId(),whiteboard:!0,coreview:{action:"initCoreview",room_id:null,noCall:!0,collabExperienceOrigin:!0,logins:s,data:{communityId:o,logins:s,mediaId:e.get("mid"),room_id:null}}}})})},_pinToThisTab(){window.ds&&"3DD"===window.ds.env&&window.widget&&widget.getAppName()===t.getMyCommunitiesAppKey()&&t.pinToDashboard({appId:t.getContentReaderAppKey(),data:{url:t.getBaseUrl(),community:this.model.get("community").id,contentId:this.model.get("mid"),contentType:this.model.get("id").split(":").shift()}})},_onLeaveCommunityClick(e){const t=e[0];(this.getControl("confirmModal")||this.addControl("confirmModal",new m({closable:!0,renderTo:window.document.body||this._widget.body}))).confirm({title:S.deletequestion,message:S.removeMyAccessToThisCommunity,callback:function(e){const n=this;!0===e&&t.deletecurrentuserfromcommunity({onComplete(){n.alert("success",S.Youhavebeendeletedfromthiscommunity),i.dispatchEvent("requestContentListUpdate",{contextPath:"home"})},onFailure:function(e,t){"ERROR_TRY_TO_LEAVE_COMMUNITY_WITH_IMPLICIT_ROLE"===t.errorcode&&this.alert("error",I.ErrorTryToLeaveCommunity)}.bind(this)})}.bind(this)})},setMediaEditable(){const e=this.model.get("media_type");["picture","whiteboard","sketch","story"].includes(e)||this.model.isDocumentOfficeExtension()&&M.isFeatureActivated("activateODEEditor")?this.setOption("Edit",!0):this.setOption("Edit",!1)}})}),define("DS/SwymUIComponents/script/feature/community/media/view/uploader/dropzone-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/view/dropzone-view","UWA/Utils","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/feature/community/media/model/media-file-extension-model","DS/SwymUICore/script/utils/utils","DS/SwymUIComponents/script/feature/community/media/view/media-tooltip-view","DS/SwymUICore/script/feature/community/media/model/media-model","DS/WebappsUtils/Console","DS/Bookmark/script/BookmarkManager","DS/WebappsUtils/WebappsUtils","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/utils/usage-tracker","DS/SwymUIComponents/script/utils/feature-activation-manager","DS/SwymUIComponents/script/feature/community/media/view/lightbox-top-bar-actions/primary-actions-mixin"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g){"use strict";var w=window.ds&&"3DD"===window.ds.env,C=i.Client.Platform.ios||i.Client.Platform.android,f=i.Client.Features.dragAndDrop&&!C&&(!w||w&&s.isCORSActivated());return n.extend({name:"dropzone",_mediaFileExtension:null,_dropzoneDragCounter:0,_availableMediaTypes:[],_hideODE:!0,typeAllowed:null,dragItem:null,mode:null,domEvents:f?{"dragenter .media-uploader-dropzone":"_dragenter","dragover .media-uploader-dropzone":"_dragover","dragleave .media-uploader-dropzone":"_dragleave","drop .media-uploader-dropzone":"_drop","change .media-uploader-file-input":"_filesSelected","click .sketch-wrapper":"_sketchClick","click .sketch-section":"_sketchClick","click .story-wrapper":"_storyClick","click .whiteboard-wrapper":"_whiteboardClick","click .whiteboard-section":"_whiteboardClick","click .files-wrapper":"_clickFilesWrapper","click .doc-text.section":"_clickNewTextDoc","click .doc-slide.section":"_clickNewSlideDoc","click .doc-table.section":"_clickNewTableDoc"}:{"change .media-uploader-file-input":"_filesSelected","click .sketch-wrapper":"_sketchClick","click .sketch-section":"_sketchClick","click .story-wrapper":"_storyClick","click .whiteboard-wrapper":"_whiteboardClick","click .whiteboard-section":"_whiteboardClick","click .files-wrapper":"_clickFilesWrapper","click .doc-text.section":"_clickNewTextDoc","click .doc-slide.section":"_clickNewSlideDoc","click .doc-table.section":"_clickNewTableDoc"},_clickNewTextDoc:function(){h.trackPageEvent({category:"ContentCreation",label:"createTextIconClick",view:"dropzone-view",event:"click"}),s.isMobile()?g.launchDisabledEditModalCallback("creation"):this.createNewDocument({doctype:"text"})},_clickNewSlideDoc:function(){h.trackPageEvent({category:"ContentCreation",label:"createSlideIconClick",view:"dropzone-view",event:"click"}),s.isMobile()?g.launchDisabledEditModalCallback("creation"):this.createNewDocument({doctype:"slide"})},_clickNewTableDoc:function(){h.trackPageEvent({category:"ContentCreation",label:"createTableIconClick",view:"dropzone-view",event:"click"}),s.isMobile()?g.launchDisabledEditModalCallback("creation"):this.createNewDocument({doctype:"table"})},createNewDocument:function(e){this.dispatchEvent("triggerDocumentCreationRequest",[e])},_sketchClick:function(){h.trackPageEvent({category:"ContentCreation",label:"createSketchIconClick",view:"dropzone-view",event:"click"}),m.goToSketchCreation()},_storyClick:function(){h.trackPageEvent({category:"ContentCreation",label:"createStoryIconClick",view:"dropzone-view",event:"click"}),m.goToStoryCreation()},_whiteboardClick:function(){h.trackPageEvent({category:"ContentCreation",label:"createWhiteboardIconClick",view:"dropzone-view",event:"click"}),m.goToWhiteboardCreation()},_clickFilesWrapper:function(e){var t=this.getElement("input.media-uploader-file-input");e.target!==t&&t.click()},_createContent:function(){var i=this;if(!this._availableMediaTypes)return;const n=this._availableMediaTypes.includes("sketch")&&this._hideODE,o=this._availableMediaTypes.includes("sketch")&&!this._hideODE,s=this._availableMediaTypes.includes("whiteboard")&&this._hideODE,a="'files-wrapper wrapper'"+(1===this._availableMediaTypes.length?" single":""),r=e.Utils.Client.Features.touchEvents||1==this._availableMediaTypes.length?"":" <div class='fonticon fonticon-help-circled'> </div>",l=`<div class= 'sketch-wrapper wrapper'> \n\t\t\t\t\t\t\t\t<label> ${t.Sketch} </label> \n\t\t\t\t\t\t\t\t<div class='fonticon fonticon-app-3dsketch'></div>\t\n\t\t\t\t\t\t\t  </div>`,c=`<div class='sketch-whiteboard-wrapper wrapper multi-item-col'> \n\t\t\t\t\t\t\t\t\t\t\t<div class='sketch-section section'> \n\t\t\t\t\t\t\t\t\t\t\t\t<div class='fonticon fonticon-app-3dsketch'></div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class = 'label'> ${t.Sketch}</div> \n\t\t\t\t\t\t\t\t\t\t\t</div> \n\t\t\t\t\t\t\t\t\t\t\t<div class='whiteboard-section section'> \n\t\t\t\t\t\t\t\t\t\t\t\t<span class='whiteboard-icon'></span> \n\t\t\t\t\t\t\t\t\t\t\t\t<div class='label'> ${t.WhiteBoard}</div>\n\t\t\t\t\t\t\t\t\t\t\t</div> \n\t\t\t\t\t\t\t\t\t\t</div>`,d=`<div class ='whiteboard-wrapper wrapper'> \n\t\t\t\t\t\t\t\t\t<div class='label'> ${t.WhiteBoard} </div> \n\t\t\t\t\t\t\t\t\t<span class='whiteboard-icon'></span>\n\t\t\t\t\t\t\t\t  </div>`,m=`<div class='story-wrapper wrapper'> \n\t\t\t\t\t\t\t \t<div class='label'>${t.Story}</div> \n\t\t\t\t\t\t\t \t<div class='fonticon fonticon-app-3dstory'></div>\n\t\t\t\t\t\t\t </div>`,u=`<div class= 'ode-wrapper wrapper multi-item-col'>  \n\t\t\t\t\t\t\t\t<div class='doc-slide section'> \n\t\t\t\t\t\t\t\t  \t<div class='fonticon fonticon-presentation-slide-layout'></div> \n\t\t\t\t\t\t\t   \t\t<div class='label'> ${t.Slide} </div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t    \t<div class='doc-text section'> \n\t\t\t\t\t\t    \t\t<div class='fonticon fonticon-doc-log'> </div>  \n\t\t\t\t\t\t\t\t\t<div class='label'> ${t.Text} </div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t    \t<div class='doc-table section'> \n\t\t\t\t\t\t   \t\t\t<div class='fonticon fonticon-table'></div>\n\t\t\t\t\t\t\t\t\t<div class='label'> ${t.Table} </div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t    </div>`,h=`<div class = ${a}> \n\t\t\t\t\t\t\t \t<div class='label'> ${t.Upload} </div>\n\t\t\t\t\t\t\t \t<div class='legend'> \n\t\t\t\t\t\t\t \t\t<div>${t.Dnd} </div>\n\t\t\t\t\t\t\t\t\t${r}\n\t\t\t\t\t\t\t \t</div> \n\t\t\t\t\t\t\t \t<div class='browse-btn fonticon fonticon-upload'>\n\t\t\t\t\t\t\t\t\t\t<input class='media-uploader-file-input' type='file' multiple='multiple' name='userFile'> \t\t\t\t\t\n\t\t\t\t\t \t\t\t\t</div>\n\t\t\t\t\t\t\t</div>`,p=`<div class='drop-wrapper'> \n\t\t\t\t\t    \t\t\t \t<div class='fonticon fonticon-drag-drop'> </div> \n\t\t\t\t\t\t\t       \t\t<div class='text'>${t.DropFilesHere} </div>\n\t\t\t\t\t\t\t       </div>`;var g=e.createElement("div",{class:"media-uploader-dropzone",html:` ${n?l:""} \n\t\t\t\t\t\t\t${o?c:""}  \n\t\t\t\t\t\t\t${s?d:""}\n\t\t\t\t\t\t\t${this._availableMediaTypes.includes("story")?m:""} \n\t\t\t\t\t \t\t${this._hideODE?"":u} \n\t\t\t\t\t \t\t${this._availableMediaTypes.includes("files")?h+p:""} `});return this._widget.addEvent("ContentDragStarted",function(e){i.dragItem=e}.bind(this)),this._widget.addEvent("ContentDragEnded",function(){i.dragItem=null}.bind(this)),g},setup:function(e){this._parent.apply(this,arguments),this._mediaFileExtension=o.getInstance(),this.showCollection=e.showCollection,this.performAdditionalChecks=e.performAdditionalChecks,this.typeAllowed=e.typeAllowed?e.typeAllowed:"all",this.mode=e.mode?e.mode:"media",this._availableMediaTypes=e.availableMediaTypes,this._availableMediaTypes.includes("ode")&&p.isFeatureActivated("activateODEEditor")&&(this._hideODE=!1,this.refresh()),this._mediaFileExtension.hasBeenFetched()||(this.mask(),this.reactTo(this._mediaFileExtension,"onDocumentedFileExtensionsCreated",function(){this.unmask()}))},_dragleave:function(e){var t=this.container.getElement(".media-uploader-dropzone");e.stopPropagation(),e.preventDefault(),this._dropzoneDragCounter--,0===this._dropzoneDragCounter&&(t.hasClassName("dragover")?t.removeClassName("dragover"):t.hasClassName("dragoverForbidden")&&t.removeClassName("dragoverForbidden"))},_dragenter:function(e){var t=this._checkDropAllowed(e.dataTransfer),i=this.container.getElement(".media-uploader-dropzone");e.stopPropagation(),e.preventDefault(),0!==this._dropzoneDragCounter||i.hasClassName("dragover")||i.hasClassName("dragoverForbidden")||(t?i.addClassName("dragover"):i.addClassName("dragoverForbidden")),this._dropzoneDragCounter++},_dragover:function(e){e.stopPropagation(),e.preventDefault()},_drop:function(e){e.stopPropagation(),e.preventDefault(),this._dropzoneDragCounter=0;var t=e.dataTransfer,i=t.files,n=JSON.parse(t.getData("text")||"{}"),o=!0;if(0===i.length&&"3DXContent"===n.protocol&&"bookmark"!==this.mode){var s=n.data&&n.data.items[0],a=new r(s);s&&"text/directory"!==s.objectType?(i=[],a.addChanges("is_illustration",!1),i.push(a),this.dispatchEvent("on3DDriveMediaSelected",[i])):o=!1}else this._handleFiles(i);o&&this.container.removeClassName("dragover").removeClassName("dragoverForbidden")},_filesSelected:function(e){var t=e.target.files;if(!(t.length>0))return!1;this._handleFiles(t)},_handleFiles:function(t){if("bookmark"===this.mode&&this.dragItem){var i=this.dragItem.data.items[0];c.add({title:i.displayName,subjectUri:i.subjectUri,serviceName:"3DSwym",linkServiceName:"3DSwym",linkUri:i.urlContent["3DD"]})}else t&&t.length>0&&(e.is(this.performAdditionalChecks,"function")?this.performAdditionalChecks(t):(this.dispatchEvent("onFilesSelected",t),this.resetInputField()),this.container.getElement(".media-uploader-dropzone").removeClassName("dragover"))},_checkDropAllowed:function(e){var t=null;if("all"===this.typeAllowed)return!0;if(this.dragItem&&this.dragItem.protocol===this.typeAllowed)return!0;if(e.items&&e.items[0]){if((t=e.items[0].kind)===this.typeAllowed||"string"===t)return!0}else if(e.types&&e.types[0]&&("Files"===(t=e.types&&e.types[0])&&(t="file"),t===this.typeAllowed||"string"===t))return!0;return!1},resetInputField:function(){this.getElement(".media-uploader-file-input").value=""},onRedraw:function(){this.getElement(".fonticon-help-circled")&&this.addChildView("mediaTooltipView",new a({model:this._mediaFileExtension,target:this.getElement(".fonticon-help-circled")})).addEvent("render",this.unmask)}})}),define("DS/SwymUIComponents/script/feature/community/social-event/view/rdv-minutes-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUIComponents/script/feature/community/content/view/simple-editor-view","DS/SwymUIComponents/script/feature/community/social-event/utils/social-event-constants","DS/SwymUIComponents/script/feature/community/content/edit/content-editor-body-view-with-advanced-rte","DS/SwymUIComponents/script/feature/community/content/edit/paragraph-formatter","UWA/Utils/Client"],function(e,t,i,n,o,s,a){return t.extend({name:"rdv-minutes-view",setup(e){return this.model=e.model,this.mode=e.mode,this.isReportPublished=e.isReportPublished,this.mode===n.REPORT_MODE&&this.addChildView("advancedRTE",new o({className:"rdv-minutes-rte",rtePlaceholder:"Enter minutes",mandatory:!1,cssPlaceholder:!0,modelAttr:"minutes",model:this.model,mediaInsertion:!1})),this._parent.apply(this,arguments)},getRTEContent:function(){let e=this.getChildView("advancedRTE")&&this.getChildView("advancedRTE").getElement(".editable-container"),t="";return e&&(t=e.getHTML().replace(/\u200B/g,"").replace(/(\u00A0|&nbsp;)(?!$)(?!<br>)(?!<\/)/g," ")),t},_createContent(){let t=[e.createElement("div",{class:"heading",html:"Minutes"})];if(this.mode===n.REPORT_MODE){const e=this.getChildView("advancedRTE");a.Features.touchEvents&&!this.getChildView("paragraphFormatter")&&t.push(this.addChildView("paragraphFormatter",new s({className:"paragraph-touch",extraEditor:e,mode:"touch"}))),t.push(e)}else this.isReportPublished&&""!==this.model.get("minutes")?(t.push(e.createElement("div",{class:"minutes-container",html:this.model.get("minutes")||""})),this.container.addClassName("report-published")):t=null;return t}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/content-type-selector",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUIComponents/script/utils/content-creation-types-manager","DS/UIKIT/DropdownMenu","DS/Logger/Logger","DS/SwymUICore/script/feature/core/context/context-model"],(e,t,i,n,o,s)=>{const a=t.extend({_typesManager:null,_contentIconEl:null,name:"content-type-selector",iconCls:null,defaultOptions:{typeIsChangeable:!0},currentItems:[],contentTypeSelector:null,getCurrentContentType(){return this._typesManager.getCurrentContentType()},getCurrentContentTypeClass(){const e=this._typesManager.getTypeItemData(this.getCurrentContentType());return e&&e.className},_getIconWrapperCls(){return this._typesManager.getTypeIconClasses()[this.getCurrentContentType()]},_createContent(){return{class:`content-type-selector-wrapper${this._typesManager._types&&this._typesManager._types.length<=1?" no-dropdown-available":""}`,html:{class:`content-icon ${this.getCurrentContentTypeClass()}`,html:[{tag:"span",class:`fonticon fonticon-2x fonticon-${this._getIconWrapperCls()}`},{tag:"span",class:"fonticon fonticon-down-open",styles:{width:"14px","vertical-align":"top",display:this.hideSelector()?"none":""}},{tag:"span",class:"fonticon fonticon-2x fonticon-plus"}]}}},init(...e){const t=this._parent(...e);return this.onContentTypesChangeBound=this.onContentTypesChange.bind(this),this.onCurrentContentTypeChangeBound=this.onCurrentContentTypeChange.bind(this),this.changeContentTypeIconBound=this.changeContentTypeIcon.bind(this),this._typesManager=i.getInstance(),this.setCurrentItems(this._typesManager.getContentTypes()),this._typesManager.addEvent("onContentTypesChange",this.onContentTypesChangeBound,this,!0),this._typesManager.addEvent("onContentTypeIconChange",this.changeContentTypeIconBound,this,!0),this._typesManager.addEvent("onCommentSubjectContentTypeChange",this._onCommentSubjectContentTypeChange.bind(this),this,!0),t},setup(...e){return this._context=s.getInstance(),this._parent(...e)},setCurrentItems(e){this.currentItems=e},hideSelector(){return!1===this.options.typeIsChangeable||this.currentItems.length<=1},onContentTypesChange(t){if(!t||!t.contentTypes)throw new Error("No content types provided");this.setCurrentItems(e.clone(t.contentTypes)),this.refresh()},_onCommentSubjectContentTypeChange(e){if(this.container){const t=this.container.getElement(".content-icon");t&&t.setAttributes({"data-comment-subject-content-type":e.commentSubjectContentType})}},onCurrentContentTypeChange(){this.refresh()},trackEvent(e){require(["UWA/Utils/Client","DS/SwymUICore/script/utils/usage-tracker"],(t,i)=>{const n=t.Features.touchEvents?"mobile":"desktop";i.trackPageEvent({category:"ContentCreation",label:"contentTypeChanged",view:"content-type-selector",event:"click",device:n,contentType:e})})},onRedraw(){const e=e=>{this._typesManager.setContentTypeRequest({type:e.name,updateIcon:!0,forceFocus:!0,userAction:!0}),this.trackEvent(e.name)};this.contentTypeSelector&&this.contentTypeSelector.destroy(),this.contentTypeSelector=new n({target:this.container,className:"type-selector",items:[],removeOnHide:!1,renderTo:"TIMELINE_MODE"===this._context.feedMode?"":this.container,events:{onClick(t,i){o.log(i),e(i)}}}),this.updateItemsInContentTypeDropDownMenu(),this.hideSelector()?this.contentTypeSelector.getContent().setStyle("visibility","hidden"):this.contentTypeSelector.getContent().setStyle("visibility","")},changeContentTypeIcon(e){let t,i,n,o,s,a;const r=this._typesManager.getTypeItemData(),l=this._typesManager.getTypeIconClasses();e.oldType!==e.newType&&(t=this.getElement(".content-icon"),i=`fonticon-${l[e.oldType]}`,n=`fonticon-${l[e.newType]}`,s=r[e.oldType]?r[e.oldType].className:e.oldType,a=r[e.newType]?r[e.newType].className:e.newType,o=t&&t.getElement(`.${i}`),t&&(t.hasClassName(s)&&t.removeClassName(s),t.addClassName(a),o&&(o.removeClassName(i),o.addClassName(n))),this.contentTypeSelector&&(this.contentTypeSelector.enableItem(e.oldType),this.contentTypeSelector.disableItem(e.newType)))},updateItemsInContentTypeDropDownMenu(){const e=this._typesManager.getTypeItemData();this.contentTypeSelector&&(Object.keys(e).forEach(function(e){this.contentTypeSelector.getItem(e)&&this.contentTypeSelector.removeItem(e)},this),Object.keys(e).forEach(function(t){this.currentItems.indexOf(t)>=0&&!this.contentTypeSelector.getItem(t)&&this.contentTypeSelector.addItem(e[t])},this),this.contentTypeSelector.disableItem(this.getCurrentContentType()))},destroy(...e){this._typesManager.removeEvent("onContentTypesChange",this.onContentTypesChangeBound),this._typesManager.removeEvent("onContentTypeIconChange",this.changeContentTypeIconBound),this._parent(...e)}});return a.POST=i.POST,a.IDEA=i.IDEA,a.QUESTION=i.QUESTION,a.MEDIA=i.MEDIA,a.SURVEY=i.SURVEY,a.WIKI=i.WIKI,a.WEDO=i.WEDO,a}),define("DS/SwymUIComponents/script/feature/community/wedo/edit/wedo-creator-factory",["UWA/Core","UWA/Utils/Client","DS/SwymUIComponents/script/feature/community/content/edit/content-editor-body-view-with-rte","DS/SwymUIComponents/script/feature/community/content/edit/content-editor-body-view-with-advanced-rte","DS/SwymUIComponents/script/feature/community/wedo/view/wedo-more-details-view","DS/SwymUIComponents/script/feature/community/wedo/view/wedo-change-status-view","DS/UIKIT/Toggler","i18n!DS/SwymUIComponents/assets/nls/feature/community/wedo/view/wedo-detailed-view"],function(e,t,i,n,o,s,a,r){"use strict";return{getClass:function(l){var c=i;return"advanced"===l&&(c=n),c.extend({name:"wedo-editor-body-view",_modelEvents:{onVirtualChange:"contentChanged"},domEvents:{"click .wedo-attachment-link":"_onAttachmentClick"},defaultOptions:{modelAttrForMedia:"attachments"},mode:"advanced"===l?"wedoCreator":"advancedWedoCreator",setup:function(){var i=this._getMediaEditionView();const n=t.Features.touchEvents;return i.addEvent("onRedraw",function(t){console.log("mediaEditionViewRendered"),e.createElement("div",{class:`wedo-header-details ${n?"wedo-attachments-header":""}`,html:[{class:"wedo-header-details-title",html:r.Attachments},{tag:"a",class:"wedo-attachment-link",html:r.AddAttachment}]}).inject(t.container,"top")}),this._parent.apply(this,arguments)},setTab:function(e){this.container.setAttribute("wedo-tab-index",e)},refreshContent:function(e){if(this._parent.apply(this,arguments),e.assigneesData){var t=this.getChildView("wedoAssignees");t&&(t.setAssigneeCollection(e.assigneesData),t.refresh())}if(e.plannedEnd){var i=this.getChildView("wedoChangeStatusView");i&&i.setEstimatedEndDate(e.plannedEnd)}},onRedraw:function(){console.log("on entering mode"),this.setTab(0)},insertMediaIntoTextEditor:function(){},validateContent:function(){return!0},_createWeDoTab:function(e,t){return{tag:"a",class:"tab-item "+(t?"active":""),html:[{tag:"span",class:"fonticon fonticon-"+e}]}},_createWedoTabBar:function(){var t=e.createElement("div",{class:"wedo-touch-tab-bar tab tab-icons",html:[this._createWeDoTab("pencil",!0),this._createWeDoTab("calendar",!1),this._createWeDoTab("users",!1),this._createWeDoTab("attach",!1)]});return this.addControl("status-bar",new a({container:t,events:{onToggle:function(e,t){this.setTab(t)}.bind(this)}})),t},_createContent:function(){var e=this._getMediaEditionView(),t=this._parent.apply(this,arguments),i=this.addChildView("wedoChangeStatusView",{model:this.model,mode:"edit",Class:s,widget:this._widget,onlyDatePicker:!1,events:{estimatedEndDateSet:function(e,t){t||n.setEstimatedEndDate(e,!0)}}}),n=this.addChildView("wedoChangeStatusViewOnlyDate",{model:this.model,mode:"edit",Class:s,widget:this._widget,onlyDatePicker:!0,events:{estimatedEndDateSet:function(e,t){t||i.setEstimatedEndDate(e,!0)}}}),a=this.addChildView("wedoProjectDetails",{Class:"DS/SwymUIComponents/script/feature/community/wedo/view/wedo-project-details-view",model:this.model,widget:this._widget});return[this._createWedoTabBar(),i,t,e,a,{class:"simple-wedo-editor",html:[{class:"assignee-input-wrapper",html:this.addChildView("wedoAssignees",{model:this.model,assigneeCollection:this.model?this.model.getAssociated("assignees"):"",mode:"edit",Class:o,widget:this._widget})},{class:"planned-end-wrapper",html:[{class:"planned-end-label",tag:"label",html:r.PlannedEnd},n]}]},{class:"max-assignees-number-message hidden",html:r.AssigneesErrorMessage}]},_onAttachmentClick:function(){require(["DS/SwymUIComponents/script/feature/community/media/library/media-library-view"],function(e){var t=new e({communityId:this.getCommunityId()});t.injectInDom(),this.listenTo(t,{newMediaAdded:function(e){var i=e.newMedia,n=e.existingMedia;i&&Array.isArray(i)&&i.length>0&&this.addMedia(i),n&&Array.isArray(n)&&n.length>0&&this.addMedia(n),t.destroy()}})}.bind(this))},_transformMediaCollectionIntoAttachmentData:function(e){var t=[],i=[],n=this.model?this.model.getAssociated("attachments"):[],o=[];return e.forEach(function(e){o.push({id:e.get("subject6wuri")||e.get("resourceid")||e.get("id"),title:e.get("title"),serviceHosting:"3DSwym"})}),n.forEach(function(e){var i=e.get("id")||e.get("resourceid"),n=!1;o.forEach(function(e){e.id===i&&(n=!0)}),n||(e.set("id",i),e.set("serviceHosting","3DSwym"),t.push(e))}),o.forEach(function(e){var t=e.id,o=!1;n.forEach(function(e){t===(e.get("id")||e.get("resourceid"))&&(o=!0)}),o||i.push(e)}),{addOperation:i,removeOperation:t}},getContentAttributes:function(){var e={content:this.getRTEContent()},t=this.getChildView("wedoChangeStatusView"),i=this.getChildView("wedoAssignees"),n=this._getMediaEditionView()?this._getMediaEditionView().getCollection():null;return e.diffAssignees=i?i.getAssigneeDiffStructure():[],e.plannedEnd=this.model?this.model.getChanges("estimatedEndDate"):t?t._estimatedEndDate:"",e.maturity=this.model?this.model.getChanges("maturityId"):t?t._maturityId:"",e.assigneesData=i?i.getAssigneeCollection():[],n&&(e.diffAttachment=this._transformMediaCollectionIntoAttachmentData(n)),e},resetContent:function(){var e=this.getChildView("wedoAssignees");e&&e.resetContent();var t=this.getChildView("wedoChangeStatusView");return t&&t.resetContent(),this._parent.apply(this,arguments)}})}}}),define("DS/SwymUIComponents/script/feature/core/user/view/add-member-panel-view-v2",["UWA/Core","DS/SwymUIComponents/script/feature/core/user/view/add-member-panel-view","DS/SwymUICore/script/feature/core/user/collection/user-and-users-group-collection"],function(e,t,i){"use strict";return t.extend({name:"add-member-panel-view-v2",_userAndUsersGroupCollection:null,setup:function(t){var i=t?e.clone(t,!1):{};return this._parent.call(this,i)},_getExtraOptions:function(){return{suggestUrl:"",suggestRequestData:{as_admin:null},suggestTextAttribute:"query",suggestFormat:"{ds6w_58_label}",suggestKey:"subject6wuri",labelFormat:"{ds6w_58_label}",onEmailAddress:this._onEmailAddress.bind(this)}},_findPotentialMembers:function(e){var t=this;if(this._userAndUsersGroupCollection||(this._userAndUsersGroupCollection=new i([],{communityId:this.collection.getAssociated("owned").get("mid"),limit:10,mode:"searchbyname"})),!e.onComplete)throw new Error("onComplete option is missing");return this._userAndUsersGroupCollection.fetch({data:e.data,onComplete:function(i){var n;0===i.length&&t._isAMail(e.data.query)?(n=[{"ds6w:label":e.data.query,subject6wuri:e.data.query,ds6w_58_label:e.data.query}],e.onComplete.call(this,n)):((n=i.toJSON()).forEach(t._parseUserData),e.onComplete.call(this,n))},onFailure:e.onFailure})},_isAMail:function(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}})}),define("DS/SwymUIComponents/script/feature/community/community/view/logo-edit-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/logo-edit-view","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUIComponents/script/feature/community/media/view/uploader/dropzone-view","DS/SwymUIComponents/script/feature/community/media/edit/upload/upload-manager","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUICore/script/feature/community/community/collection/community-collection","DS/SwymUICore/script/feature/community/media/collection/media-collection","DS/SwymUIComponents/script/feature/community/media/view/media-home-view","DS/SwymUIComponents/script/feature/core/ui-components/view-mode-switcher/view-mode-switcher","DS/SwymUIComponents/script/feature/core/pagination/view/paging-toolbar-view","DS/SwymUIComponents/script/feature/core/modal/super-modal","DS/UIKIT/Input/Select","DS/UIKIT/Input/Button"],(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p)=>{let g=new d({attributes:{styles:{position:"relative",float:"right"}},mode:"small"}),w=a.extend({_collectionEvents:{onRequest:"mask",onSync:"unmask"},_modeSwitch:g,name:"default-thumbnail-collection-view",modelViewClass:c});return i.extend({defaultOptions:{asAdmin:!1},type:"community",name:"logo-edit-view",attributes:{tag:"div"},_dropzoneView:null,_uploadManager:null,_superModal:null,setup(e){if(this._parent.apply(this,arguments),this.previousUploadedFileList={},void 0!==e.showCollection&&(this._showCollection=e.showCollection),e.type&&(this.type=e.type),e.mode&&(this.mode=e.mode),e.model&&(this.model=e.model),this._dropzoneView=this.addChildView("dropzoneView",new n({model:e.community,showCollection:this._showCollection,performAdditionalChecks:this._checkLogoFile.bind(this),typeAllowed:"file",availableMediaTypes:["files"]})),"tenant"===this.type&&(this._communityCollection=new r([],{mode:"listmypublicprivatecommunities",limit:125}),this.addControl("communitySelect",new h({options:[],className:"margin-0",placeholder:t.Selectacommunity,events:{onChange:function(e){this.getChildView("uploadManager").setCommunityId(e.target.value)}.bind(this)}})),this._communityCollection.addEvent("onAfterPageChange",function(e){var t=[];e.forEach(function(e,i){t.push({selected:0===i,value:e.get("mid"),label:e.get("title",{escapeHTML:!1})})}.bind(t)),this.getControl("communitySelect").add(t),this.getChildView("uploadManager").setCommunityId(t[0].value),this._dropzoneView.unmask()}.bind(this)),this._communityCollection.fetchPage(1)),void 0!==e.mediaCollectionLimit&&(this._mediaCollectionLimit=e.mediaCollectionLimit),this._superModal=new u({closable:!0,renderTo:this._widget.body}),this._uploadManager=this.addChildView("uploadManager",new o({view:this,model:this.model,authorizedFilesTypes:["image","picture"]})),this._uploadManager.addUploader("dropzone",this._dropzoneView),this.reactTo(this._uploadManager,"onUpload",this.onMediaLoaded),this.reactTo(this._uploadManager,"uploadFailed",this.onUploadFailed),this._showCollection){var i=new l([],{asAdmin:this.getOption("asAdmin"),communityId:"community"===this.type?this.getChildView("uploadManager").getCommunityId()||this.model.get("mid"):null,mode:"community"===this.type?"communityMedia":"tenantMedia",limit:this._mediaCollectionLimit||24});this._collection=i,this._collection.onServerFilteringRequest(null,null,{data:{query:"media_type:picture"}});var s=this.addChildView("collectionView",new w({className:"col-lg-7 col-md-12 padding-0",collection:this._collection,modelViewsCfg:{dimensions:{width:320,height:240},clickHandler:this._checkLogoSelection.bind(this)}}));g.setTarget(s),this.addChildView("pagingToolbar",new m({_currentPage:null,className:"col-lg-7 col-md-12 padding-0",collection:this._collection})),i.addEvent("onAfterPageChange",s.refresh),i.fetchPage(1)}return this._rendered&&this.refresh(),this},onRender(){"tenant"===this.type&&(!0===this._communityCollection.hasBeenFetched()?this._dropzoneView.unmask():this._dropzoneView.mask())},_createContent(){var e=this;return[{class:"col-lg-9 col-md-12 padding-0",html:[{tag:"div",class:"section-title",html:'<span style="font-weight: bold;">'+t.EditCommunityLogo+"</span>"},{tag:"div",class:e._showCollection?"col-lg-5 col-md-12 padding-0":"col-md-12 padding-0",html:[e.getControl("communitySelect"),e.getChildView("dropzoneView"),e.getChildView("uploadManager"),new p({value:t.Resettodefaultthumbnail,attributes:{styles:{width:"100%"}},events:{onClick:function(){var i={reset_to_default:!0,as_admin:e.getOption("asAdmin")};e._superModal.confirm(t.Areyousureyouwanttoresetthethumbnailtothedefaultone,t.Confirmation,function(t){!0===t&&("community"===e.type?e.dispatchEvent("logoSelected",[i]):e.dispatchEvent("tenantLogoSelected",[i]))}.bind(e))}}})]},e.getChildView("collectionView"),e.getChildView("pagingToolbar"),{class:"clearfix"},{class:"error-div"}]},{class:"col-lg-3 col-md-12 padding-0",html:[{html:'<div class="help-box">'+("community"!==e.type?t.HelpLogoTenant:t.HelpLogo)+"</div>"}]},{html:'<div style="clear: both;"></div>'}]},_checkLogoFile(e){e&&1===e.length?this._superModal.confirm(t.Areyousureyouwanttouploadthisfileanduseitaslogo,t.Confirmation,function(t){!0===t&&(this._dropzoneView.mask(),this._dropzoneView.dispatchEvent("onFilesSelected",e),this._dropzoneView.resetInputField())}.bind(this)):this._superModal.alert(t.Onlyonefilecanbeaddedasthelogoofthecommunity)},_checkLogoSelection(e){var i="community"===this.type?{logo_media_uri:e.get("subject6wuri"),as_admin:this.getOption("asAdmin")}:{media_id:e.get("mid")};this._superModal.confirm(t.Areyousureyouwanttosetthismediaasthelogoofthecommunity,t.Confirmation,function(e){!0===e&&("community"===this.type?this.dispatchEvent("logoSelected",[i]):this.dispatchEvent("tenantLogoSelected",[i]))}.bind(this))},onMediaLoaded(t){if(t.length>=0){var i=this.getChildView("uploadManager").getCommunityId()||this.model.get("mid"),n=t[0],o=new s({}),a={is_illustration:"media"!==this.getOption("contentAttributeInModel")};i&&(a.community_id=i),o.addChanges(e.extend(a,n.attributes)),o.save({published:1,notify:"publish",as_admin:this.getOption("asAdmin")},{onComplete:function(e){var t="community"===this.mode?{logo_media_uri:e.get("subject6wuri"),as_admin:this.getOption("asAdmin")}:{media_id:e.get("mid")};this._collection.fetchPage(1),"community"===this.mode?this.dispatchEvent("logoLoaded",[t]):this.dispatchEvent("tenantLogoLoaded",[t]),this._dropzoneView.unmask()}.bind(this),onFailure:function(){this.onUploadFailed()}.bind(this)})}},onUploadFailed(e){this._dropzoneView.unmask()}})}),define("DS/SwymUIComponents/script/feature/community/media/view/media-edit-properties-view",["DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/community/content/view/simple-editor-view","DS/SwymUIComponents/script/feature/community/media/view/edit-file-view","DS/SwymUIComponents/script/feature/community/content/view/properties-editor-view","DS/SwymUIComponents/script/utils/content-upload-error","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/edit/media-editor-body-view"],function(e,t,i,n,o,s){"use strict";return e.extend({name:"media-edit-properties-view",setup:function(e){this._parent.apply(this,arguments),e.hideChangeFile&&(this.hideChangeFile=e.hideChangeFile)},hasMediaDescriptionChanged:function(){return this._mediaDescriptionHasChanged},_displaySecondaryContent:function(e){if(this.model.hasBeenFetched()){var t=this._getRTEView(),i=this._getFileUploadView(),n=this._getMediaPropertiesView();t&&t.render(e),i&&i.render(e),n&&n.render(e)}else this.model.addEventOnce("onSync:read",this._displaySecondaryContent.bind(this,e))},_getRTEView:function(){var e=this.getChildView("rte");return e||((e=this.addChildView("rte",{Class:t,model:this.model,modelAttr:"content",rtePlaceholder:s.AddADescription,mandatory:!1,useFocusStyle:!0,cssPlaceholder:!0})).switchToRTE(),this.listenTo(e,"onRTEContentChanged",this._onMediaDescriptionChange.bind(this))),e},_onMediaDescriptionChange:function(){this._mediaDescriptionHasChanged=!0},getMediaDescription:function(){var e=this._getRTEElt(),t="";return e&&(t=e.getHTML().replace(/\u200B/g,"").replace(/(\u00A0|&nbsp;)(?!$)(?!<br>)(?!<\/)/g," ")),t},_getRTEElt:function(){return this.container&&this.container.getElement(".editable-container")},_getFileUploadView:function(){var e=this.model,t=this.getChildView("fileUploadView");return!e||t||e.is3DSketchExtension()||e.is3DStoExtension()||e.hasExtensionType("3dwb")||this.hideChangeFile||(t=this.addChildView("fileUploadView",{model:e,Class:i,attributes:{class:"editor-border"}})),t},_getMediaPropertiesView:function(){var e=this.getChildView("propertiesEditorView"),t=this.model;return!e&&t&&(e=this.addChildView("propertiesEditorView",{model:t,Class:n,withoutCategory:!0,attributes:{class:"editor-border"}}),this.listenTo(e,"getPlayerStateRequest",function(){this.dispatchEvent("getPlayerStateRequest")}.bind(this)),this.listenTo(this,"playerStatusInfo",function(e){this.getChildView("propertiesEditorView").dispatchEvent("playerStatusInfo",[e])}.bind(this))),e},_onGetPlayerStateRequest:function(e){var t=this.getOption("mediaView").getState()?this.getOption("mediaView").getState():null;e.dispatchEvent("playerStatusInfo",[t])},_createContent:function(){return{class:"content-body-section",html:[this._getRTEView(),this._getFileUploadView(),this._getMediaPropertiesView()]}}})}),define("DS/SwymUIComponents/script/feature/community/media/view/lightbox-top-bar-actions/info-panel-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/context/context-constants","DS/SwymUICore/script/utils/usage-tracker","DS/SwymUICore/script/utils/i18n","DS/SwymUICore/script/lib/event-manager","DS/SwymUIComponents/script/utils/content-upload-error","DS/SwymUIComponents/script/feature/community/content/view/simple-editor-view","DS/SwymUIComponents/script/feature/community/media/view/media-edit-properties-view","DS/SwymUIComponents/script/feature/core/modal/super-modal","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/view/info-panel-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/edit/media-editor-body-view","text!DS/SwymUIComponents/assets/template/info-panel.vue","DS/SwymUIComponents/script/utils/swym-vue","DS/SwymUIComponents/script/utils/feature-activation-manager"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g){"use strict";const{Vue:w}=p;return t.extend({name:"info-panel-view",_modelEvents:{onSync:"updateData"},_hideChangeFile:null,setup:function(e){this._parent.apply(this,arguments),this._hideChangeFile=e&&e.hideChangeFile},updateData:function(){this.onRedraw()},_getAuthorSection:function(){return this.getChildView("authorSectionView")?this.getChildView("authorSectionView"):this.addChildView("authorSectionView",{Class:"DS/SwymUIComponents/script/feature/community/content/view/author-section-view",model:this.model,showThreadLink:!0})},_getMediaDetailsView:function(){return this.getChildView("mediaDetailsView")?this.getChildView("mediaDetailsView"):this.addChildView("mediaDetailsView",{Class:"DS/SwymUIComponents/script/feature/community/media/view/media-details-view",showDownloadButton:!1,model:this.model,createCounterView:!0})},_getEditPropertiesView:function(){let e=this.getChildView("mediaEditPropertiesView");return e||(e=this.addChildView("mediaEditPropertiesView",{Class:c,model:this.model,hideChangeFile:this._hideChangeFile})),e},_isStorySketchWhiteboardModel:function(){return this.model.is3DStoExtension()||this.model.is3DSketchExtension()||this.model.is3DWhiteboardExtension()},onRedraw:function(){var t=this,n=this.model,l=i.prettySize(n.get("size"));this._view=w.component("info-panel",{el:t.container.getElement(".content-body-section"),template:h,data:function(){return{title:n.get("title",{escapeHTML:!1}),titleText:m.Title,titlePlaceholderText:m.Giveyourmediaatitle,descriptionText:m.Description,saveText:m.Update,cancelText:m.Cancel,relatedPostsText:m.RelatedPosts,titleInputRules:[e=>e.length<=255],description:n.get("enhanced_summary",{escapeHTML:!1}),authorText:m.Author,filesDetailsText:m.FileDetails,fileNameText:m.FileName,resolutionText:m.Resolution,sizeText:m.Size,fileName:n.get("orig_name"),resolution:n.get("width")+"x"+n.get("height")+(" ("+n.get("ratio",{escapeHTML:!1})+")"||""),size:l,isEdit:!1,relatedPosts:n.get("related_post"),editProperties:!1,isStorySketchWhiteboardModel:t._isStorySketchWhiteboardModel()}},methods:{onInput:function(){this.$emit("title-input",this.title)},onSave:function(){var e=1!==parseInt(t.model.get("published"),10),i=this.title!==t.model.get("title"),n=0==this.$refs.titleInput.value.length,l=!!this.$refs.titleInput.valid,c=t.model.isDocumentOfficeExtension();if(o.trackPageEvent({category:"Lightbox",label:"PublishPropertiesButtonClick",view:"info-panel-view",event:"click",contenType:"media"}),n)t.alert("error",m.Somerequiredfieldsaremissing);else if(l)if(1!==parseInt(t.model.get("published"),10)||t.model.hasVirtuallyChanged()||t.hasMediaDescriptionChanged()||t._isStorySketchWhiteboardModel()||i||c){var d={title:this.title},h=h=e?u.Thedraftwassuccessfullysaved:u.Yourchangeshavebeensuccessfullypublished,p=t.model;e||!0!==t.model.hasVirtuallyChanged("thumbnail_time_ms")||(h=u.Yourchangeshavebeensuccessfullypublishedthumbnailnotrefreshed),t.hasMediaDescriptionChanged()&&(d.content=t.getChildView("mediaEditPropertiesView").getMediaDescription()),p.save(d,{notify:e?"draft":"publish",onComplete:function(){t.alert("success",h);var e=t.model.getChanges();e&&!1===e.is_illustration&&a.dispatchEvent("requestContentListUpdate",{reloadAfterMediaVisibilityChange:!0})}.bind(this),onFailure:function(e,t){r.printErrorMessage(t)}.bind(this)})}else t.alert("error",m.get("Nochangetosave"));else t.alert("error",s.replace(m.TitleSizeCannotExceedNCharacters,{maxlen:255}));this.$emit("switch-info-panel")},onCancel:function(){t.model&&t.model.hasVirtuallyChanged()||g.isFeatureActivated("activateODEEditor")&&t.model&&"Media"===t.model.get("model")&&t.model.isDocumentOfficeExtension()?t.addControl("removeConfirmationModal",new d({closable:!1,renderTo:window.document.body||t._widget.body})).confirm({title:m.Cancel,message:m.AreYouSure,callback:function(e){!0===e&&(t.isDestroyed()||(t.model.removeChanges(),this.$emit("switch-info-panel")))}.bind(this)}):this.$emit("switch-info-panel")}},computed:{rightColStyle:()=>({height:"100%",width:"100%","overflow-y":"auto"})},props:{isEdit:Boolean,title:String,editProperties:Boolean},watch:{isEdit:function(){this.editProperties||(this.isEdit?this.$nextTick(function(){let i=t._getEditPropertiesView();i.inject(e.extendElement(this.$refs.editInfoContainer),"bottom"),t.listenTo(i,"getPlayerStateRequest",function(){t.dispatchEvent("getPlayerStateRequest")}.bind(t)),t.listenTo(t,"playerStatusInfo",function(e){this.getChildView("mediaEditPropertiesView").dispatchEvent("playerStatusInfo",[e])}.bind(t))}):this.$nextTick(function(){t._getAuthorSection().inject(e.extendElement(this.$refs.authorContainer),"bottom"),t.removeChildView("mediaEditPropertiesView"),t.stopListening(t._getEditPropertiesView(),"getPlayerStateRequest"),t.stopListening(t,"playerStatusInfo")}))}},mounted(){if(this.isEdit||this.editProperties){let i=t._getEditPropertiesView();i.inject(e.extendElement(this.$refs.editInfoContainer),"bottom"),t.listenTo(i,"getPlayerStateRequest",function(){t.dispatchEvent("getPlayerStateRequest")}.bind(t)),t.listenTo(t,"playerStatusInfo",function(e){this.getChildView("mediaEditPropertiesView").dispatchEvent("playerStatusInfo",[e])}.bind(t))}else t._getAuthorSection().inject(e.extendElement(this.$refs.authorContainer),"bottom"),this.title=n.get("title",{escapeHTML:!1})}})},_createContent:function(){return{class:"content-body-section"}},hasMediaDescriptionChanged:function(){return this.getChildView("mediaEditPropertiesView")&&this.getChildView("mediaEditPropertiesView").hasMediaDescriptionChanged()},getMediaDescription:function(){return this.getChildView("mediaEditPropertiesView").getMediaDescription()}})}),define("DS/SwymUIComponents/script/feature/community/survey/view/question-editor-view",["UWA/Core","UWA/String","i18n!DS/SwymUIComponents/assets/nls/feature/community/survey/view/question-editor-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/community/survey/view/scale-answer-view","DS/SwymUIComponents/script/feature/community/survey/view/answer-editor-collection-view","DS/SwymUIComponents/script/feature/community/content/edit/content-editor-body-view-with-rte","DS/UIKIT/Input/Button","DS/UIKIT/Input/Select","DS/UIKIT/Input/Toggle","DS/UIKIT/Input/Text","DS/UIKIT/Tooltip","UWA/Controls/DataGrid","DS/SwymUICore/script/utils/utils"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h){var p=n.extend({_modelEventsForAutoRefresh:["onChange:type"],domEvents:{"click .add-answer-button":"onAddButtonClick","change .answer-is-open-checkbox":"onAnswerIsOpenCheckboxChange","change .start-at-zero-checkbox":"onStartAtZeroCheckboxChange","keyup .min-range-size-label":"onMinRangeSizeLabelChange","keyup .max-range-size-label":"onMaxRangeSizeLabelChange","change .number-of-steps":"onNumberOfStepsChange"},contentChanged:function(){this.dispatchEvent("onContentChange")},onRemoveOpenAnswer:function(){this.getControl("answerIsOpenCheckbox")&&this.getControl("answerIsOpenCheckbox").setCheck(!1)},_createContent:function(){var n,a=this.model,m=!1;if(a){if("Single"===a.get("type")||"Multiple"===a.get("type")){if(this.getControl("addAnswerButton")||this.addControl("addAnswerButton",new r({className:"add-answer-button default",value:i.AddAnswer,icon:"plus"})),this.getControl("answerIsOpenCheckbox")||this.addControl("answerIsOpenCheckbox",new c({type:"checkbox",value:i.Allowanotheranswer,className:"answer-is-open-checkbox primary",attributes:{name:"is_open"}})),a.get("answers")&&a.get("answers").forEach(function(e){m="1"===e.is_open}),m&&this.getControl("answerIsOpenCheckbox").check(!0),this.addControl("answerEditorCollectionView",new s(a.getAssociated("answers"))),this.listenTo(this.getControl("answerEditorCollectionView"),{onContentChange:this.contentChanged.bind(this),onRemoveOpenAnswer:this.onRemoveOpenAnswer.bind(this)}),"Multiple"===a.get("type")){var u=this._getOptions(),h=this.addControl("maxAnswerCombo",new l({className:"max-answer-combo",options:u})),p=this.addControl("multipleAnswerConfig",e.createElement("div",{class:"multiple-answers-config",html:['<b class="answer-info-panel">'+i.Maximumnumberofanswerthatusercanselect+"</b>",{styles:{"margin-top":"10px"},html:this.getControl("maxAnswerCombo")}]}));u.length<=2?p.hide():p.show(),h.addEvent("onChange",function(e){this.getControl("maxAnswerCombo").getValue()[0]&&this.model.set("nb_answer_max",e.target.value)},this),a.getAssociated("answers").addEvent("onRemove",function(){var e=this._getOptions();this.getControl("maxAnswerCombo").remove(),this.getControl("maxAnswerCombo").add(e),e.length<2&&p.hide()}.bind(this))}}else"Scale"===a.get("type")&&(this.getControl("numberOfSteps")||(this.addControl("numberOfSteps",new l({placeholder:i.NumberOfSteps,className:"number-of-steps",options:[{value:"2"},{value:"3"},{value:"4"},{value:"5",selected:!0},{value:"6"},{value:"7"},{value:"8"},{value:"9"},{value:"10"}]})),a.get("index_max")&&(n=0===a.get("index_min")?a.get("index_max")+1:a.get("index_max"),this.getControl("numberOfSteps").setValue(n.toString())),a.getChanges("index_max")||a.get("index_max")||a.addChanges("index_max",5),a.getChanges("index_min")||a.get("index_min")>=0||a.addChanges("index_min",1)),this.getControl("startAtZero")||this.addControl("startAtZero",new c({type:"checkbox",value:i.Startatzero,className:"start-at-zero-checkbox primary",attributes:{name:"start_at_zero"}})),0===a.get("index_min")&&this.getControl("startAtZero").check(),this.getControl("minRangeSizeLabel")||this.addControl("minRangeSizeLabel",new d({className:"min-range-size-label",placeholder:i.OptionalLabel})),this.getControl("minRangeSizeLabel").setValue(t.unescapeHTML(a.get("label_min")||"")),this.getControl("maxRangeSizeLabel")||this.addControl("maxRangeSizeLabel",new d({className:"max-range-size-label",placeholder:i.OptionalLabel})),this.getControl("maxRangeSizeLabel").setValue(t.unescapeHTML(a.get("label_max")||"")),this.getControl("ScaleAnswerViewPreview")||this.addControl("ScaleAnswerViewPreview",new o({indexMin:this.getControl("startAtZero").isChecked()?0:1,indexMax:parseInt(this.getControl("numberOfSteps").getValue()[0],10)-(this.getControl("startAtZero").isChecked()?1:0),minLabel:this.getControl("minRangeSizeLabel").getValue(),maxLabel:this.getControl("maxRangeSizeLabel").getValue()})));return e.createElement("div",{html:["Single"===a.get("type")||"Multiple"===a.get("type")?{class:"answer-panel",html:[{styles:{"font-weight":"bold",padding:"20px 0 10px"},html:i.AnswersTitle},this.getControl("answerEditorCollectionView"),{html:[this.getControl("answerIsOpenCheckbox")]},this.getControl("addAnswerButton"),{styles:{clear:"both"}}]}:"","Scale"===a.get("type")?{styles:{"margin-top":"20px"},html:[{styles:{"font-weight":"bold","margin-bottom":"10px"},html:i.NumberOfSteps},this.getControl("numberOfSteps"),this.getControl("startAtZero"),{class:"scale-configuration",html:[{class:"min-range-size-title",html:i.Startlabel},this.getControl("minRangeSizeLabel"),{class:"max-range-size-title",html:i.Endlabel},this.getControl("maxRangeSizeLabel")]},{styles:{"font-weight":"bold","margin-bottom":"10px","margin-top":"20px"},html:i.Preview},{styles:{"margin-top":"20px","margin-bottom":"20px"},html:this.getControl("ScaleAnswerViewPreview")}]}:"",{html:"Multiple"===a.get("type")?this.getControl("multipleAnswerConfig"):"Open"===a.get("type")?'<div class="answer-info-panel">'+i.Userwritehisownanswer+"</div>":""}]})}},_getOptions:function(){for(var e=[{value:"",label:i.AllAnswers}],t=2;this.model.getAssociated("answers").length>t;)e.push({selected:this.model.get("nb_answer_max")==t,value:t,label:t+" "+i.answers}),t++;return e},_updateScaleAnswerViewPreview:function(){this.getControl("ScaleAnswerViewPreview").getContent().setHTML(new o({indexMin:this.getControl("startAtZero").isChecked()?0:1,indexMax:parseInt(this.getControl("numberOfSteps").getValue()[0],10)-(this.getControl("startAtZero").isChecked()?1:0),minLabel:this.getControl("minRangeSizeLabel").getValue(),maxLabel:this.getControl("maxRangeSizeLabel").getValue()}))},onAddButtonClick:function(){this.model.addAnswer({description:"",is_open:"0"});"Multiple"==this.model.get("type")&&this.refresh(),this.getControl("answerEditorCollectionView").getElements(".answer-delete-button").forEach(function(e){e.show()})},onAnswerIsOpenCheckboxChange:function(e){var t=this.model.getAssociated("answers"),i=t.length,n=1===parseInt(t.at(i-1).get("is_open"),10);if(!0===e.target.checked?n||this.model.addAnswerIsOpen():n&&this.model.removeAnswerIsOpen(),"Multiple"===this.model.get("type")){var o=this._getOptions();this.getControl("maxAnswerCombo").remove(),this.getControl("maxAnswerCombo").add(o),o.length<2?this.getControl("multipleAnswerConfig").hide():this.getControl("multipleAnswerConfig").show()}this.contentChanged()},onStartAtZeroCheckboxChange:function(e){var t=e.target.checked;this.model.addChanges("index_min",t?0:1),this.model.addChanges("index_max",parseInt(this.getControl("numberOfSteps").getValue()[0],10)-(t?1:0)),this._updateScaleAnswerViewPreview()},onMinRangeSizeLabelChange:function(){this.model.addChanges("label_min",this.getControl("minRangeSizeLabel").getValue()),this._updateScaleAnswerViewPreview()},onMaxRangeSizeLabelChange:function(){this.model.addChanges("label_max",this.getControl("maxRangeSizeLabel").getValue()),this._updateScaleAnswerViewPreview()},onNumberOfStepsChange:function(e){this.model.addChanges("index_max",parseInt(e.target.value,10)-(!0===this.getControl("startAtZero").isChecked()?1:0)),this._updateScaleAnswerViewPreview()}});return n.extend({domEvents:{"change .question-type":"onQuestionTypeChange","focusout .editable-container":"_focusOutEditor","click .fonticon-attach":"_onOpenMediaLibrary"},_modelEvents:{onVirtualChange:"contentChanged",onChange:"contentChanged"},_onOpenMediaLibrary:function(){var e=this;require(["DS/SwymUIComponents/script/feature/community/media/library/media-library-view"],function(t){var i=new t({communityId:e.getOption("communityId")});i.injectInDom(),e.listenTo(i,{newMediaAdded:function(t){var n=t.newMedia,o=t.existingMedia,s=e.getRTEView()._getMediaEditionView();n&&Array.isArray(n)&&n.length>0&&s.addNMediaModels(n),o&&Array.isArray(o)&&o.length>0&&s.addNMediaModels(o),i.destroy(),e.getRTEView().getRTEView().setFocus()}})})},_focusOutEditor:function(){var e,t=this.getChildView("rte");t&&(e=t.getContentAttributes().content),e&&this.model.addChanges("description",e)},_createContent:function(){var t,n,o=this.model,s=[{value:"Single",label:i.Single,icon:"radiobutton-off"},{value:"Multiple",label:i.Multiple,icon:"checkbox-off"},{value:"Open",label:i.Open,icon:"view-list"},{value:"Scale",label:i.Scale,icon:"favorite-half"}],a=this.getControl("questionTypeSelector");if(o)return a?a.select(1):(a=this.addControl("questionTypeSelector",new l({placeholder:i.AnswerType,className:"question-type",options:s,value:o.get("type")}))).getContent().getElements(".result-option").forEach(function(e,t){s[t]&&s[t].icon&&(e.innerHTML='<span class="fonticon fonticon-'+s[t].icon+'"></span> '+e.innerHTML)}),n=e.createElement("span",{styles:{"margin-left":"10px"},class:"fonticon fonticon-1-5x fonticon-help-circled"}),this.addControl("helpIconTooltip",new m({target:n,className:"survey-answer-type-tooltip",body:new u({className:"mediaTooltip",columns:[{text:i.Type,dataIndex:"type"},{text:"Description",dataIndex:"text"}],data:[{type:'<span class="fonticon fonticon-radiobutton-off"></span> '+i.Single,text:i.TooltipSingle},{type:'<span class="fonticon fonticon-checkbox-off"></span> '+i.Multiple,text:i.TooltipMultiple},{type:'<span class="fonticon fonticon-view-list"></span> '+i.Open,text:i.TooltipOpen},{type:'<span class="fonticon fonticon-favorite-half"></span> '+i.Scale,text:i.TooltipScale}]})})),t=e.createElement("div",{class:"question-wrapper",html:[{html:[{styles:{"margin-top":"10px"},html:[this.addControl("question-delete-button",new r({className:"question-delete-button default",value:i.Remove,attributes:{styles:{display:o.collection&&o.collection.length>1?"block":"none"}},events:{onClick:this._questionDeleteButtonClick.bind(this)}})),this.addControl("question-move-down-button",new r({className:"question-move-down-button default",value:i.Moveright,attributes:{styles:{display:o.collection&&o.collection.length!=o.get("position")?"block":"none"}},events:{onClick:this._questionMoveDownButtonClick.bind(this)}})),this.addControl("question-move-up-button",new r({className:"question-move-up-button default",value:i.Moveleft,attributes:{styles:{display:o.get("position")>1?"block":"none"}},events:{onClick:this._questionMoveUpButtonClick.bind(this)}}))]},{class:"question-sub-wrapper",html:[this.getRTEView(),{tag:"span",class:"fonticon fonticon-attach"}]},{styles:{"font-weight":"bold",padding:"20px 0 10px"},html:[i.AnswerType,n||""]},a]},this.addChildView("questionConfiguration",new p({model:o,events:{onContentChange:this.contentChanged.bind(this)}}))]}),this.addControl("helpAddMedia",new m({target:t.getElement(".fonticon-attach"),body:i.AddAMedia})),t},getRTEView:function(){var e=this.getChildView("rte");return e||((e=this.addChildView("rte",{Class:a,rtePlaceholder:i.EnterYourQuestion,modelAttr:"description",useFocusStyle:!0,mandatory:!1,activateUserMention:!0,activateInline6WTagging:!1,dragZoneSelector:".question-wrapper",mediaInsertion:!0})).getRTEView()&&e.getRTEView().updateEditor(this.model.get("description")),this.reactTo(e,"onContentChange",this.addChangeForQuestionDescription,this)),e},addChangeForQuestionDescription:function(){this.model.addChanges("description",this.getChildView("rte")&&this.getChildView("rte").getRTEContent())},_updateButtons:function(){var e=this._parentView.model.getAssociated("questions").length;e>1?this.getControl("question-delete-button").show():this.getControl("question-delete-button").hide(),e!=this.model.get("position")?this.getControl("question-move-down-button").show():this.getControl("question-move-down-button").hide(),this.model.get("position")>1?this.getControl("question-move-up-button").show():this.getControl("question-move-up-button").hide()},contentChanged:function(){var e=this.getChildView("rte")&&this.getChildView("rte").container;e&&e.hasClassName("validation-error")&&e.removeClassName("validation-error"),this.dispatchEvent("onContentChange")},onQuestionTypeChange:function(e){this.model.set("type",e.target.value)},_questionMoveDownButtonClick:function(){var e=this.model.get("position");this._parentView.model.getAssociated("questions").moveDown(this._parentView.model.getAssociated("questions").at(e-1)),this._parentView.getControl("surveyQuestionsList").moveTab(e-1,e),this._parentView.model.getAssociated("questions").forEach(function(e,t){this._parentView.getChildView("question-"+(e.get("mid")||e.get("unique_id")))._updateButtons()}.bind(this)),this._parentView.getControl("surveyQuestionsList").tabs.forEach(function(e,t){e.setText(i.Question+" "+(t+1))})},_questionMoveUpButtonClick:function(){var e=this.model.get("position");this._parentView.model.getAssociated("questions").moveUp(this._parentView.model.getAssociated("questions").at(e-1)),this._parentView.getControl("surveyQuestionsList").moveTab(e-1,e-2),this._parentView.model.getAssociated("questions").forEach(function(e,t){this._parentView.getChildView("question-"+(e.get("mid")||e.get("unique_id")))._updateButtons()}.bind(this)),this._parentView.getControl("surveyQuestionsList").tabs.forEach(function(e,t){e.setText(i.Question+" "+(t+1))})},_questionDeleteButtonClick:function(){var e=this.model.get("position"),t=this._parentView;t.model.getAssociated("questions").length>1?(t.getControl("surveyQuestionsList").removeTab(e-1),t.model.getAssociated("questions").remove(t.model.getAssociated("questions").at(e-1)),t.getControl("surveyQuestionsList").selectTab(0),t.model.getAssociated("questions").forEach(function(e,i){e.set("position",i+1),t.getChildView("question-"+(e.get("mid")||e.get("unique_id")))._updateButtons()}),t.getControl("surveyQuestionsList").tabs.forEach(function(e,t){e.setText(i.Question+" "+(t+1))}),this.destroy()):this.alert("error",i.Cannotgetlessthanonequestion)}})}),define("DS/SwymUIComponents/script/feature/core/user/view/member-set-view-v2",["UWA/Core","DS/SwymUICore/script/feature/core/user/collection/user-and-users-group-collection","DS/SwymUIComponents/script/feature/core/user/view/member-set-view","DS/SwymUIComponents/script/feature/core/user/view/add-member-panel-view-v2","DS/SwymUIComponents/script/feature/core/user/view/user-group/user-group-nbmembers-view","DS/WebappsUtils/WebappsUtils"],function(e,t,i,n,o,s){"use strict";return i.extend({name:"member-set-view-v2",defaultOptions:{addMemberPanelViewClass:n},_getItemViewAttributesMapping:function(){var t=this._parent.apply(this,arguments);return e.merge({user_name:function(){return"user"===this.model.getModelName()?t.user_name.apply(this,arguments):this.model.get("name")},title:function(){var e;return"user"===this.model.getModelName()?t.title.apply(this,arguments):"users-group"===this.model.getModelName()?(e=o.getUserGroupMembersText(this.model),this.model.get("name")+" ("+e+")"):this.model.get("name")},content:function(){return"user"===this.model.getModelName()?t.content.apply(this,arguments):""},image:function(){return"user"===this.model.getModelName()?t.image.apply(this,arguments):s.getWebappsBaseUrl()+"SwymUIComponents/assets/s.gif"}},t)}})}),define("DS/SwymUIComponents/script/feature/core/tenant/view/tenant-community-members-home-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/tenant/view/swym-control-center-view","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUIComponents/script/feature/core/user/view/member-set-view","DS/SwymUIComponents/script/feature/core/user/view/member-set-view-v2","DS/SwymUIComponents/script/feature/core/tenant/view/users-management-processes-home-view","DS/SwymUIComponents/script/feature/core/tenant/view/community-users-management-home-view","DS/SwymUIComponents/script/utils/feature-activation-manager","DS/PubSub/PubSub"],function(e,t,i,n,o,s,a,r,l,c,d,m){"use strict";return n.extend({model:null,_currentUser:null,_addScroller:!0,domEvents:{"click .become-moderator":"_becomeModerator"},_modelEvents:{"onChange:this":"refresh"},_createContent:function(){var i=[];return this.getChildView("communityUsersManagementHomeView")&&i.push(this.getChildView("communityUsersManagementHomeView")),i.push(this.getChildView("memberSetView")),this.getChildView("communityUsersManagementProcessesHomeView")&&(i.push(e.createElement("h4",{html:t.Batchresults})),i.push(this.getChildView("communityUsersManagementProcessesHomeView"))),e.createElement("div",{styles:{padding:"10px"},html:i})},setup:function(t){(this._parent.apply(this,arguments),this._currentUser=o.getInstance(),s.getInstance().isFeatureActivated("activate_export_community_users")||s.getInstance().isFeatureActivated("activate_import_community_users"))&&(this.addChildView("communityUsersManagementHomeView",new c({model:this.model,widget:this._widget,asAdmin:!0})).addEvent("refreshUserManagementProcesses",function(){this._currentUser.dispatchEvent("refreshUserManagementProcesses")},this),this.addChildView("communityUsersManagementProcessesHomeView",new l({model:this.model,widget:this._widget,asAdmin:!0})));this.collection.as_admin=!0,this.addChildView("memberSetView",new(d.isFeatureActivated("activateUsersGroup")?r:a)(e.merge({widget:this._widget,collection:this.collection,asAdmin:!0},t)))},_becomeModerator:function(e){var t=this;e.stopPropagation(),require(["i18n!DS/SwymUIComponents/assets/nls/feature/core/tenant/view/super-user-button-view"],function(e){t._currentUser.setAccess({onComplete:function(){t._currentUser.set("tenant_su","1"),t.alert("success",e.Youenteredmoderationmode),window.location.reload()}})})}})}),define("DS/SwymUIComponents/script/feature/community/wiki/edit/wiki-creator-view",["DS/SwymUIComponents/script/feature/community/content/edit/content-editor-body-view-with-advanced-rte","i18n!DS/SwymUIComponents/assets/nls/feature/community/wiki/edit/wiki-creator-view"],function(e,t){"use strict";return e.extend({name:"wiki-editor-body-view",_createContent:function(){return[{class:"wiki-creator-minimized",html:t.Startyourwikipage}]}})}),define("DS/SwymUIComponents/script/feature/community/media/view/shared-lightbox-edit-view",["UWA/Core","UWA/Utils","DS/Logger/Logger","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUIComponents/script/utils/media-utils","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/history/history-model","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/core/context/context-constants","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUIComponents/script/feature/community/content/view/simple-editor-view","DS/SwymUIComponents/script/feature/community/media/view/edit-file-view","DS/SwymUIComponents/script/feature/community/content/view/properties-editor-view","DS/SwymUIComponents/script/utils/content-upload-error","DS/SwymUIComponents/script/feature/core/modal/super-modal","DS/SwymUICore/script/utils/app-navigation-state","DS/SwymUICore/script/lib/event-manager","DS/SwymUICore/script/utils/i18n","DS/SwymUICore/script/feature/core/mobile/communication-manager","DS/SwymUICore/script/lib/pub-sub","DS/SwymUIComponents/script/feature/community/media/view/lightbox-top-bar-actions/info-panel-view","DS/UIKIT/Input/Button","DS/UIKIT/Input/ButtonGroup","DS/SwymUICore/script/utils/usage-tracker","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/edit/content-creation-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/edit/media-editor-body-view","text!DS/SwymUIComponents/assets/template/shared-lightbox-edit.vue","DS/SwymUIComponents/script/utils/swym-vue","DS/SwymUIComponents/script/utils/feature-activation-manager","DS/SwymUICore/script/utils/navigation"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w,C,f,y,v,A,_,S,b,I,D,T,E,U,k){const{Vue:x}=E;const M=window.ds&&"MOBILE"===window.ds.env,V=window.ds&&"3DD"===window.ds.env;return n.extend({name:"shared-lightbox-edit-view",_modelClass:o,_modelEventsForAutoRefresh:["onSync"],_modelEvents:{onPictureHasChanged:"onPictureHasChanged"},_pictureHasChanged:!1,_containerInjected:!1,_showEditPanel:null,_lightboxPanelState:null,_editProperties:null,_ODEcreation:null,setup:function(t){return this._containerInjected=!1,this._pictureHasChanged=!1,this._context=l.getInstance(),t.elementToInjectIn?this.setOption("elementToInjectIn",t.elementToInjectIn):this.setOption("elementToInjectIn",e.extendElement(document.body)),1===a.getNbLayoutColumns()?(this._lightboxPanelState="closed",w.saveLightboxPanelState(this._lightboxPanelState)):this._lightboxPanelState=w.getLightboxPanelState(),(t.editProperties||t.ODEcreation)&&(this._editProperties=!0),t.ODEcreation&&(this._ODEcreation=!0),t.defaultTitle&&(this._defaultTitle=t.defaultTitle),this._showEditPanel=a.getNbLayoutColumns()>1&&!["sketch","story","whiteboard"].includes(this.model.get("media_type"))&&!(this.model.isDocumentOfficeExtension()&&U.isFeatureActivated("activateODEEditor")),this.editorStateEventBus=new v,this.editorStateEventBus.addEvent("onEditorIsModifiedStateResponse",this.onCancel.bind(this)),this._parent(t)},onPictureHasChanged:function(){this._pictureHasChanged=!0},hasPictureChanged:function(){return this._pictureHasChanged},hasMediaDescriptionChanged:function(){return this.getChildView("infoPanelView")&&this.getChildView("infoPanelView").hasMediaDescriptionChanged()},onRedraw:function(){var t=this,i=this._defaultTitle||t.model.get("title"),n=!(this.model&&(this.model.is3DWhiteboardExtension()||1===parseInt(this.model.get("published")))),o=this.addChildView("infoPanelView",{Class:A,model:this.model,hideChangeFile:this._ODEcreation}).render();!this._containerInjected&&this.container.inject(t.getOption("elementToInjectIn"),"bottom"),this.listenTo(this.getChildView("infoPanelView"),"getPlayerStateRequest",this._onGetPlayerStateRequest.bind(this,o)),!this._view&&(this._view=new x({el:this.container,template:T,methods:{getItem:function(e){return this.$children[0].primaryActions.find(t=>t.name===e)},getPanel:function(e){return this.panels.find(t=>t.name===e)},onClickComment:function(){!0===this.getItem("comment").selected?(this.getItem("comment").selected=!1,this.currentPanel=null,this.$children[0].panels.find(e=>"comment"===e.name).show=!1,w.saveLightboxPanelState("closed")):(this.getItem("comment").selected=!0,this.getItem("information").selected=!1,this.currentPanel="comment",this.getPanel("comment").show=!0,w.saveLightboxPanelState("comment"),this.getPanel("information").show=!1),b.trackPageEvent({category:"Lightbox",label:"iconComment",view:"shared-lightbox-edit-view",event:"click"})},onClickInformation:function(){!0===this.getItem("information").selected?(this.getItem("information").selected=!1,this.getPanel("information").show=!1,w.saveLightboxPanelState("closed")):(this.getItem("information").selected=!0,this.getItem("comment").selected=!1,this.getPanel("information").show=!0,w.saveLightboxPanelState("info"),this.getPanel("comment").show=!1),b.trackPageEvent({category:"Lightbox",label:"iconInformation",view:"shared-lightbox-edit-view",event:"click"})},onClose:function(){t.model.isDocumentOfficeExtension()?t.editorStateEventBus.dispatchEvent("onEditorIsModifiedStateRequest"):t.onCancel()},onTitleInput:function(e){this.title=e,t.model.addChanges("title",this.title)},hide:function(){this.isVisible=!1},show:function(){this.isVisible=!0},onSave:function(){t._onPublish()},mask:function(){this.masked=!0},unmask:function(){this.masked=!1}},data:()=>({closeLabel:I.Close,moreActionsLabel:I.More,userId:d.getInstance().get("user").login,isVisible:!0,is3DDWidget:V,title:i,objectType:t._getObjectTypes(),titleText:I.Title,titlePlaceholderText:I.Giveyourmediaatitle,descriptionText:I.Description,saveText:I.Publish,cancelText:I.Cancel,masked:!1,titleInputRules:[e=>e.length<=255],isInfoPanelCreation:this._editProperties,menuActions:n?[{name:"saveasdraft",label:I.Saveasdraft,handler:t._onPublish.bind(t,{isDraft:!0})}]:[],primaryActions:[{label:I.Comments,name:"comment",fonticon:"topbar-comment",selected:"comment"===t._lightboxPanelState,disabled:!1,hidden:this._editProperties},{label:I.Information,name:"information",fonticon:V?"info":"topbar-info",selected:"info"===t._lightboxPanelState,disabled:!1,hidden:!1}],panels:[{name:"comment",show:!this._editProperties&&"comment"===t._lightboxPanelState,title:I.Comments,showClose:!0},{name:"information",show:"info"===t._lightboxPanelState,title:I.Information,showClose:!0}]}),computed:{rightColStyle:()=>({height:"100%",width:"100%",padding:"20px","overflow-y":"auto"}),lightboxStyle:()=>t._lightboxContentStyle()},mounted(){t._addPublishButtonToLightboxBar(this.$refs.lightboxContainer,n),t._displayPrimaryContent(this.$refs.leftContainer),t._editProperties||t.addChildView("socialFeatures",e.extend({model:t.model,comments:!0,showAnswers:!0,forceCommentFetchIfNotDoneYet:!0,Class:"DS/SwymUIComponents/script/feature/community/content/social-interactions/social-toolbar-view",modelName:t.model.getModelName(),socialToolbarMode:"normal",widget:t._widget,enableShare:!1,commentsNumberAtInit:5,sendCommentsInitCallInPool:!1,showCommentsSummaryFirst:!0,showNonValidatedAnswersAtInit:!0})).inject(e.extend(this.$refs.lightboxComment,"bottom")),M&&y.sendLightboxIsShown(),b.trackPageEvent({category:"Lightbox",label:"ViewLightboxEdition",view:"shared-lightbox-edit-view",event:"click",contenType:"media"})}}))},onHide:function(){this._view&&this._view.hide(),M&&"media"!==this._context.contentType&&y.sendLightboxIsHidden()},onShow:function(){"media"===this._context.contentType&&this._view&&this._view.show()},_confirmCancel:function(e,t,i){if(!1!==t){if((this.model&&this.model.hasVirtuallyChanged()||e||this.hasMediaDescriptionChanged()||["story","whiteboard","sketch"].includes(this.model.get("media_type")))&&!i)return this.addControl("removeConfirmationModal",new g({closable:!1,renderTo:window.document.body||this._widget.body})).confirm({title:I.Cancel,message:I.AreYouSure,callback:function(e){!0===e&&this.onCancel(!0,!0,!0)}.bind(this)}),!1;"function"==typeof this.options.onClose?this.options.onClose():this._onBack(),b.trackPageEvent({category:"Lightbox",label:"CloseLightboxEdition",view:"shared-lightbox-edit-view",event:"click",contenType:"media"})}return!0},onCancel:function(e,t,i){this._confirmCancel(e,t,i)&&(this.isDestroyed()||(this.model.removeChanges(),this.refresh()))},_onBack:function(){r.back()},hideOtherPageElements:function(){window&&"3DSwym"===window.ds.env&&(e.extend(document.body).getElement(".main").hide(),e.extend(document.body).getElement("#topbar").hide())},showOtherPageElements:function(){window&&"3DSwym"===window.ds.env&&(e.extend(document.body).getElement(".main").show(),e.extend(document.body).getElement("#topbar").show())},_getObjectTypes:function(){return{name:this.model.get("media_type"),icon:a.getMediaIconName(this.model),backgroundColor:"#70036b"}},_addPublishButtonToLightboxBar:function(e,t){var n=this.addControl("publishButton",new _({value:I.Publish,className:"primary publish-button",icon:"check",events:{onClick:this._onPublish.bind(this)}})),o=this.addControl("draftMenuButton",new _({className:"primary",dropdown:{items:[{text:I.Saveasdraft,className:"draft-item"}]},events:{onDropdownClick:function(e,t){i.log(t),this._onPublish({isDraft:!0})}.bind(this)}})),s=new S({buttons:t?[n,o]:[n],className:"publish-button-group"}),a=e.$el&&e.$el.querySelector(".lightbox-bar__menu"),r=a&&a.children[1];r&&s.inject(r,"after")},isMediaA3DFormat:function(){var e=this.model,t="3dxml"===e.getFileExtension(),i=e.is3DStoExtension(),n=e.is3DSketchExtension(),o=e.is3DWhiteboardExtension();return t||i||n||o},_displayPrimaryContent:function(e){var t=this.model,i=t.get("status"),n="3dxml"===t.getFileExtension,o=t.isPDFExtension(),a=t.isDocumentOfficeExtension();t.isNew()||i===s.MEDIA_PROCESSING_STATUS.OK&&n&&(!n||t.get("format_3dsa"))||t.isConsideredAsA360MediaModel()||o?t.isNew()?this.model.addEventOnce("onSync:read",this._renderMediaViewer.bind(this,e)):this._renderMediaViewer(e):setTimeout(function(){t.fetch({onComplete:function(t){this.isDestroyed()||(t.get("status")===s.MEDIA_PROCESSING_STATUS.OK||this.isMediaA3DFormat()||a)&&("animatedPicture"!==t.get("media_type")||t.isMediaAPlayableGIF())&&this._renderMediaViewer(e)}.bind(this)})}.bind(this),1)},_renderMediaViewer:function(e){this._getMediaViewer(e).render(e)},_getMediaViewer:function(e){var t=this.getChildView("mediaEditorView");if(!t){var i;i=s.getMediaViewerModule(this.model,"edit",{mediaExtension:this.model.getFileExtension()}),t=this.addChildView("mediaEditorView",{model:this.model,Class:i,viewMode:"edit",parentContainerElement:e,isFluid:!1,editorStateEventBus:this.editorStateEventBus})}return t},getMediaDescription:function(){return this.getChildView("infoPanelView").getMediaDescription()},_onGetPlayerStateRequest:function(e){var t=this._getMediaViewer().getState()?this._getMediaViewer().getState():null;e.dispatchEvent("playerStatusInfo",[t])},_onPublish:function(e){var i=e&&!0===e.isDraft,n=this._view.title!==this.model.get("title"),o=this._getMediaViewer(),s=this.model.is3DSketchExtension()||this.model.is3DStoExtension()||this.model.is3DWhiteboardExtension(),a=this.model.isDocumentOfficeExtension();if(b.trackPageEvent({category:"Lightbox",label:i?"SaveAsDraftButtonClick":"PublishButtonClick",view:"shared-lightbox-edit-view",event:"click",contenType:"media"}),1!==parseInt(this.model.get("published"),10)||this.model.hasVirtuallyChanged()||this.hasPictureChanged()||s||n||a||this._editProperties&&this.hasMediaDescriptionChanged()){var r={published:i?0:1,title:this._view.title},l=l=i?D.Thedraftwassuccessfullysaved:D.Yourchangeshavebeensuccessfullypublished,d=function(){var e=this.model.getCommunity(),t=e&&"dm"===e.get("community_type"),n=e.get("mid");this.unmask(),i?this._context.reset({path:(t?"dm:":"community:")+n+"/"+c.COMMUNITY_MY_CONTRIBUTIONS}):k.goToContent(this.model.get("mid"),this.model.getModelName(),n,!1,void 0,void 0,"dm"===e.get("community_type")),this.alert("success",l);var o=this.model.getChanges();o&&!1===o.is_illustration&&C.dispatchEvent("requestContentListUpdate",{reloadAfterMediaVisibilityChange:!0}),"function"==typeof this.options.onSave&&this.options.onSave()},m=function(e,t){p.printErrorMessage(t),this.unmask()},u=this.model;i||!0!==this.model.hasVirtuallyChanged("thumbnail_time_ms")||(l=D.Yourchangeshavebeensuccessfullypublishedthumbnailnotrefreshed);const e="X-Request-ID";if(!u.get(e)){const i=t.getUUID();u.set(e,i)}this._editProperties&&this.hasMediaDescriptionChanged()?r.content=this.getMediaDescription():r.content=this.model.get("content"),this.model.is3DSketchExtension()||this.model.is3DWhiteboardExtension()||this.mask(),s?o.getBlob(function(t){this.model.addChanges("userFile",t),u.save(r,{headers:{[e]:u.get(e)},notify:i?"draft":"publish",onComplete:d.bind(this),onFailure:m.bind(this)})}.bind(this),i):this.hasPictureChanged()?(u.addEvent("mediaFileSavedToModel",function(){this.mask(),u.save(r,{headers:{[e]:u.get(e)},notify:i?"draft":"publish",onComplete:d.bind(this),onFailure:m.bind(this)}),u.removeEvent("mediaFileSavedToModel")}.bind(this)),u.dispatchEvent("saveEditedMediaFileToModel")):a?(this.mask(),U.isFeatureActivated("activateODEViewer")?this._getMediaViewer().dispatchEvent("onPublishing",[r,{headers:{[e]:u.get(e)},notify:i?"draft":"publish",onComplete:d.bind(this),onFailure:m.bind(this)}]):u.save(r,{headers:{[e]:u.get(e)},notify:i?"draft":"publish",onComplete:d.bind(this),onFailure:m.bind(this)})):u.save(r,{headers:{[e]:u.get(e)},notify:i?"draft":"publish",onComplete:d.bind(this),onFailure:m.bind(this)})}else this.alert("error",I.get("Nochangetosave"))},mask:function(){this._view.mask(),this._parent()},unmask:function(){this._view.unmask(),this._parent()},_lightboxContentStyle:function(){var e;switch(this.model.get("media_type")){case"picture":e={height:"100%","justify-content":"center","align-items":"center",overflow:"auto","flex-direction":"column"};break;case"audio":e={};break;default:e={display:"block",height:"100%","margin-left":"auto","margin-right":"auto"}}return e},injectInDom:function(){this.inject(document.body).show()},onDestroy:function(){this._view.$destroy(),this._view.$el.remove(),this._view=null}})}),define("DS/SwymUIComponents/script/feature/community/media/view/document/document-creation-manager",["DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUIComponents/script/feature/community/media/view/shared-lightbox-edit-view","DS/SwymUIComponents/script/feature/community/media/view/document/empty-docx-data-uri","DS/SwymUIComponents/script/feature/community/media/view/document/empty-pptx-data-uri","DS/SwymUIComponents/script/feature/community/media/view/document/empty-xlsx-data-uri","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/edit/content-creation-view"],function(e,t,i,n,o,s){"use strict";return{launchDocumentCreation:function(a){var r,l,c,d,m,u=a&&a.doctype,h=a&&a.communityId,p=a.isIllustration,g=a.titleContent;switch(u){case"text":m=g||s.MyNewTextDocument,r=i,d="docx",c="Document.docx";break;case"slide":m=g||s.MyNewSlideDocument,r=n,d="pptx",c="Presentation.pptx";break;case"table":m=g||s.MyNewTableDocument,r=o,d="xlsx",c="Book.xlsx"}if(r&&h)return new Promise(function(i,n){(l=new e({})).addChanges({community_id:h,fileName:c,userFile:r,published:0}),l.set({media_type:"document",media_file_ext:d});var o=new t({model:l,isAutoplayActivated:!0,ODEcreation:!0,defaultTitle:m,onClose:function(){o.destroy(),l.destroy()},onSave:function(){o.destroy()}});o.render(),l.save({is_illustration:p},{onComplete:function(){l.fetch()},onFailure:n})}).then(function(e){})}}}),define("DS/SwymUIComponents/script/feature/community/social-event/view/topic-viewer",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/community/content/social-interactions/social-toolbar-view","DS/SwymUICore/script/feature/community/social-event/model/topic-model","DS/SwymUICore/script/utils/utils","DS/SwymUIComponents/script/feature/community/social-event/view/rdv-minutes-view","DS/UIKIT/Modal","DS/SwymUICore/script/lib/model/model-manager","DS/SwymUIComponents/script/feature/community/social-event/view/takeaway-viewer-collection-view","DS/SwymUIComponents/script/utils/content-creation-types-manager","DS/SwymUIComponents/script/feature/community/social-event/utils/social-event-constants","DS/SwymUIComponents/script/utils/feature-activation-manager","DS/UIKIT/Tooltip","i18n!DS/SwymUIComponents/assets/nls/feature/community/social-event/social-event-view","DS/SwymUIComponents/script/feature/community/social-event/view/pres-support-viewer-collection-view","DS/SwymUIComponents/script/feature/community/social-event/view/speakers-view","DS/UIKIT/Input/Button"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w){const C=i.extend({_modelClass:n,defaultOptions:{enableShare:!1,comments:!0}});return t.extend({_modelEvents:{onChange:"refresh"},domEvents:{"click .fonticon-expand-right":"toggleTopic","click .fonticon-expand-down":"toggleTopic","click .topic-header":"toggleTopic","click .add-wedo":"addWedo","click .add-decision":"addDecision"},name:"topic-viewer",resetModalContext(){c.getInstance().setContentTypeRequest({type:"post",updateIcon:!0,forceFocus:!0,resetUserAction:!0}),this._wedoCreationModal.destroy(),this._wedoCreationModal=null,this.container.getElement(".add-wedo").classList.remove("disabled")},addWedo(){let t=this;this.container.getElement(".add-wedo").classList.add("disabled"),require(["DS/SwymUIComponents/script/feature/community/content/edit/content-editor-view"],function(i){let n=new i;n._typesManager._setCurrentContentType("wedo",!1,!0,!0),n.getCommunitySelector().populateCommunityCollection({fetchCommunityCollection:!0});let o={className:"wedo-creation-modal",closable:!0,header:e.createElement("div",{class:"wedo-header",html:[{class:"wedo-title",html:"<h4>Wedo creation</h4>"}]}),body:n};o.events={onHide:()=>{t.resetModalContext()}},t._wedoCreationModal=new a(o).inject(document.body),t._wedoCreationModal.show()})},_onWedoPublishing(e){this._wedoCreationModal&&(this.model.addEmptyTakeaway({type:"wedo",title:e.get("title",{escapeHTML:!1}),uri:e.get("subject6wuri")}),this.resetModalContext())},addDecision(){this.model.addEmptyTakeaway({title:"",type:"decision"},null)},resetTakeaways(){this.getChildView("takeawayViewerCollectionView").resetChanges(this.model.getTakeawayChanges()),this.model.resetTakeawayChanges()},toggleTopic:function(e){const t=this.model.isCollapsed();this.model.setCollapsed(!t)},_buildTopic:function(){const t=this.model,i=this.addControl("topic-title-preview",e.createElement("div",{class:"topic-title-preview",tag:"span",html:t.get("title")})),n=e.createElement("div",{class:"topic-duration-preview",tag:"span",html:0!==t.get("duration")?`${t.get("duration")} min`:""});let o=t.get("speakers"),s=t.getAssociated("presentationSupports"),a=o&&o.length,r=s.length>0;const l=this.model.isCollapsed(),c=m.isFeatureActivated("activateWedo"),u=new w({className:"btn-default add-wedo",value:"Add Action",icon:"task"}),h=new w({className:"btn-default add-decision",value:"Add Decision",icon:"legal"});return[e.createElement("div",{class:"topic-header",html:[{class:"position",tag:"span",html:t.get("position")+""},{class:"topic-collapse fonticon "+(l?"fonticon-expand-right":"fonticon-expand-down"),tag:"span"},i,n]}),e.createElement("div",{class:`topic-body ${l?"hidden":""} ${this.mode===d.REPORT_MODE?"report":""}`,html:[{class:"topic-description-section",html:t.get("description")},r||a?{class:"pres-support-and-speakers-section",html:[r?{tag:"div",class:"pres-support-section",html:this.getChildView("PresentationSupportViewerCollection")}:null,a?{class:`topic-owners ${r?"right-align":""}`,html:[{tag:"div",class:"heading",html:1===o.length?"Speaker":"Speakers"},this.getChildView("speakersView")]}:null]}:null,this.getChildView("MinutesView"),this.getChildView("takeawayViewerCollectionView"),this.mode===d.REPORT_MODE?{class:"add-takeaway-wrapper",tag:"div",html:[c?u:null,h]}:null,a||r?{tag:"hr"}:null,this.addChildView("socialToolbarView",new C({model:t,widget:this._widget}))]})]},setup:function(e){this.mode=e.mode,this.isReportPublished=e.isReportPublished,this.isReportPublished&&this.container.addClassName("report-published"),this.mode!==d.REPORT_MODE||this._onPublishingBound||(this._onPublishingBound=this._onWedoPublishing.bind(this),r.addListenerOnPublishing(this._onPublishingBound)),this.addChildView("MinutesView",new s({mode:this.mode,isReportPublished:this.isReportPublished,model:this.model})),(this.isReportPublished||this.mode===d.REPORT_MODE)&&this.addChildView("takeawayViewerCollectionView",new l({collection:this.model.getAssociated("takeaways"),widget:e.widget,mode:this.mode,isReportPublished:this.isReportPublished})),this.addChildView("speakersView",new g({speakers:this.model.get("speakers")})),this.addChildView("PresentationSupportViewerCollection",new p({collection:this.model.getAssociated("presentationSupports"),widget:e.widget})),this._widget||(this._widget=e.widget),this._parent(e)},_createContent:function(){return{tag:"div",class:"topic-wrapper",html:[this._buildTopic()]}},destroy:function(){return this.mode===d.REPORT_MODE&&r.removeListenerOnPublishing(this._onPublishingBound),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/content/view/contribution-model-view",["DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/idea/model/idea-model","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/utils/date","DS/SwymUIComponents/script/feature/community/content/social-interactions/social-toolbar-view","DS/SwymUICore/script/utils/navigation","i18n!DS/SwymUIComponents/assets/nls/feature/community/idea/view/idea-status-view"],function(e,t,i,n,o,s,a){"use strict";var r=o.extend({_onCommentButtonClick:function(){var e=this.model,t=e.get("mid"),i=e.getModelName(),n=e.getCommunity(),o=n.get("mid")||n.id,a=n.isDirectMessage();s.goToContent(t,i,o,!1,null,null,a)}});return e.extend({name:"contribution-model-view",model:t,defaultOptions:{ActionMenuClass:"DS/SwymUIComponents/script/feature/community/content/view/action-menu-view"},_modelEvents:{onSync:"refresh",onChange:"refresh"},setup:function(e){return this.addChildView("contribution-social-toolbar",new r({model:this.model,forceCommentFetchIfNotDoneYet:!1,commentsNumberAtInit:0,socialToolbarMode:"light",modelName:this.model.getModelName(),enableShare:!1,widget:e.widget,enableComment:!0,commentButtonClickEventIsOverrided:!0,sendCommentsInitCallInPool:!0})),this._parent.apply(this,arguments)},_createActionMenu:function(){var e=this.getOption("ActionMenuClass");return e?this.addChildView("action_menu",{Class:e,model:this.model}):""},_renderIdeaLabel:function(){var e,t,i=this.model,n=i.isOut();return e=i.get("status_color"),t=i.get("status_title",{escapeHTML:!1}),e&&t||(e=i.getStatus().get("color"),t=i.getStatus().get("title",{escapeHTML:!1})),{tag:"strong",class:"idea-status-label",styles:{"background-color":n?"#D8D8D8":e},text:n?a.Out:t}},_createContent:function(){var e,t=this.model.getContentType&&this.model.getContentType()||this.model.getModelName();return e={class:this.name+" status_label",html:this._renderIdeaLabel()},[{class:this.name+" wrapper "+this.model.get("id")+"_id",html:[{class:`${this.name} wrapper_icon_title ${this.model.getIconWrapperClass()}`,html:[{tag:"span",class:"fonticon fonticon-2x fonticon-"+this.model.getIconClass()+" content-icon "},{tag:"a",class:this.name+" title",html:this.model.get("title"),"data-content-type":t,"data-content-id":this.model.get("mid")}]},{class:this.name+" wrapper_status_toolbar_menu",html:[e,{class:this.name+" date",html:'<div class="date_'+this.name+'">'+n.prettyDate(this.model.get("crdate"))+"</div>"},{class:this.name+" social_toolbar",html:this.getChildView("contribution-social-toolbar")},{class:this.name+" action_menu",html:this._createActionMenu()}]}]}]}})}),define("DS/SwymUIComponents/script/feature/community/content/view/contribution-collection-view",["DS/SwymUIComponents/script/feature/community/content/view/content-list-view","DS/SwymUIComponents/script/feature/community/content/view/contribution-model-view"],function(e,t){return e.extend({name:"contribution-collection-view",_collectionClass:null,modelViewClass:t,defaultOptions:{sendCollectionTagsToTagger:!0,commentsNumberAtInit:0}})}),define("DS/SwymUIComponents/script/feature/community/social-event/view/topic-viewer-collection-view",["require","exports","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUICore/script/feature/community/social-event/collection/topic-collection","DS/SwymUIComponents/script/feature/community/social-event/view/topic-viewer"],function(e,t,i,n,o){"use strict";return i.extend({_collectionClass:n,modelViewClass:o,_collectionEvents:{onChange:"_onContentChanged",onRemove:"_onRemove",onTopicViewModeChange:"_onTopicViewModeChanged"},modelViewsCfg:function(){return{widget:this._widget,mode:this.mode,isReportPublished:this.isReportPublished}},setup:function(e){this.mode=e.mode,this.isReportPublished=e.isReportPublished,this._parent.apply(this,arguments)},bodyAttributes:{tag:"div",class:"topics-viewer"},resetReport:function(){var e=null;for(e in this._childViews)this._childViews.hasOwnProperty(e)&&this._childViews[e].resetTakeaways()},_onTopicViewModeChanged:function(){this.dispatchEvent("onTopicViewModeChange")},_onRemove:function(e){this.dispatchEvent("onTopicRemove")},_onContentChanged:function(){this.dispatchEvent("onContentChange")}})}),define("DS/SwymUIComponents/script/feature/community/social-event/view/social-event-viewer-view",["UWA/Core","DS/UIKIT/Tooltip","DS/SwymUIComponents/script/feature/community/content/view/content-viewer-view","DS/SwymUIComponents/script/feature/community/social-event/view/social-event-details-view","DS/SwymUIComponents/script/feature/community/social-event/edit/external-users-view","DS/SwymUIComponents/script/feature/community/social-event/view/topic-viewer-collection-view","DS/SwymUIComponents/script/feature/community/social-event/view/note-takers-view","DS/SwymUIComponents/script/feature/community/social-event/view/rdv-minutes-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/social-event/social-event-view","DS/SwymUIComponents/script/feature/community/social-event/utils/social-event-constants"],function(e,t,i,n,o,s,a,r,l,c){"use strict";return i.extend({name:"social-event-viewer-view",_topicsDisplayMode:"",domEvents:{"click .topics-view-mode .fonticon":"onTopicsViewModeChange"},setup:function(e){var t=this.model;return this.mode=e.mode,this.isReportPublished=e.isReportPublished,this.addChildView("details",{model:t,mode:"detailed-view",Class:n}),this.addChildView("topicViewerCollectionView",new s({collection:t.getAssociated("topics"),widget:e.widget,mode:this.mode,isReportPublished:this.isReportPublished})),!this.model.get("scribe")||this.mode!==c.VIEW_MODE||this.addChildView("noteTakersView",new a({model:t,isReportPublished:this.isReportPublished})),this.addChildView("rdvMinutesView",new r({mode:this.mode,isReportPublished:this.isReportPublished,model:t})),this.listenTo(this.getChildView("topicViewerCollectionView"),{onTopicViewModeChange:this.refreshTopicsDisplayMode.bind(this)}),this._parent.apply(this,arguments)},onTopicsViewModeChange:function(e){let t=e&&e.target&&e.target.classList;t&&!t.contains("active")&&(t.contains("fonticon-collapse-all")?this.model.getAssociated("topics").collapseAll():this.model.getAssociated("topics").expandAll(),this.refreshTopicsDisplayMode())},refreshTopicsDisplayMode:function(){let e=this.model.getAssociated("topics")._models.map(e=>e.isCollapsed()),t=e.every(e=>!0===e),i=e.every(e=>!1===e);const n=this.container.querySelector(".fonticon-expand-all"),o=this.container.querySelector(".fonticon-collapse-all");t?"collapsed"!==this._topicsDisplayMode&&(this._topicsDisplayMode="collapsed",n&&n.classList.remove("active"),o&&o.classList.add("active")):i?"expanded"!==this._topicsDisplayMode&&(this._topicsDisplayMode="expanded",o&&o.classList.remove("active"),n&&n.classList.add("active")):(this._topicsDisplayMode="",n&&n.classList.remove("active"),o&&o.classList.remove("active"))},_createContent:function(){let i="",n=this.model,s=this._parent();if(n){const a=n.get("external_users"),r=n.getAssociated("topics");if(i=[this.getChildView("details"),s,this.mode===c.VIEW_MODE?this.getChildView("noteTakersView"):{},this.getChildView("rdvMinutesView"),a&&a.length?this.addChildView("externalUsers",{model:n,Class:o}):{}],r.length){r.resetCollapseStates();const n=e.createElement("div",{tag:"div",class:"protocol",html:[{tag:"div",class:"heading",html:[e.createElement("div",{class:"topics-label",html:[l.Protocol]}),e.createElement("div",{class:"topics-view-mode",html:[e.createElement("span",{class:"fonticon fonticon-clickable fonticon-expand-all active"}),e.createElement("span",{class:"fonticon fonticon-clickable fonticon-collapse-all"})]})]},this.getChildView("topicViewerCollectionView")]});i.push(n),new t({target:n.querySelector(".fonticon-collapse-all"),body:l.CollapseAll}),new t({target:n.querySelector(".fonticon-expand-all"),body:l.ExpandAll})}}return i}})}),define("DS/SwymUIComponents/script/feature/community/survey/view/survey-editor-view",["UWA/Core","UWA/Controls/TabView","DS/UIKIT/Input/Button","i18n!DS/SwymUIComponents/assets/nls/feature/community/survey/view/survey-editor-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/community/survey/view/question-editor-view","DS/UIKIT/Input/Number","DS/UIKIT/Input/Date","DS/UIKIT/Input/Toggle","DS/SwymUICore/script/utils/i18n","DS/SwymUICore/script/utils/utils"],function(e,t,i,n,o,s,a,r,l,c,d){"use strict";return o.extend({_modelEventsForAutoRefresh:["onSync"],name:"survey-editor-view",domEvents:{"change .survey-results-checkbox":"onSurveyResultsChange","change .start-hour":"onStartHourChange","change .end-hour":"onEndHourChange","change .start-minute":"onStartMinuteChange","change .end-minute":"onEndMinuteChange","click .add-question-button":"onAddButtonClick","change .survey-start-date-picker":"onSurveyStartDatePickerChange","change .survey-end-date-picker":"onSurveyEndDatePickerChange"},startDate:null,endDate:null,_createQuestionsStepPanel:function(){var e,o,a,r,l=this,d=l.model;if(d&&0===d.getAssociated("questions").length&&((o=d.addQuestion({createdQuestion:!0,description:"",isActive:!0,nb_answer_max:"0",pollId:"",type:"Single"})).addAnswer({description:"",is_open:"0"}),o.addAnswer({description:"",is_open:"0"}),o.set("unique_id",(new Date).getTime())),d){for(r in a=new t({className:"nav",tabScroller:!0}),l.getChildViews())l.removeChildView(r);d.getAssociated("questions").forEach(function(e,i){var o=c.replace(n.Question,{questionPosition:i+1}),r=new t.Tab({text:o,id:Math.random()}),d=l.addChildView("question-"+(e.get("mid")||e.get("unique_id")),{Class:s,model:e,communityId:l._parentView.getCommunityId(),events:{onContentChange:l.contentChanged.bind(l)}});a.addTab(r),r.setContent(d)}),l.addControl("surveyQuestionsList",a),l.getControl("addQuestionButton")||l.addControl("addQuestionButton",new i({className:"add-question-button default",value:n.Addquestion,icon:"plus"})),e={class:"questions-configuration",html:[l.getControl("addQuestionButton"),{styles:{clear:"both"}},l.getControl("surveyQuestionsList")]}}return e},_canStartDateBeChanged:function(){var e=this.model;if(1!==parseInt(e.get("published"),10))return!0;var t=new Date,i=e.get("startHour"),n=e.get("startDate"),o=new Date;return t.setHours(i.substring(0,2)),t.setMinutes(i.substring(3,5)),t.setDate(n.substring(8,10)),t.setMonth(parseInt(n.substring(5,7),10)-1),t.setYear(n.substring(0,4)),o<t},_createSurveyOptionStepPanel:function(){var e=this.model;this.addControl("surveyEndDatePicker",new r({className:"survey-end-date-picker"})),this.getControl("surveyEndDatePicker").setMinDate(e.getStartDate()),this.getControl("surveyEndDatePicker").setDate(new Date(e.get("endDate"))),this.addControl("endHourPicker",new a({min:0,max:23,step:1,className:"end-hour",value:e.get("endHour")?parseInt(e.get("endHour").substring(0,2),10).toString():""})),this.addControl("endMinutePicker",new a({min:0,max:45,step:15,className:"end-minute",value:e.get("endHour")?parseInt(e.get("endHour").substring(3,5),10).toString():""})),this.addControl("surveyStartDatePicker",new r({className:"survey-start-date-picker"}));var t=new Date;return this.getControl("surveyStartDatePicker").setMinDate(t),this.getControl("surveyStartDatePicker").setDate(new Date(e.get("startDate"))),this.addControl("startHourPicker",new a({min:0,max:23,step:1,className:"start-hour",value:e.get("startHour")?parseInt(e.get("startHour").substring(0,2),10).toString():""})),this.addControl("startMinutePicker",new a({min:0,max:45,step:15,className:"start-minute",value:e.get("startHour")?parseInt(e.get("startHour").substring(3,5),10).toString():""})),1!==parseInt(e.get("published"),10)&&this.addControl("surveyResultsCheckbox",new l({type:"checkbox",value:n.Showresultsaftervotes,className:"survey-results-checkbox primary",checked:!0===e.get("showResultsAfterVote"),attributes:{name:"survey_results"},styles:{"margin-top":"5px","margin-bottom":"5px"}})),{class:"survey-options",styles:{display:0===parseInt(e.get("published"),10)?"none":""},html:[this._canStartDateBeChanged()?{html:[{styles:{"font-weight":"bold"},html:n.Startdate},this.getControl("surveyStartDatePicker"),n.at,this.getControl("startHourPicker"),":",this.getControl("startMinutePicker")]}:"",{styles:{"margin-top":"20px"},html:[{styles:{"font-weight":"bold"},html:n.Enddate},this.getControl("surveyEndDatePicker"),n.at,this.getControl("endHourPicker"),":",this.getControl("endMinutePicker")]},1!==parseInt(e.get("published"),10)?this.getControl("surveyResultsCheckbox"):""]}},_createContent:function(){var t,i=this.model;return i&&(t=e.createElement("div",{class:"survey-wrapper",html:[1!==parseInt(i.get("published"),10)?this._createQuestionsStepPanel():"",this._createSurveyOptionStepPanel()]})),t},contentChanged:function(){this.dispatchEvent("onContentChange")},getFormattedDate:function(e){var t="",i=e.getMonth()+1,n=e.getDate();return parseInt(i)<=9&&(i="0"+i),parseInt(n)<=9&&(n="0"+n),t+=e.getUTCFullYear(),t+="-"+i,t+="-"+n},onSurveyResultsChange:function(e){this.model.addChanges("showResultsAfterVote",e.target.checked,{force:!0})},onStartHourChange:function(e){var t=e.target.value,i=parseInt(this.getControl("startMinutePicker").getValue(),10);parseInt(t)<=9&&(t="0"+t),parseInt(i)<=9&&(i="0"+i),this.model.addChanges("startHour",t+":"+i,{force:!0})},onEndHourChange:function(e){var t=e.target.value,i=parseInt(this.getControl("endMinutePicker").getValue(),10);parseInt(t)<=9&&(t="0"+t),parseInt(i)<=9&&(i="0"+i),this.model.addChanges("endHour",t+":"+i,{force:!0})},onStartMinuteChange:function(e){var t=e.target.value,i=parseInt(this.getControl("startHourPicker").getValue(),10);parseInt(i)<=9&&(i="0"+i),parseInt(t)<=9&&(t="0"+t),this.model.addChanges("startHour",i+":"+t,{force:!0})},onEndMinuteChange:function(e){var t=e.target.value,i=parseInt(this.getControl("endHourPicker").getValue(),10);parseInt(i)<=9&&(i="0"+i),parseInt(t)<=9&&(t="0"+t),this.model.addChanges("endHour",i+":"+t,{force:!0})},onAddButtonClick:function(){if(this.model.getAssociated("questions").length<30){var e=this.model.addQuestion({createdQuestion:!0,description:"",isActive:!0,nb_answer_max:"0",pollId:"",type:"Single"});e.addAnswer({description:"",is_open:"0"}),e.addAnswer({description:"",is_open:"0"}),e.set("unique_id",(new Date).getTime());var i=c.replace(n.Question,{questionPosition:e.get("position")}),o=new t.Tab({text:i}),a=this.addChildView("question-"+(e.get("mid")||e.get("unique_id")),{Class:s,model:e,events:{onContentChange:this.contentChanged.bind(this)}});this.getControl("surveyQuestionsList").addTab(o),o.setContent(a),this.getControl("surveyQuestionsList").selectTab(this.getControl("surveyQuestionsList").tabs.length-1),this.model.getAssociated("questions").forEach(function(e,t){e.set("position",t+1),this.getChildView("question-"+(e.get("mid")||e.get("unique_id")))._updateButtons()}.bind(this))}else this.alert("error",n.Youcannotaddmorethanthirtyquestionsonasurvey)},onSurveyStartDatePickerChange:function(){var e=this.getControl("surveyStartDatePicker").getDate(this.getControl("surveyStartDatePicker").getDate()+1);if(e.setDate(e.getDate()+1),this.getControl("surveyEndDatePicker").setMinDate(e),this.getControl("surveyEndDatePicker").getDate()<=this.getControl("surveyStartDatePicker").getDate()){var t=this.getControl("surveyStartDatePicker").getDate();t.setDate(t.getDate()+1),this.getControl("surveyEndDatePicker").setDate(t)}this.model.addChanges("startDate",this.getFormattedDate(this.getControl("surveyStartDatePicker").getDate()),{force:!0}),this.model.addChanges("endDate",this.getFormattedDate(this.getControl("surveyEndDatePicker").getDate()),{force:!0})},onSurveyEndDatePickerChange:function(){this.model.addChanges("endDate",this.getFormattedDate(this.getControl("surveyEndDatePicker").getDate()))},validateQuestions:function(){var t=!0,i=this.model.getAssociated("questions"),o=null,s=null;this.model;return 0===i.length&&(t=!1,this.alert("error",n.PleaseAddAtLeastOneQuestion)),i.forEach(function(i,a){o=this.getChildView("question-"+(i.get("mid")||i.get("unique_id"))),s=null,o&&(s=o.getChildView("rte")),e.is(i.getChanges("description"))&&""===i.getChanges("description").stripTags().replace(/&nbsp;/g," ").trim()||!i.getChanges("description")&&(!i.get("description")||i.get("description")&&""===i.get("description").stripTags().replace(/&nbsp;/g," ").trim())?(!0===t&&(this.alert("error",c.replace(n.Pleasefillquestionnumber,{questionPosition:i.get("position")})),this.getControl("surveyQuestionsList").selectTab(i.get("position")-1),s&&s.container.addClassName("validation-error"),"Open"!==i.get("type")&&"Scale"!==i.get("type")&&o.getChildView("questionConfiguration").getControl("answerEditorCollectionView").getModelViews().forEach(function(e){e.validate()})),t=!1):s&&s.container.removeClassName("validation-error"),"Open"!==i.get("type")&&"Scale"!==i.get("type")?i.getAssociated("answers").forEach(function(e,o){var s=e.getChanges("description"),a=e.get("description");s&&!/^\s*$/.test(s)||a&&!/^\s*$/.test(a)||(!0===t&&(this.alert("error",c.replace(n.Pleasefillanswernumberinquestionnumber,{questionPosition:i.get("position"),answerPosition:i.hasAnOpenAnswerAdded()?o:o+1})),this.getControl("surveyQuestionsList").selectTab(i.get("position")-1),this.getChildView("question-"+(i.get("mid")||i.get("unique_id"))).getChildView("questionConfiguration").getControl("answerEditorCollectionView").getModelViews().forEach(function(e){e.validate()})),t=!1)},this):"Scale"===i.get("type")&&(i.getChanges("index_max")||i.get("index_max")||(this.alert("error","Please set the number of steps"),t=!1))},this),t},validate:function(){var e=!0,t=this.model,i=(t.getChanges("endDate")||t.get("endDate")).replace(/-/g,"/"),o=t.getChanges("endHour")||t.get("endHour"),s=(t.getChanges("startDate")||t.get("startDate")).replace(/-/g,"/"),a=t.getChanges("startHour")||t.get("startHour"),r=new Date(i+" "+o+":00").getTime(),l=new Date(s+" "+a+":00").getTime(),c=this.getControl("surveyEndDatePicker");return 1===parseInt(t.get("published"),10)?(c.elements.container.removeClassName("field-error"),r-l<=0&&(e=!1,c&&c.elements.container.addClassName("field-error"),this.alert("error",n.EndDateWrong)),e):(c.elements.container.removeClassName("field-error"),r-l<=0?(e=!1,c&&c.elements.container.addClassName("field-error"),this.alert("error",n.EndDateWrong),e):e=this.validateQuestions())},goToNextStep:function(){this.getElement(".survey-options").show(),this.getElement(".questions-configuration").hide()},goToPreviousStep:function(){this.getElement(".survey-options").hide(),this.getElement(".questions-configuration").show()}})}),define("DS/SwymUIComponents/script/feature/community/im/im-creator-body-view",["UWA/Utils/Client","DS/SwymUICore/script/utils/utils","DS/SwymUIComponents/script/utils/content-creation-types-manager","DS/SwymUIComponents/script/feature/community/content/edit/content-editor-body-view-with-rte","DS/SwymUIComponents/script/utils/feature-activation-manager"],function(e,t,i,n,o){"use strict";return n.extend({name:"instant-message-rte",defaultOptions:{className:"instant-message-rte",rteViewOptions:{overrideDefaultEnterBehaviour:!(o.isFeatureActivated("activateIMSendButton")&&e.Features.touchEvents),enableEmojis:!0,isInstantMessageRTE:!0,disableTableOnPaste:!0,activateInline6WTagging:!1}},init:function(){var e=this._parent.apply(this,arguments),t=i.getInstance();return this._toggleMediaInsertion(),this._toggleMediaInsertionBound=this._toggleMediaInsertion.bind(this),t.addEvent("onContentTypesChange",this._toggleMediaInsertionBound),e},refreshContent:function(){return this._parent({content:""})},_toggleMediaInsertion:function(){var e=i.getInstance().getContentTypes().indexOf(i.MEDIA)>-1;this.getOption("mediaInsertion")!==e&&(this.setOption("mediaInsertion",e),this.refresh())},onExitingMode:function(){this._getMediaEditionView().destroy()},destroy:function(){var e=i.getInstance();this._toggleMediaInsertionBound&&e.removeEvent("onContentTypesChange",this._toggleMediaInsertionBound),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/social-event/edit/social-event-simple-editor",["DS/SwymUIComponents/script/feature/community/content/edit/content-editor-body-view-with-rte","DS/SwymUIComponents/script/feature/community/social-event/edit/social-event-common-editor"],function(e,t){"use strict";return e.extend({name:"social-event-simple-editor",defaultOptions:{rteViewOptions:{mandatory:!1}},setup(e){this._parent(e),this.addChildView("socialEventCommonEditor",{Class:t})},refreshContent(e){this._parent(e),this.refresh()},resetContent(){this.getChildView("socialEventCommonEditor").reset(),this._parent()},_createContent:function(){return[{class:"social-event-editor",html:[this._parent.apply(this,arguments),this.getChildView("socialEventCommonEditor")]}]},getContentAttributes:function(){const e=this._parent.apply(this,arguments)||{},t=this.getChildView("socialEventCommonEditor").getContentAttributes();return Object.assign(e,t)},validateContent:function(){return this.getChildView("socialEventCommonEditor").validateContent()}})}),define("DS/SwymUIComponents/script/feature/community/content/view/content-community-tags-read-view",["DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUIComponents/script/utils/swym-vue","DS/SwymUIComponents/script/utils/feature-activation-manager","DS/SwymUICore/script/lib/6wpanel/community-tags-manager","DS/SwymUICore/script/utils/usage-tracker","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/view/content-community-tags-read-view"],(e,t,i,n,o,s)=>{const{Vue:a}=t,r=a.extend({template:'\n        <div class="community-tags-content" v-if="sortedTags.length">\n          <SwymCommunityTagsHeader\n            class="tags-container"\n            ref="tagsView"\n            :openByDefault="openByDefault"\n            :NLS="NLS"\n            :tags="sortedTags"\n            :externalSeeMore="externalSeeMore"\n            :showCommunityIcon="showCommunityIcon"\n            @tagToggled="tagToggled"\n          />\n        </div>\n      '});return e.extend({className:"content-community-tags-read-view",vueComponent:null,tagsManager:null,setup(...e){return i.areCommunityTagsAvailable()&&(this.tagsManager=n.getInstance(),this.tagsManager.addEvent("tagsUpdated",this.tagsUpdated,this),this.getOption("content")&&(this.content=this.getOption("content"),this.listenTo(this.content,"onChange:tags6w",this.tagsUpdated,this))),this._parent(...e)},_createContent(){if(i.areCommunityTagsAvailable()){if(!this.vueComponent){const e=this;this.vueComponent=new r({data:()=>({tags:[],NLS:s,externalSeeMore:!0,showCommunityIcon:!0,openByDefault:!0}),async mounted(){e.tagsUpdated()},computed:{sortedTags(){return this.tags.sort((e,t)=>e.selected&&t.selected?0:e.selected?-1:t.selected?1:0)}},methods:{tagToggled(t){const i=this.tags.findIndex(e=>e.object===t.object);if(i<0)return;const n=this.tags[i];e.applyTagToContext(n),o.trackPageEvent({category:"CommunityTags",label:"selectTagInContentDisplayFooter",view:"content-community-tags-read-view",event:"click"})}}}),this.vueComponent.$mount()}return this.vueComponent.$el}},async tagsUpdated(){if(!this.vueComponent)return;const e=this.content.getCommunity().getSubjectURI(),t=this.content.getTags().toJSON().map(e=>({...e,...e.object?{object:n.getFilterDescription(e.object)}:void 0}));this.vueComponent.tags=await this.tagsManager.getTagsForHeaders({communitySubjectURI:e,existingTags:t,dontSetTags:!0})},applyTagToContext(e){require(["DS/SwymUICore/script/feature/core/history/history-model","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/feature/core/context/context-model"],(t,i,n)=>{const o={},s=n.getInstance(),a=t.getStateListing(),r=(s.isInTemporaryState()?s.getData():a&&a.previousContext)||{};o[e.sixw]=[{object:e.object,type:"string"}],!s.isCommunityContext()||s.isContentContext()&&r.contentId||s.contentId&&("home"===r.path||!r.path)?i.goTo3DSwymHomePage({tagNavigatorFilteringOptions:{filter:o,replace:!0}}):i.goToCommunity(s.communityId,void 0,void 0,!!s.dmId,{tagNavigatorFilteringOptions:{filter:o,replace:!0}})})},destroy(...e){return this.vueComponent&&(this.vueComponent.$destroy(),this.vueComponent=null),i.areCommunityTagsAvailable()&&this.tagsManager.removeEvent("tagsUpdated",this.tagsUpdated),this._parent(...e)}})}),define("DS/SwymUIComponents/script/feature/community/survey/view/survey-stats-collection-view",["i18n!DS/SwymUIComponents/assets/nls/feature/community/survey/view/survey-stats-collection-view","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUICore/script/feature/community/survey/collection/survey-collection","DS/SwymUIComponents/script/feature/community/survey/view/survey-stats-view"],function(e,t,i,n){return t.extend({_collectionClass:i,modelViewClass:n,attributes:{tag:"table",class:"survey-stats table table-hover"},bodyAttributes:{tag:"tbody"},modelViewsCfg:{attributes:{tag:"tr",class:"cursor-pointer"}},_createModelView:function(){var e=this._parent.apply(this,arguments);return e.container.addEvent("click",function(e){this.collectionView.dispatchEvent("surveyClicked",[this.modelView.model])}.bind({collectionView:this,modelView:e})),e},_createContent:function(){return(this.collection.isBeingFetched()||this.collection.hasBeenFetched())&&0===this.collection.length?e.Thereisnosurveyinthiscommunity:this.collection.hasBeenFetched()&&0!==this.collection.length?[{tag:"thead",html:"<th>"+e.Title+"</th><th>"+e.NbVoters+"</th><th>"+e.StartDate+"</th><th>"+e.EndDate+"</th>"},this._parent.apply(this,arguments)]:void 0},setup:function(e){this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/members/view/dm-user-tile-view",["UWA/Core","DS/SwymUIComponents/script/feature/core/user/view/user-tile-view","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/user-tile-view","i18n!DS/SwymUIComponents/assets/nls/feature/direct-message/direct-messages","DS/UIKIT/Tooltip"],function(e,t,i,n,o,s,a,r,l){"use strict";return t.extend({name:"dm-user-tile-view",defaultOptions:{displayActionToolbar:!1,displayRole:!1},domEvents:{"click button.close":"onRemoveButtonClicked"},onRemoveButtonClicked:function(){const e=this,t=this.model.get("login"),i=n.getInstance(),o=new s({mid:i.communityId});o.action("removemembers",{data:{users:[t]},onComplete:()=>{require(["DS/SwymUICore/script/lib/event-manager"],function(t){t.dispatchEvent("onCommunityMembersUpdate",[o.getAssociated("users").toArray()]),e.alert("success",a.Yourchangeshavebeensaved)}),require(["DS/SwymUIComponents/script/utils/typing-indicator-manager"],function(e){const t=o.getAssociated("users").map(e=>e.get("login"));e.sendUsersInThread(o.get("mid"),t)})},onFailure:()=>{e.alert("error",r.AnErrorOccurred)}})},_createRemoveButton:function(){var t=this.model,s=n.getInstance(),a=e.createElement("button",{type:"button",class:"close",html:"&times;"});return new l({target:a,body:r.RemoveThisUserFromTheConversation}),i.getInstanceFetched(function(e){e.get("hash_key")===t.get("hash_key")&&a.hide()}),new o({mid:s.communityId},{autoPopulate:!0,onPopulate:function(e){"private"===e.get("dm_type")&&a.hide()}}),a},_createContent:function(){var e=this._parent(),t=this._createRemoveButton();return Array.isArray(e)?e.unshift(t):e=[t,e],e}})}),define("DS/SwymUIComponents/script/feature/community/members/view/members-list-view",["UWA/Core","DS/SwymUIComponents/script/feature/core/ui-components/list/item-list","DS/SwymUIComponents/script/feature/core/user/view/user-tile-view","DS/SwymUIComponents/script/feature/community/members/view/dm-user-tile-view","DS/SwymUIComponents/script/feature/core/user/view/users-group-tile-view","DS/SwymUIComponents/script/feature/core/user/view/bot-tile-view"],function(e,t,i,n,o,s){"use strict";return t.extend({name:"community-members-list",modelViewClass:function(e){var t=this.collection.getAssociated("owned");switch(e.getModelName()){case"user":return t&&"dm"===t.get("community_type")?n:i;case"users-group":return o;case"bot":return s}},setup:function(e){e.useDynamicGrid=!0,this._parent.apply(this,arguments)},refresh(e){const t=this.collection&&this.collection.getAssociated("owned"),i=!t||"dm"===t.get("community_type");this._parent.call(this,{...e,reset:i})},_createModelView:function(){var e=this._parent.apply(this,arguments);return this.collection.hasAssociation("owned")&&e.model.setAssociated("community",this.collection.getAssociated("owned")),this.listenTo(e,"memberDeleted",this.onMemberDeleted),e},onMemberDeleted:function(e){this.collection.remove([e]),this.refresh()}})}),define("DS/SwymUIComponents/script/feature/community/media/view/lightbox-top-bar-actions/menu-actions-lightbox-view",["UWA/Core","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/lib/event-manager","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/community/community/collection/community-collection","DS/UIKIT/DropdownMenu","DS/SwymUIComponents/script/feature/core/modal/super-modal","DS/SwymUIComponents/script/feature/core/modal/modal","DS/SwymUIComponents/script/feature/core/modal/rss-feed-modal","DS/SwymUIComponents/script/feature/core/share/view/share-content-view","DS/UIKIT/Tooltip","DS/UIKIT/Input/Toggle","DS/UIKIT/Input/Button","DS/SwymUICore/script/utils/navigation","DS/Bookmark/script/BookmarkManager","UWA/Promise","DS/SwymUIComponents/script/feature/core/search/view/thread-picker-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/view/abstract-content-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/generic/view/content-title-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-detailed-view","i18n!DS/SwymUIComponents/assets/nls/feature/core/tenant/view/tenant-media-processes-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-card-view","DS/SwymUICore/script/utils/usage-tracker","DS/SwymUICore/script/feature/core/context/context-constants","DS/SwymUICore/script/feature/core/history/history-model","DS/Logger/Logger","DS/SwymUIComponents/script/utils/feature-activation-manager"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w,C,f,y,v,A,_,S,b,I,D,T,E,U,k,x){"use strict";var M=window.ds&&window.ds.isMDE;return n.extend({name:"action-menu-view",_modelClass:a,_actionMenu:[],_isModelFetched:!1,_convertLayerView:null,_convertLayer:null,_limit:10,_isBookmarked:!1,_bookmark:null,menuActionsType:null,defaultOptions:{ReportAbuse:!0,Edit:!1,Delete:!0,ConvertToIdea:!0,FollowUnfollow:!0,Bookmark:!0,LeaveCommunity:!0,RssFeed:!0,pinToThisTab:!0,Subscribe:!0,highlight:!0,forward:!0},setup:function(e){this._bootstrapModel=s.getInstance(),this._widget||(this._widget=e._widget),e.menuActionsType&&(this.menuActionsType=e.menuActionsType),this._parent(e)},_reportAbuse:function(){var e=this;require(["DS/SwymUIComponents/script/feature/community/report-abuse/view/report-new-abuse-view","DS/SwymUICore/script/feature/community/report-abuse/model/report-abuse-model-v2"],function(t,i){var n=e.addChildView("reportNewAbuseView",new t({model:new i,reportedModel:e.model})),o=window.document||e._widget;n.render(o.body).show()})},updateMenuActions:function(){var e,t=this,i=[],n=r.getInstance();new v(function(e,i){c.prototype.getBlacklistedCommunitiesCollection(t._onActionsMenuShowFetchModels.bind(t,e,i)).hasBeenFetched()&&t._onActionsMenuShowFetchModels(e,i)}).then(function(){i.push(new v(function(e){y.isContentBookmarked(t.model.get("subject6wuri"),function(i){i?i.message?t.model.deleteCustomProperty("bookmark"):(t.model.setCustomProperty("bookmark",i),t._isBookmarked=!0,t._bookmark=i):(t.model.setCustomProperty("bookmark",!1),t._isBookmarked=!1),e()})})),"media"!==t.model.getModelName()||n.hasBeenFetched()||i.push(new v(function(e){r.getInstanceFetched(function(){e()})})),t.getOption("Subscribe")&&void 0===t.model.getCustomProperty("currentUserSubscribed")&&i.push(new v(function(e){var i={onComplete:e,onFailure:e};t.model.hasCurrentUserSubscribed(i)})),i.length>0&&v.all(i).then(function(){t._buildActionsMenu(),e=t.buildShareActions(),t.dispatchEvent("onMenuActionsUpdated",[t._actionMenu,e])},function(){k.log("Promises failed",arguments)})})},_onActionsMenuShowFetchModels:function(e){var t=this,i=this._isModelFetched,n=this.model,o=this,s=!1;i?e():(n.hasBeenFetched()&&(s=!0),n.fetch({fromCache:s,onComplete:function(){o.isDestroyed()||(t._actionMenu.splice(1,1),e(),o._isModelFetched=!0)}}))},_onSubscribeToggleItemClick:function(){this.model.getCustomProperty("currentUserSubscribed")?this.model.unsubscribe():this.model.subscribe()},_onShareItemClick:function(){new p({model:this.model}).launchModal()},buildShareActions:function(){var e=[],i=this._getForwardItem(this.model.get("_acl")),n=this.model.getModelName(),s=!o.getInstance().isDirectMessageContext(),a=this._widget&&this._widget.getAppName&&this._widget.getAppName()===t.getProfileAppKey(),r={label:_.Share,fonticon:"share-alt",handler:this._onShareItemClick.bind(this)};return e.push(r),i&&e.push(i),"survey"!==n&&!1!==this.getOption("ConvertToIdea")&&s&&!a&&e.push({label:_.ConvertToIdea,fonticon:"lamp",handler:this._onConvertToIdeaItemClick.bind(this)}),e},_addCommonActions:function(e,i,n,s){var a=o.getInstance(),r=!a.isDirectMessageContext(),l=this._widget&&this._widget.getAppName&&this._widget.getAppName()===t.getMyCommunitiesAppKey();!1!==this.getOption("Bookmark")&&void 0!==this.model.getCustomProperty("bookmark")&&this._actionMenu.push({label:this._isBookmarked?b.RemoveFromBookmarks:b.Bookmark,fonticon:this._isBookmarked?"bookmark-delete":"bookmark-add",handler:this._onBookmarkToggleItemClick.bind(this)}),this.getOption("Subscribe")&&this.model.getAuthor().get("hash_key")!==this._bootstrapModel.get("user").hash_key&&void 0!==this.model.getCustomProperty("currentUserSubscribed")&&this._actionMenu.push({label:this.model.getCustomProperty("currentUserSubscribed")?b.UnsubscribeToActivities:b.SubscribeToActivities,fonticon:"bell-alt",handler:this._onSubscribeToggleItemClick.bind(this)}),l&&"media"===n&&("picture"===i.get("media_type")||"3d_model"===i.get("media_type")&&"3dskt"!==i.getFileExtension()&&"3dsto"!==i.getFileExtension())&&this._actionMenu.push({label:_.SketchIt,fonticon:"app-3dsketch",handler:this._onConvertToSketchClick.bind(this)}),M&&"media"===n&&x.isFeatureActivated("activateSketchCoreview")&&this._actionMenu.push({label:_.SketchCoreview,fonticon:"brush",handler:this._onSketchCoreviewClick.bind(this)}),!(s.get("highlighted_content_uri")===i.get("subject6wuri"))&&r&&s.getUserRole()>2&&!1!==this.getOption("highlight")&&this._actionMenu.push({label:_.Highlight,fonticon:"megaphone",handler:this._onHighlightItemClick.bind(this)}),"survey"!==n&&!1!==this.getOption("RssFeed")&&this._bootstrapModel.isFeatureActivated("active_rss")&&r&&this._actionMenu.push({label:b.SubscribeToRSSFeed,fonticon:"rss",handler:this._subscribeToRssFeed.bind(this,[s])}),!1!==this.getOption("ReportAbuse")&&this._bootstrapModel.isFeatureActivated("activate_report_abuse_request")&&i.getAuthor().get("hash_key")!==this._bootstrapModel.get("user").hash_key&&r&&this._actionMenu.push({fonticon:"flag",label:_.ReportAbuse,handler:this._reportAbuse.bind(this)});var c=a.isCommunityContext(),d=a.isContentContext();!r||c&&!d||(!1!==this.getOption("FollowUnfollow")&&this._actionMenu.push({label:s.get("isBlacklisted")?b.Follow:b.Unfollow,fonticon:s.get("isBlacklisted")?"eye":"eye-slash",handler:this._onFollowToggleItemClick.bind(this)}),!0===s.getDeleteRight()&&!1!==this.getOption("LeaveCommunity")&&this._actionMenu.push({label:b.LeaveCommunity,fonticon:"logout",handler:this._onLeaveCommunityClick.bind(this,[s])}))},_getForwardItem:function(e){var t=null;return e&&e.forward&&!0===e.forward.access&&!0===this.getOption("forward")&&(t={label:_.Forward,fonticon:"import",handler:this._onForwardItemClick.bind(this)}),t},_getDeleteItem:function(e){var t=null,i=!0,n=this.model.getModelName();return e.delete&&!0===e.delete.access&&!1!==this.getOption("Delete")&&("wiki"!==n||this._bootstrapModel.isFeatureActivated("activate_wiki_delete")||(i=!1),i&&(t={label:_.Delete,fonticon:"trash",handler:this._onDeleteItemClick.bind(this)})),t},_getEditPropertiesItem:function(e){var t=null;return e.update&&e.update.access&&(t={label:_.EditProperties,fonticon:"pencil",handler:this._onEditPropertiesItemClick.bind(this)}),t},_onEditPropertiesItemClick:function(){T.trackPageEvent({category:"Lightbox",label:"editMediaPropertiesSecondaryMenu",view:"shared-lightbox-view",event:"click",contenType:this.model.get("model"),mediaType:this.model.get("media_type"),extension:this.model.get("media_file_ext"),threadType:this.model.get("community")?this.model.get("community").community_type:"none"}),this.dispatchEvent("onEditPropertiesClick")},_getPinToThisTabItem:function(e){var i=null,n=this.model.getCommunity();return!1!==this.getOption("pinToThisTab")&&window.ds&&"3DD"===window.ds.env&&window.widget&&widget.getAppName()===t.getMyCommunitiesAppKey()&&(i={label:b.PinToThisTab,fonticon:"pin",handler:this._pinToThisTab.bind(this,[n])}),i},_getRestartProcessing:function(e){var t=null,i=this.model.getModelName(),n=this.model.getCommunity();return"media"!==i||!this.model.getAuthor().isCurrentUser()&&n.getUserRole()!==l.COMMUNITY_OWNER_ROLE&&"1"!==e.get("tenant_admin")||(t={label:I.get("Restartprocessing"),fonticon:"refresh",handler:this.model.reprocess.bind(this.model)}),t},_addSpecialRightActions:function(e,t,i,n){var o=t.get("_acl");if(o.update&&o.update.access&&!1!==this.getOption("Edit")&&("survey"!==i||"survey"===i&&!t.hasEnded()))if(this.model.get("_revisionToDisplay")>=0)this._actionMenu.push({label:_.Edit,fonticon:"pencil",handler:this._onEditItemClick.bind(this)});else{var s="media"===this.model.getModelName()&&(this.model.is3DSketchExtension()||this.model.is3DStoExtension());(s&&"processed"===this.model.get("status")||!s)&&this._actionMenu.push({label:_.Edit,fonticon:"pencil",handler:this._onEditItemClick.bind(this)})}var a=this._getEditPropertiesItem(o);a&&this._actionMenu.push(a);var r=this._getDeleteItem(o);r&&this._actionMenu.push(r);var l=this._getPinToThisTabItem(o);l&&this._actionMenu.push(l);var c=this._getRestartProcessing(n);c&&this._actionMenu.push(c)},_buildActionsMenu:function(){var e=this.model,t=e.getModelName(),i=r.getInstance(),n=e.get("_acl"),o=e.getCommunity(),s=!0===e.isConsideredAsA360MediaModel();if(!n)throw new Error("No acl in the current model!");this._actionMenu=[],s&&!this._360played&&this._actionMenu.push({fonticon:"media-360",label:_.Play,handler:function(e){this.dispatchEvent("onPlay",[e]),this._360played=!0,this.updateMenuActions()}.bind(this)}),this._addCommonActions(this._actionMenu,e,t,o),this._addSpecialRightActions(this._actionMenu,e,t,o,i)},_onForwardItemClick:function(){require(["DS/SwymUIComponents/script/feature/community/content/forward-modal"],function(e){new e({model:this.model}).show()}.bind(this))},_onEditItemClick:function(){var e=this.model,t=e.getCommunity(),i=e.get("mid"),n=e.getModelName(),s=t.get("mid"),a=o.getInstance();window.ds&&"3DD"===window.ds.env?f.goToContent(i,n,s,!0,void 0,void 0,"dm"===t.get("community_type")):a.reset({contentId:i,contentType:n,communityId:s,dmId:"dm"===t.get("community_type")?s:void 0,editionMode:!0})},_onDeleteItemClick:function(){var e=this;"wiki"===e.model.getModelName()?e.model.isLeafNode().then(function(t){!0===t?e._displayConfirmationModal(!1,S.Areyousureyouwanttodeletethispage):(e.deletionTypeModal||(e.addControl("onlyToggle",new w({className:"primary",checked:!1,value:S.Onlythispage,name:"deletionType"})),e.deletionTypeModal=e.addControl("deletionTypeModal",new u({header:"<h4>"+S.Doyouwanttodelete+"</h4>",className:"fancy",body:[new w({className:"primary",checked:!0,value:S.Thispageanditssubpages,name:"deletionType"}),e.getControl("onlyToggle")],footer:[new C({className:"primary",value:_.Confirm,events:{onClick:function(){e.deletionTypeModal.hide(),e._displayConfirmationModal(!e.getControl("onlyToggle").isChecked(),e.getControl("onlyToggle").isChecked()?S.Areyousureyouwanttodeletethispage:S.Areyousureyouwanttodeletethispageanditssubpages)}}}),new C({value:S.Cancel,events:{onClick:function(){e.deletionTypeModal.hide()}}})],closable:!1}))),e.deletionTypeModal.show())}):e._displayConfirmationModal()},_displayConfirmationModal:function(e,t){var i=this;(this.getControl("confirmModal")||this.addControl("confirmModal",new m({closable:!0,renderTo:window.document.body||this._widget.body}))).confirm({title:_.Confirm,message:t||_.ContentDeletionMsg,callback:function(t){!0===t&&i.model.destroy({data:e?{mustDeleteSubpages:e}:null,onComplete:function(){var e=o.getInstance();i.alert("success",_.ContentDeleted),e.isContentContext()&&("wiki"===e.contentType?e.reset({communityId:e.communityId,path:"community:"+e.communityId}):U.backToListing())},onFailure:function(){console.error("error",arguments),i.alert("error",_.ContentNotDeleted)}})}})},_onConvertToSketchClick:function(){M?o.getInstance().reset({quadrant:E.WEST_QUADRANT,path:E.WEST_QUADRANT+"/"+E.SKETCH_CREATION_URL_PART+":"+this.model.get("mid")}):f.goToSketchCreation(this.model.get("mid"))},_onSketchCoreviewClick:function(){var e=this,t=o.getInstance(),i=null;window.require(["DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model"],function(n){i=new n({mid:e.model.getAssociated("community").get("mid")}),t.reset({quadrant:E.WEST_QUADRANT,path:E.WEST_QUADRANT+"/"+E.SKETCH_CREATION_URL_PART+":"+e.model.get("mid"),coreviewData:{action:"initCoreview",data:{communityId:e.model.get("community->mid"),mediaId:e.model.get("mid"),login:i.getAssociated("users").toJSON()}}})})},_onConvertToIdeaItemClick:function(){var e=this;require(["DS/SwymUIComponents/script/feature/community/idea/view/idea-converter-view","DS/SwymUIComponents/script/feature/core/modal/modal","i18n!DS/SwymUIComponents/assets/nls/feature/community/generic/view/content-title-view","DS/UIKIT/Input/Button"],function(t,i,n,o){e._convertLayerView?e._convertLayerView.setModel(e.model):(e._convertLayerView=e.addChildView("convertLayerView",new t({model:e.model})),e._convertLayer=e.addControl("convertLayer",new i({header:n.Contenttoidea,className:"convert-idea-modal-wrapper",body:[e._convertLayerView],footer:[e._convertLayerView.addControl("create",new o({value:n.Create,className:"primary",key:"return",events:{onClick:function(){e._convertLayerView.convertIdea(e._convertLayer)}}})),new o({value:n.Cancel,key:"esc",events:{onClick:function(){e._convertLayer.hide()}}})]}))),e._convertLayer.show()})},_onHighlightItemClick:function(){var e=this.model,t=e.getCommunity();e&&t&&(t.addChanges("highlighted_content_uri",e.get("subject6wuri")),t.save({},{onComplete:function(){this.alert("success",_.HighlightSuccess)}.bind(this),onFailure:function(){this.alert("error",_.HighlightFailure)}.bind(this)})),this.updateMenuActions()},_onFollowToggleItemClick:function(){var e=this,t=this.model.getCommunity(),n=this.getControl("confirmModal")||this.addControl("confirmModal",new m({closable:!0,renderTo:window.document.body||this._widget.body}));!1===t.get("isBlacklisted")?n.confirm({title:b.Hideallupdates+" "+t.get("title").unescapeHTML(),message:b.Youwillstillbe,callback:function(n){!0===n&&t.unfollow({onFailure:function(e,t){console.error("error",t)},onComplete:function(){e.updateMenuActions(),e.alert("success",b.nownotfollowing),t.set("isBlacklisted",!0),i.dispatchEvent("requestContentListUpdate",{contextPath:"home"})}})}}):t.follow({onFailure:function(e,t){console.error("error",t)},onComplete:function(){e.updateMenuActions(),e.alert("success",b.nowfollowing),t.set("isBlacklisted",!1),i.dispatchEvent("requestContentListUpdate",{contextPath:"home"})}})},_onBookmarkToggleItemClick:function(){var e;this._isBookmarked?(y.remove(this._bookmark),T.trackPageEvent({category:"Bookmark",label:"deleteBookmark",view:"action-menu-view",event:"click"})):(e=(e=t.get3DDTransientAppUrl({appId:t.getMyCommunitiesAppKey(),community:this.model.get("community->mid"),contentType:this.model.getModelName(),contentId:this.model.get("mid"),communityType:this.model.get("community").users?"dm":"community"})).match(/^.*(\/#app.*)url.*(community=.*)/),y.add({title:this.model.get("title"),subjectUri:this.model.get("subject6wuri"),serviceName:"3DSwym",linkServiceName:"3DSwym",linkUri:e[1]&&e[2]?e[1]+e[2]:""}),T.trackPageEvent({category:"Bookmark",label:"createBookmark",view:"action-menu-view",event:"click"})),this.updateMenuActions()},_subscribeToRssFeed:function(){const e=`${t.getBaseUrl()}${this.model.getRssLink(this._limit)}`;h.createModal(e)},_pinToThisTab:function(){window.ds&&"3DD"===window.ds.env&&window.widget&&widget.getAppName()===t.getMyCommunitiesAppKey()&&t.pinToDashboard({appId:t.getContentReaderAppKey(),data:{url:t.getBaseUrl(),community:this.model.get("community").id,contentId:this.model.get("mid"),contentType:this.model.get("id").split(":").shift()}})},_onLeaveCommunityClick:function(e){var t=e[0];(this.getControl("confirmModal")||this.addControl("confirmModal",new m({closable:!0,renderTo:window.document.body||this._widget.body}))).confirm({title:b.deletequestion,message:b.removeMyAccessToThisCommunity,callback:function(e){var n=this;!0===e&&t.deletecurrentuserfromcommunity({onComplete:function(){n.alert("success",b.Youhavebeendeletedfromthiscommunity),i.dispatchEvent("requestContentListUpdate",{contextPath:"home"})},onFailure:function(e,t){"ERROR_TRY_TO_LEAVE_COMMUNITY_WITH_IMPLICIT_ROLE"===t.errorcode&&this.alert("error",D.ErrorTryToLeaveCommunity)}.bind(this)})}.bind(this)})}})}),define("DS/SwymUIComponents/script/feature/community/survey/edit/survey-creator-view",["UWA/String","UWA/Core","DS/SwymUIComponents/script/feature/community/content/edit/abstract-content-editor-body-view","DS/SwymUIComponents/script/feature/community/survey/view/survey-editor-view","DS/SwymUICore/script/feature/community/survey/model/survey-model","i18n!DS/SwymUIComponents/assets/nls/feature/community/survey/edit/survey-creator-view"],function(e,t,i,n,o,s){"use strict";return i.extend({name:"survey-editor-body-view",_modelEvents:{onVirtualChange:"contentChanged"},_createContent:function(){return[{class:"survey-creator-minimized",html:s.Startyoursurvey},this.getChildView("survey-editor")]},setup:function(){if(!this.model||!this.model.get("mid"))if(this.model&&"survey"===this.model.getModelName()){var e,t,i=this.model.get("options");if(i&&i.hasOwnProperty("questions"))for(e in i.questions)i.questions.hasOwnProperty(e)&&(t=i.questions[e]),this.model.addQuestion(t)}else this.model=new o;return this.addChildView("survey-editor",{Class:n,model:this.model,events:{onContentChange:this.contentChanged.bind(this)}}),this._parent.apply(this,arguments)},contentChanged:function(){this.dispatchEvent("onContentChange")},isContentEmpty:function(){var t=this.getContentAttributes();return!!(t.hasOwnProperty("questions")&&0===t.questions.length||t.questions.hasOwnProperty("0")&&t.questions[0].hasOwnProperty("answers")&&t.questions[0].hasOwnProperty("description")&&""===e.unescapeHTML(t.questions[0].description)&&t.questions[0].answers.hasOwnProperty("0")&&t.questions[0].answers.hasOwnProperty("1")&&""===t.questions[0].answers[0].description&&""===t.questions[0].answers[1].description&&1===t.questions.length&&2===t.questions[0].answers.length)},validateContent:function(e){var t=this.getChildView("survey-editor");return!!(t&&e&&e.publish)&&!0===t.validate()},validateFirstStepContent:function(){var e=this.getChildView("survey-editor");return!!e&&!0===e.validateQuestions()},goToNextStep:function(){var e=this.getChildView("survey-editor");e&&e.goToNextStep()},goToPreviousStep:function(){var e=this.getChildView("survey-editor");e&&e.goToPreviousStep()},resetContent:function(){var e=this.getChildView("survey-editor");this.model.getAssociated("questions").reset([]),e&&e.refresh()},refreshContent:function(){},getContentAttributes:function(){var e,i=this.getChildView("survey-editor"),n=i.getChildViews(),o=t.merge({},this.model.getChanges());return o.questions=[],this.model.getAssociated("questions").forEach(function(o){var s=o.toJSON();for(e in t.extend(s,o.getChanges()),s.answers=[],n)o===i.getChildView(e).model&&(s.description=i.getChildView(e).getRTEView().getContentAttributes().content);o.getAssociated("answers").forEach(function(e){var i=e.toJSON();t.extend(i,e.getChanges()),this.answers.push(i)}.bind(s)),this.questions.push(s)}.bind(o)),delete o.title,o},getMediaCollectionLength:function(){var e,t=0,i=this.getChildView("survey-editor"),n=i.getChildViews();for(e in n)t+=i.getChildView(e).getRTEView().getMediaCollectionLength();return t},getMediaCollection:function(){},uploadMedia:function(e){var t,i=this.getChildView("survey-editor"),n=i.getChildViews(),o=[],s=function(t){return new Promise(function(n,o){i.getChildView(t).getRTEView().uploadMedia({communityId:e.communityId,onUploadsComplete:function(){n()},onUploadsFailure:function(){o()}})})};for(t in n)i.getChildView(t).getRTEView().getMediaCollectionLength()>0&&o.push(s(t));Promise.all(o).then(function(){e.onUploadsComplete()},function(t){e.onUploadsFailure(t)})},addMedia:function(e){var t,i=this.getChildView("survey-editor"),n=i.getChildViews();for(t in n)i.getChildView(t).getRTEView().addMedia(e)}})}),define("DS/SwymUIComponents/script/feature/community/media/view/shared-lightbox-view",["UWA/Core","DS/Logger/Logger","DS/UIKIT/Spinner","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/history/history-model","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/feature/core/sprite/sprite","DS/SwymUICore/script/utils/localstorage-manager","DS/SwymUICore/script/utils/usage-tracker","DS/SwymUICore/script/feature/core/mobile/communication-manager","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/core/context/context-constants","DS/SwymUICore/script/utils/app-navigation-state","DS/SwymUIComponents/script/utils/media-utils","DS/SwymUIComponents/script/feature/community/media/view/lightbox-top-bar-actions/primary-actions-mixin","DS/SwymUIComponents/script/feature/community/media/view/lightbox-top-bar-actions/menu-actions-lightbox-view","DS/SwymUIComponents/script/feature/community/media/view/lightbox-top-bar-actions/info-panel-view","DS/SwymUICore/script/lib/pub-sub","DS/SwymUICore/script/lib/event-manager","DS/SwymUIComponents/script/feature/community/media/video/model-interface/factory","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/view/shared-lightbox-view","text!DS/SwymUIComponents/assets/template/shared-lightbox.vue","DS/SwymUIComponents/script/utils/swym-vue","DS/SwymUIComponents/script/utils/feature-activation-manager"],(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w,C,f,y,v,A,_,S,b,I,D)=>{const{Vue:T}=I,E=e=>e.isDocumentOfficeExtension(),U=window.ds&&"MOBILE"===window.ds.env,k=window.ds&&window.ds.isMDE,x=window.ds&&"3DD"===window.ds.env;let M=!1,V=null;return x&&require(["DS/SwymUIComponents/script/utils/dnd-utils"],e=>{V=e}),n.extend({name:"shared-lightbox-view",_modelClass:o,_isAutoplayActivated:!0,_is360Played:!1,_hideArrows:!0,collection:void 0,_modelEvents:{onSync:"updateData"},_shareActionMenuItems:null,_lightboxPanelState:null,_isDownloadIconHidden:null,_topStyle:null,modelInterface:null,menuActionsView:null,customMenuActions:!1,onClickCustomActions:void 0,defaultOptions:{hideCloseIcon:!1},domEvents:{dragstart:"onTitleDragStart"},onTitleDragStart(e){const{model:t}=this;V&&V.onItemDrag(t,e,this._widget)},_resizeCallbackDebounced:null,_resizeCallback(){const t=this._view.$refs.lightboxContainer;this._topStyle&&(3===s.getNbLayoutColumns()?this._topStyle={"margin-top":"15px",top:"unset"}:this._topStyle={"margin-top":"unset",top:"unset"},e.extendElement(t.$refs.lightbox).setStyles(this._topStyle)),1===s.getNbLayoutColumns()&&this.getCommentPanel().show&&this._view.onClickComment()},getDragAndDropAttributes:e=>({draggable:!0,"data-content-id":e.get("mid"),"data-content-type":"media","data-community-id":e.getCommunity().get("mid")}),loadAnnotation(e){e&&"annotation"===e.type&&this.annotationsEventBus&&this.annotationsEventBus.dispatchEvent("onLoadAnnotationRequest",e,!0)},getCommentPanel(){return this._view.panels.find(e=>"comment"===e.name)},onAnnotationShared(){const e=this.getCommentPanel(),{contentModel:t}=this;e&&(e.show=!0);const i=this.getChildView("socialFeatures")&&this.getChildView("socialFeatures").getControl("socialToolbar")&&this.getChildView("socialFeatures").getControl("socialToolbar")&&this.getChildView("socialFeatures").getControl("socialToolbar").container.getElement(".st-comment-editor");i&&i.addClassName("st-has-media"),m.trackPageEvent({category:"Annotation",label:"createAnnotation",view:"shared-lightbox-view",event:"click",contenType:t&&t.getModelName()})},onLoadAnnotationRequest(e){let t,i,n;const a=this,r=e&&e.relatedMediaUri,l=e&&e.subjectUri,{contentModel:c}=this,d=c&&c.get("subject6wuri"),{model:m}=this,u=m&&m.get("subject6wuri");d===l&&u!==r&&(t=r&&r.split(":").pop())&&((i=new o({mid:t})).hasBeenFetched()?this.setModel(i):i.fetch({onComplete(e){a.setModel(e)}})),1===s.getNbLayoutColumns()&&((n=this.getCommentPanel())&&(n.show=!1),this._view.getItem("comment").selected=!1)},init(){return A.addEvent("commentIconClickedInCompactView",this.commentIconClickedInCompactView.bind(this)),this.addEvent("onChildViewAdd:socialFeatures",this.onSocialFeaturesChildViewAdded.bind(this)),this._parent.apply(this,arguments)},commentIconClickedInCompactView(){M=!0,A.removePersisted("commentIconClickedInCompactView")},onSocialFeaturesChildViewAdded(){const e=this.getChildView("socialFeatures");let t=null;const i=this;M||e.addEvent("onSocialToolbarInjected",()=>{!function(e){setTimeout(()=>{(t=i&&i.getElement(e))&&(t.click(),M=!1)},2e3)}(".st-action-toolbar-buttons .fonticon-comment")})},setup(t){this._parent.apply(this,arguments),s.isCloud()&&d.setItem("3DPlay.ActivateSwymPDFComment","true"),this.annotationsEventBus&&this.annotationsEventBus.removeEvents(),this.annotationsEventBus=new v,this.annotationsEventBus.addEvent("onAnnotationShared",this.onAnnotationShared.bind(this)),this.annotationsEventBus.addEvent("onLoadAnnotationRequest",this.onLoadAnnotationRequest.bind(this)),void 0!==t.isAutoplayActivated&&(this._isAutoplayActivated=t.isAutoplayActivated),this._widget||(this._widget=t._widget),this.setModel(t.model),t.collection&&(this.collection=t.collection,this.model.hasBeenFetched()||this.model.isNew()||this.model.fetch(),t.collection.length>1&&(this._hideArrows=!1)),t.contentModel?this.contentModel=t.contentModel:this.contentModel=this.model,t.customMenuActions&&(t.onClickCustomActions?(this.customMenuActions=t.customMenuActions,this.onClickCustomActions=t.onClickCustomActions):console.warn('You need to add an "onClickCustomActions" function to populate the menu Actions on click')),1===s.getNbLayoutColumns()?(this._lightboxPanelState="closed",g.saveLightboxPanelState(this._lightboxPanelState)):this._lightboxPanelState=g.getLightboxPanelState(),this._context=r.getInstance(),this._context.addListener("onContextChange",this._onContextChange,this),this.model.isConsideredAsA360MediaModel()&&(this._isAutoplayActivated=!1),this.modelInterface=k?_.getInterfaceModule(this.model):null,this.menuActionsView=new f({model:this.model,_widget:this._widget}),this._isDownloadIconHidden=this.isDownloadIconHidden(),t.elementToInjectIn?this.setOption("elementToInjectIn",t.elementToInjectIn):this.setOption("elementToInjectIn",e.extendElement(document).getElement(".swym-im")),t.hideCloseIcon&&this.setOption("hideCloseIcon",t.hideCloseIcon),this._resizeCallbackDebounced=s.debounce(this._resizeCallback.bind(this),300),window.addEventListener("resize",this._resizeCallbackDebounced.bind(this)),window.document.onkeydown=function(e){let t=!1;(t="key"in(e=e||window.event)?"Escape"==e.key||"Esc"==e.key:27==e.keyCode)&&this._closeLightbox()}.bind(this)},updateData(){if(this._view){this._view.title=this.model.get("title",{escapeHTML:!1}),this._view.objectType=this._getObjectTypes();const e=this._view.primaryActions.find(e=>"pencil"===e.fonticon),t=this._view.getItem("download");if(e&&(e.hidden=!this.isMediaEditable()||!this.model.get("_acl").update.access),t&&(t.hidden=this.isDownloadIconHidden()),["sound","video","drawing"].includes(this.model.get("media_type"))){let e=this._view.menuActions;e&&"1"===this.model.get("download_original_file")?e.splice(1,0,{fonticon:"download",label:S.Download,handler:this._view.onClickDownload}):e=e&&e.filter(e=>"download"!==e.fonticon),this._view.menuActions=e}}},_onContextChange(){(this._context.contentId!==(this.model&&this.model.get("mid"))||this._context.isContentEditionContext())&&(this.model&&m.trackPageEvent({category:"Lightbox",label:"closeViewLightbox",view:"shared-lightbox-view",event:"click",contenType:this.contentModel.get("model"),mediaType:this.model.get("media_type"),extension:this.model.get("media_file_ext"),threadType:this.model.get("community")?this.model.get("community").community_type:"none"}),this.destroy())},showOtherPageElements(){window&&"3DSwym"===window.ds.env&&(e.extend(document.body).getElement(".main").show(),e.extend(document.body).getElement("#topbar").show())},onRedraw(){const i=this,n=this.addChildView("infoPanelView",{Class:y,model:this.model}).render();this.container.inject(this.getOption("elementToInjectIn"),"top"),this.listenTo(this.getChildView("infoPanelView"),"getPlayerStateRequest",this._onGetPlayerStateRequest.bind(this,n)),this._view=new T({el:i.container.getElement(".shared-lightbox-container"),template:b,methods:{getItem(e){return this.$children[0].primaryActions.find(t=>t.name===e)},getPanel(e){return this.panels.find(t=>t.name===e)},onClickComment(){!0===this.getItem("comment").selected?(this.getItem("comment").selected=!1,this.currentPanel=null,this.$children[0].panels.find(e=>"comment"===e.name).show=!1,g.saveLightboxPanelState("closed")):(this.getItem("comment").selected=!0,this.getItem("information").selected=!1,this.currentPanel="comment",this.getPanel("comment").show=!0,this.getPanel("information").show=!1,g.saveLightboxPanelState("comment")),m.trackPageEvent({category:"Lightbox",label:"iconComment",view:"shared-lightbox-view",event:"click"})},onClickDownload(){const e="3d_model"===i.model.get("media_type"),t=e&&i._get3d_modelFormats();(!e||e&&1===t.length||this.hasSolidWorksFileExtension())&&C.download(i.model),m.trackPageEvent({category:"Lightbox",label:"iconDownload",view:"shared-lightbox-view",event:"click"})},onClickShare(){m.trackPageEvent({category:"Lightbox",label:"iconShare",view:"shared-lightbox-view",event:"click"})},onClickInformation(){!0===this.getItem("information").selected?(this.getItem("information").selected=!1,this.getPanel("information").show=!1,g.saveLightboxPanelState("closed")):(this.getItem("information").selected=!0,this.getItem("comment").selected=!1,this.getPanel("information").show=!0,this.getPanel("comment").show=!1,g.saveLightboxPanelState("info")),m.trackPageEvent({category:"Lightbox",label:"iconInformation",view:"shared-lightbox-view",event:"click"})},onClickMoreActions(){t.log("onClickMoreActions"),i.onClickCustomActions()},goToEdit(){s.isMobile()&&E(i.model)?C.launchDisabledEditModalCallback("edit"):(this.getItem("edit").hidden=!0,i.goToEdit())},onClose(){i._onBack()},onClickNext(){i._goToNextMedia(),m.trackPageEvent({category:"Lightbox",label:"iconNext",view:"shared-lightbox-view",event:"click"})},onClickPrevious(){i._goToPreviousMedia(),m.trackPageEvent({category:"Lightbox",label:"iconPrevious",view:"shared-lightbox-view",event:"click"})},onCancelEditProperties(){const e=this.getPanel("information");e.title=S.Information,e.showEdit=!0,this.isPropertyEdit=!1,this.getItem("edit").disabled=!1},hide(){this.isVisible=!1},show(){this.isVisible=!0},onEditPropertiesPanelClick(){m.trackPageEvent({category:"Lightbox",label:"editMediaPropertiesInfoPanel",view:"shared-lightbox-view",event:"click"}),this.editProperties()},onEditPropertiesSecondaryMenuClick(){m.trackPageEvent({category:"Lightbox",label:"editMediaPropertiesSecondaryMenu",view:"shared-lightbox-view",event:"click"}),this.editProperties()},editProperties(){const e=this.getPanel("information");!1===e.show&&this.onClickInformation(),e.title=S.EditProperties,e.showEdit=!1,this.isPropertyEdit=!0,this.getItem("edit").disabled=!0}},data:()=>({closeLabel:S.Close,moreActionsLabel:S.More,userId:h.getInstance().get("user").login,isVisible:!0,isPropertyEdit:i._context.editProperties,is3DDWidget:x,title:i.model.get("title",{escapeHTML:!1}),objectType:i._getObjectTypes(),customActions:i.customMenuActions,shareAction:{label:S.Share,name:"share",fonticon:"share-alt",selected:!1,disabled:!1,hidden:!1,items:[]},downloadAction:{label:S.Download,name:"download",fonticon:"download",selected:!1,disabled:!1,hidden:i._isDownloadIconHidden},hideEditAction:!i.isMediaEditable()||!i.model.get("_acl").update.access,menuActions:[],sideActions:[{label:S.Previous,name:"previous",fonticon:"chevron-left",selected:!1,disabled:!1,hidden:i._hideArrows},{label:S.Next,name:"next",fonticon:"chevron-right",selected:!1,disabled:!1,hidden:i._hideArrows}],panels:[{name:"comment",show:"comment"===i._lightboxPanelState,title:S.Comments,showClose:!0},{name:"information",show:"info"===i._lightboxPanelState,title:i._context.editProperties?S.EditProperties:S.Information,showClose:!0,showEdit:!i._context.editProperties&&i.model.get("_acl").update.access}],lightboxStyle:i._lightboxContentStyle()}),computed:{primaryActions(){return[{label:S.Edit,name:"edit",fonticon:"pencil",selected:!1,disabled:!1,hidden:this.hideEditAction},{label:S.Comment,name:"comment",fonticon:"topbar-comment",selected:"comment"===i._lightboxPanelState,disabled:!1,hidden:!1},this.shareAction,this.downloadAction,{label:S.Information,name:"information",fonticon:x?"info":"topbar-info",selected:"info"===i._lightboxPanelState,disabled:!1,hidden:!1},{label:S.MoreActions,name:"more-actions",fonticon:"chevron-down",selected:!1,disabled:!1,hidden:!i.customMenuActions}]}},mounted(){const n=e.extendElement(this.$refs.lightboxContentContainer),o=this.$refs.lightboxContainer;if(t.log("Lightbox is mounted"),i.getOption("hideCloseIcon")&&(e.extendElement(this.$el.querySelectorAll(".lightbox-bar__divider + .lightbox-bar-menu-item")[0]).hide(),e.extendElement(this.$el.querySelectorAll(".lightbox-bar__divider")[0]).hide()),i._topStyle&&e.extendElement(o.$refs.lightbox).setStyles(i._topStyle),i.customMenuActions||(i.menuActionsView.updateMenuActions(),i.menuActionsView.addEvent("onMenuActionsUpdated",function(...[e,t]){("1"===this.model.get("download_original_file")&&["sound","video","drawing"].includes(this.model.get("media_type"))||i._isDownloadIconHidden&&i.model&&E(i.model)&&D.isFeatureActivated("activateODEViewer"))&&e.splice(1,0,{fonticon:"download",label:S.Download,handler:i._view.onClickDownload}),this._view.menuActions=e,this._shareActionMenuItems=t,this._view.shareAction={label:S.Share,name:"share",fonticon:"share-alt",selected:!1,disabled:!1,hidden:!1,items:this._shareActionMenuItems}}.bind(i)),i.menuActionsView.addEvent("onPlay",function(){this._is360Played=!0,this._displayContent(n)}.bind(i)),i.menuActionsView.addEvent("onEditPropertiesClick",this.onEditPropertiesSecondaryMenuClick)),i._displayContent(n),i.addChildView("socialFeatures",e.extend({model:i.contentModel,comments:!0,showAnswers:!0,forceCommentFetchIfNotDoneYet:!0,Class:"DS/SwymUIComponents/script/feature/community/content/social-interactions/social-toolbar-view",modelName:i.contentModel.getModelName(),socialToolbarMode:"normal",widget:i._widget,enableShare:!1,commentsNumberAtInit:5,sendCommentsInitCallInPool:!1,showCommentsSummaryFirst:!0,showNonValidatedAnswersAtInit:!0,annotationsEventBus:i.annotationsEventBus})).inject(e.extend(this.$el.getElementsByClassName("vu-dynamic-panel-wrap-comment"))[0],"bottom"),m.trackPageEvent({category:"Lightbox",label:"ViewLightboxCreation",view:"shared-lightbox-view",event:"click",contenType:i.contentModel.get("model"),mediaType:i.model.get("media_type"),extension:i.model.get("media_file_ext"),threadType:i.model.get("community")?i.model.get("community").community_type:"none"}),U&&u.sendLightboxIsShown(),x){e.extendElement(this.$el.querySelectorAll(".lightbox-bar-menu-item")[0]).setAttributes(i.getDragAndDropAttributes(i.model))}if(i._context.editProperties){!1===this.getPanel("information").show&&this.onClickInformation()}}})},goToEdit(){const{model:e}=this,t=e.getCommunity(),i=e.get("mid"),n=e.getModelName(),o=t.get("mid");this._view.hide(),l.goToContent(i,n,o,!0,void 0,void 0,"dm"===t.get("community_type"))},onDestroy(){U&&u.sendLightboxIsHidden(),this._view&&this._view.hide(),this.annotationsEventBus.removeEvents(),this._context.removeListener("onContextChange",this._onContextChange)},onSetModel(){this._view&&(this.model.hasBeenFetched()||this.model.isNew()||this.model.fetch(),this._view.title=this.model.get("title",{escapeHTML:!1}),this._view.lightboxStyle=this._lightboxContentStyle(),this._displayContent(e.extend(this._view.$el.getElementsByClassName("shared-lightbox-content")[0])))},_onBack(){let e,t,i;const n=this._widget.getAppName()===s.getContentReaderAppKey();this._context.isCommunityHomePageContext()?n&&((i=(e=a.getState())&&e.previousContext).mediaId?l.goToContent(this.contentModel.get("mid"),this.contentModel.getModelName(),this._context.communityId,!1,void 0,void 0,"dm"===this.contentModel.getCommunity().get("community_type")):i.editionMode?a.backToListing():(a.back(),this._context.dispatchEvent("onBack"))):(i=(e=a.getState())&&e.previousContext,this._context.isCommunityContext()&&!this._context.isContentContext()?(i&&i.path&&i.communityId&&this._context.communityId===i.communityId&&(this._context.isContentContext(this._context.extractContextInfoFromRoute(i.path))||(t=this._context.getCommunityPageContext(i.path))),l.goToCommunity(this._context.communityId,t,void 0,Boolean(this._context.isDirectMessageContext()))):"media"!==this.contentModel.getModelName()&&this._context.isContentContext(i)?(!0===this._context.previousAttributes.editionMode||this._context.previousAttributes.mediaId)&&l.goToContent(this.contentModel.get("mid"),this.contentModel.getModelName(),this._context.communityId,!1,void 0,void 0,"dm"===this.contentModel.getCommunity().get("community_type")):(this._context.isContentEditionContext(i)||this._context.is3DStoryOr3DSketchCreationContext(i))&&this._context.isInTemporaryState()||a.backToListing())},_closeLightbox(){this.model&&this.contentModel===this.model&&this._onBack()},_lightboxContentStyle(){const e={display:"flex","justify-content":"center","align-items":"center",height:"100%",overflow:"auto"},t=this.model.get("media_type");let i;const n=this._hasExtensionType("svg");switch(t){case"document":i=this.model&&this.model.isDocumentOfficeExtension()&&!D.isFeatureActivated("activateODEViewer")||!this.model.isDocumentOfficeExtension()&&!this.model.isPDFExtension()?{display:"flex","justify-content":"center","align-items":"center",height:"100%"}:{display:"block",height:"100%","margin-left":"auto","margin-right":"auto"};break;case"picture":case"drawing":i=n?e:{display:"flex","justify-content":"center","align-items":"center",height:"calc(100% - 44px)",overflow:"auto"};break;case"3d_model":delete(i=e).overflow;break;case"sound":i={display:"grid","align-items":"center",width:"50%",height:"100%",margin:"auto"};break;default:i={display:"block",height:"100%",width:"100%","margin-left":"auto","margin-right":"auto"}}return this.model&&this.model.isSolidworksFileExtension()&&(i=e),i},_goToMedia(e){const t=this.contentModel.get("mid"),i=this.contentModel.getModelName(),n=this.contentModel.getCommunity(),o=n.get("mid");l.goToContent(t,i,o,!1,void 0,void 0,"dm"===n.get("community_type"),{mediaId:e})},_goToNextMedia(i,n){let o,s;if(t.log("go to next media"),(o=e.is(n,"number")?n:this.collection.indexOf(this.model))<this.collection.length-1){if(!0===(s=this.collection.at(o+1)).get("_deleted"))return this._goToNextMedia(i,o+1);this._goToMedia(s.get("mid"))}else t.log("we loop; we should go to the first media of the list"),this._goToMedia(this.collection._models[0].get("mid"))},_goToPreviousMedia(i,n){let o,s;if(t.log("go to previous media"),(o=e.is(n,"number")?n:this.collection.indexOf(this.model))>0){if(!0===(s=this.collection.at(o-1)).get("_deleted"))return this._goToPreviousMedia(i,o-1);this._goToMedia(s.get("mid"))}else t.log("we loop; we should go to the last media of the list"),this._goToMedia(this.collection._models[this.collection.length-1].get("mid"))},_hasExtensionType(e){const{model:t}=this;return t.get("format_3dsa")===e||t.get("media_file_ext")===e||t.get("fileName")&&t.get("fileName").endsWith(`.${e}`)},_getObjectTypes(){return{name:this.model.get("media_type"),icon:s.getMediaIconName(this.model),backgroundColor:"#70036b"}},_get3d_modelFormats(){const t=this.model.get("play")["3d_streams"],i=this.model.get("play").download_original_url,n=[];return t.forEach(e=>{n.push(e.format)}),i&&1===i.authorized_by_owner&&!n.includes(i.format)&&t.push(e.merge(i,{alias:i.format})),t},isMediaOpenedIn3DViewer(){const e=this._hasExtensionType("3dxml"),t=this._hasExtensionType("3dsto"),i=this._hasExtensionType("3dskt"),n=this._hasExtensionType("3dwb"),o=this.model.isPDFExtension();return e||t||i||n||o},isMediaOpenedInViewerInMobileApp(){if(U){let e;switch(this.model.get("media_type")){case"video":case"sound":e=!0;break;default:e=!1}return e}return!1},isMediaEditable(){const e=this.model.get("media_type");let t=!1;return(["picture","whiteboard","sketch","story"].includes(e)||E(this.model)&&D.isFeatureActivated("activateODEEditor"))&&(t=!0),t},isDownloadIconHidden(){let e=!0;return this.model&&(this.model.isDocumentOfficeExtension()&&!D.isFeatureActivated("activateODEViewer")||"1"===this.model.get("download_original_file")&&!["sound","video","drawing"].includes(this.model.get("media_type"))||this.hasSolidWorksFileExtension()||"document"===this.model.get("media_type")&&!this.model.isDocumentOfficeExtension())&&(e=!1),e},hasSolidWorksFileExtension(){return["sldprt","sldasm","slddrw"].includes(this.model.get("format_3dsa"))},_displayContent(t){const n=this;this._interactionActivated=!this.model.isConsideredAsA360MediaModel(),t&&!this._spinnerElement&&(this._spinnerElement=e.createElement("div",{class:"spinner-thumbnail",html:new i({className:"msg-animation",visible:!0,animate:!0,spin:!0})}).inject(t,"before"));const{model:o}=this,s=o.get("status"),a=this._hasExtensionType("3dxml"),r=this._hasExtensionType("3dsto"),l=this._hasExtensionType("3dskt"),c=this._hasExtensionType("3dwb"),d=this.model.isPDFExtension(),m=E(this.model)&&D.isFeatureActivated("activateODEViewer");s!==w.MEDIA_PROCESSING_STATUS.KO&&s!==w.MEDIA_PROCESSING_STATUS.READY||a||r||l||c||d||m?s!==w.MEDIA_PROCESSING_STATUS.OK||this.isMediaOpenedIn3DViewer()||!o.get("format_3dsa")&&!o.isConsideredAsA360MediaModel()?setTimeout(()=>{k?o.isDriveFile()?o.getDriveFileUrl().then(()=>{n._displayMediaView(t)}):o.fetch({onComplete:function(e){if(!this.isDestroyed()){const i=e.get("status");i===w.MEDIA_PROCESSING_STATUS.OK||this.isMediaOpenedIn3DViewer()?"animatedPicture"!==e.get("media_type")||e.isMediaAPlayableGIF()?this._displayMediaView(t):(this._spinnerElement.remove(),this._spinnerElement=null):this._displayErrorMessage(i,t)}}.bind(this)}):o.fetch({onComplete:function(e){if(!this.isDestroyed()){const i=e.get("status");i===w.MEDIA_PROCESSING_STATUS.OK||this.isMediaOpenedIn3DViewer()||!e.get("format_3dsa")?"animatedPicture"!==e.get("media_type")||e.isMediaAPlayableGIF()?this._displayMediaView(t):(this._spinnerElement.remove(),this._spinnerElement=null):this._displayErrorMessage(i,t)}}.bind(this)})},1):this._displayMediaView(t):this._displayErrorMessage(s,t)},_displayMediaView(i){const n=this,{model:o}=this,s=o.get("media_type")||o.get("drive_media_type"),a=o.isConsideredAsA360MediaModel()?"360Activated":"",r=this._hasExtensionType("svg");let l=null;if(this.pictureThumbnail&&this.pictureThumbnail.remove(),this.getChildView("interactive-thumbnail")&&this.removeChildView("interactive-thumbnail"),this.getChildView("mediaView")&&(this.removeChildView("mediaView"),i.setStyles({height:"unset",width:"unset"})),!["picture"].includes(o.get("media_type"))||this._is360Played||r)if(o&&this.isMediaOpenedInViewerInMobileApp())this.addChildView("interactive-thumbnail",{Class:"DS/SwymUIComponents/script/feature/community/media/view/interactive-media-thumbnail-view",model:this.model,imageReloadOptions:w.generateImageReloadOptionsForMedia({mediaId:this.model.get("mid"),mediaType:this.model.get("media_type"),mediaWidth:d,mediaHeight:m,containerWidth:u,containerHeight:h}),forcePlayInContext:!1,autoplay:!1,delegateSpriteReloadToParentView:!1}).inject(i,"top"),this._spinnerElement.remove();else if(k&&this.modelInterface)l=this.modelInterface.getMediaViewerModule(o,a);else{let e=null;const t=["3dxml","udl"],n=this.model.get("play")["3d_streams"]||this.model.get("play")["2d_streams"];if(n&&(this._hasExtensionType("sldprt")||this._hasExtensionType("sldasm")||this._hasExtensionType("slddrw")))for(let i=0,o=n.length;i<o;){const o=n[i];if(t.includes(o.format)){e=!1;break}e=!0,i+=1}e?(this.addChildView("interactive-thumbnail",{Class:"DS/SwymUIComponents/script/feature/community/media/view/interactive-media-thumbnail-view",model:this.model,imageReloadOptions:w.generateImageReloadOptionsForMedia({mediaId:this.model.get("mid"),mediaType:this.model.get("media_type"),mediaWidth:d,mediaHeight:m,containerWidth:u,containerHeight:h}),forcePlayInContext:!1,autoplay:!1,delegateSpriteReloadToParentView:!1,showDownloadIconForSLD:!0}).inject(i,"top"),this._spinnerElement.remove()):l=w.getMediaViewerModule(o,a)}else{var d=parseInt(o.get("width"),10),m=parseInt(o.get("height"),10),u=i.offsetWidth,h=i.offsetHeight;let t;const n=w.getImageRenderingOptionsForMedia(d,m,u,h),s=o.getModelName(),a=w.generateImageReloadOptionsForMedia({mediaId:o.get("mid"),mediaType:o.get("media_type"),mediaWidth:d,mediaHeight:m,containerWidth:u,containerHeight:h});t="community"===s&&o.get("picture_update")||o.get("update"),this.pictureThumbnail=c.renderMediaThumbnail(e.merge({mediaType:o.get("media_type"),imageUpdateTime:t,imageFingerprint:o.get("preview_fingerprint"),modelId:o.get("mid"),modelName:s,deletedMedia:!0===this.model.get("_deleted")},e.merge(n||{},a))),this.pictureThumbnail.setStyles({"max-width":"100%","max-height":"100%"}),this.pictureThumbnail.inject(i,"top"),this._spinnerElement.remove()}l&&require([l],e=>{if(!this.isDestroyed()){const a=i.offsetHeight,r=i.offsetWidth,l=r,c=a;const d=this.addChildView("mediaView",new e({model:o,height:c,width:l,isLightboxContext:!0,annotationsEventBus:this.annotationsEventBus,isFluid:!1,events:{onRefreshRequest(){d.destroy(),n._interactionActivated=!1,n.refresh()}},instantiatedInSummaryView:!1}));d.addEventOnce("mediaViewReady",()=>{
//! TO BE REMOVED IN 3DSwym 1.11 for MDE 1.21
if(this._touch&&"3d_model"===this.model.get("media_type")&&this._touch.set({enable:!1}),"video"!==s&&"animatedPicture"!==s||(i.setStyle("width","100%"),i.setStyle("height","100%")),t.log("the media is ready"),this._spinnerElement&&this._spinnerElement.remove(),["sound"].indexOf(s)>-1&&r&&(this.container.style.width=`${r}px`),this.container.addClassName("media-initialized"),"3d_model"===this.model.get("media_type")){this._isDownloadIconHidden=!this.hasSolidWorksFileExtension();const e=this._get3d_modelFormats();if(this._shareActionMenuItems.push({label:S.PublishToSwym,fonticon:"picture-add",handler:this._publishToSwymCallback.bind(this)}),this._view.shareAction={label:S.Share,name:"share",fonticon:"share-alt",selected:!1,disabled:!1,hidden:!1,items:this._shareActionMenuItems},e.length>1){const t=[];e.forEach(e=>{(e.transient_url_as_attachment||e.transient_url)&&t.push({label:e.alias,handler(){U?require(["DS/SwymUICore/script/feature/core/mobile/communication-manager"],t=>{t.sendDownloadMediaRequest({transientURL:e.transient_url_as_attachment||e.transient_url,extension:e.format})}):e.transient_url_as_attachment?window.open(e.transient_url_as_attachment,"_self"):window.open(e.transient_url,"_self")}})}),this._view.downloadAction={label:S.Download,name:"download",fonticon:"download",selected:!1,disabled:!1,hidden:this._isDownloadIconHidden,items:t}}}else if(this.model.isPDFExtension()){const e=[{label:S.PublishToSwym,fonticon:"picture-add",handler:this._publishToSwymCallback.bind(this)},{label:S.ShareAsComment,fonticon:"comment-add",handler:this._shareAsCommentCallback.bind(this)}];this._shareActionMenuItems=this._shareActionMenuItems.concat(e),this._view.shareAction={label:S.Share,name:"share",fonticon:"share-alt",selected:!1,disabled:!1,hidden:!1,items:this._shareActionMenuItems}}}),i&&(d.inject(i,"top"),"video"===this.model.get("media_type")&&d.container.getElement(".video-js").setStyles({"max-height":"100%",height:"100%",width:"100%"})),this._interactionActivated=!0}})},_publishToSwymCallback(){this.getChildView("mediaView").dispatchEvent("ShareTo3DSwYm")},_shareAsCommentCallback(){this.getChildView("mediaView").dispatchEvent("Share3DComment")},_displayErrorMessage(e,t){let i,n;this._interactionActivated=!1,e===w.MEDIA_PROCESSING_STATUS.KO?(i=S.AnErrorOccuredWhileProcessing,n="error"):(i=S.ThisMediaHasNotBeenProcessedYet,n="warn"),this.alert(n,i),this._spinnerElement.remove(),this._spinnerElement=null},_onGetPlayerStateRequest(e){const t=this.getChildView("mediaView").getState();e.dispatchEvent("playerStatusInfo",[t])},_createContent:()=>({tag:"div",class:"shared-lightbox-container"})})}),define("DS/SwymUIComponents/script/feature/community/media/edit/media-creator-body-view",["UWA/Core","UWA/String","DS/UIKIT/Tooltip","DS/UIKIT/Input/Toggle","DS/SwymUICore/script/utils/utils","DS/SwymUIComponents/script/feature/community/content/edit/abstract-content-editor-body-view","DS/SwymUIComponents/script/feature/community/media/view/uploader/dropzone-view","DS/SwymUIComponents/script/feature/community/content/edit/content-edition-media-view","DS/SwymUIComponents/script/feature/community/media/edit/upload/media-upload-queue","DS/SwymUICore/script/feature/core/context/context-model","i18n!DS/SwymUIComponents/assets/nls/feature/community/generic/view/properties-editor-view"],function(e,t,i,n,o,s,a,r,l,c,d){"use strict";return s.extend({_publishEnabled:!1,_titleContent:null,_content:null,_context:null,_communityId:null,_uploadsOngoing:!1,_modelEvents:{"onSync:read":"refresh"},name:"media-creator-body-view",_createContent:function(){var o;return o=e.createElement("span",{styles:{"margin-left":"10px"},class:"fonticon fonticon-help-circled"}),this.addControl("helpIconTooltip",new i({trigger:"touch",target:o,body:t.format(d.get("IfSelectedTheMediaWillBeDisplayedOnTheWhatsNew"),"<b>","</b>")})),this.addControl("highSemanticMediaCheckBox",new n({type:"checkbox",label:d.get("DisplayOnWhatsNew"),checked:!0,name:"displayonwhatsnew",className:"primary"})).getContent().setStyle("display","inline-block"),[this._getDropZoneView(),{class:"display-on-whatsnew-section",styles:{},html:[this.getControl("highSemanticMediaCheckBox"),o]},this._getMediaEditionView()]},_getDropZoneView:function(){var e=this.getChildView("dropzoneView"),t=["files"];return o.isCloud()&&t.push("sketch","story","whiteboard","ode"),e&&e._availableMediaTypes.length===t.length||(e=this.addChildView("dropzoneView",new a({widget:this._widget,model:this._community,showCollection:!1,typeAllowed:"file",availableMediaTypes:t})),this.listenTo(e,"triggerDocumentCreationRequest",this.onDocumentCreationRequest)),e},onDocumentCreationRequest:function(){this.dispatchEvent("triggerDocumentCreationRequest",arguments)},_focusOnDescription:function(){var e=this.getElement(".media-description");e.hasClassName("focused")||e.addClassName("focused")},_focusOutDescription:function(){var e=this.getElement(".media-description");e.hasClassName("focused")&&e.removeClassName("focused")},_onKeyup:function(e){var t=e.srcElement||e.target,i=t.innerText||t.innerHTML;i||t.hasClassName("show-placeholder")?i&&t.hasClassName("show-placeholder")&&t.removeClassName("show-placeholder"):t.addClassName("show-placeholder")},_createDescZone:function(){return e.createElement("div",{class:"media-description show-placeholder",contenteditable:"true","data-placeholder":"Please enter a description.."})},_getDndView:function(){return this._getMediaEditionView().getDndView()},refreshDragDetection:function(){return this._getMediaEditionView().refreshDragDetection()},stopDragDetection:function(){return this._getMediaEditionView().stopDragDetection()},_getMediaEditionView:function(){var e,t=this,i=this.getChildView("mediaEdition");return i||(e={communityId:this.getCommunityId()||void 0,Class:r,contentAttributeInModel:"media",allowDragNDrop:!1},(i=this.addChildView("mediaEdition",e)).addUploader("dropzoneView",this._getDropZoneView()),this.listenTo(i,{onMediaCollectionChange:this.onMediaCollectionChange.bind(this),onMediaUploadsStart:function(){t.onMediaUploadsStart(),this.dispatchEvent("onMediaUploadsStart")},onMediaUploadsComplete:function(){t.onMediaUploadsComplete(),this.dispatchEvent("onMediaUploadsComplete")},onMediaUploadsFailure:function(){t.onMediaUploadsComplete(),this.dispatchEvent("onMediaUploadsFailure")},onDragAndDrop:function(){this.dispatchEvent("onDragAndDrop",arguments)}})),i},onMediaUploadsStart:function(){this._uploadsOngoing=!0},onMediaUploadsComplete:function(){this._uploadsOngoing=!1},areUploadsOngoing:function(){return this._uploadsOngoing},getContentAttributes:function(){return{is_illustration:!this.getControl("highSemanticMediaCheckBox")||!this.getControl("highSemanticMediaCheckBox").isChecked()}},isContentEmpty:function(){return 0===this.getMediaCollectionLength()},resetContent:function(){var e=this.getControl("highSemanticMediaCheckBox");e&&e.setCheck(!0),this._getMediaEditionView().reset()},refreshContent:function(e,t){t&&(this._getMediaEditionView().setCollection(t),this._getMediaEditionView().refresh())},onMediaCollectionChange:function(){this.dispatchEvent("onContentChange")},getMediaCollectionLength:function(){return this._getMediaEditionView().getCollectionLength()},getMediaCollection:function(){return this._getMediaEditionView().getCollection()},uploadMedia:function(e){var t=this;this.areUploadsOngoing()?this.addEventOnce("onMediaUploadsComplete",function(){setTimeout(function(){t.saveMedia(e)},100)}):this.saveMedia(e)},saveMedia:function(e){var t,i,n,o,s,a=new l;if(e&&(n=e.mediaToBeUploaded)&&(i=n.length))for(t=0;t<i;t++)(s=(o=n[t]).getCustomProperty("changesToBeSaved"))&&(o.addChanges(s),o.deleteCustomProperty("changesToBeSaved"));a(e)},addMedia:function(){},destroy:function(){this._context.removeListener("onCommunityChange",this.onCommunityChange)},onCommunityChange:function(){this._context&&(this._context.communityId||this._context.dmId)&&this.resetContent()},setup:function(){return this._context=c.getInstance(),this._context.removeListener("onCommunityChange",this.onCommunityChange),this.onCommunityChange=this.onCommunityChange.bind(this),this._context.addListener("onCommunityChange",this.onCommunityChange,this,!0),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/media/view/media-summary-view",["UWA/Core","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUIComponents/script/feature/community/content/view/content-summary-view"],function(e,t,i){"use strict";return i.extend({_modelClass:t,name:"media-summary-view"})}),define("DS/SwymUIComponents/script/feature/community/media/view/media-summary-view-light",["UWA/Core","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUIComponents/script/feature/community/media/view/media-summary-view"],function(e,t,i){"use strict";return i.extend({_modelClass:t,name:"media-summary-view-light",getMediaThumbnailContainerMaxHeight:function(){return 250},_createContent:function(){return{tag:"div",html:[this._createThumbnail(),this._getIconElement(),this._createActionMenu()]}}})}),define("DS/SwymUIComponents/script/feature/community/community/view/community-feature-settings-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-feature-settings-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/UIKIT/Input/Toggle","DS/UIKIT/Input/Select","DS/WebappsUtils/Console","DS/SwymUIComponents/script/utils/feature-activation-manager"],function(e,t,i,n,o,s,a,r,l){"use strict";const c=l.isBetaFeatureActivated("rdv"),d=l.isFeatureActivated("activateWedo");var m=function(e,t){var i;return(i=e.getChanges(t))||(i=e.get(t)),i};return i.extend({_modelClass:n,attributes:{tag:"div"},onAcceptChange:function(e){var t;(t=this.getElement(".featureContainer"))&&this.acceptStatement.isChecked()&&t.show(),(e.target||e.srcElement).checked?this.dispatchEvent("enableSave"):this.dispatchEvent("disableSave")},onFeatureToggle:function(e){var t=this.view,i=t.model,n=this.toggle;n===t.ideaFeatureToggle?n.isChecked()?(this.view.dispatchEvent("ideaFeatureToggle",!0),i.addChanges({ideation_is_enabled:!0,ideation_min_acl:2},{force:!0}),!1!==e&&(t.ideaCreationChkBox.enable(),t.ideaCreationChkBox.uncheck())):(this.view.dispatchEvent("ideaFeatureToggle",!1),i.addChanges({ideation_is_enabled:!1,ideation_min_acl:2},{force:!0}),!1!==e&&(t.ideaCreationChkBox.uncheck(),t.ideaCreationChkBox.disable())):n===t.surveyFeatureToggle?n.isChecked()?(i.addChanges({survey_is_enabled:!0,survey_min_acl:2},{force:!0}),!1!==e&&(t.surveyCreationChkBox.enable(),t.surveyCreationChkBox.uncheck())):(i.addChanges({survey_is_enabled:!1,survey_min_acl:2},{force:!0}),!1!==e&&(t.surveyCreationChkBox.uncheck(),t.surveyCreationChkBox.disable())):t.wedoFeatureToggle&&n===t.wedoFeatureToggle?n.isChecked()?(i.addChanges({wedo_is_enabled:!0,wedo_min_acl:2},{force:!0}),!1!==e&&(t.wedoCreationChkBox.enable(),t.wedoCreationChkBox.uncheck())):(i.addChanges({wedo_is_enabled:!1,wedo_min_acl:2},{force:!0}),!1!==e&&(t.wedoCreationChkBox.uncheck(),t.wedoCreationChkBox.disable())):t.conferenceFeatureToggle&&n===t.conferenceFeatureToggle?n.isChecked()?(i.addChanges({conference_is_enabled:!0,conference_min_acl:2},{force:!0}),!1!==e&&(t.conferenceCreationChkBox.enable(),t.conferenceCreationChkBox.uncheck())):(i.addChanges({conference_is_enabled:!1,conference_min_acl:2},{force:!0}),!1!==e&&(t.conferenceCreationChkBox.uncheck(),t.conferenceCreationChkBox.disable())):n===t.iQFeatureToggle?n.isChecked()?(i.addChanges({qna_is_enabled:!0,qna_min_acl:2},{force:!0}),!1!==e&&(t.iQCreationChkBox.enable(),t.iQCreationChkBox.uncheck())):(i.addChanges({qna_is_enabled:!1,qna_min_acl:2},{force:!0}),!1!==e&&(t.iQCreationChkBox.uncheck(),t.iQCreationChkBox.disable())):n===t.wikiFeatureToggle?n.isChecked()?(i.addChanges({wiki_is_enabled:!0,wiki_min_acl:2},{force:!0}),!1!==e&&(t.wikiCreationChkBox.enable(),t.wikiCreationChkBox.uncheck())):(i.addChanges({wiki_is_enabled:!1,wiki_min_acl:2},{force:!0}),!1!==e&&(t.wikiCreationChkBox.uncheck(),t.wikiCreationChkBox.disable())):n===t.messageFeatureToggle&&i.addChanges({instant_message_is_enabled:n.isChecked()},{force:!0})},onFeatureCreationToggle:function(){var e=this.view,t=e.model,i=this.toggle;i===e.postCreationChkBox?i.isChecked()?t.addChanges({post_min_acl:1},{force:!0}):t.addChanges({post_min_acl:2},{force:!0}):i===e.ideaCreationChkBox?i.isChecked()?t.addChanges({ideation_min_acl:1},{force:!0}):t.addChanges({ideation_min_acl:2},{force:!0}):i===e.surveyCreationChkBox?i.isChecked()?t.addChanges({survey_min_acl:1},{force:!0}):t.addChanges({survey_min_acl:2},{force:!0}):e.wedoCreationChkBox&&i===e.wedoCreationChkBox?i.isChecked()?t.addChanges({wedo_min_acl:1},{force:!0}):t.addChanges({wedo_min_acl:2},{force:!0}):e.conferenceCreationChkBox&&i===e.conferenceCreationChkBox?i.isChecked()?t.addChanges({conference_min_acl:1},{force:!0}):t.addChanges({conference_min_acl:2},{force:!0}):i===e.iQCreationChkBox?i.isChecked()?t.addChanges({qna_min_acl:1},{force:!0}):t.addChanges({qna_min_acl:2},{force:!0}):i===e.wikiCreationChkBox&&(i.isChecked()?t.addChanges({wiki_min_acl:1},{force:!0}):t.addChanges({wiki_min_acl:2},{force:!0}))},_createContent:function(){for(var i=this.model,n=m(i,"wiki_is_enabled"),r=parseInt(m(i,"wiki_min_acl"),10),l=m(i,"ideation_is_enabled"),u=parseInt(m(i,"ideation_min_acl"),10),h=m(i,"survey_is_enabled"),p=parseInt(m(i,"survey_min_acl"),10),g=m(i,"wedo_is_enabled"),w=parseInt(m(i,"wedo_min_acl"),10),C=m(i,"conference_is_enabled"),f=parseInt(m(i,"conference_min_acl"),10),y=parseInt(m(i,"post_min_acl"),10),v=m(i,"qna_is_enabled"),A=parseInt(m(i,"qna_min_acl"),10),_=m(i,"instant_message_is_enabled"),S=parseInt(m(i,"stats_min_acl"),10),b=[],I=1,D="",T=i.isIdeationContributorCreationEnabledInSettings(l,u),E=i.isSurveyContributorCreationEnabledInSettings(h,p),U=i.isWedoContributorCreationEnabledInSettings(g,w),k=i.isConferenceContributorCreationEnabledInSettings(C,f),x=i.isContributorCreationEnabledInSettings(!0,y),M=i.isContributorCreationEnabledInSettings(v,A),V=i.isContributorCreationEnabledInSettings(n,r);I<=4;){switch(I){case 4:D=t.Disabled;break;case 3:D=t.Owners;break;case 2:D=t.OwnersAndAuthors;break;case 1:D=t.All}S===I?b.push({value:I,selected:!0,label:D}):b.push({value:I,label:D}),I++}var P=e.createElement("div",{html:[{tag:"h5",html:t.Communityfeatures},{tag:"div",class:"msgContainer",styles:{display:"none"},html:{tag:"div",class:"msgBody bg-error",html:[{tag:"p",html:t.IncompatibilityMessage},this.acceptStatement=new s({type:"checkbox",label:t.AcceptStatement,events:{onChange:this.onAcceptChange.bind(this)}})]}},{class:"featureContainer",styles:{},html:[{class:"feature",html:[this.postFeatureToggle=new s({className:"inline feature-toggle",checked:!0,disabled:!0,type:"switch",label:t.Post}),this.postCreationChkBox=new s({className:"inline primary feature-toggle",type:"checkbox",checked:x,disabled:!1,label:t.Allowcontributortocreate})]},{class:"feature",html:[this.iQFeatureToggle=new s({className:"inline feature-toggle",checked:v,type:"switch",label:t.iQuestions}),this.iQCreationChkBox=new s({className:"inline primary feature-toggle",type:"checkbox",checked:M,disabled:!v,label:t.Allowcontributortocreate})]},{tag:"div",class:"feature",html:[this.ideaFeatureToggle=new s({className:"inline feature-toggle",checked:l,type:"switch",label:t.Ideas}),this.ideaCreationChkBox=new s({className:"inline primary feature-toggle",type:"checkbox",checked:T,disabled:!l,label:t.Allowcontributortocreate})]},{class:"feature",html:[this.surveyFeatureToggle=new s({className:"inline feature-toggle",checked:h,type:"switch",label:t.Surveys}),this.surveyCreationChkBox=new s({className:"inline primary feature-toggle",type:"checkbox",checked:E,disabled:!h,label:t.Allowcontributortocreate})]},o.getInstance().isFeatureActivated("active_wiki")?{tag:"div",class:"feature",html:[this.wikiFeatureToggle=new s({className:"inline feature-toggle",checked:n,type:"switch",label:t.Wiki}),this.wikiCreationChkBox=new s({className:"inline primary feature-toggle",type:"checkbox",checked:V,disabled:!n,label:t.Allowcontributortocreate})]}:"",d?{class:"feature",html:[this.wedoFeatureToggle=new s({className:"inline feature-toggle",checked:g,type:"switch",label:t.Wedo}),this.wedoCreationChkBox=new s({className:"inline primary feature-toggle",type:"checkbox",checked:U,disabled:!g,label:t.Allowcontributortocreate})]}:"",c?{class:"feature",html:[this.conferenceFeatureToggle=new s({className:"inline feature-toggle",checked:C,type:"switch",label:t.Conference}),this.conferenceCreationChkBox=new s({className:"inline primary feature-toggle",type:"checkbox",checked:k,disabled:!C,label:t.Allowcontributortocreate})]}:"",window.ds&&!0===window.ds.swymIM&&this._widget&&!0===this._widget.getBool("showIMSetting")?{class:"feature",html:[this.messageFeatureToggle=new s({className:"inline feature-toggle",checked:_,type:"switch",label:t.Messages})]}:"",o.getInstance().isFeatureActivated("activate_community_stats_panel_access")?{tag:"div",class:"feature",html:[{tag:"div",styles:{"vertical-align":"bottom"},class:"feature-title",html:t.StatisticsAvailableFor},new a({name:"stats",className:"feature-select",placeholder:!1,options:b,events:{onChange:function(e){var t,i=this.model;e&&e.target&&(t=e.target.value)&&i.addChanges("stats_min_acl",t)}.bind(this)}})]}:""]}]});return this.ideaFeatureToggle.addEvent("onChange",this.onFeatureToggle.bind({view:this,toggle:this.ideaFeatureToggle})),this.surveyFeatureToggle.addEvent("onChange",this.onFeatureToggle.bind({view:this,toggle:this.surveyFeatureToggle})),this.wedoFeatureToggle&&this.wedoFeatureToggle.addEvent("onChange",this.onFeatureToggle.bind({view:this,toggle:this.wedoFeatureToggle})),this.conferenceFeatureToggle&&this.conferenceFeatureToggle.addEvent("onChange",this.onFeatureToggle.bind({view:this,toggle:this.conferenceFeatureToggle})),this.iQFeatureToggle.addEvent("onChange",this.onFeatureToggle.bind({view:this,toggle:this.iQFeatureToggle})),this.messageFeatureToggle&&this.messageFeatureToggle.addEvent("onChange",this.onFeatureToggle.bind({view:this,toggle:this.messageFeatureToggle})),o.getInstance().isFeatureActivated("active_wiki")&&(this.wikiFeatureToggle.addEvent("onChange",this.onFeatureToggle.bind({view:this,toggle:this.wikiFeatureToggle})),this.wikiCreationChkBox.addEvent("onChange",this.onFeatureCreationToggle.bind({view:this,toggle:this.wikiCreationChkBox}))),this.postCreationChkBox.addEvent("onChange",this.onFeatureCreationToggle.bind({view:this,toggle:this.postCreationChkBox})),this.ideaCreationChkBox.addEvent("onChange",this.onFeatureCreationToggle.bind({view:this,toggle:this.ideaCreationChkBox})),this.surveyCreationChkBox.addEvent("onChange",this.onFeatureCreationToggle.bind({view:this,toggle:this.surveyCreationChkBox})),this.wedoCreationChkBox&&this.wedoCreationChkBox.addEvent("onChange",this.onFeatureCreationToggle.bind({view:this,toggle:this.wedoCreationChkBox})),this.conferenceCreationChkBox&&this.conferenceCreationChkBox.addEvent("onChange",this.onFeatureCreationToggle.bind({view:this,toggle:this.conferenceCreationChkBox})),this.iQCreationChkBox.addEvent("onChange",this.onFeatureCreationToggle.bind({view:this,toggle:this.iQCreationChkBox})),P}})}),define("DS/SwymUIComponents/script/feature/community/media/view/smart-lightbox-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/view/interactive-media-thumbnail-view","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/utils/utils","DS/UIKIT/Tooltip","DS/Logger/Logger","DS/SwymUIComponents/script/feature/community/media/view/abstract-lightbox-view"],function(e,t,i,n,o,s,a,r,l){"use strict";return l.extend({name:"lightbox-media-view",_isAutoplayActivated:!0,_shouldBeDestroyed:!0,_displayArrows:!1,domEvents:{"click .thumbnail-previous":"_goToPreviousMedia","click .thumbnail-next":"_goToNextMedia","click .thumbnail-previous-next":"_goToNextMediaIfPicture","click .title .text":"_goToDetailedViewMedia","click .play-360-experience":"_play360Experience","click .fonticon-download":"_downloadMedia",click:"_destroy"},_play360Experience:function(){var e=this.getChildView("interactive-thumbnail");e&&e.play();var t=this.getElement(".play-360-experience");t&&t.destroy()},_downloadMedia:function(){var e=this.getChildView("interactive-thumbnail");e&&e.download()},_goToDetailedViewMedia:function(){r.log("go to detailed media");var e=this.model,t=window.widget||this._widget;if(!(window.ds&&"3DSwym"===window.ds.env)&&t&&t.getAppName()!==s.getMyCommunitiesAppKey())require(["DS/SwymUICore/script/utils/navigation"],function(t){t.showTransientWidget(s.getMyCommunitiesAppKey(),"",{community:e.getCommunity().get("mid"),contentId:e.get("mid"),contentType:e.getModelName(),url:s.getBaseUrl()})});else{this._context=n.getInstance();var i={contentId:e.get("mid"),contentType:e.getModelName()};"dm"===e.get("community").community_type?i.dmId=e.get("community").mid:i.communityId=e.get("community").mid,this._context.reset(i)}this.destroy()},_destroy:function(e){r.log("in the destroy"),!0!==this._shouldBeDestroyed||e.target.hasClassName("thumbnail-previous-next")||e.target.hasClassName("play-360-experience")||e.target.hasClassName("fonticon-download")||e.target.hasClassName("text")||(this._touch&&this._touch.destroy(),this.destroy()),this._shouldBeDestroyed=!0},_goToNextMediaIfPicture:function(e){"picture"===this.model.get("media_type")&&this._goToNextMedia(e)},_goToNextMedia:function(t,i){var n,o;if(r.log("go to next media"),this._shouldBeDestroyed=!1,this._isAutoplayActivated=!1,(n=e.is(i,"number")?i:this.collection.indexOf(this.model))<this.collection.length-1){if(!0===(o=this.collection.at(n+1)).get("_deleted"))return this._goToNextMedia(t,n+1);this.setModel(o)}else r.log("we loop; we should go to the first media of the list"),this.setModel(this.collection._models[0])},_goToPreviousMedia:function(t,i){var n,o;if(r.log("go to previous media"),this._shouldBeDestroyed=!1,this._isAutoplayActivated=!1,(n=e.is(i,"number")?i:this.collection.indexOf(this.model))>0){if(!0===(o=this.collection.at(n-1)).get("_deleted"))return this._goToPreviousMedia(t,n-1);this.setModel(o)}else r.log("we loop; we should go to the last media of the list"),this.setModel(this.collection._models[this.collection.length-1])},onSetModel:function(e,t,i){this._touch&&"3d_model"!==i.get("media_type")&&this._touch.set({enable:!0})},_mediaCollection:null,setup:function(t){return void 0!==t.isAutoplayActivated&&(this._isAutoplayActivated=t.isAutoplayActivated),this.model.isConsideredAsA360MediaModel()&&(this._isAutoplayActivated=!1),this.imageReloadOptions={size:"xl"},t.collection&&(this._mediaCollection=t.collection),e.Utils.Client.Features.touchEvents&&this.collection&&this.collection.length>1&&require(["DS/UIKIT/Touch"],function(e){this._touch=e(this.container,{drag:!1,transform:!1}),this._touch.on("swipeleft",function(){this._goToNextMedia()}.bind(this)),this._touch.on("swiperight",function(){this._goToPreviousMedia()}.bind(this))}.bind(this)),this._parent.apply(this,arguments)},getContentView:function(){return this.collection&&this.collection.length>1&&(this._displayArrows=!0),this.addChildView("interactive-thumbnail",{Class:"DS/SwymUIComponents/script/feature/community/media/view/interactive-media-thumbnail-view",model:this.model,forcePlayInContext:!0,autoplay:this._isAutoplayActivated,displayNext:this._displayArrows,displayPrevious:this._displayArrows,delegateSpriteReloadToParentView:!1,events:{onMediaReady:function(){this._touch&&"3d_model"===this.model.get("media_type")&&this._touch.set({enable:!1})}.bind(this)}})},removeContentView:function(){this.removeChildView("interactive-thumbnail")}})}),define("DS/SwymUIComponents/script/feature/community/media/view/simple-content-media-view",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/community/media/view/media-zone-view","DS/SwymUIComponents/script/feature/community/content/utils/content-media-renderer","DS/SwymUIComponents/script/feature/community/media/view/smart-lightbox-view","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/lib/event-manager","DS/SwymUICore/script/utils/navigation"],function(e,t,i,n,o,s,a,r,l){"use strict";return i.extend({name:"content-media-display-manager",_mediaRenderer:null,_mediaCollection:null,_modelEvents:{"onSync:update":"onModelUpdate"},_modelClass:t,defaultOptions:{contentAttributeInModel:"content"},setup:function(e){this._parent.apply(this,arguments),this.setupMedia(),e.contentModelSubjectUriOrId&&this.setOption("contentModelSubjectUriOrId",e.contentModelSubjectUriOrId)},onModelUpdate:function(){var e,t;this._mediaRenderer&&(t=this._mediaRenderer.process(this.model.get(this.getOption("contentAttributeInModel")),{createMediaView:!1,toReturn:{mediaCollection:!0}})||{},this._mediaCollection=t.mediaCollection,(e=this.getChildView("media-zone"))&&(this._mediaCollection?e.setCollection(this._mediaCollection):this.destroy()))},setupMedia:function(){var e,t,i;this._mediaRenderer=o.getInstance(),e=this.model.get(this.getOption("contentAttributeInModel")),i=this._mediaRenderer.process(e,{createMediaView:!1,toReturn:{mediaCollection:!0}}),this._mediaCollection=i?i.mediaCollection:null,t=this._mediaCollection&&this._mediaCollection.length>0?this.addChildView("media-zone",{Class:n,collection:this._mediaCollection}):this.addChildView("media-zone",{Class:n,collection:new a}),this.listenTo(t,"onOpenInViewerRequest",this.onOpenInViewerRequest)},_createContent:function(){return this.getChildView("media-zone")},getMediaZoneView:function(){return this.getChildView("media-zone")},onOpenInViewerRequest:function(e){var t,i,n,o;arguments[1]._shouldActivateAutoplay;"question-survey"===this.model.getModelName()?(i=e.getCommunity(),n=this.model.get("pollId"),o=this.model.getModelName().split("-")[1]):"iq-answer"===this.model.getModelName()?(n=(t=this.model.getAssociated("answeredFor")).get("mid"),o=t.getModelName(),i=this.model.getCommunity()):"community-event"===this.model.getModelName()?(n=this.model.get("message_details").subject_id,o=this.model.get("message_details").subject_model.toLowerCase(),i=this.model.getCommunity()):"comment"===this.model.getModelName()&&("instant-comment"===this.model.getAssociated("commented").getModelName()?(n=this.model.getAssociated("commented").get("subject_id"),o=this.model.getAssociated("commented").get("subject_model").toLowerCase(),i=this.model.getAssociated("commented").getCommunity()):"iq-answer"===this.model.getAssociated("commented").getModelName()?(n=(t=this.model.getAssociated("commented").getAssociated("answeredFor")).get("mid"),o=t.getModelName(),i=t.getCommunity()):(n=(t=this.model.getAssociated("commented")).get("mid"),o=t.getModelName(),i=t.getCommunity())),l.goToContent(n,o,i.get("mid"),!1,void 0,void 0,"dm"===i.get("community_type"),{mediaId:e.get("mid")})},onDestroy:function(){this.stopListening(this.getChildView("media-zone"))}})}),define("DS/SwymUIComponents/script/feature/community/content/social-interactions/patched-social-toolbar/patched-comment-view",["UWA/Core","DS/SocialToolbar/Views/CommentView","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUIComponents/script/feature/community/content/social-interactions/patched-social-toolbar/patched-st-utils","i18n!DS/SwymUIComponents/assets/nls/feature/community/comment/view/comment-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/comment/view/comment-editor-view","DS/SwymUIComponents/script/feature/community/media/view/simple-content-media-view","DS/SwymUIComponents/script/feature/community/content/utils/content-renderer","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/rich-link-preview-generator","DS/Logger/Logger","DS/SwymUICore/script/feature/community/comment/model/comment-model"],function(e,t,i,n,o,s,a,r,l,c,d,m){"use strict";var u=i.getInstance(),h=n.getInstance(),p=function(){return e.createElement("div",{html:y.apply(this,arguments)}).getElement("div[data-idea-status-id]")},g=function(){var e=this.model,t=e?e.get("subjectUri"):"";return e&&(!t||t.indexOf("swym")>-1)&&e.getAuthor().get("login")!==u.get("user").login&&u.isFeatureActivated("activate_report_abuse_request")&&!this.getOption("instantMessageModel")},w=t.prototype._hasUserEditionRight;t.prototype._hasUserEditionRight=function(){return!p.apply(this,arguments)&&w.apply(this,arguments)},t.prototype._renderUserPicture=function(){return o.renderUserPicture.apply(this,arguments)},t.prototype._shouldActionMenuBeCreated=function(){return!(!1===this._hasUserEditionRight()&&!g.call(this)||this.model.getAuthor().get("login")!==u.get("user").login&&h.isDirectMessageContext())};var C=t.prototype._shouldFooterBeShown;t.prototype._shouldFooterBeShown=function(){return!p.apply(this,arguments)&&C.apply(this,arguments)};var f=t.prototype._createDropDownMenu;t.prototype._createDropDownMenu=function(){var e=this;f.apply(this,arguments),g.call(this)&&this.components.get("dropdownMenu").addItem({name:"reportAbuse",text:s.ReportAbuse,fonticon:"flag",handler:function(){require(["DS/SwymUIComponents/script/feature/community/report-abuse/view/report-new-abuse-view","DS/SwymUICore/script/feature/community/iquestion/model/iqa-comment-model","DS/SwymUICore/script/feature/community/report-abuse/model/report-abuse-model-v2"],function(t,i,n){var o,s,a,r={comment:y.apply(e),subject6wuri:e.model.get("commentUri"),parentCommentUri:e.model.get("parentCommentUri")},l="",c=new n,d=e.model.getSubject().getSharedOptions().getOption("swymOptions");switch(o=(a="iq-answer"===d.model.getModelName()?d.model.getAssociated("answeredFor"):d.model).getModelName()){case"post":l="community_post_id";break;case"media":l="media_id";break;case"iquestion":l="iquestion_id";break;case"idea":l="ideation_id";break;case"wiki":l="wikitree_id"}r[l]=a.get("mid"),(s="iq-answer"===d.model.getModelName()?new i(r,{commentType:o}):new m(r,{commentType:o})).setAssociated("commented",d.model),new t({model:c,reportedModel:s}).render(window.document.body||d.widget.body).show()})}})};var y=t.prototype._getMessageToDisplay;t.prototype._getMessageToDisplay=function(){var t,i,n,o=y.apply(this,arguments),a=p.apply(this,arguments),r="",m="",u="",h=(this.model||this.collection).getSubject().getSharedOptions().getOption("swymOptions");return a?(t=a.getAttribute("data-idea-status-id"),e.is(t)&&(n=h.model.getIdeaType().getStatusCollection(),this.listenTo(n,"onSync",this.updateMainSection),n&&n.length>0&&((i=n.findWhere({mid:t}))?(r=i.get("color"),m=i.get("title")):d.error("Idea status could not be found in status list!"),u=e.createElement("div",{html:[t&&m?{tag:"p",class:"status",html:[{tag:"span",html:s.StatusChangeTo+" "},{tag:"strong",class:"idea-status-comment",styles:{"background-color":r},html:m}]}:"-1"===t?{tag:"p",class:"status",html:[{tag:"span",html:s.StatusOut}]}:"",{html:a.getHTML()}]})))):u=l.getInstance().render(o,{createMediaView:!1}),u=c.createPreviewFromLink(u,!1,!1)};var v=t.prototype._getMediaListToDisplay;t.prototype._getMediaListToDisplay=function(){var e=v.apply(this,arguments),t=function(e){var t,i,n={},o=(this.model||this.collection).getSubject().getSharedOptions().getOption("swymOptions");return o&&(n[o.commentTextAttribute]=e,(t=new o.commentModelClass(n,{commentType:o.model.getModelName()})).setAssociated(o.commentAssociationToParentModel,o.model),i=this.components.addMap({contentMediaDisplayManager:new r({model:t,contentAttributeInModel:o.contentAttributeInModel,widget:o.widget,contentModelSubjectUriOrId:this.model.get("subjectUri")})}).contentMediaDisplayManager),i}.call(this,y.apply(this,arguments));return[e,t?t.render().container:""]}}),define("DS/SwymUIComponents/script/feature/community/question/view/validated-answers-view",["UWA/Core","DS/SwymUICore/script/feature/community/iquestion/model/iq-answer-model","DS/SwymUICore/script/feature/community/iquestion/collection/iq-answer-collection","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUIComponents/script/feature/core/user/view/user-picture-view","DS/SwymUIComponents/script/feature/community/media/view/simple-content-media-view","DS/SwymUIComponents/script/feature/community/content/utils/content-renderer","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/rich-link-preview-generator","DS/SwymUICore/script/utils/date","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/view/abstract-content-view","DS/SwymUIComponents/script/feature/community/question/question-view-mixin"],function(e,t,i,n,o,s,a,r,l,c,d,m){"use strict";var u=n.extend({_modelClass:t,className:"validated-answer-section",name:"validated-answer-view",setup:function(){this._parent.apply(this,arguments),this._contentRenderer=r.getInstance()},renderContent:function(){var e=this.model.get("answer");return e=this._contentRenderer.render(e,{createMediaView:!1}),e=l.createPreviewFromLink(e,!1,!1)},getContentMediaView:function(){var e=this.getChildView("content-media-display-manager");return e||(e=this.addChildView("content-media-display-manager",new a({model:this.model,contentAttributeInModel:"answer",contentModelSubjectUriOrId:this.model.get("iquestion_id")}))),e},_createContent:function(){var e=this.model,t=e.getAuthor(),i=this.renderContent(),n=this.getContentMediaView(),o=e.getAssociated("answeredFor");return[{tag:"div","data-content-id":o.get("mid"),"data-content-type":o.getModelName(),"data-community-id":o.get("community->mid"),class:"validated-answer answer-summary",html:[i,n]},{class:"answer-author-section",html:[this.addChildView("userPicture",{tagName:"span",Class:s,model:t,imageRenderingOptions:{format:"normal"}}),{tag:"span",class:"link","data-content-type":"person","data-hash-key":t.get("hash_key"),"data-login":t.get("login"),html:t.getNickname()},{tag:"span",class:"content-detail",html:d.by},{tag:"span",class:"content-detail",html:"-"},{tag:"span",class:"content-detail activity-date",html:c.prettyDate(e.get("pubdate"))}]}]}});return o.extend({_collectionClass:i,modelViewClass:u}).extend(m)}),define("DS/SwymUIComponents/script/feature/community/content/social-interactions/comment-view",["UWA/Core","UWA/String","i18n!DS/SwymUIComponents/assets/nls/feature/community/comment/view/comment-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/question/view/iq-answer-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/view/abstract-content-view","DS/SwymUICore/script/utils/i18n","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/core/user/view/user-picture-view","DS/SwymUIComponents/script/feature/community/report-abuse/view/report-new-abuse-view","DS/SwymUIComponents/script/feature/community/media/view/simple-content-media-view","DS/SwymUIComponents/script/feature/community/content/utils/content-renderer","DS/SwymUICore/script/feature/community/comment/model/comment-model","DS/SwymUICore/script/feature/community/idea/model/idea-model","DS/SwymUICore/script/utils/date","DS/SwymUICore/script/feature/community/report-abuse/model/report-abuse-model-v2","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUIComponents/script/utils/content-process","DS/SwymUIComponents/script/feature/community/content/social-interactions/edit/comment-editor-view","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUIComponents/script/feature/core/modal/super-modal","DS/UIKIT/DropdownMenu","DS/UIKIT/Tooltip"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w,C,f,y,v,A){"use strict";return a.extend({_modelClass:m,_modelEventsForAutoRefresh:["onSync"],_modelEvents:{"onChange:mid":"_updateActionDropdownMenu","onChange:update":"_updateModerationDate"},_contentModelAssociation:"commented",_contentAttributeInModel:"comment",_contentCounter:"nb_comments",_showSummary:!0,_contentRenderer:null,name:"comment-view",attributes:{tag:"li"},domEvents:{"keydown .edit":"_onKeydown","click .comment > .content > .content-message":"_exitSummaryMode","click .content-message":"_exitSummaryMode",resize:"_checkMessageHeight"},defaultOptions:{editorViewClass:C},commentExpanded:!1,_updateShowSummaryProperty:function(e){this._showSummary=!0===e,this._handleSummaryMode()},_handleSummaryMode:function(){this.container&&(!0===this._showSummary?this.container.addClassName("summary-mode"):this.container.removeClassName("summary-mode"))},_exitSummaryMode:function(){this._showSummary&&(this.commentExpanded=!0,this._updateShowSummaryProperty(!1))},_checkMessageHeight:function(){this.container&&(this._showSummary&&this.elements&&this.elements.contentMessage&&this.elements.contentMessage.scrollHeight>Math.ceil(parseFloat(this.elements.contentMessage.clientHeight))?this.container.addClassName("overflowing-content"):this.container.removeClassName("overflowing-content"))},setup:function(){this._parent.apply(this,arguments),this._handleSummaryMode(),this._contentRenderer=d.getInstance()},_updateModerationDate:function(){var e=this.getControl("moderation-status-tooltip"),t=this.model;e&&e.setBody(s.replace(this._getModerationTextTooltip(),{prettyDate:h.prettyDate(t.get("moderation_date"))}))},renderContentSummary:function(e){var t,i=this.model,n=e||i.get(this._contentAttributeInModel),o=f.getInstance(),s=this._contentRenderer.render(n,{createMediaView:!1});return!o.isHomePageContext()&&!o.isCommunityHomePageContext()||this._parentView._showPreviousComments||this.commentExpanded||!n?(t=!1,this.commentExpanded=!0):t=!0,this._updateShowSummaryProperty(t),s&&"function"==typeof s.getHTML?s.getHTML():s},renderContent:function(e){var t=this.model,i=e||t.get(this._contentAttributeInModel);return i=this._contentRenderer.render(i,{createMediaView:!1})},getContentMediaView:function(){var e=this.getChildView("content-media-display-manager");return e||(e=this.addChildView("content-media-display-manager",new c({model:this.model,contentAttributeInModel:this._contentAttributeInModel,contentModelSubjectUriOrId:this.model.get("iquestion_id")}))),e},_getModerationText:function(){var e=this.model,t="";switch(e.get("moderation_status")){case"no_moderation":break;case"updated":t=h.prettyDate(e.get("crdate"))+' - <span class="moderation-status">'+i.Moderatedbytheadministrator+"</span>";break;case"deleted":commentHtml=commentSummary="",t="iq-answer"===e.getModelName()?n.Thisanswerwasdeletedbythadministratore+" - "+h.prettyDate(e.get("update")):i.Thiscommentwasdeletedbytheadministrator+" - "+h.prettyDate(e.get("update"));break;case"updated_by_author":t=h.prettyDate(e.get("crdate"))+' - <span class="moderation-status">'+i.Edited+"</span>";break;case"deleted_by_author":commentHtml=commentSummary="",t="iq-answer"===e.getModelName()?n.Thisanswerwasdeletedby+" - "+e.getAssociated("author").getNickname()+" - "+h.prettyDate(e.get("update")):i.Thiscommentwasdeletedby+" - "+e.getAssociated("author").getNickname()+" - "+h.prettyDate(e.get("update"))}return t},_getModerationTextTooltip:function(){var e="";switch(this.model.get("moderation_status")){case"updated":e=o.ModeratedTooltip;break;case"updated_by_author":e=o.EditedTooltip}return e},_createContent:function(){var t,n,a,l,c,d,m,p,w=this._getModerationText(),C=this._getModerationTextTooltip(),f=null,y=null,_=this.model,S=_.getAuthor(),b=this.renderContent(),I=this.renderContentSummary(),D=this.getContentMediaView(),T=[];if(_){if(t=_.get("status_id"),e.is(t)&&_.hasAssociation("commented")){var E=new u({mid:_.get("ideation_id")}),U=E.getStatus();if(t===U.get("mid")&&U.get("title")&&U.get("color"))f=U.get("color"),y=U.get("title");else{if(this._statusCollection||(this._statusCollection=E.getIdeaType().getStatusCollection()),m=this._statusCollection.length,this.reactTo(this._statusCollection,"onSync","refresh"),!(this._statusCollection&&m>0))return;for(var k=0;k<m;k++)this._statusCollection.at(k).get("mid")===t&&(f=this._statusCollection.at(k).get("color"),y=this._statusCollection.at(k).get("title"))}}l=_.get("moderation_status"),(c=e.createElement("span",{html:" - "+w})).getElement(".moderation-status")&&this.addControl("moderation-status-tooltip",new A({target:c.getElement(".moderation-status"),body:s.replace(C,{prettyDate:h.prettyDate(_.get("moderation_date"))}),position:"bottom"})),n="deleted"!==l&&"deleted_by_author"!==l&&!t&&_.get("_acl").update.access,a="deleted"!==l&&"deleted_by_author"!==l&&!t&&_.get("_acl").delete.access,n&&T.push({text:i.Edit,fonticon:"pencil",name:"edit"}),a&&T.push({text:i.Delete,fonticon:"trash",name:"delete"}),"deleted_by_author"!==l&&!S.isCurrentUser()&&g.getInstance().isFeatureActivated("activate_report_abuse_request")&&T.push({text:i.ReportAbuse,fonticon:"flag",name:"reportabuse"}),p=e.createElement("div",{class:"menu-button",html:T.length>0?{tag:"span",class:"fonticon fonticon-down-open"}:""}),this.addControl("actionDropdownMenu",new v({target:p,items:T,events:{onClick:function(e,t){"edit"===t.name?this._edit():"delete"===t.name?this._askDeleteConfirmation():"reportabuse"===t.name&&this._reportAbuse()}.bind(this)}}));let x=!1;return(d=this._showSummary?I:b)&&(x=d.length>140),this.elements.contentMessage=e.createElement("div",{class:"content-message"+(x?" add-see-more":""),html:[{class:"content-message-body",html:d},{class:"seeMore",html:"... <span>"+o.SeeMore+"</span>"}]}),e.createElement("div",{class:"comment"+(t?" comment-idea-status":""),html:[this.addChildView("userPicture",{model:S,Class:r,imageRenderingOptions:{format:"normal"}}),{class:"comment-main-body",html:[{class:"infos",html:[{tag:"a","data-content-type":"person","data-hash-key":S.get("hash_key")||"","data-login":S.get("login")||"",html:S.getNickname()},w?c:"",w?"":{tag:"span",html:" - "+h.prettyDate(_.get("crdate"))}]},{class:"content",html:[t&&y?{tag:"p",class:"status",html:[{tag:"span",html:i.StatusChangeTo+" "},{tag:"strong",class:"idea-status-comment",styles:{"background-color":f},html:y}]}:"-1"===t?{tag:"p",class:"status",html:[{tag:"span",html:i.StatusOut}]}:"",this.elements.contentMessage,D]},S.isCurrentUser()||n?{class:"edit",html:this.getChildView("commentsEditorView")||this.addChildView("commentsEditorView",{Class:"DS/SwymUICore/script/lib/view/generic/swym-view"})}:""]},p]})}},getCommentsEditorView:function(){var t=this,i=this.getChildView("commentsEditorView");return i instanceof C||(i=this.addChildView("commentsEditorView",e.extend({itemModelInstance:this.model,model:this.model.getAssociated(this._contentModelAssociation),Class:this.getOption("editorViewClass"),events:{switchToEditModeRequest:function(){t._edit()}}},this.editorOptions||{}))),i},init:function(){return this._parent.apply(this,arguments)},_askDeleteConfirmation:function(){var e,t=new y({closable:!0,renderTo:this._widget?this._widget.body:document.body});e="iq-answer"===this.model.getModelName()?n.Areyousureyouwanttodeletethisanswer:i.Areyousureyouwanttodeletethiscomment,t.confirm({title:i.Confirm,message:e,callback:function(e){!0===e&&this._remove()}.bind(this)})},_edit:function(){for(var e=this.getElement(".menu-button"),t=this.getElement(".infos"),i=this.getElement(".content"),n=this.getElement(".edit"),o=this.getChildView("userPicture"),s=this.getElement(".content-media-display-manager-container"),a=this.container.getParent(".comment-wrapper").getChildren(".editor-view-container").pop(),r=this._parentView.getElements(".edit"),l=this._parentView.getElements(".infos"),c=this._parentView.getElements(".content"),d=this._parentView.getElements(".menu-button"),m=0;m<r.length;m++)r[m].hide();for(m=0;m<c.length;m++)c[m].show();for(m=0;m<d.length;m++)d[m].show();for(m=0;m<l.length;m++)l[m].show();o&&o.container.addClassName("hidden"),s&&s.hide(),e.hide(),t.hide(),i.hide(),a.hide(),n.show(),this.getCommentsEditorView().editItem(this.model)},_onKeydown:function(e){if(27===e.keyCode){var t=this.getElement(".menu-button"),i=this.getElement(".infos"),n=this.getElement(".content"),o=this.getElement(".edit"),s=this.getChildView("userPicture"),a=this.getElement(".content-media-display-manager-container"),r=this.container.getParent(".comment-wrapper").getChildren(".editor-view-container").pop();this.getCommentsEditorView().cancelItemEditing(),s&&s.container.removeClassName("hidden"),a&&a.hide(),t.show(),i.show(),n.show(),r.show(),o.hide()}},_remove:function(){var e=this.model.getAssociated(this._contentModelAssociation).get(this._contentCounter);this.model.destroy({onComplete:function(){this.model.getAssociated(this._contentModelAssociation).set(this._contentCounter,e-1)}.bind(this),onFailure:function(){}.bind(this)})},_reportAbuse:function(){var e=this.model,t=new p,i=new l({model:t,reportedModel:e}),n=window.document||this._widget;i.render(n.body).show()},_updateActionDropdownMenu:function(){var t=this.getControl("actionDropdownMenu"),i=null;if(e.is(t)&&e.is(t.items))for(i in t.items)t.items.hasOwnProperty(i)&&t.items[i].hasOwnProperty("id")&&t.enableItem(t.items[i].id)},onRedraw:function(){this.getElement(".content")&&w.contentPostProcess(this.getElement(".content"),{imageProcessing:!1})},destroy:function(){this._contentRenderers&&this._contentRenderers.length>0&&this._contentRenderers.forEach(function(e){e.destroy()}),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/content/social-interactions/comment-collection-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/comment/view/comment-view","DS/SwymUICore/script/utils/i18n","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUICore/script/feature/community/comment/collection/comment-collection","DS/SwymUIComponents/script/feature/community/content/social-interactions/comment-view","DS/SwymUIComponents/script/feature/community/content/social-interactions/edit/comment-editor-view"],function(e,t,i,n,o,s,a){"use strict";return n.extend({_collectionClass:o,_editorViewClass:a,_showSubsetOfModelViews:!0,_modelViewsToDisplay:2,_modelViewsByPage:5,_delegateSpriteReloadToParentView:!1,imageReloadOptions:{nonReloadedImagesOnly:!0,optimiseUserPictures:!0},_contentModelAssociation:"commented",_contentCounter:"nb_comments",_showPreviousComments:!1,_collectionEventsForAutoRefresh:["onCollectionChange"],modelName:null,modelViewClass:s,bodyAttributes:{tag:"ol",class:"comments"},modelViewsCfg:function(){return{editorViewClass:this._editorViewClass}},name:"comment-collection-view",hideOnRefresh:!1,domEvents:{"click .show-prev-comments > span":"showPreviousComments"},setup:function(t){var i,n,o,s=t.collection||this.collection;if(e.is(t.modelViewsToDisplay,"number")&&(this._modelViewsToDisplay=t.modelViewsToDisplay),s){var a=this._parent.apply(this,arguments);if(i=s.getAssociated(this._contentModelAssociation)){if("iq-answer"===i.getModelName())o=i.getAssociated("answeredFor").getCommunity();else o=i.getCommunity();n=this.addChildView("commentsEditorView",{model:i,Class:this._editorViewClass,mediaEditionViewInstantiated:!0,communityId:o.get("mid")||o.id}),this.listenTo(n,"newItemCreated",this.onNewItemCreated)}return a}},_beforeRefresh:function(){!0===this.hideOnRefresh&&this.hide()},_afterRefresh:function(){this.show()},_getNlsKeyForPrevComments:function(e){return this.collection instanceof o?i.replace(t.ViewPrevComments,{number:e}):i.replace(t.ViewPrevAnswers,{number:e})},_createContent:function(t){var i=t?e.clone(t,!1):{},n=this.collection,o=parseInt(this._modelViewsToDisplay,10),s=this.model&&"idea"!==this.model.getModelName()?this.model.getNbComments():n.length,a=s-o;return 3===s&&(this._modelViewsToDisplay=3,this._showSubsetOfModelViews=!1),e.extend(i,{modelViewsToDisplay:this._modelViewsToDisplay,showSubsetOfModelViews:this._showSubsetOfModelViews,showPreviousComments:this._showPreviousComments}),{class:"comment-wrapper",html:[!0===this._showSubsetOfModelViews&&a>0?{tag:"div",class:"show-prev-comments",html:[{tag:"span",class:"blue",html:this._getNlsKeyForPrevComments(a>=this._modelViewsByPage?a===this._modelViewsByPage+1?this._modelViewsByPage+1:this._modelViewsByPage:a)}]}:"",this._parent(i),this.getChildView("commentsEditorView")]}},_createModelView:function(){var e=this._parent.apply(this,arguments);return e.addEvent("onAnyEvent",this._onCommentViewEvent,this),e},_onCommentViewEvent:function(e,t,i){if(i&&i instanceof this.modelViewClass)switch(e){case"editCommentButtonClicked":return this.dispatchEvent(e,[t,i])}},showPreviousComments:function(){var e=this.collection,t=parseInt(this._modelViewsToDisplay,10),i=e.length,n=i-t;this._showPreviousComments=!0,n===this._modelViewsByPage+1?this._modelViewsToDisplay=this._modelViewsToDisplay+(this._modelViewsByPage+1):this._modelViewsToDisplay=this._modelViewsToDisplay+this._modelViewsByPage,(n=i-(t=parseInt(this._modelViewsToDisplay,10)))<=0&&(this._showSubsetOfModelViews=!1),e.getAssociated(this._contentModelAssociation).set("_modelViewsToDisplay",t),this.refresh()},onNewItemCreated:function(e){this._showPreviousComments=!0;var t=parseInt(this.collection.getAssociated(this._contentModelAssociation).get(this._contentCounter),10);this.collection.getAssociated(this._contentModelAssociation).set(this._contentCounter,t+1),this._modelViewsToDisplay=parseInt(this._modelViewsToDisplay,10)+1,this.collection.add(e)},focusOnCommentCreator:function(){var t=this.getChildView("commentsEditorView");if(t){var i=t.getRTEView();i.switchedToRTE()?i.placeCursorAt():e.Utils.Client.Platform.ios?i.setFocus():i.switchToRTE(void 0,void 0,void 0,{focus:!0})}}})}),define("DS/SwymUIComponents/script/feature/community/question/social-interactions/social-features-for-question-view",["UWA/Core","DS/SwymUIComponents/script/feature/community/content/social-interactions/social-features-view","DS/SwymUIComponents/script/feature/community/content/social-interactions/social-toolbar-view","DS/SwymUICore/script/feature/community/iquestion/model/iquestion-model","DS/SwymUICore/script/feature/community/iquestion/model/iq-answer-model","DS/SwymUICore/script/feature/community/iquestion/collection/iq-answer-collection","DS/SwymUIComponents/script/feature/community/content/social-interactions/comment-collection-view","DS/SwymUIComponents/script/feature/community/content/social-interactions/comment-view","DS/SwymUIComponents/script/feature/community/content/social-interactions/edit/comment-editor-view","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/utils/utils","DS/SwymUIComponents/script/utils/feature-activation-manager"],function(e,t,i,n,o,s,a,r,l,c,d,m){"use strict";var u=i.extend({_modelClass:n,defaultOptions:{enableComment:!1,enableShare:!1}}),h=i.extend({_modelClass:n,defaultOptions:{enableComment:!1,enableLike:!1}}),p=o.DateField,g=l.extend({name:"sf-answer-creator-view",defaultOptions:{itemModelClass:o,itemTextAttribute:"answer",itemAdditionEvent:"addAnswer",itemAssociationToParentModel:"answeredFor",activateSendButton:m.isFeatureActivated("activateAnswerSendButton")}}),w=r.extend({_modelClass:o,_contentModelAssociation:"answeredFor",_contentAttributeInModel:"answer",_contentCounter:"nb_answers",_showSummary:!1,editorOptions:{itemModelClass:o,itemTextAttribute:"answer",itemAdditionEvent:"addAnswer",itemAssociationToParentModel:"answeredFor"}}),C=a.extend({_collectionClass:s,_contentModelAssociation:"answeredFor",_editorViewClass:g,_contentCounter:"nb_answers",modelViewClass:w,name:"answer-collection-view",_collectionEventsForAutoRefresh:null,setup:function(){var t=d.getDelayedSyncTask(this.refresh.bind(this));return this._collectionEvents=e.merge(this._collectionEvents,{onAdd:t,onRemove:t,onReset:t}),this._parent.apply(this,arguments)},_createContent:function(){return this.collection.getSortAttribute()!==p&&(this.collection.setSortAttribute(p),this.collection.sort()),this._parent.apply(this,arguments)}});return t.extend({_modelClass:n,_answerCollectionViewClass:C,defaultOptions:{comments:!1,mainCollectionViewName:"nonValidatedAnswers",validatedAnswers:!0,validatedAnswersViewClass:"DS/SwymUIComponents/script/feature/community/question/view/validated-answers-view",nonValidatedAnswers:!0,nonValidatedAnswersViewClass:C,showAnswers:!0,showNonValidatedAnswersAtInit:!0,answerToScrollTo:null},name:"social-features-for-questions-view",setup:function(){this._parent.apply(this,arguments),!0===this.getOption("validatedAnswers")&&!0===this.getOption("nonValidatedAnswers")&&this.getOption("showAnswers")?this._createAllAnswers({showNonValidatedAnswers:this.getOption("showNonValidatedAnswersAtInit")}):(!0===this.getOption("validatedAnswers")&&this._createValidatedAnswers(),!0===this.getOption("nonValidatedAnswers")&&this.getOption("showAnswers")&&this._createNonValidatedAnswers())},_createAllAnswers:function(e){this._fetchAndShowAllAnswers(e)},_createValidatedAnswers:function(){this._fetchAndShowValidatedAnswers()},_createNonValidatedAnswers:function(){this._fetchAndShowNonValidatedAnswers()},answersNotBeenOrBeingFetched:function(){var e=this.model;return!(e.haveAnswersBeenFetched()||e.areAnswersBeingFetched()||e.haveDetailedAnswersBeenFetched()||e.areDetailedAnswersBeingFetched())},_fetchAndShowAllAnswers:function(e){var t=this.model;this.answersNotBeenOrBeingFetched()&&(!t.hasBeenFetched()&&c.getInstance().isContentContext()||parseInt(t.get("nb_answers"),10)>0)&&this.fetchAllAnswers({onComplete:function(){var e=t.getValidatedAnswerCollection();e&&e.length>0?t.set("nb_validate",1):t.set("nb_validate",0)}}),this._showNonValidatedAnswers(),e&&!1===e.showNonValidatedAnswers&&this.getChildView(this.getOption("mainCollectionViewName")).hide(),!0===this.getOption("showAnswers")&&this._showValidatedAnswers()},fetchAllAnswers:function(e){return this.model.fetchAllAnswers(e)},_fetchAndShowValidatedAnswers:function(){var e=this.model,t=e.getValidatedAnswerCollection();t.hasBeenFetched()||t.isBeingFetched()||(!e.hasBeenFetched()&&c.getInstance().isContentContext()||parseInt(e.get("nb_answers"),10)>0)&&e.fetchValidatedAnswers({onComplete:function(){t&&t.length>0?e.set("nb_validate",1):e.set("nb_validate",0)}}),!0===this.getOption("showAnswers")&&this._showValidatedAnswers()},_showValidatedAnswers:function(){var e=this.model.getValidatedAnswerCollection();this.addChildView("validatedAnswers",{collection:e,Class:this.getOption("validatedAnswersViewClass"),modelName:this.model.getModelName()})},_fetchAndShowNonValidatedAnswers:function(){var e=this.model,t=e.getAnswerCollection();t.hasBeenFetched()||t.isBeingFetched()||(!e.hasBeenFetched()&&c.getInstance().isContentContext()||parseInt(e.get("nb_answers"),10)>0)&&e.fetchAnswers(),this._showNonValidatedAnswers()},_showNonValidatedAnswers:function(){var e=this.model.getAnswerCollection();this.addChildView(this.getOption("mainCollectionViewName"),{collection:e,Class:this.getOption("nonValidatedAnswersViewClass"),modelName:this.model.getModelName(),answerToScrollTo:this.getOption("answerToScrollTo")})},_createContent:function(){var e=this.getChildView("actionBar"),t=this.getChildView(this.getOption("mainCollectionViewName")),i=this.getChildView("validatedAnswers"),n=this.getOption("isCompactView")||!1;return[i||"",e?{class:"social-buttons-wrapper",html:[this.addChildView("socialToolbarViewWithLikeOnly",new u({model:this.model,widget:this._widget,sendCommentsInitCallInPool:this.getOption("sendCommentsInitCallInPool")})),e,n?"":this.addChildView("socialToolbarViewWithShareOnly",new h({model:this.model,widget:this._widget,sendCommentsInitCallInPool:this.getOption("sendCommentsInitCallInPool")}))]}:"",t||""]},onCommentCreatorFocusRequest:function(){var e=this._parent.apply(this,arguments),t=this.getChildView(this.getOption("mainCollectionViewName"));return t&&t.show(),e}})}),define("DS/SwymUIComponents/script/feature/community/question/social-interactions/compact-social-features-for-question-view",["DS/SwymUIComponents/script/feature/community/question/social-interactions/social-features-for-question-view","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/lib/event-manager"],function(e,t,i){"use strict";return e.extend({name:"compact-social-features-for-question-view",domEvents:{"click .fonticon-comment":"_onCommentButtonClick"},_onCommentButtonClick:function(){var e=this.model,n=e.get("mid"),o=e.getModelName(),s=e.getCommunity(),a=s.get("mid")||s.id,r=s.isDirectMessage();t.goToContent(n,o,a,!1,null,null,r),i.dispatchEvent("commentIconClickedInCompactView",[],!0)}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/tag-autocomplete-v2",["UWA/Core","UWA/String","UWA/Utils","DS/SocialUserMention/Controls/AbstractAutocomplete","DS/SwymUIComponents/script/utils/feature-activation-manager","DS/SwymUICore/script/lib/6wpanel/community-tags-manager"],(e,t,i,n,o,s)=>{return n.extend({SUGGESTIONS_MAX_HEIGHT:238,defaultOptions:{defaultClassName:"s6m-tag-autocomplete",typeDelayBeforeSearch:0},_initSocialMentionDataSet(){const n=this;this.addDataset({name:"6WTags",items:[],async remoteSearchEngine(e,t){const n={dataset:e,matchingItems:[]};if(o.areCommunityTagsAvailable())try{const e=await(async e=>{const t=s.getInstance(),i=await t.getCommunitySubjectURI({});return await s.getInstance().getSuggestions({communitySubjectURI:i,text:e})})(t);n.matchingItems=e&&e.suggestions?e.suggestions:[]}catch(e){console.error(e)}return n.matchingItems.length<6&&n.matchingItems.push(...(({text:e})=>s.getDefaultSuggestions({text:e}).map(e=>{const t=e.sixw,n=`${t}/${e.label}`;return{...e,predicate:t,value:n,id:i.getCheckSum(n),predicateWithoutNamespace:t.replace("ds6w:","")}}))({text:t})),n.matchingItems.forEach(e=>{e.id||(e.id=`${i.getCheckSum(e.object)}-${i.getUUID()}`),e.value||(e.value=e.object_db||e.object)}),n}},{templateEngine(i,n,o){i.addClassName("default-template");const s=e.createElement("span",{class:"s6m-tag-literal"});s.setText(o.label),i.setContent(e.createElement("span",{class:"item-label",html:[{tag:"span",title:t.ucfirst(o.label),class:`item-label-icon fonticon fonticon-${o.sixw.replace("ds6w:","3ds-")}`},s,o.isCommunityTag?{tag:"span",class:"fonticon fonticon-users-alt pull-right"}:void 0]}))},onError(){n.hide()},onTimeout(){n.hide()}})}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/inline-6wtagging",["UWA/Core","DS/SocialUserMention/AbstractSocialMention","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/lib/6wpanel/community-tags-manager","DS/SwymUIComponents/script/feature/community/content/edit/tag-autocomplete-v2","DS/SwymUICore/script/utils/usage-tracker"],(e,t,i,n,o,s)=>{return t.singleton({_triggerCharacter:"#",_appendTriggerCharacterToMention:!1,_autocompleteClass:o,_attributeForStoringAutocompleteId:"_6wTagAutocompleteId",getMention(t){if(!(t&&t.object&&t.object.sixw))throw new Error("The tag sixw is required!");const i=e.clone(t,!1),n=i.object.object_db||i.object.object||i.object.label||"";return i.linksExtraAttributes=e.merge({class:"s6m-tag-link sm-link","data-predicate":i.object.sixw,"data-tag-value":n},i.linksExtraAttributes),s.trackPageEvent({category:"CommunityTags",label:i.object.isCommunityTag?"creationInlineCommunityTag":"creationInlineTag",view:"content-editor-view",event:"click"}),this._parent.call(this,i)},enableFeature(...e){return i.getInstance().addListener("onThreadChange",this.resetCache,this),this._parent(...e)},disableFeature(...e){return i.getInstance().removeListener("onThreadChange",this.resetCache),this._parent(...e)},resetCache(){return this._parent?this._parent():null}})}),define("DS/SwymUIComponents/script/feature/community/question/social-interactions/answer-detailed-view",["UWA/Core","UWA/Utils/Client","DS/SwymUIComponents/script/feature/community/content/social-interactions/comment-view","DS/SwymUICore/script/feature/community/iquestion/model/iq-answer-model","DS/SwymUICore/script/feature/community/iquestion/model/iqa-comment-model","DS/SwymUICore/script/feature/community/comment/collection/comment-collection","DS/SwymUIComponents/script/feature/community/content/social-interactions/comment-collection-view","DS/SwymUIComponents/script/feature/community/content/social-interactions/edit/comment-editor-view","DS/SwymUIComponents/script/feature/community/content/view/content-small-view-factory","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUIComponents/script/feature/community/content/social-interactions/social-toolbar-view","DS/SwymUICore/script/utils/date","DS/SwymUIComponents/script/feature/core/ui-components/tooltip/responsive-button-tooltip","DS/UIKIT/Input/Button","DS/UIKIT/Mask","i18n!DS/SwymUIComponents/assets/nls/feature/community/question/social-interactions/social-features-for-question-detailed-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/comment/view/comment-view"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w,C){"use strict";var f=m.extend({_modelClass:n,defaultOptions:{socialToolbarMode:"light",enableShare:!1,enableLike:!1,showCommentsSummaryFirst:!1}});return i.extend({_modelClass:n,_contentModelAssociation:"answeredFor",_contentAttributeInModel:"answer",_contentCounter:"nb_answers",_commentsWrapperSelector:".answer-comments-wrapper",name:"answer-detailed-view",_modelEvents:{"onSync:positiveRate":"refresh","onSync:negativeRate":"refresh","onChange:answer":"_updateAnswer"},_modelEventsForAutoRefresh:["onChange:can_validate"],upvoteAnswer:function(){this.model.positiveRate({onComplete:function(e){this.alert("success",w.get("Yourvotehasbeensuccessfullysaved"));var t=parseInt(e.get("NbRatings"),10);e.set("NbRatings",t+1)}.bind(this),onFailure:function(){this.alert("error",w.get("YourvotecouldnotbesavedPleasetryagain"))}.bind(this)})},downvoteAnswer:function(){this.model.negativeRate({onComplete:function(e){this.alert("success",w.get("Yourvotehasbeensuccessfullysaved"));var t=parseInt(e.get("NbRatings"),10);e.set("NbRatings",t-1)}.bind(this),onFailure:function(){this.alert("error",w.get("YourvotecouldnotbesavedPleasetryagain"))}.bind(this)})},_updateAnswer:function(){this.container&&this.container.getElement(".content-message")&&this.container.getElement(".content-message").setContent(this.renderContentSummary(this.model.get("answer")))},_updateButtonsVisibility:function(){this.container&&this.model&&(this.model.isNew()?(this.container.addClassName("disable-all-buttons"),this.listenToOnce(this.model,"onChange:mid",this._updateButtonsVisibility)):this.container.removeClassName("disable-all-buttons"))},_createFooter:function(){var e=this.model,i=e.get("can_rate"),n=e.get("can_validate"),o=e.get("has_rated")&&1===parseInt(e.get("my_rate"),10),s="1"===e.get("validate"),a=(e.get("rate"),n&&!s?{html:this.addControl("validationButton",new p({value:w.ValidateAnswer,icon:"check",className:"primary btn-sm"})),class:"validate"}:""),r=n&&s?{html:this.addControl("inValidationButton",new p({value:w.InvalidateAnswer,icon:"times",className:"warning btn-sm"})),class:"invalidate"}:"",c=this.addControl("voteButton",new p({value:"",icon:"thumbs-up",className:"default iqa-vote-btn",disabled:!i,active:Boolean(o)}));return t.Features.touchEvents||(a&&this.addControl("validationButtonTooltip",new h({target:this.getControl("validationButton").getContent(),position:"bottom",body:w.ValidateAnswer,offset:{x:0,y:5}})),r&&this.addControl("inValidationButtonTooltip",new h({target:this.getControl("inValidationButton").getContent(),position:"bottom",body:w.inValidateAnswer,offset:{x:0,y:5}})),c&&this.addControl("voteButtonTooltip",new h({target:c.getContent(),position:"bottom",body:o?w.get("Unvote"):w.get("Vote"),offset:{x:0,y:5}}))),this._updateButtonsVisibility(),[{class:"answer-footer-wrapper answer-action-bar",html:[{html:[{html:[c],class:"upvote"},{html:this.getChildView("nbEndorsementsNextGen")||this.addChildView("nbEndorsementsNextGen",{Class:l.getViewClass("nbEndorsementsNextGen"),model:e}),tag:"span"}]},this.addChildView("socialToolbarView",new f({model:e,widget:this._widget})),a,r]}]},_createContent:function(){return[this._parent.apply(this,arguments)].concat(this._createFooter())},onRedraw:function(){var e=this;return d.getInstanceFetched(function(t){var i=e.model.getAuthor();t.get("login")===i.get("login")||t.get("hash_key")===i.get("hash_key")?e.container.addClassName("disable-vote-btn"):e.container.removeClassName("disable-vote-btn")}),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/question/social-interactions/social-features-for-question-detailed-view",["UWA/Core","UWA/Event","UWA/Array","DS/SwymUIComponents/script/feature/community/content/social-interactions/social-toolbar-view","DS/SwymUIComponents/script/feature/community/question/social-interactions/social-features-for-question-view","DS/SwymUICore/script/feature/community/iquestion/model/iquestion-model","DS/SwymUICore/script/feature/community/iquestion/model/iq-answer-model","DS/SwymUICore/script/feature/community/iquestion/collection/iq-answer-collection","DS/SwymUIComponents/script/feature/community/question/social-interactions/answer-detailed-view","DS/SwymUIComponents/script/feature/community/content/social-interactions/comment-collection-view","DS/SwymUIComponents/script/feature/community/content/social-interactions/edit/comment-editor-view","DS/SwymUICore/script/utils/localstorage-manager","DS/SwymUICore/script/utils/utils","i18n!DS/SwymUIComponents/assets/nls/feature/community/question/social-interactions/social-features-for-question-detailed-view","DS/SwymUIComponents/script/utils/feature-activation-manager"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p){"use strict";var g=n.extend({_modelClass:s,defaultOptions:{enableComment:!1,enableShare:!1}}),w=n.extend({_modelClass:s,defaultOptions:{enableComment:!1,enableLike:!1}}),C=a.DateField,f=a.LocalStorageKeyForSort,y=d.extend({defaultOptions:{itemModelClass:a,itemTextAttribute:"answer",itemAdditionEvent:"addAnswer",itemAssociationToParentModel:"answeredFor",activateSendButton:p.isFeatureActivated("activateAnswerSendButton")},name:"sf-answer-editor-view"}),v=c.extend({_collectionClass:r,_contentModelAssociation:"answeredFor",_editorViewClass:y,_showSubsetOfModelViews:!1,_collectionEvents:{"onRequest:read":"mask",onSync:"unmask"},_collectionEventsForAutoRefresh:null,setup:function(){var t=u.getDelayedSyncTask(this.refresh.bind(this));return this._collectionEvents=e.merge(this._collectionEvents,{onAdd:t,onRemove:t,onReset:t}),this._parent.apply(this,arguments)},_createContent:function(){var e=m.getItem(f,{tenant:!0})||C;return e!==this.collection.getSortAttribute()&&(this.collection.setSortAttribute(e),this.collection.sort()),this._parent.apply(this,arguments)},modelViewClass:l,name:"sf-answer-collection-view",defaultOptions:{answerToScrollTo:null},scrollToAnswer:function(e,t){var i,n=this,o=null,s=[];if(e&&this.collection&&!this.isDestroyed()){if((i=n.collection.getAssociated("answeredFor")).get("validatedAnswers")&&(s=i.get("validatedAnswers").filter(function(t){return t.subject6wuri===e})),s.length)return;0===s.length&&!0===i.getCustomProperty("detailedAnswersFetched")||this.collection.hasBeenFetched()?setTimeout(function(){n.getModelViews().forEach(function(t){t.model.get("subject6wuri")===e&&(o=t)}),o?o.isDestroyed()||(o.container.scrollIntoView(!1),o.container.addClassName("fade-in-out-blue"),setTimeout(function(){o.container&&o.container.removeClassName("fade-in-out-blue")},5e3)):t?n.alert("info",h.get("TheAnswerYouAreLookingForCouldNotBeFoundItMayHaveBeenRemoved")):i.fetchAllDetailedAnswers({onComplete(){n.scrollToAnswer(e,!0)},onFailure(){n.alert("info",h.get("TheAnswerYouAreLookingForCouldNotBeFoundItMayHaveBeenRemoved"))}})},2500):i?i.addEventOnce("onSync:fetchAllDetailedAnswers",function(){n.scrollToAnswer(e)}):this.collection.addEventOnce("onCollectionChange",function(){n.scrollToAnswer(e)})}},onRender:function(){this.getOption("answerToScrollTo")&&this.scrollToAnswer(this.getOption("answerToScrollTo"))}}),A=c.extend({_collectionClass:r,_contentModelAssociation:"answeredFor",_editorViewClass:y,_collectionEvents:{"onRequest:read":"mask",onSync:"unmask",onAdd:"onValidatedAnswerChanged",onRemove:"onValidatedAnswerChanged"},onValidatedAnswerChanged:function(){var e=this.collection.getAssociated("answeredFor");e&&e.set("nb_validate",this.collection.length)},_createContent:function(){return this._parent.apply(this,arguments)},modelViewClass:l,name:"validated-answer-collection-view"});return o.extend({name:"social-features-for-question-detailed-view",defaultOptions:{validatedAnswersViewClass:A,nonValidatedAnswersViewClass:v},_modelEvents:{"onRequest:fetchAllDetailedAnswers":"mask","onSync:fetchAllDetailedAnswers":"unmask","onError:fetchAllDetailedAnswers":"unmask"},domEvents:{"click .upvote>button:not([disabled])":"_onUpvoteClick","click .validate":"_onValidateClick","click .invalidate":"_onInValidateClick"},_createActionBar:function(){var t=this.getOption("actionBarViewOptions")||{};this.setOption("actionBarViewOptions",e.extend(t,{events:{sortAnswersRequest:function(e){this.sortNonValidatedAnswers(e)}.bind(this)}})),this._parent.apply(this,arguments)},sortNonValidatedAnswers:function(e){var t,i=this.getChildView("nonValidatedAnswers");i&&((t=i.collection)&&t.setSortAttribute(e)&&t.sort(),i.refresh())},answersNotBeenOrBeingFetched:function(){var e=this.model;return!e.haveDetailedAnswersBeenFetched()&&!e.areDetailedAnswersBeingFetched()},fetchAllAnswers:function(e){return this.model.fetchAllDetailedAnswers(e)},_findAnswerViewWhichFiredEvent:function(e){var n,o,s,a=t.getElement(e);return a&&(o=a.getClosest(".answer-detailed-view-container"),(s=this.getChildView("nonValidatedAnswers"))&&(n=i.detect(s.getModelViews(),function(e){return e.container===o})),!n&&(s=this.getChildView("validatedAnswers"))&&(n=i.detect(s.getModelViews(),function(e){return e.container===o}))),n},_onUpvoteClick:function(e){var t=this._findAnswerViewWhichFiredEvent(e);t&&(1!==parseInt(t.model.get("my_rate"),10)?t.upvoteAnswer():t.downvoteAnswer())},_onValidateClick:function(e){var t,i=this,n=i._findAnswerViewWhichFiredEvent(e);n&&(t=n.model)&&(this.mask(),t.validateAnswer({onComplete:function(e){i.unmask(),i.dispatchEvent("newAnswerValidated",[e,i]),i.alert("success",h.Theanswerwasvalidatedsuccessfully)},onFailure:function(){i.alert("error",h.TheanswercouldnotbevalidatedPleasetryagain),i.unmask()}}))},_onInValidateClick:function(e){var t,i=this,n=i._findAnswerViewWhichFiredEvent(e);n&&(t=n.model)&&(this.mask(),t.invalidateAnswer({onComplete:function(e){i.unmask(),i.dispatchEvent("answerInvalidated",[e,i]),i.alert("success",h.Theanswerwasinvalidatedsuccessfully)},onFailure:function(){i.alert("error",h.TheanswercouldnotbeinvalidatedPleasetryagain),i.unmask()}}))},newAnswerValidated:function(e,t){t.fetchAnswerCollections()},answerInvalidated:function(e,t){t.fetchAnswerCollections()},fetchAnswerCollections:function(){this.fetchAllAnswers()},onInjected:function(){this.dispatchEvent("onSocialToolbarInjected")},_createContent:function(){var e=this.getChildView("actionBar"),t=this.getChildView("nonValidatedAnswers"),i=this.getChildView("validatedAnswers");return[e?{class:"social-buttons-wrapper",html:[this.addChildView("socialToolbarViewWithLikeOnly",new g({model:this.model,widget:this._widget})),e,this.addChildView("socialToolbarViewWithShareOnly",new w({model:this.model,widget:this._widget}))]}:"",{class:"validated-answers",html:i||""},{class:"non-validated-answers",html:t||""}]}})}),define("DS/SwymUIComponents/script/feature/community/media/library/media-filters-toolbar-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/view/filters-toolbar-view","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/UIKIT/Input/Button","DS/UIKIT/Input/Text","DS/SwymUICore/script/lib/view/generic/swym-view","DS/PlatformAPI/PlatformAPI","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUIComponents/script/utils/content-creation-types-manager","DS/SwymUICore/script/lib/6wpanel/utils","DS/UIKIT/Tooltip"],function(e,t,i,n,o,s,a,r,l,c,d,m){return a.extend({name:"media-filters-toolbar-view",domEvents:{"click #images-filter":"_filter","click #videos-filter":"_filter","click #media3d-filter":"_filter","click #document-filter":"_filter","click #gif-filter":"_filter","click .search-activated #search-filter":"_launchSearchCall","click #search-filter":"_enableSearchInput","click #remove-search-filter":"_disableSearchInput"},_enableSearchInput:function(){var e=this.getElement("#media_type_filters");e&&!e.hasClassName("search-activated")&&(e.addClassName("search-activated"),this._removeSelectedClassRightFilter(),this._currentRightFilter="",this._callOptions.data.query="#all",this._performSearchCall())},_disableSearchInput:function(){var e=this.getElement("#media_type_filters");e&&e.removeClassName("search-activated"),this._callOptions.data.query="#all",this._performSearchCall()},_currentLeftFilter:"",_currentRightFilter:"",_callOptions:{},_filter:function(e){this._preventAndStop(e),this.filter(e.target)},_preventAndStop:function(e){e.preventDefault(),e.stopPropagation()},_launchSearchCall:function(){var e=this.container.getElement(".selected");e&&(this._currentRightFilter="",e.removeClassName("selected")),this._callOptions.data.query=this.getControl("search-input").getValue(),this._performSearchCall()},setup:function(e){return this._callOptions={data:{query:"#all",order_field:"update",withDraft:!0,with_synthesis:!1},serviceName:"filter"},this._currentLeftFilter='community_id:"'+this.getOption("communityId")+'"',this._callOptions.data.refineUsingQuery=this._currentLeftFilter,this.collection.fetchPage(1,this.collection.getFilteringOptions(null,null,this._callOptions)),this._parent.apply(this,arguments)},_createContent:function(){this.collection;var n=l.getInstance().isDirectMessageContext()||"dm"===this.getOption("threadType"),a="true"===r.getApplicationConfiguration("app.3DDrive.enable")&&!0,d=new i({id:this.getOption("communityId")}),m=[],u=n?t.Conversation:d.get("title",{escapeHTML:!1});m.push({name:"community",text:u,selectable:!0,selected:!0}),"wedo"!==c.getInstance().getCurrentContentType()&&(m.push({name:"my",text:t.MyMedia,selectable:!0}),m.push({name:"all",text:t.AllMedia,selectable:!0}));var h=n?t.AddmediaFromConversation:t.Addmediafrom+u;a&&(m.push({className:"divider"}),m.push({name:"drive",text:t.Drive,selectable:!0}));var p=[this.addControl("button-filter",new o({value:h,className:"custom-button",dropdown:{items:m},events:{onDropdownClick:function(e,i){var n={};switch(i.name){case"all":this.getControl("button-filter").setValue(t.Addmediafrom+i.text),n.id="all-media-filter";break;case"community":this.getControl("button-filter").setValue(h),n.id="community-media-filter";break;case"my":this.getControl("button-filter").setValue(t.Addmediafrom+i.text),n.id="my-media-filter";break;case"drive":this.getControl("button-filter").setValue(t.Addmediafrom+i.text)}"drive"===i.name?this.dispatchEvent("onActivateDrive",[!0]):(this.dispatchEvent("onActivateDrive",[!1]),this.filter(n))}.bind(this)}})),{id:"media_type_filters",html:[{tag:"span",id:"remove-search-filter",class:"fonticon fonticon-2x fonticon-cancel"},this.addControl("search-input",new s({placeholder:t.Search,className:"search-input",events:{onKeyDown:function(e){13!=e.which&&13!=e.keyCode||this._launchSearchCall()}.bind(this)}})),{tag:"span",id:"images-filter",class:"fonticon fonticon-2x fonticon-picture"},{tag:"span",id:"gif-filter",class:"fonticon fonticon-2x fonticon-picture-animated"},{tag:"span",id:"videos-filter",class:"fonticon fonticon-2x fonticon-video"},{tag:"span",id:"media3d-filter",class:"fonticon fonticon-2x fonticon-cube"},{tag:"span",id:"document-filter",class:"fonticon fonticon-2x fonticon-doc"},{tag:"span",id:"search-filter",class:"fonticon fonticon-2x fonticon-search"}]}],g=e.createElement("div",{class:"media_filters_toolbar",html:p});return this._addTooltipOnRighFilter(g,"images-filter",t.Pictures),this._addTooltipOnRighFilter(g,"gif-filter",t.GIFs),this._addTooltipOnRighFilter(g,"videos-filter",t.VideoAndSounds),this._addTooltipOnRighFilter(g,"media3d-filter",t.ThreeDModels),this._addTooltipOnRighFilter(g,"document-filter",t.Documents),this._addTooltipOnRighFilter(g,"search-filter",t.Search),g},_addTooltipOnRighFilter:function(e,t,i){var n=e.getElement("#"+t);n&&new m({target:n,body:i})},_removeSelectedClassRightFilter:function(){var e=this.container.getElement("#media_type_filters .selected");e&&e.removeClassName("selected")},filter:function(e){var t=e.id,i=this.container.getElement("#media_type_filters"),o=function(){var t=i.getElement(".selected");t&&t.removeClassName("selected"),t!==e?e.addClassName("selected"):this._currentRightFilter=""}.bind(this);switch(t){case"all-media-filter":this._currentLeftFilter="";break;case"community-media-filter":this._currentLeftFilter='community_id:"'+this.getOption("communityId")+'"';break;case"my-media-filter":this._currentLeftFilter="hash_key:"+n.getInstance().get("user").hash_key;break;case"gif-filter":this._currentRightFilter=d.getTagFilterForMedia("AnimatedPicture"),o();break;case"images-filter":this._currentRightFilter=d.getTagFilterForMedia("Picture"),o();break;case"videos-filter":this._currentRightFilter=[d.getTagFilterForMedia("Sound"),d.getTagFilterForMedia("Video")],o();break;case"media3d-filter":this._currentRightFilter=[d.getTagFilterForMedia("3dModel"),d.getTagFilterForMedia("SimulationMedia")],o();break;case"document-filter":this._currentRightFilter=d.getTagFilterForMedia("Document"),o()}this._performSearchCall()},showFilters:function(){var e=this.getElement("#media_type_filters");e&&e.show()},hideFilters:function(){var e=this.getElement("#media_type_filters");e&&e.hide()},_performSearchCall:function(){this._callOptions.data.refineUsingQuery=this._currentLeftFilter,this._callOptions.data.refine=this._currentRightFilter,this._callOptions.data.with_synthesis=!0,this._callOptions.data.withDraft=!0,this.collection.fetchPage(1,this.collection.getFilteringOptions(null,null,this._callOptions)),this.dispatchEvent("onActivateInfiniteScroll",[this])}})}),define("DS/SwymUIComponents/script/utils/content-media-utils",["UWA/Core","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUIComponents/script/feature/community/content/view/thumbnail-in-content-view","DS/SwymUIComponents/script/feature/community/media/view/interactive-media-thumbnail-view","DS/SwymUIComponents/script/feature/community/media/view/shared-lightbox-view","DS/SwymUIComponents/script/utils/content-process","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUIComponents/script/utils/media-utils","DS/SwymUICore/script/utils/utils","DS/WebappsUtils/WebappsUtils","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/utils/navigation"],function(e,t,i,n,o,s,a,r,l,c,d,m){"use strict";var u={createThumbnailInContentView:function(e,i,o){var s,l,c,d,u,h,p,g,w,C,f,y=new a,v=i.model.get("thumbnails_infos"),A={},_=[],S=function(){arguments[0],arguments[1]&&arguments[1]._shouldActivateAutoplay;let e=i.model.getCommunity(),t=i.model.get("mid"),n=this.model.get("mid")!==t?this.model.get("mid"):null,o=i.model.getModelName(),s=e.get("mid");i.model.set("mediaCollection",y),m.goToContent(t,o,s,!1,void 0,void 0,"dm"===e.get("community_type"),{mediaId:n})},b=i.model.getDeletedContainedMediaIds&&i.model.getDeletedContainedMediaIds()||[];if(v)for(u=0,h=v.length;u<h;u++)A[v[u].media_id]=v[u];for(var I in i._childViews)i._childViews.hasOwnProperty(I)&&i.removeChildView(I);for(u=0,h=e.length;u<h;u++){if(C=e[u],s=r.CONTENT_SECTION_MAX_WIDTH,w=C.dataset.mediaId,A&&A[w]){g=A[w],p=new t(g);var D,T=g.width||g.preview_original_width,E=g.height||g.preview_original_height;D=C.getAttribute("data-size"),!1===g.user_access?"small"===D?(T=218,E=163):"large"===D&&(T=710,E=531):"small"===D&&(s=r.CONTENT_SMALL_IMAGE_MAX_WIDTH),T>E?s=Math.min(s,T,r.getLargestMediaDisplayDimensions(p).width):(l=r.CONTENT_SECTION_MAX_WIDTH/(parseInt(T,10)/parseInt(E,10)),s=(l=Math.min(l,E,r.getLargestMediaDisplayDimensions(p).height))*(parseInt(T,10)/parseInt(E,10))),c=r.generateBestThumbnailForContentView(s,l,p,{imgTag:C})}else l=parseInt(C.style.height||C.height,10)||100,s=parseInt(C.style.width||C.width,10)||100,g={media_id:w,media_type:C.getAttribute("data-media-type"),width:s,height:l},p=new t(g),c={mediaId:w,mediaType:C.getAttribute("data-media-type"),previewType:"thumb",useVariableSizeSprite:!1,widthToDisplay:s,heightToDisplay:l,sizeCategory:"s",url:t.constructThumbnailUrl("media",w)};!0===(f=b.indexOf(w)>=0)&&(g._deleted=!0),y.add(p),delete c.useVariableSizeSprite,(d={model:p,Class:n,displayIconsOnTopRightCorner:!f,events:f?null:{onOpenInViewerRequest:S}}).imageRenderingOptions=c,d.imageReloadOptions={size:c.sizeCategory,imageKind:c.previewType},d.delegateSpriteReloadToParentView=!1,_.push(i.addChildView("thumbnailInfo"+u,d))}return _},canUseSprite:function(e,t){var i;if(e){for(var n=t.match(/<img .+? data-media-id="[A-Za-z0-9-_]+".+?" \/>/gi),o=n?n.length:0,s=e.length,a=t.replace(/\(.+?\/streammediasprite\/.+?\)/gi,""),r=0,l=s;r<l;r++){var c=new RegExp('<img .+? data-media-id="'+e[r].media_id+'".+?"',"g"),d=a.match(c);if(null===d)return!1;o-=d.length-1}i=s===o}else i=!1;return i},replaceStreammediaUrl:function(e){return e?e.replace(/src="([^"]*)\/streammedia\/.+?"/gi,['src="',c.getWebappsBaseUrl(),'SwymUIComponents/assets/thumb.png"'].join("")):""},addMediaLightBox:function(t){var i,n,o=[];for(i=0,n=t.length;i<n;i++){var a=t[i].dataset.mediaId;o.includes(a)||o.push(a)}for(i=0,n=t.length;i<n;i++)t[i]._events||e.extendElement(t[i]).addEvent("click",s._onThumbnailClick.bind(t[i],{displayedMediaId:t[i].dataset.mediaId,mediaIds:o,refModel:this.model}))}};return u}),define("DS/SwymUIComponents/script/feature/core/tenant/view/tenant-settings-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/tenant/view/tenant-settings-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/platform-utils","DS/UIKIT/Input/Toggle","DS/UIKIT/Input/Button","DS/Logger/Logger","DS/SwymUIComponents/script/utils/feature-activation-manager"],function(e,t,i,n,o,s,a,r,l){"use strict";let c,d;const m={bluejeans:"Blue Jeans",webex:"Webex",zoom:"Zoom",g2m:"GoToMeeting",teams:"Teams",None:t.None};return o.getPassportURLPromise().then(e=>{d=(c=e)+"/admin-tools/v2"}),i.extend({name:"tenant-settings",model:null,_el:null,_newOptions:null,domEvents:{"click .save-tenant-settings-button":"onSaveEditButtonClick","click .cancel-tenant-settings-button":"onCancelButtonClick","change .options-radio":"onRadioChange","change .options-checkbox":"onCheckboxChange","change .options-reverse-checkbox":"onReverseCheckboxChange","change .options-provider-radio":"onProviderRadioChange"},attributes:{styles:{padding:"10px"}},_createContent:function(){const e=this.model,i=this.options,o=i&&i.conference_providers,r=Array.isArray(o)&&o.find(e=>!0===e.active_on_tenant),c=r&&r.type,u=Array.isArray(o)&&o.map(e=>{const i=e.active_on_tenant&&c===e.type;return{tag:"div",class:"provider-row",html:[this.addControl(`provider_${e.type}`,new s({name:"provider",type:"radio",label:m[e.type],value:e.type,checked:i,className:"primary indent-option options-provider-radio "+(i?"checked":"")})),{tag:"a",class:"link",html:t.ConnectionSettings,href:d}]}}),h=(l.isBetaFeatureActivated("rdv")||l.isBetaFeatureActivated("rdvInConversation"))&&u&&u.length>0;if(h&&u.push({tag:"div",class:"provider-row",html:[this.addControl("provider_none",new s({name:"provider",type:"radio",label:t.None,value:"none",checked:!c,className:"primary indent-option options-provider-radio"}))]}),e){return this._controls["save-tenant-settings-button"]||(this.addControl("save-tenant-settings-button",new a({className:"primary save-tenant-settings-button",value:t.Save})),this.addControl("cancel-tenant-settings-button",new a({className:"default cancel-tenant-settings-button",value:t.Cancel}))),[[{html:[{tag:"label",html:t.Share},this.addControl("share_facebook",new s({name:"share_facebook",type:"checkbox",value:"Facebook",checked:i.share_facebook,className:"primary indent-option options-checkbox"})),this.addControl("share_linkedin",new s({name:"share_linkedin",type:"checkbox",value:"Linkedin",checked:i.share_linkedin,className:"primary indent-option options-checkbox"})),this.addControl("share_twitter",new s({name:"share_twitter",type:"checkbox",value:"Twitter",checked:i.share_twitter,className:"primary indent-option options-checkbox"}))]},{tag:"label",html:t.CreateACommunity},this.addControl("create_a_community_1",new s({name:"create_a_community",type:"radio",label:t.ForPlatformAdministratorsOnly,value:"admins_only",checked:!i.plan_a_community&&!i.allow_add_community_for_everyone,className:"primary indent-option options-radio"})),n.getInstance().isFeatureActivated("activate_community_request")?this.addControl("create_a_community_2",new s({name:"create_a_community",type:"radio",label:t.PlanCommunity,value:"plan_a_community",checked:i.plan_a_community,className:"primary indent-option options-radio"})):"",this.addControl("create_a_community_3",new s({name:"create_a_community",type:"radio",label:t.ForAllUsers,value:"allow_add_community_for_everyone",checked:i.allow_add_community_for_everyone,className:"primary indent-option options-radio"})),h?{tag:"label",html:t.ConferenceProviders}:"",h?u:"",{tag:"label",html:t.ActivateUserCustomization},this.addControl("user_picture_upload",new s({name:"block_userpicture_upload",type:"checkbox",value:t.ProfilePicture,checked:!i.block_userpicture_upload,className:"primary indent-option options-reverse-checkbox"})),{tag:"label",html:t.Userpictureapitoken},{tag:"div",class:"indent-option",html:[{tag:"span",html:i.userpicture_upload_token}]}],this._controls["cancel-tenant-settings-button"],this._controls["save-tenant-settings-button"]]}},setup:function(e){var t=this._parent.apply(this,arguments);return this._newOptions={},e&&(this.settings=e.settings||{},this.options=e.options||{}),t},onCancelButtonClick:function(){this.model.removeChanges(),this._newOptions={},this.refresh()},onSaveEditButtonClick:function(){this.model.hasVirtuallyChanged()&&(this.mask(),this.model.save({id:this.model.get("mid")},{onComplete:function(){this.unmask(),this.alert("success",t.Yoursettingshasbeensaved)}.bind(this),onFailure:function(){this.unmask(),this.alert("error",t.Errorwhilesavingyoursettings)}.bind(this)})),0===Object.keys(this._newOptions).length||(this.mask(),this.model.editOptions({data:this._newOptions,onComplete:function(e,i){this.unmask(),this.options=i.result,this._newOptions={},n.getInstance().updateTenantAttributes(i.result),this.alert("success",t.Yoursettingshasbeensaved)}.bind(this),onFailure:function(){this.unmask(),this.alert("error",t.Errorwhilesavingyoursettings)}.bind(this)}))},onRadioChange:function(e){var t=[],i=e.target;if("create_a_community"===i.name){switch(delete this._newOptions.plan_a_community,delete this._newOptions.allow_add_community_for_everyone,i.value){case"plan_a_community":t.push({name:"plan_a_community",value:i.checked}),t.push({name:"allow_add_community_for_everyone",value:!i.checked});break;case"allow_add_community_for_everyone":t.push({name:"allow_add_community_for_everyone",value:i.checked}),t.push({name:"plan_a_community",value:!i.checked});break;default:t.push({name:"plan_a_community",value:!1}),t.push({name:"allow_add_community_for_everyone",value:!1})}t.forEach(function(e){e.value!==this.options[e.name]&&(this._newOptions[e.name]=e.value)},this)}},onCheckboxChange:function(e){this._newOptions[e.target.name]=e.target.checked,this._newOptions[e.target.name]===this.options[e.target.name]&&delete this._newOptions[e.target.name]},onReverseCheckboxChange:function(e){this._newOptions[e.target.name]=!e.target.checked,this._newOptions[e.target.name]===this.options[e.target.name]&&delete this._newOptions[e.target.name]},onProviderRadioChange:function(e){const t=e.target.value,i=this.options,n=i&&i.conference_providers;Array.isArray(n)&&n.forEach(e=>{const i=`provider_${e.type}`,n=this.getControl(`${i}`);i===`provider_${t}`?n&&n.elements.container.addClassName("checked"):n&&n.elements.container.removeClassName("checked")}),this._newOptions.conference_provider_types="none"===t?[]:[t],r.log(this._newOptions)}})}),define("DS/SwymUIComponents/script/feature/core/tenant/view/settings-tab-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/core/tenant/view/swym-control-center-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/core/tenant/view/tenant-media-max-size-view","DS/SwymUIComponents/script/feature/core/tenant/view/tenant-settings-view","DS/SwymUIComponents/script/feature/core/tenant/view/tenant-stats-view","DS/SwymUICore/script/feature/community/idea/collection/status-collection","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/UIKIT/Input/Button"],function(e,t,i,n,o,s,a,r,l,c){"use strict";return console.log("test"),i.extend({name:"settings-tab-view",_tenantSettings:null,_tenantMediaMaxSize:null,_tenantStats:null,setup:function(){this._parent.apply(this,arguments),this._init(),this._tenantSettings.handler(),this._tenantMediaMaxSize.handler(),this._tenantStats.handler()},_init:function(){var i=this;i._tenantSettings={handler:function(){i._tenantSettings.wrapperEl=e.createElement("div",{class:"settings-tenant-settings-wrapper col-md-4"}),e.createElement("h4",{html:t.Features}).inject(i._tenantSettings.wrapperEl),i.model.listOptions({onComplete:function(e,t){i._tenantSettings.view=new o({model:i.model,options:t.result}),i._tenantSettings.view.render(i._tenantSettings.wrapperEl)}})}},i._tenantMediaMaxSize={handler:function(){i._tenantMediaMaxSize.view=new n({model:i.model}),i._tenantMediaMaxSize.wrapperEl=e.createElement("div",{class:"settings-tenant-media-max-size-wrapper col-md-4"}),e.createElement("h4",{html:t.Maximummedia}).inject(i._tenantMediaMaxSize.wrapperEl),i._tenantMediaMaxSize.view.render(i._tenantMediaMaxSize.wrapperEl)}},i._tenantStats={handler:function(){i._tenantStats.wrapperEl=e.createElement("div",{class:"settings-tenant-stats-wrapper col-md-4"}),e.createElement("h4",{html:t.Usage}).inject(i._tenantStats.wrapperEl),i.model.getTenantInfo({onComplete:function(){i._tenantStats.view=new s({model:i.model}),i._tenantStats.view.render(i._tenantStats.wrapperEl)}})}}},_createContent:function(){return[e.createElement("div",{html:[this._tenantSettings.wrapperEl,this._tenantMediaMaxSize.wrapperEl,this._tenantStats.wrapperEl]})]}})}),define("DS/SwymUIComponents/script/feature/community/content/view/content-body-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/lib/model/generic/6wtaggable-model","DS/SwymUIComponents/script/utils/content-process","DS/SwymUIComponents/script/utils/feature-activation-manager","DS/UIKIT/Spinner","DS/SwymUIComponents/script/utils/content-media-utils","DS/SwymUICore/script/lib/6wpanel/community-tags-manager","DS/SwymUIComponents/script/feature/community/content/view/content-community-tags-read-view"],(e,t,i,n,o,s,a,r,l,c)=>{const d=t.extend({_modelEventsForAutoRefresh:["onChange:summary","onChange:content","onChange:thumbnails_infos"],_modelEvents:{"onSync:update":"onModelUpdate","onChange:tags6w":"_updateInlineTagsLookAccordingToTagsList"},_delegateSpriteReloadToParentView:!1,defaultOptions:{modelAttr:"content"},_onRevisionReceived(e){this.wikiRevisionData=e.attributes,this.setMode("revision"),this.refresh()},wikiRevisionData:null,mode:null,contentMediaCollection:null,name:"content-body-view",init(...e){return this._parent(...e)},setup(e,...t){return e&&Object.hasOwnProperty.call(e,"mode")&&this.setMode(e.mode),this.tagsManager=l.getInstance(),this._parent(e,...t)},setMode(e){this.mode=e},onSetModel(e,t,i){this.reactTo(i,"onRevisionReceived",this._onRevisionReceived),this.setMode("view")},onModelUpdate(){this.setMode("view"),this.wikiRevisionData=null,this.refresh()},_updateInlineTagsLookAccordingToTagsList(){if(!this.isDestroyed()&&this.model instanceof n){let e=[];if(s.areCommunityTagsAvailable()){const t=this.tagsManager.getTags();this.tagsManager.getCommunityId()===this.model.getThreadId()&&t.length&&(e=t)}o.updateInlineTagsLookAccordingToTagsList(this.container,this.model.get("tags6w")||[],e)}},_createContent(){let t=!1;const{model:i}=this,l=i.get("thumbnails_infos");if(i){let d=i.get(this.getOption("modelAttr")),m=!1;if("preview"===this.mode&&i.hasVirtuallyChanged(this.getOption("modelAttr")))d=i.getChanges(this.getOption("modelAttr"));else if("revision"===this.mode)d=i.get("content");else if(!d){const e=i.has("update");d=i.get("summary"),(!e&&"wiki"===i._modelName||"wiki"!==i._modelName)&&(m=!0)}t=!!("preview"!==this.mode&&l&&l.length>0),d=r.replaceStreammediaUrl(d),d=e.createElement("div",{html:d});const u=(d=o.contentProcessTables(d)).getElements("img[data-media-id]"),h=r.createThumbnailInContentView(u,this,t),p=e=>{u[e].destroy()};for(let e=0,t=h.length;e<t;e+=1){const t=e;h[e].addEventOnce("onPostInject",p.bind(this,t)),h[e].render().inject(u[e],"before")}let g=[];if(!this.isDestroyed()&&this.model instanceof n&&s.areCommunityTagsAvailable()){const e=this.tagsManager.getTags();this.tagsManager.getCommunityId()===this.model.getThreadId()&&e.length?g=e:null==this.tagsManager.getCommunityId()&&this.tagsManager.addEventOnce("tagsUpdated",this._updateInlineTagsLookAccordingToTagsList,this)}if(d=[d=o.contentPostProcess(d,{imageProcessing:!1,updateInlineTagsLookAccordingToTagsList:this.model instanceof n,tagList:this.model instanceof n?this.model.get("tags6w")||[]:null,communityTags:g}),this.addChildView("communityTagsView",new c({content:this.model}))],this.imageReloadOptions=t?{useVariableSizeSprite:!0,selector:'img[data-type="VariableSizeMediaThumbnail"]'}:{useSprite:!1,imageKind:"thumb",size:"l"},!i.get(this.getOption("modelAttr")))if(i.get("topics"))d=[];else{const e={html:this.addControl("content-loading",new a({className:"msg-animation",visible:!0,animate:!0,spin:!0})),styles:{"text-align":"center",height:"30px"}};d=[...d,e]}return d}}});return t.extend({_modelClass:i,name:"content-body-view",defaultOptions:{modelAttr:"content"},setup(...e){this._parent(...e);const t={model:this.model,widget:this._widget,modelAttr:this.getOption("modelAttr"),Class:d};this.getOption("innerBodyViewMode")&&(t.mode=this.getOption("innerBodyViewMode")),this.addChildView("innerBodyView",t)},_createContent(){const{model:t}=this;if(t){return e.createElement("div",{html:[{class:"content-body diff-enabled",html:[this.getChildView("innerBodyView")]},{styles:{clear:"both"}}]})}}})}),define("DS/SwymUIComponents/script/feature/community/template/template-manager",["UWA/Core","DS/SwymUICore/script/lib/pub-sub","DS/SwymUIComponents/script/feature/community/template/collection/content-template-collection","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUIComponents/script/utils/content-creation-types-manager"],(e,t,i,n,o,s)=>{let a=null;const r=t.extend({_collectionTemplates:null,_isTemplateFeatureEnabled:null,_context:null,_typesManager:null,_availableTemplates:null,init(){return this._parent.apply(this,arguments),this._context=n.getInstance(),this._typesManager=s.getInstance(),this._isTemplateFeatureEnabled=!1,this._availableTemplates=[],this._typesManager.addEvent("onCurrentContentTypeChange",this._onCurrentContentTypeChange.bind(this)),this._context.addListener("onCommunityChange",this._onCommunityChange.bind(this)),this._onCommunityChange(),this},isTemplateFeatureEnabled(){return this._isTemplateFeatureEnabled},_isCommunityContext(){return!(!this._context.isCommunityContext()||this._context.isDirectMessageContext())||(!this._context.isCommunityContext()||!this._context.isDirectMessageContext())&&void 0},notifyTemplateAvailability(e){const t=this._isCommunityContext();if(t&&this._collectionTemplates&&this._collectionTemplates.hasBeenFetched())if(this._availableTemplates.length>0){const t=this._typesManager.getCurrentContentType(),i=this._availableTemplates.filter(e=>t===e.contentType);i.length>0?this.dispatchEvent("templateAvailable",[{template:i[0],wikiEditorView:e}]):this.dispatchEvent("noTemplateAvailable")}else this.dispatchEvent("noTemplateAvailable");else t||(this._resetTemplatesData(),this.dispatchEvent("noTemplateAvailable"))},getWikiTemplate(){let e;return this._availableTemplates.length>0&&(e=this._availableTemplates.find(e=>"wiki"===e.contentType)),e},_onCurrentContentTypeChange(){this._checkPermissionContentTypeChange()&&this.notifyTemplateAvailability()},_checkPermissionContentTypeChange(){return this._isCommunityContext()&&this._isTemplateFeatureEnabled&&this._availableTemplates.length>0},_onCommunityChange(){this._checkTemplateFeatureEnabled().then(e=>{this._availableTemplates=[],this._isTemplateFeatureEnabled=e,e?this._lookForTemplates():this.notifyTemplateAvailability()})},_checkTemplateFeatureEnabled(){const e=this._isCommunityContext()?this._context.isCommunityContext():null;return new Promise((t,i)=>{let n=!1;e?new o({mid:e},{autoPopulate:!0,onPopulate(e){n=!(!e.isBusinessExperienceCommunity()||!e.canSupportTemplate()),t(n)},onFailure(){t(n=!1)}}):t(n=!1)}).then(e=>e)},_lookForTemplates(){return this._collectionTemplates=new i([],{communityId:this._context.isCommunityContext(),mode:"getTemplates",limit:30}),new Promise((e,t)=>{this._collectionTemplates.fetchPage(1,{onComplete:t=>{t.length>0&&t.forEach(e=>{e.populateEmbeddedMediaAssociation(),this._availableTemplates.push({title:e.get("title"),content:e.get("message"),contentType:e.get("derived_type")?e.get("derived_type").id:e.getCurrentTypeMapping(e.get("content_type")),derivedType:e.get("derived_type")})}),e()},onFailure:e=>{t(e)}})}).then(()=>{this._availableTemplates.length>0?this.notifyTemplateAvailability():this._isTemplateFeatureEnabled=!1})},_resetTemplatesData(){this._isTemplateFeatureEnabled=!1,this._availableTemplates=[],this._collectionTemplates=null}});return r.getInstance=(()=>(null==a&&(a=new r),a)),r}),define("DS/SwymUIComponents/script/feature/community/survey/view/question-view",["UWA/Core","DS/SwymUIComponents/script/feature/community/content/utils/content-renderer","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/community/content/view/content-body-view","DS/SwymUICore/script/feature/community/survey/model/question-model"],function(e,t,i,n,o){return i.extend({_modelEventsForAutoRefresh:["onChange"],_modelClass:o,_createContent:function(){var i=this.model,n=i.get("description",{escapeHTML:!1}),o=t.getInstance().render(n,{createMediaView:!1}),s=this.addChildView("contentMediaDisplayManager",{Class:"DS/SwymUIComponents/script/feature/community/media/view/simple-content-media-view",contentAttributeInModel:"description",model:i,widget:this._widget});return e.createElement("div",{class:"content-body",html:[{html:o},{html:s}]})}})}),define("DS/SwymUIComponents/script/feature/community/social-event/view/topic-editor-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/UIKIT/Input/Text","DS/SwymUIComponents/script/feature/core/search/view/user-search-factory","DS/SwymUICore/script/feature/core/context/context-model","DS/UIKIT/Input/Button","DS/SwymUIComponents/script/feature/community/social-event/view/pres-support-editor-collection-view","DS/SwymUIComponents/script/feature/community/media/edit/upload/media-upload-queue","DS/UIKIT/Input/Select","DS/SwymUIComponents/script/feature/community/content/view/simple-editor-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/social-event/social-event-view"],function(e,t,i,n,o,s,a,r,l,c,d){"use strict";return t.extend({_modelEvents:{onChange:"refresh",onVirtualChange:"contentChanged"},domEvents:{"change .title-edit-input":"onTitleChange","click .topic-delete-button":"onDeleteTopic","click .fonticon-expand-right":"toggleTopic","click .fonticon-expand-down":"toggleTopic","click .topic-header":"toggleTopic","click .topic-down":"descendTopic","click .topic-up":"ascendTopic","click .pres-supports-actions .fonticon-search":"onSearchClick","click .pres-supports-actions .fonticon-link-add":"onPresentationLinkAdd","click .clear-search":"_resetSearch"},name:"topic-editor-view",isInvalid:!1,setup:function(e){const t=this;this._context=o.getInstance(),this.isRitualsContext=this._context.path.contains("rituals"),this.addChildView("PresSupportEditorCollectionView",new a({collection:this.model.getAssociated("presentationSupports")})),this.addChildView("descriptionRte",new c({className:"topic-description-rte",mandatory:!1,useFocusStyle:!0,modelAttr:"description",model:this.model})),this.addControl("duration-select",new l({placeholder:"",className:"duration-select",multiple:!1,options:[{value:"5"},{value:"10"},{value:"15"},{value:"20"},{value:"25"},{value:"30"},{value:"35"},{value:"40"},{value:"45"},{value:"50"},{value:"55"},{value:"60"},{value:"65"},{value:"70"},{value:"75"},{value:"80"},{value:"85"},{value:"90"},{value:"95"},{value:"100"},{value:"105"},{value:"110"},{value:"115"},{value:"120"}],events:{onChange:function(e){t.model.addChanges("duration",parseInt(e.target.value))}}})),this._parent.apply(this,arguments)},getRTEContent:function(){let e=this.getChildView("descriptionRte")&&this.getChildView("descriptionRte").getElement(".editable-container"),t="";return e&&(t=e.getHTML().replace(/\u200B/g,"").replace(/(\u00A0|&nbsp;)(?!$)(?!<br>)(?!<\/)/g," ")),t},onSearchClick:function(){this.getControl("pres-support-search-input").classList.toggle("hidden")},onPresentationLinkAdd:function(){this.model.addEmptyPresentationSupport({source:"",type:"url"})},onTitleChange:function(e){const t=e.target.value;""!==t&&this.isInvalid&&this.getElement(".title-edit-input").removeClassName("invalid"),this.container.querySelector(".topic-title-preview").innerHTML=t,this.model.addChanges("title",t)},onDeleteTopic:function(){this.dispatchEvent("onTopicRemove",this),this.model.destroy()},toggleTopic:function(e){const t=e.target.classList;if(!(t.contains("topic-up")||t.contains("topic-down")||t.contains("topic-delete-button"))){const e=this.model.isCollapsed();this.model.setCollapsed(!e)}},validateContent:function(){const e=this.getElement(".title-edit-input"),t=""!==e.value;return t?(e.removeClassName("invalid"),this.isInvalid=!1):(e.addClassName("invalid"),this.isInvalid=!0),t},getContentAttributes:function(){const t=this.model;let i=t.toJSON();if(i){const n=t.getAssociated("presentationSupports");i.presentation_supports=n.map(e=>Object.assign(e.toJSON(),e.getChanges()))||[],e.extend(i,t.getChanges()),i.description=this.getRTEContent(),i.speakers&&(i.speakers=i.speakers.map(e=>e.login))}return i},ascendTopic:function(){this.model.collection.ascendTopic(this.model)},descendTopic:function(){this.model.collection.descendTopic(this.model)},_createUserSearch:function(e){const t=this,i={community_id:o.getInstance().communityId,restricted:!0,mailAllowed:!0,disableUserGroup:!0,multiSelect:!0,itemMultiSelect:!1,parentSwymView:this,events:{onSelect:function(){t._setTopicSpeakers(this.selectedItems)},onUnselect:function(){t._setTopicSpeakers(this.selectedItems)}}};return n.createUserSearchControl(i)},_resetSearch:function(){const e=this.getControl("search-input");this.getControl("clear-search-icon").getContent().addClassName("hidden"),e.setValue("")},_setTopicSpeakers(e){const t=e.map(e=>({login:e.login,first_name:e.first_name||e.nickname.split(" ")[0],last_name:e.last_name||e.nickname.split(" ")[1]}));this.model.addChanges("speakers",t)},_createProtocolContentTemplate:function(){const t=this,n=this._createUserSearch("speakers"),o=this.model;let a=o.get("speakers")||o.getChanges("speakers");a&&a.length&&(a.map(e=>{"object"==typeof e&&(e.value=e.first_name+" "+e.last_name,e.selected=!0)}),n.addItems(a,n.getDataset()));const r=this.model.isCollapsed(),l=this.addControl("topic-title-preview",e.createElement("div",{class:"topic-title-preview",tag:"span",html:this.model.getChanges("title")||this.model.get("title")||""}));let c;if(!this.isRitualsContext){const n=this.addControl("search-input",new i({className:"contenturl-edit-input",placeholder:"Search for a media",events:{onKeyDown:function(e){setTimeout(function(){let i=e.srcElement.value.trim().length,n=e.key,o=t.getControl("clear-search-icon").getContent();i>0?("Enter"===n&&t.getControl("search-icon").getContent().click(),o.removeClassName("hidden")):o.addClassName("hidden")},1)}}})),o=this.addControl("search-icon",new s({className:"input-button-right-part",icon:"search",events:{onClick:()=>{const e=n.getValue();this.dispatchEvent("onPresentationSupportSearch",[this.model.cid,e])}}})),a=this.addControl("clear-search-icon",new s({className:"clear-search input-button-right-part hidden",icon:"clear"}));c=this.addControl("pres-support-search-input",e.createElement("div",{class:"pres-support-search-input hidden",html:[n,a,o]}))}const m=this.getControl("duration-select"),u=o.get("duration");return u>0&&m.select(u.toString()),[e.createElement("div",{class:"topic-header",html:[{class:"position",tag:"span",html:this.model.get("position")+""},{class:"topic-collapse fonticon "+(r?"fonticon-expand-right":"fonticon-expand-down"),tag:"span"},l,{class:"up-down-buttons",html:[this.model.collection&&this.model.collection.length>1?{class:"topic-up fonticon fonticon-chevron-up"+(1===this.model.get("position")?" disabled":""),tag:"span"}:{},this.model.collection&&this.model.collection.length>1?{class:"topic-down fonticon fonticon-chevron-down"+(this.model.get("position")===this.model.collection.length?" disabled":""),tag:"span"}:{}]},{class:"topic-delete-button fonticon fonticon-clickable fonticon-trash",tag:"span"}]}),e.createElement("div",{class:"topic-body "+(r?"hidden":""),html:[{class:"topic-content",html:[{class:"section-label",html:`<span>${d.Title}</span>`},{class:"title-input",html:new i({className:"title-edit-input",value:this.model.getChanges("title")||this.model.get("title")||"",placeholder:d.TopicTitlePlaceholder})}]},{class:"topic-content",html:[{class:"section-label description-label",html:`<span>${d.Description}</span>`},{class:"topic-description",html:this.getChildView("descriptionRte")}]},{class:"topic-content",html:[{class:"section-label pres-supports-label",html:`<span>${d.PresentationSupport_s}</span>`},{class:"pres-supports-wrapper",html:[{class:"pres-supports-actions",html:[this.isRitualsContext?null:{tag:"span",class:"fonticon fonticon-clickable fonticon-search"},{tag:"span",class:"fonticon fonticon-clickable fonticon-link-add"}]},{class:"pres-supports-body",html:[this.isRitualsContext?null:c,this.getChildView("PresSupportEditorCollectionView")]}]}]},{class:"topic-content",html:[{class:"section-label",html:`<span>${d.Speakers}</span>`},{class:"speakers-autocomplete",html:n}]},{class:"topic-content",html:[{class:"section-label",html:`<span>${d.Duration}</span>`},{class:"duration-select",html:[m,{tag:"span",html:`<span>${d.Minutes}</span>`}]}]}]})]},_createContent:function(){return{tag:"div",class:"topic-wrapper",html:[this._createProtocolContentTemplate()]}}})}),define("DS/SwymUIComponents/script/feature/community/social-event/view/topic-editor-collection-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUICore/script/feature/community/social-event/collection/topic-collection","DS/SwymUIComponents/script/feature/community/social-event/view/topic-editor-view","DS/SwymUIComponents/script/feature/community/community/view/proxy-search-widget","DS/SwymUICore/script/feature/community/social-event/model/pres-support-model","DS/SwymUICore/script/feature/core/context/context-model"],function(e,t,i,n,o,s,a){"use strict";return t.extend({_collectionClass:i,modelViewClass:n,_collectionEvents:{onChange:"_onContentChanged",onRemove:"_onRemove",onAdd:"_onTopicViewModeChanged",onTopicViewModeChange:"_onTopicViewModeChanged"},bodyAttributes:{tag:"div",class:"topics-editor"},setup:function(e){this._context=a.getInstance(),this.isRitualsContext=this._context.path.contains("rituals"),this.isRitualsContext||(this._widget=e.widget,this.proxySearch=new o({widget:this._widget})),this._parent.apply(this,arguments)},_createModelView:function(){var e=this._parent.apply(this,arguments);return this.isRitualsContext||e.addEvent("onPresentationSupportSearch",this.searchPres,this),e},searchPres:function(e,t){const i=this;this.proxySearch.activate({title:"Search results",widget_id:this._widget&&this._widget.id,default_search_criteria:t||"",precond:'(\n\t\t\t\t\t\t([ds6w:type]:"swym:Post") \t\tOR \n\t\t\t\t\t\t([ds6w:type]:"swym:Question") \tOR \n\t\t\t\t\t\t([ds6w:type]:"swym:Media") \t\tOR \n\t\t\t\t\t\t([ds6w:type]:"swym:Idea") \t\tOR \n\t\t\t\t\t\t([ds6w:type]:"swym:Wiki")\t\tOR \n\t\t\t\t\t\t([ds6w:type]:"DriveFile")\n\t\t\t\t\t)',source:["swym","drive"],multiSel:!1,excluded_types:null,callback:t=>{if(console.log(t),t.length){const n=t[0];let o="",a="",r=n.resourceid;n.hasOwnProperty("ds6w:dataSource_value")?a=n["ds6w:dataSource_value"]:n.hasOwnProperty("ds6w:type")&&(a=n["ds6w:type"]),o="string"==typeof a?a:a[0],"Dashboard"===a?r=`dashboard:${r}`:n["ds6w:type_value"].contains("WeDo")&&(r=`wedo:${r}`);const l=new s({id:r,source:o,type:n["ds6w:type_value"],preview_url:n.preview_url,label:n["ds6w:label"]},{});i.collection&&i.collection._models&&i.collection._models.find(t=>t.cid===e).getAssociated("presentationSupports").add(l)}}})},modelViewsCfg:function(){return{widget:this._widget}},_onRemove:function(e){this.dispatchEvent("onTopicRemove")},reset(e){e?this.collection.reset(e.get("topics")):(this.collection.reset(),this.collection.add({position:1}))},getContentAttributes:function(){let e=null,t=[];for(e in this._childViews)this._childViews.hasOwnProperty(e)&&t.push(this._childViews[e].getContentAttributes());return t},_onTopicViewModeChanged:function(){this.dispatchEvent("onTopicViewModeChange")},_onContentChanged:function(){let e=null;for(e in this._childViews)this._childViews.hasOwnProperty(e)&&this._childViews[e].refresh()}})}),define("DS/SwymUIComponents/script/feature/community/idea/view/pipeline-manager",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/idea/collection/idea-collection","DS/SwymUICore/script/feature/community/idea/collection/idea-derived-type-collection","DS/SwymUICore/script/feature/community/idea/collection/status-collection","DS/SwymUICore/script/feature/community/idea/model/idea-type-model","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/lib/model/model-manager","DS/SwymUICore/script/feature/community/derived-type/derived-type-data-utils","DS/SwymUIComponents/script/feature/community/idea/view/pipeline-view","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/community/community/model/community-model","DS/Logger/Logger"],(e,t,i,n,o,s,a,r,l,c,d,m,u)=>{const h=a.getInstance();return t.extend({name:"idea-home-view",_refreshEvents:["onSort","onReset","onRemove"],_height:130,_className:"status",_outClickable:!1,_communityId:null,_statusCollection:null,_fullIdeaCollectionInstance:null,_ideaTypeModel:null,_configPipelineView(){return{height:this._height,heightDiff:this._height/4,className:this._className,outClickable:this._outClickable,curveColor:this._curveColor,containerId:this.cid,statusCollection:this._statusCollection,collectionEventsForAutoRefresh:this._refreshEvents,legend:!0}},init(){return h.addListener("onContextChange",this._onContextChange,this,!1),this._parent.apply(this,arguments)},_initPipeline(){let e,t;if(this.taggingContextManager&&(e=this.taggingContextManager.getActiveProxiesManagers()))for(t in e){Object.prototype.hasOwnProperty.call(e,t)&&this.onTaggerFilteringRequest(e[t].getActiveFilters());break}},_resizeCallbackDebounced:null,_zoomIdeaStatusCallback:null,_createContent(){return{class:"svg-pipeline",styles:{flex:"0 0 auto",margin:"0px 10px"},html:this.getChildView("pipelineView")}},_resetIdeaCollection(){const e=this;this._fullIdeaCollectionInstance&&this._fullIdeaCollectionInstance.resetCollection(1,{serviceName:"read",onComplete(){e.dispatchEvent("onTotalIdeasChanged",e._countNbIdeas())}})},_onPublishing(e){try{let t,i=!1,n=!1;this._fullIdeaCollectionInstance&&e instanceof this._fullIdeaCollectionInstance.model&&(i=!0,(t=this._fullIdeaCollectionInstance.communityId)?e.get("community->mid")===t&&(n=!0):n=!0),!0===i&&!0===n&&this._resetIdeaCollection()}catch(e){return!1}},onTaggerFilteringRequest(){const e="ds6w:what/ds6w:status",t=this.getChildView("pipelineView");let i,n,o,s,a,r;if(this.taggingContextManager){for(i in this.taggingContextManager._activeProxiesManagers)break;r=(a=(s=this.taggingContextManager._activeProxiesManagers[i]._proxy.getCurrentFilter()).allfilters)&&Object.prototype.hasOwnProperty.call(a,e)&&a[e],(n=r)&&t?(o=t.statusCollection&&t.statusCollection.find(e=>n&&e.get("title").unescapeHTML()===n[0].object))&&t.zoom!==o.get("status_nb")&&t._zoomStatus(t,o?o.get("status_nb"):0).call():t.zoom>0&&t._zoomStatus(t,0).call()}},_resetFullIdeaCollection(e){this._fullIdeaCollectionInstance=new n([],{communityId:this._communityId,typeId:e,limit:30*Math.max(this._statusCollection.length,1),mode:"exalead-filtered-idea-derived-type"}),this._fullIdeaCollectionInstance.fetch({onComplete:()=>{const e=this.getChildView("pipelineView");e.setIdeaCollection(this._fullIdeaCollectionInstance),e.setup({widget:this._widget,config:this._configPipelineView()}),e.refresh()},onFailure:()=>{u.error("Failed to fetch idea derived type contributions")}})},_onContextChange(){let e=null,t=null;const i=h.getCommunityDerivedTypePipelinePageContext();if(i){const n=l.getDerivedTypeNameFromCommunityPipelinePageName(i);if(e=this.currentIdeaDtId,t=n&&l.getDerivedTypeIdFromDerivedTypeName(n),e&&t&&e!==t){const e=new m({mid:this._communityId}).get("derivedTypes");if(e){const i=e.find(e=>e.id===t);this._ideaTypeModel=new s({label:i.label,icon:i.icon,color:i.color,id:i.id,parent:i.parent,communityId:this._communityId}),this._statusCollection=this._ideaTypeModel.getStatusCollection(),this._resetFullIdeaCollection(i.id),this.currentIdeaDtId=t}}}},setup(t){const o=this;let a,m,u,p,g,w,C;const f=this._parent.apply(this,arguments);let y;if(this.taggingContextManager=t.taggingContextManager,this.getChildView("pipelineView")||this.addChildView("pipelineView",new c),this.model&&this.model.get("mid")&&this._communityId!==this.model.get("mid")){this._communityId=this.model.get("mid");const c=h.getCommunityDerivedTypePipelinePageContext();if(c&&(g=l.getDerivedTypeIdFromCommunityPipelinePageName(c),C=(w=this.model.get("derivedTypes"))&&g&&w.find(e=>e.id===g)),this.currentIdeaDtId=g,C?(this._ideaTypeModel=new s({label:C.label,icon:C.icon,color:C.color,id:C.id,parent:C.parent,communityId:this._communityId}),m=n,u="exalead-filtered-idea-derived-type"):(this._ideaTypeModel=new s({parent:"COMMUNITY",communityId:this._communityId}),m=i,u="community-full-list"),this._statusCollection=this._ideaTypeModel.getStatusCollection(),this._fullIdeaCollectionInstance=new m([],{mode:u,communityId:this._communityId,contentTypeName:this._ideaTypeModel.get("name"),limit:30*Math.max(this._statusCollection.length,1),fetchTagsSeparatelyOnRefresh:!1}),this._fullIdeaCollectionInstance.fetch(),this.getChildView("pipelineView").setup({widget:this._widget,config:this._configPipelineView()}),t.taggingContextManager&&(a=t.taggingContextManager.getActiveProxiesManagers()))for(p in a)if(Object.prototype.hasOwnProperty.call(a,p)){a[p].getClient()&&a[p].getClient().addEvent("onServerFilteringRequest",o.onTaggerFilteringRequest,o),this.listenTo(a[p],"onClientChange",e=>{e.addEvent("onServerFilteringRequest",o.onTaggerFilteringRequest,o)});break}return y=function(){const e=this.getChildView("pipelineView");if(!e.isDestroyed()){e.refresh();const{zoom:t}=e;e.zoom=0,e._zoomStatus(e,t)(),e.out&&(e.out=!1,e._viewOut())}},this._resizeCallbackDebounced=d.debounce(y.bind(this),800),window.addEventListener("resize",this._resizeCallbackDebounced),t.taggingContextManager&&(this._zoomIdeaStatusCallback=function(i){let n;for(n in t.taggingContextManager._activeProxiesManagers)break;const o=[];let s;if(i)if(i.status_title?(s=e.createElement("div",{html:i.status_title}).getText(),o.push({object:s,type:"string"})):i.out&&(s="ds6w:status.swym_inactive",o.push({object:s,type:"string"})),o.length>0){let i;e.is(t.taggingContextManager._activeProxiesManagers[n]._proxy.getCurrentFilter().localfilters)&&(i=t.taggingContextManager._activeProxiesManagers[n]._proxy.getCurrentFilter().localfilters["ds6w:what/ds6w:status"]),(!i||i&&i[0].object!==s)&&t.taggingContextManager._activeProxiesManagers[n]._proxy.setLocalFilter({"ds6w:what/ds6w:status":o})}else{const e=t.taggingContextManager._activeProxiesManagers[n]._proxy.getCurrentFilter().localfilters;e&&delete e["ds6w:what/ds6w:status"],t.taggingContextManager._activeProxiesManagers[n]._proxy.clearLocalFilter(!e),e&&t.taggingContextManager._activeProxiesManagers[n]._proxy.setLocalFilter(e)}},this.listenTo(this.getChildView("pipelineView"),"ZoomIdeaStatus",this._zoomIdeaStatusCallback)),new Promise(e=>{this._statusCollection.hasBeenFetched()?e():this._statusCollection.addEventOnce("onSync",e)}).then(()=>{this._ideaTypeModel.getNbIdeasPerStatus({onComplete(){o._onStatusCollectionFetch()}})}),r.addListenerOnPublishing(this._onPublishing),r.addListenerOnDestroy(this._resetIdeaCollection),f}},_countNbIdeas(){let e=0;return this._statusCollection.forEach(t=>{e+=t.get("nb_ideas")}),e},_onStatusCollectionFetch(){this.getChildView("pipelineView").refresh(),this.getChildView("pipelineView").mask(),this._fullIdeaCollectionInstance.hasBeenFetched()?(this.dispatchEvent("onTotalIdeasChanged",this._countNbIdeas()),this._fullIdeaCollectionInstance.collectionPostProcess(this._statusCollection),this.getChildView("pipelineView").setIdeaCollection(this._fullIdeaCollectionInstance),this._initPipeline(),this.getChildView("pipelineView").unmask()):this._fullIdeaCollectionInstance.addEventOnce("onSync",()=>{this.dispatchEvent("onTotalIdeasChanged",this._countNbIdeas()),this._fullIdeaCollectionInstance.collectionPostProcess(this._statusCollection),this.getChildView("pipelineView").setIdeaCollection(this._fullIdeaCollectionInstance),this._initPipeline(),this.getChildView("pipelineView").unmask()})},onDestroy(){return r.removeListenerOnPublishing(this._onPublishing.bind(this)),r.removeListenerOnDestroy(this._resetIdeaCollection.bind(this)),window.removeEventListener("resize",this._resizeCallbackDebounced),this.stopListening(this.getChildView("pipelineView"),"ZoomIdeaStatus",this._zoomIdeaStatusCallback),this._parent.apply(this,arguments)},onHide(){return window.removeEventListener("resize",this._resizeCallbackDebounced),this.stopListening(this.getChildView("pipelineView"),"ZoomIdeaStatus",this._zoomIdeaStatusCallback),this._parent.apply(this,arguments)},onShow(){return window.addEventListener("resize",this._resizeCallbackDebounced),this.listenTo(this.getChildView("pipelineView"),"ZoomIdeaStatus",this._zoomIdeaStatusCallback),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/idea/view/idea-pipeline-modal",["DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUIComponents/script/feature/core/modal/modal","DS/SwymUIComponents/script/feature/community/idea/view/pipeline-manager","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/context/context-model","i18n!DS/SwymUIComponents/assets/nls/feature/community/idea/view/pipeline-view"],function(e,t,i,n,o,s){"use strict";return e.extend({_modal:null,init:function(e){var a=this,r="object"==typeof e?e:{communityId:e},l=r.communityId;this._parent.call(this,r),this._modal=this.addControl("modal",new t({className:"ideas-pp-modal",header:s.get("IdeasPipeline"),body:a.addChildView("ideaHomeView",new i({addScroller:!0,model:new n({mid:l}),taggingContextManager:r.taggingContextManager,events:{onTotalIdeasChanged:function(e){a._modal.setHeader("<h4>"+s.get("IdeasPipeline")+'<span class="counter">'+e+"</span></h4>")}}}))})),o.getInstance().addOnce("onContextChange",a.destroy,a,!1)},show:function(){this._modal&&this._modal.show()},hide:function(){this._modal&&this._modal.hide()},destroy:function(){return this.removeControl("modal"),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/ritual/edit/ritual-advanced-editor",["UWA/Core","DS/SwymUIComponents/script/feature/community/content/edit/content-editor-body-view-with-advanced-rte","DS/SwymUIComponents/script/feature/community/social-event/edit/external-users-edit-view","DS/SwymUIComponents/script/feature/community/social-event/view/topic-editor-collection-view","DS/SwymUIComponents/script/feature/community/social-event/edit/oauth-provider-manager","DS/SwymUIComponents/script/feature/community/social-event/edit/visio-provider-editor-view","DS/SwymUICore/script/feature/community/ritual/model/ritual-model","DS/SwymUIComponents/script/utils/swym-vue","DS/UWPClientCode/I18n","i18n!DS/SwymUIComponents/assets/nls/feature/community/ritual/ritual-view","DS/UWPClientControls/PlatformNotify","css!vuekit/vu-kit"],function(e,t,i,n,o,s,a,r,l,c,d){const{Vue:m}=r,u=m.extend({data:()=>({i18n:c,topicsMode:"expanded",options:{min_date:new Date(Date.now()-864e5),every_weekday:[{value:!0,label:c.EveryWeekday}],weeks:[{value:1,label:c.First},{value:2,label:c.Second},{value:3,label:c.Third},{value:4,label:c.Quarter},{value:5,label:c.Last}],frequencies:[{value:"daily",label:c.Daily},{value:"weekly",label:c.Weekly},{value:"monthly",label:c.Monthly},{value:"yearly",label:c.Yearly}]},validation:{hasTimeError:!1,hasDurationError:!1},model:{frequency:"daily",every_weekday:!1,every_n_times:1,days_of_week:[1],day_of_week:1,nth_day_of_month:1,month_of_year:1,start_date:new Date((new Date).toISOString().split("T")[0]),end_date:new Date(new Date((new Date).toISOString().split("T")[0]).setMonth((new Date).getMonth()+6)),start_time:`${((new Date).getHours()+1).toString().padStart(2,"0")}:00`,end_time:`${((new Date).getHours()+2).toString().padStart(2,"0")}:00`}}),watch:{"model.start_time":function(){this.$refs.end_time.validate()},"model.start_date":function(){this.$refs.end_date.validate(),this.$refs.start_time.validate()}},methods:{toggleTopicsDisplayMode(e){this.topicsMode=e},validateStartTime(e){const t=new Date,i=t.toISOString().slice(11,16),n=this.createDate(t,i),o=this.createDate(this.model.start_date,e,!1);return!(n.toISOString().slice(0,10)===o.toISOString().slice(0,10)&&o<=n)||c.get("Error_PleaseSelectAValidStartTime")},validateEndTime(){function e(e){var t=e.split(":"),i=parseInt(t[1]/6*10,10);return parseFloat(`${parseInt(t[0],10)}.${i<10?"0":""}${i}`)}const t=e(this.model.start_time),i=e(this.model.end_time);if(t>=i){const e=this.createDate(this.model.start_date,this.model.start_time,!1);return c.get("Error_PleaseSelectAValidEndTime",{time:e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})}return!(i-t<.5)||c.get("Error_PleaseSelectADurationAboveXminutes",{minutes:30})},validateDateRange(){if("yearly"===this.model.frequency)return!0;{const e=new Date(this.model.start_date.getTime()).setMonth(this.model.start_date.getMonth()+12)-864e5;if(this.model.end_date>=e)return c.Error_SchedulingRitualCouldNotExceedOneYear}return!0},createDate(e,t="00:00",i=!0){if(i)return new Date(`${e.toISOString().split("T")[0]}T${t}Z`);const n=new Date(e-6e4*(new Date).getTimezoneOffset());return new Date(`${n.toISOString().split("T")[0]}T${t}`)},toggleSelectDay(e){this.model.days_of_week.includes(e)?this.model.days_of_week=this.model.days_of_week.filter(t=>t!==e):this.model.days_of_week.push(e)},getWeekdayList:(e="short")=>Array.apply(null,Array(7)).map((t,i)=>({value:i+1,label:new Date((new Date).setDate((new Date).getDate()-(new Date).getDay()+i+1)).toLocaleString(l.getCurrentLanguage()||"en",{weekday:e}).replace(".","")})),getMonthNameList(e="long"){const t=new Intl.DateTimeFormat(l.getCurrentLanguage()||"en",{month:e});return Array.apply(null,Array(12)).map((e,i)=>({value:i+1,label:t.format(new Date(Date.UTC(2e3,i,1,0,0,0)))}))}},template:'<vu-form ref="form" class="rituals_advanced-editor-container">\n  <div ref="recurrence"\n    class="rituals_recurrence">\n    <vu-select v-model="model.frequency"\n      :options="options.frequencies"\n      :label="i18n.Recurrence"\n      hide-placeholder-option />\n  </div>\n  <div ref="recurrence_details"\n    class="rituals_recurrence_details_container">\n    <div class="rituals_recurrence_details"\n      v-if="model.frequency === \'daily\'">\n      <vu-checkbox v-model="model.every_weekday"\n        type="switch"\n        :options="options.every_weekday" />\n    </div>\n    <div class="rituals_recurrence_details"\n      v-if="model.frequency === \'weekly\'">\n      <div class="details-row">\n        {{ i18n.Every }}\n        <vu-input type="number"\n          v-model.number="model.every_n_times"\n          min="1"\n          max="99"\n          step="1" /> {{ i18n.Weeks }}\n      </div>\n      <div class="details-row">\n        {{ i18n.On }}:\n        <vu-btn-grp>\n          <vu-btn v-for="day in getWeekdayList()"\n            :class="{\'active\': model.days_of_week.includes(day.value)}"\n            @click="toggleSelectDay(day.value)">\n            {{ day.label }}\n          </vu-btn>\n        </vu-btn-grp>\n      </div>\n    </div>\n    <div class="rituals_recurrence_details"\n      v-if="model.frequency === \'monthly\'">\n      <div class="details-row">\n        {{ i18n.The }}\n        <vu-select v-model="model.nth_day_of_month"\n          hide-placeholder-option\n          :options="options.weeks" />\n        <vu-select v-model="model.day_of_week"\n          hide-placeholder-option\n          :options="getWeekdayList(\'long\')" />\n      </div>\n\t  <div class="details-row">\n\t   {{ i18n.Every }}\n        <vu-input type="number"\n          v-model.number="model.every_n_times"\n          min="1"\n          max="99"\n          step="1" /> {{ i18n.Months }}\n      </div>\n    </div>\n\t<div class="rituals_recurrence_details"\n      v-if="model.frequency === \'yearly\'">\n      <div class="details-row">\n        {{ i18n.The }}\n        <vu-select v-model="model.nth_day_of_month"\n          hide-placeholder-option\n          :options="options.weeks" />\n        <vu-select v-model="model.day_of_week"\n          hide-placeholder-option\n          :options="getWeekdayList(\'long\')" />\n      </div>\n\t  <div class="details-row">\n\t  {{ i18n.Of }}\n\t  <vu-select v-model="model.month_of_year"\n          hide-placeholder-option\n          :options="getMonthNameList(\'long\')" />\n\t   {{ i18n.Every }}\n        <vu-input type="number"\n          v-model.number="model.every_n_times"\n          min="1"\n          max="99"\n          step="1" /> {{ i18n.Years }}\n      </div>\n    </div>\n  </div>\n  <div class="rituals_start-time">\n    <vu-input ref="start_time"\n      v-model="model.start_time"\n      :label="i18n.StartTime"\n      :rules="[validateStartTime]"\n      type="time" />\n  </div>\n  <div class="rituals_end-time">\n    <vu-input ref="end_time"\n      v-model="model.end_time"\n      :label="i18n.EndTime"\n      :rules="[validateEndTime]"\n      type="time" />\n  </div>\n  <div class="rituals_start-date">\n    <vu-input-date ref="start_date"\n      v-model="model.start_date"\n      :label="i18n.StartDate"\n      :min="options.min_date" />\n  </div>\n  <div class="rituals_end-date">\n    <vu-input-date ref="end_date"\n      v-model="model.end_date"\n      :label="i18n.EndDate"\n      :rules="[validateDateRange]"\n      :min="model.start_date" />\n  </div>\n  <div ref="conference_support"\n    class="rituals_conference-support">\n  </div>\n  <div ref="additionnal_attendees"\n    class="rituals_additionnal-attendees">\n    <label class="hide">{{ i18n.AdditionalAttendees }}</label>\n  </div>\n  <div class="rituals_description">\n    <label>{{ i18n.Description }}</label>\n    <div @click.once="$emit(\'focusRTE\')"\n      ref="description">\n    </div>\n  </div>\n  <div class="rituals_topics">\n    <div class="heading">\n      <div class="topics-label">\n        {{ i18n.Topics }} | \n        <span @click="$emit(\'addTopic\')"\n          class="fonticon fonticon-plus fonticon-clickable add-topic-btn" />\n      </div>\n      <div class="topics-view-mode">\n\t  <span v-tooltip.body="i18n.Expand" @click="$emit(\'expandTopics\')"\n\t  :class="{ active: topicsMode === \'expanded\' }"\n\t  class="fonticon fonticon-clickable fonticon-expand-all" />\n\t  <span v-tooltip.body="i18n.Collapse" @click="$emit(\'collapseTopics\')"\n\t\t:class="{ active: topicsMode === \'collapsed\' }"\n\t\tclass="fonticon fonticon-clickable fonticon-collapse-all" />\n      </div>\n    </div>\n    <div ref="topics" />\n  </div>\n</vu-form>'});return t.extend({name:"ritual-advanced-editor",_isProviderActive:!1,setup(){return this._model=new a,this._model.addEmptyTopic(),this._isProviderActive=null!==o.getActivatedConferenceProvider(),this.addControl("topicEditorCollectionView",new n(this._model.getAssociated("topics"))),this.listenTo(this.getControl("topicEditorCollectionView"),{onTopicRemove:()=>{this._model.getAssociated("topics").length||this._model.addEmptyTopic()},onTopicViewModeChange:this.refreshTopicsDisplayMode.bind(this)}),this.addControl("extUsersEditView",new i({model:this._model})),this._parent.apply(this,arguments)},refreshContent(e){this._model.set(e),this.refresh()},_createContent(){const e=this._parent.apply(this,arguments);return this._isProviderActive&&!this.getChildView("visioProviderEditorView")&&this.addChildView("visioProviderEditorView",{Class:s}),this._view=new u,this._view.$mount(),this._view.$on("addTopic",()=>{this._model.addEmptyTopic()}),this._view.$on("focusRTE",()=>{"true"!==this.getRTEView().getElement(".editable-container").getAttribute("contenteditable")&&(this.getRTEView().getElement(".editable-container").setHTML("<p><br></p>"),this.getRTEView().getElement(".editable-container").setAttribute("contenteditable",!0),this.getRTEView().setFocus())}),this._view.$on("collapseTopics",()=>{this.toggleTopicsDisplayMode(!0)}),this._view.$on("expandTopics",()=>{this.toggleTopicsDisplayMode()}),this._isProviderActive&&this.getChildView("visioProviderEditorView").inject(this._view.$refs.conference_support),this.getControl("extUsersEditView").inject(this._view.$refs.additionnal_attendees),this.getControl("topicEditorCollectionView").inject(this._view.$refs.topics),UWA.createElement("div",{html:e}).inject(this._view.$refs.description,"top"),[{class:"ritual-editor",html:[this._view.$el]}]},toggleTopicsDisplayMode(e){const t=this.getControl("topicEditorCollectionView").collection;e?t.collapseAll():t.expandAll()},refreshTopicsDisplayMode(){const e=this.getControl("topicEditorCollectionView").collection,t=e.every(e=>e.isCollapsed()),i=e.every(e=>!e.isCollapsed());t?this._view.toggleTopicsDisplayMode("collapsed"):i?this._view.toggleTopicsDisplayMode("expanded"):this._view.toggleTopicsDisplayMode("")},getContentAttributes(){if(!this.isRendered())return{};const{content:t}=this._parent.apply(this,arguments)||{},i={recurrence:{},provider:null},n=e.clone(this._view.model);return i.topics=this.getControl("topicEditorCollectionView").getContentAttributes(),i.external_users=this.getControl("extUsersEditView").getExternalUsersArray().join(","),this._isProviderActive&&(i.provider=this.getChildView("visioProviderEditorView").getConferenceProvider()),i.start_date=this._getScheduleDate(n.start_date,n.start_time),i.end_date=this._getScheduleDate(n.end_date,n.end_time),i.duration=this._getDuration(new Date(i.start_date),new Date(this._getScheduleDate(new Date(i.start_date),n.end_time))),"daily"===n.frequency?i.recurrence.every_weekday="true"===n.every_weekday:"weekly"===n.frequency?i.recurrence.days_of_week=n.days_of_week:"monthly"===n.frequency?(i.recurrence.nth_day_of_month=n.nth_day_of_month,i.recurrence.days_of_week=[n.day_of_week]):"yearly"===n.frequency&&(i.recurrence.nth_day_of_month=n.nth_day_of_month,i.recurrence.days_of_week=[n.day_of_week],i.recurrence.every_n_times=n.every_n_times,i.recurrence.month_of_year=n.month_of_year),"daily"!==n.frequency&&(i.recurrence.every_n_times=n.every_n_times),i.recurrence.frequency=n.frequency,i.description=t||"",i},validateContent(){let e=!0;return this._isProviderActive&&this.getChildView("visioProviderEditorView")&&this.getChildView("visioProviderEditorView").getConferenceProvider()?e=(e=Object.values(this.getControl("topicEditorCollectionView")._childViews).every(e=>e.validateContent()))&&this._view.$refs.form.validate():(d.error(c.NoProviderEnabledInRituals),!1)},_getScheduleDate(e,t){let[i,n]=t.split(":");return!(!e||!t)&&(e.setHours(i),e.setMinutes(n),e.setSeconds(0),e.toISOString().slice(0,-5)+"Z")},_getDuration(e,t){const i=t.getTime()-e.getTime();return Math.floor(i/1e3/60)},resetContent(){this.refresh(),this.getControl("topicEditorCollectionView").collection.reset(),this.getControl("topicEditorCollectionView").collection.add({position:1}),this.getControl("extUsersEditView").reset(),this._parent(arguments)}})}),define("DS/SwymUIComponents/script/feature/community/social-event/edit/social-event-advanced-editor",["UWA/Core","DS/SwymUIComponents/script/feature/community/content/edit/content-editor-body-view-with-advanced-rte","DS/SwymUIComponents/script/feature/community/social-event/edit/social-event-common-editor","DS/UIKIT/Input/Button","DS/UIKIT/Tooltip","DS/SwymUIComponents/script/feature/core/search/view/user-search-factory","DS/SwymUIComponents/script/feature/community/social-event/view/topic-editor-collection-view","DS/SwymUICore/script/feature/community/social-event/model/social-event-model","i18n!DS/SwymUIComponents/assets/nls/feature/community/social-event/social-event-view","DS/UIKIT/Input/Toggle","DS/SwymUICore/script/feature/core/context/context-model"],function(e,t,i,n,o,s,a,r,l,c,d){"use strict";return t.extend({name:"social-event-advanced-editor",domEvents:{"click .add-topic-btn":"onAddButtonClick","click .topics-view-mode .fonticon":"onTopicsViewModeChange"},contentChanged:function(){this.dispatchEvent("onContentChange")},onTopicsViewModeChange:function(e){let t=this._getModel(),i=e&&e.target&&e.target.classList;i&&!i.contains("selected")&&(i.contains("fonticon-collapse-all")?t.getAssociated("topics").collapseAll():t.getAssociated("topics").expandAll(),this.refreshTopicsDisplayMode())},refreshTopicsDisplayMode:function(){const e=this._getModel().getAssociated("topics")._models.map(e=>e.isCollapsed()),t=e.every(e=>e),i=e.every(e=>!e);this.container.querySelector(".fonticon-expand-all").classList.remove("active"),this.container.querySelector(".fonticon-collapse-all").classList.remove("active"),t?this.container.querySelector(".fonticon-collapse-all").classList.add("active"):i&&this.container.querySelector(".fonticon-expand-all").classList.add("active")},onAddButtonClick:function(){let e=this._getModel();e.addEmptyTopic(),e.getAssociated("topics").dispatchEvent("onChange"),this.refreshTopicViewMode()},setup:function(e){if(this.scribe="",this._widget=e.widget,this.addChildView("socialEventCommonEditor",{Class:i,model:this.model||null}),this.model)this.addControl("topicEditorCollectionView",new a({collection:this.model.getAssociated("topics"),widget:this._widget})),this.model.getAssociated("topics").resetCollapseStates();else{let e=this._getModel();this.addControl("topicEditorCollectionView",new a({collection:e.getAssociated("topics"),widget:this._widget}))}return this.listenTo(this.getControl("topicEditorCollectionView"),{onContentChange:this.contentChanged.bind(this),onTopicViewModeChange:this.refreshTopicsDisplayMode.bind(this),onTopicRemove:this.refreshTopicViewMode.bind(this)}),this._context=d.getInstance(),this._parent.apply(this,arguments)},refreshContent(e){let t=this._getModel();this._parent.apply(this,arguments),t.set(e),this.getChildView("socialEventCommonEditor").refreshContent(e),this.refresh()},refreshTopicViewMode:function(){const e=this._getModel()&&this._getModel().getAssociated("topics"),t=this.container.getElement(".topics-view-mode");if(e&&t){const i=t.classList,n=i&&i.contains("hidden");e.length&&n?i.remove("hidden"):0!==e.length||n||i.add("hidden")}},resetContent(){this.destroy()},_getModel(){return this.model?this.model:(this.temporaryModel||(this.temporaryModel=new r,this.temporaryModel.addEmptyTopic()),this.temporaryModel)},_createContent:function(){const t=this._parent.apply(this,arguments),i=this.getChildView("socialEventCommonEditor");this._buildTemplate();const n=i.getControl("extUsersEditView");return[{class:"social-event-editor",html:[i,this._scribeEl,e.createElement("div",{html:[{tag:"div",class:"heading",html:l.Description},t]}),this._protocolEl,n]}]},_buildTemplate(){this.scribeAutocomplete=this._createUserSearch();const t=this._getModel(),i=t&&t.getAssociated("topics");this.model&&this.model.get("scribe")&&this._populateScribeAutocomplete(this.model.get("scribe")),this._scribeEl=e.createElement("div",{tag:"div",class:"scribe",html:[{tag:"div",class:"heading",html:l.Scribe},{class:"scribe-autocomplete",html:this.scribeAutocomplete}]}),this._protocolEl=e.createElement("div",{tag:"div",class:"protocol",html:[{tag:"div",class:"heading",html:[e.createElement("div",{class:"topics-label",html:[l.Protocol," | ",e.createElement("span",{class:"fonticon fonticon-plus fonticon-clickable add-topic-btn"})]}),e.createElement("div",{class:`topics-view-mode ${i&&i.length?"":"hidden"}`,html:[e.createElement("span",{class:"fonticon fonticon-clickable fonticon-expand-all active"}),e.createElement("span",{class:"fonticon fonticon-clickable fonticon-collapse-all"})]})]},this.getControl("topicEditorCollectionView")]}),new o({target:this._protocolEl.querySelector(".fonticon-collapse-all"),body:l.CollapseAll}),new o({target:this._protocolEl.querySelector(".fonticon-expand-all"),body:l.ExpandAll})},getContentAttributes:function(){this._getModel();let t=this._parent.apply(this,arguments)||{},i=this.getChildView("socialEventCommonEditor").getContentAttributes();return e.merge(t,i),t.scribe=this.scribe,t.topics=this.getControl("topicEditorCollectionView").getContentAttributes(),t},validateContent:function(){let e=this._getModel().getAssociated("topics"),t=this.getChildView("socialEventCommonEditor").validateContent();if(e.length){let e=this.getControl("topicEditorCollectionView")._childViews;Object.values(e).forEach(e=>{e.validateContent()||(t=!1)})}return t},_createUserSearch:function(){const e=this,t={mailAllowed:!0,disableUserGroup:!0,multiSelect:!1,itemMultiSelect:!1,parentSwymView:this,events:{onSelect:function(){e._setscribe(this.selectedItems)},onUnselect:function(){e._setscribe(this.selectedItems)}}};return s.createUserSearchControl(t)},_setscribe(e){const t=e.map(e=>e.login);t.length&&(this.scribe=t.toString())},_populateScribeAutocomplete:function(e){e.value=e.first_name+" "+e.last_name,e.selected=!0,this.scribeAutocomplete.addItems(e,this.scribeAutocomplete.getDataset())}})}),define("DS/SwymUIComponents/script/feature/community/survey/view/legacy-survey-view",["UWA/Core","UWA/String","i18n!DS/SwymUIComponents/assets/nls/feature/community/survey/view/survey-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/survey/view/answer-result-view","DS/UWPClientCode/I18n","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/community/survey/view/answer-collection-view","DS/SwymUIComponents/script/feature/community/survey/view/answer-result-collection-view","DS/SwymUIComponents/script/feature/community/survey/view/question-view","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/W3DXComponents/Views/GraphView","DS/UIKIT/Input/Button","DS/UIKIT/Input/Toggle","DS/SwymUICore/script/utils/utils"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p){const g=d.getInstance().isFeatureActivated("activate_export_survey_results");return s.extend({model:null,_el:null,_currentQuestion:null,_currentQuestionPosition:1,_questionView:null,_answersView:null,_userHasAlreadyAnswered:null,_showResultsAfterVote:null,_showResult:null,_canExport:!1,_mode:"view",defaultOptions:{fetchItemOnClick:!0,modelFetchOptions:{},resultMode:"row"},_modelEventsForAutoRefresh:["onSync:read","onSync:update","onChange:questions","onChange:endHour","onChange:endDate"],domEvents:{"click .prev-button":"onPrevButtonClick","click .next-button":"onNextButtonClick","click .survey-save-button":"onSaveButtonClick","click .export-button":"onExportButtonClick","click .see-results":"onSeeResultsAndCancelClick","change .answer-checkbox":"onCheckboxChange"},_getResultSeries:function(e){var i=[];return e.forEach(function(e){var o=1===parseInt(e.get("is_open"),10);i.push([t.unescapeHTML(o?n.OpenAnswers:e.get("description")),parseFloat(e.getRoundedPercentage())])}),i},_createContent:function(){var t,n=this,o=this.model;if(this._userHasAlreadyAnswered=null,this._showResultsAfterVote=null,this._showResult=null,o&&this.model.getAssociated("questions").length>0){"0"===this.model.get("published")?this._mode="preview":"result"!==this._mode&&(this._mode="view"),o.getAssociated("questions")&&o.getAssociated("questions").forEach(function(e){e.getAssociated("answers")&&e.getAssociated("answers").forEach(function(e){e.set("nbVoters",this.get("nbVoters"))}.bind(this))}.bind(o));var s=new Date,d=new Date,m=o.get("startHour"),p=o.get("startDate");m&&p&&(d.setHours(m.substring(0,2)),d.setMinutes(m.substring(3,5)),d.setDate(p.substring(8,10)),d.setMonth(parseInt(p.substring(5,7),10)-1),d.setYear(p.substring(0,4)));var w=new Date,C=o.get("endHour"),f=o.get("endDate");if(C&&f&&(w.setHours(C.substring(0,2)),w.setMinutes(C.substring(3,5)),w.setDate(f.substring(8,10)),w.setMonth(parseInt(f.substring(5,7),10)-1),w.setYear(f.substring(0,4))),s<d&&"view"==this._mode)t=e.createElement("div",{styles:{"padding-top":"12px","font-size":"17px"},html:i.SurveynotyetstartedPleasecomeback.format(o.get("startDate"),o.get("startHour"))});else{switch(this._userHasAlreadyAnswered=o.get("userHasAlreadyAnswered")||!1,this._showResultsAfterVote=o.get("showResultsAfterVote"),this._canSeeResults=!1,this._canSeeResults=parseInt(o.getCommunity().get("this->getCurrentUserRights"),10)>2||o.get("login")===c.getInstance().get("login")||!1,this._mode){case"view":o.isOpen()?this._userHasAlreadyAnswered?!0===this._showResultsAfterVote?this._showResult=!0:this._canSeeResults?this._showResult=!0:this._showResult=!1:this._showResult=!1:this._showResult=!0;break;case"preview":this._showResult=!1;break;case"result":this._showResult=!0}var y=this.model.getAssociated("questions").at(0);if(y.set("thumbnails_infos",this.model.get("thumbnails_infos")),this._questionView=new l({model:y,modelAttr:"description"}),!1===this._showResult)"Scale"===y.get("type")&&y.getAssociated("answers").reset([{is_open:"0",id:"fake"}]),this._answersView=new a(y.getAssociated("answers"));else if(!0===this._showResult){var v=this.model.get("questions")&&this.model.get("questions").hasOwnProperty("0")&&this.model.get("questions")[0].hasOwnProperty("answers")&&this.model.get("questions")[0].answers;v&&y.getAssociated("answers").reset(v),"row"===this.getOption("resultMode")?this._answersView=new r(y.getAssociated("answers")):"pie"===this.getOption("resultMode")&&(this._answersView=e.createElement("div",{events:{resize:function(){this._graph&&this._graph.reflow()}.bind(this)}}))}this._controls["prev-button"]||this.addControl("prev-button",new u({className:"default prev-button",value:i.Previous,attributes:{disabled:!0}})),this._controls["next-button"]||this.addControl("next-button",new u({className:"default next-button",value:i.Next})),this._canExport=g&&this.model.getCommunity().getUserRole()>=3||!1,"preview"!=this._mode&&(!1===this._showResult?this.addControl("save-button",new u({className:"primary survey-save-button",value:i.Save,disabled:this.model.getAssociated("questions").length>1})):this._canExport&&this.addControl("export-button",new u({className:"primary export-button",value:i.Exportresults}))),t=!1===this._userHasAlreadyAnswered||!0===this._showResult?e.createElement("div",{styles:window.ds&&"3DD"===window.ds.env?{padding:"0px 10px"}:"",html:[{styles:{"font-style":"italic",color:"#C1C1C1","text-align":"right","font-size":"11px",padding:"0 0 10px"},html:i.Start+o.get("startDate")+" "+o.get("startHour")+" - "+i.End+o.get("endDate")+" "+o.get("endHour")},{styles:{padding:"5px 0","border-bottom":"1px solid #D8D8D8",color:"#518cd3","font-weight":"bold"},html:i.Question+' <span class="current-question-position">'+this._currentQuestionPosition+'</span> / <span class="question-count">'+o.getAssociated("questions").length+"</span>"},{styles:{margin:"10px 0"},html:this.addChildView("current-question-view",this._questionView)},this._showResult?{styles:{"text-align":"right",padding:"10px 0 10px"},html:i.Numberofvoters+o.get("nbVoters")+(!0===this._userHasAlreadyAnswered?" ("+i.includingyou+")":"")}:"",this._showResult&&"0"!==o.get("nbVoters")?new h({type:"switch",label:i.PieGraph,checked:"pie"===this.getOption("resultMode"),className:"graph-mode-toggle",events:{onChange:function(){this.isChecked()?n.setOption("resultMode","pie"):n.setOption("resultMode","row"),n._currentQuestionPosition=1,n.refresh()}}}):{class:"answers-config"},{styles:{padding:"5px 0 10px 0"},class:"current-answers",html:this._answersView},o.getAssociated("questions").length>1?this._controls["prev-button"]:"",o.getAssociated("questions").length>1?this._controls["next-button"]:"","preview"!==this._mode?!1===this._showResult?[this._controls["save-button"],this._canSeeResults?new u({className:"default see-results",value:i.CheckResults}):""]:[this._canExport?this._controls["export-button"]:"","result"===this._mode&&!1===this._userHasAlreadyAnswered?new u({className:"default see-results",value:i.Answer}):""]:"",!1===this._showResult?{styles:{"font-style":"italic",color:"#C1C1C1","font-size":"11px","padding-top":"5px","margin-bottom":"10px",clear:"both"},html:"<i>"+i.Thissurveyisanonymous+"</i>"}:""]}):e.createElement("div",{styles:{"padding-top":"12px","font-size":"17px"},html:i.Pleasecomebackon.format(o.get("endDate"),o.get("endHour"))})}return t}},validateCurrentAnswer:function(){var e=!1,t=!0;return"Single"==this._currentQuestion.get("type")||"Multiple"==this._currentQuestion.get("type")?this._currentQuestion.getAssociated("answers").forEach(function(i,n){!0===i.get("selected")&&(e=!0,"1"==i.get("is_open")&&(!i.get("custom_text")||i.get("custom_text")&&""===i.get("custom_text").trim())&&(t=!1))}):"Open"==this._currentQuestion.get("type")?this._currentQuestion.getAssociated("answers").forEach(function(t,i){t.get("custom_text")&&""!==t.get("custom_text").trim()&&(e=!0)}):"Scale"==this._currentQuestion.get("type")&&this._currentQuestion.getChanges("selected_index")&&(e=!0),!(!e||!t)},setCurrentQuestion:function(e){this._currentQuestion=this.model.getAssociated("questions").at(e-1),this._currentQuestion.set("thumbnails_infos",this.model.get("thumbnails_infos"));var t=this.container.getElement(".current-question-position");if(t&&t.setContent(e.toString()),"Scale"===this._currentQuestion.get("type")&&!1===this._showResult&&this._currentQuestion.getAssociated("answers").reset({is_open:"0",id:"fake"}),this._questionView&&(this._questionView.setModel(this._currentQuestion),"row"===this.getOption("resultMode")?this._answersView.setCollection(this._currentQuestion.getAssociated("answers")):"pie"===this.getOption("resultMode")&&(this._answersView.empty(),this._graph=new m({type:m.TYPE_PIE,series:[{data:this._getResultSeries(this._currentQuestion.getAssociated("answers"))}]}).render().inject(this._answersView))),!1===this._showResult&&"Multiple"===this._currentQuestion.get("type")&&"0"!=this._currentQuestion.get("nb_answer_max")){var n=0;this._currentQuestion.getAssociated("answers").forEach(function(e,t){!0===e.get("selected")&&n++}),this._answersView.getModelViews().forEach(function(e,t){e.getControl("answer-checkbox").isChecked()||e.getControl("answer-checkbox").setDisabled(n>=this._currentQuestion.get("nb_answer_max"))}.bind(this)),this.getElement(".answers-config").setHTML(o.replace(i.MaxNumberOfAnswer,{nbMax:this._currentQuestion.get("nb_answer_max")}))}else this.getElement(".answers-config")&&this.getElement(".answers-config").empty();1==this._currentQuestionPosition?(this._controls["prev-button"]&&this._controls["prev-button"].setDisabled(!0),this._controls["next-button"]&&this._controls["next-button"].setDisabled(!1)):this.model.getAssociated("questions").length<=this._currentQuestionPosition?this._controls["prev-button"]&&this._controls["next-button"]&&(this._controls["prev-button"].setDisabled(!1),this._controls["next-button"].setDisabled(!0)):this._controls["prev-button"]&&this._controls["next-button"]&&(this._controls["prev-button"].setDisabled(!1),this._controls["next-button"].setDisabled(!1)),!1===this._showResult&&this._controls["save-button"]&&this.model.getAssociated("questions").length==this._currentQuestionPosition?this._controls["save-button"].setDisabled(!1):!1===this._showResult&&this._controls["save-button"]&&this._controls["save-button"].setDisabled(!0)},setup:function(e){e.mode&&(this._mode=e.mode),this._parent.apply(this,arguments)},onPrevButtonClick:function(e){this._controls["prev-button"]&&(this._currentQuestionPosition--,this.setCurrentQuestion(this._currentQuestionPosition))},onNextButtonClick:function(e){this._controls["next-button"]&&"preview"!=this._mode?this.validateCurrentAnswer()||!0===this._showResult?(this._currentQuestionPosition++,this.setCurrentQuestion(this._currentQuestionPosition)):"Open"==this._currentQuestion.get("type")?this.alert("warn",i.Pleasefillyouranswer):this.alert("warn",i.Pleaseselectyouranswer):(this._currentQuestionPosition++,this.setCurrentQuestion(this._currentQuestionPosition))},onSaveButtonClick:function(e){if(this.validateCurrentAnswer()){var t=[];this.model.getAssociated("questions").forEach(function(e,t){e.getAssociated("answers").forEach(function(t,i){!0===t.get("selected")||"1"==t.get("is_open")&&"Open"===e.get("type")?this.push({answer:"1"==t.get("is_open")?t.get("custom_text"):null,answer_id:"1"==t.get("is_open")?-1:t.get("mid"),question_id:t.get("mid")?t.get("questionId"):e.get("mid")}):"Scale"===e.get("type")&&this.push({answer:e.getChanges("selected_index"),question_id:e.get("mid")})}.bind(this))}.bind(t)),this.getControl("prev-button")&&this.getControl("prev-button").setDisabled(!0),this.getControl("next-button")&&this.getControl("next-button").setDisabled(!0),this.getControl("save-button").setDisabled(!0),this.getControl("save-button").setValue(i.Loading),this.model.saveAnswers(t,{onComplete:function(){this._questionView=null,this._currentQuestion=null,this._currentQuestionPosition=1,this.model.fetch({onComplete:function(){this.setCurrentQuestion(1)}.bind(this)}),this.alert("success",i.Youranswershasbeenposted)}.bind(this),onFailure:function(){this.getControl("prev-button")&&this.getControl("prev-button").setDisabled(!1),this.getControl("next-button")&&this.getControl("next-button").setDisabled(!1),this.getControl("save-button").setValue(i.Save),this.getControl("save-button").setDisabled(!1),this.alert("error",i.Errorwhilepostingyouranswers)}.bind(this)})}else"Open"==this._currentQuestion.get("type")?this.alert("warn",i.Pleasefillyouranswer):this.alert("warn",i.Pleaseselectyouranswer)},onSeeResultsAndCancelClick:function(){"view"===this._mode?this._mode="result":this._mode="view",this._currentQuestionPosition=1,this.refresh()},onExportButtonClick:function(){var e=this;this.model.getResults({onComplete:function(){e.alert("info",i.AnEmailWillBeSent)},onFailure:function(){e.alert("warning",i.EmailSendingError)}})},onCheckboxChange:function(e){if(this._currentQuestion.getAssociated("answers").forEach(function(t,i){"checkbox_answer_"+t.get("mid")==e.target.name&&t.set("selected",e.target.checked)}),"0"!=this._currentQuestion.get("nb_answer_max")){var t=0;this._currentQuestion.getAssociated("answers").forEach(function(e,i){!0===e.get("selected")&&t++}),this._answersView.getModelViews().forEach(function(e,i){e.getControl("answer-checkbox").isChecked()||e.getControl("answer-checkbox").setDisabled(t>=this._currentQuestion.get("nb_answer_max"))}.bind(this))}},onRedraw:function(){!0===this._showResult&&"row"===this.getOption("resultMode")&&this._answersView.dispatchEvent("surveyRedraw"),!1!==this._userHasAlreadyAnswered&&!0!==this._showResult||this.setCurrentQuestion(1)},onSetModel:function(){!0!==this.getOption("fetchItemOnClick")||this.model.hasBeenFetched()||(this.model.fetch(this.options&&this.options.modelFetchOptions),this.setOption("fetchItemOnClick",!1))}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/content-editor-body-switcher-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUIComponents/script/feature/community/content/edit/content-editor-body-view-with-rte","DS/SwymUIComponents/script/feature/community/content/edit/content-editor-body-view-with-advanced-rte","DS/SwymUIComponents/script/feature/community/im/im-creator-body-view","DS/SwymUIComponents/script/feature/community/media/edit/media-creator-body-view","DS/SwymUIComponents/script/feature/community/media/edit/media-editor-body-view","DS/SwymUIComponents/script/feature/community/survey/edit/survey-creator-view","DS/SwymUIComponents/script/feature/community/wiki/edit/wiki-creator-view","DS/SwymUIComponents/script/feature/community/wedo/edit/wedo-creator-factory","DS/SwymUIComponents/script/feature/community/social-event/edit/social-event-simple-editor","DS/SwymUIComponents/script/feature/community/social-event/edit/social-event-advanced-editor","DS/SwymUIComponents/script/feature/community/ritual/edit/ritual-advanced-editor"],(e,t,i,n,o,s,a,r,l,c,d,m,u)=>{return t.extend({name:"content-editor-body-switcher-view",defaultOptions:{currentMode:"simpleRTE",contentEditorView:null},modes:{simpleRTE:{Class:i,dragZoneSelector:".post .content-edition",rteViewOptions:{isSimpleRTE:!0}},instantMessageRTE:{dragZoneSelector:".message .content-edition",Class:o,rteViewOptions:{isSimpleRTE:!0,overrideToolbarStickiness:!0}},advancedRTE:{dragZoneSelector:".content-edition",Class:n},mediaCreator:{Class:s},mediaEditor:{Class:a},surveyCreator:{Class:r},wikiCreator:{name:"wiki-creator",Class:l},wedoCreator:{Class:c.getClass(),dragZoneSelector:".wedo .content-edition",rteViewOptions:{mandatory:!1,activateUserMention:!1,activateInline6WTagging:!1}},advancedWedoCreator:{Class:c.getClass("advanced"),dragZoneSelector:".content-edition",rteViewOptions:{mandatory:!1,activateUserMention:!1,activateInline6WTagging:!1}},socialEventCreator:{name:"social-event-creator",Class:d},advancedSocialEventCreator:{name:"social-event-editor",Class:m,rteViewOptions:{useFocusStyle:!0}},advancedRitualCreator:{name:"ritual-editor",Class:u,rteViewOptions:{mandatory:!1,activateInline6WTagging:!1}}},_getView(t){let i=this.getChildView(t);return i||(i=this.addChildView(t,e.merge({model:this.model,communityId:this.options.communityId,contentEditorView:this.options.contentEditorView},this.modes[t])),"mediaEditor"===t&&this.addEvent("onPublishing",(e,t)=>{i.dispatchEvent("onPublishing",[e,t])}),this.listenTo(i,{triggerDocumentCreationRequest(...e){this.dispatchEvent("triggerDocumentCreationRequest",...e)},onContentChange:this.contentChanged,onMediaUploadsStart(...e){this.dispatchEvent("onMediaUploadsStart",...e)},onMediaUploadsComplete(){this.dispatchEvent("onMediaUploadsComplete")},onMediaUploadsFailure(){this.dispatchEvent("onMediaUploadsFailure")},onEnterKeyPressed(){this.dispatchEvent("onEnterKeyPressed")},onSwymImgPaste:function(){this.dispatchEvent("onSwymImgPaste")}.bind(this),onCopyPaste(){},onPlaceholderAdded(){this.dispatchEvent("onPlaceholderAdded")},onPlaceholderRemoved(){this.dispatchEvent("onPlaceholderRemoved")},onInjected(){i===this._getCurrentView()&&i.refreshDragDetection()},onRemoved(){i.stopDragDetection()}})),i},_createContent(){const e=this._getCurrentView();return e.refresh(),e},_getCurrentView(){return this._getView(this.options.currentMode)},switchTo(e){let t;e!==this.options.currentMode&&(this.oldMode=this.options.currentMode,this.setOption("currentMode",e),this.addEventOnce("onRedraw",()=>{this._getCurrentView().refreshContent&&(t=this._getView(this.oldMode),this._getCurrentView().refreshContent(t.getContentAttributes(),t.getMediaCollection()),t.onExitingMode())}),this.setCommunityId(this.options.communityId),this.refresh(),this._getCurrentView().onEnteringMode())},setCommunityId(e){return this._getCurrentView().setCommunityId(e)},getCommunityId(...e){return this._getCurrentView().getCommunityId(...e)},contentChanged(){this.dispatchEvent("onContentChange")},getContentAttributes(){return this._getCurrentView().getContentAttributes()},isContentEmpty(){return this._getCurrentView().isContentEmpty()},clearUndoTextInEditor(){return this._getCurrentView().clearUndoTextInEditor()},resetContent(){return this.model&&(this.stopReactingTo(this.model),this.model=null),this._getCurrentView().resetContent()},removeTagsFromContent(){if(this._getCurrentView().removeTagsFromContent)return this._getCurrentView().removeTagsFromContent()},resetEditorViews(){return this._getCurrentView().resetEditorViews()},getMediaCollectionLength(){return this._getCurrentView().getMediaCollectionLength()},getMediaCollection(){return this._getCurrentView().getMediaCollection()},uploadMedia(e){return this._getCurrentView().uploadMedia(e)},addMedia(e){return this._getCurrentView().addMedia(e)},validateContent(e){return this._getCurrentView().validateContent(e)},validateFirstStepContent(){return this._getCurrentView().validateFirstStepContent()},goToNextStep(){return this._getCurrentView().goToNextStep()},goToPreviousStep(){return this._getCurrentView().goToPreviousStep()}})}),define("DS/SwymUIComponents/script/feature/community/survey/view/survey-stats-home-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/survey/view/survey-stats-collection-view","DS/SwymUICore/script/feature/community/survey/collection/survey-collection","DS/SwymUIComponents/script/feature/community/survey/view/survey-stats-collection-view","DS/SwymUIComponents/script/feature/community/survey/view/legacy-survey-view","DS/SwymUIComponents/script/feature/core/modal/modal","DS/SwymUIComponents/script/feature/core/pagination/view/paging-toolbar-view"],function(e,t,i,n,o,s,a,r){return t.extend({_modelEvents:{"onChange:toDate":"_communityChanged","onChange:fromDate":"_communityChanged"},_asAdmin:!1,_communityChanged:function(){this.surveyCollection.resetCollection(1,{data:{date00:this.model.get("fromDate"),date01:this.model.get("toDate")}})},_createContent:function(){if(this.model){var t=new r({collection:this.surveyCollection,widget:this._widget});return e.createElement("div",{class:"analytics",html:[{tag:"span",html:i.Surveys},this.surveyCollectionView,t]})}},_showDetails:function(e){this.surveyView=new s({model:e,mode:"result",widget:this._widget}),this.surveyResultModal=this.addControl("surveyResultModal",new a({renderTo:this._widget?this._widget.body:document.body,header:"<h4>"+e.get("title")+"</h4>",body:this.surveyView,className:"survey-wrapper"})),this.surveyResultModal.show()},setup:function(t){var i=this._parent.apply(this,arguments);return e.is(this.model._asAdmin)&&(this._asAdmin=this.model._asAdmin),this.surveyCollection=new n([],{mode:"community-stats-surveys",limit:10,asAdmin:this._asAdmin}),this.surveyCollection.setAssociated("community",this.model),this.surveyCollectionView=new o({collection:this.surveyCollection,community:this.model,widget:this._widget}),this.surveyCollectionView.addEvent("surveyClicked",function(e){this._showDetails(e)}.bind(this)),this.surveyCollection.addEventOnce("onBeforePageChange",function(){this.mask()}.bind(this)),this.surveyCollection.addEventOnce("onAfterPageChange",function(){this.unmask()}.bind(this)),i}})}),define("DS/SwymUIComponents/script/feature/core/stats/view/stats-collection-view",["DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUICore/script/feature/core/stats/collection/stats-collection","DS/SwymUIComponents/script/feature/core/stats/view/daterange-view","DS/SwymUIComponents/script/feature/core/stats/view/analytics-view","DS/SwymUIComponents/script/feature/community/survey/view/survey-stats-home-view"],function(e,t,i,n,o){return e.extend({_collectionClass:t,name:"stats-collection-view",modelViewClass:{pie:n,column:n,table:n,community:o},defaultOptions:{asAdmin:!1},_notifyOfItemViewSelection:!1,_tenant:null,_community:null,attributes:{styles:{height:"100%"}},bodyAttributes:{tag:"div",styles:{"overflow-x":"hidden"}},modelViewsCfg:{attributes:{class:"graph col-xs-12 col-md-6 col-sm-6 col-lg-4"}},init:function(e){return e&&e.hasOwnProperty("scroller")&&(this._addScroller=e.scroller),this._parent.apply(this,arguments)},setup:function(e){return e&&(e.hasOwnProperty("community")&&(this._community=e.community),e.hasOwnProperty("tenant")&&(this._tenant=e.tenant)),this._parent.apply(this,arguments)},setCommunity:function(e){this._community=e},_parseDate:function(e){return e.getFullYear()+"-"+(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+(e.getDate()<10?"0"+e.getDate():e.getDate())},_changeBothDate:function(e,t){var i=this._parseDate(e),n=this._parseDate(t),o=this.collection.first();o&&o.hasOwnProperty("_fromDate")&&(o._fromDate!==i||o._toDate!==n)&&this.collection.updateModels(i,n)},_changeStartDate:function(e){var t=this._parseDate(e),i=this.collection.first();i&&i.hasOwnProperty("_fromDate")&&i._fromDate!==t&&this.collection.updateModels(t,null)},_changeEndDate:function(e){var t=this._parseDate(e),i=this.collection.first();i&&i.hasOwnProperty("_toDate")&&i._toDate!==t&&this.collection.updateModels(null,t)},_createContent:function(){var e=new i({community:this._community?this._community:null,tenant:this._tenant?this._tenant:null});return this.reactTo(e,"bothDateChanged",this._changeBothDate),this.reactTo(e,"startDateChanged",this._changeStartDate),this.reactTo(e,"endDateChanged",this._changeEndDate),[e,this._parent()]}})}),define("DS/SwymUIComponents/script/feature/direct-message/room/user-search-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/utils","i18n!DS/SwymUIComponents/assets/nls/feature/core/share/view/share-content-view","DS/SwymUIComponents/script/feature/core/search/view/user-search-factory","DS/SwymUIComponents/script/utils/feature-activation-manager"],function(e,t,i,n,o,s,a){"use strict";var r=i.getInstance().get("user").login;return t.extend({setup:function(e){const t="boolean"!=typeof e.pendingUsersAllowed||e.pendingUsersAllowed,i="boolean"!=typeof e.mailAllowed||e.mailAllowed;this.users=e.users,this.addControl("user-search-control",s.createUserSearchControl({mailAllowed:i,phoneAllowed:a.isBetaFeatureActivatedForPhoneCall(),pendingUsersAllowed:t,restricted:!1,multiSelect:!0,itemMultiSelect:!1,loginsToDisableInSuggestions:[r],parentSwymView:this,events:{onSelect:function(e){this.dispatchEvent("onSelectUser",e)}.bind(this),onUnselect:function(e){this.dispatchEvent("onUnselectUser",e)}.bind(this),onInjected:function(){this.elements&&this.elements.input&&this.elements.input.focus()}}})),this.refresh(),this._parent.apply(this,arguments)},_createContent:function(){var t=this.getControl("user-search-control");return e.createElement("div",{html:[{tag:"label",html:o.CommunityOwner},{class:"user-search",html:[t||{}]}]})},onInjected:function(){var e,t=this.getControl("user-search-control"),i=[];this.users&&this.users.length>0&&this.users.forEach(function(t){t.login!==r&&(e=t.first_name+" "+t.last_name,i.push({resourceId:t["ds6w:resourceUid"],login:t.login,value:e,label:e,selected:!0}))}),t.addItems(i,t.getDataset())},getSelectedUsers:function(){return this.getControl("user-search-control").getSelection()}})}),define("DS/SwymUIComponents/script/feature/direct-message/room/add-room-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUIComponents/script/feature/direct-message/room/user-search-view","DS/SwymUIComponents/script/feature/direct-message/room/recent-dms-list-view","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/utils/usage-tracker","DS/UIKIT/Modal","DS/UIKIT/Input/Button","DS/UIKIT/Alert","DS/UIKIT/Input/Text","DS/SwymUICore/script/lib/model/model-manager","DS/Logger/Logger","i18n!DS/SwymUIComponents/assets/nls/feature/core/user/view/user-tile-view","i18n!DS/SwymUIComponents/assets/nls/feature/direct-message/direct-messages"],(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g)=>{const w=o.MAX_NB_USERS_IN_DM-1,C=s.getInstance().get("user").login,f=["All new members must be in active state","All users must be in active state"];return t.extend({defaultOptions:{mode:"create",dmModel:null},users:null,setup(t){const s=this,a=this.getOption("dmModel"),r="edit"===this.getOption("mode");if(r&&!a)throw new Error("A DM has to be provided for edit mode");this.users=a&&r?a.getAssociated("users"):a&&!r?a.get("users"):null,this.addChildView("userSearchView",{Class:i,pendingUsersAllowed:!1,mailAllowed:!1,users:"create"===this.getOption("mode")&&this.users||[],events:{onSelectUser(e){s.onUserSelected&&s.onUserSelected(e)},onUnselectUser(e){s.onUserRemoved&&s.onUserRemoved(e)}}}),this.userLimitationReminderEl=e.createElement("div",{class:"user-limit-text",html:g.replace(g.get("YouCanAddUptoNUsers"),{n:w})}),this.addMembersAlert=new d({closable:!1,closeOnClick:!1,visible:!0,fullWidth:!0,className:"add-new-members-message",messageClassName:"primary",messages:[g.AddingNewMembersStartsANewConversation],renderTo:s.container}),this.historyVisibilityAlert=new d({closable:!1,closeOnClick:!1,visible:!0,fullWidth:!0,className:"history-visibility-message",messageClassName:"primary",messages:[g.AddedPeopleWillSeeConversationHistory],renderTo:s.container}),this.topicInput=new m({placeholder:g.TopicName}),this.cancelConversationButton=new c({value:g.Cancel,className:"default cancel",events:{onClick(){s.destroy()}}}),this.startConversationButton=new c({value:g.Start,disabled:!0,className:"primary start",events:{onClick:this.onGoButtonClicked.bind(this)}}),this.recentDMsList=this.addChildView("recentDMsList",new n({users:[],events:{onDMSelected(e){s.updateStartConversationButton(e.getAssociated("users"))}}})),this.addControl("addRoomModal",new l({header:`<h4>${"edit"===this.getOption("mode")&&a.get("dm_type")===o.DM_TYPE_GROUP?g.AddPeopleToConversation:g.StartAConversation}</h4>`,className:"fancy add-room",body:["create"===this.getOption("mode")&&a&&a.get("dm_type")===o.DM_TYPE_PRIVATE?this.addMembersAlert:"","edit"===this.getOption("mode")&&a&&a.get("dm_type")===o.DM_TYPE_GROUP?this.historyVisibilityAlert:"",this.getChildView("userSearchView"),this.userLimitationReminderEl,{tag:"div",class:"topic-container",html:[new e.createElement("div",{class:"topic-input-label",html:g.SetATopicForANewConversation}).hide(),this.topicInput.hide()]},this.getChildView("recentDMsList")],footer:[this.startConversationButton,this.cancelConversationButton],closable:!0,events:{onHide(){s.destroy()}}})),r&&this.users.fetch?this.users.fetch({onComplete(e){s.users=e.toJSON(),s.onUserSelected(),s.dispatchEvent("onInitOver")}}):(s.onUserSelected(),s.dispatchEvent("onInitOver"))},_createContent(){return this.getControl("addRoomModal")},show(){this.getControl("addRoomModal").show(),this._parent.apply(this,arguments)},onUserSelected(e){if(this.getChildView("userSearchView")){const t=this.getSelectedUsers().map(e=>({resourceId:e.resourceId||e.resourceUid||e["ds6w:resourceUid"],nickname:e.nickname,login:e.login}));h.log("User selected",t,e),this.onUserChange(t)}},onUserRemoved(e){if(this.getChildView("userSearchView")){const t=this.getSelectedUsers(),i=t&&t.map(e=>({resourceId:e.resourceId||e.resourceUid||e["ds6w:resourceUid"],nickname:e.nickname,login:e.login}))||[];h.log("User removed",i,e),this.onUserChange(i)}},onUserChange(e){this.updateTopicInputUI(e),this.updateRecentDMsList(e),this.updateInfoUI(e),this.updateStartConversationButton(e)},getSelectedUsers(){const e=this.getSelectedUserFromSearch()||[],t=this.users?this.users.filter(e=>e.login!==C):[];return"create"===this.getOption("mode")?e:e.concat(t)},getSelectedUserFromSearch(){return this.getChildView("userSearchView").getSelectedUsers()},updateRecentDMsList(e){const t=e.length,i=this.getOption("dmModel");"create"===this.getOption("mode")?t>0?(this.recentDMsList.show(),this.recentDMsList.updateUsers(e)):this.recentDMsList.hide():i.get("dm_type")===o.DM_TYPE_PRIVATE?(this.recentDMsList.show(),this.recentDMsList.updateUsers(e)):this.recentDMsList.hide()},updateTopicInputUI(e){const t=this;let i;const n=e.length,s=this.getOption("dmModel");"create"===this.getOption("mode")?n>1?this.showTopicInputUI():this.hideTopicInputUI():s.get("dm_type")===o.DM_TYPE_PRIVATE?(i=this.isSelectionSameAsConversationUsers())?t.hideTopicInputUI():t.showTopicInputUI():this.hideTopicInputUI()},showTopicInputUI(){const e=this.getElement(".topic-input-label");e&&e.show(),this.topicInput.show()},hideTopicInputUI(){const e=this.getElement(".topic-input-label");e&&e.hide(),this.topicInput.hide()},isSelectionSameAsConversationUsers(){let e=this.getSelectedUsers()||[];const t=this.users||{};return(e=e&&e.map(e=>e.login)).length===t.length-1&&t.every(t=>e.indexOf(t.login)>-1||t.login===C)},_isAPhoneNumber:e=>/^\+\d{2,15}$/.test(e),updateStartConversationButton(e){const t=this,i=e.length,n=this.getOption("dmModel")&&"private"===this.getOption("dmModel").get("dm_type");if(e.length>0&&e.filter(e=>this._isAPhoneNumber(e.resourceId)).length>0){(this.getChildView("userSearchView")&&this.getChildView("userSearchView").getControl("user-search-control")).setDisabled(!0),this.startConversationButton.setValue(g.Call),this.startConversationButton.enable(),this.userLimitationReminderEl.setHTML("")}else if("create"!==this.getOption("mode")||n){!this.isSelectionSameAsConversationUsers()||t.recentDMsList.getSelectedDM()?t.startConversationButton.enable():t.startConversationButton.disable()}else i>0&&i<=w?this.startConversationButton.enable():this.startConversationButton.disable()},updateInfoUI(e){const t=this,i=e.length;i<w?(t.getChildView("userSearchView").container.removeClassName("hide-autocomplete"),t.userLimitationReminderEl.hasClassName("error")&&t.userLimitationReminderEl.removeClassName("error"),0===i?t.userLimitationReminderEl.setHTML(g.replace(g.get("YouCanAddUptoNUsers"),{n:w})):i<w-1?t.userLimitationReminderEl.setHTML(g.replace(g.get("YouCanAddNMoreUsers"),{n:w-i})):i===w-1&&t.userLimitationReminderEl.setHTML(g.YouCanAddOneMoreUser)):(t.userLimitationReminderEl.addClassName("error"),t.getChildView("userSearchView").container.addClassName("hide-autocomplete"),i===w?t.userLimitationReminderEl.setHTML(g.YouCannotAddAnyMoreUsers):i===w+1?t.userLimitationReminderEl.setHTML(g.PleaseRemoveOneUser):i>w&&t.userLimitationReminderEl.setHTML(g.replace(g.get("PleaseRemoveNUsers"),{n:i-w})))},onGoButtonClicked(){const e=this;let t;const i=[],n=e.getSelectedUsers(),s=e.recentDMsList.isVisible()&&e.recentDMsList.getSelectedDM(),l=e.getOption("dmModel"),c=!e.topicInput.getContent().isHidden()&&e.topicInput.getValue(),d=new o;for(let e=0,o=n.length;e<o;e++)t=n[e],i.push(t.login);-1===i.indexOf(C)&&i.push(C),s?(a.goToDM(s.get("mid")),r.trackPageEvent({category:"ConversationMembers",label:"goToRecentConversation",view:"add-room-view",event:"click"}),e.destroy()):e._isAPhoneNumber(n[0].resourceId)?require(["DS/RTAudioVideoAPI/RTAudioVideoAPI"],t=>{t.startCall({phone:n[0].resourceId,type:"audio"}),e.getControl("addRoomModal").destroy()}):"create"===e.getOption("mode")||l.get("dm_type")===o.DM_TYPE_PRIVATE?i.length>1&&i.length<=o.MAX_NB_USERS_IN_DM&&(d.addChanges({users:i}),c&&d.addChanges({topic:c}),r.trackPageEvent({category:"ConversationMembers",label:"createNewConversationFromModal",view:"add-room-view",event:"click"}),e.startConversationButton.load(),e.cancelConversationButton.setDisabled(),d.save({},{onComplete(t){a.goToDM(t.get("mid")),t=new o(t.toJSON()),u.notify("onCreate",t),e.destroy()},onFailure(t,i){if(i&&i.result&&i.result.id){a.goToDM(i.result.id);const t=new o(i.result);t.set("is_hidden",!1),u.notify("onCreate",t),e.destroy()}else e.startConversationButton.load(!1),e.cancelConversationButton.setDisabled(!1),i&&f.includes(i.errormsg)?e.alert("error",g.SomeUsersAreNotActiveOnThePlatform):e.alert("error",g.AnErrorOccurred)}})):"edit"===e.getOption("mode")&&l.get("dm_type")===o.DM_TYPE_GROUP&&(r.trackPageEvent({category:"ConversationMembers",label:"editConversationMembers",view:"add-room-view",event:"click"}),e.startConversationButton.load(),e.cancelConversationButton.setDisabled(),e.addMembersToTheConversation())},addMembersToTheConversation(){const e=this,t=this.getSelectedUserFromSearch(),i=this.getOption("dmModel"),n=[];for(let e=0,i=t.length;e<i;e++)n.push(t[e].login);i.action("addmembers",{data:{users:n},onComplete:()=>{require(["DS/SwymUICore/script/lib/event-manager"],t=>{t.dispatchEvent("onCommunityMembersUpdate",[i.getAssociated("users").toArray()]),e.alert("success",p.Yourchangeshavebeensaved)}),require(["DS/SwymUIComponents/script/utils/typing-indicator-manager"],e=>{const t=i.getAssociated("users").map(e=>e.get("login"));e.sendUsersInThread(i.get("mid"),t)}),e.destroy()},onFailure:(t,i)=>{e.startConversationButton.load(!1),e.cancelConversationButton.setDisabled(!1),i&&f.includes(i.errormsg)?e.alert("error",g.SomeUsersAreNotActiveOnThePlatform):e.alert("error",g.AnErrorOccurred)}})}})}),define("DS/SwymUIComponents/script/feature/community/thread/thread-list-view",["UWA/Core","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","i18n!DS/SwymUIComponents/assets/nls/layout/left/my-communities-view","DS/SwymUIComponents/script/feature/core/ui-components/list/item-list","DS/SwymUIComponents/script/feature/direct-message/room/add-room-view","DS/SwymUIComponents/script/feature/community/community/view/community-dummy-view","DS/SwymUICore/script/feature/thread/collection/thread-lite-collection","DS/SwymUIComponents/script/feature/community/thread/thread-list-view-mixin","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/core/context/context-constants","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/utils/usage-tracker","DS/SwymUIComponents/script/utils/progressive-disclosure-manager"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h){"use strict";function p(e,t){let i,n,o;if(null==e.get("last_message")){if(!e.has("creation_date"))return 1;i=new Date(e.get("creation_date")).getTime()/10}else o=e.get("last_message").message_id.split("-"),i=parseInt(o[0]+o[1],16);if(null==t.get("last_message")){if(!t.has("creation_date"))return-1;n=new Date(t.get("creation_date")).getTime()/10}else o=t.get("last_message").message_id.split("-"),n=parseInt(o[0]+o[1],16);return i>n?-1:n>i?1:0}return o.extend({domEvents:{"click .cta-link":"_onAddConversation","click .show-all-communities":"_onMoreButtonClick"},_onAddConversation:function(){var e=window.document||this._widget,t=new s;u.trackPageEvent({category:"MyConversations",label:"creationWithStartNowLink",view:"thread-list-view",event:"click"}),t.render(e.body).show()},_onMoreButtonClick:function(){m.goToUrl(m.MY_COMMUNITIES),u.trackPageEvent({category:"MyCommunities",label:"navigateToAllMyCommunities",view:"thread-list-view",event:"click"})},displayNextPage:function(){const e="conversation"===this.mode;if(this.showContainer(),"read"===this._collectionLastMode||"unreadOnly"===this._collectionLastMode){var t=this,i=this.collection.length,n=this.originalCollection.filter("read"===this._collectionLastMode?this._isNotFavoriteOrHiddenConversationOrBlacklistedCommunity:this._isNotFavoriteOrHiddenOrWithoutUnreadContent.bind(this)).sort(e?p:void 0),o=n.slice(i,i+this.limit);return n.slice(0,i).map(function(e){!t.collection.contains(e)&&t.collection.add(e)}),!(!this.originalCollection||"filter"!==this.originalCollection.lastCalledService)||i<n.length&&(this.collection.add(o),this._loadLastMessage(this.collection),!0)}},_collectionUpdated:function(e,...t){if(e.get("is_favorite")||e.get("is_hidden")||e.get("isBlacklisted"))this.collection.remove(e),0===this.collection.length&&("filter"!==this._collectionLastMode&&this.originalCollection.countBy("is_favorite").true)>1&&this.container.hide();else{if("conversation"===this.mode)2===t.length&&Object.hasOwnProperty.call(t[1],"at")?this.collection.add(e,{at:t[1].at}):this.collection.add(e);else{var i=this.originalCollection.filter(this._isNotFavoriteOrHiddenConversationOrBlacklistedCommunity).indexOf(e);this.collection.add(e,{at:i||"0"})}this.container.show(),this.showContainer(),this.myOtherCommunitiesPlaceholder.hide()}this._progressiveDisclosureManager.checkDisclosure(this.originalCollection,this._collectionLastMode)},_sortCollection:function(){this.collection.comparator&&this.collection.sort()},_resetCollection:function(e){const t="conversation"===this.mode;if(e instanceof r&&"lastMessage"!==e.lastCalledService){if("filter"!==this._collectionLastMode){var i=e.filter(this._isNotFavoriteOrHiddenConversationOrBlacklistedCommunity).sort(t?p:void 0).slice(0,this.limit);this.setCollection(new r(i,{mode:this.mode,comparator:t?(e,t)=>{if("filter"!==this._collectionLastMode)return p(e,t)}:null}))}this._loadLastMessage(this.collection)}else"lastMessage"!==e.lastCalledService&&this._collectionUpdated(e)},setup:function(e){var t=this;this.mode=e.mode,this.limit=e.limit||10,this.modelViewClass="community"===this.mode?this._customCommunityItem:this._customDirectMessageItem,this.originalCollection=e.originalCollection,this._resetCollection(this.originalCollection),this.listenTo(this.originalCollection,"onChange:is_favorite",this._collectionUpdated.bind(this)),this.listenTo(this.originalCollection,"onAdd",this._collectionUpdated.bind(this)),this.listenTo(this.originalCollection,"onRemove",this._collectionUpdated.bind(this)),this.listenTo(this.originalCollection,"onChange:last_message",this._sortCollection.bind(this)),this.listenTo(this.originalCollection,"onChange:isBlacklisted",this._collectionUpdated.bind(this)),"conversation"===this.mode&&this.listenTo(this.originalCollection,"onChange:is_hidden",function(e){e.get("is_hidden")&&t.dispatchEvent("onDMHidden",e),t._collectionUpdated(e)}),this._progressiveDisclosureManager=h.getInstance(),this._progressiveDisclosureManager.checkDisclosure(this.originalCollection,this._collectionLastMode),this._progressiveDisclosureManager.addEvent("othersDisplayChange",this._progressiveRefresh,this),this._parent.call(this,e)},_progressiveRefresh(e){e===this.mode&&this.refresh()},modelViewsCfg:function(t){var i=this._parent.apply(this,arguments),n=c.getInstance(),o={class:"thread-view "+("community"===this.mode?"my-communities draggable-community":"discover-communities draggable-dm")};return window.ds&&window.ds.isMDE&&n.quadrant!==d.NORTH_QUADRANT?(o["data-quadrant"]=n.quadrant,o["data-container-type"]="community",o["data-container-id"]=t.get("title")):(o["data-content-type"]="community"===this.mode?"community":"direct-message",o["data-content-id"]=t.get("mid")),e.merge({attributes:o},i)},_getEmptyViewForConversations:function(){return e.createElement("div",{class:"cta-container",html:[{tag:"span",class:"fonticon fonticon-chat fonticon-5x"},{class:"cta-message",html:n.CTAMessage},{class:"cta-link",tag:"span",html:n.CTALinkMessage}]})},_createContent:function(){var t,i=this.collection,o="filter"!==this._collectionLastMode&&this.originalCollection.countBy("is_favorite").true,s=o>10,r=this.addChildView("communityDummyView",new a({nbItems:10}));return this.collectionList=this._parent.apply(this,arguments),this.elements.noResult=e.createElement("div",{class:"communities-no-result",html:[{tag:"span",class:"fonticon fonticon fonticon-4x fonticon-search"},{tag:"span",text:n.NoSearchResult}]}),this.myOtherCommunitiesHeader=e.createElement("div",{class:"communities-section-header",html:[{tag:"h5",text:"community"===this.mode?n.MyCommunities:n.MyConversations},"community"===this.mode?{class:"link show-all-communities",tag:"a",html:n.ShowAll}:""]}),this.myOtherCommunitiesPlaceholder=e.createElement("div",{class:"hidden-threads-placeholder",html:"community"===this.mode?n.YouWillFindHereYourCommunities:n.YouWillFindHereYourConversations}),this.myOtherCommunitiesPlaceholder.hide(),this.elements.noResult.hide(),i.length>0?(t=e.createElement("div",{class:"other-communities-container",html:[this.myOtherCommunitiesHeader,r,this.collectionList,this.elements.noResult,this.myOtherCommunitiesPlaceholder]}),this.getChildView("communityDummyView")&&this.removeChildView("communityDummyView"),s&&t.hide(),t):this.originalCollection.hasBeenFetched()?("filter"===i.lastCalledService||"unreadOnly"===this._collectionLastMode?t={}:o?(t=e.createElement("div",{class:"other-communities-container",html:[this.myOtherCommunitiesHeader,this.myOtherCommunitiesPlaceholder]}),this.container.hide()):t={},t):this.originalCollection.hasBeenFetched()&&"community"!==this.mode?"filter"!==i.lastCalledService||"unreadOnly"!==this._collectionLastMode?{}:this.collectionList:(t={},s&&t.hide(),t)},onFavoriteListUpdated:function(e,n){var o="conversation"===this.mode?i:t,s=new o({mid:e});n?(this.container.show(),s=new o({mid:e}),this.collection.add(s)):this.collection.remove(s.get("id"))},onSearch:function(t){var i="conversation"===this.collection.mode?{hidden_communities:"without"}:{hidden_communities:"without",myCommunitiesOnly:!0};this._collectionLastMode="filter",require(["DS/UWPClientCode/I18n"],function(n){var o=n.getCurrentLanguage()||"en";this.collection.onServerFilteringRequest(null,null,{data:e.extend(i,{query:t,favorite_communities:"without",locale:o})})}.bind(this))},onFilterByUnreadOnly:function(){this._collectionLastMode="unreadOnly";var e=new r(this.originalCollection.filter(this._hasUnreadContent),{mode:this.mode,comparator:"conversation"===this.mode?p:null});this._resetCollection(e)},sendCollectionTagsToTagger:function(){},destroy:function(){this.originalCollection.stopListening(),this._progressiveDisclosureManager.removeEvent("othersDisplayChange",this._progressiveRefresh),this._parent.call(this,arguments)}},l)}),define("DS/SwymUIComponents/script/feature/community/idea/view/idea-status-view",["UWA/Core","i18n!DS/SwymUIComponents/assets/nls/feature/community/idea/view/idea-status-view","DS/SwymUICore/script/feature/community/idea/collection/status-collection","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/UIKIT/Dropdown","DS/UIKIT/Input/Button","DS/SwymUIComponents/script/feature/core/modal/modal","DS/SwymUIComponents/script/feature/core/modal/super-modal","DS/UIKIT/Input/Text","DS/UIKIT/Tooltip","DS/SwymUIComponents/script/feature/community/content/view/simple-editor-view","DS/UWPClientCode/I18n","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/rich-link-preview-utils"],function(e,t,i,n,o,s,a,r,l,c,d,m,u){"use strict";return n.extend({name:"idea-status-view",_height:12,_statusCollection:null,_maxStatusNumber:5,_modelEventsForAutoRefresh:["onChange:_acl","onChange:acl_status","onSync:updateideationstatus"],domEvents:{"click .fonticon-cancel":"_onOutPanelClick"},_createContent:function(){var i,n,o,s,a,r,l=this,d=l._statusCollection,m=l._height,u=l._maxStatusNumber,h=l.model;if(d&&d.length>1&&h.get("status_id"))return n=d.slice(),s=l._createCurrentStatusPanel(),r=h.canChangeStatus(),h.isOut()?i=e.createElement("div",{class:"flat-pipeline-container",styles:{width:"100%","margin-top":"20px"},html:s}):(l._ideaStatusArray=[],n.forEach(function(i,n,s){a=i.get("mid")===h.get("status_id"),o=e.createElement("div",{class:"idea-status"+(a?" current":"")+(r?" can-edit":""),styles:{flex:"0 0 "+100/s.length+"%","padding-top":"10px",cursor:r&&!a?"pointer":""},html:[{class:"idea-sub-status",styles:{height:m+"px",backgroundColor:i.get("color")}},{class:"idea-status-title",styles:{"font-weight":a?"bold":""},html:i.get("title")+(i.get("is_mature")?'</br><span class="mature-label">'+t.Mature+"</span>":"")}],events:r&&!a?{click:function(){l._changeStatus(n+1,!1)}}:{}}),l._ideaStatusArray.push(o)}),i=e.createElement("div",{class:d.length>u?"more-than-x-status":"",html:[{class:"flat-pipeline-container",html:[{class:"flat-pipeline",html:l._ideaStatusArray},d.length>u?"":r?{class:"out-panel",html:[{tag:"span",class:"fonticon fonticon-2x fonticon-cancel",title:t.Out}]}:""]},s]})),!this.getControl("outPanelTooltip")&&this.container.getElement(".fonticon-cancel")&&this.addControl("outPanelTooltip",new c({target:e.extendElement(this.container.getElement(".fonticon-cancel")),body:t.Out})),h.hasBeenFetched()?l._createIdeaShape():h.addEventOnce("onSync",l._createIdeaShape.bind(l)),i},_onOutPanelClick:function(){this.model.isOut()||this._changeStatus(null,!0)},_formatStatusComment:e=>u.convertURLPreviewToLink(e,!1),_createStatusChangeModalElements:function(){var e=this,i=e.model;e.addControl("cancelButton",new s({className:"default",value:t.Cancel,events:{onClick:function(){e.current_status_nb=e.initial_status_nb,e.current_out=e.initial_out,e.getControl("editTextarea").getTextArea().setText(""),e._statusChangeModal.hide()}}})),e.addControl("saveButton",new s({className:"primary",value:t.Change,events:{onClick:function(){const n=e.getControl("editTextarea").getTextArea().getHTML(),o=e._formatStatusComment(n);e.getControl("saveButton").load(),i.editStatus({data:{status_id:e.current_status,out:e.current_out,status_comment:o},onComplete:function(){e.getControl("saveButton").load(!1),e._statusChangeModal.hide(),e.getControl("editTextarea").getTextArea().setText(""),i.set("status_id",e.current_status.toString()),i.set("status_nb",e.current_status_nb.toString()),i.set("out",e.current_out?"1":"0"),i.set("color",e.current_color),i.set("status_color",e.current_color),i.set("status_title",e.current_title),e.initial_status_nb=e.current_status_nb,e.initial_out=e.current_out,e.alert("success",t.Statushasbeenchanged)}})}}})),e.addControl("editTextarea",new d({className:"status-change-textarea",rtePlaceholder:t.Provide,mandatory:!1,cssPlaceholder:!0})).switchToRTE()},_createIdeaShape:function(){var t=this.model;if(this._statusCollection&&this._statusCollection.length>1){var i=t.getAttributes(),n=this._statusCollection.slice();this._ideaShape&&this._ideaShape.destroy(),n.forEach(function(e){i.status_id===e.get("mid").toString()&&(i.status_nb=parseInt(e.get("status_nb"),10))}),this.initial_status_nb=i.status_nb,this.initial_out="1"===i.out,this.current_status_nb=this.initial_status_nb,this.current_out=this.initial_out,this._ideaShape=e.createElement("div",{class:"idea-shape",styles:{top:this._height/2+"px"}}),!1===this.initial_out&&this._ideaStatusArray&&this._ideaStatusArray[i.status_nb-1].appendChild(this._ideaShape)}},_createCurrentStatusPanel:function(){var i,n=this,a=n.model,r=a.isOut(),l=!r,c=a.canChangeStatus(),d=n._statusCollection.slice(),m=[];d.forEach(function(e,o,r){var d=!1;e.get("mid")===a.get("status_id")&&(i=e,d=!0),m.push({class:"dropdown-status-element"+(c?" can-edit":""),styles:{cursor:d||!c?"":"pointer"},html:[{class:"dropdown-status-icon",styles:{backgroundColor:d&&l?"#FFFFFF":e.get("color"),"border-color":e.get("color"),"border-width":d&&l?"5px":"0px"}},new s({value:e.get("title",{escapeHTML:!1})+(e.get("is_mature")?" "+t.Mature:""),className:"link status-button"+(d&&l?" current":""),disabled:d&&l||!c})],events:!c||d&&l?{}:{click:function(){n._changeStatus(e.get("status_nb"),!1)}}})}),m.push({class:"dropdown-status-element"+(c?" can-edit":""),styles:{cursor:r||!c?"":"pointer"},html:[{tag:"span",class:"fonticon fonticon-2x fonticon-cancel out-icon",styles:{"line-height":"20px"}},new s({value:t.Out,className:"link status-button out-button"+(r?" current":""),disabled:r||!c})],events:c&&l?{click:function(){n._changeStatus(null,!0)}}:{}});var u=new s({value:r?t.Out:i.get("title",{escapeHTML:!1}),className:"link status-button"});u.getContent().setStyle("background-color",r?"#D8D8D8":i.get("color"));var h=e.createElement("div",{styles:{display:"inline-block",cursor:"pointer"},html:[u,{tag:"span",class:"fonticon fonticon-down-open",styles:{"line-height":"23px","vertical-align":"bottom"}}]});return new o({target:h,body:{html:m},className:"status-dropdown"}),e.createElement("div",{class:"current-status-panel",styles:{display:r?"block":""},html:[r?t.Thisideais:t.Currentstatus,h]})},_changeStatus:function(e,i){var n=this;null===e&&(e=n.initial_status_nb),e==n.current_status_nb&&i==n.current_out||(n._statusCollection.forEach(function(t){e==t.get("status_nb")&&(n.current_status=t.get("mid"),n.current_status_nb=t.get("status_nb"),n.current_color=t.get("color"),n.current_title=t.get("title",{escapeHTML:!1}))}),n.current_out=i,e===n.initial_status_nb&&i===n.initial_out||(n._statusChangeModal?(n._statusChangeModal.setHeader({tag:"h4",text:n.current_out?t.Whyout:m.replace(t.Whyto,{status:n.current_title})}),n._statusChangeModal.show()):(n._createStatusChangeModalElements(),n._statusChangeModal=this.addControl("statusChangeModal",new a({header:{tag:"h4",text:n.current_out?t.Whyout:m.replace(t.Whyto,{status:n.current_title})},className:"fancy",body:[n.getControl("editTextarea")],footer:[n.getControl("saveButton"),n.getControl("cancelButton")],closable:!1})),n._statusChangeModal.show()),n.getControl("editTextarea").setFocus()))},setup:function(e){var t=this._parent.apply(this,arguments);return e&&e.height&&(this._height=e.height),this.model.getCommunity().get("mid")&&(this._statusCollection=this.model.getIdeaType().getStatusCollection(),this.reactTo(this._statusCollection,"onSync:read",function(){this.isDestroyed()||this.refresh()},this),this._statusCollection&&this.stopReactingTo(this._statusCollection,"onEdit"),this.reactTo(this._statusCollection,["onEdit"],function(){this.model&&this.refresh()}.bind(this))),t}})}),define("DS/SwymUIComponents/script/feature/community/idea/view/idea-detailed-view",["UWA/Core","DS/SwymUICore/script/feature/community/idea/model/idea-model","DS/SwymUIComponents/script/feature/community/content/view/content-detailed-view","DS/SwymUIComponents/script/feature/community/idea/view/idea-status-view","DS/SwymUIComponents/script/feature/community/idea/view/idea-transfer-view","DS/SwymUIComponents/script/feature/community/idea/view/idea-links-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/idea/view/idea-detailed-view","DS/SwymUICore/script/feature/core/config/bootstrap-model"],function(e,t,i,n,o,s,a,r){"use strict";return i.extend({_modelClass:t,name:"idea-detailed-view",defaultOptions:{forceCommentFetchIfNotDoneYet:!0},_createStatusSection:function(){return this.addChildView("statusView",{model:this.model,Class:n,height:12,widget:this._widget})},_createTransferSection:function(){var t=this.getChildView("transferView");return t||(t=this.addChildView("transferView",{model:this.model,Class:o,widget:this._widget})),e.createElement("div",{html:[t]})},_createLinksSection:function(){var t=this.getChildView("linksView");t?t.refresh():t=this.addChildView("linksView",{model:this.model,Class:s,widget:this._widget});var i=e.createElement("div",{html:[{class:"idea-links-title",html:a.RelatedLinks},t]});return this.reactTo(this.model.getAssociated("links"),"onSync",function(e){var t=this.model.getAuthor().get("hash_key")===r.getInstance().get("user").hash_key||this.model.getCommunity().getUserRole()>=3;this.model.hasBeenFetched()?0!==e.length||t?i.show():i.hide():this.reactTo(this.model,"onSync",function(t){var n=t.getAuthor().get("hash_key")===r.getInstance().get("user").hash_key||t.getCommunity().getUserRole()>=3;0!==e.length||n?i.show():i.hide()},this)},this),i},_createLeftColumn:function(){return{class:"content-body-section",html:[{class:"content-subtitle-section",html:[this._createAuthorSection(),this._createViewCounter()]},{class:"viewer-status-read-only",html:this._createStatusSection()},this._createDetailedView(),{class:"viewer-links-transfer",html:[{class:"viewer-transfer",html:this._createTransferSection()},{class:"viewer-links",html:this._createLinksSection()}]}]}},_createContent:function(){if(this.model)return[{class:"viewer-header",html:this._createTitleSection()},{class:"viewer-body",html:[{class:"viewer-top-section",html:this._createLeftColumn()},{class:"viewer-bottom-section"}]}]}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/content-community-tags-edition-view",["DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUIComponents/script/utils/swym-vue","DS/SwymUIComponents/script/utils/feature-activation-manager","DS/SwymUICore/script/lib/6wpanel/community-tags-manager","DS/SwymUICore/script/utils/usage-tracker","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/edit/content-community-tags-edition-view"],(e,t,i,n,o,s,a)=>{const{Vue:r}=i,l=r.extend({template:'\n        <div class="community-tags-content" v-if="sortedTags.length">\n          <SwymCommunityTagsHeader\n            class="tags-container"\n            ref="tagsView"\n            :NLS="NLS"\n            :tags="sortedTags"\n            :externalSeeMore="externalSeeMore"\n            :hideExpander="hideExpander"\n            @tagToggled="tagToggled"\n            @seeMoreStatusUpdated="updateSeeMore"\n            @listExpanded="listExpanded"\n          />\n        </div>\n      '}),c="onTagCreation",d="onTagDeletion";return e.extend({className:"content-community-tags-edition-view",vueComponent:null,tagsManager:null,setup(...e){return n.areCommunityTagsAvailable()&&(this.tagsManager=o.getInstance(),this.getOption("communityId")&&(this.model=new t({mid:this.getOption("communityId")})),this.getOption("content")&&(this.content=this.getOption("content"),this.listenTo(this.content,"onChange:tags6w",this.updateSelected,this))),this._parent(...e)},_createContent(){if(n.areCommunityTagsAvailable()){if(!this.vueComponent){const e=this;this.vueComponent=new l({data:()=>({tags:[],NLS:a,externalSeeMore:!1,open:!1,isSeeMoreVisible:!0,hideExpander:!0}),mounted(){this.fetchTags()},computed:{sortedTags(){return this.tags.sort((e,t)=>e.selected&&t.selected?0:e.selected?-1:t.selected?1:0)},selectedTags(){return this.tags.filter(e=>e.selected)},seeMoreText(){return`see ${this.open?"less":"more"}...`}},methods:{async fetchTags(){try{this.tags=await e.tagsManager.getCommunityTags({communitySubjectURI:e.model.getSubjectURI(),edition:!0}),e.updateSelected()}catch(e){this.tags=[]}},async tagToggled(t){const i=this.tags.findIndex(e=>e.object===t.object);if(i<0)return;const n=this.tags[i],o=n.selected?"remove":"add";await e.dispatchTagAction(n,o),this.$set(n,"selected",!n.selected)},listExpanded(t){let i="";i=e.content?t?"clickViewMoreInContentEditionFooter":"clickViewLessInContentEditionFooter":t?"clickViewMoreInContentCreationFooter":"clickViewLessInContentCreationFooter",s.trackPageEvent({category:"CommunityTags",label:i,view:"content-community-tags-edition-view",event:"click"})},setSelectedTags(e){this.tags.forEach(t=>{const i=e.findIndex(e=>e.sixw===t.sixw&&e.object===t.object_db)>-1;this.$set(t,"selected",i)})},expandList(){this.open=!this.open},updateSeeMore(e){},recheckSeeMore(){this.$refs.tagsView&&this.$refs.tagsView.recheckSeeMore()}},watch:{open(e){this.$refs.tagsView.expandList(e)}}}),this.vueComponent.$mount()}return this.vueComponent.$el}},setCommunityId(e){e&&this.vueComponent&&this.model&&(this.model=new t({mid:e}),this.vueComponent.fetchTags())},resetTags(){this.vueComponent&&this.vueComponent.setSelectedTags([])},getSelectedTags(){return this.vueComponent?[...this.vueComponent.tags.filter(e=>e.selected)]:[]},updateSelected(){if(!this.vueComponent||!this.content)return;const e=this.content.getTags().toJSON(),t=[];t.push(...e.map(e=>({object:e.object,sixw:e.sixw}))),this.vueComponent.setSelectedTags(t)},async dispatchTagAction(e,t){if(!this.content)return void s.trackPageEvent({category:"CommunityTags",label:"add"===t?"selectTagInContentCreationFooter":"deselectTagInContentCreationFooter",view:"content-community-tags-edition-view",event:"click"});const i="add"===t?c:d,n=o.tagAsObject(e);this.content[i](n,!1),s.trackPageEvent({category:"CommunityTags",label:"add"===t?"selectTagInContentEditionFooter":"deselectTagInContentEditionFooter",view:"content-community-tags-edition-view",event:"click"})},onShow(){this.updateSelected()},refreshTags(e){if(this.vueComponent)return this.model&&this.model.get("mid")!==e?void this.setCommunityId(e):void this.vueComponent.recheckSeeMore();this.model=new t({mid:e})},destroy(...e){return this.vueComponent&&(this.vueComponent.$destroy(),this.vueComponent=null),this._parent(...e)}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/content-editor-view",["UWA/Core","UWA/Event","UWA/Utils","UWA/Utils/Client","UWA/String","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/lib/event-manager","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUIComponents/script/feature/community/content/edit/content-type-selector","DS/SwymUIComponents/script/feature/core/search/view/community-selector/community-selector-view","DS/SwymUIComponents/script/feature/community/content/edit/content-editor-body-switcher-view","DS/SwymUIComponents/script/feature/community/content/edit/content-community-tags-edition-view","DS/SwymUIComponents/script/utils/content-creation-types-manager","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/core/history/history-model","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/lib/model/generic/6wtaggable-model","DS/SwymUIComponents/script/feature/core/ui-components/layout/layout-manager","DS/SwymUIComponents/script/feature/community/content/edit/paragraph-formatter","DS/SwymUIComponents/script/utils/content-upload-error","DS/UIKIT/Input/Button","DS/UIKIT/Input/ButtonGroup","DS/UIKIT/Tooltip","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/edit/content-creation-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/generic/view/simple-editor-view","DS/UWPClientControls/PlatformNotify","DS/WebappsUtils/WebappsUtils","DS/Logger/Logger","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/lib/6wpanel/community-tags-manager","DS/SwymUIComponents/script/feature/core/auto-save/view/auto-save-view","DS/SwymUIComponents/script/feature/core/modal/super-modal","DS/UIKIT/Popover","DS/UIKIT/Toggler","DS/SwymUICore/script/feature/core/auto-save/auto-save-manager","DS/SwymUIComponents/script/feature/community/content/edit/rich-link-preview/rich-link-preview-utils","DS/SwymUICore/script/utils/localstorage-manager","DS/SwymUICore/script/utils/usage-tracker","DS/SwymUIComponents/script/utils/ui-constants","DS/SwymUICore/script/feature/core/context/context-constants","DS/SwymUIComponents/script/feature/community/template/template-manager","DS/SwymUIComponents/script/utils/typing-indicator-manager","DS/SwymUIComponents/script/utils/feature-activation-manager","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUIComponents/script/feature/core/auto-save/recovery-modal"],(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w,C,f,y,v,A,_,S,b,I,D,T,E,U,k,x,M,V,P,N,O,R,L,B,F,W,q,H,z,j)=>{const K=C.extend({_modelName:"content-creation-dummy-taggable-model",getContainerId(){const e=this.get("containerId");return e?new Promise(t=>{require(["DS/SwymUICore/script/feature/community/community/model/community-model"],i=>{const n=new i({mid:e});try{const e=n.getSubjectURI();t(e)}catch(e){t("")}})}):Promise.resolve("")}});return r.extend({_titleContent:"",_content:null,_context:null,_communityId:null,_uploadingState:!1,_saveFailedDueToUploading:!1,_publishDisabled:!1,_previouslyActiveProxyManagers:null,_taggerProxyManager:null,_taggerProxyManagerName:"",_taggableModel:null,_taggerShowRequested:!1,_fetchCommunities:!0,_scrollerContentSelector:".editor-scroller-content",_contentTypeSelectorClass:null,_templateManager:null,_autosaveBlocked:!1,_modelEvents:{"onSync:read":"refresh"},name:"content-editor-view",className:"fade-in-animation",domEvents:{"click .publish-button":"onPublishButtonClick","click .send-button":"onSendButtonClick","click .next-button":"_goToNextStep","click .previous-button":"_goToPreviousStep","focusin .content-title-text":"onTitleFocus","focusout .content-title-text":"onTitleBlur","keydown .content-title-text":"onTitleKeydown","keyup .content-title-text":"onTitleInput","input .content-title-text":"onTitleInput","click .attachment":"_onOpenMediaLibrary","click .paragraph":"_onOpenParagraph","click .content-title-section .maximize":"switchToMaximizedView","click .content-editor-body-switcher-view-container":"onTitleOrBodyClick","click .content-title":"onTitleOrBodyClick","click .your-communities":"_onYourCommunitiesClick","click .content-edition .actions .fonticon-wrong":"onCancel"},uiConfiguration:{instantMessageRTE:{maximizeAvailableInMinimizedMode:!1,mediaLibAvailableInMinimizedMode:!1,saveAsDraft:!1,expandOnClick:!0},simpleRTE:{maximizeAvailableInMinimizedMode:!0,mediaLibAvailableInMinimizedMode:!0,saveAsDraft:!0,expandOnClick:!0},advancedRTE:{maximizeAvailableInMinimizedMode:!1,mediaLibAvailableInMinimizedMode:!1,saveAsDraft:!0,expandOnClick:!1,maximizedOnly:!0},mediaCreator:{maximizeAvailableInMinimizedMode:!1,mediaLibAvailableInMinimizedMode:!1,saveAsDraft:!0,expandOnClick:!0},mediaEditor:{maximizeAvailableInMinimizedMode:!1,mediaLibAvailableInMinimizedMode:!1,saveAsDraft:!1,expandOnClick:!1,maximizedOnly:!0},surveyCreator:{maximizeAvailableInMinimizedMode:!1,mediaLibAvailableInMinimizedMode:!1,saveAsDraft:!0,expandOnClick:!0,maximizedOnly:!0},wikiCreator:{maximizeAvailableInMinimizedMode:!1,mediaLibAvailableInMinimizedMode:!1,saveAsDraft:!1,expandOnClick:!1,maximizedOnly:!0},wedoCreator:{maximizeAvailableInMinimizedMode:!0,mediaLibAvailableInMinimizedMode:!0,saveAsDraft:!1,expandOnClick:!0},socialEventCreator:{maximizeAvailableInMinimizedMode:!0,mediaLibAvailableInMinimizedMode:!0,saveAsDraft:!1,expandOnClick:!0},advancedSocialEventCreator:{maximizeAvailableInMinimizedMode:!0,saveAsDraft:!1,expandOnClick:!0,maximizedOnly:!0},advancedRitualCreator:{maximizeAvailableInMinimizedMode:!0,saveAsDraft:!1,expandOnClick:!0,maximizedOnly:!1},advancedWedoCreator:{maximizeAvailableInMinimizedMode:!0,saveAsDraft:!1,expandOnClick:!0,maximizedOnly:!0}},executeListenerIfVisible(e){const t=this;return function(){if(t&&t.isVisible&&t.isVisible())return e.apply(this,arguments)}},onTitleKeydown(e){if(9===e.keyCode){const t=this.getChildView("body").getChildView("simpleRTE");if(!t)return;const i=t.getChildView("rte");i._switchedToRTE||(e.preventDefault(),i.switchToRTE())}},removeSendButton(){this.container.removeClassName("with-send")},addContentTypeSelector(){this.container.removeClassName("without-selector")},addSendButton(){this.container.addClassName("with-send")},removeContentTypeSelector(){const e=(t=this.container).getSize&&t.getSize().width;var t;e&&e<=B.DeviceWidth0&&this.container.addClassName("without-selector")},isSendButtonDisplayed(){return this.container.hasClassName("with-send")},getCreationModeFromModelName(t,i){let n;switch(t){case"media":n=this.model&&this.model.get("mid")?"mediaEditor":"mediaCreator";break;case"survey":n="surveyCreator";break;case"wiki":e.is(i,"boolean")||(i=this.isMaximized()),n=i?"advancedRTE":"wikiCreator";break;case"message":case"comment":n="instantMessageRTE";break;case"wedo":e.is(i,"boolean")||(i=this.isMaximized()),n=i?"advancedWedoCreator":"wedoCreator";break;case"social-event":e.is(i,"boolean")||(i=this.isMaximized()),n=i?"advancedSocialEventCreator":"socialEventCreator";break;case"ritual":n="advancedRitualCreator";break;default:e.is(i,"boolean")||(i=this.isMaximized()),n=i?"advancedRTE":"simpleRTE"}return n},getCurrentContentType(){return this.model&&this.model.get("mid")?this.model.getModelName():!0===this.getOption("createMessagesOnly")?h.MESSAGE:this._typesManager.getCurrentContentType()},getCurrentMode(e){let t;return t=this.model&&this.model.get("mid")?this.getCreationModeFromModelName(this.model.getModelName(),!0):!0===this.getOption("createMessagesOnly")?this.getCreationModeFromModelName(h.MESSAGE,e):this._typesManager&&this.getCreationModeFromModelName(this._typesManager.getCurrentContentType(),e)},getClassNames(){let e=this._parent.apply(this,arguments)||"";return this.uiConfiguration[this.getCurrentMode()]&&!0===this.uiConfiguration[this.getCurrentMode()].maximizedOnly&&(e+=" detailed-content"),e},_onOpenMediaLibrary(){L.trackPageEvent({category:"ContentCreation",label:"openMediaLibrary",view:"content-editor-view",event:"click"}),this.getElement(".attachment").hasClassName("disabled")||require(["DS/SwymUIComponents/script/feature/community/media/library/media-library-view"],e=>{const t=new e({communityId:this.getSelectedCommunityID()});t.injectInDom(),this.listenTo(t,{newMediaAdded(e){const{newMedia:i}=e,{existingMedia:n}=e;E.log("media should be uploaded"),i&&Array.isArray(i)&&i.length>0&&this.addMedia(i),n&&Array.isArray(n)&&n.length>0&&this.addMedia(n),L.trackPageEvent({category:"ContentCreation",label:"uploadMedia",view:"content-editor-view",event:"upload"}),t.destroy()}})})},_onOpenParagraph(){const e=this.getChildView("paragraphFormatter"),t=this.container.getElement(".right-elements"),i=this.container.getElement(".left-elements .attachment"),n=this.container.getElement(".left-elements");event.stopPropagation(),e&&e.isVisible()?(e.hide(),t&&t.show(),i&&i.show(),n&&n.removeClassName("activated"),L.trackPageEvent({category:"ContentCreation",label:"closeParagraphFormatter",view:"content-editor-view",event:"click"})):(e&&e.show(),t&&t.hide(),i&&i.hide(),n&&n.addClassName("activated"),L.trackPageEvent({category:"ContentCreation",label:"openParagraphFormatter",view:"content-editor-view",event:"click"}))},_isOnCreationMode(){return!this.model||!this.model.get("mid")},switchToMaximizedView(e){const t=this.getElement(".maximize"),i=this.getChildView("paragraphFormatter"),n=this.container.getElement(".left-elements");L.trackPageEvent({category:"ContentCreation",label:e?"switchToAdvancedCreation":"automaticSwitchToAdvancedCreation",view:"content-editor-view",event:e?"click":""}),!t||t.hasClassName("disabled")||this._publishDisabled||(this._isOnCreationMode()&&this._context.setTemporaryState(!0),this.dispatchEvent("onSwitchToMaximizedView",[this]),this.container&&this.container.addClassName("detailed-content"),i&&i.hide(),n&&n.removeClassName("activated"),this._getBodyView().switchTo(this.getCurrentMode(!0)),this._isOnCreationMode()&&this._displayNewModelTaggerView(),this.maximizeTouchDevices(),this._populateCommunitySelector(),f.dispatchEvent("onInfiniteScrollDesactivationRequest"),this.refresh())},switchToMinimizedView(){this._setMinimizedContentCreation(),this.dispatchEvent("onSwitchToMinimizedView",[this]),this.container&&this.container.removeClassName("detailed-content"),this.unMaximizeTouchDevices(),f.dispatchEvent("onInfiniteScrollActivationRequest"),this.getControl("paragraphModal")&&this.getControl("paragraphModal").hide(),this.refresh()},_navigateToPreviousContext(){const{model:e}=this;(e&&!e.isNew()||this._typesManager.wasProgrammaticallyChanged())&&g.back(),this.dispatchEvent("onBack",[this])},_getContenticonEl(){let t=this.getChildView("content-icon");return t||(t=this.model&&!this.model.isNew()?e.createElement("div",{class:`content-icon ${this.model.getIconWrapperClass()}`,html:{tag:"span",class:`fonticon fonticon-2x fonticon-${this.model.getIconClass()}`}}):this.addChildView("content-icon",{Class:this.contentTypeSelectorClass})),t},_createTitleSection(t){const{model:i}=this;let n,o=!0;const s=e.createElement("span",{class:"maximize left-icon fonticon fonticon-2x fonticon-resize-full"});if(i&&(this._titleContent=this.model.hasVirtuallyChanged("title")?i.getChanges("title",{escapeHTML:!1}):i.get("title",{escapeHTML:!1}),"survey"===i.getModelName()&&"1"===String(i.get("published"))&&(o=!1),"social-event"===i.getModelName())){const e=i&&i.getAssociated("author"),t=e&&e.get("login");z.getInstanceFetched(e=>{t&&t!==e.get("login")&&(o=!1)})}return n={class:"content-title-section",html:[{class:"content-title",html:[!1===o?{tag:"div",class:"content-title-text",text:this._titleContent}:{tag:"input",type:"text",class:"content-title-text",placeholder:this.getPlaceholderValue(),value:this._titleContent}]},t?"":[this.addChildView("auto-save",{Class:x}),{tag:"span",html:s}]]},this.addControl("expandIconTooltip",new S({target:s,body:b.Maximize})),n},_createActions(){let t;const i=e.createElement("span",{class:"fonticon fonticon-wrong"});return t={class:"actions",html:[this.addChildView("auto-save",{Class:x}),{tag:"span",html:i}]},this.addControl("cancelIconTooltip",new S({target:i,body:b.Cancel})),t},onDocumentCreationRequest(e){const t=this.getSelectedCommunityID(),i=this._getBodyView().getContentAttributes(),n=!!this._context.isDirectMessageContext(),o=this._titleContent;t?(e.communityId=t,n?e.isIllustration=!1:i&&"boolean"==typeof i.is_illustration&&(e.isIllustration=i.is_illustration),e.communityId=t,e.titleContent=o,require(["DS/SwymUIComponents/script/feature/community/media/view/document/document-creation-manager"],t=>{t.launchDocumentCreation(e)})):this.validateCommunity()},_createBodyView(){const e=this.getChildView("body")&&this.getChildView("body").cid,t=this.addChildView("body",{Class:m,model:this.model,currentMode:this.getCurrentMode(),communityId:this._context.isCommunityContext()?this.getSelectedCommunityID():void 0,contentEditorView:this,addScroller:this.isMaximized(),checkModel:!1});return t&&e!==t.cid&&this.listenTo(t,{triggerDocumentCreationRequest:this.onDocumentCreationRequest,onContentChange:this.onContentChange,onOpenMediaLibraryRequest:this._onOpenMediaLibrary,onEnterKeyPressed:function(){this.onMessageCommentPublishRequest({source:"enterKey"})}.bind(this),onSwymImgPaste:function(){const e=h.getInstance();-1===e.getContentTypes().indexOf(h.POST)?this.alert("warn",b.MediaPasteNoRights):setTimeout(()=>{R.removeItem(this._getLocalStorageKeyForMessage()),this._publishDisabled=!1,this.switchToMaximizedView(),e.setContentTypeRequest({type:"post",updateIcon:!0,forceFocus:!1,userAction:!0})},0)}.bind(this),onMediaUploadsStart(){if("mediaCreator"!==this.getCurrentMode()&&this._communityId){const e="message"===this.getCurrentContentType();this.switchToUploadingState({maskView:e}),this.dispatchEvent("onMediaUploadsStart")}},onMediaUploadsComplete(){if("mediaCreator"!==this.getCurrentMode()&&"message"!==this.getCurrentContentType())this.leaveUploadingState(),this.dispatchEvent("onMediaUploadsComplete");else if("message"===this.getCurrentContentType()){const e=h.getInstance();this.leaveUploadingState(),this.dispatchEvent("onMediaUploadsComplete"),o.stripTags(this.getBodyAttributes().content)?(R.removeItem(this._getLocalStorageKeyForMessage()),this._publishDisabled=!1,this.switchToMaximizedView(),e.setContentTypeRequest({type:"post",updateIcon:!0,forceFocus:!1,userAction:!0})):e.setContentTypeRequest({type:"media",updateIcon:!0,forceFocus:!1,userAction:!0}),this.expand()}},onMediaUploadsFailure(){"mediaCreator"!==this.getCurrentMode()&&(this.leaveUploadingState(),this.dispatchEvent("onMediaUploadsFailure"),this.enablePublishButton())},onPlaceholderAdded(){H.isFeatureActivated("activateIMSendButton")&&(this.removeSendButton(),this.addContentTypeSelector())},onPlaceholderRemoved(){H.isFeatureActivated("activateIMSendButton")&&"instantMessageRTE"===this.getCurrentMode()&&(this.addSendButton(),this.removeContentTypeSelector())}}),t},_getBodyView(){let e=this.getChildView("body");return e||(this._createBodyView(),e=this.getChildView("body")),e},_getCreationRightsMessage(){return e.createElement("div",{class:"no-creation-rights err-msg",styles:{"word-break":"normal","overflow-wrap":"break-word","word-wrap":"break-word",display:"none","text-align":"center",padding:"15px 0 5px 0"},html:{tag:"span",html:[b.NoCreationRights," ",{tag:"a",class:"your-communities",html:b.YourCommunities}," ",b.ToBecomaAnAuthor,"ritual"===this._typesManager.getCurrentContentType()?` ${b.OfPrivateOrSecretCommunity}`:"","."]}})},enablePublishRequest(){const e=this.getControl("publishButton"),t=this.getControl("draftMenuButton"),i=this.getElement(".publish-section"),n=this.getElement(".content-editor-body-switcher-view-container"),o=this.getElement(".no-creation-rights");this._publishDisabled&&this.expand(),this._publishDisabled=!1,e&&e.setDisabled(this._publishDisabled),t&&t.setDisabled(this._publishDisabled),o&&o.hide(),i&&i.show(),n&&n.show()},disablePublishRequest(){const e=this.getControl("publishButton"),t=this.getControl("draftMenuButton"),i=this.getElement(".publish-section"),n=this.getElement(".content-editor-body-switcher-view-container"),o=this.getElement(".no-creation-rights");this._publishDisabled=!0,this.contract(),e&&e.setDisabled(this._publishDisabled),t&&t.setDisabled(this._publishDisabled),i&&i.hide(),n&&n.hide(),o&&o.show()},displayAttachmentIcon:e=>"wedo"!==e||"wedo"===e&&!n.Features.touchEvents,_createPublishBarLeftElements(){let t={display:"none"};const i=this.getCurrentContentType();let o,s,a,r=this.getChildView("paragraphFormatter");const l=this.getChildView("body").getChildView("advancedRTE")||this.getChildView("body").getChildView("advancedSocialEventCreator")||this.getChildView("body").getChildView("advancedRitualCreator")||this.getChildView("body").getChildView("advancedWedoCreator"),c=this.displayAttachmentIcon(i);let d;return n.Features.touchEvents&&l&&!r&&(r=this.addChildView("paragraphFormatter",new y({className:"paragraph-touch",extraEditor:l,mode:"touch"}))).hide(),"media"!==i&&(t=""),n.Features.touchEvents&&l&&(o={tag:"span",class:"paragraph left-icon fonticon fonticon-2x fonticon-text"}),s=e.createElement("span",{class:"attachment left-icon fonticon fonticon-2x fonticon-attach",styles:t}),d={class:"left-elements",html:[o,a=e.createElement("span",{class:"arrow-right-shape",styles:t}),c?s:"",r]},s&&this.addControl("attachmentIconTooltip",new S({target:s,body:b.InsertMedia})),"survey"!==this.getCurrentContentType()?d:""},_goToPreviousStep(){this._setNextButton(),this.getControl("previousButton").hide(),this._getBodyView().goToPreviousStep()},_goToNextStep(){this.validateFirstStepContent()&&(this._setPublishButton(),this.getControl("previousButton")&&this.getControl("previousButton").show(),this._getBodyView().goToNextStep())},_setPublishButton(){const e=this.getControl("publishButton");e&&(e.getContent().addClassName("publish-button"),e.getContent().removeClassName("next-button"),e.setIcon("check"),"social-event"===this.getCurrentContentType()?e.setValue(b.Schedule):e.setValue(b.Publish))},_setNextButton(){const e=this.getControl("publishButton");e&&(e.getContent().removeClassName("publish-button"),e.getContent().addClassName("next-button"),e.removeIcon(),e.setValue(b.Next))},_createPublishBar(){let e,t,i,n;const o="survey"===this.getCurrentContentType()&&(!this.model||this.model&&"0"===this.model.get("published"));return o&&(n=this.addControl("previousButton",new A({value:b.Previous,className:"default previous-button"}))).hide(),this._publishDisabled=!1,e=this.addControl("publishButton",new A({value:o?b.Next:b.Publish,disabled:this._publishDisabled,className:o?"primary next-button":"primary publish-button",icon:o?null:"check"})),i=this.addControl("draftMenuButton",new A({disabled:this._publishDisabled,className:"primary",dropdown:{items:[{text:b.Saveasdraft,className:"draft-item"}]},events:{onDropdownClick:function(e,t){E.log(t),this.onPublishButtonClick(null,{published:0})}.bind(this)}})),t=new _({buttons:[e,i]}),this.model&&1===parseInt(this.model.get("published"),10)||!1===this.uiConfiguration[this.getCurrentMode()].saveAsDraft||"wiki"===this.getCurrentContentType()?(i.hide(),e.elements.container.addClassName("btn-group-alone")):i.show(),{class:`publish-section${this._context.isCommunityContext()?" community":""}`,html:[this._createPublishBarLeftElements(),{class:"right-elements",html:[this._isOnCreationMode()?this.getCommunitySelector():"",{tag:"div",class:"buttons",html:[n,t,this.addControl("cancelButton",new A({value:b.Cancel,className:"default btn-cancel",styles:{width:""},icon:"wrong",events:{onClick:function(){this.onCancelBound(!0)}.bind(this)}}))]}]}]}},removeInvalidationForPublish(){this.container&&this.container.hasClassName("invalid")&&this.container.removeClassName("invalid"),this.updateTitlePlaceholder()},markViewAsInvalidForPublish(){D.info(b.get("Somerequiredfieldsaremissing")),this.container&&!this.container.hasClassName("invalid")&&this.container.addClassName("invalid"),this.updateTitlePlaceholder()},_createContent(){const e=this._createBodyView(),t=this._createPublishBar();let i=[{class:"editor-scroller-content",html:[this._getContenticonEl(),this._createTitleSection(!0),this._createActions(),e]},this._getCreationRightsMessage(),this._createCommunityTagsView(),t];n.Features.touchEvents&&(i=[this._getContenticonEl(),{class:"editor-scroller-content",html:[this._createTitleSection(!0),this._createActions(),t,e]},this._getCreationRightsMessage(),this._createCommunityTagsView()]);const o=[this.isMaximized()?"":this.addChildView("repliedContentView",{Class:"DS/SwymUIComponents/script/feature/community/content/edit/replied-content-view",creationMode:!0}),{class:"content-edition",html:this.isMaximized()?i:[this._getContenticonEl(),this._createTitleSection(!1),e,this._getCreationRightsMessage(),t]}];return this._isCurrentModeMessageOrReply()?[{tag:"div",class:"content-edition-wrapper",html:o},this._createSendButton()]:o},_isCurrentModeMessageOrReply(){return"instantMessageRTE"===this.getCurrentMode()},_createCommunityTagsView(){let e=this.getChildView("communityTagsView");const t=this.getSelectedCommunityID();return e||(e=this.addChildView("communityTagsView",new u({communityId:t,content:this.model}))),e.refreshTags(t),e},_createSendButton(){const t=e.createElement("span",{class:"fonticon fonticon-send"});return{tag:"div",class:"send-button",html:[t,new S({target:t,body:b.Send})]}},changeContentTypeClass(e){const t=this;this._typesManager.getAllPossibleContentTypes().forEach(i=>{i===e?!t.container.hasClassName(i)&&t.container.addClassName(i):t.container.hasClassName(i)&&t.container.removeClassName(i)}),"message"===e?setTimeout(()=>{this.isDestroyed()||(this._getBodyView()&&this.isBodyContentEmpty()?(this.removeSendButton(),this.addContentTypeSelector()):(this.addSendButton(),this.removeContentTypeSelector()))},10):(this.removeSendButton(),this.addContentTypeSelector())},updateTitlePlaceholder(){let e;this.isDestroyed()||(e=this.getElement(".content-title-text"))&&e.set("placeholder",this.getPlaceholderValue())},getPlaceholderValue(){const e=this.getCurrentContentType(),t=h.getInstance().getTypeItemData(e);return this.container&&this.container.hasClassName("invalid")?`${t.placeholder_focused} *`:this.container&&(this.container.hasClassName("expanded")||this.container.hasClassName("detailed-content"))||this.model?t.placeholder_focused:t.placeholder},onTitleFocus(e){const i=t.getElement(e).value;this._titleContent=i,this.updateTitlePlaceholder()},onTitleBlur(){this.updateTitlePlaceholder()},onTitleInput(e){const i=t.getElement(e).value;i&&i.trim();let n="";this.model&&(n=this.model._attributes.mid),i!==this._titleContent&&(this._titleContent=i,this.dispatchEvent("onContentTitleChange",[i,n]))},onContentTitleChange(e,t,i){this.onContentChange(i),this.model&&this.model.addChanges("title",e)},isContentEmpty(){let e=!1;return this._titleContent.length<=0&&this.isBodyContentEmpty()&&(e=!0),e},isBodyContentEmpty(){return this._getBodyView().isContentEmpty()},resetBodyContent(){return this._getBodyView().resetContent()},resetCommunitySelector(){const e=this.getCommunitySelector();e&&e.unselectCommunity()},clearUndoTextInEditor(){return this._getBodyView().clearUndoTextInEditor()},removeTagsFromContent(){return this._getBodyView().removeTagsFromContent()},resetEditorViews(){return this._getBodyView().resetEditorViews()},getMediaCollectionLength(){return this._getBodyView().getMediaCollectionLength()},uploadMedia(e){return this._getBodyView().uploadMedia(e)},addMedia(e){return this._getBodyView().addMedia(e)},getBodyAttributes(e){return this._getBodyView()&&this._getBodyView().getContentAttributes(e)},validateContent(e){return this._getBodyView().validateContent(e)},validateCommunity(e){return this.getCommunitySelector().validate(e)},validateFirstStepContent(){return this._getBodyView().validateFirstStepContent()},_getLocalStorageKeyForMessage(){return`3DSwym-${this._communityId}-message`},onContentChange(e){const t=e&&!1===e.userInput;if(E.log("content has changed in onContentChange"),!this.isContentEmpty()||"survey"===this.getCurrentContentType()&&this.isMaximized()?(this.removeInvalidationForPublish(),this.markContentAsNonEmpty(),"ritual"===this.getCurrentContentType()||t||this._launchAutoSaveThrottled()):this.markContentAsEmpty(),this.getCurrentContentType()===h.MESSAGE&&q[this.isContentEmpty()?"onMessagePublish":"typeIn"](),this._getBodyView()._getCurrentView()&&"instant-message-rte"===this._getBodyView()._getCurrentView().name){const e=this.getBodyAttributes();e&&e.content&&R.setItem(this._getLocalStorageKeyForMessage(),e.content)}},markContentAsNonEmpty(){const e=this.getElement(".content-edition");e&&!e.hasClassName("non-empty")&&(e.addClassName("non-empty"),this.expand())},markContentAsEmpty(){const e=this.getElement(".content-edition");e&&e.hasClassName("non-empty")&&e.removeClassName("non-empty")},canPublishOrSaveAsDraft(e){let t,i=!1;const n=window.widget&&window.widget.getAppName&&window.widget.getAppName()===U.getContentReaderAppKey(),o=Boolean(e&&0===e.published),s=this._titleContent.length>0&&this._titleContent.length<256||"mediaCreator"===this.getCurrentMode()||"message"===this.getCurrentContentType(),a=this.validateContent({publish:!o,saveAsDraft:o}),r=this.validateCommunity();return s&&a?i=!(!this._context.isCommunityContext()&&!n)||r:e&&0===e.published?s||a?i=!!this._context.isCommunityContext()||r:!1===s?this.getElement(".content-title-text").focus():!1===a&&(t=this._getBodyView().getElement(".editable-container"))&&t.focus():!1===s?(0===this._titleContent.length&&this.emptyTitle(),this.getElement(".content-title-text").focus()):!1===a&&(t=this._getBodyView().getElement(".editable-container"))&&t.focus(),this._titleContent.length>255&&D.error(b.TitleSizeExceeded),i},switchToUploadingState(e){this._uploadingState=!0,e&&!1===e.maskView||(this._uploadMask=!0,this.mask(b.UploadingMedia))},leaveUploadingState(){!0===this._uploadingState&&(this._uploadingState=!1,this._saveFailedDueToUploading=!1,!0===this._uploadMask&&(this._uploadMask=!1,this.unmask()))},switchToPublishingState(){"message"!==this.getCurrentContentType()&&this.mask(b.Publishing)},switchToSavingAsDraftState(){this.mask(b.SavingAsDraft)},_setDefaultTitleAndPlaceholder(e){const t=this;e.hasBeenFetched()&&0===e.length&&e.communityId===t._context.getData().communityId&&t.expand()},setTitleValue(e){const t=this.getElement(".content-title-text");this._titleContent=e,t&&t.set("value",this._titleContent)},getTitleValue(){return this._titleContent},init(){this.onCancelBound=this.onCancel.bind(this),this.onCancelBoundIfVisible=this.executeListenerIfVisible(this.onCancelBound),this.onCommunityChangeBound=this.onCommunityChange.bind(this),this.onContentTypesChangeBound=this.onContentTypesChange.bind(this),this.onCurrentContentTypeChangeBound=this.onCurrentContentTypeChange.bind(this),this.onCurrentContentTypeChangeBoundIfVisible=this.executeListenerIfVisible(this.onCurrentContentTypeChangeBound),this._onContextChangeAttemptBound=this._onContextChangeAttempt.bind(this),this.contentTypeSelectorClass=c;const e=U.cancellableThrottle(this._launchAutoSave,5e3);return this._launchAutoSaveThrottled=e.throttle,this._cancelAutoSaveThrottled=e.cancel,this._parent.apply(this,arguments)},setup(){const e=this;return n.Features.touchEvents&&(this.uiConfiguration.simpleRTE.maximizedOnly=!0,this.uiConfiguration.simpleRTE.mediaLibAvailableInMinimizedMode=!0,this.uiConfiguration.advancedRTE.mediaLibAvailableInMinimizedMode=!0),this._context=p.getInstance(),this._typesManager=h.getInstance(),this._context.addListener("onBack",this.onCancelBoundIfVisible),this.autoSave=N.getInstance(),this._isOnCreationMode()&&(this._context.addListener("onCommunityChange",this.onCommunityChangeBound,this,!0),!0!==this.getOption("createMessagesOnly")&&(this._typesManager.addEvent("onContentTypesChange",this.onContentTypesChangeBound,this,!0),this._typesManager.addEvent("onCurrentContentTypeChange",this.onCurrentContentTypeChangeBoundIfVisible,this,!0))),this.getOption("isTemplateFeatureEnabled")&&this._initTemplateManager(),!0===this.uiConfiguration[this.getCurrentMode()].expandOnClick&&(this.onDocumentBodyClickBound=this.onDocumentBodyClick.bind(this),document.body.addEvent("click",this.onDocumentBodyClickBound)),this._context.addListener("onContextChangeAttempt",this._onContextChangeAttemptBound,this,!1),e.reactTo(f,{onCommunityWhatsnewEmpty(t){"whatsnew"===t&&e._context.isCommunityContext()&&f.dispatchEvent("GetItemListCollection")},ReturnItemListCollection:e._setDefaultTitleAndPlaceholder}),e._context.isCommunityContext()&&f.dispatchEvent("GetItemListCollection"),this._context.dispatchEvent("onContentEditorViewRendered"),this.listenTo(a,"onEventReply",e=>{if(e&&e.model){this.repliedModel=e.model;const t=this.repliedModel.get("message_type");let i=I.ReplyAnInstantMessage,n="message";"INTERNAL_EVENT"===t&&(n="comment",i=I.ReplyAComment),this._typesManager.setContentTypeRequest({type:n,updateIcon:!0,forceFocus:!1,commentSubjectContentType:this.repliedModel.get("message_details->subject_model")});const o=this._getBodyView()._getCurrentView().getChildView("rte");o&&(o.updatePlaceHolder(i),o.updateEditor(void 0,{focus:!0}),this.enablePublishRequest(),this.expand())}}),this._parent.apply(this,arguments)},_initTemplateManager(){const e=this;this._templateManager=W.getInstance(),this.listenTo(this._templateManager,"templateAvailable",t=>{require(["DS/SwymUIComponents/script/lib/ckeditor/ckeditor"],i=>{const n=t.wikiEditorView?t.wikiEditorView._getBodyView()._getCurrentView().getRTEView():e._getBodyView()._getCurrentView().getChildView("rte");n&&(t.wikiEditorView?t.wikiEditorView.setTitleValue(t.template.title):e.setTitleValue(t.template.title),n.updateEditor(o.unescapeHTML(t.template.content)))})}),this.listenTo(this._templateManager,"noTemplateAvailable",()=>{(e._context.getRoute().contains("search")||e._context.dmId)&&"social-event"===e._typesManager.getCurrentContentType()||e.isContentEmpty()||(e.emptyTitle(),e.resetBodyContent())})},getTemplateManager(){return this._templateManager},_onContextChangeAttempt(e){this.isVisible()&&this.isMaximized()&&(this.model||!this._context.isHomePageContext()&&!this._context.isCommunityHomePageContext()||this.onCancel(!(e&&e.success)))},_onAutoSave(){if(this.isVisible()){const e=this,t=this.getCommunitySelector();let i;const n=h.getInstance();let o;this.autoSave.hasBeenRestored||((o=this.autoSave.getAutoSaveModel())?(e.getChildView("body")&&e.getChildView("body").resetContent(),e.model=o,i=o.get("community").mid,e.setTitleValue(o.getChanges("title")||o.get("title")),o.get("revision_description")&&(e.getControl("majorEditionCheckbox")&&e.getControl("majorEditionCheckbox").setCheck(),e.getControl("revisionInput")&&e.getControl("revisionInput").setValue(o.get("revision_description")),e.getControl("revisionInput")&&e.getControl("revisionInput").show()),o.get("mid")||e.isMaximized()||(e.refresh(),e.switchToMaximizedView(),n.setContentTypeRequest({type:o.getModelName(),updateIcon:!0,forceFocus:!1,userAction:!0}),i&&t&&(t.isCommunitySyncComplete()?t.selectCommunity(i):t.addEventOnce("onCommunitySyncComplete",()=>{t.selectCommunity(i)}))),this.autoSave.hasBeenRestored=!0,o.getChanges("expired")&&(e.displayOutdatedModal&&e.displayOutdatedModal(),e._clearAutoSave())):this.autoSave.addEventOnce("onContentRecoveryRequest",this._onAutoSave,this))}},isMaximized(){return!!this.container&&this.container.hasClassName("detailed-content")},onRedraw(){this.container.addClassName(this.getCurrentContentType()),this.container.getElement(".publish-section")&&this.container.getElement(".publish-section").setHTML(this._createPublishBar().html),this._applyTemplate()},_applyTemplate(){this._templateManager&&this._templateManager.isTemplateFeatureEnabled()&&this._templateManager.notifyTemplateAvailability()},setCommunityId(e){q.setThreadId(e);const t=this.getChildView("communityTagsView");return t&&t.setCommunityId(e),this._getBodyView().setCommunityId(e)},_updateInstantMessageEditorIfLocalStorage(){if("message"===this.getCurrentContentType()){const e=R.getItem(this._getLocalStorageKeyForMessage()),t=this._getBodyView()._getCurrentView().getChildView("rte");t&&(e&&o.unescapeHTML(e)?t.updateEditor(e):t.resetEditor())}},onCommunityChange(){let e;this.isDestroyed()||(e=this.getCommunitySelector(),this._context.isCommunityContext()?(e&&e.container&&e.container.addClassName("hidden"),this.getElement(".publish-section")&&this.getElement(".publish-section").addClassName("community"),this._communityId=this._context.getData().communityId,this._context.isContentContext()||this.setCommunityId(this._communityId),f.dispatchEvent("GetItemListCollection")):(this._communityId=null,this.setCommunityId(this._communityId),e&&e.container&&e.container.removeClassName("hidden"),this.getElement(".publish-section")&&this.getElement(".publish-section").removeClassName("community")),this._context.contentId||!0!==this.getOption("createMessagesOnly")&&this.isRendered()&&this.updateContentType(),this.removeRepliedContent(),this._updateInstantMessageEditorIfLocalStorage())},onTitleOrBodyClick(){if("wikiCreator"!==this.getCurrentMode()){if(!this.isMaximized()&&!0===this.uiConfiguration[this.getCurrentMode()].maximizedOnly&&this.getCurrentContentType()!==h.MESSAGE&&this.getCurrentContentType()!==h.COMMENT){this.switchToMaximizedView(),this.getElement(".content-title-text").focus()}}else this.dispatchEvent("showWikiEditor")},onDocumentBodyClick(i){let n,o,s=t.getElement(i);this._isOnCreationMode()&&(this.isMaximized()||!0!==this.uiConfiguration[this.getCurrentMode()].expandOnClick||(s=t.getElement(i),(n=this.getElement(".content-edition"))&&((n.contains(s)||e.is(o=s.getParent())&&(o.hasClassName("draft-item")||o.hasClassName("autocomplete-item")&&o.getParent(".community-selector-view-container"))||s.getParent(".type-selector"))&&s!==this.getElement(".btn-cancel")&&s!==this.getElement(".fonticon-wrong")&&(!s.getParent(".content-type-selector-container")||s.getParent(".content-type-selector-container")&&n.getParent().hasClassName("expanded"))?n.getParent().hasClassName("expanded")||this.expand():n.hasClassName("non-empty")||this.contract())))},_getNewDummyTaggableModel(){const e=this._context.isCommunityContext()?this.getSelectedCommunityID():void 0;return new K({subject6wuri:i.getUUID(),tags6w:[],tags6w_implicit:[],isDummy:!0,containerId:e},{provokeCacheUpdates:!1})},_displayNewModelTaggerView(){const e=l.getInstance();if(this._isOnCreationMode()){const t=this.getOption("taggingContextManager");if(t&&!this._taggerProxyManager){if(window.ds&&"3DSwym"===window.ds.env&&!e.isBootstrapConditionMet("TopFrameInit"))return e.executeWhenBootstrapConditionIsMet("TopFrameInit",this._displayNewModelTaggerView.bind(this)),null;this._taggableModel||(this._taggableModel=this._getNewDummyTaggableModel()),this._taggerProxyManagerName=i.getUUID(),this._previouslyActiveProxyManagers=t.getActiveProxiesManagers(),this._taggerProxyManager=t.createProxyManager(this._taggerProxyManagerName,{persistTags:!1,client:this._taggableModel}),this.options.taggingContextManager.setProxyManagerAsCurrent(this._taggerProxyManagerName),!1===e.isFeatureActivated("activate_explicit_tags_thru_server")&&this._taggerProxyManager.disableTaggingMode()}}},_switchTaggerBackToPreviousState(){const e=this.getOption("taggingContextManager");this._taggableModel&&e&&this._taggerProxyManager&&(this._taggerProxyManager.isActive()&&this.options.taggingContextManager.setProxyManagersAsCurrent(this._previouslyActiveProxyManagers&&Object.keys(this._previouslyActiveProxyManagers)||[]),this._previouslyActiveProxyManagers=null,this._taggerProxyManagerName&&(this.options.taggingContextManager.destroyProxyManager(this._taggerProxyManagerName),this._taggerProxyManagerName=""),this._taggerProxyManager=null,this._taggableModel=null)},_populateCommunitySelector(){const e=this.getCommunitySelector();e&&this._fetchCommunities&&!this._context.isCommunityContext()&&(this._fetchCommunities=!1,e.populateCommunityCollection({communityId:this.model?this.model.get("community").mid:null}))},expand(){this._publishDisabled||(this.container&&this.container.addClassName("expanded"),this.container.offsetHeight>0&&this._context.isHomePageContext()&&a.dispatchEvent("onContentCreationExpand",{isExpanded:!0}),this.updateTitlePlaceholder()),this.updateAttachmentIconVisibility(),this._populateCommunitySelector()},focusOnTitleInput(){const e=this,t=this.getElement(".content-title-text"),i=this.getElement(".editable-container");return this.getCurrentContentType()===h.MESSAGE&&i?(i.focus(),setTimeout(()=>{i.focus()}),!0):!!t&&(t.focus(),setTimeout(()=>{t.focus()}),e.expand(),!0)},contract(){this.container&&this.container.removeClassName("expanded"),this.container.offsetHeight>0&&this._context.isHomePageContext()&&a.dispatchEvent("onContentCreationExpand",{isExpanded:!1}),this.updateTitlePlaceholder()},removeRepliedContent(){const e=this.getChildView("repliedContentView"),t=this._getBodyView()._getCurrentView().getChildView("rte");t&&t.updatePlaceHolder(I.StartWriting),e&&e.model&&e.cancel()},onContentTypesChange(){this.updateContentType()},onCurrentContentTypeChange(e){let t;const i=this.getElement(".content-title-text"),o=this.getCurrentContentType();switch(this.updateTitlePlaceholder(),this.updateContentType(),this.removeRepliedContent(),o){case h.SURVEY:case h.WIKI:break;case h.MESSAGE:this.refresh();case h.COMMENT:case h.MEDIA:case h.WEDO:(t=this.getChildView("auto-save"))&&t.clear()}if(n.Features.touchEvents||!0===e.leftColumnTrigger){const t=this._context.getRoute();e&&e.forceFocus&&o!==h.MEDIA&&o!==h.MESSAGE&&o!==h.COMMENT&&!t.contains("/social-event:")&&this.switchToMaximizedView()}e&&!0===e.forceFocus&&(i?this.focusOnTitleInput():this.addEventOnce("onRender",this.focusOnTitleInput))},updateContentType(){let e;const t=this.getCurrentContentType(),i=this.getCurrentMode(),n=this.autoSave&&this.autoSave.getAutoSaveModel();switch(this._context.isCommunityContext()?this.enablePublishRequest():(e=this.getCommunitySelector())&&e.setModelParam(t,{communityId:n?n.get("community").mid:null}),this.changeContentTypeClass(t),this.configureUI(this.uiConfiguration[i]),t){case h.MEDIA:this._setMinimizedContentCreation(),this._setPublishButton();break;case h.SURVEY:this._setNextButton();break;case h.MESSAGE:case h.COMMENT:this.isMaximized()?(this.resetBodyContent(),this.switchToMinimizedView()):this.removeTagsFromContent();break;default:this._setSimpleRTEMode(),this._setPublishButton()}t===h.MESSAGE||t===h.COMMENT?this._publishDisabled=!0:this._publishDisabled=!1,this._getBodyView().switchTo(i),this.removeInvalidationForPublish()},_setMinimizedContentCreation(){this.contract(),this._getBodyView().switchTo(this.getCurrentMode(!1)),this._isOnCreationMode()&&this._switchTaggerBackToPreviousState(),this.hideTagger()},_setSimpleRTEMode(){},_maximizeIconManager(e){const t=this.getElement(".content-title-section .maximize");t&&(e?t.setStyle("display",""):t.setStyle("display","none"))},_attachmentIconManager(e){const t=this.getElement(".publish-section .attachment");t&&(e?t.setStyle("display",""):t.setStyle("display","none"))},configureUI(e){let t,i;e&&(void 0===e.maximizeAvailableInMinimizedMode||this.isMaximized()?this._maximizeIconManager(!1):!0===e.maximizeAvailableInMinimizedMode?this._maximizeIconManager(!0):this._maximizeIconManager(!1),this.updateAttachmentIconVisibility(),void 0!==e.saveAsDraft&&(t=this.getElement(".publish-section .dropdown-toggle"),i=this.getControl("publishButton"),t&&(!0===e.saveAsDraft&&"wiki"!==this.getCurrentContentType()?(t.setStyle("display",""),i.getContent().removeClassName("btn-group-alone")):(t.setStyle("display","none"),i.getContent().addClassName("btn-group-alone")))))},updateAttachmentIconVisibility(){const t=this.getCurrentMode(),i=e.extend({},this.uiConfiguration[t]),o=(document.documentElement.clientWidth||window.innerWidth)<B.DeviceWidth1,s=n.Features.touchEvents||o;s&&("simpleRTE"===t?(i.maximizedOnly=!0,i.mediaLibAvailableInMinimizedMode=!0):"advancedRTE"===t&&(i.mediaLibAvailableInMinimizedMode=!0)),void 0===i.mediaLibAvailableInMinimizedMode||this.isMaximized()?s&&i.mediaLibAvailableInMinimizedMode?this._attachmentIconManager(!0):this._attachmentIconManager(!1):!0===i.mediaLibAvailableInMinimizedMode?this._attachmentIconManager(!0):this._attachmentIconManager(!1)},_currentContentTypeMapping(e){const t=e.charAt(0).toUpperCase()+e.slice(1);return"Iquestion"===t?"Question":"Idea"===t?"Ideation":t},getCommunitySelector(){let e=this.getChildView("communitySelector");return e||this.isDestroyed()||((e=this.addChildView("communitySelector",{Class:d,modelParam:this.getCurrentContentType(),events:{disablePublishRequest:this.disablePublishRequest.bind(this),enablePublishRequest:this.enablePublishRequest.bind(this)}})).addEvent("onCommunitySelectChange",e=>{this.setCommunityId(e),this.onContentChange()}),e.addEvent("communitySelectorExpanded",e=>{const t=this.getElement(".publish-section");e?t&&t.addClassName("community-selector-expanded"):t&&t.removeClassName("community-selector-expanded")})),e},getSelectedCommunityID(){return this.model&&this.model.get("mid")&&(this._communityId=this.model.getCommunity().get("mid")),this._communityId||(this.getCommunitySelector()?this.getCommunitySelector().getSelectedCommunity():"")},_launchAutoSave:function(){if(!this.isContentEmpty()){const e=this.getChildView("auto-save");e&&!0===j.getAutoSaveRecoveryHandledStatus()&&!this.isAutoSaveBlocked()&&(L.trackPageEvent({category:"AutoSave",label:"contentSaved",view:"content-editor-view"}),e.onContentChanged(this))}},_clearAutoSave(e){this._cancelAutoSaveThrottled();const t=this.getChildView("auto-save");t&&t.clear(e)},_blockAutoSave(){this._autosaveBlocked=!0},isAutoSaveBlocked(){return this._autosaveBlocked},emptyTitle(){const e=this.getElement(".content-title-text");e&&(e&&e.set("value",""),this._titleContent="")},_confirmCancel(e,t){if(!1!==e){if((!this.isContentEmpty()&&!this.model||this.model&&this.model.hasVirtuallyChanged()||this._context.previousAttributes.transferredToIdea||H.isFeatureActivated("activateODEEditor")&&this.model&&"Media"===this.model.get("model")&&this.model.isDocumentOfficeExtension())&&!t){return this.addControl("removeConfirmationModal",new M({closable:!1})).confirm({title:b.Cancel,message:b.AreYouSure,callback:function(e){!0===e&&(this.onCancel(!0,!0),L.trackPageEvent({category:"ContentCreation",label:"cancelCreation",view:"content-editor-view",event:"click"}))}.bind(this)}),!1}this._navigateToPreviousContext()}return!0},onCancel(e,t,i){const n="message"===this.getCurrentContentType(),o="ritual"===this.getCurrentContentType(),s=i&&("publishOnCompleteCallback"===i.comingFrom||"saveDraftOnCompleteCallback"===i.comingFrom);if(this.enablePublishButton(),this._confirmCancel(e,t)){if(!this.isDestroyed()){this._isOnCreationMode()?(this.model&&(this.model=null,this.removeChildView("body")),this.emptyTitle(),n||this.resetBodyContent(),this.clearUndoTextInEditor(),this.isMaximized()&&this.switchToMinimizedView(),this._context.setTemporaryState(!1),this.resetCommunitySelector(),this.removeInvalidationForPublish(),this._clearAutoSave({localAutoSaveClearOnly:s}),this.onContentChange(),this._applyTemplate()):(this.model.removeChanges(),this._clearAutoSave({localAutoSaveClearOnly:s}),n||this.resetBodyContent(),this.refresh());const t=this.getChildView("communityTagsView");t&&t.resetTags(),this.resetEditorViews(),this.contract(),o&&e&&this._context.reset({path:"rituals"})}this._typesManager.setContentTypeRequest({type:"message",updateIcon:!0,forceFocus:!1,resetUserAction:!0})}},_setPublishButtonState(e){const t=this.getControl("publishButton"),i=this.getControl("draftMenuButton");this._publishDisabled=e,t&&t.setDisabled(this._publishDisabled),i&&i.setDisabled(this._publishDisabled)},enablePublishButton(){this._setPublishButtonState(!1)},disablePublishButton(){this._setPublishButtonState(!0)},onPublishButtonClick(e,t){this.disablePublishButton(),!0===this.canPublishOrSaveAsDraft(t)?(this.removeInvalidationForPublish(),this.onPublish(e,t)):(this.enablePublishButton(),this.markViewAsInvalidForPublish())},onPublish(t,i){if(!1!==this._uploadingState)return!1===this._saveFailedDueToUploading&&(this._saveFailedDueToUploading=!0,this.switchToUploadingState(),this.addEventOnce("onMediaUploadsComplete",this.onPublish.bind(this,t,i))),this;if("mediaCreator"===this.getCurrentMode())this.onNewMediaPublish(t,i);else{let n,o,s,a,r;const c=i||{},d=this;if(n=this.getElement(".content-title-text")){o=n.value||n.getHTML(),s=this.getSelectedCommunityID(),a=this.getCurrentContentType();const m=this.getBodyAttributes();if(r=e.merge(e.merge(c,{title:o,community_id:s,published:1,isDMContext:d._context.isDirectMessageContext(),contentType:a}),m),!this._context.editionMode&&["socialEventCreator","advancedSocialEventCreator"].includes(this.getCurrentMode()))if(i&&i.socialeventCreationConfirmation)i={};else if(!m.provider)return void new M({closable:!1}).confirm({className:"sywm-confirmation-modal",title:"Confirmation",message:b.socialeventCreationConfirmation,callback:function(e){!0===e?this.onPublish(t,{socialeventCreationConfirmation:!0}):this.enablePublishButton()}.bind(this)});if(d.model||(r.author=l.getInstance().get("user")),"instantMessageRTE"===this.getCurrentMode()){const e=this.getChildView("repliedContentView");if(e&&e.model){const t=e.model;if("community-event"===t.getModelName()){if("question"===t.get("message_details->subject_model").toLowerCase()){const e=t.get("message_details->parent_uri");let i="";if(e){const t=e.split(":"),n=t.length;i=n>=2?t[n-2]:""}r.parentCommentUri="comment"===i.toLowerCase()?e:t.get("message_details->model_uri")}else r.parentCommentUri=t.get("message_details->parent_uri")||t.get("message_details->model_uri");r.subject6wuri=t.get("subject_uri"),r.parentMessageUUID=t.get("mid"),r.subject_model=t.get("message_details->subject_model"),r.subject_title=t.get("message_details->subject_title"),r.subject_id=t.get("message_details->subject_id")}else r.parentMessageUri=t.getInstantMessage().get("subject6wuri"),r.parentMessageUUID=t.get("mid")}}E.log(o,s,a),this.isContentEmpty()&&1===r.published||!s||!a?(E.error("All conditions not met for a publish"),this.enablePublishButton()):this.getMediaCollectionLength()>0?(d.switchToUploadingState(),this.uploadMedia({communityId:s,onUploadsComplete(){r=e.merge(d.getBodyAttributes(),r),d.leaveUploadingState(),d.saveContent(r)},onUploadsFailure(e){d.leaveUploadingState(),v.printErrorMessage(e,"media"),d.enablePublishButton()}})):this.saveContent(r)}}this.removeRepliedContent()},saveContent(t){const i=this,n=h.getInstance();let o,a,r=!1;const l=1!==t.published;let c,d;const m=i._context.isDirectMessageContext();var u={onComplete(e){E.log("onSuccess",arguments),i.isDestroyed()||(l?(i._context.reset({path:`${m?"dm":"community"}:${t.community_id}/${F.COMMUNITY_MY_CONTRIBUTIONS}`}),i.onCancel(!1,!0,{comingFrom:"saveDraftOnCompleteCallback"}),setTimeout(i.switchToMinimizedView.bind(i))):i.isMaximized()?(e&&("survey"!==e.getModelName()||e.isOpen()||i.alert("info",b.CreatedSurveyNotOpenAlert),"ritual"===t.contentType?s.goToRitual(e.get("mid")):(a=i.getSelectedCommunityID(),i._context.reset({contentType:e.getModelName(),communityId:a,dmId:m?a:void 0,contentId:e.get("mid"),editionMode:!1}))),i.onCancel(!1,!0,{comingFrom:"publishOnCompleteCallback"})):i.onCancel(!0,!0,{comingFrom:"publishOnCompleteCallback"}),i.unmask()),l?(L.trackPageEvent({category:"ContentCreation",label:"saveAsDraft",view:"content-editor-view",event:"click",contentType:e?e.getModelName():"instant-message"}),i.alert("success",b.Thedraftwassavedsuccessfully)):L.trackPageEvent({category:"ContentCreation",label:"publishContent",view:"content-editor-view",event:"click",contentType:e?e.getModelName():"instant-message"}),i.enablePublishButton(),i._context.setTemporaryState(!1)},onFailure(e,t){t&&"ERROR_EXTERNAL_APP_NOT_AUTHORIZED"===t.errorcode?(require(["DS/UIKIT/Alert"],e=>{new e({closable:!0,visible:!0,autoHide:!1,maximumVisibleMessages:1,className:"wp-alert",messages:{className:"error",message:b.ModificationCouldNotBeDoneOnProvider}}).inject(document.body,"top")}),e.fetch({fromCache:!1,onComplete:u.onComplete})):t&&"ERROR_CONCURRENT_AUTHORING"===t.errorcode?(L.trackPageEvent({category:"ContentCreation",label:"publishFailed",view:"content-editor-view",event:"click"}),i.displayOutdatedModal&&(i.displayOutdatedModal(),i._clearAutoSave())):require(["DS/SwymUICore/script/feature/core/error/error"],e=>{L.trackPageEvent({category:"ContentCreation",label:"publishFailed",view:"content-editor-view",event:"click"}),e.displayError(t&&t.errorcode)}),i.enablePublishButton(),i.unmask()}};if(this.transformURLPreviewsBeforeSave(t),this.model&&this.model.get("mid"))l?(u.notify="draft",this.switchToSavingAsDraftState()):(u.notify="publish",this.switchToPublishingState()),this.model.save(t,u);else{l?(u.notify="draft",this.switchToSavingAsDraftState()):(u.notify="publish",this.switchToPublishingState()),this._taggableModel||(r=!0,this._taggableModel=this._getNewDummyTaggableModel()),"survey"===t.contentType?(c="",d="",(this._taggableModel.get("questions")||[]).forEach(e=>{c+=e.description||""}),(t.questions||[]).forEach(e=>{d+=e.description||""})):(c=this._taggableModel.get("content")||"",d=t.content),this._taggableModel.deriveTagActionsFromContentChanges(c,d);const i=this.getChildView("communityTagsView");if(i){i.getSelectedTags().map(k.tagAsObject).forEach(e=>{this._taggableModel.onTagCreation(e,!1)})}e.extend(t,this._taggableModel.getChanges()),r&&(this._taggableModel=null),(o=n.getTypeItemData(t.contentType)).id||(o.id=o.name),w.saveModelWithDefaultParams(t.contentType,t,u,o)}},transformURLPreviewsBeforeSave(e){"survey"===e.contentType&&e.questions.length>0?e.questions.forEach(e=>{e.description=O.convertURLPreviewToLink(e.description,!1)}):e.content=O.convertURLPreviewToLink(e.content,!1)},showTagger(){this.isVisible()&&!1!==l.getInstance().isFeatureActivated("activate_explicit_tags_thru_server")&&(this._taggerShowRequested=!0,this._context.dispatchEvent("onTaggerShowRequest"))},hideTagger(){!0===this._taggerShowRequested&&(this._taggerShowRequested=!1,this._context.dispatchEvent("onTaggerHideRequest"))},onNewMediaPublish(t,i){let n,o,s,a,r={},c=[];const d=i||{},m=this,u=this._getBodyView(),h=u.getMediaCollection();if(h&&(c=h.toArray()),o=(n=this.getElement(".content-title-text")).value,s=this.getSelectedCommunityID(),a=this.getCurrentContentType(),c&&c.length){for(let t=0,i=c.length;t<i;t++){var p;if(r=e.merge(d,e.merge({community_id:s,published:1,contentType:a,author:l.getInstance().get("user")},u.getContentAttributes())),""!==o)p=i>1?`${o}-${t+1}`:o,r.title=p;c[t].setCustomProperty("changesToBeSaved",e.clone(r))}const t=1!==r.published;t?this.switchToSavingAsDraftState():this.switchToPublishingState(),u.uploadMedia({mediaToBeUploaded:c,notify:t?"draft":"publish",onUploadsComplete(){if(1===U.getNbLayoutColumns()&&f.dispatchEvent("onLeftMenuCloseRequest"),m.onCancel(!0,!0),m.unmask(),t){m.alert("success",b.Thedraftwassavedsuccessfully);const e=m._context.isDirectMessageContext();m._context.reset({path:`${e?"dm":"community"}:${r.community_id}/${F.COMMUNITY_MY_CONTRIBUTIONS}`})}else!0===r.is_illustration&&m.alert("success",c.length>1?b.get("Yourmediahavebeensuccessfullypublished"):b.get("Yourmediahasbeensuccessfullypublished"))},onUploadsFailure(e){E.log("onUploadsFailure"),v.printErrorMessage(e,"media"),m.unmask(),m.enablePublishButton()}})}},_onYourCommunitiesClick(){this._context.reset({path:F.MY_COMMUNITIES})},onRender(){return this.maximizeTouchDevices(),"ritual"===this.getOption("lockOn")&&setTimeout(()=>{this.switchToMaximizedView()},50),this._isOnCreationMode()||this.focusOnTitleInput(),this._updateInstantMessageEditorIfLocalStorage(),this._parent.apply(this,arguments)},onShow(){return"ritual"===this.getOption("lockOn")&&setTimeout(()=>{this.switchToMaximizedView()},50),this.maximizeTouchDevices(),this._parent.apply(this,arguments)},onInjected(){this.autoSave.hasBeenRestored||this._onAutoSave()},onHide(){return this.isMaximized()&&(this.model&&this.hideTagger(),this.unMaximizeTouchDevices()),this._parent.apply(this,arguments)},maximizeTouchDevices(){this._widget&&n.Features.touchEvents&&this.isMaximized()&&this._widget.dispatchEvent("onMaximizeTouchDevices")},unMaximizeTouchDevices(){n.Features.touchEvents&&this._widget.dispatchEvent("unMaximizeTouchDevices")},shouldSaveMessageonEnter(){const e=H.isFeatureActivated("activateIMSendButton"),t=n.Features.touchEvents;return!e||!t},onSendButtonClick(){this.onMessageCommentPublishRequest({source:"sendButton"})},onMessageCommentPublishRequest(e){if(("message"===this.getCurrentContentType()||"comment"===this.getCurrentContentType())&&!this.isMasked()){if(e&&"enterKey"===e.source&&!this.shouldSaveMessageonEnter())return;R.removeItem(this._getLocalStorageKeyForMessage()),this.mask(),this.onPublish(),this.resetBodyContent(),this.unmask(),e&&e.source&&this.shouldSaveMessageonEnter()&&H.isFeatureActivated("activateIMSendButton")&&("sendButton"===e.source?L.trackPageEvent({category:"ContentCreation",label:"messageSavedWithSendButton",view:"content-editor-view",event:"click",contentType:this.getCurrentContentType()}):"enterKey"===e.source&&L.trackPageEvent({category:"ContentCreation",label:"messageSavedWithEnterKey",view:"content-editor-view",event:"input",contentType:this.getCurrentContentType()}))}},destroy(){this.onDocumentBodyClickBound&&document.body.removeEvent("click",this.onDocumentBodyClickBound),this.onCancelBoundIfVisible&&this._context.removeListener("onBack",this.onCancelBoundIfVisible),this.autoSave&&this.autoSave.removeEvent("onContentRecoveryRequest",this._onAutoSave),!0!==this.getOption("createMessagesOnly")&&(this.onContentTypesChangeBound&&this._typesManager.removeEvent("onContentTypesChange",this.onContentTypesChangeBound),this.onCurrentContentTypeChangeBoundIfVisible&&this._typesManager.removeEvent("onCurrentContentTypeChange",this.onCurrentContentTypeChangeBoundIfVisible)),this.onCommunityChangeBound&&this._context.removeListener("onCommunityChange",this.onCommunityChangeBound),this._onContextChangeAttemptBound&&this._context.removeListener("onContextChangeAttempt",this._onContextChangeAttemptBound),this._previouslyActiveProxyManagers=null,this._taggerProxyManager=null,this._taggableModel=null,this.model&&this.model.removeChanges(),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/question/edit/question-edit-view",["UWA/Core","DS/SwymUICore/script/feature/community/iquestion/model/iquestion-model","DS/SwymUIComponents/script/feature/community/content/edit/content-editor-view"],function(e,t,i){"use strict";return i.extend({_modelClass:t,name:"question-edit-view"})}),define("DS/SwymUIComponents/script/feature/community/social-event/edit/social-event-edit-view",["DS/SwymUICore/script/feature/community/social-event/model/social-event-model","DS/SwymUIComponents/script/feature/community/content/edit/content-editor-view"],function(e,t){"use strict";return t.extend({_modelClass:e,name:"social-event-edit-view"})}),define("DS/SwymUIComponents/script/feature/community/survey/edit/survey-edit-view",["UWA/Core","DS/SwymUICore/script/feature/community/survey/model/survey-model","DS/SwymUIComponents/script/feature/community/content/edit/content-editor-view"],function(e,t,i){"use strict";return i.extend({_modelClass:t,name:"survey-edit-view"})}),define("DS/SwymUIComponents/script/feature/community/idea/edit/idea-edit-view",["UWA/Core","DS/SwymUICore/script/feature/community/idea/model/idea-model","DS/SwymUIComponents/script/feature/community/content/edit/content-editor-view"],function(e,t,i){"use strict";return i.extend({_modelClass:t,name:"idea-edit-view"})}),define("DS/SwymUIComponents/script/feature/community/post/edit/post-edit-view",["UWA/Core","DS/SwymUICore/script/feature/community/post/model/post-model","DS/SwymUIComponents/script/feature/community/content/edit/content-editor-view"],function(e,t,i){"use strict";return i.extend({_modelClass:t,name:"post-edit-view"})}),define("DS/SwymUIComponents/script/feature/community/wiki/edit/wiki-edit-view",["UWA/Core","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/community/wiki/model/wiki-model","DS/SwymUICore/script/feature/community/wiki/model/wikitree-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/utils/date","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/utils/usage-tracker","DS/SwymUICore/script/feature/core/realtime/realtime-wiki-concurrent-edition-manager","DS/SwymUIComponents/script/feature/community/content/edit/content-editor-view","DS/SwymUIComponents/script/feature/community/wiki/view/wikitree-view","DS/SwymUIComponents/script/feature/community/wiki/view/wikitree-buttons-view","DS/SwymUIComponents/script/feature/community/wiki/view/wiki-access-editor-view","DS/SwymUIComponents/script/feature/core/ui-components/layout/layout-manager","DS/SwymUICore/script/feature/core/context/context-model","DS/UIKIT/SuperModal","DS/UIKIT/Input/Text","DS/UIKIT/Input/Toggle","DS/UIKIT/Tooltip","DS/UIKIT/Input/Button","DS/SwymUICore/script/constants/community-constants","i18n!DS/SwymUIComponents/assets/nls/feature/community/wiki/edit/wiki-creator-view"],(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w,C,f,y,v,A)=>{return c.extend({_modelClass:i,name:"wiki-edit-view",_wikiData:{},_gettingEditInfo:!1,domEvents:{resize:"onResize"},onResize(){const e=this.container&&this.container.getClosest(".scroller-content");let t=0;e&&(t=parseInt(e.getDimensions().height,10))>100&&this.setEditorHeight(t-50);const i=this.getChildView("wikiTreeViewEdit"),n=this.container&&this.container.getElement(".wikitree-view-wrapper"),o=this.container&&this.container.getElement(".wikitree-view-wrapper-container"),s=n&&"visible"===n.getStyle("visibility")&&o&&o.getSize().height<=50;i&&a.getNbLayoutColumns()>1&&s&&i.refresh()},setEditorHeight(e){const t=this.container&&this.container.getElement(".wiki-content-editor-view-wrapper");t&&t.setStyle("height",`${e}px`);const i=this.container&&this.container.getElement(".wikitree-view-wrapper");i&&i.setStyle("max-height",`${e}px`),i&&i.setStyle("overflow-y","hidden")},onContentTitleChange(e,t){this._parent.apply(this,arguments);const i=this.getChildView("wikiTreeViewEdit");i&&i.dispatchEvent("onContentTitleChange",[e,t])},_createContent(){const t=this,i=t._parent.apply(t,arguments),{model:s}=t,a=s?s.getCommunity().get("mid"):t.getSelectedCommunityID();let r,l,c;return a&&(r=new n({community_id:a},{autoPopulate:!0})),l=t.addChildView("wikiTreeViewEdit",{addScroller:!0,model:r||null,Class:d,widget:t._widget,moveOnlyCurrentNode:!0,creation:Boolean(t.getOption("creation")),editable:!t.getOption("creation")},{callback(i){t.getOption("creation")&&t.reactTo(i,"currentPageChange",i=>{if(i.id){const n=t.getChildView("wikiAccessEditorView");if(t._addWikiChanges("parent_id",i.id),e.is(i.isPrivate)&&n){const e=n.getControl("accessSelect");if(e)if(!0===i.isPrivate)e.select(1),e.disable(),t._addWikiChanges("visibility","0");else{e.enable(),e.select(0);const t=n.getControl("user-search-control");t&&(t.disable(),t.unselectAll())}}}})}}),c=t.addChildView("wikiTreeButtonsView",new m({mode:"edit",model:a?new o({mid:a},{autoPopulate:!0}):null,moveOnlyCurrentNode:!0,creation:t.getOption("creation"),editable:!0})),s&&r&&window.ds&&"3DSwym"===window.ds.env&&r.setCurrentPage(s),[{class:"col-md-3 wiki-tree-view-edit-wrapper",html:{class:"wikitree-view-wrapper-container maximize",html:[this.getChildView("back-arrow-view"),[{class:"wikitree-view-wrapper",styles:{"margin-right":"auto"},html:[{class:"heading",html:[{class:"wikitree-header",html:[{tag:"span",class:"fonticon fonticon-tree-view-flattened"},{tag:"span",html:A.Wikitree}]},c]},{html:l}]}]]}},{class:"col-md-9 wiki-content-editor-view-wrapper",html:i}]},_createBodyView(){const e=this,{model:t}=e,i=e._parent.apply(e,arguments);let n;return n=e.addChildView("wikiAccessEditorView",{Class:u,model:t,events:{onInit(){e.listenTo(this,{onContentChange:e.onContentChange})}}}),e.reactTo(n,"displayAccessIcon",t=>{t?(e.getControl("accessIcon").show(),n.container.removeClassName("hidden")):(e.getControl("accessIcon").hide(),n.container.addClassName("hidden"))}),[{class:"wiki-properties-wrapper hidden",html:n},i]},_createPublishBarLeftElements(){const i=this,n=i._parent.apply(i,arguments);let o=i.getControl("majorEditionCheckbox"),s=i.getControl("revisionInput");const a=e.createElement("span",{class:"fonticon fonticon-help"});let r=i.getControl("proxyPublishBtn");return a&&i.addControl("helpIconTooltip",new f({target:a,body:A.RevisionTooltip})),r||(r=new y({disabled:this._publishDisabled,className:"primary proxy-publish-button",icon:"check"})).addEvent("onClick",()=>{const e=i.getControl("publishButton");e&&e.getContent().click()}),s||(s=i.addControl("revisionInput",new w({className:"revision-message-input",placeholder:A.Revisiondescription,value:"",events:{onPostInject(){i.validateFieldView(),this.getContent().addEvent("keyup",()=>{i.validateFieldView()})},onChange(){i.onContentChange()}}}))),s.hide(),o||(o=i.addControl("majorEditionCheckbox",new C({className:"primary major-edition-checkbox",type:"checkbox",checked:!1,value:A.CreateRevision,events:{onChange(){const e=i.getElement(".publish-section");!0===i.getControl("majorEditionCheckbox").isChecked()?(s.show(),e.addClassName("revision-input-expanded"),i.validateFieldView()):!1===i.getControl("majorEditionCheckbox").isChecked()&&(s.setValue(""),s.hide(),e.removeClassName("revision-input-expanded"),i.validateFieldView()),i.onContentChange()}}}))),t.getInstance().isFeatureActivated("activate_wiki_revision")&&n.html.push([o,a,r,s]),n},_createActions(){const t=this,i=t._parent.apply(t,arguments),n=this.addControl("accessIcon",e.createElement("span",{class:"fonticon fonticon-lock",events:{click(){const e=t.getElement(".wiki-properties-wrapper");e.hasClassName("hidden")?(e.removeClassName("hidden"),this.addClassName("checked")):(e.addClassName("hidden"),this.removeClassName("checked"))}}}));return t.addControl("accessIconTooltip",new f({target:n,body:A.Accessandediting})),t.updateAccessIcon(),i.html.splice(1,0,{tag:"span",html:n}),i},updateAccessIcon(){const e=this.getControl("accessIcon");let t=this.model?this.model.getCommunity():null;t||(t=new o({mid:this.getSelectedCommunityID()})),t.getUserRole()>=3?e.show():e.hide()},_addWikiChanges(e,t){const i=this,{model:n}=i;n?n.addChanges(e,t):i._wikiData[e]=t},getWikiData(){const{model:e}=this;return e?e.getChanges():this._wikiData},validateFieldView(){const e=this.getControl("revisionInput").getValue();return this._addWikiChanges("revision_description",e),!0},setCommunityId(e){const t=this;let i,o;!e||t._context.isCommunityContext()&&t._context.isCommunityContext()!==e?e||(o=t.getChildView("wikiTreeViewEdit"))&&(i=o.model,o.model=null,i&&i.get("tree")&&i.getCustomProperty("currentPage")&&i.setCurrentPage(i.get("tree")[0].id),o.refresh()):(t._getBodyView().getCommunityId()!==e&&t._getBodyView().setCommunityId(e),(o=t.getChildView("wikiAccessEditorView"))&&o.getCommunityId()!==e&&o.setCommunityId(e),(o=t.getChildView("wikiTreeViewEdit"))&&o.getCommunityId()!==e&&(o.mask(),new n({community_id:e},{autoPopulate:!0,onPopulate(e){o.setModel(e),e.get("tree")&&!e.getCustomProperty("currentPage")&&o.selectItemView(e.get("tree")[0].id),o.unmask()}})),t._context.isCommunityContext()||t.updateAccessIcon())},setup(){const e=p.getInstance(),t=this._parent.apply(this,arguments);this.addChildView("back-arrow-view",{Class:"DS/SwymUIComponents/script/feature/core/ui-components/back-arrow-view",model:this.model});const i=this.getCommunitySelector();return i&&!e.isCommunityContext()&&i.populateCommunityCollection(),this.RTWikiInstance&&this.RTWikiInstance.destroy(),this.RTWikiInstance=new l(this._onContentUpdate.bind(this)),this.isVisible()&&this.model&&this.model.get("outdated")&&this._onContentUpdate(),this._checkLockStatus(),t},displayOutdatedModal(){this._onContentUpdate({message_details:{model_id:this.model.get("mid")}})},_onContentUpdate(e){let t;const i=this;if(t||(t=new g),i.model)if(e){if(e.message_details.model_id===i.model.get("mid")){let e=!1;t.dialog({title:A.WikiVersionOutdatedTitle,body:A.WikiVersionOutdatedInEdit,buttons:[{className:"primary",value:A.Ok,action(t){e=!0,r.trackPageEvent({category:"WikiLockConcurrentEdition",label:"clickOkWikiOutdatedPopupForManualMerge",view:"wiki-edit-view",event:"click"}),t.hide(),i._clearAutoSave(),i._blockAutoSave()}}]}),t.onHide=(()=>{e||(i._clearAutoSave(),r.trackPageEvent({category:"WikiLockConcurrentEdition",label:"clickCancelWikiOutdatedPopupForManualMerge",view:"wiki-edit-view",event:"click"}),i._blockAutoSave())}),i._publishDisabled=!0,i.getControl("publishButton").setDisabled(i._publishDisabled)}}else{let e=!1;t.dialog({title:A.WikiVersionOutdatedTitle,body:A.WikiVersionOutdated,buttons:[{className:"primary",value:A.Ok,action(t){e=!0,r.trackPageEvent({category:"WikiLockConcurrentEdition",label:"clickOkWikiOutdatedPopupWithAutomaticRefresh",view:"wiki-edit-view",event:"click"}),window.location.reload(),t.hide()}}]}),t.onHide=(()=>{e||r.trackPageEvent({category:"WikiLockConcurrentEdition",label:"clickCloseWikiOutdatedPopupWithAutomaticRefresh",view:"wiki-edit-view",event:"click"})})}},getBodyAttributes(){return e.merge(this._parent.apply(this,arguments),this.getContentAttributes())},getContentAttributes(){const t=this._parent.apply(this,arguments)||{};return e.extend(t,this.getWikiData()),e.extend(t,this.getChildView("wikiAccessEditorView").getWikiData()),t.minor_edition=!1===this.getControl("majorEditionCheckbox").isChecked()?"1":"0",t},resetContent(){return this.model&&this.model.removeChanges(),this._parent.apply(this,arguments)},resetEditorViews(){const e=this;let t;e.model||(e._wikiData={});const i=e.getControl("revisionInput");i&&(i.setValue(""),i.hide());const n=e.getControl("majorEditionCheckbox");n&&n.uncheck(),e.getElement(".wiki-properties-wrapper").addClassName("hidden"),(t=e.getElement(".fonticon-lock"))&&t.removeClassName("checked"),e.getChildView("wikiAccessEditorView").resetEditorViews()},onCancel(e,t,i){if(this._confirmCancel(e,t)){const e=i&&("publishOnCompleteCallback"===i.comingFrom||"saveDraftOnCompleteCallback"===i.comingFrom);if(!this.isDestroyed()){const t=this.model&&this.model.getSubjectURI();require(["DS/SwymUICore/script/feature/core/edit-info/edit-info-manager"],e=>{if(t)return e.unlockContentForEdit(t).catch(e=>{console.error(e)})}),this._isOnCreationMode()?(this.model&&(this.model=null),this.emptyTitle(),this.resetBodyContent(),this.dispatchEvent("onWikiCancel"),this._context.setTemporaryState(!1),this.onContentChange(),this._clearAutoSave({localAutoSaveClearOnly:e})):(this.model.removeChanges(),this.resetBodyContent(),this._clearAutoSave({localAutoSaveClearOnly:e}),this.resetBodyContent(),this._clearAutoSave()),this.resetEditorViews(),this.contract()}}},changeContentTypeClass(){},onPublish(){this._parent.apply(this,arguments)},onShow(){if(this._parent.apply(this,arguments),this.model&&this.model.get("outdated")&&this._onContentUpdate(),this.getOption("creation")){const e=this.getChildView("wikiTreeViewEdit"),t=e.currentNode;e&&t&&setTimeout(()=>{t.options.id===v.TEMP_ID.TEMP_NODE_ID?e.dispatchEvent("currentPageChange",{id:t._parentNode.options.id,isPrivate:Boolean(t.options.icons),dontSetModel:!0}):e.dispatchEvent("currentPageChange",{id:t.options.id,isPrivate:Boolean(t.options.icons),dontSetModel:!0})},0)}},onHide(){this.RTWikiInstance.destroy(),this._parent.apply(this,arguments)},onRedraw(){const e=this.getChildView("body")&&this.getChildView("body").getChildView("advancedRTE");let t;const i=this.model&&this.model.get("_revisionToDisplay"),n=this.getControl("majorEditionCheckbox"),o=this.getElement(".publish-section"),s=this.getControl("revisionInput");if(h.dispatchEvent("showLayout"),this.container.addClassName("wiki"),this.container.getElement(".publish-section")&&this.container.getElement(".publish-section").setHTML(this._createPublishBar().html),i&&i>=0&&this.model?(t=this.model.getRevisionData(i),this.model.addChanges("message",t.message),this.model.addChanges("title",t.title),this.setTitleValue(t.title),e.refreshContent(t.message),n&&n.check().disable(),s&&s&&s.show(),s&&s.setValue(`Restored from revision: ${this.model.get("_revisionToDisplay")}`),o&&o.addClassName("revision-input-expanded")):(this.model&&e&&e.refreshContent(this.model.get("content")),n.enable(),s&&s.hide(),s&&s.setValue(""),o&&o.removeClassName("revision-input-expanded")),this.getChildView("wikiTreeViewEdit").refresh(),this.getOption("creation")){const e=this.getChildView("wikiTreeViewEdit"),t=e.currentNode;e&&t&&setTimeout(()=>{t.options.id===v.TEMP_ID.TEMP_NODE_ID?e.dispatchEvent("currentPageChange",{id:t._parentNode.options.id,isPrivate:Boolean(t.options.icons),dontSetModel:!0}):e.dispatchEvent("currentPageChange",{id:t.options.id,isPrivate:Boolean(t.options.icons),dontSetModel:!0})},0)}else if(this.getChildView("wikiAccessEditorView").refresh(),i){const e=(t=this.model.getRevisionData(i))&&t.title,n=t&&t.id;this.onContentTitleChange(e,n,{userInput:!1})}},updateContentType(){this._parent.apply(this,arguments),this._publishDisabled=!1},_checkLockStatus(){if(!this._gettingEditInfo&&!this.getOption("creation")&&this.model){this._gettingEditInfo=!0;const e=this.model.getSubjectURI();require(["DS/SwymUICore/script/feature/core/edit-info/edit-info-manager"],t=>{if(t.directlyAccessedWikis.has(e))return t.isContentLockedForEdit(e).then(e=>e.length?(this._blockAutoSave(),t.showConcurrentEditionModal(!1,{view:"wiki-edit-view",users:e,onHide:()=>{if(this._gettingEditInfo=!1,!this.isDestroyed()&&this.isVisible()&&this.model){const{communityId:e}=this._context,t=this._context.isDirectMessageContext();this._context.reset({contentType:"wiki",communityId:e,dmId:t?e:void 0,contentId:this.model.get("mid"),editionMode:!1}),this.onCancel(!1,!0)}}}),!0):(this._gettingEditInfo=!1,!1)).then(e=>{if(!e)return;this._publishDisabled=!0;const t=this.getControl("publishButton");t&&t.setDisabled(this._publishDisabled)});this._gettingEditInfo=!1})}}})}),define("DS/SwymUIComponents/script/feature/community/media/edit/media-edit-view",["UWA/Core","UWA/Utils","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUIComponents/script/feature/community/content/edit/content-editor-view","DS/SwymUIComponents/script/utils/content-upload-error","i18n!DS/SwymUIComponents/assets/nls/feature/community/media/edit/media-editor-body-view","DS/SwymUICore/script/lib/event-manager"],function(e,t,i,n,o,s,a,r){"use strict";return o.extend({_modelClass:i,name:"media-edit-view",onPublish:function(i,o){var l=this.getElement(".content-title-text").value!==this.model.get("title"),c=this._getBodyView().getChildView("mediaEditor"),d=this.model.is3DSketchExtension()||this.model.is3DStoExtension()||this.model.hasExtensionType("3dwb"),m=this.model.isDocumentOfficeExtension();if(1!==parseInt(this.model.get("published"),10)||this.model.hasVirtuallyChanged()||c.pictureHasChanged||d||l||m){var u=e.extend({published:1,title:this.getElement(".content-title-text").value},o||{}),h=0===parseInt(u.published,10),p=h?a.Thedraftwassuccessfullysaved:a.Yourchangeshavebeensuccessfullypublished,g=function(){var e=this.model.get("community")&&"dm"===this.model.get("community").community_type;this.unmask(),h?this._context.reset({path:(e?"dm:":"community:")+this.getSelectedCommunityID()+"/"+n.COMMUNITY_MY_CONTRIBUTIONS}):this._context.reset({contentType:this.model.getModelName(),communityId:this.getSelectedCommunityID(),dmId:e?this.getSelectedCommunityID():void 0,contentId:this.model.get("mid"),editionMode:!1}),this.alert("success",p);var t=this.model.getChanges();t&&!1===t.is_illustration&&r.dispatchEvent("requestContentListUpdate",{reloadAfterMediaVisibilityChange:!0})},w=function(e,t){s.printErrorMessage(t),this.unmask()},C=this.model;h||!0!==this.model.hasVirtuallyChanged("thumbnail_time_ms")||(p=a.Yourchangeshavebeensuccessfullypublishedthumbnailnotrefreshed);const i="X-Request-ID";if(!C.get(i)){const e=t.getUUID();C.set(i,e)}this.mask(),d?c.getBlob(function(e){this.model.addChanges("userFile",e),C.save(u,{headers:{[i]:C.get(i)},notify:h?"draft":"publish",onComplete:g.bind(this),onFailure:w.bind(this)})}.bind(this),h):c.pictureHasChanged?(C.addEvent("mediaFileSavedToModel",function(){C.save(u,{headers:{[i]:C.get(i)},notify:h?"draft":"publish",onComplete:g.bind(this),onFailure:w.bind(this)}),C.removeEvent("mediaFileSavedToModel")}.bind(this)),C.dispatchEvent("saveEditedMediaFileToModel")):m?(this.mask(),this._getBodyView().dispatchEvent("onPublishing",[u,{headers:{[i]:C.get(i)},notify:h?"draft":"publish",onComplete:g.bind(this),onFailure:w.bind(this)}])):C.save(u,{headers:{[i]:C.get(i)},notify:h?"draft":"publish",onComplete:g.bind(this),onFailure:w.bind(this)})}else this.alert("error",a.get("Nochangetosave")||"No change to save")}})}),define("DS/SwymUIComponents/script/feature/community/wedo/edit/wedo-edit-view",["UWA/Core","DS/SwymUICore/script/feature/community/wedo/model/wedo-model","DS/SwymUIComponents/script/feature/community/content/edit/content-editor-view"],function(e,t,i){"use strict";return i.extend({_modelClass:t,name:"wedo-edit-view"})}),define("DS/SwymUIComponents/script/feature/core/ui-components/community-contextual-action-menu",["DS/SwymUICore/script/lib/event-manager","DS/UIKIT/DropdownMenu","DS/SwymUIComponents/script/feature/core/modal/super-modal","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","DS/SwymUICore/script/feature/community/community/collection/community-collection","DS/SwymUICore/script/feature/community/community/model/community-request-model","DS/SwymUIComponents/script/feature/community/community/view/community-new-request-view","DS/SwymUIComponents/script/feature/community/community/view/community-creation-view","DS/SwymUIComponents/script/feature/direct-message/room/add-room-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-tile-view","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/utils/usage-tracker","i18n!DS/SwymUIComponents/assets/nls/feature/core/share/view/share-content-view","DS/SwymUIComponents/script/feature/core/ui-components/layout/layout-manager","i18n!DS/SwymUIComponents/assets/nls/feature/core/ui-components/community-contextual-action-menu","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-detailed-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-card-view","UWA/Promise","DS/SwymUICore/script/constants/community-constants","DS/SwymUICore/script/feature/core/context/context-constants","DS/UWPClientControls/PlatformNotify","DS/SwymUICore/script/feature/community/derived-type/derived-type-styles-manager","DS/SwymUICore/script/feature/community/derived-type/derived-type-data-utils","i18n!DS/SwymUIComponents/assets/nls/feature/direct-message/direct-messages","DS/SwymUIComponents/script/feature/core/modal/rss-feed-modal","DS/SwymUIComponents/script/utils/feature-activation-manager"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w,C,f,y,v,A,_,S,b,I,D,T,E){"use strict";const U=window.ds&&"3DD"===window.ds.env,k=window.widget&&widget.getAppName()===h.getMyCommunitiesAppKey();function x(e,t){const i=e.get("derivedTypes"),n=[];return i.forEach(e=>{const i=b.getClassNameFromTypeName(e),o=function(e){return I.isDerivedTypeName(e)?I.getCommunityPageNameFromDerivedTypeName(e):_.CONTENTTYPE_TO_COMMUNITYPAGE(e)}(i),s=function(e){if(I.isDerivedTypeName(e))return I.getCommunityPipelinePageNameFromDerivedTypeName(e)}(i),a=I.isPostDerivedType(e);I.isIdeaDerivedType(e)?n.push({text:e.label,fonticon:e.icon.replace("fonticon-",""),name:i,className:"dt-"+i+"-menu",selectable:!0,items:[{attributes:{"data-parent-menu":"dt-"+i},text:e.label,fonticon:e.icon.replace("fonticon-",""),className:"dt-"+i+"-page",name:"dt-"+i+"-page",selectable:!0,handler:t._communityPageHandler.bind(t,o)},{attributes:{"data-parent-menu":"dt-"+i},text:e.label+" "+u.Pipeline,fonticon:"stage-full",className:"dt-"+i+"-pipeline",name:"dt-"+i+"-pipeline",selectable:!0,handler:t._communityPageHandler.bind(t,s)}]}):a&&n.push({text:e.label,fonticon:e.icon.replace("fonticon-",""),name:i,className:"dt-"+i+"-menu",selectable:!0,handler:t._communityPageHandler.bind(t,o)})}),n}return t.extend({position:"left",defaultOptions:{multiSelect:!0,maxItemsBeforeScroll:20,responsiveMode:!0,scrollMode:!0},_context:null,_widget:null,_pipelineModal:null,_destroyed:!1,_contentCreated:!1,init:function(e){if(e.items=[{name:"loading",text:C.Loading}],e.className="community-contextual-action-menu responsive-menu",this.model=e.model,!e.target)throw new Error("The target must be specified!");this._widget=e.widget,this._parent.call(this,e),this._context=n.getInstance(),this._onFeedModeChange=this._onFeedModeChange.bind(this),this._onContextChange=this._onContextChange.bind(this),this._updateCenterColumnContentMode(this._context.feedMode),this._context.addListener("onFeedModeChange",this._onFeedModeChange),this._context.addListener("onContextChange",this._onContextChange),this._onSortModeChange=this._onSortModeChange.bind(this),this._updateCenterColumnSortMode(this._context.sortMode),this._context.addListener("onSortModeChange",this._onSortModeChange)},_onContextChange:function(){var e,t,i,n=this.model,o=this.getSelectedItems();if(n.isBusinessExperienceCommunity()&&((e=this._context.getCommunityDerivedTypePageContext())&&I.isDerivedTypeCommunityPageName(e)?(i=!0,t=I.getDerivedTypeNameFromCommunityPageName(e)):i=!1),i||(t=e=this._context.getCommunityPageContext()),o.length)for(let e of o)e.elements.container.removeClassName("selected"),e.selected=!1;if(e)switch(this.items&&this.getItem(t)&&this.toggleSelection(this.getItem(t)),t){case"media":this.toggleSelection(this.getItem("media-menu"));break;case"ideas":this.toggleSelection(this.getItem("idea-menu"));break;case"wiki":this.toggleSelection(this.getItem("wiki-menu"))}this._updateCenterColumnContentMode(this._context.feedMode),this._updateCenterColumnSortMode(this._context.sortMode)},getItem(){return null!=this.items&&this._parent.apply(this,arguments)},_unselectItem:function(){var e=this.getSelectedItems().pop();e&&(e.elements.container.removeClassName("selected"),e.selected=!1)},_updateCenterColumnContentMode:function(e){var t=e,i="",n=!this._destroyed&&this.getContent();if(n){switch(t){case A.CTY_CONTENT_LIST_MODE.TIMELINE_MODE:i="timeline",this.toggleSelection(this.getItem("timeline-content"));break;case A.CTY_CONTENT_LIST_MODE.WHATSNEW_MODE:i="whatsnew",this.toggleSelection(this.getItem("whatsnew-content"));break;case A.CTY_CONTENT_LIST_MODE.COMPACTVIEW_MODE:i="compactview",this.toggleSelection(this.getItem("compactview-content"))}n.dataset.centerColumnContentMode=i,this.updateItem({fonticon:this._getViewIcon(),id:"view-mode"})}},_onFeedModeChange:function(e){this._updateCenterColumnContentMode(e.feedMode)},_updateCenterColumnSortMode:function(e){let t=e,i="",n=!this._destroyed&&this.getContent();if(n){switch(t){case A.CTY_CONTENT_LIST_SORT_MODE.CREATION_DATE:i="sortByCreation",this.toggleSelection(this.getItem("sortByCreation"));break;case A.CTY_CONTENT_LIST_SORT_MODE.LATEST_CONTRIBUTIONS_DATE:i="sortByLatest",this.toggleSelection(this.getItem("sortByLatest"))}n.dataset.centerColumnSortMode=i,this.updateItem({fonticon:this._getSortIcon(),id:"sort-mode"})}},_onSortModeChange:function(e){this._updateCenterColumnSortMode(e.sortMode)},_communityPageHandler:function(e){this._context.getCommunityPageContext()===e?this._navigateTo(""):this._navigateTo(e)},_addItems(){const e=this,t=this.model.getCommunityFeaturesAccess(),i=!0===e.model.isDirectMessage(),n={share:[],content:[],members:[],view:[],sort:[],more:[]};for(;this.items.length>0;)this.removeItem(0);if(i&&E.isFeatureActivated("activateConversationTopic")&&n.more.push({text:C.SetTopic,fonticon:"chat-alt",name:"topic",handler:function(){e._showTopicModal()}}),n.more.push({name:"favorite",text:this.model.get("is_favorite")?f.RemoveFromFavorites:f.AddAsFavorite,fonticon:this.model.get("is_favorite")?"favorite-delete":"favorite-add",handler:this._onFavoriteToggleItemClick.bind(this)}),i&&(t.settings_feature=!0,o.getInstanceFetched(function(t){t.isAllowedToCreateCommunity()&&n.more.push({text:C.TransformToCommunity,fonticon:"users-alt",name:"transformation",handler:function(){e._showTransformationIntoCommunityIfNeeded()}})}.bind(this)),n.more.push({text:C.DuplicateConversation,fonticon:"topbar-chat-add",name:"duplication",handler:function(){e._showDuplicateConversation()}})),void 0!==this.model.getCustomProperty("currentUserSubscribed")&&n.more.push({text:e.model.getCustomProperty("currentUserSubscribed")?C.UnsubscribeToNewContent:C.SubscribeToNewContent,fonticon:"bell-alt",name:"subscribe",handler:this._onSubscribeClick.bind(this)}),i||(n.more.push({text:u.SubscribeToRSSFeed,fonticon:"rss",name:"rss",handler:function(){var t=e.model.get("mid"),i={ideas:"ideation",media:"media",questions:"iquestion",blog:"post",surveys:"survey",wedos:"wedo"},n=this._context.getCommunityPageContext(),o=`${h.getBaseUrl()}/rss/feed/whatsnew/community_id/${t}`;"wiki"===n?o=`${h.getBaseUrl()}/rss/filter/feed/community_id/${t}/model/wiki/`:i[n]&&(o=`${h.getBaseUrl()}/rss/feed/whatsnew/model/${i[n]}/community_id/${t};`),T.createModal(o,!0)}}),n.share.push({text:g.Share,fonticon:"forward",name:"share",handler:function(){require(["DS/SwymUIComponents/script/feature/core/share/view/share-content-view"],function(t){e._shareView=new t({model:e.model,widget:e._widget}),e._shareView.launchModal()})}}),n.more.push({name:"follow-toggle",className:"follow-toggle",text:this.model.isBlacklisted()?f.Follow:f.Unfollow,fonticon:this.model.isBlacklisted()?"eye":"eye-slash",handler:this._onFollowToggleItemClick.bind(this)})),n.more.push({text:u.Mycontributions,fonticon:"feather",name:_.COMMUNITY_MY_CONTRIBUTIONS,handler:function(){e._navigateTo(_.COMMUNITY_MY_CONTRIBUTIONS)}}),U&&k&&n.more.push({text:u.PinToThisTab,fonticon:"pin",name:"pin",handler:function(){var t={appId:h.getMyCommunitiesAppKey(),data:{url:h.getBaseUrl()}};"community"===e.model.getModelName()&&(t.data[e.model.get("users")?"dm":"community"]=e.model.get("mid")),h.pinToDashboard(t)}}),t.stats_feature&&n.more.push({text:u.Statistics,fonticon:"chart-bar",name:_.COMMUNITY_STATS,handler:function(){e._navigateTo(_.COMMUNITY_STATS)}}),n.members.push({text:u.membersPluralUp,fonticon:"users",name:_.COMMUNITY_MEMBERS,handler:function(){e._navigateTo(_.COMMUNITY_MEMBERS)}}),n.content.push({text:u.postsPluralUp,fonticon:"newspaper",name:_.COMMUNITY_BLOG,className:"post",selectable:!0,handler:e._communityPageHandler.bind(e,_.COMMUNITY_BLOG)}),n.content.push({text:u.mediaPluralUp,fonticon:"picture",className:"media-menu",name:"media-menu",selectable:!0,items:[{attributes:{"data-parent-menu":"media-menu"},text:u.mediaPluralUp,fonticon:"picture",className:"media",name:_.COMMUNITY_MEDIA,selectable:!0,handler:e._communityPageHandler.bind(e,_.COMMUNITY_MEDIA)},{attributes:{"data-parent-menu":"media-menu"},text:u.galleryPluralUp,fonticon:"media-gallery",className:"media-gallery",name:"gallery",selectable:!0,handler:e._navigateTo.bind(e,"gallery")}]}),E.isFeatureActivated("activateWedo")&&n.content.push({text:u.wedos,fonticon:"task",className:"wedo",selectable:!0,name:_.COMMUNITY_WEDO,handler:e._communityPageHandler.bind(e,_.COMMUNITY_WEDO)}),t.ideation_feature&&n.content.push({text:u.ideasPluralUp,fonticon:"lamp",className:"idea-menu",name:"idea-menu",selectable:!0,items:[{attributes:{"data-parent-menu":"idea-menu"},text:u.ideasPluralUp,fonticon:"lamp",className:"idea",name:_.COMMUNITY_IDEAS,selectable:!0,handler:e._communityPageHandler.bind(e,_.COMMUNITY_IDEAS)},{attributes:{"data-parent-menu":"idea-menu"},text:u.ideasPipeline,fonticon:"stage-full",className:"idea-pipeline",name:"pipeline",selectable:!0,handler:e._navigateTo.bind(e,"ideaspipeline")}]}),t.qna_feature&&n.content.push({text:u.questionsPluralUp,fonticon:"help",className:"iquestion",name:_.COMMUNITY_QUESTIONS,selectable:!0,handler:e._communityPageHandler.bind(e,_.COMMUNITY_QUESTIONS)}),t.survey_feature&&n.content.push({text:u.surveysPluralUp,fonticon:"clipboard",className:"survey",name:_.COMMUNITY_SURVEYS,selectable:!0,handler:e._communityPageHandler.bind(e,_.COMMUNITY_SURVEYS)}),t.wiki_feature&&n.content.push({text:u.wikiUp,fonticon:"book-open",className:"wiki-menu",name:"wiki-menu",selectable:!0,items:[{attributes:{"data-parent-menu":"wiki-menu"},text:u.wikiUp,fonticon:"book-open",className:"wiki",name:_.COMMUNITY_WIKI,selectable:!0,handler:e._communityPageHandler.bind(e,_.COMMUNITY_WIKI)},{attributes:{"data-parent-menu":"wiki-menu"},text:u.wikiTreeUp,fonticon:"tree-view-flattened",className:"wiki-tree",name:"wiki-tree",selectable:!0,handler:e._openWikiTree.bind(e)}]}),this.model.canViewSocialEvent()&&n.content.push({text:u.rendezVous,fonticon:"calendar",className:"social-event",name:_.COMMUNITY_SOCIAL_EVENTS,selectable:!0,handler:e._communityPageHandler.bind(e,_.COMMUNITY_SOCIAL_EVENTS)}),this.model.isBusinessExperienceCommunity()){if(!this.model.derivedTypesListAvailable())return this.model.addEventOnce("onSync:getDerivedTypes",()=>{n.content.push(...x.bind(this,this.model,this))}),void this.model.action("getDerivedTypes");n.content.push(...x(this.model,this))}if(t.settings_feature&&n.more.push({text:u.Settings,fonticon:"cog",name:_.COMMUNITY_SETTINGS,handler:function(){i?require(["DS/SwymUIComponents/script/feature/core/conversation/view/persistency-modal"],function(t){new t({model:e.model}).inject(document.body).show()}):e._navigateTo(_.COMMUNITY_SETTINGS)}}),i?n.more.push({className:"divider"},{name:"close",text:f.CloseConversation,fonticon:"times",handler:this._onCloseConversationItemClick.bind(this)}):!0===e.model.getDeleteRight()&&n.more.push({className:"divider"},{name:"leave",className:"leave",text:f.LeaveCommunity,fonticon:"logout",handler:this._onLeaveCommunityClick.bind(this,[e.model])}),window.ds&&!0===window.ds.swymIM){const e=!this._destroyed&&this.getContent(),t=e&&e.dataset||{};n.view.push({text:C.get("Contents"),fonticon:"view-big-tile",name:"whatsnew-content",selectable:!0,selected:"whatsnew"===t.centerColumnContentMode,handler:function(){p.trackPageEvent({category:"SwitchWhatsNewTimeline",label:"switchToWhatsNew",view:"community-contextual-action-menu",event:"click"}),this._context.reset({feedMode:A.CTY_CONTENT_LIST_MODE.WHATSNEW_MODE,path:this._context.path})}}),n.view.push({text:C.get("CompactView"),fonticon:"list",name:"compactview-content",selectable:!0,selected:"compactview"===t.centerColumnContentMode,handler:function(){p.trackPageEvent({category:"SwitchWhatsNewTimeline",label:"switchToCompactView",view:"community-contextual-action-menu",event:"click"}),this._context.reset({feedMode:A.CTY_CONTENT_LIST_MODE.COMPACTVIEW_MODE,path:this._context.path})}}),n.view.push({text:C.get("Timeline"),fonticon:"graph-egraph-list",name:"timeline-content",selectable:!0,selected:"timeline"===t.centerColumnContentMode,handler:function(){p.trackPageEvent({category:"SwitchWhatsNewTimeline",label:"switchToTimeline",view:"community-contextual-action-menu",event:"click"}),this._context.reset({feedMode:A.CTY_CONTENT_LIST_MODE.TIMELINE_MODE,path:this._context.path})}}),n.sort.push({text:C.get("CreationDate"),fonticon:"date-sorting-31-1",name:"sortByCreation",selectable:!0,selected:"sortByCreation"===t.centerColumnSortMode,handler:function(){p.trackPageEvent({category:"SwitchWhatsNewTimeline",label:"sortByCreation",view:"community-header-view",event:"click"}),this._context.reset({sortMode:A.CTY_CONTENT_LIST_SORT_MODE.CREATION_DATE,path:this._context.path})}}),n.sort.push({text:C.get("LatestContribution"),fonticon:"navigation-history",name:"sortByLatest",selectable:!0,selected:"sortByLatest"===t.centerColumnSortMode,handler:function(){p.trackPageEvent({category:"SwitchWhatsNewTimeline",label:"sortByLatest",view:"community-header-view",event:"click"}),this._context.reset({sortMode:A.CTY_CONTENT_LIST_SORT_MODE.LATEST_CONTRIBUTIONS_DATE,path:this._context.path})}})}const s=h.getNbLayoutColumns();if(this.addItem(n.share),s<3)return this.addItem(n.content),this.addItem(n.members),i||(this.addItem({text:C.get("View"),fonticon:this._getViewIcon(),name:"view-mode",items:n.view}),this.addItem({text:C.get("Sort"),fonticon:this._getSortIcon(),name:"sort-mode",items:n.sort})),void this.addItem({text:C.get("More"),fonticon:"menu-dot",className:"more-menu",name:"manage",items:n.more});this.addItem(n.more)},_getViewIcon(){switch(this._context.feedMode){case A.CTY_CONTENT_LIST_MODE.TIMELINE_MODE:return"graph-egraph-list";case A.CTY_CONTENT_LIST_MODE.COMPACTVIEW_MODE:return"list";default:return"view-big-tile"}},_getSortIcon(){switch(this._context.sortMode){case A.CTY_CONTENT_LIST_SORT_MODE.LATEST_CONTRIBUTIONS_DATE:return"navigation-history";default:return"date-sorting-31-1"}},_openWikiTree(){const e=this,t=e._context.communityId;require(["DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUIComponents/script/feature/community/wiki/view/wiki-tree-expanded-modal"],(i,n)=>{let o=new i({mid:t},{autoPopulate:!0}),s=new n({communityId:t,widget:e._widget||window.widget||document,moveOnlyCurrentNode:!1,creation:!1,addWiki:o.canCreateWikiPages()||void 0,enterEditMode:o.canReorganizeWikiPages()||void 0,forceAutoPopulate:!0,events:{onHide(){s&&s.destroy()}}});s.show(),e._onContextChange()})},_addItemsOld:function(){for(var e=this,t=this.model.getCommunityFeaturesAccess(),i="dm"===e.model.get("community_type");this.items.length>0;)this.removeItem(0);if(i&E.isFeatureActivated("activateConversationTopic")&&this.addItem({text:C.SetTopic,fonticon:"chat-alt",name:"topic",handler:function(){e._showTopicModal()}}),this.addItem({name:"favorite",text:this.model.get("is_favorite")?f.RemoveFromFavorites:f.AddAsFavorite,fonticon:this.model.get("is_favorite")?"favorite-delete":"favorite-add",handler:this._onFavoriteToggleItemClick.bind(this)}),i&&(t.settings_feature=!0,o.getInstanceFetched(function(t){t.isAllowedToCreateCommunity()&&this.addItem({text:C.TransformToCommunity,fonticon:"users-alt",name:"transformation",handler:function(){e._showTransformationIntoCommunityIfNeeded()}})}.bind(this)),this.addItem({text:C.DuplicateConversation,fonticon:"topbar-chat-add",name:"duplication",handler:function(){e._showDuplicateConversation()}})),i||!0===e.model.getDeleteRight()&&this.addItem({name:"leave",className:"leave",text:f.LeaveCommunity,fonticon:"logout",handler:this._onLeaveCommunityClick.bind(this,[e.model])}),void 0!==this.model.getCustomProperty("currentUserSubscribed")&&this.addItem({text:e.model.getCustomProperty("currentUserSubscribed")?C.UnsubscribeToNewContent:C.SubscribeToNewContent,fonticon:"bell-alt",name:"subscribe",handler:this._onSubscribeClick.bind(this)}),this.addItem({text:u.Mycontributions,fonticon:"feather",name:_.COMMUNITY_MY_CONTRIBUTIONS,handler:function(){e._navigateTo(_.COMMUNITY_MY_CONTRIBUTIONS)}}),i||(this.addItem({text:u.SubscribeToRSSFeed,fonticon:"rss",name:"rss",handler:function(){var t=e.model.get("mid"),i={ideas:"ideation",media:"media",questions:"iquestion",blog:"post",surveys:"survey",wedos:"wedo"},n=this._context.getCommunityPageContext(),o=`${h.getBaseUrl()}/rss/feed/whatsnew/community_id/${t}`;"wiki"===n?o=`${h.getBaseUrl()}/rss/filter/feed/community_id/${t}/model/wiki/`:i[n]&&(o=`${h.getBaseUrl()}/rss/feed/whatsnew/model/${i[n]}/community_id/${t};`),T.createModal(o,!0)}}),this.addItem({text:g.Share,fonticon:"forward",name:"share",handler:function(){require(["DS/SwymUIComponents/script/feature/core/share/view/share-content-view"],function(t){e._shareView=new t({model:e.model,widget:e._widget}),e._shareView.launchModal()})}})),window.ds&&"3DD"===window.ds.env&&window.widget&&widget.getAppName()===h.getMyCommunitiesAppKey()&&this.addItem({text:u.PinToThisTab,fonticon:"pin",name:"pin",handler:function(){var t={appId:h.getMyCommunitiesAppKey(),data:{url:h.getBaseUrl()}};"community"===e.model.getModelName()&&(t.data[e.model.get("users")?"dm":"community"]=e.model.get("mid")),h.pinToDashboard(t)}}),t.stats_feature&&this.addItem({text:u.Statistics,fonticon:"chart-bar",name:_.COMMUNITY_STATS,handler:function(){e._navigateTo(_.COMMUNITY_STATS)}}),this.addItem({text:u.membersPluralUp,fonticon:"users",name:_.COMMUNITY_MEMBERS,handler:function(){e._navigateTo(_.COMMUNITY_MEMBERS)}}),window.ds&&!0===window.ds.swymIM&&this.addItem({text:u.postsPluralUp,fonticon:"newspaper",name:_.COMMUNITY_BLOG,selectable:!0,handler:e._communityPageHandler.bind(e,_.COMMUNITY_BLOG)}),this.addItem({text:u.mediaPluralUp,fonticon:"picture",name:_.COMMUNITY_MEDIA,selectable:!0,handler:e._communityPageHandler.bind(e,_.COMMUNITY_MEDIA)}),this.addItem({text:u.galleryPluralUp,fonticon:"picture",name:"gallery",handler:function(){e._navigateTo("gallery")}}),E.isFeatureActivated("activateWedo")&&this.addItem({text:u.wedos,fonticon:"task",selectable:!0,name:_.COMMUNITY_WEDO,handler:e._communityPageHandler.bind(e,_.COMMUNITY_WEDO)}),t.ideation_feature&&(this.addItem({text:u.ideasPluralUp,fonticon:"lamp",name:_.COMMUNITY_IDEAS,selectable:!0,handler:e._communityPageHandler.bind(e,_.COMMUNITY_IDEAS)}),this.addItem({text:u.ideasPipeline,fonticon:"lamp",name:"pipeline",handler:function(){e._navigateTo("ideaspipeline")}})),t.qna_feature&&this.addItem({text:u.questionsPluralUp,fonticon:"help",name:_.COMMUNITY_QUESTIONS,selectable:!0,handler:e._communityPageHandler.bind(e,_.COMMUNITY_QUESTIONS)}),t.survey_feature&&this.addItem({text:u.surveysPluralUp,fonticon:"clipboard",name:_.COMMUNITY_SURVEYS,selectable:!0,handler:e._communityPageHandler.bind(e,_.COMMUNITY_SURVEYS)}),t.wiki_feature&&this.addItem({text:u.wikiUp,fonticon:"book-open",name:_.COMMUNITY_WIKI,selectable:!0,handler:e._communityPageHandler.bind(e,_.COMMUNITY_WIKI)}),this.model.canViewSocialEvent()&&this.addItem({text:u.rendezVous,fonticon:"calendar",name:_.COMMUNITY_SOCIAL_EVENTS,selectable:!0,handler:e._communityPageHandler.bind(e,_.COMMUNITY_SOCIAL_EVENTS)}),this.model.isBusinessExperienceCommunity()){if(!this.model.derivedTypesListAvailable())return this.model.addEventOnce("onSync:getDerivedTypes",x.bind(this,this.model,this)),void this.model.action("getDerivedTypes");x(this.model,this)}t.settings_feature&&this.addItem({text:u.Settings,fonticon:"cog",name:_.COMMUNITY_SETTINGS,handler:function(){i?require(["DS/SwymUIComponents/script/feature/core/conversation/view/persistency-modal"],function(t){new t({model:e.model}).inject(document.body).show()}):e._navigateTo(_.COMMUNITY_SETTINGS)}}),window.ds&&!0===window.ds.swymIM&&(this.addItem({text:C.get("Contents"),fonticon:"view-big-tile",name:"whatsnew-content",handler:function(){p.trackPageEvent({category:"SwitchWhatsNewTimeline",label:"switchToWhatsNew",view:"community-contextual-action-menu",event:"click"}),this._context.reset({feedMode:A.CTY_CONTENT_LIST_MODE.WHATSNEW_MODE,path:this._context.path})}}),this.addItem({text:C.get("CompactView"),fonticon:"list",name:"compactview-content",handler:function(){p.trackPageEvent({category:"SwitchWhatsNewTimeline",label:"switchToCompactView",view:"community-contextual-action-menu",event:"click"}),this._context.reset({feedMode:A.CTY_CONTENT_LIST_MODE.COMPACTVIEW_MODE,path:this._context.path})}}),this.addItem({text:C.get("Timeline"),fonticon:"graph-egraph-list",name:"timeline-content",handler:function(){p.trackPageEvent({category:"SwitchWhatsNewTimeline",label:"switchToTimeline",view:"community-contextual-action-menu",event:"click"}),this._context.reset({feedMode:A.CTY_CONTENT_LIST_MODE.TIMELINE_MODE,path:this._context.path})}}),this.addItem({text:C.get("CreationDate"),fonticon:"date-sorting-31-1",name:"sortByCreation",handler:function(){p.trackPageEvent({category:"SwitchWhatsNewTimeline",label:"sortByCreation",view:"community-header-view",event:"click"}),this._context.reset({sortMode:A.CTY_CONTENT_LIST_SORT_MODE.CREATION_DATE,path:this._context.path})}}),this.addItem({text:C.get("LatestContribution"),fonticon:"navigation-history",name:"sortByLatest",handler:function(){p.trackPageEvent({category:"SwitchWhatsNewTimeline",label:"sortByLatest",view:"community-header-view",event:"click"}),this._context.reset({sortMode:A.CTY_CONTENT_LIST_SORT_MODE.LATEST_CONTRIBUTIONS_DATE,path:this._context.path})}}),i?this.addItem({name:"close",text:f.CloseConversation,fonticon:"times",handler:this._onCloseConversationItemClick.bind(this)}):this.addItem({name:"follow-toggle",className:"follow-toggle",text:this.model.get("isBlacklisted")?f.Follow:f.Unfollow,fonticon:this.model.get("isBlacklisted")?"eye":"eye-slash",handler:this._onFollowToggleItemClick.bind(this)}))},_navigateTo:function(e){var t=this._context;t.reset({dmId:t.dmId,communityId:t.communityId,path:(t.dmId?"dm":"community")+":"+t.communityId+"/"+e}),w.dispatchEvent("onScrollToTopRequest")},_onSubscribeClick:function(){this.model.getCustomProperty("currentUserSubscribed")?this.model.unsubscribe():this.model.subscribe()},_onFollowToggleItemClick:function(){var t=this.model,n=new i({closable:!0,renderTo:window.document.body||this._widget.body});!1===t.get("isBlacklisted")?n.confirm({title:f.Hideallupdates+" "+t.get("title").unescapeHTML(),message:f.Youwillstillbe,callback:function(i){!0===i&&t.unfollow({onFailure:function(){},onComplete:function(){S.success(f.nownotfollowing),t.set("isBlacklisted",!0),e.dispatchEvent("requestContentListUpdate",{contextPath:"home"})}})}}):t.follow({onFailure:function(){},onComplete:function(){S.success(f.nowfollowing),t.set("isBlacklisted",!1),e.dispatchEvent("requestContentListUpdate",{contextPath:"home"})}})},_onLeaveCommunityClick:function(t){var n=t[0];new i({closable:!0,renderTo:window.document.body||this._widget.body}).confirm({title:f.deletequestion,message:f.removeMyAccessToThisCommunity,callback:function(t){!0===t&&n.deletecurrentuserfromcommunity({onComplete:function(){S.success(f.Youhavebeendeletedfromthiscommunity),e.dispatchEvent("requestContentListUpdate",{contextPath:"home"})},onFailure:function(e,t){"ERROR_TRY_TO_LEAVE_COMMUNITY_WITH_IMPLICIT_ROLE"===t.errorcode&&S.error(y.ErrorTryToLeaveCommunity)}})}.bind(this)})},_onFavoriteToggleItemClick:function(){!1===this.model.get("is_favorite")?this.model.updateFavorite(!0):this.model.updateFavorite(!1)},_onCloseConversationItemClick:function(){new i({closable:!0,renderTo:window.document.body||this._widget.body}).confirm({title:D.HideDMConfirmationModalTitle,message:D.HideDMConfirmationModalMsg,callback:function(e){!0===e&&this.model.hide({onComplete:function(){this.alert("success",D.ConversationHidden),p.trackPageEvent({category:"MyConversations",label:"hideAConversation",view:"direct-message-view",event:"click"})}.bind(this),onFailure:function(){console.log("an error occured while hiding the DM")}})}.bind(this)})},_drawMenu:function(){this._addItems(),this._onContextChange(),this.updatePosition()},_getDataPromises:function(){var e=this,t=[];return t.push(new v(function(t){e.model.hasBeenFetched()?t():e.model.addEventOnce("onSync",function(){t()})})),void 0===this.model.getCustomProperty("currentUserSubscribed")&&t.push(new v(function(t){e.model.hasCurrentUserSubscribed({onComplete:t,onFailure:t})})),t.push(new v(function(e){r.prototype.getBlacklistedCommunitiesCollection(e)})),t},onShow:function(){var e=this,t=null;this._contentCreated?(this.updateItem({id:"subscribe",text:e.model.getCustomProperty("currentUserSubscribed")?C.UnsubscribeToNewContent:C.SubscribeToNewContent}),this.updateItem({id:"follow-toggle",text:this.model.isBlacklisted()?f.Follow:f.Unfollow,fonticon:this.model.isBlacklisted()?"eye":"eye-slash"}),this.updateItem({id:"favorite",text:this.model.isFavorite()?f.RemoveFromFavorites:f.AddAsFavorite,fonticon:this.model.isFavorite()?"favorite-delete":"favorite-add"}),this.updateItem({id:"close",text:f.CloseConversation,fonticon:"times",handler:this._onCloseConversationItemClick.bind(this)}),this._onContextChange(),this.updatePosition()):(t=this._getDataPromises(),v.all(t).then(function(){!0!==e._destroyed&&(e._drawMenu(),e.dispatchEvent("MenuDrawn"))}),this._contentCreated=!0)},_hideItem:function(e){e&&e.elements.container.addClassName("hidden")},_showItem:function(e){e&&e.elements.container.removeClassName("hidden")},_showTopicModal:function(){var e=this.model;require(["DS/SwymUIComponents/script/feature/core/conversation/view/topic-modal"],function(t){new t({model:e}).inject(document.body).show()})},_showDuplicateConversation:function(){var e,t,i=window.document||this._widget,o=n.getInstance();o.dmId&&((e=new a({id:o.dmId})).get("dm_type")===a.DM_TYPE_PRIVATE&&p.trackPageEvent({category:"ConversationMembers",label:"createNewConversationFromPrivateConversation",view:"community-contextual-action-menu",event:"click"}),e.get("dm_type")===a.DM_TYPE_GROUP&&p.trackPageEvent({category:"ConversationMembers",label:"addMemberToGroupConversation",view:"community-contextual-action-menu",event:"click"}),t=new m({mode:"create",dmModel:e})),t.render(i.body).show()},_showTransformationIntoCommunityIfNeeded:function(){var e=this.model,t=e.get("users"),i=e.has("topic")?e.get("topic",{escapeHTML:!1}):"";o.getInstanceFetched(function(n){if(!0===n.get("canCreateCommunity")){var o=new s({dmIdToBeTransformed:e.get("mid")});o.addChanges("title",i),new d({model:o,possibleOwners:t}).render(document.body).show()}else{var a=new l({dmIdToBeTransformed:e.get("mid")});a.addChanges("community_dm_id",e.get("mid")),a.addChanges("title",i),new c({model:a,possibleOwners:t}).render(document.body).show()}})},_enforceMaxItemsBeforeScroll:function(e){var t,i=e.items.filter(function(e){return!e.elements.container.hasClassName("hidden")});return i=i.filter(function(e){if("none"===e.elements.container.getStyle("display"))return e.elements.container.addClassName("hidden"),!0}),t=this._parent.apply(this,arguments),i.forEach(function(e){e.elements.container.removeClassName("hidden")}),t},updatePosition:function(){var e,t=this.getOption("target");if(!t||0!==(e=t.getSize()).width||0!==e.height)return this._parent.apply(this,arguments);this.hide()},destroy:function(){return this._destroyed=!0,this._widget=null,this._shareView=null,this._pipelineModal=null,this._context.removeListener("onFeedModeChange",this._onFeedModeChange),this._context.removeListener("onSortModeChange",this._onSortModeChange),this._context.removeListener("onContextChange",this._onContextChange),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/community/view/community-tile-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/context/context-model","i18n!DS/SwymUICore/assets/nls/feature/community/community/model/community-model","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-detailed-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-become-author-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-tile-view","i18n!DS/SwymUIComponents/assets/nls/feature/core/share/view/share-content-view","DS/UWPClientCode/I18n","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUIComponents/script/feature/community/community/view/community-signup-request-launcher","DS/SwymUIComponents/script/feature/community/content/view/media-thumbnail-view","DS/SwymUIComponents/script/feature/core/ui-components/layout/layout-manager","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/utils","DS/SwymUIComponents/script/feature/community/community/view/community-request-become-author-modal-view","DS/UIKIT/DropdownMenu","DS/SwymUIComponents/script/feature/core/modal/super-modal","DS/UIKIT/Input/Button","DS/UIKIT/Spinner","DS/UIKIT/Scroller","DS/SwymUICore/script/lib/event-manager","DS/SwymUIComponents/script/feature/core/ui-components/community-contextual-action-menu"],function(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w,C,f,y,v,A,_,S){"use strict";var b={};return b[o.Public]="fonticon fonticon-globe",b[o.Private]="fonticon fonticon-lock-open",b[o.Secret]="fonticon fonticon-lock",t.extend({_modelClass:i,_modelEvents:{"onSync:setlogo":"refresh","onChange:title":"refresh","onChange:description":"refresh","onChange:owner":"refresh","onChange:access":"refresh"},domEvents:{'click *[data-content-type="person"][data-hash-key]':"_onUserClick","click .community-action-toolbar.my-communities":"_onToolbarClick","click .community-action-toolbar.discover-communities":"_stopPropagate","click .title .fonticon.fonticon-down-open":"_onOpenIconClick"},name:"community-tile-view",className:"swym-tile",isListUsage:!1,showActionToolbar:!1,_requestToBecomeAuthor:function(){var e=this.addControl("requestBecomeAuthorModal",new w({model:this.model}));e.render(document.body),e.show()},_onUserClick:function(e){e.stopPropagation(),e.preventDefault(),require(["DS/SwymUICore/script/utils/link-builder-utils"],function(t){t.displayProfile(e)})},_onToolbarClick:function(e){e.stopPropagation();var t=this.getControl("dropdownMenu");t&&t.show()},_stopPropagate:function(e){e.stopPropagation()},_onOpenIconClick:function(e){e.stopPropagation()},_follow:function(){this.model.set("isBlacklisted",!1),this.refresh(),this.model.follow({onComplete:function(){this.alert("success",s.nowfollowing),_.dispatchEvent("requestContentListUpdate",{contextPath:"home"})}.bind(this),onFailure:function(){this.alert("error",s.NowFollowingErrorMsg),this.model.set("isBlacklisted",!0),this.refresh()}})},_unfollow:function(){this.model.set("isBlacklisted",!0),this.refresh(),this.model.unfollow({onComplete:function(){this.alert("success",s.nownotfollowing),_.dispatchEvent("requestContentListUpdate",{contextPath:"home"})}.bind(this),onFailure:function(){this.alert("error",s.NowNotFollowingErrorMsg),this.model.set("isBlacklisted",!1),this.refresh()}})},_onLeaveCommunityClicked:function(){this.addControl("removeConfirmationModal",new f({closable:!0,renderTo:this._widget.body})).confirm({title:s.deletequestion,message:s.removeMyAccessToThisCommunity,callback:function(e){!0===e&&this.model.deletecurrentuserfromcommunity({onComplete:function(){this.alert("success",s.Youhavebeendeletedfromthiscommunity),this.destroy()}.bind(this)})}.bind(this)})},setup:function(e){this._parent(e);var t=n.getInstance();e&&(void 0!==e.isListUsage&&(this.isListUsage=e.isListUsage),void 0!==e.showActionToolbar&&(this.showActionToolbar=e.showActionToolbar),this._displayAccessors=void 0!==e.displayAccessors&&e.displayAccessors,this._responsive=!(void 0===e.responsive||!e.responsive)&&e.responsive,this.isListUsage||this.container.addClassName("community-idcard")),this._context=t,this._context.removeListener("onCommunityChange",this.onCommunityChange,this),this.onCommunityChange=this.onCommunityChange.bind(this),!1===this.isListUsage&&t.addListener("onCommunityChange",this.onCommunityChange,this,!0)},onCommunityChange:function(e){e&&e.communityId&&this.setModel(new i({id:e.communityId}))},_displaySprite:function(){var e=!1===this.isListUsage?{size:"l"}:{},t=this.getChildView("communityLogo");return t&&t.getInitialModel().equals(this.model)?t:this.addChildView("communityLogo",new u({model:this.model,imageRenderingOptions:e}))},_createContent:function(){var t,n,o=this.model,a=[];return this.elements.fonticonDown||(this.elements.fonticonDown=e.createElement("span",{class:"fonticon fonticon-down-open"})),t=this.elements.fonticonDown,this.elements.fonticonDownDiv||(this.elements.fonticonDownDiv=e.createElement("div",{class:"fonticon fonticon-down-open"})),n=this.elements.fonticonDownDiv,o&&o.get("owner")?(a=[(o?o.hasDefaultLogo():null)?"":{class:"logo no-community-rich-tooltip","data-content-type":"community","data-content-id":o.get("mid"),html:this._displaySprite()},{class:"block-except-logo no-community-rich-tooltip","data-content-type":"community","data-content-id":o.get("mid"),html:[{class:"title",html:[o.get("title"),this.showActionToolbar?"":n]},{class:"subtitle",html:[{tag:"span",class:"visibility",html:[{tag:"span",class:b[o.getVisibility()]},{tag:"span",html:o.getVisibility()+" - "}]},{tag:"a",class:"link","data-content-type":"person","data-hash-key":o.get("owner").hash_key,"data-login":o.get("owner").login,html:o.getMainOwner()?o.getMainOwner().getNickname():""}]},{class:"description",html:o.get("description",{escapeHTML:!1})},!1===this.isListUsage&&o.getUserRole()===i.COMMUNITY_CONTRIBUTOR_ROLE?this.getBecomeAuthorView():"",!0===this.showActionToolbar&&"0"!==o.get("user_access")?{class:"community-action-toolbar my-communities",html:[o.get("role")?{class:"community-role",html:c.replace(s.Im,{spanRoleOpen:'<span class="role">',spanRoleClose:"</span>",role:o.getTranslatedRole()})}:"",{tag:"span",class:"fonticon fonticon-eye "+(this.model.get("isBlacklisted")?"":"isblue")},t]}:{},!0===this.showActionToolbar&&"0"===o.get("user_access")&&p.getInstance().isFeatureActivated("activate_community_join_request")?{class:"community-action-toolbar discover-communities",html:this.addControl("join-button",new y({value:s.Join,className:"small",icon:"login",events:{onClick:function(){m.show(this.model)}.bind(this)}}))}:{}]}],!0===this.showActionToolbar?d.getInstanceFetched(this._buildDropDownMenu(t)):this._ctyContextualActionMenu=this.addControl("contextualActionMenu",new S({target:n,widget:this._widget,model:this.model}))):a=e.createElement("div",{styles:{margin:"auto","text-align":"center",height:"40px"},html:new v({className:"msg-animation",visible:!0,animate:!0,spin:!0})}),a},getBecomeAuthorView:function(){var e=this.getChildView("becomeAuthorView");return e||(e=this.addChildView("becomeAuthorView",{Class:"DS/SwymUIComponents/script/feature/community/community/view/request-become-author-view"})),e},destroy:function(){return n.getInstance().removeListener("onCommunityChange",this.onCommunityChange,this),this._parent.apply(this,arguments)},_buildDropDownMenu:function(e){var t=this.model.get("isBlacklisted"),i=[];p.getInstance().isFeatureActivated("active_community_blacklist")&&i.push({name:t?"follow":"unfollow",text:t?s.Follow:s.Unfollow,fonticon:"eye"}),"Contributor"===this.model.get("role")&&p.getInstance().isFeatureActivated("activate_community_change_role_request")&&i.push({name:"becomeAuthor",text:s.BecomeAuthor,fonticon:"user"}),!0===this.model.getDeleteRight()&&i.push({name:"leave",text:s.LeaveCommunity,fonticon:"logout"}),i.length>0?this.addControl("dropdownMenu",new C({target:e,renderTo:window.document.body.getElement(".scroll-content"),position:"bottom right",offset:{x:17,y:8},items:i,events:{onClick:function(e,t){switch(t.name){case"leave":this._onLeaveCommunityClicked();break;case"follow":this._follow();break;case"unfollow":this._unfollow();break;case"becomeAuthor":this._requestToBecomeAuthor()}}.bind(this)}})):e.hide()}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/content-template-editor-view",["UWA/Core","DS/SwymUIComponents/script/feature/community/content/edit/content-editor-view","DS/SwymUIComponents/script/feature/community/content/edit/content-type-selector","DS/SwymUIComponents/script/feature/community/template/model/content-template-model","DS/UIKIT/Input/Button","i18n!DS/SwymUIComponents/assets/nls/feature/community/content/edit/content-creation-view"],function(e,t,i,n,o,s){const a=i.extend({onContentTypesChange:function(){this.setCurrentItems(this._typesManager.getContentTypes()),this.refresh()}});return t.extend({init:function(){this._parent.apply(this,arguments),this.contentTypeSelectorClass=a},onCancel:function(){console.log(this)},_getCurrentTypeMapping:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},setup:function(){this._parent.apply(this,arguments),this.uiConfiguration.simpleRTE.saveAsDraft=!1,this.addControl("templateCreationButton",new o({value:s.SaveTemplate,disabled:!1,className:"primary template-creation-button",events:{onClick:this.onSaveTemplate.bind(this)}}))},onSaveTemplate:function(){const e=this,t=this._context.getData().communityId,i=this.getElement(".content-title-text").value,o=this.getBodyAttributes().content,s=this._getCurrentTypeMapping(this.getCurrentContentType());(new n).save({communityId:t,title:i,message:o,contentType:s},{onComplete:t=>{console.log("succes creation template"),e.dispatchEvent("onTemplateCreated",[t.get("content_type"),t.get("id"),t.get("title")])},onFailure:()=>{console.log("error failure creation template")}})}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/content-creation-view",["UWA/Core","UWA/String","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUIComponents/script/feature/community/content/edit/content-editor-view","DS/SwymUIComponents/script/utils/content-creation-types-manager","DS/SwymUIComponents/script/feature/core/ui-components/layout/layout-manager","DS/SwymUICore/script/feature/core/context/context-model"],(e,t,i,n,o,s,a)=>{return i.extend({name:"content-creation-view",defaultOptions:{contentEditorViewClass:n},domEvents:{resize:"onViewResize"},onViewResize(){!0===this.options.dispatchResize&&s.dispatchEvent("onContentCreationViewResize",[this])},init(){this.onContentTypesChangeBound=this.onContentTypesChange.bind(this),this.onCurrentContentTypeChangeBound=this.onCurrentContentTypeChange.bind(this),this.onContentTypeIconChangeBound=this.onContentTypeIconChange.bind(this),this._typesManager=o.getInstance(),this._contextManager=a.getInstance();const e=this._parent.apply(this,arguments);return!0!==this.getOption("createMessagesOnly")&&"ritual"!==this.getOption("lockOn")&&(this._typesManager.addEvent("onContentTypesChange",this.onContentTypesChangeBound,null,!0),this._typesManager.addEvent("onCurrentContentTypeChange",this.onCurrentContentTypeChangeBound,null,!0),this._typesManager.addEvent("onContentTypeIconChange",this.onContentTypeIconChangeBound,null,!0)),e},_createWikiEditorView(e,t){const i=this;let n=i.getChildView("wikiEditorView");if(!n){const o={taggingContextManager:i.getOption("taggingContextManager"),creation:!0};t&&(o.model=t),n=i.addChildView("wikiEditorView",new e(o)),i.listenTo(n,{onSwitchToMaximizedView:i._onSwitchToMaximizedView,onWikiCancel(){n.clearUndoTextInEditor(),i._onSwitchToMinimizedView(),i.getChildView("editorView").switchToMinimizedView()}}),i.getElement(".community-content-wrapper")&&n.inject(i.getElement(".community-content-wrapper"))}return n},setup(){const e=this;this._parent.apply(this,arguments);const t=this.getOption("contentEditorViewClass");this.listenTo(this.addChildView("editorView",new t({taggingContextManager:this.getOption("taggingContextManager"),createMessagesOnly:this.getOption("createMessagesOnly"),lockOn:this.getOption("lockOn"),isTemplateFeatureEnabled:this.getOption("isTemplateFeatureEnabled")})),{onSwitchToMaximizedView:this._onSwitchToMaximizedView,onSwitchToMinimizedView:this._onSwitchToMinimizedView,onCommunityChange(t){if("wiki"!==e._typesManager.getCurrentContentType())e.getChildView("editorView").setCommunityId(t);else{const i=e.getChildView("wikiEditorView");i&&i.setCommunityId(t)}},showWikiEditor:this.showWikiEditor})},onContentTypesChange(e){if(!e||!e.contentTypes)throw new Error("No content types present");e.contentTypes.length>0?this.show():this.hide()},showWikiEditor(){const e=this;let t=e.getChildView("wikiEditorView");const i=e.getChildView("editorView");t?(t.show(),t.switchToMaximizedView(),i.hide()):require(["DS/SwymUIComponents/script/feature/community/wiki/edit/wiki-edit-view"],n=>{(t=e._createWikiEditorView(n)).show(),t.switchToMaximizedView(),i.hide()}),i.getTemplateManager()&&i.getTemplateManager().notifyTemplateAvailability(t)},onCurrentContentTypeChange(){let e;(e=this.getElement(".community-content-wrapper"))&&("wiki"===this._typesManager.getCurrentContentType()?e.removeClassName("one-column"):e.addClassName("one-column"))},onContentTypeIconChange(e){const t=this;let i;const n=t.getChildView("editorView"),s=n.getTemplateManager()?n.getTemplateManager().getWikiTemplate():null;let a,r;if(t.isVisible()){if("wiki"===e.newType)require(["DS/SwymUIComponents/script/feature/community/wiki/edit/wiki-edit-view"],l=>{const{model:c}=n;let d;c&&c.getModelName()===o.WIKI&&(d=c),i=t._createWikiEditorView(l,d),"media"!==e.oldType&&"survey"!==e.oldType&&n.getBodyAttributes&&(a=n.getBodyAttributes()&&n.getBodyAttributes().content||""),r=n._titleContent,n.hide(),i.show(),i.switchToMaximizedView(),"media"!==e.oldType&&"survey"!==e.oldType&&i._getBodyView()._getCurrentView().getRTEView().updateEditor(a),i.setTitleValue(r),i.focusOnTitleInput&&i.focusOnTitleInput(),s&&n.getTemplateManager().notifyTemplateAvailability(i)});else if((i=t.getChildView("wikiEditorView"))&&i.isVisible()&&(i.hide(),n.switchToMaximizedView()),n.show(),t._typesManager.setContentTypeRequest({type:e.newType}),"survey"===e.newType&&n.switchToMaximizedView(),"wiki"===e.oldType&&i&&i.isMaximized()&&"media"!==e.newType&&"survey"!==e.newType){const e=i.getTitleValue();a=i.getBodyAttributes().content,n._getBodyView()._getCurrentView().getRTEView().updateEditor(a),e&&n.setTitleValue(e),n.focusOnTitleInput&&n.focusOnTitleInput()}setTimeout(()=>{t._typesManager.removePersisted("onContentTypeIconChange")},0)}},onRedraw(){let e=this._typesManager.getContentTypes();!0===this.getOption("createMessagesOnly")&&(e=[o.MESSAGE]),e&&e.length>0?this.removeClassHidden():this.addClassHidden()},addClassHidden(){this.container&&!this.container.hasClassName("hidden")&&this.container.addClassName("hidden")},removeClassHidden(){this.container&&this.container.hasClassName("hidden")&&this.container.removeClassName("hidden")},_onSwitchToMaximizedView(){const e=this.getElement(".community-content-wrapper"),t=this.getChildView("editorView"),i=this.getChildView("wikiEditorView");"wiki"===this._typesManager.getCurrentContentType()&&(t.hide(),i&&i.show()),e&&e.addClassName("content-item full-content"),s.dispatchEvent("onMaximizeRequest",[this])},_onSwitchToMinimizedView(){const e=this,t=e.getElement(".community-content-wrapper"),i=e.getChildView("editorView"),n=e.getChildView("wikiEditorView");"wiki"===e._typesManager.getCurrentContentType()&&(n.hide(),i.show()),t&&(t.removeClassName("content-item"),t.removeClassName("full-content")),e.container&&e.container.hasClassName("maximized")&&s.dispatchEvent("onUnMaximizeRequest",[e])},_createContent(){const t=this.getChildView("wikiEditorView"),i=this.getChildView("editorView"),n=e.createElement("div",{class:"community-content-wrapper",html:[]});return"wiki"!==this._typesManager.getCurrentContentType()&&(n.addClassName("one-column"),t&&(t.hide(),i.show())),i.inject(n),t&&t.inject(n),n},onHide(){this._contextManager.getRoute().contains("search")&&"social-event"===this._typesManager.getCurrentContentType()||this.container&&this.container.hasClassName("maximized")&&s.dispatchEvent("onUnMaximizeRequest",[this])},onUnMaximize(){const e=this.getChildView("editorView"),t=this.getChildView("wikiEditorView");t&&t.onCancel(!1),e&&e.onCancel(!1)},destroy(){!0!==this.getOption("createMessagesOnly")&&"ritual"!==this.getOption("lockOn")&&(this._typesManager.removeEvent("onContentTypesChange",this.onContentTypesChangeBound),this._typesManager.removeEvent("onCurrentContentTypeChange",this.onCurrentContentTypeChangeBound),this._typesManager.removeEvent("onContentTypeIconChange",this.onContentTypeIconChangeBound)),this._parent.apply(this,arguments)}})}),define("DS/SwymUIComponents/script/feature/community/content/edit/content-template-creation-view",["UWA/Core","DS/SwymUIComponents/script/feature/community/content/edit/content-creation-view","DS/SwymUIComponents/script/feature/community/content/edit/content-template-editor-view"],function(e,t,i){return t.extend({defaultOptions:{contentEditorViewClass:i},_editorView:null,_getCurrentTypeMapping:function(){let e=this.getOption("currentType").toLowerCase();return"ideation"===e?e="idea":"question"===e&&(e="iquestion"),e},init:function(){this._parent.apply(this,arguments);const e=this._getCurrentTypeMapping();this._typesManager.setContentTypeRequest({type:e,types:[e],creationTemplate:!0}),console.log(this._contextManager)},setup:function(){const e=this;this._parent.apply(this,arguments),this._editorView=this.getChildView("editorView"),this._editorView.addEvent("onTemplateCreated",function(t,i,n){e.dispatchEvent("onTemplateCreated",[t,i,n])})},onRedraw:function(){this._parent.apply(this,arguments),this._editorView.switchToMaximizedView(),this.setEditView()},maximized:function(){this.container.addClassName("maximized")},setEditView:function(){let e=this.getElement(".community-content-wrapper");this.maximized(),e&&("wiki"===this._typesManager.getCurrentContentType()&&this._editorView.container.setStyle("display","block"),e.removeClassName("one-column"),e.addClassName("edit-mode"))}})}),define("DS/SwymUIComponents/script/feature/community/community/view/content-template-settings-view",["UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUIComponents/script/feature/community/template/view/content-template-selector-view","DS/SwymUIComponents/script/feature/community/content/edit/content-template-creation-view","DS/SwymUICore/script/feature/core/context/context-constants","DS/UIKIT/Input/Toggle","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-feature-settings-view"],function(e,t,i,n,o,s,a,r){"use strict";return t.extend({_modelClass:i,domEvents:{"click button.fonticon.fonticon-plus.creation-template":"onTemplateCreation"},name:"content-template-settings",_communityId:null,_editorContainer:null,_contentTypes:[s.COMMUNITYPAGE_TO_CONTENTTYPE(s.COMMUNITY_BLOG),s.COMMUNITYPAGE_TO_CONTENTTYPE(s.COMMUNITY_QUESTIONS),s.COMMUNITYPAGE_TO_CONTENTTYPE(s.COMMUNITY_IDEAS)],_createContent:function(){let t=[],i=e.createElement("h5",{html:r.ContentTemplates});return t.push(i),this._contentTypes.map(i=>{const n=this._getCurrentTypeMapping(i),o=this._createLabel(n),s=this._createContentTemplateSelect(n),a=this._createButton(n),r=e.createElement("div",{class:"content-template-container",html:[o,s,a]});t.push(r)},this),t},_createLabel:function(t){return e.createElement("label",{class:"template-label",html:this._getLabelText(t)})},_getLabelText:function(e){switch(e){case"Post":return r.Post;case"Ideation":return r.Ideas;case"Question":return r.iQuestions;case"WikiPage":return r.Wiki;case"Wedo":return r.Wedo}},_createContentTemplateSelect:function(t){return this._createContentTemplateSelectorView(t),e.createElement("div",{class:"content-template-select-cnt",html:this._getContentTemplateSelector(t)})},_createButton:function(t){return e.createElement("button",{class:"fonticon fonticon-plus creation-template","data-content-type":t,styles:{"background-color":"transparent",outline:"none",border:"none"}})},_createCheckBoxDefault:function(){return new a({className:"default-toggle",type:"checkbox",label:r.DefaultStatement,events:{onChange:e=>{console.log(e)}}})},_getCurrentTypeMapping:function(e){let t=e.charAt(0).toUpperCase()+e.slice(1);return"Iquestion"===t?t="Question":"Idea"===t&&(t="Ideation"),t},_getTemplateSelectorName:function(e){if("iquestion"===e)return"question"},setup:function(){this._parent.apply(this,arguments),this._communityId=this.model.get("mid")},_createContentTemplateSelectorView:function(e){this.addChildView(e+"ContentTemplateSelector",new n({communityId:this._communityId,contentType:e,modeSettings:"true"})),this._getContentTemplateSelector(e).populateContentTemplateCollection()},_getContentTemplateSelector:function(e){return this.getChildView(e+"ContentTemplateSelector")},_getContentTemplateByContentType:function(e){const t=this._getContentTemplateSelector(e);t.setCommunityId(this._communityId),t.setContentType(e),t.populateContentTemplateCollection()},onSetModel:function(){this._communityId=this.model.get("mid");for(const e in this._contentTypes)this._getContentTemplateSelector(this._contentTypes[e])&&this._getContentTemplateByContentType(this._contentTypes[e])},onTemplateToggle:function(){},onTemplateCreation:function(e){const t=e.target.getParents(),i=e.target.getAttribute("data-content-type");let n=null;for(const e in t)t[e].hasClassName("no-native-scrollbars")&&(n=t[e]);this._createContentTemplateEditorView(i,n)},_createContentTemplateEditorView:function(t,i){const n=this.addChildView("contentTemplateEditor",{Class:o,currentType:t,events:{onTemplateCreated:(e,t,i)=>{this._getContentTemplateSelector(e).dispatchEvent("onTemplateCreated",[t,i])},onCancel:()=>{n.destroy(),this._editorContainer.destroy()}}});this._editorContainer=e.createElement("div",{class:"content-template-editor-container",html:this.getChildView("contentTemplateEditor")}).inject(i,"before")}})}),define("DS/SwymUIComponents/script/feature/community/community/view/community-settings-view",["UWA/Core","UWA/Event","UWA/Utils","i18n!DS/SwymUIComponents/assets/nls/feature/community/community/view/community-settings-view","i18n!DS/SwymUIComponents/assets/nls/feature/community/idea/view/idea-status-admin-view","DS/SwymUICore/script/lib/view/generic/swym-model-view","DS/SwymUICore/script/lib/view/generic/swym-collection-view","DS/SwymUICore/script/utils/utils","DS/SwymUIComponents/script/feature/community/community/view/community-visibility-settings-view","DS/SwymUIComponents/script/feature/community/community/view/community-feature-settings-view","DS/SwymUIComponents/script/feature/community/community/view/content-template-settings-view","DS/SwymUIComponents/script/feature/community/community/view/logo-edit-view","DS/SwymUIComponents/script/feature/community/idea/view/idea-status-admin-view","DS/SwymUIComponents/script/feature/community/community/view/community-tags-update-view","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUIComponents/script/utils/feature-activation-manager","DS/SwymUICore/script/utils/date","DS/SwymUICore/script/utils/usage-tracker","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/UIKIT/Input/Text","DS/UIKIT/Input/Select","DS/UIKIT/Input/Button"],(e,t,i,n,o,s,a,r,l,c,d,m,u,h,p,g,w,C,f,y,v,A)=>{const _=s.extend({_modelClass:p,_modelEvents:{"onChange:description":"refresh"},domEvents:{"change textarea":"onChange","keyup textarea":"onChange"},_createContent(){const{model:e}=this,t=function(e,t){let i=e.getChanges(t);return i||(i=e.get(t,{escapeHTML:!1})),i}(e,"description");return[{tag:"h5",html:n.Description},this.addControl("input",new y({name:"description",placeholder:n.Enteradescriptionforthecommunity,value:t?t.unescapeHTML():"",className:"title-editor-input",rows:3,multiline:!0}))]},onChange(e){let{value:i}=t.getElement(e);e&&e.target&&void 0!==e.target.value&&(i=e.target.value,this.model.addChanges("description",i))},setFocus(){this.getControl("input").focus()}}),S=a.extend({defaultOptions:{asAdmin:!1},init(...e){return this._parent(...e),this.collection.as_admin=this.getOption("asAdmin"),this.collection.goToPage(1,{data:{usersOnly:!0}}),this},_modelClass:p,_createContent(){const e=this.collection.getAssociated("owned"),t=e.getAssociated("owner"),i=`${t.get("first_name")} ${t.get("last_name")}`;let o;if(this.collection.length<=0)o=[{value:t.get("hash_key"),selected:!0,label:i}];else{o=[];const e=this.collection.length;for(let i=0;i<e;i+=1){const e=this.collection.at(i),s=e.get("hash_key"),a="0"===e.get("ut_state"),r=e.get("ut_invitation_email"),l=`${e.get("first_name")} ${e.get("last_name")}`.replace(/&#x27;/g,"'");!0===a?""===l.trim()?o.push({value:s,label:`${r} (${n.Pending})`,disabled:!0}):o.push({value:s,label:`${l} (${n.Pending})`,disabled:!0}):s===t.get("hash_key")?o.push({value:s,selected:!0,label:l}):o.push({value:s,label:l})}}return[{tag:"h5",html:n.MainOwner},this.addControl("select",new v({name:"stats",hidePlaceholder:!0,placeholder:n.Selectacommunitymainowner,options:o,events:{onChange(t){let i;if(t&&t.target&&t.target.value){const n=i=t.target.value;e.addChanges("main_owner_hash_key",n)}else e.removeChanges("main_owner_hash_key")}}}))]}}),b=s.extend({defaultOptions:{asAdmin:!1},_modelClass:p,_modelEvents:{onVirtualChange:"onVirtuallyChanged"},_statusChanged:!1,_onCancel(){this.dispatchEvent("onCancel")},statusSaved(e){!0===e&&(this.setStatusChanged(!1),this.saveCommunitySettings(!0))},setStatusChanged(e){this._statusChanged=e;const t=this.container.getElement(".save-changes");this.enableCancel(),!0===e&&t?t.setHTML(n.Youvemadchanges):t&&t.setHTML("")},setup(...e){this.saveButtonView=this.addControl("saveButton",new A({className:"primary",value:n.Apply,events:{onClick:this.onSave.bind(this)}})),this.reactTo(this.saveButtonView,"enableSave",this.enableSave),this.reactTo(this.saveButtonView,"disableSave",this.disableSave),this._parent(...e)},enableSave(){this.saveButtonView.enable(),this.model.hasVirtuallyChanged()&&this.onVirtuallyChanged()},enableCancel(){e.is(this._widget)&&e.is(this._widget.getAppName)&&this._widget.getAppName()===r.getControlCenterAppKey()||this.resetButtonView&&this.resetButtonView.isDisabled()&&this.resetButtonView.enable()},disableSave(){this.saveButtonView.disable()},onVirtuallyChanged(){if(this.model.hasVirtuallyChanged()){if(this.saveButtonView&&!this.saveButtonView.isDisabled()){const e=this.container.getElement(".save-changes");e&&e.setHTML(n.Youvemadchanges),this.enableCancel()}}else if(this.saveButtonView&&!this.saveButtonView.isDisabled()){const t=this.container.getElement(".save-changes");t&&t.setHTML(""),e.is(this._widget)&&e.is(this._widget.getAppName)&&this._widget.getAppName()===r.getControlCenterAppKey()||this.resetButtonView&&!this.resetButtonView.isDisabled()&&this.resetButtonView.disable()}},async saveCommunitySettings(e){const t=this.model,i=t.getChanges(),{length:o}=Object.keys(i);let s=!1;if(this.getOption("saveTags"))try{await this.getOption("saveTags")(),s=!0}catch(e){console.error(e)}0!==o?(t.removeChanges("tagsChanged"),t.save({as_admin:this.getOption("asAdmin")},{onComplete:function(){this.dispatchEvent("onCommunitySettingsSaved",[this.model]),this.alert("success",n.Yourchangeshavebeensaved)}.bind(this),onFailure:function(e,t){let i="";i="ERROR_COMMUNITY_CREATION_TITLE_UNIQUENESS"===t.errorcode?n.communityTitleAlreadyExist:n.YourchangescouldnotbesavedPleasetryagainlater,this.alert("error",i)}.bind(this)})):e||s?this.alert("success",n.Yourchangeshavebeensaved):(this.alert("info",n.noChangesApplied),this.dispatchEvent("onCommunitySettingsSaved",[t]))},onSave(){this._statusChanged?this.dispatchEvent("saveStatus"):this.saveCommunitySettings(!1),C.trackPageEvent({category:"CommunityTags",label:"clickApplyInSettings",view:"community-settings-view",event:"click"})},_createContent(){const e=this;return this.resetButtonView=this.addControl("resetButton",new A({value:n.Cancel,events:{onClick(){const t=e.getElement(".save-changes");t&&t.setHTML(""),e.dispatchEvent("onCancel"),C.trackPageEvent({category:"CommunityTags",label:"clickCancelInSettings",view:"community-settings-view",event:"click"})}}})),[{class:"save-container col-xs-12",html:[{class:"reset-button",html:this.resetButtonView},{class:"apply-button",html:[this.saveButtonView]},{class:"save-changes",html:""}]}]}}),I=s.extend({defaultOptions:{asAdmin:!1},_modelClass:p,_createContent(){const e=this.addChildView("statusAdmin",new u({asAdmin:this.getOption("asAdmin"),widget:this._widget,model:this.model}));return this.reactTo(e,"hasChanged",function(e){this.dispatchEvent("hasChanged",e)},this),this.reactTo(e,"onStatusSaveCallback",function(e){this.dispatchEvent("onStatusSaveCallback",e)},this),[{tag:"h5",html:n.Ideastatusmanagement},e]}});return s.extend({defaultOptions:{asAdmin:!1},_modelClass:p,_scrollerContentSelector:".settings-body-int-wrapper",_modelEvents:{onRequest:"mask",onSync:"unmask",onError:"unmask","onVirtualChange:description":"onDescVirtualChange","onVirtualChange:title":"onTitleVirtualChange"},attributes:{class:"settings"},async _onCancel(){this.model.removeChanges(),this.refresh(),Object.keys(this._childViews).forEach(e=>{Object.hasOwnProperty.call(this._childViews,e)&&this._childViews[e].refresh()});const e=this.getChildView("communityTagsView");e&&await e.resetAllViews(),this.dispatchEvent("onCancel"),this.getChildView("statusAdminContainerView")&&(this.model.get("ideation_is_enabled")?this.getChildView("statusAdminContainerView").show():this.getChildView("statusAdminContainerView").hide(),this.getChildView("statusAdminContainerView").addEventOnce("onRefresh",()=>{this.getChildView("statusAdminContainerView").getChildView("statusAdmin")._onCancelButtonClick()})),this.alert("info",n.yourChangesHaveBeenCancelled)},_saveStatus(){this.getChildView("statusAdminContainerView").getChildView("statusAdmin").pipelineValidation()&&this.getChildView("statusAdminContainerView").getChildView("statusAdmin").saveStatus()},onTitleVirtualChange(e,t){const i=e.validateField("title",t);this.dispatchEvent("communityTitleValidationToggle",[i]),"err-empty"===i?this.alert("error",n.Thecommunitytitlecannotbeempty):"err-length"===i&&this.alert("error",n.Thelengthofthecommunitytitlecannotbemorethan255characters)},onDescVirtualChange(e,t){const i=this.getChildView("description"),o=e.validateField("description",t);o?(i&&i.container&&i.container.addClassName("has-error"),"err-empty"===o&&this.alert("error",n.Thecommunitydescriptioncannotbeempty)):i&&i.container&&i.container.hasClassName("has-error")&&i.container.removeClassName("has-error")},_createLogoEditView(){const e=this.addChildView("logoEditView",{asAdmin:this.getOption("asAdmin"),showCollection:!0,widget:this._widget,className:"editor-border",attributes:{styles:{display:"none"}},Class:m,model:this.model,mode:this.options.mode,mediaCollectionLimit:12});return this.reactTo(e,"tenantLogoSelected",()=>{e.mask()}),this.reactTo(e,"logoLoaded",this.onLogoLoaded),this.reactTo(e,"logoSelected",this.setCommunityLogo),e},statusAdminManagerViewCallback(e){e?(this.container.getElement(".status-admin")||this.getChildView("statusAdminContainerView").inject(this.container.getElement(".settings-body"),"bottom"),this.getChildView("statusAdminContainerView").show()):this.getChildView("statusAdminContainerView").hide()},_createContentTemplateSettingsView(){return this.addChildView("contentTemplatesSettingsView",{className:"content-templates-settings section col-xs-12 col-sm-12 feature-section",Class:d,model:this.model})},setup(...e){this._parent(...e);const{model:t}=this,i=this;i.reactTo(t,"onValidationFailure",(e,t)=>{"description:err-empty"===t&&i.getChildView("description").setFocus()}),i.reactTo(t,"onSync:editmembers",()=>{t.getPossibleMainOwners().refresh()});const n=this.addChildView("featureView",{className:"feature-settings section col-xs-12 col-sm-12 feature-section",Class:c,model:t});this.reactTo(n,"enableSave",this.enableSave),this.reactTo(n,"disableSave",this.disableSave);const o=this.addChildView("saveView",{asAdmin:this.getOption("asAdmin"),className:"save section",Class:b,model:t,saveTags:async()=>{const e=this.getChildView("communityTagsView");return!e||e.save()}});this.reactTo(o,"onCancel",this._onCancel),this.reactTo(o,"onCommunitySettingsSaved",this.onCommunitySettingsSaved),this.reactTo(o,"saveStatus",this._saveStatus),this._createLogoEditView();const s=this.addChildView("statusAdminContainerView",{asAdmin:this.getOption("asAdmin"),className:"status-admin section col-xs-12 col-sm-12 feature-section",Class:I,model:t});this.reactTo(s,"hasChanged",e=>{o.setStatusChanged(e)},this),this.reactTo(s,"onStatusSaveCallback",e=>{o.statusSaved(e)},this),this.listenTo(this.getChildView("featureView"),"ideaFeatureToggle",this.statusAdminManagerViewCallback)},destroy(...e){return this.stopListening(this.getChildView("featureView"),"ideaFeatureToggle",this.statusAdminManagerViewCallback),this._parent(...e)},showEditLogoView(){const e=this.getChildView("logoEditView");e&&e.container&&(e.unmask(),e.container.style&&"none"===e.container.style.display?e.container.show():e.container.hide())},onLogoLoaded(e){this.setCommunityLogo(e)},onSetModel(){this.getChildView("featureView")&&this.getChildView("featureView").setModel(this.model),this.getChildView("statusAdminContainerView")&&this.getChildView("statusAdminContainerView").setModel(this.model),this.getChildView("contentTemplatesSettingsView")&&this.getChildView("contentTemplatesSettingsView").setModel(this.model),this.getChildView("saveView")&&this.getChildView("saveView").setModel(this.model)},setCommunityLogo(e){this.model.action("setlogo",{data:e,onComplete:function(){const t={};this.model.changedAttributes().preview_fingerprint||(t.preview_fingerprint=i.getCheckSum(i.getUUID())),t.logo_media_id=e.media_id||null,t.update=w.getCurrentDate(),this.model.set(t),this.dispatchEvent("communityLogoSaved"),this.showEditLogoView(),this.alert("success",n.Yourlogohasbeenset)}.bind(this)})},onCommunitySettingsSaved(){this.getChildView("featureView").refresh()},enableSave(){const e=this.getChildView("saveView");e&&e.dispatchEvent("enableSave")},disableSave(){const e=this.getChildView("saveView");e&&e.dispatchEvent("disableSave")},_getCommunityTagsView(){const{model:e}=this;let t=this.getChildView("communityTagsView");return t&&t.model.get("mid")===e.get("mid")||(t=this.addChildView("communityTagsView",{Class:h,className:"community-tags-settings feature-section col-xs-12 col-sm-12",model:e,forceCreation:!0})),t},_createContent(){const{model:e}=this;if(e)return this.getChildView("logoEditView")&&this.getChildView("logoEditView").model!==this.model&&(this.getChildView("logoEditView").destroy(),this._createLogoEditView()),{class:"settings-view section",styles:{height:"100%"},html:[{class:"settings-body-wrapper",styles:{height:"calc(100% - 60px)"},html:{class:"settings-body-int-wrapper",styles:{height:"100%"},html:{class:"settings-body",html:[this.getChildView("logoEditView"),this.addChildView("description",{Class:_,className:"description-settings section col-xs-12 col-sm-12",model:e}),this.addChildView("ownerView",{collection:e.getPossibleMainOwners(),Class:S,className:"main-owner-settings section col-xs-12 col-sm-12",modelName:e.getModelName(),asAdmin:this.getOption("asAdmin")}),this.addChildView("visibilityView",{className:"visibility-settings section",Class:l,model:e}),this.getChildView("featureView"),this.getChildView("contentTemplatesSettingsView"),this.model.get("ideation_is_enabled")?this.getChildView("statusAdminContainerView"):"",g.areCommunityTagsAvailable()?this._getCommunityTagsView():void 0]}}},{class:"settings-footer",html:[this.getChildView("saveView")]}]}}})});