var IndependentServiceBase="DS/DocumentManagement/IndependentServiceBase";define("DS/ImageManagement/ImageManagement",["UWA/Core",IndependentServiceBase,"DS/Foundation/FoundationAjax"],function(e,t,n){"use strict";return require(t),new(t.extend({SERVICE_ROOT_URL:"/resources/v1/modeler/images/",deleteImage:function(){return this._deleteRootObject.apply(this,arguments)},disconnectImage:function(t,a,i){var r=this,s=e.clone(i||{},!1);s.requestType="delete";var c=this._prepareService(this.disconnectImage.bind(this,t,a,i),s);if(c)return c;var o={id:a,updateAction:"NONE",relateddata:{parents:[{id:t}]}};return n.ajaxRequest({url:this.SERVICE_ROOT_URL,type:"delete",dataType:"json",data:JSON.stringify({csrf:this.getCsrf(s.tenantUrl),data:[o]}),callback:function(t){t&&t.csrf&&r.setCsrf(t.csrf,s.tenantUrl),t&&t.success&&e.is(i.onComplete,"function")?i.onComplete(t,i):e.is(i.onFailure,"function")&&i.onFailure(t)},headers:{"content-type":"application/json"}})},getImages:function(){this._getObjects.apply(this,arguments)},createImage:function(t,a){var i,r=e.clone(t,!1);if(r.fileName=r.fileName||r.primaryImage,r&&r.file){var s=e.clone(a||{},!1),c=this;s.csrf||(s.csrf="notNeeded");var o=this.SERVICE_ROOT_URL+"CheckinTicket";this._prepareService(void 0,s);var d={csrf:this.getCsrf(s.tenantUrl)};s.fileInfo=r;var l={url:o,type:"put",dataType:"json",data:JSON.stringify(d),callback:function(e){c._handleTicket(e,s)},headers:{"content-type":"application/json"}};i=n.ajaxRequest(l)}return i},_handleFCSReceipt:function(t,a){var i,r=this,s=a.fileInfo;if(s&&s.file){var c=s&&s.tempId,o=s&&s.parentId,d={tempId:c,dataelements:{fcsReceipt:t}};o&&(d.relateddata={parents:[{id:o}]});var l={csrf:r.getCsrf(a&&a.tenantUrl),data:[d]};i=n.ajaxRequest({url:this.SERVICE_ROOT_URL,type:"post",dataType:"json",data:JSON.stringify(l),callback:function(t){t&&t.csrf&&r.setCsrf(t.csrf,a&&a.tenantUrl),t&&t.success&&e.is(a.onComplete,"function")?a.onComplete(t,a):e.is(a.onFailure,"function")&&a.onFailure(t)},headers:{"content-type":"application/json"}})}return i}}))});