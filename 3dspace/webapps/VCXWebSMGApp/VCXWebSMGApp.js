define("DS/VCXWebSMGApp/VCXSmgDragDropManager",["DS/VCXWebComposer/VCXDragDropManager","DS/VCXWebInteropSMG/VCXSmgLoader","DS/VCXWebComposer/VCXExperienceLoader"],function(e,t,n){"use strict";return e.extend({dropCB:function(e,a,r){var i=this._experienceBase,o=i.getManager("VCXContextManager");if(e&&void 0!==widget.onRefresh)return console.log(e),this.loadDroppedFromCollabSpace(r).then(()=>{console.log("Load drop done.")}).catch(e=>{console.log("Load drop failed.")});var s=r.dataTransfer.files,g=!1;if(s.length){g=!0;for(let e=0;e<s.length;e++){let t=s[e];if(void 0!==t){t.name;t.type||(g=!1)}}}if(s.length>0){var p=o.CheckInputFile(!1);if(!g&&!p.supported){var d={level:"warning",title:"Loading",subtitle:p.message,sticky:!0};return i.getManager("VCXNotificationManager").addNotification(d),void i.getManager("VCXGUIManager").getGettingStartedUI().dropZoneOFF()}}var C="",c=null,l={};if(1===s.length&&"record"===i.odt){var u=s[0],M=i.getManager("VCXGUIManager").getGettingStartedUI();return i.getManager("VCXAPIManager").OpenModel(u,()=>{M.endLoadingExperience()})}i.getManager("VCXGUIManager").RemoveDropZone();for(var m=0;m<s.length;m++){if(void 0!==(u=s[m])){var h=u.name;if(void 0!==h){var V=h.slice(h.lastIndexOf(".")+1);if(V=V.toLowerCase(),!(p=o.CheckInputExtension(V)).supported){i.getManager("VCXNotificationManager").addNotification({level:"warning",title:"Action not supported",message:p.message});continue}if("smgxml"===V)u;else if("smg"===V||"smgs"===V)C=u;else{if("smggeom"!==V)return this._parent(e,a,r);l[u.name]=u,c=u}}}}var f=this.getProgressBar(),X=o.IsLocalMode();M=i.getManager("VCXGUIManager").getGettingStartedUI();if(C){var S=o.getIfStanAlonePlayerIsInDevMode();if(X||S)if(i&&i.webApplication)i.webApplication.requestNewExperienceBaseAsync().then(e=>{M.startLoadingExperience(),"record"===e.odt&&e.getManager("VCXODTManager").SetModelSMG(C);var n=new t;n._progressBar=f,n.Load(e,o.getMainViewer(),C,()=>{M.endLoadingExperience()})})}else{if(!c)return f.off(),this._parent(e,a,r);"record"===i.odt&&i.getManager("VCXODTManager").SetModelForZip(c),(new n).Load({experienceBase:i,mapAssets:l,jsonFile:"",endCB:()=>{f.off(),M&&M.endLoadingExperience()}})}}})}),define("DS/VCXWebSMGApp/VCXSmgExperience",["DS/VCXWebComposer/VCXExperience","DS/CoreEvents/Events","DS/VCXWebKernelCommands/VCXCmdGoToScenario","DS/VCXWebKernelCommands/VCXCmdChangeComponent","DS/VCXWebKernelCommands/VCXCmdChangeSequence","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebKernelCommands/VCXCmdChangePropertiesAutokey","DS/VCXWebKernelTools/VCXLogServices"],function(e,t,n,a,r,i,o,s,g,p){"use strict";var d=e.extend({OnEndLoading:function(e,a){console.log("VCXSmgExperience::OnEndLoading begin");var d=e;if(0===this._experienceBase.ComponentsMap.GetComponentFromType("CXPCameraActor_Spec").length){var C=this._experienceBase.Factory.BuildComponent("CXPCameraActor_Spec");C.SetID("CameraActorId"),this._experienceBase.ComponentsMap.AddComponent(C)}else d=!1;if(0===this._experienceBase.ComponentsMap.GetComponentFromType("VCXViewport_Spec").length){var c=this._experienceBase.Factory.BuildComponent("VCXViewport_Spec");c.SetID("ViewportActorId"),this._experienceBase.ComponentsMap.AddComponent(c)}if(0===this._experienceBase.ComponentsMap.GetComponentFromType("VCXComponentGround").length){var l=this._experienceBase.Factory.BuildComponent("VCXComponentGround");l.SetID("GroundActorId"),this._experienceBase.ComponentsMap.AddComponent(l)}if(e&&a)for(var u in a)if(a.hasOwnProperty(u)){var M=a[u];if("products"===u)for(var m=0;m<M.length;m++){var h=M[m],V=h.QueryInterface("W3AISGNodeHolder"),f=V.getSGNode(),X=V.getPathElement(),S=h.QueryInterface("VCXIModelNavigable");this._experienceBase.BuildComponentsFromNodeEXT(f,X,S,{attributeToUse:"productType",componentTypeForRootNode:"VCXComponentOccurrenceComposer",Instance3D:"VCXComponentOccurrenceComposer",InstanceRep:"VCXComponentMesh",defaultType:null}),t.publish({event:"VCX_ADD_ASSET",data:h})}}d&&(this._experienceBase.getManager("VCXGUIManager").InitGUI(),this._experienceBase.getManager("VCXExperience").InitImagePanels()),this._experienceBase.getManager("VCXGUIManager").RefreshGUI(),this._experienceBase.getManager("VCXPaperManager").updatePaper({propagateEvent:!0}),this.EndLoadingDressups(),this.EndLoadingViewpoints();var _=!1,x="",B=this._experienceBase.getManager("VCXScenarioManager").QueryInterface("VCXIModifiable");return UWA.Promise.resolve().then(function(){if(d){var e=this._experienceBase.Factory.BuildComponent("VCXScenarioSequence");e.SetName("Sequence 1");var t=new r(this._experienceBase.getManager("VCXSequenceManager"),this._experienceBase.getManager("VCXCommandManager"),this._experienceBase.ComponentsMap);t.PushSequence(e),this._experienceBase.getManager("VCXCommandManager").Do(t);return this.CreateNewScenario(!0).then(function(e){return x=e.GetID()}.bind(this))}if(p.memoryLog("RestoreNeutralProperties",!0),this._experienceBase.getManager("VCXScenarioManager").RestoreNeutralProperties(),p.memoryLog("RestoreNeutralProperties",!1),x=B.GetProperty("ScenarioManager.startScenarioId").GetPropertyValue().GetValue())_=!0;else{var n=this._experienceBase.getManager("VCXSequenceManager"),a=n.GetListSequences();if(x=a[0].GetListScenariosId()[0],1===this.GetViewMode()){var i=n.GetListSequencesFromType(0);if(i.length>1){var o=i[1];"Views"!==o.GetName()&&console.warn("Unexpected sequence tag"),o.GetListScenariosId().length&&(x=o.GetListScenariosId()[0])}}}return x}.bind(this)).then(function(e){if(!_){var a=new s(e),r=new i(new o("ScenarioManager.startScenarioId",2),a),d=new g(this._experienceBase.getManager("VCXScenarioManager"),this._experienceBase.getManager("VCXCommandManager"),!0);d.ChangeProperty(B,r),this._experienceBase.getManager("VCXCommandManager").Do(d)}p.memoryLog("GoToScenario",!0);var C=new n(this._experienceBase.getManager("VCXScenarioManager"),this._experienceBase.getManager("VCXCommandManager"));C.GoToScenario(e),this._experienceBase.getManager("VCXCommandManager").Do(C),p.memoryLog("GoToScenario",!1),p.memoryLog("VCXGUIManager setUpTrees",!0),this._experienceBase.getManager("VCXGUIManager").setUpTrees(),p.memoryLog("VCXGUIManager setUpTrees",!1);var c=!0===this._experienceBase.getManager("VCXContextManager").getExperienceInConnectedPlayer(),l=this._experienceBase.getManager("VCXContextManager").getPlayerMode();if(c){var u=this;setTimeout(function(){u._experienceBase.getManager("VCXAPIManager").HasAnimation("AnimationSmgID")&&u._experienceBase.getManager("VCXAPIManager").PlayAnimation("AnimationSmgID")},2e3)}else l||this._experienceBase.getManager("VCXScenarioManager").SetAutoKey(!0);if(console.log("VCXSmgExperience::OnEndLoading end"),console.log(" VCXStatNb3DNodes = "+this._statNb3DNodes),setTimeout(function(){document.querySelector("div.wux-windows-immersive-frame").dispatchEvent(new Event("resize"))},500),document.waitConditionModel){require(["DS/WebRecordEnabler/Adapter"],function(e){e.TraceManager.debug("REMOVE document.waitConditionModel"),e.WaitManager.removeWaitCondition(document.waitConditionModel),document.waitConditionModel=null})}t.publish({event:"VCX_END_LOADING_DONE"})}.bind(this))},addApplicationManagers:function(){var e=this._experienceBase.getManager("VCXContextManager").getCityMode(),t=this._experienceBase.getManager("VCXContextManager").getPlayerMode(),n=this._experienceBase.getManager("VCXContextManager").getProdHighMode(),r=this._experienceBase.getManager("VCXContextManager").getExperienceIn3DPlay(),i=this._experienceBase.getManager("VCXContextManager").getExperienceInConnectedPlayer(),o=[];(this._addManager("VCXNotificationManager",1,this._experienceBase._ManagerSet,o),this._addManager("VCXGUIManager",1,this._experienceBase._ManagerSet,o,6),this._addManager("VCXSelectionManager",1,this._experienceBase._ManagerSet,o),this._addManager("VCXSelectManager",2,this._experienceBase._ManagerSet,o),this._addManager("VCXMultiUserInputManager",1,this._experienceBase._ManagerSet,o),this._addManager("VCXMaterialManager",1,this._experienceBase._ManagerSet,o),this._addManager("VCXPaperManager",1,this._experienceBase._ManagerSet,o),this._addManager("VCXDressupManager",1,this._experienceBase._ManagerSet,o),this._addManager("VCXImageManager",1,this._experienceBase._ManagerSet,o),this._addManager("VCXHyperlinkManager",1,this._experienceBase._ManagerSet,o),this._addManager("VCXStylesManager",1,this._experienceBase._ManagerSet,o),this._experienceBase.getManager("VCXContextManager").isSupported("VCXIV")&&this._addManager("VCXIVManager",1,this._experienceBase._ManagerSet,o),this._addManager("VCXVisuManager",1,this._experienceBase._ManagerSet,o),this._addManager("VCXNLSManager",1,this._experienceBase._ManagerSet,o),this._addManager("VCXAPIManager",1,this._experienceBase._ManagerSet,o),this._addManager("VCXMarkerManager",1,this._experienceBase._ManagerSet,o),this._addManager("VCXDRMManager",1,this._ManagerSet,o),this._addManager("VCXPulseManager",1,this._experienceBase._ManagerSet,o).SetPreviewMode(this.GetPreviewMode()),this._addManager("VCXManipulatorManager",1,this._experienceBase._ManagerSet,o),t||n)&&(this._addManager("VCXSectionManager",1,this._experienceBase._ManagerSet,o),this._addManager("VCXRobotAdapter",1,this._experienceBase._ManagerSet,o),this._addManager("VCXComponentBomManager",1,this._experienceBase._ManagerSet,o),this._addManager("VCXVolatileGhostingManager",1,this._experienceBase._ManagerSet,o).setKeepGhostCommand(!0),this._addManager("VCXQueryEngine",1,this._experienceBase._ManagerSet,o),this._addManager("VCXHotspotManager",1,this._experienceBase._ManagerSet,o),this._addManager("VCXSelectionSetManager",1,this._experienceBase._ManagerSet,o),this._experienceBase.getManager("VCXContextManager").setSupported("PartZoom"));this._addManager("VCXUserInputControllerManager",1,this._experienceBase._ManagerSet,o),!i&&r&&this._addManager("VCXComposerAPIManager",1,this._experienceBase._ManagerSet,o),(n||e)&&(this._addManager("VCXCanonicsManager",1,this._experienceBase._ManagerSet,o),(void 0!==this._experienceBase.getManager("VCXContextManager").getUrlVars().debug||this._experienceBase.odt)&&(this._experienceBase.getManager("VCXContextManager").setSupported("Section"),this._experienceBase.getManager("VCXContextManager").setSupported("Paths")));var s=new a(this._experienceBase.getManager("VCXCommandManager"),this._experienceBase.ComponentsMap);return s.AddComponents(o),this._experienceBase.getManager("VCXCommandManager").Do(s),o}});return Object.defineProperty(d.prototype,"componentType",{enumerable:!0,get:function(){return"VCXExperience"}}),d}),define("DS/VCXWebSMGApp/VCXComponentBomManager",["UWA/Class","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueBoolean","DS/VCXWebKernelCommands/VCXCmdChangePropertiesAutokey","DS/VCXWebVisibility/VCXIVisibility","DS/VCXWebModifiables/VCXModelChangeListener"],function(e,t,n,a,r,i,o,s){"use strict";var g=e.extend({init:function(){},postUpdate:function(e){this.filterHasChanged=!1},GetColumn:function(e){var t=this.QueryInterface("VCXIModifiable");if(t){var n=t.GetProperty("ColumnTreeList.ColumnList").GetPropertyValue();if(e>=n._value.length)return;return n.GetValueAtIndex(e)}},GetColumnName:function(e){var t=this.GetColumn(e);return void 0===t?void 0:t.GetValueAtIndex(0)},GetColumnWidth:function(e){var t=this.GetColumn(e);return void 0===t?void 0:t.GetValueAtIndex(1)},GetColumnCommonRoot:function(e){var t=this.GetColumn(e);return void 0===t?void 0:t.GetValueAtIndex(2)},GetColumnLabel:function(e){var t=this.GetColumn(e);return void 0===t?void 0:t.GetValueAtIndex(3)},GetPropertyValueAt:function(e,t){var n=this.GetColumn(e);return void 0===n?void 0:n.GetValueAtIndex(t)},GetPropertyValueIdentifierAt:function(e,t){var n=void 0;switch(t){case 0:n="ColumnTree.Name";break;case 1:n="ColumnTree.Width";break;case 2:n="ColumnTree.CommonRoot";break;case 3:n="ColumnTree.Label"}return n},GetColumnNumber:function(){var e=this.QueryInterface("VCXIModifiable");return e?e.GetProperty("ColumnTreeList.ColumnList").GetPropertyValue()._value.length:0},SetSortOption:function(e){var o=this.QueryInterface("VCXIModifiable");if(o){var s=new a;s.SetValue(e.propertyName);var g=new t(new n("BOM.Sort.PropertyName",0),s),p=new i(this._experienceBase.getManager("VCXScenarioManager"),this._experienceBase.getManager("VCXCommandManager"),!0);p.ChangeProperty(o,g),this._experienceBase.getManager("VCXCommandManager").Push(p),(s=new r).SetValue(e.ascendant),g=new t(new n("BOM.Sort.Ascendant",0),s),(p=new i(this._experienceBase.getManager("VCXScenarioManager"),this._experienceBase.getManager("VCXCommandManager"),!0)).ChangeProperty(o,g),this._experienceBase.getManager("VCXCommandManager").Push(p)}},GetSortOption:function(){var e=this.QueryInterface("VCXIModifiable");if(e){var t=e.GetProperty("BOM.Sort.Ascendant"),n=t.GetPropertyValue().Value;return{propertyName:(t=e.GetProperty("BOM.Sort.PropertyName")).GetPropertyValue().Value,ascendant:n}}return 0},GetColumnPropertyValuesNumber:function(){return 4},GetBOMId:function(e){for(var t=this.GetBOMContent(!1),n=e.GetObject().QueryInterface("W3AISGNodeHolder").getPathElement().getLastElement(),a=1;;a++){if(!t[a])return a;if(t[a].element===n)return a}},GetBOMContent:function(e){for(var t=!1,n=[],a=this._experienceBase.getManager("VCXDressupManager").getDressupsFromGroup("Callouts"),r=0;r<a.length;r++){var i=a[r];if(i){var s=i.QueryInterface("VCXIVisibility");if(s&&s.GetVisibility()!==o.EVisState.Hidden){var g=i.QueryInterface("VCXIModifiable");if(g)for(var p=g.GetAttachedOccurences(),d=0;d<p.length;d++){if(l=p[d])if(u=l.QueryInterface("VCXIModifiable"))(M=u.GetProperty("Actor.BomId"))&&(m=M.GetPropertyValue().Value)&&(t=!0,n[m]||(n[m]={},n[m].calloutComponents=[],n[m].itemComponents=[]),n[m].calloutComponents.push(i),n[m].itemComponents.indexOf(l)<0&&n[m].itemComponents.push(l),n[m].element=l.QueryInterface("W3AISGNodeHolder").getPathElement().getLastElement())}}}}t||(e=!1);for(var C=this._experienceBase.ComponentsMap.GetComponentFromType("VCXWebComponentOccurrence"),c=0;c<C.length;c++){var l,u,M,m;if(l=C[c])if(u=l.QueryInterface("VCXIModifiable"))if(M=u.GetProperty("Actor.BomId"))(m=M.GetPropertyValue().Value)&&(e||n[m]||(n[m]={},n[m].itemComponents=[]),n[m]&&n[m].itemComponents.indexOf(l)<0&&(n[m].itemComponents.push(l),n[m].element=l.QueryInterface("W3AISGNodeHolder").getPathElement().getLastElement()))}return n}});return Object.defineProperty(g.prototype,"filterHasChanged",{enumerable:!0,get:function(){return this._filterHasChanged},set:function(e){this._filterHasChanged=e}}),Object.defineProperty(g.prototype,"ListHasChanged",{enumerable:!0,get:function(){var e=!1,t=this._experienceBase.getManager("VCXModelChangeListener");return t&&(e|=t.hasChanged(s.FChangeFlag.BomID),e|=t.hasChanged(s.FChangeFlag.DressupVisibility)),e|=this.filterHasChanged}}),Object.defineProperty(g.prototype,"componentType",{enumerable:!0,get:function(){return"VCXComponentBomManager"}}),g}),define("DS/VCXWebSMGApp/VCXBomManagerModifiable",["DS/VCXWebModifiables/VCXModifiable","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXPropertyValueBoolean","DS/VCXWebProperties/VCXPropertyValueInt","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueMap"],function(e,t,n,a,r,i,o,s){"use strict";return e.extend({init:function(e){this._Properties=[]},BuildProp:function(e,a,r){var i=new n(e,1),o=new a;o.Value=r,this._Properties[e]=new t(i,o),this.SetProperty(e,o)},BuildColumn:function(e,t,n,a){var r=new s,g=new o;return g.SetValue(e),r.SetValueAtIndex(0,g),(g=new i).SetValue(t),r.SetValueAtIndex(1,g),(g=new i).SetValue(n),r.SetValueAtIndex(2,g),(g=new o).SetValue(a),r.SetValueAtIndex(3,g),r},Build:function(){this._parent(),this.BuildProp("BOM.Filter",i,0),this.BuildProp("BOM.Sort.Ascendant",r,!0),this.BuildProp("BOM.Sort.PropertyName",o,"Bom.Description");var e=new s;e.SetValueAtIndex(0,this.BuildColumn("Bom.Description",100,0,"")),e.SetValueAtIndex(1,this.BuildColumn("Actor.BomId",50,0,"")),e.SetValueAtIndex(2,this.BuildColumn("Bom.Quantity",40,0,""));var a=new n("ColumnTreeList.ColumnList",1);this._Properties["ColumnTreeList.ColumnList"]=new t(a,e),this.SetProperty("ColumnTreeList.ColumnList",e)},SetProperty:function(e,a){var r=new n(e,0);this._Properties[e]=new t(r,a.Clone())},OnChangeProperty:function(e,t,n){if(n||(n={}),n.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;this.SetProperty(e,t)},OnChangePropertiesEnd:function(){this.GetObject().update&&this.GetObject().update()},GetProperty:function(e){var n=null;return void 0!==this._Properties[e]&&(n=new t(this._Properties[e].GetPropertyInfo(),this._Properties[e].GetPropertyValue().Clone())),n},GetProperties:function(e){var t=new a;for(var n in this._Properties)this._Properties.hasOwnProperty(n)&&t.AddOrModifyProperty(this.GetProperty(n));return t}})}),define("DS/VCXWebSMGApp/VCXOpenCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/Controls/Loader","DS/VCXWebComposer/VCXExperienceLoader","DS/VCXWebInteropSMG/VCXSmgLoader","DS/VCXWebInteropSMG/VCXSmgXmlLoader"],function(e,t,n,a,r,i){"use strict";return t.extend({init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!0})},beginExecute:function(){},execute:function(){var t=this,n=this.getFrameWindow().getUIFrame();if(null===document.getElementById("VCXOpenFileHiddenButton")){var a=new e.Element("input",{name:"Open",id:"VCXOpenFileHiddenButton",styles:{position:"absolute",left:"-99999px"},type:"file",multiple:"multiple",accept:".json,.3dxml,.smgxml,.smg,.smggeom,.urb,.ctxp,.ctps"}).inject(n);document.getElementById("VCXOpenFileHiddenButton").addEventListener("click",function(e){},!1),document.getElementById("VCXOpenFileHiddenButton").addEventListener("change",function(e){t.openFile(e),a.destroy()},!1)}var r,i=this;(r=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),!document.getElementById("VCXOpenFileHiddenButton").dispatchEvent(r)&&console.log("VCXOpenFileHiddenButton : A handler called preventDefault"),i.end(),this.onResume(function(){}),this.onPause(function(){})},openFile:function(t,o){for(var s="",g="",p="",d="",C=null,c={},l="",u=!1,M=t.target,m=0;m<M.files.length;m++){var h=M.files[m];if(void 0!==h){var V=h.name;if(void 0!==V){var f=V.slice(V.lastIndexOf(".")+1);"json"===(f=f.toLowerCase())||"ctps"===f?s=h:"3dxml"===f?(g=window.URL.createObjectURL(h),c[h.name]=g):"smgxml"===f?p=h:"smg"===f||"smgs"===f?d=h:"smggeom"===f?(c[h.name]=h,C=h):"urb"!==f&&"ctxp"!==f||(l=h,c[h.name]=l,u=!0)}}}var X,S=document.getElementsByClassName("wux-windows-docking-element-free-zone wux-docking-element-bottom")[0],_=new n({text:"Preparing...",showButtonFlag:!1});(_.inject(S),_.getContent().setStyles({opacity:"1",position:"absolute",bottom:"calc(50% - 100px)",left:"calc(50% - 50px)"}),_.on("0%"),void 0===o)&&(o=this.getFrameWindow()._experienceBase);if(o&&o.webApplication)return o.webApplication.requestNewExperienceBaseAsync().then(function(t){if(0!==Object.keys(c).length)X=a;else if(p)X=i;else{if(!d)return e.Promise.reject(new Error("Not supported file"));X=r}var n=t.getManager("VCXGUIManager").getGettingStartedUI();n.startLoadingExperience(),WUX.setFullscreen();var o=t.getManager("VCXContextManager").getMainViewer();if(0!==Object.keys(c).length)"record"===t.odt&&(""!==g?t.getManager("VCXODTManager").SetModelForZip(g):C&&t.getManager("VCXODTManager").SetModelForZip(C)),(new X).Load({experienceBase:t,mapAssets:c,jsonFile:s,urb:u,endCB:function(){_.off(),n.endLoadingExperience()}});else if(p){(new X).Load(t,o,p,!0,void 0)}else if(d){var l=new X;l._progressBar=_,"record"===t.odt&&t.getManager("VCXODTManager").SetModelForZip(d),l.Load(t,o,d,function(){_.off(),n.endLoadingExperience()})}else _.off(),n.endLoadingExperience()})},endExecute:function(){}})});