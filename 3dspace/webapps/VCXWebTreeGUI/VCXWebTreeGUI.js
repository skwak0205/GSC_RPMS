define("DS/VCXWebTreeGUI/VCXWebTreeNodeView",["DS/Tree/TreeNodeView","DS/Core/PointerEvents"],function(e,t){"use strict";return e.extend({init:function(e){this._parent(e)},updateInternalParameters:function(){this._parent();var e=this.getCellInfos(),t=e.cellView.getContent();if(!e.isHeader){if(e.nodeModel.options.hasOwnProperty("isPreHighlighted")&&(1===e.nodeModel.options.isPreHighlighted?(t.hasClassName("vcxPreHighlighted")||t.addClassName("vcxPreHighlighted"),t.hasClassName("vcxPreHighlightedHidden")&&t.removeClassName("vcxPreHighlightedHidden")):2===e.nodeModel.options.isPreHighlighted?(t.hasClassName("vcxPreHighlightedHidden")||t.addClassName("vcxPreHighlightedHidden"),t.hasClassName("vcxPreHighlighted")&&t.removeClassName("vcxPreHighlighted")):(t.hasClassName("vcxPreHighlighted")&&t.removeClassName("vcxPreHighlighted"),t.hasClassName("vcxPreHighlightedHidden")&&t.removeClassName("vcxPreHighlightedHidden"))),e.nodeModel.options.hasOwnProperty("selectionSetRole")){1===e.nodeModel.options.selectionSetRole&&(t.hasClassName("vcxSelSet")||t.addClassName("vcxSelSet"),t.hasClassName("vcxSelSetActor")&&t.removeClassName("vcxSelSetActor")),2===e.nodeModel.options.selectionSetRole&&(t.hasClassName("vcxSelSetActor")||t.addClassName("vcxSelSetActor"),t.hasClassName("vcxSelSet")&&t.removeClassName("vcxSelSet"))}if(e.nodeModel.options.hasOwnProperty("hotspotRole")){1===e.nodeModel.options.hotspotRole&&(t.hasClassName("vcxHotspot")||t.addClassName("vcxHotspot"),t.hasClassName("vcxHotspotActor")&&t.removeClassName("vcxHotspotActor")),2===e.nodeModel.options.hotspotRole&&(t.hasClassName("vcxHotspotActor")||t.addClassName("vcxHotspotActor"),t.hasClassName("vcxHotspot")&&t.removeClassName("vcxHotspot"))}if(e.nodeModel.options.hasOwnProperty("visibilityState")){var n=e.nodeModel.options.visibilityState;"string"==typeof e.nodeModel.options.visibilityState&&t.setAttribute("sceneVisibility",n)}else t.hasAttribute("sceneVisibility")&&t.removeAttribute("sceneVisibility");if(e.nodeModel.options.hasOwnProperty("updateNewElementPastille")){var o=e.nodeModel.options.updateNewElementPastille;"string"==typeof e.nodeModel.options.updateNewElementPastille&&t.setAttribute("updateNewElementPastille",o)}else t.hasAttribute("updateNewElementPastille")&&t.removeAttribute("updateNewElementPastille")}},_observeEvents:function(){var e,n=this,o=0,i=300;this.elements.container.addEvent(t.POINTERUP,function(r){void 0!==e&&clearTimeout(e),e=setTimeout(function(){o=0},i),o++,1===r.which&&((1===o||t.isTouchEvent(r)&&0===r.detail)&&n.getGridEngine()._modelEvents.publish({event:"nodeclick",data:n.getCellInfos()}),2===o&&n.getGridEngine()._modelEvents.publish({event:"nodeDblClick",data:n.getCellInfos()}))});var r,s=0;function a(e){var t=null;if(e&&(e.changedTouches&&1===e.changedTouches.length||0===e.button)){var o=e.target;o&&o.classList.contains("nodeTouchZone")?t=o:o.children.length&&(o=o.children[0])&&o.classList.contains("nodeTouchZone")&&(t=o)}var a=n.getGridEngine().options.selection.canMultiSelect&&(e.ctrlKey||n.getGridEngine().isInMultiSelection()||t),l=n.getGridEngine().options.selection.canMultiSelect&&e.shiftKey&&n.getGridEngine().options.selection.enableListSelection;if(1===e.which&&!e.target.classList.contains("wux-layouts-treeview-expander")&&!function e(t,n){var o=t;return o?(" "+o.className+" ").replace(/[\n\t]/g," ").indexOf(" "+n+" ")>-1?o:e(o.parentNode,n):void 0}(e.target,"wux-controls-toggle")){var d=n.getCellInfos();void 0!==r&&clearTimeout(r),r=setTimeout(function(){s=0},i),s++;var c=n.getGridEngine(),h=c.getDocument();if(!1===d.isHeader&&!1===c.options.selection.cells){var u=d.nodeModel;if(1===s&&c.options.selection.nodes)if(c.options.selection.toggle)u.isSelected()?n.__unselectNode(u):n.__selectNode(u,!a);else if(u.getTreeDocument().getXSO().get().length>1&&!a&&!l&&!u.getTreeDocument().getXSO().isIn(u))n.__selectNode(u,!a);else if(c.getNodesXSO().get().length>1&&!a&&u.getTreeDocument().getXSO().isIn(u))c._modeIsListSel||n.__selectNode(u,!a);else if(l){var g,p=h.getXSO().get();g=0===p.length?h.getChildren()[0]:!0===c._getParent().options.enableActiveUI?c.getActiveNode()===p[p.length-1]?p[0]:c.getActiveNode():p[0];var m=u;console.warn("select from",g._getRowID(),"to",m._getRowID()),g._getRowID()<m._getRowID()?h.withTransactionUpdate(function(){h.getXSO().empty();for(var e=g._getRowID();e<=m._getRowID();e++){var t=c.getTreeNodeModelFromRowID(e);n.__selectNode(t,!1)}}):h.withTransactionUpdate(function(){h.getXSO().empty();for(var e=g._getRowID();e>=m._getRowID();e--){var t=c.getTreeNodeModelFromRowID(e);n.__selectNode(t,!1)}})}else u.isSelected()?a?(n._unselectOnPointerUp=!0,n.__unselectNode(u)):(n._unselectOnPointerUp=!1,0===u.getTreeDocument().getXSO().get().length&&n.__selectNode(u)):n.__selectNode(u,!a)}}}function l(e){if(e.stopPropagation(),"touchend"===e.type&&e.preventDefault(),n.getGridEngine()._giveFocus(),1===e.which||"touchend"===e.type){var t=n._cellModel.getCellContent();t.getChildren()&&"noExpandState"!==n._expandState&&"expandingState"!==n._expandState&&(t.isExpanded()&&"partiallyExpandedState"!==t._expandState?t.collapse():(n._setExpanderState("expandingState"),t.expand()))}}this.elements.container.addEvent("mousedown",a),this.elements.container.addEvent("touchstart",a),this.elements.expanderContainer.addEvent("mouseup",l),this.elements.expanderContainer.addEvent("touchend",l)}})}),define("DS/VCXWebTreeGUI/VCXITreeNode",["DS/WebComponentModeler/CATWebInterface"],function(e){"use strict";return e.singleton({interfaceName:"VCXITreeNode",required:{SetVisibility:function(){},GetVisibility:function(){},GetName:function(){},GetParent:function(){},GetChildren:function(){},SetNewTreeNodeModel:function(e,t){},UnsetTreeNodeModel:function(e,t){},GetTreeNodesModelsFromTree:function(e){},hasTreeNodeModels:function(e){},getTreeNodeComponentIcon:function(){}},optional:{}})}),define("DS/VCXWebTreeGUI/VCXWebTabFrameCtrl",["UWA/Class","UWA/Core","DS/VCXWebGUI/VCXTabPageFrame","i18n!DS/VCXWebTreeGUI/assets/nls/VCXWebTreeGUI","i18n!DS/VCXWebProducts/assets/nls/VCXWebProductAuthoringCommands"],function(e,t,n,o,i){"use strict";return e.extend({init:function(e){this._experienceBase=e,this._vcxGuiManager=this._experienceBase.getManager("VCXGUIManager")},createTabFrameAndSlidingViews:function(e){if(e&&e.sidePanelInfos&&e.slidingViewsTitles&&e.slidingViewsContainerIDs){this.panelCreationOptions=e,this.options={},this._vcxGuiManager.immersiveFrame&&(this.options.immersiveFrame=this._vcxGuiManager.immersiveFrame),this.options._uiLayer=this._vcxGuiManager._uiLayer,this.options.classBaseNameCSS=e.sidePanelInfos.classBaseNameCSS,this.options.appID=e.appID,this.options.sidePanel={title:e.sidePanelInfos.title,icon:e.sidePanelInfos.icon,side:e.sidePanelInfos.side,controller:this,usecallback:this.onresizePanel,currentDockArea:e.sidePanelInfos.dockArea},this.options.slidingViews={displayTabAtStart:e.slidingViewToDisplayAtStart,disableSlindingMenu:e.disableSlindingMenu,_vcxuiSequencesMaster:{}},this.options.slidingViews.views=[];for(var i=0;i<e.slidingViewsTitles.length;++i){var r=new t.Element("div",{id:e.slidingViewsContainerIDs[i]});this.options.slidingViews._vcxuiSequencesMaster[i+1]={},this.options.slidingViews._vcxuiSequencesMaster[i+1][e.slidingViewsTitles[i]]=r,this.options.slidingViews.views.push({title:e.slidingViewsTitles[i],content:{html:this.options.slidingViews._vcxuiSequencesMaster[1][e.slidingViewsTitles[i]]}})}this.options._experienceBase=this._experienceBase,this.options._i18n=o,this._tabPageFrame=new n(this.options),this.onCreateToolBarButtons(),this.updateToolbar();var s=this;this._onVisibleStateChange=function(e){s._tabPageFrame&&s._tabPageFrame.onResizeCB()},this._tabPageFrame._panelMaster.addEventListener("activate",this._onVisibleStateChange)}else console.warn("Unable to create tabFrame...")},unInitialize:function(){this._tabPageFrame._panelMaster.removeEventListener("activate",this._onVisibleStateChange),this.getFrame().unInitialize()},onresizePanel:function(e){e.updateToolbar()},getFrame:function(){return this._tabPageFrame},updateToolbar:function(){this.getFrame().getToolbar().updateToolbar()},onCreateToolBarButtons:function(){var e=this.getFrame().getToolbar(),t=this._vcxGuiManager._experienceBase.getManager("VCXExperience");if(t.updateLogData&&!0===t.updateLogData.showDialog&&e.addMainItemFixed("VCXShowUpdateViewCmd","","vcxToolbarButton wux-ui-3ds-update","VCXWebAuthoringCommands/VCXWebAuthoringCommands",i),this._selectLeavesFromSelectedNodes){var n=[];n[0]=this,n[1]=this._selectLeavesFromSelectedNodes,e.addMainItemFixed(n,"",["vcxToolbarButton","vcxTreeToolbarButtonSelectLeaves-1","vcxTreeToolbarButtonSelectLeaves-2"],"VCXWebTreeGUI/VCXWebTreeGUI",o,null,"VCXTreeToolbarSelectLeaves")}if(this._collapseAll){var r=[];r[0]=this,r[1]=this._collapseAll,e.addMainItemFixed(r,"",["vcxToolbarButton","vcxTreeToolbarButtonCollapseAll-1","vcxTreeToolbarButtonCollapseAll-2"],"VCXWebTreeGUI/VCXWebTreeGUI",o,null,"VCXTreeToolbarCollapseAll")}if(this._changeSelectionVisibility){var s=[];s[0]=this,s[1]=this._changeSelectionVisibility,e.addMainItemFixed(s,"",["vcxToolbarButton","wux-ui-3ds wux-ui-3ds-eye","wux-ui-3ds wux-ui-3ds-checkbox-on"],"VCXWebTreeGUI/VCXWebTreeGUI",o,null,"VCXTreeToolbarChgSelectionVis")}},_getCurrentViewTreeCtrl:function(){var e={Assembly:{1:this._vcxGuiManager._vcxWebAssemblyTreeCtrl,2:this._vcxGuiManager._vcxWebSelectionSetsTreeCtrl,3:this._vcxGuiManager._vcxWebHotspotsTreeCtrl},Design:{1:this._vcxGuiManager._vcxWebDressupTreeCtrl}},t=this.getFrame()&&this.getFrame().options.sidePanel.title;if(t){if(e[t]){var n=this.getFrame()._slidingViews.getCurrentViewID();return e[t][n]}return null}return null},_collapseAll:function(){var e=this._getCurrentViewTreeCtrl();if(e)if(e._expandUntilNVisibleNodes){e.tree.getManager()._numberOfVisibleNodesInDocument>5&&(e.tree.getDocument().collapseAll(),e._expandUntilNVisibleNodes(5))}else e.tree.getDocument().collapseAll();else console.warn("No tree found to collapse the nodes. Command aborted.")},_changeSelectionVisibility:function(){var e=this._getCurrentViewTreeCtrl();if(e){var t=e.tree.getDocument().getXSO().get();if(0!==t.length){for(var n,o=0;o<t.length;++o){var i=t[o],r=e._getTreeNodeExtensionFromTreeNodeModel(i);if(r){var s=r.GetVisibility();if(s===e.EVisibilityState.Indeterminate){e.EVisibilityState.Indeterminate;break}n=void 0===n||s===n?s:-1}}var a=n===e.EVisibilityState.Hidden?e.EVisibilityState.Visible:e.EVisibilityState.Hidden;e.tree.getDocument().withTransactionUpdate(function(){for(var n=a===e.EVisibilityState.Hidden?"hidden":"visible",o=0;o<t.length;++o){var i=t[o],r=e._getTreeNodeExtensionFromTreeNodeModel(i);r&&r.SetVisibility(a)&&(i.options.visibilityState=n)}}),e.tree.getManager().updateView()}}else console.warn("No tree found to change selection visibility. Command aborted.")}})}),define("DS/VCXWebTreeGUI/VCXWebDressupTabFrameCtrl",["DS/VCXWebTreeGUI/VCXWebTabFrameCtrl","DS/WebappsUtils/WebappsUtils","i18n!DS/VCXWebProducts/assets/nls/VCXWebProducts"],function(e,t,n){"use strict";return e.extend({init:function(e){this._parent(e);var t={sidePanelInfos:{classBaseNameCSS:"vcx-dressuptree-",title:"Design",icon:{iconName:"collection",fontIconFamily:WUXManagedFontIcons.Font3DS},side:"left",dockArea:WUXDockAreaEnum.LeftDockArea},slidingViewsTitles:["Design"],slidingViewsContainerIDs:["dressupTreeContainer"],slidingViewToDisplayAtStart:1,disableSlindingMenu:1};this.createTabFrameAndSlidingViews(t)},onCreateToolBarButtons:function(){this._parent(),this.getFrame().getToolbar().addMainItemFixed("VCXHideDressupsCmd","",["vcxToolbarButton","wux-ui-3ds wux-ui-3ds-eye-off",""],"VCXWebProducts/VCXWebProducts",n,null,"VCXTreeToolbarHideDressups")}})}),define("DS/VCXWebTreeGUI/VCXWebAssemblyTabFrameCtrl",["DS/VCXWebKernel/VCXCmdChangeSelection","DS/VCXWebTreeGUI/VCXWebTabFrameCtrl","DS/WebappsUtils/WebappsUtils","i18n!DS/VCXWebTreeGUI/assets/nls/VCXWebTreeGUI"],function(e,t,n,o){"use strict";return t.extend({init:function(e){this._parent(e);var t=1,n=e.getManager("VCXContextManager");n&&(n.getOpenSMG()||n.getOpenSMGXML())&&(t=0);var i={sidePanelInfos:{classBaseNameCSS:"vcx-assemblytree-",title:"Assembly",icon:{iconName:"3dpart",fontIconFamily:WUXManagedFontIcons.Font3DS},side:"left",dockArea:WUXDockAreaEnum.LeftDockArea},slidingViewsTitles:["Assembly","SelectionSets","Hotspots"],slidingViewsContainerIDs:["AssemblyContainer","SelectionSetsAssemblyContainer","HotspotsAssemblyContainer"],slidingViewToDisplayAtStart:1,disableSlindingMenu:t},r=this._experienceBase.getManager("VCXContextManager");r.getCityMode()&&(i.disableSlindingMenu=1,i.appID="CID"),i.slidingViewsTitles=[o[r.getCityMode()?"CIDAssembly.PanelTitle":"VCXAssembly.PanelTitle"],o.SelectionSets,o.Hotspots],this.createTabFrameAndSlidingViews(i)},_selectLeavesFromSelectedNodes:function(){var t=this._getCurrentViewTreeCtrl();if(t){for(var n=t.tree.getDocument().getSelectedNodes(),o=[],i=0;i<n.length;++i){var r=t._getTreeNodeExtensionFromTreeNodeModel(n[i]);r&&o.push(r)}for(var s=this._traverseForTreeNodeExtLeaves(o),a=[],l=0;l<s.length;++l){var d=s[l].GetObject();a.push(d)}var c=new e(this._experienceBase.getManager("VCXSelectionManager"));c.SetComponentsSelection(a),this._experienceBase.getManager("VCXCommandManager").Do(c)}else console.warn("No tree found to collapse the nodes. Command aborted.")},_traverseForTreeNodeExtLeaves:function(e){for(var t=0,n=[],o=[],i=0;i<e.length;++i){var r=e[i],s=r.GetChildren();if(0===s.length)n.push(r);else for(t=0;t<s.length;++t)o.push(s[t])}if(0!==o.length){var a=[];for(t=0;t<o.length;++t)a.push(o[t]);var l=this._traverseForTreeNodeExtLeaves(a);n=n.concat(l)}return n}})}),define("DS/VCXWebTreeGUI/VCXWebStylesTabFrameCtrl",["DS/VCXWebTreeGUI/VCXWebTabFrameCtrl","DS/WebappsUtils/WebappsUtils"],function(e,t){"use strict";return e.extend({init:function(e){this._parent(e);var n={sidePanelInfos:{classBaseNameCSS:"vcx-stylestree-",title:"Styles",icon:t.getWebappsAssetUrl("VCXWebTreeGUI","icons/32/I_VCX_Tree_Dressup_TabIcon.png"),side:"left",dockArea:WUXDockAreaEnum.LeftDockArea},slidingViewsTitles:["Styles"],slidingViewsContainerIDs:["stylesTreeContainer"],slidingViewToDisplayAtStart:1,disableSlindingMenu:1};this.createTabFrameAndSlidingViews(n)}})}),define("DS/VCXWebTreeGUI/VCXWebTreeCtrl",["UWA/Core","UWA/Class","UWA/Utils/Client","DS/Core/Core","DS/CoreEvents/Events","DS/Core/PointerEvents","DS/Tree/Tree","DS/Tree/TreeDocument","DS/Tree/TreeNodeView","DS/Tree/TreeNodeModel","DS/Utilities/Array","DS/VCXWebKernel/VCXCmdChangeSelection","DS/VCXWebModifiablesServices/VCXModifiablesAccess","DS/VCXWebModifiablesServices/VCXModifiablesServices","DS/VCXWebTreeGUI/VCXWebTreeNodeView"],function(e,t,n,o,i,r,s,a,l,d,c,h,u,g,p){"use strict";var m=t.extend({init:function(e){this._experienceBase=e,this._vcxGuiManager=e.getManager("VCXGUIManager"),this._multiSelBeforeForcing=null,this._eventTokens={},this._tabFrameCtrl=null,this._slidingViewIndex=-1,this._newSelection=null,this._newSelectionDoneWorkers=0},setTabFrameCtrl:function(e){this._tabFrameCtrl=e},getTabFrameCtrl:function(){return this._tabFrameCtrl},setSlidingViewIndex:function(e){this._slidingViewIndex=e},getSlidingViewIndex:function(){return this._slidingViewIndex},getTreeTitle:function(){},createTree:function(){var e=this,t={useAsyncPreExpand:!0,cellClass:p,shouldBeEditable:function(){return!1},shouldAcceptDrag:function(){return!1},shouldAcceptDrop:function(){return!1},onPreExpandCB:this._onPreExpandCB.bind(this),selection:{rowHeaders:!1,columnHeaders:!1,unselectAllOnEmptyArea:!0,enableListSelection:!0,toggle:!1,preSelection:!0},onCellClickCB:this._toggleEyeIconOnClick,onCellRequests:{visibilityIcon:this._onVisibilityIconRequest}},n=new a({useAsyncPreExpand:t.useAsyncPreExpand,shouldBeEditable:t.shouldBeEditable,shouldAcceptDrag:t.shouldAcceptDrag,shouldAcceptDrop:t.shouldAcceptDrop});"function"==typeof t.onPreExpandCB&&n.onPreExpand(t.onPreExpandCB);var l=[this._getTouchSelectionBarTreeColInfos(),this._getTreeMainColInfos(t),this._getVisIconColInfos(t)];this.tree=new s({treeDocument:n,height:"auto",defaultCellHeight:35,apiVersion:2,cellClass:t.cellClass,selection:t.selection,columns:l}),this.tree.getManager().onCellClick(t.onCellClickCB),this.tree.getContent().addClassName("composer-treeview-theme"),this.getTreeTitle()&&this.tree.getContent().addClassName("composer-"+this.getTreeTitle().replace(/\s+/g,"").toLowerCase()+"-treeview-theme"),this._setTreeRootsAndFirstNodes&&this._setTreeRootsAndFirstNodes(),this._setCustomEvtsSubscriptions&&this._setCustomEvtsSubscriptions(),this.tree.getDocument().getXSO().onEmpty(function(){if(e.tree.getDocument().prepareUpdate(),e._experienceBase.getManager("VCXSelectionManager").HasActors()){var t=new h(e._experienceBase.getManager("VCXSelectionManager"));t.SetSelection(),e._experienceBase.getManager("VCXCommandManager").Do(t)}e.tree.getDocument().pushUpdate()});var d=function(e){return e&&(e.changedTouches&&1===e.changedTouches.length||0===e.button)},g=null,m=function(t){if(d(t)){var n;n=t.changedTouches&&t.changedTouches[0]?{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY}:{x:t.clientX,y:t.clientY};var o,i=document.elementFromPoint(n.x,n.y);if(!e.tree.getContent().contains(i))return;for(o=i;o!==e.tree.getContent()&&!o.classList.contains("wux-datagrid-cell");)o=o.parentElement;if(!o)return;if(o!==e.tree.getContent()&&o.dsView){var r=o.dsView.getCellInfos();if(g.lastTreeCellDSViewTouched&&g.lastTreeCellDSViewTouched.getCellInfos().rowID!==r.rowID){var s=g.lastTreeCellDSViewTouched.getCellInfos(),a=s.view;g.xsoHasBeenEmptied||(e.tree.getDocument().withTransactionUpdate(function(){var t=e.tree.getManager().getTreeNodeModelFromRowID(s.rowID);e.tree.getDocument().unselectAll(),t.selectionChangeIsFromUI(),t.select()}),g.xsoHasBeenEmptied=!0);var l=g.initialPointerDownCoordinates.y<a.getBoundingClientRect().bottom&&a.getBoundingClientRect().bottom<=n.y||g.initialPointerDownCoordinates.y>a.getBoundingClientRect().top&&a.getBoundingClientRect().top>=n.y,c=s.rowID,h=r.rowID,u=g.firstTreeCellDSViewTouched.getCellInfos().rowID,p=0,m=null,C=h<c?-1:1;if(!l){var T=-1===C?Math.max(u,h):Math.min(u,h);for(p=c;C*(T-p)>0;p+=C)(m=e.tree.getManager().getTreeNodeModelFromRowID(p))&&(m.selectionChangeIsFromUI(),m&&m.unselect&&m.unselect())}for(p=u;C*(h-p)>=0;p+=C)(m=e.tree.getManager().getTreeNodeModelFromRowID(p))&&!m.isSelected()&&m.select&&(m.selectionChangeIsFromUI(),m.select())}g.lastTreeCellDSViewTouched=o.dsView}}},C=function t(){null!==e._multiSelBeforeForcing&&(e.tree.getManager().forceMultiSelection(e._multiSelBeforeForcing),e._multiSelBeforeForcing=null),g=null,e.tree.getDocument().pushUpdate(),document.body.removeEventListener(r.POINTERMOVE,m,!1),document.body.removeEventListener(r.POINTERUP,t,!1)};this.tree.getContent().addEventListener(r.POINTERDOWN,function(t){if(d(t)){var n;g={initialPointerDownCoordinates:null,firstTreeCellDSViewTouched:null,lastTreeCellDSViewTouched:null,xsoHasBeenEmptied:!1,multiSelBeforeForcing:null},n=t.changedTouches&&t.changedTouches[0]?{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY}:{x:t.clientX,y:t.clientY},g.initialPointerDownCoordinates=n;var o=t.target,i=null;if(o&&o.classList.contains("nodeTouchZone")?i=o:o.children.length&&(o=o.children[0])&&o.classList.contains("nodeTouchZone")&&(i=o),i&&("boolean"!=typeof e._multiSelBeforeForcing&&(e._multiSelBeforeForcing=e.tree.getManager()._modeIsMultiSel,e.tree.getManager().forceMultiSelection(!0)),e.tree.getDocument().prepareUpdate(),e.tree.getContent().contains(i))){for(var s=i;s!==e.tree.getContent()&&!s.classList.contains("wux-datagrid-cell");)s=s.parentElement;s!==e.tree.getContent()&&s.dsView&&(g.firstTreeCellDSViewTouched=s.dsView,document.body.addEventListener(r.POINTERMOVE,m,!1),document.body.addEventListener(r.POINTERUP,C,!1))}}},!1),this._eventTokens._evtSelectionEmptyToken=i.subscribe({event:"VCX_SELECTION_EMPTY"},function(){e.tree.getManager().unselectAll()}),this._eventTokens._evtPreHLEmptyToken=i.subscribe({event:"VCX_PREHIGHLIGHT_EMPTY"},function(){var t=e.tree.getDocument().getAllDescendants();e.tree.getDocument().getPXSO().empty(),c.optimizedForEach(t,function(t){e._switchTreeNodePreHighlight(t,!1)})}),this._eventTokens._evtPreHLRemoveToken=i.subscribe({event:"VCX_PREHIGHLIGHT_REMOVE"},function(t){if(e.isThisTreeInView()&&t&&Array.isArray(t))for(var n=0;n<t.length;++n){var o=t[n]&&t[n].pathElement;o&&e._removePreHLFromPathElement(o)}}),this._eventTokens._evtPreHLAddToken=i.subscribe({event:"VCX_PREHIGHLIGHT_ADD"},function(t){if(e.isThisTreeInView()&&t&&Array.isArray(t))for(var n=0;n<t.length;++n){var o=t[n]&&t[n].pathElement;o&&e._addPreHLFromPathElement(o)}});var T=function(t,n){var i=t&&e._getTreeNodeExtensionFromTreeNodeModel(t),r=i&&i.QueryInterface("W3AISGNodeHolder"),s=r&&r.getPathElement();if(s){var a={pathElement:s},l=o.Selection.PSOManager.isIn(a);if(1===s.getLength()&&s.getLastElement()===e._experienceBase.getManager("VCXContextManager").getRootNode());else if(!l&&n){for(var d=o.Selection.PSOManager.get(),c=!1,h=0;h<d.length;++h){var g=d[h];if(u.BuildCleanedPathElement(g.pathElement).isEqual(s)){c=!0;break}}c||o.Selection.PSOManager.add(a)}else l&&!n&&o.Selection.PSOManager.remove(a)}e.tree.getManager().updateView()};return this.tree.getDocument().getPXSO().onAdd(function(e){T(e,!0)}),this.tree.getDocument().getPXSO().onRemove(function(e){T(e,!1)}),this._eventTokens._evtOnChgSelAddToken=i.subscribe({event:"VCX_SELECTION_COMPONENTSLIST_ADD"},function(t){e._onChangeSelectionCB(t,!0)}),this._eventTokens._evtOnChangeSelRemoveToken=i.subscribe({event:"VCX_SELECTION_COMPONENTSLIST_REMOVE"},function(t){e._onChangeSelectionCB(t,!1)}),this._eventTokens._evtOnChangeSelRemoveFromTreeToken=i.subscribe({event:"VCX_SELECTION_COMPONENTSLIST_REMOVE_FROM_TREE_ASSY_SEL"},function(t){e._onChangeSelectionCB(t,!1)}),this._eventTokens._evtOnChangePropertiesToken=i.subscribe({event:"VCX_PROPERTIES_CHANGED"},function(t){if(t&&t.GetListModifiables){var n=[];t.GetListModifiables(n);for(var o=0;o<n.length;++o){var i=n[o],r=i&&t.GetPropertySet(i),s=r&&r.GetProperty("Actor.Name");if(s){var a=s.GetPropertyValue().GetValue();e._updateTreeNodeNameFromHashing(i,a)}}}}),this.tree},unInitialize:function(){for(var e in this._eventTokens)this._eventTokens.hasOwnProperty(e)&&this._eventTokens[e]&&i.unsubscribe(this._eventTokens[e]);if(this.tree){var t=this.tree.getDocument();t._cleanBindingOnDocument?t._cleanBindingOnDocument():t._cleanBindings&&t._cleanBindings();var n=t.getRoots();this._deleteChildrenAndSelves(n),t.empty();var o=this.tree.getManager();o.unloadDocument(),this.tree.destroy(),t.options=t.defaultOptions,o.options=o.defaultOptions,this.tree.options=this.tree.defaultOptions,this.tree=null}this._experienceBase=null,this._vcxGuiManager=null,this._eventTokens={},this._tabFrameCtrl=null,this._newSelection=null,this._selectStack=null},unstackSelect(){if(this._selectStack){var e=this;this.tree.getDocument().withTransactionUpdate(function(t){for(var n in e._selectStack)void 0!==e._selectStack[n].preSelect&&(e._selectStack[n].preSelect?e._selectStack[n].TreeModel.preSelect():e._selectStack[n].TreeModel.unPreSelect()),void 0!==e._selectStack[n].select&&(e._selectStack[n].select?e._selectStack[n].TreeModel.select():e._selectStack[n].TreeModel.unselect());e._selectStack=null})}},_deleteChildrenAndSelves:function(e){for(var t=0;t<e.length;++t){var n=e[t],o=n.getChildren();o&&o.length>0&&(this._deleteChildrenAndSelves(o),n.removeChildren()),n.options=n.defaultOptions}},isThisTreeInView:function(){var e=this.getTabFrameCtrl(),t=e&&e._getCurrentViewTreeCtrl();return!!t&&t===this},expandTreeWithComponent:function(e){var t=this;if(e){var n=e.QueryInterface("VCXITreeNode");n?this.tree.getDocument().withTransactionUpdate(function(){t._revExpandFromTreeNodeExt(n)}):console.log("Couldn't fetch treeNode extension")}else console.log("A component is needed in argument of this method..")},selectTreeNodesFromComponentList:function(e){var t=this;this.tree.getDocument().withTransactionUpdate(function(){for(var n=0;n<e.length;++n){var o=e[n];t.expandTreeWithComponent(o)}});for(var n=[],o=0;o<e.length;++o)for(var i=e[o].QueryInterface("VCXITreeNode").GetTreeNodesModelsFromTree(t._type),r=0;r<i.length;++r)i[r]&&!t.tree.getDocument().getXSO().isIn(i[r])&&n.push(i[r]);this.tree.getDocument().withTransactionUpdate(function(){for(;0!==n.length;){n.pop().select()}})},unselectTreeNodesFromComponentList:function(e){var t=this;this.tree.getDocument().withTransactionUpdate(function(){for(var n=0;n<e.length;++n){var o=e[n];if(t.isComponentMatchingThisTree(o)){var i=o.QueryInterface("VCXITreeNode"),r=i&&i.GetTreeNodesModelsFromTree(t._type);if(Array.isArray(r))for(var s=0;s<r.length;++s)r[s]&&t.tree.getDocument().getXSO().isIn(r[s])&&(t._selectStack||(t._selectStack={}),t._selectStack[s]||(t._selectStack[s]={TreeModel:r[s],select:0}))}}})},_createTreeNodeModel:function(e,t,n,o,i){if(e){var r=t;if(""==r){var s=e.QueryInterface("VCXIModifiable");if(s){var a=s.GetProperty("Actor.Name");a&&(r=a.GetPropertyValue().GetValue())}}var l=new d({label:r,children:n?[]:null,data:{vcxTreeNode:e}});e.SetNewTreeNodeModel(l,this._type),e.getTreeNodeComponentIcon();var c=o||this._onSelectionEvtOnTreeNodeCB;l.onSelect(c.call(this));var h=i||this._onSelectionEvtOnTreeNodeCB;return l.onUnselect(h.call(this)),l}console.warn("A VCXTreeNode extension is necessary as parameter of this method")},_destroyTreeNodeModel:function(e){this._getTreeNodeExtensionFromTreeNodeModel(e).UnsetTreeNodeModel(e,this._type),e.remove()},_revExpandFromTreeNodeExt:function(e){var t=e.GetTreeNodesModelsFromTree(this._type);if(0===t.length){for(var n=[],o=e;o&&!o.hasTreeNodeModels(this._type);){if(!(o=o.GetParent()))return;n.push(o)}for(;0!==n.length;)for(var i=n.pop().GetTreeNodesModelsFromTree(this._type),r=0;r<i.length;++r)i[r].isExpanded()||i[r].expand()}else for(var s=0;s<t.length;++s)t[s].isVisible()||t[s].reverseExpand()},_getParentTreeNodeModelFromTreeNodeExt:function(e,t){var n=e.GetParent();if(n){var o=n.GetTreeNodesModelsFromTree(this._type);if(0===o.length&&!0===t){var i=this._getParentTreeNodeModelFromTreeNodeExt(n,!0);if(!i)return void console.log("Couldn't find a parent treeNodeModel in the tree "+this._type+" for the component :",n.GetObject());i.expand(),o=n.GetTreeNodesModelsFromTree(this._type)}if(!(o.length>1))return o[0]}else console.log("Couldn't find treeNode extension for component parent...")},_addTreeNodesFromComponentsList:function(e){this._modifyTreeNodesFromComponentsList(e,!0)},_removeTreeNodesFromComponentsList:function(e){this._modifyTreeNodesFromComponentsList(e,!1)},_modifyTreeNodesFromComponentsList:function(e,t){if("boolean"==typeof t){var n=this,o=t?this._addTreeNodeFromComponent:this._removeTreeNodeFromComponent;this.tree.getDocument().withTransactionUpdate(function(){for(var t=0;t<e.length;++t){var i=e[t];n.isComponentMatchingThisTree(i)&&o.call(n,i)}})}},_addTreeNodeFromComponent:function(e){var t=e&&e.QueryInterface("VCXITreeNode");if(t)if(t.GetParent())if((o=e.QueryInterface("VCXITreeNode").GetTreeNodesModelsFromTree(this._type)).length>0&&this._uniqueTreeNodePerComponent)console.log("TreeNodeModels should be unique per component in this tree, and there's already"+o.length+"treenodes here.\nAddition of treeNode aborted.:",e);else{var n=this._getParentTreeNodeModelFromTreeNodeExt(t,!0);if(n){Array.isArray(n.options.children)||n.updateOptions({children:[]}),n.isVisible()||n.reverseExpand(),n.expand();var o,i=(o=e.QueryInterface("VCXITreeNode").GetTreeNodesModelsFromTree(this._type))[0];if(!(1===o.length&&(this._uniqueTreeNodePerComponent||i.getParent()===n)||i&&i.getParent()===n)){var r=this._createTreeNodeModel(t,t.GetName(),t.GetChildren().length>0);n.addChild(r)}}}else console.warn("The component parent must have a treeNode interface.\nAbort addition of treeNode in tree.");else console.warn("The component must have a treeNode interface. Abort addition of treeNode in tree.")},_removeTreeNodeFromComponent:function(e){var t=e.QueryInterface("VCXITreeNode").GetTreeNodesModelsFromTree(this._type);if(0!==t.length)for(t.length>1&&this._uniqueTreeNodePerComponent&&console.log("TreeNodeModels should be unique per component in this tree. Before removal, there are "+t.length+" treeNodes for the component:",e);0!==t.length;){var n=t.pop();this._destroyTreeNodeModel(n)}},_onSelectionEvtOnTreeNodeCB:function(){var e=this;return function(t){var n=t.target,o=(n.isSelectionChangeFromUI(),t.event);e._checkForSelectionParentAuto(o,n),e._selectComponent(o,n)}},_selectComponent:function(e,t){var n="select"===e?"add":"unselect"===e?"remove":"",o=this._experienceBase.getManager("VCXSelectManager");if(!(o&&o.isEventCallbackBlocked&&o.isEventCallbackBlocked(n,"SELECTION"))){var i=this._getTreeNodeExtensionFromTreeNodeModel(t),r=i&&i.GetObject();r?"select"===e?this._addTreeNodeCompToSelection(r):"unselect"===e&&this._removeTreeNodeCompFromSelection(r):console.warn("Component associated to specified selectedTreeNodeModel couldn't be found...")}},_areChildrenAllSelected:function(e){for(var t=e&&e.getChildren(),n=t&&t.length>0,o=0;o<t.length&&n;++o)n=n&&t[o].isSelected();return n},_checkForSelectionParentAuto:function(e,t){var n="select"===e,o=!t.isRoot()&&t.getParent();if(o){var i=this._getTreeNodeExtensionFromTreeNodeModel(o),r=(i&&i.QueryInterface("VCXIModifiable"),i&&i.QueryInterface("VCXISelectBehavior"));if(r&&1===r.GetSelectMode()){var s=o.isSelected();n&&(s=(s=!s)&&this._areChildrenAllSelected(o)),s&&(o[e](),this._checkForSelectionParentAuto(e,o))}}},_addTreeNodeCompToSelection:function(e){var t=this._experienceBase.getManager("VCXSelectionManager");if(e.QueryInterface("VCXIModifiable")||!t.isIn(e)){var n=new h(t);1!==this.tree.getDocument().getXSO().get().length||this.tree.getManager().isInMultiSelection()?n.AddToSelection(e):n.SetSelection(e),this._experienceBase.getManager("VCXCommandManager").Do(n)}},_removeTreeNodeCompFromSelection:function(e){var t=this._experienceBase.getManager("VCXSelectionManager");if(e.QueryInterface("VCXIModifiable")||t.isIn(e)){var n=new h(t);n.RemoveFromSelection(e),this._experienceBase.getManager("VCXCommandManager").Do(n)}},_switchTreeNodePreHighlight:function(e,t,n){var o=t?n?2:1:0;e.options.isPreHighlighted!==o&&e.updateOptions({isPreHighlighted:o})},_updateTreeNodeNameFromHashing:function(e,t){var n=this._experienceBase.getManager("VCXScenarioManager").ModifiableServer,o=n&&n.GetModifiableFromHashing(e),i=o&&o.QueryInterface("VCXITreeNode"),r=i&&i.GetTreeNodesModelsFromTree();if(Array.isArray(r))for(var s=0;s<r.length;++s){var a=r[s];a&&a.updateOptions({label:t})}},_getFirstVisibleTreeNodesFromComponent:function(e){var t=this._type,n={visible:{},hiding:{}},o=e.QueryInterface("VCXITreeNode"),i=o&&o.GetTreeNodesModelsFromTree(t);if(Array.isArray(i)){if("VCXWebAssemblyTreeCtrl"===t||"VCXWebDressupTreeCtrl"===t){if(1===i.length&&i[0].isVisible())return n.visible[i[0]._getID()]=i[0],n;var r=e.QueryInterface("VCXIModelNavigable");if(r.getParent())for(;e&&Array.isArray(i)&&1!==i.length&&r;)i=(o=(e=(r=r.getParent())&&r.GetObject())&&e.QueryInterface("VCXITreeNode"))&&o.GetTreeNodesModelsFromTree(this._type);if(!e)return void console.log("No component ancestor has been found..");if(!i||1!==i.length)return void console.warn("Something's wrong with the recovery of a treeNodeModel within AssemblyTree. There should be only one instead of "+(i&&i.length)+".");for(var s=i[0];s&&!s.isVisible();){var a=this._getTreeNodeExtensionFromTreeNodeModel(s),l=a&&a.GetParent();i=l.GetTreeNodesModelsFromTree(this._type),Array.isArray(i)&&1===i.length||console.warn("There should be only one treeNodeModel per component within dressups and assembly trees"),s=l&&l.GetTreeNodesModelsFromTree(this._type)[0]}return s?(n.hiding[s._getID()]=s,n):void console.warn("_getFirstVisibleTreeNodesFromComponent: Something has gone wrong, no treeNode ancestor of the component treeNode has been found.")}if(!(i.length>this.tree.getRoots().length)){for(var d=0;d<i.length;++d){var c=i[d];c.isVisible()?n.visible[c._getID()]=c:n.hiding[c._getID()]||(n.hiding[c._getID()]=c)}return n}console.log("There shouldn't be more treeNodeModel associated to the component than the number of roots.")}else console.warn("Something's wrong with the recovery of treeNode extension or treeNodesModels...")},_switchPreHLFromPathElement:function(e,t){var n=u.BuildCleanedPathElement(e),o=this._experienceBase.ComponentsMap.GetComponentFromPathElement(n);if(o&&this.isComponentMatchingThisTree(o)){var i=this._getFirstVisibleTreeNodesFromComponent(o);if(i){var r="";for(r in i.visible)this._switchTreeNodePreHighlight(i.visible[r],t,!1),i.visible.hasOwnProperty(r)&&(this._selectStack||(this._selectStack={}),this._selectStack[r]||(this._selectStack[r]={TreeModel:i.visible[r],preSelect:t}));for(r in i.hiding)i.hiding.hasOwnProperty(r)&&this._switchTreeNodePreHighlight(i.hiding[r],t,!0)}}},_addPreHLFromPathElement:function(e){this._switchPreHLFromPathElement(e,!0)},_removePreHLFromPathElement:function(e){this._switchPreHLFromPathElement(e,!1)},_onChangeSelectionCB:function(e,t){var n;if(t?("select",n=this.selectTreeNodesFromComponentList):("unselect",n=this.unselectTreeNodesFromComponentList),this.isThisTreeInView())if(Array.isArray(e)&&e.length>0&&e[0].GetType){for(var o=[],i=0;i<e.length;++i){var r=e[i];r&&this.isComponentMatchingThisTree(r)&&o.push(r)}0!==o.length&&n.call(this,o)}else console.log("Current event should have an array of components as 'componentsList' parameter.")},_getTouchSelectionBarTreeColInfos:function(){var e=this;return{dataIndex:"touchSelectionBar",width:this._experienceBase.getManager("VCXContextManager").isTouchCompliantDevice()?20:15,isColumnDraggable:!1,onCellRequest:function(t){e._onTouchSelectionBarCellRequest(t)}}},_getTreeMainColInfos:function(e){var t=this;return{dataIndex:"tree",onCellRequest:function(o){if(o.virtualRowID>-1){var i=o.cellView;if(""!==o.nodeModel){n.Engine.ie&&void 0===window.__karma__&&(o.cellView.elements.layout.appendChild(o.cellView.elements.linksContainer),o.cellView.elements.expanderContainer.inject(o.cellView.elements.nodeContainer),o.cellView.elements.iconsContainer.inject(o.cellView.elements.nodeContainer),o.cellView.elements.badgeTopRight.inject(o.cellView.elements.iconsContainer),o.cellView.elements.badgeTopLeft.inject(o.cellView.elements.iconsContainer),o.cellView.elements.badgeBottomRight.inject(o.cellView.elements.iconsContainer),o.cellView.elements.badgeBottomLeft.inject(o.cellView.elements.iconsContainer),o.cellView.elements.labelContainer.inject(o.cellView.elements.nodeContainer),o.cellView.elements.layout.appendChild(o.cellView.elements.nodeContainer)),i.getContent().setAttribute("title",o.nodeModel.getLabel()),i.setLabel(o.nodeModel.getLabel()),i.setIcons(o.nodeModel.getIcons()),i.setBadges(o.nodeModel.options.badges),i._setExpanderState(o.nodeModel._expandState),i._setDepth(o.nodeModel._nodeDepth),o.cellView.elements.container.setContent(o.cellView.elements.layout);var r=t._getTreeNodeExtensionFromTreeNodeModel(o.nodeModel),s=r&&r.GetObject(),a=s&&s.GetID();o.cellView.elements.expanderContainer.setAttribute("data-rec-id","expander_"+a),o.cellView.elements.iconsContainer.setAttribute("data-rec-id","icon_"+a),o.cellView.elements.labelContainer.setAttribute("data-rec-id","label_"+a)}}e.onCellRequests.tree&&e.onCellRequests.tree(o)}}},_getVisIconColInfos:function(e){return{text:"visibilityIcon",dataIndex:"visibilityIcon",width:32,isColumnDraggable:!1,onCellRequest:e.onCellRequests.visibilityIcon}},_onPreExpandCB:function(e){var t=e.target,n=this._getTreeNodeExtensionFromTreeNodeModel(t);if(!n)return console.warn("Something's wrong: there should be a treeNodeExtension associated with the treeNodeModel: "+t),void t.preExpandDone();if(t.hasChildren()||0===n.GetChildren().length)t.preExpandDone();else{for(var o=n.GetChildren(),i=[],r=0;r<o.length;++r){var s=o[r];if(this.isComponentMatchingThisTree(s.GetObject()))if(s){var a=s.GetChildren(),l=this._createTreeNodeModel(s,s.GetName(),0!==a.length);i.push(l)}else console.log("VCXITreeNode extension missing...")}t.addChild(i),t.preExpandDone()}},_onTouchSelectionBarCellRequest:function(t){var n=t.cellView.getContent();if(null!==this._experienceBase){var o=this._experienceBase.getManager("VCXContextManager").isTouchCompliantDevice()?20:15,i=n.getBoundingClientRect(),s=100===i.width?o:i.width,a=i.height,l=e.createElement("div",{class:"nodeTouchZone",styles:{position:"absolute",top:"0px",left:"0px",width:2*s+"px",height:a+"px",marginLeft:-Math.floor(s/2)+"px"}});l.inject(n);var d=this;l.addEventListener(r.POINTERDOWN,function(){"boolean"!=typeof d._multiSelBeforeForcing&&(d._multiSelBeforeForcing=d.tree.getManager()._modeIsMultiSel,d.tree.getManager().forceMultiSelection(!0));document.addEventListener(r.POINTERUP,function e(t){"touchend"===t.type&&t.preventDefault(),"boolean"==typeof d._multiSelBeforeForcing&&(d.tree.getManager().forceMultiSelection(d._multiSelBeforeForcing),d._multiSelBeforeForcing=null),document.removeEventListener(r.POINTERUP,e,!1)},!1)},!1)}}});return m.prototype._getTreeNodeExtensionFromTreeNodeModel=function(e){return e&&e.options&&e.options.data&&e.options.data.vcxTreeNode},m.prototype._onVisibilityIconRequest=function(e){if(!e.isHeader){var t=e.nodeModel,n=m.prototype._getTreeNodeExtensionFromTreeNodeModel(t);if(n){var o=n.GetVisibility();1===o||-1===o?"visible"!==t.options.visibilityState&&(t.options.visibilityState="visible"):0===o?"hidden"!==t.options.visibilityState&&(t.options.visibilityState="hidden"):-2===o&&(t.options.visibilityState="novisibility");var i=n.GetObject();!0===i.impactedByChild&&(t.options.updateNewElementPastille="ImpactedByChild"),!0===i.isNewFromUpdate?t.options.updateNewElementPastille="NewAsset":!0===i.isImpactedByUpdate?t.options.updateNewElementPastille="ToFix":!0===i.isHasLinkBrokenFromUpdate&&(t.options.updateNewElementPastille="BrokenAsset")}}},m.prototype._toggleEyeIconOnClick=function(e){if("visibilityIcon"===e.dataIndex){var t=e.model.options.manager.getTreeNodeModelFromRowID(e.model.getRowID()),n=m.prototype._getTreeNodeExtensionFromTreeNodeModel(t);if(n){var o=0===n.GetVisibility()?1:0;if(n.SetVisibility(o)){var i=o?"visible":"hidden";t.updateOptions({visibilityState:i})}}}},m.prototype.EVisibilityState={Indeterminate:-1,Hidden:0,Visible:1,Ghost:2},m}),define("DS/VCXWebTreeGUI/VCXWebAssemblyTreeCtrl",["DS/CoreEvents/Events","DS/Tree/TreeNodeModel","DS/VCXWebTreeGUI/VCXWebTreeCtrl"],function(e,t,n){"use strict";var o=n.extend({init:function(e){this._parent(e),this._type="VCXWebAssemblyTreeCtrl",this._uniqueTreeNodePerComponent=!0},getTreeTitle:function(){return"Assembly"},_setTreeRootsAndFirstNodes:function(){var e=this._experienceBase.getManager("VCXContextManager").getRootComponent(),t=e.QueryInterface("VCXITreeNode"),n=e.QueryInterface("VCXIModelNavigable");if(t&&n){var o="Root",i=e.QueryInterface("VCXIModifiable");if(i){var r=i.GetProperty("Actor.Name");r&&(o=r.GetPropertyValue().GetValue())}var s=n.getChildren().length>0,a=this._createTreeNodeModel(t,o,s);this.tree.getDocument().addRoot(a),s&&this._expandUntilNVisibleNodes(5)}else console.warn("Experience component need at least a navigable and a treeNode interfaces.")},_setCustomEvtsSubscriptions:function(){var t=this;this._eventTokens._evtOnAddAssetToken=e.subscribe({event:"VCX_ASSETS_ADDED"},function(e){Array.isArray(e)?t._addTreeNodesFromComponentsList(e):console.log("VCX_ASSETS_ADDED event data has been changed...")}),this._eventTokens._evtOnRemoveAssetToken=e.subscribe({event:"VCX_ASSETS_REMOVED"},function(e){if(WUX.Selection.HSOManager.empty(!0),WUX.Selection.CSOManager.empty(!0),WUX.Selection.PSOManager.empty(!0),Array.isArray(e)){for(var n=[],o=0,i=0;i<e.length;i++){e[i].QueryInterface("VCXIModelNavigable").traverse(function(e){e&&(n.push(e.GetObject()),o++)})}console.log("VCX_ASSETS_REMOVED : nbnodes removed ="+o),t._removeTreeNodesFromComponentsList(e)}else console.log("VCX_ASSETS_REMOVED event data has been changed...")})},_expandUntilNVisibleNodes:function(e,t){var n=null,o=[];if(t)n=[t];else{var i=this.tree&&this.tree.getDocument().getRoots();if(!i||Array.isArray(i)&&0===i.length)return;for(var r=0,s=i.length;r<s;++r)i[r].isVisible()&&o.push(i[r]);n=i}for(;o.length<e&&Array.isArray(n)&&0!==n.length;){for(var a=[],l=0;l<n.length;++l){n[l].isExpanded()||n[l].expand();var d=n[l].getChildren();Array.isArray(d)&&(o=o.concat(d),a=a.concat(d))}n=a.slice()}},isComponentMatchingThisTree:function(e){return e.IsKindOf("VCXComponentOccurrenceExt")||e.IsKindOf("CIDItem_Spec")||e.IsKindOf("Abstract3DExperienceObject_Spec")}});return o.prototype._onVisibilityIconRequest=function(e){e.nodeModel.isRoot()||n.prototype._onVisibilityIconRequest(e)},o.prototype._toggleEyeIconOnClick=function(e){"visibilityIcon"===e.dataIndex&&(e.model.options.manager.getTreeNodeModelFromRowID(e.model.getRowID()).isRoot()||n.prototype._toggleEyeIconOnClick(e))},o}),define("DS/VCXWebTreeGUI/VCXWebDressupTreeCtrl",["DS/CoreEvents/Events","DS/Tree/TreeNodeModel","DS/VCXWebTreeGUI/VCXWebTreeCtrl"],function(e,t,n){"use strict";return n.extend({init:function(e){this._parent(e),this._type="VCXWebDressupTreeCtrl",this._uniqueTreeNodePerComponent=!0,this._hideEmptyDrspGrps=!1},getTreeTitle:function(){return"Design"},_setTreeRootsAndFirstNodes:function(){for(var e=this,t=this.tree.getDocument(),n=this._getDressupRoot().QueryInterface("VCXIModelNavigable"),o=n&&n.getChildren(),i=0;i<o.length;++i){var r=o[i],s=r.QueryInterface("VCXITreeNode");if(this.isComponentMatchingThisTree(r.GetObject())){var a=r.getChildren().filter(function(t){return e.isComponentMatchingThisTree(r.GetObject())}),l=this._createTreeNodeModel(s,s.GetName(),0!==a.length);t.addRoot(l)}}},_setCustomEvtsSubscriptions:function(){var t=this;this._eventTokens._evtDressupsAddedToken=e.subscribe({event:"VCX_DRESSUPS_ADDED"},function(e){t._addTreeNodesFromComponentsList(e)}),this._eventTokens._evtDressupsRemovedToken=e.subscribe({event:"VCX_DRESSUPS_PREREMOVED"},function(e){t._removeTreeNodesFromComponentsList(e)})},_getDressupRoot:function(){return this._experienceBase.getManager("VCXDressupManager")},isComponentMatchingThisTree:function(e){return this._experienceBase.getManager("VCXDressupManager").shouldComponentBeDisplayedInTree(e)}})}),define("DS/VCXWebTreeGUI/VCXWebHotspotsTreeCtrl",["DS/CoreEvents/Events","DS/Tree/TreeNodeModel","DS/VCXWebTreeGUI/VCXWebTreeCtrl"],function(e,t,n){"use strict";return n.extend({init:function(e){this._parent(e),this._type="VCXWebHotspotsTreeCtrl",this._uniqueTreeNodePerComponent=!1},getTreeTitle:function(){return"Hotspots"},_setTreeRootsAndFirstNodes:function(){var e=this._experienceBase.ComponentsMap.GetComponentFromType("VCXComponentGroupHotspot");this._addTreeNodesFromComponentsList(e,!0);for(var t=[],n=this._experienceBase.ComponentsMap.GetComponentFromType("VCXComponentHotspot"),o=0;o<n.length;o++)n[o].GroupID||t.push(n[o]);t.length&&this._addTreeNodesFromComponentsList(t,!0)},_setCustomEvtsSubscriptions:function(){var t=this;this._eventTokens._evtHotspotsAddedToken=e.subscribe({event:"VCX_HOTSPOTS_ADDED"},function(e){t._addTreeNodesFromComponentsList(e)}),this._eventTokens._evtHotspotsRemovedToken=e.subscribe({event:"VCX_HOTSPOTS_REMOVED"},function(e){t._removeTreeNodesFromComponentsList(e)})},_addTreeNodeFromComponent:function(e,t){var n=this.tree.getDocument(),o=e&&e.QueryInterface("VCXITreeNode");if(o){var i=this._createTreeNodeModel(o,o.GetName(),o.GetChildren().length>0,this._onSelectHotspotTreeNodeCB,this._onUnSelectHotspotTreeNodeCB);i.updateOptions({hotspotRole:1}),t?t.addChild(i):n.addChild(i);var r=o.GetChildren();if("VCXComponentGroupHotspot"!==o.GetObject().GetType()){var s=[];for(l=0;l<r.length;++l){if(d=r[l]){var a=this._createTreeNodeModel(d,d.GetName(),!1);a.updateOptions({hotspotRole:2}),s.push(a)}else console.log("VCXITreeNode extension missing...")}i.addChild(s)}else for(var l=0;l<r.length;++l){var d;if(d=r[l]){var c=d.GetObject();this._addTreeNodeFromComponent(c,i)}else console.log("VCXITreeNode extension missing...")}}else console.warn("The root component must have a treeNode interface. Abort addition of treeNode in tree.")},_onSelectHotspotTreeNodeCB:function(){return this._toggleHotspotActivationOnSelection(!0)},_onUnSelectHotspotTreeNodeCB:function(){return this._toggleHotspotActivationOnSelection(!1)},_toggleHotspotActivationOnSelection:function(e){var t=this;return function(n){var o=t._getTreeNodeExtensionFromTreeNodeModel(n.target);if(o){var i=o.GetObject(),r=(o.QueryInterface("VCXIModifiable"),t._experienceBase.getManager("VCXAPIManager"));(e?r.SelectHotspot:r.DeselectHotspot).call(r,i.GetID())}}},_toggleEyeIconOnClick:function(e){if("visibilityIcon"===e.dataIndex){var t=e.model.options.manager.getTreeNodeModelFromRowID(e.model.getRowID());this._getTreeNodeExtensionFromTreeNodeModel(t).GetObject().IsKindOf("VCXComponentHotspot")||this._parent(e)}},isComponentMatchingThisTree:function(e){return e.IsKindOf("VCXComponentGroupHotspot")||e.IsKindOf("VCXComponentHotspot")||e.IsKindOf("VCXWebComponentOccurrence")}})}),define("DS/VCXWebTreeGUI/VCXWebSelectionSetsTreeCtrl",["DS/CoreEvents/Events","DS/Tree/TreeNodeModel","DS/VCXWebTreeGUI/VCXWebTreeCtrl"],function(e,t,n){"use strict";return n.extend({init:function(e){this._parent(e),this._type="VCXWebSelectionSetsTreeCtrl",this._uniqueTreeNodePerComponent=!1},getTreeTitle:function(){return"Selection Sets"},_setTreeRootsAndFirstNodes:function(){var e=this._experienceBase.ComponentsMap.GetComponentFromType("VCXComponentGroupSelectionSet");this._addTreeNodesFromComponentsList(e,!0);for(var t=[],n=this._experienceBase.ComponentsMap.GetComponentFromType("VCXComponentSelectionSet"),o=0;o<n.length;o++)n[o].GroupID||t.push(n[o]);this._addTreeNodesFromComponentsList(t,!0)},_setCustomEvtsSubscriptions:function(){var t=this;this._eventTokens._evtSelSetsAddedToken=e.subscribe({event:"VCX_SELECTIONSETS_ADDED"},function(e){t._addTreeNodesFromComponentsList(e)}),this._eventTokens._evtSelSetsRemovedToken=e.subscribe({event:"VCX_SELECTIONSETS_REMOVED"},function(e){t._removeTreeNodesFromComponentsList(e)})},_addTreeNodeFromComponent:function(e,t){var n=this.tree.getDocument(),o=e&&e.QueryInterface("VCXITreeNode");if(o){var i=this._createTreeNodeModel(o,o.GetName(),o.GetChildren().length>0,this._onSelectSelSetTreeNodeCB,this._onUnSelectSelSetTreeNodeCB);i.updateOptions({selectionSetRole:1}),t?t.addChild(i):n.addRoot(i);var r=o.GetChildren();if("VCXComponentGroupSelectionSet"!==o.GetObject().GetType()){var s=[];for(l=0;l<r.length;++l){if(d=r[l]){var a=this._createTreeNodeModel(d,d.GetName(),!1);a.updateOptions({selectionSetRole:2}),s.push(a)}else console.log("VCXITreeNode extension missing...")}i.addChild(s)}else for(var l=0;l<r.length;++l){var d;if(d=r[l]){var c=d.GetObject();this._addTreeNodeFromComponent(c,i)}else console.log("VCXITreeNode extension missing...")}}else console.warn("The root component must have a treeNode interface. Abort addition of treeNode in tree.")},_onSelectSelSetTreeNodeCB:function(){return this._toggleSelSetActivationOnSelection(!0)},_onUnSelectSelSetTreeNodeCB:function(){return this._toggleSelSetActivationOnSelection(!1)},_toggleSelSetActivationOnSelection:function(e){var t=this;return function(n){var o=n.target;if(o.isSelectionChangeFromUI()){var i=t._getTreeNodeExtensionFromTreeNodeModel(o);if(i){var r=i.GetObject(),s=t._experienceBase.getManager("VCXAPIManager");(e?s.ActivateSelectionSet:s.DeactivateSelectionSet).call(s,r.GetID())}}}},isComponentMatchingThisTree:function(e){return e.IsKindOf("VCXComponentGroupSelectionSet")||e.IsKindOf("VCXComponentSelectionSet")||e.IsKindOf("VCXWebComponentOccurrence")}})}),define("DS/VCXWebTreeGUI/VCXWebStylesTreeCtrl",["DS/CoreEvents/Events","DS/Tree/TreeNodeModel","DS/VCXWebTreeGUI/VCXWebTreeCtrl"],function(e,t,n){"use strict";return n.extend({init:function(e){this._parent(e),this._type="VCXWebStylesTreeCtrl",this._uniqueTreeNodePerComponent=!0},_setTreeRootsAndFirstNodes:function(){var e=this._experienceBase.ComponentsMap.GetComponentFromType("VCXComponentStyle");this._addTreeNodesFromComponentsList(e,!0)},_setCustomEvtsSubscriptions:function(){var t=this;this._eventTokens._evtStylesAddedToken=e.subscribe({event:"VCX_STYLE_ADDED"},function(e){t._addTreeNodesFromComponentsList(e)})},_addTreeNodeFromComponent:function(e){var t=this.tree.getDocument(),n=e&&e.QueryInterface("VCXITreeNode");if(n){var o=this._createTreeNodeModel(n,n.GetName(),n.GetChildren().length>0);t.addChild(o)}else console.warn("The root component must have a treeNode interface. Abort addition of treeNode in tree.")},isComponentMatchingThisTree:function(e){return e.IsKindOf("VCXComponentStyle")}})});