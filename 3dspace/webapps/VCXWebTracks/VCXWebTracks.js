define("DS/VCXWebTracks/VCXKey",[],function(){"use strict";var e=function(e,t){this._frame=e,this._value=t};return e.prototype.Copy=function(e){this._frame=e._frame,this._value=e._value},e.prototype.SetFrame=function(e){this._frame=e},e.prototype.GetFrame=function(){return this._frame},e.prototype.SetIsVolatile=function(e){this._isVolatile=e},e.prototype.GetIsVolatile=function(){return this._isVolatile},e.prototype.SetEasing=function(e){this._easing=e},e.prototype.GetEasing=function(){return this._easing},e.prototype.SetValue=function(e){this._value=e},e.prototype.GetValue=function(){return this._value},e.prototype.Clone=function(){var t=new e,n=this.GetFrame();t.SetFrame(n);var r=this.GetValue().Clone();return t.SetValue(r),t},e}),define("DS/VCXWebTracks/VCXEasing",[],function(){"use strict";var e=function(){};return e.easeInOutPower3=function(e,t,n){return e<.5?t+e*e*e*4*(n-t):n+(e=1-e)*e*e*4*(t-n)},e.easeLinear=function(e){return e},e.easeInCubic=function(e){return Math.pow(e,3)},e.easeOutCubic=function(e){return 1-Math.pow(1-e,3)},e.easeInOutCubic=function(e){return e<.5?4*Math.pow(e,3):1-Math.pow(-2*e+2,3)/2},e}),define("DS/VCXWebTracks/VCXInterpolator",["UWA/Class"],function(e){"use strict";var t=e.extend({init:function(){},GetType:function(){return"VCXInterpolator"},GetInterpolatedValue:function(e,t,n,r){}});return t.EInterpolationType={Linear:0,Cubic:1,Custom:2,Smooth:5},t});var VCXGlobalCompare=function(e,t){return e._frame-t._frame};define("DS/VCXWebTracks/VCXTrack",["UWA/Class","DS/WebRBTree/WebRBTree","DS/VCXWebTracks/VCXKey","DS/WebRBTree/WebRBIterator"],function(e,t,n,r){var a=e.extend({init:function(){this._objectAnimation=null,this._treekeys=new t(VCXGlobalCompare),this._rangeok=!1,this._lastKeyInf=null,this._lastKeySup=null},unInitialize:function(){this._objectAnimation=null,this._rangeok=!1,this._lastKeyInf=null,this._lastKeySup=null,this._treekeys=null},SetObjectAnimation:function(e){this._objectAnimation=e},GetObjectAnimation:function(){return this._objectAnimation},SetBoostDirty:function(){this._objectAnimation&&this._objectAnimation.SetBoostDirty()},AddKey:function(e){this.SetBoostDirty();var t=this._treekeys.findIter(e);t?t.data().SetValue(e.GetValue()):this._treekeys.insert(e);this._rangeok=!1,this._lastKeyInf=null,this._lastKeySup=null},RemoveKey:function(e){this.SetBoostDirty();var t=new n;t.SetFrame(e),this._treekeys.remove(t),this._rangeok=!1,this._lastKeyInf=null,this._lastKeySup=null},GetKey:function(e){var t=new n;t.SetFrame(e);var r=this._treekeys.findIter(t);return r?r.data():null},GetKeysForLinearInterpolationREF:function(e,t){if(this._rangeok&&(this._lastKeyInf&&e<this._lastKeyInf.GetFrame()&&(this._rangeok=!1),this._lastKeySup&&e>=this._lastKeySup.GetFrame()&&(this._rangeok=!1),this._rangeok))return t.keyInf=this._lastKeyInf,t.keySup=this._lastKeySup,!1;var r=new n;r.SetFrame(e);var a=this._treekeys.lowerBound(r),i=a.data();t.keyInf=i||null,a.next();var l=a.data();return t.keySup=l||null,this._rangeok=!0,this._lastKeyInf=t.keyInf,this._lastKeySup=t.keySup,!0},GetKeysForCubicInterpolation:function(e,t,r,a,i){var l=new n;l.SetFrame(e);var u=this._treekeys.lowerBound(l),o=u.data();null===o?(r._value=null,r._frame=null):r.Copy(o);var s=this._treekeys.lowerBound(l).prev();null===s?(t._value=null,t._frame=null):t.Copy(s),u.next();var y=u.data();null===y?(a._value=null,a._frame=null):a.Copy(y);var p=u._cursor,f=u.next();null===f||void 0===p?(i._value=null,i._frame=null):i.Copy(f)},GetPreviousKey:function(e){var t=new n;t.SetFrame(e);var r=this._treekeys.lowerBound(t).data();return null===r?null:r},GetPreviousStrictKey:function(e){var t=new n;t.SetFrame(e);var r=this._treekeys.lowerBound(t).data();return null===r?null:(r.GetFrame()===e&&(r=this._treekeys.lowerBound(t).prev()),r)},GetNextStrictKey:function(e){var t=new n;t.SetFrame(e);var r=this._treekeys.upperBound(t).data();return null===r?null:(r.GetFrame()===e&&(r=this._treekeys.lowerBound(t).next()),r)},GetMaxFrame:function(){var e=0,t=this._treekeys.max();return null!==t&&(e=t._frame),e},IsEmpty:function(){return null===this._treekeys.max()},IsConstant:function(){for(var e=null,t=this._treekeys,n=new r(t),a=n.next();null!==a;){var i=a.GetValue();if(console.log("            "+a.GetFrame()+"   "+i.ToString()),e){if(!e.IsEqualTo(i))return!1}else e=i;a=n.next()}return!0},Clone:function(){for(var e=new a,t=this._treekeys,n=new r(t),i=n.next();null!==i;){var l=i.Clone();e.AddKey(l),i=n.next()}return e},ResetRangeCache:function(){this._rangeok=!1}});return a}),define("DS/VCXWebTracks/VCXInterpolatorConstant",["DS/VCXWebTracks/VCXInterpolator"],function(e){"use strict";return e.extend({init:function(){},GetType:function(){return"VCXInterpolatorConstant"},GetInterpolatedValue:function(e,t,n,r){var a=null;r&&(a=r[t]);var i=null;if(a&&(i=a.GetPreviousKey(n)),i)return i.GetValue();if(!e)return null;var l=e.GetProperty(t);return l?l.GetPropertyValue():void 0}})}),define("DS/VCXWebTracks/VCXInterpolatorCubic",["DS/VCXWebTracks/VCXInterpolator","DS/VCXWebTracks/VCXKey"],function(e,t){"use strict";return e.extend({init:function(){},GetType:function(){return"VCXInterpolatorCubic"},GetInterpolatedValue:function(e,n,r,a){var i=null;a&&(i=a[n]);var l=new t(null,null),u=new t(null,null),o=new t(null,null),s=new t(null,null);if(void 0!==i&&i.GetKeysForCubicInterpolation(r,l,u,o,s),null===u.GetValue()&&void 0!==e){var y=e.GetProperty(n);void 0!==y&&((u=new t).SetValue(y.GetPropertyValue()),u.SetFrame(0))}if(null===u.GetValue())return null;null===l.GetValue()&&(l.SetValue(u.GetValue()),l.SetFrame(u.GetFrame())),null===o.GetValue()&&(o.SetValue(u.GetValue()),o.SetFrame(u.GetFrame())),null===s.GetValue()&&(s.SetValue(o.GetValue()),s.SetFrame(o.GetFrame()));var p=l.GetValue(),f=u.GetValue(),h=o.GetValue(),c=s.GetValue(),V=1;return o.GetFrame()!==u.GetFrame()&&(V=(r-u.GetFrame())/(o.GetFrame()-u.GetFrame())),f.GetCubicInterpolatedValue(p,f,h,c,l.GetFrame(),u.GetFrame(),o.GetFrame(),s.GetFrame(),V)}})}),define("DS/VCXWebTracks/VCXInterpolatorLinear",["DS/VCXWebTracks/VCXInterpolator","DS/VCXWebTracks/VCXKey","DS/VCXWebTracks/VCXEasing"],function(e,t,n){"use strict";return e.extend({init:function(){this._rangeChanged=!1},GetType:function(){return"VCXInterpolatorLinear"},SetRangeChanged:function(e){this._rangeChanged!==e&&(this._rangeChanged=e)},GetRangeChanged:function(){return this._rangeChanged},GetInterpolatedValue:function(e,r,a,i){var l=null;i&&(l=i[r]);var u={keyInf:null,keySup:null};if(l){var o=l.GetKeysForLinearInterpolationREF(a,u);this.SetRangeChanged(o)}if(null===u.keyInf&&e){var s=e.GetProperty(r);s&&(u.keyInf=new t(null,null),u.keyInf.SetValue(s.GetPropertyValue()),u.keyInf.SetFrame(0))}if(u.keyInf){if(u.keySup){var y=u.keyInf.GetValue(),p=u.keySup.GetValue(),f=(a-u.keyInf.GetFrame())/(u.keySup.GetFrame()-u.keyInf.GetFrame());if(l.easing)f=l.easing(f,0,1);else switch(u.keyInf.GetEasing()){case"EEasingInCubic":f=n.easeInCubic(f);break;case"EEasingOutCubic":f=n.easeOutCubic(f);break;case"EEasingInOutCubic":f=n.easeInOutCubic(f)}return y.GetInterpolatedValue(y,p,f)}return u.keyInf.GetValue()}return null}})}),define("DS/VCXWebTracks/VCXInterpolatorSpherical",["DS/VCXWebProperties/VCXPropertyValueFrame","DS/VCXWebTracks/VCXInterpolator","DS/VCXWebTracks/VCXInterpolatorLinear","DS/VCXWebTracks/VCXKey","DS/Visualization/ThreeJS_DS"],function(e,t,n,r,a){"use strict";return t.extend({init:function(){},GetType:function(){return"VCXInterpolatorSpherical"},setTargetPropertyName:function(e){this._targetPropertyName=e},setPositionPropertyName:function(e){this._positionPropertyName=e},setOrthoPropertyName:function(e){this._orthoPropertyName=e},setAnglePropertyName:function(e){this._anglePropertyName=e},setHeightPropertyName:function(e){this._heightPropertyName=e},GetInterpolatedValue:function(t,i,l,u){if(null===u){if(t){let e=t.GetProperty(this._positionPropertyName);if(e)return e.GetPropertyValue().GetValueFrame()}return null}var o=u[this._positionPropertyName],s=u[this._targetPropertyName];if(!o||!s){if(!o&&!s)return null;console.warn("Case not handled. Show this to ITY")}var y={keyInf:null,keySup:null};if(o&&o.GetKeysForLinearInterpolationREF(l,y),null===y.keyInf&&t){let e=t.GetProperty(this._positionPropertyName);e&&(y.keyInf=new r(null,null),y.keyInf.SetValue(e.GetPropertyValue()),y.keyInf.SetFrame(0))}var p=y.keyInf||y.keySup,f=y.keySup||y.keyInf;if(!p||!f)return null;var h=p.GetValue(),c=f.GetValue(),V=0;f.GetFrame()-p.GetFrame()&&(V=(l-p.GetFrame())/(f.GetFrame()-p.GetFrame())),o.easing&&(V=o.easing(V,0,1));var m,G,_,I,k=new n,C=k.GetInterpolatedValue(t,this._targetPropertyName,p.GetFrame(),u),S=k.GetInterpolatedValue(t,this._targetPropertyName,f.GetFrame(),u),F=C.GetInterpolatedValue(C,S,V),d=(new a.Matrix4).getInverse(C.GetValueFrame().Value).multiply(h.GetValueFrame().Value),v=(new a.Matrix4).getInverse(S.GetValueFrame().Value).multiply(c.GetValueFrame().Value),g=new e(d),P=new e(v),b=g.GetInterpolatedValue(g,P,V),X=(new a.Vector3).getPositionFromMatrix(g.Value).length();k.GetInterpolatedValue(t,this._orthoPropertyName,p.GetFrame(),u).Value?(G=k.GetInterpolatedValue(t,this._heightPropertyName,p.GetFrame(),u).Value,m=360*Math.atan(G/X)/Math.PI):(m=k.GetInterpolatedValue(t,this._anglePropertyName,p.GetFrame(),u).Value,G=Math.tan(.5*m*Math.PI/180)*X);var w=(new a.Vector3).getPositionFromMatrix(P.Value).length();k.GetInterpolatedValue(t,this._orthoPropertyName,f.GetFrame(),u).Value?(I=k.GetInterpolatedValue(t,this._heightPropertyName,f.GetFrame(),u).Value,_=360*Math.atan(I/w)/Math.PI):(_=k.GetInterpolatedValue(t,this._anglePropertyName,f.GetFrame(),u).Value,I=Math.tan(.5*_*Math.PI/180)*w);var x=m*(1-V)+_*V,T=(G*(1-V)+I*V)/Math.tan(.5*x*Math.PI/180);return b.Value.elements[14]=T,new e((new a.Matrix4).multiplyMatrices(F.GetValueFrame().Value,b.Value))}})}),define("DS/VCXWebTracks/VCXInterpolatorCylindrical",["DS/VCXWebTracks/VCXInterpolator","DS/VCXWebTracks/VCXInterpolatorLinear","DS/VCXWebTracks/VCXKey","DS/Visualization/ThreeJS_DS"],function(e,t,n,r){"use strict";return e.extend({init:function(){this._axis=[],this._axis[0]=0,this._axis[1]=0,this._axis[2]=0,this._axis[3]=0,this._axis[4]=0,this._axis[5]=1},GetType:function(){return"VCXInterpolatorCylindrical"},setAxisOrigin:function(e,t,n){this._axis[0]=e,this._axis[1]=t,this._axis[2]=n},setAxisDirection:function(e,t,n){this._axis[3]=e,this._axis[4]=t,this._axis[5]=n},setTargetPropertyName:function(e){this._centerPropertyName=e},setPositionPropertyName:function(e){this._positionPropertyName=e},GetInterpolatedValue:function(e,a,i,l){if(null===l)return null;l[this._centerPropertyName];var u=l[this._positionPropertyName],o={keyInf:null,keySup:null},s=(new t).GetInterpolatedValue(e,this._centerPropertyName,i,l).GetValueFrame().Value,y=(new r.Vector3).getPositionFromMatrix(s);this.setAxisOrigin(y.x,y.y,y.z);var p=null;if(u&&u.GetKeysForLinearInterpolationREF(i,o),null===o.keyInf&&e){var f=e.GetProperty(a);f&&(o.keyInf=new n(null,null),o.keyInf.SetValue(f.GetPropertyValue()),o.keyInf.SetFrame(0))}if(!o.keyInf)return null;if(o.keySup){var h=o.keyInf.GetValue(),c=o.keySup.GetValue(),V=(i-o.keyInf.GetFrame())/(o.keySup.GetFrame()-o.keyInf.GetFrame());u.easing&&(V=u.easing(V,0,1)),p=h.GetCylindricalInterpolatedValue(h,c,V,this._axis)}else p=o.keyInf.GetValue();return p?p.GetValueFrame():null}})});