define("DS/MPFCmsModel/ArticleModel",["DS/MPFModel/MPFModel"],function(t){"use strict";const e={CATEGORY:"category",MESSAGES:"messages",PUB_DATE:"pubdate",PUBLISHED:"published",SUMMARY:"enhanced_summary",THUMBNAIL_ID:"thumbnail_id",THUMBNAIL:"thumbnail",WITH_THUMBNAILS_INFO:"withThumbnailsInfo",TITLES:"titles",COMMUNITY_ID:"community_id",COMMUNITY_POST_ID:"community_post_id",URL:"url",LINKS:"links",META_KEYWORDS:"metaKeywords",META_DESCRIPTION:"metaDescription"},r=["en","fr","de","ja","ko","ru","zh"],s=t.extend({defaults:()=>({[e.MESSAGES]:{},[e.TITLES]:{},[e.LINKS]:[],[e.META_KEYWORDS]:[]}),setup(t,e){this._type="ArticleModel",this._parent(t,e)},parse(t){const r=t.result||t,s=JSON.parse(decodeURIComponent(window.atob(this._htmlDecode(r.message))));return[e.CATEGORY,e.MESSAGES,e.TITLES,e.URL,e.THUMBNAIL_ID,e.LINKS,e.META_KEYWORDS,e.META_DESCRIPTION].forEach(t=>{s[t]&&(r[t]=s[t])}),r},_htmlDecode:t=>(new window.DOMParser).parseFromString(t,"text/html").documentElement.textContent,toJSON(t){const r={},s={[e.MESSAGES]:this.get(e.MESSAGES),[e.TITLES]:this.get(e.TITLES),[e.CATEGORY]:this.get(e.CATEGORY),[e.LANGUAGES]:this.get(e.LANGUAGES),[e.URL]:this.get(e.URL),[e.THUMBNAIL_ID]:this.get(e.THUMBNAIL_ID),[e.LINKS]:this.get(e.LINKS),[e.META_KEYWORDS]:this.get(e.META_KEYWORDS),[e.META_DESCRIPTION]:this.get(e.META_DESCRIPTION)};return r.message=window.btoa(encodeURIComponent(JSON.stringify(s))),r.title=this.getTitle(this.getFirstAvailableLanguage()),r[e.PUBLISHED]=this.get(e.PUBLISHED),r[e.COMMUNITY_POST_ID]=this.get("id"),r[e.COMMUNITY_ID]=this.get(e.COMMUNITY_ID),{params:r}},getCommunityId(){return this.get(e.COMMUNITY_ID)},setMessage(t,r){const s=Object.assign({},this.get(e.MESSAGES),{[t.toLowerCase()]:r});this.set(e.MESSAGES,s)},getMessage(t){const r=this.get(e.MESSAGES);if("object"==typeof r&&(t=t||Object.keys(r)[0])&&r)return r[t]},eraseMessage(t){const r=this.get(e.MESSAGES),s=this.get(e.TITLES);"object"==typeof r&&r[t]&&(delete r[t],this.set(e.MESSAGES,r)),"object"==typeof s&&s[t]&&(delete s[t],this.set(e.TITLES,s))},getMessageInDefaultLanguage(){const t=this.getFirstAvailableLanguage();return t&&this.getMessage(t)},getLanguages(){const t=this.get(e.MESSAGES);return t&&Object.keys(t)||[]},hasLanguage(t){return this.getLanguages().includes(t)},getFirstAvailableLanguage(){const t=this.get(e.MESSAGES),s=Object.keys(t);if(!(s.length>0))return r[0];for(let t=0;t<r.length;t++){const e=r[t];if(s.includes(e))return e}},getCategory(){return this.get(e.CATEGORY)},setCategory(t){return this.set(e.CATEGORY,t)},getTitle(t){const r=this.get(e.TITLES);if("object"==typeof r)return(t=t||Object.keys(r)[0])&&r&&r[t.toLowerCase()]},setTitle(t,r){const s={...this.get(e.TITLES)};s[t.toLowerCase()]=r,this.set(e.TITLES,s)},isPublished(){return!!this.get(e.PUBLISHED)},setPublished(t){this.set(e.PUBLISHED,t?1:0)},getUrl(){return this.get(e.URL)},setUrl(t){return this.set(e.URL,t)},getLinks(){return this.get(e.LINKS)}});return s.Fields=Object.freeze(e),s.Languages=Object.freeze(r),s}),define("DS/MPFCmsModel/CategoryModel",["DS/MPFModel/MPFModel","DS/MPFError/NotImplementedError"],function(t,e){"use strict";const r={NAME:"name",INDEX:"index",NUMBER_ARTICLES:"numberArticles"},s=t.extend({setup(t,e){this._type="CategoryModel",this._parent(t,e)},savePromise:e.emit});return s.Fields=Object.freeze(r),s}),define("DS/MPFCmsModel/PublicArticleDataProxy",["DS/MPFDataProxy/DataProxy"],function(t){"use strict";return t.extend({init(t){this._parent(t,"/cmsproxy/public/posts")}})}),define("DS/MPFCmsModel/CategoryDataProxy",["DS/MPFDataProxy/DataProxy"],function(t){"use strict";return t.extend({init(t){this._parent(t,"/cmsproxy/informations")}})}),define("DS/MPFCmsModel/PublicCommunityInfoDataProxy",["DS/MPFUrl/UrlUtils","DS/MPFDataProxy/DataProxy"],function(t,e){"use strict";return e.extend({init(t){this._parent(t,"/cmsproxy/public/informations")},urlGet(e,r={}){if(e._models){var s=new t(this._computeDefaultUrl(e));return r.limit&&s.addParameter("limit",r.limit),r.page&&s.addParameter("page",r.page),s.getUrl()}return this._parent(e,r)}})}),define("DS/MPFCmsModel/CommunityInfoDataProxy",["DS/MPFDataProxy/DataProxy"],function(t){"use strict";return t.extend({init(t){this._parent(t,"/cmsproxy/informations")}})}),define("DS/MPFCmsModel/SwymCsrfTokenModel",["DS/MPFModel/MPFModel"],t=>{"use strict";const e={NB_RESULT:"nb_result",REQUEST_ID:"request_id",RESULT:"result",SOURCE_INFOS:"sourceInfos"},r="ServerToken",s=t.extend({setup(t,e){this._type="SwymCsrfTokenModel",this._parent(t,e)},getToken:function(){const t=this.get(e.RESULT);return t&&t[r]}});return s.Fields=Object.freeze(e),s}),define("DS/MPFCmsModel/CmsMediaModel",["DS/MPFModel/MPFModel"],function(t){"use strict";const e={MEDIA_ID:"id_media",PREVIEW:"preview",COMMUNITY_ID:"community_id",PUBLISHED:"published",USER_FILE:"userFile",DESCRIPTION:"description",IS_ILLUSTRATION:"is_illustration",TITLE:"title",MEDIA_TYPE:"media_type"},r=t.extend({setup(t,e){this._type="CmsMediaModel",this._parent(t,e)},parse:t=>t.result,getThumbnailUrl(t="m"){const r=this.get(e.PREVIEW),s=r.thumbnails&&r.thumbnails.find(e=>e.alias===t);return s&&s.transient_url},getPublicSrcUrl(){return this.dataProxy.getPublicSrcUrl(this)},getImageViewUrl(){const t=this.get("play");if(t){const e=t.download_original_url;if(e&&e.transient_url)return e.transient_url}},getOriginalImageUrl(){const t=this.get("play");if(t){const e=t.view;if(e&&e.length>0&&e[0].transient_url)return e[0].transient_url}},isIllustration(){return"1"===this.get(e.IS_ILLUSTRATION)}});return r.Fields=Object.freeze(e),r}),define("DS/MPFCmsModel/PublicCmsMediaDataProxy",["DS/MPFDataProxy/DataProxy"],function(t){"use strict";return t.extend({init(t){this._parent(t,"/cmsproxy/public/medias")},getPublicSrcUrl(t){return this.urlGet(t)}})}),define("DS/MPFCmsModel/SwymCsrfTokenDataProxy",["DS/MPFDataProxy/DataProxy","DS/MPFError/NotImplementedError"],(t,e)=>{"use strict";return t.extend({init:function(t){return this._parent(t,"/api/index/tk")},urlPost:e.emit,urlPut:e.emit,urlPatch:e.emit,urlDelete:e.emit,doPost:e.emit,doPut:e.emit,doPatch:e.emit,doDelete:e.emit})}),define("DS/MPFCmsModel/CommunityInfoModel",["DS/MPFModel/MPFModel"],function(t){"use strict";const e={CATEGORIES:"categories",COMMUNITY_ID:"communityId",USER:"user"},r=t.extend({defaults:{[e.CATEGORIES]:[]},setup(t,e){this._type="CommunityInfoModel",this._parent(t,e)},parse:t=>(""===t[e.CATEGORIES]||"empty"===t[e.CATEGORIES]?t[e.CATEGORIES]=[]:t[e.CATEGORIES]&&(t[e.CATEGORIES]=t[e.CATEGORIES].split(",")),"empty"===t[e.COMMUNITY_ID]&&delete t[e.COMMUNITY_ID],t),toJSON(t){const r=this._parent(t);return r[e.CATEGORIES]&&(r[e.CATEGORIES]=r[e.CATEGORIES].join(",")),r},getCommunityId(){return this.get(e.COMMUNITY_ID)},getCategories(){return this.get(e.CATEGORIES)},setCategories(t){return this.set(e.CATEGORIES,t)},hasCategory(t){return!!(this.getCategories()||[]).find(e=>e===t)},addCategory(t){const r=this.getCategories();r.push(t),this.set(e.CATEGORIES,r)}});return r.Fields=Object.freeze(e),r}),define("DS/MPFCmsModel/CommunityInfoFactory",["DS/MPFModelFactory/Factory","DS/MPFCmsModel/CommunityInfoModel","DS/MPFCmsModel/CommunityInfoDataProxy","DS/MPFCmsModel/PublicCommunityInfoDataProxy","DS/MPFError/NotImplementedError"],function(t,e,r,s,o){"use strict";const i={PUBLIC:"public",OPERATOR:"operator"},n=t.extend({createModel(t=i.PUBLIC,r,s){return this._parent(e,t,r,s)},createCollection:o.emit,getDataProxy(t){let e;switch(t){case i.PUBLIC:this.dataProxies[i.PUBLIC]||(this.dataProxies[i.PUBLIC]=new s(this.connector)),e=this.dataProxies[i.PUBLIC];break;case i.OPERATOR:this.dataProxies[i.OPERATOR]||(this.dataProxies[i.OPERATOR]=new r(this.connector)),e=this.dataProxies[i.OPERATOR]}return e}});return n.Types=i,n}),define("DS/MPFCmsModel/ArticleCollection",["DS/MPFCmsModel/ArticleModel","DS/MPFModel/MPFCollection"],function(t,e){"use strict";return e.extend({model:t,setup(t,e){this.constraints=e.constraints||null,this._parent(t,e)},parse:t=>t.result})}),define("DS/MPFCmsModel/CategoryCollection",["DS/MPFCmsModel/CategoryModel","DS/MPFModel/MPFCollection"],function(t,e){"use strict";return e.extend({model:t,comparator:t.Fields.INDEX,setup(t,e){this.constraints=e.constraints||null,this._parent(t,e)},parse(t){const e=t.categories;return e?e.split(","):[]}})}),define("DS/MPFCmsModel/CategoryFactory",["DS/MPFModelFactory/Factory","DS/MPFCmsModel/CategoryModel","DS/MPFCmsModel/CategoryCollection","DS/MPFCmsModel/CategoryDataProxy"],function(t,e,r,s){"use strict";const o={ARTICLE:"article"},i=t.extend({createModel(t=o.ARTICLE,r,s){return this._parent(e,t,r,s)},createCollection(t=o.ARTICLE,e,s){return this._parent(r,t,e,s)},getDataProxy(){return this.dataProxies[o.ARTICLE]||(this.dataProxies[o.ARTICLE]=new s(this.connector)),this.dataProxies[o.ARTICLE]}});return i.Types=o,i}),define("DS/MPFCmsModel/SwymArticleDataProxy",["UWA/String","DS/MPFUrl/UrlUtils","DS/MPFDataProxy/DataProxy","DS/MPFServices/ObjectService","DS/MPFCmsModel/ArticleModel","DS/MPFCmsModel/ArticleCollection","DS/MPFCmsModel/SwymCsrfTokenModel","DS/MPFCmsModel/SwymCsrfTokenDataProxy","DS/MPFError/BadArgumentError"],(t,e,r,s,o,i,n,a,c)=>{"use strict";const l="list",u="get",d="add",M="edit",P="delete";return r.extend({init:function(t){this._parent(t,"/api/post/{0}"),this.swymCsrfTokenDataProxy=new a(this.connector)},urlGet:function(e,r){let n;if(Object.prototype.isPrototypeOf.call(i.prototype,e)){s.requiredOfType(e.parentResourceId,"string","model.parentResourceId must be a string");let o=t.format(this.resourcePath,l)+"/community_id/"+e.parentResourceId;o+=r.limit?`/limit/${r.limit}`:"",o+=r.page?`/page/${r.page}`:"",n=this.connector.url(o)}else{if(!Object.prototype.isPrototypeOf.call(o.prototype,e))throw new c("model must be either an CmsPostModel or CmsPostCollection");{const s=t.format(this.resourcePath,u);r.data=JSON.stringify({params:{[o.Fields.COMMUNITY_ID]:e.get(o.Fields.COMMUNITY_ID),[o.Fields.COMMUNITY_POST_ID]:e.get(o.Fields.COMMUNITY_POST_ID)}}),n=this.connector.url(s)}}return n},urlPost:function(e,r){const s=t.format(this.resourcePath,d);return this.connector.url(s)},urlPut:function(e,r){const s=t.format(this.resourcePath,M);return this.connector.url(s)},urlPatch:function(e,r){const s=t.format(this.resourcePath,M);return this.connector.url(s)},urlDelete:function(e,r){const s=t.format(this.resourcePath,P);return r.data=JSON.stringify({params:{[o.Fields.COMMUNITY_ID]:e.get(o.Fields.COMMUNITY_ID),ids:[e.get("id")]}}),this.connector.url(s)},doGet(t,r){return new e(t).getPath().endsWith(u)&&(r.method="POST"),this._swymRequest(t,r)},doPost(t,e){return this._swymRequest(t,e)},doPut(t,e){return e.method="POST",this._swymRequest(t,e)},doPatch(t,e){return e.method="POST",this._swymRequest(t,e)},doDelete(t,e){return e.method="POST",this._swymRequest(t,e)},_swymRequest:function(t,e){const r=new n({},{dataProxy:this.swymCsrfTokenDataProxy});return r.fetchPromise().then(()=>(e.headers["X-DS-SWYM-CSRFTOKEN"]=r.getToken(),this.connector.request(t,e)))}})}),define("DS/MPFCmsModel/ArticleFactory",["DS/MPFModelFactory/Factory","DS/MPFCmsModel/ArticleModel","DS/MPFCmsModel/ArticleCollection","DS/MPFCmsModel/PublicArticleDataProxy","DS/MPFCmsModel/SwymArticleDataProxy"],(t,e,r,s,o)=>{"use strict";const i={SWYM:"swym",PUBLIC:"public"},n=t.extend({createModel:function(t=i.PUBLIC,r,s){return this._parent(e,t,r,s)},createCollection:function(t=i.PUBLIC,e,s){return this._parent(r,t,e,s)},getDataProxy:function(t){let e;switch(t){case i.PUBLIC:this.dataProxies[i.PUBLIC]||(this.dataProxies[i.PUBLIC]=new s(this.connector)),e=this.dataProxies[i.PUBLIC];break;case i.SWYM:this.dataProxies[i.SWYM]||(this.dataProxies[i.SWYM]=new o(this.connector)),e=this.dataProxies[i.SWYM]}return e}});return n.Types=Object.freeze(i),n}),define("DS/MPFCmsModel/SwymMediaDataProxy",["UWA/String","DS/MPFUrl/UrlUtils","DS/MPFDataProxy/DataProxy","DS/MPFCmsModel/CmsMediaModel","DS/MPFCmsModel/SwymCsrfTokenModel","DS/MPFCmsModel/SwymCsrfTokenDataProxy"],function(t,e,r,s,o,i){"use strict";const n="get",a="add",c="edit",l="delete";return r.extend({init({swymConnector:t,marketplaceConnector:e}){this._parent(t,"/api/media/{0}"),this.marketplaceConnector=e,this.swymCsrfTokenDataProxy=new i(this.connector)},getPublicSrcUrl(t){const e="/cmsproxy/public/medias/"+t.get("id");return this.marketplaceConnector.url(e)},urlGet:function(e,r){const o=t.format(this.resourcePath,n);return Object.prototype.isPrototypeOf.call(s.prototype,e)&&(r.data=JSON.stringify({params:{[s.Fields.MEDIA_ID]:e.get("id")}})),this.connector.url(o)},urlPost:function(e,r){const s=t.format(this.resourcePath,a);return this.connector.url(s)},urlPut:function(e,r){const s=t.format(this.resourcePath,c);return this.connector.url(s)},urlPatch:function(e,r){const s=t.format(this.resourcePath,c);return this.connector.url(s)},urlDelete:function(e,r){const s=t.format(this.resourcePath,l);return this.connector.url(s)},doPost(t,e){return this._swymRequest(t,e)},doGet:function(t,r){return new e(t).getPath().endsWith(n)&&(r.method="POST"),this._swymRequest(t,r)},_swymRequest:function(t,e){const r=new o({},{dataProxy:this.swymCsrfTokenDataProxy});return r.fetchPromise().then(()=>(e.headers["X-DS-SWYM-CSRFTOKEN"]=r.getToken(),this.connector.request(t,e)))}})}),define("DS/MPFCmsModel/CmsMediaFactory",["DS/MPFError/NotImplementedError","DS/MPFModelFactory/Factory","DS/MPFCmsModel/CmsMediaModel","DS/MPFCmsModel/PublicCmsMediaDataProxy","DS/MPFCmsModel/SwymMediaDataProxy"],function(t,e,r,s,o){"use strict";const i={PUBLIC:"public",SWYM:"swym"},n=e.extend({init({swymConnector:t,marketplaceConnector:e},r={}){this.swymConnector=t,this.marketplaceConnector=e,this.cache=r.cache,this.dataProxies={}},createModel(t=i.PUBLIC,e,s){return this._parent(r,t,e,s)},createCollection:t.emit,getDataProxy(t){let e;return t===i.PUBLIC?(this.dataProxies[i.PUBLIC]||(this.dataProxies[i.PUBLIC]=new s(this.marketplaceConnector)),e=this.dataProxies[i.PUBLIC]):i.SWYM&&(this.dataProxies[i.SWYM]||(this.dataProxies[i.SWYM]=new o({swymConnector:this.swymConnector,marketplaceConnector:this.marketplaceConnector})),e=this.dataProxies[i.SWYM]),e}});return n.Types=i,n});