define("DS/CfgConfigurationRevisionUX/scripts/controller/CfgConfigurationRevisionUtility",["DS/CfgBaseUX/scripts/CfgUtility","i18n!DS/CfgBaseUX/assets/nls/CfgBaseUXNLS"],function(e,i){var t={saveConfigurationRevisionContent:function(n,o,s){e.setInstanceContentForConfigurationRevision(n,o,[]).then(function(){let n=s?`${i.CfgCRSetContentSuccess}. ${i.CfgPartialCRContentAlreadySaved}`:`${i.CfgCRSetContentSuccess}`;e.showwarning(n,"success"),t.sendEvtToWIW("OK",s?"PartialCRContentAlreadySaved":"CommandSuccess")},function(n){let o="CommandFailure";"104"===n.errorID?(e.showwarning(i.CfgCantAddCAControlledInstanceToCR,"error"),o="CfgCantAddCAControlledInstanceToCR"):"199"===n.errorID?(e.showwarning(i.CfgCantAddEffectivityConstrainedCAInstanceToCR,"error"),o="CfgCantAddEffectivityConstrainedCAInstanceToCR"):n&&n.errorMessage&&(n.errorMessage.includes("The current ConfigurationRevision is not Private or In Work")||n.errorMessage.includes("The current ConfigurationRevision is not modifiable by the current user"))?(e.showwarning(i.CfgCRErrorIncorrectMaturity,"error"),o="CfgCRErrorIncorrectMaturity"):n&&n.errorMessage&&n.errorMessage.includes("The input object is not a ConfiguredBaseline")?(e.showwarning(i.CfgCRErrorNonCRObject,"error"),o="CfgCRErrorNonCRObject"):e.showwarning(i.CfgCRSetContentFail,"error"),t.sendEvtToWIW("KO",o)})},sendEvtToWIW(i,t){if("undefined"!=typeof dscef){let n={eventName:"cfgAddInstancesToCR",operation:i,operationVersion:"1.0",content:{messageID:t}};e.sendNotificationWebInWin(n)}}};return t}),define("DS/CfgConfigurationRevisionUX/scripts/views/CfgRevSelectorView",["UWA/Core","UWA/Class/View","DS/CfgBaseUX/scripts/CfgCAListView","DS/CfgBaseUX/scripts/CfgCAListController","i18n!DS/CfgBaseUX/assets/nls/CfgBaseUXNLS","DS/CfgBaseUX/scripts/CfgUXEnvVariables","text!DS/CfgBaseUX/assets/CfgRevSelectorColumns.json","text!DS/CfgBaseUX/assets/CfgUXEnvVariables.json","css!DS/CfgConfigurationRevisionUX/styles/CfgConfigurationRevisionUX.css"],function(e,i,t,n,o,s,a,c){"use strict";return i.extend({tagName:"div",className:"selector-view-container",init:function(e){this._parent(e);var i=JSON.parse(a).CfgRevSelectorColumns;if(this.cfgUXEnvVariablesJS=s.getCfgUXEnvVariables(),this.displayCompactMode=null==this.options.displayCompactMode||null==this.options.displayCompactMode||0!=this.options.displayCompactMode,this.caSelectorData=e.caSelectorData,this.defaultCASelectorColumns=[{text:o.CfgLabelTitle,alwaysVisibleFlag:!0,editableFlag:!1,pinned:"left",dataIndex:"tree"},{text:o.CfgLabelName,editableFlag:!1,dataIndex:"name",visibleFlag:i.isNameVisible},{text:o.CfgLabelMaturity,editableFlag:!1,dataIndex:"maturity",visibleFlag:i.isMaturityVisible},{text:o.CfgLabelDescription,editableFlag:!1,dataIndex:"description",visibleFlag:i.isDescriptionVisible},{text:o.CfgLabelCreationDate,editableFlag:!1,dataIndex:"creationDate",visibleFlag:i.isCreationDateVisible}],this.options.isCFGRoleAvail){var t={icon:{iconName:"list-add",fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"1x"},callback:function(e){e.calledFrom="action",n.addToSummaryView(e)}};if(this.action=[t],1===this.action.length){this.action[0].icon;this.defaultCASelectorColumns.push({text:o.CfgAction,editableFlag:!1,dataIndex:"action",typeRepresentation:"functionIcon",visibleFlag:i.isActionVisible})}}},addCfgRevObjectsToSelectorView:function(e){this.cfgRevSelectorView.addObjectsToView(e)},removeAllCfgRevObjectsFromSelectorView:function(){this.cfgRevSelectorView.removeAllObjectsFromView()},render:function(e){if(this.container&&this.container.empty(),this.options.isCFGRoleAvail&&1===this.action.length){let i=this.defaultCASelectorColumns.findIndex(e=>e.text===o.CfgAction);this.defaultCASelectorColumns[i].getCellSemantics=(i=>{let t={iconName:"list-add",fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"1x"},n={iconName:"block",fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"1x"};return{icon:"local"!==i.nodeModel.getAttributeValue("type")||e.isCRFrozenState?n:t}})}return this.cfgRevSelectorView=new t({headerLabel:o.CfgLabelSelectCA,mode:"caSelectorView",columns:this.defaultCASelectorColumns,modelData:this.caSelectorData,touchMode:!this.displayCompactMode,isFrozenRevision:e.isCRFrozenState,action:this.action,isCFGRoleAvail:this.options.isCFGRoleAvail}),this.container.appendChild(this.cfgRevSelectorView.render()),this.container}})}),define("DS/CfgConfigurationRevisionUX/scripts/views/instance/CfgCRCompositionVersionExplorerView",["UWA/Class/View","DS/CfgBaseUX/scripts/CfgConfigurationRevisionFactory","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgBaseUX/scripts/CfgData","i18n!DS/CfgBaseUX/assets/nls/CfgBaseUXNLS","css!DS/CfgConfigurationRevisionUX/styles/CfgCRCompositionVersionExplorerViewStyle.css"],function(e,i,t,n,o){"use strict";return e.extend({className:"cfg-cr-composition-versionexplorerview",init:async function(e){this._parent(e),this.displayCompactMode=!this.options.displayCompactMode||0!=this.options.displayCompactMode,this.CfgCRCompositionFactoryObj=new i,this.options.callBackFunction=(()=>this.pubSubEvents()),await this.CfgCRCompositionFactoryObj.create(this.options.physicalIDOfProduct,this.options.callBackFunction,enoviaServerFilterWidget.tenant,enoviaServerFilterWidget.baseURL,enoviaServerFilterWidget.getSecurityContext(),this.container,this.options.crVersionToBeSelectedInVEObj,this.CfgCRCompositionFactoryObj.vEObject)},render:function(){return this.container},pubSubEvents:function(){this.CfgCRCompositionFactoryObj.getVEObject().subscribeEvent("select",e=>n.cfgCRCompositionActionEvents.publish({event:"selectionInCRCompositionDialog",data:e})),this.CfgCRCompositionFactoryObj.getVEObject().subscribeEvent("unselect",e=>n.cfgCRCompositionActionEvents.publish({event:"unselectionInCRCompositionDialog"}))},saveCRCompositionContent:async function(e,i,n){let o;return!e&&i&&n?o=await t.addCRComposition(i,n):e&&!i&&n?o=await t.removeCRComposition(e,n):e&&i&&n&&(o=await t.modifyCRComposition(e,i,n)),o}})}),define("DS/CfgConfigurationRevisionUX/scripts/views/CfgRevSummaryView",["UWA/Core","UWA/Class/View","DS/CfgBaseUX/scripts/CfgData","DS/CoreEvents/ModelEvents","DS/CfgBaseUX/scripts/CfgCAListView","DS/Controls/Button","i18n!DS/CfgBaseUX/assets/nls/CfgBaseUXNLS","DS/CfgBaseUX/scripts/CfgCAListController","DS/CfgBaseUX/scripts/CfgUXEnvVariables","text!DS/CfgBaseUX/assets/CfgRevSelectorColumns.json","text!DS/CfgBaseUX/assets/CfgUXEnvVariables.json","css!DS/CfgConfigurationRevisionUX/styles/CfgConfigurationRevisionUX.css"],function(e,i,t,n,o,s,a,c,r,l,d){"use strict";return i.extend({tagName:"div",className:"summary-view-container",init:function(e){var i=this;this._parent(e);var o=JSON.parse(l).CfgRevSummaryColumns;if(this.cfgUXEnvVariablesJS=r.getCfgUXEnvVariables(),this.displayCompactMode=null==this.options.displayCompactMode||null==this.options.displayCompactMode||0!=this.options.displayCompactMode,this.caSummaryData=e.caSummaryData,this.defaultCASummaryColumns=[{text:a.CfgLabelType,alwaysVisibleFlag:!1,editableFlag:!1,pinned:"left",dataIndex:"typeIcon",typeRepresentation:"icon",width:"30",visibleFlag:o.isTypeIconVisible},{text:a.CfgLabelTitle,alwaysVisibleFlag:!0,editableFlag:!1,pinned:"left",dataIndex:"tree",getCellClassName:function(e){if(e.nodeModel&&e.nodeModel.isRoot())return"cfgcr-title-bold"}},{text:a.CfgLabelName,editableFlag:!1,dataIndex:"name",visibleFlag:o.isNameVisible},{text:a.CfgLabelFrom,editableFlag:!1,dataIndex:"from",visibleFlag:o.isFromVisible,getCellValue:function(e){if(e.nodeModel){var t=e.nodeModel.getAttributeValue("from");if(!i.cfgUXEnvVariablesJS.isCRGroupByEnabled&&""===t){var n=e.nodeModel.getAttributeValue("type");t="inherited"===n.toLowerCase()?n.charAt(0).toUpperCase()+n.slice(1):""}return t}}},{text:a.CfgLabelMaturity,editableFlag:!1,dataIndex:"maturity",visibleFlag:o.isMaturityVisible},{text:a.CfgLabelCreationDate,editableFlag:!1,dataIndex:"creationDate",visibleFlag:o.isCreationDateVisible}],this.options.isCFGRoleAvail){let e={icon:{iconName:"remove",fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"1x"},callback:function(e){e.calledFrom="action",c.oncaSummaryRemove(e)}};this.action=[e],1===this.action.length&&this.defaultCASummaryColumns.push({text:a.CfgAction,editableFlag:!1,dataIndex:"functionToCall",typeRepresentation:"functionIcon",visibleFlag:o.isActionVisible})}t.clear(),t.cfgRevCASummaryActionEvents=new n,this.pubSubEvents()},addCfgRevObjectsToSummaryView:function(e){this.cfgRevSummaryView.addObjectsToView(e)},removeAllCfgRevObjectsFromSummaryView:function(){this.cfgRevSummaryView.removeAllObjectsFromView()},getChangeActionsFromSummaryView:function(){return this.cfgRevSummaryView.getAllCAIdsList()},render:function(e){if(this.container&&this.container.empty(),this.action&&1===this.action.length){let i=this.defaultCASummaryColumns.findIndex(e=>e.text===a.CfgAction);this.defaultCASummaryColumns[i].getCellSemantics=(i=>{let t={iconName:"remove",fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"1x"},n={iconName:"block",fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"1x"};return{icon:"local"!==i.nodeModel.getAttributeValue("type")||e.isCRFrozenState?n:t}})}return this.cfgRevSummaryView=new o({headerLabel:a.CfgLabelChangeActions,isHeaderAllowed:e.isHeaderAllowed,mode:"caSummaryView",columns:this.defaultCASummaryColumns,modelData:this.caSummaryData,touchMode:!this.displayCompactMode,isFrozenRevision:e.isCRFrozenState,filterView:e.filterView,filterImplicitView:e.filterImplicitView,action:this.action,isCFGRoleAvail:this.options.isCFGRoleAvail}),this.container.appendChild(this.cfgRevSummaryView.render()),this.container},pubSubEvents:function(){this.cfgUXEnvVariablesJS.isCRGroupByEnabled&&(t.cfgRevCASummaryActionEvents.subscribe({event:"updateTheSummaryCAViewWithTheCount"},e=>{this.cfgRevSummaryView.dataGridView.getTreeDocument().getRoots().forEach(i=>{i._options.label.includes(a.CfgRevLabelUserDefined)&&i.updateOptions({label:`${a.CfgRevLabelUserDefined} (${e})`})})}),t.cfgRevCASummaryActionEvents.subscribe({event:"updateTheSummaryViewImplicitCAWithTheCount"},e=>{this.cfgRevSummaryView.dataGridView.getTreeDocument().getRoots().forEach(i=>{i._options.label.includes(a.CfgRevLabelImplicit)&&i.updateOptions({label:`${a.CfgRevLabelImplicit} (${e})`})})}))}})}),define("DS/CfgConfigurationRevisionUX/scripts/model/instance/CfgConfigurationRevisionInstanceModel",["UWA/Class/Model","i18n!DS/CfgBaseUX/assets/nls/CfgBaseUXNLS"],function(e,i){return e.extend({defaults:function(){return{id:"",type:"",instanceType:"",title:"",name:"",description:"",creator:"",owner:"",from:"",maturity:"",creationDate:"",modificationDate:"",severity:"",statusbaractions:[],statusbaractionsTooltips:[],thumbnail:"",icons:"",customTooltip:"",implicitObjects:[]}},update:function(){this.set("customTooltip",i.CfgLabelTitle+" : "+this.get("title")+"\n"+i.CfgLabelName+" : "+this.get("name")+"\n"+i.CfgLabelSeverity+" : "+this.get("severity")+"\n"+i.CfgLabelOwner+" : "+this.get("creator")+"\n"+i.CfgLabelMaturity+" : "+this.get("maturity")),"user"!=this.get("type")&&"local"!=this.get("type")||this.set("typeIcon","user"),"implicit"==this.get("type")&&this.set("typeIcon","open"),"inherited"==this.get("type")&&this.set("typeIcon","change-action-proposed")},toJson:function(){return this.toJSON()}})}),define("DS/CfgConfigurationRevisionUX/scripts/controller/instance/CfgConfigurationRevisionInstanceListViewController",["DS/CfgBaseUX/scripts/CfgData"],function(e){"use strict";return{onInstanceSummaryAdd:function(e){},onInstanceSummaryRemove:function(i){var t=[];if("action"!==i.calledFrom){i.context.executionContext.treeDocument.prepareUpdate(),i.context.executionContext.treeDocument.getSelectedNodes().forEach(function(e){"implicit"!=e.options.grid.type&&(i.context.executionContext.treeDocument.removeRoot(e),t.push(e.options.grid.id))}),i.context.executionContext.treeDocument.pushUpdate()}else{var n=i.context.nodeModel;n.prepareUpdate(),n.getTreeDocument().getSelectedNodes().forEach(function(e){"implicit"!=e._options.grid.type&&(n.getTreeDocument().removeRoot(e),t.push(e._options.grid.id))}),n.pushUpdate()}e.cfgRevActionEvents.publish({event:"removeSelectionFromCfgRevInstanceSummaryView",data:t})},onToggleInherited:function(i){i.context&&(1==i.context.value?e.cfgRevActionEvents.publish({event:"showInheritedOnCfgRevInstanceSummaryView"}):e.cfgRevActionEvents.publish({event:"hideInheritedOnCfgRevInstanceSummaryView"}))}}}),define("DS/CfgConfigurationRevisionUX/scripts/views/instance/toolbar/CfgConfigurationRevisionInstanceListViewToolbar",["DS/PlatformAPI/PlatformAPI","DS/CoreEvents/ModelEvents","DS/CfgBaseUX/scripts/CfgData","DS/CfgBaseUX/scripts/CfgUXEnvVariables","i18n!DS/CfgBaseUX/assets/nls/CfgBaseUXNLS","text!DS/CfgBaseUX/assets/CfgUXEnvVariables.json","DS/CfgBaseUX/scripts/CfgToggleIconTypeRepresentation"],function(e,i,t,n,o,s,a){var c=Object.create(null);return c.toolbar=null,c.writeToolbarDefination=function(e){c.options=e,c.showInherited="showInherited"===e.filterView;var s=!0;c.cfgUXEnvVariablesJS=n.getCfgUXEnvVariables(),!e.isFrozenCR&&e.isCFGRoleAvail||(s=!1);var r={entries:[{id:"cfgCRInstanceListRemove",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"remove",fontIconFamily:1},action:{module:"DS/CfgConfigurationRevisionUX/scripts/controller/instance/CfgConfigurationRevisionInstanceListViewController",func:"onInstanceSummaryRemove"},tooltip:o.CfgLabelRemoveInstance,visibleFlag:s},disabled:!0,position:"far"}],typeRepresentations:{}};if(c.cfgUXEnvVariablesJS.showInheritedToggleForInstances){let e={id:"toggleInheritedInstances",dataElements:{typeRepresentation:"toggleInstancesIcon",value:c.showInherited,tooltip:o.CfgLabelInherited},onNodeUpdate:{module:"DS/CfgConfigurationRevisionUX/scripts/controller/instance/CfgConfigurationRevisionInstanceListViewController",func:"onToggleInherited"},position:"far"};r.entries.push(e);let i={icon:"3dproduct-insert",iconFamily:WUXManagedFontIcons.Font3DS,iconSize:"2x",customTypeRep:"toggleInstancesIcon",cssClasses:["toggle-icon"]};a.toggleIconInToolbar(i)}return t.clear(),t.cfgRevInstanceListViewToolbarActionEvents=new i,c.pubSubEvents(),JSON.stringify(r)},c.activeInactiveToggleInheritedInstanceIcon=function(e){c.toolbarActionBar.getNodeModelByID("toggleInheritedInstances").updateOptions({grid:{data:e}})},c.pubSubEvents=function(){e.subscribe("CfgCRInstanceListSelection",function(e){"instanceSummaryView"==e.mode&&c.enableDisableButton(e.flag)}),e.subscribe("CfgCRInstanceListUnselection",function(e){"instanceSummaryView"==e.mode&&c.enableDisableButton(e.flag)}),t.cfgRevInstanceListViewToolbarActionEvents.subscribe({event:"CfgRevToggleInheritedInstanceDialogCancelClicked"},function(e){c.activeInactiveToggleInheritedInstanceIcon(e)})},c.enableDisableButton=function(e){c.toolbarActionBar,c.toolbarActionBar.updateNodeModel("cfgCRInstanceListRemove",{disabled:e})},c}),define("DS/CfgConfigurationRevisionUX/scripts/views/CfgRevEmptyView",["UWA/Class/View","DS/Controls/Button","DS/Handlebars/Handlebars4","DS/CfgBaseUX/scripts/CfgData","DS/CfgBaseUX/scripts/CfgUtility","DS/DataDragAndDrop/DataDragAndDrop","DS/ENOXEmptyContent/js/ENOXEmptyContent","i18n!DS/CfgBaseUX/assets/nls/CfgBaseUXNLS","css!DS/CfgConfigurationRevisionUX/styles/CfgConfigurationRevisionUX.css"],function(e,i,t,n,o,s,a,c){"use strict";return e.extend({tagName:"div",className:"empty-view-container",init:function(e){this._parent(e),this.displayCompactMode=null==this.options.displayCompactMode||null==this.options.displayCompactMode||0!=this.options.displayCompactMode,this.displayCompactMode=!1},render:function(){return this.container&&this.container.empty(),this.selectCAButton=new i({label:c.CfgLabelSelectCA,emphasize:"primary",touchMode:!this.displayCompactMode,onClick:function(){n.cfgRevActionEvents.publish({event:"loadCfgRevSelectionView",data:{caids:null}})}}),this._ENOXEmptyContent=new a({sentences:[{type:"dom",DOMelement:this.selectCAButton.getContent()},{type:"icon",fonticon:"drag-drop",text:c.CfgLabelDragHereToAdd}]}),this._ENOXEmptyContent.inject(this.container),this.makeDroppable(this.container),this.container},makeDroppable:function(e){var i=this;s.droppable(e,{drop:function(t,s,a){if(i.options.isCFGRoleAvail&&(a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault(),UWA.is(t)&&""!=t)){var c=JSON.parse(t);n.subTypeInfo&&n.subTypeInfo.changeAction?i.postProcessDragAndDrop(c,e):o.getSubTypeInfo('["Change Action"]').then(function(t){n.subTypeInfo={changeAction:t},i.postProcessDragAndDrop(c,e)},function(e){console.log("get TypeInfo API failed, Error : "+e)})}},over:function(){e.addClassName("dropOverEmptyView")},leave:function(){e.removeClassName("dropOverEmptyView")}})},postProcessDragAndDrop:function(e,i){var t=[];e.data.items.forEach(function(e){var s=e.objectId,a=e.objectType;n.subTypeInfo.changeAction[a]?t.push(s):(i.removeClassName("dropOverEmptyView"),o.showwarning(c.CfgLabelNonCADropMsg,"warning"))}),t.length>0&&n.cfgRevActionEvents.publish({event:"loadCfgRevSummaryView",data:{caids:t}})}})}),define("DS/CfgConfigurationRevisionUX/scripts/model/CfgRevModel",["UWA/Class/Model","i18n!DS/CfgBaseUX/assets/nls/CfgBaseUXNLS"],function(e,i){return e.extend({defaults:function(){return{id:"",type:"",title:"",name:"",description:"",creator:"",from:"",maturity:"",creationDate:"",severity:"",statusbaractions:[],statusbaractionsTooltips:[],thumbnail:"",icons:"",customTooltip:"",implicitObjects:[]}},update:function(){this.set("customTooltip",i.CfgLabelTitle+" : "+this.get("title")+"\n"+i.CfgLabelName+" : "+this.get("name")+"\n"+i.CfgLabelSeverity+" : "+this.get("severity")+"\n"+i.CfgLabelOwner+" : "+this.get("creator")+"\n"+i.CfgLabelMaturity+" : "+this.get("maturity")),"user"!=this.get("type")&&"local"!=this.get("type")||this.set("typeIcon","user"),"implicit"==this.get("type")&&this.set("typeIcon","open"),"inherited"==this.get("type")&&this.set("typeIcon","change-action-proposed")},toJson:function(){return this.toJSON()}})}),define("DS/CfgConfigurationRevisionUX/scripts/views/instance/CfgConfigurationRevisionVersionExplorerView",["UWA/Class/View","DS/CfgBaseUX/scripts/CfgConfigurationRevisionFactory","DS/CfgConfigurationRevisionUX/scripts/controller/CfgConfigurationRevisionUtility","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgBaseUX/scripts/CfgData","i18n!DS/CfgBaseUX/assets/nls/CfgBaseUXNLS","css!DS/CfgConfigurationRevisionUX/styles/CfgConfigurationRevisionVersionExplorerViewStyle.css"],function(e,i,t,n,o,s){"use strict";return e.extend({className:"cfg-configurationrevision-versionexplorerview",init:function(e){this._parent(e),this.displayCompactMode=!this.options.displayCompactMode||0!=this.options.displayCompactMode,this.CfgConfigurationRevisionFactoryObj=new i,this.options.callBackFunction=(()=>this.pubSubEvents()),this.CfgConfigurationRevisionFactoryObj.create(this.options.iRootId,this.options.callBackFunction,enoviaServerFilterWidget.tenant,enoviaServerFilterWidget.baseURL,enoviaServerFilterWidget.getSecurityContext(),this.container,null)},render:function(){return this.container},pubSubEvents:function(){this.CfgConfigurationRevisionFactoryObj.getVEObject().subscribeEvent("select",e=>o.cfgAddInsToCfgRevActionEvents.publish({event:"enableOkButtonInInstanceCRDialog"})),this.CfgConfigurationRevisionFactoryObj.getVEObject().subscribeEvent("unselect",e=>o.cfgAddInsToCfgRevActionEvents.publish({event:"disableOkButtonInInstanceCRDialog"}))},saveContent:function(){let e=this.CfgConfigurationRevisionFactoryObj.getVEObject().getSelectedNodes();if(0==e.length)n.showwarning(s.CfgCRErrorNoObjectSelected,"warning");else{let i=e[0]._getID();n.getContentForConfigurationRevision(i,!0).then(e=>{let n=[...e.instanceDefinition.localInstances,...e.instanceDefinition.inheritedInstances],o=this.options.selectedInstanceList.map(e=>e.instanceId),s=this.instanceMatch(n,o);t.saveConfigurationRevisionContent(i,o,s)},e=>n.showwarning(s.CfgCRSetContentFail,"error"))}},instanceMatch:function(e,i){let t=[];for(let n=0;n<i.length;++n)for(let o=0;o<e.length;++o)i[n]===e[o]&&t.push(i[n]);return t.length>0}})}),define("DS/CfgConfigurationRevisionUX/scripts/model/CfgRevCollection",["UWA/Class/Collection","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgConfigurationRevisionUX/scripts/model/CfgRevModel","i18n!DS/CfgBaseUX/assets/nls/CfgBaseUXNLS"],function(e,i,t,n){return e.extend({model:t,_isReady:!1,isReady:function(){return this._isReady},getAllModelsIDArray:function(){var e=[];return this.forEach(function(i){e.push(i.get("id"));var t=i.get("implicitObjects");t&&t.length>0&&t.forEach(function(i){e.push(i.get("id"))})}),e},getRootModelsIDArray:function(){var e=[];return this.forEach(function(i){e.push(i.get("id"))}),e},getRootModelsArray:function(){return this.toArray()},build:function(e,i){var n=this;"summary"==i?(e.changeDefinition&&Array.isArray(e.changeDefinition.localChangeAction)&&e.changeDefinition.localChangeAction.forEach(function(e){var i=new t;i.set("id",e.identifier),i.set("type","local"),n.add(i),Array.isArray(e.implicitChangeAction)&&(implicit_ca_array=[],e.implicitChangeAction.forEach(function(i){var n=new t;n.set("id",i),n.set("type","implicit"),n.set("from",e.identifier),implicit_ca_array.push(n)}),i.set("implicitObjects",implicit_ca_array))}),e.droppedChangesList&&e.droppedChangesList.forEach(function(e){var i=new t;i.set("id",e),i.set("type","local"),n.add(i)}),e.changeDefinition&&Array.isArray(e.changeDefinition.inheritedChangeAction)&&e.changeDefinition.inheritedChangeAction.forEach(function(e){var i=new t;i.set("id",e),i.set("type","inherited"),n.add(i)})):"selector"==i&&e.relevantChangeActions&&Array.isArray(e.relevantChangeActions)&&e.relevantChangeActions.forEach(function(e){var i=new t;i.set("id",e.identifier),i.set("type","local"),n.add(i),Array.isArray(e.implicitChangeAction)&&(implicit_ca_array=[],e.implicitChangeAction.forEach(function(i){var n=new t;n.set("id",i),n.set("type","implicit"),n.set("from",e.identifier),implicit_ca_array.push(n)}),i.set("implicitObjects",implicit_ca_array))})},update:function(e){this.forEach(function(t){e.results.forEach(function(o){o.attributes.forEach(function(s){if("resourceid"==s.name&&s.value==t.get("id")){o.attributes.forEach(function(e){if("ds6w:identifier"==e.name&&t.set("name",e.value),"ds6w:label"!=e.name&&"ds6wg:marketing_Name"!=e.name||t.set("title",e.value),"ds6w:description"==e.name&&t.set("description",e.value),"ds6w:who/ds6w:responsible"==e.name&&t.set("creator",e.value),"current"==e.name){var s=e.value;s=("CfgLabel"+s).replace(/ /g,"");let i=o.attributes.find(e=>"ECM_CHG_ON_HOLD"===e.name);s=i&&"TRUE"===i.value?n[s]+" ["+n.CfgLabelOnHold+"]":n[s],t.set("maturity",s)}if("ds6w:when/ds6w:created"==e.name&&t.set("creationDate",i.formatDate(e.value,"%m-%d-%Y, %I:%M:%S %p")),"preview_url"==e.name&&t.set("thumbnail",e.value),"type_icon_url"==e.name&&t.set("icons",e.value),"ds6w:why/ds6w:fulfills/ds6w:severity"==e.name){var a=e.value,c=[],r=[];"Low"===a&&(c.push("level-low"),r.push(n.CfgLabelLow)),"Medium"===a&&(c.push("level-medium"),r.push(n.CfgLabelMedium)),"High"===a&&(c.push("level-high"),r.push(n.CfgLabelHigh)),t.set("severity",n["CfgLabel"+a]),t.set("statusbaractions",c),t.set("statusbaractionsTooltips",r)}});var a=t.get("implicitObjects");a&&a.length>0&&a.forEach(function(o){e.results.forEach(function(e){e.attributes.forEach(function(s){"resourceid"==s.name&&s.value==o.get("id")&&(e.attributes.forEach(function(t){if("ds6w:identifier"==t.name&&o.set("name",t.value),"ds6w:label"!=t.name&&"ds6wg:marketing_Name"!=t.name||o.set("title",t.value),"ds6w:description"==t.name&&o.set("description",t.value),"ds6w:who/ds6w:responsible"==t.name&&o.set("creator",t.value),"current"==t.name){var s=t.value;s=("CfgLabel"+s).replace(/ /g,"");let i=e.attributes.find(e=>"ECM_CHG_ON_HOLD"===e.name);s=i&&"TRUE"===i.value?n[s]+" ["+n.CfgLabelOnHold+"]":n[s],o.set("maturity",s)}if("ds6w:when/ds6w:created"==t.name&&o.set("creationDate",i.formatDate(t.value,"%m-%d-%Y, %I:%M:%S %p")),"preview_url"==t.name&&o.set("thumbnail",t.value),"type_icon_url"==t.name&&o.set("icons",t.value),"ds6w:why/ds6w:fulfills/ds6w:severity"==t.name){var a=t.value,c=[],r=[];"Low"===a&&(c.push("level-low"),r.push(n.CfgLabelLow)),"Medium"===a&&(c.push("level-medium"),r.push(n.CfgLabelMedium)),"High"===a&&(c.push("level-high"),r.push(n.CfgLabelHigh)),o.set("severity",n["CfgLabel"+a]),o.set("statusbaractions",c),o.set("statusbaractionsTooltips",r)}}),o.set("from",t.get("title")),o.update())})})}),t.update()}})})}),this._isReady=!0}})}),define("DS/CfgConfigurationRevisionUX/scripts/views/CfgConfigurationRevisionMainView2",["UWA/Class/View","DS/CfgConfigurationRevisionUX/scripts/views/CfgRevEmptyView","DS/CfgConfigurationRevisionUX/scripts/views/CfgRevSelectorView","DS/CfgConfigurationRevisionUX/scripts/views/CfgRevSummaryView","css!DS/CfgConfigurationRevisionUX/styles/CfgConfigurationRevisionUX.css"],function(e,i,t,n){"use strict";return e.extend({tagName:"div",className:"cfg-rev-main-view-container",init:function(e){this._parent(e),this.emptyView=new i({displayCompactMode:this.options.displayCompactMode,isCFGRoleAvail:this.options.isCFGRoleAvail}),this.summaryView=new n({displayCompactMode:this.options.displayCompactMode,caSummaryData:{changeActions:[]},isCFGRoleAvail:this.options.isCFGRoleAvail})},render:function(e){return this.container&&this.container.empty(),this.container.appendChild(this.emptyView.render()),this.emptyView.hide(),this.container.appendChild(this.summaryView.render(e)),this.summaryView.hide(),this.container},loadCfgRevEmptyView:function(){this.summaryView.hide(),this.emptyView.show()},loadCfgRevSummaryView:function(e){if(this.emptyView.hide(),this.summaryView.show(),e&&e.cfgRevObjects){this.summaryView.removeAllCfgRevObjectsFromSummaryView();let i=e.cfgRevObjects.filter(e=>"local"===e._attributes.type),t=e.cfgRevObjects.filter(e=>"inherited"===e._attributes.type);e.cfgRevObjects=[...i,...t],this.summaryView.addCfgRevObjectsToSummaryView(e.cfgRevObjects)}}})}),define("DS/CfgConfigurationRevisionUX/scripts/views/CfgConfigurationRevisionMainView",["UWA/Class/View","DS/CfgConfigurationRevisionUX/scripts/views/CfgRevEmptyView","DS/CfgConfigurationRevisionUX/scripts/views/CfgRevSelectorView","DS/CfgConfigurationRevisionUX/scripts/views/CfgRevSummaryView","css!DS/CfgConfigurationRevisionUX/styles/CfgConfigurationRevisionUX.css"],function(e,i,t,n){"use strict";return e.extend({tagName:"div",className:"cfg-rev-main-view-container",init:function(e){this._parent(e),this.emptyView=new i({displayCompactMode:this.options.displayCompactMode,isCFGRoleAvail:this.options.isCFGRoleAvail}),this.selectorView=new t({displayCompactMode:this.options.displayCompactMode,caSelectorData:{changeActions:[]},isCFGRoleAvail:this.options.isCFGRoleAvail}),this.summaryView=new n({displayCompactMode:this.options.displayCompactMode,caSummaryData:{changeActions:[]},isCFGRoleAvail:this.options.isCFGRoleAvail})},render:function(e){this.container&&this.container.empty(),this.container.appendChild(this.emptyView.render()),this.emptyView.hide(),this.container.appendChild(this.selectorView.render(e)),this.selectorView.hide(),this.container.appendChild(this.summaryView.render(e)),this.summaryView.hide(),this.container.inject(this.options.cfgRevisionMainViewContainer)},loadCfgRevEmptyView:function(){this.selectorView.hide(),this.summaryView.hide(),this.emptyView.show()},loadCfgRevSelectorView:function(e){this.emptyView.hide(),this.summaryView.hide(),this.selectorView.show(),e&&e.cfgRevObjects&&(this.selectorView.removeAllCfgRevObjectsFromSelectorView(),this.selectorView.addCfgRevObjectsToSelectorView(e.cfgRevObjects))},loadCfgRevSummaryView:function(e){this.emptyView.hide(),this.selectorView.hide(),this.summaryView.show(),e&&e.cfgRevObjects&&(this.summaryView.removeAllCfgRevObjectsFromSummaryView(),this.summaryView.addCfgRevObjectsToSummaryView(e.cfgRevObjects))}})}),define("DS/CfgConfigurationRevisionUX/scripts/controller/CfgConfigurationRevisionController",["UWA/Core","DS/CfgConfigurationRevisionUX/scripts/views/CfgConfigurationRevisionMainView","DS/CfgConfigurationRevisionUX/scripts/model/CfgRevCollection","DS/CoreEvents/ModelEvents","DS/CfgBaseUX/scripts/CfgData","DS/CfgBaseUX/scripts/CfgController","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgBaseUX/scripts/CfgDialog","DS/UIKIT/Mask","DS/CfgBaseUX/scripts/CfgUXEnvVariables","text!DS/CfgBaseUX/assets/CfgUXEnvVariables.json","i18n!DS/CfgBaseUX/assets/nls/CfgBaseUXNLS","i18n!DS/CfgConfigurationRevisionUX/assets/nls/CfgConfigurationRevisionUX"],function(e,i,t,n,o,s,a,c,r,l,d,f,g){"use strict";return e.Class.extend({showInherited:!0,isSummaryCollectionUpdated:!1,isInheritedCAPresent:!1,isCFGRoleAvail:!1,isModified:!1,isCancelClicked:!1,init:function(e){var t=this;this._parent(e),this.cfgUXEnvVariablesJS=l.getCfgUXEnvVariables(),this.cfgUXEnvVariablesJS.showInheritedToggle?this.showInherited=!1:this.showInherited=!0,this.options=e,a.rolesAvailable(function(i){t.isCFGRoleAvail=!!i.isCFGRoleAvail,e.isCFGRoleAvail=t.isCFGRoleAvail}),this.cfgRevMainView=new i(e),o.clear(),o.cfgRevActionEvents=new n,this.subscribeCfgRevActionEvents()},initConfigurationRevisionServices:function(e,i,n){var o=this;o.env=e,o.tenantID=i,o.instanceID=n,r.mask(this.options.cfgRevisionMainViewContainer),s.init(null,"",e),enoviaServerFilterWidget.tenant=i,a.populate3DSpaceURL().then(function(e){a.populateSecurityContext().then(function(e){a.getVersionGraph(n).then(function(e){o.isAddRemoveCAAllowed=!1,e.graphs[0].versions.forEach(function(e){e.majorid==n&&("Private"!=e.maturity&&"In Work"!=e.maturity||(o.isAddRemoveCAAllowed=!0))}),a.getContentForConfigurationRevision(n,!0).then(function(e){o.isInheritedCAPresent=e.changeDefinition.inheritedChangeAction.length>0,o.summary_collection=new t,o.summary_collection.build(e,"summary"),a.getObjectsBySearchService(o.summary_collection.getAllModelsIDArray(),!1,"Change Action",[]).then(function(e){o.summary_collection.update(e),o.loadConfigurationRevisionMainView({isCRFrozenState:!o.isAddRemoveCAAllowed}),r.unmask(o.options.cfgRevisionMainViewContainer)},function(e){r.unmask(o.options.cfgRevisionMainViewContainer),a.showwarning(f.CfgSearchKO,"error")})},function(e){r.unmask(o.options.cfgRevisionMainViewContainer),a.showwarning(f.CfgCRGetContentFail,"error")})},function(e){r.unmask(o.options.cfgRevisionMainViewContainer),console.log("Failed to get data using versiongraph API : ")}),a.getRelevantChanges(n,!0).then(function(e){o.selector_collection=new t,o.selector_collection.build(e,"selector"),a.getObjectsBySearchService(o.selector_collection.getAllModelsIDArray(),!1,"Change Action",[]).then(function(e){o.selector_collection.update(e)},function(e){a.showwarning(f.CfgSearchKO,"error")})},function(e){a.showwarning(f.CfgCRGetRelCAFail,"error")})},function(e){return r.unmask(o.options.cfgRevisionMainViewContainer),Promise.reject(e)})},function(e){return r.unmask(o.options.cfgRevisionMainViewContainer),Promise.reject(e)})},loadConfigurationRevisionMainView:function(e){this.options.cfgRevisionMainViewContainer.empty(),e.filterView=this.showInherited?"showInherited":"",e.filterImplicitView="showImplicit",e.isHeaderAllowed=!0,this.cfgRevMainView.render(e),this.summary_collection.size()>0?o.cfgRevActionEvents.publish({event:"loadCfgRevSummaryView"}):this.summary_collection.size()<=0&&!this.isCFGRoleAvail?o.cfgRevActionEvents.publish({event:"loadEmptyCfgRevSummaryView"}):o.cfgRevActionEvents.publish({event:"loadCfgRevEmptyView"}),o.cfgRevActionEvents.publish({event:"ConfiguredRevisionViewLoaded"})},subscribeCfgRevActionEvents:function(){var e=this;o.cfgRevActionEvents.subscribe({event:"loadCfgRevEmptyView"},function(){e.cfgRevMainView.loadCfgRevEmptyView()}),o.cfgRevActionEvents.subscribe({event:"loadCfgRevSelectionView"},function(){e.selector_collection.isReady()?e.selector_collection.size()>0?e.cfgRevMainView.loadCfgRevSelectorView({cfgRevObjects:e.selector_collection.getRootModelsArray()}):a.showwarning(f.CfgCRNoCA,"warning"):a.showwarning(f.CfgCRCANotReady,"warning")}),o.cfgRevActionEvents.subscribe({event:"addSelectionToCfgRevSummaryView"},function(i){i.changeActionIds.forEach(function(i){e.summary_collection.add(e.selector_collection.get(i))}),e.isModified=!0,"action"===i.calledFrom&&(e.isSummaryCollectionUpdated=i.changeActionIds.length>0),e.selector_collection.remove(i.changeActionIds),"action"!==i.calledFrom&&(o.cfgRevActionEvents.publish({event:"loadCfgRevSummaryView"}),o.cfgRevActionEvents.publish({event:"ConfiguredRevisionAssociatedObjectsUpdated"}))}),o.cfgRevActionEvents.subscribe({event:"backButtonPressedToViewTheUpdatedCfgSummaryView"},function(){e.summary_collection.size()>0?(o.cfgRevActionEvents.publish({event:"loadCfgRevSummaryView"}),e.isSummaryCollectionUpdated&&(o.cfgRevActionEvents.publish({event:"ConfiguredRevisionAssociatedObjectsUpdated"}),e.isSummaryCollectionUpdated=!1)):e.isInheritedCAPresent||!e.isCFGRoleAvail?o.cfgRevActionEvents.publish({event:"loadEmptyCfgRevSummaryView"}):e.cfgRevMainView.loadCfgRevEmptyView()}),o.cfgRevActionEvents.subscribe({event:"loadEmptyCfgRevSummaryView"},function(i){e.cfgRevMainView.loadCfgRevSummaryView({cfgRevObjects:e.summary_collection.getRootModelsArray()})}),o.cfgRevActionEvents.subscribe({event:"loadCfgRevSummaryView"},function(i){if(e.summary_collection.isReady()){if(e.summary_collection.size()>0)e.showInherited||(e.summary_collection._models=e.summary_collection.getRootModelsArray().filter(function(e){return"inherited"!==e._attributes.type})),e.cfgRevMainView.loadCfgRevSummaryView({cfgRevObjects:e.summary_collection.getRootModelsArray()});else if(i){let t={droppedChangesList:i.caids};e.getValidDnDObjects(i.caids)?a.getObjectsBySearchService(i.caids,!1,"Change Action",[]).then(function(i){i.results?(e.summary_collection.build(t,"summary"),e.summary_collection.update(i),e.loadConfigurationRevisionMainView({isCRFrozenState:!e.isAddRemoveCAAllowed}),o.cfgRevActionEvents.publish({event:"ConfiguredRevisionAssociatedObjectsUpdated"})):(e.removeDropOverCssinEmtpyView(),a.showwarning(f.CfgCRFailedAddCA,"error"))},function(i){e.removeDropOverCssinEmtpyView(),a.showwarning(f.CfgSearchKO,"error")}):(e.removeDropOverCssinEmtpyView(),a.showwarning(f.CfgCRFailedAddCA,"error"))}}else a.showwarning(f.CfgCRContentNotReady,"warning")}),o.cfgRevActionEvents.subscribe({event:"showInheritedOnCfgRevSummaryView"},function(i){if(!e.isCancelClicked)if(e.isModified){let i="showInheritedCAEvent";e.showToggleInheritedWarningDialog(i)}else e.showInherited=!0,e.initConfigurationRevisionServices(e.env,e.tenantID,e.instanceID);e.isCancelClicked=!1}),o.cfgRevActionEvents.subscribe({event:"hideInheritedOnCfgRevSummaryView"},function(i){if(!e.isCancelClicked)if(e.isModified){let i="hideInheritedCAEvent";e.showToggleInheritedWarningDialog(i)}else e.showInherited=!1,e.initConfigurationRevisionServices(e.env,e.tenantID,e.instanceID);e.isCancelClicked=!1}),o.cfgRevActionEvents.subscribe({event:"removeSelectionFromCfgRevSummaryView"},function(i){i.length>0&&(i.forEach(function(i){e.selector_collection.add(e.summary_collection.get(i))}),e.summary_collection.remove(i),e.isModified=!0,o.cfgRevActionEvents.publish({event:"ConfiguredRevisionAssociatedObjectsUpdated"}))}),o.cfgRevActionEvents.subscribe({event:"ConfiguredRevisionAssociatedObjectsSaveClicked"},function(i){r.mask(e.options.cfgRevisionMainViewContainer),a.setContentForConfigurationRevision("changeAction",e.instanceID,e.summary_collection.getRootModelsIDArray()).then(function(i){a.showwarning(f.CfgCRSetContentSuccess,"success"),e.initConfigurationRevisionServices(e.env,e.tenantID,e.instanceID),r.unmask(e.options.cfgRevisionMainViewContainer)},function(i){a.showwarning(f.CfgCRSetContentFail,"error"),e.initConfigurationRevisionServices(e.env,e.tenantID,e.instanceID),r.unmask(e.options.cfgRevisionMainViewContainer),e.removeDropOverCssinEmtpyView()}),e.isModified&&(e.isModified=!1)}),o.cfgRevActionEvents.subscribe({event:"CfgRevToggleInheritedDialogOkButtonClicked"},function(i){e.showInherited="showInheritedCAEvent"===i,e.initConfigurationRevisionServices(e.env,e.tenantID,e.instanceID),e.isModified=!1}),o.cfgRevActionEvents.subscribe({event:"IsCancelClickedSetToTrue"},function(){e.isCancelClicked=!0})},removeDropOverCssinEmtpyView:function(){let e=this.cfgRevMainView.container.getElement(".empty-view-container");e&&e.hasClassName("dropOverEmptyView")&&e.removeClassName("dropOverEmptyView")},showToggleInheritedWarningDialog:function(e){let i=function(){let i="showInheritedCAEvent"!==e;o.cfgRevActionEvents.publish({event:"IsCancelClickedSetToTrue"}),o.cfgRevSummaryToolbarActionEvents.publish({event:"CfgRevToggleInheritedDialogCancelClicked",data:i}),n.closeDialog()},t={width:539,height:170,isResizable:!1,dialogue:{header:g.CFG_REV_WARNING_DIALOG_HEADER,buttonArray:[{label:"Ok",labelValue:g.CFG_REV_ACTION_OK,handler:function(){o.cfgRevActionEvents.publish({event:"CfgRevToggleInheritedDialogOkButtonClicked",data:e}),o.cfgRevActionEvents.publish({event:"ConfiguredRevisionAssociatedObjectsNotUpdated"}),n.closeDialog()},className:"primary"},{label:"Cancel",labelValue:g.CFG_REV_ACTION_CANCEL,handler:i,className:"default"}],target:widget.body,object:null,postCrossHandler:i}},n=new c(t);n.render(),n.container.setStyle("overflow","auto"),n.container.setHTML(g.CFG_REV_RESET_MESSAGE+"<br><br>"+g.CFG_REV_RESET_QUESTION+"<br>")},getValidDnDObjects:function(e){let i=e.filter(e=>this.selector_collection.getAllModelsIDArray().includes(e));return JSON.stringify(i)===JSON.stringify(e)}})}),define("DS/CfgConfigurationRevisionUX/scripts/views/CfgConfigurationRevisionCASelectionMainView",["UWA/Class/View","DS/CfgConfigurationRevisionUX/scripts/views/CfgRevSelectorView","css!DS/CfgConfigurationRevisionUX/styles/CfgConfigurationRevisionUX.css"],function(e,i){"use strict";return e.extend({tagName:"div",className:"cfg-rev-caselection-main-view-container",init:function(e){this._parent(e),this.selectorView=new i({displayCompactMode:this.options.displayCompactMode,caSelectorData:{changeActions:[]},isCFGRoleAvail:this.options.isCFGRoleAvail})},render:function(e){return this.container&&this.container.empty(),this.container.appendChild(this.selectorView.render(e)),this.selectorView.hide(),this.container},loadCfgRevSelectorView:function(e){this.selectorView.show(),e&&e.cfgRevObjects&&(this.selectorView.removeAllCfgRevObjectsFromSelectorView(),this.selectorView.addCfgRevObjectsToSelectorView(e.cfgRevObjects))}})}),define("DS/CfgConfigurationRevisionUX/scripts/views/instance/CfgConfigurationRevisionInstanceListView",["UWA/Class/View","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/DataGridView/DataGridView","DS/PlatformAPI/PlatformAPI","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgBaseUX/scripts/CfgData","DS/CoreEvents/ModelEvents","DS/CfgConfigurationRevisionUX/scripts/views/instance/toolbar/CfgConfigurationRevisionInstanceListViewToolbar","DS/Windows/ImmersiveFrame","DS/CfgBaseUX/scripts/CfgUXEnvVariables","text!DS/CfgBaseUX/assets/CfgUXEnvVariables.json","i18n!DS/CfgBaseUX/assets/nls/CfgBaseUXNLS","css!DS/CfgConfigurationRevisionUX/styles/CfgConfigurationRevisionInstanceListVIew.css"],function(e,i,t,n,o,s,a,c,r,l,d,f,g){"use strict";return e.extend({init:function(e){this._parent(e)},render:function(){this.cfgUXEnvVariablesJS=d.getCfgUXEnvVariables(),this.CfgConfigurationRevisionInstanceListContainer=UWA.createElement("div",{class:"cfgcr-instance-objectlistview-container"});let e="cfgcr-instancelist-gridviewcontainer";return this.options.isFrozenRevision&&!this.cfgUXEnvVariablesJS.showInheritedToggleForInstances?e="cfgcr-instancelist-gridviewcontainer-no-toolbar":this.divToolbarContainer=UWA.createElement("div",{class:"cfgcr-instancelist-toolbarcontainer cfgcr-instancelist-toolbar-border-top"}).inject(this.CfgConfigurationRevisionInstanceListContainer),this.CfgConfigurationRevisionInstanceListDGVContainer=UWA.createElement("div",{class:e}).inject(this.CfgConfigurationRevisionInstanceListContainer),this.CreateInstanceListTreeDocument(this.options.modelData),this.CfgConfigurationRevisionInstanceListContainer},CreateInstanceListTreeDocument:function(e){var t=e;this.model=new i({shouldBeSelected:function(e){return!1!==e._options.data.isSelectableCfgRevObject}}),this.addInstancesToView(t),this.createInstancelistDataGridView(),this.options.isFrozenRevision&&!this.cfgUXEnvVariablesJS.showInheritedToggleForInstances||this.createInstanceListToolbar(),a.clear(),a.cfgRevInstanceActionEvents=new c,this.pubSubEvents()},createInstancelistDataGridView:function(){var e=this,i="";this.options.mode&&this.options.columns&&(i=this.options.columns),this.dataGridView=new n({treeDocument:e.model,identifier:"cfgCRInstanceListView-"+this.options.mode,columns:i,cellSelection:"none",rowSelection:"multiple",showRowIndexFlag:!1,showSelectionCheckBoxesFlag:!0,touchMode:e.options.touchMode||!1,defaultColumnDef:{editableFlag:!0},getCellTooltip:function(i){var t;if(i.rowID>-1)return"instanceSummaryView"!==e.options.mode||2!==i.columnID||"inherited"!==i.nodeModel._options.grid.instanceType||e.cfgUXEnvVariablesJS.isCRGroupByEnabled?("instanceSummaryView"!==e.options.mode||5!==i.columnID||"local"!==i.nodeModel._options.grid.instanceType||e.options.isFrozenRevision||(t={shortHelp:g.CfgLabelRemovesingleInstance,updateModel:!1}),t):{shortHelp:g.CfgInheritedTooltip,updateModel:!1}}});var t=new l;t.setContentInBackgroundLayer(this.dataGridView.getContent()),t.reactToPointerEventsFlag=!1,t.inject(e.CfgConfigurationRevisionInstanceListDGVContainer),this.dataGridView.subscribeOnceToAllCellsRendered(()=>{let e=this.dataGridView.getCustomViewsManager();e.showCustomViewsDialog(),e._customViewsDialog.visibleFlag=!1;let i=document.querySelector(".wux-controls-selectionChips");i&&i.parentNode.removeChild(i)})},getAllInstanceIdList:function(){var e=[];return this.model.getAllDescendants().forEach(i=>{i.options.grid.id&&e.push(i.options.grid.id)}),e},createInstanceListToolbar:function(){this.applyInstanceSummaryToolbar()},addFunctionCallbackToActionColumn:function(e){let i=()=>s.showwarning(g.CfgMessageFrozenCRCannotRemoveLocalInstance,"error"),t=()=>s.showwarning(g.CfgMessageCRCannotRemoveInheritedInstance,"error");this.options.action&&1===this.options.action.length&&"instanceSummaryView"===this.options.mode&&"local"===e.instanceType&&(e.functionToCall=this.options.isFrozenRevision?i:this.options.action[0].callback),this.options.action&&1===this.options.action.length&&"instanceSummaryView"===this.options.mode&&"inherited"===e.instanceType&&(e.functionToCall=t)},getInstancesCount:function(e){return{allLocalInstances:e.filter(e=>"local"===e._attributes.instanceType),allInheritedInstances:e.filter(e=>"inherited"===e._attributes.instanceType)}},addInstancesAsFlatListToView:function(e){var i=this;i.model.prepareUpdate(),e.forEach(function(e){var t=e.toJson();i.addFunctionCallbackToActionColumn(t);let n=i.createInstanceTreeNodeModel(t);i.model.addRoot(n)}),i.model.pushUpdate()},addInstancesAsGroupToView:function(e){var i=this;i.model.prepareUpdate();let{allLocalInstances:n,allInheritedInstances:o}=this.getInstancesCount(e),s=new t({data:{isSelectableCfgRevObject:!1},label:`${g.CfgRevLabelUserDefined} (${n.length})`,grid:`${g.CfgRevLabelUserDefined}`}),a=new t({data:{isSelectableCfgRevObject:!1},label:`${g.CfgRevLabelInherited} (${o.length})`,grid:`${g.CfgRevLabelInherited}`}),c=!1;e.forEach(function(e){var t=e.toJson();i.addFunctionCallbackToActionColumn(t);let n=i.createInstanceTreeNodeModel(t),o="local"===t.instanceType?s:a;o.prepareUpdate(),o===s&&i.cfgUXEnvVariablesJS.showInheritedToggleForInstances&&""===i.options.filterView?(c=!0,i.model.addRoot(n)):o.addRoot(n),o.pushUpdate()}),0===e.length&&i.cfgUXEnvVariablesJS.showInheritedToggleForInstances&&""===i.options.filterView&&(c=!0),c||(i.model.addRoot(s),0!==s.getAllDescendants().length&&s.expand(),"showInherited"===this.options.filterView&&(i.model.addRoot(a),0!==a.getAllDescendants().length&&0===s.getAllDescendants().length&&a.expand())),i.model.pushUpdate()},createInstanceTreeNodeModel:function(e){return new t({data:{isSelectableCfgRevObject:!("local"!==e.instanceType||this.options.isFrozenRevision||!this.options.isCFGRoleAvail)},label:e.title,name:e.name,subLabel:e.name+" | "+e.creator,thumbnail:e.thumbnail,icons:[],description:e.maturity,customTooltip:e.customTooltip,statusbarIcons:e.statusbaractions,statusbarIconsTooltips:e.statusbaractionsTooltips,grid:e})},addInstancesToView:function(e){this.cfgUXEnvVariablesJS.isCRGroupByEnabled?this.addInstancesAsGroupToView(e):this.addInstancesAsFlatListToView(e)},removeAllObjectsFromView:function(){this.model.prepareUpdate(),this.model.empty(),this.model.pushUpdate()},applyInstanceSummaryToolbar:function(){var e={toolbarHeaderLabel:this.options.headerLabel,touchMode:this.options.touchMode||!1,filterView:this.options.filterView,isFrozenCR:this.options.isFrozenRevision,isCFGRoleAvail:this.options.isCFGRoleAvail};r.toolbarActionBar=this.dataGridView.setToolbar(r.writeToolbarDefination(e)),this.toolbar=r.toolbarActionBar,this.divToolbarContainer.appendChild(this.toolbar.getContent())},pubSubEvents:function(){var e=this;a.cfgRevInstanceActionEvents.subscribe({event:"updateTheUserDefinedInstancesCount"},e=>{this.dataGridView.getTreeDocument().getRoots().forEach(i=>{i._options.label.includes(g.CfgRevLabelUserDefined)&&i.updateOptions({label:`${g.CfgRevLabelUserDefined} (${e})`})})}),this.dataGridView.treeDocument.getXSO().onPostAdd(function(i){var t=e.dataGridView.treeDocument.getXSO().isEmpty();e.getSelectedInstanceList(),o.publish("CfgCRInstanceListSelection",{flag:t,mode:e.options.mode})}),this.dataGridView.treeDocument.getXSO().onPostRemove(function(i){var t=e.dataGridView.treeDocument.getXSO().isEmpty();e.getSelectedInstanceList(),o.publish("CfgCRInstanceListUnselection",{flag:t,mode:e.options.mode})})},getSelectedInstanceList:function(){var e=this;this.selectedInstanceList=[],this.dataGridView.treeDocument.getSelectedNodes().forEach(function(i){e.selectedInstanceList.push(i.options.grid.physicalId)})}})}),define("DS/CfgConfigurationRevisionUX/scripts/model/instance/CfgConfigurationRevisionInstanceCollection",["UWA/Class/Collection","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgConfigurationRevisionUX/scripts/model/instance/CfgConfigurationRevisionInstanceModel","i18n!DS/CfgBaseUX/assets/nls/CfgBaseUXNLS"],function(e,i,t,n){return e.extend({model:t,_isReady:!1,init:function(e){this._parent(e)},isReady:function(){return this._isReady},getAllModelsIDArray:function(){var e=[];return this.forEach(function(i){e.push(i.get("id"))}),e},getRootModelsIDArray:function(){var e=[];return this.forEach(function(i){e.push(i.get("id"))}),e},getRootModelsArray:function(){return this.toArray()},build:function(e,i){var n=this;"instanceSummary"==i&&(e.instanceDefinition&&Array.isArray(e.instanceDefinition.localInstances)&&e.instanceDefinition.localInstances.forEach(function(e){var i=new t;i.set("id",e),i.set("instanceType","local"),n.add(i)}),e.instanceDefinition&&Array.isArray(e.instanceDefinition.inheritedInstances)&&e.instanceDefinition.inheritedInstances.forEach(function(e){var i=new t;i.set("id",e),i.set("instanceType","inherited"),n.add(i)}))},update:function(e){this.forEach(function(t){e.results&&e.results.forEach(function(e){e.physicalID&&e.physicalID==t.get("id")&&(e.data.forEach(function(e){"PLM_ExternalID"==e.name&&e.value&&t.set("title",e.value[0])}),e.basicData.forEach(function(e){if("type"===e.name&&t.set("type",e.value[0]),"owner"==e.name&&t.set("owner",{label:e.value[0],url:""}),"modified"==e.name){let n=`${e.value[0].split("@")[0].replaceAll("/","-")}T`,o=`${e.value[0].split("@")[1].split(":GMT")[0]}Z`,s=new Date(`${n}${o}`);t.set("modificationDate",i.formatDate(s,"%m-%d-%Y, %I:%M:%S %p"))}}),t.update())})}),this._isReady=!0}})}),define("DS/CfgConfigurationRevisionUX/scripts/views/instance/CfgConfigurationRevisionInstanceSummaryView",["UWA/Core","UWA/Class/View","DS/CfgConfigurationRevisionUX/scripts/views/instance/CfgConfigurationRevisionInstanceListView","DS/CfgConfigurationRevisionUX/scripts/controller/instance/CfgConfigurationRevisionInstanceListViewController","DS/CfgBaseUX/scripts/CfgUXEnvVariables","i18n!DS/CfgBaseUX/assets/nls/CfgBaseUXNLS","text!DS/CfgBaseUX/assets/CfgRevSelectorColumns.json","text!DS/CfgBaseUX/assets/CfgUXEnvVariables.json","css!DS/CfgConfigurationRevisionUX/styles/CfgConfigurationRevisionUX.css","css!DS/CfgConfigurationRevisionUX/styles/CfgConfigurationRevisionInstanceListVIew.css"],function(e,i,t,n,o,s,a,c){"use strict";return i.extend({tagName:"div",className:"cfgcr-instance-summary-view-container",init:function(e){var i=this;this._parent(e);var t=JSON.parse(a).CfgRevSummaryColumns;if(this.cfgUXEnvVariablesJS=o.getCfgUXEnvVariables(),this.displayCompactMode=null==this.options.displayCompactMode||null==this.options.displayCompactMode||0!=this.options.displayCompactMode,this.instanceSummaryData=e.caInstanceSummaryData,this.defaultInstanceSummaryColumns=[{text:s.CfgLabelTitle,alwaysVisibleFlag:!0,editableFlag:!1,pinned:"left",dataIndex:"tree",getCellClassName:function(e){if(e.nodeModel&&e.nodeModel.isRoot())return"cfgcr-title-bold"}},{text:s.CfgLabelType,editableFlag:!1,dataIndex:"type",width:"30",visibleFlag:!0},{text:s.CfgLabelOwner,editableFlag:!1,dataIndex:"owner",typeRepresentation:"user"},{text:s.CfgLabelModificationDate,editableFlag:!1,dataIndex:"modificationDate"}],!this.cfgUXEnvVariablesJS.isCRGroupByEnabled){let e={text:s.CfgLabelFrom,editableFlag:!1,dataIndex:"instanceType",width:"30",visibleFlag:!0,hasCellValue:function(e){return"inherited"===e.nodeModel.getAttributeValue("instanceType")},getCellValue:function(e){if(e.nodeModel){var t=e.nodeModel.getAttributeValue("from");if(!i.cfgUXEnvVariablesJS.isCRGroupByEnabled&&""===t){var n=e.nodeModel.getAttributeValue("instanceType");t="inherited"===n.toLowerCase()?n.charAt(0).toUpperCase()+n.slice(1):""}return t}}};this.defaultInstanceSummaryColumns.splice(2,0,e)}if(this.options.isCFGRoleAvail){var c={icon:{iconName:"remove",fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"1x"},callback:function(e){e.calledFrom="action",n.onInstanceSummaryRemove(e)}};this.action=[c],1===this.action.length&&this.defaultInstanceSummaryColumns.push({text:s.CfgAction,editableFlag:!1,dataIndex:"functionToCall",typeRepresentation:"functionIcon",visibleFlag:t.isActionVisible})}},addCfgRevObjectsToIsInstanceSummaryView:function(e){this.cfgRevInstanceSummaryView.addInstancesToView(e)},removeAllCfgRevObjectsFromSummaryView:function(){this.cfgRevInstanceSummaryView.removeAllObjectsFromView()},getInstanceFromSummaryView:function(){return this.cfgRevInstanceSummaryView.getAllInstanceIdList()},render:function(e){if(this.container&&this.container.empty(),this.options.isCFGRoleAvail&&1===this.action.length){let i=this.defaultInstanceSummaryColumns.findIndex(e=>e.text===s.CfgAction);this.defaultInstanceSummaryColumns[i].getCellSemantics=(i=>{let t={iconName:"remove",fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"1x"},n={iconName:"block",fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"1x"};return{icon:"local"!==i.nodeModel.getAttributeValue("instanceType")||e.isCRFrozenState?n:t}})}return this.cfgRevInstanceSummaryView=new t({headerLabel:s.CfgCRLabelInstances,mode:"instanceSummaryView",columns:this.defaultInstanceSummaryColumns,modelData:[],touchMode:!this.displayCompactMode,isFrozenRevision:e.isCRFrozenState,filterView:e.filterView,action:this.action,isCFGRoleAvail:this.options.isCFGRoleAvail}),this.container.appendChild(this.cfgRevInstanceSummaryView.render()),this.container}})}),define("DS/CfgConfigurationRevisionUX/scripts/views/instance/CfgConfigurationRevisionInstanceMainView",["UWA/Class/View","DS/CfgConfigurationRevisionUX/scripts/views/instance/CfgConfigurationRevisionInstanceSummaryView","css!DS/CfgConfigurationRevisionUX/styles/CfgConfigurationRevisionUX.css","css!DS/CfgConfigurationRevisionUX/styles/CfgConfigurationRevisionInstanceListVIew.css"],function(e,i){"use strict";return e.extend({tagName:"div",className:"cfg-rev-instance-main-view-container",init:function(e){this._parent(e),this.instanaceSummaryView=new i({displayCompactMode:this.options.displayCompactMode,isCFGRoleAvail:this.options.isCFGRoleAvail})},render:function(e){return this.container&&this.container.empty(),this.container.appendChild(this.instanaceSummaryView.render(e)),this.instanaceSummaryView.hide(),this.container},loadCfgRevInstanceSummaryView:function(e){if(e&&e.cfgRevObjects){this.instanaceSummaryView.show(),this.instanaceSummaryView.removeAllCfgRevObjectsFromSummaryView();let i=e.cfgRevObjects.filter(e=>"local"===e._attributes.instanceType),t=e.cfgRevObjects.filter(e=>"inherited"===e._attributes.instanceType);e.cfgRevObjects=[...i,...t],this.instanaceSummaryView.addCfgRevObjectsToIsInstanceSummaryView(e.cfgRevObjects)}}})}),define("DS/CfgConfigurationRevisionUX/scripts/controller/CfgConfigurationRevisionController2",["UWA/Core","DS/CfgConfigurationRevisionUX/scripts/views/CfgConfigurationRevisionMainView2","DS/CfgConfigurationRevisionUX/scripts/views/instance/CfgConfigurationRevisionInstanceMainView","DS/CfgConfigurationRevisionUX/scripts/views/CfgConfigurationRevisionCASelectionMainView","DS/CfgConfigurationRevisionUX/scripts/model/CfgRevCollection","DS/CfgConfigurationRevisionUX/scripts/model/instance/CfgConfigurationRevisionInstanceCollection","DS/CoreEvents/ModelEvents","DS/CfgBaseUX/scripts/CfgData","DS/CfgBaseUX/scripts/CfgController","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgBaseUX/scripts/CfgDialog","DS/UIKIT/Mask","DS/Controls/Loader","DS/Controls/Expander","DS/CfgBaseUX/scripts/CfgUXEnvVariables","text!DS/CfgBaseUX/assets/CfgUXEnvVariables.json","i18n!DS/CfgBaseUX/assets/nls/CfgBaseUXNLS","i18n!DS/CfgConfigurationRevisionUX/assets/nls/CfgConfigurationRevisionUX","css!DS/CfgConfigurationRevisionUX/styles/CfgConfigurationRevisionUX.css"],function(e,i,t,n,o,s,a,c,r,l,d,f,g,C,u,h,v,p){"use strict";return e.Class.extend({showInherited:!0,showImplicit:!0,showInheritedInstances:!0,isSummaryCollectionUpdated:!1,isInheritedCAPresent:!1,isCFGRoleAvail:!1,isModified:!1,isCancelClicked:!1,isInstanceWarningDialogCancelClicked:!1,cfgRevSpinner:new g({text:p.CFG_REV_LOADER_LABEL}),removedInstanceIds:[],init:function(e){var o=this;this._parent(e),this.cfgUXEnvVariablesJS=u.getCfgUXEnvVariables(),this.cfgUXEnvVariablesJS.showInheritedToggle?this.showInherited=!1:this.showInherited=!0,this.showImplicit=!this.cfgUXEnvVariablesJS.showImplicitToggleForCA,this.showInheritedInstances=!this.cfgUXEnvVariablesJS.showInheritedToggleForInstances,this.options=e,l.rolesAvailable(function(i){o.isCFGRoleAvail=!!i.isCFGRoleAvail,e.isCFGRoleAvail=o.isCFGRoleAvail}),this.cfgRevMainView=new i(e),this.cfgRevInstanceMainView=new t(e),this.cfgRevCASelectionMainView=new n(e),c.clear(),c.cfgRevActionEvents=new a,this.subscribeCfgRevActionEvents()},injectSpinnerIntoContainer:function(){this.cfgRevSpinner.getContent().setStyles({position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}),this.cfgRevSpinner.inject(this.options.cfgRevisionMainViewContainer)},turnTheSpinnerOn:function(){this.cfgRevSpinner.on(),this.CRFacetExpanderContainer.setStyles({opacity:"0.2"})},turnTheSpinnerOff:function(){this.cfgRevSpinner.off(),this.CRFacetExpanderContainer.setStyles({opacity:"1"})},initConfigurationRevisionServices:function(i,t,n){var s=this;s.env=i,s.tenantID=t,s.instanceID=n,this.options.cfgRevisionMainViewContainer.hasChildNodes()&&3==this.options.cfgRevisionMainViewContainer.childElementCount&&(this.options.cfgRevisionMainViewContainer.removeChild(this.options.cfgRevisionMainViewContainer.childNodes[0]),this.options.cfgRevisionMainViewContainer.removeChild(this.options.cfgRevisionMainViewContainer.childNodes[0])),this.CRFacetExpanderContainer=new e.Element("div",{class:"cfgcr-facetexpander-container"}),this.injectSpinnerIntoContainer(),this.turnTheSpinnerOn(),this.changeActionCRSelectionFacetContainer=new e.Element("div",{class:"cfgcr-changeaction-selection-facet-container",html:this.cfgRevCASelectionMainView.render({isCRFrozenState:!1})}),this.changeActionCRSelectionFacetContainer.hide(),enoviaServerFilterWidget.mode=i,r.init(null,"",i),enoviaServerFilterWidget.tenant=t,l.populate3DSpaceURL().then(function(e){l.populateSecurityContext().then(function(e){l.getVersionGraph(n).then(function(e){s.isAddRemoveCAAllowed=!1,e.graphs[0].versions.forEach(function(e){e.majorid==n&&("Private"!=e.maturity&&"In Work"!=e.maturity||(s.isAddRemoveCAAllowed=!0))}),l.getContentForConfigurationRevision(n,!0).then(function(e){s.buildAndUpdateCASummaryCollection(e,function(){e.instanceDefinition.localInstances.length>0||e.instanceDefinition.inheritedInstances.length>0?s.buildAndUpdateInstanceSummaryCollection(e,function(){s.emptyMainViewContainerAndAddChildNodes(),s.loadConfigurationRevisionChangeActionMainView({isCRFrozenState:!s.isAddRemoveCAAllowed}),s.loadConfigurationRevisionInstanceMainView({isCRFrozenState:!s.isAddRemoveCAAllowed})}):(s.emptyMainViewContainerAndAddChildNodes(),s.instance_collection&&s.instance_collection.reset(),s.loadConfigurationRevisionChangeActionMainView({isCRFrozenState:!s.isAddRemoveCAAllowed}))})},function(e){s.turnTheSpinnerOff(),l.showwarning(v.CfgCRGetContentFail,"error")})},function(e){s.turnTheSpinnerOff(),l.showwarning(v.CfgVersionGraphServiceFailed,"error"),console.log("Failed to get data using versiongraph API : ")}),l.getRelevantChanges(n,!0).then(function(e){s.selector_collection=new o,s.selector_collection.build(e,"selector"),l.getObjectsBySearchService(s.selector_collection.getAllModelsIDArray(),!1,"Change Action",[]).then(function(e){s.selector_collection.update(e)},function(e){s.turnTheSpinnerOff(),l.showwarning(v.CfgSearchKO,"error")})},function(e){s.turnTheSpinnerOff(),l.showwarning(v.CfgCRGetRelCAFail,"error")})},function(e){return s.turnTheSpinnerOff(),Promise.reject(e)})},function(e){return s.turnTheSpinnerOff(),Promise.reject(e)})},emptyMainViewContainerAndAddChildNodes:function(){this.options.cfgRevisionMainViewContainer.empty(),this.injectSpinnerIntoContainer(),this.options.cfgRevisionMainViewContainer.addContent(this.CRFacetExpanderContainer),this.options.cfgRevisionMainViewContainer.addContent(this.changeActionCRSelectionFacetContainer)},buildAndUpdateCASummaryCollection:function(e,i){var t=this;t.isInheritedCAPresent=e.changeDefinition.inheritedChangeAction.length>0,t.summary_collection=new o,t.summary_collection.build(e,"summary"),l.getObjectsBySearchService(t.summary_collection.getAllModelsIDArray(),!1,"Change Action",[]).then(function(e){t.summary_collection.update(e),t.addEventListenerForCollections(t.summary_collection),i()},function(e){t.turnTheSpinnerOff(),l.showwarning(v.CfgSearchKO,"error")})},buildAndUpdateInstanceSummaryCollection:function(e,i){var t=this;t.instance_collection=new s,t.instance_collection.build(e,"instanceSummary"),l.getInstanceObjectsByReadService(t.instance_collection.getAllModelsIDArray()).then(function(e){t.instance_collection.update(e),t.addEventListenerForCollections(t.instance_collection),i()},function(e){console.log(e),t.turnTheSpinnerOff(),l.showwarning(v.CfgReadServiceFailed,"error")})},addEventListenerForCollections:function(e){e.addEvent("onRemove",()=>{e.isUpdated=!0}),e.addEvent("onAdd",()=>{e.isUpdated=!0})},loadConfigurationRevisionChangeActionMainView:function(e,i){i&&"DnD"==i?this.changeActionCRViewExapnder&&this.changeActionCRViewExapnder.destroy():this.CRFacetExpanderContainer.empty(),this.instance_collection&&this.instance_collection.size()>0?(e.isHeaderAllowed=!1,this.createChangeActionExpanderView(e,i)):(e.isHeaderAllowed=!0,e.filterView=this.showInherited?"showInherited":"",e.filterImplicitView=this.showImplicit?"showImplicit":"",this.CRFacetExpanderContainer.appendChild(this.cfgRevMainView.render(e)),this.CRFacetExpanderContainer.addClassName("cfgcrfacet-expanded-full")),this.isHeaderAllowed=e.isHeaderAllowed,this.isAddRemoveCAAllowed&&this.isCFGRoleAvail&&this.summary_collection.size()<=0?c.cfgRevActionEvents.publish({event:"loadCfgRevEmptyView"}):this.summary_collection.size()<=0?c.cfgRevActionEvents.publish({event:"loadEmptyCfgRevSummaryView"}):c.cfgRevActionEvents.publish({event:"loadCfgRevSummaryView"}),null==this.instance_collection&&this.publishConfiguredRevisionViewLoadedEvent(),this.updateTheCAExpanderWithTotalCACount(),this.turnTheSpinnerOff()},publishConfiguredRevisionViewLoadedEvent:function(){c.cfgRevActionEvents.publish({event:"ConfiguredRevisionViewLoaded"})},createChangeActionExpanderView:function(e,i){var t=this;e.filterView=this.showInherited?"showInherited":"",e.filterImplicitView=this.showImplicit?"showImplicit":"",this.changeActionCRViewExapnder=new C({id:"changeActionCRViewExapnder",header:v.CfgLabelChangeActions,body:this.cfgRevMainView.render(e),touchMode:!1,//!(that.options.displayCompactMode),
style:"styled"}),i&&"DnD"==i?this.CRFacetExpanderContainer.insertBefore(this.changeActionCRViewExapnder.getContent(),this.CRFacetExpanderContainer.childNodes[0]):this.CRFacetExpanderContainer.addContent(this.changeActionCRViewExapnder),this.changeActionCRViewExapnder.getContent().addEventListener("expand",function(){t.instanceCRViewExapnder&&(t.instanceCRViewExapnder.getContent().removeClassName("cfgcrfacet-expanded-partial"),t.isInstanceViewExpanded=!1,t.instanceCRViewExapnder.close()),this.addClassName("cfgcrfacet-expanded-partial")}),this.changeActionCRViewExapnder.getContent().addEventListener("collapse",function(){this.removeClassName("cfgcrfacet-expanded-partial")}),0==this.instance_collection.size()?(t.changeActionCRViewExapnder.getContent().addClassName("cfgcrfacet-expanded-full"),this.changeActionCRViewExapnder.expand()):(this.isChangeActionViewExpanded||"DnD"==i)&&this.changeActionCRViewExapnder.expand(),this.isChangeActionViewExpanded=!1},loadConfigurationRevisionInstanceMainView:function(e){var i=this;e.filterView=this.showInheritedInstances?"showInherited":"",this.instance_collection&&this.instance_collection.size()>0&&(this.instanceCRViewExapnder=new C({id:"instanceCRViewExapnder",header:v.CfgCRLabelInstances,body:this.cfgRevInstanceMainView.render(e),touchMode:!1,style:"styled"}).inject(this.CRFacetExpanderContainer),this.instanceCRViewExapnder.getContent().addEventListener("expand",function(){i.changeActionCRViewExapnder&&(i.changeActionCRViewExapnder.getContent().removeClassName("cfgcrfacet-expanded-partial"),i.changeActionCRViewExapnder.close()),this.addClassName("cfgcrfacet-expanded-partial")}),this.instanceCRViewExapnder.getContent().addEventListener("collapse",function(){this.removeClassName("cfgcrfacet-expanded-partial")}),i.isInstanceViewExpanded&&(this.instanceCRViewExapnder.expand(),i.isInstanceViewExpanded=!1),c.cfgRevActionEvents.publish({event:"loadCfgRevInstanceSummaryView"}),i.publishConfiguredRevisionViewLoadedEvent(),i.turnTheSpinnerOff()),c.cfgRevActionEvents.publish({event:"updateTheInstancesExpanderHeaderWithTheCount",data:i.instance_collection.size()})},getTheImplicitCACount:function(){let e=[];return this.summary_collection._models.forEach(i=>{i._attributes.implicitObjects.forEach(i=>e.push(i))}),e.length},updateTheCAExpanderWithTotalCACount:function(){let e=this.showImplicit?this.getTheImplicitCACount():0,i=this.summary_collection.size()+e;c.cfgRevActionEvents.publish({event:"updateTheCAExpanderHeaderWithTheCount",data:i})},subscribeCfgRevActionEvents:function(){var e=this;c.cfgRevActionEvents.subscribe({event:"loadCfgRevEmptyView"},function(){e.cfgRevMainView.loadCfgRevEmptyView()}),c.cfgRevActionEvents.subscribe({event:"loadCfgRevSelectionView"},function(){e.selector_collection.isReady()?e.selector_collection.size()>0?(e.CRFacetExpanderContainer.hide(),e.changeActionCRSelectionFacetContainer.show(),e.cfgRevCASelectionMainView.loadCfgRevSelectorView({cfgRevObjects:e.selector_collection.getRootModelsArray()})):l.showwarning(v.CfgCRNoCA,"warning"):l.showwarning(v.CfgCRCANotReady,"warning")}),c.cfgRevActionEvents.subscribe({event:"addSelectionToCfgRevSummaryView"},function(i){if(i.changeActionIds.forEach(function(i){e.summary_collection.add(e.selector_collection.get(i))}),e.isModified=!0,"action"===i.calledFrom&&(e.isSummaryCollectionUpdated=i.changeActionIds.length>0),e.selector_collection.remove(i.changeActionIds),"action"!==i.calledFrom&&(c.cfgRevActionEvents.publish({event:"loadCfgRevSummaryView"}),c.cfgRevActionEvents.publish({event:"ConfiguredRevisionAssociatedObjectsUpdated"}),e.changeActionCRSelectionFacetContainer.hide(),e.CRFacetExpanderContainer.show()),e.cfgUXEnvVariablesJS.isCRGroupByEnabled){var t=e.summary_collection._models.filter(e=>"local"===e._attributes.type);c.cfgRevCASummaryActionEvents.publish({event:"updateTheSummaryCAViewWithTheCount",data:t.length})}e.updateTheCAExpanderWithTotalCACount()}),c.cfgRevActionEvents.subscribe({event:"backButtonPressedToViewTheUpdatedCfgSummaryView"},function(){if(e.CRFacetExpanderContainer.show(),e.changeActionCRSelectionFacetContainer.hide(),e.summary_collection.size()>0?(c.cfgRevActionEvents.publish({event:"loadCfgRevSummaryView"}),e.isSummaryCollectionUpdated&&(c.cfgRevActionEvents.publish({event:"ConfiguredRevisionAssociatedObjectsUpdated"}),e.isSummaryCollectionUpdated=!1)):e.isInheritedCAPresent||!e.isCFGRoleAvail?c.cfgRevActionEvents.publish({event:"loadEmptyCfgRevSummaryView"}):e.cfgRevMainView.loadCfgRevEmptyView(),e.cfgUXEnvVariablesJS.isCRGroupByEnabled){var i=e.summary_collection._models.filter(e=>"local"===e._attributes.type);c.cfgRevCASummaryActionEvents.publish({event:"updateTheSummaryCAViewWithTheCount",data:i.length})}e.updateTheCAExpanderWithTotalCACount()}),c.cfgRevActionEvents.subscribe({event:"loadEmptyCfgRevSummaryView"},function(i){e.cfgRevMainView.loadCfgRevSummaryView({cfgRevObjects:e.summary_collection.getRootModelsArray()})}),c.cfgRevActionEvents.subscribe({event:"loadCfgRevSummaryView"},function(i){if(e.summary_collection.isReady()){if(e.summary_collection.size()>0)e.showInherited||(e.summary_collection._models=e.summary_collection.getRootModelsArray().filter(function(e){return"inherited"!==e._attributes.type})),e.updateTheCAExpanderWithTotalCACount(),e.cfgRevMainView.loadCfgRevSummaryView({cfgRevObjects:e.summary_collection.getRootModelsArray()});else if(i){let t={droppedChangesList:i.caids};e.getValidDnDObjects(i.caids)?l.getObjectsBySearchService(i.caids,!1,"Change Action",[]).then(function(i){i.results?(e.summary_collection.build(t,"summary"),e.summary_collection.update(i),e.selector_collection.remove(t.droppedChangesList),e.loadConfigurationRevisionChangeActionMainView({isCRFrozenState:!e.isAddRemoveCAAllowed},"DnD"),c.cfgRevActionEvents.publish({event:"ConfiguredRevisionAssociatedObjectsUpdated"})):(e.removeDropOverCssinEmtpyView(),l.showwarning(v.CfgCRFailedAddCA,"error"))},function(i){e.removeDropOverCssinEmtpyView(),l.showwarning(v.CfgSearchKO,"error")}):(e.removeDropOverCssinEmtpyView(),l.showwarning(v.CfgCRFailedAddCA,"error"))}}else l.showwarning(v.CfgCRContentNotReady,"warning")}),c.cfgRevActionEvents.subscribe({event:"showInheritedOnCfgRevSummaryView"},function(i){if(!e.isCancelClicked){if(e.isModified){let i="showInheritedCAEvent";e.showToggleInheritedWarningDialog(i)}else e.showInherited=!0,e.initConfigurationRevisionServices(e.env,e.tenantID,e.instanceID);e.isChangeActionViewExpanded=e.changeActionCRViewExapnder?e.changeActionCRViewExapnder.expandedFlag:""}e.isCancelClicked=!1}),c.cfgRevActionEvents.subscribe({event:"showImplicitOnCfgRevSummaryView"},function(i){if(!e.isCancelClicked){if(e.isModified){let i="showImplicitCAEvent";e.showToggleInheritedWarningDialog(i)}else e.showImplicit=!0,e.initConfigurationRevisionServices(e.env,e.tenantID,e.instanceID);e.isChangeActionViewExpanded=e.changeActionCRViewExapnder?e.changeActionCRViewExapnder.expandedFlag:""}e.isCancelClicked=!1}),c.cfgRevActionEvents.subscribe({event:"showInheritedOnCfgRevInstanceSummaryView"},function(i){if(!e.isInstanceWarningDialogCancelClicked){if(e.isModified){let i="showInheritedInstanceEvent";e.showToggleInheritedWarningDialog(i)}else e.showInheritedInstances=!0,e.initConfigurationRevisionServices(e.env,e.tenantID,e.instanceID);e.isInstanceViewExpanded=e.instanceCRViewExapnder?e.instanceCRViewExapnder.expandedFlag:""}e.isInstanceWarningDialogCancelClicked=!1}),c.cfgRevActionEvents.subscribe({event:"hideInheritedOnCfgRevSummaryView"},function(i){if(!e.isCancelClicked){if(e.isModified){let i="hideInheritedCAEvent";e.showToggleInheritedWarningDialog(i)}else e.showInherited=!1,e.initConfigurationRevisionServices(e.env,e.tenantID,e.instanceID);e.isChangeActionViewExpanded=e.changeActionCRViewExapnder?e.changeActionCRViewExapnder.expandedFlag:""}e.isCancelClicked=!1}),c.cfgRevActionEvents.subscribe({event:"hideImplicitOnCfgRevSummaryView"},function(i){if(!e.isCancelClicked){if(e.isModified){let i="hideImplicitCAEvent";e.showToggleInheritedWarningDialog(i)}else e.showImplicit=!1,e.initConfigurationRevisionServices(e.env,e.tenantID,e.instanceID);e.isChangeActionViewExpanded=e.changeActionCRViewExapnder?e.changeActionCRViewExapnder.expandedFlag:""}e.isCancelClicked=!1}),c.cfgRevActionEvents.subscribe({event:"hideInheritedOnCfgRevInstanceSummaryView"},function(i){if(!e.isInstanceWarningDialogCancelClicked){if(e.isModified){let i="hideInheritedInstanceEvent";e.showToggleInheritedWarningDialog(i)}else e.showInheritedInstances=!1,e.initConfigurationRevisionServices(e.env,e.tenantID,e.instanceID);e.isInstanceViewExpanded=e.instanceCRViewExapnder?e.instanceCRViewExapnder.expandedFlag:""}e.isInstanceWarningDialogCancelClicked=!1}),c.cfgRevActionEvents.subscribe({event:"removeSelectionFromCfgRevSummaryView"},function(i){if(i.length>0){if(i.forEach(function(i){e.selector_collection.add(e.summary_collection.get(i))}),e.summary_collection.remove(i),e.isModified=!0,c.cfgRevActionEvents.publish({event:"ConfiguredRevisionAssociatedObjectsUpdated"}),e.cfgUXEnvVariablesJS.isCRGroupByEnabled){var t=e.summary_collection._models.filter(e=>"local"===e._attributes.type);c.cfgRevCASummaryActionEvents.publish({event:"updateTheSummaryCAViewWithTheCount",data:t.length}),c.cfgRevCASummaryActionEvents.publish({event:"updateTheSummaryViewImplicitCAWithTheCount",data:e.getTheImplicitCACount()})}e.updateTheCAExpanderWithTotalCACount()}}),c.cfgRevActionEvents.subscribe({event:"ConfiguredRevisionAssociatedObjectsSaveClicked"},function(i){e.isInstanceViewExpanded=e.instanceCRViewExapnder?e.instanceCRViewExapnder.expandedFlag:"",e.isChangeActionViewExpanded=e.changeActionCRViewExapnder?e.changeActionCRViewExapnder.expandedFlag:"",e.turnTheSpinnerOn(),e.summary_collection&&e.summary_collection.isUpdated&&(e.summary_collection.isUpdated=!1,l.setChangeActionContentForConfigurationRevision(e.instanceID,e.summary_collection.getRootModelsIDArray()).then(function(i){l.showwarning(v.CfgCRSetContentSuccess,"success"),e.initConfigurationRevisionServices(e.env,e.tenantID,e.instanceID)},function(i){e.initConfigurationRevisionServices(e.env,e.tenantID,e.instanceID),l.showwarning(v.CfgCRSetContentFail,"error"),e.removeDropOverCssinEmtpyView()})),e.instance_collection&&e.instance_collection.isUpdated&&(e.instance_collection.isUpdated=!1,l.setInstanceContentForConfigurationRevision(e.instanceID,[],e.removedInstanceIds).then(function(i){l.showwarning(v.CfgCRSetContentSuccess,"success"),e.removedInstanceIds=[],e.initConfigurationRevisionServices(e.env,e.tenantID,e.instanceID)},function(i){i&&i.errorMessage&&i.errorMessage.includes("The current ConfigurationRevision has already some ChangeActions defined, it is forbidden to select instances manually")?l.showwarning(v.CfgCRForbiddenInstance,"error"):l.showwarning(v.CfgCRSetContentFail,"error"),e.removedInstanceIds=[],e.initConfigurationRevisionServices(e.env,e.tenantID,e.instanceID)})),e.turnTheSpinnerOff(),e.isModified&&(e.isModified=!1)}),c.cfgRevActionEvents.subscribe({event:"CfgRevToggleInheritedDialogOkButtonClicked"},function(i){"showInheritedCAEvent"!==i&&"hideInheritedCAEvent"!==i||(e.showInherited="showInheritedCAEvent"===i),"showImplicitCAEvent"!==i&&"hideImplicitCAEvent"!==i||(e.showImplicit="showImplicitCAEvent"===i),"showInheritedInstanceEvent"!==i&&"hideInheritedInstanceEvent"!==i||(e.showInheritedInstances="showInheritedInstanceEvent"===i),e.initConfigurationRevisionServices(e.env,e.tenantID,e.instanceID),e.isModified=!1}),c.cfgRevActionEvents.subscribe({event:"IsCancelClickedSetToTrue"},function(i){"showInheritedCAEvent"===i||"hideInheritedCAEvent"===i||"showImplicitCAEvent"===i||"hideImplicitCAEvent"===i?e.isCancelClicked=!0:e.isInstanceWarningDialogCancelClicked=!0}),c.cfgRevActionEvents.subscribe({event:"loadCfgRevInstanceSummaryView"},function(i){e.instance_collection.isReady()?e.instance_collection.size()>0&&(e.showInheritedInstances||(e.instance_collection._models=e.instance_collection.getRootModelsArray().filter(e=>"inherited"!==e._attributes.instanceType)),c.cfgRevActionEvents.publish({event:"updateTheInstancesExpanderHeaderWithTheCount",data:e.instance_collection.size()}),e.cfgRevInstanceMainView.loadCfgRevInstanceSummaryView({cfgRevObjects:e.instance_collection.getRootModelsArray()})):l.showwarning(v.CfgCRContentNotReady,"warning")}),c.cfgRevActionEvents.subscribe({event:"removeSelectionFromCfgRevInstanceSummaryView"},function(i){if(i.length>0){if(e.instance_collection.remove(i),e.removedInstanceIds=[...e.removedInstanceIds,...i],e.isModified=!0,e.cfgUXEnvVariablesJS.isCRGroupByEnabled){let i=e.instance_collection._models.filter(e=>"local"===e._attributes.instanceType);c.cfgRevInstanceActionEvents.publish({event:"updateTheUserDefinedInstancesCount",data:i.length})}c.cfgRevActionEvents.publish({event:"ConfiguredRevisionAssociatedObjectsUpdated"}),c.cfgRevActionEvents.publish({event:"updateTheInstancesExpanderHeaderWithTheCount",data:e.instance_collection.size()})}}),c.cfgRevActionEvents.subscribe({event:"updateTheCAExpanderHeaderWithTheCount"},i=>{e.isHeaderAllowed?c.cfgRevSummaryToolbarActionEvents.publish({event:"updateTheCASummaryViewHeaderLabelWithTheCount",data:i}):e.changeActionCRViewExapnder.header=v.CfgLabelChangeActions+" ("+i+")"}),c.cfgRevActionEvents.subscribe({event:"updateTheInstancesExpanderHeaderWithTheCount"},i=>{e.instanceCRViewExapnder.header=v.CfgCRLabelInstances+" ("+i+")"})},removeDropOverCssinEmtpyView:function(){let e=this.cfgRevMainView.container.getElement(".empty-view-container");e&&e.hasClassName("dropOverEmptyView")&&e.removeClassName("dropOverEmptyView")},showToggleInheritedWarningDialog:function(e){let i=function(){if("showInheritedCAEvent"===e||"hideInheritedCAEvent"===e){let i="showInheritedCAEvent"!==e;c.cfgRevSummaryToolbarActionEvents.publish({event:"CfgRevToggleInheritedDialogCancelClicked",data:i})}if("showImplicitCAEvent"===e||"hideImplicitCAEvent"===e){let i="showImplicitCAEvent"!==e;c.cfgRevSummaryToolbarActionEvents.publish({event:"CfgRevToggleImplicitDialogCancelClicked",data:i})}if("showInheritedInstanceEvent"===e||"hideInheritedInstanceEvent"===e){let i="showInheritedInstanceEvent"!==e;c.cfgRevInstanceListViewToolbarActionEvents.publish({event:"CfgRevToggleInheritedInstanceDialogCancelClicked",data:i})}c.cfgRevActionEvents.publish({event:"IsCancelClickedSetToTrue",data:e}),n.closeDialog()},t={width:539,height:170,isResizable:!1,dialogue:{header:p.CFG_REV_WARNING_DIALOG_HEADER,buttonArray:[{label:"Ok",labelValue:p.CFG_REV_ACTION_OK,handler:function(){c.cfgRevActionEvents.publish({event:"CfgRevToggleInheritedDialogOkButtonClicked",data:e}),c.cfgRevActionEvents.publish({event:"ConfiguredRevisionAssociatedObjectsNotUpdated"}),n.closeDialog()},className:"primary"},{label:"Cancel",labelValue:p.CFG_REV_ACTION_CANCEL,handler:i,className:"default"}],target:widget.body,object:null,postCrossHandler:i}},n=new d(t);n.render(),n.container.setStyle("overflow","auto"),n.container.setHTML(p.CFG_REV_RESET_MESSAGE+"<br><br>"+p.CFG_REV_RESET_QUESTION+"<br>")},getValidDnDObjects:function(e){let i=e.filter(e=>this.selector_collection.getAllModelsIDArray().includes(e));return JSON.stringify(i)===JSON.stringify(e)}})});