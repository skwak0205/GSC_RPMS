define("DS/WidgetServices/WidgetServices",["UWA/Array","UWA/Widget","UWA/Utils","UWA/Json","UWA/Core","DS/Controls/ProgressBar","DS/WAFData/WAFData"],function(e,t,n,r,i,s,o){"use strict";var a=!1,l=!1,c=!1,u={},d={},f={},g=null,h={setReplayODT:function(e){a=e},isReplayODT:function(){return a},isReplayedODT:function(){return this.isReplayODT()||"infra_odt_wgd"===this.getWidgetId()||!0===window.isReplayODT},isTransientWidget:function(){var e=this.getWidgetId();return!!e&&0===e.indexOf("preview")},setODTMultiSel:function(e){l=e},isMultiSelODT:function(){return l},isTouchDevice:function(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0},setODTComment:function(e){c=e},isCommentODT:function(){return c},getProdLevel:function(){return this.isReplayODT()?0:2},generateUniqueId:function(){return(new Date).getTime()+""+10*Math.random()},commonChar:function(e,t,n){var r=e,i=t;r.length>i.length&&(r=t,i=e);for(var s={},o=0,a=0;a<r.length&&(0===o||!n);a++){var l=r[a];!s[l]&&i.indexOf(l)>=0&&o++,s[l]=!0}return o},removeDuplicate:function(t,n){var r=[];if(null!=t&&e.isArray(t)){var i={};t.forEach(function(e){var t=n(e);1!==i[t]&&(i[t]=1,r.push(e))})}return r},arrayContains:function(e,t,n){return this.arrayContains2(e,t,function(e,t){return n(e)==n(t)})},arrayContains2:function(e,t,n){var r=-1;return e.every(function(e,i){return!n(e,t)||(r=i,!1)}),r},getImageUser:function(e,t){var n="";n=3==e?"fonticon fonticon-users-group":2==e?"fonticon fonticon-users":"fonticon fonticon-user";return"medium"===t&&(n+=" fonticon-2x "),{tag:"span",class:n}},getUrl:function(){return window.location.href},getRealPath:function(e,t,n){var r="";if(null==n&&(n=!1),(t=t||this.getWidgetObject())&&"function"==typeof t.getUrl&&0!=this.getProdLevel()){var i=t.getUrl();""!=(r=i.substring(0,i.indexOf("/webapps")))&&null!=r&&!1===n?r+="/webapps/":(r=t.getUrl(),r=(r=this.removeParameterOfUrl(r)).substring(0,r.lastIndexOf("/")),n&&(r+="/"))}else r=this.getUrl(),r=this.removeParameterOfUrl(r);return UWA.Utils.buildUrl(r,e)},removeParameterOfUrl:function(e){var t=e.split("?");if(t.length>0)return t[0]},startProgress:function(e,t,n){if(!this.isProgressBusy()){if(this.currentProgressBar=t.partisionedProgressLabel,this.labelWaitingOperation=UWA.i18n(t.partisionedProgressLabel),this.progressContextDiv=t.progressBarContext,this.progressContextDiv){this.progressContextDiv.addClassName("masked");var r=i.createElement("div",{class:"mask"}),o=i.createElement("div",{class:"PBwrapper"}),a=i.createElement("div",{class:"PBcontent"});if(i.createElement("span",{class:"text",text:this.labelWaitingOperation}).inject(a),new UWA.Element("div",{class:"wux-control-inline-container",style:{"vertical-align":"top"}}).inject(a),a.inject(o),o.inject(r),r.inject(this.progressContextDiv),this.progressContextRenderTo=a,!0!==t.useWaitCursor){if(this.progressbar=new s({value:0}).inject(a),null!=e){var l=parseInt(t.progressBarStowedHits,10),c=this.progressbar.value+100/(e.length/n)/1*l;c=Math.min(c,100),console.log(c),this.progressbar.value=c,console.log(this.progressbar.value),t.progressBarStowedHits=0}}else this.progressbar=void 0,r.style.cursor="wait",void 0!==t.progressBarWaitContext&&(t.progressBarWaitContext.style.cursor="wait")}if(null!=t.disableActionBar&&null!=this.modifiedElement){this.modifiedElement.forEach(function(e){e.hasClassName("wux-ui-state-disabled")&&e.removeClassName("wux-ui-state-disabled")})}this.modifiedElement=[];var u=[];if(null!=t.disableActionBar){var d=document.querySelectorAll(".wux-afr-cmdstarter");null!=d&&"function"==typeof d.forEach&&d.forEach(function(e){e.hasClassName("wux-ui-state-disabled")||(e.addClassName("wux-ui-state-disabled"),u.push(e))})}this.modifiedElement=u}},isProgressBusy:function(){var e=!1;this.progressContextDiv&&(this.progressContextDiv.getElement(" > .mask")&&(e=!0));return e},stopProgress:function(e,t){var n=this;if(n.currentProgressBar==e.partisionedProgressLabel){var r=20;t.length>200&&(r=200),t.length>400&&(r=2e3),setTimeout(function(){if(n.modifiedElement.forEach(function(e){e.hasClassName("wux-ui-state-disabled")&&e.removeClassName("wux-ui-state-disabled")}),n.progressContextDiv){var t=n.progressContextDiv.getElement(" > .mask");t&&t.destroy(),n.progressContextDiv.removeClassName("masked")}n.progressContextRenderTo=n.progressContextDiv,!0===e.useWaitCursor&&void 0!==e.progressBarWaitContext&&(e.progressBarWaitContext.style.cursor="")},r)}},updateProgress:function(e,t,n){if(this.startProgress(e,n,t),this.currentProgressBar!=n.partisionedProgressLabel)n.progressBarStowedHits+=1;else if(null!=this.progressbar){var r=this.progressbar.value+100/(e.length/t)/1;r=Math.min(r,100),console.log(r),this.progressbar.value=r,console.log(this.progressbar.value)}},partitionedAuthenticatedRequest:function(t,n){var i=this;n.progressBarStowedHits=0;var s=r.decode(n.data);if(n.commonKeys=new e,null==n.requestArray)for(var a in s)e.isArray(s[a])?null==n.requestArray&&(n.requestArray=a):n.commonKeys.push(a);var l=s[n.requestArray],c=!1,u=[],d=0,f=5,g=50;null!=n.minChunkSize&&(f=n.minChunkSize),null!=n.maxChunkSize&&(g=n.maxChunkSize);var h=-1;(h=Math.ceil(l.length/20))>g&&(h=g),h<f&&(h=f),l.length<=20&&(n.useWaitCursor=!0),null!=n.symultaneousRequest&&0!=n.symultaneousRequest||i.startProgress(void 0,n,h);var p=n.onComplete;n.onComplete=function(a){i.updateProgress(l,h,n);var f=null;if(null==n.responseArray){for(var g in a)if(e.isArray(a[g])){n.responseArray=g,f=a[n.responseArray];break}}else f="function"==typeof n.responseArray?n.responseArray(a):a[n.responseArray];null!=f&&f.forEach(function(e){u.push(e)});var v=!1;if("function"==typeof n.cancelCallback&&(v=n.cancelCallback()),0==a.success&&null!=a.success&&(c=!0),!v&&d+h<l.length){d+=h;var m=[];if("function"==typeof n.chunkify)m=n.chunkify(d,h,l);else for(var C=d;C<d+h&&C<l.length;C++)m.push(l[C]);if(m.length>0){var y={};n.commonKeys.forEach(function(e){y[e]=s[e]}),y[n.requestArray]=m,n.data=r.encode(y),o.authenticatedRequest(t,n)}}else i.stopProgress(n,l),a.success=!c,"function"==typeof n.responseArrayMerge?a=n.responseArrayMerge(a,u):a[n.responseArray]=u,p.call(null,a)};var v=n.onFailure;n.onFailure=function(e,t,r){i.stopProgress(n,l),v.call(null,e,t,r)};var m=n.onTimeout;n.onTimeout=function(e,t,r){i.stopProgress(n,l),m.call(null,e,t,r)};var C=[];if("function"==typeof n.chunkify)C=n.chunkify(d,h,l);else for(var y=d;y<d+h&&y<l.length;y++)C.push(l[y]);var S={};n.commonKeys.forEach(function(e){S[e]=s[e]}),S[n.requestArray]=C,n.data=r.encode(S),o.authenticatedRequest(t,n)},get3DSpaceUrl:function(e){var t=location.protocol+"//"+location.hostname;return e&&(e.serverUrl=t,e.serverUri="3DSpace"),t+"/3DSpace"},_failUrlAsync:function(e,t,n){var r="3DSpace"===e?this.get3DSpaceUrl(n):"";t.onComplete.call(null,r)},getServicesUrl:function(e){var t=this,n=this._getCancelObject();return this.getWebInWinParameters(function(r){var i=r?r.myAppsBaseUrl:null;!1===n.isCancelled()&&(e.myAppsBaseUrl=i||e.myAppsBaseUrl,n.handler=t.__getServicesUrl(e))}),n},__getServicesUrl:function(t){var n=this,r=this._getCancelObject(),i=t.platformId?t.platformId:null,s=!1;if(i=i||(null!=n.getTenantID()?n.getTenantID():null)){var o=f[i];(s=!!o)&&t.onComplete.call(null,o)}return s||require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(s){if(!1===r.isCancelled()){var o={onComplete:function(n){e.isArray(n)&&n.length>0&&(n=n[0]),n=n||{},i&&(f[i]=n),t.onComplete.call(null,n)},onFailure:function(e){t.onComplete.call(null,{})}};if(i&&(o.platformId=i),t.myAppsBaseUrl){var a={myAppsBaseUrl:t.myAppsBaseUrl,userId:"all",lang:n.getLanguage()};o.config=a}r.handler=s.getPlatformServices(o)}}),r},getWidgetObject:function(){var e=window.widget&&window.widget instanceof t;return g||((g=e?window.widget:new t).body||(g.body=UWA.extend(document.body)),e||(g.lang=window.top.dsLang?window.top.dsLang:g.lang,window.widget=g),g)},addWidgetResizeEvent:function(e){var t=this.getWidgetObject();(t||this.getWidgetBody()).addEvent("onResize",e)},removeWidgetResizeEvent:function(e){var t=this.getWidgetObject();(t||this.getWidgetBody()).removeEvent("onResize",e)},setWidgetObject:function(e){g=e},getLanguage:function(){var e=this.getWidgetObject(),t=null;return window.COMPASS_CONFIG&&(t=window.COMPASS_CONFIG.lang),e&&null==t&&(t=e.lang?e.lang:this.getWidgetValue("lang")),t||(t=window.top.dsLang?window.top.dsLang:"en"),t},setWidgetValue:function(e,t){var n=this.getWidgetObject();n&&"function"==typeof n.setValue&&n.setValue(e,t),u[e]=t},getWidgetValue:function(e){var t=this.getWidgetObject(),n=t&&"function"==typeof t.getValue?t.getValue(e):void 0;return n||(n=u[e]),n},deleteWidgetValue:function(e){var t=this.getWidgetObject();t&&"function"==typeof t.deleteValue&&t.deleteValue(e),delete u[e]},addWidgetPreference:function(e){var t=this.getWidgetObject();t&&"function"==typeof t.addPreference&&t.addPreference(e)},setWidgetPreferences:function(e){var t=this.getWidgetObject();t&&"function"==typeof t.setPreferences&&t.setPreferences(e)},getWidgetPreferences:function(){return this.getWidgetObject().preferences},getWidgetPreference:function(e){var t=this.getWidgetObject();return t&&"function"==typeof t.getPreference?t.getPreference(e):null},getWidgetPreferenceValue:function(e){var t=this.getWidgetPreference(e);return t&&t.value?t.value:null},getWidgetId:function(){var e=this.getWidgetObject();return e?e.id:"0"},getWidgetBody:function(){var e=this.getWidgetObject();return e&&e.body?e.body:UWA.extend(document.body)},isDebug:function(){return"1"===this.getWidgetValue("debug_me")},getTenantID:function(e){var t=this.getWidgetValue("x3dPlatformId");return(t=t||("undefined"!=typeof enoviaServerCAWidget?enoviaServerCAWidget.tenant:null))||e},setTenantID:function(e){this.setWidgetValue("x3dPlatformId",e)},getTenants:function(e){var t=this;this._getPlatformServices(function(n){var r=[];null!==n&&(n.forEach(function(e){r.push(e.platformId)}),t.getTenantID()||t.setTenantID(r[0])),e.call(this,r)})},getWebInWinParameters:function(e){var t=this;window.COMPASS_CONFIG&&window.COMPASS_CONFIG.myAppsBaseUrl?e(window.COMPASS_CONFIG):this._getMyappsUrl(function(n){window.COMPASS_CONFIG||(window.COMPASS_CONFIG={}),n&&(window.COMPASS_CONFIG.myAppsBaseUrl=n,window.COMPASS_CONFIG.userId||(window.COMPASS_CONFIG.userId=window.enoviaServerCAWidget&&window.enoviaServerCAWidget.contextUser?window.enoviaServerCAWidget.contextUser:"all"),window.COMPASS_CONFIG.lang||(window.COMPASS_CONFIG.lang=t.getLanguage())),e(window.COMPASS_CONFIG)})},getGrantedRoles:function(e,t){var n=this;require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(r){n.getWebInWinParameters(function(i){r.getGrantedRoles(function(r){var i=[];r.forEach(function(e){var n=!0;t&&e.platforms&&(n=e.platforms.indexOf(t)>=0),(n=n||"InternalDS"===e.id)&&i.push(e.id)}),e.call(n,i)})})})},isChangeAvailable:function(){return!this.isNatifEnvironnement()},isNatifEnvironnement:function(){return"undefined"!=typeof dscef},isWebInWinEnvironment:function(){return this.isCatiaV5Environment()||this.isSolidworksEnvironment()},isCatiaV5Environment:function(){return"catiav5"===this._getEnvironment()},isSolidworksEnvironment:function(){return"solidworks"===this._getEnvironment()},_getEnvironment:function(){return this.getUrlParameter("addinmode")},getUrlParameter:function(e){return this._getUrlParameters()[e]},_getUrlParameters:function(){if(!this.storedUrlParams){var e={},t=[window.top.location];window!==window.top&&t.push(window.location),t.forEach(function(t){t.search.substr(1).split("&").forEach(function(t){var n=t.split("=");n.length>1&&(e[n[0]]=n[1])})}),this.storedUrlParams=e}return this.storedUrlParams},_getMyappsUrl:function(e){this.isNatifEnvironnement()&&"function"==typeof dscef.getMyAppsURL?dscef.getMyAppsURL().then(function(t){console.log("MyApps URL",t),e.call(null,t)}).catch(function(t){console.error("Failed to fetch MyApps URL: "+t),e.call(null,null)}):e.call(null,null)},getCancelObject:function(){return this._getCancelObject()},_getCancelObject:function(){return{isCancelled:function(){return!1!==this.handler.toCancel},cancel:function(){this.handler.cancel()},handler:{toCancel:!1,cancel:function(){this.toCancel=!0}}}},_getServiceUrlAsync:function(e,t,n){var r=this;t=t||{};var i=this._getCancelObject();return this.getWebInWinParameters(function(s){var o=s?s.myAppsBaseUrl:null;!1===i.isCancelled()&&(t.myAppsBaseUrl=o||t.myAppsBaseUrl,i.handler=r.__getServiceUrlAsync(e,t,n))}),i},__getServiceUrlAsync:function(e,t,n){var r=this,i=this._getCancelObject();i._answerGiven=!1,i.hasEnded=function(){return!0===this.toCancel||!0===this._answerGiven},null==t.platformId&&(t.platformId=this.getUrlParameter("tenant"));var s=t.platformId?t.platformId:null,o=!1;if(s=s||(null!=r.getTenantID()?r.getTenantID():null)){var a=d[e+s];(o=!!a)&&(i._answerGiven=!0,t.onComplete.call(null,a))}return o||require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(o){if(!1===i.isCancelled()){setTimeout(function(){i.hasEnded()||!1!==i.isCancelled()||(i.cancel(),t.onComplete.call(null,"3DSpace"===e?r.get3DSpaceUrl(n):""))},5e3);try{var a={serviceName:e,onComplete:function(o){if(i._answerGiven=!0,!1===i.isCancelled()){var a=o;if(o&&"string"!=typeof o&&o.length>0){var l=0;for(a=o[0].url,l=0;l<o.length;l++)t.platformId&&t.platformId.toUpperCase()===o[l].platformId.toUpperCase()&&(a=o[l].url)}a=a||("3DSpace"===e?r.get3DSpaceUrl(n):""),s&&(d[e+s]=a),t.onComplete.call(null,a)}},onFailure:function(s){i._answerGiven=!0,!1===i.isCancelled()&&t.onComplete.call(null,"3DSpace"===e?r.get3DSpaceUrl(n):"")}};if(s&&(a.platformId=s),t.myAppsBaseUrl){var l={myAppsBaseUrl:t.myAppsBaseUrl,userId:"all",lang:r.getLanguage()};a.config=l}if(!1!==t.wintop&&t.wintop){if(t.serverUrl){var c=t.serverUrl[0]["3DSpace"];a.onComplete(c)}}else o.getServiceUrl(a)}catch(s){i._answerGiven=!0,r.displayErrorOnConsole(s.stack),r._failUrlAsync(e,t,n)}}},function(){r.displayErrorOnConsole("Fail loading i3DXCompassServices"),r._failUrlAsync(e,t,n)}),i},displayErrorOnConsole:function(e){console.log("%c"+e,"color: red")},getSourceUrlAsync:function(e,t){var n=e&&e.source?e.source:"3DSpace";return this._getServiceUrlAsync(n,e,t)},get3DSpaceUrlAsync:function(e,t){return this.getSourceUrlAsync(e,t)},get3DSwymUrlAsync:function(e,t){return this._getServiceUrlAsync("3DSwym",e,t)},get3DSearchUrlAsync:function(e,t){return this._getServiceUrlAsync("3DSearch",e,t)},getCompassUrlAsync:function(e,t){return this._getServiceUrlAsync("3DCompass",e,t)},_getPlatformServices:function(e){require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(t){t.getPlatformServices({onComplete:function(t){e.call(this,t)},onFailure:function(t){that.displayErrorOnConsole("Cannot retrieve the Platform Services"),e.call(this,null)}})})},getFullUrl:function(e,t,n){var r="",i=e,s=t,o=this.getWidgetObject();if(null==o||"function"!=typeof o.getUrl||""!=e&&null!=e||""!=t&&null!=t)""!=e&&null!=e||(i=this.getServerUrl()),""!=t&&null!=t||(s=this.getRootURI()),r=UWA.Utils.buildUrl(i,s);else{var a=o.getUrl();s=(r=a.substring(0,a.indexOf("/webapps"))).substring(r.lastIndexOf("/")+1)}if(""==r&&(r=this.get3DSpaceUrl()),null!=n){var l=r;""!==s&&(l=r.substring(0,r.indexOf("/"+s))),n.serverUrl=l,n.serverUri=s}return r},getServerUrl:function(){var e="";return(e=location.host)||(e=location.origin),e.indexOf("http")<0&&(e=location.protocol?location.protocol+"//"+e:"http://"+e),e},getRootURI:function(){var e=location.pathname,t=e.indexOf("/",1);return t<0&&(t=e.indexOf("\\",1)),e=e.substring(0,t)},convertDateToStandard:function(e,t){if(!e)return{value:"",valueDB:""};var n=t?e:new Date,r=e.getUTCFullYear(),i=e.getUTCMonth()+1,s=e.getUTCDate(),o=n.getUTCHours(),a=n.getUTCMinutes(),l=n.getUTCSeconds();return this.isReplayedODT()&&(o=12,a=0,l=0,n.setHours(o),n.setMinutes(a),n.setSeconds(l)),i<10&&(i="0"+i),s<10&&(s="0"+s),o<10&&(o="0"+o),a<10&&(a="0"+a),l<10&&(l="0"+l),n.setYear(r),n.setMonth(e.getMonth()),n.setDate(s),{value:n.toLocaleString(this.getLanguage()),valueDB:r+"/"+i+"/"+s+"@"+o+":"+a+":"+l+":GMT"}},formatDateObj:function(e){if(!e)return null;var t=e.split("@"),n=e;if(t.length>1){var r=t[0].split("/"),i=r[0],s=r[1]-1,o=r[2],a=t[1].split(":"),l=a[0],c=a[1],u=a[2];(n=new Date).setUTCHours(l),n.setUTCMinutes(c),n.setUTCSeconds(u),n.setUTCFullYear(i),n.setUTCDate(1),n.setUTCMonth(s),n.setUTCDate(o)}return n},formatDate:function(e,t){var n=e,r=e instanceof Date?e:this.formatDateObj(e);return r&&(n=1==t?r.toLocaleString(this.getLanguage()):r.toLocaleDateString(this.getLanguage())),n},addNewStyles:function(e,t,n){var r="";for(var i in t){var s=t[i],o="{";for(var a in s){o+=a+":"+s[a]+";"}o.length>1&&(r+=i+" "+(o+="}"))}if(r)return this.addNewStyle(e,r,n)},addNewStyle:function(e,t,n){var r=this,i=document.getElementsByClassName(e),s=null;return i&&i.length>0&&(s=i[0]),n&&s&&(this.addNewStyle(e+"_temp",t,!1),s.parentNode.removeChild(s),s=null),s||((s=document.createElement("style")).type="text/css",s.className=e,document.getElementsByTagName("head")[0].appendChild(s)),s.appendChild(document.createTextNode(t)),setTimeout(function(){r.clearJSStylesheet(e+"_temp")}),s},clearJSStylesheet:function(e){var t=document.getElementsByClassName(e);t&&t.length>0&&t[0].parentNode.removeChild(t[0])},download:function(e,t,n,r){var i="json"===n,s=i?JSON.stringify(t,null,"\t"):t;if(e=this.isReplayedODT()?"ODT_ToRemove":e,!0===r){var o=this.getTenantID();e+=o?"_"+o:""}e+=i?".json":".txt";var a=(i?"application/json":"text/plain")+";charset=utf-8;";if(window.navigator&&window.navigator.msSaveOrOpenBlob){var l=new Blob([decodeURIComponent(encodeURI(s))],{type:a});window.navigator.msSaveOrOpenBlob(l,e)}else{var c=document.createElement("a");c.setAttribute("href","data:"+a+","+encodeURIComponent(s)),c.setAttribute("download",e),c.setAttribute("target","_blank"),document.body.appendChild(c),c.click(),document.body.removeChild(c)}},compareValue:function(e,t){if(!isNaN(e)||!isNaN(t)){if(!isNaN(e)&&!isNaN(t))return Number(t)==Number(e)?0:Number(t)>Number(e)?1:-1;e+="",t+=""}return t.localeCompare(e,void 0,{numeric:!0,sensitivity:"base"})}};return window.widget&&!0===window.widget.getValue("proto")&&(h.servicesUrls=d),h}),define("DS/WidgetServices/commandProxy/CommandProxy",["UWA/Class","DS/PlatformAPI/PlatformAPI"],function(e,t){"use strict";var n="DS/PADUtils/PADCommandProxy/select",r=e.extend({subscriptions:{},choices:{SELECT:"onSelect",UPDATE:"onUpdateTransient"},onSelect:function(e){var n=t.subscribe("DS/PADUtils/PADCommandProxy/select",function(t){if(null!=t.metadata&&(n=t.metadata.appid),null!=n&&0===n.indexOf("/"))var n=n.substr(1);var r=Object.keys(widget.data).length;void 0!==widget.data&&widget.data.appId==n&&widget.data.x3dAppId==n&&0!==r||e.apply(null,[t.data,t])});this.unsubscribe(this.choices.SELECT),this.subscriptions[this.choices.SELECT]=n},onUpdateTransient:function(e){var n=t.subscribe("DS/Properties/CommandProxy/update",function(t){e.call(null,t)});this.unsubscribe(this.choices.UPDATE),this.subscriptions[this.choices.UPDATE]=n},init:function(e){this.subscribe(e)},subscribe:function(e){for(var t in e)if("function"==typeof e[t])switch(t){case this.choices.SELECT:this.onSelect(e[t]);break;case this.choices.UPDATE:this.onUpdateTransient(e[t])}},unsubscribe:function(e){var n=this.subscriptions[e];n&&(t.unsubscribe(n),this.subscriptions[e]=null)},destroy:function(){for(var e in this.subscriptions)this.unsubscribe(e);this._parent()}});return r.create=function(e){var t;return e&&(t=e.events),new r(t)},r.publishUpdate=function(e,n){t.publish("DS/Properties/CommandProxy/update",{models:e,options:n})},r.publishSelect=function(e){t.publish(n,e)},r}),define("DS/WidgetServices/moveHelper/MoveHelper",["UWA/Controls/Abstract"],function(e){"use strict";var t=null,n=null,r=!1,i=function(e){if(null!=t){t.getElement();var r=o(e),i={x:n.x-r.x,y:n.y-r.y};t.dispatchEvent("move",{diff:i})}},s=function(e){null!=t&&t.dispatchEvent("endMove"),t=null},o=function(e){return null!=e.changedTouches?{x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY}:{x:e.clientX,y:e.clientY}},a=[];function l(){document.removeEventListener("mousemove",i),document.removeEventListener("touchmove",i),document.removeEventListener("mouseup",s),document.removeEventListener("touchend",s),document.body.removeEventListener("mouseleave",s),document.body.removeEventListener("touchleave",s),r=!1}var c=e.extend({init:function(e){this._parent(e);var t=this;this._handlerFirstActionResize=function(e){t._firstActionResize(e)},r||(r=!0,document.addEventListener("mousemove",i),document.addEventListener("touchmove",i),document.addEventListener("mouseup",s),document.addEventListener("touchend",s),document.body.addEventListener("mouseleave",s),document.body.addEventListener("touchleave",s)),e.element.addEventListener("mousedown",this._handlerFirstActionResize),e.element.addEventListener("touchstart",this._handlerFirstActionResize),a.push(this)},getElement:function(){return this.options.element},disconnect:function(){this.options.element.removeEventListener("mousedown",this._handlerFirstActionResize),this.options.element.removeEventListener("touchstart",this._handlerFirstActionResize)},_firstActionResize:function(e){e.preventDefault(),this.dispatchEvent("startMove"),t=this,n=o(e)},destroy:function(){var e=this;this.disconnect();var t=[];a.forEach(function(n){n!==e&&t.push(n)}),0===(a=t).length&&l(),this._parent()}});return c.removeAll=function(){a.forEach(function(e){e.disconnect()}),a=[],l()},c}),define("DS/WidgetServices/MultipleAsynchronousRequests",[],function(){"use strict";return function(e,t){var n={},r=e.length,i=t;this.setAnswer=function(t,s){e.indexOf(t)>=0&&(void 0===n[t]&&r--,n[t]=s),r<=0&&null!==i&&i.call(this)},this.getAnswer=function(e){return n[e]},this.addRequest=function(t){e.indexOf(t)<0&&(e.push(t),r++)}}}),define("DS/WidgetServices/UIInfra/UIInfra",["css!DS/WidgetServices/WidgetServices.css"],function(e){"use strict";var t=UWA.createElement("div",{class:"Ghost_copiedElementContainer"});return{createGhostDnD:function(e,n){var r=n.number>99?"99+":n.number,i=null;n.number>1&&(i=UWA.createElement("span",{class:"Ghost_infoDrag",text:r})),t.inject(document.body);var s=e.target.cloneNode(!0),o=(e.target.getSize(),"Ghost_left"),a=null;if("function"!=typeof DataTransfer.prototype.setDragImage){a=UWA.extend(e.target,UWA.element);var l={x:e.offsetX,y:e.offsetY},c=(e.target.getSize(),{left:l.x,right:200-l.x}),u=!0;c.left<=30&&c.left<=c.right&&(o="Ghost_right",u=!1),null!==i&&(a.addClassName(o),u?e.target.insertBefore(i,e.target.firstChild):e.target.appendChild(i)),e.target.parentNode.insertBefore(s,e.target),e.target.addClassName("Ghost_tempObj"),setTimeout(function(){e.target.removeClassName("Ghost_tempObj"),e.target.parentNode.removeChild(s),null!==i&&e.target.removeChild(i)},0)}else(a=UWA.extend(s,UWA.Element)).addClassName("Ghost_draggingObj"),t.appendChild(s),null!==i&&(a.addClassName(o),s.insertBefore(i,s.firstChild)),e.dataTransfer.setDragImage(s,-10,-10),setTimeout(function(){t.removeChild(s)});a.addClassName(n.className),a.addClassName("GhostMainContainer"),setTimeout(function(){a.removeClassName(o),a.removeClassName(n.className),a.removeClassName("GhostMainContainer"),t.remove()},0)}}}),define("DS/WidgetServices/securityContextServices/SecurityContextServices",["UWA/Class","UWA/Json","DS/WidgetServices/WidgetServices","i18n!DS/WidgetServices/assets/nls/SecurityContextNls"],function(e,t,n,r){"use strict";return e.singleton({_currentSecurityContext:"",_preferedSecurityContext:"",options:{serverName:"",serverUri:"",isStandalone:!1,alwaysUpdate:!1,context:null,wintop:!1,tenant:null,source:null},init:function(e){this._parent()},getInstance:function(e){try{this.init(e)}catch(e){}for(var t in e)this.options[t]=e[t];return this},getSecurityContext:function(e,t){if(this._currentSecurityContext=null,this.options.context&&"function"==typeof this.options.context.getSecurityContext){var n=this.options.context.getSecurityContext();if(n&&n.SecurityContext)return this._currentSecurityContext=n,void this._computeSecurityContext(e)}var r=!1;if(null!=t&&(null!=t.serverName&&(t.serverName!=this.options.serverName&&(r=!0),this.options.serverName=t.serverName),null!=t.serverUri&&(t.serverUri!=this.options.serverUri&&(r=!0),this.options.serverUri=t.serverUri)),!0===this.options.alwaysUpdate&&(r=!0),1==r||""==this._preferedSecurityContext||null==this._preferedSecurityContext.SecurityContext)return this._getSecurityContext(!0,e);this._computeSecurityContext(e)},_computeSecurityContext:function(e){if(null===this._currentSecurityContext&&(this._currentSecurityContext=this._preferedSecurityContext),null!=e)if(this._currentSecurityContext&&this._currentSecurityContext.SecurityContext){var t=this._currentSecurityContext.SecurityContext,n="";0!=t.indexOf("ctx::")&&(n="ctx::"),this._currentSecurityContext.SecurityContext=n+t,e.onSuccess.call(this,this._currentSecurityContext)}else{var i={message:r.get("ErrorSecurityContextEmpty"),code:"ERROR"};e.onFailure.call(this,i)}},_getSecurityContext:function(e,t){var r=this,i=n._getCancelObject();if(!1!==e||""!=this.options.serverName||""!=this.options.serverUri){var s={Accept:"application/json","Content-Type":"application/json"};if(!1===e)this.options.serverName,this.options.serverUri;return require(["DS/WAFData/WAFData","DS/WidgetServices/WidgetServices"],function(n,o){if(!1===i.isCancelled()){var a=r.options.tenant;a=a||o.getTenantID(),i.handler=o.getSourceUrlAsync({platformId:a,source:r.options.source,onComplete:function(a){var l=a+"/resources/pno/person/getsecuritycontext",c=r.options.tenant;(c=c||o.getTenantID())&&(l+="?tenant="+c);var u="";!1===r.options.isStandalone&&2==r.prodLevel&&(u="passport"),s["Accept-Language"]=o.getLanguage();var d={type:"json",method:"GET",proxy:u,headers:s,onComplete:function(n){r._onCompleteGetSecurityContext(n,e,t)},onFailure:function(n,i,s){r._onFailureGetSecurityContext(n,i,s,e,t)},onTimeout:function(){r._onTimeoutGetSecurityContext(e,t)}};!1===r.options.isStandalone&&(d.authentication="passport"),i.handler=n.handleRequest(l,d)},serverUrl:r.options.serverUrl,wintop:r.options.wintop})}}),i}this._onFailureGetSecurityContext(null,null,null,e,t)},_onCompleteGetSecurityContext:function(e,t,n){null!=e&&""!=e||0==t?(this._preferedSecurityContext=e,null!=n&&this._computeSecurityContext(n)):this._getSecurityContext(!1,n)},_onTimeoutGetSecurityContext:function(e,t){if(0!=e)this._getSecurityContext(!1,t);else{var n={message:r.get("ErrorTimeOut"),code:"TO"};null!=t&&t.onFailure.call(this,n)}},_onFailureGetSecurityContext:function(e,n,i,s,o){if(this._request=null,0!=s)this._getSecurityContext(!1,o);else{t.isJson(n)&&(n=t.decode(n));var a={};a=null!=n&&n.hasOwnProperty("error")?n.error:{message:r.get("ErrorSecurityContext"),code:"ERROR"},o&&"function"==typeof o.onFailure&&o.onFailure.call(this,a)}}})});