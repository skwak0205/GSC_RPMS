define("DS/RequirementAttrManagement/views/actions/ChangeColorHandler",[],function(){"use strict";return{execute:function(e){var t=e,n=e.options.attrModel.getSelectedNodes();require(["DS/RequirementAttrManagement/views/private/ColorPicker"],function(e){t.elements.container.disabled=!0;var o={background_color:"#ffffff",color:"#000000"};if(1===n.length&&n[0].getReferenceValue("columnColor")){var i=n[0].getReferenceValue("columnColor");o={background_color:i["background-color"],color:i.color}}new e({selected_color:o,renderTo:document.body,events:{onColorOK:function(e){t.elements.container.disabled=!1;for(var o=[],i=0;i<n.length;i++){var s=n[i],r={};"#ffffff"===e.background_color?r["background-color"]=void 0:r["background-color"]=e.background_color,"#000000"===e.color?r.color=void 0:r.color=e.color,s.updateOptions({grid:{columnColor:r}}),o.push(s.options.columnIndex)}t.options.modelEvents.publish({event:"ENXViews/AttributesCustomization/columnModification",data:{what:"changeColor",modifiedColumns:o,"background-color":r["background-color"]+";",color:r.color+";"}})},onClose:function(){t.elements.container.disabled=!1}}})})}}}),define("DS/RequirementAttrManagement/views/AttributesContants",[],function(){"use strict";return{COLUMNS_EXPORT:"export",TOOLBAR_ACTION_MORE_ATTRIBUTES:"moreAttributes",TOOLBAR_ACTION_DIVISER:"diviser",TOOLBAR_ACTION_MOVE_UP:"moveUp",TOOLBAR_ACTION_MOVE_DOWN:"moveDown",TOOLBAR_ACTION_MOVE_TOP:"moveFirst",TOOLBAR_ACTION_MOVE_BOTTOM:"moveLast",TOOLBAR_ACTION_CHANGE_COLOR:"changeColor",TOOLBAR_ACTION_REMOVE:"trash",TOOLBAR_DEFAULT_ACTIONS:["moreAttributes","diviser","trash"]}}),define("DS/RequirementAttrManagement/views/private/ColorView",["css!DS/RequirementAttrManagement/RequirementAttrManagement","i18n!DS/RequirementAttrManagement/assets/nls/RequirementAttrManagement.json","UWA/Class/View","UWA/Class/Options"],function(e,t,n,o){"use strict";return n.extend(o,{className:"padcolorview",name:"padcolorview",template:function(){var e="";return this.selected_color.color===this.model.get("color")&&this.selected_color.background_color===this.model.get("background_color")&&(e=this.getClassNames("_cell_selected")),this.model.get("custom")?'                <div data-label="'+this.model.get("label")+'" class="'+this.getClassNames("_cell","_custom_cell")+e+'" style="background-color:'+this.model.get("background_color")+';">                <div class="'+this.getClassNames("_content","_custom_content")+' font-3dsregular" style="color:'+this.model.get("color")+';">'+t.colorView.content+"</div>                </div>":'                <div data-label="'+this.model.get("label")+'" class="'+this.getClassNames("_cell")+e+'" style="background-color:'+this.model.get("background_color")+';">                <div class="'+this.getClassNames("_content")+' font-3dsregular" style="color:'+this.model.get("color")+';">'+t.colorView.content+"</div>                </div>"},domEvents:{"click .padcolorview_cell":"_onSelect","click .padcolorview_content":"_onSelect"},setup:function(e){var n=e||{};this._parent(n),this.displayContent=t.colorView.content,n.selected_color?this.selected_color=n.selected_color:this.selected_color={background_color:"#ffffff",color:"#000000"},this.model.addEvent("onChange:selected",this.render.bind(this))},render:function(){return this.container.setHTML(this.template()),this.model.get("empty")?(this.container.getElement("div.padcolorview_cell").setStyle("border-color","#ffffff"),this.container.getElement("div.padcolorview_cell").addClassName("padcolorview_empty_cell")):this.container.getElement("div.padcolorview_cell").addClassName("padcolorview_active_cell"),this.elements.padcolorview_cell=this.container.getElement("div.padcolorview_cell"),this},toggleSelected:function(){!0===this.model.get("selected")?this.model.set("selected",!1):this.model.set("selected",!0)},isSelected:function(){return this.model.get("selected")},_onSelect:function(){this.model.set("empty",!1),this.selected_color.color=this.model._attributes.color,this.selected_color.background_color=this.model._attributes.background_color,this.toggleSelected(),this.dispatchEvent("select",this.model.get("label"))}})}),define("DS/RequirementAttrManagement/views/private/WizardSteps",["text!DS/RequirementAttrManagement/assets/templates/WizardSteps.html","css!DS/RequirementAttrManagement/RequirementAttrManagement.css","i18n!DS/RequirementAttrManagement/assets/nls/RequirementAttrManagement.json","UWA/Core","UWA/Controls/Abstract","DS/Handlebars/Handlebars","DS/Core/Core","css!DS/UIKIT/UIKIT.css"],function(e,t,n,o,i,s,r,a){"use strict";var l=s.compile(e);return s.registerHelper("getlabel",function(e){for(var t=require("i18n!"+this.label.file),n=this.label.key.split("."),o=t,i=0;i<n.length;i++)o=o[n[i]];return o}),i.extend({name:"enx-wizard-container",defaultOptions:{subscribeTokens:[],modelEvents:null,renderTo:null,steps:null,activeStep:null},init:function(e){this._parent(e),this.elements.container=o.createElement("div",{class:this.getClassNames()}),this.options.steps&&this.elements.container.setContent(l(this.options.steps)),this.options.renderTo&&this.elements.container.inject(this.options.renderTo),this.options.rope=this.elements.container.getElement("div.enx-wizard-rope"),this.options.navigator=this.elements.container.getElement("nav.enx-view-navigator");var t=this.elements.container.getElement("a.nav-item.active");if(t){var n=t.id;this._render2ActiveStep(n)}for(var i=this,s=this.options.navigator.getElements("a"),r=0;r<s.length;r++)s[r].addEventListener("click",function(e){var t=e.currentTarget.id;i.changeStep(t)});this.options.subscribeTokens.push(this.options.modelEvents.subscribe({event:"ENXViews/WizardSteps/changeStep"},function(e){var t=e.stepId;i.changeStep(t)}))},changeStep:function(e){this._render2ActiveStep(e),this.options.modelEvents.publish({event:"ENXViews/WizardSteps/stepChanged",data:{stepId:e}})},destroy:function(){for(var e=0;e<this.options.subscribeTokens.length;e++)this.options.modelEvents.unsubscribe(this.options.subscribeTokens[e]);this._parent()},_render2ActiveStep:function(e){for(var t,n=this.options.navigator.getElements("a"),o=!1,i=0;i<n.length;i++){var s=n[i];if(!1===o?s.removeClassName("filled").addClassName("filled"):s.removeClassName("filled"),s.id===this.options.activeView&&s.removeClassName("active"),s.id===e){s.addClassName("active");s.getElement(".view-icon.enx-icon");var r="100%";i<n.length-1&&(r=Math.floor(100/(n.length+1))*(i+1)+"%"),this.options.rope.setStyles({width:r,height:"2px"}),t=s.id,o=!0}}this.options.activeView=t}})}),define("DS/RequirementAttrManagement/views/private/SearchInput",["css!DS/RequirementAttrManagement/RequirementAttrManagement","i18n!DS/RequirementAttrManagement/assets/nls/RequirementAttrManagement.json","UWA/Core","UWA/Controls/Abstract","UWA/Class/Events","UWA/Event","DS/Controls/ButtonGroup","DS/Controls/Button"],function(e,t,n,o,i,s,r,a){"use strict";return o.extend(i,{name:"enx-search-input",init:function(e){this._parent(e);this.elements.container=UWA.createElement("div",{class:this.getClassNames(e.className?e.className:"")}),this.elements.inner=UWA.createElement("div",{class:this.getClassNames("-inner")}).inject(this.elements.container);var n=UWA.createElement("div",{class:this.getClassNames("-input-container")}).inject(this.elements.inner);this.elements.input=UWA.createElement("input",{class:this.getClassNames("-input"),type:"text",placeholder:this.options.placeholder?this.options.placeholder:t.searchInput.placeholder}).inject(n);var o=UWA.createElement("div",{class:this.getClassNames("-right")}).inject(this.elements.inner),i=UWA.createElement("div",{class:this.getClassNames("-clear")+this.getClassNames("-btn")}).inject(o);this.elements.clearBtn=UWA.createElement("div",{class:this.getClassNames("-btnIcon wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-clear"),title:t.searchInput.clear}).inject(i),this.elements.clearBtn.hide();var s=UWA.createElement("div",{class:this.getClassNames("-search")+this.getClassNames("-btn")}).inject(o);this.elements.searchBtn=UWA.createElement("div",{class:this.getClassNames("-btnIcon wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-search"),title:t.searchInput.search}).inject(s),this.elements.searchBtn.setStyle("opacity","0.1"),this.elements.searchBtn.addEventListener("click",this._onSearch.bind(this)),this.elements.clearBtn.addEventListener("click",this._onClearSearch.bind(this)),this.elements.input.addEventListener("keyup",this._onSearchInputKeyUp.bind(this)),this.elements.input.addEventListener("paste",this._onSearchInputPaste.bind(this)),this.elements.input.addEventListener("keydown",this._onSearchInputKeyDown.bind(this))},clear:function(e){this._onClearSearch(null,e)},_onSearch:function(e){this.elements.input.blur(),this.dispatchEvent("onSearch",{searchStr:this.elements.input.value})},_onClearSearch:function(e,t){this.elements.input.value="",this.elements.clearBtn.hide(),this.elements.searchBtn.setStyle("opacity","0.1"),!0!==t&&this.dispatchEvent("onSearch",{searchStr:this.elements.input.value})},_onSearchInputKeyUp:function(e){this.elements.input.value?(this.elements.searchBtn.setStyle("opacity","1"),this.elements.clearBtn.setStyle("display","inline-block"),this.dispatchEvent("onSearch",{searchStr:this.elements.input.value})):(this.elements.clearBtn.hide(),this.elements.searchBtn.setStyle("opacity","0.1"),this.dispatchEvent("onSearch",{searchStr:this.elements.input.value}))},_onSearchInputPaste:function(e){var t=this;setTimeout(function(){t._onSearchInputKeyUp()}.bind(this),200)},_onSearchInputKeyDown:function(e){"return"!==s.whichKey(e)&&"Enter"!==e.keyIdentifier&&"return"!==e.keyIdentifier||this._onSearch(),s.stopPropagation(e)}})}),define("DS/RequirementAttrManagement/views/actions/MoveColumnsHandler",[],function(){"use strict";return{execute:function(e,t){var n=e.options.attrModel.getSelectedNodes();!0===e.options.withDgv?this.__dgvMoveColumn.apply(e,[t,n]):this.__treeMoveColumn.apply(e,[t,n])},__dgvMoveColumn:function(e,t){var n=this;1===t.length&&this.options.attrModel.withTransactionUpdate(function(){var o,i=t[0],s=i.getReferenceValue("pinContent"),r=i._getLocalID?i._getLocalID():i._localID,a=n.__locateFirstAndLastPin(s),l=a.first._getLocalID?a.first._getLocalID():a.first._localID,c=a.last?a.last._getLocalID?a.last._getLocalID():a.last._localID:n.options.getRoots().length-1;switch(e){case"moveFirst":o=l;break;case"moveUp":o=l<=r-1?r-1:r;break;case"moveDown":o=c>=r+1?r+1:r;break;case"moveLast":o=c}if(r!==o){var d={fromID:r,toID:o};n._isMoving=!0,n.options.attrModel.addChild(i,d.toID),i.select(),n._isMoving=!1,n.options.modelEvents.publish({event:"ENXViews/AttributesCustomization/columnModification",data:{what:"moveColumn",move2perform:d}})}})},__treeMoveColumn:function(e,t){var n=this;1===t.length&&this.options.attrModel.withTransactionUpdate(function(){var o=t[0],i=o._getLocalID?o._getLocalID():o._localID,s={fromID:i,toID:-1};switch(e){case"moveFirst":s.toID=0;break;case"moveUp":s.toID=i-1;break;case"moveDown":s.toID=i+1;break;case"moveLast":s.toID=n.options.attrModel.getRoots().length-1}-1!==s.toID&&i!==s.toID&&s.toID<n.options.attrModel.getRoots().length&&(n._isMoving=!0,n.options.attrModel.addChild(o,s.toID),o.select(),n._isMoving=!1,n.options.modelEvents.publish({event:"ENXViews/AttributesCustomization/columnModification",data:{what:"moveColumn",move2perform:s}}))})}}}),define("DS/RequirementAttrManagement/views/actions/RemoveAttributesHandler",[],function(){"use strict";return{execute:function(e){require(["DS/PADServices/utils/GlobalUtils","i18n!DS/RequirementAttrManagement/assets/nls/RequirementAttrManagement.json"],function(t,n){var o=e,i=o.options.attrModel.getSelectedNodes();if(Array.isArray(i)&&1===i.length){var s=i[0];if(s.options.grid.layout&&!1===s.options.grid.layout.removable||s.options.grid.isAdditionalColumn&&!0===s.options.grid.isAdditionalColumn)return;e.options.attrModel.removeRoot(s)}o.options.attrModel.withTransactionUpdate(function(){for(var e=0;e<i.length;e++)!0===i[e].options.grid.isAdditionalColumn||i[e].options.grid.layout&&!1===i[e].options.grid.layout.removable?(i[e].unselect(),t.displayNotif({level:"warning",message:n.replace(n.attributesCustomization.cannotRemove,{attr:i[e].getReferenceValue("attrTitle")})})):o.options.attrModel.removeRoot(i[e])})})}}}),define("DS/RequirementAttrManagement/views/private/CustomColorView",["css!DS/RequirementAttrManagement/RequirementAttrManagement","i18n!DS/RequirementAttrManagement/assets/nls/RequirementAttrManagement.json","UWA/Class/View"],function(e,t,n){"use strict";return n.extend({className:"padcustomcolorview",name:"padcustomcolorview",template:function(){return'              <div data-label="'+this.model.get("label")+'" class="'+this.getClassNames("_cell")+'" style="background-color:'+this.model.get("background_color")+';">              <div class="'+this.getClassNames("_check")+' ">'+this.displayContent+"</div>              </div>"},domEvents:{"click .padcustomcolorview_cell":"_onSelect","click .padcustomcolorview_check":"_onSelect"},setup:function(e){var n=e||{};this._parent(n),"P_Preview"===this.model.get("label")?this.displayContent=t.colorView.content:this.displayContent=t.colorView.checkmark,this.model.addEvent("onChange:selected",this.render.bind(this)),this.model.addEvent("onChange:background_color",this.render.bind(this)),this.model.addEvent("onChange:color",this.render.bind(this)),"BG_Greyscale_8"!==this.model.get("label")&&"FG_Greyscale_1"!==this.model.get("label")||this.model.set("selected",!0)},render:function(){this.container.setHTML(this.template()),this.container.setStyle("background-color",this.model.get("background_color"));var e=this.model.get("background_color");return"P_Preview"===this.model.get("label")&&this.container.setStyle("cursor","default"),!0!==this.model.get("selected")&&"P_Preview"!==this.model.get("label")||(e=this.model.get("color")),this.container.setStyle("color",e),this.elements.padcustomcolorview=this.container,this},toggleSelected:function(){!0===this.model.get("selected")?(this.model.set("selected",!1),this.elements.padcustomcolorview.setStyle("color",this.model.get("background_color"))):(this.model.set("selected",!0),this.elements.padcustomcolorview.setStyle("color",this.model.get("color")))},isSelected:function(){return this.model.get("selected")},_onSelect:function(){this.toggleSelected(),this.dispatchEvent("select",this.model.get("label"))}})}),define("DS/RequirementAttrManagement/views/private/Iconbar",["css!DS/RequirementAttrManagement/RequirementAttrManagement.css","css!DS/UIKIT/UIKIT","UWA/Core","UWA/Event","UWA/Utils","UWA/Controls/Abstract","DS/UIKIT/Menu","DS/UIKIT/Tooltip","DS/UIKIT/DropdownMenu"],function(e,t,n,o,i,s,r,a,l){"use strict";var c=n.Utils.Client.Features.touchEvents;var d,u=(d=/^(divider)$/,function(e){var t,n,o=!1;if(!e)return!1;for(t=e.split(" "),n=0;n<t.length&&!1===o;n++)d.test(t[n])&&(o=!0);return o}),m=r.extend({name:"iconbar-items",templateClassname:"iconbar-template"}),p=l.extend({show:function(){document.body.style.overflow="hidden",this._parent(),document.body.style.overflow="auto"}});return s.extend({name:"iconbar",menu:null,overflowMenu:null,overflowMenuTrigger:null,init:function(e){if(void 0===e.renderTo)throw new Error("renderTo options is Mandatory");this._parent(e),this.buildSkeleton(),this.handleEvents(),this.show()},buildSkeleton:function(){var e=this.elements,t=this.options;e.container||(this.menu=new m({multiSelect:t.multiSelect}),this.addItem(t.items),e.container=this.menu.elements.container,e.container.className=this.getClassNames(),e.container.addClassName("enx-iconbar"),t.renderTo&&1===t.renderTo.nodeType&&(e.container.inject(t.renderTo),delete t.renderTo))},buildOverflowMenu:function(){var e,t,o=[];this.overflowMenuTrigger||(this.overflowMenuTrigger=n.createElement("li",{class:this.name+"-overflow-menu-trigger item",html:{tag:"span",class:"fonticon fonticon-menu-dot"}})),this.overflowMenu&&this.overflowMenu.destroy(),this.overflowMenu=null,this.menu.items.forEach(function(n){n.content&&"dropdown"===n.content.type||(t=!0,e={className:(n.id+" "+(n.className?n.className:"")).trim(),fonticon:n.fonticon,text:n.text,name:n.name,handler:n.handler,selectable:n.selectable,selected:n.selected,disabled:n.disabled},n.content&&n.content.options.items&&"icondropdown"!==n.content.type?e.items=n.content.options.items.map(function(e){return e.className=(n.id+" "+(e.className?e.className:"")).trim(),e.selectable=!0,e}):n.content&&"icondropdown"===n.content.type&&(t=!1,n.content.options.items&&n.content.options.items.forEach(function(e){o.push({className:(n.id+" "+(e.className?e.className:"")).trim(),fonticon:e.fonticon,icon:e.icon,handler:e.handler,text:e.description})})),t&&o.push(e))}),this.overflowMenu=new p({multiSelect:this.options.multiSelect,items:o,target:this.overflowMenuTrigger,events:this.options.events})},getItem:function(e){var t,n,o,i=!1;for(t=0,n=this.menu.items.length;t<n;t++){if(i=this.menu.items[t],e&&e.nodeType){if(o=e.hasClassName("item")?e:e.getParent(),i.id===o.id)break}else if(t===e||i.id===e||i.name===e)break;i=!1}return i},handleEvents:function(){var e,t,n,i;this.events={container:{click:function(e){var t=o.getElement(e),n=this.getItem(t);n.selectable&&this.select(n.name,!n.selected),n&&(n.content&&(window.requestAnimationFrame?window.requestAnimationFrame(this.displayContent.bind(this,n)):this.displayContent(n)),n.tooltip&&n.tooltip.isVisible&&!c&&n.tooltip.hide(),this.dispatchEvent("onClick",[e,n],this),"function"==typeof n.handler&&n.handler.call(this,e,n))}.bind(this)}},this.elements.container.addEvents(this.events.container),this.events.window={resize:(e=this.resize,t=100,function(){var o,s=this,r=arguments;o=n&&!i,clearTimeout(i),i=setTimeout(function(){i=null,n||e.apply(s,r)},t),o&&e.apply(s,r)}).bind(this)},window.addEventListener("resize",this.events.window.resize)},addItem:function(e){return i.splat(e).forEach(function(e){this._addItem(e)},this),this.buildOverflowMenu(),this},_addItem:function(e){var t=this.menu._addItem(e);t.content=t.innerComponent||t.content,!u(e.className)&&t.text&&(t.tooltip=new a({target:t.elements.container,body:t.text,trigger:t.tooltipTrigger||this.options.tooltipsTrigger||"hover focus"}),t.tooltip.getContent().addClassName("enx-tooltip-iconbar"),t.elements.container.getElement(".item-text").remove())},isOverflowing:function(){return this.menu.items.some(function(e){return!e.elements.container.isInViewport(this.elements.container,!0,!0)}.bind(this))},isInjected:function(){if(this.elements&&this.elements.container)return this.elements.container.isInjected()},resize:function(){function e(e){this.overflowMenu.items.forEach(function(t){e.some(function(e){return!!t.className&&(t.className&&-1!==t.className.indexOf(e))})?t.elements.container.removeClassName("hidden"):t.elements.container.addClassName("hidden")})}return function(){var t,n;if(this.overflowMenuTrigger&&this.overflowMenuTrigger.isInjected()&&this.overflowMenuTrigger.remove(),this.overflowMenu.isVisible&&this.overflowMenu.hide(),(!this.elements.container||this.isOverflowing())&&(n=(t=function(){var e=this.elements.container.getBoundingClientRect();return this.menu.items.filter(function(t){var n=t.elements.container.getBoundingClientRect();return n.top+n.height>e.bottom||n.left+n.width>e.right},this)}.call(this)).map(function(e){return e.id}),e.call(this,n),t.length))for(this.menu.elements.wrapper.insertBefore(this.overflowMenuTrigger,t[0].elements.container);!this.overflowMenuTrigger.isInViewport(this.elements.container,!0,!0)&&this.overflowMenuTrigger.previousSibling;)this.menu.elements.wrapper.insertBefore(this.overflowMenuTrigger,this.overflowMenuTrigger.previousSibling),t.push(this.overflowMenuTrigger.nextSibling),this.overflowMenuTrigger.nextSibling.id&&n.push(this.overflowMenuTrigger.nextSibling.id),e.call(this,n)}}(),displayContent:function(e){var t=n.clone(e.content.options);if(t.target=e.elements.container,e.content.created)e.content.component&&e.content.component.show();else{if("dropdown"===e.content.type)require(["DS/UIKIT/Dropdown"],function(n){e.content.component=new n(t).show()});else if("icondropdown"===e.content.type)require(["DS/UIKIT/IconDropdown"],function(n){e.content.component=new n(t).show()});else{if("dropdownmenu"!==e.content.type)return;e.content.component=new l(t).show(),e.content.component.getContent().addClassName("enx-dropdown-iconbar")}e.content.created=!0}},select:function(){var e,t,n,o,i=arguments;void 0!==i[0]&&null!==i[0]&&(t=void 0===i[1]||i[1],!0!==this.options.multiSelect&&(t&&function(e,t){for(var n=e.length,o=0;o<n;o++)t(e[o],o)}(this.elements.container.querySelectorAll(".selected"),function(e){e.removeClassName&&e.removeClassName("selected")}),t&&this.overflowMenu.getSelectedItems().forEach(function(e){this.overflowMenu.menus[0].toggleSelection(e),e.elements.container.removeClassName("selectable")},this)),(e=this.getItem(i[0])).selected=t,e&&!e.elements.container.hasClassName("divider")&&(e.elements.container[t?"addClassName":"removeClassName"]("selected"),n=e.elements.container.id,1===(o=this.overflowMenu.items.filter(function(e){return e.elements.container.hasClassName(n)})).length&&(this.overflowMenu.menus[0].toggleSelection(o[0]),o[0].elements.container.addClassName("selectable"),o[0].selected=t)))},enableItem:function(e){this.menu.enableItem(e);var t=this.getItem(e);t&&(t.disabled=!1)},disableItem:function(e){this.menu.disableItem(e);var t=this.getItem(e);t&&(t.disabled=!0)},show:function(){this.isInjected()&&(this._injectionObserver&&this._injectionObserver.disconnect(),this._injectionObserver=null,this._parent(),window.requestAnimationFrame?window.requestAnimationFrame(this.resize.bind(this)):this.resize())},destroy:function(){window.removeEventListener("resize",this.events.window.resize),this.overflowMenu&&this.overflowMenu.destroy(),this.overflowMenuTrigger&&this.overflowMenuTrigger.destroy(),this.elements.container.removeEvents(this.events.container),this.menu.items.forEach(function(e){e.tooltip&&e.tooltip.destroy()}),this._parent()}})}),define("DS/RequirementAttrManagement/views/AttributesCommons",["i18n!DS/RequirementAttrManagement/assets/nls/RequirementAttrManagement.json","DS/RequirementAttrManagement/views/AttributesContants","DS/PADServices/utils/GlobalUtils","UWA/Core","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/TreeModel/DataModelSet"],function(e,t,n,o,i,s,r){"use strict";function a(e,t,n,o){return{fonticon:o,title:n,name:t,handler:function(n,o){l.invokeActionByID({actionId:t,context:e,input:t})}}}var l={specificColumns:["selection","hide_show","find_in_ctx","instanceName","instanceMatrix","thumbnail"],dumpProp:{properties:[function(){return{property:"label",value:this.options.grid.attrTitle}},function(){var e={property:"text",value:void 0};return(void 0===this.options.grid.hasTitle||this.options.grid.hasTitle)&&(e.value=this.options.grid.attrTitle),e},function(){return{property:"dataIndex",value:this.options.columnIndex}},function(){return{property:"attrParent",value:this.options.grid.attrParent}},function(){return{property:"attrDim",value:this.options.grid.attrDim}},function(){return{property:"provider",value:this.options.grid.provider}},function(){return{property:"attrUnit",value:this.options.grid.attrUnit}},function(){return{property:"ds6w",value:this.options.grid.attrName}},function(){return{property:"hasNLS",value:void 0===this.options.grid.hasTitle||this.options.grid.hasTitle}},function(){return{property:"noTitleColumn",value:void 0!==this.options.grid.hasTitle&&!this.options.grid.hasTitle}},function(){return{property:"kind",value:this.options.kind}},function(){return{property:"ds6wFrom",value:"Instance"===this.options.grid.attrParent?"rel":void 0}},function(){return{property:"isAdditionalColumn",value:this.options.grid.isAdditionalColumn}},function(){return{property:"attrVisible",value:this.options.grid.attrVisible}},function(){return{property:"internalName",value:this.options.grid.internalName}},function(){return{property:"description",value:this.options.grid.attrDesc}},function(){var e=!!this.options.grid&&this.options.grid.canBeGrouped,t=o.clone(this.options.grid.layout||{});return e&&(t.canBeGrouped=!0),{property:"customisation",value:{layout:t}}}]},columnActionsMapping:{columnColor:"changeColor",attrRemove:"trash"},actionsMeta:{moreAttributes:{executor:"DS/RequirementAttrManagement/views/actions/MoreAttributesHandler"},changeColor:{executor:"DS/RequirementAttrManagement/views/actions/ChangeColorHandler"},moveUp:{executor:"DS/RequirementAttrManagement/views/actions/MoveColumnsHandler"},moveDown:{executor:"DS/RequirementAttrManagement/views/actions/MoveColumnsHandler"},moveFirst:{executor:"DS/RequirementAttrManagement/views/actions/MoveColumnsHandler"},moveLast:{executor:"DS/RequirementAttrManagement/views/actions/MoveColumnsHandler"},trash:{executor:"DS/RequirementAttrManagement/views/actions/RemoveAttributesHandler"}},toolbarActionsDefinition:{moreAttributes:function(t){return{fonticon:"attributes-add",title:e.attributesCustomization.moreAttributes,name:"moreAttributes",handler:function(e,n){l.invokeActionByID({actionId:"moreAttributes",context:t}),require(["DS/RequirementAttrManagement/views/actions/MoreAttributesHandler"],function(e){e.execute(t)})}}},changeColor:function(t){return{fonticon:"palette",title:e.attributesCustomization.moreAttributes,name:"changeColor",handler:function(e,n){l.invokeActionByID({actionId:"changeColor",context:t})}}},diviser:function(){return{className:"divider"}},moveUp:function(t){return a(t,"moveUp",e.attributesCustomization.moveUp,"up")},moveDown:function(t){return a(t,"moveDown",e.attributesCustomization.moveDown,"down")},moveFirst:function(t){return a(t,"moveFirst",e.attributesCustomization.moveFirst,"move-to-top")},moveLast:function(t){return a(t,"moveLast",e.attributesCustomization.moveLast,"move-to-bottom")},trash:function(t){return{fonticon:"trash",title:e.attributesCustomization.remove,name:"remove",handler:function(e,n){l.invokeActionByID({actionId:"trash",context:t})}}}},required:{columns:[],ActionsColumn:[{icon:{iconName:"trash",fontIconFamily:1},dataIndex:"attrRemove",alignmentValue:"center",alwaysVisibleFlag:!0,width:30,sortableFlag:!1,resizableFlag:!1,editableFlag:!1,getCellTypeRepresentation:function(e){return e.nodeModel&&!0===e.nodeModel.options.pinColumn?"string":e.nodeModel&&(!0===e.nodeModel.options.grid.isAdditionalColumn||e.nodeModel.options.grid.layout&&!1===e.nodeModel.options.grid.layout.removable)?"actionNotRemove":"actionRemove"},getCellSemantics:function(e){if(e.nodeModel&&(!0===e.nodeModel.options.grid.isAdditionalColumn||e.nodeModel.options.grid.layout&&!1===e.nodeModel.options.grid.layout.removable))return{disabled:!0}}}]},provided:{columns:{groupability:{icon:{iconName:"horizontal-line",fontIconFamily:1},dataIndex:"canBeGrouped",typeRepresentation:"boolean",alignmentValue:"center",alwaysVisibleFlag:!0,width:30,editableFlag:!0,editionPolicy:"EditionInPlace",sortableFlag:!1,resizableFlag:!1,getCellEditableState:function(e){var t=!0;return e.nodeModel.options.grid.layout&&e.nodeModel.options.grid.layout.groupingLocked&&(t=!1),t},getCellTypeRepresentation:function(e){return e.nodeModel&&!0===e.nodeModel.options.pinColumn?"string":"boolean"}},palette:{icon:{iconName:"palette",fontIconFamily:1},dataIndex:"columnColor",alignmentValue:"center",alwaysVisibleFlag:!0,width:30,editableFlag:!1,sortableFlag:!1,resizableFlag:!1,typeRepresentation:"colorChange"}}},getToolbarActionView:function(e,t){var n=l.toolbarActionsDefinition[e];return"function"==typeof n?n(t):null},invokeActionByColumnID:function(e){if(!e||!e.columnID||!e.context)return console.error("invalid input");var t=l.columnActionsMapping[e.columnID];t?(e.actionId=t,l.invokeActionByID(e)):console.error(e.columnID+" don't have a mapped action")},invokeActionByID:function(e){if(!e||!e.actionId||!e.context)return console.error("invalid input");if(l.actionsMeta[e.actionId]){var t=l.actionsMeta[e.actionId];require([t.executor],function(t){t.execute(e.context,e.input)})}else console.error(e.actionId+" action not found")},createAttributeNode:function(e){var t={columnIndex:e.dataIndex,label:e.label,kind:e.kind?e.kind:"string",icons:e.icons||[],grid:{attrTitle:e.label,attrVisible:void 0===e.attrVisible||e.attrVisible,canBeGrouped:void 0!==e.canBeGrouped&&e.canBeGrouped,attrName:e.attrName,attrDim:e.attrDim,attrUnit:e.attrUnit,internalName:e.internalName,provider:e.provider&&e.provider.length>0?e.provider:void 0,layout:e.layout,isAdditionalColumn:void 0!==e.isAdditionalColumn&&e.isAdditionalColumn,attrRemove:!0,attrParent:e.attrInstRef||"Reference",attrInstRef:e.attrInstRef||"Reference",attrAlert:null},children:null};return new s(t)},getAttributeIcons:function(e){var t;switch(e){case"Reference":t=[{iconName:"product"}];break;case"Instance":t=[{iconName:"flow-cascade"}];break;case"AdditionalColumn":t=[{iconName:"insert"}];break;default:t=void 0}return t}};return l}),define("DS/RequirementAttrManagement/views/private/MoreAttributesWizard",["css!DS/RequirementAttrManagement/RequirementAttrManagement","i18n!DS/RequirementAttrManagement/assets/nls/RequirementAttrManagement.json","UWA/Core","UWA/Controls/Abstract","UWA/Class/Promise","DS/PADServices/utils/GlobalUtils","DS/RequirementAttrManagement/views/private/WizardSteps","text!DS/RequirementAttrManagement/assets/init/MoreAttrWizardSteps.json","DS/RequirementAttrManagement/views/private/SearchInput","DS/RequirementAttrManagement/views/private/Iconbar","DS/RequirementAttrManagement/views/AttributesCommons","DS/PADServices/utils/DictionaryMgt","DS/Controls/Button","DS/Controls/Loader","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/PADUtils/PADContext","DS/DataGridView/DataGridView","DS/DataGridView/DataGridViewLayout","DS/Utilities/Utils"],function(e,t,n,o,i,s,r,a,l,c,d,u,m,p,h,v,g,f,b,w){"use strict";var C=JSON.parse(a),y={properties:[function(){return{property:"dataIndex",value:this.options.grid.dataIndex}},function(){return{property:"attrName",value:this.options.grid.attrName}},function(){return{property:"attrParent",value:this.options.grid.attrParent}},function(){return{property:"attrDim",value:this.options.grid.attrDim}},function(){return{property:"attrUnit",value:this.options.grid.attrUnit}},function(){return{property:"internalName",value:this.options.grid.internalName}},function(){return{property:"label",value:this.options.label}},function(){return{property:"kind",value:this.options.grid.attrKind}},function(){return{property:"description",value:this.options.grid.attrDesc}}]},_={"ds6wg:XCADExtension.V_CADOrigin":"ds6w:cadMaster"},A=["ds6w:globalType"];return o.extend({name:"more-attr",defaultOptions:{baseTypes:[],baseInstanceTypes:[],selectedTypes:[],automaticExtensions:[],selectedExtensions:[],selectedAttributes:[],defaultTypes:[],defaultExtensions:[],subscribeTokens:[],modelEvents:null,renderTo:null,steps:null,activeView:null,maps:{referenceTypes:[],instanceTypes:[]},views:{typesView:null,extensionsView:null,attributesView:null},toolbar:null,grids:{},models:{},dgvOptions:{defaultColumnDef:{width:"auto",typeRepresentation:"string"},showRowBorderFlag:!0,alternateBackgroundFlag:!1,columns:[{icon:{iconName:"check",fontIconFamily:1},dataIndex:"attrSel",typeRepresentation:"boolean",alwaysVisibleFlag:!0,width:40,resizableFlag:!1,editableFlag:!0,editionPolicy:"EditionInPlace",getCellEditableState:function(e){var t=!0;return e.nodeModel&&e.nodeModel.getReferenceValue("attrRO")&&(t=!1),t}},{dataIndex:"tree",text:t.moreAttributesWizard.attrTitle}]},dgvLayoutOptions:{cellHeight:26,columnHeaderHeight:38,rowsHeader:!1}},init:function(e){this._parent(e),this._realInit(e)},_realInit:function(){var e=this,t=s.isWebInWinContext()?"-immersivePanelWebInWin":"-immersivePanel";e.elements.container=n.createElement("div",{class:e.getClassNames(t)}),e.instanceMgt=e.options.baseInstanceTypes&&e.options.baseInstanceTypes.length>0,e._buildBody().then(e._buildFooter.bind(e)).done(function(){e.switchView(C.activeStep),e.options.subscribeTokens.push(e.options.modelEvents.subscribe({event:"ENXViews/WizardSteps/stepChanged"},function(t){var n=t.stepId;e.switchView(n)})),e.options.modelEvents.publish({event:"ENXViews/Views/showInWidgetBody",data:{restore:!0}}),e.options.modelEvents.publish({event:"ENXViews/Views/showInWidgetBody",data:{idView:"moreAttr",html:e.elements.container}})})},destroy:function(){for(var e=0;e<this.options.subscribeTokens.length;e++)this.options.modelEvents.unsubscribe(this.options.subscribeTokens[e]);this.options.toolbar.destroy();var t=this;Object.keys(t.options.grids).forEach(function(e){t.options.grids[e].destroy(),t.options.grids[e]=null}),this._parent()},_buildBody:function(){var e=this;return new i(function(t,o){e.elements.wizard=n.createElement("div",{class:e.getClassNames("-wizard")}).inject(e.elements.container),e.options.wizard=new r({modelEvents:e.options.modelEvents,renderTo:e.elements.wizard,steps:C});var i=n.createElement("div",{class:e.getClassNames("-toolbar-container")}).inject(e.elements.container);e.elements.content=n.createElement("div",{class:e.getClassNames("-content")}).inject(e.elements.container),e._generateToolbar({renderTo:i}),t()})},_buildFooter:function(){var e=this;return new i(function(o,i){e.elements.footer=n.createElement("div",{class:e.getClassNames("-footer")}).inject(e.elements.container);var s=e.elements.nextButton=new m({label:t.moreAttributesWizard.next,value:"next",emphasize:"primary",touchMode:!0});s.addEventListener("click",function(){if("typesView"===e.options.activeView)e.options.modelEvents.publish({event:"ENXViews/WizardSteps/changeStep",data:{stepId:"extensionsView"}});else if("extensionsView"===e.options.activeView)e.options.modelEvents.publish({event:"ENXViews/WizardSteps/changeStep",data:{stepId:"attributesView"}});else if("attributesView"===e.options.activeView){var t=e.options.models.attributesView.search({match:function(e){return!0===e.nodeModel.options.grid.attrSel}}).map(function(e){return e.dump(y)}),n=[].concat(e.options.selectedExtensions).concat(e.options.automaticExtensions);e.options.modelEvents.publish({event:"ENXViews/MoreAttributesWizard/selectedAttributes",data:{selectedAttributes:t,selectedTypes:e.options.selectedTypes,selectedExtensions:n}}),e.destroy()}}),s.inject(e.elements.footer);var r=e.elements.closeButton=new m({label:t.moreAttributesWizard.cancel,emphasize:"secondary",touchMode:!0});r.addEventListener("click",function(){e.options.modelEvents.publish({event:"ENXViews/MoreAttributesWizard/closeWizard"}),e.destroy()}),r.inject(e.elements.footer),o()})},switchView:function(e){if(this.options.activeView!==e)if(this.elements.toolbarSearch.clear(!0),this.__setToolbarCmds(e),this.options.previousView=this.options.activeView,this.options.activeView=e,null===this.options.views[e]){(d=this.elements.content.getElement("div.more-attr-chooser-view"))&&this.elements.content.removeChild(d),n.is(this.elements.loader)||(this.elements.loaderDiv=n.createElement("div",{class:this.getClassNames("-loader")}).inject(this.elements.content),this.elements.loader=(new p).inject(this.elements.loaderDiv),this.elements.loader.getContent().addClassName("enx-loader")),this.elements.loaderDiv.removeClassName("hidden"),this.elements.loader.on();var o=this,s=[],r=null,a=0,l=C.steps.length;do{C.steps[a].id===e&&(r=C.steps[a]),a++}while(a<l||null===r);if(r.prerequisiteViews)for(var c=0;c<r.prerequisiteViews.length;c++)null===this.options.views[r.prerequisiteViews[c]]&&s.push(this["_build"+r.prerequisiteViews[c]](!0));i.all(s).then(function(){this["_build"+e]().then(function(e){o.elements.loaderDiv.addClassName("hidden"),o.elements.loader.off(),o.options.modelEvents.publish({event:"ENXViews/MoreAttributesWizard/viewReady",data:{activeView:o.options.activeView}})})}.bind(this))}else{var d;o=this;if((d=this.elements.content.getElements("div.more-attr-chooser-view"))&&Array.isArray(d)&&d.forEach(function(e){o.elements.content.removeChild(e)}),this.options.views[e].inject(this.elements.content),!0===this.typesUpdated&&"extensionsView"===this.options.activeView)this.__updateExtensionsView().then(function(){delete o.typesUpdated,o.extensionsUpdated=!0,o.options.modelEvents.publish({event:"ENXViews/MoreAttributesWizard/viewReady",data:{activeView:o.options.activeView}})});else if(!0!==this.typesUpdated&&!0!==this.extensionsUpdated||"attributesView"!==this.options.activeView){o.options.grids[this.options.activeView].getContent().removeClassName("loading"),"extensionsView"===this.options.activeView||"typesView"===this.options.activeView?o.elements.nextButton.label=t.moreAttributesWizard.next:o.elements.nextButton.label=t.moreAttributesWizard.done,this.options.modelEvents.publish({event:"ENXViews/MoreAttributesWizard/viewReady",data:{activeView:this.options.activeView}})}else this.__updateAttributesView().then(function(){delete o.typesUpdated,delete o.extensionsUpdated,o.options.modelEvents.publish({event:"ENXViews/MoreAttributesWizard/viewReady",data:{activeView:o.options.activeView}})})}},_buildtypesView:function(e){var o=this;return new i(function(i,r){o.elements.nextButton.label=t.moreAttributesWizard.next,o.elements.nextButton.disabled=!0;o.options.wizard.getContent().addClassName("disabled"),o.options.views.typesView=n.createElement("div",{class:o.getClassNames("-typesView more-attr-chooser-view")});var a=n.createElement("div",{class:o.getClassNames("-typesViewDgv more-attr-dgv-container")}).inject(o.options.views.typesView),l=n.extend({identifier:"MoreAttrWizard-"+s.uid()},n.clone(o.options.dgvOptions));l.layout=new b(o.options.dgvLayoutOptions);var c=o.options.grids.typesView=new f(l);o._declareInstRefTypeReps(c),c.onContextualEvent=function(){return[]},c.getCellTooltip=function(e){var n=o.options.grids.typesView.getColumnOrGroup(e.columnID).dataIndex;if(e.dataIndex=n,-1===e.rowID)return{shortHelp:t.moreAttributesWizard[n],updateModel:!1}}.bind(this),c.mandatorySelected=o.options.defaultTypes,o.options.models.typesView=new h({}),c.treeDocument=o.options.models.typesView,c.getContent().addClassName("enxdatagridview loading"),c.getContent().inject(a),o.options.views.typesView.inject(o.elements.content),c.onReady(function(){o.__updateTypesViewModel(!0).finally(function(){!0!==e&&(c.getContent().removeClassName("loading"),o.elements.nextButton.disabled=!1,o.options.wizard.getContent().removeClassName("disabled")),i()}),c.addEventListener("change",o._changeType.bind(o))})})},_changeType:function(e,t){var n=this.options.grids[this.options.activeView];if(t&&t.nodeModel&&t.nodeModel.options.grid&&"attrSel"===n.layout.getDataIndexFromColumnIndex(t.columnID)){var o=t.nodeModel.getReferenceValue("attrName"),i=this.options.selectedTypes.indexOf(o);!0===t.nodeModel.options.grid.attrSel?-1===i&&this.options.selectedTypes.push(o):-1!==i&&this.options.selectedTypes.splice(i),this.typesUpdated=!0}},_buildextensionsView:function(e){var o=this;return new i(function(i,r){o.elements.nextButton.label=t.moreAttributesWizard.next,o.elements.nextButton.disabled=!0;o.options.wizard.getContent().addClassName("disabled"),o.options.views.extensionsView=n.createElement("div",{class:o.getClassNames("-extensionsView more-attr-chooser-view")});var a=n.createElement("div",{class:o.getClassNames("-extensionsView-Dgv more-attr-dgv-container")}).inject(o.options.views.extensionsView),l=n.extend({identifier:"MoreAttrWizard-"+s.uid()},n.clone(o.options.dgvOptions));l.layout=new b(o.options.dgvLayoutOptions);var c=o.options.grids.extensionsView=new f(l);o._declareInstRefTypeReps(c),c.onContextualEvent=function(){return[]},c.getCellTooltip=function(e){var n=o.options.grids.extensionsView.getColumnOrGroup(e.columnID).dataIndex;return e.dataIndex=n,-1===e.rowID?{shortHelp:t.moreAttributesWizard[n],updateModel:!1}:e.nodeModel?{shortHelp:t.replace(t.moreAttributesWizard.declaredInWithTypes,{types:e.nodeModel.getReferenceValue("attrInTypeNLS").join("\n")}),updateModel:!1}:void 0}.bind(this),c.mandatorySelected=o.options.defaultExtensions,o.options.models.extensionsView=new h({}),c.treeDocument=o.options.models.extensionsView,c.getContent().addClassName("enxdatagridview loading"),c.getContent().inject(a),o.options.views.extensionsView.inject(o.elements.content),c.onReady(function(){o.__updateExtensionsViewModel(!0).finally(function(){!0!==e&&(c.getContent().removeClassName("loading"),o.elements.nextButton.disabled=!1,o.options.wizard.getContent().removeClassName("disabled")),i({})}),c.addEventListener("change",o._changeExtension.bind(o))})})},_changeExtension:function(e,t){var n=this.options.grids[this.options.activeView];if(t&&t.nodeModel&&t.nodeModel.options.grid&&"attrSel"===n.layout.getDataIndexFromColumnIndex(t.columnID)){var o=t.nodeModel.getReferenceValue("attrName"),i=this.options.selectedExtensions.indexOf(o);!0===t.nodeModel.options.grid.attrSel?-1===i&&this.options.selectedExtensions.push(o):-1!==i&&this.options.selectedExtensions.splice(i),this.extensionsUpdated=!0}},_buildattributesView:function(e){var o=this;return new i(function(r){o.elements.nextButton.label=t.moreAttributesWizard.done,o.elements.nextButton.disabled=!0;o.options.wizard.getContent().addClassName("disabled"),o.options.views.attributesView=n.createElement("div",{class:o.getClassNames("-attributesView more-attr-chooser-view")});var a=n.createElement("div",{class:o.getClassNames("-attributesView-Dgv more-attr-dgv-container")}).inject(o.options.views.attributesView),l=n.extend({identifier:"MoreAttrWizard-"+s.uid()},n.clone(o.options.dgvOptions));l.layout=new b(o.options.dgvLayoutOptions);var c=o.options.grids.attributesView=new f(l);c.onContextualEvent=function(){return[]},c.getCellTooltip=function(e){var n=o.options.grids.attributesView.getColumnOrGroup(e.columnID).dataIndex;if(e.dataIndex=n,-1===e.rowID)return{shortHelp:t.moreAttributesWizard[n],updateModel:!1};if(e.nodeModel){var i=e.nodeModel.getReferenceValue("attrInTypeNLS");return{shortHelp:t.replace(t.moreAttributesWizard.declaredInWithTypes,{types:i?i.join("\n"):""}),updateModel:!1}}}.bind(this),c.mandatorySelectedWithParent={Reference:["ds6w:label","ds6w:type"]},o.options.models.attributesView=new h({}),c.treeDocument=o.options.models.attributesView,c.getContent().addClassName("enxdatagridview loading"),c.getContent().inject(a),o.options.views.attributesView.inject(o.elements.content),c.onReady(function(){void 0===o.options.grids.extensionsView&&[].push(o._buildextensionsView(!0));var t=[];t.push(o.__updateAttributesViewModel(!0)),i.all(t).then(function(){!0!==e&&(c.getContent().removeClassName("loading"),o.elements.nextButton.disabled=!1,o.options.wizard.getContent().removeClassName("disabled")),r({})}),c.addEventListener("change",o._changeAttributes.bind(o))})})},_changeAttributes:function(e,t){var n=this.options.grids[this.options.activeView];if(t&&t.nodeModel&&t.nodeModel.options.grid&&"attrSel"===n.layout.getDataIndexFromColumnIndex(t.columnID)){for(var o=-1,i=0,s=this.options.selectedAttributes.length;-1===o&&i<s;)this.options.selectedAttributes[i].name===t.nodeModel.getReferenceValue("attrName")&&this.options.selectedAttributes[i].instRef===t.nodeModel.getReferenceValue("attrParent")&&(o=i),i++;var r=t.nodeModel.getReferenceValue("attrName");!0===t.nodeModel.options.grid.attrSel?-1===o&&this.options.selectedAttributes.push({name:r,instRef:t.nodeModel.getReferenceValue("attrParent")}):-1!==o&&this.options.selectedAttributes.splice(o)}},_generateToolbar:function(e){var t=this,o=w.debounce(function(e){t.options.models[t.options.activeView].withTransactionUpdate(function(){var n=e.searchStr,o=!0;t.options.filterInProgress=!0,t.options.models[t.options.activeView].search({match:function(e){(function(e,t){var n=!1,o=new RegExp(e,"i");return(o.test(t.nodeModel.options.grid.attrTitle)||o.test(t.nodeModel.getLabel()))&&(n=!0),n})(n,e)&&t._isNodeVisible(e.nodeModel)?(e.nodeModel.show(),n.length>0&&o?(e.nodeModel.select(!0),e.nodeModel.matchSearch(),o=!1):(e.nodeModel.unmatchSearch(),e.nodeModel.unselect())):(e.nodeModel.unmatchSearch(),e.nodeModel.unselect(),e.nodeModel.hide())}}),t.options.filterInProgress=!1}),t.options.models[t.options.activeView].getXSO().onPostAdd(function(){}),t.options.models[t.options.activeView].getXSO().onPostRemove(function(){})},500);this.elements.toolbar=n.createElement("div",{class:this.getClassNames("-toolbar")}).inject(e.renderTo);var i=n.createElement("div",{class:this.getClassNames("-toolbar-input")}).inject(this.elements.toolbar);this.elements.toolbarIconbar=n.createElement("div",{class:this.getClassNames("-toolbar-iconbar")}).inject(this.elements.toolbar);i.addEventListener("touchstart",function(e){e.target.style.fontSize="16px"},!1),i.addEventListener("mouseleave",function(e){e.target.style.fontSize="14px"},!1),this.elements.toolbarSearch=new l({events:{onSearch:o}}).inject(i)},_isNodeVisible:function(e){switch(this.currentSelectFilter+"-"+this.currentInstRefFilter){case"none-none":return!0;case"selected-none":return!0===e.getReferenceValue("attrSel");case"unselected-none":return!1===e.getReferenceValue("attrSel");case"none-reference":return"Instance"!==e.getReferenceValue("attrParent");case"none-instance":return"Reference"!==e.getReferenceValue("attrParent");case"selected-reference":return!0===e.getReferenceValue("attrSel")&&"Instance"!==e.getReferenceValue("attrParent");case"selected-instance":return!0===e.getReferenceValue("attrSel")&&"Reference"!==e.getReferenceValue("attrParent");case"unselected-reference":return!1===e.getReferenceValue("attrSel")&&"Instance"!==e.getReferenceValue("attrParent");case"unselected-instance":return!1===e.getReferenceValue("attrSel")&&"Reference"!==e.getReferenceValue("attrParent")}return!0},__setToolbarCmds:function(e){var n=this;this.currentSelectFilter="none",this.currentInstRefFilter="none";var o,i=function(){n.options.models[n.options.activeView].withTransactionUpdate(function(){for(var e=n.options.models[n.options.activeView].getRoots(),t=(n.currentSelectFilter,n.currentInstRefFilter,0);t<e.length;t++){n._isNodeVisible(e[t])?e[t].show():e[t].hide()}}),n.options.models[n.options.activeView].getXSO().onPostAdd(function(){}),n.options.models[n.options.activeView].getXSO().onPostRemove(function(){})},s={fonticon:"filter",text:t.moreAttributesWizard.filterRows,name:"filter",content:{type:"dropdownmenu",options:{items:[{fonticon:"block",text:t.moreAttributesWizard.none,name:"none",selectable:!0,selected:!0},{fonticon:"checkbox-on",text:t.moreAttributesWizard.selected,name:"selected",selectable:!0},{fonticon:"checkbox-off",text:t.moreAttributesWizard.unselected,name:"unselected",selectable:!0}],events:{onClick:function(e,t){var o;o=t.name,n.currentSelectFilter=o,i()}}}}},r={className:"divider"};if(!this.options.toolbar||this.options.toolbar.currentView!==e){o=(this.instanceMgt,[r,s]);var a={renderTo:this.elements.toolbarIconbar,items:o};this.options.toolbar&&(this.options.toolbar.destroy(),this.options.toolbar=null),this.options.toolbar=new c(a),this.options.toolbar.elements.container.setStyle("display",void 0)}},_declareInstRefTypeReps:function(e){var t={Reference:{stdTemplate:"functionIcon",semantics:{icon:{iconName:"product",fontIconFamily:WUXManagedFontIcons.Font3DS}}},Instance:{stdTemplate:"functionIcon",semantics:{icon:{iconName:"flow-cascade",fontIconFamily:WUXManagedFontIcons.Font3DS}}},Both:{stdTemplate:"functionIcon",semantics:{icon:{iconName:"part-replace",fontIconFamily:WUXManagedFontIcons.Font3DS}}},Extension:{stdTemplate:"functionIcon",semantics:{icon:{iconName:"part-add",fontIconFamily:WUXManagedFontIcons.Font3DS}}},Unknown:{stdTemplate:"functionIcon",semantics:{icon:{iconName:"i-question",fontIconFamily:WUXManagedFontIcons.Font3DS}}}};e.getTypeRepresentationFactory().registerTypeRepresentations(JSON.stringify(t))},_checkSelected:function(e,t){var n=this.options.selectedAttributes.filter(function(n){return n.name===e&&n.instRef===t});return n.length>1&&console.warn("Several attributes found "+JSON.stringify(n)),1===n.length},__updateTypesViewModel:function(e){var t=this;return new i(function(n){var o=t.options.baseInstanceTypes.length?t.options.baseTypes.concat(t.options.baseInstanceTypes):t.options.baseTypes;u.getTypesInfo({baseTypes:o},e).then(function(e){var o=Object.getOwnPropertyNames(e);if(void 0!==o){for(var i=0;i<o.length;i++){var s=o[i],r=e[s],a=-1!==t.options.selectedTypes.indexOf(s),l=r.parent?r.parent:s,c=-1!==t.options.baseTypes.indexOf(l)?"Reference":-1!==t.options.baseInstanceTypes.indexOf(l)?"Instance":"Unknown",d=new v({label:r.displayName,grid:{attrName:s,attrTitle:r.displayName,attrSel:a,attrParent:c},icons:[r.iconUrl]});t.options.models.typesView.addRoot(d,a?0:void 0),"Reference"===c&&-1===t.options.maps.referenceTypes.indexOf(s)&&t.options.maps.referenceTypes.push(s),"Instance"===c&&-1===t.options.maps.instanceTypes.indexOf(s)&&t.options.maps.instanceTypes.push(s)}n({})}})})},__updateExtensionsView:function(){var e=this;return new i(function(t){e.elements.loader.on(),e.elements.loaderDiv.removeClassName("hidden"),e.options.grids.extensionsView.getContent().addClassName("loading"),e.elements.nextButton.disabled=!0,e.options.wizard.getContent().addClassName("disabled"),e.options.models.extensionsView.removeRoots(),e.__updateExtensionsViewModel(!0).finally(function(){e.elements.loader.off(),e.options.grids.extensionsView.getContent().removeClassName("loading"),e.elements.nextButton.disabled=!1,e.options.wizard.getContent().removeClassName("disabled"),t()})})},__updateExtensionsViewModel:function(e){var t=this;return new i(function(n){u.interfaces({classes:t.options.selectedTypes,onlyCustomer:!1},e).then(function(e){for(var o=Object.getOwnPropertyNames(e.extensions),i=0;i<o.length;i++){for(var s=o[i],r=e.extensions[s],a=-1!==t.options.selectedExtensions.indexOf(s),l="",c=!1,d=!1,m=[],p=0;p<r.declareIn.length;p++){-1!==t.options.baseTypes.indexOf(r.declareIn[p])?c=!0:-1!==t.options.baseInstanceTypes.indexOf(r.declareIn[p])&&(d=!0);var h=r.declareIn[p];u.getNLSForTypes(h);m.push(u.getNLSForTypes(r.declareIn[p]))}l=!0===c&&!0===d?"Both":!0===c?"Reference":!0===d?"Instance":"Unknown";var g=new v({label:r.nlsName,grid:{attrName:s,attrTitle:r.nlsName,attrSel:a,attrInType:r.declareIn,attrInTypeNLS:m,attrParent:l}});t.options.models.extensionsView.addRoot(g,a?0:void 0)}var f=Object.getOwnPropertyNames(e.automaticExtensions);for(i=0;i<f.length;i++)t.options.automaticExtensions.push(f[i]);n({})})})},__updateAttributesView:function(){var e=this;return new i(function(n){e.elements.loader.on(),e.elements.loaderDiv.removeClassName("hidden"),e.options.grids.attributesView.getContent().addClassName("loading"),e.elements.nextButton.disabled=!0,e.elements.nextButton.label=t.moreAttributesWizard.done,e.options.wizard.getContent().addClassName("disabled"),e.options.models.attributesView.removeRoots(),e.__updateAttributesViewModel(!0).finally(function(){e.elements.loader.off(),e.options.grids.attributesView.getContent().removeClassName("loading"),e.elements.nextButton.disabled=!1,e.options.wizard.getContent().removeClassName("disabled"),n()})})},__updateAttributesViewModel:function(e){var t=this;return new i(function(e){for(var o=n.clone(t.options.selectedTypes.concat(t.options.automaticExtensions).concat(t.options.selectedExtensions)),i=0;i<o.length;i++)o[i]="ds6wg:"+o[i];var s=o.join("\n");u.getPropertiesForClass({classURIs:s,types:n.clone(t.options.selectedTypes),interfaces:n.clone(t.options.automaticExtensions.concat(t.options.selectedExtensions))}).then(function(n){for(var o=Object.getOwnPropertyNames(n.availaibleAttributes),i=[],s=[],r=0;r<o.length;r++){var a=o[r],l=n.availaibleAttributes[a],c=_[a]?_[a]:a;if(-1===A.indexOf(c)){var d="",m=!1,p=!1,h=!1,g=[],f=[],b=[],w=[];if(l.inTypes)for(var C=0;C<l.inTypes.length;C++){var y=null,S=l.inTypes[C].substring(l.inTypes[C].indexOf(":")+1,l.inTypes[C].length);if(-1!==t.options.baseTypes.indexOf(S))m=!0;else if(-1!==t.options.baseInstanceTypes.indexOf(S))p=!0;else if((-1!==t.options.selectedExtensions.indexOf(S)||-1!==t.options.automaticExtensions.indexOf(S))&&(h=!0,(y=t.options.models.extensionsView.search({match:function(e){return e.nodeModel.getReferenceValue("attrName")===S}})).length)){var M=y[0].getReferenceValue("attrParent");"Reference"===M?m=!0:"Instance"===M?p=!0:"Both"===M&&(m=!0,p=!0)}if(-1!==t.options.maps.referenceTypes.indexOf(S)&&(m=!0,g.push(S),f.push(u.getNLSForTypes(l.inTypes[C]))),-1!==t.options.maps.instanceTypes.indexOf(S)&&(p=!0,b.push(S),w.push(u.getNLSForTypes(l.inTypes[C]))),h&&Array.isArray(y)&&y.length>0){var I=y[0],x=Array.isArray(I.options.grid.attrInType)?I.options.grid.attrInType[0]:"";-1!==t.options.maps.referenceTypes.indexOf(x)&&(m=!0,g.push(x),f.push(u.getNLSForTypes(l.inTypes[C]))),-1!==t.options.maps.instanceTypes.indexOf(x)&&(p=!0,b.push(x),w.push(u.getNLSForTypes(l.inTypes[C])))}}d=!0===m&&!0===p?"Both":!0===m?"Reference":!0===p?"Instance":!0===h?"Extension":"Both";var E=l.dimension,T=l.manipulationUnit,N=l.originCuri?l.originCuri.substring(l.originCuri.indexOf(":")+1,l.originCuri.length):null,D=(l.curi.startsWith("ds6wg:")?l.curi.substr(6):l.curi,c);if("Instance"===d&&(c+="-Instance"),"attribute"===l.nature&&(N=l.selectable),-1===s.indexOf(c))if("Both"===d){i.push(c);var V=t._checkSelected(c,"Reference"),R=new v({label:l.label,grid:{attrName:D,internalName:N,dataIndex:c,attrDim:E,attrUnit:T,attrTitle:l.label,attrDesc:l.description,attrKind:l.dataType.substring(l.dataType.indexOf("#")+1),attrInType:g,attrInTypeNLS:f,attrOrigName:N,attrSel:V,attrRO:V,attrParent:"Reference"}});t.options.models.attributesView.addRoot(R,V?0:void 0),s.push(c)}else{var O,k;"Reference"===d?(O=g,k=f):"Instance"===d&&(O=b,k=w);var U=t._checkSelected(c,d),P=new v({label:l.label,grid:{attrName:D,internalName:N,dataIndex:c,attrDim:E,attrUnit:T,attrTitle:l.label,attrDesc:l.description,attrKind:l.dataType.substring(l.dataType.indexOf("#")+1),attrInType:O,attrInTypeNLS:k,attrOrigName:N,attrSel:U,attrRO:U,attrParent:d}});t.options.models.attributesView.addRoot(P,U?0:void 0),s.push(c)}}}e({})})})}})}),define("DS/RequirementAttrManagement/views/AttributesCustomization",["i18n!DS/RequirementAttrManagement/assets/nls/RequirementAttrManagement.json","DS/RequirementAttrManagement/views/private/Iconbar","DS/RequirementAttrManagement/views/AttributesCommons","DS/PADServices/utils/GlobalUtils","css!DS/UIKIT/UIKIT","UWA/Core","UWA/Controls/Abstract","DS/Controls/Button","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/PADUtils/PADContext","DS/Controls/Toggle","DS/DataGridView/DataGridView","DS/DataGridView/DataGridViewLayout","DS/PADServices/utils/PlatformURL","css!DS/RequirementAttrManagement/RequirementAttrManagement.css"],function(e,t,n,o,i,s,r,a,l,c,d,u,m,p,h){"use strict";return r.extend({name:"attr-customization",defaultOptions:{renderTo:null,modelEvents:null,subscribeTokens:[],modelSubscribeTokens:[],compactMode:!1,applyOnlyToThisApp:!1,baseTypes:[],selectedTypes:[],selectedExtensions:[],rowHeaderActivated:!0,thumbnailsActivated:!1,pinModel:{},dgvOptions:{defaultColumnDef:{width:"auto",typeRepresentation:"string"},showRowIndexFlag:!1,showRowBorderFlag:!0,showAlternateBackgroundFlag:!1,rowSelection:"multiple",cellSelection:"none",selectionBehavior:{canInteractiveMultiselectWithCheckboxClick:!0,canMultiSelect:!0,enableFeedbackForActiveCell:!0,enableShiftSelection:!0,toggle:!1,unselectAllOnEmptyArea:!0},columns:[{icon:{iconName:"database",fontIconFamily:1},tooltip:e.attributesCustomization.attrVisible,dataIndex:"attrVisible",typeRepresentation:"boolean",alignmentValue:"center",alwaysVisibleFlag:!0,width:30,editableFlag:!0,editionPolicy:"EditionInPlace",sortableFlag:!1,resizableFlag:!1,getCellEditableState:function(e){var t=!0;return e.nodeModel.options.grid.layout&&void 0!==e.nodeModel.options.grid.layout.removableFromView?t=e.nodeModel.options.grid.layout.removableFromView:!0===e.nodeModel.options.pinColumn&&(t=!1),t},getCellTypeRepresentation:function(e){return e.nodeModel&&!0===e.nodeModel.options.pinColumn?"string":"boolean"}},{text:e.attributesCustomization.attrTitle,dataIndex:"tree",typeRepresentation:"string",editableFlag:!1,sortableFlag:!1,resizableFlag:!1}]},dgvLayoutOptions:{cellHeight:28,columnHeaderHeight:38,rowsHeader:!0}},init:function(t){this._parent(t);var o=this,i=d.get();o.elements.container=s.createElement("div",{class:o.getClassNames("-immersivePanel")}),h.retrievePlatformUrl({addDefaults:!0,initWSAcess:!0}).then(function(){o.instanceMgt=!!(o.options.baseInstanceTypes&&o.options.baseInstanceTypes.length>0);var t=o.options.dgvOptions;t.columns=t.columns.concat(n.required.columns,n.required.ActionsColumn),t.columns.push(n.provided.columns.groupability),o._buildBody(),o._buildFooter(),o.elements.panel2small=s.createElement("div",{class:o.getClassNames("-panel2small"),text:e.attributesCustomization.panel2small}).inject(o.elements.container),i._applicationChannel.publish({event:"ENXViews/Views/showInWidgetBody",data:{idView:"customize",title:e.attributesCustomization.apptitle,html:o.elements.container}})})},destroy:function(){for(var e=0;e<this.options.subscribeTokens.length;e++)this.options.modelEvents.unsubscribe(this.options.subscribeTokens[e]);this.options.toolbar.destroy(),this.options.grid.destroy(),this.options.grid=null,this._parent()},_buildBody:function(){this._buildIconBar(),this.elements.dgv=s.createElement("div",{class:this.getClassNames("-dgv")}).inject(this.elements.container),this.options.dgvOptions.columns.splice(4,1);var t=s.extend({identifier:"DataGridView-attrCusto-"+o.uid()},this.options.dgvOptions);t.layout=new p(this.options.dgvLayoutOptions);var i=this.options.grid=new m(t);i.onContextualEvent=function(){return[]},i.getCellTooltip=function(t){var n=this.options.grid.getColumnOrGroup(t.columnID).dataIndex;return t.dataIndex=n,-1===t.rowID?{shortHelp:e.attributesCustomization[n],updateModel:!1}:"tree"===n&&t.nodeModel&&!0!==t.nodeModel.getReferenceValue("isAdditionalColumn")?{shortHelp:e.replace(e.attributesCustomization.tooltipColName,{label:t.nodeModel.getLabel(),instRef:e.attributesCustomization[t.nodeModel.getReferenceValue("attrInstRef")]}),updateModel:!1}:void 0}.bind(this);var r={actionRemove:{stdTemplate:"functionIcon",semantics:{icon:{iconName:"trash",fontIconFamily:WUXManagedFontIcons.Font3DS}}},actionNotRemove:{stdTemplate:"functionIcon",semantics:{icon:{iconName:"block",fontIconFamily:WUXManagedFontIcons.Font3DS}}}},a={};a[e.attributesCustomization.pinLeft]="left",a[e.attributesCustomization.pinRight]="right",a[e.attributesCustomization.unpinned]="unpinned";var c={pin:{stdTemplate:"enumCombo",semantics:{possibleValues:a,valueType:"enumCustom"}}};i.getTypeRepresentationFactory().registerTypeRepresentations(JSON.stringify(c)),i.getTypeRepresentationFactory().registerTypeRepresentations(JSON.stringify(r));this.options.attrModel=new l({shouldBeSelected:function(e){return!0!==e.options.pinColumn}}),i.treeDocument=this.options.attrModel,i.getContent().addClassName("enxdatagridview"),i.getContent().inject(this.elements.dgv);var d=this;i.onReady(function(){i.addEventListener("change",d._cellModified.bind(d)),i.addEventListener("click",d._cellClicked.bind(d)),d.options.toolbar.show()}),this._addColumns(),this.options.attrModel.getXSO().onPostAdd(this._manageAttrSelection.bind(this)),this.options.attrModel.getXSO().onPostRemove(this._manageAttrSelection.bind(this)),this.options.attrModel.getXSO().onEmpty(this._manageAttrSelection.bind(this)),this.options.modelSubscribeTokens.push(this.options.attrModel.getModelEvents().subscribe({event:"addChild"},function(e){!0!==d._isMoving&&!0!==d._globalUpdate&&d.options.modelEvents.publish({event:"ENXViews/AttributesCustomization/columnModification",data:{what:"addRemoveColumns",addedColumns:[e.data.nodeModel.dump(n.dumpProp)]}})})),this.options.modelSubscribeTokens.push(this.options.attrModel.getModelEvents().subscribe({event:"removeChild"},function(e){if(!0!==d._isMoving&&!0!==d._globalUpdate){var t=e.data.nodeModel.getReferenceValue("attrName");if(-1!==n.specificColumns.indexOf(t)){if(!1===d.options.withDgv){var o=d.options.toolbar.getItem("specificColumns"),i=o.content.component;if(i)i.isSelected(t)&&i.toggleSelection(i.getItem(t));else{var s=o.content.options.items,r=!1,a=0,l=s.length;do{s[a].id===t?(s[a].selected=!1,r=!0):a++}while(!1===r&&a<l);d.options.toolbar.menu.updateItem(o)}}"thumbnail"===t&&d.elements.comboCompact.disabled(!1)}d.options.modelEvents.publish({event:"ENXViews/AttributesCustomization/columnModification",data:{what:"addRemoveColumns",removedColumns:[e.data.nodeModel.dump(n.dumpProp)]}})}})),this.elements.behavior=s.createElement("div",{class:this.getClassNames("-behavior")}).inject(this.elements.container)},_buildFooter:function(){var t=this,n=s.createElement("div",{class:t.getClassNames("-footer")}).inject(t.elements.container),o=t.elements.closeButton=new a({label:e.attributesCustomization.close,emphasize:"primary",touchMode:!0});o.addEventListener("click",function(){t._closePanel(),t.destroy()}),o.inject(n);var i=t.elements.resetButton=new a({label:e.attributesCustomization.reset,touchMode:!0});i.addEventListener("click",function(){t.options.modelEvents.publish({event:"ENXViews/AttributesCustomization/columnModification",data:{what:"reset",applyOnlyToThisApp:t.options.applyOnlyToThisApp}}),t.options.modelEvents.publish({event:"ENXViews/Views/showInWidgetBody",data:{restore:!0,refreshStructure:!0}}),t.destroy()}),i.inject(n)},_closePanel:function(){var e=[];this.options.attrModel.getRoots().forEach(function(t){e.push(t.dump(n.dumpProp))}),this.options.modelEvents.publish({event:"ENXViews/AttributesCustomization/columnModification",data:{what:"close",selectedTypes:this.options.selectedTypes,selectedExtensions:this.options.selectedExtensions,selectedAttributes:e,applyOnlyToThisApp:this.options.applyOnlyToThisApp}}),this.options.modelEvents.publish({event:"ENXViews/Views/showInWidgetBody",data:{restore:!0,refreshStructure:!0}})},_addColumns:function(){var e=this;void 0===this.options.appColumns?console.error("AttributesCustomization## Invalid input. Missing property appColumns"):e.options.attrModel.withTransactionUpdate(function(){e.options.appColumns.forEach(function(t){if("bi_color"!==t.dataIndex){var o,i=s.is(t.text,"string")&&t.text.length>0?t.text:e._retrieveColumnName(t.dataIndex),r=!(!t.customisation||!t.customisation.layout)&&t.customisation.layout.canBeGrouped,a=t.customisation&&t.customisation.layout?t.customisation.layout:null,l=void 0!==t.visibleFlag?t.visibleFlag:!t.isHidden,c=t.ds6wFrom&&"rel"===t.ds6wFrom?"Instance":"Reference";t.isAdditionalColumn&&(c="AdditionalColumn"),!0===e.instanceMgt&&(o=n.getAttributeIcons(c));var d=n.createAttributeNode({dataIndex:t.dataIndex,label:i,attrName:t.ds6w||t.dataIndex,internalName:t.dbName,kind:t.kind,attrDim:t.attrDim,attrUnit:t.attrUnit,icons:o,attrInstRef:c,attrVisible:l,provider:t.provider,isAdditionalColumn:t.isAdditionalColumn,canBeGrouped:r,layout:a});d&&e.options.attrModel.addChild(d)}}),e.options.attrModel.expandAll()})},_cellModified:function(e,t){if(t&&t.nodeModel&&t.nodeModel.options.grid)switch(this.options.grid.layout.getDataIndexFromColumnIndex(t.columnID)){case"attrVisible":this.options.modelEvents.publish({event:"ENXViews/AttributesCustomization/columnModification",data:{what:"visibilityColumn",modifiedColumn:t.nodeModel.options.columnIndex,visibilityFlag:t.nodeModel.getReferenceValue("attrVisible")}});break;case"attrTitle":this.options.modelEvents.publish({event:"ENXViews/AttributesCustomization/columnModification",data:{what:"changeTitle",modifiedColumn:t.nodeModel.options.columnIndex,newTitle:t.nodeModel.getReferenceValue("attrTitle")}});break;case"exportContent":this.options.modelEvents.publish({event:"ENXViews/AttributesCustomization/columnModification",data:{what:"exportColumn",modifiedColumn:t.nodeModel.options.columnIndex,exportFlag:t.nodeModel.getReferenceValue("exportContent")}});break;case"pinContent":var n=this,o=t.nodeModel.getReferenceValue("attrName"),i=t.nodeModel.getReferenceValue("pinContent"),s=n.__locateFirstAndLastPin(i);n.options.attrModel.withTransactionUpdate(function(){n._globalUpdate=!0;var e=s.last?s.last._getLocalID?s.last._getLocalID():s.last._localID:n.options.getRoots().length-1;0===e&&(e=1),n.options.attrModel.addChild(t.nodeModel,e),t.nodeModel.select(),delete n._globalUpdate}),this.options.modelEvents.publish({event:"ENXViews/AttributesCustomization/columnModification",data:{what:"pinChange",modifiedColumn:o,pin:i}})}},_cellClicked:function(e,t){if(t&&t.nodeModel&&t.nodeModel.options.grid){if(!0===t.nodeModel.options.pinColumn)return;n.invokeActionByColumnID({columnID:this.options.grid.layout.getDataIndexFromColumnIndex(t.columnID),context:this,input:[t.nodeModel]})}},_retrieveColumnName:function(t){return e.attributesCustomization[t]?e.attributesCustomization[t]:t},_buildIconBar:function(){this.elements.toolbar=s.createElement("div",{class:this.getClassNames("-toolbar")}).inject(this.elements.container);var e=this,o={renderTo:this.elements.toolbar,multiSelect:!0,items:(e.options.toolbarActions||[]).map(function(t){return n.getToolbarActionView(t,e)||{}})};this.options.toolbar=new t(o),this.options.toolbar.elements.container.setStyle("display",void 0)},_manageAttrSelection:function(){var e=this.options.attrModel.getSelectedNodes(),t=["moveUp","moveDown","moveFirst","moveLast"],n=["remove","changeColor"],o=e.length,i=!1,s=0;for(s=0;s<o;s++)!0===e[s].options.grid.isAdditionalColumn||e[s].options.grid.layout&&!1===e[s].options.grid.layout.removable||(i=!0);if(0===o){for(s=0;s<t.length;s++)this.options.toolbar.disableItem(t[s]);for(s=0;s<n.length;s++)this.options.toolbar.disableItem(n[s])}else if(1===o){for(s=0;s<t.length;s++)this.options.toolbar.enableItem(t[s]);for(s=0;s<n.length;s++)"remove"===n[s]&&!1===i?this.options.toolbar.disableItem(n[s]):this.options.toolbar.enableItem(n[s])}else if(o>=1){for(s=0;s<t.length;s++)this.options.toolbar.disableItem(t[s]);for(s=0;s<n.length;s++)"remove"===n[s]&&!1===i?this.options.toolbar.disableItem(n[s]):this.options.toolbar.enableItem(n[s])}},__locateFirstAndLastPin:function(e){for(var t,n,o=this.options.attrModel.getRoots(),i=0;i<o.length&&(!t||!n);i++)o[i].getReferenceValue("pinContent")!==e||t?o[i].getReferenceValue("pinContent")!==e&&t&&(n=o[i-1]):t=o[i];return t&&!n&&(n=o[o.length-1]),{first:t,last:n}}})}),define("DS/RequirementAttrManagement/views/actions/MoreAttributesHandler",["DS/RequirementAttrManagement/views/AttributesCommons","DS/PADUtils/PADContext"],function(e,t){"use strict";return{execute:function(n){var o=n.options;o.appColumns;require(["DS/RequirementAttrManagement/views/private/MoreAttributesWizard","DS/PADServices/utils/AttributesMgt","i18n!DS/RequirementAttrManagement/assets/nls/RequirementAttrManagement.json"],function(i,s,r){for(var a=o.attrModel.getRoots(),l=[],c=0;c<a.length;c++)l.push({name:a[c].getReferenceValue("attrName"),instRef:a[c].getReferenceValue("attrParent")});var d=o.modelEvents.subscribe({event:"ENXViews/MoreAttributesWizard/selectedAttributes"},function(t){o.modelEvents.unsubscribe(d);var i=(o.attrModel.getRoots()||[]).map(function(e){return e.options.columnIndex});o.modelEvents.publish({event:"ENXViews/Views/showInWidgetBody",data:{restore:!0}}),o.modelEvents.publish({event:"ENXViews/Views/showInWidgetBody",data:{idView:"customize",html:n.elements.container,title:r.attributesCustomization.apptitle}}),o.selectedExtensions=t.selectedExtensions,o.selectedTypes=t.selectedTypes,n._globalUpdate=!0;var s=t.selectedAttributes.filter(function(e){return-1!==i.indexOf(e.dataIndex)||"ds6w:label"===e.dataIndex}).map(function(e){return e.dataIndex});s.push("ds6w:covers"),s.push("ds6w:refinedInto"),s.push("paramContent"),s.push("ds6wg:PLMReference.V_isLastVersion"),s.push("ds6w:realizedChangeAction");var a=i.filter(function(e){return-1===s.indexOf(e)&&"tree"!==e}),l=t.selectedAttributes.filter(function(e){return-1===i.indexOf(e.dataIndex)&&"ds6w:label"!==e.dataIndex}),c=[],u=[],m=0;for(m=0;m<a.length;m++){var p=o.attrModel.search({match:function(e){var t=!1;return e.nodeModel.options.columnIndex===a[m]&&!0!==e.nodeModel.options.grid.isAdditionalColumn&&"ds6w:type"!==a[m]&&(t=!0),t}});o.attrModel.withTransactionUpdate(function(){for(var t=0;t<p.length;t++)o.attrModel.removeRoot(p[t]),c.push(p[t].dump(e.dumpProp))})}var h=[];for(l.forEach(function(t){var i;!0===n.instanceMgt&&(i=e.getAttributeIcons(t.attrParent));var s=e.createAttributeNode({dataIndex:t.dataIndex,label:t.label,attrName:t.attrName&&!t.attrName.endsWith("-Instance")?t.attrName:t.attrName.substring(0,t.attrName.length-"-Instance".length),kind:t.kind,attrDim:t.attrDim,internalName:t.internalName,attrUnit:t.attrUnit,icons:i,attrInstRef:t.attrParent,attrVisible:!0,isAdditionalColumn:!1,canBeGrouped:!1}),r=n.__locateFirstAndLastPin("right");r.first?o.attrModel.insertBefore(s,r.first):o.attrModel.addChild(s),s.select(),h.push(s)}),m=0;m<h.length;m++)u.push(h[m].dump(e.dumpProp));(c.length||u.length)&&o.modelEvents.publish({event:"ENXViews/AttributesCustomization/columnModification",data:{what:"addRemoveColumns",selectedTypes:o.selectedTypes,selectedExtensions:o.selectedExtensions,removedColumns:c,addedColumns:u}}),delete n._globalUpdate}),u=o.modelEvents.subscribe({event:"ENXViews/MoreAttributesWizard/closeWizard"},function(){o.modelEvents.publish({event:"ENXViews/Views/showInWidgetBody",data:{restore:!0}}),o.modelEvents.unsubscribe(u),o.modelEvents.publish({event:"ENXViews/Views/showInWidgetBody",data:{idView:"customize",html:n.elements.container,title:r.attributesCustomization.apptitle}})}),m=s.getDefaultTypesAndExtensions();t.get().MoreAttrPanel=new i({modelEvents:o.modelEvents,baseTypes:o.baseTypes,baseInstanceTypes:o.baseInstanceTypes,baseExtensions:o.baseExtensions,selectedTypes:o.selectedTypes,selectedExtensions:o.selectedExtensions,selectedAttributes:l,defaultTypes:m.defaultTypes,defaultExtensions:m.defaultExtensions})})},__getAllAttrInPinModels:function(e){var t=[];return t=t.concat(e.pinModel.left.getChildren()).concat(e.pinModel.unpinned.getChildren()).concat(e.pinModel.right.getChildren())}}}),define("DS/RequirementAttrManagement/views/private/CustomColorSet",["css!DS/RequirementAttrManagement/RequirementAttrManagement","UWA/Class/Collection","UWA/Class/View","DS/RequirementAttrManagement/views/private/CustomColorView","text!DS/RequirementAttrManagement/assets/init/CustomColor.json"],function(e,t,n,o,i){"use strict";return n.extend({name:"padcustomcolorset",className:"padcustomcolorset",tagName:"div",defaultOptions:{mono_sel:!0,color_set:"greyscale",color_category:"background"},setup:function(e){var n=e||{},o=JSON.parse(i),s=o[n.color_set];this.collection=new t(s),this.collection.forEach(function(e){e.set("label",n.color_category+"_"+e.get("label"))}),this.defaults=o.defaults,this._parent(n)},render:function(){var e=this,t=0,n=UWA.createElement("div",{class:this.getClassNames("_container")}).inject(this.container),i=UWA.createElement("div",{class:"padcustomcolorset_row"}).inject(n);return this.collection.forEach(function(s){8===t&&(i=UWA.createElement("div",{class:"padcustomcolorset_row"}).inject(n),t=0),new o({model:s,events:{select:e._onSelect.bind(e)}}).render().inject(i),t++}),this},_onSelect:function(e){if(!0===this.getOption("mono_sel")){var t=this.collection.where({selected:!0});if(this.selected_model=null,t.length>0){var n=this;t.forEach(function(t){t.get("label")!==e?t.set("selected",!1):n.selected_model=t})}this.dispatchEvent("select",this.selected_model.toJSON())}},clearSelection:function(){this.collection.forEach(function(e){e.get("selected")&&e.set("selected",!1)})},select:function(e){this.collection.forEach(function(t){t.get("label")===e&&t.set("selected",!0)})},setColor:function(e,t,n){this.collection.forEach(function(o){o.get("label")===e&&o.set(t,n)})},getColor:function(e,t){var n=null;return this.collection.forEach(function(o){o.get("label")!==e||(n=o.get(t))}),n},resetToDefault:function(){this.clearSelection();var e=this.defaults.background,t=this.defaults.foreground;this.collection.forEach(function(n){n.get("label")===e&&n.set("selected",!0),n.get("label")===t&&n.set("selected",!0)})}})}),define("DS/RequirementAttrManagement/views/private/ColorSet",["css!DS/RequirementAttrManagement/RequirementAttrManagement","UWA/Class/Options","UWA/Class/Collection","UWA/Class/View","DS/RequirementAttrManagement/views/private/ColorView","text!DS/RequirementAttrManagement/assets/init/Color.json"],function(e,t,n,o,i,s){"use strict";return o.extend(t,{name:"padcolorset",className:"padcolorset",tagName:"div",defaultOptions:{mono_sel:!0,objects_per_row:9,custom_color_rows:2,preset_color_rows:5,selected_color:{background_color:"#ffffff",color:"#000000"}},addCustomColors:function(e){var t=localStorage.getItem("ENOPAD_CustomColors"),n={background_color:"#ffffff",color:"#ffffff",custom:!0,empty:!0};if(t){t=JSON.parse(t);var o=1;t.forEach(function(e){e.custom=!0,e.empty=!1,e.label="custom_"+o,o+=1})}else t=[];var i,s=this.getOption("objects_per_row")*this.getOption("custom_color_rows"),r=s-t.length;for(i=0;i<r;i++)t.push(UWA.clone(n));for(i=0;i<s;i++)t[i].label="custom_"+(i+1);return e.concat(t)},initCollection:function(e){var t=JSON.parse(s);t=this.addCustomColors(t),this.collection=new n(t),e&&this.collection.forEach(function(t){t._attributes.color===e.color&&t._attributes.background_color===e.background_color&&(t._attributes.selected=!0)})},setup:function(e){var t=e||{};this.selected_color=t.selected_color,this.initCollection(t.selected_color),this._parent(t)},render:function(){var e=this,t=0,n=UWA.createElement("div",{class:this.getClassNames("_container")}).inject(this.container),o=UWA.createElement("div",{class:"padcolorset_row"}).inject(n);return this.collection.forEach(function(s){t===e.getOption("objects_per_row")&&(o=UWA.createElement("div",{class:"padcolorset_row"}).inject(n),t=0),new i({model:s,selected_color:e.selected_color,events:{select:e._onSelect.bind(e)}}).render().inject(o),t++}),this},_onSelect:function(e){if(!0===this.getOption("mono_sel")){var t=this.collection.where({selected:!0}),n=null;t.forEach(function(t){t.get("label")!==e?t.set("selected",!1):n=t}),n&&this.dispatchEvent("select",n.toJSON())}},reset:function(){var e=this.collection.where({selected:!0});e.length>0&&e.forEach(function(e){e.set("selected",!1)}),this.dispatchEvent("select","")},updateCollection:function(e){var t=0,n=0,o=this.getOption("objects_per_row")*this.getOption("preset_color_rows");this.collection.forEach(function(i){t>=o&&(i.get("background_color")!==e[n].background_color&&i.set("background_color",e[n].background_color),i.get("color")!==e[n].color&&i.set("color",e[n].color),n+=1),t+=1})},updateCustomColors:function(){var e=this.addCustomColors([]),t=this.getElements(".padcolorview_custom_cell"),n=this.getElements(".padcolorview_custom_content"),o=0;t.forEach(function(t){o<e.length&&(t.setStyle("background-color",e[o].background_color),e[o].empty||t.hasClassName("padcolorview_empty_cell")&&(t.removeClassName("padcolorview_empty_cell"),t.addClassName("padcolorview_active_cell"),t.setStyle("border-color","#000000")),o+=1)}),o=0,n.forEach(function(t){o<e.length&&(t.setStyle("color",e[o].color),o+=1)}),this.updateCollection(e)}})}),define("DS/RequirementAttrManagement/views/private/CustomColorPicker",["css!DS/RequirementAttrManagement/RequirementAttrManagement","i18n!DS/RequirementAttrManagement/assets/nls/RequirementAttrManagement.json","UWA/Controls/Abstract","UWA/Class/Events","UWA/Class/Options","DS/UIKIT/Modal","DS/Controls/Button","DS/RequirementAttrManagement/views/private/CustomColorSet"],function(e,t,n,o,i,s,r,a){"use strict";return n.extend(i,o,{name:"padcustomcolorpicker",defaultOptions:{selected_color:null},init:function(e){this._parent(e);var n=this,o=UWA.createElement("div"),i=UWA.createElement("div");i.addClassName("padcustomcolorpicker_leftfooter"),i.inject(o);var l=UWA.createElement("div");l.addClassName("padcustomcolorpicker_rightfooter"),l.inject(o);UWA.createElement("div");var c=new r({label:t.colorPicker.OKtitle,emphasize:"primary"});c.addEventListener("click",function(){n._onSaveAndApply()});var d=new r({label:t.colorPicker.Canceltitle});d.addEventListener("click",function(){n.elements.container.destroy()});var u=new r({label:t.colorPicker.Resettitle});u.addEventListener("click",function(){n._onReset()}),d.getContent().setStyles({float:"right"}),c.getContent().setStyles({float:"right","margin-right":"10px"}),u.getContent().setStyles({float:"left"}),d.inject(l),c.inject(l),u.inject(i);var m=UWA.createElement("div"),p=UWA.createElement("div");p.setStyle("margin-left","10px"),p.inject(m),UWA.createElement("text",{class:this.name+"_prompt",content:t.colorPicker.preview}).inject(p),this.preview=new a({color_set:"preview",color_category:"P"}),this.preview.render().inject(p);var h=UWA.createElement("div");h.setStyle("float","left"),h.setStyle("margin-left","10px"),h.inject(m),UWA.createElement("text",{class:this.name+"_prompt",content:t.colorPicker.backgroundColor}).inject(h),this.bgGreyscale=new a({color_set:"greyscale",color_category:"BG",events:{select:this._onSelect.bind(this)}}),this.bgGreyscale.render().inject(h),this.bgPrimary=new a({color_set:"primary",color_category:"BG",events:{select:this._onSelect.bind(this)}}),this.bgPrimary.render().inject(h),this.bgSecondary=new a({color_set:"secondary",color_category:"BG",events:{select:this._onSelect.bind(this)}}),this.bgSecondary.render().inject(h);var v=UWA.createElement("div");v.setStyle("float","right"),v.inject(m),UWA.createElement("text",{class:this.name+"_prompt",content:t.colorPicker.textColor}).inject(v),this.tcGreyscale=new a({color_set:"greyscale",color_category:"FG",events:{select:this._onSelect.bind(this)}}),this.tcGreyscale.render().inject(v),this.tcPrimary=new a({color_set:"primary",color_category:"FG",events:{select:this._onSelect.bind(this)}}),this.tcPrimary.render().inject(v),this.tcSecondary=new a({color_set:"secondary",color_category:"FG",events:{select:this._onSelect.bind(this)}}),this.tcSecondary.render().inject(v),this.elements.container=new s({className:this.name,closable:!0,header:t.colorPicker.titleCustom,body:m,footer:o,visible:!0}),e.renderTo&&this.elements.container.inject(e.renderTo)},_onSaveAndApply:function(){var e={background_color:this.preview.getColor("P_Preview","background_color"),color:this.preview.getColor("P_Preview","color")};this.dispatchEvent("onCustomColorOK",e),this.elements.container.destroy()},_onReset:function(){this.bgGreyscale.resetToDefault(),this.bgPrimary.resetToDefault(),this.bgSecondary.resetToDefault(),this.tcGreyscale.resetToDefault(),this.tcPrimary.resetToDefault(),this.tcSecondary.resetToDefault(),this.preview.setColor("P_Preview","background_color","#ffffff"),this.preview.setColor("P_Preview","color","#000000")},_onSelect:function(e){var t=e.label;0===t.indexOf("BG_")&&(this.preview.setColor("P_Preview","background_color",e.background_color),-1===t.indexOf("BG_Greyscale_")&&this.bgGreyscale.clearSelection(),-1===t.indexOf("BG_Primary_")&&this.bgPrimary.clearSelection(),-1===t.indexOf("BG_Secondary_")&&this.bgSecondary.clearSelection()),0===t.indexOf("FG_")&&(this.preview.setColor("P_Preview","color",e.background_color),-1===t.indexOf("FG_Greyscale_")&&this.tcGreyscale.clearSelection(),-1===t.indexOf("FG_Primary_")&&this.tcPrimary.clearSelection(),-1===t.indexOf("FG_Secondary_")&&this.tcSecondary.clearSelection())}})}),define("DS/RequirementAttrManagement/views/private/ColorPicker",["css!DS/RequirementAttrManagement/RequirementAttrManagement","i18n!DS/RequirementAttrManagement/assets/nls/RequirementAttrManagement.json","UWA/Controls/Abstract","UWA/Class/Events","UWA/Class/Options","UWA/Drivers/Alone","DS/UIKIT/Modal","DS/Controls/Button","DS/RequirementAttrManagement/views/private/ColorSet","DS/RequirementAttrManagement/views/private/CustomColorPicker"],function(e,t,n,o,i,s,r,a,l,c){"use strict";return console.warn("DEPRECATED AMD [DS/RequirementAttrManagement/views/private/ColorPicker]"),n.extend(i,o,{name:"padcolorpicker",defaultOptions:{selected_color:{background_color:"#ffffff",color:"#000000"}},init:function(e){this._parent(e),this.selected_color=this.getOption("selected_color");var n=this,o=UWA.createElement("div"),i=UWA.createElement("span");i.setStyle("margin-right","10px");var s=new a({label:t.colorPicker.addTitle,icon:"plus",iconSize:"1x"}),c=new a({label:t.colorPicker.resetTitle,icon:"clear",iconSize:"1x"});s.inject(i),i.inject(o),c.inject(o);var d=o.getElementsByClassName("wux-ui-fa-clear")[0];d.removeClassName("wux-ui-fa"),d.removeClassName("wux-ui-fa-clear"),d.removeClassName("wux-ui-fa-lg"),d.addClassName("wux-ui-3ds"),d.addClassName("wux-ui-3ds-clear"),d.addClassName("wux-ui-3ds-lg");var u=UWA.createElement("div");this.colorSet=new l({selected_color:this.selected_color,events:{select:this._onSelect.bind(this)}}).render().inject(u),s.addEventListener("click",n._onAddCustomColor.bind(n)),c.addEventListener("click",n._onResetToDefault.bind(n)),this.elements.container=new r({className:this.name,closable:!0,header:t.colorPicker.title,body:u,footer:o,visible:!0,events:{onHide:function(){n.dispatchEvent("onClose")}}}),e.renderTo&&(this.renderTo=e.renderTo,this.elements.container.inject(e.renderTo))},_onAddCustomColor:function(){var e=this;new c({renderTo:this.renderTo,events:{onCustomColorOK:function(t){var n=localStorage.getItem("ENOPAD_CustomColors");n?(n=JSON.parse(n)).push(t):n=[t],n.length>16&&(n=n.slice(-16)),localStorage.setItem("ENOPAD_CustomColors",JSON.stringify(n)),e.colorSet.updateCustomColors(),e._onSelect(t)}}})},_onResetToDefault:function(){this._onSelect({background_color:"#ffffff",color:"#000000"})},_onSelect:function(e){this.setOption("selected_color",e),this.dispatchEvent("onColorOK",e),this.elements.container.destroy()}})});