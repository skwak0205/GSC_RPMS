"undefined"==typeof define&&(define=function(t,r,e){BinaryHelpers=e(),define=void 0}),define("DS/ExperienceKernel/EKBinaryHelpers",[],function(){"use strict";var t={BinaryWriter:function(t){this.arrayBuffer=new ArrayBuffer(t||0),this.dataView=new DataView(this.arrayBuffer),this.offset=0}},r=function(t,r){if(t.arrayBuffer.byteLength<t.offset+r){var e=t.arrayBuffer.byteLength+t.arrayBuffer.byteLength/2;e<t.offset+r&&(e=t.offset+r),e=Math.ceil(e);var i=new Uint8Array(e);i.set(new Uint8Array(t.arrayBuffer)),t.arrayBuffer=i.buffer,t.dataView=new DataView(t.arrayBuffer)}};function e(t,r){return t instanceof r?t:t.buffer instanceof ArrayBuffer?new r(t.buffer,t.byteOffset,t.byteLength):new r(t)}t.BinaryWriter.prototype.tell=function(){return this.offset},t.BinaryWriter.prototype.seek=function(t){return this.arrayBuffer.byteLength>=t&&(this.offset=t+0),this},t.BinaryWriter.prototype.writeInt8=function(t){return r(this,1),this.dataView.setInt8(this.offset,t),this.offset++,this},t.BinaryWriter.prototype.writeUint8=function(t){return r(this,1),this.dataView.setUint8(this.offset,t),this.offset++,this},t.BinaryWriter.prototype.writeInt16=function(t){return r(this,2),this.dataView.setInt16(this.offset,t,!0),this.offset+=2,this},t.BinaryWriter.prototype.writeUint16=function(t){return r(this,2),this.dataView.setUint16(this.offset,t,!0),this.offset+=2,this},t.BinaryWriter.prototype.writeInt32=function(t){return r(this,4),this.dataView.setInt32(this.offset,t,!0),this.offset+=4,this},t.BinaryWriter.prototype.writeUint32=function(t){return r(this,4),this.dataView.setUint32(this.offset,t,!0),this.offset+=4,this},t.BinaryWriter.prototype.writeInt64=function(t){r(this,8);var e=Math.pow(2,32),i=Math.floor(t/e),n=t-i*e;return t<0&&(i+=e),this.dataView.setUint32(this.offset,n,!0),this.offset+=4,this.dataView.setUint32(this.offset,i,!0),this.offset+=4,this},t.BinaryWriter.prototype.writeUint64=function(t){r(this,8);var e=Math.pow(2,32),i=Math.floor(t/e),n=t-i*e;return this.dataView.setUint32(this.offset,n,!0),this.offset+=4,this.dataView.setUint32(this.offset,i,!0),this.offset+=4,this},t.BinaryWriter.prototype.writeFloat=function(t){return r(this,4),this.dataView.setFloat32(this.offset,t,!0),this.offset+=4,this},t.BinaryWriter.prototype.writeDouble=function(t){return r(this,8),this.dataView.setFloat64(this.offset,t,!0),this.offset+=8,this},t.BinaryWriter.prototype.writeChar=function(t){return r(this,1),this.dataView.setInt8(this.offset,t.charCodeAt(0)),this.offset++,this},t.BinaryWriter.prototype.writeBool=function(t){return r(this,1),this.dataView.setUint8(this.offset,t?1:0),this.offset++,this},t.BinaryWriter.prototype.writeNodeId=function(t){return t.isConnected()&&(this.writeString(t.impl.nodeImpl.ip),this.writeInt32(t.impl.nodeImpl.port),this.writeString(t.impl.nodeImpl.pool),this.writeInt32(t.impl.ws.name.hypervisorId),this.writeInt32(t.impl.ws.name.id)),this},t.BinaryWriter.prototype.writeString=function(t){t=t||"";var e=unescape(encodeURIComponent(t));return r(this,e.length+4),this.writeUint32(e.length),this.writeStringInternal(e),this},t.BinaryWriter.prototype.writeStringInternal=function(t){r(this,t.length);for(var e=0;e<t.length;++e)this.dataView.setUint8(this.offset,t.charCodeAt(e)),this.offset++;return this},t.BinaryWriter.prototype.writeStrings=function(t){t=t||[];for(var r=0;r<t.length;++r)this.writeString(t[r]);return this},t.BinaryWriter.prototype.writeBoolArray=function(t){return this.writeUint8Array(t)},t.BinaryWriter.prototype.writeUint8Array=function(t){return t=e(t,Uint8Array),r(this,t.byteLength),new Uint8Array(this.arrayBuffer).set(t,this.offset),this.offset+=t.byteLength,this},t.BinaryWriter.prototype.writeInt8Array=function(t){return t=e(t,Int8Array),this.writeUint8Array(t)},t.BinaryWriter.prototype.writeUint16Array=function(t){return t=e(t,Uint16Array),this.writeUint8Array(t)},t.BinaryWriter.prototype.writeInt16Array=function(t){return t=e(t,Int16Array),this.writeUint8Array(t)},t.BinaryWriter.prototype.writeUint32Array=function(t){return t=e(t,Uint32Array),this.writeUint8Array(t)},t.BinaryWriter.prototype.writeInt32Array=function(t){return t=e(t,Int32Array),this.writeUint8Array(t)},t.BinaryWriter.prototype.writeFloatArray=function(t){return t=e(t,Float32Array),this.writeUint8Array(t)},t.BinaryWriter.prototype.writeDoubleArray=function(t){return t=e(t,Float64Array),this.writeUint8Array(t)},t.BinaryWriter.prototype.writeArrayBuffer=function(t){return this.writeUint8Array(t)},t.BinaryWriter.prototype.writeKeys=function(t,r){this.writeUint32(r.port),this.writeString(r.hostname),this.writeUint64(t.length);for(var e=0;e<t.length;++e)void 0===t[e].get?(this.writeUint32(t[e].low),this.writeUint32(t[e].high)):this.writeUint64(t[e].get())},t.BinaryWriter.prototype.createArrayBuffer=function(){var t=this.arrayBuffer;return this.offset!==this.arrayBuffer.byteLength&&(t=this.arrayBuffer.slice(0,this.offset)),this.arrayBuffer=new ArrayBuffer(0),this.offset=0,t},t.BinaryReader=function(t){this.dataView=new DataView(t),this.offset=0},t.BinaryReader.prototype.getSize=function(){return this.dataView.byteLength},t.BinaryReader.prototype.tell=function(){return this.offset},t.BinaryReader.prototype.seek=function(t){return this.offset=t+0,this};var i=function(t){try{return t()}catch(t){}};t.BinaryReader.prototype.readBool=function(){var t=this;return i(function(){var r=t.dataView.getUint8(t.offset);return t.offset++,0!==r})},t.BinaryReader.prototype.readInt8=function(){var t=this;return i(function(){var r=t.dataView.getInt8(t.offset);return t.offset++,r})},t.BinaryReader.prototype.readUint8=function(){var t=this;return i(function(){var r=t.dataView.getUint8(t.offset);return t.offset++,r})},t.BinaryReader.prototype.readInt16=function(){var t=this;return i(function(){var r=t.dataView.getInt16(t.offset,!0);return t.offset+=2,r})},t.BinaryReader.prototype.readUint16=function(){var t=this;return i(function(){var r=t.dataView.getUint16(t.offset,!0);return t.offset+=2,r})},t.BinaryReader.prototype.readInt32=function(){var t=this;return i(function(){var r=t.dataView.getInt32(t.offset,!0);return t.offset+=4,r})},t.BinaryReader.prototype.readUint32=function(){var t=this;return i(function(){var r=t.dataView.getUint32(t.offset,!0);return t.offset+=4,r+0})},t.BinaryReader.prototype.readInt64=function(){var t=this;return i(function(){var r=t.dataView.getUint32(t.offset,!0);t.offset+=4;var e=t.dataView.getUint32(t.offset,!0);t.offset+=4;var i=Math.pow(2,32);return e<Math.pow(2,31)?r+i*e:-(i-r+i*(i-1-e))})},t.BinaryReader.prototype.readUint64=function(){var t=this;return i(function(){var r=t.dataView.getUint32(t.offset,!0);t.offset+=4;var e=t.dataView.getUint32(t.offset,!0);return t.offset+=4,r+Math.pow(2,32)*e})},t.BinaryReader.prototype.readFloat=function(){var t=this;return i(function(){var r=t.dataView.getFloat32(t.offset,!0);return t.offset+=4,r})},t.BinaryReader.prototype.readDouble=function(){var t=this;return i(function(){var r=t.dataView.getFloat64(t.offset,!0);return t.offset+=8,r})},t.BinaryReader.prototype.readChar=function(){var t=this;return i(function(){var r=t.dataView.getInt8(t.offset);return t.offset++,String.fromCharCode(r)})},t.BinaryReader.prototype.readString=function(t){var r=this;return i(function(){"number"!=typeof t&&(t=r.dataView.getUint32(r.offset,!0),r.offset+=4);for(var e="",i=0;i<t;++i)e+=String.fromCharCode(r.dataView.getUint8(r.offset)),r.offset++;return decodeURIComponent(escape(e))})},t.BinaryReader.prototype.readStrings=function(t){for(var r=[],e=0;e<t;++e)r.push(this.readString());return r},t.BinaryReader.prototype.readArrayBuffer=function(t){var r=this;return i(function(){var e;return t>0?(e=r.dataView.buffer.slice(r.offset,r.offset+t),r.offset+=t):e=new ArrayBuffer(0),e})},t.BinaryReader.prototype.readBoolArray=function(t){var r=Uint8Array.BYTES_PER_ELEMENT,e=this.readArrayBuffer(r*t);return new Uint8Array(e)},t.BinaryReader.prototype.readUint8Array=function(t){var r=Uint8Array.BYTES_PER_ELEMENT,e=this.readArrayBuffer(r*t);return new Uint8Array(e)},t.BinaryReader.prototype.readInt8Array=function(t){var r=Int8Array.BYTES_PER_ELEMENT,e=this.readArrayBuffer(r*t);return new Int8Array(e)},t.BinaryReader.prototype.readUint16Array=function(t){var r=Uint16Array.BYTES_PER_ELEMENT,e=this.readArrayBuffer(r*t);return new Uint16Array(e)},t.BinaryReader.prototype.readInt16Array=function(t){var r=Int16Array.BYTES_PER_ELEMENT,e=this.readArrayBuffer(r*t);return new Int16Array(e)},t.BinaryReader.prototype.readUint32Array=function(t){var r=Uint32Array.BYTES_PER_ELEMENT,e=this.readArrayBuffer(r*t);return new Uint32Array(e)},t.BinaryReader.prototype.readInt32Array=function(t){var r=Int32Array.BYTES_PER_ELEMENT,e=this.readArrayBuffer(r*t);return new Int32Array(e)},t.BinaryReader.prototype.readFloatArray=function(t){var r=Float32Array.BYTES_PER_ELEMENT,e=this.readArrayBuffer(r*t);return new Float32Array(e)},t.BinaryReader.prototype.readDoubleArray=function(t){var r=Float64Array.BYTES_PER_ELEMENT,e=this.readArrayBuffer(r*t);return new Float64Array(e)},t.BinaryReader.prototype.readKeys=function(t,r){var e=this.offset;this.readUint32(),this.readString();var i=this.readUint64(),n=this.offset-e+8*i,a=this.dataView.buffer.slice(e,e+n);this.offset=e+n,t.readKeys(a,r)},t.BinaryReader.prototype.readNodeId=function(t){var r=this.readString(),e=this.readInt32(),i=this.readString(),n=this.readInt32(),a=this.readInt32();return t.impl.unserializeNodeId(t,r,e,i,n,a)};var n=Object.freeze({booleanType:0,int8Type:1,uint8Type:2,int16Type:3,uint16Type:4,int32Type:5,uint32Type:6,int64Type:7,uint64Type:8,floatType:9,doubleType:10,stringType:11,stringsType:12,booleanArrayType:13,int8ArrayType:14,uint8ArrayType:15,int16ArrayType:16,uint16ArrayType:17,int32ArrayType:18,uint32ArrayType:19,floatArrayType:22,doubleArrayType:23,binaryType:24});t.TypedBinaryWriter=function(r){this.writer=new t.BinaryWriter(r),this.writer.writeUint16(16980),this.writer.writeUint16(1)};var a={writeBool:n.booleanType,writeInt8:n.int8Type,writeUint8:n.uint8Type,writeInt16:n.int16Type,writeUint16:n.uint16Type,writeInt32:n.int32Type,writeUint32:n.uint32Type,writeInt64:n.int64Type,writeUint64:n.uint64Type,writeFloat:n.floatType,writeDouble:n.doubleType,writeString:n.stringType,writeStrings:n.stringsType,writeBoolArray:n.booleanArrayType,writeInt8Array:n.int8ArrayType,writeUint8Array:n.uint8ArrayType,writeInt16Array:n.int16ArrayType,writeUint16Array:n.uint16ArrayType,writeInt32Array:n.int32ArrayType,writeUint32Array:n.uint32ArrayType,writeFloatArray:n.floatArrayType,writeDoubleArray:n.doubleArrayType,writeArrayBuffer:n.binaryType};function o(r){return function(e,i){this.writer.writeString(e);var o=a[r];if(this.writer.writeUint8(o),o>=n.stringsType){var y=void 0!==i.length?i.length:i.byteLength||0;this.writer.writeUint64(y)}return t.BinaryWriter.prototype[r].call(this.writer,i),this}}for(var y in a)a.hasOwnProperty(y)&&(t.TypedBinaryWriter.prototype[y]=o(y));function f(t){return function(){var r=this.readUint64();return t.call(this,r)}}t.TypedBinaryWriter.prototype.createArrayBuffer=function(){return this.writer.createArrayBuffer()},t.TypedBinaryReader=function(t){this.arrayBuffer=t};var s={};return s[n.booleanType]={read:t.BinaryReader.prototype.readBool,type:"bool"},s[n.int8Type]={read:t.BinaryReader.prototype.readInt8,type:"int8"},s[n.uint8Type]={read:t.BinaryReader.prototype.readUint8,type:"uint8"},s[n.int16Type]={read:t.BinaryReader.prototype.readInt16,type:"int16"},s[n.uint16Type]={read:t.BinaryReader.prototype.readUint16,type:"uint16"},s[n.int32Type]={read:t.BinaryReader.prototype.readInt32,type:"int32"},s[n.uint32Type]={read:t.BinaryReader.prototype.readUint32,type:"uint32"},s[n.int64Type]={read:t.BinaryReader.prototype.readInt64,type:"int64"},s[n.uint64Type]={read:t.BinaryReader.prototype.readUint64,type:"uint64"},s[n.floatType]={read:t.BinaryReader.prototype.readFloat,type:"float"},s[n.doubleType]={read:t.BinaryReader.prototype.readDouble,type:"double"},s[n.stringType]={read:t.BinaryReader.prototype.readString,type:"string"},s[n.stringsType]={read:f(t.BinaryReader.prototype.readStrings),type:"strings"},s[n.booleanArrayType]={read:f(t.BinaryReader.prototype.readBoolArray),type:"boolArray"},s[n.uint8ArrayType]={read:f(t.BinaryReader.prototype.readUint8Array),type:"uint8Array"},s[n.int8ArrayType]={read:f(t.BinaryReader.prototype.readInt8Array),type:"int8Array"},s[n.uint16ArrayType]={read:f(t.BinaryReader.prototype.readUint16Array),type:"uint16Array"},s[n.int16ArrayType]={read:f(t.BinaryReader.prototype.readInt16Array),type:"int16Array"},s[n.uint32ArrayType]={read:f(t.BinaryReader.prototype.readUint32Array),type:"uint32Array"},s[n.int32ArrayType]={read:f(t.BinaryReader.prototype.readInt32Array),type:"int32Array"},s[n.floatArrayType]={read:f(t.BinaryReader.prototype.readFloatArray),type:"floatArray"},s[n.doubleArrayType]={read:f(t.BinaryReader.prototype.readDoubleArray),type:"doubleArray"},s[n.binaryType]={read:f(t.BinaryReader.prototype.readArrayBuffer),type:"arrayBuffer"},t.TypedBinaryReader.prototype.apply=function(r){var e=new t.BinaryReader(this.arrayBuffer);if(16980!==e.readUint16()||1!==e.readUint16())return!1;for(var i=e.getSize();e.tell()<i;){var n=e.readString(),a=s[e.readUint8()],o=a?a.read.apply(e):void 0;if(void 0===o||!r.visit(n,o,a.type))return!1}return!0},t});