define("DS/ENOXModelListView/ModelListView/js/ModelListViewEmptyContent",["DS/ENOXEmptyContent/js/ENOXEmptyContent"],function(e){"use strict";return function(t,i,o,n){this._ENOXEmptyContent=new e(i.emptyContentOptions),this._ENOXEmptyContent.inject(n),this._modelEvents=o,console.log("hey i am the empty content"),0===t.getChildren().length&&n.classList.remove("displaynone");var s=this;["addChild","removeChild"].forEach(function(e){t.addEventListener(e,function(){0===t.getChildren().length?(n.classList.remove("displaynone"),s._modelEvents.publish({event:"xmodel-list-is-empty",data:!0})):(n.classList.add("displaynone"),s._modelEvents.publish({event:"xmodel-list-is-empty",data:!1}))})})}}),define("DS/ENOXModelListView/ModelListView/js/TitleTweaker",["DS/Tweakers/TweakerBase","DS/Tweakers/TweakerString","DS/Core/PointerEvents","DS/Utilities/Utils","DS/Utilities/Dom","DS/Controls/Button","DS/Controls/LineEditor","css!ENOXModelListView/ModelListView/css/TitleTweaker.css"],function(e,t,i,o,n,s,l){"use strict";var a=e.inherit({name:"titleTweaker",publishedProperties:{label:{defaultValue:"",type:"string"},displayStyle:{defaultValue:"editText",type:"string",category:"Appearance"},linkDisplay:{defaultValue:!0,type:"boolean",category:"Appearance"}}}),d=function(t,i){e.prototype.baseViewModule.call(this,t,i)};o.applyMixin(d,e.prototype.baseViewModule);var r=function(e,t){d.call(this,e,t)};return o.applyMixin(r,d),r.prototype.buildView=function(){if(this._tweaker.elements.container){var e=UWA.merge({},this._options.viewOptions);e.touchMode=this._tweaker._getCurrentTouchMode(),e.allowUnsafeHTMLLabel=!1,e.selectAllOnFocus=!0;var t,o=this;if(this._tweaker.value&&(e.value=this._tweaker.value),this._tweaker._isFakeNode=!0,this._tweaker.executionContext.nodeModel.options.id&&(this._tweaker._isFakeNode=!1),this._textSpan=UWA.createElement("span",{textContent:e.value}),this._link=UWA.createElement("a",{textContent:e.value}),this._link.addEventListener(i.POINTERDOWN,(t=this._tweaker,function(e){t.linkDisplay&&(e.stopPropagation(),t.executionContext&&t.executionContext.nodeModel.getModelEvents().publish({event:"title-link-action",context:t.executionContext}))})),this._lineEditor=new l(e),this._view=UWA.createElement("div",{class:"title-tweaker"}),this._view.addContent(this._link),this._view.addContent(this._textSpan),this._view.addContent(this._lineEditor),this._view.addClassName("not-editable"),this._view._giveFocus=function(){o._lineEditor._giveFocus()},this.setValue(this._tweaker.value),!this._tweaker.readOnly){o._tweaker.timeSwitchtoEdit=new Date;setTimeout(function(){o._view.removeClassName("not-editable"),o._tweaker._isFakeNode=!1},500),o._view.addEventListener(i.POINTERDOWN,function(e){new Date-o._tweaker.timeSwitchtoEdit>500?o.setEditable(!0):o._tweaker.executionContext&&o._tweaker.executionContext.nodeModel.getModelEvents().publish({event:"title-link-action",context:o._tweaker.executionContext})})}}},r.prototype.handleEvents=function(){var e=this,t=this._view;t.addEventListener(i.LONGHOLD,function(e){e.stopPropagation()}),t.addEventListener("contextmenu",function(e){}),n.addEventOnElement(e._tweaker,this._lineEditor,"blur",function(t){t.stopPropagation(),e._tweaker.onPostEdit()}),n.addEventOnElement(e._tweaker,this._lineEditor,"uncommittedChange",function(t){t.stopPropagation(),e._tweaker.onPreEdit()}),n.addEventOnElement(this._tweaker,this._lineEditor,"change",function(t){t.stopPropagation(),e._tweaker.readOnly||(e.setTweakerValue(e._lineEditor.value),e._tweaker.onPostEdit())}),n.addEventOnElement(e._tweaker,this._lineEditor,"focusout",function(t){t.stopPropagation(),e.setEditable(!1)}),n.addEventOnElement(e._tweaker,this._lineEditor,"keyup",function(t){13==t.keyCode&&(t.stopPropagation(),e.setEditable(!1))})},r.prototype.setEditable=function(e){if(this._view)try{e&&!this._view.isEditing?this._view.addClassName("editing"):e||(this._view.isEditing=!1,this._view.removeClassName("editing"),this.setValue(this._tweaker.value))}catch(e){UWA.log("editable false")}},r.prototype.setValue=function(){this._view&&(this._tweaker.linkDisplay?this._view.removeClassName("no-link-display"):this._view.addClassName("no-link-display"),void 0===this._tweaker.value||null===this._tweaker.value?this._view.label="undefined":(this._textSpan.textContent=this._tweaker.value,this._link.textContent=this._tweaker.value,this._lineEditor.value=this._tweaker.value))},a.prototype.baseViewModule=d,a.prototype.VIEW_MODULES={editText:{classObject:r,options:{viewOptions:{displayStyle:"editText"}}},editText_readOnly:{classObject:r,options:{viewOptions:{displayStyle:"editText"}}}},a}),define("DS/ENOXModelListView/ModelListView/js/ContextualMenuTweaker",["DS/Tweakers/TweakerBase","DS/Utilities/Utils","DS/Controls/Button","DS/Menu/ContextualMenu","DS/Menu/Menu"],function(e,t,i,o,n){"use strict";var s=e.inherit({name:"contextualMenu",publishedProperties:{label:{defaultValue:"",type:"string"},icon:{defaultValue:{iconName:"chevron-down",fontIconFamily:WUXManagedFontIcons.Font3DS},type:"string"},displayStyle:{defaultValue:"menuIcon",type:"string",category:"Appearance"}},computeContentSize:function(){return 30}}),l=function(t,i){e.prototype.baseViewModule.call(this,t,i)};t.applyMixin(l,e.prototype.baseViewModule);var a=function(e,t){l.call(this,e,t)};return t.applyMixin(a,l),a.prototype.buildView=function(){if(this._tweaker.elements.container){var e=UWA.merge({},this._options.viewOptions);e.touchMode=this._tweaker._getCurrentTouchMode(),e.displayStyle="lite",e.icon=this._tweaker.icon,e.allowUnsafeHTMLLabel=!1,this._tweaker.value&&this._tweaker.value.menu&&this._tweaker.value.menu.length>0&&1==this._tweaker.value.menu.length&&(e.icon={iconName:this._tweaker.value.menu[0].icon,fontIconFamily:WUXManagedFontIcons.Font3DS}),this._view=new i(e),this._view.getContent().addClassName("contextualMenu"),this.setValue(this._tweaker.value)}},a.prototype.handleEvents=function(){var e=this,t=this._view;this._tweaker.executionContext;t&&t.addEventListener("buttonclick",function(i){if(e._tweaker.value&&!(1==e._tweaker.value.disabled||e._tweaker.value.menu&&1==e._tweaker.value.menu.length&&e._tweaker.value.menu[0]&&e._tweaker.value.menu&&"disabled"==e._tweaker.value.menu[0].state)){var o=e._tweaker.value.menu;if(o)if(1==o.length)o[0].action.callback(i);else{var s=t.getContent().getBoundingClientRect();n.show(o,{position:{x:s.left,y:s.top+s.height},submemu:"outside"})}}})},a.prototype.setValue=function(){if(this._view&&(this._view.icon=this.getMenuIcon(),void 0===this._tweaker.value||null===this._tweaker.value?this._view.value="undefined":(this._view.value=this._tweaker.value,this._tweaker.value&&(1==this._tweaker.value.disabled||this._tweaker.value.menu&&1==this._tweaker.value.menu.length&&this._tweaker.value.menu[0]&&this._tweaker.value.menu&&"disabled"==this._tweaker.value.menu[0].state)?this._view.getContent().setAttribute("disabled",!0):this._view.getContent().removeAttribute("disabled"),this._tweaker.value&&this._tweaker.value.menu&&this._tweaker.value.menu.length>0?this._view.show():this._view.hide()),this._tweaker.executionContext)){this._eventToken&&this._tweaker.executionContext.nodeModel.removeEventListener(this._eventToken);var e=this;this._eventToken=this._tweaker.executionContext.nodeModel.addEventListener("pushUpdate",function(){null!=this.options.disableMenu&&this.options.disableMenu!=e._tweaker.value.disabled&&(e._tweaker.value.disabled=this.options.disableMenu,e.setValue())})}},a.prototype.getMenuIcon=function(){var e={iconName:"chevron-down",fontIconFamily:WUXManagedFontIcons.Font3DS};return this._tweaker.value&&this._tweaker.value.menu&&this._tweaker.value.menu.length>0&&1==this._tweaker.value.menu.length&&(e={iconName:this._tweaker.value.menu[0].icon,fontIconFamily:WUXManagedFontIcons.Font3DS}),e},a.prototype.removeEvents=function(){this._view&&this._view.removeEventListener("buttonclick")},a.prototype._updateView=function(){this.setValue()},s.prototype.baseViewModule=l,s.prototype.VIEW_MODULES={menuIcon:{classObject:a,options:{viewOptions:{}}},readOnly:{classObject:a,options:{viewOptions:{displayStyle:"menuIcon"}}}},s}),define("DS/ENOXModelListView/ModelListView/js/ModelListViewCollectionToolBar",["DS/ENOXCollectionToolBar/js/ENOXCollectionToolBarV2","i18n!DS/ENOXModelListView/assets/nls/ModelListView","css!ENOXModelListView/ModelListView/css/ModelListView.css"],function(e,t){"use strict";var i=function(i,o,n){if(this._initMaps(),this._model=i,this._disabledActions=[],this._opts={},this._opts.views=[],o.viewOptions){if(o.viewOptions.views)for(var s=0;s<o.viewOptions.views.length;s+=1)this._opts.views.push({id:o.viewOptions.views[s],text:this._localMap_text[o.viewOptions.views[s]],fonticon:this._localMap_fonticon[o.viewOptions.views[s]]});this._opts.currentView=o.viewOptions.currentView?o.viewOptions.currentView:o.viewOptions.views?o.viewOptions.views[0]:void 0}this._opts.currentSort=o.viewOptions.currentSort?o.viewOptions.currentSort:void 0,this._opts.sort=[];s=0;var l=[];for(this._selectedGroupItem=null,s=0;s<o.viewOptions.grid.columns.length;s+=1)""!==o.viewOptions.grid.columns[s].text&&(1!=o.restrictSortFlag&&this._opts.sort.push({id:o.viewOptions.grid.columns[s].dataIndex,text:o.viewOptions.grid.columns[s].text,type:"number"===o.viewOptions.grid.columns[s].typeRepresentation?"integer":"string"}),1==o.viewOptions.grid.columns[s].groupableFlag&&l.push({id:o.viewOptions.grid.columns[s].dataIndex,text:o.viewOptions.grid.columns[s].text,selectable:!0,isSelected:!1,handler:function(e,t){var i=a._getItem(t.parent);if(a._actionParentGroupBy=i,i){var o=[];t.id&&(t.isSelected?(i.elements.container.removeClassName("selected"),t.isSelected=!1):(i.elements.container.hasClassName("selected")||i.elements.container.addClassName("selected"),t.isSelected=!0,a._selectedGroupItem=t,o.push(t.id))),a._opts.modelEvents.publish({event:"xmodel-list-view-group-by-action",data:o});var n=t.id,s=t.isSelected;if(i.content.component)i.content.component.items.forEach(function(e){n===e.id&&(s?e.elements.container.hasClassName("selected")||e.elements.container.addClassName("selected"):e.elements.container.removeClassName("selected"))})}}}));var a=this;this._opts.modelEvents=n,this._opts.withmultisel=!!o.withmultisel&&o.withmultisel,this._opts.showItemCount=0!=o.showItemCount||o.showItemCount,this._opts.filter={enableCache:!0},this._opts.itemsName=o.toolbarOptions.itemsName,this._opts.itemName=o.toolbarOptions.itemName,this._opts.showSwitchViewAction=!1,o.viewOptions&&(this._opts.showSwitchViewAction=!0),this._opts.withStableActions=o.toolbarOptions.withStableActions,this._opts.stableActions=[],o.toolbarOptions.hideView&&(this._opts.showSwitchViewAction=!1),this._opts.actions=this._getToolbarActions(o.toolbarOptions.actions);var d=o.toolbarOptions.filterActions?o.toolbarOptions.filterActions:[];if(d.length>0)for(var r=0;r<d.length;r++){var c=d[r],u=[];if(c&&c.actions&&c.actions.length>0){c.actions.forEach(function(e){u.push({id:e.id,text:e.text,selectable:e.selectable,selected:!!e.selected&&e.selected,items:e.items?e.items:void 0,multiSelect:!!e.multiSelect&&e.multiSelect,handler:function(e,t){if(console.log(""),t.id){var i=(a._opts.withStableActions?a._collectionToolBar._actionsFixedIconBar.menu:a._collectionToolBar._actionsIconBar.menu).getItem("mv-filter").content.component.getItem(t.id).selected;console.log("Filter criteria updated!"),a._opts.modelEvents.publish({event:"xmodel-list-collection-toolbar-filter-changed",data:{id:t.id,parentId:t.parentId?t.parentId:void 0,selected:i||!1}})}}})});var h={id:c.id,className:c.className?c.className:"",title:c.text,text:c.text,fonticon:c.fonticon,multiSelect:!0,selected:!!c.selected&&c.selected,content:u,handler:function(e,t){}};this._opts.withStableActions?this._stableActions.push(h):this._opts.actions.splice(0,0,h)}}if(UWA.is(this._opts.actions,"array")&&l.length>0){let e=o.toolbarOptions.groupByActionIndex>-1?o.toolbarOptions.groupByActionIndex:this._opts.actions.length;this._opts.actions.splice(e,0,{id:"groupByAction",className:"group-by-action",title:t._groupByAction,text:t._groupByAction,fonticon:"horizontal-line",content:l,handler:function(){}})}0===this._opts.sort.length&&delete this._opts.sort,0===this._opts.views.length&&delete this._opts.views,this._collectionToolBar=new e(this._opts),this._subscribeEvents(),this._initSort()};return i.prototype._subscribeEvents=function(){var e=this;this._opts.modelEvents.subscribe({event:"xmodel-list-item-on-add-selection"},function(){e._opts.withStableActions||e._showMultiselectActions.length>0?e._showMultiselectActions.forEach(t=>{-1==e._hiddenActions.indexOf(t)&&e._opts.modelEvents.publish({event:"enox-collection-toolbar-visibility-action",data:{id:t,flag:!0}})}):e._multiselectActions.forEach(function(t){-1==e._disabledActions.indexOf(t)&&e._opts.modelEvents.publish({event:"enox-collection-toolbar-enable-action",data:t})})}),this._opts.modelEvents.subscribe({event:"xmodel-list-item-on-empty-selection"},function(){e._opts.withStableActions||e._showMultiselectActions.length>0?e._showMultiselectActions.forEach(t=>{e._opts.modelEvents.publish({event:"enox-collection-toolbar-visibility-action",data:{id:t,flag:!1}})}):e._multiselectActions.forEach(function(t){e._opts.modelEvents.publish({event:"enox-collection-toolbar-disable-action",data:t})})}),this._opts.modelEvents.subscribe({event:"xmodel-list-toolbar-hide-action"},function(t){e._hiddenActions.indexOf(t)<0&&(e._opts.modelEvents.publish({event:"enox-collection-toolbar-visibility-action",data:{id:t,flag:!1}}),e._hiddenActions.push(t))}),this._opts.modelEvents.subscribe({event:"xmodel-list-toolbar-show-action"},function(t){var i=e._hiddenActions.indexOf(t);if(i>-1){if(e._hiddenActions.splice(i,1),e._showMultiselectActions.indexOf(t)>-1&&0===e._model.getSelectedNodes().length)return void e._opts.modelEvents.publish({event:"enox-collection-toolbar-visibility-action",data:{id:t,flag:!1}});e._opts.modelEvents.publish({event:"enox-collection-toolbar-visibility-action",data:{id:t,flag:!0}})}}),this._opts.modelEvents.subscribe({event:"xmodel-list-toolbar-disable-action"},function(t){e._disabledActions.indexOf(t)<0&&(e._opts.modelEvents.publish({event:"enox-collection-toolbar-disable-action",data:t}),e._disabledActions.push(t))}),this._opts.modelEvents.subscribe({event:"xmodel-list-toolbar-enable-action"},function(t){var i=e._disabledActions.indexOf(t);if(i>-1){if(e._disabledActions.splice(i,1),e._multiselectActions.indexOf(t)>-1&&0==e._model.getSelectedNodes().length)return void e._opts.modelEvents.publish({event:"enox-collection-toolbar-disable-action",data:t});e._opts.modelEvents.publish({event:"enox-collection-toolbar-enable-action",data:t})}}),this._opts.modelEvents.subscribe({event:"enox-collection-toolbar-filter-search-value"},function(t){var i=t.searchValue[0]||"";e._opts.modelEvents.publish({event:"xmodel-list-context-search-action",data:i})}),this._opts.modelEvents.subscribe({event:"xmodel-list-view-group-by-action"},function(t){var i;if(t&&t.length>0){var o={actionId:"groupByAction",contentId:t};if(!e._selectedGroupItem){var n=e._collectionToolBar._options.actions;if(n&&n.length>0){for(var s=0;s<n.length;s++)if("groupByAction"===n[s].id&&n[s].content&&n[s].content.length>0){i=n[s].content;break}if(i&&i.length>0)for(var l=0;l<i.length;l++)i[l].id===t[0]&&(e._selectedGroupItem=i[l]);var a=e._collectionToolBar._container.querySelector(".group-by-action");a&&(a.hasClassName("selected")?a.removeClassName("selected"):a.addClassName("selected"));var d=e._collectionToolBar._actionsIconBar.menu.getItem("groupByAction");if(d.content&&d.content.options&&d.content.options.items)d.content.options.items.forEach(function(e){e.id===t[0]&&(e.isSelected=!0,e.selected=!0)})}}var r=[],c=e._getItem("groupByAction"),u=t[0];if(c.content.options.items.forEach(function(e){u!==e.id&&r.push(e.id)}),r.length>0&&r.forEach(function(t){var i=e._collectionToolBar._actionsIconBar.overflowMenu.getItem(t);i&&i.elements.container.hasClassName("selected")&&i.elements.container.removeClassName("selected")}),e._collectionToolBar._actionsIconBar.overflowMenu.getItem(t[0])){var h=e._collectionToolBar._actionsIconBar.overflowMenu.getItem(t[0]);h.elements.container.hasClassName("selected")||h.elements.container.addClassName("selected")}e._opts.modelEvents.publish({event:"enox-collection-toolbar-action-item-selection",data:o})}else{var p=e._collectionToolBar._actionsIconBar.menu.getItem("groupByAction");if(p&&p.content&&p.content.component&&p.content.component.items){var _=p.content.component.items;_&&_.forEach(function(t){if(t.elements.container){var i=t.elements.container;i.hasClassName("selected")&&i.removeClassName("selected")}var o=e._collectionToolBar._actionsIconBar.overflowMenu.getItem(t.id);o&&o.elements.container.hasClassName("selected")&&o.elements.container.removeClassName("selected")})}}}),this._opts.modelEvents.subscribe({event:"xmodel-list-toolbar-group-visibility"},function(t){var i=e._collectionToolBar._container.querySelector(".group-by-action"),o=e._collectionToolBar._actionsIconBar.overflowMenu.elements.container.querySelector(".groupByAction");e._opts.withStableActions&&o&&(o.style.display=t?"":"none"),i&&(t?(i.removeClassName("displaynone"),i.removeClassName("selected"),e._selectedGroupItem&&(e._selectedGroupItem.isSelected=!1,e._selectedGroupItem.elements&&e._selectedGroupItem.elements.container.removeClassName("selected"),e._selectedGroupItem=null)):i.addClassName("displaynone"))}),this._opts.modelEvents.subscribe({event:"xmodel-list-toolbar-update-switch-view"},function(t){e._opts.modelEvents.publish({event:"enox-collection-toolbar-select-view",data:{id:t,silent:!0}})}),this._opts.modelEvents.subscribe({event:"xmodel-list-collection-toolbar-update-filter-menu-status"},function(e){if(e&&e.id){var t=document.getElementById(e.id);t&&(!0===e.selected&&!1===t.hasClassName("selected")?t.addClassName("selected"):!1===e.selected&&!0===t.hasClassName("selected")&&t.removeClassName("selected"))}})},i.prototype._getItem=function(e){return this._collectionToolBar._actionsIconBar.getItem(e)},i.prototype._initMaps=function(){this._localMap_text={},this._localMap_text.DataGridView=t._dataGridView,this._localMap_text.TileView=t._tileView,this._localMap_text.ThumbnailView=t._thumbnailView,this._localMap_text.LargeThumbnailView=t._largeTileView,this._localMap_fonticon={},this._localMap_fonticon.DataGridView="view-list",this._localMap_fonticon.TileView="view-small-tile",this._localMap_fonticon.ThumbnailView="view-big-thb",this._localMap_fonticon.LargeThumbnailView="view-big-tile"},i.prototype._getToolbarActions=function(e){var t=[];this._multiselectActions=[];var i=this;return this._showMultiselectActions=[],this._hiddenActions=[],e.forEach(function(e){var o={handler:function(t,o,n){var s=[];if(e.callSubMenuHandler&&o&&UWA.is(o.handler,"function"))console.log("Nothing, as event would be fired by UIKIT and be handled in respective handler.!!!");else{if(e.allowSelectRetain)n&&n.hasOwnProperty("selected")&&s.push(n.selected);else if(e.enableOnSelection||e.showOnSelection){var l=[];i._model.getSelectedNodes().forEach(function(e){l.push(e.options)}),s.push(l),s.push(i._model.getSelectedNodes())}e.handler.apply(i._model,s)}}};e.enableOnSelection&&(o.disabled=!0,i._multiselectActions.push(e.id)),e.showOnSelection&&i._showMultiselectActions.push(e.id),e.visibility&&i._hiddenActions.push(e.id),UWA.merge(o,e),t.push(o)}),t},i.prototype._hideActions=function(){var e=this;(this._opts.withStableActions||this._showMultiselectActions.length>0)&&this._showMultiselectActions.forEach(function(t,i){e._opts.modelEvents.publish({event:"enox-collection-toolbar-visibility-action",data:{id:t,flag:!1}})}),this._hiddenActions.length>0&&this._hiddenActions.forEach(function(t){e._opts.modelEvents.publish({event:"enox-collection-toolbar-visibility-action",data:{id:t,flag:!1}})})},i.prototype.inject=function(e){this._collectionToolBar.inject(e),this._hideActions()},i.prototype.attachResizeSensor=function(){this._collectionToolBar.attachResizeSensor()},i.prototype._initSort=function(){var e=this;this._opts.modelEvents.subscribe({event:"enox-collection-toolbar-sort-activated"},function(t){if(t&&t.sortAttribute&&t.sortOrder){console.log("sorting tree on "+t.sortAttribute+" "+t.sortOrder);var i={dataIndex:t.sortAttribute,sort:t.sortOrder.toLowerCase(),id:t.sortAttribute,order:t.sortOrder.toLowerCase()};e._collectionToolBar._activateCurrentSort(i),e._opts.modelEvents.publish({event:"xmodel-list-data-sort-action",data:i})}})},i}),define("DS/ENOXModelListView/ModelListView/js/ModelListViewDataExtension",["UWA/Class","DS/Tree/TreeNodeModel","DS/ENOXWildcardSearchComponent/ENOXWildcardSearchComponent","DS/PlatformAPI/PlatformAPI"],function(e,t,i,o){"use strict";return e.extend({_id:"data-extention",initialize:function(e){this._viewId=e.id,this._model=e.model,this._useAsyncExpand=e.useAsyncExpand,this._dataFilters={},this._searchFilters={},this._FILTER_ATTRIBUTES=["id","name","title","description","type","revision","responsible","owner","creator","maturity","state"],this._modelEvents=e.modelEvents,this._childKeys=e.childKeys?e.childKeys:[],this._filterData={},this._searchFilter={},this._wildCardSearchComponent=new i,this._isFilterDataUpdating,this._filterNodeLevel=0,this._defaultNodeDepth=e.defaultNodeDepth?e.defaultNodeDepth:0,this._keepSelectionOnHide=!!e.keepSelectionOnHide&&e.keepSelectionOnHide,this.subscribeEvents()},subscribeEvents:function(){var e=this;this._modelEvents.subscribe({event:"xmodel-list-data-on-load-complete"},function(){}),this._modelEvents.subscribe({event:"xmodel-list-data-load-action"},function(t){e._loadData(t,UWA.is(this,"object")?this:void 0)}),this._modelEvents.subscribe({event:"xmodel-list-data-item-append-action"},function(t){e._loadData(t,UWA.is(this,"object")?this:void 0,{append:!0})}),this._modelEvents.subscribe({event:"xmodel-list-data-item-add-update-action"},function(t){e._addOrUpdateDataItem(t)}),this._modelEvents.subscribe({event:"xmodel-list-data-item-add-action"},function(t){var i=e._addDataItem(t,UWA.is(this,"object")?this:void 0);e._modelEvents.publish({event:"xmodel-list-data-item-on-add-complete",data:i,context:i})}),this._modelEvents.subscribe({event:"xmodel-list-add-many-items"},function(t){var i=e._addDataItem(t,UWA.is(this,"object")?this:void 0);e._modelEvents.publish({event:"xmodel-list-data-item-on-add-complete",data:i,context:i})}),this._modelEvents.subscribe({event:"xmodel-list-data-item-remove-action"},function(t){e._removeDataItem(t)}),this._modelEvents.subscribe({event:"xmodel-list-data-item-remove-and-parent"},function(t){e._removeDataItem(t,void 0,!0)}),this._modelEvents.subscribe({event:"xmodel-list-data-item-update-action"},function(t){e._updateDataItem(t,UWA.is(t.context,"object")?t.context:void 0)}),this._modelEvents.subscribe({event:"xmodel-list-data-filter-action"},function(t){e.filter(t)}),this._modelEvents.subscribe({event:"xmodel-list-data-search-action"},function(t){e._wildCardSearch(t)}),this._modelEvents.subscribe({event:"xmodel-list-data-set-filter-node-level"},function(t){UWA.is(t,"number")&&(e._filterNodeLevel=t)}),this._modelEvents.subscribe({event:"xmodel-list-get-filtered-data"},function(t){e._getFilteredData().then(function(){UWA.is(t,"function")&&t(e._filterData)})}),this._model.subscribe({event:"matchSearch"},function(e){e.data.nodeModel.show()}),this._model.subscribe({event:"unmatchSearch"},function(t){t.data.nodeModel.hide(e._keepSelectionOnHide)}),o.subscribe("DS/PADUtils/PADCommandProxy/refresh",function(t){(t&&t.data&&t.data.authored&&t.data.authored.modified?t.data.authored.modified:[]).forEach(function(t,i){t&&e._model.search({shouldStop:function(i){return i.options.id===t&&(e._modelEvents.publish({event:"xmodel-list-data-item-need-refresh",data:t,context:i}),!0)}})})})},_loadData:function(e,t,i){var o=this._model,n=!(void 0===i||!i.append);t&&UWA.is(t,"object")&&(o=t),o.prepareUpdate(),o.removeRoots&&!n?(o.ungroupRoots(),o.removeRoots()):o.removeChildren&&!n&&o.removeChildren(),this._modelEvents.publish({event:"xmodel-list-reset-sort-model",data:{}}),e&&e.member&&(this._isFilterDataUpdating=!1,this._loadChildData(e,o),this._modelEvents.publish({event:"xmodel-list-view-update-grouping-action",data:o})),o.pushUpdate(),this._updateFilterData()},_loadChildData:function(e,i){var o=this;e.member.forEach(function(e,n){var s=o._getNodeOptions(e,n);if(s){o._useAsyncExpand&&(s.children=[]);var l=new t(s);if(i.addChild(l),o._childKeys&&o._childKeys.length>0)for(var a=0,d=o._childKeys.length;a<d;a++){var r=o._childKeys[a];e.hasOwnProperty(r)&&o._loadChildData(e[r],l)}}})},_removeDataItem:function(e,t,i){var o=this._model;t&&UWA.is(t,"object")&&(o=t),this._isFilterDataUpdating=!1,o.prepareUpdate(),UWA.is(e,"array")||(e=[e]);var n=o.search({match:function(t){return-1!=e.indexOf(t.nodeModel.options.id)}});n&&n.forEach(function(e){if(i&&e.getNodeDepth()>0&&0===e.getBrothers().length)return e.getParent().hide(),void e.getParent().remove();e.hide(),e.remove()}),o.pushUpdate(),this._updateFilterData()},_updateDataItem:function(e,t){if(!t||!UWA.is(t,"object")){var i=e.id?e.id:e["@id"];i&&this._model.search({shouldStop:function(e){return i==e.options.id&&(t=e,!0)}})}return t&&(t.prepareUpdate(),t.updateOptions(this._getNodeOptions(e)),t.pushUpdate()),t},_addDataItem:function(e,i){var o=this._model;i&&UWA.is(i,"object")&&(o=i),this._isFilterDataUpdating=!1,o.prepareUpdate();var n=o.getChildren()?o.getChildren().length:0,s=new t(this._getNodeOptions(e,n));if(s)return!i&&this._useAsyncExpand&&(s.options.children=[]),o.addChild(s),o.pushUpdate(),this._updateFilterData(),s},_addOrUpdateDataItem:function(e){var t,i=e.item,o=e.parent;if(o)switch((t=this._model.search({match:function(e){return e.nodeModel.options.id===o.id&&e.nodeModel}})).length){case 0:var n=this._addDataItem(o);this._addDataItem(i,n);break;case 1:0===this._model.search({match:function(e){return e.nodeModel.options.id===i.id&&e.nodeModel}}).length&&(this._addDataItem(i,t[0]),this._updateDataItem(o,t[0]));break;default:console.warn("Caution find many parent node with identical ID")}else switch((t=this._model.search({match:function(e){return e.nodeModel.options.id===i.id&&e.nodeModel}})).length){case 0:n=this._addDataItem(i);for(var s=0;s<this._childKeys.length;s++)if(i[this._childKeys[s]]){l=this._childKeys[s];break}if((a=i[l].member).length>0)for(s=0;s<a.length;s++)this._addDataItem(a[s],n);break;case 1:var l;for(s=0;s<this._childKeys.length;s++)if(i[this._childKeys[s]]){l=this._childKeys[s];break}var a;if((a=i[l].member).length>0){for(s=0;s<a.length;s++){this._model.search({match:function(e){return e.nodeModel.options.id===a[s].id&&e.nodeModel}}).length>0||this._addDataItem(a[s],t[0])}this._updateDataItem(i,t[0])}break;default:console.warn("Caution find many parent node with identical ID")}},_getNodeOptions:function(e,t){if(e.id){e.id=e.id?e.id:e["@id"];var i=e;return{id:e.id?e.id:e["@id"],label:e.title,description:e.description,subLabel:"",grid:i,icons:e.image?[e.image]:e.thumbnail?[e.thumbnail]:[],thumbnail:e.image?e.image:e.thumbnail?e.thumbnail:"",color:""}}},filter:function(e){var t=[];if(e.id){var i,o=this;for(var n in this._dataFilters[e.id]=e.content||{},this._model.prepareUpdate(),o._dataFilters)if(o._dataFilters.hasOwnProperty(n)){var s=o._dataFilters[n];if(s.ids){var l=s.idPrefix||"";i=i?i.filter(function(e){return-1!=s.ids.indexOf(l+e)&&o._filterData.hasOwnProperty(e)}):s.ids.reduce(function(e,t){return l&&t.startsWith(l)&&(t=t.slice(l.length)),o._filterData.hasOwnProperty(t)&&e.push(t),e},[])}}i||(i=[]);this._model.search({match:function(e){if(-1!=i.indexOf(e.nodeModel.options.id)){e.nodeModel.matchSearch(),t.push(e.nodeModel.options.id);var o=e.nodeModel.getNodeDepth();if(o>0)for(var n=e.nodeModel.getParent();o>0;)o--,n&&(n.isMatchingSearch()||(n.matchSearch(),-1===i.indexOf(n.options.id)&&t.push(n.options.id)),n=n.getParent());return!0}return e.nodeModel.unmatchSearch(),!1},shouldStop:function(e){return e.getNodeDepth()>o._filterNodeLevel+o._defaultNodeDepth}});this._model.pushUpdate(),this._modelEvents.publish({event:"xmodel-list-data-on-update"})}return t},_createFilterDataForNodes:function(e){var t=this;e&&e.getChildren().forEach(function(e){t._filterData[e.options.id]=t._FILTER_ATTRIBUTES.reduce(function(t,i){return t||(t={}),t[i]=e.options.grid.hasOwnProperty(i)?e.options.grid[i]:"",t},{}),e.hasChildren()&&t._createFilterDataForNodes(e)})},_updateFilterData:function(){var e=this;return e._filterData={},new UWA.Promise(function(t,i){try{e._createFilterDataForNodes(e._model),t()}catch(t){e._filterData={},i()}e._modelEvents.publish({event:"xmodel-list-filter-data-update-complete"}),e._isFilterDataUpdating=!1})},_getFilteredData:function(){var e=this;return new UWA.Promise(function(t,i){if(0==e._isFilterDataUpdating)return t();e._modelEvents.subscribeOnce({event:"xmodel-list-filter-data-update-complete"},function(){t()}),e._isFilterDataUpdating||e._updateFilterData()})},_wildCardSearch:function(e){var t=this;if(e.id){this._searchFilters[e.id]=e.content||{};var i=e.content;this._getFilteredData().then(function(){var o=Object.keys(t._filterData).map(function(e){return t._filterData[e]});i.value;t._wildCardSearchComponent.search(i.value,o,function(i){var o=[];i&&(o=i.map(function(e){return e.id}));var n=t.filter({id:e.id,content:{ids:o}});t._modelEvents.publish({event:"xmodel-list-data-on-search-complete",data:n})},["id"])})}},destroy:function(){}})}),define("DS/ENOXModelListView/ModelListView/js/ModelListViewTaggerExtension",["UWA/Class","DS/ENOXTaggerOnIndexComponent/ENOXTaggerOnIndexComponent"],function(e,t){"use strict";return e.extend({_id:"tagger-extention",initialize:function(e){this._taggerId=e.id,this._model=e.model,this._modelEvents=e.modelEvents,this._friendTags=[],this.subscribeEvents(),this._taggerComponent=t},subscribeEvents:function(){var e=this;this._modelEvents.subscribe({event:"xmodel-list-data-on-load-complete"},function(){e._modelEvents.publish({event:"xmodel-list-get-filtered-data",data:function(t){e._setupTagger(t?Object.keys(t):[])}})}),this._modelEvents.subscribe({event:"xmodel-list-tagger-activate-action"},function(){e._activateTagger()}),this._modelEvents.subscribe({event:"xmodel-list-tagger-deactivate-action"},function(){e._deactivateTagger()}),this._modelEvents.subscribe({event:"xmodel-list-tagger-update-friend-tags-action"},function(t){UWA.is(t,"array")&&(e._friendTags=t)}),this._modelEvents.subscribe({event:"xmodel-list-data-on-search-complete"},function(t){e._filterTagger(t)}),this._modelEvents.subscribe({event:"xmodel-list-tagger-focus-action"},function(t){var i=[];t.forEach(function(e){i.push(e.options.grid.id)}),e._focusOnSubjects(i)}),this._modelEvents.subscribe({event:"xmodel-list-tagger-unfocus-action"},function(){e._unfocus()}),this._modelEvents.subscribe({event:"xmodel-list-tagger-init-action"},function(t){e._modelEvents.publish({event:"xmodel-list-get-filtered-data",data:function(t){e._setupTagger(t?Object.keys(t):[])}})}),this._modelEvents.subscribe({event:"xmodel-list-tagger-set-filter-action"},function(t){e._taggerComponent.setLocalFilter(e._taggerId,t)}),this._modelEvents.subscribe({event:"xmodel-list-tagger-get-filter-action"},function(t){if(UWA.is(t,"function")){var i=e._taggerComponent.getTagProxy(e._taggerId);if(i)t(i.getCurrentFilter())}})},_setupTagger:function(e){console.log("set up tagger");var t=this,i={MyFriends:t._friendTags,onSetTagProxy:function(){t._modelEvents.publish({event:"xmodel-list-tagger-on-setup"})},onTagFilterChange:function(){console.log();var e=t._taggerComponent.getTagProxy(t._taggerId).getCurrentFilter(),i=e.filteredSubjectList;if(i&&i.length>0){var o={id:"taggerFilter",content:{ids:i,idPrefix:"pid://"}};t._modelEvents.publish({event:"xmodel-list-data-filter-action",data:o}),t._modelEvents.publish({event:"xmodel-list-tagger-on-filter-change",data:e.allfilters})}},onTagColor:function(e){console.log(),t._setDataColor(e.coloredSubjects)},onTagUncolor:function(){console.log(),t._unsetDataColor()},colorize:!0,subjectPrefix:"pid://"},o=e||[];this._taggerComponent.killTagProxy(this._taggerId),this._taggerComponent.setTagProxy(this._taggerId,i,o)},_getDataIds:function(){var e=[],t=this._model.getChildren();return t&&t.forEach(function(t){var i=t.options.id||t._id;e.push(i)}),e},_setDataColor:function(e){this._modelEvents.publish({event:"xmodel-list-set-column-visibility-action",data:{dataIndex:"color",visibility:!0}}),this._model.search({match:function(t){return!!e.hasOwnProperty(t.nodeModel.options.id)&&(t.nodeModel.prepareUpdate(),t.nodeModel.updateOptions({color:e[t.nodeModel.options.id]}),t.nodeModel.setAttribute("color",e[t.nodeModel.options.id]),t.nodeModel.pushUpdate(),!0)}})},_unsetDataColor:function(){this._modelEvents.publish({event:"xmodel-list-set-column-visibility-action",data:{dataIndex:"color",visibility:!1}}),this._model.prepareUpdate(),this._model.search({match:function(e){return!!e.nodeModel.options.id&&(e.nodeModel.updateOptions({color:""}),e.nodeModel.setAttribute("color","#ffffff00"),!0)}}),this._model.pushUpdate()},_filterTagger:function(e){this._taggerComponent.getTagProxy(this._taggerId)&&this._taggerComponent.filterTags(this._taggerId,e)},_focusOnSubjects:function(e){this._taggerComponent.getTagProxy(this._taggerId)&&this._taggerComponent.focusOnSubjects(this._taggerId,e)},_unfocus:function(){this._taggerComponent.unfocus(this._taggerId)},_activateTagger:function(){this._taggerComponent.getTagProxy(this._taggerId)&&this._taggerComponent.activate(this._taggerId)},_deactivateTagger:function(){this._taggerComponent.deactivate(this._taggerId)},destroy:function(){this._taggerComponent.killTagProxy(this._taggerId)}})}),define("DS/ENOXModelListView/ModelListView/js/ModelListView",["UWA/Core","DS/ENOXModelListView/ModelListView/js/ModelListViewCollectionToolBar","DS/ENOXModelListView/ModelListView/js/ModelListViewEmptyContent","DS/DataGridView/DataGridView","DS/ENOXDataDragAndDrop/js/ENOXDataDragAndDrop","DS/CollectionView/ResponsiveTilesCollectionView","DS/CollectionView/ResponsiveThumbnailsCollectionView","DS/CollectionView/ResponsiveLargeTilesCollectionView","DS/UIKIT/Mask","DS/Utilities/Dom","DS/Menu/ContextualMenu","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents","DS/Tree/TreeDocument","DS/Controls/ProgressBar","DS/ENOXModelListView/ModelListView/js/ModelListViewDataExtension","DS/ENOXModelListView/ModelListView/js/ModelListViewTaggerExtension","DS/Controls/ResponsiveThumbnailView","i18n!DS/ENOXModelListView/assets/nls/ModelListView","css!ENOXModelListView/ModelListView/css/ModelListView.css"],function(e,t,i,o,n,s,l,a,d,r,c,u,h,p,_,m,v,f,g,b){"use strict";var w=function(t){this.MOBILE_BREAKPOINT=550,this._withToolBar=void 0===t.withToolBar||t.withToolBar,this._withProgressBar=void 0!==t.withProgressBar&&t.withProgressBar,this._initDivs(),t.viewOptions||(t.viewOptions={}),t.model||(t.model=new p({})),this._model=t.model,this._options=t,this._id=t.id||"ViewId",this._useAsyncExpand=1==t.useAsyncExpand,this._model.options.useAsyncPreExpand=this._useAsyncExpand,this._groupedRows=[],this._modelEvents=t.modelEvents,this.useDragAndDrop=t.useDragAndDrop||!1;var i=t.extensions||[];if(this._initExtensions_v1(i),this._withToolBar&&this._initToolBar(this._model,t),this._initListView(t.viewOptions),null!=t.emptyContentOptions&&this._initEmptyContent(this._model,t),this._subscribeEvents(),this._currentSelectedObjects=[],widget&&e.is(widget,"object")){var o=this;widget.addEvent("onSearch",function(e){o._modelEvents.publish({event:"xmodel-list-dashboard-search-action",data:e})}),widget.addEvent("onResetSearch",function(){o._modelEvents.publish({event:"xmodel-list-dashboard-search-action",data:""})}),widget.addEvent("onViewChange",function(){o.updateTagFocus()})}};return w.prototype._subscribeEvents=function(){var t=this;this._modelEvents.subscribe({event:"xmodel-list-add-columns"},function(e){if(e&&e.length>0){var i=t._contentViews.DataGridView;i?(i.prepareUpdateView(),e.forEach(function(e){var t=i.columns.length>0?i.columns.length-1:void 0;i.addColumnOrGroup(e,t)}),i.pushUpdateView()):console.log("Warning, DGV instance does not exists!")}}),this._modelEvents.subscribe({event:"xmodel-list-update-progress-bar"},function(e){t._progressBar&&void 0!==e&&(t._progressBar.value=e,e>=100&&setTimeout(function(){t._progressBarContainer.classList.add("displaynone")},200))}),this._modelEvents.subscribe({event:"xmodel-list-show-progress-bar"},function(e){t._progressBarContainer.classList.contains("displaynone")&&t._progressBarContainer.classList.remove("displaynone")}),this._modelEvents.subscribe({event:"xmodel-list-hide-progress-bar"},function(e){!1===t._progressBarContainer.classList.contains("displaynone")&&t._progressBarContainer.classList.add("displaynone")}),this._modelEvents.subscribe({event:"enox-collection-toolbar-switch-view-activated"},function(e){t._viewIdToolbar=e,t._groupedRows.length>0?(t._modelEvents.publish({event:"xmodel-list-view-group-by-action",data:[]}),setTimeout(function(){t._switchView(e)},500)):t._switchView(e),t._modelEvents.publish({event:"xmodel-list-toolbar-group-visibility",data:"DataGridView"==e})}),this._model.subscribe({event:"addChild"},function(e){console.log();var i=t._getContextualMenu(e.data.nodeModel);e.data.nodeModel.options.contextualMenu=i,t._onDataUpdate()}),this._model.subscribe({event:"removeChild"},function(e){console.log(),t._onDataUpdate()}),this._model.subscribe({event:"title-link-action"},function(){this.nodeModel.options.id&&t._modelEvents.publish({event:"xmodel-list-title-link-click",data:{model:this.nodeModel.options.grid},context:this.nodeModel})}),this._modelEvents.subscribe({event:"xmodel-list-view-group-by-action"},function(e){e||(e=[]);var i=t._contentViews.DataGridView;i&&(t._groupedRows=e,i.groupRows({dataIndexesToGroup:e}),i.invalidateLayout({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1}),t._modelEvents.publish({event:"xmodel-list-data-set-filter-node-level",data:t._groupedRows.length}))}),this._modelEvents.subscribe({event:"xmodel-list-view-update-grouping-action"},function(i){if(t._contentViews.DataGridView&&i){var o=t._groupedRows;e.is(o,"array")&&o.length>0&&"function"==typeof groupRoots&&i.groupRoots({propertiesToGroup:o}),t._modelEvents.publish({event:"xmodel-list-data-set-filter-node-level",data:t._groupedRows.length})}}),this._modelEvents.subscribe({event:"xmodel-list-view-expand-all-action"},function(){t._model.prepareUpdate(),t._model.expandAll(),t._model.pushUpdate()}),this._modelEvents.subscribe({event:"xmodel-list-view-collapse-all-action"},function(){t._model.prepareUpdate(),t._model.collapseAll(),t._model.pushUpdate()}),this._modelEvents.subscribe({event:"xmodel-list-view-disble-menu"},function(e){console.log(),t._model.search({match:function(t){return-1!=e.indexOf(t.nodeModel.options.id)&&(t.nodeModel.prepareUpdate(),t.nodeModel.options.disableMenu=!0,t.nodeModel.pushUpdate(),!0)}});var i=t._contentViews.DataGridView;i&&i.invalidateLayout({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1})}),this._modelEvents.subscribe({event:"xmodel-list-data-on-load-start"},function(){t._container&&(d.mask(t._container),t._isLoading=!0)}),this._modelEvents.subscribe({event:"xmodel-list-data-on-load-complete"},function(){t._container&&d.isMasked(t._container)&&(d.unmask(t._container),t._isLoading=!1,"ThumbnailView"==t._currentView&&t._contentViews.ThumbnailView&&(t._container.offsetWidth<t.MOBILE_BREAKPOINT?t._contentViews.ThumbnailView.displayedOptionalCellProperties=["contextualMenu"]:t._contentViews.ThumbnailView.displayedOptionalCellProperties=["contextualMenu","description","propertiesList"],t._contentViews.ThumbnailView.invalidateLayout({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1})))}),this._modelEvents.subscribe({event:"xmodel-list-context-search-action"},function(e){var i={id:"ContextSearch",content:{value:e}};t._modelEvents.publish({event:"xmodel-list-data-search-action",data:i})}),this._modelEvents.subscribe({event:"xmodel-list-dashboard-search-action"},function(e){var i={id:"GlobalSearch",content:{value:e}};t._modelEvents.publish({event:"xmodel-list-data-search-action",data:i})}),this._modelEvents.subscribe({event:"xmodel-list-data-sort-action"},function(e){var i=t._contentViews.DataGridView;i&&(i.sortModel&&1==i.sortModel.length&&i.sortModel[0].dataIndex===e.dataIndex&&i.sortModel[0].sort==e.sort?i.reapplySortModel():i.sortModel=[e])}),this._modelEvents.subscribe({event:"xmodel-list-set-column-visibility-action"},function(e){var i=t._contentViews.DataGridView;i&&i.layout.setColumnVisibleFlag(e.dataIndex,e.visibility)}),this._model.getXSO().onAdd(function(e){e.options&&e.options.id&&(t._modelEvents.publish({event:"xmodel-list-item-on-add-selection",data:{model:e.options.grid,items:t._model.getXSO().get()},context:e}),t._currentSelectedObjects=t._model.getXSO().get(),t.updateTagFocus())}),this._model.getXSO().onRemove(function(e){t._isLoading||(e.options&&e.options.id&&(t._modelEvents.publish({event:"xmodel-list-item-on-remove-selection",data:{model:e.options.grid,items:t._model.getXSO().get()},context:e}),t._currentSelectedObjects=t._model.getXSO().get(),t._model.getSelectedNodes()&&0==t._model.getSelectedNodes().length&&(t._currentSelectedObjects=[],console.log("empty selection"),t._modelEvents.publish({event:"xmodel-list-item-on-empty-selection"}))),t.updateTagFocus())}),this._modelEvents.subscribe({event:"xmodel-list-unselect-all"},function(){t._model.unselectAll()}),this._modelEvents.subscribe({event:"xmodel-list-select-all"},function(){t._model.selectAll()}),this._modelEvents.subscribe({event:"xmodel-list-enable-contextual-menu"},function(e){t._contextualMenuEnabled=e}),this._modelEvents.subscribe({event:"xmodel-list-select-all-root-nodes"},function(e){var i=t._model.getRoots();i&&i.forEach(function(e,t){e.select()})}),this._modelEvents.subscribe({event:"xmodel-list-selection-action"},function(e){t._model.search({match:function(t){return-1!=e.indexOf(t.nodeModel.options.id)&&(t.nodeModel.select(),!0)}})}),this._modelEvents.subscribe({event:"xmodel-list-item-get-selection"},function(i){e.is(i,"function")&&i(t._model.getXSO().get().map(function(e){return e.options.grid})||[])}),this._modelEvents.subscribe({event:"xmodel-list-data-on-update"},function(){t._onDataUpdate()}),this._modelEvents.subscribe({event:"xmodel-list-reset-sort-model"},function(){t._contentViews.DataGridView&&(t._contentViews.DataGridView.sortModel=null)}),this._modelEvents.subscribe({event:"xmodel-list-scroll-to-node"},function(e){t._contentViews.DataGridView&&t._contentViews.DataGridView.ensureNodeModelVisible(e,!0)}),this._model.onPreExpand(function(e){t._modelEvents.publish({event:"xmodel-list-view-on-expand",data:{model:e.data.nodeModel.options.grid,nodeInfo:e.data},context:e.data.nodeModel})})},w.prototype._initEmptyContent=function(e,t){this._emptyContainer=document.createElement("div"),this._emptyContainer.classList.add("mdllv-empty-container"),this._withToolBar||this._emptyContainer.classList.add("no-toolbar"),this._emptyContainer.classList.add("displaynone"),this._ModelListViewEmptyContent=new i(e,t,this._modelEvents,this._emptyContainer);var o=this;this._modelEvents.subscribe({event:"xmodel-list-is-empty"},function(e){e?o._listContainer.classList.add("displaynone"):o._listContainer.classList.remove("displaynone")}),this._container.appendChild(this._emptyContainer)},w.prototype._initDivs=function(){this._container=e.createElement("div"),this._container.classList.add("xmodel-list-view"),this._collectionToolBarContainer=document.createElement("div"),this._collectionToolBarContainer.classList.add("xmdllv-collectiontoolbar-container"),this._listContainer=document.createElement("div"),this._listContainer.classList.add("xmdllv-list-container"),this._withToolBar||(this._listContainer.classList.add("no-toolbar"),this._collectionToolBarContainer.classList.add("no-toolbar")),this._container.appendChild(this._collectionToolBarContainer),this._withProgressBar&&(this._progressBarContainer=document.createElement("div"),this._progressBarContainer.classList.add("xmdllv-list-progress-bar-container"),this._progressBar=new _({displayStyle:"lite",value:10}).inject(this._progressBarContainer),this._progressBar.addEventListener("change",function(e){e.stopPropagation()}),this._container.appendChild(this._progressBarContainer)),this._container.appendChild(this._listContainer)},w.prototype._initToolBar=function(e,i){this._collectionToolBar=new t(e,i,this._modelEvents),this._collectionToolBar.inject(this._collectionToolBarContainer)},w.prototype.attachResizeSensor=function(){this._collectionToolBar&&this._collectionToolBar.attachResizeSensor()},w.prototype._setDragData=function(e,t){for(var i=[],o=0;o<t.length;o++){var n=t[o],s=n?n.options.grid:{id:"",type:"",modelID:""},l={envId:widget.getValue("x3dPlatformId"),serviceId:"3DSpace",contextId:"",objectId:s.id,objectType:s.type.trim()||"",objectName:s.name||"",displayType:s.type.trim()||"",displayName:s.title};i.push(l)}var a={protocol:"3DXContent",version:"1.1",source:widget.getValue("appId"),widget_id:widget.id,data:{items:i}};e.dataTransfer.setData("Text",JSON.stringify(a)),e.dataTransfer.effectAllowed="all"},w.prototype._getPreferedView=function(e){if(e||(e=this._views),this._viewIdToolbar)return this._viewIdToolbar;if(this._viewIdOption&&e.indexOf(this._viewIdOption)>=0)return this._viewIdOption;if(widget){var t=e[0];return 0!=this._container.offsetWidth&&this._container.offsetWidth<this.MOBILE_BREAKPOINT?t="TileView":widget.body.offsetWidth<this.MOBILE_BREAKPOINT&&(t="TileView"),t}},w.prototype._initListView=function(t){this._views=t.views||["DataGridView"],this._viewIdOption=t.currentView;var i=this._getPreferedView();this._currentView=t.currentView?t.currentView:i,this._expandLabel=t.expandLabel,this._collapseLabel=t.collapseLabel,!1===e.is(t.onDelayedModelDataRequest,"function")&&(t.onDelayedModelDataRequest=void 0),this._contentViews={};var n={height:"inherit",displayedOptionalCellProperties:["contextualMenu","description","propertiesList"],allowUnsafeHTMLContent:!1,model:this._model,onDelayedModelDataRequest:t.onDelayedModelDataRequest},d=this,r={callback:function(e){var t=e.menu?e.menu:[],i=e.cellInfos.nodeModel;if(d._contentViews[d._currentView]&&d._contentViews[d._currentView].activeNode){var o=d._contentViews[d._currentView].activeNode;i!=o&&(i=o,t=d._getContextualMenu(o))}if(i&&null==i.getChildren())return t;if(i){for(var n=i.getTreeDocument(),s=!0,l=0;l<t.length&&s;)"expand"===t[l].id&&(s=!1),l++;if(s){var a=function(e){for(var t=0;t<e.length;t++)if("SeparatorItem"===e[t].type)return t++}(t);t.splice(a,0,{type:"SeparatorItem"}),t.splice(a+1,0,{id:"expand",type:"PushItem",icon:"flow-tree-expand-down",title:d._expandLabel?d._expandLabel:g._expand_content,action:{callback:function(e){void 0!==n&&i.expandAll()}},state:i.isExpanded()?"disabled":"enabled"}),t.splice(a+2,0,{id:"collapse",type:"PushItem",icon:"flow-tree-expand-up",title:d._collapseLabel?d._collapseLabel:g._collapse_content,action:{callback:function(e){void 0!==n&&i.collapseAll()}},state:i.isExpanded()?"enabled":"disabled"})}}return t}},c={label:"label",subLabel:"subLabel",description:"description",customTooltip:"customTooltip",icon:"icon"};e.extend(c,t.itemViewMapping||{});var h={getLabel:function(t){return e.is(c.label,"function")?c.label.call(this,t):t.options.grid[c.label]},getSubLabel:function(t){return e.is(c.subLabel,"function")?c.subLabel.call(this,t):t.options.grid[c.subLabel]},getDescription:function(t){return e.is(c.description,"function")?c.description.call(this,t):t.options.grid[c.description]},getCustomTooltip:function(t){return e.is(c.customTooltip,"function")?c.customTooltip.call(this,t):t.options.grid[c.label]},getIcon:function(t){return e.is(c.icon,"function")?c.icon.call(this,t):t.options.grid.image?t.options.grid.image:""}},p={_preBuild:function(){this._parent(),this._properties.layout.value.columnMaxWidth={0:192,420:240}}};e.merge(p,h);var _=function(e){e.cellView.getContent().setAttribute("node-depth",e.nodeModel.getNodeDepth())};this._views.forEach(function(i){if("DataGridView"===i){var c={onDelayedModelDataRequest:t.onDelayedModelDataRequest,identifier:t.identifier?t.identifier:d._options.id?d._options.id:void 0,treeDocument:d._model,_useClipboardFlag:!0,cellSelection:"none",defaultColumnDef:{width:"auto",typeRepresentation:"string",groupableFlag:!1,editionPolicy:"EditionOnClick"},layoutOptions:t.layoutOptions?t.layoutOptions:{},onContextualEvent:e.is(t.onContextualEvent,"function")?t.onContextualEvent:function(e){var t=[];if(0==d._contextualMenuEnabled)return[];if(e&&e.collectionView&&e.cellInfos){e.collectionView.columns.length;var i=e.cellInfos.columnID,o=e.cellInfos.rowID;0!=i&&1!=i&&-1===o?t=e.collectionView.buildDefaultContextualMenu(e,{pin:!0,firstColumnsVisibility:!0,columnsManagement:!0,sizeColumnToFit:!1}):o>-1&&e.cellInfos.nodeModel&&(t=d._getContextualMenu(e.cellInfos.nodeModel))}return t},rowDragEnabledFlag:d.useDragAndDrop,columnDragEnabledFlag:!1,cellDragEnabledFlag:!0,onDragStartRowHeader:function(e,t){var i=this.getTreeDocument()?this.getTreeDocument().getSelectedNodes():[],o=i&&i.length>0?i:[t.nodeModel];d._setDragData(e,o)}},m=t.grid;if(m.columns){for(var v=0,f=m.columns.length;v<f;v++){var b=m.columns[v];b&&"tree"===b.dataIndex&&(b.alwaysVisibleFlag=!0,null!=b.sortableFlag&&!1===b.sortableFlag&&(b.sortableFlag=!0),b.minWidth=150),b&&"titleTweaker"===b.typeRepresentation&&(b.getCellValue||(b.getCellValue=function(e){return e.nodeModel.options.label}),b.setCellValue||(b.setCellValue=function(e,t){e.nodeModel.setLabel(t)}))}t.contextualActions&&(m.columns.unshift({text:g._color,dataIndex:"color",typeRepresentation:"color",pinned:"left",width:"50",visibleFlag:!1}),m.columns.push({text:g._action,dataIndex:"contextualMenu",pinned:"right",width:55,resizableFlag:!1,allowUnsafeHTMLContent:!0,alwaysVisibleFlag:!0,sortableFlag:!1,groupableFlag:!1,typeRepresentation:"contextualMenuType",getCellValue:function(e){var i={menu:[],disabled:void 0!==t.disabledContextualActions&&t.disabledContextualActions},o=d._getContextualMenu(e.nodeModel);return o&&o.length>0&&(i.menu=o),e.nodeModel&&1==e.nodeModel.options.disableMenu&&(i.disabled=!0),i}}))}e.extend(c,m),d._contentViews[i]=new o(c);var w={contextualMenuType:{stdTemplate:"contextualMenuTemplate",semantics:{}},titleTweaker:{stdTemplate:"titleEditorTemplate",semantics:{}}};if(m.typeRepresentations&&e.is(m.typeRepresentations,"object")&&e.merge(w,m.typeRepresentations),d._typeRepresentationFactory=d._contentViews[i].getTypeRepresentationFactory(),d._typeRepresentationFactory.registerTypeTemplates({contextualMenuTemplate:{path:"DS/ENOXModelListView/ModelListView/js/ContextualMenuTweaker"},titleEditorTemplate:{path:"DS/ENOXModelListView/ModelListView/js/TitleTweaker"}}),d._typeRepresentationFactory.registerTypeRepresentations(w),t.editable){["postEdit"].forEach(function(e){d._contentViews[i].addEventListener(e,function(e,t){if(e.dsModel&&e.dsModel.layout&&t&&t.nodeModel&&t.nodeModel.options&&t.nodeModel.options.grid){var i=[t.nodeModel.options.grid],o=e.dsModel.layout.getDataIndexFromColumnIndex(t.columnID);"description"===(o=o&&"tree"===o?"title":o)&&null!=t.nodeModel.options.description&&(i[0].description=t.nodeModel.options.description),null!=o&&""!==o&&"basePrice"!==o&&d._modelEvents.publish({event:"list-view-update-inline-action",data:{model:i,name:o,value:t.cellModel,cell:t}})}})})}d._contentViews[i]._applySortModelOrig=d._contentViews[i]._applySortModel,d._contentViews[i]._applySortModel=function(e){if(this._applySortModelOrig(e),!0===this._isCurrentlyCalledFromUIInteraction()){var t=this.sortModel&&this.sortModel.length>0?this.sortModel[0]:void 0;if(t){var i={sortOrder:t.sort?t.sort.toUpperCase():void 0,sortAttribute:t.dataIndex?t.dataIndex:void 0};d._modelEvents.publish({event:"enox-collection-toolbar-sort-activated",data:i})}}}}else"TileView"===i?(d._contentViews[i]=new(s.inherit(h))(n),d._contentViews[i].onContextualEvent=e.is(t.onContextualEvent,"function")?t.onContextualEvent:r,d._contentViews[i].onPostCellRequest(_)):"ThumbnailView"===i?(d._contentViews[i]=new(l.inherit(p))(n),d._contentViews[i].onContextualEvent=e.is(t.onContextualEvent,"function")?t.onContextualEvent:r,d._contentViews[i].onPostCellRequest(_)):"LargeThumbnailView"===i&&(d._contentViews[i]=new(a.inherit(h))(n),d._contentViews[i].onContextualEvent=e.is(t.onContextualEvent,"function")?t.onContextualEvent:r,d._contentViews[i].onPostCellRequest(_));d.useDragAndDrop&&(d._contentViews[i].useDragAndDrop=d.useDragAndDrop,d._contentViews[i].onDragStartCell=function(e,t){var i=this.getTreeDocument().getSelectedNodes()?this.getTreeDocument().getSelectedNodes():[],o=i&&i.length>0?i:t.nodeModel;d._setDragData(e,o),d._appendShadowTile(e,i,t)},d._contentViews[i].onDragEnterBlankDefault=function(e){},d._contentViews[i].onDragEnterBlank=function(e){},d._contentViews[i].onDragEndCell=function(e,t){d._removeShadowTile()}),d._contentViews[i].addEventListener(u.POINTERHIT,function(e,t){if(t&&t.nodeModel&&t.nodeModel.options.id&&2==e.multipleHitCount){console.log("xmodel-list-item-on-dblclickPOINTERHIT");var i="";e&&e.dsModel&&e.dsModel.layout&&e.dsModel.layout.getDataIndexFromColumnIndex&&(i=e.dsModel.layout.getDataIndexFromColumnIndex(t.columnID)),"basePrice"!==i&&d._modelEvents.publish({event:"xmodel-list-item-on-dblclick",data:{model:t.nodeModel.options.grid},context:t.nodeModel})}}),d._contentViews[i].addEventListener("click",function(e,t){if(t&&t.nodeModel&&t.nodeModel.options.id){console.log("xmodel-list-item-on-click");var i=e.target.getAttribute("href");if(null!=i&&null!=i){var o=e.dsModel.layout.getDataIndexFromColumnIndex(t.columnID);d._modelEvents.publish({event:"xmodel-list-item-on-link-click",data:{model:t.nodeModel.options.grid,linkId:o||i}})}else d._modelEvents.publish({event:"xmodel-list-item-on-click",data:{model:t.nodeModel.options.grid,event:e},context:t.nodeModel})}})}),this._switchView(this._currentView,!0)},w.prototype._appendShadowTile=function(t,i,o){if(this._img=new f({picture:o.nodeModel.getAttributeValue("image"),icon:o.nodeModel.getAttributeValue("image"),title:o.nodeModel.getAttributeValue("title")+" "+o.nodeModel.getAttributeValue("revision"),multipleTitleLineNumber:!1,subtitle:"Modification Date: "+o.nodeModel.getAttributeValue("modified"),description:o.nodeModel.getAttributeValue("description")}),this._img.elements.container.addClassName("xmodel-shadow-img"),this._img.inject(document.body),i.length>=2){var n=e.createElement("div",{class:"xmodel-badge"});e.createElement("div",{class:"numberCircle",text:i.length}).inject(n),n.inject(this._img.elements.picture)}t.dataTransfer.setDragImage(this._img.getContent(),0,0)},w.prototype._removeShadowTile=function(){this._img.getContent().destroy()},w.prototype._getSelectedItem=function(){return this._model.getXSO().get().map(function(e){return e.options.grid})},w.prototype._switchView=function(t,i){var o=this._contentViews[t];o&&(this._currentView=t,e.extendElement(this._listContainer).setContent(o.getContent()),"DataGridView"!=this._currentView?this._modelEvents.publish({event:"xmodel-list-toolbar-group-visibility",data:!1}):this._modelEvents.publish({event:"xmodel-list-toolbar-group-visibility",data:!0})),i&&this._modelEvents.publish({event:"xmodel-list-toolbar-update-switch-view",data:t})},w.prototype.inject=function(e){e.appendChild(this._container);var t=this;r.addResizeListener(this._container,function(){if(t._container.offsetWidth){var e=t._getPreferedView();"ThumbnailView"==e&&t._contentViews.ThumbnailView&&(t._container.offsetWidth<t.MOBILE_BREAKPOINT?t._contentViews.ThumbnailView.displayedOptionalCellProperties=["contextualMenu"]:t._contentViews.ThumbnailView.displayedOptionalCellProperties=["contextualMenu","description","propertiesList"],t._contentViews.ThumbnailView.invalidateLayout({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1})),e!=t._currentView&&(t._groupedRows.length>0?(t._modelEvents.publish({event:"xmodel-list-view-group-by-action",data:[]}),setTimeout(function(){t._switchView(e)},500)):t._switchView(e,!0))}}),this.attachResizeSensor()},w.prototype.getTypeRepresentationFactory=function(e){return this._typeRepresentationFactory},w.prototype._initExtensions_v1=function(t){var i={id:this._id,model:this._model,modelEvents:this._modelEvents,useAsyncExpand:this._useAsyncExpand,keepSelectionOnHide:!(!this._options.toolbarOptions||!this._options.toolbarOptions.keepSelectionOnHide)&&this._options.toolbarOptions.keepSelectionOnHide,childKeys:this._options.childKeys?this._options.childKeys:[],defaultNodeDepth:this._options.defaultNodeDepth?this._options.defaultNodeDepth:void 0},o=this;o._extensions=[];var n=[],s=[];t&&t instanceof Array&&t.length>0&&t.forEach(function(t){switch(e.typeOf(t)){case"string":n.push(new e.Promise(function(e,i){require([t],function(t){e(t)},function(e){i("Error loading modules."+(e&&e.requireModules?e:""))})}));break;case"class":s.push(t)}}),console.log("[ModelListView:_initExtensions_v1] No. of Extension to initialize: "+s.length+" to resolve:  "+n.length),s.forEach(function(e){var t=new e;t.initialize(i),o._extensions.push(t)}),n.length>0&&e.Promise.all(n).then(function(e){e.forEach(function(e){var t=new e;o._extensions.push(t)}),o._extensions.forEach(function(e){e.initialize(i)})})},w.prototype._initExtensions=function(t){var i={id:this._id,model:this._model,modelEvents:this._modelEvents},o=this;o._extensions=[],function(t){var i=t.map(function(t){switch(e.typeOf(t)){case"string":return new e.Promise(function(e,i){require([t],function(t){e(t)},function(e){i("Error loading modules."+(e&&e.requireModules?e:""))})});case"class":return e.Promise.resolve(t)}});return e.Promise.all(i)}(t).then(function(e){e.forEach(function(e){var t=new e;o._extensions.push(t)}),o._extensions.forEach(function(e){e.initialize(i)})})},w.prototype.addExtension=function(e){},w.prototype.filter=function(e){if(e.id){this._filters[e.id]=e.content||{};var t=e.content;if(t.ids){this._model.prepareUpdate();this._model.search({match:function(e){return-1!=t.ids.indexOf(e.nodeModel.options.id)?(e.nodeModel.matchSearch(),!0):(e.nodeModel.unmatchSearch(),!1)}});this._model.pushUpdate()}}},w.prototype._onDataUpdate=function(){if(0==this._groupedRows.length){var e=0,t=this._model.getChildren();if(t)e=t.filter(function(e){return e.isVisible()}).length;this._modelEvents.publish({event:"enox-collection-toolbar-items-count-update",data:e})}},w.prototype._getContextualMenu=function(t){var i=[],o=function(i,n){var s={id:n.id,type:n.type?n.type:"PushItem",title:n.title?n.title:n.text,state:n.state?n.state:"enabled"};if(1==t.options.disableMenu&&(s.state="disabled"),n.handler&&(s.action={callback:function(i,o){e.is(n.handler,"function")&&n.handler.call(t,t.options.grid)}}),n.fonticon&&(s.icon=n.fonticon),n.content){var l=n.content;s.submenu=[];l.reduce(o,s.submenu)}return i.push(s),i};if(this._options.viewOptions.contextualActions&&t&&t.options.id){var n=this._options.viewOptions.contextualActions;e.is(this._options.viewOptions.contextualActions,"function")&&(n=this._options.viewOptions.contextualActions.call(t)),i=n.reduce(o,[])}return i},w.prototype.destroy=function(e){this._extensions.forEach(function(e){e.destroy()})},w.prototype.isGrouped=function(e){return this._groupedRows&&this._groupedRows.length>0},w.prototype.updateTagFocus=function(){var e=this._model.getXSO().get();widget&&"maximized"!==widget.getView().type||0==e.length?this._modelEvents.publish({event:"xmodel-list-tagger-unfocus-action"}):widget&&"maximized"===widget.getView().type&&e&&e.length>0&&this._modelEvents.publish({event:"xmodel-list-tagger-focus-action",data:e})},w.prototype.refresh=function(e){var t=this._contentViews.DataGridView;t&&t.invalidateLayout({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1})},w});