define("DS/ENOXDocumentControlUI/DocumentCommandEvents",["UWA/Core","DS/ENOXDocumentControlUI/DocEnhancers/Services/WebServices","DS/ENOXDocumentControlUI/DocEnhancers/Constants/Constants","DS/ENOXDocumentControlUI/DocEnhancers/Services/SettingsManagement"],function(e,t,n,o){"use strict";return e.Class.extend({connect:function(n){widget.app.events.addSingletonEventListener("welcome-panel-upload-action-clicked","doco-welcome-panel-perform-action",function(e){"NewDocument"==e.id&&n.privateDocumentCommands.commands.CreateNew.execute({})}),widget.app.events.addSingletonEventListener("centerPane-files-dropped","upload-files-on-drop",function(e){n.privateDocumentCommands.commands.CreateNew.execute(e)}),widget.app.events.addSingletonEventListener("open-preview-token","enox-doco-show-preview",function(e){n.privateDocumentCommands.commands.Preview.execute()}),widget.app.events.addSingletonEventListener("update-info-icon-on-right-panel-hidden","triptych-panel-hidden",function(e){"right"==e&&n.selectionChanged()}),widget.app.events.addSingletonEventListener("update-info-icon-on-right-panel-shown","triptych-panel-visible-size",function(e){"right"==e.side&&n.selectionChanged()}),widget.app.events.addSingletonEventListener("doc-cmd-evts-show-notification","docv2-show-notification",function(e){widget.app.showNotification(e.level,e.title,e.subtitle,e.message,e.sticky,e.allowUnsafeHTML)}),widget.app.events.addSingletonEventListener("doc-cmd-evts-delete-complete","docv2-delete-complete",function(e){e.nodeModel.getTreeDocument().removeRoot(e.nodeModel)}),widget.app.events.addSingletonEventListener("doc-cmd-evts-update-complete","docv2-update-complete",function(e){widget.app.events.publish({event:"docv2-reload-nodeModels",data:{nodeModels:[e.nodeModel],reloadPreviewToolbar:!0,reloadPreviewViewer:!0}})}),widget.app.events.addSingletonEventListener("doc-cmd-evts-edit-complete","docv2-edit-complete",function(e){widget.app.events.publish({event:"docv2-reload-nodeModels",data:{nodeModels:[e.nodeModel],reloadPreviewToolbar:!0,reloadPreviewViewer:!1}})}),widget.app.events.addSingletonEventListener("doc-cmd-evts-favorite-toggled","docv2-favorite-toggled",function(e){n.selectionChanged()}),widget.app.events.addSingletonEventListener("doc-cmd-evts-undoedit-complete","docv2-undoedit-complete",function(e){widget.app.events.publish({event:"docv2-reload-nodeModels",data:{nodeModels:[e.nodeModel],reloadPreviewToolbar:!0,reloadPreviewViewer:!1}})}),widget.app.events.addSingletonEventListener("doc-cmd-evts-maturity-complete","docv2-maturity-complete",function(e){var n={onComplete:function(t){var n={},o=[],i=[];t.data.policies[0].maturityGraph.states.forEach(function(e){o.push(e.stateSysName),i.push(e.stateUserName)});var a=o.indexOf(t.data.objects[0].current);if(n.userName=i[a],n.sysName=o[a],e.nodeModel.prepareUpdate(),e.nodeModel.options.data.current=n.userName,e.nodeModel.options.data.stateclass="doc-state doc-state-"+n.sysName.replace(/[^A-Z0-9]/gi,"").toLowerCase(),e.nodeModel.options.data.subtitle){var r=e.nodeModel.options.data.subtitle.getElement(".doc-state");r&&(r.className=e.nodeModel.options.data.stateclass,r.setText(n.userName))}e.nodeModel.setAttribute("current",n.userName),e.nodeModel.pushUpdate()},onFailure:function(e){console.log("Issue while getting Maturity State. :"+e)}};t.getAllMaturityStates(e.nodeModel.options.data.id,n)}),widget.app.events.addSingletonEventListener("doc-cmd-evts-reload-nodeModels","docv2-reload-nodeModels",function(e){widget.app.collection.reload(e.nodeModels,function(){n.selectionChanged(),e.reloadPreviewToolbar&&widget.app.events.publish({event:"docv2-preview-reload-toolbar",data:{nodeModel:e.nodeModels[0]}}),e.reloadPreviewViewer&&widget.app.events.publish({event:"docv2-preview-reload-viewer",data:{nodeModel:e.nodeModels[0]}})})}),require(["DS/PlatformAPI/PlatformAPI","DS/DocumentManagement/DocumentManagement"],function(t,o){widget.enoRefreshToken&&t.unsubscribe(widget.enoRefreshToken),widget.enoRefreshToken=t.subscribe("DS/ENO/refresh",function(t){if(t.data&&t.data.authored){if(e.is(t.data.authored.modified,"array")&&t.data.authored.modified.length>0){var o=[],i=[];widget.app.collection.treeDocument.getRoots().forEach(e=>{t.data.authored.modified.includes(e.options.data.id)&&(o.push(e.options.data.id),i.push(e))}),i.length>0&&widget.app.collection.reload(i,function(){n.selectionChanged()})}e.is(t.data.authored.deleted,"array")&&t.data.authored.deleted.length>0&&widget.app.collection.treeDocument.getRoots().forEach(e=>{t.data.authored.deleted.includes(e.options.data.id)&&setTimeout(()=>{e.remove()},1)})}}),widget.lifeCycleModificationToken&&t.unsubscribe(widget.lifeCycleModificationToken),widget.lifeCycleModificationToken=t.subscribe("Lifecycle.Modification",function(t){if((t="string"==typeof t?JSON.parse(t):t,e.Json.isJson(t.OriginID))&&(JSON.parse(t.OriginID).widgetId==widget.id&&"Lifecycle"==t.From&&t.Refresh)){if(t.Refresh.created&&Array.isArray(t.Refresh.created)){var o=[],i=[];t.Refresh.created.forEach(e=>{o.push(e.physicalid),e.sourceObjectId&&i.push(e.sourceObjectId)}),o.length>0&&widget.app.addDocumentsToListByIds(o),i.length>0&&widget.app.collection.reloadByIds(i,function(){n.selectionChanged()})}if(t.Refresh.deleted&&Array.isArray(t.Refresh.deleted)){var a=t.Refresh.deleted.map(function(e){return e.physicalid});a.length>0&&widget.app.collection.treeDocument.getRoots().forEach(e=>{a.includes(e.options.data.id)&&setTimeout(()=>{e.remove()},1)})}}})})}})}),define("DS/ENOXDocumentControlUI/DocumentContextMenu",["UWA/Core","DS/ENOXDocumentControlUI/DocumentCommandsV2","DS/DocumentCommands/DocumentCommandsV2","DS/ENOXDocumentControlUI/DocEnhancers/Services/SettingsManagement"],function(e,t,n,o){"use strict";return e.Class.extend({init:function(i){var a={fetchSecurityContext:function(){return widget.getValue("credentials")},getWorkUnderHeaders:function(){return{}},getSelectedNodes:function(){return widget.app.collection.treeDocument.getSelectedNodes()},getDocumentFromNodeModel:function(e){return e.options.data},getOrigin:function(){return{source:e.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId,widgetId:widget.id,component:"contextmenu"}},platformUrls:o.getPlatformURLs().platformurls,events:widget.app.events,isFromContextMenu:!0,container:i};this.privateDocumentCommands=new t(a);var r=this.privateDocumentCommands.commands;this.publicDocumentCommands=new n(a);var s=this.publicDocumentCommands.commands;r.ShowProperties.dataElements.category=s.Download.dataElements.category,this.rawItems=[r.Preview,s.OfficeWebEdition,s.Edit,s.LockAndDownload,s.UndoEdit,s.Unlock,s.Update,s.UpdateAndUnlock,s.Libraries,s.Maturity,s.Revisions,s.NewRevision,s.Duplicate,s.Compare,s.Share,s.CopyLink,s.Move,s.ChangeOwner,r.ToggleFavorites,s.Download,s.Relations,s.Subscription,r.ShowProperties,s.Delete]},rawItems:[],selectionChanged:function(){this.promise=this.publicDocumentCommands.getWebUXContextMenuItemsForCurrentSelection(this.rawItems,!0)}})}),define("DS/ENOXDocumentControlUI/DocumentToolbar",["UWA/Core","DS/Tweakers/GeneratedToolbar","DS/ENOXDocumentControlUI/DocumentCommandsV2","DS/DocumentCommands/DocumentCommandsV2","DS/ENOXDocumentControlUI/DocEnhancers/Services/WebServices","DS/ENOXDocumentControlUI/DocEnhancers/Services/SettingsManagement","DS/Utilities/Utils"],function(e,t,n,o,i,a,r){"use strict";return e.Class.extend({init:function(i){var s=this;let c,l={entries:[]};var d={fetchSecurityContext:function(){return widget.getValue("credentials")},getWorkUnderHeaders:function(){return{}},getSelectedNodes:function(){return widget.app.collection.treeDocument.getSelectedNodes()},getDocumentFromNodeModel:function(e){return e.options.data},getOrigin:function(){return{source:e.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId,widgetId:widget.id,component:"toolbar"}},platformUrls:a.getPlatformURLs().platformurls,events:widget.app.events,container:i};s.privateDocumentCommands=new n(d);var u=s.privateDocumentCommands.commands;s.publicDocumentCommands=new o(d);var p=s.publicDocumentCommands.commands;l.entries=[u.CreateNew,u.Preview,p.OfficeWebEdition,p.Edit,p.LockAndDownload,p.UndoEdit,p.Unlock,p.Update,p.UpdateAndUnlock,p.Libraries,p.Maturity,p.Revisions,p.NewRevision,p.Duplicate,p.Compare,p.Share,p.CopyLink,p.Move,p.ChangeOwner,u.ToggleFavorites,p.Download,p.Relations,p.Delete,u.SortSwitcher,u.ViewSwitcher,u.ShowProperties,p.Subscription,p.MySubscriptions],c=s.ToolbarTreeDocument=t.prototype.createTreeDocument(l);let m=s.GeneratedToolbar=new t({items:c,direction:"horizontal",overflowManagement:"dropdown",executionContext:{}});return s.privateDocumentCommands.connectToWebUXToolbar(m),s.publicDocumentCommands.connectToWebUXToolbar(m),m.inject(i),s.selectionChanged=r.debounce(function(){s.privateDocumentCommands.selectionChangedForWebUXToolbar(s.GeneratedToolbar),s.publicDocumentCommands.selectionChangedForWebUXToolbar(s.GeneratedToolbar)},10),m},selectionChanged:void 0})}),define("DS/ENOXDocumentControlUI/V2/Views/TileView",["UWA/Core","DS/CollectionView/ResponsiveTilesCollectionView","DS/CollectionView/modelProviders/CollectionViewTreeDocumentModelProvider","i18n!DS/ENOXDocumentControlUI/assets/nls/ENOXDocumentControlUI"],function(e,t,n,o){"use strict";return e.Controls.Abstract.extend({name:"doco-tileview",options:{className:""},_options:{},modelEvents:void 0,init:function(e){this.app=e,this.events=e.events,this._parent({})},build:function(i){var a=this;a.elements.container=e.createElement("div",{class:this.getClassNames()});let r=n.inherit({name:"DocumentTileViewTreeDocumentModelProvider",getPropertyValue:function(e,t){return"subLabel"===t?e.options.subLabel.cloneNode(!0):this._parent(e,t)}});a.rcv=a.app.centerPane.elements.tileView=new t({model:a.app.collection.treeDocument,useDragAndDrop:!0,displayedOptionalCellProperties:["contextualMenu","description","activeFlag"],shouldCellAllowUnsafeHTMLContentAt:function(e,t){return["subtitle","description"].includes(t)},onDragStartCell:function(e,t){this.onDragStartCellDefault(e,t),e.dataTransfer.effectAllowed="copy";var n=a.app.collection.treeDocument.getSelectedNodes();e.dataTransfer.setData("Text",JSON.stringify(a.app.make3DXContent(n)))},displayPropertiesTooltip:!1}).inject(a.elements.container),a.rcv.modelProvider=new r,a.rcv.getContextualMenu=function(e,t,n){return[""]},a.rcv.onContextualEvent={callback:function(e){return e&&e.cellInfos?(a.app.core.detail.contextMenu.selectionChanged(),a.app.core.detail.contextMenu.promise):(e.cellCtxMenuRequired,[])}},a.rcv.onInfiniteScroll(function(e){e.reachBottom&&a.app.events.publish({event:"enox-doco-more-data-needed"})}),a.rcv.onSelectionAdd(function(e,t){a.app.events.publish({event:"enox-doco-node-selection-add",data:e})}),a.rcv.onSelectionRemove(function(e,t){a.app.events.publish({event:"enox-doco-node-selection-remove",data:e})}),a.app.events.subscribe({event:"enox-doco-more-data-loaded"},function(e){a.rcv.infiniteScrollProcessDone()}),a.elements.noObjectsFoundMessageBlock=new e.Element("div",{class:"no-objects-found"}).inject(a.elements.container),new e.Element("div",{text:o.get("NoObjectsFound")}).inject(a.elements.noObjectsFoundMessageBlock),a.app.events.subscribe({event:"enox-doco-collection-count-changed"},function(e){0==e?a.elements.noObjectsFoundMessageBlock.show():a.elements.noObjectsFoundMessageBlock.hide()}),a.inject(i)}})}),define("DS/ENOXDocumentControlUI/V2/Actions/Preview",["UWA/Core","DS/UIKIT/Mask","i18n!DS/ENOXDocumentControlUI/assets/nls/DocEnhancersUI"],function(e,t,n){"use strict";var o=void 0,i=void 0,a=void 0,r=void 0,s=function(e){return{id:"Preview",dataElements:{docV2Private:!0,typeRepresentation:"functionIcon",icon:{iconName:"eye",fontIconFamily:1},label:n.get("ActionOpenPreview"),tooltip:n.get("ActionOpenPreview"),position:"far",category:"view",value:function(t){t.options=e,s.execute(t)},visibleFlag:!1},updateForSelection:function(t,n){t({visibleFlag:1==e.getSelectedNodes().length})},execute:function(){s.execute({options:e})}}};return s.execute=function(e){var n=this,s=e.options.getSelectedNodes()[0];e.options.getDocumentFromNodeModel(s);o&&(e.options.events.unsubscribe(o),o=void 0),o=e.options.events.subscribe({event:"onFavoriteClick"},function(t){require(["DS/ENOXDocumentControlUI/V2/Actions/Favorite"],function(t){(t=new t(e.options)).execute()})}),null!=n.lastNodeModel&&n.lastNodeModel&&n.lastNodeModel.removeEventListener&&n.lastNodeModel.removeEventListener(n.lastNodeModelEventToken),s&&s.addEventListener&&(n.lastNodeModelEventToken=s.addEventListener("nodeModelUpdate",function(t,n,o){widget.previewComponent2.updateDocument(e.options.getDocumentFromNodeModel(s),!1)}),n.lastNodeModel=s),widget.previewComponent2?(widget.previewComponent2.setOptions({platformUrls:e.options.platformUrls,modelEvents:e.options.events,tenant:e.options.platformUrls.platformId,securityContext:e.options.fetchSecurityContext(),nodeModel:s,enableFavoriteToggle:!0}),widget.previewComponent2.updateDocument(e.options.getDocumentFromNodeModel(s),!0)):(t.mask(widget.body),require(["DS/DocumentPreview/PreviewComponent2","DS/ENOXDocumentControlUI/V2/Actions/Favorite"],function(c,l){i&&(e.options.events.unsubscribe(i),i=void 0),i=e.options.events.subscribe({event:"docv2-preview-reload-viewer"},function(t){if(widget.previewComponent2&&1==e.options.getSelectedNodes().length&&null!=t.nodeModel){var n=e.options.getSelectedNodes()[0],o=e.options.getDocumentFromNodeModel(n);e.options.getDocumentFromNodeModel(t.nodeModel).id==o.id&&widget.previewComponent2.updateDocument(o,!0)}}),a&&(e.options.events.unsubscribe(a),a=void 0),a=e.options.events.subscribe({event:"docv2-preview-reload-toolbar"},function(t){if(widget.previewComponent2&&1==e.options.getSelectedNodes().length&&null!=t.nodeModel){var n=e.options.getSelectedNodes()[0],o=e.options.getDocumentFromNodeModel(n);e.options.getDocumentFromNodeModel(t.nodeModel).id==o.id&&widget.previewComponent2.updateDocument(o,!1)}}),r&&(e.options.events.unsubscribe(r),r=void 0),r=e.options.events.subscribe({event:"preview-toolbar-items-prepared"},function(t){var n=new l(e.options);t.dynamicModel.entries.push(n)}),widget.previewComponent2=new c({document:e.options.getDocumentFromNodeModel(s),platformUrls:e.options.platformUrls,modelEvents:e.options.events,tenant:e.options.platformUrls.platformId,securityContext:e.options.fetchSecurityContext(),hideNextPrev:e.options.isOpenFromCopyLink||!1,nodeModel:s,enableFavoriteToggle:!0}),widget.previewComponent2.loaded=function(e){},widget.previewComponent2.elements.container.setStyles({background:"white",width:"100%",height:"100%"}),widget.previewComponent2.close=function(){widget.previewComponent2.destroy(),widget.previewComponent2=void 0,o&&(e.options.events.unsubscribe(o),o=void 0),null!=n.lastNodeModel&&n.lastNodeModel&&n.lastNodeModel.removeEventListener&&n.lastNodeModel.removeEventListener(n.lastNodeModelEventToken)},widget.previewComponent2.inject(widget.body),t.unmask(widget.body)}))},s}),define("DS/ENOXDocumentControlUI/V2/Views/TopBar",["UWA/Core","DS/UIKIT/Iconbar","i18n!DS/ENOXDocumentControlUI/assets/nls/ENOXDocumentControlUI"],function(e,t,n){"use strict";return e.Controls.Abstract.extend({name:"doco2-topbar",options:{className:""},_options:{},modelEvents:void 0,init:function(e){this.app=e,this.events=e.events,this._parent({})},build:function(t){var o=this;o.elements.container=e.createElement("div",{class:this.getClassNames()}),o.elements.activityTitle=e.createElement("div",{class:"current-activity-title",text:n.get(widget.getValue("CurrentActivity"))}).inject(o.elements.container),o.app.core.master.addEvent("onChange:activity",function(e,t){o.elements.activityTitle.setText(n.get(e.get("activity").id))}),o.elements.container.addEvent("resize",function(e,t,n){o.updateTitleVisibility()}),require(["DS/ENOXDocumentControlUI/DocumentToolbar","DS/ENOXDocumentControlUI/DocumentContextMenu","DS/ENOXDocumentControlUI/DocumentCommandEvents","DS/Menu/Menu"],function(e,t,n,i){o.elements.toolbarV2=new e(o.elements.container),(new n).connect(o.elements.toolbarV2),o.app.core.detail.contextMenu=new t(o.elements.container),i.hide(),o.app.events.subscribe({event:"enox-doco-node-selection-add"},function(){o.updateToolbar()}),o.app.events.subscribe({event:"enox-doco-node-selection-remove"},function(){o.updateToolbar()})}),o.inject(t)},updateToolbar:function(){this.elements.toolbarV2.selectionChanged(),this.updateTitleVisibility()},updateTitleVisibility:function(){this.elements.container.clientWidth<640&&this.elements.toolbarV2?(this.elements.activityTitle.show(),this.elements.activityTitle.clientWidth+this.elements.toolbarV2.GeneratedToolbar.elements.farContainer.clientWidth+50>this.elements.container.clientWidth&&this.elements.activityTitle.hide()):this.elements.activityTitle.show()}})}),define("DS/ENOXDocumentControlUI/V2/Tagger",["UWA/Core","DS/TagNavigatorProxy/TagNavigatorProxy"],function(e,t){"use strict";return e.Class.singleton({connect:function(n){this.app=n,this.proxy&&e.is(this.proxy.die,"function")&&this.proxy.die(),this.proxy=t.createProxy({widgetId:widget.id,filteringMode:"FilteringOnServer",tenant:this.app.core.getTenantId()}),widget.addEvent("onSearch",this.onSearch.bind(this)),widget.addEvent("onResetSearch",this.resetSearch.bind(this)),this.proxy.addEvent("onFilterChange",this.filterChange,this),this.activate()},activate:function(){this.proxy.activate()},onSearch:function(e){this.app.core.master.set({searchQuery:e})},resetSearch:function(){this.app.core.master.set({searchQuery:void 0})},filterChange:function(t){e.equals(t.allfilters,this.app.core.master.get("filters"))&&this.setTags(this.lastTags),t&&t.allfilters?this.app.core.master.set({filters:t.allfilters}):this.app.core.master.set({filters:{}})},setTags:function(e){this.lastTags=e,this.proxy.setTags(null,e)}})}),define("DS/ENOXDocumentControlUI/V2/Actions/ViewSwitcher",["UWA/Core","DS/Tweakers/TypeEnums","i18n!DS/ENOXDocumentControlUI/assets/nls/DocEnhancersUI"],function(e,t,n){"use strict";var o=function(e){var o=widget.getValue("userView")||"rowview",i=t.Layout.DataGridView.value;return"rowview"==o?i=t.Layout.DataGridView.value:"smalltile"==o?i=t.Layout.SmallTile.value:"thumbnail"==o&&(i=t.Layout.BigThumbnail.value),{id:"ViewSwitcher",dataElements:{docV2Private:!0,typeRepresentation:"layout",tooltip:n.get("SwitchView"),value:i,possibleValues:[t.Layout.DataGridView,t.Layout.SmallTile,t.Layout.BigThumbnail],position:"far",category:"stable area",visibleFlag:!0,priority:10},updateForSelection:function(e,t){},onNodeUpdate:function(e){var n="",o=e.getAttributeValue("data");o===t.Layout.DataGridView.value?n="rowview":o===t.Layout.SmallTile.value?n="smalltile":o===t.Layout.BigThumbnail.value&&(n="thumbnail"),widget.app.events.publish({event:"enox-doco-switch-view",data:n})},extend:function(e,t){}}};return o.execute=function(e,t){},o}),define("DS/ENOXDocumentControlUI/V2/Actions/CreateNew",["UWA/Core","DS/DocumentCreateNew/CreateNew","i18n!DS/ENOXDocumentControlUI/assets/nls/ENOXDocumentControlUI"],function(e,t,n){"use strict";var o=function(e){return{id:"CreateNew",dataElements:{docV2Private:!0,typeRepresentation:"functionIcon",icon:{iconName:"upload",fontIconFamily:1},label:n.get("NewDocument"),tooltip:n.get("NewDocument"),position:"far",category:"new",value:function(t){t.options=e,o.execute(t)},visibleFlag:!0,priority:9},updateForSelection:function(e,t){},execute:function(t){o.execute({options:e,files:t})}}};return o.execute=function(e){var n=widget.getValue("CurrentActivity"),o=new t({tenant:e.options.platformUrls.platformId,securityContext:e.options.fetchSecurityContext(),tenantUrl:e.options.platformUrls["3DSpace"],immersiveFrame:widget.immersiveFrame,onUploadStart:function(){if(widget.body.clientWidth<=550&&!widget.getElement(".overlay-left").classList.contains("displaynone")){var e=widget.getElement(".triptych-wp-toggle-btn");null!=e&&e.click()}},onCancel:function(){},onError:function(e){},onDocumentUpload:function(t){widget.app.showNotification("success",t.notification.title,t.notification.subtitle),widget.app.addDocumentsToList(t.documents,function(t){"Favorites"==n&&require(["DS/ENOXDocumentControlUI/V2/Actions/Favorite"],function(n){(n=new n(e.options)).execute(t)})})}});e.files&&e.files.length>0?o.create(e.files):o.selectFilesAndCreate()},o}),define("DS/ENOXDocumentControlUI/DocEnhancersUI/Constants/Constants",[],function(){"use strict";return{HIDDEN:"hidden",LIST:"list",WELCOME_PANEL_ACTION_SELECTED_EVENT:"welcome-panel-action-selected",WELCOME_PANEL_SELECTED:"welcome-panel-selected",WELCOME_PANEL_EXPANDED_EVENT:"welcome-panel-expanded",WELCOME_PANEL_COLLAPSED_EVENT:"welcome-panel-collapsed",ACTION_NEW:"action-new",ACTIVITY_SECTION:"activity-section",FONTICON_2X_CLASS:"fonticon-2x",FONTICON_3X_CLASS:"fonticon-3x",SAVED_QUERY:"respRowViewQuey",SAVED_TAGS:"respCollViewTagger",PROVIDER_EV6:"EV6",DTYPE:"DOCUMENTS",ROW_TREE:"tree",SORTING_ACTION:"sortingObject",TAG_OBJ:"-tagObj",APP_ID_MY_PROFILE:"X3DPRFL_AP",TENANT_FIRST_POSITION:"?tenant="}}),define("DS/ENOXDocumentControlUI/V2/Actions/ShowProperties",["UWA/Core","i18n!DS/ENOXDocumentControlUI/assets/nls/ENOXDocumentControlUI"],function(e,t){"use strict";var n=function(e){return{id:"ShowProperties",dataElements:{docV2Private:!0,typeRepresentation:"functionIcon",icon:{iconName:"info",fontIconFamily:1},label:t.get("Information"),tooltip:t.get("Information"),position:"far",category:"stable area",value:function(t){t.options=e,n.execute(t)},visibleFlag:!0,priority:10},updateForSelection:function(e,t){var n=!1;try{n=widget.triptych._isRightOpen}catch(e){console.error("triptych not accessible")}e({icon:{iconName:"info",fontIconFamily:1,className:n?"info-active":""}})}}};return n.execute=function(e,t){var n=this,o=e.options.getSelectedNodes();if(t=t||e.options.isFromContextMenu,widget.propertiesComponent&&widget.triptych._isRightOpen&&!t)widget.propertiesComponent.events.publish({event:"close-document-properties"});else{if(!widget.getValue("DocumentToolbarV2"))widget.body.getElements("[name='ShowProperties']>.fonticon").forEach(e=>{e.addClassName("item-active")});n.nodeModels=o,widget.propertiesComponent?(widget.propertiesComponent.platformUrls=e.options.platformUrls,widget.propertiesComponent.tenant=e.options.platformUrls.platformId,widget.propertiesComponent.securityContext=e.options.fetchSecurityContext(),widget.propertiesComponent.nodeModels=o,widget.propertiesComponent.setSelection(o.map(t=>e.options.getDocumentFromNodeModel(t)))):require(["DS/DocumentPreview/PropertiesComponent"],function(t){widget.propertiesComponent=new t({documents:o.map(t=>e.options.getDocumentFromNodeModel(t)),platformUrls:e.options.platformUrls,tenant:e.options.platformUrls.platformId,securityContext:e.options.fetchSecurityContext(),nodeModels:o}),widget.propertiesComponent.events.subscribe({event:"close-document-properties"},function(){widget.app.events.publish({event:"triptych-hide-panel",data:"right"})}),widget.app.events.addSingletonEventListener("close-properties-token","triptych-hide-panel",function(e){"right"!=e||widget.getValue("DocumentToolbarV2")||widget.body.getElements("[name='ShowProperties']>.fonticon").forEach(e=>{e.removeClassName("item-active")})}),widget.propertiesComponent.events.subscribe({event:"edit-prop-property-change"},function(e){});var n={side:"right",content:widget.propertiesComponent.getContent()};widget.app.events.publish({event:"triptych-set-content",data:n})}),widget.app.events.addSingletonEventListener("refresh-properties-on-node-selection-token","enox-doco-node-selection-changed",function(t){widget.triptych._isRightOpen&&n.execute(e,!0)}),widget.app.events.publish({event:"triptych-show-panel",data:"right"})}},n}),define("DS/ENOXDocumentControlUI/DocEnhancers/Constants/Constants",["UWA/Core","UWA/Controls/Abstract"],function(e,t){"use strict";return{EMPTY_STRING:"",SPACE:" ",ACTION:"Action",EMPTY_JSON_OBJECT:{},EMPTY_JSON_ARRAY:[],WILD_CHARACTER:"*",AMPERSAND:"&",ERROR:"error",PRIMARY:"primary",WARNING:"warning",INFO:"info",SUCCESS:"success",PAD_CURRENT_SECURITY_CONTEXT:"pad_security_ctx",PAD_AVAILABLE_SECURITY_CONTEXT:"pad_security_ctx_list",PAD_CSRF_TOKEN:"pad_csrf",PLATFORM_SERVICES:"platformServices",CONTEXT_USER:"context_user",CSRF:"CSRF",OBJECT_ID:"id",PHYSICAL_ID:"physicalid",REL_ID:"id[connection]",REL_NAME:"name[connection]",REL_PHYSICAL_ID:"physicalid[connection]",TYPE:"type",NAME:"name",REVISION:"revision",MODIFIED:"modified",ACCEPT_APPLICATION_JSON:"application/json",SECURITY_CONTEXT_KEY:"SecurityContext",CONTENT_TYPE:"Content-Type",APPLICATION_URL_ENCODED:"application/x-www-form-urlencoded",GET:"GET",POST:"POST",PUT:"PUT",CURRENT_USER:"CURRENT_USER"}}),define("DS/ENOXDocumentControlUI/V2/Views/GridView",["UWA/Core","DS/DataGridView/DataGridView","DS/TreeModel/DataModelSet","DS/Tweakers/TypeRepresentationFactory","DS/Controls/TooltipModel","DS/Utilities/Utils"],function(e,t,n,o,i,a){"use strict";var r=new o;return e.Controls.Abstract.extend({name:"doco2-gridview",options:{className:""},_options:{},modelEvents:void 0,init:function(e){this.app=e,this.events=e.events,this._parent({})},build:function(n){var o=this;o.elements.container=e.createElement("div",{class:this.getClassNames()}),o.app.collection.documentColumns.ready.promise.then(function(n){var s=(e.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId)+"gridview";n.forEach(e=>{"title"==e.name?e.getCellValue=function(e){return{label:e.nodeModel.getLabel(),func:function(e){o.app.events.publish({event:"enox-doco-show-preview",data:{nodeModels:e.context.nodeModel}})}}}:"owner"==e.name||"originator"==e.name?e.getCellValue=function(t){if(t.nodeModel)return o.app.core.platformServices["3DSwym"]?{icon:o.app.core.platformServices["3DSwym"]+"/api/user/getpicture/login/"+t.nodeModel.getAttributeValue(e.name).username+"/format/mini",label:t.nodeModel.getAttributeValue(e.name).label,func:function(n){require(["DS/TransientWidget/TransientWidget"],function(n){n.showWidget("X3DPRFL_AP","",{login:t.nodeModel.getAttributeValue(e.name).username,url:o.app.core.platformServices["3DSwym"]})})}}:{label:t.nodeModel.getAttributeValue(e.name).label}}:"lockStatus"==e.name&&(e.onCellRequest=function(e){var t=o.datagridview.reuseCellContent("lockStatusCell"),n=[],a={},s={};e.nodeModel.options.data.relateddata.files&&e.nodeModel.options.data.relateddata.files.length>0&&e.nodeModel.options.data.relateddata.files.forEach(function(e){e.dataelements.locker&&(n.includes(e.dataelements.locker)||(n.push(e.dataelements.locker),s[e.dataelements.locker]=[]),s[e.dataelements.locker].push(e.dataelements.title),e.relateddata.lockerInfo&&e.relateddata.lockerInfo.length>0&&(a[e.dataelements.locker]=e.relateddata.lockerInfo[0].dataelements))}),t.currentUser.empty(),t.otherUsers.empty();var c=n.length;if(c>=2?(t.currentUser.addClassName("hideTitle"),t.otherUsers.addClassName("hideTitle")):(t.currentUser.removeClassName("hideTitle"),t.otherUsers.removeClassName("hideTitle")),c>0){var l=o.app.core.getUser();if(n.includes(l.id)){t.greenKey.show(),t.redLock.hide();var d=a[l.id],u=d?d.firstname+" "+d.lastname:l.id,p={label:u};o.app.core.platformServices["3DSwym"]&&(p.icon=o.app.core.platformServices["3DSwym"]+"/api/user/getpicture/login/"+l.id+"/format/mini"),r.generateView(p,{readOnly:!0,typePath:"user",onViewCreated:function(e){e.inject(t.currentUser),e.tooltipInfos=new i({title:u,shortHelp:s[l.id].join("\n")}),t.currentUser.show()}}),21,!0;var m=n.indexOf(l.id);m>-1&&n.splice(m,1),delete s[l.id]}else t.greenKey.hide();t.otherUsers.show(),n.forEach(function(e){20;var n=a[e],c=n?n.firstname+" "+n.lastname:e,l={label:c};o.app.core.platformServices["3DSwym"]&&(l.icon=o.app.core.platformServices["3DSwym"]+"/api/user/getpicture/login/"+e+"/format/mini"),r.generateView(l,{readOnly:!0,typePath:"user",onViewCreated:function(n){t.redLock.show(),n.inject(t.otherUsers),n.tooltipInfos=new i({title:c,shortHelp:s[e].join("\n")}),t.otherUsers.show()}}),21})}else t.greenKey.hide(),t.currentUser.hide(),t.redLock.hide(),t.otherUsers.hide();e.cellView.setReusableContent(t)})});var c=window.localStorage.getItem("wux-collectionView-dataGridView");null!=c&&(c=JSON.parse(c))[s]&&(delete c[s].columnsSortModel,window.localStorage.setItem("wux-collectionView-dataGridView",JSON.stringify(c))),o.datagridview=new t({identifier:s,treeDocument:o.app.collection.treeDocument,columns:n,autoRowHeightFlag:!0,rowDragEnabledFlag:!1,cellDragEnabledFlag:!0,rowGroupingEnabledFlag:!1,defaultColumnDef:{editableFlag:!1,resizableFlag:!0,sortableFlag:!0,typeRepresentation:"string"},selectionMode:"row",showContextualMenuColumnFlag:!0,rowSelection:"multiple",cellSelection:"none",showSelectionCheckBoxesFlag:!0,showRowIndexFlag:!1,sortModel:o.app.core.master.get("sortModel"),onContextualEvent:function(e){if(e&&e.collectionView)return e.cellInfos&&e.cellInfos.nodeModel?(o.app.core.detail.contextMenu.selectionChanged(),o.app.core.detail.contextMenu.promise):e.collectionView.buildDefaultContextualMenu(e,{pin:!0,firstColumnsVisibility:!0,columnsManagement:!0,sizeColumnToFit:!0})},onDragStartCell:function(e,t){this.onDragStartCellDefault(e,t),e.dataTransfer.effectAllowed="copy";var n=o.app.collection.treeDocument.getSelectedNodes();e.dataTransfer.setData("Text",JSON.stringify(o.app.make3DXContent(n))),e.dataTransfer.setData(("from"+widget.data.appId).toLowerCase(),"a")}}).inject(o.elements.container),o.datagridview.onInfiniteScroll(function(e){e.reachBottom&&o.app.events.publish({event:"enox-doco-more-data-needed"})}),o.app.events.subscribe({event:"enox-doco-more-data-loaded"},function(e){o.datagridview.infiniteScrollProcessDone()}),o.datagridview.addEventListener("sortModelChange",function(){o.datagridview.sortModel.length>0&&null!=o.datagridview.sortModel[0].dataIndex&&o.app.core.master.set({sortModel:o.datagridview.sortModel})}),o.app.core.master.addEvent("onChange:sortModel",function(e,t){o.datagridview.sortModel=t}),o.events.subscribe({event:"enox-doco-data-needs-sorting"},function(e){o.datagridview.reapplySortModel()}),o.app.events.subscribe({event:"enox-doco-flash-row-added"},function(e){e.forEach(e=>{var t=e._getRowID();o.datagridview._flashEffectOnRow("ui-modified",t)})}),console.log(o.datagridview.getCustomViewsManager().getCurrentCustomView()),o.datagridview.getCustomViewsManager().onCustomViewsSave=function(e,t){console.log(e),console.log(t)};var l=a.debounce(function(){console.log(o.datagridview.columns);var e=o.app.collection.documentColumns.getQueryAsPerVisibleColumns(o.datagridview.columns);o.app.data.resetDocumentServiceQueryParams(e)&&o.app.collection.reload(o.app.collection.treeDocument.getRoots())},100);o.datagridview.addEventListener("columnVisibleStateChange",function(e){l()}),o.datagridview.onReady(function(){var e=widget.getValue("userView")||"rowview";widget.app.events.publish({event:"enox-doco-switch-view",data:e});var t=o.app.collection.documentColumns.getQueryAsPerVisibleColumns(o.datagridview.columns);o.app.events.publish({event:"set-sortable-fields",data:{columns:o.app.collection.documentColumns.sortableVisibleColumns,sortModel:o.app.core.master.get("sortModel")}}),o.app.data.documentServiceReady.resolve(t)}),o.datagridview.registerReusableCellContent({id:"lockStatusCell",buildContent:function(){var t=new e.Element("div",{class:"wux-tweakers wux-tweakers-string-label lockStatus"}),n=e.createElement("span",{class:"fonticon fonticon-key reservations-key"}).inject(t);t.greenKey=n,t.greenKey.hide();var o=e.createElement("div",{class:"currentUser"}).inject(t);t.currentUser=o;var i=e.createElement("span",{class:"fonticon fonticon-lock reservations-lock"}).inject(t);t.redLock=i,t.redLock.hide();var a=e.createElement("div",{class:"otherUsers"}).inject(t);return t.otherUsers=a,t}})}),o.inject(n)}})}),define("DS/ENOXDocumentControlUI/DocClientServices/Constants/Constants",[],function(){"use strict";return{DOCUMENT_FAVORITE_LIST:"CtrlDocFavList"}}),define("DS/ENOXDocumentControlUI/DocEnhancers/Services/Resources",["UWA/Core","UWA/Controls/Abstract"],function(e,t){"use strict";return{SET_PREFERENCE:"/resources/AppsMngt/user/preference",GET_PREFERENCE:"/resources/AppsMngt/user/getPreferences",PRINT_BUS:"/resources/v1/model/bus",_3DPLAY_ERROR_PAGE:"/webapps/3DPlayHelper/assets/images/3DPlayErrorPage.svg",_3DPLAY_LANDING_PAGE:"/webapps/3DPlayHelper/assets/images/3DPlayLandingPage.svg",CSRF:"/resources/v1/application/E6WFoundation/CSRF",SECURITY_CONTEXT:"/resources/pno/person/getsecuritycontext?tenant=",GET_TAGS:"/resources/e6w/servicetagdata",GET_SEARCH_RESULT:"/resources/e6w/servicetagdata/search",FEDERATED_SEARCH:"/search"}}),define("DS/ENOXDocumentControlUI/V2/Constants",[],function(){"use strict";return{AccessYourWork:"AccessYourWork",ACCEPT_APPLICATION_JSON:"application/json",GET:"GET",POST:"POST",PUT:"PUT"}}),define("DS/ENOXDocumentControlUI/Utils/LinkOpener",["UWA/Class","DS/UIKIT/Mask"],function(e,t){"use strict";return e.singleton({init:function(){},processX3DContentId:function(){if(void 0!==widget.getValue("X3DContentId")&&""!=widget.getValue("X3DContentId")){var e=JSON.parse(widget.getValue("X3DContentId"));e.data&&e.data.items&&e.data.items.length>0&&(e.data.items[0].openLink=!0,UWA.is(e.data.items[0].envId,"string")&&""!=e.data.items[0].envId&&widget.setValue("x3dPlatformId",e.data.items[0].envId),!1===e.data.items[0].openFile&&(e.data.items[0].openFile=!0),widget.setValue("X3DContentId",JSON.stringify(e)),widget.setValue("welcome","AccessYourWork_AllDocuments"),widget.openPreview=e)}},openPreview:function(e,n,o){t.mask(e),require(["DS/DocumentPreview/PreviewComponent2","DS/DocumentManagement/DocumentManagement","DS/ENOXDocumentControlUI/DocEnhancers/Services/SettingsManagement","DS/DocumentCommonInfra/Model","DS/ENOXDocumentControlUI/DocEnhancers/Constants/Constants","DS/ENOXDocumentControlUI/V2/Actions/Preview","DS/CoreEvents/ModelEvents","i18n!DS/ENOXDocumentControlUI/assets/nls/DocEnhancersUI"],function(n,i,a,r,s,c,l,d){var u=!1,p=new l;function m(){u||(u=!0,o())}p.subscribe({event:"docv2-show-notification"},function(e){widget.app.showNotification(e.level,e.title,e.subtitle,e.message,e.sticky,e.allowUnsafeHTML)}),i.getDocuments([widget.openPreview.data.items[0].objectId],{tenant:a.getPlatformURLs().getTenantId(),securityContext:a.getSetting(s.PAD_CURRENT_SECURITY_CONTEXT),tenantUrl:a.get3DSpaceURL(),additionalURLParams:"$fields=indexedTypeicon",onComplete:function(n){var o=n.data[0],l=new r(o,a.getPlatformURLs().platformurls);if(l.options.data=o,l.options.model=o,1!=n.data.length)throw widget.setValue("X3DContentId",""),widget.setValue("welcome","AccessYourWork_MyDocuments"),m(),t.unmask(e),widget.app.showNotification(s.ERROR,d.get("CannotAccessDocumentTitle"),"",d.get("CannotAccessDocumentMessage"),!0),"Document not found or is inaccessible";{p.subscribe({event:"onPreviewLoaded"},function(n){t.unmask(e),require(["DS/ENOXDocumentControlUI/Utils/FavoriteManager"],function(e){e.loadFavorites(function(e){e.forEach(function(e){o.id===e.id&&(o.myfavorites=!0,widget.previewComponent2.updateDocument(o,!1),widget.previewComponent2.resize())})})})});function u(e){i.getDocuments([widget.openPreview.data.items[0].objectId],{tenant:a.getPlatformURLs().getTenantId(),securityContext:a.getSetting(s.PAD_CURRENT_SECURITY_CONTEXT),tenantUrl:a.get3DSpaceURL(),additionalURLParams:"$fields=indexedTypeicon",onComplete:function(t){var n=t.data[0];l.options.updateData(n),widget.previewComponent2.updateDocument(n,e)}})}p.subscribe({event:"docv2-edit-complete"},function(){u(!1)}),p.subscribe({event:"docv2-undoedit-complete"},function(){u(!1)}),p.subscribe({event:"docv2-update-complete"},function(){u(!0)});var f={fetchSecurityContext:function(){return widget.getValue("credentials")},getWorkUnderHeaders:function(){return{}},getSelectedNodes:function(){return[l]},getDocumentFromNodeModel:function(e){return e.options.data},getOrigin:function(){return{source:UWA.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId,widgetId:widget.id,component:"toolbar"}},platformUrls:a.getPlatformURLs().platformurls,events:p,container:e,isOpenFromCopyLink:!0},v=new c(f);f.events.subscribe({event:"close-preview2"},function(){m()}),v.execute(),window.top.document.addEventListener("3DPLAYLOADINGFINISHED",function(e){e.detail.helper;m()},!1),window.top.document.addEventListener("3DPLAYERROR",function(e){e.detail.helper;m()},!1)}},onFailure:function(n){throw widget.setValue("X3DContentId",""),widget.setValue("welcome","AccessYourWork_MyDocuments"),t.unmask(e),m(),widget.app.showNotification(s.ERROR,d.get("CannotAccessDocumentTitle"),"",d.get("CannotAccessDocumentMessage"),!0),"Document not found or is inaccessible"}})})}})}),define("DS/ENOXDocumentControlUI/V2/Views/ThumbnailView",["UWA/Core","DS/CollectionView/ResponsiveThumbnailsCollectionView","DS/CollectionView/modelProviders/CollectionViewTreeDocumentModelProvider","i18n!DS/ENOXDocumentControlUI/assets/nls/ENOXDocumentControlUI"],function(e,t,n,o){"use strict";return e.Controls.Abstract.extend({name:"doco-thumbnailview",options:{className:""},_options:{},modelEvents:void 0,init:function(e){this.app=e,this.events=e.events,this._parent({})},build:function(i){var a=this;a.elements.container=e.createElement("div",{class:this.getClassNames()});let r=n.inherit({name:"DocumentThumbnailViewTreeDocumentModelProvider",getPropertyValue:function(e,t){return"subLabel"===t?e.options.subLabel.cloneNode(!0):this._parent(e,t)}});a.rcv=new t({model:a.app.collection.treeDocument,useDragAndDrop:!0,shouldCellAllowUnsafeHTMLContentAt:function(e,t){return["subtitle","description"].includes(t)},displayedOptionalCellProperties:["contextualMenu","description","activeFlag"],onDragStartCell:function(e,t){this.onDragStartCellDefault(e,t),e.dataTransfer.effectAllowed="copy";var n=a.app.collection.treeDocument.getSelectedNodes();e.dataTransfer.setData("Text",JSON.stringify(a.app.make3DXContent(n)))},displayPropertiesTooltip:!1}).inject(a.elements.container),a.rcv.modelProvider=new r,a.rcv.getContextualMenu=function(e,t,n){return[""]},a.rcv.onContextualEvent={callback:function(e){return e&&e.cellInfos?(a.app.core.detail.contextMenu.selectionChanged(),a.app.core.detail.contextMenu.promise):(e.cellCtxMenuRequired,[])}},a.rcv.onInfiniteScroll(function(e){e.reachBottom&&a.app.events.publish({event:"enox-doco-more-data-needed"})}),a.rcv.layout&&a.rcv.layout._getRowHeight&&(a.rcv.layout._getRowHeightOriginal=a.rcv.layout._getRowHeight,a.rcv.layout._getRowHeight=function(){return a.rcv.layout._getRowHeightOriginal()-70}),a.rcv.onSelectionAdd(function(e,t){a.app.events.publish({event:"enox-doco-node-selection-add",data:e})}),a.rcv.onSelectionRemove(function(e,t){a.app.events.publish({event:"enox-doco-node-selection-remove",data:e})}),a.app.events.subscribe({event:"enox-doco-more-data-loaded"},function(e){a.rcv.infiniteScrollProcessDone()}),a.elements.noObjectsFoundMessageBlock=new e.Element("div",{class:"no-objects-found"}).inject(a.elements.container),new e.Element("div",{text:o.get("NoObjectsFound")}).inject(a.elements.noObjectsFoundMessageBlock),a.app.events.subscribe({event:"enox-doco-collection-count-changed"},function(e){0==e?a.elements.noObjectsFoundMessageBlock.show():a.elements.noObjectsFoundMessageBlock.hide()}),a.inject(i)}})}),define("DS/ENOXDocumentControlUI/V2/Collection",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/TreeModel/DataSourceBase","DS/DocumentCommonInfra/Model","DS/DocumentCommonInfra/MaturityColors","DS/DocumentCommonInfra/Columns"],function(e,t,n,o,i,a){"use strict";return function(t){var n={app:t,count:0,treeDocument:new e({useAsyncPreExpand:!0,shouldAcceptDrag:function(e,t){return!0},shouldAcceptDrop:function(e,t){return!0}}),documentColumns:new a({tenantUrl:t.core.platformServices["3DSpace"],tenant:t.core.getTenantId()}),clear:function(){return n.treeDocument.removeRoots(),t.core.master.requestId=(new Date).getTime()},addDocuments:function(e){n.treeDocument.prepareUpdate(),n.injectFavorites(e);var i=[];return e.forEach(function(e){UWA.is(e.dataelements.state)&&UWA.is(e.dataelements.policy)?i.push(n.treeDocument.addRoot(new o(e,t.core.platformServices))):console.error("unable to add document to list, since invalid",e)}),n.treeDocument.pushUpdate(),t.events.publish({event:"enox-doco-data-needs-sorting"}),i},injectFavorites:function(e){n.favorites&&n.favorites.length>0&&e.forEach(e=>{n.favorites.includes(e.id)?e.myfavorites=!0:e.myfavorites=!1})},applyFavorites:function(e){e&&e.length>0&&n.treeDocument.getRoots().forEach(t=>{e.includes(t.options.data.id)?t.updateOptions({data:{myfavorites:!0}}):t.updateOptions({data:{myfavorites:!1}})})},reload:function(e,n){var o=e.map(e=>e.options.data.id);t.core.ready.promise.then(function(){t.data.getDataFromDocumentServiceFromDocIds("reload-NodeModels",o,function(t,o){var i={};o.forEach(e=>{i[e.id]=e}),e.forEach(e=>{i[e.options.data.id]&&e.options.updateData(i[e.options.data.id])}),UWA.is(n,"function")&&n(e)})})},reloadByIds:function(e,t){var o=[];n.treeDocument.getRoots().forEach(t=>{e.includes(t.options.data.id)&&o.push(t)}),this.reload(o,t)},addDocumentsToListByIds:function(e,o){t.core.ready.promise.then(function(){t.data.getDataFromDocumentServiceFromDocIds("addDocumentsToListByIds",e,function(e,i){if("addDocumentsToListByIds"==e){var a=n.addDocuments(i);t.events.publish({event:"enox-doco-flash-row-added",data:a}),UWA.is(o,"function")&&o(a)}else console.error("docResponse in wrong section")})})}};function r(e,o,i,a,r,s,c){t.core.ready.promise.then(function(){var l={startRow:0,endRow:50,orderField:o,orderby:i[0].sort,type:a,filters:r,searchQuery:s,requestId:e,physicalIds:c};t.data.getDataFromSearch(l,function(e,o){e==t.core.master.requestId?t.data.documentServiceReady.promise.then(function(){t.data.getDataFromDocumentService(e,o,function(e,o){e==t.core.master.requestId?(n.addDocuments(o),t.events.publish({event:"enox-doco-hide-loading-spinner"})):console.error("docResponse in wrong section")})}):console.error("fedSearch in wrong section")},function(e){})})}return n.treeDocument.getModelEvents().subscribe({event:"addChild"},function(e,o,i){n.count++,t.events.publish({event:"enox-doco-collection-count-changed",data:n.count})}),n.treeDocument.getModelEvents().subscribe({event:"removeChild"},function(e,o,i){n.count--,t.events.publish({event:"enox-doco-collection-count-changed",data:n.count})}),t.core.ready.promise.then(function(){t.core.fetchSecurityContext=t.core.getSecurityContext,t.core.platformUrls=t.core.platformServices,i.setup(t.core)}),t.core.master.addEvent("onChange:activity",function(e,o){e.get("reload")&&n.documentColumns.ready.promise.then(function(){var e=n.clear(),o=t.core.master.get("sortModel"),i=n.documentColumns.getSortPredicate(o[0].dataIndex),a=t.core.master.get("filters"),s=t.core.master.get("searchQuery");t.events.publish({event:"enox-doco-show-loading-spinner"});var c=widget.getValue("CurrentActivity");"Favorites"==c?require(["DS/ENOXDocumentControlUI/Utils/FavoriteManager"],function(t){t.loadFavorites(function(t){n.favorites=t.map(e=>e.id),r(e,i,o,c,a,s,n.favorites)})}):(r(e,i,o,c,a,s),require(["DS/ENOXDocumentControlUI/Utils/FavoriteManager"],function(e){e.loadFavorites(function(e){n.favorites=e.map(e=>e.id),n.applyFavorites(e)})}))})}),t.core.master.addEvent("onChange:sortModel",function(e,o){if(e.get("reload")){var i=n.clear();t.events.publish({event:"enox-doco-show-loading-spinner"}),n.documentColumns.ready.promise.then(function(){var e=t.core.master.get("filters"),a=t.core.master.get("searchQuery"),r=n.documentColumns.getSortPredicate(o[0].dataIndex);t.core.ready.promise.then(function(){var s={startRow:0,endRow:50,orderField:r,orderby:o[0].sort,type:widget.getValue("CurrentActivity"),filters:e,searchQuery:a,requestId:i};t.data.getDataFromSearch(s,function(e,o){e==t.core.master.requestId&&t.data.documentServiceReady.promise.then(function(){t.data.getDataFromDocumentService(e,o,function(e,o){e==t.core.master.requestId&&(n.addDocuments(o),t.events.publish({event:"enox-doco-data-needs-sorting"}),t.events.publish({event:"enox-doco-hide-loading-spinner"}))})})},function(e){})})})}}),t.core.master.addEvent("onChange:filters",function(e,o){if(e.get("reload")){var i=n.clear(),a=t.core.master.get("sortModel"),r=n.documentColumns.getSortPredicate(a[0].dataIndex),s=t.core.master.get("searchQuery");t.events.publish({event:"enox-doco-show-loading-spinner"}),t.core.ready.promise.then(function(){var e={startRow:0,endRow:50,orderField:r,orderby:a[0].sort,type:widget.getValue("CurrentActivity"),filters:o,searchQuery:s,requestId:i};t.data.getDataFromSearch(e,function(e,o){e==t.core.master.requestId&&t.data.documentServiceReady.promise.then(function(){t.data.getDataFromDocumentService(e,o,function(e,o){e==t.core.master.requestId&&(n.addDocuments(o),t.events.publish({event:"enox-doco-data-needs-sorting"}),t.events.publish({event:"enox-doco-hide-loading-spinner"}))})})},function(e){})})}}),t.core.master.addEvent("onChange:searchQuery",function(e,o){if(e.get("reload")){var i=n.clear(),a=t.core.master.get("sortModel"),r=n.documentColumns.getSortPredicate(a[0].dataIndex),s=t.core.master.get("filters");t.events.publish({event:"enox-doco-show-loading-spinner"}),t.core.ready.promise.then(function(){var e={startRow:0,endRow:50,orderField:r,orderby:a[0].sort,type:widget.getValue("CurrentActivity"),filters:s,searchQuery:o,requestId:i};t.data.getDataFromSearch(e,function(e,o){e==t.core.master.requestId&&t.data.documentServiceReady.promise.then(function(){t.data.getDataFromDocumentService(e,o,function(e,o){e==t.core.master.requestId&&(n.addDocuments(o),t.events.publish({event:"enox-doco-data-needs-sorting"}),t.events.publish({event:"enox-doco-hide-loading-spinner"}))})})},function(e){})})}}),t.events.subscribe({event:"enox-doco-more-data-needed"},function(e){t.core.ready.promise.then(function(){var e=n.treeDocument.getRoots().length,o=t.core.master.get("sortModel"),i=n.documentColumns.getSortPredicate(o[0].dataIndex),a=t.core.master.get("filters"),r=t.core.master.get("searchQuery"),s={startRow:e,endRow:50+e,orderField:i,orderby:o[0].sort,type:widget.getValue("CurrentActivity"),filters:a,searchQuery:r,requestId:t.core.master.requestId,ignoreTagger:!0};t.events.publish({event:"enox-doco-show-loading-spinner"}),t.data.getDataFromSearch(s,function(e,o){e==t.core.master.requestId&&t.data.documentServiceReady.promise.then(function(){t.data.getDataFromDocumentService(e,o,function(e,o){e==t.core.master.requestId&&(n.addDocuments(o),t.events.publish({event:"enox-doco-data-needs-sorting"}),t.events.publish({event:"enox-doco-more-data-loaded"}),t.events.publish({event:"enox-doco-hide-loading-spinner"}))})})},function(e){})})}),t.events.subscribe({event:"enox-doco-node-selection-add"},function(e){var o=n.treeDocument.getSelectedNodes();t.core.detail.set({nodeModels:o}),t.events.publish({event:"enox-doco-node-selection-changed",data:o})}),t.events.subscribe({event:"enox-doco-node-selection-remove"},function(e){var o=n.treeDocument.getSelectedNodes();t.core.detail.set({nodeModels:o}),t.events.publish({event:"enox-doco-node-selection-changed",data:n.treeDocument.getSelectedNodes()})}),t.events.subscribe({event:"IsNextAndPreviousItemAvailable"},function(e){var t=n.treeDocument.getRoots(),o=[e.nodeModel],i=0,a=(i=0==o.length?0:o[0]._rowID)-1,r=i+1;e.callback&&e.callback({next:r<t.length,previous:a>=0})}),t.events.subscribe({event:"onNextClick"},function(e){var o=n.treeDocument.getRoots(),i=[e.nodeModel],a=(0==i.length?-1:i[0]._rowID)+1;a>=0&&(n.treeDocument.unselectAll(),o[a].select(),t.events.publish({event:"enox-doco-show-preview",data:{nodeModels:t.core.detail.get("nodeModels")}}))}),t.events.subscribe({event:"onPrevClick"},function(e){var o=n.treeDocument.getRoots(),i=[e.nodeModel],a=(0==i.length?o[o.length].rowID+1:i[0]._rowID)-1;a>=0&&(n.treeDocument.unselectAll(),o[a].select(),t.events.publish({event:"enox-doco-show-preview",data:{nodeModels:t.core.detail.get("nodeModels")}}))}),n}}),define("DS/ENOXDocumentControlUI/V2/Actions/SortSwitcher",["UWA/Core","i18n!DS/ENOXDocumentControlUI/assets/nls/DocEnhancersUI"],function(e,t){"use strict";var n=function(e){return{id:"SortSwitcher",dataElements:{docV2Private:!0,typeRepresentation:"chevronMenuIcon",icon:{iconName:"date-sorting-31-1",fontIconFamily:1},value:{menu:[{type:"RadioItem",title:t.get("Title"),name:"title",dataIndex:"tree",dataIndex6w:"ds6w:label",sort:"asc",sortType:"string",icon:{iconName:"alpha-sorting-a-z",fontIconFamily:1},action:{callback:function(e){n.execute(e,this)},context:{options:e}}},{type:"RadioItem",title:t.get("Name"),name:"name",dataIndex:"name",dataIndex6w:"ds6w:identifier",sort:"asc",sortType:"string",icon:{iconName:"alpha-sorting-a-z",fontIconFamily:1},action:{callback:function(e){n.execute(e,this)},context:{options:e}}},{type:"RadioItem",title:t.get("Maturity"),name:"maturity",dataIndex:"stateNLS",dataIndex6w:"ds6w:status",sort:"asc",sortType:"string",icon:{iconName:"alpha-sorting-a-z",fontIconFamily:1},action:{callback:function(e){n.execute(e,this)},context:{options:e}}},{type:"RadioItem",title:t.get("Modified Date"),name:"modified",dataIndex:"modified",dataIndex6w:"ds6w:modified",sort:"desc",sortType:"date",icon:{iconName:"date-sorting-31-1",fontIconFamily:1},action:{callback:function(e){n.execute(e,this)},context:{options:e}}}]},label:t.get("Modified Date"),tooltip:t.get("Modified Date"),position:"far",category:"stable area",visibleFlag:!0,priority:10},updateForSelection:function(e,t){},extend:function(e,t){var n=widget.app.core.master.sortModel;null==n&&(n={sortAttribute:"modified",sort:"desc",dataIndex:"modified",dataIndex6w:"ds6w:modified"}),e.options.grid.data.menu.forEach(t=>{t.action.context.name=t.name,t.action.context.dataIndex=t.dataIndex,t.action.context.dataIndex6w=t.dataIndex6w,t.action.context.action=e,t.action.context.radioItem=t,t.action.this=t,t.state="",n.sortAttribute==t.action.context.name&&(t.state="selected","string"==t.sortType?t.icon.iconName="asc"==n.sort?"alpha-sorting-a-z":"alpha-sorting-z-a":"date"==t.sortType&&(t.icon.iconName="asc"==n.sort?"date-sorting-1-31":"date-sorting-31-1"),t.sort=n.sort,e.selectedDataIndex=t.dataIndex,e.selectedDataIndex6w=t.dataIndex6w,e.updateOptions({icon:t.icon,tooltip:t.title,label:t.title}))})}}};return n.execute=function(e,t){e.context.action.options.grid.data.menu.forEach(e=>{e.state=""}),t.state="selected",e.context.action.selectedDataIndex!=e.context.dataIndex?(e.context.action.selectedDataIndex=e.context.dataIndex,widget.app.core.master.set({sortModel:[{sortAttribute:t.name,sort:t.sort,dataIndex:t.dataIndex,dataIndex6w:t.dataIndex6w}]}),e.context.action.updateOptions({icon:t.icon,tooltip:t.title,label:t.title})):(t.sort="asc"==t.sort?"desc":"asc","string"==t.sortType?t.icon.iconName="asc"==t.sort?"alpha-sorting-a-z":"alpha-sorting-z-a":"date"==t.sortType&&(t.icon.iconName="asc"==t.sort?"date-sorting-1-31":"date-sorting-31-1"),e.context.action.selectedDataIndex=e.context.dataIndex,e.context.action.selectedDataIndex6w=e.context.dataIndex6w,widget.app.core.master.set({sortModel:[{sortAttribute:t.name,sort:t.sort,dataIndex:t.dataIndex,dataIndex6w:t.dataIndex6w}]}),e.context.action.updateOptions({icon:t.icon,tooltip:t.title,label:t.title}))},n}),define("DS/ENOXDocumentControlUI/V2/Views/CenterPane",["UWA/Core","DS/ENOXDocumentControlUI/V2/Views/TopBar","DS/ENOXDocumentControlUI/V2/Views/GridView","DS/ENOXDocumentControlUI/V2/Views/ThumbnailView","DS/ENOXDocumentControlUI/V2/Views/TileView","DS/DataDragAndDrop/DataDragAndDrop","DS/UIKIT/Mask"],function(e,t,n,o,i,a,r){"use strict";return e.Controls.Abstract.extend({name:"doco2-center-pane",options:{className:""},_options:{},modelEvents:void 0,init:function(e){this.app=e,this.events=e.events,this._parent({})},build:function(r){var s=this;s.elements.container=e.createElement("div",{class:this.getClassNames()}),s.events.subscribe({event:"enox-doco-show-loading-spinner"},function(e){s.startLoading()}),s.events.subscribe({event:"enox-doco-hide-loading-spinner"},function(e){s.finishLoading()}),s.topBar=new t(s.app),s.topBar.build(s.elements.container),s.elements.details=e.createElement("div",{styles:{"flex-grow":1,position:"relative"}}).inject(s.elements.container),s.gridView=new n(s.app),s.gridView.build(s.elements.details),s.thumbnailView=new o(s.app),s.thumbnailView.build(s.elements.details),s.tileView=new i(s.app),s.tileView.build(s.elements.details),s.events.subscribe({event:"enox-doco-switch-view"},function(e){"rowview"==e?(s.thumbnailView.hide(),s.tileView.hide(),s.gridView.show()):"thumbnail"==e?(s.gridView.hide(),s.tileView.hide(),s.thumbnailView.show()):"smalltile"==e&&(s.gridView.hide(),s.thumbnailView.hide(),s.tileView.show()),widget.setValue("userView",e)});var c=s.getClassNames("-drag-over"),l={drop:function(e,t,n){s.elements.container.removeClassName(c),n.dataTransfer.files&&n.dataTransfer.files.length>0&&s.events.publish({event:"upload-files-on-drop",data:n.dataTransfer.files})},enter:function(e,t){t.dataTransfer&&t.dataTransfer.types&&t.dataTransfer.types.includes("text/plain")||s.elements.container.addClassName(c)},over:function(e,t){t.dataTransfer&&t.dataTransfer.types&&t.dataTransfer.types.includes("text/plain")||s.elements.container.addClassName(c)},leave:function(e,t){s.elements.container.removeClassName(c)}};a.droppable(s.elements.container,l),s.inject(r),s.startLoading()},startLoading:function(){r.mask(this.elements.container)},finishLoading:function(){r.unmask(this.elements.container)}})}),define("DS/ENOXDocumentControlUI/DocExtWelcomePanelUI/Collections/ENOXWelcomePanelCollection",["UWA/Class/Model","UWA/Class/Collection","UWA/Promise","DS/ENOXDocumentControlUI/DocEnhancersUI/Constants/Constants"],function(e,t,n,o){"use strict";return{createCollection:function(){return t.extend({model:e.extend({}),sync:function(e,t,n){require([t.options.panelOptions,t.options.nls],function(e,t){var o={WelcomePanelActivities:JSON.parse(e),WelcomePanelNLS:t};n.onComplete(o)})},setup:function(e,t){var n=t.panelOptions,i=t.nls;this.options={},this.options.panelOptions="text!"+n,this.options.nls=i?"i18n!"+i:o.EMPTY_STRING},parse:function(e,t){var n=e.WelcomePanelNLS;return e.WelcomePanelActivities.activities.forEach(function(e){e.title=n[e.id],e.actions.forEach(function(e){e.text=n[e.id]})}),e.options=t,e}})}}}),define("DS/ENOXDocumentControlUI/DocEnhancers/Services/SettingsManagement",["UWA/Class","DS/ENOXDocumentControlUI/DocEnhancers/Constants/Constants"],function(e,t){"use strict";return e.singleton({init:function(){this.isPlatformInitialized=!0},addSetting:function(e,t){if(!this.isPlatformInitialized)throw new Error("Platformservices not initialized");widget[e]&&console.log("Setting is already in use"),widget[e]=t},getSetting:function(e){return widget[e]||""},getPlatformURLs:function(){return this.getSetting(t.PLATFORM_SERVICES)},getPlatformId:function(){return widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise"},get3DSpaceURL:function(){return this.getPlatformURLs().get3DSpaceURL()}})}),define("DS/ENOXDocumentControlUI/DocEnhancers/Utils/Helper",["UWA/Core","UWA/Promise","DS/ENOXDocumentControlUI/DocEnhancers/Constants/Constants","i18n!DS/ENOXDocumentControlUI/assets/nls/DocEnhancers"],function(e,t,n,o){"use strict";var i={containsItem:function(e,t,n){(null==n||""===n)&&(n="id");for(var o=0;o<e.length;o++){var i=t[n]?t[n]:t;if(e[o][n]===i)return o}return-1},getMessage:function(e){var t=null!=e&&i.isStringEmpty(e.key)?e.key:"0001",a=null!=e&&i.isArrayEmpty("appends")?e.appends:n.EMPTY_JSON_ARRAY;return(o[t]||t).concat(a)},isStringEmpty:function(e){var t=!0;if(void 0!==e&&e!==n.EMPTY_STRING&&null!==e){if(!UWA.is(e,"string"))throw new Error("Data is not a typeOf string");t=!1}return t},isArrayEmpty:function(e){var t=!0;return void 0!==e&&e!=n.EMPTY_STRING&&(UWA.is(e,"array")?e.length>0&&(t=!1):t=!1),t}};return i}),define("DS/ENOXDocumentControlUI/DocEnhancers/Services/WebServices",["UWA/Core","UWA/Promise","UWA/Utils","DS/ENOXDocumentControlUI/DocEnhancers/Services/SettingsManagement","DS/WAFData/WAFData","DS/ENOXDocumentControlUI/DocEnhancers/Constants/Constants","DS/ENOXDocumentControlUI/DocEnhancers/Utils/Helper","DS/ENOXDocumentControlUI/DocEnhancers/Services/Resources"],function(e,t,n,o,i,a,r,s){"use strict";return{callCustomService:function(e){e.method=e.method||a.GET,e.headers=e.headers||{Accept:a.ACCEPT_APPLICATION_JSON},e.proxy=e.proxy||"passport",e.withoutSC||(e.SecurityContext=o.getSetting(a.PAD_CURRENT_SECURITY_CONTEXT)),i.authenticatedRequest(e.url,e)},getAllMaturityStates:function(e,t){void 0!==t.onComplete&&void 0!==t.onFailure||console.log("Define onComplete and onFailure for getAllMaturityStates"),t.method=a.POST,t.type="json",t.url=o.getPlatformURLs().get3DSpaceURL()+"/resources/lifecycle/maturity/getStateGraph?tenant="+o.getPlatformURLs().getTenantId(),t.headers={Accept:a.ACCEPT_APPLICATION_JSON,"Content-Type":a.ACCEPT_APPLICATION_JSON,securitycontext:o.getSetting(a.PAD_CURRENT_SECURITY_CONTEXT)},t.data=JSON.stringify({data:[{physicalid:e}]}),this.callCustomService(t)}}}),define("DS/ENOXDocumentControlUI/DocEnhancersUI/Utils/Helper",["UWA/Core","DS/UIKIT/Alert","DS/Notifications/NotificationsManagerViewOnScreen","DS/Notifications/NotificationsManagerUXMessages","DS/UIKIT/Mask","DS/UIKIT/Input/Button","DS/ENOXDocumentControlUI/DocEnhancers/Constants/Constants","DS/ENOXDocumentControlUI/DocEnhancersUI/Constants/Constants","DS/ENOXDocumentControlUI/DocEnhancers/Services/SettingsManagement","DS/ENOXDocumentControlUI/DocEnhancers/Services/WebServices"],function(e,t,n,o,i,a,r,s,c,l){"use strict";return{showNotification:function(e,t,i,a,r,s){var c={level:e,title:t,subtitle:i,message:a,sticky:r,allowUnsafeHTML:s||!1};window.notifs=o,n.setNotificationManager(window.notifs),n.setStackingPolicy(5),window.notifs.addNotif(c)},loadingON:function(e,t){var n=r.EMPTY_STRING;n=t||widget.body,e?i.mask(n,e):i.mask(n)},loadingOFF:function(e){var t=r.EMPTY_STRING;t=e||widget.body,i.unmask(t)}}}),define("DS/ENOXDocumentControlUI/DocExtWelcomePanelUI/Views/ENOXExtWelcomePanelView",["UWA/Core","UWA/Class/View","DS/Core/ModelEvents","DS/UIKIT/SuperModal","DS/ENOXStandardActionbar/js/ENOXStandardActionbar","DS/ENOXWelcomePanel/js/ENOXWelcomePanel","DS/ENOXDocumentControlUI/DocEnhancers/Constants/Constants","DS/ENOXDocumentControlUI/DocEnhancers/Utils/Helper","DS/ENOXDocumentControlUI/DocEnhancersUI/Utils/Helper","DS/ENOXDocumentControlUI/DocEnhancers/Services/SettingsManagement","DS/ENOXDocumentControlUI/DocEnhancersUI/Constants/Constants","DS/UIKIT/Scroller","i18n!DS/ENOXDocumentControlUI/assets/nls/DocEnhancersUI","css!DS/ENOXDocumentControlUI/ENOXDocumentControlUI.css"],function(e,t,n,o,i,a,r,s,c,l,d,u,p){"use strict";return a.extend({name:"ExtendedWelcomePanel",defaultOptions:{selected:"",showHomePage:!0,showAplhaOrdering:!0,showNumbeOrdering:!0,showCollapse:!0,activityAction:{}},adjustToolTip:function(e){for(var t=this.activities,n=0;n<t.length;n++)for(var o=t[n].actions,i=0;i<o.length;i++)o[i].tooltipElt&&(o[i].tooltipElt.options.position=e)},getEvents:function(e){var t=e.options,o=t.events||r.EMPTY_JSON_OBJECT,i=s.isArrayEmpty(o)?new n(JSON.parse(o)):new n;return i.subscribe({event:"welcome-panel-action-selected"},function(n){window.event&&window.event.target;for(var o,i,a=t.activities,s=0;s<a.length;s++)for(var c=0;c<a[s].actions.length;c++)if(a[s].actions[c].id==n.id){(i=a[s].actions[c]).options&&i.options.side||"right",o=i.options||r.EMPTY_JSON_OBJECT;break}if(i.isNotHighlightable)widget.app.events.publish({event:"doco-welcome-panel-perform-action",data:i});else{widget.setValue("CurrentActivity",n.id),widget.app.events.publish({event:"doco-welcome-panel-action-open",data:i}),widget.dispatchEvent("widget-title-needs-update",{selectionTitle:i.text});var l=e.container.getElements("#"+n.id+".selected"),d=e.container.getElements(".currentselection");void 0!==o.retainSelection&&!0!==o.retainSelection||(d.length>0&&d[0].removeClassName("currentselection"),l.length>0&&l[0].addClassName("currentselection"));o.model||r.EMPTY_JSON_OBJECT,o.collection||r.EMPTY_JSON_OBJECT,o.pagecollection||r.EMPTY_JSON_OBJECT,o.view||r.EMPTY_JSON_OBJECT;t.triptychView.enoxTriptych._isRightOpen&&t.triptychView.enoxTriptych._modelEvents.publish({event:"triptych-hide-panel",side:"right"}),widget.body.clientWidth<=550&&!t.triptychView.enoxTriptych._isMobileMode?(t.triptychView.showLeftOrRightPanel("left"),t.triptychView.resize({side:"left",size:t.triptychView.enoxTriptych._options.left.originalSize})):widget.body.clientWidth<=550&&t.triptychView.enoxTriptych._isMobileMode&&t.triptychView.enoxTriptych._leftPanel.getElement(".triptych-wp-toggle-btn").click()}}),i},setup:function(e){this.options=UWA.merge(e,this.defaultOptions),this.options.modelEvents=this.getEvents(this);var t=UWA.createElement("div",{class:"extended-welcome-panel-view-container",styles:{width:"100%",height:"100%"}});this.parentContainer=t,this.activities=e.data._models[0]._attributes.WelcomePanelActivities.activities,e.activities=e.data._models[0]._attributes.WelcomePanelActivities.activities,this.modelEvents=this.options.modelEvents,this.collapsed=!1,this._parent(e)},setDefaultActivityAction:function(){var e=this;e.activities.forEach(function(t){t.actions.forEach(function(n){n.default&&(e.options.activityAction.activity=t.id,e.options.activityAction.action=n.id)})})},render:function(e){this.adjustToolTip("top left"),this._parent();var t=this.options.triptychView,n={side:"left",content:this.parentContainer};t.renderContent(n),this.setDefaultActivityAction();var o=widget.getValue("welcome");if((o=o.replace(" ",""))&&-1!==o.indexOf("_")&&(this.options.activityAction.activity=o.substr(0,o.indexOf("_")),this.options.activityAction.action=o.substr(o.indexOf("_")+1)),this.options.activityAction.action){var i=this.options.activityAction.action;this.container.getElement("#"+i+".action-new.activity-btn").click()}}})}),define("DS/ENOXDocumentControlUI/DocEnhancers/Services/Favorites",["UWA/Core","UWA/Promise","UWA/Utils","DS/ENOXDocumentControlUI/DocEnhancers/Services/SettingsManagement","DS/ENOXDocumentControlUI/DocEnhancers/Services/WebServices","DS/ENOXDocumentControlUI/DocEnhancers/Constants/Constants","DS/ENOXDocumentControlUI/DocEnhancers/Utils/Helper","DS/ENOXDocumentControlUI/DocEnhancers/Services/Resources"],function(e,t,n,o,i,a,r,s){"use strict";return{addFavorites:function(c){if(!e.is(c,"object"))throw new Error(r.getMessage({key:"0004",appends:["WebServices.addFavorites.options"]}));var l=this,d=c.name,u=c.compare||"id",p={data:{protocol:c.protocol||"3DXContent",version:c.version||"1.0",source:c.source||"",data:c.resolvedFavorites||{}}},m=c;if(!c.resolvedFavorites){p.data.data[d]=[];for(var f=0;f<c.favorites.length;f++){var v=c.favorites[f]._attributes||c.favorites[f];if((v.physicalid||v.id)&&(v.name||v.dataelements.name)){var g={id:v.physicalid||v.id,name:v.name||v.dataelements.name};p.data.data[d].push(g)}}}new t(function(e,t){var n={onComplete:e,onFailure:t,name:d};l.getFavorites(n)}).then(function(e){var t=e.value,f=p.data.data[d];if(t&&t.data&&t.data.data){var v=t.data.data[d];f.forEach(function(e){-1==r.containsItem(v,e,u)&&v.push(e)}),p.data.data[d]=v}l._lastPrefToSave||(l._lastPrefToSave={}),l._lastPrefToSave[c.name]={name:c.name,value:n.base64Encode(JSON.stringify(p))};var g=l._lastPrefToSave[c.name];if(g){var h=o.getPlatformURLs().platformurls["3DCompass"]+s.SET_PREFERENCE;m.method=a.PUT,m.headers={Accept:a.ACCEPT_APPLICATION_JSON},m.headers[a.CONTENT_TYPE]=a.APPLICATION_URL_ENCODED,m.data={name:g.name,value:g.value},m.withoutTenant=!0,m.url=h,i.callCustomService(m),delete l._lastPrefToSave[c.name]}})},replaceFavorites:function(t){if(!e.is(t,"object"))throw new Error(r.getMessage({key:"0004",appends:["WebServices.replaceFavorites.options"]}));var c=t.name,l=(t.compare,{data:{protocol:t.protocol||"3DXContent",version:t.version||"1.0",source:t.source||"",data:t.resolvedFavorites||{}}}),d=t;if(!t.resolvedFavorites){l.data.data[c]=a.EMPTY_JSON_ARRAY;for(var u=0;u<t.favorites.length;u++){var p=t.favorites[u]._attributes||t.favorites[u];if((p.physicalid||p.id)&&p.name){var m={id:p.physicalid||p.id,name:p.name};l.data.data[c].push(m)}}}this._lastPrefToSave||(this._lastPrefToSave={}),this._lastPrefToSave[t.name]={name:t.name,value:n.base64Encode(JSON.stringify(l))};var f=this._lastPrefToSave[t.name];if(f){var v=o.getPlatformURLs().platformurls["3DCompass"]+s.SET_PREFERENCE;d.method=a.PUT,d.headers={Accept:a.ACCEPT_APPLICATION_JSON},d.headers[a.CONTENT_TYPE]=a.APPLICATION_URL_ENCODED,d.data={name:f.name,value:f.value},d.withoutTenant=!0,d.url=v,i.callCustomService(d),delete this._lastPrefToSave[t.name]}},getFavorites:function(t){if(!e.is(t,"object"))throw new Error(r.getMessage({key:"0004",appends:["Webservices.getFavorites.options"]}));var c=t,l=t.onComplete,d=o.getPlatformURLs().platformurls["3DCompass"]+s.GET_PREFERENCE+"?";c.query={name:t.name},c.method="GET",c.headers={Accept:a.ACCEPT_APPLICATION_JSON},c.withoutTenant=!0;var u={name:t.name};c.url=d+n.toQueryString(u),c.onComplete=function(e){var o={},i=n.base64Decode(e);o.value=r.isStringEmpty(i)?a.EMPTY_STRING:JSON.parse(i),o.options=t,l(o)},c.onFailure=function(e){console.log(e)},i.callCustomService(c)},deleteFavorites:function(n){if(!e.is(n,"object"))throw new Error(r.getMessage({key:"0004",appends:["Webservices.deleteFavorites.options"]}));var o=this,i=n.onComplete,a=n.onFailure,s=n.name,c=n.favorites;new t(function(e,t){var n={onComplete:function(t){var n=t.value.data.data[s];c.forEach(function(e){var t=r.containsItem(n,e,"id");-1!=t&&n.splice(t,1)}),t.value.data.data[s]=n,e(t.value)},onFailure:t,name:s};o.getFavorites(n)}).then(function(e){return new t(function(t,n){var i={name:s,onComplete:function(e){t({data:e,removedContent:c})},onFailure:n,protocol:e.data.protocol,version:e.data.version,source:e.data.source,resolvedFavorites:e.data.data};o.replaceFavorites(i)})}).then(function(e){i(e)},function(e){a(e)})}}}),define("DS/ENOXDocumentControlUI/Utils/FavoriteManager",["UWA/Class","DS/ENOXDocumentControlUI/DocEnhancers/Services/SettingsManagement","DS/ENOXDocumentControlUI/DocEnhancers/Services/Favorites","DS/ENOXDocumentControlUI/DocClientServices/Constants/Constants"],function(e,t,n,o){"use strict";var i=e.singleton({init:function(){},prefName:o.DOCUMENT_FAVORITE_LIST+t.getPlatformURLs().getTenantId(),loadFavorites:function(e,t){n.getFavorites({name:i.prefName,onComplete:function(t){var n=t.value?t.value.data.data[i.prefName]:[];e(n)},onFailure:function(e){t(e)}})}});return i}),define("DS/ENOXDocumentControlUI/V2/Core",["UWA/Core","UWA/Class/Model","UWA/Class/Debug","UWA/Promise","DS/ENOXDocumentControlUI/V2/Constants","DS/DocumentCommands/TypeDerivativesCache","i18n!DS/ENOXDocumentControlUI/assets/nls/ENOXDocumentControlUI"],function(e,t,n,o,i,a,r){"use strict";return function(o){var i={app:o,ready:e.Promise.deferred(),getTenantId:function(){return widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise"},fillPlatformServices:function(){this.platformServices=widget.platformurls,this.loadSupportedTypeList()},loadSupportedTypeList:function(){var e=this;a.setup(e.platformServices["3DSpace"]),a.getTypeDerivatives(e.supportedTypes.main,function(t){e.supportedTypes.main.length>0&&e.supportedTypes.main.forEach(n=>{e.supportedTypes.all.push(...t[n])}),e.ready.resolve(!0)},e.platformServices["3DSpace"])},getSecurityContext:function(){return widget.getValue("credentials")},getUser:function(){return widget.CURRENT_USER},hookEvents:function(){var e=this;e.app.events.subscribe({event:"doco-welcome-panel-action-open"},function(t){t.isV2?(console.log("isV2"),"main"==t.options.side&&e.master.set({activity:{id:t.id,timestamp:Date.now()}})):"main"==t.options.side&&e.master.set({activity:{id:t.id,timestamp:Date.now()}})})},init:function(){this.fillPlatformServices(),this.hookEvents()},supportedTypes:{main:["Document","Quality System Document","Technical Document"],all:["Document","Quality System Document","Technical Document"]}};return i.master=new(t.extend(n,{defaults:{activity:{id:"",timestamp:Date.now()},sortModel:[{sort:"desc",dataIndex:"modified"}],reload:!0,filters:{},searchQuery:void 0}})),i.detail=new(t.extend(n,{nodeModels:void 0})),i}}),define("DS/ENOXDocumentControlUI/DocConfigTriptychUI/Views/ENOXConfiguredTriptychView",["UWA/Core","UWA/Promise","DS/CoreEvents/ModelEvents","DS/ENOXTriptych/js/ENOXTriptych","DS/ENOXDocumentControlUI/DocEnhancers/Utils/Helper","DS/ENOXDocumentControlUI/DocEnhancers/Constants/Constants","DS/ENOXDocumentControlUI/DocEnhancersUI/Utils/Helper","DS/UIKIT/Tooltip","i18n!DS/ENOXDocumentControlUI/assets/nls/DocEnhancers","i18n!DS/ENOXDocumentControlUI/assets/nls/DocEnhancersUI","css!DS/ENOXTriptych/css/ENOXTriptych.css","css!DS/ENOXDocumentControlUI/ENOXDocumentControlUI.css"],function(e,t,n,o,i,a,r,s,c,l){"use strict";var d=function(){};function u(e){e.enoxTriptych}return d.prototype.onResize=function(){try{if(u(this),widget.body.clientWidth<=1120&&this.enoxTriptych._isLeftOpen&&this.enoxTriptych._isRightOpen){var e=widget.getElement(".triptych-wp-toggle-btn");null!=e&&e.click()}}catch(e){console.log("Error while resizing.: "+e)}},d.prototype.init=function(e){this.options=e||a.EMPTY_JSON_OBJECT,self.widget.removeEvent("onResize"),self.widget.addEvent("onResize",this.onResize.bind(this))},d.prototype.buildview=function(){var t=this,i=new e.Element("div",{class:"extended-triptych-view",styles:{height:"inherit"}});t.options.renderTo?i.inject(t.options.renderTo):a.EMPTY_STRING,require(["text!"+t.options.configurations],function(r){var s=a.EMPTY_JSON_OBJECT;"string"==typeof r&&(s=JSON.parse(r));t.options||a.EMPTY_JSON_OBJECT;t.triptychContainer=i,t.jsonConfig=s;var c={modelEvents:t.options.modelEvents||new n},l=function(t){var o=t.triptychContainer,i=t.jsonConfig,r=(t.options,new e.Element("div",{class:"triptych-container triptych-left open borderLeft leftView"}).inject(o)),s=new e.Element("div",{class:"triptych-container triptych-rightPanel rightView"}).inject(o),c=new e.Element("div",{class:"triptych-container triptych-modal triptych-modal-main mainView"}).inject(o),l=t.options.modelEvents||new n;t.modelEvents=l,null!=i.right[0].config[0].originalState?i.right[0].config[0].originalState:a.EMPTY_STRING,null!=i.left[0].config[0].originalState?i.left[0].config[0].originalState:a.EMPTY_STRING,null!=i.main[0].config[0].originalState?i.main[0].config[0].originalState:a.EMPTY_STRING;var d=i.order?i.order.split(","):a.EMPTY_JSON_ARRAY;d.indexOf("left")<0&&d.push("left"),d.indexOf("right")<0&&d.push("right"),d.indexOf("main")<0&&d.push("main"),d.forEach(function(e){"open"===i[e][0].config[0].originalState?(i[e][0].side=e,t.renderFromJson(i[e][0])):"main"===e&&c.addClassName("hideMainView")});var u=widget.getValue("doco-info-panel-width");e.is(u,"number")&&(i.right[0].config[0].originalSize=u);var p={left:i.left[0].config[0],right:i.right[0].config[0],container:o,withtransition:i.triptych[0].withtransition,modelEvents:l,withoverflowhidden:i.triptych[0].withoverflowhidden,borderLeft:i.triptych[0].borderLeft,borderRight:i.triptych[0].borderRight,originalRight:i.triptych[0].originalRight},m={leftView:r,rightView:s,mainView:c,options:p};return l.subscribe({event:"triptych-resized"},function(t){"right"==t.side&&e.is(t.width,"number")&&widget.setValue("doco-info-panel-width",t.width)}),m}(t),d=widget.triptych=new o;t.enoxTriptych=d,d.init(l.options,void 0,l.mainView,l.rightView,c);var u=e.extendElement(t.enoxTriptych._mainPanel).getElement(".triptych-wp-toggle-btn");u.outerHTML=u.outerHTML,t.enoxTriptych.welcomePanelToggle=u=e.extendElement(t.enoxTriptych._mainPanel).getElement(".triptych-wp-toggle-btn"),u.inject(t.enoxTriptych._leftPanel);var p=u.getElement(".fonticon");u.addEventListener("click",function(e){t.enoxTriptych._isLeftOpen?(t.enoxTriptych._hidePanel("left"),p.classList.remove("fonticon-expand-left"),p.classList.add("fonticon-expand-right"),t.enoxTriptych._refreshContainerLeftSize()):(t.enoxTriptych._showPanel("left"),p.classList.remove("fonticon-expand-right"),p.classList.add("fonticon-expand-left"),t.enoxTriptych._refreshContainerLeftSize())}),l.mainView.hasClassName("hideMainView")&&(t.mainview=l.mainView,t.onResize())})},d.prototype.renderFromJson=function(n){var o=this,c=n.side,l="";"left"===c?l=widget.getElements(".leftView")[0]:"right"===c?l=widget.getElements(".rightView")[0]:"main"===c&&(l=widget.getElements(".mainView")[0]),l&&c||console.log("PanelContainer not available"),"main"!=c&&r.loadingON("Loading...",l);var d=!n.pagecollection||i.isArrayEmpty(n.pagecollection.url)?a.EMPTY_STRING:n.pagecollection.url,p=!n.collection||i.isArrayEmpty(n.collection.url)?a.EMPTY_STRING:n.collection.url,m=!n.view||i.isArrayEmpty(n.view.url)?a.EMPTY_STRING:n.view.url,f=!n.pagecollection||i.isArrayEmpty(n.pagecollection.options)?a.EMPTY_JSON_OBJECT:n.pagecollection.options,v=!n.collection||i.isArrayEmpty(n.collection.options)?a.EMPTY_JSON_OBJECT:n.collection.options,g=!n.view||i.isArrayEmpty(n.view.options)?a.EMPTY_JSON_OBJECT:n.view.options,h=[];if(i.isStringEmpty(m))console.log("view is not provided to load "+c+" panel");else{var w=new t(function(e,t){require([m],function(t){var n={};n.view=t,e(n)})});h.push(w)}if(i.isStringEmpty(p)){D=new t(function(e,t){var n={collection:{}};e(n)});h.push(D),console.log("collection is not provided to load "+c+" panel")}else{var D=new t(function(e,t){require([p],function(t){var n={};n.collection=t,e(n)})});h.push(D)}if(!i.isStringEmpty(d)){var C=new t(function(e,t){require([d],function(t){var n={};n.pageCollection=t,e(n)})});h.push(C)}Promise.all(h).then(function(t){if(t&&t.length>0&&t[0].view&&(t[1].collection||t[2].pageCollection)){var n=t[2]?t[2].pageCollection.createCollection():t[1].collection.createCollection(),d=t[2]?e.merge(f,o.options):e.merge(v,o.options);"close"===o.jsonConfig.main[0].config[0].originalState&&(o.renderContent({side:"middle",content:null}),o.mainview.hasClassName("hideMainView")||o.mainview.addClassName("hideMainView"),o.onResize()),void 0===o.request?o.request=0:o.request+=1,d.request=o.request;var p=new n([],d=e.merge(d,g)),m=t[0].view;p.fetch({onComplete:function(n){var i=n.options||a.EMPTY_JSON_OBJECT;if(void 0===i.request||i.request==o.request){var d;if(i.renderTo=l,i.triptychView=o,i.options?delete i.options:a.EMPTY_STRING,i.collectionOptions=v,i.collection=t[1]?t[1].collection:"",i.pageEnabled=!!t[2],i.pageEnabled&&(i.pageCollectionOptions=f,i.pageCollection=t[2].pageCollection),(i=e.merge(g,i)).events=i.contents&&i.contents.events?i.contents.events:{},m.parent&&m.parent===e.Class.View||m.parent&&m.parent.parent&&m.parent.parent===e.Class.View?(i.data=n,(d=new m(i)).render()):((d=new m).init(i),d.render(n)),"left"===c){var p=o.enoxTriptych.welcomePanelToggle.children[0],h=o.enoxTriptych.welcomePanelToggle;h.tooltipElt=new s({body:"collapse",position:"right",target:h}),o.enoxTriptych._modelEvents.subscribe({event:"triptych-panel-hidden"},function(e){"left"==e&&(p.classList.remove("fonticon-expand-left"),p.classList.add("fonticon-expand-right"),h.tooltipElt.setBody("expand"))}),o.enoxTriptych._modelEvents.unsubscribeAll({event:"triptych-leaving-mobile"}),o.enoxTriptych._modelEvents.subscribe({event:"triptych-panel-visible-size"},function(e){"left"==e.side&&(p.classList.remove("fonticon-expand-right"),p.classList.add("fonticon-expand-left"),h.tooltipElt.setBody("collapse"))}),u(o.enoxTriptych)}return r.loadingOFF(l),r.loadingOFF(),d}console.log("Multiple request is made. Please refresh."+o.request)},onFailure:function(e){throw new Error(i.getMessage({key:e.error}))}})}},function(e){throw new Error(i.getMessage({key:err.error}))})},d.prototype.renderContent=function(e){this.modelEvents.publish({event:"triptych-set-content",data:e})},d.prototype.resize=function(e){this.modelEvents.publish({event:"triptych-set-size",data:e});var t=this.mainview||widget.getElements(".mainView")[0];if(t&&t.hasClassName("hideMainView")){var n=this.triptychContainer.clientWidth||widget.body.clientWidth;if("left"===e.side){var o=n-this.enoxTriptych._options.left.originalSize;this.enoxTriptych._rightPanel.style.width=o+"px"}}},d.prototype.showLeftOrRightPanel=function(e){this.modelEvents.publish({event:"triptych-show-panel",data:e})},d}),define("DS/ENOXDocumentControlUI/V2/Actions/Favorite",["UWA/Core","DS/ENOXDocumentControlUI/DocEnhancers/Services/SettingsManagement","DS/ENOXDocumentControlUI/DocEnhancers/Services/Favorites","DS/ENOXDocumentControlUI/DocEnhancersUI/Utils/Helper","DS/ENOXDocumentControlUI/DocEnhancers/Constants/Constants","DS/ENOXDocumentControlUI/DocClientServices/Constants/Constants","i18n!DS/ENOXDocumentControlUI/assets/nls/ENOXDocumentControlUI"],function(e,t,n,o,i,a,r){"use strict";var s=function(e){return{id:"Favorite",dataElements:{docV2Private:!0,typeRepresentation:"functionIcon",icon:{iconName:"favorite-add",fontIconFamily:1},label:r.get("AddToFavorites"),tooltip:r.get("AddToFavorites"),position:"far",category:"information",value:function(t){t.options=e,s.execute(t)},visibleFlag:!1},updateForSelection:function(t,n){t({visibleFlag:1==e.getSelectedNodes().length}),1==e.getSelectedNodes().length&&t({visibleFlag:1==e.getSelectedNodes().length,label:e.getDocumentFromNodeModel(e.getSelectedNodes()[0]).myfavorites?r.get("RemoveFromFavorites"):r.get("AddToFavorites"),tooltip:e.getDocumentFromNodeModel(e.getSelectedNodes()[0]).myfavorites?r.get("RemoveFromFavorites"):r.get("AddToFavorites"),icon:{iconName:e.getDocumentFromNodeModel(e.getSelectedNodes()[0]).myfavorites?"favorite-delete":"favorite-add",fontIconFamily:1}})},execute:function(t){s.execute({options:e},t)}}};return s.execute=function(e,s){var c=s?s[0]:e.options.getSelectedNodes()[0],l=e.options.getDocumentFromNodeModel(c),d=l.myfavorites?"favorite-delete":"favorite-add",u=a.DOCUMENT_FAVORITE_LIST+t.getPlatformURLs().getTenantId(),p=[],m="",f=(l.id,void 0);l&&null==(f=l.title||l.name)&&l.dataelements&&(f=l.dataelements.title||l.dataelements.name),p.push(l);var v={name:u,favorites:p,protocol:"3DXContent",version:"1.0",source:"ENXWDOC_AP",onComplete:function(t){var n=c.getTreeDocument();n&&n.prepareUpdate(),m=f,"favorite-delete"===d?(c.updateOptions({data:{myfavorites:!1}}),m=r.RemovedFromFavorites.replace("{0}",m),"Favorites"===widget.getValue("CurrentActivity")&&n.removeRoot(c)):"favorite-add"===d&&(c.updateOptions({data:{myfavorites:!0}}),m=r.AddedToFavorites.replace("{0}",m)),n&&n.pushUpdate(),o.showNotification(i.INFO,"",m,"",!1),e.options.events.publish({event:"docv2-favorite-toggled",data:{nodeModel:c}})},onFailure:function(e){console.log("Failed to delete from favorites")}};"favorite-delete"===d?n.deleteFavorites(v):n.addFavorites(v)},s}),define("DS/ENOXDocumentControlUI/DocumentCommandsV2",["UWA/Core","DS/ENOXDocumentControlUI/V2/Actions/CreateNew","DS/ENOXDocumentControlUI/V2/Actions/Preview","DS/ENOXDocumentControlUI/V2/Actions/ShowProperties","DS/ENOXDocumentControlUI/V2/Actions/Favorite","DS/ENOXDocumentControlUI/V2/Actions/SortSwitcher","DS/ENOXDocumentControlUI/V2/Actions/ViewSwitcher"],function(e,t,n,o,i,a,r){"use strict";return e.Class.extend({init:function(e){this.commands={CreateNew:new t(e),SortSwitcher:new a(e),Preview:new n(e),ToggleFavorites:new i(e),ShowProperties:new o(e),ViewSwitcher:new r(e)}},commands:[],connectToWebUXToolbar:function(e){e.items.prepareUpdate(),e.items.getRoots().forEach(e=>{e.options.docV2Private&&e.options.extend&&e.options.extend(e)}),e.items.pushUpdate()},selectionChangedForWebUXToolbar:function(e){e.items.getRoots().forEach(e=>{e.options.docV2Private&&(e.options.grid.action=e,e.options.grid.data.argument&&(e.options.grid.data.argument.action=e),e.options.grid.data.value&&(e.options.grid.data.value.action=e),e.options.updateForSelection&&e.options.updateForSelection(function(t){e.updateOptions(t)}))})}})}),define("DS/ENOXDocumentControlUI/DocEnhancers/Utils/Credentials",["UWA/Core","DS/WAFData/WAFData","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/ENOXDocumentControlUI/DocEnhancers/Services/SettingsManagement","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","i18n!DS/ENOXDocumentControlUI/assets/nls/DocEnhancers"],function(e,t,n,o,i,a,r){"use strict";return function(){var e={preferredSecurityContext:void 0,serverPreferredSecurityContext:void 0,security_context_list:[],platform_list:[],notify:!0,init:function(e,t){var n=this;widget.addEvent("onPlatformIdChange",n.onPlatformIdChange,n),widget.addEvent("endEdit",n.onPreferenceEditDone,n),widget.addEvent("widget-title-needs-update",n.onTitleNeedsUpdate,n),a.setNotificationManager(i),n.initPlatform(function(i){o.getPlatformURLs().platformurls=i,widget.setValue("x3dPlatformId",i.platformId),n.initCredentials(function(t){o.addSetting("pad_security_ctx",t),widget.setValue("credentials",t),widget.setValue("xPref_CREDENTIAL",t),widget.setValue("tenantAware",!0),e(t)},t)},t)},initPlatform:function(e,t){var o=this;o.preferredPlatformId=widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",console.log("preferredPlatformId="+o.preferredPlatformId),o.nonOnPremisePlatforms=0,n.getPlatformServices({onComplete:function(n){if(null!=n)if(0!=n.length){var i=n.find(e=>e.platformId==o.preferredPlatformId);null==i&&(i=n[0],o.showNotification({level:"warning",title:r.get("PlatformChanged"),subtitle:r.get("PreferredPlatformNotAvailable",{platform:i.displayName}),sticky:!1}),console.log("Preferred Platform not available, using the first one")),o.platform_list=n,o.preferredPlatformId=i.platformId,o.preferredPlatform=o.platform_list.find(e=>e.platformId==o.preferredPlatformId),n.forEach(e=>{"OnPremise"!=e.platformId&&o.nonOnPremisePlatforms++}),e(o.preferredPlatform)}else t("ZeroPlatformsAvailable");else t("NoPlatformsAvailable")},onFailure:function(){t("FailedToGetPlatforms")}})},initCredentials:function(e,n){var o=this;if(o.preferredSecurityContext=widget.getValue("credentials"),console.log("preferredSecurityContext="+o.preferredSecurityContext),e){var i=o.preferredPlatform["3DSpace"]+"/resources/modeler/pno/person?current=true";i+="&select=preferredcredentials&select=collabspaces",i+="&tenant="+o.preferredPlatformId,t.authenticatedRequest(i,{method:"GET",type:"json",headers:{Accept:"application/json","Accept-Language":widget.lang},onComplete:function(t){o.username=t.name,o.serverPreferredSecurityContext=void 0,o.security_context_list=[];var n=t.preferredcredentials;if(n.collabspace&&n.role&&n.organization&&(o.serverPreferredSecurityContext=n.role.name+"."+n.organization.name+"."+n.collabspace.name),o.multiOrg=!1,t.collabspaces&&t.collabspaces.length>0){for(var i=void 0,a=0;a<t.collabspaces.length;a++)for(var r=0;r<t.collabspaces[a].couples.length;r++){var s=t.collabspaces[a].couples[r];null==i&&(i=s.organization.name),i!=s.organization.name&&(o.multiOrg=!0);var c=s.role.name+"."+s.organization.name+"."+t.collabspaces[a].name;t.collabspaces[a].title||(t.collabspaces[a].title=t.collabspaces[a].name),s.organization.title||(s.organization.title=s.organization.name),s.role.nls||(s.role.nls=s.role.name);var l=t.collabspaces[a].title+"  "+s.organization.title+"  "+s.role.nls,d=t.collabspaces[a].title+"  "+s.role.nls;o.security_context_list.push({value:c,withorg_nls:l,withoutorg_nls:d,collabspaceTitle:t.collabspaces[a].title})}o.serverPreferredSecurityContext||(console.log("No preferred credential on server, use the first one available"),o.serverPreferredSecurityContext=o.security_context_list[0].value)}if(!o.security_context_list.some(e=>e.value==o.preferredSecurityContext)){console.log("widget preferred credential no longer available, use server preferred credential"),o.serverPreferredSecurityContext&&(o.preferredSecurityContext=o.serverPreferredSecurityContext);o.security_context_list.find(e=>e.value==o.preferredSecurityContext)}o.addPreferences(),o.preferredPlatform.security_context_list=o.security_context_list,e(o.preferredSecurityContext)},onFailure:n})}},addPreferences:function(){var e=this;widget.addPreference({name:"x3dPlatformId",defaultValue:e.preferredPlatformId,type:0==e.nonOnPremisePlatforms?"hidden":"list",label:r.get("3DEXPERIENCEPlatform"),options:e.platform_list.map(function(e){return{label:e.displayName,value:e.platformId}}),onchange:"onPlatformIdChange",disabled:e.platform_list.length<2}),widget.addPreference({name:"credentials",defaultValue:e.preferredSecurityContext,type:"list",label:r.get("Credentials"),options:e.security_context_list.sort(function(t,n){return e.multiOrg?t.withorg_nls<n.withorg_nls?-1:t.withorg_nls>n.withorg_nls?1:0:t.withoutorg_nls<n.withoutorg_nls?-1:t.withoutorg_nls>n.withoutorg_nls?1:0}).map(function(t){return{label:e.multiOrg?t.withorg_nls:t.withoutorg_nls,value:t.value}})})},onPlatformIdChange:function(t,n){var o=this;"x3dPlatformId"==t&&widget.credentials==o&&o.preferredPlatformId!=n&&(o.preferredPlatformId=n,o.preferredPlatform=o.platform_list.find(e=>e.platformId==o.preferredPlatformId),o.notify=!1,e.initCredentials(function(){o.notify=!0},function(){}))},onPreferenceEditDone:function(e){var t=this;widget.credentials==t&&(e.submitted||(t.preferredSecurityContext=widget.getValue("credentials"),widget.setValue("xPref_CREDENTIAL",t.preferredSecurityContext),t.preferredPlatformId=widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",t.preferredPlatform=t.platform_list.find(e=>e.platformId==t.preferredPlatformId),t.security_context_list=t.preferredPlatform.security_context_list,t.addPreferences()))},showNotification:function(e){this.notify&&i.addNotif(e)},onTitleNeedsUpdate:function(e){widget.credentials==this&&widget.setTitle(e.selectionTitle)}};return e}}),define("DS/ENOXDocumentControlUI/V2/Data",["UWA/Core","UWA/Promise","DS/WAFData/WAFData","DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/DocumentManagement/DocumentManagement","DS/ENOXDocumentControlUI/V2/Constants","DS/DocumentCommonInfra/MaturityColors","DS/ENOXDocumentControlUI/V2/Tagger"],function(e,t,n,o,i,a,r,s){"use strict";const c={};return Object.freeze(c),e.Class.extend({documentServiceQueryParams:void 0,documentServiceReady:void 0,init:function(e){this.app=e,this.resetDocumentServiceQueryParams(),s.connect(e)},nextStarts:{},noMoreResults:[],getDataFromSearch:function(t,o,i){var r=this,l=t.requestId,d="";switch(t.type){case"MyDocuments":d='((flattenedtaxonomies:types/Document)  OR (flattenedtaxonomies:"types/CONTROLLED DOCUMENTS")) NOT ((policy:"Controlled Document Template") OR (policy:"Rendition Document Template") OR (policy:Version) OR (policy:ProxyItem)) AND owner:'+r.app.core.getUser().id;break;case"AllDocuments":d='((flattenedtaxonomies:types/Document)  OR (flattenedtaxonomies:"types/CONTROLLED DOCUMENTS")) NOT ((policy:"Controlled Document Template") OR (policy:"Rendition Document Template") OR (policy:Version) OR (policy:ProxyItem))';break;case"Favorites":if(null==t.physicalIds)return void require(["DS/ENOXDocumentControlUI/Utils/FavoriteManager"],function(e){e.loadFavorites(function(e){t.physicalIds=e.map(e=>e.id),r.getDataFromSearch(t,o,i)},function(){})});d="physicalid:("+t.physicalIds.join(" OR ")+")";break;case"specificPhysicalIds":d="physicalid:("+t.physicalIds.join(" OR ")+")"}t.searchQuery&&(d=t.searchQuery+" AND ( "+d+" )");var u={login:{"3dspace":{SecurityContext:r.app.core.getSecurityContext()}},label:widget.id+Date.now(),query:d,locale:null!=widget&&null!=widget.lang?widget.lang:"en",tenant:r.app.core.getTenantId(),source:["3dspace"],with_indexing_date:!0,with_nls:!1,with_synthesis:!0,with_synthesis_attribute:!1,select_predicate:["resourceid","ds6w:type","ds6w:policy"],refine:t.filters};if(t.orderby&&(u.order_by=t.orderby),t.orderField&&(u.order_field=t.orderField),e.is(t.startRow,"number")&&e.is(t.endRow,"number")&&(u.nresults=t.endRow-t.startRow),e.is(t.startRow,"number")&&(u.start=t.startRow),"specificPhysicalIds"==t.type&&(u.with_nls=!1,u.with_synthesis=!1,u.with_synthesis_attribute=!1),null!=t.physicalIds&&t.physicalIds.length>0&&(u.nresults=t.physicalIds.length),0!=t.startRow||null!=t.filters&&!e.equals(t.filters,c)){if(r.nextStarts[l]?(delete u.start,u.next_start=r.nextStarts[l]):r.nextStarts={},r.noMoreResults.includes(l))o(l,[]);else(m=new e.Promise(function(e,t){var o={method:a.POST,headers:{"content-type":a.ACCEPT_APPLICATION_JSON,Accept:a.ACCEPT_APPLICATION_JSON},data:JSON.stringify(u),onComplete:function(t){e(t)},onFailure:function(e,n,o){t(e)},type:"json"};n.authenticatedRequest(r.app.core.platformServices["3DSearch"]+"/search",o)})).then(function(e){var n=e,i={},a={},c=[];r.nextStarts[l]=n.infos.next_start,t.ignoreTagger||(n.facets?(r.applyNLSValuesToFacets(n.facets),s.setTags(n.facets)):s.setTags()),0==n.infos.nresults&&r.noMoreResults.push(l),n.results?(n.results.forEach(function(e){r.flattenAndAccumulate(e,a,c,i)}),o(l,Object.values(i))):o(l,Object.values(i))})}else{var p=new e.Promise(function(e,t){var o={method:a.POST,headers:{"content-type":a.ACCEPT_APPLICATION_JSON,Accept:a.ACCEPT_APPLICATION_JSON},data:JSON.stringify(u),onComplete:function(t){e(t)},onFailure:function(e,n,o){t(e)},type:"json"};n.authenticatedRequest(r.app.core.platformServices["3DSearch"]+"/recent",o)}),m=new e.Promise(function(e,t){var o={method:a.POST,headers:{"content-type":a.ACCEPT_APPLICATION_JSON,Accept:a.ACCEPT_APPLICATION_JSON},data:JSON.stringify(u),onComplete:function(t){e(t)},onFailure:function(e,n,o){t(e)},type:"json"};n.authenticatedRequest(r.app.core.platformServices["3DSearch"]+"/search",o)});e.Promise.all([p,m]).then(function(e){var n=e[0],i=e[1],a={},c={},d=[];n.results&&n.results.forEach(function(e){r.flattenAndAccumulate(e,c,d,a,t.physicalIds)}),r.nextStarts[l]=i.infos.next_start,"specificPhysicalIds"==t.type&&delete r.nextStarts[l],t.ignoreTagger||(i.facets?(r.applyNLSValuesToFacets(i.facets),s.setTags(i.facets)):s.setTags()),0==i.infos.nresults&&r.noMoreResults.push(l),i.results&&i.results.forEach(function(e){r.flattenAndAccumulate(e,c,d,a,t.physicalIds)}),o(l,Object.values(a))})}},flattenAndAccumulate:function(e,t,n,o,i){var a=this,r={},s=[];e.attributes.forEach(function(e){switch(e.name){case"resourceid":r.id=e.value,null==i||i.includes(r.id)||s.push(!1);break;case"type_icon_url":r.typeicon=e.value;break;case"preview_url":r.image=e.value;break;case"ds6w:what/ds6w:type":case"ds6w:type":a.app.core.supportedTypes.all.includes(e.value)||s.push(!1)}}),s.includes(!1)||(n.includes(r.id)||n.push(r.id),o[r.id]=r)},applyNLSValuesToFacets:function(t){var n={};t.forEach(e=>{if(e.sixw){var t=e.sixw.split("/").pop();n[t]||(n[t]=[]),n[t].push(e.object)}}),o.getNlsOfPropertiesValues(JSON.stringify(n),{tenantId:this.app.core.getTenantId(),lang:widget.lang,onComplete:function(n){t.forEach(t=>{if(t.sixw){var o=t.sixw.split("/").pop();e.is(n[o])&&e.is(n[o][t.object])&&(t.dispValue=n[o][t.object])}}),s.setTags(t)},onFailure:function(e){}})},resetDocumentServiceQueryParams:function(t){var n=this;n.documentServiceReady&&n.documentServiceReady.reject(),n.documentServiceReady=e.Promise.deferred(),n.documentServiceReady.promise.then(function(e){n.documentServiceQueryParams=e});var o=!1;if(t){var i=[];t.fields.forEach(e=>{n.documentServiceQueryParams&&!n.documentServiceQueryParams.fields.includes(e)&&(i.push(e),o=!0)}),n.documentServiceReady.resolve(t)}return o},getDataFromDocumentService:function(t,o,i,a){var s=this;if(0==o.length){if(e.is(i,"function"))return void i(t,[])}else{var c={};o.forEach(e=>{c[e.id]=e}),s.documentServiceReady.promise.then(function(){var l=s.app.core.getSecurityContext();0!==l.indexOf("ctx::")&&(l="ctx::"+l),n.authenticatedRequest(s.app.core.platformServices["3DSpace"]+"/resources/v1/modeler/documents",{method:"POST",type:"json",headers:{Accept:"application/json","Accept-Language":widget.lang,SecurityContext:encodeURIComponent(l)},data:"$include="+s.documentServiceQueryParams.include.join()+"&$fields="+s.documentServiceQueryParams.fields.join()+"&$ids="+o.map(e=>e.id).join(),onComplete:function(n){if(n.success){if(!Array.isArray(n.data))return void(e.is(a,"function")&&a(n));var o=[],s=[];n.data.forEach(function(e){o.includes(e.dataelements.policy)||(o.push(e.dataelements.policy),s.push(e)),c[e.id].typeicon&&(e.dataelements.typeicon=c[e.id].typeicon),c[e.id].image&&(e.dataelements.image=c[e.id].image)}),r.fetchPolicies(s,function(e,t,n){}),e.is(i,"function")&&i(t,n.data)}},onFailure:function(){e.is(a,"function")&&a(t,response)}})})}},getDataFromDocumentServiceFromDocIds:function(t,o,i,a){var s=this;s.documentServiceReady.promise.then(function(){var c=s.app.core.getSecurityContext();0!==c.indexOf("ctx::")&&(c="ctx::"+c),n.authenticatedRequest(s.app.core.platformServices["3DSpace"]+"/resources/v1/modeler/documents",{method:"POST",type:"json",headers:{Accept:"application/json","Accept-Language":widget.lang,SecurityContext:encodeURIComponent(c)},data:"$include="+s.documentServiceQueryParams.include.join()+"&$fields="+s.documentServiceQueryParams.fields.join()+",indexedImage,indexedTypeicon&$ids="+o.join(),onComplete:function(n){if(n.success){if(!Array.isArray(n.data))return void(e.is(a,"function")&&a(n));var o=[],s=[];n.data.forEach(function(e){o.includes(e.dataelements.policy)||(o.push(e.dataelements.policy),s.push(e))}),r.fetchPolicies(s,function(e,t,n){}),e.is(i,"function")&&i(t,n.data)}},onFailure:function(){e.is(a,"function")&&a(t,response)}})})}})}),define("DS/ENOXDocumentControlUI/DocEnhancers/Services/PlatformServices",["UWA/Core","UWA/Promise","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/ENOXDocumentControlUI/DocEnhancers/Services/SettingsManagement","DS/ENOXDocumentControlUI/DocEnhancers/Constants/Constants"],function(e,t,n,o,i){"use strict";var a=function(){};return a.prototype.initializePlatform=function(e){var t=this;n.getPlatformServices({onComplete:function(n){if(null===n){n.options=e,(0,e.onFailure)("cannot retrieve platform data")}else{for(var a=i.EMPTY_JSON_OBJECT,r=widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",s=0;s<n.length;s++)n[s].platformId===r&&(t.platformurls=a.platformurls=n[s]);o.addSetting(i.PLATFORM_SERVICES,t),widget.platformurls=t.platformurls,a.options,(0,e.onComplete)(a)}},onFailure:function(t){(0,e.onFailure)(t)}})},a.prototype.get3DSpaceURL=function(){return this.getURL("3DSpace")},a.prototype.get3DSwymURL=function(){return this.getURL("3DSwym")},a.prototype.getTenantId=function(){return this.getURL("platformId")},a.prototype.getURL=function(e){return this.platformurls[e]||""},a.prototype.getCurrentUser=function(t){e.is(o.getSetting(i.CURRENT_USER),"object")?t.onComplete(o.getSetting(i.CURRENT_USER)):n.getUser({onComplete:function(e){o.addSetting(i.CURRENT_USER,e),t.onComplete(e)},onFailure:t.onFailure})},a}),define("DS/ENOXDocumentControlUI/V2/App",["UWA/Class","DS/ENOXDocumentControlUI/V2/Core","DS/ENOXDocumentControlUI/V2/Collection","DS/ENOXDocumentControlUI/V2/Data","DS/Notifications/NotificationsManagerViewOnScreen","DS/Notifications/NotificationsManagerUXMessages"],function(e,t,n,o,i,a){"use strict";return UWA.Class.extend({init:function(e){var t=this;t.events=e.events,null==t.jobs&&require(["DS/DocumentCommands/Jobs"],function(e){t.jobs=new e(t)}),null==t.progressPane&&require(["DS/DocumentCommands/ProgressPane"],function(e){t.progressPane=new e(t),t.progressPane.inject(widget.body)});var n={};t.events.addSingletonEventListener=function(e,o,i){n[e]&&t.events.unsubscribe(n[e]),n[e]=t.events.addEventListener(o,i)},t.events.removeSingletonEventListener=function(e){n[e]&&t.events.unsubscribe(n[e]),n[e]=void 0,delete n[e]}},initialize:function(){var e=this;e.initialized||(e.core=new t(e),e.core.init(),e.collection=new n(e),e.data=new o(e),e.initialized=!0,e.core.master.addEvent("onChange:activity",function(t,n){t.get("reload")&&e.partialRender()}))},partialRender:function(){var e=this;e.initialize(),null==e.centerPane&&require(["DS/ENOXDocumentControlUI/V2/Views/CenterPane"],function(t){e.centerPane=new t(e),e.centerPane.build(widget.getElement(".triptych-modal-main"))})},showNotification:function(e,t,n,o,r,s){var c={level:e,title:t,subtitle:n,message:o,sticky:r,allowUnsafeHTML:s||!1};window.notifs=a,i.setNotificationManager(window.notifs),i.setStackingPolicy(5),window.notifs.addNotif(c)},addDocumentsToList:function(e,t){this.collection.addDocumentsToListByIds(e.map(e=>e.id),t)},addDocumentsToListByIds:function(e,t){this.collection.addDocumentsToListByIds(e,t)},make3DXContent:function(e){var t=this,n={protocol:"3DXContent",version:"2.0",source:UWA.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId,widgetId:widget.id,data:{items:[]}};return e.forEach(function(e){n.data.items.push({envId:t.core.getTenantId(),serviceId:"3DSpace",contextId:t.core.getSecurityContext(),objectId:e.options.data.id,objectType:e.options.data.type,displayName:e.options.label})}),n}})}),define("DS/ENOXDocumentControlUI/ENOXDocumentControl",["UWA/Core","UWA/Promise","DS/CoreEvents/ModelEvents","DS/ENOXDocumentControlUI/DocEnhancers/Services/PlatformServices","DS/ENOXDocumentControlUI/DocEnhancers/Services/SettingsManagement","DS/ENOXDocumentControlUI/DocEnhancers/Services/Resources","DS/ENOXDocumentControlUI/DocEnhancers/Constants/Constants","DS/ENOXDocumentControlUI/DocEnhancers/Services/WebServices","DS/ENOXDocumentControlUI/DocEnhancers/Utils/Helper","DS/ENOXDocumentControlUI/DocEnhancers/Utils/Credentials","DS/ENOXDocumentControlUI/DocConfigTriptychUI/Views/ENOXConfiguredTriptychView","DS/ENOXDocumentControlUI/DocEnhancersUI/Constants/Constants","DS/ENOXDocumentControlUI/Utils/LinkOpener","DS/ENOXDocumentControlUI/V2/App","DS/Windows/ImmersiveFrame","text!DS/ENOXDocumentControlUI/assets/configurations/TriptychConfiguration.json","i18n!DS/ENOXDocumentControlUI/assets/nls/ENOXDocumentControlUI","css!DS/ENOXDocumentControlUI/ENOXDocumentControlUI.css"],function(e,t,n,o,i,a,r,s,c,l,d,u,p,m,f,v,g){"use strict";window.scrollIntoViewOriginal=window.Element.prototype.scrollIntoView,window.Element.prototype.scrollIntoView=function(t){e.is(t,"object")&&"center"==t.block?window.scrollIntoViewOriginal.call(this,{behavior:"smooth",block:"nearest",inline:"start"}):window.scrollIntoViewOriginal.call(this,t)};var h=function(){};return h.prototype.onLoad=function(){var e=widget.body;e.empty(),new t(function(e,t){h.prototype.init(e)}).then(function(t){t.renderTo=e,t.render()})},h.prototype.init=function(i){var a=this;a._name="ENOXDocuments",a.modelEvents=new n,a.modelEvents.ownedBy="ENOXDocumentControl",p.processX3DContentId();new t(function(e,t){var n={onComplete:e,onFailure:t};o.prototype.initializePlatform(n),o.prototype.getCurrentUser({onComplete:function(e){console.log("User info fetched")},onFailure:function(e){console.error("Failed to load user info",e)}})}).then(function(e){return new t(function(e,t){widget.credentials=new l,widget.credentials.init(function(t){e(t)},function(){t()})})}).then(function(n){return new t(function(t,n){!function(t){var n=JSON.parse(v),o=t.resolve,i=t.reject;t=e.merge(t,n.left[0].collection.options),require([n.left[0].collection.url],function(n){new(n.createCollection())([],t).fetch({onComplete:function(e){var t=e._models[0]._attributes.WelcomePanelActivities.activities,n=(e=[],t[0].id);t[0].actions.forEach(function(t){var o={label:t.text,value:n+"_"+t.id};e.push(o)});var i=widget.getValue("welcome");widget.addPreference({name:"welcome",type:u.LIST,label:g.Welcome,defaultValue:i||t[0].actions[0].id,options:e}),c.isStringEmpty(i)&&widget.setValue("welcome","AccessYourWork_MyDocuments"),o(e)},onFailure:function(t){console.log(t),e.is(i,"function")&&i(t)}})})}({resolve:t,reject:n})})}).then(function(e){if(require(["DS/MSFDocumentManagement/WidgetIntegration"],function(e){widget.MSFDocumentClient=e,widget.MSFDocumentClient.ConnectWidgetWithMSF()}),require(["DS/DocumentCommands/Helper"],function(e){e.IsWebEditionAvailable().then(()=>{})}),i(a),widget.propertiesComponent)try{widget.propertiesComponent.destroy()}finally{widget.propertiesComponent=void 0}if(widget.previewComponent2)try{widget.previewComponent2.destroy()}finally{widget.previewComponent2=void 0}widget.app=new m({events:a.modelEvents})},function(e){console.log(e)})},h.prototype.render=function(){var t=this,n={},o=widget.documentContainer=new e.Element("div",{class:"documents-container",styles:{width:"100%",height:"100%"}});if(t.renderTo){var i=widget.immersiveFrame=new f;i.setContentInBackgroundLayer(o),i.reactToPointerEventsFlag=!1,i.inject(t.renderTo)}function a(){widget.setValue("DocumentToolbarV2",!0),n.renderTo=o,n.configurations="DS/ENOXDocumentControlUI/assets/configurations/TriptychConfiguration.json",n.modelEvents=t.modelEvents;var e=new d;e.init(n),e.buildview(),h.configTriptychView=e}return widget.openPreview?p.openPreview(widget.documentContainer,t.modelEvents,function(){a(),widget.app.initialize()}):(a(),widget.app.initialize()),o},h.prototype.onResize=function(){h.configTriptychView.onResize()},h});