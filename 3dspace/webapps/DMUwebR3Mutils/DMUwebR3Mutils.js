/*!  Copyright 2021 Dassault Systemes. All rights reserved. */
define("DS/DMUwebR3Mutils/DMUwebR3MwidgetUtils",["DS/WAFData/WAFData","DS/PlatformAPI/PlatformAPI","i18n!DS/DMUwebR3Mutils/assets/nls/DMUwebR3Mutils.json"].concat([]),function(t,e,i){"use strict";var n,o,a,r,s,u,l=[];function c(){return n&&n.lang||"en"}function d(){if(!n)throw new Error("App init not done");return a||(a=n.getValue("x3dPlatformId")),a}function f(){if(!n)throw new Error("App init not done");return r||(r=n.getValue("xPref_CREDENTIAL")),"ctx::"+r}function p(t){var e,i=d();if(!Array.isArray(o))throw new Error("Platform services not initialize yet");return o.some(function(n){if(n&&n.platformId===i)return e=n[t]}),e}function m(){return p("3DSpace")}function g(e){let i=m();if(!i)return void e.onCompleted(!1);let o=new Promise(function(t){require(["DS/ENOXWidgetPreferences/js/ENOXWidgetPreferences"].concat([]),function(e){e.addCredentialPreferenceToWidget({usePreferredCredentials:!0},2).then(function(){f();let e=n.getPreferences(),i=[];e.length>1&&"xPref_CREDENTIAL"===e[0].name&&(i.push(e[1]),i.push(e[0]),n.setPreferences(i)),t(!0)})},t.bind(null,!1))}),a=new Promise(function(e){i+="/resources/modeler/pno/person?current=true&select=preferredcredentials",t.authenticatedRequest(i,{method:"GET",type:"json",headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":c()},onComplete:function(t){t&&t.preferredcredentials?(s=t.preferredcredentials.organization,e(Boolean(s))):e(!1)},onFailure:function(){e(!1)}})});Promise.all([o,a]).then(function(t){e.onCompleted(t[0]&&t[1])})}return Object.freeze({init:function(t){return n?Promise.resolve():new Promise(function(e){n=t.widget,u=n.id+"_R3M_",d(),f(),n.setPreferences([]),require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(r){r.getPlatformServices({onComplete:function(s){r.getAppInfo({appId:n.getValue("x3dAppId"),onComplete:function(r){if(o=s,r.tenantAware){o=[];for(var u=0;u<r.platforms.length;++u)for(var l=0;l<s.length;++l)if(s[l].platformId===r.platforms[u].id){o.push(s[l]);break}}if(o&&o.length){var c=d();o.some(function(t){return t.platformId===c})||(a=c="",o.length&&(n.setValue("x3dPlatformId",o[0].platformId),c=d())),c&&o.length>1&&n.addPreference({name:"x3dPlatformId",type:"list",label:i.x3dPlatformId,options:o.map(function(t){return{label:t.displayName,value:t.platformId}}),defaultValue:c}),t.onCompletedPlatformServices({success:Boolean(c)||"tenant"}),g({onCompleted:()=>{t.onCompletedSecurityContext(),e()}})}else t.onCompletedPlatformServices({success:"platformServices"})},onFailure:function(){t.onCompletedPlatformServices({success:"getAppInfo"}),e()}})},onFailure:function(){t.onCompletedPlatformServices({success:"getPlatformServices"}),e()}})}),n.addEvent("endEdit",()=>{let t=n.getValue("x3dPlatformId"),e=t!==a;if(a=t,r=n.getValue("xPref_CREDENTIAL"),e){let t=new Promise(t=>{setTimeout(()=>g({onCompleted:t}),0)});l.forEach(e=>e(t))}})})},getWidget:function(){return n},getWidgetId:function(){return n.id},getWidgetAppId:function(){return n.getValue("x3dAppId")},getLang:c,getUserLogin:function(){var t=e.getUser();return t?t.login:""},getUserOrganizationName:function(){return s?s.name:""},getPlatformId:d,getPlatformIdServices:function(){return JSON.parse(JSON.stringify(o.filter(t=>t.platformId===a)))},get3DSpaceUrl:m,get3DSearchUrl:function(){return p("3DSearch")},get3DSwymUrl:function(){return p("3DSwym")},getR2VPlatformUrl:function(){return p("r2vsurvey")},getSecurityContext:f,onTenantModified:function(t){l.push(t)},perfoMark:function(t){window.top.performance.mark(u+t)},perfoMeasure:function(t,e){window.top.performance.measure(u+(e||t),u+t)}})}),define("DS/DMUwebR3Mutils/DMUwebR3McancelablePromise",[],function(){"use strict";return function(t){let e=!1,i=()=>{e=!0};const n=new Promise((n,o)=>{i=(()=>{e||n("Promise cancelled")}),e?i():t(n,o)});return n.then(t=>(e=!0,t)),n.catch(t=>(e=!0,t)),{promise:n,cancel:i}}}),define("DS/DMUwebR3Mutils/DMUwebR3MserverRequests",["DS/WAFData/WAFData","DS/DMUwebR3Mutils/DMUwebR3MwidgetUtils","DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/DMUwebR3Mutils/DMUwebR3McancelablePromise","UWA/Core","i18n!DS/DMUwebR3Mutils/assets/nls/DMUwebR3Mutils.json"].concat([]),function(t,e,i,n,o,a){"use strict";let r,s,u,l,c,d=["ds6w:label","ds6w:identifier","ds6w:type","ds6w:status","ds6wg:dmuvalidationvalidation.v_validationstate","bo.SIMItfSimulation.V_ValidationState","ds6wg:simitfsimulation.v_itf_executionstatus","ds6w:description","ds6w:responsible","ds6w:responsibleuid","ds6w:originator","originator","ds6w:organizationResponsible","ds6w:modified","ds6w:created","ds6w:project"],f=["ds6w:label","ds6w:identifier","ds6w:type","ds6w:status","ds6wg:dmuvalidationcheck.v_validation_checkstate","bo.SIMItfSimulation.V_ValidationState","ds6w:description","ds6w:responsible","ds6w:responsibleuid","ds6w:originator","originator","ds6w:organizationResponsible","ds6w:modified","ds6w:created","ds6w:project"],p=["icon"],m=200,g={"ds6w:label":"title","ds6w:identifier":"name","ds6w:type":"type","ds6w:status":"maturity","ds6wg:dmuvalidationvalidation.v_validationstate":"validState","ds6wg:dmuvalidationcheck.v_validation_checkstate":"validState","bo.SIMItfSimulation.V_ValidationState":"validState","ds6wg:simitfsimulation.v_itf_executionstatus":"executionstate","ds6w:description":"description","ds6w:responsible":"owner","ds6w:responsibleuid":"ownerid","ds6w:originator":"originator",originator:"originatorid","ds6w:organizationResponsible":"organization","ds6w:modified":"dateModif","ds6w:created":"dateCreat","ds6w:project":"collabSpace",type_icon_url:"icon",resourceid:"id",physicalid:"id"},v=1,h=0,_=[];function y(t){return t+"-"+e.getUserLogin()+"-"+Date.now()}function S(t){return new Promise(function(n){i.getNlsOfPropertiesValues(JSON.stringify(t),{tenantId:e.getPlatformId(),lang:e.getLang(),apiVersion:"R2019x",onComplete:function(e){Object.keys(e).forEach(function(t){s[t]=Object.assign(s[t]||{},e[t])}),Object.keys(t).forEach(function(e){t[e].forEach(t=>{s[e][t]||(s[e][t]=t)})}),t["ds6w:status"]&&Object.keys(s["ds6w:status"]).forEach(t=>{t.search(".DEFAULT")>-1&&(s["ds6w:status"][t]="")}),n()},onFailure:function(){n()}})})}function w(t){if(t){if(l.hasOwnProperty(t))return l[t];var i=e.get3DSwymUrl();return l[t]=i?i+"/api/user/getpicture/login/"+t+"/format/mini":""}}function P(t,e){var i={};return Object.keys(t).forEach(function(n){var o=g[n];i[o]=t[n],s[n]&&(s[n].hasOwnProperty([t[n]])?i[o+"Disp"]=s[n][t[n]]:(e[n]||(e[n]={values:[],objects:[]}),-1===e[n].values.indexOf(t[n])&&e[n].values.push(t[n]),e[n].objects.push(i)))}),i.ownerImg=w(i.ownerid),i.originatorImg=w(i.originatorid),i}function b(t,e){return t.map(function(t){return P(t,e)})}function M(t,e){if(e)return e.validState="2"===t?"Passed":"3"===t?"Failed":"InProgress",e.validStateDisp=a["validState"+e.validState],e}function I(i){var n={Accept:"application/json","Content-Type":"application/json"};return i.securityContext&&(n.SecurityContext=i.securityContext),t.authenticatedRequest(i.url+"?tenant="+e.getPlatformId()+(i.securityContext?"&SecurityContext="+i.securityContext:""),{method:i.method,type:"json",headers:n,data:JSON.stringify(i.data),timeout:i.timeout,onComplete:i.onComplete,onFailure:i.onFailure,onTimeout:i.onTimeout||i.onFailure})}function D(t){return new Promise(function(i){I({url:e.get3DSpaceUrl()+"/cvservlet/navigate",securityContext:e.getSecurityContext(),method:"POST",data:t,onComplete:function(t){i(t)},onFailure:function(){i({})}})})}function E(t){let i=Object.keys(t);return i.length?new Promise(t=>{I({url:e.get3DSpaceUrl()+"/cvservlet/navigate",securityContext:e.getSecurityContext(),method:"POST",data:function(t){return{input_physical_ids:t,label:y("R3MwebTic"),primitives:[{navigate_from_rel:{id:1,filter:{rel_type:["Reference Document"],bo_type:["Issue"]}}}],patterns:{issue:[{id:1}]},fileAttributes:p,attributes:f,version:3}}(i),onComplete:t,onFailure:function(){t()}})}):Promise.resolve()}const x=i=>new Promise(n=>{"DMUValidationValidation"===i.input_object["ds6w:type"]||"Markup"===i.input_object["ds6w:type"]?function(i){if(i){var n=o.clone(i.config,!1);n.onComplete=i.onSuccess,n.onFailure=i.onFailure,n.method=n.verb,n.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":e.getLang(),SecurityContext:e.getSecurityContext()},"object"==typeof n.data&&(n.data=JSON.stringify(n.data));var a=[];a.push("securityContext"),a.push(e.getSecurityContext()),a.push("tenant"),a.push(e.getPlatformId()),t.authenticatedRequest(e.get3DSpaceUrl()+"/"+i.url,n)}}({url:"resources/validation/service/getAll",config:{verb:"POST",data:{sValidationId:i.input_object.physicalid}},onSuccess:function(t){var e=JSON.parse(t);n(e)},onFailure:function(){n()}}):n()});function V(t){return new Promise(function(i){I({url:e.get3DSpaceUrl()+"/cvservlet/navigate",securityContext:e.getSecurityContext(),method:"POST",data:t,onComplete:function(t){var e={},n={},o=[],a=[],r=[],u={};t.result.forEach(function(t){var i=t.input_object.physicalid;e[i]={},["context","highlight","check","issue","ca"].forEach(function(o){t.outputs[o]&&(e[i][o]=b(t.outputs[o],n))}),(e[i].highlight||[]).forEach(t=>{u[t.id]=t}),(e[i].check||[]).forEach(t=>M(t.validState,t)),(t.outputs.checked||[]).forEach(function(t){let o=t.owner.physicalid;(e[i].check||[]).some(e=>{if(!e.children)return e.id===o?(e.children=b(t.elements,n),!0):void 0})}),t.outputs.validatedPath&&(e[i].validatedPath=[],t.outputs.validatedPath.forEach(function(t){if(!t.elements.length)return;let n=t.elements[0]["ds6w:type"],r="VPMInstance"===n||"VPMRepInstance"===n;e[i].validatedPath[t.app_index||t.sr_id]=t.elements.map(function(t,e){return r&&(0===e&&-1===o.indexOf(t.physicalid)&&o.push(t.physicalid),-1===a.indexOf(t.physicalid)&&a.push(t.physicalid)),t.pid=t.physicalid,t.type=t["ds6w:type"],t}),e[i].validatedPath[t.app_index||t.sr_id].instancePath=r}),e[i].validatedPath=e[i].validatedPath.filter(function(t){return t&&t.length}),e[i].validatedPath.length&&r.push(e[i])),t.outputs.prd&&(e[i].context=(e[i].context||[]).concat(b(t.outputs.prd,n)))});const l=[];var c;t.result.map(t=>{void 0===t.outputs.context&&l.push(x(t))}),Promise.all([o.length?D((c=o,{input_physical_ids:c,label:y("R3MwebValidFrom"),primitives:[{navigate_from_rel:{id:1}}],patterns:{root:[{id:1}]},fileAttributes:p,attributes:f,version:3})):Promise.resolve(),a.length?D(function(t){return{input_physical_ids:t,label:y("R3MwebValidTo"),primitives:[{navigate_to_rel:{id:1}}],patterns:{ref:[{id:1}]},fileAttributes:p,attributes:f,version:3}}(a)):Promise.resolve(),E(u),0===l.length?Promise.resolve():Promise.all(l)]).then(function(t){var i={},o={},a={};(t[0]&&t[0].result||[]).forEach(function(t){i[t.input_object.physicalid]={pid:t.outputs.root[0].physicalid,type:t.outputs.root[0]["ds6w:type"]},a[t.outputs.root[0].physicalid]||(a[t.outputs.root[0].physicalid]=t.outputs.root[0])}),(t[1]&&t[1].result||[]).forEach(function(t){o[t.input_object.physicalid]={pid:t.outputs.ref[0].physicalid,type:t.outputs.ref[0]["ds6w:type"]},a[t.outputs.ref[0].physicalid]||(a[t.outputs.ref[0].physicalid]=t.outputs.ref[0])}),r.forEach(function(t){t.validated=[],t.validatedPath.forEach(function(e,r){let s;if(e.instancePath){s=P(a[o[e[e.length-1].pid].pid],n);var u=[i[e[0].pid]];e.forEach(function(t){u.push(t),u.push(o[t.pid])}),s.validatedPath=u}else(s=P(e[e.length-1],n)).validatedPath=e;t.validated[r]=s,s.pid=s.id,s.id=String(v++)}),delete t.validatedPath}),(t[2]&&t[2].result||[]).forEach(t=>{let e=t.input_object.physicalid;["issue","ca"].forEach(i=>{t.outputs[i]&&(u[e][i]=b(t.outputs[i],n))})}),(t[3]||[]).forEach(t=>{void 0!==t&&void 0!==t.children&&t.children.forEach(i=>{i&&"DMUValidationContext"===i.type&&void 0===e[t.id].context&&(e[t.id].context=[{id:i.contextId,serviceId:i.serviceID}],e[t.id].validated=[{id:i.contextId,serviceId:i.serviceID}])})})}).then(function(){Object.keys(n).length?new Promise(function(){var t={};Object.keys(n).forEach(function(e){t[e]=n[e].values}),S(t).then(function(){Object.keys(n).forEach(function(t){n[t].objects.forEach(function(e){var i=g[t];e[i+"Disp"]=s[t][e[i]]})}),i(e)})}):i(e)})},onFailure:function(){i({})}})})}function C(t){var i;I({url:e.get3DSpaceUrl()+"/cvservlet/navigate",securityContext:e.getSecurityContext(),method:"POST",timeout:6e4,data:(i=t.ctxIDs,{input_physical_ids:i,label:y("R3MPIMwebItfCtx"),primitives:[{navigate_to_sr:{id:1,filter:{semantics:["6"],role:["198"]},mode:"last"}},{navigate_to_rel:{id:2}}],patterns:{ms:[{id:1}]},attributes:["ds6w:type","bo.PLMPIMMetricReference.V_Itf_Type","bo.PLMPIMMetricReference.V_Itf_Analysis","bo.SIMItfContextOfInterference.V_Context_Validity_Status"],fileAttributes:[],version:3}),onProgress:t.onProgress,onComplete:t.onComplete,onFailure:t.onFailure})}var R,O,A,j=(R=[],O=0,A=function(t,e){O--,j(),e(t)},function(t){var e,i;t&&R.push(t),R.length&&O<5&&(O++,e=R.shift(),(i=o.clone(e,!1)).onComplete=function(t){A(t,e.onComplete)},i.onFailure=function(t){A(t,e.onFailure)},i.onTimeout=function(t){A(t,e.onTimeout||e.onFailure)},C(i))});function L(t,i,n){var o,a={simPid:t,nbTotalItf:0,nbOK:0,nbKO:0};I({url:e.get3DSpaceUrl()+"/cvservlet/navigate",securityContext:e.getSecurityContext(),method:"POST",timeout:6e4,data:(o=t,{input_physical_ids:o,label:y("R3MPIMwebIsr"),primitives:[{navigate_to_rel:{id:1,filter:{bo_type:["dsc_Result_Category_Ref"]}}},{navigate_to_rel:{id:2}}],patterns:{itfCtxt:[{id:1},{id:2}]},fileAttributes:[],attributes:["ds6wg:simitfsimulation.v_itf_executionstatus"],version:3}),onComplete:function(e){let o=e.result[0];if(!o||0===Object.keys(o.outputs).length)return o.input_object["ds6wg:simitfsimulation.v_itf_executionstatus"]&&(a.ExecStatus=o.input_object["ds6wg:simitfsimulation.v_itf_executionstatus"]),void i({status:"success",output:[a]});let r=(o.outputs.itfCtxt||[]).map(function(t){return t.physicalid}),s=[];a.ExecStatus=o.input_object["ds6wg:simitfsimulation.v_itf_executionstatus"],0===r.length&&i({status:"success",output:[a]}),a.nbTotalItf=r.length;var u=Math.floor((r.length-1)/500)+1,l=0,c=[],d=!1;for(;l<u&&!d;)j({ctxIDs:r.slice(500*l,500*(l+1)),onComplete:function(e){var o,u=[];e.result.forEach(function(t){if(u.push(t.input_object.physicalid),t.input_object&&"1"!==t.input_object["bo.SIMItfContextOfInterference.V_Context_Validity_Status"])a.nbTotalItf--;else if(t.outputs&&t.outputs.ms&&1===t.outputs.ms.length){if(s.indexOf(t.outputs.ms[0].physicalid)>-1)return void a.nbTotalItf--;s.push(t.outputs.ms[0].physicalid);let e=t.outputs.ms[0];"5"===e["bo.PLMPIMMetricReference.V_Itf_Type"]||"6"===e["bo.PLMPIMMetricReference.V_Itf_Type"]?a.nbTotalItf--:"1"===e["bo.PLMPIMMetricReference.V_Itf_Analysis"]?a.nbOK++:"2"===e["bo.PLMPIMMetricReference.V_Itf_Analysis"]&&a.nbKO++}}),o={itfIDs:u},d&&i({status:"failure",simIds:[t]}),c.push.apply(c,o.itfIDs),c.length===r.length?i({status:"success",output:[a]}):n(t,r.length,c.length)},onFailure:function(){i({status:"failure",simIds:[t]}),d=!0}}),l++},onFailure:function(){i({status:"failure",simIds:[t]})}})}function T(t){return new Promise(function(i){I({url:e.get3DSpaceUrl()+"/resources/dictionary/getTypeInfo",method:"POST",data:[t],onComplete:function(e){Object.keys(e).forEach(function(e){-1===u[t].indexOf(e)&&u[t].push(e)}),i()},onFailure:i})})}function U(){return c?Promise.resolve():(l={},r={},s={"ds6w:type":{},"ds6w:status":{},"ds6wg:dmuvalidationvalidation.v_validationstate":{}},u={DMUValidationValidation:["DMUValidationValidation"],SIMItfSimulation:["SIMItfSimulation"],Markup:["Markup"],DesignSight:["DesignSight"]},Promise.all([T("DMUValidationValidation"),T("SIMItfSimulation"),new Promise(function(t){i.getResourcesInfo(d.join(","),{tenantId:e.getPlatformId(),lang:e.getLang(),apiVersion:"R2019x",onComplete:function(e){(e||[]).forEach(function(t){r[g[t.curi]]=t.label}),r.validState=a.validState,r.analysisState=a.analysisState,t(r)},onFailure:function(){d.forEach(function(t){r[g[t]]=t}),t(r)}})}),S({"ds6w:type":["SIMItfSimulation","DMUValidationValidation","Markup","VPMReference","Requirement","DMUValidationExposedPresentation","Member List","Drawing","ENOStrRefinementSpecification"],"ds6w:status":["VPLM_SMB_Evaluation.PRIVATE","VPLM_SMB_Evaluation.IN_WORK","VPLM_SMB_Evaluation.FROZEN","VPLM_SMB_Evaluation.RELEASED","VPLM_SMB_Evaluation.OBSOLETE","VPLM_SMB_Definition.PRIVATE","VPLM_SMB_Definition.IN_WORK","VPLM_SMB_Definition.FROZEN","VPLM_SMB_Definition.RELEASED","VPLM_SMB_Definition.OBSOLETE"]})]).then(function(){c=!0}))}e.onTenantModified(()=>{c=!1,U().then(()=>_.forEach(t=>t()))});var k=Object.create({}),F=Object.getPrototypeOf(k);return Object.defineProperty(F,"_NB_SEARCH_RESULTS",{get:()=>m,set:t=>{m=t}}),F.getColumnsNls=function(){return U().then(function(){return r})},F.getRvwTypes=function(){return[].concat(u.DMUValidationValidation)},F.getIsrTypes=function(){return[].concat(u.SIMItfSimulation)},F.getMkpTypes=function(){return[].concat(u.Markup)},F.getMsrTypes=function(){return[].concat(u.DesignSight)},F.getMaturityNlsValue=(t=>s["ds6w:status"][t]||""),F.getValidStateNlsValue=(t=>a["validState"+t]),F.getAnalysisStateNlsValue=(t=>a["analysisState"+t]),F.updateCheckStateValue=M,F.search=function(t,i){let o=[],r=new n(function(n){if(h++,!(t.rvw||t.isr||t.mkp||t.msr))return i({},0),void n();!function r(s,u,l){var c={query:function(t){var i="(";return i+=t.mkp?'flattenedtaxonomies:"types/Markup"':"",t.isr&&i.length>1&&(i+=" OR "),i+=t.isr?'flattenedtaxonomies:"types/SIMItfSimulation"':"",t.rvw&&i.length>1&&(i+=" OR "),i+=t.rvw?'flattenedtaxonomies:"types/DMUValidationValidation"':"",t.msr&&i.length>1&&(i+=" OR "),i+=t.msr?'flattenedtaxonomies:"types/DesignSight"':"",i+=")",t.released||(i=i.concat(" AND NOT ([ds6w:status]:VPLM_SMB_Evaluation.RELEASED OR [ds6w:status]:VPLM_SMB_Evaluation_MajorRev.RELEASED)")),t.obsolete||(i=i.concat(" AND NOT ([ds6w:status]:VPLM_SMB_Evaluation.OBSOLETE OR [ds6w:status]:VPLM_SMB_Evaluation_MajorRev.OBSOLETE)")),0===t.owner?i+=' AND [ds6w:responsibleuid]:"'+e.getUserLogin()+'"':1===t.owner&&(i+=' AND [ds6w:organizationResponsible]:"'+e.getUserOrganizationName()+'"'),i}(s),locale:e.getLang(),tenant:e.getPlatformId(),nresults:m,label:y("R3MwebSearch_"+h),select_predicate:d,select_file:p,with_synthesis:!1,with_synthesis_attribute:!1,with_nls:!0,login:{"3dspace":{SecurityContext:e.getSecurityContext()}},source:["3dspace"]};c[0===u?"start":"next_start"]=u,o.push(I({url:e.get3DSearchUrl()+"/search",method:"POST",data:c,onComplete:function(e){var o={};(e.results||[]).forEach(function(t){if(t&&t.attributes){var e={};t.attributes.forEach(function(t){var i=(t.name||"bug").split("/"),n=i[i.length-1];g[n]&&("ds6w:type"===n?(e.type=t.value,e.typeDisp=t.dispValue):"ds6w:status"===n?(e.maturity=t.value,e.maturityDisp=t.dispValue||t.value):"ds6wg:dmuvalidationvalidation.v_validationstate"===n?(e.validState=t.value,e.validStateDisp=a["validState"+t.value]):"bo.SIMItfSimulation.V_ValidationState"===n?(e.validState=t.value,e.validStateDisp=a["validState"+t.value]):"ds6wg:simitfsimulation.v_itf_executionstatus"===n?e.executionState=t.value:e[g[n]]=t.dispValue||t.value)}),e.analysisState="unknown",e.analysisStateDisp="",e.analysisStateNbKO=0,e.analysisStateProgress=0,e.ownerImg=w(e.ownerid),e.originatorImg=w(e.originatorid),e.id&&(o[e.id]=e)}}),i(o,l),e.infos.nresults?r(t,e.infos.next_start,++l):n()},onFailure:function(){n()}}))}(t,0,0)});return r.promise.then(t=>(t&&o.forEach(t=>t.cancel()),t)),r},F.evalAnalysisStatus=function(t,e,i){L(t.id,e,i)},F.getFeatureStateInfo=function(i){return new Promise(function(n){(function(i){return new Promise((n,o)=>{t.authenticatedRequest(e.getR2VPlatformUrl(i.serviceId)+"/enovia/resources/r2v/v1/modeler/featurestate/fetch",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":e.getLang()},data:JSON.stringify({ids:[i.objectId]}),timeout:6e4,onComplete:function(t){let e=JSON.parse(t);n(e)},onFailure:o,onTimeout:o})})})(i).then(t=>{n(t)})})},F.onTenantModified=function(t){_.push(t)},F.navigate=function(t){var e,i=[t.rvwIds.length?V((e=t.rvwIds,{input_physical_ids:e,label:y("R3MwebRvw"),primitives:[{navigate_to_rel:{id:1,filter:{rel_type:["VPLMrel/PLMConnection/V_Owner"]}}},{navigate_to_sr:{id:2,filter:{semantics:["1"],role:["78"]}}},{navigate_to_sr:{id:3,filter:{semantics:["5"],role:["110"]},mode:"path"}},{navigate_to_sr:{id:4,filter:{semantics:["5"],role:["151"]},mode:"path"}},{navigate_to_rel:{id:5,filter:{rel_type:["VPLMrel/PLMConnection/V_Owner"],bo_type:["DMUValidationCheck"]}}},{navigate_to_rel:{id:6,filter:{rel_type:["VPLMrel/PLMPort/V_Owner"],bo_type:["DMUValidationExposedPresentation"]}}},{navigate_from_rel:{id:7,filter:{rel_type:["Reference Document"],bo_type:["Issue"]}}}],patterns:{context:[{id:1},{id:2}],validatedPath:[{id:1},{id:3}],check:[{id:5}],checked:[{id:1},{id:4}],highlight:[{id:6}],issue:[{id:7}]},fileAttributes:p,attributes:f,version:3})):Promise.resolve({}),t.isrIds.length?V(function(t){return{input_physical_ids:t,label:y("R3MwebIsr"),primitives:[{navigate_to_rel:{id:1,filter:{bo_type:["dsc_Model_Category_Ref"]}}},{navigate_to_rel:{id:2}},{navigate_to_sr:{id:3,filter:{semantics:["5"],role:["79"]},mode:"last"}},{navigate_to_sr:{id:4,filter:{semantics:["4"],role:["170"]},mode:"last"}},{navigate_from_rel:{id:5,filter:{rel_type:["Reference Document"],bo_type:["Issue"]}}}],patterns:{prd:[{id:1},{id:2},{id:3}],context:[{id:1},{id:2},{id:4}],issue:[{id:5}]},fileAttributes:p,attributes:f,version:3}}(t.isrIds)):Promise.resolve({}),t.mkpIds.length?V(function(t){return{input_physical_ids:t,label:y("R3MwebMkp"),primitives:[{navigate_from_rel:{id:1,filter:{rel_type:["Markup"]}}},{navigate_from_rel:{id:2,filter:{rel_type:["Reference Document"],bo_type:["Issue"]}}}],patterns:{context:[{id:1}],issue:[{id:2}]},fileAttributes:p,attributes:f,version:3}}(t.mkpIds)):Promise.resolve({}),t.msrIds.length?V(function(t){return{input_physical_ids:t,label:y("R3MwebMsr"),primitives:[{navigate_to_rel:{id:1,filter:{bo_type:["dsc_Model_Category_Ref"]}}},{navigate_to_rel:{id:2}},{navigate_to_sr:{id:3,filter:{semantics:["5"],role:["79"]},mode:"last"}},{navigate_to_sr:{id:4,filter:{semantics:["4"],role:["170"]},mode:"last"}},{navigate_from_rel:{id:5,filter:{rel_type:["Reference Document"],bo_type:["Issue"]}}}],patterns:{prd:[{id:1},{id:2},{id:3}],context:[{id:1},{id:2},{id:4}],issue:[{id:5}]},fileAttributes:p,attributes:f,version:3}}(t.msrIds)):Promise.resolve({})];return Promise.all(i)},k});