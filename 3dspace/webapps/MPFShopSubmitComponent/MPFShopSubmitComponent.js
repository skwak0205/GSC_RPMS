define("DS/MPFShopSubmitComponent/ShopSubmitComponent",["UWA/Class/View","DS/UIKIT/Input/Button","DS/UIKIT/Modal","DS/MPFShopModel/ShopModel","DS/MPFShopModel/ShopServiceModel","DS/MPFShopModel/ShopSubmitor","DS/MPFServices/ObjectService","i18n!DS/MPFShopSubmitComponent/assets/nls/ShopSubmitComponent"],function(t,e,o,i,n,s,h,r){"use strict";return t.extend({className:"mpf-shop-submit",setup:function(t){h.requiredOfPrototype(t.shop,i,"options.shop must be a ShopModel"),h.requiredOfPrototype(t.shopService,n,"options.shopService must be a ShopServiceModel"),this.shop=t.shop,this.shopService=t.shopService,this.confirmationModal=this._createConfirmationModal(),this.submitLabButton=this._createSubmitLabButton()},render:function(){var t;return this._canShopBeSumitted()&&(t=[this.confirmationModal,this.submitLabButton]),this.container.setContent(t),this},_canShopBeSumitted:function(){var t,e,o;return t=!this.shop.isInternal(),e=this.shop.getState()===i.States.DRAFT,o=this.shopService.getState()===n.States.DRAFT,t&&e&&o},destroy:function(){this._parent()},_createConfirmationModal:function(){var t,i,n;return i=new e({className:"warning",value:r.get("submitShop")}),n=new e({value:r.get("cancel")}),t=new o({closable:!0,header:"<h4>"+r.get("confirmShopSubmit")+"</h4>",body:"<p>"+r.get("confirmShopSubmitMessage")+"</p>",footer:[i,n]}),i.addEvent("onClick",this._onSubmit.bind(this)),n.addEvent("onClick",t.hide.bind(t)),t},_createSubmitLabButton:function(){return new e({className:"warning",icon:"attention",value:r.get("submitShop"),events:{onClick:this._showConfirmationModal.bind(this)}})},_showConfirmationModal:function(){return this.confirmationModal.show()},_hideConfirmationModal:function(){return this.confirmationModal.hide()},_onSubmit:function(){return s.submit(this.shop,this.shopService).then(this._hideConfirmationModal.bind(this)).catch(function(t){console.log(t)})},_setModificationRequestStatusToShopService:function(){var t={};return t[n.Fields.MODIFICATION_REQUEST_STATUS]=n.RequestStatus.TO_BE_VALIDATED,this.shopService.savePromise(t,{patch:!0})},_setShopSubmitted:function(){return this.shop.setState(i.States.SUBMITTED),this.shop.savePromise()},_setShopServiceSubmitted:function(){var t={};return t[n.Fields.STATE]=n.States.SUBMITTED,this.shopService.savePromise(t,{patch:!0})}})});