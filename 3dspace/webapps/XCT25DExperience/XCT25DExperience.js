define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}),define("DS/XCT25DExperience/XCT25DPlatformHelpers",["UWA/Class/Promise","DS/WAFData/WAFData"],function(e,t){"use strict";return{getStreamsPromise:function(i){return new e((e,n)=>{let o=i.physicalid;this.securityContext=i.contextid,this.serverUrl=i.serverurl;let r=i.tenant,s=this.serverUrl+"/resources/experience/medias/"+o+"/streams"+(r?"/?tenant="+r:"");i.Play3DXContent&&i.Play3DXContent.source&&i.Play3DXContent.source.includes("X3DSEAR")&&(this.securityContext=""),t.authenticatedRequest(s,{method:"GET",type:"json",headers:{"Content-Type":"application/json",SecurityContext:this.securityContext},onComplete:t=>{const i=t.results.find(e=>/\.(dsxm)$/i.test(e.persistencyname));i?e(i):n(new Error(".dsxm file not found"))},onFailure:e=>{n(new Error(e))}})}).then(e=>this._streamDescriptorToTicketPromise(e.physicalid,e.persistencyname)).then(e=>this.retrieveStreamContentPromise(e))},_streamDescriptorToTicketPromise:function(i,n){const o="";return new e((e,r)=>{const s=this.serverUrl+"/resources/experience/medias/"+i+"/streams/"+n,a=this.serverUrl+"?__fcs__jobTicket="+encodeURIComponent(o)+"&jobTicket=__fcs__jobTicket&__fcs__attachment=true";t.authenticatedRequest(s,{method:"GET",type:"json",cache:-1,headers:{"Content-Type":"application/json",SecurityContext:this.securityContext},onComplete:t=>{e({data:t,ticketUrl:a})},onFailure:e=>{r(new Error(e))},onTimeout:e=>{r(new Error(e))}})})},retrieveStreamContentPromise:function(i){const n=i.data.results[0];return new e((e,i)=>{let o={timeout:0,method:"GET",data:"__fcs__jobTicket="+encodeURIComponent(n.ticket),responseType:"blob",headers:{Accept:"application/octet-stream"},onComplete:t=>{e(t)},onFailure:e=>{i(new Error(e))},proxy:"passport"};t.authenticatedRequest(n.fcsurl,o)})}}}),define("DS/XCT25DExperience/enums/25DPlayerEnums",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MediaType=t.AnimationType=void 0,function(e){e[e.Linear=0]="Linear",e[e.EaseIn=1]="EaseIn",e[e.EaseOut=2]="EaseOut",e[e.EaseBoth=3]="EaseBoth"}(t.AnimationType||(t.AnimationType={})),function(e){e[e.Panorama=0]="Panorama",e[e.Sequence=1]="Sequence"}(t.MediaType||(t.MediaType={}))}),define("DS/XCT25DExperience/interfaces/ISpecs",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}),define("DS/XCT25DExperience/XCT25DConfig",[],function(){"use strict";return Object.freeze({MEDIA_TYPE:"MediaVideo3DExp",SEARCH_STRING_MEDIA_TYPE:"type: MediaVideo3DExp"})}),define("DS/XCT25DExperience/XCTSequenceLoader",["UWA/Class","DS/Visualization/ThreeJS_DS"],function(e,t){"use strict";return e.extend({init:function(){this.setMakeFilePathsCallback=this.setMakeFilePathsCallback.bind(this),this.resetMakeFilePathsCallback=this.resetMakeFilePathsCallback.bind(this),this.onProgressCB=null,this.onLoadedCB=null,this.onErrorCB=null,this.onStateLoadedCB=null,this.resetMakeFilePathsCallback()},loadState:function(e,t,i){6===t.images.length?this.loadSkyboxState(e,t,i):this.loadImageState(e,t,i)},loadSkyboxState:function(e,i,n){let o=[];for(let e=0;e<6;e++)o.push(i.images[e][n?1:0]);this.makeFilePaths(o,n=>{for(let o=0;o<n.length;o++){let r=this.loadTexture(e,i,n[o]),s=new t.MeshBasicMaterial({map:r,side:t.BackSide});i.materialArray.push(s)}i.material=new t.MeshFaceMaterial(i.materialArray)})},loadImageState:function(e,i,n){let o=[i.images[n?1:0]];this.makeFilePaths(o,n=>{let o=this.loadTexture(e,i,n[0]),r=new t.MeshBasicMaterial({map:o,side:t.DoubleSide});r.force=!0,i.material=r})},loadTexture:function(e,i,n){let o=URL.createObjectURL(new Blob([n]));i.total++;let r=t.ImageUtils.loadTexture(o,void 0,()=>{e.uuid===this.currentSequenceUuid&&(i.total--,0===i.total&&this.onStateLoadedCB&&this.onStateLoadedCB({state:i}),this.onProgressCB&&this.onProgressCB({uuid:e.uuid,total:e.totalStates,loaded:e.totalLoaded}),e.totalStates===e.totalLoaded&&this.onLoadedCB&&this.onLoadedCB())},void 0,!e.spec.from3DSpace);return r.flipY=!1,r},setOnProgressCallback:function(e){this.onProgressCB=e},setOnLoadedCallback:function(e){this.onLoadedCB=e},setOnErrorCallback:function(e){this.onErrorCB=e},setOnStateLoadedCallback:function(e){this.onStateLoadedCB=e},setMakeFilePathsCallback:function(e){this.makeFilePaths=e},resetMakeFilePathsCallback:function(){this.setMakeFilePathsCallback(this.defaultMakeFilePathsCallback)},defaultMakeFilePathsCallback:function(e,t){let i=[];for(let t=0;t<e.length;t++)i.push(this.imagePrefix+e[t]);setTimeout(t,10,i)}})}),define("DS/XCT25DExperience/XCTFrameWindow3D",["UWA/Core","DS/ApplicationFrame/FrameWindow3D","DS/Visualization/WebGLV6Viewer","DS/Visualization/SceneGraph","DS/Visualization/Viewpoint","DS/SceneGraphTree/SceneGraphTree","DS/ApplicationFrame/CommandsManager"],function(e,t,i,n,o,r,s){"use strict";return t.extend({init:function(e){e=e||{},this._parent(e)},load3dViewer:function(e){this._3dViewer=new i(e),this.init3dViewer()},init3dViewer:function(){this._3dViewer.setRenderMode("@Edge",!1),this._3dViewer.setPicking({activated:!0,displayHL:!0,gpu:!0,computeNormalDepth:!0,primitive:!1}),this._3dViewer.setPrePicking({activated:!1,displayHL:!0,gpu:!0,computeNormalDepth:!1,primitive:!1}),window.undoSceneGraphMigration?(this._private_sceneGraph=new n("."),this._3dViewer.attachScene(this._private_sceneGraph)):this._private_sceneGraph=this._3dViewer.getRootNode(),this._viewpoint=new o({viewer:this._3dViewer}),this._viewpoint.onMove(this._3dViewer.render),this._3dViewer.addViewpoint(this._viewpoint),this._3dViewer.setVisuEnv("DarkGrey"),this._sceneGraphTree=new r(e.extendElement(this._3dViewer.div),this._3dViewer),this._sceneGraphTree.setSceneGraph(this._private_sceneGraph),this.options.uiOptions.displayTree?this._sceneGraphTree.tree.show():this._sceneGraphTree.tree.hide();let t=0,i=0;this.options.uiOptions&&this.options.uiOptions.displayActionBar&&(i=(t=81)-32),this.elements.layerSet.addLayer(this._sceneGraphTree.tree.getContent(),{height:"auto",position:"absolute",left:0,top:0,bottom:i}),this._sceneGraphTree.tree.getContent().setStyles({height:"auto",position:"absolute",left:0,top:0,bottom:81}),this._3dViewer.inject(this.elements.viewerFrame);let a="Visu"+this._3dViewer.getVisuEnv()+"Env",c={VisuNoEnv:"light",VisuNoneEnv:"light",VisuV6Env:"light",VisuCleanSpaceEnv:"light",VisuDarkBlueEnv:"dark",VisuDarkGreyEnv:"dark",VisuShinyEnv:"dark"};this.elements.container.addClassName("wux-ui-ambiance-"+c[a]),s.onCommandStart(e=>{c[e._id]&&(this.elements.container.removeClassName("wux-ui-ambiance-light"),this.elements.container.removeClassName("wux-ui-ambiance-dark"),this.elements.container.addClassName("wux-ui-ambiance-"+c[e._id]))}),this._modelEvents.publish({event:"EVT_VIEWER_LOADED",context:this})}})}),define("DS/XCT25DExperience/XCTSequenceModel",["UWA/Class"],function(e){"use strict";return e.extend({init:function(e){this._parent(e),this.uuid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let t=16*Math.random()||0;return("x"===e?t:t?3:8).toString(16)}),this.root="",this.states=[],this.transitions=[],this.aspectRatio=1}})}),define("DS/XCT25DExperience/XCTSequenceSceneManager",["UWA/Class","DS/Visualization/Node3D","DS/Visualization/ThreeJS_DS","DS/Visualization/SceneGraphFactory","DS/Visualization/SceneGraphConverter"],function(e,t,i,n,o){"use strict";return e.extend({MODE_IMAGE:0,MODE_SKYBOX:1,DISTANCE:110,DEFAULT_FOV:45,init:function(e){this._parent(e),this.viewerPresets={infinitePlane:!1,grid:!1,mirror:!1,shadow:!1,ssao:!1,visuEnv:"None",picking:{activated:!0,trapSelection:!0,displayHL:!0},referenceAxisSystem:!0,projectionType:0},this.resetViewpoint=this.resetViewpoint.bind(this),this.showState=this.showState.bind(this),this.createRootNode=this.createRootNode.bind(this),this.setFOV=this.setFOV.bind(this),this.moveCameraBy=this.moveCameraBy.bind(this),this.moveCameraTo=this.moveCameraTo.bind(this),this.frameWindow=e.frameWindow,this.aspectRatio=e.aspectRatio,this.mode=2,this.viewpoint=this.frameWindow.getViewpoint();let t=this.frameWindow.getViewer||this.frameWindow.getViewerFrame;t=t.bind(this.frameWindow),this.viewer=t(),this._setViewerPresets(),this.context=this.viewer.getWebGLContext(),this.viewpoint.setProjectionType(0),this.imageScaleUp=1,this.hFreedomOfMovement=0,this.vFreedomOfMovement=0,this.h=0,this.v=0},createRootNode:function(){this.clean(),this.sceneGraph=new t,this.viewer.addNode(this.sceneGraph)},clean:function(){this.sceneGraph&&(this.sceneGraph.removeChild(this.image),this.sceneGraph.removeChild(this.skybox),this.image=void 0,this.skybox=void 0,this.viewer.removeNode(this.sceneGraph),this.viewer.setVisuEnv(this.viewerPresets.visuEnv),this.viewer.setSSAO(this.viewerPresets.ssao),this.viewer.setMirror(this.viewerPresets.mirror),this.viewer.setGrid(this.viewerPresets.grid),this.viewer.displayInfinitePlane(this.viewerPresets.infinitePlane),this.viewer.picking.activated=this.viewerPresets.picking.activated,this.viewer.picking.trapSelection=this.viewerPresets.picking.trapSelection,this.viewer.picking.displayHL=this.viewerPresets.picking.displayHL,this.viewer.setReferenceAxisSystem(this.viewerPresets.referenceAxisSystem),this.viewpoint.setProjectionType(this.viewerPresets.projectionType)),this.viewer.clearScene()},showState:function(e){this.mode=e.mode,void 0!==e.material&&(this.mode===this.MODE_SKYBOX?this.showSkybox(e):this.showImage(e)),this.mode===this.MODE_IMAGE&&1===this.viewpoint.camera.fov&&(this.resetViewpoint(),setTimeout(this.resetViewpoint,150)),this.render()},showSkybox:function(e){this.skybox&&(this.sceneGraph.removeChild(this.skybox),this.skybox=void 0),this.buildSkybox(this.sceneGraph,e.material)},showImage:function(e){void 0===this.image&&this.buildImage(this.sceneGraph),this.rectangle.setMaterial(e.material)},buildSkybox:function(e,n){e=e||new t;let r=new i.CubeGeometry(5e3,5e3,5e3),s=new i.Mesh(r,n);s.geometry.applyMatrix((new i.Matrix4).rotateX(-.5*Math.PI)),s.geometry.applyMatrix((new i.Matrix4).rotateZ(-.5*Math.PI));let a=new i.Scene;a.add(s);let c=new o(this.context,a);return this.skybox=c.getRootNode(),e.addChild(this.skybox),e},buildImage:function(e,o){e=e||new t;let r=2*this.DISTANCE;this.rectangle=n.createRectangleNode({width:this.aspectRatio*r,height:r,fill:!0,material:o});let s=new i.Matrix4,a=(new i.Matrix4).makeRotationX(.5*-Math.PI),c=(new i.Matrix4).makeRotationY(1.5*-Math.PI);return s.multiply(a),s.multiply(c),s.setPosition(new i.Vector3(0,this.aspectRatio*r*.5,.5*r)),this.rectangle.setMatrix(s),this.image=new t,this.image.add(this.rectangle),e.addChild(this.image),e},resetViewpoint:function(){this.setFOV(this.DEFAULT_FOV),this.moveCameraTo(0,0)},setFOV:function(e){let t=this.viewpoint.camera;if(e!==t.fov){t.fov=e;let i=this.viewpoint.viewer.SCREEN_WIDTH/this.viewpoint.viewer.SCREEN_HEIGHT/this.aspectRatio;this.imageScaleUp=this.DEFAULT_FOV/e,this.vFreedomOfMovement=1-1/this.imageScaleUp,this.hFreedomOfMovement=1-1/this.imageScaleUp*i,this.hFreedomOfMovement<0&&(this.hFreedomOfMovement=0),this.v=this.vFreedomOfMovement*this.DISTANCE,this.h=this.hFreedomOfMovement*this.DISTANCE*this.aspectRatio,this.render()}},moveCameraBy:function(e,t){let i=209/this.imageScaleUp/this.viewpoint.viewer.SCREEN_HEIGHT,n=this.viewpoint.getTarget(),o=n.y+i*e,r=n.z+i*t;this.moveCameraTo(o,r)},moveCameraTo:function(e,t){let n=e,o=this.h;n>o?n=o:n<-o&&(n=-o);let r=t,s=this.v;r>s?r=s:r<-s&&(r=-s);let a=this.DISTANCE/Math.tan(this.DEFAULT_FOV*Math.PI/360),c=new i.Vector3(0,n,r),l=new i.Vector3(-a,n,r),u=(new i.Vector3).subVectors(c,l);this.viewpoint.moveTo({eyePosition:l,upDirection:new i.Vector3(0,0,1),sightDirection:u,distanceToTarget:u.length(),duration:0}),this.render()},render:function(){this.viewer.render()},_setViewerPresets:function(){let e=!1;this.viewer.internalSceneGraph&&this.viewer.internalSceneGraph._robot&&(e=!0),this.viewerPresets.referenceAxisSystem=e,this.viewerPresets.infinitePlane=this.viewer.infinitePlane,this.viewerPresets.grid=this.viewer.getGrid(),this.viewerPresets.mirror=this.viewer.getMirror(),this.viewerPresets.shadow=this.viewer.getShadow(),this.viewerPresets.ssao=this.viewer.useSSAO,this.viewerPresets.visuEnv=this.viewer.getVisuEnv(),this.viewerPresets.picking=this.viewer.picking,this.viewerPresets.projectionType=this.viewpoint.getProjectionType()}})}),define("DS/XCT25DExperience/XCT25DPlayUtils",["require","exports"],function(e,t){"use strict";return function(){function e(){}return e.getVariantThumbnails=function(e){var t=e.loader,i=e.asset,n=e.sequence.variants,o=[],r=[];return n.forEach(function(e,t){if("name"!==e.name){var s=i.transitions.length/n.length*Number(t),a=i.states[s][0];r.push(a),o.push({title:e.name})}}),new Promise(function(e){t.makeFilePaths(r,function(t){for(var i=0;i<t.length;i++){var n=new Blob([t[i]]);o[i].imageSrc=URL.createObjectURL(n)}e(o)})})},e}()}),define("DS/XCT25DExperience/interfaces/IProgressData",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}),define("DS/XCT25DExperience/XCTJSONReader",["UWA/Class"],function(e){"use strict";return e.extend({init:function(){this._parent()},load:function(e,t){let i=new XMLHttpRequest;i.onreadystatechange=(()=>{if(4===i.readyState&&200===i.status){let e=JSON.parse(i.responseText);t(e)}}),i.open("GET",e,!0),i.send()}})}),define("DS/XCT25DExperience/XCTSWXCoreViewManipulation",["require","exports","DS/SWXCoreManipulation/SWXCoreViewManipulation","UWA/Event"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.extend({doRotate:function(e,t){this.control.xctRotate(e,t)},doPan:function(){this.control.xctPan()},doZoom:function(e,t){this.control.xctZoom(e,t)},scrollZoom:function(e){var t=this._isZoomingIn(e)?{x:0,y:1}:{x:0,y:-1};this.control.xctZoom(t,{x:0,y:0})},_isZoomingIn:function(e){var t=0;if(e.gesture&&e.gesture.currentEvent){var i=e.gesture.currentEvent[0];t=n.wheelDelta(i.getJSEvent()),i.event.preventDefault()}else{t=e.deltaY;try{this.viewer.canvas.getBoundingClientRect()}catch(e){({left:0,top:0})}e.preventDefault()}return t>0}});t.default=o}),define("DS/XCT25DExperience/interfaces/IVariant",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}),define("DS/XCT25DExperience/XCT25DExperience",[],function(){}),define("DS/XCT25DExperience/interfaces/IPanoramaView",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/XCT25DExperience/XCTTrackballControls",["require","exports","DS/Visualization/TrackballControls"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(t){var i=e.call(this,t.viewpoint,t.canvas)||this;return i._customRotate=function(e){e.defaultBehavior=!1;var t=e.gesture,n=t.getEvents()[0].currentPosition,o=t.getEvents()[0].lastPosition;i.xctRotate(n,o)},i.xctRotate=function(t,n){var o=t.x-n.x,r=t.y-n.y,s=i.getSequence();i.sceneManager.mode===i.sceneManager.MODE_IMAGE?s&&void 0!==s.transitions?i._moveToState(o,r,s):e.prototype._rotateLockWorldUpVector.call(i,o,r):e.prototype._rotateLockWorldUpVector.call(i,-o,-r)},i._customPan=function(e){e.defaultBehavior=!1,i.xctPan()},i.xctPan=function(){},i._customZoom=function(e){var t,n;if(e.defaultBehavior=!1,e.factor)n={x:0,y:0},t=e.factor>0?{x:0,y:1}:{x:0,y:-1};else{var o=e.gesture;t=o.getEvents()[0].currentPosition,n=o.getEvents()[0].lastPosition}i.xctZoom(t,n)},i.xctZoom=function(e,t){i._updateFOV(e.y-t.y>0)},i.setRotationRolling(!1),i.getSequence=t.getSequence,i.sceneManager=t.sceneManager,i._moveToState=t.moveToState,i._updateFOV=t.updateFOV,i.onPan(function(e){return i._customPan(e)}),i.onZoom(function(e){return i._customZoom(e)}),i.onRotate(function(e){return i._customRotate(e)}),i}return __extends(t,e),t}(i);t.default=n}),define("DS/XCT25DExperience/XCT25DClassNames",[],function(){"use strict";return Object.freeze({CSS_CONTROL_PANEL:"play25d-control-panel",CSS_NAME:"play25d-name",CSS_NAME_PANEL:"play25d-name-panel",CSS_NAME_MEDIA:"play25d-name-media",CSS_NAME_SEPARATOR:"play25d-name-separator",CSS_NAME_VARIANT:"play25d-name-variant",CSS_VARIANTS:"play25d-variants",CSS_VARIANTS_CONTAINER:"play25d-variants-container",CSS_VARIANTS_CONTAINER_IMAGE:"play25d-variants-container-image",CSS_VARIANTS_CONTAINER_SCROLL:"play25d-variants-container-scroll",CSS_VARIANTS_BUTTON_SWITCH:"play25d-variants-button-switch",CSS_VARIANTS_IMAGE:"play25d-variants-container-image",CSS_BUSY_INDICATOR:"play25d-busy-indicator",CSS_BUSY_INDICATOR_OVERLAY:"play25d-busy-indicator-overlay",CSS_BUSY_INDICATOR_CONTAINER:"play25d-busy-indicator-container",CSS_BUSY_INDICATOR_MESSAGE:"play25d-busy-indicator-message",CSS_HIDDEN:"hidden",CSS_FADEOUT:"fade-out",CSS_SPLASH:"play25d-splash",CSS_FONTICON_SWATCHES:"fonticon fonticon-swatches",CSS_FONTICON_SPIN_CCW:"fonticon fonticon-spin-ccw"})}),define("DS/XCT25DExperience/XCT25DExperiencePlayer",["UWA/Core","WebappsUtils/WebappsUtils","DS/3DPlay/3DPlayScenarioManager","DS/XCT25DExperience/XCTFrameWindow3D","DS/3DPlayExperienceModule/PlayExperience3D"],function(e,t,i,n,o){"use strict";return o.extend({init:function(e){(e=e||{}).commandApplication=!1,e.workbenchs=[],e.workbenchs.unshift({name:"XCT25DExperience",module:"XCT25DExperience"}),!e.input&&this.args.input&&(e.input=this.args.input),this._parent(e),this.args.FrameWindow=n},loadScenario:function(){const e=t.getWebappsAssetUrl("XCT25DExperience","ScenarioList.json");i.loadScenarios(e,this)},dispose:function(){},preCreate:function(){o.prototype.preCreate.apply(this,arguments)},onPreCreate:function(){this.args=e.extend({visu:{antiAliasing:!1,backgroundColor:16711680,useShadowMap:!1,defaultAnimationLoop:!1,displayLines:!1,autoUpdateFrustum:!0,picking:!1,displayPicking:!1,prePicking:!1,displayprePicking:!1,displayHighlight:!1,highlight:!1,pHighlight:!1,useVignetting:!1,defaultLights:!0}},this.args,!0),this.args.ui={keepActionbarClosed:!0,onActionBarReady:()=>{this.frmWindow.getActionBar().close()}}},onPostCreate:function(){this.autoReframe=!1}})}),define("DS/XCT25DExperience/XCTSequencePlayer",["require","exports","DS/XCT25DExperience/XCTSequenceModel","DS/XCT25DExperience/XCTSequenceLoader","DS/XCT25DExperience/XCTSequenceSceneManager","DS/WebappsUtils/WebappsUtils","DS/CoreEvents/Events","DS/VisuEvents/EventsManager","DS/XCT25DExperience/XCTTrackballControls"],function(e,t,i,n,o,r,s,a,c){"use strict";var l=function(){function e(e){var t=this;this.loadingQueue=[],this.chunkSize=5,this._autoRotateToken=null,this.loadedStatesMap={},this.frameWindow=e.frameWindow,this.frameWindow.experience.player=this,this.loader=e.loader||new n,this.loader.setOnStateLoadedCallback(function(e){return t.stateLoaded(e)}),this.sceneManager=e.sceneManager||new o({frameWindow:this.frameWindow}),this.viewpoint=this.frameWindow.getViewpoint(),this.setupControl(this.viewpoint)}return e.prototype.buildSequence=function(e,t){this.loadingQueue=[],this.loadedStatesMap={},this.k=0,this.h=0,this.zoom=0,this.sequence=new i,this.sequence.spec=e,this.sequence.root=t.root+("/"!==t.root.slice(-1)?"/":""),this.sequence.meta=t.meta,this.sceneManager.createRootNode(),this.sceneManager.aspectRatio=this.sequence.meta.stillResolution.width/this.sequence.meta.stillResolution.height;var n=this.asset=t.asset,o=[],s={},a="";if(this.eventIndexes=[],n.events)for(var c=0;c<n.events.length;c++){var l=n.events[c];l.constructor===Array?(a=l[0],o.push({name:l[1],transitionIndex:c})):(s[l]=c,this.eventIndexes[c]=c)}this.sequence.variantSet=a,this.sequence.events=s,this.sequence.variants=o,this.sequence.transitions=n.transitions,this.sequence.totalStates=n.transitions?n.transitions.length:1,this.sequence.totalLoaded=0,this.loader.imagePrefix=r.getWebappsBaseUrl()+"XCT25DWidget/demos/"+this.sequence.root,this.loader.currentSequenceUuid=this.sequence.uuid,this.sceneManager.resetViewpoint(),this.moveToFirstState(this.loadedStatesMap),this.processLoadingQueue();for(var u=0;u<this.sequence.totalStates;u++)this.loadStates(u,this.loadedStatesMap);this.processLoadingQueue()},e.prototype.moveToFirstState=function(e){this.loadInitialState(0,e),this.moveToNewState(0)},e.prototype.moveToNewState=function(e){if(s.publish({event:"sequenceControlStarted"}),this.currentIndex=e,void 0!==this.sequence.states[e]){if(!this.sceneManager)return;this.sceneManager.showState(this.sequence.states[e])}},e.prototype.loadInitialState=function(e,t){var i={};for(var n in this.buildStatesToLoadMap(e,2,this.sequence.transitions,t,i),i)if(i.hasOwnProperty(n)){var o=Number(n),r=this.buildState(o,this.asset.states[o]);this.loadingQueue.push({state:r,loaded:!1})}},e.prototype.loadStates=function(e,t){if(void 0===t[e]){var i=this.buildState(e,this.asset.states[e]);this.loadingQueue.push({state:i,loaded:!1}),t[e]=!0}},e.prototype.processLoadingQueue=function(){if(0!==this.loadingQueue.length){this.currentChunk=this.loadingQueue.splice(0,this.chunkSize);for(var e=0;e<this.currentChunk.length;e++)this.currentChunk[e].loaded||(this.loader.loadState(this.sequence,this.currentChunk[e].state),this.currentChunk[e].loaded=!0)}},e.prototype.stateLoaded=function(e){var t=e.state;t.loaded=!0,this.sequence.states[t.index]=t,this.sequence.totalLoaded++,t.index===this.currentIndex&&this.sceneManager.showState(t),this.currentChunk.splice(0,1),0===this.currentChunk.length&&this.processLoadingQueue()},e.prototype.buildState=function(e,t){return{index:e,images:t,materialArray:[],mode:6===t.length?this.sceneManager.MODE_SKYBOX:this.sceneManager.MODE_IMAGE,total:0}},e.prototype.buildStatesToLoadMap=function(e,t,i,n,o){if(void 0===n[e]&&(o[e]=!0,n[e]=!0),void 0!==i){var r=i[e];for(var s in r)t>0&&-1!==this.eventIndexes.indexOf(Number(s))&&this.buildStatesToLoadMap(r[s],t-1,i,n,o)}},e.prototype.switchVariant=function(e){var t=this.sequence,i=t.transitions[this.currentIndex];if(i){var n=void 0,o=t.variants[e].transitionIndex;void 0!==o&&void 0!==(n=i[o])&&void 0!==this.sequence.states[n]&&this.moveToNewState(n)}},e.prototype._overrideSetDefaultController=function(e){var t=this;e.setDefaultController=function(i,n,o){var r={viewpoint:e,canvas:e.viewer.canvas,getSequence:function(){return t.getSequence()},moveToState:function(e,i,n){return t._moveToState(e,i,n)},updateFOV:function(e){return t._updateFOV(e)},sceneManager:t.sceneManager};u.call(e,i,n,o,r)};var i=e.getDefaultController();e.setDefaultController(!1),e.setDefaultController(!0,i)},e.prototype.setupControl=function(e){var t=this;this._leftMouseUpToken=a.addEvent(document,"onLeftMouseUp",function(){t._autoRotateToken&&(clearInterval(t._autoRotateToken),t._autoRotateToken=null)}),this._releaseToken=a.addEvent(document,"onRelease",function(){t._autoRotateToken&&(clearInterval(t._autoRotateToken),t._autoRotateToken=null)}),this._holdLeftMouseDownToken=a.addEvent(document,"onHoldLeftMouseDown",function(){t._autoRotateToken||(t._autoRotateToken=t._autoRotateStart())}),this._holdToken=a.addEvent(document,"onHold",function(){t._autoRotateToken||(t._autoRotateToken=t._autoRotateStart())}),this._overrideSetDefaultController(e)},e.prototype.getSequence=function(){return this.sequence},e.prototype._moveToState=function(e,t,i){if(this.zoom>1)this.sceneManager.moveCameraBy(e,t);else{var n=this.frameWindow.getViewer(),o=Math.max(i.variants.length,1),r=n.SCREEN_WIDTH/(i.transitions.length/o*2);this.k+=e,this.h+=t;var s=i.transitions[this.currentIndex];if(s){var a=void 0,c=void 0;this.k<0?c=i.events.left:this.k>=r&&(c=i.events.right),this.h<0?c=i.events.up:this.h>=r&&(c=i.events.down),void 0!==c&&void 0!==(a=s[c])&&void 0!==this.sequence.states[a]&&this.moveToNewState(a)}this.h=(r+this.h)%r,this.k=(r+this.k)%r}},e.prototype._updateFOV=function(e){e?this.zoom++:this.zoom--,this.zoom<1&&(this.zoom=1,this.sceneManager.resetViewpoint()),this.zoom>20&&(this.zoom=20);var t=45+10*(1-Math.sqrt(this.zoom));this.sceneManager.setFOV(t)},e.prototype._autoRotateStart=function(){var e=this;this._autoRotate();var t=Math.max(this.sequence.variants.length,1);return setInterval(function(){e._autoRotate()},3e3/(this.sequence.transitions.length/t))},e.prototype._autoRotate=function(){var e=this.sequence.transitions[this.currentIndex];if(this.zoom<=1){var t=e[1];void 0!==t&&void 0!==this.sequence.states[t]&&this.moveToNewState(t)}},e.prototype.clean=function(){this.sceneManager&&this.sceneManager.clean&&this.sceneManager.clean(),this.sceneManager=null;var e=this.frameWindow.getActionBar();e&&e.show(),this.loader.resetMakeFilePathsCallback(),this.loader=null,this.frameWindow.experience.player=null},e.prototype.destroy=function(){this.clean(),a.removeEvent(document,"onLeftMouseUp",this._leftMouseUpToken),a.removeEvent(document,"onRelease",this._releaseToken),a.removeEvent(document,"onHold",this._holdToken),a.removeEvent(document,"holdLeftMouseDown",this._holdLeftMouseDownToken)},e}(),u=function(t,i,n,o){var r={SIMPLE:c.default.Mode.SIMPLE,CATIA:c.default.Mode.CATIA,COMBINED:c.default.Mode.COMBINED,LOOKAROUND:c.default.Mode.LOOKAROUND};if(t||null!==this.control)if("FLY_WALK"===i&&this.control)this.control.setForceFlyWalkState(!t);else{if(t){var s=null,a=!1;if(null==this.control&&(this.control=new c.default(o),s="COMBINED",a=!0),"SWX"==i||localStorage.getItem("forceSWXControls")&&"true"===localStorage.getItem("forceSWXControls")){if(null==this._SWXCoreViewManipulation){var l=this;new Promise(function(t,i){e(["DS/XCT25DExperience/XCTSWXCoreViewManipulation"],t,i)}).then(function(e){var t={viewer:l.viewer};l._SWXCoreViewManipulation=new e.default,l._SWXCoreViewManipulation.setup(t),l._SWXCoreViewManipulation.enable(),l._SWXCoreViewManipulation.enableViewerCallbacks=!0,n&&n()})}else this._SWXCoreViewManipulation.enable(),n&&n();s="SWX"}else void 0!==i&&(null!=r[i]&&(s=i),this._SWXCoreViewManipulation&&this._SWXCoreViewManipulation.disable(),this.control.setMode(r[i]));if(null!=s&&(this._currentDefaultController=s),!a)return;this.control.rotateSpeed=1,this.control.lockZRotationSpeed=.002,this.control.zoomSpeed=5,this.control.panSpeed=1.1}else null!==this.control&&(this._SWXCoreViewManipulation&&this._SWXCoreViewManipulation.disable(),this._SWXCoreViewManipulation=null,this.control.detachEvents()),this.control=null;this.resetCameraOrientation()}};return l}),define("DS/XCT25DExperience/XCT25DPlayApi",["require","exports","DS/CoreEvents/Events","DS/XCT25DExperience/enums/25DPlayerEnums","i18n!DS/XCT25DExperience/assets/nls/XCT25DExperience"],function(e,t,i,n,o){"use strict";return function(){function e(e){this._loader=e}return e.prototype.getInfo=function(){if(this._loader.sequencePlayer.sequence){var e,t=this._loader.sequencePlayer.sequence.meta,i=this._loader.sequencePlayer.sequence.root;return i.includes("01")&&(e=n.MediaType.Sequence),i.includes("04")&&(e=n.MediaType.Panorama),{width:t.stillResolution.width,height:t.stillResolution.height,version:t.version,type:e}}},e.prototype.getName=function(){if(this._loader.sequencePlayer.sequence){var e=this._loader.sequencePlayer.sequence;return e.spec.displayname?e.spec.displayname:e.variantSet?e.variantSet:""}},e.prototype.getVariants=function(){if(this._loader.sequencePlayer.sequence)return this._loader.sequencePlayer.sequence.variants},e.prototype.getNumberOfFrames=function(){if(this._loader.sequencePlayer.sequence)return this._loader.sequencePlayer.sequence.totalStates},e.prototype.getAvailableTransitions=function(e){if(this._loader.sequencePlayer.sequence){if(!this._loader.sequencePlayer.sequence.transitions)throw new Error(o.noTransitionsAvailable);var t=this._loader.sequencePlayer.sequence.transitions.length;if(e=Number(e),Number(e)>t-1||Number(e)<0)throw new Error(o.get("frameDoesNotExist",{frameIndex:e}));return this._loader.sequencePlayer.sequence.transitions[e]}},e.prototype.getCurrentFrame=function(){if(this._loader.sequencePlayer.sequence)return this._loader.sequencePlayer.currentIndex},e.prototype.getCurrentVariant=function(){if(this._loader.sequencePlayer.sequence)return Math.floor(this.getCurrentFrame()/this.getNumberOfFrames()/this.getVariants().length)},e.prototype.setVariant=function(e){if((e=Number(e))>this._loader.sequencePlayer.sequence.variants.length-1||e<0)throw new Error(o.get("variantDoesNotExist",{variantIndex:e}));this._loader.sequencePlayer.switchVariant(e)},e.prototype.setFrame=function(e){if((e=Number(e))>this._loader.sequencePlayer.sequence.totalStates-1||e<0)throw new Error(o.get("frameDoesNotExist",{frameIndex:e}));this._loader.sequencePlayer.moveToNewState(e)},e.prototype.setImmersiveHelpVisibility=function(e){i.publish({event:"XCT25D:ImmersiveHelp:toggle",data:e})},e.prototype.setVariantGUIVisibility=function(e){i.publish({event:"XCT25D:VariantGUI:toggle",data:e})},e}()});__extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/XCT25DExperience/XCTFileLoader",["require","exports","DS/ZipJS/zip","UWA/Class/Promise","DS/CoreEvents/Events","DS/Visualization/ModelLoader","DS/XCT25DExperience/XCTSequencePlayer","DS/XCT25DExperience/XCT25DPlatformHelpers"],function(e,t,i,n,o,r,s,a){"use strict";return function(e){function t(t){var i=e.call(this)||this;return i.specs={contextid:"",dtype:"MediaVideo3DExp",from3DSpace:!1,physicalid:i.getRandomString()},i.frameWindow=t,i.loadedBlob=null,i.modelName="Unknown",i}return __extends(t,e),t.prototype.onModelLoadingProgression=function(e){void 0!==e.loaded&&void 0!==e.total&&0!==e.total&&(this.frameWindow.experience.progress.updateProgression(Math.round(100*e.loaded/e.total)),o.publish({event:"ASSET/LOADINGPROGRESS",data:{model:this.modelName,progress:e,ctx:this.context}}))},t.prototype.onModelLoadingCompleted=function(){this.frameWindow.experience.progress.hide();var e=this.sequencePlayer.sceneManager.mode,t=this.frameWindow.getViewpoint();e===this.sequencePlayer.sceneManager.MODE_SKYBOX||e===this.sequencePlayer.sceneManager.MODE_IMAGE?t.setControlActive({viewpoint:t,picking:!1}):t.setControlActive({viewpoint:t,picking:!0});var i=window.document.createEvent("CustomEvent");i.initCustomEvent("ExperienceReady",!0,!1,{experienceLoaded:this.frameWindow.experience,type:"2.5D"}),window.document.dispatchEvent(i),o.publish({event:"25DMediaLoadingFinished"})},t.prototype.onModelLoadingError=function(e){new Error(e.type)},t.prototype.loadModel=function(e){var t,i=this;e.type.contains("application/octet-stream")||e.type.contains("binary/octet-stream")||"text/xml"===e.type||"text/plain"===e.type?t=n.resolve(e):(this.specs=this.buildPath(e),t=a.getStreamsPromise(e)),this.initializeSequencePlayer(),t.then(function(e){return i.createZipReaderPromise(e)}).then(function(e){return i.parseFileNames(e)}).then(function(e){return i.getJsonPromise(e)}).then(function(e){i.setupViewer(i.specs,JSON.parse(e))})},t.prototype.initializeSequencePlayer=function(){this.sequencePlayer||(this.sequencePlayer=new s({frameWindow:this.frameWindow}),this.sequencePlayer.loader.setOnProgressCallback(this.onModelLoadingProgression.bind(this)),this.sequencePlayer.loader.setOnLoadedCallback(this.onModelLoadingCompleted.bind(this)),this.sequencePlayer.loader.setOnErrorCallback(this.onModelLoadingError.bind(this)))},t.prototype.createZipReaderPromise=function(e){return new n(function(t,n){i.createReader(new i.BlobReader(e),function(e){e.getEntries(function(e){t(e)})},function(e){n(e)})})},t.prototype.getJsonPromise=function(e){var t=e["25D_asset.json"];return t||(t=e["sequence.json"]),new n(function(e){t.getData(new i.TextWriter,function(t){var i=t.currentTarget.result;e(i)})})},t.prototype.parseFileNames=function(e){for(var t=this.filesMap={},i=0;i<e.length;i++){t[e[i].filename]=e[i]}return this.filesMap},t.prototype.setupViewer=function(e,t){var i=this,n=this.frameWindow.getViewer||this.frameWindow.getViewerFrame,r=(n=n.bind(this.frameWindow))();r.displayInfinitePlane(!1),r.setGrid(!1),r.setMirror(!1),r.setShadow(!1),r.setSSAO(!1),r.setVisuEnv("DarkGrey"),r.setReferenceAxisSystem(!1),r.setPicking({trapSelection:!1,activated:!1,displayHL:!1}),this.sequencePlayer.loader.setMakeFilePathsCallback(function(t,n){i.makeFilePaths(t,e.physicalid,n)}),this.sequencePlayer.buildSequence(e,t),o.publish({event:"ASSET/LOADINGSTARTED",data:{model:this.modelName,ctx:this.context}})},t.prototype.makeFilePaths=function(e,t,i){for(var n=[],o=[],r=e.length,s=function(e){var t=e[0],s=e[1];r--;var a=o.indexOf(t);n[a]=s,0===r&&setTimeout(i,10,n)},a=0;a<e.length;a++){var c=e[a];c.constructor===Array&&(c=c[0]);var l=c;o.push(l),this.getArrayBufferPromise(c).then(s)}},t.prototype.getArrayBufferPromise=function(e){var t=this;return new n(function(n){var o=Object.keys(t.filesMap).find(function(t){return t.split(".")[0]===e.split(".")[0]});t.filesMap[o].getData(new i.BlobWriter("application/zip"),function(t){var i=new FileReader;i.onload=function(t){n([e,t.target.result])},i.onerror=function(e){throw new Error(e.type)},i.readAsArrayBuffer(t)})})},t.prototype.getRandomString=function(){for(var e="",t=32;t>0;--t)e+="0123456789ABCDEF"[Math.floor(Math.random()*"0123456789ABCDEF".length)];return e},t.prototype.destroy=function(){this.sequencePlayer&&this.sequencePlayer.destroy()},t}(r)}),define("DS/XCT25DExperience/XCT25DBusyIndicator",["require","exports","UWA/Core","DS/CoreEvents/Events","DS/UIKIT/Spinner","DS/XCT25DExperience/XCT25DClassNames"],function(e,t,i,n,o,r){"use strict";return function(){function e(){for(var e=this,t=document.getElementsByClassName(r.CSS_BUSY_INDICATOR_OVERLAY),i=0;i<t.length;i++)t[i].remove();this.indicator=this._buildSpinner(document.body),this.showIndicator=this.showIndicator.bind(this),this.hideIndicator=this.hideIndicator.bind(this),n.subscribe({event:"XCT25D:BusyIndicator:show"},function(t){e.showIndicator(t)}),n.subscribe({event:"XCT25D:BusyIndicator:hide"},function(){e.hideIndicator()})}return e.prototype._buildSpinner=function(e){var t=i.createElement("div",{Class:r.CSS_BUSY_INDICATOR_OVERLAY}).inject(e);t.hide();var n=i.createElement("div",{Class:r.CSS_BUSY_INDICATOR_CONTAINER}).inject(t);return new o({visible:!0,animate:!0,spin:!0}).inject(n),this._messageDiv=i.createElement("div",{Class:r.CSS_BUSY_INDICATOR_MESSAGE}).inject(n),t},e.prototype.showIndicator=function(e){this.indicator.show(),this._messageDiv.setHTML(e)},e.prototype.hideIndicator=function(){this._messageDiv.setHTML(""),this.indicator.hide()},e}()});__extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/XCT25DExperience/XCT25DPlayGui",["require","exports","UWA/Core","UWA/Controls/Abstract","DS/CoreEvents/Events","DS/XCT25DExperience/XCT25DPlayUtils","DS/XCT25DExperience/XCT25DBusyIndicator","DS/XCT25DExperience/XCT25DClassNames","i18n!DS/XCT25DExperience/assets/nls/XCT25DExperience","css!DS/XCT25DExperience/XCT25DExperience"],function(e,t,i,n,o,r,s,a,c){"use strict";return function(e){function t(t){var i=e.call(this)||this;i.cleanGui(),i._sequencePlayer=t.loader.sequencePlayer,i._api=t.api,i._container=t.container.getParent()?t.container:window.document.body,i._availableVariants=i._api.getVariants(),i._totalFrames=i._api.getNumberOfFrames(),i._createControlPanel(),i._createVariantSwitch(),i._createVariantPanel(),i._createSplashScreen();var n=i._availableVariants.length>1;return i.toggleVariantSwitch(n),i.toggleControlPanel(n),i._totalFrames!==i._availableVariants.length&&1!==i._totalFrames||i.variantSplashScreen.addClassName(a.CSS_HIDDEN),i._activeVariantIndex=i._api.getCurrentVariant(),new s,i._subscriptions=[],i._subscribeToApi(),i}return __extends(t,e),t.prototype.toggleVariantSwitch=function(e){var t=this.variantSwitch;e?t.removeClassName(a.CSS_HIDDEN):t.addClassName(a.CSS_HIDDEN)},t.prototype.toggleControlPanel=function(e){var t=this.controlPanel;e||t.hasClassName(a.CSS_HIDDEN)?t.removeClassName(a.CSS_HIDDEN):t.addClassName(a.CSS_HIDDEN)},t.prototype.cleanGui=function(){var e,t=["."+a.CSS_NAME_PANEL,"."+a.CSS_CONTROL_PANEL,"."+a.CSS_SPLASH,"."+a.CSS_VARIANTS_BUTTON_SWITCH].join(",");e=document.querySelectorAll(t),[].forEach.call(e,function(e){e.parentNode.removeChild(e)}),this._unsubscribeFromApi()},t.prototype._createSplashScreen=function(){var e=this;this.variantSplashScreen=i.createElement("div",{Class:a.CSS_SPLASH,html:'<div class="icon '.concat(a.CSS_FONTICON_SPIN_CCW,'"></div><div class="text">').concat(c.splashInstructions,"</div>")}),this.variantSplashScreen.inject(this._container),o.subscribeOnce({event:"sequenceControlStarted"},function(){return e.variantSplashScreen.addClassName(a.CSS_FADEOUT)})},t.prototype._createControlPanel=function(){this.controlPanel=i.createElement("div",{Class:a.CSS_CONTROL_PANEL}),this.controlPanel.inject(this._container)},t.prototype._createVariantSwitch=function(){var e=this;this.variantSwitch=i.createElement("div",{Class:"".concat(a.CSS_VARIANTS_BUTTON_SWITCH," ").concat(a.CSS_FONTICON_SWATCHES," ").concat(a.CSS_HIDDEN),events:{click:function(){e.toggleControlPanel()}}}),this.variantSwitch.inject(this._container)},t.prototype._createVariantPanel=function(){var e=this;this.variantContainer=i.createElement("div",{Class:a.CSS_VARIANTS_CONTAINER});var t=i.createElement("div",{Class:a.CSS_VARIANTS_CONTAINER_SCROLL});r.getVariantThumbnails(this._sequencePlayer).then(function(i){i.forEach(function(i,n){e._createVariantImage(i,n).inject(t)})}),t.inject(this.variantContainer),this.variantContainer.inject(this.controlPanel)},t.prototype._createVariantImage=function(e,t){var n=this,o=i.createElement("div",{Class:"".concat(a.CSS_VARIANTS_CONTAINER_IMAGE," ").concat(this._activeVariantIndex===t?" active":"")});return i.createElement("img",{Src:e.imageSrc,events:{click:function(){n._activateVariant(t)}}}).inject(o),o},t.prototype._activateVariant=function(e){this._api.setVariant(e),this.variantContainer.getElements(".active")[0].removeClassName("active"),this.variantContainer.getElements("."+a.CSS_VARIANTS_CONTAINER_IMAGE)[e].addClassName("active"),this._activeVariantIndex=e},t.prototype._subscribeToApi=function(){var e=this,t=o.subscribe({event:"XCT25D:ImmersiveHelp:toggle"},function(t){return e._setImmersiveHelpVisibility(t)});this._subscriptions.push(t);var i=o.subscribe({event:"XCT25D:VariantGUI:toggle"},function(t){return e._setVariantGUIVisibility(t)});this._subscriptions.push(i)},t.prototype._unsubscribeFromApi=function(){this._subscriptions&&this._subscriptions.forEach(function(e){o.unsubscribe(e)})},t.prototype._setImmersiveHelpVisibility=function(e){e?this.variantSplashScreen.removeClassName(a.CSS_HIDDEN):this.variantSplashScreen.addClassName(a.CSS_HIDDEN)},t.prototype._setVariantGUIVisibility=function(e){e?this.controlPanel.removeClassName(a.CSS_HIDDEN):this.controlPanel.addClassName(a.CSS_HIDDEN)},t}(n)}),define("DS/XCT25DExperience/XCT25DPlayApp",["require","exports","DS/XCT25DExperience/XCT25DPlayApi","DS/XCT25DExperience/XCT25DPlayGui","DS/CoreEvents/Events","DS/XCT25DExperience/XCTFileLoader","i18n!DS/XCT25DExperience/assets/nls/XCT25DExperience"],function(e,t,i,n,o,r,s){"use strict";return function(){function e(e,t,o){var a=this;this.container=e.frmWindow.getContent(),this.showLoadingOverlay(s.loadingMedia);var c=e.frmWindow.getActionBar();c&&c.hide(),this._fileLoader=new r(e.frmWindow),this._fileLoader.targetNode=e.modelLoader.targetNode?e.modelLoader.targetNode:e.modelLoader.glContext.node;var l=this._fileLoader.onModelLoadingCompleted;this._fileLoader.onModelLoadingCompleted=function(){a._api=new i(a._fileLoader);var e={api:a._api,loader:a._fileLoader,container:a.container};a._gui=new n(e),a.hideLoadingOverlay(),l.call(a._fileLoader),a.container.setStyle("height",a.container.offsetHeight-1+"px")},t.onModelLoadingProgression&&t.onModelLoadingProgression({loaded:70,total:100}),o||t.blob?o?this._fileLoader.loadModel(t.asset):this._fileLoader.loadModel(t.blob):this._fileLoader.loadModel(t.asset),t.onModelLoadingCompleted&&t.onModelLoadingCompleted()}return Object.defineProperty(e.prototype,"api",{get:function(){if(!this._api)throw new Error(s.apiIsNotInitialized);return this._api},enumerable:!1,configurable:!0}),e.prototype.clean=function(){this._fileLoader&&this._fileLoader instanceof r&&this._fileLoader.destroy(),this._gui.cleanGui()},e.prototype.showLoadingOverlay=function(e){o.publish({event:"XCT25D:BusyIndicator:show",data:e})},e.prototype.hideLoadingOverlay=function(){o.publish({event:"XCT25D:BusyIndicator:hide"})},e}()});