define("DS/CfgVariantEffectivityEditor/scripts/CfgVariantEffectivityModel",["UWA/Core","DS/Tree/TreeNodeModel","DS/CfgBaseUX/scripts/CfgColumnManager","UWA/Class/Model","text!DS/CfgBaseUX/assets/CfgUXEnvVariables.json"],function(e,t,i,o,a){return o.extend({columnsCounter:0,_onNodeModelUpdateSubscriptionToken:"",defaults:function(){return{title:"",subtitle:"",content:"",image:"",icon:"",color:"",url:"",idModel:"",jsonAttr:"",evoExp:"",columns:[],treeDocument:null}},registeronNodeUpdateEvent:function(){var e=this;this._onNodeModelUpdateSubscriptionToken=this.get("treeDocument").onNodeModelUpdate(function(t){e.undoRegisteronNodeUpdateEvent(),e.updateVariantsSelection(t.data.nodeModel),e.registeronNodeUpdateEvent()})},undoRegisteronNodeUpdateEvent:function(){this.get("treeDocument").unsubscribe(this._onNodeModelUpdateSubscriptionToken)},getXMLExpression:function(e){var t=this.get("columns"),i=this.get("treeDocument");i.prepareUpdate();for(var o=i.getRoots(),a=[],n=0;n<t.length;n++){var r="",l=0;if("string"!=t[n].typeRepresentation){for(var s=0;s<o.length;s++){var d=o[s].getChildren();if("Exclusive"!=o[s]._options.data.featureType)for(var c=0;c<d.length;c++){var u="";if("undefined"!=(v=d[c]._options.grid[t[n].dataIndex])){var p="",f="";"TXT"==e?(p=encodeURIComponent(o[s]._options.data.label),f=encodeURIComponent(d[c]._options.data.label)):(p=o[s]._options.data.value.replace(/&(?!amp;)/g,"&amp;"),f=d[c]._options.data.value.replace(/&(?!amp;)/g,"&amp;")),u='<Feature Type = "ConfigFeature" Name = "'+p+'"><Feature Type = "ConfigFeature" Name = "'+f+'"/></Feature>',l++}"undefined"!=v&&0==v&&(u="<NOT>"+u+"</NOT>"),r+=u}else{var h="",g="";for(u="",c=0;c<d.length;c++){var v;"undefined"!=(v=d[c]._options.grid[t[n].dataIndex])&&(g=g+'<Feature Type = "ConfigFeature" Name = "'+(f="TXT"==e?encodeURIComponent(d[c]._options.data.label):d[c]._options.data.value.replace(/&(?!amp;)/g,"&amp;"))+'"/>'),0==v&&(h=!0)}""!=g&&(u='<Feature Type = "ConfigFeature" Name = "'+(p="TXT"==e?encodeURIComponent(o[s]._options.data.label):o[s]._options.data.value.replace(/&(?!amp;)/g,"&amp;"))+'">'+g+"</Feature>",l++),1==h&&(u="<NOT>"+u+"</NOT>"),r+=u}}""!=r&&a.push({xml:r,featureInCondition:l})}}for(var m="",C=0;C<a.length;C++)a[C].featureInCondition>1?m=m+"<AND>"+a[C].xml+"</AND>":m+=a[C].xml;a.length>1&&(m="<OR>"+m+"</OR>");var V="",y="";return y="TXT"==e?encodeURIComponent(this.get("title")):this.get("subtitle").replace(/&(?!amp;)/g,"&amp;"),""!=m&&(V='<Context HolderType = "Model" HolderName = "'+y+'">'+m+"</Context>"),i.pushUpdate(),V},updateVariantsSelection:function(e){console.log("inside updateVariantsSelection");var t=e;this.get("treeDocument").prepareUpdate();var i=t._options.grid,o=[];for(var a in i)i.hasOwnProperty(a)&&o.push(a);var n=t.getParent();if("Exclusive"==n._options.data.featureType){for(var r=n.getAllDescendants(),l=[],s=0;s<o.length;s++)for(var d=0;d<r.length;d++)1==r[d]._options.grid[o[s]]&&l.push(o[s]);for(var c=0;c<r.length;c++)for(s=0;s<l.length;s++)if(1!=r[c]._options.grid[l[s]]){var u={};u[l[s]]="undefined";var p=r[c].withTransationUpdate;r[c].withTransationUpdate=function(e){},r[c].updateOptions({grid:u}),r[c].withTransationUpdate=p}}this.get("treeDocument").pushUpdate(),this.onModelUpdateCallback&&this.onModelUpdateCallback()},deleteColumns:function(e){for(var t=this.get("columns"),i=[],o=[],a=0;a<t.length;a++)-1==e.indexOf(a)||"string"==t[a].typeRepresentation?o.push(t[a]):i.push(t[a].dataIndex);var n=this.get("treeDocument");n.prepareUpdate();for(var r=n.getAllDescendants(),l=0;l<r.length;l++){var s=r[l],d=s._options.grid;for(a=0;a<i.length;a++)delete d[i[a]];s.updateOptions({grid:d})}n.pushUpdate(),this.set("columns",o)},copyColumns:function(e){for(var t=this.get("columns"),i=[],o=0;o<e.length;o++)"string"!=t[e[o]].typeRepresentation&&i.push(e[o]);e=i;var a=[],n=[];for(o=0;o<e.length;o++)n.push(t[e[o]].dataIndex),a.push(this.addColumn());for(o=0;o<e.length;o++){var r=this.get("treeDocument");r.prepareUpdate();for(var l=r.getAllDescendants(),s=0;s<l.length;s++){for(var d=l[s],c=d._options.grid,u=0;u<a.length;u++)c[a[o]]=c[n[o]];d.updateOptions({grid:c})}r.pushUpdate()}},addRow:function(e){console.log(e),this.undoRegisteronNodeUpdateEvent();var o=i.getColumnIndexes("VariantsAndOptionGroups"),a=this.get("columns"),n=this.get("treeDocument");n.prepareUpdate();for(var r={},l={},s=0;s<a.length;s++)"tree"!=a[s].dataIndex&&(l[a[s].dataIndex]="",r[a[s].dataIndex]="undefined");for(s=0;s<o.length;s++)l[o[s]]="",r[o[s]]="undefined";var d=n.getRoots();if(null==e.items){for(var c=0,u=0;u<d.length;u++)if(d[u]._options.data.value==e.parentReference.value){for(var p=Object.assign({},r),f=new t({label:e.label,grid:p,data:{value:e.value,label:e.label,featureType:e.featureType}}),h="-1",g=0;g<e.originalData.feature.options.length;g++){var v=e.originalData.feature.options[g].name;e.value==v&&(h=g)}"-1"!=h&&this.updateAttributes(f,e.originalData.feature.options[h]),d[u].addChild(f),c=1}if(0==c){p=Object.assign({},l);var m=new t({label:e.parentReference.label,grid:p,data:{value:e.parentReference.value,label:e.parentReference.label,featureType:e.featureType}});this.updateAttributes(m,e.originalData.feature),n.addRoot(m);p=Object.assign({},r),f=new t({label:e.label,grid:p,data:{value:e.value,label:e.label,featureType:e.featureType}});this.updateAttributes(f,e.originalData.self),m.addChild(f),m.expandAll()}}else{p=Object.assign({},l),m=new t({label:e.label,grid:p,data:{value:e.value,label:e.label,featureType:e.featureType}});this.updateAttributes(m,e.originalData.feature),n.addRoot(m);for(g=0;g<e.items.length;g++){var C=e.items[g];p=Object.assign({},r);Object.assign({},e).self=C;f=new t({label:C.label,grid:p,data:{value:C.value,label:C.label,featureType:e.featureType}});this.updateAttributes(f,e.originalData.feature.options[g]),m.addChild(f),m.expandAll()}}n.pushUpdate(),this.registeronNodeUpdateEvent()},addRowWebUX:function(e){console.log(e),this.undoRegisteronNodeUpdateEvent();var o=i.getColumnIndexes("VariantsAndOptionGroups"),a=this.get("columns"),n=this.get("treeDocument");n.prepareUpdate();for(var r={},l={},s=0;s<a.length;s++)"tree"!=a[s].dataIndex&&(l[a[s].dataIndex]="",r[a[s].dataIndex]="undefined");for(s=0;s<o.length;s++)l[o[s]]="",r[o[s]]="undefined";var d=n.getRoots();if(null==e.children){for(var c=0,u=0;u<d.length;u++)if(d[u]._options.data.value==e._parentNode._options.value){for(var p=Object.assign({},r),f=new t({label:e._options.label,grid:p,data:{value:e._options.value,label:e._options.label,featureType:e._options.featureType}}),h="-1",g=0;g<e._options.originalData.feature.options.length;g++){var v=e._options.originalData.feature.options[g].name;e._options.value==v&&(h=g)}"-1"!=h&&this.updateAttributes(f,e._options.originalData.feature.options[h]),d[u].addChild(f),c=1}if(0==c){p=Object.assign({},l);var m=new t({label:e._parentNode._options.label,grid:p,data:{value:e._parentNode._options.value,label:e._parentNode._options.label,featureType:e._options.featureType}});this.updateAttributes(m,e._options.originalData.feature),n.addRoot(m);p=Object.assign({},r),f=new t({label:e._options.label,grid:p,data:{value:e._options.value,label:e._options.label,featureType:e._options.featureType}});this.updateAttributes(f,e._options.originalData.self),m.addChild(f),m.expandAll()}}else{let i,o=!1;if(d.forEach((t,a)=>{t._options.data.value===e.value&&(o=!0,i=a)}),!1===o){p=Object.assign({},l),m=new t({label:e.label,grid:p,data:{value:e.value,label:e.label,featureType:e.featureType}});this.updateAttributes(m,e.originalData.feature),n.addRoot(m);for(g=0;g<e.children.length;g++){var C=e.children[g]._options;p=Object.assign({},r);Object.assign({},e).self=C;f=new t({label:C.label,grid:p,data:{value:C.value,label:C.label,featureType:e.featureType}});this.updateAttributes(f,e.originalData.feature.options[g]),m.addChild(f),m.expandAll()}}else if(!0===o){let o=[];d[i]._options.children.forEach(e=>{o.push(e._options.data.value)});for(g=0;g<e.children.length;g++){C=e.children[g]._options,p=Object.assign({},r);Object.assign({},e).self=C;f=new t({label:C.label,grid:p,data:{value:C.value,label:C.label,featureType:e.featureType}});o.includes(C.value)||(this.updateAttributes(f,e.originalData.feature.options[g]),d[i].addChild(f))}}}n.pushUpdate(),this.registeronNodeUpdateEvent()},updateAttributes:function(e,t){for(var o=e._options.grid,a=i.getColumnIndexes("VariantsAndOptionGroups"),n=0;n<a.length;n++)o[a[n]]=t[a[n]];e.updateOptions({grid:o})},clearRows:function(){var e=this.get("treeDocument");e.prepareUpdate(),e.selectAll(),this.removeRows(),e.pushUpdate()},clearColumns:function(){for(var e=this.get("columns"),t=[],i=0;i<e.length;i++)0!=i&&"string"!=e[i].typeRepresentation&&i!=e.length-1||t.push(e[i]);this.set("columns",t)},removeRows:function(){this.undoRegisteronNodeUpdateEvent(),this.deletedRowValues=[];var e=this.get("treeDocument"),t=e.getSelectedNodes(),i=[];e.prepareUpdate();for(var o=0;o<t.length;o++){1==t[o].hasChildren()&&(t[o].remove(),this.deletedRowValues.push(t[o]._options.data.value))}e.pushUpdate(),t=e.getSelectedNodes(),e.prepareUpdate();for(o=0;o<t.length;o++){0==t[o].hasChildren()&&(i.push(t[o].getParent()),t[o].remove(),this.deletedRowValues.push(t[o]._options.data.value))}for(o=0;o<i.length;o++){0==i[o].hasChildren()&&(i[o].remove(),this.deletedRowValues.push(i[o]._options.data.value))}e.pushUpdate(),this.registeronNodeUpdateEvent()},addColumn:function(){this.undoRegisteronNodeUpdateEvent();var e=this.get("columns"),t=this.getColumnDefination(),i=t.dataIndex="_"+this.columnsCounter;this.columnsCounter++,e.push(t);var o=this.get("treeDocument");o.prepareUpdate();for(var a=o.getAllDescendants(),n=0;n<a.length;n++){var r={};r[i]="",1!=a[n].hasChildren()?(r[i]="undefined",a[n].updateOptions({grid:r})):a[n].updateOptions({grid:r})}return o.pushUpdate(),this.registeronNodeUpdateEvent(),i},getSelectedFeatureOptions:function(){if(!0===JSON.parse(a).isWebUXAutocompleteEnabled){for(var e=[],t=this.get("treeDocument").getAllDescendants(),i=0;i<t.length;i++)t[i]._options.children||e.push(t[i]._options.data.value);return e}for(e=[],t=this.get("treeDocument").getAllDescendants(),i=0;i<t.length;i++)e.push(t[i]._options.data.value);return e},getDeletedFeatureOptions:function(){return this.deletedRowValues?this.deletedRowValues:void 0},getColumnDefination:function(){return{dataIndex:"",typeRepresentation:"tristate",editionPolicy:"EditionInPlace",alwaysVisibleFlag:"true",width:"30",minWidth:"30",resizableFlag:!1,sortableFlag:!1,groupableFlag:!1}},ConvertJsonEffectivitytoColumns:function(e,t){var i=[];i.push({text:"",dataIndex:"tree",typeRepresentation:"string",alwaysVisibleFlag:"true",width:"220",minWidth:"220",pinned:"left"}),i=i.concat(t);for(var o=0;o<e.Combinations.length;o++){var a=this.getColumnDefination();a.dataIndex="_"+this.columnsCounter,this.columnsCounter++,i.push(a)}return i}})}),define("DS/CfgVariantEffectivityEditor/scripts/CfgVariantAutocomplete",["UWA/Core","DS/WebappsUtils/WebappsUtils","DS/CfgBaseUX/scripts/CfgUtility","DS/UIKIT/Autocomplete","i18n!DS/CfgVariantEffectivityEditor/assets/nls/CfgVariantEffectivityEditor"],function(e,t,i,o,a){var n={initialiseAutocomplete:function(e){this.options=e,e.parent.autocompleteContainer.setHTML(""),this.autocompleteHierarchicalInput=new o({multiSelect:!1,showSuggestsOnFocus:!1,placeholder:a.Auto_Place_Holder,disabled:!0,allowFreeInput:!0,events:{onSelect:function(e,t){event.stopPropagation(),n.options.onSelectCallback(e),this.onUnselect(e)},onUnselect:function(e,t){}}});var t=UWA.createElement("div",{class:"CfgAutoPickContainer"});t.setStyles({position:"relative",marginRight:"15px",display:"flex"}),this.autocompleteHierarchicalInput.inject(t),t.inject(e.parent.autocompleteContainer),e.parent.autocompleteContainer.getElement(".autocomplete").setStyle("width","100%"),e.parent.autocompleteContainer.getElement(".autocomplete-reset").setStyles({right:"30px",top:"6px"});var i=UWA.createElement("span",{class:"fonticon fonticon-1x fonticon-search"});i.setStyles({"font-size":"14px !important",position:"absolute",right:"2px",bottom:"10px","margin-top":"5px"});var r=UWA.createElement("div",{class:"imgSearchContainer1",id:"searchIconCont"});return r.style.opacity="0.5",r.addClassName("imgFocusIdenty"),r.addContent(i),i.inject(r),r.addEventListener("click",function(){n.autocompleteHierarchicalInput.showAll()}),r.inject(t),n},setDisable:function(e){this.autocompleteHierarchicalInput.getItems().forEach(function(t){n.autocompleteHierarchicalInput.enableItem(t.value),1==e.includes(t.value)&&n.autocompleteHierarchicalInput.disableItem(t.value)})},drawDictionary:function(e){if(0==e.length)i.showwarning(a.No_Conf_Features_Title,"warning");else{for(var t={name:"Objects",items:[]},o=0;o<e.length;o++)if(0!=e[o].options.length){var r={};r.featureType=e[o].selectionType,r.label=e[o].displayName,r.value=e[o].name,r.items=[],r.originalData={feature:e[o],self:e[o]};for(var l=0;l<e[o].options.length;l++){var s={};s.featureType=e[o].selectionType,s.label=e[o].options[l].displayName,s.value=e[o].options[l].name,s.parentSelectionType=e[o].selectionType,s.selection=e[o].options[l].selection,s.originalData={feature:e[o],self:e[o].options[l]},r.items.push(s)}t.items.push(r)}this.autocompleteHierarchicalInput.addDataset(t),this.autocompleteHierarchicalInput.getItems().forEach(function(e){n.autocompleteHierarchicalInput.enableItem(e.value)}),n.autocompleteHierarchicalInput.setDisabled(!1)}}};return n}),define("DS/CfgVariantEffectivityEditor/scripts/CfgVariantEditorDataGridViewToolbar",["i18n!DS/CfgVariantEffectivityEditor/assets/nls/CfgVariantEffectivityEditor"],function(e){var t=Object.create(null);return t.toolbar=null,t.writetoolbarDefination=function(){var t={entries:[{id:"ID_SEARCHFEATUREOPTION",dataElements:{typeRepresentation:"string",value:"",label:"",visibleFlag:!1,tooltip:e.CFG_Search_Features,placeholder:e.CFG_Search_Features,overflowPriority:"none",displayLabel:!0},position:"far",children:[]},{id:"ID_Plus",dataElements:{typeRepresentation:"functionIcon",tooltip:e.Add_Col,disabled:!1,icon:{iconName:"plus",fontIconFamily:1},category:"Touch",action:{module:"DS/CfgVariantEffectivityEditor/scripts/CfgVariantEditorDataGridViewToolbar",func:"onPlusClick"}},position:"far",children:[]},{id:"ID_Copy",dataElements:{typeRepresentation:"functionIcon",tooltip:e.Clone_Col,disabled:!0,icon:{iconName:"duplicate",fontIconFamily:1},category:"Touch",action:{module:"DS/CfgVariantEffectivityEditor/scripts/CfgVariantEditorDataGridViewToolbar",func:"onCopyClick"}},position:"far",children:[]},{id:"ID_Delete",dataElements:{typeRepresentation:"functionIcon",tooltip:e.Del_Col,disabled:!0,icon:{iconName:"trash",fontIconFamily:1},category:"Touch",action:{module:"DS/CfgVariantEffectivityEditor/scripts/CfgVariantEditorDataGridViewToolbar",func:"onDeleteClick"}},position:"far",children:[]},{id:"ID_SwitchView",dataElements:{typeRepresentation:"functionIcon",tooltip:e.CFG_HorizontalSwitchView,disabled:!1,visibleFlag:!0,icon:{iconName:"table",fontIconFamily:1},category:"TouchNext",action:{module:"DS/CfgVariantEffectivityEditor/scripts/CfgVariantEditorDataGridViewToolbar",func:"onSwitchViewClick"}},position:"far",children:[]},{id:"ID_Dictionary",dataElements:{typeRepresentation:"functionIcon",tooltip:e.DictionaryHeader,disabled:!1,icon:{iconName:"book-open",fontIconFamily:1},category:"TouchNext",action:{module:"DS/CfgVariantEffectivityEditor/scripts/CfgVariantEditorDataGridViewToolbar",func:"onShowDictionaryClick"}},position:"far",children:[]},{id:"ID_ColumnManager",dataElements:{typeRepresentation:"functionIcon",tooltip:e.ColumnPropertiesManagerHeader,disabled:!1,visibleFlag:!1,icon:{iconName:"cog",fontIconFamily:1},category:"TouchNext",action:{module:"DS/CfgVariantEffectivityEditor/scripts/CfgVariantEditorDataGridViewToolbar",func:"onUserSettingsClick"}},position:"far",children:[]}]};return JSON.stringify(t)},t.onPlusClick=function(e){e._event="ID_PLUS",t.onToolbarClickCallback(e)},t.onCopyClick=function(e){e._event="ID_COPY",t.onToolbarClickCallback(e)},t.onClearClick=function(e){e._event="ID_CLEAR",t.onToolbarClickCallback(e)},t.onDeleteClick=function(e){e._event="ID_DELETE",t.onToolbarClickCallback(e)},t.onShowDictionaryClick=function(e){e._event="ID_DICTIONARY",t.onToolbarClickCallback(e)},t.onSwitchViewClick=function(e){e._event="ID_HORIZONTALVIEW",t.onToolbarClickCallback(e)},t.onUserSettingsClick=function(e){e._event="ID_USERSETTINGS",e.viewId="effectivityView",t.onToolbarClickCallback(e)},t.setToolbarState=function(e){if(e)for(var i=0;i<e.length;i++){var o=e[i];t.toolbar.updateNodeModel(o.IdValue,{disabled:o.StateValue})}},t}),define("DS/CfgVariantEffectivityEditor/scripts/CfgTweakerVerticalTristate",["UWA/Core","DS/Tweakers/TweakerBase","DS/Utilities/Dom","DS/Utilities/Utils","DS/Core/PointerEvents"],function(e,t,i,o,a){"use strict";var n=t.inherit({name:"TweakerTristate",publishedProperties:{value:{defaultValue:!1,type:"boolean",advancedSetter:!0},valueType:{defaultValue:"boolean",type:"string"},displayStyle:{defaultValue:"checkbox",type:"string"},minValue:{defaultValue:"",type:"string"}},computeTweakerContentLength:function(){return this._getCurrentTouchMode()?19:14},_upgradeValue:function(e){return"1"===e||1===e||"true"===e||!0===e||"0"!==e&&0!==e&&"false"!==e&&!1!==e&&(""==e?"":"undefined")}}),r=function(e,i){t.prototype.baseViewModule.call(this,e,i)};o.applyMixin(r,t.prototype.baseViewModule);var l=function(e,t){r.call(this,e,t)};o.applyMixin(l,r),l.prototype.buildView=function(){if(this._tweaker.elements.container){var t,i=this._options.viewOptions||{};i.type=this._options.viewOptions.displayStyle,i.touchMode=this._tweaker._getCurrentTouchMode(),i.fireOnlyFromUIInteractionFlag=!0,this._view=new e.Element("div"),this.icon=new e.Element("div"),this.icon.inject(this._view),this.icon.setStyles({height:"100%",width:"100%"}),"undefined"===this._tweaker.value?t="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-checkbox-off wux-ui-3ds-lg unselectedIcon":!0===this._tweaker.value?t="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-check wux-ui-3ds-lg checkIcon":!1===this._tweaker.value&&(t="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-wrong wux-ui-3ds-lg notIcon"),this.icon.addClassName(t),this.setValue(this._tweaker.value)}},l.prototype.handleEvents=function(){var e=this._view,t=this.icon,o=this._tweaker;i.addEventOnElement(o,e,a.POINTERHIT,function(e){e.stopPropagation(),t.className="";var i="";!1===o.value?(i="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-checkbox-off wux-ui-3ds-lg unselectedIcon",o.value="undefined"):!0===o.value?(i="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-checkbox-off wux-ui-3ds-lg unselectedIcon",o.value="undefined"):"undefined"===o.value&&(o.value=!0,i="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-check wux-ui-3ds-lg checkIcon"),t.addClassName(i)})},l.prototype.setValue=function(e,t){if(this.icon){var i="";"undefined"===this._tweaker.value?i="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-checkbox-off wux-ui-3ds-lg unselectedIcon":!0===this._tweaker.value?i="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-check wux-ui-3ds-lg checkIcon":!1===this._tweaker.value&&(i="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-wrong wux-ui-3ds-lg notIcon"),this.icon.className="",this.icon.addClassName(i)}},l.prototype.setTouchMode=function(e,t){this.icon&&(this.icon.touchMode=e)};var s=function(e,t){r.call(this,e,t)};return o.applyMixin(s,r),s.prototype.buildView=function(){var t;this._tweaker.elements.container&&(this._view=new e.Element("span"),"undefined"===this._tweaker.value?t="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-checkbox-off wux-ui-3ds-lg unselectedIcon":!0===this._tweaker.value?t="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-check wux-ui-3ds-lg ":!1===this._tweaker.value&&(t="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-wrong wux-ui-3ds-lg "),this._view.addClassName(t),this.setValue(this._tweaker.value),this.setTouchMode(this._tweaker._getCurrentTouchMode()))},s.prototype.setValue=function(e,t){if(this._view){var i="";"undefined"===this._tweaker.value?i="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-checkbox-off wux-ui-3ds-lg unselectedIcon":!0===this._tweaker.value?i="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-check wux-ui-3ds-lg ":!1===this._tweaker.value&&(i="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-wrong wux-ui-3ds-lg "),this._view.className="",this._view.addClassName(i)}},s.prototype.setTouchMode=function(e,t){this._view&&(this._tweaker.readOnly?this._view.style.paddingLeft=e?"14px":"7px":this._view.touchMode=e)},n.prototype.baseViewModule=r,n.prototype.VIEW_MODULES={switch:{classObject:l,options:{viewOptions:{displayStyle:"switch"}}},readOnly:{classObject:s,options:{viewOptions:{displayStyle:"switch"}}},checkbox:{classObject:l,options:{viewOptions:{displayStyle:"checkbox"}}}},n.prototype.registerViewModule=function(e,t){},n}),define("DS/CfgVariantEffectivityEditor/scripts/CfgVariantWUXAutocomplete",["DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/WUXAutoComplete/AutoComplete","i18n!DS/CfgVariantEffectivityEditor/assets/nls/CfgVariantEffectivityEditor"],function(e,t,i,o){var a={model:null,myAutoComplete:null,selectedist:[],initialiseAutocomplete:function(e){return this.options=e,e.parent.autocompleteContainer.setHTML(""),this.selectedist=[],a},enableAutocompleteItems:function(e,t){if(this.selectedist=[...e],this.itemsDeleted=t,this.myAutoComplete&&this.myAutoComplete._dataGridView){this.myAutoComplete.value=void 0;let e=this.myAutoComplete._dataGridView.getTreeDocument();e.prepareUpdate(),e.getAllDescendants().forEach(e=>{this.itemsDeleted&&this.itemsDeleted.includes(e._options.value)&&(e._isHighlighted=!1,e._isSelected=!1,e._isPreSelected=!1,e._options.children&&e._options.children.forEach(t=>{t._isHighlighted=!1,e._isSelected=!1,e._isPreSelected=!1}))}),e.pushUpdate(),model.expandAll()}},drawDictionary:function(e,t){let i=e;t.parent.autocompleteContainer.setHTML("");var o=UWA.createElement("div",{class:"divTableCell"});this.createModel(i),this.createAutoComplete(),this.myAutoComplete.inject(o),this.myAutoComplete.inject(t.parent.autocompleteContainer)},createNode:function(e,i,o){return new t({label:e.displayName,value:e.name,icon:i,featureType:e.selectionType,originalData:o})},createModel:function(t){model=new e({shouldBeSelected:function(e){return(!e||!0!==e._isSelected)&&(!e||!a.selectedist.includes(e.options.value))}}),model.prepareUpdate();for(var i=0;i<t.length;i++){let e={feature:t[i],self:t[i]},a=this.createNode(t[i],"https://vdevpril72plp.dsone.3ds.com/3DSpace/snresources/images/icons/large/I_Variant_Thumbnail.png",e);model.addRoot(a);for(var o=0;o<t[i].options.length;o++){let e={feature:t[i],self:t[i].options[o]};var n=this.createNode(t[i].options[o],"https://vdevpril72plp.dsone.3ds.com/3DSpace/snresources/images/icons/large/I_VariantValue_Thumbnail.png",e);a.addChild(n)}}model.expandAll(),model.pushUpdate()},createAutoComplete:function(){this.myAutoComplete=new i({elementsTree:model,multiSearchMode:!1}),this.myAutoComplete.addEventListener("change",function(e){var t=null;if(e.dsModel.selectedItems){t=e.dsModel.selectedItems.options;e.dsModel.selectedItems._isHighlighted=!0,t.children||(a.selectedist.push(t.value),a.options.onSelectCallback(e.dsModel.selectedItems)),t.children&&(t.children.forEach(e=>{a.selectedist.push(e.options.value),e._isHighlighted=!0}),a.options.onSelectCallback(t))}document.querySelector(".CfgBodyContainer #containerAuto >div >div >input").value="",model.expandAll()}),this.myAutoComplete.addEventListener("show",function(e){let t=e.dsModel._dataGridView.getTreeDocument();t.prepareUpdate(),t.getAllDescendants().forEach(e=>{a.selectedist.includes(e._options.value)&&(e._isHighlighted=!0)}),t.pushUpdate(),model.expandAll()})}};return a}),define("DS/CfgVariantEffectivityEditor/scripts/CfgVariantEditorDataGridView",["UWA/Class/View","DS/DataGridView/DataGridView","DS/CfgVariantEffectivityEditor/scripts/CfgVariantEditorDataGridViewToolbar","DS/Core/PointerEvents","DS/CfgBaseUX/scripts/CfgUtility","DS/Selection/XSO","DS/CfgBaseUX/scripts/CfgUserSettings","i18n!DS/CfgVariantEffectivityEditor/assets/nls/CfgVariantEffectivityEditor"],function(e,t,i,o,a,n,r,l){return e.extend({toolbar:null,processedColumns:null,selectedColumnsIndexes:[],init:function(e){this._parent(e)},render:function(){this.columnsDeepCloned=JSON.parse(JSON.stringify(this.options.columns)),this.updateColumnSelectionEventsPrototype(),this.selectedColumnsIndexes=[],this.VariantGridView=new t({treeDocument:this.options.treeDocument,columns:this.columnsDeepCloned,selectionMode:"cell",touchMode:!0,defaultColumnDef:{width:"auto",typeRepresentation:"string",editableFlag:!0,resizableFlag:!0,sortableFlag:!1,editionPolicy:""}});return this.VariantGridView.getTypeRepresentationFactory().registerTypeTemplates({tristatetemplate:{path:"DS/CfgVariantEffectivityEditor/scripts/CfgTweakerVerticalTristate",options:{}}}),this.VariantGridView.getTypeRepresentationFactory().registerTypeRepresentations({tristate:{stdTemplate:"tristatetemplate"}}),this.VariantGridView.showEditableFeedbackFlag=!1,this.VariantGridView.layout.rowsHeader=!0,this.VariantGridView.showRowIndexFlag=!1,this.VariantGridView.columnSelection="multiple",this.VariantGridView.showColumnBorderFlag=!0,this.VariantGridView.placeholder=l.No_Eff_IconMsg,this._getCellTooltip(),i.toolbar=this.VariantGridView.setToolbar(i.writetoolbarDefination()),this.toolbar=i.toolbar,i.onToolbarClickCallback=this.options.onToolbarClickCallback,this.registerUpdateToolbarCommandStatesEvent(),this.registerToolbarSearchEvents(),this.buildContextualMenu(),this},refreshColumns:function(e){var t=JSON.parse(JSON.stringify(e));this.VariantGridView.columns=t},_getCellTooltip:function(){this.VariantGridView.getCellTooltip=function(e){var t=null;return e.cellModel&&("undefined"==e.cellModel||1==e.cellModel||(t=e.cellModel)),{shortHelp:t,updateModel:!1}}.bind(this)},registerUpdateToolbarCommandStatesEvent:function(){var e=this;e.setAddToolBarState(!1),this.VariantGridView.treeDocument.getXSO().onPostAdd(function(t){var o=[{IdValue:"ID_Delete",StateValue:!1}];i.setToolbarState(o),e.setAddToolBarState(!1)}),this.VariantGridView.treeDocument.getXSO().onPostRemove(function(t){if(e.VariantGridView.treeDocument.getXSO().isEmpty()&&e.VariantGridView._columnsXSO.isEmpty()){var o=[{IdValue:"ID_Delete",StateValue:!0}];i.setToolbarState(o)}})},setDeleteToolBarState:function(){},setAddToolBarState:function(e){var t;t={IdValue:"ID_Plus",StateValue:e},i.setToolbarState([t])},isValidNotMenuCell:function(e){if(!0===e.cellInfos.cellModel||!1===e.cellInfos.cellModel||"undefined"===e.cellInfos.cellModel)return!0},setCellValues:function(e,t){var i=this.options.treeDocument.getAllDescendants()[e.cellInfos.rowID];this.options.treeDocument.prepareUpdate();var o=i._options.grid,a=[];for(var n in o)o.hasOwnProperty(n)&&a.push(n);var r=a[e.cellInfos.columnID-1],l=i.getParents()[0];if("Exclusive"==l._options.data.featureType&&"undefined"!=t){for(var s=l.getAllDescendants(),d="undefined",c=0;c<s.length;c++)"undefined"!=s[c]._options.grid[r]&&(d=s[c]._options.grid[r]);if(t!=d)for(c=0;c<s.length;c++){var u;(u={})[r]="undefined",s[c].updateOptions({grid:u})}}(u={})[r]=t,i.updateOptions({grid:u}),this.options.treeDocument.pushUpdate()},buildCellSelectionContextualMenu:function(e){var t=this,i=[];return i.push({type:"PushItem",title:l.Menu_Title_Reject,fonticon:"",state:"",action:{callback:function(i){i&&i.context&&i.context.id&&t.setCellValues(e,!1)},context:{id:"NOT"}}},{type:"PushItem",title:l.Menu_Title_Select,fonticon:"",state:"",action:{callback:function(i){i&&i.context&&i.context.id&&t.setCellValues(e,!0)},context:{id:"Select"}}},{type:"PushItem",title:l.Menu_Title_Deselect,fonticon:"",state:"",action:{callback:function(i){i&&i.context&&i.context.id&&t.setCellValues(e,"undefined")},context:{id:"Unselect"}}}),i},buildContextualMenu:function(){var e=this;this.VariantGridView.onContextualEvent=function(t){if(1==e.isValidNotMenuCell(t))return e.buildCellSelectionContextualMenu(t)}},registerToolbarSearchEvents:function(){if(void 0!==this.toolbar){var e=this;this.toolbar.addEventListener("liveChange",function(t){if(1==t.dsModel._properties.value.dirty){var i=r.UserSettings.effectivityView_VariantsAndOptionGroups;e.options.treeDocument.prepareUpdate(),e.options.treeDocument.getAllDescendants().forEach(function(e){e.show()}),e.options.treeDocument.getRoots().forEach(function(e){e.expandAll()});var o=t.dsModel._properties.value.value;if(""==o)return void e.options.treeDocument.pushUpdate();for(var a=e.options.treeDocument.getRoots(),n=0;n<a.length;n++){var l=a[n],s=l.getAllDescendants();if(!e.isFeatureSearchCriteria(l,o,i)){for(var d=0,c=0;c<s.length;c++)e.isOptionSearchCriteria(s[c],o,i)&&(s[c].hide(),d++);d==s.length&&l.hide()}}}e.options.treeDocument.pushUpdate()})}},isFeatureSearchCriteria:function(e,t,i){return-1!=e._options.label.toUpperCase().indexOf(t.toUpperCase())||-1!=e._options.grid.name.toUpperCase().indexOf(t.toUpperCase())||-1!=e._options.grid.type.toUpperCase().indexOf(t.toUpperCase())&&1==i.type||-1!=e._options.grid.description.toUpperCase().indexOf(t.toUpperCase())&&1==i.description},isOptionSearchCriteria:function(e,t,i){var o=!1,a=!1,n=!1,r=!1;return-1==e._options.label.toUpperCase().indexOf(t.toUpperCase())&&(o=!0),-1==e._options.grid.name.toUpperCase().indexOf(t.toUpperCase())&&(a=!0),-1==e._options.grid.type.toUpperCase().indexOf(t.toUpperCase())&&(n=!0),-1==e._options.grid.description.toUpperCase().indexOf(t.toUpperCase())&&(r=!0),0==n&&0==i.type&&(n=!0),0==r&&0==i.description&&(r=!0),o&&a&&n&&r},updateColumnSelectionEventsPrototype:function(){var e=this;t.prototype._applyColumnSelection=function(){if(this.getContent().setAttribute("column-selection",this.columnSelection),"none"===this.columnSelection||this._columnsXSO)"none"===this.columnSelection&&this._columnsXSO&&this._columnsXSO.empty();else{var t=this;this._columnsXSO=new n({useUniqueID:!0,getElementID:this.getXSOColumnID}),this._columnsXSO.onPostAdd(function(o){var a=0;if(o.forEach(function(i){a=i,-1==e.selectedColumnsIndexes.indexOf(a)&&e.selectedColumnsIndexes.push(a),t.updateRenderedColumn(a,{updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0}),t._updateColumnHeaderCells({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0})}),-1!=e.selectedColumnsIndexes.indexOf(e.VariantGridView.columns.length-1)){var n={_event:"ID_PLUS"};i.onToolbarClickCallback(n)}var r=[{IdValue:"ID_Delete",StateValue:!1}];i.setToolbarState(r);r=[{IdValue:"ID_Copy",StateValue:!1}];i.setToolbarState(r)}),this._columnsXSO.onPostRemove(function(o){if(o.forEach(function(o){var a=o,n=e.selectedColumnsIndexes.indexOf(a);if(-1!==n&&e.selectedColumnsIndexes.splice(n,1),t.updateRenderedColumn(a,{updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0}),t._updateColumnHeaderCells({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0}),!t._columnsXSO.isEmpty()){var r=[{IdValue:"ID_Copy",StateValue:!1}];i.setToolbarState(r)}}),e.VariantGridView.treeDocument.getXSO().isEmpty()&&t._columnsXSO.isEmpty()){var a=[{IdValue:"ID_Delete",StateValue:!0}];i.setToolbarState(a)}if(t._columnsXSO.isEmpty()){a=[{IdValue:"ID_Copy",StateValue:!0}];i.setToolbarState(a)}})}this._isReady&&this._renderViewport({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0})}}})}),define("DS/CfgVariantEffectivityEditor/scripts/CfgVariantEffectivityCollection",["UWA/Class/Collection","DS/WebappsUtils/WebappsUtils","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/TreeModel/DataModelSet","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgBaseUX/scripts/CfgXMLServices","DS/CfgVariantEffectivityEditor/scripts/CfgVariantEffectivityModel","DS/CfgBaseUX/scripts/CfgColumnManager","i18n!DS/CfgVariantEffectivityEditor/assets/nls/CfgVariantEffectivityEditor"],function(e,t,i,o,a,n,r,l,s,d){return e.extend({model:l,initialiseCollectionOptions:function(e){this.options=e,0==this.options.hasEffectivity?console.log("Has No Effectivity, Models would be initilized to default values with Model Name and Empty Combinations"):(this.options.finalJson=r.VariantXMLToJSONConverter(this.options.varEffXML),this.options.descJson=r.VariantDescXMLtoJSONConverter(this.options.varEffXML)),this.options.evoEffXML&&(this.options.evoExpJson=r.EvolutionXMLtoJSONforFilterVariant(this.options.evoEffXML))},init:function(e){this._parent(e)},getEvoExpVal:function(e){Array.isArray(e)&&(e=e[0]);var t="";if(this.options.evoEffXML)for(var i=0;i<this.options.evoExpJson.contextsFilterXML.length;i++)if(this.options.evoExpJson.contextsFilterXML[i].name==e){t=this.options.evoExpJson.contextsFilterXML[i].expression;break}return t},getJsonAttrValue:function(e,t){Array.isArray(e)&&(e=e[0]),Array.isArray(t)&&(t=t[0]);var i={name:e,displayValue:t,Combinations:[]};if(1==this.options.hasEffectivity)for(var o=0;o<this.options.finalJson.length;o++){var a=JSON.parse(this.options.finalJson[o]);if(a.displayValue=t,a.name==e){a.Combinations.length>0&&(i=a=n.fillVariantDictionaryWithDisplayName(a,this.options.descJson));break}}return i},initialiseModels:function(e){var t=this.options.contextData,i=enoviaServerFilterWidget.baseURL,o="",a="";null!=i&&"undefined"!=i&&""!=i&&(o=enoviaServerFilterWidget.baseURL+"/common/images/I_Model_Thumbnail.png",a=enoviaServerFilterWidget.baseURL+"/common/images/iconSmallModel.png");for(var r=0;r<=t.length-1;r++){var c=t[r],u=c.physicalID,p=o;null!=c.preview_url&&"undefined"!=c.preview_url&&""!=c.preview_url&&(p=c.preview_url);var f=n.getAttributeValue(c.data,"Marketing Name"),h=n.getAttributeValue(c.basicData,"name"),g="<span style='color:#77797c'>"+(d.Maturity+":"+n.getAttributeValue(c.basicData,"current"))+"</span><br><span style='color:#77797c'>"+(d.Owner+":"+n.getAttributeValue(c.basicData,"owner"))+"</span>",v=this.getJsonAttrValue(h,f),m=this.getEvoExpVal(h),C='{ "id": "'+u+'", "title": "'+f+'", "subtitle": "'+h+'", "content": "'+g+'","image": "'+p+'", "icon": "'+a+'", "color": "", "url": "", "idModel": "'+u+'" ,"jsonAttr":""}',V=JSON.parse(C);V.jsonAttr=JSON.stringify(v),V.evoExp=m;var y=new l;this.add(y),y.set(V);var E=s.getTypeColumns("VariantsAndOptionGroups"),b=y.ConvertJsonEffectivitytoColumns(v,E);y.onModelUpdateCallback=e,y.set("columns",b),y.set("treeDocument",this.ConvertJsonEffectivitytoTreeDocument(v,b)),y.registeronNodeUpdateEvent(),y.addColumn()}},getModelswithEffExpression:function(){for(var e=this.length,t=[],i=0;i<e;i++){var o=this.at(i);""!=o.getXMLExpression()&&t.push(o.get("id"))}return t},getGlobalXMLExpression:function(e){for(var t=this.length,i="",o="",a=0;a<t;a++){o+=this.at(a).getXMLExpression(e)}return this.length>1?""!=o&&(i="<MultiContextView>"+o+"</MultiContextView>"):i=o,""!=i&&(i='<CfgEffectivityExpression xs:schemaLocation = "urn:com:dassault_systemes:config CfgEffectivityExpression.xsd" xmlns:xs = "http://www.w3.org/2001/XMLSchema-instance" xmlns = "urn:com:dassault_systemes:config"><Expression>'+i+"</Expression></CfgEffectivityExpression>"),i},ConvertJsonEffectivitytoTreeDocument:function(e,t){for(var n={},r={},l=0;l<t.length;l++)"tree"!=t[l].dataIndex&&(n[t[l].dataIndex]="",r[t[l].dataIndex]="undefined","string"==t[l].typeRepresentation&&(r[t[l].dataIndex]=""));var s=new a,d=new i({dataModelSet:s});d.prepareUpdate();for(var c=new Object,u=0;u<e.Combinations.length;u++)for(var p=e.Combinations[u].Combination,f=0;f<p.length;f++){null==c[p[f].Feature.value]&&(c[p[f].Feature.value]=p[f].Feature,c[p[f].Feature.value].Options=new Object);for(var h=0;h<p[f].Options.length;h++)c[p[f].Feature.value].Options[p[f].Options[h].Option.value]=p[f].Options[h].Option}for(var g in c)if(c.hasOwnProperty(g)){var v=c[g],m=UWA.clone(n),C=new o({label:v.label,grid:m,data:c[g]});for(var V in d.addRoot(C),c[g].Options)if(c[g].Options.hasOwnProperty(V)){var y=c[g].Options[V],E=(m=UWA.clone(r),new o({label:y.label,grid:m,data:y}));C.addChild(E)}}for(u=0;u<e.Combinations.length;u++)for(p=e.Combinations[u].Combination,f=0;f<p.length;f++)for(h=0;h<p[f].Options.length;h++){V=p[f].Options[h].Option.value;for(var b=d.getAllDescendants(),w=0;w<b.length;w++)if(b[w]._options.data.value==V){var D={};D["_"+u]="undefined","S"==p[f].Options[h].Option.selection?D["_"+u]=!0:"R"==p[f].Options[h].Option.selection&&(D["_"+u]=!1),b[w].updateOptions({grid:D})}}return d.expandAll(),d.pushUpdate(),d}})}),define("DS/CfgVariantEffectivityEditor/scripts/CfgVariantEffectivityController",["UWA/Core","UWA/Class/Model","UWA/Class/Collection","UWA/Class/View","DS/Handlebars/Handlebars","DS/CfgBaseUX/scripts/CfgSliderView","DS/CfgBaseUX/scripts/CfgUtility","WebappsUtils/WebappsUtils","DS/CfgVariantEffectivityEditor/scripts/CfgVariantEditorDataGridView","DS/CfgVariantEffectivityEditor/scripts/CfgVariantAutocomplete","DS/CfgVariantEffectivityEditor/scripts/CfgVariantWUXAutocomplete","DS/CfgBaseUX/scripts/CfgData","DS/CfgBaseUX/scripts/CfgFeatureOptionsView","DS/Controls/Toggle","text!DS/CfgVariantEffectivityEditor/scripts/CfgVariantDialogLayout.html","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/TreeModel/DataModelSet","DS/CfgVariantEffectivityEditor/scripts/CfgVariantEditorDataGridViewToolbar","DS/CfgVariantEffectivityEditor/scripts/CfgVariantEffectivityCollection","DS/CfgMassVariantEffectivityEditor/scripts/CfgMassVariantEditorModelsCollection","DS/CfgMassVariantEffectivityEditor/scripts/CfgMassVariantEditorServices","DS/CfgMassVariantEffectivityEditor/scripts/CfgMassVariantEditorDataGridView","DS/CfgMassVariantEffectivityEditor/scripts/CfgMassVariantEffectivityEditorModelSelector","DS/CfgBaseUX/scripts/CfgDialog","DS/CfgBaseUX/scripts/CfgEffectivityExpressionContainer","DS/CfgBaseUX/scripts/CfgXMLServices","DS/CfgBaseUX/scripts/CfgColumnManager","DS/CfgBaseUX/scripts/CfgUserSettings","DS/UIKIT/Mask","text!DS/CfgBaseUX/assets/CfgUXEnvVariables.json","i18n!DS/CfgVariantEffectivityEditor/assets/nls/CfgVariantEffectivityEditor"],function(e,t,i,o,a,n,r,l,s,d,c,u,p,f,h,g,v,m,C,V,y,E,b,w,D,_,T,I,S,x,A,M){var O=a.compile(h),U={currentSelectedModelId:null,isMultipleModelsAttached:!1,resetDialogShow:!1,checkFlag:!0,isModified:!1,init:function(e){return this.options=e,S.retrieveUserSettings(),U.checkFlag=!0,U.isModified=!1,U.isWebUXAutocompleteEnabled=JSON.parse(A).isWebUXAutocompleteEnabled,this.attachedModels=this.processAttachedModels(e.contextData),1==this.attachedModels.length?this.isMultipleModelsAttached=!1:this.isMultipleModelsAttached=!0,this.buildSliderView(),this.sliderView._leftPanel.getElement(".gridViewContainer").setHTML(O(M)),this.sliderView._leftPanel.getElement(".modalBodyWithoutFooter").setAttribute("style","height: 100% !important"),"Dashboard"!=this.options.mode&&(this.sliderView._leftPanel.setStyle("height","calc(100% - 68px)"),this.sliderView._rightPanel.setStyle("height","calc(100% - 68px)")),E.isReadOnlyMode=!1,this.initialiseContainers(),this.initialiseModelSelector(),this.initialiseVerticalCollection(),"Native"!=window.enoviaServerFilterWidget.mode&&this.initialiseHorizontalCollection(),this.currentSelectedModelId=this.cfgCollectionVertical.at(0).get("id"),this.initialiseUI(this.cfgCollectionVertical.at(0)),this.initialiseExpandCollpaseEvents(),this.loadNextModelsDictionaryAsyncronously(this.attachedModels,e),U},loadNextModelsDictionaryAsyncronously:function(e,t){for(var i=[],o=1;o<e.length;o++){var a="",n=U.cfgCollectionVertical.at(o),l=U.cfgCollectionVertical.at(o).get("evoExp");""!==l&&(a={evolutionExpression:JSON.stringify({filterExpression:T.getValidXmlWithoutDescId(l)})}),i.push(r.getLegacyCfgDico(n.get("idModel"),a))}Promise.all(i).then(function(e){for(var t=0;t<e.length;t++){for(var i=[],o=U.cfgCollectionVertical.at(t+1),a=0;a<e[t].features.length;a++){var n=e[t].features[a];"Preliminary"!==n.current&&"Obsolete"!==n.current&&i.push(n)}e[t].features=i,u.addDictionaryByCriteria(o.get("idModel"),e[t],"features");var r=U.processDictionary(e[t]),l=U.createDictionaryTreeDocument(r);o.set("treeDocumentVariantDictionary",l),U.initialiseFeatureTypeForEffectivityOptions(o,e[t]),U.isModified=!1}},function(){r.showwarning(M.Dictionary_Error,"error")})},buildSliderView:function(){var e={isReadOnlyMode:!1,position:"absolute",gridpadding:"10px",leftHeader:"",Cancel:M.Edit_Var_Cancel,rightHeader:M.DictionaryHeader,isRightFooter:!1,isLeftFooter:!1,headerControl:null,headerText:"",parent:this.options.parent};this.sliderView=new n(e).render()},initialiseHorizontalCollection:function(){this.cfgCollectionHorizontal=new y,this.cfgCollectionHorizontal.setAttachedModels(this.attachedModels),this.cfgCollectionHorizontal.setSelectedInstances(this.options.selectedInstances),this.cfgCollectionHorizontal.setEvolutionExpression(""),this.cfgCollectionHorizontal.initialiseModels(),E.getFilterablesVariantGrid(U.attachedModels[0].physicalId,U.options.selectedInstances).then(function(e){var t=U.cfgCollectionHorizontal.at(0);t.set("gridEffectivityForConfigurationContext",e),t.onModelUpdateCallback=U.onModelUpdateCallback,t.createColumns(e),t.createTreeDocument(e),console.log(e),U.loadNextModelsEffectivitiesAsyncronously(U.attachedModels,U.options)})},loadNextModelsEffectivitiesAsyncronously:function(e,t){for(var i=[],o=1;o<e.length;o++)i.push(E.getFilterablesVariantGrid(e[o].physicalId,t.selectedInstances));Promise.all(i).then(function(t){for(var i=0;i<t.length;i++){var o=U.cfgCollectionHorizontal.get(e[i+1].physicalId);o.set("gridEffectivityForConfigurationContext",t[i]),o.onModelUpdateCallback=U.onModelUpdateCallback,o.createColumns(t[i]),o.createTreeDocument(t[i]),U.isModified=!1}})},resetHorizontalCollection:function(){for(var e=this.cfgCollectionHorizontal.length,t=0;t<e;t++){var i=this.cfgCollectionHorizontal.at(t),o=i.get("gridEffectivityForConfigurationContext");console.log(o),i.createColumns(o),i.createTreeDocument(o)}},initialiseModelSelector:function(){var t={onChangeCB:this.onHeaderControlChangeCB,data:this.attachedModels};if(this.modelSelector=new w(t),this.modelSelector.render(),this.modelSelector.enable(),1==this.isMultipleModelsAttached){var i=e.createElement("div",{});i.setStyle("width","calc(100% - 320px)"),i.inject(this.options.parent.header),this.modelSelector._wuxComboBox.inject(i),this.modelSelector._wuxComboBox.elements.container.setStyle("width","300px"),this.options.parent.getElement(".CfgModelName").setStyle("margin","0px 10px 0px 0px")}else{e.createElement("div",{class:"modelTitle",html:this.modelSelector._text}).inject(this.options.parent.header),this.options.parent.header.setStyle("height","40px")}},onModelUpdateCallback:function(){U.isModified=!0,U.updateDisplayExpression()},updateDisplayExpression:function(){var e="";1==U.checkFlag?e=U.cfgCollectionVertical.getGlobalXMLExpression("TXT"):e=U.cfgCollectionHorizontal.processJsonToXml("TXT")[U.options.selectedInstances[0].instanceId].xml;var t="";""!=e&&(t=decodeURIComponent(r.getDisplayExpressionUsingXSLT(e))),""==t?this.cfgExpressionViewObj.updateExpression(M.No_Eff_Msg):(t=null==t?" ":t,this.cfgExpressionViewObj.updateExpression(t))},getProbesInfoDetailsWithXML:function(e){let t=[];for(let e=0;e<U.cfgCollectionVertical.length;e++){let i=U.cfgCollectionVertical.at(e).id,o=u.getDictionaryByCriteria(i,"features");null!=o&&t.push({currentModelName:o.name,currentModelFeatures:o})}return T.getProbesVariantCriteria(e,t)},getGlobalXMLExpression:function(){return 1==U.checkFlag?U.cfgCollectionVertical.getGlobalXMLExpression():U.cfgCollectionHorizontal.processJsonToXml("XML")[U.options.selectedInstances[0].instanceId].xml},initialiseContainers:function(){this.options.parent.header=this.options.parent.getElement(".CfgVariantheader"),this.options.parent.body=this.options.parent.getElement(".CfgBodyContainer"),this.initialiseExpressionContainer(),this.options.parent.autocompleteContainer=this.options.parent.getElement(".containerAuto"),this.options.parent.toolbarContainer=this.options.parent.getElement(".containerIconbar"),this.options.parent.effectivityGridContainer=this.options.parent.getElement(".containerEffectivityTable"),this.options.parent.containerHeaderBar=this.options.parent.getElement(".containerHeaderBar"),U.isWebUXAutocompleteEnabled&&!0===U.isWebUXAutocompleteEnabled&&(this.options.parent.body.addClassName("CfgWuxBodyContainer"),!0===this.options.touchMode?this.options.parent.containerHeaderBar.setAttributeNode(document.createAttribute("touch-mode")):!1===this.options.touchMode&&this.options.parent.containerHeaderBar.removeAttribute(document.createAttribute("touch-mode")),this.options.parent.containerHeaderBar.addClassName("cfgWuxAutocomplete"))},initialiseExpressionContainer:function(){e.createElement("div",{styles:{height:"100%"},html:this.options.parent.body.children[0]}).inject(this.options.parent.body);var t={effArea:"",effExpHeaderTitle:M.Eff_Expression,viewContainer:this.options.parent.body,defaultExpressionContainerHeight:70,displayCompactMode:!1,inputData:"",minimizeTooltip:M.Min_EBox,maximizeTooltip:M.Max_EBox};this.cfgExpressionViewObj=new _(t),this.cfgExpressionViewObj.render()},initialiseVerticalCollection:function(){this.cfgCollectionVertical=new V,this.cfgCollectionVertical.initialiseCollectionOptions(U.options),this.cfgCollectionVertical.initialiseModels(this.onModelUpdateCallback)},resetAttributes:function(){for(var e=0;e<U.cfgCollectionVertical.length;e++){var t=U.cfgCollectionVertical.at(e),i=u.getDictionaryByCriteria(t.get("idModel"),"features");U.initialiseFeatureTypeForEffectivityOptions(t,i)}},onHeaderControlChangeCB:function(e){U.initialiseUI(U.cfgCollectionVertical.get(e.physicalId));var t=U.getCurrentSelectedView();U.cssAdjustmentsForLayout(t,U.attachedModels.length),U.updateDisplayExpression()},initialiseUI:function(e){this.currentSelectedModelId=e.get("id"),this.options.onSelectCallback=this.addFeatureOptionsinTreeDocument,this.initialiseAutocompleteView(this.options),this.initialiseDictionary(e)},addFeatureOptionsinTreeDocumentFromTreeView:function(e,t){var i=U.autocomplete.autocompleteHierarchicalInput.datasets[0].items,o={};if(e.self.options){for(var a=0;a<i.length;a++)if(e.self.name==i[a].value){o=i[a];break}}else{var n={};for(a=0;a<i.length;a++)e.feature.name==i[a].value&&(n=i[a]),e.self.name==i[a].value&&(o=i[a]);o.parentReference=n}o.originalData=e,0==t?U.addFeatureOptionsinTreeDocument(o):U.removeFeatureOptionsinTreeDocument(o)},removeFeatureOptionsinTreeDocument:function(e){var t=(a=U.cfgCollectionVertical.get(U.currentSelectedModelId)).get("treeDocument");t.prepareUpdate(),t.unselectAll();for(var i=t.getAllDescendants(),o=0;o<i.length;o++)i[o]._options.data.value==e.value&&i[o].select();if(t.pushUpdate(),a.removeRows(),U.disableDictionaryItems(a),0==U.checkFlag){U.horizontalGridView.toolbar.isCopyOperationPerformed="NO",U.horizontalGridView.toolbar.currentModel.set("copiedInstances",[]),U.horizontalGridView.options.treeDocument.unselectAll();var a=U.cfgCollectionHorizontal.get(U.currentSelectedModelId),n=U.getSelectedObjectFromDictionaryView(e);a.removeEffectivityGridViewColumn(n),U.horizontalGridView.refreshColumns(a.get("gridViewEffectivityColumns")),U.horizontalGridView.massVariantGridView.layout.setColumnVisibleFlag("Expression",!1),U.horizontalGridView.massVariantGridView.layout.setColumnWidth("instance",0)}U.onModelUpdateCallback()},addFeatureOptionsinTreeDocument:function(e){(t=U.cfgCollectionVertical.get(U.currentSelectedModelId)).get("columns");if(U.isWebUXAutocompleteEnabled&&!0===U.isWebUXAutocompleteEnabled?t.addRowWebUX(e):t.addRow(e),U.disableDictionaryItems(t),0==U.checkFlag){U.horizontalGridView.toolbar.isCopyOperationPerformed="NO",U.horizontalGridView.toolbar.currentModel.set("copiedInstances",[]),U.horizontalGridView.options.treeDocument.unselectAll();var t=U.cfgCollectionHorizontal.get(U.currentSelectedModelId),i=U.getSelectedObjectFromDictionaryView(e);U.isWebUXAutocompleteEnabled&&!0===U.isWebUXAutocompleteEnabled?t.addEffectivityGridViewColumnWUX(i):t.addEffectivityGridViewColumn(i),U.horizontalGridView.refreshColumns(t.get("gridViewEffectivityColumns")),U.horizontalGridView.massVariantGridView.layout.setColumnVisibleFlag("Expression",!1),U.horizontalGridView.massVariantGridView.layout.setColumnWidth("instance",0)}U.onModelUpdateCallback()},getSelectedObjectFromDictionaryView:function(e){for(var t=U.cfgCollectionVertical.get(U.currentSelectedModelId).get("treeDocumentVariantDictionary").getAllDescendants(),i=0;i<t.length;i++){var o=t[i];if(o._options.data.self.name==e.value)return o._options.data;if(U.isWebUXAutocompleteEnabled&&!0===U.isWebUXAutocompleteEnabled&&void 0===e.value&&o._options.data.self.name==e._options.value)return o._options.data}return null},disableDictionaryItems:function(e){if(U.isWebUXAutocompleteEnabled&&!0===U.isWebUXAutocompleteEnabled){var t=e.getSelectedFeatureOptions(),i=e.getDeletedFeatureOptions();U.autocomplete.enableAutocompleteItems(t,i)}else{t=e.getSelectedFeatureOptions();U.autocomplete.setDisable(t)}null!=U.featureOptionsView&&U.featureOptionsView.setChecked(t)},initialiseVerticalEffectivityView:function(e){this.options.parent.effectivityGridContainer.setHTML("");var t={};t.columns=e.get("columns"),t.columns[0].selectableFlag=!1,t.treeDocument=e.get("treeDocument"),t.onToolbarClickCallback=U.onToolbarClickCallback,this.effectivityGridView=new s(t),this.effectivityGridView.render().VariantGridView.inject(this.options.parent.effectivityGridContainer)},initialiseHorizontalEffectivityView:function(e){var t=null,i={treeDocument:(t=void 0===e?this.cfgCollectionHorizontal.at(0):this.cfgCollectionHorizontal.get(e)).get("treeDocumentEffectivityGridView"),columns:t.get("gridViewEffectivityColumns"),context:t.get("configurationContext")};i.columns[0].minWidth=0,i.columns[0].resizableFlag=!1,i.columns[0].alwaysVisibleFlag=!1,this.horizontalGridView=new b(i),this.horizontalGridView.isExpressionColumnAvailable=!1,this.horizontalGridView.render(),null!=this.horizontalGridView.toolbar&&(this.horizontalGridView.toolbar.currentModel=t,this.addDictionaryCallbackToHorizontalToolbar()),this.options.parent.effectivityGridContainer.setHTML(""),this.horizontalGridView.massVariantGridView.inject(this.options.parent.effectivityGridContainer),this.horizontalGridView.massVariantGridView.layout.setColumnVisibleFlag("Expression",!1),this.horizontalGridView.massVariantGridView.layout.setColumnVisibleFlag("instance",!1),this.horizontalGridView.massVariantGridView.layout.setColumnWidth("instance",0)},addDictionaryCallbackToHorizontalToolbar:function(){"Native"!=window.enoviaServerFilterWidget.mode?this.horizontalGridView.toolbar.updateNodeModel("ID_SwitchView",{visibleFlag:!0}):this.horizontalGridView.toolbar.updateNodeModel("ID_SwitchView",{visibleFlag:!1}),this.horizontalGridView.toolbar.updateNodeModel("ID_Dictionary",{visibleFlag:!0}),this.horizontalGridView.toolbarExportExtentionsForCallbacks.onShowDictionaryClick=function(e){e._event="ID_DICTIONARY",U.onToolbarClickCallback(e)},this.horizontalGridView.toolbarExportExtentionsForCallbacks.onSwitchViewClick=function(e){e._event="ID_VERTICALVIEW",U.onToolbarClickCallback(e)}},initialiseToolbar:function(e){this.options.parent.toolbarContainer.setHTML(""),e.inject(this.options.parent.toolbarContainer)},onToolbarClickCallback:function(e){"ID_DELETE"==e._event&&((t=U.cfgCollectionVertical.get(U.currentSelectedModelId)).removeRows(),0==t.get("treeDocument").getAllDescendants().length&&t.clearColumns(),U.disableDictionaryItems(t),t.deleteColumns(U.effectivityGridView.selectedColumnsIndexes),U.effectivityGridView.VariantGridView._columnsXSO.empty(),U.effectivityGridView.refreshColumns(t.get("columns")),U.onModelUpdateCallback());"ID_CLEAR"==e._event&&((t=U.cfgCollectionVertical.get(U.currentSelectedModelId)).clearRows(),U.disableDictionaryItems(t),U.onModelUpdateCallback());"ID_COPY"==e._event&&((t=U.cfgCollectionVertical.get(U.currentSelectedModelId)).copyColumns(U.effectivityGridView.selectedColumnsIndexes),U.effectivityGridView.refreshColumns(t.get("columns")),U.onModelUpdateCallback());if("ID_PLUS"==e._event){var t=U.cfgCollectionVertical.get(U.currentSelectedModelId);U.addColumn(t),U.onModelUpdateCallback()}if("ID_DICTIONARY"==e._event&&U.sliderView._expandCollapseDockedPanel(e),"ID_HORIZONTALVIEW"==e._event&&(1==U.isModified?N("ID_HORIZONTALVIEW"):U.switchViews("ID_HORIZONTALVIEW")),"ID_VERTICALVIEW"==e._event&&(1==U.isModified?N("ID_VERTICALVIEW"):U.switchViews("ID_VERTICALVIEW")),"ID_USERSETTINGS"==e._event){var i={};i.viewId=e.viewId,U.showColumnManager(i),U.sliderView.hide()}},buildfeatureOptionView:function(e,t){var i={touchMode:!0,treeDocument:e,onFeatureOptionSelectionChange:U.addFeatureOptionsinTreeDocumentFromTreeView,features:t,onToolbarClickCallback:U.onToolbarClickCallback};U.featureOptionsView=new p(i),U.featureOptionsView.render(),U.featureOptionsView.setColumnRemoveWarningToShow(!1),U.sliderView.clearRightLayout(),U.sliderView.setRightView(U.featureOptionsView.featureOptionGridView,U.featureOptionsView.toolbar),U.featureOptionsView.cssAdjustmentsForLayout(!1)},createDictionaryTreeDocument:function(e){var t=new m,i=new g({dataModelSet:t});i.prepareUpdate();for(var o=0;o<e.length;o++){for(var a=e[o],n={},r=I.getColumnIndexes("VariantsAndOptionGroups"),l=0;l<r.length;l++)n[r[l]]="";var s=new v({label:a.displayName,grid:{name:a.name,type:a.type,checkbx:!1},data:{self:a,feature:a}});this.updateAttributes(s,a),i.addRoot(s);for(var d=0;d<a.options.length;d++){var c=a.options[d],u=new v({label:c.displayName,grid:{name:c.name,type:c.type,checkbx:!1},data:{self:c,feature:a}});this.updateAttributes(u,c),s.addChild(u)}}return i.expandAll(),i.pushUpdate(),i},processFilterablesVariantGrid:function(e){var t=[];if(null!=e.features.criterias)for(var i=0;i<e.features.criterias.features.length;i++){var o=e.features.criterias.features[i],a="",n="",r="",l="",s="",d="";o.featureAttributes.results[0].basicData.forEach(function(e){"name"==e.name&&(a=e.value[0]),"type"==e.name&&(r=e.value[0]),"current"==e.name&&(l=e.value[0]),"originated"==e.name&&(s=e.value[0]),"description"==e.name&&null!=e.value&&(d=e.value[0])}),o.featureAttributes.results[0].data.forEach(function(e){"Display Name"==e.name&&(n=e.value[0])});for(var c={name:a,displayName:n,revision:"-",options:[],type:r,current:l,originated:s,description:d,selectionType:o.featureType,check:!1,physicalID:o.featurePID},u=0;u<o.options.length;u++){var p=o.options[u],f="",h="",g="",v="",m="",C="";p.optionAttributes.results[0].basicData.forEach(function(e){"name"==e.name&&(f=e.value[0]),"type"==e.name&&(g=e.value[0]),"current"==e.name&&(v=e.value[0]),"originated"==e.name&&(m=e.value[0]),"description"==e.name&&null!=e.value&&(C=e.value[0])}),p.optionAttributes.results[0].data.forEach(function(e){"Display Name"==e.name&&(h=e.value[0])}),c.options.push({name:f,displayName:h,type:g,current:v,originated:m,description:C,selectionType:o.featureType,check:!1,physicalID:p.optionPID})}t.push(c)}return t},processDictionary:function(e){for(var t=[],i=0;i<e.features.length;i++){var o=e.features[i],a={name:o.name,displayName:o.displayValue,revision:o.revision,options:[],type:o.type_NLS,current:o.current_NLS,originated:o.originated,description:null!=o.description?o.description:"",selectionType:o.featureType,check:!1,physicalID:o.id.replace("pid:","")};if("Preliminary"!==o.current&&"Obsolete"!==o.current){for(var n=0;n<o.options.length;n++){var r=o.options[n];a.options.push({name:r.name,displayName:r.displayValue,type:r.type_NLS,current:r.current_NLS,originated:r.originated,description:null!=r.description?r.description:"",selectionType:o.featureType,check:!1,physicalID:r.id.replace("pid:","")})}t.push(a)}}return t},initialiseDictionary:function(e){this.getDictionary(e)},getDictionary:function(e){x.mask(this.options.parent.body);var t=u.getDictionaryByCriteria(e.get("idModel"),"features");if(U.sliderView.clearRightLayout(),U.sliderView.disableRightLayout(),null==t.features){var i=this,o="",a=e.get("evoExp");""!==a&&(o={evolutionExpression:JSON.stringify({filterExpression:T.getValidXmlWithoutDescId(a)})}),r.getLegacyCfgDico(e.get("idModel"),o).then(function(t){for(var o=[],a=0;a<t.features.length;a++){var n=t.features[a];"Preliminary"!==n.current&&"Obsolete"!==n.current&&o.push(n)}t.features=o,u.addDictionaryByCriteria(e.get("idModel"),t,"features");var r=U.processDictionary(t);U.isWebUXAutocompleteEnabled&&!0===U.isWebUXAutocompleteEnabled?U.autocomplete.drawDictionary(r,i.options):U.autocomplete.drawDictionary(r);var l=U.createDictionaryTreeDocument(r);e.set("treeDocumentVariantDictionary",l),U.buildfeatureOptionView(l,t),U.disableDictionaryItems(e);var s=[{IdValue:"ID_Dictionary",StateValue:!1}];U.initialiseFeatureTypeForEffectivityOptions(e,t),1==U.checkFlag?(U.initialiseVerticalEffectivityView(e),U.initialiseToolbar(U.effectivityGridView.toolbar),C.setToolbarState(s),"Native"!=window.enoviaServerFilterWidget.mode?U.effectivityGridView.toolbar.updateNodeModel("ID_SwitchView",{visibleFlag:!0}):U.effectivityGridView.toolbar.updateNodeModel("ID_SwitchView",{visibleFlag:!1}),U.effectivityGridView.toolbar.updateNodeModel("ID_ColumnManager",{visibleFlag:!0}),U.effectivityGridView.toolbar.updateNodeModel("ID_SEARCHFEATUREOPTION",{visibleFlag:!0})):(U.initialiseHorizontalEffectivityView(e.get("idModel")),U.initialiseToolbar(U.horizontalGridView.toolbar));var d=U.getCurrentSelectedView();U.cssAdjustmentsForLayout(d,U.attachedModels.length),U.updateDisplayExpression(),U.updateColumnsFromSettings();var c=U.cfgCollectionVertical.get(U.currentSelectedModelId);U.effectivityGridView.refreshColumns(c.get("columns")),U.isModified=!1,x.unmask(i.options.parent.body)},function(e){r.showwarning(M.Dictionary_Error,"error"),x.unmask(i.options.parent.body)})}else{i=this;var n=U.processDictionary(t);if(U.isWebUXAutocompleteEnabled&&!0===U.isWebUXAutocompleteEnabled?U.autocomplete.drawDictionary(n,i.options):U.autocomplete.drawDictionary(n),void 0===(l=e.get("treeDocumentVariantDictionary"))){var l=U.createDictionaryTreeDocument(n);e.set("treeDocumentVariantDictionary",l)}l=e.get("treeDocumentVariantDictionary"),U.buildfeatureOptionView(l,n),U.disableDictionaryItems(e);var s=[{IdValue:"ID_Dictionary",StateValue:!1}];1==U.checkFlag?(U.initialiseVerticalEffectivityView(e),U.initialiseToolbar(U.effectivityGridView.toolbar),C.setToolbarState(s),"Native"!=window.enoviaServerFilterWidget.mode?U.effectivityGridView.toolbar.updateNodeModel("ID_SwitchView",{visibleFlag:!0}):U.effectivityGridView.toolbar.updateNodeModel("ID_SwitchView",{visibleFlag:!1}),U.effectivityGridView.toolbar.updateNodeModel("ID_ColumnManager",{visibleFlag:!0}),U.effectivityGridView.toolbar.updateNodeModel("ID_SEARCHFEATUREOPTION",{visibleFlag:!0})):(U.initialiseHorizontalEffectivityView(e.get("idModel")),U.initialiseToolbar(U.horizontalGridView.toolbar));var d=U.getCurrentSelectedView();U.cssAdjustmentsForLayout(d,U.attachedModels.length),U.updateDisplayExpression(),x.unmask(i.options.parent.body)}},isValidEffectivityForDictionary:function(e,t){let i=!0;if(e){let o=[];if(e.length>0){for(let e=0;e<t.features.length;e++)o.push(t.features[e].name);for(let t=0;t<e.length;t++){let a=e[t]._options.data.value;if(-1==o.indexOf(a)){i=!1;break}}}}return i},initialiseFeatureTypeForEffectivityOptions:function(e,t){var i=e.get("treeDocument"),o=t;i.prepareUpdate();var a=i.getRoots();if(1==this.isValidEffectivityForDictionary(a,o)){for(var n=0;n<a.length;n++)for(var l=a[n]._options.data.value,s=0;s<o.features.length;s++)if(l==o.features[s].name){this.updateAttributes(a[n],o.features[s]),a[n]._options.data.featureType=o.features[s].featureType;for(var d=a[n].getChildren(),c=0;c<d.length;c++){d[c]._options.data.featureType=o.features[s].featureType;for(var u=o.features[s].options,p=0;p<u.length;p++)d[c]._options.data.value==u[p].name&&(this.updateAttributes(d[c],u[p]),p=u.length)}}}else r.showwarning(M.Evolution_Impact_Msg,"warning");i.pushUpdate()},updateAttributes:function(e,t){for(var i=e._options.grid,o=I.getColumnIndexes("VariantsAndOptionGroups"),a=0;a<o.length;a++){var n=o[a];"type"!=o[a]&&"current"!=o[a]||(n+="_NLS"),null==t[n]&&(n=o[a]),null==t[n]&&(t[n]=""),i[o[a]]=t[n]}e.updateOptions({grid:i})},addColumn:function(e){e.addColumn(),U.effectivityGridView.refreshColumns(e.get("columns"))},getCurrentSelectedView:function(){return 1==U.checkFlag?U.effectivityGridView.VariantGridView:U.horizontalGridView.massVariantGridView},cssAdjustmentsForLayout:function(e,t){1==t?e.getContent(".wux-layouts-collectionview").setStyles({height:"calc(100% - 10px)",top:"10px",bottom:"160px",left:"0px",width:"calc(100% - 0px) ",border:"1px solid rgb(212, 212, 212)"}):e.getContent(".wux-layouts-collectionview").setStyles({height:"calc(100% - 10px)",top:"10px",bottom:"150px",left:"0px",width:"calc(100% - 0px)",border:"1px solid rgb(212, 212, 212)"})},cssAdjustmentsForHeightMinimise:function(e,t){"fullScreenSingle"==t?e.getContent(".wux-layouts-collectionview").setStyles({bottom:"40px"}):"partialScreenSingle"==t&&e.getContent(".wux-layouts-collectionview").setStyles({bottom:"160px"}),"fullScreenMultiple"==t?e.getContent(".wux-layouts-collectionview").setStyles({bottom:"40px"}):"partialScreenMultiple"==t&&e.getContent(".wux-layouts-collectionview").setStyles({bottom:"150px"})},initialiseAutocompleteView:function(e){U.isWebUXAutocompleteEnabled&&!0===U.isWebUXAutocompleteEnabled?U.autocomplete=c.initialiseAutocomplete(e):U.autocomplete=d.initialiseAutocomplete(e)},processAttachedModels:function(e){for(var t=[],i=e,o=0;o<i.length;o++){var a={displayName:"",name:"",revision:""};a.physicalId=i[o].physicalID;for(var n=0;n<i[o].data.length;n++)"Marketing Name"==i[o].data[n].name&&(a.displayName=i[o].data[n].value[0]);for(n=0;n<i[o].basicData.length;n++)"name"==i[o].basicData[n].name&&(a.name=i[o].basicData[n].value[0]);t.push(a)}return t},initialiseExpandCollpaseEvents:function(){},getModelswithEffExpression:function(){return U.cfgCollectionVertical.getModelswithEffExpression()},switchViews:function(e){U.checkFlag="ID_HORIZONTALVIEW"!=e,U.initialiseVerticalCollection(),U.resetAttributes(),U.updateColumnsFromSettings(),U.resetHorizontalCollection(),U.initialiseUI(U.cfgCollectionVertical.get(U.currentSelectedModelId));var t=U.getCurrentSelectedView();U.cssAdjustmentsForLayout(t,U.attachedModels.length),U.updateDisplayExpression(),U.isModified=!1},showColumnManager:function(e){var t={type:"VariantsAndOptionGroups",viewId:e.viewId,parent:U.options.parent,onCloseCallback:U.onColumnManagerComplete,touchMode:!0};I.create(t)},updateColumnsFromSettings:function(){for(var e=S.UserSettings.effectivityView_VariantsAndOptionGroups,t=0;t<U.cfgCollectionVertical.length;t++){for(var i=U.cfgCollectionVertical.at(t),o=i.get("columns"),a=0;a<o.length;a++)"string"==o[a].typeRepresentation&&null!=o[a]&&null!=e[o[a].dataIndex]&&(o[a].visibleFlag=e[o[a].dataIndex]);i.set("columns",o)}},onColumnManagerComplete:function(e){if("SAVE"==e._event)if("effectivityView"==I.options.viewId){U.updateColumnsFromSettings();var t=U.cfgCollectionVertical.get(U.currentSelectedModelId);U.effectivityGridView.refreshColumns(t.get("columns"))}else U.featureOptionsView.updateColumnsFromSettings();U.sliderView.show()}};function N(e){var t=function(){o.closeDialog()},i={width:539,height:170,isResizable:!1,dialogue:{header:M.SwitchingView,buttonArray:[{label:"Ok",labelValue:M.Ok,handler:function(){U.isModified=!1,U.switchViews(e),o.closeDialog()},className:"primary"},{label:"Cancel",labelValue:M.Cancel,handler:t,className:"default"}],target:widget.body,object:null,postCrossHandler:t}},o=new D(i);o.render(),o.container.setStyle("overflow","auto"),o.container.setHTML(M.EffectivityReset+"<br><br>"+M.ResetQuestion+"<br>")}return U}),define("DS/CfgVariantEffectivityEditor/scripts/CfgVariantEffectivityInit",["DS/CfgBaseUX/scripts/CfgData","DS/CfgBaseUX/scripts/CfgDialog","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgVariantEffectivityEditor/scripts/CfgVariantEffectivityController","DS/CfgBaseUX/scripts/CfgContainerView","DS/Utilities/TouchUtils","DS/CfgTracker/CfgTracker","DS/CfgTracker/CfgDimension","DS/CfgTracker/CfgValue","i18n!DS/CfgBaseUX/assets/nls/CfgBaseUXNLS","i18n!DS/CfgVariantEffectivityEditor/assets/nls/CfgVariantEffectivityEditor","css!DS/CfgVariantEffectivityEditor/assets/styles/CfgVariantEffectivityEditor.css"],function(e,t,i,o,a,n,r,l,s,d,c){"use strict";var u={cancelDialog:function(){u.cfgVarDialog.closeDialog(),console.log("cfgVarDialog closed")},sendEditVariantTrackerEvent:function(e){let t="",i="",o=e.noOfContext,a=e.noOfReference,n=e.totalVariantLength,d=e.totalVariantValueLength,c=e.totalOptionGroupLength,u=e.totalOptionLength,p=e.totalNotOperatorLength,f=e.variantComplexity,h=e.totalFeaturesLength,g=e.totalFeatureOptionsLength;"Native"==e.mode?(t="Native",i="Web In Win"):(t=widget.data.appId,i=null!=widget.options?widget.options.title:"ODT Environment");let v=r.getDeviceUsedForOperation(),m=r.ConfigOperationMode.CREATE;"Edit"==e.variantMode&&(m=r.ConfigOperationMode.EDIT);let C=r.AuthoringMode.EMPTY;"Empty"!=e.authoringMode&&(C=r.AuthoringMode[e.authoringMode]);let V=r.EditVariantMode.SINGLE;r.createEventBuilder({category:r.Category.USAGE,action:r.Events.CLICK,tenant:enoviaServerFilterWidget.tenant}).setLabel(r.Labels.EDIT_VARIANT_EFFECTIVITY).setAppId(t).addDimension(l.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_EFFECTIVITY_WIDGET,i).addDimension(l.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_EFFECTIVITY_MEDIA,v).addDimension(l.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_EFFECTIVITY_MODE,m).addDimension(l.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_AUTHORING_MODE,C).addDimension(l.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_EFFECTIVITY_TYPE_MODE,V).addPersonalValue(s.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_NO_OF_MODEL,o).addPersonalValue(s.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_REFERENCE_SELECTED,a).addPersonalValue(s.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_TOTAL_NO_VARIANT,n).addPersonalValue(s.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_TOTAL_NO_VARIANT_VALUE,d).addPersonalValue(s.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_TOTAL_NO_OPTION_GROUP,c).addPersonalValue(s.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_TOTAL_NO_OPTION,u).addPersonalValue(s.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_TOTAL_NO_NOT_OPERATOR,p).addPersonalValue(s.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_COMPLEXITY,f).addPersonalValue(s.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_DICTIONARY_FEATURES,h).addPersonalValue(s.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_DICTIONARY_FEATURE_OPTIONS,g).send()},callEditVariantTrackerEvent:function(e){let t={noOfContext:u.MySkeleton.attachedModels.length,mode:"Dashboard"};"Native"==e.mode&&(t.mode="Native"),t.variantMode="Create",1==u.MySkeleton.options.hasEffectivity&&(t.variantMode="Edit"),t.authoringMode="Empty",u.MySkeleton.options.ca.headers.length>0&&("DS-Change-Authoring-Context"==u.MySkeleton.options.ca.headers[0].key?t.authoringMode="CHANGE":"DS-Configuration-Authoring-Context"==u.MySkeleton.options.ca.headers[0].key&&(t.authoringMode="EVOLUTION")),t.noOfReference=1;let i=u.MySkeleton.getProbesInfoDetailsWithXML(e.globalExpression);t.totalVariantLength=i.totalVariantLength,t.totalVariantValueLength=i.totalVariantValueLength,t.totalOptionGroupLength=i.totalOptionGroupLength,t.totalOptionLength=i.totalOptionLength,t.totalNotOperatorLength=i.totalNotOperatorLength,t.variantComplexity=i.variantComplexity,t.totalFeaturesLength=i.totalFeaturesLength,t.totalFeatureOptionsLength=i.totalFeatureOptionsLength,u.sendEditVariantTrackerEvent(t)},setVariantEffectivity:function(){var e=u.MySkeleton.getGlobalXMLExpression();if(console.log("Variant XMLExpression : "+e),1!=u.varOptions.isEmptyVariantEffectivity||""!=e){u.globalExpression=e;var t,o=function(e){console.log(e);var t=" ",o=" ";if(null!=e.GlobalStatus&&"SUCCESS"==e.GlobalStatus){var a=e.results[0],n=a.existing,r=a.new;if(null!=n&&null!=n.pid&&(t=n.pid,null!=n.content&&null!=n.content.Variant)){var l=n.content.Variant;e.results[0].existing.content.displayExpression=i.getDisplayExpressionUsingXSLT(l)}if(null!=r&&null!=r.pid&&(o=r.pid,null!=r.content&&null!=r.content.Variant)){var s=r.content.Variant;e.results[0].new.content.displayExpression=i.getDisplayExpressionUsingXSLT(s)}}if(u.varOptions.postOKHandler&&u.varOptions.postOKHandler(e),null!=e.GlobalStatus&&"SUCCESS"==e.GlobalStatus){var p={commandName:"cfgEditVariant",widgetId:widget.id,response:i.getEventResponse(e),data:{}};i.publishPostProcessingEventForApplications(p)}" "!=t&&" "!=o&&i.showwarning(c.CFG_Application_Refresh_For_Instance_Evolved,"info"),u.cfgVarDialog.closeDialog(),void 0!==e.GlobalStatus&&"SUCCESS"==e.GlobalStatus||void 0!==e.unset&&("SUCCESS"===e.unset.Variant.status.toUpperCase()||"WARNING"===e.unset.Variant.status.toUpperCase())?i.showwarning(c.Save_Successful_Var_Effectivity,"success"):void 0!==e.GlobalStatus&&"ERROR"==e.GlobalStatus&&void 0!==e.results[0].errorDetails?(126==e.results[0].errorCode?i.showwarning(d.CfgMessageWorkUnderDifferentCriteriaEditVariantFailed+"<b>"+d.CfgHeaderEditConfigurationContext+"</b>","error"):135==e.results[0].errorCode?i.showwarning(c.Save_Fail_Var_Effectivity+" "+e.results[0].message,"error"):i.showwarning(c.Save_Fail_Var_Effectivity+" "+e.results[0].errorDetails,"error"),console.log("Edit Variant Effectivity operation error = "+e.results[0].errorDetails)):i.showwarning(c.Save_Fail_Var_Effectivity,"error"),u.callEditVariantTrackerEvent({mode:"Dashboard",globalExpression:u.globalExpression})},a=function(e){console.log(e),u.cfgVarDialog.closeDialog(),i.isDefined(e)&&i.isDefined(e.errorMessage)?i.showwarning(c.Save_Fail_Var_Effectivity+"\n"+e.errorMessage,"error"):i.showwarning(c.Save_Fail_Var_Effectivity,"error")},n=null;if(u.varOptions.ca.headers.length>0&&(n={operationheader:{key:u.varOptions.ca.headers[0].key,value:u.varOptions.ca.headers[0].value}}),""==e){var r=[];r.push(u.varOptions.instanceID),t={version:"1.0",wsOptions:n,unsetList:r,domain:"Variant"},i.unsetVariantEffectivities(t).then(function(e){o(e)},function(e){a(e)})}else t={version:"1.1",domain:"Variant",view:"All",expressionList:[{pid:u.varOptions.instanceID,VariantContent:e}],wsOptions:n},i.setVariantEffectivities(t).then(function(e){o(e)},function(e){a(e)})}else u.cfgVarDialog.closeDialog()},onSaveEffectivity:function(e){if("Native"==window.enoviaServerFilterWidget.mode){var t={modelIdsWithEffectivity:u.MySkeleton.getModelswithEffExpression(),globalEffectivityExpression:u.MySkeleton.getGlobalXMLExpression(),propagateSessionEffectivity:e.propagateSessionEffectivity},o={eventName:"cfgEditVariantEffectivity",operation:"firstButton"==e.buttonId?"OK":"Cancel",operationVersion:"1.0",content:JSON.stringify(t)};i.sendNotificationWebInWin(o),u.callEditVariantTrackerEvent({mode:"Native",globalExpression:t.globalEffectivityExpression})}},init:function(i){e.clear(),this.varOptions=i,this.varOptions.touchMode=n.getTouchMode();if("Dashboard"==this.varOptions.mode)this.varOptions.dialogue.buttonArray=[{label:"Ok",labelValue:c.Edit_Var_OK,handler:this.setVariantEffectivity,className:"primary"},{label:"Cancel",labelValue:c.Edit_Var_Cancel,handler:this.cancelDialog,className:"default"}],this.varOptions.height=1e3,this.varOptions.width=1100,this.varOptions.minHeight=406,this.varOptions.minWidth=320,this.cfgVarDialog=new t(this.varOptions),this.cfgVarDialog.render(),this.varOptions.parent=this.cfgVarDialog.container,this.varOptions.parentElement=this.cfgVarDialog.container,this.MySkeleton=o.init(this.varOptions);else{var r={isHeader:!1,isFooter:!0,firstButtonText:c.Edit_Var_OK,secondButtonText:c.Edit_Var_Cancel,headerText:"",toggleSessionEffectivity:!1,onButtonClickCB:this.onSaveEffectivity};this.variantContainer=new a(r).render(),this.variantContainer.inject(i.parentElement),this.varOptions.parent=this.variantContainer._body,this.MySkeleton=o.init(this.varOptions)}}};return u});