define("DS/DMUValidationPersistence/DMUValidationPersistenceServices",["DS/DMUReadPersistence/DMUReviewPersistenceServicesSetting","UWA/Utils"],function(e,i){"use strict";const n=e=>{try{JSON.parse(e)}catch(e){return!1}return!0};return{createReviewInDataBase:function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/createValidation",config:{verb:"POST",data:JSON.stringify({sName:i.reviewName,sContextId:i.parentID,sDescription:i.reviewDescription,sAddMarkup:i.createMarkup?"true":"false",sMarkupName:i.markupName,sMarkupDescription:i.markupDescription,sContextAsValidated:i.contextAsValidated,sServiceID:i.serviceID})},onSuccess:function(e){i.onReviewCreationCompleted(e?JSON.parse(e):{})},onFailure:function(e){i.onReviewCreationFailed(e?n(e)?JSON.parse(e):e:{})}})},addChild:function(e){var i=JSON.parse(localStorage.getItem("currentValidation")?localStorage.getItem("currentValidation"):"{}");i.children.push({type:e.type,id:e.id,name:e.name,children:[]}),localStorage.setItem("currentValidation",JSON.stringify(i))},addMarkup:function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/addMarkup",config:{verb:"POST",data:JSON.stringify({sName:i.mkpName,sValidationId:i.validationId,sDescription:i.mkpDescription})},onSuccess:function(e){i.onMarkupCreationCompleted(e?JSON.parse(e):{})},onFailure:function(e){i.onMarkupCreationFailed(e?n(e)?JSON.parse(e):e:{})}})},saveReviewMarkup:function(n){var t,a=new Blob([n.jsonContent],{type:"application/json"}),r=i.getUUID().toString();(t="VALReview",new Promise(function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/getCheckinTicket",config:{verb:"POST",data:JSON.stringify({sObjectType:t})},onSuccess:function(e){i(e?JSON.parse(e):{})}})})).then(function(i){var t,o=i.checkinTicket,s=i.actionURL;o&&s&&(t={file:a,ticket:o,URL:s,correlationId:r,fileName:"WebReviewContent.json"},new Promise(function(e){var i=new FormData;i.append("__fcs__jobTicket",t.ticket),i.append("file_0",t.file,t.fileName);var n=new XMLHttpRequest;n.open("POST",t.URL,!0),n.onload=function(){200===n.status&&e(n.responseText)},n.send(i)})).then(function(i){var t=i;t&&function(i){return new Promise(function(n){e.sendWebServiceCall({url:"resources/validationauthoring/service/checkinStreamInfo",config:{verb:"POST",data:JSON.stringify({sObjectId:i.ObjectId,sReceipt:i.receipt,sJsonStream:i.stream,sFileName:i.fileName,sPersistencyType:i.persistencyType,sPersistencyName:i.persistencyName})},onSuccess:function(e){n(e?JSON.parse(e):{})}})})}({ObjectId:n.markupRepRefId,receipt:t,stream:n.jsonContent,fileName:"WebReviewContent.json",persistencyName:"WebReviewContent",persistencyType:"json"}).then(function(e){e&&n.onSaveReviewMarkupCompleted()})})})},saveValidatedObject:function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/updateValidatedObjects",config:{verb:"POST",data:JSON.stringify({sValidatedId:i.validatedId,sValidatedObjectIds:i.validatedObjects})},onSuccess:function(e){i.onSaveValidatedObjectsCompleted(e?JSON.parse(e):{})},onFailure:function(e){i.onSaveValidatedObjectsFailed(e?n(e)?JSON.parse(e):e:{})}})},addChecks:function(i){let t=i.listObjects;e.sendWebServiceCall({url:"resources/validationauthoring/service/addValidationChecks",config:{verb:"POST",data:JSON.stringify({listObjects:t})},onSuccess:function(e){i.onCheckCreationCompleted(e?JSON.parse(e):{})},onFailure:function(e){i.onCheckCreationFailed(e?n(e)?JSON.parse(e):e:{})}})},addCheck:function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/addValidationCheck",config:{verb:"POST",data:JSON.stringify({sValidationId:i.validationId,sRequirementDocId:i.requirementDocId,sName:i.checkName,sDescription:i.description,iCheckState:i.checkState})},onSuccess:function(e){i.onCheckCreationCompleted(e?JSON.parse(e):{})},onFailure:function(e){i.onCheckCreationFailed(e?n(e)?JSON.parse(e):e:{})}})},setCheckRequirement:function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/setCheckRequirement",config:{verb:"POST",data:JSON.stringify({sCheckId:i.checkId,sRequirementId:i.requirementId,sRemoveReq:i.removeReq})},onSuccess:function(e){i.onSetCheckRequirementComplete(e?JSON.parse(e):{})},onFailure:function(e){i.onSetCheckRequirementFailed(e?n(e)?JSON.parse(e):e:{})}})},setImpactedCheck:function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/setImpactedCheckOnHighlight",config:{verb:"POST",data:JSON.stringify({sCheckId:i.checkId,sHighlightId:i.highlightId})},onSuccess:function(e){i.onSetImpactedCheckComplete(e?JSON.parse(e):{})},onFailure:function(e){i.onSetImpactedCheckFailed(e?n(e)?JSON.parse(e):e:{})}})},removeImpactedCheck:function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/removeImpactedCheckOnHighlight",config:{verb:"POST",data:JSON.stringify({sCheckId:i.checkId,sHighlightId:i.highlightId})},onSuccess:function(e){i.onRemoveImpactedCheckComplete(e?JSON.parse(e):{})},onFailure:function(e){i.onRemoveImpactedCheckFailed(e?n(e)?JSON.parse(e):e:{})}})},updateAttributes:function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/modifyAttributes",config:{verb:"POST",data:JSON.stringify({listObjects:i.objectsToModify})},onSuccess:function(e){i.onAttributesSaveCompleted(e?JSON.parse(e):{})},onFailure:function(e){i.onAttributesSaveFailed(e?n(e)?JSON.parse(e):e:{})},platform:i.platform})},updateReviewContext:function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/updateValidationContext",config:{verb:"POST",data:JSON.stringify({sValidationId:i.validationId,sProductId:i.contextId,sServiceID:i.serviceID})},onSuccess:function(e){i.onUpdateReviewContextCompleted(e?JSON.parse(e):{})},onFailure:function(e){i.onUpdateReviewContextFailed(e?n(e)?JSON.parse(e):e:{})}})},deleteObject:function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/deleteObject",config:{verb:"POST",data:JSON.stringify({sObjectIds:i.objectIds})},onSuccess:function(e){i.onObjectDeletionCompleted(e?JSON.parse(e):{})},onFailure:function(e){i.onObjectDeletionFailed(e?n(e)?JSON.parse(e):e:{})}})},addHighlight:function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/addHighlight",config:{verb:"POST",data:JSON.stringify({sValidationId:i.validationId,sMarkupRepRefPathIds:i.markupRepRefPathIds,sName:i.checkName,sDescription:i.description,sSlideId:i.slideId,iPresentationRating:i.rating})},onSuccess:function(e){i.onHighlightCreationCompleted(e?JSON.parse(e):{})},onFailure:function(e){i.onHighlightCreationFailed(e?n(e)?JSON.parse(e):e:{})}})},addReply:function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/addValidationReply",config:{verb:"POST",data:JSON.stringify({sMarkupRefId:i.markupRefId,sName:i.name,sDescription:i.description})},onSuccess:function(e){i.onReplyCreationCompleted(e?JSON.parse(e):{})},onFailure:function(e){i.onReplyCreationFailed(e?n(e)?JSON.parse(e):e:{})}})},generateName:function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/generateName",config:{verb:"POST",data:JSON.stringify({sListTypeName:i.sListTypeName})},onSuccess:function(e){i.onGenerateNameCompleted(e?JSON.parse(e):{})},onFailure:function(e){i.ononGenerateNameFailed(e?n(e)?JSON.parse(e):e:{})}})}}});