define("DS/DELPPWMfgStructureModule/MfgStructureModule",["UWA/Core"],function(e){"use strict";return{behaviors:["UXFactoryBehavior","ResourceBehavior","ModelBehavior","WUXNodeModelBehavior","TreeListViewBehavior","ImplementBehavior","SelectionBehavior","MfgItemBehavior","ViewBehavior","RootsBehavior"],creator:function(t,n,i,o,r,l,m,s,a,c,g){var d,p,u,I,f,S,h,C,M,v,P,b,R,D,U,B,L=null,w={},N=null;return p=function(t,n){if(w={},!e.is(t))throw new Error("Command ID is null");w.cmdId=t,w.onOKCallBack=n,w.onCancelCallback=v},f=function(){e.is(L)&&(L.isVisible()&&L.destroyUI(),L=void 0)},S=function(e){var t=!0,n=c.getActiveView();return!1===e.changed.isSelected&&e.sourceId!==n&&(t=!1),t},I=function(){var t,n,i,r,l={},s=[],a=!1;return t=L.getImplementingID(),r=L.getImplementedIDs()[0],e.is(t)&&(n=o.getReferenceId(t),(i=m.getScopeLinksOfImplementing(n)).length>0&&(l.id=i[0].get("to"),s.push(l),e.is(r)?o.getReferenceId(r)!==l.id&&(L.updateImplemented(s),a=!0):(L.updateImplemented(s),a=!0))),a},u=function(e){var t,n;!0===e.bUpdateImplemented?(L.updateImplemented(e.selNodes),t="ImplementUI.ImplementedSelectionNotAllowed",n="error"):!0===e.bUpdateImplementing&&(L.updateImplementing(e.selNodes),t="ImplementUI.ImplementedSelectionChanged",n="info"),!0===I()&&L.showMessages(i.getNLSValue(t),n)},h=function(t){if(w={},!e.is(t))throw new Error("Command ID is null");w.cmdId=t,w.moduleOptions=d,w.onOKCallBack=b,w.onCancelCallback=v},C=function(e,t){N.updateImplementingLabel(e),o.getMajorRevisions(t,function(e){N.updateImplementedRevnList(t,e,!1)})},M=function(){e.is(N)&&(N.isVisible()&&N.destroyUI(),N=void 0)},P=function(t){var r,l,s,c,g,d,p,u,I={};e.is(t)&&(r=o.getReferenceModel(t.implementingId),l=o.getReferenceModel(t.implementedIDs[0]),s=o.getInstance(t.implementingId),c=o.getInstance(t.implementedIDs[0]),s&&c&&m.isImplementLinkPossible(t.implementingPaths[0],t.implementedPaths[0])&&(g=s.get("PID"),d=m.getPathToScope(t.implementedPaths[0])),p=r.get("V_Name"),u=l.get("V_Name"),I.scopeCreation=t.scopeCreation,I.prefix=t.mfgItemPrefix,I.logMessage=i.getNLSValue("CreateMfgItemStructure.LogMessage",{mbom:p,ebom:u}),I.computeResultReport=!!e.is(t.resultReportMode)&&"no_report"!==t.resultReportMode,a.webservice("Create",{product:{referencePID:l.get("PID"),OccPath:d},mfgItem:{referencePID:r.get("PID"),instancePID:g}},I,function(i){var o;i=i||{},e.is(i.resultReport)&&(e.is(t.resultReportMode)&&(o=t.resultReportMode),n.create("MfgItemCreateReportUI",{report:i.resultReport,mode:o}))}),f())},b=function(t){var n,r={};e.is(t)&&(n=o.getReferenceModel(t.implementingId).get("V_Name"),r.backgroundJobFlag=!1,r.scopeCreation=t.scopeCreation,r.prefix=t.mfgItemPrefix,r.logMessage=i.getNLSValue("UpdateMfgItemStructure.LogMessage",{mbom:n}),r.updateIntermediateScopedAssemblies=t.updateIntermediateScopedAssemblies,a.webservice("Update",{product:{referencePID:t.implementedId,productConfigFilter:B[t.implementedId]},mfgItem:{referencePID:t.implementingId,processConfigFilter:U[t.implementingId]}},r),M())},v=function(){f(),M()},R=function(){v(),p("CreateMfgItemStructure",P),w.cmdTitle="Dialog.CreateMfgItemStructure.Title",w.implementingSection=!0,w.implementedSection=!0,w.optionsSection=!0,w.scopeOption="ComboBox",w.mfgItemPrefix=!0,w.mfgItemResultReport=!0,w.multiSelectionOfImplementing=!1,w.multiSelectionOfImplemented=!1,L=n.create("ImplementUI",w),u(L.getSelectionsWithPaths())},D=function(){var r,l,a,c,d,p=s.getSelectionsWithPaths()[1][0],u=p.id,I=o.getReferenceModel(u);if(v(),!e.is(I))return void t.debug("UpdateMfgItemStructure: Reference Model not found for pid:"+u);if(a=I.get("PID"),(r=m.getScopeLinksOfImplementing(a)).length<=0)return void t.warn(i.getNLSValue("Error.NoProductScopeExists.Title"));if(l=r[0].get("to"),e.is(p.path,"array")&&p.path.length>0){const e=p.path[0];d=o.getInstance(e).get("isAggregatedBy");const n=m.getScopeLinksOfImplementing(d);if(0===n.length)return void t.warn(i.getNLSValue("Error.NoProductScopeExists.Title"));c=n[0].get("to")}else c=l,d=a;const f=g.getCompatibleConfigurationFilters([d]),S=g.getCompatibleConfigurationFilters([c]);e.is(f)&&e.is(S)?(U={...f},B={...S},h("UpdateMfgItemStructure"),w.cmdTitle="Dialog.UpdateMfgItemStructure.Title",w.implementedRevTreeListCSSStyle="implementedSection-container-withChkBox",w.optionsSection=!0,w.scopeOption="ComboBox",w.mfgItemPrefix=!0,w.defaultHeight="430",w.modalFlag=!0,N=n.create("ImplementedRevChooserUI",w),C(a,l)):t.warn(i.getNLSValue("BI.Computation.IncompatibleFilter"))},{listenTo:function(){return{select:this.onSelect,CreateMfgItemStructure:R,UpdateMfgItemStructure:D}},onStart:function(e){d=e},onStop:function(){f(),M()},onSelect:function(t){if(e.is(L)&&L.isVisible()&&e.is(t)){if(!1===S(t))return;e.is(t.changed)&&u(L.getSelectionsWithPaths())}}}}}});