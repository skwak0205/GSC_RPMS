define("DS/DocumentPreview/Actions",["UWA/Core","UWA/Utils/InterCom","DS/DocumentManagement/DocumentManagement","DS/UIKIT/Dropdown","DS/UIKIT/Input/Button","DS/UIKIT/Input/Text","i18n!DS/DocumentPreview/assets/nls/DocumentPreview"],function(e,t,n,i,o,s,a){"use strict";return{close:function(e,t,n,i){i.close()},loadNext:function(e,t,n,i){i.events.publish({event:"onNextClick",data:{nodeModel:i.options.nodeModel}})},loadPrevious:function(e,t,n,i){i.events.publish({event:"onPrevClick",data:{nodeModel:i.options.nodeModel}})},favorite:function(e,t,n,i){i.events.publish({event:"onFavoriteClick",data:{e:e,target:t,document:i.options.document}})},information:function(e,t,n,i){i.showInformation()}}}),define("DS/DocumentPreview/Actions2/Files",["UWA/Core","i18n!DS/DocumentPreview/assets/nls/DocumentPreview"],function(e,t){"use strict";var n=function(e){return{id:"Files",dataElements:{docV2Preview:!0,typeRepresentation:"enumCustom",value:e.getSelectedFile&&e.getSelectedFile()?e.getSelectedFile().id:void 0,possibleValues:e.getFilesLabelsAndIds?e.getFilesLabelsAndIds():{},label:t.get("FILE_LABEL"),tooltip:t.get("FILE_LABEL"),position:"near",displayLabel:!0,priority:100,visibleFlag:!0},onNodeUpdate:function(t){var n=t.getAttributeValue("data");e.setSelectedFile(n)},execute:function(){n.execute({options:e})},updateForSelection:function(e,t){}}};return n.execute=function(e){},n}),define("DS/DocumentPreview/Actions2/Next",["UWA/Core","i18n!DS/DocumentPreview/assets/nls/DocumentPreview"],function(e,t){"use strict";var n=function(e){return{id:"Next",dataElements:{docV2Preview:!0,typeRepresentation:"functionIcon",icon:{iconName:"chevron-right",fontIconFamily:1},label:t.get("NEXT"),tooltip:t.get("NEXT"),position:"far",category:"stable area",priority:10,value:function(t){t.options=e,n.execute(t)},visibleFlag:!0},execute:function(){n.execute({options:e})},updateForSelection:function(t,n){e.ctrl.options.hideNextPrev?t({visibleFlag:!1}):(t({visibleFlag:!0}),e.events.publish({event:"IsNextAndPreviousItemAvailable",data:{callback:function(e){e.next?t({disabled:!1}):t({disabled:!0})},nodeModel:e.getSelectedNodes()[0]}}))}}};return n.execute=function(e){var t=e.options.ctrl;t.events.publish({event:"onNextClick",data:{nodeModel:t.options.nodeModel}})},n}),define("DS/DocumentPreview/Actions2/CloseBtn",["UWA/Core","i18n!DS/DocumentPreview/assets/nls/DocumentPreview"],function(e,t){"use strict";var n=function(e){return{id:"Close",dataElements:{docV2Preview:!0,typeRepresentation:"functionIcon",icon:{iconName:"close",fontIconFamily:1},label:t.get("CLOSE"),tooltip:t.get("CLOSE"),position:"far",category:"stable area",priority:10,value:function(t){t.options=e,n.execute(t)},visibleFlag:!0},execute:function(){n.execute({options:e})},updateForSelection:function(t,n){t({visibleFlag:1==e.getSelectedNodes().length})}}};return n.execute=function(e){var t=e.options.ctrl;e.options.events.publish({event:"close-preview2"}),t.close()},n}),define("DS/DocumentPreview/Actions2/Information",["UWA/Core","i18n!DS/DocumentPreview/assets/nls/DocumentPreview","css!DS/DocumentPreview/DocumentPreview.css"],function(e,t){"use strict";var n=function(e){return{id:"Information",dataElements:{docV2Preview:!0,typeRepresentation:"functionIcon",icon:{iconName:"info",fontIconFamily:1},label:t.get("INFORMATION"),tooltip:t.get("INFORMATION"),position:"far",priority:8,value:function(t){t.options=e,n.execute(t)},visibleFlag:!0},execute:function(){n.execute({options:e})},updateForSelection:function(t,n){var i=!1;null==e.ctrl.elements.info||e.ctrl.elements.info.isHidden()||(i=!0),t({icon:{iconName:"info",fontIconFamily:1,className:i?"info-active":""}})}}};return n.execute=function(e){var t=e.options.ctrl;(e.options.keepOpen||t.elements.info.isHidden())&&(e.options.keepOpen=!0,null==t.propertiesComponent?(t.options.nodeModels=[t.options.nodeModel],t.options.documents=[t.options.document],require(["DS/DocumentPreview/PropertiesComponent"],function(e){t.propertiesComponent=new e(t.options),t.propertiesComponent.events.unsubscribeAll({event:"close-document-properties"}),t.propertiesComponent.events.subscribe({event:"close-document-properties"},function(){t.elements.info.hide(),t.elements.viewer.setStyles({opacity:1}),t.topBar.previewToolBar.selectionChanged()}),t.propertiesComponent.events.subscribe({event:"edit-prop-property-change"},function(e){if("Title"===e.attribute){var n=e.attribute,i=e.editprop._attributes[n].value;t.topBar.setTitleText(i)}}),t.propertiesComponent.inject(t.elements.info)})):(t.propertiesComponent.nodeModels=[t.options.nodeModel],t.propertiesComponent.setSelection([t.options.document]))),t.elements.info.isHidden()?t.elements.info.show():e.options.keepOpen&&(t.elements.info.hide(),t.elements.viewer.setStyles({opacity:1})),t.topBar.previewToolBar.selectionChanged()},n}),define("DS/DocumentPreview/Actions2/Previous",["UWA/Core","i18n!DS/DocumentPreview/assets/nls/DocumentPreview"],function(e,t){"use strict";var n=function(e){return{id:"Previous",dataElements:{docV2Preview:!0,typeRepresentation:"functionIcon",icon:{iconName:"chevron-left",fontIconFamily:1},label:t.get("PREVIOUS"),tooltip:t.get("PREVIOUS"),position:"far",category:"stable area",priority:10,value:function(t){t.options=e,n.execute(t)},visibleFlag:!0},execute:function(){n.execute({options:e})},updateForSelection:function(t,n){e.ctrl.options.hideNextPrev?t({visibleFlag:!1}):(t({visibleFlag:!0}),e.events.publish({event:"IsNextAndPreviousItemAvailable",data:{callback:function(e){e.previous?t({disabled:!1}):t({disabled:!0})},nodeModel:e.getSelectedNodes()[0]}}))}}};return n.execute=function(e){var t=e.options.ctrl;t.events.publish({event:"onPrevClick",data:{nodeModel:t.options.nodeModel}})},n}),define("DS/DocumentPreview/PropertiesComponent",["UWA/Core","DS/Core/ModelEvents","DS/UIKIT/Iconbar","DS/EditPropWidget/EditPropWidget","DS/EditPropWidget/constants/EditPropConstants","DS/EditPropWidget/models/EditPropModel","i18n!DS/DocumentPreview/assets/nls/DocumentPreview","css!DS/DocumentPreview/DocumentPreview.css"],function(e,t,n,i,o,s,a,r){"use strict";return e.Controls.Abstract.extend({name:"document-properties",options:{className:""},init:function(e){this._parent(e),this._options=e,this.e6wDocuments=e.documents,this.platformUrls=e.platformUrls,this.tenant=e.tenant,this.securityContext=e.securityContext,this.events=e.modelEvents||new t,this.nodeModels=e.nodeModels,this.buildSkeleton()},buildSkeleton:function(){var t=this;this.elements.container=e.createElement("div",{class:this.getClassNames()});e.createElement("div",{class:this.getClassNames()+"-close-button fonticon fonticon-wrong fonticon-clickable",events:{click:function(){t.events.publish({event:"close-document-properties"})}}}).inject(this.elements.container);var n=e.createElement("div",{class:this.getClassNames()+"-editpropcontainer"});n.inject(this.elements.container);var s=[o.FACET_PROPERTIES,o.FACET_RELATIONS,o.FACET_SWYMCOMMENTS,o.FACET_SHARING,o.FACET_DERIVEDOUTPUT,o.FACET_IPPROTECTION],r=t.editPropertiesView=new i({typeOfDisplay:o.ALL,selectionType:o.NO_SELECTION,readOnly:!1,extraNotif:!0,facets:s,context:{getSecurityContext:function(){return{SecurityContext:t.options.securityContext}}}});r.inject(n),this.attachmentFacet={require:"DS/ENOXAttachmentsUX/AttachmentsFacet",alwaysVisible:1==this.e6wDocuments.length,services:["3DSpace"],inheritance:!0,content:null,facet:{name:"attachments",icon:"attach",text:a.get("ATTACHMENTS")},options:{appContext:{options:this.options,getDocumentId:function(){return t.options.documents[0].id}}}},this.setSelection(this.e6wDocuments),r.addFacets([this.attachmentFacet])},setSelection:function(e){var t=this;if(this.options.documents=e,this.e6wDocuments=e,this.e6wDocuments.length>0){var n=[],i=0;this.e6wDocuments.forEach(e=>{var o=i,a=new s({tenant:t.tenant,objectId:e.id});a.addEvent("onChangeAttributes",function(e,t){a.docLastChangedAttributes=t}),a.addEvent("onSave",function(e,n){console.log("onSave:",a.docLastChangedAttributes),a.docLastChangedAttributes.forEach(e=>{t.events.publish({event:"edit-prop-property-change",data:{editprop:a,attribute:e.name,nodeModel:t.nodeModels[o]}})})}),n.push(a),i++}),this.attachmentFacet.alwaysVisible=1==this.e6wDocuments.length,this.editPropertiesView.initDatas(n)}else this.editPropertiesView.initDatas([])}})}),define("DS/DocumentPreview/FilesToolbar",["UWA/Core","DS/Tweakers/GeneratedToolbar","DS/DocumentPreview/Actions2/Files","DS/DocumentCommands/DocumentCommandsV2","i18n!DS/DocumentPreview/assets/nls/DocumentPreview"],function(e,t,n,i,o){"use strict";return e.Class.extend({init:function(o,s,a){var r=this;let c;r.filesLabelsAndIds={},r.fileIdsAndFiles={},a.files.forEach(e=>{r.filesLabelsAndIds[e.dataelements.title]=e.id,r.fileIdsAndFiles[e.id]=e});let l={entries:[]};var d={fetchSecurityContext:function(){return o.options.securityContext},getWorkUnderHeaders:function(){return{}},getSelectedNodes:function(){return[o.options.nodeModel]},getDocumentFromNodeModel:function(e){return o.options.document},getOrigin:function(){return{source:e.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId,widgetId:widget.id,component:"PreviewFilesToolbar"}},getFilesLabelsAndIds:function(){return r.filesLabelsAndIds},getSelectedFile:function(){return a.selectedFile},setSelectedFile:function(e){a.selectedFile=r.fileIdsAndFiles[e],o.events.publish({event:"preview2-selected-file-changed",data:a.selectedFile})},platformUrls:o.options.platformUrls,events:o.events,ctrl:o};r.publicDocumentCommands=new i(d);var m=r.publicDocumentCommands.commands;l.entries=[new n(d),m.Download,m.CopyLink],l.entries.forEach(e=>{e.dataElements.position="near","Files"==e.id?e.dataElements.category="Files":e.dataElements.category="Commands"}),c=r.DynamicToolbarTreeDocument=t.prototype.createTreeDocument(l);let u=r.DynamicToolbar=new t({items:c,direction:"horizontal",overflowManagement:"dropdown"});r.publicDocumentCommands.connectToWebUXToolbar(u),u.inject(s),this.selectionChanged()},selectionChanged:function(){this.publicDocumentCommands.selectionChangedForWebUXToolbar(this.DynamicToolbar)}})}),define("DS/DocumentPreview/Viewer",["UWA/Core","DS/Controls/ComboBox","DS/3DPlayHelper/3DPlayHelper","DS/UIKIT/Iconbar","DS/UIKIT/Input/Button","DS/DocumentPreview/Actions","DS/WebappsUtils/WebappsUtils","DS/DocumentCommands/ENOXDocumentCommands","DS/DocumentCommands/Constants","i18n!DS/DocumentPreview/assets/nls/DocumentPreview"],function(e,t,n,i,o,s,a,r,c,l){"use strict";return function(n){var i,s={build:function(t){if(this.ctrl=t,t.e6wDocument.relateddata?this.files=t.e6wDocument.relateddata.files:this.files=t.e6wDocument.files||[],this.playdata={asset:{provider:"EV6",dtype:"DOCUMENTS",serverurl:t.platformUrls["3DSpace"],tenant:t.platformUrls.platformId,contextId:t.x3dcontent.data.items[0].contextId}},this.container=e.createElement("div",{class:t.getClassNames("-viewer")}),this.container.inject(t.elements.content),this.files.length>1&&(this.filebar=e.createElement("div",{class:"viewer-filebar"}),this.filebar.inject(this.container),this.fillFilebar()),this.canvas=e.createElement("div",{class:"viewer-canvas"}),this.canvas.inject(this.container),this.files.length>1){var n={asset:s.playdata.asset,physicalId:s.files[0].id,renderTo:s.canvas,fileName:s.files[0].dataelements.title,docId:s.ctrl.e6wDocument.id};s.fileid=s.files[0].id,s.filename=s.files[0].dataelements.title,s.play(n)}else{n={asset:s.playdata.asset,physicalId:s.ctrl.e6wDocument.id,renderTo:s.canvas,docId:s.ctrl.e6wDocument.id};s.play(n)}},fillFilebar:function(){e.createElement("span",{text:l.get("FILE_LABEL"),class:"file-label"}).inject(this.filebar);var i={document:{id:n.e6wDocument.id,contextId:n.securityContext,serviceId:"3DSpace",envId:n.tenant,data:n.e6wDocument},platformUrls:n.platformUrls},a=new r;a.init(i);var d=a.render(),m=0,u=[];this.files.forEach(function(e){var t={labelItem:e.dataelements.title,valueItem:e.id};0==m&&Object.assign(t,{selected:"true"}),u.push(t),m++});var p=e.createElement("div",{styles:{"margin-left":"5px"}});p.inject(this.filebar);var h=this.files[0],f=new t({elementsList:u,enableSearchFlag:!1,displayStyle:"lite",value:h.id,touchMode:!0});f.inject(p),f.addEventListener("change",function(e){var t={asset:s.playdata.asset,physicalId:e.dsModel.value,renderTo:s.canvas,fileName:e.dsModel.label,docId:s.ctrl.e6wDocument.id};s.fileid=e.dsModel.value,s.filename=e.dsModel.label,s.play(t)});var v=e.createElement("div",{class:"actions"});v.inject(this.filebar),e.createElement("div",{class:"divider"}).inject(v);var D=new o({icon:"download",className:"link"});D.inject(v),D.getContent().title=l.get("DOWNLOAD"),D.addEvent("onClick",function(){i={document:{id:n.e6wDocument.id,fileid:s.fileid,contextId:n.securityContext,serviceId:"3DSpace",envId:n.tenant,data:{title:s.filename}},platformUrls:n.platformUrls},a.init(i),d[c.DOWNLOAD].handler.call(this)});var w=new o({icon:"link",className:"link"});w.inject(v),w.getContent().title=l.get("COPYLINK"),w.addEvent("onClick",function(){i={document:{id:n.e6wDocument.id,fileid:s.fileid,contextId:n.securityContext,serviceId:"3DSpace",envId:n.tenant,data:{title:s.filename}},platformUrls:n.platformUrls},a.init(i),d[c.COPY_LINK].handler.call(this)})},play:function(t){t.asset.physicalid=t.physicalId,t.renderTo.empty(),t.renderTo.setAttribute("fileName",t.fileName),i&&(i.dispose(),i=void 0);var n={input:{asset:t.asset},options:{loading:"autoplay"}},o=e.createElement("iframe").inject(s.canvas);o.style.position="absolute",o.style.width="100%",o.style.height="100%",o.style.border="0px",o.style.top="0px",o.style.left="0px",o.allowFullScreen=o.mozAllowFullScreen=o.webkitAllowFullScreen=!0,o.setAttribute("allowFullScreen",""),o.addEventListener("load",function(e){try{e.target.contentDocument.getElementById("canvas-div").style.backgroundColor="white"}catch(e){}});var r=a.getProxifiedWebappsBaseUrl();r||(r=a.getWebappsBaseUrl()),o.src=r+"/3DPlayHelper/3DPlaySyndication.html?params="+encodeURI(JSON.stringify(n))},destroy:function(){i&&i.dispose(),i=void 0,this.container.empty(!0)}};return s.build(n),s}}),define("DS/DocumentPreview/PreviewCommandsV2",["UWA/Core","DS/DocumentPreview/Actions2/Information","DS/DocumentPreview/Actions2/Next","DS/DocumentPreview/Actions2/Previous","DS/DocumentPreview/Actions2/CloseBtn"],function(e,t,n,i,o){"use strict";return e.Class.extend({init:function(e){this.options=e,this.commands={Information:new t(e),Next:new n(e),Previous:new i(e),Close:new o(e)}},commands:[],connectToWebUXToolbar:function(e){e.items.getRoots().forEach(e=>{e.options.docV2Preview&&e.options.extend&&e.options.extend(e),e.options.docV2Private&&e.options.extend&&e.options.extend(e)})},selectionChangedForWebUXToolbar:function(e){e.items.getRoots().forEach(e=>{e.options.docV2Preview&&(e.options.grid.action=e,e.options.updateForSelection&&e.options.updateForSelection(function(t){e.updateOptions(t)})),e.options.docV2Private&&(e.options.grid.action=e,e.options.updateForSelection&&e.options.updateForSelection(function(t){e.updateOptions(t)}))})},getWebUXContextMenuItemsForCurrentSelection:function(t,n){var i=this,o=[],s=t[0].dataElements.category;return t.forEach(t=>{t.updateForSelection&&t.updateForSelection(function(n){t.dataElements=e.extend(t.dataElements,n,!0)})}),t.forEach(e=>{e.dataElements.visibleFlag&&(n&&s!=e.dataElements.category&&o.push({type:"SeparatorItem"}),o.push({rawItem:e,type:"PushItem",title:e.dataElements.label,fonticon:{content:"wux-ui-3ds wux-ui-3ds-"+e.dataElements.icon.iconName},action:{callback:e.dataElements.value||function(e,t,n){console.error("This command doesnt have value")},context:{options:i.options}},recId:e.id,category:e.dataElements.category}),s=e.dataElements.category)}),o},getUIKitItemsForCurrentSelection:function(t,n){var i=[],o=t[0].dataElements.category;return t.forEach(t=>{t.updateForSelection&&t.updateForSelection(function(n){t.dataElements=e.extend(t.dataElements,n,!0)})}),t.forEach(e=>{e.dataElements.visibleFlag&&(n&&o!=e.dataElements.category&&i.push({className:"divider"}),i.push({rawItem:e,type:"PushItem",title:e.dataElements.label,name:e.id,text:e.dataElements.label,fonticon:e.dataElements.icon.iconName,handler:e.execute||function(e,t,n){console.error("This command doesnt have value")},category:e.dataElements.category}),o=e.dataElements.category)}),i}})}),define("DS/DocumentPreview/Viewer2",["UWA/Core","DS/3DPlayHelper/3DPlayHelper","DS/WebappsUtils/WebappsUtils","DS/DocumentPreview/FilesToolbar","i18n!DS/DocumentPreview/assets/nls/DocumentPreview"],function(e,t,n,i,o){"use strict";return function(t,s){var a,r={build:function(t,n){if(this.ctrl=t,t.options.document&&t.options.document.relateddata&&e.is(t.options.document.relateddata.files,"array")?this.files=t.options.document.relateddata.files:this.files=[],this.selectedFile=void 0,void 0!==widget.getValue("X3DContentId")&&""!=widget.getValue("X3DContentId")){var i=JSON.parse(widget.getValue("X3DContentId"));if(i.data&&i.data.items&&i.data.items.length>0&&i.data.items[0].openFile){var s=this.files.find(function(e){return e.id==i.data.items[0].fileid});null!=s?this.selectedFile=s:t.showNotification("error",o.get("CANNOTACCESSFILE_TITLE"),"",o.get("CANNOTACCESSFILE_MESSAGE"),!0),i.data.items[0].openFile=!1,widget.setValue("X3DContentId",JSON.stringify(i))}}if(null==this.selectedFile&&this.files.length>0&&(this.selectedFile=this.files[0]),this.playdata={asset:{provider:"EV6",dtype:"DOCUMENTS",serverurl:t.options.platformUrls["3DSpace"],tenant:t.options.platformUrls.platformId,contextId:t.options.securityContext}},this.container=n,this.files.length>1&&(this.filebar=e.createElement("div",{class:"viewer-filebar"}),this.filebar.inject(this.container),this.fillFilebar()),this.canvas=e.createElement("div",{class:"viewer-canvas"}),this.canvas.inject(this.container),null!=this.selectedFile&&this.files.length>1){var a={asset:r.playdata.asset,physicalId:this.selectedFile.id,renderTo:r.canvas,fileName:this.selectedFile.dataelements.title,docId:t.options.document.id};r.fileid=this.selectedFile.id,r.filename=this.selectedFile.dataelements.title,r.play(a)}else{a={asset:r.playdata.asset,physicalId:t.options.document.id,renderTo:r.canvas,docId:t.options.document.id};r.play(a)}},fillFilebar:function(){null==this.filesToolBar&&(this.filesToolBar=new i(this.ctrl,this.filebar,r)),this.filesToolBar.selectionChanged(),t.events.subscribe({event:"preview2-selected-file-changed"},function(e){var n={asset:r.playdata.asset,physicalId:e.id,renderTo:r.canvas,fileName:e.dataelements.title,docId:t.options.document.id};r.fileid=e.id,r.filename=e.dataelements.title,r.play(n)})},play:function(t){t.asset.physicalid=t.physicalId,t.renderTo.empty(),t.renderTo.setAttribute("fileName",t.fileName),a&&a.dispose&&a.dispose(),a=void 0;var i={input:{asset:t.asset},options:{loading:"autoplay"}},o=e.createElement("iframe").inject(t.renderTo);o.style.position="absolute",o.style.width="100%",o.style.height="100%",o.style.border="0px",o.style.top="0px",o.style.left="0px",o.allowFullScreen=o.mozAllowFullScreen=o.webkitAllowFullScreen=!0,o.setAttribute("allowFullScreen",""),o.addEventListener("load",function(e){try{e.target.contentDocument.getElementById("canvas-div").style.backgroundColor="white"}catch(e){}});var s=n.getProxifiedWebappsBaseUrl();s||(s=n.getWebappsBaseUrl()),o.src=s+"/3DPlayHelper/3DPlaySyndication.html?params="+encodeURI(JSON.stringify(i))},destroy:function(){a&&a.dispose&&a.dispose(),a=void 0,this.container.empty(!0)}};return r.build(t,s),r}}),define("DS/DocumentPreview/PreviewToolbar",["UWA/Core","DS/Tweakers/GeneratedToolbar","DS/DocumentPreview/PreviewCommandsV2","DS/DocumentCommands/DocumentCommandsV2"],function(e,t,n,i){"use strict";return e.Class.extend({init:function(o,s){let a,r,c={entries:[]},l={entries:[]};var d={fetchSecurityContext:function(){return o.options.securityContext},getWorkUnderHeaders:function(){return{}},getSelectedNodes:function(){return[o.options.nodeModel]},getDocumentFromNodeModel:function(e){return o.options.document},getOrigin:function(){return{source:e.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId,widgetId:widget.id,component:"Previewtoolbar"}},platformUrls:o.options.platformUrls,events:o.events,ctrl:o};this.privateDocumentCommands=new n(d);var m=this.privateDocumentCommands.commands;this.publicDocumentCommands=new i(d);var u=this.publicDocumentCommands.commands;l.entries=[u.OfficeWebEdition,u.Edit,u.LockAndDownload,u.UndoEdit,u.Unlock,u.Update,u.UpdateAndUnlock,u.CopyLink],o.events.publish({event:"preview-toolbar-items-prepared",data:{dynamicModel:l}}),l.entries.push(u.Download),l.entries.push(m.Information),l.entries.forEach(function(e){e.dataElements.category=""}),c.entries=[m.Previous,m.Next,m.Close],a=this.DynamicToolbarTreeDocument=t.prototype.createTreeDocument(l);let p=this.DynamicToolbar=new t({items:a,direction:"horizontal",overflowManagement:"dropdown"});p.elements.container.setStyles({"max-width":"250px"}),this.privateDocumentCommands.connectToWebUXToolbar(p),this.publicDocumentCommands.connectToWebUXToolbar(p),p.inject(s),e.createElement("div",{class:"toolbarSeperator"}).inject(s),r=this.FixedToolbarTreeDocument=t.prototype.createTreeDocument(c);let h=this.FixedToolbar=new t({items:r});this.privateDocumentCommands.connectToWebUXToolbar(h),this.publicDocumentCommands.connectToWebUXToolbar(h),h.inject(s),this.selectionChanged()},selectionChanged:function(){this.privateDocumentCommands.selectionChangedForWebUXToolbar(this.DynamicToolbar),this.publicDocumentCommands.selectionChangedForWebUXToolbar(this.DynamicToolbar),this.privateDocumentCommands.selectionChangedForWebUXToolbar(this.FixedToolbar)},enterOverflowMode:function(){this.DynamicToolbar.elements.container.addClassName("overFlowMode")},exitOverflowMode:function(){this.DynamicToolbar.elements.container.removeClassName("overFlowMode")}})}),define("DS/DocumentPreview/Topbar",["UWA/Core","DS/UIKIT/Iconbar","DS/DocumentPreview/Actions","DS/DocumentCommands/ENOXDocumentCommands","DS/DocumentCommands/Constants","i18n!DS/DocumentPreview/assets/nls/DocumentPreview"],function(e,t,n,i,o,s){"use strict";return function(a){var r={ctrl:void 0,build:function(n){this.ctrl=n;var i=[];n.config.previewActionbar.forEach(function(e){e.handler=function(t,i){i?r.handleClick(t,i.elements.container,e,n):r.handleClick(t,r.itemActionbar.overflowMenu.options.target,e,n)},i.push(e)}),this.container=e.createElement("div",{class:n.getClassNames("-topbar")}),this.container.inject(n.elements.content),this.imgDiv=e.createElement("div",{class:"topbar-image-container"}).inject(this.container),this.img=e.createElement("img",{class:"topbar-image",src:""}).inject(this.imgDiv);var o=e.createElement("div",{class:"topbar-title-container"}).inject(this.container);this.titleText=e.createElement("div",{class:"topbar-title",text:s.get("PREVIEW")||n.e6wDocument.dataelements.title||n.e6wDocument.dataelements.name}).inject(o),e.createElement("div",{class:"spacer"}).inject(this.container),this.itemActionbarContainer=e.createElement("div",{class:"item-actionbar-container"}).inject(this.container),this.previewActionbar=new t({renderTo:this.container,items:i,className:"preview-actionbar",events:{onClick:function(e,t,n){}}}),n.topBar=r},handleClick:function(e,t,i,o){i&&n[i.methodName]&&n[i.methodName](e,t,i,o)},fillData:function(){this.titleText.setText(a.e6wDocument.dataelements.title||a.e6wDocument.dataelements.name),this.titleText.title=a.e6wDocument.dataelements.title||a.e6wDocument.dataelements.name,this.img.src=a.e6wDocument.dataelements.image,this.recreateToolbar()},recreateToolbar:function(){this.itemActionbarContainer.empty(!0);var e=[],n={document:{id:a.e6wDocument.id,contextId:a.x3dcontent.data.items[0].contextId,serviceId:"3DSpace",envId:a.platformUrls.platformId,data:{id:a.e6wDocument.id,title:a.e6wDocument.dataelements.title,files:a.e6wDocument.dataelements.files}},platformUrls:a.platformUrls},s=new i;s.init(n);var r=s.render();e.push(r[o.COPY_LINK],r[o.DOWNLOAD],r[o.RELATION]),this.itemActionbar=new t({renderTo:this.itemActionbarContainer,items:e,className:"item-actionbar",events:{onClick:function(e,t,n){}}}),a.topBar.itemActionbar.resize&&setTimeout(function(){a.topBar.itemActionbar.resize()},200)},resize:function(e){if(this.itemActionbar){this.titleText.getSize().width,this.itemActionbar.menu.items.length;a.topBar.itemActionbar.resize&&setTimeout(function(){a.topBar.itemActionbar.resize()},200)}}};return r.build(a),r}}),define("DS/DocumentPreview/PreviewComponent",["UWA/Core","DS/DocumentPreview/Topbar","DS/DocumentPreview/Viewer","DS/UIKIT/Mask","DS/i3DXCompassServices/i3DXCompassServices","DS/DocumentManagement/DocumentManagement","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","text!DS/DocumentPreview/assets/config.json","i18n!DS/DocumentPreview/assets/nls/DocumentPreview","css!DS/DocumentPreview/DocumentPreview.css"],function(e,t,n,i,o,s,a,r,c,l,d){"use strict";return(c=JSON.parse(c)).previewActionbar.forEach(function(e){e.text=l.get(e.nls),e.title=l.get(e.nls),e.description=l.get(e.nls)}),e.Controls.Abstract.extend({name:"document-preview",options:{className:""},init:function(e){this.config=c,this._parent(e),this._options=e,this.x3dcontent=e.x3dcontent,this.notificationManager=a,r.setNotificationManager(this.notificationManager),r.setStackingPolicy(5),this.buildSkeleton()},buildSkeleton:function(){var n=this;this.elements.container=e.createElement("div",{class:this.getClassNames()}),this.startLoading(),this.elements.content=e.createElement("div",{class:this.getClassNames("-content")}),this.elements.content.inject(this.elements.container),this.getServiceUrls(),new t(n),widget&&(widget.preview_document=this),this.elements.container.addEvent("resize",this.resize.bind(this)),setTimeout(()=>{n.resize()},300),setTimeout(()=>{n.resize()},800)},startLoading:function(){i.mask(this.elements.container)},finishLoading:function(){i.unmask(this.elements.container)},getServiceUrls:function(){var e=this;o.getPlatformServices({platformId:this.x3dcontent.data.items[0].envId,onComplete:function(t){e.platformUrls=t,e.getDocumentInfo()}})},getDocumentInfo:function(){var t=this;s.getDocuments([t.x3dcontent.data.items[0].objectId],{tenant:t.platformUrls.platformId,securityContext:t.x3dcontent.data.items[0].contextId,tenantUrl:t.platformUrls["3DSpace"],onComplete:function(i){i.success&&(t.e6wDocument=i.data[0],t.topBar.fillData(),new n(t),t.finishLoading(),e.is(t.loaded,"function")&&t.loaded(t),setTimeout(()=>{t.resize()},300),setTimeout(()=>{t.resize()},800))},onFailure:function(e){reason.error&&t.showNotification("error",l.get("FAILED_TO_LOAD_DOCUMENT"),reason.error)}})},showNotification:function(e,t,n,i,o){var s={level:e,title:t,subtitle:n,message:i,sticky:o};this.notificationManager.addNotif(s)},resize:function(e,t,n){var i=this.elements.container.getSize();this.topBar.resize(i)}})}),define("DS/DocumentPreview/Topbar2",["UWA/Core","DS/DocumentPreview/Actions","DS/DocumentPreview/PreviewToolbar","DS/Menu/Menu","i18n!DS/DocumentPreview/assets/nls/DocumentPreview"],function(e,t,n,i,o){"use strict";function s(e){return e.title||e.name||e.dataelements.title||e.dataelements.name}return function(a){var r={ctrl:void 0,build:function(t){this.ctrl=t;var n=[];t.config.previewActionbar.forEach(function(e){e.handler=function(n,i){i?r.handleClick(n,i.elements.container,e,t):r.handleClick(n,r.itemActionbar.overflowMenu.options.target,e,t)},n.push(e)}),this.container=e.createElement("div",{class:t.getClassNames("-topbar")}),this.container.inject(t.elements.content),this.imgDiv=e.createElement("div",{class:"topbar-image-container"}).inject(this.container),this.img=e.createElement("div",{class:"topbar-image"}).inject(this.imgDiv),this.titleDiv=e.createElement("div",{class:"topbar-title-container",text:o.get("PREVIEW")||s(t.options.document)}).inject(this.container),t.topBar=r},handleClick:function(e,n,i,o){i&&t[i.methodName]&&t[i.methodName](e,n,i,o)},setTitleText:function(e){this.titleDiv.setText(e),this.titleDiv.title=e},fillData:function(){this.setTitleText(s(a.options.document)),this.img.style.backgroundImage="url("+(a.options.document.typeicon||a.options.document.dataelements.indexedTypeicon||a.options.document.dataelements.typeicon)+")",this.recreateToolbar()},recreateToolbar:function(){null==this.previewToolBar&&(this.previewToolBar=new n(this.ctrl,this.container)),this.previewToolBar.selectionChanged()},resize:function(e){this.recreateToolbar(),i.hide(),e.width<640?this.previewToolBar.enterOverflowMode():this.previewToolBar.exitOverflowMode();this.titleDiv.getSize().width}};return r.build(a),r}}),define("DS/DocumentPreview/PreviewComponent2",["UWA/Core","DS/Core/ModelEvents","DS/DocumentPreview/Topbar2","DS/DocumentPreview/Viewer2","DS/UIKIT/Mask","DS/i3DXCompassServices/i3DXCompassServices","DS/DocumentManagement/DocumentManagement","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/DocumentPreview/PropertiesComponent","text!DS/DocumentPreview/assets/config2.json","i18n!DS/DocumentPreview/assets/nls/DocumentPreview","css!DS/DocumentPreview/DocumentPreview.css"],function(e,t,n,i,o,s,a,r,c,l,d,m,u){"use strict";return(d=JSON.parse(d)).previewActionbar.forEach(function(e){e.text=m.get(e.nls),e.title=m.get(e.nls),e.description=m.get(e.nls)}),e.Controls.Abstract.extend({name:"document-preview2",options:{className:""},init:function(e){this.config=d,this._parent(e),this.events=e.modelEvents||new t,this.notificationManager=r,c.setNotificationManager(this.notificationManager),c.setStackingPolicy(5),this.buildSkeleton()},buildSkeleton:function(){var t=this;this.elements.container=e.createElement("div",{class:this.getClassNames()}),this.startLoading(),this.elements.content=e.createElement("div",{class:this.getClassNames("-content")}),this.elements.content.inject(this.elements.container),new n(t),widget&&(widget.preview_document=this),this.topBar.fillData(),this.elements.detail=e.createElement("div",{class:this.getClassNames("-detail")}),this.elements.detail.inject(this.elements.content),this.elements.viewer=e.createElement("div",{class:this.getClassNames("-viewer")}),this.elements.viewer.inject(this.elements.detail),this.viewer=new i(this,this.elements.viewer),this.elements.info=e.createElement("div",{class:this.getClassNames("-info")}),this.elements.info.inject(this.elements.detail),this.elements.info.hide(),e.is(this.loaded,"function")&&this.loaded(this),this.events.publish({event:"onPreviewLoaded"}),this.elements.container.addEvent("resize",this.resize.bind(this)),this.finishLoading(),setTimeout(()=>{t.resize()},300),setTimeout(()=>{t.resize()},800)},startLoading:function(){o.mask(this.elements.container)},finishLoading:function(){o.unmask(this.elements.container)},updateDocument:function(e,t){this.options.document=e,this.topBar.fillData(),t&&(this.viewer&&this.viewer.destroy(),this.viewer=new i(this,this.elements.viewer)),this.elements.info.isHidden()||this.showInformation(!0)},showNotification:function(e,t,n,i,o){var s={level:e,title:t,subtitle:n,message:i,sticky:o};this.notificationManager.addNotif(s)},resize:function(e,t,n){var i=this.elements.container.getSize();this.topBar.resize(i),i.width<550?this.elements.info.isHidden()||this.elements.viewer.setStyles({opacity:0}):this.elements.viewer.setStyles({opacity:1})},showInformation:function(e){this.propertiesComponent.nodeModels=[this.options.nodeModel],this.propertiesComponent.setSelection([this.options.document])}})});