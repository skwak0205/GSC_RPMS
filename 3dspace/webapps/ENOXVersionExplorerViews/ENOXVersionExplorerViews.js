define("DS/ENOXVersionExplorerViews/NodeDropdownMenu",["DS/UIKIT/DropdownMenu","DS/Tree/TreeNodeModel","DS/Menu/ContextualMenu","WebappsUtils/WebappsUtils","css!DS/ENOXVersionExplorerViews/styles/NodeDropdownMenu"],function(e,t,i,n){"use strict";var o={},s=!0,l=function(e){var t=e.dropdownContainer;void 0!==o.menuId&&(t["wux-data-contextual"]&&i.removeEventListener(t,o.menuId),o.menuId=void 0)};return{displayNodeDropdownMenu:function(e){var n=this,r=e.treeNode,a=e.target,d=e.menuList,c=(e.position,e.dropdownContainer);if(!(r instanceof t||Array.isArray(r)))throw Error("NodeDropdownMenu.displayNodeDropdownMenu:incorrect data to display dropdown menu");var u=!1;!0===n.options.useIcons&&(u=!0),o.nodeView=a,o.data=r,o.dat=e,s=!0,l(e),o.menuId=i.addEventListener(c,{callback:function(e){console.log(e),s=!1;for(var t=[],i=0;i<d.length;i++){var r=d[i];r.fonticon&&"string"==typeof r.fonticon&&(r.fonticon={content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+r.fonticon,family:WUXManagedFontIcons.Font3DS}),!0!==u?null!=r.fonticon&&(r.icon=void 0):null!=r.icon&&(r.fonticon=void 0),"divider"===r.id?t.length>0&&"SeparatorItem"===t[t.length-1].type||t.push({type:"SeparatorItem"}):r.submenu&&0!==r.submenu.length?t.push({type:"PushItem",title:r.text,fonticon:r.fonticon,icon:r.icon,id:r.id,state:r.disabledItem?"disabled":"enabled",submenu:r.submenu}):t.push({type:"PushItem",accelerator:r.accelerator,title:r.text,fonticon:r.fonticon,icon:r.icon,id:r.id,state:r.disabledItem?"disabled":"enabled",action:{callback:function(e){var t=e.context.item;"function"==typeof t.event.pubfn?t.event.pubfn(o.data):"string"==typeof t.event&&n["function"==typeof n.publishEvent?"publishEvent":"publish"]({event:t.event,data:o.data})},context:{data:o.data,item:r}}})}return n.options._isODT&&setTimeout(function(){for(var e=[],t=0;t<o.dat.menuList.length;t++){var i=o.dat.menuList[t];"divider"!==i.id&&e.push(i.id)}for(var n=document.getElementsByClassName("wux-menu-overlap"),s=0;s<n.length;s++){var l=n[s].dataset;if(l.hasOwnProperty("wuxMenuItemUid")){var r=parseInt(l.wuxMenuItemUid);r<e.length&&(n[s].id=e[r])}}},100),l(o.dat),t}}),setTimeout(function(){if(s){var e=o.dat.position.x,t=o.dat.position.y,i=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,view:window,buttons:2,clientX:e,clientY:t});o.dat.dropdownContainer.dispatchEvent(i)}},200)}}}),define("DS/ENOXVersionExplorerViews/VersionExplorerModal",["UWA/Core","DS/ENOFloatingPanel/ENOFloatingPanel","i18n!DS/ENOXVersionExplorerViews/assets/nls/VersionExplorerView","i18n!DS/UIKIT/assets/nls/UIKIT"],function(e,t,i,n){"use strict";return{_dlg:void 0,_dlgDiv:void 0,footerStyle:{none:1,okCancel:2},_closeDlg:function(){if(this._dlg){for(var e=this._dlgDiv.getChildren(),t=e.length,i=0;i<t;i++)this._dlgDiv.remove(e[i]);this._dlg.destroy(),this._dlg=void 0,this._dlgDiv=void 0,this.options&&"function"==typeof this.options.onCloseDlg&&this.options.onCloseDlg()}},displayDialog:function(o){var s=this;s._dlgDiv&&s._dlg&&s._closeDlg(),s._dlgDiv=e.createElement("div",{styles:{width:"100%",height:"100%",overflow:"hidden"}}),o.className="version-explorer-modal"+("string"==typeof o.className&&o.className.length?" "+o.className:"");var l=e.merge(o,{body:s._dlgDiv,closable:!0,animate:!0,resizable:!0,autocenter:!0,visible:!0,limitParent:!0,footer:o.footerStyle===s.footerStyle.okCancel?'<button type="button" class="btn btn-primary _BTN_OK">'+n.ok+'</button> <button type="button" class="btn btn-default _BTN_CANCEL">'+n.ko+"</button>":void 0,overlay:!0===o.modal,events:{onClose:s._closeDlg.bind(s)},onOK:function(){},onCancel:function(){},title:i.VersionExplorer});s._dlg=new t(l),s._dlg.elements.body.setStyle("padding","0"),o.parentContainer=o.parentContainer||e.extendElement(document.body),s._dlg.inject(o.parentContainer),s._dlgDiv.setContent(o.globalDiv),s._dlg.elements.footer&&(s._dlg.elements.footer.getElement("button._BTN_OK").addEvent("click",function(e){o.onOK(e),s._closeDlg()}),s._dlg.elements.footer.getElement("button._BTN_CANCEL").addEvent("click",function(e){s._closeDlg(),o.onCancel(e)})),o.showMaximized&&s._dlg.maximize(),o.position&&o.position.clientX&&o.position.clientY&&(s._dlg.elements.container.setStyles({top:o.position.clientY.toString()+"px",left:o.position.clientX.toString()+"px"}),s._dlg.initialClient=s._dlg._getCurrentClientPosition(o.position)),this.options=o},setTitle:function(e){void 0!==this._dlg&&this._dlg.setTitle(i.VersionExplorer+("string"==typeof e&&e.length?" - "+e:""))},changeFooterStyle:function(){void 0!==this._dlg&&that._dlg.elements.footer}}}),define("DS/ENOXVersionExplorerViews/NewRevisionDialog",["DS/UIKIT/Form","DS/UIKIT/SuperModal","i18n!DS/ENOXVersionExplorerViews/assets/nls/NewRevisionDialog","css!DS/ENOXVersionExplorerViews/styles/NewVersionDialog"],function(e,t,i){"use strict";return{displayDialog:function(n){if(!n.derivedFrom||!n.derivedFrom.name||!n.derivedFrom.id)throw Error("derived From Name or ID cannot be null");if("string"!=typeof n.defaultName||!n.defaultName.length)throw Error("Default Name cannot be null");var o=[{type:"text",label:i.revTitle,required:!1,value:n.defaultName||"",name:"newVersionName"},{type:"textarea",label:i.description,required:!1,name:"newVersionDescription"},{type:"text",label:i.derivedFrom,required:!1,disabled:!0,value:n.derivedFrom.name,name:"newVersionBasedOn"}],s=new e({fields:o,className:"newVersionDialog"});new t({renderTo:n.parentContainer||document.body,className:"newVersionSuperModal"}).dialog({title:n.title||i.newRevision,body:s.elements.container,buttons:[{className:"primary",value:i.create,action:function(e){var t=s.getValue("newVersionName"),i=s.getValue("newVersionDescription");e.hide(),n.onOK(t,i)},name:"buttonOK"},{className:"default",value:i.cancel,action:function(e){e.hide()},name:"buttonCancel"}]}),s.getField("newVersionDescription").focus()}}}),define("DS/ENOXVersionExplorerViews/VersionExplorerToolbar",["UWA/Core","DS/UIKIT/Iconbar","DS/ENOXVersionExplorerThumbnailGraphView/TreeDocGraphViewSync","DS/ENOXVersionExplorerUtils/ArrayFunctions","DS/ENOXVersionExplorerUtils/VersionExplorerSettings","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","DS/UIKIT/SuperModal","DS/WebappsUtils/WebappsUtils","i18n!DS/ENOXVersionExplorerViews/assets/nls/VersionExplorerToolbar","css!DS/ENOXVersionExplorerViews/styles/VersionExplorerToolbar"],function(e,t,i,n,o,s,l,r,a){return t.extend({_versionExplorerController:void 0,init:function(t){for(var l in this._versionExplorerController=t.versionExplorerController,this.versionExplorerView=t.versionExplorerView,arr=[],i.OrientationMode)arr.splice(i.OrientationMode[l],0,l);this._circularArray=new n.CircularArray(arr);var r=this,d=o.UserSettings.thumbnailGraphLayout;if(isNaN(d))for(var l in s.THUMBNAIL_GRAPH_LAYOUT)if(s.THUMBNAIL_GRAPH_LAYOUT[l]===d){d=l;break}e.extend(t,{className:"versionexplorer-iconbar",items:[{fonticon:"select-on",text:a.multiSelect,id:"menuMultiSelect"},{fonticon:"",text:a.multiSelect,id:"multiSelectCounter"},{fonticon:"open-down",text:"",id:"menuMultiSelectDropdown"},{fonticon:"graph-egraph-down "+d,text:a[d],id:"graphViewDropDown",content:{type:"icondropdown",options:{items:[{selected:"ROOT_ON_RIGHT"===d,fonticon:"graph-egraph-down ROOT_ON_RIGHT",description:a.ROOT_ON_RIGHT,id:"ROOT_ON_RIGHT"},{selected:"ROOT_ON_LEFT"===d,fonticon:"graph-egraph-down ROOT_ON_LEFT",description:a.ROOT_ON_LEFT,id:"ROOT_ON_LEFT"},{selected:"ROOT_ON_BOTTOM"===d,fonticon:"graph-egraph-down ROOT_ON_BOTTOM",description:a.ROOT_ON_BOTTOM,id:"ROOT_ON_BOTTOM"},{selected:"ROOT_ON_TOP"===d,fonticon:"graph-egraph-down",description:a.ROOT_ON_TOP,id:"ROOT_ON_TOP"}],events:{onClick:function(e,t){document.getElementById("graphViewDropDown").getChildren()[0].className=t.elements.container.getChildren()[0].className,r.versionExplorerView.setThumbnailGraphLayout(t.elements.container.id);var i=r.menu.items.find(function(e){return"graphViewDropDown"===e.id});i&&(i.text=t.description,i.tooltip.setBody(i.text))}}}}},{fonticon:"arrow-double-combo",text:a.zoomToFit,id:"menuZoomToFit"},{fonticon:"map-navigation",text:a.toggleOverview,id:"menuToggleOverview"},{fonticon:"cog",text:a.settings,id:"menuSettings"},{className:"divider",id:"divider"},{fonticon:"help",text:a.help,id:"menuToggleHelp"},{fonticon:"reload",text:a.refresh,id:"menuRefresh"},{fonticon:"legend-eye",text:a.toggleOverview,text:a.legend,id:"menuToggleLegend"},{fonticon:"graph-egraph",text:a.displayThumbnailView,id:"menuDisplayThumbnailView",content:{type:"icondropdown",options:{items:[{selected:!0,fonticon:"graph-egraph selected",id:"DisplayThumbnailView",description:a.displayThumbnailView},{fonticon:"graph-egraph-list ",id:"DisplaySubwayListView",description:a.displaySubwayListView}],events:{onClick:function(e,t){t.elements.container.className="item ",this.elements.container.getChildren()[0].className="item selected",r.setView("menu"+t.id,!0)}}}}},{fonticon:"graph-egraph-list",text:a.displaySubwayListView,id:"menuDisplaySubwayListView",content:{type:"icondropdown",options:{items:[{fonticon:"graph-egraph ",id:"ThumbnailView",description:a.displayThumbnailView},{selected:!0,fonticon:"graph-egraph-list selected",id:"SubwayListView",description:a.displaySubwayListView}],events:{onClick:function(e,t){t.elements.container.className="item ",this.elements.container.getChildren()[1].className="item selected",r.setView("menuDisplay"+t.id,!0)}}}}},{fonticon:"duplicate",text:a.ShowDuplicates,id:"menuToggleDup"}],events:{onClick:this.handleThumbnailGraphToolbar}}),this._parent(t),e.createElement("span",{}).inject(this.getItem("multiSelectCounter").elements.container),this.hideMultiSelect(),this.removeLegendButton()},select:function(){var e,t,i,n,o,s=arguments;void 0!==s[0]&&null!==s[0]&&(t=void 0===s[1]||s[1],(o=void 0!==s[2]&&s[2])&&t&&this.elements.container.querySelectorAll(".item-active").forEach(function(e){e.removeClassName&&e.removeClassName("item-active")}),o&&t&&this.overflowMenu.getSelectedItems().forEach(function(e){this.overflowMenu.menus[0].toggleSelection(e),e.elements.container.removeClassName("selectable")},this),(e=this.getItem(s[0]))&&!e.elements.container.hasClassName("divider")&&(e.elements.container[t?"addClassName":"removeClassName"]("item-active"),i=e.elements.container.id,1===(n=this.overflowMenu.items.filter(function(e){return e.elements.container.hasClassName(i)})).length&&(this.overflowMenu.menus[0].toggleSelection(n[0]),n[0].elements.container.addClassName("selectable"))))},getItemIndex:function(e){var t,i,n,o=!1,s=-1;for(t=0,i=this.menu.items.length;t<i;t+=1){if(o=this.menu.items[t],e&&e.nodeType){if(n=e.hasClassName("item")?e:e.getParent(),o.id===n.id){s=t;break}}else if(t===e||o.id===e||o.name===e){s=t;break}o=!1}return s},addLegendButton:function(e){this.showItem("menuToggleLegend"),this.select("menuToggleLegend",e)},removeLegendButton:function(){this.hideItem("menuToggleLegend")},setView:function(e,t){if(this.viewTYPE!==e){switch(this.viewTYPE=e,e){case"menuDisplayThumbnailView":this.showItem("menuDisplayThumbnailView"),this.showItem("menuHelp"),this.showItem("menuRefresh"),this.showItem("divider"),this.showItem("graphViewDropDown"),this.showItem("menuZoomToFit"),this.showItem("menuToggleOverview"),this.hideItem("menuDisplaySubwayListView"),!0===this.versionExplorerView._versionModel._DupToggling?this.showItem("menuToggleDup"):this.hideItem("menuToggleDup"),!0===t&&this.versionExplorerView._displayThumbnailGraph(!0);break;case"menuDisplaySubwayListView":this.hideItem("menuDisplayThumbnailView"),this.hideItem("graphViewDropDown"),this.hideItem("menuZoomToFit"),this.hideItem("menuToggleOverview"),this.showItem("menuDisplaySubwayListView"),this.showItem("menuRefresh"),this.showItem("menuHelp"),this.showItem("divider"),!0===this.versionExplorerView._versionModel._DupToggling?this.showItem("menuToggleDup"):this.hideItem("menuToggleDup"),!0===t&&this.versionExplorerView._displaySubwayGraph()}for(var i=["menuToggleOverview","menuZoomToFit","graphViewDropDown"],n=0;n<i.length;n++)this["menuDisplayThumbnailView"===e?"showItem":"hideItem"](i[n])}},handleThumbnailGraphToolbar:function(e,t){switch(t.id){case"menuRefresh":this._versionExplorerController.publishEvent("_ENOXVersionExplorerInternalRefresh",{reframe:!0});break;case"menuToggleDup":this.select(t.id,!this.getItem(t.id).elements.container.hasClassName("item-active"));var i=this.elements.container.getParent(".version-global-div");o._saveUserSettings("displayDuplicates",this.getItem(t.id).elements.container.hasClassName("item-active"),this.versionExplorerView._versionModel.useGlobalStorage,this.versionExplorerView._versionModel.globalStorageName,this.versionExplorerView._versionModel.webToWinComSocket),this.versionExplorerView.toggleDuplicateMode();break;case"menuToggleHelp":this.select(t.id,!this.getItem(t.id).elements.container.hasClassName("item-active")),(i=this.elements.container.getParent(".version-global-div"))&&(i=i.getElement(".versionexplorer-help")),i&&i[this.getItem(t.id).elements.container.hasClassName("item-active")?"removeClassName":"addClassName"]("versionexplorer-help-hidden"),o._saveUserSettings("displayHelp",this.getItem(t.id).elements.container.hasClassName("item-active"),this.versionExplorerView._versionModel.useGlobalStorage,this.versionExplorerView._versionModel.globalStorageName,this.versionExplorerView._versionModel.webToWinComSocket);break;case"menuToggleOverview":this.select(t.id,!this.getItem(t.id).elements.container.hasClassName("item-active")),o._saveUserSettings("displayThumbnailOverview",this.getItem(t.id).elements.container.hasClassName("item-active"),this.versionExplorerView._versionModel.useGlobalStorage,this.versionExplorerView._versionModel.globalStorageName,this.versionExplorerView._versionModel.webToWinComSocket),this.versionExplorerView.setThumbnailOverviewVisibility();break;case"menuZoomToFit":this.versionExplorerView.reframeThumbnailGraph();break;case"menuToggleLegend":this.select(t.id,!this.getItem(t.id).elements.container.hasClassName("item-active")),this.versionExplorerView.displayLegend(this.getItem(t.id).elements.container.hasClassName("item-active")),o._saveUserSettings("displayLegend",this.getItem(t.id).elements.container.hasClassName("item-active"),this.versionExplorerView._versionModel.useGlobalStorage,this.versionExplorerView._versionModel.globalStorageName,this.versionExplorerView._versionModel.webToWinComSocket);break;case"menuMultiSelect":this.versionExplorerView._versionModel._USER_SET_MULTI_SELECT=!this.getItem(t.id).elements.container.hasClassName("item-active"),this.versionExplorerView._manageSelect({data:!this.versionExplorerView._versionModel._USER_SET_MULTI_SELECT});break;case"menuMultiSelectDropdown":this.versionExplorerView.onMultiSelectDropdownClick(e);break;case"menuSettings":this.versionExplorerView._customizeColumns()}},hideItem:function(e){var t=this.getItem(e);t&&t.elements.container.hide()},showItem:function(e){var t=this.getItem(e);t&&t.elements.container.show()},activateItem:function(e){this.select(e,!0)},deactivateItem:function(e){this.select(e,!1)},hideMultiSelect:function(){this.hideItem("menuMultiSelect"),this.hideItem("multiSelectCounter"),this.hideItem("menuMultiSelectDropdown")},showMultiSelect:function(){this.showItem("menuMultiSelect"),this.showItem("divider")},activateMultiSelect:function(){this._multiSelectActive||(this.activateItem("menuMultiSelect"),this.showItem("multiSelectCounter"),this.activateItem("multiSelectCounter"),this.activateItem("menuMultiSelectDropdown"),this._multiSelectActive=!0)},deactivateMultiSelect:function(){this._multiSelectActive&&(this.deactivateItem("menuMultiSelect"),this.hideItem("multiSelectCounter"),this.hideItem("menuMultiSelectDropdown"),this._multiSelectActive=!1)},setMultiSelectCount:function(e){this._multiSelectActive&&this.getItem("multiSelectCounter").elements.container.getElement("span").setContent(e.toString())},showMultiSelectDropdown:function(){this._multiSelectActive&&this.showItem("menuMultiSelectDropdown")},hideMultiSelectDropdown:function(){this.hideItem("menuMultiSelectDropdown")},setSubwayViewRowHeight:function(e){e=e||o.UserSettings.subwayViewMode,this.versionExplorerView.setSubwayRowHeight(s.SUBWAY_VIEW_MODE[e]),o._saveUserSettings("subwayViewMode",e,this.versionExplorerView._versionModel.useGlobalStorage,this.versionExplorerView._versionModel.globalStorageName,this.versionExplorerView._versionModel.webToWinComSocket)},isItemHidden:function(e){var t=this.getItem(e);if(!t)throw Error("VersionExplorerToolbar.isItemHidden: "+t+" not found");return t.elements.container.isHidden()}})}),define("DS/ENOXVersionExplorerViews/NewVersionDialog",["DS/UIKIT/Form","DS/UIKIT/SuperModal","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","i18n!DS/ENOXVersionExplorerViews/assets/nls/NewVersionDialog","css!DS/ENOXVersionExplorerViews/styles/NewVersionDialog"],function(e,t,i,n){"use strict";return{displayDialog:function(o){if(!o.derivedFrom||!o.derivedFrom.name||!o.derivedFrom.id)throw Error("derived From Name or ID cannot be null");if("string"!=typeof o.defaultName||!o.defaultName.length)throw Error("Default Name cannot be null");var s=o.dataModelType,l=o.semanticTypes,r=!1,a=[{type:"textarea",label:n.description,required:!1,name:"newVersionDescription"}];if(Array.isArray(l)&&l.length){r=!0;var d=l.length;a.push({label:n.semanticRelationship,disabled:!0,className:"semanticTypeText",required:!0,flag:"semanticType"});for(var c=0;c<d;c++)a.push({type:"radio",label:l[c].label,required:!1,name:"version_type",className:"primary semanticTypeRadio",flag:"semanticType"})}else switch(s){case i.DATA_MODEL_TYPES.MODEL_P_PRIME:case i.DATA_MODEL_TYPES.MODEL_RDF:r=!0,a.push({label:n.semanticRelationship,disabled:!0,className:"semanticTypeText",required:!0,flag:"semanticType"},{type:"radio",label:n.S,name:"version_type",className:"primary semanticTypeRadio",flag:"semanticType",value:"S",checked:!0},{type:"radio",label:n.F,name:"version_type",className:"primary semanticTypeRadio",flag:"semanticType",value:"F"},{type:"radio",label:n.SO,name:"version_type",className:"primary semanticTypeRadio",flag:"semanticType",value:"SO"},{type:"radio",label:n.SP,name:"version_type",className:"primary semanticTypeRadio",flag:"semanticType",value:"SP"},{type:"radio",label:n.PS,name:"version_type",className:"primary semanticTypeRadio",flag:"semanticType",value:"PS"})}a.push({type:"text",label:n.derivedFrom,required:!1,disabled:!0,value:o.derivedFrom.name,name:"newVersionBasedOn"});var u,h=new e({fields:a,className:"newVersionDialog"});(u=(u=h.elements.container.getElement('input[type="text"].semanticTypeText'))?u.getParent("div").getElement("label span"):void 0)&&UWA.createElement("span",{class:"fonticon fonticon-info",events:{mousedown:function(e){}}}).inject(u,"before"),new t({renderTo:o.parentContainer||document.body,className:"newVersionSuperModal"}).dialog({title:o.title||n.newBranch,body:h.elements.container,buttons:[{className:"primary",value:n.create,action:function(e){var t=o.defaultName,i=h.getValue("newVersionDescription"),n=void 0;if(!0===r){var s=h.elements.container.getElements('.semanticTypeRadio input[type="radio"]:checked');n=s&&1==s.length&&s[0].getAttribute("value")}e.hide(),o.onOK(t,i,n)},name:"buttonOK"},{className:"default",value:n.cancel,action:function(e){e.hide()},name:"buttonCancel"}]})}}}),define("DS/ENOXVersionExplorerViews/VersionExplorerPrefsDlg",["UWA/Class","UWA/Core","DS/UIKIT/SuperModal","DS/UIKIT/Input/Toggle","i18n!DS/ENOXVersionExplorerViews/assets/nls/VersionExplorerPrefsDlg","i18n!DS/UIKIT/assets/nls/UIKIT","css!DS/LifecycleControls/assets/styles/LifecycleModals","css!DS/ENOXVersionExplorerViews/VersionExplorerPrefsDlg"],function(e,t,i,n,o,s,l,r){"use strict";return e.singleton({init:function(){this._parent({})},showDialog:function(e){var t=this,n=e.onOk,l=e.onShow,r=!1,a=new i({closable:!0,className:"Lifecycle_Modals",events:{onShow:function(){var e=[];t.okButton=this.modals.current.getFooter().children[0],t.cancelButton=this.modals.current.getFooter().children[1],t.resetButton=this.modals.current.getFooter().children[2],e.push(t.okButton),e.push(t.cancelButton),e.push(t.resetButton),this.modals.current.getFooter().removeChild(e[2]),this.modals.current.getFooter().insertBefore(e[2],e[1]),null!=l&&l(t)}},renderTo:e.parent}),d=this.buildDialogBody(e);a.dialog({body:d,className:"Lifecycle_Modals",title:e.title,buttons:[{className:"primary",value:s.ok,action:function(e){var i={},o=e.elements.body.getElement("#compact-view-toggle");o&&(i.compactView=o.checked),i.wasReset=r,void 0!==t.checkboxes&&(i.attributes=t.getSelectedAttributes()),e.hide(),n(i)}},{value:s.ko,action:function(e){e.hide()}},{value:o.Reset,action:function(e){r=!0,t.resetAttributes(e)}}]})},getSelectedAttributes:function(){for(var e=[],t=this.checkboxes.length,i=0;i<t;i++){var n=this.checkboxes[i];n.isChecked()&&e.push(n.getId().replace("@@@",""))}return e},buildDialogBody:function(e){this.options=e;var i=t.createElement("div",{styles:{position:"relative",height:"100%",overflow:"hidden"}});if(this.compactDisplayOption=void 0,this.isCompactDisplayOptionChecked=!1,e.showGraphListSettings){this.compactDisplayOption=new n({id:"compact-view-toggle",type:"switch",label:o.UseCompactDisplay,checked:e.compactView}).inject(i),this.isCompactDisplayOptionChecked=e.compactView;t.createElement("div",{html:o.SelectColumns}).inject(i)}if(e.showGraphSettings)t.createElement("div",{html:o.SelectNodeInfo}).inject(i);if(e.showGraphListSettings||e.showGraphSettings){var s=t.createElement("form",{}),l=t.createElement("fieldset",{id:"attribute-preference-content",class:"preferenceSet"});this.attributesSet=l;var r=e.allAttributes.length;this.checkboxes=[],this.resetAttributesArray=[],e.showGraphListSettings?this.resetAttributesArray=e.resetGraphListView:this.resetAttributesArray=e.resetGraphView;var a=e.allAttributes.slice();a.sort(function(e,t){return e.displayName.localeCompare(t.displayName)});for(var d=0;d<r;d++){var c={displayName:a[d].displayName,isSelected:a[d].isSelected,name:a[d].name};this.resetAttributesArray.findIndex(function(e){return e.name===c.name})<0&&(c.isSelected=!1,this.resetAttributesArray.push(c))}var u=[];for(d=0;d<r;d++){c=e.allAttributes[d];if(!e.showGraphSettings||"thumbnail"!==c.name)c.isSelected?this.addAttrItem(this.options,l,c):u.push(c)}u.sort(function(e,t){return e.displayName.localeCompare(t.displayName)});for(d=0;d<u.length;d++){c=u[d];this.addAttrItem(this.options,l,c)}l.inject(s),s.inject(i)}return i},resetAttributes:function(e){if(this.isCompactDisplayOptionChecked=!1,this.options.showGraphListSettings){var t=e.elements.body.getElement("#compact-view-toggle");t&&(t.checked=!1)}this.checkboxes=[],this.attributesSet.empty();for(var i=0;i<this.resetAttributesArray.length;i++){var n=this.resetAttributesArray[i];this.addAttrItem(this.options,this.attributesSet,n)}if(this.options.showGraphSettings){var o=e.getFooter().getElementsByClassName("btn-primary");if(o.length>0){var s=o[0];this.checkboxes.length>0?s.disabled=!1:s.disabled=!0}}},addAttrItem:function(e,t,i){var o=this,s=i.name.replace("@@@","");"thumbnail"===s&&o.compactDisplayOption&&(i.isSelected?o.compactDisplayOption.isDisabled()||(o.isCompactDisplayOptionChecked=o.compactDisplayOption.isChecked(),o.compactDisplayOption.setCheck(!1),o.compactDisplayOption.setDisabled(!0)):(o.compactDisplayOption.setCheck(o.isCompactDisplayOptionChecked),o.compactDisplayOption.setDisabled(!1)));var l=new n({id:"@@@"+s,type:"checkbox",className:"primary",label:i.displayName,checked:i.isSelected,disabled:1==i.disabled,events:{onChange:function(i){t.empty();var n=o.checkboxes;o.checkboxes=[];for(var s=[],l=n.length,r=void 0,a=!1,d=0;d<l;d++){var c=n[d];c===this?a=!0:a&&void 0===r&&(r=c),(h={name:c.options.id,displayName:c.options.label,isSelected:c.options.checked,disabled:c.options.disabled}).isSelected&&c!==this?o.addAttrItem(e,t,h):c!==this&&s.push(h)}void 0===r&&l-2>=0&&(r=n[l-2]);var u=this.isChecked(),h={name:this.options.id,displayName:this.options.label,isSelected:u,disabled:this.options.disabled};u?o.addAttrItem(e,t,h):s.push(h),o.checkboxes.length>0?o.okButton.disabled=!1:o.okButton.disabled=!0,s.sort(function(e,t){return e.displayName.localeCompare(t.displayName)});for(var p=0;p<s.length;p++)o.addAttrItem(e,t,s[p]);if(null!=r){var m=r.getId(),g=document.getElementById(m);g&&g.scrollIntoViewIfNeeded()}}}}).inject(t);this.checkboxes.push(l)}})}),define("DS/ENOXVersionExplorerViews/VersionExplorerPrefs",["UWA/Class","UWA/Promise","DS/ENOXVersionExplorerViews/VersionExplorerPrefsDlg","DS/LifecycleServices/LifecycleServices","i18n!DS/ENOXVersionExplorerViews/assets/nls/VersionExplorerPrefsDlg","DS/WidgetServices/WidgetServices","DS/ENOXVersionExplorerUtils/VersionExplorerSettings","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","DS/WAFData/WAFData"],function(e,t,i,n,o,s,l,r,a){"use strict";return e.extend({init:function(e,t,i,n,o,s,l,r){this._parent({}),this.allColumns=i,this.defaultCols=n,this.hWidget=e,this.appId=t,this._USE_GLOBAL_STORAGE=s,this._GLOBAL_STORAGE_NAME=l,this._WEBTOWIN_COM_SOCKET=r},getAll:function(){return this.allColumns},getAlldbKeys:function(){return this.allColumns.map(function(e){return e.dbKey})},loadSettingsPromise:function(){var e=this;return e.loaded=null,new t(function(t,i){e=e,s.getCompassUrlAsync({onComplete:function(i){e.hWidget.getValue("x3dPlatformId");var n="X";null!=e._GLOBAL_STORAGE_NAME&&(n=e._GLOBAL_STORAGE_NAME);var o=e.appId.slice(0,e.appId.length-1),s=encodeURI(i+"/resources/AppsMngt/user/getPreferences?name="+(o+n)),l=encodeURI(i+"/resources/AppsMngt/user/getPreferences?name="+e.appId);a.authenticatedRequest(s,{method:"GET",timeout:5e3,headers:{Accept:"application/json",SecurityContext:void 0},cache:!1,onComplete:function(n){console.log("PICK COMPARE DIALOG: success getting universal value"),"[]"===n||null!=n&&""!=n&&n.indexOf("]")<1?e.loaded=[]:null!=n&&""!=n&&(n=n.replaceAll("------","###"),e.loaded=JSON.parse(n)),"[]"===n||null!=e.loaded&&""!=e.loaded?(e.save(e.loaded),t(e.loaded)):a.authenticatedRequest(l,{method:"GET",timeout:5e3,headers:{Accept:"application/json"},onComplete:function(n){if(console.log("PICK COMPARE DIALOG: success getting legacy value"),null!=n&&""!=n&&(e.loaded=JSON.parse(n)),null==e.loaded||""==e.loaded){var s=o+r.DATA_MODEL_TYPES.MODEL_REVISION.toString();if(e.appId===s){var l=o+r.DATA_MODEL_TYPES.MODEL_HISTORY.toString(),d=encodeURI(i+"/resources/AppsMngt/user/getPreferences?name="+l);a.authenticatedRequest(d,{method:"GET",timeout:5e3,headers:{Accept:"application/json",SecurityContext:void 0},cache:!1,onComplete:function(i){console.log("PICK COMPARE DIALOG: success getting legacy history settings"),null!=i&&""!=i&&(e.loaded=JSON.parse(i)),null!=e.loaded&&""!=e.loaded||(e.loaded=e.load()),t(e.loaded)},onFailure:function(e){console.log("PICK COMPARE DIALOG: failed getting value")}})}else e.loaded=e.defaultCols,e.save(e.loaded),t(e.loaded)}else t(e.loaded)},onFailure:function(e){console.log("PICK COMPARE DIALOG: failed getting value")}})},onFailure:function(e){console.log("PICK COMPARE DIALOG: failed getting value")}})}})})},load:function(){this.loaded=null;var e=this.appId.slice(0,this.appId.length-1),t=e+"X";if(this.hWidget&&null==this._WEBTOWIN_COM_SOCKET?this.loaded=this.hWidget.getValue(t):this.loaded=JSON.parse(window.localStorage.getItem(t)),null==this.loaded&&(this.hWidget&&null==this._WEBTOWIN_COM_SOCKET?this.loaded=this.hWidget.getValue(this.appId):this.loaded=JSON.parse(window.localStorage.getItem(this.appId))),null==this.loaded){var i=e+r.DATA_MODEL_TYPES.MODEL_REVISION.toString();if(this.appId===i){var n=e+r.DATA_MODEL_TYPES.MODEL_HISTORY.toString();this.hWidget&&null==this._WEBTOWIN_COM_SOCKET?this.loaded=this.hWidget.getValue(n):this.loaded=JSON.parse(window.localStorage.getItem(n))}}return null==this.loaded&&(this.loaded=this.defaultCols),this.save(this.loaded),this.loaded},save:function(e){var t=this.appId.slice(0,this.appId.length-1)+"X";if(this.hWidget&&null==this._WEBTOWIN_COM_SOCKET?this.hWidget.setValue(t,e):window.localStorage.setItem(t,JSON.stringify(e)),this._USE_GLOBAL_STORAGE){var i=this;s.getCompassUrlAsync({onComplete:function(n){i.hWidget.getValue("x3dPlatformId");var o="X";null!=i._GLOBAL_STORAGE_NAME&&(o=i._GLOBAL_STORAGE_NAME);var s=n+"/resources/AppsMngt/user/setPreferences?name="+(t=i.appId.slice(0,i.appId.length-1)+o)+"&value="+JSON.stringify(e);s=s.replaceAll("###","------");var l=encodeURI(s);a.authenticatedRequest(l,{method:"GET",timeout:5e3,headers:{Accept:"application/json",SecurityContext:void 0},cache:!1,onComplete:function(e){console.log("PICK COMPARE DIALOG: success setting ")},onFailure:function(e){console.log("PICK COMPARE DIALOG: failed setting ")}})}})}},getAttrDispName:function(e){return"newTarget"==e?o.newTarget:n.getAttributeDisplayName(e)},customizations:function(e){var t=this,n=[];if(this._USE_GLOBAL_STORAGE)this.loadSettingsPromise().then(function(s){for(var l=[],r=!1,a=0,d=s.length;a<d;a++)if(s[a].startsWith("###"))if(!0===e.showGraphSettings){var c=s[a].substr(3);"title"===c&&(r=!0),l.push(c)}else n.push(s[a]);else!0===e.showGraphSettings?n.push(s[a]):l.push(s[a]);setTimeout(function(){var s=[],a=!1;!0===e.showGraphSettings&&0==l.length&&(a=!0),r||(s=[{name:"title",displayName:t.getAttrDispName("title"),isSelected:!0!==e.showGraphSettings||a,disabled:!0!==e.showGraphSettings}]),s.length>0&&!0===e.showGraphSettings&&l.indexOf("title")>=0&&(s[0].isSelected=!0);for(var d=0,c=l.length;d<c;d++){var u=t.allColumns.find(function(e){return l[d]===e.dbKey});if(u)s.push({name:u.dbKey,displayName:u.columnNLS,isSelected:!0});else if(!0===e.showGraphSettings&&"title"===l[d])s.push({name:"title",displayName:t.getAttrDispName("title"),isSelected:!0,disabled:!1});else{var h=!0===e.showGraphSettings?"###"+l[d]:l[d];n.push(h)}}var p=t.allColumns.length;for(d=0;d<p;d++)-1==l.indexOf(t.allColumns[d].dbKey)&&s.push({name:t.allColumns[d].dbKey,displayName:t.allColumns[d].columnNLS,isSelected:!1});i.showDialog({title:o.SettingsTitle,parent:document.body,showGraphListSettings:e.showGraphListSettings,showGraphSettings:e.showGraphSettings,compactView:e.compactView,allAttributes:s,resetGraphListView:t.resetGraphListView,resetGraphView:t.resetGraphView,onShow:function(t){void 0!==e.onShowDlg&&null!==e.onShowDlg&&e.onShowDlg(t)},onOk:function(i){var o={};if(void 0!==i.compactView&&(o.compactView=i.compactView),void 0!==i.attributes){o.attributes=[];for(var s=i.attributes.length,l=0;l<s;l++)if(!0===e.showGraphSettings||"title"!=i.attributes[l]){var r=!0===e.showGraphSettings?"###"+i.attributes[l]:i.attributes[l];o.attributes.push(r)}for(var a=0;a<n.length;a++)if("title"!=n[a]){var d=!0;!0===i.wasReset&&(n[a].startsWith("###")?!0===e.showGraphSettings&&(d=!1):!1===e.showGraphSettings&&(d=!1)),d&&o.attributes.push(n[a])}t.save(o.attributes)}void 0!==e.onOk&&null!==e.onOk&&e.onOk(o)}})},500)});else{for(var s=this.load(),l=[],r=!1,a=0,d=s.length;a<d;a++){if(s[a].startsWith("###"))if(!0===e.showGraphSettings)"title"===(m=s[a].substr(3))&&(r=!0),l.push(m);else n.push(s[a]);else!0===e.showGraphSettings?n.push(s[a]):l.push(s[a])}var c=[],u=!1;!0===e.showGraphSettings&&0==l.length&&(u=!0),r||(c=[{name:"title",displayName:this.getAttrDispName("title"),isSelected:!0!==e.showGraphSettings||u,disabled:!0!==e.showGraphSettings}]),c.length>0&&!0===e.showGraphSettings&&l.indexOf("title")>=0&&(c[0].isSelected=!0);var h=0;for(d=l.length;h<d;h++){var p=this.allColumns.find(function(e){return l[h]===e.dbKey});if(p)c.push({name:p.dbKey,displayName:p.columnNLS,isSelected:!0});else if(!0===e.showGraphSettings&&"title"===l[h])c.push({name:"title",displayName:this.getAttrDispName("title"),isSelected:!0,disabled:!1});else{var m=!0===e.showGraphSettings?"###"+l[h]:l[h];n.push(m)}}var g=this.allColumns.length;for(h=0;h<g;h++)-1==l.indexOf(this.allColumns[h].dbKey)&&c.push({name:this.allColumns[h].dbKey,displayName:this.allColumns[h].columnNLS,isSelected:!1});i.showDialog({title:o.SettingsTitle,parent:document.body,showGraphListSettings:e.showGraphListSettings,showGraphSettings:e.showGraphSettings,compactView:e.compactView,allAttributes:c,resetGraphListView:this.resetGraphListView,resetGraphView:this.resetGraphView,onShow:function(t){void 0!==e.onShowDlg&&null!==e.onShowDlg&&e.onShowDlg(t)},onOk:function(i){var o={};if(void 0!==i.compactView&&(o.compactView=i.compactView),void 0!==i.attributes){o.attributes=[];for(var s=i.attributes.length,l=0;l<s;l++)if(!0===e.showGraphSettings||"title"!=i.attributes[l]){var r=!0===e.showGraphSettings?"###"+i.attributes[l]:i.attributes[l];o.attributes.push(r)}for(var a=0;a<n.length;a++)if("title"!=n[a]){var d=!0;!0===i.wasReset&&(n[a].startsWith("###")?!0===e.showGraphSettings&&(d=!1):!1===e.showGraphSettings&&(d=!1)),d&&o.attributes.push(n[a])}t.save(o.attributes)}void 0!==e.onOk&&null!==e.onOk&&e.onOk(o)}})}},setParams:function(e,t,i,n,o){"string"==typeof e&&e.length&&(this.appId=e),Array.isArray(t)&&t.length&&(this.allColumns=t),Array.isArray(i)&&i.length&&(this.defaultCols=i),Array.isArray(n)&&n.length&&(this.resetGraphListView=n),Array.isArray(o)&&o.length&&(this.resetGraphView=o)}})}),define("DS/ENOXVersionExplorerViews/VersionExplorerView",["UWA/Core","UWA/Controls/Abstract","DS/ENOXVersionExplorerThumbnailGraphView/TreeDocGraphViewSync","DS/ENOXVersionExplorerViews/VersionExplorerToolbar","DS/Tree/TreeDocument","DS/ENOXVersionExplorerUtils/ArrayFunctions","DS/ENOXVersionExplorerViews/NodeDropdownMenu","DS/ENOXVersionExplorerViews/VersionExplorerModal","DS/ENOXVersionExplorerThumbnailGraphView/NodeEdgeViewsTemplates/DefaultNodeEdgeViewsTemplate","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","DS/ENOXVersionExplorerSubwayListView/VersionExplorerSubwayListView","DS/ENOXVersionExplorerUtils/VersionExplorerSettings","DS/LifecycleControls/DelayedMask","DS/ENOXVersionExplorerModel/VersionTreeNodeModel","i18n!DS/LifecycleWidget/assets/nls/LifecycleWidgetNls","i18n!DS/ENOXVersionExplorerViews/assets/nls/VersionExplorerView","css!DS/ENOXVersionExplorerViews/styles/VersionExplorer"],function(e,t,i,n,o,s,l,r,a,d,c,u,h,p,m,g,v){"use strict";return t.extend({_versionModel:void 0,init:function(t){function v(){var e=O.options;y=e.parentContainer,M="boolean"!=typeof e.showToolbar||e.showToolbar,D=e.mapScaleLimits||D,T=e.versionExplorerController,N=e.nodeEdgeViewsTemplate,k=e.customOnDrop,N||(N=new a)}function E(e){var t,i,n=e.displayMode===d.DISPLAY_MODES.THUMBNAIL_VIEW?e.node.data.options.id:e.cellInfos.nodeModel.__MASTER__.options.id,o=O._versionModel.searchByAttribute("__checked__",!0),s=T.subscribeEvent("_ENOXVersionExplorerInternalRefreshCompleted",function(l){if(T.unsubscribeEvent("_ENOXVersionExplorerInternalRefreshCompleted",s),e.displayMode===d.DISPLAY_MODES.THUMBNAIL_VIEW){if(i=e.node,O._versionModel._SELECTION_MODE&d.SELECTION_MODES.WITH_COMMANDS&&(O._versionModel._FILTER_ENABLED&&i.data.getAttribute("__filter__")||!O._versionModel._FILTER_ENABLED)){var r,a,c,u=O._versionModel.searchByID(n);if(i=1===u.length?u[0].__treeGraphNode__:void 0)(c=O._versionModel._USER_SET_MULTI_SELECT?i.grNode.views.main.display.elt.querySelector("."+N.HTMLViewsClasses.nodeDropdownMenuButtonClass).getBoundingClientRect():i.grNode.views.main.display.elt.querySelector("."+N.HTMLViewsClasses.nodeClass).getBoundingClientRect())&&(r=(c.left+c.right)/2,a=(c.top+c.bottom)/2),t={treeNode:i.data,target:i.grNode.views.main.display.elt,selectedNodes:o,position:{x:r,y:a},dropdownContainer:L}}}else{var h=e.cellInfos,p=e.event;i=h.nodeModel.__MASTER__,O._versionModel._SELECTION_MODE&d.SELECTION_MODES.WITH_COMMANDS&&(O._versionModel._FILTER_ENABLED&&i.getAttribute("__filter__")||!O._versionModel._FILTER_ENABLED)&&(t={treeNode:i,target:h.view,selectedNodes:o,position:{x:p.clientX,y:p.clientY},dropdownContainer:L})}O._versionModel._SELECTION_MODE&d.SELECTION_MODES.WITH_COMMANDS&&t&&T.publishEvent("ENOXVersionExplorerDropdownMenu",t)});T.publishEvent("_ENOXVersionExplorerInternalRefresh",{reframe:!1,contextualMenu:!0})}function _(e){T.publishEvent("ENOXVersionExplorerDoubleClickVersion",e)}function S(e){var t=e.target;t.options.grid.__checked__=t._isSelected;for(var i=O._versionModel.getXSO().get(),n=0;n<i.length;n++)i[n].options.grid.__checked__=i[n]._isSelected;O._manageSelect({data:!1})}function f(e){var t=O._subwayGraphView,i=!!O._versionModel.filterHash&&Object.keys(O._versionModel.filterHash).length>0,n=t?t.getColumnManager():void 0,o=!!n&&n.hasFilterColumns();if(O._getActiveView()===d.DISPLAY_MODES.SUBWAY_VIEW&&t&&(t.columnDataModelType!==O._versionModel._DATA_MODEL_TYPE||i&&!o))if(t.columnDataModelType=O._versionModel._DATA_MODEL_TYPE,t.prepareUpdateColumns(),n.empty(),n.addColumns(O.customizeColumns.getAll().map(function(e){return{text:e.columnNLS,dataIndex:e.outputKey}})),n.modifyFilterColumns(i),O.customizeColumns._USE_GLOBAL_STORAGE)O.customizeColumns.loadSettingsPromise().then(function(e){if(u.UserSettings.displayMode!=d.DISPLAY_MODES.THUMBNAIL_VIEW){for(var i=[],o=0,l=e.length;o<l;o++)e[o].startsWith("###")||i.push(e[o]);var r=s.intersectionDifference(O.customizeColumns.getAll(),i,function(e,t){return e.dbKey===t})[0].difference;n.hideColumns(r.map(function(e){return e.outputKey})),n.arrangeColumns(i),t.pushUpdateColumns(),t.setRowHeight(d.SUBWAY_VIEW_MODE[u.UserSettings.subwayViewMode])}});else{var l=O.customizeColumns.load();if(u.UserSettings.displayMode!=d.DISPLAY_MODES.THUMBNAIL_VIEW){for(var r=[],a=0,c=l.length;a<c;a++)l[a].startsWith("###")||r.push(l[a]);var h=s.intersectionDifference(O.customizeColumns.getAll(),r,function(e,t){return e.dbKey===t})[0].difference;n.hideColumns(h.map(function(e){return e.outputKey})),n.arrangeColumns(r),t.pushUpdateColumns(),t.setRowHeight(d.SUBWAY_VIEW_MODE[u.UserSettings.subwayViewMode])}}else!i&&o&&n&&n.modifyFilterColumns(i)}function w(e){for(var t={},i={},n=0;n<O.customizeColumns.allColumns.length;n++)t[O.customizeColumns.allColumns[n].dbKey]=O.customizeColumns.allColumns[n].outputKey,i[O.customizeColumns.allColumns[n].dbKey]=O.customizeColumns.allColumns[n].columnNLS;for(var o=[],s=[],l=(n=0,e.length);n<l;n++)if(e[n].startsWith("###")){var r=e[n].substr(3),a=void 0===t[r]?"title"===r?r:void 0:t[r],d=void 0===i[r]?"title"===r?g.SettingsTitle:void 0:i[r];void 0!==a&&null!=d&&(o.push(a),s.push(d))}0===o.length&&(o.push("title"),s.push(g.SettingsTitle)),C.sync.document._titleNames=o,C.sync.document._titleLabels=s,C.activate(),O.setFocus()}function b(e){var t;return Array.isArray(e.options.ancestors)&&e.options.ancestors.length&&(e.options.ancestors.sort(function(e,t){return"I"===e.semantic?-1:1}),t=e.options.ancestors.reduce(function(t,i){return"I"!==i.semantic&&("I"===i.semantic||t.nodes.length||i.dontHighlightLink)||(t.nodes.push(i.id),t.links.push([i.id,e.options.id])),t},{nodes:[],links:[]})),t}e.Class.implement.call(this,{displayLegend:function(e){A&&A.addLegendButton(e),L.getElement(".versionexplorer-legend")[!0===e?"addClassName":"removeClassName"]("versionexplorer-legend-expanded")},removeLegend:function(){L.getElement(".versionexplorer-legend").removeClassName("versionexplorer-legend-expanded"),A&&A.removeLegendButton()},showDialog:function(t,i,n){r.displayDialog(e.merge(t,{globalDiv:L,parentContainer:i,modal:n,footerStyle:O._versionModel._SELECTION_MODE&d.SELECTION_MODES.WITH_COMMANDS?r.footerStyle.none:r.footerStyle.okCancel,position:{clientX:t.clientX,clienty:t.clientY},onCloseDlg:function(){T.cleanup()},onOK:function(e){T.publishEvent("ENOXVersionExplorerModalOK",T.getSelectedNodes())},onCancel:function(){T.publishEvent("ENOXVersionExplorerModalCancel")}}))},hideDialog:function(){r._closeDlg()},setTitle:function(e){r.setTitle(e)},setThumbnailGraphLayout:function(e){C.setRootPosition(i.OrientationMode[e]),u._saveUserSettings("thumbnailGraphLayout",e,O._versionModel.useGlobalStorage,O._versionModel.globalStorageName,O._versionModel.webToWinComSocket),T.publishEvent("ENOXVersionExplorerThumbnailGraphLayoutChanged",e)},reframeThumbnailGraph:function(){V===d.DISPLAY_MODES.THUMBNAIL_VIEW&&C&&C.reframeAll()},toggleDuplicateMode:function(){u.UserSettings.displayDuplicates?this._versionModel._DATA_MODEL_TYPE=d.DATA_MODEL_TYPES.MODEL_HISTORY:this._versionModel._DATA_MODEL_TYPE=d.DATA_MODEL_TYPES.MODEL_REVISION,this._versionModel._circularColorArray.resetCurrentIndex(),this._versionModel._forceReset=!0,this._versionModel.items=null;var e=T.subscribeEvent("_ENOXVersionExplorerInternalRefreshCompleted",function(t){T.unsubscribeEvent("_ENOXVersionExplorerInternalRefreshCompleted",e),T.resetFilter()});T.publishEvent("_ENOXVersionExplorerInternalRefresh",{reframe:!0})},setThumbnailOverviewVisibility:function(){C[!0===u.UserSettings.displayThumbnailOverview?"showOverview":"hideOverview"](),L.getElement(".version-thumbnail-canvas").hide(),L.getElement(".version-thumbnail-canvas").show()},updateViewOptions:function(){var e=void 0;switch(M?(L.getElement(".versionexplorer-toolbar").show(),A||(A=new n({renderTo:L.getElement(".versionexplorer-toolbar"),versionExplorerView:O,versionExplorerController:T})),A.show(),L.getElement(".versionexplorer-toolbar").show()):L.getElement(".versionexplorer-toolbar").hide(),O._versionModel._DATA_MODEL_TYPE){case d.DATA_MODEL_TYPES.MODEL_P:case d.DATA_MODEL_TYPES.MODEL_ER:case d.DATA_MODEL_TYPES.MODEL_REVISION:e={displayThumbnailCollapser:!u.X_DESIGN,displaySemantic:!u.X_DESIGN};break;default:e={displayThumbnailCollapser:!0,displaySemantic:!0}}N&&N.updateViewOptions(e)},displayView:function(t){switch(u.UserSettings.displayMode){case d.DISPLAY_MODES.THUMBNAIL_VIEW:O._displayThumbnailGraph(t);break;case d.DISPLAY_MODES.SUBWAY_VIEW:O._displaySubwayGraph()}!function(){var t=O._versionModel.getLegend();"object"==typeof t&&Object.keys(t).length?(!function(t){var i=void 0;if("object"==typeof t&&Object.keys(t).length)for(var n in i=e.createElement("ul",{class:"iconbar-items-wrap iconbar-items-icons"}),t)i.addContent('<li><div class="symbol">'+n.toString()+'</div><div class="text">'+t[n]+"</div></li>");var o=L.getElement(".versionexplorer-legend ul");o&&o.destroy(),i.inject(L.getElement(".versionexplorer-legend"),"top")}(t),O.displayLegend(u.UserSettings.displayLegend)):O.removeLegend()}(),A&&A.select("menuToggleHelp",u.UserSettings.displayHelp),L.getElement(".versionexplorer-help")[!0===u.UserSettings.displayHelp?"removeClassName":"addClassName"]("versionexplorer-help-hidden"),(O._versionModel._DupToggling||O._versionModel._DATA_MODEL_TYPE===d.DATA_MODEL_TYPES.MODEL_HISTORY)&&A&&A.select("menuToggleDup",u.UserSettings.displayDuplicates)},setSubwayRowHeight:function(e){I.setRowHeight(e)},_customizeColumns:function(){O.customizeColumns.customizations({showGraphListSettings:u.UserSettings.displayMode==d.DISPLAY_MODES.SUBWAY_VIEW,showGraphSettings:u.UserSettings.displayMode==d.DISPLAY_MODES.THUMBNAIL_VIEW,compactView:"SUBWAY_COMPACT_VIEW"===u.UserSettings.subwayViewMode,onOk:function(e){if(void 0!==e.compactView){var t=u.UserSettings.subwayViewMode,i=e.compactView?"SUBWAY_COMPACT_VIEW":"SUBWAY_COMFORTABLE_VIEW";i!==t&&u._saveUserSettings("subwayViewMode",i,O._versionModel.useGlobalStorage,O._versionModel.globalStorageName,O._versionModel.webToWinComSocket)}if(I){I.prepareUpdateColumns();var n=O.customizeColumns.getAll(),o=s.intersectionDifference(n,e.attributes,function(e,t){return e.dbKey===t})[0].difference.map(function(e){return e.outputKey}),l=n.filter(function(t){return e.attributes.findIndex(function(e){return e===t.dbKey})>=0}).map(function(e){return e.outputKey});I.getColumnManager().hideColumns(o),I.getColumnManager().showColumns(l),I.getColumnManager().arrangeColumns(e.attributes),I.pushUpdateColumns(!1),O.setSubwayRowHeight(d.SUBWAY_VIEW_MODE[i])}if(V===d.DISPLAY_MODES.THUMBNAIL_VIEW){for(var r=O.customizeColumns.load(),a={},c={},h=0;h<O.customizeColumns.allColumns.length;h++)a[O.customizeColumns.allColumns[h].dbKey]=O.customizeColumns.allColumns[h].outputKey,c[O.customizeColumns.allColumns[h].dbKey]=O.customizeColumns.allColumns[h].columnNLS;for(var p=[],m=[],v=(h=0,r.length);h<v;h++)if(r[h].startsWith("###")){var E=r[h].substr(3),_=void 0===a[E]?"title"===E?E:void 0:a[E],S=void 0===c[E]?"title"===E?g.SettingsTitle:void 0:c[E];void 0!==_&&null!=S&&(p.push(_),m.push(S))}0===p.length&&(p.push("title"),m.push(g.SettingsTitle)),C.sync.document._titleNames=p,C.sync.document._titleLabels=m,C.activate()}},onShowDlg:function(e){}})},_displayThumbnailGraph:function(e){if(!(O._versionModel instanceof o))throw Error("Version Model must be an instance of TreeDocument");L.getElement(".version-subway-canvas").hide(),I&&I.deactivate(),function(){function e(e){e.displayMode=d.DISPLAY_MODES.THUMBNAIL_VIEW,E(e)}if(L.getElement(".version-thumbnail-canvas").show(),!C){var t;if(isNaN(Number(u.UserSettings.thumbnailGraphLayout)))t=i.OrientationMode[u.UserSettings.thumbnailGraphLayout];else for(var n in t=Number(u.UserSettings.thumbnailGraphLayout),d.THUMBNAIL_GRAPH_LAYOUT)if(d.THUMBNAIL_GRAPH_LAYOUT[n]===t){u._saveUserSettings("thumbnailGraphLayout",n,O._versionModel.useGlobalStorage,O._versionModel.globalStorageName,O._versionModel.webToWinComSocket);break}var o={NodeEdgeViewsTemplate:N,orientation:t,onNodeDropdownMenu:e,onNodeDoubleClick:_,onContextualEvent:e};(C=new i.SyncEGraphTree(L.getElement(".version-thumbnail-canvas"),o)).setModel(O._versionModel),C.createOverview(),M&&(A.show(),A.setView("menuDisplayThumbnailView")),O.setSelectionMode(),O._thumbnailGraphView=C,C.setRootPosition(i.OrientationMode[u.UserSettings.thumbnailGraphLayout])}if(V!==d.DISPLAY_MODES.THUMBNAIL_VIEW){if(O.customizeColumns._USE_GLOBAL_STORAGE)O.customizeColumns.loadSettingsPromise().then(function(e){w(e)});else{var s=O.customizeColumns.load();w(s)}V=d.DISPLAY_MODES.THUMBNAIL_VIEW}else C.notifyUpdateNodes("_selectionMode")}(),!0===e&&C.reframeAll(),u._saveUserSettings("displayMode",V,O._versionModel.useGlobalStorage,O._versionModel.globalStorageName,O._versionModel.webToWinComSocket),A&&A.select("menuToggleOverview",u.UserSettings.displayThumbnailOverview),O.setThumbnailOverviewVisibility(),L.getElement(".version-thumbnail-canvas").hide(),L.getElement(".version-thumbnail-canvas").show(),T.publishEvent("_ENOXVersionExplorerViewChanged")},_displaySubwayGraph:function(){L.getElement(".version-thumbnail-canvas").hide(),C&&(C.deactivate(),C.cleanup(!0)),function(){L.getElement(".version-subway-canvas").show(),I||(v(),I=new c({container:L.getElement(".version-subway-canvas"),onNodeDropdownMenu:function(e){e.displayMode=d.DISPLAY_MODES.SUBWAY_VIEW,E(e)},onNodeDoubleClick:_,customOnDrop:k,versionExplorerController:T,model:O._versionModel,defaultCellHeight:d.SUBWAY_VIEW_MODE[u.UserSettings.subwayViewMode]}),O._subwayGraphView=I,M&&(A.show(),A.setView("menuDisplaySubwayListView")),O.setSelectionMode());V!==d.DISPLAY_MODES.SUBWAY_VIEW&&(I.activate(),I.updateSelectionMode(!0),V=d.DISPLAY_MODES.SUBWAY_VIEW)}(),u._saveUserSettings("displayMode",V,O._versionModel.useGlobalStorage,O._versionModel.globalStorageName,O._versionModel.webToWinComSocket),T.publishEvent("_ENOXVersionExplorerViewChanged")},_manageSelect:function(e){var t=e.data,i=e.notifyThumbnailUI,n=O._versionModel.searchByAttribute("__checked__",!0);O._versionModel._SELECTION_MODE&d.SELECTION_MODES.MULTI_SELECT_ONLY?(n&&n.length>0||O._versionModel._USER_SET_MULTI_SELECT)&&!t&&O._versionModel._SELECTION_MODE&d.SELECTION_MODES.MULTI_SELECT_ONLY?(O._versionModel._SELECTION_MODE&d.SELECTION_MODES.MULTI_SELECT_ACTIVE||(O._versionModel._SELECTION_MODE|=d.SELECTION_MODES.MULTI_SELECT_ACTIVE),A&&A.activateMultiSelect(),G&&(T.unsubscribeEvent("_ENOXVersionExplorerManageMultiSelect",G),G=void 0),x=x||O._versionModel.getModelEvents().subscribe({event:"select"},S),U=U||O._versionModel.getModelEvents().subscribe({event:"unselect"},S),i=!0,A&&A[n&&n.length>1&&O._versionModel._SELECTION_MODE&d.SELECTION_MODES.WITH_COMMANDS?"showMultiSelectDropdown":"hideMultiSelectDropdown"]()):O._versionModel._USER_SET_MULTI_SELECT||(O._versionModel._SELECTION_MODE&=~d.SELECTION_MODES.MULTI_SELECT_ACTIVE,A&&A.deactivateMultiSelect(),x&&(O._versionModel.getModelEvents().unsubscribe(x),x=void 0),U&&(O._versionModel.getModelEvents().unsubscribe(U),U=void 0),G=G||T.subscribeEvent("_ENOXVersionExplorerManageMultiSelect",O._manageSelect),!0===t&&(O._versionModel.prepareAddDelete(),O._versionModel.unselectAll(),n.forEach(function(e){e.options.grid.__checked__=!1}),O._versionModel.pushAddDelete()),i=!0):(O._versionModel._SELECTION_MODE&=~d.SELECTION_MODES.MULTI_SELECT_ACTIVE,O._versionModel._USER_SET_MULTI_SELECT=!1,A&&A.deactivateMultiSelect(),x&&(O._versionModel.getModelEvents().unsubscribe(x),x=void 0),U&&(O._versionModel.getModelEvents().unsubscribe(U),U=void 0),O._versionModel.getXSO().get().length>1&&(O._versionModel.prepareAddDelete(),O._versionModel.unselectAll(),O._versionModel.pushAddDelete()),n.forEach(function(e){e.options.grid.__checked__=!1}),i=!0),A&&A.setMultiSelectCount(n.length),i&&V===d.DISPLAY_MODES.THUMBNAIL_VIEW&&C&&C.notifyUpdateNodes("_selectionMode"),V===d.DISPLAY_MODES.SUBWAY_VIEW&&I&&I.updateSelectionMode()},setSelectionMode:function(e){e!==O._versionModel._SELECTION_MODE&&(e>=0&&(O._versionModel._SELECTION_MODE=e),A&&A[O._versionModel._SELECTION_MODE&d.SELECTION_MODES.MULTI_SELECT_ONLY?"showMultiSelect":"hideMultiSelect"](),this._manageSelect({notifyThumbnailUI:!0}))},onMultiSelectDropdownClick:function(e){var t=T.subscribeEvent("_ENOXVersionExplorerInternalRefreshCompleted",function(i){T.unsubscribeEvent("_ENOXVersionExplorerInternalRefreshCompleted",t);var n=O._versionModel.searchByAttribute("__checked__",!0);T._getMultiSelectMenuListPromise(n).then(function(t){l.displayNodeDropdownMenu.bind(T)({treeNode:n,target:null,menuList:t,position:{x:e.clientX,y:e.clientY},dropdownContainer:L})})});T.publishEvent("_ENOXVersionExplorerInternalRefresh",{reframe:!1,contextualMenu:!0})},build:function(){v(),L=e.createElement("div",{class:"version-global-div",html:['<div class="versionexplorer-toolbar" style="display:none">',"</div>",'<div class="modal-header versionexplorer-legend">','   <span class="close fonticon fonticon-cancel" title=""></span>',"</div>",'<div class="modal-header versionexplorer-help  versionexplorer-help-hidden">','   <span class="help-text"> '+g.highlightLinksMessage+"</span>",'   <span class="close fonticon fonticon-cancel" title=""></span>',"</div>",'<div class="version-thumbnail-canvas">',"</div>",'<div class="version-subway-canvas">',"</div>"].join("\n")}),y&&(y=e.extendElement(y)).setContent(L),function(){var e=L.getElement(".version-thumbnail-canvas");e&&e.addEvent("resize",function(){!function(){var e=L.getElement(".version-thumbnail-canvas");if(e&&"none"!==e.getStyle("display")&&void 0!==C){var t=e.getBoundingClientRect();C&&C.setSize(t.width,t.height)}}()});L.getElement(".versionexplorer-legend span.close").addEvent("mousedown",function(e){A&&A.handleThumbnailGraphToolbar(e,A.getItem("menuToggleLegend"))}),L.getElement(".versionexplorer-help span.close").addEvent("mousedown",function(e){A&&A.handleThumbnailGraphToolbar(e,A.getItem("menuToggleHelp"))}),T.subscribeEvent("ENOXVersionExplorerLoadCompleted",f),T.subscribeEvent("_ENOXVersionExplorerViewChanged",f)}()},_getActiveView:function(){return V},cleanup:function(){C&&C.cleanup(),C=null,I&&I.cleanup(),I=null,V=null},setLoadingMask:function(){R||(R=new h(L,1e3,m.loadingText))},unmask:function(){R&&(R.unmask(),R=null)},setFocus:function(e){var t=e instanceof p?[e]:O._versionModel.getXSO().get();Array.isArray(t)&&t.length>0&&(V===d.DISPLAY_MODES.THUMBNAIL_VIEW?C&&C.reframeOn(t):I&&I.setFocus(t[t.length-1]))},_highlightParents:function(e){if(!0===u.UserSettings.highlightParentConnectionsOnSelect){var t=b(e);!0===u.UserSettings.highlightParentConnectionsOnSelect&&t&&t.links&&this._highlightLinks(t.links)}},_unhighlightParents:function(e){var t=b(e);t&&t.nodes&&this._unhighlightNodes(t.nodes),t&&t.links&&this._unhighlightLinks(t.links)},_highlightNodes:function(e){Array.isArray(e)?e.forEach(function(e){e instanceof p?e.highlight():"string"==typeof e&&1===(e=O._versionModel.searchByID(e)).length&&e[0].highlight()}):"function"==typeof e&&O._versionModel._nodeList.filter(e).forEach(function(e){e.highlight()})},_unhighlightNodes:function(e){Array.isArray(e)?e.forEach(function(e){e instanceof p?e.unhighlight():"string"==typeof e&&1===(e=O._versionModel.searchByID(e)).length&&e[0].unhighlight()}):"function"==typeof e&&O._versionModel._nodeList.filter(e).forEach(function(e){e.unhighlight()})},_highlightLinks:function(e){Array.isArray(e)&&e.length&&e.forEach(function(e){O._versionModel.highlightLink(e)})},_unhighlightLinks:function(e){Array.isArray(e)&&e.length&&e.forEach(function(e){O._versionModel.unhighlightLink(e)})},updateParentHighlighting:function(e){var t;u._saveUserSettings("highlightParentConnectionsOnSelect",e,O._versionModel.useGlobalStorage,O._versionModel.globalStorageName,O._versionModel.webToWinComSocket),O._versionModel.getXSO().get().forEach(function(i){(t=b(i))&&t.links&&O[!0===e?"_highlightLinks":"_unhighlightLinks"](t.links)})}});var O=this,y=void 0,M=!0,D={maxScale:1,minScale:.25},T=void 0,C=void 0,I=void 0,N=void 0,V=void 0,A=void 0,L=void 0,x=void 0,U=void 0,G=void 0,k=void 0,R=void 0;O._parent(t),O._versionModel=t.versionModel,O.customizeColumns=t.customizeColumns,t._isODT&&e.Class.implement.call(this,{_ODTGetThumbnailView:function(){return C},_ODTGetSubwayView:function(){return I}})}})});