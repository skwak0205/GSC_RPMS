define('DS/3DPlayCommands/CmdScenario',['UWA/Core','DS/ApplicationFrame/Command','DS/3DPlay/3DPlay','DS/3DPlay/3DPlayScenarioManager','DS/CoreEvents/Events','DS/WebUtils/Tracker','DS/Core/PointerEvents','DS/WebSystem/Nls','DS/WebSystem/DetectBrowser','DS/WebInfraUI/CmdScenarioUI'],function(UWA,AFRCommand,_3DPlay,ScenarioManager,WUXEvent,Tracker,PointerEvents,NLS,DetectBrowser,CmdScenarioUI){'use strict';var Command = AFRCommand.extend({init:function(options){this._parent(options,{isAsynchronous:true});ScenarioManager._updateScenarioChooser()},beginExecute:function(){WUXEvent.publish({})},execute:function(){Tracker.command(this.getId());var scenarioNos = ScenarioManager.getAllScenarios().length;if(scenarioNos < 2){this.end()}else{var _this = this;NLS.nls('3DPlay/3DPlay','Scenario.PanelTitle',function(txtNls){var scenariosList = [];var registersList = ScenarioManager.getAllRegisters();var isMobile = false;var exp = ScenarioManager.getExperience();if(exp &&(exp._iOS || exp._android)){isMobile = true}var screen_width = _this.getFrameWindow().getViewer().SCREEN_WIDTH;//var bc = "white";var CurrScenario = ScenarioManager.getCurrentScenario();var defaultScenario = ScenarioManager._getDefaultScenario();for(var registerId in registersList){var scenarios = ScenarioManager.getAllScenarioForRegister(registerId);for(var i = 0;i < scenarios.length;i++){var scenario = scenarios[i].scenario;if(!((screen_width < 540 || isMobile) &&!scenario.isMobileCompatible()) && scenarios[i].available){var selected=false;if(CurrScenario){selected = CurrScenario.scenarioID === scenario.scenarioID}else selected =(defaultScenario && defaultScenario.scenarioID === scenario.scenarioID) scenariosList.push({selected:selected,name:scenario.title,thumbnail:scenario.icon,data:{registerId:registerId,scenarioId:scenario.scenarioID,reset:true},onSelectCB:function(data){ScenarioManager.changeScenario(data.registerId,data.scenarioId,data.subScenarioId,data.reset,undefined,false);_this.end();CmdScenarioUI.dispose()}})}}}CmdScenarioUI.create({frmWnd:_this.getFrameWindow(),listchooser:scenariosList,title:txtNls,endcb:function(){_this.endExecute.bind(this)}})})}},endExecute:function(){ScenarioManager._updateScenarioChooser()}});return Command});