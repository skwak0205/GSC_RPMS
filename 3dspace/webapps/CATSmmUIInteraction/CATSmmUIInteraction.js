define("DS/CATSmmUIInteraction/BroadcastEvents",["require","exports","DS/CATSystemCommon/Utils"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PostMessageEventHandler=void 0;t.PostMessageEventHandler=class{constructor(){this._eventTarget=document.createElement("div")}initialize(e){this._messageListener=(t=>{const s="string"==typeof t.data?JSON.parse(t.data):t.data;if(s&&s.from===e&&"name"in s&&"payload"in s){const e=s;n.dispatchCustomEvent(this._eventTarget,e.name,e.payload)}}),window.addEventListener("message",this._messageListener)}release(){this._messageListener&&window.removeEventListener("message",this._messageListener)}addEventListener(e,t){this._eventTarget.addEventListener(e,t)}removeEventListener(e,t){this._eventTarget.removeEventListener(e,t)}}}),define("DS/CATSmmUIInteraction/Commands",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notifyServerExceptionResponse=t.isServerExceptionResponse=t.isDetailedMessage=t.isAuthenticationExceptionResponse=t.isResponseError=t.isMessageError=t.isError=t.notifyException=t.PostMessageCommandHandler=t.Registry=t.CommandNames=void 0,t.CommandNames={select:"syc.select",refresh:"syc.refresh",centerInView:"syc.centerInView",openTree:"syc.openTree",interaction:"syc.interaction",interactionWithArgs:"syc.interactionWithArgs",appInfo:"syc.appInfo",showInfoDialog:"syc.showInfoDialog",focusApplication:"syc.focusApplication"};t.Registry=class{constructor(){this._commands={}}registerCommand(e,t){if(this._commands[e])throw`already registered ${e}`;return this._commands[e]=t,{remove:()=>{delete this._commands[e]}}}executeSelectCommand(e){return this.executeCommand(t.CommandNames.select,e)}executeRefreshCommand(e){return this.executeCommand(t.CommandNames.refresh,e)}executeCenterInViewCommand(e){return this.executeCommand(t.CommandNames.centerInView,e)}executeInteractionCommand(e){return this.executeCommand(t.CommandNames.interaction,e)}executeInteractionWithArgsCommand(e){return this.executeCommand(t.CommandNames.interactionWithArgs,e)}executeApplicationInfoCommand(){return this.executeCommand(t.CommandNames.appInfo,void 0)}executeShowInformationDialog(e){return this.executeCommand(t.CommandNames.showInfoDialog,e)}executeCommand(e,t){if(!this._commands[e])return Promise.reject("Command "+e+" doesn't exist");try{const n=this._commands[e](t);return n||Promise.resolve()}catch(e){return Promise.reject(e)}}};function n(e){return"object"==typeof e&&null!==e&&"code"in e&&"status"in e&&"message"in e}function s(e){return n(e)&&"authenticationRequest"in e}function i(e){return"object"==typeof e&&null!==e&&"detailedMessage"in e&&"message"in e}function o(e){return n(e)&&"detailedMessage"in e&&"exceptionClass"in e}function r(e,t){switch(t.exceptionClass){case"com.dassault_systemes.system_cockpit.shared.SycBadFormatException":case"com.dassault_systemes.system_cockpit.shared.SycBadRequestException":e.executeShowInformationDialog({...t,type:"warning"});break;case"com.dassault_systemes.system_cockpit.shared.SycInternalErrorException":case"com.dassault_systemes.system_cockpit.shared.SycException":case"java.lang.RuntimeException":default:console.trace(t),e.executeShowInformationDialog({message:"An unexpected Error Occurred",type:"warning"})}}t.PostMessageCommandHandler=class{constructor(e){this.window=e}release(){}executeSelectCommand(e){return this.executeCommand(t.CommandNames.select,e)}executeRefreshCommand(e){return this.executeCommand(t.CommandNames.refresh,e)}executeCenterInViewCommand(e){return this.executeCommand(t.CommandNames.centerInView,e)}executeInteractionCommand(e){return this.executeCommand(t.CommandNames.interaction,e)}executeInteractionWithArgsCommand(e){return this.executeCommand(t.CommandNames.interactionWithArgs,e)}executeApplicationInfoCommand(){return this.executeCommand(t.CommandNames.appInfo,void 0)}executeShowInformationDialog(e){return this.executeCommand(t.CommandNames.showInfoDialog,e)}executeCommand(e,t,n=5e4){const s={name:"exec "+e,payload:t,timestamp:Date.now()},i=new Promise((t,i)=>{const o=setTimeout(()=>{i("Timeout "+n+"ms"),window.removeEventListener("message",r)},n),r=n=>{const i="string"==typeof n.data?JSON.parse(n.data):n.data;i&&i.name==="re:exec "+e&&i.reply===s.timestamp&&(clearTimeout(o),window.removeEventListener("message",r),t(i.payload))};window.addEventListener("message",r)});return this.window.postMessage(s,"*"),i}},t.notifyException=function(e,t){o(t)?r(e,t):s(t)?e.executeShowInformationDialog({type:"warning",...t}):i(t)?e.executeShowInformationDialog({type:"warning",...t}):(console.trace(t),e.executeShowInformationDialog({message:"An unexpected Error Occurred",type:"warning"}))},t.isError=function(e){return e instanceof Error},t.isMessageError=function(e){return"object"==typeof e&&null!==e&&"message"in e||e instanceof Error},t.isResponseError=n,t.isAuthenticationExceptionResponse=s,t.isDetailedMessage=i,t.isServerExceptionResponse=o,t.notifyServerExceptionResponse=r}),define("DS/CATSmmUIInteraction/InteractionUtils",["require","exports","DS/CATSmmJsApi/Constants"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasParameterOption=t.containsFiles=t.getModifiersFromEvent=void 0,t.getModifiersFromEvent=function(e){let t=[];return e.shiftKey&&(t=[n.MOD1,n.MOD_SHIFT]),t},t.containsFiles=function(e){if(e&&e.types)for(var t=0;t<e.types.length;t++)if("Files"==e.types[t])return!0;return!1},t.hasParameterOption=function(e,t){return!!e&&-1!==e.indexOf(t)}}),define("DS/CATSmmUIInteraction/HtmlInteraction",["require","exports","DS/CATSmmJsApi/Constants","DS/CATSystemCommon/Utils","DS/CATSmmJsApi/IdUtils","DS/CATSmmJsApi/Utils","DS/CATSmmUIInteraction/Commands","UWA/Drivers/Alone"],function(e,t,n,s,i,o,r){"use strict";const a="syc-noselection-above";class c{constructor(e,t,a){this.html=e,this._commands=a,this._previewInfo=t,this._selectedElements=[],this._clickListener=(e=>{const t=c.findHtmlInteractionArea(e.target,i.getSuperResourceId(this._previewInfo.id));if(t){if(t.areaId){let i;e.shiftKey&&(i=[n.MOD1,n.MOD_SHIFT]);const a=function(e){const t=o.findElementWithTag(e,"form");if(!t)return null;const n={},s=t.elements;for(let e=0;e<s.length;e++){const t=s[e];t.name&&(n[t.name]=t.value)}return n}(t.element),c={type:"pointer",source:null,modifiers:i,target:{component:n.COMPONENT_PREVIEW,environment:this._previewInfo.id,resource:t.resourceId,area:t.areaId},previewOptions:this._previewInfo.options,dialog:null!==a?{parameterValues:a}:void 0};this._commands.executeInteractionCommand(c).then(e=>{(0,s.dispatchCustomEvent)(this.html,"syc-interaction",e),"error"===e.status&&e.error&&(0,r.notifyException)(this._commands,e.error)})}if(t.selectable&&void 0!==t.resourceId){let n=e.ctrlKey?this._selectedElements.slice():[];n.push({resourceId:t.resourceId,element:t.element}),this._setSelectedElements(n,!0,!1)}}}),this.html.addEventListener("click",this._clickListener)}release(){this.html.removeEventListener("click",this._clickListener)}select(e){return this._highlightSelection(e,!0),(0,s.setToArray)(new Set(this._selectedElements.map(e=>e.resourceId)))}_highlightSelection(e,t){const i=this._selectedElements.slice(0);if(this._selectedElements.every(e=>this.html.contains(e.element))&&(0,s.arrayEquals)(this._selectedElements.map(e=>e.resourceId),e))return;const o=[];for(const t of e)for(const e of this._findElementsForResource(t))null===e.getAttribute(n.HTML_SYC_AREA_PARAMETER)&&o.push({resourceId:t,element:e});(0,s.arrayEquals)(o.map(e=>e.element),i.map(e=>e.element))||this._setSelectedElements(o,!1,t)}_findElementsForResource(e){let t=[];this.html.getAttribute(n.HTML_SYC_ID_PARAMETER)===e&&t.push(this.html);const s=o.escapeAttributeValue(e,"'"),r=this.html.querySelectorAll("*["+n.HTML_SYC_ID_PARAMETER+"='"+s+"']");for(let e=0;e<r.length;e++)t.push(r[e]);if(e){const s=i.getLocalId(e),r=o.escapeAttributeValue(n.HTML_SYC_ID_ANCHOR_PREFIX+i.encode(s),"'"),a=this.html.querySelectorAll("a[name='"+r+"']");for(let e=0;e<a.length;e++)t.push(a[e])}return t}_setSelectedElements(e,t,n){this._selectedElements&&this._selectedElements.forEach(e=>{e.element.classList.remove("syc-preview-selected")}),this._selectedElements=e,this._previewInfo.options.selection=e.map(e=>e.resourceId);const i=e.map(e=>e.resourceId);if(this._previewInfo.options.selection=(0,s.setToArray)(new Set(i)),this._selectedElements.forEach(e=>{e.element.classList.add("syc-preview-selected")}),n&&this._selectedElements.length>0){const e=this._selectedElements[0];this._reframeOnElement(e.element)}if(t){const t={selections:e};(0,s.dispatchCustomEvent)(this.html,"previewSelectionChanged",t)}}_reframeOnElement(e){const t=e.getBoundingClientRect(),n=this.html.clientHeight;n>10&&(t.top<0||t.top>n-20)&&(this.html.scrollTop=o.offsetTopRelativeTo(e,this.html)-n/3)}}return function(e){function t(e,t){const s=e.getAttribute(n.HTML_SYC_HREF_PARAMETER),o=e.getAttribute(n.HTML_SYC_PREVIEW_PARAMETER);let r=e.getAttribute(n.HTML_SYC_ID_PARAMETER);const a=e.getAttribute(n.HTML_SYC_AREA_PARAMETER),c=e.getAttribute(n.HTML_SYC_DROPTAGS_PARAMETER),m="true"===e.getAttribute(n.HTML_SYC_TRASHABLE_PARAMETER),l=e.getAttribute(n.HTML_SYC_DRAGTAGS_PARAMETER);if(null===r&&"A"===e.tagName){const s=e.getAttribute("name");if(s&&0===s.indexOf(n.HTML_SYC_ID_ANCHOR_PREFIX)){const e=s.substring(n.HTML_SYC_ID_ANCHOR_PREFIX.length);null!=t&&(r=i.constructAbsoluteId(t,i.decode(e)))}}let d=c?c.split(",").map(e=>e.trim()).filter(e=>e):void 0,u=l?l.split(",").map(e=>e.trim()).filter(e=>e):[];return"true"===e.getAttribute(n.HTML_SYC_DESCRIBES_NAVIGATION_PARAMETER)&&u.push(n.TAG_NAVIGATION_KIND_RESOURCE),{element:e,resourceId:null!==r?r:void 0,areaId:null!==a?a:void 0,navigationTargetResourceId:null!==s?s:void 0,navigationTargetPreviewId:null!==o?o:void 0,dropTags:d,trashable:m,draggable:e.draggable,selectable:null!==r&&!a,dragTags:u}}e.getHtmlInteractionArea=t,e.findHtmlInteractionArea=function(e,n){for(;e&&!e.classList.contains(a);){const s=t(e,n);if(void 0!==s.resourceId||s.areaId||void 0!==s.navigationTargetResourceId)return s;e=e.parentElement}return null}}(c||(c={})),c}),define("DS/CATSmmUIInteraction/SycAppUIProxy",["require","exports","DS/CATSmmUIInteraction/Commands","DS/CATSmmUIInteraction/BroadcastEvents","UWA/Drivers/Alone"],function(e,t,n,s){"use strict";return class{constructor(e){this.options=e}initialize(){if("PostMessage"===this.options.communicationType){const e=new s.PostMessageEventHandler;this.events=e,this.commands=new n.PostMessageCommandHandler(this.options.window);const t=this.commands.executeApplicationInfoCommand();return t.then(t=>{this.info=t,e.initialize(this.info.id),this.events.addEventListener("selectionChangeRequested",e=>this.info.navigationState=e.detail),this.events.addEventListener("contextChanged",e=>this.info.resourcesInContext=e.detail.newContext)}).catch(()=>{console.log("No SycUI on this window: ",this.options.window)}),t}throw new Error("CommunicationType Not supported: "+this.options.communicationType)}release(){"release"in this.commands&&this.commands.release(),"release"in this.events&&this.events.release()}}}),define("DS/CATSmmUIInteraction/PreviewFrameInteraction",["require","exports","DS/CATSmmUIInteraction/SycAppUIProxy","DS/CATSmmUIInteraction/HtmlInteraction","UWA/Drivers/Alone","css!./PreviewSelection.css"],function(e,t,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.interactWithSycUI=void 0,e=window.require,t.interactWithSycUI=function(t,i){const o=new n({communicationType:"PostMessage",window:i.sycWindow});o.initialize().then(t=>{if(t.previewInfo){const n=new s(document.body,t.previewInfo,o.commands);document.body.addEventListener("previewSelectionChanged",e=>{o.commands.executeSelectCommand({selections:e.detail.selections.map(e=>e.resourceId)})});const i=e=>{const t="detail"in e?e.detail:e;n.select(t.selections)};i(t.navigationState),o.events.addEventListener("selectionChangeRequested",i);for(const n of t.previewInfo.previewExtensions)new Promise((t,s)=>{e([n.module],t,s)}).then(e=>{e.activate(o,n.arg)})}}),i.reloadOnRefresh&&o.events.addEventListener("refreshUI",e=>{(e.detail.all||e.detail.resources.find(e=>e.startsWith(t)))&&window.location.reload()})}});