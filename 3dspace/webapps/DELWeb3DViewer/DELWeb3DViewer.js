define("DS/DELWeb3DViewer/ViewManager",["UWA/Core","UWA/Date","UWA/Promise","DS/PlatformAPI/PlatformAPI","DS/Logger/Logger"],function(e,t,r,i,n){"use strict";var o,s=function(){var o,s,a,u,d,c,l,g,f,p,v,S,h,I,D,w="drop",E="remove",A="select",m="cleanAll",b="hide",W="show",L={DROP:w,REMOVE:E,APPLY_FILTER:"applyFilter",SELECT:A,CLEAN_ALL:m,TOGGLE_VISIBILITY:"toggleVisibility",UNHIDE_ALL:"unHideAll",EXCLUSIVE_SHOW:"exclusiveShow",RESET_VIEWER:"resetViewer"},R=[],P=[],V=n.getLogger();return s=function(){var t="/no_private_channel";return e.is(widget)&&(e.is(widget.getValue("x3dSharedId"))?t="/"+widget.getValue("x3dSharedId"):e.is(widget.getValue("x3dAppId"))?t="/"+widget.getValue("x3dAppId"):e.is(widget.getValue("appId"))&&(t="/"+widget.getValue("appId")+"_"+widget.id)),t},a=function(r){var i,n=s(),o=null;return e.is(r)&&(i=(65536*(1+Math.random())|0).toString(16).substring(1),o={metadata:{timestamp:t.now(),originUid:i,appid:n,originWidgetId:r,uid:Math.random().toString(36).substring(2,15),fromWidget:!0}}),o},u=function(e){return widget.data.x3dSharedId+"/"+e+"/MFNMGA"},d=function(t,r,i,n){var o,u=n||{},d=!!e.is(u.privateEvent,"boolean")&&u.privateEvent,c={},l=null;return e.is(r)&&(c.data=r),o=a(i),e.is(o)&&(c=e.merge(c,o),l={name:d?"DS/PADUtils/PADCommandProxy/"+t+s():"DS/PADUtils/PADCommandProxy/"+t,parameters:c}),l},c=function(t){var r,n,s=w,a=!1,u=e.is(t.rootReferenceIds)?t.rootReferenceIds:null,c=e.is(t.filterQuery3d)?t.filterQuery3d:null,l=e.is(t.usePaths)?t.usePaths:null,g=e.is(t.originWidgetId)?t.originWidgetId:null;e.is(u)&&(e.is(c)?n={rootsWithFilters:[{filter:{CVQuery3D:c,filterRootIds:u}}]}:!0===l?n={paths:u}:(n={pids:u},o.getRoots().forEach(function(e){e.modelIdentification===u[0]&&(a=!0)}))),e.is(g)&&e.is(n)&&!1===a&&(r=d(s,n,g,{privateEvent:!0}),e.is(r)&&i.publish(r.name,r.parameters))},l=function(t){var r,n,o=E,s=e.is(t.rootReferenceIds)?t.rootReferenceIds:null,a=e.is(t.originWidgetId)?t.originWidgetId:null,u=e.is(t.usePaths)?t.usePaths:null;e.is(s)&&(r=!0===u?{paths:s}:{pids:s}),e.is(a)&&e.is(r)&&(n=d(o,r,a,{privateEvent:!0}),e.is(n)&&i.publish(n.name,n.parameters))},g=function(t){var i,n,s=e.is(t.rootReferenceIds)?t.rootReferenceIds:null,a=e.is(t.filterQuery3d)?t.filterQuery3d:null;!!e.is(t.removeFilter,"boolean")&&t.removeFilter?(i=o.getController(),e.is(i)&&new r(function(t,r){var n=o.subscribe({event:"onEndRootRemoved"},function(i){var a,u=!1;e.is(i)&&(a=i.ids,e.is(a)&&(u=e.equals(a,s))),e.is(n)&&o.unsubscribe(n),u?t():r("specified root(s) not removed")});i.removeRoots({pids:s},!1,!1)}).then(function(){i.addRoots({pids:s},!1)}).catch(function(e){V.error("ViewManager","Error occured while removing root on Filter Removal: "+e)})):(n=o.getBIController(),e.is(n)?n.applyFilter({CVQuery3D:a,filterRootIds:s},!1):V.error("ViewManager","Error occured while applying filter in 3D: BIController not available"))},f=function(t){var r,n=m,o=e.is(t.originWidgetId)?t.originWidgetId:null;e.is(o)&&(r=d(n,null,o,{privateEvent:!0}),e.is(r)&&i.publish(r.name,r.parameters))},p=function(t){var r,n,o=A,s=e.is(t.occRIRPaths)?t.occRIRPaths:null,a=e.is(t.originWidgetId)?t.originWidgetId:null;return e.is(s)&&(r={paths:s}),e.is(a)&&e.is(r)&&(n=d(o,r,a,{privateEvent:!1}),e.is(n)&&i.publish(n.name,n.parameters)),n},v=function(t){var r,n,o,s=e.is(t.occRIRPaths)?t.occRIRPaths:null,a=e.is(t.toShow,"boolean")?t.toShow:null,u=e.is(t.originWidgetId)?t.originWidgetId:null;e.is(a)&&(r=a?W:b),e.is(s)&&(n={paths:s}),e.is(u)&&e.is(r)&&e.is(n)&&(o=d(r,n,u,{privateEvent:!0}),e.is(o)&&i.publish(o.name,o.parameters))},S=function(){var t=o.getHideShowController();e.is(t)&&t.resetState()},D=function(){o.getHideShowController().resetExclusiveShow()},h=function(e){var t=[];return e.forEach(function(e){var r=e[e.length-1];-1===t.indexOf(r)&&t.push(r)}),t},I=function(t){var r=o.getHideShowController(),i=o.getController(),n=t.pathsToShow,s=t.pathsToHide,a=t.firstSelection,u=t.differenceOperator,d=[],c=[],l=[],g=[],f=[],p=[],v=function t(r,i,n){var o;0===(o=r.getChildren()).length?e.is(r.getReferenceId)&&-1===i.indexOf(r.getReferenceId())&&(i.push(r.getReferenceId()),!1===n&&R.indexOf(-1===r.getReferenceId())&&R.push(r.getReferenceId())):o.forEach(function(e){var r=e.getReferenceIterator();t(r,i)})};!0===i.isLargeDataStructure()?V.error("The structure is too large; it s not yes implemented"):(r=o.getHideShowController(),i=o.getController(),(d=h(n)).forEach(function(e){!1===i.isRegistered(e)&&l.push(e)}),d.forEach(function(e){var t=i.createReferenceIterator(e);v(t,g)}),!0===u?((c=h(s)).forEach(function(e){!1===i.isRegistered(e)&&l.push(e)}),c.forEach(function(e){var t=i.createReferenceIterator(e);v(t,f)})):f=function(e){var t=[];return R.forEach(function(r){-1===e.indexOf(r)&&t.push(r)}),R=e,t}(g),function(e,t,r){var i=[];a&&(P=[]),!0===r&&(P=P.concat(e)),t.length>0&&(P.forEach(function(e){i.push(e.toString())}),t.forEach(function(e){var t=i.indexOf(e.toString());t>=0&&(i.splice(t,1),P.splice(t,1))}))}(n,s,u),p=function(e,t){var r=[];return e.forEach(function(e){r.push({id:e,state:!0})}),t.forEach(function(e){r.push({id:e,state:!1})}),r}(g,f),i.setForceReferencesLoad({data:p,callback:function(){V.info("references successfully loaded"),!0===u?r.exclusiveShow({paths:P}):r.exclusiveShow({paths:n})}}))},{getAllEventHandlers:function(){var e={};return e[L.DROP]=c,e[L.REMOVE]=l,e[L.APPLY_FILTER]=g,e[L.CLEAN_ALL]=f,e[L.SELECT]=p,e[L.TOGGLE_VISIBILITY]=v,e[L.HIDE]=v,e[L.UNHIDE_ALL]=S,e[L.EXCLUSIVE_SHOW]=I,e[L.RESET_VIEWER]=D,e},subscribeToAllInterWidgetEvents:function(e){var t=this.getAllEventHandlers();o=e,Object.keys(t).forEach(function(e){var r=u(e);i.subscribe(r,t[e])})}}};return{getInstance:function(){return e.is(o)||(o=new s),o}}}),define("DS/DELWeb3DViewer/MoreAttributesManager",["i18n!DS/PADServices/assets/nls/PADServices.json","DS/PADServices/utils/GlobalUtils","DS/PADServices/views/private/WizardSteps","text!DS/PADServices/assets/init/MoreAttrWizardSteps.json","DS/PADServices/views/private/SearchInput","DS/PADServices/views/private/Iconbar"],function(e,t,r,i,n,o){"use strict";return{isWebInWinContext:function(){return t.isWebInWinContext()},uid:function(){return t.uid()},getTxtWizardSteps:function(){return i},getNewWizardSteps:function(e,t,i){return new r({modelEvents:e,renderTo:t,steps:i})},getNewSearchInput:function(e,t){return new n({events:{onSearch:e}}).inject(t)},getNewIconBar:function(e){return new o(e)},getNLSAttributeTitle:function(){return e.moreAttributesWizard.attrTitle},getNLSNext:function(){return e.moreAttributesWizard.next},getNLSCancel:function(){return e.moreAttributesWizard.cancel},getNLSDone:function(){return e.moreAttributesWizard.done},getNLSShortHelp:function(t){return e.moreAttributesWizard[t]},getNLSShortHelpReplace:function(t){return e.replace(e.moreAttributesWizard.declaredInWithTypes,{types:t})},getNLSFilterRowsKind:function(){return e.moreAttributesWizard.filterRowsKind},getNLSNone:function(){return e.moreAttributesWizard.none},getNLSFilterReference:function(){return e.moreAttributesWizard.filterreference},getNLSFilterInstance:function(){return e.moreAttributesWizard.filterinstance},getNLSFilterRows:function(){return e.moreAttributesWizard.filterRows},getNLSSelected:function(){return e.moreAttributesWizard.selected},getNLSUnSelected:function(){return e.moreAttributesWizard.unselected}}}),define("DS/DELWeb3DViewer/App3D",["UWA/Core","DS/ENOPAD3DViewer/PAD3DViewer","DS/PADUtils/PADSettingsMgt","DS/PADServices/views/LandingPage","DS/DELWeb3DViewer/ViewManager","DS/Logger/Logger","DS/WebappsUtils/WebappsUtils","text!DS/DELWeb3DViewer/assets/json/3DViewerConfigurations.json"],function(e,t,r,i,n,o,s,a){"use strict";return function(){var i,u,d,c,l=n.getInstance(),g=o.getLogger({name:"App3D"}),f=!0;return u=function(){return widget.getValue("x3dSharedId")||widget.addPreference({name:"x3dSharedId",type:"hidden",defaultValue:"DELMFNMGA_appId"}),r.set_app_context("enopad3dviewer",!0),r.setSetting("lang",widget.lang),widget.mergePreferences(r.getWidgetPreferences()),widget.addEvent("endEdit",r.updateWidgetPreferences.bind(r)),null},d=function(){var t=s.getWebappsAssetUrl("DELWeb3DViewer","icons/32")+"/I_DEL3DViewer_Favicon.png";e.is(i)&&l.subscribeToAllInterWidgetEvents(i),widget.setIcon(t)},c=function(e){f&&(widget.setBody(i.render()),f=!1,e?g.log("PAD3DViewer added to widget body after onReady Event"):g.error("PAD3DViewer added to widget body after setTimeout (10000 ms)"),d())},{onLoad:function(){var r;r=JSON.parse(a),r=e.merge(r,{widget:widget,visuProgressiveTileModel:!0}),e.is(i)||(u(),i=new t(r),g.log("PAD3DViewer created"),i.subscribe({event:"onReady"},function(){c(!0)}),setTimeout(function(){c(!1)},1e4))},onRefresh:function(){e.is(i)&&i.refresh()}}}});