define("DS/CSIViewModelWebImplement/CSIVMClientObject",["UWA/Core","DS/CSIViewModelWebInterfaces/CSIVMClientStateMode"],function(t,e){"use strict";function i(t,e,i){this.clear(),this._localId=e,this._idPattern=i,this._nameSpace=t}function o(){}return i.prototype.stateMode=e,o.prototype.initTempoChildren=function(){t.is(this._childrenTempo)||(!0===this._childrenMapping?this._childrenTempo=new Map(this._children):this._childrenTempo=void 0!==this._children?this._children.slice():[],this._withTempoState=!0)},o.prototype.initTempoParents=function(){void 0===this._parentsTempo&&(this._parentsTempo=void 0!==this._parents?this._parents.slice():[],this._withTempoState=!0)},o.prototype.abort=function(){this._childrenTempo=void 0,this._parentsTempo=void 0,this._associatedObjectTempo=void 0,this._withTempoState=!1},o.prototype.commit=function(){this._withTempoState&&(void 0!==this._childrenTempo&&(this._children=this._childrenTempo),void 0!==this._parentsTempo&&(this._parents=this._parentsTempo),void 0!==this._associatedObjectTempo&&(this._associatedObject=this._associatedObjectTempo),this.abort())},o.prototype.getProperty=function(t,e){let o=void 0;switch(e){case i.prototype.stateMode.Tempo:case i.prototype.stateMode.TempoOrPermanent:void 0===(o=this[t+"Tempo"])&&(o=this[t]);break;case i.prototype.stateMode.Permanent:o=this[t]}return o},o.prototype.setAssociatedObject=function(t){this._withTempoState=!0,this._associatedObjectTempo=t},o.prototype.getAssociatedObject=function(t){return this.getProperty("_associatedObject",t)},o.prototype.addChild=function(t){this.initTempoChildren(),!0===this._childrenMapping?this._childrenTempo.set(t.getLocalId(),t):this._childrenTempo.push(t)},o.prototype.addChildren=function(t){if(this.initTempoChildren(),!0===this._childrenMapping){let e,i=t.length;for(let o=0;o<i;++o)e=t[o],this._childrenTempo.set(e.getLocalId(),e)}else{let e=t.length,i=this._childrenTempo.length;e+=i,this._childrenTempo.length=e;for(let o=i;o<e;++o)this._childrenTempo[o]=t[o-i]}},o.prototype.removeChild=function(t){if(this.initTempoChildren(),!0===this._childrenMapping)this._childrenTempo.delete(t.getLocalId());else{let e=this._childrenTempo.indexOf(t);e>-1&&this._childrenTempo.splice(e,1)}},o.prototype.removeChildren=function(t){this.initTempoChildren();let e,i,o=t.length;if(!0===this._childrenMapping)for(e=0;e<o;++e)i=t[e],this._childrenTempo.delete(i.getLocalId());else{let r=-1;for(e=0;e<o;++e)i=t[e],(r=this._childrenTempo.indexOf(i))>-1&&this._childrenTempo.splice(r,1)}},o.prototype.getChildren=function(t){let e,i=this.getProperty("_children",t);return void 0!==i&&(e=!0===this._childrenMapping?Array.from(i.values()):i),e},o.prototype.getMappedChildren=function(t){return!0===this._childrenMapping?this.getProperty("_children",t):void 0},o.prototype.addParent=function(t){this.initTempoParents(),this._parentsTempo.push(t)},o.prototype.removeParent=function(t){this.initTempoParents();let e=this._parentsTempo.indexOf(t);e>-1&&this._parentsTempo.splice(e,1)},o.prototype.getParents=function(t){return this.getProperty("_parents",t)},i.prototype.clear=function(){void 0!==this._ViewDatas&&delete this._ViewDatas},i.prototype.getLocalId=function(){return this._localId},i.prototype.getIdPattern=function(){return this._idPattern},i.prototype.getNameSpace=function(){return this._nameSpace},i.prototype.getMainObject=function(){return this._mainObj},i.prototype.addObject=function(){void 0===this._additionalObjects&&(this._additionalObjects=[]);let t=new i(this._nameSpace,this._localId,this._idPattern);return t._mainObj=this,t._dualObj=this._dualObj,t._dualViewType=this._dualViewType,this._additionalObjects.push(t),t},i.prototype.getAdditionalObjects=function(){return this._additionalObjects},i.prototype.getViewData=function(t){let e=void 0;return void 0!==this._ViewDatas&&(e=this._ViewDatas[t.getViewType()]),e},i.prototype.getOrCreateViewData=function(t){let e=void 0,i=t.getViewType();return void 0!==this._ViewDatas&&(e=this._ViewDatas[i]),void 0===e&&(void 0===this._ViewDatas&&(this._ViewDatas={}),e=new o,!0===this._childrenMapping&&(e._childrenMapping=!0),this._ViewDatas[i]=e),e},i.prototype.deleteViewData=function(t){if(void 0!==this._ViewDatas&&void 0!==t&&(delete this._ViewDatas[t.getViewType()],0===Object.keys(this._ViewDatas).length&&delete this._ViewDatas,void 0!==this._dualObj)){this._dualObj.getDualObject(t.getViewType())===this&&this._dualObj.setDualObject(),this.setDualObject()}},i.prototype.isEmpty=function(){if(void 0!==this._additionalObjects){let t=0,e=this._additionalObjects.length;for(t=0;t<e;t++)if(!this._additionalObjects[t].isEmpty())return!1}return void 0===this._ViewDatas&&!this.isRoot()},i.prototype.isTemporary=function(){let t=void 0,e=void 0;if(void 0!==this._ViewDatas)for(t of Object.values(this._ViewDatas))if(void 0!==(e=this.isRoot()?t.getChildren(i.prototype.stateMode.Permanent):t.getParents(i.prototype.stateMode.Permanent)))return!1;return!0},i.prototype.associateViewElt=function(t,e){let i=this.getOrCreateViewData(t);void 0!==i&&i.setAssociatedObject(e)},i.prototype.getAssociatedViewElt=function(t){let e=void 0,o=this.getViewData(t);return void 0!==o&&(e=o.getAssociatedObject(i.prototype.stateMode.TempoOrPermanent)),e},i.prototype.getKey=function(t){let e=void 0,o=void 0;if(void 0!==this._ViewDatas)for(let r of Object.keys(this._ViewDatas)){if((o=this._ViewDatas[r].getAssociatedObject(i.prototype.stateMode.Tempo))===t){e=this.getNameSpace().getTreeKeyFromViewType(r);break}if((o=this._ViewDatas[r].getAssociatedObject(i.prototype.stateMode.Permanent))===t){e=this.getNameSpace().getTreeKeyFromViewType(r);break}}return e},i.prototype.setRoot=function(){this._isRoot=!0,this._nameSpace.setRootObject(this)},i.prototype.isRoot=function(){return!0===this._isRoot},i.prototype.isLeaf=function(t){let e=!0,i=this.getChildren(t,this.stateMode.TempoOrPermanent);return void 0!==i&&i.length>0&&(e=!1),e},i.prototype.activateChildrenMapping=function(){this._childrenMapping=!0},i.prototype.addChild=function(t,e){let i=this.getOrCreateViewData(t);void 0!==i&&(i.addChild(e),e.addParent(t,this))},i.prototype.addChildren=function(t,e){let i=this.getOrCreateViewData(t);if(void 0!==i){i.addChildren(e);let o=e.length;for(let i=0;i<o;i++)e[i].addParent(t,this)}},i.prototype.addParent=function(t,e){let i=this.getOrCreateViewData(t);void 0!==i&&i.addParent(e)},i.prototype.removeChild=function(t,e){let i=this.getOrCreateViewData(t);void 0!==i&&(i.removeChild(e),e.removeParent(t,this))},i.prototype.removeChildren=function(t,e){let i=this.getOrCreateViewData(t);if(void 0!==i){i.removeChildren(e);let o=e.length;for(let i=0;i<o;i++)e[i].removeParent(t,this)}},i.prototype.removeParent=function(t,e){let i=this.getOrCreateViewData(t);void 0!==i&&i.removeParent(e)},i.prototype.getChildren=function(t,e){let i=void 0,o=this.getViewData(t);return void 0!==o&&(i=o.getChildren(e)),i},i.prototype.getMappedChildren=function(t,e){let i=void 0,o=this.getViewData(t);return void 0!==o&&(i=o.getMappedChildren(e)),i},i.prototype.getAllChildren=function(t){let e,i,o,r=[],n=void 0,a=void 0,s=void 0;if(void 0!==this._ViewDatas)for(n of Object.keys(this._ViewDatas))if(void 0!==(s=(a=this._ViewDatas[n]).getChildren(t)))for(e=s.length,i=0;i<e;i++)o=s[i],r.indexOf(o)<0&&r.push(o);return r},i.prototype.getAllParents=function(t){let e,i,o,r=[],n=void 0,a=void 0,s=void 0;if(void 0!==this._ViewDatas)for(n of Object.keys(this._ViewDatas))if(void 0!==(s=(a=this._ViewDatas[n]).getParents(t)))for(e=s.length,i=0;i<e;i++)o=s[i],r.indexOf(o)<0&&r.push(o);return r},i.prototype.getFirstParentsDefiningNameSpaceOfThis=function(t){let e,i=[];if(void 0===t){if((e=this.getIdPattern()._idSpace)===this.getIdPattern()._idContext)return i}else e=t;let o=this.getAllParents(this.stateMode.Tempo),r=o.length;if(r)if(o[0].getIdPattern()._idContext===e)for(let t=0;t<r;t++){if(o[t].getIdPattern()._idContext!==e)return;i.push(o[t])}else{let t=0;for(;!i.length&&t<r;)i=o[t].getFirstParentsDefiningNameSpaceOfThis(e),t++}return i},i.prototype.getParents=function(t,e){let i=void 0,o=this.getViewData(t);return void 0!==o&&(i=o.getParents(e)),i},i.prototype.getChildrenWithId=function(t,e,i){let o=[];if(void 0===i)return o;if(!0===this._childrenMapping){let r=this.getMappedChildren(t,e);if(void 0!==r){let t=i.length;if(r.size===t)o=Array.from(r.values());else{let e,n,a;for(e=0;e<t;++e)"string"==typeof(a=i[e])&&(a=parseInt(a)),void 0!==(n=r.get(a))&&o.push(n)}}}else{let r=this.getChildren(t,e);if(void 0!==r){let t=r.length,e=i.length;if(t===e)o=r;else{let n,a,s=new Map;for(n=0;n<t;++n)void 0!==(a=r[n])&&s.set(a.getLocalId().toString(),a);for(n=0;n<e;++n)void 0!==(a=s.get(i[n]))&&o.push(a)}}}return o},i.prototype.preCommit=function(e){if(this._nameSpace._errManager.addContext({name:"preCommit",arguments:arguments}),void 0!==this._additionalObjects){let t,i=0,o=this._additionalObjects.length;for(i=0;i<o;i++)(t=this._additionalObjects[i]).preCommit(e)}let o=this.getViewData(e);if(void 0!==o){let r=o.getParents(i.prototype.stateMode.Tempo);if(!(this.isRoot()||t.is(r)&&0!==r.length)){let t=0,r=o.getChildren(i.prototype.stateMode.Tempo);if(void 0!==r){let i,o=r.length;for(t=0;t<o;t++)(i=r[t]).removeParent(e,this),i.preCommit(e)}this.deleteViewData(e)}}this._nameSpace._errManager.cleanContext(arguments)},i.prototype.commit=function(t){if(this._nameSpace._errManager.addContext({name:"commit",arguments:arguments}),void 0!==this._additionalObjects){let e,i=0,o=this._additionalObjects.length;for(i=0;i<o;i++)(e=this._additionalObjects[i]).commit(t)}let e=this.getViewData(t);void 0!==e&&e.commit(),this._nameSpace._errManager.cleanContext(arguments)},i.prototype.abort=function(t){if(this._nameSpace._errManager.addContext({name:"abort",arguments:arguments}),void 0!==this._additionalObjects){let e=0;for(e=this._additionalObjects.length-1;e>=0;e--)this._additionalObjects[e].isTemporary()?this._additionalObjects.splice(e,1):this._additionalObjects[e].abort(t)}let e=this.getViewData(t);void 0!==e&&e.abort(),void 0!==this._dualObj&&this._dualObj.setDualObject(t.getViewType(),this),this._nameSpace._errManager.cleanContext(arguments)},i.prototype.setDualObject=function(t,e){this._dualObj=e||void 0,this._dualViewType=t},i.prototype.getDualObject=function(t){let e=void 0;return t!==this._dualViewType&&void 0!==t||(e=this._dualObj),e},i}),define("DS/CSIViewModelWebImplement/CSIVMErrorManager",[],function(){function t(){this._activeState=!1,this._debugContext=[]}return t.prototype.setDebugMode=function(t){let e=this;e._activeState=1==t&&t,e._activeState&&(window.onerror=function(t,i,o,r,n){e._activeState&&(console.error("Context",e._debugContext),console.error("StackTrace",n))})},t.prototype.addContext=function(t){this._activeState&&this._debugContext.push(t)},t.prototype.cleanContext=function(t){let e=this;e._activeState&&0!=e._debugContext.length&&-1!=(index=function(){for(let i in e._debugContext)if(t==e._debugContext[i].arguments)return i;return-1}())&&e._debugContext.splice(index)},t}),define("DS/CSIViewModelWebImplement/CSIVMStringMap",[],function(){"use strict";function t(){this._data=new Map,this.clear()}return t.prototype.clear=function(){this._data.clear()},t.prototype.createValue=function(t,e){if(void 0===t)return;let i=t.toString(),o=this._data.get(i);Array.isArray(o)?o.push(e):this._data.set(i,[e])},t.prototype.get=function(t){if(void 0!==t)return this._data.get(t.toString())},t.prototype.remove=function(t,e){if(void 0!==t){let i=t.toString(),o=!0;if(void 0!==e){let t=this._data.get(i);if(Array.isArray(t)){let i=t.indexOf(e);i>-1&&t.splice(i,1),t.length>0&&(o=!1)}}o&&this._data.delete(i)}},t.prototype.forEachValue=function(t,e){let i,o,r,n;if(void 0!==e){if(n=this._data.get(e.toString()),Array.isArray(n))for(o=n.length,i=0;i<o;++i)r=n[i],t(r)}else this._data.forEach(function(e){if(Array.isArray(e))for(o=e.length,i=0;i<o;++i)r=e[i],t(r)})},t.prototype.findValue=function(t){let e,i,o=this._data.values(),r=o.next();for(;!r.done&&void 0===e;)i=r.value,Array.isArray(i)&&(e=i.find(function(e){return t(e)})),r=o.next();return e},t}),define("DS/CSIViewModelWebImplement/CSIVMClientNameSpace",["UWA/Core","DS/CSIViewModelWebImplement/CSIVMClientObject","DS/CSIViewModelWebImplement/CSIVMStringMap"],function(t,e,i){"use strict";function o(t,e){this._treeKeys={},this._objects=new i,this._uuid=t,this._model=e,this._errManager=e.getErrorManager(),this._rootObj=void 0}return o.prototype.delimiter="#",o.prototype.atomicDelimiter="/",o.prototype.clear=function(t){if(void 0!==t){delete this._treeKeys[t.getViewType()];let e=t.getUUID();this._model.removeTreeKey(e)}(this.isEmpty()||void 0===t)&&(void 0!==this._objects&&this._objects.clear(),this._treeKeys={},this._rootObj=void 0)},o.prototype.isEmpty=function(){return!Object.keys(this._treeKeys).length},o.prototype.addTreeKey=function(t){void 0!==t&&(this._treeKeys[t.getViewType()]=t)},o.prototype.getTreeKey=function(t){return this._model.getTreeKey(t)},o.prototype.getAllTreeKeys=function(){return Object.values(this._treeKeys)},o.prototype.getTreeKeyFromViewType=function(t){return this._treeKeys[t]},o.prototype.isNameSpaceOfTreeKey=function(t){return void 0!==t&&this._treeKeys[t.getViewType()]===t},o.prototype.setRootObject=function(t){this._rootObj=t},o.prototype.getRootObject=function(){return this._rootObj},o.prototype.getObjects=function(t,e){let i=[];return this._objects.forEachValue(function(e){e.getIdPattern()===t&&i.push(e)},e),i},o.prototype.getObjectsFromCtx=function(t,e){let i=[];return this._objects.forEachValue(function(e){e.getIdPattern()._idContext===t&&i.push(e)},e),i},o.prototype.createObject=function(t,i){let o=void 0;return this._model.isAnExistingIdPattern(t)&&(o=new e(this,i,t),this._objects.createValue(i,o)),o},o.prototype.getOrCreateObject=function(t,e){let i=void 0,o=this.getObjects(t,e);return i=o.length?o[0]:this.createObject(t,e)},o.prototype.removeObject=function(t){if(void 0!==t){let e=t.getLocalId();this._objects.remove(e,t);let i=t.getDualObject();if(void 0!==i){i.getDualObject()===t&&i.setDualObject()}}},o.prototype.commit=function(t){this._errManager.addContext({name:"commit",arguments:arguments}),this._objects.forEachValue(function(e){e.preCommit(t)});let e=[];this._objects.forEachValue(function(i){i.isEmpty()?e.push(i):i.commit(t)});for(let t=e.length,i=0;i<t;++i){let t=e[i];this.removeObject(t)}this._errManager.cleanContext(arguments)},o.prototype.abort=function(t){this._errManager.addContext({name:"abort",arguments:arguments}),this._objects.forEachValue(function(e){e.abort(t)}),this._errManager.cleanContext(arguments)},o.prototype.buildGlobalId=function(t){this._errManager.addContext({name:"buildGlobalId",arguments:arguments});let e="",i="",o=null,r=null,n=null,a=!1,s=!0,d=!0;for(let p=t.length-1;p>=0;p--){let h=t[p],l=h.getIdPattern();o=l._idSpace,a=l._shared,i=(n=l._idContext)+this.delimiter+h.getLocalId(),n&&o&&n===r&&(d=!0),d&&(s||(i+=this.atomicDelimiter),s=!1,e=i+=e),(d=a)||(r=o)}return this._errManager.cleanContext(arguments),e},o.prototype.decodeGlobalId=function(t){return void 0===t.State&&(t.State=e.prototype.stateMode.Permanent),this.decodeGlobalIdInternal(t)},o.prototype.decodeGlobalIdInternal=function(e){this._errManager.addContext({name:"decodeGlobalIdInternal",arguments:arguments});const i=e.Node,o=e.Id,r=e.State,n=e.AuthorizePartialPath,a=e.isOptimizedPath,s=o.split(this.atomicDelimiter);let d=[],p=null,h=t.is(i)?i:this.getRootObject();d.push(h);for(let e=0;e<s.length&&t.is(d);e++){let i=s[e],o=void 0,l=this.findNodesByIdentifier(i),c=l.length;if(1===c)o=l[0];else if(c)for(let e=0;e<c&&!t.is(o);e++){let i=l[e].getFirstParentsDefiningNameSpaceOfThis(),r=i.length;for(let n=0;n<r&&!t.is(o);n++)d.indexOf(i[n])>=0&&(o=l[e])}if(!t.is(o)){d=void 0;break}let u=o.getAdditionalObjects();if(t.is(u)){let t,e,i=o;o=void 0;for(let n=-1;n<u.length&&void 0===o;n++){e=(t=-1===n?i:u[n]).getAllParents(r);for(let i=0;i<e.length&&void 0===o;i++)e[i]===h&&(o=t)}}let f=o,g=[];for(;o!==h;){if(void 0===o){d=void 0;break}if(g.push(o),!a)break;if(p=o.getAllParents(r),o=p[0],p.length>1){if(-1===p.indexOf(h)){console.warn("Impossible to create a full PathElement from the identifier."),!0!==n?d=void 0:d.splice(0,1);break}o=h}}if(d)for(let t=g.length-1;t>=0;t--)d.push(g[t]);h=f}return this._errManager.cleanContext(arguments),d},o.prototype.decodeGlobalIdToViewObjects=function(t,e,i,o,r){let n;this._errManager.addContext({name:"decodeGlobalIdToViewObjects",arguments:arguments});const a=this.decodeGlobalId({Node:t,Id:i,State:o,isOptimizedPath:r});if(void 0!==a){n=[];let t=null;for(const i of a){if(void 0===(t=i.getAssociatedViewElt(e))){n=void 0;break}n.push(t)}}return this._errManager.cleanContext(arguments),n},o.prototype.findNodesByIdentifier=function(t){let e=t.split(this.delimiter),i=e[0],o=e[1];return this.getObjectsFromCtx(i,o)},o}),define("DS/CSIViewModelWebImplement/CSIVMClientModel",["DS/CSIViewModelWebImplement/CSIVMClientNameSpace","DS/CSIViewModelWebInterfaces/CSIVMClientTreeKey","DS/CSIViewModelWebImplement/CSIVMErrorManager"],function(t,e,i){"use strict";function o(t,e,i){this._idSpace=t,this._idContext=e,this._shared=i}function r(){this.clear()}return r.prototype.clear=function(){Array.isArray(this._nameSpaces)&&this._nameSpaces.forEach(function(t){t.clear()}),this._nameSpaces=[],this._idPatterns=[],this._treeKeys={},this._errorManager={}},r.prototype.getOrCreateTreeKey=function(t,i,o,r){let n=this.getTreeKey(t);return void 0===n&&(n=new e(t,i,o,r),this._treeKeys[t]=n),n},r.prototype.getTreeKey=function(t){return this._treeKeys[t]},r.prototype.getTreeKeysFromViewType=function(t){let e=[];for(const i of Object.values(this._treeKeys))i.getViewType()===t&&e.push(i);return e},r.prototype.removeTreeKey=function(t){void 0!==this.getTreeKey(t)&&delete this._treeKeys[t]},r.prototype.getIdPattern=function(t,e,i){let o=void 0;if(void 0!==t&&void 0!==e&&void 0!==i){let r=0,n=this._idPatterns.length,a=null;for(r=0;r<n&&void 0===o;r++)(a=this._idPatterns[r])._idSpace===t&&a._idContext===e&&a._shared===i&&(o=a)}return o},r.prototype.isAnExistingIdPattern=function(t){let e=!1;if(void 0!==t){this._idPatterns.indexOf(t)>-1&&(e=!0)}return e},r.prototype.getOrCreateIdPattern=function(t,e,i){let r=void 0;return void 0!==t&&void 0!==e&&void 0!==i&&void 0===(r=this.getIdPattern(t,e,i))&&(r=new o(t,e,i),this._idPatterns.push(r)),r},r.prototype.getObject=function(t,e,i){let o=void 0,r=this.getNameSpace(t);if(void 0!==r){let t=r.getObjects(e,i);t.length&&(o=t[0])}return o},r.prototype.createObject=function(t,e,i){let o=void 0,r=this.getNameSpace(t);return void 0!==r&&(o=r.createObject(e,i)),o},r.prototype.getOrCreateObject=function(t,e,i){let o=void 0,r=this.getNameSpace(t);return void 0!==r&&(o=r.getOrCreateObject(e,i)),o},r.prototype.getDualObject=function(t,e,i){let o=void 0,r=this.getTreeKeysFromViewType(t),n=0,a=r.length;for(n=0;n<a&&void 0===o;n++){let t=r[n],a=this.getNameSpace(t);if(void 0!==a){let t=a.getObjects(e,i);void 0!==t&&1===t.length&&(o=t[0])}}return o},r.prototype.getNameSpace=function(t){let e=void 0,i=0,o=this._nameSpaces.length,r=t.getNameSpaceId();for(i=0;i<o&&void 0===e;i++){let o=this._nameSpaces[i];o.isNameSpaceOfTreeKey(t)?e=o:o._uuid===r&&(e=o).addTreeKey(t)}return e},r.prototype.createNameSpace=function(e){let i=new t(e,this);return this._nameSpaces.push(i),i},r.prototype.getOrCreateNameSpace=function(t){let e=void 0;if(void 0===(e=this.getNameSpace(t))){t.getNameSpaceId().length>0&&(e=this.createNameSpace(t.getNameSpaceId())).addTreeKey(t)}return e},r.prototype.removeNameSpace=function(t){let e=this._nameSpaces.indexOf(t);e>-1&&this._nameSpaces.splice(e,1)},r.prototype.getErrorManager=function(){return Object.keys(this._errorManager).length?this._errorManager:(this._errorManager=new i,this._errorManager)},r});