define("DS/DELPPWAltSubModule/ReplaceByAlternateDialog",["UWA/Core"],function(e){"use strict";return function(t,n,i){const l=0,o=1,r=2;let a;const c=function(){let e=!1,t=!1,n=!1;if((e=>Array.isArray(e)&&e.length>0)(a.value))switch(a.value[0]){case l:e=!1,t=!1,n=!1;break;case o:e=!0,t=!0,n=!1;break;case r:e=!0,t=!1,n=!0}return{isReplaceAll:e,restrictToUnderSameParent:t,replaceAllInstances:n}},s=function(s){let u=e.createElement("div",{class:"replaceByAlternateOptions-container",styles:{padding:"10px 5px"}});(a=function(t){const a=(e=!1)=>n.create("Toggle",{type:"radio",label:i.getNLSValue("AltSub.ReplaceDialog.ReplaceSelected"),value:l,checkFlag:e}),c=(e=!1)=>n.create("Toggle",{type:"radio",label:i.getNLSValue("AltSub.ReplaceDialog.RestrictToSameParent"),value:o,checkFlag:e}),s=(...e)=>{let t=n.create("ButtonGroup",{type:"radio"});for(const n of e)t.addChild(n);return t};return(t=>e.is(t)&&"instance"===t.type)(t)||(t=>!e.is(t))(t)?s(a(!0),c(),((e=!1)=>n.create("Toggle",{type:"radio",label:i.getNLSValue("AltSub.ReplaceDialog.ReplaceAllInstances"),value:r,checkFlag:e}))()):s(a(!0),c())}(t)).inject(u);let d=e.createElement("div",{class:"replaceByAlternateOptions-content-container"});u.inject(d),function(t,l){let o=n.create("Dialog",{title:i.getNLSValue("AltSub.ReplaceDialog.Title"),domId:"replaceByAlternateOptionsDialog",identifier:"replaceByAlternateOptionsDialog",content:t,minHeight:150,minWidth:400,modalFlag:!0,resizableFlag:!0,buttons:{Cancel:n.create("Button",{onClick:function(){o.close()}}),Ok:n.create("Button",{emphasize:"primary",onClick:function(){if(e.is(l,"function")){const e=c();l(e)}o.close()}})}});o.close=function(){this.destroy()}}(d,s)};return{show:function(e){s(e)}}}}),define("DS/DELPPWAltSubModule/AltSubViewUI",["UWA/Core","DS/Utilities/Dom"],function(e,t){"use strict";return function(n,i,l,o,r){var a,c,s,u,d,g=o.getComponent("WUXDockAreaEnum"),f=o.getComponent("WUXFrameWindowsManager").getFrameWindow(n.getAppContext()).getImmersiveFrame();return a=function(t){var a=n.getElement(),f=o.createElement("div",{class:"tree-list-container"}),m=e.is(r)?r.getIconURLFromKey(t):"";u=r.getNLSValue("View.AlternatesAndSubstitutes.Title"),(d=e.createElement("div")).className="context-product-title",d.setAttribute("id","context-product-title"),d.setStyles({left:"10px",position:"relative",width:"fit-content"}),f.inject(a),i.loadDocument(l.getWUXNodeModel()),i.getContent().inject(f),(c=o.create("Panel",{header:d,position:{at:"right"},minWidth:300,minHeight:250,height:250,title:r.getNLSValue("View.AlternatesAndSubstitutes.Title"),icon:m,side:g.RightDockArea,currentDockArea:g.RightDockArea,identifier:"panel-"+s,content:a,resizableFlag:!0,closeButtonFlag:!0,useBordersFlag:!0,visibleFlag:!1,collapsibleFlag:!0,verticallyStretchableFlag:!1})).close=function(){e.is(s)?n.notify("toggleCmdCheckHeaderState",{cmdName:s,cmdState:!1}):c.hide()}},{init:function(t,i){e.is(t,"string")?(s=t,a(i)):n.debug("AltSubViewUI","Command name is not defined to create UI.")},destroy:function(){l.emptyNodeModel(),e.is(c)&&(c.destroy(),c=void 0)},toggle:function(t){var n;t.state&&!c.visibleFlag?(c.immersiveFrame=f,n=f.getDockingElement(c.currentDockArea),e.is(n)&&(n.collapseDockingZoneFlag=!1),c.show()):c.hide()},updateTitle:function(t){var n=e.is(t,"string")?t:null;e.is(n)&&""!==n?c.title=u+" - "+n:c.title=u},setContextProductTitle:function(n,i){var l,o=e.createElement("div"),r=e.createElement("div"),a=e.is(i,"string")?i:null;o.className="title-base",o.setStyles({display:"flex","align-items":"center",height:"22px"}),r.className="title-text",r.setStyles({"padding-left":"10px"}),e.is(a)&&((l=t.generateIcon({iconPath:a,iconSize:{width:"22px",height:"22px"}})).className="title-icon",l.inject(o)),r.setContent(n),r.inject(o),d.setContent(o)},launchMfgItemCreateCmd:function(t,n,i){var l,a,c,s,u,d,g,f=t.arguments,m={},p=function(){e.is(l)&&(l.isVisible()&&l.destroyUI(),l=void 0)};p(),Array.isArray(f)&&(f.forEach(function(t){e.is(t)&&e.is(t.ID,"string")&&e.is(t.Value,"string")&&("ReferenceType"===t.ID?a=t.Value:"LinkType"===t.ID&&(c=t.Value))}),e.is(a)&&e.is(c)&&(d=a.split("/"),g=null,2===d.length&&(g=d[1]),s=g,m.cmdId="CreateMfgItemAndScope",m.onOKCallBack=function(e){var t=r.getNLSValue(m.cmdTitle,{type:r.getNLSValue(s||"",null,"Type")});i(e,c,t),p()},m.onCancelCallback=function(){p()},m.newObjType=a,m.isInstancePossible=null,m.cmdTitle=n(c),m.implementingSection=!1,m.implementedSection=!0,m.optionsSection=!1,m.checkForImplementingScope=!1,m.modalFlag=!0,m.multiSelectionOfImplementing=!1,m.multiSelectionOfImplemented=!1,l=o.create("ImplementUI",m),!0===(u=l.getSelectionsWithPaths()).bUpdateImplemented&&(l.updateImplemented(u.selNodes),l.showDCFormForCreate())))}}}}),define("DS/DELPPWAltSubModule/AltSubModule",["UWA/Core","DS/DELPPWAltSubModule/AltSubViewUI","DS/DELPPWAltSubModule/ReplaceByAlternateDialog"],function(e,t,n){"use strict";var i=function(){var t=null;return{of:function(e){return t=e,this},combineWith:function(n){return e.extend(t,n,!0),this},get:function(){return t}}};return{behaviors:["TreeListViewBehavior","WUXNodeModelBehavior","AssignProductBehavior","UXFactoryBehavior","ModelBehavior","SelectionBehavior","ResourceBehavior","AltSubBehavior"],creator:function(l,o,r,a,c,s,u,d,g){var f,m,p,S,A,b,h,y,v,I,R,C,T,N,L,M={STATUS:"AltSub_status",ENG_RELATION:"AltSub_engRelation",CONTEXT:"AltSub_context"},D="AltSub_mfgItem",P="AltSub_mfgRev",U="AltSub_relType",k="AltSub_org",x=g.getLinkTypeEnum(),E=!1,F=null,O=null;return p=function(e){return e.isReference()?e.get("V_Name"):e.get("PLM_ExternalID")},S=function(e){var t="";return e.isReference()&&(t=e.get("revision")),t},A=function(e){var t="";return t=p(e),e.isReference()&&(t+=" "+S(e)),t},b=function(t){var n=t||{},i=e.is(n.status)?n.status:null,l=e.is(n.referenceModel)?n.referenceModel:null,o=e.is(n.instanceModel)?n.instanceModel:null,r="",a=null;e.is(i,"string")?"loading"===i?r=d.getNLSValue("loading"):"noSelection"===i&&(r=d.getNLSValue("AltSub.NoSelection")):e.is(l)||e.is(o)?(e.is(l)&&(r+=A(l),a=d.getIconURLFromKey(l.get("type"))),e.is(o)&&(r+=" ( "+A(o)+" )")):r=d.getNLSValue("AltSub.NoContextProduct"),m.setContextProductTitle(r,a)},h=function(){var t,n,i,o,a=u.getSelectionsWithPaths();E||(O=null,r.emptyNodeModel(),b({status:"loading"}),Array.isArray(a)&&a.length>1&&1===a[1].length?(o=a[1][0],e.is(o)?(t=s.getReferenceModel(o.id),F=t.get("PID"),m.updateTitle(p(t)),i=o.path,n=o.path.length>0?o.id:null,g.getEnggAlternatesAndMfgs(t.get("PID"),n,i,function(t){var o,a,c,s=t.mfgReferenceId;e.is(F)&&s===F&&(o=t.results,a=t.contextLinkNavigated,b({referenceModel:t.contextProductModel.reference,instanceModel:t.contextProductModel.instance}),Array.isArray(o)&&o.length>0&&(c=0===i.length,r.prepareUpdate(),o.forEach(function(e){I(e,a,c)}),r.pushUpdate()),O=n,l.notify("AltSubViewLoaded"))})):l.debug("No selection in mbom to load AlternateAndSubstitutes view data.")):(F=null,m.updateTitle(""),b({status:"noSelection"})))},y=function(t,n,i,l,o,r){return{label:A(t),grid:{[M.STATUS]:n,[M.ENG_RELATION]:i,[M.CONTEXT]:e.is(o)?A(o):""},restrictLinkCreation:r,substitute:(t=>{let n=null;return e.is(t)&&(n={type:t.isInstance()?"instance":"reference",context:t.get("PID")}),n})(o),engRelType:l}},v=function(t,n,i,l){return e.is(t)?{isContextMfgRoot:l,mfgReferenceId:t.get("PID"),mfgRelType:i,grid:{[D]:p(t),[P]:S(t),[U]:n,[k]:t.get("organization"),cellInfo:{IconUrl:d.getIconURLFromKey(t.get("type"))}}}:{isContextMfgRoot:l,grid:{[D]:"",cellInfo:{IconUrl:null}}}},I=function(t,n,l){var a,c,s,u,d,g,f=t.eng,m=t.mfg,p=new i;c=f.referenceModel,s=m.referenceModel,g=f.isContextProduct?n:null,u=y(c,f.status,f.engRelTypeNLS,f.engRelType,f.substituteContextModel,g),d=e.is(s)?v(s,m.mfgRelTypeNLS,m.mfgRelType,l):v(null),a=p.of(o.getReferenceNodeOptions(c)).combineWith(u).combineWith(d).get(),r.addNodeModel(a)},R=function(e){var t,n=e.options,i=n.grid;return t=Object.keys(M).reduce(function(e,t){var n=M[t];return e[n]=i[n],e},{}),{label:n.label,grid:t,restrictLinkCreation:n.restrictLinkCreation,substitute:n.substitute,engRelType:n.engRelType}},C=function(t,n,l){var a,c,s,u,g=r.getSelectedNodes();1===g.length&&(a=g[0],s=v(t,d.getNLSValue("AltSub.Link."+l),l),e.is(a.options.mfgReferenceId)?(c=R(a),u=(new i).of(o.getReferenceNodeOptions(n)).combineWith(c).combineWith(s).get(),r.addNodeModel(u)):a.updateOptions(s))},T=function(e){m.launchMfgItemCreateCmd(e,function(e){return e===x.RESULTING_PRODUCT?"ImplementUI.CreateImplementingAndResultingProduct":"ImplementUI.CreateImplementingAndScope"},function(e,t,n){var i=d.getNLSValue("AltSub.CreatingMfgItem"),l=e.securityContextOverride,o=e.implementedIDs,r=e.newObjAttributes;E=!0,f.displayModalLoader(i,function(){var e=function(e){var n;1===e.length&&(n=e[0],C(n.createdObject,n.toObject,t)),f.removeModalLoader(i),E=!1},c=function(){f.removeModalLoader(i),E=!1};t===x.SCOPE?a.createMfgItemAndScopeLink(o,r,n,{onComplete:e,onFailure:c,securityContextOverride:l}):t===x.RESULTING_PRODUCT&&a.createMfgItemAndResultingProductLink(o,r,n,{onComplete:e,onFailure:c,securityContextOverride:l})})})},N=function(){var t,n=r.getSelectedNodes();1===n.length&&(t=n[0].options.mfgReferenceId,e.is(t)&&l.notify("addReference",[s.getReference(t),null,{withLinksResolved:!0}]))},L=function(){const t=O;if(e.is(t)){const i=r.getSelectedNodes();if(1===i.length){const o=i[0],r=o.options.mfgReferenceId,a=o.options.substitute;e.is(r)&&new n(a,c,d).show(function(e){l.notify("doReplaceByMfgAlternate",[t,r,e,a])})}}},{listenTo:function(){return{select:h,CreateMfgItemAndLinkAltSubst:T,AddMfgItemToMBOMAltSub:N,ReplaceByAlternate:L}},onStart:function(e){var n,i,a=e||{};n=a.relatedCmdId,i=a.moduleIcon,(m=new t(l,o,r,c,d)).init(n,i),f=o.getDataGridView(),m.toggle({state:!0}),h()},onStop:function(){E=!1,e.is(m)&&(m.destroy(),m=void 0),F=null}}}}});