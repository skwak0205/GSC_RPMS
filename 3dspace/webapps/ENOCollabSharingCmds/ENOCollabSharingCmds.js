define("DS/ENOCollabSharingCmds/Services/CommandServices",["DS/LifecycleServices/LifecycleServices"],function(e){"use strict";return{TYPE_ROOT_FOLDER_1:"Workspace",TYPE_ROOT_FOLDER_2:"RootFolder",TYPE_FOLDER_1:"Workspace Vault",TYPE_FOLDER_2:"Folder",TYPE_FOLDER_3:"Workspace Folder",TYPE_PERSONAL_FOLDER_1:"Personal Workspace",TYPE_MATERIALS:"dsc_mat",TYPE_MATERIAL_DOMAIN_REP:"dsc_matref_rep",TYPE_MATERIAL_DOMAIN_REP_1:"MaterialDomainDS",TYPE_MATERIAL_DOMAIN_REP_2:"ENOSTMatDomainDS",TYPE_MATERIAL_DOMAIN_REP_3:"MaterialDomain",TYPE_MATERIAL_REFERENCE:"dsc_matref_ref_",isRootFolder:function(e){return e===this.TYPE_ROOT_FOLDER_1||e===this.TYPE_ROOT_FOLDER_2},isFolder:function(e){return e===this.TYPE_FOLDER_1||e===this.TYPE_FOLDER_2||e===this.TYPE_FOLDER_3},isPersonalFolder:function(e){return e===this.TYPE_PERSONAL_FOLDER_1},isWorkspaceFolder:function(e){return e===this.TYPE_ROOT_FOLDER_1||e===this.TYPE_FOLDER_1},inFamilyFolder:function(e){return this.isRootFolder(e)||this.isFolder(e)||this.isPersonalFolder(e)},isMaterialDomain:function(e){if("string"==typeof e||e instanceof String){var t=!1;return-1!=e.search(new RegExp(this.TYPE_MATERIAL_DOMAIN_REP,"i"))?t=!0:-1!=e.search(new RegExp(this.TYPE_MATERIAL_DOMAIN_REP_1,"i"))?t=!0:-1!=e.search(new RegExp(this.TYPE_MATERIAL_DOMAIN_REP_2,"i"))?t=!0:-1!=e.search(new RegExp(this.TYPE_MATERIAL_DOMAIN_REP_3,"i"))?t=!0:(-1!=e.search(new RegExp(this.TYPE_MATERIALS,"i"))&&(t=!0,0==e.search(new RegExp(this.TYPE_MATERIAL_REFERENCE,"i"))&&(t=!1)),t)}return-1},allAggregated3DShape:function(t,n){for(var i=t.length,a=[],o=0;o<i;o++){var r=t[o],s=r.type,l=r.getID();if(a.push(l),"3DShape"!=s)return void n(!1)}var c=widget.getValue("x3dPlatformId");e.listAttributes(c,a,["attribute[PLMEntity.V_usage]"],function(e){for(var t=!0,i=e.results.length,a=0;a<i;a++){if("3DPart"!=e.results[a]["attribute[PLMEntity.V_usage]"]){t=!1;break}}n(t)},function(e){console.log(e),n(!1)})}}}),define("DS/ENOCollabSharingCmds/BaseModels/ResultElement",["UWA/Controls/Abstract"],function(e){"use strict";return e.extend({init:function(e){for(var t in this.CategoryRelation="RelationClass",this.CategoryObj="Class",this.CategoryEBOM="EBOM",this.CategoryRelationM1="rel",this.CategoryObjM1="bus",this.MetatypeRel="relationship",this.MetatypeBus="businessobject",this.MetatypeEBOM="EBOM",this.urlIcon="",this.project="",this.org="",this.physicalId="",this.owner="",this.title="",this.name="",this.id="",this.type="",this.children=[],this.category="",this.serverUri="",this.serverHost="",this.isResultElement=!0,e)this[t]=e[t]},getUrlIcon:function(){return this.urlIcon},getProject:function(){return this.project},getOrganization:function(){return this.org},getPhysicalId:function(){return this.physicalId},getOwner:function(){return this.owner},getTitle:function(){return this.title},getLabel:function(){return this.getTitle()},getName:function(){return this.name},getId:function(){return this.id},getID:function(){return this.getPhysicalId()},getChildren:function(){return this.children},getCategory:function(){return this.category},getCategoryM1:function(){return this.getCategory()===this.CategoryRelation?this.CategoryRelationM1:this.getCategory()===this.CategoryObj?this.CategoryObjM1:""},getMetatype:function(){return this.getCategory()===this.CategoryRelation?this.MetatypeRel:this.getCategory()===this.CategoryEBOM?this.MetatypeEBOM:this.MetatypeBus},getType:function(){return this.type},getServerHost:function(){return this.serverHost},getServerUri:function(){return this.serverUri},setUrlIcon:function(e){this.urlIcon=e},setProject:function(e){this.project=e},setOrganization:function(e){this.org=e},setPhysicalId:function(e){this.physicalId=e},setOwner:function(e){this.owner=e},setTitle:function(e){this.title=e},setName:function(e){this.name=e},setId:function(e){this.id=e},setChildren:function(e){this.children=e},setCategory:function(e){this.category=e},setType:function(e){this.type=e},setServerHost:function(e){this.serverHost=e},setServerUri:function(e){this.serverUri=e}})}),define("DS/ENOCollabSharingCmds/commands/Notification/Notification",["UWA/Core","DS/WebappsUtils/Console","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],function(e,t,n,i){"use strict";var a={notificationsManager:null,display:function(e){null===a.notificationsManager&&(a.notificationsManager=n,i.setNotificationManager(a.notificationsManager),i.setStackingPolicy(9));var t={level:e.level,title:e.title,subtitle:e.subtitle,message:e.message?e.message:"",sticky:"error"===e.level};a.notificationsManager.addNotif(t)}};return a}),define("DS/ENOCollabSharingCmds/commands/EditPropCmd/EditPropCmdBase",["UWA/Class","DS/LifecycleControls/EditPropDialog"],function(e,t){"use strict";return t.extend({})}),define("DS/ENOCollabSharingCmds/commands/NewCmd/AttributesPanel",["DS/UIKIT/SuperModal","DS/UIKIT/Form","DS/UIKIT/Input/Button","DS/UIKIT/Input/Text","DS/ENOFloatingPanel/ENOFloatingPanel","DS/EditPropWidget/facets/Properties/Properties","DS/EditPropWidget/models/EditPropAttributeModel","DS/EditPropWidget/models/EditPropModel","DS/EditPropWidget/utils/AttributesUtils","UWA/Class/Promise","DS/UIKIT/Tooltip","i18n!DS/UIKIT/assets/nls/UIKIT","i18n!DS/ENOCollabSharingCmds/assets/nls/AttributesPanelNls"],function(e,t,n,i,a,o,r,s,l,c,d,u,p){"use strict";var f,g,h,m,v;return a.extend({init:function(e){this._parent(e);var t=widget.getValue("report_dlg_size");null==t&&(t='{ "width":580, "height":280 }'),this.setNewSize(JSON.parse(t)),f=widget.preferences[0].options},destroy:function(){var e=this.getModalBodySize();e.height=this.getContainerHeight();var t="report_dlg_size";widget.getValue(t)||widget.addPreference({name:t,type:"hidden",defaultValue:"{}"}),widget.setValue(t,JSON.stringify(e)),this._parent()},displayPanel:function(){var i=this,a=!0;this.addEvent("onClose",function(){a=!0,F(null)});var u,C,S,y,b=arguments,D=(b[0],b[1],b[2]),E=b[3],N=b[4],_=b[5],A=b[6],P=b[7],T=b[8],w=b[9],O=b[10],I=b[11],x=b[12],M=[],U=T,R=!1,W=null,V=null!=w&&w.length>2;function F(e,t,n,i,o){if(u.preventEvent=!0,a&&u.destroy(),a=!0,null!=n){var r=JSON.parse(n);if(r.length>0){var s=r[0],l=i.getChangedValues();for(var c in l){var d=i.get(c);if("object"==typeof d&&!d.isTransient){var p=d.name,f=d.valueDB;Object.keys(s).forEach(function(e){if("attributes"==e)for(var t=s[e],n=t.length,i=0;i<n;i++){var a=t[i];if(a.hasOwnProperty("name"))if(a.name==p)if(a.hasOwnProperty("modifiedattribute")&&r[0].attributes[i].value!==f&&(r[0].attributes[i].modifiedattribute=!0),a.hasOwnProperty("value")&&(r[0].attributes[i].value=f),a.hasOwnProperty("type"))"Double"==a.type&&(r[0].attributes[i].type="Real")}})}}}n=JSON.stringify(r)}if(UWA.is(O,"function")){var g=u.isVisible,h=null,m=null;if(null!=i){h=i.get("V_Name").get("value");var v=i.get("internalfilemane");m=null!=v?v.get("value"):null}O(e,h,t,m,n,g,o)}}function L(e,t){z(e).then(function(e){return e}).then(function(e){e&&"function"==typeof e.getInvalidCharInTitle&&e.getInvalidCharInTitle(type).then(function(e){i.invalidCharinTitle=e;var n=t.get("V_Name");if(null!=n){var a=new r(n);a.set("forbiddenChar",invalidCharinTitle),t.set(a.getIdentifier(),a)}})}).catch(function(e){i.invalidCharinTitle=null})}function B(e,t,n){var a=e.getValue("input_select"),o=t.get("internalfilemane");new r(o);if(_)if("V6"==a)i.showfilename=!1;else{if(null!=A&&null!=a){var s=a;s=s.substring(0,5);var l=JSON.parse(A),c=!1;Object.keys(l).forEach(function(e){s==e&&(l[e].hasOwnProperty("filenameStatus")&&"TRUE"==l[e].filenameStatus&&(c=!0))})}i.showfilename=!!c}else i.showfilename=!1;i.showfilename;var d=j(n),p=m.getField("input_select").selectedOptions[0].value;if("V6"!==p)for(var f=0;null!=n.elements.formSection.elements._organizers[y].elements.container.childNodes[0].childNodes[1].childNodes[f];){var g=n.elements.formSection.elements._organizers[y].elements.container.childNodes[0].childNodes[1].childNodes[f];if((h=n.elements.formSection.elements._organizers[y].elements.container.childNodes[0].childNodes[1].childNodes[f].childNodes[0].childNodes[0].childNodes[0])&&h.hasChildNodes()&&h.childNodes[0].childNodes[0].hasAttribute("name")&&"3DPartTemplate"===h.childNodes[0].childNodes[0].attributes.name.nodeValue){h.hide(),g.hide();n.elements.formSection.elements._organizers[y].elements.container.childNodes[0].childNodes[1].childNodes[f].childNodes[0].childNodes[0];u.elements.footer.childNodes[3].disabled=!0;break}f++}else if("V6"==p)for(f=0;null!=n.elements.formSection.elements._organizers[y].elements.container.childNodes[0].childNodes[1].childNodes[f];){var h,v=n.elements.formSection.elements._organizers[y].elements.container.childNodes[0].childNodes[1].childNodes[f];if((h=n.elements.formSection.elements._organizers[y].elements.container.childNodes[0].childNodes[1].childNodes[f].childNodes[0].childNodes[0].childNodes[0])&&h.hasChildNodes()&&h.childNodes[0].childNodes[0].hasAttribute("name")&&"3DPartTemplate"===h.childNodes[0].childNodes[0].attributes.name.nodeValue){h.style.display="",n.elements.formSection.elements._organizers[y].elements.container.childNodes[0].childNodes[1].childNodes[f].childNodes[0].childNodes[0].style.display="",n.elements.formSection.elements._organizers[y].elements.container.childNodes[0].childNodes[1].childNodes[f].childNodes[0].childNodes[1].childNodes[0].style.display="",v.style.display="",u.elements.footer.childNodes[3].disabled=!1;break}f++}var C=H(t,null);n.initData([C]);var S=n.elements.formSection.elements._organizers[y].elements.container.childNodes[0].childNodes[1],b=n.elements.formSection.elements._organizers[y].elements.container.childNodes[0].childNodes[1].childNodes[0];for(f=0;f<d.length;f++)S.insertBefore(d[f],b);u.show();var D=n.elements.formSection.elements.accordion;D.items[0].elements.container.childNodes[0].hide();var E=D.items[1];E&&D.dispatchEvent("onChange",[E]),R=!1}function j(e){for(var t=0,n=[];null!=e.elements.formSection.elements._organizers[y].elements.container.childNodes[0].childNodes[1].childNodes[t];){var i=e.elements.formSection.elements._organizers[y].elements.container.childNodes[0].childNodes[1].childNodes[t],a=e.elements.formSection.elements._organizers[y].elements.container.childNodes[0].childNodes[1].childNodes[t].childNodes[0].childNodes[0].childNodes[0];a&&a.hasChildNodes()&&a.childNodes[0].childNodes[0].hasAttribute("name")&&"3DPartTemplate"===a.childNodes[0].childNodes[0].attributes.name.nodeValue&&n.push(i),a&&a.hasChildNodes()&&a.childNodes[0].childNodes[0].hasAttribute("name")&&"Type"===a.childNodes[0].childNodes[0].attributes.name.nodeValue&&n.push(i),a&&a.hasChildNodes()&&a.childNodes[0].childNodes[0].hasAttribute("name")&&"SecurityContext"===a.childNodes[0].childNodes[0].attributes.name.nodeValue&&n.push(i),a&&a.hasChildNodes()&&a.childNodes[0].childNodes[0].hasAttribute("name")&&"Template"===a.childNodes[0].childNodes[0].attributes.name.nodeValue&&n.push(i),t++}return n}function k(e){var t,n=e.getValue("input_select");return"V5"==n||-1!==n.indexOf("UPSV5")?t="CATIAV5":-1!==n.indexOf("UPSSW")?t="SOLIDWORKS":-1!==n.indexOf("UPSCR")?t="CREO":-1!==n.indexOf("UPSNX")?t="NX":-1!==n.indexOf("UPSNX")?t="NX":-1!==n.indexOf("UPSIV")?t="INVENTOR":-1!==n.indexOf("UPSAD")?t="AUTOCAD":-1!==n.indexOf("UPSSE")&&(t="SOLIDEDGE"),t}function z(e){return new c(function(t,n){var i=k(e);require(["DS/LifecycleServices/LifecycleServicesSettings"],function(e){e.getCADvalidityService(i).then(function(e){t(e)}).catch(function(e){n(e)})})})}function X(e,t,n){q(e,t,function(e){!function(e,t,n){var a=t.get("V_Name"),o=t.get("internalfilemane"),s=null,l=null;null!=a&&(s=a.get("value"));null!=o&&(l=o.get("value"));s!=l&&(i.modifyfilename=!1);(function(e){return new c(function(t,n){if(function(e){var t=!1,n=e.getValue("input_select");return"V5"!=n&&-1===n.indexOf("UPSV5")||(t=!0),t}(e)){var i=k(e);require(["DS/LifecycleServices/LifecycleServicesSettings"],function(e){e.getCADvalidityService(i).then(function(e){t(e)}).catch(function(e){n(e)})})}else n(null)})})(m).then(function(e){if(e&&"function"==typeof e.checkfilenameValidity)e.checkfilenameValidity(l,function(e){var i=!0;if(null!=e){var a=new r(o);a.setError(e,"error",!0),t.set(a.getIdentifier(),a),i=!1;var s={msg:e,eventID:"warning",customClass:"EP_Warning_"+a.name};$(s)}n(i)});else{n(!0)}}).catch(function(e){var i=t.get("internalfilemane"),a=new r(i);a.resetError(),t.set(a.getIdentifier(),a),n(!0)})}(0,t,function(i){var a=!0,o=[];o.push(t),l.validateModels(o)&&(a=!1),n(e&&i&&a)})})}function q(e,t,n){z(e).then(function(e){return e}).then(function(e){if(e&&"function"==typeof e.checktitleValidity){var i=null,a=JSON.parse(E);Object.keys(a).forEach(function(e){a[e].hasOwnProperty("DSType")&&(i=e)});var o=null,s=t.get("V_Name");null!=s&&(o=s.get("value")),e.checktitleValidity(i,o).then(function(e){n(!0)}).catch(function(e){if(null!=e){var i=new r(s);i.setError(e,"error",!0),t.set(i.getIdentifier(),i)}n(!1)})}else{n(!0)}}).catch(function(e){var i=t.get("V_Name"),a=new r(i);a.resetError(),t.set(a.getIdentifier(),a),n(!0)})}function H(e,t){var n=null;if(null!=e){var a={};if(null!=t){var o=JSON.parse(t),l=null;if(o.length>0)for(var c=o[0].interfaces,d=o[0].attributes,u=d.length,f=0;f<u;f++){var g=d[f],h=g.name,v=g.NLS,C=g.type,S=g.value,y=g.value,b=g.access,D=g.dimension,E=g.unitName,N=g.dimensionType,_=g.mandatory,A=g.multiline,P=g.maxlength,T=g.authorizedvalues,w=g.multivaluated,O=g.isdisplayed,I=g.associatedType;if(O){var x=C;if("String"===C)x="text";else if("Integer"===C)x="integer";else if("Real"===C)x="real";else if("Boolean"===C)x="boolean";else if("Date"===C){if(""!=S){var U=parseInt(S);y=K(new Date(U),!0).valueDB}x="timestamp"}var W=null,V=e.get(h);if(null!=V)(W=new r(V)).set("value",S),W.set("valueDB",y);else{if(W=new r({path:h,name:h,label:v,value:S,valueDB:y,type:x,readOnly:b}),null!=D&&(W.set("dimension",D),W.set("unitName",E),W.set("dimensionType",N)),null!=T&&null!=W){var F=[],B=[];for(var j in T)F.push(T[j].Name),B.push(T[j].NLS);W.set("authorizedValues",F),W.set("authorizedValuesNLS",B),W.set("authorizedValuesRequired",!0)}if(P>0&&W.set("maxlength",P),A&&W.set("multiline",A),_&&W.set("mandatory",_),w&&W.set("multivalue",w),I&&c){var k=c.indexOf(I);if(k>=0&&k<c.length){p.expandExtension&&p.expandExtension;W.set("facet","ExtensionsFacet")}}}null!=W&&(a[W.getIdentifier()]=W),"V_Name"==h&&(l=S,L(m,i.model))}}}else{var z=e.getAllAttributes(),X=e.getChangedValues();for(var j in z){if((q=z[j])instanceof r)"internalfilemane"!=(H=q.get("name"))&&(a[q.getIdentifier()]=q),"V_Name"==H&&(l=q.get("value"))}for(var j in X){var q,H;if((q=X[j])instanceof r)"internalfilemane"!=(H=q.get("name"))&&(a[q.getIdentifier()]=q),"V_Name"==H&&(l=q.get("value"))}L(m,i.model)}if(i.showfilename){var Y=null,J=e.get("internalfilemane");null!=J?((Y=new r(J)).set("value",l),Y.set("valueDB",l)):Y=new r({path:"internalfilemane",name:"internalfilemane",label:p.Filename,value:l,valueDB:l,type:"text",readOnly:!1}),null!=Y&&(a[Y.getIdentifier()]=Y)}X=null;null==t&&(X=e.getChangedValues(),n=new s,e=n,i.model=n),e.set(a),null!=X&&e.setChangedValues(X),e.addEvent("onChange",function(){var t=e._changed,n=0;for(var i in t){var a=e.get(i);if("object"==typeof a&&a.mandatory){a.getIdentifier();var o=a.value;if("undefined"===o||""==o){n=1;break}}}M.length>0&&M[0].setDisabled(n),M.length>1&&M[1].setDisabled(n)}),e.addEvent("onChange:V_Name",function(){if(!R){var t=e.get("internalfilemane"),n=e.get("V_Name");if(null!=t){var i=new r(t);i.set("value",n.get("value")),i.set("valueDB",n.get("valueDB")),e.set(i.getIdentifier(),i),R=!1}}}),e.addEvent("onChange:internalfilemane",function(){R=!0})}return n}function Y(e,t,n,i,a){var o=UWA.createElement("div",{class:"formLine s12 m12 l12"}),r=UWA.createElement("div",{class:"flexLine",styles:{width:"100%","z-index":i}}).inject(o),s=UWA.createElement("div",{class:"formLabel s12",styles:{"padding-top":"10px"}}).inject(r),l=UWA.createElement("div",{class:"attrLabel"}).inject(s),c=UWA.createElement("span",{class:"textContainer"}).inject(l),u=UWA.createElement("span",{text:e,name:n}).inject(c);new d({position:"left top",target:u,body:e});var p=UWA.createElement("div",{class:"formValue s12",styles:{width:"100%",display:"flex","flex-direction":"column","padding-left":"10px","padding-right":"1px","z-index":i,overflow:"visible","min-width":a}}).inject(r);if(V){var f=m.getField("input_select").selectedOptions[0].value;null!==ee&&null!=f&&"V6"!==f&&s&&s.hasChildNodes()&&s.childNodes[0].childNodes[0].childNodes[0].hasAttribute("name")&&"3DPartTemplate"===s.childNodes[0].childNodes[0].childNodes[0].attributes.name.nodeValue&&s.hide()}return t.inject(p),o}function J(){var e,t;null!=m&&(e=m.getValues("input_select").input_select,localStorage.setItem("CADOriginPSECreate",e));null!=h&&(t=h.getValues("input_types").input_types);if(null!=t&&null!=t||(t=ne[0].value),null!=g){var n=g.getValues("input_selectcontext").input_selectcontext;localStorage.setItem("selectedsecuritycontext",n)}F(t,e,U,i.model,null)}function K(e,t){if(!e)return{value:"",valueDB:""};var n=t?e:new Date,i=e.getUTCFullYear(),a=e.getUTCMonth()+1,o=e.getUTCDate(),r=n.getUTCHours(),s=n.getUTCMinutes(),l=n.getUTCSeconds();return a<10&&(a="0"+a),o<10&&(o="0"+o),r<10&&(r="0"+r),s<10&&(s="0"+s),l<10&&(l="0"+l),n.setYear(i),n.setMonth(e.getMonth()),n.setDate(o),{value:n.toLocaleString(widget.lang),valueDB:i+"/"+a+"/"+o+"@"+r+":"+s+":"+l+":GMT"}}function G(e,t,n){var i=[];if(null!=n){var a=JSON.parse(n);Object.keys(a).forEach(function(e){if(a[e].type===t){var n=a[e].current,o=a[e].templates;Object.keys(o).forEach(function(e){var t=o[e].name,a=!1;o[e].physicalid===n&&(a=!0);var r={value:t,selected:a};i.push(r)})}})}if(null!=v){var o=v.getAutocompleteInput("input_partTemplates");if(null!=o){o.removeDataset("all3Dparttemplates");var r={name:"all3Dparttemplates",items:i};o.addDataset(r)}}}function $(e){var t=e.msg,n=e.eventID,i=e.customClass;switch(n){case"error":(function(e,t){Q(function(n){var i=n.addError(e,t);u.dispatchEvent("onNotification",i)})})(t=t||e.json,i);break;case"warning":!function(e,t){Q(function(n){var i=n.addWarning(e,t);u.dispatchEvent("onNotification",i)})}(t,i);break;case"success":!function(e,t){Q(function(n){var i=n.addSuccess(e,t);u.dispatchEvent("onNotification",i)})}(t,i);break;default:!function(e,t){Q(function(n){var i=n.addInfo(e,t);u.dispatchEvent("onNotification",i)})}(t,i)}}function Q(e){W?e.call(null,W):require(["DS/ErrorWidget/ErrorWidget"],function(t){W||(W=new t(widget,u.elements.container,{className:"newcontent_errorManager"})),e.call(null,W)})}widget.removeEvent("CREATIONDONE"),widget.addEvent("CREATIONDONE",function(e){if(u.isVisible&&(U=e,C=new s,i.model=C,C)){var t=j(S);S.setAccordionProperties({ExtensionsFacet:{name:"ExtensionsFacet",nameNLS:"Extensions",weight:-10}}),H(C,e),S.initData([C]),y=S.elements.formSection.elements.accordion.items[0].name;for(var n=S.elements.formSection.elements._organizers[y].elements.container.childNodes[0].childNodes[1],a=S.elements.formSection.elements._organizers[y].elements.container.childNodes[0].childNodes[1].childNodes[0],o=0;o<t.length;o++)n.insertBefore(t[o],a);u.show();var r=S.elements.formSection.elements.accordion;r.items[0].elements.container.childNodes[0].hide();var l=r.items[1];l&&r.dispatchEvent("onChange",[l]),R=!1,C.clearChangedValue()}var c=p.CreateButton;M[1].load(!1,c)}),UWA.is(b[0],"object")&&(b[0].message,b[0].title,N=b[0].fields,O=b[0].callback,I=b[0].okButtonText,x=b[0].koButtonText);var Z=localStorage.getItem("CADOriginPSECreate"),ee=Z;null!==ee&&"V6"!==ee&&(ee=ee.substring(0,5));var te=i.labelSort(N,ee),ne=[];if(null!=E){var ie=D,ae=!1,oe=JSON.parse(E);Object.keys(oe).forEach(function(e){ae=!1,null===ie&&oe[e].hasOwnProperty("DSType")&&(ae=!0),ie===e&&(ae=!0);var t={label:oe[e].nlsname,value:e,selected:ae};ne.push(t)})}ne.sort(function(e,t){var n=e.label.toLowerCase(),i=t.label.toLowerCase();return n.localeCompare(i)});var re=[];if(void 0!==f)for(var se=0;se<f.length;se++){var le=f[se].value;if(le===widget.environment.data._data._x_pad_security_ctx||le===widget.environment.data._data._x_SC){var ce={label:f[se].label,value:f[se].value,selected:!0};re.push(ce)}else{ce={label:f[se].label,value:f[se].value,selected:!1};re.push(ce)}}u=this;var de,ue,pe,fe,ge,he=[],me=[],ve=[],Ce=[],Se=(p.Template,p.Title,p.Filename,p.Type,p.TitlePlaceHolder);p.FilenamePlaceHolder;if(i.modifyfilename=!0,i.filenamevalidated=!0,"V6"==Z&&(i.showfilename=!1),_||(i.showfilename=!1),ne.length>1&&(he.push({type:"select",name:"input_types",label:" ",options:ne,events:{onChange:function(e){if(UWA.is(O,"function")){var t=h.getValue("input_types");G(0,t,w),O(t,null,null,null,null,!0)}}}}),h=new t({className:"horizontal",fields:he,events:{onSubmit:function(e){}}}),this.TypeForm=h,h.elements.container.childNodes[0].childNodes[0].remove(),h.elements.container.getElementsByClassName("col-sm-10")[0].style.width="100%",h.elements.container.childNodes[0].style.marginBottom="1px"),ve.push({type:"select",name:"input_select",label:" ",options:te,events:{onChange:function(e){_&&B(m,i.model,i.propUI),L(m,i.model)}}}),m=new t({className:"horizontal",fields:ve,events:{onSubmit:function(e){}}}),this.templateForm=m,m.elements.container.childNodes[0].childNodes[0].remove(),m.elements.container.getElementsByClassName("col-sm-10")[0].style.width="100%",m.elements.container.childNodes[0].style.marginBottom="1px",V){p.partTemplate,Se=p.partTemplatePlaceHolder;Ce.push({type:"autocomplete",name:"input_partTemplates",label:" ",placeholder:Se,showSuggestsOnFocus:!0}),v=new t({className:"horizontal",fields:Ce,events:{onSubmit:function(e){}}}),this.PartTemplateForm=v,v.elements.container.childNodes[0].childNodes[0].remove(),v.elements.container.getElementsByClassName("col-sm-10")[0].style.width="100%",v.elements.container.childNodes[0].style.marginBottom="1px"}if(re.length>1&&(me.push({type:"select",name:"input_selectcontext",label:" ",options:re,events:{onChange:function(e){}}}),g=new t({className:"horizontal",fields:me,events:{onSubmit:function(e){}}}),this.credentialForm=g,g.elements.container.childNodes[0].childNodes[0].remove(),g.elements.container.getElementsByClassName("col-sm-10")[0].style.width="100%",g.elements.container.childNodes[0].style.marginBottom="1px"),null!=h&&(de=h.getValue("input_types")),null!=de&&null!=de||(de="VPMReference"),V){var ye=m.getField("input_select").selectedOptions[0].value;null!==ee&&null!=ye&&"V6"!==ye&&v.hide(),G(0,de,w)}var be=[];ne.length>1&&(ue=Y(p.Type,h,"Type",1103,"1px"),be.push(ue)),fe=Y(p.Template,m,"Template",1102,"1px"),be.push(fe),V&&(ge=Y(p.partTemplate,v,"3DPartTemplate",1101,"1px"),be.push(ge)),re.length>1&&(pe=Y(p.credential,g,"SecurityContext",1100,"1px"),be.push(pe)),S=new o({setCloseButton:!1,editMode:!0,readOnly:!1,scroller:!1,events:{onCancel:function(){this.destroy()},onNotification:function(e){$(e)}}}),this.propUI=S,C=new s,this.model=C;S.setAccordionProperties({ExtensionsFacet:{name:"ExtensionsFacet",nameNLS:"Extensions",weight:-10}}),H(C,T),S.initData([C]),C.clearChangedValue(),S.elements.container.setStyle("height","100%"),y=S.elements.formSection.elements.accordion.items[0].name,i.showfilename||B(m,i.model,i.propUI),q(m,i.model,function(e){});var De=S.elements.formSection.elements.accordion;De.items[0].elements.container.childNodes[0].hide();var Ee=De.items[1];Ee&&(De.addEvent("onChange",function(e){if("ExtensionsFacet"===e.name){var t=e.isSelected?p.collapseExtension:p.expandExtension;e.title.getElement("span").setText(t)}}),De.dispatchEvent("onChange",[Ee])),this.Attrcontainer=UWA.createElement("div",{class:"Attr_container","data-rec-id":"Attr_container_rec-id",styles:{width:"100%",height:"100%",display:"flex","overflow-y":"auto","overflow-x":"hidden","flex-direction":"column"}});ye=m.getField("input_select").selectedOptions[0].value;if(null!==ee&&null!=ye&&"V6"!==ye)for(var Ne=0;Ne<be.length;Ne++){if((Ae=(_e=be[Ne]).childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0])&&Ae.hasChildNodes()&&Ae.hasAttribute("name")&&"3DPartTemplate"===Ae.attributes.name.nodeValue){_e.style.display="none";break}}else for(Ne=0;Ne<be.length;Ne++){var _e,Ae;if((Ae=(_e=be[Ne]).childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0])&&Ae.hasChildNodes()&&Ae.hasAttribute("name")&&"3DPartTemplate"===Ae.attributes.name.nodeValue){_e.style.display="";break}}var Pe=S.elements.formSection.elements._organizers[y].elements.container.childNodes[0].childNodes[1],Te=S.elements.formSection.elements._organizers[y].elements.container.childNodes[0].childNodes[1].childNodes[0];for(se=0;se<be.length;se++)Pe.insertBefore(be[se],Te);""===Te.innerText&&Te.remove(),S.inject(this.Attrcontainer),u.elements.body.addContent(this.Attrcontainer),u.inject(widget.body),!UWA.is(O,"function")&&this.options.callback&&(O=this.options.callback);var we=p.CreateButton,Oe=p.CreateCloseButton,Ie=p.CloseButton,xe=p.SaveSettingsButton;M.push(new n({value:I||Oe,className:"primary"})),M[0].addEvent("onClick",function(){X(m,i.model,function(e){1==e&&(a=!0,J())})}),M.push(new n({value:I||we})),M[1].addEvent("onClick",function(){X(m,i.model,function(e){if(1==e){var t=p.CreatingButton;M.length&&null!=M[1]&&M[1].load(!0,t),a=!1,J()}})}),M.push(new n({value:x||Ie})),M[2].addEvent("onClick",function(){a=!0,F(null)}),P&&M[1].hide(),V&&(M.push(new n({value:x||xe})),M[3].addEvent("onClick",function(){var t=this,n="Physical Product";if(null!=h){var i=h.getField("input_types");n=null==i||null==i?"Physical Product":i.selectedOptions[0].label}new e({closable:!0,animate:!1,overlay:!0}).confirm({title:p.saveSettingsTitle,message:p.confirmsaveSettingsMsg+" "+n+" ?",callback:function(e){if(t.load(!0),e){var i;if(null!=h&&(i=h.getValue("input_types")),null!=i&&null!=i||(i="VPMReference"),null!=v)var o=v.getValue("input_partTemplates");var r=null;if(null!=w){var s=JSON.parse(w);Object.keys(s).forEach(function(e){if(s[e].type===i){s[e].current;var t=s[e].templates;Object.keys(t).forEach(function(e){t[e].name===o&&(r=t[e].physicalid)})}})}null!=r?($({msg:p.confirmsaveSuccessMsg+" "+n,eventID:"success"}),a=!1,F(i,null,null,null,r)):$({msg:p.confirmsaveErrorMsg+" "+n,eventID:"error"})}t.load(!1)}})})),u.setFooter(M);ye=m.getField("input_select").selectedOptions[0].value;V&&null!==ee&&null!=ye&&"V6"!==ye&&(u.elements.footer.childNodes[3].disabled=!0),u.show(),u.onResize(),u.dispatchEvent("onShowModal")},labelSort:function(e,t){for(var n=[],i=!1,a=[],o=0;o<e.length;o++)a.push(e[o].label);a.sort();for(var r=0;r<e.length;r++){var s="background-image: url("+e[r].icon+");background-repeat: no-repeat;background-position-y: center;white-space: pre;background-size: 20px;background-origin: content-box;",l=e[r].value,c=a.indexOf(e[r].label);if(l.startsWith(t)&&!i){var d={label:e[r].label,value:e[r].value,attributes:{style:s},group:e[r].Connector,selected:!0};n[c]=d,i=!0}else{d={label:e[r].label,value:e[r].value,attributes:{style:s},group:e[r].Connector};n[c]=d}}return n}})}),define("DS/ENOCollabSharingCmds/ENOCollabSharingCmds",[],function(){}),define("DS/ENOCollabSharingCmds/commands/NewCmd/Models/NewCommandResponse",["DS/PlatformAPI/PlatformAPI","UWA/Controls/Abstract","require","DS/LifecycleServices/LifecycleServicesSettings"],function(e,t,n,i){return t.extend({init:function(e){for(var t in this.result="",this.id="",this.message="",this.physicalid="",this.relationphysicalid="",this.relationname="",this.PhysicalIDToRefresh="",this.attributes=null,e.hasOwnProperty("to[CAD SubComponent].physicalid")?this.relationphysicalid=e["to[CAD SubComponent].physicalid"]:e.hasOwnProperty("to[VPMInstance].physicalid")&&(this.relationphysicalid=e["to[VPMInstance].physicalid"]),e.hasOwnProperty("instanceName")&&(this.relationname=e.instanceName),this.isNewCommandResponse=!0,i.app_initialization(function(){}),e)this[t]=e[t]},isSuccess:function(){return"SUCCESS"==this.result},isWarning:function(){return"WARNING"==this.result},getType:function(){this.getAttributes();for(var e in this.attributes)if(this.attributes[e].hasOwnProperty("name")&&"ds6w:type"===this.attributes[e].name)return this.attributes[e].value;return""},getRelationPhysicalId:function(){return this.relationphysicalid},getPhysicalId:function(){return this.physicalid},getMessage:function(){return this.message},getPhysicalIdsToRefresh:function(){return this.PhysicalIDToRefresh},getAttributes:function(){if(null==this.attributes)for(var e in this.attributes=JSON.parse(this.rawAttr)[0].attributes,this.relationname&&0!=this.relationname.length&&this.attributes.push({name:"instanceName",value:this.relationname}),this.attributes)if(this.attributes[e].hasOwnProperty("name")&&("type_icon_url"===this.attributes[e].name||"thumbnail_2d"===this.attributes[e].name)){var t=i.get3DSpaceWSUrl(i.getTenant(),this.attributes[e].value,null);null!=t&&null!=t||(t=""),this.attributes[e].value=t}return this.attributes}})}),define("DS/ENOCollabSharingCmds/uiex/SuperModalEx",["DS/UIKIT/SuperModal","DS/UIKIT/Form","DS/UIKIT/Input/Button","DS/UIKIT/Input/Text","DS/UIKIT/Tooltip","UWA/Class/Promise","i18n!DS/ENOCollabSharingCmds/assets/nls/SuperModalEx","css!DS/ENOCollabSharingCmds/assets/style/SuperModalEx.css"],function(e,t,n,i,a,o,r){"use strict";return e.extend({init:function(e){this._parent(e)},promptRadioList:function(){var e,i,a=arguments,o=a[0],r=a[1],s=a[2],l=a[3],c=a[4],d=a[5],u=[],p=UWA.merge({visible:!1,closable:!0},this.options);function f(t){e.preventEvent=!0,e.hide(),UWA.is(l,"function")&&l(t)}UWA.is(a[0],"object")&&(o=a[0].message,r=a[0].title,s=a[0].fields,l=a[0].callback,c=a[0].okButtonText,d=a[0].koButtonText),p.events={onHide:function(){!e.preventEvent&&UWA.is(l,"function")&&l()},onShow:function(){i.getField("input_radio").focus()}},e=this.modalFactory(p);for(var g=[],h=0;h<s.length;h++){var m=!1;0==h&&(m=!0),g.push({type:"radio",checked:m,name:"input_radio",value:s[h].value,label:s[h].label})}i=new t({fields:g,events:{onSubmit:function(e){f(e.input_radio)}}}),this.form=i,UWA.is(o,"string")?e.elements.body.addContent({tag:"p",text:o},i):e.elements.body.addContent(o,i),UWA.is(r,"string")?e.setHeader({tag:"h4",text:r}):(e.getHeader().hide(),l||(l=r)),!UWA.is(l,"function")&&this.options.callback&&(l=this.options.callback),u.push(new n({value:c||p.okButtonText,className:"primary"})),u[0].addEvent("onClick",function(){i.submit()}),u.push(new n({value:d||p.koButtonText})),u[1].addEvent("onClick",function(){f(null)}),e.setFooter(u),e.dispatchEvent("onShowModal")},promptSelectList:function(){var i,s,l,c,d,u,p=this,f=!0,g=arguments,h=(g[0],g[1]),m=g[2],v=g[3],C=g[4],S=g[5],y=g[6],b=g[7],D=g[8],E=g[9],N=g[10],_=g[11],A=[],P=UWA.merge({visible:!1,closable:!0},this.options),T=null,w=null!=D&&D.length>=2;function O(e,t,n,a,o){i.preventEvent=!0,f&&i.hide(),f=!0,UWA.is(E,"function")&&E(e,t,n,a,o)}function I(e){var t=e.getValue("input_select"),n=(e.getTextInput("input_filename"),e.getField("input_filename").getParent().getParent());if(S)if("V6"==t)n.hide(),p.showfilename=!1;else{if(null!=y&&null!=t){var i=t;i=i.substring(0,5);var a=JSON.parse(y),o=!1;Object.keys(a).forEach(function(e){i==e&&(a[e].hasOwnProperty("filenameStatus")&&"TRUE"==a[e].filenameStatus&&(o=!0))})}o?(n.show(),p.showfilename=!0):(n.hide(),p.showfilename=!1)}else n.hide()}function x(e){var t,n=e.getValue("input_select");return"V5"==n||-1!==n.indexOf("UPSV5")?t="CATIAV5":-1!==n.indexOf("UPSSW")?t="SOLIDWORKS":-1!==n.indexOf("UPSCR")?t="CREO":-1!==n.indexOf("UPSNX")?t="NX":-1!==n.indexOf("UPSNX")?t="NX":-1!==n.indexOf("UPSIV")?t="INVENTOR":-1!==n.indexOf("UPSAD")&&(t="AUTOCAD"),t}function M(e){return new o(function(t,n){var i=x(e);require(["DS/LifecycleServices/LifecycleServicesSettings"],function(e){e.getCADvalidityService(i).then(function(e){t(e)}).catch(function(e){n(e)})})})}function U(e,t){R(e,function(n){!function(e,t){var n=e.getValue("input_title"),i=e.getValue("input_filename");n!=i&&(p.modifyfilename=!1);(function(e){return new o(function(t,n){if(function(e){var t=!1,n=e.getValue("input_select");return"V5"!=n&&-1===n.indexOf("UPSV5")||(t=!0),t}(e)){var i=x(e);require(["DS/LifecycleServices/LifecycleServicesSettings"],function(e){e.getCADvalidityService(i).then(function(e){t(e)}).catch(function(e){n(e)})})}else n(null)})})(e).then(function(n){if(n&&"function"==typeof n.checkfilenameValidity)n.checkfilenameValidity(i,function(n){var i=e.getField("input_filename"),a=i.getParent();if(null!=n){if(null!=a){p.filenamevalidated=!1;var o=!1;a.lastChild.textContent=n,i.getParent(".form-group").addClassName("has-error"),i.focus(),t(o)}}else if(null!=a){p.filenamevalidated=!0;var o=!0;i.getParent(".form-group").removeClassName("has-error"),a.lastChild.textContent="",i.focus(),t(o)}});else{var a=e.getField("input_filename"),o=a.getParent();a.getParent(".form-group").removeClassName("has-error"),o.lastChild.textContent="";t(!0)}}).catch(function(n){var i=e.getField("input_filename"),a=i.getParent();i.getParent(".form-group").removeClassName("has-error"),a.lastChild.textContent="";t(!0)})}(e,function(e){t(n&&e)})})}function R(e,t){M(e).then(function(e){return e}).then(function(n){if(n&&"function"==typeof n.checktitleValidity){var i,a=e.getValue("input_title"),o=JSON.parse(v);Object.keys(o).forEach(function(e){o[e].hasOwnProperty("DSType")&&(i=e)}),n.checktitleValidity(i,a).then(function(n){var i=e.getField("input_title").getParent();null!=i&&i.getParent(".form-group").removeClassName("has-error"),i.lastChild.textContent="";t(!0)}).catch(function(n){var i=e.getField("input_title"),a=i.getParent();null!=a&&(a.lastChild.textContent=n,a.getParent(".form-group").addClassName("has-error"));i.focus(),t(!1)})}else{r.lastChild.textContent="";var r=titlefield.getParent();null!=r&&r.getParent(".form-group").removeClassName("has-error");t(!0)}}).catch(function(n){var i=e.getField("input_title").getParent();null!=i&&i.getParent(".form-group").removeClassName("has-error"),i.lastChild.textContent="";t(!0)})}function W(e,t){var n=e.getInput("input_types");if(null!=n&&null!=n)for(var i=n.getOptions(),a=0;a<i.length;a++){var o=i[a];o.value==t&&(u=o.label)}}function V(e,t,n){var i=[];if(null!=n){var a=JSON.parse(n);Object.keys(a).forEach(function(e){if(a[e].type===t){var n=a[e].current,o=a[e].templates;Object.keys(o).forEach(function(e){var t=o[e].name,a=!1;o[e].physicalid===n&&(a=!0);var r={value:t,selected:a};i.push(r)})}})}if(null!=e){var o=e.getAutocompleteInput("input_partTemplates");if(null!=o){o.removeDataset("all3Dparttemplates");var s={name:"all3Dparttemplates",items:i};o.addDataset(s)}}if(null!=d){var l=r.TooltipSaveSettings+u;d.setBody(l)}}function F(e){var t=e.msg,n=e.eventID,a=e.customClass;switch(n){case"error":(function(e,t){L(function(n){var a=n.addError(e,t);i.dispatchEvent("onNotification",a)})})(t=t||e.json,a);break;case"warning":!function(e,t){L(function(n){var a=n.addWarning(e,t);i.dispatchEvent("onNotification",a)})}(t,a);break;case"success":!function(e,t){L(function(n){var a=n.addSuccess(e,t);i.dispatchEvent("onNotification",a)})}(t,a);break;default:!function(e,t){L(function(n){var a=n.addInfo(e,t);i.dispatchEvent("onNotification",a)})}(t,a)}}function L(e){T?e.call(null,T):require(["DS/ErrorWidget/ErrorWidget"],function(t){T||(T=new t(widget,widget.body,{className:"newcontent_errorManager"})),e.call(null,T)})}widget.addEvent("CREATIONDONE",function(){var e=r.CreateButton;A[1].load(!1,e)}),UWA.is(g[0],"object")&&(g[0].message,h=g[0].title,C=g[0].fields,E=g[0].callback,N=g[0].okButtonText,_=g[0].koButtonText),P.events={onHide:function(){!i.preventEvent&&UWA.is(E,"function")&&E()},onShow:function(){s.getField("input_select").focus()}};var B=localStorage.getItem("CADOriginPSECreate"),j=B;null!==j&&"V6"!==j&&(j=j.substring(0,5));var k=p.labelSort(C,j),z=[];if(null!=v){var X=m,q=!1,H=JSON.parse(v);Object.keys(H).forEach(function(e){q=!1,null===X&&H[e].hasOwnProperty("DSType")&&(q=!0),X===e&&(q=!0);var t={label:H[e].nlsname,value:e,selected:q};z.push(t)})}z.sort(function(e,t){var n=e.label.toLowerCase(),i=t.label.toLowerCase();return n.localeCompare(i)}),i=this.modalFactory(P);var Y=r.Template,J=r.Title,K=r.Filename,G=r.Type,$=r.TitlePlaceHolder,Q=r.FilenamePlaceHolder,Z=[];if(p.modifyfilename=!0,p.filenamevalidated=!0,"V6"==B&&(p.showfilename=!1),S||(p.showfilename=!1),z.length>1&&Z.push({type:"select",name:"input_types",label:G,options:z,events:{onChange:function(e){if(UWA.is(E,"function")){var t=s.getValue("input_types");W(s,t);V(s,t,D)}}}}),Z.push({type:"text",name:"input_title",placeholder:$,maxlength:100,label:J,errorText:"title not correct",events:{onKeyDown:function(e){13===e.keyCode&&setTimeout(function(){U(s,function(e){1!=e&&0!=p.showfilename||s.submit()})})}}}),Z.push({type:"select",name:"input_select",label:Y,options:k,events:{onChange:function(e){S&&I(s),R(s,function(e){})}}}),Z.push({type:"text",name:"input_filename",placeholder:Q,label:K,errorText:"filename not correct",events:{onChange:function(e){!0===p.modifyfilename&&(s.getValue("input_title")!=s.getValue("input_filename")&&(p.modifyfilename=!1))}}}),w){var ee=r.partTemplate;$=r.partTemplatePlaceHolder;Z.push({type:"autocomplete",name:"input_partTemplates",label:ee,placeholder:$,showSuggestsOnFocus:!0})}if(s=new t({className:"horizontal",fields:Z,grid:"3 9",events:{onSubmit:function(e){var t=e.input_title,n=e.input_select,i=e.input_filename,a=e.input_types;localStorage.setItem("CADOriginPSECreate",n),O(a,t,n,i,null)}}}),this.form=s,w){var te=s.getValue("input_types");null!=te&&null!=te||(te="VPMReference"),W(s,te),V(s,te,D)}var ne={input:function(){setTimeout(function(){var e=s.getTextInput("input_title");s.getTextInput("input_filename");if(e.elements.input){var t=e.getValue();!function(e){var t=null,n=JSON.parse(v);Object.keys(n).forEach(function(e){n[e].hasOwnProperty("DSType")&&(t=e)});var i=e.getTextInput("input_title").getValue();M(e).then(function(e){return e}).then(function(n){n&&"function"==typeof n.getInvalidCharInTitle&&n.getInvalidCharInTitle(t).then(function(e){return e}).then(function(t){var n=new RegExp(t),a=i.match(n),o=e.getField("input_title").getParent();if(null==a)o.getParent(".form-group").removeClassName("has-error");else{var s,l,c=null;for(l=0;l<a.length;l++)void 0===s?s=a[l]:s.includes(a[l])||(s+=a[l]);var d=s.split("");void 0!==d&&(c=r.get("Unsupported_char",{char:d})),null!=c&&null!=o&&(o.lastChild.textContent=c,o.getParent(".form-group").addClassName("has-error"))}}).catch(function(t){e.getField("input_title").getParent().getParent(".form-group").removeClassName("has-error")})}).catch(function(t){e.getField("input_title").getParent().getParent(".form-group").removeClassName("has-error")})}(s),p.modifyfilename&&p.form.setValue("input_filename",t)}})}};s.getTextInput("input_title").elements.input.addEvents(ne),p.showfilename||I(s),R(s,function(e){}),i.elements.body.addContent(s),UWA.is(h,"string")?i.setHeader({tag:"h4",text:h}):(i.getHeader().hide(),E||(E=h)),!UWA.is(E,"function")&&this.options.callback&&(E=this.options.callback);var ie=r.CreateButton,ae=r.CreateCloseButton,oe=r.CloseButton,re=r.SaveSettingsButton;A.push(new n({value:N||ae,className:"primary"})),A[0].addEvent("onClick",function(){U(s,function(e){1!=e&&0!=p.showfilename||(f=!0,s.submit())})}),A.push(new n({value:N||ie})),A[1].addEvent("onClick",function(){U(s,function(e){if(1==e||0==p.showfilename){var t=r.CreatingButton;A.length&&null!=A[1]&&A[1].load(!0,t),f=!1,s.submit()}})}),A.push(new n({value:_||oe})),A[2].addEvent("onClick",function(){f=!0,O(null)}),b&&A[1].hide(),w&&(A.push(new n({value:_||re})),A[3].addEvent("onClick",function(){l=s.getValue("input_types"),c=s.getValue("input_partTemplates"),i.hide();new e({closable:!0,animate:!1,overlay:!0}).confirm({title:r.saveSettingsTitle,message:r.confirmsaveSettingsMsg+u+"?",callback:function(e){!function(e,t,n){if(n){var i=null;if(null!=D){var a=JSON.parse(D);Object.keys(a).forEach(function(n){if(a[n].type===e){a[n].current;var o=a[n].templates;Object.keys(o).forEach(function(e){o[e].name===t&&(i=o[e].physicalid)})}})}null!=i?(F({msg:r.SaveSettingsOK+u,eventID:"success"}),f=!1,O(e,null,null,null,i)):F({msg:r.SaveSettingsKO+u,eventID:"error"})}}(l,c,e)}})}),d=new a({target:A[3].getContent(),body:r.TooltipSaveSettings+u})),i.setFooter(A),i.dispatchEvent("onShowModal")},labelSort:function(e,t){for(var n=[],i=!1,a=[],o=0;o<e.length;o++)a.push(e[o].label);a.sort();for(var r=0;r<e.length;r++){var s="background-image: url("+e[r].icon+");background-repeat: no-repeat;background-position-y: center;white-space: pre;background-size: 20px;background-origin: content-box;",l=e[r].value,c=a.indexOf(e[r].label);if(l.startsWith(t)&&!i){var d={label:e[r].label,value:e[r].value,attributes:{style:s},group:e[r].Connector,selected:!0};n[c]=d,i=!0}else{d={label:e[r].label,value:e[r].value,attributes:{style:s},group:e[r].Connector};n[c]=d}}return n}})}),define("DS/ENOCollabSharingCmds/commands/CommandAvailableOnSelect",["UWA/Core","UWA/Class","DS/PlatformAPI/PlatformAPI","DS/PADUtils/PADContext","DS/WAFData/WAFData","DS/LifecycleServices/LifecycleServicesSettings","DS/LifecycleControls/CredentialList"],function(e,t,n,i,a,o,r){"use strict";return t.extend({init:function(e,t){this._parent(e,t),this.checking_select=!1;var n=i.get();n&&!1!==n.checkOnCommand&&(this._check_select(),n.addEvent("editModeModified",this.check_select.bind(this)),n.getPADTreeDocument().getXSO().onPostAdd(this.check_select.bind(this)),n.getPADTreeDocument().getXSO().onPostRemove(this.check_select.bind(this)))},isCID:function(e){for(var t=!1,n=e.length,i=0;i<n;i++)if(null!=e[i].getID()&&0===e[i].getID().indexOf("cid:")){t=!0;break}return t},check_select:function(){if(!this.checking_select){this.checking_select=!0;var e=!1!==this.options.withTimeout?300:0;setTimeout(function(){this.checking_select=!1,this._check_select()}.bind(this),e)}},_check_select:function(){var t=i.get(),n=t.getPADTreeDocument().getXSO().get(),a=this.isCID(n),o=n.length,s=!(!o||!0===this.options.cmd_selection_single&&1!==o);if(0===o&&"function"==typeof t.getFolderXSO){var l=t.getFolderXSO().getCurrentFolder();(s=!!l&&!!l.id)&&(o=(n=[l]).length)}if(null!=this.isAvailable)(p=this).selectedObjects=n,s=this.isAvailable(n,function(e,t){t==p.selectedObjects&&(e?p.enable():p.disable())});else if(!0!==s||t.getEditMode&&!0!==t.getEditMode())this.disable();else{for(var c=!0,d=0;d<o;d++)null!=n[d].getID()&&(c=!1);if(c)this.disable();else if(this.enable(),a&&this.disable(),!window.__karma__&&"ActionBar_AccessRightCmd"===this.options.ID){var u=t.getSecurityContext(),p=this,f=widget.getValue("x3dPlatformId");let n=r.loadCredentials(f);e.Promise.all([n,u]).then(t=>{t.length<2||!e.is(t[0],"array")?console.error("Missing credentials"):r.filterCredentials(f,t[0],"accessRight").then(e=>{e.length;0==e.length&&p.disable()}).catch(e=>{console.error("FAiled to call credential filter svc, error:",e)})})}}}})}),define("DS/ENOCollabSharingCmds/commands/EditPropCmd/ActionBar_EditPropCmd",["UWA/Class","DS/ENOCollabSharingCmds/commands/EditPropCmd/EditPropCmdBase","DS/ENOCollabSharingCmds/commands/CommandAvailableOnSelect","i18n!DS/ENOCollabSharingCmds/assets/nls/langSharingCmds"],function(e,t,n){"use strict";return e.extend(t,n,{defaultIsTransient:!1,extraNotif:!1,init:function(e){e.withTimeout=!1,this._parent(e,{isAsynchronous:!0}),this.editProp=null},execute:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){var n=t.get();null==n&&(n=e.options.context),e.disable(),n.options.arguments=e.options.arguments,e.launchProperties(n),setTimeout(function(){e.enable()},2e3)})}})}),define("DS/ENOCollabSharingCmds/commands/ReserveCmd/ActionBar_ReserveCmd",["UWA/Class","DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/CommandAvailableOnSelect","DS/PlatformAPI/PlatformAPI","DS/ENOCollabSharingCmds/Services/CommandServices","i18n!DS/ENOCollabSharingCmds/assets/nls/langSharingCmds"],function(e,t,n,i,a,o){"use strict";return e.extend(t,n,{labelTopBar:UWA.i18n("Reserve selected objects"),init:function(e){var t=!1;this.options=e,void 0!==typeof e&&null!==e&&e.hasOwnProperty("odtMode")&&(t=e.odtmode),t||this._setCommandEnableStatus(),this._parent(e,{isAsynchronous:!0}),"function"==typeof i.getUser()?this.currentUser=i.getUser().login:this.currentUser="",this._unsupportedTypes=[]},beginExecute:function(){},execute:function(){var e=this;require(["DS/WidgetServices/WidgetServices","DS/ENOCollabSharingCmds/Services/CommandServices","DS/ReserveWidget/ReserveWidget","DS/PADUtils/PADContext","DS/ENOCollabSharingCmds/BaseModels/ResultElement"],function(t,n,a,r,s){var l=r.get();null==l&&(l=e.options.context);var c={_setNotification:function(e,t){if("function"==typeof l.displayNotification){var n={eventID:t,msg:e};l.displayNotification(n)}else alert(e)},_setError:function(e){this._setNotification(e,"error")},_setWarning:function(e){this._setNotification(e,"warning")},_setInfo:function(e){this._setNotification(e,"info")}},d=[],u=l.getSelectedNodes(),p=!1,f=!1;if(u.length&&u.forEach(function(t){if("function"==typeof t.getID&&"function"==typeof t.getLabel){var i=t.plmType,a="";n.inFamilyFolder(i)&&(console.log("$$$ A Folder has been selected $$$"),p=!0);i="";null!=t.options&&(i=t.options.type),t.object&&n.isMaterialDomain(t.object.type)&&(null!=t.object.options&&(a=t.object.options["ds6w:type"]),console.log("$$$ An unsupported Material type has been selected $$$"),f=!0,e._unsupportedTypes.includes(a)||e._unsupportedTypes.push(a));var o=t.getID(),r=t.getLabel();if(null!=o){var l="";"function"==typeof t.getRelationID&&(l=t.getRelationID());var c="";if("function"==typeof t.getRealParent)"function"==typeof(u=t.getRealParent()).getID&&(c=u.getID());else if("function"==typeof t.getParent){var u;"function"==typeof(u=t.getParent()).getID&&(c=u.getID())}var g=null;null!=t&&null!=t.options&&null!=t.options.grid&&(g=t.options.grid["ds6w:cadMaster"]);var h=new s({physicalId:o,name:r,relID:l,parentID:c,cadMaster:g,type:i});d.push(h)}}}),d.length>0){var g=!1;void 0!==typeof e.options&&null!==e.options&&e.options.hasOwnProperty("odtmode")&&(g=e.options.odtmode),0==g&&n.allAggregated3DShape(d,function(e){})}if(!0===p)c._setWarning(UWA.i18n("reserve not available"));else if(!0===f){var h=o.replace(o.errorMatRefReserveCmdErrorMessage,{dispType:e._unsupportedTypes});c._setError(h)}else if(d.length>0){var m=d[0],v=e.currentUser;null==v&&(v=i.getUser().login),e.container=new a({readOnly:"auto",serverName:m.getServerHost(),serverUri:m.getServerUri(),operation:"reserve",currentUser:v,localContext:l,events:{onNotification:function(e){l.displayNotification(e)}}}),e.container.setObjects(d),e.container.launchCmd()}else c._setWarning(UWA.i18n("reserve no content"))}),e.end()},endExecute:function(){},_setCommandEnableStatus:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){var n=0;null!=t.get()&&(null!=t.get().getEditMode&&!0!==t.get().getEditMode()&&(n=0),1===n?e.enable():e.disable(),t.get().addEvent("editModeModified",function(t){!0===t?e.enable():e.disable()}))})}})}),define("DS/ENOCollabSharingCmds/commands/ShareCmd/ActionBar_ShareCmd",["UWA/Class","DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/CommandAvailableOnSelect","DS/LifecycleServices/LifecycleServices","DS/LifecycleServices/LifecycleServicesSettings","i18n!DS/ENOCollabSharingCmds/assets/nls/langSharingCmds","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],function(e,t,n,i,a,o,r,s){"use strict";return e.extend(t,n,{init:function(e){this._parent(e,{isAsynchronous:!0}),this.sharePanel=null},beginExecute:function(){},execute:function(){var e=this;e.disable(),require(["DS/WidgetServices/WidgetServices","DS/WidgetServices/securityContextServices/SecurityContextServices","DS/SharePopup/SharePopup","DS/Selection/CSOManager","DS/ENOCollabSharingCmds/BaseModels/ResultElement","DS/PADUtils/PADContext","DS/LifecycleServices/LifecycleServices"],function(t,n,i,o,r,s,l){e._unsupportedTypes=[];var c=s.get();null==c&&(c=e.options.context);var d=t.getTenantID(),u={context:c};n.getInstance(u).getSecurityContext();o.get();var p=[],f=o.get();0==f.length&&(f=c.getSelectedNodes()),f.length&&f.forEach(function(e){if("function"==typeof e.getID&&"function"==typeof e.getLabel){var n=e.getID();e.getLabel();if(null!==n){n=e.getID();var i=e.getLabel(),o=null,s="",l="",c=null,d=null;if(e.options)o=e.options.type,l=e.options.subLabel,c=e.options.grid["ds6wg:revision"],s=e.options.grid["ds6w:type"],null!=e.options.icons&&e.options.icons.length>0&&(d=e.options.icons[0]);else if(e.object){if(l=e.object.ownerFullName,c=e.object.revision,null!=e.object.options&&null!=e.object.options.icons&&e.object.options.icons.length>0){var u=e.object.options.icons[0];d=u.length&&u.indexOf("http")<0?a.get3DSpaceBaseUrl(t.getTenantID())+u:u}s=e.object.type}var f="";"function"==typeof e.getRelationID&&(f=e.getRelationID());var g="",h="";if(null!==e&&null!==e.getParent&&"function"==typeof e.getParent){var m=e.getParent();null!==m&&null!==m.getID&&"function"==typeof m.getID&&(g=m.getID(),h=m.options.grid["ds6w:cadMaster"])}var v=null;null!=e&&null!=e.options&&null!=e.options.grid&&(v=e.options.grid["ds6w:cadMaster"]);var C=new r({urlIcon:d,physicalId:n,name:i,category:"",type:o,typeDisplayName:s,relID:f,parentID:g,cadMaster:v,parentCADMaster:h,responsibleName:l,Revision:c});p.push(C)}}}),null===n._currentSecurityContext?e.isAllECInSelection(d,c,p,""):e.isAllECInSelection(d,c,p,n._currentSecurityContext.SecurityContext)})},isAllECInSelection:function(e,t,n,a){for(var r=this,s=(JSON.parse("[]"),!1),l=n.length,c=[],d=0;d<l;d++){var u=n[d].getID();c.push(u)}return i.listAttributes(e,c,["attribute[XCADEmbeddedCmp.V_IsEmbeddedComponent]","attribute[PLMCoreRepReference.V_isOnceInstantiable]","attribute[PLMEntity.V_usage]","type","owner","project","organization","physicalid","project.property[Title].value","organization.property[Title].value"],function(i,a){var c=0;s=!1;for(var d=0,u=i.results.length,p=0;p<u;p++){"TRUE"==(f=i.results[p])["attribute[XCADEmbeddedCmp.V_IsEmbeddedComponent]"]&&d++}if(u>0)for(p=0;p<i.results.length;p++){(f=i.results[p]).physicalid;for(var f,g=0;g<n.length;g++)if(f.physicalid===n[g].physicalId){var h;1==(h="3DPart"==f["attribute[PLMEntity.V_usage]"]&&"3DShape"==f.type)&&c++,n[g].owner=f.owner,n[g].project=f.project,n[g].organization=f.organization,n[g].v_IsEmbeddedComponent=f["attribute[XCADEmbeddedCmp.V_IsEmbeddedComponent]"],f.hasOwnProperty("options")&&f.options.hasOwnProperty("ds6w:type")&&(n[g].typeDisplayName=f.options["ds6w:type"]),null!=n[g].typeDisplayName&&null!=n[g].typeDisplayName||null==f.type&&null==f.type||(n[g].typeDisplayName=f.type),null==f["organization.property[Title].value"]||""===f["organization.property[Title].value"]?n[g].organizationTitle=f.organization:n[g].organizationTitle=f["organization.property[Title].value"],null===f["project.property[Title].value"]||""===f["project.property[Title].value"]?n[g].collabSpaceTitle=f.project:n[g].collabSpaceTitle=f["project.property[Title].value"],"3DPart"==f["attribute[PLMEntity.V_usage]"]&&"3DShape"!=n[g].type&&(null!=n[g].urlIcon&&null!=n[g].urlIcon.iconPath&&null!=n[g].urlIcon.iconPath&&(n[g].urlIcon=n[g].urlIcon.iconPath.replace("I_VPMNavProduct.png","I_3DPart.png")),n[g].typeDisplayName=o["3DPart"]),1==h&&(r._unsupportedTypes.includes(n[g].typeDisplayName)||r._unsupportedTypes.push(n[g].typeDisplayName))}}if(d==l)return r._setError(t,o.selectOwning),r.enable(),void r.end();if(c==l){var m=o.replace(o.errorMatRefShareCmdErrorMessage,{dispType:r._unsupportedTypes});return r._setError(t,m),r.end(),void(r._unsupportedTypes=[])}require(["DS/SharePopup/SharePopup","DS/LifecycleControls/CredentialList"],function(i,a){if(r.sharePanel){c=t._currentSC;let i=a.loadCredentials(e);UWA.Promise.all([i,c]).then(i=>{i.length<2||!UWA.is(i[0],"array")?console.error("Missing credentials"):a.filterCredentials(e,i[0],"accessRight").then(e=>{e.length;0!=e.length?(r.sharePanel.show(n),r.sharePanel.container.centerIt()):r._setError(t._currentSC,o.errorNotSupportedRoleForShare)}).catch(e=>{console.error("FAiled to call credential filter svc, error:",e)})})}else if(n.length>0){var s=n[0],l=widget.body;l=l||UWA.extend(document.body),r.sharePanel=new i(widget,widget.body,{className:"share_popup_fromCmd",serverName:s.getServerHost(),serverUri:s.getServerUri(),removeAtClose:!0,events:{onClose:function(){r.sharePanel=null,r.options.hasOwnProperty("sharingWebUI")&&r.options.sharingWebUI.onRefresh()}}});var c=t._currentSC;let d=a.loadCredentials(e);UWA.Promise.all([d,c]).then(i=>{i.length<2||!UWA.is(i[0],"array")?console.error("Missing credentials"):a.filterCredentials(e,i[0],"accessRight").then(e=>{e.length;0!=e.length?r.sharePanel.show(n):r._setError(t._currentSC,o.errorNotSupportedRoleForShare)}).catch(e=>{console.error("FAiled to call credential filter svc, error:",e)})})}else r._setError(localContext,UWA.i18n("no content selected"));r.end(),r.enable()})},function(e){return console.log(e),r._setError(t,o.InternalServerError),r.enable(),-1}),s},_setError:function(e,t){if(null!=e&&"function"==typeof e.displayNotification){var n={eventID:"error",msg:t};e.displayNotification(n)}else{window.notifs=r,s.setNotificationManager(window.notifs);var i={level:"error",title:"",subtitle:t,message:"",sticky:!1};window.notifs.addNotif(i)}},endExecute:function(){}})}),define("DS/ENOCollabSharingCmds/commands/AccessRightCmd/ActionBar_AccessRightCmd",["UWA/Class","DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/CommandAvailableOnSelect","DS/LifecycleServices/LifecycleServices","DS/LifecycleServices/LifecycleServicesSettings","i18n!DS/ENOCollabSharingCmds/assets/nls/langSharingCmds"],function(e,t,n,i,a,o){"use strict";return e.extend(t,n,{init:function(e){this._parent(e,{isAsynchronous:!0}),this.accessRightPanel=null},beginExecute:function(){},execute:function(){var e=this;e.disable(),require(["DS/WidgetServices/WidgetServices","DS/WidgetServices/securityContextServices/SecurityContextServices","DS/AccessRightPopup/AccessRightPopup","DS/Selection/CSOManager","DS/ENOCollabSharingCmds/BaseModels/ResultElement","DS/PADUtils/PADContext","DS/LifecycleServices/LifecycleServices"],function(t,n,i,o,r,s,l){e._unsupportedTypes=[];var c=s.get();null==c&&(c=e.options.context);var d=t.getTenantID(),u={context:c};n.getInstance(u).getSecurityContext();o.get();var p=[],f=o.get();0==f.length&&(f=c.getSelectedNodes()),f.length&&f.forEach(function(e){if("function"==typeof e.getID&&"function"==typeof e.getLabel){var n=e.getID();e.getLabel();if(null!==n){n=e.getID();var i=e.getLabel(),o=null,s="",l="",c=null,d=null;if(e.options)o=e.options.type,l=e.options.subLabel,c=e.options.grid["ds6wg:revision"],s=e.options.grid["ds6w:type"],null!=e.options.icons&&e.options.icons.length>0&&(d=e.options.icons[0]);else if(e.object){if(l=e.object.ownerFullName,c=e.object.revision,null!=e.object.options&&null!=e.object.options.icons&&e.object.options.icons.length>0){var u=e.object.options.icons[0];null===u&&e.object.options.icons.length>1&&(u=e.object.options.icons[1]),d=u.length&&u.indexOf("http")<0?a.get3DSpaceBaseUrl(t.getTenantID())+u:u}s=e.object.type}var f="";"function"==typeof e.getRelationID&&(f=e.getRelationID());var g="",h="";if(null!==e&&null!==e.getParent&&"function"==typeof e.getParent){var m=e.getParent();null!==m&&null!==m.getID&&"function"==typeof m.getID&&(g=m.getID(),h=m.options.grid["ds6w:cadMaster"])}var v=null;null!=e&&null!=e.options&&null!=e.options.grid&&(v=e.options.grid["ds6w:cadMaster"]);var C=new r({urlIcon:d,physicalId:n,name:i,category:"",type:o,typeDisplayName:s,relID:f,parentID:g,cadMaster:v,parentCADMaster:h,responsibleName:l,Revision:c});p.push(C)}}}),e.isAllECInSelection(d,c,p)})},isAllECInSelection:function(e,t,n){for(var a=this,r=(JSON.parse("[]"),!1),s=n.length,l=[],c=0;c<s;c++){var d=n[c].getID();l.push(d)}return i.listAttributes(e,l,["attribute[XCADEmbeddedCmp.V_IsEmbeddedComponent]","attribute[PLMCoreRepReference.V_isOnceInstantiable]","attribute[PLMEntity.V_usage]","type","owner","project","organization","physicalid","project.property[Title].value","organization.property[Title].value"],function(i,l){var c=0;r=!1;for(var d=0,u=i.results.length,p=0;p<u;p++){"TRUE"==(f=i.results[p])["attribute[XCADEmbeddedCmp.V_IsEmbeddedComponent]"]&&d++}if(u>0)for(p=0;p<i.results.length;p++){(f=i.results[p]).physicalid;for(var f,g=0;g<n.length;g++)if(f.physicalid===n[g].physicalId){var h;1==(h="3DPart"==f["attribute[PLMEntity.V_usage]"]&&"3DShape"==f.type)&&c++,n[g].owner=f.owner,n[g].project=f.project,n[g].organization=f.organization,n[g].v_IsEmbeddedComponent=f["attribute[XCADEmbeddedCmp.V_IsEmbeddedComponent]"],null==f["organization.property[Title].value"]||""===f["organization.property[Title].value"]?n[g].organizationTitle=f.organization:n[g].organizationTitle=f["organization.property[Title].value"],null===f["project.property[Title].value"]||""===f["project.property[Title].value"]?n[g].collabSpaceTitle=f.project:n[g].collabSpaceTitle=f["project.property[Title].value"],"3DPart"==f["attribute[PLMEntity.V_usage]"]&&"3DShape"!=n[g].type&&(null!=n[g].urlIcon.iconPath&null!=n[g].urlIcon.iconPath&&(n[g].urlIcon=n[g].urlIcon.iconPath.replace("I_VPMNavProduct.png","I_3DPart.png")),n[g].typeDisplayName=o["3DPart"]),1==h&&(a._unsupportedTypes.includes(n[g].typeDisplayName)||a._unsupportedTypes.push(n[g].typeDisplayName))}}if(d==s)return a._setError(t,o.selectOwning),a.enable(),void a.end();if(c==s){var m=o.replace(o.errorMatRefShareCmdErrorMessage,{dispType:a._unsupportedTypes});return a._setError(t,m),a.end(),void(a._unsupportedTypes=[])}i.results[0].popup?require(["DS/SharePopup/SharePopup","DS/LifecycleControls/CredentialList"],function(i,r){if(a.sharePanel){c=t._currentSC;let i=r.loadCredentials(e);UWA.Promise.all([i,c]).then(i=>{i.length<2||!UWA.is(i[0],"array")?console.error("Missing credentials"):r.filterCredentials(e,i[0],"accessRight").then(e=>{e.length;0!=e.length?(a.sharePanel.show(n),a.sharePanel.container.centerIt()):a._setError(t,o.errorNotSupportedRoleForShare)}).catch(e=>{console.error("FAiled to call credential filter svc, error:",e)})})}else if(n.length>0){var s=n[0],l=widget.body;l=l||UWA.extend(document.body),a.sharePanel=new i(widget,widget.body,{className:"share_popup_fromCmd",serverName:s.getServerHost(),serverUri:s.getServerUri(),removeAtClose:!0,events:{onClose:function(){a.sharePanel=null}}});var c=t._currentSC;let d=r.loadCredentials(e);UWA.Promise.all([d,c]).then(i=>{i.length<2||!UWA.is(i[0],"array")?console.error("Missing credentials"):r.filterCredentials(e,i[0],"accessRight").then(e=>{e.length;0!=e.length?a.sharePanel.show(n):a._setError(t,o.errorNotSupportedRoleForShare)}).catch(e=>{console.error("FAiled to call credential filter svc, error:",e)})})}else a._setError(localContext,UWA.i18n("no content selected"));a.end(),a.enable()}):require(["DS/AccessRightPopup/AccessRightPopup","DS/LifecycleControls/CredentialList"],function(i,r){if(a.accessRightPanel){c=t._currentSC;let i=r.loadCredentials(e);UWA.Promise.all([i,c]).then(i=>{i.length<2||!UWA.is(i[0],"array")?console.error("Missing credentials"):r.filterCredentials(e,i[0],"accessRight").then(e=>{e.length;0!=e.length?(a.accessRightPanel.show(n),a.accessRightPanel.container.centerIt()):a._setError(t,o.errorNotSupportedRoleForShare)}).catch(e=>{console.error("FAiled to call credential filter svc, error:",e)})})}else if(n.length>0){var s=n[0],l=widget.body;l=l||UWA.extend(document.body),a.accessRightPanel=new i(widget,widget.body,{className:"accessRight_popup_fromCmd",serverName:s.getServerHost(),serverUri:s.getServerUri(),removeAtClose:!0,events:{onClose:function(){a.accessRightPanel=null}}});var c=t._currentSC;let d=r.loadCredentials(e);UWA.Promise.all([d,c]).then(i=>{i.length<2||!UWA.is(i[0],"array")?console.error("Missing credentials"):r.filterCredentials(e,i[0],"accessRight").then(e=>{e.length;0!=e.length?a.accessRightPanel.show(n):a._setError(t,o.errorNotSupportedRoleForShare)}).catch(e=>{console.error("FAiled to call credential filter svc, error:",e)})})}else a._setError(localContext,UWA.i18n("no content selected"));a.end(),a.enable()})},function(e){return console.log(e),a._setError(t,o.InternalServerError),a.enable(),-1}),r},_setError:function(e,t){if(null!=e&&"function"==typeof e.displayNotification){var n={eventID:"error",msg:t};e.displayNotification(n)}else{window.notifs=NotificationsManager,NotificationsManagerViewOnScreen.setNotificationManager(window.notifs);var i={level:"error",title:"",subtitle:t,message:"",sticky:!1};window.notifs.addNotif(i)}},endExecute:function(){}})}),define("DS/ENOCollabSharingCmds/commands/UnreserveCmd/ActionBar_UnreserveCmd",["UWA/Class","DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/CommandAvailableOnSelect","DS/PlatformAPI/PlatformAPI","DS/ENOCollabSharingCmds/Services/CommandServices","i18n!DS/ENOCollabSharingCmds/assets/nls/langSharingCmds"],function(e,t,n,i,a,o){"use strict";return e.extend(t,n,{labelTopBar:UWA.i18n("Unreserve selected objects"),init:function(e){var t=!1;void 0!==typeof e&&null!==e&&e.hasOwnProperty("odtMode")&&(t=e.odtmode),t||this._setCommandEnableStatus(),this.options=e,this._parent(e,{isAsynchronous:!0}),this._unsupportedTypes=[]},beginExecute:function(){},execute:function(){var e=this;require(["DS/WidgetServices/WidgetServices","DS/ENOCollabSharingCmds/Services/CommandServices","DS/ReserveWidget/ReserveWidget","DS/PADUtils/PADContext","DS/ENOCollabSharingCmds/BaseModels/ResultElement"],function(t,n,i,a,r){var s=a.get();null==s&&(s=e.options.context);var l={_setNotification:function(e,t){if("function"==typeof s.displayNotification){var n={eventID:t,msg:e};s.displayNotification(n)}else alert(e)},_setError:function(e){this._setNotification(e,"error")},_setWarning:function(e){this._setNotification(e,"warning")},_setInfo:function(e){this._setNotification(e,"info")}},c=[],d=s.getSelectedNodes(),u=!1,p=!1;if(d.length&&d.forEach(function(t){if("function"==typeof t.getID&&"function"==typeof t.getLabel){var i="",a="";null!=t.options&&(i=t.options.type);var o=t.plmType;n.inFamilyFolder(o)&&(console.log("$$$ A Folder has been selected $$$"),u=!0),t.object&&n.isMaterialDomain(t.object.type)&&(null!=t.object.options&&(a=t.object.options["ds6w:type"]),console.log("$$$ An unsupported Material type has been selected $$$"),p=!0,e._unsupportedTypes.includes(a)||e._unsupportedTypes.push(a));var s=t.getID(),l=t.getLabel();if(null!=s){var d="";"function"==typeof t.getRelationID&&(d=t.getRelationID());var f="";if("function"==typeof t.getRealParent)"function"==typeof(g=t.getRealParent()).getID&&(f=g.getID());else if("function"==typeof t.getParent){var g;"function"==typeof(g=t.getParent()).getID&&(f=g.getID())}var h=null;null!=t&&null!=t.options&&null!=t.options.grid&&(h=t.options.grid["ds6w:cadMaster"]);var m=new r({physicalId:s,name:l,relID:d,parentID:f,cadMaster:h,type:i});c.push(m)}}}),c.length>0){var f=!1;void 0!==typeof e.options&&null!==e.options&&e.options.hasOwnProperty("odtmode")&&(f=e.options.odtmode),0==f&&n.allAggregated3DShape(c,function(e){})}if(!0===u)l._setWarning(UWA.i18n("unreserve not available"));else if(!0===p){var g=o.replace(o.errorMatRefUnreserveCmdErrorMessage,{dispType:e._unsupportedTypes});l._setError(g)}else if(c.length>0){var h=c[0];e.container=new i({readOnly:"auto",serverName:h.getServerHost(),serverUri:h.getServerUri(),operation:"unreserve",localContext:s,events:{onNotification:function(e){s.displayNotification(e)}}}),console.log("calling setObjects"),e.container.setObjects(c),e.container.launchCmd()}else l._setWarning(UWA.i18n("unreserve no content"))}),e.end()},endExecute:function(){},_setCommandEnableStatus:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){null!=t.get()&&(!0!==t.get().getEditMode()&&e.disable(),t.get().addEvent("editModeModified",function(t){!0===t?e.enable():e.disable()}))})}})}),define("DS/ENOCollabSharingCmds/commands/NewCmd/NewCommandBase",["DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/NewCmd/Models/NewCommandResponse","DS/WidgetServices/securityContextServices/SecurityContextServices","DS/ENOCollabSharingCmds/Services/CommandServices","DS/WAFData/WAFData","require","DS/ENONewWidget/ENONewLauncher","DS/LifecycleServices/LifecycleServicesSettings","DS/LifecycleServices/LifecycleServices","DS/UIKIT/SuperModal","DS/ENOCollabSharingCmds/commands/NewCmd/AttributesPanel","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/ENOCollabSharingCmds/commands/Notification/Notification","DS/WebappsUtils/WebappsUtils","i18n!DS/UIKIT/assets/nls/UIKIT","i18n!DS/ENOCollabSharingCmds/assets/nls/langSharingCmds"],function(t,n,i,a,o,r,s,l,c,d,u,p,f,g,h,m){"use strict";return t.extend({isENONew:!0,labelTopBar:"",labelWaitingCreation:"",CurrentlabelWaitingCreation:"",isInsert:!1,useSelectedNodes:!0,datas:{},activeTopBar:!0,ExecutedByTopBar:!1,currentPreferredCAD:"",CAD_ORIGIN_MIX:"V5&V6",CAD_ORIGIN_TYPE_V6:"V6",CAD_ORIGIN_TYPE_V5:"V5",CAD_ORIGIN_TYPE_SW:"SW",CAD_ORIGIN_TYPE_CR:"CR",CAD_ORIGIN_TYPE_NX:"NX",CAD_ORIGIN_TYPE_IV:"IV",CAD_ORIGIN_TYPE_AD:"AD",CAD_ORIGIN_TYPE_SE:"SE",init:function(e){var t=this;if(t._setCommandEnableStatus(),this._parent(e,{isAsynchronous:!0}),!0===this.activeTopBar&&""!=this.labelTopBar&&(void 0===e.activeTopBar||e.activeTopBar))try{require(["DS/TopBarProxy/TopBarProxy","DS/TopBarProxy/Menu","DS/TopBarProxy/MenuItem"],function(e,n,i){var a=new e({id:widget.id}),o=new i({label:t.labelTopBar,onExecute:function(){t.executeTopBar()}});a.addContent({add:o})})}catch(e){console.log("can't load top bar")}},beginExecute:function(){},executeTopBar:function(){this.ExecutedByTopBar=!0,this.execute()},execute:function(){var e=this,t=e.ExecutedByTopBar;e.ExecutedByTopBar=!1;var r={};require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"],function(e){if(e)try{var t=e.get();r={"DS-Change-Authoring-Context":t.AuthoringContextHeader?t.AuthoringContextHeader["DS-Change-Authoring-Context"]:null,"DS-Configuration-Authoring-Context":t.AuthoringContextHeader?t.AuthoringContextHeader["DS-Configuration-Authoring-Context"]:null}}catch(e){console.log("Change action is empty"),r=null}}),require(["DS/WidgetServices/WidgetServices","DS/PADUtils/PADContext"],function(s,c){var d=c.get();null==d&&(d=e.options.context),null!=d&&"function"==typeof d.getpreferredCAD&&(e.datas.preferredCAD=d.getpreferredCAD()),e.datas.expectSingleCreation=!1,null!=d&&"function"==typeof d.expectSingleCreation&&(e.datas.expectSingleCreation=d.expectSingleCreation()),null!=d&&"function"==typeof d.getpreferredTemplate&&(e.datas.preferredTemplate=d.getpreferredTemplate());var u,p={getContext:function(){return d},getCAHeader:function(){return r},_endCreation:function(){if(d.endBlockingTransaction(e.CurrentlabelWaitingCreation),t||e.end(),e.enable(),"undefined"!=typeof widget)if(e.datas.toupdate){var n=widget.getValue("x3dPlatformId"),i=e.datas.type,a=null,o=i+"PSECreate";null==(a=localStorage.getItem(o))&&(a="undefined"),e._get(n,"/resources/v1/collabServices/authoring/op/getJSProxyNew",{Type:i,objType:a},function(t){e.datas.attributes=t.Attributes,widget.dispatchEvent("CREATIONDONE",t.Attributes)},function(e){widget.dispatchEvent("CREATIONDONE"),S(e)})}else widget.dispatchEvent("CREATIONDONE")},_setNotification:function(e,t){if("function"==typeof d.displayNotification){var n={eventID:t,msg:e};d.displayNotification(n)}else alert(e)},_setError:function(e){this._setNotification(e,"error")},_setWarning:function(e){this._setNotification(e,"warning")},_setInfo:function(e){this._setNotification(e,"info")},_setSuccess:function(e){this._setNotification(e,"success")},_getCurrentFolder:function(){var e=null;if(d&&"function"==typeof d.getCurrentFolder){var t=d.getCurrentFolder();if(t){var n=JSON.parse(t);e={FolderID:n.FolderID,FolderType:n.FolderType}}}return e},_launchThroughSecurityContext:function(e,t,n){var a=this,o={context:d};i.getInstance(o).getSecurityContext({onSuccess:function(t){a._onCompleteGetSecurityContext(t,e,n)},onFailure:function(e){p._endCreation(),null!=e&&p._setError(e.message)}},{serverName:null,serverUri:null})},_onCompleteGetSecurityContext:function(t,n,i){var a=this,r={Accept:"application/json","Content-Type":"application/json"};null!=i&&(i["DS-Change-Authoring-Context"]&&(r["DS-Change-Authoring-Context"]=i["DS-Change-Authoring-Context"]),i["DS-Configuration-Authoring-Context"]&&(r["DS-Configuration-Authoring-Context"]=i["DS-Configuration-Authoring-Context"]));var c="",u=localStorage.selectedsecuritycontext;localStorage.setItem("selectedsecuritycontext",""),void 0!==u&&"undefined"!==u&&0!==u.length||(u=t.SecurityContext),0!=u.indexOf("ctx::")&&(c="ctx::"),r.SecurityContext=c+encodeURIComponent(u);var f=e.datas;if(d&&"function"==typeof d.getCurrentFolder){var m=d.getCurrentFolder();for(var v in m)f[v]=m[v]}delete f.aggregating_context;var C="?select=type&select=physicalid&select=cestamp";!0===e.isInsert&&""!==g?(C+="&aggregating_context="+g,C+="&select="+encodeURIComponent("to[CAD SubComponent].physicalid")):!0===e.isInsert&&h.length>=1&&(C+="&select="+encodeURIComponent("to[CAD SubComponent].physicalid"),f.aggregating_context=[],h.forEach(function(e){f.aggregating_context.push(e)}));f=UWA.Json.encode(f);var S=p._getCurrentFolder(),y=null,b=!1;null!=S&&(y=S.FolderID);try{if(void 0!==l.getActiveFolder){var D=l.getActiveFolder();if("folder"!==(E=UWA.Json.decode(f).type)&&null!==D.id&&void 0!==D.id&&""!==D.id){if(y=D.id,b=!0,void 0!==D.sc&&""!==D.sc){c="";0!==D.sc.indexOf("ctx::")&&(c="ctx::"),r.SecurityContext=c+encodeURIComponent(D.sc)}require(["DS/PlatformAPI/PlatformAPI"],function(e){e.publish("FolderEditor.ActiveFolderCallBack",{id:D.id,label:D.label})})}}}catch(e){null!=S&&(y=S.FolderID,r.SecurityContext=c+encodeURIComponent(t.SecurityContext))}null!=y&&(C+="&folderID="+y,b&&(C+="&activeFolder=true"));var E=UWA.Json.decode(f).type;if(null!=e.options.odtmode&&0!=e.options.odtmode||!l.getEnforceFolderLinkSetting()||null!=S&&null!=y||"component"!=E&&"assembly"!=E){null!=n&&(n.getHost(),n.getRootUri()),s.get3DSpaceUrlAsync({onComplete:function(e){var t=e+"/resources/v1/collabServices/authoring/op/createContent"+C;r["Accept-Language"]=widget.lang;var n=s.getTenantID();n&&0!=n.length?t+="&tenant="+n:t+="&tenant=OnPremise",o.authenticatedRequest(t,{type:"json",method:"POST",proxy:"passport",headers:r,timeout:36e5,data:f,onComplete:function(e){a._onCompleteCreation(e)},onFailure:function(e,t,n){p._endCreation(),p._setError(UWA.i18n("Failure during content creation"))},onTimeout:function(){p._endCreation(),p._setError(UWA.i18n("Timeout for content creation"))}})}})}else p._endCreation(),window.top.location.href.indexOf("ENOPRSU_AP")>-1||window.top.location.href.indexOf("ENOPSTR_AP")>-1?p._setError(UWA.i18n("ERROR_PIN_APP")):p._setError(UWA.i18n("ERROR_SELECT_FOLDER"))},_onCompleteCreation:function(t){p._endCreation();var i=new n(t);if("function"==typeof d.author)if(i.isSuccess()||i.isWarning()){i.isSuccess()&&p._setSuccess(UWA.i18n("Creation successful")),i.isWarning()&&p._setInfo(UWA.i18n("Creation successful")),i.isWarning()&&i.getMessage()&&p._setWarning(i.getMessage());var o=i.getPhysicalId();if(""!=o){if(d&&"function"==typeof d.insertNodes){if(!0===e.isInsert&&i.hasOwnProperty("instances")){d.author(!0);var r=[];i.instances.forEach(function(t){var n=t["to[VPMInstance].physicalid"],a=i.getAttributes();a.push({name:"instanceName",value:t.instanceName}),("component"==e.datas.type&&"undefined"!=e.datas.cadOriginType&&null!=e.datas.cadOriginType&&""!=e.datas.cadOriginType||"component"==e.datas.type&&e.isENONew)&&a.push({name:"relcount",value:"1"});var o=t.parentid;r.push({parent_id:o,children:[{relationid:n,attributes:a}]})}),d.insertNodes({inserted:r})}else if(!0===e.isInsert){var s=i.getRelationPhysicalId();d.author(!0);var l=i.getAttributes();"component"==e.datas.type&&"undefined"!=e.datas.cadOriginType&&null!=e.datas.cadOriginType&&""!=e.datas.cadOriginType&&l.push({name:"relcount",value:"1"}),d.insertNodes({inserted:[{parent_id:g,children:[{relationid:s,attributes:l}]}]})}else if(d.author(!0),a.isWorkspaceFolder(i.getType()))d.author(!0),d.addRoots({pids:[o]}),require(["DS/PADUtils/PADCommandProxy"],function(e){e.create().destroy()});else{l=i.getAttributes();("component"==e.datas.type&&"undefined"!=e.datas.cadOriginType&&null!=e.datas.cadOriginType&&""!=e.datas.cadOriginType||"component"==e.datas.type&&e.isENONew)&&l.push({name:"relcount",value:"1"}),d.insertNodes({created:[{attributes:l}]})}var c=i.getPhysicalIdsToRefresh();c.length>0&&require(["DS/PADUtils/PADCommandProxy"],function(e){var t=[];c.forEach(function(e){var n=[e.physicalid,o];t.push(n)});var n={authored:{connected:t}},i=e.create();i.authored({authored:!0}),i.refresh(n),i.destroy()})}}else p._setError(UWA.i18n("Warning : no physical id returned"))}else{var u=i.getMessage();if(null!=u)if("NoAccessToCreatePart"===u)u={level:"error",title:UWA.i18n("partCreationfailed"),subtitle:UWA.i18n("partCreationFailedSubtitle"),message:UWA.i18n("NoAccessToCreatePart")},f.display(u);else if(u.includes("ErrorCode:1501009"))u={level:"error",title:UWA.i18n("InvalidCSCreationfailed"),subtitle:UWA.i18n("InvalidCSCreationFailedSubtitle"),message:UWA.i18n("NoAccessToCS")},f.display(u);else{var h=UWA.i18n("creationfailed");!0===e.isInsert&&(h=UWA.i18n("insertionfailed")),u=h+UWA.i18n(u),p._setError(u)}else u=UWA.i18n("Failure during content creation"),p._setError(u)}}},g="",h=[];e.useSelectedNodes&&(u=d.getSelectedNodes());var m="";if(null!=u&&u.length>0){e.isInsert=!0,e.CurrentlabelWaitingCreation=UWA.i18n("Inserting "+e.labelWaitingCreation),e.disable();var v=[];if(u.forEach(function(e){v.hasOwnProperty(e.getID())||(v[e.getID()]=!0,h.push(e.getID()))}),"ENOPSTR_AP"==widget.getValue("x3dAppId")||"ENXENG_AP"==widget.getValue("x3dAppId")){var C=function(){p._endCreation()},S=function(e){p._setError(e),p._endCreation()},y=function(){e.chooseCadOriginTypeForNewObject(u,function(t,n,i,a,o,s){e.datas.cadOriginType=i,e.datas.title=n,e.datas.filename=a,e.datas.specializedtype=t,e.datas.attributes=o,e.datas.toupdate=s,d.beginBlockingTransaction(e.CurrentlabelWaitingCreation),p._launchThroughSecurityContext(null,!0,r)},C,S,p)};return void(u.length>1?e.warningMultiSelectionDialog(u,y,C,S):y())}if(null!=u&&u.length>1){m=UWA.i18n("Please select only one parent");p._endCreation(),p._setError(m)}else g=u[0].getID(),"ENOFOL3_AP"!=widget.getValue("x3dAppId")&&(e.datas.cadOriginType="V6",e.datas.title=""),d.beginBlockingTransaction(e.CurrentlabelWaitingCreation),p._launchThroughSecurityContext(null,!0,r)}else{if(e.isInsert=!1,e.CurrentlabelWaitingCreation=UWA.i18n("Creating "+e.labelWaitingCreation),e.disable(),"ENOPSTR_AP"==widget.getValue("x3dAppId")||"ENXENG_AP"==widget.getValue("x3dAppId"))return void e.showChooseCadOriginTypeDlg(void 0,function(t,n,i,a,o,s){e.datas.cadOriginType=i,e.datas.title=n,e.datas.filename=a,e.datas.specializedtype=t,e.datas.attributes=o,e.datas.toupdate=s,d.beginBlockingTransaction(e.CurrentlabelWaitingCreation),p._launchThroughSecurityContext(null,!0,r)},function(){p._endCreation()},function(t){e.datas.toupdate=!1,p._setError(t),p._endCreation()},p);"ENOFOL3_AP"!=widget.getValue("x3dAppId")&&(e.datas.cadOriginType="V6",e.datas.title=""),d.beginBlockingTransaction(e.CurrentlabelWaitingCreation),p._launchThroughSecurityContext(null,!0,r)}""!=m&&p._setError(m)})},getCadOriginsTypes:function(e,t,n){var i=[];e.forEach(function(e){var t=e.getID();i.push({objectId:t})});var a=widget.getValue("x3dPlatformId");this._post(a,"/resources/v1/collabServices/authoring/op/getCADOriginsTypes",{data:i},function(e){e.hasOwnProperty("result")?t(e.result):n(e)},function(e){n(e)})},set3DPartTemplate:function(e,t,n,i){var a=[];a.push({type:e,UUID:t});var o=this,r=widget.getValue("x3dPlatformId");o._post(r,"/resources/v1/collabServices/authoring/op/set3DPartTemplateExpression",{data:a},function(a){if(a.hasOwnProperty("result")){var r=o.datas.partTemplates;if(null!=r){var s=JSON.parse(r);Object.keys(s).forEach(function(n){s[n].type===e&&(s[n].current=t)}),o.datas.partTemplates=JSON.stringify(s)}n(a.result)}else i(a)},function(e){i(e)})},getTemplateNames:function(e,t,n){var i=e,a=(d=this).datas.Templates,o=d.datas.Specializedtypes,r=d.datas.CheckfilenameDisplay,s=d.datas.filenameStatus,l=d.datas.partTemplates;if(null==a){var c="/resources/v1/collabServices/authoring/op/getTemplatesNames",d=this,u=widget.getValue("x3dPlatformId"),p=e+"PSECreate";null==(f=localStorage.getItem(p))&&(f="undefined"),d._get(u,c,{templateType:i,objType:f},function(e){e.results?(d.datas.Templates=e.results,d.datas.CheckfilenameDisplay=e.CheckfilenameDisplay,d.datas.Specializedtypes=e.types,d.datas.filenameStatus=e.filenameStatus,d.datas.attributes=e.Attributes,d.datas.partTemplates=e.partTemplates,t(e.results,e.CheckfilenameDisplay,e.types,e.filenameStatus,e.Attributes,e.partTemplates)):n(e.errorMessage)},function(e){n(e)})}else{var f;c="/resources/v1/collabServices/authoring/op/getJSProxyNew",d=this,u=widget.getValue("x3dPlatformId"),p=e+"PSECreate";null==(f=localStorage.getItem(p))&&(f="undefined"),d._get(u,c,{Type:i,objType:f},function(e){d.datas.attributes=e.Attributes,t(a,r,o,s,e.Attributes,l)},function(e){n(e)})}},showChooseCadOriginTypeDlg:function(e,t,n,i,a,o){var r=this;if(this.isENONew)this.enoNew(e,a,o);else{var s=new u({closable:!0,resizable:!0,overlay:!0,title:r.labelTopBar,persistId:"newContentDim",className:"Lifecycle_Modals",events:{onShow:function(){this.dispatchEvent("onChooseTypeShown",s)}},renderTo:document.body}),l=r.datas;"drawing"!=l.type&&"assembly"!=l.type&&"component"!=l.type||r.getTemplateNames(l.type,function(a,o,c,d,u,p){var f=[];r._getavailableUPSData(e,function(e){for(var h=e,m="3DExperience",v=0;v<h.length;v++){if((b=h[v]).CAD==m){var C=g.getWebappsAssetUrl("ENOCollabSharingCmds","icons/3DEXPERIENCE.png");if("assembly"==l.type||"component"==l.type){m=UWA.i18n("3DExperience");var S="ProductTemplate";"component"==l.type&&(S="PartTemplate");var y={Connector:m,icon:C,label:"        "+m+" - "+UWA.i18n(S),value:r.CAD_ORIGIN_TYPE_V6};r._getpreferredCAD();f.push(y)}}}for(v=0;v<h.length;v++)for(var b=h[v],D=r._getavailableUPSChoice(b,a),E=0;E<D.length;E++)f.push(D[E]);var N=r._getexpectSingleCreationMode(),_=r._getsilentMode();if(_&&(1!=f.length&&(_=!1),function(e){var t=!0;if(null!=e){var n=JSON.parse(e);if(n.length>0)for(var i=n[0].attributes,a=i.length,o=0;o<a&&t;o++){var r=i[o],s=r.value;r.mandatory&&(null!=s&&""!==s||(t=!1))}}return t}(u)||(_=!1)),_){var A=(y=f[0]).value;t(null,void 0,A,null,u)}else{if(f.length){var P=l.type+"PSECreate",T=localStorage.getItem(P);s.displayPanel(UWA.i18n("Choose CAD authoring experience"),r.labelTopBar,T,c,f,o,d,N,u,p,function(e,a,o,s,l,c,d){null!=d?r.set3DPartTemplate(e,d,function(e){},function(e){i(e)}):null==o?(null!=e&&localStorage.setItem(P,e),r.datas.toupdate=c,n()):(localStorage.setItem(P,e),t(e,a,o,s,l,c))})}else{var w=UWA.i18n("notemplateavailable");i(w)}}},function(e){i(e)})},function(e){i(e)})}},warningMultiSelectionDialog:function(e,t,n,i){var a=UWA.i18n("warningMultiSelectionDialog Title"),o=UWA.i18n("warningMultiSelectionDialog Text");"drawing"==this.datas.type?(a=UWA.i18n("warningMultiSelectionDialog Title drawing"),o=UWA.i18n("warningMultiSelectionDialog Text drawing")):"component"==this.datas.type?(a=UWA.i18n("warningMultiSelectionDialog Title component"),o=UWA.i18n("warningMultiSelectionDialog Text component")):"assembly"==this.datas.type&&(a=UWA.i18n("warningMultiSelectionDialog Title assembly"),o=UWA.i18n("warningMultiSelectionDialog Text assembly"));var r=!0;new d({className:"Lifecycle_Modals",renderTo:document.body,events:{onHide:function(){r&&n()}}}).dialog({title:a,body:new UWA.Element("text",{text:o}),buttons:[{className:"primary",value:h.ok,action:function(e){r=!1,e.hide(),t()},name:"buttonOK"},{className:"default",value:h.ko,action:function(e){r=!1,e.hide(),n()},name:"buttonCancel"}]})},enoNew:function(e,t,n){var i="VPMReference";"drawing"===this.datas.type&&(i="Drawing");var a=UWA.i18n(this.datas.type),o=t.getContext().getSecurityContext(),r={SecurityContext:o?o.SecurityContext:""},c=t.getCAHeader();if(c)for(var d in c)r[d]=c[d];var u={tenant:o.tenant,header:r},p="PSECreate_prefType_"+o.tenant+"_"+this.datas.type,f=localStorage.getItem(p),g=[];e&&e.forEach(function(e){var t=e;"V5"===e?t="CATIAV5":"SW"===e?t="SOLIDWORKS":"CR"===e?t="CREO":"IV"===e?t="INVENTOR":"AD"===e?t="AUTOCAD":"SE"===e&&(t="SOLIDEDGE"),g.push(t)});var h=t._getCurrentFolder(),m=[],v=!1;null!=h&&(m[0]=h.FolderID);try{if(void 0!==l.getActiveFolder){var C=l.getActiveFolder();"folder"!==(S=this.datas.type)&&null!==C.id&&void 0!==C.id&&""!==C.id&&(m[0]=C.id,v=!0,require(["DS/PlatformAPI/PlatformAPI"],function(e){e.publish("FolderEditor.ActiveFolderCallBack",{id:C.id,label:C.label})}))}}catch(e){null!=h&&(m[0]=h.FolderID)}var S=this.datas.type;if(null!=this.options.odtmode&&0!=this.options.odtmode||!l.getEnforceFolderLinkSetting()||null!=h&&null!=m||"component"!=S&&"assembly"!=S){var y=this._getsilentMode();(new s).CreateNew({id:p,context:u,type:i,silentMode:y,labelTopBar:this.labelTopBar,commandName:a,responseFormat:1,options:{parentOrigin:g,preferedType:f,typeName:this.datas.type,parentPIDs:n,folderID:m,activeFolder:v,select:["type","physicalid","cestamp"]},events:{onSuccess:function(e){if("success"===e.status)if(e.parsedResult){var n=JSON.parse(e.parsedResult);t._onCompleteCreation(n)}else t._endCreation();else t._endCreation()},onFailure:function(e){t._endCreation()},onCancel:function(e){if(e&&e.preferedType){var n=e.preferedType;localStorage.setItem(p,n)}t._endCreation()}}})}else t._endCreation(),window.top.location.href.indexOf("ENOPRSU_AP")>-1||window.top.location.href.indexOf("ENOPSTR_AP")>-1?t._setError(UWA.i18n("ERROR_PIN_APP")):t._setError(UWA.i18n("ERROR_SELECT_FOLDER"))},chooseCadOriginTypeForNewObject:function(e,t,n,i,a){var o=this,r=!0,s=[];if(e.forEach(function(e){if(e.options.padgrid){s.push(e.getID());var t=e.options.padgrid;if(t&&"ds6w:Part"==t["ds6w:globalType"])return}r=!1}),r)o.getCadOriginsTypes(e,function(e){o.datas;var r=e.cadOrigintypes,l=e.V_usages,c=!1;l.forEach(function(e){"3DPart"==e&&(c=!0)});var d="";if(r.length>0&&(d=r[0]),r.forEach(function(e){d!=e&&(d=o.CAD_ORIGIN_MIX)}),d==o.CAD_ORIGIN_MIX&&(d=o.CAD_ORIGIN_TYPE_V5),c){var u=UWA.i18n("Error :")+UWA.i18n("Can not insert multiselection case");i(u)}else o.showChooseCadOriginTypeDlg(r,t,n,i,a,s)},function(e){i(e)});else{var l=e[0].options.type;"3DShape"===l&&(l="Part");var c={level:"error",title:m.Multipleselectionerror+" "+l};f.display(c)}},endExecute:function(){},_setCommandEnableStatus:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){var n=t.get();null!=n&&"function"==typeof n.getEditMode&&(!0!==t.get().getEditMode()&&e.disable(),t.get().addEvent("editModeModified",function(t){!0===t?e.enable():e.disable()}))})},_getavailableUPSData:function(e,t,n){var i=this,a=i._getpreferredCAD(),o=!1;if(void 0!==e){var r="";if(e.forEach(function(e){r+=e}),""!==r){var s=!1;i.currentPreferredCAD!==a&&(s=!0);var l=i.datas[r];void 0===l||s||(o=!0,t(l))}}if(i.currentPreferredCAD=a,!o){var c=widget.getValue("x3dPlatformId");i._get(c,"/resources/v1/collabServices/authoring/op/getInsertableCADS",{parentCADOrigins:e},function(o){if(o.results){var r="";void 0!==e&&e.forEach(function(e){r+=e});var s,l=o.results;if(null!=a&&a.length>0)for(var c=0;c<l.length;c++)if(l[c].CAD==a){var d=new Array;d.push(l[c]),s=d}null==s&&(s=l),i.datas[r]=s,t(s)}else n(o.errorMessage)},function(e){n(e)})}},_getavailableUPSChoice:function(e,t){var n=[],i=e.CAD,a=e.prefix,o="icons/"+e.icon+".png",r=UWA.i18n(a),s=g.getWebappsAssetUrl("ENOCollabSharingCmds",o),l=this._getpreferredCAD(),c=this._getpreferredTemplate(a);return t.forEach(function(e){var t=e.fileName,o=t;if(1==t.startsWith(a)){var d=t=t.substring(a.length,t.length);t.includes("Default Assembly")?d="Default Assembly":t.includes("Assembly")&&!t.includes("Default Assembly")?d="Assembly":t.includes("Part")&&!t.includes("PartTemplate")?d="Part":t.includes("ProductTemplate")?d="ProductTemplate":t.includes("PartTemplate")?d="PartTemplate":t.includes("Default Drawing")?d="Default Drawing":!t.includes("Drawing")||t.includes("Default Drawing")||t.includes("DrawingISOA0PortaitTemplate")||t.includes("DrawingISOA0LandscapeTemplate")||(d="Drawing");var u=UWA.i18n(d),p=t.replace(d,u),f={Connector:r,icon:s,label:"        "+r+" - "+p,value:o};null!=c?c==t&&n.push(f):null!=l?l==i&&n.push(f):n.push(f)}}),n},_getsilentMode:function(){var e=!1,t=this._getpreferredCAD();return null!=t&&t.length>0&&(e=!0),e},_getexpectSingleCreationMode:function(){var e=!1,t=this.datas.expectSingleCreation;return null!=t&&(e=t),e},_getpreferredCAD:function(){return this.datas.preferredCAD},_getpreferredTemplate:function(e){return this.datas.preferredTemplate},_get:function(t,n,a,r,s){var d=this;require(["DS/PADUtils/PADContext"],function(u){var p;null!=u&&(p=u.get()),null==p&&(p=d.options.context);var f=Date.now().toString();a["timestamp"+f]=f;var g={context:p};i.getInstance(g).getSecurityContext({onSuccess:function(e){var i=e.SecurityContext;"ctx::"!=i&&""!=i||p&&"function"==typeof p.getSecurityContext&&(i=p.getSecurityContext().SecurityContext);var d=l.get3DSpaceWSUrl(t,n,null);for(var u in-1!=d.indexOf("?")?d+="&":d+="?",a){var f=a[u];f instanceof Array?f.forEach(function(e){d+=u+"="+e+"&"}):d+=u+"="+f+"&"}o.authenticatedRequest(d,{method:"GET",headers:l.getHeaders(encodeURIComponent(i)),timeout:864e5,type:"json",onComplete:function(e){r(e)},onFailure:function(e,t){c.onWebServiceError(s,e,t)},onTimeout:function(){c.onWebServiceError(s,null,NLS.timeout)}})},onFailure:function(t){privateMethods._endCreation(),c.onWebServiceError(s,null,e)}})})},_post:function(t,n,a,r,s){var d=this;require(["DS/PADUtils/PADContext"],function(u){var p;null!=u&&(p=u.get()),null==p&&(p=d.options.context);var f=JSON.stringify(a),g={context:p};i.getInstance(g).getSecurityContext({onSuccess:function(e){var i=e.SecurityContext;"ctx::"!=i&&""!=i||p&&"function"==typeof p.getSecurityContext&&(i=p.getSecurityContext().SecurityContext);var a=l.get3DSpaceWSUrl(t,n,null);o.authenticatedRequest(a,{method:"POST",headers:l.getHeaders(encodeURIComponent(i)),timeout:864e5,data:f,type:"json",onComplete:function(e){r(e)},onFailure:function(e,t){c.onWebServiceError(s,e,t)},onTimeout:function(){c.onWebServiceError(s,null,NLS.timeout)}})},onFailure:function(t){privateMethods._endCreation(),c.onWebServiceError(s,null,e)}})})}})}),define("DS/ENOCollabSharingCmds/commands/NewCmd/ActionBar_InsertNewPartCmd",["DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/NewCmd/NewCommandBase"],function(e,t){"use strict";return t.extend({labelTopBar:UWA.i18n("New part"),labelWaitingCreation:"new part",activeTopBar:!1,isInsert:!0,datas:{type:"component"},init:function(e){this._parent(e,{isAsynchronous:!0})},beginExecute:function(){this._parent()},endExecute:function(){this._parent()},_setCommandEnableStatus:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){var n=t.get();if(null!=n){!0!==t.get().getEditMode()&&e.disable(),t.get().addEvent("editModeModified",function(t){if(!0===t){var i=n.getSelectedNodes(),a=!0;null!=i&&i.length>=1&&i.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(a=!1)}),a?e.enable():e.disable()}else e.disable()});var i=n.options.model;null!=i&&(i.getXSO().onPostAdd(function(){if(!0===t.get().getEditMode()){var i=n.getSelectedNodes(),a=!0;null!=i&&i.length>=1?(i.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(a=!1)}),a?e.enable():e.disable()):e.disable()}}),i.getXSO().onPostRemove(function(){if(!0===t.get().getEditMode()){var i=n.getSelectedNodes(),a=!0;null!=i&&i.length>=1?(i.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(a=!1)}),a?e.enable():e.disable()):e.disable()}}),i.getXSO().onEmpty(function(){if(!0===t.get().getEditMode()){var i=n.getSelectedNodes(),a=!0;null!=i&&i.length>=1?(i.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(a=!1)}),a?e.enable():e.disable()):e.disable()}}))}})}})}),define("DS/ENOCollabSharingCmds/commands/NewCmd/ActionBar_NewDrawingCmd",["DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/NewCmd/NewCommandBase"],function(e,t){"use strict";return t.extend({labelTopBar:UWA.i18n("New drawing"),labelWaitingCreation:"new drawing",datas:{type:"drawing"},init:function(e){this._parent(e,{isAsynchronous:!0});var t=(new Date).getTime();this.datas.PLM_ExternalID="prd"+t,this._setDrwCommandEnableStatus()},beginExecute:function(){this._parent()},execute:function(){var e,t=this.getArguments();if(t&&t.length){for(var n=0;n<t.length;n++)"Mode"===t[n].ID&&(e=t[n].Value);if("ForceNew"===e)require("DS/PADUtils/PADContext").get().getPADTreeDocument().unselectAll()}this._parent()},endExecute:function(){this._parent()},_setCommandEnableStatus:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){var n=t.get();null!=n&&(!0!==t.get().getEditMode()&&e.disable(),t.get().addEvent("editModeModified",function(t){if(!0===t){var i=n.getSelectedNodes(),a=!0;null!=i&&i.length>=1&&i.forEach(function(e){var t=e.options.grid["ds6w:cadMaster"];t&&t.contains("CATIAV5")&&(a=!1)}),a?e.enable():e.disable()}else e.disable()}))})},_setDrwCommandEnableStatus:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){var n=t.get();if(null!=n){var i=n.options.model;null!=i&&(i.getXSO().onPostAdd(function(){if(!0===n.getEditMode()){var t=n.getSelectedNodes(),i=!0;null!=t&&t.length>=1?(t.forEach(function(e){var t=e.options.grid["ds6w:cadMaster"];t&&(t.contains("CATIAV5")||t.contains("SOLIDWORKS")||t.contains("INVENTOR")||t.contains("SOLIDEDGE"))&&(i=!1)}),i?e.enable():e.disable()):e.enable()}else e.disable()}),i.getXSO().onPostRemove(function(){if(!0===n.getEditMode()){var t=n.getSelectedNodes(),i=!0;null!=t&&t.length>=1?(t.forEach(function(e){var t=e.options.grid["ds6w:cadMaster"];t&&(t.contains("CATIAV5")||t.contains("SOLIDWORKS"))&&(i=!1)}),i?e.enable():e.disable()):e.enable()}else e.disable()}),i.getXSO().onEmpty(function(){if(!0===n.getEditMode()){var t=n.getSelectedNodes(),i=!0;null!=t&&t.length>=1?(t.forEach(function(e){var t=e.options.grid["ds6w:cadMaster"];t&&(t.contains("CATIAV5")||t.contains("SOLIDWORKS"))&&(i=!1)}),i?e.enable():e.disable()):e.enable()}else e.disable()}))}})}})}),define("DS/ENOCollabSharingCmds/commands/NewCmd/ActionBar_InsertNewDrawingCmd",["DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/NewCmd/NewCommandBase"],function(e,t){"use strict";return t.extend({labelTopBar:UWA.i18n("New drawing"),labelWaitingCreation:"new drawing",activeTopBar:!1,datas:{type:"drawing"},init:function(e){this._parent(e,{isAsynchronous:!0});var t=(new Date).getTime();this.datas.PLM_ExternalID="prd"+t},beginExecute:function(){this._parent()},endExecute:function(){this._parent()},_setCommandEnableStatus:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){var n=t.get();if(null!=n){!0!==t.get().getEditMode()&&e.disable(),t.get().addEvent("editModeModified",function(t){if(!0===t){var i=n.getSelectedNodes(),a=!0;null!=i&&i.length>=1&&i.forEach(function(e){var t=e.options.grid["ds6w:cadMaster"];t&&t.contains("CATIAV5")&&(a=!1)}),a?e.enable():e.disable()}else e.disable()});var i=n.options.model;null!=i&&(i.getXSO().onPostAdd(function(){if(!0===t.get().getEditMode()){var i=n.getSelectedNodes(),a=!0;null!=i&&i.length>=1?(i.forEach(function(e){var t=e.options.grid["ds6w:cadMaster"];t&&(t.contains("CATIAV5")||t.contains("SOLIDWORKS")||t.contains("INVENTOR")||t.contains("SOLIDEDGE"))&&(a=!1)}),a?e.enable():e.disable()):e.disable()}}),i.getXSO().onPostRemove(function(){if(!0===t.get().getEditMode()){var i=n.getSelectedNodes(),a=!0;null!=i&&i.length>=1?(i.forEach(function(e){var t=e.options.grid["ds6w:cadMaster"];t&&(t.contains("CATIAV5")||t.contains("SOLIDWORKS"))&&(a=!1)}),a?e.enable():e.disable()):e.disable()}}),i.getXSO().onEmpty(function(){if(!0===t.get().getEditMode()){var i=n.getSelectedNodes(),a=!0;null!=i&&i.length>=1?(i.forEach(function(e){var t=e.options.grid["ds6w:cadMaster"];t&&(t.contains("CATIAV5")||t.contains("SOLIDWORKS"))&&(a=!1)}),a?e.enable():e.disable()):e.disable()}}))}})}})}),define("DS/ENOCollabSharingCmds/commands/NewCmd/ActionBar_NewPartCmd",["DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/NewCmd/NewCommandBase"],function(e,t){"use strict";return t.extend({labelTopBar:UWA.i18n("New part"),labelWaitingCreation:"new part",datas:{type:"component"},init:function(e){this._parent(e,{isAsynchronous:!0}),this._setPartCommandEnableStatus()},beginExecute:function(){this._parent()},execute:function(){var e,t=this.getArguments();if(t&&t.length){for(var n=0;n<t.length;n++)"Mode"===t[n].ID&&(e=t[n].Value);if("ForceNew"===e)require("DS/PADUtils/PADContext").get().getPADTreeDocument().unselectAll()}this._parent()},endExecute:function(){this._parent()},_setCommandEnableStatus:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){var n=t.get();null!=n&&(!0!==t.get().getEditMode()&&e.disable(),t.get().addEvent("editModeModified",function(t){if(!0===t){var i=n.getSelectedNodes(),a=!0;null!=i&&i.length>=1&&i.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(a=!1)}),a?e.enable():e.disable()}else e.disable()}))})},_setPartCommandEnableStatus:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){var n=t.get();if(null!=n){var i=n.options.model;null!=i&&(i.getXSO().onPostAdd(function(){if(!0===n.getEditMode()){var t=n.getSelectedNodes(),i=!0;null!=t&&t.length>=1?(t.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(i=!1)}),i?e.enable():e.disable()):e.enable()}else e.disable()}),i.getXSO().onPostRemove(function(){if(!0===n.getEditMode()){var t=n.getSelectedNodes(),i=!0;null!=t&&t.length>=1?(t.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(i=!1)}),i?e.enable():e.disable()):e.enable()}else e.disable()}),i.getXSO().onEmpty(function(){if(!0===n.getEditMode()){var t=n.getSelectedNodes(),i=!0;null!=t&&t.length>=1?(t.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(i=!1)}),i?e.enable():e.disable()):e.enable()}else e.disable()}))}})}})}),define("DS/ENOCollabSharingCmds/commands/NewCmd/ActionBar_NewFolderCmd",["DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/NewCmd/NewCommandBase"],function(e,t){"use strict";return t.extend({labelTopBar:UWA.i18n("New folder"),labelWaitingCreation:"new folder",isInsert:!0,useSelectedNodes:!1,datas:{type:"folder"},init:function(e){this._parent(e,{isAsynchronous:!0})},beginExecute:function(){this._parent()},endExecute:function(){this._parent()}})}),define("DS/ENOCollabSharingCmds/commands/NewCmd/ActionBar_InsertNewProductCmd",["DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/NewCmd/NewCommandBase"],function(e,t){"use strict";return t.extend({labelTopBar:UWA.i18n("New product"),labelWaitingCreation:"new product",activeTopBar:!1,isInsert:!0,datas:{type:"assembly"},init:function(e){this._parent(e,{isAsynchronous:!0});var t=(new Date).getTime();this.datas.PLM_ExternalID="prd"+t},beginExecute:function(){this._parent()},endExecute:function(){this._parent()},_setCommandEnableStatus:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){var n=t.get();if(null!=n){!0!==t.get().getEditMode()&&e.disable(),t.get().addEvent("editModeModified",function(t){if(!0===t){var i=n.getSelectedNodes(),a=!0;null!=i&&i.length>=1&&i.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(a=!1)}),a?e.enable():e.disable()}else e.disable()});var i=n.options.model;null!=i&&(i.getXSO().onPostAdd(function(){if(!0===t.get().getEditMode()){var i=n.getSelectedNodes(),a=!0;null!=i&&i.length>=1?(i.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(a=!1)}),a?e.enable():e.disable()):e.disable()}}),i.getXSO().onPostRemove(function(){if(!0===t.get().getEditMode()){var i=n.getSelectedNodes(),a=!0;null!=i&&i.length>=1?(i.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(a=!1)}),a?e.enable():e.disable()):e.disable()}}),i.getXSO().onEmpty(function(){if(!0===t.get().getEditMode()){var i=n.getSelectedNodes(),a=!0;null!=i&&i.length>=1?(i.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(a=!1)}),a?e.enable():e.disable()):e.disable()}}))}})}})}),define("DS/ENOCollabSharingCmds/commands/NewCmd/ActionBar_NewProductCmd",["DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/NewCmd/NewCommandBase"],function(e,t){"use strict";return t.extend({labelTopBar:UWA.i18n("New product"),labelWaitingCreation:"new product",datas:{type:"assembly"},init:function(e){this._parent(e,{isAsynchronous:!0});var t=(new Date).getTime();this.datas.PLM_ExternalID="prd"+t,this._setPrdCommandEnableStatus()},beginExecute:function(){this._parent()},endExecute:function(){this._parent()},execute:function(){var e,t=this.getArguments();if(t&&t.length){for(var n=0;n<t.length;n++)"Mode"===t[n].ID&&(e=t[n].Value);if("ForceNew"===e)require("DS/PADUtils/PADContext").get().getPADTreeDocument().unselectAll()}this._parent()},_setCommandEnableStatus:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){var n=t.get();null!=n&&(!0!==t.get().getEditMode()&&e.disable(),t.get().addEvent("editModeModified",function(t){if(!0===t){var i=n.getSelectedNodes(),a=!0;null!=i&&i.length>=1&&i.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(a=!1)}),a?e.enable():e.disable()}else e.disable()}))})},_setPrdCommandEnableStatus:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){var n=t.get();if(null!=n){var i=n.options.model;null!=i&&(i.getXSO().onPostAdd(function(){if(!0===n.getEditMode()){var t=n.getSelectedNodes(),i=!0;null!=t&&t.length>=1?(t.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(i=!1)}),i?e.enable():e.disable()):e.enable()}else e.disable()}),i.getXSO().onPostRemove(function(){if(!0===n.getEditMode()){var t=n.getSelectedNodes(),i=!0;null!=t&&t.length>=1?(t.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(i=!1)}),i?e.enable():e.disable()):e.enable()}else e.disable()}),i.getXSO().onEmpty(function(){if(!0===n.getEditMode()){var t=n.getSelectedNodes(),i=!0;null!=t&&t.length>=1?(t.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(i=!1)}),i?e.enable():e.disable()):e.enable()}else e.disable()}))}})}})}),define("DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ChangeCommandBase",["UWA/Class","DS/ApplicationFrame/Command","DS/LifecycleServices/LifecycleServicesSettings","DS/ENOCollabSharingCmds/commands/CommandAvailableOnSelect","DS/WidgetServices/securityContextServices/SecurityContextServices","DS/ENOCollabSharingCmds/Services/CommandServices","i18n!DS/ENOCollabSharingCmds/assets/nls/langSharingCmds"],function(e,t,n,i,a,o,r){"use strict";return e.extend(t,i,{transferType:"full",genericTransfer:!1,init:function(e){var t=!1;void 0!==typeof e&&null!==e&&e.hasOwnProperty("odtMode")&&(t=e.odtmode),t||this._setCommandEnableStatus(),this.options=e,this._parent(e,{isAsynchronous:!0}),this.transferOwnershipPanel=null,this._isMaterialDomain=!1,this._unsupportedTypes=[]},beginExecute:function(){},execute:function(){var e=this,t={};require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"],function(e){if(e)try{var n=e.get();t={"DS-Change-Authoring-Context":n.AuthoringContextHeader?n.AuthoringContextHeader["DS-Change-Authoring-Context"]:null,"DS-Configuration-Authoring-Context":n.AuthoringContextHeader?n.AuthoringContextHeader["DS-Configuration-Authoring-Context"]:null}}catch(e){console.log("Change action is empty"),t=null}}),require(["DS/WidgetServices/WidgetServices","DS/TransferOwnershipWidget/TransferOwnershipConstant","DS/TransferOwnershipWidget/popup/TransferOwnershipPopup","DS/ENOCollabSharingCmds/BaseModels/ResultElement","DS/Selection/CSOManager","DS/PADUtils/PADContext","DS/ENOCollabSharingCmds/Services/CommandServices","DS/LifecycleServices/LifecycleServices"],function(i,a,o,s,l,c,d,u){e._unsupportedTypes=[];var p=c.get();e.options.context&&(p=e.options.context),null==p&&(p=e.options.context),null===e.options.context&&null!==p&&(e.options.context=p);var f={context:p},g="";g="owner"==e.transferType?a.TransferPerson:"CS"==e.transferType?a.TransferCollabSpace:a.TransferFull;var h=[],m={},v=l.get();if(v.length>0)v.forEach(function(e){e.hasOwnProperty("isResultElement")&&(e.setCategory(""),h.push(e))});else{var C=p.getSelectedNodes();C.length&&C.forEach(function(t){var a=t.getID(),o=(t.getLabel(),null);t.getType&&"function"==typeof t.getType&&(o=t.getType());var r="",l="",c=null,u=null,p=null,f=null;if(t.options)o=t.options.type,r=t.options.grid["ds6w:type"],l=t.options.subLabel,t.options.hasOwnProperty("grid")&&null!=t.options.grid&&(c=t.options.grid["ds6wg:revision"],l=t.options.grid["ds6wg:responsible"]);else if(t.object){if(l=t.object.ownerFullName,c=t.object.revision,r=t.object.type,0===a.indexOf("cid:")&&(f=t.object.branch),o=t.object.type,null!=t.object.options&&null!=t.object.options.icons&&t.object.options.icons.length>0)null===(D=t.object.options.icons[0])?t.object.options.icons.length>1&&(D=t.object.options.icons[1]):u="object"==typeof D?D:D.length&&D.indexOf("http")<0?n.get3DSpaceBaseUrl(i.getTenantID())+D:D,r=t.object.options["ds6w:type"]}if(null!=l&&null!=l||t.options&&(l=t.options.grid["ds6w:responsible"]),null!==a){var g="";"function"==typeof t.getRelationID&&(g=t.getRelationID());var v="",C="";if(null!==t&&null!==t.getParent&&"function"==typeof t.getParent){var S=t.getParent();null!==S&&null!==S.getID&&"function"==typeof S.getID&&(v=S.getID(),C=S.options.grid["ds6w:cadMaster"])}var y=null;if(null!=t&&null!=t.options&&null!=t.options.grid&&(y=t.options.grid["ds6w:cadMaster"]),null==u&&null!=t&&null!=t.options&&null!=t.options.icons&&t.options.icons.length>0){if(t.options.icons.length>0)for(var b=0;b<t.options.icons.length;b++){if(t.options.icons[b].hasOwnProperty("iconPath")){p=t.options.icons[b].iconPath;break}if(null!=t.options.icons[b]){p=t.options.icons[b];break}}if(null!==p)if("object"!=typeof p&&-1!=p.indexOf("url"))u=p.replace("url(","").replace(")","");else u=p}var D,E=new s({urlIcon:u,physicalId:a,name:t.getLabel(),title:t.getLabel(),category:"bus",type:o,typeDisplayName:r,relID:g,parentID:v,cadMaster:y,parentCADMaster:C,responsibleName:l,Revision:c,branch:f});if(null!=o&&null!=o)1==(D=d.isMaterialDomain(o))&&(e._isMaterialDomain=D,e._unsupportedTypes.includes(r)||e._unsupportedTypes.push(r));h.push(E),m[E.physicalId]=E}})}if(h.length>0){var S=!1;void 0!==typeof e.options&&null!==e.options&&e.options.hasOwnProperty("odtmode")&&(S=e.options.odtmode),0==S&&n.app_initialization(function(){d.allAggregated3DShape(h,function(e){})})}n.app_initialization(function(){var n=widget.getValue("x3dPlatformId"),i=Object.keys(m);u.listAttributes(n,i,["attribute[PLMEntity.V_usage]","attribute[XCADEmbeddedCmp.V_IsEmbeddedComponent]","physicalid","owner","revision","attribute[PLMCoreRepReference.V_isOnceInstantiable]","attribute[Marketing Name]","organization","organization.property[Title].value","project","type","displayType","project.property[Title].value","branch"],function(n){for(var a=0,l=0,c=0;c<n.results.length;c++){var d=n.results[c],u=d.objectId||d.physicalid,v=m[u],C="3DPart"==d["attribute[PLMEntity.V_usage]"]&&"3DShape"!=d.type;null===d["attribute[XCADEmbeddedCmp.V_IsEmbeddedComponent]"]?v.v_IsEmbeddedComponent=0:(v.v_IsEmbeddedComponent=1,a++);var S;1==(S="3DPart"==d["attribute[PLMEntity.V_usage]"]&&"3DShape"==d.type)&&l++,v.aggrObj=S,v.Revision=d.revision,v.organization=d.organization,null==v.type&&(v.type=d.type),null==d["organization.property[Title].value"]||""===d["organization.property[Title].value"]?v.organizationTitle=d.organization:v.organizationTitle=d["organization.property[Title].value"],v.project=d.project,null===d["project.property[Title].value"]||""===d["project.property[Title].value"]?v.projectTitle=d.project:v.projectTitle=d["project.property[Title].value"],v.owner=d.owner,v.responsibleName||(v.responsibleName=d.ownerFullName),v.typeDisplayName||(v.typeDisplayName=d.displayType),1==S&&(e._unsupportedTypes.includes(v.typeDisplayName)||e._unsupportedTypes.push(v.typeDisplayName)),C&&(v.typeDisplayName=r["3DPart"])}if(a==i.length)return e._setError(r.selectOwning),void e.end();if(l==i.length){var y=r.replace(r.errorMatRefMoveCmdErrorMessage,{dispType:e._unsupportedTypes});return e._setError(y),e.end(),void(e._unsupportedTypes=[])}e.getSecurityContext(function(n){if(e.transferOwnershipPanel)e.transferOwnershipPanel.setSecurityContext(n),e.transferOwnershipPanel.show(h,t),e.transferOwnershipPanel.container.centerIt();else if(h.length>0){var i=h[0];if(i=new s(i),e._unsupportedTypes.length>0){var a=r.replace(r.errorMatRefMoveCmdErrorMessage,{dispType:e._unsupportedTypes});return e._setError(a),void e.end()}e.transferOwnershipPanel=new o(widget.body,{className:e.className,context:p,transferType:g,serverName:i.getServerHost(),serverUri:i.getServerUri(),activeDnD:!0,activeOptions:!0,activeAdminCheckBox:widget.getBool("admin"),activeSummaryButton:!0,genericTransfer:e.genericTransfer,securityContext:n,events:{onClose:function(){e.transferOwnershipPanel=null}}}),e.transferOwnershipPanel.show(h,t)}else e._setError(UWA.i18n("no content selected"))},function(){e._setError(UWA.i18n("Fail to get security context"))},f),e.end()})})})},getSecurityContext:function(e,t,n){a.getInstance(n).getSecurityContext({onSuccess:function(n){if(null!=n&&""!=n&&n.hasOwnProperty("SecurityContext")&&null!=n.SecurityContext){var i="";0!=n.SecurityContext.indexOf("ctx::")&&(i="ctx::");var a=i+n.SecurityContext;e(a)}else t()},onFailure:function(e){t()}})},_setError:function(e){if("function"==typeof this.options.context.displayNotification){var t={eventID:"error",msg:e};this.options.context.displayNotification(t)}else alert(e)},endExecute:function(){},_setCommandEnableStatus:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){var n=0;null!=t.get()&&(null!=t.get().getEditMode&&!0!==t.get().getEditMode()&&(n=0),1===n?e.enable():e.disable(),t.get().addEvent("editModeModified",function(t){!0===t?e.enable():e.disable()}))})}})}),define("DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ActionBar_TransferOwnershipCmd",["DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ChangeCommandBase"],function(e){"use strict";return e.extend({transferType:"owner",genericTransfer:!0,className:"changeOwnership_popup_fromCmd",init:function(e){this._parent(e,{isAsynchronous:!0})},beginExecute:function(){this._parent()},endExecute:function(){this._parent()}})}),define("DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ActionBar_ChangeOwnerCmd",["DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ChangeCommandBase"],function(e){"use strict";return e.extend({transferType:"full",genericTransfer:!0,className:"changeOwner_popup_fromCmd",init:function(e){this._parent(e,{isAsynchronous:!0})},beginExecute:function(){this._parent()},endExecute:function(){this._parent()}})}),define("DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ActionBar_ChangeCSCmd",["DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ChangeCommandBase"],function(e){"use strict";return e.extend({transferType:"CS",className:"changeCollabSpace_popup_fromCmd",init:function(e){this._parent(e,{isAsynchronous:!0})},beginExecute:function(){this._parent()},endExecute:function(){this._parent()}})});