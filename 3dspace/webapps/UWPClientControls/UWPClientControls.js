define("DS/UWPClientControls/Column",["UWA/Core","UWA/Utils","UWA/Controls/Abstract"],function(t,e,i){"use strict";function n(t,e){var i,n,s,o,a,r=0,l=0,h=0,c=[],d=[],u=[];for(i=0,n=t.length;i<n;i++){if(void 0===(s=t[i]).size){c=[];break}if(a=/^[0-9\.]+%$/i.test(s.size),"number"==typeof s.size||a){if(o=parseFloat(s.size),isNaN(o)){c=[];break}a?(d.push(i),h+=o):r+=o,c.push(o)}else{if(!/^[0-9\.]+px$/i.test(s.size)){c=[];break}u.push(i)}}if(c.length>0){for(i=0,n=c.length;i<n;i++)u.indexOf(i)<0&&d.indexOf(i)<0&&0!==c[i]&&(c[i]=Math.round(c[i]*(100-h)/r),l+=c[i]);for(l+=h,i=0;i<n;i++)if(u.indexOf(i)<0&&!t[i].force){c[i]+=100-l;break}if(e)for(i=0;0!==e;)void 0!==c[i]?(c[i]>2&&u.indexOf(i)<0&&!t[i].force&&(c[i]+=-1,e--),i++>c.length&&(i=0)):(c=[],e=0)}return c}return i.extend({defaultOptions:{className:"",classNames:{column:"wp-col"},gutter:"",offset:0,items:[{size:1},{size:1},{size:1}]},init:function(e){var i,s,o=0;if(this._parent(e),void 0===e||t.is(this.options.items,"array")){for(this.columns=[],i=(s=n(this.options.items,this.options.offset)).length;o<i;o++)s[o]={width:s[o]},t.merge(s[o],this.options.items[o]);this._buildSkeleton(s)}},add:function(e){var i,n=0;if(t.is(e,"array"))for(i=e.length;n<i;n++)e[n]=this._addColumn(e[n]);else e=this._addColumn(e);return e},remove:function(e){var i,n=0;if(t.is(e,"array"))for(i=e.length;n<i;n++)this._removeColumn(e[n]);else this._removeColumn(e)},update:function(e,i){var s,o,a,r,l;i=void 0===i||i;if(t.is(e,"array")&&e.length===this.columns.length?s=e:e.size&&e.position&&this.columns[e.position-1]&&(this.columns[e.position-1].size=e.size,s=this.columns),s)for(a=n(s,this.options.offset),r=0,l=this.columns.length;r<l;r++)(o=this.columns[r]).width=a[r],o.body&&i&&o.body.setStyle("width",o.width+"%")},setOffset:function(t){t=parseInt(t,10),isNaN(t)||this.options.offset!==t&&(this.options.offset=t,this.update(this.columns))},get:function(t){return this.columns[t]},_addColumn:function(e,i){var n=this.columns;return(void 0===e.position||e.position>n.length)&&(e.position=n.length),n.splice(e.position,0,e),i||this.update(n),e.body=t.createElement("div"),this.options.gutter&&e.body.setStyles({paddingLeft:this.options.gutter,paddingRight:this.options.gutter}),e.body.setStyles(e.styles),e.className=void 0!==e.className?e.className:"",e.body.addClassName(this.options.classNames.column+" "+e.className),e.body.setStyle("width",e.width+"%"),e.position===n.length-1?(e.body.inject(this.elements.container),e.body.addClassName("last"),e.position>0&&e.position===n.length-1&&n[e.position-1].body.removeClassName("last")):e.body.inject(n[e.position-1].body,"after"),e},_removeColumn:function(t){var e=this.columns,i=e[t];return i&&(i.body.destroy(),e.splice(t,1)),this.update(e),i},_buildSkeleton:function(e){var i,n,s=this.options;for(s.element?(this.elements.container=t.extendElement(s.element),delete s.element):this.elements.container=document.createDocumentFragment(),s.className&&this.elements.container.addClassName(s.className),s.styles&&this.elements.container.setStyles(s.styles),i=0,n=e.length;i<n;i++)this._addColumn(e[i],!0)},inject:function(t,e){var i=this.getContent();return i&&(this.dispatchEvent("onPreInject",[t]),t.grab(i,e),this.elements.container=t,this.dispatchEvent("onPostInject",[t]),this.dispatchEvent("onResize",[t])),this}})}),define("DS/UWPClientControls/Draggable",["UWA/Core","UWA/Class","UWA/Element","UWA/Utils","UWA/Event"],function(t,e,i,n,s){"use strict";var o=function(t){var e=!1;try{e=t instanceof TouchEvent}catch(t){}return e},a={disabled:!1,defaultOptions:{ignoreDragging:["INPUT","TEXTAREA","SELECT","BUTTON"],items:"",limit:!1,distance:10,delay:300,movePlayer:!0,textSelection:!0,autoscroll:!1,area:50,offset:{left:0,top:0}},init:function(e){this.options=t.extend(t.clone(this.defaultOptions),e,!0),this.container=this.options.container,this.handleEvents()},handleEvents:function(){this.eventNames={start:"touchstart mousedown",move:"touchmove mousemove",end:"touchend mouseup",select:"selectstart"},this.events={start:this.dragStart.bind(this),move:this.dragMove.bind(this),stop:this.dragStop.bind(this),select:this.onSelectStart.bind(this)},(n.Client.Platform.ios||n.Client.Platform.ipad)&&"safari"===n.Client.Engine.name&&this.eventNames.move.split(" ").forEach(function(t){document.addEventListener(t,function(t){this.isDragging&&t.preventDefault()}.bind(this),{passive:!1})},this),this.container.addEvent(this.eventNames.select,this.events.select),this.eventNames.start.split(" ").forEach(function(t){this.container.addEvent(t,this.events.start)},this),this.eventNames.end.split(" ").forEach(function(t){i.addEvent.call(document,t,this.events.stop)},this)},autoscroll:function(t,e){if(this.options.autoscroll){var i=this,n="x"===t,s=n?"left":"top",o=n?"width":"height",a=this.options,r=e.scroller[t],l=e.pointer[s]+r,h=this.windowSize[o],c=a.area;this._autoscroll||(this._autoscroll={}),l<r+c?(void 0===this._autoscroll.positive||this._autoscroll.positive)&&(r?(window.clearInterval(this._autoscroll.id),this._autoscroll=d(!1,a.movePlayer&&this.player,r,c,h,a.autoscrollFn)):this._autoscroll=null):l>r+h-c?this._autoscroll.positive||(window.clearInterval(this._autoscroll.id),this._autoscroll=d(!0,a.movePlayer&&this.player,r,c,h,a.autoscrollFn)):(window.clearInterval(this._autoscroll.id),this._autoscroll=null)}function d(t,e,n,s,o,a){var r=+new Date,l=Math.floor(i._data.position.top),h=l,c={};return c.positive=t,c.id=window.setInterval(function(){var d,u,m=+new Date,f=m-r,g=i._data.pointer.top,p=i._data.position.top;d=(s-(t?o-g:g))/s,u=2*Math.floor(10*d/2),u=Math.max(u,2),u=Math.floor(u*f/16)*(t?1:-1),!t&&n<=0&&(window.clearInterval(c.id),i._autoscroll=null),n+=u,window.scrollBy(0,u),l!==p?(l=p,h=p):h+=u,a&&(i._data.pointer.diffTop+=u,a(i._data)),e&&e.setStyle("top",h),r=m},16),c}},onSelectStart:function(t){if(!this.disabled&&!this.shouldIgnoreDrag(t))return!1},dragStart:function(t){var e,n,a=this.options,r=s.getElement(t);if((n=a.handle?!!r&&(!!i.match.call(r,a.handle)&&r.getParent(a.items)):!!r&&(!!i.match.call(r,a.items)&&r))&&(!this.first||o(this.first)===o(t))&&!this.disabled&&(1===t.which||o(t))&&!this.shouldIgnoreDrag(t))return this.player=n,this.target=r,this.first=t,this.time=t.timeStamp,this.oMousePos=this.getMousePos(t),e=this.container.getOffsets(),this.baseX=Math.round(e.x),this.baseY=Math.round(e.y),this.eventNames.move.split(" ").forEach(function(t){i.addEvent.call(document,t,this.events.move)}.bind(this)),"function"==typeof a.beforeStart&&a.beforeStart.call(this.player,t,this.getDragData(t)),!!o(t)&&void 0},dragStop:function(t){this.clear(),this.player&&this.onDragStop(t),this.player=null,this.target=null},dragMove:function(t){var e=this.options,i=this.getMousePos(t),n=t.timeStamp-this.time,s=Math.abs(i.left-this.oMousePos.left),a=Math.abs(i.top-this.oMousePos.top);return!(this.first&&e.distance&&e.distance>=s&&e.distance>=a)&&(this.first&&o(t)&&e.delay>n&&(s>0||a>0)?void this.dragStop():this.first?(this.first=!1,this.onDragStart(t),!1):(!0===this.isDragging&&this.onDragMove(t),!1))},onDragStart:function(e){var i,s,o=this.options;return this.isDragging?this:(this.dragStarted=this.isDragging=!0,this.oPlayerOffset=this.player.getOffsets(),this.options.autoscrollContainer?this.oScroll={x:o.autoscrollContainer.scrollLeft,y:o.autoscrollContainer.scrollTop}:this.oScroll=n.Client.getScrolls(),o.autoscroll&&(this.windowSize=t.Utils.Client.getSize()),o.limit&&(s=this.player.getSize(),i=this.container.getSize(),this.limit={left:this.baseX,right:i.width-s.width-this.baseX,top:this.baseY}),"function"==typeof o.start&&o.start.call(this.player,e,this.getDragData(e)),!1)},onDragMove:function(t){var e,i=this.options,n=this.getDragData(t);return this._data=n,this.autoscroll("y",n),i.movePlayer&&(this.player.setStyle("left",n.position.left+i.offset.left),!this._autoscroll&&this.player.setStyle("top",n.position.top+i.offset.top)),e=this.lastPosition||n.position,n.prevPosition=e,i.drag&&i.drag.call(this.player,t,n),this.lastPosition=n.position,!1},onDragStop:function(t){var e=this.getDragData(t);return this.dragStarted=!1,this.options.stop&&this.options.stop.call(this.player,t,e),!1},getDragData:function(t){var e=this.dragStarted&&this.getOffset(t)||{};return e.player=this.player,e.target=this.target,e},getOffset:function(t){var e,i,o,a=this.options,r=this.getMousePos(t),l=Math.round(r.left-this.oMousePos.left),h=Math.round(r.top-this.oMousePos.top);return s.preventDefault(t),e=a.autoscrollContainer?{x:a.autoscrollContainer.scrollLeft,y:a.autoscrollContainer.scrollTop}:n.Client.getScrolls(),o=Math.round(this.oPlayerOffset.x+l-this.baseX+e.x-this.oScroll.x),i=Math.round(this.oPlayerOffset.y+h-this.baseY+e.y-this.oScroll.y),a.limit&&(o>this.limit.right?o=this.limit.right:o<this.limit.left&&(o=this.limit.left),i<this.limit.top&&(i=this.limit.top)),{scroller:e,position:{left:o,top:i},pointer:{left:r.left,top:r.top,diffLeft:l+(e.x-this.oScroll.x),diffTop:h+(e.y-this.oScroll.y)}}},getMousePos:function(t){return t.touches&&(t=t.touches.length?t.touches[0]:t.changedTouches[0]),{left:t.clientX,top:t.clientY}},shouldIgnoreDrag:function(t){var e=s.getElement(t);return"function"==typeof this.options.shouldIgnoreDrag?this.options.shouldIgnoreDrag(t):e.match(this.options.ignoreDragging.join(", "))},clear:function(t){this._autoscroll&&(window.clearInterval(this._autoscroll.id),this._autoscroll=null),this.isDragging=!1,!t&&this.disabled||this.eventNames.move.split(" ").forEach(function(t){i.removeEvent.call(document,t,this.events.move)}.bind(this))},enable:function(){this.disabled=!1},disable:function(){this.disabled=!0},destroy:function(){this.clear(!0),this.container.removeEvent(this.eventNames.select,this.events.select),this.eventNames.start.split(" ").forEach(function(t){this.container.removeEvent(t,this.events.start)}.bind(this)),this.eventNames.end.split(" ").forEach(function(t){i.removeEvent.call(document,t,this.events.stop)}.bind(this))}};return e.extend(a)}),define("DS/UWPClientControls/ModalManager",function(){"use strict";var t=[];return{register:function(e){t.push(e),e.elements.container.id="wp-modal-"+(t.length-1)},unregister:function(e){var i=t.indexOf(e);-1!==i&&t.splice(i,1)},getActive:function(){for(var e=t.length-1;e>=0;e--)if(t[e].active)return t[e]},setActive:function(e,i){var n=t.indexOf(e);-1!==n&&(t[n].active=i)}}}),define("DS/UWPClientControls/ClickRemover",["UWA/Element"],function(t){"use strict";var e={},i=function(t){return 0===Object.getOwnPropertyNames(t).length},n=function(t){for(var i in e)e.hasOwnProperty(i)&&(e[i].bypassFirstEvent?e[i].bypassFirstEvent=!1:(e[i].cb(t),s.remove(i)))},s={add:function(s,o,a){var r=window;"function"==typeof o&&(i(e)&&t.addEvent.call(r,"click",n),e[s]={},e[s].cb=o,e[s].bypassFirstEvent=!!a)},remove:function(s){var o=window;e[s]&&(delete e[s],i(e)&&t.removeEvent.call(o,"click",n))}};return s}),define("DS/UWPClientControls/Notify",["UWA/Core","UWA/Class/Timed","UWA/Controls/Notify"],function(t,e,i){"use strict";var n=i.extend({defaultOptions:{autoHide:!1,showDuration:4e3,className:""},init:function(e){e.className="uwp-notify "+(e.className||""),this._parent(t.merge(e,this.defaultOptions))},showMessage:function(i,n){var s,o=new e,a="addMessage-"+t.Utils.getCheckSum(i);return!this.messages.length&&i&&this.addMessage(i,!1,n),(s=this._parent(i))&&this.options.autoHide&&o.setDelayed(a,function(){o.clearDelayed(a),t.Event.dispatchEvent(s,"click")},this.options.showDuration,!1,this),n&&s&&s.addClassName(n),s},addMessage:function(t,e,i){var n;t&&(this.messages.push(t),e&&(n=this.showMessage(t),i&&n&&n.addClassName(i)))}});return n.TYPE_SUCCESS="success",n.TYPE_ERROR="error",n}),define("DS/UWPClientControls/UWPClientControls",[],function(){}),define("DS/UWPClientControls/EditInPlace",["UWA/Event","UWA/Class","UWA/Class/Events","UWA/Class/Options","DS/UIKIT/Input/Text"],function(t,e,i,n,s){"use strict";var o=function(){};return e.extend(i,n,{options:{className:"edit-in-place",placeholder:"",defaultText:"",maxLength:0,maxWidth:0,minWidth:0,growInputAsUserType:!1,onEdit:o,onCancel:o,onComplete:o,noEdit:o,autoEdit:!0},init:function(t,e){this.setOptions(e),this.element=t,this.editMode=!1,this.events={enter:this.onEnter.bind(this),leave:this.onLeave.bind(this),click:this.edit.bind(this)},this.options.autoEdit&&this.attachEvents()},attachEvents:function(){var t=this.element,e=this.events;t.addEvent("mouseover",e.enter),t.addEvent("mouseout",e.leave),t.addEvent("click",e.click)},detachEvents:function(){var t=this.element,e=this.events;t.removeEvent("mouseover",e.enter),t.removeEvent("mouseout",e.leave),t.removeEvent("click",e.click)},onEnter:function(){this.editMode||this.element.addClassName(this.options.className)},onLeave:function(){this.editMode||this.element.removeClassName(this.options.className)},onKeyUp:function(e){var i=t.whichKey(e);"esc"===i?this.endEdit(!0):"return"===i&&this.endEdit()},edit:function(t){var e,i,n,o,a,r,l,h=this.options;h.noEdit()||this.editMode||(t&&t.stop&&t.stop(),i=this.element,a=h.minWidth,l=h.maxWidth,o=a&&a>40?a:40,r=l&&l<1e3?l:1e3,this.onEnter(),this.editMode=!0,this.originalText=i.getText(),this.input=n=new s({className:"edit-in-place "+(h.className||""),placeholder:h.placeholder,value:this.originalText,attributes:{maxLength:h.maxLength||""}}).getContent(),n.addEvents({blur:this.endEdit.bind(this,!1),keyup:this.onKeyUp.bind(this)}),h.growInputAsUserType&&n.addEvents({keyup:function(){var t=7*this.value.length+30;t<o?t=o:r&&t>r&&(t=r),this.setStyles({width:t})}}),(e=i.getSize().width+30)<o&&(e=o),r&&e>r&&(e=r),n.setStyles({width:e,margin:"0"}),i.hide(),n.inject(i,"after"),n.focus(),n.select())},endEdit:function(t){var e,i,n,s,o;this.editMode&&(i=this.input,n=this.element,s=this.options,o=this.originalText,this.editMode=!1,e=i.value.trim(),t?(n.setText(o),s.onCancel(n)):e!==o&&(n.setText(e||s.defaultText),s.onEdit(e,n)),i.destroy(),this.detachEvents(),n.show(),this.onLeave(),s.onComplete(e,n))}})}),define("DS/UWPClientControls/PlatformNotify",["UWA/Core","UWA/String","DS/UIKIT/Alert"],function(t,e,i){"use strict";return{alert:null,message:function(n,s){this.alert||(this.alert=new i({closable:!0,visible:!0,autoHide:!0,maximumVisibleMessages:1,className:"wp-alert"}).inject(document.body,"top")),this.alert.add({className:s,message:t.is(n,"string")?e.escapeHTML(n):n})},error:function(t){this.message(t,"error")},success:function(t){this.message(t,"success")},warn:function(t){this.message(t,"warning")},info:function(t){this.message(t,"primary")}}}),define("DS/UWPClientControls/Utils",["UWA/Core"],function(t){"use strict";return{throttle:function(t,e,i){var n,s,o,a=0;function r(){a=(new Date).getTime(),s=null,o=t.apply(i,n)}return function(){var l=(new Date).getTime(),h=e-(l-a);return i=i||this,n=arguments,h<=0?(clearTimeout(s),s=null,a=l,o=t.apply(i,n)):s||(s=setTimeout(r,h)),o}},debounce:function(t,e,i,n){var s,o,a,r;function l(){var h=(new Date).getTime()-a;h<e&&h>=0?s=setTimeout(l,e-h):(s=null,i||(r=t.apply(n,o),s||(n=o=null)))}return function(){n=n||this,o=arguments,a=(new Date).getTime();var h=i&&!s;return s||(s=setTimeout(l,e)),h&&(r=t.apply(n,o),n=o=null),r}},getConsecutiveNumbers:function(t,e){var i,n,s=[],o=!0,a=-1;for(i=0,n=t.length;i<n;i++){if(o||t[i]===a+1){if(s.push(i),s.length===e)break;o=!1}else s=[],o=!0;a=t[i]}return s.length>=e&&t[s[0]]},hasTouch:function(){return"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch},getPlatform:function(t){var e=t||document.documentElement.clientWidth;if(this.hasTouch()){if(e<768)return"mobile";if(e<1280)return"tablet"}return"desktop"},addEvent:function(t,e,i,n){void 0===n&&(n=!1),t.addEventListener?t.addEventListener(e,i,n):t.attachEvent&&t.attachEvent("on"+e,i,n)},addEvents:function(t,e,i){Object.keys(e).forEach(function(n){this.addEvent(t,n,e[n],i)},this)},removeEvent:function(t,e,i,n){void 0===n&&(n=!1),t.removeEventListener?t.removeEventListener(e,i,n):t.detachEvent&&t.detachEvent("on"+e,i,n)},removeEvents:function(t,e,i){Object.keys(e).forEach(function(n){this.removeEvent(n,t,e[n],i)})}}}),define("DS/UWPClientControls/DockLayout/DropTarget",["UWA/Class"],function(t){"use strict";var e=t.extend({init:function(t){this.dropRectangle=t.dropRectangle,this.indicatorRectangle=t.indicatorRectangle,this.mousePolygon=t.mousePolygon,this.container=t.container,this.name=t.name,this.priority=t.priority},matchesCoordinates:function(t,e){for(var i=!1,n=this.mousePolygon,s=0,o=n.length-1;s<n.length;o=s++){var a=n[s].x,r=n[s].y,l=n[o].x,h=n[o].y;r>e!=h>e&&t<(l-a)*(e-r)/(h-r)+a&&(i=!i)}return i},createItems:function(t){var e=require("DS/UWPClientControls/DockLayout/RowOrColumn"),i=require("DS/UWPClientControls/DockLayout/Item"),n=new e({type:this.dropRectangle.width>this.dropRectangle.height?"row":"column",container:this.container});t.forEach(function(e){n.addChild(new i({content:e,container:n,weight:100/t.length}))}),1===n.content.length&&((n=n.content[0]).container=this.container),this.container.dropItemAt(this.name,n)}});return e.sortByPriority=function(t){return t.sort(function(t,e){return t.priority>e.priority?-1:t.priority<e.priority?1:0})},e}),define("DS/UWPClientControls/DockLayout/DropTargetIndicator",["UWA/Core","UWA/Class/View"],function(t,e){"use strict";return e.extend({init:function(e){this._parent(),this.manager=e.manager,this.element=t.createElement("div",{class:"dock-drop-target"}),this.element.setStyle("position","absolute"),this.manager.element.appendChild(this.element)},setRectangle:function(t){t?this.element.setStyles({left:t.left,top:t.top,width:t.width,height:t.height}):this.element.setStyle("height",0),this.rectangle=t},getRectangle:function(){return t.clone(this.rectangle)},show:function(){this.element.show()},hide:function(){this.element.hide()},remove:function(){this.element.remove()}})}),define("DS/UWPClientControls/DockLayout/Utils",["DS/WebappsUtils/Map"],function(t){"use strict";return{clamp:function(t){return{x:Math.min(t.maxX,Math.max(t.minX,t.x)),y:Math.min(t.maxY,Math.max(t.minY,t.y))}},max:function(t){var e=-1/0;return t.forEach(function(t){t>e&&(e=t)}),e},divideRectangle:function(t,e){for(var i=[],n=t.width>t.height?"width":"height",s=0;s<e;++s)i.push({left:t.left+("width"===n?s*t.width/e:0),top:t.top+("height"===n?s*t.height/e:0),width:t.width/("width"===n?e:1),height:t.height/("height"===n?e:1)});return i},toMap:function(e){var i=new t;return e.forEach(function(t){i.set(t[0],t[1])}),i}}}),define("DS/UWPClientControls/Grid",["UWA/Core","UWA/Event","UWA/Element","UWA/Controls/Abstract","DS/UWPClientControls/Utils","DS/UWPClientControls/Draggable"],function(t,e,i,n,s,o){"use strict";var a={};function r(t){return t=t.sort(function(t,e){return t.row>e.row||t.row===e.row&&t.col>e.col?1:t.row===e.row&&t.col===e.col?0:-1})}function l(t){return t=t.sort(function(t,e){return t.row>e.row?1:t.row===e.row?0:-1})}var h={name:"r2grid",defaultOptions:{resizePlaceholderClassName:"r2g-preview-resize",placeholderClassName:"r2g-preview",resizeClassName:"r2g-resize",widgetClassName:"r2g-widget",namespace:"",cols:12,area:50,minSize:"1 1",maxSize:"12 12",fitMinSize:"2 2",margins:"7 7",resizable:"both x y",breakpoints:"mobile:1:1:2 tablet:2:1:2 desktop:12:2:4",smartBreakpointDebut:!1,fit:!1,limit:!1,proxy:!1,autoscroll:!1,responsive:!1,offsets:{x:0,y:0}},init:function(e){var i,n;e.el&&(this._parent(e),e=this.options,this.events={},this.clientWidth=document.documentElement.clientWidth,e.viewport?this.viewportHeight=this.options.viewport.getSize().height:this.viewportHeight=document.documentElement.clientHeight,this.elements.wrapper=t.extendElement(e.el),this.elements.container=this.elements.wrapper.getParent(),this.elements.container.addClassName(this.name),e.resizable&&this.setupTemplateResize(),e.margins=e.margins.split(" ").map(function(t){return+t}),e.minSize=e.minSize.split(" ").map(function(t){return+t}),e.fitMinSize=e.fitMinSize.split(" ").map(function(t){return+t}),e.maxSize=e.maxSize.split(" ").map(function(t){return+t}),e.breakpoints&&(this.breakpoint=this.getBreakpoint(e.breakpoints)),this.minSizex=this.breakpoint&&this.breakpoint.minSizex||this.options.minsize[0],this.minSizey=this.breakpoint&&this.breakpoint.minSizey||this.options.minsize[1],i=t.is(e.widgets,"string")?this.elements.wrapper.getElements(e.widgets):t.is(e.widgets,"array")?e.widgets:this.elements.wrapper.getChildren(),this.originalWidgets=i.map(this.parseWidgetsOption.bind(this)),n=this.originalWidgets.reduce(function(t,e){return this.breakpoint.name in e||"col"in e?t+1:t}.bind(this),0),this.widgets=(this.breakpoint&&this.originalWidgets.length>0&&0===n&&e.smartBreakpointDebut?this.computeSmartBreakpointDebutCoordinates(this.originalWidgets):this.originalWidgets).map(this.parseOriginalWidgets.bind(this)),this.cols=this.breakpoint&&this.breakpoint.col||e.cols,this.rows=this.widgets.reduce(function(t,e){return t+(e.sizey||1)},1)||1,this.setupGrid(),this.createFauxGrid(),this.registerWidgets(),this.createStylesheet(),e.proxy||(this.setupDrag(),this.setupResize(),this.events.window=s.debounce(this.update.bind(this),120,!1),s.addEvent(window,"resize",this.events.window)),this.options.fit&&this.fit(),this.updateGridHeight(),n<this.widgets.length&&n>0&&setTimeout(this.dispatchEvent.bind(this,"onDrop")))},parseWidgetsOption:function(e){var i,n,s,o={},a=!1;return t.is(e,"element")?s=t.extend({el:t.extendElement(e)},this.parseData(e)):t.is(e,"string")?(i=t.createElement(e),s=t.extend({el:i},this.parseData(i))):this.breakpoint?(s={el:t.extendElement(e.el)},n=Object.keys(e),o.sizex=Math.max(e.sizex||1,this.minSizex),o.sizey=1!==e.sizey?Math.max(e.sizey||1,this.minSizey):1,e.row&&(o.row=e.row),e.col&&(o.col=e.col),Object.keys(this.breakpoints).forEach(function(t){-1!==n.indexOf(t)&&(s[t]=this.parseData(e[t],!0),a=!0)}.bind(this)),a||t.merge(s,o)):s=t.extend({el:t.extendElement(e.el)},this.parseData(e)),this.options.resizable&&s.el.addContent(this.resizeTemplate),s},parseOriginalWidgets:function(e){var i,n,s=Object.keys(e),o=this.options.defaultCoordinates||{};if(o[this.breakpoint.name]&&!e.col&&(i=t.extend({el:e.el},this.parseData(o[this.breakpoint.name]))),this.breakpoint){if(e[this.breakpoint.name])return t.extend({el:e.el},this.parseData(e[this.breakpoint.name]));if(this.options.smartBreakpointDebut&&!("col"in e||"sizex"in e))return t.extend({el:e.el,moveup:!0},this.parseData(this.computeSmartBreakpointDebutCoordinates([e],!0)[0][this.breakpoint.name]));if(i)return i;if(Object.keys(this.breakpoints).reverse().some(function(t){if(-1!==s.indexOf(t))return n=t,!0}),n)return t.extend({el:e.el},this.parseData(e[n]))}return i||t.extend({},e)},setupTemplateResize:function(){var t=this.options,e=t.resizable;e=(e=e.replace(/x/,"left-x right-x")).replace(/both/,"left-both right-both"),this.resizeTemplate=e.split(" ").map(function(e){return'<span class="'+t.resizeClassName+" "+t.resizeClassName+"-"+e+'"></span>'}).join("")},setupGrid:function(t){var e,i,n=this.options,s=this.elements.container;!t&&n.offsets||(n.offsets=s.getOffsets()),!t&&n.containerWidth||(n.containerWidth=s.getSize().width),this.baseX=n.offsets.x,this.baseY=n.offsets.y,this.widgetWidth=Math.floor((n.containerWidth-2*this.cols*this.options.margins[0])/this.cols),this.widgetHeight=this.options.height||this.widgetWidth,this.minWidgetWidth=2*this.options.margins[0]+this.widgetWidth,this.minWidgetHeight=2*this.options.margins[1]+this.widgetHeight,this.visibleRows=Math.floor(this.viewportHeight/this.minWidgetHeight),this.rows=Math.max(this.rows,this.visibleRows),i=this.viewportHeight/this.minWidgetHeight-this.visibleRows,e=Math.floor(i*this.minWidgetHeight/this.visibleRows),this.minWidgetHeight+=e,this.widgetHeight+=e},getLastRow:function(){return this.widgets.reduce(function(t,e){return t<(e=e.row+e.sizey-1)?e:t},0)||1},createStylesheet:function(){var t,e,i,n,s,o,r,l,h,c,d,u=this.options,m="",f=this.rows;if(t=u.namespace?u.namespace:"default",e=u.namespace?"."+u.namespace:"",i=[this.rows,this.cols,this.widgetWidth,this.widgetHeight,t],!(a[t]&&(h=+(l=(r=a[t]).split(" "))[0],c=l.slice(1).join(" "),f=Math.max(this.rows,h),i[0]=f,d=i.slice(1).join(" "),r===i.join(" ")||this.rows<h&&c===d))){for(this.removeStyleTag(t),n=this.cols;n>=0;n--)m+=e+' [data-col="'+(n+1)+'"] { left:'+(n*this.widgetWidth+n*u.margins[0]+(n+1)*u.margins[0])+"px; }\n";for(n=f;n>=0;n--)m+=e+' [data-row="'+(n+1)+'"] { top:'+(n*this.widgetHeight+n*u.margins[1]+(n+1)*u.margins[1])+"px; }\n";for(o=1;o<=f;o++)m+=e+' [data-sizey="'+o+'"] { height:'+(o*this.widgetHeight+(o-1)*(2*u.margins[1]))+"px; }\n";for(s=1;s<=this.cols;s++)m+=e+' [data-sizex="'+s+'"] { width:'+(s*this.widgetWidth+(s-1)*(2*u.margins[0]))+"px; }\n";a[t]=i.join(" "),this.addStyleTag(t,m)}},registerWidgets:function(){r(this.widgets),this.widgets.forEach(function(t){t.moveup||this.registerWidget(t)}.bind(this)),this.widgets.forEach(function(t){t.moveup&&(delete t.moveup,t.col=t.row=1,this.add(t))}.bind(this))},registerWidget:function(e){var i,n=this.getHighestEmptyRow(e);n&&(e.row=n,e.el.setAttribute("data-row",n)),e.col&&e.row&&this.isValidPosition(e,e.col,e.row)||(i=this.getNextAvailablePosition(e),t.extend(e,i)),e.el.addClassName(this.options.widgetClassName),this.setData(e),e.el.isInjected()||e.el.inject(this.elements.wrapper),this.addFauxWidget(e)},onOverlappedColumn:function(t){if(t.length){var e,i,n,s=t[0];for(e=function(t,e){var i,n=t+e-1,s=[];for(i=t;i<=n;i++)s.push(i);return s}(s.coords.col,this.player.sizex),n=0;n<e.length;n++)if(-1===this.lastCols.indexOf(e[n])){this.setPlayer(s.coords.col,s.coords.row);break}for(n=0;n<this.lastCols.length;n++)if(-1===e.indexOf(this.lastCols[n])){i=this.lastCols[n],this.setPlayer(s.coords.col,s.coords.row),this.forEachWidgetBelow(i,this.playerCells.rows[0],function(t){this.moveWidgetUp(t,this.player.sizey)}.bind(this));break}this.lastCols=e}},onOverlappedRow:function(t){if(t.length){var e,i,n,s,o,a=t[0];for(e=function(t,e){var i,n=t+e-1,s=[];for(i=t;i<=n;i++)s.push(i);return s}(a.coords.row,this.player.sizey),n=0;n<e.length;n++)if(-1===this.lastRows.indexOf(e[n])){this.setPlayer(a.coords.col,a.coords.row);break}for(n=0;n<this.lastRows.length;n++)if(-1===e.indexOf(this.lastRows[n])){for(i=this.lastRows[n],o=this.playerCells.cols,this.setPlayer(a.coords.col,a.coords.row),s=0;s<o.length;s++)this.forEachWidgetBelow(o[s],i,function(t){this.moveWidgetUp(t,this.player.sizey)}.bind(this));break}this.lastRows=e}},setPlayer:function(t,e){var i,n,s=!1;this.removeFauxWidget(this.placeholder),this.player.col=t,this.player.row=e,this.playerCells=this.getCells(this.player),(i=this.getWidgetsOverlapping(this.player)).length?((n=this.getWidgetsConstraints(i)).canGoUp.forEach(function(t){this.moveWidgetUpToRow(t.wdg,t.row)}.bind(this)),n.cantGoUp.forEach(function(t){(s=this.canPlayerGoUp(this.player))||this.moveWidgetDown(t,e+this.player.sizey-t.row)}.bind(this)),this.setPlaceholder(t,s||e)):(!1!==(s=this.canPlayerGoUp(this.player))&&(e=s,this.player.row=e,this.playerCells=this.getCells(this.player)),this.setPlaceholder(t,e))},setPlaceholder:function(e,i){var n,s=t.extend({},this.placeholder),o=this.placeholder.row!==i,a=this.placeholder.col!==e;e+s.sizex-1>this.cols&&(e=this.cols-s.sizex+1),this.placeholder.col=e,this.placeholder.row=i,this.placeholderCells=this.getCells(this.placeholder),this.placeholder.el?this.placeholder.el.setAttributes({"data-row":i,"data-col":e}):this.placeholder.setAttributes({"data-row":i,"data-col":e}),(o||a)&&(n=this.getWidgetsBelow(s)).forEach(function(t){this.moveWidgetUp(t,t.row-i-this.placeholder.sizey)}.bind(this)),(n=this.getWidgetsOverlapping(this.placeholder)).length&&n.forEach(function(t){this.moveWidgetDown(t,i+this.placeholder.sizey-t.row)}.bind(this))},setupDrag:function(){var t=this,e=this.options,i="."+e.widgetClassName+", "+e.widgetClassName+" > *",n=e.handle?e.handle:i;this.events.drag=new o({container:this.elements.container,items:"."+e.widgetClassName,handle:n,limit:e.limit,autoscroll:!e.fit&&e.autoscroll,distance:0,area:e.area,start:function(){t.onDragStart(this)},stop:function(e,i){t.onDragStop(i)},drag:s.throttle(function(e,i){t.onDrag(i)},120,t)})},setupResize:function(){var t=this,e=this.options,i="."+e.resizeClassName,n=e.resizeHandle?e.resizeHandle:i,a=s.debounce(function(e){t.onResizing(e)},120,!1,t),r=s.throttle(function(e){t.onResizingWidget(e)},60,t);this.events.resize=new o({container:this.elements.container,items:"."+e.widgetClassName,handle:n,limit:e.limit,autoscroll:!e.fit&&e.autoscroll,autoscrollFn:this.onResizingWidget.bind(this),area:e.area,distance:0,movePlayer:!1,start:function(e,i){t.onResizeStart(this,i)},stop:function(){setTimeout(t.onResizeStop.bind(t),180)},drag:function(t,e){a(e),r(e)}})},onDragStart:function(e){this.player=this.widgets.filter(function(t){if(t.el===e)return!0})[0],this.placeholder=t.extend({},this.player),this.playerCells=this.getCells(this.player),this.placeholderCells=t.extend({},this.playerCells),this.lastCols=[],this.lastRows=[],this.placeholder.el=t.createElement(this.player.el.getTagName(),{class:this.options.placeholderClassName}),this.setData(this.placeholder),this.placeholder.el.inject(this.elements.wrapper),this.player.el.addClassName("dragging")},onResizeStart:function(e,i){var n=this.options,s=i.target,o=n.margins,a=this.parseData(e);this.player=t.extend({el:e},this.getCoords(a)),this.resized=t.extend({},this.player),this.direction={left:s.hasClassName(n.resizeClassName+"-left-x")||s.hasClassName(n.resizeClassName+"-left-both"),right:s.hasClassName(n.resizeClassName+"-right-x"),bottom:s.hasClassName(n.resizeClassName+"-y"),both:s.hasClassName(n.resizeClassName+"-left-both")||s.hasClassName(n.resizeClassName+"-right-both")},this.direction.left?(this.resized.maxSizex=Math.max(Math.min(this.player.col,n.maxSize[0]),this.player.col+this.player.sizex-1),this.resized.minCol=Math.max(1,this.player.col+this.player.sizex-n.maxSize[0]),this.resized.maxCol=this.player.col+this.player.sizex-this.minSizex,this.resized.minLeft=(this.resized.minCol-1)*this.minWidgetWidth+o[0],this.resized.maxLeft=(this.resized.maxCol-1)*this.minWidgetWidth+o[0]):this.resized.maxSizex=Math.min(n.maxSize[0],this.cols-this.player.col+1),this.resized.minSizex=this.minSizex,this.resized.minSizey=this.minSizey,this.resized.maxSizey=n.fit?100:n.maxSize[1],this.resized.minWidth=this.resized.minSizex*this.widgetWidth+(this.resized.minSizex-1)*o[0]*2,this.resized.maxWidth=this.resized.maxSizex*this.widgetWidth+(this.resized.maxSizex-1)*o[0]*2,this.resized.minHeight=this.resized.minSizey*this.minWidgetHeight-2*o[1],this.resized.maxHeight=this.resized.maxSizey*this.minWidgetHeight-2*o[1],this.lastSizex=this.resized.sizex,this.lastSizey=this.resized.sizey,this.lastCol=this.resized.col,this.player.el.setStyles({"min-width":this.widgetWidth,"min-height":this.widgetHeight}),this.placeholder&&this.placeholder.remove(),this.placeholder=t.createElement(this.player.el.getTagName(),{class:n.placeholderClassName+" "+n.resizePlaceholderClassName,"data-row":this.player.row,"data-col":this.player.col,"data-sizex":this.player.sizex,"data-sizey":this.player.sizey}).inject(this.elements.wrapper),this.player.el.addClassName("dragging")},onDrag:function(t){if(null===this.player||this.events.drag&&this.events.drag._autoscroll)return!1;var e,i={x:t.position.left+this.baseX,y:t.position.top+this.baseY,width:this.player.sizex*this.widgetWidth,height:this.player.sizey*this.widgetHeight};i.x1=i.x+i.width/2,i.y1=i.y+i.height/2,i.x2=i.x+i.width,i.y2=i.y+i.height,e=this.getClosestColliders(i),this.onOverlappedColumn(e),this.onOverlappedRow(e)},onResizingWidget:function(t){var e=this.resized,i=this.options.margins,n={},s=t.pointer.diffLeft,o=t.pointer.diffTop;e&&(this.direction.left?(n.width=Math.max(Math.min(e.width-s,e.maxWidth),e.minWidth),n.left=Math.max(Math.min(e.x-this.baseX+s+i[0],e.maxLeft),e.minLeft)):this.direction.bottom||(n.width=Math.max(Math.min(e.width+s,e.maxWidth),e.minWidth)),(this.direction.bottom||this.direction.both)&&(n.height=Math.max(Math.min(e.height+o,e.maxHeight),e.minHeight)),this.player.el.setStyles(n))},onResizing:function(t){if(null===this.resized||this.events.resize&&this.events.resize._autoscroll)return!1;var e,i,n,s,o,a=this.resized,r=this.options.margins,l={},h=t.pointer.diffLeft,c=t.pointer.diffTop;if(this.direction.left?(e=Math.round(h/this.minWidgetWidth),n=Math.max(1,a.sizex-e),o=Math.max(Math.min(a.col+e,a.maxCol),a.minCol),l.width=Math.max(Math.min(a.width-h,a.maxWidth),a.minWidth),l.left=Math.max(Math.min(a.x-this.baseX+h+r[0],a.maxLeft),a.minLeft)):(e=Math.round(h/this.minWidgetWidth),n=Math.max(1,a.sizex+e),l.width=Math.max(Math.min(a.width+h,a.maxWidth),a.minWidth)),i=Math.round(c/this.minWidgetHeight),s=Math.max(1,a.sizey+i),l.height=Math.max(Math.min(a.height+c,a.maxHeight),a.minHeight),n=Math.max(Math.min(n,a.maxSizex),a.minSizex),s=Math.max(Math.min(s,a.maxSizey),a.minSizey),this.direction.both||!this.direction.right&&!this.direction.left?this.direction.bottom&&(n=a.sizex,delete l.width):(s=a.sizey,delete l.height),this.player.el.setStyles(l),n!==this.lastSizex||s!==this.lastSizey){var d=this.resize({widget:this.player.el,sizex:n,sizey:s,col:o,silent:!0});this.placeholder&&this.placeholder.setAttributes({"data-row":d.row,"data-col":o||d.col,"data-sizex":n,"data-sizey":s})}this.lastSizex=n,this.lastSizey=s,this.lastCol=o},onDragStop:function(t){var e;this.player&&(this.player.el.removeClassName("dragging"),t.position.left=t.position.left+this.baseX,t.position.top=t.position.top+this.baseY,e=this.getClosestColliders(t.position),this.onOverlappedColumn(e),this.onOverlappedRow(e),this.player.el.setAttributes({"data-col":this.placeholder.col,"data-row":this.placeholder.row}),this.player.el.setStyles({left:"",top:""}),this.player.row=this.placeholder.row,this.player.col=this.placeholder.col,this.playerCells=this.getCells(this.player),this.addFauxWidget(this.player,this.player,!0),this.dispatchEvent("onDrop"),this.player=null,this.playerCells=null,this.placeholderCells=null,this.placeholder.el.remove(),this.placeholder=null,this.options.fit&&this.fit(),this.updateGridHeight())},onResizeStop:function(){this.player&&(this.player.el.removeClassName("dragging"),this.player.el.setStyles({width:"",height:"",left:"","min-width":"","min-height":""}),this.dispatchEvent("onResize"),this.player=null,this.resized=null,this.placeholder&&(this.placeholder.remove(),this.placeholder=null),this.options.fit&&this.fit(),this.updateGridHeight())},unfit:function(){var t,e,i,n=this.gridmap,s=[];for(this.options.fit=!1,this.minSizey=Math.max(this.breakpoint.minSizey,this.minSizey),t=1;t<n.length;t++)for(e=n[t].length-1;e>0;e--)i=n[t][e],this.isWidget(t,e)&&-1===s.indexOf(i)&&1!==i.sizey&&i.sizey<this.minSizey&&(s.push(i),this.resize({widget:i,sizey:this.minSizey,silent:!0}));return this.updateGridHeight(),this.dispatchEvent("onUnFit"),this},fit:function(){if(0===this.viewportHeight)return this;var t,e,i,n,s,o,a=this.gridmap,r=[];for(this.minSizey=Math.min(this.options.fitMinSize[1],this.minSizey),o=1;o<a.length;o++)for(i=0,s=a[o].length-1;s>0;s--)if(this.isWidget(o,s)&&(i||s>this.visibleRows)){if(t=a[o][s],i||(i=s-this.visibleRows),!i)break;if(r.indexOf(t)>-1)continue;t.sizey>this.minSizey&&(e=Math.max(t.sizey-i,this.minSizey),i-=t.sizey-e,r.push(t),this.resize({widget:t,sizey:e,silent:!0}))}for(r=[],o=1;o<a.length;o++)for(n=0,s=this.visibleRows;s>0;s--)t=a[o][s],r.indexOf(t)>-1||(this.isEmpty(o,s)?n++:n&&t.sizey>=this.minSizey&&(e=this.canMoveWidget(t,"down",n),r.push(t),e&&this.resize({widget:t,sizey:e-t.row+1,silent:!0}),n=0));for(r=[],o=1;o<a.length;o++)for(s=a[o].length-1;s>0;s--)t=a[o][s],this.isWidget(o,s)&&s>this.visibleRows&&-1===r.indexOf(t)&&r.push(t);return this.updateGridHeight(),this.dispatchEvent("onFit",[r]),this},computeSmartBreakpointDebutCoordinates:function(t,e){var i,n,s,o,a,r=f(this.breakpoint),l=(n=Object.keys(this.breakpoints).map(function(t){return f(Object.assign({name:t},this.breakpoints[t]))},this).filter(function(e){return e.name!==r.name&&t.reduce(function(t,i){return t||e.name in i},!1)}),s=r.maxWidth/r.minWidth,o=1/0,a=null,n.forEach(function(t){var e=t.maxWidth/t.minWidth;Math.abs(s-e)<Math.abs(s-o)&&(o=e,a=t)}),a),h=[],c=this.options.defaultCoordinates||{},d=(c[(i=r).name]||{}).sizex||Math.max(i.minWidth,Math.min(Math.floor(i.maxWidth/2),Math.round(1.5*Math.log(2*i.maxWidth/i.minWidth)))),u={},m=0;function f(t){return{name:t.name,maxWidth:t.col,minWidth:t.minSizex,minHeight:t.minSizey}}function g(t){return function(e,i){return e.top-i.top||("left to right"===t?1:-1)*(e.left-i.left)}}function p(t,e){for(var i=t.top;i<t.top+t.height;++i)for(var n=t.left;n<t.left+t.width;++n)e(n,i,i*r.maxWidth+n)}function v(t){p(t,function(t,e,i){u[i]=!0})}function w(t){p(t,function(t,e,i){delete u[i]})}function y(t){var e=!0;return p(t,function(t,i,n){e=e&&t>=0&&i>=0&&t<r.maxWidth&&!u[n]}),e}function C(t,e){var i,n=Object.assign({},e,{width:e.width+1},t?void 0:{left:e.left-1});return w(e),v(i=y(n)?n:e),i}return l?function(t){if(e)return t;var i,n=[],s=!0;for(t=t.slice().sort(g("right to left")).map(function(t){if(0===t.left)return t;for(var e=function(t){var e,i=r.maxWidth-t.width;for(w(t);!y(e=Object.assign({},t,{left:i}));)--i;return v(e),e}(t),i=Math.max(1,Math.floor(d/2)),s={left:e.left-i,top:t.top,width:i,height:t.height};!y(s);)Object.assign(s,{left:s.left+1,width:s.width-1});return s.width>0&&(n.push(s),v(n[n.length-1])),e}).sort(g("left to right")),n.forEach(w);s;)i=Object.keys(u).length,t=t.map(C.bind(null,!0)).map(C.bind(null,!1)),s=Object.keys(u).length>i;return t}(function(t){return t.slice().sort(g("left to right")).map(function(t){return function(t,e,i){for(var n,s=0,o=m;!y(n={widget:t,left:s,top:o,width:e,height:i});)0==(s=(s+1)%r.maxWidth)&&++o;return v(n),m=o,n}(t.widget,function(t){return Math.max(d,Math.min(r.maxWidth,Math.round(r.maxWidth/r.minWidth*t.width/(l.maxWidth/l.minWidth))))}(t),function(t){var e=(c[r.name]||{}).sizey/(c[l.name]||{}).sizey;return Math.max(r.minHeight,Math.floor(t.height*(e||r.minHeight/l.minHeight)))}(t))})}((t=t.filter(function(t){return!!t[l.name]||(t.moveup=!0,h.push(t),!1)})).map(function(t){var e=t[l.name]||t;return{widget:t,left:e.col-1,top:e.row-1,width:e.sizex,height:e.sizey}}))).map(function(t){var e=Object.assign({},t.widget),i={col:t.left+1,row:t.top+1,sizex:t.width,sizey:t.height};return e[r.name]=i,e}).concat(h):t},getWidgetsBelow:function(t){var e=this,i=t.row+t.sizey-1,n=[];return this.forEachCol(t,function(t){e.forEachWidgetBelow(t,i,function(t){if(!e.isPlayer(t.col,t.row)&&-1===n.indexOf(t))return n.push(t),!0})}),l(n)},forEachWidgetBelow:function(t,e,i){var n,s=this.gridmap,o=[];if(s[t])for(e+=1,n=s[t].length;e<n&&(!this.isWidget(t,e)||-1!==o.indexOf(s[t][e])||(o.push(s[t][e]),!i(s[t][e])));e++);},moveWidgetUp:function(t,e){var i,n=this,s=[];if(e||(e=1),!this.canMoveWidget(t,"up"))return!1;this.forEachCol(t,function(o){if(-1===s.indexOf(t)){var a=t.row-e;if(!(a=n.canMoveWidgetUpToRow(t,o,a)))return!0;i=n.getWidgetsBelow(t),n.removeFauxWidget(t),t.row=a,n.addFauxWidget(t),t.el.setAttribute("data-row",t.row),s.push(t),i.forEach(function(t){n.moveWidgetUp(t,e)})}})},moveWidgetUpToRow:function(t,e){var i=this,n=this.getWidgetsBelow(t);!1!==this.isValidPosition(t,t.col,e)&&(this.removeFauxWidget(t),t.row=e,this.addFauxWidget(t),t.el.setAttribute("data-row",e),n.forEach(function(t){var e=i.getHighestEmptyRow(t);e&&e!==t.row&&i.moveWidgetUpToRow(t,e)}))},moveWidgetDown:function(t,e){var i,n=this,s=t.row+e;e<=0||(i=this.getWidgetsBelow(t),this.removeFauxWidget(t),i.forEach(function(i){var s=[];n.forEachCol(i,function(e){for(var o=0,a=t.row+t.sizey;a<i.row;a++)n.isEmpty(e,a)&&o++;s.push(o)}),(e-=Math.max.apply(Math,s))>0&&n.moveWidgetDown(i,e)}),t.row=s,this.updateFauxWidget(t),t.el.setAttribute("data-row",t.row))},canMoveWidget:function(t,e,i){var n,s="up"===e?-1:1,o=t.row+s,a=o+s*(i||1),r=!0;if("up"===e)for(n=o;n>a&&(this.forEachCol(t,function(t){if(this.isWidget(t,n)||this.isPlaceholderIn(t,n))return r=!1,!0}.bind(this)),r);n--)r=n;else for(n=o+t.sizey-1;n<a+t.sizey-1&&(this.forEachCol(t,function(t){if(this.isWidget(t,n)||this.isPlaceholderIn(t,n))return r=!1,!0}.bind(this)),r);n++)r=n;return r},canMoveWidgetUpToRow:function(t,e,i){var n,s=this,o=!0,a=[];if(this.forEachCol(t,function(e){for(a[e]=[],n=t.row;n--&&s.isEmpty(e,n)&&!s.isPlaceholderIn(e,n);)a[e].push(n);if(!a[e].length)return o=!1,!0}),!o)return!1;for(n=i,n=1;n<t.row;n++){for(var r=!0,l=0,h=a.length;l<h;l++)a[l]&&-1===a[l].indexOf(n)&&(r=!1);if(!0===r){o=n;break}}return o},mutateWidget:function(e,i){var n=[],s=[],o=[],a=[],r=e.sizey,l=this.getCells(e),h=this.getCells(i);function c(t){var e=this;this.getWidgetsBelow(t).forEach(function(i){i.el!==t.el&&e.moveWidgetUp(i,t.sizey)})}l.cols.forEach(function(t){-1===h.cols.indexOf(t)&&n.push(t)}),h.cols.forEach(function(t){-1===l.cols.indexOf(t)&&s.push(t)}),l.rows.forEach(function(t){-1===h.rows.indexOf(t)&&o.push(t)}),h.rows.forEach(function(t){-1===l.rows.indexOf(t)&&a.push(t)}),this.removeFauxWidget(e),s.length&&this.emptyCells({col:i.col,row:i.row,sizex:i.sizex,sizey:Math.min(e.sizey,i.sizey),el:e.el}),a.length&&this.emptyCells(t.extend({el:e.el},i)),e.col=i.col,e.row=i.row,e.sizex=i.sizex,e.sizey=i.sizey,this.addFauxWidget(e),this.setData(e),n.length&&c.call(this,{col:n[0],row:e.row,sizex:n.length,sizey:Math.min(r,e.sizey),el:e.el}),o.length&&c.call(this,e),this.moveWidgetUp(e)},emptyCells:function(t){this.getWidgetsBelow({col:t.col,row:t.row-t.sizey,sizex:t.sizex,sizey:t.sizey}).every(function(e){return e.row>t.row+t.sizey-1||(e.el!==t.el&&this.moveWidgetDown(e,t.row+t.sizey-e.row),!0)}.bind(this))},updateGridHeight:function(){var t=this.getLastRow()*this.minWidgetHeight;this.elements.container.setStyle("height",t)},getBreakpoint:function(e){var i,n=s.getPlatform();if(e&&t.is(e,"string"))return i=e.split(" ").reduce(function(t,e){return t[(e=e.split(":"))[0]]={col:+e[1],minSizex:+e[2],minSizey:+e[3]},t},{}),this.breakpoints=i,i[n]&&t.merge({name:n},i[n])},getHighestEmptyRow:function(t){var e=this,i=!0,n=[],s=1e3;return this.forEachCol(t,function(o){var a=e.gridmap[o],r=t.row+t.sizey;for(n[o]=[];--r>0&&(!e.isWidget(o,r)||e.isPlayer(o,r)||a[r]===t);)e.isPlayer(o,r)||n[o].push(r),r<s&&(s=r);if(!n[o].length)return i=!1,!0;n[o].sort(function(t,e){return t-e})}),!!i&&this.getValidRows(t,n,s)},getValidRows:function(e,i,n){var o=e.row+e.sizey-1,a=n-1,r=!1,l=[];function h(e){t.is(e,"array")&&-1===e.indexOf(a)&&(c=!1)}for(;++a<=o;){var c=!0;if(i.forEach(h),c&&(l.push(a),l.length===e.sizey))break}return 1===e.sizey?l[0]!==e.row&&(r=l[0]||!1):l[0]!==e.row&&(r=s.getConsecutiveNumbers(l,e.sizey)),r},isValidPosition:function(t,e,i,n){var s=!0,o={sizey:t.sizey,sizex:t.sizex,col:e,row:i};return!(e+t.sizex-1>this.cols)&&(!(n&&n<i+t.sizey-1)&&(this.forEachCell(o,function(t,e){this.isWidget(t,e)&&(s=!1)}.bind(this)),s))},getNextAvailablePosition:function(t){var e,i,n,s,o=this.gridmap,a=[];for(t.sizex>this.cols&&(t.sizex=this.cols),n=1,e=o.length;n<e;n++)for(s=1,i=o[n].length;s<=i;s++)this.isValidPosition(t,n,s)&&a.push({col:n,row:s,sizey:t.sizey,sizex:t.sizex});return!!a.length&&r(a)[0]},parseData:function(e,i){var n={},s=e.el?e.el:!!t.is(e,"element")&&e;return n.col=e.col||s&&s.getData("col"),n.row=e.row||s&&s.getData("row"),n.sizex=e.sizex||s&&s.getData("sizex"),n.sizey=e.sizey||s&&s.getData("sizey"),i||(n.sizex=Math.max(n.sizex||1,this.minSizex),n.sizey=1!==n.sizey?Math.max(n.sizey||1,this.minSizey):1),n},setData:function(e,i){var n=e.el?e.el:e;(i=t.is(i)?i:e).col&&n.setAttribute("data-col",i.col),i.row&&n.setAttribute("data-row",i.row),i.sizex&&n.setAttribute("data-sizex",i.sizex),i.sizey&&n.setAttribute("data-sizey",i.sizey)},isWidget:function(t,e){var i=this.gridmap[t];return!(!i||!i[e])&&i[e]},isEmpty:function(t,e){var i=this.gridmap[t];return!i||i&&!1===i[e]},isPlayerIn:function(t,e){var i=this.playerCells;return i&&i.cols.indexOf(t)>-1&&i.rows.indexOf(e)>-1},isPlaceholderIn:function(t,e){var i=this.placeholderCells;return i&&i.cols.indexOf(t)>-1&&i.rows.indexOf(e)>-1},isPlayer:function(t,e){if(e&&!this.gridmap[t])return!1;var i=e?this.gridmap[t][e]:t;return i&&i.el===(this.player&&this.player.el)},forEachCol:function(t,e){for(var i=0;i<t.sizex;i++)e(t.col+i,t)},forEachCell:function(t,e){this.forEachCol(t,function(i){for(var n=0;n<t.sizey;n++)e(i,t.row+n)})},addStyleTag:function(t,e){var i=document,n=i.createElement("style");n.id="r2g-"+t,i.getElementsByTagName("head")[0].appendChild(n),n.setAttribute("type","text/css"),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(i.createTextNode(e))},removeStyleTag:function(t){var e=i.getElement.call(document,"head").getElement("style#r2g-"+t);e&&(e.remove(),a[t]=!1)},findWidget:function(t,e,i){if(e||(e=this.widgets),t.row&&t.col&&t.el)return t;for(var n=0,s=e.length;n<s;n++)if(t===e[n].el)return i?{wdg:e[n],idx:n}:e[n]},createFauxGrid:function(){this.fauxGrid=[],this.gridmap=[];for(var t=this.cols;t>0;t--){this.gridmap[t]=[];for(var e=this.rows;e>0;e--)this.addFauxCell(e,t)}},addFauxWidget:function(t,e,i){this.updateFauxWidget(t,e),i&&this.getWidgetsBelow(t).forEach(function(t){this.moveWidgetUp(t)}.bind(this))},removeFauxWidget:function(t){this.updateFauxWidget(t,!1)},updateFauxWidget:function(t,e){var i=this.gridmap;this.forEachCell(t,function(n,s){i[n]&&(i[n][s]=void 0===e?t:e)})},addFauxCell:function(t,e){var i={x:this.baseX+(e-1)*this.minWidgetWidth,y:this.baseY+(t-1)*this.minWidgetHeight,width:this.minWidgetWidth,height:this.minWidgetHeight,col:e,row:t};i.x1=i.x+i.width/2,i.y1=i.y+i.height/2,i.x2=i.x+i.width,i.y2=i.y+i.height,this.gridmap[e][t]||(this.gridmap[e][t]=!1),this.fauxGrid.push(i)},addFauxRows:function(t){var e,i,n=this.rows+(t||1);for(e=n;e>this.rows;e--)for(i=this.cols;i>=1;i--)this.addFauxCell(e,i);this.rows=n,this.createStylesheet()},updateFauxGrid:function(){var t=this.fauxGrid.slice(0);this.fauxGrid=[],t.forEach(function(t){this.addFauxCell(t.row,t.col)}.bind(this))},getCells:function(t){var e,i={cols:[],rows:[]};for(e=0;e<t.sizex;e++)i.cols.push(t.col+e);for(e=0;e<t.sizey;e++)i.rows.push(t.row+e);return i},getCoords:function(e){var i=this.options.margins,n={x:this.baseX+(e.col-1)*this.minWidgetWidth,y:this.baseY+(e.row-1)*this.minWidgetHeight,width:this.widgetWidth*e.sizex+(e.sizex-1)*i[0]*2,height:this.widgetHeight*e.sizey+(e.sizey-1)*i[1]*2};return t.extend(n,e),n.x1=n.x+n.width/2,n.y1=n.y+n.height/2,n.x2=n.x+n.width,n.y2=n.y+n.height,n},findCollisions:function(t){var e,i,n,s,o,a=this.fauxGrid.length,r=[];function l(t,e){var i="",n="";return t.y>e.y1&&t.y<=e.y2&&(i="N"),t.y2>=e.y&&t.y2<e.y1&&(i="S"),t.x>e.x1&&t.x<=e.x2&&(n="W"),t.x2>=e.x&&t.x2<e.x1&&(n="E"),i+n||"C"}function h(t,e){var i=Math.max(t.x,e.x),n=Math.max(t.y,e.y);return{width:Math.min(t.x2,e.x2)-i,height:Math.min(t.y2,e.y2)-n}}for(;a--;){var c,d;e=this.fauxGrid[a],i=t,s=void 0,o=void 0,s=!1,o=!1,((n=e).x>=i.x&&n.x<=i.x2||n.x2>=i.x&&n.x2<=i.x2||i.x>=n.x&&i.x2<=n.x2)&&(s=!0),(n.y>=i.y&&n.y<=i.y2||n.y2>=i.y&&n.y2<=i.y2||i.y>=n.y&&i.y2<=n.y2)&&(o=!0),s&&o&&"C"===(c=l(t,e))&&(d=(d=h(t,e)).width*d.height,r.push({area:d,region:c,coords:e,el:e.el}))}return r},getClosestColliders:function(t){return this.findCollisions(t).sort(function(t,e){return t.coords.y1<e.coords.y1||t.coords.x1<e.coords.x1?-1:1})},getWidgetsOverlapping:function(t,e){var i=this,n=this.getCells(t),s=this.gridmap,o=[],a=[];return n.cols.forEach(function(t){n.rows.forEach(function(n){if(!s[t])return!0;var r=s[t][n];i.isWidget(t,n)&&(!e&&!i.isPlayer(t,n)||e)&&-1===a.indexOf(r)&&(o.push(r),a.push(r))})}),o},getWidgetsConstraints:function(t){var e=[],i=[];return t.forEach(function(t){var n=this.getHighestEmptyRow(t);n?e.push({wdg:t,row:n}):i.push(t)}.bind(this)),{canGoUp:l(e),cantGoUp:function(t){return t=t.sort(function(t,e){return t.row+t.sizey<e.row+e.sizey?1:-1})}(i)}},canPlayerGoUp:function(t){var e=this,i=t.row+t.sizey,n=!0,s=[],o=-1/0,a=-1/0;return this.forEachCol(t,function(r){var l=i;for(s[r]=[];--l>0;)e.isEmpty(r,l)&&(s[r].push(l),l<t.row&&l>a&&(a=l,o=l),o=o-l<2?l:o);if(0===s[r].length||t.row-a>1)return n=!1,!0;s[r].sort(function(t,e){return t-e})}),!!n&&this.getValidRows(t,s,o)},add:function(e){var i,n,s;i=this.parseWidgetsOption(e),(n=this.parseOriginalWidgets(i)).col&&n.row?this.emptyCells(n):(s=this.getNextAvailablePosition(n),t.extend(n,s)),this.originalWidgets.push(i),this.widgets.push(n),this.registerWidget(n),this.addFauxRows(n.sizey),this.options.fit&&this.fit(),this.updateGridHeight()},remove:function(t){var e,i,n;return e=this.findWidget(t.widget,this.widgets,!0),i=this.findWidget(t.widget,this.originalWidgets,!0),e&&i?(this.originalWidgets.splice(i.idx,1),e=this.widgets.splice(e.idx,1)[0],t.silent||(n=this.getWidgetsBelow(e)),!t.prevent&&this.removeFauxWidget(e),e.el.remove(),t.silent||n.forEach(function(t){this.moveWidgetUp(t,e.sizey)}.bind(this)),t.callback&&t.callback.call(this,e.el),this.options.fit&&this.fit(),this.updateGridHeight(),this):this},resize:function(t){var e=t.sizex,i=t.sizey,n=t.col,s=this.findWidget(t.widget);if(s)return e||(e=s.sizex),i||(i=s.sizey),n||(n=s.col),this.options.maxSize[0]&&(e=Math.min(e,this.options.maxSize[0]-n+1)),!this.options.fit&&this.options.maxSize[1]&&(i=Math.min(i,this.options.maxSize[1])),i>s.sizey&&this.addFauxRows(Math.max(i-s.sizey,0)),this.mutateWidget(s,{col:n,row:s.row,sizex:e,sizey:i}),t.silent||(this.options.fit&&this.fit(),this.dispatchEvent("onResize"),this.updateGridHeight()),s},update:function(t){var e,i=document.documentElement.clientWidth;return e=this.options.viewport?this.options.viewport.getSize().height:document.documentElement.clientHeight,(t||i!==this.clientWidth||e!==this.viewportHeight)&&(this.clientWidth=i,this.viewportHeight=e,this.setupGrid(!0),this.createStylesheet(),this.updateFauxGrid(),this.options.fit&&this.fit(),this.updateGridHeight()),this},serialize:function(){var e=[];return this.originalWidgets.forEach(function(i){var n,s=this.findWidget(i.el);if(!s)return!1;this.breakpoint?((n=t.extend({},i))[this.breakpoint.name]=t.extend({},s),delete n[this.breakpoint.name].el,delete n.row,delete n.col,delete n.sizex,delete n.sizey):n=t.extend({},s),delete n.el,this.options.serialize&&(n=this.options.serialize(s.el,n)),n&&e.push(n)}.bind(this)),e},toggle:function(e){if(this.events.drag&&this.events.resize)return t.is(e)||(e=!this.events.drag.disabled),this.events.drag.disabled=e,this.events.resize.disabled=e,this},destroy:function(){var t=this.options.namespace?this.options.namespace:"default";this.events.drag&&this.events.resize&&(this.events.drag.destroy(),this.events.resize.destroy()),this.events.window&&s.removeEvent(window,"resize",this.events.window),"default"!==t&&this.removeStyleTag(t),this.widgets=null,this.originalWidgets=null,this.fauxGrid=null,this.gridmap=null,this.elements=null,this.player=null,this.resized=null,this.playerCells=null,this.placeholderCells=null,this.placeholder&&this.placeholder.el&&this.placeholder.el.remove(),this.placeholder=null,this.options=null,this.events=null,this.breakpoint=null,this.breakpoints=null,this.resizeTemplate=null}};return n.extend(h)}),define("DS/UWPClientControls/LazyLoader",["UWA/Core","DS/UWPClientControls/Utils"],function(t,e){"use strict";var i,n,s,o,a,r,l,h,c,d,u,m=!0;function f(t,i){e[t+"Event"](window,"resize",r),"undefined"==typeof IntersectionObserver&&(e[t+"Event"](window,"resize",a),e[t+"Event"](i,"scroll",a),function(t,e){var i=t.scrollHeight,n=t.scrollWidth,s=window.requestAnimationFrame(function o(){window.cancelAnimationFrame(s),i===t.scrollHeight&&n===t.scrollWidth||e(),i=t.scrollHeight,n=t.scrollWidth,s=requestAnimationFrame(o)})}(i,a))}function g(t){n&&(c&&n.forEach(function(e){(function(t,e){if(Array.isArray(e))return e.map(function(t){return t.isIntersecting&&t.target}).indexOf(t)>-1;var n=t.getBoundingClientRect(),s=l+i.offset;return n.left<=h+i.offset&&n.right>=0&&(n.top>=0&&n.top<=s||n.bottom<=s&&n.bottom>=0-i.offset)})(e.element,t)&&e.element.offsetWidth>0&&e.element.offsetHeight>0&&u<i.maxSimultaneous&&s.load(e)}),d&&n.forEach(function(t){u<i.maxSimultaneous&&s.load(t)}),0===n.length&&s.destroy())}function p(){l=window.innerHeight||document.documentElement.clientHeight,h=window.innerWidth||document.documentElement.clientWidth}function v(){0===u&&(i.onQueueStable&&i.onQueueStable(),n&&i.onQueueEmpty&&0===n.length&&i.onQueueEmpty())}return s={defaultOptions:{mode:"viewport",loadedEvent:"load",loadedEventTarget:void 0,maxSimultaneous:1/0,offset:0,scrollTarget:window},init:function(s){m?(i=t.merge(s||{},this.defaultOptions),m=!1,n=[],u=0,c=-1!==["viewport","viewport-queue"].indexOf(i.mode),d=-1!==["queue","viewport-queue"].indexOf(i.mode),c&&("undefined"!=typeof IntersectionObserver&&(o=new IntersectionObserver(g,{root:i.scrollTarget instanceof Element?i.scrollTarget:void 0})),a=e.debounce(g,200),r=e.throttle(p,50),f("add",i.scrollTarget),p())):(s.sorter&&(i.sorter=s.sorter),s.forceLoad&&(i.forceLoad=s.forceLoad),s.onLoad&&(i.forceLoad=s.onLoad),s.onQueueEmpty&&(i.onQueueEmpty=s.onQueueEmpty),s.onQueueStable&&(i.onQueueStable=s.onQueueStable)),setTimeout(function(){n&&0===n.length&&v()})},load:function(t){var e=(n||[]).indexOf(t);-1!==e&&(u++,setTimeout(t.callback),n.splice(e,1))},revalidate:function(){g()},track:function(t){var a=t.element.getElement(i.loadedEventTarget)||t.element;e.addEvent(a,i.loadedEvent,function n(s){u--,e.removeEvent(s.target,s.type,n),s.stopPropagation(),i.onLoad&&i.onLoad(s,t),v()}),o&&o.observe(t.element),(n=n||[]).push(t),i.sorter&&n.sort(i.sorter),i.forceLoad&&i.forceLoad(t,function(){s.load(t)})},untrack:function(t){if(n){var e=n.map(function(t){return t.element}).indexOf(t);e>-1&&n.splice(e,1),o&&o.unobserve(t),0===n.length&&s.destroy()}},destroy:function(){i&&i.scrollTarget&&f("remove",i.scrollTarget),n&&(n.length=0),o&&(o.disconnect(),o=null),m=!0}}}),define("DS/UWPClientControls/DropdownMenu",["UWA/Core","UWA/Event","UWA/Utils","UWA/String","UWA/Controls/Abstract","DS/UWPClientControls/ClickRemover"],function(t,e,i,n,s,o){"use strict";function a(e,i,n){for(var s=0,o=e.length;s<o;s++){if(n&&e[s].items)return a(e[s],i,!1);if(void 0!==i&&i.nodeType&&i===e[s].el)return e[s];if(void 0!==i&&i.name===e[s].name)return e[s];if(void 0!==i&&t.is(i,"string")&&i===e[s].name)return e[s]}}return s.extend({MAIN_CLASS:"wp-menu",defaultOptions:{position:{}},init:function(n){var s,o,a=this;if(a._parent(n),t.is(n.target,"element")){if(this.isSectionEnabled=t.is(n.sections,"array"),this.isVisible=!1,this.id=i.getUUID(),this.items=[],this.sections=[],this.elements.target=n.target,this.isSectionEnabled)for(s=0,o=n.sections.length;s<o;s++)this.addSection(n.sections[s]);else for(s=0,o=n.items.length;s<o;s++)this.addItem(n.items[s]);n.target.addEvent("click",function(t){e.preventDefault(t),a.dispatchEvent("onTargetClick",[t]),a.elements.container?a.toggle(t):(a.buildSkeleton(),a.show(t))})}},buildSkeleton:function(){var e,i,n=t.createElement,s=this.options,o=this.elements;if(!o.container){if(o.container=n("div",{class:this.MAIN_CLASS+(s.className?" "+s.className:""),id:this.id}),o.actions=n("ul",{class:this.MAIN_CLASS+"-actions"}).inject(o.container),this.isSectionEnabled)for(e=0,i=this.sections.length;e<i;e++)this.buildSectionSkeleton(this.sections[e]);else{for(e=0,i=this.items.length;e<i;e++)this.buildItemSkeleton(this.items[e]);s.selectable&&o.container.addClassName(this.MAIN_CLASS+"-selectable")}t.is(s.renderTo,"element")?o.container.inject(s.renderTo):o.container.inject(s.target),this.updatePosition(),o.container.addEvent("click",this.eventHandler.bind(this))}},eventHandler:function(t){var i,n,s,o,a=this.options;e.stop(t),(n=this.getItemFromEvent(t))&&(this.hide(),this.isSectionEnabled?(i=[n,s=this.getSection(n.section),t],o=s.selectable):(o=a.selectable,i=[n,t]),o&&this.select(n),this.dispatchEvent("onItemClick",i))},updatePosition:function(){function e(e){return t.is(e,"function")?e():e}return function(){return this.elements.container.setPosition(e(this.options.position),e(this.options.positionOptions)),this}}(),getItemFromEvent:function(t){var i,n=e.getElement(t),s=this.MAIN_CLASS+"-action";if(n)return i=n.hasClassName(s)?n:n.getClosest("."+s),this.getItem(i)},getItem:function(t){if(t)return a(this.items,t)},getSection:function(t){if(t&&this.isSectionEnabled)return a(this.sections,t)},getSelection:function(t){var e,i=[];return this.isSectionEnabled&&t?e=[this.getSection(t)]:(this.isSectionEnabled||this.options.selectable)&&(e=this.items),e&&function t(e,i){for(var n=e.length-1;n>=0;n--)e[n].items?i.concat(t(e[n].items,i)):e[n].selected&&i.push(e[n])}(e,i),i},buildItemSkeleton:function(e){var i,n=t.createElement,s=this.options.selectable;e.section&&(s=(i=this.getSection(e.section)).selectable),e.delimiter?e.el=n("li",{class:this.MAIN_CLASS+"-delimiter"}):e.el=n("li",{class:this.MAIN_CLASS+"-action "+e.className,html:{tag:"span",class:"text",text:e.text}}),(e.icon||s)&&n("span",{class:"fonticon "+e.iconClassName}).inject(e.el,"top"),e.section?e.el.inject(i.body):e.el.inject(this.elements.actions)},addItems:function(e,i){var n=this;t.is(e,"array")&&e.forEach(function(t){n.addItem(t,i)})},addItem:function(e,s){var o,a,r,l,h=this.options.selectable,c={};if(e&&t.is(e.name,"string")&&!(e.name.length<0))return c.name=e.name,c.id=i.getUUID(),e&&e.delimiter?c.delimiter=!0:(o=n.ucfirst(e.name),r="fonticon-"+(a=e.name.toLowerCase().split(" ").join("-")),c.text=e.text||o,c.className=e.className||a,c.icon=void 0===e.icon||e.icon,c.iconClassName=e.iconClassName||r),this.isSectionEnabled&&s&&(h=(l=this.getSection(s)).selectable,void 0!==e.position?(e.position>l.items.length&&(e.position=l.items.length),l.items.splice(e.position,0,c)):l.items.push(c),c.section=l.name),h&&!c.delimiter&&(c.iconClassName="fonticon-record"),void 0!==e.position?(e.position>this.items.length&&(e.position=this.items.length),this.items.splice(e.position,0,c)):this.items.push(c),this.elements.container&&this.buildItemSkeleton(c),c},buildSectionSkeleton:function(e){var i,n,s=t.createElement;for(e.el=s("li",{class:this.MAIN_CLASS+"-section "+e.className}),e.body=s("ul").inject(e.el),e.selectable&&e.el.addClassName(this.MAIN_CLASS+"-selectable"),e.el.inject(this.elements.actions),i=0,n=e.items.length;i<n;i++)this.buildItemSkeleton(e.items[i])},addSection:function(e){var n,s,o,a={};if(e&&t.is(e.name,"string")&&!(e.name.length<0)){if(n=e.name.toLowerCase().split(" ").join("-"),a.name=e.name,a.id=i.getUUID(),a.selectable=e.selectable||!1,a.multiSelect=e.multiSelect||!1,a.className=e.className||n,a.items=[],this.sections.push(a),t.is(e.items,"array"))for(s=0,o=e.items.length;s<o;s++)this.addItem(e.items[s],a.name);return this.elements.container&&this.buildSectionSkeleton(),a}},select:function(t,e){e=void 0===e||e;var i,n,s,o,a=this.getItem(t);if(a)return i=this.isSectionEnabled&&a.section&&this.getSection(a.section)||null,this.isSectionEnabled?(s=i.selectable,o=i.multiselect):(s=this.options.selectable,o=this.options.multiselect),s&&a.selected!==e&&(o||1===(n=this.getSelection(i)).length&&(n[0].selected=!1,n[0].el.removeClassName(this.MAIN_CLASS+"-selected")),e?(a.el.addClassName(this.MAIN_CLASS+"-selected"),a.selected=!0):(n[0].selected=!1,n[0].el.removeClassName(this.MAIN_CLASS+"-selected"))),a},setItem:function(e,i){var n,s,o,a,r,l=this.getItem(e);l&&i&&(i.text&&i.text!==l.text&&(l.text=i.text,l.el&&(s=l.el.getElement(".text")).setText(l.text)),i.className&&i.className!==l.className&&(l.el?(l.el.removeClassName(l.className),l.className=i.className,l.el.addClassName(i.className)):l.className=i.className),i.icon,t.is(i.position,"number")&&(a=(o=(n=this.getSection(l.section))?n.items:o).indexOf(l),r=i.position,(i.position>=o.length||i.position<0)&&(i.position=o.length-1),a>i.position&&r--,l.el&&(0===i.position?l.el.inject(o[0].el,"before"):a-1===i.position?l.el.inject(o[i.position].el,"before"):l.el.inject(o[r].el,"after")),o.splice(i.position,0,o.splice(a,1)[0])),l.icon&&i.iconClassName&&i.iconClassName!==l.iconClassName&&(l.el?((s=l.el.getElement(".fonticon")).removeClassName(l.iconClassName),l.iconClassName=i.iconClassName,s.addClassName(i.iconClassName)):l.iconClassName=i.iconClassName))},removeItem:function(t){var e,i,n=this.getItem(t);if(n){if(this.isSectionEnabled&&n.section)for(i=(e=this.getSection(n.section)).items.length-1;i>=0;i--)if(e.items[i]===n){e.items.splice(i,1);break}for(i=this.items.length-1;i>=0;i--)if(this.items[i]===n)return n.el&&n.el.destroy(),this.items.splice(i,1),n}},removeItems:function(t){var e,i,n=this.getSection(t);if(n)n.items=[];else for(e=this.items.length-1;e>=0;e--)if(!n||this.items[e].section===n)return(i=this.items[e]).el&&i.el.destroy(),this.items.splice(e,1),i},removeSection:function(t){var e,i;if(this.isSectionEnabled&&(e=this.getSection(t))){for(i=this.items.length-1;i>=0;i--)this.items[i].section===e.name&&this.items.splice(i,1);for(i=this.sections.length-1;i>=0;i--)if(this.sections[i]===e)return e.body.destroy(),this.sections.splice(i,1),e}},toggle:function(t){this.elements.container&&(this.isVisible?this.hide(t):this.show(t))},show:function(t){var e=this.elements;e.container&&!this.isVisible&&(this.updatePosition(),this.dispatchEvent("onBeforeShowMenu",[e,t]),e.container.setStyle("display","block"),this.dispatchEvent("onShowMenu",[e,t]),o.add("dd-menu-"+this.id,this.hide.bind(this),!0),this.isVisible=!0)},hide:function(t){var e=this.elements;e.container&&this.isVisible&&(this.dispatchEvent("onBeforeHideMenu",[e,t]),e.container.setStyle("display",""),this.dispatchEvent("onHideMenu",[e,t]),o.remove("dd-menu-"+this.id),this.isVisible=!1)},destroy:function(){var t=this.elements;t.target.removeEvents(),t.container&&t.container.destroy(),this.options=null,this.items=null,this.sections=null}})}),define("DS/UWPClientControls/Modal",["UWA/Core","UWA/Element","UWA/Event","UWA/Utils/Client","UWA/Controls/Abstract","UWA/Controls/Drag","UWA/Controls/Input","UWA/Utils","DS/UWPClientControls/ModalManager"],function(t,e,i,n,s,o,a,r,l){"use strict";function h(t,e,i,n){for(var s=["webkit","moz","MS","o",""],o=0;o<s.length;o++)s[o]||(i=i.toLowerCase()),e[t+"EventListener"](s[o]+i,n,!1)}return s.extend({MAIN_CLASS:"wp-modal",defaultOptions:{className:"",display:!1,destroy:!1,displayHeader:!0,displayFooter:!0,overlay:!0,closable:!1,clickToClose:!1,resizable:!1,draggable:!1,modal:!0,maximizable:!1,animate:!0},init:function(t){this._parent(t),this.isVisible=!1,this.isMaximized=!1,this.options.draggable=this.options.draggable&&this.options.displayHeader,this.options.resizable=this.options.draggable&&this.options.resizable,this.options.clickToClose=this.options.overlay&&this.options.clickToClose,this.options.animate=n.Features.cssTransitions&&this.options.animate,this.handlers={},this.buttons=[],this.keyHandler=this.getKeyHandler(),t.display&&this.show()},setTitle:function(t){this.elements.title&&this.elements.title.setText(t)},setBody:function(t){this.elements.body&&this.elements.body.setContent(t)},getKeyHandler:function(){var t=this;return function(e){var n=i.whichKey(e),s=t.handlers[n];"function"==typeof s&&s(e)}},buildSkeleton:function(){var i=this,n=t.createElement,s=document,o=this.elements,a=this.options,r=this.MAIN_CLASS+" "+a.className;o.container||(o.overlay=s.getElementById(this.MAIN_CLASS+"-overlay"),a.draggable&&(r+=" "+this.MAIN_CLASS+"-draggable"),o.container=n("div",{class:r}),o.wrapper=n("div",{class:this.MAIN_CLASS+"-wrap"}).inject(o.container),o.content=n("div",{class:this.MAIN_CLASS+"-content"}).inject(o.wrapper),o.header=n("div",{class:this.MAIN_CLASS+"-header",html:{tag:"h1",class:this.MAIN_CLASS+"-text"}}).inject(o.content),o.body=n("div",{class:this.MAIN_CLASS+"-body"}).inject(o.content),o.footer=n("div",{class:this.MAIN_CLASS+"-footer"}).inject(o.content),o.title=o.header.getElement("h1"),(a.maximizable||a.closable)&&(o.buttons=n("div",{class:this.MAIN_CLASS+"-buttons"}).inject(o.header,"top"),a.maximizable&&n("button",{class:this.MAIN_CLASS+"-button wp-icon-maximize",events:{click:function(){i.toggleMaximize()}}}).inject(o.buttons,"top"),a.closable&&n("button",{class:this.MAIN_CLASS+"-button wp-svg-delete",events:{click:function(){i.hide()}}}).inject(o.buttons,"top")),a.displayHeader||o.header.hide(),a.displayFooter||o.footer.hide(),a.animate&&o.container.addClassName("animate"),a.buttons&&this.addButtons(a.buttons),a.modal&&l.register(this),this.setTitle(a.title),this.setBody(a.content),a.renderTo?e.inject.call(o.container,a.renderTo):e.inject.call(o.container,s.body),a.overlay&&(o.overlay||(o.overlay=n("div",{class:this.MAIN_CLASS+"-overlay",id:this.MAIN_CLASS+"-overlay"}),a.animate&&o.overlay.addClassName("animate"),s.body.appendChild(o.overlay))))},addButton:function(t){var e,i=this.elements,n=t.context||this;if(i.container)return e=new a.Button({className:void 0!==t.className?t.className:"",value:void 0!==t.value?t.value:"",events:t.handler?{onClick:function(e){t.handler.call(n,e)}}:{}}),t.handler&&t.key&&(this.handlers[t.key]=t.handler.bind(n)),t.element=e,this.buttons.push(t),e.inject(i.footer),e},addButtons:function(e){var i=this;return t.is(e,"array")?e.map(function(t){return i.addButton(t)}):i.addButton(e)},getButtonIndex:function(t){var e=-1,i=this.buttons;if(this.elements.container){if("string"==typeof t){for(var n=i.length-1;n>=0;n--)if(i[n].value===t){e=n;break}}else"number"==typeof t&&i[t]&&(e=t);return e}},getButton:function(t){var e=this.getButtonIndex(t);if(-1!==e)return this.buttons[e].element},removeButton:function(t){var e=this.getButtonIndex(t),i=this.buttons;-1!==e&&(i[e].element.destroy(),i.splice(e,1))},attachEvents:function(){var t=this,n=this.options,s=this.elements;n.draggable&&this.attachDragEvent(),n.clickToClose&&(n.draggable?s.overlay:s.container).addEvent("click",function(e){var n=i.getElement(e);n&&(n.hasClassName(t.MAIN_CLASS)||n.hasClassName(t.MAIN_CLASS+"-overlay"))&&t.hide()}),e.addEvent.call(document.body,"keydown",this.keyHandler)},removeEvents:function(){var t=this.options,i=this.elements;t.draggable&&this.drag.destroy(),t.clickToClose&&(t.draggable?i.overlay:i.container).removeEvent("click"),e.removeEvent.call(document.body,"keydown",this.keyHandler)},attachDragEvent:function(){var t,e=this,i={x:0,y:0},n="."+this.MAIN_CLASS+"-header, ."+this.MAIN_CLASS+"-header > *";t=o.extend({call:function(t,e){var i=this.options[t];if(i)return r.attempt(i,0,null,this.context,e)},start:function(t){this._parent(t),this.context=Object.create(this),this.call("start")},move:function(t,e){this._parent(t,e),this.call("move")}}),this.drag=new t({delegate:n,document:document,start:function(){i.x=parseFloat(e.elements.container.getStyle("left")),i.y=parseFloat(e.elements.container.getStyle("top")),e.elements.container.setStyles({left:i.x,top:i.y})},move:function(t){e.elements.container.setStyles({left:t.currentDelta.x+i.x,top:t.currentDelta.y+i.y})}})},toggleMaximize:function(){var t,e=this.options,i=this.elements;i.container&&(e.maximizable&&this.isMaximized?(e.draggable&&(this.drag.attach(),(t=i.header.getElement(".wp-icon-minimize")).removeClassName("wp-icon-minimize"),t.addClassName("wp-icon-maximize"),i.container.setStyles({top:this.minimizedPosition.top,left:this.minimizedPosition.left}),i.container.addClassName(this.MAIN_CLASS+"-draggable")),i.container.removeClassName(this.MAIN_CLASS+"-maximized"),this.dispatchEvent("onMinimize"),this.isMaximized=!1):e.maximizable&&!this.isMaximized&&(e.draggable&&(this.drag.detach(),(t=i.header.getElement(".wp-icon-maximize")).removeClassName("wp-icon-maximize"),t.addClassName("wp-icon-minimize"),this.minimizedPosition={left:parseFloat(i.container.getStyle("left")),top:parseFloat(i.container.getStyle("top"))},i.container.setStyles({top:"",left:""}),i.container.removeClassName(this.MAIN_CLASS+"-draggable")),i.container.addClassName(this.MAIN_CLASS+"-maximized"),this.dispatchEvent("onMaximize"),this.isMaximized=!0))},destroy:function(){var t=this,e=this.options,i=this.elements;e.destroy=!1,e.animate&&this.hidding?this.destroyed=!0:(i.container&&(this.destroyed=!1,this.hide(function(){l.unregister(t),i.container.destroy(),delete t.elements})),this.handlers=null,this.buttons=null,this.keyHandler=null)},show:function(){var t,i=this,n=this.elements,s=this.options;n.container||this.buildSkeleton(),s.overlay&&n.overlay.addClassName("visible"),s.modal?(e.addClassName.call(document.body,this.MAIN_CLASS+"-open"),(t=l.getActive())?(this.previousModal=t,t.display(!1,function(){i.display(!0)})):this.display(!0)):this.display(!0)},hide:function(t){var i=this,n=this.elements,s=this.options;function o(){!s.overlay||i.previousModal&&i.previousModal.elements&&i.previousModal.options.overlay||(n.overlay.removeClassName("hidding"),n.overlay.removeClassName("visible")),!s.modal||i.previousModal&&i.previousModal.elements&&i.previousModal.options.modal||e.removeClassName.call(document.body,i.MAIN_CLASS+"-open"),"function"==typeof t&&t(),s.destroy&&i.destroy()}n.container&&(!s.overlay||this.previousModal&&this.previousModal.elements&&this.previousModal.options.overlay||s.animate&&n.overlay.addClassName("hidding"),this.display(!1,function(){s.modal&&i.previousModal&&i.previousModal.elements?i.previousModal.display(!0,o):o()}))},display:function(t,e){var i=this,n=this.options,s=this.elements;function o(){i.hidding=!1,n.animate&&h("remove",s.wrapper,"AnimationEnd",o),i.isVisible?(i.attachEvents(),i.dispatchEvent("onShow"),"function"==typeof e&&e()):(s.container.removeClassName("hidding"),s.container.removeClassName("visible"),i.removeEvents(),i.dispatchEvent("onHide"),"function"==typeof e&&e(),i.destroyed&&i.destroy())}this.isVisible!==t?(this.isVisible=t,n.animate&&(this.hidding=!0,h("add",s.wrapper,"AnimationEnd",o)),this.isVisible?(l.setActive(i,!0),s.container.addClassName("visible")):(l.setActive(i,!1),s.container.addClassName("hidding")),n.animate||o()):("function"==typeof e&&e(),this.destroyed&&this.destroy())}})}),define("DS/UWPClientControls/DockLayout/AbstractContainer",["UWA/Class","DS/UWPClientControls/DockLayout/Utils"],function(t,e){"use strict";var i="Child unknown to element";function n(){throw new Error("Incomplete method of abstract class")}function s(t){if(!this.childExists(t))throw new Error(i)}return t.extend({init:function(){var t;Object.defineProperty(this,"manager",{get:function(){if(t)return t;for(var e=this;"root"!==e.type;)e=e.container;return e.manager},set:function(e){t=e}}),Object.defineProperty(this,"size",{get:function(){var t=this.manager.containersDimensions.get(this);return t||(t={},this.manager.containersDimensions.set(this,t)),t}}),Object.defineProperty(this,"width",{get:function(){return this.size.width},set:function(t){this.size.width=t}}),Object.defineProperty(this,"height",{get:function(){return this.size.height},set:function(t){this.size.height=t}})},childExists:n,addChild:n,removeChild:s,replaceChild:s,remove:function(){this.container.removeChild(this)},duplicate:function(t){var e,i=require("DS/UWPClientControls/DockLayout/RowOrColumn"),n=this.getRectangle(),s=this.container,o=new i({type:n.width<(this.isMinimized()?this.container&&"column"===this.container.type?this.heightCache:this.container.getRectangle().height:n.height)?"column":"row",container:this.container,weight:this.weight});return this.weight=50,this.container=o,o.addChild(this),e=this.getCopy(),o.addChild(e),s.replaceChild(this,o),t&&(this.manager.paint(),this.manager.onChange("duplicate")),e},getCopy:n,getGridCoordinates:function(){function t(t,e){return t.container.content.slice(0,t.container.content.indexOf(t)).map(function(t){return t.getMaxAlignedElementCount(e)}).reduce(function(t,e){return t+e},0)}if(!this.container)return{x:0,y:0};var e=this.container.getGridCoordinates();return"root"===this.container.type?e:{x:e.x+(this.container.isRow?t(this,"width"):0),y:e.y+(this.container.isColumn?t(this,"height"):0)}},getRectangle:function(){return this.container.getChildRectangle(this)},getChildRectangle:s,getMinSize:n,getMaxAlignedElementCount:n,updateSize:function(t){function i(t,e){return Array.apply(null,Array(t)).map((0).valueOf,e)}var n=function(t){var n=e.toMap([]),s=e.toMap([]),o=0,a=[];return t.forEach(function(t){t.factors.forEach(function(t,e){s.has(e)||(n.set(o,e),s.set(e,o),++o)})}),t.forEach(function(t){var e=i(o+1,0);t.factors.forEach(function(t,i){e[s.get(i)]=t}),e[e.length-1]=t.result,a.push(e)}),{matrix:a,indexMapping:n}}(function(t,i){var n=t.getContentSizeRelations(i);return n.reduce(function(e,i){return e||1===i.factors.size&&1===i.factors.get(t)},!1)||n.unshift({factors:e.toMap([[t,1]]),result:t[i]}),n}(this,t));(function(t){var e,n,s,o,a,r,l,h,c=t.length;for(t=t.slice().map(function(t){return t.slice()}),e=0;e<c;++e){for(o=Math.abs(t[e][e]),a=e,n=e+1;n<c;++n)Math.abs(t[n][e])>o&&(o=Math.abs(t[n][e]),a=n);for(r=t[a],t[a]=t[e],t[e]=r,n=e+1;n<c;++n)for(l=-t[n][e]/t[e][e],s=e;s<c+1;++s)e===s?t[n][s]=0:t[n][s]+=l*t[e][s]}for(h=i(c,0),e=c-1;e>=0;--e)for(h[e]=t[e][c]/t[e][e],n=e-1;n>-1;--n)t[n][c]-=t[n][e]*h[e];return h})(n.matrix).forEach(function(e,i){n.indexMapping.get(i)[t]=e}),this.fixConstraintViolations(t)},updateRectangle:n,paint:function(){this.updateSize("width"),this.updateSize("height"),this.updateRectangle()},getDropTargets:n,dropItemAt:n,isMinimized:n,getContentSizeRelations:n,fixConstraintViolations:n,toJSON:function(){return{type:this.type,weight:this.weight,content:this.content}}})}),define("DS/UWPClientControls/DockLayout/PlayerDragUtils",["DS/UWPClientControls/DockLayout/DropTargetIndicator","DS/UWPClientControls/DockLayout/Utils"],function(t,e){"use strict";var i,n,s,o,a={dragStart:function(e){var i=e.event,o=e.manager,r=e.element,l=a.getEventClientX(i),h=a.getEventClientY(i),c=r?r.getOffsets():{x:0,y:0};n={x:l-c.x,y:h-c.y},s=[];for(var d=0;d<("number"==typeof e.itemCount?e.itemCount:1);++d)s.push(new t({manager:o}));e.onDrag&&e.onDrag(),r&&(r.addClassName("dock-dragging"),r.setStyle("z-index",4)),o.paint(),s.forEach(function(t){t.show()}),a._updateDropIndicators(a._getSafeVisibleDropTarget({manager:o,x:l,y:h}))},drag:function(t){var e=t.event,i=t.manager,s=a.getEventClientX(e),o=a.getEventClientY(e),r=i.getRelativeCoordinates(s,o);a._updateDropIndicators(a._getSafeVisibleDropTarget({manager:i,x:s,y:o})),t.element&&t.element.setStyles({left:r.x-n.x,top:r.y-n.y})},dragStop:function(t){if(n){var e=t.event,i=t.manager,s=a._getSafeVisibleDropTarget({manager:i,x:a.getEventClientX(e),y:a.getEventClientY(e)});t.onDrop&&t.onDrop(s),i.paint(),i.onChange(t.changeEventName),this.dragCleanup({element:t.element})}},dragCleanup:function(t){var e=(t||{}).element;(s||[]).forEach(function(t){t.remove()}),e&&(e.removeClassName("dock-dragging"),e.setStyle("z-index","")),n=void 0,s=void 0,o=void 0},getEventClientX:function(t){return a._getEventClientPosition(t).x},getEventClientY:function(t){return a._getEventClientPosition(t).y},_getEventClientPosition:function(t){var e={x:t.clientX||((t.targetTouches||[])[0]||{}).clientX||i.x,y:t.clientY||((t.targetTouches||[])[0]||{}).clientY||i.y};return i=e,e},_getSafeVisibleDropTarget:function(t){var i=t.manager,n=i.element.getSize(),s=i.getRelativeCoordinates(t.x,t.y),a=e.clamp({x:s.x,minX:0,maxX:n.width-1,y:s.y,minY:0,maxY:n.height-1});return o=i.getDropTargetAt(a.x,a.y)||o},_updateDropIndicators:function(t){if(t){var i=e.divideRectangle(t.indicatorRectangle,s.length);s.forEach(function(t,e){t.setRectangle(i[e])})}}};return a}),define("DS/UWPClientControls/DockLayout/Root",["DS/UWPClientControls/DockLayout/AbstractContainer","DS/UWPClientControls/DockLayout/DropTarget","DS/UWPClientControls/DockLayout/Utils"],function(t,e,i){"use strict";return t.extend({init:function(t){this._parent(),this.type="root",this.manager=t.manager,this.content=t.content||null},childExists:function(t){return this.content&&this.content===t},addChild:function(t){if(this.content)throw new Error("Cannot add any new children to root");this.content=t},removeChild:function(t){this._parent(t),this.content=void 0},replaceChild:function(t,e){this._parent(t),this.content=e},remove:function(){throw new Error("Cannot remove root element")},duplicate:function(){throw new Error("Root cannot be duplicated")},getCopy:function(){throw new Error("Root cannot be copied")},getGridCoordinates:function(){if(!this.content)throw new Error("Cannot provide grid coordinates of empty root element");return{x:0,y:0}},getRectangle:function(){return{left:0,top:0,width:this.width,height:this.height}},getChildRectangle:function(t){return this._parent(t),this.getRectangle()},getDropTargets:function(){var t;return this.content?this.content.getDropTargets(1):(t=this.getRectangle(),[new e({dropRectangle:t,indicatorRectangle:t,mousePolygon:[{x:t.left,y:t.top},{x:t.left+t.width,y:t.top},{x:t.left+t.width,y:t.top+t.height},{x:t.left,y:t.top+t.height}],container:this,name:"root",priority:0})])},dropItemAt:function(t,e){if("root"!==t)throw new Error("Unknown drop area");this.addChild(e),e.container=this},updateRectangle:function(){this.content&&this.content.updateRectangle()},getMinSize:function(t){var e=this.content?this.content.getMinSize(t):0;return"width"===t?Math.max(this.manager.element.clientWidth,e):this.isMinimized()?e:Math.max(this.manager.element.clientHeight,e)},getMaxAlignedElementCount:function(t){return this.content?this.content.getMaxAlignedElementCount(t):0},isMinimized:function(){return this.content&&this.content.isMinimized()},getContentSizeRelations:function(t){var e=[];return e.push({factors:i.toMap([[this,1]]),result:this.getMinSize(t)}),this.content&&e.push({factors:i.toMap([[this.content,1],[this,-1]]),result:0}),e.concat(this.content?this.content.getContentSizeRelations(t):[])},fixConstraintViolations:function(t){this.content&&this.content.fixConstraintViolations(t)}})}),define("DS/UWPClientControls/EditableTab",["UWA/Core","UWA/Element","UWA/Controls/TabView","DS/UWPClientControls/EditInPlace","DS/UIKIT/Tooltip","i18n!DS/UWPClientControls/assets/nls/tooltips"],function(t,e,i,n,s,o){"use strict";return i.Tab.extend({defaultOptions:{className:"",classNames:{tabPanel:"wp-tab-panel",tab:"wp-tab",selected:"selected",disabled:"disabled"},editable:!1},init:function(t){this._parent(t)},_createInnerTabElement:function(){var e,i=t.createElement,n=this.elements,a=this.options;if(e=i("div",{class:"inner-ctn",html:[{tag:"span",class:"title",text:this.getText()||"."}]}),a.menuItems){var r=i("span",{class:"action fonticon fonticon-down-open"}).inject(e,"top");new s({position:"bottom",target:r,body:o.menu,offset:{x:0,y:0},closeOnClick:!0})}return e.addContent({tag:"div",class:"underline-tab-el"}),n.title=e.getElement(".title"),n.action=e.getElement(".action"),this.buildTooltip(),e},tabElement:function(){return this.elements.container||(this.elements.container=this._createTabElement(),this.options.className&&this.elements.container.addClassName(this.options.className),this.options.icon&&this.setIcon(this.options.icon),this.options.id&&this.elements.container.setAttribute("data-tabId",this.options.id)),this.elements.container},contentElement:function(){return this.elements.content||(this.elements.content=this._createContentElement(),this.elements.content&&this.elements.content.addClassName("hidden")),this.elements.content},setName:function(t){this.options.name!==t&&(this.options.name=t,this.setText(t))},isEditable:function(){return this.options.editable},setText:function(t){var e=this.options,i=this.elements;return t&&e.text!==t&&(i.title.setText(t),e.text=t,e.name=t,this.buildTooltip(),this.dispatchEvent("onTextChanged",this)),this},editText:function(){var t,e,i,s,o="editing",a=this,r=a.editor;function l(){s.removeClassName(o),a.editor=null}r?a.endEditText():a.options.editable&&(i=(t=a.elements).title,(s=t.container).addClassName(o),e=i.getText(),a.editor=r=new n(i,{maxLength:50,autoEdit:!1,emptyText:!1,growInputAsUserType:!0,onEdit:function(t){(t=t.trim())?a.setText(t):a.setText("temp").setText(e),l()},onCancel:l,onComplete:l}),r.edit())},hide:function(){return this.getContent().hide(),this.options.hidden=!0,this.dispatchEvent("onHide")},show:function(){return this.getContent().show(),this.options.hidden=!1,this.dispatchEvent("onShow")},endEditText:function(t){var e=this.editor;e&&e.endEdit(!!t)},hideTooltip:function(){this.elements.tooltipTitle&&this.elements.tooltipTitle.hide()},destroyTooltip:function(){this.elements.tooltipTitle&&(this.elements.tooltipTitle.destroy(),this.elements.tooltipTitle=null)},buildTooltip:function(){var t=this;t.destroyTooltip(),clearTimeout(t._buildTooltipTimeout),t._buildTooltipTimeout=setTimeout(function(){var e=t.elements||{},i=e.title;i&&i.clientWidth>=250&&(e.tooltipTitle=new s({position:"bottom",target:i,body:t.getText(),offset:{x:0,y:0},closeOnClick:!0}))},300)}})}),define("DS/UWPClientControls/EditableTabview",["UWA/Core","UWA/Event","UWA/Utils/Client","UWA/Controls/TabView","UWA/Controls/Drag","DS/UIKIT/DropdownMenu","DS/UIKIT/Tooltip","DS/UWPClientControls/EditableTab","DS/UWPClientControls/Utils","i18n!DS/UWPClientControls/assets/nls/tooltips"],function(t,e,i,n,s,o,a,r,l,h){"use strict";return n.extend({defaultOptions:{showTabs:!0,editable:!1,allowNewTab:!1,className:"",classNames:{scroller:"wp-tablist-scroller",scrollerButton:"wp-scroller-button",tabMenu:"wp-tab-dd-menu",tab:"wp-tab",tabDirectAdd:"wp-tab-directadd",tabAddList:"wp-tab-addlist",tabAddListMenu:"wp-tab-add-list-dd-menu",tabView:"wp-tabview",tabList:"wp-tablist",selected:"selected",tabPanels:"wp-tabview-panel"}},menu:null,_firstRenderInterval:null,_tabsPositionBeforeReorder:null,init:function(e){this._parent(e);var i=this,n=this.elements,s=this.options.classNames.scroller,o=i.options.editable;this.options.allowNewTab=o+this.options.allowNewTab,this.options.showTabs?(this.options.tabSelector="."+this.options.classNames.tab,t.createElement("div",{class:s+"-ctn",events:{resize:function(){i.onResize()}}}).grab(n.container.getElement("."+s)).inject(n.container,"top"),n.scroller=n.container.getElement("."+s),n.scrollerContainer=n.container.getElement("."+s+"-ctn"),this._fixIosStylusEvents(this),o&&this.attachReorder()):this.hideTabList()},buildContainer:function(){this._parent();var e=this.options,i=e.classNames,n=t.createElement,s=this.elements;e.showTabs&&(e.scroller={className:i.scroller,scrollButtonClassName:i.scrollerButton,nextButton:function(t){var o=n("div",{class:i.scrollerButton+" icon fonticon fonticon-right-open"}),a=n("div",{class:[i.tabAddList,"icon fonticon",e.allowNewTab?"fonticon-list-add":"fonticon-list"].join(" ")});return s.tabAddListBtn=a,n("div",{class:i.scrollerButton+"-ctn next",html:[o,a]}).inject(t),o},previousButton:function(t){var e=n("div",{class:i.scrollerButton+" icon fonticon fonticon-left-open"});return n("div",{class:i.scrollerButton+"-ctn previous",html:e}).inject(t,"top"),e}},e.allowNewTab&&e.editable&&(s.tabDirectAddBtn=n("li",{class:i.tabDirectAdd,html:[{tag:"div",class:"fake-content",html:"&nbsp;"},{tag:"span",class:"icon fonticon fonticon-plus"}],events:{click:l.debounce(this.dispatchEvent.bind(this,"onNewTab"))}}).inject(s.tabList),new a({position:"bottom",target:s.tabDirectAddBtn,body:h.addTab,offset:{x:0,y:0},closeOnClick:!0}))),this.options.onBuildContainer&&this.options.onBuildContainer.call(null,this)},handleEvent:function(i){var n=this.getTabFromEvent(i),s=e.getElement(i);n&&(n===this.selectedTab?(s.hasClassName("title")&&n.editText(),t.is(n.handleEvent,"function")&&n.handleEvent(i,this),this.options.allowReload&&this.selectTab(n,i)):n.isDisabled()||this.selectTab(n,i))},onPreSelectTab:function(t,e){var i=e||t;i&&e!==t&&i.endEditText(!0)},onResize:function(){if(this._parent.apply(this,arguments),this.selectedTab&&!this._firstRenderInterval){var t=this.elements.scroller,e=t&&t.getElement(".scrollable"),i=0;if(t&&e){this._firstRenderInterval=this._firstRenderInterval||setInterval(function(){if(i>=10)return clearInterval(this._firstRenderInterval);t&&e&&t.clientWidth<e.clientWidth?this.scroller.onRefresh():++i}.bind(this),100)}}},addTab:function(e,i){var n,s=this,o=s.options,a=s.elements,l=a.tabDirectAddBtn,h=s.tabs[s.tabs.length-1];return e instanceof r==!1&&(["editable","menuItems"].forEach(function(t){e[t]=void 0!==e[t]?e[t]:o[t]}),e=new r(e)),t.is(i,"number")&&i+1<s.tabs.length&&i>=0?(e.tabElement().inject(s.getTab(i).tabElement(),"before"),s.tabs.splice(i,0,e)):(a.tabList.grab(e.tabElement()),s.tabs.push(e)),e.options.hidden&&e.elements&&e.elements.container&&t.extendElement(e.elements.container).hide(),a.contentNode&&(n=e.contentElement())&&(h?h.contentElement()&&h.contentElement().grab(n,"after"):a.contentNode.grab(n,"top")),e.options.selected&&s.selectTab(e),o.showTabs&&(s.menu&&!e.options.hidden&&s.menu.addItem(s._createTabDDItem(e.options)),e.options.menuItems&&s.attachMenu(e),e.options.editable&&(l&&(l=l.remove(),a.tabList.addContent(l)),e.addEvent("onTextChanged",function(){s.menu&&s.menu.updateItem({id:e.options.id,text:e.getText()}),s.dispatchEvent("onTabTextChanged",e,e.getText())}),e.elements.container.addClassName("wp-drop"),e.elements.container.addEventListener("dragenter",s.onDragEnter.bind(s))),s.onResize()),s.dispatchEvent("onAddTab",[e]),e},removeTab:function(t){return this.menu&&this.menu.removeItem(t),this._parent.apply(this,arguments)},onDragEnter:function(t){var e=this.getTabFromEvent(t);this.selectTab(e,t)},onOverflowChange:function(t){var e=this;if(t.overflow){setTimeout(function(){e.selectedTab&&e.scrollToTab(e.selectedTab)},100),!e.menu&&e._createOverflowDDMenu()}else e._destroyOverflowDDMenu()},onReorderTabsFailure:function(){var t=this;(t._tabsPositionBeforeReorder||[]).forEach(function(e){t.moveTab(e.tab.elements.container,e.index)})},attachReorder:function(){var e=this,i=e.options,n=e.elements;new s.Move({snap:30,container:n.scroller,root:n.tabList,delegate:"> li :not(input),> li",fixed:function(i,n){var s=t.extendElement(n).getClosest("li"),o=e.getTab(s);return!o||!o.isEditable()},handles:function(n){var s,o=i.classNames;return n.target=t.extendElement(n.target).getClosest("li"),n.placeholder=t.createElement("li",{class:o.tab+" placeholder",html:"&nbsp;",styles:{width:n.target.getSize().width+14}}).inject(n.target,"after"),s=n.target.getPosition(n.target.getOffsetParent()),e.getTab(n.target).destroyTooltip(),e._tabsPositionBeforeReorder=e.tabs.map(function(t,e){return{tab:t,index:e}}),n.target.setStyles({left:s.x+"px",top:s.y+"px"}).addClassName("dragged")},move:function(t){t.limited.left?e.scroller.autoScrollPrevious():t.limited.right?e.scroller.autoScrollNext():e.scroller.stopScroll()},enter:function(t){return t.placeholder},drop:function(t){var i=t.zone.getElements("li:not(.dragged)").indexOf(t.placeholder);e.moveTab(t.target,i)&&(e.menu&&e._createOverflowDDMenu(),e.dispatchEvent("onReorderTabs"))},stop:function(t){t.placeholder.destroy(),e.scroller.stopScroll(),t.target.removeClassName("dragged").setStyles({top:"",left:""}),e.getTab(t.target).buildTooltip()}})},attachMenu:function(e){var i=this,n=e.options.menuItems;!e.menu&&t.is(n,"array")&&n.length>0&&(e.menu=new o({className:i.options.classNames.tabMenu,target:e.elements.action,renderTo:this.elements.scrollerContainer,items:n,events:{onClick:function(t,n){i.dispatchEvent("onTabMenuItemClick",[e,n,t])},onShow:function(){this.options.target.addClassName("active")},onHide:function(){this.options.target.removeClassName("active")}}}))},destroy:function(){this._destroyOverflowDDMenu(),this._firstRenderInterval&&(clearInterval(this._firstRenderInterval),this._firstRenderInterval=null),this.options=null,this.tabs=null,this.selectedTab=null,this.scroller=null,this._tabsPositionBeforeReorder=null,this._parent.apply(this,arguments)},_fixIosStylusEvents:function(){if("ios"===i.Platform.name){var t,e,n=this.elements.scrollerContainer,s=0,o={capture:!0,passive:!1};n.addEventListener("touchstart",function(e){e.touches&&1===e.touches.length&&(t=e.touches[0],s=0)},o),n.addEvent("touchmove",function(i){t&&(e=i.touches[0],++s)},o),n.addEvent("touchend",function(i){if(t){e||(e=t);var n=t.pageX-e.pageX,o=t.pageY-e.pageY;Math.sqrt(n*n+o*o)<10&&s<2&&i.target!==document.activeElement&&(i.preventDefault(),document.activeElement.blur(),i.target.click()),t=e=void 0}},o)}},_createTabDDItem:function(t){return{id:t.id,name:t.id,text:t.text,className:"existing-tab-item",selectable:!0}},_createOverflowDDMenu:function(){var t,e=this,i=e.elements,n=e.options,s=i.tabAddListBtn;t=e.tabs.filter(function(t){return!t.options.hidden}).map(function(t){return e._createTabDDItem(t.options)}),n.allowNewTab&&t.unshift({id:"addTab",name:"addTab",text:h.addTab,icon:"add-new-tab-icon fonticon fonticon-plus",className:"add-new-tab-item",selectable:!1}),e._destroyOverflowDDMenu(),e.menu=new o({className:n.classNames.tabAddListMenu,target:s,renderTo:e.elements.scrollerContainer,position:"bottom right",offset:{y:2,x:0},items:t,events:{onClick:function(t,i){"addTab"===i.name?e.dispatchEvent("onNewTab"):e.selectTab(i.name,t)},onShow:function(){var t=e.selectedTab.options.id;this.options.target.addClassName("active"),this.isSelected(t)||this.toggleSelection(this.getItem(t))},onHide:function(){this.options.target.removeClassName("active")}}})},_destroyOverflowDDMenu:function(){this.menu&&(this.menu.hide(),this.menu.destroy()),this.menu=null}})}),define("DS/UWPClientControls/DockLayout/Splitter",["UWA/Core","UWA/Class/View","DS/UWPClientControls/DockLayout/Utils","DS/UWPClientControls/DockLayout/PlayerDragUtils"],function(t,e,i,n){"use strict";var s;return e.extend({init:function(e){var i;this._parent(),this.container=e.container,i=this.container.manager,this.thickness=i.sizes.splitter,this.isVertical=!!e.isVertical,this.isHorizontal=!this.isVertical,this.element=t.createElement("div",{class:"dock-splitter "+(this.isVertical?"vertical":"horizontal")}),this.element.dockSplitter=this,this.element.setStyle(this.isVertical?"width":"height",this.thickness),this.element.setStyle("position","absolute"),this.element.onDragStart=this.onDragStart.bind(this),this.element.onDrag=this.onDrag.bind(this),this.element.onDragStop=this.onDragStop.bind(this),this.position={left:0,top:0},i.element.appendChild(this.element)},setLength:function(t){this.element.setStyle(this.isVertical?"height":"width",t)},setPosition:function(t){this.position=t,this.element.setStyles({left:t.left,top:t.top})},setEnabled:function(t){this.enabled=t,this.enabled?this.element.removeClassName("dock-splitter-disabled"):this.element.addClassName("dock-splitter-disabled")},remove:function(){this.element.remove()},onDragStart:function(t){var e=this.container.manager;this.enabled&&e.enabled&&(s=e.getRelativeCoordinates(n.getEventClientX(t),n.getEventClientY(t)),this.element.addClassName("dock-dragging"))},onDrag:function(t){if(this.enabled&&this.container.manager.enabled&&s){var e,o,a,r,l,h,c,d,u,m,f,g=this.container,p=g.manager,v=this.thickness,w=g.splitters.indexOf(this);if(-1===w)throw new Error("Unknown splitter");o=this.position,e=p.getRelativeCoordinates(n.getEventClientX(t),n.getEventClientY(t)),l=g.content[w],h=g.content[w+1],c=l.getRectangle(),d=h.getRectangle(),u=l.getMinSize(this.isVertical?"width":"height"),m=h.getMinSize(this.isVertical?"width":"height"),a=i.clamp({x:e.x-v/2,minX:c.left-v/2+u,maxX:d.left+d.width-v/2-m,y:e.y-v/2,minY:c.top-v/2+u,maxY:d.top+d.height-v/2-m}),r={left:this.isVertical?a.x:o.left,top:this.isHorizontal?a.y:o.top},this.setPosition(r),f=(l.weight+h.weight)*(g.isRow?(r.left-o.left)/(c.width+d.width):(r.top-o.top)/(c.height+d.height)),l.weight+=f,h.weight-=f,g.paint()}},onDragStop:function(){var t=this.container.manager;this.enabled&&t.enabled&&s&&(t.onChange("resize"),this.element.removeClassName("dock-dragging"),s=void 0)}})}),define("DS/UWPClientControls/DockLayout/RowOrColumn",["DS/UWPClientControls/DockLayout/AbstractContainer","DS/UWPClientControls/DockLayout/Splitter","DS/UWPClientControls/DockLayout/DropTarget","DS/UWPClientControls/DockLayout/Utils"],function(t,e,i,n){"use strict";var s=t.extend({init:function(t){if(this._parent(),-1===["row","column"].indexOf(t.type))throw new Error("Invalid type: "+t.type);this.type=t.type||"row",this.isRow="row"===this.type,this.isColumn=!this.isRow,this.container=t.container,this.weight=t.weight,this.content=t.content||[],this.splitters=[]},_matchesItemFlowDirection:function(t){return"width"===t&&this.isRow||"height"===t&&this.isColumn},childExists:function(t){return this.content.length>0&&this.content.indexOf(t)>-1},addChild:function(t,e){var i,n,s,o=this.content.length;if(t.type===this.type){for(n=t.splitters.length,s=0;s<n;++s)t.removeSplitter(0);return i=t.getTotalChildrenWeight(),void t.content.forEach(function(n,s){n.weight*=t.weight/i,n.container=this,this.addChild(n,("number"==typeof e?e:o)+s)},this)}"number"==typeof e?this.content.splice(e,0,t):this.content.push(t),this.content.length>=2&&this.addSplitter()},removeChild:function(t){this._parent(t);var e,i=this.content.lastIndexOf(t);this.content.splice(i,1),this.splitters.length>0&&this.removeSplitter(Math.min(i-1,0)),1===this.content.length&&((e=this.content[0]).container=this.container,e.weight=this.weight,this.container.replaceChild(this,e))},duplicate:function(){return this._parent.apply(this,arguments)},getCopy:function(){var t=new s({type:this.type,container:this.container,weight:this.weight});return this.content.forEach(function(e){var i=e.getCopy();t.addChild(i),i.container=t}),t},getGridCoordinates:function(){return this._parent.apply(this,arguments)},replaceChild:function(t,e){this._parent(t);var i=this.content.indexOf(t);this.addChild(e,i),this.removeChild(t)},addSplitter:function(){this.splitters.push(new e({container:this,isVertical:this.isRow}))},removeSplitter:function(t){if(t>=this.splitters.length)throw new Error("Unknown splitter index: "+t);this.splitters.splice(t,1)[0].remove()},getTotalChildrenWeight:function(){return this.content.map(function(t){if(!("weight"in t))throw new Error("row/column children must define a weight");return t.weight}).reduce(function(t,e){return t+e},0)},getChildRectangle:function(t){this._parent.apply(this,arguments);var e=this.getRectangle(),i=this.content.slice(0,this.content.indexOf(t)).reduce(function(t,e){return t+e[this.isRow?"width":"height"]}.bind(this),0);return{left:e.left+(this.isRow?i:0),top:e.top+(this.isColumn?i:0),width:t.width,height:t.height}},_makeDropTarget:function(t,e){var n,s,o,a,r,l=this.manager.sizes.splitter;function h(e,i){switch(t){case"top":return{left:n.left,top:n.top,width:n.width,height:i};case"right":return{left:n.left+n.width-e,top:n.top,width:e,height:n.height};case"bottom":return{left:n.left,top:n.top+n.height-i,width:n.width,height:i};case"left":return{left:n.left,top:n.top,width:e,height:n.height}}}return n=this.getRectangle(),s={left:n.left+l/2,top:n.top+l/2,width:n.width-l,height:n.height-l},o=h(20,20),a=h(this.isRow?n.width/(this.content.length+1):n.width/2,this.isColumn?n.height/(this.content.length+1):n.height/2),r=function(){switch(t){case"top":return[{x:s.left,y:n.top},{x:s.left+20,y:n.top+20},{x:s.left+s.width-20,y:n.top+20},{x:s.left+s.width,y:n.top}];case"right":return[{x:n.left+n.width,y:s.top},{x:n.left+n.width-20,y:s.top+20},{x:n.left+n.width-20,y:s.top+s.height-20},{x:n.left+n.width,y:s.top+s.height}];case"bottom":return[{x:s.left+s.width,y:n.top+n.height},{x:s.left+s.width-20,y:n.top+n.height-20},{x:s.left+20,y:n.top+n.height-20},{x:s.left,y:n.top+n.height}];case"left":return[{x:n.left,y:s.top+s.height},{x:n.left+20,y:s.top+s.height-20},{x:n.left+20,y:s.top+20},{x:n.left,y:s.top}]}}(),new i({dropRectangle:a,indicatorRectangle:o,mousePolygon:r,container:this,name:t,priority:e})},getDropTargets:function(t){return void 0===t&&(t=1),["top","right","bottom","left"].map(function(e){return this._makeDropTarget(e,t)},this).concat(this.content.map(function(e){return e.getDropTargets(t+1)}).reduce(function(t,e){return t.concat(e)},[]))},dropItemAt:function(t,e){var i,n,o=-1!==["left","right"].indexOf(t)?"width":"height",a=this.getMaxAlignedElementCount(o);this._matchesItemFlowDirection(o)?(e.weight=this.getTotalChildrenWeight()/a,e.container=this,this.addChild(e,-1!==["left","top"].indexOf(t)&&0)):(i=new s({type:this.isRow?"column":"row",container:this.container,weight:this.weight}),n=this.container,this.container=e.container=i,i.addChild(this),i.addChild(e,-1!==["left","top"].indexOf(t)&&0),this.weight=10*a,e.weight=10,n.replaceChild(this,i))},updateRectangle:function(){var t,e=this.getRectangle();this.content.forEach(function(i,n){var s,o=this.getChildRectangle(i);n>0&&((s=this.splitters[n-1]).setLength(e[this.isRow?"height":"width"]),s.setPosition({top:o.top-(this.isColumn?s.thickness/2:0),left:o.left-(this.isRow?s.thickness/2:0)}),s.setEnabled(this.isRow||!(t.isMinimized()||i.isMinimized()))),i.updateRectangle(),t=i},this)},_applyNestedDimensionalNumberComputation:function(t,e){return this._matchesItemFlowDirection(t)?this.content.reduce(function(i,n){return i+n[e](t)},0):n.max(this.content.map(function(i){return i[e](t)}))},getMinSize:function(t){return this._applyNestedDimensionalNumberComputation(t,"getMinSize")},getMaxAlignedElementCount:function(t){return this._applyNestedDimensionalNumberComputation(t,"getMaxAlignedElementCount")},isMinimized:function(){return this.content.reduce(function(t,e){return t&&e.isMinimized()},!0)},getContentSizeRelations:function(t){var e,i=[];return this.content.forEach(function(s){"height"===t&&s.isMinimized()?i.push({factors:n.toMap([[s,1]]),result:s.getMinSize("height")}):(e&&(this._matchesItemFlowDirection(t)?i.push({factors:n.toMap([[e,1],[s,-e.weight/s.weight]]),result:0}):i.push({factors:n.toMap([[e,1],[s,-1]]),result:0})),e=s)},this),this._matchesItemFlowDirection(t)?"height"===t&&this.isMinimized()||i.push({factors:n.toMap(this.content.map(function(t){return[t,1]}).concat([[this,-1]])),result:0}):e&&i.push({factors:n.toMap([[e,1],[this,-1]]),result:0}),[].concat.apply(i,this.content.map(function(e){return e.getContentSizeRelations(t)}))},fixConstraintViolations:function(t){var e,i=n.toMap([]),s=0;function o(e){return e[t]-e.getMinSize(t)}function a(e,n){e[t]=e.getMinSize(t)+n,i.set(e,!0)}function r(t){if(!(o(t)<=0)){var i=o(t),n=Math.min(o(t),s*t.weight/l);a(t,i-n),e+=n}}if(this.content.forEach(function(t){var e=o(t);e<0&&(s-=e,a(t,0))},this),this._matchesItemFlowDirection(t)){do{e=0;var l=this.content.reduce(function(t,e){return o(e)>0?t+e.weight:t},0);this.content.forEach(r),s-=e}while(e>0);s>0&&a(this,o(this)-s)}this.content.forEach(function(e){"height"===t&&e.isMinimized()||((i.has(e)||i.has(this.content))&&e.updateSize(t),e.fixConstraintViolations(t))},this)}});return s}),define("DS/UWPClientControls/DockLayout/Item",["UWA/Core","DS/UWPClientControls/DockLayout/AbstractContainer","DS/UWPClientControls/DockLayout/RowOrColumn","DS/UWPClientControls/DockLayout/DropTarget","DS/UWPClientControls/DockLayout/Utils","DS/UWPClientControls/DockLayout/PlayerDragUtils"],function(t,e,i,n,s,o){"use strict";var a={MINIMIZED:"dock-minimized",MAXIMIZED:"dock-maximized"},r={DEFAULT:"default",MINIMIZED:"minimized",MAXIMIZED:"maximized"},l=e.extend({init:function(e){this._parent(),this.type="item",this.content=e.content,this.container=e.container,this.weight=e.weight,this.view=r.DEFAULT,this.element=t.extendElement(this.manager.leafReviver(this.content)),this.element.addClassName("dock-item"),Object.keys(a).forEach(function(t){this.element.hasClassName(a[t])&&(this.view=r[t])},this),this.element.onDragStart=this.onDragStart.bind(this),this.element.onDrag=this.onDrag.bind(this),this.element.onDragStop=this.onDragStop.bind(this),this.element.dockItem=this,this.manager.element.contains(this.element)||this.manager.element.appendChild(this.element)},swapElement:function(t){var e=this.element;this.element=t,t.dockItem=this,t.onDragStart=e.onDragStart,t.onDrag=e.onDrag,t.onDragStop=e.onDragStop,t.setAttribute("style",e.getAttribute("style")),[].forEach.call(e.classList,function(e){0===e.indexOf("dock-")&&t.classList.add(e)})},childExists:function(){throw new Error("Item cannot contain children")},addChild:function(){throw new Error("Cannot add child to item")},removeChild:function(){throw new Error("Cannot remove child from item")},replaceChild:function(){throw new Error("Cannot swap child it item")},remove:function(t){this._parent(),this.manager.maximizedItem===this&&(this.manager.maximizedItem=null),t&&(this.element.remove(),this.manager.paint(),this.manager.onChange("remove"))},duplicate:function(){return this._parent.apply(this,arguments)},getCopy:function(){return new l({content:this.content,container:this.container,weight:this.weight})},getGridCoordinates:function(){return this._parent.apply(this,arguments)},getChildRectangle:function(){throw new Error("Item has no children")},_makeDropTarget:function(t){var e,i,s,o=this;for(e=this.getRectangle();o&&"root"!==o.type&&o.isMinimized();)o=o.container;return o===this||o.isColumn||(e.height=o.isRow?o.getRectangle().height:Math.max(this.manager.element.clientHeight,this.manager.sizes.minItemHeight)),i=function(){switch(t){case"top":return{left:e.left,top:e.top,width:e.width,height:e.height/2};case"right":return{left:e.left+e.width/2,top:e.top,width:e.width/2,height:e.height};case"bottom":return{left:e.left,top:e.top+e.height/2,width:e.width,height:e.height/2};case"left":return{left:e.left,top:e.top,width:e.width/2,height:e.height}}}(),s=function(){switch(t){case"top":return[{x:e.left,y:e.top},{x:e.left+e.width,y:e.top},{x:e.left+e.width/2,y:e.top+e.height/2}];case"right":return[{x:e.left+e.width,y:e.top},{x:e.left+e.width,y:e.top+e.height},{x:e.left+e.width/2,y:e.top+e.height/2}];case"bottom":return[{x:e.left+e.width,y:e.top+e.height},{x:e.left,y:e.top+e.height},{x:e.left+e.width/2,y:e.top+e.height/2}];case"left":return[{x:e.left,y:e.top+e.height},{x:e.left,y:e.top},{x:e.left+e.width/2,y:e.top+e.height/2}]}}(),new n({dropRectangle:i,indicatorRectangle:i,mousePolygon:s,container:this,name:t,priority:0})},getDropTargets:function(){return["top","right","bottom","left"].map(this._makeDropTarget.bind(this))},dropItemAt:function(t,e){var n,s=new i({type:-1!==["top","bottom"].indexOf(t)?"column":"row",container:this.container,weight:this.weight});n=this.container,this.container=e.container=s,this.weight=e.weight=50,s.addChild(this),s.addChild(e,-1!==["left","top"].indexOf(t)&&0),n.replaceChild(this,s)},updateRectangle:function(){var t=this.getRectangle(),e=this.manager.element;this.view===r.MAXIMIZED?this.element.setStyles({position:"absolute","z-index":3,left:e.clientLeft,top:e.clientTop,width:e.clientWidth,height:e.clientHeight}):this.element.setStyles({position:"absolute","z-index":0,left:t.left,top:t.top,width:t.width,height:t.height})},getMinSize:function(t){return this.manager.sizes["width"===t?"minItemWidth":this.isMinimized()?"minimizedItemHeight":"minItemHeight"]},getMaxAlignedElementCount:function(){return 1},isMinimized:function(){return this.view===r.MINIMIZED},_toggleViewMode:function(t){this.view===r[t]?(this.view=r.DEFAULT,this.element.removeClassName(a[t])):(this.view=r[t],this.element.addClassName(a[t]))},toggleMinimize:function(){this._toggleViewMode("MINIMIZED")},toggleMaximize:function(){this._toggleViewMode("MAXIMIZED"),this.manager.maximizedItem=this.view===r.MAXIMIZED?this:null},onDragStart:function(t){o.dragStart({event:t,manager:this.manager,element:this.element,onDrag:function(){this.remove()}.bind(this)})},onDrag:function(t){o.drag({event:t,manager:this.manager,element:this.element})},onDragStop:function(t){o.dragStop({event:t,manager:this.manager,element:this.element,changeEventName:"reorder",onDrop:function(t){t?t.container.dropItemAt(t.name,this):this.manager.restoreState(!0)}.bind(this)})},getContentSizeRelations:function(){return[]},fixConstraintViolations:function(){}});return l}),define("DS/UWPClientControls/DockLayout/Player",["UWA/Core","UWA/Class","DS/UWPClientControls/DockLayout/Item","DS/UWPClientControls/DockLayout/RowOrColumn","DS/UWPClientControls/DockLayout/PlayerDragUtils"],function(t,e,i,n,s){"use strict";return e.extend({init:function(e){this.manager=e.manager,this.element=e.element,this.content=t.is(e.content,"array")?e.content:[e.content]},onDragStart:function(t){s.dragStart({event:t,manager:this.manager,element:this.element,itemCount:this.content.length})},onDrag:function(t){s.drag({event:t,manager:this.manager,element:this.element})},onDragStop:function(t){s.dragStop({event:t,manager:this.manager,element:this.element,changeEventName:"add",onDrop:function(t){t&&t.createItems(this.content)}.bind(this)})},onDragCancel:function(){s.dragCleanup({element:this.element})}})}),define("DS/UWPClientControls/DockLayout/Manager",["UWA/Core","UWA/Class","DS/WebappsUtils/Utils","DS/UWPClientControls/DockLayout/AbstractContainer","DS/UWPClientControls/DockLayout/Root","DS/UWPClientControls/DockLayout/RowOrColumn","DS/UWPClientControls/DockLayout/Item","DS/UWPClientControls/DockLayout/Player","DS/UWPClientControls/DockLayout/DropTarget","DS/UWPClientControls/DockLayout/Utils","DS/UWPClientControls/Draggable"],function(t,e,i,n,s,o,a,r,l,h,c){"use strict";function d(e,i,s){return s=s||[],"object"==typeof e&&(e instanceof n?s.push(e):s.push(t.extend(e,{container:i})),e.content instanceof Array?e.content.forEach(function(t){d(t,e,s)}):d(e.content,e,s)),s}function u(t){"item"!==t.type&&t.content.forEach(function(e){e.container=t})}function m(t){var e;function i(i){var n=0;if("item"!==i.type){for(;n<i.content.length;)null==i.content[n]?i.content.splice(n,1):++n;1===i.content.length&&(i.container&&"root"!==i.container.type?(i.content[0].weight=i.weight,i.container.content[i.container.content.indexOf(i)]=i.content[0],i=i.container):(t=t.content[0],i=t),u(i),e=!0)}"item"!==i.type&&(i.content.forEach(function(t,n){if(t.type===i.type){var s=i.content.map(function(t){return t.weight}).reduce(function(t,e){return t+e},0);i.content[n]=t.content,i.content=i.content.reduce(function(t,e){return e.forEach&&e.forEach(function(t){t.weight*=t.container.weight/s}),t.concat(e)},[]),e=!0}}),u(i))}do{e=!1,d(t).forEach(i)}while(e);return t}var f,g,p=e.extend({init:function(e){this._parent(),this.sizes=t.merge(e.sizes||{},{splitter:10,minItemWidth:20,minItemHeight:20,minimizedItemHeight:20}),this.containersDimensions=h.toMap([]),this._stateStack=[e.structure],this._stateStackIndex=0,this.onChange=function(t){this.commitState(),e.onChange&&e.onChange(t,this)}.bind(this),this.leafReviver=e.leafReviver,this.element=t.extendElement(t.is(e.container,"string")?document.querySelector(e.container):e.container),this.root=new s({manager:this}),this.maximizedItem=null,this.enabled=!0,this.createTree(e.structure,this.root),this.element.addEvent("resize",function(){this._isContainerVisible()&&(this.paint(),e.onResize&&e.onResize(this))}.bind(this)),e.onBeforeFirstPaint&&e.onBeforeFirstPaint(this),this.paint()},freeze:function(){this.element.getElements(".dock-splitter").forEach(function(t){t.remove()}),this.element.removeEvents()},_isContainerVisible:function(){return!!this.element.offsetParent},getRelativeCoordinates:function(t,e){var i=this.element.getBoundingClientRect();return{x:t-i.left,y:e-i.top}},getDropTargetAt:function(t,e){for(var i,n=l.sortByPriority(this.root.getDropTargets()),s=0;s<n.length;++s)if((i=n[s]).matchesCoordinates(t,e))return g=i;return g||n[0]},addItems:function(t){var e="string"==typeof e?[t.content]:t.content;if(0===e.length)throw new Error("Content must have length of at least 1");this.getDropTargetAt(t.x,t.y).createItems(e)},getPlayer:function(t){return new r({manager:this,element:t.element,content:t.content})},minimize:function(t){var e=t.dockItem;if(!e)throw new Error("Invalid item element for minimizing");e.isMinimized()||(e.toggleMinimize(),this.paint())},maximize:function(t){var e=t.dockItem;if(!e)throw new Error("Invalid item element for maximizing");this.maximizedItem&&this.maximizedItem.toggleMaximize(),e.toggleMaximize(),this.paint()},setDefaultViewMode:function(t){var e=t.dockItem;if(!e)throw new Error("Invalid item element");if(e.isMinimized())e.toggleMinimize();else{if(this.maximizedItem!==e)return;e.toggleMaximize()}this.paint()},createTree:function(e,i){if(e){"root"===i.type&&m(e);var n=this,s=-1!==["row","column"].indexOf(i.type);if(s&&!t.is(e,"array"))throw new Error("Rows/columns must have arrays as content");if(!s&&t.is(e,"array"))throw new Error("Cannot define array content for non row/column type");s?e.forEach(function(t){i.addChild(r(t))}):i.addChild(r(e))}function r(t){var e;switch(t.type){case"row":case"column":e=new o({type:t.type,container:i,weight:t.weight});break;case"item":if("string"!=typeof t.content)throw new Error("Item content must be a string");e=new a({container:i,content:t.content,weight:t.weight});break;default:throw new Error("Unknown element type: "+t.type)}return"item"!==t.type&&n.createTree(t.content,e),e}},serialize:function(){return JSON.stringify(this.root.content)},paint:function(){this.containersDimensions=h.toMap([]),this.root.updateSize("width"),this.root.updateSize("height"),this.root.updateRectangle()},setMaxAlignedItems:function(e,i){var n="horizontal"===e?"x":"y",s="x"===n?"y":"x",a="horizontal"===e?"row":"column",r="row"===a?"column":"row";function l(t){var i="horizontal"===e?"height":"width",n=t.content.reduce(function(t,e){return t+e.getMaxAlignedElementCount(i)},0);t.content.forEach(function(t){t.weight=100*t.getMaxAlignedElementCount(i)/n})}if(this.root.content&&"item"!==this.root.content.type){var h=new p({container:document.createElement("div"),structure:JSON.parse(JSON.stringify(this.root.content)),leafReviver:function(){return document.createElement("div")}});this.setState(function(e){var h,c,f;function g(s){if(!(s.getGridCoordinates()[n]<i||c.indexOf(s)>-1)){f=!0;var g,p,v,w,y,C,b,x,S=s.container,z=z=S&&S.content.indexOf(s);S&&S.type===a?(w=S.content.splice(z),v=S.content):(S&&(S.splice(s,1),v=S.content),w=[s]),b=i,x=[],w.forEach(function(t,e){e%b==0&&x.push([]),x[x.length-1].push(t)}),p=100/((g=x).length+(v?1:0)),(y=new o({type:r,content:(v?[new o({type:a,content:v,weight:p,container:y})]:[]).concat(g.map(function(t){return new o({type:a,content:t,weight:p,container:y})})),weight:100})).content.forEach(u),u(y),S&&S.container&&"root"!==S.container.type?(C=S.container.content.indexOf(S),S.container.content[C]=t.extend(y,{weight:S.container.content[C].weight}),u(S.container.content[C]),l(S.container.content[C])):(u(e=y),l(e)),e=m(e),c=c.concat(d(y)),h.push(y)}}do{h=[],c=[],f=!1,d(e).sort(function(t,e){var i=t.getGridCoordinates(),o=e.getGridCoordinates();return i[n]-o[n]||i[s]-o[s]}).forEach(g)}while(f);return e}(h.root.content),!0)}},undo:function(t){if(0===this._stateStackIndex)throw new Error("Nothing to undo");--this._stateStackIndex,this.restoreState(t)},redo:function(t){if(this._stateStackIndex===this._stateStack.length-1)throw new Error("Nothing to redo");++this._stateStackIndex,this.restoreState(t)},restoreState:function(t){this.setState(this._stateStack[this._stateStackIndex],t)},setState:function(t,e){for(this.root.content=void 0;!e&&this.element.firstChild;)this.element.removeChild(this.element.firstChild);e&&this.element.getElements(".dock-splitter").forEach(function(t){t.remove()}),this.createTree(t,this.root),!e&&this.paint()},commitState:function(){this._stateStack=this._stateStack.slice(0,this._stateStackIndex+1),this._stateStack.push(JSON.parse(this.serialize()||"null")),this._stateStack.length>100?this._stateStack.shift():++this._stateStackIndex},onDragStart:function(t,e){if(this.maximizedItem||!this.enabled)return!1;for(f=t;!f.onDragStart;)if((f=f.parentElement)===this.element)throw new Error("Element cannot receive drag events");return f.onDragStart(e),!0},onDrag:function(t){return!(this.maximizedItem||!this.enabled)&&(f.onDrag(t),!0)},onDragStop:function(t){return!(this.maximizedItem||!this.enabled)&&(f&&f.onDragStop(t),f=void 0,g=void 0,!0)},setupDrag:function(){var t,e=this;this.draggable&&this.draggable.destroy(),this.draggable=new c({movePlayer:!1,container:e.element,items:".dock-splitter, .dock-item",limit:!0,textSelection:!1,distance:0,area:15,beforeStart:function(e,i){t=i.player},start:function(i){e.onDragStart(t,i)},drag:function(t){e.onDrag(t)},stop:function(t){e.onDragStop(t)}})},setEnabled:function(t,e){this.enabled=t,this.enabled||e?this.element.removeClassName("dock-disabled"):this.element.addClassName("dock-disabled")},restoreWeights:function(t){!function t(e,i){e&&i&&(e.weight=i.weight||e.weight,"item"!==e.type&&e.content.length===(i.content||[]).length&&e.content.forEach(function(e,n){t(e,i.content&&i.content[n])}))}(this.root.content,t)}});return p});