define("DS/MPFBiddingContractQuoteNoteComponent/BiddingContractSection",["UWA/Class/View","css!DS/MPFBiddingContractQuoteNoteComponent/MPFBiddingContractQuoteNoteComponent"],function(t){"use strict";return t.extend({className:"mpf-bidding-contract-section",setup:function(t){t.additionalClassName&&this.container.addClassName(t.additionalClassName)},render:function(){return this.container.setContent([{tag:"div",class:"mpf-section-header",html:[{tag:"div",class:"mpf-section-title",html:this.createTitle()},{tag:"div",class:"mpf-section-link",html:this.createLink()}]},{tag:"div",class:"mpf-section-body",html:this.createBody()}]),this},destroy:function(){this._parent(),this.container=null},createTitle:function(){},createBody:function(){},createLink:function(){}})}),define("DS/MPFBiddingContractQuoteNoteComponent/InvoiceSection",["UWA/Core","UWA/Class/View","UWA/Promise","DS/PlatformAPI/PlatformAPI","DS/UIKIT/Input/Button","DS/UIKIT/Input/File","DS/UIKIT/Mask","DS/MPFServices/ObjectService","DS/MPFFiniteStateMachine/FiniteStateMachine","DS/MPFCartModel/CartModel","DS/MPFCartModel/CartItemModel","DS/MPFCartModel/CartItemCollection","DS/MPFCartModel/CartModelHelper","DS/MPFInvoiceModel/InvoiceDocumentModel","DS/MPFInvoiceComponent/InvoiceUploadModal","DS/MPFInvoiceModel/InvoiceDocumentFactory","i18n!DS/MPFBiddingContractQuoteNoteComponent/assets/nls/MPFBiddingContractQuoteNoteComponent","css!DS/MPFBiddingContractQuoteNoteComponent/MPFBiddingContractQuoteNoteComponent"],function(t,e,o,n,i,r,s,c,a,d,u,l,h,m,y,p,C){"use strict";var D={NOT_AVAILABLE:"notAvailable",UPLOAD_AVAILABLE:"uploadAvailable",ALREADY_UPLOADED:"alreadyUploaded"},F=e.extend({className:"mpf-invoice-section",setup:function(t){t||(t={}),this._parent(t),this._checkPrototypes(t),this.sellerView=!0===t.sellerView,this.cart=t.cart,this.cartItems=t.cartItems,this.invoiceDocument=t.invoiceDocument,this.invoiceDocumentFactory=t.invoiceDocumentFactory,this.stateMachine=this._createStateMachine(),this.title=this._createTitle(),this.button=this._createButton(),this.downloadButton=this._createDownloadButton(),this.inputFile=this._createInputFile(),this.message=this._createMessage()},render:function(){return this.container.setContent([this.title,this.downloadButton,this.button,this.message]),this},_updateContent:function(t){this.stateMachine.changeState(t),this.downloadButton=this._createDownloadButton(),this.button=this._createButton(),this.message=this._createMessage(),this.render()},_createMessage:function(){var e;return this.stateMachine.getState()===D.NOT_AVAILABLE?e=C.get("invoiceNotAvailable"):this.stateMachine.getState()===D.ALREADY_UPLOADED?e=t.createElement("div",{html:[t.createElement("span",{class:"fonticon fonticon-check"}),this.invoiceDocument.getDocName()]}):this.stateMachine.getState()===D.UPLOAD_AVAILABLE&&(e=C.get("noInvoiceYet")),t.createElement("div",{class:"mpf-bidding-message",html:e})},_createButton:function(){if(this.sellerView){if(this.stateMachine.getState()===D.ALREADY_UPLOADED)return this._createDeleteInvoiceButton();if(this.stateMachine.getState()===D.UPLOAD_AVAILABLE)return this._createUploadInvoiceButton()}},_createInputFile:function(){var t,e=this;if(this.sellerView)return new r({events:{onChange:function(i){return s.mask(e.container),t=i.target.files[0],e.invoiceDocument=e.invoiceDocumentFactory.createModel(p.Types.CART_INVOICE_DOCUMENT),e.invoiceDocument.parentResourceId=e.cart.get("id"),e.invoiceDocument.saveFile(t).then(function(){var t={};return t[d.Fields.BUYER_INVOICE_DOCUMENT_PID]=e.invoiceDocument.id,o.all([e.cart.savePromise(t,{patch:!0}),e.invoiceDocument.fetchPromise()])}).then(function(){e._updateContent(D.ALREADY_UPLOADED),s.unmask(e.container),n.publish("MPCartTimeline",{event:"refresh",cartId:e.cart.id})})}}})},_createUploadInvoiceButton:function(){return new i({className:"default",value:C.get("uploadInvoice"),events:{onClick:this._uploadInvoiceHandler.bind(this)}})},_uploadInvoiceHandler:function(){this.inputFile.elements.input.click()},_createDeleteInvoiceButton:function(){return new i({className:"default",value:C.get("deleteInvoice"),events:{onClick:this._updateContent.bind(this,D.UPLOAD_AVAILABLE)}})},_createDownloadButton:function(){if(this.stateMachine.getState()===D.ALREADY_UPLOADED)return t.createElement("a",{class:"mpf-bidding-link",target:"_blank",href:this.invoiceDocument.getDocUrl(),html:C.get("download")})},_createTitle:function(){return t.createElement("div",{class:"mpf-bidding-title",text:C.get("invoice")})},_createStateMachine:function(){var t;return t=h.isConfirmed(this.cart)?""!==this.cart.getBuyerInvoiceDocumentPid()?D.ALREADY_UPLOADED:D.UPLOAD_AVAILABLE:D.NOT_AVAILABLE,new a({state:t,states:[D.NOT_AVAILABLE,D.UPLOAD_AVAILABLE,D.ALREADY_UPLOADED],transitions:[{from:D.UPLOAD_AVAILABLE,to:D.ALREADY_UPLOADED},{from:D.ALREADY_UPLOADED,to:D.UPLOAD_AVAILABLE}]})},_checkPrototypes:function(t){c.requiredOfPrototype(t.cart,d,"options.cart must be a CartModel"),c.requiredOfPrototype(t.cartItems,l,"options.cartItems must be a CartItemCollection"),c.requiredOfPrototype(t.invoiceDocumentFactory,p,"options.invoiceDocumentFactory must be an InvoiceDocumentFactory"),""!==t.cart.getBuyerInvoiceDocumentPid()&&c.requiredOfPrototype(t.invoiceDocument,m,"options.invoiceDocument must be an InvoiceDocumentModel")}});return F.States=Object.freeze(D),F}),define("DS/MPFBiddingContractQuoteNoteComponent/NDASection",["UWA/Core","UWA/Class/View","UWA/Promise","DS/MPFServices/ObjectService","DS/MPFTcDocumentModel/TcDocumentModel","DS/MPFBiddingContractQuoteNoteComponent/BiddingContractSection","i18n!DS/MPFBiddingContractQuoteNoteComponent/assets/nls/MPFBiddingContractQuoteNoteComponent"],function(t,e,o,n,i,r,s){"use strict";return r.extend({setup:function(e){e||(e={}),e.additionalClassName="mpf-nda-section",this._parent(e),this._checkPrototypes(e),this.ndaDocument=e.ndaDocument,this.ndaExist=t.is(this.ndaDocument)},createBody:function(){return this.ndaExist?s.get("attachedNda"):s.get("noNda")},createLink:function(){if(this.ndaExist)return t.createElement("a",{class:"mpf-bidding-link",target:"_blank",href:this.ndaDocument.getDocUrl(),html:s.get("download")})},createTitle:function(){return s.get("nda")},_checkPrototypes:function(e){t.is(e.ndaDocument)&&n.requiredOfPrototype(e.ndaDocument,i,"options.ndaDocument must be a TCDocumentModel")}})}),define("DS/MPFBiddingContractQuoteNoteComponent/QuoteSection",["UWA/Core","DS/UIKIT/Mask","DS/MPFServices/ObjectService","DS/MPFBuyer/BuyerType","DS/MPFCountryModel/CountryCollection","DS/MPFPersonModel/PersonModel","DS/MPFCompanyModel/CompanyModel","DS/MPFCartModel/CartModel","DS/MPFCartModel/CartItemModel","DS/MPFCartModel/CartItemCollection","DS/MPFCartModel/CartModelHelper","DS/MPFCartQuoteModel/CartQuoteModel","DS/MPFAddressModel/AddressCollection","DS/MPFAddressModel/AddressFactory","DS/MPFCompanyModel/CompanyFactory","DS/MPFCartModel/CartFactory","DS/MPFCartModel/CartItemFactory","DS/MPFCartQuoteComponent/CartQuoteDownloadLink","DS/MPFBuyerAddressComponent/BuyerAddressBook","DS/MPFBiddingContractQuoteNoteComponent/BiddingContractSection","i18n!DS/MPFBiddingContractQuoteNoteComponent/assets/nls/MPFBiddingContractQuoteNoteComponent"],function(t,e,o,n,i,r,s,c,a,d,u,l,h,m,y,p,C,D,F,M,P){"use strict";return M.extend({setup:function(t){t||(t={}),t.additionalClassName="mpf-quote-section",this._parent(t),this.sellerView=!0===t.sellerView,this._checkPrototypes(t),this.me=t.me,this.buyerType=t.buyerType,this.company=t.company,this.addresses=t.addresses,this.cart=t.cart,this.cartItems=t.cartItems,this.cartQuote=t.cartQuote,this.addressFactory=t.addressFactory,this.companyFactory=t.companyFactory,this.cartFactory=t.cartFactory,this.cartItemFactory=t.cartItemFactory,this.countries=t.countries,this.orderStatus=this.cartItems.first().getState(),this.buyerAddressBook=this._createBuyerAddressBook()},render:function(){return this._parent(),t.is(this.buyerAddressBook)&&this.container.addContent(this.buyerAddressBook.render()),this},_createBuyerAddressBook:function(){var e,o,i;if(o=this.orderStatus!==a.STATUS.submitted,i=t.is(this.cart.get("BillTo"))&&""!==this.cart.get("BillTo"),o&&!i&&!this.sellerView)return e=new F({model:this.addresses,me:this.me,buyer:this.buyerType===n.COMPANY?this.company:this.me,addressFactory:this.addressFactory,companyFactory:this.companyFactory,cartFactory:this.cartFactory,cartItemFactory:this.cartItemFactory,isBillingAddress:!0,countries:this.countries,countryReadOnly:this.buyerType===n.COMPANY}),this.listenTo(e,"onSelected",this._newBillingAddressHandler.bind(this)),e},createTitle:function(){return P.get("quote")},createBody:function(){var e,o;return e=this.orderStatus!==a.STATUS.submitted,o=u.isPaidByDirectPurchase(this.cart,this.cartItems),this.cart.getState()===c.States.CANCELLED?P.get("noQuoteOrderCancelled"):e||o?[t.createElement("span",{class:"fonticon fonticon-check"}),t.createElement("span",{text:P.get("quoteReady")})]:P.get("noQuote")},createLink:function(){var e,o,n,i;if(e=this.cart.getState()!==c.States.CANCELLED,o=this.orderStatus!==a.STATUS.submitted,n=u.isPaidByDirectPurchase(this.cart,this.cartItems),e&&(o||n))return i=t.is(this.cart.get("BillTo"))&&""!==this.cart.get("BillTo"),this.sellerView?i?this._getDownloadQuoteComponent():this._sellerErrorDownloadButton():i?this._getDownloadQuoteComponent():this._createBuyerAddressBookButton()},_getDownloadQuoteComponent:function(){var t;return(t=new D({quote:this.cartQuote,label:P.get("download")})).render(),t},_sellerErrorDownloadButton:function(){return t.createElement("span",{text:P.get("download"),events:{click:this._displayErrorQuoteMessage.bind(this)}})},_newBillingAddressHandler:function(t){var o=this;if(t.ok)return e.mask(this.container),this.cart.savePromise({BillTo:t.selectedAddress.get("id")},{patch:!0}).then(function(){o.render()})},_displayErrorQuoteMessage:function(){this.container.getElement(".mpf-section-body").setContent([t.createElement("span",{class:"fonticon fonticon-wrong"}),P.get("errorQuoteSeller")])},_createBuyerAddressBookButton:function(){return t.createElement("span",{text:P.get("download"),events:{click:this.buyerAddressBook.show.bind(this.buyerAddressBook)}})},_checkPrototypes:function(t){o.requiredOfPrototype(t.countries,i,"options.countries must be a CountryCollection"),o.requiredOfPrototype(t.me,r,"options.me must be a PersonModel"),o.requiredOfPrototype(t.cart,c,"options.cart must be a CartModel"),o.requiredOfPrototype(t.cartItems,d,"options.cartItems must be a CartItemCollection"),o.requiredOfPrototype(t.cartQuote,l,"options.cartQuote must be a CartQuoteModel"),o.requiredOfPrototype(t.addressFactory,m,"options.addressFactory must be an AddressFactory"),o.requiredOfPrototype(t.companyFactory,y,"options.companyFactory must be a CompanyFactory"),o.requiredOfPrototype(t.cartFactory,p,"options.cartFactory must be a CartFactory"),o.requiredOfPrototype(t.cartItemFactory,C,"options.cartItemFactory must be a CartItemFactory"),this.sellerView||(o.requiredOfPrototype(t.addresses,h,"options.addresses must be an AddressCollection"),this.buyerType===n.COMPANY&&o.requiredOfPrototype(t.company,s,"options.company must be a CompanyModel"))}})}),define("DS/MPFBiddingContractQuoteNoteComponent/NotesSection",["UWA/Core","UWA/Class/View","UWA/Promise","DS/UIKIT/Popover","DS/MPFServices/ObjectService","DS/MPFNoteModel/NoteModel","DS/MPFCartModel/CartItemModel","DS/MPFCartModel/CartItemCollection","DS/MPFView/FieldTextInputV2","DS/MPFBiddingContractQuoteNoteComponent/BiddingContractSection","i18n!DS/MPFBiddingContractQuoteNoteComponent/assets/nls/MPFBiddingContractQuoteNoteComponent"],function(t,e,o,n,i,r,s,c,a,d,u){"use strict";return d.extend({setup:function(t){var e;t||(t={}),t.additionalClassName="mpf-notes-section mpf-horizontal",this._parent(t),this._checkPrototypes(t),this.note=t.note,this.cartItems=t.cartItems,e=this.cartItems.first().getState(),this.internalReferenceInput=new a({model:this.note,fieldLabel:u.get("internalReference"),fieldName:r.Fields.INTERNAL_REFERENCE,saveOnChange:!0,dynamicValidation:!0,readOnly:!(e===s.STATUS.draft||e===s.STATUS.submitted||e===s.STATUS.accepted)}),this.privateNotesInput=new a({model:this.note,fieldLabel:u.get("privateNotes"),fieldName:r.Fields.PRIVATE_NOTES,saveOnChange:!0,dynamicValidation:!0,multiline:!0,multilineRows:4})},createTitle:function(){var e;return e=t.createElement("span",{class:"fonticon fonticon-info"}),new n({target:e,position:"bottom",body:u.get("infoNotes"),trigger:"hover touch"}),[u.get("notes"),e]},createBody:function(){return[this.internalReferenceInput.render(),this.privateNotesInput.render()]},_checkPrototypes:function(t){i.requiredOfPrototype(t.note,r,"options.note must be a NoteModel"),i.requiredOfPrototype(t.cartItems,c,"options.cartItems must be a CartItemCollection")}})}),define("DS/MPFBiddingContractQuoteNoteComponent/BiddingContractQuoteNoteComponent",["UWA/Core","UWA/Class/View","UWA/Promise","DS/MPFServices/ObjectService","DS/MPFServices/MarketplaceServices","DS/MPFBuyer/BuyerType","DS/MPFView/EmptyView","DS/MPFCountryModel/CountryCollection","DS/MPFPersonModel/PersonModel","DS/MPFTcDocumentModel/TcDocumentModel","DS/MPFTCContractModel/TCContractModel","DS/MPFCompanyModel/CompanyModel","DS/MPFShopModel/ShopModel","DS/MPFCartModel/CartModel","DS/MPFCartModel/CartItemCollection","DS/MPFCartQuoteModel/CartQuoteModel","DS/MPFInvoiceModel/InvoiceDocumentModel","DS/MPFNoteModel/NoteModel","DS/MPFAddressModel/AddressCollection","DS/MPFAddressModel/AddressFactory","DS/MPFCompanyModel/CompanyFactory","DS/MPFCartModel/CartFactory","DS/MPFCartModel/CartItemFactory","DS/MPFTCContractModel/TCContractFactory","DS/MPFTcDocumentModel/TCDocumentFactory","DS/MPFInvoiceModel/InvoiceDocumentFactory","DS/MPFBiddingContractQuoteNoteComponent/NDASection","DS/MPFBiddingContractQuoteNoteComponent/QuoteSection","DS/MPFTcContractComponent/SellerSalesConditionsOrder","DS/MPFBiddingContractQuoteNoteComponent/InvoiceSection","DS/MPFBiddingContractQuoteNoteComponent/NotesSection","i18n!DS/MPFBiddingContractQuoteNoteComponent/assets/nls/MPFBiddingContractQuoteNoteComponent","css!DS/MPFBiddingContractQuoteNoteComponent/MPFBiddingContractQuoteNoteComponent"],function(t,e,o,n,i,r,s,c,a,d,u,l,h,m,y,p,C,D,F,M,P,f,S,g,A,I,v,T,_,B,N,b){"use strict";return e.extend({className:"col-md-12 container-fluid mpf-bidding-contract-quote-note",setup:function(e){e||(e={}),this._parent(e),this.sellerView=!0===e.sellerView,this.service=e.service||i.MAKE,this._checkPrototypes(e),this.buyerType=e.buyerType,this.countries=e.countries,this.me=e.me,this.ndaDocument=e.ndaDocument,this.salesContract=e.salesContract,this.salesDocument=e.salesDocument,this.cart=e.cart,this.cartItems=e.cartItems,this.cartQuote=e.cartQuote,this.addresses=e.addresses,this.company=e.company,this.shop=e.shop,this.addressFactory=e.addressFactory,this.companyFactory=e.companyFactory,this.cartFactory=e.cartFactory,this.cartItemFactory=e.cartItemFactory,this.tcDocumentFactory=e.tcDocumentFactory,this.tcContractFactory=e.tcContractFactory,this.invoiceDocument=e.invoiceDocument,this.invoiceDocumentFactory=e.invoiceDocumentFactory,this.note=e.note,this.ndaSection=new v({ndaDocument:this.ndaDocument}),t.is(this.salesDocument)&&(this.salesConditionsSection=new _({service:this.service,sellerView:this.sellerView,shop:this.shop,tcContractFactory:this.tcContractFactory,tcDocumentFactory:this.tcDocumentFactory,salesContract:this.salesContract,salesDocument:this.salesDocument})),this.quoteSection=new T({sellerView:this.sellerView,buyerType:this.buyerType,countries:this.countries,me:this.me,cart:this.cart,cartItems:this.cartItems,cartQuote:this.cartQuote,company:this.company,addresses:this.addresses,addressFactory:this.addressFactory,companyFactory:this.companyFactory,cartFactory:this.cartFactory,cartItemFactory:this.cartItemFactory}),this.notesSection=t.is(this.shop)?new N({note:this.note,cartItems:this.cartItems}):s.getInstance()},render:function(){var e=[],o=[];return e.push(this.ndaSection.render()),t.is(this.shop)&&!this.shop.isInternal()&&(e.push(this.quoteSection.render()),t.is(this.salesConditionsSection)&&o.push(this.salesConditionsSection.render())),o.push(this.notesSection.render()),this.container.setContent([{tag:"div",class:"col-md-6 mpf-left-column",html:e},{tag:"div",class:"col-md-6 mpf-right-column",html:o}]),this},_checkPrototypes:function(e){n.requiredOfPrototype(e.countries,c,"options.countries must be a CountryCollection"),n.requiredOfPrototype(e.note,D,"options.note must be a NoteModel"),n.requiredOfPrototype(e.me,a,"options.me must be a PersonModel"),n.requiredOfPrototype(e.addressFactory,M,"options.addressFactory must be an AddressFactory"),n.requiredOfPrototype(e.companyFactory,P,"options.companyFactory must be a CompanyFactory"),n.requiredOfPrototype(e.cartFactory,f,"options.cartFactory must be a CartFactory"),n.requiredOfPrototype(e.cartItemFactory,S,"options.cartItemFactory must be a CartItemFactory"),n.requiredOfPrototype(e.cart,m,"options.cart must be a CartModel"),n.requiredOfPrototype(e.cartItems,y,"options.cartItems must be a CartItemCollection"),n.requiredOfPrototype(e.cartQuote,p,"options.cartQuote must be a CartQuoteModel"),n.requiredOfPrototype(e.tcContractFactory,g,"options.tcContractFactory must be a TCContractFactory"),n.requiredOfPrototype(e.tcDocumentFactory,A,"options.tcDocumentFactory must be a TCDocumentFactory"),n.requiredOfPrototype(e.invoiceDocumentFactory,I,"options.invoiceDocumentFactory must be an InvoiceDocumentFactory"),n.requiredOfPrototype(e.salesContract,u,"options.salesContract must be a TCContractModel"),t.is(e.shop)&&n.requiredOfPrototype(e.shop,h,"options.shop must be a ShopModel"),""!==e.cart.getBuyerInvoiceDocumentPid()&&n.requiredOfPrototype(e.invoiceDocument,C,"options.invoiceDocument must be an InvoiceDocumentModel"),t.is(e.ndaDocument)&&n.requiredOfPrototype(e.ndaDocument,d,"options.ndaDocument must be a TcDocumentModel"),t.is(e.salesDocument)&&n.requiredOfPrototype(e.salesDocument,d,"options.salesDocument must be a TcDocumentModel"),this.sellerView||(n.requiredOfPrototype(e.addresses,F,"options.addresses must be an AddressCollection"),this.buyerType===r.COMPANY&&n.requiredOfPrototype(e.company,l,"options.company must be a CompanyModel"))}})}),define("DS/MPFBiddingContractQuoteNoteComponent/BiddingContractQuoteNoteFactory",["UWA/Core","UWA/Class","UWA/Promise","DS/MPFConnector/MarketplaceConnector","DS/MPFModelFactory/MPFFactoriesV2","DS/MPFServices/MarketplaceServices","DS/MPFTCContractModel/TCContractModel","DS/MPFInvoiceModel/InvoiceDocumentFactory","DS/MPFBuyer/BuyerType","DS/MPFCompanyModel/CompanyHelper","DS/MPFCartQuoteModel/CartQuoteFactory","DS/MPFNoteModel/NoteFactory","DS/MPFTCContractModel/TCContractFactory","DS/MPFTcDocumentModel/TCDocumentFactory","DS/MPFBiddingContractQuoteNoteComponent/BiddingContractQuoteNoteComponent"],function(t,e,o,n,i,r,s,c,a,d,u,l,h,m,y){"use strict";return e.extend({init:function(t){t||(t={}),this.service=t.service||r.MAKE,this.me=t.me,this.cart=t.cart,this.shop=t.shop,this.sellerView=t.sellerView},getComponent:function(){return this._getConnector().then(this._initFactories.bind(this)).then(this._initModelsAndCollections.bind(this)).then(this._fetchAllResources.bind(this)).then(this._fetchAddresses.bind(this)).then(this._buildComponent.bind(this))},_getConnector:function(){return n.fetchPromise({service:this.service})},_initFactories:function(t){var e=this;return this.factoryDispenser=i.getInstance(t),o.all([this.factoryDispenser.getFactory(i.Types.COUNTRY),this.factoryDispenser.getFactory(i.Types.CART),this.factoryDispenser.getFactory(i.Types.TC_CONTRACT),this.factoryDispenser.getFactory(i.Types.TC_DOCUMENT),this.factoryDispenser.getFactory(i.Types.CART_ITEM),this.factoryDispenser.getFactory(i.Types.COMPANY),this.factoryDispenser.getFactory(i.Types.ADDRESS),this.factoryDispenser.getFactory(i.Types.CART_QUOTE),this.factoryDispenser.getFactory(i.Types.SHOP_SERVICE),this.factoryDispenser.getFactory(i.Types.INVOICE_DOCUMENT),this.factoryDispenser.getFactory(i.Types.NOTE)]).then(function(t){e.countryFactory=t[0],e.cartFactory=t[1],e.tcContractFactory=t[2],e.tcDocumentFactory=t[3],e.cartItemFactory=t[4],e.companyFactory=t[5],e.addressFactory=t[6],e.cartQuoteFactory=t[7],e.shopServiceFactory=t[8],e.invoiceDocumentFactory=t[9],e.noteFactory=t[10],e.companyFactory.addressFactory=e.addressFactory})},_initModelsAndCollections:function(){return this.cartQuote=this.cartQuoteFactory.createModel(u.Types.CART_QUOTE),this.cartItems=this.cartItemFactory.createCollection("cart-items",this.cart.getItems()),this.cartQuote.parentResourceId=this.cart.id,this.cartItems.parentResourceId=this.cart.id,o.resolve()},_fetchAllResources:function(){return o.all([this._fetchCountries(),this._fetchCompany(),this._fetchInvoiceDocument(),this._fetchNote(),this._getNda(),this._getSellerSalesConditions()])},_fetchCountries:function(){return this.countries=this.countryFactory.createCollection("buyer"),this.countries.fetchPromise()},_fetchCompany:function(){if(!this.sellerView&&(this.company=d.getCompanyFromPerson(this.me,this.companyFactory),t.is(this.company)))return this.buyerType=a.COMPANY,this.company.fetchPromise()},_fetchInvoiceDocument:function(){return this.cart.getBuyerInvoiceDocumentPid()?(this.invoiceDocument=this.invoiceDocumentFactory.createModel(c.Types.CART_INVOICE_DOCUMENT),this.invoiceDocument.id=this.cart.getBuyerInvoiceDocumentPid(),this.invoiceDocument.parentResourceId=this.cart.get("id"),this.invoiceDocument.fetchPromise()):o.resolve()},_fetchNote:function(){return this.note=this.noteFactory.createModel(l.Types.CART,{id:""}),this.note.parentResourceId=this.cart.id,this.note.fetchPromise()},_getNda:function(){return this.ndaContract=this.tcContractFactory.createModel(h.Types.NDA),this.ndaContract.setParentResourceId(this.cart.get("id")),this.ndaContract.fetchPromise().then(this._getNdaDocument.bind(this))},_getNdaDocument:function(){return this.ndaContract.isNew()?o.resolve():(this.ndaDocument=this.tcDocumentFactory.createModel(m.Types.DOCUMENTS,{id:this.ndaContract.getDocumentID()}),this.ndaDocument.fetchPromise())},_getSellerSalesConditions:function(){return this.salesContract=this.tcContractFactory.createModel(h.Types.CUSTOM_TC_SELLER),this.salesContract.setParentResourceId(this.cart.get("id")),this.salesContract.fetchPromise().then(this._getSellerSalesConditionsDocument.bind(this))},_getSellerSalesConditionsDocument:function(){return this.salesContract.isNew()?t.is(this.shop)&&t.is(this.shop.getServices()["contract-documents"][0])?(this.salesDocument=this.tcDocumentFactory.createModel(m.Types.DOCUMENTS,{id:this.shop.getServices()["contract-documents"][0].id}),this.salesDocument.fetchPromise()):o.resolve():(this.salesDocument=this.tcDocumentFactory.createModel(m.Types.DOCUMENTS,{id:this.salesContract.getDocumentID()}),this.salesDocument.fetchPromise())},_fetchAddresses:function(){if(!this.sellerView){if(this.buyerType!==a.COMPANY)return this.addresses=this.addressFactory.createCollection("me"),this.me.addresses=this.addresses,this.addresses.fetchPromise();this.addresses=this.company.addresses,this.addresses.parentResourceId=this.company.get("id")}},_buildComponent:function(){return new y({service:this.service,sellerView:this.sellerView,buyerType:this.buyerType,countries:this.countries,me:this.me,ndaDocument:this.ndaDocument,salesContract:this.salesContract,salesDocument:this.salesDocument,cart:this.cart,cartItems:this.cartItems,cartQuote:this.cartQuote,company:this.company,shop:this.shop,addresses:this.addresses,addressFactory:this.addressFactory,companyFactory:this.companyFactory,cartFactory:this.cartFactory,cartItemFactory:this.cartItemFactory,tcContractFactory:this.tcContractFactory,tcDocumentFactory:this.tcDocumentFactory,invoiceDocument:this.invoiceDocument,invoiceDocumentFactory:this.invoiceDocumentFactory,note:this.note})}})});