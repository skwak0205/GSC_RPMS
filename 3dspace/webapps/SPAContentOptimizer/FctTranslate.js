/*!  Copyright 2020 Dassault Systemes. All rights reserved. */
define("DS/SPAContentOptimizer/FctTranslate",["DS/CSICommandBinder/CSICommandBinder"],function(n){"use strict";new n.Parameters;var s=function(n,s){this._node=n,this._outputFile=s,this._nodeId=null,this.onErrors=null,this.onProgress=null,this.onMissingFiles=null,this.onConvert=null,this.onWarnings=null};return s.prototype={constructor:s,onAnswerWarnings:function(n,s){if(null!=this.onWarnings&&"function"==typeof this.onWarnings){var e=s.readStringArray("warnings");null!=e&&0<e.length&&this.onWarnings(n,e)}},onAnswerMissingFiles:function(n){if(null!=this.onMissingFiles&&"function"==typeof this.onMissingFiles){var s=n.readStringArray("filePaths");null!=s&&0<s.length&&this.onMissingFiles(s)}},onAnswerConvertSuccess:function(n){console.log("onAnswerConvertSuccess");var s=n.readBool("result"),e=n.readBuffer("resultFile"),r=n.readString("resultExtension");null!=s&&this.onResultFile(s,e,r),this.onAnswerMissingFiles(n),this.onAnswerWarnings("translate",n),this.dispose()},onAnswerConvertProgress:function(n){if(n.existsWithType("progress","double")&&null!=this.onProgress&&"function"==typeof this.onProgress){var s=n.readDouble("progress");this.onProgress(s)}},onAnswerConvertError:function(n){var s=JSON.stringify(n.toJSObject());null!=this.onErrors&&"function"==typeof this.onErrors&&this.onErrors(s),this.dispose()},convert:function(s,e,r){this._nodeId=this._node.select("ContentOptimizer");var t=new n.Parameters;return t.writeString("inputFileName",s),t.writeBuffer("inputFile",e),t.writeString("outputType",r),this._node.call({destinationNodeId:this._nodeId,name:"translate",version:1,parameters:t,onSuccess:this.onAnswerConvertSuccess.bind(this),onError:this.onAnswerConvertError.bind(this),onProgress:this.onAnswerConvertProgress.bind(this)}),!0,!0},openUrl:function(s,e,r){this._nodeId=this._node.select("ContentOptimizer");var t=new n.Parameters;return t.writeString("inputFileName",s),t.writeString("inputFileUrl",e),t.writeString("outputType",r),this._node.call({destinationNodeId:this._nodeId,name:"translate",version:1,parameters:t,onSuccess:this.onAnswerConvertSuccess.bind(this),onError:this.onAnswerConvertError.bind(this),onProgress:this.onAnswerConvertProgress.bind(this)}),!0,!0},dispose:function(){null!=this._nodeId&&(this._nodeId.close(),this._nodeId=null)}},s});