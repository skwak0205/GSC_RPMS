/*!  Copyright 2019 Dassault Systemes. All rights reserved. */
define("DS/SPAContentOptimizer/coptOpenImportTo",["DS/CSICommandBinder/CSICommandBinder","DS/SPAContentOptimizer/COptProductStructure","DS/SPAContentOptimizer/COptImportOption","DS/SPAContentOptimizer/SPAVisuPart","DS/SPAContentOptimizer/COptMiscWCS","DS/SPAContentOptimizer/COptMiscLayer","DS/SPAContentOptimizer/COptMiscLayerFilter","DS/SPAContentOptimizer/COptMiscMaterial","DS/SPAContentOptimizer/COptMiscNoteParameters","DS/SPAContentOptimizer/COptMiscSymmetry","DS/SPAContentOptimizer/COptMiscDisplaySet","DS/SPAContentOptimizer/COptUserProperties","DS/SPAContentOptimizer/COptMappingData"],function(n,t,i,s,e,r,o,a,l,u,c,h,p){"use strict";new n.Parameters;var d=function(n){this._node=n,this._nodeId=null,this._DocId=-1,this.onOpenResult=null,this.onErrors=null,this.onProgress=null,this.onMissingFiles=null,this.onInfo=null,this.onConfiguration=null,this.onAsm=null,this.onPart=null,this.onVisu=null,this.onImportComplete=null,this.onMiscDataWCS=null,this.onMiscDataLayer=null,this.onMiscDataLayerFilter=null,this.onMiscDataMaterial=null,this.onMiscDataNoteParameters=null,this.onMiscDataSymmetry=null,this.onMiscDataDisplaySet=null,this.onMiscDataUP=null,this.onMappingData=null,this.onEntityData=null,this.onVisuObj=null,this.onWarnings=null},f=function(){this.version=null,this.modificationDate=null,this.originalFileName=null,this.lastSavedPath=null,this.author=null,this.organization=null,this.sourceSystem=null,this.unit=null,this.comment=null,this.formatType=null,this.documentType=null,this.tolerance=null},m=function(){this.activeConfiguration=null,this.configurations=[]};return d.prototype={constructor:d,onAnswerCloseSuccess:function(n){this.dispose()},onAnswerCloseProgress:function(n){if(null!=this.onProgress&&"function"==typeof this.onProgress){var t=n.readDouble("progress");this.onProgress(t)}},onAnswerCloseError:function(n){console.log("onErrors called by COptClose:"+JSON.stringify(n.toJSObject())),this.dispose()},onAnswerOpenSuccess:function(n){var t=n.readBool("result"),i=n.readInt32("documentId");if(this._DocId=i,null!=this.onOpenResult&&"function"==typeof this.onOpenResult){var s=t&&0<=i;this.onOpenResult(s)}this.onAnswerWarnings("COptOpen",n),this.onAnswerMissingFiles(n),this.onAnswerInfo(n),this.onAnswerAsm(n)},onAnswerOpenProgress:function(n){if(null!=this.onProgress&&"function"==typeof this.onProgress){var t=n.readDouble("progress");this.onProgress(t)}},onAnswerOpenError:function(n){var t=JSON.stringify(n.toJSObject());null!=this.onErrors&&"function"==typeof this.onErrors&&this.onErrors(t)},onAnswerWarnings:function(n,t){if(null!=this.onWarnings&&"function"==typeof this.onWarnings){var i=t.readStringArray("warnings");null!=i&&0<i.length&&this.onWarnings(n,i)}},onAnswerMissingFiles:function(n){if(null!=this.onMissingFiles&&"function"==typeof this.onMissingFiles){var t=n.readStringArray("filePaths");null!=t&&0<t.length&&this.onMissingFiles(t)}},onAnswerInfo:function(n){if(null!=this.onInfo&&"function"==typeof this.onInfo){var t=new f;t.version=n.readString("version"),t.modificationDate=n.readString("modificationDate"),t.originalFileName=n.readString("originalFileName"),t.lastSavedPath=n.readString("lastSavedPath"),t.author=n.readString("author"),t.organization=n.readString("organization"),t.sourceSystem=n.readString("sourceSystem"),t.unit=n.readString("unit"),t.comment=n.readString("comment"),t.formatType=n.readString("formatType"),t.documentType=n.readInt32("documentType"),t.tolerance=n.readDouble("tolerance"),this.onInfo(t)}if(null!=this.onConfiguration&&"function"==typeof this.onConfiguration){var i=new m;i.activeConfiguration=n.readString("activeConfiguration"),i.configurations=n.readStringArray("configurations"),this.onConfiguration(i)}},onAnswerAsm:function(n){if(null!=this.onAsm&&"function"==typeof this.onAsm){var t=n.readObject("asmObject","COptProductStructure");null!=t&&this.onAsm(t)}},onAnswerImportSuccess:function(n){null!=this.onImportComplete&&"function"==typeof this.onImportComplete&&this.onImportComplete()},onAnswerImportProgress:function(n){if(n.existsWithType("progress","double")&&null!=this.onProgress&&"function"==typeof this.onProgress){var t=n.readDouble("progress");this.onProgress(t)}this.onAnswerWarnings("COptImport",n);var i=n.readInt32("refId");if(null!=i&&i>-1){var s=n.readString("configName");this.onAnswerPart(i,s,n),this.onAnswerVisu(i,s,n),this.onAnswerVisuObj(i,s,n),this.onAnswerMiscData(i,n),this.onAnswerMappingData(i,n),this.onAnswerEntityData(i,n)}},onAnswerImportError:function(n){var t=JSON.stringify(n.toJSObject());null!=this.onErrors&&"function"==typeof this.onErrors&&this.onErrors(t)},onAnswerPart:function(n,t,i){var s=i.readString("brepType");if(console.log("onAnswerPart configName="+t+" type="+s),null!=s&&null!=this.onPart&&"function"==typeof this.onPart){var e=i.readBuffer("brepData");s=i.readString("brepType");this.onPart(n,t,s,e)}},onAnswerVisu:function(n,t,i){var s=i.readString("visuType");if(null!=s&&null!=this.onVisu&&"function"==typeof this.onVisu){var e=i.readBuffer("visuData");this.onVisu(n,t,s,e)}},onAnswerVisuObj:function(n,t,i){var s=i.readObject("visuObject","SPAVisuPart");null!=s&&null!=this.onVisuObj&&"function"==typeof this.onVisuObj&&this.onVisuObj(n,t,s)},onAnswerMiscData:function(n,t){if(null!=this.onMiscDataWCS&&"function"==typeof this.onMiscDataWCS){var i=t.readObjectArray("wcs","COptMiscWCS");null!=i&&this.onMiscDataWCS(n,i)}if(null!=this.onMiscDataLayer&&"function"==typeof this.onMiscDataLayer){var s=t.readObjectArray("layers","COptMiscLayer");null!=s&&this.onMiscDataLayer(n,s)}if(null!=this.onMiscDataLayerFilter&&"function"==typeof this.onMiscDataLayerFilter){var e=t.readObjectArray("layerFilters","COptMiscLayerFilter");null!=e&&this.onMiscDataLayerFilter(n,e)}if(null!=this.onMiscDataMaterial&&"function"==typeof this.onMiscDataMaterial){var r=t.readObjectArray("materials","COptMiscMaterial");null!=r&&this.onMiscDataMaterial(n,r)}if(null!=this.onMiscDataNoteParameters&&"function"==typeof this.onMiscDataNoteParameters){var o=t.readObjectArray("noteParameters","COptMiscNoteParameters");null!=o&&this.onMiscDataNoteParameters(n,o)}if(null!=this.onMiscDataSymmetry&&"function"==typeof this.onMiscDataSymmetry){var a=t.readObjectArray("symmetry","COptMiscSymmetry");null!=a&&this.onMiscDataSymmetry(n,a)}if(null!=this.onMiscDataDisplaySet&&"function"==typeof this.onMiscDataDisplaySet){var l=t.readObjectArray("displaySet","COptMiscDisplaySet");null!=l&&this.onMiscDataDisplaySet(n,l)}if(null!=this.onMiscDataUP&&"function"==typeof this.onMiscDataUP){var u=t.readObjectArray("userProperties","COptUserProperties");null!=u&&this.onMiscDataUP(n,u)}},onAnswerMappingData:function(n,t){if(null!=this.onMappingData&&"function"==typeof this.onMappingData){var i=t.readObjectArray("mappingData","COptMappingData");null!=i&&this.onMappingData(n,i)}},onAnswerEntityData:function(n,t){if(null!=this.onEntityData&&"function"==typeof this.onEntityData){var i=t.readObjectArray("entityData","COptEntity");null!=i&&this.onEntityData(n,i)}},open:function(t,i){this._nodeId=this._node.select("ContentOptimizer");var s=new n.Parameters;return s.writeString("inputFileName",t),s.writeBuffer("inputFile",i),this._node.call({destinationNodeId:this._nodeId,name:"coptOpen",version:1,parameters:s,onSuccess:this.onAnswerOpenSuccess.bind(this),onError:this.onAnswerOpenError.bind(this),onProgress:this.onAnswerOpenProgress.bind(this)}),!0,!0},openUrl:function(t,i){this._nodeId=this._node.select("ContentOptimizer");var s=new n.Parameters;return s.writeString("inputFileName",t),s.writeString("inputFileUrl",i),this._node.call({destinationNodeId:this._nodeId,name:"coptOpen",version:1,parameters:s,onSuccess:this.onAnswerOpenSuccess.bind(this),onError:this.onAnswerOpenError.bind(this),onProgress:this.onAnswerOpenProgress.bind(this)}),!0,!0},getAsm:function(t){var i=!1;if(null!=this._nodeId&&null!=this._DocId){var s=new n.Parameters;s.writeInt32("documentId",this._DocId),s.writeString("configName",t),this._node.call({destinationNodeId:this._nodeId,name:"coptGetAsm",version:1,parameters:s,onSuccess:this.onAnswerOpenSuccess.bind(this),onError:this.onAnswerOpenError.bind(this),onProgress:this.onAnswerOpenProgress.bind(this)}),i=!0}return i},importTo:function(t,i,s){var e=!1;if(console.log("documentId="+this._DocId+"partFormat="+t+" visuFormat="+i),null!=this._nodeId&&null!=this._DocId){var r=new n.Parameters;r.writeInt32("documentId",this._DocId),r.writeInt32("brep",t),r.writeInt32("visu",i),r.writeObject("options","COptImportOption",s),this._node.call({destinationNodeId:this._nodeId,name:"coptImportTo",version:1,parameters:r,onSuccess:this.onAnswerImportSuccess.bind(this),onError:this.onAnswerImportError.bind(this),onProgress:this.onAnswerImportProgress.bind(this)}),e=!0}return e},importRefTo:function(t,i,s,e){var r=!1;if(null!=this._nodeId&&null!=this._DocId){var o=new n.Parameters;o.writeInt32("documentId",this._DocId),o.writeInt32("refId",t),o.writeInt32("brep",i),o.writeInt32("visu",s),o.writeObject("options","COptImportOption",e),this._node.call({destinationNodeId:this._nodeId,name:"coptImportRefTo",version:1,parameters:o,onSuccess:this.onAnswerImportSuccess.bind(this),onError:this.onAnswerImportError.bind(this),onProgress:this.onAnswerImportProgress.bind(this)}),r=!0}return r},close:function(){var t=!1;if(null!=this._nodeId&&null!=this._DocId){var i=new n.Parameters;i.writeInt32("documentId",this._DocId),this._node.call({destinationNodeId:this._nodeId,name:"coptClose",version:1,parameters:i,onSuccess:this.onAnswerCloseSuccess.bind(this),onError:this.onAnswerCloseError.bind(this),onProgress:this.onAnswerCloseProgress.bind(this)}),t=!0}return t},dispose:function(){null!=this._nodeId&&(this._nodeId.close(),this._nodeId=null)}},d});