define("DS/Controls/ModalContainer",["UWA/Core","DS/Core/Core"],function(e,t){"use strict";return{createModal:function(t,i,n){if("static"===window.getComputedStyle(t).getPropertyValue("position"))throw"The given container is not positionned. Please position your container before creating a modalContainer on it.";t.classList.add("modalElement");var s=e.createElement("div",{class:"wux-controls-modalContainer"});if(n&&n.transparentFlag&&s.classList.add("wux-transparent"),i){var o=i.getContent?i.getContent():i;o.classList.add("wux-controls-modalContent"),s.appendChild(o)}s.inject(t)},removeModal:function(e){var t,i,n=e.getContent?e.getContent():e,s=n.children;if(s.length>0)for(var o=0;o<s.length;o++)if(s[o].classList.contains("wux-controls-modalContainer")){t=s[o];break}t&&((i=t.getElement(".wux-controls-modalContent"))&&(i.classList.remove("wux-controls-modalContent"),t.removeChild(i)),t.destroy()),n.classList.remove("modalElement")}}}),define("DS/Controls/DecoratorManager",["UWA/Core","UWA/Class"],function(e,t){"use strict";return t.singleton({defaultOptions:{},init:function(e){this._parent(e),this._decorator=null,this._widget=null,this._mapNamesDecorators={}},registerDecorator:function(e,t){this._mapNamesDecorators[e]?console.log("This decoratorID has already been registered"):this._mapNamesDecorators[e]=t},createDecorator:function(e,t,i,n,s){var o=this;this._mapNamesDecorators[e]?console.log("This decorator has already been registered"):require([n],function(n){var l=new n({widget:t,decoratedWidget:i});o.registerDecorator(e,l),s.call(o)})},showDecorator:function(e,t,i){this._widget=e,this._decorator&&this._decorator.hide(!0),i||(i=e.name),void 0===this._mapNamesDecorators[i]?console.log("DecoratorManager: Decorator has not been registered"):(this._decorator=this._mapNamesDecorators[i],this._decorator.setProperties({decoratedWidget:t,widget:e}),this._decorator.show())},hideDecorator:function(e,t){this._widget&&(null===this._widget.getContent().getAttributeNode("focused")||t)&&this._decorator.hide(e)},getWidget:function(){return this._widget},getDecorator:function(){return this._decorator},isDecoratorDisplayed:function(){return this._decorator&&this._decorator.visibleFlag}})}),define("DS/Controls/Stack",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core"],function(e,t,i){"use strict";var n={horizontal:"inline-block",vertical:"block"},s=i.extend({defaultOptions:{orientation:"horizontal",class:"",styles:{margin:0,padding:0}},init:function(e){this._parent(e),this._stackCells=[],this._stackCellsContainers=[],this._totalWeight=0,this.buildSkeleton(),this.addEvent("onPostInject",this._onPostInject)},buildSkeleton:function(){this.elements.container=new e.Element("ul",{class:"Stack "+this.options.class,styles:this.options.styles})},toggleOrientation:function(){},append:function(t,i){i=e.extend({weight:0,styles:null},i);var s=new e.Element("li",{styles:{display:n[this.options.orientation]},html:t,events:i.events});s.addClassName(i.class),s.setStyles(i.styles),this._totalWeight+=parseInt(i.weight,10),s.inject(this.elements.container);var o={container:s,options:i};return this._stackCellsContainers.push(s),this._stackCells.push(o),o},getElements:function(){return this._stackCells},getElementsContainers:function(){return this._stackCellsContainers},remove:function(e){var t=this._stackCells.indexOf(e);-1!==t&&(this._stackCellsContainers[t].destroy(),this._stackCells.splice(t,1),this._stackCellsContainers.splice(t,1))},_onPostInject:function(){var e=this,t=0;this._stackCells.forEach(function(i){var n;if(n=i.options.weight/e._totalWeight*100,i.options.weight)if("horizontal"===e.options.orientation){var s=t;t+=n,i.container.setStyles({left:s+"%",width:n+"%",top:0,bottom:0})}else i.container.setStyles("height",n+"%");0})}});return e.namespace("WUX/Controls/Stack",s)}),define("DS/Controls/LayerSet",["UWA/Core","UWA/Event","UWA/Controls/Abstract"],function(e,t,i){"use strict";var n=i.extend({defaultOptions:{styles:{}},init:function(e){this._parent(e),this._buildSkeleton()},_buildSkeleton:function(){this.elements.container=new e.Element("div",{class:"LayerSet",styles:this.options.styles}),this.elements._inner=new e.Element("div",{class:"Content"}),this.elements._inner.inject(this.elements.container)},addLayer:function(t,i){void 0===i&&(i={left:0,right:0,top:0,bottom:0});var n=new e.Element("div",{class:"Content"});return n.setStyle("position","absolute"),n.setStyles(i),t.inject(n),n.inject(this.elements._inner),n}});return e.namespace("Controls/LayerSet",n)}),define("DS/Controls/Scroller",["UWA/Core","UWA/Controls/Abstract","DS/CoreEvents/ModelEvents","DS/Utilities/Utils"],function(e,t,i,n){"use strict";var s=!1,o=10,l=40,a=800;return t.extend({defaultOptions:{eventPeriod:0,scrollDebounceTimeout:0,scrollEndTimeout:201,useRequestAnimationFrame:!1,events:{onScrollBegin:null,onScroll:null,onScrollEnd:null}},init:function(e,t){this._parent(t),this._modelEvents=new i({callMode:"asc"}),this._target=e,this._beginScrollPosition={x:0,y:0},this._scrollPosition={x:0,y:0},this._lastScrollPosition=this._scrollPosition,this._scrollDirection={x:0,y:0},this._overflow={horizontal:void 0,vertical:void 0},this._lastScrollDirection=this._scrollDirection,this._buildSkeleton(),this._bindBehaviors(),this._modelEvents.publish({event:"INIT",context:this})},_buildSkeleton:function(){var t=new e.Element("div",{class:"wux-scroller",styles:{position:"absolute",left:0,right:0,top:0,bottom:0}});this.elements.container=t,this._target.inject(this.elements.container)},onInit:function(e){return this._modelEvents.subscribe({event:"INIT"},e)},onScrollBegin:function(e){return this._modelEvents.subscribe({event:"SCROLL_START"},e)},onScroll:function(e){return this._modelEvents.subscribe({event:"SCROLL"},e)},_onVerticalScrollDirectionChanged:function(e){return this._modelEvents.subscribe({event:"VERTICAL_SCROLL_DIRECTION_CHANGED"},e)},_onHorizontalScrollDirectionChanged:function(e){return this._modelEvents.subscribe({event:"HORIZONTAL_SCROLL_DIRECTION_CHANGED"},e)},onScrollEnd:function(e){return this._modelEvents.subscribe({event:"SCROLL_END"},e)},_updatePosition:function(){this.elements.container&&this.setPosition({x:this.elements.container.scrollLeft,y:this.elements.container.scrollTop})},_bindBehaviors:function(){var t,i=this,r=null,h=!0;function u(){i._modelEvents.publish({event:"SCROLL",context:i})}var c=n.debounce(u,i.options.scrollDebounceTimeout);function d(e,n){i._updatePosition(),i.elements.verticalScrollbar&&i.elements.horizontalScrollbar&&i._updateScrollingFeedbacks(),h&&(s&&console.log("<<<< BEGIN >>>>"),i._beginScrollPosition=i.getPosition(),i.options.events.onScrollBegin&&i.options.events.onScrollBegin.call(i,i.getPosition()),i._modelEvents.publish({event:"SCROLL_START",context:i}),h=!1),clearTimeout(r),i.options.useRequestAnimationFrame&&!i._animationFrameRequested&&(i._animationFrameRequested=!0,t=requestAnimationFrame(p)),i._deltaPositionFromBeginning={x:i._scrollPosition.x-i._beginScrollPosition.x,y:i._scrollPosition.y-i._beginScrollPosition.y},s&&console.log(">> Scroll _deltaPositionFromBeginning("+i._deltaPositionFromBeginning.x+", "+i._deltaPositionFromBeginning.y+")"),i.options.useRequestAnimationFrame||(i.options.events.onScroll&&i.options.events.onScroll.call(i,i.getPosition()),i.options.scrollDebounceTimeout>0?c():u()),r=setTimeout(function(){s&&console.log("<<<< END >>>>"),i._deltaPositionFromBeginning={x:0,y:0},i.options.events.onScrollEnd&&i.options.events.onScrollEnd.call(i,i.getPosition()),i.options.useRequestAnimationFrame&&cancelAnimationFrame(t),i._modelEvents.publish({event:"SCROLL_END",context:i}),h=!0},i.options.scrollEndTimeout)}function p(){i.options.events.onScroll&&i.options.events.onScroll.call(i,i.getPosition()),i.options.scrollDebounceTimeout>0?c():u(),i._animationFrameRequested=!1}var m=!1;try{var g=Object.defineProperty({},"passive",{get:function(){m=!0}});window.addEventListener("testPassive",null,g),window.removeEventListener("testPassive",null,g)}catch(e){}if(this.options.scrollDebounceTimeout){var v=n.debounce(function(){d()},this.options.scrollDebounceTimeout);this.elements.container.addEventListener("scroll",v,!!m&&{passive:!0})}else this.elements.container.addEventListener("scroll",d,!!m&&{passive:!0});e.Element.addEvent.call(this.elements.container,"wheel",function(e){if(!e.ctrlKey&&!e.shiftKey){var t=(u=0,c=0,d=0,p=0,"detail"in(h=e)&&(c=h.detail),"wheelDelta"in h&&(c=-h.wheelDelta/120),"wheelDeltaY"in h&&(c=-h.wheelDeltaY/120),"wheelDeltaX"in h&&(u=-h.wheelDeltaX/120),"axis"in h&&h.axis===h.HORIZONTAL_AXIS&&(u=c,c=0),d=u*o,p=c*o,"deltaY"in h&&(p=h.deltaY),"deltaX"in h&&(d=h.deltaX),(d||p)&&h.deltaMode&&(1===h.deltaMode?(d*=l,p*=l):(d*=a,p*=a)),d&&!u&&(u=d<1?-1:1),p&&!c&&(c=p<1?-1:1),{spinX:u,spinY:c,pixelX:d,pixelY:p}),n=Math.abs(t.pixelY),s=0;if(t.pixelY<0&&0===i.elements.container.scrollTop||t.pixelY>0&&i.elements.container.scrollHeight-i.elements.container.scrollTop===i.elements.container.clientHeight)return;for(e.preventDefault();s<=n;){s+=50;var r=i.elements.container.scrollTop+50*t.spinY;i.elements.container.scrollTop=r}}var h,u,c,d,p})},setPosition:function(e,t){void 0===e.x&&(e.x=this.elements.container.scrollLeft),void 0===e.y&&(e.y=this.elements.container.scrollTop),t&&(this.elements.container.scrollTop=e.y,this.elements.container.scrollLeft=e.x,"immediate"!==t)||(this._lastScrollDirection=this._scrollDirection,this._scrollDirection={x:this._scrollPosition.x-this._lastScrollPosition.x>0?1:-1,y:this._scrollPosition.y-this._lastScrollPosition.y>0?1:-1},0!==this._lastScrollDirection.y&&this._lastScrollDirection.y!==this._scrollDirection.y&&this._modelEvents.publish({event:"VERTICAL_SCROLL_DIRECTION_CHANGED",context:this}),0!==this._lastScrollDirection.x&&this._lastScrollDirection.x!==this._scrollDirection.x&&this._modelEvents.publish({event:"HORIZONTAL_SCROLL_DIRECTION_CHANGED",context:this}),this._lastScrollPosition=this._scrollPosition,this._scrollPosition=e)},_resetDeltaScrollPositionFromBeginning:function(){this._beginScrollPosition={x:this._scrollPosition.x,y:this._scrollPosition.y},this._deltaPositionFromBeginning={x:0,y:0}},getDeltaScrollPositionFromBeginning:function(){return this._deltaPositionFromBeginning},resetPosition:function(){this.setPosition({x:0,y:0}),this.setPosition({x:0,y:0},!0)},scrollToPosition:function(t){console.warn("Don't use this method yet"),t=e.extend({scrollDuration:2e3,position:{x:0,y:0,onComplete:function(){}}},t);var i,n,s=this.elements.container,o=s.scrollTop,l=s.scrollLeft,a=Math.PI/(t.scrollDuration/15),r=l-t.x,h=o-t.y,u=null;requestAnimationFrame(function e(c){var d;null===u&&(u=c,console.warn("start"));d=c-u;a=1-Math.cos(Math.PI*(1-(t.scrollDuration-d)/t.scrollDuration));var p,m;r<0&&(p=s.scrollLeft<t.x);r>0&&(p=s.scrollLeft>t.x);h<0&&(m=s.scrollTop<t.y);h>0&&(m=s.scrollTop>t.y);(m||p)&&(s.scrollTop!==t.y&&(requestAnimationFrame(e),1,n=Math.floor(h*a),s.scrollTop=Math.floor(o-n)),s.scrollLeft!==t.x&&(requestAnimationFrame(e),1,i=Math.floor(r*a),s.scrollLeft=Math.floor(l-i)))})},getPosition:function(e){return e?{x:this.elements.container.scrollLeft,y:this.elements.container.scrollTop}:this._scrollPosition},getDeltaScrollPosition:function(){return{x:this._scrollPosition.x-this._lastScrollPosition.x,y:this._scrollPosition.y-this._lastScrollPosition.y}},showScrollingFeedbacks:function(){this._scrollingFeedbacksDisplayed=!0,this.elements.scrollbarContainer||(this.elements.scrollbarContainer=new e.Element("div",{class:"wux-scroller-scrollbarContainer"}).inject(this.elements.container)),this.elements.verticalScrollbar||(this.elements.verticalScrollbar=new e.Element("div",{class:"wux-vertical-scrollbar"}).inject(this.elements.scrollbarContainer)),this.elements.horizontalScrollbar||(this.elements.horizontalScrollbar=new e.Element("div",{class:"wux-horizontal-scrollbar"}).inject(this.elements.scrollbarContainer)),this._updateScrollingFeedbacks(),this.elements.verticalScrollbar.classList.remove("wux-scrollbar-hidden"),this.elements.horizontalScrollbar.classList.remove("wux-scrollbar-hidden"),"hidden"!==this._overflow.vertical&&this.elements.verticalScrollbar.classList.add("wux-scrollbar-visible"),"hidden"!==this._overflow.horizontal&&this.elements.horizontalScrollbar.classList.add("wux-scrollbar-visible")},_updateScrollingFeedbacks:function(){if(this.elements.verticalScrollbar&&this.elements.horizontalScrollbar){let p=6,m=40;var e=this.getContent().getDimensions(),t=this.getContent().scrollHeight,i=t>0?e.height/t:1,n=Math.max(Math.round((e.height-2*p)*i),m),s=t>0?this._scrollPosition.y/(t-e.height):0,o=this._scrollPosition.y+Math.floor((e.height-2*p-n)*s)+p,l=this._scrollPosition.x+e.width-p,a=this.getContent().scrollWidth,r=a>0?e.width/a:1,h=Math.max(Math.round((e.width-2*p)*r),m),u=a>0?this._scrollPosition.x/(a-e.width):0,c=this._scrollPosition.y+e.height-p,d=this._scrollPosition.x+Math.floor((e.width-2*p-h)*u)+p;i>=1?this.elements.verticalScrollbar.hide():(this.elements.verticalScrollbar.show(),this.elements.verticalScrollbar.setStyle("height",n+"px"),this.elements.verticalScrollbar.setStyle("top",o+"px"),this.elements.verticalScrollbar.setStyle("left",l+"px")),r>=1?this.elements.horizontalScrollbar.hide():(this.elements.horizontalScrollbar.show(),this.elements.horizontalScrollbar.setStyle("width",h+"px"),this.elements.horizontalScrollbar.setStyle("top",c+"px"),this.elements.horizontalScrollbar.setStyle("left",d+"px"))}},hideScrollingFeedbacks:function(){this._scrollingFeedbacksDisplayed&&this.elements.verticalScrollbar&&this.elements.horizontalScrollbar&&(this.elements.verticalScrollbar.classList.remove("wux-scrollbar-visible"),this.elements.horizontalScrollbar.classList.remove("wux-scrollbar-visible"),this.elements.verticalScrollbar.classList.add("wux-scrollbar-hidden"),this.elements.horizontalScrollbar.classList.add("wux-scrollbar-hidden")),this._scrollingFeedbacksDisplayed=!1},areScrollbarsDisplayed:function(e){const t=this.getContent();return e&&"vertical"===e?t.scrollHeight>t.offsetHeight&&"hidden"!==this._overflow.vertical:e&&"horizontal"===e?t.scrollWidth>t.offsetWidth&&"hidden"!==this._overflow.horizontal:{vertical:t.scrollHeight>t.offsetHeight&&"hidden"!==this._overflow.vertical,horizontal:t.scrollWidth>t.offsetWidth&&"hidden"!==this._overflow.horizontal}},_setOverflow:function(e){e&&(e.hasOwnProperty("horizontal")&&(void 0===e.horizontal?this.getContent().style["overflow-x"]="":this.getContent().style["overflow-x"]=e.horizontal,this._overflow.horizontal=e.horizontal),e.hasOwnProperty("vertical")&&(void 0===e.horizontal?this.getContent().style["overflow-y"]="":this.getContent().style["overflow-y"]=e.vertical,this._overflow.vertical=e.vertical))}})}),define("DS/Controls/Deck",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","DS/Maths/Vector3","DS/Utilities/Utils"],function(e,t,i,n,s,o){"use strict";var l={translate:!0,translate3d:!0,translateX:!0,translateY:!0,translateZ:!0,rotate:!0,rotate3d:!0,rotateX:!0,rotateY:!0,rotateZ:!0,scale3d:!0};return i.extend({init:function(t){this._transitionCounter=0;this.settings=e.extend({selector:null,onComplete:function(){}},t),this.container=document.querySelector(this.settings.container),"string"==typeof this.settings.selector?(this.items=o.listToArray(document.querySelectorAll(this.settings.selector)),n.log("selector is string")):(this.items.push(this.settings.selector),n.log("selector is uwa element")),n.log(this.items),this.currentEffectIndice=0,this.play()},buildSkeleton:function(){var t=this.elements;t.container=new e.Element("div",{class:"AfrActionBar2",events:null}),t.itemContainer=t.container},_attachTransition:function(){var e=this;this._transitionCounter=this.items.length,this.items.forEach(function(t){t.style.webkitTransition=e.settings.duration+"ms "+e.settings.ease}),setTimeout(function(){e.nextEffect()},e.settings.duration)},_dettachTransition:function(){this.items.forEach(function(e){e.style.webkitTransition=""})},initial:function(){this.items.forEach(function(e){e.style.webkitTransform=""})},play:function(e){void 0===e&&(e=0);var t=this.settings.distributions[e];if(t){var i,n=this,s=this.items.length;this._attachTransition(),setTimeout(function(){for(i=0;i<s;i++)n._iterate(i,n.items[i],t)},10)}},_iterate:function(e,t,i){var o=t.style.webkitTransform;for(var a in i)if("string"==typeof i[a])t.style[a]=i[a];else{var r=i[a](e,t,this.items);if(l[a]){var h="",u="";switch(a){case"scale3d":u=/scale3d\((-?\d+(?:\.\d*)?), (-?\d+(?:\.\d*)?), (-?\d+(?:\.\d*)?)\)/,h=new s([r.x,r.y,r.z]).toString();break;case"translate3d":u=/translate3d\((-?\d+(?:\.\d*)?)px, (-?\d+(?:\.\d*)?)px, (-?\d+(?:\.\d*)?)px\)/,h=new s([r.x,r.y,r.z]).toString();break;case"rotate3d":u=/rotate3d\((-?\d+(?:\.\d*)?), (-?\d+(?:\.\d*)?), (-?\d+(?:\.\d*)?), (-?\d+(?:\.\d*)?)rad\)/,h=new s([r.x,r.y,r.z]).toString()+", "+r.a+"rad"}o=o.replace(u,""),o+=" "+a+"("+h+")"}else t.style[a]=r}n.log("transform:"+o),t.style.webkitTransform=o},nextEffect:function(){this.currentEffectIndice++,this.settings.distributions[this.currentEffectIndice]&&this.play(this.currentEffectIndice)}})}),define("DS/Controls/ViewBase",["UWA/Core","UWA/Controls/Abstract","DS/Utilities/Utils","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents"],function(e,t,i,n,s){"use strict";return t.extend({defaultOptions:{size:"small",view:"thumbnail",menu:[],icon:"",color:null},init:function(t){this._parent(t),this._modelEvents=new s,this.elements.container=this.elements.thumbnail=new e.Element("div",{class:"wux-controls-"+this.options.view+" wux-ui-size-"+this.options.size}),this.elements.picture=new e.Element("div",{class:"wux-controls-"+this.options.view+"-picture"}).inject(this.elements.thumbnail),this.elements.cartouche=new e.Element("div",{class:"wux-controls-"+this.options.view+"-cartouche"}).inject(this.elements.thumbnail),this.elements.cartoucheContent=new e.Element("div",{class:"wux-controls-"+this.options.view+"-cartouche-content"}).inject(this.elements.cartouche),this.elements.color=new e.Element("div",{class:"wux-controls-"+this.options.view+"-color"}).inject(this.elements.cartoucheContent),this.elements.title=new e.Element("div",{class:"wux-controls-"+this.options.view+"-title wux-ui-size-"+this.options.size+" wux-font-3dsregular"}).inject(this.elements.cartoucheContent),this.elements.subtitle=new e.Element("div",{class:"wux-controls-"+this.options.view+"-subtitle",html:"Sous-titre"}).inject(this.elements.cartoucheContent),this.elements.menu=new e.Element("div",{class:"wux-controls-"+this.options.view+"-menu wux-ui-size-"+this.options.size}).inject(this.elements.thumbnail),this.elements.menu.addClassName("wux-ui-3ds"),this.elements.menu.addClassName("wux-ui-3ds-open-down"),this.elements.description=new e.Element("div",{class:"wux-controls-"+this.options.view+"-description"}).inject(this.elements.cartoucheContent)},_attachEvents:function(){var e=this;this.elements.container.addEventListener(n.POINTERUP,function(t){e._modelEvents.publish({event:"containerUp",context:e})}),this.elements.picture.addEventListener(n.POINTERUP,function(t){e._modelEvents.publish({event:"pictureUp",context:e})}),this.elements.title.addEventListener(n.POINTERUP,function(t){e._modelEvents.publish({event:"titleUp",context:e})}),this.elements.subtitle.addEventListener(n.POINTERUP,function(t){e._modelEvents.publish({event:"subtitleUp",context:e})}),this.elements.description.addEventListener(n.POINTERUP,function(t){e._modelEvents.publish({event:"descriptionUp",context:e})}),this.elements.cartouche.addEventListener(n.POINTERUP,function(t){e._modelEvents.publish({event:"cartoucheUp",context:e})})},onClick:function(e){return this._modelEvents.subscribe({event:"containerUp"},e)},onCartoucheClick:function(e){return this._modelEvents.subscribe({event:"cartoucheUp"},e)},onTitleClick:function(e){return this._modelEvents.subscribe({event:"titleUp"},e)},onSubtitleClick:function(e){return this._modelEvents.subscribe({event:"subtitleUp"},e)},onDescriptionClick:function(e){return this._modelEvents.subscribe({event:"descriptionUp"},e)},onPictureClick:function(e){return this._modelEvents.subscribe({event:"pictureUp"},e)},setColor:function(e){e?(this.elements.container.setAttribute("has-color","true"),this.elements.color.setStyles({background:e}).show()):(this.elements.container.setAttribute("has-color","false"),this.elements.color.hide())},setTitle:function(e){if(this.elements.menu&&this.elements.menu.cellView){this.elements.title.layoutDsModel=this.elements.menu.cellView.getGridEngine();var t=this.elements.menu.cellView.getCellInfos();if(!1===i.getUnsafeHTMLContentValueToApply(this.elements.menu.cellView.getGridEngine().options.shouldCellAllowUnsafeHTMLContentAt(t)))return void(this.elements.title.textContent=e)}this.elements.title.setHTML(e)},setSubtitle:function(e){if(this.elements.menu&&this.elements.menu.cellView){this.elements.subtitle.layoutDsModel=this.elements.menu.cellView.getGridEngine();var t=this.elements.menu.cellView.getCellInfos();if(!1===i.getUnsafeHTMLContentValueToApply(this.elements.menu.cellView.getGridEngine().options.shouldCellAllowUnsafeHTMLContentAt(t)))return void(this.elements.subtitle.textContent=e)}this.elements.subtitle.setHTML(e)},setPicture:function(e){this.elements.picture.setStyles({backgroundImage:"url("+e+")"})},setDescription:function(e){if(this.elements.menu&&this.elements.menu.cellView){this.elements.description.layoutDsModel=this.elements.menu.cellView.getGridEngine();var t=this.elements.menu.cellView.getCellInfos();if(!1===i.getUnsafeHTMLContentValueToApply(this.elements.menu.cellView.getGridEngine().options.shouldCellAllowUnsafeHTMLContentAt(t)))return void(this.elements.description.textContent=e)}this.elements.description.setHTML(e)}})}),define("DS/Controls/CustomizableDecoratorItems",["require","exports","text!DS/Controls/assets/CustomizableDecoratorItems.json","UWA/Core"],function(e,t,i,n){"use strict";return function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]}return e.getInstance=function(){return e.instance||(e.instance=new e,e.instance._registeredItems={},e.addDecoratorItems(JSON.parse(i))),e.instance},e.addDecoratorItems=function(t){t&&"object"==typeof t&&(e.getInstance()._registeredItems=n.merge(t,e.getInstance()._registeredItems))},e.getItem=function(t){return e.getInstance()._registeredItems[t]},e}()}),define("DS/Controls/TooltipLoader",["require","exports","DS/Core/TooltipManager"],function(e,t,i){"use strict";var n=function(){function t(){}return t.initTooltipFrame=function(){this._loadedState||(new Promise(function(t,i){e(["DS/Controls/Tooltip"],t,i)}).then(function(e){void 0===i._tooltipFrame&&(i._tooltipFrame=new e)}),this._loadedState=!0)},t._loadedState=!1,t}();return n.initTooltipFrame(),n}),define("DS/Controls/Switch",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","UWA/Controls/Segmented","DS/Utilities/UUID","DS/CoreEvents/ModelEvents","DS/Core/PointerEvents"],function(e,t,i,n,s,o,l,a){"use strict";return i.extend({defaultOptions:{label:null,value:!1,onChange:null,size:"mid"},init:function(e){console.warn("/!\\************************************   WEB UX TEAM    ***************************************/!\\"),console.warn("/!\\*********************       MESSAGE TO THE SWITCH CONTROL USERS         *********************/!\\"),console.warn("/!\\*********************         Switch control is deprecated              *********************/!\\"),console.warn("/!\\*********************     Please migrate to the Toggle control asap     *********************/!\\"),console.warn("/!\\*********************     Please see the Toggle API in the Showroom     *********************/!\\"),console.warn("/!\\*********************************************************************************************/!\\"),this._parent(e),this.options.size="mid",this._uuid=o.v4(),this._modelEvents=new l,this._buildView(),this.setValue(this.options.value,!1),this._proxifyEvents()},_buildView:function(){this.elements.container=new e.Element("ul",{class:"wux-ui-stack-h wux-controls-switch wux-ui-size-"+this.options.size,styles:{display:this.options.label?"block":"inline-block"}}),this.options.label&&(this.elements.label=new e.Element("li",{class:"wux-controls-switch-label",html:this.options.label}).inject(this.elements.container)),this.elements.switchContainer=new e.Element("li",{class:"wux-controls-switch-container"}).inject(this.elements.container),this.elements.checkbox=new e.Element("input",{class:"wux-controls-switch-checkbox",id:"wux-controls-switch-"+this._uuid,type:"checkbox"}).inject(this.elements.switchContainer),this.elements.outer=new e.Element("label",{class:"wux-controls-switch-outer",for:"wux-controls-switch-"+this._uuid,type:"checkbox"}).inject(this.elements.switchContainer),this.elements.inner=new e.Element("div",{class:"wux-controls-switch-inner"}).inject(this.elements.outer),this.elements.button=new e.Element("div",{class:"wux-controls-switch-button"}).inject(this.elements.outer)},_proxifyEvents:function(){var e=this;this.elements.container.addEvent("click",function(t){t.stopPropagation(),e.setValue(!e.elements.checkbox.checked)}),this.elements.checkbox.addEventListener("change",function(e){e.stopPropagation()}),this.elements.container.addEvent("mousedown",function(e){e.stopPropagation()}),this.elements.container.addEvent("mouseup",function(e){e.stopPropagation()})},onChange:function(e){return this._modelEvents.subscribe({event:"EVT_CHANGE"},e)},getValue:function(){return this.elements.checkbox.checked},setValue:function(e,t){var i=this;void 0===t&&(t=!0),this.elements.checkbox.checked=e,this.elements.checkbox.checked?(this.elements.container.setAttribute("checked","true"),this.elements.checkbox.setAttribute("checked","true")):(this.elements.container.removeAttribute("checked"),this.elements.checkbox.removeAttribute("checked")),t&&(i.options.onChange&&i.options.onChange.call(i,i.getValue()),i._modelEvents.publish({context:i,event:"EVT_CHANGE",data:i}))}})}),define("DS/Controls/TreeNodeBase",["UWA/Core","UWA/Controls/Abstract","DS/Core/Core","DS/UIBehaviors/Draggable","DS/UIBehaviors/Droppable","UWA/Utils/Client"],function(UWA,Abstract,WUX,WUXDraggable,WUXDroppable,UWAClient){"use strict";var FX_DURATION=200,NAVIGATOR=UWAClient.Engine,DEBUG=!1;function wux_move(e,t,i){if(i>=e.length)for(var n=i-e.length;1+n--;)e.push(void 0);return e.splice(i,0,e.splice(t,1)[0]),e}function cleanArray(e){for(var t=[],i=0;i<e.length;i++)e[i]&&t.push(e[i]);return t}var TreeNodeBase=Abstract.extend({defaultOptions:{expandAtInit:!1,isFakeRoot:!1,isRoot:!1,isEditable:void 0,isDraggable:void 0,node:null,tree:null,animateOnExpand:!1,onPreExpand:null,onPostExpand:null,onPreCollapse:null,onPostCollapse:null,UI:"default",rowIndex:null,data:null,renderSaver:100,allowTextCopy:!1},init:function(e){this._parent(e),this.options=UWA.extend(this.options,e),this._uuid=UWA.Utils.getUUID(),this._nodeDepth=-1,this._childrenSlots=[],this._children="array"===UWA.typeOf(this.options.children)?[]:null,this._childID=null,this._isExpanded=!1,this._isInTreeListView=!1,this._hasBeenAttached=!1,this._rowIndex=null,this._isInWriteMode=!1,this._updateViewTimeout=null;var t=this;this._modeIsExpandAll=!1,this._modeIsMultiSel=!1,UWA.typeOf(this.options.UI),this.buildSkeleton(),this.options.isRoot&&this._attachToView(),UWA.Element.addEvent.call(document,"keydown",function(e){"ctrl"!==UWA.Event.whichKey(e)||t._modeIsMultiSel||(t._modeIsMultiSel=!0)}),UWA.Element.addEvent.call(document,"keyup",function(e){"ctrl"===UWA.Event.whichKey(e)&&(t._modeIsMultiSel=!1)})},delegateEvents:function(){WUX.warn("deprecated","don't use anymore the method delegateEvents on TreeNode")},getParent:function(){return this._parentNode},getRoot:function(){for(var e=this;e&&!e.options.isRoot;)e=e.getParent();return e},getPath:function(){for(var e=this,t="";e&&!e.options.isRoot;)e.elements.label&&e.elements.label.getText()&&(t=e.elements.label.getText()+" > "+t),e=e.getParent();return t},isAscendantOf:function(e){for(var t=e;t&&!t.options.isRoot;)if((t=t.getParent())===this)return!0;return!1},highlight:function(e){void 0===e?this.elements.label.addClassName("wux-datagrid-cell-highlighted"):this.elements.label.setStyles(e)},unhighlight:function(){this.elements.label.removeClassName("wux-datagrid-cell-highlighted")},setLabel:function(e,t){void 0===t&&(t=!0),this.options.label=e,this.isInWriteMode()?this.switchToWriteView():this.switchToReadView();var i=this.getTree();i&&t&&i._modelEvents.publish({context:this,event:"UPDATE_LABEL",data:e})},getLabel:function(){return this.options.label},isInWriteMode:function(){return this._isInWriteMode},switchToWriteView:function(){var e=this,t=this.options,i=this.options.isEditable;void 0===i.switchToWriteView.callback&&(i.switchToWriteView.callback=function(e){this.switchToWriteView()});var n=t.label;this.elements._readWriteContainer=i.switchToWriteView.view.call(this,this),this.elements._readWriteContainer.addEvent("change",function(e){n=this.value}),i.switchToReadView.event.split(" ").forEach(function(t){e.elements._readWriteContainer.addEvent(t,function(t){i.switchToReadView.callback.call(e,t,e),e._isInWriteMode=!1,e.setLabel(n)})}),this.elements.label.setContent(this.elements._readWriteContainer),this.elements._readWriteContainer.focus(),this._isInWriteMode=!0},switchToReadView:function(){var e=this,t=this.options.isEditable;t&&t.switchToReadView&&t.switchToWriteView?(void 0===t.switchToReadView.callback&&(t.switchToReadView.callback=function(e){this.switchToReadView()}),this.elements._readOnlyContainer=t.switchToReadView.view.call(this,this),t.switchToWriteView.event.split(" ").forEach(function(i){e.elements._readOnlyContainer.addEvent(i,function(i){t.switchToWriteView.callback.call(e,i,e)})})):this.elements._readOnlyContainer=new UWA.Element("div",{html:this.options.label});this.elements.label&&this.elements.label.setContent(this.elements._readOnlyContainer),this._isInWriteMode=!1},addChild:function(e,t){if(e.isAscendantOf(this))console.warn("logical error","You tried to attach a node on one of its descendant, or on itself");else{if(e.getParent()===this){var i=this._children.indexOf(e);wux_move(this._children,i,t),this._children=cleanArray(this._children)}else e.elements.container&&e.elements.container.parentNode&&e.elements.container.parentNode.removeChild(e.elements.container),e.getParent()&&e.getParent().removeChild(e),e.isExpanded()&&e.collapse(),e.options.UI=this.options.UI,e.options.tree=this.options.tree,this.options.tree&&this._onTreeAttach(t),this._children||(this._children=[]),void 0!==t?(this._children.splice(t,0,e),e._childID=this._children.length-1):e._childID=this._children.push(e)-1;e._setParent(this),this._hasBeenAttached=!0}},addChildren:function(e,t){var i=this;this.children.forEach(function(e){i.addChild(e,t)})},_setParent:function(e){if(this._parentNode=e,e){var t=e.getNextBrothersNodes();t.length&&t[0]._updateView(!1),e._updateView(e._isExpanded,e._isExpanded)}this._inheritFromTree(),this.getParent()&&this.getParent().getParent()&&this.getParent().getParent()._updateView(!1)},_inheritFromTree:function(){if(null===this.options.isEditable||void 0===this.options.isEditable){var e=this.getTree();e&&e.options.isEditable&&(this.options.isEditable={},UWA.extend(this.options.isEditable,e.options.isEditable,!0))}},_unsetParent:function(){var e=this.getParent();this._dettachFromView();var t=this.getPrevBrotherNode(),i=e.getChildren().splice(this._childID,1)[0];return t&&t._updateView(),0===e.getChildren().length&&e._isExpanded&&(e._isExpanded=!1),e&&e._updateView(),this._setParent(null),i},_onTreeAttach:function(){this._buildExpander(!1);var e=this.getChildren();e&&e.forEach(function(e){e._onTreeAttach()})},removeChild:function(e,t){void 0===t&&(t=!0),e.getContent().destroy();var i=this._children.indexOf(e);-1!==i&&this._children.splice(i,1),this.getLastChild()&&(this.getLastChild()._buildExpander(!1),this.getLastChild()._buildLink(!0)),t&&this.getChildren()&&0===this.getChildren().length&&(this._children=null),this._buildExpander(!1),this._buildLink(!0)},remove:function(){this.getParent().removeChild(this)},removeChildren:function(){for(var e=this._children.length,t=0;t<e;t++)this._children[t]&&this.removeChild(this._children[t]);this._children=null,this.updateExpanderState()},buildSkeleton:function(e){this.elements.container&&this.elements.container.parentNode&&this.elements.container.parentNode.removeChild(this.elements.container),this.elements.container=new UWA.Element("li",{class:"Container",styles:{position:"relative",overflow:"hidden",minHeight:16}}),this._buildChildrenContainer()},updateExpanderState:function(){this._buildExpander(!1)},_buildExpander:function(e){void 0===e&&(e=!0);var t=this,i=this.options,n=i.UI,s=(n.icon.size-(n.expander.size+2*n.expander.borderSize))/2,o=0;if(this._children)switch(UWA.typeOf(this._children)){case"string":this._expandState="asyncState",this._nodeIsAsync=!0;break;case"array":this._isExpanded?this._expandState="collapseState":this._expandState="expandState",this._nodeIsAsync=!1}else this.isRoot()?this._expandState="noExpandRoot":this._expandState="noExpandState",this._nodeIsAsync=!1,o=n.expander.size*n.expander.borderSize/2,s=n.icon.size/2;var l=this.options.UI[this._expandState];l.styles.marginLeft=o,l.styles.marginTop=s,e?(i&&i.children&&this.elements.container.setAttributes({"data-isExpanded":!1}),this.elements.expander=new UWA.Element("li",l),this.elements.expander.inject(this.elements.view),this.elements.expander.removeEvent("click"),this.elements.expander.addEvent("click",function(e){t._isExpanded?t.collapse():t.expand()})):this.elements.expander&&(this.elements.expander.set(this.options.UI[this._expandState]),this.options.UI.shadow&&this.elements.expander.addClassName("Shadow"))},_isLastChild:function(){return this.getParent()&&this.getParent().getChildren().indexOf(this)+1===this.getParent().getChildren().length},_buildLink:function(e){if(!this.options.isRoot){var t=this.options.UI;void 0===e&&(e=!1);var i="bottom",n=-2*t.layout.btMargin+t.icon.size/2+"px";this._isLastChildFlag=this._isLastChild(),this._isLastChild()&&(i="height",n=2*t.layout.btMargin+t.icon.size/2+t.link.size/2+"px");var s=-Number(t.layout.btMargin)+"px";e||(this.elements.verticalLink=new UWA.Element("li",{text:"",class:"Link"}),this.elements.verticalLink.inject(this.elements.container)),this.elements.verticalLink&&(this.elements.verticalLink.setStyles({borderLeft:t.link.size+"px "+t.link.style+" "+t.link.color,top:s,position:"absolute",left:this._marginLeft+t.expander.size/2}),"bottom"===i?this.elements.verticalLink.setStyle("height","auto"):this.elements.verticalLink.setStyle("bottom","auto"),this.elements.verticalLink.setStyle(i,n))}},_buildIcons:function(){var e=this.options;if(e&&e.icons){this.elements.icons=[];for(var t=e.icons.length,i=0;i<t;i++){var n=new UWA.Element("li",{class:"Icon",styles:{marginLeft:this.options.UI.layout.lrMargin,background:"url("+e.icons[i]+")",backgroundSize:"100%"}});n.inject(this.elements.view),this.elements.icons.push(n)}}},setIcon:function(e){if(e=UWA.extend({picture:"",iconID:0},e),this.elements.icons[e.iconID])this.elements.icons[e.iconID].setStyles({marginLeft:this.options.UI.layout.lrMargin,background:"url("+e.picture+")",backgroundSize:"100%"});else{var t=new UWA.Element("li",{class:"Icon",styles:{marginLeft:this.options.UI.layout.lrMargin,background:"url("+e.picture+")",backgroundSize:"100%"}});t.inject(this.elements.view),this.elements.icons[e.iconID](t)}},_buildLabel:function(){var e=this.options,t=this;e.label&&(e.isRoot?this.options.UI.label.fontWeight="bold":this.options.UI.label.fontWeight="normal",this.elements.label=new UWA.Element("li",{class:"wux-treenode-label",styles:this.options.UI.label}),this.elements.label.setStyles(this.options.UI.label),this._isHighlighted&&this.elements.label.setStyles({boxShadow:"inset 0px 0px 7px rgb(0, 133, 255), inset 0 0 200px #0FF"}),this.options.UI.shadow&&this.elements.label.addClassName("Label Shadow"),this.elements.label.setStyles({backgroundColor:e.backgroundColor}),this.elements.label.inject(this.elements.view),this.elements.label.addEvent("click",function(e){var i=t.getTree();i.options.onClick&&i.options.onClick.apply(t,t,t.options.data)}),this.elements.label.addEvent("click",function(e){var i=t.getTree();i&&(i._modeIsMultiSel=e.ctrlKey,i._modelEvents.publish({event:"click",data:t}))}),this.elements.label.addEvent("dblclick",function(e){var i=t.getTree();i&&i._modelEvents.publish({event:"dblClick",data:t})}))},getTree:function(){var e=this.getRoot();return e?e.options.tree:this.options.tree},buildNode:function(){var e,t=this.options;this.getParent()&&(this._nodeDepth=this.getParent()._nodeDepth+1),this.elements.container.setAttributes({"data-nodeDepth":this._nodeDepth}),t.grid&&(e="wux-tree-row"),t.isRoot&&(e+=" wux-tree-headers"),this.elements.row=new UWA.Element("div",{class:e,styles:{display:"inline-block",whiteSpace:"pre",marginRight:14}});var i=this.options.UI;this._marginLeft=this._nodeDepth*(i.layout.lrMargin+1*(i.expander.size+2*i.expander.borderSize)+(i.icon.size-(i.expander.size+2*i.expander.borderSize))/2),this.elements.view=new UWA.Element("ul",{class:"Node Horizontal",styles:{marginLeft:this._marginLeft+"px",position:"relative",display:"inline-block",zIndex:10,paddingTop:this.options.UI.layout.btMargin}}),this._inheritFromTree(),this._buildExpander(),this._buildLink(),this._buildIcons(),this._buildLabel(),this.elements.view.inject(this.elements.row),this._customizeNodeView&&this._customizeNodeView(),this.elements.row.inject(this.elements.container,"top"),this.options.expandAllAtInit&&this._nodeDepth>0||0===this._nodeDepth?this.show():this.hide(),this.setLabel(this.options.label,!1)},_buildChildrenContainer:function(){this.elements.childrenContainer=new UWA.Element("ul",{class:"wux-controls-treenodebase-children wux-ui-stack-v",styles:{}}).inject(this.elements.container)},getPrevBrotherNode:function(){if(this.getParent()){var e=this.getParent().getChildren().indexOf(this);if(e>0)return e--,this.getParent().getNthChild(e)}},getNextBrotherNode:function(){if(this.getParent()){var e=this.getParent().getChildren().indexOf(this);if(e<this.getParent().getChildren().length)return e++,this.getParent().getNthChild(e)}},getNextBrothersNodes:function(){var e=[];if(this.getParent())for(var t=this.getParent().getChildren().indexOf(this);t<this.getParent().getChildren().length-1;)t++,e.push(this.getParent().getNthChild(t));return e},getChildIndex:function(){return this.getParent()&&this.getParent().getChildren()?this.getParent().getChildren().indexOf(this):-1},getChildren:function(){return this._children},hasChildren:function(){var e=this.getChildren();return!!(e&&e.length>0)},getAllDescendants:function(e){void 0===e?e=[]:e.push(this);var t=this.getChildren();return t&&t.forEach(function(t){t.getAllDescendants(e)}),e},getNthChild:function(e){if(this.getChildren())return this._children[e]},getLastChild:function(){return this._children[this._children.length-1]},_getRowIndex:function(){return this.options._rowIndex},_setRowIndex:function(e){this.options._rowIndex=e},onPreExpand:function(e){e&&(this.options.onPreExpand=e)},onPostExpand:function(e){e&&(this.options.onPostExpand=e)},_preExpandDone:function(){this.getTree()._modelEvents.publish({event:"PRE_EXPAND_DONE"})},expand:function(e){void 0===e&&(e=1);var t=this,i=function(){!0!==t._modeIsExpandAll?(t._modeIsExpandAll=e,t._modeIsExpandAll&&t._modeIsExpandAll>0&&(t._modeIsExpandAll--,t._processChildren(!0))):t._processChildren(!0),t.getChildren()||t._buildExpander(!1),t.getTree()._modelEvents.publish({event:"expand",context:t,data:{node:t}}),t.options.onPostExpand&&t.options.onPostExpand.call(t),t.getTree()._modelEvents.publish({event:"postExpand",context:t,data:{node:t}})};e>0&&!this.isExpanded()&&(t.getTree()._modelEvents.publish({event:"preExpand",context:t,data:{node:t}}),t.options.onPreExpand&&t.options.onPreExpand.call(t),t.options.useAsyncPreExpand?t.getTree()._modelEvents.subscribe({event:"PRE_EXPAND_DONE"},function(){i()}):i())},expandAll:function(){this._modeIsExpandAll=!0,this._processChildren(!0),this._modeIsExpandAll=!1},isExpanded:function(){return this._isExpanded},isRoot:function(){return this.options.isRoot},_showChildren:function(){var e=this;this._children.forEach(function(t){(t._attachToView(),e._modeIsExpandAll&&t.expand(e._modeIsExpandAll),e.options.animateOnExpand)&&new UWA.Fx(t.getContent(),{duration:FX_DURATION,transition:"quintIn"}).start({opacity:[0,1],marginTop:[-20,0]});e.getTree()._onUpdate(t)}),this._isExpanded=!0,this.elements.expander&&this.elements.expander.set(this.options.UI.collapseState)},_processChildren:function(){var e=this.getChildren();this._loadModel(e)},_getObjectClass:function(){return"TreeNodeBase"},onPreCollapse:function(e){e&&(this.options.onPreCollapse=e)},onPostCollapse:function(e){e&&(this.options.onPostCollapse=e)},collapseNode:function(){console.warn("Please use the collapse method instead"),this.collapse()},collapse:function(){this.isExpanded()&&(this.options.onPreCollapse&&this.options.onPreCollapse.call(this),this.getTree()._modelEvents.publish({event:"preCollapse",context:this,data:{node:this}}),this._children&&this._children.forEach(function(e){e._dettachFromView(),e.collapse()}),this._isExpanded=!1,this._expandState="expandState",this.isDrawn()&&this.elements.expander.set(this.options.UI[this._expandState]),this.getTree()._modelEvents.publish({event:"collapse",context:this,data:{node:this}}),this.options.onPostCollapse&&this.options.onPostCollapse.call(this),this.getTree()._modelEvents.publish({event:"postCollapse",context:this,data:{node:this}}))},_attachToView:function(e){if(this.buildSkeleton(),this.buildNode(),this.show(),this.getParent()&&!this.options.isRoot&&!this.getContent().isInjected()){var t=this.getParent().getChildren().indexOf(this);(i=this.getParent().elements.childrenContainer).children&&i.children[t]?i.insertBefore(this.getContent(),i.children[t]):i.appendChild(this.getContent())}if(this.getParent()&&this.options.isRoot){var i;t=parseInt(this.getParent().getChildren().indexOf(this),10);(i=this.getTree().elements.treeContainer).children&&i.children[t]?i.insertBefore(this.getContent(),i.children[t]):i.appendChild(this.getContent()),this.show()}this.options.isRoot&&this.show(),this.options.isRoot&&this.options.isFakeRoot&&this.hide(),this._isDrawn=!0,this._bindBehaviors()},_dettachFromView:function(){this.elements&&this.elements.container&&this.getContent()&&this.getContent().destroy(),this._isDrawn=!1},isDrawn:function(){return this._isDrawn},_bindBehaviors:function(){var e,t=this,i=this.getTree();(void 0===this.options.isDraggable&&i.options.isEditable&&(this.options.isDraggable=i.options.isEditable.nodesAreDraggable),i.options.isEditable&&(this.options.isEditable={autoExpandAtDrag:!0,autoExpandAtDragDelay:1e3},this.options.isEditable=UWA.merge(this.options.isEditable,i.options.isEditable,!0)),this.options.isDraggable)&&(this._drag=new WUXDraggable(this,this.elements.view,{dataTransfer:{type:"Text",data:"toto"},data:this,onDragStart:function(e,n){i._modelEvents.publish({context:t,event:"NODE/DRAG_START",data:t})}}),this._drop=new WUXDroppable(this,this.elements.view,{onDragEnter:function(e,t,n){i._clearAutoExpandAtDragTimeout()},onDragOver:function(n,s,o){var l=this,a=t.elements.view.getDimensions(),r=Number(a.height)/3,h=2*a.height/3,u=NAVIGATOR.ie?n.offsetY:n.layerY;u<r?(e="top",s.setStyles({boxShadow:"inset 0px 1px 0px blue"}),i._clearAutoExpandAtDragTimeout()):u>=r&&u<h?(e="middle",s.setStyles({boxShadow:"inset -1px -1px 0px blue, inset 1px 1px 0px blue"}),t.options.isEditable.autoExpandAtDrag&&!i._toAutoExpandAtDrag&&(i._toAutoExpandAtDrag=setTimeout(function(){l.expand()},t.options.isEditable.autoExpandAtDragDelay))):(e="bottom",s.setStyles({boxShadow:"inset 0px -1px 0px blue"}),i._clearAutoExpandAtDragTimeout()),i._modelEvents.publish({context:t,event:"NODE/DRAG_OVER",data:t})},onDragLeave:function(e,n){n.setStyles({boxShadow:"none"}),i._clearAutoExpandAtDragTimeout(),i._modelEvents.publish({context:t,event:"NODE/DRAG_LEAVE",data:t})},drop:function(t,n,s){if(n.setStyles({boxShadow:"none"}),i._modelEvents.publish({context:this,event:"NODE/PRE_DROP",data:s}),this!==s.from)if(i._onDropCallBack)i._onDropCallBack.call(this,s);else{var o=1,l=0;switch(s.from.getParent()===this.getParent()&&(o=s.from.getParent().getChildren().indexOf(s.from)<this.getParent().getChildren().indexOf(this)?0:1,l=s.from.getParent().getChildren().indexOf(s.from)<this.getParent().getChildren().indexOf(this)?1:0),e){case"top":this.getParent().addChild(s.from,this.getParent().getChildren().indexOf(this)-l);break;case"middle":this.addChild(s.from);break;case"bottom":this.getParent().addChild(s.from,this.getParent().getChildren().indexOf(this)+o)}}else console.warn("You dropped the node on itself");i._modelEvents.publish({context:this,event:"NODE/POST_DROP",data:s})}}))},_updateView:function(e,t){var i=this;function n(){var n;(void 0===e&&(e=!1),void 0===t&&(t=!1),e)?(i._dettachFromView(),i.getParent()&&i.getParent()._isExpanded&&i._attachToView(),DEBUG&&((n=new UWA.Fx(i.elements.label,{duration:1e3})).start({backgroundColor:["#FFF","#3F0"]}),n.start({backgroundColor:["#3F0","#FFF"]}))):(i._buildExpander(!1),i._buildLink(!0),DEBUG&&((n=new UWA.Fx(i.elements.label,{duration:1e3})).start({backgroundColor:["#FFF","#3CF"]}),n.start({backgroundColor:["#3CF","#FFF"]})));t&&(i.getChildren()&&i.getChildren().forEach(function(t){t&&t._updateView(e,!0)}))}this._updateViewTimeout&&clearTimeout(this._updateViewTimeout),this.options.renderSaver?this._updateViewTimeout=setTimeout(n,this.options.renderSaver):n()},flash:function(e){void 0===e&&(e="#F1960C");var t=new UWA.Fx(this.elements.label,{duration:1e3});t.start({backgroundColor:["#FFF",e]}),t.start({backgroundColor:[e,"#FFF"]})},dump:function(e){return this._dump(e,{icons:null,label:null})},_dump:function(e,t,i){for(var n in i||(i={}),e||(e=1),void 0===t&&(t={icons:null,label:null}),t){var s=this.options[n];s&&(i[n]=s)}var o=this.getChildren();if(o)switch(e){default:case 1:return i.children=[],o.forEach(function(t){i.children.push(t.dump(e))}),i;case 2:return UWA.Json.encode(UWA.Json.path(o,"$_children[*]"))}return i},processChildren:function(e){var t=this.getChildren();t&&t.forEach(function(t){e&&(e.call(t,t),t.processChildren(e))})},_loadModel:function(children){var expandChildren=!0,me=this;if(children)switch(UWA.typeOf(children)){case"string":expandChildren&&UWA.Ajax.request(children,{async:!0,onComplete:function(msg){me.removeChildren();var jsonObject=eval(msg);//!TODO replace with the good UWA method
me._parseTree(jsonObject,me,me._uuid,me.options.UI),expandChildren?me._showChildren():me.collapse()},onFailure:function(e){console.log("[!]\tError loading file:"+children)}});break;case"array":expandChildren&&me._showChildren()}},search:function(e){var t=this.getChildren();t&&t.forEach(function(t){var i;if(t.options.label){var n=t.options.label.toLowerCase();""!==e?-1!==n.search(e.toLowerCase())?(i=WUX.Utilities.Css.recordState(t.elements.label,["box-shadow","font-weight","text-shadow","border"]),t.elements.label.setStyles({boxShadow:"inset 0px 0px 200px 0px #ffff00,inset 0px 0px 2px 1px white",fontWeight:"bold",textShadow:"0px 1px 1px white"}),t.getParent().expand(1)):WUX.Utilities.Css.restoreState(t.elements.label,i,["box-shadow","font-weight","text-shadow"]):(WUX.Utilities.Css.restoreState(t.elements.label,i,["box-shadow","font-weight","text-shadow"]),t.expand(1))}t.search(e)})}});return UWA.namespace("WUX/Controls/TreeNodeBase",TreeNodeBase)}),define("DS/Controls/Gauge",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","DS/CoreEvents/ModelEvents","DS/Core/PointerEvents"],function(e,t,i,n,s,o){"use strict";return i.extend({defaultOptions:{snap:0,value:0,minValue:0,minDeltaValue:0,maxValue:360,stepValue:1,graduations:12,graduationsLabel:!0,dynamicGraduations:!1,dynamicGaugeColor:!0,showCursorLabel:!0,theme:{shiftCursorOnBorders:!0,fontSize:10,height:22,gaugeHeight:10,cursor:{width:16,height:16,borderRadius:"50%"},width:200,graduations:{width:1,height:24}},displayFunction:function(e){return e.toString()},onChange:null},init:function(e){e.graduations>=0&&"number"==typeof e.graduations&&e.graduations--,this._parent(e),this._modelEvents=new s,this.options.className&&(this.className=this.options.className),this._value=[],this._resolutionfactor=1,this._isRangeMode=this.options.value instanceof Array,this._realRange=this.options.maxValue-this.options.minValue,this._gaugeSize=parseInt(.75*this.options.theme.height,10),this._buildSkeleton(),this._virtualRange=this.elements.container.getDimensions().width,this._buildScaling(),this._buildCursor(0),this._buildCursor(1),this._attachBehaviors(),this.setValue(this.options.value)},_percentToRealValue:function(e){return e*this._realRange+this.options.minValue},_realValueToPercent:function(e){return(e-this.options.minValue)/this._realRange},_percentToVirtualValue:function(e){return e*this._virtualRange},_virtualToRealValue:function(e,t){void 0===t&&(t=1);var i=e/this.elements.container.getDimensions().width;return{value:this._percentToRealValue(i),percent:i}},_realToVirtualValue:function(e){var t=e/this._realRange;return{value:this._percentToVirtualValue(),percent:t}},_buildScaling:function(){var t,i,n=0,s=this.options.graduations,o=e.typeOf(s);i="array"===o?t=s.length:(t=parseInt(s,10))+1;for(var l=-parseInt(this.options.theme.fontSize+5,10),a=0;a<i;a++){var r,h;if(this.options.dynamicGraduations)h="hsl("+(180-180*a/t)+", 100%, 50%)",r=0;else h=this.options.inactiveGraduationsColor,r=1;n="array"===o?this._realToVirtualValue(s[a].value).percent:a/t;var u=new e.Element("div",{class:"wux-Gauge-scale",styles:{position:"absolute",opacity:r}}),c=new e.Element("div",{styles:{position:"relative"}}).inject(u);if(this.options.graduationsLabel){var d;d="array"===o?s[a].label:this._percentToRealValue(parseFloat(n));var p=this;new e.Element("div",{class:"wux-Gauge-scale-label","data-value":p._percentToRealValue(n),styles:{position:"absolute",top:l,fontSize:this.options.theme.fontSize,color:this.options.graduationsLabelColor},html:d.toString(),events:{click:function(t){var i=e.Event.getElement(t).getAttribute("data-value");p.setValue(i)}}}).inject(c)}var m=100*n;u.setStyles({backgroundColor:h,top:-2,left:m+"%",marginLeft:a===i-1?-1:0,width:this.options.theme.graduations.width,height:this.options.theme.graduations.height}).inject(this.elements.container)}},_buildCursor:function(t){var i=new e.Element("div",{class:"wux-Gauge-scale wux-Gauge-cursor",styles:{display:this.options.showCursorLabel?"block":"none",position:"absolute",width:this.options.theme.cursor.width,height:this.options.theme.cursor.height,marginLeft:-this.options.theme.cursor.width/2,top:(this.options.theme.height-this.options.theme.cursor.height)/2,borderRadius:this.options.theme.cursor.borderRadius}});(this._isRangeMode||0!==t)&&i.inject(this.elements.container);var n=new e.Element("div",{}).inject(i),s=new e.Element("div",{class:"wux-Gauge-scale-label",styles:{marginLeft:this.options.theme.cursor.width/2,bottom:-2},html:this._value}).inject(n);this._isRangeMode&&s.setAttribute("data-side",t?"right":"left"),this._cursors[t]=s,this._scales[t]=i},_buildSkeleton:function(){this.elements.container=e.Element("div",{class:"wux-controls-gauge "+this.className,styles:{position:"relative",marginTop:20,height:this.options.theme.height}}),this.elements.control=e.Element("div",{class:"wux-Gauge-control wux-ui-material-"+this.options.GaugeMaterial,styles:{position:"absolute",top:(this.options.theme.height-this.options.theme.gaugeHeight)/2,height:this.options.theme.gaugeHeight}}).inject(this.elements.container);this.elements.gauge=e.Element("div",{class:"wux-Gauge wux-ui-indicator-"+this.options.GaugeIndicator+" wux-ui-material-"+this.options.GaugeMaterial+" "+this.className,styles:{}}).inject(this.elements.control),this.elements.gaugeTop=e.Element("div",{class:"wux-Gauge-top"}),this.elements.gaugeBottom=e.Element("div",{class:"wux-Gauge-bottom"}),this._cursors=[],this._scales=[]},addEvent:function(e,t){return this._subscribe(e,t)},_removeEvent:function(e){return this._modelEvents.unsubscribe(e)},_removeEventListener:function(e){return this._modelEvents.unsubscribe(e)},addEventOnce:function(e,t){return this._modelEvents.subscribeOnce({event:e},t)},addEventListener:function(e,t){return this._subscribe(e,t)},_subscribe:function(e,t){return this._modelEvents.subscribe({event:e},t)},_updateGaugePercent:function(e){var t=this.elements.gauge,i={position:"absolute",left:100*e[0]+"%",right:100-100*e[1]+"%"};if(this.options.dynamicGaugeColor){var n=120-100*e[1];i.backgroundColor="hsl("+n+", 100%, 50%)"}t.setStyles(i),this._updateCursor(0,this._realValueToPercent(this._value[0]),this._value[0]),this._updateCursor(1,this._realValueToPercent(this._value[1]),this._value[1])},_updateCursor:function(e,t,i){var n=this._cursors[e],s=this._scales[e],o=this._labelWidth[e],l=this._controlWidth,a=t*l;if(this.options.theme.shiftCursorOnBorders&&l>0){var r=a+o/2;a-o/2<0?n.setStyles({marginLeft:this.options.theme.cursor.width}):r>=l?n.setStyles({marginLeft:0}):n.setStyles({marginLeft:this.options.theme.cursor.width/2})}var h=100*t;s.setStyles({left:h+"%"}),this._isRangeMode?n.setHTML(this.options.displayFunction(this._value[e].toString())):n.setHTML(this.options.displayFunction(this.getValue().toString()))},_constraintValue:function(e){var t=0,i=this.options.stepValue.toString();(i.split(".")[1]&&(t=i.split(".")[1].length),e>this.options.maxValue&&(e=this.options.maxValue),e<this.options.minValue&&(e=this.options.minValue),this._isRangeMode)&&(this._value[1]-this._value[0]<=this.options.minDeltaValue&&(0===this._selectedEdge&&(e=this._value[1]-this.options.minDeltaValue),1===this._selectedEdge&&(e=this._value[0]+this.options.minDeltaValue)));return e=(Math.round(e/this.options.stepValue)*this.options.stepValue).toFixed(t),t?Number(e).toFixed(t):parseFloat(e)},_setValue:function(e,t,i){void 0===t&&(t=!0),void 0===i&&(i=!1),this._isRangeMode?e instanceof Array?(0===this._selectedEdge&&(this._value[0]=this._constraintValue(e[0]*this._resolutionfactor)),1===this._selectedEdge&&(this._value[1]=this._constraintValue(e[1]*this._resolutionfactor)),null===this._selectedEdge&&(this._value[0]=this._constraintValue(e[0]*this._resolutionfactor),this._value[1]=this._constraintValue(e[1]*this._resolutionfactor))):console.warn("You must provide an array as value when you want to use a range gauge"):(this._value[0]=this.options.minValue,this._value[1]=this._constraintValue(e*this._resolutionfactor));var n=[this._realValueToPercent(this._value[0]),this._realValueToPercent(this._value[1])];this._updateGaugePercent(n),t&&(this.options.onChange&&this.options.onChange.call(this,this.getValue()),this._modelEvents.publish({context:this,event:"change",data:this}))},setValue:function(e,t){this._selectedEdge=null,this._setValue(e,t)},enable:function(){this.getContent().removeClassName("wux-ui-state-disabled").setStyle("pointer-events","")},disable:function(){this.getContent().addClassName("wux-ui-state-disabled").setStyle("pointer-events","none")},_attachBehaviors:function(){var t,i,n,s,l,a,r=this,h=this.elements.container,u=this.elements.gauge,c=r._cursors;function d(e){m&&(n=t.x-e.pageX-i,s=r._virtualToRealValue(-n),r._isRangeMode?a[l]=s.value:a=s.value,r._setValue(a,!0,!0))}function p(e){r._resolutionfactor=1,m=!1,r.elements.container.removeClassName("wux-ui-state-active"),document.removeEventListener(o.POINTERMOVE,d),document.removeEventListener(o.POINTERUP,p)}r._labelWidth=[],r._labelWidth[0]=c[0].getDimensions().width,r._labelWidth[1]=c[1].getDimensions().width;var m=!1;h.addEvent(o.POINTERDOWN,function(e){e.preventDefault(),r._resolutionfactor=1,r.elements.container.addClassName("wux-ui-state-active"),r._controlWidth=r.elements.control.getDimensions().width;var h=r._controlWidth,c=u.getDimensions(),g=u.getOffsets();t={y:g.y+c.height/2,x:g.x};var v=(Number(r._value[1])+Number(r._value[0]))/2;i=r._realValueToPercent(r._value[0])*h,n=t.x-e.pageX-i,s=r._virtualToRealValue(-n),l=s.value<v?0:1,r._selectedEdge=l,a=r.getValue(),r._isRangeMode?a[l]=s.value:a=s.value,r._setValue(a),m=!0,document.addEventListener(o.POINTERMOVE,d),document.addEventListener(o.POINTERUP,p)}),e.Element.addEvent.call(h,"mousewheel",function(t){e.Event.wheelDelta(t);t.shiftKey})},getValue:function(){return this._isRangeMode?this._value:parseFloat(this._value[1])}})}),define("DS/Controls/Timeline",["UWA/Core","UWA/Event","DS/Core/Core","DS/Controls/Gauge","DS/CoreEvents/Events"],function(e,t,i,n,s){"use strict";var o=n.extend({className:"wux-timeline",defaultOptions:{},init:function(e){e.beginDate&&(e.minValue=new Date(e.beginDate).valueOf()),e.endDate&&(e.maxValue=new Date(e.endDate).valueOf()),e.dateAtInit&&(e.value=new Date(e.dateAtInit).valueOf()),e.date&&(e.value=new Date(e.date).valueOf()),!e.displayFunction&&e.beginDate&&(e.displayFunction=function(e){if(e)return new Date(e).strftime("%Y-%m-%d")}),e.displayFunction||e.beginDate||(e.displayFunction=function(e){return e}),e.graduations=[];var t=this;this._isDateBased=!0,this._eventsList=[],e.eventsList&&e.eventsList.forEach(function(i){var n;i.date?(n=new Date(i.date).valueOf()-e.minValue,t._isDateBased=!0):(n=i.value-e.minValue,t._isDateBased=!1);var s={label:i.label,value:n,onEvent:i.onEvent,state:0};e.graduations.push(s)}),this._parent(e),this._isPlaying=!1},_play:function(e,t){var i=this,n=this._value[1];n=parseFloat(n,10)+parseFloat(e,10),i.setValue(n),i.elements.container.addClassName("wux-ui-state-active"),n!==i.options.minValue&&n!==i.options.maxValue&&i._isPlaying&&(this.playerTO=setTimeout(function(){i._isPlaying&&i._play.call(i,e,t)},t))},play:function(e,t){void 0===t&&(t=!0),this._isPlaying=!1,void 0===e&&(e=1);this._isPlaying=!0;window.clearTimeout(this.playerTO),this._play(e/20,50),t&&this._modelEvents.publish({event:"PLAY",context:this})},pause:function(e){void 0===e&&(e=!0),this.elements.container.removeClassName("wux-ui-state-active"),this._isPlaying=!1,e&&this._modelEvents.publish({event:"PAUSE",context:this})},stop:function(e){void 0===e&&(e=!0),this.elements.container.removeClassName("wux-ui-state-active"),this.pause(!1),this.setValue(this.options.minValue),e&&this._modelEvents.publish({event:"STOP",context:this})},onPlay:function(e){return this._modelEvents.subscribe({event:"PLAY"},e)},onPause:function(e){return this._modelEvents.subscribe({event:"PAUSE"},e)},onStop:function(e){return this._modelEvents.subscribe({event:"STOP"},e)},next:function(){},previous:function(){},setValue:function(e,t){var i=this;this._setValue(e,t),i._value[1]===i.options.maxValue&&i.pause(),i.options.graduations.forEach(function(e){var t=e.value+i.options.minValue;i._value[1]>=t&&0===e.state&&(e.state=1,e.onEvent&&e.onEvent.call(i)),i._value[1]<t&&e.state>0&&(e.state=0)})},getValue:function(){if(this._isDateBased){var e=new Date;return e.setTime(this._value[1]),e}return this._value[1]}});return e.namespace("WUX/Controls/Timeline",o)}),define("DS/Controls/Tile",["UWA/Core","UWA/Event","UWA/Controls/Abstract","UWA/Controls/Scroller","DS/Core/Core","DS/Utilities/Color","DS/Controls/Deck","DS/Core/PointerEvents"],function(e,t,i,n,s,o,l,a){"use strict";var r=i.extend({defaultOptions:{rows:2,container:window,color:!1,effects:"flip",button:!1},init:function(t){this._parent(t);var i=this;this._id=e.Utils.getUUID(),this._flagIsSecondary=!1;var n=this.options.effects.split(":");this._effect=n[0],this._effectParam=parseFloat(n[1]),n[1]&&(this._effectParamUnit=n[1].replace(/^[\-\d\.]+/,"")),this.buildSkeleton(),this._zIndex=this.elements.container.style.zIndex,this.elements.infos.addEvent(a.POINTERUP,function(e){switch(e.preventDefault(),e.stopPropagation(),i._effect){case"flip":i.rotate();break;case"push-left":i.pushLeft();break;case"push-right":i.pushRight()}})},buildSkeleton:function(){var t="white";this.options.color&&(t=o.random());Math.ceil(800+800*Math.random()),Math.ceil(200+200*Math.random());var i=this.elements,n=(this.options,"");"push-left"!=this._effect&&"push-right"!=this._effect||(n=""),"flip"==this._effect&&(n=" Back"),i.container=new e.Element("div",{id:this._id,class:"WUXTile",events:null}),i.container.setAttributes({"data-color":o.hexToHsl(t)}),i.front=new e.Element("div",{class:"Primary Tile",id:e.Utils.getUUID(),styles:{backgroundSize:"cover",background:t},events:null}),i.back=new e.Element("div",{class:"Secondary Tile"+n,html:{tag:"div",class:"Logo"},events:null}),i.infos=new e.Element("div",{class:"Infos",html:"i",events:null}),this.options.button||i.infos.hide(),i.infos.inject(i.container),i.front.inject(i.container),i.back.inject(i.container)},setPrimaryViewContent:function(e,t){this.elements.front.setHTML(e),t&&this.elements.front.setStyles(t)},setSecondaryViewContent:function(e,t){this.elements.back.setHTML(e),t&&this.elements.front.setStyles(t)},setAlternativeViewContent:function(e,t){this.elements.container.hasClassName("Flip")?(this.setPrimaryViewContent(e,t),this.displayPrimaryView()):(this.setSecondaryViewContent(e,t),this.displaySecondaryView())},toggleView:function(e,t){this.elements.container.hasClassName("Flip")?(e&&this.setPrimaryViewContent(e,t),this.displayPrimaryView()):(e&&this.setSecondaryViewContent(e,t),this.displaySecondaryView())},displayAlternativeView:function(e,t){console.warn("deprecated","Controls/Tile","method displayAlternativeView is deprecated. Please use toggleView method"),this.toggleView(e,t)},getPrimaryView:function(){return this.elements.front},getSecondaryView:function(){return this.elements.back},pushLeft:function(){this.elements.container.toggleClassName("wux-ui-state-left");var e='[id="'+this.getPrimaryView().id+'"]',t=this._effectParam;this._flagIsSecondary||(t="-"+t),this._flagIsSecondary&&"px"==this._effectParamUnit&&(t=0),t+=this._effectParamUnit,this._flagIsSecondary=!this._flagIsSecondary;new l({selector:e,container:"body",distributions:[{translate3d:function(e,i,n){return{x:t,y:0,z:0}}}],duration:200,ease:"ease-in-out"})},pushRight:function(){this.elements.container.toggleClassName("wux-ui-state-right");this.getPrimaryView().id;var e=this._effectParam;this._flagIsSecondary&&(e=0),this._flagIsSecondary&&"px"==this._effectParamUnit&&(e=0),e+=this._effectParamUnit,this._flagIsSecondary=!this._flagIsSecondary,this.elements.front.setStyles({transition:"transform ease-in-out 0.2s"}),this.elements.front.setStyles({transform:"translate3d("+e+", 0, 0)"})},displayPrimaryView:function(e,t){e&&this.setPrimaryViewContent(e,t),this.elements.container.removeClassName("Flip")},displaySecondaryView:function(e,t){e&&this.setSecondaryViewContent(e,t),this.elements.container.addClassName("Flip")},rotate:function(){this.elements.container.toggleClassName("Flip")}});return e.namespace("WUX/Controls/Tile",r)});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/Abstract",["require","exports","UWA/Core","UWA/Element","DS/Core/BaseComponent","DS/Core/WebUXComponents","DS/WebRecordEnabler/Adapter","DS/UIBehaviors/KeymapManager","DS/UIBehaviors/CommandsRegistry","DS/Utilities/TouchUtils","DS/Utilities/Dom","DS/Controls/TooltipLoader"],function(e,t,i,n,s,o,l,a,r,h,u,c){"use strict";var d=function(e,t,i){var n=document.createEvent("Event");null==i&&(i={});var s=void 0===i.bubbles||i.bubbles;return n.initEvent(t,s,!1),n.dsModel=e,n.options=i,n},p=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return n.keymaps||(n.keymaps={}),n.commands||(n.commands={}),n}return __extends(t,e),t.prototype.init=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this._disabledState=!1,this._changeDisabledStateWhileApplyingDisabled=!0,e.prototype.init.apply(this,t)},Object.defineProperty(t,"publishedProperties",{get:function(){return{domId:{defaultValue:null,type:"string",category:"Behavior"},disabled:{defaultValue:!1,type:"boolean",category:"Behavior",recordFlag:!0},visibleFlag:{defaultValue:!0,type:"boolean",category:"Behavior",recordFlag:!0},animation:{defaultValue:null,type:"object",noNeedToApplyFlag:!0,category:"Appearance"},touchMode:{defaultValue:void 0,type:"boolean",category:"Accessibility"},tooltipInfos:{defaultValue:void 0,type:"DS/Controls/TooltipModel",category:"Accessibility"},recId:{defaultValue:null,type:"string",category:"Record",uiDisplay:!1},fireOnlyFromUIInteractionFlag:{defaultValue:!1,type:"boolean",category:"Behavior",noNeedToApplyFlag:!0},noContextMenu:{defaultValue:!1,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.handleEvents=function(){},t.prototype._postBuildView=function(){},t.prototype.getPublishedPropertiesDefaultValue=function(){var e={},t=Object.getPrototypeOf(this);if(t&&t.publishedProperties)for(var i in t.publishedProperties)t.publishedProperties.hasOwnProperty(i)&&(e[i]=t.publishedProperties[i].defaultValue);return e},t.prototype.addEventListener=function(e,t,i){this.getContent().addEventListener(e,t,i)},t.prototype.removeEventListener=function(e,t,i){(this.elements.container||this.container)&&this.getContent().removeEventListener(e,t,i)},t.prototype.destroy=function(){this._keymapManager&&this._keymapManager.destroy(),u.removeAllEventsOnElement(this),e.prototype.destroy.call(this)},t.prototype._isCurrentlyCalledFromUIInteraction=function(){return u.isCurrentlyCalledFromUIInteraction()},t.prototype.fire=function(e,t){if(this.elements.container){var i=u.increaseCurrentPositionInStack(this.getContent());this.fireOnlyFromUIInteractionFlag||this.getContent().dispatchEvent(d(this,e,t)),i.inCurrentUIInteractionStack&&i.firstTimeInstanceIsCalled&&this.elements.container&&l.addCustomInteraction(this.elements.container,{type:"webUX_event",reason:"UIInteraction",event:e,eventOptions:t},void 0,!0),i.inCurrentUIInteractionStack&&this.fireOnlyFromUIInteractionFlag&&this.getContent().dispatchEvent(d(this,e,t)),i.increment&&u.decreaseCurrentPositionInStack()}},t.prototype.setPropertyFromUIInteraction=function(e,t){if((this.elements.container||this.container)&&!(this._properties&&this._properties[e]&&(Array.isArray(t)||t instanceof Date?i.equals(this._properties[e].value,t):this._properties[e].value===t))){var n=u.increaseCurrentPositionInStack(this.getContent());n.inCurrentUIInteractionStack&&n.firstTimeInstanceIsCalled&&this.elements.container&&l.addCustomInteraction(this.elements.container,{type:"webUX_property",property:e,value:t},void 0,!0),this[e]=t,n.increment&&u.decreaseCurrentPositionInStack()}},t.prototype.setReadOnlyPropertyFromUIInteraction=function(e,t){if(this.elements.container||this.container){var i="_apply"+(e.substring(0,1).toUpperCase()+e.substring(1,e.length)),n=u.increaseCurrentPositionInStack(this.getContent());for(var s in n.inCurrentUIInteractionStack&&n.firstTimeInstanceIsCalled&&this.elements.container&&l.addCustomInteraction(this.elements.container,{type:"webUX_readOnlyProperties",property:e,value:t},void 0,!0),t)t.hasOwnProperty(s)&&this._properties[e]&&(this._properties[e][s]=t[s]);this[i]&&this[i](),n.increment&&u.decreaseCurrentPositionInStack()}},t.prototype.modifyObjectFromUIInteraction=function(e,t){if(this.elements.container||this.container){var i="_apply"+(e.substring(0,1).toUpperCase()+e.substring(1,e.length)),n=u.increaseCurrentPositionInStack(this.getContent());for(var s in n.inCurrentUIInteractionStack&&n.firstTimeInstanceIsCalled&&this.elements.container&&l.addCustomInteraction(this.elements.container,{type:"webUX_subproperties",property:e,value:t},void 0,!0),t)t.hasOwnProperty(s)&&(this[e][s]=t[s]);this[i](),n.increment&&u.decreaseCurrentPositionInStack()}},t.prototype.buildView=function(){},t.prototype.modifyArrayFromUIInteraction=function(e,t){if(this.elements.container||this.container){var i=u.increaseCurrentPositionInStack(this.getContent());i.inCurrentUIInteractionStack&&i.firstTimeInstanceIsCalled&&this.elements.container&&l.addCustomInteraction(this.elements.container,{type:"webUX_property",property:e,value:this[e]},void 0,!0);var n=Array.prototype.slice.call(arguments,2);t.apply(this[e],n),i.increment&&u.decreaseCurrentPositionInStack()}},t.prototype.callMethodFromUIInteraction=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var n=Array.prototype.slice.call(arguments,1);return u.callMethodFromUIInteraction(e,this,this[e],n)},t.prototype.addKeyMapsAndCommands=function(e,t){if(e&&t){var i=this._getCommandRegistry();for(var n in t)i.registerCommand(this.name+":"+n,t[n]);var s={target:this.getContent(),jsModel:this,commandsRegistry:i};for(var o in void 0===this._keymapManager&&(this._keymapManager=new a(s)),e)if("object"==typeof e[o]){var l=e[o].keydown?this.name+":"+e[o].keydown:void 0,r=e[o].keyup?this.name+":"+e[o].keyup:void 0;this._keymapManager.registerKeymap(o,l,r)}else this._keymapManager.registerKeymap(o,this.name+":"+e[o])}},t.prototype.removeKeyMaps=function(e){for(var t=0;t<e.length;t++)delete this._keymapManager._keymap[e[t]]},t.prototype._preBuild=function(e){this._preBuildView&&this._preBuildView(e),this.keymaps&&this.commands&&this.addKeyMapsAndCommands(this.keymaps,this.commands)},t.prototype._getCommandRegistry=function(){var e=Object.getPrototypeOf(this);return e?e.hasOwnProperty("_commandRegistry")?e._commandRegistry:(e._commandRegistry=new r,e._commandRegistry):null},t.prototype._build=function(){this.buildView&&this.buildView(),void 0===this.touchMode&&this._applyTouchMode&&this._applyTouchMode()},t.prototype._postBuild=function(){this._postBuildView&&this._postBuildView(),this._handleEvents&&this._handleEvents(),this.markForRecordFlag&&this.markForRecord&&this.markForRecord(this.getContent())},t.prototype._preBuildView=function(e){this.elements.container?this.elements.container.addClassName("wux-controls-abstract"):this.elements.container=i.createElement("div",{class:"wux-controls-abstract"}),this.elements.container.dsModel=this},t.prototype._handleEvents=function(){var e=this,t=this._getElementToFocus();t&&t.addEventListener&&(u.addEventOnElement(this,t,"focus",function(t){e._onFocusReceived()},!0),u.addEventOnElement(this,t,"blur",function(t){e._resetFocus()},!0)),this.handleEvents&&this.handleEvents()},t.prototype._applyDisabled=function(e){this.elements.container&&(this.disabled?(this.getContent().setAttributeNode(document.createAttribute("disabled")),this.getContent().getAttributeNode("focused")&&this.getContent().removeAttribute("focused")):this.getContent().removeAttribute("disabled")),this._changeDisabledStateWhileApplyingDisabled&&(this._disabledState=this.disabled)},t.prototype._applyTouchMode=function(e){!0===this._getCurrentTouchMode()?this.getContent().setAttributeNode(document.createAttribute("touch-mode")):this.getContent().removeAttribute("touch-mode")},t.prototype.setDisabledFlagWithoutChangingDisabledState=function(e){this._changeDisabledStateWhileApplyingDisabled=!1,this.disabled=e,this._changeDisabledStateWhileApplyingDisabled=!0},t.prototype.focus=function(e){var t=this._getElementToFocus();t&&t.focus&&t.focus(e)},t.prototype._getDisabledState=function(){return this._disabledState},t.prototype._getCurrentTouchMode=function(){return void 0===this.touchMode?h.getTouchMode():this.touchMode},t.prototype._touchModeChange=function(e){this._applyTouchMode&&this._applyTouchMode()},t.prototype._applyDomId=function(e){if(this.domId){var t=document.createAttribute("id");t.value=this.domId,this.getContent().setAttributeNode(t)}else if(e){e===this.getContent().id&&this.getContent().removeAttribute("id")}},t.prototype._applyRecId=function(e){if(this.recId){var t=document.createAttribute("data-rec-id");t.value=this.recId,this.getContent().setAttributeNode(t),this.elements.container.getCheckpointData||(this.elements.container.getCheckpointData=function(e){var t={},i=this.dsModel;if(i&&i.publishedProperties)for(var n in i.publishedProperties){var s=i.publishedProperties[n];if(s.recordFlag)if(Array.isArray(s.recordFlag)){if(i[n]){for(var o={},l=0;l<s.recordFlag.length;l++)o[s.recordFlag[l]]=i[n][s.recordFlag[l]];t[n]=o}}else void 0!==i[n]&&(t[n]=i[n])}e(t,!1)})}else this.getContent().removeAttribute("data-rec-id"),this.elements.container.getCheckpointData=void 0},t.prototype._applyVisibleFlag=function(e){this.visibleFlag?n.prototype.constructor.show.call(this.getContent()):n.prototype.constructor.hide.call(this.getContent())},t.prototype._applyTooltipInfos=function(){this.tooltipInfos&&(this.tooltipInfos.owner=this)},t.prototype._applyProperties=function(e){this.isDirty("disabled")&&this._applyDisabled(e?e.disabled:void 0),!this.isDirty("visibleFlag")||e&&void 0===e.visibleFlag||this._applyVisibleFlag(e?e.visibleFlag:void 0),this.isDirty("touchMode")&&this._applyTouchMode(e?e.touchMode:void 0),this.isDirty("recId")&&this._applyRecId(e?e.recId:void 0),this.isDirty("domId")&&this._applyDomId(e?e.domId:void 0)},t.prototype._getElementToFocus=function(){return this.getContent()},t.prototype._onFocusReceived=function(){this._isFocused()||this.elements.container&&this.getContent().setAttributeNode(document.createAttribute("focused"))},t.prototype._giveFocus=function(){this.elements.container&&this.getContent().setAttributeNode(document.createAttribute("focused"))},t.prototype._resetFocus=function(){this.elements.container&&this.getContent().removeAttribute("focused")},t.prototype._isFocused=function(){return!!this.elements.container&&this.elements.container.hasAttribute("focused")},t.prototype.show=function(t){t=t||!0;var i=this.animation;var n=e.prototype.show.call(this,t);return!0===t&&i&&i.show&&(this.getContent().addClassName("wux-ui-animation-"+i.show+"-in"),this.getContent().addEventListener("animationend",function e(t){t.target.removeEventListener("animationend",e),t.target.removeClassName("wux-ui-animation-"+i.show+"-in")})),this.visibleFlag=!0,n},t.prototype.hide=function(e){e=e||!0;var t=this.animation,i=this;!0===e&&t&&t.hide?(this.getContent().addClassName("wux-ui-animation-"+t.hide+"-out"),this.getContent().addEventListener("animationend",function e(n){i.applyVisibleFlag=!1,n.target.removeEventListener("animationend",e),n.target.removeClassName("wux-ui-animation-"+t.hide+"-out")})):this.visibleFlag=!1},t.prototype._getCustomContent=function(){return[]},t}(s);return p.prototype.blackBoxFlag=!1,o.addClass(p,"abstract"),c.initTooltipFrame(),p}),define("DS/Controls/Breadcrumb",["UWA/Core","DS/Controls/Abstract","DS/Handlebars/Handlebars","DS/Utilities/Dom","DS/Menu/ContextualMenu","DS/Menu/Menu","DS/Core/PointerEvents"],function(e,t,i,n,s,o,l){"use strict";const a={task:i.compile("{{#unless isExpandableSeparator}}                           {{#if isLiteStyle}}                             <div class='wux-controls-breadcrumb-item-separator'>\\</div>                           {{/if}}                         {{/unless}}                         {{#if isIconVisible}}                           <div class='wux-controls-breadcrumb-item-icon'>{{&icon}}</div>                         {{/if}}                         {{#if isLabelVisible}}                           <div class='wux-controls-breadcrumb-item-label'>{{label}}</div>                         {{/if}}                         {{#if isExpandableSeparator}}                           <div class='wux-controls-breadcrumb-item-separator wux-ui-3ds wux-ui-3ds-chevron-right wux-ui-3ds-lg'></div>                         {{/if}}")},r=function(e,t,i){if(e&&e.elements&&e.elements.container)if(t)if(e.elements.container.setAttributeNode(document.createAttribute("is-hovered")),this.displayStyle===E.DISPLAY_STYLE.IMMERSIVE)e.elements.icon&&e.elements.icon.setAttributeNode(document.createAttribute("is-hovered")),e.elements.label&&e.elements.label.setAttributeNode(document.createAttribute("is-hovered")),e.elements.separator&&e.elements.separator.setAttributeNode(document.createAttribute("is-hovered"));else switch(i){case 2:if(e.elements.separator&&e.elements.separator.setAttributeNode(document.createAttribute("is-hovered")),!this.expandableSeparatorFlag)break;case 1:e.elements.icon&&e.elements.icon.setAttributeNode(document.createAttribute("is-hovered")),e.elements.label&&e.elements.label.setAttributeNode(document.createAttribute("is-hovered"))}else e.elements.container.removeAttribute("is-hovered"),e.elements.icon&&e.elements.icon.removeAttribute("is-hovered"),e.elements.label&&e.elements.label.removeAttribute("is-hovered"),e.elements.separator&&e.elements.separator.removeAttribute("is-hovered")},h=function(){for(;this.elements.container.firstChild;)this.elements.container.removeChild(this.elements.container.firstChild);if(this.responsiveMenuMainContent&&(this.responsiveMenuMainContent.removeEventListener(l.POINTERHIT,u.bind(this)),this.responsiveMenuMainContent.destroy,this.responsiveMenuMainContent=null),this.lastHiddenItemExpandableSeparator&&(this.lastHiddenItemExpandableSeparator.removeEventListener(l.POINTERHIT,c.bind(this)),this.lastHiddenItemExpandableSeparator.destroy,this.lastHiddenItemExpandableSeparator=null),this.displayStyle===E.DISPLAY_STYLE.LITE){let e;!0!==this.__customOverflowManagement__&&(e={iconName:"menu",fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"1x"},this.responsiveMenuMainContent=n.generateIcon(e),this.responsiveMenuMainContent.addClassName("wux-controls-breadcrumb-responsive-menu"),this.elements.container.appendChild(this.responsiveMenuMainContent),this.responsiveMenuMainContent.addEventListener(l.POINTERHIT,u.bind(this))),!0===this.expandableSeparatorFlag&&(e={iconName:"chevron-right",fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"1x"},this.lastHiddenItemExpandableSeparator=n.generateIcon(e),this.lastHiddenItemExpandableSeparator.addClassName("wux-controls-breadcrumb-last-hidden-item-separator"),this.elements.container.appendChild(this.lastHiddenItemExpandableSeparator),this.lastHiddenItemExpandableSeparator.addEventListener(l.POINTERHIT,c.bind(this))),C.call(this)}const e=function(e){!0===e&&(this._listItems=[]);let t,i=(!this._listItems||0===this._listItems.length)&&0!==this.value.length,n=void 0;for(t=0;t<this.value.length;t++){if(!i&&!(i=t>=this._listItems.length)){const e=p(this._listItems[t],this.value[t]);if(-1===e&&d.call(this,this._listItems[t],this.value[t]),i=1===e)for(let e=this._listItems.length-1;e>=t;e--)this.elements.container.removeChild(this._listItems[e].elements.container),this._listItems.pop()}if(i){void 0===n&&(n=t);const e=m.call(this,this.value[t],t);this._listItems.push(e),this.elements.container.appendChild(e.elements.container),C.call(this)}}if(!i)for(let e=this._listItems.length-1;e>=t;e--)this.elements.container.removeChild(this._listItems[e].elements.container),this._listItems.pop();return n}.call(this,!0);f.call(this,e),w.call(this,this.elements.container.clientWidth)},u=function(e){const t=this;this.responsiveMenuModel=[];for(const e of this._hiddenItems){let i=e.selected?o.MENU_STATE_SELECTED:o.MENU_STATE_NONE;const n=e=>{if(t.disabled)return;const i=o.getMenuItemUidFromNode(e.info.target);let n,s;if(i>=0&&(n=o.getMenuDescriptionFromUid(i)),n){const e=t._hiddenItems.filter(e=>e.label===n.title);e.length>0&&(s=e[0])}if(s)if("function"==typeof t.onContextualEvent){const i=t.onContextualEvent.call(t,{infos:e.info,data:e.data,indexFound:s.index});if(!t.customContextMenuFlag)return i}else!0===t.expandableSeparatorFlag&&(t.onSeparatorClickEvent?t.onSeparatorClickEvent.call(t,{index:s.index}):t.fire("separatorClick",{index:s.index}))},s={type:"CheckItem",title:e.label,icon:e.icon,state:o.translateStateBitFieldToString(i),action:{callback:()=>{const i=t.responsiveMenuModel,n=e.label;let s=-1;for(let e=0;e<i.length;e++)if(i[e].title===n){s=e;break}const l=[];if(t.mode===E.MODE.MULTIPLE_SELECTION){const e=o.getItemState(i[s]);let t=e&o.MENU_STATE_DISABLED;e&o.MENU_STATE_SELECTED||(t|=o.MENU_STATE_SELECTED),o.setItemState(i[s],t),l.push(i[s])}else if(t.mode===E.MODE.EXCLUSIVE_SELECTION||t.mode===E.MODE.NAVIGATION){for(const e of i){const t=o.getItemState(e)&o.MENU_STATE_DISABLED;o.setItemState(e,t)}let e=o.getItemState(i[s])&o.MENU_STATE_DISABLED;e|=o.MENU_STATE_SELECTED,o.setItemState(i[s],e),l.push(...i)}o.updateModel(l);const a=[];for(let e=0;e<i.length;e++){o.getItemState(i[e])&o.MENU_STATE_SELECTED&&a.push(e)}const r=t._hiddenItems.map(e=>e.label);let h=t.selectedValues.filter(e=>"string"==typeof e?!r.includes(e):!r.includes(e.label));for(let e=0;e<t._hiddenItems.length;e++){const i=t._hiddenItems[e];t.mode===E.MODE.MULTIPLE_SELECTION?(a.includes(e)?(h.push(t.value[i.index]),i.selected=!0):i.selected=!1,i.elements.container.setAttribute("is-selected",i.selected)):t.mode!==E.MODE.EXCLUSIVE_SELECTION&&t.mode!==E.MODE.NAVIGATION||1===a.length&&a[0]===e&&h[0]!==t.value[i.index]&&(h=[t.value[i.index]])}t.selectedValues=[...h]}},submenu:"function"==typeof t.onContextualEvent||!0===t.expandableSeparatorFlag?n:void 0};this.responsiveMenuModel.push(s)}const i=this.responsiveMenuMainContent.getBoundingClientRect();o.show(this.responsiveMenuModel,{doNotHideOnAction:t.mode===E.MODE.MULTIPLE_SELECTION,position:{x:i.left,y:i.top+i.height}})},c=function(e){const t=this._hiddenItems.length>0?this._hiddenItems[this._hiddenItems.length-1]:null;t&&(this.onSeparatorClickEvent?this.onSeparatorClickEvent.call(this,{index:t.index}):this.fire("separatorClick",{index:t.index}))},d=function(e,t){e.value="string"==typeof t?t:t.value},p=(e,t)=>{const i={label:"",icon:void 0,value:""};return"string"==typeof t?(i.label=t||"",i.value=i.label):(i.label=t.label?t.label:"",i.icon=t.icon,i.value=t.value?t.value:i.label),e.icon!==i.icon||e.label!==i.label?1:e.value===i.value?0:-1},m=function(e,t){const i={label:"",index:t,selected:!1,elements:{}};return"string"==typeof e?(i.label=e,i.value=e):(i.label=e.label?e.label:"",i.icon=e.icon,i.value=e.value?e.value:i.label),g.call(this,i),v.call(this,i),i},g=function(t){t.elements.container=e.createElement("span",{class:"wux-controls-breadcrumb-item"}),t.elements.container.setAttribute("index",t.index),t.elements.container.setAttribute("is-selected",!1);const i=t.label&&this.displayLabels!==E.DISPLAY_ELEMENT.NONE,s=t.icon&&this.displayIcons!==E.DISPLAY_ELEMENT.NONE;let o;if(s){const i=e.createElement("div"),s=n.generateIcon(t.icon);i.setContent(s),o=i.innerHTML,i.destroy()}t.elements.container.setContent(a.task({label:t.label,isLabelVisible:i,icon:o,isIconVisible:s,isExpandableSeparator:this.expandableSeparatorFlag,isLiteStyle:this.displayStyle===E.DISPLAY_STYLE.LITE})),t.elements.label=i?t.elements.container.getElementsByClassName("wux-controls-breadcrumb-item-label")[0]:void 0,t.elements.icon=s?t.elements.container.getElementsByClassName("wux-controls-breadcrumb-item-icon")[0]:void 0,t.elements.separator=t.elements.container.getElementsByClassName("wux-controls-breadcrumb-item-separator")[0]},v=function(e){const t=this,i=()=>{t.selectedValues;if(!t.disabled)if(t.mode===E.MODE.MULTIPLE_SELECTION){if(e.selected){for(let i=0;i<t.selectedValues.length;i++)if(0===p(e,t.selectedValues[i])){t.selectedValues.splice(i,1);break}e.selected=!1,e.elements.container.setAttribute("is-selected",!1)}else t.selectedValues.push(t.value[e.index]),e.selected=!0,e.elements.container.setAttribute("is-selected",!0);t.fire("selectionChange")}else if(t.mode===E.MODE.EXCLUSIVE_SELECTION)e.selected||(t.selectedValues=[t.value[e.index]]);else if(t.mode===E.MODE.NAVIGATION){const i=t.value.length-1-e.index;y.call(t,i),w.call(t,t.elements.container.clientWidth)}};this.displayStyle===E.DISPLAY_STYLE.IMMERSIVE?n.addEventOnElement(e,e.elements.container,"click",i):(e.elements.label&&n.addEventOnElement(e,e.elements.label,"click",i),e.elements.icon&&n.addEventOnElement(e,e.elements.icon,"click",i)),this.expandableSeparatorFlag&&n.addEventOnElement(e,e.elements.separator,"click",i=>{i.stopPropagation(),t.disabled||(t.onSeparatorClickEvent?t.onSeparatorClickEvent.call(t,{index:e.index}):t.fire("separatorClick",{index:e.index}))})},f=function(t){let i;if(i=void 0!==t?t:this.value.length,this.mode===E.MODE.MULTIPLE_SELECTION)for(let t=0;t<this.selectedValues.length;t++){const n=this.selectedValues[t];let s=!1;for(let t=0;t<i&&!(s=e.equals(this.value[t],n));t++);if(!s)return void this._applySelectedValues()}else if(this.mode===E.MODE.EXCLUSIVE_SELECTION){if(this.selectedValues.length>1)return void this._applySelectedValues();let t=!1;for(let n=0;n<i&&!(t=e.equals(this.value[n],this.selectedValues[0]));n++);t||this._applySelectedValues()}else this.mode===E.MODE.NAVIGATION&&(this.value.length>0?e.equals(this.value[this.value.length-1],this.selectedValues[0])?this._applySelectedValues():this.selectedValues=[this.value[this.value.length-1]]:this.selectedValues=[])},y=function(e){if(e<=0)return;const t=this._listItems.length-1;for(let i=0;i<e;i++){const e=this._listItems[(t-i).toString()].elements.container;this.elements.container.removeChild(e),this._listItems.pop()}this.value.splice(t-e+1,e),f.call(this),this.fire("change")},b=function(e){let t=-1,i=-1;for(;e&&-1===t&&!n.hasClass(e,"wux-controls-breadcrumb");)n.hasClass(e,"wux-controls-breadcrumb-item-separator")?(t=e.parentNode.getAttribute("index"),i=2):n.hasClass(e,"wux-controls-breadcrumb-item-label")||n.hasClass(e,"wux-controls-breadcrumb-item-icon")?(t=e.parentNode.getAttribute("index"),i=1):n.hasClass(e,"wux-controls-breadcrumb-item")&&(t=e.getAttribute("index"),i=0),e=e.parentNode;return{indexFound:t,itemFound:i}},_=function(e,t){if(e)for(let e=0;e<this._listItems.length;e++){const i=this._listItems[e];i.elements.container.setAttributeNode(document.createAttribute(t)),i.elements.label&&i.elements.label.setAttributeNode(document.createAttribute(t)),i.elements.icon&&i.elements.icon.setAttributeNode(document.createAttribute(t)),i.elements.separator&&i.elements.separator.setAttributeNode(document.createAttribute(t))}else for(let e=0;e<this._listItems.length;e++){const i=this._listItems[e];i.elements.container.removeAttribute(t),i.elements.label&&i.elements.label.removeAttribute(t),i.elements.icon&&i.elements.icon.removeAttribute(t),i.elements.separator&&i.elements.separator.removeAttribute(t)}},C=function(e){if(this.displayStyle===E.DISPLAY_STYLE.LITE){null!=e&&e!==[]||(e=this._listItems);let t=!1;for(const i of e)(t=i.elements.container.hasAttribute("hidden"))&&i.elements.container.removeAttribute("hidden"),i.width=i.elements.container.clientWidth,t&&i.elements.container.setAttribute("hidden","")}},w=function(e){if(this.displayStyle===E.DISPLAY_STYLE.LITE){const t=[];!0!==this.__customOverflowManagement__&&this.responsiveMenuMainContent.hide(),!0===this.expandableSeparatorFlag&&this.lastHiddenItemExpandableSeparator.hide(),this._hiddenItems=[];let i,n=0,s=!1,o=-1;for(i=this._listItems.length-1;i>=0;i--)this._listItems[i].elements.container.setAttribute("hidden",""),!0===s?t.push(this._listItems[i]):n+this._listItems[i].width>e?(s=!0,o=i,t.push(this._listItems[i])):(n+=this._listItems[i].width,this._listItems[i].elements.container.removeAttribute("hidden"));if(!0===s){let i=0;!0!==this.__customOverflowManagement__&&(this.responsiveMenuMainContent.show(),i=this.responsiveMenuMainContent.clientWidth+16);let s=0;!0===this.expandableSeparatorFlag&&(this.lastHiddenItemExpandableSeparator.show(),s=this.lastHiddenItemExpandableSeparator.clientWidth),i+s+n>e&&++o<this._listItems.length&&(this._listItems[o].elements.container.setAttribute("hidden",""),t.unshift(this._listItems[o]))}this._hiddenItems=t.reverse()}},x=function(e){if(!(e&&e.length&&e[0]&&e[0].target&&e[0].target.clientWidth))return;const t=e[0].target.clientWidth;t&&w.call(this,t)},E=t.inherit({name:"breadcrumb",publishedProperties:{value:{defaultValue:[],type:"array",category:"Behavior"},selectedValues:{defaultValue:[],type:"array",category:"Helper"},mode:{defaultValue:0,type:"enum",category:"Behavior"},expandableSeparatorFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},displayStyle:{defaultValue:0,type:"enum",category:"Appearance"},displayIcons:{defaultValue:1,type:"enum",category:"Appearance"},displayLabels:{defaultValue:1,type:"enum",category:"Appearance"},onContextualEvent:{defaultValue:null,type:"function",noNeedToApplyFlag:!0},customContextMenuFlag:{defaultValue:!1,type:"boolean",category:"Behavior",noNeedToApplyFlag:!0},onSeparatorClickEvent:{defaultValue:null,type:"function",noNeedToApplyFlag:!0}},_preBuildView:function(){this._parent(),this.elements.container.addClassName("wux-controls-breadcrumb"),this._listItems=[]},_postBuildView:function(){C.call(this),w.call(this,this.elements.container.clientWidth)},handleEvents:function(){const e=this;let t=-1;this.displayStyle===E.DISPLAY_STYLE.LITE&&n.addResizeObserver(this,this.elements.container,x),n.addEventOnElement(this,this.elements.container,"mouseover",i=>{if(e.disabled)return;const n=b.call(e,i.target),s=n.indexFound,o=n.itemFound;if(t>-1&&t<e._listItems.length){const i=e._listItems[t];r.call(e,i,!1)}if(s>-1){const t=e._listItems[s];r.call(e,t,!0,o)}t!==s&&e.fire("preSelection",{oldItem:Number(t),newItem:Number(s)}),t=s}),n.addEventOnElement(this,this.elements.container,"mouseleave",()=>{if(t>-1&&t<e._listItems.length){const i=e._listItems[t];r.call(e,i,!1)}e.fire("preSelection",{oldItem:Number(t),newItem:Number(-1)}),t=-1}),this._ctxMenuToken=s.addEventListener(this.elements.container,{callback:e=>{if(!this.disabled&&"function"==typeof this.onContextualEvent){let t=void 0,i=-1;const n=b.call(this,e.data.target);if(n.indexFound<this._listItems.length&&n.indexFound>-1&&(t=this._listItems[n.indexFound]),t&&(i=n.indexFound),-1!==i){const t=this.onContextualEvent.call(this,{infos:e.info,data:e.data,indexFound:i});if(!this.customContextMenuFlag)return t}}}}),n.onNodeRendered(this.elements.container,()=>{C.call(e)})},pop:function(){if(this._listItems.length<=0)return;const e=this.value[this.value.length-1];return y.call(this,1),w.call(this,this.elements.container.clientWidth),e},push:function(e){this.value.push(e);const t=m.call(this,e,this.value.length-1);this._listItems.push(t),this.elements.container.appendChild(t.elements.container),C.call(this),w.call(this,this.elements.container.clientWidth),f.call(this),this.fire("change")},_applyValue:function(e){h.call(this),function(e,t){if(!e&&t)return!0;if(e&&!t)return!0;if(e&&t){if(e.length!==t.length)return!0;for(let i=0;i<t.length;i++){const n={};"string"==typeof t[i]?(n.label=t[i],n.value=t[i]):(n.label=t[i].label?t[i].label:"",n.icon=t[i].icon,n.value=t[i].value?t[i].value:n.label);const s={};if("string"==typeof e[i]?(s.label=e[i],s.value=e[i]):(s.label=e[i].label?e[i].label:"",s.icon=e[i].icon,s.value=e[i].value?e[i].value:s.label),p(s,n)>0)return!0}}return!1}(e,this.value)&&this.fire("change")},_applySelectedValues:function(t){if(this.mode===E.MODE.MULTIPLE_SELECTION)for(let t=0;t<this.selectedValues.length;){const i=this.selectedValues[t];let n=!1;for(let t=0;t<this.value.length&&!(n=e.equals(this.value[t],i));t++);n?t++:this.selectedValues.splice(t,1)}else if(this.mode===E.MODE.EXCLUSIVE_SELECTION){this.selectedValues.splice(1,this.selectedValues.length-1);let t=!1;for(let i=0;i<this.value.length&&!(t=e.equals(this.value[i],this.selectedValues[0]));i++);t||(this._properties.selectedValues.value=[])}else if(this.mode===E.MODE.NAVIGATION){let i;for(i=this.value.length-1;i>=0;i--)if(e.equals(this.value[i],this.selectedValues[0])){if(this.value.length-1-i>0)return y.call(this,this.value.length-1-i),void w.call(this,this.elements.container.clientWidth);break}if(i<0&&this.value.length>0)return void(this.selectedValues=t)}(function(){const t=[];if(this.mode===E.MODE.MULTIPLE_SELECTION||this.mode===E.MODE.EXCLUSIVE_SELECTION)for(let i=0;i<this.selectedValues.length;i++){const n=this.selectedValues[i];let s=!1;for(let i=0;i<this.value.length;i++)if(s=e.equals(this.value[i],n)){t.push(i);break}s||console.error("UpdateSelectedItems should not be call with wrong values.")}else this.mode===E.MODE.NAVIGATION&&t.push(this.value.length-1);for(let e=0;e<this._listItems.length;e++)-1!==t.indexOf(e)?(this._listItems[e].selected=!0,this._listItems[e].elements.container.setAttribute("is-selected",!0)):(this._listItems[e].selected=!1,this._listItems[e].elements.container.setAttribute("is-selected",!1))}).call(this),this.fire("selectionChange")},_applyMode:function(e){f.call(this)},_applyExpandableSeparatorFlag:function(e){this.expandableSeparatorFlag?this.getContent().setAttributeNode(document.createAttribute("expandable-separator")):this.getContent().removeAttribute("expandable-separator"),h.call(this)},_applyDisplayStyle:function(e){this.getContent().setAttribute("display-style",this.displayStyle),h.call(this)},_applyDisplayIcons:function(e){this.getContent().setAttribute("display-icons",this.displayIcons),e!==E.DISPLAY_ELEMENT.NONE&&this.displayIcons!==E.DISPLAY_ELEMENT.NONE||h.call(this)},_applyDisplayLabels:function(e){this.getContent().setAttribute("display-labels",this.displayLabels),e!==E.DISPLAY_ELEMENT.NONE&&this.displayLabels!==E.DISPLAY_ELEMENT.NONE||h.call(this)},_applyDisabled:function(){this._parent(),_.call(this,this.disabled,"disabled")},_applyTouchMode:function(){this._parent(),_.call(this,this.touchMode,"touch-mode"),this.displayStyle===E.DISPLAY_STYLE.LITE&&C.call(this)},_applyProperties:function(e){this._parent(e),this.isDirty("value")?this._applyValue(e.value):this.isDirty("selectedValues")&&this._applySelectedValues(e.selectedValues),this.isDirty("expandableSeparatorFlag")&&this._applyExpandableSeparatorFlag(e.expandableSeparatorFlag),this.isDirty("mode")&&this._applyDisplayStyle(e.mode),this.isDirty("displayStyle")&&this._applyDisplayStyle(e.displayStyle),this.isDirty("displayLabels")&&this._applyDisplayLabels(e.displayLabels),this.isDirty("displayIcons")&&this._applyDisplayIcons(e.displayIcons),this.isDirty("touchMode")&&this._applyTouchMode(e.touchMode)},destroy:function(){this.displayStyle===E.DISPLAY_STYLE.LITE&&n.removeResizeObserver(this,this.elements.container,x),this.responsiveMenuMainContent&&(n.removeEventOnElement(this,this.responsiveMenuMainContent,l.POINTERHIT,u),this.responsiveMenuMainContent=null),this.lastHiddenItemExpandableSeparator&&(n.removeEventOnElement(this,this.lastHiddenItemExpandableSeparator,l.POINTERHIT,c),this.lastHiddenItemExpandableSeparator=null),this._ctxMenuToken&&s.removeEventListener(this.elements.container,this._ctxMenuToken),this._parent()}});return E.MODE={NAVIGATION:0,MULTIPLE_SELECTION:1,EXCLUSIVE_SELECTION:2},E.DISPLAY_STYLE={LITE:0,IMMERSIVE:1},E.DISPLAY_ELEMENT={NONE:0,ALL:1,SELECTED:2,HOVERED:3,HOVERED_OR_SELECTED:4},E});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/GroupBox",["require","exports","DS/Controls/Abstract","UWA/Core","DS/Core/WebUXComponents","DS/Utilities/Dom","DS/Utilities/WUXUWAUtils"],function(e,t,i,n,s,o,l){"use strict";var a=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return l.extendingClassFlag,n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{label:{defaultValue:"",type:"string",category:"Appearance",advancedSetter:!0},icon:{defaultValue:"",type:"object",category:"Appearance",advancedSetter:!0},iconDimension:{defaultValue:"16px",type:"string",category:"Appearance",advancedSetter:!0}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){this.elements.container.addClassName("wux-controls-groupbox"),this.elements.content=document.createElement("fieldset"),this._legendElement=document.createElement("legend"),this._titleElement=document.createElement("span"),this._iconElement=document.createElement("div"),this.elements.container.appendChild(this.elements.content),this.elements.content.appendChild(this._legendElement),this._legendElement.appendChild(this._iconElement),this._legendElement.appendChild(this._titleElement)},t.prototype.appendChild=function(e){var t=new n.Element("div",{styles:{width:"inherit"},html:e});return this.elements.content.appendChild(e),t},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("label")&&this._applyLabel(t.label,this.label),this.isDirty("icon")&&this._applyIcon(t.value,this.icon),this.isDirty("iconDimension")&&this._applyIconDimension(t.value,this.icon)},t.prototype._applyLabel=function(e,t){this._titleElement.innerText=t},t.prototype._applyIcon=function(e,t){o.generateIcon(t,{target:this._iconElement})?this._iconElement.classList.remove("hidden"):this._iconElement.classList.add("hidden"),this.fire("change")},t.prototype._applyIconDimension=function(e,t){this._iconElement&&(this._iconElement.style.width=t+"px",this._iconElement.style.height=t+"px",this._iconElement.style["font-size"]=t+"px")},t}(i);return s.addClass(a,"groupBox"),a}),define("DS/Controls/TooltipModel",["DS/Core/BaseComponent","DS/WebappsUtils/WebappsUtils","DS/Controls/TooltipLoader"],function(e,t,i){"use strict";var n={SINGLELINE:0,MULTILINE:1};Object.freeze(n);var s=e.inherit({name:"TooltipModel",publishedProperties:{owner:{defaultValue:void 0,type:"object"},title:{defaultValue:"",type:"string"},shortHelp:{defaultValue:"",type:"string"},longHelp:{defaultValue:"",type:"string"},shortHelpImage:{defaultValue:"",type:"string"},longHelpImage:{defaultValue:"",type:"string"},shortHelpImageDimension:{defaultValue:null,type:"vector2"},longHelpImageDimension:{defaultValue:null,type:"vector2"},initialDelay:{defaultValue:1e3,type:"integer"},shortToLongDelay:{defaultValue:2e3,type:"integer"},reshowDelay:{defaultValue:1e3,type:"integer"},mouseRelativePosition:{defaultValue:!0,type:"boolean"},position:{defaultValue:"bottom",type:"string"},wrapPolicy:{defaultValue:n.MULTILINE,type:"integer"},wrapThreshold:{defaultValue:270,type:"integer"},allowUnsafeHTMLTitle:{defaultValue:void 0,type:"boolean"},allowUnsafeHTMLShortHelp:{defaultValue:void 0,type:"boolean"},allowUnsafeHTMLLongHelp:{defaultValue:void 0,type:"boolean"},moreHelpCB:{defaultValue:void 0,type:"function"},getAllInformationCB:{defaultValue:void 0,type:"function"}},_preBuild:function(e){e||(e={}),e.shortHelpImageDimension||(e.shortHelpImageDimension={x:150,y:75},this._properties.shortHelpImageDimension.value=e.shortHelpImageDimension),e.longHelpImageDimension||(e.longHelpImageDimension={x:150,y:75},this._properties.longHelpImageDimension.value=e.longHelpImageDimension),this._parent(e)},_applyProperties:function(e){this._parent(e),this.isDirty("moreHelpCB")&&this._applyMoreHelpCB(e.moreHelpCB,this._properties.moreHelpCB.value)},_applyMoreHelpCB:function(e,t){t!==e&&(this._reachableState=Boolean(t instanceof Function))},isEmpty:function(){return""===this.longHelp&&""===this.shortHelp&&""===this.title},loadFromHelpRscFile:function(e,i){if(e){var n=e.split("/"),s="i18n!"+n[0],o=n.splice(0,1);s+="/assets/help/"+n.join("/");var l=this,a=i;require([s,"DS/WebUAUtils/WebUAUtils"],function(e,i){l.title=e[a+".Title"],[{name:"ShortHelp",type:"String"},{name:"LongHelp",type:"String"},{name:"ShortHelpImage",type:"Image"},{name:"LongHelpImage",type:"Image"},{name:"ShortHelpImageWidth",type:"Width"},{name:"ShortHelpImageHeight",type:"Height"},{name:"LongHelpImageWidth",type:"Width"},{name:"LongHelpImageHeight",type:"Height"}].forEach(function(i){e[a+"."+i.name]&&("Image"===i.type?l[i.name.camelCase()]=function(e,i){return t.getWebappsBaseUrl()+e+"/assets/graphic/"+i}(o,e[a+"."+i.name]):"Width"===i.type||"Height"===i.type?l[i.name.replace(i.type,"Dimension").camelCase()]["Width"===i.type?"x":"y"]=parseInt(e[a+"."+i.name]):l[i.name.camelCase()]=e[a+"."+i.name])});var n={};n.helpid=a,n.content=e;var s=i.getMoreHelpCallback(n);void 0!==s&&(l.moreHelpCB=s),l._isLoadedFromHelpRscFile=!0})}},setAllPropertiesFromAllInformationCB:function(){if(this.getAllInformationCB&&this.getAllInformationCB instanceof Function){var e=this.getAllInformationCB.call();if(e)if(e.updateModel)for(var t in e.model)"owner"!==t&&"getAllInformationCB"!==t&&(this[t]=e.model[t]);else{for(var t in this.publishedProperties)"owner"!==t&&"getAllInformationCB"!==t&&(this[t]=void 0!==e.model[t]?e.model[t]:this.publishedProperties[t].defaultValue);this._preBuild()}}}});return s.WrapPolicy=n,i.initTooltipFrame(),s});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/ColorPalette",["require","exports","UWA/Core","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Color","DS/Utilities/Dom","DS/Controls/TooltipModel","DS/Core/WebUXComponents","DS/Utilities/WUXUWAUtils"],function(e,t,i,n,s,o,l,a,r,h){"use strict";function u(e,t){var i=void 0;if(t){var n=0;for(n=0;n<t.length;n++)if(t[n]&&o.compareColorStrings(t[n].value,e)){i=t[n];break}}return i}function c(e,t){var i=t?o.UNSET_COLOR_TEXTURE_URL_TOUCH:o.UNSET_COLOR_TEXTURE_URL_MOUSE,n="url("+i+")";e&&(e=o.getValidCssColor(e),i=t?o.TRANSPARENCY_TEXTURE_URL_TOUCH:o.TRANSPARENCY_TEXTURE_URL_MOUSE,n="linear-gradient("+o.setAlphaToColorString(e,1)+", "+e+"), url("+i+")");return n}var d=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return h.extendingClassFlag?n:(n.addKeyMapsAndCommands({up:{keydown:"selectPrevious",keyup:"preventDefault"},down:{keydown:"selectNext",keyup:"preventDefault"},left:{keydown:"selectPrevious",keyup:"preventDefault"},right:{keydown:"selectNext",keyup:"preventDefault"}},{selectNext:function(){var e=u(this.value,this._swatchList),t=this._swatchList.indexOf(e);return t>=0&&++t>=this._swatchList.length&&(t=0),this.value=this._swatchList[t].value,{preventDefault:!0,stopPropagation:!1}},selectPrevious:function(){var e=u(this.value,this._swatchList),t=this._swatchList.indexOf(e);return t>=0&&--t<0&&(t=this._swatchList.length-1),this.value=this._swatchList[t].value,{preventDefault:!0,stopPropagation:!1}},preventDefault:function(){return{preventDefault:!0,stopPropagation:!0}}}),n)}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:"",type:"string",category:"Behavior",advancedSetter:!0},swatches:{defaultValue:[],type:"array",category:"Behavior"},noContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){this.elements.container.addClassName("wux-controls-colorpalette"),this.elements.container.setAttribute("tabindex","0"),this._swatchList=[],this._bindedOnPointerHit=function(e){1===e.multipleHitCount&&(this.value=e.currentTarget._value)}.bind(this),this._bindedAddSwatch=function(e){if(e){var t=c(e.value,this._getCurrentTouchMode()),n=i.createElement("div",{class:"wux-controls-colorpalette-swatch",styles:{background:t}});n._value=e.value;var o=e.tooltipParams?e.tooltipParams:{shortHelp:e.value?e.value:"undefined color"};n.tooltipInfos=new a(o),this.elements.container.appendChild(n),l.addEventOnElement(this,n,s.POINTERHIT,this._bindedOnPointerHit);var r={value:e.value,swatch:n};this._swatchList.push(r)}}.bind(this),this._bindedAddSwatches=function(e){for(var t={},i=0;i<this.swatches.length;i++){this.swatches[i].value||(this.swatches[i].value=void 0);var n=this.swatches[i].value?this.swatches[i].value.toUpperCase():void 0;t[n]||n&&!o.isValidColorString(n)?this.swatches.splice(i,1):t[n]=this.swatches[i].value?this.swatches[i].value:"undefined",this._bindedAddSwatch(this.swatches[i]);var s=this._swatchList.length>0?this._swatchList.length-1:0;o.compareColorStrings(this._swatchList[s].value,this.value)?this._swatchList[s].swatch.setAttribute("is-selected",""):this._swatchList[s].swatch.removeAttribute("is-selected")}}.bind(this),this._bindedRemoveAllSwatches=function(){var e=this;this._swatchList.forEach(function(t){t.swatch&&(l.removeEventOnElement(e,t.swatch,s.POINTERHIT,e._bindedOnPointerHit),t.swatch.remove(),t.swatch.destroy())}),this._swatchList=[]}.bind(this)},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("swatches")&&this._applySwatches(),this.isDirty("value")&&this._preEditValue(t.value,this.value)&&this._applyValue(t.value)},t.prototype._preEditValue=function(e,t){return!(t&&!o.isValidColorString(t))},t.prototype._applyValue=function(e){var t,i,n=u(this.value,this._swatchList);t=n?n.swatch:void 0,(i=this.elements.container)&&i.getChildren().forEach(function(e){e.removeAttribute("is-selected")}),t&&t.setAttribute("is-selected",""),this.fire("change")},t.prototype._applySwatches=function(){this._bindedRemoveAllSwatches(),this._bindedAddSwatches(this.swatches)},t.prototype._applyTouchMode=function(t){e.prototype._applyTouchMode.call(this,t);var i=this;this._swatchList&&this._swatchList.forEach(function(e){e.swatch&&(e.swatch.style.background=c(e.value,i._getCurrentTouchMode()))})},t.prototype.reApplySwatches=function(){this._applySwatches()},t.prototype.loadDefault=function(){var e=[];Object.keys(o.COLORS_3DEXPERIENCE).forEach(function(t){e.push({value:o.COLORS_3DEXPERIENCE[t]})}),this.swatches=e},t.prototype.reset=function(){this.swatches=[],this.value=""},t}(n);return r.addClass(d,"colorPalette"),d.prototype.blackBoxFlag=!0,d});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/Button",["require","exports","UWA/Core","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Dom","DS/WebRecordEnabler/Adapter","DS/Utilities/Utils","DS/Core/WebUXComponents","DS/Utilities/WUXUWAUtils","DS/Core/WebUXGlobalEnums"],function(e,t,i,n,s,o,l,a,r,h){"use strict";function u(e){var t=function(){if("check"===this.type)return this.setPropertyFromUIInteraction("checkFlag",!this.checkFlag),!0;if("radio"===this.type)return!this.checkFlag&&(this.setPropertyFromUIInteraction("checkFlag",!0),!0);return!0}.call(this),i={ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,altKey:e.altKey};return this.fire("buttonclick",i),t}function c(){if(this.elements.icon&&(this.elements.iconPlaceholder&&this.elements.iconPlaceholder.empty(),delete this.elements.icon),this.elements.separator&&this.elements.separator.remove(this.elements.button),this.icon){this.elements.iconPlaceholder||(this.elements.iconPlaceholder=new i.Element("div",{class:"wux-button-icon-placeholder"})),this.elements.iconPlaceholder.isInjected(this.elements.button)||this.elements.iconPlaceholder.inject(this.elements.button,"top");var e=o.oldGenerateIcon(this.icon,this.iconSize,window.WUXManagedFontIcons.FontAwesome);if(e){if(this.elements.icon=e,this.elements.iconPlaceholder&&this.elements.iconPlaceholder.show(),this.elements.icon.style.pointerEvents="none",this.elements.iconPlaceholder&&(this.elements.icon.inject(this.elements.iconPlaceholder),"flyout"===this.displayStyle&&(this.elements.separator||(this.elements.separator=new i.Element("div",{class:"wux-button-separator"})),this.elements.separator.inject(this.elements.iconPlaceholder,"after"))),o.isFontIcon(this.icon))this.elements.container.removeClassName("wux-contains-richIcon");else if(this.elements.container.addClassName("wux-contains-richIcon"),this.elements.icon&&"IMG"===this.elements.icon.tagName){var t=this;this.elements.icon.onload=function(){t&&t.elements&&t.elements.icon&&(t.elements.icon.onload=null,t.fire("dimensionsChanged"))}}}else this.elements.iconPlaceholder&&this.elements.iconPlaceholder.hide()}}var d=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var s=e.apply(this,t)||this;return h.extendingClassFlag?s:(s.addKeyMapsAndCommands({return:{keydown:"validate",keyup:"validate"},space:{keydown:"validate",keyup:"validate"}},{validate:function(e){if(this.disabled)return{stopPropagation:!1};var t={};return(1===this.clickMode&&"keydown"===e.type||0===this.clickMode&&"keyup"===e.type)&&(t.actionPerformed=u.call(this,e)),"return"===i.Event.whichKey(e)?{stopPropagation:!1,infos:t}:{stopPropagation:!0,preventDefault:!0,infos:t}}}),s)}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{label:{defaultValue:"",type:"string",category:"Appearance"},emphasize:{defaultValue:"secondary",type:"string",category:"Appearance"},icon:{defaultValue:"",type:"object",category:"Appearance"},iconSize:{defaultValue:"1x",type:"string",category:"Appearance",uiDisplay:!1},value:{defaultValue:void 0,type:"object",category:"Behavior",recordFlag:!0},type:{defaultValue:"standard",type:"string",category:"Behavior",noNeedToApplyFlag:!0},checkFlag:{defaultValue:!1,type:"boolean",category:"Behavior",recordFlag:!0},minWidth:{defaultValue:-1,type:"integer",category:"Appearance"},minHeight:{defaultValue:-1,type:"integer",category:"Appearance"},preferredWidth:{defaultValue:-1,type:"integer",category:"Appearance"},preferredHeight:{defaultValue:-1,type:"integer",category:"Appearance"},onClick:{defaultValue:void 0,type:"function",category:"Behavior"},clickMode:{defaultValue:0,type:"integer",category:"Behavior"},multiSelFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},displayStyle:{defaultValue:"normal",type:"string",category:"Appearance"},showLabelFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},allowUnsafeHTMLLabel:{defaultValue:void 0,type:"boolean",category:"Behavior"},noContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){e.prototype.buildView.call(this),this.elements.container.addClassName("wux-controls-button"),this.elements.container.tabindex=0,this.elements.button=this.elements.container,this.isMultiSelection=!1},t.prototype._applyIcon=function(e){"object"==typeof this.icon&&(this.icon.fontIconFamily||(this.icon.fontIconFamily=window.WUXManagedFontIcons.FontAwesome),this.icon.fontIconSize||"1x"===this.iconSize||(this.icon.fontIconSize=this.iconSize)),c.call(this)},t.prototype._applyIconSize=function(e){this.elements.icon&&("object"==typeof this.icon&&"1x"!==this.iconSize&&(this.icon.fontIconSize=this.iconSize),c.call(this))},t.prototype._applyEmphasize=function(e){if(e){var t="wux-ui-state-"+e;this.elements.button.removeClassName(t)}t="wux-ui-state-"+this.emphasize,this.elements.button.addClassName(t)},t.prototype._applyDisplayStyle=function(e){e&&this.elements.button.removeClassName("wux-ui-style-"+e),this.elements.button.addClassName("wux-ui-style-"+this.displayStyle),"lite-borders"===this.displayStyle&&this.elements.icon?this.elements.icon.style.margin="0px 0px 0px 0px":this.elements.icon&&c.call(this)},t.prototype._applyPreferredWidth=function(e){this.preferredWidth>0?(this.elements.button.setStyles({"max-width":this.preferredWidth+"px"}),this.elements.button.setStyles({width:"100%"})):(this.elements.button.setStyles({"max-width ":""}),this.elements.button.setStyles({"width ":""}))},t.prototype._applyPreferredHeight=function(e){this.preferredHeight>0?(this.elements.button.setStyles({"max-height":this.preferredHeight+"px"}),this.elements.button.setStyles({height:"100%"})):(this.elements.button.setStyles({"max-height":""}),this.elements.button.setStyles({height:""}))},t.prototype._applyMinWidth=function(e){-1!=this.minWidth?this.elements.button.setStyles({"min-width":this.minWidth+"px"}):this.elements.button.setStyles({"min-width":""})},t.prototype._applyMinHeight=function(e){-1!=this.minHeight?this.elements.button.setStyles({"min-height":this.minHeight+"px"}):this.elements.button.setStyles({"min-height":""})},t.prototype._applyOnClick=function(e){e&&this.removeEventListener("buttonclick",e),this.onClick&&this.addEventListener("buttonclick",this.onClick)},t.prototype.handleEvents=function(){var e=this;o.addEventOnElement(this,this.elements.button,"click",function(t){e.disabled||(e._actionHasBeenLaunchedOnDown||u.call(e,t),e._actionHasBeenLaunchedOnDown=void 0)}),o.addEventOnElement(this,this.elements.button,s.POINTERHIT,function(t){if(2===t.multipleHitCount){if(e.disabled)return;e.fire("buttonDblClick")}}),o.addEventOnElement(this,this.elements.button,s.POINTERDOWN,function(t){t.dsModel=e,e.disabled||1===e.clickMode&&(e._actionHasBeenLaunchedOnDown=!0,u.call(e,t))}),o.addEventOnElement(this,this.elements.button,"mousedrag",function(t){t.dsModel=e}),o.addEventOnElement(this,this.elements.button,s.POINTERUP,function(t){t.dsModel=e})},t.prototype._applyCheckFlag=function(e){!0===this.checkFlag?(this.elements.button.setAttributeNode(document.createAttribute("checked")),this.multiSelFlag&&this.isMultiSelection||this._uncheckSiblings()):this.elements.button.removeAttribute("checked"),void 0===e||e===this.checkFlag||this.preventTriggeringChangeEvent||this.fire("change")},t.prototype._applyDisabled=function(){e.prototype._applyDisabled.call(this),this.disabled?this.elements.button.removeAttribute("tabindex"):this.elements.button.setAttribute("tabindex",0)},t.prototype._applyLabel=function(e){void 0!==this.label&&""!==this.label?(this.elements.text||(this.elements.text=i.createElement("span"),this.elements.text.addClassName("wux-button-label"),this.elements.text.inject(this.elements.button),this._applyShowLabelFlag()),a.getUnsafeHTMLContentValueToApply(this.allowUnsafeHTMLLabel)?this.elements.text.setContent(this.label):this.elements.text.textContent=this.label):this.elements.text&&(this.elements.text.remove(),this.elements.text=void 0,delete this.elements.text)},t.prototype._applyShowLabelFlag=function(){this.elements.text&&(this.showLabelFlag?(this.elements.text.show(),this.elements.button.setAttributeNode(document.createAttribute("showlabel"))):this.showLabelFlag||(this.elements.text.hide(),this.elements.button.removeAttribute("showlabel")))},t.prototype._applyAllowUnsafeHTMLLabel=function(){this._applyLabel(this.label)},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("emphasize")&&this._applyEmphasize(t.emphasize),this.isDirty("displayStyle")&&this._applyDisplayStyle(t.displayStyle),this.isDirty("preferredWidth")&&this._applyPreferredWidth(t.preferredWidth),this.isDirty("preferredHeight")&&this._applyPreferredHeight(t.preferredHeight),this.isDirty("minWidth")&&this._applyMinWidth(t.minWidth),this.isDirty("minHeight")&&this._applyMinHeight(t.minHeight),this.isDirty("icon")?this._applyIcon(t.icon):this.isDirty("iconSize")&&this._applyIconSize(t.iconSize),(this.isDirty("allowUnsafeHTMLLabel")||this.isDirty("label"))&&this._applyLabel(t.label),this.isDirty("onClick")&&this._applyOnClick(t.onClick),this.isDirty("checkFlag")&&this._applyCheckFlag(t.checkFlag),this._applyDisplayStyle(t.displayStyle),this._applyShowLabelFlag()},t.prototype._uncheckSiblings=function(){if("radio"===this.type){var e=this.elements.button.parentNode;if(e){e.dsModel&&"buttonGroup"===e.dsModel.__proto__.name&&(e.dsModel.preventTriggeringChangeEvent=!0);for(var i=e.childNodes,n=0;n<i.length;n++)i[n]!==this.elements.button&&i[n].dsModel&&i[n].dsModel instanceof t&&"radio"===i[n].dsModel.type&&(i[n].dsModel.checkFlag=!1);e.dsModel&&"buttonGroup"===e.dsModel.__proto__.name&&(e.dsModel.preventTriggeringChangeEvent=!1)}}},t}(n);return r.addClass(d,"button"),d.prototype.markForRecordFlag=!0,l.register(d,"DS/ControlsRec/AbstractRec"),d});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/Popup",["require","exports","UWA/Core","DS/Controls/Abstract","DS/Utilities/Utils","DS/Utilities/Dom","DS/UIBehaviors/PopupManager","DS/WebRecordEnabler/Adapter","DS/Utilities/KeyboardUtils","DS/Core/PointerEvents","DS/Core/WebUXComponents","UWA/Class/Promise"],function(e,t,i,n,s,o,l,a,r,h,u,c){"use strict";var d={x:0,y:0};function p(e){var t=e.availableSpaces,i=e.boundaries,n=this.getContent();if(n){var o={overflow:"auto"},l=window.getComputedStyle(n);if("top"===this.position||"bottom"===this.position){var a=parseInt(l.paddingTop)+parseInt(l.paddingBottom);t.top>t.bottom?(o.height=Math.min(e.size.height,Math.round(t.top-a)),o.top=Math.max(i.minPos.y,Math.round(e.targetPosition.y-o.height+e.offset.top.y-a))):(o.height=Math.min(e.size.height,Math.round(t.bottom-a)),o.top=Math.max(i.minPos.y,Math.round(e.targetPosition.y+e.targetSize.height+e.offset.bottom.y)));var r=o.height<e.size.height?s.getScrollbarWidth():0;o.left=Math.max(i.minPos.x,Math.min(i.maxPos.x-e.size.width-r,parseInt(l.left))),o.maxWidth=Math.round(i.maxPos.x-i.minPos.x)}else{var h=parseInt(l.paddingLeft)+parseInt(l.paddingRight);r=e.size.height>i.maxPos.y-i.minPos.y?s.getScrollbarWidth():0;t.left>t.right?(o.width=Math.min(e.size.width+r,Math.round(t.left-h)+r),o.left=Math.max(i.minPos.x,Math.round(e.targetPosition.x-o.width+e.offset.left.y))):(o.width=Math.min(e.size.width+r,Math.round(t.right-h+r)),o.left=Math.max(i.minPos.x,Math.round(e.targetPosition.x+e.targetSize.width+e.offset.right.x)));var u=o.width<e.size.width?s.getScrollbarWidth():0;o.top=Math.max(i.minPos.y,Math.min(i.maxPos.y-e.size.height-u,parseInt(l.top))),o.maxHeight=Math.round(i.maxPos.y-i.minPos.y)}n.setStyles(o)}}var m=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return n.markForRecordFlag=!0,n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{position:{defaultValue:"right",type:"string",category:"Appearance"},alignment:{defaultValue:"near",type:"string",category:"Appearance"},visibleFlag:{defaultValue:!1,type:"boolean",category:"Appearance"},target:{defaultValue:null,type:"object",category:"Behavior",uiDisplay:!1},positionTarget:{defaultValue:null,type:"object",category:"Behavior",uiDisplay:!1},offset:{defaultValue:{x:0,y:0},type:"vector2",category:"Appearance",noNeedToApplyFlag:!0},constraint:{defaultValue:"none",type:"string",category:"Appearance"},trigger:{defaultValue:"",type:"string",category:"Behavior",uiDisplay:!1},mouseRelativePosition:{defaultValue:!1,type:"boolean",category:"Appearance",noNeedToApplyFlag:!0},overlap:{defaultValue:!0,type:"boolean",category:"Appearance"},overlapCallback:{defaultValue:p,type:"function",category:"Behavior"},shouldDisplayCallback:{defaultValue:null,type:"function",category:"Behavior"},beforeDisplayCallback:{defaultValue:null,type:"function",category:"Behavior"},postOverlapCallback:{defaultValue:null,type:"function",category:"Behavior"},toggleFlag:{defaultValue:!0,type:"boolean",category:"Behavior",noNeedToApplyFlag:!0},className:{defaultValue:"wux-controls-popup",type:"string",category:"Appearance"},arrowBoxFlag:{defaultValue:!1,type:"boolean",category:"Appearance"},autoHide:{defaultValue:!0,type:"boolean",category:"Appearance"},usePaddingFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},forceKeepOrientation:{defaultValue:void 0,type:"boolean",category:"Appearance"}}},enumerable:!1,configurable:!0}),t.prototype.getBody=function(){if(this.elements)return this.elements.body},t.prototype.setBody=function(e){this.elements.container&&this.elements.container.empty(),this.elements.body=e,this.elements.container.setContent(e),this.elements.container.setAttribute("tabindex",0),this._applyArrowBoxFlag()},t.prototype._applyArrowBoxFlag=function(){this.arrowBoxFlag?(this.elements.arrow||(this.elements.arrow=new i.Element("div",{class:"wux-controls-popup-arrow-"+this.position}),this.elements.arrow.inject(this.elements.container),this.elements.container.addClassName("wux-controls-popup-with-arrow")),this._updateView()):(this.elements.arrow&&(this.elements.arrow.style.display="none"),this.elements.container.removeClassName("wux-controls-popup-with-arrow"))},t.prototype._applyTarget=function(e){g.call(this),e&&o.removeEventOnElement(this,e.elements&&e.elements.container?e.elements.container:e,"DOMNodeRemoved",this._onTargetRemovedFromDOMBound),this.target&&o.addEventOnElement(this,this.target.getContent?this.target.getContent():this.target,"DOMNodeRemoved",this._onTargetRemovedFromDOMBound),this._updateView()},t.prototype._applyPositionTarget=function(e){this._updateView()},t.prototype._applyTrigger=function(e){g.call(this)},t.prototype._applyUsePaddingFlag=function(){this.usePaddingFlag?this.getContent().removeAttribute("no-padding"):this.getContent().setAttributeNode(document.createAttribute("no-padding"))},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.className&&""!==this.className&&(this.elements.container.removeClassName("wux-controls-popup"),this.elements.container.addClassName(this.className)),this.isDirty("usePaddingFlag")&&this._applyUsePaddingFlag(),this.isDirty("target")?this._applyTarget(t.target):this._updateView()},t.prototype._preInject=function(){},t.prototype._postInject=function(){},t.prototype.show=function(t){if(this.visibleFlag){if(function(){return!this.__preventCallShouldDisplayLock}.call(this)&&this.shouldDisplayCallback&&!this.shouldDisplayCallback.call(null))return void(this.visibleFlag=!1);var i=this.target;if(!arguments[0]&&i&&i.disabled)return this;var n=o.getDocumentOwner(i);if(this.elements&&this.elements.container){if(this.beforeDisplayCallback instanceof Function){var s=this.beforeDisplayCallback(this);if(s&&s.preventDisplay)return void(this.visibleFlag=!1)}!this._isVisibilityManagedByPopupManager||this._isMouseOver&&1===this._getVisibilityCounter()||l.add(this),this._preInject(),this.inject(n.body),this._postInject();var a=e.prototype.show.call(this,t);this._updateView(),this.fire("show")}this.mouseRelativePosition&&(this.elements.container.style.pointerEvents="none")}else this.visibleFlag=!0,this._applyArrowBoxFlag();return a},t.prototype.hide=function(t){if(this.visibleFlag)this.visibleFlag=!1;else{e.prototype.hide.call(this,t),this._isVisibilityManagedByPopupManager&&l.remove(this);var i=o.getDocumentOwner(this.target);this.elements&&this.elements.container&&(this.elements.container.remove(i.body),function(){var e=this.getContent();e&&e.setStyles({top:0,left:0,height:void 0,width:void 0,maxHeight:void 0,maxWidth:void 0,overflow:void 0})}.call(this),this.fire("hide",{trigger:this._escapeKbdAction?"escape":""}))}},t.prototype._applyVisibleFlag=function(e){var t=this;this.visibleFlag&&!this._globalListening?(this._scrollAtShow.x=window.scrollX,this._scrollAtShow.y=window.scrollY,t._resizeAndScrollEvtsHandler=o.addScrollAndResizeListener(t,t.target,t._hideThisPopupBound),this._globalListening=!0):!this.visibleFlag&&this._globalListening&&(t._resizeAndScrollEvtsHandler&&(o.removeScrollAndResizeListener(t._resizeAndScrollEvtsHandler),delete t._resizeAndScrollEvtsHandler),this._globalListening=null),this.visibleFlag?this.show():this.hide()},t.prototype.isElementInside=function(e){if(!e)return!1;var t=l.getContainingPopup(e);return!!t&&(t.options.grid.data===this||this.isElementInside(t.options.grid.data.target))},t.prototype.toggle=function(){var e=this.visibleFlag;this.visibleFlag=!e},t.prototype._preBuildView=function(t){e.prototype._preBuildView.call(this,t),this._isVisibilityManagedByPopupManager=!0},t.prototype.buildView=function(){this.elements.container.addClassName("wux-controls-popup"),this.elements.container.setStyles({left:0,top:0}),this._hideThisPopupBound=function(e){if(e.target&&"resize"!==e.type){if(this.isElementInside(e.target)){var t=0;"mousewheel"===e.type||"scroll"===e.type?t=e.wheelDelta:"DOMMouseScroll"===e.type&&(t=-e.detail),this._scrollDown=!(t>=0);var i=function e(t,i){if(!(t instanceof Element))return null;var n=window.getComputedStyle(t)["overflow-y"];return t.scrollHeight>t.offsetHeight&&("scroll"===n||"auto"===n)?t:t===i?null:e(t.parentNode)}(e.target,this.elements.container);return i&&(i.offsetHeight+i.scrollTop>=i.scrollHeight&&this._scrollDown||0===i.scrollTop&&!this._scrollDown)&&e.preventDefault(),void(i=null)}this.visibleFlag=!1}else"resize"===e.type&&(this.visibleFlag=!1)}.bind(this),this._scrollAtShow={x:0,y:0},this._onTargetRemovedFromDOMBound=function(e){var t=this.target;t&&this.visibleFlag&&e.target===(t.getContent?t.getContent():t)&&this.hide()}.bind(this)},t.delayPopupCreation=function(e,i){var n,s=e.target,l=function(s){if((!s||"mouseover"!==s.type||0===s.buttons)&&(!s||"keydown"!==s.type||r.isAlphaNumeric(s.keyCode))&&(!e.shouldDisplayCallback||e.shouldDisplayCallback.call(null))&&(!this||!(this.disabled||this.dsModel&&this.dsModel.disabled))){n(),e.visibleFlag=!1;var o=new t(e);s&&"mouseover"===s.type?o._isMouseOver=!0:s&&s.type===h.POINTERDOWN?o._isMousePressed=!0:s&&"click"===s.type&&(o._isClicked=!0);var l=e.getBody.call(),a=function(){o.setBody(l),i.call(null,o),function(e){this.__preventCallShouldDisplayLock=!0,e.call(this),this.__preventCallShouldDisplayLock=!1}.call(o,function(){o.visibleFlag=!0})};l instanceof c?l.then(function(e){l=e,a.call(null)}):a.call(null),s&&"mouseover"!==s.type&&"focus"!==s.type&&s.stopPropagation()}};s&&e.trigger?(n=function(){o.removeEventOnElement(s,s,"mouseover",l),o.removeEventOnElement(s,s,"focus",l),o.removeEventOnElement(s,s,"click",l),o.removeEventOnElement(s,s,h.POINTERDOWN,l),o.removeEventOnElement(s,s,"keydown",l)},e.trigger.split(" ").forEach(function(e){"hover"===e&&o.addEventOnElement(s,s,"mouseover",l),"focus"===e&&o.addEventOnElement(s,s,"focus",l),"click"===e&&o.addEventOnElement(s,s,"click",l),"mousePress"===e&&o.addEventOnElement(s,s,h.POINTERDOWN,l),"keydown"===e&&o.addEventOnElement(s,s,"keydown",l)})):n=function(){};return{removeListeners:n,createVisiblePopup:l}},t.prototype.handleEvents=function(){var e=this;window.visualViewport&&(o.addEventOnElement(this,window.visualViewport,"resize",function(){e._updateView()}),o.addEventOnElement(this,window.visualViewport,"scroll",function(){e._updateView()})),o.addEventOnElement(this,this.elements.container,"click",function(t){l.removeChild(e)}),o.addEventOnElement(this,this.elements.container,"dimensionsChanged",function(){e._updateView()})},t.prototype._updateView=function(){if(this.visibleFlag){var e=this.positionTarget?this.positionTarget:this.target,t=s.convertOffsetToAdvancedOffset(this.offset,this.position);this.arrowBoxFlag&&(t.bottom.y+=7,t.top.y-=7,t.right.x+=7,t.left.x-=7);var i=s.setConstrainedPosition(this,e,{position:this.position,alignment:this.alignment,offset:t,constraint:this.constraint,overlap:this.overlap,mouseRelativePosition:this.mouseRelativePosition,mousePosition:d,mouseOffset:{x:-10,y:10},forceKeepOrientation:this.forceKeepOrientation});this._latestComputedPosition=i.positionToTarget,this.arrowBoxFlag&&(this.elements.arrow.className="wux-controls-popup-arrow arrow-"+this._latestComputedPosition),!1===i.success&&this.overlapCallback instanceof Function&&(this.overlapCallback(i),this.postOverlapCallback&&this.postOverlapCallback())}},t.prototype._getVisibilityCounter=function(){var e=o.getDocumentOwner(this.target),t=0;return this.trigger.includes("focus")&&e.activeElement==this.target&&t++,this.trigger.includes("hover")&&this._isMouseOver&&t++,this.trigger.includes("mousePress")&&this._isMousePressed&&t++,this.trigger.includes("click")&&this._isClicked&&t++,t},t.prototype._managePopupVisibility=function(){var e=this._getVisibilityCounter();e>0?this.visibleFlag?this._isMouseOver&&e>1&&l.add(this):this.visibleFlag=!0:this.visibleFlag=!1},t.prototype.storeMousePosition=function(e){this.mouseRelativePosition&&(d.x=e.pageX,d.y=e.pageY)},t.SizeAdjustPolicyEnum={NoAdjust:0,AdjustToVisibleContents:1,AdjustToAllContents:2},t}(n);function g(){o.removeAllEventsOnElement(this);var e=this,t=this.trigger.split(" "),i=this.target;i&&t.forEach(function(t){if("hover"===t&&(o.addEventOnElement(e,i,"mousemove",function(t){e.storeMousePosition(t),0!==t.buttons||e._isMouseOver||(e.storeMousePosition(t),e._isMouseOver=!0,e._managePopupVisibility())}),o.addEventOnElement(e,i,"mouseover",function(t){0===t.buttons&&(e.storeMousePosition(t),e._isMouseOver=!0,e._managePopupVisibility())}),o.addEventOnElement(e,i,"mouseleave",function(){e._isMouseOver=!1,e._managePopupVisibility()})),"focus"===t&&(o.addEventOnElement(e,i,"focus",function(){e._managePopupVisibility()}),o.addEventOnElement(e,i,"blur",function(){e._managePopupVisibility()})),"mousePress"===t&&o.addEventOnElement(e,i,h.POINTERDOWN,function(){e._isMousePressed=!0,e._managePopupVisibility();var t=o.getDocumentOwner(i);o.addEventOnElement(e,t,h.POINTERUP,function i(){e._isMousePressed=!1,e._managePopupVisibility(),o.removeEventOnElement(e,t,h.POINTERUP,i)})}),"click"===t){o.addEventOnElement(e,i,"click",function(t){!e.target||e.target.disabled||e.target.dsModel&&e.target.dsModel.disabled||(t.stopPropagation(),e._isClicked=!0,e.storeMousePosition(t),e.toggleFlag?(!e.visibleFlag||e.target.canClosePopup&&!e.target.canClosePopup(!1))&&e.visibleFlag||e.callMethodFromUIInteraction("toggle"):e.setPropertyFromUIInteraction("visibleFlag",!0),e._isClicked=!1)});var n=function(t){var i=e.target.elements?e.target.getContent():e.target;e.isElementInside(t.target)||o.isElementInside(t.target,i)||!e.autoHide||i&&i.canClosePopup&&!i.canClosePopup(!0)||e.setPropertyFromUIInteraction("visibleFlag",!1)},s=o.getDocumentOwner(e.target);o.addEventOnElement(e,e,"show",function(){o.addEventOnElement(e,s.body,h.POINTERDOWN,n)}),o.addEventOnElement(e,e,"hide",function(){o.removeEventOnElement(e,s.body,h.POINTERDOWN,n)})}"escape"===t&&o.addEventOnElement(e,e.getContent(),"keydown",function(t){r.ESCAPE===t.keyCode&&(e._escapeKbdAction=!0,t.actionPerformed=!0,e.visibleFlag=!1,e._escapeKbdAction=!1)})})}return u.addClass(m,"popup"),a.register(m,"DS/ControlsRec/AbstractRec"),m}),define("DS/Controls/Toolbar",["UWA/Core","DS/Utilities/Dom","DS/Controls/Abstract","DS/Controls/Button","DS/Controls/Popup","DS/Utilities/Array","DS/Utilities/TouchUtils"],function(e,t,i,n,s,o,l){"use strict";const a="wux-controls-toolbar-category-separator",r="near",h="center",u="far",c="toolbar",d="popup",p=[r,h,u];let m=0;var g=i.inherit({name:"toolbar",publishedProperties:{overflowManagement:{defaultValue:"scroll",type:"string",category:"Behavior"},direction:{defaultValue:"horizontal",type:"string",category:"Appearance"},verticalAlign:{defaultValue:h,type:"string",category:"Appearance"},adaptSizeToParent:{defaultValue:!1,type:"boolean",category:"Appearance"}},_customDropDownManagement:void 0,add:function(i,n){switch(this._minimumSizeOfAllElements=null,i){case"element":n.element&&n.position&&(n.element.addClassName||(n.element=e.extendElement(n.element)),n.element.addClassName("wux-toolbar-items wux-toolbar-items-"+n.position),y.call(this,"element",{element:n.element,position:n.position,index:n.index,priority:n.priority||0,category:n.category,data:n.data,visibleFlag:void 0===n.visibleFlag||n.visibleFlag,id:n.id?n.id:`ID_${m++}`}),"scroll"!==this.overflowManagement&&-1===this._resizeListeners.indexOf(n.position)&&(this._resizeListeners.push(n.position),t.addResizeObserver(this,this._getContainerFromPosition(n.position),f)));break;case"separator":if(n.element){var s=o.getIndexOfElement(this._elementsArray,"element",n.element);if(-1===s)return;var l=new e.createElement("div",{class:"wux-controls-toolbar-separator"}),a=this._elementsArray[s];this._elementsArray.splice(s,0,{type:"separator",element:l,position:a.position,container:a.container,priority:n.priority||a.priority,category:n.category,data:n.data,id:n.id?n.id:`ID_${m++}`});for(var r=p.indexOf(a.position)+1;r<p.length;r++)-1!==this._firstElementIndexForPosition[p[r]]&&this._firstElementIndexForPosition[p[r]]++;a.element.getParent().insertBefore(l,a.element)}else if(n.position){if(-1===this._firstElementIndexForPosition[n.position])return;l=new e.createElement("div",{class:"wux-controls-toolbar-separator"});y.call(this,"separator",{element:l,position:n.position,index:n.index,priority:n.priority||0,category:n.category,data:n.data,id:n.id?n.id:`ID_${m++}`})}}},remove:function(e,t){switch(this._minimumSizeOfAllElements=null,e){case"element":if(t.element){var i=o.getIndexOfElement(this._elementsArray,"element",t.element);if(-1===i)return;C.call(this,i)}else if(t.position&&void 0!==t.index){if(-1===this._firstElementIndexForPosition[t.position])return;for(var n=p.indexOf(t.position),s=this._elementsArray.length-1,l=n+1;l<p.length;l++)if(-1!==this._firstElementIndexForPosition[p[l]]){s=this._firstElementIndexForPosition[p[l]]-1;break}var a=Math.min(s-this._firstElementIndexForPosition[t.position],t.index);if("separator"===this._elementsArray[this._firstElementIndexForPosition[t.position]+a].type)return;C.call(this,this._firstElementIndexForPosition[t.position]+a)}break;case"separator":if(t.position&&void 0!==t.index){if(-1===this._firstElementIndexForPosition[t.position])return;for(n=p.indexOf(t.position),s=this._elementsArray.length-1,l=n+1;l<p.length;l++)if(-1!==this._firstElementIndexForPosition[p[l]]){s=this._firstElementIndexForPosition[p[l]]-1;break}a=Math.min(s-this._firstElementIndexForPosition[position],t.index);if("separator"!==this._elementsArray[this._firstElementIndexForPosition[position]+a].type)return;C.call(this,this._firstElementIndexForPosition[position]+a)}}},clearPosition:function(e){const t=this._elementsArray.filter(t=>t.position===e);if(0!==t.length){for(const e of t)C.call(this,this._elementsArray.indexOf(e));this._minimumSizeOfAllElements=null}},clear:function(){for(var e=0;e<p.length;e++)this.clearPosition(p[e])},getPositionFromElement:function(e){for(var t=0;t<p.length;t++){var i=this._getContainerFromPosition(p[t]);if(e.getParent()===i)return{position:p[t],index:i.getChildren().indexOf(e)}}var n=this.getPopupContent();if(e.getParent()===n)return{position:this.getItemFromElement(e).position,index:n.getChildren().indexOf(e)}},modelModified:function(){I.call(this)},getItemFromElement:function(e){var t=o.getIndexOfElement(this._elementsArray,"element",e);return-1!==t?this._elementsArray[t]:void 0},getItemFromIndex:function(e){if(e>=0&&e<this._elementsArray.length)return this._elementsArray[e]},getNumberOfItems:function(e){return this._elementsArray.length},enablePopupBehavior:function(e){e=e||{},this._showEverything=e.showEverything||this._showEverythingDefault,this._moveFromToolbarToPopup=e.moveFromToolbarToPopup||this._moveFromToolbarToPopupDefault,this._moveFromPopupToToolbar=e.moveFromPopupToToolbar||this._moveFromPopupToToolbarDefault,this._onPopupCreationFunction=e.onPopupCreationFunction||this._onPopupCreationFunctionDefault,this._popupBeforeDisplayCallback=e.popupBeforeDisplayCallback,this._popupPostOverlapCallback=e.popupPostOverlapCallback,this._onResize()},buildView:function(i){var n=this;this._elementsArray=new Array,this._firstElementIndexForPosition={near:-1,center:-1,far:-1},this._minimumSizeOfAllElements=null,this._listeningResizeEvent=!1,this._resizeListeners=[],this._enableCalculus=function(e){this._isCalculusEnabled=!0},this._enableSizeCalculus=function(e){return this._isCalculusEnabled},this._isPopupContentManaged=!1,this.enablePopupBehavior(),this.elements.container.addClassName("wux-controls-toolbar"),this.elements.maskContainer=new e.createElement("div",{class:"wux-controls-toolbar-mask-container"}).inject(this.elements.container),this.elements.nearContainer=new e.createElement("div",{class:"wux-controls-toolbar-containers wux-controls-toolbar-nearContainer"}).inject(this.elements.maskContainer),this.elements.centerContainer=new e.createElement("div",{class:"wux-controls-toolbar-containers wux-controls-toolbar-centerContainer"}).inject(this.elements.maskContainer),this.elements.farContainer=new e.createElement("div",{class:"wux-controls-toolbar-containers wux-controls-toolbar-farContainer"}).inject(this.elements.maskContainer),this.elements.container.dsModel=this,this.elements.maskContainer.dsModel=this,this.elements.popupContent=new e.createElement("div",{class:"wux-controls-toolbar-popup-content"}),t.addEventOnElement(this,this.getContent(),"dimensionsChanged",function(e){for(var t=e.target;t&&t!==n.getContent()&&!t.hasClassName("wux-toolbar-items");)t=t.getParent();if(t&&t!==n.getContent()){var i=o.getIndexOfElement(n._elementsArray,"element",t);i>=0&&(n._elementsArray[i].size={})}})},handleEvents:function(){const e=this;this._listeningResizeEvent||"scroll"===this.overflowManagement||(this._listeningResizeEvent=!0,t.addResizeObserver(this,this.elements.container,v),this.elements.container.offsetParent?this._enableCalculus("creation"):(this.mutationObserver=new MutationObserver((t,i)=>{if(e.elements.container||e.container)for(const n of t)for(const t of n.addedNodes)if(t.contains(e.getContent()))return i.disconnect(),e._enableCalculus("DomUtilsNodeInsertedIntoDocument"),void e._onResize()}),this.mutationObserver.observe(document,{childList:!0,subtree:!0})))},destroy:function(){this.clear(),t.removeResizeObserver(this,this.elements.container,v),this.mutationObserver&&(this.mutationObserver.disconnect(),this.mutationObserver=null);for(var e=0;e<p.length;e++)-1!==this._resizeListeners.indexOf(p[e])&&t.removeResizeObserver(this,this._getContainerFromPosition(p[e]),f);this._resizeListeners=null,this._parent()},_applyProperties:function(e){this._parent(e),this.isDirty("overflowManagement")&&this._applyOverflowManagement(e.overflowManagement),this.isDirty("direction")&&this._applyDirection(e.direction),this.isDirty("verticalAlign")&&this._applyVerticalAlign(e.verticalAlign),this.isDirty("touchMode")&&this._applyTouchMode(e.touchMode)},_applyTouchMode:function(){if(this._parent(),this._elementsArray)for(var e=0;e<this._elementsArray.length;e++){let t=this._elementsArray[e].size;t&&(t.shouldRecomputeNextTimeInToolbar=!0);let i=this._elementsArray[e].element;i&&l.applyTouch(i,this._getCurrentTouchMode())}},_applyDirection:function(e){this._minimumSizeOfAllElements=null,"vertical"===this.direction?(this.elements.container.addClassName("wux-toolbar-vertical"),this.elements.container.removeClassName("wux-toolbar-horizontal"),this.elements.maskContainer.addClassName("wux-toolbar-vertical"),this.elements.maskContainer.removeClassName("wux-toolbar-horizontal")):(this.elements.container.addClassName("wux-toolbar-horizontal"),this.elements.container.removeClassName("wux-toolbar-vertical"),this.elements.maskContainer.addClassName("wux-toolbar-horizontal"),this.elements.maskContainer.removeClassName("wux-toolbar-vertical")),this.elements.dropdownButtonContainer&&D.call(this,!0),this._onResize()},_applyVerticalAlign:function(e){this.elements.container.removeClassName("wux-toolbar-vertical-align-near"),this.elements.container.removeClassName("wux-toolbar-vertical-align-center"),this.elements.container.removeClassName("wux-toolbar-vertical-align-far"),this.verticalAlign===r?this.elements.container.addClassName("wux-toolbar-vertical-align-near"):this.verticalAlign===h?this.elements.container.addClassName("wux-toolbar-vertical-align-center"):this.verticalAlign===u&&this.elements.container.addClassName("wux-toolbar-vertical-align-far")},_applyAdaptSizeToParent:function(e){this.adaptSizeToParent?(this.getContent().addClassName("wux-toolbar-adaptToParent"),this.elements.maskContainer.addClassName("wux-toolbar-adaptToParent")):(this.getContent().removeClassName("wux-toolbar-adaptToParent"),this.elements.maskContainer.removeClassName("wux-toolbar-adaptToParent"))},getPreferredSize:function(){return S.call(this,!0)},_applyOverflowManagement:function(i){this.handleEvents();var o=this;if("scroll"===this.overflowManagement)this.elements.maskContainer.addClassName("wux-toolbar-scroll"),this.elements.maskContainer.removeClassName("wux-toolbar-dropdown"),this._showEverything(),this.elements.dropdownButtonContainer&&(this.elements.dropdownButtonContainer.destroy(),delete this.elements.dropdownButtonContainer);else if("dropdown"===this.overflowManagement||"custom"===this.overflowManagement){if(this.elements.dropdownButtonContainer||(this.elements.dropdownButtonContainer=new e.createElement("div").inject(this.elements.farContainer),this.elements.dropdownButtonContainer.addClassName("wux-toolbar-dropdown-container"),new e.createElement("div",{class:"wux-controls-toolbar-separator"}).inject(this.elements.dropdownButtonContainer),this.elements.dropDownButton=new n({displayStyle:"lite",visibleFlag:!0,icon:{iconName:"menu-dot",fontIconFamily:WUXManagedFontIcons.Font3DS}}).inject(this.elements.dropdownButtonContainer),this.elements.dropDownButton.getContent().classList.add("wux-toolbar-dropdown-button"),D.call(this),this.elements.maskContainer.addClassName("wux-toolbar-dropdown"),this.elements.maskContainer.removeClassName("wux-toolbar-scroll")),"dropdown"===this.overflowManagement)if(this.elements.dropdownPopup)this.elements.dropdownPopup.target=dropDownButton.getContent();else{var l={target:this.elements.dropDownButton.getContent(),position:"bottom",offset:{x:0,y:4},alignment:r,constraint:"screen",trigger:"click",overlap:!1,className:"wux-controls-popup wux-toolbar-popup",getBody:function(){return o.getPopupContent()},usePaddingFlag:!1,beforeDisplayCallback:function(){o._popupBeforeDisplayCallback&&o._popupBeforeDisplayCallback.call(o)},postOverlapCallback:function(){if(o._popupPostOverlapCallback)return o._popupPostOverlapCallback.call(o)}};this._preventDelayPopupCreation=s.delayPopupCreation(l,function(e){o.elements.dropdownPopup=e,o._onPopupCreationFunction()})}else"custom"===this.overflowManagement&&(this.elements.dropdownPopup&&(this.elements.dropdownPopup.destroy(),this.elements.dropdownPopup=void 0),this._preventDelayPopupCreation&&this._preventDelayPopupCreation.removeListeners.call(),t.addEventOnElement(this,this.elements.dropDownButton,"buttonclick",function(e){o.fire("dropDownButtonClick")}));this._onResize()}},_onResize:function(){if("scroll"!==this.overflowManagement&&this.getContent().offsetParent&&this._isCalculusEnabled){var e="vertical"===this.direction?this.elements.container.getSize().height:this.elements.container.getSize().width,t=S.call(this);if(t>e)for(;t>e;){var i=_.call(this);if(!i)break;{const e=w.call(this,i,"toolbar")+9*T.call(this,i);let n=0;this._moveFromToolbarToPopup(i),this.elements.dropdownButtonContainer.isHidden()&&(this.elements.dropdownButtonContainer.show(),n=this._dropDownMenuButtonSize),t=t-e+n}}else{for(var n=this._getNbElementsInPopup();n>0&&t<e;){const i=b.call(this),s=t+(w.call(this,i,"popup")+9*P.call(this,i))-(1===n?this._dropDownMenuButtonSize:0);if(!(s<=e))break;this._moveFromPopupToToolbar(i),t=s,n--}0===n&&this.elements.dropdownButtonContainer.hide()}I.call(this),this.fire("dimensionsChanged")}},_getContainerFromPosition:function(e){switch(e){case r:return this.elements.nearContainer;case h:return this.elements.centerContainer;case u:return this.elements.farContainer}},_insertItemInToolbarView:function(e){const t=this._elementsArray.indexOf(e),i=this._getSiblingItemInContainer(1,c,t);let n=null;if(i?n=i.element:"scroll"!==this.overflowManagement&&(e.position===u?n=this.elements.dropdownButtonContainer:-1!==this._resizeListeners.indexOf(e.position)&&(n=null)),n)k(n.previousSibling)&&(B(e,i)||n.previousSibling.isHidden())&&(n=n.previousSibling),e.element.inject(n,"before");else{const t=this._getContainerFromPosition(e.position);e.element.inject(t)}},_insertItemInPopupView:function(e){const t=this._elementsArray.indexOf(e),i=this._getSiblingItemInContainer(1,d,t),n=this.getPopupContent();let s=null;i&&(s=i.element),n.insertBefore(e.element,s)},_getSiblingItemInContainer:function(e,t,i,n){const s=this._elementsArray[i].position,o=void 0!==n?n:t===d;let l=i;const a=()=>{1===e?l++:l--};for(a();l>=0&&l<this._elementsArray.length;a()){if(!o&&this._elementsArray[l].position!==s)return null;if(this._elementsArray[l].container===t)return this._elementsArray[l]}return null},_showEverythingDefault:function(){for(var e=0;e<this._elementsArray.length;e++){var t=this._elementsArray[e];t.container===d&&this._moveFromPopupToToolbar(t)}},_moveFromToolbarToPopupDefault:function(e){let t;T.call(this,e)>0&&k(e.element.previousSibling)&&((t=e.element.previousSibling).remove(),t.destroy()),e.element.remove(),e.container=d,"dropdown"!==this.overflowManagement||this._customDropDownManagement||this._insertItemInPopupView(e,t)},_moveFromPopupToToolbarDefault:function(e){e.element.remove(),e.container=c,this._insertItemInToolbarView(e)},_onPopupCreationFunctionDefault:function(){},getPopupContent:function(){return this.elements.popupContent},_getNbElementsInPopup:function(){var e=0;return this._elementsArray.forEach(function(t){t.container===d&&e++}),e},_logElementsArray:function(){console.group("Log of the toolbar elements"),this._elementsArray.forEach(function(e){console.log(e.type," positioned at ",e.position," with priority ",e.priority," is currently displayed in ",e.container),console.log("element: ",e.element)}),console.groupEnd()}});let v,f;v=function(e){if(!(e&&e.length&&e[0]&&e[0].target))return;const t=e[0].target.dsModel;(t.elements.container||t.container)&&t._onResize()},f=function(e){if(!(e&&e.length&&e[0]&&e[0].target&&e[0].target.getParent()&&e[0].target.getParent().getParent()))return;const t=e[0].target.getParent().getParent().dsModel;(t.elements.container||t.container)&&t._onResize()};var y=function(e,t){var i,n=t.position,s=p.indexOf(n),o=void 0!==t.index?t.index:1/0;if(-1===this._firstElementIndexForPosition[n]){for(var l=s+1;l<p.length;l++)if(-1!==this._firstElementIndexForPosition[p[l]]){this._firstElementIndexForPosition[n]=this._firstElementIndexForPosition[p[l]];break}-1===this._firstElementIndexForPosition[n]&&(this._firstElementIndexForPosition[n]=this._elementsArray.length),i=0}else{var a=this._elementsArray.length;for(l=s+1;l<p.length;l++)if(-1!==this._firstElementIndexForPosition[p[l]]){a=this._firstElementIndexForPosition[p[l]];break}i=Math.min(a-this._firstElementIndexForPosition[n],o)}for(l=s+1;l<p.length;l++)-1!==this._firstElementIndexForPosition[p[l]]&&this._firstElementIndexForPosition[p[l]]++;const r=this._firstElementIndexForPosition[n]+i;this._elementsArray.splice(r,0,{type:e,element:t.element,position:n,priority:t.priority,container:c,category:t.category,data:t.data,visibleFlag:void 0===t.visibleFlag||t.visibleFlag,id:t.id?t.id:`ID_${m++}`});const h=this._elementsArray[r];this._insertItemInToolbarView(h),I.call(this)},b=function(){if(0!==this._elementsArray.length){for(var e=-1,t=[],i=0,n=0;n<this._elementsArray.length;n++)if(this._elementsArray[n].container===d)if(this._elementsArray[n].priority>e)e=this._elementsArray[n].priority,t=[this._elementsArray[n]],i=p.indexOf(this._elementsArray[n].position);else if(this._elementsArray[n].priority===e){var s=p.indexOf(this._elementsArray[n].position);s<i?(t=[this._elementsArray[n]],i=s):s===i&&t.push(this._elementsArray[n])}return t.length>0?t[0]:null}},_=function(){if(0!==this._elementsArray.length){for(var e=1/0,t=[],i=0,n=0;n<this._elementsArray.length;n++)if(this._elementsArray[n].container===c&&!1!==this._elementsArray[n].visibleFlag)if(this._elementsArray[n].priority<e)e=this._elementsArray[n].priority,t=[this._elementsArray[n]],i=p.indexOf(this._elementsArray[n].position);else if(this._elementsArray[n].priority===e){var s=p.indexOf(this._elementsArray[n].position);s>i?(t=[this._elementsArray[n]],i=s):s===i&&t.push(this._elementsArray[n])}return t.length>0?t[t.length-1]:null}},C=function(e){var t=this._elementsArray[e];this._firstElementIndexForPosition[t.position]===this._elementsArray.length&&(this._firstElementIndexForPosition[t.position]=-1);for(var i=p.indexOf(t.position)+1;i<p.length;i++)-1!==this._firstElementIndexForPosition[p[i]]&&this._firstElementIndexForPosition[p[i]]--,this._firstElementIndexForPosition[p[i]]===this._firstElementIndexForPosition[t.position]&&(this._firstElementIndexForPosition[t.position]=-1);t.element.remove(),this._elementsArray.splice(e,1),this.fire("itemRemoved",{item:t}),I.call(this)},w=function(e,t){if(this._enableSizeCalculus(e)){if(e.size||(e.size={}),!e.size[this.direction]||e.size.shouldRecomputeNextTimeInToolbar&&"toolbar"===t){var i=E.call(this,this.direction,e.element);i>0&&(e.size[this.direction]=i),delete e.size.shouldRecomputeNextTimeInToolbar}return e.size[this.direction]}return 0},x=function(e,t){for(var i=0,n=window.getComputedStyle(t),s=0;s<e.length;s++){var o=n.getPropertyValue("margin-"+e[s]);""!==o&&(i+=parseFloat(o))}return i},E=function(e,t){var i,n,s;return t.isHidden()&&(t.show(),n=!0),i=t.getSize(),s="vertical"===e?i.height+x(["top","bottom"],t):i.width+x(["right","left"],t),n&&t.hide(),s},S=function(e){for(var t=0,i=0;i<this._elementsArray.length;i++)if(e||this._elementsArray[i].container===c){var n=w.call(this,this._elementsArray[i],"toolbar");void 0!==n&&(t+=n)}var s,o=0;if(this.elements.container&&(s="vertical"===this.direction?window.getComputedStyle(this.elements.container).getPropertyValue("padding-top"):window.getComputedStyle(this.elements.container).getPropertyValue("padding-left"),o="vertical"===this.direction?window.getComputedStyle(this.elements.container).getPropertyValue("padding-bottom"):window.getComputedStyle(this.elements.container).getPropertyValue("padding-right"),s=""===s?0:parseInt(s,10),o=""===o?0:parseInt(o,10)),t=t+s+o,e)t+=9*function(){let e,t=0;for(var i=0;i<this._elementsArray.length;i++){let n=this._elementsArray[i];n.visibleFlag&&(e&&e.position===n.position&&e.category!==n.category&&t++,e=n)}return t}.call(this);else{var l=this.getContent().getElementsByClassName("wux-controls-toolbar-category-separator");t+=9*Array.prototype.slice.call(l).filter(function(e){return!e.isHidden()}).length}return!this.elements.dropdownButtonContainer||this.elements.dropdownButtonContainer.isHidden()||e||(t+=D.call(this)),t};var D=function(e){return this._dropDownMenuButtonSize=this._dropDownMenuButtonSize&&!e?this._dropDownMenuButtonSize:E.call(this,this.direction,this.elements.dropdownButtonContainer),this._dropDownMenuButtonSize};function I(){let e,t,i=[];for(let n=0;n<this._elementsArray.length;n++){let s=this._elementsArray[n];if(s.visibleFlag&&("toolbar"===s.container||!this._customDropDownManagement)){if(B("toolbar"===s.container?e:t,s)){let e=s.element.previousSibling;if(k(e))i.push(e);else{const e=M.call(this);e.inject(s.element,"before"),i.push(e)}}"toolbar"===s.container?e=s:t=s}}V(Array.prototype.slice.call(this.getContent().getElementsByClassName(a)),i);let n=this.elements.dropdownButtonContainer?this.elements.dropdownButtonContainer.previousSibling:void 0;if(n&&k(n)&&(n.remove(),n.destroy()),"dropdown"===this.overflowManagement&&!this._customDropDownManagement){V(Array.prototype.slice.call(this.elements.popupContent.getElementsByClassName(a)),i)}}function V(e,t){for(var i=0;i<e.length;i++){let n=e[i];k(n.nextSibling)?(n.remove(),n.destroy()):t.includes(n)?n.isHidden()&&n.show():n.isHidden()||n.hide()}}function F(e,t){for(let i=this._elementsArray.indexOf(e)-1;i>=0;i--)if(this._elementsArray[i].visibleFlag&&this._elementsArray[i].container===t)return this._elementsArray[i]}function A(e,t){for(let i=this._elementsArray.indexOf(e)+1;i<this._elementsArray.length;i++)if(this._elementsArray[i].visibleFlag&&this._elementsArray[i].container===t)return this._elementsArray[i]}function P(e){let t=0;B(F.call(this,e,"toolbar"),e)&&t++;let i=A.call(this,e,"toolbar");return B(i,e)&&(k(i.element.previousSibling)&&!i.element.previousSibling.isHidden()||t++),t}function T(e){let t=0,i=F.call(this,e,"toolbar");B(i,e)&&t++;let n=A.call(this,e,"toolbar");return n&&!B(i,n)&&k(n.element.previousSibling)&&!n.element.previousSibling.isHidden()&&t++,t}function B(e,t){return e&&t&&(e.position===t.position||"popup"===e.container&&"popup"===t.container)&&e.category!==t.category}var M=function(){return new e.createElement("div",{class:a})};function k(e){return e&&e.hasClassName(a)}return g}),define("DS/Controls/Flyout",["UWA/Core","DS/Utilities/Dom","DS/Controls/Abstract","DS/Controls/Button","DS/Controls/Popup","DS/Menu/Menu"],function(e,t,i,n,s,o){"use strict";var l={STANDARD:0,CHECK:1},a={EXPANDER:0,BUTTON:1},r=function(){this.extendedView&&this.extendedView.menuModel?this._delayPopupCreation&&this._delayPopupCreation.removeListeners.call():this._delayPopupCreation||h.call(this)},h=function(){var e=this;if(!this.elements.popup){var t={target:c.call(e),positionTarget:e.elements._button.elements.iconPlaceholder,position:"bottom",offset:{x:0,y:4},alignment:"near",className:"wux-controls-popup wux-controls-flyout-popup",constraint:"screen",overlap:!1,trigger:"click",usePaddingFlag:!1,getBody:function(){return e.getExtendedView()}};this._delayPopupCreation=s.delayPopupCreation(t,function(t){e.elements.popup=t})}},u=function(e){var t=this;if(!this._menuDisplayed){var i=this.getContent().getBoundingClientRect();o.show(e,{position:{x:i.left,y:i.top+i.height}},{onHide:function(){t._menuDisplayed=!1}}),this._menuDisplayed=!0}},c=function(){return this.displayMode===d.DISPLAY_MODE.EXPANDER?this.elements._expanderPickingDiv:this.elements._button},d=i.inherit({name:"flyout",publishedProperties:{label:{defaultValue:"",type:"string"},icon:{defaultValue:null,type:"string"},onClick:{defaultValue:null,type:"function",noNeedToApply:!0},showLabelFlag:{defaultValue:!1,type:"boolean"},type:{defaultValue:l.STANDARD,type:"DS/Controls/Flyout.TYPE"},checkFlag:{defaultValue:!1,type:"boolean"},extendedView:{defaultValue:null,type:"object"},getExtendedView:{defaultValue:function(){return this.extendedView},type:"function"},displayMode:{defaultValue:a.EXPANDER,type:"DS/Controls/Flyout.DISPLAY_MODE"},allowUnsafeHTMLLabel:{defaultValue:!1,type:"boolean"}},_extendedMode:void 0,isExtendedViewVisible:function(){switch(this._extendedMode){case void 0:return!1;case"menu":return this._menuDisplayed;case"popup":return void 0!==this.elements.popup&&this.elements.popup.visibleFlag}},showExtendedView:function(){var e=this.getExtendedView();if(this._needUpdatePopupBody&&(this._needUpdatePopupBody=!1,e))return e.menuModel?(u.call(this,e.menuModel),void(this._extendedMode="menu")):(this._extendedMode="popup",!this.elements.popup&&this._delayPopupCreation&&this._delayPopupCreation.createVisiblePopup.call(),void(this.elements.popup&&this.elements.popup.getBody()!==e&&this.elements.popup.setBody(e)));e&&e.menuModel?(this._extendedMode="menu",u.call(this,e.menuModel)):this.elements.popup&&(this._extendedMode="popup",this.elements.popup.visibleFlag=!0)},hideExtendedView:function(){this.elements.popup?this.elements.popup.visibleFlag=!1:function(){o.hide(),this._menuDisplayed=!1}.call(this)},_applyLabel:function(e){this.elements._button&&(this.elements._button.label=this.label)},_applyIcon:function(e){this.elements._button&&(this.elements._button.icon=this.icon)},_applyShowLabelFlag:function(e){this.showLabelFlag?this.elements.container.setAttributeNode(document.createAttribute("showlabel")):this.elements.container.removeAttribute("showlabel"),this.elements._button&&(this.elements._button.showLabelFlag=this.showLabelFlag)},_applyType:function(e){this.elements._button&&(this.elements._button.type=this.displayMode===d.DISPLAY_MODE.EXPANDER&&this.type===d.TYPE.CHECK?"check":"standard",this._applyCheckFlag())},_applyCheckFlag:function(){this.elements._button&&(this.elements._button.checkFlag="check"===this.elements._button.type&&this.checkFlag)},_applyExtendedView:function(e){this._needUpdatePopupBody=!0,r.call(this)},_applyGetExtendedView:function(e){this._needUpdatePopupBody=!0},_applyDisplayMode:function(e){this.displayMode===d.DISPLAY_MODE.EXPANDER?this.elements.container.setAttribute("displayMode","expander"):this.elements.container.setAttribute("displayMode","button"),this._applyType()},_applyAllowUnsafeHTMLLabel:function(e){this.elements._button&&(this.elements._button.allowUnsafeHTMLLabel=this.allowUnsafeHTMLLabel)},_applyTouchMode:function(){this._parent(),this.elements._button&&(this.elements._button.touchMode=this.touchMode)},_applyProperties:function(e){this._parent(e),this.elements._button&&(this.isDirty("label")||this.isDirty("icon")||this.isDirty("type")&&this.displayMode!==d.DISPLAY_MODE.BUTTON||this.isDirty("checkflag")&&this.type===d.TYPE.CHECK&&this.displayMode!==d.DISPLAY_MODE.BUTTON||this.isDirty("showLabelFlag")||this.isDirty("allowUnsafeHTMLLabel"))&&this.elements._button.setProperties({label:this.label,icon:this.icon,type:this.type,checkflag:this.checkflag,showLabelFlag:this.showLabelFlag,allowUnsafeHTMLLabel:this.allowUnsafeHTMLLabel}),this.isDirty("showLabelFlag")&&(this.showLabelFlag?this.elements.container.setAttributeNode(document.createAttribute("showlabel")):this.elements.container.removeAttribute("showlabel")),this.isDirty("displayMode")&&this._applyDisplayMode(e.displayMode),this.isDirty("touchMode")&&this._applyTouchMode(e.touchMode),(this.isDirty("getExtendedView")||this.isDirty("extendedView"))&&(this._needUpdatePopupBody=!0)},_preBuildView:function(e){this._parent(e),this.getContent().addClassName("wux-controls-flyout")},buildView:function(){this._parent(),this.elements._expanderPickingDiv=new e.Element("div",{class:"wux-controls-flyout-expander-picking"}).inject(this.elements.container),this.elements.container.setAttributeNode(document.createAttribute("displayMode")),this.elements._expanderDiv=new e.Element("div",{class:"wux-controls-flyout-expander"}).inject(this.elements._expanderPickingDiv),this.elements._button=null,this._needUpdatePopupBody=!0},_postBuildView:function(){this.elements._button=new n({label:this.label,icon:null!==this.icon?this.icon:void 0,type:this.displayMode===d.DISPLAY_MODE.EXPANDER&&this.type===d.TYPE.CHECK?"check":"standard",checkFlag:this.displayMode===d.DISPLAY_MODE.EXPANDER&&this.type===d.TYPE.CHECK&&this.checkFlag,showLabelFlag:this.showLabelFlag,allowUnsafeHTMLLabel:this.allowUnsafeHTMLLabel,emphasize:"secondary",displayStyle:"smartIcon",touchMode:this.touchMode}).inject(this.getContent());var e=this;t.addEventOnElement(this,this.elements._button,"buttonclick",function(t){t.stopPropagation(),e.displayMode===d.DISPLAY_MODE.EXPANDER&&e.onClick&&e.onClick()}),r.call(this)},destroy:function(){this._parent(),this.hideExtendedView()},_handleEvents:function(){this._parent();var e=this;t.addEventOnElement(this,this.elements._expanderPickingDiv,"click",function(t){t.stopPropagation(),function(){this.isExtendedViewVisible()?this.hideExtendedView():this.showExtendedView()}.call(e)})}});return d.DISPLAY_MODE=a,d.TYPE=l,d});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/Tooltip",["require","exports","UWA/Core","DS/Controls/Popup","DS/Utilities/Utils","DS/Controls/TooltipModel","DS/Core/WebUXComponents","DS/Core/TooltipManager","i18n!DS/Controls/assets/nls/translation.json"],function(e,t,i,n,s,o,l,a,r){"use strict";var h=!1;function u(e,t,n,s){this.set=function(e,t,i,n){this.left=Math.floor(e),this.top=Math.floor(t),this.right=Math.ceil(i),this.bottom=Math.ceil(n)},this.reset=function(){this.set(0,0,0,0)},this.isPositionInRZ=function(e,t){if(void 0===e||this.left===this.right&&this.top===this.bottom)return!1;var i=t||0;return e.x>=this.left-i&&e.x<=this.right+i&&e.y>=this.top-i&&e.y<=this.bottom+i},this._showReachingZone=function(e,t){var n=document.getElementById(e);if(!n){var s={id:e};n=i.createElement("div",s)}n.setStyle("position","absolute"),n.setStyle("top",this.top+"px"),n.setStyle("left",this.left+"px"),n.setStyle("width",this.right-this.left+"px"),n.setStyle("height",this.bottom-this.top+"px"),n.setStyle("border","1px solid "+t),n.setStyle("z-index","2147483647"),n.setStyle("pointer-events","none"),n.inject(document.body)},this._hideReachingZone=function(e){var t=document.getElementById(e);t&&t.remove()},this.applyOffset=function(e){e.x>0?this.left-=e.x:this.right-=e.x,e.y>0?this.top-=e.y:this.bottom-=e.y},this.set(e,t,n,s)}function c(){this.SHORT_HELP={minWidth:void 0,minHeight:void 0},this.LONG_HELP={minWidth:void 0,minHeight:void 0}}function d(){this.target&&(void 0===this.target.tooltipInfos||this.target.tooltipInfos&&this.target.tooltipInfos.isEmpty()||(function(){var e=this.target.tooltipInfos;if(!e)return;var t={"box-sizing":"content-box"};e.wrapPolicy===o.WrapPolicy.MULTILINE&&e.wrapThreshold>0?t["max-width"]=e.wrapThreshold:t["max-width"]="none";e._isLoadedFromHelpRscFile&&(t["white-space"]="normal");if(this.elements.container.setStyles(t),e.title&&void 0===this.elements.title){var n={class:"wux-tooltip-title"};s.getUnsafeHTMLContentValueToApply(e.allowUnsafeHTMLTitle)?n.html=e.title:n.text=e.title,this.elements.title=i.createElement("div",n),this.elements.title.setAttribute("title",e.title),this.elements.title.inject(this.elements.container)}e.shortHelp&&void 0===this.elements.shortHelp&&(n={class:"wux-tooltip-shortHelp"},s.getUnsafeHTMLContentValueToApply(e.allowUnsafeHTMLShortHelp)?n.html=e.shortHelp:n.text=e.shortHelp,this.elements.shortHelp=i.createElement("div",n),this.elements.shortHelp.setAttribute("shortHelp",e.shortHelp),this.elements.shortHelp.inject(this.elements.container));e.shortHelpImage&&void 0===this.elements.shortHelpImage&&(this.elements.shortHelpImage=i.createElement("img",{class:"wux-tooltip-shortHelpImage",src:e.shortHelpImage,width:e.shortHelpImageDimension.x,height:e.shortHelpImageDimension.y}),this.elements.shortHelpImage.inject(this.elements.container));e.longHelp&&void 0===this.elements.longHelp&&(n={class:"wux-tooltip-longHelp"},s.getUnsafeHTMLContentValueToApply(e.allowUnsafeHTMLLongHelp)?n.html=e.longHelp:n.text=e.longHelp,this.elements.longHelp=i.createElement("div",n),this.elements.longHelp.setAttribute("longHelp",e.longHelp),this.elements.longHelp.style.display="none",this.elements.longHelp.inject(this.elements.container));e.longHelpImage&&void 0===this.elements.longHelpImage&&(this.elements.longHelpImage=i.createElement("img",{class:"wux-tooltip-longHelpImage",src:e.longHelpImage,width:e.longHelpImageDimension.x,height:e.longHelpImageDimension.y}),this.elements.longHelpImage.style.display="none",this.elements.longHelpImage.inject(this.elements.container));if(void 0!==this.elements.longHelp||void 0!==this.elements.longHelpImage)if(this.target.tooltipInfos.shortHelp){var l=this;this.LONG_TO_SHOW_DELAY=setTimeout(function(){void 0!==l.elements.longHelp&&(l.elements.longHelp.style.display="block"),void 0!==l.elements.longHelpImage&&(l.elements.longHelpImage.style.display="block"),l._updateView(),l._isLongHelpVisible=!0},this.target.tooltipInfos.shortToLongDelay)}else void 0!==this.elements.longHelp&&(this.elements.longHelp.style.display="block"),void 0!==this.elements.longHelpImage&&(this.elements.longHelpImage.style.display="block");if(e._reachableState&&void 0===this.elements.moreHelp){this.elements.container.addClassName("wux-controls-tooltip-reachable");var n={class:"wux-tooltip-moreHelp"};s.getUnsafeHTMLContentValueToApply(e.allowUnsafeHTMLTitle)?n.html=r.moreHelp:n.text=r.moreHelp,this.elements.moreHelp=i.createElement("div",n),this.elements.moreHelp.setAttribute("moreHelp",r.moreHelp),this.elements.moreHelp.visibility="visible",this.elements.moreHelp.inject(this.elements.container)}}.call(this),this._parentShow(!0),this.target&&this.target.tooltipInfos._reachableState&&(this.elements.container.style.pointerEvents="auto"),this.RESHOW_FLAG=!0,clearTimeout(this.RESHOW_TIMER),this.RESHOW_TIMER=null))}function p(){clearTimeout(this.INITIAL_DELAY_TIMER),clearTimeout(this.LONG_TO_SHOW_DELAY),this._hasInitialTimerEnded=!1,this._isShortHelpVisible=!1,this._isLongHelpVisible=!1}var m=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return e.apply(this,t)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{}},enumerable:!1,configurable:!0}),t.prototype._preBuildView=function(t){e.prototype._preBuildView.call(this,t),this._properties.constraint.value="screen",this._properties.autoHide.value=!1,this._properties.position.value="bottom",this._properties.forceKeepOrientation.value=!0,this._isVisibilityManagedByPopupManager=!1,this.elements.container.addClassName("wux-controls-tooltip"),this.INITIAL_DELAY_TIMER=null,this.LONG_TO_SHOW_DELAY=null,this.RESHOW_TIMER=null,this.RESHOW_FLAG=!1,this._targetRZ=new u,this._tooltipRZ=new u,this._lastShowPosition={x:0,y:0},this._statesSize=new c},t.prototype._preInject=function(){var e=this.elements.container;e&&e.setStyles({left:"0px",top:"0px",visibility:"hidden"})},t.prototype._postInject=function(){var e=this.elements.container;if(e){var t=void 0,i=void 0;this._statesSize.SHORT_HELP.minWidth=e.getStyle("width"),this._statesSize.SHORT_HELP.minHeight=e.getStyle("height"),this.elements.longHelp&&(t=this.elements.longHelp.style.display,this.elements.longHelp.style.display="block"),this.elements.longHelpImage&&(i=this.elements.longHelpImage.style.display,this.elements.longHelpImage.style.display="block"),this._statesSize.LONG_HELP.minWidth=e.getStyle("width"),this._statesSize.LONG_HELP.minHeight=e.getStyle("height"),this.elements.longHelp&&(this.elements.longHelp.style.display=t),this.elements.longHelpImage&&(this.elements.longHelpImage.style.display=i)}},t.prototype.show=function(t){var n=this.target;if(n&&this.target.tooltipInfos){if(!this.visibleFlag)return n.tooltipInfos.setAllPropertiesFromAllInformationCB&&n.tooltipInfos.setAllPropertiesFromAllInformationCB(),(n.tooltipInfos.shortHelp||n.tooltipInfos.longHelp||n.tooltipInfos.shortHelpImage||n.tooltipInfos.longHelpImage||n.tooltipInfos.title)&&(this.visibleFlag=!0),this;(function(){var e=this.target;if(e){if(e.tooltipInfos.position&&(this.position=e.tooltipInfos.position),e.tooltipInfos.mouseRelativePosition)this.offset={x:15,y:15};else switch(e.tooltipInfos.position){case"top":this.offset={x:0,y:-1};break;case"bottom":this.offset={x:0,y:1};break;case"left":this.offset={x:-1,y:0};break;case"right":this.offset={x:1,y:0};break;default:this.offset={x:0,y:0}}this.mouseRelativePosition=e.tooltipInfos.mouseRelativePosition}}).call(this),function(){var e=this.target;if(e){var t=null,n=null;if(e.getBoundingClientRect){t=e.getBoundingClientRect();var s=i.extendElement(e);(n=s.getPosition(document.body)).x+=parseInt(s.getStyle("marginLeft"),10),n.y+=parseInt(s.getStyle("marginTop"),10)}else void 0!==e.getContent()&&(t=e.getContent().getBoundingClientRect(),(n=e.getContent().getPosition(document.body)).x+=parseInt(e.getContent().getStyle("marginLeft"),10),n.y+=parseInt(e.getContent().getStyle("marginTop"),10));this._targetRZ.set(n.x,n.y,n.x+t.width,n.y+t.height),e.tooltipInfos.mouseRelativePosition?this._tooltipRZ.set(Math.max(n.x,this._lastShowPosition.x-10),Math.max(n.y,this._lastShowPosition.y-10),this._targetRZ.right,this._targetRZ.bottom):this._tooltipRZ.set(0,0,0,0),h&&(this._targetRZ._showReachingZone("visual-target-reaching-zone","red"),this._tooltipRZ._showReachingZone("visual-old-tooltip-reaching-zone","blue"))}}.call(this),this._parentShow=e.prototype.show,this._setInitialTimer()}return this},t.prototype._setInitialTimer=function(){p.call(this);var e=this,t=a.touchMode||this.RESHOW_FLAG?0:this.target.tooltipInfos.initialDelay;this.INITIAL_DELAY_TIMER=setTimeout(function(){e._hasInitialTimerEnded=!0;var t={x:0,y:0};t.x=e.mousePosition.x+window.pageXOffset,t.y=e.mousePosition.y+window.pageYOffset,e._isShortHelpVisible=e.isPositionInRZ(t,"target")||e.touchMode||e.RESHOW_FLAG,e._isShortHelpVisible&&d.call(e)},t)},t.prototype.hide=function(t){if(this.visibleFlag)this.visibleFlag=!1;else{if(p.call(this),this.target&&void 0!==this.target.tooltipInfos){if(this.RESHOW_FLAG){var i=this;null!==this.RESHOW_TIMER&&(clearTimeout(this.RESHOW_TIMER),this.RESHOW_TIMER=null),this.RESHOW_TIMER=setTimeout(function(){i.RESHOW_FLAG=!1},this.target.tooltipInfos.reshowDelay)}this.target=void 0}(function(){this.elements.container&&(this.elements.container.empty(),this.elements.container.setStyles({minWidth:void 0,minHeight:void 0,whiteSpace:void 0}),this._statesSize=new c),this.elements.title=void 0,this.elements.shortHelp=void 0,this.elements.shortHelpImage=void 0,this.elements.longHelp=void 0,this.elements.longHelpImage=void 0,this.elements.moreHelp=void 0}).call(this),e.prototype.hide.call(this,t),this._targetRZ.reset(),this._tooltipRZ.reset(),h&&(this._targetRZ._hideReachingZone("visual-target-reaching-zone"),this._tooltipRZ._hideReachingZone("visual-old-tooltip-reaching-zone"),this._tooltipRZ._hideReachingZone("visual-new-tooltip-reaching-zone"))}},t.prototype.isShortHelpVisible=function(){return this.hasInitialTimerEnded()&&this._isShortHelpVisible},t.prototype.isLongHelpVisible=function(){return this.hasInitialTimerEnded()&&this._isLongHelpVisible},t.prototype.hasInitialTimerEnded=function(){return this._hasInitialTimerEnded},t.prototype.isPositionInRZ=function(e,t,i){return"target"===t?this._targetRZ.isPositionInRZ(e,i):"tooltip"===t&&this._tooltipRZ.isPositionInRZ(e,i)},t.prototype._updateView=function(){if(this.visibleFlag){var e=this.elements.container;if(e){var t="SHORT_HELP";(this.elements.longHelp&&"none"!==this.elements.longHelp.style.display||this.elements.longHelpImage&&"none"!==this.elements.longHelpImage.style.display)&&(t="LONG_HELP"),e.setStyles(this._statesSize[t])}s.setConstrainedPosition(this,this.target,{position:this.mouseRelativePosition?"bottom":this.position,alignment:this.alignment,offset:this.offset,constraint:this.constraint,overlap:this.overlap,mouseRelativePosition:this.mouseRelativePosition,mousePosition:this.mousePosition});var i=this.getContent().getBoundingClientRect(),n=void 0,o=!1;if(this.target&&this.target.tooltipInfos&&(o=this.target.tooltipInfos._reachableState,n=this.target.tooltipInfos.mouseRelativePosition),o&&(i.width>0||i.height>0)){var l=s.getOffset(this.getContent());n?this._tooltipRZ.set(Math.min(this._tooltipRZ.left,l.left),Math.min(this._tooltipRZ.top,l.top),Math.max(this._tooltipRZ.right,l.left+i.width),Math.max(this._tooltipRZ.bottom,l.top+i.height)):(this._tooltipRZ.set(l.left,l.top,l.left+i.width,l.top+i.height),this._tooltipRZ.applyOffset(this.offset)),h&&this._tooltipRZ._showReachingZone("visual-new-tooltip-reaching-zone","green")}e.style.visibility="visible",this.fire("wux-tooltip-updateview")}},t}(n);return l.addClass(m,"tooltip"),m});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/Toggle",["require","exports","UWA/Core","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Dom","DS/WebRecordEnabler/Adapter","DS/Utilities/Utils","DS/Core/WebUXComponents","DS/Utilities/WUXUWAUtils"],function(e,t,i,n,s,o,l,a,r,h){"use strict";var u=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var s=e.apply(this,t)||this;return h.extendingClassFlag?s:(s.addKeyMapsAndCommands({return:{keydown:"validate",keyup:"validate"},space:{keydown:"validate",keyup:"validate"}},{validate:function(e){if(this.disabled)return{stopPropagation:!1};var t={};if(1===this.clickMode&&"keydown"===e.type||0===this.clickMode&&"keyup"===e.type){t.actionPerformed=this.toggle();var n={ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,altKey:e.altKey};this.fire("buttonclick",n)}return"return"===i.Event.whichKey(e)?{stopPropagation:!1,infos:t}:{stopPropagation:!0,infos:t}}}),s)}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{type:{defaultValue:"checkbox",type:"string",category:"Behavior"},checkFlag:{defaultValue:!1,type:"boolean",category:"Behavior",recordFlag:!0},mixedState:{defaultValue:!1,type:"boolean",category:"Behavior"},label:{defaultValue:"",type:"string",category:"Appearance"},value:{defaultValue:void 0,type:"object",noNeedToApplyFlag:!0,category:"Behavior",recordFlag:!0},internalLabelsFlag:{defaultValue:!1,type:"boolean",category:"Appearance"},clickMode:{defaultValue:0,type:"integer",category:"Behavior"},multiSelFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},allowUnsafeHTMLLabel:{defaultValue:void 0,type:"boolean",category:"Behavior"},iconsReference:{defaultValue:[{value:"checked",icon:"check"},{value:"unchecked",icon:"wrong"},{value:"checked_mixed",icon:""},{value:"unchecked_mixed",icon:""}],type:"array",category:"behavior"},noContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){this.elements.container.classList.add("wux-controls-toggle"),this.elements.container.setAttribute("tabindex",0),this.elements.checkSign=i.createElement("div",{class:"wux-icon wux-ui-fa",tabindex:-1}),this.elements.checkSign.inject(this.elements.container),this.isMultiSelection=!1,this.preventTriggeringChangeEvent=!0},t.prototype._postBuildView=function(){this.preventTriggeringChangeEvent=!1},t.prototype.handleEvents=function(){var e=this;o.addEventOnElement(this,e.elements.container,"click",function(t){if(0===e.clickMode){if(e.disabled)return;e.callMethodFromUIInteraction("toggle");var i={ctrlKey:t.ctrlKey,shiftKey:t.shiftKey,altKey:t.altKey};e.fire("buttonclick",i)}}),o.addEventOnElement(this,e.elements.container,s.POINTERDOWN,function(t){if(1===e.clickMode){if(e.disabled)return;e.callMethodFromUIInteraction("toggle");var i={ctrlKey:t.ctrlKey,shiftKey:t.shiftKey,altKey:t.altKey};e.fire("buttonclick",i)}}),o.addEventOnElement(this,e.elements.container,s.POINTERHIT,function(t){2===t.multipleHitCount&&(e.disabled||e.fire("buttonDblClick"))}),o.addEventOnElement(this,this.elements.checkSign,"focus",function(t){e.elements.container.focus()})},t.prototype._applyType=function(){for(this.elements.checkSign.classList.remove(this._toggleIcon),this.elements.container.classList.remove("wux-controls-checkbox"),this.elements.container.classList.remove("wux-controls-radio"),this.elements.container.classList.remove("wux-controls-switch"),this.elements.container.classList.remove("wux-controls-toggle-icon"),this.elements.checkSign.classList.remove("wux-icon"),this.elements.checkSign.classList.remove("wux-ui-fa");this.elements.checkSign.children.length>0;)this.elements.checkSign.children[0].destroy();"checkbox"===this.type?(this._toggleIcon="wux-ui-fa-check",this.elements.container.classList.add("wux-controls-checkbox"),this.elements.checkSign.addClassName("wux-ui-fa wux-icon")):"radio"===this.type?(this._toggleIcon="wux-controls-radio-on",this.elements.container.classList.add("wux-controls-radio"),this.elements.checkSign.classList.add("wux-icon"),this.elements.checkSign.classList.add("wux-ui-fa")):"switch"===this.type?(this.elements.checkSign.classList.add("wux-ui-fa"),this.elements.innerSwitch=i.createElement("div",{class:"wux-controls-toggle-switch-inner"}),this.elements.labelSwitch1=i.createElement("div",{class:"wux-controls-toggle-switch-label wux-controls-toggle-switch-label-left"}),this.elements.buttonSwitch=i.createElement("div",{class:"wux-controls-toggle-switch-button"}),this.elements.labelSwitch2=i.createElement("div",{class:"wux-controls-toggle-switch-label wux-controls-toggle-switch-label-right"}),this.elements.innerSwitch.inject(this.elements.checkSign),this.elements.labelSwitch1.inject(this.elements.innerSwitch),this.elements.buttonSwitch.inject(this.elements.innerSwitch),this.elements.labelSwitch2.inject(this.elements.innerSwitch),this._toggleIcon="wux-controls-switch-on",this.elements.container.classList.add("wux-controls-switch"),this.elements.innerSwitch.classList.add("wux-controls-toggle-switch-inner")):"toggleIcon"===this.type&&this.elements.container.classList.add("wux-controls-toggle-icon"),this._setState(),this._applyInternalLabelsFlag()},t.prototype._applyLabel=function(){if(""===this.label&&this.elements.label)this.elements.label.destroy();else if(""!==this.label){if(!this.elements.label){this.elements.label=i.createElement("label",{class:"wux-label",tabindex:-1}),this.elements.label.inject(this.elements.container);var e=this;o.addEventOnElement(this,this.elements.label,"focus",function(t){e.elements.container.focus()})}a.getUnsafeHTMLContentValueToApply(this.allowUnsafeHTMLLabel)?this.elements.label.setHTML(this.label):this.elements.label.setText(this.label)}},t.prototype._applyAllowUnsafeHTMLLabel=function(){this._applyLabel()},t.prototype._applyCheckFlag=function(){this._setState()},t.prototype._applyDisabled=function(){e.prototype._applyDisabled.call(this),!0===this.disabled?(this.elements.container.setAttribute("tabindex",-1),this.elements.checkSign.disabled=this.disabled):this.elements.container.setAttribute("tabindex",0)},t.prototype._applyMixedState=function(){this._setState()},t.prototype._applyInternalLabelsFlag=function(){!0===this.internalLabelsFlag&&"switch"===this.type?this.elements.labelSwitch1&&this.elements.labelSwitch2&&(this.elements.labelSwitch1.setHTML("l"),this.elements.labelSwitch2.setHTML("O")):this.elements.labelSwitch1&&this.elements.labelSwitch2&&(this.elements.labelSwitch1.setHTML(""),this.elements.labelSwitch2.setHTML(""))},t.prototype._applyIconsReference=function(){for(var e=this.iconsReference,t=0;t<e.length;t++)"checked"===e[t].value?this._iconChecked=null==e[t].icon?"check":e[t].icon:"unchecked"===e[t].value?this._iconUnchecked=null==e[t].icon?"wrong":e[t].icon:"checked_mixed"===e[t].value?this._iconCheckedMixed=null==e[t].icon?"":e[t].icon:"unchecked_mixed"===e[t].value&&(this._iconUncheckedMixed=null==e[t].icon?"":e[t].icon);this._setState()},t.prototype._setState=function(){if("toggleIcon"===this.type){if(this.elements.checkSign.className="",this.mixedState)return o.generateIcon(this.checkFlag?this._iconCheckedMixed:this._iconUncheckedMixed,{target:this.elements.checkSign}),void this.elements.checkSign.addClassName("wux-ui-genereatedicon-fi wux-ui-3ds");!0===this.checkFlag?this.elements.container.setAttributeNode(document.createAttribute("checked")):this.elements.container.removeAttribute("checked"),o.generateIcon(this.checkFlag?this._iconChecked:this._iconUnchecked,{target:this.elements.checkSign}),(this.checkFlag?this._iconChecked:void 0!==this._iconUnchecked&&!o.isFontIcon(this.checkFlag?this._iconChecked:this._iconUnchecked))?this.elements.container.addClassName("wux-contains-richIcon"):this.elements.container.removeClassName("wux-contains-richIcon")}else!0===this.checkFlag?(this.elements.container.setAttributeNode(document.createAttribute("checked")),this.mixedState||this.elements.checkSign.classList.add(this._toggleIcon),this.multiSelFlag&&this.isMultiSelection||this._uncheckSiblings()):(this.elements.checkSign.classList.remove(this._toggleIcon),this.elements.container.removeAttribute("checked"));this.mixedState?(this.elements.checkSign.classList.remove(this._toggleIcon),this.elements.checkSign.classList.add("wux-toggle-mixed-icon")):(this.elements.checkSign.classList.remove("wux-toggle-mixed-icon"),this.checkFlag&&this.elements.checkSign.classList.add(this._toggleIcon)),this.preventTriggeringChangeEvent||this.fire("change")},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("type")&&this._applyType(),(this.isDirty("label")||this.isDirty("allowUnsafeHTMLLabel"))&&this._applyLabel(),this.isDirty("checkFlag")&&this._applyCheckFlag(),this.isDirty("mixedState")&&this._applyMixedState(),this.isDirty("internalLabelsFlag")&&this._applyInternalLabelsFlag(),this.isDirty("iconsReference")&&"toggleIcon"===this.type&&this._applyIconsReference()},t.prototype._giveFocus=function(){this._isFocused()||(e.prototype._giveFocus.call(this),this.elements.container.focus())},t.prototype.toggle=function(){return"checkbox"===this.type||"switch"===this.type||"toggleIcon"===this.type?(!0===this.mixedState?this.mixedState=!1:this.checkFlag=!this.checkFlag,!0):"radio"===this.type?!0===this.mixedState?(this.mixedState=!1,this.checkFlag=!0,!0):!1===this.checkFlag&&(this.checkFlag=!0,!0):void 0},t.prototype._uncheckSiblings=function(){if("radio"===this.type){var e=this.elements.container.parentNode;if(e){e.dsModel&&"buttonGroup"===e.dsModel.__proto__.name&&(e.dsModel.preventTriggeringChangeEvent=!0);for(var i=e.childNodes,n=0;n<i.length;n++)i[n]!==this.elements.container&&i[n].dsModel&&i[n].dsModel instanceof t&&"radio"===i[n].dsModel.type&&(i[n].dsModel.checkFlag=!1,i[n].dsModel.mixedState=!1);e.dsModel&&"buttonGroup"===e.dsModel.__proto__.name&&(e.dsModel.preventTriggeringChangeEvent=!1)}}},t}(n);return r.addClass(u,"toggle"),u.prototype.markForRecordFlag=!0,l.register(u,"DS/ControlsRec/AbstractRec"),u}),define("DS/Controls/SelectionChips",["UWA/Core","UWA/Utils","DS/Utilities/Utils","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Menu/ContextualMenu","DS/Controls/TooltipModel","DS/UIBehaviors/DragAndDropManager","i18n!DS/Controls/assets/nls/translation"],function(e,t,i,n,s,o,l,a,r,h){"use strict";var u=!1;function c(){this._preventEventsCpt++}function d(){this._preventEventsCpt--}function p(e){var t=!1;this._items.forEach(function(e){var i=e.associatedChipCellView;e.isSelected?i.isHighlighted||(i.isHighlighted=!0,t=!0,i.addClassName("wux-ui-state-highlighted")):i.isHighlighted&&(i.isHighlighted=!1,t=!0,i.removeClassName("wux-ui-state-highlighted"))}),t&&0===this._preventEventsCpt&&this.fire("selectionChange")}function m(e,t){return e=e||window.event,function(e,t){var i=t.currentStyle||window.getComputedStyle(t,null),n=parseInt(i.borderLeftWidth,10),s=t.getBoundingClientRect();return e.clientX-n-s.left}.call(this,e,t)<1*t.getDimensions().width/3?"left":"right"}function g(t){var i=this,n={dragstart:"onDragStart",dragend:"onDragEnd",dragenter:"onDragEnter",dragleave:"onDragLeave",drag:"onDrag",dragover:"onDragOver",drop:"onDrop"}[t.type];function s(e,n){var s=!0,o=i[e+n];if(o?(s=o.call(i,t,i._currentDnDInfos),u&&"onDragOver"!==e&&window.console.info("[dnd]",e+n,">",s,t.target)):u&&window.console.warn("[dnd]","cannot find",e+n,"callback"),s){var l=i[e+n+"Default"];l&&(u&&(o&&s?window.console.info("\t>[dnd]","dev want to continue to the default behavior for ",e+n," callback"):window.console.info("\t>[dnd]","use the default behavior for ",e+n," callback")),l.call(i,t,i._currentDnDInfos))}}"dragstart"!==t.type&&"dragover"!==t.type&&"dragenter"!==t.type&&"dragleave"!==t.type&&"drop"!==t.type||(this._currentDnDInfos=function(e){var t={chipCellView:void 0,dropPosition:""};if(t.chipCellView=o.firstParentWithClass(e.target,"wux-chip-cell-container"),void 0===t.chipCellView){let i=e.clientX,n=e.clientY,s=[{x:i,y:n-3},{x:i,y:n+3},{x:i-3,y:n},{x:i+3,y:n}];for(let e=0;e<s.length;e++){let i=document.elementFromPoint(s[e].x,s[e].y),n=o.firstParentWithClass(i,"wux-chip-cell-container");if(n){t.chipCellView=n;break}}}return!t.chipCellView||"dragstart"!==e.type&&"dragover"!==e.type&&"dragenter"!==e.type&&"dragleave"!==e.type&&"drop"!==e.type||(t.dropPosition=m.call(this,e,t.chipCellView)),t}.call(this,t)),"dragend"===t.type||"drop"===t.type?(f.call(this),_.call(this)):"dragleave"===t.type?function(){let e=this;this._delayedUnhighlightCB=setTimeout(function(){_.call(e)},30)}.call(this):"drag"!==t.type&&(function(){this._delayedUnhighlightCB&&(clearTimeout(this._delayedUnhighlightCB),this._delayedUnhighlightCB=void 0)}.call(this),function(t){this.elements.dndSeparator||(this.elements.dndSeparator=new e.Element("span",{class:"wux-chip-cell-drop-feedback"}));if(this._currentDnDInfos)if(this._currentDnDInfos.chipCellView){var i=this._currentDnDInfos.dropPosition;if("left"===i)this.elements.dndSeparator.nextSibling!==this._currentDnDInfos.chipCellView&&(this.elements.dndSeparator.inject(this._currentDnDInfos.chipCellView,"before"),this.elements.dndSeparator.offsetTop!==this._currentDnDInfos.chipCellView.offsetTop&&(this._nextChipIsFirstInLine&&this._nextChipIsFirstInLine!==this._currentDnDInfos.chipCellView&&f.call(this),y.call(this,this._currentDnDInfos.chipCellView)));else if("right"===i&&this._currentDnDInfos.chipCellView.nextSibling!==this.elements.dndSeparator){let e=this._currentDnDInfos.chipCellView.nextSibling;this.elements.dndSeparator.inject(this._currentDnDInfos.chipCellView,"after"),e&&this.elements.dndSeparator.offsetTop!==e.offsetTop&&(this._nextChipIsFirstInLine&&this._nextChipIsFirstInLine!==e&&f.call(this),y.call(this,e))}}else this.elements.dndSeparator.inject(this.getContent())}.call(this,t)),this._currentDnDInfos.chipCellView?s(n,"Cell"):s(n,"Blank")}function v(){this.__cachedCanBeDraggedFrom=void 0,this.__cachedCanBeDroppedTo=void 0}function f(){this._nextChipIsFirstInLine&&this._nextChipIsFirstInLine.classList.remove("wux-selectionchips-firstOfLine")}function y(e){this._nextChipIsFirstInLine=e,this._nextChipIsFirstInLine.classList.add("wux-selectionchips-firstOfLine")}function b(e){this.elements.dndSeparator&&(e?this.elements.dndSeparator.setAttribute("drop-acceptated","true"):void 0===e?this.elements.dndSeparator.setAttribute("drop-acceptated","unknown"):this.elements.dndSeparator.setAttribute("drop-acceptated","false"))}function _(){this.elements.dndSeparator&&this.elements.dndSeparator.remove()}function C(t){var i={chipOptions:t,isSelected:!1,associatedChipCellView:void 0},n=function(t){var i=this,n=new e.Element("div",{class:"wux-chip-cell-container"});n.isHighlighted=!1,n.associatedModelItem=t;var l=o.generateIcon(t.chipOptions.icon,t.chipOptions._iconOptions);l&&(l.setStyles({height:"12px",width:"12px","line-height":"13px","margin-right":void 0===t.chipOptions.label?"8px":""}),n.appendChild(l)),n.label=void 0,void 0!==t.chipOptions.label&&(n.label=new e.Element("li",{class:"wux-chip-cell-label",text:t.chipOptions.label}),n.appendChild(n.label));var r=new e.Element("li",{class:"wux-chip-cell-close wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-close"});n.tooltipInfos=new a({getAllInformationCB:function(){return void 0!==n.label&&n.label.offsetWidth-15<Math.round(o.computeStringWidth(t.chipOptions.label,i._getCurrentTouchMode()?14:12,"Arial"))?{model:{updateModel:!0,shortHelp:t.chipOptions.label}}:{model:{updateModel:!0}}}}),n.appendChild(r);var h=!0;return o.addEventOnElement(i,n,s.POINTERDOWN,function(e){h=t.isSelected,t.isSelected||(i._modifierKeysPressed=e.ctrlKey||e.shiftKey,i.selectChip(t),i._modifierKeysPressed=!1)}),o.addEventOnElement(i,n,s.POINTERUP,function(e){h&&t.isSelected&&(i._modifierKeysPressed=e.ctrlKey||e.shiftKey,i.unselectChip(t),i._modifierKeysPressed=!1)}),o.addEventOnElement(i,n,"mouseenter",function(e){h=!1,n.addClassName("wux-ui-state-prehighlighted")}),o.addEventOnElement(i,n,"mouseleave",function(e){n.removeClassName("wux-ui-state-prehighlighted")}),o.addEventOnElement(i,r,s.POINTERDOWN,function(e){e.preventDefault(),e.stopPropagation()}),o.addEventOnElement(i,r,s.POINTERUP,function(e){let n=i._items.findIndex(e=>e.associatedChipCellView===t.associatedChipCellView);i.removeChip(n)}),n.setAttribute("draggable","true"),n}.call(this,i);return i.associatedChipCellView=n,{modelItem:i,chipCellView:n}}function w(e,t){if(e._uuid===t)return e;{let e=i.getDocumentOwner().body.getElementsByClassName("wux-controls-selectionChips");for(let i=0;i<e.length;i++)if(e[i].dsModel.getUUID()===t)return e[i].dsModel}}function x(e,t){let i;return i=e.chipCellView?JSON.stringify(t)+"_"+e.chipCellView.associatedModelItem.chipOptions.id+"_"+e.dropPosition:this._items&&this._items.length>0?JSON.stringify(t)+"_"+this._items[this._items.length-1].chipOptions.id+"_right":JSON.stringify(t)+"_blank_"+e.dropPosition}async function E(e,t){var i=this;let n=r.getGlobalData();if(n&&n.sourceSelectionChipUUID){this._cachedDndTimeStamp&&this._cachedDndTimeStamp!==n.timestamp&&v.call(this),this._cachedDndTimeStamp=n.timestamp;let s,o=!0,l=x.call(this,t,n),a=w(this,n.sourceSelectionChipUUID);if(n.sourceSelectionChipUUID!==this.getUUID())if(_.call(a),this.__cachedCanBeDraggedFrom||(this.__cachedCanBeDraggedFrom={}),e.ctrlKey)o=!0,this.__cachedCanBeDraggedFrom[l]=o;else{if(this.__cachedCanBeDraggedFrom.hasOwnProperty(l)){return void(this.__cachedCanBeDraggedFrom[l]?(e.preventDefault(),e.dataTransfer.dropEffect=e.ctrlKey?"copy":"move"):e.dataTransfer.dropEffect="none")}e.dataTransfer.dropEffect="move",b.call(i,void 0),e.preventDefault(),o=!!a.acceptDrop&&a.acceptDrop.call(a,{sourceSelectionChips:a,targetSelectionChips:this,dndInfos:t}),this.__cachedCanBeDraggedFrom[l]=o}if(this.__cachedCanBeDroppedTo||(this.__cachedCanBeDroppedTo={}),this.__cachedCanBeDroppedTo.hasOwnProperty(l)){return void(this.__cachedCanBeDroppedTo[l]?(e.preventDefault(),e.dataTransfer.dropEffect=e.ctrlKey?"copy":"move"):e.dataTransfer.dropEffect="none")}e.dataTransfer.dropEffect=e.ctrlKey?"copy":"move",b.call(i,void 0),e.preventDefault(),s=n.sourceSelectionChipUUID===this.getUUID()||!!this.acceptDrop&&this.acceptDrop.call(a,{sourceSelectionChips:a,targetSelectionChips:this,dndInfos:t}),this.__cachedCanBeDroppedTo[l]=s,Promise.all([o,s]).then(function(t){if(i.__cachedCanBeDraggedFrom&&(i.__cachedCanBeDraggedFrom[l]=t[0]),i.__cachedCanBeDroppedTo&&(i.__cachedCanBeDroppedTo[l]=t[1]),!t[0]||!t[1])return e.dataTransfer.dropEffect="none",void b.call(i,!1);e.dataTransfer.dropEffect=e.ctrlKey?"copy":"move",b.call(i,!0)})}else e.preventDefault(),b.call(this,!0)}async function S(e,t){var i=!1,n=function(e){var t=e.dataTransfer.getData("Text");try{return JSON.parse(t)}catch(e){window.console.warn('the element being in dataTransfer type "text" is not parsable usable JSON.parse')}}.call(this,e);let s=r.getGlobalData();if(s&&s.sourceSelectionChipUUID&&s.sourceSelectionChipUUID!==this.getUUID()){let e=x.call(this,t,s),i=this.__cachedCanBeDraggedFrom[e],n=this.__cachedCanBeDroppedTo[e],o=await Promise.all([i,n]).then(function(e){return!(!e[0]||!e[1])});if(v.call(this),!o)return}c.call(this);let o=[];if(n){var l=n.source?n.source.uuid:void 0,a=t.chipCellView?t.chipCellView.associatedModelItem:void 0;if(this._uuid!==l||!a||!a.isSelected){var h=n.data["dswebux/x-controls.selectionchips.items+json"],u=t.dropPosition,m=this;let s=w(m,l);if(s&&!e.ctrlKey){let e=[];for(var g=0;g<s._items.length;g++)s._items[g].isSelected&&e.push(g);e.sort(function(e,t){return e>t?-1:1}),s.removeChips(e)}if(h){var f=this._items.indexOf(a),y=void 0;"left"===u?y=-1!==f?f:0:"right"===u&&(y=-1!==f?f+1:0),h.forEach(function(e){i=!0,m._onDragAndDropFlag=!0,m._lastWidgetDiv.children.length>0&&void 0===y?e.index=m._items.length:(e.index=y,Number.isInteger(y)&&y++);var t=m.addChip(e);t.isSelected=!0,o.push(t),m._onDragAndDropFlag=!1}),p.call(this)}}}d.call(this),i&&0===this._preventEventsCpt&&(this.fire("change"),this.fire("onPostAdd",{chips:o}))}var D=n.inherit({publishedProperties:{selection:{defaultValue:{toggle:!0,mode:2,unselectAllOnEmptyArea:!0},type:"object",category:"Behavior",noNeedToApplyFlag:!0},placeholder:{defaultValue:"",type:"string",category:"Appearance"},displayMenu:{defaultValue:!0,type:"boolean",category:"Appearance"},identifier:{defaultValue:void 0,type:"string",readOnly:!0,category:"Behavior"},acceptDrop:{defaultValue:void 0,type:"function",category:"Behavior",noNeedToApplyFlag:!0},onDragStartCell:{defaultValue:void 0,type:"function",category:"Behavior",noNeedToApplyFlag:!0},onDragEndCell:{defaultValue:void 0,type:"function",category:"Behavior",noNeedToApplyFlag:!0},onDragOverCell:{defaultValue:void 0,type:"function",category:"Behavior",noNeedToApplyFlag:!0},onDragEnterCell:{defaultValue:void 0,type:"function",category:"Behavior",noNeedToApplyFlag:!0},onDragLeaveCell:{defaultValue:void 0,type:"function",category:"Behavior",noNeedToApplyFlag:!0},onDropCell:{defaultValue:void 0,type:"function",category:"Behavior",noNeedToApplyFlag:!0},onDropBlank:{defaultValue:void 0,type:"function",category:"Behavior",noNeedToApplyFlag:!0},onDragLeaveBlank:{defaultValue:void 0,type:"function",category:"Behavior",noNeedToApplyFlag:!0},onDragOverBlank:{defaultValue:void 0,type:"function",category:"Behavior",noNeedToApplyFlag:!0},onDragEnterBlank:{defaultValue:void 0,type:"function",category:"Behavior",noNeedToApplyFlag:!0}},_build:function(){this._parent(),this._uuid=t.getUUID(),this._preventEventsCpt=0,this.elements.container.addClassName("wux-controls-selectionChips"),this._placeholderDiv=new e.Element("div",{class:"wux-controls-placeholder-selectionChips",text:this.placeholder}).inject(this.elements.container),this._lastWidgetDiv=new e.Element("div",{class:"wux-controls-lastWidget-selectionChips"}),this._items=[],this._onDragAndDropFlag=!1},handleEvents:function(){var e=this,t=g.bind(this);o.addEventOnElement(this,this.getContent(),"dragstart",t),o.addEventOnElement(this,this.getContent(),"drop",t),o.addEventOnElement(this,this.getContent(),"dragover",t),o.addEventOnElement(this,this.getContent(),"drag",t),o.addEventOnElement(this,this.getContent(),"dragend",t),o.addEventOnElement(this,this.getContent(),"dragleave",t),o.addEventOnElement(this,this.getContent(),"dragenter",t),l.addEventListener(this.getContent(),{callback:function(t){if(!(e.disabled||t.data.target&&"input"===t.data.target.tagName.toLowerCase()))return[{type:"PushItem",title:h.get("clearAll"),action:{callback:function(){o.pushUserInteractionContext(),e.removeAllChips(),o.popUserInteractionContext()}}}]}}),o.addEventOnElement(this,this.getContent(),s.POINTERDOWN,function(t){e.selection.unselectAllOnEmptyArea&&-1===t.target.className.indexOf("wux-chip-cell-container")&&-1===t.target.className.indexOf("wux-chip-cell-label")&&-1===t.target.className.indexOf("wux-chip-cell-close")&&e.unselectAllChips(!0)}),this._modifierKeysPressed=!1},isInMultiSelection:function(){return this.selection.mode===D.SELECTION_MODE.MULTIPLE||this.selection.mode===D.SELECTION_MODE.MULTIPLE_ONKEYS&&this._modifierKeysPressed},_applyPlaceholder:function(e){this._placeholderDiv.setText(this.placeholder)},_applyDisplayMenu:function(t){if(t!==this.displayMenu){var i=this;this.elements.container.removeAttribute("has-menu"),this._clearAllDiv&&(this._clearAllDiv.remove(),this._clearAllDiv.destroy(),this._clearAllDiv=null),this.displayMenu&&(this._clearAllDiv=new e.Element("div",{class:"wux-controls-clear-selectionChips wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-menu-dot"}),this._clearAllDiv.tooltipInfos=new a({shortHelp:""}),this._clearAllDiv.inject(this.elements.container),o.addEventOnElement(this,this._clearAllDiv,"click",function(e){e.stopPropagation();var t=document.createEvent("HTMLEvents");t.initEvent("contextmenu",!0,!1),t.pageX=e.pageX,t.pageY=e.pageY,i.getContent().dispatchEvent(t)}),this.elements.container.setAttribute("has-menu",!0))}},_applyProperties:function(e){this._parent(e),this.isDirty("identifier")&&this._applyIdentifier(e.identifier),this.isDirty("placeholder")&&this._applyPlaceholder(e.placeholder),this.isDirty("displayMenu")&&this._applyDisplayMenu(e.displayMenu)},getUUID:function(){return this._uuid},_applyIdentifier:function(e){this.identifier?this.getContent().setAttribute("wux-identifier",this.identifier):this.getContent().removeAttribute("wux-identifier")},_flashEffectOnChip:function(e,t){0<=t&&t<this._items.length&&(this._items[t].associatedChipCellView.classList.add(e),this._items[t].associatedChipCellView.addEventListener("animationend",function(t){t.target.classList.remove(e)}))},selectChip:function(e){var t=void 0;"string"==typeof e?this._items.some(function(i){return i.chipOptions.label===e&&(t=i,!0)}):"number"==typeof e?e>=0&&e<this._items.length&&(t=this._items[e]):t=e,void 0!==t&&(this.isInMultiSelection()||this._items.forEach(function(e){e.isSelected=!1}),t.isSelected=!0,p.call(this))},selectAllChips:function(){this.isInMultiSelection()&&(this._items.forEach(function(e){e.isSelected=!0}),p.call(this))},unselectChip:function(e){if(this.selection.toggle||this.isInMultiSelection()){var t=void 0;"string"==typeof e?this._items.some(function(i){return i.chipOptions.label===e&&(t=i,!0)}):"number"==typeof e?e>=0&&e<this._items.length&&(t=this._items[e]):t=e,void 0!==t&&(t.isSelected=!1,p.call(this))}},unselectAllChips:function(){(this.selection.toggle||this.isInMultiSelection()||arguments||arguments[0])&&(this._items.forEach(function(e){e.isSelected=!1}),p.call(this))},addChip:function(e){if(e){var t=void 0;if("string"==typeof e?t={label:e}:"object"==typeof e&&(t=Object.assign({},e)),t&&(void 0===t.index&&(t.index=this.elements.container.children.length),!(t.index<0||t.index>this.elements.container.children.length+1))){var i=C.call(this,t);if(this._items.splice(t.index,0,i.modelItem),this._placeholderDiv.remove(),t.index===this.elements.container.children.length)this.elements.container.appendChild(i.chipCellView);else{let e=this.displayMenu?t.index+1:t.index;this.elements.container.insertBefore(i.chipCellView,this.elements.container.children[e])}return this._lastWidgetDiv.children.length>0&&!this._onDragAndDropFlag&&this.elements.container.appendChild(this._lastWidgetDiv),this._addMultipleChips||0===this._preventEventsCpt&&(this.fire("change"),this.fire("onPostAdd",{chips:[i.modelItem]})),i.modelItem}}},addChips:function(e){if(e){this._addMultipleChips=!0;for(var t=void 0,i=0;i<e.length;i++)"string"==typeof e[i]?t={label:e[i]}:"object"==typeof e[i]&&(t=Object.assign({},e[i])),this.addChip({label:t.label,value:t.value,icon:t.icon,_iconOptions:t._iconOptions,id:t.id,index:t.index});0===this._preventEventsCpt&&(this.fire("change"),this.fire("onPostAdd",{chips:e})),this._addMultipleChips=!1}},addLastWidget:function(e){e&&(this._placeholderDiv&&this._placeholderDiv.remove(),this.elements.container.appendChild(this._lastWidgetDiv),this._lastWidgetDiv.setContent(e))},removeLastWidget:function(){this._lastWidgetDiv.children.length&&this._lastWidgetDiv.removeChild(this._lastWidgetDiv.firstChild)},removeChip:function(e){var t=!1,i=void 0;if("string"==typeof e){var n=this;this._items.some(function(s,o){return s.chipOptions.label===e&&(n._items.splice(o,1),n.elements.container.removeChild(s.associatedChipCellView),i=s,t=!0,!0)})}else if("number"==typeof e){if(e>=0&&e<this._items.length){var s=this._items.splice(e,1)[0];this.elements.container.removeChild(s.associatedChipCellView),i=s,t=!0}}else if("object"==typeof e&&void 0!==e){n=this;let s=Object.keys(e);if(s.length<1)return;let o=s[0];this._items.some(function(s,l){return s.chipOptions[o]===e[o]&&(n._items.splice(l,1),n.elements.container.removeChild(s.associatedChipCellView),i=s,t=!0,!0)})}return 0===this._items.length&&0==this._lastWidgetDiv.children.length&&(this._clearAllDiv?this.getContent().insertBefore(this._placeholderDiv,this._clearAllDiv):this.getContent().appendChild(this._placeholderDiv)),t&&0===this._preventEventsCpt&&(this.fire("change"),this.fire("onPostRemove",{chips:[i]})),i},removeChips:function(e){if(e.length>0){let i=[];c.call(this);for(var t=0;t<e.length;t++)i.push(this.removeChip(e[t]));d.call(this),0===this._preventEventsCpt&&(this.fire("change"),this.fire("onPostRemove",{chips:i}))}},removeAllChips:function(){if(!(!this._items.length>0)){var e=this._items;this._items=[],this.getContent().empty(),this._placeholderDiv.inject(this.getContent()),this._applyDisplayMenu(),0!==this._lastWidgetDiv.children.length&&this._lastWidgetDiv.inject(this.getContent()),0===this._preventEventsCpt&&(this.fire("change"),this.fire("onPostRemove",{chips:e,allChipsRemoved:!0}))}},updateChipOptions:function(t,i){var n=!1;if(void 0!==t&&i){var s=void 0;if("string"==typeof i?s={label:i}:"object"==typeof i&&(s=Object.assign({},i)),s){var o=void 0;if("string"==typeof t?this._items.some(function(e,i){return e.chipOptions.label===t&&(o=e,!0)}):"number"==typeof t&&t>=0&&t<this._items.length&&(o=this._items[t]),void 0!==o){var l=o.chipOptions;e.merge(s,l),o.chipOptions=s;n=!1;l.label!==s.label&&(o.associatedChipCellView.label.textContent=s.label,n=!0),l.icon,s.icon,l.index!==s.index&&(this._items.splice(l.index,1),o.associatedChipCellView.remove(),this._items.splice(s.index,0,o),this.elements.container.insertBefore(o.associatedChipCellView,this.elements.container.children[s.index+1]),n=!0),n&&0===this._preventEventsCpt&&this.fire("change")}}}},getChipLabel:function(e){return e>=0&&e<this._items.length?this._items[e].chipOptions.label:""},getChipPosition:function(e){var t=-1;return this._items.some(function(i,n){return i.chipOptions.label===e&&(t=n,!0)}),t},getAllChipsOptions:function(){var e=[];return this._items.forEach(function(t){e.push(Object.assign({},t.chipOptions))}),e},getAllChipsAsLabels:function(){var e=[];return this._items.forEach(function(t){e.push(t.chipOptions.label)}),e},getSelectedChipsOptions:function(){var e=[];return this._items.forEach(function(t){t.isSelected&&e.push(Object.assign({},t.chipOptions))}),e},getNumberOfChips:function(e){if(e){var t=0;return this._items.forEach(function(e){e.isSelected&&t++}),t}return this._items.length},onDragStartCellDefault:function(t,i){var n=[];this._items.forEach(function(e){e.isSelected&&("object"==typeof e.chipOptions.value&&(e.chipOptions.value=e.chipOptions.value._options.value),n.push(e.chipOptions))}),function(t,i){i=e.extend({source:{uuid:this._uuid,amd:"DS/Controls/SelectionChips"},data:{"dswebux/x-controls.selectionchips.data+json":""}},i),t.dataTransfer.setData("Text",JSON.stringify(i))}.call(this,t,{data:{"dswebux/x-controls.selectionchips.items+json":n}}),t.dataTransfer.effectAllowed="copyMove",r.storeGlobalData({sourceSelectionChipUUID:this.getUUID(),draggedItems:n,timestamp:Date.now()})},onDragEndCellDefault:function(e,t){},onDragOverCellDefault:function(e,t){E.call(this,e,t)},onDragEnterCellDefault:function(e,t){e.preventDefault()},onDragLeaveCellDefault:function(e,t){return!0},onDropCellDefault:function(e,t){e.preventDefault(),S.call(this,e,t)},onDropBlankDefault:function(e,t){S.call(this,e,t)},onDragLeaveBlankDefault:function(e,t){},onDragOverBlankDefault:function(e,t){E.call(this,e,t)},onDragEnterBlankDefault:function(e,t){e.preventDefault()}});return D.SELECTION_MODE={SINGLE:0,MULTIPLE:1,MULTIPLE_ONKEYS:2},D});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/AbstractEditor",["require","exports","UWA/Core","DS/Controls/Abstract","DS/Core/WebUXComponents","DS/Utilities/WUXUWAUtils"],function(e,t,i,n,s,o){"use strict";var l=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return o.extendingClassFlag,n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{requiredFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},placeholder:{defaultValue:"",type:"string",category:"Appearance"},value:{defaultValue:"",type:"string",category:"Behavior",recordFlag:!0},valueToCommit:{defaultValue:"",type:"string",category:"Behavior"},validFlag:{defaultValue:!0,type:"boolean",readOnly:!0,category:"Appearance"},selectAllOnFocus:{defaultValue:!1,type:"boolean",category:"Behavior"},escapeHTML:{defaultValue:!1,type:"boolean",category:"Behavior"},_noValiditySignDisplay:{defaultValue:!1,type:"boolean",category:"Appearance"}}},enumerable:!1,configurable:!0}),t.prototype._postBuildView=function(){},t.prototype.commitCurrentEntry=function(){if(this.value!==this.valueToCommit)return this.value=this.valueToCommit,this._updateValidFlag(),!0},t.prototype._applyDisabled=function(){e.prototype._applyDisabled.call(this),this.disabled?this._myInput.setAttributeNode(document.createAttribute("disabled")):this._myInput.removeAttribute("disabled")},t.prototype._applyRequiredFlag=function(){this._realApplyRequiredFlag(),this._updateValidFlag()},t.prototype._applyPlaceholder=function(){this.placeholder?this._myInput.setAttribute("placeholder",this.placeholder):this._myInput.removeAttribute("placeholder")},t.prototype._applyValue=function(e,t){null==t?this._myInput.value="":(this._myInput.value=t,this._applyEscapeHTML(),this._myInput.value=this.escapeHTML?i.String.unescapeHTML(this.value):this.value),this.valueToCommit=this.value,this.fire("change"),this._updateValidFlag()},t.prototype._applyValueToCommit=function(e){this.fire("uncommittedChange",{uncommittedValue:this.valueToCommit})},t.prototype._applyEscapeHTML=function(e){this._myInput.value&&(this.escapeHTML?this._properties.value.value=i.String.escapeHTML(this._myInput.value):!0===e&&(this._properties.value.value=i.String.unescapeHTML(this._myInput.value)))},t.prototype._realApplyRequiredFlag=function(){!0===this.requiredFlag?this._myInput.setAttributeNode(document.createAttribute("required")):this._myInput.removeAttribute("required")},t.prototype._updateValidFlag=function(){if(this._myInput&&this._myInput.validity){var e=this._myInput.validity.valid;if(e&&this.disabled&&this.requiredFlag&&!this._myInput.value&&(e=!1),e===this._properties.validFlag.value)return;this._properties.validFlag.value=e,this._noValiditySignDisplay||(e?this.elements.container.removeAttribute("with-validsign"):this.elements.container.setAttribute("with-validsign","")),this.fire("validFlagChange")}},t.prototype._getElementToFocus=function(){return this._myInput},t.prototype._onFocusReceived=function(t){this._isFocused()||(e.prototype._onFocusReceived.call(this),document.activeElement!==this._myInput&&this._myInput.focus({preventScroll:!0}),!this.disabled&&this.selectAllOnFocus&&!1!==t&&(this._myInput.setSelectionRange(0,0),this._myInput.select()),this.fire("focus"))},t.prototype._giveFocus=function(t){this._isFocused()||(e.prototype._giveFocus.call(this),document.activeElement!==this._myInput&&this._myInput.focus({preventScroll:!0}),!this.disabled&&this.selectAllOnFocus&&!1!==t&&(this._myInput.setSelectionRange(0,0),this._myInput.select()),this.fire("focus"))},t.prototype.destroy=function(){e.prototype.destroy.call(this),this._myInput=null},t}(n);return l.prototype.blackBoxFlag=!0,s.addClass(l,"abstract editor"),l});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/Editor",["require","exports","UWA/Core","DS/Controls/AbstractEditor","DS/WebRecordEnabler/Adapter","DS/Utilities/Dom","DS/Core/WebUXComponents","DS/Utilities/WUXUWAUtils"],function(e,t,i,n,s,o,l,a){"use strict";var r=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return a.extendingClassFlag?n:(n.addKeyMapsAndCommands({up:{keydown:"consume",keyup:"consume"},right:{keydown:"consume",keyup:"consume"},down:{keydown:"consume",keyup:"consume"},left:{keydown:"consume",keyup:"consume"},pagedown:{keydown:"preventDefaultAndConsume",keyup:"preventDefaultAndConsume"},pageup:{keydown:"preventDefaultAndConsume",keyup:"preventDefaultAndConsume"},space:{keydown:"consume",keyup:"consume"},del:{keydown:"consume",keyup:"consume"},backspace:{keydown:"consume",keyup:"consume"},"ctrl+c":{keydown:"consume",keyup:"consume"},"ctrl+v":{keydown:"consume",keyup:"consume"},"ctrl+x":{keydown:"consume",keyup:"consume"},"ctrl+a":{keydown:"consume",keyup:"consume"},"ctrl+z":{keydown:"consume",keyup:"consume"},"shift+up":{keydown:"consume",keyup:"consume"},"shift+right":{keydown:"consume",keyup:"consume"},"shift+down":{keydown:"consume",keyup:"consume"},"shift+left":{keydown:"consume",keyup:"consume"},"ctrl+up":{keydown:"consume",keyup:"consume"},"ctrl+right":{keydown:"consume",keyup:"consume"},"ctrl+down":{keydown:"consume",keyup:"consume"},"ctrl+left":{keydown:"consume",keyup:"consume"},"ctrl+del":{keydown:"consume",keyup:"consume"},"ctrl+backspace":{keydown:"consume",keyup:"consume"},"ctrl+shift+right":{keydown:"consume",keyup:"consume"},"ctrl+shift+left":{keydown:"consume",keyup:"consume"},"shift+ctrl+right":{keydown:"consume",keyup:"consume"},"shift+ctrl+left":{keydown:"consume",keyup:"consume"},home:{keydown:"consume",keyup:"consume"},"shift+home":{keydown:"consume",keyup:"consume"},end:{keydown:"consume",keyup:"consume"},"shift+end":{keydown:"consume",keyup:"consume"}},{consume:function(){return{stopPropagation:!0}},validateValue:function(){return{preventDefault:!0,stopPropagation:!1,infos:{actionPerformed:this.commitCurrentEntry()}}},preventDefault:function(){return{preventDefault:!0,stopPropagation:!1}},preventDefaultAndConsume:function(){return{preventDefault:!0,stopPropagation:!0}}}),n)}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:"",type:"string",category:"Behavior",recordFlag:!0,advancedSetter:!0},widthInCharNumber:{defaultValue:20,type:"integer",category:"Appearance"},maxLength:{defaultValue:-1,type:"integer",category:"Appearance"},nbRows:{defaultValue:2,type:"integer",category:"Appearance"},newLineMode:{defaultValue:"shiftEnter",type:"string",category:"Behavior"},autoCommitFlag:{defaultValue:!1,type:"boolean",noNeedToApplyFlag:!0,category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){this.elements.container.addClassName("wux-controls-editor"),this._myInput=new i.Element("textarea",{type:"text"}),this._myInput.addClassName("wux-ui-state-"+this.options.type),this._myInput.inject(this.elements.container)},t.prototype.handleEvents=function(){var t=this;e.prototype.handleEvents.call(this),o.addEventOnElement(this,this._myInput,"change",function(e){e.stopPropagation()}),o.addEventOnElement(this,this._myInput,"input",function(e){e.stopPropagation(),t.autoCommitFlag?t.setPropertyFromUIInteraction("value",t._myInput.value):t.setPropertyFromUIInteraction("valueToCommit",t._myInput.value)}),o.addEventOnElement(this,this._myInput,"blur",function(e){t.callMethodFromUIInteraction("commitCurrentEntry"),e.preventDefault(),t.fire("blur")})},t.prototype._applyNewLineMode=function(){"enter"===this.newLineMode?this.addKeyMapsAndCommands({return:{keydown:"consume",keyup:"preventDefaultAndConsume"},"shift+return":{keydown:"validateValue",keyup:"preventDefault"}},{}):"shiftEnter"===this.newLineMode?this.addKeyMapsAndCommands({"shift+return":{keydown:"consume",keyup:"preventDefaultAndConsume"},return:{keydown:"validateValue",keyup:"preventDefault"}},{}):this.removeKeyMaps(["return","shift+return"])},t.prototype._applyMaxLength=function(e){this.maxLength>0?this._myInput.setAttribute("maxlength",this.maxLength):this._myInput.removeAttribute("maxlength"),l._applyForAdvancedSetterProperty(this,"value",this.value,this.value)},t.prototype._applyWidthInCharNumber=function(){this.widthInCharNumber>0?(this._myInput.setAttribute("cols",this.widthInCharNumber),this.elements.container.removeClassName("wux-controls-editor-width")):(this._myInput.removeAttribute("cols"),this.elements.container.addClassName("wux-controls-editor-width"))},t.prototype._applyNbRows=function(e){this.nbRows>1?this._myInput.setAttribute("rows",this.nbRows):this._myInput.removeAttribute("rows"),e!==this.nbRows&&this.fire("dimensionsChanged")},t.prototype._preEditValue=function(e,t){var i=parseInt(this.maxLength);return!(i>0)||{validValue:t=t.slice(0,i)}},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this._applyPlaceholder(),this._applyWidthInCharNumber(),this._applyNbRows(t.nbRows),this._applyMaxLength(),this._applyNewLineMode(),this._realApplyRequiredFlag(),this.isDirty("value")&&l._applyForAdvancedSetterProperty(this,"value",t.value,this.value),this._updateValidFlag()},t}(n);return r.prototype.markForRecordFlag=!0,l.addClass(r,"editor"),s.register(r,"DS/ControlsRec/AbstractRec"),r});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/LineEditor",["require","exports","UWA/Core","DS/Controls/AbstractEditor","DS/Controls/CustomizableDecoratorItems","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Controls/TooltipModel","i18n!DS/Controls/assets/nls/translation","DS/Core/WebUXComponents","DS/Utilities/Utils","DS/Controls/DecoratorManager","DS/Core/BaseComponent","DS/Controls/Popup","DS/Utilities/WUXUWAUtils"],function(e,t,i,n,s,o,l,a,r,h,u,c,d,p,m){"use strict";function g(){var e=this;""!==e.valueToCommit&&(e._myInput.value=""),""!==e.value?(e.value="",e.fire("clear")):e._applyValue()}function v(e){e.elements._validitySign||(e.elements._validitySign=i.createElement("div",{class:"wux-controls-lineeditor-validitysign"}),e.elements._validitySign.inject(e.elements.container),e.elements._invalidAttentionSign=i.createElement("div",{class:"wux-controls-lineeditor-invalidsignattention"}),e.elements._invalidAttentionSign.hide(),e.elements._invalidAttentionSign.inject(e.elements._validitySign),l.generateIcon("attention",{target:e.elements._invalidAttentionSign}),e.elements._validStatusOKSign=i.createElement("div",{class:"wux-controls-lineeditor-validsignstatusok"}),e.elements._validStatusOKSign.hide(),e.elements._validStatusOKSign.inject(e.elements._validitySign),l.generateIcon("status-ok",{target:e.elements._validStatusOKSign}))}function f(){this._noValiditySignDisplay||(this.pattern||this.requiredFlag?this.validFlag?this.elements._wasInvalidDuringModification?(v(this),this.elements.container.setAttribute("with-validsign",""),this.elements._invalidAttentionSign.hide(),this.elements._validStatusOKSign.show()):(this.elements.container.removeAttribute("with-validsign"),this.elements._validitySign&&(this.elements._validitySign.remove(),delete this.elements._validitySign)):(v(this),this.elements._invalidAttentionSign.show(),this.elements._validStatusOKSign.hide()):this.elements._validitySign&&(this.elements._validitySign.remove(),delete this.elements._validitySign),this._myInput.value?this._myInput.removeAttribute("is-empty"):this._myInput.setAttribute("is-empty",""))}function y(){this.pattern?this._myInput.setAttribute("pattern",this.pattern):this._myInput.removeAttribute("pattern")}var b=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return m.extendingClassFlag?n:(n.addKeyMapsAndCommands({left:{keydown:"consume",keyup:"consume"},right:{keydown:"consume",keyup:"consume"},pagedown:{keydown:"preventDefault",keyup:"preventDefault"},pageup:{keydown:"preventDefault",keyup:"preventDefault"},space:{keydown:"consume",keyup:"consume"},del:{keydown:"consume",keyup:"consume"},backspace:{keydown:"consume",keyup:"consume"},"+":{keydown:"consume",keyup:"consume"},"-":{keydown:"consume",keyup:"consume"},"*":{keydown:"consume",keyup:"consume"},"/":{keydown:"consume",keyup:"consume"},"ctrl+c":{keydown:"consume",keyup:"consume"},"ctrl+v":{keydown:"consume",keyup:"consume"},"ctrl+x":{keydown:"consume",keyup:"consume"},"ctrl+a":{keydown:"consume",keyup:"consume"},"ctrl+z":{keydown:"consume",keyup:"consume"},"shift+up":{keydown:"consume",keyup:"consume"},"shift+right":{keydown:"consume",keyup:"consume"},"shift+down":{keydown:"consume",keyup:"consume"},"shift+left":{keydown:"consume",keyup:"consume"},"ctrl+up":{keydown:"consume",keyup:"consume"},"ctrl+right":{keydown:"consume",keyup:"consume"},"ctrl+down":{keydown:"consume",keyup:"consume"},"ctrl+left":{keydown:"consume",keyup:"consume"},"ctrl+del":{keydown:"consume",keyup:"consume"},"ctrl+backspace":{keydown:"consume",keyup:"consume"},"ctrl+shift+right":{keydown:"consume",keyup:"consume"},"ctrl+shift+left":{keydown:"consume",keyup:"consume"},"shift+ctrl+right":{keydown:"consume",keyup:"consume"},"shift+ctrl+left":{keydown:"consume",keyup:"consume"},home:{keydown:"consume",keyup:"consume"},"shift+home":{keydown:"consume",keyup:"consume"},end:{keydown:"consume",keyup:"consume"},"shift+end":{keydown:"consume",keyup:"consume"},return:{keydown:"validateValue",keyup:"preventDefault"}},{consume:function(){},validateValue:function(){return{preventDefault:!0,stopPropagation:!1,infos:{actionPerformed:this.commitCurrentEntry()}}},preventDefault:function(){return{preventDefault:!0,stopPropagation:!1}},preventDefaultAndConsume:function(){return{preventDefault:!0,stopPropagation:!0}}}),n)}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{pattern:{defaultValue:"",type:"string",category:"Behavior"},sizeInCharNumber:{defaultValue:-1,type:"integer",category:"Appearance"},displayStyle:{defaultValue:"text",type:"string",category:"Appearance"},autoCommitFlag:{defaultValue:!1,type:"boolean",noNeedToApplyFlag:!0,category:"Behavior"},value:{defaultValue:"",type:"string",category:"Behavior",recordFlag:!0,advancedSetter:!0},autoCorrectFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},displayClearFieldButtonFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},icon:{defaultValue:void 0,type:"string",category:"Appearance"},customDecoratorDefinition:{defaultValue:void 0,type:"Object",category:"Behavior"},maxLength:{defaultValue:-1,type:"integer",category:"Appearance"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){this.elements.container.addClassName("wux-controls-lineeditor"),this._myInput=new i.Element("input",{type:"text",tabindex:0,autocomplete:"off"}),this.elements.inputField=this._myInput,this._myInput.inject(this.elements.container),this._myInput.addClassName("wux-ui-state-"+this.options.type),this.displayClearFieldButtonFlag&&this._layoutClearFieldButton()},t.prototype.destroy=function(){c.getWidget()===this&&c.hideDecorator(),e.prototype.destroy.call(this)},t.prototype.handleEvents=function(){var t=this;e.prototype.handleEvents.call(this),l.addEventOnElement(this,this._myInput,"change",function(e){e.stopPropagation()}),l.addEventOnElement(this,this._myInput,"input",function(e){e.stopPropagation(),t.validFlag||(t.elements._wasInvalidDuringModification=!0),t.autoCommitFlag?t.setPropertyFromUIInteraction("value",t._myInput.value):t.setPropertyFromUIInteraction("valueToCommit",t._myInput.value)}),l.addEventOnElement(this,this._myInput,"blur",function(e){for(var i=!0,n=e,s=(null==n?void 0:n.relatedTarget)?n.relatedTarget:null,o=0;s&&t._blurExceptionTargets&&o<t._blurExceptionTargets.length;o++){var a=t._blurExceptionTargets[o],r=a instanceof d?a.getContent():a;a&&(a instanceof p&&!a.isElementInside(s)||!l.isElementInside(s,r)||(i=!1))}i&&(t.callMethodFromUIInteraction("commitCurrentEntry"),t.elements._wasInvalidDuringModification=!1,f.call(t),t._myInput&&t.fire("blur"))}),l.addEventOnElement(this,this._myInput,o.POINTERDOWN,function(e){if(t._createPointerUpOnDocumentFunction(),!o.isTouchEvent(e)||c.getWidget()===t&&document.activeElement===this){if(c.isDecoratorDisplayed()){c.hideDecorator(!1,!0);i=l.getDocumentOwner.call(t,t);l.removeEventOnElement(t,i,o.POINTERUP,t._pointerUpOnDocument)}}else if(t.customDecoratorDefinition&&t.customDecoratorDefinition.decoratorID){e.preventDefault(),c.showDecorator(t,this,t.customDecoratorDefinition.decoratorID);var i=l.getDocumentOwner.call(t,t);l.addEventOnElement(t,i,o.POINTERUP,t._pointerUpOnDocument)}}),l.addEventOnElement(this,this._myInput,o.POINTERHIT,function(e){e.stopPropagation()})},t.prototype.preventBlurForTargetedElements=function(e){this._blurExceptionTargets||(this._blurExceptionTargets=[]),this._blurExceptionTargets=this._blurExceptionTargets.concat(e)},t.prototype.removeElementFromPreventedBlurTarget=function(e){if(this._blurExceptionTargets&&e){var t=this._blurExceptionTargets.indexOf(e);t>-1&&this._blurExceptionTargets.splice(t,1)}},t.prototype._layoutClearFieldButton=function(){var e=this;this.elements._clearFieldButton=new i.Element("div",{class:"wux-controls-lineeditor-clearbutton"}),this.elements._clearFieldButton.setAttribute("draggable","false"),this.elements._clearFieldButton.addClassName("wux-controls-lineeditor-clearbutton"),this.elements._clearFieldButton.tooltipInfos=new a({shortHelp:r.get("clearField")}),this.elements._clearFieldButton.inject(this.elements.container),this._myInput.setAttribute("has-clearButton","true"),l.generateIcon("clear",{target:this.elements._clearFieldButton}),l.addEventOnElement(this,this.elements._clearFieldButton,o.POINTERDOWN,function(e){e.preventDefault()}),l.addEventOnElement(this,this.elements._clearFieldButton,"touchstart",function(t){t.preventDefault(),g.call(e)}),l.addEventOnElement(this,this.elements._clearFieldButton,"click",function(t){t.stopPropagation(),g.call(e)})},t.prototype._layoutIconFieldButton=function(){var e=this;this.elements._iconFieldButton=new i.Element("div",{class:"wux-controls-lineeditor-iconbutton"}),this.elements._iconFieldButton.addClassName("wux-controls-lineeditor-iconbutton"),this.elements._iconFieldButton.inject(this.elements.container),l.generateIcon(this.icon,{target:this.elements._iconFieldButton}),this._myInput.setAttribute("has-iconButton",""),l.addEventOnElement(this,this.elements._iconFieldButton,"click",function(t){e.fire("click")})},t.prototype._applyValueToCommit=function(t){e.prototype._applyValueToCommit.call(this,t);var n=this.valueToCommit;if(void 0!==n){if(this._myInput.value!==n){var s=n&&" "===n.toString().charAt(n.length-1)?" ":"",o=this.escapeHTML?i.String.unescapeHTML(n)+s:n;this._myInput.value=o}}else this._myInput.value="";this._updateValidFlag(),this._applyDisplayClearFieldButtonFlag()},t.prototype._preEditValue=function(e,t){if(!this.autoCorrectFlag)return!0;if(null!=t){t!==e&&this._myInput.value!==t&&(this._myInput.value=t);var i=parseInt(this.maxLength);if(i>0)return{validValue:t=t.slice(0,i)}}else this._myInput.value="";return!(!this._myInput.validity.valid&&t.length>0)||(this._myInput.value!==e&&(this._myInput.value=e),!1)},t.prototype._applyValue=function(e,t){this._applyEscapeHTML(),this.valueToCommit=this.value,this.fire("change")},t.prototype._applyPattern=function(){y.call(this),this._updateValidFlag()},t.prototype._applySizeInCharNumber=function(){this.sizeInCharNumber>0?(this._myInput.setAttribute("size",this.sizeInCharNumber),this.elements.container.removeClassName("wux-controls-lineeditor-width")):(this._myInput.removeAttribute("size"),this.elements.container.addClassName("wux-controls-lineeditor-width"))},t.prototype._applyMaxLength=function(e){this.maxLength>0?this._myInput.setAttribute("maxlength",this.maxLength):this._myInput.removeAttribute("maxlength"),h._applyForAdvancedSetterProperty(this,"value",this.value,this.value)},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this._applyPlaceholder(),this._applySizeInCharNumber(),this.isDirty("maxLength")&&this._applyMaxLength(t.maxLength),this._myInput.type="password"===this.displayStyle?"password":"text","lite"===this.displayStyle?this._myInput.addClassName("wux-controls-lineEditor-lite"):this._myInput.removeClassName("wux-controls-lineEditor-lite"),void 0!==this.value&&null!==this.value?this._myInput.value=this.escapeHTML?i.String.unescapeHTML(this.value):this.value:this._myInput.value="",this._realApplyRequiredFlag(),y.call(this),this.valueToCommit=this.value,this._updateValidFlag(),this.isDirty("value")&&this.fire("change"),this._applyDisplayClearFieldButtonFlag(),this._applyIcon()},t.prototype._applyDisplayClearFieldButtonFlag=function(){this.displayClearFieldButtonFlag?(this.elements._clearFieldButton||this._layoutClearFieldButton(),""===this.valueToCommit||void 0===this.valueToCommit||this.disabled?this.elements._clearFieldButton.style.display="none":(this.elements._clearFieldButton.style.display="",this._myInput.setAttribute("has-clearButton","true"),this.icon&&this.elements._clearFieldButton.setAttribute("has-IconAndButton",""))):this.elements._clearFieldButton&&(this.elements._clearFieldButton.style.display="none",this._myInput.removeAttribute("has-clearButton"))},t.prototype._applyDisabled=function(){e.prototype._applyDisabled.call(this),this._applyDisplayClearFieldButtonFlag()},t.prototype._applyTouchMode=function(){e.prototype._applyTouchMode.call(this),u.isOnIPhone()?this.getContent().addClassName("wux-device-iphone"):this.getContent().removeClassName("wux-device-iphone")},t.prototype._applyIcon=function(){this.elements._iconFieldButton&&(this.elements._iconFieldButton.remove(),this.elements._iconFieldButton=null),this.icon?(this._myInput.setAttribute("has-iconButton",""),this._layoutIconFieldButton()):(this._myInput.removeAttribute("has-iconButton"),this.elements._clearFieldButton&&this.elements._clearFieldButton.removeAttribute("has-IconAndButton"))},t.prototype._applyRequiredFlag=function(){e.prototype._applyRequiredFlag.call(this),f.call(this)},t.prototype._createPointerUpOnDocumentFunction=function(){if(!this._pointerUpOnDocument){var e=this;this._pointerUpOnDocument=function(t){if(!l.isElementInside(t.target,e._myInput)){var i=t.clientX,n=t.clientY;if(c.isDecoratorDisplayed()&&!u.isMouseOverElement(c.getWidget().getContent(),{x:i,y:n})&&!u.isMouseOverElement(c.getDecorator().elements.popup.getContent(),{x:i,y:n})){c.hideDecorator(!0,!0);var s=l.getDocumentOwner.call(e,e);l.removeEventOnElement(e,s,o.POINTERUP,e._pointerUpOnDocument)}}}}},t.prototype._onDecoratorClick=function(e,t){if(!t){var i=s.getItem(e),n=this.elements.inputField.selectionStart;this.elements.inputField.selectionEnd;if(i&&i.label){var o=this._myInput.value.substring(0,this._myInput.selectionStart)+i.label+this._myInput.value.substring(this._myInput.selectionEnd);this._myInput.value=o,this._myInput.selectionStart=this.elements.inputField.selectionEnd=n+i.label.length}else if("delete"===e){o=void 0;o=this._myInput.selectionEnd>this._myInput.selectionStart?this._myInput.value.substring(0,this._myInput.selectionStart)+this._myInput.value.substring(this._myInput.selectionEnd+1):this._myInput.value.substring(0,this._myInput.value.length-1),this._myInput.value=o,this._myInput.selectionStart=this.elements.inputField.selectionEnd=n}else"validate"===e&&c.hideDecorator(!0,!0)}},t.prototype._onDecoratorShow=function(){document.activeElement&&document.activeElement.blur(),this._myInput.setAttributeNode(document.createAttribute("readonly")),this._myInput.focus(),this._myInput.selectionStart=0,this._myInput.selectionEnd=this._myInput.value.length},t.prototype._onDecoratorHide=function(){if(this._myInput){this._myInput.removeAttribute("readonly"),this.commitCurrentEntry();var e=c.getDecorator();e&&e.resetActiveView&&c.getDecorator().resetActiveView()}},t.prototype._realApplyRequiredFlag=function(){e.prototype._realApplyRequiredFlag.call(this),f.call(this)},t.prototype._updateValidFlag=function(){var t=this.validFlag;e.prototype._updateValidFlag.call(this),t!==this.validFlag&&f.call(this)},t}(n);return h.addClass(b,"lineEditor"),b});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/FilePicker",["require","exports","DS/Utilities/Utils","DS/Utilities/Dom","DS/Controls/Abstract","DS/Controls/Button","DS/Controls/LineEditor","DS/Controls/TooltipModel","DS/Core/WebUXComponents","DS/WebRecordEnabler/Adapter","i18n!DS/Controls/assets/nls/translation"],function(e,t,i,n,s,o,l,a,r,h,u){"use strict";var c="".concat("wux-controls-filepicker","-placeholder-dnd"),d="".concat(c,"-icon"),p="".concat("wux-controls-filepicker","-fileChooser-trigger"),m="".concat("wux-tweakers-multirep-button","-line-editor"),g=function(e){e&&e.removeAttribute("hide")},v=function(e){e&&e.setAttribute("hide","")},f=function(e){e&&e.setAttribute("focused","")},y=function(e){e&&e.removeAttribute("focused")},b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="FilePicker",t.markForRecordFlag=!0,t}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:void 0,type:"Object",category:"Appearance"},placeholder:{defaultValue:"",type:"string",category:"Appearance"},displayStyle:{defaultValue:"lineEditor",type:"string",category:"Appearance"}}},enumerable:!1,configurable:!0}),t.prototype._applyPlaceholder=function(e){e!==this.placeholder&&(this.elements._lineEditor&&(this.elements._lineEditor.placeholder=this.placeholder),this._updateInputTooltip())},t.prototype._applyValue=function(e){0!==i.compare(e,this.value)&&(this.elements._lineEditor&&(this.elements._lineEditor.value=this.value?this.value.name:this.value),this._updateInputTooltip(),this.fire("change"))},t.prototype._applyDisplayStyle=function(e){this.displayStyle},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("placeholder")&&this._applyPlaceholder(t.placeholder),this.isDirty("value")&&this._applyValue(t.value),this.isDirty("displayStyle")&&this._applyDisplayStyle(t.displayStyle)},t.prototype._applyDisabled=function(t){e.prototype._applyDisabled.call(this,t),this.elements._lineEditor&&(this.elements._lineEditor.disabled=this.disabled),this.elements._fileChooserHandle&&(this.elements._fileChooserHandle.disabled=this.disabled)},t.prototype._applyTouchMode=function(t){e.prototype._applyTouchMode.call(this,t),this.elements._lineEditor&&(this.elements._lineEditor.touchMode=this.touchMode),this.elements._fileChooserHandle&&(this.elements._fileChooserHandle.touchMode=this.touchMode)},t.prototype.buildView=function(){this.elements.container.classList.add("wux-controls-filepicker")},t.prototype._postBuildView=function(){e.prototype._postBuildView.call(this);var t=this._getCurrentTouchMode();this.elements._lineEditor=new l({placeholder:this.placeholder,touchMode:t,disabled:this.disabled,value:this.value?this.value.name:this.value}),this.elements.container.appendChild(this.elements._lineEditor.getContent()),this.elements._lineEditor.elements.inputField.setAttribute("readonly","readonly"),this.elements._placeholderDnD=document.createElement("div"),this.elements._placeholderDnD.classList.add(c),v(this.elements._placeholderDnD),this.elements._lineEditor.elements.container.appendChild(this.elements._placeholderDnD);var i=document.createElement("span");i.classList.add("wux-ui-3ds","wux-ui-3ds-doc-add","wux-ui-3ds-lg",d),this.elements._placeholderDnD.appendChild(i),this.elements._fileChooserHandle=new o({showLabelFlag:!1,icon:{iconName:"upload",iconSize:"1x",fontIconFamily:WUXManagedFontIcons.Font3DS},touchMode:t,disabled:this.disabled}),this.elements._fileChooserHandle.elements.container.classList.add("wux-tweakers-multirep-button"),this._updateInputTooltip(),this.elements._fileChooserTrigger=document.createElement("input"),this.elements._fileChooserTrigger.type="file",this.elements._fileChooserTrigger.title=" ",this.elements._fileChooserTrigger.classList.add(p),this.elements.container.appendChild(this.elements._fileChooserTrigger),this.elements._fileChooserHandle.elements.container.classList.add(m),this.elements.container.appendChild(this.elements._fileChooserHandle.getContent())},t.prototype.focus=function(t){e.prototype.focus.call(this,t),this.elements._lineEditor.focus(t)},t.prototype.handleEvents=function(){var t=this;e.prototype.handleEvents.call(this);var s=function(e){var n;e.stopPropagation(),e.dataTransfer?(e.preventDefault(),n=e.dataTransfer.files[0],v(t.elements._placeholderDnD)):t.elements._fileChooserTrigger.files&&t.elements._fileChooserTrigger.files.length&&(n=t.elements._fileChooserTrigger.files[0]),n&&0!=i.compare(t.value,n)&&(t.value=n)};n.addEventOnElement(this,this.elements._lineEditor,"change",function(e){e.stopPropagation()}),n.addEventOnElement(this,this.elements._fileChooserTrigger,"change",s),n.addEventOnElement(this,this.getContent(),"dragover",function(e){e.preventDefault(),e.stopPropagation(),g(t.elements._placeholderDnD)}),n.addEventOnElement(this,this.getContent(),"drop",s),n.addEventOnElement(this,this.getContent(),"dragleave",function(e){e.preventDefault(),e.stopPropagation(),v(t.elements._placeholderDnD)}),n.addEventOnElement(this,this.elements._fileChooserTrigger,"focus",function(e){t.focus({})}),n.addEventOnElement(this,this.elements._lineEditor.getContent(),"focus",function(e){f(t.elements._fileChooserHandle.getContent())}),n.addEventOnElement(this,this.elements._lineEditor.getContent(),"blur",function(e){y(t.elements._fileChooserHandle.getContent())}),n.addEventOnElement(this,this.elements._lineEditor.getContent(),"copy",function(e){var i=t.value&&t.value.name?t.value.name:"";e&&e.clipboardData&&e.clipboardData.setData("Text",i),e.preventDefault()})},t.prototype._updateInputTooltip=function(){var e;this.elements._lineEditor&&(e=void 0!==this.elements._lineEditor.value?this.elements._lineEditor.value:u.get("inputNoFileChosen")),void 0===this.tooltipInfos?this.tooltipInfos=new a({shortHelp:e}):this.tooltipInfos.shortHelp=e},t}(s);return r.addClass(b,"FilePicker"),b.prototype.markForRecordFlag=!0,h.register(b,"DS/ControlsRec/AbstractRec"),b});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/ButtonGroup",["require","exports","UWA/Core","DS/Controls/Abstract","DS/Utilities/Dom","DS/Controls/Toggle","DS/Controls/Button","DS/Utilities/KeyboardUtils","DS/Core/WebUXComponents"],function(e,t,i,n,s,o,l,a,r){"use strict";var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:void 0,type:"array",category:"Behavior",recordFlag:!0},type:{defaultValue:"radio",type:"string",category:"Behavior"},minButtonWidth:{defaultValue:-1,type:"integer",category:"Appearance"},preferredButtonWidth:{defaultValue:-1,type:"integer",category:"Appearance"},multiSelFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},noContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype._preBuildView=function(t){this.elements.container=i.Element("div",{class:"wux-controls-buttongroup"}),e.prototype._preBuildView.call(this,t)},t.prototype.buildView=function(){this._bindedButtonChangeCB=function(e){if(e.target!==this.elements.container){e.stopPropagation();var t=e.dsModel,i=this._getButtonList();if(i.forEach(function(e){e.preventTriggeringChangeEvent=!0}),t&&d.call(this,t)){if(this.multiSelFlag&&(!0===t.isMultiSelection&&"radio"===this.type&&(this.type="checkbox"),!1===t.isMultiSelection&&"checkbox"===this.type)){this.type="radio";for(var n=this._getButtonList(),s=0;s<n.length;s++){var o=n[s];o.checkFlag=t===o}}if("radio"!==this.type||t.isMultiSelection)("checkbox"===this.type||t.isMultiSelection)&&(l=this.value?this.value.slice(0):[],this.preventTriggeringChangeEvent=!0,!0===t.checkFlag?-1===this.value.indexOf(t.value)&&(l.push(t.value),this.value=l):!t.isMultiSelection||-1!==this.value.indexOf(t.value)&&this.value.length>1?(l.splice(this.value.indexOf(t.value),1),this.value=l):t.isMultiSelection&&-1!==this.value.indexOf(t.value)&&1===this.value.length&&(t.checkFlag=!0),this.preventTriggeringChangeEvent=!1);else if(!0===t.checkFlag)this.preventTriggeringChangeEvent=!0,this.value=[t.value],this.preventTriggeringChangeEvent=!1;else if(this.value.length>1){var l;this.preventTriggeringChangeEvent=!0,(l=this.value?this.value.slice(0):[]).splice(this.value.indexOf(t.value),1),this.value=l,this.preventTriggeringChangeEvent=!1}}(i=this._getButtonList()).forEach(function(e){e.preventTriggeringChangeEvent=!1}),this.preventTriggeringChangeEvent||this.fire("change")}}.bind(this)},t.prototype._applyRecId=function(e){if(null!==this.recId&&void 0!==this.recId)for(var t=this._getButtonList(),i=0;i<t.length;i++)t[i].redId=this.recId+t[i].value;else if(null!=e)for(t=this._getButtonList(),i=0;i<t.length;i++)t[i].redId=null},t.prototype._applyMultiSelFlag=function(e){for(var t=this._getButtonList(),i=0;i<t.length;i++)t[i].multiSelFlag=this.multiSelFlag;if(!1===this.multiSelFlag&&!0===e){this.type="radio";for(i=0;i<t.length;i++){var n=t[i];n.type="radio",n.checkFlag=!1}}},t.prototype._applyType=function(e){var t=this._getButtonList();if("radio"===this.type)for(var i=0;i<t.length;i++)t[i].type="radio";else if("checkbox"===this.type)for(i=0;i<t.length;i++)t[i]instanceof l?t[i].type="check":t[i]instanceof o&&(t[i].type="checkbox")},t.prototype._updateChildPropertiesAndListeners=function(e,t){if(void 0===e.value)if(void 0!==t)e.value=t;else{var i=this.getButtonCount();e.value=i}for(var n=!0;n;){n=!1;for(var a=this._getButtonList(),r=0;r<a.length;r++){var h=a[r];if(h.value===e.value&&h!==e&&(e instanceof l==h instanceof l||e instanceof o==h instanceof o)){e.value=e.value+1,n=!0;break}}}var u=e._getDisabledState(),c=!0===this.disabled?this.disabled:u;if(e.setDisabledFlagWithoutChangingDisabledState(c),e.touchMode=this.touchMode,e.checkFlag)if("radio"===this.type)this.value=[e.value],e._uncheckSiblings();else{var d=this.value.slice();d.push(e.value),this.value=d}s.addEventOnElement(this,e.getContent(),"change",this._bindedButtonChangeCB)},t.prototype.addChild=function(e,t){void 0===t&&(t=void 0),e.recId||null===this.recId||void 0===this.recId||(e.recId=this.recId+e.value),this._updateChildPropertiesAndListeners(e,t),this._addChildToUI(e,t)},t.prototype._addChildToUI=function(e,t){if(void 0===t||t>=this.elements.container.childNodes.length)e.inject(this.elements.container);else{var i=this.elements.container.getChildren()[t];e.inject(i,"before")}},t.prototype.moveButton=function(e,t){var i=this.getButton(e);i&&(this.preventTriggeringChangeEvent=!0,this.removeChild(i),this.addChild(i,t),this.preventTriggeringChangeEvent=!1)},t.prototype._getButtonList=function(){for(var e=this.elements.container.childNodes,t=[],i=0;i<e.length;i++){var n=e[i];n.dsModel&&(n.dsModel instanceof l||n.dsModel instanceof o)&&t.push(n.dsModel)}return t},t.prototype.getButtonCount=function(){return this._getButtonList().length},t.prototype.getButtonIndex=function(e){return this._getButtonList().indexOf(e)},t.prototype.getButton=function(e){return this._getButtonList()[e]},t.prototype.getButtonFromValue=function(e){for(var t=0;t<this.elements.container.childNodes.length;t++){var i=this.elements.container.childNodes[t].dsModel;if(void 0!==i.value&&null!==i.value&&null!==e&&i.value===e)return i}},t.prototype.removeChild=function(e){if(e&&(e.remove(),s.removeEventOnElement(this,e.getContent(),"change",this._bindedButtonChangeCB),this.value&&this.value.length>0)){var t=this.value.indexOf(e.value);if(-1!==t){var i=this.value.slice();i.splice(t,1),this.value=i}}},t.prototype.selectIndex=function(e){var t=this.getButton(e);if(t){if("radio"===this.type)this.value=[t.value];else{var i=this.value.slice();i.push(t.value),this.value=i}t.getContent().focus()}},t.prototype._isButtonValueInButtonGroup=function(e){for(var t=this._getButtonList(),i=0;i<t.length;i++){if(t[i].value===e)return!0}return!1},t.prototype.selectValue=function(e){if(this._isButtonValueInButtonGroup(e))if("radio"===this.type)this.value=[e];else{var t=this.value.slice();t.push(e),this.value=t}},t.prototype.selectNext=function(){c.call(this,!1)},t.prototype.selectPrevious=function(){c.call(this,!0)},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("value")&&this._applyValue(t.value),void 0===this.value&&(this.value=[]),this.isDirty("touchMode")&&this._applyTouchMode(),this.isDirty("multiSelFlag")&&this._applyMultiSelFlag(t.multiSelFlag)},t.prototype._applyMaxWidth=function(){-1!==this.maxWidth?(this.elements.container.setStyle("max-width",this.maxWidth+"px"),this.elements.container.setStyle("overflow","hidden")):(this.elements.container.setStyle("max-width",""),this.elements.container.setStyle("overflow",""))},t.prototype._applyDisabled=function(){this.disabled?this.elements.container.setAttribute("tabindex",-1):this.elements.container.setAttribute("tabindex",0);for(var e=this._getButtonList(),t=0;t<e.length;t++)e[t].setDisabledFlagWithoutChangingDisabledState(!0===this.disabled?this.disabled:e[t]._getDisabledState())},t.prototype._applyValue=function(e){var t=this._getButtonList();t.forEach(function(e){e.preventTriggeringChangeEvent=!0});var i=u.call(this,this.value);i.length>1&&this.multiSelFlag?(this.isMultiSelection=!0,t.forEach(function(e){e.isMultiSelection=!0,e.checkFlag=!1}),i.forEach(function(e){e instanceof l?e.type="check":e instanceof o&&(e.type="checkbox"),e.checkFlag=!0}),this.isMultiSelection=!1,t.forEach(function(e){e.isMultiSelection=!1})):(u.call(this,e).forEach(function(e){e.checkFlag=!1}),i.length>0&&i.forEach(function(e){e.checkFlag=!0}));t.forEach(function(e){e.preventTriggeringChangeEvent=!1}),this.preventTriggeringChangeEvent||this.fire("change")},t.prototype._applyPreferredButtonWidth=function(){for(var e=this._getButtonList(),t=0;t<e.length;t++)e[t]instanceof l&&(e[t].preferredWidth=this.preferredButtonWidth)},t.prototype._applyMinButtonWidth=function(){for(var e=this._getButtonList(),t=0;t<e.length;t++)e[t]instanceof l&&(e[t].minWidth=this.minButtonWidth)},t.prototype._applyTouchMode=function(){var e=this._getCurrentTouchMode();!0===e?this.getContent().setAttributeNode(document.createAttribute("touch-mode")):this.getContent().removeAttribute("touch-mode");for(var t=this._getButtonList(),i=0;i<t.length;i++)t[i].touchMode=e},t.prototype._hasOverflow=function(){return this.getContent().scrollWidth>this.getContent().offsetWidth},t.prototype.handleEvents=function(){var e=this;s.addEventOnElement(this,this.elements.container,"keydown",function(t){if(!e.disabled){var i=!1;a.previous(t.keyCode)&&(e.callMethodFromUIInteraction("selectPrevious"),i=!0),a.next(t.keyCode)&&(e.callMethodFromUIInteraction("selectNext"),i=!0),a.PAGEUP==t.keyCode&&(e.callMethodFromUIInteraction("selectIndex",0),i=!0),a.PAGEDOWN==t.keyCode&&(e.callMethodFromUIInteraction("selectIndex",e.getButtonCount()-1),i=!0),i&&(t.preventDefault(),t.stopPropagation())}}),s.addEventOnElement(this,document,"keydown",function(t){if(t.keyCode===a.CTRL&&!e.isMultiSelection&&e.multiSelFlag){e.isMultiSelection=!0;for(var i=e._getButtonList(),n=0;n<i.length;n++)i[n].isMultiSelection=e.isMultiSelection}}),s.addEventOnElement(this,document,"keyup",function(t){if(t.keyCode===a.CTRL&&e.isMultiSelection&&e.multiSelFlag){e.isMultiSelection=!1;for(var i=e._getButtonList(),n=0;n<i.length;n++)i[n].isMultiSelection=e.isMultiSelection}})},t.prototype.destroy=function(){for(var t=this._getButtonList(),i=0;i<t.length;i++)t[i].destroy();t=null,e.prototype.destroy.call(this)},t}(n);function u(e){for(var t=[],i=0;i<this.elements.container.childNodes.length;i++){var n=this.elements.container.childNodes[i].dsModel;void 0!==n.value&&null!==n.value&&null!=e&&-1!==e.indexOf(n.value)&&t.push(n)}return t}function c(e){var t,i=function(){for(var e=0;e<this.elements.container.childNodes.length;e++){var t=this.elements.container.childNodes[e];if(t===document.activeElement)return t.dsModel}return null}.call(this),n=(e?"previous":"next")+"Sibling";if(i&&(t=i.getContent()[n])){var s=t.dsModel;s&&s.visibleFlag&&d.call(this,s)&&"radio"===this.type&&(this.value=[s.value]),t.focus()}}function d(e){return e instanceof o||e instanceof l}return h.prototype.markForRecordFlag=!0,r.addClass(h,"buttonGroup"),h}),define("DS/Controls/TreeNode",["UWA/Core","UWA/Event","DS/Core/Core","DS/Controls/TreeNodeBase","DS/CoreEvents/Events"],function(e,t,i,n,s){"use strict";var o=n.extend({defaultOptions:{pathElement:null},init:function(e){this._parent(e),this._isHighlighted=!1},getPathElement:function(){return this.options.pathElement}});return e.namespace("WUX/Controls/TreeNode",o)}),define("DS/Controls/ProgressBar",["UWA/Core","UWA/Event","DS/Controls/Abstract","DS/Core/Core","DS/CoreEvents/ModelEvents","DS/Utilities/Css","DS/Core/PointerEvents"],function(e,t,i,n,s,o,l){"use strict";return i.inherit({name:"progressBar",publishedProperties:{value:{defaultValue:0,type:"number",category:"Behavior",advancedSetter:!0},shape:{defaultValue:"linear",type:"string",category:"Appearance",advancedSetter:!0},emphasize:{defaultValue:"info",type:"string",category:"Appearance"},displayStyle:{defaultValue:"normal",type:"string",category:"Appearance"},statusFlag:{defaultValue:!0,type:"boolean",category:"Behavior",advancedSetter:!0},infiniteFlag:{defaultValue:!1,type:"boolean",category:"Behavior",advancedSetter:!0},height:{defaultValue:60,type:"number",category:"Appearance",advancedSetter:!0},gradientAnimationFlag:{defaultValue:!0,type:"boolean",category:"Behavior",advancedSetter:!0},noContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}},_progressbarClass:"wux-controls-progressbar",_hideGradientClass:"wux-controls-progressbar-hide-gradient",buildView:function(){this.elements.container.addClassName(this._progressbarClass)},_applyProperties:function(e){this._parent(e),this.isDirty("shape")&&this._applyShape(),this.isDirty("height")&&this._applyHeight(),this.isDirty("displayStyle")&&this._applyDisplayStyle(),this.isDirty("statusFlag")&&this._applyStatusFlag(),this.isDirty("infiniteFlag")&&this._applyInfiniteFlag(),this.isDirty("emphasize")&&this._applyEmphasize(),this.isDirty("value")&&this._applyValue(),this.isDirty("gradientAnimationFlag")&&this._applyGradientAnimationFlag()},_applyShape:function(){"linear"===this.shape?this._applyShapeLinear():this._applyShapeCircular()},_postEditShape:function(e,t){return this._applyHeight(),this._applyDisplayStyle(),this._applyInfiniteFlag(),this._applyEmphasize(),this._applyStatusFlag(),this._applyValue(),this._applyGradientAnimationFlag(),!0},_applyShapeLinear:function(){this._removeCircularShapeElements(),this._addLinearShapeElements()},_removeCircularShapeElements:function(){this.elements.container.removeClassName("wux-controls-progressbar-circular"),this.elements.circularSubcontainer&&(this.elements.circularSubcontainer.destroy(),delete this.elements.circularSubcontainer),this.elements.circularFullFirstHalfBar&&(this.elements.circularFullFirstHalfBar.destroy(),delete this.elements.circularFullFirstHalfBar),this.elements.circularLastBarSegmentContainer&&(this.elements.circularLastBarSegmentContainer.destroy(),delete this.elements.circularLastBarSegmentContainer),this.elements.circularLastBarSegment&&(this.elements.circularLastBarSegment.destroy(),delete this.elements.circularLastBarSegment),this.elements.circularGradientContainer&&(this.elements.circularGradientContainer.destroy(),delete this.elements.circularGradientContainer),this.elements.circularGradient&&(this.elements.circularGradient.destroy(),delete this.elements.circularGradient)},_addLinearShapeElements:function(){this.elements.container.addClassName("wux-controls-progressbar-linear"),this.elements.linearBar=new e.Element("div",{class:this._progressbarClass+"-linear-bar"}).inject(this.elements.container),this.elements.linearBarGradient=new e.Element("div",{class:this._progressbarClass+"-linear-bar-gradient"}).inject(this.elements.linearBar)},_applyShapeCircular:function(){this._removeLinearShapeElements(),this._addCircularShapeElements()},_removeLinearShapeElements:function(){this.elements.container.removeClassName("wux-controls-progressbar-linear"),this.elements.linearBar&&(this.elements.linearBar.destroy(),delete this.elements.linearBar),this.elements.linearBarGradient&&(this.elements.linearBarGradient.destroy(),delete this.elements.linearBarGradient)},_addCircularShapeElements:function(){this.elements.container.addClassName("wux-controls-progressbar-circular"),this.elements.circularSubcontainer=e.Element("div",{class:this._progressbarClass+"-circular-subcontainer"}).inject(this.elements.container),this.elements.circularFullFirstHalfBar=new e.Element("div",{class:this._progressbarClass+"-circular-full-first-half-bar"}).inject(this.elements.circularSubcontainer),this.elements.circularLastBarSegmentContainer=new e.Element("div",{class:this._progressbarClass+"-circular-last-bar-segment-container"}).inject(this.elements.circularSubcontainer),this.elements.circularLastBarSegment=new e.Element("div",{class:this._progressbarClass+"-circular-last-bar-segment"}).inject(this.elements.circularLastBarSegmentContainer),this.elements.circularGradientContainer=new e.Element("div",{class:this._progressbarClass+"-circular-gradient-container"}).inject(this.elements.circularSubcontainer),this.elements.circularGradient=new e.Element("div",{class:this._progressbarClass+"-circular-gradient"}).inject(this.elements.circularGradientContainer)},_applyHeight:function(){if("linear"!==this.shape){this.elements.circularSubcontainer.setStyle("width",this.height+"px"),this.elements.circularSubcontainer.setStyle("height",this.height+"px"),this.elements.circularSubcontainer.setStyle("-webkit-mask-size",2*(this.height-10)+"px"),this.elements.circularFullFirstHalfBar.setStyle("width",this.height+"px"),this.elements.circularFullFirstHalfBar.setStyle("height",this.height+"px"),this.elements.circularFullFirstHalfBar.setStyle("-webkit-mask-size",2*(this.height-10)+"px"),this.elements.circularLastBarSegmentContainer.setStyle("width",this.height+"px"),this.elements.circularLastBarSegmentContainer.setStyle("height",this.height+"px"),this.elements.circularLastBarSegment.setStyle("width",this.height+"px"),this.elements.circularLastBarSegment.setStyle("height",this.height+"px"),this.elements.circularLastBarSegment.setStyle("-webkit-mask-size",2*(this.height-10)+"px"),this.elements.circularGradientContainer.setStyle("width",this.height),this.elements.circularGradientContainer.setStyle("height",this.height),this.elements.circularGradient.setStyle("width",this.height),this.elements.circularGradient.setStyle("height",this.height),this.elements.circularGradient.setStyle("-webkit-mask-size",2*(this.height-10)+"px")}},_postEditHeight:function(){"circular"===this.shape&&(this._removeCircularStatusElements(),this._applyStatusFlag(),this._applyValue())},_applyDisplayStyle:function(){"linear"===this.shape&&("lite"===this.displayStyle?this.elements.container.addClassName(this._progressbarClass+"-linear-lite"):this.elements.container.removeClassName(this._progressbarClass+"-linear-lite"))},_applyInfiniteFlag:function(){this.infiniteFlag?this._addInfiniteFlagElements():this._removeInfiniteFlagElements()},_postEditInfiniteFlag:function(e,t){this._applyStatusFlag(),this._applyValue()},_addInfiniteFlagElements:function(){"linear"===this.shape?this._addInfiniteLinearFlagElements():this._addInfiniteCircularFlagElements()},_addInfiniteLinearFlagElements:function(){this.elements.container.addClassName("wux-controls-progressbar-infinite"),this.elements.linearBar.addClassName("wux-controls-progressbar-linear-bar-infinite"),this.elements.linearBarGradient.addClassName("wux-controls-progressbar-linear-bar-gradient-infinite")},_addInfiniteCircularFlagElements:function(){this.elements.container.addClassName("wux-controls-progressbar-infinite"),this.elements.circularFullFirstHalfBar.addClassName("wux-controls-progressbar-circular-full-first-half-bar-infinite"),this.elements.circularLastBarSegmentContainer.addClassName("wux-controls-progressbar-circular-last-bar-segment-container-infinite"),this.elements.circularGradientContainer.addClassName("wux-controls-progressbar-circular-gradient-container-infinite"),this.elements.circularGradient.addClassName("wux-controls-progressbar-circular-gradient-infinite")},updateInfiniteLinearSpeed:function(){var e=this.elements.container.getSize().width;0!==e&&this.elements.linearBar&&this.elements.linearBar.setStyles({animation:"animation-progressbar-linear-bar-infinite "+.02*e+"s infinite linear"})},_removeInfiniteFlagElements:function(){this._removeInfiniteLinearFlagElements(),this._removeInfiniteCircularFlagElements()},_removeInfiniteLinearFlagElements:function(){this.elements.container&&this.elements.container.removeClassName("wux-controls-progressbar-infinite"),this.elements.linearBar&&this.elements.linearBar.removeClassName("wux-controls-progressbar-linear-bar-infinite"),this.elements.linearBarGradient&&this.elements.linearBarGradient.removeClassName("wux-controls-progressbar-linear-bar-gradient-infinite")},_removeInfiniteCircularFlagElements:function(){this.elements.container&&this.elements.container.removeClassName("wux-controls-progressbar-infinite"),this.elements.circularFullFirstHalfBar&&this.elements.circularFullFirstHalfBar.removeClassName("wux-controls-progressbar-circular-full-first-half-bar-infinite"),this.elements.circularLastBarSegmentContainer&&this.elements.circularLastBarSegmentContainer.removeClassName("wux-controls-progressbar-circular-last-bar-segment-container-infinite"),this.elements.circularGradientContainer&&this.elements.circularGradientContainer.removeClassName("wux-controls-progressbar-circular-gradient-container-infinite"),this.elements.circularGradient&&this.elements.circularGradient.removeClassName("wux-controls-progressbar-circular-gradient-infinite")},_applyEmphasize:function(e){this._removeEmphasizeElements(),this._addEmphasizeElements()},_removeEmphasizeElements:function(){this.elements.container.removeClassName("wux-ui-state-info"),this.elements.container.removeClassName("wux-ui-state-success"),this.elements.container.removeClassName("wux-ui-state-warning"),this.elements.container.removeClassName("wux-ui-state-high-attention"),this.elements.container.removeClassName("wux-ui-state-pause")},_addEmphasizeElements:function(){this.elements.container.addClassName("wux-ui-state-"+this.emphasize)},_applyStatusFlag:function(){!1===this.statusFlag||"lite"===this.displayStyle?this._removeStatusElements():"linear"===this.shape?this._applyLinearStatusFlag():this._applyCircularStatusFlag()},_postEditStatusFlag:function(e,t){return!1===e&&!0===t&&this._applyValue(),!0},_removeStatusElements:function(){this._removeLinearStatusElements(),this._removeCircularStatusElements()},_applyLinearStatusFlag:function(){this._removeCircularStatusElements(),this._addLinearStatusElements()},_removeCircularStatusElements:function(){this.elements.circularStatus&&(this.elements.circularStatus.destroy(),delete this.elements.circularStatus)},_addLinearStatusElements:function(){this.elements.linearStatus||(this.elements.linearStatus=new e.Element("span",{class:this._progressbarClass+"-linear-status"}).inject(this.elements.container))},_applyCircularStatusFlag:function(){this._removeLinearStatusElements(),this._addCircularStatusElements()},_removeLinearStatusElements:function(){this.elements.linearStatus&&(this.elements.linearStatus.destroy(),delete this.elements.linearStatus)},_addCircularStatusElements:function(){this.elements.circularStatus||(this.elements.circularStatus=new e.Element("span",{class:this._progressbarClass+"-circular-status"}).inject(this.elements.container),this.elements.circularStatus.setStyle("width",this.height+"px"),this.elements.circularStatus.setStyle("height",this.height+"px"),this.elements.circularStatus.setStyle("line-height",this.height+"px"))},_preEditValue:function(e,t){return!(t<0||t>100)},_applyValue:function(e){var t=null!==this.value&&void 0!==this.value?Math.round(this.value):NaN;NaN!==t?this._displayValue(t):t=oldValue,void 0!==this.value?this.elements.container.setAttribute("value",this.value):this.elements.container.removeAttribute("value"),this.value!==e&&this.fire("change")},_displayValue:function(e){"linear"===this.shape?this._displayLinearValue(e):this._displayCircularValue(e)},_displayLinearValue:function(e){this._displayLinearValueOnBar(e),this._displayLinearValueOnStatus(e)},_displayLinearValueOnBar:function(e){this.elements.linearBar.setStyle("width",e+"%"),100===e?this.elements.linearBarGradient.addClassName("wux-controls-progressbar-linear-bar-gradient-at-100-percent"):this.elements.linearBarGradient.removeClassName("wux-controls-progressbar-linear-bar-gradient-at-100-percent")},_displayLinearValueOnStatus:function(e){if(!1!==this.statusFlag&&"lite"!==this.displayStyle&&!this.infiniteFlag){this.elements.linearStatus.innerText=e+"%";0===this.elements.container.getSize().width&&e>=55||this.elements.container.getSize().width*e/100>(this.elements.container.getSize().width+24)/2?(this.elements.linearStatus.removeClassName("wux-controls-progressbar-linear-status-off-the-bar"),this.elements.linearStatus.addClassName("wux-controls-progressbar-linear-status-over-the-bar")):(this.elements.linearStatus.removeClassName("wux-controls-progressbar-linear-status-over-the-bar"),this.elements.linearStatus.addClassName("wux-controls-progressbar-linear-status-off-the-bar"))}},_displayCircularValue:function(e){this._displayCircularValueOnBar(e),this._displayCircularValueOnStatus(e)},_displayCircularValueOnBar:function(e){var t=360*e/100;this.infiniteFlag&&(t=60),t<=180?(this.elements.circularFullFirstHalfBar.addClassName("wux-controls-progressbar-circular-full-first-half-bar-less-or-equal-180-deg"),this.elements.circularFullFirstHalfBar.removeClassName("wux-controls-progressbar-circular-full-first-half-bar-more-than-180-deg"),this.elements.circularLastBarSegmentContainer.addClassName("wux-controls-progressbar-circular-last-bar-segment-container-less-or-equal-180-deg"),this.elements.circularLastBarSegmentContainer.removeClassName("wux-controls-progressbar-circular-last-bar-segment-container-more-than-180-deg"),this.elements.circularGradientContainer.addClassName("wux-controls-progressbar-circular-gradient-container-less-or-equal-180-deg"),this.elements.circularGradientContainer.removeClassName("wux-controls-progressbar-circular-gradient-container-more-than-180-deg")):(this.elements.circularFullFirstHalfBar.removeClassName("wux-controls-progressbar-circular-full-first-half-bar-less-or-equal-180-deg"),this.elements.circularFullFirstHalfBar.addClassName("wux-controls-progressbar-circular-full-first-half-bar-more-than-180-deg"),this.elements.circularLastBarSegmentContainer.removeClassName("wux-controls-progressbar-circular-last-bar-segment-container-less-or-equal-180-deg"),this.elements.circularLastBarSegmentContainer.addClassName("wux-controls-progressbar-circular-last-bar-segment-container-more-than-180-deg"),this.elements.circularGradientContainer.removeClassName("wux-controls-progressbar-circular-gradient-container-less-or-equal-180-deg"),this.elements.circularGradientContainer.addClassName("wux-controls-progressbar-circular-gradient-container-more-than-180-deg")),360===t?this.elements.circularGradientContainer.addClassName("wux-controls-progressbar-circular-gradient-container-equals-360-deg"):this.elements.circularGradientContainer.removeClassName("wux-controls-progressbar-circular-gradient-container-equals-360-deg"),this.elements.circularLastBarSegment.setStyles({transform:"rotate("+t+"deg)"}),this.elements.circularGradient.setStyles({transform:"rotate("+t+"deg)"})},_displayCircularValueOnStatus:function(e){!1!==this.statusFlag&&"lite"!==this.displayStyle&&(this.elements.circularStatus.innerText=e+"%")},_applyGradientAnimationFlag:function(){this.elements.linearBarGradient&&(this.elements.linearBarGradient.removeClassName(this._hideGradientClass),this.gradientAnimationFlag||this.elements.linearBarGradient.addClassName(this._hideGradientClass)),this.elements.circularGradient&&(this.elements.circularGradient.removeClassName(this._hideGradientClass),this.gradientAnimationFlag||this.elements.circularGradient.addClassName(this._hideGradientClass))}})});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),__spreadArray=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var n,s=0,o=t.length;s<o;s++)!n&&s in t||(n||(n=Array.prototype.slice.call(t,0,s)),n[s]=t[s]);return e.concat(n||Array.prototype.slice.call(t))};define("DS/Controls/Slider",["require","exports","UWA/Core","DS/Controls/Abstract","DS/Utilities/Utils","DS/Utilities/Dom","DS/WebRecordEnabler/Adapter","DS/Utilities/KeyboardUtils","DS/Core/PointerEvents","DS/Core/WebUXComponents","DS/Controls/Popup","DS/Utilities/WUXUWAUtils"],function(e,t,i,n,s,o,l,a,r,h,u,c){"use strict";var d=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return c.extendingClassFlag?n:(n.addKeyMapsAndCommands({esc:{keydown:"cancel"}},{cancel:function(){var e=!1;return this.handleEditionCancel?(this.disabled||(this.value=this.initialValue,this._inEdition&&(this._inEdition=!1,this.fire("cancelEdit")),e=!0),{infos:{actionPerformed:e}}):{stopPropagation:!1}}}),n)}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{minValue:{defaultValue:0,type:"number",category:"Behavior"},maxValue:{defaultValue:100,type:"number",category:"Behavior"},stepValue:{defaultValue:1,type:"number",category:"Behavior"},value:{defaultValue:0,type:"number",category:"Behavior",advancedSetter:!0,recordFlag:!0},displayStyle:{defaultValue:"horizontal",type:"string",category:"Appearance"},tooltipPosition:{defaultValue:"",type:"string",category:"Appearance"},handleEditionCancel:{defaultValue:!0,type:"boolean",category:"Behavior"},valuePopupFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},sliderButtonStyle:{defaultValue:"standard",type:"string",category:"Appearance"},noContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype._buildCursorView=function(){var e=i.Element("div",{class:"wux-controls-slider-cursor"}).inject(this.elements.sliderContainer);void 0===this._cursors?this._cursors=[e]:this._cursors.push(e)},t.prototype.buildView=function(){this.elements.container.addClassName("wux-controls-slider"),this.elements.container.setAttribute("tabindex",0),this.elements.sliderContainer=i.Element("div",{class:"wux-controls-slider-container"}),this.elements.sliderContainer.inject(this.elements.container),this.elements.sliderBackground=i.Element("div",{class:"wux-controls-slider-bg"}).inject(this.elements.sliderContainer),this.elements.sliderBackgroundFilled=i.Element("div",{class:"wux-controls-slider-bgFilled"}).inject(this.elements.sliderContainer),this._buildCursorView(),this._inEdition=!1},t.prototype._applyDisplayStyle=function(){this.__resolveCssClasses();var e=this._getComputedPosition();this.elements.popup&&(this.elements.popup.position=e)},t.prototype._applySliderButtonStyle=function(){this.__resolveCssClasses()},t.prototype.__resolveCssClasses=function(){this.elements.container.removeClassName("wux-controls-slider-vertical"),this.elements.container.removeClassName("wux-controls-slider-accurate"),"vertical"===this.displayStyle&&this.elements.container.addClassName("wux-controls-slider-vertical"),"accurate"===this.sliderButtonStyle&&this.elements.container.addClassName("wux-controls-slider-accurate"),this._updateCursor()},t.prototype._getComputedPosition=function(){if(this.elements.popup&&this.elements.popup.visibleFlag&&this.elements.popup._latestComputedPosition)return this.elements.popup._latestComputedPosition;var e=this.tooltipPosition;return"vertical"===this.displayStyle?""===e&&(e="right"):""===e&&(e="top"),e},t.prototype._applyTooltipPosition=function(){this.elements.popup&&(this.elements.popup.position=this._getComputedPosition())},t.prototype._applyValuePopupFlag=function(){if(this.valuePopupFlag){if(!this.elements.popup&&this.valuePopupFlag&&!this._popupCreationRemovalFunction){var e=this,t=this._getComputedPosition(),n={arrowBoxFlag:!0,overlap:!1,target:this.elements.container,position:t,constraint:"screen",alignment:"center",trigger:"hover mousePress",positionTarget:this._cursors[0],forceKeepOrientation:!0,getBody:function(){return e.elements.spanTooltip=i.Element("span"),e.elements.spanTooltip.addClassName("wux-slider-span-tooltip"),e.elements.spanTooltip},beforeDisplayCallback:function(){if(!e.getTextFromValue(this._closestHandlerIndex))return{preventDisplay:!0}}};e._popupCreationRemovalFunction=u.delayPopupCreation(n,function(t){e.elements.popup=t,e._popupCreationRemovalFunction=void 0,e.elements.popup.getContent().addClassName("wux-slider-tooltip"),e._applyDisplayStyle(),o.addEventOnElement(e,e.elements.popup,"show",function(t){e._closestHandlerIndex=e._findClosestHandlerIndex(t),e._updateTooltipText()})}).removeListeners}}else this.elements.popup?this.elements.popup.destroy():void 0!==this._popupCreationRemovalFunction&&(this._popupCreationRemovalFunction.call(this),this._popupCreationRemovalFunction=void 0)},t.prototype._preEditValue=function(e,t){if(null!=t&&"number"!=typeof t&&"object"!=typeof t)return this._inEdition&&(this._inEdition=!1,this.fire("cancelEdit")),!1;var i=this._getValidatedValue(t);return i!==e&&(i!==t?(this.value=i,!1):void 0)},t.prototype._applyValue=function(e,t){this._updateCursor(),this._updateTooltipText(),this.fire("change")},t.prototype._applyMinValue=function(){this._validateValue(this.value)},t.prototype._applyMaxValue=function(){this._validateValue(this.value)},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("value")&&this._applyValue(t.value,this.value),this.isDirty("disabled")&&this._applyDisabled(),this.isDirty("valuePopupFlag")&&this._applyValuePopupFlag(),this.isDirty("displayStyle")?this._applyDisplayStyle():this.isDirty("sliderButtonStyle")&&this.__resolveCssClasses()},t.prototype._applyDisabled=function(){if(e.prototype._applyDisabled.call(this),this.disabled){this.elements.container.removeAttribute("tabindex");for(var t=0,i=this._cursors;t<i.length;t++){i[t].setAttributeNode(document.createAttribute("disabled"))}}else{this.elements.container.setAttribute("tabindex","0");for(var n=0,s=this._cursors;n<s.length;n++){s[n].removeAttribute("disabled")}}},t.prototype._onFocusReceived=function(){this.elements.container.focus()},t.prototype._giveFocus=function(){this.elements.container.focus()},t.prototype.increment=function(e){if(void 0!==this.value){var t;if("number"==typeof this.value)t=this.value;else if("object"==typeof this.value){if(e||(e=0),e<0||e>=this.value.length)return;t=this.value[e]}var i=this._clampInValue(t+this.stepValue,e);if("number"==typeof this.value)this.value=i;else{var n=__spreadArray([],this.value,!0);n[e]=i,this.value=n}}},t.prototype.decrement=function(e){if(void 0!==this.value){var t;if("number"==typeof this.value)t=this.value;else if("object"==typeof this.value){if(e||(e=0),e<0||e>=this.value.length)return;t=this.value[e]}var i=this._clampInValue(t-this.stepValue,e);if("number"==typeof this.value)this.value=i;else{var n=__spreadArray([],this.value,!0);n[e]=i,this.value=n}}},t.prototype._updateCursor=function(){var e;if("number"==typeof this.value||void 0===this.value||null===this.value?e=1:"object"==typeof this.value&&(e=this.value.length),this._cursors.length>e&&(this._cursors=this._cursors.splice(e,this._cursors.length-e)),this._cursors.length<e)for(var t=this._cursors.length,i=t;i<=e-t;i++)this._buildCursorView();var n,s=(a=this.getPercentage())+"%",o=this.getPercentage(0);"object"==typeof this.value&&void 0!==this.value&&null!==this.value&&(n=this.getPercentage(this.value.length-1)),"horizontal"===this.displayStyle?void 0===n?this.elements.sliderBackgroundFilled.setStyles({top:"",height:"",width:s}):this.elements.sliderBackgroundFilled.setStyles({top:"",height:"",left:o+"%",width:n-o+"%"}):void 0===n?this.elements.sliderBackgroundFilled.setStyles({top:100-a+"%",height:s,width:""}):this.elements.sliderBackgroundFilled.setStyles({top:100-n+"%",height:n-o+"%",width:""}),this.elements.sliderBackgroundFilled.removeAttribute("minimum-value"),this.elements.sliderBackgroundFilled.removeAttribute("maximum-value"),this.elements.sliderBackgroundFilled.removeAttribute("null-range"),this.elements.sliderBackgroundFilled.removeAttribute("range"),100!==n&&100!==o||this.elements.sliderBackgroundFilled.setAttributeNode(document.createAttribute("maximum-value")),0!==o&&0!==n||this.elements.sliderBackgroundFilled.setAttributeNode(document.createAttribute("minimum-value")),void 0!==n&&o===n||void 0===n&&0===o?this.elements.sliderBackgroundFilled.setAttributeNode(document.createAttribute("null-range")):void 0!==n&&this.elements.sliderBackgroundFilled.setAttributeNode(document.createAttribute("range"));for(var l=0;l<this._cursors.length;l++){var a,r=this._cursors[l];s=(a=this.getPercentage(l))+"%";void 0===this.value||null===this.value?r.addClassName("undefined-class"):r.removeClassName("undefined-class"),"horizontal"===this.displayStyle?r.setStyles({bottom:"",left:s}):r.setStyles({bottom:s,left:""})}},t.prototype._getValidatedSingleValue=function(e,t,i){var n=void 0,o=n=isNaN(e)?0:null!=e?parseFloat(s.round(e,this.stepValue)):e;return null!=n&&s.isNumber(t)&&s.isNumber(i)&&(o=s.clamp(t,i,n)),o},t.prototype._clampInValue=function(e,t){if(null==e)return e;var i=this.value;if(-1===t&&(t=0),"object"==typeof i){var n=0===t?this.minValue:i[t-1],s=t===i.length-1?this.maxValue:i[t+1];return this._getValidatedSingleValue(e,n,s)}return this._getValidatedSingleValue(e,this.minValue,this.maxValue)},t.prototype._getValidatedValue=function(e){if(null==e)return e;if("number"==typeof e)return this._getValidatedSingleValue(e,this.minValue,this.maxValue);if(void 0!==this._currentHandlerIndex){var t=0===this._currentHandlerIndex?this.minValue:e[this._currentHandlerIndex-1],i=this._currentHandlerIndex===e.length-1?this.maxValue:e[this._currentHandlerIndex+1];e[this._currentHandlerIndex]=this._getValidatedSingleValue(e[this._currentHandlerIndex],t,i)}for(var n=0;n<e.length;n++)if(n!==this._currentHandlerIndex){t=0===n?this.minValue:e[n-1],i=n===e.length-1?this.maxValue:e[n+1];e[n]=this._getValidatedSingleValue(e[n],t,i)}return e},t.prototype._validateValue=function(e){var t=this._getValidatedValue(e);void 0!==t&&this.value!==t&&(this.value=t),this._updateCursor()},t.prototype.getTextFromValue=function(e){if(void 0!==this.value&&null!==this.value)return void 0===e||"number"==typeof this.value||0===this.value.length?this.value+"":(e=s.clamp(0,this.value.length-1,e),this.value[e]+"")},t.prototype._computePercentageFromValue=function(e){var t=(e-this.minValue)/(this.maxValue-this.minValue)*100;return t=(t=t>=0?t:0)<=100?t:100},t.prototype.getPercentage=function(e){var t;return void 0===this.value||null===this.value?0:("number"==typeof this.value?t=this.value:"object"==typeof this.value&&(t=this.value[void 0!==e?e:0]),this._computePercentageFromValue(t))},t.prototype.setPercentage=function(e){this.value=e/100*(this.maxValue-this.minValue)+this.minValue},t.prototype._updateTooltipText=function(){if(this.valuePopupFlag&&this.elements.spanTooltip){var e=this.getTextFromValue(this._closestHandlerIndex);e?(this.elements.spanTooltip.textContent=e,this._updateOffsetTooltipSlider()):this.elements.popup&&this.elements.popup.hide()}},t.prototype._updateOffsetTooltipSlider=function(){if(this.elements.popup){this.elements.popup.positionTarget=this._cursors[this._closestHandlerIndex];var e=this._getOffsetTooltipSlider();e&&(this.elements.popup.offset=e),this.elements.popup._updateView()}},t.prototype._getOffsetTooltipSlider=function(){return"accurate"===this.sliderButtonStyle&&"vertical"===this.displayStyle&&"right"===this._getComputedPosition()?{right:{x:this.touchMode?18:10,y:0}}:"accurate"===this.sliderButtonStyle&&"horizontal"===this.displayStyle&&"bottom"===this._getComputedPosition()?{bottom:{x:0,y:this.touchMode?18:10}}:{left:{x:0,y:0},right:{x:0,y:0},top:{x:0,y:0},bottom:{x:0,y:0}}},t.prototype.handleEvents=function(){var e,t=this,n=0,l=0,h=0,u=t.elements.container;function c(e){if("number"==typeof t.value||void 0===t.value||null===t.value)t.setPropertyFromUIInteraction("value",e);else{var i=__spreadArray([],t.value,!0);i[t._currentHandlerIndex]=e,t.setPropertyFromUIInteraction("value",i)}}function d(i){if(!t.disabled){i.preventDefault();var o=void 0;"horizontal"===t.displayStyle?(e=i.clientX-l+n,e=s.clamp(0,h,e),0!==h&&t.maxValue!==t.minValue&&(o=e/h*(t.maxValue-t.minValue)+t.minValue)):(e=i.clientY-l+n,e=s.clamp(0,h,s.round(e,1)),0!==h&&t.maxValue!==t.minValue&&(o=(h-e)/h*(t.maxValue-t.minValue)+t.minValue)),void 0!==o&&c(o=t._clampInValue(o,t._currentHandlerIndex)),t._updateOffsetTooltipSlider()}}function p(e){t._currentHandlerIndex=-1;var i=o.getDocumentOwner(t.getContent());o.removeEventOnElement(t,i,r.POINTERMOVE,d),o.removeEventOnElement(t,i,r.POINTERUP,p),t.disabled||(t.initialValue=t.value,e.preventDefault(),e.stopPropagation(),t._inEdition&&(t._inEdition=!1,t.fire("endEdit"))),e.touchFlag&&(t.valuePopupFlag&&t.elements.popup.hide(),t._resetClosestHandlerIndex())}o.addEventOnElement(this,this.elements.sliderContainer,r.POINTERMOVE,function(e){0===e.originalEvent.buttons&&(t._closestHandlerIndex=t._findClosestHandlerIndex(e),t._updateTooltipText())},!1),o.addEventOnElement(this,u,r.POINTERDOWN,function(e){if(e.touchFlag&&(t._closestHandlerIndex=t._findClosestHandlerIndex(e)),e.stopPropagation(),!t.disabled){var i=o.getDocumentOwner(t.getContent());o.addEventOnElement(t,i,r.POINTERMOVE,d),o.addEventOnElement(t,i,r.POINTERUP,p),t.initialValue=t.value;var a=t.elements.sliderContainer;if(t._currentHandlerIndex=t._closestHandlerIndex,"horizontal"===t.displayStyle){l=e.clientX,h=a.clientWidth;var m=e.offsetX;if(t.fire("beginEdit",{pointerDown:!0}),t._inEdition=!0,0!==h&&t.maxValue!==t.minValue){n=Math.round(m);var g=(n=s.clamp(0,h,n))/h*(t.maxValue-t.minValue)+t.minValue;c(g=t._clampInValue(g,t._currentHandlerIndex))}}else l=e.clientY,h=a.clientHeight,m=e.clientY-Math.floor(a.getBoundingClientRect().top),t.fire("beginEdit"),t._inEdition=!0,0!==h&&t.maxValue!==t.minValue&&(n=Math.round(m),n=s.clamp(0,h,n),g=(h-n)/h*(t.maxValue-t.minValue)+t.minValue,c(g=t._clampInValue(g,t._currentHandlerIndex)));u.focus(),t.valuePopupFlag&&t.elements.popup&&t._updateOffsetTooltipSlider()}}),o.addEventOnElement(this,u,"mousewheel",function(e){var n=o.getDocumentOwner(t.getContent());if(!t.disabled&&(t.elements.container===n.activeElement||t.getContent().hasAttribute("focused"))){e.preventDefault(),e.stopPropagation();var s=i.Event.wheelDelta(e);t.fire("beginEdit"),t._inEdition=!0,s>0?t.callMethodFromUIInteraction("increment",t._closestHandlerIndex):t.callMethodFromUIInteraction("decrement",t._closestHandlerIndex),t._inEdition&&(t._inEdition=!1,t.fire("endEdit"))}}),o.addEventOnElement(this,u,"keyup",function(e){!t.disabled&&t.keyDown&&(a.decrease(e.keyCode)||a.increase(e.keyCode))&&(e.preventDefault(),e.stopPropagation(),t.keyDown=!1,(e.keyCode!==a.ESCAPE||e.keyCode===a.ESCAPE&&!0===e.actionPerformed)&&t._inEdition&&(t._inEdition=!1,t.fire("endEdit")))}),o.addEventOnElement(this,u,"keydown",function(e){(!t.disabled&&a.decrease(e.keyCode)||a.increase(e.keyCode))&&(t.keyDown||(t.keyDown=!0,t.fire("beginEdit"),t._inEdition=!0),a.decrease(e.keyCode)?t.callMethodFromUIInteraction("decrement"):t.callMethodFromUIInteraction("increment"),e.preventDefault(),e.stopPropagation())})},t.prototype._resetClosestHandlerIndex=function(){var e=this;void 0!==e._closestHandlerIndex&&-1!==e._closestHandlerIndex&&(e._cursors[e._closestHandlerIndex]&&e._cursors[e._closestHandlerIndex].removeClassName("wux-closest-cursor"),e._closestHandlerIndex=-1)},t.prototype._computeValueFromCursorPosition=function(e){var t=this;if(null==e)return Array.isArray(t.value)?t.value[0]:t.value;if(t.maxValue===t.minValue)return t.maxValue;if("horizontal"===t.displayStyle){if(0===t.elements.sliderContainer.clientWidth)return 0;var i=s.clamp(0,t.elements.sliderContainer.clientWidth,Math.round(e));return parseFloat(s.round(i/t.elements.sliderContainer.clientWidth*(t.maxValue-t.minValue)+t.minValue))}if(0===t.elements.sliderContainer.clientHeight)return 0;i=s.clamp(0,t.elements.sliderContainer.clientHeight,Math.round(t.elements.sliderContainer.clientHeight-e));return parseFloat(s.round(i/t.elements.sliderContainer.clientHeight*(t.maxValue-t.minValue)+t.minValue))},t.prototype._findClosestHandlerIndex=function(e){for(var t=this,i=t._findClosestHandlerIndexFromValue(t._computeValueFromCursorPosition("horizontal"===t.displayStyle?e.offsetX:e.offsetY)),n=0;n<t._cursors.length;n++){var s=t._cursors[n];n===i?s.addClassName("wux-closest-cursor"):s.removeClassName("wux-closest-cursor")}return i},t.prototype._findClosestHandlerIndexFromValue=function(e){for(var t=this._computePercentageFromValue(e),i=100,n=-1,s=0;s<this._cursors.length;s++){var o=this.getPercentage(s),l=Math.abs(o-t);(l===i&&(t>o||0===o)||l<i)&&(i=l,n=s)}return n},t}(n);return h.addClass(d,"slider"),d.prototype.markForRecordFlag=!0,l.register(d,"DS/ControlsRec/AbstractRec"),d.prototype.blackBoxFlag=!0,d});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/ColoredSlider",["require","exports","UWA/Core","DS/Utilities/Color","DS/Controls/Slider","DS/Core/WebUXComponents","DS/Utilities/WUXUWAUtils"],function(e,t,i,n,s,o,l){"use strict";var a=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return l.extendingClassFlag,n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{minValue:{defaultValue:0,type:"number",category:"Behavior"},maxValue:{defaultValue:255,type:"number",category:"Behavior"},stepValue:{defaultValue:1,type:"number",category:"Behavior"},colorFrom:{defaultValue:"#000",type:"string",category:"Appearance"},colorTo:{defaultValue:"#fff",type:"string",category:"Appearance"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){e.prototype.buildView.call(this),this.elements.container.addClassName("wux-controls-colorslider"),this.elements.sliderBackgroundFilled.remove(),this.elements.sliderTransparentBackground=i.Element("div",{class:"wux-controls-slider-transparent-background"}).inject(this.elements.sliderContainer,"top"),this.elements.sliderCursorColoredBackground=i.Element("div",{class:"wux-controls-slider-cursor-colored-background"}).inject(this._cursors[0])},t.prototype.handleEvents=function(){e.prototype.handleEvents.call(this)},t.prototype._applyColorFrom=function(){this._updateBackground(),this._updateCursor()},t.prototype._applyColorTo=function(){this._updateBackground(),this._updateCursor()},t.prototype.__resolveCssClasses=function(){e.prototype.__resolveCssClasses.call(this),this._updateBackground()},t.prototype._updateCursor=function(){e.prototype._updateCursor.call(this);var t=this.getPercentage()/100,i=this.colorFrom,s=this.colorTo;"transparent"===i&&(i="#fff",this.elements.sliderCursorColoredBackground.setStyle("opacity",t)),"transparent"===s&&(s="#fff",this.elements.sliderCursorColoredBackground.setStyle("opacity",1-t));for(var o=n.lerpColorHex(i,s,t),l=0,a=this._cursors;l<a.length;l++){a[l].setStyle("background-position-x",200*t+"px, 0px")}this.elements.sliderCursorColoredBackground.setStyle("background-color","#"+o)},t.prototype._updateBackground=function(){this.colorFrom=r(this.colorFrom),this.colorTo=r(this.colorTo);var e="linear-gradient(";e+=("horizontal"===this.displayStyle?"to right":"to top")+", "+this.colorFrom+", "+this.colorTo+")",this.elements.sliderBackground.setStyle("background",e)},t}(s);function r(e){return"transparent"===e?e:"string"!=typeof e?"#000":("#"===e.charAt(0)&&(e=e.substr(1)),3===e.length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),6===e.length?"#"+e:"#000")}return o.addClass(a,"coloredSlider"),a}),define("DS/Controls/Loader",["UWA/Core","UWA/Fx","DS/Controls/Abstract","DS/CoreEvents/ModelEvents","i18n!DS/Controls/assets/nls/translation","DS/Controls/ProgressBar","DS/Controls/Button","DS/Utilities/Utils","DS/Utilities/Dom"],function(e,t,i,n,s,o,l,a,r){"use strict";var h=i.inherit({name:"loader",publishedProperties:{fadeDuration:{defaultValue:1e3,type:"number",category:"Appearance"},text:{defaultValue:"",type:"string",category:"Appearance"},showButtonFlag:{defaultValue:!1,type:"boolean",category:"Appearance"},height:{defaultValue:60,type:"number",category:"Appearance"},allowUnsafeHTMLText:{defaultValue:void 0,type:"boolean",category:"Behavior"}},_loaderClass:"wux-controls-loader",buildView:function(){this._modelEvents=new n,this.elements.container.addClassName(this._loaderClass+" wux-font-3dsregular"),this.elements.progressBar=new o({shape:"circular",infiniteFlag:!0,statusFlag:!1}).inject(this.elements.container),this.elements.label=e.Element("span",{class:this._loaderClass+"-label"}).inject(this.elements.container),this.elements.stopButton=new l({label:s.get("cancel"),emphasize:"primary"}).inject(this.elements.container),this.hide(),this._loaderCounter=0,this._loaderMessages=[]},handleEvents:function(){var e=this;r.addEventOnElement(this,this.elements.stopButton,"buttonclick",function(t){u.call(e),this._loaderCounter=0})},_applyRecId:function(e){this.elements.stopButton.recId=this.recId},_applyHeight:function(e){this.elements.progressBar.height=this.height,e!==this.height&&this.fire("dimensionsChanged")},_applyProperties:function(e){this._parent(e),(this.isDirty("allowUnsafeHTMLText")||this.isDirty("text"))&&this._applyText(e.text),this.isDirty("height")&&this._applyHeight(e.height),this._applyShowButtonFlag()},process:function(){c.call(this)},on:function(e){this._loaderCounter++,e&&(this._loaderMessages.push(e),this.text=e),1===this._loaderCounter&&c.call(this),this.elements.container.show()},update:function(e){e?(e=e.replace("%",""),this.elements.progressBar.infiniteFlag=!1,this.elements.progressBar.value=e,this.elements.progressBar.statusFlag=!0):(this.elements.progressBar.infiniteFlag=!0,this.elements.progressBar.value=this.elements.progressBar.publishedProperties.value.defaultValue,this.elements.progressBar.statusFlag=!1)},off:function(e){if(!(this._loaderCounter<=0)){if(this._loaderCounter--,e){var t=this._loaderMessages.indexOf(e);-1!==t&&(this._loaderMessages.splice(t,1),this._loaderMessages.length>0?this.text=this._loaderMessages[this._loaderMessages.length-1]:this.text="")}0===this._loaderCounter&&(u.call(this),this._loaderMessages.length>0&&(this._loaderMessages=[]))}},_applyText:function(){a.getUnsafeHTMLContentValueToApply(this.allowUnsafeHTMLText)?this.elements.label.setContent(this.text):this.elements.label.textContent=this.text},_applyAllowUnsafeHTMLText:function(){this._applyText(this.text)},_applyShowButtonFlag:function(){this.showButtonFlag?this.elements.stopButton.show():this.elements.stopButton.hide()}}),u=function(){var e=this;e.hide(),new t(e.elements.container,{duration:e.fadeDuration,transition:"linear",events:{onStart:function(){},onComplete:function(){e.showButtonFlag&&e.elements.stopButton.remove(),e._modelEvents.publish({event:"END",context:e})}}}).start({opacity:[1,0]}),e._loaderCounter=0},c=function(){var e=this;e.show(),new t(e.elements.container,{duration:e.fadeDuration,transition:"linear",events:{onStart:function(){e.showButtonFlag&&e.elements.stopButton.inject(e.elements.container)},onComplete:function(){e._modelEvents.publish({event:"START",context:e})}}}).start({opacity:[0,1]})};return h}),define("DS/Controls/ModalLoader",["UWA/Core","DS/Core/Core","DS/Controls/ModalContainer","DS/Controls/Loader","DS/Utilities/Dom","i18n!DS/Controls/assets/nls/translation"],function(e,t,i,n,s,o){"use strict";return{displayModalLoader:function(e,t,l){e&&(e._loaderDisplayed||(e._loaderDisplayed=new n),0===e._loaderDisplayed._loaderCounter&&i.createModal(e,e._loaderDisplayed.elements.container),t||(t=o.loading),e._loaderDisplayed.on(t),l&&(1===e._loaderDisplayed._loaderCounter?s.onNodeRendered(e._loaderDisplayed.elements.container,l):l()))},removeModalLoader:function(e,t){e._loaderDisplayed&&(t||(t=o.loading),e._loaderDisplayed.off(t),e._loaderDisplayed._loaderCounter<=0&&(i.removeModal(e),e._loaderDisplayed=void 0))}}}),define("DS/Controls/Find",["UWA/Core","DS/Utilities/Utils","DS/Controls/Abstract","DS/Controls/LineEditor","DS/Controls/Toggle","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Controls/Loader","i18n!DS/Controls/assets/nls/translation"],function(e,t,i,n,s,o,l,a,r){"use strict";return i.inherit({name:"Find",markForRecordFlag:!0,publishedProperties:{findStr:{defaultValue:"",type:"string",category:"Appearance"},count:{defaultValue:void 0,type:"number"},matchCase:{defaultValue:!1,type:"boolean"},displayMatchCaseToggle:{defaultValue:!1,type:"boolean"},displayNavigationButtons:{defaultValue:!0,type:"boolean"},displayClose:{defaultValue:!0,type:"boolean"},relatedWidget:{defaultValue:void 0,type:"object"},onFindRequest:{defaultValue:void 0,type:"function"},onFindPreviousResult:{defaultValue:void 0,type:"function"},onFindNextResult:{defaultValue:void 0,type:"function"},onFindClose:{defaultValue:void 0,type:"function"},placeholder:{defaultValue:"",type:"string",category:"Appearance"},noContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}},buildView:function(){var t=this;this.elements.container.addClassName("wux-controls-find"),this.elements.findContainer=new e.Element("div",{class:"wux-controls-find-container"}).inject(this.elements.container),this.elements.findEditor=new n({selectAllOnFocus:!0,sizeInCharNumber:22,displayStyle:"lite"}).inject(this.elements.findContainer),this.elements.findEditor.getContent().addClassName("wux-controls-find-editor"),l.addEventOnElement(this,this.elements.findEditor.getContent(),"keydown",function(i){var n=e.Event.whichKey(i);"return"===n?(t.elements.findEditor.valueToCommit===t.findStr&&(t._debounceLaunched?t._launchFindOnRelatedWidget(void 0):t._goToNextFindResult()),i.stopPropagation()):"shift+return"===n?(t.elements.findEditor.valueToCommit===t.findStr&&t._goToPreviousFindResult(),i.stopPropagation()):"esc"===n&&(t.elements.findEditor.valueToCommit===t.findStr&&t.close(),i.stopPropagation())}),this.elements.findCounter=new e.Element("span",{class:"wux-controls-find-counter"}).inject(this.elements.findContainer),this._displayCurrentValue()},_launchFindOnRelatedWidget:function(e,i){var n=this;this.findStr=this.elements.findEditor.valueToCommit;var s=function(t){(n._debounceLaunched||t)&&(n._debounceLaunched=!1,n.onFindRequest&&n.relatedWidget&&n.onFindRequest.call(n.relatedWidget,n.findStr,n.matchCase,e))};this._debouncedLaunchFind||(this._debouncedLaunchFind=t.debounce(s,500)),i?(this._debounceLaunched=!0,this._debouncedLaunchFind()):s.call(this,!0)},_applyProperties:function(e){this.isDirty("displayNavigationButtons")&&this._applyDisplayNavigationButtons(e.displayNavigationButtons),this._parent(e),this.isDirty("findStr")&&this._applyFindStr(e.findStr),this.isDirty("count")&&this._applyCount(e.count),this.isDirty("matchCase")&&this._applyCount(e.matchCase),this.isDirty("displayMatchCaseToggle")&&this._applyDisplayMatchCaseToggle(e.displayMatchCaseToggle),this.isDirty("displayClose")&&this._applyDisplayClose(e.displayClose),this.isDirty("relatedWidget")&&this._applyRelatedWidget(e.relatedWidget),this.isDirty("placeholder")&&this._applyPlaceholder(e.placeholder)},_applyFindStr:function(e){(e||this.findStr)&&this.findStr!==e&&(this.elements.findEditor.valueToCommit!==this.findStr&&(this.elements.findEditor.value=this.findStr),this._launchFindOnRelatedWidget(void 0,!0))},_applyCount:function(e){this.count>0?this.currentValue=1:this.currentValue=0,this._displayCurrentValue()},_applyMatchCase:function(e){this.matchCase!==e&&(this.count=0,this._launchFindOnRelatedWidget(),this.elements.matchCaseToggle&&(this.elements.matchCaseToggle.checkFlag=this.matchCase))},_applyDisplayMatchCaseToggle:function(t){var i=this;this.displayMatchCaseToggle?this.elements.matchCaseContainer?this.elements.matchCaseContainer.style.display="":(this.elements.matchCaseContainer=new e.Element("div",{class:"wux-controls-find-matchcase-container"}).inject(this.elements.findContainer,"after"),this.elements.matchCaseToggle=new s({label:r.get("matchCase"),checkFlag:this.matchCase}).inject(this.elements.matchCaseContainer),this.elements.matchCaseToggle.getContent().addClassName("wux-controls-find-matchcase-toggle"),l.addEventOnElement(this,this.elements.matchCaseToggle,"change",function(e){i.matchCase=i.elements.matchCaseToggle.checkFlag})):this.elements.matchCaseContainer&&(this.elements.matchCaseContainer.style.display="none")},_applyDisplayNavigationButtons:function(t){if(this.displayNavigationButtons){if(!this.elements.previousResult){var i=this;this.elements.separator=new e.Element("div",{class:"wux-controls-find-separator",html:"|"}).inject(this.elements.findCounter,"after"),this.elements.previousResult=new e.Element("div",{class:"wux-controls-find-previous"}).inject(this.elements.separator,"after"),l.generateIcon("chevron-up",{target:this.elements.previousResult}),this.elements.nextResult=new e.Element("div",{class:"wux-controls-find-next"}).inject(this.elements.previousResult,"after"),l.generateIcon("chevron-down",{target:this.elements.nextResult}),l.addEventOnElement(this,this.elements.previousResult,o.POINTERHIT,function(e){i.disabled||(i._goToPreviousFindResult(),e.stopPropagation())}),l.addEventOnElement(this,this.elements.nextResult,o.POINTERHIT,function(e){i.disabled||(i._goToNextFindResult(),e.stopPropagation())})}this.elements.container.setAttribute("display-navigation-buttons","")}else this.elements.container.removeAttribute("display-navigation-buttons")},_applyDisplayClose:function(t){var i=this;this.displayClose?this.elements.closeFind?this.elements.closeFind.style.display="":(this.elements.closeFind=new e.Element("div",{class:"wux-controls-find-close"}).inject(this.elements.findContainer),l.generateIcon("close",{target:this.elements.closeFind}),l.addEventOnElement(this,this.elements.closeFind,o.POINTERHIT,function(e){i.close(),e.stopPropagation()})):this.elements.closeFind&&(this.elements.closeFind.style.display="none")},_applyRelatedWidget:function(){this.relatedWidget&&(this.relatedWidget.findWidget=this)},_applyVisibleFlag:function(e){this._parent(e),this.visibleFlag&&this._launchFindOnRelatedWidget(this.currentValue)},_applyPlaceholder:function(){this.elements.findEditor&&(this.elements.findEditor.placeholder=this.placeholder)},_applyDisabled:function(){this.elements.findEditor.disabled=this.disabled,this._updatePreviousAndNextDisabledState()},_displayCurrentValue:function(){this.elements.findCounter&&(this.elements.findCounter.innerText=this.findStr&&""!==this.findStr&&void 0!==this.currentValue&&void 0!==this.count?this.currentValue+"/"+this.count:""),this._updatePreviousAndNextDisabledState()},_updatePreviousAndNextDisabledState:function(){var e=!(this.count>1&&!this.disabled);this.elements.previousResult&&this.elements.nextResult&&(this.elements.previousResult.disabled=e,this.elements.nextResult.disabled=e,e?(this.elements.previousResult.setAttributeNode(document.createAttribute("disabled")),this.elements.nextResult.setAttributeNode(document.createAttribute("disabled"))):(this.elements.previousResult.removeAttribute("disabled"),this.elements.nextResult.removeAttribute("disabled")))},_goToPreviousFindResult:function(){var e=this,t=e.currentValue;e.count&&0!==e.count&&(e.currentValue>1?e.currentValue--:e.currentValue=e.count,e._displayCurrentValue()),e.currentValue&&t!==e.currentValue&&e.onFindPreviousResult&&e.relatedWidget&&e.onFindPreviousResult.call(e.relatedWidget)},_goToNextFindResult:function(){var e=this,t=e.currentValue;e.count&&0!==e.count&&(e.currentValue<e.count?e.currentValue++:e.currentValue=1,e._displayCurrentValue()),e.currentValue&&t!==e.currentValue&&e.onFindNextResult&&e.relatedWidget&&e.onFindNextResult.call(e.relatedWidget)},handleEvents:function(){var e=this;l.addEventOnElement(this,this.elements.findEditor,"uncommittedChange",function(t){e.findStr=e.elements.findEditor.valueToCommit}),l.addEventOnElement(this,this.elements.findContainer,o.POINTERHIT,function(t){e._giveFocus()})},setCurrentValue:function(e){this.currentValue=e,this._displayCurrentValue()},close:function(){this.visibleFlag=!1,this.onFindClose&&this.relatedWidget&&this.onFindClose.call(this.relatedWidget)},destroy:function(){this.relatedWidget&&(this.relatedWidget.findWidget=null,this.relatedWidget=null),this._parent()},setLoadingState:function(e){this.elements.findLoader||(this.elements.findLoader=new a({height:20,infiniteFlag:!0,visibleFlag:!1}).inject(this.elements.findEditor.getContent(),"after"),this.elements.findLoader.getContent().addClassName("wux-controls-find-loader")),this.elements.findLoader.visibleFlag=e},_getElementToFocus:function(){return this.elements.findEditor._myInput}})});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/GradientSlider",["require","exports","UWA/Core","DS/Core/PointerEvents","DS/Core/WebUXComponents","DS/Utilities/Color","DS/Controls/Slider","DS/WebRecordEnabler/Adapter","DS/Utilities/WUXUWAUtils"],function(e,t,i,n,s,o,l,a,r){"use strict";var h=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return r.extendingClassFlag,n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{gradientType:{defaultValue:"Hue",type:"string"},modulationColor:{defaultValue:void 0,type:"array"}}},enumerable:!1,configurable:!0}),t.prototype._getOffsetTooltipSlider=function(){return"accurate"===this.sliderButtonStyle&&"vertical"===this.displayStyle&&"right"===this._getComputedPosition()?{right:{x:this.touchMode?18:14,y:0}}:"accurate"===this.sliderButtonStyle&&"horizontal"===this.displayStyle&&"bottom"===this._getComputedPosition()?{bottom:{x:0,y:this.touchMode?18:14}}:{left:{x:0,y:0},right:{x:0,y:0},top:{x:0,y:0},bottom:{x:0,y:0}}},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("gradientType")&&this._applyGradientType(),this.isDirty("modulationColor")&&this._applyModulationColor()},t.prototype._preBuildView=function(t){e.prototype._preBuildView.call(this,t)},t.prototype.setColorSubAttribute=function(e,t){this.gradientType===e&&(this.value=t)},t.prototype._applyValue=function(e,t){this._applyingValue=!0,this._updateCursor(),this._updateTooltipText(),this.fire("change",{colorSubAttributeType:this.gradientType}),this._applyingValue=!1},t.prototype.buildView=function(){e.prototype.buildView.call(this),this.elements.container.addClassName("wux-controls-gradientslider"),this.elements.sliderBackgroundFilled.remove(),this.elements.canvasHuePicker=new i.Element("canvas",{class:"wux-controls-gradientslider-canvasHue"}),this.elements.canvasHuePicker.setStyle("height","100%"),this.elements.canvasHuePicker.setStyle("width","100%"),this.elements.canvasHuePicker.inject(this.elements.sliderBackground)},t.prototype._applyGradientType=function(){var e,t,i,n;void 0!==this.modulationColor&&(e=o.hsvToRgb(this.modulationColor),t=this.modulationColor,i=o.hsvToHsl(this.modulationColor)),"Hue"===this.gradientType?(this.maxValue=360,n=361,t&&(this.value=t[0])):"Saturation"===this.gradientType?(this.maxValue=100,n=101,t&&(this.value=t[1])):"HslSaturation"===this.gradientType?(this.maxValue=100,n=101,t&&(this.value=i[1])):"Value"===this.gradientType?(this.maxValue=100,n=101,t&&(this.value=t[2])):"Lightness"===this.gradientType?(this.maxValue=100,n=101,t&&(this.value=i[2])):"Red"===this.gradientType?(this.maxValue=255,n=256,t&&(this.value=e.r)):"Green"===this.gradientType?(this.maxValue=255,n=256,t&&(this.value=e.g)):"Blue"===this.gradientType?(this.maxValue=255,n=256,t&&(this.value=e.b)):"Alpha"===this.gradientType&&(this.maxValue=255,n=256,t&&(this.value=this.modulationColor[3])),this.elements.canvasHuePicker.width="vertical"===this.displayStyle?1:n,this.elements.canvasHuePicker.height="horizontal"===this.displayStyle?1:n,this.updateCanvas()},t.prototype._updateCursor=function(){e.prototype._updateCursor.call(this);for(var t=0,i=this._cursors;t<i.length;t++){var n=i[t],s=this._computeModulationColor();this._applyingValue&&!this.isDirty("modulationColor")&&(this.modulationColor=s);var l=o.hsvToRgb(s);l.a=255,n.setStyle("background-color",o.colorToCssColor(l))}},t.prototype._computeModulationColor=function(){var e,t=this.value;if(t="Alpha"===this.gradientType?void 0===this.value?255:t:void 0===this.value?0:t,"Hue"===this.gradientType)e=[t,(e=void 0!==this.modulationColor?this.modulationColor.slice():[0,100,100])[1],e[2]];else if("Saturation"===this.gradientType)e=[(e=void 0!==this.modulationColor?this.modulationColor.slice():[0,100,100])[0],t,e[2]];else if("Value"===this.gradientType)e=[(e=void 0!==this.modulationColor?this.modulationColor.slice():[0,100,100])[0],e[1],t];else if("HslSaturation"===this.gradientType){e=void 0!==this.modulationColor?this.modulationColor.slice():[0,100,100],(i=o.hsvToHsl(e))[1]=t,e=o.hslToHsv(i)}else if("Lightness"===this.gradientType){var i;e=void 0!==this.modulationColor?this.modulationColor.slice():[0,0,100],100!==(i=o.hsvToHsl(e))[2]&&100===this.value?this._hslSaturationBackup=i[1]:this._applyingValue&&!this.isDirty("modulationColor")&&100===i[2]&&100!==this.value?i[1]=this._hslSaturationBackup:0!==i[2]&&0===this.value?this._hslSaturationBackup=i[1]:this._applyingValue&&!this.isDirty("modulationColor")&&0===i[2]&&0!==this.value&&(i[1]=this._hslSaturationBackup),i[2]=t,e=o.hslToHsv(i)}else if("Red"===this.gradientType){e=void 0!==this.modulationColor?this.modulationColor.slice():[0,100,100],(n=o.hsvToRgb(e)).r=t,e=o.rgbToHsv(n.r,n.g,n.b,n.a)}else if("Green"===this.gradientType){e=void 0!==this.modulationColor?this.modulationColor.slice():[120,100,100],(n=o.hsvToRgb(e)).g=t,e=o.rgbToHsv(n.r,n.g,n.b,n.a)}else if("Blue"===this.gradientType){var n;e=void 0!==this.modulationColor?this.modulationColor.slice():[240,100,100],(n=o.hsvToRgb(e)).b=t,e=o.rgbToHsv(n.r,n.g,n.b,n.a)}else"Alpha"===this.gradientType&&((e=void 0!==this.modulationColor?this.modulationColor.slice():[0,0,100,255])[3]=t);return e},t.prototype._applyModulationColor=function(){this._applyingValue||this._updateCursor(),this.updateCanvas()},t.prototype.handleEvents=function(){e.prototype.handleEvents.call(this),this.elements.container.addEvent(n.POINTERDOWN,function(e){e.stopPropagation()}),this.elements.container.addEvent(n.POINTERMOVE,function(e){e.preventDefault()})},t.prototype.updateCanvas=function(){this.elements.canvasHuePicker.removeClassName("wux-controls-slider-alpha");var e=this.elements.canvasHuePicker.getContext("2d"),t=e.createLinearGradient(0,0,"vertical"===this.displayStyle?0:this.elements.canvasHuePicker.width,"vertical"===this.displayStyle?this.elements.canvasHuePicker.height:0),i="vertical"===this.displayStyle?1:0,n="vertical"===this.displayStyle?0:1;if("Hue"===this.gradientType)for(var s=!this.modulationColor||isNaN(this.modulationColor[0])||isNaN(this.modulationColor[1])||isNaN(this.modulationColor[2])?[0,100,100]:this.modulationColor,l=0;l<37;l++){var a,r=l/36;a="vertical"===this.displayStyle?[360*(1-r),s[1],s[2]]:[360*r,s[1],s[2]];var h=o.hsvToRgb(a),u=o.colorToCssColor(h);t.addColorStop(r,u)}else if("Red"===this.gradientType||"Green"===this.gradientType||"Blue"===this.gradientType){var c={r:(p=!this.modulationColor||isNaN(this.modulationColor[0])||isNaN(this.modulationColor[1])||isNaN(this.modulationColor[2])?{r:0,g:0,b:0}:o.hsvToRgb(this.modulationColor)).r,g:p.g,b:p.b},d={r:p.r,g:p.g,b:p.b};"Red"===this.gradientType?(c.r=0,d.r=255):"Green"===this.gradientType?(c.g=0,d.g=255):"Blue"===this.gradientType&&(c.b=0,d.b=255),t.addColorStop(i,o.colorToCssColor(c)),t.addColorStop(n,o.colorToCssColor(d))}else if("Alpha"===this.gradientType){c={r:255,g:255,b:255,a:0},d={r:255,g:255,b:255,a:0};t.addColorStop(i,o.colorToCssColor(c)),t.addColorStop(n,o.colorToCssColor(d)),this.elements.canvasHuePicker.addClassName("wux-controls-slider-alpha");var p=this.modulationColor?[this.modulationColor[0],this.modulationColor[1],this.modulationColor[2],255]:[0,0,100,255],m="horizontal"===this.displayStyle?"to right":"to top";this.elements.canvasHuePicker.setStyle("background-image","linear-gradient("+m+", transparent 0%, "+o.colorToCssColor(o.hsvToRgb(p))+" 100%)")}else{var g=!this.modulationColor||isNaN(this.modulationColor[0])||isNaN(this.modulationColor[1])||isNaN(this.modulationColor[2])?[0,100,100]:this.modulationColor;o.hsvToRgb(g);if("Saturation"===this.gradientType){var v=o.hsvToRgb([g[0],100,g[2]]),f=o.hsvToRgb([g[0],0,g[2]]);t.addColorStop(n,o.colorToCssColor(v)),t.addColorStop(i,o.colorToCssColor(f))}else if("HslSaturation"===this.gradientType){var y=o.hsvToHsl([g[0],g[1],g[2]]);v=o.hslToRgb([y[0],100,y[2]]),f=o.hslToRgb([y[0],0,y[2]]);t.addColorStop(n,o.colorToCssColor(v)),t.addColorStop(i,o.colorToCssColor(f))}else if("Value"===this.gradientType){var b=o.hsvToRgb([g[0],g[1],100]),_=o.hsvToRgb([g[0],g[1],0]);t.addColorStop(n,o.colorToCssColor(b)),t.addColorStop(i,o.colorToCssColor(_))}else if("Lightness"===this.gradientType){g=!this.modulationColor||isNaN(this.modulationColor[0])||isNaN(this.modulationColor[1])||isNaN(this.modulationColor[2])?[0,0,100]:this.modulationColor;y=o.hsvToHsl(g),b=void 0;b=0!==this.value&&100!==this.value||void 0===this._hslSaturationBackup?o.hslToRgb([y[0],y[1],50]):o.hslToRgb([y[0],this._hslSaturationBackup,50]),t.addColorStop(n,"white"),t.addColorStop(.5,o.colorToCssColor(b)),t.addColorStop(i,"black")}}e.fillStyle=t,e.fillRect(0,0,this.elements.canvasHuePicker.width,this.elements.canvasHuePicker.height)},t.prototype._getMousePos=function(e,t){var i=e.getBoundingClientRect();return{x:t.clientX-i.left,y:t.clientY-i.top}},t}(l);return s.addClass(h,"gradientSlider"),h.prototype.markForRecordFlag=!0,a.register(h,"DS/ControlsRec/AbstractRec"),h});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/SelectionChipsEditor",["require","exports","DS/Controls/Abstract","DS/Controls/SelectionChips","DS/Controls/LineEditor","DS/Utilities/Array","DS/Utilities/Dom","DS/Core/WebUXComponents","UWA/Core","DS/Utilities/WUXUWAUtils"],function(e,t,i,n,s,o,l,a,r,h){"use strict";var u=function(){function e(e){if("string"==typeof e&&e){var t=(this.value||[]).slice(0),i=!0;return this.uniqueValue?i=o.pushUnique(t,e):t.push(e),i?(this._properties.value.value=t,this._selectionChips&&this._selectionChips.addChip({label:e}),this.fire("change"),!0):(this._selectionChips&&this._selectionChips._flashEffectOnChip("ui-modified",t.indexOf(e)),!1)}}return function(t){if(this._lineEditor&&(this._lineEditor.value="",this._lineEditor.valueToCommit=""),!this.customValidator)return e.call(this,t);var i=this.customValidator(t);if(!(i instanceof Promise))return e.call(this,i);i.then(function(t){e.call(this,t)}.bind(this))}}();function c(e,t){if(e&&(t=t||[],Array.isArray(t))){var i=t.map(function(e){return{label:e}});e.removeAllChips(),e.addChips(i)}}var d=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return h.extendingClassFlag?n:(n.addKeyMapsAndCommands({tab:"manageTab","shift+tab":"manageTab",return:"manageReturn",esc:"manageEsc"},{manageTab:function(){var e=this._lineEditor.valueToCommit;return u.call(this,e),""!==e&&this.focus({preventScroll:!0}),{preventDefault:!0,stopPropagation:!1,infos:{actionPerformed:""!==e}}},manageReturn:function(e){return e.actionPerformed&&this.focus({preventScroll:!0}),{preventDefault:!0,stopPropagation:!1,infos:{actionPerformed:e.actionPerformed}}},manageEsc:function(){var e=Boolean(this._lineEditor.valueToCommit);return this._lineEditor.valueToCommit="",{preventDefault:!0,stopPropagation:!1,infos:{actionPerformed:e}}}}),n)}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{placeholder:{defaultValue:"",type:"string",category:"Appearance"},value:{defaultValue:void 0,type:"Array",category:"Appearance",advancedSetter:!0},uniqueValue:{defaultValue:!1,type:"Boolean",category:"Appearance"},customValidator:{defaultValue:void 0,type:"function",category:"Behavior"},selection:{defaultValue:{toggle:!0,mode:n.SELECTION_MODE.MULTIPLE_ONKEYS,unselectAllOnEmptyArea:!0},type:"object",category:"Behavior",noNeedToApplyFlag:!0},maxLength:{defaultValue:-1,type:"integer",category:"Appearance"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){this.elements.container.addClassName("wux-controls-selectionchipseditor"),this.elements.container.setAttribute("tabindex",0)},t.prototype._postBuildView=function(){this._lineEditor||this._selectionChips||(this._lineEditor=new s({placeholder:this.placeholder,displayStyle:"lite",fireOnlyFromUIInteractionFlag:!0,selectAllOnFocus:!0,disabled:this.disabled,touchMode:this.touchMode,maxLength:this.maxLength}),this._selectionChips=new n({fireOnlyFromUIInteractionFlag:!0,selection:this.selection,disabled:this.disabled,touchMode:this.touchMode}),this._selectionChips.addLastWidget(this._lineEditor),this._selectionChips.inject(this.elements.container),c(this._selectionChips,this.value))},t.prototype.handleEvents=function(){var e=this;l.addEventOnElement(this,this._lineEditor,"change",function(t){t.stopPropagation(),u.call(e,e._lineEditor.valueToCommit)}),l.addEventOnElement(this,this._selectionChips,"change",function(t){t.stopPropagation();var i=e._selectionChips.getAllChipsAsLabels();r.equals(i,e._properties.value.value)||(e._properties.value.value=i,e.fire("change"))})},t.prototype.addValues=function(e){if(e&&Array.isArray(e)){for(var t=(this.value||[]).slice(0),i=[],n=0;n<e.length;++n){var s=e[n];s&&"string"==typeof s&&(this.uniqueValue?o.pushUnique(t,s)&&i.push({label:s}):(t.push(s),i.push({label:s})))}i.length&&(this._properties.value.value=t,this._selectionChips&&this._selectionChips.addChips(i),this.fire("change"))}},t.prototype.removeValues=function(e){if(e&&Array.isArray(e)){for(var t=!1,i=0;i<e.length;++i){var n=e[i];n&&"string"==typeof n&&this._selectionChips&&this._selectionChips.removeChip(n)&&(t=!0)}t&&(this._properties.value.value=this._selectionChips.getAllChipsAsLabels(),this.fire("change"))}},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("placeholder")&&this._applyPlaceholder(t.placeholder,this.placeholder),this.isDirty("selection")&&this._applySelection(t.selection,this.selection),this.isDirty("uniqueValue")&&this._applyUniqueValue(t.uniqueValue,this.uniqueValue),this.isDirty("maxLength")&&this._applyMaxLength(t.maxLength,this.maxLength),this.isDirty("value")&&a._applyForAdvancedSetterProperty(this,"value",t.value,this.value)},t.prototype._applyPlaceholder=function(e,t){this._lineEditor&&(this._lineEditor.placeholder=t)},t.prototype._applySelection=function(e,t){this._selectionChips&&(this._selectionChips.selection=t)},t.prototype._applyUniqueValue=function(e,t){if(e!==t&&t&&!this.isDirty("value")){for(var i=[],n=this.value||[],s=0;s<n.length;++s)o.pushUnique(i,n[s]);n.length!==i.length&&(this._properties.value.value=i,this._applyValue(e,i))}},t.prototype._preEditValue=function(e,t){if(void 0===t)return!0;if(t&&"string"==typeof t)return{validValue:[t]};if(!Array.isArray(t))return!1;for(var i=[],n=0;n<t.length;++n){var s=t[n];if(s&&"string"==typeof s){var l=parseInt(this.maxLength);l>0&&(s=s.slice(0,l)),this.uniqueValue?o.pushUnique(i,s):i.push(s)}}return!r.equals(e,i)&&(!!r.equals(t,i)||{validValue:i})},t.prototype._applyValue=function(e,t){c(this._selectionChips,t),this.fire("change")},t.prototype._applyDisabled=function(){e.prototype._applyDisabled.call(this),this._lineEditor&&(this._lineEditor.disabled=this.disabled),this._selectionChips&&(this._selectionChips.disabled=this.disabled)},t.prototype._applyTouchMode=function(){e.prototype._applyTouchMode.call(this);var t=this._getCurrentTouchMode();t?this.elements.container.setAttributeNode(document.createAttribute("touch-mode")):this.elements.container.removeAttribute("touch-mode"),this._lineEditor&&(this._lineEditor.touchMode=t),this._selectionChips&&(this._selectionChips.touchMode=t)},t.prototype._applyMaxLength=function(e,t){this._lineEditor&&(this._lineEditor.maxLength=this.maxLength),a._applyForAdvancedSetterProperty(this,"value",this.value,this.value)},t.prototype._getElementToFocus=function(){return this._lineEditor&&this._lineEditor._getElementToFocus()},t.prototype.getSelectedChipsValue=function(){var e=[];this._selectionChips&&(e=this._selectionChips.getSelectedChipsOptions().map(function(e){return e.label}));return e},t.prototype.selectChip=function(e){return this._selectionChips&&this._selectionChips.selectChip(e)},t.prototype.selectAllChips=function(){return this._selectionChips&&this._selectionChips.selectAllChips()},t.prototype.unselectChip=function(e){return this._selectionChips&&this._selectionChips.unselectChip(e)},t.prototype.destroy=function(){this._lineEditor&&(this._lineEditor.destroy(),delete this._lineEditor),this._selectionChips&&(this._selectionChips.destroy(),delete this._selectionChips),e.prototype.destroy.call(this)},t}(i);return a.addClass(d,"selectionChipsEditor"),d}),define("DS/Controls/Knob",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","UWA/Controls/Scroller","DS/Utilities/Css3D","DS/Controls/Stack","DS/Controls/Gauge","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents"],function(e,t,i,n,s,o,l,a,r,h){"use strict";var u=i.extend({defaultOptions:{snap:0,value:0,stepValue:1,minValue:0,maxValue:360,graduations:12,graduationsLabel:!1,dynamicGraduations:!1,activeGraduationsColor:"#00FFF5",inactiveGraduationsColor:"#FF0000",graduationsLabelColor:"black",knobIndicator:"dot",knobMaterial:"pearl",turn:null,onChange:null,interactionMode:"rotate",theme:{display:"inline-block",fontSize:10,size:80}},init:function(e){this._parent(e),this._modelEvents=new h,this.startDeg=0,this.currentDeg=0,this.rotation=0,this.lastDeg=0,this._value=this.options.value,this._delta=this.options.maxValue-this.options.minValue,this._knobSize=parseInt(.75*this.options.theme.size,10),this._graduationSize={width:parseInt((this.options.theme.size-this._knobSize)/2,10),height:parseInt((this.options.theme.size-this._knobSize)/5,10)},this._buildSkeleton(),this._buildScaling(),this._attachBehaviors(),this._rotateKnob(this._valueToDeg(this.options.value))},_valueToDeg:function(e){return(e-this.options.minValue)/this._delta*360},_degToValue:function(e){return e/360*this._delta+this.options.minValue},_buildScaling:function(){var t,i=180/Math.PI,n=0,s=this.options.graduations,o=e.typeOf(s);t="array"===o?s.length:s;for(var l=0;l<t;l++){var a,r;if(this.options.dynamicGraduations)r="hsl("+(120-120*l/t)+", 100%, 50%)",a=0;else r=this.options.inactiveGraduationsColor,a=1;n="array"===o?this._valueToDeg(s[l].value):l*(360/t);var h=parseInt(this._graduationSize.height/4,10);this.options.dynamicGraduations&&(h=0);var u=new e.Element("div",{class:"wux-knob-scale",styles:{boxShadow:"inset 0 0 "+h+"px black",borderRadius:h,opacity:a}}),c=new e.Element("div",{styles:{position:"relative"}}).inject(u);if(this.options.graduationsLabel){var d,p;if(d="array"===o?s[l].label:this._degToValue(parseFloat(n)),"array"===o)switch(l){case 0:p=-parseInt(1.5*this.options.theme.fontSize,10);break;case t-1:p=0;break;default:p=-parseInt(this.options.theme.fontSize/2,10)}else p=-parseInt(this.options.theme.fontSize/2,10);new e.Element("div",{class:"wux-knob-scale-label",styles:{position:"absolute",transform:"rotate("+-n+"deg)",top:p,fontSize:this.options.theme.fontSize,whiteSpace:"nowrap",color:this.options.graduationsLabelColor},html:d.toString()}).inject(c)}var m=-Math.sin(n/i)*(this.options.theme.size-2*this._graduationSize.width)/2+this.options.theme.size/2-this._graduationSize.height/2+this.options.theme.fontSize,g=Math.cos((180-n)/i)*(this.options.theme.size-2*this._graduationSize.width)/2+(this.options.theme.size-this._graduationSize.width)/2+this.options.theme.fontSize;u.setStyles({backgroundColor:r,transform:"rotate("+n+"deg)",top:parseInt(m,10),left:parseInt(g,10),width:this._graduationSize.width,height:this._graduationSize.height}).inject(this.elements.container)}},turn:function(t){var i,n=this,s=this.elements.container.getElements(".wux-knob-scale"),o=-1;if((i=Math.ceil(s.length*t))===o)return!1;o=i,s.forEach(function(s,o){var l={},a=function(){s.addClassName("active"),n.options.dynamicGraduations?l.opacity=1:l.backgroundColor=n.options.activeGraduationsColor,s.setStyles(l)},r=function(){s.removeClassName("active"),n.options.dynamicGraduations?l.opacity=0:(l.opacity=1,l.backgroundColor=n.options.inactiveGraduationsColor),s.setStyles(l)},h=t*n._delta+n.options.minValue,u=n._degToValue(h),c=n.options.graduations;"array"===e.typeOf(c)?c[o].value<=u?a():r():o<i?a():r()})},_buildSkeleton:function(){this.elements.container=e.Element("div",{styles:{position:"relative",height:this.options.theme.size+2*this.options.theme.fontSize,width:this.options.theme.size+2*this.options.theme.fontSize,display:this.options.theme.display}}),this.elements.control=e.Element("div",{class:"wux-knob-control wux-ui-material-"+this.options.knobMaterial,styles:{position:"absolute",top:"50%",left:"50%",marginTop:-this._knobSize/2,marginLeft:-this._knobSize/2}}).inject(this.elements.container);var t="";this.options.theme.size>50&&(t=" wux-ui-size-big"),this.elements.knob=e.Element("div",{class:"wux-knob wux-ui-indicator-"+this.options.knobIndicator+" wux-ui-material-"+this.options.knobMaterial+t,styles:{height:this._knobSize,width:this._knobSize,borderRadius:"100%"}}).inject(this.elements.control),this.elements.knobTop=e.Element("div",{class:"wux-knob-top"}),this.elements.knobBottom=e.Element("div",{class:"wux-knob-bottom"})},_attachBehaviors:function(){var t=this,i=this.elements.container,n=this.elements.knob;i.addEvent(r.POINTERDOWN,function(i){i.preventDefault();var s,o,l,a=n.getDimensions(),h=n.getOffsets(),u=h.y+a.height/2,c=h.x+a.width/2,d=180/Math.PI,p=e.extendElement(document);if("vertical-slide"===t.options.interactionMode){var m,g=1;m=window.setInterval(function(){var e=Math.abs(s);g=e<200?Math.min(parseInt(e/200*5,10),5):5,s>0&&t.increment(g),s<0&&t.decrement(g)},50)}p.addEvent(r.POINTERMOVE,function(e){s=u-e.pageY,"rotate"===t.options.interactionMode&&(o=c-e.pageX,l=Math.atan2(s,o)*d,t._rotateKnob(l))}),p.addEvent(r.POINTERUP,function(){window.clearInterval(m),p.removeEvent(r.POINTERMOVE),p.removeEvent(r.POINTERUP),t.rotation=t.currentDeg,t.startDeg=-1})}),e.Element.addEvent.call(t.elements.container,"mousewheel",function(i){var n=e.Event.wheelDelta(i);i.shiftKey&&(n*=5),t.currentDeg+=n,t._rotateKnob(t.currentDeg)})},increment:function(e){var t=this.getValue()+e*this.options.stepValue;console.log("increment",this,this.getValue(),t,e),this.setValue(t)},decrement:function(e){var t=this.getValue()-e*this.options.stepValue;console.log("decrement",this,this.getValue(),t,e),this.setValue(t)},getValue:function(){return this._value},_rotateKnob:function(e){e<0&&(e=360+e),-1===this.startDeg&&(this.startDeg=e);var t=Math.floor(e-this.startDeg+this.rotation);if(t<0?t=360+t:t>359&&(t%=360),this.options.snap&&t<this.options.snap&&(t=0),Math.abs(t-this.lastDeg)>180)return!1;this.currentDeg=t,this.lastDeg=t,this.setValue(this._degToValue(this.currentDeg))},setValue:function(e,t){void 0===t&&(t=!0);var i=this.elements.knob;this._value=e,this.currentDeg=this._valueToDeg(e),i.setStyle("transform","rotate("+this.currentDeg+"deg)"),this.options.turn||(this.options.turn=this.turn),this.options.turn.call(this,this.currentDeg/360),t&&(this.options.onChange&&this.options.onChange.call(this,this.getValue()),this._modelEvents.publish({context:this,event:"change",data:this}))},addEvent:function(e,t){return this._subscribe(e,t)},_removeEvent:function(e){return this._modelEvents.unsubscribe(e)},_removeEventListener:function(e){return this._modelEvents.unsubscribe(e)},addEventOnce:function(e,t){return this._modelEvents.subscribeOnce({event:e},t)},addEventListener:function(e,t){return this._subscribe(e,t)},_subscribe:function(e,t){return this._modelEvents.subscribe({event:e},t)}});return e.namespace("WUX/Controls/Knob",u)}),define("DS/Controls/SmartInput",["UWA/Core","UWA/Event","UWA/Controls/Abstract","UWA/Controls/Form","UWA/Controls/ToolTip","DS/Controls/Stack","DS/Controls/Knob","UWA/Controls/DatePicker","DS/Controls/Switch"],function(e,t,i){"use strict";var n=i.extend({defaultOptions:{value:[0,0,0],labels:["x","y","z"],inputType:"number",onChange:null},init:function(e){this._parent(e),this._inputs=[],this._buildView(),this.setValue(this.options.value),this._value=this.getValue()},setValue:function(e){var t=this;this._value=[],e.forEach(function(e,i){t._inputs[i]&&t._inputs[i].setAttribute("value",e),t._value.push(e)})},getValue:function(){this._value=[];var e=this;return e._inputs.forEach(function(t,i){var n=t.value;e._value.push(n)}),this._value},_buildView:function(){this.elements.container=new e.Element("div",{class:"wux-input-vector"});var t=this;this.options.value.forEach(function(i,n){var s=new e.Element("div",{class:"wux-input-vector-label",styles:{textAlign:"right",display:"inline-block"}}).inject(t.elements.container),o=t.options.labels[n];o&&s.set({text:o+":",styles:{minWidth:40}});var l=new e.Element("input",{type:t.options.inputType,styles:{width:50,height:14},events:{change:function(){t.options.onChange&&t.options.onChange.call(t,t.getValue())}}}).inject(t.elements.container);t._inputs.push(l)})}}),s=i.extend({defaultOptions:{value:[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],onChange:null},init:function(e){this._parent(e);var t=this.options.value,i=this;this._upVector=new n({labels:["up"],value:t[0],inputType:"text",onChange:function(){i._onChange()}}),this._rightVector=new n({labels:["right"],value:t[1],inputType:"text",onChange:function(){i._onChange()}}),this._dirVector=new n({labels:["dir"],value:t[2],inputType:"text",onChange:function(){i._onChange()}}),this._posVector=new n({labels:["pos"],value:t[3],inputType:"text",onChange:function(){i._onChange()}}),this._buildView()},_onChange:function(){console.log("-"),this.options.onChange&&this.options.onChange.call(this,this.getValue())},setValue:function(e){this._value=[],this._upVector.setValue(e[0]),this._righVector.setValue(e[1]),this._dirVector.setValue(e[2]),this._posVector.setValue(e[3]),this._value.push(this._upVector.getValue()),this._value.push(this._rightVector.getValue()),this._value.push(this._dirVector.getValue()),this._value.push(this._posVector.getValue())},getValue:function(){return this._value=[],this._value.push(this._upVector.getValue()),this._value.push(this._rightVector.getValue()),this._value.push(this._dirVector.getValue()),this._value.push(this._posVector.getValue()),console.log(this._value),this._value},_buildView:function(){this.elements.container=new e.Element("div",{class:"wux-controls-matrix4x4"}),this.elements.container.addContent(this._upVector).addContent(this._rightVector).addContent(this._dirVector).addContent(this._posVector)}}),o=i.extend({defaultOptions:{value:10,minValue:0,maxValue:100,stepValue:1,onChange:null},init:function(e){this._parent(e),this._value=this.options.value,this._buildView()},_buildView:function(){var t=this;this.elements.container=new e.Element("ul",{class:"wux-input-distance"});var i=this.options.minValue.toString();this.options.minLabel&&(i=this.options.minLabel),this.elements.minValue=new e.Element("li",{html:i}).inject(this.elements.container),this.elements.inputRangeContainer=new e.Element("li",{}).inject(this.elements.container),this.elements.inputRange=new e.Element("input",{type:"range",min:this.options.minValue,max:this.options.maxValue,step:this.options.stepValue,events:{change:function(e){console.log("change"),t._value=t.elements.inputRange.value,t.elements.valueContainer.setHTML(t._value),t.options.onChange&&t.options.onChange.call(t,t._value),t.dispatchEvent("onChange")}}}).inject(this.elements.inputRangeContainer);var n=this.options.maxValue.toString();this.options.maxLabel&&(n=this.options.maxLabel),this.elements.maxValue=new e.Element("li",{html:n}).inject(this.elements.container),this.elements.valueContainer=new e.Element("div",{html:this._value.toString(),styles:{color:"#444",minWidth:50,fontWeight:"bold",backgroundColor:"#FFF",borderRadius:5}}).inject(this.elements.container)}});var l=i.extend({defaultOptions:{position:{parent:null,x:0,y:0},label:"Value",name:"smart_input",unit:"",kind:"string",value:void 0,inPlaceEdit:!1,editEvent:"click",rules:{minLength:null,maxLength:null,minValue:null,maxValue:null,unit:null,dataType:null},onConfirm:null,onCancel:null,onChange:null},init:function(e){this._parent(e),console.warn("deprecated","Please DO NOT use anymore Controls/SmartInput, use SmartInputs/* instead")},buildView:function(){var t=this;if(this._smartInput=function(t){var i,l,a=t.name;switch(t.kind){case"text":l=50,i=new e.Controls.Form({fields:[{type:"text",name:a,label:t.label,value:t.value}]});break;case"combo":l=50,i=new e.Controls.Form({fields:[{type:"range",name:a,label:t.label,value:t.value,step:t.rules.stepValue,min:t.rules.minValue,max:t.rules.maxValue}]});break;case"switch":l=50,i=new WUX.Controls.Switch({value:t.value,label:t.label,onChange:t.onChange});break;case"translation":l=40,i=new n({value:t.value,labels:["Tx","Ty","Tz"],onChange:t.onChange});break;case"matrix4x4":l=40;var r={};t.value&&(r.value=t.value),r.onChange=t.onChange,i=new s(r);break;case"vector":l=40,i=new n({value:t.value,onChange:t.onChange});break;case"rotation":l=40,i=new n({value:t.value,labels:["Rx","Ry","Rz"],onChange:t.onChange});break;case"direction":l=40,i=new n({value:t.value,labelX:"up",labelY:"right",labelZ:"dir",onChange:t.onChange});break;case"angle":l=100,void 0===t.value&&(t.value=0),i=new WUX.Controls.Knob({graduationsLabel:!0,value:t.value,minValue:0,maxValue:2*Math.PI,graduations:[{label:"0",value:0},{label:"&pi;/2",value:Math.PI/2},{label:"&pi;",value:Math.PI},{label:"3&pi;/2",value:3*Math.PI/2},{label:"2&pi;",value:2*Math.PI}],graduationsLabelColor:"black",activeGraduationsColor:"#3CF",inactiveGraduationsColor:"#CCC",knobIndicator:"line",knobMaterial:"pearl",onChange:t.onChange});break;case"intensity":void 0===t.value&&(t.value=0),l=100,i=new WUX.Controls.Knob({knobMaterial:"pearl",value:t.value,graduations:20,dynamicGraduations:!0,minValue:t.rules.minValue,maxValue:t.rules.maxValue,onChange:t.onChange});break;case"systemColor":l=24,i=new e.Element("input",{type:"color",styles:{height:12,padding:0,margin:0,border:"none"},name:a,value:t.value});break;case"distance":l=50,i=new o({value:t.value,minValue:t.rules.minValue,maxValue:t.rules.maxValue,stepValue:t.rules.stepValue,onChange:t.onChange});break;case"number":l=50,i=new e.Element("input",{type:"number",min:t.rules.minValue,max:t.rules.maxValue,step:t.rules.stepValue,name:a,value:t.value});break;case"date":i=new e.Controls.DatePicker({type:"date",format:"%e %b %Y"});break;default:l=50,i=new e.Controls.Form({fields:[{type:t.kind,name:a,label:t.label,value:t.value}]})}return i.getHeight=function(){return l},i}(this.options),this.options.inPlaceEdit)this.elements.container=new e.Element("div",{class:"wux-smartinput",html:this._smartInput});else{var i,l=new e.Element("button",{class:"wux-smartinput-button wux-smartinput-button-valid",html:"V",events:{click:function(){t._onConfirm.call(t)}}}),a=new e.Element("button",{class:"wux-smartinput-button wux-smartinput-button-cancel",html:"X",events:{click:function(){t._onCancel.call(t)}}}),r=this._smartInput.getHeight(),h=new WUX.Controls.Stack({styles:{height:r}});h.append(this._smartInput,{styles:{height:r,lineHeight:r+"px",verticalAlign:"middle"}}),h.append(l,{styles:{height:r,lineHeight:r+"px",verticalAlign:"middle"}}),h.append(a,{styles:{height:r,lineHeight:r+"px",verticalAlign:"middle"}}),i=t.options.value?this.options.value.toString()+" "+this.options.unit:this._smartInput.getValue(),this.elements.container=new e.Element("div",{class:"wux-smartinput",html:i}),this._tooltip=new e.Controls.ToolTip(this.elements.container,h,{className:"wux-smartinput-tooltip",showOver:!1,offsetX:10,offsetY:0}),this.elements.container.addEvent(this.options.editEvent,function(i){e.extendElement(document).getElements(".wux-smartinput-tooltip").forEach(function(e){e.hide()});var n=t.elements.container.getOffsets();n.y+=20,t._tooltip.show();var s=t._tooltip.elements.tooltip;s.setStyle("position","fixed"),s.show(),s.setPosition(n),t.options.relativePosition&&t._tooltip.elements.tooltip.inject(t.options.relativePosition)})}},_onConfirm:function(){var e=this.getValue();this.elements.container.setHTML(e+" "+this.options.unit),this.options.onConfirm&&this.options.onConfirm.call(this,{name:this.options.name,value:e}),this._tooltip.hide()},getValue:function(){var e;switch(this.options.kind){case"number":case"distance":e=this._smartInput._value;break;case"systemColor":e=this._smartInput.value;break;case"translation":case"rotation":case"angle":case"intensity":case"vector":case"matrix4x4":case"angle":e=this._smartInput.getValue().toString();break;case"switch":e=this._smartInput.getValue();break;case"date":e=this._smartInput.getDate().toString(),console.log(e);break;default:e=this._smartInput.getFormValue(this.options.name)}return e},_onCancel:function(){this.options.onCancel&&this.options.onCancel.call(this),this._tooltip.hide()},onConfirm:function(e){e&&(this.options.onConfirm=e)},onCancel:function(e){e&&(this.options.onCancel=e)}});return e.namespace("WUX/Controls/SmartInput",l)});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/ColorCanvas",["require","exports","DS/Controls/Abstract","UWA/Core","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Utilities/Utils","DS/Core/WebUXComponents","DS/Utilities/Color","DS/Utilities/WUXUWAUtils"],function(e,t,i,n,s,o,l,a,r,h){"use strict";var u=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return h.extendingClassFlag?n:(n.addKeyMapsAndCommands({esc:{keydown:"cancel"}},{cancel:function(){if(!this.handleEditionCancel)return{stopPropagation:!1};this.disabled||(this._inEdition=!1,this._canceling=!0,this.setPropertyFromUIInteraction("hsvValue",this.initialHsvValue),this._canceling=!1,this.fire("cancelEdit"))}}),n)}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:void 0,type:"string",advancedSetter:!0},hsvValue:{defaultValue:void 0,type:"array"},handleEditionCancel:{defaultValue:!0,type:"boolean",category:"Behavior"},coordinatesInBitmap:{defaultValue:void 0,type:"object"},subColorAttributeX:{defaultValue:"Hue",type:"string"},subColorAttributeY:{defaultValue:"Lightness",type:"string"},modulationValue:{defaultValue:100,type:"integer"},noContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){var e=this,t="wux-controls-colorcanvas";e.elements.container.addClassName(t),e.elements.internalContainer=n.createElement("div").inject(e.elements.container),e.elements._canvas=n.createElement("canvas",{tabIndex:-1,class:t+"-canvas"}).inject(e.elements.internalContainer),this.buildCanvas(),e.elements._pickerCursor=n.createElement("div",{class:t+"-canvas-picker-cursor"}),e.elements._pickerCursor2=n.createElement("div",{class:t+"-canvas-picker-cursor2"}).inject(e.elements._pickerCursor),e.elements._pickerCursor.inject(e.elements.internalContainer),o.onNodeRendered(e.getContent(),function(){e._updatePickerCursorPositionAndColor()})},t.prototype._handleEvents=function(){var e=this,t=document;e.getContent()&&e.getContent().ownerDocument&&(t=e.getContent().ownerDocument);var i=function(t){if(!this.disabled&&e._inEdition){var i={x:t.clientX,y:t.clientY},n=e.elements._canvas.getBoundingClientRect();e.setPropertyFromUIInteraction("coordinatesInBitmap",e._getCanvasValuesFromCoordinates(i,n))}},n=function(l){e._inEdition=!1,e.beginEdit&&(e.fire("endEdit"),e.beginEdit=!1),o.removeEventOnElement(e,t,s.POINTERMOVE,i),o.removeEventOnElement(e,t,s.POINTERMOVE,n)};o.addEventOnElement(this,e.elements.internalContainer,s.POINTERDOWN,function(l){if(!e.disabled){e._inEdition=!0,e.initialHsvValue=e.hsvValue,e.beginEdit||(e.fire("beginEdit"),e.beginEdit=!0);var a={x:l.clientX,y:l.clientY},r=e.elements._canvas.getBoundingClientRect();e.setPropertyFromUIInteraction("coordinatesInBitmap",e._getCanvasValuesFromCoordinates(a,r)),o.addEventOnElement(e,t,s.POINTERMOVE,i),o.addEventOnElement(e,t,s.POINTERUP,n)}}),o.addEventOnElement(this,e.elements.internalContainer,s.POINTERUP,n),o.addEventOnElement(this,e.elements.internalContainer,s.POINTERMOVE,i)},t.prototype._refreshModulationValue=function(){var e=this._computeModulationType();if(void 0!==this.hsvValue){var t=this.hsvValue,i=r.hsvToHsl(this.hsvValue),n=r.hsvToRgb(this.hsvValue),s=this.modulationValue;switch(e){case"Hue":s!==t[0]&&(s=t[0]);break;case"HslSaturation":s=i[1];break;case"Saturation":s=t[1];break;case"Value":s=t[2];break;case"Lightness":s=i[2];break;case"Red":s=n.r;break;case"Green":s=n.g;break;case"Blue":s=n.b}var o=this._computeHsvValueFromCoordinatesAndModulation();o[0]===t[0]&&o[1]===t[1]&&o[2]===t[2]||(this.modulationValue=s)}else this.modulationValue="Hue"===e?0:"Red"===e||"Green"===e||"Blue"===e?255:100},t.prototype._computeCoordinatesInBitmapFromValue=function(){if(void 0!==this.hsvValue){this._computingCoordinatesInBitmapFromValue=!0;var e=this.hsvValue,t=r.hsvToHsl(this.hsvValue),i=r.hsvToRgb(this.hsvValue),n={x:0,y:0};"Hue"===this.subColorAttributeX?n.x=e[0]:"Saturation"===this.subColorAttributeX?n.x=e[1]:"HslSaturation"===this.subColorAttributeX?n.x=t[1]:"Value"===this.subColorAttributeX?n.x=e[2]:"Lightness"===this.subColorAttributeX?n.x=t[2]:"Red"===this.subColorAttributeX?n.x=i.r:"Green"===this.subColorAttributeX?n.x=i.g:"Blue"===this.subColorAttributeX&&(n.x=i.b),"Hue"===this.subColorAttributeY?n.y=e[0]:"Saturation"===this.subColorAttributeY?n.y=e[1]:"HslSaturation"===this.subColorAttributeY?n.y=t[1]:"Value"===this.subColorAttributeY?n.y=e[2]:"Lightness"===this.subColorAttributeY?n.y=t[2]:"Red"===this.subColorAttributeY?n.y=i.r:"Green"===this.subColorAttributeY?n.y=i.g:"Blue"===this.subColorAttributeY&&(n.y=i.b),this.coordinatesInBitmap=n,this._computingCoordinatesInBitmapFromValue=!1}},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),(this.isDirty("subColorAttributeX")||this.isDirty("subColorAttributeY"))&&(this.buildCanvas(),this._computeCoordinatesInBitmapFromValue(),this._updatePickerCursorPositionAndColor(),this._refreshModulationValue()),this.isDirty("value")&&this._applyValue()},t.prototype._applyHsvValue=function(){this._applyingHsvValue=!0,this._applyingValue||(this.value=r.hsvToHex(this.hsvValue)),this._applyingCoordinatesInBitmap||this._applyingModulationValue||(this._computeCoordinatesInBitmapFromValue(),this._canceling||this._refreshModulationValue()),void 0!==this.hsvValue&&null!==this.hsvValue?this.elements._pickerCursor.show():this.elements._pickerCursor.hide(),this._applyingHsvValue=!1},t.prototype._applyValue=function(){(this._applyingValue=!0,this._applyingHsvValue)||r.hsvToHex(this.hsvValue)!==this.value&&(this.hsvValue=r.hexToHsv(this.value));this.fire("change"),this._applyingValue=!1},t.prototype._computeModulationType=function(){return"Red"===this.subColorAttributeX?"Green"===this.subColorAttributeY?"Blue":"Green":"Green"===this.subColorAttributeX?"Red"===this.subColorAttributeY?"Blue":"Red":"Blue"===this.subColorAttributeX?"Red"===this.subColorAttributeY?"Green":"Red":"Hue"!==this.subColorAttributeX&&"Hue"!==this.subColorAttributeY?"Hue":"Saturation"===this.subColorAttributeX||"Saturation"===this.subColorAttributeY?"Value":"HslSaturation"===this.subColorAttributeX||"HslSaturation"===this.subColorAttributeY?"Lightness":"Value"===this.subColorAttributeX||"Value"===this.subColorAttributeY?"Saturation":"Lightness"===this.subColorAttributeX||"Lightness"===this.subColorAttributeY?"HslSaturation":void 0},t.prototype._setModulationValue=function(e){var t=this.hsvValue;void 0===t&&(t=[0,100,100]);var i=t,n=r.hsvToHsl(t),s=r.hsvToRgb(t);this._applyingModulationValue=!0;var o=this._computeModulationType();this.modulationValue=e,"Hue"===o?(i[0]=e,this.hsvValue=i):"Saturation"===o?(i[1]=e,this.hsvValue=i):"HslSaturation"===o?(n[1]=e,this.hsvValue=r.hslToHsv(n)):"Value"===o?(i[2]=e,this.hsvValue=i):"Lightness"===o?(n[2]=e,this.hsvValue=r.hslToHsv(n)):"Red"===o?(s.r=e,this.hsvValue=r.rgbToHsv(s.r,s.g,s.b)):"Green"===o?(s.g=e,this.hsvValue=r.rgbToHsv(s.r,s.g,s.b)):"Blue"===o&&(s.b=e,this.hsvValue=r.rgbToHsv(s.r,s.g,s.b)),this.buildCanvas(),this._updatePickerCursorPositionAndColor(),this._applyingModulationValue=!1},t.prototype._computeHsvValueFromCoordinatesAndModulation=function(){var e=[0,0,0],t=[void 0,void 0,void 0],i={r:0,g:0,b:0};"Hue"===this.subColorAttributeX?(e[0]=this.coordinatesInBitmap.x,t[0]=this.coordinatesInBitmap.x):"Saturation"===this.subColorAttributeX?e[1]=this.coordinatesInBitmap.x:"HslSaturation"===this.subColorAttributeX?t[1]=this.coordinatesInBitmap.x:"Value"===this.subColorAttributeX?e[2]=this.coordinatesInBitmap.x:"Lightness"===this.subColorAttributeX?t[2]=this.coordinatesInBitmap.x:"Red"===this.subColorAttributeX?i.r=this.coordinatesInBitmap.x:"Green"===this.subColorAttributeX?i.g=this.coordinatesInBitmap.x:"Blue"===this.subColorAttributeX&&(i.b=this.coordinatesInBitmap.x),"Hue"===this.subColorAttributeY?(e[0]=this.coordinatesInBitmap.y,t[0]=this.coordinatesInBitmap.y):"Saturation"===this.subColorAttributeY?e[1]=this.coordinatesInBitmap.y:"HslSaturation"===this.subColorAttributeX?t[1]=this.coordinatesInBitmap.y:"Value"===this.subColorAttributeY?e[2]=this.coordinatesInBitmap.y:"Lightness"===this.subColorAttributeY?t[2]=this.coordinatesInBitmap.y:"Red"===this.subColorAttributeY?i.r=this.coordinatesInBitmap.y:"Green"===this.subColorAttributeY?i.g=this.coordinatesInBitmap.y:"Blue"===this.subColorAttributeY&&(i.b=this.coordinatesInBitmap.y);var n,s=this.modulationValue,o=this._computeModulationType();return"Hue"===o?(e[0]=s,t[0]=s):"Saturation"===o?e[1]=s:"HslSaturation"===o?t[1]=s:"Value"===o?e[2]=s:"Lightness"===o?t[2]=s:"Red"===o?i.r=s:"Green"===o?i.g=s:"Blue"===o&&(i.b=s),n="Red"===o||"Green"===o||"Blue"===o?r.rgbToHsv(i.r,i.g,i.b):void 0!==t[2]&&void 0!==t[1]&&void 0!==t[0]?r.hslToHsv(t):e,void 0!==this.hsvValue&&void 0!==this.hsvValue[3]&&(n[3]=this.hsvValue[3]),n},t.prototype._applyCoordinatesInBitmap=function(){this._computingCoordinatesInBitmapFromValue?this._updatePickerCursorPositionAndColor():this._applyingCoordinatesInBitmap||(this._applyingCoordinatesInBitmap=!0,this.hsvValue=this._computeHsvValueFromCoordinatesAndModulation(),this._updatePickerCursorPositionAndColor(),this._applyingCoordinatesInBitmap=!1)},t.prototype._applyModulationValue=function(){this.buildCanvas()},t.prototype._applyTouchMode=function(){!0===this._getCurrentTouchMode()?this.elements._canvas.setAttributeNode(document.createAttribute("touch-mode")):this.elements._canvas.removeAttribute("touch-mode")},t.prototype._getCanvasValuesFromCoordinates=function(e,t){var i=100;"Red"===this.subColorAttributeX||"Green"===this.subColorAttributeX||"Blue"===this.subColorAttributeX?i=255:"Hue"===this.subColorAttributeX&&(i=360);var n=100;"Red"===this.subColorAttributeY||"Green"===this.subColorAttributeY||"Blue"===this.subColorAttributeY?n=255:"Hue"===this.subColorAttributeY&&(n=360);var s=l.clamp(0,t.width,e.x-t.left),o=l.clamp(0,t.height,t.height-(e.y-t.top));return{x:s/t.width*i,y:o/t.height*n}},t.prototype.setColorSubAttribute=function(e,t){if(this.subColorAttributeX===e)this.coordinatesInBitmap={x:t,y:this.coordinatesInBitmap.y};else if(this.subColorAttributeY===e)this.coordinatesInBitmap={x:this.coordinatesInBitmap.x,y:t};else{this._computeModulationType()===e&&this._setModulationValue(t)}},t.prototype.getColorSubAttribute=function(e){return this.subColorAttributeX===e?this.coordinatesInBitmap.x:this.subColorAttributeY===e?this.coordinatesInBitmap.y:this._computeModulationType()===e?this.modulationValue:void 0},t.prototype.buildCanvas=function(){var e,t,i,n=this.elements._canvas.getContext("2d");switch(this.subColorAttributeX){case"Hue":this.elements._canvas.width=361,e=0;break;case"Saturation":case"HslSaturation":this.elements._canvas.width=101,e=1;break;case"Value":case"Lightness":this.elements._canvas.width=101,e=2;break;case"Red":this.elements._canvas.width=256,e=0;break;case"Green":this.elements._canvas.width=256,e=1;break;case"Blue":this.elements._canvas.width=256,e=2;break;default:this.elements._canvas.width=101}switch(this.subColorAttributeY){case"Hue":this.elements._canvas.height=361,t=0;break;case"Saturation":case"HslSaturation":this.elements._canvas.height=101,t=1;break;case"Value":case"Lightness":this.elements._canvas.height=101,t=2;break;case"Red":this.elements._canvas.height=256,t=0;break;case"Green":this.elements._canvas.height=256,t=1;break;case"Blue":this.elements._canvas.height=256,t=2;break;default:this.elements._canvas.height=101}var s,o=this.elements._canvas.width,l=this.elements._canvas.height,a=l-1,h=this.modulationValue;if(s="Red"===this.subColorAttributeX||"Green"===this.subColorAttributeX||"Blue"===this.subColorAttributeX?void 0:"Lightness"===this.subColorAttributeX||"Lightness"===this.subColorAttributeY?r.hslToRgb:r.hsvToRgb,n.clearRect(0,0,o,l),void 0!==e&&void 0!==t){if(e+t===1)i=2;else if(e+t===2)i=1;else{if(e+t!==3)return;i=0}for(var u=n.createImageData(o,l),c=0,d=0;d<l;d++)for(var p=0;p<o;p++){var m=[0,0,0];m[e]=p,m[t]=a-d,m[i]=h;var g=void 0;g=s?s(m):{r:m[0],g:m[1],b:m[2]},u.data[c]=g.r,u.data[c+1]=g.g,u.data[c+2]=g.b,u.data[c+3]=255,c+=4}n.putImageData(u,0,0)}},t.prototype._updatePickerCursorPositionAndColor=function(){if(void 0!==this.coordinatesInBitmap&&void 0!==this.hsvValue){var e=100;"Red"===this.subColorAttributeX||"Green"===this.subColorAttributeX||"Blue"===this.subColorAttributeX?e=255:"Hue"===this.subColorAttributeX&&(e=360);var t=100;"Red"===this.subColorAttributeY||"Green"===this.subColorAttributeY||"Blue"===this.subColorAttributeY?t=255:"Hue"===this.subColorAttributeY&&(t=360);var i=this.elements._canvas.getBoundingClientRect(),n=this.coordinatesInBitmap.x/e*i.width,s=i.height-this.coordinatesInBitmap.y/t*i.height;this.elements._pickerCursor.setStyle("left",n+"px"),this.elements._pickerCursor.setStyle("top",s+"px"),this.elements._pickerCursor.setStyle("background",r.colorToCssColor(r.hsvToRgb(this.hsvValue)))}},t}(i);return a.addClass(u,"colorCanvas"),u}),define("DS/Controls/ComboBoxBase",["UWA/Core","DS/Core/PointerEvents","DS/Utilities/KeyboardUtils","DS/Controls/Abstract","DS/Controls/Popup","DS/Tree/TreeListView","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/Tree/TreeNodeView","DS/Tree/Manager","DS/Utilities/Dom","DS/Utilities/Array","DS/Utilities/Utils"],function(e,t,i,n,s,o,l,a,r,h,u,c,d){"use strict";var p=h.extend({syncModel:function(e,t){g.call(this.getDocument()),this._parent(e,t)}}),m=r.extend({updateInternalParameters:function(){this._parent();var e=this.getCellInfos();if(!e.isHeader){e.nodeModel._wuxComboBoxPreselected?this.getContent().addClassName("wux-controls-combobox-row-preselected"):this.getContent().removeClassName("wux-controls-combobox-row-preselected");var t=e.nodeModel.options.comboBoxSemantics||"leaf",i=document.createAttribute("semantics");i.value=t,this.getContent().setAttributeNode(i)}}});function g(){var e=0;this._getTrueRoot().processDescendants({onlyVisibleNodes:!1,processNode:function(t){t.nodeModel._unfilteredRowID=e,e++}})}function v(e,t){if(void 0===e)return t.value=-1,1;if(-1===e&&this.reachablePlaceholderFlag)return 0;if(e<-1&&this.reachablePlaceholderFlag)return t.value=-1,1;var i,n=this._getAllDescendants();return 0===n.length?-1!==e?(t.value=-1,1):0:e<=-.5&&!this.reachablePlaceholderFlag?(t.value=0,1):e>=n.length?(t.value=n.length-1,1):(t.value=Math.round(e))!==e?1:this.isIndexValid(e)?0:0===this._direction?2:1===this._direction?-1===(i=y.call(this,e))?2:(t.value=i,1):(i=b.call(this,e))===this._getAllDescendants().length?2:(t.value=i,1)}function f(e){var t=e;do{if(-1===(t=y.call(this,t)))return t}while(!this.isIndexValid(t));return t}function y(e){var t=-1;if(void 0!==e)return e<this._getAllDescendants().length-1&&(t=e+1),t;if(this._isPopupOpened()){var i=this._model.getXSO().get();if(i.length>0){var n=i[i.length-1]._unfilteredRowID;n<this._getAllDescendants().length-1&&(t=n+1)}else t=0}else this.multiSelFlag?this.selectedIndexes[this.selectedIndexes.length-1]<this._getAllDescendants().length-1&&(t=this.selectedIndexes[this.selectedIndexes.length-1]+1):this.selectedIndex<this._getAllDescendants().length-1&&(t=this.selectedIndex+1);return t}function b(e){var t=this._getAllDescendants().length;if(void 0!==e)return e>(this.reachablePlaceholderFlag&&!this._isPopupOpened()?-1:0)&&(t=e-1),t;if(this._isPopupOpened()){var i=this._model.getXSO().get()[0];if(i){var n=i._unfilteredRowID;n>0&&(t=n-1)}}else this.selectedIndex>(this.reachablePlaceholderFlag?-1:0)&&(t=this.selectedIndex-1);return t}function _(){var e=!1;const t=this.elements.treeListView.getManager();var i;this._getAllDescendants()&&((this.multiSelFlag&&this.selectedIndexes.length>0||!this.multiSelFlag&&-1!==this.selectedIndex)&&(i=this._getAllDescendants()[this.preselectedIndex]),this.multiSelFlag&&!i&&this._getAllDescendants().length?t.setActiveNode(this._getAllDescendants()[0]):t.setActiveNode(i),i&&this._getAllDescendants().length>this.nbDisplayedElements&&(e=function(e,t){const i=this.elements.treeListView.getManager();if(e&&i.isNodeInVisibleViewport(e))return!1;if(this._treeListViewIsBeingScrolled=!0,e){var n=this.elements.treeListView.getManager().options.defaultCellHeight,s=e._getRowID(1)*n;if(t){var o=Math.max(0,s-n*Math.floor(this.nbDisplayedElements/2));i.setScrollerPosition({x:0,y:o})}else{var l=this.nbDisplayedElements*n,a=this.elements.treeListView.getManager().getScrollerPosition().y;s>a+l-n?i.setScrollerPosition({x:0,y:s-l+n}):s<a&&i.setScrollerPosition({x:0,y:s})}}else i.setScrollerPosition({x:0,y:0});return!0}.call(this,i,!0)));e||(t.prepareUpdateView(),t.pushUpdateView(),this._updatePopupWidth())}return n.inherit({name:"comboBoxBase",publishedProperties:{nbDisplayedElements:{defaultValue:-1,type:"integer",readOnly:!0,category:"Appearance"},selectedIndex:{defaultValue:-1,type:"integer",category:"Appearance",recordFlag:!0},preselectedIndex:{defaultValue:-1,type:"integer",readOnly:!0,category:"Appearance"},selectedIndexes:{defaultValue:[],type:"array",category:"Appearance",recordFlag:!0},value:{defaultValue:void 0,type:"object",category:"Appearance",recordFlag:!0},currentValue:{defaultValue:void 0,type:"object",category:"Appearance",uiDisplay:!1},label:{defaultValue:"",type:"string",readOnly:!0,category:"Appearance"},currentLabel:{defaultValue:"",type:"string",readOnly:!0,category:"Appearance"},elementsList:{defaultValue:[],type:"array",category:"Model"},elementsTree:{defaultValue:void 0,type:"array",category:"Model"},multiSelFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},showToggleColumnForMultiSelFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},reachablePlaceholderFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},_validateOnBlurForTMCAndFilterApp:{defaultValue:!1,type:"boolean",category:"Behavior",readOnly:!0,noNeedToApplyFlag:!0},popupSizeAdjustPolicy:{defaultValue:s.SizeAdjustPolicyEnum.AdjustToVisibleContents,type:"integer",category:"Appearance"},selectionStyle:{defaultValue:"",type:"string"},onContextualEvent:{defaultValue:()=>[],type:"function",noNeedToApplyFlag:!0},noContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"},onPreload:{defaultValue:()=>[],type:"function"}},buildView:function(){this.elements.container.addClassName("wux-controls-combobox"),this._model=null,this._firstLoadModel=!0,this._lastValidatedPreselectedIndex=void 0,this._lastValidatedSelectedIndex=void 0,this._treeListViewReady=!1,this._direction=0,this._preventXSOCB=!1,this._removeIndex=!1,this._lastValidatedSelectedIndexes=[]},handleEvents:function(){(function(){var t=this;u.addEventOnElement(this,this.elements.container,"mousewheel",function(i){if(!t.disabled&&(!t.multiSelFlag||t._isPopupOpened())&&(document.activeElement===t._getMainElement()||t.getContent().hasAttribute("focused"))){i.preventDefault(),i.stopPropagation();var n=e.Event.wheelDelta(i);if(n<0)for(var s=0;s>n;s--)t.callMethodFromUIInteraction("incrementIndex");else for(s=0;s<n;s++)t.callMethodFromUIInteraction("decrementIndex")}})}).call(this)},destroy:function(){this._hidePopup(!0),this._addChildCB&&(this._model.unsubscribe(this._addChildCB),this._addChildCB=void 0),this._removeChildCB&&(this._model.unsubscribe(this._removeChildCB),this._removeChildCB=void 0),this._allDescendants=null,this._parent(),this.elementsList&&this._model.destroy()},isIndexValid:function(e){if(e<-1||e>=this._getAllDescendants().length)return!1;if(-1===e)return this.reachablePlaceholderFlag;var t=this._getAllDescendants()[e];return!!t&&this._model.options.shouldBeSelected(t)},incrementIndex:function(){if(this._direction=1,this._treeListViewReady&&!this._modelHasChanged&&this.elements.treeListView.getManager().getActiveNode())this.elements.treeListView.getManager()._commandRegistry.dispatch("treelistview:go-to-next-visible-node-no-empty-xso",this.elements.treeListView.getManager()),e=this.elements.treeListView.getManager().getActiveNode()._unfilteredRowID,this.multiSelFlag&&(this._properties.preselectedIndex.value=e,this._applyPreselectedIndex());else{var e=f.call(this);e>=0&&(this._isPopupOpened()?this._selectInList(e):this.selectedIndex=e)}this._direction=0},decrementIndex:function(){if(this._direction=2,this._treeListViewReady&&!this._modelHasChanged&&this.elements.treeListView.getManager().getActiveNode()){var e=this.preselectedIndex;this.elements.treeListView.getManager()._commandRegistry.dispatch("treelistview:go-to-previous-visible-node-no-empty-xso",this.elements.treeListView.getManager()),t=this.elements.treeListView.getManager().getActiveNode()._unfilteredRowID,this.multiSelFlag?(this._properties.preselectedIndex.value=t,this._applyPreselectedIndex()):!this._isPopupOpened()&&e===t&&this.reachablePlaceholderFlag&&(this.selectedIndex=-1)}else{var t=function(e){var t=e;do{if((t=b.call(this,t))===this._getAllDescendants().length)return t}while(!this.isIndexValid(t));return t}.call(this);t!==this._getAllDescendants().length&&(this._isPopupOpened()?this._selectInList(t):this.selectedIndex=t)}this._direction=0},getPopupWidth:function(){var e=this.elements.container.offsetWidth;if(this.multiSelFlag){var t=Math.round(this.elements.treeListView._treeWidth);return t>e?t:e}return e},_selectInList:function(e){this._preventXSOCB=!0;var t,i=this.multiSelFlag?e:[e];this.multiSelFlag&&this._removeIndex&&this._treeListViewReady&&(t=this.elements.treeListView.getManager().getActiveNode()),this._model.prepareUpdate(),this._model.getXSO().empty();for(var n=0;n<i.length;n++)i[n]>=0&&i[n]<this._getAllDescendants().length&&this._getAllDescendants()[i[n]].select();this.multiSelFlag&&this._removeIndex||(this._properties.preselectedIndex.value=i[i.length-1],this._applyPreselectedIndex(1),t=this._getAllDescendants()[this.preselectedIndex]),this._treeListViewReady&&this.elements.treeListView.getManager().setActiveNode(t),this._model.pushUpdate(),this._preventXSOCB=!1},_addCommonEvents:function(){var e=this;this.elements.expander&&u.addEventOnElement(this,this.elements.expander,"click",function(t){t.stopPropagation(),e.disabled||(e._isPopupOpened()?e.callMethodFromUIInteraction("_hidePopup",!e.multiSelFlag&&!e._validateOnBlurForTMCAndFilterApp):e.callMethodFromUIInteraction("_showPopup"))}),this._getMainElement&&u.addEventOnElement(this,this._getMainElement(),"keydown",function(t){var n=!1;switch(t.keyCode){case i.ARROWUP:(e.multiSelFlag&&e._isPopupOpened()||!e.multiSelFlag&&!t.shiftKey&&!t.ctrlKey)&&(n=!0,e.callMethodFromUIInteraction("decrementIndex")),t.stopPropagation();break;case i.ARROWDOWN:(e.multiSelFlag&&e._isPopupOpened()||!e.multiSelFlag&&!t.shiftKey&&!t.ctrlKey)&&(n=!0,e.callMethodFromUIInteraction("incrementIndex")),t.stopPropagation();break;case i.ESCAPE:if(e._isPopupOpened()){var s=e.preselectedIndex,o=e._isPopupOpened();e.callMethodFromUIInteraction("_hidePopup",1),s!==e.preselectedIndex&&(t.actionPerformed=!0,e._actionPerformedOnKeyDown=!0),o&&(t.stopPropagation(),e._stopPropagation=!0)}break;case e.multiSelFlag&&i.TAB:e._isPopupOpened()&&e.callMethodFromUIInteraction("_hidePopup",!e.multiSelFlag),t.stopPropagation();break;case t.ctrlKey&&i.SPACE:e.multiSelFlag&&e._isPopupOpened()&&e._treeListViewReady&&this.elements.treeListView.getManager()._commandRegistry.dispatch("treelistview:toggle-selection",this.elements.treeListView.getManager()),t.stopPropagation()}n&&t.preventDefault()})},_updatePopupHeight:function(){if(this.elements.treeListViewContainer){var e=this.nbDisplayedElements,t=(this._getCurrentTouchMode()?38:22)*e+"px";if(this.elements.treeListViewContainer.style.height!==t){var i=this._isPopupOpened();this.elements.popup.visibleFlag=!1,this.elements.treeListViewContainer.style.height=t,this.elements.treeListView&&this.elements.treeListView.updateHeight(t),i&&this._showPopup()}}},_updatePopupWidth:function(){if(this.elements.treeListView&&!this._treeListViewIsBeingScrolled){if(this.popupSizeAdjustPolicy===s.SizeAdjustPolicyEnum.NoAdjust){var e=this.getPopupWidth();this.elements.treeListViewContainer.style.width=e+"px"}if(null!==this.elements.treeListView.getContent().offsetParent&&this._treeListViewReady){if(this.popupSizeAdjustPolicy===s.SizeAdjustPolicyEnum.AdjustToVisibleContents){e=this.elements.treeListView.getManager()._computeMinimalColumnWidth("tree");var t=0,i=0;this.elements.treeListView.getManager().isColumnHidden("selection")||(e+=t=this.elements.treeListView.getManager()._computeMinimalColumnWidth("selection")),this.elements.treeListView.getManager().getScroller().areScrollbarsDisplayed("vertical")&&(e+=i=d.getScrollbarWidth());var n=Math.max(this.getContent().clientWidth,void 0!==this._minPopupWidth?this._minPopupWidth:0);e=Math.max(n,e),this._minPopupWidth=e,parseInt(this.elements.treeListViewContainer.style.width)!==e&&(e=Math.min(e,document.body.offsetWidth),this.elements.treeListViewContainer.style.width=e+"px",this.elements.popup._updateView(),this.elements.treeListView.getManager().prepareUpdateView(),this.elements.treeListView.getManager().setColumnWidth("tree",e-t-i),this.elements.treeListView.getManager().isColumnHidden("selection")||(t=this.elements.treeListView.getManager().sizeColumnToFit("selection")),this.elements.treeListView.getManager().pushUpdateView()),this.elements.popup.getContent().setStyle("visibility","visible")}this.fire("popupVisibilityChange")}}},_managePopupOverlaping:function(e){let t=e.availableSpaces;var i=this._properties.nbDisplayedElements.value;this._updateNbDisplayedElements(t),i!==this._properties.nbDisplayedElements.value&&this._updatePopupHeight()},_updateNbDisplayedElements:function(e){var t=this._model.getNumberOfVisibleDescendants();e?this._reduceNbDisplayedToAvoidOverlaping(e,t<10?t:10):this._properties.nbDisplayedElements.value=t<10?t:10},_reduceNbDisplayedToAvoidOverlaping:function(e,t){var i=this._getCurrentTouchMode()?38:22,n=Math.max(e.bottom,e.top),s=Math.min(Math.max(3,Math.floor(n/i)),t);this._properties.nbDisplayedElements.value=s},_hidePopup:function(e){this._isPopupOpened()&&(e?this.multiSelFlag&&(this.selectedIndexes=this._lastValidatedSelectedIndexes.slice()):this.multiSelFlag?this._lastValidatedSelectedIndexes=this.selectedIndexes.slice():this.selectedIndex=this._model.getXSO().get().length?this._model.getXSO().get()[0]._unfilteredRowID:-1,this.multiSelFlag?(this._properties.preselectedIndex.value=this.selectedIndexes.length?this.selectedIndexes[this.selectedIndexes.length-1]:-1,this._applyPreselectedIndex()):(this._properties.preselectedIndex.value=this.selectedIndex,this._applyPreselectedIndex()),this.elements.popup&&(this.elements.popup.visibleFlag=!1,this._popupHidden&&this._popupHidden(e),e&&(this.multiSelFlag||(this._model.getXSO().empty(),this.selectedIndex>-1&&this._model.getXSO().add(this._getAllDescendants()[this.selectedIndex]))),this._minPopupWidth=0,this.fire("hide",{cancelPopupSelection:e})))},_buildPopup:function(){if(this.elements.popup)this._inOverlapCallback||this._updateNbDisplayedElements(),this._updatePopupHeight();else{var i=this,n={target:this,position:"bottom",offset:{x:0,y:4},forceKeepOrientation:!0,alignment:"near",className:"wux-controls-combobox-popup wux-controls-popup",constraint:"screen",overlap:!1,trigger:"",overlapCallback:function(e){i._inOverlapCallback=!0,i._managePopupOverlaping(e),i._inOverlapCallback=void 0},beforeDisplayCallback:function(){i.popupSizeAdjustPolicy===s.SizeAdjustPolicyEnum.AdjustToVisibleContents&&i.elements.popup.getContent().setStyle("visibility","hidden")}};this.elements.popup=new s(n),this.recId&&(this.elements.popup.recId=this.recId+"-popup"),this._applySelectionStyle(),this.elements.treeListViewContainer=new e.Element("div"),this.elements.popup.setBody(this.elements.treeListViewContainer),this._updatePopupHeight();i=this;var l=this.nbDisplayedElements,a=this._getCurrentTouchMode()?38:22,r=a*l+"px",h={onContextualEvent:this.onContextualEvent,managerClass:p,manageHeight:!0,expanderStyle:"none",columns:[{dataIndex:"selection",type:"selection",isHidden:!0},{text:"tree",dataIndex:"tree",isHidden:!1,isEditable:!1,width:"auto"},{text:"valueItem",dataIndex:"valueItem",isHidden:!0,isEditable:!1,isDraggable:!1,width:0}],defaultCellHeight:a,defaultCellWidth:50,height:r,isEditable:!0,resize:{columns:!0,rows:!1},show:{rowHeaders:!1,columnHeaders:!1},rootMargin:7,selection:{rowHeaders:!1,columnHeaders:!1,unselectAllOnEmptyArea:!1,preSelection:!0,toggle:!1===this.showToggleColumnForMultiSelFlag,canMultiSelect:this.multiSelFlag,enableListSelection:this.multiSelFlag},treeDocument:this._model,performances:{useRequestAnimationFrameRendering:!0},shouldAcceptDrag:function(){return!1},shouldDisplayTooltip:function(e){return{allowUnsafeHTMLShortHelp:!1,shortHelp:void 0===e.nodeModel.options.description?e.nodeModel.getLabel():e.nodeModel.options.description}},apiVersion:2,cellClass:m,enableActiveUI:!0,enableKeyboardNavigation:!0,allowUnsafeHTMLContent:!1};this.elements.treeListView=new o(h),this.elements.treeListView.getManager().__isComboBox__=!0,this.elements.treeListView.getContent().addClassName("wux-controls-combobox-treelistview"),this._model.options._hasAtLeastOneIcon&&(this._model.options._hasAtLeastOneLabel?this.elements.treeListView.getContent().addClassName("wux-controls-combobox-treelistview-iconandtext"):this.elements.treeListView.getContent().addClassName("wux-controls-combobox-treelistview-icononly")),this._applyMultiSelFlag();i=this;var c={x:-1,y:-1},d=!0;u.addEventOnElement(this,this.elements.popup.getContent(),"mousemove",function(e){var t=e.clientX,n=e.clientY;if(t!==c.x||n!==c.y||!d){var s=u.firstParentWithClass(e.target,"wux-datagrid-cell");if(s&&s.dsView&&s.dsView._cellInfos&&s.dsView._cellInfos.cellModel&&s.dsView._cellInfos.cellModel.options){var o=s.dsView._cellInfos.nodeModel._unfilteredRowID;i.setReadOnlyPropertyFromUIInteraction("preselectedIndex",{value:parseInt(o)})}c.x=t,c.y=n,d=!0}},!0),this.elements.popup.getContent().addEvent("mousewheel",function(){d=!1}),this.elements.treeListView.onNodeClick(function(e){i._getMainElement&&!t.isLastEventTouch()&&i._getMainElement().focus(),i.isIndexValid(e.nodeModel._unfilteredRowID)&&(i.multiSelFlag||i._hidePopup()),i.fire("click")}),this.elements.treeListView.getManager().onReady(function(){i._treeListViewReady=!0,_.call(i),i.elements.treeListView.getContent().addClassName("wux-controls-combobox-treelistview-colors"),i.elements.treeListView.getManager().getScroller().onScrollEnd(function(){i._treeListViewIsBeingScrolled=!1,i._updatePopupWidth()})}),this.multiSelFlag&&u.addEventOnElement(this,window,"blur",function(e){i._isPopupOpened()&&i._hidePopup(!i.multiSelFlag)});var g=document;i.getContent()&&i.getContent().ownerDocument&&(g=i.getContent().ownerDocument);var v=function(e){if(i._isPopupOpened()&&!u.firstParentWithClass(e.target,"wux-controls-combobox-popup")){var t=u.firstParentWithClass(e.target,"wux-controls-combobox");!!t&&t.dsModel===i||(u.pushUserInteractionContext(),i.callMethodFromUIInteraction("_hidePopup",!i._validateOnBlurForTMCAndFilterApp&&!i.multiSelFlag),u.popUserInteractionContext())}};u.addEventOnElement(this,g.body,"mousedown",v,!0),u.addEventOnElement(this,g.body,"touchstart",v,!0)}},_getAllDescendants:function(){return this._allDescendants||(this._allDescendants=this._model.getAllDescendants()),this._allDescendants},_showPopup:function(){this._isPopupOpened()||(this.fire("preDropdown"),this._buildPopup(),this._updatePopupWidth(),this._treeListViewReady&&this.elements.treeListView.getManager().onPostUpdateViewOnce(()=>{_.call(this)}),this.elements.popup.visibleFlag=!0,this._modelHasChanged&&(this.elements.treeListView.getManager().actualizeScrollerPosition(),this.elements.treeListView.inject(this.elements.treeListViewContainer),this.elements.treeListView.getManager().loadDocument(this._model),this._modelHasChanged=!1),this._getMainElement&&this._getMainElement().focus(),this.multiSelFlag&&(this._lastValidatedSelectedIndexes=this.selectedIndexes.slice()),this._popupDisplayed&&this._popupDisplayed(),this.fire("show"))},_isPopupOpened:function(){return this.elements.popup&&this.elements.popup.visibleFlag},_updateCurrentProperties:function(){if(!this.multiSelFlag&&-1===this.selectedIndex||this.multiSelFlag&&0===this.selectedIndexes.length)this._properties.value.value=this.multiSelFlag?[]:void 0,this._properties.currentValue.value=this.multiSelFlag?[]:void 0,this._properties.label.value="",this._properties.currentLabel.value="";else{for(var e=[],t="",i=this.multiSelFlag?this.selectedIndexes:[this.selectedIndex],n=0;n<i.length;n++){var s=this._getAllDescendants()[i[n]];s&&(void 0!==s.options.grid.valueItem?c.pushUnique(e,s.options.grid.valueItem):c.pushUnique(e,s.options.label),t+=s.options.label,n!==i.length-1&&i.length>1&&(t+=", "))}this._properties.value.value=this.multiSelFlag?e:e[0],this._properties.currentValue.value=this.multiSelFlag?e:e[0],this._properties.label.value=t,this._properties.currentLabel.value=t}},_applyPreselectedIndex:function(e){var t=this._lastValidatedPreselectedIndex!==this.preselectedIndex;if(t||e){var i={value:0},n=v.call(this,this.preselectedIndex,i);if(1===n)return this._properties.preselectedIndex.value=i.value,void this._applyPreselectedIndex();if(2!==n){var s=this._getAllDescendants();void 0!==this._lastValidatedPreselectedIndex&&this._lastValidatedPreselectedIndex>=0&&this._lastValidatedPreselectedIndex<s.length&&(s[this._lastValidatedPreselectedIndex]._wuxComboBoxPreselected=!1,this._treeListViewReady&&this.elements.treeListView.getManager().removeRowClass(s[this._lastValidatedPreselectedIndex]._getRowID(),"wux-controls-combobox-row-preselected")),this._lastValidatedPreselectedIndex=this.preselectedIndex,-1!==this.preselectedIndex&&(s[this.preselectedIndex]._wuxComboBoxPreselected=!0,this._treeListViewReady&&this.elements.treeListView.getManager().addRowClass(s[this.preselectedIndex]._getRowID(),"wux-controls-combobox-row-preselected")),this._preselectedIndexModified&&this._preselectedIndexModified(),this.elements.popup&&this.elements.popup.visibleFlag&&t&&this.fire("preselectionChange")}else this._properties.preselectedIndex.value=this._lastValidatedPreselectedIndex?this._lastValidatedPreselectedIndex:-1}},_applySelectedIndex:function(e){if(this.multiSelFlag)this.selectedIndexes=[this.selectedIndex];else{var t=!0,i={value:0},n=v.call(this,this.selectedIndex,i);if(1===n)return i.value===e?void(this._properties.selectedIndex.value=e):void(this.selectedIndex=i.value);2===n&&(this._properties.selectedIndex.value=this._lastValidatedSelectedIndex?this._lastValidatedSelectedIndex:this.reachablePlaceholderFlag?-1:0,t=!1),t=this._modelChanged?t&&(this._lastValidatedSelectedIndex!==this.selectedIndex||this._lastValidatedSelectedIndex===this.selectedIndex&&-1!==this.selectedIndex):t&&(this._lastValidatedSelectedIndex!==this.selectedIndex||this._lastValidatedSelectedIndex===this.selectedIndex&&-1===this.selectedIndex),this._lastValidatedSelectedIndex=this.selectedIndex,this._selectInList(this.selectedIndex),this._selectedIndexModified&&this._selectedIndexModified(),this._updateCurrentProperties(),t&&this.fire("change")}},_applySelectedIndexes:function(t,i){if(this.multiSelFlag){for(var n=!0,s=[],o=0;o<this.selectedIndexes.length;o++){var l=this.selectedIndexes[o];this.isIndexValid(l)&&c.pushUnique(s,l)}s.length>0?this._properties.selectedIndexes.value=s:0===s.length&&this.selectedIndexes.length>0&&(this._properties.selectedIndexes.value=t||[],n=!1),this._modelChanged||(n=n&&(!t||!e.equals(t,this.selectedIndexes))),this._selectedIndexModified&&this._selectedIndexModified(),this._selectInList(this.selectedIndexes),this._updateCurrentProperties(),n&&this.fire("change"),this.elements.popup&&this.elements.popup.visibleFlag&&this._updatePopupWidth()}},_applyValue:function(t){var i=0,n=[],s=void 0;s=this.multiSelFlag?void 0!==this.value?this.value:[]:void 0!==this.value?[this.value]:[];var o=this._getAllDescendants(),l=s.length;if(s&&l>0)for(var a=0;a<s.length;){var r=!1;for(i=0;i<o.length;i++){var h=o[i];if(void 0!==h.options.grid.valueItem){if(e.equals(h.options.grid.valueItem,s[a])){c.pushUnique(n,i),r=!0;break}}else if(h.options.label===s[a]){c.pushUnique(n,i),r=!0;break}}r?a++:s.splice(a,1)}this.multiSelFlag?n.length>0?this.selectedIndexes=n:l>0?this._properties.value.value=t:(this._properties.value.value=[],this.selectedIndexes=[]):i===o.length?this._properties.value.value=t:this.selectedIndex=n.length>0?n[0]:-1,this._properties.currentValue.value=this.value},_applyCurrentValue:function(e){this.value=this.currentValue},_applyElementsList:function(){this._modelChanged=!0,this._forceApplyProperties(["selectedIndex","selectedIndexes"]),this._modelChanged=!1},_applyElementsTree:function(){this._modelChanged=!0,this._forceApplyProperties(["selectedIndex","selectedIndexes"]),this._modelChanged=!1},_applyDisabled:function(){this._parent(),this.disabled?(this.elements.mainElement.disabled=!0,this.elements.expander.setAttributeNode(document.createAttribute("disabled"))):(this.elements.mainElement.disabled=!1,this.elements.expander.removeAttribute("disabled"))},_applyShowToggleColumnForMultiSelFlag:function(){var e=this.elements.treeListView;e&&(this.multiSelFlag&&this.showToggleColumnForMultiSelFlag?e.getManager().showColumn(0):e.getManager().hideColumn(0))},_applyMultiSelFlag:function(e){var t=this.elements.treeListView;t&&(t.getManager().options.selection.canMultiSelect=this.multiSelFlag,this.multiSelFlag&&this.showToggleColumnForMultiSelFlag?(t.getManager().showColumn(0),"lightSelectionEdging"===this.selectionStyle&&t.getManager().forceMultiSelection(!1)):(t.getManager().hideColumn(0),"lightSelectionEdging"===this.selectionStyle&&t.getManager().forceMultiSelection(!0)),t.getManager().options.selection.enableListSelection=this.multiSelFlag),this.multiSelFlag?(0===this.selectedIndexes.length&&(this.selectedIndexes=-1===this.selectedIndex?[]:[this.selectedIndex]),this.selectedIndex=-1,this.getContent().setAttributeNode(document.createAttribute("multiple"))):(this.selectedIndexes.length>0&&(this.selectedIndex=this.selectedIndexes.length?this.selectedIndexes[this.selectedIndexes.length-1]:-1,this._properties.selectedIndexes.value=[]),this.getContent().removeAttribute("multiple"))},_applyReachablePlaceholderFlag:function(){this.enableSearchFlag&&(this.reachablePlaceholderFlag=!0),this.reachablePlaceholderFlag||this.multiSelFlag||-1!==this.selectedIndex||void 0!==this.currentValue||void 0!==this.value||""!==this.currentLabel||""!==this.label||(this.selectedIndex=f.call(this,-1))},_applyTouchMode:function(e){this._parent(e),this._treeListViewReady&&(this._getCurrentTouchMode()?(this.elements.treeListView.options.defaultCellHeight=38,this.elements.treeListView._datagrid.options.defaultCellHeight=38,this.elements.treeListView.getManager().options.defaultCellHeight=38):(this.elements.treeListView.options.defaultCellHeight=22,this.elements.treeListView._datagrid.options.defaultCellHeight=22,this.elements.treeListView.getManager().options.defaultCellHeight=22),this.elements.treeListView.getManager()._indexRowsPosition({async:!1}),this._updatePopupHeight())},_applySelectionStyle:function(e){this.elements.popup&&this.elements.popup.elements.container.setAttribute("selection-style",this.selectionStyle)},_applyProperties:function(e){this._parent(e),(this.isDirty("elementsList")||this.isDirty("elementsTree"))&&function(){if(this._model){this.multiSelFlag&&!this._firstLoadModel&&(this.selectedIndexes=[]);var e=!0;this._addChildCB&&(this._model.unsubscribe(this._addChildCB),this._addChildCB=void 0),this._removeChildCB&&(this._model.unsubscribe(this._removeChildCB),this._removeChildCB=void 0,e=!1),e&&(this.elements.treeListView&&this.elements.treeListView.getManager().getDocument()&&(this.elements.treeListView.getManager().unloadDocument(),this.elements.treeListView.getManager()._treeDocument=null),this._model&&(this._model.destroy(),delete this._model)),this._model=void 0}this._allDescendants=void 0;var t=this;if(this.fire("preLoadModel"),this.elementsList.length){this._model=new l({shouldBeEditable:function(){return t.multiSelFlag}}),this._model.prepareUpdate();for(var i="string"==typeof this.elementsList[0],n=0;n<this.elementsList.length;n++){var s,o;i?s={label:this.elementsList[n]}:void 0!==this.elementsList[n].label?(s={label:this.elementsList[n].label,description:this.elementsList[n].description,grid:{valueItem:this.elementsList[n].value}},o="icon"):(s={label:this.elementsList[n].labelItem,description:this.elementsList[n].description,grid:{valueItem:this.elementsList[n].valueItem}},o="iconItem"),""!==s.label&&(this._model.options._hasAtLeastOneLabel=!0);var r=this.elementsList[n][o];r&&""!==r&&(this._model.options._hasAtLeastOneIcon=!0,"string"==typeof r&&-1===r.indexOf(".")&&(this.elementsList[n][o]={iconName:r}),s.icons=[this.elementsList[n][o]]),this._model.addRoot(new a(s))}this._model.pushUpdate()}else if(this.elementsTree){this._model=this.elementsTree;var h=function(){t._allDescendants=void 0,g.call(t._model),t._updateNbDisplayedElements(),t._updatePopupHeight()};this._addChildCB=this._model.addModelEventListener("addChild",h),this._removeChildCB=this._model.addModelEventListener("removeChild",h);var u=!1,d=!1;this._model.processDescendants({onlyVisibleNodes:!1,processNode:function(e){e&&e.nodeModel&&(""!==e.nodeModel._options.label&&(u=!0),e.nodeModel._options.icons.length>0&&(d=!0))}}),this._model.options._hasAtLeastOneLabel=u,this._model.options._hasAtLeastOneIcon=d}else this._model=new l({shouldBeEditable:function(){return t.multiSelFlag}});if(this._firstLoadModel=!1,this._model){g.call(this._model),this._treeListViewReady&&(this.elements.treeListView.getContent().removeClassName("wux-controls-combobox-treelistview-iconandtext"),this.elements.treeListView.getContent().removeClassName("wux-controls-combobox-treelistview-icononly"),this._model.options._hasAtLeastOneIcon&&(this._model.options._hasAtLeastOneLabel?this.elements.treeListView.getContent().addClassName("wux-controls-combobox-treelistview-iconandtext"):this.elements.treeListView.getContent().addClassName("wux-controls-combobox-treelistview-icononly")),this._isPopupOpened()&&!this.elements.treeListView.getManager().getDocument()&&(this.elements.treeListView.getManager().loadDocument(this._model),this.elements.treeListView.getManager().setScrollerPosition({x:0,y:0}),this._modelHasChanged=!1)),this._model.getXSO().onAdd(function(e){t._preventXSOCB||(t.multiSelFlag?(c.pushUnique(t.selectedIndexes,e._unfilteredRowID),t._applySelectedIndexes()):t._isPopupOpened()?(t._properties.preselectedIndex.value=e._unfilteredRowID,t._applyPreselectedIndex()):t.selectedIndex=e._unfilteredRowID)});var p=!1;this._model.getXSO().onRemove(function(e){t._preventXSOCB||t.multiSelFlag&&(t._model.getXSO().get().length?t.selectedIndexes.splice(t.selectedIndexes.indexOf(e._getRowID(1)),1):c.clear(t.selectedIndexes),p||(t._removeIndex=!0,t._applySelectedIndexes(),t._removeIndex=!1))}),this._model.getXSO().onPreEmpty(function(){p=!0}),this._model.getXSO().onEmpty(function(){p=!1})}this._modelHasChanged=!0,this._updateNbDisplayedElements(),this._updatePopupHeight(),this._modelLoaded&&this._modelLoaded(),this.fire("modelLoaded")}.call(this),this.isDirty("reachablePlaceholderFlag")&&this._applyReachablePlaceholderFlag(e.reachablePlaceholderFlag),this.isDirty("touchMode")&&this._applyTouchMode(e.touchMode),this.isDirty("currentValue")&&e&&e.hasOwnProperty("currentValue")&&this._applyCurrentValue(e.currentValue),this.isDirty("value")&&e&&e.hasOwnProperty("value")&&this._applyValue(e.value),(this.isDirty("selectedIndex")||this.isDirty("elementsList")||this.isDirty("elementsTree"))&&this._applySelectedIndex(e.selectedIndex),(this.isDirty("selectedIndexes")||this.isDirty("elementsList")||this.isDirty("elementsTree"))&&this._applySelectedIndexes(e.selectedIndexes),this.isDirty("multiSelFlag")&&this._applyMultiSelFlag(),this.isDirty("selectionStyle")&&this._applySelectionStyle()},_getElementToFocus:function(){return this._getMainElement()},_giveFocus:function(){this._isFocused()||(this._parent(),this._getMainElement().focus())}})}),define("DS/Controls/ComboBox",["UWA/Core","DS/Utilities/KeyboardUtils","DS/Controls/ComboBoxBase","DS/WebRecordEnabler/Adapter","DS/Utilities/Dom","DS/Controls/LineEditor","DS/TreeModel/TreeNodeModel"],function(e,t,i,n,s,o,l){"use strict";function a(){this.elements.mainElement&&(this.elements.iconPlaceholder&&(this.elements.mainElement.removeChild(this.elements.iconPlaceholder),delete this.elements.iconPlaceholder),this.elements.text&&(this.elements.mainElement.removeChild(this.elements.text),delete this.elements.text),this.elements.container.removeChild(this._getMainElementTag()),delete this.elements.mainElement,this.elements.container.removeChild(this.elements.expander),delete this.elements.expander),!0===this.enableSearchFlag?(function(){this.elements.mainElement=new o({displayStyle:"text"}).inject(this.elements.container),this.elements.mainElement._myInput.addClassName("wux-controls-combobox-mainelement"),this.elements.expander=new e.Element("button",{type:"button",class:"wux-controls-button wux-controls-combobox-expander",tabindex:-1,isTextField:!0,name:"Button"}).inject(this.elements.container),this.elements.expander.setAttribute("style","border-left-width: 0px;")}.call(this),function(){var e=this;this._getMainElementTag().addEventListener("uncommittedChange",function(t){t.stopPropagation(),e.fire("uncommittedChange",t.options)}),this._getMainElementTag().addEventListener("change",function(e){e.stopPropagation()});var i=0,n=function(){var t=!1,n=!1;if(i){clearTimeout(i),i=0;var s=e._getMainElement().value,o=-1;e._model.search({match:function(t){e._model.options.shouldBeSelected(t.nodeModel)&&s.toLowerCase()===t.nodeModel.options.label.toLowerCase()&&(t.nodeModel._getRowID(1),o=t.nodeModel._unfilteredRowID)},shouldStop:function(e){return-1!==o}}),t=o===e.selectedIndex&&-1===o&&e._lastCustomEntry!==s,-1===o&&(e._lastCustomEntry=s),e.selectedIndex!==o&&(e.selectedIndex=o,n=!0)}else t=e.preselectedIndex===e.selectedIndex&&-1===e.selectedIndex&&e._lastCustomEntry!==e._getMainElement().value,-1===e.preselectedIndex&&(e._lastCustomEntry=e._getMainElement().value);return t&&(n=!0,e._applySelectedIndex()),n};this._validateOnBlurForTMCAndFilterApp&&this._getMainElement().addEventListener("blur",function(e){n()});var o,l,a=!1;s.addEventOnElement(this,this._getMainElement(),"keydown",function(i){if(e._getMainElement().value!==o&&(o=e._getMainElement().value),a=!1,i.keyCode>=t.KEY0&&i.keyCode<=t.Z||229===i.keyCode)a=!0;else if(i.keyCode>=t.NUMPAD0&&i.keyCode<=t.SLASH)a=!0;else if(i.keyCode===t.DELETE||i.keyCode===t.BACKSPACE||i.keyCode===t.SPACE)a=!0;else if(i.keyCode>=t.SEMICOLON&&i.keyCode<=222)a=!0;else if(i.keyCode===t.ENTER){var s=e._isPopupOpened(),l=n();i.actionPerformed=l,e._actionPerformedOnKeyDown=l,s&&(i.stopPropagation(),e._stopPropagation=!0),e.callMethodFromUIInteraction("_hidePopup"),e._getMainElement().removeClassName("wux-controls-lineeditor-hideCursor")}}),s.addEventOnElement(this,this._getMainElement(),"keyup",function(n){if(e._actionPerformedOnKeyDown&&(n.actionPerformed=e._actionPerformedOnKeyDown,e._actionPerformedOnKeyDown=void 0),e._stopPropagation&&(n.stopPropagation(),e._stopPropagation=void 0),n.keyCode!==t.TAB&&a){var s=this.value;e.elements.mainElement.value=s,i&&(clearTimeout(i),i=0),i=setTimeout(function(){var o=!1;n.keyCode!==t.DELETE&&n.keyCode!==t.BACKSPACE||!e._emptySearched||""!==s||!l||l!==t.DELETE&&l!==t.BACKSPACE||(o=!0),e._emptySearched=""===s,e.callMethodFromUIInteraction("_showPopup");var a=e.callMethodFromUIInteraction("_showMatchingLabel",s);e.setPropertyFromUIInteraction("_isFiltering",!0);var r=0===e._nbDisplayedItems;e.callMethodFromUIInteraction("_updateNbDisplayedElements"),e.callMethodFromUIInteraction("_updatePopupHeight"),e.generateRegexpString===e.publishedProperties.generateRegexpString.defaultValue?e._currentStartFiltered=e._getMainElement().selectionStart:e._currentStartFiltered=0;var h=-1;r||(o||!e.autocompleteFlag)&&-1===a?o=!1:h=-1!==a?a:e._firstVisibleSelectableIndex,e.callMethodFromUIInteraction("_selectInList",h),clearTimeout(i),i=0},500),l=n.keyCode}})}.call(this)):(function(){this.elements.mainElement=new e.Element("button",{class:"wux-controls-button wux-controls-combobox-mainelement",type:"button",tabindex:0,isTextField:!1,name:"Button"}).inject(this.elements.container),this.elements.iconPlaceholder=new e.Element("div",{class:"wux-comboBox-icon-placeholder"}).inject(this.elements.mainElement),this.elements.text||(this.elements.text=e.createElement("span").inject(this.elements.mainElement)),this.elements.expander=new e.Element("button",{class:"wux-controls-button wux-controls-combobox-expander",type:"button",tabindex:-1,isTextField:!1,name:"Button"}).inject(this.elements.container),this.actionOnClickFlag||this.elements.expander.setAttribute("style","border-left-width: 0px;"),this.elements.mainElement.setAttribute("action",this.actionOnClickFlag)}.call(this),function(){var e=this;s.addEventOnElement(this,this.elements.mainElement,"click",function(t){e.actionOnClickFlag?(t.dsModel=e,e._isPopupOpened()&&e.callMethodFromUIInteraction("_hidePopup",!e.multiSelFlag)):(t.stopPropagation(),e._isPopupOpened()?e.callMethodFromUIInteraction("_hidePopup",!e.multiSelFlag):e.callMethodFromUIInteraction("_showPopup"))}),this._getMainElement().addEventListener("dblclick",function(e){e.stopPropagation()});var i,n=!1;s.addEventOnElement(this,this._getMainElement(),"keydown",function(i){n=!1,i.keyCode>=t.KEY0&&i.keyCode<=t.Z?n=!0:i.keyCode>=t.NUMPAD0&&i.keyCode<=t.NUMPAD9&&(n=!0),e.multiSelFlag&&!e._isPopupOpened()&&(n=!1),t.validate(i.keyCode)&&(e.actionOnClickFlag&&!e._isPopupOpened()&&e.mainElementVisibleFlag||(e._isPopupOpened()?e.multiSelFlag&&i.keyCode===t.SPACE||(e.callMethodFromUIInteraction("_hidePopup"),e.actionOnClickFlag&&e.fire("click"),i.stopPropagation(),e._stopPropagation=!0,i.preventDefault()):(e.callMethodFromUIInteraction("_showPopup"),i.stopPropagation(),e._stopPropagation=!0,i.preventDefault())))});var o="";s.addEventOnElement(this,this._getMainElement(),"keyup",function(l){e._actionPerformedOnKeyDown&&(l.actionPerformed=e._actionPerformedOnKeyDown,e._actionPerformedOnKeyDown=void 0),e._stopPropagation&&(l.stopPropagation(),e._stopPropagation=void 0),l.keyCode===t.SPACE&&l.stopPropagation(),l.keyCode!==t.TAB&&n&&(i&&clearTimeout(i),o+=String.fromCharCode(l.keyCode),i=setTimeout(function(){s.pushUserInteractionContext();var t=-1;e._model.search({match:function(i){e._model.options.shouldBeSelected(i.nodeModel)&&new RegExp(e.generateRegexpString(o),"i").test(i.nodeModel.options.label)&&(t=i.nodeModel._getRowID(1))},shouldStop:function(e){return-1!==t}}),-1!==t&&(e.multiSelFlag?e.selectedIndexes=[t]:e.selectedIndex=t),o="",s.popUserInteractionContext()},500))})}.call(this)),"icon"===this.mainElementContent?this.getContent().setAttributeNode(document.createAttribute("mainElementIcon")):this.getContent().removeAttribute("mainElementIcon"),this._addCommonEvents(),this._applyDisplayStyle()}function r(){this._isFiltering&&(this._model.prepareUpdate(),this._model.processDescendants({treeTraversalOrder:"postOrder",processNode:function(e){var t=e.nodeModel;t.isHidden()&&t.show(),t.isExpanded()||t.expand()}}),this._model.pushUpdate(),this._firstVisibleSelectableIndex=-1,this._nbDisplayedItems=0,this._currentStartFiltered=-1,this._getMainElement().selectionStart=this._getMainElement().selectionEnd,this._isFiltering=!1,this._updateNbDisplayedElements(),this._updatePopupHeight())}function h(){var e=void 0,t="";this.multiSelFlag||(n=this._getAllDescendants()[this.selectedIndex])&&n.options.icons&&n.options.icons.length>0&&n.options.icons[0]&&(e=n.options.icons[0]);if(this.multiSelFlag&&this.selectedIndexes.length>0)for(var i=0;i<this.selectedIndexes.length;i++){(n=this._getAllDescendants()[this.selectedIndexes[i]])&&(t+=n.options.label,i!==this.selectedIndexes.length-1&&(t+=", "))}else if(this.selectedIndex>=0&&this.selectedIndex<this._getAllDescendants().length){var n;(n=this._getAllDescendants()[this.selectedIndex])&&(t=n.options.label)}else this.placeholder&&(t=this.placeholder);return{icon:e,label:t}}var u=i.inherit({name:"comboBox",markForRecordFlag:!0,publishedProperties:{placeholder:{defaultValue:"",type:"string",category:"Appearance"},mainElementVisibleFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},mainElementContent:{defaultValue:"all",type:"string",category:"Appearance"},expanderVisibleFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},enableSearchFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},generateRegexpString:{defaultValue:function(e){return"^"+e},type:"function",category:"Behavior",uiDisplay:!1},useMatchingSearchFunction:{defaultValue:!1,type:"boolean",category:"Behavior",uiDisplay:!1},isNodeMatchingSearch:{defaultValue:function(e,t){return this.displayChildrenSearchMethod(e,t)},type:"function",category:"Behavior",uiDisplay:!1},autocompleteFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},actionOnClickFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},expanderIcon:{defaultValue:"expand-down",type:"object",category:"Appearance"},displayStyle:{defaultValue:"normal",type:"string",category:"Appearance"},getMainElementCustomization:{defaultValue:void 0,type:"function",category:"Behavior"}},buildView:function(){this._parent(),this._regex="",this._firstVisibleSelectableIndex=-1,this._nbDisplayedItems=0,this._currentStartFiltered=-1,this._lastCustomEntry="",this._isFiltering=!1,this._emptySearched=!1,this._isIconModeAutomaticalySet=!1,this._isSelectAll=!1,this._isAllSelected=!1,this._selectAllLabel="",this._selectAllIcon={}},_showMatchingLabel:function(e){this._model.prepareUpdate();var t=-1;this._regex=e;var i=void 0;this.useMatchingSearchFunction?this._getAllDescendants().forEach(function(e){e.options.alreadyTreated=void 0}):i=new RegExp(this.generateRegexpString(this._regex),"i");var n=this;return this._model.search({match:function(s){(n.useMatchingSearchFunction?n.isNodeMatchingSearch.call(n,e,s):i.test(s.nodeModel.options.label))?(s.nodeModel.isHidden()&&s.nodeModel.show(),e===s.nodeModel.getLabel()&&(t=s.nodeModel._unfilteredRowID)):s.nodeModel.isHidden()||s.nodeModel.hide()}}),this._firstVisibleSelectableIndex=-1,this._nbDisplayedItems=0,this._getAllDescendants().forEach(function(e){e.isHidden()||(e.getParents().forEach(function(e){e.isHidden()&&(e.show(),n._nbDisplayedItems++),e.isExpanded()||e.expand()}),-1===n._firstVisibleSelectableIndex&&n._model.options.shouldBeSelected(e)&&(n._firstVisibleSelectableIndex=e._unfilteredRowID),n._nbDisplayedItems++)}),this._model.pushUpdate(),t},getPopupWidth:function(){return this.mainElementVisibleFlag?this._parent():this.elements.treeListView._treeWidth},isAllSelected:function(){return this._isAllSelected},displayBrothersSearchMethod:function(e,t){var i=t.nodeModel;if(void 0!==i.options.alreadyTreated)return i.options.alreadyTreated;if(i.getLabel().toLowerCase().includes(e.toLowerCase())){var n=i.getParent().getChildren();return n&&n.forEach(function(e){e.isHidden()?e.show():e.options.alreadyTreated=!0}),!0}return!1},displayChildrenSearchMethod:function(e,t){var i=t.nodeModel;if(void 0!==i.options.alreadyTreated)return i.options.alreadyTreated;if(i.getLabel().toLowerCase().includes(e.toLowerCase())){var n=function(e){var t=e.getChildren();t&&t.forEach(function(e){e.options.alreadyTreated=!0,n(e)})};return n(i),!0}return!1},_preselectedIndexModified:function(){},_selectedIndexModified:function(){if(this.mainElementVisibleFlag)if(this.enableSearchFlag)this._emptySearched=!1,-1===this.selectedIndex?this.elements.mainElement.value=this._lastCustomEntry:(this._lastCustomEntry="",this.elements.mainElement.value=this._getAllDescendants()[this.selectedIndex].options.label),this.fire("dimensionsChanged");else{!this.multiSelFlag&&-1===this.selectedIndex||this.multiSelFlag&&0===this.selectedIndexes.length?(this.elements.mainElement.value=this._lastCustomEntry,this.elements.mainElement.addClassName("wux-combobox-placeholderstyle")):this.elements.mainElement.removeClassName("wux-combobox-placeholderstyle");var e=void 0;if(void 0!==this.getMainElementCustomization){(e=this.getMainElementCustomization())||(e={});var t=e.hasOwnProperty("label"),i=e.hasOwnProperty("icon");if(!t||!i){var n=h.call(this);t||(e.label=n.label),i||(e.icon=n.icon)}}else e=h.call(this);(function(e){if(this.elements.text.textContent=e.label,this._properties.label.value=e.label,this.elements.iconPlaceholder){void 0!==this._generatedIcon&&(this.elements.iconPlaceholder.contains(this._generatedIcon)&&this.elements.iconPlaceholder.removeChild(this._generatedIcon),this.elements.text.style.display="icon"===this.mainElementContent?"none":"",this.elements.mainElement.style.textAlign="initial",this.elements.iconPlaceholder.style.marginRight="0px",this.elements.iconPlaceholder.style.paddingLeft="0px",delete this._generatedIcon);var t=!1;e&&e.icon&&(this._generatedIcon=s.generateIcon(e.icon),this._generatedIcon.inject(this.elements.iconPlaceholder),""!==e.label&&void 0!==e.label&&null!==e.label&&("icon"!==this.mainElementContent||"icon"===this.mainElementContent&&this._isIconModeAutomaticalySet)?this.elements.iconPlaceholder.style.marginRight="11px":t=!0),t&&"icon"!==this.mainElementContent&&!this._isIconModeAutomaticalySet?(this.mainElementContent="icon",this._isIconModeAutomaticalySet=!0):!t&&"icon"===this.mainElementContent&&this._isIconModeAutomaticalySet&&(this.mainElementContent="all",this._isIconModeAutomaticalySet=!1),"icon"===this.mainElementContent&&(this.elements.text.style.displayStyle="none",this.elements.mainElement.style.textAlign="center",!this.actionOnClickFlag&&this.expanderVisibleFlag&&"icon"!==this.mainElementContent&&(this.touchMode?this.elements.iconPlaceholder.style.paddingLeft="19px":this.elements.iconPlaceholder.style.paddingLeft="11px"))}}).call(this,e)}},_popupHidden:function(e){r.call(this),this._selectedIndexModified()},_modelLoaded:function(){r.call(this),function(){var e=this;this._model.getXSO().onAdd(function(t){e.mainElementVisibleFlag&&e.autocompleteFlag&&e.enableSearchFlag&&e._isFiltering&&(e.elements.mainElement.value=t.options.label,e._getMainElement().selectionStart=e._currentStartFiltered)})}.call(this)},_updateCurrentProperties:function(){this.enableSearchFlag&&-1===this.selectedIndex?(this._properties.value.value=""!==this._lastCustomEntry?this._lastCustomEntry:void 0,this._properties.currentValue.value=""!==this._lastCustomEntry?this._lastCustomEntry:void 0,this._properties.label.value=this._lastCustomEntry,this._properties.currentLabel.value=this._lastCustomEntry):this._parent()},_getMainElement:function(){return this.mainElementVisibleFlag?this.elements.mainElement instanceof o?this.elements.mainElement.getContent().dsModel._myInput:this.elements.mainElement:this.elements.expander},_getMainElementTag:function(){return this.elements.mainElement instanceof o?this.elements.mainElement.getContent():this.elements.mainElement},_applyPlaceholder:function(){this.elements.mainElement.placeholder=this.placeholder},_applyMainElementVisibleFlag:function(){this._applyProperties({})},_applyMainElementContent:function(){this._applyProperties({})},_applyExpanderVisibleFlag:function(){var e=this._getMainElementTag();this.expanderVisibleFlag?(this.elements.expander.show(),this.getContent().removeAttribute("no-expander"),e.removeClassName("wux-combobox-mainelement-noexpander")):(this.elements.expander.hide(),this.getContent().setAttributeNode(document.createAttribute("no-expander")),e.addClassName("wux-combobox-mainelement-noexpander"))},_applyGetMainElementCustomization:function(){this._selectedIndexModified()},_applyEnableSearchFlag:function(){this.mainElementVisibleFlag&&(this.enableSearchFlag&&(this.reachablePlaceholderFlag=!0),this._applyProperties({}))},_applyAutocompleteFlag:function(){this.enableSearchFlag&&this._isFiltering&&(this.autocompleteFlag?this._preselectedIndexModified():this.elements.mainElement.value=this._regex)},_applyActionOnClickFlag:function(){!this.enableSearchFlag&&this.mainElementVisibleFlag&&this._applyProperties({})},_applyDisplayStyle:function(){"lite"===this.displayStyle?(this.enableSearchFlag?this.elements.mainElement.displayStyle="lite":this.elements.mainElement.addClassName("wux-ui-style-lite"),this.elements.expander.addClassName("wux-ui-style-lite")):"normal"===this.displayStyle&&(this.enableSearchFlag?this.elements.mainElement.displayStyle="text":this.elements.mainElement.removeClassName("wux-ui-style-lite"),this.elements.expander.removeClassName("wux-ui-style-lite"))},_applyExpanderIcon:function(){this.elements.icon&&this.elements.icon.remove(),this.elements.icon=s.generateIcon(this.expanderIcon).inject(this.elements.expander),this.elements.icon.addClassName("wux-controls-combobox-icon")},_applyProperties:function(e){var t=this.isDirty("enableSearchFlag")||this.isDirty("actionOnClickFlag")&&!1===this.enableSearchFlag||this.isDirty("mainElementVisibleFlag")||this.isDirty("mainElementContent");t&&(a.call(this),this.mainElementVisibleFlag||(this._getMainElementTag().hide(),this.elements.expander.addClassName("wux-combobox-expander-nomainelement"),this.elements.expander.setAttribute("style","border-left-width:1px;"))),this._parent(e),(this.isDirty("expanderIcon")||t)&&this._applyExpanderIcon(e.expanderIcon),(this.isDirty("placeholder")||t)&&this._applyPlaceholder(e.placeholder),(this.isDirty("autocompleteFlag")||t)&&this._applyAutocompleteFlag(e.autocompleteFlag),!this.isDirty("selectedIndex")&&t&&this._applySelectedIndex(e.selectedIndex),!this.isDirty("selectedIndexes")&&t&&this._applySelectedIndexes(e.selectedIndexes),(this.isDirty("expanderVisibleFlag")||t)&&this._applyExpanderVisibleFlag(e.expanderVisibleFlag)}});return n.register(u,"DS/ControlsRec/AbstractRec"),u.createSelectAllComboBox=function(e,t){const i=function(){if(e.elementsList)e.elementsList.unshift({label:t.label,icon:t.icon});else if(e.elementsTree){var i=new l({label:t.label,icon:t.icon});e.elementsTree.addChild(i,0)}e.multiSelFlag=!0,void 0===e.getMainElementCustomization&&(e.getMainElementCustomization=function(){var e="";if(this.multiSelFlag&&this.selectedIndexes.length>0){for(var t=0;t<this.selectedIndexes.length;t++)if(0!==this.selectedIndexes[t]){var i=this._getAllDescendants()[this.selectedIndexes[t]];i&&(e+=i.options.label,t<this.selectedIndexes.length-(1+(!0===this.isAllSelected()?1:0))&&(e+=", "))}}else this.placeholder&&(e=this.placeholder);return{label:e}})};let n;const s=function(){n._model.getXSO().onPreAdd(function(e){if(!n._preventXSOCB){var t=0;n._model.processDescendants({onlyVisibleNodes:!1,processNode:function(){t++}});var i=n.selectedIndexes;if(i.push(e._unfilteredRowID),0===e._unfilteredRowID){i.pop();for(var s=1;s<t;s++)n.selectedIndexes.includes(s)||e._unfilteredRowID===s||i.push(s);i.push(0),n._isAllSelected=!0}else n.selectedIndexes.length===t-1&&(n.selectedIndexes.includes(0)||(i.pop(),i.push(0),i.push(e._unfilteredRowID)),n._isAllSelected=!0);n.selectedIndexes=i}}),n._model.getXSO().onPreRemove(function(e){if(!n._preventXSOCB){var t=0;n._model.processDescendants({onlyVisibleNodes:!1,processNode:function(){t++}});var i=n.selectedIndexes;0===e[0]._unfilteredRowID?(i=[],n._isAllSelected=!1):n.selectedIndexes.length===t&&n.selectedIndexes.includes(0)&&(i.splice(i.findIndex(e=>0===e),1),n._isAllSelected=!1),n.selectedIndexes=i}})};return i(),(n=new u(e))._isSelectAll=!0,s(),n.addEventListener("preLoadModel",i),n.addEventListener("modelLoaded",s),n},u});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/AbstractDecorator",["require","exports","DS/Controls/Abstract","DS/Controls/Popup","DS/Core/WebUXComponents","DS/Utilities/WUXUWAUtils"],function(e,t,i,n,s,o){"use strict";var l=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return o.extendingClassFlag,n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{widget:{defaultValue:void 0,type:"IWUXControlAbstract",category:"Behavior"},decoratedWidget:{defaultValue:void 0,type:"HTMLElement",category:"Behavior"},visibleFlag:{defaultValue:!1,type:"boolean",category:"Behavior",recordFlag:!0}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){this._shouldValidateValue=!0},t.prototype.destroy=function(){this.hide(),e.prototype.destroy.call(this)},t.prototype.hide=function(e){this._shouldValidateValue=e,this.visibleFlag=!1},t.prototype.show=function(){this.visibleFlag=!0},t.prototype._buildContent=function(){},t.prototype._onShow=function(){},t.prototype._onHide=function(e){},t.prototype._applyVisibleFlag=function(){var e=this;if(this.visibleFlag)if(this._onShow(),this.elements.popup)this.elements.popup.show();else{var t={target:e.decoratedWidget,position:"bottom",alignment:"center",constraint:"screen",className:"wux-controls-popup wux-decorator-popup",overlap:!1,arrowBoxFlag:!0,getBody:function(){return e._buildContent()}};n.delayPopupCreation(t,function(t){e.elements.popup=t,e.elements.popup.elements.container.removeAttribute("tabindex")}).createVisiblePopup.call(this)}else this._onHide(this._shouldValidateValue),this.elements.popup&&this.elements.popup.hide()},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("decoratedWidget")&&this.elements.popup&&(this.elements.popup.target=this.decoratedWidget)},t}(i);return s.addClass(l,"abstractdecorator"),l}),define("DS/Controls/TileView",["UWA/Core","UWA/Controls/Abstract","DS/Layouts/GridEngineCellAbstract","DS/Controls/ViewBase","DS/UIBehaviors/SwipeableMenu","DS/Core/PointerEvents","DS/Controls/Toggle","DS/Utilities/Dom"],function(e,t,i,n,s,o,l,a){"use strict";return n.extend({defaultOptions:{size:"small",view:"tile",picture:{size:"cover",width:null,position:"center center"}},init:function(t){this._parent(t),this._isHighlighted=!1,this.elements.container=new e.Element("div",{class:"wux-controls-tileview wux-ui-size-"+this.options.size,styles:{padding:0}}),this.elements.thumbnail=new e.Element("div",{class:"wux-controls-tileview-container wux-ui-size-"+this.options.size,styles:{border:"none",margin:0}});var i=void 0;(this.options.useSwipableMenu=!0,t.gridEngine&&!1===t.gridEngine.options.useSwipableMenu)?(this.options.useSwipableMenu=!1,this.elements.thumbnail.inject(this.elements.container)):(i=new s({target:this.elements.thumbnail,menu:this.options.menu})).getContent().setStyles({lineHeight:"60px",overflow:"visible"}).inject(this.elements.container);this.elements.picture=new e.Element("div",{class:"wux-controls-tileview-picture",styles:{backgroundImage:"",width:this.options.picture.width?this.options.picture.width:"",backgroundSize:this.options.picture.size,backgroundPosition:this.options.picture.position}}).inject(this.elements.thumbnail),this.elements.checkbox=new l({checkFlag:!1,disabled:!1}).inject(this.elements.picture),this.elements.checkbox.getContent().addClassName("wux-controls-tileview-checkbox wux-ui-size-"+this.options.size);var n=this;this.elements.container.addEvent("mouseenter",function(e){n.isPreHighlighted||(n.elements.checkbox.getContent().addClassName("wux-ui-state-prehighlighted"),n.isPreHighlighted=!0)}),this.elements.container.addEvent("mouseleave",function(e){n.isPreHighlighted&&(n.elements.checkbox.getContent().removeClassName("wux-ui-state-prehighlighted"),n.isPreHighlighted=!1)}),this.elements.checkbox.addEventListener(o.POINTERDOWN,function(e){e.stopPropagation()}),this.elements.checkbox.addEventListener(o.POINTERUP,function(e){e.stopPropagation()}),this._listenToChanges=!0,this.elements.checkbox.addEventListener("change",function(e){n._listenToChanges&&(n.isHighlighted()?n.unhighlight():n.highlight())}),this.elements.cartouche=new e.Element("div",{class:"wux-controls-tileview-cartouche",styles:{left:this.options.picture.width?this.options.picture.width:""}}).inject(this.elements.thumbnail),this.elements.cartoucheContent=new e.Element("div",{class:"wux-controls-tileview-cartouche-content"}).inject(this.elements.cartouche),this.elements.icon=new e.Element("div",{class:"wux-controls-tileview-icon wux-ui-size-"+this.options.size,styles:{backgroundImage:"",backgroundSize:"cover"}}).inject(this.elements.cartoucheContent),this.elements.badgeTopRight=new e.Element("div",{class:"wux-controls-tileview-badge-top-right"}).inject(this.elements.cartoucheContent),this.elements.badgeBottomRight=new e.Element("div",{class:"wux-controls-tileview-badge-bottom-right"}).inject(this.elements.cartoucheContent),this.elements.color=new e.Element("div",{class:"wux-controls-tileview-color"}).inject(this.elements.container),this.elements.colorBlank=new e.Element("div",{class:"wux-controls-tileview-colorBlank"}).inject(this.elements.container),this.elements.title=new e.Element("div",{class:"wux-controls-tileview-title wux-font-3dsregular"}).inject(this.elements.cartoucheContent),this.elements.subtitle=new e.Element("div",{class:"wux-controls-tileview-subtitle",html:"Sous-titre"}).inject(this.elements.cartoucheContent),this.elements.menu=new e.Element("div",{class:"wux-controls-tileview-menu wux-ui-size-"+this.options.size}).inject(this.elements.cartoucheContent),this.elements.menu.addClassName("wux-ui-3ds"),this.elements.menu.addClassName("wux-ui-3ds-open-down"),this.elements.description=new e.Element("div",{class:"wux-controls-tileview-description",html:"Far far away, behind the word mountains, far from the countries Vokalia and Consonantia, there live the blind texts. Separated they live in Bookmarksgrove right at the coast of the ..."}).inject(this.elements.cartoucheContent),this.elements.menu.addEvent(o.POINTERDOWN,function(e){e.preventDefault();var t=this.cellView;if(t){var s=t.getCellInfos();s.cellModel&&s.cellModel.isSelected()&&e.stopPropagation()}!0===n.options.useSwipableMenu&&i._indexPositions()}),this.elements.menu.addEvent(o.POINTERUP,function(e){e.preventDefault(),!0===n.options.useSwipableMenu&&i.toggle()}),this.setColor(this.options.color),this.setIcon(this.options.icon),this._attachEvents()},setIcon:function(e){this.elements.icon.className="",this.elements.icon.addClassName("wux-controls-tileview-icon wux-ui-size-"+this.options.size),e?(this.elements.container.setAttribute("has-icon","true"),this.elements.icon.setAttribute("has-icon","true"),a.generateIcon(e,{target:this.elements.icon}),this.elements.icon.show()):(this.elements.container.setAttribute("has-icon","false"),this.elements.icon.setAttribute("has-icon","false"),this.elements.icon.hide())},isHighlighted:function(){return this._isHighlighted},highlight:function(){this._isHighlighted=!0,this.elements.container.addClassName("wux-ui-state-highlighted"),this.elements.checkbox.getContent().addClassName("wux-ui-state-highlighted"),!0!==this.elements.checkbox.checkFlag&&(this._listenToChanges=!1,this.elements.checkbox.checkFlag=!0,this._listenToChanges=!0)},unhighlight:function(){this._isHighlighted=!1,this.elements.container.removeClassName("wux-ui-state-highlighted"),this.elements.checkbox.getContent().removeClassName("wux-ui-state-highlighted"),!1!==this.elements.checkbox.checkFlag&&(this._listenToChanges=!1,this.elements.checkbox.checkFlag=!1,this._listenToChanges=!0)},activate:function(){this.elements.container.addClassName("wux-ui-state-activated")},deactivate:function(){this.elements.container.removeClassName("wux-ui-state-activated")}})}),define("DS/Controls/TileCellView",["UWA/Core","DS/Controls/TileView","DS/Layouts/GridEngineCellAbstract","DS/UIBehaviors/ContextualMenuManager","DS/Core/PointerEvents","DS/Menu/ContextualMenu","DS/Utilities/Dom"],function(e,t,i,n,s,o,l){"use strict";function a(e){return e.charAt(0).toUpperCase()+e.slice(1)}return i.extend({defaultOptions:{size:"small",menu:[]},init:function(e){var i=e.menu;e.menu=[],this._CtxMenuByRightClick=!0,this._parent(e),this.elements.container.setStyles({border:"none"}),this.elements.container.setAttribute("draggable","true"),this.elements.container.dsView=this,this._view=new t(this.options).inject(this.elements.container),this._view.elements.menu.cellView=this;var o=this;this._view.elements.checkbox.addEventListener(s.POINTERDOWN,function(e){e.stopPropagation()}),this._view.elements.checkbox.addEventListener(s.POINTERUP,function(e){e.stopPropagation()}),this._view.elements.checkbox.addEventListener("click",function(e){o.getGridEngine()&&!0===o.getGridEngine()._isTouchWithatCellHover&&(o.getGridEngine()._isTouchWithatCellHover=!1,e.stopPropagation(),o.getGridEngine()._enableInteractiveMultiSelMode())},!0),this._view._listenToChanges=!0,this._view.elements.checkbox.addEventListener("change",function(e){if(o._view._listenToChanges){var t=o.getGridEngine(),i=o.getCellInfos();t&&i&&(t._enableInteractiveMultiSelMode(),i.cellModel.isSelected()?i.cellModel.unselect():(t.options.selection.canMultiSelect||t.options.TreedocModel.getXSO().empty(),i.cellModel.select()),t.options.lastSelectedNode=i.cellModel)}}),this.setupContextualMenu(i),this.getGridEngine().options.onContextualEvent?this._view.elements.menu.addEventListener(s.POINTERUP,function(e){var t=this.cellView;if(o._CtxMenuByRightClick=!1,!s.isTouchEvent(e)||!t.getGridEngine()._preventSelectionForTouchScroll){var i=t.getCellInfos();if(i){var n=i.nodeModel;n&&!n.isSelected()&&(n.select(!0),t.getGridEngine().setActiveNode(n,!0))}if(t.getGridEngine().options.onContextualEvent){var l=document.createEvent("HTMLEvents");l.initEvent("contextmenu",!0,!1),l.pageX=e.pageX,l.pageY=e.pageY,this.dispatchEvent(l)}o._CtxMenuByRightClick=!0,e.stopPropagation()}}):this._view.elements.menu.addEventListener(s.POINTERDOWN,function(e){var t=this.cellView;o._CtxMenuByRightClick=!1,n.show(t._view.elements.container,[e.pageX,e.pageY]),o._CtxMenuByRightClick=!0})},setupContextualMenu:function(e){var t=this,i=this.getGridEngine().options.onContextualEvent;if(i)o.addEventListener(this.elements.container,{callback:function(e){if(t.getGridEngine()&&(t.getGridEngine()._cellCtxMenuRequired=!0,!0===t._CtxMenuByRightClick)){var n=t.getCellInfos();if(n){var s=n.nodeModel;s&&!s.isSelected()&&(s.select(!0),t.getGridEngine().setActiveNode(s,!0))}}return i.callback.call(i.this,{context:t,menuContext:e.context,infos:e.info,data:e.data,cellInfos:t.getCellInfos()})}});else{var s=this.getGridEngine().options.onContextualMenuReady,l=s;"function"==typeof s&&(l=function(){var e=t.getCellInfos();if(e&&!0===t._CtxMenuByRightClick){var i=e.nodeModel;i&&!i.isSelected()&&(i.select(!0),t.getGridEngine().setActiveNode(i,!0))}return s.call(t,e)}),n.forget({target:this._view.elements.container,nodes:l}),n.onReady({target:this._view.elements.container,nodes:l})}},updateInternalParameters:function(){this.setColor(),this.setTitle(),this.setSubtitle(),this.setDescription(),this.unhighlight(),this.deactivate(),this.unsetBadges()},setColor:function(e){this._view.setColor(e)},setIcon:function(e){this._view.setIcon(e)},setTitle:function(e){this._view.setTitle(e),(!this.getGridEngine()||this.getGridEngine()&&"function"==typeof this.getGridEngine().getShouldDisplayTooltipFlag&&!0===this.getGridEngine().getShouldDisplayTooltipFlag())&&(this.elements.container.title=e)},setSubtitle:function(e){this._view.setSubtitle(e)},setDescription:function(e){this._view.setDescription(e)},setPicture:function(e){this._view.setPicture(e)},highlight:function(){this._view.highlight()},unhighlight:function(){this._view.unhighlight()},activate:function(){this._view.activate()},deactivate:function(){this._view.deactivate()},getCellInfos:function(){var e=this._parent(),t=this.getVirtualCoordinates();return e.nodeModel=this.getGridEngine().getCellModel(t.virtualRowID,t.virtualColumnID),e},setPictureBackgroundSize:function(e){this._view&&this._view.elements.picture&&this._view.elements.picture.setStyle("background-size",e)},unsetBadges:function(){this._view.elements.badgeTopRight.style.backgroundImage="",this._view.elements.badgeTopRight.style.visibility="hidden",this._view.elements.badgeTopRight.className="",this._view.elements.badgeTopRight.addClassName("wux-controls-tileview-badge-top-right"),this._view.elements.badgeBottomRight.style.backgroundImage="",this._view.elements.badgeBottomRight.style.visibility="hidden",this._view.elements.badgeBottomRight.className="",this._view.elements.badgeBottomRight.addClassName("wux-controls-tileview-badge-bottom-right")},setBadges:function(e){for(var t in e){var i=e[t];i&&(l.generateIcon(i,{target:this._view.elements["badge"+a(t)]}),this._view.elements["badge"+a(t)].style.visibility="visible")}}})}),define("DS/Controls/Calendar",["UWA/Core","DS/Controls/Abstract","DS/Core/Core","DS/Utilities/Dom","DS/Utilities/DateUtils","DS/Core/PointerEvents","DS/Utilities/KeyboardUtils","UWA/Utils/Client","DS/WebRecordEnabler/Adapter","DS/Controls/ComboBox","DS/Controls/Button","DS/Controls/TooltipModel","DS/Core/WebUXComponents","i18n!DS/Controls/assets/nls/translation"],function(e,t,i,n,s,o,l,a,r,h,u,c,d,p){"use strict";const m={weekday:"long",year:"numeric",month:"long",day:"numeric"};let g={day_names:[],day_names_short:[],month_names:[],month_names_short:[]};function v(e){return e[0].toUpperCase()+e.slice(1)}function f(e,t,i){this[e]=s.addToDate(this[e],t,i)}function y(e,t,i,n){return s.isDateInBetween(e,t,i,n||"day")}function b(e,t,i,n){if(e&&!y(e,t,i,n)){if(t&&e<t)return t;if(i&&e>i)return i}}function _(e,t,i){return s.areDatesEqual(e,t,i?"time":"day")}function C(e,t,i){return void 0===t&&void 0===e||!(!e||!t)&&(e instanceof Date&&t instanceof Date?_(e,t,i):Array.isArray(e)&&t instanceof Date?e.some(e=>_(e,t,i)):!(!Array.isArray(e)||!Array.isArray(t))&&(e.length===t.length&&e.every(e=>C(e,t,i))))}function w(e,t,i){s.pushUniqueDate(e,t,i||"day")}var x=t.inherit({name:"calendar",markForRecordFlag:!0,publishedProperties:{value:{defaultValue:void 0,type:"date",category:"Behavior",advancedSetter:!0,recordFlag:!0},referenceDate:{defaultValue:void 0,type:"date",category:"Behavior"},minValue:{defaultValue:void 0,type:"date",category:"Behavior"},maxValue:{defaultValue:void 0,type:"date",category:"Behavior"},allowMultipleValuesFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},allowUndefinedFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},noContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}},_privateProperties:{_timePicker:{defaultValue:void 0,type:"object"}},blackBoxFlag:!0,_preBuild:function(e){this._parent();let t=new Date;this._properties.value.value=new Date(t.getTime()),e&&e.value&&!e.referenceDate&&(this._properties.referenceDate.value=Array.isArray(e.value)?e.value[e.value.length-1]:e.value),this._properties.referenceDate.value||(this._properties.referenceDate.value=t)},buildView:function(){this._updateLanguage(),this.elements.container.addClassName("wux-controls-calendar"),this.elements.container.setAttribute("tabindex",0),this.elements.calendarHeader=e.createElement("div",{class:"wux-controls-calendar-header"}).inject(this.elements.container),this.elements.left=e.createElement("div",{class:"wux-controls-calendar-button"}).inject(this.elements.calendarHeader),n.generateIcon("expand-left").inject(this.elements.left).removeClassName("wux-ui-3ds-lg"),this.elements.left.set("title",p.previousMonth||""),this.elements.center=e.createElement("div",{class:"wux-controls-calendar-center"}).inject(this.elements.calendarHeader),this.elements.monthsCombo=new h({elementsList:g.month_names.map((e,t)=>({label:e,value:t})),enableSearchFlag:!0,autocompleteFlag:!0,expanderVisibleFlag:!1}).inject(this.elements.center),this.elements.right=e.createElement("div",{class:"wux-controls-calendar-button"}).inject(this.elements.calendarHeader),n.generateIcon("expand-right").inject(this.elements.right).removeClassName("wux-ui-3ds-lg"),this.elements.right.set("title",p.nextMonth||""),this.elements.calendarContainer=e.createElement("table",{class:"wux-controls-calendar-table"}).inject(this.elements.container),this.elements.calendarTabHead=e.createElement("thead",{class:"wux-controls-calendar-table-head"}).inject(this.elements.calendarContainer),this._updateColumnsHeader(),this.elements.calendarFooter=e.createElement("div",{class:"wux-controls-calendar-footer"}).inject(this.elements.container),this.elements.timePicker=e.createElement("div",{class:"wux-controls-calendar-timePicker"}).inject(this.elements.calendarFooter),this.elements.todayButton=new u({label:this._timePicker?p.nowButtonLabel:p.todayButtonLabel,tooltipInfos:new c({shortHelp:this._timePicker?p.nowTooltip:p.todayTooltip})}),this.elements.todayButton.inject(this.elements.calendarFooter),this.elements.todayButton.getContent().addClassName("wux-controls-calendar-todaybutton")},_buildCalendarDays:function(){function t(e,t){if(t.stopPropagation(),!1===this.disabled&&!e.hasClassName("unclickable")){const t=e.getData("value").split("/"),i=!e.classList.contains("selected"),n=t[0],s=t[1]-1,o=t[2];let l=0,a=0,r=0;this._timePicker&&this._timePicker.value&&(l=this._timePicker.value.getHours(),a=this._timePicker.value.getMinutes(),r="sec"===this._timePicker.precision?this._timePicker.value.getSeconds():0);const h=new Date(o,s,n,l,a,r);if(this.allowMultipleValuesFlag){let e=this.value;if(e){if(Array.isArray(e)){if(e=[...e],i)e.push(h);else{let t=[];for(let i=0,n=e.length;i<n;++i)C(e[i],h)||t.push(e[i]);if(!this.allowUndefinedFlag&&0===t.length)return;this._preventReferenceDateUpdate=!0,e=t}this.setPropertyFromUIInteraction("value",e,"click_Day"),this._preventReferenceDateUpdate=!1}}else this.setPropertyFromUIInteraction("value",[h],"click_Day")}else this.allowUndefinedFlag&&!i?this.setPropertyFromUIInteraction("value",void 0,"click_Day"):i&&this.setPropertyFromUIInteraction("value",h,"click_Day")}}return function(s,o){let l,r=new Date(o,s,1),h=function(e){if(a.Engine.safari||"iPad"===navigator.platform||"iPhone"===navigator.platform)return e.getDay();var t=e.toLocaleDateString(i.currentLanguage,{weekday:"short"});return g.day_names_short.indexOf(t)}(r),u=new Date,c=this.minValue&&new Date(this.minValue.getFullYear(),this.minValue.getMonth(),this.minValue.getDate()),d=this.maxValue&&new Date(this.maxValue.getFullYear(),this.maxValue.getMonth(),this.maxValue.getDate()+1),p=e.createElement("tbody");r.setDate(r.getDate()-h);var v=r.getMonth(),f=r.getFullYear();for(let s=0;s<h;++s){0===s&&(l=e.createElement("tr"),p.appendChild(l));let o=r.getDate(),a=!0,h="other-date";(c&&r<c||d&&r>=d)&&(h+=" unclickable",a=!1),C(this.value,r)&&(h+=" selected");let u=e.createElement("td",{class:h,text:o,title:r.toLocaleDateString(i.currentLanguage,m)}).setData("value",o+"/"+(v+1)+"/"+f);a&&n.addEventOnElement(this,u,"click",t.bind(this,u)),l.appendChild(u),r.setDate(o+1)}for(var y=h;r.getMonth()===s;){let a=r.getDate(),h=!0;0===y&&(l=e.createElement("tr"),p.appendChild(l));let v=_(r,u)?"today":"days";(c&&r<c||d&&r>=d)&&(v+=" unclickable",h=!0),C(this.value,r)&&(v+=" selected");let f=e.createElement("td",{class:v,text:a,title:r.toLocaleDateString(i.currentLanguage,m)}).setData("value",a+"/"+(s+1)+"/"+o);h&&n.addEventOnElement(this,f,"click",t.bind(this,f)),l.appendChild(f),r.setDate(a+1),y=++y%g.day_names.length}if(0!==y){var b=r.getMonth(),w=r.getFullYear();for(let s=y;s<g.day_names.length;++s){let s=r.getDate(),o=!0,a="other-date";(c&&r<c||d&&r>=d)&&(a+=" unclickable",o=!1),C(this.value,r)&&(a+=" selected");let h=e.createElement("td",{class:a,text:s,title:r.toLocaleDateString(i.currentLanguage,m)}).setData("value",s+"/"+(b+1)+"/"+w);o&&n.addEventOnElement(this,h,"click",t.bind(this,h)),l.appendChild(h),r.setDate(s+1)}}return p.appendChild(l),p}}(),_buildYearsList:function(){var e=this.referenceDate.getFullYear(),t=-10,i=10,n=!1;this.yearsList&&-1===this.yearsList.indexOf(e)&&(n=!0),this.yearsList=[],this.minValue&&(t=this.minValue.getFullYear()-e),this.maxValue&&(i=this.maxValue.getFullYear()-e);for(var s=t;s<=i;s++)this.yearsList[this.yearsList.length]=e+s,n=!0;this.elements.yearsCombo?n&&(this._isBuildYearsList=!0,this.elements.yearsCombo.elementsList.toString()!==this.yearsList.toString()&&(this.elements.monthsCombo.currentValue=this.referenceDate.getMonth(),this.elements.yearsCombo.elementsList=this.yearsList.map(e=>({label:String(e),value:e}))),this.elements.yearsCombo.currentValue=e,this._isBuildYearsList=void 0):(this.elements.yearsCombo=new h({elementsList:this.yearsList.map(e=>({label:String(e),value:e})),currentValue:e,enableSearchFlag:!0,autocompleteFlag:!0,expanderVisibleFlag:!1}).inject(this.elements.center),this.elements.yearsCombo.getContent().addClassName("wux-calendar-yearscombo"),this.elements.yearsCombo.touchMode=this.touchMode)},_applyDisabled:function(){this._parent(),this.elements.todayButton&&(this.elements.todayButton.disabled=this.disabled)},_applyTouchMode:function(){this._parent(),this.elements.yearsCombo&&(this.elements.yearsCombo.touchMode=this.touchMode),this.elements.monthsCombo&&(this.elements.monthsCombo.touchMode=this.touchMode),this.elements.todayButton&&(this.elements.todayButton.touchMode=this.touchMode)},handleEvents:function(){let t,s,a=this;a._isLeftDown=!1,a._isRightDown=!1,n.addEventOnElement(this,this.elements.left,o.POINTERDOWN,function(){a._isLeftDown=!0}),n.addEventOnElement(this,this.elements.left,o.POINTERUP,function(){a._isLeftDown&&(a._decrement(),a._isLeftDown=!1)}),n.addEventOnElement(this,this.elements.left,o.POINTERDOWN,function(e){e.stopPropagation(),e.preventDefault(),(s||t)&&(clearTimeout(s),clearInterval(t)),s=setTimeout(function(){if(!a._isLeftDown)return clearTimeout(s),void clearInterval(t);t=setInterval(function(){if(!a._isLeftDown)return clearTimeout(s),void clearInterval(t);n.pushUserInteractionContext(),a._decrement(),n.popUserInteractionContext()},100)},100)}),n.addEventOnElement(this,this.elements.left,o.POINTERUP,function(e){e.stopPropagation(),e.preventDefault(),a._isLeftDown=!1,clearTimeout(s),clearInterval(t)}),n.addEventOnElement(this,this.elements.right,o.POINTERDOWN,function(){a._isRightDown=!0}),n.addEventOnElement(this,this.elements.right,o.POINTERUP,function(){a._isRightDown&&(a._increment(),a._isRightDown=!1)}),n.addEventOnElement(this,this.elements.right,o.POINTERDOWN,function(e){e.stopPropagation(),e.preventDefault(),(s||t)&&(clearTimeout(s),clearInterval(t)),s=setTimeout(function(){if(!a._isRightDown)return clearTimeout(s),void clearInterval(t);t=setInterval(function(){if(!a._isRightDown)return clearTimeout(s),void clearInterval(t);n.pushUserInteractionContext(),a._increment(),n.popUserInteractionContext()},100)},100)}),n.addEventOnElement(this,this.elements.right,o.POINTERUP,function(e){e.stopPropagation(),e.preventDefault(),a._isRightDown=!1,clearTimeout(s),clearInterval(t)}),n.addEventOnElement(this,this.elements.monthsCombo,"show",e=>e.stopPropagation),n.addEventOnElement(this,this.elements.yearsCombo,"show",e=>e.stopPropagation),n.addEventOnElement(this,this.elements.monthsCombo,"hide",e=>e.stopPropagation),n.addEventOnElement(this,this.elements.yearsCombo,"hide",e=>e.stopPropagation),n.addEventOnElement(this,this.elements.monthsCombo,"change",function(e){if(e.stopPropagation(),a._redrawInProgress)return;const t=a.elements.monthsCombo.currentValue;if(0<=t&&t<=12){const e=t-a.referenceDate.getMonth();e&&f.call(a,"referenceDate",e,"month")}else a.elements.monthsCombo.value=a.referenceDate.getMonth()}),n.addEventOnElement(this,this.elements.yearsCombo,"change",function(e){if(e.stopPropagation(),a._redrawInProgress||a._isBuildYearsList)return;const t=a.elements.yearsCombo.currentValue;if(isNaN(t))a.elements.yearsCombo.value=a.referenceDate.getFullYear();else{const e=t-a.referenceDate.getFullYear();e&&f.call(a,"referenceDate",e,"year")}}),n.addEventOnElement(this,this.elements.todayButton,"buttonclick",function(){if(!1===a.disabled){const e=new Date;if(a.allowMultipleValuesFlag){let t=a.value;t?Array.isArray(t)&&(C(t,e,Boolean(a._timePicker))||((t=t.slice()).push(e),a._setCurrentDate(t))):a._setCurrentDate([e]),a._setReferenceDate(e)}else a._setCurrentDate(e)}}),n.addEventOnElement(this,this.elements.calendarContainer,o.POINTERMOVE,function(e){e.preventDefault(),e.stopPropagation()}),n.addEventOnElement(this,this.elements.yearsCombo,"mousewheel",function(t){(a.elements.yearsCombo===document.activeElement||a.getContent().hasAttribute("focused"))&&(t.preventDefault(),t.stopPropagation(),e.Event.wheelDelta(t)>0?a._decrement(!0):a._increment(!0))}),n.addEventOnElement(this,this.elements.container,"mousewheel",function(t){(a.elements.container===document.activeElement||a.getContent().hasAttribute("focused"))&&(t.preventDefault(),t.stopPropagation(),e.Event.wheelDelta(t)>0?a._decrement():a._increment())}),n.addEventOnElement(this,this.elements.container,"keydown",function(e){(a.elements.container===document.activeElement||a.getContent().hasAttribute("focused"))&&(e.keyCode===l.PAGEUP?a._decrement():e.keyCode===l.PAGEDOWN&&a._increment())}),n.addEventOnElement(this,document,o.POINTERUP,function(){clearTimeout(s),clearInterval(t)}),a._updateOnCurrentLanguageChange=function(){a._updateLanguage(),a._updateColumnsHeader(),a._redrawCalendar()},i.onlanguagechange(a._updateOnCurrentLanguageChange)},destroy:function(){i.offlanguagechange(this._updateOnCurrentLanguageChange),this._parent()},_applyProperties:function(e){if(this._parent(e),this._preventRedraw=!0,this.isDirty("_timePicker")&&this._apply_timePicker(e._timePicker,this._timePicker),this.isDirty("referenceDate")&&(this._applyReferenceDate(e.referenceDate,this.referenceDate),this._preventReferenceDateUpdate=!0),this.isDirty("minValue")&&this._applyMinValue(e.minValue,this.minValue),this.isDirty("maxValue")&&this._applyMaxValue(e.maxValue,this.maxValue),this.isDirty("allowMultipleValuesFlag")){const t=this.allowMultipleValuesFlag;e.hasOwnProperty("value")&&e.value&&(e.value=t?[e.value]:e.value[0]),this._applyAllowMultipleValuesFlag(e.allowMultipleValuesFlag,t)}this.isDirty("value")&&d._applyForAdvancedSetterProperty(this,"value",e.value,this.value),this._preventReferenceDateUpdate=!1,this._preventRedraw=!1,this._redrawNeeded&&this._redrawCalendar()},_applyMinValue:function(){this._correctValueToMinMaxValues(),this.elements.todayButton&&(this.elements.todayButton.disabled=this.disabled||!this._checkTodayIsBetweenMinMaxValues())},_applyMaxValue:function(){this._correctValueToMinMaxValues(),this.elements.todayButton&&(this.elements.todayButton.disabled=this.disabled||!this._checkTodayIsBetweenMinMaxValues())},_checkTodayIsBetweenMinMaxValues:function(){return y(new Date,this.minValue,this.maxValue,this._timePicker?"time":"day")},_correctValueToMinMaxValues:function(){let e=this.value,t=this.minValue,i=this.maxValue;if(e&&e instanceof Date){const n=b(e,t,i,this._timePicker?"time":"day");n&&this._setCurrentDate(n)}else if(e&&Array.isArray(e)){let t;e=e.map(e=>{const i=b(e,this.minValue,this.maxValue,this._timePicker?"time":"day");return i&&(t=!0),i||e}),t&&this._setCurrentDate(e)}this._redrawCalendar()},_preEditValue:function(e,t){if(void 0===e&&void 0===t)return!1;if(void 0===t)return!0;if(null===t)return{validValue:void 0};if(this.allowMultipleValuesFlag){if(!Array.isArray(t))return!1;for(let e=0,i=t.length;e<i;++e){let i=t[e];"string"==typeof i&&(t[e]=new Date(Date.parse(i)))}}else if("string"==typeof t&&(t=new Date(Date.parse(t))),!(t instanceof Date))return!1;let i,n=this._timePicker?"time":"day";if(Array.isArray(t)){i=[];for(let e=0;e<t.length;++e){let s=t[e];y(s=b(s,this.minValue,this.maxValue,n)||s,this.minValue,this.maxValue,n)&&w(i,new Date(s),n)}}else y(t=b(t,this.minValue,this.maxValue,n)||t,this.minValue,this.maxValue,n)&&(i=new Date(t));return!(!i||C(e,i,!0))&&{validValue:i}},_applyValue:function(e,t){let i=!1;this._preventRedraw||(i=this._preventRedraw=!0),this._preventReferenceDateUpdate||(this.referenceDate=t),i&&(this._preventRedraw=!1,this._redrawCalendar()),this.fire("change")},_applyReferenceDate:function(e,t){let i,n,s;i=(i=Array.isArray(t)&&t.length?t[t.length-1]:t)?new Date(i):i,this.minValue&&(n=new Date(this.minValue.getFullYear(),0)),this.maxValue&&(s=new Date(this.maxValue.getFullYear(),11)),y(i,n,s,"month")||(i=e||new Date,this._properties.referenceDate.value=i),C(i,this.referenceDate)||(this._properties.referenceDate.value=i),C(e,i)||this._redrawCalendar()},_applyAllowMultipleValuesFlag:function(e,t){if(t===e)return;const i=this.value;t&&i&&!Array.isArray(i)?this._properties.value.value=[i]:!t&&i&&Array.isArray(i)&&(this._properties.value.value=1!==i.length?void 0:i[0]),t?this.getContent().setAttribute("multiple-values",""):this.getContent().removeAttribute("multiple-values")},_setCurrentDate:function(e){this.value=e},_setReferenceDate:function(e){this.referenceDate=e},_apply_timePicker:function(e,t){if(t===e||!this.elements.todayButton)return;let i=this.elements.todayButton;i.label=t?p.nowButtonLabel:p.todayButtonLabel,i.tooltipInfos.shortHelp=t?p.nowTooltip:p.todayTooltip,i.disabled=this.disabled||!this._checkTodayIsBetweenMinMaxValues()},_increment:function(e){f.call(this,"referenceDate",1,e?"year":"month")},_decrement:function(e){f.call(this,"referenceDate",-1,e?"year":"month")},incrementDayValue:function(){f.call(this,"value",1,"day")},decrementDayValue:function(){f.call(this,"value",-1,"day")},incrementMonthValue:function(){f.call(this,"value",1,"month")},decrementMonthValue:function(){f.call(this,"value",-1,"month")},incrementYearValue:function(){f.call(this,"value",1,"year")},decrementYearValue:function(){f.call(this,"value",-1,"year")},_redrawCalendar:function(){if(this._preventRedraw)return void(this._redrawNeeded=!0);this._redrawInProgress=!0;let e=this.referenceDate.getMonth(),t=this.referenceDate.getFullYear();this.elements.calendarTab&&this.elements.calendarTab.remove(),this.elements.calendarTab=this._buildCalendarDays(e,t),this.elements.calendarTabHead.show(),this.elements.calendarFooter.show(),this.elements.calendarTab.inject(this.elements.calendarContainer),this._buildYearsList(),this.elements.monthsCombo.currentValue=e,this.elements.yearsCombo.currentValue=t,this._updateArrows(),this._redrawInProgress=!1,this._redrawNeeded=!1},_updateArrows:function(){var e=!0;this.minValue&&(0===this.referenceDate.getMonth()?this.minValue.getFullYear()>this.referenceDate.getFullYear()-1&&(e=!1):this.minValue.getFullYear()>this.referenceDate.getFullYear()&&(e=!1),e?this.elements.left.removeAttribute("disabled"):this.elements.left.setAttributeNode(document.createAttribute("disabled"))),e=!0,this.maxValue&&(11===this.referenceDate.getMonth()?this.maxValue.getFullYear()<this.referenceDate.getFullYear()+1&&(e=!1):this.maxValue.getFullYear()<this.referenceDate.getFullYear()&&(e=!1),e?this.elements.right.removeAttribute("disabled"):this.elements.right.setAttributeNode(document.createAttribute("disabled")))},_updateColumnsHeader:function(){for(var e="",t=0;t<g.day_names_short.length;t++){var i=g.day_names_short[t];e+='<th scope="col" title="'+g.day_names[t]+'">'+i+"</th>"}this.elements.calendarTabHead.innerHTML=e},_updateLanguage:function(){if(a.Engine.safari||"iPad"===navigator.platform||"iPhone"===navigator.platform)g="fr"===i.currentLanguage||"fr-FR"===i.currentLanguage||"FR"===i.currentLanguage?{day_names:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],day_names_short:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],month_names:["Janvier","Fvrier","Mars","Avril","Mai","Juin","Juillet","Aot","Septembre","Octobre","Novembre","Dcembre"],month_names_short:["Jan","Fev","Mar","Avr","Mai","Jun","Jul","Ao","Sep","Oct","Nov","Dc"]}:{day_names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],day_names_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],month_names:["January","February","March","April","May","June","July","August","September","October","November","December"],month_names_short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]};else{var e=new Date(0,0,1),t=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours());e=t,g={day_names:[],day_names_short:[],month_names:[],month_names_short:[]};for(let t=0;t<7;t++)g.day_names.push(v(e.toLocaleDateString(i.currentLanguage,{weekday:"long"}))),g.day_names_short.push(e.toLocaleDateString(i.currentLanguage,{weekday:"short"})),e.setDate(e.getDate()+1);for(let t=0;t<12;t++)g.month_names.push(v(e.toLocaleDateString(i.currentLanguage,{month:"long"}))),g.month_names_short.push(e.toLocaleDateString(i.currentLanguage,{month:"short"})),e.setMonth(e.getMonth()+1)}this.elements.monthsCombo&&this.elements.monthsCombo.elementsList.toString()!==g.month_names.toString()&&(this.elements.monthsCombo.elementsList=g.month_names.map((e,t)=>({label:e,value:t}))),Date.locale=g}});return r.register(x,"DS/ControlsRec/AbstractRec"),x}),define("DS/Controls/TabBar",["UWA/Core","DS/Controls/Abstract","DS/Controls/ButtonGroup","DS/Controls/LineEditor","DS/CoreEvents/ModelEvents","DS/Utilities/Dom","DS/Core/PointerEvents","DS/Controls/Button","DS/Controls/Toggle","DS/Controls/ComboBox","DS/Tree/TreeDocument","DS/TreeModel/TreeNodeModel","DS/Controls/TooltipModel","DS/WebRecordEnabler/Adapter","i18n!DS/Controls/assets/nls/translation.json","DS/Menu/Menu"],function(e,t,i,n,s,o,l,a,r,h,u,c,d,p,m,g){"use strict";var v,f,y;function b(e,t){e.__slideMargin!==t&&(e.__slideMargin=t,e.buttonGroup.getContent().setStyle("margin-left",t?t+"px":""))}Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};var _=t.inherit({name:"tabBar",markForRecordFlag:!0,publishedProperties:{newTabButtonFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},pinFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},editableFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},centeredFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},closeButtonFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},closeAllButtonFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},minWidth:{defaultValue:-1,type:"number",category:"Appearance"},slideStep:{defaultValue:200,type:"number",category:"Behavior"},pinnedList:{defaultValue:void 0,type:"array",category:"Behavior",advancedSetter:!0,recordFlag:!0},displayStyle:{defaultValue:"normal",type:"array",category:"Appearance"},value:{defaultValue:void 0,type:"array",category:"Behavior",recordFlag:!0},multiSelFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},reorderFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},showComboBoxFlag:{defaultValue:!1,type:"boolean",category:"Appearance"},autoCloseFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},allowUnsafeHTMLOnTabButton:{defaultValue:void 0,type:"boolean",category:"Behavior"}},buttonGroup:null,newTabButton:null,newTabComboBox:null,showPreviousButton:null,showNextButton:null,slide:0,pinnedListIsBeingUpdated:!1,buildView:function(){this.modelEvent=new s,this.elements.container.addClassName("wux-controls-tabBar"),this._history=new u,this.elements.buttonsContainer=new e.createElement("div",{class:"wux-controls-tabBar-buttonsContainer"}).inject(this.elements.container),this.elements.tabBar=new e.createElement("div",{class:"wux-controls-tabBar-tabs"}).inject(this.elements.container),this.elements.containerAddandNextButton=new e.Element("div",{class:"wux-controls-tabBar-buttonsContainer-addandnext"}).inject(this.elements.buttonsContainer),this.elements.buttonGroupContainer=new e.Element("div",{class:"wux-controls-tabBar-tabs-container"}).inject(this.elements.tabBar),this.buttonGroup=new i,this.buttonGroup.inject(this.elements.buttonGroupContainer),this.buttonGroup.getContent().setAttribute("role","presentation"),this._applyCenteredFlag(),this.newTabButton=new a({icon:"plus",value:"NewTab",allowUnsafeHTMLOnTabButton:this.allowUnsafeHTMLOnTabButton}),this.newTabButton.tooltipInfos=new d({shortHelp:m.addNewItem,allowUnsafeHTMLTitle:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLShortHelp:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLLongHelp:this.allowUnsafeHTMLOnTabButton}),-1!==this.displayStyle.indexOf("vertical")?this.newTabButton.getContent().inject(this.elements.buttonsContainer):this.newTabButton.inject(this.elements.tabBar),this.newTabButton.getContent().addClassName("wux-controls-tabBar-tabs-container-buttonNewTab"),this.newTabButtonFlag||this.newTabButton.getContent().hide(),this.buttonGroup.multiSelFlag=this.multiSelFlag,this.togglesTab={},this.valueSource=void 0,this.valueTarget=void 0},_postBuildView:function(){this.cptSelection=0,this.historySelection=[]},_handleEvents:function(){var t=this,i=!1,n=function(e){var i;i=e.dsModel instanceof a?e.dsModel:e.parentNode.dsModel,t._draggedOverButton!==i&&(t._draggedOverButton&&t._timeoutToActivateTabToken&&(clearTimeout(t._timeoutToActivateTabToken),t._timeoutToActivateTabToken=void 0),t._draggedOverButton=i,t._timeoutToActivateTabToken=setTimeout(function(){t.value=[t._draggedOverButton.value]},400))};o.addEventOnElement(this,this.buttonGroup.getContent(),"dragenter",function(e){console.log("dragenter"),n(e.target)}),o.addEventOnElement(this,this.buttonGroup.getContent(),"dragover",function(e){console.log("dragover"),n(e.target)}),o.addEventOnElement(this,this.buttonGroup.getContent(),"dragleave",function(e){console.log("dragleave"),clearTimeout(t._timeoutToActivateTabToken),t._timeoutToActivateTabToken=void 0,t._draggedOverButton=void 0}),this._onResizeFun=function(){!0===t._onNodeRenderedCalled&&(t._onNodeRenderedCalled=void 0,t._threshold||(t._threshold={}),t._updateThresholds()),t._slideToAvoidBlankSpace(),t.redrawTabBar()},o.addResizeListener(this.elements.container,this._onResizeFun,0),o.onNodeRendered(this.elements.container,function(){void 0!==t.elements.container&&-1!==t.displayStyle.indexOf("strip")&&(t.multiSelFlag&&t._applyMultiSelFlag(),t._postEditTouchMode(),t._threshold||(t._threshold={}),t._updateThresholds(),t._onNodeRenderedCalled=!0)}),o.addEventOnElement(this,this.newTabButton,"click",function(){D.call(t)}),o.addEventOnElement(this,this.buttonGroup,l.POINTERDOWN,function(e){if(i=!1,t.closeButtonFlag&&2===e.which){var n=e.target.parentNode;i=!!n.dsModel}return"close"===e.target.value&&(i=!0),i}),o.addEventOnElement(this,this.buttonGroup,l.POINTERUP,function(e){if(i){var n,s;if(i=!1,void 0===(n=e.target.dsModel instanceof a?e.target.dsModel:e.target.parentNode.dsModel))return;if(n&&(s=n.value),void 0!==s&&void 0===t.getButtonFromValue(s).elements._closeButton)return;t._closeListener(n),S(t),t.redrawTabBar()}});this.buttonGroup.addEventListener("change",function(e){if(!t._preventButtonGroupListener&&(e.stopPropagation(),!t.disabled)){t._endEditTab();var i=t.getButtonFromValue(e.dsModel.value);Array.isArray(i)||(i=[i]),t.setPropertyFromUIInteraction("value",t.buttonGroup.value);for(var n=0;n<i.length;n++){var s=(c=i[n])._index;if(-1!==s)if(c.checkFlag&&(void 0!==t.cptSelection&&(t.cptSelection++,t._setHistoryFromButton(c,t.cptSelection)),t.modelEvent.publish({event:"selectTab",data:{index:s,tabBar:t}})),-1!==t.displayStyle.indexOf("bullet")){var o=x(t.buttonGroup._getButtonList(),c);o&&(c.value!=t.value||c.checkFlag||(c.checkFlag=!0),o.checkFlag=c.checkFlag,o.show()),t._updateView(),b(t,0),this.showComboBoxFlag||(t.showPreviousButton&&(t.showPreviousButton.disabled=!0),t.showNextButton&&(t.showNextButton.disabled=!1))}else if(-1!==t.displayStyle.indexOf("normal")){var l=C(t.togglesTab,c);l&&(l.checkFlag=c.checkFlag),t._updateView()}else if(-1!==t.displayStyle.indexOf("panel")){var a=t.getIndexesByValues(t.value);a=a.sort();for(var r=0;r<a.length;r++){var h=t.getValueByIndex(a[r]);(void 0!==(c=t.getButtonFromValue(h))&&!Array.isArray(c)||Array.isArray(c)&&c.length>0)&&0===r&&c.getContent().setStyles({"border-bottom":"1px solid #f1f1f1"})}var u=t.buttonGroup._getButtonList();for(r=0;r<u.length;r++){var c=u[r];-1!==t.displayStyle.indexOf("panel")&&(c.checkFlag||c.getContent().setStyles({"border-bottom":"1px solid #b4b6ba"}))}}}t.closeButtonFlag?t._updateThresholds():t.redrawTabBar()}}),o.addEventOnElement(this,this.buttonGroup,"buttonclick",function(e){var i=e;if(e.stopPropagation(),i){for(;i&&!(i.dsModel instanceof a||i.dsModel instanceof r)&&e.parentElement;)i=e.parentElement;t.fire("tabButtonClick",{value:t.getValueByIndex(t.buttonGroup.getButtonIndex(i.dsModel))})}}),o.addEventOnElement(this,this.buttonGroup,"buttonDblClick",function(e){e.stopPropagation()}),o.addEventOnElement(this,this.buttonGroup,l.POINTERHIT,function(e){if(e.preventDefault(),2===e.multipleHitCount&&!t.disabled){for(var i=e.target;i&&(!i.dsModel||!(i.dsModel instanceof a));)i=i.getParent();if(i){var n=t.getButtonFromValue(i.dsModel.value);n instanceof r&&(n=x(t.buttonGroup._getButtonList(),n)),t.editableFlag?t._editTab(n.value):t.pinFlag&&t._pinTab(n.value,"buttonGroup_dblClick")}}}),o.addEventOnElement(this,document,l.POINTERUP,function(e){v&&null===v.getContent().getAttributeNode("focused")&&t._endEditTab()}),o.addEventOnElement(this,this.buttonGroup.getContent(),"mousewheel",function(i){t._hasOverflow()&&t.buttonGroup.getContent().hasAttribute("focused")&&(e.Event.wheelDelta(i)>0?t._slideTabBar("right"):t._slideTabBar("left"),i.stopPropagation(),i.preventDefault())})},_onDragPointerDown:function(e){if(!this.disabled){var t=this;if(e.dsModel){var i=this.getButtonFromValue(e.dsModel.value);i&&(this.valueSource=i.value)}o.addEventOnElement(this,document,l.POINTERMOVE,n),o.addEventOnElement(this,document,l.POINTERUP,function e(i){void 0!==t.valueSource&&t._onDragPointerUp(i),o.removeEventOnElement(t,document,l.POINTERMOVE,n),o.removeEventOnElement(t,document,l.POINTERUP,e)}),this.modelEvent.publish({event:"beginDragTab",data:{}})}function n(e){e.target.parentNode&&e.target.parentNode.dsModel===t.buttonGroup&&void 0!==t.valueSource&&t._onDragPointerMove(e)}},_onDragPointerMove:function(e){var t;this.disabled||0!==e.button||(e.preventDefault(),e.target&&e.target.dsModel?t=e.target.dsModel:void 0===e.target.dsModel&&e.target.parentElement&&(t=e.target.parentElement.dsModel),t&&t.value!==this.valueSource&&this.callMethodFromUIInteraction("_exchangeTabs",this.valueSource,t.value))},_exchangeTabs:function(e,t){this.value=[e];var i=this.getButtonFromValue(t),n=this.getButtonFromValue(e);if(i&&n&&void 0!==n.value&&void 0!==i.value&&n.value!==i.value){this.valueTarget=i.value;var s=i._index,o=n._index;this.buttonGroup.moveButton(o,s),i._index=o,n._index=s,this.modelEvent.publish({event:"endDragTab",data:{valueButtonDragged:e,valueButtonTarget:t,valueTab:this.value}}),this._changeButtonIndexInComboBox(n,n._index),this._changeButtonIndexInComboBox(i,i._index),S(this),this._updateThresholds([i,n]),this.fire("beginReorder",{value:n.value})}},_onDragPointerUp:function(e){void 0!==this.valueTarget&&(this.valueSource=void 0,this.valueTarget=void 0,this.redrawTabBar(),this.fire("endReorder"))},_applyShowComboBoxFlag:function(e){var t=this;this.showComboBoxFlag?(this.tabComboBox=new h({elementsTree:this._history,mainElementVisibleFlag:!1,enableSearchFlag:!1,multiSelFlag:this.multiSelFlag,showToggleColumnForMultiSelFlag:!1,displayStyle:-1!==this.displayStyle.indexOf("strip")?"lite":"normal"}).inject(this.elements.buttonsContainer,"before"),this.tabComboBox._updatePopupHeight=function(){if(t.tabComboBox.elements.treeListViewContainer){var e=t.tabComboBox.nbDisplayedElements,i=(t.tabComboBox._getCurrentTouchMode()?38:22)*e+(t.newTabButtonFlag?33:0)+"px";if(t.tabComboBox.elements.treeListViewContainer.style.height!==i){var n=t.tabComboBox._isPopupOpened();t.tabComboBox.elements.popup.visibleFlag=!1,t.tabComboBox.elements.treeListViewContainer.style.height=i,t.tabComboBox.elements.popup.visibleFlag=n,t.tabComboBox.elements.treeListView&&t.tabComboBox.elements.treeListView.updateHeight(i)}}},this.tabComboBox.tooltipInfos=new d({shortHelp:m.listAllItems,allowUnsafeHTMLTitle:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLShortHelp:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLLongHelp:this.allowUnsafeHTMLOnTabButton}),this.tabComboBox.getContent().addClassName("wux-controls-tabBar-combobox"),this.tabComboBox.addEventListener("change",this._comboCB.bind(this)),this._updateComboBox(),this.showPreviousButton&&(this.showPreviousButton.destroy(),this.showPreviousButton=null),this.showNextButton&&(this.showNextButton.destroy(),this.showNextButton=null)):(this.tabComboBox&&(this.tabComboBox.removeEventListener("change",this._comboCB.bind(this)),this.tabComboBox.getContent().hide(),this.tabComboBox.destroy(),this.tabComboBox=null),this._createButtonsNextAndPrevious()),-1!==this.displayStyle.indexOf("panel")&&this.tabComboBox&&this.tabComboBox.getContent().addClassName("wux-controls-tabbar-panel"),this.redrawTabBar()},_applyCenteredFlag:function(){this.centeredFlag?(this.elements.buttonGroupContainer.addClassName("wux-controls-tabBar-centered"),this.elements.tabBar.addClassName("wux-controls-tabBar-centered"),this.elements.container.addClassName("wux-controls-tabBar-centered")):(this.elements.buttonGroupContainer.removeClassName("wux-controls-tabBar-centered"),this.elements.tabBar.removeClassName("wux-controls-tabBar-centered"),this.elements.container.removeClassName("wux-controls-tabBar-centered"))},_applyReorderFlag:function(){var e=this;function t(t){e.disabled||e._onDragPointerDown(t)}this.reorderFlag?o.addEventOnElement(this,this.elements.container,l.POINTERDOWN,t):o.removeEventOnElement(this,this.elements.container,l.POINTERDOWN,t)},_applyMultiSelFlag:function(){for(var e in this.buttonGroup.multiSelFlag=this.multiSelFlag,this.togglesTab)this.togglesTab.hasOwnProperty(e)&&(this.togglesTab[e].multiSelFlag=this.multiSelFlag);if(!this.multiSelFlag&&this.value&&this.value.length>0){var t=this._getMaxHistory();this.value=void 0!==t?[t]:[]}else this.buttonGroup._applyValue();this.tabComboBox&&this.multiSelFlag&&(this.tabComboBox.multiSelFlag=this.multiSelFlag)},_preEditPinnedList:function(e,t){if(!this.pinnedListIsBeingUpdated){this.pinnedListIsBeingUpdated=!0,void 0===this.pinnedList&&(this.pinnedList=[]),void 0===e&&(e=[]);for(var i=A.call(this,t,e),n=A.call(this,e,t),s=0;s<i.length;s++)this.pinTab(i[s]);for(var o=0;o<n.length;o++)this.pinTab(n[o]);this.pinnedListIsBeingUpdated=!1}},_applyPinFlag:function(e){this.pinFlag||(this.pinnedList=[])},_applyProperties:function(e){this.slide=0,this.isDirty("centeredFlag")&&this._applyCenteredFlag(e.centeredFlag),this.isDirty("showComboBoxFlag")&&this._applyShowComboBoxFlag(e.showComboBoxFlag),this.isDirty("reorderFlag")&&this._applyReorderFlag(e.reorderFlag),this.isDirty("recId")&&this._applyRecId(e.recId)},_applyCloseButtonFlag:function(){for(var e=0;e<this.buttonGroup.getButtonCount();e++)this.setAllowClosableFlagOnValue(this.getValueByIndex(e),this.closeButtonFlag);this.showComboBoxFlag&&this._updateComboBox()},_applyCloseAllButtonFlag:function(){for(var e=0;e<this.buttonGroup.getButtonCount();e++)this.setAllowClosableFlagOnValue(this.getValueByIndex(e),this.closeAllButtonFlag);this.showComboBoxFlag&&this._updateComboBox()},_applyDisabled:function(){this.buttonGroup.disabled=this.disabled,this.showComboBoxFlag&&-1===this.displayStyle.indexOf("strip")?this.tabComboBox&&(this.tabComboBox.disabled=this.disabled):(this.showPreviousButton&&(this.showPreviousButton.disabled=this.disabled),this.showNextButton&&(this.showNextButton.disabled=this.disabled)),this.newTabButton&&(this.newTabButton.disabled=this.disabled)},_applyNewTabButtonFlag:function(){-1!==this.displayStyle.indexOf("strip")&&this.showComboBoxFlag&&F.call(this),this.newTabButtonFlag?this.tabComboBox&&this.tabComboBox.visibleFlag?this.newTabButton.getContent().hide():(this.newTabButton.getContent().show(),this.newTabButton.getContent().style.marginLeft=-1!==this.displayStyle.indexOf("strip")?"0px":-this.buttonGroup.getContent().offsetLeft+"px"):this.newTabButton.getContent().hide()},_applyTouchMode:function(){this._postEditTouchMode(),this._updateThresholds()},_postEditTouchMode:function(){var e=this._getCurrentTouchMode();this._parent(),!0===e?(this.elements.container.setAttributeNode(document.createAttribute("touch-mode")),this.elements.tabBar.setAttributeNode(document.createAttribute("touch-mode")),this.elements.buttonGroupContainer.setAttributeNode(document.createAttribute("touch-mode"))):(this.elements.container.removeAttribute("touch-mode"),this.elements.tabBar.removeAttribute("touch-mode"),this.elements.buttonGroupContainer.removeAttribute("touch-mode")),this.buttonGroup.touchMode=e,this.tabComboBox&&(this.tabComboBox.touchMode=e),this.showNextButton&&(this.showNextButton.touchMode=e),this.newTabButton&&(this.newTabButton.touchMode=e),this.showPreviousButton&&(this.showPreviousButton.touchMode=e)},_applyMinWidth:function(){-1!==this.minWidth?this.elements.container.setStyles({width:this.minWidth+"px"}):this.elements.container.setStyles({width:""}),b(this,0),this.showComboBoxFlag||(this.showPreviousButton.disabled=!0,this.showNextButton.disabled=!1),this.redrawTabBar()},_closeListener:function(e){if(this.modelEvent.publish({event:"removeTab",data:{index:e._index,value:e.value,tabBar:this}}),this.fire("removeTab",{index:e._index,value:e.value,tabBar:this}),this.autoCloseFlag){this.pinFlag&&this.pinnedList&&this.pinnedList.length>0&&-1!==this.pinnedList.indexOf(e.value)&&this._removePinnedButton(e.value),this.showComboBoxFlag&&this._removeValueComboBox(e.value),this.removeTab(e.value),e.remove(),this._removeHistoryFromButton(e.value);for(var t=this.buttonGroup._getButtonList(),i=t.length-1;i>=0;i--){(e=t[i])instanceof r&&e.checkFlag&&e.remove()}var n=this._getMaxHistory();void 0!==n?this.setPropertyFromUIInteraction("value",[n]):this.setPropertyFromUIInteraction("value",[])}},_searchItemInContextualMenu:function(e,t){var i=!1;return void 0!==e&&e.forEach(function(e){e.title===t&&(i=!0)}),i},_createCloseButtonFlag:function(t){var i=this;if(-1!==this.displayStyle.indexOf("strip")){(i.closeButtonFlag||i.closeAllButtonFlag)&&(t.elements._closeButton=new e.Element("div",{class:"wux-controls-tabBar-close wux-ui-3ds wux-ui-3ds-chevron-down"}));var n=(s=t.getContent().lastChild)?s.nextSibling:null;(i.closeButtonFlag||i.closeAllButtonFlag)&&(t.getContent().insertBefore(t.elements._closeButton,n),t.elements._closeButton.addClassName("button-close-unvisible")),o.addEventOnElement(i,t.elements._closeButton,"click",function(e){var t=this,n=[];i.closeButtonFlag&&!i._searchItemInContextualMenu(n,m.close)&&n.push({type:"PushItem",title:m.close,action:{callback:function(){i._closeListener(t.parentNode.dsModel)}}}),i.closeAllButtonFlag&&!i._searchItemInContextualMenu(n,m.closeAllTabs)&&n.push({type:"PushItem",title:m.closeAllTabs,action:{callback:function(){for(var e=i.buttonGroup.elements.container.childNodes.length,t=0,n=0;t<e;t++)i.buttonGroup.elements.container.childNodes[n].dsModel.elements._closeButton?i._closeListener(i.buttonGroup.elements.container.childNodes[n].dsModel):n++}}}),i.editableFlag&&!i._searchItemInContextualMenu(n,m.rename)&&n.push({type:"PushItem",title:m.rename,action:{callback:function(){i._editTab(t.parentNode.dsModel.value)}}}),i.modelEvent.publish({event:"contextualMenu",data:{menu:n,index:t.parentNode.dsModel._index,value:t.parentNode.dsModel.value}});var s=this.parentNode.getBoundingClientRect(),o=26;!0===t.parentNode.dsModel.touchMode&&(o=44),0!==n.length&&g.show(n,{position:{x:s.left+s.width-o,y:s.top+s.height}},{onShow:()=>{t.setAttributeNode(document.createAttribute("is-displaying-menu"))},onHide:()=>{t.removeAttribute("is-displaying-menu")}})})}else if(-1===this.displayStyle.indexOf("bullet")&&!t.elements._closeButton||t.elements._closeButton&&t.getContent().lastChild!==t.elements._closeButton){t.elements._closeButton=new e.Element("button",{type:"button",class:"wux-controls-tabBar-close wux-ui-3ds wux-ui-3ds-wrong"});var s;n=(s=t.getContent().lastChild)?s.nextSibling:null;t.getContent().insertBefore(t.elements._closeButton,n),t.elements._closeButton.value="close"}t.getContent().addClassName("wux-controls-tabbar-closebutton")},_updateView:function(){for(var e=this.buttonGroup._getButtonList(),t=0;t<e.length;t++){var i;if(e[t]instanceof a)(i=-1!==this.displayStyle.indexOf("bullet")?C(this.buttonGroup._getButtonList(),e[t]):C(this.togglesTab,e[t]))&&-1!==this.displayStyle.indexOf("bullet")&&(e[t].visibleFlag=i.checkFlag,i.checkFlag=e[t].checkFlag);else if(e[t]instanceof r&&(e[t].show(),e[t].elements.checkSign.hasClassName(e[t]._toggleIcon)&&e[t].elements.checkSign.removeClassName(e[t]._toggleIcon),this.buttonGroup.value.length<=0&&e[0]&&(e[0].checkFlag=!0),e[t])){var n=x(e,e[t]);n&&n instanceof a&&(n.visibleFlag=e[t].checkFlag,n.checkFlag=e[t].checkFlag)}this.pinnedList&&-1!==this.pinnedList.indexOf(e[t].value)&&e[t].show()}if(-1!==this.displayStyle.indexOf("normal"))for(var s=0;s<e.length;s++)e[s].show();this.redrawTabBar()},_applyDisplayStyle:function(e){var t=this.value?this.value.slice():[];-1!==this.displayStyle.indexOf("bullet")&&(this.touchMode&&(this.touchMode=!1),this.closeButtonFlag&&(this.closeButtonFlag=!1),this.closeAllButtonFlag&&(this.closeAllButtonFlag=!1));for(var i=this.buttonGroup._getButtonList(),n=0;n<i.length;n++){var s=i[n].getContent();-1!==this.displayStyle.indexOf("normal")&&(s.removeClassName("wux-controls-toggle-selectbutton"),s.removeClassName("wux-controls-toggle-pinnedbutton"))}for(var o in this.togglesTab)-1!==this.displayStyle.indexOf("normal")?this.buttonGroup.removeChild(this.togglesTab[o]):-1!==this.displayStyle.indexOf("bullet")&&this.buttonGroup.addChild(this.togglesTab[o]);if(-1===this.displayStyle.indexOf("wide")?this.getContent().removeClassName("wux-controls-tabbar-display-wide"):this.getContent().addClassName("wux-controls-tabbar-display-wide"),-1!==this.displayStyle.indexOf("vertical")){this.elements.buttonsContainer.addClassName("wux-controls-tabbar-vertical"),this.elements.tabBar.addClassName("wux-controls-tabbar-vertical"),this.elements.buttonGroupContainer.addClassName("wux-controls-tabbar-vertical");for(i=this.buttonGroup._getButtonList(),n=0;n<i.length;n++){(s=i[n].getContent()).addClassName("wux-controls-tabbar-vertical"),s.tooltipInfos=new d({shortHelp:i[n].label,allowUnsafeHTMLTitle:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLShortHelp:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLLongHelp:this.allowUnsafeHTMLOnTabButton}),-1!==this.displayStyle.indexOf("strip")&&(i[n].showLabelFlag=!1)}this.showComboBoxFlag&&(this.tabComboBox.remove(),this.tabComboBox.inject(this.elements.container)),this.elements.buttonGroupContainer.removeClassName("wux-controls-tabbar-panel"),this.elements.tabBar.addClassName("wux-controls-tabbar-panel"),this.buttonGroup.getContent().removeClassName("wux-controls-tabbar-panel"),this.elements.tabBar.removeClassName("wux-controls-tabbar-panel"),-1!==this.displayStyle.indexOf("strip")?this.elements.container.addClassName("wux-controls-tabbar-vertical"):this.elements.container.removeClassName("wux-controls-tabbar-vertical")}else if(-1!==this.displayStyle.indexOf("panel")){for(i=this.buttonGroup._getButtonList(),n=0;n<i.length;n++){(s=i[n].getContent()).addClassName("wux-controls-tabbar-panel")}this.buttonGroup.getContent().addClassName("wux-controls-tabbar-panel"),this.elements.buttonGroupContainer.addClassName("wux-controls-tabbar-panel"),this.elements.tabBar.addClassName("wux-controls-tabbar-panel")}else{this.elements.buttonsContainer.removeClassName("wux-controls-tabbar-vertical"),this.elements.tabBar.removeClassName("wux-controls-tabbar-vertical"),this.elements.buttonGroupContainer.removeClassName("wux-controls-tabbar-vertical");for(i=this.buttonGroup._getButtonList(),n=0;n<i.length;n++){(s=i[n].getContent()).tooltipInfos=null,s.removeClassName("wux-controls-tabbar-vertical"),s.removeClassName("wux-controls-tabbar-panel")}this.elements.buttonGroupContainer.removeClassName("wux-controls-tabbar-panel"),this.elements.tabBar.addClassName("wux-controls-tabbar-panel"),this.buttonGroup.getContent().removeClassName("wux-controls-tabbar-panel"),this.elements.tabBar.removeClassName("wux-controls-tabbar-panel"),this.tabComboBox&&this.showComboBoxFlag&&(this.tabComboBox.remove(),this.tabComboBox.inject(this.elements.tabBar,"before"))}-1!==this.displayStyle.indexOf("strip")?(this.pinFlag=!1,I.call(this),this._addTooltips(),this.menuContextual=[]):!e||-1===e.indexOf("strip")&&"strip"!==e||V.call(this),this._updateView(),b(this,0),this.tabComboBox&&(-1!==this.displayStyle.indexOf("panel")?this.tabComboBox.getContent().addClassName("wux-controls-tabbar-panel"):this.tabComboBox.getContent().removeClassName("wux-controls-tabbar-panel")),this.value=t},_addPinnedButton:function(e){this.pinnedList||this.setPropertyFromUIInteraction("pinnedList",[]),-1===this.pinnedList.indexOf(e)&&this.modifyArrayFromUIInteraction("pinnedList",Array.prototype.push,e);var t=this.getButtonFromValue(e);-1!==this.displayStyle.indexOf("bullet")&&t.show(),t.getContent().setAttributeNode(document.createAttribute("pinned"));var i=C(this.togglesTab,t);return i&&i.getContent().setAttributeNode(document.createAttribute("pinned")),this.pinnedList},_removePinnedButton:function(e){var t=this.getButtonFromValue(e);t&&t.getContent().getAttributeNode("pinned")?t.getContent().removeAttributeNode(t.getContent().getAttributeNode("pinned")):console.log("Ohoh ... This tab should have been pinned ...");var i=C(this.togglesTab,t);i&&i.getContent().removeAttributeNode(i.getContent().getAttributeNode("pinned"));for(var n=0;n<this.pinnedList.length;n++)this.pinnedList[n]===e&&this.modifyArrayFromUIInteraction("pinnedList",Array.prototype.splice,n,1);return this.pinnedList},_getMaxHistory:function(){var e,t=0;if(!(this.historySelection[0]&&this.getButtonFromValue(this.historySelection[0].value)&&this.getButtonFromValue(this.historySelection[0].value).visibleFlag))for(var i=0;i<this.buttonGroup.getButtonCount();i++)this.getButtonFromValue(this.getValueByIndex(i)).visibleFlag&&(e=this.getValueByIndex(i));for(var n in this.historySelection){var s=this.getButtonFromValue(this.historySelection[n].value);void 0!==this.historySelection[n].cpt&&t<=this.historySelection[n].cpt&&s&&s.visibleFlag&&(e=this.historySelection[n].value,t=this.historySelection[n].cpt)}return e},_setHistoryFromButton:function(e,t){for(var i in this.historySelection)if(void 0!==this.historySelection[i].value&&this.historySelection[i].value===e.value)return void(this.historySelection[i].cpt=t)},_removeHistoryFromButton:function(e){for(var t in this.historySelection)if(void 0!==this.historySelection[t].value&&this.historySelection[t].value===e)return void this.historySelection.splice(t,1)},_indexesFromValues:function(e){var t=[];if(null!=e)for(var i=this.buttonGroup._getButtonList(),n=0;n<e.length;n++)for(var s=0;s<i.length;s++){var o=i[s];o.value===e[n]&&o instanceof a&&t.push(o._index)}return t},_updateThresholds:function(e){var t=this;if(t._threshold){var i=0,n=t.buttonGroup._getButtonList(),s=[];e?e.forEach(function(e){s.push(t.buttonGroup.getButtonIndex(e))}):s=Array.apply(null,{length:n.length}).map(Number.call,Number);var o=[];s.forEach(function(e){Number.isInteger(e)&&n[e]&&(o[e]=n[e].showLabelFlag,n[e].showLabelFlag=!0)}),s.forEach(function(e){Number.isInteger(e)&&n[e]&&(n[e].visibleFlag?(i=t.getWidthOfButton(n[e]),Number(i)?n[e]._iconLabelWidth=i:n[e]._iconLabelWidth=0):n[e]._iconLabelWidth=0)}),s.forEach(function(e){Number.isInteger(e)&&n[e]&&(void 0!==n[e].icon?n[e].showLabelFlag=!1:n[e].showLabelFlag=!0)}),s.forEach(function(e){Number.isInteger(e)&&n[e]&&(n[e].visibleFlag?(i=t.getWidthOfButton(n[e]),Number(i)?n[e]._iconWidth=i:n[e]._iconWidth=0):n[e]._iconWidth=0)}),s.forEach(function(e){Number.isInteger(e)&&n[e]&&(n[e].showLabelFlag=o[e])}),t._threshold._iconAndLabelSize=0;for(var l=0;l<n.length;l++)t._threshold._iconAndLabelSize+=n[l]._iconLabelWidth;t._threshold._iconAndLabelSelectedSize=0;for(l=0;l<n.length;l++)n[l].checkFlag||void 0===n[l].icon?t._threshold._iconAndLabelSelectedSize+=n[l]._iconLabelWidth:t._threshold._iconAndLabelSelectedSize+=n[l]._iconWidth;t._threshold._iconOnlySize=0;for(l=0;l<n.length;l++)t._threshold._iconOnlySize+=n[l]._iconWidth;t.redrawTabBar()}},_hasOverflow:function(){var e=this,t=0,i=!1;if(-1===this.displayStyle.indexOf("strip")){var n=0;e.showComboBoxFlag&&e.tabComboBox&&e.tabComboBox.getContent()&&(n=e.tabComboBox.getContent().getBoundingClientRect().width);var s=0;e.newTabButtonFlag&&e.newTabButton&&e.newTabButton.getContent()&&(s=e.newTabButton.getContent().getBoundingClientRect().width);var o=e.buttonGroup.getContent().getBoundingClientRect().width+n+s;if(0!==(c=e.elements.container.getBoundingClientRect().width))if(e.showComboBoxFlag||e.newTabButtonFlag){var l=0;e._applyInheritWidthToButtons();var a=e.buttonGroup._getButtonList();for(t=0;t<a.length;t++){if((h=a[t]).visibleFlag)l+=e.getWidthOfButton(h)}if(l+s>c+1){var r=100/e.getVisibleTabCount()+"%";for(a=e.buttonGroup._getButtonList(),t=0;t<a.length;t++){var h;(h=a[t]).visibleFlag&&(h.getContent().style.width=r)}return e.getContent().setAttributeNode(document.createAttribute("overflow")),e.centeredFlag||(e.elements.buttonGroupContainer.removeClassName("wux-controls-tabBar-centered"),e.elements.tabBar.removeClassName("wux-controls-tabBar-centered"),e.elements.container.removeClassName("wux-controls-tabBar-centered")),!0}e._applyInheritWidthToButtons()}else if(o>c){var u;if(e.getContent().setAttributeNode(document.createAttribute("overflow")),-1!==this.displayStyle.indexOf("panel")&&!this.showComboBoxFlag)u=!0===this.touchMode?"38px":"22px",this.elements.tabBar.style.marginLeft=u;return!0}this.getContent().removeAttribute("overflow"),-1===this.displayStyle.indexOf("panel")||this.showComboBoxFlag||(this.elements.tabBar.style.marginLeft="0px")}else{a=e.buttonGroup._getButtonList();for(t=0;t<a.length;t++)void 0!==a[t].icon?a[t].showLabelFlag=!1:a[t].showLabelFlag=!0;var c=e.elements.container.getBoundingClientRect().width;if(e._threshold&&0!==c){s=0;var d=0;e.newTabButtonFlag&&e.newTabButton&&e.newTabButton.getContent()&&(s=e.newTabButton.getContent().getBoundingClientRect().width),e.showComboBoxFlag&&e.tabComboBox&&e.tabComboBox.getContent()&&(d=e.tabComboBox.getContent().getBoundingClientRect().width),e._threshold._iconAndLabelSelectedSize=0;for(t=0;t<a.length;t++)a[t].checkFlag||void 0===a[t].icon?e._threshold._iconAndLabelSelectedSize+=a[t]._iconLabelWidth:e._threshold._iconAndLabelSelectedSize+=a[t]._iconWidth;if(e._threshold._iconAndLabelSize+s+d<=c){for(t=0;t<a.length;t++)a[t].showLabelFlag=!0;this.getContent().removeAttribute("overflow")}else if(e._threshold._iconAndLabelSelectedSize+s+d<=c){for(t=0;t<a.length;t++)a[t].checkFlag||void 0===a[t].icon?a[t].showLabelFlag=!0:a[t].showLabelFlag=!1;this.getContent().removeAttribute("overflow")}else{for(t=0;t<a.length;t++)void 0!==a[t].icon?a[t].showLabelFlag=!1:a[t].showLabelFlag=!0;e._threshold._iconOnlySize+s+d<=c?this.getContent().removeAttribute("overflow"):(e.getContent().setAttributeNode(document.createAttribute("overflow")),i=!0)}}}return i&&this.centeredFlag&&this.showComboBoxFlag&&(this.elements.buttonGroupContainer.addClassName("wux-controls-tabBar-centered"),this.elements.tabBar.addClassName("wux-controls-tabBar-centered"),this.elements.container.addClassName("wux-controls-tabBar-centered")),i},_createButtonsNextAndPrevious:function(){var e=this;this.showPreviousButton||(this.showPreviousButton=new a({icon:-1!==this.displayStyle.indexOf("strip")?{iconName:"open-left",fontIconFamily:1}:"PreviousImage",allowUnsafeHTMLLabel:this.allowUnsafeHTMLOnTabButton}),this.showPreviousButton.tooltipInfos=new d({shortHelp:m.previousItems,allowUnsafeHTMLTitle:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLShortHelp:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLLongHelp:this.allowUnsafeHTMLOnTabButton}),-1!==this.displayStyle.indexOf("strip")&&this.showPreviousButton.getContent().addClassName("wux-controls-tabbar-strip"),this.showPreviousButton.getContent().inject(this.elements.buttonsContainer),this.showPreviousButton.getContent().addClassName("wux-controls-tabBar-tabs-container-buttonPrevious"),o.addEventOnElement(this,this.showPreviousButton,"click",function(){e._slideTabBar("left")})),this.showNextButton||(this.showNextButton=new a({icon:-1!==this.displayStyle.indexOf("strip")?{iconName:"open-right",fontIconFamily:1}:"NextImage",allowUnsafeHTMLLabel:this.allowUnsafeHTMLOnTabButton}),this.showNextButton.tooltipInfos=new d({shortHelp:m.nextItems,allowUnsafeHTMLTitle:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLShortHelp:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLLongHelp:this.allowUnsafeHTMLOnTabButton}),-1!==this.displayStyle.indexOf("strip")&&this.showNextButton.getContent().addClassName("wux-controls-tabbar-strip"),this.showNextButton.getContent().inject(this.elements.containerAddandNextButton),this.showNextButton.getContent().addClassName("wux-controls-tabBar-tabs-container-buttonNext"),o.addEventOnElement(this,this.showNextButton,"click",function(){e._slideTabBar("right")})),this._showButtonsNextAndPrevious()},_showButtonsNextAndPrevious:function(){if(this.showPreviousButton.visibleFlag||-1!==this.displayStyle.indexOf("strip")||this._slideTabBar("left"),this.newTabButton&&-1===this.displayStyle.indexOf("vertical")&&this.newTabButton.getContent().inject(this.elements.containerAddandNextButton),!this.showPreviousButton.visibleFlag||!this.showNextButton.visibleFlag){this.showPreviousButton.visibleFlag=!0,this.showNextButton.visibleFlag=!0,-1!==this.displayStyle.indexOf("immersif")?(this.showPreviousButton.elements.icon.addClassName("wux-controls-showprevious-immersif"),this.showNextButton.elements.icon.addClassName("wux-controls-shownext-immersif"),this.showPreviousButton.getContent().addClassName("wux-controls-showprevious-immersif"),this.showNextButton.getContent().addClassName("wux-controls-shownext-immersif"),this.elements.buttonGroupContainer.addClassName("wux-controls-buttonGroup-immersif")):(this.showPreviousButton.elements.icon.removeClassName("wux-controls-showprevious-immersif"),this.showNextButton.elements.icon.removeClassName("wux-controls-shownext-immersif"),this.showPreviousButton.getContent().removeClassName("wux-controls-showprevious-immersif"),this.showNextButton.getContent().removeClassName("wux-controls-shownext-immersif"),this.elements.buttonGroupContainer.removeClassName("wux-controls-buttonGroup-immersif"));for(var e=this.buttonGroup._getButtonList(),t=0;t<e.length;t++){!0===(s=e[t]).visibleFlag&&-1!==this.displayStyle.indexOf("immersif")?s.getContent().addClassName("wux-controls-button-show-firstbutton"):t===e.length-1&&-1!==this.displayStyle.indexOf("bullet")&&e[e.length-1].getContent().addClassName("wux-controls-button-show-lastbutton")}for(var i=!1,n=e.length-1;n>=0;n--){var s=e[n];i||!0!==s.visibleFlag||(-1!==this.displayStyle.indexOf("immersif")&&(s.getContent().addClassName("wux-controls-button-show-lastbutton"),s.getContent().removeClassName("wux-controls-button-show-firstbutton")),i=!0)}}var o=this.buttonGroup.getContent().scrollWidth,l=this.elements.tabBar.getBoundingClientRect().width-o;this.slide>0&&(this.slide=0),this.slide<l&&(this.slide=l),this._manageButtonsVisibility(l),S(this)},_hideButtonsNextAndPrevious:function(){this.showPreviousButton&&this.showNextButton&&(this.newTabButton&&-1===this.displayStyle.indexOf("vertical")&&this.newTabButton.inject(this.elements.tabBar),this.showPreviousButton.visibleFlag?(this.showPreviousButton.visibleFlag=!1,this.showNextButton.visibleFlag=!1,-1===this.displayStyle.indexOf("strip")&&this._slideTabBar("left")):(this.showPreviousButton.visibleFlag=!1,this.showNextButton.visibleFlag=!1),S(this))},_manageButtonsVisibility:function(e){if(this.showPreviousButton&&this.showNextButton){var t=!1;if(0===e&&(t=!0),-1!==this.displayStyle.indexOf("strip")){var i=this.touchMode?54:36,n=0;if(this.value&&this.value.length>0){var s=this.getButtonFromValue(this.value[0]);s&&(n=void 0!==s.icon?s._iconWidth:s._iconLabelWidth)}n=n>i?n:i,this.elements.tabBar.getSize().width<n&&(t=!0)}t?this._hideButtonsNextAndPrevious():(this.showPreviousButton.visibleFlag=!0,this.showNextButton.visibleFlag=!0,0===this.slide?(this.showPreviousButton.disabled=!0,this.showNextButton.disabled=!1):this.slide===e?(this.showPreviousButton.disabled=!1,this.showNextButton.disabled=!0):(this.showPreviousButton.disabled=!1,this.showNextButton.disabled=!1))}else 0===this.slide?this._maxSlide="left":this.slide===e?this._maxSlide="right":this._maxSlide=""},_slideTabBar:function(e){if(!("left"===e&&(this.showPreviousButton&&this.showPreviousButton.disabled||"left"===this._maxSlide)||"right"===e&&(this.showNextButton&&this.showNextButton.disabled||"right"===this._maxSlide))){var t,i=this.buttonGroup.getContent().scrollWidth,n=this.elements.tabBar.getBoundingClientRect().width,s=n-i;s=s>0?0:s,this.slide>0&&(this.slide=0),this.slide<s&&(this.slide=s);var o=Math.min(this.slideStep,n);"right"===e?(t=this.slide-o,this.slide=t>s?t:s):"left"===e&&(t=this.slide+o,this.slide=t<=0?t:0),b(this,this.slide),this._manageButtonsVisibility(s)}},_slideToAvoidBlankSpace:function(){if(-1!==this.displayStyle.indexOf("strip")){var e=this.buttonGroup.getContent().scrollWidth,t=this.elements.tabBar.clientWidth;this.slide=t-e,b(this,this.slide),this._slideToValue()}},_applyValue:function(t){if(void 0!==this.value){if(e.equals(t,this.value))return;this.buttonGroup.value=this.value,this.tabComboBox&&this.showComboBoxFlag&&(this.tabComboBox.value=this.tabComboBox.multiSelFlag?this.value:this.value[0]);var i=this.getButtonFromValue(this.value[0]);if(-1!==this.displayStyle.indexOf("strip")&&(i&&i.elements._closeButton&&(i.elements._closeButton.removeClassName("button-close-unvisible"),i.getContent().addClassName("remove-padding-class")),t)){var n=this.getButtonFromValue(t[0]);n&&n.elements&&n.elements._closeButton&&(n.elements._closeButton.addClassName("button-close-unvisible"),n.getContent().removeClassName("remove-padding-class"))}this._slideToValue(),-1!==this.displayStyle.indexOf("bullet")?this._updateView():this.redrawTabBar(),this.fire("change")}},_slideToValue:function(){if(this.value&&this.value.length>0){var e=this.getButtonFromValue(this.value[0]);if(e){var t=this.buttonGroup.getContent().scrollWidth,i=this.elements.tabBar.getBoundingClientRect().width,n=i-t,s=e.getContent().getPosition(this.buttonGroup.getContent()).x,o=s+e.getContent().getDimensions().outerWidth,l=this.elements.tabBar.getBoundingClientRect().left-this.buttonGroup.getContent().getBoundingClientRect().left;if(l>=0&&s>=0&&l>=s)this.slide=-s;else{if(!(i+l<=o))return;this.slide=Math.floor(i-o)}this.slide<n&&(this.slide=n),this.slide>0&&(this.slide=0),b(this,this.slide)}}},_comboCB:function(e){if(e.stopPropagation(),this.showComboBoxFlag){var t=!1;if(!1===this.tabComboBox.multiSelFlag)t=this.value[0]!==this.tabComboBox.currentValue;else for(var i=0;i<this.tabComboBox.currentValue.length;i++)if(-1===this.value.indexOf(this.tabComboBox.currentValue[i])){t=!0;break}if(t){var n=this.tabComboBox.multiSelFlag?this.tabComboBox.currentValue:[this.tabComboBox.currentValue];this.setPropertyFromUIInteraction("value",n)}}},_removeValueComboBox:function(e){for(var t=0;t<this._history.getRoots().length;t++)this._history.getRoots()[t].options.grid.valueItem===e&&this._history.removeRoot(this._history.getRoots()[t]);this.tabComboBox.elementsTree=this._history},_removeTooltips:function(){for(var e=this.buttonGroup._getButtonList(),t=0;t<e.length;t++)e[t].tooltipInfos=void 0},_addTooltips:function(){for(var e=this.buttonGroup._getButtonList(),t=0;t<e.length;t++)e[t].tooltipInfos||(e[t].tooltipInfos=new d({shortHelp:e[t].label,allowUnsafeHTMLTitle:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLShortHelp:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLLongHelp:this.allowUnsafeHTMLOnTabButton}))},_updateComboBox:function(e){for(var t=this.buttonGroup._getButtonList(),i=0;i<t.length;i++)if(t[i].visibleFlag){for(var n=new c({label:t[i].label,index:t[i]._index,grid:{valueItem:t[i].value},icons:t[i].icon?[{iconName:t[i].icon instanceof Object?t[i].icon.iconName:t[i].icon}]:""}),s=!1,o=0;o<this._history.getRoots().length;o++)if(this._history.getRoots()[o].options.grid.valueItem===n.options.grid.valueItem||void 0!==e&&e===this._history.getRoots()[o].options.index){s=!0,this._history.getRoots()[o].options.label=n.options.label,this._history.getRoots()[o].options.icons=n.options.icons,this._history.getRoots()[o].options.grid.valueItem=n.options.grid.valueItem;break}s||this._history.addRoot(n,t[i]._index)}this.tabComboBox.elementsTree=this._history},_changeButtonIndexInComboBox:function(e,t){for(var i,n=new c({label:e.label,grid:{valueItem:e.value}}),s=0;s<this._history.getRoots().length;s++)if(this._history.getRoots()[s].options.grid.valueItem===n.options.grid.valueItem){i=this._history.getRoots()[s];break}i&&this._history.removeRoot(i),this._history.addRoot(n,t)},getButtonFromValue:function(e){var t,i=this.buttonGroup._getButtonList();if(i){if(Array.isArray(e)){for(var n=[],s=0;s<i.length;s++){t=i[s];for(var o=0;o<e.length;o++)e[o]===t.value&&t instanceof a&&-1===this.displayStyle.indexOf("bullet")?n.push(t):e[o]===t.value&&t instanceof r&&-1!==this.displayStyle.indexOf("bullet")&&n.push(t)}return n}for(s=0;s<i.length;s++)if((t=i[s]).value===e)return t}},_updateButtonFocus:function(){if(this.value&&this.value.length>0){var e=this.getButtonFromValue(this.value[0]);e&&(e.getContent().blur(),e.getContent().focus())}},getWidthWithoutScroll:function(){if(this.redrawTabBar(),y)return y},getMinWidthWithoutScroll:function(){this.redrawTabBar();for(var e=0,t=this.getVisibleTabCount(),i=this.buttonGroup._getButtonList(),n=0;n<t;n++)i[n]&&(e+=i[n].getContent().getBoundingClientRect().minWidth);return this.showComboBoxFlag&&(e+=this.tabComboBox.getContent().getBoundingClientRect().width),e},getWidthOfAllVisibleButtons:function(){for(var e=0,t=this.buttonGroup._getButtonList(),i=0;i<t.length;i++){var n=t[i];n.visibleFlag&&(e+=this.getWidthOfButton(n))}return e+3},getWidthOfButton:function(e){var t=window.getComputedStyle(e.getContent(),null),i=parseInt(t.marginLeft.slice(0,-2)),n=parseInt(t.marginRight.slice(0,-2));return e.getContent().getBoundingClientRect().width+i+n},_applyInheritWidthToButtons:function(){for(var e=this.buttonGroup._getButtonList(),t=0;t<e.length;t++){var i=e[t];i.visibleFlag&&(i.getContent().style.width="inherit")}},_getButtonByIndex:function(e){var t,i=this.buttonGroup._getButtonList();if(i)for(var n=0;n<i.length;n++)if((t=i[n])._index===e)return t},getValueByIndex:function(e){var t=this._getButtonByIndex(e);return t?t.value:void 0},getIndexesByValues:function(e){for(var t=[],i=0;i<e.length;i++){var n=this.getButtonFromValue(e[i]);if(-1===this.displayStyle.indexOf("bullet")){if(void 0===n)t[i]=void 0;else void 0!==(s=n._index)&&(t[i]=s)}else{var s,o=x(this.buttonGroup._getButtonList(),n);if(void 0===o)t[i]=void 0;else(s=o._index)&&(t[i]=s)}}return t},getTabCount:function(){if(this.buttonGroup)return-1!==this.displayStyle.indexOf("bullet")?this.buttonGroup.getButtonCount()/2:this.buttonGroup.getButtonCount()},getVisibleTabCount:function(){if(this.buttonGroup){for(var e=0,t=this.buttonGroup._getButtonList(),i=0;i<t.length;i++)t[i].visibleFlag&&e++;return e}},_getVisibleTabButtons:function(){if(this.buttonGroup){for(var e=[],t=this.buttonGroup._getButtonList(),i=0;i<t.length;i++){var n=t[i];n.visibleFlag&&e.push(n)}return e}return null},add:function(e){void 0===e.allowClosableFlag&&(e.allowClosableFlag=!0);var t=this.buttonGroup.getButtonCount();void 0===e.index&&(e.index=t),void 0!==e.isSelected&&null!==e.isSelected||(e.isSelected=!1),void 0!==e.showTitleFlag&&null!==e.showTitleFlag||(e.showTitleFlag=!0);for(var i=void 0!==e.value&&null!==e.value?e.value:e.index;this.getButtonFromValue(i);)i++;var n=e.icon;n&&n.iconName&&(n={iconName:n.iconName,fontIconFamily:n.fontIconFamily?n.fontIconFamily:0});var s=new a({label:e.label,type:"radio",value:i,checkFlag:e.isSelected,clickMode:1,showLabelFlag:e.showTitleFlag,icon:n,touchMode:e.touchMode,allowUnsafeHTMLLabel:this.allowUnsafeHTMLOnTabButton,tooltipInfos:e.tooltipInfos});s._index=e.index;var o=new r({type:"radio",value:i,checkFlag:e.isSelected,clickMode:1,allowUnsafeHTMLLabel:this.allowUnsafeHTMLOnTabButton,tooltipInfos:e.tooltipInfos});o._index=e.index;for(var l,h=e.index;this.togglesTab.hasOwnProperty(h);)h++;if(this.togglesTab[h]=o,this.closeButtonFlag&&e.allowClosableFlag?this._createCloseButtonFlag(s):this.closeAllButtonFlag&&e.allowClosableFlag&&this._createCloseButtonFlag(s),0===t)s.inject(this.buttonGroup.elements.container);else for(var u=this.buttonGroup._getButtonList(),c=0;c<u.length;c++){var d=u[c];d._index<e.index&&(l=d)}return l?s.inject(l.getContent(),"after"):s.inject(this.buttonGroup.getButton(0).getContent(),"before"),this._updateIndexOfTab(),this.buttonGroup._updateChildPropertiesAndListeners(s,s._index),this.historySelection[this.historySelection.length]={value:s.value,cpt:this.cptSelection},s.getContent().setAttribute("role","tab"),this.showComboBoxFlag||-1===this.displayStyle.indexOf("strip")&&this._hideButtonsNextAndPrevious(),this._applyDisplayStyle(),this.showComboBoxFlag&&this._updateComboBox(),S(this),this._updateThresholds(),s},addTab:function(e,t,i,n,s,o,l){var a={label:e,index:t,isSelected:i,value:n,icon:s,allowClosableFlag:o,showTitleFlag:l};return this.add(a)},setAllowClosableFlagOnValue:function(e,t){var i=this.getButtonFromValue(e);i&&((this.closeButtonFlag||this.closeAllButtonFlag)&&!i.elements._closeButton&&t&&this._createCloseButtonFlag(i),i.elements._closeButton&&(this.closeButtonFlag&&t?(i.elements._closeButton.show(),i.getContent().addClassName("wux-controls-tabbar-closebutton")):(i.elements._closeButton.hide(),i.getContent().removeClassName("wux-controls-tabbar-closebutton"))))},changeLabel:function(e,t){var i=new Error("DEPRECATED METHOD");i.name="WARNING",console.warn(i.stack);this.buttonGroup.getButton(e).label=t,this.modelEvent.publish({event:"changeLabelTab",data:{index:e,label:t}})},removeTab:function(e,t){var i=-1!==this.value.indexOf(e);if(this.pinFlag&&this.pinnedList&&this.pinnedList.length>0&&-1!==this.pinnedList.indexOf(e)&&this._removePinnedButton(e),void 0!==this.getButtonFromValue(e)){if(this._preventButtonGroupListener=i,t&&(this.getButtonFromValue(e).visibleFlag=!1,document.body.appendChild(this.getButtonFromValue(e).getContent())),this.buttonGroup.removeChild(this.getButtonFromValue(e)),this._preventButtonGroupListener=!1,-1!==this.displayStyle.indexOf("bullet")){var n=w(this.togglesTab,e);this.togglesTab[n].destroy(),this.togglesTab[n]=null,delete this.togglesTab[n]}if(this._updateIndexOfTab(),this.showComboBoxFlag&&this._removeValueComboBox(e),this._removeHistoryFromButton(e),i){var s=this._getMaxHistory();this.value=void 0!==s?[s]:[]}S(this),this._updateIndexOfTab(),this._updateThresholds(),this._slideToAvoidBlankSpace(),this.redrawTabBar()}},updateTab:function(e,t){var i=this.getButtonFromValue(e);if(i){var n=i.label!=t.label||i.icon!=t.icon;void 0!==t.label&&(i.label=t.label,i.elements._closeButton&&i.getContent().insertBefore(i.elements._closeButton,i.elements.lastChild)),void 0!==t.icon&&(i.icon=t.icon),void 0!==t.allowClosableFlag&&this.setAllowClosableFlagOnValue(e,t.allowClosableFlag),void 0!==t.showTitleFlag&&(i.showLabelFlag=t.showTitleFlag),n&&this.showComboBoxFlag&&this._updateComboBox(),this._updateThresholds([i])}},getOptionFromButton:function(e,t){var i=this.getButtonFromValue(t);if(i&&i[e])return i[e]},setOptionFromButton:function(e,t,i){var n=this.getButtonFromValue(i);n&&(n[e]=t),!this.showComboBoxFlag||"icon"!==e&&"label"!==e||this._updateComboBox()},_editTab:function(e){var t=this;f=t.getButtonFromValue(e),t.closeButtonFlag&&f.elements._closeButton&&f.elements._closeButton.hide(),t.closeAllButtonFlag&&f.elements._closeAllButton&&f.elements._closeAllButton.hide();var i=f.getContent().getBoundingClientRect().width-parseInt(window.getComputedStyle(f.getContent()).getPropertyValue("border-left"))-parseInt(window.getComputedStyle(f.getContent()).getPropertyValue("border-right")),s=f.getContent().getBoundingClientRect().height-8,o=f.elements.container.getElements(".wux-controls-lineeditor");if(f instanceof a&&(t.editableFlag||f.label===m.newTab)&&0===o.length){var l=f.elements.text?f.elements.text.innerHTML:"",r=f.elements.text?f.elements.text.getBoundingClientRect().width:0;f.elements.text&&f.elements.text.hide(),f.getContent().addClassName("wux-controls-tabbar-button-nopadding"),(v=new n({value:l,touchMode:this.touchMode,selectAllOnFocus:-1!==this.displayStyle.indexOf("strip")}).inject(f.elements.container)).getContent().setAttributes({height:s+"px",width:i+"px",position:"relative"});var h=(t.displayStyle,"22px");v._myInput.style.width=-1!==this.displayStyle.indexOf("strip")?r+"px":i-parseInt(window.getComputedStyle(v._myInput).getPropertyValue("padding-left"))-parseInt(window.getComputedStyle(v._myInput).getPropertyValue("padding-right"))-parseInt(window.getComputedStyle(v._myInput).getPropertyValue("border-left"))-parseInt(window.getComputedStyle(v._myInput).getPropertyValue("border-right"))+"px",v._myInput.style.height=this.touchMode?"22px":h,v._myInput.style.minWidth="44px",v._myInput.style.marginLeft=f.elements.text?"0px":"4px",v._myInput.style.lineHeight=v._myInput.style.height,v.getContent().style.display="inline-block",v._myInput.focus(),t._updateThresholds([f]),f.elements.text&&f.elements.text.hide()}t.modelEvent.publish({event:"editTab",data:{value:e}}),this.fire("edit",{value:e})},_endEditTab:function(){var e=this;if(f){var t=f.elements.container.getElements(".wux-controls-lineeditor");t&&t[0]&&(f.label=t[0].dsModel.value,t[0].parentElement&&t[0].remove(),f.getContent().removeClassName("wux-controls-tabbar-button-nopadding"),f.elements.text&&f.elements.text.show(),e.closeButtonFlag&&f.elements._closeButton&&f.elements._closeButton.show(),e.closeAllButtonFlag&&f.elements._closeAllButton&&f.elements._closeAllButton.show(),this.showComboBoxFlag&&this.tabComboBox&&e._updateComboBox(),e.modelEvent.publish({event:"endEditTab",data:{button:f}}),e.fire("endEdit",{button:f}),this._slideToValue(),e._updateThresholds([f]))}},_updateIndexOfTab:function(){for(var e=this.buttonGroup._getButtonList(),t=0;t<e.length;t++)e[t]._index=t},_setTabVisibility:function(e,t){var i=this.getButtonFromValue(e),n=i.visibleFlag;if(i.visibleFlag=t,i.checkFlag=!1,this.showComboBoxFlag&&(!t&&n?this._removeValueComboBox(e):t&&!n&&this._updateComboBox()),!t&&this.value&&1===this.value.length&&this.value[0]===e){var s=this._getMaxHistory();this.value=void 0!==s?[s]:[]}S(this)},pinTab:function(e){this._pinTab(e)},_pinTab:function(e){var t=this,i=t.getButtonFromValue(e),n=i._index;i&&t.pinFlag&&(this.pinnedList&&-1!==this.pinnedList.indexOf(e)?(this._removePinnedButton(i.value),t.modelEvent.publish({event:"unpinTab",data:{index:n,value:i.value}}),t.fire("pinStateChange",{value:e,pinnedFlag:!1})):(this._addPinnedButton(i.value),t.modelEvent.publish({event:"pinTab",data:{index:n,value:i.value}}),t.fire("pinStateChange",{value:e,pinnedFlag:!0})),t.fire("change"),t.redrawTabBar(),t._hasOverflow())},redrawTabBar:function(){if(this.buttonGroup&&this.buttonGroup.getContent()){var e=this.buttonGroup.getContent().getBoundingClientRect().width;if(-1!==this.displayStyle.indexOf("panel")&&this.tabComboBox){var t=24;this.touchMode&&(t=36);var i=2*t;this.buttonGroup.visibleFlag=!0,this.tabComboBox.getContent().addClassName("wux-button-tabBar-combo-right"),this.getContent().getBoundingClientRect().width<i&&(this.buttonGroup.visibleFlag=!1,this.tabComboBox.getContent().removeClassName("wux-button-tabBar-combo-right"))}if(this.visibleFlag&&0!==e){if(this._hasOverflow()||-1!==this.displayStyle.indexOf("panel")&&!this.buttonGroup.visibleFlag?(y=e+2,this.showComboBoxFlag?(this._addTooltips(),this.tabComboBox.show(),-1!==this.displayStyle.indexOf("strip")&&this._showButtonsNextAndPrevious()):this._showButtonsNextAndPrevious(),this.slide>1&&this._updateButtonFocus(),this.touchMode?this.elements.tabBar.getSize().width<54&&this._hideButtonsNextAndPrevious():this.elements.tabBar.getSize().width<36&&this._hideButtonsNextAndPrevious()):(b(this,0),y=e+2,this.showComboBoxFlag?(this.tabComboBox.hide(),-1!==this.displayStyle.indexOf("strip")&&this.showPreviousButton&&this.showNextButton&&this._hideButtonsNextAndPrevious()):this._hideButtonsNextAndPrevious()),this.newTabButtonFlag&&this._applyNewTabButtonFlag(),this.buttonGroup.value)for(var n=this.buttonGroup._getButtonList(),s=0;s<n.length;s++){var o=n[s];-1!==this.displayStyle.indexOf("bullet")&&o.checkFlag&&o.getContent().addClassName("wux-controls-toggle-selectbutton"),E(this,o)}this.showComboBoxFlag&&this._updateComboBox()}}},onSelectTab:function(e){return this.modelEvent.subscribe({event:"selectTab"},e)},onBeginTabDrag:function(e){return this.modelEvent.subscribe({event:"beginDragTab"},e)},onEndTabDrag:function(e){return this.modelEvent.subscribe({event:"endDragTab"},e)},onUnpinTab:function(e){return this.modelEvent.subscribe({event:"unpinTab"},e)},onPinTab:function(e){return this.modelEvent.subscribe({event:"pinTab"},e)},onEditTab:function(e){return this.modelEvent.subscribe({event:"editTab"},e)},onEndEditTab:function(e){return this.modelEvent.subscribe({event:"endEditTab"},e)},onChangeLabelTab:function(e){return this.modelEvent.subscribe({event:"changeLabelTab"},e)},onPreNewTab:function(e){return this.modelEvent.subscribe({event:"preNewTab"},e)},onNewTab:function(e){return this.modelEvent.subscribe({event:"newTab"},e)},onRemoveTabEvent:function(e){return this.modelEvent.subscribe({event:"removeTab"},e)},onContextualMenuEvent:function(e){return this.modelEvent.subscribe({event:"contextualMenu"},e)},destroy:function(){function e(e,t){e&&e[t]&&(e[t].destroy(),e[t]=null)}for(var t in o.removeResizeListener(this.elements.container,this._onResizeFun,0),e(this,"buttonGroup"),e(this,"newTabButton"),e(this,"showPreviousButton"),e(this,"showNextButton"),e(this,"newTabComboBox"),e(this,"tabComboBox"),this.togglesTab)t&&e(this.togglesTab,t);this._parent()}}),C=function(e,t){if(!e||!t)throw new Error("WRONG PARAMETERS");for(var i in e)if(t.value===e[i].value)return e[i]},w=function(e,t){for(var i in e)if(t===e[i].value)return i},x=function(e,t){if(!e||!t)throw new Error("WRONG PARAMETERS");for(var i=0;i<e.length;++i)if(t.value===e[i].value&&e[i]instanceof a)return e[i]},E=function(e,t){if(!e||!t)throw new Error("WRONG PARAMETER");if(e.pinnedList&&e.pinnedList.length>0)for(var i=0;i<e.pinnedList.length;++i)t.value===e.pinnedList[i]&&(-1!==e.displayStyle.indexOf("normal")?t.getContent().removeClassName("wux-controls-toggle-pinnedbutton"):-1!==e.displayStyle.indexOf("bullet")&&(t.getContent().addClassName("wux-controls-toggle-pinnedbutton"),t.show()))},S=function(e){if(-1===e.displayStyle.indexOf("strip")){var t,i=e._getVisibleTabButtons(),n=0,s="wux-controls-button-",o=e.getVisibleTabCount();if(1===o)i[0].getContent().addClassName(s+"onlyone"),i[0].getContent().removeClassName(s+"allothers"),i[0].getContent().removeClassName(s+"lastone"),i[0].getContent().removeClassName(s+"firstone"),-1!==e.displayStyle.indexOf("normal")&&i[0].getContent().setStyle("margin-right","0px"),i[1]&&i[1].getContent().addClassName(s+"lastone");else for(var l=0;l<o;l++)(t=i[l].getContent()).removeClassName(s+"show-lastbutton"),t.removeClassName(s+"show-firstbutton"),!0===i[l].visibleFlag&&(-1!==e.displayStyle.indexOf("bullet")?0===n?(t.addClassName(s+"firstone"),t.removeClassName(s+"allothers"),t.removeClassName(s+"lastone"),t.removeClassName(s+"onlyone"),n=1):l===o-1?(t.addClassName(s+"lastone"),t.removeClassName(s+"allothers"),t.removeClassName(s+"firstone"),t.removeClassName(s+"onlyone")):(t.addClassName(s+"allothers"),t.removeClassName(s+"onlyone"),t.removeClassName(s+"firstone"),t.removeClassName(s+"lastone")):0===l?(t.addClassName(s+"firstone"),t.removeClassName(s+"allothers"),t.removeClassName(s+"lastone"),t.removeClassName(s+"onlyone")):l===o-1?(t.addClassName(s+"lastone"),t.removeClassName(s+"allothers"),t.removeClassName(s+"firstone"),t.removeClassName(s+"onlyone")):(t.addClassName(s+"allothers"),t.removeClassName(s+"onlyone"),t.removeClassName(s+"firstone"),t.removeClassName(s+"lastone")))}},D=function(){var e=this.add({label:m.newTab,touchMode:this.touchMode}),t=e._index,i=e.value;this.modelEvent.publish({event:"preNewTab",data:{index:t,value:e.value}}),this.fire("preAddTab",{index:t,value:e.value}),i!==e.value&&(this.historySelection[this.historySelection.length]={value:e.value,cpt:1},this.showComboBoxFlag&&this._updateComboBox(t)),this.buttonGroup.selectIndex(t),this._editTab(e.value);var n=this.buttonGroup.getContent().scrollWidth,s=this.elements.tabBar.getBoundingClientRect().width,o=s-n;this.slide=s/2-(e.getContent().getBoundingClientRect().left-this.buttonGroup.getContent().getBoundingClientRect().left),this.slide<o&&(this.slide=o),-1===this.displayStyle.indexOf("immersif")&&(this.slide-=5),this.redrawTabBar(),v&&v._myInput.focus(),this.modelEvent.publish({event:"newTab",data:{index:t}}),this.fire("addTab",{index:t})},I=function(){this.elements.buttonGroupContainer.addClassName("wux-controls-tabbar-strip"),this.elements.buttonsContainer.addClassName("wux-controls-tabbar-strip"),this.elements.container.addClassName("wux-controls-tabbar-strip"),this.newTabButton&&(-1!==this.displayStyle.indexOf("vertical")?this.newTabButton.inject(this.elements.containerAddandNextButton):this.newTabButton.inject(this.elements.tabBar),this.newTabButton.getContent().addClassName("wux-controls-tabbar-strip"),this.newTabButton.icon="plus",this.newTabButton.label="",this.newTabButtonFlag||this.newTabButton.hide()),this.showPreviousButton||this.showNextButton||this._createButtonsNextAndPrevious(),this.showPreviousButton&&(this.showPreviousButton.icon={iconName:"open-left",fontIconFamily:1},this.showPreviousButton.getContent().addClassName("wux-controls-tabbar-strip")),this.showNextButton&&(this.showNextButton.icon={iconName:"open-right",fontIconFamily:1},this.showNextButton.getContent().addClassName("wux-controls-tabbar-strip")),this.newTabButton&&(this.newTabButton.getContent().style.marginLeft="0px"),this.tabComboBox&&(this.tabComboBox.expanderIcon=this.newTabButtonFlag?"list-add":"list",this.tabComboBox.getContent().addClassName("wux-controls-tabbar-strip"),this.tabComboBox.elements.popup||this.tabComboBox._buildPopup(),this.tabComboBox.elements.popup.alignment="left",this.tabComboBox.elements.popup.getContent().addClassName("wux-controls-tabbar-strip"),this.tabComboBox.elements.treeListView.getManager().options.defaultCellHeight=30,F.call(this),this.tabComboBox.inject(this.elements.containerAddandNextButton)),-1!==this.displayStyle.indexOf("strip-box")&&this.elements.container.addClassName("wux-controls-tabbar-strip-box")},V=function(){this.elements.buttonGroupContainer.removeClassName("wux-controls-tabbar-strip"),this.elements.buttonsContainer.removeClassName("wux-controls-tabbar-strip"),this.elements.container.removeClassName("wux-controls-tabbar-strip"),this.elements.container.removeClassName("wux-controls-tabbar-strip-box"),this.showPreviousButton&&(this.showPreviousButton.destroy(),this.showPreviousButton=null),this.showNextButton&&(this.showNextButton.destroy(),this.showNextButton=null),this.tabCombobox&&(this.tabCombobox.destroy(),this.tabCombobox=null),this._applyShowComboBoxFlag(),this._applyNewTabButtonFlag()},F=function(){if(!this.newTabComboBox){this.newTabComboBox=new a({icon:"plus",label:m.newTab,allowUnsafeHTMLLabel:this.allowUnsafeHTMLOnTabButton}),this.newTabComboBox.tooltipInfos=new d({shortHelp:m.addNewItem,allowUnsafeHTMLTitle:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLShortHelp:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLLongHelp:this.allowUnsafeHTMLOnTabButton}),this.newTabComboBox.elements.container.addClassName("wux-controls-tabbar-newbuttoncombo");var t=this;if(o.addEventOnElement(this,this.newTabComboBox,"click",function(){D.call(t)}),this.tabComboBox&&this.tabComboBox.elements&&this.tabComboBox.elements.popup){var i=this.tabComboBox.elements.popup.getBody(),n=e.createElement("div");this.newTabComboBox.inject(n),i.inject(n),this.tabComboBox.elements.popup.setBody(n)}}i=void 0;if(this.tabComboBox&&this.tabComboBox.elements&&this.tabComboBox.elements.popup&&(i=this.tabComboBox.elements.popup.getBody()),this.newTabButtonFlag&&this.showComboBoxFlag){if(this.tabComboBox&&this.tabComboBox.elements&&this.tabComboBox.elements.popup&&!1===i.contains(this.newTabComboBox.getContent())){i=this.tabComboBox.elements.popup.getBody();n=e.createElement("div");this.newTabComboBox.inject(n),i.inject(n),this.tabComboBox.elements.popup.setBody(n)}this.newTabComboBox.show(),i&&i.addClassName("wux-controls-tabbar-combopopup")}else this.newTabComboBox.hide(),i&&i.removeClassName("wux-controls-tabbar-combopopup")},A=function(e,t){for(var i=[],n=0;n<e.length;n++)-1===t.indexOf(e[n])&&i.push(e[n]);return i};return p.register(_,"DS/ControlsRec/AbstractRec"),_}),define("DS/Controls/Tab",["UWA/Core","UWA/Class","DS/Controls/Abstract","DS/Controls/TabBar","DS/Utilities/Utils"],function(e,t,i,n,s){"use strict";return i.inherit({name:"tab",markForRecordFlag:!0,publishedProperties:{tabBar:{defaultValue:void 0,type:n},tabBarDOMContainer:{defaultValue:void 0,type:Object},tabPanelContainer:{defaultValue:void 0,type:Object},displayStyle:{defaultValue:"normal",type:String,category:"Appearance"},value:{defaultValue:void 0,type:[],recordFlag:!0},multiSelFlag:{defaultValue:!1,type:Boolean,category:"Behavior"},reorderFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},showComboBoxFlag:{defaultValue:!1,type:"boolean",category:"Appearance"},autoCloseFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},touchMode:{defaultValue:void 0,type:"boolean",category:"Accessibility",advancedSetter:!0},multiSelLayout:{defaultValue:"vertical",type:String,category:"Appearance"},newTabButtonFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},allowUnsafeHTMLOnTabButton:{defaultValue:void 0,type:"boolean",category:"Behavior"}},buildView:function(){this.elements.container.addClassName("wux-controls-tab"),this.tabBarDOMContainer||(this.tabBarDOMContainer=new e.Element("div",{class:"tabBarContainer"}),this.tabBarDOMContainer.inject(this.elements.container,"top")),this.tabPanelContainer||(this.tabPanelContainer=new e.Element("div",{class:"tabContainer"}),this.tabPanelContainer.inject(this.elements.container,"bottom")),this.tabBar||(this.tabBar=new n({allowUnsafeHTMLOnTabButton:this.allowUnsafeHTMLOnTabButton})),this._tabContent=[]},destroy:function(){this.tabBar.destroy(),this._parent()},_postBuildView:function(){this.tabBar&&(this.tabBar.allowUnsafeHTMLOnTabButton=this.allowUnsafeHTMLOnTabButton)},_applyReorderFlag:function(){this.tabBar&&(this.tabBar.reorderFlag=this.reorderFlag)},_applyTabBar:function(t){t&&t.remove(),this.tabBar&&this.tabBarDOMContainer&&(e.is(this.tabBar,"element")&&(this.tabBar=new e.extendElement(this.tabBar)),this.tabBar.inject(this.tabBarDOMContainer))},_applyTabBarDOMContainer:function(t){t&&t.remove(),this.tabBarDOMContainer&&(e.is(this.tabBarDOMContainer,"element")&&(this.tabBarDOMContainer=new e.extendElement(this.tabBarDOMContainer)),this._applyTabBar())},_applyTabPanelContainer:function(t){t&&t.remove(),this.tabPanelContainer&&(e.is(this.tabPanelContainer,"element")&&(this.tabPanelContainer=new e.extendElement(this.tabPanelContainer)),this.tabPanelContainer.addClassName("wux-controls-tab-container"))},_applyShowComboBoxFlag:function(){this.tabBar&&(this.tabBar.showComboBoxFlag=this.showComboBoxFlag)},_applyNewTabButtonFlag:function(){-1!==this.displayStyle.indexOf("strip")&&this.tabBar&&(this.tabBar.newTabButtonFlag=this.newTabButtonFlag)},_applyAutoCloseFlag:function(){this.tabBar&&(this.tabBar.autoCloseFlag=this.autoCloseFlag)},_applyDisabled:function(){this._parent(),this.disabled?(this.elements.contentDisabler||(this.elements.contentDisabler=s.createContentDisablerDiv()),this.elements.container.appendChild(this.elements.contentDisabler)):this.elements.contentDisabler&&this.elements.container.removeChild(this.elements.contentDisabler)},_applyTouchMode:function(){this._postEditTouchMode()},_postEditTouchMode:function(){var e=this._getCurrentTouchMode();this._parent(),this.tabBar&&(this.tabBar.touchMode=e)},_applyDisplayStyle:function(){if(this.tabBar&&this.displayStyle&&this.tabPanelContainer){if(this.tabBar.displayStyle=this.displayStyle,-1!==this.displayStyle.indexOf("panel")&&this.tabPanelContainer.addClassName("wux-controls-tabbar-panel"),-1!==this.displayStyle.indexOf("strip")?(this.tabPanelContainer.addClassName("wux-controls-tab-strip"),-1!==this.displayStyle.indexOf("strip-box")&&this.tabPanelContainer.addClassName("wux-controls-tab-strip-box")):(this.tabPanelContainer.removeClassName("wux-controls-tab-strip"),this.tabPanelContainer.removeClassName("wux-controls-tab-strip-box")),-1!==this.displayStyle.indexOf("vertical")){if(this.tabBarDOMContainer&&this.tabPanelContainer){this.tabBarDOMContainer.addClassName("wux-controls-tabbar-vertical"),this.tabPanelContainer.addClassName("wux-controls-tabbar-vertical");for(var e=this.tabBar.buttonGroup._getButtonList(),t=0;t<e.length;t++){(i=e[t])&&i.elements.text&&i.elements.text.hide()}}}else if(this.tabBarDOMContainer&&this.tabPanelContainer){this.tabBarDOMContainer.removeClassName("wux-controls-tabbar-vertical"),this.tabPanelContainer.removeClassName("wux-controls-tabbar-vertical");for(e=this.tabBar.buttonGroup._getButtonList(),t=0;t<e.length;t++){var i;(i=e[t])&&i.elements.text&&1==i.showLabelFlag&&i.elements.text.show()}}this.redrawTabBar()}},_applyMultiSelFlag:function(){this.tabBar&&(this.tabBar.multiSelFlag=this.multiSelFlag,this._applyDisplayStyle(),this._applyMultiSelLayout())},_applyMultiSelLayout:function(){this.multiSelFlag&&"horizontal"===this.multiSelLayout?this.tabPanelContainer.addClassName("wux-controls-tab-horizontalMultiSelLayout"):this.tabPanelContainer.removeClassName("wux-controls-tab-horizontalMultiSelLayout")},_applyValue:function(e){if(e)for(var t=this.getIndexesFromValues(e),i=0;i<t.length;i++)this.tabBar.pinnedList&&-1!==this.tabBar.pinnedList.indexOf(this.getPageValueFromIndex(t[i]))||this._hideContent(this.getPageValueFromIndex(t[i]));if(this.tabBar){this.tabBar.value=this.value,l.call(this);var n=this.getIndexesFromValues(this.value);n=n.sort();for(var s=0;s<n.length;s++)this._showContent(this.getPageValueFromIndex(n[s]));this.redrawTabBar(),this._checkForMultiSelection(),this.fire("change")}},_applyRecId:function(){this.tabBar&&(this.tabBar.recId=this.recId)},_applyProperties:function(e){this._parent(e),this.isDirty("tabBar")&&this._applyTabBar(e.tabBar),this.isDirty("tabBarDOMContainer")&&this._applyTabBarDOMContainer(e.tabBarDOMContainer),this.isDirty("tabPanelContainer")&&this._applyTabPanelContainer(e.tabPanelContainer),this.isDirty("showComboBoxFlag")&&this._applyShowComboBoxFlag(e.showComboBoxFlag),this.isDirty("displayStyle")&&this._applyDisplayStyle(e.displayStyle),this.isDirty("value")&&this._applyValue(e.value),this.isDirty("multiSelFlag")&&this._applyMultiSelFlag(e.multiSelFlag),this.isDirty("reorderFlag")&&this._applyReorderFlag(e.reorderFlag),this.isDirty("newTabButtonFlag")&&this._applyNewTabButtonFlag(e.newTabButtonFlag),this.isDirty("autoCloseFlag")&&this._applyAutoCloseFlag(e.autoCloseFlag)},_checkForMultiSelection:function(){if(this.tabPanelContainer){var e=[],t=0;if(this.value&&(t=this.value.length),this.tabBar.pinnedList){for(var i=0;i<this.tabBar.pinnedList.length;i++)-1!==this.value.indexOf(this.tabBar.pinnedList[i])&&e.push(this.tabBar.pinnedList[i]);t=t+this.tabBar.pinnedList.length-e.length}t>1?this.tabPanelContainer.addClassName("wux-controls-tab-multiSelection"):this.tabPanelContainer.removeClassName("wux-controls-tab-multiSelection")}},getPageCount:function(){return this.tabPanelContainer.getChildren().length},getPageContent:function(e){return this.tabPanelContainer.getChildren()[e]},getPageContentFromValue:function(e){for(var t in this._tabContent)if(this._tabContent[t].value===e)return this._tabContent[t].content},getPageContentFromIndex:function(e){for(var t in this._tabContent)if(this._tabContent[t].index===e)return this._tabContent[t].content},setPageContentFromIndex:function(t,i){if(this._tabContent&&this._tabContent.length>t){var n=this._tabContent[t].content;return e.is(i,"element")&&(i=new e.extendElement(i)),i.id=this._tabContent[t].value,i.inject(n,"before"),"none"===n.getStyle("display")&&i.setStyle("display","none"),this._tabContent[t].content=i,n.remove()}},getPageIndexFromValue:function(e){for(var t in this._tabContent)if(this._tabContent[t].value===e)return this._tabContent[t].index},getOptionFromButton:function(e,t){return this.tabBar.getOptionFromButton(e,t)},setOptionFromButton:function(e,t,i){return this.tabBar.setOptionFromButton(e,t,i)},getPageValueFromIndex:function(e){for(var t in this._tabContent)if(void 0!==this._tabContent[t].index&&this._tabContent[t].index===e)return this._tabContent[t].value},add:function(e){var t=this.tabBar.add({label:e.label,index:e.index,isSelected:!1,value:e.value,icon:e.icon,allowClosableFlag:e.allowClosableFlag,showTitleFlag:e.showTitleFlag,tooltipInfos:e.tooltipInfos});return o.call(this,e.content,t._index,t.value),e.isSelected?this._showContent(t.value):this._hideContent(t.value),e.isSelected&&(this.value=[t.value]),this._applyDisplayStyle(),this._postEditTouchMode(),{button:t,value:t.value}},addTab:function(e,t,i,n,s,o,l,a){var r={label:e,content:t,index:i,isSelected:n,value:s,icon:o,allowClosableFlag:l,showTitleFlag:a};return this.add(r)},removeTab:function(e,t){var i=this.getIndexOf(e),n=this.getPageValueFromIndex(i);if(i>=0)return this.removeTabContent(n,t)},removeTabContent:function(e,t){var i=this.tabPanelContainer.getChildren(),n=this.getPageContentFromValue(e),s=this.getPageIndexFromValue(e);if(!(void 0===s||s>=i.length||s<0)){for(var o=0;o<this._tabContent.length;o++)if(void 0!==this._tabContent[o].index&&this._tabContent[o].index===s){this._tabContent[o].index=void 0,this._tabContent.splice(o,1);break}var r=a.call(this,e);return r&&r.remove(),this.tabBar&&this.tabBar.removeTab(e,t),l.call(this),n.visibleFlag&&n.show(),r}},clear:function(){for(;this.getPageCount()>0;)this.removeTab(this.getPageContentFromIndex(0))},getIndexOf:function(e){for(var t=-1,i=this.getPageCount(),n=0;n<i;n++){if(this.getPageContentFromIndex(n)===e){t=n;break}}return t},getIndexesFromValues:function(e){return this.tabBar._indexesFromValues(e)},redrawTabBar:function(){this.tabBar.redrawTabBar(),this.tabPanelContainer&&(-1!==this.displayStyle.indexOf("vertical")?this.tabPanelContainer.setStyles({width:this.getContent().getDimensions().width-this.tabBar.getContent().getDimensions().width-4+"px"}):this.tabPanelContainer.setStyles({width:"auto"}))},isPinned:function(e){return!(!this.tabBar.pinFlag||!this.tabBar.pinnedList||-1===this.tabBar.pinnedList.indexOf(e))},_showContent:function(e){var t=this.getPageContentFromValue(e);t&&t.show()},_showPinnedContent:function(){if(this.tabBar.pinnedList&&this.tabBar.pinnedList.length>0){var e=this.getIndexesFromValues(this.tabBar.pinnedList);e=e.sort();for(var t=0;t<e.length;t++){var i=this.getPageContentFromIndex(e[t]);i&&i.show()}}},_hideContent:function(e){var t=this.getPageContentFromValue(e);t&&t.hide()},_setTabVisibility:function(e,t){var i=this.getPageContentFromValue(e);i&&(t&&-1!==this.value.indexOf(e)?i.show():i.hide()),this.tabBar._setTabVisibility(e,t),this.redrawTabBar()},_redrawBorder:function(){var e,t=this.getIndexesFromValues(this.value).sort(),i=t;if(this.tabBar.pinnedList&&this.tabBar.pinnedList.length>0)for(var n=this.getIndexesFromValues(this.tabBar.pinnedList),o=0;o<n.length;o++)-1===i.indexOf(n[o])&&i.push(n[o]);else i=t;s.sortNumberArray(i);for(var l=0;l<i.length;l++)i.length>1&&i[l]!==i[i.length-1]?(e=this.getPageContentFromIndex(i[l]))&&e.addClassName("wux-controls-tab-borderSeparator"):i.length>1&&i[l]===i[i.length-1]?(e=this.getPageContentFromIndex(i[l]))&&e.removeClassName("wux-controls-tab-borderSeparator"):1===i.length&&i[l]===i[0]&&(e=this.getPageContentFromIndex(i[l]))&&e.removeClassName("wux-controls-tab-borderSeparator"),i.length>1&&i[l]===i[i.length-1]&&(e=this.getPageContentFromIndex(i[l]))&&e.removeClassName("wux-controls-tab-borderSeparator"),i.length>1&&i[l]===i[0]&&(e=this.getPageContentFromIndex(i[l]))&&e.addClassName("wux-controls-tab-borderSeparator")},_handleEvents:function(){var t=this;this.tabBar.addEventListener("change",function(e){e.stopPropagation(),t.value=t.tabBar.value,t._redrawBorder(),t.fire("onSelectTab",e)}),this.tabBar.onEndTabDrag(function(e){(function(e,t){var i=this.getPageIndexFromValue(e),n=this.getPageIndexFromValue(t);if(i-n==1)this.tabPanelContainer.insertBefore(a.call(this,e),a.call(this,t));else if(n-i==1)this.tabPanelContainer.insertBefore(a.call(this,t),a.call(this,e));else{var s,o,r=a.call(this,t),h=a.call(this,e);r&&(s=r.nextSibling),h&&(o=h.nextSibling),s?this.tabPanelContainer.insertBefore(h,s):h.inject(this.tabPanelContainer),o?this.tabPanelContainer.insertBefore(r,o):r.inject(this.tabPanelContainer)}l.call(this)}).call(t,e.valueButtonDragged,e.valueButtonTarget),t._redrawBorder()}),this.tabBar.onPinTab(function(){t._checkForMultiSelection(),t._showPinnedContent(),t._redrawBorder()}),this.tabBar.onUnpinTab(function(e){var i=e.value,n=t.getPageContentFromValue(i);n&&(n.setStyles({"background-color":""}),n&&-1===t.value.indexOf(i)&&n.hide(),t._redrawBorder(),t._checkForMultiSelection())}),this.tabBar.onRemoveTabEvent(function(e){t.tabBar===e.tabBar&&(t.autoCloseFlag&&(t.removeTabContent(e.value),t.value=t.tabBar.value,t._redrawBorder()),t.fire("close"))}),this.tabBar.onPreNewTab(function(i){o.call(t,new e.Element("div"),i.index,i.value)})}});function o(t,i,n){var s=this.tabPanelContainer.getChildren();if(t)if(e.is(t,"element")&&(t=new e.extendElement(t)),t.id=n,void 0===i||0===s.length)t.inject(this.tabPanelContainer);else{for(var o=void 0,a=0,r=0;r<this._tabContent.length;r++)this._tabContent[r].index<i&&this._tabContent[r].index>=a&&(o=this._tabContent[r].content,a=this._tabContent[r].index);if(o){var h=o.getContent?o.getContent():o;t.inject(h,"after")}else t.inject(this.tabPanelContainer.getChildren()[0],"before")}this._tabContent[this._tabContent.length]={content:t,value:n,index:i},l.call(this)}function l(){if(this._tabContent)for(var e=0;e<this._tabContent.length;e++)if(this._tabContent.hasOwnProperty(e)){var t=this.getIndexesFromValues([this._tabContent[e].value]);void 0!==this._tabContent[e].value&&void 0!==t&&(this._tabContent[e].index=t[0])}}function a(e){var t=this.tabPanelContainer.childNodes;for(var i in t)if(parseInt(t[i].id)===e)return t[i]}});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/CustomizableDecorator",["require","exports","DS/Controls/AbstractDecorator","DS/Controls/CustomizableDecoratorItems","DS/Core/WebUXComponents","DS/Utilities/Dom","UWA/Core","DS/Core/PointerEvents","DS/Utilities/WUXUWAUtils"],function(e,t,i,n,s,o,l,a,r){"use strict";function h(e){var t=new l.Element("div");t.addClassName("wux-decorator-item");var i=n.getItem(e);return i&&Object.keys(i).length>0&&(t.addClassName("wux-decorator-filled-item"),t.setAttribute("itemid",e),i.label?(t.addClassName("wux-decorator-label-item"),t.setText(i.label)):i.icon&&t.setContent(o.generateIcon(i.icon)),i.semantics&&t.addClassName("wux-decorator-item-"+i.semantics)),t}function u(e){if(e)return e.classList.contains("wux-decorator-item")?e:u.call(this,e.getParent())}var c=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return n._views={},r.extendingClassFlag,n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{items:{defaultValue:void 0,type:"Object|Array",category:"Appearance"},activeView:{defaultValue:void 0,type:"string",category:"Behavior"},viewSwitchingDefinition:{defaultValue:void 0,type:"Object",category:"Behavior"},onClick:{defaultValue:void 0,type:"Function",category:"Behavior"},gridDefinition:{defaultValue:void 0,type:"Object",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype._applyItems=function(){this.elements.container.empty(),this._views={}},t.prototype._applyActiveView=function(){this._buildActiveView()},t.prototype._buildContent=function(){return this.elements.container.addClassName("wux-decorator-customizableDecorator"),this._buildActiveView(),this.elements.container},t.prototype.handleEvents=function(){var e=this;o.addEventOnElement(this,this.getContent(),a.POINTERDOWN,function(e){e.preventDefault(),e.stopPropagation(),u(e.target).addClassName("wux-decorator-customizableDecorator-active")}),o.addEventOnElement(this,this.getContent(),a.POINTERUP,function(t){t.preventDefault(),t.stopPropagation();var i=u.call(this,t.target),n=i.getAttribute("itemid");e.viewSwitchingDefinition&&e.viewSwitchingDefinition[n]&&(e.activeView=e.viewSwitchingDefinition[n]);var s=!1;if(e.onClick){var o=e.onClick.call(e,{itemID:n,input:e.widget&&e.widget._myInput?e.widget._myInput:void 0});o&&o.preventDefault&&(s=!0)}void 0!==n&&e.widget._onDecoratorClick&&e.widget._onDecoratorClick.call(e.widget,n,s),i.removeClassName("wux-decorator-customizableDecorator-active")})},t.prototype._buildActiveView=function(){if(this.elements.container.empty(),this.activeView)if(this.activeView&&!this._views[this.activeView]){var e=new l.Element("div"),t=new DocumentFragment,i=Array.isArray(this.items)?this.items:this.items[this.activeView],n=i.length,s=void 0,o=void 0;this.gridDefinition&&"object"==typeof this.gridDefinition&&(this.gridDefinition[this.activeView]?(s=this.gridDefinition[this.activeView].numberOfColumns,o=this.gridDefinition[this.activeView].numberOfLines):this.gridDefinition.numberOfColumns&&this.gridDefinition.numberOfLines&&(s=this.gridDefinition.numberOfColumns,o=this.gridDefinition.numberOfLines));var a=s||Math.ceil(Math.sqrt(n)),r=o||Math.floor(Math.sqrt(n));e.addClassName("wux-decorator-customizableDecorator-view-container"),e.setStyle("grid-template-columns","repeat("+a+", auto)"),e.setStyle("grid-template-rows","repeat("+r+", auto)");for(var u=0;u<n;u++)t.appendChild(h(i[u]));e.appendChild(t),this._views[this.activeView]=e,this.elements.container.appendChild(this._views[this.activeView])}else this.activeView&&this.elements.container.appendChild(this._views[this.activeView]);else this.resetActiveView()},t.prototype.resetActiveView=function(){this.activeView=Array.isArray(this.items)?"WUXDefaultActiveView":Object.keys(this.items)[0]},t.prototype._onShow=function(){this.widget&&this.widget._onDecoratorShow&&this.widget._onDecoratorShow.call(this.widget)},t.prototype._onHide=function(e){this.widget&&this.widget._onDecoratorHide&&this.widget._onDecoratorHide.call(this.widget,e)},t}(i);return s.addClass(c,"customizableDecorator"),c}),define("DS/Controls/Label",["UWA/Core","DS/Controls/Abstract","DS/Core/Core","DS/Utilities/Dom","DS/Controls/TooltipModel","DS/Controls/Button"],function(e,t,i,n,s,o){"use strict";var l="...";function a(){this.value?(this._content||function(){this._content=e.createElement("span",{class:"wux-controls-label-content"}).inject(this.elements.container)}.call(this),this._content.setText(this.value)):this._content&&(this._content.remove(),this._content=void 0)}function r(){a.call(this),"closeable-chip"==this.appearance?function(){if(!this._closeButton){var t=this;this._closeButton=new e.Element("span",{class:"wux-controls-label-close wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-close"}).inject(this.elements.container),n.addEventOnElement(this,this._closeButton,"click",function(e){t.elements.container.remove(),t.elements.container=void 0,e.stopPropagation()})}}.call(this):this._closeButton&&(this._closeButton.remove(),this._closeButton=void 0)}return t.inherit({name:"label",markForRecordFlag:!0,publishedProperties:{maxDisplayLength:{defaultValue:50,type:"integer",category:"Behavior"},value:{defaultValue:"",type:"string",category:"Appearance",recordFlag:!0},appearance:{defaultValue:"chip",type:"string",category:"Behavior"},emphasize:{defaultValue:"secondary",type:"string",category:"Appearance"},icon:{defaultValue:"",type:"string",category:"Behavior"},noContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}},buildView:function(){this._parent(),this.elements.container.addClassName("wux-controls-label"),this._content=void 0,this._iconPlaceHolder=void 0,this._icon=void 0,this._closeButton=void 0},_applyMaxDisplayLength(){(function(){if(this._content){var e=this.value;this.maxDisplayLength&&this.value.length>this.maxDisplayLength&&(this.tooltipInfos=new s({shortHelp:this.value,mouseRelativePosition:!1,position:"bottom"}),e=this.value.slice(0,this.maxDisplayLength-3)+l),this._content.setText(e)}}).call(this)},_applyIcon:function(t){(function(){if(this.icon){var t={iconName:this.icon.iconName?this.icon.iconName:this.icon,fontIconFamily:this.fontIconFamily?this.icon.fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"1x"},i=n.generateIcon(t);i&&(this._icon=i,this._icon.addClassName("wux-controls-label-icon"),this._iconPlaceHolder?this._icon&&this._iconPlaceHolder.removeChild(this._iconPlaceHolder.getChildren()[0]):(this._iconPlaceHolder=e.createElement("span",{class:"wux-controls-label-iconplaceholder"}),this.elements.container.insertBefore(this._iconPlaceHolder,this._content)),this._icon.inject(this._iconPlaceHolder))}else this._icon&&(this._icon.remove(),this._iconPlaceHolder.remove(),this._icon=void 0,this._iconPlaceHolder=void 0)}).call(this)},_applyValue:function(e){r.call(this)},_applyEmphasize:function(e){var t="wux-controls-abstract wux-controls-label wux-controls-label-";this.emphasize?t+=this.emphasize:t+="secondary",this.getContent().className="",this.getContent().addClassName(t)},_applyAppearance:function(e){r.call(this)},_applyProperties:function(e){this._parent(e),this.isDirty("icon")&&this._applyIcon(e.icon),this.isDirty("value")&&this._applyValue(e.value),this.isDirty("appearance")&&this._applyAppearance(e.appearance),this.isDirty("maxDisplayLength")&&this._applyMaxDisplayLength(e.maxDisplayLength),this.isDirty("emphasize")&&this._applyEmphasize(e.emphasize)}})}),define("DS/Controls/ResponsiveViewAdaptor",["UWA/Core","DS/Utilities/Utils","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Menu/ContextualMenu","DS/Controls/TooltipModel","DS/Controls/Label"],function(e,t,i,n,s,o,l,a){"use strict";return i.inherit({name:"ResponsiveViewAdaptor",markForRecordFlag:!0,publishedProperties:{picture:{defaultValue:"",type:"string",category:"Appearance"},icon:{defaultValue:"",type:"string",category:"Appearance"},title:{defaultValue:"",type:"string",category:"Appearance"},multipleTitleLineNumber:{defaultValue:!1,type:"boolean",category:"Behavior"},subtitle:{defaultValue:"",type:"string",category:"Appearance"},description:{defaultValue:"",type:"string",category:"Appearance"},propertiesList:{defaultValue:[],type:"array",category:"Appearance"},displayPropertiesTooltip:{defaultValue:!0,type:"boolean",category:"Appearance"},contextualMenu:{defaultValue:[],type:"array",category:"Behavior"},onContextMenuBuildCallback:{defaultValue:void 0,type:"function",category:"Behavior"},emptyStatusbarVisibleFlag:{defaultValue:!1,type:"boolean",category:"Appearance"},statusbarIcons:{defaultValue:[],type:"array",category:"Behavior"},statusbarLabelsWidthRatios:{defaultValue:[],type:"array",category:"Behavior"},statusbarIconsTooltips:{defaultValue:[],type:"array",category:"Behavior"},onStatusbarIconPointerDown:{defaultValue:void 0,type:"function",category:"Behavior"},activeFlag:{defaultValue:!1,type:"boolean",category:"Appearance"},color:{defaultValue:"",type:"string",category:"Appearance"},customTooltip:{defaultValue:"",type:"object",category:"Appearance"},badges:{defaultValue:[],type:"array",category:"Behavior"},clickableTitle:{defaultValue:!1,type:"boolean",category:"Behavior"}},_preBuild:function(e){this.layoutingCollection=e?e.layoutingCollection:void 0,this._parent(e),this._emptyStatusBarIcons=[]},_applyProperties:function(e){this.elements.container.style.display="none",this._parent(e),this.isDirty("statusbarIcons")&&this._applyStatusbarIcons(e.statusbarIcons),this.isDirty("badges")&&this._applyBadges(e.badges),this.isDirty("emptyStatusbarVisibleFlag")&&this._applyEmptyStatusbarVisibleFlag(e.emptyStatusbarVisibleFlag),this.isDirty("picture")&&this._applyPicture(e.picture),this.isDirty("icon")&&this._applyIcon(e.icon),this.isDirty("title")&&this._applyTitle(e.title),this.isDirty("clickableTitle")&&this._applyClickableTitle(e.clickableTitle),this.isDirty("multipleTitleLineNumber")&&this._applyMultipleTitleLineNumber(e.multipleTitleLineNumber),this.isDirty("subtitle")&&this._applySubtitle(e.subtitle),this.isDirty("description")&&this._applyDescription(e.description),this.isDirty("propertiesList")&&this._applyPropertiesList(e.propertiesList),this.isDirty("title")&&this._applyTitle(e.title),this.isDirty("contextualMenu")&&this._applyContextualMenu(e.contextualMenu),this.isDirty("onContextMenuBuildCallback")&&this._applyOnContextMenuBuildCallback(e.onContextMenuBuildCallback),this.isDirty("statusbarLabelsWidthRatios")&&this._applyStatusbarLabelsWidthRatios(e.statusbarLabelsWidthRatios),this.isDirty("statusbarIconsTooltips")&&this._applyStatusbarIconsTooltips(e.statusbarIconsTooltips),this.isDirty("onStatusbarIconPointerDown")&&this._applyOnStatusbarIconPointerDown(e.onStatusbarIconPointerDown),this.isDirty("activeFlag")&&this._applyActiveFlag(e.activeFlag),this.isDirty("color")&&this._applyColor(e.color),this.isDirty("customTooltip")&&this._applyCustomTooltip(e.customTooltip),this.elements.container.style.display=""},_postBuildView:function(){this._parent();var e=this;this.layoutingCollection||(s.onNodeRendered(this.getContent(),function(t){e._onViewResize(e._getViewWidth())}),this.getContent().addEvent("resize",function(){e._onViewResize()}))},_applyPicture:function(t){if(this.picture){this.elements.container.setAttribute("has-picture","true"),this.elements.picture.innerText&&(this.elements.picture.innerText="",this.elements.checkbox.inject(this.elements.picture));var i=!this.layoutingCollection||this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos,"picture");if(e.is(this.picture,"string"))this.elements.picture.setStyles({backgroundImage:"url("+this.picture+")"});else if(i){var n=this.picture.getContent?this.picture.getContent():this.picture;s.setContent(this.elements.picture,n,!0),!1!==this.picture.displayCheckbox&&this.elements.checkbox.inject(this.elements.picture)}}else this.elements.container.setAttribute("has-picture","false"),this.elements.picture.innerText="PLACE YOUR PNG PICTURE HERE",this.elements.checkbox.inject(this.elements.picture)},_applyViewWidth:function(e){this._getViewWidth()!==e&&this._getViewWidth()>=this._getViewMinWidth()&&(!this._getViewMaxWidth()||this._getViewWidth()<=this._getViewMaxWidth())&&(this.getContent().setStyle("width",this._getViewWidth().toString()+"px"),this._onViewResize(this._getViewWidth()))},_applyIcon:function(e){if(this.elements.icon.className="",this.elements.icon.addClassName("wux-controls-"+this.name.toLowerCase()+"-icon"),""===this.icon)return this.elements.container.setAttribute("has-icon","false"),this.elements.title.setAttribute("has-icon","false"),void this._applyTitle();this.icon&&(this.elements.container.setAttribute("has-icon","true"),this.elements.title.setAttribute("has-icon","true"),s.generateIcon(this.icon,{target:this.elements.icon}),this.elements.icon.show(),this._applyTitle())},_applyTitle:function(e){this._setTitle(this.title,this.elements.container.titleLineNumber),this._onViewResize(this._getViewWidth())},_applyClickableTitle:function(e){this.clickableTitle?this.elements.title.addClassName("wux-controls-responsiveview-clickable-title"):this.elements.title.removeClassName("wux-controls-responsiveview-clickable-title")},_setTitle:function(t,i){if(t){this.elements.realtitle=t;var n=!this.layoutingCollection||this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos,"title");if(1===i)this.elements.title.removeClassName("wux-controls-"+this._getViewCssClassSuffix()+"-multiple-line-title"),this.elements.title.layoutDsModel=this.layoutingCollection,e.is(t,"string")?s.setContent(this.elements.title,t,n):this.elements.title.setHTML(t),this.customTooltip||(this.layoutingCollection&&!1===this.layoutingCollection.displayTitleTooltip?this.tooltipInfos=null:this.tooltipInfos=this._CreateTooltipModel(t,n));else{var o=this._getTitleLineHeight(),l=t;"true"===this.elements.title.getAttribute("has-icon")&&(l="..W"+t);var a=null;(a=/<\/?[^>]*>/.test(t)?this._createEllipsisHTML({allowUnsafeHTMLContent:n,label:l,maxWidth:"auto",lineHeight:o,nbLinesVisible:i}):s.createEllipsisText({allowUnsafeHTMLLabel:n,label:l,maxWidth:"auto",lineHeight:o,nbLinesVisible:i})).style.wordBreak="break-word","true"===this.elements.title.getAttribute("has-icon")&&a.addClassName("wux-controls-"+this._getViewCssClassSuffix()+"-multiple-line-title");var r=this.elements.title.getAttribute("has-icon","true"),h=this.elements.title.getAttribute("has-menu","true");this.elements.titlebar.removeChild(this.elements.title),this.elements.title=a,this.elements.title.layoutDsModel=this.layoutingCollection,this.elements.title.contentView=this,s.addEventOnElement(this,this.elements.title,"click",this._onTitleClick),a.addClassName("wux-controls-"+this._getViewCssClassSuffix()+"-title"),this.elements.title.setAttribute("has-icon",r),this.elements.title.setAttribute("has-menu",h),this.clickableTitle&&this.elements.title.addClassName("wux-controls-responsiveview-clickable-title"),this.elements.titlebar.appendChild(a),this.layoutingCollection&&!0!==this.layoutingCollection.displayTitleTooltip||this.customTooltip||(this.tooltipInfos=this._CreateTooltipModel(t,n))}var u=i*(this._getTitleLineHeight()+2)+"px";this.elements.titlebar.setStyle("height",u),this.elements.title.setStyle("height",u)}else this.elements.realtitle=""},_applyMultipleTitleLineNumber:function(e){(!1===this.multipleTitleLineNumber||!0===this.multipleTitleLineNumber&&"false"===this.elements.propertiesList.getAttribute("has-propertiesList"))&&(this.elements.container.titleLineNumber=!1===this.multipleTitleLineNumber?1:2,this._onViewResize(this._getViewWidth()))},_applySubtitle:function(e){var t=this.subtitle;if(t){var i=!this.layoutingCollection||this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos,"subtitle");this.elements.subtitle.layoutDsModel=this.layoutingCollection,s.setContent(this.elements.subtitle,t,i),this.elements.subtitle.setAttribute("has-subtitle","true")}else this.elements.subtitle.setAttribute("has-subtitle","false");this._onViewResize(this._getViewWidth())},_applyDescription:function(e){this._setDescription(this.description,this.elements.container.descriptionLineNumber),this._onViewResize(this._getViewWidth())},_onTitleClick:function(e){if(this.contentView&&this.contentView.layoutingCollection){var t=this.contentView.layoutingCollection.getCellInfosFromHtmlElement(this);this.contentView.layoutingCollection._onCellTitleClick(t)}},_setDescription:function(e,t){if(!e)return this.elements.description.setAttribute("has-description","false"),this.elements.realdescription="",this._applyPropertiesList(),void("false"!==this.elements.subtitle.getAttribute("has-subtitle")&&"false"!==this.elements.propertiesList.getAttribute("has-propertiesList")&&(this.multipleTitleLineNumber=!1));this.elements.propertiesList.setAttribute("has-propertiesList","false"),this.elements.realdescription=e,1===t?this.elements.description.setAttribute("on-singleLine","true"):this.elements.description.setAttribute("on-singleLine","false");var i=this._getDescriptionLineHeight(),n=!this.layoutingCollection||this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos,"description"),o=s.createEllipsisText({allowUnsafeHTMLLabel:n,label:e,maxWidth:"auto",lineHeight:i,nbLinesVisible:t});this.elements.description.getParent()===this.elements.maincontent&&this.elements.maincontent.removeChild(this.elements.description),this.elements.description=o,this.elements.description.layoutDsModel=this.layoutingCollection,this.elements.description.setAttribute("has-description","true"),o.addClassName("wux-controls-"+this._getViewCssClassSuffix()+"-description"),this.elements.maincontent.appendChild(o)},_applyPropertiesList:function(t){this._propertiesArray||(this._propertiesArray=[]),this._propertiesSpacersArray||(this._propertiesSpacersArray=[]);var i=!this.layoutingCollection||this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos,"propertiesList");if(this.elements.propertiesList.setAttribute("has-propertiesList","false"),this.propertiesList){var n=this._propertiesArray.length,o=this.propertiesList.length,l=this.displayPropertiesTooltip;if(this.layoutingCollection&&(l=this.layoutingCollection.displayPropertiesTooltip),o>n)for(var a=n;a<o;a++){var r=new e.Element("div",{class:"wux-controls-"+this._getViewCssClassSuffix()+"-propertyDesc"});r.setStyle("display","none"),r.layoutDsModel=this.layoutingCollection,s.setContent(r,this.propertiesList[a],i),r.tooltipInfos=l?this._CreateTooltipModel(this.propertiesList[a],i):null,this._propertiesArray.push(r)}if(o>this._propertiesSpacersArray.length)for(a=this._propertiesSpacersArray.length;a<o;a++){var h=new e.Element("div",{class:"wux-controls-"+this._getViewCssClassSuffix()+"-propertyDesc-spacer"});h.setStyle("display","none"),this._propertiesSpacersArray.push(h)}for(a=n;a<o;a++)(a+1)%2==0?(this._propertiesArray[a].inject(this.elements.propertiesListSecondContainer),this._propertiesSpacersArray[a].inject(this.elements.propertiesListSecondContainer)):(this._propertiesArray[a].inject(this.elements.propertiesListFirstContainer),this._propertiesSpacersArray[a].inject(this.elements.propertiesListFirstContainer));if(this._propertiesArray&&this._propertiesArray.length)for(var u=0;u<this.propertiesList.length;u++)this._propertiesArray[u].setStyle("display","none");for(u=0;u<this.propertiesList.length;u++)this._propertiesArray[u].layoutDsModel=this.layoutingCollection,s.setContent(this._propertiesArray[u],this.propertiesList[u],i),l?this._propertiesArray[u].tooltipInfos?this._propertiesArray[u].tooltipInfos.shortHelp=this.propertiesList[u]:this._propertiesArray[u].tooltipInfos=this._CreateTooltipModel(this.propertiesList[u],i):this._propertiesArray[u].tooltipInfos=null}"false"===this.elements.description.getAttribute("has-description")?this.propertiesList&&this.propertiesList.length>0?(this.elements.description.setStyle("display","none"),this.elements.propertiesList.setAttribute("has-propertiesList","true"),"false"!==this.elements.subtitle.getAttribute("has-subtitle")&&(this.multipleTitleLineNumber=!1)):this.elements.description.setStyle("display","block"):(this.elements.propertiesList.setAttribute("has-propertiesList","false"),this.elements.description.setStyle("display","block")),this._onViewResize(this._getViewWidth())},_applyDisplayPropertiesTooltip:function(e){this._applyPropertiesList()},_applyContextualMenu:function(e){this.contextualMenu&&(this.contextualMenu.length||!0===this.contextualMenu)?(this.elements.title.setAttribute("has-menu","true"),this.elements.subtitle.setAttribute("has-menu","true"),this.elements.maincontent.setAttribute("has-menu","true"),this.elements.titlebar.setAttribute("has-menu","true"),this.elements.menu.setAttribute("has-menu","true"),this.elements.menu.list=this.contextualMenu):(this.elements.title.setAttribute("has-menu","false"),this.elements.subtitle.setAttribute("has-menu","false"),this.elements.titlebar.setAttribute("has-menu","false"),this.elements.maincontent.setAttribute("has-menu","false"),this.elements.menu.setAttribute("has-menu","false"))},_applyOnContextMenuBuildCallback:function(e){e&&this.elements.menu.removeEventListener(n.POINTERUP,e);var t=this;s.addEventOnElement(this,this.elements.menu,n.POINTERDOWN,function(e){if(t.layoutingCollection&&!n.isTouchEvent(e)){var i=t.layoutingCollection.getCellInfosFromHtmlElement(t.getContent());i.cellModel&&t.layoutingCollection.modelProvider.isNodeSelected(i.cellModel)&&e.stopPropagation()}}),s.addEventOnElement(this,this.elements.menu,"click",function(e){var i=t.layoutingCollection;if(n.isTouchEvent(e)&&i){var s=i.getCellInfosFromHtmlElement(t.getContent());if(s){var o=s.nodeModel;o&&!i.modelProvider.isNodeSelected(o)&&(i._cellUISelectionAction=!0,i.modelProvider.selectNode(o,!0),i._setActiveNode(o,!0),i._cellUISelectionAction=!1)}}var l=document.createEvent("HTMLEvents");l.initEvent("contextmenu",!0,!1),l.pageX=e.pageX,l.pageY=e.pageY,l.dispatchContext="menuClick",this.dispatchEvent(l),e.stopPropagation()}),o.addEventListener(t.elements.container,{callback:function(e){var i=e&&e.data?e.data.event:void 0;i&&i.stopPropagation();var n=t.layoutingCollection;if(n&&n.onContextualEvent){n._cellCtxMenuRequired=!0;var s=n.getCellInfosFromHtmlElement(t.getContent());if(s){var o=s.cellModel;t.disabled||!o||n.modelProvider.isNodeSelected(o)||(n._cellUISelectionAction=!0,n.modelProvider.selectNode(o,!0),n.setActiveNode(o,!0),n._cellUISelectionAction=!1)}var l=n.onContextualEvent;return l.callback.call(l.this,{context:t,infos:e.info,data:e.data,menu:t.contextualMenu,infoContext:e.context,cellInfos:n.getCellInfosFromHtmlElement(t.getContent())})}return t._setCtxMenuCB(e)}})},_applyEmptyStatusbarVisibleFlag:function(e){!0===this.emptyStatusbarVisibleFlag?(this.elements.statusbar.setAttribute("is-empty-statusbar-visible","true"),this.elements.container.setAttribute("is-empty-statusbar-visible","true")):!1===this.emptyStatusbarVisibleFlag&&(this.elements.statusbar.setAttribute("is-empty-statusbar-visible","false"),this.elements.container.setAttribute("is-empty-statusbar-visible","false"))},_applyStatusbarIcons:function(e){this.statusbarIcons&&this.statusbarIcons.length>8&&this.statusbarIcons.splice(8,this.statusbarIcons.length-8),this._displayAllStatusBarIcons()},_displayAllStatusBarIcons:function(){if(this.elements.statusbar.style.display="none",this._emptyAllStatusBarIcon(),this.statusbarIcons&&0!==this.statusbarIcons.length||this.badges&&0!==this.badges.length?(this.elements.container.setAttribute("has-statusbar-content","true"),this.elements.statusbar.setAttribute("has-statusbar-content","true")):(this.elements.container.setAttribute("has-statusbar-content","false"),this.elements.statusbar.setAttribute("has-statusbar-content","false")),this.statusbarIcons)for(var t=0;t<this.statusbarIcons.length;t++){var i=this.statusbarIcons[t],n=this._getFirstEmptyStatusBarIcon(),o="wux-controls-"+this._getViewCssClassSuffix()+"-label-statusbaricon";if(i&&n)if(e.is(i,"object")){var l=i.label?2*i.label.toString().length:0;new a({value:i.label,icon:i.icon,emphasize:i.emphasize,maxDisplayLength:l}).getContent().inject(n),n.addClassName(o)}else e.is(i,"string")&&(s.generateIcon(i,{target:n}),n.removeClassName(o))}if(this.badges){var r=this.statusbarIcons&&this.statusbarIcons.length?this.statusbarIcons.length:0,h=r+this.badges.length<8?r+this.badges.length:8;for(t=r;t<h;t++){i=this.badges[t-r],n=this._getFirstEmptyStatusBarIcon();i&&n&&s.generateIcon(i,{target:n})}}this.elements.statusbar.style.display="",this._onViewResize(this._getViewWidth())},_applyBadges:function(e){this._displayAllStatusBarIcons()},_applyStatusbarLabelsWidthRatios:function(e){this._updateStatusBarLayout()},_applyStatusbarIconsTooltips:function(e){var t;if(this.elements.statusbar.style.display="none",e)for(t=0;t<this.elements.statusbar.children.length;t++){(n=this.elements.statusbar.children[t])&&(n.tooltipInfos=null)}if(this.statusbarIconsTooltips){var i=!this.layoutingCollection||this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos,"statusbarIconsTooltips");for(t=0;t<this.statusbarIconsTooltips.length;t++){var n,s=void 0!==this.statusbarIconsTooltips[t]?this.statusbarIconsTooltips[t]:"";(n=this.elements.statusbar.children[t])&&(this.layoutingCollection&&!1===this.layoutingCollection.displayStatusbarTooltip?n.tooltipInfos=null:n.tooltipInfos=this._CreateTooltipModel(s,i))}}this.elements.statusbar.style.display=""},_applyOnStatusbarIconPointerDown:function(e){var t=this;e&&this.removeEventListener("StatusbarIconPointerDown",e),this.addEventListener("StatusbarIconPointerDown",function(e){var i=t.layoutingCollection;return i&&i.onStatusbarIconPointerDown?i.onStatusbarIconPointerDown.call(t,{cellInfos:i.getCellInfosFromHtmlElement(t.getContent()),clickedIconIndex:e.options?e.options.iconIndex:-1}):t.onStatusbarIconPointerDown?t.onStatusbarIconPointerDown.call(t,e):void 0})},_applyActiveFlag:function(){void 0!==this.activeFlag&&(!0===this.activeFlag?this.elements.container.setAttribute("active-mode","true"):!1===this.activeFlag&&this.elements.container.setAttribute("active-mode","false"))},_applyColor:function(){this.color&&"initial"!=this.color?(this.elements.color.setAttribute("has-color","true"),this.elements.color.setStyles({background:this.color}).show()):this.elements.color.setAttribute("has-color","false")},_applyCustomTooltip:function(e){var t=!this.layoutingCollection||this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos,"customTooltip");this.customTooltip!==e&&((this.customTooltip||e)&&this.customTooltip?this.tooltipInfos=this._CreateTooltipModel(this.customTooltip,t):this.layoutingCollection&&!1===this.layoutingCollection.displayTitleTooltip?this.tooltipInfos=null:this.tooltipInfos=this._CreateTooltipModel(this.title,t))},handleEvents:function(){var e=this;s.addEventOnElement(this,this.elements.container,"mouseenter",function(t){e.prehighlight()}),s.addEventOnElement(this,this.elements.container,"mouseleave",function(t){e.unPrehighlight()}),s.addEventOnElement(this,this.elements.checkbox,n.POINTERDOWN,function(t){e.layoutingCollection&&e.layoutingCollection._enableInteractiveMultiSelMode()})},prehighlight:function(){var e=this;e.isPreHighlighted||e.disabled||(e.elements.container.addClassName("wux-ui-state-prehighlighted"),e.checkbox.addClassName("wux-ui-state-prehighlighted"),e.elements.highlightBorder.addClassName("wux-ui-state-prehighlighted"),e.isPreHighlighted=!0)},unPrehighlight:function(){var e=this;e.isPreHighlighted&&!e.disabled&&(e.elements.container.removeClassName("wux-ui-state-prehighlighted"),e.checkbox.removeClassName("wux-ui-state-prehighlighted"),e.elements.highlightBorder.removeClassName("wux-ui-state-prehighlighted"),e.isPreHighlighted=!1)},isHighlighted:function(){return this._isHighlighted},highlight:function(){this.disabled||(this._isHighlighted=!0,this.elements.container.addClassName("wux-ui-state-highlighted"),this.elements.checkbox.addClassName("wux-ui-state-highlighted"),this.elements.highlightBorder.addClassName("wux-ui-state-highlighted"))},unhighlight:function(){this._isHighlighted&&(this._isHighlighted=!1,this.elements.container.removeClassName("wux-ui-state-highlighted"),this.elements.checkbox.removeClassName("wux-ui-state-highlighted"),this.elements.highlightBorder.removeClassName("wux-ui-state-highlighted"))},activate:function(){this.elements.container.addClassName("wux-ui-state-activated")},deactivate:function(){this.elements.container.removeClassName("wux-ui-state-activated")},setPictureBackgroundSize:function(e){this.elements.picture&&this.elements.picture.setStyle("background-size",e)},onStatusbarIconPointerDown:function(e){this._modelEvents.publish({event:"StatusbarIconPointerDown",context:this,data:this})},_setCtxMenuCB:function(e){var t=[];if(this.elements.menu.list&&this.elements.menu.list.length){var i=this.elements.menu.list;if(this.onContextMenuBuildCallback)t=this.onContextMenuBuildCallback.call(this,i);else for(var n=0;n<i.length;n++)t.push({type:"PushItem",title:i[n],action:{callback:function(e){alert("No action implemented on this context menu entry! Please implement onContextMenuBuildCallback callback!")}}}),n>=0&&n<i.length&&t.push({type:"SeparatorItem"})}return t},_onViewResize:function(i){if("false"===this.elements.description.getAttribute("has-description")&&"true"===this.elements.propertiesList.getAttribute("has-propertiesList")||this.elements.description.setStyle("display","block"),"true"===this.elements.propertiesList.getAttribute("has-propertiesList")){var n=0,s=0;if(this.layoutingCollection&&this.layoutingCollection.layout)n=this.layoutingCollection.layout._columnWidth-(97+("true"===this.elements.maincontent.getAttribute("has-menu")?40:10)),s="true"===this.elements.container.getAttribute("has-icon")?16:0;else{var o=window.getComputedStyle(this.elements.maincontent);n=parseInt(o.width,10);var l=window.getComputedStyle(this.elements.icon);s=parseInt(l.width,10)}var a=Math.max(0,Math.floor(n/175)),r=Math.floor(this._propertiesArray.length),h=Math.min(2*a,r);if(0===h&&(h=this._propertiesArray.length>=2?2:1===this._propertiesArray.length?1:0),0!==h){for(var u=((n-20*Math.round(h/2))/Math.round(h/2)).toString()+"px",c=0;c<h;c++)this._propertiesArray[c].setStyle("display","block"),this._propertiesArray[c].setStyle("width",u),this._propertiesSpacersArray[c].setStyle("display","block");for(c=h;c<this._propertiesArray.length;c++)this._propertiesArray[c].setStyle("display","none"),this._propertiesSpacersArray[c].setStyle("display","none")}else for(c=0;c<this._propertiesArray.length;c++)this._propertiesArray[c].setStyle("display","none"),this._propertiesSpacersArray[c].setStyle("display","none")}var d=this.elements.container.titleLineNumber,p=1;"false"===this.elements.subtitle.getAttribute("has-subtitle")&&"false"===this.elements.propertiesList.getAttribute("has-propertiesList")&&(!0===this.multipleTitleLineNumber?d++:0,p=0),"false"===this.elements.description.getAttribute("has-description")&&"false"===this.elements.propertiesList.getAttribute("has-propertiesList")&&(!0===this.multipleTitleLineNumber&&d++,0);var m=!this.layoutingCollection||this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos,"title"),g=e.createElement("div",{});t.getUnsafeHTMLContentValueToApply(m)?g.innerHTML=this.elements.realtitle:g.innerText=this.elements.realtitle;var v=document.createElement("canvas").getContext("2d");v.font="13px arial";var f=v.measureText(g.innerText).width;n=0,s=0;if(this.layoutingCollection&&this.layoutingCollection.layout)n=this.layoutingCollection.layout._columnWidth-(97+("true"===this.elements.maincontent.getAttribute("has-menu")?40:10)),s="true"===this.elements.container.getAttribute("has-icon")?16:0;else{o=window.getComputedStyle(this.elements.maincontent);n=parseInt(o.width,10);l=window.getComputedStyle(this.elements.icon);s=parseInt(l.width,10)}d>1&&f<n-s&&(d=1),this._setTitle(this.elements.realtitle,d),d>1?this.elements.title.setAttribute("on-singleLine","false"):this.elements.title.setAttribute("on-singleLine","true"),this.elements.realdescription?(this.elements.container.descriptionLineNumber=4-d-p,this._setDescription(this.elements.realdescription,4-d-p)):3===d&&this.elements.description.setStyle("display","none"),this._updateStatusBarLayout()},_createEllipsisHTML:function(i){if(1===(i=i||{maxWidth:"auto",lineHeight:18,nbLinesVisible:2,textAlign:"justify"}).nbLinesVisible){var n={class:"wux-button-label-ellipsis-nowrap",styles:{"max-width":i.maxWidth,"line-height":i.lineHeight+"px"}};return t.getUnsafeHTMLContentValueToApply(i.allowUnsafeHTMLContent)?n.html=i.label:n.text=i.label,new e.Element("div",n)}var o=i.nbLinesVisible||2,l=i.lineHeight,a={class:"wux-button-label-ellipsis-wrap",styles:{"text-align":i.textAlign,"max-width":i.maxWidth,"line-height":i.lineHeight+"px","max-height":i.lineHeight*o+"px"}};t.getUnsafeHTMLContentValueToApply(i.allowUnsafeHTMLContent)?a.html=i.label:a.text=i.label;var r=new e.Element("div",a);return s.onNodeRendered(r,function(){r.children.length;var t=null,i=0,n=0,s=null,a=null,h=null,u=[],c=0,d=0;r.getChildren().every(function(e,l){if(0!==n)u.push(e);else{var r=e.getPosition().y;e.getDimensions().height;r!==t&&(t=r,i++),i===o&&(n=l,a=e,h=s,c=e.getPosition().x,d=e.getPosition().y,s.getPosition().x,u.push(e))}return s=e,!0});var p=e.createElement("span",{styles:{overflow:"hidden","text-overflow":"ellipsis","white-space":"pre",display:"inline-block"}});c>0&&(p.setStyle("position","absolute"),h.setStyle("margin-right","3px"));var m=r.getDimensions().width-c-1;p.setStyle("width",m+"px"),r.insertBefore(p,a);for(var g=0;g<u.length;g++)r.removeChild(u[g]),u[g].setStyle("margin-right","3px"),p.appendChild(u[g]);var v=p.getPosition().y;if(Math.abs(v-d)>=l)p.setStyle("position","relative");else if(Math.abs(v-d)>=l-2){p.setStyle("position","absolute"),h.setStyle("margin-right","3px");var f=p.getPosition().x,y=r.getDimensions().width-f-1;p.setStyle("width",y+"px")}""===p.innerHTML&&p.setStyle("display","none")}),r},_getFirstEmptyStatusBarIcon:function(){var t=this;if(this._emptyStatusBarIcons.length>0){for(var i=0,o=1;o<this._emptyStatusBarIcons.length;o++)this._emptyStatusBarIcons[o]._index<this._emptyStatusBarIcons[i]._index&&(i=o);var l=this._emptyStatusBarIcons[i];return this._emptyStatusBarIcons.splice(i,1),l.setStyle("font-size","14px"),l}if(this.elements.statusbaricons.length<8){var a=new e.Element("div",{class:"wux-controls-"+this._getViewCssClassSuffix()+"-statusbaricon"});return a.setStyle("font-size","14px"),this.elements.statusbaricons.push(a),this.elements.statusbar.appendChild(a),a._index=this.elements.statusbaricons.length-1,s.addEventOnElement(this,a,n.POINTERDOWN,function(e){if(!t.disabled){let i="wux-controls-"+t._getViewCssClassSuffix()+"-statusbaricon",n=s.firstParentWithClass(e.target,i);t.fire("StatusbarIconPointerDown",{iconIndex:n._index}),e.stopPropagation()}}),a}},_emptyStatusBarIcon:function(e){-1===this._emptyStatusBarIcons.indexOf(e)&&(e.style="",e.className="wux-controls-"+this._getViewCssClassSuffix()+"-statusbaricon",s.empty(e),this._emptyStatusBarIcons.push(e))},_emptyAllStatusBarIcon:function(){for(var e=0;e<this.elements.statusbaricons.length;e++)this._emptyStatusBarIcon(this.elements.statusbaricons[e])},_getTitleLineHeight:function(){return 15},_getDescriptionLineHeight:function(){return 13},_CreateTooltipModel:function(e,t){var i=new l;if(e instanceof l)for(var n in e)i[n]=e[n];else i.shortHelp=e;return i.allowUnsafeHTMLTitle=t,i.allowUnsafeHTMLShortHelp=t,i.allowUnsafeHTMLLongHelp=t,i},_updateStatusBarLayout:function(){var e=!0;if(this.layoutingCollection&&-1===this.layoutingCollection._displayedOptionalCellProperties.indexOf("statusbarIcons")&&-1===this.layoutingCollection._displayedOptionalCellProperties.indexOf("All")&&(e=!1),e){var t=[],i=[],n=this._getStatusBarPaddings();if(this.statusbarIcons&&this.statusbarIcons.length)for(var o=0;o<this.statusbarIcons.length;o++){var l=this.elements.statusbaricons[o].children[0];l&&l.dsModel instanceof a?(t.push(l.dsModel),i.push(this.statusbarIcons[o].label),l.dsModel.icon&&(n+=this._getLabelIconWidth())):n+=this._getStatusBarIconWidth(),n+=this._getStatusBarItemsMargin()}if(this.badges&&this.badges.length)for(o=0;o<this.badges.length;o++)n+=this._getStatusBarIconWidth(),n+=this._getStatusBarItemsMargin();if(t.length){var r;if(this.layoutingCollection){if(r=this.layoutingCollection.layout._getColumnWidth(),1===this.layoutingCollection.layout._numberOfColumns){var h=this._getViewMaxWidth();void 0!==h&&r>h&&(r=h)}}else{var u=window.getComputedStyle(this.elements.container);r=parseInt(u.width,10),isNaN(r)&&(r=this._getViewWidth())}var c=r-n;if(c>0){var d=[],p=0,m=this.statusbarLabelsWidthRatios?this.statusbarLabelsWidthRatios.length:0;for(o=0;o<m;o++)p+=this.statusbarLabelsWidthRatios[o];if(Math.abs(p-1)>.1||t.length!==m)for(o=0;o<t.length;o++)d.push(1/t.length);else{!0;for(o=0;o<t.length;o++)d.push(this.statusbarLabelsWidthRatios[o])}for(o=0;o<t.length;o++){var g=d[o]*c,v=void 0!==i[o]?s.computeStringWidth(i[o],12,"Arial",!1,!1):0,f=0!==(v+=1.5*(i[o]?(i[o].match(/[A-Z]/g)||[]).length:0))?this._getLabelPaddings():0;if(t[o]._content){var y=Math.min(v+f,g);t[o]._content.style.width=y.toString()+"px",c=Math.max(c-y,0),d[o+1]+=d[o]}else o<t.length-1&&(c=Math.max(c-(v+f),0),d[o+1]+=d[o])}}}}},_getStatusBarPaddings:function(){return 8},_getLabelIconWidth:function(){return 16},_getStatusBarIconWidth:function(){return 14},_getStatusBarItemsMargin:function(){return 5},_getLabelPaddings:function(){return 10}})}),define("DS/Controls/ResponsiveThumbnailView",["UWA/Core","DS/Utilities/Utils","DS/Controls/ResponsiveViewAdaptor","DS/Core/PointerEvents","DS/Utilities/Dom","DS/CoreEvents/ModelEvents","DS/Menu/ContextualMenu","DS/Controls/TooltipModel","DS/Controls/ProgressBar"],function(e,t,i,n,s,o,l,a,r){"use strict";return i.inherit({name:"ResponsiveThumbnailView",markForRecordFlag:!0,publishedProperties:{thumbnailWidth:{defaultValue:200,type:"integer",category:"Behavior"},progressValueData:{defaultValue:void 0,type:"object",category:"Appearance"}},buildView:function(){this._modelEvents=new o,this._isHighlighted=!1;this.elements.container.addClassName("wux-controls-responsivethumbnailview"),this.elements.container.setAttribute("has-icon","false"),this.elements.container.setAttribute("active-mode","false"),this.elements.container.titleLineNumber=1,this.elements.container.descriptionLineNumber=2,this.elements.dndArea=e.createElement("div",{class:"wux-controls-responsivethumbnailview-dndarea"}).inject(this.elements.container),this.elements.highlightBorder=new e.Element("div",{class:"wux-controls-highlightborder"}).inject(this.elements.container),this.elements.activediv=new e.Element("div",{class:"wux-controls-activediv"}).inject(this.elements.container),this.elements.picture=new e.Element("div",{class:"wux-controls-responsivethumbnailview-picture"}).inject(this.elements.container),this.elements.color=new e.Element("div",{class:"wux-controls-responsivethumbnailview-color"}).inject(this.elements.picture),this.elements.color.setAttribute("has-color","false"),this.elements.checkbox=new e.Element("div",{class:"wux-controls-responsivethumbnailview-checkbox"}).inject(this.elements.picture),this.checkbox=this.elements.checkbox,this.elements.maincontent=new e.Element("div",{class:"wux-controls-responsivethumbnailview-maincontent"}).inject(this.elements.container),this.elements.maincontent.setAttribute("has-menu","false"),this.elements.titlebar=new e.Element("div",{class:"wux-controls-responsivethumbnailview-titlebar"}).inject(this.elements.maincontent),this.elements.icon=new e.Element("div",{class:"wux-controls-responsivethumbnailview-icon"}).inject(this.elements.titlebar),this.elements.title=new e.Element("div",{class:"wux-controls-responsivethumbnailview-title"}).inject(this.elements.titlebar),this.elements.title.contentView=this,s.addEventOnElement(this,this.elements.title,"click",this._onTitleClick),this.elements.title.setAttribute("has-menu","false"),this.elements.title.setAttribute("has-icon","false"),this.elements.subtitle=new e.Element("div",{class:"wux-controls-responsivethumbnailview-subtitle"}).inject(this.elements.maincontent),this.elements.subtitle.setAttribute("has-subtitle","false"),this.elements.subtitle.setAttribute("has-menu","false"),this.elements.mc_pb_separator=new e.Element("div",{class:"wux-controls-mc_desc_separator"}).inject(this.elements.container),this.elements.mc_pb_separator.setAttribute("has-progressBar","false"),this.elements.progressBar=(new r).inject(this.elements.container),this.elements.progressBar.getContent().addClassName("wux-controls-responsivethumbnailview-progressbar"),this.elements.progressBar.getContent().setAttribute("has-progressBar","false"),this.elements.progressBar.getContent().setAttribute("is-lite-display-style","false"),this.elements.progressBar.tooltipInfos=new a,this.elements.mc_desc_separator=new e.Element("div",{class:"wux-controls-mc_desc_separator"}).inject(this.elements.container),this.elements.description=new e.Element("div",{class:"wux-controls-responsivethumbnailview-description"}).inject(this.elements.container),this.elements.description.setAttribute("has-description","false"),this.elements.propertiesList=new e.Element("div",{class:"wux-controls-responsivethumbnailview-propertiesListContainer"}).inject(this.elements.container),this.elements.propertiesList.setAttribute("has-propertiesList","false");for(var t=0;t<13;t++)new e.Element("div",{class:"wux-controls-responsivethumbnailview-propertyDesc"}).inject(this.elements.propertiesList);this.elements.menu=new e.Element("div",{class:"wux-controls-responsivethumbnailview-menu"}).inject(this.elements.maincontent),this.elements.menu.setAttribute("has-menu","false"),this.elements.statusbar_separator=new e.Element("div",{class:"wux-controls-statusbar_separator"}).inject(this.elements.container),this.elements.statusbar=new e.Element("div",{class:"wux-controls-responsivethumbnailview-statusbar"}).inject(this.elements.container),this.elements.statusbar.setAttribute("has-statusbar-content","false"),this.elements.statusbar.setAttribute("is-empty-statusbar-visible","false"),this.elements.statusbaricons=[]},_applyProperties:function(e){this._parent(e),this.isDirty("thumbnailWidth")&&this._applyThumbnailWidth(e.thumbnailWidth),this.isDirty("progressValueData")&&this._applyProgressValueData(e.progressValueData)},_applyPicture:function(t){if(this.picture){this.elements.container.setAttribute("has-picture","true"),this.elements.picture.innerText&&(this.elements.picture.innerText="",this.elements.color.inject(this.elements.picture),this.elements.checkbox.inject(this.elements.picture));var i=!this.layoutingCollection||this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos,"picture");if(e.is(this.picture,"string"))this.elements.picture.setStyles({backgroundImage:"url("+this.picture+")"});else if(i){var n=this.picture.getContent?this.picture.getContent():this.picture;s.setContent(this.elements.picture,n,!0),!1!==this.picture.displayCheckbox&&this.elements.checkbox.inject(this.elements.picture)}}else this.elements.container.setAttribute("has-picture","false"),this.elements.picture.innerText="PLACE YOUR PNG PICTURE HERE",this.elements.color.inject(this.elements.picture),this.elements.checkbox.inject(this.elements.picture)},_applyThumbnailWidth:function(e){this._applyViewWidth(e)},_applyProgressValueData:function(t){t!==this.progressValueData&&(!this.layoutingCollection&&void 0!==this.progressValueData&&void 0!==this.progressValueData.progressValue||this.layoutingCollection&&!0===this.layoutingCollection.useProgressBar?(!e.is(this.progressValueData.progressValue,"number")||this.progressValueData.progressValue<0?console.warn("Warning, progressValue value must be number greater or equal than 0 because layout.useProgressBar is set to true."):(this.elements.progressBar.value=this.progressValueData.progressValue,this.progressValueData.emphasize&&(this.elements.progressBar.emphasize=this.progressValueData.emphasize),this.progressValueData.displayStyle&&(this.elements.progressBar.displayStyle=this.progressValueData.displayStyle,"lite"===this.progressValueData.displayStyle?this.elements.progressBar.getContent().setAttribute("is-lite-display-style","true"):this.elements.progressBar.getContent().setAttribute("is-lite-display-style","false")),this.progressValueData.tooltipInfos&&this.progressValueData.tooltipInfos.shortHelp&&(this.elements.progressBar.tooltipInfos.shortHelp=this.progressValueData.tooltipInfos.shortHelp),this.progressValueData.tooltipInfos&&this.progressValueData.tooltipInfos.longHelp&&(this.elements.progressBar.tooltipInfos.longHelp=this.progressValueData.tooltipInfos.longHelp),this.progressValueData.tooltipInfos&&this.progressValueData.tooltipInfos.shortHelpImage&&(this.elements.progressBar.tooltipInfos.shortHelpImage=this.progressValueData.tooltipInfos.shortHelpImage)),this.elements.mc_pb_separator.setAttribute("has-progressBar","true"),this.elements.progressBar.getContent().setAttribute("has-progressBar","true")):(this.elements.mc_pb_separator.setAttribute("has-progressBar","false"),this.elements.progressBar.getContent().setAttribute("has-progressBar","false")))},_applyMultipleTitleLineNumber:function(e){this.multipleTitleLineNumber&&(this.elements.container.titleLineNumber=!1===this.multipleTitleLineNumber?1:2,this._onViewResize())},_applyDescription:function(e){this.elements.mc_desc_separator.style.display="none",this._parent(),this._updateStatusBarSeparatorVisibility()},_setDescription:function(e,t){if(!e)return this.elements.description.setAttribute("has-description","false"),this.elements.realdescription="",void this._applyPropertiesList();this.elements.mc_desc_separator.style.display="",this.elements.propertiesList.setAttribute("has-propertiesList","false"),this.elements.realdescription=e,1===t?this.elements.description.setAttribute("on-singleLine","true"):this.elements.description.setAttribute("on-singleLine","false");var i=t;if(this.layoutingCollection&&this.layoutingCollection.layout){var n=this.layoutingCollection.getViewportDimensions(!0),o=Math.floor((n.width-(this.layoutingCollection.layout._numberOfColumns+1)*this.layoutingCollection.layout.gutter)/this.layoutingCollection.layout._numberOfColumns);o<150&&(o=150);var l=this.layoutingCollection.layout.getRowHeight()-(this.layoutingCollection._getPictureHeight()+this.layoutingCollection._getMainContentHeight()+this.layoutingCollection._getDescriptionBottomMargins()+("true"===this.elements.statusbar.getAttribute("has-statusbar-content")||!0===this.emptyStatusbarVisibleFlag?this.layoutingCollection._getStatusbarHeight():0)+(!0===this.layoutingCollection.useProgressBar?this.layoutingCollection._getProgressBarContainerHeight():0));i=Math.floor(l/13)}else{var a=window.getComputedStyle(this.elements.description),r=document.createElement("canvas").getContext("2d");r.font="11px arial";var h=0,u=r.measureText(this.elements.realdescription).width;""!==a.width?0!==(h=parseInt(a.width,10))&&(h-=28):h=this.thumbnailWidth,i=0,0!==h&&(i=Math.ceil((u/h).toPrecision(3))),0===i&&(i=1),++i>13&&(i=13),1===i?this.elements.description.setAttribute("on-singleLine","true"):this.elements.description.setAttribute("on-singleLine","false")}var c=this._getDescriptionLineHeight(),d=!this.layoutingCollection||this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos,"description"),p=s.createEllipsisText({allowUnsafeHTMLLabel:d,label:e,maxWidth:"auto",lineHeight:c,nbLinesVisible:i}),m=this.elements.description.getAttribute("on-singleLine");this.elements.container.removeChild(this.elements.description),this.elements.description=p,this.elements.description.layoutDsModel=this.layoutingCollection,this.elements.description.setAttribute("has-description","true"),this.elements.description.setAttribute("on-singleLine",m),this.elements.description.addClassName("wux-controls-responsivethumbnailview-description"),this.elements.container.insertBefore(p,this.elements.statusbar_separator),this._updateThumbnailHeightFromDescriptionOrProperties(i)},_applyPropertiesList:function(e){this.elements.mc_desc_separator.style.display="none";for(var t=0;t<this.elements.propertiesList.children.length;t++)this.elements.propertiesList.children[t].setStyle("display","none");var i=!this.layoutingCollection||this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos,"propertiesList"),n=window.getComputedStyle(this.elements.mc_desc_separator),o=parseInt(n.width,10).toString()+"px",l=this.displayPropertiesTooltip;this.layoutingCollection&&(l=this.layoutingCollection.displayPropertiesTooltip);var r=this.layoutingCollection?this.layoutingCollection.descriptionLinesNumber:13;if(this.propertiesList){this.propertiesList.length>0&&(this.elements.mc_desc_separator.style.display="");for(t=0;t<this.propertiesList.length&&t<r;t++){var h=this.elements.propertiesList.children[t];h.layoutDsModel=this.layoutingCollection,t===r-1&&this.propertiesList.length>r?s.setContent(h,"..."):s.setContent(h,this.propertiesList[t],i),l?h.tooltipInfos?h.tooltipInfos.shortHelp=this.propertiesList[t]:h.tooltipInfos=new a({shortHelp:this.propertiesList[t]}):h.tooltipInfos=null,""!==this.propertiesList[t]?(h.setStyle("display","block"),h.setStyle("width",o)):h.setStyle("display","none")}}"false"===this.elements.description.getAttribute("has-description")?(this.elements.description.setStyle("display","none"),this.propertiesList&&this.propertiesList.length>0?this.elements.propertiesList.setAttribute("has-propertiesList","true"):this.elements.propertiesList.setAttribute("has-propertiesList","false")):(this.elements.propertiesList.setAttribute("has-propertiesList","false"),this.elements.description.setStyle("display","block")),this._updateStatusBarSeparatorVisibility();var u=this.propertiesList?this.propertiesList.length:0;this._updateThumbnailHeightFromDescriptionOrProperties(Math.min(u,r))},_applyBadges:function(e){this._parent(e),this._updateStatusBarSeparatorVisibility()},_applyStatusbarIcons:function(e){this._parent(e),this._updateStatusBarSeparatorVisibility()},_updateStatusBarSeparatorVisibility:function(){this.elements.statusbar_separator.setAttribute("has-statusbar-content",this.elements.statusbar.getAttribute("has-statusbar-content")),"false"!==this.elements.statusbar.getAttribute("has-statusbar-content")||"true"!==this.elements.description.getAttribute("has-description")&&"true"!==this.elements.propertiesList.getAttribute("has-propertiesList")||this.elements.statusbar_separator.setAttribute("has-statusbar-content","true")},_getViewMinWidth:function(){return 150},_getViewMaxWidth:function(){return 420},_getViewWidth:function(){return this.thumbnailWidth},_onViewResize:function(){var i=this.elements.container.titleLineNumber,n=this.layoutingCollection?this.layoutingCollection.descriptionLinesNumber:10;"false"===this.elements.subtitle.getAttribute("has-subtitle")&&(!0===this.multipleTitleLineNumber&&i++,0);var s=!this.layoutingCollection||this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos,"title"),o=e.createElement("div",{});t.getUnsafeHTMLContentValueToApply(s)?o.innerHTML=this.elements.realtitle:o.innerText=this.elements.realtitle;var l=document.createElement("canvas").getContext("2d");l.font="13px arial";var a=l.measureText(o.innerText).width,r=window.getComputedStyle(this.elements.title),h=parseInt(r.width,10),u=window.getComputedStyle(this.elements.icon),c=parseInt(u.width,10);i>1&&a<h-c&&(i=1),this._setTitle(this.elements.realtitle,i),i>1?(this.elements.title.setAttribute("on-singleLine","false"),this.elements.subtitle.setAttribute("title-on-singleLine","false")):(this.elements.title.setAttribute("on-singleLine","true"),this.elements.subtitle.setAttribute("title-on-singleLine","true")),this.elements.realdescription||"false"===this.elements.description.getAttribute("has-description")?(this.elements.container.descriptionLineNumber=n,this._setDescription(this.elements.realdescription,n)):3===i&&this.elements.description.setStyle("display","none"),this._updateStatusBarLayout()},_getViewCssClassSuffix:function(){return"responsivethumbnailview"},_getStatusBarPaddings:function(){return 14},_getLabelIconWidth:function(){return 20},_updateThumbnailHeightFromDescriptionOrProperties:function(e){if(!this.layoutingCollection){var t=window.getComputedStyle(this.elements.container);if(t.width){var i=parseInt(t.width,10),n=e*this._getDescriptionLineHeight()+14,s=.75*i+70+(void 0!==this.progressValueData?44:0)+n+(this.statusbarIcons&&this.statusbarIcons.length>0||(!this.statusbarIcons||0===this.statusbarIcons.length)&&!0===this.emptyStatusbarVisibleFlag?28:0);this.elements.container.style.height=s.toString()+"px"}}}})}),define("DS/Controls/ResponsiveTileView",["UWA/Core","UWA/Controls/Abstract","DS/Controls/ResponsiveViewAdaptor","DS/Core/PointerEvents","DS/Utilities/Dom","DS/CoreEvents/ModelEvents","DS/Menu/ContextualMenu","DS/Controls/TooltipModel"],function(e,t,i,n,s,o,l,a){"use strict";return i.inherit({name:"ResponsiveTileView",markForRecordFlag:!0,publishedProperties:{tileWidth:{defaultValue:260,type:"integer",category:"Behavior"}},buildView:function(){this._modelEvents=new o,this._isHighlighted=!1,this.elements.container.addClassName("wux-controls-responsivetileview"),this.elements.container.setAttribute("has-picture","false"),this.elements.container.setAttribute("has-icon","false"),this.elements.container.setAttribute("has-statusbar-content","false"),this.elements.container.setAttribute("is-empty-statusbar-visible","false"),this.elements.container.setAttribute("active-mode","false"),this.elements.container.titleLineNumber=1,this.elements.container.descriptionLineNumber=2,this.elements.dndArea=e.createElement("div",{class:"wux-controls-responsivetileview-dndarea"}).inject(this.elements.container),this.elements.highlightBorder=new e.Element("div",{class:"wux-controls-highlightborder"}).inject(this.elements.container),this.elements.activediv=new e.Element("div",{class:"wux-controls-activediv"}).inject(this.elements.container),this.elements.color=new e.Element("div",{class:"wux-controls-responsivetileview-color"}).inject(this.elements.container),this.elements.color.setAttribute("has-color","false"),this.elements.picture=new e.Element("div",{class:"wux-controls-responsivetileview-picture"}).inject(this.elements.container),this.elements.checkbox=new e.Element("div",{class:"wux-controls-responsivetileview-checkbox"}).inject(this.elements.picture),this.checkbox=this.elements.checkbox,this.elements.maincontent=new e.Element("div",{class:"wux-controls-responsivetileview-maincontent"}).inject(this.elements.container),this.elements.maincontent.setAttribute("has-menu","false"),this.elements.titlebar=new e.Element("div",{class:"wux-controls-responsivetileview-titlebar"}).inject(this.elements.maincontent),this.elements.icon=new e.Element("div",{class:"wux-controls-responsivetileview-icon"}).inject(this.elements.titlebar),this.elements.title=new e.Element("div",{class:"wux-controls-responsivetileview-title"}).inject(this.elements.titlebar),this.elements.title.contentView=this,s.addEventOnElement(this,this.elements.title,"click",this._onTitleClick),this.elements.title.setAttribute("has-menu","false"),this.elements.title.setAttribute("has-icon","false"),this.elements.subtitle=new e.Element("div",{class:"wux-controls-responsivetileview-subtitle"}).inject(this.elements.maincontent),this.elements.subtitle.setAttribute("has-subtitle","false"),this.elements.description=new e.Element("div",{class:"wux-controls-responsivetileview-description"}).inject(this.elements.maincontent),this.elements.description.setAttribute("has-description","false"),this.elements.propertiesList=new e.Element("div",{class:"wux-controls-responsivetileview-propertiesListContainer"}).inject(this.elements.maincontent),this.elements.propertiesList.setAttribute("has-propertiesList","false"),this.elements.propertiesListFirstContainer=new e.Element("div",{class:"wux-controls-responsivetileview-propertyChildContainer"}).inject(this.elements.propertiesList),this.elements.propertiesListFirstContainer.setAttribute("has-large-style","false"),this.elements.propertiesListSecondContainer=new e.Element("div",{class:"wux-controls-responsivetileview-propertyChildContainer"}).inject(this.elements.propertiesList),this.elements.propertiesListSecondContainer.setAttribute("has-large-style","false"),this.elements.menu=new e.Element("div",{class:"wux-controls-responsivetileview-menu"}).inject(this.elements.container),this.elements.menu.responsiveTileView=this,this.elements.menu.setAttribute("has-menu","false"),this.elements.statusbar=new e.Element("div",{class:"wux-controls-responsivetileview-statusbar"}).inject(this.elements.container),this.elements.statusbar.setAttribute("has-statusbar-content","false"),this.elements.statusbar.setAttribute("is-empty-statusbar-visible","false"),this.elements.statusbaricons=[]},_applyProperties:function(e){this._parent(e),this.isDirty("tileWidth")&&this._applyTileWidth(e.tileWidth)},_applyTileWidth:function(e){this._applyViewWidth(e)},_getViewMinWidth:function(){return 260},_getViewMaxWidth:function(){if(!this.layoutingCollection||"wux-cell-responsivelargetile"!==this.layoutingCollection.cellStyleOverload)return 540},_getViewWidth:function(){return this.tileWidth},_onTileResize:function(e){this._onViewResize(this.tileWidth)},_getViewCssClassSuffix:function(){return"responsivetileview"}})}),define("DS/Controls/ResponsiveTextualTileView",["UWA/Core","UWA/Controls/Abstract","DS/Controls/ResponsiveTileView","DS/Core/PointerEvents","DS/Utilities/Dom","DS/CoreEvents/ModelEvents","DS/Menu/ContextualMenu","DS/Controls/TooltipModel"],function(e,t,i,n,s,o,l,a){"use strict";return i.inherit({name:"ResponsiveTextualTileView",markForRecordFlag:!0,buildView:function(){this._modelEvents=new o,this._isHighlighted=!1;this.elements.container=new e.Element("div",{class:"wux-controls-responsivetextualtileview"}),this.elements.container.setAttribute("has-picture","false"),this.elements.container.setAttribute("has-icon","false"),this.elements.container.setAttribute("has-statusbar-content","false"),this.elements.container.setAttribute("is-empty-statusbar-visible","false"),this.elements.container.setAttribute("active-mode","false"),this.elements.container.titleLineNumber=1,this.elements.container.descriptionLineNumber=2,this.elements.highlightBorder=new e.Element("div",{class:"wux-controls-highlightborder"}).inject(this.elements.container),this.elements.activediv=new e.Element("div",{class:"wux-controls-activediv"}).inject(this.elements.container),this.elements.color=new e.Element("div",{class:"wux-controls-responsivetextualtileview-color"}).inject(this.elements.container),this.elements.color.setAttribute("has-color","false"),this.elements.picture=new e.Element("div",{class:"wux-controls-responsivetextualtileview-picture"}).inject(this.elements.container),this.elements.pictureplaceholder=new e.Element("div",{class:"wux-controls-responsivetextualtileview-pictureplaceholder",html:"PLACE YOUR PNG PICTURE HERE"}).inject(this.elements.picture),this.elements.checkbox=new e.Element("div",{class:"wux-controls-responsivetextualtileview-checkbox"}).inject(this.elements.picture),this.checkbox=this.elements.checkbox,this.elements.titlebar=new e.Element("div",{class:"wux-controls-responsivetextualtileview-titlebar"}).inject(this.elements.container),this.elements.maincontent=new e.Element("div",{class:"wux-controls-responsivetextualtileview-maincontent"}).inject(this.elements.container),this.elements.maincontent.setAttribute("has-menu","false"),this.elements.icon=new e.Element("div",{class:"wux-controls-responsivetextualtileview-icon"}).inject(this.elements.titlebar),this.elements.title=new e.Element("div",{class:"wux-controls-responsivetextualtileview-title"}).inject(this.elements.titlebar),this.elements.title.contentView=this,s.addEventOnElement(this,this.elements.title,"click",this._onTitleClick),this.elements.title.setAttribute("has-menu","false"),this.elements.title.setAttribute("has-icon","false"),this.elements.subtitle=new e.Element("div",{class:"wux-controls-responsivetextualtileview-subtitle"}).inject(this.elements.maincontent),this.elements.subtitle.setAttribute("has-subtitle","false"),this.elements.description=new e.Element("div",{class:"wux-controls-responsivetextualtileview-description"}).inject(this.elements.maincontent),this.elements.description.setAttribute("has-description","false"),this.elements.propertiesList=new e.Element("div",{class:"wux-controls-responsivetextualtileview-propertiesListContainer"}).inject(this.elements.maincontent),this.elements.propertiesList.setAttribute("has-propertiesList","false"),this.elements.propertiesListFirstContainer=new e.Element("div",{class:"wux-controls-responsivetextualtileview-propertyChildContainer"}).inject(this.elements.propertiesList),this.elements.propertiesListFirstContainer.setAttribute("has-large-style","false"),this.elements.propertiesListSecondContainer=new e.Element("div",{class:"wux-controls-responsivetextualtileview-propertyChildContainer"}).inject(this.elements.propertiesList),this.elements.propertiesListSecondContainer.setAttribute("has-large-style","false"),this.elements.menu=new e.Element("div",{class:"wux-controls-responsivetextualtileview-menu"}).inject(this.elements.container),this.elements.menu.responsiveTileView=this,this.elements.menu.setAttribute("has-menu","false"),this.elements.statusbar=new e.Element("div",{class:"wux-controls-responsivetextualtileview-statusbar"}).inject(this.elements.container),this.elements.statusbar.setAttribute("has-statusbar-content","false"),this.elements.statusbar.setAttribute("is-empty-statusbar-visible","false"),this.elements.statusbaricons=[]},_applyMultipleTitleLineNumber:function(e){this.elements.container.titleLineNumber=1},_getTitleLineHeight:function(){return 22},_getDescriptionLineHeight:function(){return 19},_getViewCssClassSuffix:function(){return"responsivetextualtileview"}})});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/Expander",["require","exports","UWA/Core","DS/Controls/Abstract","DS/Utilities/Dom","DS/Core/PointerEvents","DS/WebRecordEnabler/Adapter","DS/WebRecordBase/Constants","DS/Utilities/Utils","DS/Core/WebUXComponents","DS/Utilities/WUXUWAUtils"],function(e,t,i,n,s,o,l,a,r,h,u){"use strict";var c="wux-controls-expander";function d(){var e=2;return this._getCurrentTouchMode()?(e+=38,this.elements.icon&&(e+=19)):(e+=26,this.elements.icon&&(e+=17)),e}function p(){return this._getCurrentTouchMode()?38:26}function m(e){var t=this.getContent(),i=e.target,n=!1,s=this.elements&&this.elements.header,o=this.elements&&this.elements.customHeader;if(t&&s&&i){for(;i&&i!==o&&i!==t;){if(i===s){n=!0;break}i=i.parentNode}return n}}var g=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return u.extendingClassFlag?n:(n.addKeyMapsAndCommands({space:{keydown:"consume",keyup:"toggle"}},{consume:function(){},toggle:function(e){m.call(this,e)&&this.toggle()}}),n)}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{header:{defaultValue:"",type:"string",category:"Appearance"},body:{defaultValue:void 0,type:"HTMLElement",category:"Behavior"},expandedFlag:{defaultValue:!1,type:"boolean",category:"Appearance",recordFlag:!0},style:{defaultValue:"filled-separate",type:"string",category:"Appearance"},icon:{defaultValue:"",type:"object",category:"Appearance"},height:{defaultValue:"auto",type:"string",category:"Appearance"},orientation:{defaultValue:"vertical",type:"string",category:"Behavior"},customHeader:{defaultValue:void 0,type:"object",category:"Behavior"},allowUnsafeHTMLHeader:{defaultValue:void 0,type:"boolean",category:"Behavior"},noContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){this.elements.container.addClassName(c+"-placeholder"),this.elements.container.addClassName(c),l.setElementRecordMode(this.elements.container,a.RecordModes.DEFAULT_AND_CHILD),this.elements.expanderContainer=new i.Element("div",{class:c+"-container"}).inject(this.elements.container),this.elements.header=new i.Element("div",{class:c+"-header",tabindex:0}).inject(this.elements.expanderContainer),this.elements.headerArrow=new i.Element("div",{class:c+"-arrow wux-ui-3ds wux-ui-3ds-expand-down"}).inject(this.elements.header),this.elements.iconPlaceholder=new i.Element("div",{class:"wux-expander-icon-placeholder"}).inject(this.elements.header),this.elements.headerContainer=new i.Element("div",{class:c+"-header-container"}).inject(this.elements.header),this.elements.bodyContainer=new i.Element("div",{class:c+"-body"}).inject(this.elements.expanderContainer)},t.prototype.handleEvents=function(){var e=this;s.addEventOnElement(this,this.elements.header,"blur",function(t){e.getContent().removeClassName("wux-isMouseFocused")}),s.addEventOnElement(this,this.elements.header,o.POINTERHIT,function(t){t.preventDefault(),m.call(e,t)&&(e.getContent().addClassName("wux-isMouseFocused"),e.setPropertyFromUIInteraction("expandedFlag",!e.expandedFlag))}),s.addEventOnElement(this,this.elements.bodyContainer,"transitionend",function(t){e.fire("dimensionsChanged")})},t.prototype._applyExpandedFlag=function(e){e&&e==this.expandedFlag||(!0===this.expandedFlag?this._expand():this._close()),"100%"===this.height&&this.expandedFlag?this.elements.expanderContainer.setStyle("height","100%"):this.elements.expanderContainer.setStyle("height","")},t.prototype._applyDisabled=function(){e.prototype._applyDisabled.call(this),this.disabled?(this.elements.header.tabIndex=-1,this.elements.contentDisabler||(this.elements.contentDisabler=r.createContentDisablerDiv()),this.elements.bodyContainer.appendChild(this.elements.contentDisabler),this.customHeader&&(this.elements.customHeaderDisabler||(this.elements.customHeaderDisabler=r.createContentDisablerDiv()),this.elements.customHeader.appendChild(this.elements.customHeaderDisabler))):(this.elements.header.tabIndex=0,this.elements.contentDisabler&&this.elements.contentDisabler.remove(),this.elements.customHeaderDisabler&&this.elements.customHeaderDisabler.remove())},t.prototype._applyHeader=function(){if(r.getUnsafeHTMLContentValueToApply(this.allowUnsafeHTMLHeader))this.elements.headerContainer.innerHTML='<h5 class="headerTitle" >'+this.header+" </h5> ";else{this.elements.headerContainer.innerHTML="";var e=new i.Element("h5",{class:"headerTitle"});e.textContent=this.header,e.inject(this.elements.headerContainer)}},t.prototype._applyBody=function(e){this.body&&this.elements.bodyContainer&&(e&&e.remove(),i.is(this.body,"element")&&(this.body=new i.extendElement(this.body)),this.body.inject(this.elements.bodyContainer))},t.prototype._applyTouchMode=function(){e.prototype._applyTouchMode.call(this),!0===this._getCurrentTouchMode()?(this.elements.header.setAttributeNode(document.createAttribute("touch-mode")),this.elements.headerContainer.setAttributeNode(document.createAttribute("touch-mode")),this.elements.headerArrow.setAttributeNode(document.createAttribute("touch-mode")),this.elements.bodyContainer.setAttributeNode(document.createAttribute("touch-mode")),this.elements.iconPlaceholder.setAttributeNode(document.createAttribute("touch-mode"))):(this.elements.header.removeAttribute("touch-mode"),this.elements.headerArrow.removeAttribute("touch-mode"),this.elements.headerContainer.removeAttribute("touch-mode"),this.elements.bodyContainer.removeAttribute("touch-mode"),this.elements.iconPlaceholder.removeAttribute("touch-mode"))},t.prototype._applyStyle=function(e){e&&this.elements.expanderContainer.removeClassName(c+"-"+e),this.elements.expanderContainer.addClassName(c+"-"+this.style),"mode-selector"===this.style&&(this.elements.iconPlaceholder.inject(this.elements.headerArrow,"before"),this.elements.headerContainer.inject(this.elements.iconPlaceholder,"before"))},t.prototype._applyOrientation=function(e){"horizontal"===this.orientation?(this.elements.expanderContainer.setAttributeNode(document.createAttribute("horizontal")),this.elements.bodyContainer.setAttributeNode(document.createAttribute("horizontal")),this.elements.headerContainer.setAttributeNode(document.createAttribute("horizontal")),this.elements.header.setAttributeNode(document.createAttribute("horizontal")),this.expandedFlag&&("mode-selector"!==this.style?(this.elements.headerArrow.addClassName("wux-ui-3ds-expand-left"),this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-down")):(this.elements.headerArrow.addClassName("wux-ui-3ds-expand-up"),this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-down"))),this.elements.bodyContainer.style.maxWidth="calc(100% - "+(20+d.call(this))+"px)",this.elements.bodyContainer.style.maxHeight=""):(this.elements.expanderContainer.removeAttribute("horizontal"),this.elements.bodyContainer.removeAttribute("horizontal"),this.elements.headerContainer.removeAttribute("horizontal"),this.elements.header.removeAttribute("horizontal"),this.expandedFlag&&("mode-selector"!==this.style?(this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-left"),this.elements.headerArrow.addClassName("wux-ui-3ds-expand-down")):(this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-down"),this.elements.headerArrow.addClassName("wux-ui-3ds-expand-up"))),this.elements.bodyContainer.style.maxWidth=""),this._applyHeight(e)},t.prototype._applyHeight=function(e){"auto"===this.height&&"horizontal"===this.orientation?this.elements.container.setStyles({position:"absolute",height:"auto",top:0,bottom:0}):this.elements.container.setStyles({position:"",height:this.height}),"vertical"===this.orientation&&("100%"===this.height?(this.elements.bodyContainer.style.maxHeight="calc( 100% - "+(20+p.call(this))+"px)",this._applyExpandedFlag(e)):this.elements.bodyContainer.style.maxHeight="calc("+parseInt(this.height)+"px - "+(20+p.call(this))+"px)")},t.prototype._applyIcon=function(e){"object"==typeof this.icon&&this.icon&&(this.icon.iconClasses||(this.icon.iconClasses=""),this.icon.iconName||(this.icon.iconName=""),this.icon.fontIconFamily||(this.icon.fontIconFamily=WUXManagedFontIcons.FontAwesome),this.icon.fontIconSize||(this.icon.fontIconSize="1x")),function(){this.elements.icon&&(this.elements.icon.remove(this.elements.iconPlaceholder),delete this.elements.icon);var e=s.generateIcon(this.icon);e?(this.elements.icon=e,this.elements.iconPlaceholder.show(),this.elements.icon.style.pointerEvents="none",this.elements.icon.style.margin="0px",this.elements.icon.inject(this.elements.iconPlaceholder)):this.elements.iconPlaceholder.hide()}.call(this),"horizontal"===this.orientation&&(this.elements.bodyContainer.style.maxWidth="calc(100% - "+d.call(this)+"px)")},t.prototype._applyCustomHeader=function(e){this.elements.customHeader&&this.elements.customHeader.remove(e),this.customHeader&&(this.elements.customHeader||(this.elements.customHeader=new i.Element("div",{class:c+"-customHeader"}).inject(this.elements.header)),this.customHeader.inject(this.elements.customHeader))},t.prototype._applyAllowUnsafeHTMLHeader=function(){this._applyHeader()},t.prototype._applyProperties=function(t){this.isDirty("customHeader")&&this._applyCustomHeader(t.customHeader),e.prototype._applyProperties.call(this,t),this.isDirty("expandedFlag")&&this._applyExpandedFlag(t.expandedFlag),(this.isDirty("header")||this.isDirty("allowUnsafeHTMLHeader"))&&this._applyHeader(),this.isDirty("body")&&this._applyBody(t.body),this.isDirty("style")&&this._applyStyle(t.style),this.isDirty("icon")&&this._applyIcon(t.icon),this.isDirty("orientation")&&this._applyOrientation(t.orientation)},t.prototype._expand=function(){this.elements.header.setAttributeNode(document.createAttribute("expanded")),this.elements.expanderContainer.addClassName(c+"-toggle"),this.elements.bodyContainer.addClassName(c+"-body-toggle"),"mode-selector"!==this.style?(this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-right"),"horizontal"===this.orientation?this.elements.headerArrow.addClassName("wux-ui-3ds-expand-left"):this.elements.headerArrow.addClassName("wux-ui-3ds-expand-down")):(this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-down"),this.elements.headerArrow.addClassName("wux-ui-3ds-expand-up")),this.elements.bodyContainer.style.overflow="",this.fire("expand")},t.prototype._close=function(){this.elements.header.removeAttribute("expanded"),this.elements.expanderContainer.removeClassName(c+"-toggle"),this.elements.bodyContainer.removeClassName(c+"-body-toggle"),"mode-selector"!==this.style?(this.elements.headerArrow.addClassName("wux-ui-3ds-expand-right"),this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-down"),this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-left")):(this.elements.headerArrow.addClassName("wux-ui-3ds-expand-down"),this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-up")),this.elements.bodyContainer.style.overflow="hidden",this.fire("collapse")},t.prototype.expand=function(){this.expandedFlag=!0},t.prototype.close=function(){this.expandedFlag=!1},t.prototype.toggle=function(){!0===this.expandedFlag?this.close():this.expand()},t.prototype._getCustomContent=function(){var e,t,i=[];return(null===(e=null==this?void 0:this.elements)||void 0===e?void 0:e.customHeader)&&i.push(this.elements.customHeader),(null===(t=null==this?void 0:this.elements)||void 0===t?void 0:t.bodyContainer)&&i.push(this.elements.bodyContainer),i},t}(n);return g.prototype.markForRecordFlag=!0,l.register(g,"DS/ControlsRec/AbstractRec"),h.addClass(g,"expander"),g});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/Accordeon",["require","exports","DS/Controls/Abstract","DS/Controls/Expander","DS/Utilities/Dom","DS/Core/WebUXComponents"],function(e,t,i,n,s,o){"use strict";var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{items:{defaultValue:[],type:"array",category:"Behavior"},exclusive:{defaultValue:!0,type:"boolean",category:"Behavior"},collapsibleFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},style:{defaultValue:"filled-separate",type:"string",category:"Appearance"},noContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){this.elements.container.addClassName("wux-controls-accordeon-container"),this._expanderItems=[]},t.prototype.handleEvents=function(){var e=this;function t(t){t.dsModel!==e&&(t.stopImmediatePropagation(),t.dsModel&&e._expanderItems.every(function(i,n){return i!==t.dsModel||(e.fire(t.type,{expanderIndex:n,expanderTarget:i}),!1)}))}this.addEventListener("expand",t),this.addEventListener("collapse",t)},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("items")&&this._applyItems(),this.isDirty("style")&&this._applyStyle()},t.prototype._applyTouchMode=function(){var e=this._getCurrentTouchMode();!0===e?this.getContent().setAttributeNode(document.createAttribute("touch-mode")):this.getContent().removeAttribute("touch-mode");for(var t=0;t<this._expanderItems.length;t++)this._expanderItems[t].touchMode=e},t.prototype._applyDisabled=function(){for(var e=0;e<this._expanderItems.length;e++)this._expanderItems[e].disabled=this.disabled},t.prototype._applyItems=function(){for(var e=this,t=e._expanderItems.length;t>=0;t--)this._expanderItems[t]&&this._expanderItems[t].remove(),this._expanderItems.splice(t,1);e.items.forEach(function(t){e._addItem(t)})},t.prototype._applyExclusive=function(){if(this.exclusive)for(var e=null,t=0;t<this._expanderItems.length;t++){var i=this._expanderItems[t];i&&i.expandedFlag&&(e&&i!==e?i.close():e=i)}},t.prototype._applyCollapsibleFlag=function(){if(!this.collapsibleFlag&&this._areAllCollapsed()){var e=this._expanderItems[0];e&&e.expand()}},t.prototype._applyStyle=function(){for(var e=0;e<this._expanderItems.length;e++)this._expanderItems[e].style=this.style},t.prototype.addItem=function(e){return this.items.push(e),this._addItem(e)},t.prototype._areAllCollapsed=function(){for(var e=!0,t=0;t<this._expanderItems.length;t++){var i=this._expanderItems[t];if(i&&i.expandedFlag){e=!1;break}}return e},t.prototype._addItem=function(e){this.elements.expander=new n({header:e.header,body:e.body?e.body:e.content,icon:e.icon,customHeader:e.customHeader,style:this.style,recId:e.recId,touchMode:this._getCurrentTouchMode()}).inject(this.elements.container);var t=this._getFirstUnusedID();this.elements.expander._expanderId=t,this.elements.expander.elements.container.attributes.identifier=t,this._expanderItems.push(this.elements.expander);var i=this;return s.addEventOnElement(this,this.elements.expander,"expand",function(e){if(i.exclusive)for(var t=0;t<i._expanderItems.length;t++){var n=i._expanderItems[t];n&&n.expandedFlag&&n!==this&&n.close()}}),s.addEventOnElement(this,this.elements.expander,"collapse",function(e){i.collapsibleFlag||i._areAllCollapsed()&&this.expand()}),e.expandedFlag&&this.expandItem(this.getIndexFromId(t)),t},t.prototype.deleteItem=function(e){this._expanderItems[e]&&this._expanderItems[e].remove(),this._expanderItems.splice(e,1),this.items.splice(e,1)},t.prototype._getFirstUnusedID=function(){for(var e=[],t=0;t<this._expanderItems.length;t++)e[this._expanderItems[t]._expanderId]=1;for(var i=0;i<e.length;i++)if(1!==e[i])return i;return e.length},t.prototype.updateItem=function(e,t){var i=this.items[e];i&&(i.header=t.header||i.header,i.body=t.body||i.body,i.icon=t.icon||i.icon,i.customHeader=t.customHeader||i.customHeader);var n=this._expanderItems[e];n&&n.setProperties(i)},t.prototype.expandItem=function(e){if(this.exclusive)for(var t=0;t<this._expanderItems.length;t++)e!=t&&!0===this._expanderItems[t].expandedFlag&&this._expanderItems[t].close();this._expanderItems[e].expand()},t.prototype.closeItem=function(e){this._expanderItems[e].close()},t.prototype.clear=function(){for(;this.items.length>0;)this.deleteItem(0)},t.prototype.getIndexFromId=function(e){for(var t=0;t<this._expanderItems.length;t++)if(this._expanderItems[t]._expanderId===e)return t;return-1},t.prototype.getIndexFrom=function(e){if(void 0!==e.id)return this.getIndexFromId(e.id);var t=void 0!==e.header?"header":void 0!==e.body?"body":void 0!==e.content?"body":void 0;if(t)for(var i=0;i<this._expanderItems.length;i++)if(this._expanderItems[i][t]===e[t])return i;return-1},t.prototype.getExpanderFromIndex=function(e){return this._expanderItems[e]},t}(i);return o.addClass(l,"accordeon"),l}),define("DS/Controls/ThumbnailView",["UWA/Core","UWA/Controls/Abstract","DS/Layouts/GridEngineCellAbstract","DS/Controls/ViewBase","DS/Menu/ContextualMenu","DS/Core/PointerEvents","DS/Controls/Toggle","DS/Utilities/Dom"],function(e,t,i,n,s,o,l,a){"use strict";return n.extend({defaultOptions:{size:"small",view:"thumbnail",menu:[]},init:function(t){this._parent(t);var i,n=this,a=!1,r=!1;this._isHighlighted=!1,this.elements.icon=new e.Element("div",{class:"wux-controls-"+this.options.view+"-icon",styles:{backgroundImage:"",backgroundSize:"cover"}}).inject(this.elements.cartoucheContent),this.elements.badgeTopRight=new e.Element("div",{class:"wux-controls-thumbnail-badge-top-right"}).inject(this.elements.cartoucheContent),this.elements.badgeBottomRight=new e.Element("div",{class:"wux-controls-thumbnail-badge-bottom-right"}).inject(this.elements.cartoucheContent),this.elements.menu.addEvent("mouseenter",function(e){a=!0}),this.elements.menu.addEvent("mouseleave",function(e){a=!1}),this.elements.cartouche.addEvent("mouseenter",function(e){r=!0}),this.elements.cartouche.addEvent("mouseleave",function(e){r=!1,n.elements.container.removeClassName("wux-ui-state-active")}),this.elements.cartouche.addEvent("mousemove",function(e){clearTimeout(i),e.target===n.elements.menu||n.elements.container.hasClassName("wux-ui-state-active")||n.elements.container.removeClassName("wux-ui-state-active"),i=setTimeout(function(){a||(r&&e.target!==n.elements.menu?n.elements.container.addClassName("wux-ui-state-active"):(clearTimeout(i),n.elements.container.removeClassName("wux-ui-state-active")))},20)}),this.elements.checkbox=new l({checkFlag:!1,disabled:!1}).inject(this.elements.picture),this.elements.checkbox.getContent().addClassName("wux-controls-thumbnail-checkbox wux-ui-size-"+this.options.size);n=this;if(this.elements.container.addEvent("mouseenter",function(e){n.isPreHighlighted||(n.elements.checkbox.getContent().addClassName("wux-ui-state-prehighlighted"),n.isPreHighlighted=!0)}),this.elements.container.addEvent("mouseleave",function(e){n.isPreHighlighted&&(n.elements.checkbox.getContent().removeClassName("wux-ui-state-prehighlighted"),n.isPreHighlighted=!1)}),this.elements.checkbox.addEventListener(o.POINTERDOWN,function(e){e.stopPropagation()}),this.elements.checkbox.addEventListener(o.POINTERUP,function(e){e.stopPropagation()}),this._listenToChanges=!0,this.elements.checkbox.addEventListener("change",function(e){n._listenToChanges&&(n.isHighlighted()?n.unhighlight():n.highlight())}),!t||!t.gridEngine){var h=this.options.onContextualEvent;if(h){s.addEventListener(this.elements.container,{callback:function(e){return h.callback.call(h.this,{context:e.context,infos:e.info,data:e.data})}});var u=this.elements.menu;this.elements.menu.addEventListener(o.POINTERUP,function(e){var t=document.createEvent("HTMLEvents");t.initEvent("contextmenu",!0,!1),t.pageX=e.pageX,t.pageY=e.pageY,u.dispatchEvent(t)})}}this._attachEvents()},setIcon:function(e){this.elements.icon.className="",this.elements.icon.addClassName("wux-controls-"+this.options.view+"-icon"),e?a.generateIcon(e,{target:this.elements.icon}):this.elements.icon.empty()},isHighlighted:function(){return this._isHighlighted},highlight:function(){this._isHighlighted=!0,this.elements.container.addClassName("wux-ui-state-highlighted"),this.elements.checkbox.getContent().addClassName("wux-ui-state-highlighted"),!0!==this.elements.checkbox.checkFlag&&(this._listenToChanges=!1,this.elements.checkbox.checkFlag=!0,this._listenToChanges=!0)},unhighlight:function(){this._isHighlighted=!1,this.elements.container.removeClassName("wux-ui-state-highlighted"),this.elements.checkbox.getContent().removeClassName("wux-ui-state-highlighted"),!1!==this.elements.checkbox.checkFlag&&(this._listenToChanges=!1,this.elements.checkbox.checkFlag=!1,this._listenToChanges=!0)},activate:function(){this.elements.container.addClassName("wux-ui-state-activated")},deactivate:function(){this.elements.container.removeClassName("wux-ui-state-activated")}})}),define("DS/Controls/ThumbnailCellView",["UWA/Core","DS/Controls/ThumbnailView","DS/Layouts/GridEngineCellAbstract","DS/UIBehaviors/ContextualMenuManager","DS/Core/PointerEvents","DS/Menu/ContextualMenu","DS/Controls/TooltipModel","DS/Utilities/Dom"],function(e,t,i,n,s,o,l,a){"use strict";function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}return i.extend({defaultOptions:{size:"small",menu:[]},init:function(e){var i=e.menu;e.menu=[],this._CtxMenuByRightClick=!0,this._parent(e),this.elements.container.setStyles({border:"none"}),this.elements.container.setAttribute("draggable","true"),this.elements.container.dsView=this,this._view=new t(this.options).inject(this.elements.container),this._view.elements.menu.cellView=this;var o=this;this._view.elements.checkbox.addEventListener(s.POINTERDOWN,function(e){e.stopPropagation()},!0),this._view.elements.checkbox.addEventListener(s.POINTERUP,function(e){e.stopPropagation()}),this._view.elements.checkbox.addEventListener("click",function(e){o.getGridEngine()&&!0===o.getGridEngine()._isTouchWithatCellHover&&(o.getGridEngine()._isTouchWithatCellHover=!1,e.stopPropagation(),o.getGridEngine()._enableInteractiveMultiSelMode())},!0),this._view._listenToChanges=!0,this._view.elements.checkbox.addEventListener("change",function(e){if(o._view._listenToChanges){var t=o.getGridEngine(),i=o.getCellInfos();t&&i&&(t._enableInteractiveMultiSelMode(),i.cellModel.isSelected()?i.cellModel.unselect():(t.options.selection.canMultiSelect||t.options.TreedocModel.getXSO().empty(),i.cellModel.select()),t.options.lastSelectedNode=i.cellModel)}}),this.setupContextualMenu(i),this.getGridEngine().options.onContextualEvent?this._view.elements.menu.addEventListener(s.POINTERUP,function(e){e.preventDefault();var t=this.cellView;if(o._CtxMenuByRightClick=!1,!s.isTouchEvent(e)||!t.getGridEngine()._preventSelectionForTouchScroll){var i=t.getCellInfos();if(i){var n=i.nodeModel;n&&!n.isSelected()&&(n.select(!0),t.getGridEngine().setActiveNode(n,!0))}if(t.getGridEngine().options.onContextualEvent){var l=document.createEvent("HTMLEvents");l.initEvent("contextmenu",!0,!1),l.pageX=e.pageX,l.pageY=e.pageY,this.dispatchEvent(l)}o._CtxMenuByRightClick=!0,e.stopPropagation()}}):this._view.elements.menu.addEventListener(s.POINTERDOWN,function(e){var t=this.cellView;o._CtxMenuByRightClick=!1;var i=t.getCellInfos();n.show(t._view.elements.container,[e.pageX,e.pageY]),o._CtxMenuByRightClick=!0,i.cellModel.isSelected()&&e.stopPropagation()})},setupContextualMenu:function(e){var t=this,i=this.getGridEngine().options.onContextualEvent;if(i)o.addEventListener(this.elements.container,{callback:function(e){if(t.getGridEngine()&&(t.getGridEngine()._cellCtxMenuRequired=!0,!0===t._CtxMenuByRightClick)){var n=t.getCellInfos();if(n){var s=n.nodeModel;s&&!s.isSelected()&&(s.select(!0),t.getGridEngine().setActiveNode(s,!0))}}return i.callback.call(i.this,{context:t,menuContext:e.context,infos:e.info,data:e.data,cellInfos:t.getCellInfos()})}});else{var s=this.getGridEngine().options.onContextualMenuReady,l=s;"function"==typeof s&&(l=function(){var e=t.getCellInfos();if(e&&!0===t._CtxMenuByRightClick){var i=e.nodeModel;i&&!i.isSelected()&&(i.select(!0),t.getGridEngine().setActiveNode(i,!0))}return s.call(t,e)}),0===(e?e.length:0)?(n.forget({target:this._view.elements.container,nodes:l}),n.onReady({target:this._view.elements.container,nodes:l})):n.onReady({target:this._view.elements.container,context:this,nodes:e})}},updateInternalParameters:function(){this.setColor(),this.setTitle(),this.setSubtitle(),this.setDescription(),this.unhighlight(),this.deactivate(),this.unsetBadges()},setTitle:function(e){this._view.setTitle(e),(!this.getGridEngine()||this.getGridEngine()&&"function"==typeof this.getGridEngine().getShouldDisplayTooltipFlag&&!0===this.getGridEngine().getShouldDisplayTooltipFlag())&&(this.elements.container.title=e)},setColor:function(e){this._view.setColor(e)},setIcon:function(e){this._view.setIcon(e)},setSubtitle:function(e){this._view.setSubtitle(e)},setDescription:function(e){this._view.setDescription(e)},setPicture:function(e){this._view.setPicture(e)},highlight:function(){this._view.highlight()},unhighlight:function(){this._view.unhighlight()},activate:function(){this._view.activate()},deactivate:function(){this._view.deactivate()},getCellInfos:function(){var e=this._parent(),t=this.getVirtualCoordinates();return e.nodeModel=this.getGridEngine().getCellModel(t.virtualRowID,t.virtualColumnID),e},setPictureBackgroundSize:function(e){this._view&&this._view.elements.picture&&this._view.elements.picture.setStyle("background-size",e)},unsetBadges:function(){this._view.elements.badgeTopRight.style.backgroundImage="",this._view.elements.badgeTopRight.style.visibility="hidden",this._view.elements.badgeTopRight.className="",this._view.elements.badgeTopRight.addClassName("wux-controls-thumbnail-badge-top-right"),this._view.elements.badgeBottomRight.style.backgroundImage="",this._view.elements.badgeBottomRight.style.visibility="hidden",this._view.elements.badgeBottomRight.className="",this._view.elements.badgeBottomRight.addClassName("wux-controls-thumbnail-badge-bottom-right")},setBadges:function(e){for(var t in e){var i=e[t];i&&(a.generateIcon(i,{target:this._view.elements["badge"+r(t)]}),this._view.elements["badge"+r(t)].style.visibility="visible")}}})}),define("DS/Controls/SpinBoxDecorator",["require","exports","DS/Controls/CustomizableDecorator","DS/Controls/CustomizableDecoratorItems","DS/Controls/DecoratorManager"],function(e,t,i,n,s){"use strict";return function(){function e(){}return e.getId=function(){if(!e.decoratorID){e.decoratorID="defaultWebUXSpinBoxDecorator",n.addDecoratorItems({defaultWebUXSpinBoxDecoratorSwitchToViewOperators:{icon:{iconName:"math-more-less"},semantics:"primary"},defaultWebUXSpinBoxDecoratorSwitchToViewNumbers:{icon:{iconName:"numeric-keypad"},semantics:"primary"}});var t=new i({items:{viewNumbers:["1","2","3","arrowUp","4","5","6","arrowDown","7","8","9","delete","defaultWebUXSpinBoxDecoratorSwitchToViewOperators","0","decimal","validate"],viewOperators:["defaultWebUXSpinBoxDecoratorSwitchToViewNumbers","exponential","substraction","validate"]},viewSwitchingDefinition:{defaultWebUXSpinBoxDecoratorSwitchToViewOperators:"viewOperators",defaultWebUXSpinBoxDecoratorSwitchToViewNumbers:"viewNumbers"},gridDefinition:{viewNumbers:{numberOfColumns:4,numberOfLines:4},viewOperators:{numberOfColumns:4,numberOfLines:1}}});s.registerDecorator(e.decoratorID,t)}return e.decoratorID},e}()}),define("DS/Controls/TimeChooser",["UWA/Core","DS/Controls/Abstract","DS/WebRecordEnabler/Adapter","DS/Utilities/Dom"],function(e,t,i,n){"use strict";var s=Number.MAX_VALUE;function o(){if("undefined"!==this.value)if("duration"===this.mode){var e=this.getHours(),t=this.getMinutes(),i=this.getSeconds();this._inputsDiv[0].value=(e<10?"0":"")+e,this._inputsDiv[1].value=(t<10?"0":"")+t,this._inputsDiv[2].value=(i<10?"0":"")+i}else{var n=this.getHours();"12"===this.mode?n>=12?(this._inputsDiv[0].value=n>=13?n-12:n,this._amPmDiv.textContent="PM"):(this._inputsDiv[0].value=0===n?12:n,this._amPmDiv.textContent="AM"):this._inputsDiv[0].value=n;var s=this.value.getMinutes(),o=this.value.getSeconds();this._inputsDiv[1].value=(s<10?"0":"")+s,this._inputsDiv[2].value=(o<10?"0":"")+o}else this._inputsDiv[0].value="",this._inputsDiv[1].value="",this._inputsDiv[2].value=""}var l=t.inherit({name:"timeChooser",markForRecordFlag:!0,publishedProperties:{value:{defaultValue:null,type:"date",category:"Behavior",recordFlag:!0,advancedSetter:!0},precision:{defaultValue:"min",type:"string",category:"Behavior"},mode:{defaultValue:"24",type:"string",category:"Behavior"},hoursStep:{defaultValue:1,type:"integer",noNeedToApplyFlag:!0,category:"Behavior"},minutesStep:{defaultValue:1,type:"integer",noNeedToApplyFlag:!0,category:"Behavior"},secondsStep:{defaultValue:1,type:"integer",noNeedToApplyFlag:!0,category:"Behavior"},noContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}},buildView:function(){this.elements.container.addClassName("wux-controls-timechooser"),this.elements.container.setAttribute("tabindex",0),function(){var t=this;this._arrowsInfo=[{name:"hoursUp",container:this.elements.columnHour,onClick:function(e){t._setHours(t.getHours()+t.hoursStep,"clickOnHoursUp")},upFlag:!0},{name:"minutesUp",container:this.elements.columnMinute,onClick:function(e){t._setMinutes(t.getMinutes()+t.minutesStep,"clickOnMinutesUp")},upFlag:!0},{name:"secondsUp",container:this.elements.columnSecond,onClick:function(e){t._setSeconds(t.getSeconds()+t.secondsStep,"clickOnSecondsUp")},upFlag:!0,secondsFlag:!0},{name:"amPmUp",container:this.elements.columnAMPM,onClick:function(e){t._setHours(t.getHours()+12,"clickOnAmPmUp")},upFlag:!0,amPmFlag:!0},{name:"hoursDown",container:this.elements.columnHour,onClick:function(e){t._setHours(t.getHours()-t.hoursStep,"clickOnHoursDown")},upFlag:!1},{name:"minutesDown",container:this.elements.columnMinute,onClick:function(e){t._setMinutes(t.getMinutes()-t.minutesStep,"clickOnMinutesDown")},upFlag:!1},{name:"secondsDown",container:this.elements.columnSecond,onClick:function(e){t._setSeconds(t.getSeconds()-t.secondsStep,"clickOnSecondsDown")},upFlag:!1,secondsFlag:!0},{name:"amPmDown",container:this.elements.columnAMPM,onClick:function(e){t._setHours(t.getHours()-12,"clickOnAmPmDown")},upFlag:!1,amPmFlag:!0}],this._arrowsDiv=[],this._arrowsInfo.forEach(function(i){var n="wux-ui-3ds";i.secondsFlag?n+=" wux-controls-timechooser-seconds":i.amPmFlag&&(n+="  wux-controls-timechooser-ampm"),i.upFlag?n+=" wux-ui-3ds-expand-up wux-controls-timechooser-arrow wux-controls-timechooser-arrow-up":n+=" wux-ui-3ds-expand-down wux-controls-timechooser-arrow wux-controls-timechooser-arrow-down";var s=new e.Element("button",{type:"button",class:n});t._arrowsDiv.push(s)}),this._inputsInfo=[{name:"hours",minValue:0,maxValue:23,onChange:function(e){t._setHours(e,"input_hours")}},{name:"minutes",minValue:0,maxValue:59,onChange:function(e){t._setMinutes(e,"input_minutes")}},{name:"seconds",minValue:0,maxValue:59,onChange:function(e){t._setSeconds(e,"input_seconds")},secondsFlag:!0}],this._inputsDiv=[],this._inputsInfo.forEach(function(i){var n="wux-controls-timechooser-input";i.secondsFlag&&(n+=" wux-controls-timechooser-seconds"),t._inputsDiv.push(new e.Element("input",{class:n}))}),this._amPmDiv=new e.Element("label",{html:"AM",class:"wux-controls-timechooser-ampm"}),this._inputsDiv.push(this._amPmDiv)}.call(this),function(){for(var t=["columnHour","columnMinute","columnSecond","columnAMPM"],i=["_columnHour","_columnMinute","_columnSecond","_columnAMPM"],n=["wux-controls-timechooser-column-hr","wux-controls-timechooser-column-min","wux-controls-timechooser-column-sec","wux-controls-timechooser-column-ampm"],s=0;s<t.length;s++){var o=t[s];this.elements[o]=new e.Element("div",{class:"wux-controls-timechooser-column-container"}).inject(this.elements.container),this[i[s]]=new e.Element("div",{class:n[s]}).inject(this.elements[o]),this._arrowsDiv[s].inject(this[i[s]]),this._inputsDiv[s].inject(this[i[s]]),this._arrowsDiv[s+4].inject(this[i[s]])}this._hourDelim=new e.Element("label",{html:"h",class:"wux-controls-timechooser-deliminator"}).inject(this.elements.columnHour),this._minDelim=new e.Element("label",{html:"m",class:"wux-controls-timechooser-deliminator wux-controls-timechooser-deliminator-min"}).inject(this.elements.columnMinute),this._secDelim=new e.Element("label",{html:"s",class:"wux-controls-timechooser-deliminator wux-controls-timechooser-deliminator-sec"}).inject(this.elements.columnSecond)}.call(this),this.value=new Date},handleEvents:function(){var e=this;this._arrowsDiv.forEach(function(t,i){n.addEventOnElement(e,t,"click",function(t){e._arrowsInfo[i].onClick.call(e)}),n.addEventOnElement(e,t,"focus",function(t){this.blur(),e.elements.container.focus()})}),this._inputsDiv.forEach(function(t,i){n.addEventOnElement(e,t,"change",function(t){var n=parseInt(this.value),s=e._inputsInfo[i];n>=s.minValue&&n<=s.maxValue?s.onChange.call(e,n):o.call(e)})})},_applyMode:function(e){"24"===this.mode?this.getContent().setAttribute("mode","24"):"12"===this.mode?this.getContent().setAttribute("mode","12"):(this.getContent().setAttribute("mode","duration"),this._inputsInfo[0].maxValue=s),o.call(this)},_preEditValue:function(t,i){return!i||("string"==typeof i?(this.value=new Date(Date.parse(i)),!1):i instanceof Date?!e.equals(t,i)&&!!function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())}.call(this,i):"number"==typeof i&&!e.equals(t,i))},_applyValue:function(e){o.call(this),this.fire("change")},_applyPrecision:function(e){"min"===this.precision?this.getContent().setAttribute("precision","min"):this.getContent().setAttribute("precision","sec")},_applyDisabled:function(e){this._parent(),this.disabled?(this._arrowsDiv.forEach(function(e){e.setAttributeNode(document.createAttribute("disabled"))}),this._inputsDiv.forEach(function(e){e.setAttributeNode(document.createAttribute("disabled"))})):(this._arrowsDiv.forEach(function(e){e.removeAttribute("disabled")}),this._inputsDiv.forEach(function(e){e.removeAttribute("disabled")}))},getHours:function(){return"duration"===this.mode?Math.floor(this.value/36e5):this.value.getHours()},getMinutes:function(){return"duration"===this.mode?Math.floor(this.value/6e4%60):this.value.getMinutes()},getSeconds:function(){return"duration"===this.mode?Math.floor(this.value/1e3%60):this.value.getSeconds()},setHours:function(e){this._setHours(e)},_setHours:function(e){if("duration"===this.mode){var t=this.value-36e5*(this.getHours()-e);t>=0&&this.setPropertyFromUIInteraction("value",t)}else{let t=new Date(this.value),i=(e+24)%24;t.setHours(i),this.setPropertyFromUIInteraction("value",t)}},setMinutes:function(e){this._setMinutes(e)},_setMinutes:function(e){if("duration"===this.mode){var t=this.value-6e4*(this.getMinutes()-e);t>=0&&this.setPropertyFromUIInteraction("value",t)}else{let t=new Date(this.value),i=(e+60)%60;t.setMinutes(i),this.setPropertyFromUIInteraction("value",t)}},setSeconds:function(e){this._setSeconds(e)},_setSeconds:function(e){if("duration"===this.mode){var t=this.value-1e3*(this.getSeconds()-e);t>=0&&this.setPropertyFromUIInteraction("value",t)}else{let t=new Date(this.value),i=(e+60)%60;t.setSeconds(i),this.setPropertyFromUIInteraction("value",t)}},incrementAmPm:function(){this.setHours(this.value.getHours()+12)},decrementAmPm:function(){this.setHours(this.value.getHours()-12)},incrementHours:function(){this.setHours(this.getHours()+this.hoursStep)},decrementHours:function(){this.setHours(this.getHours()-this.hoursStep)},incrementMinutes:function(){this.setMinutes(this.getMinutes()+this.minutesStep)},decrementMinutes:function(){this.setMinutes(this.getMinutes()-this.minutesStep)},incrementSeconds:function(){this.setSeconds(this.getSeconds()+this.secondsStep)},decrementSeconds:function(){this.setSeconds(this.getSeconds()-this.secondsStep)},_applyProperties:function(e){this._parent(e),this.isDirty("mode")&&this._applyMode(e.mode),this.isDirty("value")&&this._applyValue(e.value),this.isDirty("precision")&&this._applyPrecision(e.precision)}});return i.register(l,"DS/ControlsRec/AbstractRec"),l});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/SpinBox",["require","exports","UWA/Core","DS/Core/Core","DS/Controls/Abstract","DS/Controls/SpinBoxDecorator","DS/Controls/CustomizableDecoratorItems","DS/Core/PointerEvents","DS/Utilities/Utils","DS/Utilities/Dom","DS/Units/Units","DS/Controls/DecoratorManager","DS/Utilities/KeyboardUtils","DS/WebRecordEnabler/Adapter","DS/Core/WebUXComponents","DS/Utilities/WUXUWAUtils"],function(e,t,i,n,s,o,l,a,r,h,u,c,d,p,m,g){"use strict";var v,f,y;function b(e){return"undefined"!=typeof localStorage&&"true"===localStorage.getItem(e)}function _(){return void 0===f&&(f=b("WebUX_SB_ticksFeature")),f}function C(){return void 0===y&&(y=b("WebUX_SB_buttonsV2Feature")),y}var w=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return n.valueHasBeenModified=!1,n.editHasBegun=!1,g.extendingClassFlag?n:(n.addKeyMapsAndCommands({return:"manageEnter",esc:{keydown:"manageEscape"},pageup:{keydown:"manageArrowsKeyDown",keyup:"endEdit"},pagedown:{keydown:"manageArrowsKeyDown",keyup:"endEdit"},up:{keydown:"manageArrowsKeyDown",keyup:"endEdit"},down:{keydown:"manageArrowsKeyDown",keyup:"endEdit"},space:{keydown:"consume",keyup:"consume"},left:{keydown:"consume",keyup:"consume"},right:{keydown:"consume",keyup:"consume"},del:{keydown:"consume",keyup:"consume"},backspace:{keydown:"consume",keyup:"consume"},"ctrl+c":{keydown:"consume",keyup:"consume"},"ctrl+v":{keydown:"consume",keyup:"consume"},"ctrl+x":{keydown:"consume",keyup:"consume"},"ctrl+a":{keydown:"consume",keyup:"consume"},"ctrl+z":{keydown:"consume",keyup:"consume"},"shift+up":{keydown:"consume",keyup:"consume"},"shift+right":{keydown:"consume",keyup:"consume"},"shift+down":{keydown:"consume",keyup:"consume"},"shift+left":{keydown:"consume",keyup:"consume"},"ctrl+up":{keydown:"consume",keyup:"consume"},"ctrl+right":{keydown:"consume",keyup:"consume"},"ctrl+down":{keydown:"consume",keyup:"consume"},"ctrl+left":{keydown:"consume",keyup:"consume"},"ctrl+del":{keydown:"consume",keyup:"consume"},"ctrl+backspace":{keydown:"consume",keyup:"consume"},"ctrl+shift+right":{keydown:"consume",keyup:"consume"},"ctrl+shift+left":{keydown:"consume",keyup:"consume"},"shift+ctrl+right":{keydown:"consume",keyup:"consume"},"shift+ctrl+left":{keydown:"consume",keyup:"consume"},home:{keydown:"consume",keyup:"consume"},end:{keydown:"consume",keyup:"consume"},defaultKey:{keydown:"forceEditMode",keyup:"consume"}},{consume:function(){return{stopPropagation:!0}},manageEnter:function(){if(this.elements.inputField){this.elements.inputField.focus();var e=!1;return c.isDecoratorDisplayed()?(c.hideDecorator(!0,!0),e=!0):e=this._validateValue(this.elements.inputField.value),this.lastValueWhenEnter=this.value,this._endEdit(),{stopPropagation:!1,infos:{actionPerformed:e}}}},forceEditMode:function(){A.call(this,!0)},manageEscape:function(){var e=!1;if(this.elements.inputField){if(!this.handleEditionCancel)return{stopPropagation:!1};this._managingEscape=!0,c.isDecoratorDisplayed()&&c.hideDecorator(!1,!0);var t=D.call(this,this.lastValueWhenEnter);this.elements.inputField.value!==t?(this.editIsCancelled=!0,this._validateValue(this.lastValueWhenEnter),this._cancelEdit(),e=!0):this.lastValueWhenEnter!==this.value&&(this._validateValue(this.lastValueWhenEnter),this._cancelEdit(),e=!0),F.call(this)&&P.call(this),this.editIsCancelled=!1,this._managingEscape=!1,this.selectAllOnFocus&&L(this.elements.inputField,!1)}return{stopPropagation:!1,infos:{actionPerformed:e}}},manageArrowsKeyDown:function(e){var t;return this.elements.inputField&&(void 0!==this.value&&null!==this.value||this.elements.inputField&&""!==this.elements.inputField.value||(this._beginEdit(),this._validateValue(0))),e.keyCode===d.ARROWUP?t=this._modifyValue(this.stepValue,!0):e.keyCode===d.ARROWDOWN?t=this._modifyValue(-this.stepValue,!0):e.keyCode===d.PAGEUP?t=this._modifyValue(this.pageStepValue,!0):e.keyCode===d.PAGEDOWN&&(t=this._modifyValue(-this.pageStepValue,!0)),this.elements.inputField&&this.elements.inputField.isInjected()&&(this.elements.inputField.focus(),this.selectAllOnFocus&&L(this.elements.inputField,!0)),{stopPropagation:!0,preventDefault:!0,infos:{actionPerformed:t}}},endEdit:function(){this._endEdit()}}),n)}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:0,type:"number",category:"Behavior",advancedSetter:!0,recordFlag:!0},units:{defaultValue:"",type:"string",category:"Behavior"},minValue:{defaultValue:void 0,type:"number",category:"Behavior"},maxValue:{defaultValue:void 0,type:"number",category:"Behavior"},stepValue:{defaultValue:.1,type:"number",category:"Behavior"},pageStepValue:{defaultValue:10,type:"number",category:"Behavior"},decimals:{defaultValue:5,type:"integer",category:"Behavior",advancedSetter:!0},highExponentProperty:{defaultValue:6,type:"integer",category:"Behavior"},lowExponentProperty:{defaultValue:6,type:"integer",category:"Behavior"},displayStyle:{defaultValue:"normal",type:"string",category:"Appearance"},useScientificNotationFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},displayCustomizer:{defaultValue:void 0,type:"function",category:"Behavior"},customValidator:{defaultValue:void 0,type:"function",category:"Behavior"},typingFilter:{defaultValue:void 0,type:"boolean",category:"Behavior"},allowUndefinedFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},useLocaleDisplayOutsideEdition:{defaultValue:!1,type:"boolean",category:"Appearance"},handleEditionCancel:{defaultValue:!0,type:"boolean",category:"Behavior"},customDecoratorDefinition:{defaultValue:void 0,type:"Object",category:"Behavior"},selectAllOnFocus:{defaultValue:!0,type:"boolean",category:"Behavior"},requiredFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},placeholder:{defaultValue:"",type:"string",category:"Appearance"},valueToCommit:{defaultValue:"",type:"string",category:"Behavior"},validFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},validState:{defaultValue:!0,type:"boolean",readOnly:!0,category:"Appearance"},noContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){this.elements.container.addClassName("wux-controls-spinbox"),C()&&this.elements.container.addClassName("wux-buttons-v2"),this.elements.inputContainer=new i.Element("div",{class:"wux-input-container"}).inject(this.elements.container)},t.prototype.handleEvents=function(){var t=this;e.prototype.handleEvents.call(this),h.addEventOnElement(this,this.getContent(),a.POINTERUP,function(e){t._focusHasBeenGiven&&(t._focusHasBeenGiven=!1)}),h.addEventOnElement(this,this.elements.container,"mousewheel",function(e){if(!t.disabled&&(t.elements.inputField===document.activeElement||t.elements.fakeInput===document.activeElement||t.getContent().hasAttribute("focused"))){var n=t.elements.inputField,s=t.selectAllOnFocus;e.preventDefault(),e.stopPropagation();var o=i.Event.wheelDelta(e)>0?1:-1;t._modifyValue(o*t.stepValue,!0),t._endEdit(),s&&L(n,!1)}}),this._createPointerUpOnDocumentFunction();t=this;this._updateViewOnEventFun=function(e){t._updateView()},n.onlanguagechange(this._updateViewOnEventFun)},t.prototype._onDecoratorClick=function(e,t){if(!t){var i=l.getItem(e),n=this.elements.inputField.selectionStart,s=this.elements.inputField.selectionEnd,o=this.elements.inputField.value.substring(n,s);if(i&&i.label){if("decimal"===e&&this.elements.inputField.value.indexOf(i.label)>-1&&-1===o.indexOf(i.label))return;var a=c.getDecorator();if(a&&a.viewSwitchingDefinition&&a.viewSwitchingDefinition[e])return;r=function e(t){if(null!=t){var i=t.substring(0,1);if("0"===i&&t.length>1){var n=t.substring(1,2);return function(e){for(var t=["0","1","2","3","4","5","6","7","8","9"],i=0;i<t.length;i++)if(e===t[i])return!0;return!1}(n)?e(t.substring(1,t.length)):t}return t}}(r=this.elements.inputField.value.substring(0,n)+i.label+this.elements.inputField.value.substring(s)),this.elements.inputField.value=r,this.valueToCommit=r,this.elements.inputField.selectionStart=this.elements.inputField.selectionEnd=n+i.label.length}else if("delete"===e){var r;r=this.elements.inputField.selectionEnd>this.elements.inputField.selectionStart?this.elements.inputField.value.substring(0,this.elements.inputField.selectionStart)+this.elements.inputField.value.substring(this.elements.inputField.selectionEnd+1):this.elements.inputField.value.substring(0,this.elements.inputField.value.length-1),this.elements.inputField.value=r,this.elements.inputField.selectionStart=this.elements.inputField.selectionEnd=n}else"validate"===e?c.hideDecorator(!0,!0):"arrowUp"===e?(this._validateValue(this.elements.inputField.value),this.increment()):"arrowDown"===e&&(this._validateValue(this.elements.inputField.value),this.decrement())}},t.prototype._onDecoratorShow=function(){this._blurThenFocusOnLineEditor=!0,document.activeElement&&document.activeElement.blur();var e=this.elements.inputField;e.setAttributeNode(document.createAttribute("readonly")),e.focus(),e.select(),this._blurThenFocusOnLineEditor=!1},t.prototype._onDecoratorHide=function(e){var t=this.elements.inputField;if(t){var i=this,n=t.value;if(t.blur(),t.removeAttribute("readonly"),!e){var s=this.lastValueWhenEnter;this._blurThenFocusOnLineEditor=!0,t.blur(),this._preventUpdateOnNextFocus=!0,setTimeout(function(){t.focus(),t.value=n,i.lastValueWhenEnter=s,i._blurThenFocusOnLineEditor=!1},10)}!0===e&&this._validateValue&&this._validateValue(n);var o=c.getDecorator();o&&o.resetActiveView&&c.getDecorator().resetActiveView()}},t.prototype._beginEdit=function(){this.editHasBegun||(this.editHasBegun=!0,this.fire("beginEdit"))},t.prototype._cancelEdit=function(){this.editHasBegun&&(this._updateView(),this.editHasBegun=!1,this.fire("cancelEdit"))},t.prototype._endEdit=function(){this.editHasBegun&&(this.editHasBegun=!1,this.fire("endEdit"))},t.prototype.destroy=function(){c.getWidget()===this&&c.hideDecorator(),n.offlanguagechange(this._updateViewOnEventFun),e.prototype.destroy.call(this)},t.prototype._modifyValue=function(e,t){var i,s;if(void 0!==this.value&&null!==this.value||""!==this.elements.inputField.value){var o=this.elements.inputField?this.elements.inputField.value:this.value.toString();if(this.customValidator)return this._callCustomValidator(o,e),!0;this.displayCustomizer&&isNaN(o)&&(o=this.value.toString());var l=this._getDecimalSeparator(n.currentLanguage);o=o.replace(l,"."),i=parseFloat(o)+e}else i=0;var a=r.round(i,Number(Math.pow(10,-1*this.decimals).toFixed(this.decimals))),h=this._getValidatedValue(a);return h!==this.value&&(t&&this._beginEdit(),s=this._validateValue(h)),s},t.prototype.increment=function(){this._modifyValue(this.stepValue)},t.prototype.decrement=function(){this._modifyValue(-this.stepValue)},t.prototype.pageIncrement=function(){this._modifyValue(this.pageStepValue)},t.prototype.pageDecrement=function(){this._modifyValue(-this.pageStepValue)},t.prototype.filteringCharOtherThanNumberEdition=function(e){var t=this._getDecimalSeparator(n.currentLanguage);return!(e.keyCode!==d.SPACE&&!isNaN(Number(e.key))||e.ctrlKey||d.isInteractiveKey(e.keyCode)&&(e.keyCode!==d.SPACE||"number"==typeof this.valueToCommit||this.valueToCommit.indexOf(" ")<0)||("."===e.key||","===e.key)&&e.key===t&&this.decimals&&("number"==typeof this.valueToCommit&&this.valueToCommit%1==0||"string"==typeof this.valueToCommit&&this.valueToCommit.indexOf(t)<0))},t.prototype._applyDisabled=function(){e.prototype._applyDisabled.call(this),this.disabled?this.elements.inputField&&this.elements.inputField.setAttributeNode(document.createAttribute("disabled")):this.elements.inputField&&this.elements.inputField.removeAttribute("disabled"),this.disabled?(this.elements.inputField&&this.elements.inputField.setAttributeNode(document.createAttribute("disabled")),"normal"===this.displayStyle&&(this.elements.up&&this.elements.up.setAttributeNode(document.createAttribute("disabled")),this.elements.down&&this.elements.down.setAttributeNode(document.createAttribute("disabled")))):(this.elements.inputField&&this.elements.inputField.removeAttribute("disabled"),"normal"===this.displayStyle&&(this.elements.up&&this.elements.up.removeAttribute("disabled"),this.elements.down&&this.elements.down.removeAttribute("disabled")))},t.prototype._applyTouchMode=function(){e.prototype._applyTouchMode.call(this),r.isOnIPhone()?this.getContent().addClassName("wux-device-iphone"):this.getContent().removeClassName("wux-device-iphone"),!0!==this._getCurrentTouchMode()||C()?"normal"===this.displayStyle&&(this._createSpinBoxButtons(),this.elements.buttonsDiv||(this.elements.buttonsDiv=new i.Element("div",{class:"wux-controls-lineeditor-buttonsDivRight",tabindex:-1}),C()&&M.call(this,this.elements.buttonsDiv)),this.elements.up&&this.elements.up.inject(this.elements.buttonsDiv),this.elements.down&&this.elements.down.inject(this.elements.buttonsDiv),this.elements.container&&this.elements.buttonsDiv.show().inject(this.elements.container)):(this.elements.down&&this.elements.container&&this.elements.down.inject(this.elements.container,"top"),this.elements.buttonsDiv&&this.elements.buttonsDiv.remove(),this.elements.up&&this.elements.container&&this.elements.up.inject(this.elements.container))},t.prototype._applyDisplayStyle=function(){"normal"===this.displayStyle?(this._createSpinBoxButtons(),this.elements.buttonsDiv&&this.elements.buttonsDiv.setStyle("border-width","0 0 0 1px")):(this._deleteSpinBoxButtons(),this.elements.buttonsDiv&&this.elements.buttonsDiv.setStyle("border-width","0")),this._applyTouchMode()},t.prototype._preEditDecimals=function(e,t){if(null!==t){if(t>9)return this.decimals=9,!1;if(t<0)return this.decimals=0,!1}return!0},t.prototype._applyDecimals=function(){this._updateView()},t.prototype._applyUnits=function(){this._updateView()},t.prototype._applyUseLocaleDisplayOutsideEdition=function(){this._updateView()},t.prototype._preEditValue=function(e,t){if(void 0!==t&&isNaN(t))return this.customValidator?(this._callCustomValidator(t,0),!1):(this._cancelEdit(),!1);var i=k.call(this,t);return i===t||(this.value=i,!1)},t.prototype._applyValue=function(e){this.valueHasBeenModified=!0,!this.allowUndefinedFlag||"Infinity"!==this.value&&this.value!==1/0?this.allowUndefinedFlag||"Infinity"!==this.value&&this.value!==1/0||(this.value=e):this.value=void 0,this._updateView(),this.valueHasBeenModified=!1,this.editIsCancelled||(this.lastValueWhenEnter=this.value,this.fire("change")),this._properties.valueToCommit.value=this.value},t.prototype._applyMinValue=function(e){if(this.minValue){var t=k.call(this,this.value);t!==this.value&&(this.value=t)}T.call(this)},t.prototype._applyMaxValue=function(e){if(this.maxValue){var t=k.call(this,this.value);t!==this.value&&(this.value=t)}T.call(this)},t.prototype._applyHighExponentProperty=function(e){this._updateView()},t.prototype._applyLowExponentProperty=function(e){this._updateView()},t.prototype._applyPlaceholder=function(){this.elements.inputField&&(this.placeholder?this.elements.inputField.setAttribute("placeholder",this.placeholder):!this.placeholder&&this.allowUndefinedFlag?this.elements.inputField.setAttribute("placeholder","- -"):this.elements.inputField.removeAttribute("placeholder"))},t.prototype._applyProperties=function(t){this.isDirty("minValue")&&this._applyMinValue(),this.isDirty("maxValue")&&this._applyMaxValue(),this.isDirty("placeholder")&&this._applyPlaceholder(),this.isDirty("value")&&(this._preEditValue(t.value,this.value),this._applyValue(t.value)),this.isDirty("requiredFlag")&&this._applyRequiredFlag(),this.isDirty("displayStyle")&&this._applyDisplayStyle(),B.call(this),e.prototype._applyProperties.call(this,t)},t.prototype._getElementToFocus=function(){return this.elements.inputField},t.prototype._onFocusReceived=function(){this.disabled||(e.prototype._onFocusReceived.call(this),this._mouseDownOnFakeInput||this._mouseDownOnButton||(document.activeElement===this.elements.fakeInput&&A.call(this,!1),this._isFocused()?this.selectAllOnFocus&&(this._focusHasBeenGiven=!0,L(this.elements.inputField,!1)):(c.isDecoratorDisplayed()||I.call(this),this.selectAllOnFocus&&!c.isDecoratorDisplayed()&&L(this.elements.inputField,!1),this.fire("focus"))))},t.prototype._giveFocus=function(){this.disabled||(e.prototype._giveFocus.call(this),this._mouseDownOnFakeInput||this._mouseDownOnButton||(document.activeElement===this.elements.fakeInput&&A.call(this,!1),!this.elements.inputField||document.activeElement===this.elements.inputField||a.isLastEventTouch()?this._isFocused()?this.selectAllOnFocus&&(this._focusHasBeenGiven=!0,L(this.elements.inputField,!1)):(c.isDecoratorDisplayed()||I.call(this),this.selectAllOnFocus&&!c.isDecoratorDisplayed()&&L(this.elements.inputField,!1),this.fire("focus")):this.elements.inputField.focus({preventScroll:!0})))},t.prototype.getInputText=function(){return this.elements.inputField?this.elements.inputField.value:this.elements.fakeInput?this.elements.fakeInput.content:this.value},t.prototype._callCustomValidator=function(e,t){var i=this,n=i.customValidator.call(i,e,t);if(n instanceof Promise){var s=this.elements.inputField,o=this.selectAllOnFocus&&0===s.selectionStart&&s.selectionEnd===s.value.length;n.then(function(e){void 0!==e&&isNaN(e)&&(e=i.value+parseFloat(t)),o=o||i.selectAllOnFocus&&0===s.selectionStart&&s.selectionEnd===s.value.length,e!==i.value?i.value=e:i._updateView(),o&&L(s,!0)})}else void 0!==n&&isNaN(n)&&(n=i.value+parseFloat(t)),n!==i.value?i.value=n:i._updateView()},t.prototype._updateView=function(){this._updateValidState(),B.call(this),this.getContent()&&null!==this.getContent().getAttributeNode("focused")?I.call(this):function(){var e=this;if(void 0===e.value||null===e.value)return e.elements.inputField&&(e.elements.inputField.value=""),void(e.elements.fakeInput&&(e.elements.fakeInput.textContent=""));if(e.displayCustomizer){var t=e.displayCustomizer.call(this,e.value);if("string"==typeof t)return e.elements.inputField&&(e.elements.inputField.value=t),void(e.elements.fakeInput&&(e.elements.fakeInput.textContent=t))}var i=e._getDecimalSeparator(n.currentLanguage),s=D.call(e,this.value);""===s&&(this.value=void 0);void 0!==s&&(e.elements.inputField&&(e.elements.inputField.value=s.toString().replace(".",i)),e.elements.fakeInput&&(e.elements.fakeInput.textContent=s.toString().replace(".",i)))}.call(this)},t.prototype._validateValue=function(e){var t=!1;if((e=null!=e?e.toString():"",this.displayCustomizer)&&this.displayCustomizer(this.value)===e)return this._updateView(),this.value;if(this.customValidator)t=!0,this._callCustomValidator(e,0);else{var i=this._getValidatedValue(e);i!==this.value?(this.setPropertyFromUIInteraction("value",i),t=!0):this._updateView()}return t},t.prototype._createPointerUpOnDocumentFunction=function(){if(!this._pointerUpOnDocument){var e=this;this._pointerUpOnDocument=function(t){if(e.elements.container){e._mouseDownOnButton=!1,clearTimeout(e.timeoutPointerDown),e.timeoutPointerDown=void 0,clearInterval(e.intervalPointerDown),e.intervalPointerDown=void 0,V.call(e);var i=t.clientX,n=t.clientY;if(e.editHasBegun&&e.value!==e.lastValueWhenEnter&&e._validateValue(e.value),e._endEdit(),!h.isElementInside(t.target,e.elements.inputContainer)&&c.isDecoratorDisplayed()&&!r.isMouseOverElement(c.getWidget().getContent(),{x:i,y:n})&&!r.isMouseOverElement(c.getDecorator().elements.popup.getContent(),{x:i,y:n})){e._decoratorHasBeenDisplayedOnce=!1,c.hideDecorator(!0,!0);var s=h.getDocumentOwner.call(e,e);h.removeEventOnElement(e,s,a.POINTERUP,e._pointerUpOnDocument)}}}}},t.prototype._createSpinBoxButtons=function(){this.elements.up||this.elements.down?(this.elements.up&&this.elements.up.show(),this.elements.down&&this.elements.down.show()):(this._createPointerUpOnDocumentFunction(),this.elements.up=new i.Element("button",{class:"wux-up-button wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-expand-up",tabindex:-1,name:"Button",type:"button"}),this.elements.down=new i.Element("button",{class:"wux-down-button wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-expand-down",tabindex:-1,name:"Button",type:"button"}),C()||(M.call(this,this.elements.up,1),M.call(this,this.elements.down,-1)))},t.prototype._deleteSpinBoxButtons=function(){this.elements.up&&this.elements.up.hide(),this.elements.down&&this.elements.down.hide()},t.prototype._changeValueInExpForm=function(){var e=this.lowExponentProperty,t=this.highExponentProperty,i=function(e){var t=String(e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);if(!t)return 0;return Math.max(0,(t[1]?t[1].length:0)-(t[2]?Number(t[2]):0))}(this.value)-1;i<0&&(i=0);var n=Math.abs(this.value);return!!this.useScientificNotationFlag||(0!==this.value&&this.decimals<e&&n<Math.pow(10,-this.decimals)&&(e=Math.ceil(-Math.log(this.value)/Math.LN10)-1),n>=Math.pow(10,t)||0!==this.value&&n<Math.pow(10,-e))},t.prototype._getDecimalSeparator=function(e){return 1.1.toLocaleString(e).substring(1,2)},t.prototype._getValidatedValue=function(e){var t=this;if(!this.allowUndefinedFlag||""!==e&&"Infinity"!==e){if(!this.allowUndefinedFlag&&(""===e||"Infinity"===e))return this.value;var i=t._getDecimalSeparator(n.currentLanguage);e=e.replace(i,".");var s,o=/((?:-?\d*)\.?\d+([eE][-\+]?\d+)?)(\s*)?(.*)?/g.exec(e),l=e;if(t.units){e.indexOf(" ");try{s=new u({unit:o[4]||t.units,value:parseFloat(o[1])});try{l=s.to(t.units).options.value}catch(e){l=s.options.value}}catch(e){l=parseFloat(o[1])}}else{var a=-1;t.elements.inputField&&(a=t.elements.inputField.value.indexOf("e")),l=a>=1?parseFloat(e.replace(",",".")):parseFloat(e)}return k.call(this,l)}},t.prototype._postBuildView=function(){F.call(this)?P.call(this):A.call(this)},t.prototype.commitCurrentEntry=function(){if(this.value!==this.valueToCommit)return this.value=this.valueToCommit,!0},t.prototype._applyRequiredFlag=function(){this.elements.inputField&&(!0===this.requiredFlag?this.elements.inputField.setAttributeNode(document.createAttribute("required")):this.elements.inputField.removeAttribute("required")),this._updateValidState()},t.prototype._applyValueToCommit=function(e){this.fire("uncommittedChange"),this._updateValidState()},t.prototype._applyValidFlag=function(){this._updateValidState()},t.prototype._updateValidState=function(){var e=this.requiredFlag&&void 0===this.value;e=e||!this.validFlag,this.elements.container&&(e?this.elements.container.setAttributeNode(document.createAttribute("invalid")):this.elements.container.removeAttribute("invalid")),e===this._properties.validState.value&&(this._properties.validState.value=!e,this.fire("validStateChange"))},t}(s);function x(e){var t;if(!Number.isNaN(parseInt(e)))return(t=(e=parseFloat(e)).toExponential().split("e"))[0]=parseFloat(t[0]),t[1]="e"+t[1],t}function E(e){if(null!=e){if(e.match(/e/))return e.replace(/0+e/,"e").replace(/\.e|\,e/,"e");if(e.match(/\.|\,/)){var t=e;return e.match(/\./)&&(t=t.replace(/0+$/,"").replace(/\.$/,"")),e.match(/\,/)&&(t=t.replace(/\,$/,"")),t}return e}}function S(e){if(e)return Boolean(e.toString().match(/\./))}function D(e){var t=x(e),i="";if(null!==this.decimals){var s=this.decimals;if(this._changeValueInExpForm())i=E((this.useLocaleDisplayOutsideEdition?parseFloat(t[0].toFixed(s)).toLocaleString(n.currentLanguage,{maximumFractionDigits:s}):parseFloat(t[0].toFixed(s)))+t[1]);else this.useLocaleDisplayOutsideEdition?i=parseFloat(e).toLocaleString(n.currentLanguage,{maximumFractionDigits:s}):isNaN(e)||(i=parseFloat(e.toFixed(s)).toString())}else i=this._changeValueInExpForm()?this.useLocaleDisplayOutsideEdition?S(e)?E(t[0].toLocaleString(n.currentLanguage,{maximumFractionDigits:String(t[0]).match(/.[1-9]+|,[1-9]/)[0].length-1})+t[1]):E(t[0].toLocaleString(n.currentLanguage)+t[1]):E(t[0]+t[1]):this.useLocaleDisplayOutsideEdition?S(e)?e.toLocaleString(n.currentLanguage,{maximumFractionDigits:function(e){if(e&&S(e))return String(e).match(/\.[0-9]+|\,[0-9]+/)[0].length-1-(String(e).match(/0+$|0+$/)?String(e).match(/0+$|0+$/)[0].length:0)}(e)}):e.toLocaleString(n.currentLanguage):e.toString();return this.units&&(i=i+" "+this.units),i}function I(){if(this._preventUpdateOnNextFocus)this._preventUpdateOnNextFocus=!1;else{var e,t=this,i=t._getDecimalSeparator(n.currentLanguage);if(void 0===t.value||null===t.value)return t.elements.inputField&&(t.elements.inputField.value=""),void(t.elements.fakeInput&&(t.elements.fakeInput.textContent=t.elements.inputField.value));if(t.displayCustomizer){var s=t.displayCustomizer.call(this,t.value);if("string"==typeof s)return t.elements.inputField&&(t.elements.inputField.value=s),void(t.elements.fakeInput&&(t.elements.fakeInput.textContent=s))}if(t.useScientificNotationFlag){var o=x(t.value);e=E((null===t.decimals?parseFloat(o[0]):parseFloat(o[0].toFixed(t.decimals)))+o[1])}else null!==t.decimals?isNaN(t.value)?t.value=void 0:e=parseFloat(t.value.toFixed(t.decimals)):e=t.value;t.units&&(e=e+" "+t.units),void 0!==e&&(t.elements.inputField&&e!==t.elements.inputField.value&&(t.elements.inputField.value=e.toString().replace(".",i)),t.elements.fakeInput&&(t.elements.fakeInput.textContent=e.toString().replace(".",i)))}}function V(e){void 0===e?(this.elements.up&&this.elements.up.removeAttribute("activated"),this.elements.down&&this.elements.down.removeAttribute("activated")):"up"===e?(this.elements.up&&this.elements.up.setAttributeNode(document.createAttribute("activated")),this.elements.down&&this.elements.down.removeAttribute("activated")):(this.elements.down&&this.elements.down.setAttributeNode(document.createAttribute("activated")),this.elements.up&&this.elements.up.removeAttribute("activated"))}function F(){return void 0===v&&(v=b("WebUX_SB_slidingFeature")),v?!1===this.selectAllOnFocus?0:1:0}function A(e){if(this.elements.fakeInput&&this.elements.fakeInput.isInjected()&&(this.elements.fakeInput.remove(),this.elements.sliderFeedback&&this.elements.sliderFeedback.remove(),this.elements.tickContainer&&this.elements.tickContainer.remove()),!this.elements.inputField){this.elements.inputField=new i.Element("input",{class:"wux-spinbox-input wux-controls-lineeditor",type:"text",tabindex:0,name:"LineEditor",autocomplete:"off"}),this._myInput=this.elements.inputField,this._applyPlaceholder(),this._updateView(),this._applyDisabled();var t=this;h.addEventOnElement(this,this.elements.inputField,"keydown",function(e){t.typingFilter&&!t.units&&("function"==typeof t.typingFilter&&t.typingFilter(e.keyCode)?e.preventDefault():t.filteringCharOtherThanNumberEdition.call(t,e)&&e.preventDefault())}),h.addEventOnElement(this,this.elements.inputField,"change",function(e){e.stopPropagation()}),h.addEventOnElement(this,this.elements.inputField,"blur",function(e){t._mouseDownOnButton||t._managingEscape||(!t._blurThenFocusOnLineEditor&&t._decoratorHasBeenDisplayedOnce&&(t._decoratorHasBeenDisplayedOnce=!1),t.disabled||c.isDecoratorDisplayed()||(!t.editHasBegun||t.displayCustomizer&&t.customValidator||!(this.value!=t.lastValueWhenEnter||""===this.value&&void 0!==t.lastValueWhenEnter&&t.allowUndefinedFlag)?t.displayCustomizer&&t.customValidator?t._callCustomValidator(this.value,0):t._updateView():t._validateValue(this.value),t._endEdit()),F.call(t)&&P.call(t))}),h.addEventOnElement(this,this.elements.inputField,a.POINTERMOVE,function(e){a.isTouchEvent(e)&&e.preventDefault()}),h.addEventOnElement(this,this.elements.inputField,"focus",function(e){e.preventDefault()}),h.addEventOnElement(this,this.elements.inputField,a.POINTERDOWN,function(e){if(!a.isTouchEvent(e)||c.getWidget()===t&&t._decoratorHasBeenDisplayedOnce){if(c.isDecoratorDisplayed()){c.hideDecorator(!1,!0);n=h.getDocumentOwner.call(t,t);h.removeEventOnElement(t,n,a.POINTERUP,t._pointerUpOnDocument)}}else{e.preventDefault(),t._decoratorHasBeenDisplayedOnce=!0;var i=t.customDecoratorDefinition&&t.customDecoratorDefinition.decoratorID?t.customDecoratorDefinition.decoratorID:o.getId();c.showDecorator(t,this,i);var n=h.getDocumentOwner.call(t,t);h.addEventOnElement(t,n,a.POINTERUP,t._pointerUpOnDocument)}}),h.addEventOnElement(this,this.elements.inputField,"input",function(e){e.stopPropagation(),t._beginEdit(),t.setPropertyFromUIInteraction("valueToCommit",t.elements.inputField.value)}),this.elements.inputField&&this.elements.inputField.inject(this.elements.inputContainer)}this.elements.inputField.isInjected()||this.elements.inputField.inject(this.elements.inputContainer),e&&this.elements.inputField.focus()}function P(){this._lockDisplayFakeInput||(this._lockDisplayFakeInput=!0,this.elements.fakeInput||(this.elements.fakeInput=new i.Element("span",{class:"wux-spinbox-input",tabindex:"0"}),this._applyPlaceholder(),this._updateView(),function(){var e,t,i,n,s=this,o=0,l=0,u=0,c=0,d=!1;function p(a){s.disabled||a.preventDefault(),void 0!==s.minValue&&void 0!==s.maxValue?function(i){t=i.clientX,n||Math.abs(t-o)>3&&(n=!0);if(!n)return;var a=void 0;e=i.clientX-u,0!==l&&s.maxValue!==s.minValue&&(e>l&&(e=l),e<0&&(e=0),void 0!==s.value&&null!==s.value||s.elements.inputField&&""!==s.elements.inputField.value||(s._beginEdit(),s._validateValue(0)),(a=e/l*(s.maxValue-s.minValue)+s.minValue)!==s.value&&(d=!0),o=i.clientX,c=r.clamp(0,l,Math.round(e)));void 0!==a&&(s.stepValue&&(a=s.stepValue*Math.round(a/s.stepValue)),a=r.clamp(s.minValue,s.maxValue,a),s.value=a)}(a):function(e){t=e.clientX,n||Math.abs(t-o)>3&&(n=!0);if(n){h.pushUserInteractionContext(),void 0!==s.value&&null!==s.value||s.elements.inputField&&""!==s.elements.inputField.value||(s._beginEdit(),s._validateValue(0));var l=Math.round(t-i);s._modifyValue(l*s.stepValue,!0),i=t,d=!0,h.popUserInteractionContext()}}(a)}function m(e){s._mouseDownOnFakeInput=!1,d||A.call(s,!0),clearTimeout(s.timeoutPointerDown),s.timeoutPointerDown=void 0,clearInterval(s.intervalPointerDown),s.intervalPointerDown=void 0,V.call(s);var t=h.getDocumentOwner(s.getContent());h.removeEventOnElement(s,t,a.POINTERMOVE,p),h.removeEventOnElement(s,t,a.POINTERUP,m),s.disabled||(s.value,e.preventDefault(),e.stopPropagation(),s._inEdition&&(s._inEdition=!1,s.fire("endEdit")))}h.addEventOnElement(this,this.elements.fakeInput,a.POINTERDOWN,function(e){if(s._mouseDownOnFakeInput=!0,e.stopPropagation(),s.disabled)return;n=!1,d=!1;var t=h.getDocumentOwner(s.getContent());h.addEventOnElement(s,t,a.POINTERMOVE,p),h.addEventOnElement(s,t,a.POINTERUP,m),s.value,l=s.elements.inputContainer.clientWidth,u=e.clientX-e.offsetX,o=e.clientX,i=e.clientX;var g=e.offsetX;s.fire("beginEdit",{pointerDown:!0}),s._inEdition=!0,0!==l&&s.maxValue!==s.minValue&&(c=Math.round(g),c=r.clamp(0,l,c))})}.call(this)),this.elements.sliderFeedback&&this.elements.sliderFeedback.inject(this.elements.inputContainer),this.elements.fakeInput.inject(this.elements.inputContainer),this.elements.tickContainer&&this.elements.tickContainer.inject(this.elements.inputContainer),this.elements.inputField&&this.elements.inputField.isInjected()&&this.elements.inputField.remove(),this._lockDisplayFakeInput=!1)}function T(){if(_())if(this.selectAllOnFocus){if(!this.elements.tickContainer){this.elements.tickContainer=new i.Element("div",{class:"ticksContainer",content:"<ol><li></li> <li></li> <li></li> <li></li></ol>"})}this.elements.tickContainer.inject(this.elements.inputContainer,"top")}else this.elements.tickContainer&&this.elements.tickContainer.remove();F.call(this)&&void 0!==this.minValue&&void 0!==this.maxValue?this.elements.sliderFeedback?this.elements.sliderFeedback.show():this.elements.sliderFeedback=new i.Element("div",{class:"sliderFeedback"}).inject(this.elements.inputContainer,"top"):this.elements.sliderFeedback&&this.elements.sliderFeedback.hide()}function B(){if(void 0!==this.minValue&&void 0!==this.maxValue&&this.elements.sliderFeedback&&this.maxValue-this.minValue>0&&this.elements.sliderFeedback.setStyle("width",this.value/(this.maxValue-this.minValue)*100+"%"),_()&&this.elements.tickContainer&&this.stepValue){var e=this.elements.inputContainer.clientWidth,t=Math.round(e/4);if(void 0!==this.minValue&&void 0!==this.maxValue)this.elements.tickContainer.setStyle("margin-left","25%");else{var i=void 0;i=this.value<0?(t-Math.round(this.value/this.stepValue))%t:this.value>0?t-Math.round(this.value/this.stepValue)%t:"25%",this.elements.tickContainer.setStyle("margin-left",i)}}}function M(e,t){var i,n=this;h.addEventOnElement(this,e,a.POINTERDOWN,function(s){s.stopPropagation(),s.preventDefault(),n._mouseDownOnButton=!0,i={x:s.clientX,y:s.clientY},h.addEventOnElement(this,window,a.POINTERMOVE,function(e){i={x:e.clientX,y:e.clientY}},!0);var o=e.getBoundingClientRect(),l=o.bottom-o.top,r=n.selectAllOnFocus&&!a.isTouchEvent(s);if(n.timeoutPointerDown=setTimeout(function(){n.intervalPointerDown=setInterval(function(){if(h.pushUserInteractionContext(),t)n._modifyValue(t*n.stepValue,!0);else{var e=i.y>o.top+l/2?-1:1;n._modifyValue(e*n.stepValue,!0),L(n.elements.inputField,!0),V.call(n,-1===e?"down":"up")}r&&L(n.elements.inputField,!0),h.popUserInteractionContext()},100)},100),a.isTouchEvent(s)?n.getContent().setAttributeNode(document.createAttribute("focused")):n.elements.fakeInput&&n.elements.fakeInput.isInjected()?n.elements.fakeInput.focus():n.elements.inputField&&n.elements.inputField.isInjected()&&n.elements.inputField.focus(),void 0!==n.value&&null!==n.value||n.elements.inputField&&""!==n.elements.inputField.value||(n._beginEdit(),n._validateValue(0)),n.displayCustomizer){var u=n.displayCustomizer(n.value);n.elements.inputField&&n.elements.inputField.value!==u&&n._validateValue(n.value)}else n.elements.inputField&&parseFloat(n.elements.inputField.value)!==n.value&&n._validateValue(n.elements.inputField.value);if(t)n._modifyValue(t*n.stepValue,!0);else{var c=i.y>o.top+l/2?-1:1;n._modifyValue(c*n.stepValue,!0),V.call(n,-1===c?"down":"up")}r&&L(n.elements.inputField,!0);var d=h.getDocumentOwner(n.getContent());h.addEventOnElement(n,d,a.POINTERUP,n._pointerUpOnDocument)}),h.addEventOnElement(n,e,a.POINTERUP,function(e){e.preventDefault(),n._mouseDownOnButton=!1,n.intervalPointerDown&&n.timeoutPointerDown&&e.stopPropagation(),clearTimeout(n.timeoutPointerDown),n.timeoutPointerDown=void 0,clearInterval(n.intervalPointerDown),n.intervalPointerDown=void 0,n._endEdit(),V.call(n);var t=h.getDocumentOwner(n.getContent());h.removeEventOnElement(n,t,a.POINTERUP,n._pointerUpOnDocument)})}function k(e){return void 0!==this.maxValue&&null!==this.maxValue&&e>this.maxValue&&(e=this.maxValue),void 0!==this.minValue&&null!==this.minValue&&e<this.minValue&&(e=this.minValue),e}function L(e,t){e&&(t&&e.selectionStart!==e.selectionEnd||(e.setSelectionRange(0,0),e.select()))}return w.prototype.markForRecordFlag=!0,p.register(w,"DS/ControlsRec/AbstractRec"),m.addClass(w,"spinBox"),w}),define("DS/Controls/TreeBase",["UWA/Core","UWA/Event","UWA/Controls/Abstract","UWA/Controls/Drag","UWA/Controls/Scroller","DS/Core/Core","DS/Utilities/Css3D","DS/Controls/TreeNodeBase","DS/Controls/TreeNode","DS/Utilities/MouseEvents","DS/CoreEvents/ModelEvents"],function(e,t,i,n,s,o,l,a,r,h,u){"use strict";var c={expander:{size:10,borderSize:1},icon:{size:20},link:{size:1,color:"#333",bgColor:"transparent",style:"solid"},label:{padding:5,cursor:"pointer",marginRight:5,marginLeft:5,borderRadius:0},layout:{btMargin:5,lrMargin:5},expandState:{class:"Expander",text:"+",styles:{backgroundColor:"#FFF",borderColor:"#333",height:10,width:10,lineHeight:"8px",cursor:"pointer",zIndex:1e3}},collapseState:{class:"Expander",text:"",styles:{backgroundColor:"#FFF",borderColor:"#333",height:10,width:10,lineHeight:"8px",cursor:"pointer",zIndex:1e3}},asyncState:{class:"Expander",text:"",styles:{backgroundColor:"#FFF",borderColor:"#333",height:10,width:10,lineHeight:"8px",cursor:"pointer",zIndex:1e3}},noExpandState:{class:"NoExpander Link",text:"",styles:{backgroundColor:"transparent",marginTop:10,width:6,borderTop:"1px solid #333",cursor:"pointer",zIndex:1e3}},noExpandRoot:{class:"NoExpander Link",text:"",styles:{backgroundColor:"transparent",marginTop:10,width:6,cursor:"pointer",zIndex:1e3}}},d=i.extend({defaultOptions:{isEditable:!1,expandAllAtInit:!1,zoomFactor:100,hasFilterBox:!1,isScrollable:!0,UI:c,roots:[],nodeClass:a},init:function(e){this._parent(e),this._zoom=1,this._roots=[],this._modelEvents=new u,this.buildSkeleton(),this._loadModel(this.options.roots),this._buildCustomView(),this._buildScroller(),this._listenEvents()},_clearAutoExpandAtDragTimeout:function(){this._toAutoExpandAtDrag&&(clearTimeout(this._toAutoExpandAtDrag),this._toAutoExpandAtDrag=null)},_listenEvents:function(){var t=this;if(e.Element.addEvent.call(this.elements.container,"mousewheel",function(i){var n=e.Event.wheelDelta(i);i.shiftKey&&(1===Math.abs(n)&&(n*=.1),t._zoom+n>.55&&t._zoom+n<10&&(t._zoom=t._zoom+n,t.setZoomFactor(t._zoom.toFixed(2))))}),this.options.isScrollable){var i=0;this._scroller.addEvent("onRefresh",function(){2===++i&&(t.elements.container.setStyle("width","auto"),t.elements.container.getElement(".uwa-scroller").setStyle("width","auto")),i>=2&&t.elements.container.getElement(".uwa-scroller").setStyle("width","auto")})}},buildSkeleton:function(){var t=this,i=this.elements;i.container=new e.Element("div",{class:"WUX WUXTree",styles:{zoom:this.options.zoomFactor+"%",height:"100%",position:"relative"}}),this.options.hasFilterBox&&(i.search=new e.Element("input",{type:"search",placeholder:"search in tree ...",styles:{backgroundColor:"rgba(255, 255, 255, 0.8)",padding:"2px 5px",border:"1px solid #FFF",marginLeft:12},events:{blur:function(e){t.search(i.search.value)},change:function(e){t.search(i.search.value)},keydown:function(e){t.search(i.search.value)}}}),i.search.inject(i.container)),i.scrollContainer=new e.Element("div"),i.scrollContainer.inject(i.container),i.treeAndGrid=new e.Element("ul",{class:"Horizontal"}),i.treeAndGrid.inject(i.scrollContainer),this.elements.treeContainer=new e.Element("li",{styles:{verticalAlign:"top",width:"100%"}}),this.elements.treeContainer.inject(i.treeAndGrid),this._currentNodeID++,this._treeRoot=new this.options.nodeClass({isFakeRoot:!0,isRoot:!0,label:"Root",tree:this,UI:this.options.UI}),this._treeRoot.inject(this.elements.treeContainer)},_buildCustomView:function(){},_buildScroller:function(){this.options.isScrollable&&(this._scroller=new e.Controls.Scroller(this.elements.scrollContainer,{momentum:!0,scrollableX:!1,scrollableY:!0,scrollDrag:!1}))},empty:function(){this.removeAllRoots()},addRoot:function(e){e.isRoot=!0,e.tree=this,e.UI=this.options.UI;var t=this._createNode(e);return t.getContent().addClassName("wux-tree-root"),this._treeRoot.addChild(t),this._roots.push(t),this._updateRootsView(!0),t},removeRoot:function(e){e.getContent().destroy();var t=this._treeRoot._children.indexOf(e);-1!==t&&(this._treeRoot._children.splice(t,1),this._roots.splice(t,1))},removeAllRoots:function(){for(var e=this.getRoots().length,t=0;t<e;t++){var i=this.getNthRoot(0);this.removeRoot(i)}},_updateRootsView:function(){this._treeRoot.collapse(),this._treeRoot.expand()},dump:function(e){return this._treeRoot.dump(e)},processNodes:function(e){this._treeRoot.processChildren(e)},toggle:function(){this.elements.container.toggle()},getRoots:function(){return this._treeRoot.getChildren()?this._treeRoot.getChildren():[]},_getTrueRoot:function(){return this._treeRoot},getNthRoot:function(e){if(this._treeRoot.getChildren())return this._getTrueRoot().getChildren()[e]},setZoomFactor:function(e){this.options.zoomFactor=e,this._treeRoot.elements.container.setStyle("zoom",e)},_onUpdate:function(e){},_onPreExpand:function(e,t){},_onExpand:function(e,t){},_onPostExpand:function(e,t){},_onPreCollapse:function(e,t){},_onCollapse:function(e,t){},_onPostCollapse:function(e,t){},onExpand:function(e){return this._modelEvents.subscribe({event:"expand"},e)},onCollapse:function(e){return this._modelEvents.subscribe({event:"collapse"},e)},onNodeDragOver:function(e){return this._modelEvents.subscribe({event:"NODE/DRAG_OVER"},e)},onNodeDragStart:function(e){return this._modelEvents.subscribe({event:"NODE/DRAG_START"},e)},onNodeDragLeave:function(e){return this._modelEvents.subscribe({event:"NODE/DRAG_LEAVE"},e)},onNodePreDrop:function(e){return this._modelEvents.subscribe({event:"NODE/PRE_DROP"},e)},onNodeDrop:function(e){this._onDropCallBack=e},onNodePostDrop:function(e){return this._modelEvents.subscribe({event:"NODE/POST_DROP"},e)},onPreExpand:function(e){return this._modelEvents.subscribe({event:"preExpand"},e)},onPostExpand:function(e){return this._modelEvents.subscribe({event:"postExpand"},e)},onPreCollapse:function(e){return this._modelEvents.subscribe({event:"preCollapse"},e)},onPostCollapse:function(e){return this._modelEvents.subscribe({event:"postCollapse"},e)},onNodeClick:function(e){return this._modelEvents.subscribe({event:"click"},e)},onNodeDblClick:function(e){return this._modelEvents.subscribe({event:"dblClick"},e)},onLabelChange:function(e){this._modelEvents.subscribe({event:"UPDATE_LABEL"},e)},delegateEvents:function(e){},search:function(e){this.getRoots().forEach(function(t){t.search(e)})},_createNode:function(e){return new this.options.nodeClass(e)},_loadModel:function(e){var t=this;!function e(i,n,s){var o;0==++s?n.forEach(function(i){e(o=t.addRoot(i),i,s)}):n.children&&n.children.forEach(function(n){o=t._createNode(n),i.addChild(o),e(o,n,s)}),s--}(this._treeRoot,e,-1)}});return d.themes={default:c},e.namespace("WUX/Controls/TreeBase",d)}),define("DS/Controls/Tree",["UWA/Core","UWA/Event","DS/Core/Core","DS/Controls/TreeBase","DS/Controls/TreeNode","DS/Selection/HSOManager","DS/Selection/CSOManager","DS/Utilities/Css","DS/Panels/SidePanel"],function(e,t,i,n,s,o,l,a,r){"use strict";function h(e,t){if(e instanceof Function)return t instanceof Function&&e.toString()===t.toString();if(null==e||null==t)return e===t;if(e===t||e.valueOf()===t.valueOf())return!0;if(e instanceof Date)return!1;if(t instanceof Date)return!1;if(!(e instanceof Object))return!1;if(!(t instanceof Object))return!1;var i=Object.keys(e);return void 0!==e.pathElement&&void 0!==t.pathElement?e.pathElement.isEqual(t.pathElement):!!Object.keys(t).every(function(e){return-1!==i.indexOf(e)})&&i.every(function(i){return h(e[i],t[i])})}var u={shadow:!0,expander:{size:10},link:{size:1,color:"#04C7F0",bgColor:"transparent",style:"solid"},label:{borderRadius:1,padding:"2px 4px",verticalAlign:"middle",border:"1px solid rgba(255,255,255,0.5)",minHeight:"1em",lineHeight:"1em"},expandState:{class:"Expander",text:"+",styles:{backgroundColor:"#FFF",borderColor:"#04C7F0",height:10,width:10,lineHeight:"8px",cursor:"pointer",zIndex:1e3}},collapseState:{class:"Expander",text:"",styles:{backgroundColor:"#FFF",borderColor:"#04C7F0",height:10,width:10,lineHeight:"8px",cursor:"pointer",zIndex:1e3}},asyncState:{class:"Expander",text:"",styles:{backgroundColor:"#FFF",borderColor:"#04C7F0",height:10,width:10,lineHeight:"8px",cursor:"pointer",zIndex:1e3}},noExpandState:{class:"NoExpander Link",text:"",styles:{backgroundColor:"transparent",borderTop:"1px solid #04C7F0",width:5,cursor:"pointer",zIndex:1e3}}},c=n.extend({defaultOptions:{isEditable:!1,nodeClass:s},init:function(e){e.UI=u,this._parent(e),this.elements.container.addClassName("wux-controls-tree"),this._highlightedNodes=[],this._modeIsMultiSel=!1,this._modeIsListSel=!1,this._selectionManagement()},_selectNode:function(e,t){var i={pathElement:e.options.pathElement};return t?(l.unique(i),o.unique(i)):l.isIn(i)?(l.remove(i),o.remove(i)):(l.add(i),o.add(i)),i},_selectionManagement:function(){var e,t=this,i=null,n=null,s=0;this._onNodeClickCB=function(e){if(s++,!n&&i&&t._modeIsListSel&&(n=e,t._selectNode(e)),i&&(null===i||null===n)||s%2==0||(i=e,n=null,s=1),t._modeIsMultiSel)t._selectNode(e);else if(t._modeIsListSel){n=e;var o=e.getParent();if(o){var l=!1;o.getChildren().forEach(function(e,s){h(e.options.pathElement,i.options.pathElement)&&(l=!0),l&&!h(e.options.pathElement,n.options.pathElement)&&t._selectNode(e),h(e.options.pathElement,n.options.pathElement)&&(l=!1)})}}else t._selectNode(e,!0)},this._onNodeClickToken=this.onNodeClick(this._onNodeClickCB);var o=function(i){var n=i.pathElement,s=t._searchPathElement(n);s&&s.elements&&s.elements.label&&(e=a.recordState(s.elements.label,["box-shadow","font-weight","text-shadow"]),t._highlightedNodes.push(s),s._isHighlighted=!0,s.elements.label.setStyles({boxShadow:"inset 0px 0px 7px rgb(0, 133, 255), inset 0 0 200px #0FF"}))};function r(){t.getContent().offsetParent&&!t._panelIsHidden&&(t._highlightedNodes.forEach(function(i,n){t._highlightedNodes.splice(n,1),i.elements&&i.elements.label&&e&&a.restoreState(i.elements.label,e,["box-shadow","font-weight","text-shadow"])}),l.get().forEach(o))}t.onPostExpand(function(e){r()}),t.onPostCollapse(function(e){r()}),t._modelEvents.subscribe({event:"EVT_TREE_IS_SHOWN"},function(){r()}),l.onPostAdd(function(e){r()}),l.onRemove(function(i){var n=i.pathElement,s=t._searchPathElement(n);s&&s.elements&&s.elements.label&&(s._isHighlighted=!1,a.restoreState(s.elements.label,e,["box-shadow","font-weight","text-shadow"]))})},_buildCustomView:function(){this._panelIsHidden=!1,this._sidePanel=new r({side:"left"}).inject(this.elements.container),this._sidePanel.elements.container.setStyles({minHeight:0,minWidth:0}),this._sidePanel.elements.content.setStyles({height:"100%",boxSizing:"border-box",backgroundColor:"transparent",padding:"0 5px",pointerEvents:"none"}),this._sidePanel.elements.panel.setStyles({backgroundColor:"transparent",border:"none",pointerEvents:"none"}),this._sidePanel.appendChild(this.elements.scrollContainer).setStyles({height:"100%"});var e=this;this._sidePanel.onSlideIn(function(){e._panelIsHidden=!1,e._modelEvents.publish({event:"EVT_TREE_IS_SHOWN",data:e})}),this._sidePanel.onSlideOut(function(){e._panelIsHidden=!0,e._modelEvents.publish({event:"EVT_TREE_PANEL_IS_HIDDEN",data:e})})},onPanelSlideIn:function(e){return this._modelEvents.subscribe({event:"EVT_TREE_IS_SHOWN"},e)},onPanelSlideOut:function(e){return this._modelEvents.subscribe({event:"EVT_TREE_PANEL_IS_HIDDEN"},e)},slideOut:function(){this._sidePanel.slideOut()},slideIn:function(){this._sidePanel.slideIn()},_getNodeClass:function(){return"TreeNode"},_searchPathElement:function(e,t){var i;if(void 0===t&&(t=!1),e)return this.getRoots().forEach(function(n){i=n,i=function i(n){var s=0,o=null;if(n.options.pathElement&&n.options.pathElement.isAParentOf(e)){if(t&&n.expand(1),n._children&&n._isExpanded)for(s=0;s<n._children.length&&!o;s++)o=i(n._children[s]);o||(o=n)}return o}(n)}),i}});return e.namespace("WUX/Controls/Tree",c)});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/ColorEditors",["require","exports","DS/Controls/Abstract","UWA/Core","DS/Utilities/Dom","DS/Core/WebUXComponents","DS/Utilities/Color","DS/Controls/GradientSlider","DS/Controls/SpinBox","DS/Controls/ButtonGroup","DS/Controls/Button","DS/Controls/Toggle","DS/Utilities/WUXUWAUtils"],function(e,t,i,n,s,o,l,a,r,h,u,c,d){"use strict";var p=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return d.extendingClassFlag,n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:"ff0000",type:"string"},hsvValue:{defaultValue:void 0,type:"array"},availableColorFormats:{defaultValue:void 0,type:"array"},displayStyle:{defaultValue:"tabs",type:"string"},useColorSlidersFlag:{defaultValue:!0,type:"boolean"},showAlphaFlag:{defaultValue:!1,type:"boolean"}}},enumerable:!1,configurable:!0}),t.prototype._preBuildView=function(t){e.prototype._preBuildView.call(this,t),this.hsvValue=l.hexToHsv(this.value),this.availableColorFormats=["RGB","HSV","HSL","RGBA","HSVA","HSLA"],this._currentSubAttribute="Hue"},t.prototype._postBuildView=function(){this.elements.container.addClassName("wux-controls-color-editors"),this._editors={},"tabs"===this.displayStyle&&this.buildTabView(),e.prototype._postBuildView.call(this),"tabs"===this.displayStyle?this._setCurrentColorFormat(this.availableColorFormats[this.showAlphaFlag?3:0]):this._buildStackedLayout(),this._applyDisabled()},t.prototype._refreshEditors=function(){if(this._refreshingEditorsFlag=!0,void 0===this.hsvValue)for(var e=0;e<this._editors.spinBox.length;e++)this._editors.spinBox[e].value=void 0,this._editors.slider&&(this._editors.slider[e].value=void 0,this._editors.slider[e].modulationColor=void 0);else if(void 0===this._editors||void 0===this._editors.spinBox||0===this._editors.spinBox.length);else{if(this._editors.slider)for(e=0;e<this._editors.slider.length;e++)this._editors.slider[e].modulationColor=this.hsvValue;var t=void 0;if("tabs"===this.displayStyle)switch(this._currentColorFormat){case"RGB":t=[(n=l.hsvToRgb(this.hsvValue)).r,n.g,n.b];break;case"RGBA":t=[(s=l.hsvToRgb(this.hsvValue)).r,s.g,s.b,s.a];break;case"HSV":case"HSVA":t=this.hsvValue;break;case"HSL":t=l.hsvToHsl(this.hsvValue);break;case"HSLA":t=l.hsvToHsl(this.hsvValue)}else{t=[];for(var i=0;i<this.availableColorFormats.length;i++)switch(this.availableColorFormats[i]){case"RGB":var n=l.hsvToRgb(this.hsvValue);t=t.concat([n.r,n.g,n.b]);break;case"RGBA":var s=l.hsvToRgb(this.hsvValue);t=t.concat([s.r,s.g,s.b,s.a]);break;case"HSV":t=t.concat([this.hsvValue[0],this.hsvValue[1],this.hsvValue[2]]);break;case"HSVA":t=t.concat([this.hsvValue[0],this.hsvValue[1],this.hsvValue[2],this.hsvValue[3]]);break;case"HSL":var o=l.hsvToHsl(this.hsvValue);t=t.concat([o[0],o[1],o[2]]);break;case"HSLA":var a=l.hsvToHsl(this.hsvValue);t=t.concat([a[0],a[1],a[2],a[3]])}t=t.concat(this.hsvValue[3])}if(t)for(e=0;e<this._editors.spinBox.length;e++){var r=void 0;r=1!==e||"HSL"!==this._currentColorFormat&&"HSLA"!==this._currentColorFormat||void 0===this._hslSaturationBackup?Math.round(t[e]):this._editors.slider[e].value=this._hslSaturationBackup,this._editors.slider&&this._editors.slider[e]&&(this._editors.slider[e].value=r),this._editors.spinBox[e].value=r}}this._refreshingEditorsFlag=!1},t.prototype._applyValue=function(){this._applyingValue=!0,this._applyingHsvValue||(this.hsvValue=l.hexToHsv(this.value),this._refreshEditors()),this._applyingValue=!1},t.prototype._applyHsvValue=function(){this._applyingHsvValue=!0,this._applyingValue||(this.value=l.hsvToHex(this.hsvValue),this._refreshEditors()),this._applyingHsvValue=!1},t.prototype._buildStackedLayout=function(){var e=0,t=[],i=[],s=[],o=[],h=l.hsvToRgb(this.hsvValue),u=void 0;void 0!==h&&(u=[h.r,h.g,h.b],void 0!==h.a&&(u[3]=h.a));for(var d=l.hsvToHsl(this.hsvValue),p=0;p<this.availableColorFormats.length;p++)switch(this.availableColorFormats[p]){case"RGB":e+=3,t.push("R","G","B"),i.push("Red","Green","Blue"),s.push(255,255,255),o=o.concat(u);break;case"RGBA":e+=4,t.push("R","G","B","A"),i.push("Red","Green","Blue","Alpha"),s.push(255,255,255,255),o=o.concat(u);break;case"HSV":e+=3,t.push("H","S","V"),i.push("Hue","Saturation","Value"),s.push(360,100,100),o=o.concat(this.hsvValue);break;case"HSVA":e+=4,t.push("H","S","V","A"),i.push("Hue","Saturation","Value","Alpha"),s.push(360,100,100,255),o=o.concat(this.hsvValue);break;case"HSL":e+=3,t.push("H","S","L"),i.push("Hue","HslSaturation","Lightness"),s.push(360,100,100),o=o.concat(d);break;case"HSLA":e+=4,t.push("H","S","L","A"),i.push("Hue","HslSaturation","Lightness","Alpha"),s.push(360,100,100,255),o=o.concat(d)}if(this.showAlphaFlag&&(e++,t.push("A"),i.push("Alpha"),s.push(255)),this._editors.editorContainer)for(var m=0;m<this._editors.editorContainer.length;m++)this._editors.editorContainer[m].remove().destroy(),this._editors.radio[m].remove().destroy(),this._editors.label[m].remove().destroy(),this._editors.slider&&this._editors.slider[m].remove().destroy(),this._editors.spinBox[m].remove().destroy();this._editors.editorContainer=new Array(e),this._editors.radio=new Array(e),this._editors.label=new Array(e),this.useColorSlidersFlag?this._editors.slider=new Array(e):this._editors.slider=void 0,this._editors.spinBox=new Array(e);for(m=0;m<e;m++)this._editors.editorContainer[m]=new n.Element("div",{class:"wux-color-container"}).inject(this.elements.container),this._editors.radio[m]=new c({type:"radio",fireOnlyFromUIInteractionFlag:!0}).inject(this._editors.editorContainer[m]),this._editors.label[m]=new n.Element("div",{class:"wux-color-editor-label",text:t[m]}).inject(this._editors.editorContainer[m]),this._editors.slider&&(this._editors.slider[m]=new a({value:o?o[m]:void 0,gradientType:i[m],modulationColor:this.hsvValue,valuePopupFlag:!1,fireOnlyFromUIInteractionFlag:!0}).inject(this._editors.editorContainer[m])),this._editors.spinBox[m]=new r({value:o?Math.round(o[m]):void 0,stepValue:1,maxValue:s[m],minValue:0,fireOnlyFromUIInteractionFlag:!0,displayStyle:"lite",selectAllOnFocus:!0}).inject(this._editors.editorContainer[m]);this.showAlphaFlag&&this._editors.radio[this._editors.radio.length-1].getContent().setStyle("visibility","hidden"),this._refreshRadioButtons()},t.prototype._setCurrentColorFormat=function(e){if("stacked"!==this.displayStyle){var t,i,s,o,h;this._currentColorFormat=e,this._editors.buttonGroup.value=[e];var u=l.hsvToRgb(this.hsvValue),d=void 0;void 0!==u&&(d=[u.r,u.g,u.b],u.a&&(d[3]=u.a));var p=l.hsvToHsl(this.hsvValue);switch(this._currentColorFormat){case"RGB":t=3,i=["R","G","B"],s=["Red","Green","Blue"],o=[255,255,255],h=d;break;case"RGBA":t=4,i=["R","G","B","A"],s=["Red","Green","Blue","Alpha"],o=[255,255,255,255],h=d;break;case"HSV":t=3,i=["H","S","V"],s=["Hue","Saturation","Value"],o=[360,100,100],h=this.hsvValue;break;case"HSVA":t=4,i=["H","S","V","A"],s=["Hue","Saturation","Value","Alpha"],o=[360,100,100,255],h=this.hsvValue;break;case"HSL":t=3,i=["H","S","L"],s=["Hue","HslSaturation","Lightness"],o=[360,100,100],h=p;break;case"HSLA":t=4,i=["H","S","L","A"],s=["Hue","HslSaturation","Lightness","Alpha"],o=[360,100,100,255],h=p}if(this._editors.editorContainer)for(var m=0;m<this._editors.editorContainer.length;m++)this._editors.editorContainer[m].remove().destroy(),this._editors.radio[m].remove().destroy(),this._editors.label[m].remove().destroy(),this._editors.slider&&this._editors.slider[m].remove().destroy(),this._editors.spinBox[m].remove().destroy();this._editors.editorContainer=new Array(t),this._editors.radio=new Array(t),this._editors.label=new Array(t),this.useColorSlidersFlag?this._editors.slider=new Array(t):this._editors.slider=void 0,this._editors.spinBox=new Array(t);for(m=0;m<t;m++)this._editors.editorContainer[m]=new n.Element("div",{class:"wux-color-container"}).inject(this.elements.container),this._editors.radio[m]=new c({type:"radio",fireOnlyFromUIInteractionFlag:!0}).inject(this._editors.editorContainer[m]),this._editors.label[m]=new n.Element("div",{class:"wux-color-editor-label",text:i[m]}).inject(this._editors.editorContainer[m]),this._editors.slider&&(this._editors.slider[m]=new a({value:h?h[m]:void 0,gradientType:s[m],modulationColor:this.hsvValue,valuePopupFlag:!1,fireOnlyFromUIInteractionFlag:!0,maxValue:o[m]}).inject(this._editors.editorContainer[m])),this._editors.spinBox[m]=new r({value:h?Math.round(h[m]):void 0,stepValue:1,maxValue:o[m],minValue:0,fireOnlyFromUIInteractionFlag:!0,displayStyle:"lite",selectAllOnFocus:!0}).inject(this._editors.editorContainer[m]);this.showAlphaFlag&&this._editors.radio[this._editors.radio.length-1].getContent().setStyle("visibility","hidden"),this._refreshRadioButtons()}},t.prototype.setColorSubAttribute=function(e,t){void 0===this.hsvValue&&(this.hsvValue=[0,1,1,this.showAlphaFlag?255:void 0]);var i=l.hsvToRgb(this.hsvValue),n=l.hsvToHsl(this.hsvValue);switch(e){case"Hue":this.hsvValue=[t,this.hsvValue[1],this.hsvValue[2],this.hsvValue[3]];break;case"HslSaturation":this._hslSaturationBackup=t,this.hsvValue=l.hslToHsv([n[0],t,n[2],n[3]]);break;case"Saturation":this.hsvValue=[this.hsvValue[0],t,this.hsvValue[2],this.hsvValue[3]];break;case"Value":this.hsvValue=[this.hsvValue[0],this.hsvValue[1],t,this.hsvValue[3]];break;case"Lightness":var s=this._hslSaturationBackup?this._hslSaturationBackup:n[1];this.hsvValue=l.hslToHsv([n[0],s,t,n[3]]);break;case"Red":this.hsvValue=l.rgbToHsv(t,i.g,i.b,i.a);break;case"Green":this.hsvValue=l.rgbToHsv(i.r,t,i.b,i.a);break;case"Blue":this.hsvValue=l.rgbToHsv(i.r,i.g,t,i.a);break;case"Alpha":this.hsvValue=l.rgbToHsv(i.r,i.g,i.b,t)}},t.prototype.buildTabView=function(){this._editors.buttonGroupDiv=new n.Element("div",{class:"wux-buttongroup-div"}).inject(this.elements.container),this._editors.buttonGroup=(new h).inject(this._editors.buttonGroupDiv);var e=this.showAlphaFlag?"A":"";this._editors.buttonGroup.addChild(new u({type:"radio",label:"RGB"+e,value:"RGB"+e})),this._editors.buttonGroup.addChild(new u({type:"radio",label:"HSV"+e,value:"HSV"+e})),this._editors.buttonGroup.addChild(new u({type:"radio",label:"HSL"+e,value:"HSL"+e})),this._editors.buttonGroup.value=this._currentColorFormat},t.prototype._applyDisabled=function(){e.prototype._applyDisabled.call(this);var t=this.disabled;if(this._editors&&(this._editors.buttonGroup&&(this._editors.buttonGroup.disabled=t),this._editors.radio))for(var i=0;i<this._editors.radio.length;i++)this._editors.radio[i].disabled=t,this._editors.slider&&(this._editors.slider[i].disabled=t),this._editors.spinBox[i].disabled=t},t.prototype.buildView=function(){},t.prototype._refreshRadioButtons=function(){for(var e=0;e<this._editors.radio.length;e++)this._editors.radio[e].checkFlag=!1;for(var t=this._buildSubColorAttributeTypeArray(),i=0;i<this._editors.radio.length;i++)t[i]===this._currentSubAttribute&&(this._editors.radio[i].checkFlag=!0)},t.prototype._buildSubColorAttributeTypeArray=function(){var e;if("tabs"===this.displayStyle)switch(this._currentColorFormat){case"RGB":e=["Red","Green","Blue"];break;case"RGBA":e=["Red","Green","Blue","Alpha"];break;case"HSV":e=["Hue","Saturation","Value"];break;case"HSVA":e=["Hue","Saturation","Value","Alpha"];break;case"HSL":e=["Hue","HslSaturation","Lightness"];break;case"HSLA":e=["Hue","HslSaturation","Lightness","Alpha"]}else{e=[];for(var t=0;t<this.availableColorFormats.length;t++)switch(this.availableColorFormats[t]){case"RGB":e.push("Red","Green","Blue");break;case"HSV":e.push("Hue","Saturation","Value");break;case"HSL":e.push("Hue","HslSaturation","Lightness")}this.showAlphaFlag&&e.push("Alpha")}return e},t.prototype._handleEvents=function(){var e=this;s.addEventOnElement(this,this.elements.container,"beginEdit",function(t){t.dsModel!==e&&(t.stopPropagation(),e.fire("beginEdit"))}),s.addEventOnElement(this,this.elements.container,"endEdit",function(t){t.dsModel!==e&&(t.stopPropagation(),e.fire("endEdit"))}),s.addEventOnElement(this,this.elements.container,"cancelEdit",function(t){t.dsModel!==e&&(t.stopPropagation(),e.fire("cancelEdit"))}),s.addEventOnElement(this,this.elements.container,"change",function(t){if(t.dsModel!==e&&(t.stopPropagation(),!e._refreshingEditorsFlag))if(t.dsModel===e._editors.buttonGroup)e._setCurrentColorFormat(e._editors.buttonGroup.value[0]);else{if(!t.dsModel)return;for(var i=e._buildSubColorAttributeTypeArray(),n=void 0,s=0;s<i.length;s++){switch(t.dsModel){case e._editors.radio[s]:return e._currentSubAttribute=i[s],"Alpha"!==e._currentSubAttribute&&e._refreshRadioButtons(),void e.fire("changeModulation",{colorSubAttributeType:i[s],currentColorFormat:e._currentColorFormat});case e._editors.slider&&e._editors.slider[s]:"Lightness"===i[s]&&(e._hslSaturationBackup=e._editors.slider[1].value),e.setColorSubAttribute(i[s],t.dsModel.value),e._editors.spinBox[s].value=Math.round(t.dsModel.value),n=s;break;case e._editors.spinBox[s]:e.setColorSubAttribute(i[s],t.dsModel.value),e._editors.slider&&(e._editors.slider[s].value=t.dsModel.value),n=s}if(n)break}e.fire("change",{colorSubAttributeType:i[n],currentColorFormat:e._currentColorFormat})}})},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("value")&&this._applyValue(),this.isDirty("hsvValue")&&this._applyHsvValue()},t}(i);return o.addClass(p,"ColorEditors"),p}),define("DS/Controls/TimePicker",["UWA/Core","DS/Utilities/Dom","DS/Controls/Abstract","DS/Controls/LineEditor","DS/Controls/Button","DS/Controls/Popup","DS/Controls/TimeChooser","DS/WebRecordEnabler/Adapter"],function(e,t,i,n,s,o,l,a){"use strict";function r(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())}function h(e,t){if(!r.call(this,e)||!r.call(this,t))return!1;var i={hour:"2-digit",minute:"2-digit"};return"sec"===this.precision&&(i.second="2-digit"),e.toLocaleTimeString("en",i)===t.toLocaleTimeString("en",i)}function u(){if(this.value){var e={hour:"2-digit",minute:"2-digit"};"sec"===this.precision&&(e.second="2-digit");var t="";if(t="12"===this.mode?"en-US":"en-GB","duration"===this.mode){var i=this.getHours();i<10&&(i="0"+i);var n=this.getMinutes();if(n<10&&(n="0"+n),"sec"===this.precision){var s=Math.floor(this.value/1e3)%60;s<10&&(s="0"+s),this.elements.inputField.value=i+"h "+n+"m "+s+"s"}else this.elements.inputField.value=i+"h "+n+"m"}else t&&this.value.toLocaleTimeString?this.elements.inputField.value=this.value.toLocaleTimeString(t,e):this.elements.inputField.value=""}else this.elements.inputField.value=""}function c(e,t){switch(t){case"hr":return 36e5*e;case"min":return 6e4*e;case"sec":return 1e3*e;default:return 1}}function d(e,t){return"sec"===t?36e5*e.getHours()+6e4*e.getMinutes()+1e3*e.getSeconds():36e5*e.getHours()+6e4*e.getMinutes()}var p=i.inherit({name:"timePicker",markForRecordFlag:!0,publishedProperties:{value:{defaultValue:null,type:"date",category:"Behavior",recordFlag:!0,advancedSetter:!0},precision:{defaultValue:"min",type:"string",category:"Behavior"},mode:{defaultValue:"24",type:"string",category:"Behavior"},hoursStep:{defaultValue:1,type:"integer",category:"Behavior"},minutesStep:{defaultValue:1,type:"integer",category:"Behavior"},secondsStep:{defaultValue:1,type:"integer",category:"Behavior"},popupVisibleFlag:{defaultValue:!1,type:"boolean",category:"Behavior",recordFlag:!0},allowUndefinedFlag:{defaultValue:!1,type:"boolean",category:"Behavior"}},buildView:function(){this._parent(),this.elements.container.addClassName("wux-controls-timepicker"),this.elements.inputField=new n({sizeInCharNumber:20,selectAllOnFocus:!0}).inject(this.elements.container),this.elements.inputField.getContent().addClassName("wux-controls-timepicker-lineeditor"),this.elements.timeChooserButton=new s({emphasize:"primary",icon:{iconName:"clock",fontIconSize:"1x",fontIconFamily:WUXManagedFontIcons.Font3DS},displayStyle:"lite"}).inject(this.elements.container),this.elements.timeChooserButton.getContent().addClassName("wux-controls-timepicker-button"),this.value=new Date,this._onShowPopupValue=new Date,function(){var i=this,n={target:this.elements.timeChooserButton.getContent(),position:"bottom",constraint:"screen",alignment:"far",trigger:"click",overlap:!1,className:"wux-controls-popup wux-controls-timepicker-popup",positionTarget:i.elements.inputField,getBody:function(){return i.elements.timeChooser=new l({value:i.value,hoursStep:i.hoursStep,minutesStep:i.minutesStep,secondsStep:i.secondsStep,mode:i.mode,precision:i.precision}),i.elements.timeChooser.addEventListener("change",function(t){t.stopPropagation(),t.dsModel&&"undefined"!==t.dsModel.value&&("duration"===i.mode?e.equals(i.value,t.dsModel.value)||(i.value=t.dsModel.value):h.call(i,i.value,i.elements.timeChooser.value)||(i.value=new Date(t.dsModel.value)),u.call(i))}),i.elements.timeChooser}};o.delayPopupCreation(n,function(n){i.elements.popup=n,i.elements.popup.addEventListener("hide",function(n){i.popupVisibleFlag=!1,t.pushUserInteractionContext(),i.value&&("duration"===i.mode?e.equals(i.value,n.dsModel.value)||i.fire("change"):h.call(i,i.value,i._onShowPopupValue)||i.fire("change")),n.stopPropagation(),i.elements.timeChooserButton&&i.elements.timeChooserButton.getContent().removeAttribute("wuxactive"),i.fire("hide"),t.popUserInteractionContext()}),i.elements.popup.addEventListener("show",function(t){i.popupVisibleFlag=!0,"duration"===i.mode?i._onShowPopupValue=i.value:i._onShowPopupValue=new Date(i.value),i.value&&("duration"===i.mode?e.equals(i.value,i.elements.timeChooser.value)||(i.elements.timeChooser.value=i.value):h.call(i,i.value,i.elements.timeChooser.value)||(i.elements.timeChooser.value=new Date(i.value))),t.stopPropagation(),i.elements.timeChooserButton&&i.elements.timeChooserButton.getContent().setAttribute("wuxactive",""),i.fire("show")})})}.call(this)},handleEvents:function(){var e=this;t.addEventOnElement(this,this.elements.inputField,"change",function(t){if(t.stopPropagation(),t.dsModel)if(t.dsModel.value){var i=t.dsModel.value;if("duration"===e.mode){var n=function(e){for(var t=0,i=e.trim().split(" ").join("").split(/[hms]/),n="hr",s=0;s<i.length;s++)if(""!==i[s]){if(s>0&&(i[s]>59||i[s]<0))return NaN;t+=c(i[s],n),"hr"===n?n="min":"min"===n&&(n="sec")}return t}(i);n&&!isNaN(n)&&e.setPropertyFromUIInteraction("value",n)}else{0===i.search(/[0-9]*[0-9]*\s*[AP]/i)&&(i=(i=i.replace(/\s/g,"")).slice(0,-2)+":00 "+i.slice(-2));var s=new Date("2016/07/13 "+i);!s||isNaN(s.getTime())||h.call(e,s,e.value)||e.setPropertyFromUIInteraction("value",s)}u.call(e)}else e.allowUndefinedFlag&&""===t.dsModel.value?e.setPropertyFromUIInteraction("value",void 0):u.call(e)})},getHours:function(){return"duration"===this.mode?Math.floor(this.value/36e5):this.value.getHours()},getMinutes:function(){return"duration"===this.mode?Math.floor(this.value/6e4%60):this.value.getMinutes()},_preEditValue:function(t,i){return!i||("string"==typeof i?(this.value=new Date(Date.parse(i)),!1):i instanceof Date?!e.equals(t,i):void 0)},_applyValue:function(){"duration"===this.mode?"object"==typeof this.value&&(this.value=d(this.value,this.precision)):void 0!==this.value&&"object"!=typeof this.value&&(this.value=new Date(this.value)),u.call(this),this.elements.popup&&this.elements.popup.visibleFlag?"duration"===this.mode?e.equals(this.value,this.elements.timeChooser.value)||(this.elements.timeChooser.value=this.value):(h.call(this,this.elements.timeChooser.value,this.value)||(this.elements.timeChooser.value=new Date(this.value)),this.fire("liveChange")):this.fire("change")},_applyPrecision:function(e){"min"===this.precision||"sec"===this.precision?(u.call(this),this.elements.timeChooser&&(this.elements.timeChooser.precision=this.precision)):this.precision=e},_applyMode:function(e){if("duration"===this.mode){var t=d(this.value,this.precision);this.value=t}u.call(this),this.elements.timeChooser&&(this.elements.timeChooser.mode=this.mode)},_applyHoursStep:function(e){this.elements.timeChooser&&(this.elements.timeChooser.hoursStep=this.hoursStep)},_applyMinutesStep:function(e){this.elements.timeChooser&&(this.elements.timeChooser.minutesStep=this.minutesStep)},_applySecondsStep:function(e){this.elements.timeChooser&&(this.elements.timeChooser.secondsStep=this.secondsStep)},_applyDisabled:function(e){this._parent(),this.elements.inputField.disabled=this.disabled,this.elements.timeChooserButton.disabled=this.disabled},_applyPopupVisibleFlag:function(e){this.elements.popup&&(this.popupVisibleFlag?this.elements.popup.visibleFlag=!0:this.elements.popup.visibleFlag=!1)},_applyTouchMode:function(){this._parent(),this.elements.timeChooserButton&&(this.elements.timeChooserButton.touchMode=this.touchMode),this.elements.inputField&&(this.elements.inputField.touchMode=this.touchMode)},_applyProperties:function(e){this._parent(e),this.isDirty("hoursStep")&&this._applyHoursStep(e.hoursStep),this.isDirty("minutesStep")&&this._applyMinutesStep(e.minutesStep),this.isDirty("secondsStep")&&this._applySecondsStep(e.secondsStep),this.isDirty("mode")&&this._applyMode(e.mode),this.isDirty("precision")&&this._applyPrecision(e.precision),this.isDirty("value")&&this._applyValue(e.value)}});return a.register(p,"DS/ControlsRec/AbstractRec"),p}),define("DS/Controls/DatePicker",["UWA/Core","DS/Controls/Abstract","DS/Core/Core","DS/Utilities/Dom","DS/Utilities/DateUtils","DS/Controls/TooltipModel","DS/Controls/Popup","DS/Controls/Calendar","DS/Controls/TimePicker","DS/Controls/LineEditor","DS/Controls/Button","DS/Controls/SelectionChipsEditor","DS/Controls/SelectionChips","DS/WebRecordEnabler/Adapter","DS/Utilities/KeyboardUtils","DS/Core/PointerEvents","DS/Core/WebUXComponents","i18n!DS/Controls/assets/nls/translation"],function(e,t,i,n,s,o,l,a,r,h,u,c,d,p,m,g,v,f){"use strict";let y={};function b(){if(y.displayLang!==this._currentLanguage){let e=this._currentLanguage,t=new Date(2022,1),i="2022",n={year:"numeric"};y={displayLang:e};let s=new Intl.DateTimeFormat(e,n),o=s.formatToParts(t).some(e=>e.value===i);o||(e=e.split("-")[0])!==this._currentLanguage&&(o=(s=new Intl.DateTimeFormat(e,n)).formatToParts(t).some(e=>e.value===i)),o||(e="en-GB"),y.editLang=e;let l=(s=new Intl.DateTimeFormat(y.editLang,{hour:"numeric",minute:"numeric"})).format(new Date);l=l.toLowerCase().trim(),y.ampm=l.endsWith("am")||l.endsWith("a.m.")||l.endsWith("pm")||l.endsWith("p.m.")}this.elements&&this.elements.timePicker&&(this.elements.timePicker.mode=y.ampm?"12":"24")}let _=function(){const e=["year","month","day","hour","minute","second"];return function(t){let i="";for(let n of e)t[n]&&(i+=n+"|"+t[n]+"|");return i}}();function C(){let e={year:"numeric",month:"numeric",day:"numeric"};return this.timePickerFlag&&(e.hourCycle=y.ampm?"h12":"h23",e.hour="numeric",e.minute="numeric","sec"===this.timePickerPrecision&&(e.second="numeric")),e}function w(){let e={year:"numeric",month:"short",day:"numeric"};return this.timePickerFlag&&(e.hour="numeric",e.minute="numeric","sec"===this.timePickerPrecision&&(e.second="numeric")),e}let x=function(){const e=["/",":"," "],t=["hour","minute","second"],i=["year","month","day"],n=new Date(2022,1,1,15,4,5);return function(s){let o="display"===s||"displayNeg"===s?w.call(this):C.call(this),l=s+"_"+_(o);return y[l]||function(){let s=w.call(this),o=C.call(this),l=_(s),a=_(o),r="display_"+l;y[r]=new Intl.DateTimeFormat(y.displayLang,s),r="displayNeg_"+l,s.era="short",y[r]=new Intl.DateTimeFormat(y.displayLang,s);let h="edit_"+a;y[h]=new Intl.DateTimeFormat(y.editLang,o);let u="parts_"+a,c=y[h].formatToParts(n),d=0,p=0,m=c.length-1,g=y[u]=[];c.forEach((n,s)=>{"literal"===n.type&&s!==m?e.indexOf(n.value)>-1?g.push(n.value):", "===n.value?g.push(" "):p&&p<3?g.push("/"):d?g.push(":"):g.push(" "):i.indexOf(n.type)>-1?(p++,g.push(n.type)):t.indexOf(n.type)>-1?(d++,g.push(n.type)):y.ampm&&"dayPeriod"===n.type&&g.push(n.type)});let v="placeholder_"+a,b="";for(let e=0,t=g.length-(g.length>5&&y.ampm?2:0);e<t;++e){let t=g[e];b+=f["datePicker_"+t]||t}y[v]=b}.call(this),y[l]}}();function E(){let e=x.call(this,"placeholder");return this._tooltipInfos||(this._tooltipInfos=new o),this._tooltipInfos.shortHelp=e,this.elements&&this.elements.inputField&&this.elements.inputField.placeholder&&(this.elements.inputField.placeholder=e),this.elements&&this.elements._selChipsEdt&&this.elements._selChipsEdt.placeholder&&(this.elements._selChipsEdt.placeholder=e),e}function S(e,t,i){this[e]=s.addToDate(this[e],t,i)}function D(e,t,i,n){return s.isDateInBetween(e,t,i,!0===n?"time":n||"day")}function I(e,t,i,n){if(e&&!D(e,t,i,n)){if(t&&e<t)return t;if(i&&e>i)return i}}function V(e,t,i){return s.areDatesEqual(e,t,i?"time":"day")}function F(e,t,i){s.pushUniqueDate(e,t,i?"time":"day")}const A=function(){function e(e,t,i){return e.getFullYear()>0?t.format(e):i.format(e)}return function(t){if(t){let i=x.call(this,"display"),n=x.call(this,"displayNeg");if(t instanceof Date)return e(t,i,n);if(Array.isArray(t))return t.map(t=>e(t,i,n))}}}(),P=function(){const e=["year","month","day","hour","minute","second"];return function(t){let i=x.call(this,"edit"),n=x.call(this,"parts");if(t instanceof Date)return function(t,i,n){const s=t.getFullYear();let o,l=i.formatToParts(t),a="";for(let t=0,i=n.length;t<i;++t)o=l[t],e.indexOf(o.type)>-1?"year"===o.type?a+=s:a+=o.value:y.ampm&&"dayPeriod"===o.type?a+=o.value:a+=n[t];return a}(t,i,n)}}();function T(e){let t=e.toLowerCase().trim(),i=x.call(this,"parts"),n=[],o={year:0,month:1,day:2,hour:3,minute:4,second:5},l=t.endsWith("am")||t.endsWith("a.m."),a=t.endsWith("pm")||t.endsWith("p.m.");for(let e=0,s=i.length;e<s;++e){let s,l=i[e],a="",r=void 0!==o[l];for(t=t.trim();t;)if(s=t[0],r&&("0"<=s&&s<="9"||"-"===s))t=t.substring(1),a+=s;else{if(r||!(s<"0"||s>"9")||"-"===s)break;if(t=t.substring(1),":"!==s||"number"==typeof n[3]&&!isNaN(n[3])){if(s===l)break}else n[0]=n[1]=n[1]=void 0}r&&(n[o[l]]=parseInt(a))}if("number"!=typeof n[3]||isNaN(n[3])?n[3]=0:n[3]>23?n[3]=23:n[3]<0&&(n[3]=0),"number"!=typeof n[4]||isNaN(n[4])?n[4]=0:n[4]>59?n[4]=59:n[4]<0&&(n[4]=0),"number"!=typeof n[5]||isNaN(n[5])?n[5]=0:n[5]>59?n[5]=59:n[5]<0&&(n[5]=0),a&&"number"==typeof n[3]&&1<=n[3]&&n[3]<=11?n[3]+=12:l&&"number"==typeof n[3]&&12===n[3]&&(n[3]=0),("number"!=typeof n[0]||isNaN(n[0]))&&(n[0]=void 0),"number"!=typeof n[1]||isNaN(n[1])?n[1]=void 0:(n[1]-=1,(n[1]<0||n[1]>11)&&(n[1]=void 0)),"number"!=typeof n[2]||isNaN(n[2]))n[2]=void 0;else if("number"==typeof n[0]&&"number"==typeof n[1]){let e=(r=n[0],h=n[1],[31,s.isLeapYear(r)?29:28,31,30,31,30,31,31,30,31,30,31][h]);(n[2]<1||n[2]>e)&&(n[2]=void 0)}var r,h;if(n.every(e=>"number"==typeof e)){let e=new Date(...n);return e.setFullYear(n[0]),e}}function B(){this.elements.popup?this.elements.popup.visibleFlag||(this.elements.popup.visibleFlag=!0):this.elements.calendarButton.getContent().click()}function M(){this.elements.popup&&this.elements.popup.visibleFlag&&(this.elements.popup.visibleFlag=!1)}function k(e){this.elements._selChipsEdt&&(this._updatingChips=!0,this.elements._selChipsEdt.value=A.call(this,e),this._updatingChips=!1)}function L(){if(!this.allowMultipleValuesFlag)if(this._preventUpdateView)this._updateViewNeeded=!0;else if(this.value){let e="";if((e=this._editModeFlag?P.call(this,this.value):A.call(this,this.value))!==this.elements.inputField.value){let t=this._editModeFlag;this._editModeFlag=!1,this.elements.inputField.value=e,this._editModeFlag=t}}else this.elements.inputField.value=""}var O=t.inherit({name:"datePicker",markForRecordFlag:!0,publishedProperties:{value:{defaultValue:void 0,type:"date",category:"Behavior",recordFlag:!0,advancedSetter:!0},minValue:{defaultValue:void 0,type:"date",category:"Behavior"},maxValue:{defaultValue:void 0,type:"date",category:"Behavior"},timePickerFlag:{defaultValue:!1,type:"boolean",category:"Appearance"},timePickerPrecision:{defaultValue:"min",type:"string",category:"Appearance"},popupVisibleFlag:{defaultValue:!1,type:"boolean",category:"Behavior",recordFlag:!0},allowUndefinedFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},allowMultipleValuesFlag:{defaultValue:!1,type:"boolean",category:"Behavior"}},blackBoxFlag:!0,_smartInputClass:"wux-controls-datepicker",keymaps:{esc:"manageEscape"},commands:{manageEscape:function(){M.call(this)}},init:function(...e){this._currentLanguage=i.currentLanguage,b.call(this),this._editModeFlag=!1,this._parent(...e)},buildView:function(){this.elements.container.addClassName(this._smartInputClass),this.elements.inputField=new h({selectAllOnFocus:!0,fireOnlyFromUIInteractionFlag:!0,placeholder:E.call(this)}).inject(this.elements.container),this.elements.calendarButton=new u({emphasize:"primary",icon:{iconName:"calendar",fontIconSize:"1x",fontIconFamily:WUXManagedFontIcons.Font3DS},displayStyle:"lite"}).inject(this.elements.container),this.elements.calendarButton.getContent().addClassName("wux-controls-datepicker-button"),this.elements.popupContent=new e.Element("div",{class:"wux-controls-datepicker-popup-content"}),this.value=new Date,this._buildPopup()},handleEvents:function(){let e=this;n.addEventOnElement(this,this.elements.inputField,"change",function(t){if(t.stopPropagation(),e._editModeFlag&&!e.allowMultipleValuesFlag)if(""!==t.dsModel.value){var i=T.call(e,t.dsModel.value);D(i,e.minValue,e.maxValue,e.timePickerFlag)?e.setPropertyFromUIInteraction("value",i):L.call(e)}else e.allowUndefinedFlag&&""===t.dsModel.value?e.setPropertyFromUIInteraction("value",void 0):L.call(e)}),n.addEventOnElement(this,this.elements.inputField,"click",function(t){t.stopPropagation(),B.call(e)}),n.addEventOnElement(this,this.elements.inputField._getElementToFocus(),"blur",function(){e._editModeFlag=!1,L.call(e)}),n.addEventOnElement(this,this.elements.calendarButton,g.POINTERHIT,e=>e.stopPropagation()),n.addEventOnElement(this,this.elements.container,g.POINTERDOWN,e=>e.stopPropagation()),n.addEventOnElement(this,this.elements.container,g.POINTERHIT,e=>e.stopPropagation()),e._updateOnCurrentLanguageChange=function(){e.elements&&e.elements.container&&(e._currentLanguage=i.currentLanguage,b.call(e),E.call(e),L.call(e),k.call(e,e.value))},i.onlanguagechange(e._updateOnCurrentLanguageChange)},destroy:function(){i.offlanguagechange(this._updateOnCurrentLanguageChange),this._parent()},incrementDay:function(){S.call(this,"value",1,"day")},decrementDay:function(){S.call(this,"value",-1,"day")},incrementMonth:function(){S.call(this,"value",1,"month")},decrementMonth:function(){S.call(this,"value",-1,"month")},_preEditValue:function(e,t){if(void 0===e&&void 0===t)return!1;if(void 0===t)return!0;if(this.allowMultipleValuesFlag){if(!Array.isArray(t))return!1;for(let e=0,i=t.length;e<i;++e){let i=t[e];"string"==typeof i&&(t[e]=new Date(Date.parse(i)))}}else if("string"==typeof t&&(t=new Date(Date.parse(t))),!(t instanceof Date))return!1;let i;if(Array.isArray(t)){i=[];for(let e=0;e<t.length;++e){let n=t[e];D(n=I(n,this.minValue,this.maxValue,this.timePickerFlag)||n,this.minValue,this.maxValue,this.timePickerFlag)&&F(i,n,this.timePickerFlag)}}else D(t=I(t,this.minValue,this.maxValue,this.timePickerFlag)||t,this.minValue,this.maxValue,this.timePickerFlag)&&(i=t);return!(!i||function e(t,i,n){return void 0===i&&void 0===t||!(!t||!i)&&(t instanceof Date&&i instanceof Date?V(t,i,n):Array.isArray(t)&&i instanceof Date?t.some(e=>V(e,i,n)):!(!Array.isArray(t)||!Array.isArray(i))&&t.length===i.length&&t.every(t=>e(t,i,n)))}(e,i,this.timePickerFlag))&&{validValue:i}},_applyValue:function(e,t){L.call(this),this.elements.calendar&&(this.elements.calendar.value=t),k.call(this,t),this._updatingTimePicker=!0,!this.allowMultipleValuesFlag&&this.timePickerFlag&&this.elements.timePicker&&(this.elements.timePicker.value=t?new Date(t):new Date),this._updatingTimePicker=!1,this.elements.popup&&this.elements.popup.visibleFlag&&this.elements.popup._updateView(),this.fire("change")},_applyDisabled:function(){this._parent();const e=this.disabled;this.elements.calendarButton.disabled=e,this.elements.inputField.disabled=e,this.elements._selChipsEdt&&(this.elements._selChipsEdt.disabled=e)},_applyTouchMode:function(){this._parent();const e=this.touchMode;this.elements.calendarButton&&(this.elements.calendarButton.touchMode=e),this.elements.inputField&&(this.elements.inputField.touchMode=e),this.elements.calendar&&(this.elements.calendar.touchMode=e),this.elements._selChipsEdt&&(this.elements._selChipsEdt.touchMode=e)},_correctValueToMinMaxValues:function(){let e=this.value,t=this.minValue,i=this.maxValue;if(e&&e instanceof Date){const n=I(e,t,i,this.timePickerFlag);n&&(this.value=n)}else if(e&&Array.isArray(e)){let n;e=e.map(e=>{const s=I(e,t,i,this.timePickerFlag);return s&&(n=!0),s||e}),n&&(this.value=e)}},_applyMinValue:function(){this._correctValueToMinMaxValues(),this.elements.calendar&&(this.elements.calendar.minValue=this.minValue)},_applyMaxValue:function(){this._correctValueToMinMaxValues(),this.elements.calendar&&(this.elements.calendar.maxValue=this.maxValue)},_applyTimePickerFlag:function(e,t){if(t!==e){if(t)this._buildTimePicker();else if(this.elements.timePicker){this.elements.timePicker.destroy(),delete this.elements.timePicker,this.elements.calendar&&(this.elements.calendar._timePicker=void 0),this.elements.calendar.getContent().querySelector(".wux-controls-calendar-timePicker").style.display=""}E.call(this),this.allowMultipleValuesFlag?k.call(this,this.value):L.call(this)}},_applyTimePickerPrecision:function(){this.elements.timePicker&&(this.elements.timePicker.precision=this.timePickerPrecision),E.call(this),this.allowMultipleValuesFlag?k.call(this,this.value):L.call(this)},_applyAllowMultipleValuesFlag:function(e,t){if(t===e)return;const i=this.value;t&&i&&!Array.isArray(i)?this._properties.value.value=[i]:!t&&i&&Array.isArray(i)&&(this._properties.value.value=1!==i.length?void 0:i[0]),this.elements.calendar&&this.elements.calendar.setProperties({allowUndefinedFlag:t||this.allowUndefinedFlag,allowMultipleValuesFlag:t,value:this.value}),this._buildSelectionChipsEditor(),t?(this.elements.inputField.remove(),this.elements.calendarButton.getContent().style.display="none",this.elements._selChipsEdt.inject(this.elements.container)):(this.elements._selChipsEdt&&this.elements._selChipsEdt.remove(),this.elements.inputField.inject(this.elements.container,"top"),this.elements.calendarButton.getContent().style.display="")},_applyTooltipInfos:function(e,t){this._parent(e,t),this.elements._selChipsEdt&&(this.elements._selChipsEdt.tooltipInfos=t?void 0:this._tooltipInfos)},_applyProperties:function(e){this._parent(e),this._preventUpdateView=!0,this.isDirty("value")&&v._applyForAdvancedSetterProperty(this,"value",e.value,this.value),this.isDirty("minValue")&&this._applyMinValue(e.minValue,this.minValue),this.isDirty("maxValue")&&this._applyMaxValue(e.maxValue,this.maxValue),this.isDirty("timePickerFlag")&&this._applyTimePickerFlag(e.timePickerFlag,this.timePickerFlag),this.isDirty("timePickerPrecision")&&this._applyTimePickerPrecision(e.timePickerPrecision,this.timePickerPrecision),this.isDirty("allowMultipleValuesFlag")&&this._applyAllowMultipleValuesFlag(e.allowMultipleValuesFlag,this.allowMultipleValuesFlag),this._preventUpdateView=!1,this._updateViewNeeded&&(L.call(this),this._updateViewNeeded=!1)},_getElementToFocus:function(){return this.elements[this.allowMultipleValuesFlag?"_selChipsEdt":"inputField"]._getElementToFocus()},_onFocusReceived:function(){this._isFocused()||(this._parent(),this._editModeFlag=!0,L.call(this),this.allowMultipleValuesFlag?this.elements._selChipsEdt&&this.elements._selChipsEdt._onFocusReceived():(this.elements.inputField._resetFocus(),this.elements.inputField._onFocusReceived()))},_giveFocus:function(){this._isFocused()||(this._parent(),this._editModeFlag=!0,L.call(this),this.elements.inputField._giveFocus())},_applyPopupVisibleFlag:function(){this.elements.popup&&(this.elements.popup.visibleFlag=Boolean(this.popupVisibleFlag))},_buildPopup:function(){var e=this,t={target:this.elements.calendarButton.getContent(),position:"bottom",offset:{x:0,y:4},trigger:"click",constraint:"screen",className:"wux-controls-popup wux-controls-datepicker-popup",alignment:"far",overlap:!1,positionTarget:this.elements.container,getBody:function(){return e._buildCalendarAndButtons(),e.elements.popupContent}};this._popupDelayInfos=l.delayPopupCreation(t,function(t){e.elements.popup=t,t.addEventListener("show",function(i){i.stopPropagation(),i.dsModel===t&&(e.elements.calendar&&(e.elements.calendar.value=e.value,e.elements.calendar.referenceDate=e.value),e.elements.calendarButton&&e.elements.calendarButton.getContent().setAttribute("wuxactive",""),e.setPropertyFromUIInteraction("popupVisibleFlag",!0),e.fire("show"))}),t.addEventListener("hide",function(t){t.target===e.elements.popup.getContent()&&(t.stopPropagation(),e.elements.calendarButton&&e.elements.calendarButton.getContent().removeAttribute("wuxactive"),e.setPropertyFromUIInteraction("popupVisibleFlag",!1),e.fire("hide"),L.call(e))}),n.addEventOnElement(e,t.getContent(),"keydown",function(t){m.ESCAPE===t.keyCode&&M.call(e)})})},_buildCalendarAndButtons:function(){if(this.elements.calendar)return;this.elements.calendar=new a({value:this.value,minValue:this.minValue,maxValue:this.maxValue,allowMultipleValuesFlag:this.allowMultipleValuesFlag,allowUndefinedFlag:!!this.allowMultipleValuesFlag||this.allowUndefinedFlag,fireOnlyFromUIInteractionFlag:!0}),this._buildTimePicker(),this.elements.calendar.inject(this.elements.popupContent);let e=this;this.elements.calendar.addEventListener("change",function(t){if(t.stopPropagation(),!t.dsModel)return;let i,n;if(t.dsModel.value)if(e.allowMultipleValuesFlag){let s=e.value;(s&&s.length<t.dsModel.value.length||!s&&1===t.dsModel.value.length)&&(n=t.dsModel.value.length-1),i=t.dsModel.value.map(e=>new Date(e))}else if(i=new Date(t.dsModel.value),e.elements.timePicker);else if(e.value)i.setHours(e.value.getHours()),i.setMinutes(e.value.getMinutes()),i.setSeconds(e.value.getSeconds());else{var s=new Date;i.setHours(s.getHours()),i.setMinutes(s.getMinutes()),i.setSeconds(s.getSeconds())}e.setPropertyFromUIInteraction("value",i),"number"==typeof n&&e.elements._selChipsEdt&&(e.elements._selChipsEdt.selectChip(n),e._updatingTimePicker=!0,e.elements.timePicker&&(e.elements.timePicker.value=e.value[n]),e._updatingTimePicker=!1),e.allowMultipleValuesFlag||M.call(e)})},_buildTimePicker:function(){if(!this.timePickerFlag||this.elements.timePicker||!this.elements.calendar)return;let e;this.allowMultipleValuesFlag?Array.isArray(e)&&(e=1===e.length?e[0]:null):e=this.value,this.elements.timePicker=new r({value:e instanceof Date?e:new Date,precision:this.timePickerPrecision,mode:y.ampm?"12":"24"}),this.elements.timePicker.getContent().style.width="100%";var t=this.elements.calendar.getContent().querySelector(".wux-controls-calendar-timePicker");t.style.display="block",this.elements.timePicker.inject(t),"min"===this.timePickerPrecision&&this.elements.timePicker.elements.popup&&(this.elements.timePicker.elements.popup.offset.x=-80),this.elements.calendar._timePicker=this.elements.timePicker;let i=this;this.elements.timePicker.addEventListener("change",function(e){if(e.stopPropagation(),!i._updatingTimePicker&&e.dsModel&&e.dsModel.value){let e,t,n=i.elements.timePicker.value,s=i.value;if(!n)return;if(Array.isArray(s)){if(i.elements._selChipsEdt){let o=i.elements._selChipsEdt.getSelectedChipsValue();if(o&&1===o.length)for(let l=0,a=s.length;l<a;++l){let a=A.call(i,s[l]);if(o[0]===a){t=l,e=[...s];let i=new Date(e[l]);e[l]=i,i.setHours(n.getHours()),i.setMinutes(n.getMinutes()),i.setSeconds(n.getSeconds());break}}}}else s&&((e=new Date(s)).setHours(n.getHours()),e.setMinutes(n.getMinutes()),e.setSeconds(n.getSeconds()));e&&i.setPropertyFromUIInteraction("value",e),"number"==typeof t&&i.elements._selChipsEdt&&i.elements._selChipsEdt.selectChip(t)}}),this.elements.timePicker.addEventListener("show",e=>e.stopPropagation()),this.elements.timePicker.addEventListener("hide",e=>e.stopPropagation())},_buildSelectionChipsEditor:function(){if(this.elements._selChipsEdt||!this.allowMultipleValuesFlag)return void(this.elements._selChipsEdt&&(this.elements._selChipsEdt.value=A.call(this,this.value)));this.elements._selChipsEdt=new c({value:A.call(this,this.value),placeholder:E.call(this),uniqueValue:!0,selection:{toggle:!0,mode:d.SELECTION_MODE.SINGLE,unselectAllOnEmptyArea:!0},disabled:this.disabled,touchMode:this.touchMode,fireOnlyFromUIInteractionFlag:!0,customValidator:function(e){if(!this.allowMultipleValuesFlag)return"";let t=T.call(this,e),i=this.value,n=i?Array.isArray(i)?i.slice():void 0:[];return n&&(n.push(t),this.setPropertyFromUIInteraction("value",n)),i&&i.length&&this.value&&i.length===this.value.length?A.call(this,t):""}.bind(this)}),this.elements._selChipsEdt.tooltipInfos=this.tooltipInfos?void 0:this._tooltipInfos;let e=this;n.addEventOnElement(this,this.elements._selChipsEdt._getElementToFocus(),"focus",function(){B.call(e)}),n.addEventOnElement(this,this.elements._selChipsEdt,"change",function(t){if(t.stopPropagation(),e._updatingChips)return;const i=e.elements._selChipsEdt.value;let n=e.value,s=[];for(let t=0,o=i.length;t<o;++t)for(let o=0,l=n.length;o<l;++o){let l=A.call(e,n[o]);if(i[t]===l){s=s.concat(n.splice(o,1));break}}e.setPropertyFromUIInteraction("value",s)}),n.addEventOnElement(this,this.elements._selChipsEdt,"selectionChange",function(t){t.stopPropagation();let i,n=e.elements._selChipsEdt.getSelectedChipsValue(),s=e.value;if(n&&1===n.length){B.call(e);for(let t=0,o=s.length;t<o;++t){let o=A.call(e,s[t]);if(n[0]===o){i=s[t];break}}i&&(e.elements.calendar.referenceDate=i,e._updatingTimePicker=!0,e.elements.timePicker&&(e.elements.timePicker.value=i),e._updatingTimePicker=!1)}else n&&0===n.length&&M.call(e)})}});return p.register(O,"DS/ControlsRec/AbstractRec"),O});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/ColorChooser",["require","exports","DS/Controls/Abstract","UWA/Core","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Core/WebUXComponents","DS/Utilities/Color","DS/Controls/LineEditor","DS/Controls/GradientSlider","DS/Controls/ColorCanvas","DS/WebRecordEnabler/Adapter","DS/Utilities/KeyboardUtils","DS/Controls/ColorEditors"],function(e,t,i,n,s,o,l,a,r,h,u,c,d,p){"use strict";var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:"ffffff",type:"string",advancedSetter:!0,recordFlag:!0},hsvValue:{defaultValue:void 0,type:"array"},referenceValue:{defaultValue:"ffffff",type:"string"},informationsVisibleFlag:{defaultValue:!0,type:"boolean"},handleEditionCancel:{defaultValue:!0,type:"boolean",category:"Behavior",noNeedToApplyFlag:!0},displayStyle:{defaultValue:"basic",type:"string"},showAlphaFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},noContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype._preBuildView=function(t){e.prototype._preBuildView.call(this,t),this.hsvValue=a.hexToHsv(this.value)},t.prototype.buildView=function(){},t.prototype.buildColorChooserView=function(){var e=this;this.elements.container.addClassName("wux-controls-colorchooser"),"advanced"===e.displayStyle?this.elements.container.addClassName("wux-advanced"):this.elements.container.removeClassName("wux-advanced");var t="wux-controls-colorchooser-";this.elements.canvasContainer&&this.elements.canvasContainer.destroy(),this.elements.canvasContainer=new n.Element("div",{class:"wux-canvas-container"}).inject(e.elements.container),e.elements._colorCanvas=new u({subColorAttributeX:"Saturation",subColorAttributeY:"Value",handleEditionCancel:!1,fireOnlyFromUIInteractionFlag:!0}).inject(e.elements.canvasContainer),this.elements._slider=new h({handleEditionCancel:!1,fireOnlyFromUIInteractionFlag:!0,valuePopupFlag:!1,displayStyle:"vertical",sliderButtonStyle:"accurate"}).inject(this.elements.canvasContainer),this.elements._slider.displayStyle="vertical",e.elements._panelInfos=new n.Element("div",{class:t+"informations"}).inject(e.elements.canvasContainer),e.elements._colorBox=new n.Element("div",{class:"color-box"}).inject(e.elements._panelInfos);var i=new n.Element("div",{class:t+"picker-color-container"}).inject(e.elements._colorBox);e.elements._color=new n.Element("div",{class:t+"picker-color"}).inject(i),e.showAlphaFlag&&(e.elements._colorBackground=new n.Element("div",{class:t+"picker-color-background"}).inject(i));var l=new n.Element("div",{class:t+"picker-colorRef-container"}).inject(e.elements._colorBox);e.elements._colorRef=new n.Element("div",{class:t+"picker-colorRef"}).inject(l),e.showAlphaFlag&&(e.elements._colorRefBackground=new n.Element("div",{class:t+"picker-colorRef-background"}).inject(l)),e.elements._panelColorHex=new n.Element("div",{class:t+"informations-color"}).inject(e.elements._panelInfos),"basic"===e.displayStyle&&(e.elements._colorEditors=new p({fireOnlyFromUIInteractionFlag:!0,showAlphaFlag:this.showAlphaFlag,displayStyle:"stacked",useColorSlidersFlag:!1,availableColorFormats:["RGB","HSV"]}).inject(e.elements._panelInfos)),o.addEventOnElement(this,this.elements._colorRef,s.POINTERHIT,function(t){2===t.multipleHitCount&&e.setPropertyFromUIInteraction("value",e.referenceValue)}),e.elements._labelHex=new n.Element("div",{class:t+"label-hexa",text:" # "}).inject(e.elements._panelColorHex),e.elements._valueHex=new r({placeholder:"",pattern:this.showAlphaFlag?"^([A-Fa-f0-9]{8}|[A-Fa-f0-9]{6}|[A-Fa-f0-9]{4}|[A-Fa-f0-9]{3})$":"^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$",sizeInCharNumber:3,value:void 0,fireOnlyFromUIInteractionFlag:!0}).inject(e.elements._panelColorHex),e.elements._valueHex.getContent().addClassName(t+"lineeditor"),"advanced"===e.displayStyle&&(e.elements._colorEditors=new p({fireOnlyFromUIInteractionFlag:!0,showAlphaFlag:this.showAlphaFlag}).inject(e.elements.container)),this._applyReferenceValue(),this._applyInformationsVisibleFlag(),this._applyDisabled(),this._applyTouchMode(),this._refreshEditors(),this._applyNoContextMenu()},t.prototype._postBuildView=function(){},t.prototype._updateAlphaValues=function(){this.showAlphaFlag?(this.value=a.addAlphaComponentToHex(this.value),this.referenceValue=a.addAlphaComponentToHex(this.referenceValue)):(this.value=a.removeAlphaComponentFromHex(this.value),this.referenceValue=a.removeAlphaComponentFromHex(this.referenceValue))},t.prototype._applyShowAlphaFlag=function(){this._updateAlphaValues(),this._refreshEditors()},t.prototype._applyInformationsVisibleFlag=function(){this.elements._panelInfos&&(this.informationsVisibleFlag?this.elements._panelInfos.show():this.elements._panelInfos.hide())},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this._applyShowAlphaFlag(),this.isDirty("hsvValue")&&this._applyHsvValue(),this.isDirty("value")&&this._applyValue(t.value,this.value),this.isDirty("referenceValue")&&this._applyReferenceValue(t.referenceValue),this.isDirty("touchMode")&&this._applyTouchMode(),this.isDirty("informationsVisibleFlag")&&this._applyInformationsVisibleFlag(),this.isDirty("showAlphaFlag")&&this._applyShowAlphaFlag(),this.isDirty("displayStyle")&&this._applyDisplayStyle()},t.prototype._applyDisplayStyle=function(){this.buildColorChooserView()},t.prototype._applyDisabled=function(){e.prototype._applyDisabled.call(this),this.elements._slider&&(this.elements._slider.disabled=this.disabled,this.elements._colorCanvas.disabled=this.disabled,this.elements._valueHex.disabled=this.disabled,this.elements._colorEditors.disabled=this.disabled),this.disabled?this.elements.container.removeAttribute("tabindex"):this.elements.container.setAttribute("tabindex","0")},t.prototype._applyReferenceValue=function(e,t){if(void 0!==this.referenceValue){if("#"===this.referenceValue.charAt(0)){var i=this.referenceValue.substr(1);(this.showAlphaFlag?new RegExp("^([A-Fa-f0-9]{8}|[A-Fa-f0-9]{6}|[A-Fa-f0-9]{4}|[A-Fa-f0-9]{3})$","g"):new RegExp("^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$","g")).test(i)?this.referenceValue=i:this.referenceValue=e}if(this.elements._colorRef){var n=a.hexToRgb(this.referenceValue);if(void 0!==n.a&&(n.a=void 0),this.showAlphaFlag){var s=a.hexToRgb(this.referenceValue);void 0===s.a&&(s.a=255),this.elements._colorRef.setStyle("background","linear-gradient(to top, "+a.colorToCssColor(n)+" 0%, "+a.colorToCssColor(s)+" 70%, "+a.colorToCssColor(s)+" 100%)")}else this.elements._colorRef.setStyle("backgroundColor",a.colorToCssColor(n));this.elements._colorRef.removeClassName("undefined-class")}}else this.elements._colorRef&&(this.elements._colorRef.setStyle("background","white"),this.elements._colorRef.addClassName("undefined-class"))},t.prototype._applyNoContextMenu=function(){this.elements._slider&&(this.elements._slider.noContextMenu=this.noContextMenu,this.elements._colorCanvas.noContextMenu=this.noContextMenu,this.elements._valueHex.noContextMenu=this.noContextMenu,this.elements._colorEditors.noContextMenu=this.noContextMenu)},t.prototype._refreshEditors=function(){if(void 0!==this.elements._slider){if(void 0===this.hsvValue)return this.elements._slider.value=void 0,this.elements._colorCanvas.hsvValue=void 0,this.elements._colorEditors.hsvValue=void 0,this.elements._valueHex.value="",this.elements._color.setStyle("background","white"),void this.elements._color.addClassName("undefined-class");var e=this.getColorSubAttribute(this.elements._slider.gradientType);this.elements._slider.value=e,this.elements._colorCanvas.hsvValue=this.hsvValue,this.elements._colorEditors.hsvValue=this.hsvValue,this.elements._valueHex.value=a.hsvToHex(this.hsvValue);var t=a.hexToRgb(this.value);if(void 0!==t.a&&(t.a=void 0),this.showAlphaFlag){var i=a.hexToRgb(this.value);null==i.a&&(i.a=255),this.elements._color.setStyle("background","linear-gradient(to top, "+a.colorToCssColor(t)+" 0%, "+a.colorToCssColor(i)+" 70%, "+a.colorToCssColor(i)+" 100%)")}else this.elements._color.setStyle("backgroundColor",a.colorToCssColor(t));this.elements._color.removeClassName("undefined-class")}},t.prototype._applyValue=function(e,t){this.value=this.showAlphaFlag?a.addAlphaComponentToHex(t):a.removeAlphaComponentFromHex(t),this._applyingValue=!0,this._applyingHsvValue||(this.hsvValue=a.hexToHsv(this.value),this._refreshEditors()),this._applyingValue=!1},t.prototype._applyHsvValue=function(){this._applyingHsvValue=!0,this._applyingValue||(this.value=a.hsvToHex(this.hsvValue),this._refreshEditors(),this.elements._slider&&(this.elements._slider.modulationColor="Hue"===this.elements._slider.gradientType?[this.hsvValue[0],100,100]:this.hsvValue)),this.fire("change"),this._applyingHsvValue=!1},t.prototype._applyTouchMode=function(){e.prototype._applyTouchMode.call(this);var t=this._getCurrentTouchMode();this.elements._panelInfos&&(!0===t?this.elements._panelInfos.setAttributeNode(document.createAttribute("touch-mode")):this.elements._panelInfos.removeAttribute("touch-mode"))},t.prototype.setColorSubAttribute=function(e,t){var i=this.hsvValue||[0,100,100,this.showAlphaFlag?255:void 0],n=a.hsvToRgb(i),s=a.hsvToHsl(i);switch(e){case"Hue":this.hsvValue=[t,i[1],i[2],i[3]];break;case"HslSaturation":this.hsvValue=a.hslToHsv([s[0],t,s[2],i[3]]);break;case"Saturation":this.hsvValue=[i[0],t,i[2],i[3]];break;case"Value":this.hsvValue=[i[0],i[1],t,i[3]];break;case"Lightness":this.hsvValue=a.hslToHsv([s[0],s[1],t,s[3]]);break;case"Red":this.hsvValue=a.rgbToHsv(t,n.g,n.b,n.a);break;case"Green":this.hsvValue=a.rgbToHsv(n.r,t,n.b,n.a);break;case"Blue":this.hsvValue=a.rgbToHsv(n.r,n.g,t,n.a);break;case"Alpha":this.hsvValue=a.rgbToHsv(n.r,n.g,n.b,t)}},t.prototype.getColorSubAttribute=function(e){var t=a.hsvToRgb(this.hsvValue),i=a.hsvToHsl(this.hsvValue);switch(e){case"Hue":return this.hsvValue[0];case"HslSaturation":return i[1];case"Saturation":return this.hsvValue[1];case"Value":return this.hsvValue[2];case"Lightness":return i[2];case"Red":return t.r;case"Green":return t.g;case"Blue":return t.b;case"Alpha":return t.a}},t.prototype._handleEvents=function(){var e=this;this.pointerdownCanvasP=!1,this.pointerdownSliderP=!1;var t=document;e.getContent()&&e.getContent().ownerDocument&&(t=e.getContent().ownerDocument),o.addEventOnElement(this,this.elements._panelInfos,"beginEdit",function(t){t.stopPropagation(),e.fire("beginEdit")}),o.addEventOnElement(this,this.elements._panelInfos,"endEdit",function(t){t.stopPropagation(),e.fire("endEdit")}),o.addEventOnElement(this,this.elements._panelInfos,"cancelEdit",function(t){t.stopPropagation(),e.fire("cancelEdit")}),o.addEventOnElement(this,this.elements._panelInfos,"uncommittedChange",function(e){e.stopPropagation()}),o.addEventOnElement(this,this.elements._panelInfos,"preValidateValue",function(e){e.stopPropagation()}),o.addEventOnElement(this,this.elements._valueHex,"focus",function(t){t.stopPropagation(),e.fire("beginEdit")}),o.addEventOnElement(this,this.elements._valueHex,"change",function(t){(t.stopPropagation(),void 0!==e.elements._valueHex.value&&null!==e.elements._valueHex.value)&&((e.showAlphaFlag?new RegExp("^([A-Fa-f0-9]{8}|[A-Fa-f0-9]{6}|[A-Fa-f0-9]{4}|[A-Fa-f0-9]{3})$","g"):new RegExp("^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$","g")).test(e.elements._valueHex.value)?e.setPropertyFromUIInteraction("value",e.elements._valueHex.value):e.value=void 0)}),o.addEventOnElement(this,this.elements._valueHex,"blur",function(t){t.stopPropagation(),e.fire("endEdit")}),o.addEventOnElement(this,this.elements._valueHex,"uncommittedChange",function(e){e.stopPropagation()}),o.addEventOnElement(this,this.elements._slider,s.POINTERDOWN,function(e){e.stopPropagation()}),o.addEventOnElement(this,this.elements._slider,"beginEdit",function(t){t.stopPropagation(),e.pointerdownSliderP=!0,e.initialValue=e.hsvValue,e.fire("beginEdit")}),o.addEventOnElement(this,this.elements._slider,"endEdit",function(t){t.stopPropagation(),e.pointerdownSliderP=!1,e.fire("endEdit")}),o.addEventOnElement(this,this.elements._slider,"cancelEdit",function(t){t.stopPropagation(),e.pointerdownSliderP=!1,e.fire("cancelEdit")}),o.addEventOnElement(this,this.elements._colorCanvas,"beginEdit",function(t){t.stopPropagation(),e.pointerdownCanvasP=!0,e.initialValue=e.hsvValue,e.fire("beginEdit")}),o.addEventOnElement(this,this.elements._colorCanvas,"endEdit",function(t){t.stopPropagation(),e.pointerdownCanvasP=!1,e.fire("endEdit")}),o.addEventOnElement(this,this.elements._colorCanvas,"cancelEdit",function(t){t.stopPropagation(),e.pointerdownCanvasP=!1,e.fire("cancelEdit")}),o.addEventOnElement(this,this.elements._colorEditors,"changeModulation",function(t){t.stopPropagation();for(var i=0,n=["Hue","Saturation","Value","HslSaturation","Lightness","Red","Green","Blue"];i<n.length;i++){var s=n[i];t.options.colorSubAttributeType===s&&(e.elements._slider.gradientType=s,e.elements._slider&&(e.elements._slider.modulationColor="Hue"===e.elements._slider.gradientType?[e.hsvValue[0],100,100]:e.hsvValue),"Hue"===s?"HSL"===t.currentColorFormat?e.elements._colorCanvas.setProperties({subColorAttributeX:"HslSaturation",subColorAttributeY:"Lightness"}):e.elements._colorCanvas.setProperties({subColorAttributeX:"Saturation",subColorAttributeY:"Value"}):"Saturation"===s?e.elements._colorCanvas.setProperties({subColorAttributeX:"Hue",subColorAttributeY:"Value"}):"HslSaturation"===s?e.elements._colorCanvas.setProperties({subColorAttributeX:"Hue",subColorAttributeY:"Lightness"}):"Value"===s?e.elements._colorCanvas.setProperties({subColorAttributeX:"Hue",subColorAttributeY:"Saturation"}):"Lightness"===s?e.elements._colorCanvas.setProperties({subColorAttributeX:"Hue",subColorAttributeY:"HslSaturation"}):"Red"===s?e.elements._colorCanvas.setProperties({subColorAttributeX:"Green",subColorAttributeY:"Blue"}):"Green"===s?e.elements._colorCanvas.setProperties({subColorAttributeX:"Blue",subColorAttributeY:"Red"}):"Blue"===s&&e.elements._colorCanvas.setProperties({subColorAttributeX:"Red",subColorAttributeY:"Green"}))}}),o.addEventOnElement(this,this.elements._colorCanvas,"change",function(t){t.stopPropagation();var i=e.elements._colorCanvas.hsvValue;e.showAlphaFlag&&void 0===i[3]&&(i[3]=255),e.hsvValue=i}),o.addEventOnElement(this,this.elements._colorEditors,"change",function(t){t.stopPropagation(),e.hsvValue=e.elements._colorEditors.hsvValue}),o.addEventOnElement(this,this.elements._slider,"change",function(t){t.stopPropagation();Math.round(e.elements._slider.value);e.setColorSubAttribute(e.elements._slider.gradientType,e.elements._slider.value)}),o.addEventOnElement(this,t.body,s.POINTERUP,function(i){e.disabled||(e.pointerdownCanvasP&&(e.pointerdownCanvasP=!1,e.fire("endEdit")),t.body.style.cursor="")}),o.addEventOnElement(this,this.elements._colorCanvas,"keydown",function(t){if(!e.disabled&&d.ESCAPE==t.keyCode&&e.pointerdownCanvasP){if(!e.handleEditionCancel)return;t.stopPropagation(),void 0!==e.initialValue&&(e.setPropertyFromUIInteraction("hsvValue",e.initialValue),e.fire("cancelEdit"))}}),o.addEventOnElement(this,this.elements._slider,"keydown",function(t){if(!e.disabled&&d.ESCAPE==t.keyCode&&e.pointerdownSliderP){if(!e.handleEditionCancel)return;t.stopPropagation(),void 0!==e.initialValue&&e.setPropertyFromUIInteraction("hsvValue",e.initialValue),e.fire("cancelEdit")}})},t}(i);return l.addClass(m,"colorChooser"),m.prototype.markForRecordFlag=!0,m.prototype.blackBoxFlag=!0,c.register(m,"DS/ControlsRec/AbstractRec"),m});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/ColorPicker",["require","exports","DS/Controls/Abstract","DS/Controls/ColorChooser","DS/Controls/Popup","DS/Utilities/Color","DS/Utilities/KeyboardUtils","DS/Utilities/Dom","DS/WebRecordEnabler/Adapter","DS/Core/WebUXComponents","DS/WebappsUtils/WebappsUtils","DS/Utilities/WUXUWAUtils"],function(e,t,i,n,s,o,l,a,r,h,u,c){"use strict";var d=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return c.extendingClassFlag?n:(n.addKeyMapsAndCommands({space:{keydown:"actionPopup",keyup:"preventDefault"}},{actionPopup:function(){return this.popupVisibleFlag=!this.popupVisibleFlag,{preventDefault:!0,stopPropagation:!0}},preventDefault:function(){return{preventDefault:!0,stopPropagation:!0}}}),n)}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:"ffffff",type:"string",category:"Behavior",advancedSetter:!0,recordFlag:!0},referenceValue:{defaultValue:"ffffff",type:"string",category:"Behavior"},showAlphaFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},popupVisibleFlag:{defaultValue:!1,type:"boolean",category:"Behavior",recordFlag:!0},handleEditionCancel:{defaultValue:!0,type:"boolean",category:"Behavior"},noContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){this.elements.container.addClassName("wux-controls-colorpicker-button"),this._createPopup(),this.currentValue=this.value,this.initialValue=void 0},t.prototype._postBuildView=function(){this._preEditValue(void 0,this.value)&&this._applyValue()},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("value")&&(this._preEditValue&&!this._preEditValue(t.value,this.value)||this._applyValue(t.value)),this.isDirty("referenceValue")&&this._applyReferenceValue(t.referenceValue),this.isDirty("popupVisibleFlag")&&this._applyPopupVisibleFlag(t.popupVisibleFlag),this._applyNoContextMenu()},t.prototype._applyRecId=function(){e.prototype._applyRecId.call(this),this.elements._popup&&(this.elements._popup.recId=this.recId+"-popup")},t.prototype._applyTouchMode=function(){!0===this._getCurrentTouchMode()?this.elements.container.setAttributeNode(document.createAttribute("touch-mode")):this.elements.container.removeAttribute("touch-mode")},t.prototype._preEditValue=function(e,t){if(null!=t){var i=!0;return t.toString()!==t&&(t=t.toString(),i=!1),"#"===t.charAt(0)&&(t=t.substr(1),i=!1),!!(this.showAlphaFlag?new RegExp("^([A-Fa-f0-9]{8}|[A-Fa-f0-9]{6}|[A-Fa-f0-9]{4}|[A-Fa-f0-9]{3})$","g"):new RegExp("^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$","g")).test(t)&&(!!i||(this.value=t,!1))}return!0},t.prototype._applyValue=function(e){var t=this.value;if(this.elements.container&&null!=t){this.elements._colorChooser&&(this.elements._colorChooser.value=t);var i=o.hexToRgb(t);if(void 0!==i.a){var n=o.hexToRgb(t);n.a=255,this.elements.container.setStyle("background","linear-gradient("+o.colorToCssColor(n)+", "+o.colorToCssColor(i)+"), url("+u.getWebappsBaseUrl()+"Utilities/assets/textures/colorCheckeredBackground_22x22.png)")}else this.elements.container.setStyle("background",o.colorToCssColor(i));var s=this.currentValue;if("string"!=typeof s||"string"!=typeof t||null===t||null===s)t!==s&&(this.popupVisibleFlag||this._popupClosingFlag)?this.fire("liveChange"):t===s||this.popupVisibleFlag||e&&t&&e!==t.substr(1)&&e.substr(1)!==t&&this.fire("change");else{var l=!1;(this.popupVisibleFlag||this._popupClosingFlag)&&(e&&t.toLowerCase()!==e.toLowerCase()||t.toLowerCase()!==s.toLowerCase())&&(l=!0),l?this.fire("liveChange"):t.toLowerCase()===s.toLowerCase()||this.popupVisibleFlag||("string"!=typeof e||null===e||"string"!=typeof t||null===t?e!==t&&this.fire("change"):e&&t&&e!==t.substr(1)&&e.substr(1)!==t&&this.fire("change"))}this.elements.container.removeClassName("undefined-class")}else this.elements._colorChooser&&(this.elements._colorChooser.value=t),this.elements.container.addClassName("undefined-class"),this.elements.container.setStyle("background",o.colorToCssColor(o.hexToRgb("ffffff")))},t.prototype._applyReferenceValue=function(e){void 0!==this.referenceValue&&this.elements._colorChooser&&(this.elements._colorChooser.referenceValue=this.referenceValue)},t.prototype._applyDisabled=function(t){e.prototype._applyDisabled.call(this,t),this.elements._colorChooser&&(this.elements._colorChooser.disabled=this.disabled),this.disabled?this.elements.container.removeAttribute("tabindex"):this.elements.container.setAttribute("tabindex",0)},t.prototype._applyPopupVisibleFlag=function(e){this.elements._popup&&(this.popupVisibleFlag?(this.elements._popup.visibleFlag=!0,this.elements._colorChooser.value=this.value,this.fire("show")):(this.elements._popup.visibleFlag=!1,this.fire("hide",{cancelFlag:"escape"===this._eventTrigger})))},t.prototype._applyNoContextMenu=function(){this.elements._colorChooser&&(this.elements._colorChooser.noContextMenu=this.noContextMenu)},t.prototype._createPopup=function(){var e=this;this.elements._popup=void 0;var t={target:this.getContent(),position:"bottom",offset:{x:0,y:4},alignment:"near",constraint:"screen",trigger:"click escape",overlap:!1,recId:this.recId+"-popup",className:"wux-controls-popup wux-controls-colorpicker-popup",fireOnlyFromUIInteractionFlag:!0,getBody:function(){if(!e.elements._colorChooser)return e.elements._colorChooser=new n({value:e.value,referenceValue:e.referenceValue,handleEditionCancel:!1,disabled:e.disabled,noContextMenu:e.noContextMenu,showAlphaFlag:e.showAlphaFlag}),a.addEventOnElement(e,e.elements._colorChooser,"beginEdit",function(t){t.stopPropagation(),e.fire("beginEdit")}),a.addEventOnElement(e,e.elements._colorChooser,"change",function(t){t.stopPropagation(),void 0!==e.value&&null!==e.value?e.value.toLowerCase()!==e.elements._colorChooser.value.toLowerCase()&&e.setPropertyFromUIInteraction("value",e.elements._colorChooser.value):e.setPropertyFromUIInteraction("value",e.elements._colorChooser.value)}),a.addEventOnElement(e,e.elements._colorChooser,"endEdit",function(t){t.stopPropagation(),e.fire("endEdit")}),e.elements._colorChooser}};s.delayPopupCreation(t,function(t){e.elements._popup=t,a.addEventOnElement(e,e.elements._popup,"show",function(t){t.stopPropagation(),e.currentValue=e.value,e.initialValue=e.value,e.setPropertyFromUIInteraction("popupVisibleFlag",!0)}),a.addEventOnElement(e,e.elements._popup,"hide",function(t){t.stopPropagation(),"escape"===t.options.trigger?e.handleEditionCancel&&(void 0!==e.initialValue&&!0===e.handleEditionCancel&&(e.currentValue=e.value,e._popupClosingFlag=!0,e.setPropertyFromUIInteraction("value",e.initialValue),e._popupClosingFlag=!1),e.fire("cancelEdit")):void 0===e.currentValue||void 0===e.value||null===e.value||null===e.currentValue?e.value===e.currentValue||null!=e.initialValue&&e.value===e.initialValue||(e.fire("change"),e.fire("endEdit")):e.value.toLowerCase()===e.currentValue.toLowerCase()||void 0!==e.initialValue&&e.value.toLowerCase()===e.initialValue.toLowerCase()||(e.fire("change"),e.fire("endEdit")),e.initialValue=void 0,e._eventTrigger=t.options.trigger,e.setPropertyFromUIInteraction("popupVisibleFlag",!1),e._eventTrigger=void 0}),a.addEventOnElement(e,e.elements._popup,"keydown",function(t){t.stopPropagation(),l.ENTER===t.keyCode&&!0!==t.actionPerformed&&e.popupVisibleFlag&&e.elements._popup.hide()})})},t.prototype._giveFocus=function(){this._isFocused()||this.elements.container.focus()},t.prototype.show=function(){return this.popupVisibleFlag=!0,this},t.prototype.hide=function(){this.popupVisibleFlag=!1},t.prototype.getPopup=function(){return this.elements._popup},t}(i);return d.prototype.markForRecordFlag=!0,d.prototype.blackBoxFlag=!0,h.addClass(d,"colorPicker"),r.register(d,"DS/ControlsRec/AbstractRec"),d});