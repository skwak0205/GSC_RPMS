define("DS/CfgEffectivityViewUX/scripts/CfgEffectivityView",["UWA/Core","UWA/Class/View","DS/UIKIT/Mask","DS/UIKIT/Iconbar","DS/Controls/ComboBox","DS/Controls/TooltipModel","DS/Controls/Expander","DS/Controls/Toggle","DS/Handlebars/Handlebars4","DS/CfgEvolutionUX/CfgEvolutionViewSelector","DS/CfgEvolutionUX/CfgEvolutionCriteriaBaseView","DS/CfgBaseUX/scripts/CfgUtility","text!DS/CfgEffectivityViewUX/scripts/CfgEffectivityViewTemplate.html","text!DS/CfgEffectivityViewUX/scripts/CfgEvolutionToolbarTemplate.html","text!DS/CfgEffectivityViewUX/scripts/CfgEvolutionViewTemplate.html","text!DS/CfgEffectivityViewUX/scripts/CfgVariantViewTemplate.html","i18n!DS/CfgEffectivityViewUX/assets/nls/CfgEffectivityView","css!DS/CfgEffectivityViewUX/styles/CfgEffectivityView.css"],function(e,t,o,i,n,a,l,s,r,c,f,u,d,h,m,p,E){"use strict";return t.extend({tagName:"div",className:"cfg-eff-view",init:function(e){var t=this;this._parent(e),this.effViewData=e.effViewData,this.effViewPanelTemplate=r.compile(d),this.evolutionToolbarPanelTemplate=r.compile(h),this.evolutionViewPanelTemplate=r.compile(m),this.variantViewPanelTemplate=r.compile(p),this.modelComboboxData=[],this.effViewData.effModels.forEach(function(e){1!=e.criteria.length||"MV"!=e.criteria[0].name&&"MP"!=e.criteria[0].name||""!=e.variantDisplayExpression?e.monoCriteria=!1:e.monoCriteria=!0,t.modelComboboxData.push({valueItem:e.modelName,labelItem:e.modelLabel})}),this.textGraphComboboxData=[{valueItem:"TEXT",labelItem:E.TEXT_LABEL,iconItem:"text"},{valueItem:"GRAPH",labelItem:E.GRAPH_LABEL,iconItem:"graph-egraph-list"}],this.textOnlyComboboxData=[{valueItem:"TEXT",labelItem:E.TEXT_LABEL,iconItem:"text"}],this.displayCompactMode=null==t.options.displayCompactMode||null==t.options.displayCompactMode||0!=t.options.displayCompactMode},adjustResponsiveView:function(){this.options.parentElement.getDimensions&&(this.options.parentElement.getDimensions().width<360?(this.createAndSetTextGraphViewCombobox(this.evolutionViewCombobox.elementsList,this.evolutionViewCombobox.selectedIndex,!0),this.container.getElement(".model-ux-switch-section").setAttributeNode(document.createAttribute("mobile-device")),this.container.getElement(".model-section").setAttributeNode(document.createAttribute("mobile-device")),this.container.getElement(".ux-switch-section").setAttributeNode(document.createAttribute("mobile-device"))):(this.createAndSetTextGraphViewCombobox(this.evolutionViewCombobox.elementsList,this.evolutionViewCombobox.selectedIndex,!1),this.evolutionViewCombobox.mainElementVisibleFlag=!0,this.container.getElement(".model-ux-switch-section").removeAttribute("mobile-device"),this.container.getElement(".model-section").removeAttribute("mobile-device"),this.container.getElement(".ux-switch-section").removeAttribute("mobile-device")))},render:function(){var e=this;if(this.evolutionToolbar=UWA.createElement("div"),this.evolutionView=UWA.createElement("div"),this.variantView=UWA.createElement("div"),this.evolutionToolbar.setHTML(this.evolutionToolbarPanelTemplate()),this.evolutionView.setHTML(this.evolutionViewPanelTemplate({NO_EVOLUTION_EFF_MSG:E.NO_EVOLUTION_EFF_MSG})),this.variantView.setHTML(this.variantViewPanelTemplate({NO_VARIANT_EFF_MSG:E.NO_VARIANT_EFF_MSG})),this.container.setHTML(this.effViewPanelTemplate({NO_EFF_MSG:E.NO_EFF_MSG})),this.container.inject(this.options.parentElement),this.options.parentElement.addEvent&&this.options.parentElement.addEvent("resize",function(){e.adjustResponsiveView()}),this.noEffPage=this.container.getElement(".no-eff-section"),this.noEffPage.tooltipInfos=new a({shortHelp:E.NO_EFF_MSG}),this.mainViewPage=this.container.getElement(".main-view-page"),0==this.effViewData.effModels.length)return this.mainViewPage.hide(),void this.noEffPage.show();this.mainViewPage.show(),this.noEffPage.hide(),this.modelLabelHolder=this.mainViewPage.getElement(".model-label"),this.modelComboboxHolder=this.mainViewPage.getElement(".model-combobox-component"),this.modelLabelHolder.setContent(E.MODEL_LABEL),this.modelCombobox=new n({selectedIndex:0,enableSearchFlag:!1,elementsList:e.modelComboboxData,touchMode:!e.displayCompactMode}),this.modelCombobox.addEventListener("change",function(t){e.updateEvolutionCriteriaView({modelName:e.modelCombobox.currentValue,modelLabel:e.modelCombobox.currentLabel}),e.updateVariantView({modelName:e.modelCombobox.currentValue,modelLabel:e.modelCombobox.currentLabel})}),this.modelCombobox.addEventListener("show",function(e){document.getElementsByClassName("wux-controls-combobox-popup")[0].setStyle("zIndex","99999")}),e.modelComboboxData.length>1?(this.modelComboboxHolder.setContent(this.modelCombobox),this.modelComboboxHolder.removeClassName("expression-text")):(this.modelComboboxHolder.setContent(this.modelComboboxData[0].labelItem),this.modelComboboxHolder.addClassName("expression-text")),this.uxSwitchToggleHolder=this.mainViewPage.getElement(".ux-switch-toggle"),this.uxSwitchToggle=new s({touchMode:!e.displayCompactMode,type:"switch",label:E.UX_MULTICONTEXT,value:0,checkFlag:!1}),this.uxSwitchToggle.tooltipInfos=new a({shortHelp:E.UX_MULTICONTEXT_TP}),this.uxSwitchToggle.addEventListener("change",function(t){0==e.uxSwitchToggle.value?(e.uxSwitchToggle.value=1,e.enableMultiContextTextView()):1==e.uxSwitchToggle.value&&(e.uxSwitchToggle.value=0,e.disableMultiContextTextView())}),this.uxSwitchToggleHolder.setContent(this.uxSwitchToggle),this.caInfoIcon=this.evolutionToolbar.getElement(".evolution-ca-info-icon"),this.evolutionViewSelectorHolder=this.evolutionToolbar.getElement(".evolution-view-selection"),this.evolutionViewSwitcherHolder=this.evolutionToolbar.getElement(".evolution-view-switcher"),this.evolutionViewSelectorOptions={officialViewLabel:E.OFFICIAL_LABEL,officialViewHandler:function(){e.manageOfficialProjectedView(e)},projectedViewLabel:E.PROJECTED_LABEL,projectedViewHandler:function(){e.manageOfficialProjectedView(e)},displayCompactMode:e.displayCompactMode},this.evolutionViewSelector=new c(this.evolutionViewSelectorOptions),this.evolutionViewSelectorHolder.setContent(this.evolutionViewSelector.render()),1==this.effViewData.isSearchKO&&u.showwarning(E.SEARCH_FAIL,"error"),this.createAndSetTextGraphViewCombobox(1==e.effViewData.isSearchKO?e.textOnlyComboboxData:e.textGraphComboboxData,0),this.evolutionMultiContextSection=this.evolutionView.getElement(".evolution-multi-context"),this.evolutionByContextSection=this.evolutionView.getElement(".evolution-by-context"),this.noEvolutionEffSection=this.evolutionView.getElement(".no-evolution-eff-section"),this.noEvolutionEffSection.tooltipInfos=new a({shortHelp:E.NO_EVOLUTION_EFF_MSG}),this.noCritEffSection=this.evolutionView.getElement(".no-crit-eff-expression"),this.evolutionSection=this.evolutionView.getElement(".evolution-section"),this.evolutionCriteriaViewHolder=this.evolutionView.getElement(".evolution-criteria-view-holder"),this.evolutionCriteriaViewHolder.setContent(""),this.setMultiContextEvolutionExpression(this.effViewData.effData.officialJSEvolutionDisplayExpression),this.variantMultiContextSection=this.variantView.getElement(".variant-multi-context"),this.variantByContextSection=this.variantView.getElement(".variant-by-context"),this.noVariantEffSection=this.variantView.getElement(".no-variant-eff-section"),this.noVariantEffSection.tooltipInfos=new a({shortHelp:E.NO_VARIANT_EFF_MSG}),this.variantSection=this.variantView.getElement(".variant-section"),this.variantExpressionTextHolder=this.variantView.getElement(".variant-expression-text"),this.variantExpressionTextHolder.setContent(""),this.setMultiContextVariantExpression(this.effViewData.effData.variantJSDisplayExpression,this.effViewData.effData.variantDisplayExpression),this.evolutionExpander=new l({header:E.EVOLUTION_LABEL,customHeader:e.evolutionToolbar,body:e.evolutionView,expandedFlag:!0,touchMode:!e.displayCompactMode}),this.evolutionExpander.getContent().addEventListener("expand",function(){e.evolutionViewSelector.enable(),e.evolutionViewCombobox.disabled=!1,e.manageNoEvolutionEffectivity({modelName:e.modelCombobox.currentValue,modelLabel:e.modelCombobox.currentLabel})}),this.evolutionExpander.getContent().addEventListener("collapse",function(){e.evolutionViewSelector.disable(),e.evolutionViewCombobox.disabled=!0,e.manageNoEvolutionEffectivity({modelName:e.modelCombobox.currentValue,modelLabel:e.modelCombobox.currentLabel})}),this.variantExpander=new l({header:E.VARIANT_LABEL,body:e.variantView,expandedFlag:!0,touchMode:!e.displayCompactMode}),this.variantExpander.tooltipInfos=new a({shortHelp:E.VARIANT_LABEL}),this.effViewExpanderHolder=this.mainViewPage.getElement(".expander-section"),this.effViewExpanderHolder.setContent(""),this.evolutionExpander.inject(this.effViewExpanderHolder),this.variantExpander.inject(this.effViewExpanderHolder),this.effViewExpanderHolder.getElement(".wux-controls-expander-header-container").tooltipInfos=new a({shortHelp:E.EVOLUTION_LABEL}),this.applyCompactComfortableMode(),this.updateEvolutionCriteriaView({modelName:e.modelCombobox.currentValue,modelLabel:e.modelCombobox.currentLabel}),this.updateVariantView({modelName:e.modelCombobox.currentValue,modelLabel:e.modelCombobox.currentLabel}),this.disableMultiContextTextView(),this.adjustResponsiveView(),1==this.options.onlyConsolidatedView&&(this.uxSwitchToggle.checkFlag=!0,this.uxSwitchToggle.disabled=!0,this.uxSwitchToggle.value=1,this.enableMultiContextTextView())},createAndSetTextGraphViewCombobox:function(e,t,o){var i=this;if(null==o||null==o){if(this.options.parentElement.getDimensions)o=this.options.parentElement.getDimensions().width<360}this.evolutionViewCombobox=new n({selectedIndex:t,enableSearchFlag:!1,elementsList:e,mainElementVisibleFlag:!o,touchMode:!i.displayCompactMode}),this.evolutionViewCombobox.addEventListener("change",function(e){i.manageTextGraphView(i.evolutionViewCombobox.currentValue)}),this.evolutionViewCombobox.addEventListener("click",function(e){e.stopPropagation()}),this.evolutionViewCombobox.addEventListener("show",function(e){document.getElementsByClassName("wux-controls-combobox-popup")[0].setStyle("zIndex","99999")}),this.evolutionViewSwitcherHolder.setContent(""),this.evolutionViewSwitcherHolder.setContent(this.evolutionViewCombobox)},setMultiContextEvolutionExpression:function(e,t){""==e?(this.evolutionMultiContextSection.innerHTML=E.NO_EVOLUTION_EFF_MSG,this.evolutionMultiContextSection.tooltipInfos=new a({shortHelp:E.NO_EVOLUTION_EFF_MSG}),this.evolutionMultiContextSection.addClassName("no-eff-msg")):(this.evolutionMultiContextSection.innerHTML=e,this.evolutionMultiContextSection.tooltipInfos=new a({shortHelp:t}),this.evolutionMultiContextSection.removeClassName("no-eff-msg"))},setMultiContextVariantExpression:function(e,t){""==e?(this.variantMultiContextSection.innerHTML=E.NO_VARIANT_EFF_MSG,this.variantMultiContextSection.tooltipInfos=new a({shortHelp:E.NO_VARIANT_EFF_MSG}),this.variantMultiContextSection.addClassName("no-eff-msg")):(this.variantMultiContextSection.innerHTML=e,this.variantMultiContextSection.tooltipInfos=new a({shortHelp:t}),this.variantMultiContextSection.removeClassName("no-eff-msg"))},enableMultiContextTextView:function(){this.modelLabelHolder.hide(),this.modelComboboxHolder.hide(),this.caInfoIcon.hide(),this.evolutionViewSwitcherHolder.hide(),this.evolutionMultiContextSection.show(),this.evolutionByContextSection.hide(),this.variantMultiContextSection.show(),this.variantByContextSection.hide(),this.manageOfficialProjectedView(this)},disableMultiContextTextView:function(){this.modelLabelHolder.show(),this.modelComboboxHolder.show(),this.evolutionViewSwitcherHolder.show(),this.evolutionMultiContextSection.hide(),this.evolutionByContextSection.show(),this.variantMultiContextSection.hide(),this.variantByContextSection.show(),this.updateEvolutionCriteriaView({modelName:this.modelCombobox.currentValue,modelLabel:this.modelCombobox.currentLabel}),this.updateVariantView({modelName:this.modelCombobox.currentValue,modelLabel:this.modelCombobox.currentLabel})},manageOfficialProjectedView:function(e){1!=this.uxSwitchToggle.value?e.updateEvolutionCriteriaView({modelName:e.modelCombobox.currentValue,modelLabel:e.modelCombobox.currentLabel}):"Official"==this.evolutionViewSelector.get().view?this.setMultiContextEvolutionExpression(e.effViewData.effData.officialJSEvolutionDisplayExpression,e.effViewData.effData.officialEvolutionDisplayExpression):"Projected"==this.evolutionViewSelector.get().view&&this.setMultiContextEvolutionExpression(e.effViewData.effData.projectedJSEvolutionDisplayExpression,e.effViewData.effData.projectedEvolutionDisplayExpression)},manageTextGraphView:function(e){"GRAPH"==e?this.loadGraphView():"TEXT"==e&&this.loadTextView()},loadTextView:function(){this.criteriaView&&this.criteriaView.mv_criteria&&(this.evolutionSection.getElement(".mv-graph-component").hide(),this.evolutionSection.getElement(".mv-component").show()),this.criteriaView&&this.criteriaView.mp_criteria&&(this.evolutionSection.getElement(".mp-graph-component").hide(),this.evolutionSection.getElement(".mp-component").show())},loadGraphView:function(){var e=this,t=!1;this.effViewData.effModels.forEach(function(o){o.modelName===e.modelCombobox.currentValue&&o.modelLabel===e.modelCombobox.currentLabel&&("Official"==e.evolutionViewSelector.get().view&&1==o.isUnsupportedForGraph||"Projected"==e.evolutionViewSelector.get().view&&1==o.isProjectedUnsupportedForGraph)&&(t=!0)}),1!=t&&(this.criteriaView&&this.criteriaView.mp_criteria&&(this.evolutionSection.getElement(".mp-component").hide(),this.evolutionSection.getElement(".mp-graph-component").show(),this.evolutionSection.getElement(".mp-graph-component").setContent(""),this.criteriaView.clickCriteriaComponent("MP")),this.criteriaView&&this.criteriaView.mv_criteria&&(this.evolutionSection.getElement(".mv-component").hide(),this.evolutionSection.getElement(".mv-graph-component").show(),this.evolutionSection.getElement(".mv-graph-component").setContent(""),this.criteriaView.clickCriteriaComponent("MV")))},manageNoEvolutionEffectivity:function(e){var t=this;this.effViewData.effModels.forEach(function(o){o.modelName===e.modelName&&o.modelLabel===e.modelLabel&&("Official"==t.evolutionViewSelector.get().view&&o.criteria&&o.criteria.length>0||"Projected"==t.evolutionViewSelector.get().view&&o.projectedCriteria&&o.projectedCriteria.length>0?(t.noEvolutionEffSection.hide(),t.noCritEffSection.hide(),t.evolutionToolbar.show(),t.evolutionSection.show()):(t.evolutionSection.hide(),"FALSE"==o.displayExpression||"FALSE"==o.projectedDisplayExpression||"TRUE"==o.displayExpression||"TRUE"==o.projectedDisplayExpression||o.caTooltipInfo||o.noCritProjectedExpression?(t.evolutionToolbar.show(),t.noEvolutionEffSection.hide()):(t.evolutionToolbar.hide(),t.noEvolutionEffSection.show())))})},updateEvolutionCriteriaView:function(e){var t=this;this.manageNoEvolutionEffectivity(e),this.effViewData.effModels.forEach(function(o){if(o.modelName!==e.modelName||o.modelLabel!==e.modelLabel);else{if(t.evolutionCriteriaViewHolder.setContent(""),o.mode="EFF_VIEW",o.parentElement=t.evolutionCriteriaViewHolder,o.displayCompactMode=t.displayCompactMode,t.criteriaView=null,"Official"==t.evolutionViewSelector.get().view)if(o.caTooltipInfo?(t.evolutionToolbar.show(),t.caInfoIcon.show(),t.caInfoIcon.tooltipInfos=new a({shortHelp:o.caTooltipInfo})):t.caInfoIcon.hide(),o.evolutionView="Official",o.criteria&&o.criteria.length>0){t.criteriaView=new f(o),t.criteriaView.render();var i=!1;o.criteria.forEach(function(e){"MV"!=e.name&&"MP"!=e.name||(i=!0)}),1==i?t.createAndSetTextGraphViewCombobox(t.textGraphComboboxData,t.evolutionViewCombobox.selectedIndex):t.createAndSetTextGraphViewCombobox(t.textOnlyComboboxData,t.evolutionViewCombobox.selectedIndex)}else"FALSE"==o.displayExpression||"TRUE"==o.displayExpression?(t.createAndSetTextGraphViewCombobox(t.textOnlyComboboxData,t.evolutionViewCombobox.selectedIndex),t.noEvolutionEffSection.hide(),t.noCritEffSection.show(),t.noCritEffSection.setContent("FALSE"==o.displayExpression?E.FALSE:E.TRUE),t.noCritEffSection.tooltipInfos=new a({shortHelp:"FALSE"==o.displayExpression?E.FALSE:E.TRUE})):o.caTooltipInfo?(t.createAndSetTextGraphViewCombobox(t.textGraphComboboxData,t.evolutionViewCombobox.selectedIndex),t.noEvolutionEffSection.hide(),t.noCritEffSection.show(),t.noCritEffSection.setContent(o.caTooltipInfo),t.noCritEffSection.tooltipInfos=new a({shortHelp:o.caTooltipInfo})):""!=o.noCritOfficialExpression&&(t.createAndSetTextGraphViewCombobox(t.textOnlyComboboxData,t.evolutionViewCombobox.selectedIndex),t.noEvolutionEffSection.hide(),t.noCritEffSection.show(),t.noCritEffSection.setContent(o.noCritOfficialExpression),t.noCritEffSection.tooltipInfos=new a({shortHelp:o.noCritOfficialExpression}));else if("Projected"==t.evolutionViewSelector.get().view)if(t.caInfoIcon.hide(),o.evolutionView="Projected",o.orProjectedExpression)t.createAndSetTextGraphViewCombobox(t.textOnlyComboboxData,t.evolutionViewCombobox.selectedIndex),t.evolutionToolbar.show(),t.noEvolutionEffSection.hide(),t.noCritEffSection.show(),t.noCritEffSection.setContent(o.orProjectedExpression),t.noCritEffSection.tooltipInfos=new a({shortHelp:o.orProjectedExpression});else if(o.noCritProjectedExpression)t.createAndSetTextGraphViewCombobox(t.textOnlyComboboxData,t.evolutionViewCombobox.selectedIndex),t.evolutionToolbar.show(),t.noEvolutionEffSection.hide(),t.noCritEffSection.show(),t.noCritEffSection.setContent(o.noCritProjectedExpression),t.noCritEffSection.tooltipInfos=new a({shortHelp:o.noCritProjectedExpression});else if(o.projectedCriteria&&o.projectedCriteria.length>0){t.criteriaView=new f(o),t.criteriaView.render();var n=!1;o.projectedCriteria.forEach(function(e){"MV"!=e.name&&"MP"!=e.name||(n=!0)}),1==n?t.createAndSetTextGraphViewCombobox(t.textGraphComboboxData,t.evolutionViewCombobox.selectedIndex):t.createAndSetTextGraphViewCombobox(t.textOnlyComboboxData,t.evolutionViewCombobox.selectedIndex)}else"FALSE"!=o.projectedDisplayExpression&&"TRUE"!=o.projectedDisplayExpression||(t.createAndSetTextGraphViewCombobox(t.textOnlyComboboxData,t.evolutionViewCombobox.selectedIndex),t.evolutionToolbar.show(),t.noEvolutionEffSection.hide(),t.noCritEffSection.show(),t.noCritEffSection.setContent("FALSE"==o.projectedDisplayExpression?E.FALSE:E.TRUE),t.noCritEffSection.tooltipInfos=new a({shortHelp:"FALSE"==o.projectedDisplayExpression?E.FALSE:E.TRUE}));1==o.monoCriteria?"GRAPH"!=t.evolutionViewCombobox.currentValue?t.evolutionViewCombobox.currentValue="GRAPH":t.loadGraphView():t.manageTextGraphView(t.evolutionViewCombobox.currentValue)}})},manageNoVariantEffectivity:function(e){var t=this;this.effViewData.effModels.forEach(function(o){o.modelName===e.modelName&&o.modelLabel===e.modelLabel&&(""==o.variantDisplayExpression?(t.variantSection.hide(),t.noVariantEffSection.show()):(t.noVariantEffSection.hide(),t.variantSection.show()))})},updateVariantView:function(e){var t=this;this.manageNoVariantEffectivity(e),this.effViewData.effModels.forEach(function(o){o.modelName!==e.modelName||o.modelLabel!==e.modelLabel||("FALSE"==o.variantDisplayExpression?(t.variantExpressionTextHolder.setContent(E.FALSE),t.variantExpressionTextHolder.tooltipInfos=new a({shortHelp:E.FALSE})):(t.variantExpressionTextHolder.setContent(o.variantDisplayExpression),t.variantExpressionTextHolder.tooltipInfos=new a({shortHelp:o.variantDisplayExpression})))})},applyCompactComfortableMode:function(){0==this.displayCompactMode?(this.container.getElements(".section-label").forEach(function(e){e.setAttributeNode(document.createAttribute("touch-mode"))}),this.container.getElements(".expression-text").forEach(function(e){e.setAttributeNode(document.createAttribute("touch-mode"))}),this.container.getElements(".section-in-filler").forEach(function(e){e.setAttributeNode(document.createAttribute("touch-mode"))}),this.container.getElements(".section-out-filler").forEach(function(e){e.setAttributeNode(document.createAttribute("touch-mode"))}),this.container.getElements(".in-x-filler").forEach(function(e){e.setAttributeNode(document.createAttribute("touch-mode"))}),this.container.getElements(".model-label").forEach(function(e){e.setAttributeNode(document.createAttribute("touch-mode"))}),this.container.getElements(".no-eff-msg").forEach(function(e){e.setAttributeNode(document.createAttribute("touch-mode"))})):(this.container.getElements(".section-label").forEach(function(e){e.removeAttribute("touch-mode")}),this.container.getElements(".expression-text").forEach(function(e){e.removeAttribute("touch-mode")}),this.container.getElements(".section-in-filler").forEach(function(e){e.removeAttribute("touch-mode")}),this.container.getElements(".section-out-filler").forEach(function(e){e.removeAttribute("touch-mode")}),this.container.getElements(".in-x-filler").forEach(function(e){e.removeAttribute("touch-mode")}),this.container.getElements(".model-label").forEach(function(e){e.removeAttribute("touch-mode")}),this.container.getElements(".no-eff-msg").forEach(function(e){e.removeAttribute("touch-mode")}))}})}),define("DS/CfgEffectivityViewUX/scripts/CfgEffectivityViewFactory",["DS/CfgEffectivityViewUX/scripts/CfgEffectivityView","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/CfgBaseUX/scripts/CfgXMLServices","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgBaseUX/scripts/CfgController"],function(e,t,o,i,n){"use strict";return UWA.Class.extend({createInstance:function(t,i,n){let a=!1;return t.effData.officialEvolutionExpression.indexOf("<OR>")>0&&t.effData.officialEvolutionExpression.indexOf("</OR>")>0&&(a=!0),t.effModels=o.getExpressionView(t.effData.officialEvolutionExpression,t.effData.projectedEvolutionExpression,t.effData.variantExpression,t.modelData),new e({effViewData:t,parentElement:i,displayCompactMode:n,onlyConsolidatedView:a})},loadEffectivities:function(e,t){var o=this;return new Promise(function(a,l){var s={instanceID:[e],effData:{variantExpression:"",variantDisplayExpression:"",variantJSDisplayExpression:"",officialEvolutionExpression:"",projectedEvolutionExpression:"",officialEvolutionDisplayExpression:"",projectedEvolutionDisplayExpression:"",officialJSEvolutionDisplayExpression:"",projectedJSEvolutionDisplayExpression:""},modelData:[],effModels:[],isSearchKO:!1},r={version:"1.3",targetFormat:"XML",withDescription:"YES",view:"ALL",domains:"ALL",pidList:[e]};require(["DS/EditPropWidget/changeAction/passThruJS"],function(l){l.onReady(function(l){l.get2(function(l){null!=l&&null!=l.configurationRevision&&(r.configurationRev=l.configurationRevision),i.isDefined(window.enoviaServerFilterWidget)&&"Native"==window.enoviaServerFilterWidget.mode?i.populateDisplayExpressionXSLT().then(function(t){o.getEffectivities(r,s,e).then(function(e){a(e)},function(e){return Promise.reject(e)})},function(e){return Promise.reject(e)}):(n.init(null,"","3DDashboard"),enoviaServerFilterWidget.tenant=t,i.populate3DSpaceURL().then(function(t){i.populateSecurityContext().then(function(t){i.populateDisplayExpressionXSLT().then(function(t){o.getEffectivities(r,s,e).then(function(e){a(e)},function(e){return Promise.reject(e)})},function(e){return Promise.reject(e)})},function(e){return Promise.reject(e)})},function(e){return Promise.reject(e)}))})})})})},getEffectivities:function(e,t,n){return new Promise(function(a,l){i.getMultipleFilterableObjectInfo(e).then(function(e){var l=e.expressions;if("ERROR"===l[n].status&&Promise.reject("ERROR"),"YES"===l[n].hasEffectivity||"YES"===l[n].hasConfigRevEffectivity){if(null!=l[n].content.Variant&&(t.effData.variantExpression=l[n].content.Variant,t.effData.variantDisplayExpression=i.getDisplayExpressionUsingXSLT(t.effData.variantExpression)),null!=l[n].content.Evolution)if("YES"===l[n].hasConfigRevEffectivity){var s={Current:l[n].content.Evolution,Projected:l[n].content.Evolution};l[n].content.Evolution=s,t.effData.officialEvolutionExpression=t.effData.projectedEvolutionExpression=l[n].content.Evolution.Current,t.effData.officialEvolutionDisplayExpression=t.effData.projectedEvolutionDisplayExpression=i.getDisplayExpressionUsingXSLT(t.effData.officialEvolutionExpression)}else null!=l[n].content.Evolution.Current&&(t.effData.officialEvolutionExpression=l[n].content.Evolution.Current,t.effData.officialEvolutionDisplayExpression=i.getDisplayExpressionUsingXSLT(t.effData.officialEvolutionExpression)),null!=l[n].content.Evolution.Projected&&(t.effData.projectedEvolutionExpression=l[n].content.Evolution.Projected,t.effData.projectedEvolutionDisplayExpression=i.getDisplayExpressionUsingXSLT(t.effData.projectedEvolutionExpression));null!=l[n].content.ConfigChange&&(null!=l[n].content.ConfigChange.Current&&(t.effData.officialEvolutionExpression=l[n].content.ConfigChange.Current,t.effData.officialEvolutionDisplayExpression=i.getDisplayExpressionUsingXSLT(t.effData.officialEvolutionExpression)),null!=l[n].content.ConfigChange.Projected&&(t.effData.projectedEvolutionExpression=l[n].content.ConfigChange.Projected,t.effData.projectedEvolutionDisplayExpression=i.getDisplayExpressionUsingXSLT(t.effData.projectedEvolutionExpression)))}t.effData.officialJSEvolutionDisplayExpression=o.buildJSDisplayExpression(t.effData.officialEvolutionExpression,"EVOLUTION"),t.effData.projectedJSEvolutionDisplayExpression=o.buildJSDisplayExpression(t.effData.projectedEvolutionExpression,"EVOLUTION"),t.effData.variantJSDisplayExpression=o.buildJSDisplayExpression(t.effData.variantExpression,"VARIANT"),t.modelData=o.getModelsFromExpression(t.effData.officialEvolutionExpression,t.effData.variantExpression),i.getModelDataUsingSearchService(t.modelData).then(function(e){t.modelData=[],e.results&&e.results.forEach(function(e){t.modelData.push({modelID:i.getAttributeValue(e.attributes,"resourceid"),modelLabel:i.getAttributeValue(e.attributes,"ds6w:label"),modelName:i.getAttributeValue(e.attributes,"ds6w:identifier"),modelIcon:i.getAttributeValue(e.attributes,"type_icon_url")})}),a(t)},function(e){t.isSearchKO=!0,a(t)})},function(e){return Promise.reject(e)})})}})});