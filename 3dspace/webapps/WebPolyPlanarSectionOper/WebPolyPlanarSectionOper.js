define("DS/WebPolyPlanarSectionOper/WebPolyPolygon2D",["UWA/Class"],function(e){"use strict";return e.extend({init:function(e){return this._Polylines=e||[],this},AddPolyLine:function(e){this._Polylines.push(e)},GetAllPolyLines:function(){return this._Polylines}})}),define("DS/WebPolyPlanarSectionOper/WebPolyPolyLine2D",["UWA/Class"],function(e){"use strict";return e.extend({init:function(e){return this._Vertices=e||[],this},AddVertex:function(e){this._Vertices.push(e)},GetAllVertices:function(){return this._Vertices}})}),define("DS/WebPolyPlanarSectionOper/WebPolyPlanarSectionOper",["UWA/Class","DS/WebPolyMaths/WebMathsVector3D","DS/WebPolyMaths/WebMeshIntersection","DS/WebPolyMaths/WebToolsMeasure","DS/Visualization/PathElement","DS/Visualization/ThreeJS_DS","DS/WebPolyMaths/WebToolsSceneGraph","DS/WebPolyPlanarSectionOper/WebPolyPolyLine2D","DS/WebPolyPlanarSectionOper/WebPolyPolygon2D","DS/Mesh/Mesh","DS/Mesh/ThreeJS_Base"],function(e,t,n,i,r,l,o,a,s,m,u){"use strict";return e.extend({init:function(e){return this._Viewer=e,this},Run:function(e,t){var n={};return void 0!==this._Viewer&&(n=this._computeSectionCurves(e,t)),n},_computeSectionCurves:function(e,i){var c={},h=1;c.aAllPolygons=[],c.aAllColors=[];var y=[],P=[];if(i.length>0){0;for(var f=[],v=0;v<8;v++)f.push([0,0,0]);for(var g=(new l.Matrix4).getInverse(e),S=[e.elements[12],e.elements[13],e.elements[14]],b=[e.elements[8],e.elements[9],e.elements[10]],p=-t.dot(S,b),x=0;x<i.length;x++){var d=i[x].getWorldMatrix(),W=i[x].getLastElement(!0),V=d.elements,D=W.bBox;f[0][0]=D.min.x,f[0][1]=D.min.y,f[0][2]=D.min.z,f[1][0]=D.max.x,f[1][1]=D.min.y,f[1][2]=D.min.z,f[2][0]=D.min.x,f[2][1]=D.max.y,f[2][2]=D.min.z,f[3][0]=D.max.x,f[3][1]=D.max.y,f[3][2]=D.min.z,f[4][0]=D.min.x,f[4][1]=D.min.y,f[4][2]=D.max.z,f[5][0]=D.max.x,f[5][1]=D.min.y,f[5][2]=D.max.z,f[6][0]=D.min.x,f[6][1]=D.max.y,f[6][2]=D.max.z,f[7][0]=D.max.x,f[7][1]=D.max.y,f[7][2]=D.max.z,f[0]=t.transformPoint(f[0],V,f[0]);for(var _=f[0][0]*b[0]+f[0][1]*b[1]+f[0][2]*b[2]+p,z=!0,M=0;z&&M<8;M++){f[M]=t.transformPoint(f[M],V,f[M]),z=_*(f[M][0]*b[0]+f[M][1]*b[1]+f[M][2]*b[2]+p)>0}var w=this._Viewer.getCurrentSceneGraphState();if(!z)if(o.isLeaf(W)){var A=i[x];if(!1!==o.recursiveGetPathElementVisibility(this._Viewer,A)){var C=o.getRenderables(A);y=y.concat(C);for(var L=0;L<C.length;L++)P.push(d)}}else{var G=W.children,O=G.length;for(L=0;L<O;L++){var T=G[L];if(o.isReferenceOrInstance(T)){var E=new r;E.addElement(T);var I=this._Viewer.getVisibleSpace(),B=o.isVisible(this._Viewer,E);if(0!==I||B||(B=!0),w&&(B=w.getAppliedVisibility(E)),null===B||!0===B)(A=i[x].clone()).addElement(T),i.push(A)}}}}for(var R=0,U=y.length,J=0;J<U;J++){V=g.clone().multiply(P[J]).elements;var F,H=(new l.Matrix4).getInverse(P[J]).multiply(e).elements,j=y[J].geometry,k=y[J].material&&y[J].material.force;k&&(F=y[J].material.color.clone());for(var q=j.length,K=0;K<q;K++)for(var N=j[K].drawingGroups,Q=N.length,X=0;X<Q;X++)if(N[X]._geomType&&"FACE"===m.GeomTypeString[N[X]._geomType]){var Y;u.getWebVisualizationLevel()>=422&&(Y=new m.SGPrimitiveHelper);for(var Z=u.getWebVisualizationLevel()>=422?N[X].getPrimitivesCount():N[X].primitives.length,$=0;$<Z;$++){0,k||(F=N[X].gas.color.clone()),u.getWebVisualizationLevel()>=422?Y.set(N[X],$):Y=N[X].primitives[$];var ee=!0,te=u.getWebVisualizationLevel()>=422?Y.getBoundingSphere():Y.boundingSphere;if(te){var ne=[te.center[0],te.center[1],te.center[2]];ne=t.transformPoint(ne,V),te.radius-Math.abs(ne[2])<0&&(ee=!1)}if(!0===ee){var ie=n.computeSectionCurves(Y,V,H);if(0===ie.returnCode){h=0;for(var re=ie.aPolylines.length,le=0;le<re;le++)ie.aPolylines[le]=new a(ie.aPolylines[le]);ie.aPolygon=new s(ie.aPolylines),c.aAllPolygons[R]=ie.aPolygon,c.aAllColors[R]=F,R++}}}}}0}return c.returnCode=h,c}})});