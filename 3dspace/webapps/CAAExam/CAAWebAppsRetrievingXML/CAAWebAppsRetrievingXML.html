<?xml version="1.0" encoding="utf-8"?> 
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
 <html xmlns="http://www.w3.org/1999/xhtml" xmlns:widget="http://www.netvibes.com/ns/"> 
 <!-- Copyright 2014 , Dassault Systemes. All rights reserved. -->
<head>   
    
    <title>CAA Retrieving XML files</title>
	
	<!-- Application Metas Start -->
	
    <meta name="description" content="CAA WAFData basic use case" />
    <meta name="keywords" content="CAA Use Case WAFData" />
   	
	<!-- Application Metas End -->
	
	<widget:preferences>
	    <widget:preference type="text" name="URLServer"  
		                   label="Complete XML URL Path (without extension)"   
						   defaultValue="" ></widget:preference>
	</widget:preferences>	
		
	<!-- Application JS Start -->
    <script >
	/* global widget,require */
	require(['DS/CAAWebAppsRetrievingXML/CAAWebAppsRetrievingXMLTools'], 
	    function (CAAWebAppsRetrievingXMLTools) {
			'use strict';   
			
			var myWidget = {
	     
				//onLoad : event triggered when the widget is launched  
				// ---------------------------------------------------- 
				onLoad: function() {
				    var URL_FromPref = widget.getValue("URLServer") ;
					if ( URL_FromPref ) {
					    //WAFData does not support undefined URL Path
						var pos = URL_FromPref.lastIndexOf(".xml") ;
						console.log (pos);
						if ( URL_FromPref.lastIndexOf(".xml") === -1 ) {
							CAAWebAppsRetrievingXMLTools.DisplayXML(widget.body,widget.getValue("URLServer"));
						}else {
							widget.body.innerHTML="Please remove the xml extension for the URL";
						}
					}else {
						widget.body.innerHTML="Please enter an URL for the XML resource";
					}
				}		 
			};
			widget.addEvent('onLoad',    myWidget.onLoad);
		}
    );
	</script>
	<!-- Application JS End -->
</head>
<body>
</body>
</html>
