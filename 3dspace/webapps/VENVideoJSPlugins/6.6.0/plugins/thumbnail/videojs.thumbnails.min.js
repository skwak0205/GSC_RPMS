/**
 * @license
 * Copyright Brightcove, Inc. <https://www.brightcove.com/>
 * Available under Apache License Version 2.0
 * <https://github.com/dirkjanm/videojs-vtt-thumbnails/blob/master/LICENSE.md>
 **/
!function(){var e={width:0,height:0,basePath:""},t=function(){var e,n,o,r,a;n=(e=Array.prototype.slice.call(arguments)).shift()||{};for(o in e){r=e[o];for(a in r)r.hasOwnProperty(a)&&("object"==typeof r[a]?n[a]=t(n[a],r[a]):n[a]=r[a])}return n},n=function(e){return"HTML"!==e.nodeName&&"static"===(t=e,function(e){return window.getComputedStyle?window.getComputedStyle(t,o)[e]:t.currentStyle[e]})("position")?n(e.offsetParent):e;var t,o},o=function(t){var n,o,r;if(-1===(o=t.indexOf("#")))return{src:t,w:0,h:0,x:0,y:0};if(n=t.substring(0,o),"xywh="!==(r=t.substring(o+1)).substring(0,5))return{src:e.basePath+n,w:0,h:0,x:0,y:0};var a=r.substring(5).split(",");return{src:e.basePath+n,w:parseInt(a[2]),h:parseInt(a[3]),x:parseInt(a[0]),y:parseInt(a[1])}};videojs.plugin("thumbnails",function(r){var a,s,c,l,d,u,h,f,m;e.basePath=r.basePath||e.basePath,s=t({},e,r),l=this,this.remoteTextTracks().on("addtrack",function(){var e=l.remoteTextTracks().length;if(0!==e){for(i=0;i<e;){if("metadata"===l.remoteTextTracks()[i].kind){(m=l.remoteTextTracks()[i]).mode="hidden";break}i++}var t,r,g;-1!==navigator.userAgent.toLowerCase().indexOf("android")&&(r=function(){t.addClass("fake-active")},g=function(){t.removeClass("fake-active")},(t=l.controlBar.progressControl).on("touchstart",r),t.on("touchend",g),t.on("touchcancel",g)),(a=document.createElement("div")).className="vjs-thumbnail-holder",c=document.createElement("img"),a.appendChild(c),c.className="vjs-thumbnail",u=l.duration(),l.on("durationchange",function(e){u=l.duration()}),l.on("loadedmetadata",function(e){u=l.duration()}),(d=l.controlBar.progressControl).el().appendChild(a),h=function(e){var t,r,l,h,f,g,p,w,v,y=0;w=(window.pageXOffset?{x:window.pageXOffset,y:window.pageYOffset}:{x:document.documentElement.scrollLeft,y:document.documentElement.scrollTop}).x,f=((v=n(d.el()).getBoundingClientRect()).width||v.right)+w,h=e.pageX,e.changedTouches&&(h=e.changedTouches[0].pageX),r=h||e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,r-=n(d.el()).getBoundingClientRect().left+w,d.el().getElement&&d.el().getElement(".vjs-progress-holder")&&(y=d.el().getElement(".vjs-progress-holder").offsetLeft),t=Math.floor((r-y)/d.width()*u);var x=m&&m.cues.length;for(i=0;i<x;){var b=m.cues[i];if(b.startTime<=t&&b.endTime>=t){l=o(b.text);break}i++}void 0!==l&&(l.src&&c.src!=l.src&&(c.src=l.src),0===l.w&&(l.w=s.width),0===l.h&&(l.h=s.height),a.style.width==l.w&&a.style.height==l.h||(a.style.width=l.w+"px",a.style.height=l.h+"px"),c.style.left=-l.x+"px",c.style.top=-l.y+"px",c.style["background-position"]=l.x+"px "+l.y+"px",r+(p=(g=l.w)/2)>f?r=f-g:r<p?r=0:r-=p,a.style.left=r+"px")},d.on("mousemove",h),d.on("touchmove",h),f=function(e){a.style.left="-1000px"},d.on("mouseout",f),d.on("touchcancel",f),d.on("touchend",f),l.on("userinactive",f)}})})}();
