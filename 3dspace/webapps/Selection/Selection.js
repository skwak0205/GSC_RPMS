define("DS/Selection/XSO",["UWA/Core","UWA/Event","DS/CoreEvents/ModelEvents","UWA/Class"],function(t,e,n,i){"use strict";var s="/WEBAPP/",o=-1,h=function(){var t={};this.add=function(e){var n=e.hash(),i=t[n];if(i){for(var s=!1,o=0;o<i.length;++o)i[o].isEqual(e)&&(s=!0);s||i.push(e)}else(i=[]).push(e),t[n]=i},this.remove=function(e){var n=e.hash(),i=t[n];if(i){for(var s=!1,o=0;o<i.length;++o)if(i[o].isEqual(e)){s=!0,i.splice(o,1);break}return s}},this.contains=function(e){var n=e.hash(),i=t[n];if(i){for(var s=!1,o=0;o<i.length;++o)i[o].isEqual(e)&&(s=!0);return s}return!1},this.empty=function(){t={}}};return i.extend({init:function(e){this.options={areEquals:function t(e,n){if(e&&e.pathElement&&n&&n.pathElement)return e.pathElement.isEqual(n.pathElement);if(e instanceof Function)return n instanceof Function&&e.toString()===n.toString();if(null==e||null==n)return e===n;if(e===n)return!0;if("function"==typeof e.valueOf&&"function"==typeof n.valueOf&&e.valueOf()===n.valueOf())return!0;if(e instanceof Date)return!1;if(n instanceof Date)return!1;if(!(e instanceof Object&&n instanceof Object))return!1;var i=Object.keys(e);return!!Object.keys(n).every(function(t){return-1!==i.indexOf(t)})&&i.every(function(i){return t(e[i],n[i])})},useUniqueID:!1,publishOnlyPrePostEvents:!1},t.extend(this.options,e),this._modelEvents=new n,this._xsoUuid=t.Utils.getUUID(),this.options.useUniqueID?this._items={}:this._items=[],this.hashSetPathElement=new h},_getXsoID:function(t){return void 0!==t.__xso__?t.__xso__[this._xsoUuid]:void 0},_setXsoID:function(t,e){void 0===t.__xso__&&(t.__xso__={}),t.__xso__[this._xsoUuid]=e},_subscribe:function(e){var n={event:null,arrayOutput:!1,callback:null};if(t.extend(n,e),n.callback){var i=s+this.options.eventChannel+n.event;return this._modelEvents.subscribe({event:i},function(t){if(n.arrayOutput){var e=[];t instanceof"Array"?e.concat(t):e.push(t),n.callback.call(window,e)}else n.callback.call(window,t)})}},unsubscribe:function(t){return this._modelEvents.unsubscribe(t)},get:function(){if(this.options.useUniqueID){if(!this._cachedItems||this._needUpdateCachedItems){var t=this;this._cachedItems=Object.keys(this._items).map(function(e){return t._items[e]}),this._needUpdateCachedItems=!1}return this._cachedItems}return this._items},isIn:function(t){var e=!1,n=this;if(this.options.useUniqueID){if(this.options.getElementID){var i=this.options.getElementID(t);if(null!=i)return void 0!==this._items[i];throw"XSO: getElementID return something null or undefined"}return void 0!==this._getXsoID(t)}return t&&t.pathElement?this.hashSetPathElement.contains(t.pathElement):(this._items.forEach(function(i){n.options.areEquals(i,t)&&(e=!0)}),e)},isEmpty:function(){if(this.options.useUniqueID){for(var t in this._items)if(Object.prototype.hasOwnProperty.call(this._items,t))return!1;return!0}return!(this._items.length>0)},isBeingEmptied:function(){return this._isBeingEmptied},empty:function(t){var e=[];if(!this.isEmpty()){void 0===t&&(t=!0);if(this._modelEvents.publish({event:s+this.options.eventChannel+"PRE_REMOVE",data:this.get()}),t&&this._modelEvents.publish({event:s+this.options.eventChannel+"PRE_EMPTY",data:this.get()}),this.options.useUniqueID){for(var n in this._isBeingEmptied=!0,this._items){var i=this._items[n];e.push(i),void 0!==i&&this.remove(i)}this._isBeingEmptied=!1}else{for(;this._items.length;){i=this._items.shift();e.push(i),this._modelEvents.publish({event:s+this.options.eventChannel+"REMOVE",data:i}),this._modelEvents.publish({event:s+this.options.eventChannel+"UPDATE",data:i})}this.hashSetPathElement.empty()}this._modelEvents.publish({event:s+this.options.eventChannel+"POST_REMOVE",data:e}),t&&this._modelEvents.publish({event:s+this.options.eventChannel+"EMPTY",data:null})}},unique:function(t){this.options.useUniqueID?(!this.isIn(t)||this.get().length>1)&&(this.empty(!0),this.add(t)):(!this.isIn(t)||this.get().length>1)&&(this.empty(!1),this.add(t))},_addUnit:function(t,e){var n=!0;if(this.options.useUniqueID)if(n=!1,this.options.getElementID){var i=this.options.getElementID(t);if(null==i)throw"XSO: getElementID return something null or undefined";void 0===this._items[i]&&(this._needUpdateCachedItems=!0,this._items[i]=t,e.call(this,t),n=!0)}else{var s=this._getXsoID(t);void 0===s&&void 0===this._items[s]&&(this._needUpdateCachedItems=!0,o++,this._setXsoID(t,o),this._items[o]=t,e.call(this,t),n=!0)}else{if(t&&t.pathElement)n=!this.hashSetPathElement.contains(t.pathElement);else for(var h=0;h<this._items.length;h++){var a=this._items[h];if(this.options.areEquals(a,t)){n=!1;break}}n&&(t&&t.pathElement&&this.hashSetPathElement.add(t.pathElement),this._items.push(t),e.call(this,t))}return n},add:function(t){var e=[],n=this,i=function(t){n.options.publishOnlyPrePostEvents||(n._modelEvents.publish({event:s+n.options.eventChannel+"ADD",data:t}),n._modelEvents.publish({event:s+n.options.eventChannel+"UPDATE",data:t}))};this._modelEvents.publish({event:s+n.options.eventChannel+"PRE_ADD",data:t}),t instanceof Array?t.forEach(function(t){n._addUnit(t,i)&&e.push(t)}):n._addUnit(t,i)&&e.push(t),this._modelEvents.publish({event:s+n.options.eventChannel+"POST_ADD",data:e})},_removeUnit:function(t,e){var n=this,i=!1;if(this.options.useUniqueID)if(this.options.getElementID){var s=this.options.getElementID(t);if(null==s)throw"XSO: getElementID return something null or undefined";void 0!==this._items[s]&&(this._needUpdateCachedItems=!0,delete this._items[s],e.call(this,t),i=!0)}else{var o=this._getXsoID(t);void 0!==o&&void 0!==this._items[o]&&(this._needUpdateCachedItems=!0,delete this._items[o],this._setXsoID(t,void 0),e.call(this,t),i=!0)}else t&&t.pathElement&&(i=this.hashSetPathElement.remove(t.pathElement)),this._items.some(function(s,o){if(n.options.areEquals(s,t))return n._items.splice(o,1),e.call(this,t),i=!0,!0});return i},remove:function(t){var e=[],n=this,i=[];t instanceof Array?t.forEach(function(t){i.push(t)}):i.push(t),this._modelEvents.publish({event:s+n.options.eventChannel+"PRE_REMOVE",data:i});var o=function(t){n.options.publishOnlyPrePostEvents||(n._modelEvents.publish({event:s+n.options.eventChannel+"REMOVE",data:t}),n._modelEvents.publish({event:s+n.options.eventChannel+"UPDATE",data:t}))};t instanceof Array?t.forEach(function(t){n._removeUnit(t,o)&&!n._isBeingEmptied&&e.push(t)}):n._removeUnit(t,o)&&!n._isBeingEmptied&&e.push(t);this._isBeingEmptied||this._modelEvents.publish({event:s+n.options.eventChannel+"POST_REMOVE",data:e})},onChange:function(t,e){return void 0===e&&(e={arrayOutput:!1}),this._subscribe({event:"UPDATE",arrayOutput:e.arrayOutput,callback:t})},onAdd:function(t){if(t)return this._modelEvents.subscribe({event:s+this.options.eventChannel+"ADD"},function(e){t.call(window,e)})},onPreAdd:function(t){if(t)return this._modelEvents.subscribe({event:s+this.options.eventChannel+"PRE_ADD"},function(e){t.call(window,e)})},onPostAdd:function(t){if(t)return this._modelEvents.subscribe({event:s+this.options.eventChannel+"POST_ADD"},function(e){t.call(window,e)})},onPreRemove:function(t){if(t)return this._modelEvents.subscribe({event:s+this.options.eventChannel+"PRE_REMOVE"},function(e){t.call(window,e)})},onPostRemove:function(t){if(t)return this._modelEvents.subscribe({event:s+this.options.eventChannel+"POST_REMOVE"},function(e){t.call(window,e)})},onUpdate:function(t){t&&(this.onEmpty(t),this.onRemove(t),this.onAdd(t))},onRemove:function(t){if(t)return this._modelEvents.subscribe({event:s+this.options.eventChannel+"REMOVE"},function(e){t.call(window,e)})},onEmpty:function(t){if(t)return this._modelEvents.subscribe({event:s+this.options.eventChannel+"EMPTY"},function(e){t.call(window,e)})},onPreEmpty:function(t){if(t)return this._modelEvents.subscribe({event:s+this.options.eventChannel+"PRE_EMPTY"},function(e){t.call(window,e)})}})}),define("DS/Selection/CSOManager",["UWA/Core","UWA/Event","DS/CoreEvents/Events","DS/Selection/XSO"],function(t,e,n,i){"use strict";var s=i.singleton({init:function(t){t={eventChannel:"CSO/"},this._parent(t)}});return t.namespace("WUX/Selection/CSOManager",s)}),define("DS/Selection/HSOManager",["UWA/Core","UWA/Event","DS/CoreEvents/Events","DS/Selection/XSO"],function(t,e,n,i){"use strict";var s=i.singleton({init:function(t){t={eventChannel:"HSO/"},this._parent(t)}});return t.namespace("WUX/Selection/HSOManager",s)}),define("DS/Selection/PSOManager",["UWA/Core","UWA/Event","DS/CoreEvents/Events","DS/Selection/XSO"],function(t,e,n,i){"use strict";var s=i.singleton({init:function(t){t={eventChannel:"PSO/"},this._parent(t)}});return t.namespace("WUX/Selection/PSOManager",s)});