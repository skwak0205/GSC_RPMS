define("DS/VisuDataAccess/Ox4TreeTarget",[],function(){"use strict";return function(e,t){var n={},r={},a=e,i=t;n[a.physicalid]=i("Node"),n[a.physicalid].id=a.physicalid;var s=n[a.physicalid];s.ident=a.physicalid,s.isrel=!1,null!=a.dtype&&(s.plmtype=a.dtype),this.FindRootNodeWorkType=function(){a.typeHelper.IsBusA(s.plmtype,a.shapeType)?s.worktype=a.shapeType:a.typeHelper.IsBusA(s.plmtype,"VPMReference")&&(s.worktype="VPMReference"),r[s.plmtype]=[s],s.worktype!==s.plmtype&&(r[s.worktype]=[s])},this.rootNode=function(){return s},this.registerRelationship=function(e){var t=this.findNodeByPhysicalId(e.phyid);t.boid=e.ident,t.id=e.phyid,t.plmtype=e.plmtype,t.worktype=e.plmtype,t.title=e.title,t.plmexternalId=e.realName,t.owner=e.owner,t.isrel=!0;var n=this.findNodeByPhysicalId(e.to.phyid);n.boid=e.to.ident,n.id=e.to.phyid,n.plmtype=e.to.plmtype,n.worktype=n.plmtype,n.title=e.to.title,n.plmexternalId=e.to.realName,n.owner=e.to.owner,n.isrel=!1,e.from.add(t),t.add(n)},this.countObjects=function(){var e=0;for(var t in n)n.hasOwnProperty(t)&&e++;return e},this.dumpObjects=function(){for(var e in n)n.hasOwnProperty(e)&&console.log(n[e]);return 0},this.FindWorkTypes=function(e,t){a.typeHelper.RegisterParentsTypes(e,function(){for(var e in n){n[e].isrel?a.typeHelper.IsRelA(n[e].plmtype,a.instanceType)&&(n[e].worktype=a.instanceType):a.referenceType&&a.typeHelper.IsBusA(n[e].plmtype,a.referenceType)?n[e].worktype=a.referenceType:a.typeHelper.IsBusA(n[e].plmtype,a.shapeType)&&(n[e].worktype=a.shapeType);var i=n[e].plmtype,s=n[e].worktype;r.hasOwnProperty(i)||(r[i]=[]),r[i].push(n[e]),s!==i&&(r.hasOwnProperty(s)||(r[s]=[]),r[s].push(n[e]))}t()})},this.findNodeByPhysicalId=function(e){return void 0===n[e]&&(n[e]=i("Node"),n[e].id=e),n[e]},this.findNodeByType=function(e){var t=[];return r.hasOwnProperty(e)&&(t=r[e]),t},this.findNodeByPLMTypeExpressedAsPhyIdSeparatedByComma=function(e){var t=[];r.hasOwnProperty(e)&&(t=r[e]);var n="";return t.forEach(function(e,r){n+=e.id,r<t.length-1&&(n+=",")}),n},this.findNodeByPLMTypeExpressedAsPhyIdAsJSON=function(e){var t=this.findNodeByType(e),n=[];return t.length>0?(t.forEach(function(e,t){n.push(e.id)}),JSON.stringify(n)):[]}}}),define("VisuDataAccess/Ox4TreeTarget",["DS/VisuDataAccess/Ox4TreeTarget","DS/DSMigration/DSMigration"],function(e,t){return t.deprecateModule("VisuDataAccess/Ox4TreeTarget"),e}),define("DS/VisuDataAccess/Ox4TaskPlanner",[],function(){"use strict";return function(){var e=new Array,t=0,n=null;this.addSequentialTask=function(t){var n=new Array;n.push(t),e.push(n)},this.addEndingTask=function(e){n=e},this.endingTask=function(){return n},this.next=function(){return t<e.length?e[(t+=1)-1]:null},this.resetIterator=function(){t=0},this.tasksCount=function(){return e.length},this.currentTaskIndex=function(){return t}}}),define("VisuDataAccess/Ox4TaskPlanner",["DS/VisuDataAccess/Ox4TaskPlanner","DS/DSMigration/DSMigration"],function(e,t){return t.deprecateModule("VisuDataAccess/Ox4TaskPlanner"),e}),define("DS/VisuDataAccess/Ox4xMQLSelectTaskDefinition",[],function(){"use strict";return function(e,t,n,r){var a=e,i=t;this.boOrRel=r,this.injectRowInto=n;var s=function(e){for(var t="",n=0;n<e.length;n++)t=t+" "+e[n];return t};this.typeRequested=function(){return a},this.attributes=function(){return listOfAttributes},this.marshallAsMQLListOfFetchAttributes=function(){if(null===i.Fetch)throw"no fetch attributes selected";return s(i.Fetch)},this.marshallAsMQLListOfFetchAttributesAsJSON=function(){if(null===i.Fetch)throw"no fetch attributes selected";return JSON.stringify(i.Fetch)},this.hasPathAttrs=function(){return void 0!==i.Path&&null!==i.Path},this.marshallAsMQLListOfPathAttributes=function(){if(null===i.Path)throw"no path attributes selected";return s(i.Path)},this.marshallAsMQLListOfPathAttributesAsJSON=function(){if(null===i.Fetch)throw"no fetch attributes selected";return JSON.stringify(i.Path)}}}),define("VisuDataAccess/Ox4xMQLSelectTaskDefinition",["DS/VisuDataAccess/Ox4xMQLSelectTaskDefinition","DS/DSMigration/DSMigration"],function(e,t){return t.deprecateModule("VisuDataAccess/Ox4xMQLSelectTaskDefinition"),e}),define("DS/VisuDataAccess/Ox4TicketGeneratorTask",[],function(){"use strict";return function(e,t){var n=e,r=t;this.generateRequest=function(){return{url:r.xmqlServiceUri(),data:n}}}}),define("VisuDataAccess/Ox4TicketGeneratorTask",["DS/VisuDataAccess/Ox4TicketGeneratorTask","DS/DSMigration/DSMigration"],function(e,t){return t.deprecateModule("VisuDataAccess/Ox4TicketGeneratorTask"),e}),define("DS/VisuDataAccess/Ox4FeatureModeler",["DS/ZipJS/zip"],function(e){"use strict";var t={rootFeature:new function(){this.startupFacade=function(){this.attributes={}},this.featureFacade=new this.startupFacade},fmZipReader:function(t){var n=this;n.archive=new e.BlobReader(t),n.entries=null,n.entriesCount=0,n.entriesRead=0,n.readNextEntry=function(t,r){var a,i=n.entries[n.entriesRead];a=i.filename,i.getData(new e.TextWriter,function(e){t(a,e.target.result),++n.entriesRead==n.entriesCount?r():n.readNextEntry(t,r)})},n.read=function(t,r){e.createReader(n.archive,function(e){e.getEntries(function(e){n.entries=e,n.entriesCount=e.length,n.readNextEntry(t,r)})})}},unstreamDocument:function(e,n){var r={containers:{},links:{},features:{}};t.representations.hasOwnProperty(e.representationId)?console.log("[E] FM: representation already loaded"):(t.representations[e.representationId]={uuid:{},component:{},specobject:{}},new t.fmZipReader(e.stream).read(function(n,a){var i=null!==/91ACA40B\\0\.8\\(data.json)/g.exec(n)?"containers":null!==/D182A118\\0\.8\\(data.json)/g.exec(n)?"links":null!==/BFC0DC13\\0\.8\\(data.json)/g.exec(n)?"features":null;i&&t.unstreamDomain[i]({domainDependencyTable:r[i],externalDependencies:function(e,t){return r[e][t]},representationId:e.representationId,repRef:e.repRef,stream:a})},n))},unstreamDomain:{containers:function(e){var n,r=void 0!==e.resourceName?t.resources[e.resourceName]:t.representations[e.representationId];for(n in r.containers=e.stream?JSON.parse(e.stream):void 0,r.containers)e.domainDependencyTable[n]=r.containers[n]},links:function(e){var n,r=void 0!==e.resourceName?t.resources[e.resourceName]:t.representations[e.representationId];for(n in r.links=e.stream?JSON.parse(e.stream):void 0,r.links){var a=r.links[n];a.relationTarget=e.repRef.SemanticRelations[a.RelationId],e.domainDependencyTable[n]=a}},features:function(e){var n=null;try{n=JSON.parse(e.stream)}catch(e){throw"[F] FM: JSON error)"}var r,a={};for(r in n){var i=n[r];a[r]=new t.Feature(i,a,e)}for(r in n)t.unstreamFeature2(a[r],a,e)}},unstreamFeature2:function(e,n,r){var a,i,s=null!=r.resourceName?t.resources[r.resourceName]:t.representations[r.representationId];for(a in e.data.attributes){var o=e.data.attributes[a],c=o.value instanceof Array?o.value:[o.value];switch(o.type){case"external":if(void 0!==r.representationId)for(i=0;i<c.length;i++)c[i]=null!==c[i]?r.externalDependencies("links",c[i].id):void 0;break;case"component":case"specobject":for(i=0;i<c.length;i++){var u=null!==c[i]?n[c[i].id]:void 0;if(u){c[i]=u.featureFacade;var l=u.data.uuid;if("component"===o.type&&s[o.type][l])throw"[F] FM: AGG error";s[o.type][l]||(s[o.type][l]=[]),s[o.type][l].push({source:e,attrName:a})}}}o.value instanceof Array?Object.freeze(o.value):o.value=c[0]}},Feature:function(e,n,r){var a=this;a.data={properties:e.properties,attributes:e.values,startupProperties:e.startup,name:e.system.name,diezele:e.readonly.diezele,uuid:e.readonly.uuid},e.hasOwnProperty("ancestor")?e.ancestor.hasOwnProperty("resource")?a.data.ancestor=t.rootFeature:a.data.ancestor=n[e.ancestor.id]:a.data.ancestor=t.rootFeature,a.featureFacade=new a.data.ancestor.featureFacade.constructor,a.featureFacade.name=a.data.name,a.featureFacade.attributes=Object.create(a.data.ancestor.featureFacade.attributes);var i;for(i in Object.defineProperty(a.featureFacade,"name",{get:function(){return a.data.name},enumerable:!0}),a.data.attributes)Object.defineProperty(a.featureFacade.attributes,i,function(e){return{get:function(){return t.getValue(a.data.attributes[e])},enumerable:!0}}(i));if(a.data.uuid in t.representations[r.representationId].uuid)throw"[F] FM: uuid already defined in same scope";t.representations[r.representationId].uuid[a.data.uuid]=a},getValue:function(e){var t,n=e.value;switch(e.type){case"external":var r=n instanceof Array?n:[n];for(t=0;t<r.length;t++)r[t]=r[t].relationTarget;!n instanceof Array&&(n=r[0])}return n}};return{init:function(){t.representations={}},loadRepresentation:function(e,n,r,a){t.unstreamDocument({stream:r,representationId:n,repRef:e},a)},loadResource:function(e,n){t.unstreamDocument({stream:n,resourceName:e})},listRootFeatures:function(e){var n,r=[];for(n in t.representations[e].uuid)if(void 0===t.representations[e].component[n]){var a=t.representations[e].uuid[n];r.push(a.featureFacade)}return r},containFeatures:function(e){return t.representations.hasOwnProperty(e)}}}),define("DS/VisuDataAccess/Ox4ExpandTask",[],function(){"use strict";return function(e,t,n){this.oid=e,this.serverdefinition=t,this.relationship=n;var r=null;this.generateMQL=function(){return this.serverdefinition.rawmode?this.generateRawMQL():this.generateProcMQL()},this.generateRawMQL=function(){var e="start transaction ;\n";return e+="expand businessobject  %oid% from relationship "+this.relationship+"  recurse to all size 1000 terse select bus physicalid type select relationship id physicalid dump | tcl;\n",e+="abort transaction ;\n"},this.generateProcMQL=function(){var e='<?xml version="1.0" encoding="utf-8"?>\n';return e+='<executeSequence xmlns="http://www.3ds.com/xmql/query">\n',e+="\t<execute>\n",e+="\t\t<function>expand_bus</function>\n",e+="\t\t<version>2.0.0</version>\n",e+="\t\t<params>\n",e+='\t\t\t<param name="label">expand</param>\n',e+='\t\t\t<param name="rootid">%oid%</param>\n',e+='\t\t\t<param name="from">true</param>\n',e+='\t\t\t<param name="to"></param>\n',e+='\t\t\t<param name="typepattern">*</param>\n',e+='\t\t\t<param name="relpattern">'+this.relationship+"</param>\n",e+='\t\t\t<param name="fixedpointskw"/>\n',e+='\t\t\t<param name="fixedpointsids">[]</param>\n',e+='\t\t\t<param name="withroots">true</param>\n',e+='\t\t\t<param name="preventduplicates">false</param>\n',e+='\t\t\t<param name="recurselevel">all</param>\n',e+='\t\t\t<param name="size">1000</param>\n',e+='\t\t\t<param name="terse">true</param>\n',e+='\t\t\t<param name="selectbo"> ["physicalid", "type", "attribute[PLMEntity.V_Name]", "attribute[PLMEntity.PLM_ExternalID]", "owner"]</param>\n',e+='\t\t\t<param name="wherebokw"/>\n',e+='\t\t\t<param name="wherebo"/>\n',e+='\t\t\t<param name="selectrel">["id","physicalid", "attribute[PLMInstance.V_Name]", "attribute[PLMInstance.PLM_ExternalID]", "owner"]</param>\n',e+='\t\t\t<param name="whererel"/>\n',e+='\t\t\t<param name="dump">|</param>\n',e+='\t\t\t<param name="notsubstitute">true</param>\n',e+="\t\t</params>\n",e+="\t</execute>\n",e+="</executeSequence>\n"};var a=this.generateMQL();this.run=function(n,i,s,c,u){r=n,console.log("running Ox4xMQLExpandTask");var l=t.xmqlServiceUri(),p=a.replace("%oid%",this.oid);i.executePostHttpRequest(l,t.rawmode,p,function(t){console.log("callback has been called"),new o(e,n,t,function(){c(this)})})},this.dataSet=function(){return r};var i={bus:[],rel:[]},s=function(e,t){var n=t,r=new Array;this.setFatherLevel=function(e){var t=r.length-1;if(e>t);else if(e<=t){for(var n=t;n!=e;)r.pop(),n-=1;r.pop()}},this.lastNode=function(){return r[r.length-1]},this.pushNode=function(e){r.push(e)},this.getRootNode=function(){return n.rootNode()},this.pushNode(n.rootNode()),this.registerRelationship=function(e,t){n.registerRelationship(t);var r=n.findNodeByPhysicalId(t.to.phyid);this.pushNode(r)}},o=function(e,t,n,r){var a=new s(e,t),o=function(e){var t,n=/\{([^\{\}]*)}/g,r=-1,s=0,o=new Object;o.to=new Object;for(var c=-1;null!==(t=n.exec(e));){var u=t[1];if("0"===c)6===s?a.getRootNode().title=u:7===s?a.getRootNode().plmexternalId=u:8===s&&(a.getRootNode().owner=u);else if(0===s){if("0"===(c=u)){s+=1;continue}a.setFatherLevel(c)}else 1===s?(o.plmtype=u,-1===i.rel.indexOf(u)&&i.rel.push(u)):2===s||(3===s?o.to.ident=u:4===s?o.to.phyid=u:5===s?(o.to.plmtype=u,-1===i.bus.indexOf(u)&&i.bus.push(u)):6===s?o.to.title=u:7===s?o.to.realName=u:8===s?o.to.owner=u:9===s?o.ident=u:10===s?o.phyid=u:11===s?o.title=u:12===s?o.realName=u:13===s&&(o.owner=u));s+=1,n.lastIndex===r&&(isILinenfiniteLoop=!0),r=n.lastIndex}if("0"!==c&&void 0!==o.phyid){var l=a.lastNode();o.from=l,a.registerRelationship(c,o)}};!function(e){for(var a,s=/[^\r\n]+/g,c=-1,u=!1;null!==(a=s.exec(n))&&!u;)o(a[0]),s.lastIndex===c&&(u=!0),c=s.lastIndex;t.FindWorkTypes(i,function(){r()})}()}}}),define("VisuDataAccess/Ox4ExpandTask",["DS/VisuDataAccess/Ox4ExpandTask","DS/DSMigration/DSMigration"],function(e,t){return t.deprecateModule("VisuDataAccess/Ox4ExpandTask"),e}),define("DS/VisuDataAccess/Ox4PLMDataHelper",[],function(){"use strict";return function(e){var t=e,n=t.threedexpServiceUri(),r=function(){return"start transaction ;\nget checkout ticket nozip mcsurl %1 \n store %2 \nbusinessobjectproxy physicalid %3 format %4 filename %5 tcl;\nabort transaction ;\n"},a=function(){return'<?xml version="1.0" encoding="utf-8"?>\n<executeSequence xmlns="http://www.3ds.com/xmql/query">\n\t<execute>\n\t\t<function>get_checkout_ticket</function>\n\t\t<version>2.0.0</version>\n\t\t<params>\n\t\t\t<param name="label">checkout</param>\n\t\t\t<param name="zipkw">nozip</param>\n\t\t\t<param name="mcsurl">%1</param>\n\t\t\t<param name="bops">[{"store": "%2", "bops": [{"physicalid": "%3", "format": "%4", "filename": "%5"}]}]</param>\n\t\t</params>\n\t</execute>\n</executeSequence>\n'},i=t.rawmode?r():a();this.transformSelectedFileIntoTicketRequest=function(e,t,n,r){return o(e,n,t,r)},this.transformSelectedSDByRoleAndFormatIntoTicketRequest=function(e,t,n,r,a,i){return 0==t.indexOf("SDv2")?this.transformSelectedSDv2ByRoleAndFormatIntoTicketRequest(e,t,n,r,a,i):0==t.indexOf("SDV0")?this.transformSelectedSDv0ByRoleAndFormatIntoTicketRequest(e,t,n,r,a,i):"E_NOTIMPLEMENTED"},this.transformSelectedSDv0ByRoleAndFormatIntoTicketRequest=function(e,t,n,r,a,i){var o=u(t),l=c(o,n,r,a),p=null;return null!==l&&(p=s(e,l,i)),p},this.transformSelectedSDv2ByRoleAndFormatIntoTicketRequest=function(e,t,n,r,a,i){var o=p(t),u=c(o,n,r,a),l=null;return null!==u&&(l=s(e,u,i)),l};var s=function(e,t,r){var a=e+"_"+t.role+"."+t.format;return void 0!==t.persistancyname&&t.persistancyname.length>0&&(a+="="+t.persistancyname),a+="",i.replace("%1",n).replace("%2",r).replace("%3",e).replace("%4",t.format).replace("%5",a)},o=function(e,t,r,a){return i.replace("%1",n).replace("%2",t).replace("%3",e).replace("%4",r).replace("%5",a)},c=function(e,t,n,r){for(var a=0;a<r.length;a++)for(var i=r[a],s=0;s<e.length;s++){var o=e[s];if(o.role==n&&o.format==i&&o.latetype==t)return o}return null},u=function(e){for(var t,n=/[^:]+/g,r=-1,a=[];null!==(t=n.exec(e));){var i=l(t[0]);a.push(i),n.lastIndex===r&&(isILinenfiniteLoop=!0),r=n.lastIndex}return a},l=function(e){return function(e,t){var n,r=/[^,]+/g,a=-1,i=0,s=new Object;for(s.sdtype=e;null!==(n=r.exec(t));)0===i?s.format=n[0]:1===i?s.role=n[0]:2===i?s.latetype=n[0]:3===i&&(s.watermarkstamp=n[0]),i+=1,r.lastIndex===a&&(isILinenfiniteLoop=!0),a=r.lastIndex;return s}(e.slice(3,4),e.slice(5,e.length-1))};var p=function(e){for(var t,n=/[^:]+/g,r=-1,a=[];null!==(t=n.exec(e));){var i=d(t[0]);a.push(i),n.lastIndex===r&&(isILinenfiniteLoop=!0),r=n.lastIndex}return a},d=function(e){return function(e,t){var n,r=/[^,]+/g,a=-1,i=0,s=new Object;for(s.sdtype=e;null!==(n=r.exec(t));)0===i?s.format=n[0]:1===i?s.role=n[0]:2===i?s.latetype=n[0]:3===i?s.watermarkstamp=n[0]:4===i?s.synchrostamp=n[0]:5===i?s.persistancytype=n[0].replace(/[']+/g,""):6===i&&(s.persistancyname=n[0].replace(/[']+/g,"")),i+=1,r.lastIndex===a&&(isILinenfiniteLoop=!0),a=r.lastIndex;return s}(e.slice(3,4),e.slice(5,e.length-1))}}}),define("VisuDataAccess/Ox4PLMDataHelper",["DS/VisuDataAccess/Ox4PLMDataHelper","DS/DSMigration/DSMigration"],function(e,t){return t.deprecateModule("VisuDataAccess/Ox4PLMDataHelper"),e}),define("DS/VisuDataAccess/Ox4StreamUnStreamerTaskDefinition",[],function(){"use strict";return function(e,t,n){var r=e;this.streamReceived=t,this.streamsNumber=n,this.responseType=null,this.typeRequested=function(){return r}}}),define("DS/VisuDataAccess/ProxyAbstraction",["DS/Visualization/ProxyAbstraction"],function(e){"use strict";return e}),define("VisuDataAccess/ProxyAbstraction",["DS/VisuDataAccess/ProxyAbstraction","DS/DSMigration/DSMigration"],function(e,t){return t.deprecateModule("VisuDataAccess/ProxyAbstraction"),e}),define("DS/VisuDataAccess/Ox4DECSelectTask",[],function(){"use strict";return function(e,t,n){var r=e,a=t,i=function(e,t,n,r){var a=e,i=t,s=function(e,t){var n=/\{([^\}]*)}/g;t=t.substring(1,t.length-1);for(var r,s=-1,o=new Array;null!==(r=n.exec(t));)0==r[0].indexOf("{{")&&(r[0]=r[0].substring(2,r[0].length)),0==r[0].indexOf("{")&&(r[0]=r[0].substring(1,r[0].length)),r[0].indexOf("}")==r[0].length-1&&(r[0]=r[0].substring(0,r[0].length-1)),o.push(r[0]),n.lastIndex===s&&(isILinenfiniteLoop=!0),s=n.lastIndex;a.injectRowInto(o,i)};!function(e){for(var t,i=/[^\r\n]+/g,o=-1,c=!1;null!==(t=i.exec(n))&&!c;)s(a,t[0]),i.lastIndex===o&&(c=!0),o=i.lastIndex;r()}()},s=function(){var e="start transaction ;\n";return 0==r.boOrRel?e+="query connection type '%1'  where \"physicalid matchlist '%2'','\"  select %3 dump | tcl;\n":1==r.boOrRel?e+="temporary query businessobject  '%1' * *  where \"physicalid matchlist '%2'','\"  select %3 dump | tcl;\n":2==r.boOrRel?e+="temporary query businessobject  * * *  where \"physicalid matchlist '"+n+"'','\"  select %3 dump | tcl;\n":e+=" expand businessobject "+n+' from relationship "CAD SubComponent" recurse to all size 1000 terse select bus physicalid name dump | tcl;\n',e+="abort transaction ;\n"},o=function(){var e='<?xml version="1.0" encoding="utf-8"?>\n';return e+='<executeSequence xmlns="http://www.3ds.com/xmql/query">\n',e+="\t<execute>\n",r.boOrRel>=0&&r.boOrRel<=2?(0==r.boOrRel?e+="\t\t<function>query_connection</function>\n":e+="\t\t<function>query_bus</function>\n",e+="\t\t<version>2.2.1</version>\n",e+="\t\t<params>\n",e+='\t\t\t<param name="label">select</param>\n',0!=r.boOrRel&&(e+='\t\t\t<param name="name">*</param>\n',e+='\t\t\t<param name="revision">*</param>\n'),e+='\t\t\t<param name="vault">*</param>\n',e+='\t\t\t<param name="orderbykw"/>\n',e+='\t\t\t<param name="orderby"/>\n',e+='\t\t\t<param name="limitkw"/>\n',e+='\t\t\t<param name="limit"/>\n',e+='\t\t\t<param name="where">where</param>\n',e+='\t\t\t<param name="select">%3</param>\n',2==r.boOrRel?(e+='\t\t\t<param name="type">*</param>\n',e+='\t\t\t<param name="where">physicalid matchlist \''+n+"'','</param>\n"):(e+='\t\t\t<param name="type">%1</param>\n',e+="\t\t\t<param name=\"where\">physicalid matchlist '%2'','</param>\n"),e+='\t\t\t<param name="notsubstitute">true</param>\n',e+='\t\t\t<param name="dump">|</param>\n',e+="\t\t</params>\n"):(e+="\t\t<function>expand_bus</function>\n",e+="\t\t<version>2.0.0</version>\n",e+="\t\t<params>\n",e+='\t\t\t<param name="label">expand</param>\n',e+='\t\t\t<param name="rootid">'+n+"</param>\n",e+='\t\t\t<param name="from">true</param>\n',e+='\t\t\t<param name="to"/>\n',e+='\t\t\t<param name="typepattern">*</param>\n',e+='\t\t\t<param name="relpattern">"CAD SubComponent"</param>\n',e+='\t\t\t<param name="fixedpointskw"/>\n',e+='\t\t\t<param name="fixedpointsids">[]</param>\n',e+='\t\t\t<param name="withroots">false</param>\n',e+='\t\t\t<param name="preventduplicates">false</param>\n',e+='\t\t\t<param name="recurselevel">all</param>\n',e+='\t\t\t<param name="selectbo"> ["physicalid", "name"]</param>\n',e+='\t\t\t<param name="wherebo"/>\n',e+='\t\t\t<param name="selectrel"/>\n',e+='\t\t\t<param name="whererelkw"/>\n',e+='\t\t\t<param name="whererel"/>\n',e+='\t\t\t<param name="dump">|</param>\n',e+="\t\t</params>\n"),e+="\t</execute>\n",e+="</executeSequence>\n"},c=a.rawmode?s():o();this.run=function(e,t,n,i,s){console.log("running Ox4xMQLSelectTask");var o=a.xmqlServiceUri(),l=r.typeRequested(),p=e.findNodeByPLMTypeExpressedAsPhyIdSeparatedByComma(l);if(p.length>0){var d=c.replace("%1",l);d=(d=d.replace("%3",r.marshallAsMQLListOfFetchAttributesAsJSON())).replace("%2",p),t.executePostHttpRequest(o,a.rawmode,d,function(t){u(t,e,i)})}else i(this)};var u=function(e,t,n){new i(r,t,e,function(){n(this)})}}}),define("VisuDataAccess/Ox4DECSelectTask",["DS/VisuDataAccess/Ox4DECSelectTask","DS/DSMigration/DSMigration"],function(e,t){return t.deprecateModule("VisuDataAccess/Ox4DECSelectTask"),e}),define("DS/VisuDataAccess/Ox4SelectTask",[],function(){"use strict";return function(e,t){var n=e,r=t,a=function(e,t,n,r){var a=e,i=t,s=function(e,t,n){var r=/\{(.*?)\}[\s\}]/g;n=n.substring(1,n.length-1);for(var s,o=-1,c=new Array;null!==(s=r.exec(n));){for(s[0]=s[0].trim(),0==s[0].indexOf("{{")&&(s[0]=s[0].substring(2,s[0].length)),0==s[0].indexOf("{")&&(s[0]=s[0].substring(1,s[0].length)),s[0].indexOf("}")==s[0].length-1&&(s[0]=s[0].substring(0,s[0].length-1));s[0].startsWith("{")||s[0].endsWith("}");)s[0].startsWith("{")&&(s[0]=s[0].substring(1,s[0].length)),s[0].endsWith("}")&&(s[0]=s[0].substring(0,s[0].length-1));c.push(s[0]),r.lastIndex===o&&(isILinenfiniteLoop=!0),o=r.lastIndex}a.injectRowInto(t,c,i)};!function(e){for(var t,i=/[^\r\n]+/g,o=/^paths:.*/g,c=-1,u=!1,l="fetch";null!==(t=i.exec(n))&&!u;)a.hasPathAttrs()&&"fetch"===l&&null!==o.exec(t[0])&&(l="path"),s(a,l,t[0]),i.lastIndex===c&&(u=!0),c=i.lastIndex;r()}()},i=function(){var e="start transaction ;\n";return 0==n.boOrRel?e+="query connection type %1  where \"physicalid matchlist '%2'','\"  select %3 dump | tcl;\n":e+="temporary query businessobject  %1 * *  where \"physicalid matchlist '%2'','\"  select %3 dump | tcl;\n",e+="abort transaction ;\n"},s=function(){var e='<?xml version="1.0" encoding="utf-8"?>\n';return e+='<executeSequence xmlns="http://www.3ds.com/xmql/query">\n',e+="\t<execute>\n",0==n.boOrRel?e+="\t\t<function>query_connection_set":e+="\t\t<function>query_bus_set",n.hasPathAttrs()&&(e+="_sr"),e+="</function>\n",e+="\t\t<version>2.0.0</version>\n",e+="\t\t<params>\n",e+='\t\t\t<param name="label">fetch</param>\n',e+='\t\t\t<param name="setname">%s</param>\n',0!=n.boOrRel&&(e+='\t\t\t<param name="name">*</param>\n',e+='\t\t\t<param name="revision">*</param>\n'),e+='\t\t\t<param name="vault">*</param>\n',e+='\t\t\t<param name="orderbykw"/>\n',e+='\t\t\t<param name="orderby"/>\n',e+='\t\t\t<param name="limitkw"/>\n',e+='\t\t\t<param name="limit"/>\n',e+='\t\t\t<param name="rootids">%2</param>\n',e+='\t\t\t<param name="select">%3</param>\n',e+='\t\t\t<param name="type">%1</param>\n',n.hasPathAttrs()&&(e+='\t\t\t<param name="labelSR">paths</param>\n',e+='\t\t\t<param name="selectpath">%4</param>\n'),e+='\t\t\t<param name="notsubstitute">true</param>\n',e+='\t\t\t<param name="dump">|</param>\n',e+="\t\t</params>\n",e+="\t</execute>\n",e+="</executeSequence>\n"},o=r.rawmode?i():s();this.run=function(e,t,i,s,c){console.log("running Ox4xMQLSelectTask");var u=r.xmqlServiceUri(),l=n.typeRequested(),p=e.findNodeByPLMTypeExpressedAsPhyIdAsJSON(l);if(p.length>0){var d=o.replace("%s",t.SetName);d=(d=(d=d.replace("%1",l)).replace("%2",p)).replace("%3",n.marshallAsMQLListOfFetchAttributesAsJSON()),n.hasPathAttrs()&&(d=d.replace("%4",n.marshallAsMQLListOfPathAttributesAsJSON())),t.executePostHttpRequest(u,r.rawmode,d,function(t){new a(n,e,t,function(){s(this)})})}else s(this)}}}),define("VisuDataAccess/Ox4SelectTask",["DS/VisuDataAccess/Ox4SelectTask","DS/DSMigration/DSMigration"],function(e,t){return t.deprecateModule("VisuDataAccess/Ox4SelectTask"),e}),define("DS/VisuDataAccess/Ox4XHRWithProxyAbstraction",["UWA/Class","UWA/Data","UWA/Utils","UWA/Utils/Client","UWA/Ajax","UWA/Json","DS/WAFData/WAFData"],function(e,t,n,r,a,i,s){"use strict";var o=function(){this.executeGetHttpRequest=function(t,n,r,a){if(2===o.proxyUsage){var i=new Object;i.headers=new Object,i.data=new Object,i.data.GET=r,i.method="GET",i.async=!0,i.proxy=o.proxymode,i.authentication=o.authentication,i.onComplete=a,i.type=n;s.handleRequest(t,i)}else{1===o.proxyUsage&&(t=e(t,o.server,o.sport));var c=new XMLHttpRequest;c.open("GET",t,!0),c.onload=function(e){a(this.response)},c.setRequestHeader("X-Requested-With","XMLHttpRequest"),"arraybuffer"===n&&(c.responseType=n),c.send(r)}},this.executePostHttpRequest=function(t,n,r,a){if(2==o.proxyUsage){var i={timeout:3e5,method:"POST",data:r,type:"text",proxy:o.proxymode,authentication:o.authentication,headers:{"Content-type":n,Accept:"text/plain"},onComplete:a,onFailure:function(e){UWA.log("arguments onFailure"),UWA.log(arguments)}};o.securityToken&&(i.headers.SecurityToken=o.securityToken);s.handleRequest(t,i)}else{1==o.proxyUsage&&(t=e(t,o.server,o.sport));var c=new XMLHttpRequest;c.open("POST",t),c.onload=function(e){a(this.response)},c.setRequestHeader("Content-type",n),c.setRequestHeader("Accept","text/plain"),c.send(r)}},this.executePostHttpRequestWithOptions=function(t,n){if(2==o.proxyUsage){n.timeout=3e5,n.method="POST",n.type=n.type?n.type:"text",n.proxy=o.proxymode,n.authentication=o.authentication,n.onFailure=n.onFailure?n.onFailure:function(e){UWA.log("arguments onFailure"),UWA.log(arguments)},!n.headers||n.headers,!n.headers.Accept||n.headers.Accept;s.handleRequest(t,n)}else{1==o.proxyUsage&&(t=e(t,o.server,o.sport));var r=new XMLHttpRequest;r.open("POST",t),r.onload=function(e){callback(this.response)},r.setRequestHeader("Content-type",n.headers.Content-type),r.setRequestHeader("Accept",n.headers.Accept?n.headers.Accept:"text/plain"),r.send(postParams)}},this.executePostHttpRequest2=function(t,n,r,a,i){if(2==o.proxyUsage){var c={timeout:3e5,method:"POST",data:r,type:"text",proxy:o.proxymode,authentication:o.authentication,headers:{"Content-type":n,Accept:"text/plain"},onComplete:a,onFailure:function(e){UWA.log("arguments onFailure"),UWA.log(arguments)}};null!=i.responseType&&(c.type=i.responseType);s.handleRequest(t,c)}else{1==o.proxyUsage&&(t=e(t,o.server,o.sport));var u=new XMLHttpRequest;u.open("POST",t),u.onload=function(e){a(this.response)},u.setRequestHeader("Content-type",n),u.setRequestHeader("Accept","application/octet-stream"),null!=i.responseType&&(u.responseType=i.responseType),u.send(r)}},this.executeSyncPostHttpRequest=function(t,n,r){if(2==o.proxyUsage){var a,i={timeout:3e5,method:"POST",data:r,type:"text",proxy:o.proxymode,authentication:o.authentication,async:!1,headers:{"Content-type":n,Accept:"text/plain"},onComplete:function(e){console.warn("retour >data",e),a=e},onFailure:function(e){console.log("arguments onFailure"),console.log(arguments)}};o.securityToken&&(i.headers.SecurityToken=o.securityToken);s.handleRequest(t,i);return a}1==o.proxyUsage&&(t=e(t,o.server,o.sport));var c=new XMLHttpRequest;return c.open("POST",t,!1),c.setRequestHeader("Content-type",n),c.setRequestHeader("Accept","text/plain"),c.send(r),c.responseText},this.transformUrlIntoRealUrl=function(t){if(2==o.proxyUsage){console.log("WAFData No Proxyfication");new Object;return t}return 1==o.proxyUsage?t=e(t,o.server,o.sport):t},this.asyncTransformFCSUrlIntoRealUrl=function(e,t,n){var r=e.url,a=e.data,i="application/xml";"boolean"==typeof t&&t&&(i="application/xmql"),this.executePostHttpRequest(r,i,a,function(t){var r=/\{\{([^\}]*)\}\{([^\}]*)\}\}/.exec(t),a=r[1],i="posthttp:"+r[2]+":postparams:__fcs__jobTicket="+encodeURIComponent(a);n(e,i)})};var e=function(e,t,n){var r=e.indexOf("/"),a=e.indexOf("/",r+2);return e.slice(0,r)+"//"+t+":"+n+e.slice(a,e.length)}};return o.useNoProxy=function(){o.proxyUsage=0,o.server=null,o.sport=null},o.useProxyDefinedBy=function(e,t){o.proxyUsage=1,o.server=e,o.sport=t},o.useUWAProxy=function(e){o.proxyUsage=2,o.server=null,o.sport=null,o.proxymode=e.proxymode,o.authentication=e.proxymode,e.contextid&&e.login&&(o.securityToken=e.login+"|"+e.contextid)},o}),define("VisuDataAccess/Ox4XHRWithProxyAbstraction",["DS/VisuDataAccess/Ox4XHRWithProxyAbstraction","DS/DSMigration/DSMigration"],function(e,t){return t.deprecateModule("VisuDataAccess/Ox4XHRWithProxyAbstraction"),e}),define("DS/VisuDataAccess/Ox4DataAccessObjectFactory",[],function(){"use strict";var e=function(){};return e.createServerDefinition2=function(e,t,n,r){var a=new Object;return void 0===e?(console.log("No Hostname in CreateServerDefinition"),null):(a.hostname=e,void 0===t?(console.log("No RootUri in CreateServerDefinition"),null):(a.rooturi=t,a.isSecure=!1,void 0!==n&&n&&(a.isSecure=!0),a.port=-1,void 0!==r&&(a.port=r),a.xmqlServiceUri=function(e){var t="http://";this.isSecure&&(t="https://");var n=t+this.hostname;return-1!=this.port&&(n+=":"+this.port),n+="/"+this.rooturi+"/i3dx/services/xmql","boolean"==typeof e&&e&&(n+="?raw=true"),n},a))},e.createServerDefinition=function(e,t,n){var r=new Object;return r.hostname=e,r.port=t,r.rooturi=n,r.xmqlServiceUri=function(){return"http://"+this.hostname+":"+this.port+"/"+this.rooturi+"/i3dx/services/xmql?raw=true"},r},e.createDisplayObjectSpecification=function(e,t){var n=new Object;return n.physicalid=e,n.serverdefinition=t,n},e}),define("VisuDataAccess/Ox4DataAccessObjectFactory",["DS/VisuDataAccess/Ox4DataAccessObjectFactory","DS/DSMigration/DSMigration"],function(e,t){return t.deprecateModule("VisuDataAccess/Ox4DataAccessObjectFactory"),e}),define("DS/VisuDataAccess/Ox4SetTask",[],function(){"use strict";return function(e,t){var n=e,r=t,a=function(){var e="start transaction ;\n";return e+=n?"label deleteset delete set %1":"label addset add set %1 type temporary hidden;",e+="commit transaction;"},i=function(){var e='<?xml version="1.0" encoding="utf-8"?>\n';return e+='<executeSequence xmlns="http://www.3ds.com/xmql/query">\n',e+="\t<execute>\n",e+=n?"\t\t<function>delete_set</function>\n":"\t\t<function>add_set</function>\n",e+="\t\t<version>2.0.0</version>\n",e+="\t\t<params>\n",e+=n?'\t\t\t<param name="label">deleteset</param>\n':'\t\t\t<param name="label">addset</param>\n',e+='\t\t\t<param name="setname">%1</param>\n',e+="\t\t</params>\n",e+="\t</execute>\n",e+="</executeSequence>\n"},s=r.rawmode?a():i();this.run=function(e,t,a,i,o){console.log("running Ox4MQLSetTask");var c=r.xmqlServiceUri(),u=s.replace("%1",t.SetName);t.executePostHttpRequest(c,r.rawmode,u,function(e){console.log((n?"Delete":"Add")+" Set: OK!"),i(this)})}}}),define("DS/VisuDataAccess/Ox4StreamLoader",["DS/VisuDataAccess/Ox4PLMDataHelper","DS/VisuDataAccess/Ox4TicketGeneratorTask","DS/VisuDataAccess/Ox4XHRWithProxyAbstraction","DS/WAFData/WAFData"],function(e,t,n,r){"use strict";var a=null,i=null,s=function(e,t,n){var r='<?xml version="1.0" encoding="utf-8"?>\n';return r+='<executeSequence xmlns="http://www.3ds.com/xmql/query">\n',r+="\t<execute>\n",r+="\t\t<function>query_bus</function>\n",r+="\t\t<version>2.0.0</version>\n",r+="\t\t<params>\n",r+='\t\t\t<param name="type">'+t+"</param>\n",r+='\t\t\t<param name="name">*</param>\n',r+='\t\t\t<param name="revision">*</param>\n',r+='\t\t\t<param name="vault">*</param>\n',r+='\t\t\t<param name="where">physicalid=='+e+"</param>\n",r+='\t\t\t<param name="select">'+JSON.stringify(n)+"</param>\n",r+='\t\t\t<param name="dump">,</param>\n',r+="\t\t</params>\n",r+="\t</execute>\n",r+="</executeSequence>\n"},o=function(e,t,r){var a,o,c,u,l,p,d,f=null;e.IRPC?(a=e.physicalid,o=e.boType,c=e.format,u=e.role,l=e.lateType,p=e.persistancyType,d=e.persistancyName,f={mqlCmd:s(a,o,["attribute[StreamDescriptors]","format.file.name","format.file.store"]),parseTCLRow:function(e){for(var t=/{{.*} {.*} {.*} {{(.*)}} {({.*})} {({.*})}}/.exec(e),n=t[1],r=t[2],i=t[3],s=n.split(":"),o=[],f=0;f<s.length;f++){var m=/SDv2\((.*),'(.*)',(.*),.*,.*,'(.*)','(.*)'\)/.exec(s[f]);o.push({format:m[1],role:m[2],lateType:m[3],persistancyType:m[4],persistancyName:m[5]})}for(var h=/{([^{}]*)}/g,y=null,x=[];null!==(y=h.exec(r));)x.push(y[1]);for(var v=[];null!==(y=h.exec(i));)v.push(y[1]);var D={name:"",store:""};for(f=0;f<o.length;f++){var S=o[f];void 0!==c&&c!==S.format||void 0!==u&&u!==S.role||void 0!==l&&l!==S.lateType||void 0!==p&&p!==S.persistancyType||void 0!==d&&d!==S.persistancyName||(""===D.name?(D.name=a+"_'"+S.role+"'."+S.format,S.persistancyName&&(D.name+="="+S.persistancyName),D.format=S.format):(D.tooManyFilesError=!0,D.name=""))}if(""!==D.name)for(f=0;""===D.store&&f<x.length;f++)D.name===x[f]&&(D.store=v[f]);return""!==D.name&&""!==D.store||(D.noStreamRetrieved=!0,D.name="",D.store=""),D}}):f=function(e,t,n){return{mqlCmd:s(e,t,["format["+n+"].file.name","format["+n+"].file.store"]),parseTCLRow:function(e){var t=/{{.*} {.*} {.*} {{([^{}]*)}} {{([^{}]*)}}}/.exec(e);return null===t?{tooManyFilesError:!0}:{name:t[1],store:t[2]}}}}(e.physicalid,e.boType,e.format);(new n).executePostHttpRequest(i.xmqlServiceUri(),"application/xml",f.mqlCmd,function(n){var a=f.parseTCLRow(n);a.tooManyFilesError?r("Too many streams retrieved"):a.noStreamRetrieved?r("No stream retrieved"):(a.physicalid=e.physicalid,void 0===a.format&&void 0!==e.format&&(a.format=e.format),void 0!==a.format?t(a):r("Stream format has to be specified"))})};return{Load:function(s){var c,u;null!==a&&null!==i&&i.url===s.serverUrl||(i={rawmode:!1,url:s.serverUrl},u=(c=i).url,c.xmqlServiceUri=function(){return u+"/i3dx/services/xmql"},c.threedexpServiceUri=function(){return u},n.useUWAProxy({proxymode:"passport"}),a=new e(i)),o(s,function(e){!function(e,r,s){var o=a.transformSelectedFileIntoTicketRequest(e.physicalid,e.format,e.store,e.name),c=new t(o,i);(new n).asyncTransformFCSUrlIntoRealUrl(c.generateRequest(),!1,function(e,t){r(t)})}(e,function(e){!function(e,t,n,a){if("posthttp"==e.slice(0,8)){var i=e.indexOf(":postparams:"),s=e.slice(9,i),o={cors:!0,timeout:1e5,method:"POST",data:e.slice(i+12,e.length),responseType:t,async:!0,headers:{Accept:"text/plain"},onComplete:n,onFailure:a};r.authenticatedRequest(s,o)}}(e,s.streamType,s.onStreamLoaded,s.onError)},s.onError)},s.onError)}}}),define("DS/VisuDataAccess/Ox4TypeHelper",["DS/Visualization/Utils","DS/VisuDataAccess/Ox4XHRWithProxyAbstraction"],function(e,t){"use strict";var n=function(e){var t='<?xml version="1.0" encoding="utf-8"?>\n';return t+='<executeSequence xmlns="http://www.3ds.com/xmql/query">\n',t+="\t<execute>\n",t+=e?"\t\t<function>get_parents_rel_type</function>\n":"\t\t<function>get_parents_bus_type</function>\n",t+="\t\t<version>1.0.0</version>\n",t+="\t\t<params>\n",t+='\t\t\t<param name="type">%1</param>\n',t+="\t\t</params>\n",t+="\t</execute>\n",t+="</executeSequence>\n"},r=null,a=n(!1),i=n(!0),s=function(e,n,s){var o=new t,c=n?i:a;if(c=c.replace("%1",e),null===s){var u=[];try{u=JSON.parse(o.executeSyncPostHttpRequest(r,"application/xml",c)),Array.isArray(u)||(u=[])}catch(e){u=[]}return u}var l={data:c,type:"json",headers:{"Content-type":"application/xml",Accept:"application/json"},onComplete:function(e){var t=[];try{t=JSON.parse(e.xmql_response.body.result[2].output),Array.isArray(t)||(t=[])}catch(e){t=[]}s(t)}};o.executePostHttpRequestWithOptions(r,l)},o=function(e,t,n){var r=n;if(void 0===r&&(r=null),"string"!=typeof e){if(null===r)return[];r([])}else if(u[t].hasOwnProperty(e)){if(null===r)return u[t][e];r(u[t][e])}else{if(null===r){var a=s(e,"rel"===t,null);for(u[t][e]=a;a.length>0;)a=a.slice(0),u[t][a.shift()]=a;return console.warn("[Ox4TypeHelper]: Synchronous server call is deprecated, switch to asynchronous version"),u[t][e]}s(e,"rel"===t,function(n){for(u[t][e]=n;n.length>0;)n=n.slice(0),u[t][n.shift()]=n;r(u[t][e])})}},c=function(e,t){return u[e].hasOwnProperty(t)},u={bus:{},rel:{}};return{IsInit:function(){return null!=r},Init:function(n,a,i){var s={requiredAuth:a,proxyurl:i};void 0===s.requiredAuth&&(s.requiredAuth=null),void 0===s.proxyurl&&(s.proxyurl=null),e.setProxyFromSpec(s,t),r=function(e){if(void 0===e.hostname)return console.log("Ox4TypeHelper:No Hostname in ServerDefinition"),null;var t=e.hostname;if(void 0===e.rooturi)return console.log("Ox4TypeHelper:No RootUri in ServerDefinition"),null;var n=e.rooturi,r="http://";void 0!==e.protocol&&"https"===e.protocol&&(r="https://");var a=-1;void 0!==e.port&&(a=e.port);var i=r+t;return-1!=a&&(i+=":"+a),i+="/"+n+"/i3dx/services/xmql"}(n)},InitWithUrl:function(n,a,i,s){var o={requiredAuth:i,proxyurl:s};void 0===o.requiredAuth&&(o.requiredAuth=null),void 0===o.proxyurl&&(o.proxyurl=null),e.setProxyFromSpec(o,t),r=n+"/i3dx/services/xmql","string"==typeof a&&(r+="?tenant="+a)},RegisterParentsTypes:function(e,t){var n=function(e,t,r){for(var a=e.pop();a&&c(t,a);)a=e.pop();a?o(a,t,function(){n(e,t,r)}):r()},r=0,a=function(){2==++r&&t()};n(e.bus,"bus",a),n(e.rel,"rel",a)},GetParentsBusType:function(e,t){return o(e,"bus",t)},GetParentsRelType:function(e,t){return o(e,"rel",t)},IsBusA:function(e,t,n){var r=n;if(void 0===r&&(r=null),"string"!=typeof e||"string"!=typeof t){if(null===r)return!1;r(!1)}else if(e===t){if(null===r)return!0;r(!0)}else{if(null===r)return this.GetParentsBusType(e).indexOf(t)>=0;this.GetParentsBusType(e,function(e){r(e.indexOf(t)>=0)})}},IsRelA:function(e,t,n){var r=n;if(void 0===r&&(r=null),"string"!=typeof e||"string"!=typeof t){if(null===r)return!1;r(!1)}else if(e===t){if(null===r)return!0;r(!0)}else{if(null===r)return this.GetParentsRelType(e).indexOf(t)>=0;this.GetParentsRelType(e,function(e){r(e.indexOf(t)>=0)})}}}}),define("VisuDataAccess/Ox4TypeHelper",["DS/VisuDataAccess/Ox4TypeHelper","DS/DSMigration/DSMigration"],function(e,t){return t.deprecateModule("VisuDataAccess/Ox4TypeHelper"),e}),define("DS/VisuDataAccess/Ox4DECPlanRunner",["DS/VisuDataAccess/Ox4XHRWithProxyAbstraction"],function(e){"use strict";return function(t,n,r,a,i){var s=n,o=t,c=new function(){this.executePostHttpRequest=function(t,n,r,a){var i="application/xml";"boolean"==typeof n&&n&&(i="application/xmql"),(new e).executePostHttpRequest(t,i,r,a)},this.executeSyncPostHttpRequest=function(t,n,r){var a="application/xml";return"boolean"==typeof n&&n&&(a="application/xmql"),(new e).executeSyncPostHttpRequest(t,a,r)}},u=a,l=i,p=function(e){console.log("onNextTask");var n=t.next();null==n?d():n[0].run(s,c,r,p,i)},d=function(){console.log("----------------Finished--------\x3e");var e=t.endingTask()(s);e.geometryNodes.length>0?u(e):l({type:"NO_GEOMETRY",msg:"No 3D geometry on this product"})};this.executePlan=function(){console.log("Beginning Ox4PlanRunner runPlan"),o.next()[0].run(s,c,null,p,null),console.log("Ending Ox4PlanRunner runPlan")}}}),define("VisuDataAccess/Ox4DECPlanRunner",["DS/VisuDataAccess/Ox4DECPlanRunner","DS/DSMigration/DSMigration"],function(e,t){return t.deprecateModule("VisuDataAccess/Ox4DECPlanRunner"),e}),define("DS/VisuDataAccess/Ox4PlanRunner",["DS/VisuDataAccess/Ox4XHRWithProxyAbstraction"],function(e){"use strict";return function(t,n,r,a,i,s){var o=n,c=t,u=new function(){this.SetName=r,this.executePostHttpRequest=function(t,n,r,a){var i="application/xml";"boolean"==typeof n&&n&&(i="application/xmql"),(new e).executePostHttpRequest(t,i,r,a)}}(r),l=i,p=s,d=function(e){if(null!==a){var n=t.currentTaskIndex()/t.tasksCount()*100;a(n)}console.log("onNextTask");var r=t.next();null==r?f():r[0].run(o,u,a,d,s)},f=function(){console.log("----------------Finished--------\x3e");var e=t.endingTask()(o);e.geometryNodes.length>0?l(e):p({type:"NO_GEOMETRY",msg:"No 3D geometry on this product"})};this.executePlan=function(){console.log("Beginning Ox4PlanRunner runPlan"),c.next()[0].run(o,u,null,d,null),console.log("Ending Ox4PlanRunner runPlan")}}}),define("VisuDataAccess/Ox4PlanRunner",["DS/VisuDataAccess/Ox4PlanRunner","DS/DSMigration/DSMigration"],function(e,t){return t.deprecateModule("VisuDataAccess/Ox4PlanRunner"),e}),define("DS/VisuDataAccess/Ox4DECRunner",["DS/VisuDataAccess/Ox4TreeTarget","DS/VisuDataAccess/Ox4DECPlanRunner","DS/VisuDataAccess/Ox4TaskPlanner","DS/VisuDataAccess/Ox4ExpandTask","DS/VisuDataAccess/Ox4xMQLSelectTaskDefinition","DS/VisuDataAccess/Ox4DECSelectTask","DS/VisuDataAccess/Ox4PLMDataHelper","DS/VisuDataAccess/Ox4TicketGeneratorTask","DS/VisuDataAccess/Ox4TypeHelper"],function(e,t,n,r,a,i,s,o,c){"use strict";return function(u,l){var p,d,f=(p=u,d=new Object,void 0===p.serverdefinition.hostname?(console.log("checkAndEnrichSpecification:No Hostname in CreateServerDefinition"),null):(d.hostname=p.serverdefinition.hostname,void 0===p.serverdefinition.rooturi?(console.log("checkAndEnrichSpecification:No RootUri in CreateServerDefinition"),null):(d.rooturi=p.serverdefinition.rooturi,d.isSecure=!1,void 0!==p.serverdefinition.protocol&&"https"===p.serverdefinition.protocol&&(d.isSecure=!0),d.port=-1,void 0!==p.serverdefinition.port&&(d.port=p.serverdefinition.port),d.rawmode=p.rawmode,d.xmqlServiceUri=function(){var e="http://";this.isSecure&&(e="https://");var t=e+this.hostname;return-1!=this.port&&(t+=":"+this.port),t+="/"+this.rooturi+"/i3dx/services/xmql","boolean"==typeof d.rawmode&&d.rawmode&&(t+="?raw=true"),t},d.threedexpServiceUri=function(){var e="http://";this.isSecure&&(e="https://");var t=e+this.hostname;return-1!=this.port&&(t+=":"+this.port),t+="/"+this.rooturi},p.serverdefinition=d,p.typeHelper=c,p.shapeType="CgrViewable",p.instanceType=p.dtype,p))),m=new e(f,l),h=null,y=null,x=null;this.run=function(e,n,r){console.log("---\x3e Entering Ox4DECRunner"),h=e,y=n,x=r,console.log("---\x3e Building a plan for");var a=f.expand,i=new Array;if("true"===a){var s=(new v).buildPlan(f,i);new t(s,m,h,y,x).executePlan()}else i[0]=f.physicalid;0==i.length&&(i[0]=f.physicalid);for(var o=0;o<i.length;o++){f.physicalid=i[o];var c=(new D).buildPlan(f);console.log("---\x3e Plan Constructed "),new t(c,m,h,y,x).executePlan()}};var v=function(){this.buildPlan=function(e,t){var r=new n,s=e.physicalid,o=e.dtype,c=0,u=new Array;u.push("physicalid");var l=new a(e.instanceType,u,function(e,n){for(var r=0;r<e.length;r++)t[c]=e[4];c++},3),p=new i(l,e.serverdefinition,s);return r.addSequentialTask(p),r.addEndingTask(function(e){return{rootNode:e.rootNode(),geometryNodes:e.findNodeByType(o)}}),r}},D=function(){this.buildPlan=function(e){console.log("---\x3eOx4DOSPlanifier:Beginning BuildPlan"),console.log(e),console.log("specification.physicalid"+e.physicalid),console.log("dtype:  "+e.dtype);var t=new n,c=e.physicalid,u=(e.dtype,new r(e.physicalid,e.serverdefinition,"Viewable"));t.addSequentialTask(u);var l={Fetch:new Array};l.Fetch.push("physicalid"),l.Fetch.push("attribute[LPAbstractInstance.V_matrix_1]"),l.Fetch.push("attribute[LPAbstractInstance.V_matrix_2]"),l.Fetch.push("attribute[LPAbstractInstance.V_matrix_3]"),l.Fetch.push("attribute[LPAbstractInstance.V_matrix_4]"),l.Fetch.push("attribute[LPAbstractInstance.V_matrix_5]"),l.Fetch.push("attribute[LPAbstractInstance.V_matrix_6]"),l.Fetch.push("attribute[LPAbstractInstance.V_matrix_7]"),l.Fetch.push("attribute[LPAbstractInstance.V_matrix_8]"),l.Fetch.push("attribute[LPAbstractInstance.V_matrix_9]"),l.Fetch.push("attribute[LPAbstractInstance.V_matrix_10]"),l.Fetch.push("attribute[LPAbstractInstance.V_matrix_11]"),l.Fetch.push("attribute[LPAbstractInstance.V_matrix_12]");var p=new a(e.instanceType,l,function(e,t){var n=t.findNodeByPhysicalId(e[1]),r=n.getMatrix();r.set(parseFloat(e[2]),parseFloat(e[5]),parseFloat(e[8]),1e3*parseFloat(e[11]),parseFloat(e[3]),parseFloat(e[6]),parseFloat(e[9]),1e3*parseFloat(e[12]),parseFloat(e[4]),parseFloat(e[7]),parseFloat(e[10]),1e3*parseFloat(e[13]),0,0,0,1),n.setMatrix(r)},0),d=new i(p,e.serverdefinition,c);t.addSequentialTask(d);var f={Fetch:new Array};f.Fetch.push("physicalid"),f.Fetch.push("attribute[StreamDescriptors]"),f.Fetch.push("format.file.store"),f.Fetch.push("format[CGR].file");var m=new s(e.serverdefinition),h=new a(e.shapeType,f,function(t,n){var r=n.findNodeByPhysicalId(t[3]),a=t[6].split(":"),i="";(i=1==a.length?a[0]:a[1]).search(" ")>=0&&(i='"'+i+'"');var s=m.transformSelectedFileIntoTicketRequest(t[3],"CGR",t[5],i);r.ticketRequest=new o(s,e.serverdefinition)},1),y=new i(h,e.serverdefinition,c);return t.addSequentialTask(y),t.addEndingTask(function(t){return{rootNode:t.rootNode(),geometryNodes:t.findNodeByType(e.shapeType)}}),console.log("---\x3eOx4DOSPlanifier:Beginning BuildPlan Done"),t}}}}),define("VisuDataAccess/Ox4DECRunner",["DS/VisuDataAccess/Ox4DECRunner","DS/DSMigration/DSMigration"],function(e,t){return t.deprecateModule("VisuDataAccess/Ox4DECRunner"),e}),define("DS/VisuDataAccess/Ox4StreamUnStreamerTask",["DS/VisuDataAccess/Ox4XHRWithProxyAbstraction"],function(e){"use strict";return function(t,n){var r=t,a=n;this.run=function(t,n,i,s,o){for(var c=new e,u=t.findNodeByType(r.typeRequested()),l=0,p=0;p<u.length;p++)!function(e){var n=new Array;if(null!=e.ticketRequest)n.push(e.ticketRequest),delete e.ticketRequest;else if(null!=e.ticketRequests)for(var i=e.ticketRequests,o=0;o<i.length;o++)n.push(i[o]);r.streamsNumber(n.length),l+=n.length;for(var u=0;u<n.length;u++)if(window.hasOwnProperty("ODTNoFCSCalls")&&window.ODTNoFCSCalls)l--,r.streamReceived(e,null,t);else{var p=n[u].generateRequest();c.asyncTransformFCSUrlIntoRealUrl(p,a.rawmode,function(n,a){if("posthttp"==a.slice(0,8)){var i=a.indexOf(":postparams:"),o=a.slice(9,i),u=a.slice(i+12,a.length),p=new Object;null!=r.responseType&&(console.log("registering otherParams reponsetype "+r.responseType),p.responseType=r.responseType),c.executePostHttpRequest2(o,"application/x-www-form-urlencoded",u,function(n){r.streamReceived(e,n,t),0==--l&&s(this)},p)}})}}(u[p]);0==l&&s(this)}}}),define("DS/VisuDataAccess/Ox4DOSRunner",["DS/VisuDataAccess/Ox4TreeTarget","DS/VisuDataAccess/Ox4PlanRunner","DS/VisuDataAccess/Ox4TaskPlanner","DS/VisuDataAccess/Ox4SetTask","DS/VisuDataAccess/Ox4ExpandTask","DS/VisuDataAccess/Ox4xMQLSelectTaskDefinition","DS/VisuDataAccess/Ox4SelectTask","DS/VisuDataAccess/Ox4PLMDataHelper","DS/VisuDataAccess/Ox4TicketGeneratorTask","DS/VisuDataAccess/Ox4FeatureModeler","DS/VisuDataAccess/Ox4StreamUnStreamerTaskDefinition","DS/VisuDataAccess/Ox4StreamUnStreamerTask","DS/VisuDataAccess/Ox4TypeHelper","DS/Visualization/PathElement"],function(e,t,n,r,a,i,s,o,c,u,l,p,d,f){"use strict";return function(m,h){d.IsInit()||d.Init(m.serverdefinition,m.requiredAuth,m.proxyurl);var y,x,v=(y=m,x=new Object,void 0===y.serverdefinition.hostname?(console.log("checkAndEnrichSpecification:No Hostname in CreateServerDefinition"),null):(x.hostname=y.serverdefinition.hostname,void 0===y.serverdefinition.rooturi?(console.log("checkAndEnrichSpecification:No RootUri in CreateServerDefinition"),null):(x.rooturi=y.serverdefinition.rooturi,x.isSecure=!1,void 0!==y.serverdefinition.protocol&&"https"===y.serverdefinition.protocol&&(x.isSecure=!0),x.port=-1,void 0!==y.serverdefinition.port&&(x.port=y.serverdefinition.port),x.rawmode=y.rawmode,x.xmqlServiceUri=function(){var e="http://";this.isSecure&&(e="https://");var t=e+this.hostname;return-1!=this.port&&(t+=":"+this.port),t+="/"+this.rooturi+"/i3dx/services/xmql","string"==typeof y.tenant&&(t+="?tenant="+y.tenant),"boolean"==typeof x.rawmode&&x.rawmode&&(t+="?raw=true"),t},x.threedexpServiceUri=function(){var e="http://";this.isSecure&&(e="https://");var t=e+this.hostname;return-1!=this.port&&(t+=":"+this.port),t+="/"+this.rooturi},y.serverdefinition=x,y.typeHelper=d,y.referenceType="VPMReference",y.shapeType="VPMRepReference",y.instanceType="VPMInstance",y))),D=new e(v,h),S=null,g=null,A=null;this.run=function(e,n,r){console.log("---\x3e Entering Ox4DOSRunner"),S=e,g=n,A=r,console.log("---\x3e Init Feature Modeler session"),u.init(),console.log("---\x3e Building a plan for"),(new O).buildPlan(v,function(e){console.log("---\x3e Plan Constructed"),D.FindRootNodeWorkType(),new t(e,D,v.physicalid+"_set",S,g,A).executePlan()})};var O=function(){this.buildPlan=function(e,t){console.log("---\x3eOx4DOSPlanifier:Beginning BuildPlan"),console.log(e),console.log(e.physicalid),null!=e.dtype&&d.IsBusA(e.dtype,e.shapeType,function(d){var m=new n,h=new r(!1,e.serverdefinition);if(m.addSequentialTask(h),!d){var y=new a(e.physicalid,e.serverdefinition,"PLMInstance");m.addSequentialTask(y);var x={Fetch:new Array};x.Fetch.push("physicalid"),x.Fetch.push("attribute[LPAbstractInstance.V_matrix_1]"),x.Fetch.push("attribute[LPAbstractInstance.V_matrix_2]"),x.Fetch.push("attribute[LPAbstractInstance.V_matrix_3]"),x.Fetch.push("attribute[LPAbstractInstance.V_matrix_4]"),x.Fetch.push("attribute[LPAbstractInstance.V_matrix_5]"),x.Fetch.push("attribute[LPAbstractInstance.V_matrix_6]"),x.Fetch.push("attribute[LPAbstractInstance.V_matrix_7]"),x.Fetch.push("attribute[LPAbstractInstance.V_matrix_8]"),x.Fetch.push("attribute[LPAbstractInstance.V_matrix_9]"),x.Fetch.push("attribute[LPAbstractInstance.V_matrix_10]"),x.Fetch.push("attribute[LPAbstractInstance.V_matrix_11]"),x.Fetch.push("attribute[LPAbstractInstance.V_matrix_12]");var v=new i(e.instanceType,x,function(e,t,n){var r=n.findNodeByPhysicalId(t[1]),a=r.getMatrix();a.set(parseFloat(t[2]),parseFloat(t[5]),parseFloat(t[8]),1e3*parseFloat(t[11]),parseFloat(t[3]),parseFloat(t[6]),parseFloat(t[9]),1e3*parseFloat(t[12]),parseFloat(t[4]),parseFloat(t[7]),parseFloat(t[10]),1e3*parseFloat(t[13]),0,0,0,1),r.setMatrix(a)},0),D=new s(v,e.serverdefinition);m.addSequentialTask(D)}var S={Fetch:new Array};S.Fetch.push("physicalid"),S.Fetch.push("attribute[StreamDescriptors]"),S.Fetch.push("format.file.store");var g=new o(e.serverdefinition),A=new i(e.shapeType,S,function(t,n,r){var a=r.findNodeByPhysicalId(n[3]),i=g.transformSelectedSDByRoleAndFormatIntoTicketRequest(n[3],n[4],"cgr","''",["2","1"],n[5]);null!==i&&(a.ticketRequest=new c(i,e.serverdefinition))},1),O=new s(A,e.serverdefinition);if(m.addSequentialTask(O),e.kinematics=!0,e.kinematics){var b=function(e,t){var n=u.listRootFeatures(e.id);e.AnimFeatures=n;var r=t.rootNode();r.hasOwnProperty("AnimFeaturesList")||(r.AnimFeaturesList=[]),Array.prototype.push.apply(r.AnimFeaturesList,e.AnimFeatures)},w={Fetch:new Array,Path:new Array};w.Fetch.push("physicalid"),w.Fetch.push("attribute[StreamDescriptors]"),w.Fetch.push("format.file.store"),w.Path.push("owner.physicalid"),w.Path.push("element.order"),w.Path.push("element"),w.Path.push("attribute[IDRel]"),A=new i("CATANIMDISCIPLINE",w,function(t,n,r){if("fetch"===t){var a=r.findNodeByPhysicalId(n[3]);if(u.containFeatures(a.id))b(a,r);else{var i=g.transformSelectedSDByRoleAndFormatIntoTicketRequest(n[3],n[4],"CATNonCATIADocument","'WebFormat'",["1","7"],n[5]);null!==i&&(a.ticketRequest=new c(i,e.serverdefinition))}}else if("path"===t){var s=(n.length-3)/2;(a=r.findNodeByPhysicalId(n[1])).hasOwnProperty("SemanticRelations")||(a.SemanticRelations={});var o=new f;o.addElement(r.rootNode());var l,p=[];for(l=0;l<s;l++)p.push({order:n[2+l],instance:n[2+s+l].split(",")[2]});for(p.sort(function(e,t){return e.order-t.order}),l=0;l<p.length;l++){var d=r.findNodeByPhysicalId(p[l].instance);o.addElement(d),l<p.length-1&&1==d.children.length&&o.addElement(d.children[0])}a.SemanticRelations[n[2+2*s]]=o}},1),O=new s(A,e.serverdefinition),m.addSequentialTask(O);var T=new l("CATANIMDISCIPLINE",function(e,t,n){if(null!==t)u.loadRepresentation(e,e.id,t,function(){b(e,n)});else{var r=n.rootNode();r.hasOwnProperty("AnimFeaturesList")||(r.AnimFeaturesList=[]),r.AnimFeaturesList.push("feature")}},function(){});T.responseType="blob";var P=new p(T,e.serverdefinition);m.addSequentialTask(P)}var R=new r(!0,e.serverdefinition);m.addSequentialTask(R),m.addEndingTask(function(t){var n=t.rootNode(),r=t.findNodeByType(e.shapeType),a=[];for(var i in r)void 0!==r[i].ticketRequest&&a.push(r[i]);return{rootNode:n,geometryNodes:a}}),console.log("---\x3eOx4DOSPlanifier:Beginning BuildPlan Done"),t(m)})}}}}),define("VisuDataAccess/Ox4DOSRunner",["DS/VisuDataAccess/Ox4DOSRunner","DS/DSMigration/DSMigration"],function(e,t){return t.deprecateModule("VisuDataAccess/Ox4DOSRunner"),e}),define("DS/VisuDataAccess/Ox4MQLV6Loader",["DS/Visualization/ThreeJS_DS","WebappsUtils/WebappsUtils","UWA/Utils","DS/Visualization/Utils","DS/Visualization/Node3D","DS/Visualization/Mesh3D","DS/Visualization/MaterialManager","DS/VisuDataAccess/Ox4DOSRunner","DS/VisuDataAccess/Ox4DECRunner","DS/VisuDataAccess/Ox4XHRWithProxyAbstraction","DS/VisuDataAccess/Ox4TypeHelper","DS/WAFData/WAFData","DS/Visualization/LoaderUtils","DS/VisuDataAccess/Ox4TreeTarget"],function(e,t,n,r,a,i,s,o,c,u,l,p,d,f){"use strict";return function(i,s,m,h){var y,x=void 0!==s?s:null,v=null,D=null,S=null,g=null,A=!1,O=0,b=0,w=[],T=[],P={},R=null;function F(){null!=g&&(g.terminate(),g=null,A=!1),v=null,D=null,S=null,O=0,b=0,w=[],T=[],y=null,R=null,P={}}function q(e){T.length;var t=new u,n=0,r=function(){var a=T[n++];void 0!==a&&t.asyncTransformFCSUrlIntoRealUrl(a,!1,function(t,n){var a;e.value||""!==t&&(a=t,function(e,t,n,r){if("posthttp"==e.slice(0,8)){var a=e.indexOf(":postparams:"),i=e.slice(9,a),s={cors:!0,timeout:1e5,method:"POST",data:e.slice(a+12,e.length),type:"arraybuffer",async:!0,headers:{Accept:"text/plain"},onComplete:t,onFailure:n};p.authenticatedRequest(i,s)}}(n,function(t){e.value||(g.postMessage({inputFile:t,node:a,withSceneGraph:!!P.withSceneGraph&&P.withSceneGraph},[t]),r())}))})};window.hasOwnProperty("ODTNoFCSCalls")||null===S||S({loaded:0,total:T.length});for(var a=T.length>8?8:T.length,i=0;i<a;i++)r();v&&v(y),0===T.length&&D()}this.setGeometryMode=function(e){},this.load=function(i,s,u,p,m,h){P=h||{},R={value:!1},v=s,S=u,D=function(){F(),p&&p()},console.log("Ox4 Version V"),console.log("Ox4 ObjectDisplaySpecification"),console.log(i.physicalid),console.log(i.dtype);var V=function(t){if("Node"===t){var n=new a;return n.isPLMInstance=f.isPLMInstance,n.isPLMReference=f.isPLMReference,n.isPLMRepReference=f.isPLMRepReference,n}if("Matrix"===t)return new e.Matrix4};null==i.dtype&&(i.dtype="VPMReference");var k,I,M=i.dtype,N=null;l.InitWithUrl(i.serverurl,i.tenant,i.requiredAuth,i.proxyurl),k=M,I=function(e){if(e?N=new o(i,V):"SW Assembly Family"===(u=M)||"SW Component Family"===u||"SW Assembly Instance"===u||"SW Component Instance"===u||"CATPart"===u||"CATProduct"===u||l.IsBusA(u,"MCAD Model")&&(console.log("Ox4MQLV6Loader: Either customized or other than considered DEC Type provided : "+u),1)?N=new c(i,V):m({type:"LOAD",url:"type "+M}),null!=N){var a=m,s=R;N.run(null,function(e){if(!s.value){console.log("success........"),y=e.rootNode;var a=e.geometryNodes;b=a.length,O=b;for(var i=0;i<a.length;i++){var o=a[i].ticketRequest.generateRequest();w[o.data]=a[i],T.push(o)}window.hasOwnProperty("ODTNoFCSCalls")&&window.ODTNoFCSCalls?(v&&v(y),D&&D()):function(e){if(null===g){var a=n.matchUrl(t.getWebappsBaseUrl(),window.location)?null:"Passport",i={provider:"FILE",filename:"AmdLoader.js",serverurl:t.getWebappsBaseUrl()+"AmdLoader/",requiredAuth:a},s={provider:"FILE",filename:"ThreeJS_Base.js",serverurl:t.getWebappsBaseUrl()+"Mesh/",requiredAuth:a},o={provider:"FILE",filename:"Mesh.js",serverurl:t.getWebappsBaseUrl()+"Mesh/",requiredAuth:a},c={provider:"FILE",filename:"CGRFile.js",serverurl:t.getWebappsBaseUrl()+"Formats/",requiredAuth:a},u={provider:"FILE",filename:"CGRWorkerNewInfra.js",serverurl:t.getWebappsBaseUrl()+"Workers/",requiredAuth:a},l=[i,s,o,c,u];r.getWorkerFromSpecs(l,function(t){e.value?t.terminate():(g=t).onmessage=function(t){var n=t.data;if(n.loaded)A||(A=!0,q(e));else{var r=w[n.node.data];O--;var a=function(e){null!==S&&S({loaded:b-O,total:b}),null!==x&&x({hack:!0,updateInfinitePlane:!0}),O||null===D||D()};r?d.processData([r],n,void 0,P.withSceneGraph,P,a):a([])}}})}else A&&q(e)}(s),console.log("Ox4 Plan runned")}},a)}var u},l.IsBusA(k,"VPMReference",function(e){e?I(!0):l.IsBusA(k,"VPMRepReference",I)})},this.abort=function(){null!==R&&(R.value=!0,F())}}});