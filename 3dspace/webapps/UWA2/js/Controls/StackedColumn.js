define("UWA/Controls/StackedColumn",["UWA/Core","UWA/String","UWA/Element","UWA/Controls/Segmented","UWA/Controls/ToolTip"],function(t,o,e,s,i){"use strict";var n=s.extend({defaultOptions:{spacer:.5,showText:!0,hoverColors:null,minHeight:10,className:"uwa-stackedColumn"},init:function(t){this.total=0,this._parent(t),this.options.hoverColors&&this.baseEvents()},addItem:function(t,o){var s=this;this._parent(t,o),this.total+=o.value,this.updatePourcents(),this.elements.items[t].addEvent("click",function(){s.dispatchEvent("onClick",[t,o,this])}),e.addEvent.call(this.elements.items[t],"mouseenter",function(){s.dispatchEvent("onMouseOver",[t,o,this])}),e.addEvent.call(this.elements.items[t],"mouseleave",function(){s.dispatchEvent("onMouseOut",[t,o,this])}),this.options.toolTip&&this.options.toolTip.formatter&&new i(this.elements.items[t],this.options.toolTip.formatter(o.raw,o.raw.type),{width:this.options.toolTip.width||120,fx:!1})},updatePourcents:function(){var t,o=this.elements.items;for(t in o)o.hasOwnProperty(t)&&this.updateItem(t,o[t])},updateItem:function(t,e){var s,i=this.options.data[t],n=i.value/this.total*100;e.setStyle("background-color",i.background),e.hasClassName(this.options.className+"-item-last")||e.setStyle("margin-right",this.options.spacer+"%"),s=n-this.options.spacer,e.setStyle("width",s+"%"),e.empty(),this.options.showText?e.setHTML(o.format('<p>{0}<span class="pourcent">{1}%</span></p>',i.text,Math.round(n))):e.setStyle("height",this.options.minHeight+"px")},updateItemColor:function(t,o){this.options.data[t]&&(this.options.data[t].background=o,this.elements.items[t].setStyle("background-color",o))},toggleItemColor:function(t,o){this.elements.items[t].getStyle("background-color").toLowerCase()===this.options.data[t].background.toLowerCase()?this.elements.items[t].setStyle("background-color",o):this.elements.items[t].setStyle("background-color",this.options.data[t].background)},getItemInfo:function(t){return{config:this.options.data[t],dom:this.elements.items[t]}},baseEvents:function(){this.addEvents({onMouseOver:this.toggleBgColors,onMouseOut:this.toggleBgColors})},toggleBgColors:function(t){var o=this.options.data[t],e=this.findColor(o);e&&this.updateItemColor(t,e)},findColor:function(t){var o,e,s=this.options.hoverColors;for(o in s)if(s.hasOwnProperty(o)){if(o===t.background){e=s[o];break}if(s[o]===t.background){e=o;break}}return e}});return t.namespace("Controls/StackedColumn",n,t)});