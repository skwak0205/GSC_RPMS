define("UWA/Controls/FlashPlayer",["UWA/Core","UWA/Utils","UWA/String","UWA/Utils/Client","UWA/Event","UWA/Element","UWA/Controls/Abstract","UWA/Controls/Flash"],function(e,t,n,l,i,s,o,h){"use strict";var a=o.extend({className:"uwa-flashplayer",defaultOptions:{flashVars:"",flashUrl:"",width:"",height:"",wmode:"opaque",aspectRatio:1.3,showToolbar:!0,showFullScreenLink:!0},isFullScreen:!1,init:function(e){this._parent(e),this.buildSkeleton()},buildSkeleton:function(){var t=this.elements;t.container=e.createElement("div",{class:this.className,align:"center"}),t.container.hide()},buildLinks:function(t,l){var s=this.options,o=this.elements;o.links=e.createElement("p",{align:"center"}),s.showFullScreenLink&&(e.createElement("a",{href:"#flashPlayer-FullScreen",text:e.i18n("Full screen"),events:{click:function(e){i.stop(e),this.toogleFullScreenMode(!0)}.bind(this)}}).inject(o.links),o.links.appendText(" | ")),t&&l&&(e.createElement("a",{href:t,rel:"external",html:n.stripTags(l)}).inject(o.links),o.links.appendText(" | ")),e.createElement("a",{href:"#flashPlayer-Close",html:"<strong>"+e.i18n("Close Video")+"</strong>",events:{click:function(e){i.stop(e),this.hide()}.bind(this)}}).inject(o.links),o.links.inject(o.container)},toogleFullScreenMode:function(t){t=!!t;var n=l.getSize(),i=this.elements;t?(this.isFullScreen=!0,window.scrollTo(0,0),s.setStyle.apply(document.body,["overflow","hidden"]),i.fullScreenContainer=e.createElement("div",{align:"center",styles:{backgroundColor:"#000",position:"absolute",top:0,left:0,width:n.width+"px",height:n.height+"px"}}).inject(document.body),i.flashObject.inject(i.fullScreenContainer),this.buildCloseFullScreenButton()):(this.isFullScreen=!1,i.flashObject.inject(i.flashContainer,"top"),i.fullScreenCloseButton.remove(),i.fullScreenContainer.remove(),s.setStyle.apply(document.body,["overflow",""])),this.onResize()},buildCloseFullScreenButton:function(){var t=this.elements;t.fullScreenCloseButton=e.createElement("input",{type:"button",value:e.i18n("Close FullScreen"),styles:{position:"absolute",top:"2px",right:"2px"}}).inject(t.fullScreenContainer),l.Engine.ie&&l.Engine.version>6&&(t.fullScreenCloseButton.style.width=t.fullScreenCloseButton.value.length+"em"),t.fullScreenCloseButton.addEvent("click",function(e){i.stop(e),this.toogleFullScreenMode(!1)}.bind(this))},show:function(n,i,s){s&&this.setOptions(s),s=this.options;var o=this.elements;(n||i)&&(s.flashUrl=n,s.flashVars=i),/\.flv$/.test(s.flashUrl)&&(s.flashVars="flv="+encodeURIComponent(s.flashUrl)+"&showplayer=autohide&autoplay=1&showvolume=1&showtime=1",s.flashUrl=e.hosts.uwa+e.paths.img+"flash/player_flv.swf"),l.Engine.ie&&-1!==s.flashUrl.indexOf("?")&&(s.flashUrl+="&"+t.random(100)),o.container.empty(),o.flashControl=new h({_root:!1,url:s.flashUrl,width:s.width,height:s.height,flashVars:s.flashVars,wmode:s.wmode,styles:{width:s.width,height:s.height}}).inject(o.container),o.flashContainer=o.flashControl.elements.container,o.flashObject=o.flashControl.getFlashContainer(),s.showToolbar&&this.buildLinks(s.mediaLinkUrl,s.mediaLinkText),o.container.show(),this.onResize()},hide:function(){var e=this.elements;e.container&&(e.container.empty(),e.container.hide())},onResize:function(){var e,t,n,i=this.elements,s=this.options,o=l.getSize();this.isFullScreen&&i.fullScreenContainer.setStyles({height:o.height+"px",width:o.width-l.getScrollbarWidth()+"px","z-index":1}),i.flashObject&&(e=i.flashObject.getParent().getDimensions(),n=s.width?s.width:e.innerWidth,t=s.height?s.height:Math.min(o.height,n/s.aspectRatio),i.flashObject.setStyles({height:t+"px",width:n+"px"}),i.flashObject.setAttribute("height",t),i.flashObject.setAttribute("width",n))}});return e.namespace("Controls/FlashPlayer",a,e)});