define("UWA/Controls/Popup",["UWA/Core","UWA/Controls/Abstract"],function(e,t){"use strict";var n=t.extend({defaultOptions:{url:"about:blank",status:!1,toolbar:!1,location:!1,menubar:!1,resizable:!1,scrollbars:!1,fullscreen:!0,width:320,height:240,left:160,top:120},init:function(e){this._parent(e)},open:function(e){this.close(),this.elements.popup||this.buildSkeleton(e)},close:function(){this.elements.popup&&(this.elements.popup.close(),this.elements.popup=null,this.dispatchEvent("onClose"))},setPosition:function(e,t){this.elements.popup&&this.elements.popup.moveBy(parseInt(e,10),parseInt(t,10))},focus:function(){this.elements.popup&&this.elements.popup.focus()},buildSkeleton:function(e){var t,n=this,o=n.options,s=["dependent=yes"];["width","height","status","toolbar","location","menubar","personalbar","resizable","scrollbars","fullscreen"].forEach(function(e,t){t<2&&o[e]?s.push(e+"="+parseInt(o[e],0)):t>1&&s.push(e+"="+(o[e]?"yes":"no"))}),e=e||o.url,(t=window.open(e,"_blank",s.join(",")))&&t.moveBy?(n.elements.popup=t,n.timer=window.setInterval(n.checkClosed.bind(n),100),setTimeout(function(){n.focus(),n.setPosition(o.left,o.top),n.dispatchEvent("onOpen")},100)):n.dispatchEvent("onBlocked")},checkClosed:function(){var e=this.elements.popup;e&&!e.closed||this.handleApproval()},handleApproval:function(){this.timer&&(window.clearInterval(this.timer),this.timer=null),this.close()}});return e.namespace("Controls/Popup",n,e)});