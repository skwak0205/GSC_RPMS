define("UWA/Controls/ToolTip",["UWA/Core","UWA/Event","UWA/Controls/Abstract","UWA/Element","UWA/Class/Timed","UWA/Utils/Client","UWA/Controls/DropDown"],function(t,e,o,i,s,n,l){"use strict";var h,d=new l.Pointy({autoPosition:["below-start","right-start","left-start","above-start"],margin:20,positionOptions:{relative:document.querySelector("body")}}),a=new s,r=o.extend({name:"uwa-tooltip",content:"",defaultOptions:{id:"uwa-tooltip",className:"",width:"auto",delay:800,showOver:!0,root:null},mousePosition:{},init:function(e,o,i){this._parent(i),this.content=o||"",this._tooltipped=t.extendElement(e),this._attachEvents()},destroy:function(){this.hide(),this._detachEvents(),this._parent()},_attachEvents:function(){if(!this._events){var t=this._events={tooltipped:{},tooltippedOnShown:{},bodyOnShown:{}};this.options.showOver&&(t.tooltipped.mouseover=this.dispatchAsEventListener("onShowTooltip"),t.tooltippedOnShown.mouseout=this.dispatchAsEventListener("onHideTooltip"),t.tooltippedOnShown.click=this.dispatchAsEventListener("onHideTooltip"),t.bodyOnShown.mousemove=this.dispatchAsEventListener("onMoveTooltip"))}this._tooltipped.addEvents(this._events.tooltipped)},_detachEvents:function(){this._events&&(this._tooltipped.removeEvents(this._events.tooltipped),this._tooltipped.removeEvents(this._events.tooltippedOnShown),i.removeEvents.call(document.querySelector("body"),this._events.bodyOnShown,!0))},buildSkeleton:function(){for(var t,e=this.options,o=i.getDocument.call(this._tooltipped),s=this.getRootNode(),n=i.getChildren.call(s),l=e.id,a=0;(t=o.getElementById(e.id))&&!(n.indexOf(t)>=0);)e.id=l+"-"+a++;return t||((t=d.getContent()).id=e.id,void 0===h&&(h=t.className),t.set("class",h+" "+this.getClassNames()),t.setStyle("width",e.width),t.inject(s)),this._tooltip=t,t},_tooltippedIsActive:function(){var t=this._tooltipped;function e(t){var e=t.getStyles(["visibility","opacity"]);return"hidden"!==e.visibility&&e.opacity>0}var o=e(t)&&t.getParents().every(e),s=n.getScrolls(),l=document.elementFromPoint(this.mousePosition.x-s.x,this.mousePosition.y-s.y),h=i.isInjected.call(l,t)||l===t;return o&&h},show:function(e,o){var i,s,n,l,h,a=t.is,r=this._tooltip,p=this._tooltipped;if(e||this._tooltippedIsActive()){if(r||(r=this.buildSkeleton()),d.getInnerElement().setContent(this.content),r.show(),a(e)){if((a(e,"string")||a(e,"object")&&a(e.x,"string")&&a(e.y,"string"))&&(e=p.getPosition(!1,e),l={relative:this._tooltipped.getOffsetParent()},o))for(h=r.getDimensions(),i=0;i<2;i+=1)n=i?"width":"height",e[s=i?"x":"y"]=e[s]-h[n]/2}else e=this.mousePosition,l={relative:document.querySelector("body")};return r.addClassName("show"),d.setPosition(e,l),this.visible=!0,this.dispatchEvent("onShow"),this}},hide:function(){var t=this._tooltip;return this.visible&&(t.removeClassName("show"),t.hide(),this.dispatchEvent("onHide")),a.clearDelayed(),this.visible=!1,this},toggle:function(){this.visible?this.hide():this.show()},setDelay:function(){var t=this,e=t.options.delay;t.visible||a.setDelayed("tooltip",function(){t.show()},e)},onShowTooltip:function(t){this.mousePosition=e.getPosition(t),this._tooltipped.addEvents(this._events.tooltippedOnShown),i.addEvents.call(document.querySelector("body"),this._events.bodyOnShown,null,null,!0),this.options.delay?this.setDelay():this.show()},onMoveTooltip:function(t){var o=this.options.delay;this.mousePosition=e.getPosition(t),o>0?(this.hide(),this.setDelay()):d.setPosition(this.mousePosition)},onHideTooltip:function(o){"click"!==o.type&&t.equals(this.mousePosition,e.getPosition(o))||(this._tooltipped.removeEvents(this._events.tooltippedOnShown),i.removeEvents.call(document.querySelector("body"),this._events.bodyOnShown,!0),this.hide())},getRootNode:function(){return this.options.root||this._tooltipped.getOffsetParent()}});return e.onDomReady(function(){if(!n.Features.touchEvents){var t,o,s=document.querySelector("body"),l=0;i.addEvent.call(s,"mouseover [uwa-tooltip]",function(i){var n=e.getElement(i);if(n&&n.getAttribute("uwa-tooltip")&&(n!==t||o!==n.getAttribute("uwa-tooltip"))){t=n,o=n.getAttribute("uwa-tooltip");var h="true"===n.getAttribute("uwa-tooltip-quick"),d=Number(n.getAttribute("uwa-tooltip-delay"))||800,a=!!(h&&Date.now()-l<500)&&200;n.set("title","");var p=new r(n,n.getAttribute("uwa-tooltip"),{root:s,delay:a||d});p.dispatchEvent("onShowTooltip",[i]),h&&(p.addEvent("onShow",function(){p.setOption("delay",d)}),p.addEvent("onHide",function(){l=Date.now()}))}})}}),t.namespace("Controls/ToolTip",r,t)});