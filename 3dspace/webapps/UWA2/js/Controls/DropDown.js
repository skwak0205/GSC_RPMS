define("UWA/Controls/DropDown",["UWA/Core","UWA/Event","UWA/Element","UWA/Controls/Abstract","UWA/Utils/Client","UWA/Utils/Scroll"],function(t,e,n,i,o,s){"use strict";var l,r=o.Features.eventCapture;return(l=i.extend({name:"uwa-dropdown",defaultOptions:{position:{},positionOptions:{boundary:"auto"},global:!1},init:function(t){this._parent(t),this.clickOutsideEvent=function(t){var n=t&&e.getElement(t),o=this.elements.container,s=n.isInjected(o),l=i._getClosestControlsFromElement(n).some(function(t){return t.getContent().isInjected(o)});s||l||this.dispatchEvent("onClickOutside",[t])}.bind(this)},destroy:function(){this.hide(),this._parent()},getContent:function(){var n=this.elements;return n.container||(n.container=t.createElement("div",{class:this.getClassNames()+(this.options.global?" global":""),events:{click:this.dispatchEvent.bind(this,"onClick"),mouseleave:this.dispatchEvent.bind(this,"onMouseLeave")}}),this.options.global?(n.bacon=t.createElement("div",{class:this.getClassNames("-bacon")}).hide(),this._scrollPrevention=function(t){var n=e.getElement(t),i=this.getInnerElement();i===n||n.isInjected(i)||e.preventDefault(t)}.bind(this),s.preventParentScroll(n.container,{onlyScrollable:!1})):n.container.hide(),i._linkElementToControl(this,n.container),r||(n.capture=t.createElement("div",{styles:{width:"100%",height:"100%",position:"absolute",zIndex:1e3,top:0,left:0},events:{click:this.clickOutsideEvent}}))),n.bacon||n.container},onClick:function(t){e.stopPropagation(t),this.hide()},onPostInject:function(){this.updatePosition()},onShow:function(){this.options.global&&(this.elements.container.inject(document.body),n.addEvent.call(document.body,"mousewheel",this._scrollPrevention,null,!0)),this.updatePosition(),this.hasEvent("onClickOutside")&&(r?n.addEvent.call(document,"click",this.clickOutsideEvent,null,0,!0):this.elements.capture.inject(document.body))},onHide:function(){this.options.global&&(this.elements.container.remove(),n.removeEvent.call(document.body,"mousewheel",this._scrollPrevention,!0)),r?n.removeEvent.call(document,"click",this.clickOutsideEvent,!0):this.elements.capture.remove()},onRemoved:function(){var t=this.elements,e=t.bacon||t.container;e&&e.hide(),this.options.global&&t.container&&t.container.remove(),this._scrollPrevention&&n.removeEvent.call(document.body,"mousewheel",this._scrollPrevention,!0)},isOpen:function(){return!!this.elements.container&&"none"!==this.getContent().getStyle("display")},toggle:function(e){return t.is(e)||(e=!this.isOpen()),this[e?"show":"hide"](),this},setPosition:function(e,n){return t.extend(this.options,{position:e,positionOptions:n||{}},!0),this.updatePosition()},updatePosition:function(){function e(e){return t.is(e,"function")?e():e}return function(){return this.isOpen()&&(this.dispatchEvent("onPreUpdatePosition"),this.elements.container.setPosition(e(this.options.position),e(this.options.positionOptions))),this}}(),getInnerElement:function(){return this.getContent(),this.elements.container}})).Pointy=l.extend({name:"uwa-pointydropdown",defaultOptions:{autoPosition:["below-center","right-center","left-center","above-center"],margin:12},updatePosition:function(){this.dispatchEvent("onPreUpdatePosition");var e,n,i,o,s=this.options,l=s.margin;return e=s.target?s.target.getDimensions():{width:0,height:0},n=this.elements.container.getDimensions(),i=s.autoPosition.map(function(t){var i=(t=t.split("-"))[0],o=t[1]||"center",r={x:0,y:0};return r.place=i,r.align=o,"below"===i?r.y=e.height+l:"above"===i?r.y=-n.outerHeight-l:"center"===o?r.y=e.height/2-n.outerHeight/2:"end"===o&&(r.y=Math.max(e.height,30)-n.outerHeight),"left"===i?r.x=-n.outerWidth-l:"right"===i?r.x=e.width+l:"center"===o?r.x=e.width/2-n.outerWidth/2:"end"===o&&(r.x=Math.max(e.width,30)-n.outerWidth),s.target||(r.x+=s.position.x||0,r.y+=s.position.y||0,"center"!==o&&("right"!==i&&"left"!==i||(r.y-=15),"above"!==i&&"below"!==i||(r.x-=15))),r}),this.isOpen()&&((o=this.elements.container).setPosition(i,t.merge({relative:s.target},this.options.positionOptions)),i=i[0],this._containerClassName&&o.removeClassName(this._containerClassName),this._containerClassName=i.place+" "+i.align,o.addClassName(this._containerClassName),this.updatePointPosition(i.place)),this},updatePointPosition:function(t){var e=this.options.target,n=this.elements.container,i=n.getSize(),o=n.getOffsets(),s=e?e.getSize():{height:0,width:0},l=e?e.getOffsets():this.options.position,r={bottom:null,left:null,right:null,top:null};l.x-=o.x,l.y-=o.y,"below"===t||"above"===t?(r.left=l.x+s.width/2,(r.left<10||r.left>i.width-10)&&(r.left=i.width/2),"below"===t?r.top=0:r.bottom=0):(r.top=l.y+s.height/2,(r.top<10||r.top>i.height-10)&&(r.top=i.height/2),"right"===t?r.left=0:r.right=0),this.elements.point.setStyles(r).setText({above:"j",below:"k",left:"m",right:"l"}[t]||" ").toggleClassName("side","left"===t||"right"===t)},getInnerElement:function(){return this.getContent(),this.elements.inner},getContent:function(){var e=this.elements,n=this._parent();return e.inner||e.container.setContent(e.inner=t.createElement("div",{class:this.getClassNames("-inner")}),e.point=t.createElement("div",{class:this.getClassNames("-point")})),n}}),t.namespace("Controls/DropDown",l,t)});