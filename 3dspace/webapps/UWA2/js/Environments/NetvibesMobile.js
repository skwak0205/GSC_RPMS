/*!
  Script: NetvibesMobile.js

    This file is part of UWA JS Runtime.

  About: License

    Copyright 2006-2012 Netvibes, a Dassault Syst√®mes company.
    All rights reserved.
*/
define("UWA/Environments/NetvibesMobile",["UWA/Core","UWA/Environment"],function(t,e){"use strict";var i,n,a=e.extend({name:"netvibesMobile",init:function(t,e){this._parent(e),this.view=t,this.netvibes={inline:!0,iframed:!1},this.mobile={touch:!0}},map:function(e,i,n){this.id=e,this.readOnly=!!n,this.html={wrapper:i,body:i.getElement(".moduleContent")},t.Element.addEvent.apply(window,["resize",this.dispatchEvent.bind(this,"onResize")])},filterExternalResources:function(t,e){if("script"===t){var i=/\b(highcharts|app\/socialpack|app\.js\.php)\b/i;e=e.filter(function(t){return!i.test(t)})}return e},onRegisterWidget:function(){this.widget.id=this.id,this.widget.readOnly=this.readOnly,this.widget.pageId=App.currentDashboard.getId(),this.html.body.handleExternalLinks(this.widget.openURL.bind(this.widget))},onUpdateTitle:function(t){this._parent(t),t=t.stripTags(),Ext.getCmp("viewport").navigationBar.setTitle(t)},onResize:function(){var t=Ext.getCmp("widget-view").getScrollable();t&&t.getScroller().refresh()},buildEdit:function(){this.dispatchEvent("onEdit")},resetUnreadCount:function(){this.widget.setUnreadCount(0),this.dispatchEvent("onResetUnreadCount")},refresh:function(){this.dispatchEvent("onRefresh")},remove:function(){var t;for(t in this.periodicals)this.periodicals.hasOwnProperty(t)&&this.clearPeriodical(t);for(t in this.widget.periodicals)this.widget.periodicals.hasOwnProperty(t)&&this.widget.clearPeriodical(t);this.dispatchEvent("onRemove")},getAllData:function(){return this.view.module.getData()},getData:function(t){return this.view.module.getData()[t]},setData:function(e,i){var n=this.view.module.getData();t.is(i)?n[e]!==i&&(n[e]=i,this.saveDatas()):this.deleteData(e)},saveDatas:function(){this.view.savePreferences()},deleteData:function(t){var e=this.view.module.getData();return this.widget.getPreference(t)?null!==e[t]&&(e[t]=null,this.saveDatas()):e.hasOwnProperty(t)&&(delete e[t],this.saveDatas()),!0},getAnalytics:function(){return this.view.module.getAnalytics()}});return t.Data.proxies=t.extend(t.Data.proxies,{feed:"http://"+window.location.host+"/proxy/feedProxy.php",ajax:"http://"+window.location.host+"/proxy/ajaxProxy.php",oauth:"http://"+window.location.host+"/proxy/oauthProxy.php",pop:"http://"+window.location.host+"/proxy/securePopProxy.php",gmail:"http://"+window.location.host+"/proxy/securePassProxy.php"}),i=t.Data,n=i.request,i.request=function(t,e){var a=window.App;return a.data.brand&&(e||(e={}),e.data||(e.data={}),e.data.brand=a.data.brand),n.call(i,t,e)},t.namespace("Environment/NetvibesMobile",a,t)});