define("UWA/Environments/Standalone",["UWA/Core","UWA/Utils","UWA/Element","UWA/Environment","UWA/Storage/Adapter/Cookies","UWA/Storage/Adapter/Object"],function(e,t,n,o){"use strict";function a(e,n){var o=[];return document.createElement("widget:"+n),e.getElementsByTagNameNS&&(o=e.getElementsByTagNameNS("http://www.netvibes.com/ns/",n)),0===o.length&&(o=e.getElementsByTagName("widget:"+n)),0===o.length&&(o=e.getElementsByTagName(n)),0===o.length&&e!==document&&(o=(o=a(document,n)).filter(function(t){for(var n=t,o=e.tagName;n.previousSibling&&n.tagName!==o;)n=n.previousSibling;return n===e&&t})),t.toArray(o)}var i=o.extend({name:"uwa",onInit:function(){var e=n.getElement.bind(document.querySelector("body"));e(".moduleUwa")||this.buildSkeleton(),this.html={viewport:window,wrapper:e(".module"),header:e(".moduleHeader"),content:e(".moduleWrapper"),body:e(".moduleContent"),edit:e(".moduleEdit"),menus:e(".moduleHeader > menu"),footer:e(".moduleFooter"),counter:e(".counter"),title:e(".title"),icon:e(".icon"),shareAction:e(".share"),refreshAction:e(".refresh"),editAction:e(".edit")}},getWidgetContent:function(){var t=document.head,o=a(document,"style");return[a(document,"preferences"),a(document,"plugins"),o].forEach(function(n){n.forEach(function(n){e.Element.isInjected.call(n,t)||t.appendChild(n)})}),n.getHTML.call(document.querySelector("body"))},buildSkeleton:function(){var t=e.hosts,o=e.i18n,a=t.uwa+e.paths.img+"icon.png",i=document.querySelector("body"),r=this.getWidgetContent();n.setContent.call(i,{tag:"div",class:"module moduleUwa",html:[{tag:"div",class:"moduleHeader",html:[{tag:"span",class:"icon",html:{tag:"img",height:16,width:16,src:a}},{tag:"span",class:"counter"},{tag:"span",class:"title",text:o(document.title)},{tag:"menu",type:"toolbar",class:"menus"}]},{tag:"div",class:"moduleWrapper",html:[{tag:"div",class:"moduleEdit"},{tag:"div",class:"moduleContent",html:r}]},{tag:"div",class:"moduleFooter",html:[{tag:"a",class:"powered",href:t.netvibes,text:o("Â© Netvibes")},{tag:"a",class:"share",href:t.ecosystem,text:o("Subscribe to this app")}]}]})},onRegisterWidget:function(){this._parent(),this.loadMetas(),this.loadPreferencesXML(),this.loadPluginsXML()},loadMetas:function(){var e,t,n,o,a,i,r=this.widget,l={};for(e=0,t=(i=document.getElementsByTagName("meta")).length;e<t;e++)n=(a=i[e]).getAttribute("name"),o="false"!==(o=a.getAttribute("content"))&&("true"===o||o),n&&(l[n]=o);for(r.setMetas(l),e=0,t=(i=document.getElementsByTagName("link")).length;e<t;e++)if("icon"===(a=i[e]).getAttribute("rel")){r.setIcon(a.getAttribute("href"));break}},loadPluginsXML:function(){var e,t,n,o,i=[],r=a(document,"plugin"),l=function(e,t){var n,o,i,r,s;for(t=t||{},n=0,o=(i=a(e,"option")).length;n<o;n++)t[s=(r=i[n]).getAttribute("name")]=r.getAttribute("value");for(n=0,o=(i=a(e,"options")).length;n<o;n++)t[s=(r=i[n]).getAttribute("name")]=l(r,t[s]);return t};for(e=0,t=r.length;e<t;e++)null!==(o=(n=r[e]).getAttribute("name"))&&i.push({name:o,options:l(n)});i.length>0&&this.widget.setPlugins(i)},loadPreferencesXML:function(){var e,t,n,o,i,r,l,s,u,d,c,g,m,h=[],f=a(document,"preference");for(e=0,t=f.length;e<t;e++){for(c={},n=0,o=(g=f[e]).attributes.length;n<o;n++)c[(m=g.attributes[n]).nodeName]=m.value;if(void 0!==c.defaultvalue&&(c.defaultValue=c.defaultvalue,delete c.defaultvalue),"list"===c.type)for(c.options=[],i=0,r=(u=a(g,"option")).length;i<r;i++){for(d={},l=0,s=u[i].attributes.length;l<s;l++)d[(m=u[i].attributes[l]).nodeName]=m.value;d.label&&d.hasOwnProperty("value")&&c.options.push(d)}c.name&&c.type&&h.push(c)}h.length>0&&this.widget.setPreferences(h)}});return e.namespace("Environments/Standalone",i,e)}),define("widget",["UWA/Core","UWA/Event","UWA/Widget","UWA/Environments/Standalone"],function(e,t,n,o){"use strict";var a=new n;return t.onDomReady(function(){var e=new o;e.registerWidget(a),e.launchWidget()}),e.namespace("widget",a)});