define("UWA/Environments/Iphone",["UWA/Core","UWA/String","UWA/Utils","UWA/Utils/Client","UWA/Element","UWA/Environment","UWA/Data","UWA/Controls/Scroller","UWA/Controls/Notify","UWA/Storage/Adapter/Dom","UWA/Storage/Adapter/IE","UWA/Storage/Adapter/Cookies","UWA/Storage/Adapter/Object","UWA/Storage/Adapter/Html5"],function(e,t,o,n,i,a,r,s,l){"use strict";r.useOfflineCache=!0;var d=window.navigator.standalone;return a.extend({name:"iphone",defaultOptions:{formOptions:{nativeInputs:!0}},init:function(e){this._parent(e),String(location.hash).contains("debugCache")&&this.enableCacheDebug(),String(location.hash).contains("logCache")&&this.enableCacheLog()},onInit:function(){var e=document.body,t=i.getElement.bind(e);this.html={viewport:window,wrapper:t(".module"),header:t(".moduleHeader"),content:t(".moduleWrapper"),body:t(".moduleContent"),edit:t(".moduleEdit"),footer:t(".moduleFooter"),counter:t(".counter"),title:t(".title"),icon:t(".icon"),shareAction:t(".share"),refreshAction:t(".refresh"),editAction:t(".edit")},this.scroller||(this.scroller=new s(this.html.content,{snap:!1,bounce:!0,lockDirection:!0,momentum:!0,threshold:0}),this.onResize()),window.scrollTo(0,1)},onRegisterWidget:function(e){this._parent(e)},afterLoad:function(){var e=this.getData("__lastBookmark"),t=Date.now()-36e5;!d&&(String(location.hash).contains("welcome")||!e||e<t)&&this.showBookmarkNotify()},onResize:function(){var e=this.html,t=n.getSize().height;t!==this.prevHeight&&(this.prevHeight=t,this.scroller&&(["header","footer"].forEach(function(o){t-=e[o]?e[o].offsetHeight:0}),this.scroller.setOptions({height:t}),this.scroller.onRefresh()),this.hideAddressBar())},onShowEdit:function(){this.scrollTop(),this._parent()},onHideEdit:function(){this.scrollTop(),this._parent()},onOpenURL:function(e){d||this._parent(e)},scrollTop:function(){this.scroller&&this.scroller.setPosition(0,0,0,!0)},hideAddressBar:function(){window.location.hash||(document.height<window.outerHeight&&(document.body.style.height=window.outerHeight+50+"px"),this.setDelayed("scrollTo",function(){window.scrollTo(0,1)},50))},showBookmarkNotify:function(){var o,i;i=n.Platform.tablet?{className:"uwa-notify-ios uwa-notify-ipad",from:"bottom",to:"top"}:{className:"uwa-notify-ios uwa-notify-iphone",from:"top",to:"bottom"},(o=new l(i)).addMessage(t.format(e.i18n({ios:'Install this web app on your iOS device: tap &laquo;<strong class="{0}">+</strong>&raquo; and then &laquo;<strong>Add to Home Screen</strong>&raquo;.',other:"Install this web app on your browser just <strong>Bookmark It</strong>!"}[n.Platform.ios?"ios":"other"]),n.Engine.version>=4.2?"share":"plus")),o.inject(this.scroller.elements.scroller,"top"),this.setData("__lastBookmark",Date.now())},enableCacheDebug:function(){var e=window.applicationCache;window.addEventListener("load",function(){e.addEventListener("updateready",function(){e.status===e.UPDATEREADY&&(e.swapCache(),window.confirm("A new version of this application is available. Load it?")&&window.location.reload())},!1),e.addEventListener("error",function(){window.alert("Error: Unable to activate application offline capabilities!")},!1)},!1)},enableCacheLog:function(){console.log("ApplicationCache: debug start");var e=["uncached","idle","checking","downloading","updateready","obsolete"],t=window.applicationCache;function o(o){var n,i,a,r;n=navigator.onLine?"yes":"no",i=e[t.status],r="ApplicationCache: online: "+n,r+=", event: "+(a=o.type),r+=", status: "+i,"error"===a&&navigator.onLine&&(r+=" (prolly a syntax error in manifest)"),console.log(r)}t.addEventListener("cached",o,!1),t.addEventListener("checking",o,!1),t.addEventListener("downloading",o,!1),t.addEventListener("error",o,!1),t.addEventListener("noupdate",o,!1),t.addEventListener("obsolete",o,!1),t.addEventListener("progress",o,!1),t.addEventListener("updateready",o,!1),t.addEventListener("updateready",function(){t.swapCache(),console.log("swap cache has been called")},!1),this.setPeriodical("cacheUpdate",function(){t.update()},1e4)}})});