define("UWA/Services/Auth/Adapter/SiteMinder",["UWA/Core","UWA/Utils","UWA/Ajax","UWA/Json","UWA/Data","UWA/Services/Auth/Adapter/Abstract"],function(t,e,n,i,a,o){"use strict";var s=o.extend({defaultOptions:{timeout:15e3,smagentname:"",realmoid:"",forest:"",guid:"",type:"",smauthreason:0,target:"https://example.com/myapp/test.json",login:"https://example.com/global/2.0/login.fcc",logout:"https://example.com/global/2.0/logout.fcc"},isAjaxPostAllowed:function(){return a.allowCrossOriginRequest},hasIdentity:function(t,e){var n=this.options;this.hasIdentityRequest&&this.hasIdentityRequest.cancel(),this.hasIdentityRequest=i.request(n.target,{useOfflineCache:!1,timeout:n.timeout,onComplete:function(e){"function"==typeof t&&t(e)}.bind(this),onFailure:function(t){"function"==typeof e&&e(t)}.bind(this)})},getIdentity:function(t,e){e(new Error("Not implemented."))},clearIdentity:function(t){t=t||function(){},this.isAjaxPostAllowed()?this.clearIdentityUsingAjax(t):this.clearIdentityUsingFrame(t)},authenticate:function(t,n,i){if(n=n||function(){},t=t||function(){},i.login&&i.password){var a=this.options,o=a.target+"&callback=jsonp"+(Date.now()+e.random(1,1e4)),s=e.toQueryString({type:a.type,realmoid:a.realmoid,guid:a.guid,smauthreason:a.smauthreason,method:"GET",smagentname:"-SM-"+a.smagentname,target:"-SM-"+o}).replace(/%25/g,"-%"),r=a.login+"?"+s,u=function(){this.hasIdentity(t,n)}.bind(this),d={target:o,smquerydata:"",smauthreason:a.smauthreason,smagentname:a.smagentname,postpreservationdata:"",forest:a.forest,userid:i.login,password:i.password,Submit:""};this.isAjaxPostAllowed()?this.authenticateUsingAjax(d,r,u,n):this.authenticateUsingFrame(d,r,u,n)}else n(new Error("Invalid credentials values."))},authenticateUsingFrame:function(e,n,i){var a,o,s=Math.ceil(1e5*Math.random()),r=t.createElement("div",{styles:{position:"absolute",top:"-2000px",left:"0px"}}),u=t.createElement("iframe",{src:"about:blank",name:"siteminder:frame:"+s}).inject(r),d=t.createElement("form",{target:"siteminder:frame:"+s,action:n,method:"post"}).inject(r);for(a in e)e.hasOwnProperty(a)&&(o=e[a],t.createElement("input",{type:"hidden",name:a,value:o}).inject(d));document.body.appendChild(r),u.addEvent("load",function(){this.destroy(),i()}),d.submit()},clearIdentityUsingFrame:function(e){var n,i=this.options.logout;i+=(i.indexOf("?")>-1?"&":"?")+"rnd="+Math.random(),(n=t.createElement("iframe",{src:"about:blank",styles:{position:"absolute",top:"-2000px",left:"0px"}}).inject(document.body)).addEvent("load",function(){this.destroy(),e()}),n.setAttribute("src",i)},authenticateUsingAjax:function(t,e,i,a){n.request(e,{onComplete:i,onFailure:function(){this.hasIdentity(i,a)}.bind(this),method:"POST",data:t})},clearIdentityUsingAjax:function(t){n.request(this.options.logout,{onComplete:t,onFailure:t,method:"GET"})}});return t.namespace("Services/Auth/Adapter/SiteMinder",s,t)});