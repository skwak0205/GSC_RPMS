define("UWA/Internal/Polyfill/Promise",["UWA/Internal/Immediate"],function(e){"use strict";var r,t=new Function("return this")();t.UWA_SKIP_POLYFILLS||"function"!=typeof t.Promise&&((r=t.Promise=function(e){var r,t,n,i=this;if(!i||"object"!=typeof i)throw new TypeError("bad promise");if(void 0!==i._status)throw new TypeError("promise already initialized");if(!o(e))throw new TypeError("not a valid resolver");i._status="unresolved",i._resolveReactions=[],i._rejectReactions=[],r=function(e){"unresolved"===i._status&&(n=i._resolveReactions,i._result=e,u(i,n,"has-resolution"))},t=function(e){"unresolved"===i._status&&(n=i._rejectReactions,i._result=e,u(i,n,"has-rejection"))};try{e(r,t)}catch(e){t(e)}return i}).prototype={constructor:r,catch:function(e){return this.then(void 0,e)},then:function(e,t){var n,u,a,l;if(!function(e){return e instanceof r}(this))throw new TypeError("not a promise");switch(n=new i,o(t)||(t=function(e){throw e}),o(e)||(e=function(e){return e}),u=function(e,r,t){return function(n){if(n===e)return t(new TypeError("self resolution"));var o=new i;return s(n,o)?o.promise.then(r,t):r(n)}}(this,e,t),a={capability:n,handler:u},l={capability:n,handler:t},this._status){case"unresolved":this._resolveReactions.push(a),this._rejectReactions.push(l);break;case"has-resolution":c([a],this._result);break;case"has-rejection":c([l],this._result);break;default:throw new TypeError("unexpected")}return n.promise}},r.all=function(e){var t=new i,n=t.resolve,o=t.reject,s=[],c={count:1};try{a(e).forEach(function(e,n){var o,i,u=e._result,a=e._status;(o="has-resolution"===a?r.resolve(u):"has-rejection"===a?r.reject(u):e)&&(i=function(e,r,t,n){var o=!1;return function(i){o||(o=!0,r[e]=i,0==--n.count&&(0,t.resolve)(r))}}(n,s,t,c),c.count++,o.then(i,t.reject))}),0==--c.count&&n(s)}catch(e){o(e)}return t.promise},r.race=function(e){var r,t=new i,n=t.resolve,o=t.reject;try{a(e).forEach(function(e){var t,i=e._result,s=e._status;t="has-resolution"===s&&"has-rejection"!==r?n(i):"has-rejection"===s&&"has-resolution"!==r&&"has-rejection"!==r?o(i):e,r=s,t&&t.then(n,o)})}catch(e){o(e)}return t.promise},r.reject=function(e){var r=new i;return(0,r.reject)(e),r.promise},r.resolve=function(e){if(e instanceof r)return e;var t=new i;return(0,t.resolve)(e),t.promise});function n(e){return null!=e&&Object(e)===e}function o(e){return"function"==typeof e&&"[object Function]"===Object.prototype.toString.call(e)}function i(e){if(e){if(!o(e))throw new TypeError("bad promise constructor")}else e=r;var t,i=this;if(i.promise=Object.create(e.prototype||null),t=e.call(i.promise,function(e,r){i.resolve=e,i.reject=r}),!o(i.resolve)||!o(i.reject))throw new TypeError("bad promise constructor");if(n(t)&&t!==i.promise)throw new TypeError("bad promise constructor")}function s(e,r){if(!n(e))return!1;try{var t=e.then;if(!o(t))return!1;t.call(e,r.resolve,r.reject)}catch(e){r.reject(e)}return!0}function c(r,t){r.forEach(function(r){e.set(function(e,r){var t,n=r.handler,o=r.capability,i=o.resolve,c=o.reject;try{if((t=n(e))===o.promise)throw new TypeError("self resolution");s(t,o)||i(t)}catch(e){c(e)}}.bind(null,t,r))})}function u(r,t,n){e.clear(r._updateStatus),r._status=n,r._updateStatus=e.set(function(){r._resolveReactions=void 0,r._rejectReactions=void 0,c(t,r._result)})}function a(e){return function(e){if(Array.isArray(e))return e;if("number"!=typeof e.length)throw new TypeError("bad iterable");return Array.prototype.slice.call(e)}(e).map(function(e){return e instanceof r?e:r.resolve(e)})}});