define("UWA/Plugins/GoogleAnalytics",["UWA/Core","UWA/Plugins/Abstract","UWA/Utils","UWA/Utils/Client","UWA/Json"],function(t,i,e,n,o){"use strict";var s=i.extend({init:function(t,i){this._parent(t,i),this.initScript(),this.addEvent("beforeLoad",this.loadScript)},initScript:function(){var i,e,n,s,a=this.options,r=window._gaq||[];for(i in a)if(a.hasOwnProperty(i))if(e=a[i],n=t.typeOf(e),i.contains("UA-")&&(s&&r.push(["_trackPageview"]),s=!0,r.push(["_setAccount",i])),o.isJson(e)&&(e=o.decode(e),n=t.typeOf(e)),"array"===n)r.push(e);else{if("string"!==n&&"number"!==n)throw new Error('Invalid GoogleAnalytics Plugin option with value "'+o.encode(e)+'".');s||"string"!==n||(s=e.contains("UA-")),r.push([i,e])}s&&(this.addCustomVars(r),r.push(["_trackPageview"])),window._gaq=r,this.addEvent("onOpenURL",this.openURL)},addCustomVars:function(t){var i,n=e.parseUrl(this.widget.getUrl());try{i=String(window.top.location)}catch(t){i=this.widget.widgetDomain||String(window.location)}t.push(["_setCustomVar",1,"widget_url",n.source,5]),t.push(["_setCustomVar",2,"widget_platform",this.widget.environment.name,5]),t.push(["_setCustomVar",3,"widget_referer",i,5])},loadScript:function(){var i=document.getElementsByTagName("script")[0];t.createElement("script",{src:("https:"===document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js",async:!0,type:"text/javascript"}).inject(i||document.body||document.head,i?"after":"bottom"),this.removeEvent("afterLoad",this.loadScript)},openURL:function(){}});return t.namespace("Plugins/GoogleAnalytics",s,t)});