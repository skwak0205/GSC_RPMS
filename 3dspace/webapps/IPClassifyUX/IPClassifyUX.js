define("DS/IPClassifyUX/views/additionalData/manipulationUnitColumns",["UWA/Core","UWA/Class","DS/IPClassifyUtil/DimensionUtils"],function(e,t,i){"use strict";return t.singleton({init:function(e){this._parent(e)},getName:function(){return"manipulationUnitColumns"},isAdditionalColumnsAvailable:function(t,i){if(!1===e.is(i,"function"))throw new Error("A callback function should be defined");this.dataProvider=t,i(!0)},getManagedColumnNames:function(){let e=[],t=this.dataProvider.getManipulationUnitColumns();for(var i=0;i<t.length;++i)e.push(t[i].dataIndex);return e},toBeUpdated:function(t,i){var n=!1;if(t&&0!==Object.keys(t).length){let i=Object.keys(t);if(i&&i.length>0){i=i[0];let r=this.dataProvider.getColumnUnitNls(i);if(r&&t[i]){let o=t[i];!0===e.is(t[i],"array")&&(o=t[i].length>0?t[i][0]:null),o&&-1===o.indexOf(r)&&(n=!0)}}}return n},updateAttributes:function(t,n){var r=this;if(!1===e.is(t,"object")||!1===e.is(t.pids,"array"))throw new Error("The object ids to modify must be specified");if(!1===e.is(n,"function"))throw new Error("A callback function should be defined");let o=this.dataProvider.getManipulationUnitColumns();function a(e){return-1===e.indexOf(" ")}o||n();let s={Data:[]};for(let e=0;e<o.length;++e){let t=o[e];s.Data[e]={},s.Data[e].Dimension=t.convertInfos.dimension,s.Data[e].UnitFrom=t.convertInfos.unit,s.Data[e].UnitTo=t.convertInfos.manipulationUnit,s.Data[e].Values=this.dataProvider.getManipulationUnitVisibleValues(t.dataIndex),s.Data[e].Values=s.Data[e].Values.filter(a),s.Data[e].Values.length>0&&(s.Data[e].Values=s.Data[e].Values.join(";"))}i.convertToPreferdUnits(s).then(function(i){i||n();var a={};for(let n=0;n<t.pids.length;++n){a[t.pids[n]]={};for(let s=0;s<o.length;++s){let l=o[s].dataIndex,d=i[s],c=o[s].convertInfos.manipulationNls;if(d&&l&&c){let i=d.ConvertedValues;i=i?i.split(";"):null;let o=d.ValuesToConvert;o=o?o.split(";"):null;let s=r.dataProvider.getManipulationUnitVisibleValues(l,t.pids[n]);if(i&&e.is(i,"array")&&o&&e.is(o,"array")&&s){let r=null;if(!0===e.is(s,"array")){r=[];for(let e=0;e<s.length;++e){let t=o.indexOf(s[e]);r.push(i[t]+" "+c)}}else{r=i[o.indexOf(s[k])]+" "+c}a[t.pids[n]][l]=r}}}}var s={pids:a};s=JSON.stringify(s),n(s)})}})}),define("DS/IPClassifyUX/events/IPClassifyEvents",["UWA/Class","DS/Core/ModelEvents"],function(e,t){return e.singleton({EVT_CURRENT_LIBRARY_CHANGE:"/LIBRARY_EDITOR/CURRENTLIBRARY_CHANGE",EVT_NODEMODEL_MODIFY:"/LIBRARY_EDITOR/NODEMODEL_MODIFY",EVT_LIBRARY_LOADINGSTART:"/LIBRARY_EDITOR/LIBRARY_LOADINGSTART",EVT_LIBRARY_LOADINGEND:"/LIBRARY_EDITOR/LIBRARY_LOADINGEND",EVT_CURRENT_LIBRARY_FILTER_CHANGE:"/LIBRARY_EDITOR/CURRENTLIBRARY_FILTER_CHANGE",EVT_CURRENT_LIBRARY_COLUMN_CHANGE:"/LIBRARY_EDITOR/CURRENT_LIBRARY_COLUMN_CHANGE",EVT_LIBRARY_TREELISTVIEW_SCROLL_END:"/LIBRARY_EDITOR/LIBRARY_TREELISTVIEW_SCROLL_END",EVT_LIBRARY_TAGGER_OPEN:"/LIBRARY_EDITOR/LIBRARY_TAGGER_OPEN",EVT_LIBRARY_TAGGER_CLOSE:"/LIBRARY_EDITOR/LIBRARY_TAGGER_CLOSE",EVT_LIBRARY_PAGETOOLBAR_EXPAND:"welcome-panel-expand",EVT_LIBRARY_PAGETOOLBAR_EXPANDED:"welcome-panel-expanded",EVT_LIBRARY_PAGETOOLBAR_COLLAPSE:"welcome-panel-collapse",EVT_LIBRARY_PAGETOOLBAR_COLLAPSED:"welcome-panel-collapsed",EVT_LIBRARY_PAGEINFO_EXPAND:"information-panel-open",EVT_LIBRARY_PAGEINFO_EXPANDED:"information-panel-visible",EVT_LIBRARY_PAGEINFO_COLLAPSE:"information-panel-close",EVT_LIBRARY_PAGEINFO_COLLAPSED:"information-panel-hidden",EVT_COLUMN_SORT_CHANGE:"/LIBRARY_EDITOR/COLUMN_SORT_CHANGE",EVT_REMOVENODE_CONTENT:"/LIBRARY_EDITOR/REMOVENODE_CONTENT",EVT_UPDATE_SEARCH_VISIBILITY:"/LIBRARY_EDITOR/UPDATE_SEARCH_VISIBILITY",EVT_EXPANDTREE_AND_SELECT:"/LIBRARY_EDITOR/EXPANDTREE_AND_SELECT",EVT_LIBRARYSELECT:"/LIBRARY_EDITOR/SELECT",EVT_ACTIVATE_TREE_ITEM:"/LIBRARY_EDITOR/ACTIVATE_TREE_ITEM",EVT_TREE_SORT_CHANGE:"/LIBRARY_EDITOR/TREE_SORT_CHANGE",EVT_CONTENT_SEARCH_RESULT:"/LIBRARY_EDITOR/CONTENT_SEARCH_RESULT",EVT_CONTENT_SEARCH_CHANGE:"/LIBRARY_EDITOR/CONTENT_SEARCH_CHANGE",EVT_CONTENT_TAB_CHANGE:"/LIBRARY_EDITOR/CONTENT_TAB_CHANGE",EVT_FAVORITE_SECTION_EMPTY:"/LIBRARY_EDITOR/EVT_FAVORITE_SECTION_EMPTY",EVT_CONTENT_READY:"/LIBRARY_EDITOR/EVT_CONTENT_READY",EVT_SWITCH_MODE:"/LIBRARY_EDITOR/INDEX_DB_MODE_CHANGE",_modelEvents:null,init:function(e){this._parent(e),this._modelEvents=new t},getModelEvents:function(){return this._modelEvents},notifyupdateRefreshTime:function(e){if(!UWA.is(e,"object"))throw new Error("input parameter should be object");this._modelEvents.publish({event:"REFRESH_TIME_UPDATED",data:e})},onUpdateRefreshTime:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:"REFRESH_TIME_UPDATED"},e)},notifyLibraryLoadingStart:function(e){if(!UWA.is(e))throw new Error("input parameter should be a TreeNodeModel");this._modelEvents.publish({event:this.EVT_LIBRARY_LOADINGSTART,context:e,data:e})},onLibraryLoadingStart:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_LOADINGSTART},e)},notifyLibraryLoadingEnd:function(e){if(!UWA.is(e))throw new Error("input parameter should be a TreeNodeModel");this._modelEvents.publish({event:this.EVT_LIBRARY_LOADINGEND,context:e,data:e})},onLibraryLoadingEnd:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_LOADINGEND},e)},notifyLibraryRename:function(e){if(!UWA.is(e,"object"))throw new Error("input parameter should be object");this._modelEvents.publish({event:this.EVT_NODEMODEL_MODIFY,context:e.oldNode,data:e})},onLibraryRename:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_NODEMODEL_MODIFY},e)},notifyRemoveNodeInContent:function(e){this._modelEvents.publish({event:this.EVT_REMOVENODE_CONTENT,data:e})},onRemoveNodeInContent:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_REMOVENODE_CONTENT},e)},notifyUpdateSearchVisibility:function(e){this._modelEvents.publish({event:this.EVT_UPDATE_SEARCH_VISIBILITY,data:e})},onUpdateSearchVisibility:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_UPDATE_SEARCH_VISIBILITY},e)},notifyExpandTreeAndSelect:function(e){this._modelEvents.publish({event:this.EVT_EXPANDTREE_AND_SELECT,data:e})},onExpandTreeAndSelect:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_EXPANDTREE_AND_SELECT},e)},notifyLibrarySelected:function(e){this._modelEvents.publish({event:this.EVT_LIBRARYSELECT,data:e})},onLibrarySelected:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARYSELECT},e)},notifyActivateTreeItem:function(e){this._modelEvents.publish({event:this.EVT_ACTIVATE_TREE_ITEM,data:e})},onActivateTreeItem:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_ACTIVATE_TREE_ITEM},e)},notifyTreeSortChange:function(e){this._modelEvents.publish({event:this.EVT_TREE_SORT_CHANGE,data:e})},onTreeSortChange:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_TREE_SORT_CHANGE},e)},notifyContentSearchResult:function(e){this._modelEvents.publish({event:this.EVT_CONTENT_SEARCH_RESULT,data:e})},onContentSearchResult:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_CONTENT_SEARCH_RESULT},e)},notifyContentSearchChange:function(){this._modelEvents.publish({event:this.EVT_CONTENT_SEARCH_CHANGE})},onContentSearchChange:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_CONTENT_SEARCH_CHANGE},e)},notifyContentTabChange:function(){this._modelEvents.publish({event:this.EVT_CONTENT_TAB_CHANGE})},onContentTabChange:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_CONTENT_TAB_CHANGE},e)},notifyCurrentLibraryChange:function(e){if(!UWA.is(e,"object"))throw new Error("input parameter should be object");if(!e.currentNode)throw new Error("input object should have currentNode");this._modelEvents.publish({event:this.EVT_CURRENT_LIBRARY_CHANGE,context:e.currentNode,data:e})},onCurrentLibraryChange:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_CURRENT_LIBRARY_CHANGE},e)},notifyCurrentLibraryFilterChange:function(){this._modelEvents.publish({event:this.EVT_CURRENT_LIBRARY_FILTER_CHANGE})},onCurrentLibraryFilterChange:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_CURRENT_LIBRARY_FILTER_CHANGE},e)},notifyCurrentLibraryColumnChange:function(){this._modelEvents.publish({event:this.EVT_CURRENT_LIBRARY_COLUMN_CHANGE})},onCurrentLibraryColumnChange:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_CURRENT_LIBRARY_COLUMN_CHANGE},e)},notifyColumnSortChange:function(){this._modelEvents.publish({event:this.EVT_COLUMN_SORT_CHANGE})},onColumnSortChange:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_COLUMN_SORT_CHANGE},e)},notifyScrollEnd:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_TREELISTVIEW_SCROLL_END})},onScrollEnd:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_TREELISTVIEW_SCROLL_END},e)},notifyTaggerOpen:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_TAGGER_OPEN})},onTaggerOpen:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_TAGGER_OPEN},e)},notifyTaggerClose:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_TAGGER_CLOSE})},onTaggerClose:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_TAGGER_CLOSE},e)},notifyPageToolBarExpand:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_PAGETOOLBAR_EXPAND})},onPageToolBarExpand:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_PAGETOOLBAR_EXPAND},e)},notifyPageToolBarExpanded:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_PAGETOOLBAR_EXPANDED})},onPageToolBarCollapse:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_PAGETOOLBAR_COLLAPSE},e)},notifyPageToolBarCollapse:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_PAGETOOLBAR_COLLAPSED})},notifyInfoExpand:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_PAGEINFO_EXPAND})},onInfoExpand:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_PAGEINFO_EXPAND},e)},notifyInfoExpanded:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_PAGEINFO_EXPANDED})},notifyInfoCollapse:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_PAGEINFO_COLLAPSE})},onInfoCollapse:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_PAGEINFO_COLLAPSE},e)},notifyInfoCollapsed:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_PAGEINFO_COLLAPSED})},notifyContentReady:function(){this._modelEvents.publish({event:this.EVT_CONTENT_READY})},onContentReady:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_CONTENT_READY},e)},notifyFavoriteSectionEmpty:function(){this._modelEvents.publish({event:this.EVT_FAVORITE_SECTION_EMPTY})},onFavoriteSectionEmpty:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_FAVORITE_SECTION_EMPTY},e)},notifyModeChange:function(e){if(!UWA.is(e,"object"))throw new Error("input parameter should be object");this._modelEvents.publish({event:this.EVT_SWITCH_MODE,data:e})},onModeChange:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_SWITCH_MODE},e)}})}),define("DS/IPClassifyUX/views/additionalData/ThumbnailAttribute",["UWA/Class","DS/IPClassifyUtil/service/IPClassifyUtilWebService","DS/IPClassifyUtil/IPClassifyUtility"],function(e,t,i){"use strict";var n=function(){return"thumbnail"};return e.singleton({init:function(e){this.alwaysUpdate=!0,this._parent(e)},setCheckToShowThumbnail:function(e){this._toShowThumbnailCheck=e},getName:n,getManagedColumnNames:()=>["thumbnail","isThumbnailSet"],toBeUpdated:function(e,t){if(i.isIndexedMode())return!1;if(this._toShowThumbnailCheck){if(!this._toShowThumbnailCheck(this.getName()))return!1}return!e.isThumbnailSet},updateAttributes:function(e,i){t.loadThumbnails({ids:e.pids,onComplete:e=>{if(e){var t=e.results,n={};t&&(t.forEach(function(e){var t=e.attributes,i=null,r=null;t.every(function(e){if("preview_url"===e.name){if(r=(r=e.value).indexOf("snresources")<0?r:null,i||!r)return!1}else if("resourceid"===e.name&&(i=e.value,r))return!1;return!0}),n[i]={isThumbnailSet:!0},i&&r&&(n[i]={thumbnail:"url("+r+")",isThumbnailSet:!0,_root:{thumbnail:r}})}),i({pids:n}))}},onFailure:function(){i({}),console.log("Failure during thumbnail retrieval")}})}})}),define("DS/IPClassifyUX/facets/AttachmentsFacet",["UWA/Core","UWA/Class","UWA/Controls/Abstract","DS/IPClassifyUtil/IPClassifyAlert","DS/EditPropWidget/facets/Common/FacetsBase","DS/ENOXAttachmentsUX/AttachmentsPane","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX"],function(e,t,i,n,r,o,a){return t.extend(i,r,{init:function(e){this._parent(e),this.componentRefresh=!1,this.buildView(e)},buildView:function(t){this.elements.container=e.createElement("div",{class:"attachments"}),this.multiselDisplay=e.createElement("div",{class:"notSupported"}).inject(this.elements.container),this.iconHolder=e.createElement("span",{class:"blockIcon"}).inject(this.multiselDisplay),this.infoMsgH2Tag=e.createElement("h2",{class:"information_msg"}).inject(this.multiselDisplay),this.multiselDisplay.hide();var i={parentObject:{parentId:t.appContext.getDocumentId()},connectorOptions:{fetchSecurityContext:function(){return t.appContext.options.securityContext},platformUrls:t.appContext.options.platformUrls},readonly:t.appContext.readonly};this.attachmentsPane=new o(i),this.attachmentsPane.inject(this.elements.container),this.attachmentsPane.modelEvents.subscribe({event:"context-menu-requested"},function(e){var t;if(e.contextMenu.items.forEach(function(e){e.name&&e.name.startsWith("open-with")&&(t=e)}),t){var i=[];e.contextMenu.items.forEach(function(e){e.parentItemId&&e.parentItemId==t.id&&i.push(e)}),i.length>0&&1==i.length&&"ENXWDOC_AP"==i[0].name&&e.contextMenu.removeItem([t.id,i[0].name])}}),this.attachmentsPane.modelEvents.subscribe({event:"user-selects-files-for-upload"},function(e){t.appContext.isOwnerRole&&(e.cancelled=!0,n.displayNotification({message:a.UploadNewAttachmentActionFail,className:"error"}))}),this.multiselDisplay.isHidden()||this.attachmentsPane.hide()},updateFacet:function(){this.selectionModified(this.options.appContext.getDocumentId())},notApplicable:function(){this.infoMsgH2Tag.setText(this.options.appContext.i18nManager.get("notSupportedSelection")),this.iconHolder.addClassName("wux-ui-3ds wux-ui-3ds-5x wux-ui-3ds-block"),this.multiselDisplay.show(),this.attachmentsPane&&this.attachmentsPane.hide()},selectionModified:function(e){if(e){this.multiselDisplay.hide();var t={parentId:e};this.attachmentsPane&&this.attachmentsPane.getParentObject().parentId!==e&&(this.attachmentsPane.show(),this.attachmentsPane.setParentObject(t)),this.componentRefresh=!0}else this.notApplicable()},onResize:function(){},onRefresh:function(){}})}),define("DS/IPClassifyUX/views/IPClassifyWebInWinTaggerProxy",["DS/SNResultUX/webinwin/WebInWinTaggerProxy","UWA/Core","DS/Core/ModelEvents"],function(e,t,i){"use strict";return e.extend(i,{init:function(e){e.proxyId=e.widgetId+"LibraryEditor_WebInWin",this._parent.call(this,e)},_dispatchEvent:function(e){if(!t.is(e,"object")||!t.is(e.notif_name)||void 0===e.notif_parameters)throw console.log("E_INVALIDARG, expect to have parameters.notif_name arg & parameters.notif_parameters in _dispathTowin !!!"),"No parameters.notif_name arg & parameters.notif_parameters given to _dispathTowin method !";console.log("ResultWebInWin._dispathTowin for "+e.notif_name);var i=t.is(e.notif_parameters,"string")?e.notif_parameters:JSON.stringify(e.notif_parameters);"undefined"!=typeof dscef&&dscef.sendString(e.notif_name+"="+i)}})}),define("DS/IPClassifyUX/service/LibraryDnDService",["UWA/Class","DS/IPClassifyUtil/IPClassifyAlert","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/PADUtils/PADUtilsServices","DS/WidgetServices/WidgetServices","DS/IPClassifyUtil/IPClassifyCommunication"],function(e,t,i,n,r,o){return e.singleton({setDragData:function(e,t,i,n){if(r.isNatifEnvironnement()&&!r.isWebInWinEnvironment()){var a=i.getSelectedNodesID();o.publish("setDragData",{ids:a})}else{var s=i.getSelectedNodes(),l=i.getCurrentObject(),d="";l&&!l.isRoot()&&n.isValidType(l.plmType)&&(d=l.getID());var c={protocol:"3DXContent",version:"1.1",source:"LibraryEditor",widgetId:widget.id,data:{items:[]}},u=widget.getValue("x3dPlatformId");u||(u="OnPremise");var h=widget.getPreference("pad_security_ctx");h&&h.value&&(h=h.value.split("::")[1]);var f=[];s.forEach(function(e){var t={envId:u,serviceId:"3DSpace",contextId:h,objectId:e._options.physicalid,objectType:e._options.type,displayName:e._options.label,displayType:e._options.type,libraryId:d};f.push(t)}),c.data.items=f,e.dataTransfer&&e.dataTransfer.setData&&e.dataTransfer.setData("text/plain",JSON.stringify(c))}},cleanDragData:function(){r.isNatifEnvironnement()&&!r.isWebInWinEnvironment()&&o.publish("cleanDragData")},shouldAcceptDrop:function(){return!1},performDropOnLibraryEditorNode:function(e,n,r){var o=null;try{o=this.retrieveDroppedDataFromDropEvent(n)}catch(e){o=null,t.displayNotification({message:i.msg_warning_dndnotsupported,className:"warning"})}o&&e&&this.processDroppedDataOnLibraryEditorNode(e,o,r)},retrieveDroppedDataFromDropEvent:function(e){for(var t,i=UWA.is(e.dataTransfer.types.indexOf,"function")?"indexOf":"contains",n="",r=["text/searchitems","text/plain","Text"],o=0;o<r.length&&""===n;o++){var a=e.dataTransfer.types[i](r[o]);(UWA.is(a,"number")&&a>=0||UWA.is(a,"boolean")&&!0===a)&&(n=r[o])}if(""===n)throw new Error("Unknown type in DnD");return t=e.dataTransfer.getData(n),JSON.parse(t)},processDroppedDataOnLibraryEditorNode:function(e,r,o){function a(e){if(Array.isArray(e)&&e.length>0)for(var t=n.getPlatformId(),i=e.length-1;i>=0;i--){var r=e[i];if(r&&r.droppedItem_tenantId!==t)return!1}return!0}if(r&&e){var s=this.isExternalDroppedDataOnLibraryEditor(r),l=o.getDroppedData(r),d=l.RootLibrary_itemList,c=l.Library_itemList,u=l.Content_itemList;if(!a(d)||!a(c)||!a(u))return void t.displayNotification({message:i.msg_warning_dndnotsupported_from_different_tenant,className:"warning"});if(o.inFamilyLibrary(e.plmType)){if(Array.isArray(c)&&c.length>0)for(;c.length>0&&c[0];){for(var h=c[0].droppedSourceLibrary_id,f=[],p=c.length-1;p>=0;p--){(g=c[p])?g.droppedSourceLibrary_id===h&&(f.push(g.droppedItem_id),c.splice(p,1)):c.splice(p,1)}o.addClassesInLibrary(e,h,f,s,!1)}if(Array.isArray(u)&&u.length>0)for(;u.length>0&&u[0];){for(h=u[0].droppedSourceLibrary_id,f=[],p=u.length-1;p>=0;p--){var g;(g=u[p])?g.droppedSourceLibrary_id===h&&(f.push(g.droppedItem_id),u.splice(p,1)):u.splice(p,1)}o.addContentInObject(e,h,f,s)}}}else console.warn("  LibraryDnDService processDroppedDataOnLibraryEditorNode invalid argument(s)")},isExternalDroppedDataOnLibraryEditor:function(e){var t=!0;return e&&e.widgetId&&e.widgetId==this.getWidgetId()&&(t=!1),t},getWidgetId:function(){return self.widget.id}})}),define("DS/IPClassifyUX/models/LibraryInfo",["UWA/Controls/Abstract","UWA/Class/Options"],function(e,t){"use strict";var i=e.extend(t,{_id:null,_type:null,_label:null,init:function(e){this._parent(e),this._id=e.id,this._type=e.type,this._label=e.label,this._getChildrenInfos=e.getChildrenInfos},getID:function(){return this._id},getType:function(){return this._type},getLabel:function(){return this._label},getChildrenInfos:function(e){this._getChildrenInfos(this._id).then(function(t){var n=[];t.forEach(function(e){n.push(new i({id:e.getID(),type:e.plmType,label:e.getLabel()}))}),e.onComplete(n)})}});return i}),define("DS/IPClassifyUX/utils/IPClassifyWidgetData",["UWA/Class"],function(e){"use strict";return e.singleton({init:function(e){this._widgetData={currentTab:0}},getWidgetData:function(){return this._widgetData},setCurrentTab:function(e){this._widgetData.currentTab=e||0}})}),define("DS/IPClassifyUX/service/SettingsManagement",["UWA/Class"],function(e){"use strict";return e.singleton({init:function(){this.isPlatformInitialized=!0},addSetting:function(e,t){if(!this.isPlatformInitialized)throw new Error("Platformservices not initialized");widget[e]&&console.log("Setting is already in use"),widget[e]=t},getSetting:function(e){return widget[e]||""},getPlatformURLs:function(){return this.getSetting("platformServices")}})}),define("DS/IPClassifyUX/IPClassifyUXEvents",["UWA/Class","DS/IPClassifyUX/events/IPClassifyEvents"],function(e,t){return e.singleton({notifyLibrarySelected:function(e){t.notifyLibrarySelected(e)},onLibrarySelected:function(e){t.onLibrarySelected(e)},onContentSearchChange:function(e){t.onContentSearchChange(e)},notifyCurrentLibraryChange:function(e){t.notifyCurrentLibraryChange(e)}})}),define("DS/IPClassifyUX/views/LibraryThumbnailGridView",["DS/IPClassifyNav/views/xNavResponsiveThumbnailsView","DS/IPClassifyUX/events/IPClassifyEvents","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX"],function(e,t,i){"use strict";return e.extend({init:function(e){this._parent(e),this.options.grid.infiniteScrolling=!0;var i=this;UWA.is(this.options.grid.onCellDoubleClick,"function")&&this.options.grid.onCellDoubleClick(function(e){var i=e.nodeModel;t.notifyActivateTreeItem({resourceid:i.options.resourceid,mxid:i.options.mxid,type:i.options.type,label:i.options.label})}),this.options.grid.onInfiniteScroll(function(e){e.reachBottom?t.notifyScrollEnd():e.reachRight&&i.options.grid.infiniteScrollProcessDone()}),this.options.grid.getCustomTooltip=(e=>this.showTooltip("ds6w:label",e)+this.showTooltip("ds6wg:revision",e)+this.showTooltip("ds6w:type",e)+this.showTooltip("ds6w:status",e)+this.showTooltip("ds6w:description",e)+this.showTooltip("ds6w:responsible",e)+this.showTooltipDate("ds6w:modified",e)+this.showTooltipDate("ds6w:created",e)+this.showTooltip("ds6w:identifier",e))},showTooltip:(e,t)=>t.options.grid[e]?i.ViewTooltip[e]+":"+t.options.grid[e]+"\n":"",showTooltipDate:(e,t)=>{if(t.options.grid[e]){let r=new Date(Date.parse(t.options.grid[e])),o=r.toLocaleTimeString().replace(/([\d]+:[\d]{2})(:[\d]{2})(.*)/,"$1$3");var n=r.toLocaleString("default",{month:"short"})+" "+r.getUTCDate()+","+r.getUTCFullYear()+", "+o;return i.ViewTooltip[e]+":"+n+"\n"}return""}})}),define("DS/IPClassifyUX/views/LibraryDataGridView",["DS/IPClassifyNav/views/xNavDataGridView","DS/DataGridView/DataGridView","DS/DataGridView/DataGridViewLayout","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUtil/IPClassifyUtility","DS/PADUtils/Configuration","DS/PADServices/utils/GlobalUtils","DS/PADUtils/PADCommandProxy","DS/PADServices/utils/AttributesMgtV2","DS/PADServices/utils/GlobalModelEvents","DS/IPClassifyUtil/IPClassifyPreference","UWA/Controls/Abstract","DS/Core/PointerEvents"],function(e,t,i,n,r,o,a,s,l,d,c,u,h){"use strict";var f={GRIDVIEWID:"ipcGridViewID_v1"},p=u.extend({name:"LibraryDataGridView",init:function(e){this._parent(e),this.onContextualMenuReady=e.context.onContextualMenuReady,this.gridPlaceHolder=e.context.getPlaceHolder(),this.dataProvider=e.context.dataProvider},initialize:function(){var e=this;return new Promise(function(r){var a=UWA.clone(o.getConfig("dgvOptions"));e.options.viewMode=a.viewMode,e.options.clickEvent=null;var l=e.fetchGridViewID(),c=[e.buildDGVOpts(),l];Promise.all(c).then(function(o){var l=o[0],c=o[1],u=UWA.extend({identifier:"DataGridView-"+e.name+"-"+c},l);if("undefined"!==a.dgvLayout){var f=UWA.clone(a.dgvLayout);void 0!==l.defaultCellHeight&&(f.cellHeight=l.defaultCellHeight,delete l.defaultCellHeight),void 0!==l.rowsHeader&&(f.rowsHeader=l.rowsHeader,delete l.rowsHeader),u.layout=e.options.dgvLayout=new i(f),u.layout.useLastColumnWidthAutoFlag=!0}u.onContextualEvent=e.onContextualMenuReady,u.getCellTooltip=e._provideDisplayTooltip.bind(e),u.columnDragEnabledFlag=!1,u.placeholder=e.gridPlaceHolder,u.defaultColumnDef.allowUnsafeHTMLContent=!1,e.options.dataGridPlaceHolder=u.placeholder,e.options.viewMode=l.viewMode?l.viewMode:"comfortable";var p=e.options.dgv=new t(u);if(e.options.additionalColumnsModules)for(var g=0;g<e.options.additionalColumnsModules.length;g++)if(e.options.additionalColumnsModules[g].getTypeRepresentations){var m=e.options.additionalColumnsModules[g].getTypeRepresentations();p.getTypeRepresentationFactory().registerTypeRepresentations(JSON.stringify(m))}if(["ctrl+a","alt+return","ctrl+f","f2"].forEach(function(e){p._keymapManager.registerKeymap(e,void 0)}),p.addEventListener(h.POINTERHIT,function(e,t){if(2===e.multipleHitCount){var i=p.layout.getColumnIndex("tree");if(t&&t.columnID==i&&t.nodeModel&&t.nodeModel.isFavorite){var r=p.layout.getCellsFromNodeModel(t.nodeModel)[i],o=p.getEditionManager(r);o.onEscape&&o.onEscape(r)}if(t&&t.nodeModel){var a=t.nodeModel;n.notifyActivateTreeItem({resourceid:a.options.physicalid,mxid:a.options.mxid,type:a.plmType,label:a.options.label})}}}),p._modelEvents.subscribe({event:"READY"},function(){n.notifyContentReady(),e.setSortingForComputedAttrs()}),p.addEventListener("sortModelChange",function(){n.notifyColumnSortChange()}),p.onDelayedModelDataRequest){var v=p.onDelayedModelDataRequest;p.onDelayedModelDataRequest=function(t){e.dataProvider.updateAttributesDelayedForUnits&&e.dataProvider.updateAttributesDelayedForUnits(t,e.getManager()),v(t)}}p.onInfiniteScroll(function(e){e.reachBottom?n.notifyScrollEnd():e.reachRight&&p.infiniteScrollProcessDone()}),e._commandProxy=s.create(),p.getContent().addClassName(e.name),e.options.renderTo&&!0===e.options.isActiveView&&p.inject(e.options.renderTo),d.getModelEvents().subscribe({event:"IPClassifyColumnCusto/AttributesCustomization/columnModification"},function(t){switch(t.what){case"addRemoveColumns":t.removedColumns&&e.removeColumn(t.removedColumns),t.addedColumns&&e.addColumn(UWA.clone(t.addedColumns));break;case"reset":e.resetColumn()}}),r()})})},fetchGridViewID:function(){return new Promise(function(e){widget&&widget.id?e(widget.id):c.get(f.GRIDVIEWID,function(t){if(t&&t.GridViewID)e(t.GridViewID);else{var i=a.uid();c.set(f.GRIDVIEWID,{GridViewID:i},!1),e(i)}},!1)})},_provideDisplayTooltip:function(e){if(e&&e.rowID<0&&this.dataProvider.getTooltipIfDynamicColumn){var t=this.options.dgv.getColumnOrGroup(e.columnID),i=this.dataProvider.getTooltipIfDynamicColumn(e,t);if(i)return{longHelp:i}}return this.options.dgv.getCellDefaultTooltip(e)},getManager:function(){return this.options.dgv},addColumn:function(e){this.dataProvider.onAddColumn&&this.dataProvider.onAddColumn(e),n.notifyCurrentLibraryColumnChange()},removeColumn:function(e){this.dataProvider.onRemoveColumn&&this.dataProvider.onRemoveColumn(e)},resetColumn:function(e){this.dataProvider.onResetColumn&&this.dataProvider.onResetColumn(l.getAvailableColumnsOpts(),l.getTreeColumn()),n.notifyCurrentLibraryColumnChange()},getDefaultSortModel:function(){var e=this.getManager(),t=[];if(e)for(var i=e.layout.getLeafColumns(),n=0;n<i.length;++n){var r=i[n];r.defaultSortOrder&&(t=[{dataIndex:r.dataIndex,sort:r.defaultSortOrder}])}return t},getSortingOrder:function(e){var t={},i=this.getManager(),n=this.getDefaultSortModel(),r=null,o=null;if(n.length>0&&(r=n[0].dataIndex,o=n[0].sort),i){var a=i.sortModel,s=r,l=o;a&&a.length>0&&null!=a[0].dataIndex&&null!=a[0].dataIndex?(s=a[0].dataIndex,l=a[0].sort):this._setColumnOrderState(s,l),t.order_by=l;var d=i.layout.getLeafColumns()[i.layout.getColumnIndex(s)];d?d.isHidden?this._setColumnOrderState(r,o):(d.dataIndex&&(t.order_field=d.dataIndex,"tree"===d.dataIndex&&(t.order_field=d.ds6w)),e&&d.dbAttribute&&(t.order_field=d.dbAttribute)):r&&(this._setColumnOrderState(r,o),t.order_by=o,t.order_field=r)}return t},setSortingForComputedAttrs:function(){for(var e=r.isIndexedMode(),t=["tree","ds6w:description"],i=!!e,n=0;n<t.length;++n)this._setColumnSortable(t[n],i);var o,a=[];if(this.dataProvider.getAuthModeNoSortColumns&&(a=this.dataProvider.getAuthModeNoSortColumns(this.getManager().layout.getLeafColumns())),!1===e){var s=this.getSortingOrder(!0).order_field;if("ds6w:label"===(o=s)||"tree"===o||"ds6w:description"===o||-1!==a.indexOf(s)){var l=this.getDefaultSortModel();l.length>0&&this._setColumnOrderState(l[0].dataIndex,l[0].sort)}}var d=this,c=["thumbnail"];a.forEach(function(e){c&&-1!==c.indexOf(e)||d._setColumnSortable(e,i)})},_setColumnSortable:function(e,t){var i=this.getManager(),n=i.layout.getColumnIndex(e);if(!(n<0||null==n)){var r=i.layout.getLeafColumns();r[n].sortableFlag!==t&&(r[n].sortableFlag=t)}},setTreeColumnEditable:function(e){var t=this.getManager(),i=t.layout.getColumnIndex("tree");if(!(i<0)){var n=t.layout.getLeafColumns();n[i].editableFlag!==e&&(n[i].editableFlag=e)}},_setColumnOrderState:function(e,t){var i=this.getManager();i.sortModel=[{dataIndex:e,sort:t}],i.layout._saveColumnSortModelInPreferences()},setColumnOrderState:function(e){var t=this.getManager();t.sortModel=e,t.layout._saveColumnSortModelInPreferences()},getDatagridPlaceHolder:function(){return this.options.dataGridPlaceHolder},removeColumnPreferences:function(e){if(e&&0!==e.length){var t=this.getManager(),i=t.layout._getUnpinnedColumnsOrderInPreferences();if(i){for(var n=0;n<e.length;++n)delete i[e[n]];t.layout._saveDataInPreferences("unpinnedColumnsOrder",i)}}},isColumnAvailable:function(e){return this.getManager().layout.getColumnVisibleState(e)}}),g=p.prototype.initialize;return p.prototype=Object.assign(p.prototype,e.prototype),p.prototype.initialize=g,p}),define("DS/IPClassifyUX/views/LibraryTileGridView",["DS/IPClassifyNav/views/xNavResponsiveTilesView","DS/IPClassifyUX/events/IPClassifyEvents","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX"],function(e,t,i){"use strict";return e.extend({init:function(e){this._parent(e),this.options.grid.infiniteScrolling=!0;var i=this;UWA.is(this.options.grid.onCellDoubleClick,"function")&&this.options.grid.onCellDoubleClick(function(e){var i=e.nodeModel;t.notifyActivateTreeItem({resourceid:i.options.resourceid,mxid:i.options.mxid,type:i.options.type,label:i.options.label})}),this.options.grid.onInfiniteScroll(function(e){e.reachBottom?t.notifyScrollEnd():e.reachRight&&i.options.grid.infiniteScrollProcessDone()}),this.options.grid.getCustomTooltip=(e=>this.showTooltip("ds6w:label",e)+this.showTooltip("ds6wg:revision",e)+this.showTooltip("ds6w:type",e)+this.showTooltip("ds6w:status",e)+this.showTooltip("ds6w:description",e)+this.showTooltip("ds6w:responsible",e)+this.showTooltipDate("ds6w:modified",e)+this.showTooltipDate("ds6w:created",e)+this.showTooltip("ds6w:identifier",e))},showTooltip:(e,t)=>t.options.grid[e]?i.ViewTooltip[e]+":"+t.options.grid[e]+"\n":"",showTooltipDate:(e,t)=>{if(t.options.grid[e]){let r=new Date(Date.parse(t.options.grid[e])),o=r.toLocaleTimeString().replace(/([\d]+:[\d]{2})(:[\d]{2})(.*)/,"$1$3");var n=r.toLocaleString("default",{month:"short"})+" "+r.getUTCDate()+","+r.getUTCFullYear()+", "+o;return i.ViewTooltip[e]+":"+n+"\n"}return""}})}),define("DS/IPClassifyUX/models/LibrarySearchModel",["UWA/Class","DS/IPClassifyUX/events/IPClassifyEvents"],function(e,t){"use strict";return e.singleton({init:function(){this._currentSearch=null,this._indexInfo=null,this._lListener=[]},onSearchChange:function(e){"function"==typeof e&&this._lListener.push(e)},_notifyChange:function(e){if(this.isSearchActive()||e){var i=this;e||(e=i._currentSearch),this._lListener.forEach(function(e){e.call(null,i._currentSearch)}),t.notifyContentSearchChange()}},changeSearch:function(e,t){if(""===e&&(e=null),this._currentSearch!==e||!e){this.setInfoIndex(null,!e);var i=this._currentSearch;this._currentSearch=e,this._notifyChange(i)}},clearSearch:function(){this.changeSearch("",!0)},setInfoIndex:function(e,i){if(this._indexInfo=e,!1!==i){var n=null;e&&((n={}).numberHits=this.getNumberHits(),n.dateIndex=this.getDateLastIndexation()),t.notifyContentSearchResult(n)}},getInfoIndex:function(){return this._indexInfo},getNumberLastResult:function(){return this._indexInfo?this._indexInfo.nresults:0},getNumberHits:function(){return this._indexInfo?this._indexInfo.nhits:0},getDateLastIndexation:function(){var e=null,t=this.getInfoIndex();if(t&&t.sources){var i=null;t.sources.forEach(function(e){if(e.indexingDate)var t=e.indexingDate;for(var n in t)t[n]&&-1!==t[n]&&(i?t[n]<i&&(i=t[n]):i=t[n])}),i&&(e=new Date(1e3*i))}return e},isSearchActive:function(){return!!this.getSearchValue()},isSearchInProgress:function(){return this._indexInfo&&this._currentSearch},getSearchValue:function(){return this._currentSearch}})}),define("DS/IPClassifyUX/utils/IPClassifyModeManager",["UWA/Utils","UWA/Core","UWA/Class","DS/IPClassifyUtil/IPClassifyAlert","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUtil/IPClassifyUtility","DS/PADUtils/PADSession","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX"],function(e,t,i,n,r,o,a,s){"use strict";var l=null;return i.singleton({init:function(e){this._parent(e),this.staleContentAfterSilentSwitch=!1,this.modeInformation={last_refreshed:(new Date).getTime()}},isModeSwitcherEnabled:function(){return this.modeSwitcherEnabled},determineAuthoringMode:function(){return o.determineAuthoringMode()},_isUsingIndex:function(){return"index"===this.determineAuthoringMode()},_getWaitingTimeBeforeSwitchToIndexMode:function(){return parseInt(widget.getValue("intervalToSwitchMode"))},determineCurrentModeState:function(){var e=this.determineAuthoringMode();const t=this._getWaitingTimeBeforeSwitchToIndexMode();return"authoring"!==e||widget.getValue("useIndexAccleration")?"authoring"!==e||t||(e="neverIndexMode"):e="useOnlyAuthoring",e},getFullViewLoadInfo:function(){return this.modeInformation},setAuthoringMode:function(e,t,i,o){var d=this,c=this._getWaitingTimeBeforeSwitchToIndexMode(),u=c||.02;if(i){const e=widget.getValue("IPClassify_ModeInfo")||{};if(e&&UWA.is(e.last_editing,"number")){const t=(new Date).getTime();var h=(e.last_editing+1e3*c-t)/1e3;h>0&&(u=h)}}else{if(t)if(this._isUsingIndex()&&"authoring"===e&&(c||0===c))if("none"===t)n.displayNotification({title:s.get("msg_database_mode_activated"),subtitle:s.get("msg_database_mode_activated_details")+" "+s.get("msg_tagger_not_available"),className:"info"});else{var f=s.get("msg_database_mode_activated")+"<br>"+s.get("msg_database_mode_activated_details")+" "+s.get("msg_tagger_not_available");n.displayNotification({title:t,subtitle:f,className:"success"})}else"none"!==t&&n.displayNotification({message:t,className:"success"});var p={state:e,last_editing:(new Date).getTime()};widget.setValue("IPClassify_ModeInfo",p),r.notifyModeChange({switchMode:e}),o||("authoring"===e?(d.updateTaggerAndComputeColumns(!1),a.setAuthoringState(!0)):(d.updateTaggerAndComputeColumns(!0),a.setAuthoringState(!1)))}l&&(clearTimeout(l),l=null);var g=d.determineCurrentModeState();"authoring"===e&&c&&"useOnlyAuthoring"!==g&&(l=setTimeout(function(){n.displayNotification({title:s.get("msg_index_mode_activated"),subtitle:s.get("msg_index_mode_activated_details"),className:"info"}),r.notifyModeChange({switchMode:"index"}),d.updateTaggerAndComputeColumns(!0),a.setAuthoringState(!1),d.staleContentAfterSilentSwitch=!0,l=null},1e3*u))},updateRefreshTime:function(){var e={staleContentAfterSilentSwitch:!1,modeInformation:{last_refreshed:(new Date).getTime()}};r.notifyupdateRefreshTime(e)},updateLastIndexTime:function(e){e&&e.sources&&(this._lastIndexedData=e)},getLastIndexedTime:function(){if(this._lastIndexedData){var e=this.extractLastIndexation(this._lastIndexedData);if(e&&null!=e)return this._previousIndexTime=e,e}return this._previousIndexTime||s.text_not_available},extractLastIndexation:function(e){var t=null;if(e&&e.sources){var i=null;if(e.sources.forEach(function(e){if(e.indexingDate)var t=e.indexingDate;for(var n in t)t[n]&&-1!==t[n]&&(i?t[n]<i&&(i=t[n]):i=t[n])}),i){var n=new Date(1e3*i),r="";if(n){var o=new Date;r=(o-n)/1e3/3600>24||n.getDay()!=o.getDay()?n.toLocaleString():n.toLocaleTimeString()}t=r}}return t},addModeIntervalPreferences:function(e){var t=this;t.modeSwitcherEnabled=!0,t.refreshViewOfWidget=e.refreshView,t.updateTaggerAndComputeColumns=e.updateTaggerAndComputeColumns,widget.addPreference({name:"useIndexAccleration",defaultValue:!0,type:"boolean",label:"useIndexAccleration_label",onchange:"onUseOnlyDBChange"}),widget.addEvent("onUseOnlyDBChange",t.onUseOnlyDBChange.bind(t)),t.setIntervalSwitch(),widget.addEvent("endEdit",function(e){if(!(!e||!e.submitted&&!e.needRefresh)){var i=widget.getValue("useIndexAccleration")?"index":"authoring";t.setAuthoringMode(i,!1,!1,!0)}t.setIntervalSwitch()})},setIntervalSwitch:function(e){var t={name:"intervalToSwitchMode",defaultValue:"180",type:"list",label:"label_interval_to_switch_mode",options:[{label:"label_back2index_time_never",value:"0"},{label:"label_back2index_time_one_min",value:"60"},{label:"label_back2index_time_three_mins",value:"180"},{label:"label_back2index_time_five_mins",value:"300"},{label:"label_back2index_time_ten_min",value:"600"}]};e||widget.getValue("useIndexAccleration")||(t.disabled="true"),widget.addPreference(t)},onUseOnlyDBChange:function(e,t){this.setIntervalSwitch(t),widget.dispatchEvent("onEdit")}})}),define("DS/IPClassifyUX/views/LibraryTreeDocumentView",["DS/Logger/Logger","DS/IPClassifyNav/models/xNavDocument","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/PADUtils/PADProbes","DS/PADUtils/PADUtilsServices","DS/WebappsUtils/WebappsUtils","DS/WidgetServices/WidgetServices","DS/PADUtils/PADContext","DS/PADUtils/PADPredicatesNls"],function(e,t,i,n,r,o,a,s,l,d){"use strict";var c=t.extend({name:"LibraryTreeDocumentView",_doNotAddLibrary:!1,init:function(t){t.authorize_setStructure=!0,this._parent(t),this.onNodeModelUpdate(widget.TreeDocumentDataProvider.onContentUpdate),this._logger=e.getLogger(c),this._logger.log("init");var i=this;this.selection_broadcast_fn=function(){if(!i._doNotAddLibrary){var e=i.getXSO().get();if(e&&e.length>0){var t=e[0];t.getID||(t.getID=function(){return this.id}),t.getType||(t.getType=function(){return this.plmType})}widget.TreeDocumentCSOProvider&&widget.TreeDocumentCSOProvider.addInCSO(e,"CONTENT")}},this.getXSO().onChange(i.selection_broadcast_fn),this.getXSO().onEmpty(function(){i._doNotAddLibrary=!1,i.selection_broadcast_fn()}),this.getXSO().onPreEmpty(function(){i._doNotAddLibrary=!0})},_buildSelectData:function(){var e=this._parent();if(e){var t=widget.TreeDocumentCSOProvider.getCurrentObject();if(Array.isArray(e.paths)&&e.paths.length>=1){if(t&&widget.TreeDocumentDataProvider.isValidType(t.plmType)){for(var i=widget.TreeDocumentCSOProvider.getCurrentObjectPath(),n=[],r=Array.isArray(i)?i.length:0,o=0;o<r;o++)n.push({resourceid:i[o].id,type:i[o].type});e.libraryPath=n}}else if(t&&widget.TreeDocumentDataProvider.isValidType(t.plmType)){i=widget.TreeDocumentCSOProvider.getCurrentObjectPath();var a=[];for(r=Array.isArray(i)?i.length:0,o=0;o<r-1;o++)a.push({resourceid:i[o].id,type:i[o].type});var s={};if(r>=1){var l=r-1;i[l].id&&(s[i[l].id]={type:i[l].type,label:i[l].label})}e.paths=[[t.id]],e.attributes=s,e.libraryPath=a}}return e},withBroadcastSelect:function(e){this.prepareBroadcastSelect(),e(),this.pushBroadcastSelect()},prepareBroadcastSelect:function(){this._doNotAddLibrary=!0,this._parent()},pushBroadcastSelect:function(){this._doNotAddLibrary=!1,this.selection_broadcast_fn(),this._parent()},keepExpandedState:function(){for(var e=this.getRoots(),t=0;t<e.length;t++)if(e[t].isExpanded()){libraryContent._refreshProductStructure=!0;break}},refreshNodeById:function(e){var t=this,r=n.isModeSwitcherEnabled();if((!r||widget.id!==e.widgetId)&&i.isIndexedMode())return;var o=e.modified;e.modified=[];var a=e.fromRenameOp;if(o.length>0){var s=l.get(),c=s.options.views?s.options.views.datagridview:null,u=c?c.options.dgvLayout.getLeafColumns():null;widget.TreeDocumentDataProvider&&widget.TreeDocumentDataProvider.getObjectsForRefresh&&u&&widget.TreeDocumentDataProvider.getObjectsForRefresh(o,u).then(function(i){i&&i.length>0&&(r&&!a&&widget.id===e.widgetId&&(n.setAuthoringMode("authoring","none"),n.updateRefreshTime()),i.forEach(function(e){var i=t.searchRootById(e.physicalid);i&&(t.wrapInTransaction(function(){i.updateOptions(e)}),!0===i.options._manageNLS&&d.updateNLS(i))}))})}this._parent(e)}});return c}),define("DS/IPClassifyUX/models/LibraryIdCardModel",["UWA/Class","DS/IPClassifyUX/models/LibraryInfo"],function(e,t){"use strict";var i=e.singleton({_currentPathNodes:null,getNewPathNodes:function(e){this._currentPathNodes=[];var i=e.CSOProvider.getCurrentObjectPath();if(i&&i.length>0)for(var n=i.length-1;n>=0;--n){var r=i[n];this._currentPathNodes.push(new t({id:r.id,mxid:r.mxid,type:r.type,label:r.label,getChildrenInfos:e.getChildrenInfos}))}return this._currentPathNodes},getPathNodes:function(){return this._currentPathNodes}});return{getNewPathNodes:i.getNewPathNodes.bind(i),getPathNodes:i.getPathNodes.bind(i)}}),define("DS/IPClassifyUX/models/LibraryTreeModel",["UWA/Class","DS/IPClassifyUtil/IPClassifyPreference","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/IPClassifyUtil/IPClassifyUtility","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/IPClassifyUtil/IPClassifyAlert"],function(e,t,i,n,r,o){"use strict";var a,s,l,d,c,u,h=(a={},{toFetchDataFromCache:function(e){var t=a[e];return null!=t},clean:function(){a={}},children:function(e){var t=a[e];if(t){var i=[];for(var n in t)t.hasOwnProperty(n)&&i.push(t[n]);t=i}return a[e]=null,t},updateCache:function(e,t,i){if(e&&t&&!(e.length<=0)){for(var n=[],r=0;r<e.length;++r)for(var o=e[r],s=1;s<o.length;++s){var l=o[s-1],d=t[o[s]],c=o[s];a[l]?a[l][c]=d:(a[l]={},a[l][c]=d),s===o.length-1&&-1===i&&n.push(o[s])}-1===i&&(i=n);for(var u=0;u<i.length;++u){var h=i[u];a[h]||(a[h]={})}}}}),f={TREE_SELECTED_NODE:"ipcTreeSelectedNode_v1",TREE_STRUCTURE:"ipcTreeStrucure_v1",getTreeSelectedNode:function(){return n.getTenantAwarePreferenceName(this.TREE_SELECTED_NODE)},getTreeStructure:function(){return n.getTenantAwarePreferenceName(this.TREE_STRUCTURE)}},p=(s=function(){return{e:!0,c:{}}},l=function(e){return e||(e={root:s()}),e},d={_items:[],_isProcessing:!1,OPERATIONS:{ADD:"add",REMOVE:"remove"},_process:function(){var e=this;if(0!=this._items.length){var t=this._items[0];this._items.shift(),t.operation==e.OPERATIONS.ADD?c(t.pathId,t.childIds,function(){e._process()}):t.operation==e.OPERATIONS.REMOVE&&u(t.pathId,function(){e._process()})}else this._isProcessing=!1},add:function(e){this._items.push(e),0==this._isProcessing&&(this._isProcessing=!0,this._process())}},c=function(e,i,n){t.get(f.getTreeStructure(),function(r){var o=r=l(r),a=e.split(","),d=a.splice(a.length-1)[0];if(a.forEach(function(e){o[e]||(o[e]=s()),o=o[e].c}),o[d]||(o[d]=s()),o[d].e=!0,UWA.is(i,"array")){var c=o[d].c,u={};i.forEach(function(e){c[e]&&(u[e]=c[e])}),o[d].c=u}t.set(f.getTreeStructure(),r),n()})},u=function(e,i){t.get(f.getTreeStructure(),function(n){var r=n=l(n),o=e.split(","),a=o.splice(o.length-1)[0];o.forEach(function(e){r[e]||(r[e]=s()),r=r[e].c}),r[a]||(r[a]=s()),r[a].e=!1,0===r[a].c.length&&delete r[a],t.set(f.getTreeStructure(),n),i()})},{add:function(e,t){d.add({pathId:e,childIds:t,operation:d.OPERATIONS.ADD})},remove:function(e){d.add({pathId:e,operation:d.OPERATIONS.REMOVE})},addExpandAllPaths:function(e,i){i.length<=0||t.get(f.getTreeStructure(),function(n){var r=n=l(n),o=e.split(","),a=o.splice(o.length-1)[0];o.forEach(function(e){r[e]||(r[e]=s()),r=r[e].c}),r[a]=s();for(var d=0;d<i.length;++d)for(var c=r,u=i[d],h=1;h<u.length;++h){var p=u[h],g=u[h-1];c[g].c[p]||(c[g].c[p]=s()),c=c[g].c}t.set(f.getTreeStructure(),n)})},isExpanded:function(e,i){t.get(f.getTreeStructure(),function(t){var n=t=l(t),r=e.split(","),o=r.splice(r.length-1)[0];r.forEach(function(e){n[e]||(n[e]=s()),n=n[e].c});var a=!1;n[o]&&void 0!==n[o].e&&(a=n[o].e),i.call(window,a)})},select:function(e){var i={path:e};t.set(f.getTreeSelectedNode(),i)},isSelected:function(e,i,n){t.get(f.getTreeSelectedNode(),function(t){var r=!0;t&&(t=t.path),t||e!=="root,"+i?t!=e&&(r=!1):r=!0,n.call(window,r)})},getExpandedChildren:function(e,i){t.get(f.getTreeStructure(),function(t){var n=[],r=t=l(t),o=e.split(","),a=o.splice(o.length-1)[0];o.forEach(function(e){r[e]||(r[e]=s()),r=r[e].c});var d=[];d.push(r[a]);for(var c=0;c<d.length;++c){var u=d[c];if(u)for(var h in u.c)u.c.hasOwnProperty(h)&&!0===u.c[h].e&&(n.push(h),0!=Object.keys(u.c[h].c).length&&d.push(u.c[h]))}i.call(window,n)})},scrollAfterSelect:function(e){widget.setValue("scrollToNode",e)},doScrollAfterSelect:function(e){return widget.getValue("scrollToNode")===e}}),g=e.singleton({setExpandAllOperation:function(e){this._expandAllOp=!1,e&&!0===e&&(this._expandAllOp=!0)},_isOperationExpandAll:function(){return this._expandAllOp},fetchLibraryContents:function(e,t){var i=this;return new Promise(function(n,r){if(h.toFetchDataFromCache(e.parentNodeID)){var o=h.children(e.parentNodeID);n(o)}else h.clean(),i._isOperationExpandAll()?i._expand(e,null,t).then(function(e){n(e)},function(e){r(e)}):p.getExpandedChildren(e.parentPath,function(o){i._expand(e,o,t).then(function(e){n(e)},function(e){r(e)})})})},_expand:function(e,t,i){var n=this;return new Promise(function(r,o){i({pid:e.parentNodeID,mxid:e.parentNodeMXID,children:t,isExpandAll:n._isOperationExpandAll()}).then(function(i){i.paths&&i.paths.length<=0&&i.objects&&i.objects.length<=0?r([]):(n._isOperationExpandAll()&&(t=-1,p.addExpandAllPaths(e.parentPath,i.paths)),h.updateCache(i.paths,i.objects,t),i.childIds?(p.add(e.parentPath,i.childIds),r(i.objects)):r(h.children(e.parentNodeID)))},function(e){o(e)})})},fetchAllLibraries:function(e,t){var n=this;return new Promise(function(a,s){t().then(function(t){if(t&&t.infos&&(i.updateLastIndexTime(t.infos),t.infos.sources&&t.infos.sources.length>0&&t.infos.sources[0].error)){var s=t.infos.sources[0],l=s.error.errorMessage;console.error("Error with federated search: ["+s.error.errorCode+"] "+l),o.displayNotification({title:r.msg_error_with_federated_search_title,message:r.msg_error_with_federated_search_message,className:"error"})}n._isOperationExpandAll()&&p.add(e,t.ids),a(t.objects)},function(e){s(e)})})},getFavorites:function(e,i){function n(e){return e.id}t.get(e.getPreferenceSectionName(),function(r){r&&r.length>0?e.getPreferenceSectionContents({ids:r.map(n)}).then(function(n){var o=[],a=!1;n.length!==r.length&&(a=!0);for(var s=0;s<n.length;++s){for(var l=0;l<r.length;++l)r[l].id===n[s].physicalid&&(n[s].label=r[l].name);a&&o.push({id:n[s].physicalid,name:n[s].label})}if(a&&t.set(e.getPreferenceSectionName(),o,!1,!1),i.onComplete){var d=n,c=r.slice(),u=[];function h(e){for(var t=0;t<d.length;t++)d[t].physicalid===e&&d.splice(t,1)}for(var f=0;f<c.length;f++)n.forEach(function(e,t){e.physicalid===c[f].id&&(u.push(e),h(e.physicalid))});d.length>0&&d.forEach((e,t)=>{u.concat(e)}),i.onComplete(u)}},function(e){i.onFailure&&i.onFailure(e)}):i.onComplete&&i.onComplete([])},!1,!1)},setFavorites:function(e,i){function n(e){for(var t=0;t<this.length;++t)if(this[t].id==e.id)return!1;return!0}function r(e){return e.id}var o=Array.isArray(i.favoriteLibraries)?i.favoriteLibraries:[i.favoriteLibraries];t.get(e.getPreferenceSectionName(),function(a){if((a=Array.isArray(a)?a:[]).length>0){if(!0===i.renamed)for(var s=0;s<a.length;++s)for(var l=0;l<o.length;++l){a[s].id===o[l].id&&(a[s].name=o[l].name);break}o=o.filter(n,a)}a=a.concat(o),t.set(e.getPreferenceSectionName(),a,!1,!1),o.length>0?e.getPreferenceSectionContents({ids:o.map(r)}).then(function(e){i.onComplete&&i.onComplete(e)},function(e){i.onFailure&&i.onFailure(e)}):i.onComplete&&i.onComplete([])},!1,!1)},reorderFavoritePreference:function(e,i){var n=Array.isArray(i.favoriteLibraries)?i.favoriteLibraries:[i.favoriteLibraries];t.set(e.getPreferenceSectionName(),n,!1,!1),n.length>0?e.getPreferenceSectionContents({ids:n.map(function(e){return e.id})}).then(function(e){i.onComplete&&i.onComplete(e)},function(e){i.onFailure&&i.onFailure(e)}):i.onComplete&&i.onComplete([])},removeFromFavorites:function(e,i){function n(e){for(var t=0;t<this.length;++t)if(this[t]==e.id)return!1;return!0}var r,o=Array.isArray(i.favoritesToRemove)?i.favoritesToRemove:[i.favoritesToRemove];t.get(e.getPreferenceSectionName(),function(a){a.length>0&&(r=1!==a.length,a=a.filter(n,o)),t.set(e.getPreferenceSectionName(),a,!1,!1),i.onComplete&&i.onComplete(r)},!1,!1)},getLibraryPathLength:function(e,t){e({ids:[t.pid]}).then(function(e){t.onComplete&&t.onComplete(e)},function(e){t.onFailure&&t.onFailure(e)})},getLibraryPath:function(e,t){e({depth:t.depth,pid:t.pid}).then(function(e){t.onComplete&&t.onComplete(e)},function(e){t.onFailure&&t.onFailure(e)})},libraryStructurePreference:p});return{setExpandAllOperation:g.setExpandAllOperation.bind(g),fetchLibraryContents:g.fetchLibraryContents.bind(g),fetchAllLibraries:g.fetchAllLibraries.bind(g),getFavorites:g.getFavorites.bind(g),setFavorites:g.setFavorites.bind(g),removeFromFavorites:g.removeFromFavorites.bind(g),libraryStructurePreference:g.libraryStructurePreference,getLibraryPathLength:g.getLibraryPathLength.bind(g),getLibraryPath:g.getLibraryPath.bind(g),reorderFavoritePreference:g.reorderFavoritePreference.bind(g)}}),define("DS/IPClassifyUX/views/LibrarySearchInContext",["UWA/Core","UWA/Controls/Abstract","DS/UIKIT/Autocomplete","DS/IPClassifyUX/models/LibrarySearchModel","DS/UIKIT/Tooltip","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUtil/IPClassifyAlert","i18n!DS/SNResultUX/assets/nls/SNResultUX","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX"],function(e,t,i,n,r,o,a,s,l){"use strict";var d=13,c=38,u=40,h=function(){if(!e.is(localStorage.LibSearchBoxStore)){localStorage.LibSearchBoxStore=JSON.stringify([])}return{insertSuggestion:function(t){if(null!=t&&null!=t&&""!=t&&e.is(localStorage.LibSearchBoxStore)){var i=JSON.parse(localStorage.LibSearchBoxStore);if(-1===i.indexOf(t))i.length>=100&&i.shift(),i.push(t),localStorage.LibSearchBoxStore=JSON.stringify(i);else if(i.indexOf(t)>-1){var n=i.indexOf(t),r=i[n];i.splice(n,1),i.push(r),localStorage.LibSearchBoxStore=JSON.stringify(i)}}},getSuggestions:function(t,i){var n=[];if(e.is(localStorage.LibSearchBoxStore))for(var r=JSON.parse(localStorage.LibSearchBoxStore),a=r.length-1;a>=0&&n.length!=i;--a){var s=r[a];if(null!=s&&null!=s&&""!=s&&s.toLowerCase().startsWith(t.toLowerCase())){var l={};l.label=s,l.value=s,l.id=o.stringEncode(s),n.push(l)}}return n}}}();return t.extend({switchSearch:function(e){e?this._showSearchInput():this._hideSearchInput(!0)},_hideSearchInput:function(e){e&&this.getValue()&&this.clearValue(),this.getValue()||(this.elements.inputHolder.show(),this.elements.input.hide(),this.dispatchEvent("onSearchSwitch",!1))},_showSearchInput:function(){this.elements.input.show(),this.elements.inputHolder.hide(),this.dispatchEvent("onSearchSwitch",!0)},init:function(e){var t=this;this._parent(e),this._placeholder=null;var o=document.querySelectorAll(".searchInContext_container");if(o&&o.length>0){var f=Array.prototype.slice.call(o);f&&f.forEach(function(e){e.remove()})}this.elements.container=UWA.createElement("div",{class:"searchInContext_container"}),this.elements.inputHolder=new UWA.createElement("div",{class:"searchInContext_holder fonticon-2x fonticon fonticon-search",attributes:{title:l.get("searchInLibrary_search")},events:{click:function(){t._showSearchInput()}}}).inject(this.elements.container),new r({position:"left",target:this.elements.inputHolder}),this.elements.input=new i({multiSelect:!1,className:"ipc-searchwithin",showSuggestsOnFocus:!1,placeholder:"Search In Context",disabled:!1,allowFreeInput:!0,minLengthBeforeSearch:3,maxSuggestsToDisplay:4,noResultsMessage:null,events:{onSelect:function(e,i){this.resetCache(),h.insertSuggestion(e.value),t._launchSearch(e.value)},onKeyDown:function(e){this.resetCache();var i=e.which;e.ODTENVKeyName&&(i=e.ODTENVKeyName),i===d?(this._updateKeyboardIndex("reset"),this.dispatchEvent("onHideSuggests"),this.elements.input.value&&1==this.elements.input.value.trim().length?a.displayNotification({message:s.warning_twochars,className:"error"}):(h.insertSuggestion(this.elements.input.value),t._launchSearch(this.elements.input.value))):i===c?(this._updateKeyboardIndex("up"),this.elements.input.value=this._getActiveItem().value,this._updateKeyboardIndex("down")):i===u&&(this._updateKeyboardIndex("down"),this.elements.input.value=this._getActiveItem().value,this._updateKeyboardIndex("up"))},onClickOutside:function(e){null!=this.elements.input.value&&null!=this.elements.input.value&&""!==this.elements.input.value||(t._changePlaceholder(t._placeholder),t._launchSearch("")),this.resetCache(),t._hideSearchInput()}},datasets:{configuration:{searchEngine:function(e,i){return i?h.getSuggestions(i,this.options.maxSuggestsToDisplay):(t._launchSearch(""),[])}}}}).inject(this.elements.container),n.onSearchChange(function(e){t.elements.input.elements.input.value=e,h.insertSuggestion(e),t._showSearchInput()}),widget&&(widget.addEvent("onSearch",function(e){n.changeSearch(e,!0)}),widget.addEvent("onResetSearch",function(){n.clearSearch(),t._hideSearchInput()}))},changeLibraryPlaceholder:function(e){var t=l.replace(l.SearchInLibrary,{libraryName:e});this._changePlaceholder(t),this._placeholder=t},_changePlaceholder:function(e){this.elements.input.elements.input&&(this.elements.input.elements.input.setAttribute("placeholder",e),this.elements.input.elements.input.setAttribute("title",e))},_launchSearch:function(e){e=e.trim(),n.changeSearch(e,!0)},getValue:function(){return this.elements.input.elements.input.value},clearValue:function(){n.clearSearch()}})}),define("DS/IPClassifyUX/views/IPClassifyTagger",["UWA/Class","DS/IPClassifyUX/events/IPClassifyEvents","DS/TagNavigatorProxy/TagNavigatorProxy","DS/IPClassifyUX/views/IPClassifyWebInWinTaggerProxy","DS/WidgetServices/WidgetServices","DS/IPClassifyUtil/IPClassifyAlert","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/IPClassifyUtil/IPClassifyUtility"],function(e,t,i,n,r,o,a,s){"use strict";var l={},d={},c={};return e.extend({CONTENT_TYPES:{EMPTY:"empty"},_initTaggerProxy:function(){var e=this;if(r.isNatifEnvironnement()){window.widgetId||(window.widgetId="LibraryEditor"+Math.random().toString(36).substr(2,9)),(t=o(window.widgetId)).events.addFilterChangeListener=e.onFilterChange.bind(e),t.events.addCriteriaChangeListener=e.onFilterChange.bind(e),e.taggerProxy=new n(t)}else{var t=o(widget.id);(e.taggerProxy=i.createProxy(t)).addEvent("onFilterChange",e.onFilterChange.bind(e))}function o(t){return{widgetId:t,filteringMode:"FilteringOnServer",colorize:!1,events:{addOpenTaggerListener:e.onOpenTagger.bind(e),addCloseTaggerListener:e.onCloseTagger.bind(e)}}}},_setSubjectTags:function(e,t,i){switch(this.containerType=t,t){case this.CONTENT_TYPES.EMPTY:this._setTagsForFavourites(e);break;default:this._setTagsForLibraries(e,i)}},_setTagsForLibraries:function(e,t){if(this.taggerProxy)if(e){var i={};for(var n in e){var r=e[n];if(i[r.sixw])i[r.sixw][r.object]=r;else{var c={};c[r.object]=r,i[r.sixw]=c}}var u=[];for(var h in i)for(var f in l[h]||(d[h]=i[h]),d[h])u.push(d[h][f]);t?this.taggerProxy.setTags(null,e):this.taggerProxy.setTags(null,u)}else{this.taggerProxy.setTags({});let e=this.taggerProxy.getCurrentFilter();!(!e||!e.allfilters||0===Object.keys(e.allfilters).length)&&s.isIndexedMode()&&o.displayNotification({message:a.msg_warning_emptyResult_with_selected_tags,className:"warning"})}},_setTagsForFavourites:function(e){if(this.taggerProxy){this.taggerProxy.setTags({})}},activateTaggerProxy:function(){var e=this.taggerProxy;e&&e.activate()},unsetTags:function(){var e=this.taggerProxy;e&&e.unsetTags()},onFilterChange:function(e){if(e){for(var i in l={},e.allfilters)l[i]=[];return c=e.allfilters,t.notifyCurrentLibraryFilterChange(),!0}},onOpenTagger:function(){t.notifyTaggerOpen()},onCloseTagger:function(){t.notifyTaggerClose()},_getCurrentFilter:function(){return c}})}),define("DS/IPClassifyUX/views/LibraryMode",["UWA/Controls/Abstract","DS/Controls/TooltipModel","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/IPClassifyUX/models/LibrarySearchModel","DS/IPClassifyUtil/IPClassifyAlert","DS/PADUtils/PADSession","DS/PADServices/utils/GlobalModelEvents","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/events/IPClassifyEvents"],function(e,t,i,n,r,o,a,s,l){"use strict";var d=null,c=null,u=null;function h(){return{icon:{iconName:widget.getValue("useIndexAccleration")?0==widget.getValue("intervalToSwitchMode")?"database hoverGlass":"database-hourglass":"database hoverGlass",fontIconFamily:1,className:"check-active"},disabled:!widget.getValue("useIndexAccleration")}}var f=e.singleton({_currentModeType:"index",_instantTime:null,_lastRefreshMode:null,_lastIndexInfo:i.text_not_available,_staleContentAfterSilentSwitch:!1,_modeInformation:{},init:function(e){var i=this;this._parent(e),this._tooltip=new t,this._modeInformation={last_refreshed:(new Date).getTime()},a.getModelEvents().subscribe({event:"switch_to_author"},this.switchtoAuthoringMode.bind(this)),setInterval(()=>{this.updateToolTip()},1e4),l.onUpdateRefreshTime(function(e){i._staleContentAfterSilentSwitch=e.staleContentAfterSilentSwitch,i._modeInformation=e.modeInformation}),l.onModeChange(function(e){i.setCurrentMode(e.switchMode)})},setLibraryControl:function(e){u=e},getToolbarEntry:function(){var e="index"==f.determineCurrentModeState()?{icon:{iconName:"database-refresh",fontIconFamily:1,className:""},disabled:!1}:h(),t={id:"indexMode",dataElements:{typeRepresentation:"functionIcon",tooltip:this._tooltip,label:i.indexMode.Label,action:{module:"DS/IPClassifyUX/views/LibraryMode",func:"switchModeButtonUI"},visibleFlag:!0}};for(var n in e)t[n]=e[n];return t},switchModeButtonUI:function(){s.sendTrackerPageEvent("LibraryWidget_iconBar","Active Mode");var e;e=300,clearTimeout(c),c=setTimeout(function(){n.isSearchActive()&&(n.clearSearch(),u.getIdCardCont().switchSearch(!1)),require(["DS/IPClassifyUX/utils/IPClassifyModeManager"],function(e){try{"index"==f.getCurrentModeType()?e.setAuthoringMode("authoring"):e.setAuthoringMode("index"),f.updateIconAndSettings(),e.refreshViewOfWidget(),f.setLastIndexTime(e.getLastIndexedTime())}catch(e){console.error(e)}})},e)},updateIconAndSettings:function(e){if((e||!0)&&this._registerTimeandModeOfRefresh(this.getCurrentModeType()),"index"==this.getCurrentModeType()&&this._enableIndexModeSwitch(),"authoring"==this.getCurrentModeType())if(widget.getValue("useIndexAccleration")){var t=widget.getValue(widget.getValue("intervalToSwitchMode"));this._enableAuthoringMode(),f.setIndexModeAfterTimeInterval(t)}else this._enableAuthoringMode();this.updateToolTip()},_enableAuthoringMode:function(){if(u.getIdCardCont()){var e=h();u.getIdCardCont().updateCommand("indexMode",e)}},_enableIndexModeSwitch:function(){if(u.getIdCardCont()){var e={icon:{iconName:"database-refresh",fontIconFamily:1,className:""},disabled:!1};u.getIdCardCont().updateCommand("indexMode",e)}},getCurrentModeType:function(){return this._currentModeType},setCurrentModeType:function(e){this._currentModeType==e&&"authoring"!=this._currentModeType||("index"==e?this._enableIndexModeSwitch():this._enableAuthoringMode()),this._currentModeType=e,"index"==e?(o.setAuthoringState(!1),o.setUseIndexPreference(!0)):(o.setAuthoringState(!0),o.setUseIndexPreference(!1))},_getWaitingTimeBeforeSwitchToIndexMode:function(){return parseInt(widget.getValue("intervalToSwitchMode"))},determineCurrentModeState:function(){var e=this.getCurrentModeType();const t=this._getWaitingTimeBeforeSwitchToIndexMode();return"authoring"!==e||widget.getValue("useIndexAccleration")?"authoring"!==e||t||(e="neverIndexMode"):e="useOnlyAuthoring",e},getFullViewLoadInfo:function(){return this._modeInformation},setLastIndexTime:function(e){this._lastIndexInfo=e},getLastIndexedTime:function(){return this._lastIndexInfo},_registerTimeandModeOfRefresh:function(e){this._instantTime=(new Date).getTime(),this._lastRefreshMode=e},updateToolTip:function(){const e=this.determineCurrentModeState(),t=this.getCurrentModeType();let n,r=(new Date).getTime()-this.getFullViewLoadInfo().last_refreshed;if(r>=6e4)var o=Math.abs(Math.round(r/6e4));else var a=Math.abs(Math.round(r/1e3));r=void 0!==o?o:a;let s=this.getLastIndexedTime();"index"===e&&"authoring"!==t?(n=void 0!==o?i.get("tooltip_index_mode_last_update_minute"):i.get("tooltip_index_mode_last_update_seconds"),o&&o>1&&(n=i.get("tooltip_index_mode_last_update_minutes")),this._tooltip.shortHelp=i.replace(n,{time:r,lastIndexed:s})):"authoring"===t&&"neverIndexMode"===e?(n=void 0!==o?i.get("tooltip_never_use_index_minute"):i.get("tooltip_never_use_index_seconds"),o&&o>1&&(n=i.get("tooltip_never_use_index_minutes")),this._tooltip.shortHelp=i.replace(n,{time:r,lastIndexed:s})):"authoring"===t&&"useOnlyAuthoring"===e?(n=void 0!==o?i.get("tooltip_never_use_index_minute"):i.get("tooltip_never_use_index_seconds"),o&&o>1&&(n=i.get("tooltip_never_use_index_minutes")),this._tooltip.shortHelp=i.replace(n,{time:r,lastIndexed:s})):"authoring"===t&&(n=void 0!==o?i.get("tooltip_authoring_mode_back2index_minute"):i.get("tooltip_authoring_mode_back2index_seconds"),o&&o>1&&(n=i.get("tooltip_authoring_mode_back2index_minutes")),this._tooltip.shortHelp=i.replace(n,{time:r,indexTime:widget.getValue("intervalToSwitchMode")/60,lastIndexed:s}))},setIndexModeAfterTimeInterval:function(e){var t=this;if(this.stopRefresh(),!isNaN(e)){var n=parseInt(e);d=setTimeout(function(){t.setCurrentMode("index"),t.updateIconAndSettings(),r.displayNotification({message:i.indexMode.info_msg_DataNotUptoDate,className:"info"})},60*n*1e3)}},stopRefresh:function(){d&&clearTimeout(d)},setCurrentMode:function(e){"authoring"==e&&(n.isSearchActive()&&(n.clearSearch(),u.getIdCardCont().switchSearch(!1)),r.displayNotification({message:i.indexMode.msg_Authoring,className:"info"})),this.setCurrentModeType(e)},switchtoAuthoringMode:function(){"index"==f.getCurrentModeType()&&(n.isSearchActive()&&(n.clearSearch(),u.getIdCardCont().switchSearch(!1)),f.setCurrentMode("authoring"),r.displayNotification({message:i.indexMode.msg_Authoring,className:"info"}),f.updateIconAndSettings())}});return f}),define("DS/IPClassifyUX/LibraryIdCardCont",["DS/IPClassifyUXUtil/ActionBar/IPToolbar","UWA/Class/Options","DS/IPClassifyUX/views/LibraryMode","DS/IPClassifyUX/models/LibraryInfo","DS/PADUtils/PADProbes","DS/PADServices/utils/GlobalModelEvents","DS/IPClassifyUX/models/LibrarySearchModel","DS/IPClassifyUX/events/IPClassifyEvents","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/IPClassifyUtil/OpenWithMenuBuilder"],function(e,t,i,n,r,o,a,s,l,d){"use strict";var c=null;return e.extend(t,{name:"LibraryIdCardController",_probeLoadElmt:null,_commandManager:null,_libraryControl:null,_libraryCSO:null,_libraryTypeService:null,getCommandManager:function(){return this._commandManager},createPathInfo:e=>new n({id:e.id,mxid:e.mxid,type:e.type,label:e.label,getChildrenInfos:c.getChildrenInfos}),getEntryForCommand:e=>{var t=null;return"IndexMode"===e&&(t=i.getToolbarEntry()),"openWith"===e&&(t={id:"openWith",plmType:"",dataElements:{typeRepresentation:"functionMenuIconCount",tooltip:l.OpenWith,label:l.OpenWith,icon:{iconName:"open-menu-dot",fontIconFamily:1},value:{menu:[]},position:"far"}}),t},buildOpenWithMenuItems:function(e,t){var i=this;t||(t=this._libraryCSO.getSelectedNodes());var n="";try{t[0].options&&(n=t[0].options.type),n&&!["General Library","Part Library","RootLibrary","General Class","Library"].includes(n)||(n="CLASSIFICATION_NODE")}catch(e){console.log(e),n="CLASSIFICATION_NODE"}if(i.toolbars.unstable){var r={data:{menu:[]}};if(!e||t.length>1||!t[0].options.mxid)i.toolbars.unstable.updateNodeModel("openWith",{grid:r,visibleFlag:!1,menuSave:r.data.menu,visitedType:n});else{var o=i.toolbars.unstable.getNodeModelByID("openWith"),a=o.options.visitedType;if(n!=a||0==o.options.grid.data.menu.length)d.openWithApps(t,{iconOpenWith:{iconName:"open-menu-dot",fontIconFamily:1},nlsOpenWith:l.OpenWith},"ClassificationEditorWidget_openwith").then(function(e){e[0]&&e[0].submenu&&e[0].submenu.forEach(function(e){r.data.menu.push(e)}),i.toolbars.unstable.updateNodeModel("openWith",{grid:r,menuSave:r.data.menu,visibleFlag:r.data.menu.length>0,visitedType:n})})}}},getSizes:function(){var e=[];return e=widget.getValue("x3dSharedId").startsWith("ClassificationEditor")?["102px","102px"]:this.isSearchAvailable()?["176px","175px"]:["147px","147px"],this._parent(e)},init:function(e){this._probeLoadElmt=r.createProbe("loadIdCard"),this._libraryCSO=e.libraryCSODataProvider,c=e.libraryDataProvider,this._commandManager=c.getCommandManager&&c.getCommandManager(),this._libraryControl=c.getLibraryControl&&c.getLibraryControl(),this._libraryTypeService=c.getLibraryTypeService&&c.getLibraryTypeService(),this._libraryControl.setIdCardCont(this),i.setLibraryControl(this._libraryControl),widget.addEvent("ontoolbarReady",()=>{this._libraryIdCardView=this._libraryControl.getContent().getView();var t=this._libraryIdCardView.getActiveView(),i=this._commandManager.getCommand(t);i&&i.options.icon&&e.modelEvents.publish({event:"toolbar_update_command",data:{commandID:"display",data:{icon:{iconName:i.options.icon,fontIconFamily:1}}}})});var t=this,n=e.leftState,l=e.rightState;e.leftOpened=n&&n.leftPanelState,e.rightOpened=l&&l.rightPanelState,e.modelEvents=o.getModelEvents(),e.searchInCurrentTab=!0,this._parent(e),e.modelEvents.subscribe({event:"searchValueSet"},a.changeSearch.bind(a)),s.onCurrentLibraryChange(function(e){var i=r.createProbe("idcard_updateUI");t.setCurrentLocation(),i.end()}),e.modelEvents.subscribe({event:"build_openwith"},e=>{t.toolbars.unstable&&t.toolbars.unstable.getNodeModelByID("openWith")&&t.buildOpenWithMenuItems(e.visible,e.nodes)}),t.dispatchEvent.call(this,"onReady"),t._probeLoadElmt.end()},inject:function(){this._parent.apply(this,arguments),this.setCurrentLocation()},setCurrentLocation:function(){var e=this._libraryCSO.getCurrentObjectPath();this._parent({objectPath:e})},isSearchAvailable:function(e){return e||(e=this._libraryCSO.getCurrentObject()),!!e&&(!this._libraryTypeService.isSection(e.getType())&&e.options.mxid)},render:function(){return this}})}),define("DS/IPClassifyUX/views/LibraryPlaceHolder",["DS/ApplicationFrame/CommandsManager","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUX/models/LibrarySearchModel","UWA/Controls/Abstract","DS/Controls/Button","DS/IPClassifyUX/utils/IPClassifyWidgetData"],function(e,t,i,n,r,o,a){"use strict";return r.extend({init:function(e){this._parent(e),this._buttonComponents=null,this.text={},this.CSOProvider=e.commandContext.CSOProvider,this.isMultiplePlaceholders=e.commandContext.placeholderData.multiplePlaceholders,this.buildSkeleton()},buildSkeleton:function(){var e=this,t="LibrarySection_AllLibraries";e.CSOProvider.getCurrentObject()&&(t=e.CSOProvider.getCurrentObject().plmType),i.onCurrentLibraryChange(function(t){var i=a.getWidgetData().currentTab;e._removeButtonComponent(),e._getComponentToReplace(t.currentNode.plmType,i).inject(e.elements.container)}),i.onContentTabChange(function(t){var i=a.getWidgetData().currentTab;e._removeButtonComponent(),e._getComponentToReplace(t,i).inject(e.elements.container)}),this.elements.container=UWA.createElement("div",{class:"content-placeholder",html:{tag:"div",text:"",class:"content-placeholder-description"}});var n=a.getWidgetData().currentTab;e._getComponentToReplace(t,n).inject(e.elements.container)},_removeButtonComponent:function(){this.getContent().getElementsByClassName("content-placeholder-common-command")[0].remove()},_getComponentToReplace:function(e,t){var i=this._getButtonComponents();if(null===i){var r=this._getOptions();i=this._buttonComponents=this._buildButtonComponents(r)}if(!n.isSearchActive()){if(!this.isMultiplePlaceholders)return this._getText(this.text.commonSection),i.commonSection;if("LibrarySection_favorite"===e)return this._getText(this.text.favoriteSection),i.favoriteSection;if("LibrarySection_AllLibraries"===e)return this._getText(this.text.librariesSection),i.librariesSection;if("RootLibrary"===e)return this._getText(this.text.librarySection),i.librarySection;if("Library"===e||!e)return 1===t?(this._getText(this.text.classAttributesSection),i.classAttributesSection):(this._getText(this.text.classSection),i.classSection)}},_getButtonComponents:function(){return this._buttonComponents},_getText:function(e){this.getContent().getElementsByClassName("content-placeholder-description")[0].innerText=e},_getOptions:function(){var t=this;return this.isMultiplePlaceholders?{favoriteSection:{text:t.options.commandContext.placeholderData.placeholders.favoriteSection.labelNLS,commands:[]},librariesSection:{text:t.options.commandContext.placeholderData.placeholders.createNewLibrary.labelNLS,commands:[{name:t.options.commandContext.placeholderData.placeholders.createNewLibrary.commandNLS,emphasize:"primary",callback:function(){var i=e.getCommand(t.options.commandContext.placeholderData.placeholders.createNewLibrary.command,t.options.commandContext);i&&i.begin()}},{name:t.options.commandContext.placeholderData.placeholders.importLibrary.commandNLS,emphasize:"primary",callback:function(){var i=e.getCommand(t.options.commandContext.placeholderData.placeholders.importLibrary.command,t.options.commandContext);i&&i.begin()}}]},librarySection:{text:t.options.commandContext.placeholderData.placeholders.createNewClass.labelNLS,commands:[{name:t.options.commandContext.placeholderData.placeholders.createNewClass.commandNLS,emphasize:"primary",callback:function(){var i=e.getCommand(t.options.commandContext.placeholderData.placeholders.createNewClass.command,t.options.commandContext);i&&i.begin()}}]},classSection:{text:t.options.commandContext.placeholderData.placeholders.createNewClass.labelNLS_Cls,commands:[{name:t.options.commandContext.placeholderData.placeholders.createNewClass.commandNLS,emphasize:"primary",callback:function(){var i=e.getCommand(t.options.commandContext.placeholderData.placeholders.createNewClass.command,t.options.commandContext);i&&i.begin()}}]},classAttributesSection:{text:t.options.commandContext.placeholderData.placeholders.addClassAttributes.labelNLS,commands:[{name:t.options.commandContext.placeholderData.placeholders.addClassAttributes.commandNLS,emphasize:"primary",callback:function(){var i=e.getCommand(t.options.commandContext.placeholderData.placeholders.addClassAttributes.command,t.options.commandContext);i&&i.begin()}}]}}:{commonSection:{text:t.options.commandContext.placeholderData.placeholders.addExistingCI.labelNLS,commands:[{name:t.options.commandContext.placeholderData.placeholders.addExistingCI.commandNLS,emphasize:"primary",callback:function(){var i=e.getCommand(t.options.commandContext.placeholderData.placeholders.addExistingCI.command,t.options.commandContext);i&&i.begin()}}]}}},_buildButtonComponents:function(e){var t=[];function i(e,t){var i=e.commands[t].callback,n={label:e.commands[t].name,emphasize:e.commands[t].emphasize},r=new o(n);return r.getContent().addEventListener("buttonclick",function(){i()}),r}function n(e,t){if(e.commands)for(var n=0;n<e.commands.length;n++){i(e,n).inject(t)}}for(var r in e){var a=UWA.createElement("div",{class:"content-placeholder-common-command"});n(e[r],a),t[r]=a,this.text[r]=e[r].text}return t}})}),define("DS/IPClassifyUX/views/LibraryPathSeparator",["UWA/Controls/Abstract","UWA/Class/Options","DS/IPClassifyUX/events/IPClassifyEvents","DS/UIKIT/DropdownMenu","DS/IPClassifyUtil/IPClassifyAlert"],function(e,t,i,n,r){"use strict";return e.extend(t,{_dropDownCreated:!1,_dropdownElmt:null,_separator:null,_libraryInfo:null,_subLibraries:null,_activeIconFont:"",_unactiveIconFont:"",init:function(e){this._parent(e),this._libraryInfo=e.libraryInfo||null,this._activeIconFont=e.activeIconFont||"fonticon-down-dir",this._unactiveIconFont=e.unactiveIconFont||"fonticon-right-dir"},getSubLibrary:function(e){return null===this._subLibraries||e>=this._subLibraries.length?null:this._subLibraries[e]},addSubLibrary:function(e,t){null===this._subLibraries&&(this._subLibraries=[]),t?this._subLibraries.splice(0,0,e):this._subLibraries.push(e),this._dropDownCreated=!1},removeSubLibrary:function(e){if(null===this._subLibraries||e>=this._subLibraries.length)return!1;this._subLibraries.splice(e,1);return this._dropDownCreated=!1,this._dropdownElmt&&this._dropdownElmt.isVisible&&this._dropdownElmt.hide(),!0},hide:function(){this._dropdownElmt&&this._dropdownElmt.isVisible&&(this._dropdownElmt.hide(),this._dropDownCreated=!1),this._separator&&this._separator.hide()},show:function(){this._separator&&this._separator.show()},isVisible:function(){return"none"!==this._separator.getStyle("display")},buildPathSeparatorElement:function(){var e=this;return this._separator=UWA.createElement("div",{class:"separatorIdCard fonticon "+this._unactiveIconFont,styles:{cursor:"pointer"},events:{click:function(t){e._dropDownCreated||e._buildDropDownPath()}}}),this._separator},flush:function(){this._clearDropDown,this._dropDownCreated=!1,this._subLibraries=null},_clearDropDown:function(){this._dropdownElmt&&(this._dropdownElmt.destroy(),this._dropdownElmt=null)},_buildDropDownPath:function(){var e=this;if(null===this._subLibraries&&null===this._libraryInfo)return null;this._clearDropDown(),this._subLibraries?(e._dropDownCreated=!0,this._buildDomDropdownElmt(this._subLibraries)):this._libraryInfo.getChildrenInfos({onComplete:function(t){e._dropDownCreated=!0,e._buildDomDropdownElmt(t)},onFailure:function(t){e._dropDownCreated=!1,r.displayNotification({message:Nls.replace(Nls.get("msg_error_LibraryActivate"),{name1:name}),className:"error"})}})},_buildDomDropdownElmt:function(e){var t=this,r=[];e.length>0&&(e.forEach(function(e){r.push({text:e.getLabel(),title:e.getLabel(),handler:function(){i.notifyExpandTreeAndSelect({libraryToFindAndSelect:{id:e.getID(),type:e.getType(),name:e.getLabel()}})}})}),this._dropdownElmt=new n({target:this._separator,className:"library_ctx_menu",items:r,position:"bottom left",events:{onShow:function(){t._separator.removeClassName(t._unactiveIconFont),t._separator.addClassName(t._activeIconFont)},onHide:function(){t._separator.removeClassName(t._activeIconFont),t._separator.addClassName(t._unactiveIconFont)}}}),this._checkSizeOverflowDropdownMenu(),this._dropdownElmt.show())},resizeWidgetCallback:function(){this._dropdownElmt&&this._dropDownCreated&&(this._dropDownCreated=!1,this.isVisible()&&this._dropdownElmt.hide())},_checkSizeOverflowDropdownMenu:function(){var e,t,i,n,r,o,a,s,l,d,c;if(!this._dropdownElmt)return!1;o=this._dropdownElmt.elements.container,e=(a=this._dropdownElmt.options).target,i=document.documentElement.clientHeight||window.innerHeight,r=document.documentElement.clientWidth||window.innerWidth,o.isInjected()||(this._dropdownElmt.inject(a.renderTo?a.renderTo:document.body),o.setStyle("display","")),t=o.offsetHeight,n=o.offsetWidth,t>(s=i-(d=e.getOffsets().y+e.offsetHeight)-20>0?i-d-20:i-d)&&(o.setStyle("height",s),o.setStyle("overflow-y","auto"),n+=20,o.setStyle("width",n)),n>(l=r-(c=e.getOffsets().x+e.offsetWidth)-20>0?r-c-20:r-c)&&o.setStyle("width",l)}})}),define("DS/IPClassifyUX/views/LibraryPathNavigator",["UWA/Controls/Abstract","UWA/Class/Options","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUX/views/LibraryPathSeparator"],function(e,t,i,n){"use strict";return e.extend(t,{_ctxMenu:null,_ctxMenuWidth:4,_breadcrumb:null,_pathCont:null,init:function(e){this._parent(e),this._pathCont=e.pathCont,this.CSOProvider=e.CSOProvider,this._buildCtxMenu(),this._breadcrumb=UWA.createElement("div",{class:"containerPathIdCard"}).inject(this._pathCont),e.pathNodes&&e.pathNodes.length>0&&this._buildPathNavigator(e.pathNodes)},flush:function(){for(this._ctxMenu.hide();this._breadcrumb.firstChild;)this._breadcrumb.removeChild(this._breadcrumb.firstChild);this._ctxMenu.flush()},_buildPathNavigator:function(e){if(UWA.is(e))for(var t=this._pathCont.offsetWidth,i=!1,r=0;r<e.length;r++){var o,a=null,s=null,l=0,d=this._createLibraryInfoPathElement(e[r]);if(o=d.getDimensions().outerWidth,r<e.length-1&&((a=(s=new n({libraryInfo:e[r+1]})).buildPathSeparatorElement()).LibrarySeparator=s,a.inject(this._breadcrumb,"top"),l=a.getDimensions().outerWidth),o+l<t&&!i)t=t-o-l;else{i=!0,this._ctxMenu.isVisible()||this._ctxMenu.show(),a&&a.destroy();var c=d.nextSibling;c&&c.hasClassName("separatorIdCard")&&c.destroy(),d.remove(),this._ctxMenu.addSubLibrary(e[r])}}},_buildCtxMenu:function(){this._ctxMenu=new n({libraryInfo:null,activeIconFont:"fonticon-menu",unactiveIconFont:"fonticon-menu"});var e=this._ctxMenu.buildPathSeparatorElement();e.inject(this._pathCont,"top"),this._ctxMenuWidth=e.getDimensions().outerWidth,this._ctxMenu.hide()},_resize:function(){var e,t=null;if(this._isOverflowed(this._pathCont))for(this._ctxMenu.isVisible()||this._ctxMenu.show();this._isOverflowed(this._pathCont)&&this._breadcrumb.hasChildNodes()&&(t=this._breadcrumb.firstChild);)t.LibraryInfo&&(this._ctxMenu.addSubLibrary(t.LibraryInfo,!0),(e=t.nextSibling)&&e.hasClassName("separatorIdCard")&&e.destroy(),t.remove());else for(var i=!0,r=this._breadcrumb.getElementsByClassName("subLabelTextIdCard").length>0;i;)if(this._ctxMenu.isVisible()||(i=!1),t=this._ctxMenu.getSubLibrary(0)){if(r){var o=new n({libraryInfo:t});(e=o.buildPathSeparatorElement()).LibrarySeparator=o,e.inject(this._breadcrumb,"top");e.getDimensions().outerWidth}var a=this._createLibraryInfoPathElement(t);a.getDimensions().outerWidth;r=!0,this._isOverflowed(this._pathCont)?(e&&e.destroy(),a.remove(),i=!1):this._ctxMenu.removeSubLibrary(0)}else this._ctxMenu.hide(),i=!1;this._ctxMenu.isVisible()&&this._ctxMenu.resizeWidgetCallback();var s,l,d,c=this._breadcrumb.getElementsByClassName("separatorIdCard");for(d=c.length,s=0;s<d;++s)(l=c[s].LibrarySeparator)&&l.resizeWidgetCallback();return!0},_isOverflowed:function(e){return e.scrollHeight-1>e.clientHeight||e.scrollWidth>e.clientWidth},_createLibraryInfoPathElement:function(e){var t=e.getID()===this.CSOProvider.getCurrentObject().getID(),n=UWA.createElement("div",{class:"subLabelTextIdCard",styles:{cursor:"pointer"},events:{click:function(e){i.notifyExpandTreeAndSelect({libraryToFindAndSelect:{id:this.LibraryInfo.getID(),type:this.LibraryInfo.getType(),name:this.LibraryInfo.getLabel()}})}}}).inject(this._breadcrumb,"top");return n.LibraryInfo=e,n.setAttribute("current",t),n.setText(e.getLabel()),n}})}),define("DS/IPClassifyUX/views/InformationsPanelView",["UWA/Controls/Abstract","DS/IPClassifyUX/events/IPClassifyEvents","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/PADUtils/PADContext","DS/WidgetServices/commandProxy/CommandProxy","DS/PADServices/utils/GlobalModelEvents"],function(e,t,i,n,r,o){"use strict";return e.extend({_context:null,_propertiesWdg:null,_callbackAdd:!1,_modelEv:null,_libraryEditorUtil:null,_libraryControl:null,init:function(e){this._parent(e,{}),this._context=n.get();var r=this;this._propertiesWdg=null,this._callbackAdd=!1,this._modelEv=o.getModelEvents(),e.dataProvider&&(this._libraryEditorUtil=e.dataProvider.getLibraryEditorUtil&&e.dataProvider.getLibraryEditorUtil(),this._libraryControl=e.dataProvider.getLibraryControl&&e.dataProvider.getLibraryControl()),r.CSOProvider=e.CSOProvider,e.padshell&&(null==r._propertiesWdg&&require(["DS/EditPropWidget/EditPropWidget","DS/EditPropWidget/constants/EditPropConstants"],function(t,n){if(null==r._propertiesWdg){r._propertiesWdg=new t({className:"enxpropertiestab",setEditButton:!0,readOnly:!1,typeOfDisplay:n.ALL,selectionType:n.RESTRICTED_SELECTION,multiselection:!1,collapseTabs:!1}),r._propertiesWdg.addFacets([{position:1,require:"DS/ENORIPE_Relations/views/RelationsTab",facet:{name:"relations",text:i.get("relations_tab"),icon:"object-related"}},{position:2,require:"DS/IPClassifyUX/facets/AttachmentsFacet",alwaysVisible:!1,supportMerge:!1,services:["3DSpace"],inheritance:!0,content:null,facet:{name:"attachments",text:i.get("attachments"),icon:"attach"},options:{appContext:{options:e,getDocumentId:function(){return e.CSOProvider.getSelectedNodesID()[0]},readonly:e.readOnly,isLeaderRole:e.isLeaderRole,isOwnerRole:e.isOwnerRole}}}]),r._propertiesWdg.removeFacets([n.FACET_VIEWS]);var o=e.padshell.getRightPanelContent();r._propertiesWdg.inject(o),r._propertiesWdg.stopSelection(!0),r._propertiesWdg.elements.container.getContent().addEvent("resize",function(){r.size=e.padshell._currentRight;var t={rightPanelState:e.padshell.getRightOpen(),size:r.size};r._libraryEditorUtil&&r._libraryEditorUtil.setRightPanelStatus(t)})}r.addCallback(e)}),t.onInfoExpand(function(){r.show(e.padshell),t.notifyInfoExpanded()}),t.onInfoCollapse(function(){e.padshell._modelEvents.publish({event:"triptych-hide-panel",data:"right"}),t.notifyInfoCollapsed()}),t.onLibrarySelected(function(){e.padshell.getRightOpen()&&(r.show(e.padshell),t.notifyInfoExpanded())}))},updatePanelVisibility:function(e,t){"right"===t&&this._libraryControl&&this._libraryControl.getIdCardCont()&&this._libraryControl.getIdCardCont().updateRightPanelIcon(e)},show:function(e){var t=this;require(["DS/EditPropWidget/utils/EditPropUtils"],function(i){t._selectionChange(i,e)})},addCallback:function(e){var i=this;!1===i._callbackAdd&&i._context.elements.padshell&&i._context.elements.padshell._modelEvents&&(i._context.elements.padshell._modelEvents.subscribe({event:"triptych-panel-hidden"},i.updatePanelVisibility.bind(this,!1)),i._context.elements.padshell._modelEvents.subscribe({event:"triptych-panel-visible"},i.updatePanelVisibility.bind(this,!0)),this._modelEv.subscribe({event:"information-panel-open"},function(){i.show(e.padshell),t.notifyInfoExpanded(),i.setPreferences()}),this._modelEv.subscribe({event:"information-panel-close"},function(){i._context.elements.padshell.getRightOpen()&&(i._context.togglePanel("right"),t.notifyInfoCollapsed(),i._selectionChange(),i.setPreferences())}),i._callbackAdd=!0)},_selectionChange:function(e,t){if(e){var i=this.CSOProvider.getSelectedNodes();if(this.CSOProvider.enableEditProperty){let e=this.CSOProvider.enableEditProperty(i);this._propertiesWdg.controller.skeleton._sharedOptions.readOnly=!e}var n=[];i.length&&i.forEach(function(t){if(e.getModelFromSelectedNode){var i=e.getModelFromSelectedNode(t);i&&n.push(i)}}),this._propertiesWdg.initDatas(n),this._context.elements.padshell._modelEvents.publish({event:"triptych-show-panel",data:"right"})}},setPreferences:function(){var e=this._context.elements.padshell.getRightOpen(),t={rightPanelState:e,size:this.size};this._libraryEditorUtil.setRightPanelStatus(t),e?this._modelEv.publish({event:"information-panel-visible"}):this._modelEv.publish({event:"information-panel-hidden"})}})}),define("DS/IPClassifyUX/views/IPClassifyModeSwitch",["UWA/Core","UWA/Controls/Abstract","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/IPClassifyUX/events/IPClassifyEvents","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX"],function(e,t,i,n,r){"use strict";return t.extend({init:function(e){var t=this;this._parent(e);var o=document.querySelectorAll(".switchMode_container");if(o&&o.length>0){var a=Array.prototype.slice.call(o);a&&a.forEach(function(e){e.remove()})}this.switchModeContainer=UWA.createElement("div",{class:"switchMode_container"}).inject(e.idCardContainer),this.elements.modeSwitchHolder=new UWA.createElement("div",{class:"generic-icon",attributes:{title:r.command_Index_Auth_mode_switch},events:{click:function(){const e=t.switchModeContainer.querySelector(".generic-icon");e&&!e.hasClassName("disable")&&(e.hasClassName("fonticon-database-refresh")?(i.setAuthoringMode("authoring"),i.refreshViewOfWidget()):(e.hasClassName("fonticon-database-hourglass")||e.hasClassName("fonticon-database"))&&(i.setAuthoringMode("index"),i.refreshViewOfWidget()))}}}).inject(t.switchModeContainer);var s=this.switchModeContainer.getElement(".generic-icon");if(s){var l=i.determineCurrentModeState();"index"===l?s.addClassName("fonticon fonticon-database-refresh"):"authoring"===l?(s.addClassName("fonticon fonticon-database-hourglass"),s.addClassName("hoverGlass"),i.setAuthoringMode("authoring",!1,!0)):"neverIndexMode"===l?(s.addClassName("fonticon fonticon-database"),s.addClassName("hoverGlass")):"useOnlyAuthoring"===l&&(s.addClassName("fonticon fonticon-database"),s.addClassName("hoverGlass"),s.addClassName("disable")),t.setIndexDbIconTooltip(s)}n.onModeChange(function(e){var n=e.switchMode;const r=i.determineCurrentModeState();n&&("authoring"===n&&"neverIndexMode"===r?t.setNeverIndexModeIcon():"useOnlyAuthoring"===r?t.setOnlyAuthoringModeIcon():"authoring"===n?t.setAuthoringModeIcon():t.setIndexModeIcon())})},setIndexDbIconTooltip(e){e.onmouseover=function(t){const n=i.determineCurrentModeState(),o=i.determineAuthoringMode();let a,s=(new Date).getTime()-i.getFullViewLoadInfo().last_refreshed;if(s>=6e4)var l=Math.abs(Math.round(s/6e4));else var d=Math.abs(Math.round(s/1e3));s=void 0!==l?l:d;let c=i.getLastIndexedTime();"index"===n&&"authoring"!==o?(a=void 0!==l?r.get("tooltip_index_mode_last_update_minute"):r.get("tooltip_index_mode_last_update_seconds"),l&&l>1&&(a=r.get("tooltip_index_mode_last_update_minutes")),e.title=r.replace(a,{time:s,lastIndexed:c})):"authoring"===o&&"neverIndexMode"===n?(a=void 0!==l?r.get("tooltip_never_use_index_minute"):r.get("tooltip_never_use_index_seconds"),l&&l>1&&(a=r.get("tooltip_never_use_index_minutes")),e.title=r.replace(a,{time:s,lastIndexed:c})):"authoring"===o&&"useOnlyAuthoring"===n?(a=void 0!==l?r.get("tooltip_never_use_index_minute"):r.get("tooltip_never_use_index_seconds"),l&&l>1&&(a=r.get("tooltip_never_use_index_minutes")),e.title=r.replace(a,{time:s,lastIndexed:c})):"authoring"===o&&(a=void 0!==l?r.get("tooltip_authoring_mode_back2index_minute"):r.get("tooltip_authoring_mode_back2index_seconds"),l&&l>1&&(a=r.get("tooltip_authoring_mode_back2index_minutes")),e.title=r.replace(a,{time:s,indexTime:widget.getValue("intervalToSwitchMode")/60,lastIndexed:c}))}},setAuthoringModeIcon(){let e=this.switchModeContainer.querySelector(".generic-icon");null!==e&&(e.classList.remove("fonticon-database-refresh"),e.classList.remove("fonticon-database"),e.classList.remove("disable"),e.classList.add("fonticon-database-hourglass"),e.classList.add("hoverGlass"))},setIndexModeIcon(){let e=this.switchModeContainer.querySelector(".generic-icon");null!==e&&(e.classList.remove("fonticon-database-hourglass"),e.classList.remove("hoverGlass"),e.classList.remove("fonticon-database"),e.classList.remove("disable"),e.classList.add("fonticon-database-refresh"))},setNeverIndexModeIcon(){let e=this.switchModeContainer.querySelector(".generic-icon");null!==e&&(e.classList.remove("fonticon-database-hourglass"),e.classList.remove("fonticon-database-refresh"),e.classList.remove("disable"),e.classList.add("fonticon-database"),e.classList.add("hoverGlass"))},setOnlyAuthoringModeIcon(){let e=this.switchModeContainer.querySelector(".generic-icon");null!==e&&(e.classList.remove("fonticon-database-hourglass"),e.classList.remove("fonticon-database-refresh"),e.classList.add("fonticon-database"),e.classList.add("hoverGlass"),e.classList.add("disable"))}})}),define("DS/IPClassifyUX/views/LibraryOrderCmdView",["UWA/Controls/Abstract","UWA/Class/Options","UWA/Class/Events","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/IPClassifyUX/events/IPClassifyEvents"],function(e,t,i,n,r){"use strict";return e.extend(t,i,{_name:"library_orderTools",_defaultOptions:{sortMode:"alpha",sortOrder:"asc"},init:function(e){this._parent(e),this.sortMode=widget.getValue("sortMode")||this._defaultOptions.sortMode,this.sortOrder=widget.getValue("order")||this._defaultOptions.sortOrder,this._buildSkeleton()},_buildSkeleton:function(){var e,t=this;this.elements.container=UWA.createElement("div",{id:"library_orderTools"}),e="sprite_az sprite",e+="alpha"===this.sortMode?"desc"===this.sortOrder?" desc active":" active":"",this._alphaElmt=UWA.createElement("span",{class:e,title:n.alpha_sorting,events:{click:function(e){t.toggleButton(e.target)}}}).inject(this.elements.container),e="sprite_nb sprite",e+="alpha"!==this.sortMode?"desc"===this.sortOrder?" desc active":" active":"",this._dateElmt=UWA.createElement("span",{class:e,title:n.date_sorting,events:{click:function(e){t.toggleButton(e.target)}}}).inject(this.elements.container)},toggleButton:function(e){if(e.hasClassName("active"))e.toggleClassName("desc");else{var t=this.elements.container.getElement(".active");t&&t.removeClassName("active"),e.addClassName("active")}this.sortOrder=e.hasClassName("desc")?"desc":"asc",this.sortMode=e.hasClassName("sprite_nb")?"date":"alpha",widget.setValue("sortMode",this.sortMode),widget.setValue("order",this.sortOrder),this.sortingNodesUnsensitiveCase()},getSortMode:function(){return this.sortMode},sortingNodesUnsensitiveCase:function(){r.notifyTreeSortChange({sortOrder:this.sortOrder,sortMode:this.sortMode})}})}),define("DS/IPClassifyUX/models/LibraryContentModel",["UWA/Class","UWA/Class/Promise","DS/PADUtils/PADProbes","DS/IPClassifyUtil/IPClassifyPreference","DS/IPClassifyUX/utils/IPClassifyWidgetData"],function(e,t,i,n,r){"use strict";var o,a,s,l,d=(o=void 0,a=0,s=!1,l=!1,{reset:function(){o=void 0,a=0},updateStartIndexAfterFetch:function(e){if(s=!1,e.infos&&e.infos.next_start){o=e.infos.next_start;var t=parseInt(o.slice(0,o.indexOf(" ")));(a+=e.infos.nresults)<e.infos.nhits&&t<e.infos.nhits&&(s=!0)}},isMoreDataToFetch:function(){return s},isFetchInProgress:function(){return l},setFetchInProgress:function(e){l=e},getNextStart:function(){return o}}),c=void 0,u=e.singleton({fetchLibraryContents:function(e,n){var o=i.createProbe("probeFetchLibraryContents");var a,s;return e.isStartFromBeg&&(d.reset(),c=e.dynamicattributes.filter(function(e,t,i){return i.indexOf(e)===t})),e.sortOrder&&(a=e.sortOrder.order_field,s=e.sortOrder.order_by),new t(function(t,i){n({pid:e.containerId,mxid:e.containerMXID,searchQuery:e.searchQuery,isExactSearch:e.isExactSearch,selectedType:e.selectedType,dynamicattributes:c,attributesDimMap:e.attributesDimMap,filters:e.filters,start:e.isStartFromBeg?0:void 0,next_start:d.getNextStart(),order_field:a,order_by:s,physicalId:e.physicalId,isAuthoringMode:e.isAuthoringMode,widgetData:r.getWidgetData()}).then(function(e){d.setFetchInProgress(!1),d.updateStartIndexAfterFetch(e),t(e),o.end()},function(e){i(e),o.end()})})},fetchAllLibraries:function(e,n){var o,a,s=i.createProbe("probeFetchAllLibraries");return e.isStartFromBeg&&d.reset(),e.sortOrder&&(o=e.sortOrder.order_field,a=e.sortOrder.order_by),new t(function(t,i){n({filters:e.filters,start:e.isStartFromBeg?0:void 0,next_start:d.getNextStart(),order_field:o,order_by:a,searchQuery:e.searchQuery,widgetData:r.getWidgetData()}).then(function(e){d.setFetchInProgress(!1),d.updateStartIndexAfterFetch(e),t(e),s.end()},function(){i(),s.end()})})},fetchAllFavorites:function(e){var o=i.createProbe("probFetchAllFavorites");return new t(function(t,i){function a(e){return e.id}n.get(e.getPreferenceSectionName(),function(s){s.length>0?e.getPreferenceSectionContents({ids:s.map(a),widgetData:r.getWidgetData()}).then(function(i){var r=[],a=!1;i.length!==s.length&&(a=!0);for(var l=0;l<i.length;++l){for(var d=0;d<s.length;++d)s[d].id===i[l].physicalid&&(i[l].label=s[d].name);a&&r.push({id:i[l].physicalid,name:i[l].label})}a&&n.set(e.getPreferenceSectionName(),r,!1,!1),t(i),o.end()},function(){i(),o.end()}):t([])},!1,!1)})}});return{fetchLibraryContents:u.fetchLibraryContents.bind(u),fetchAllLibraries:u.fetchAllLibraries.bind(u),fetchAllFavorites:u.fetchAllFavorites.bind(u),isMoreDataToFetch:d.isMoreDataToFetch,isFetchInProgress:d.isFetchInProgress,setFetchInProgress:d.setFetchInProgress}}),define("DS/IPClassifyUX/views/LibraryIdCardView",["UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","DS/IPClassifyUX/models/LibraryIdCardModel","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/IPClassifyUX/views/LibraryPathNavigator","DS/IPClassifyUX/views/LibrarySearchInContext","DS/IPClassifyUX/views/IPClassifyModeSwitch","DS/ENOXPageToolBar/js/PageToolBar","DS/PADUtils/PADProbes","DS/UIKIT/Tooltip","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/IPClassifyUtil/IPClassifyUtility"],function(e,t,i,n,r,o,a,s,l,d,c,u,h,f){"use strict";return t.extend(i,{name:"LibraryIdCardView",_currentPathNodes:null,_pageToolBar:null,_parentDiv:null,init:function(e){this._parent(e),this._parentDiv=e.parentDiv,this.CSOProvider=e.CSOProvider,this.dataProvider=e.dataProvider,this.IconBarProvider=e.IconBarProvider,this._buildSkeleton()},_buildLibraryPath:function(e){this._LibraryPathNavigator?(this._LibraryPathNavigator.flush(),this._LibraryPathNavigator._buildPathNavigator(e)):this._LibraryPathNavigator=new o({pathCont:this.elements.titleIdCard_container,pathNodes:e,CSOProvider:this.CSOProvider}),e.length>0&&this.elements.searchInContext&&this.elements.searchInContext.changeLibraryPlaceholder(e[0].getLabel())},_buildSkeleton:function(){var t=this;if(t.topRightSideDiv=t._parentDiv,!e.is(this.elements.container)){this.elements.container=UWA.createElement("div",{class:this.getClassNames()}),this.getOption("css_view_class")&&this.elements.container.addClassName(this.getOption("css_view_class")),this.elements.titleIdCard_container=UWA.createElement("div",{class:"LibraryEditor_title_IdCard"}).inject(this.elements.container),this.elements.searchSumIdCard_container=UWA.createElement("div",{class:"LibraryEditor_title_IdCard LibraryEditor_sumSearch"}).hide().inject(this.elements.container);var i=UWA.createElement("span",{class:"LibraryEditor_title_titleSearch"}).inject(this.elements.searchSumIdCard_container),n=UWA.createElement("span",{class:"LibraryEditor_title_DateSearch"}).inject(this.elements.searchSumIdCard_container);u.onContentSearchResult(function(e){if(e){var o=e.numberHits;t.elements.titleIdCard_container.hide(),t.elements.searchSumIdCard_container.show();var a=r.replace(r.searchResultSum,{numberHits:o,s:o>1?"s":""});i.setText(a);var s=e.dateIndex,l="";if(s){var d=new Date;l=(d-s)/1e3/3600>24||s.getDay()!=d.getDay()?s.toLocaleString():s.toLocaleTimeString(),l=r["Last index:"]+" "+l}if(n.setText(l),t.elements.searchSumIdCard_container.offsetWidth<i.offsetWidth+n.offsetWidth){i.setText(""),n.setText("");var u=UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-clock"}).inject(i);u.setStyle("color","black");var h="hover focus";f.isTouchDevice()&&(h="touch"),new c({target:u,trigger:h,animate:"true",position:"bottom",body:a+". "+l,title:""})}}else t.elements.titleIdCard_container.show(),t.elements.searchSumIdCard_container.hide(),t.updateDisplayPath()});var o={withInformationButton:!0,withWelcomePanelButton:!0,parentContainer:this._parentDiv,modelEvents:u.getModelEvents()};this._pageToolBar=new l(o),this._pageToolBar.render().inject(this._parentDiv);var a=this._pageToolBar.getBodyContent();this.elements.container.inject(a),this.topRightSideDiv.addEventListener("contextmenu",this._rightClick)}},buildSearch:function(){var e=this;this.dataProvider.isSearchInContextAvailable&&!this.dataProvider.isSearchInContextAvailable()||(this.elements.searchInContext=new a({events:{onSearchSwitch:function(t){var i=!1;(document.body.hasClassName("LibraryEditor_SearchActive")&&!t||!document.body.hasClassName("LibraryEditor_SearchActive")&&t)&&(i=!0),t?UWA.extendElement(document.body).addClassName("LibraryEditor_SearchActive"):UWA.extendElement(document.body).removeClassName("LibraryEditor_SearchActive"),i&&setTimeout(function(){e.actionBar._iconBar.show(),e.updateDisplayPath()},100)}}}).hide(),this.elements.searchInContext.inject(this.elements.container))},buildModeSwitcher:function(){h.isModeSwitcherEnabled()&&(this.elements.modeSwitcher=new s({idCardContainer:this.elements.container}))},buildIconBar:function(e,t,i,n,r,o){var a=document.querySelectorAll(".LibraryEditor_IdCard_IconBar");if(a&&a.length>0){var s=Array.prototype.slice.call(a);s&&s.forEach(function(e){e.remove()})}this.elements.toolbar=UWA.createElement("div",{class:"LibraryEditor_IdCard_IconBar"}).inject(this.elements.container),this.IconBarProvider.getCommandsIconBar()&&(this.actionBar=this.IconBarProvider.getCommandsIconBar().render(e,t,i,n,r,o),this.actionBar.inject(this.elements.toolbar),this.buildSearch(),this.buildModeSwitcher())},updateCommandVisibilityInIconBar:function(e,t,i,n,r){this.actionBar.updateCommandVisibilityInIconBar(e,t,i,n,r)},updateDisplayPath:function(){this._LibraryPathNavigator&&this._LibraryPathNavigator._resize(n.getPathNodes())},render:function(){return this},_rightClick:function(e){return e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),!1},getActionBar:function(){return this.actionBar},switchSearch:function(e){this.elements.searchInContext&&this.elements.searchInContext.switchSearch(e)},setCurrentLocation:function(){var e=d.createProbe("idcard_updateUI"),t=n.getNewPathNodes({getChildrenInfos:this.dataProvider.getChildrenInfos,CSOProvider:this.CSOProvider}),i=t[0],r=this.CSOProvider.getCurrentObject();r&&r.getID()===i.getID()&&!r.options.mxid&&(r.options.mxid=i.options.mxid),this.manageSearchVisibility(r),this._buildLibraryPath(t),e.end()},manageSearchVisibility:function(e){if(this.elements.searchInContext){this._isSearchAvailable(e)?this.elements.searchInContext.show():this.elements.searchInContext.hide()}},_isSearchAvailable:function(e){return e||(e=this.CSOProvider.getCurrentObject()),!!e&&(!this.dataProvider.isSection(e.getType())&&e.options.mxid&&!1!==e.options.contentAvailable)}})}),define("DS/IPClassifyUX/LibraryIdCard",["UWA/Core","UWA/Class","DS/IPClassifyUX/views/LibraryIdCardView","DS/IPClassifyUX/models/LibraryIdCardModel","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUX/views/LibraryPathNavigator","DS/IPClassifyUX/views/LibrarySearchInContext","DS/PADUtils/PADProbes","DS/IPClassifyUX/utils/IPClassifyWidgetData","css!DS/IPClassifyUX/IPClassifyUX"],function(e,t,i,n,r,o,a,s,l,d){"use strict";return t.extend({name:"LibraryIdCardController",_probeLoadElmt:null,_libraryIdCardView:null,init:function(e){this._probeLoadElmt=s.createProbe("loadIdCard"),this._libraryIdCardView=new i(e),this._OnIdCardComponentReady(),this.dataProvider=e.dataProvider,this.CSOProvider=e.CSOProvider,this._libraryIdCardView.dispatchEvent.call(this._libraryIdCardView,"onReady")},_OnIdCardComponentReady:function(){var e=this,t=null;e._attributesTabSelected=!1,r.onCurrentLibraryChange(function(i){t=i,e._libraryIdCardView.getActionBar()?e._libraryIdCardView.updateCommandVisibilityInIconBar(i.currentNode,"TREE",i.currentNode):e._libraryIdCardView.buildIconBar(i.currentNode,"TREE",i.currentNode),e.switchSearch(!1),e.setCurrentLocation()}),r.onLibrarySelected(function(i){t=i;var n=e.CSOProvider.getCurrentObject(),r=e.CSOProvider.getSelectedNodes().length;e._libraryIdCardView.getActionBar()?e._attributesTabSelected?1===l.getWidgetData().currentTab?e._libraryIdCardView.buildIconBar(i.selectedNode,i.context,n,l.getWidgetData().currentTab,i.allSelectNodes,r):e._libraryIdCardView.buildIconBar(i.selectedNode,i.context,n,null,i.allSelectNodes,r):e._libraryIdCardView.updateCommandVisibilityInIconBar(i.selectedNode,i.context,n,i.allSelectNodes,r):e._libraryIdCardView.buildIconBar(i.selectedNode,i.context,n,null,null,null)}),r.onContentTabChange(function(){var i=l.getWidgetData();1===i.currentTab?e._attributesTabSelected=!0:e._attributesTabSelected=!1,e._libraryIdCardView.buildIconBar(t.currentNode,"TREE",t.currentNode,i.currentTab)}),r.onUpdateSearchVisibility(function(t){e.manageSearchVisibility(t)}),e._probeLoadElmt.end()},setCurrentLocation:function(){this._libraryIdCardView.setCurrentLocation()},switchSearch:function(e){this._libraryIdCardView.switchSearch(e)},manageSearchVisibility:function(e){this._libraryIdCardView.manageSearchVisibility(e)},updateDisplayPath:function(){this._libraryIdCardView.updateDisplayPath(n.getPathNodes())},_isSearchAvailable:function(e){return this._libraryIdCardView._isSearchAvailable(e)},getView:function(){return this._libraryIdCardView}})}),define("DS/IPClassifyUX/views/LibraryLeftSidePanelView",["UWA/Core","UWA/Controls/Abstract","DS/PADUtils/PADContext","DS/IPClassifyUX/events/IPClassifyEvents","DS/PADServices/utils/GlobalModelEvents"],function(e,t,i,n,r){"use strict";return t.extend({_callbackAdd:!1,_context:null,_padshell:null,_modelEvent:null,_libraryEditorUtil:null,_libraryControl:null,init:function(e){this._parent(e,{}),this._context=i.get(),this._padshell=e.padshell,this._modelEvent=r.getModelEvents(),this._libraryEditorUtil=e.dataProvider.getLibraryEditorUtil&&e.dataProvider.getLibraryEditorUtil(),this._libraryControl=e.dataProvider.getLibraryControl&&e.dataProvider.getLibraryControl(),this.addCallback(e)},updatePanelVisibility:function(e,t){"left"===t&&(this.setPreferences(),this._libraryControl&&this._libraryControl.getIdCardCont()&&this._libraryControl.getIdCardCont().updateLeftPanelIcon(e))},addCallback:function(){var e=this;!1===e._callbackAdd&&this._padshell&&this._padshell._modelEvents&&(this._padshell._modelEvents.subscribe({event:"triptych-panel-hidden"},e.updatePanelVisibility.bind(this,!1)),this._padshell._modelEvents.subscribe({event:"triptych-panel-visible"},e.updatePanelVisibility.bind(this,!0)),this._modelEvent.subscribe({event:"welcome-panel-collapse"},function(){e._mode="close",e._padshell.togglePanel("left"),e._modelEvent.publish({event:"welcome-panel-collapsed"}),e.setPreferences()}),this._modelEvent.subscribe({event:"welcome-panel-expand"},function(){e._mode="open",e._padshell.togglePanel("left"),e._modelEvent.publish({event:"welcome-panel-expanded"}),e.setPreferences()}),n.onTaggerOpen(function(){e._padshell._modelEvents.publish({event:"triptych-hide-panel",data:"left"}),e._modelEvent.publish({event:"welcome-panel-collapsed"})}),n.onTaggerClose(function(){e._mode&&"open"!==e._mode?(e._padshell._modelEvents.publish({event:"triptych-hide-panel",data:"left"}),e._modelEvent.publish({event:"welcome-panel-collapsed"})):(e._padshell._modelEvents.publish({event:"triptych-show-panel",data:"left"}),e._modelEvent.publish({event:"welcome-panel-expanded"}))}),this._callbackAdd=!0)},setPreferences:function(){var e=this._context.elements.padshell.getLeftOpen(),t={leftPanelState:e,isWelcomePanelCollapsed:!e};this._libraryEditorUtil&&this._libraryEditorUtil.setLeftPanelStatus&&this._libraryEditorUtil.setLeftPanelStatus(t),e?this._modelEvent.publish({event:"welcome-panel-expanded"}):this._modelEvent.publish({event:"welcome-panel-collapsed"})}})}),define("DS/IPClassifyUX/views/LibraryContentView",["UWA/Core","DS/WebappsUtils/WebappsUtils","DS/ENOIPClassify/IPClassifyComponent","DS/IPClassifyNav/models/xNavNodeModel","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUX/models/LibrarySearchModel","DS/UIKIT/Mask","DS/PADUtils/PADProbes","DS/UIKIT/Native/Dropdown","DS/WidgetServices/WidgetServices","DS/IPClassifyUtil/IPClassifyCommunication","DS/IPClassifyUtil/IPClassifyAlert","DS/IPClassifyUX/views/LibraryPlaceHolder","DS/IPClassifyUX/service/LibraryDnDService","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/Controls/TabBar","DS/IPClassifyUX/utils/IPClassifyWidgetData","DS/PADServices/utils/AttributesMgtV2","DS/IPClassifyUtil/IPClassifyPreference"],function(e,t,i,n,r,o,a,s,l,d,c,u,h,f,p,g,m,v,_){"use strict";var b=null,C=null,y="ipcColumnSort_v1";return i.extend({name:"LibraryContentView",defaultOptions:{x3dAppId:"LibraryEditor",amd_custo:{TreeDocument:"DS/IPClassifyUX/views/LibraryTreeDocumentView",DataGridView:"DS/IPClassifyUX/views/LibraryDataGridView",TileGridView:"DS/IPClassifyUX/views/LibraryTileGridView",ThumbnailGridView:"DS/IPClassifyUX/views/LibraryThumbnailGridView"},active_view:"datagridview",layout:{keyboard_inputs:!1,root_panel:!1,action_bar:!1,statusInfo:!1,slidder:!1,title_update:!1,drop_invite:"none",triptychOpts:{borderLeft:!0,left:{withClose:!1,originalState:"close"},right:{withClose:!1}},amdTreeView:"datagridview"}},_contentDiv:null,init:function(e){var t=this;if(this._contentDiv=e.renderTo,this.leftTriptychElem=e.leftTriptychElem,widget.TreeDocumentCSOProvider=this.CSOProvider=e.CSOProvider,widget.TreeDocumentDataProvider=this.dataProvider=e.dataProvider,this.DnDProvider=e.DnDProvider,this.placeholderData=e.placeholderData,t._columnsCache={},b=e.dataProvider.getContextualMenu,e.DisabledDropInvit=!0,e.layout&&e.layout.view_customization&&e.layout.view_customization.columnsOptimized){var i=t.removeClassAttrsFromColumnCusto(e.layout.view_customization.columnsOptimized);e.layout.view_customization.columnsOptimized=i}d.isNatifEnvironnement()||this.dataProvider.showContentPlaceholder&&this.dataProvider.showContentPlaceholder()&&(t._placeHolder=new h({commandContext:this}),t._gridPlaceHolder=new h({commandContext:this})),this.setOptions(e),this._parent(this.options),require(["DS/PADUtils/views/PADStatusInfos"],function(e){t.elements.padstatus=new e({renderTo:t._contentDiv,events:{onShow:function(){t.elements.padstatus.setStatus(e.buildStatus({tree_content:{nbObjectsInTree:t.options.model.getAllDescendants().length,nbObjectsSelected:t.options.model.getSelectedNodes().length}}))}}})})},createRootListSlidder2:function(){return this.leftTriptychElem},addTabPages:function(){var e=this;if(this.dataProvider.getPageTabs){var t=this.elements.container.querySelector(".xnav_viewmain");this.elements.pageTab_container=UWA.createElement("div",{class:"LibraryEditor_pageTab"}).inject(t);var i=new g({displayStyle:"strip"});i.inject(this.elements.pageTab_container);var n=this.dataProvider.getPageTabs();for(var o in n)i.add(n[o]);i.addEventListener("tabButtonClick",function(t){t&&t.options&&(m.setCurrentTab(t.options.value),e._lastTabID=t.options.value,r.notifyContentTabChange())}),this.elements.pageTab_container.hide()}},setTabsVis:function(e){if(this.dataProvider.getPageTabs){if(!this.elements.pageTab_container.isHidden()===e)return;var t=m.getWidgetData().currentTab;e?(this.elements.pageTab_container.show(),m.setCurrentTab(this._lastTabID)):(this.elements.pageTab_container.hide(),m.setCurrentTab()),this.setTabStyleOnView(),t!==m.getWidgetData().currentTab&&this.loadNewColumns()}},setTabStyleOnView:function(){if(this.dataProvider.getPageTabs){var e=null;(e="datagridview"===this.getActiveView()?this.elements.container.querySelector(".LibraryDataGridView"):this.elements.container.querySelector(".wux-layouts-responsivecollectionview"))&&e.setStyle("top",this.elements.pageTab_container.clientHeight)}},_addStyleOnTreeCont:function(e){var t=this.elements.padshell._getLeftWidth();t=e&&e>t?e:t,d.addNewStyles("treeContResize",{".LibraryTreeView-root_container":{overflow:"hidden"},".LibraryTreeView-root_treeview_container":{width:t+"px !important"}},!0)},removeClassAttrsFromColumnCusto:function(e){for(var t=[],i=0;i<e.length;++i)-1==e[i].dataIndex.indexOf("attribute[")&&t.push(e[i]);return t},saveSortModelInCache:function(){if(this.dataProvider.getPageTabs){this._currentSortModel||(this._currentSortModel={});var e=this.getPADTreeListView().getManager(),t=e.sortModel;if(t&&t.length>0&&null!=t[0].dataIndex&&null!=t[0].dataIndex){var i=m.getWidgetData();e.layout.getLeafColumns()[e.layout.getColumnIndex(t[0].dataIndex)]&&(this._currentSortModel[i.currentTab]=e.sortModel,_.set(y+i.currentTab,e.sortModel,!0))}}},setSortOnColumn:function(){var e=this;return new Promise(function(t,i){if(e.dataProvider.getPageTabs){e._loadedColTabs||(e._loadedColTabs={});var n=m.getWidgetData();e._loadedColTabs[n.currentTab]?(e.getPADTreeListView().setColumnOrderState(e._currentSortModel[n.currentTab]),t()):(e._loadedColTabs[n.currentTab]=!0,_.get(y+n.currentTab,function(i){var n=e.getPADTreeListView().getDefaultSortModel();Object.keys(i).length&&(n=i),e.getPADTreeListView().setColumnOrderState(n);var r=e.getPADTreeListView().getManager().sortModel;n.dataIndex==r.dataIndex&&n.sort==r.sort&&e.saveSortModelInCache(),t()},!0))}else t()})},loadNewColumns:function(){if("datagridview"===this.getActiveView()){var e=this.getPADTreeListView().getManager(),t=m.getWidgetData();this._currentSortModel||(this._currentSortModel={}),this.removeAllColumns();for(var i=this.dataProvider.getColumnConfig(t),n=0;n<i.length;++n)this._columnsCache[i[n].dataIndex]?e.addColumnOrGroup(this._columnsCache[i[n].dataIndex]):e.addColumnOrGroup(i[n]);this.setSortOnColumn()}},removeAllColumns:function(){for(var e=this.getPADTreeListView().getManager(),t=e.layout.getLeafColumns(),i=0;i<t.length;++i)"tree"!==t[i].dataIndex&&(this._columnsCache[t[i].dataIndex]=t[i],e.removeColumnOrGroup(t[i].dataIndex))},cleanColumns:function(){for(var e=this.getPADTreeListView().getManager().layout.getLeafColumns(),t=[],i=[],n=0;n<e.length;++n)e[n].isDynamic&&(t.push(e[n].dataIndex),i.push(e[n]));this.getPADTreeListView().removeColumnCB(i),this.getPADTreeListView().removeColumnPreferences(t)},toShowThumbnail:function(e){return!this._isTreeViewType()||this.getPADTreeListView().isColumnAvailable(e)},showWebInWinCtxMenu:function(e,t){var i=this,n=t;if(n&&n.actions){var r=[];n.actions.forEach(function(e,t){e.actions&&e.actions.forEach(function(e){if(e.items){var t=[];e.items.forEach(function(e){"DS/ResultWebInWin/ResultWebInWinAction"==e.sourcejs&&t.push({text:e.title,icon:e.image,items:e.items,handler:function(t){var n=i.CSOProvider.getSelectedNodesID();c.publish("onActionContextualMenu",{header:e.id,ids:n,repeatMode:i.dataProvider.getRepeatMode?i.dataProvider.getRepeatMode():null})}})}),"DS/ResultWebInWin/ResultWebInWinAction"==e.sourcejs&&r.push({text:e.title,icon:e.image,items:t,handler:function(t){var n=i.CSOProvider.getSelectedNodesID();c.publish("onActionContextualMenu",{header:e.id,ids:n,repeatMode:i.dataProvider.getRepeatMode?i.dataProvider.getRepeatMode():null})}})}else"DS/ResultWebInWin/ResultWebInWinAction"==e.sourcejs&&r.push({text:e.title,icon:e.image,handler:function(t){var n=i.CSOProvider.getSelectedNodesID();c.publish("onActionContextualMenu",{header:e.id,ids:n,repeatMode:i.dataProvider.getRepeatMode?i.dataProvider.getRepeatMode():null})}})})}),this._initDropDown(r)}},_initDropDown:function(e){if(C){this.dropDown&&(this.dropDown.destroy(),this.dropDown=null);var t={items:e,target:C,contextual:!1,bound:!1};this.dropDown=new l(t),this.dropDown&&this.dropDown.show()}},setLibraryCommunicationChannel:function(){},getOnContextualEvent:function(){return{this:this,callback:function(e){var t=this;return new Promise(function(i){t.onContextualMenuReady(e).then(function(e){i(e)})})}}},onContextualMenuReady:function(e){var t=e.cellInfos;e.data&&(C=e.data.target),null==t&&(t={});var i={};t.cellView?t.rowID?i.virtualRowID=t.rowID:i.virtualRowID=1:t.white_Click=!0;var n=t.nodeModel,r=!0;return-1===i.virtualRowID&&(r=!1),new Promise(function(o){if(r&&d.isNatifEnvironnement()&&!d.isWebInWinEnvironment())c.publish("Create_ContextMenu",{ids:n?[n.id]:[]}),n&&!1===n.isSelected()&&n.select(!0),o(void 0);else{if(b||o(void 0),t.white_Click&&e&&e.treeview){var a=e.treeview?e.treeview.manager.getScroller():null;if(a&&e.data.target!=a.getContent())return}n&&"Busy"===n.plmType&&o(void 0);var s=m.getWidgetData(),l=!1;t.white_Click||-1===i.virtualRowID?l=!0:n&&(!1===n.isSelected()&&n.select(!0),!0===n.isSelected()&&(l=!0)),l&&b(t,"CONTENT",s,e).then(function(e){e.forEach(function(e){"separator"===e.type||"SeparatorItem"===e.type?e.type="SeparatorItem":e.label&&(e.title=e.label,e.action={callback:e.callback},e.type="PushItem")}),o(e)})}})},getActiveView:function(){return this._parent()},getPADTreeListView:function(){return this.options.views.datagridview},getPlaceHolder:function(){return this._gridPlaceHolder},enableTreeColumnEdit:function(e){return this.options.views.datagridview.setTreeColumnEditable(e)},removeNodesInContent:function(){var e=this.getPADTreeDocument();if(e){var t=e.getRoots(!0).slice(0);e.wrapInTransaction(function(){e.withTransactionUpdate(function(){var i,n=t.length;for(e.unselectAll(),i=0;i<n;++i)e.removeRoot(t[i],!0,!1)})})}},getSortingOrder:function(e){return this.getPADTreeListView().getSortingOrder(e)},setSortingForComputedAttrs:function(){this.getPADTreeListView().setSortingForComputedAttrs()},displayDynamicAttributes:function(e,t){this.cleanColumns();var i=e.dynamicattributesName,n=e.dynamicattributesForUIView,r=e.dynamicattributes,o=e.dynamicattributesType;let a=e.dynamicattributesIndex;var s=e.convUnitInfos,l=[];if(s&&(l=s.attrsToConvert),!this._isTreeViewType()||!i||i.length<1||!n||n.length<1)return new Promise(function(e){e()});var d=this.getPADTreeListView(),c={};let u=[];for(var h=0;h<i.length;++h)if(null!=i[h]&&null!=i[h]){if(!t){if(c[r[h]])continue;c[r[h]]=r[h]}var f={dataIndex:r[h],text:n[h],width:"auto",minWidth:30,isVisible:!0,isDynamic:!0,dbAttribute:i[h],customisation:{layout:{removable:!1,removableFromView:!1,pinEditable:!1,movable:!1},exportable:{lock:!0,value:!1}},dynamicattributesIndex:a?a[h]:a};"multiline"==o[h]?(f.typeRepresentation="editor",f.editionPolicy="EditionOnOver"):f.typeRepresentation=o[h];var p={};if(l.indexOf(i[h])>-1){p.dimension=s[i[h]+".dimension"];var g=s[i[h]+".manipulationUnit"];g&&g.length>0&&(p.manipulationUnit=g),f.convertInfos=p}u.push(f)}return new Promise(function(e){d.addColumnCB(u).then(function(){e()})})},_getColumnOptions:function(e){var t,i=this.getPADTreeListView().getManager()?this.getPADTreeListView().getManager().layout:null;if(i){var n=i.getColumnIndex(e);if(n>-1)t=i.getLeafColumns()[n]}return t},displayContentNodes:function(e,i,r,o,a){o&&this.removeNodesInContent();var s=[],l=[];e.forEach(function(e){var o=null;if(i&&i.forEach(function(t){(t.id||t.getID())===e.id&&(o=t)}),null==o){var a=e,d=new n(a);if(d.options.grid.thumbnail="url("+a.thumbnail+")",d.plmType=a.plmType,d.id=a.physicalid,d.mxid=a.mxid,d._ischeckout=e.Documentlocked,"TRUE"===d._ischeckout){var c=t.getWebappsAssetUrl("LibraryEditor","icons/32/I_CheckOutDocument.png");d.updateOptions({badges:{bottomRight:c}})}if("TRUE"===e.publishOnConnect){var u=t.getWebappsAssetUrl("LibraryEditor","icons/libraryPublishBadge.png");d.setBadges({bottomRight:u})}d.options.oldLabel=a.label,d._manageNLS=d.options._manageNLS=!0,s.push(d),(UWA.is(r,"array")?r.indexOf(d.id)>=0:d.id===r)&&l.push(d)}else{s.push(o),roots_PS_toRefresh.push(o);var h=o.id||o.getID();(UWA.is(r,"array")?r.indexOf(h)>=0:h===r)&&l.push(o)}}),this._endRefreshAndAddNodes(l,s);var d=null;return l.length>0&&(d=l[l.length-1],a&&this._defaultEnableNameEdit(l[l.length-1])),this._sortContent(),d},_defaultEnableNameEdit:function(e){setTimeout(function(){this._switchNameToEdit(e)}.bind(this),1e3)},_switchNameToEdit:function(e){try{var t=this.getPADTreeListView().getManager(),i=t.layout.getColumnIndex("tree"),n=t.layout.getCellsFromNodeModel(e)[i],r=s.createProbe("scrollTo_LibraryOrClass");t.scrollToCellAt({cellID:n}),r.end();t.getCellInfosAt(n);t.setCellInEdition(n)}catch(e){}},_sortContent:function(){this._isTreeViewType()&&this.getPADTreeDocument()._getTrueRoot().sortChildren({isRecursive:!0,sortFunction:this.dataProvider.comparator})},displayFavouriteNodes:function(e,t){var i=s.createProbe("probeDisplayFavouriteContent");this.removeNodesInContent();var r=[],o=[];e.forEach(function(e){var i=new n(e);i.plmType=e.plmType?e.plmType:"Library",i.id=e.physicalid,i.isFavorite=!0,i.options.oldLabel=e.label,i.options.physicalid=e.physicalid,i.options.mxid=e.mxid,i.options.type=e.type,i._manageNLS=!0,(UWA.is(t,"array")?t.indexOf(e.physicalid)>=0:e.physicalid===t)&&o.push(i),r.push(i)}),this._endRefreshAndAddNodes(o,r),i.end()},_endRefreshAndAddNodes:function(e,t){this._isTreeViewType()&&this._listenEndUIRefreshEvent(),this.addRootNodes(t),this._endRefreshView(),e.length>0&&e.forEach(function(e){e.select()})},_isTreeViewType:function(){return"datagridview"===this.getActiveView()&&null!==this.getPADTreeListView()},_endLoadAndSelect:function(){var e=this.CSOProvider.getCurrentObject();r.notifyUpdateSearchVisibility(e)},_endContentSelect:function(){this.contentHandleRequest=null,this.infiniteScrollDone()},infiniteScrollDone:function(){var e=this.getActiveView();if("datagridview"===e){var t=this.getPADTreeListView(),i=t?t.getManager():null;i&&i.infiniteScrollProcessDone()}else{var n=null;"tileview"===e?n=this.getPADTileGridView().options.grid:"thumbnailview"===e&&(n=this.getPADThumbnailGridView().options.grid),n&&n.infiniteScrollProcessDone()}},_listenEndUIRefreshEvent:function(){var e=this.getPADTreeListView();e&&e.getManager().onPostUpdateViewOnce(function(){this.elements.columnsHeaderContainer&&this.elements.columnsHeaderContainer.setStyle("left",0)})},maskContentDiv:function(e){var t=this._contentDiv,i=t;t&&(i=t.getElement(".xnav_viewmain")),e?a.mask(i):a.isMasked(i)&&a.unmask(i)},_endRefreshView:function(){this.maskContentDiv(!1),this.dispatchEvent("onCompleteRefreshNodes",this.CSOProvider.getCurrentObject().getID()),d.isWebInWinEnvironment()&&c.publish("onLibraryEditorUIReady","")},removeNodeInContent:function(e){var t=this.getPADTreeDocument();t.getRoots().forEach(function(i){(i.id||i.getID()||"Attribute"===i.plmType&&i.getLabel())===e&&t.removeRoot(i)})},onDragStartCell:function(t,i){if(!this.DnDProvider.shouldAcceptDrag()||!e.is(i)||!0===i.isHeader)return t.preventDefault(),void t.stopPropagation();f.setDragData(t,i,this.CSOProvider,this.dataProvider)},onDragOverBlank:function(e){this._onDragOver(e)},onDragOverCell:function(e){this._onDragOver(e)},onDragOverColumnHeader:function(e){this._onDragOver(e)},_onDragOver:function(e){return e.preventDefault(),!0},onDropCell:function(e,t){if(this.dataProvider.isDNDSupported()){var i=t.nodeModel;this.DnDProvider.shouldAcceptDrop(i)?(f.performDropOnLibraryEditorNode(i,e,this.DnDProvider),e.preventDefault(),f.cleanDragData()):this.onDropBlank(e,t)}else u.displayNotification({message:p.msg_warning_dndnotsupported,className:"warning"})},onDropBlank:function(e,t){if(this.dataProvider.isDNDSupported()){var i=this.CSOProvider.getCurrentObject();if(i&&this.DnDProvider.shouldAcceptDrop()){try{f.performDropOnLibraryEditorNode(i,e,this.DnDProvider)}catch(e){u.displayNotification({message:p.msg_warning_dndnotsupported,className:"warning"})}e.preventDefault(),f.cleanDragData()}else u.displayNotification({message:p.msg_warning_dndnotsupported,className:"warning"}),e.preventDefault()}else u.displayNotification({message:p.msg_warning_dndnotsupported,className:"warning"})},onDropColumnHeader:function(e,t){return f.cleanDragData(),!0},_addPlaceHolder:function(){if(!d.isNatifEnvironnement()&&this.dataProvider.showContentPlaceholder&&this.dataProvider.showContentPlaceholder()){var e=this.getActiveView(),t=o.isSearchActive(),i=this.CSOProvider.getCurrentObject().getType();if("datagridview"!==e){if(!t&&"Library"===i){var n;"tileview"===e?n=this.getPADTileGridView().options.grid.elements.scroller:"thumbnailview"===e&&(n=this.getPADThumbnailGridView().options.grid.elements.scroller);var r=n?n.getContent():null;r&&this._placeHolder&&this._placeHolder.elements.container.inject(r)}}else{var a=this.getPADTreeListView().getDatagridPlaceHolder().getContent();a&&(t||a.isHidden()&&a.show())}}},removePlaceHolder:function(){if(!d.isNatifEnvironnement()&&(this.dataProvider.showContentPlaceholder&&this.dataProvider.showContentPlaceholder()))if("datagridview"!==this.getActiveView()){var e=document.querySelectorAll(".content-placeholder");if(e&&e.length>0){var t=Array.prototype.slice.call(e);t&&t.forEach(function(e){e.remove()})}}else{var i=this.getPADTreeListView().getDatagridPlaceHolder().getContent();i&&(i.isHidden()||i.hide())}}})}),define("DS/IPClassifyUX/views/LibraryTreeView",["UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Class/Events","DS/Tree/Tree","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/Tree/TreeNodeView","DS/WebappsUtils/WebappsUtils","DS/IPClassifyUX/models/LibraryTreeModel","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/PADUtils/PADCommandProxy","DS/PADUtils/PADUtilsServices","DS/IPClassifyUX/views/LibraryOrderCmdView","DS/IPClassifyUX/service/LibraryDnDService","DS/IPClassifyUtil/IPClassifyAlert","DS/DataGridView/DataGridView","DS/DataGridView/DataGridViewLayout","DS/PADUtils/Configuration","DS/WidgetServices/WidgetServices"],function(e,t,i,n,r,o,a,s,l,d,c,u,h,f,p,g,m,v,_,b){"use strict";function C(e){return e._modelEvents}return t.extend(i,n,{name:"LibraryTreeView",_libraries_TreeDocument:null,_libraries_TreeView:null,_libraries_SortElmt:null,_rootNodeFavorite:null,_rootNodeLibraries:null,_commandProxy:null,_libraries_dgvTreeDocument:null,_timerDragEnter:null,_dndDropPosition:null,_currentDragEnterLibrary:null,_typeService:null,init:function(e,t){var i=this;i._parent(e),this.CSOProvider=e.CSOProvider,this.DnDProvider=e.DnDProvider,this.dataProvider=e.dataProvider,i._commandProxy=u.create(),i._buildSkeleton(),i._libraries_SortElmt=new f;this._libraries_dgvTreeDocument;var n=this._libraries_TreeView?this._libraries_TreeView.getTreeDocument():void 0;this._libraries_TreeDocument=n,n&&(n.options.shouldBeEditable=this.dataProvider.shouldBeEditable,n.onNodeModelUpdate(this.dataProvider.onContentUpdate),n.options.shouldAcceptDrag=this._shouldAcceptDrag.bind(this),n.options.shouldAcceptDrop=this._shouldAcceptDrop.bind(this),i._libraries_TreeDocument.onPreExpand(t._onPreExpandTreeNode.bind(t)),i._libraries_TreeDocument.getXSO().onChange(function(e){var t=i._libraries_TreeDocument.getXSO().get();if(t&&t.length>0){var n=t[t.length-1];n.getID||(n.getID=function(){return this.id}),n.getType||(n.getType=function(){return this.plmType}),i.CSOProvider.getCurrentObject()!==n&&i.CSOProvider.addInCSO(n,"TREE")}}))},createLibrarySections:function(e){var t=this;e.forEach(function(e){var i={useAsyncPreExpand:!0};i.label=e.label,i.icons=[e.icon],i.children=[],i.id="",i.plmType=e.plmType,t.dataProvider.isPreferenceSection(e.plmType)?t._rootNodeFavorite=t._createTreeNodeModel(i,t._libraries_TreeDocument):(t.defaultSelectedSection=e.plmType,t._rootNodeLibraries=t._createTreeNodeModel(i,t._libraries_TreeDocument))})},_buildSkeleton:function(){var t=this;if(!e.is(this.elements.container)){this.elements.container=UWA.createElement("div",{class:this.getClassNames()+"_container"}),this.getOption("css_view_class")&&this.elements.container.addClassName(this.getOption("css_view_class")),this.elements.libraryTreeView_container=UWA.createElement("div",{class:this.getClassNames()+"_treeview_container"}).inject(this.elements.container);var i=UWA.clone(_.getConfig("dgvOptions")),n=i&&i.dgv?i.dgv:{};n.selectionBehavior.toggle=b.isTouchDevice(),n.selectionBehavior.unselectAllOnEmptyArea=!1,n.infiniteScrolling=!0,n.onContextualEvent=t._onContextualEvent.bind(t),n.rowSelection="single",n.showRowBorderFlag=!1,n.columns=[{dataIndex:"tree",sortableFlag:!1,typeRepresentation:"string",getCellEditableState:function(e){return!!(e&&e.nodeModel&&t.dataProvider.isTreeNodeEditable)&&t.dataProvider.isTreeNodeEditable(e)},editionPolicy:"DelayedEditionOnClick",setCellValue:function(e,t){if(e.nodeModel){var i=e.nodeModel;i.getTreeDocument().withTransactionUpdate(function(){var e={};e.label=t,e.display=t,e.oldLabel=i.options.label,i.updateOptions(e)})}},compareFunction:function(e,i,n,r,o){return t.dataProvider.comparator(n,r)},onCellRequest:function(e){e.isHeader||(e.nodeModel&&e.nodeModel.options.isBeingCut?e.cellView.getContent().addClassName("library-state-is-being-cut"):e.cellView.getContent().removeClassName("library-state-is-being-cut")),this.defaultOnCellRequest(e)}}];var r=UWA.extend({identifier:"DataGridView-"+t.name+"-"+widget.id},n);i.dgvLayout.rowsHeader=!1;var a=UWA.clone(i.dgvLayout);r.layout=new v(a),r.layout.useLastColumnWidthAutoFlag=!0,r.layout.columnsHeader=!1;var s=new o;r.treeDocument=s,r.rowDragEnabledFlag=!0,r.useAsyncPreExpand=!0;var l=new m(r).inject(this.elements.libraryTreeView_container);this._libraries_TreeView=l,l.showAlternateBackgroundFlag=!1,l.treeNodeCellOptions.depthIncrement=14,l.treeNodeCellOptions.buildLinks=!0,l.treeNodeCellOptions.expanderStyle="triangle",l.onDragEndCell=this._onDragEndCell.bind(this),l.onDragOverCell=this._onDragOverCell.bind(this),l.onDragLeaveCell=this._onDragLeaveCell.bind(this),l.onDropCell=this._onDropCell.bind(this),l.onDragEnterBlank=this._onDragEnterBlank.bind(this),l.onDragOverBlank=this._onDragOverBlank.bind(this),l.onDropBlank=this._onDropBlank.bind(this),l.addEventListener("dblclick",function(e,i){e&&i&&-1!==i.rowID&&t._switchExpandStatus(i)})}},_switchExpandStatus:function(e){!0===e.nodeModel._isExpanded?e.nodeModel.collapse():e.nodeModel.expand()},_onContextualEvent:function(e){var t=this;return e&&e.cellInfos&&e.cellInfos.nodeModel.select(),new Promise(function(i){t.onContextualMenuReady(e).then(function(e){i(e)})})},_onDragOver:function(e){},_onDragOverCell:function(e,t){e.preventDefault();t.nodeModel;return t&&!t.nodeModel.isFavorite&&(t.dropPosition="middle"),this._dndDropPosition=t.dropPosition,this._currentDragEnterLibrary&&this._timerDragEnter&&this._currentDragEnterLibrary!==t.nodeModel.getID()&&(clearTimeout(this._timerDragEnter),this._timerDragEnter=null),this._currentDragEnterLibrary===t.nodeModel.getID()||t.nodeModel.isExpanded()||"expanding"===t.nodeModel.getState()||(this._timerDragEnter=setTimeout(function(){t.nodeModel.expand()},this.time_to_expand_node)),this._currentDragEnterLibrary=t.nodeModel.getID(),!0},_onDropCell:function(e,t){if(e.preventDefault(),"middle"!==t.dropPosition)return!0;if(this.dataProvider.isDNDSupported()){var i=t.nodeModel;if(i&&this.DnDProvider.shouldAcceptDrop(i)){this._timerDragEnter&&(clearTimeout(this._timerDragEnter),this._timerDragEnter=null),this._currentDragEnterLibrary=null;try{p.performDropOnLibraryEditorNode(i,e,this.DnDProvider)}catch(e){g.displayNotification({message:c.msg_warning_dndnotsupported,className:"warning"})}}else g.displayNotification({message:c.msg_warning_dndnotsupported,className:"warning"})}else g.displayNotification({message:c.msg_warning_dndnotsupported,className:"warning"})},_onDropBlank:function(e,t){this.dataProvider.isDNDSupported()||g.displayNotification({message:c.msg_warning_dndnotsupported,className:"warning"})},_onDragEndCell:function(e,t){e.preventDefault();var i=this;if("middle"!==this._dndDropPosition&&t&&t.nodeModel.isFavorite){var n=[];this._libraries_TreeDocument.getRoots()[0].getAllDescendants().forEach(function(e){n.push(e.id)}),d.getFavorites(i.dataProvider,{onComplete:function(e){var t=e,r=[];function o(e){for(var i=0;i<t.length;i++)t[i].physicalid===e&&t.splice(i,1)}for(var a=0;a<n.length;a++)e.forEach(function(e,t){e.physicalid===n[a]&&(r.push({id:e.physicalid,name:e.label}),o(e.physicalid))});t.length>0&&t.forEach((e,t)=>{r.concat({id:e.physicalid,name:e.label})}),d.reorderFavoritePreference(i.dataProvider,{favoriteLibraries:r,onComplete:function(e){console.log("Re-arrange of favorite node is successful"),g.displayNotification({message:c.get("msg_success_favoriteReordered"),className:"success"})},onFailure:function(e){console.log("WebService setFavorites Err : "+e),g.displayNotification({message:c.get("msg_error_favoriteReordered"),className:"error"})}})},onFailure:function(e){console.log(e)}})}return!1},_onDragLeaveCell:function(e,t){return this._timerDragEnter&&(clearTimeout(this._timerDragEnter),this._timerDragEnter=null),this._currentDragEnterLibrary=null,!0},_onDragEnterBlank:function(e,t){e&&e.dataTransfer&&(e.dataTransfer.dropEffect="none"),t.dropPosition="middle";return this._dndDropPosition=t.dropPosition,!0},_onDragOverBlank:function(e,t){},_populateContentSection:function(e,t){var i=this;e.forEach(function(e){var n={useAsyncPreExpand:!0};n.label=e.label,n.icons=e.icons,n.children=[],n.id=e.physicalid,n.mxid=e.mxid,n.plmType=e.plmType,n.created=e.created,n.type=e.type,UWA.is(e.publishOnConnect)&&(n.publishOnConnect=e.publishOnConnect);i._createTreeNodeModel(n,t)}),i._libraries_SortElmt.sortingNodesUnsensitiveCase()},_populateAllLibrariesSection:function(e,t){var i=this;e.forEach(function(e){var n={useAsyncPreExpand:!0};n.label=e.label,n.icons=e.icons,n.children=[],n.id=e.physicalid,n.mxid=e.mxid,n.plmType=e.plmType,n.created=e.created,n.type=e.type,UWA.is(e.publishOnConnect)&&(n.publishOnConnect=e.publishOnConnect);i._createTreeNodeModel(n,t)}),i._libraries_SortElmt.sortingNodesUnsensitiveCase()},_populateFavoriteSection:function(e){var t=this,i={useAsyncPreExpand:!1};e.forEach(function(e){i.label=e.label,i.icons=e.icons,i.children=null,i.id=e.physicalid,i.mxid=e.mxid,i.plmType=e.plmType,i.isFavorite=!0,i.type=e.type,t._createTreeNodeModel(i,t._rootNodeFavorite).setState({state:"noChildren"})})},_addFavouriteNode:function(e){var t={useAsyncPreExpand:!1};t.label=e.label,t.icons=e.icons,t.mxid=e.mxid,t.children=null,t.id=e.physicalid,t.plmType=e.plmType,t.type=e.type,t.isFavorite=!0,this._createTreeNodeModel(t,this._rootNodeFavorite).setState({state:"noChildren"})},addNewNode:function(e,t){var i={useAsyncPreExpand:!1};i.label=e.label,i.icons=e.icons,i.mxid=e.mxid,i.children=[],i.id=e.physicalid,i.plmType=e.plmType,i.type=e.type,t?this._createTreeNodeModel(i,t):this._createTreeNodeModel(i,this._rootNodeLibraries)},_createTreeNodeModel:function(e,t,i){var n=this,r=t instanceof o,s=e.publishOnConnect;delete e.publishOnConnect;var c=new a(e);if(c.id=e.id,c.mxid=e.mxid,c.plmType=e.plmType,e.isFavorite&&(c.isFavorite=!0),e.created&&(c.created=e.created),c._instanceType="LibraryEditor/TreeNodeModel",c._loadingcounter=0,c.getID=function(){var e=this.id;return e&&""!==e||(e=this.plmType),e},c.getMXID=function(){var e=this.mxid;return e&&""!==e||(e=this.plmType),e},c.options.oldLabel=e.label,c.pathId=(r?"root":t.pathId)+","+c.getID(),"TRUE"===s){var u=l.getWebappsAssetUrl("LibraryEditor","icons/libraryPublishBadge.png");c.setBadges({bottomRight:u})}c.onPostExpand(function(e){if(!e.data||!e.data.expandAll){var t=[];if(this&&this.getChildren){var i=this.getChildren();UWA.is(i,"array")&&i.forEach(function(e){t.push(e.getID())})}d.libraryStructurePreference.add(this.pathId,t)}}),c.onPostCollapse(function(e){d.libraryStructurePreference.remove(this.pathId)}),C(c).subscribe({event:"removeChild"},function(e){if(c.isExpanded()&&c.isVisible()){var t=e.nodeModel;!t&&e.data&&(t=e.data.nodeModel),t&&d.libraryStructurePreference.remove(t.pathId)}}),C(c).subscribe({event:"addChild"},function(e){if(c.isExpanded()&&c.isVisible()){var t=e.nodeModel;!t&&e.data&&(t=e.data.nodeModel),t&&t._isExpanded&&d.libraryStructurePreference.add(t.pathId)}}),r?t.addRoot(c):t.addChild(c,i);var h=function(e){r?c[e]():t.isExpanded()?(c.isVisible()&&"select"===e&&n._libraries_TreeDocument.getXSO().empty(),("expand"!==e||!c.isExpanded()&&"expanding"!==c.getState())&&c[e]()):C(t).subscribeOnce({event:"postExpand"},function(t){"expanding"!==c.getState()&&("select"===e&&n._libraries_TreeDocument.getXSO().empty(),c[e]())})},f=widget?widget.defaultSelectionPathFromWin:null;return d.libraryStructurePreference.isExpanded(c.pathId,function(e){(e||f&&-1!=f.indexOf(c.pathId))&&(n.dataProvider.isPreferenceSection(c.plmType)&&!n._rootNodeFavorite&&(n._rootNodeFavorite=c),h("expand"))}),f?f==c.pathId&&h("select"):d.libraryStructurePreference.isSelected(c.pathId,n.defaultSelectedSection,function(e){e?h("select"):c.pathId===n._TreeNodeToBeAddedtoLibraryCSOWithoutSelection_pathId&&(n.CSOProvider.addInCSO(c,"TREE"),n._TreeNodeToBeAddedtoLibraryCSOWithoutSelection_pathId=void 0)}),c},_scrollToVisibleNode:function(e){var t=this._libraries_TreeView,i=t.layout.getColumnIndex("tree"),n=t.layout.getCellsFromNodeModel(e)[i];t.scrollToCellAt({cellID:n})},_scrollOnPostUpdateView:function(e){var t=this,i=this._libraries_TreeView?this._libraries_TreeView:null,n=d.libraryStructurePreference.doScrollAfterSelect(e.getID());i&&n&&i.onPostUpdateViewOnce(function(){d.libraryStructurePreference.doScrollAfterSelect(e.getID())&&(t._scrollToVisibleNode(e),d.libraryStructurePreference.scrollAfterSelect(""))})},onContextualMenuReady:function(e){var t=this;return new Promise(function(i){var n=e.cellInfos,r=void 0;try{r=n.nodeModel?n.nodeModel:n.cellModel}catch(e){}if(r)if(r&&t.dataProvider.getContextualMenu){var o=t.CSOProvider.getSelectedNodes(),a=[];o.length&&o.forEach(function(e){a.push(e)}),a.length&&a.forEach(function(e){e.unselect()});var s=!1;if(n.nodeModel)if(!1===n.nodeModel._isSelected&&(n.nodeModel._isSelected=!0,n.nodeModel.select(!0)),!0===n.nodeModel._isSelected)(n.nodeModel?n.nodeModel:n.cellModel)&&(s=!0);s?t.dataProvider.getContextualMenu(n).then(function(e){e&&e.forEach(function(e){"separator"===e.type||"SeparatorItem"===e.type?e.type="SeparatorItem":e.label&&(e.title=e.label,e.action={callback:e.callback},e.type="PushItem")}),i(e)}):i([])}else i([]);else i([])})},onViewChange:function(e){this.elements.container.removeClassName(e.previous.type),this.elements.container.addClassName(e.type)},getSortingContainer:function(){return this._libraries_SortElmt.elements.container},setObjectOnCompass:function(e){h.setObject_on_compass({nodes_2_open:e})},render:function(){return this},isTreeNodeModelInstance:function(e){return e instanceof a},_shouldAcceptDrag:function(e){var t=this.CSOProvider.getCurrentObject();return!(!t||!t.isFavorite)},_shouldAcceptDrop:function(e){return!e||"middle"!==e.dropPosition||"Library"!==e.draggedNodes[0].plmType||!e.draggedNodes[0].isFavorite}})}),define("DS/IPClassifyUX/LibraryTree",["UWA/Class","DS/Logger/Logger","DS/IPClassifyUX/views/LibraryTreeView","DS/IPClassifyUX/models/LibraryTreeModel","DS/IPClassifyUtil/IPClassifyAlert","DS/IPClassifyUX/events/IPClassifyEvents","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/PADUtils/PADProbes","DS/PlatformAPI/PlatformAPI","css!DS/IPClassifyUX/IPClassifyUX","DS/WidgetServices/WidgetServices","DS/IPClassifyUX/models/LibrarySearchModel","UWA/Controls/Abstract","DS/PADServices/utils/GlobalModelEvents"],function(e,t,i,n,r,o,a,s,l,d,c,u,h,f){"use strict";var p=h.extend({name:"LibraryTreeController",_libraryTreeView:null,_probeLoadElmt:null,_logger:null,_libraryContentView:null,init:function(e){this._parent(e),this._probeLoadElmt=s.createProbe("loadTreeCont"),this.dataProvider=e.dataProvider,this.CSOProvider=e.CSOProvider,this._libraryTreeView=new i(e,this),this._libraryTreeView.createLibrarySections(this.dataProvider.getSectionsData()),this._libraryTreeView.getSortingContainer().inject(this._libraryTreeView.elements.container),this._OnTreeComponentReady(),this.dispatchEvent.call(this,"onReady"),this._logger=t.getLogger(p)},_OnTreeComponentReady:function(){var e=this;o.onCurrentLibraryChange(function(t){if(n.libraryStructurePreference.select(this.pathId),this.id&&""!==this.id&&e.dataProvider.isValidType(this.plmType)){for(var i=e.CSOProvider.getCurrentObjectPath(),r=[],o=Array.isArray(i)?i.length:0,a=0;a<o-1;a++)r.push({resourceid:i[a].id,type:i[a].type});var s={};if(o>=1){var d=o-1;i[d].id&&(s[i[d].id]={type:i[d].type,label:i[d].label})}var u=[];t.currentNode&&!e.dataProvider.isSection(t.currentNode.getType())&&(t.currentNode.systemType=i[o-1].type,u=[t.currentNode]),e._libraryTreeView.setObjectOnCompass(u),c.isNatifEnvironnement()||e._libraryTreeView._commandProxy.select({paths:[[this.id]],attributes:s,libraryPath:r,doNotSetOnCompass:!0})}else e.dataProvider.isSection(this.plmType)&&e._libraryTreeView._commandProxy.select({paths:[],attributes:{},libraryPath:[],doNotSetOnCompass:!0});e._libraryTreeView._scrollOnPostUpdateView(t.currentNode);var h=JSON.stringify(e.dataProvider.getSecurityContextAndData());l.publish("LibraryEditor.CurrentLibrary",h)}),f.getModelEvents().subscribe({event:"select_breadcrumb_object"},function(t){e.expandTreeAndSelectLibrary({libraryToFindAndSelect:t,onComplete:function(e){console.log(" expandTreeAndSelectLibrary:onComplete")},onGiveUp:function(e){console.log(" expandTreeAndSelectLibrary:onGiveUp")},onFailure:function(e){r.displayNotification({message:e instanceof Error?e.message:e,className:"error"})}})}),o.onTreeSortChange(function(t){if(e.getView()._libraries_TreeView){var i=e.getView()._libraries_TreeView;i.sortModel=[{dataIndex:"tree",sort:"asc"===t.sortOrder?"asc":"desc",sortFunction:e.dataProvider.comparator}],i.reapplySortModel()}}),o.onActivateTreeItem(function(t){var i=t.resourceid,n=t.mxid,o=t.type,s=t.label;i&&e.dataProvider.isValidType(o)?e.expandTreeAndSelectLibrary({libraryToFindAndSelect:{id:i,mxid:n,type:o,name:s},onComplete:function(e){console.log(" expandTreeAndSelectLibrary:onComplete")},onGiveUp:function(e){console.log(" expandTreeAndSelectLibrary:onGiveUp")},onFailure:function(e){r.displayNotification({message:a.replace(a.get("msg_error_LibraryActivate"),{name1:s}),className:"error"})}}):console.log("Selected (Double Clicked) object is not library")}),o.onLibraryRename(function(t){var i=JSON.stringify(t,(()=>{const e=new WeakSet;return(t,i)=>{if("object"==typeof i&&null!==i){if(e.has(i))return;e.add(i)}return i}})()),n=JSON.parse(i).oldNode.id,r=JSON.parse(i).newLabel;e.updateNodeLabel(n,r)}),this._probeLoadElmt.end()},updateNodeLabel:function(e,t){var i,n=[],r=UWA.is(e,"string")?e:e.physicalid?e.physicalid:null;(n=r?this._getNodesById(r):[e]).length>0&&t&&(i=t,n.forEach(function(e){if(e.getLabel()!==i){e._lastUpdateTime=Date.now();var t=UWA.extend(e.options,{label:i,oldLabel:i},!0);e.withTransactionUpdate(function(){e.updateOptions(t)})}}))},_getNodesById:function(e,t){var i=[],n=[],r=this;t?i=[t]:r.getView()._libraries_TreeDocument.getRoots().forEach(function(e){e&&"LibrarySection_favorite"!=e.plmType&&i.push(e)});return i.forEach(function(t){t.getID()==e&&n.push(t);var i=t.getChildren();UWA.is(i,"array")&&i.forEach(function(t){r._getNodesById(e,t).forEach(function(e){n.push(e)})})}),n},destroy:function(){this._logger.log("destroy"),this._parent()},_onPreExpandTreeNode:function(e){var t=e.data.nodeModel;if(!t.preExpandInProgress){t.preExpandInProgress=!0;var i=this,r=t.options.id,o=t.options.id;n.setExpandAllOperation(e.data.expandAll),i.dataProvider.isValidType(t.plmType)&&!t.isFavorite?(t.removeChildren(),n.fetchLibraryContents({parentNodeID:r,parentNodeMXID:o,parentPath:t.pathId},i.dataProvider.expandObject).then(function(e){e&&e.length>0&&i._libraryTreeView._populateContentSection(e,t),null===t.options.children&&(t.options.children=[]),a()},function(e){a(),i._logger.log("WebService libraries Err : "+e)})):i.dataProvider.isPreferenceSection(t.plmType)?(t.removeChildren(),i._refreshFavoriteSection({onComplete:function(){a()}})):i.dataProvider.isSection(t.plmType)?(t.removeChildren(),n.fetchAllLibraries(t.pathId,i.dataProvider.getRootSectionContents).then(function(e){i._libraryTreeView._populateAllLibrariesSection(e,t),a()},function(e){a(),i._logger.log("WebService roots Err : "+e)})):a()}function a(){t.preExpandInProgress=!1,t.preExpandDone(),"expanded"===t.getState()&&t.setState({state:"expanded"})}},_refreshFavoriteSection:function(e){var t=this;t._libraryTreeView._rootNodeFavorite?n.getFavorites(t.dataProvider,{onComplete:function(i){t._libraryTreeView._populateFavoriteSection(i),e&&e.onComplete&&e.onComplete()},onFailure:function(i){t._logger.warn("LibraryTreeCont : unable to initialize list of Favorite Libraries",i),r.displayNotification({message:a.msg_error_nopreferences,className:"error"}),e&&e.onFailure&&e.onFailure(i)}}):(t._logger.log("LibraryTreeCont : LibrarySection_favorite node does not yet exist"),e&&e.onFailure&&e.onFailure(new Error("LibrarySection_favorite node does not yet exist")))},isLibraryAmongFavoriteLibraries:function(e){var t=!1;if(e){var i=this._libraryTreeView._rootNodeFavorite.getChildren();if(i)for(var n=0;n<i.length;++n){if(e==i[n].id){t=!0;break}}}return t},addFavorite:function(e){if(e){var t=this,i=Array.isArray(e)?e:[e];n.setFavorites(t.dataProvider,{favoriteLibraries:i,onComplete:function(e){for(var i=0;i<e.length;++i){var n=e[i];t._libraryTreeView._addFavouriteNode(n);var o=n.label?n.label:"";r.displayNotification({message:a.replace(a.get("msg_info_favoriteadded"),{name1:o}),className:"primary"})}},onFailure:function(e){t._logger.warn("WebService setFavorites Err : "+e)}})}else t._logger.log("LibraryTreeCont unable to addFavorite, newFavoriteLibrary(s) is not define")},addNewNode:function(e){var t=null;e.parentid&&(t=this._getNodesById(e.parentid)[0]);this._libraryTreeView.addNewNode(e,t)},removeFavorite:function(e){for(var t,i=this,s=!1,l=i._libraryTreeView._rootNodeFavorite.getChildren(),d=Array.isArray(l)?l.length:0,c=0;c<d;++c){var u=l[c];if(e.id==u.id){s=u.isSelected(),t=e.name?e.name:"",i._libraryTreeView._rootNodeFavorite.removeChild(u),!1===i._libraryTreeView._rootNodeFavorite.hasChildren()&&i._libraryTreeView._rootNodeFavorite.withTransactionUpdate(function(){i._libraryTreeView._rootNodeFavorite.removeChildren(),i._libraryTreeView._rootNodeFavorite.setState({state:"collapsed"})});break}}var h="";i.CSOProvider.getCurrentObject()&&(h=i.CSOProvider.getCurrentObject().getType()),i.dataProvider.isPreferenceSection(h)&&o.notifyRemoveNodeInContent(e.id),n.removeFromFavorites(i.dataProvider,{favoritesToRemove:e.id,onComplete:function(e){e||o.notifyFavoriteSectionEmpty(),r.displayNotification({message:a.replace(a.get("msg_info_favoriteremoved"),{name1:t}),className:"primary"}),s&&i._libraryTreeView._rootNodeFavorite.select()},onFailure:function(e){i._logger.warn("WebService getFavorites Err : "+e),r.displayNotification({message:a.msg_error_nopreferences,className:"error"})}})},renameFavorite:function(e,t,i){var s=this;function l(e,t){e.prepareUpdate(),e.setLabel(t),e.pushUpdate()}function d(){i&&l(i,e.name),r.displayNotification({message:a.replace(a.get("msg_error_rename"),{name1:e.name}),className:"error"})}n.getFavorites(s.dataProvider,{onComplete:function(c){for(var u,h=c,f=0,p=0;p<h.length;++p)if(u=h[p],e.id==u.physicalid){u.label=t,f=1;break}f?n.setFavorites(s.dataProvider,{favoriteLibraries:[{id:u.physicalid,name:u.label}],renamed:!0,onComplete:function(n){i&&i._instanceType&&"LibraryEditor/TreeNodeModel"==i._instanceType||s._libraryTreeView._rootNodeFavorite.getChildren().forEach(function(i){i&&e.id==i.id&&l(i,t)});r.displayNotification({message:a.replace(a.get("msg_info_favoriterenamed"),{name1:e.name,name2:t}),className:"primary"}),o.notifyLibraryRename({oldNode:e,newLabel:t})},onFailure:function(e){s._logger.warn("WebService setFavorites Err : "+e),d()}}):(s._logger.warn("LibraryTreeCont favorite library to rename, not found in list"),d())},onFailure:function(e){s._logger.warn("WebService getFavorites Err : "+e),r.displayNotification({message:a.msg_error_nopreferences,className:"error"}),d()}})},expandTreeAndSelectLibrary:function(e){var t=e&&e.libraryToFindAndSelect?e.libraryToFindAndSelect.id:void 0,i=this;if(t){var r=i._getVisibleNodeById(t,null);if(r){i.CSOProvider.getCurrentObject();if(e.doNotSelectInTree?i.CSOProvider.addInCSO(r,"TREE"):(i._libraryTreeView._scrollToVisibleNode(r),r.select(!0)),e.onComplete){var o={libraryToFindAndSelect:e.libraryToFindAndSelect,correspondingTreeNodeModel:r};e.onComplete(o)}}else{var s=i.CSOProvider.getCurrentObject(),l=i.CSOProvider.getCurrentObjectPath(),d=l.length;if(1===d&&i.dataProvider.isPreferenceSection(l[0].type)||e.isInvisible||u.isSearchActive())n.getLibraryPathLength(i.dataProvider.getObjectPathLength,{pid:t,onComplete:function(e){d=e,p()},onFailure:function(e){}});else if(1===d&&i.dataProvider.isSection(l[0].type)){var c="root,"+l[0].type,h=c+","+t;n.libraryStructurePreference.add(c),n.libraryStructurePreference.select(h),n.libraryStructurePreference.scrollAfterSelect(t),n.libraryStructurePreference.remove(h);var f=i._libraryTreeView._rootNodeLibraries;"expanding"!==f.getState()&&f.expand()}else p()}}else i._logger.log("expandTreeAndSelectLibrary error : libraryToFindAndSelect is undefined"),e.onFailure&&e.onFailure(new Error("Tree exploration stopped, libraryToFindAndSelect is undefined"));function p(){n.getLibraryPath(i.dataProvider.getObjectPath,{depth:d,pid:t,onComplete:function(r){if(!function(e){var t=!1;if(i.CSOProvider.getCurrentObject()!==s&&(t=!0,e.onGiveUp)){var n={libraryToFindAndSelect:e.libraryToFindAndSelect};e.onGiveUp(n)}return t}(e))if(i._libraryTreeView._rootNodeLibraries){for(var o=null,l=null,d=i._libraryTreeView._rootNodeLibraries,c=d.pathId,u=0;u<r.length;++u){var h=r[u],f=h.physicalid;if(i.dataProvider.isRoot(h)&&(l=f),f){if(!o){var p=i._getVisibleNodeById(f,d);p&&p.isVisible()?(d=p,c=p.pathId):o=d}if(o){var g=c;n.libraryStructurePreference.add(g),d=null,c=c+","+f}}else i._logger.log("unexpected undefined parentObjectId")}if(l)if(o){var m=g+","+t;if(e.doNotSelectInTree?(n.libraryStructurePreference.select(""),n.libraryStructurePreference.scrollAfterSelect(""),i._TreeNodeToBeAddedtoLibraryCSOWithoutSelection_pathId=m):(n.libraryStructurePreference.select(m),n.libraryStructurePreference.scrollAfterSelect(t)),n.libraryStructurePreference.remove(m),"expanding"!==o.getState()&&o.expand(),e.onComplete){var v={libraryToFindAndSelect:e.libraryToFindAndSelect};e.onComplete(v)}}else console.log("   Damnation, no firstUnexpandedTreeNodeModelParentFound"),e.onFailure&&e.onFailure(new Error(a.msg_error_TreeExpandCancelledInternalError));else e.onFailure&&e.onFailure(new Error(i.dataProvider.getObjectNotVisiblemessage()))}else i._logger.log("  No LibrarySection_AllLibraries to start expandTreeAndSelectLibrary"),e.onFailure&&e.onFailure(new Error(a.msg_error_TreeExpandCancelledNotReady))},onFailure:function(t){i._logger.log("WebService getLibraryPath Err : "+t),e.onFailure&&e.onFailure(t)}})}},_getVisibleNodeById:function(e,t){var i=t||this._libraryTreeView._rootNodeLibraries,n=null;if(i&&i.isVisible())if(i.getID()===e)n=i;else if(i.isExpanded()){var r=i.getChildren();if(Array.isArray(r)&&r.length>=1)for(var o=0;o<r.length;o++){var a=r[o];if(a){if(a.id==e){n=a;break}var s=this._getVisibleNodeById(e,a);if(s&&s.isVisible()){n=s;break}}}}return n},refreshLibraryTree:function(){this._libraryTreeView._rootNodeFavorite.isExpanded()&&(this._libraryTreeView._rootNodeFavorite.collapse(),this._libraryTreeView._rootNodeFavorite.expand()),this._libraryTreeView._rootNodeLibraries.isExpanded()&&(this._libraryTreeView._rootNodeLibraries.collapse(),this._libraryTreeView._rootNodeLibraries.expand())},switchLibraryTreeNodeLabelToWriteView:function(e){var t=!1;if(e.getTreeDocument()===this._libraryTreeView._libraries_TreeDocument&&this._libraryTreeView._libraries_TreeView){var i=this._libraryTreeView._libraries_TreeView;if(i){var n=i.getCell(e._getRowID(),"tree"),r=n?n.getView():void 0;r&&(r.switchToWriteView(),t=!0)}}return t},getView:function(){return this._libraryTreeView},performOperationOnNode:function(e,t){e[t]()}});return p}),define("DS/IPClassifyUX/service/PlatformServices",["UWA/Core","UWA/Promise","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/IPClassifyUX/service/SettingsManagement"],function(e,t,i,n){"use strict";var r=function(){};return r.prototype.initializePlatform=function(e){var t=this;i.getPlatformServices({onComplete:function(i){if(null===i){i.options=e;var r=e.onFailure;r&&r("cannot retrieve platform data")}else{for(var o={},a=widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",s=0;s<i.length;s++)i[s].platformId===a&&(t.platformurls=o.platformurls=i[s]);n.addSetting("platformServices",t),o.options,(0,e.onComplete)(o)}},onFailure:function(t){var i=e.onFailure;i&&i(t)}})},r}),define("DS/IPClassifyUX/LibraryContent",["UWA/Class","DS/Logger/Logger","DS/IPClassifyUX/views/LibraryContentView","DS/IPClassifyUX/models/LibraryContentModel","DS/IPClassifyUX/views/IPClassifyTagger","DS/IPClassifyUX/events/IPClassifyEvents","DS/PADUtils/PADProbes","DS/WidgetServices/WidgetServices","DS/PADServices/utils/AttributesMgtV2","DS/IPClassifyUtil/IPClassifyAlert","DS/IPClassifyUtil/IPClassifyUtility","DS/PADUtils/PADSession","DS/PADUtils/PADSettingsMgt","DS/IPClassifyUX/views/InformationsPanelView","DS/IPClassifyUX/service/PlatformServices","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","i18n!DS/SNResultUX/assets/nls/SNResultUX","DS/IPClassifyUX/models/LibrarySearchModel","DS/IPClassifyUX/utils/IPClassifyWidgetData","DS/IPClassifyUX/utils/IPClassifyModeManager","css!DS/IPClassifyUX/IPClassifyUX","DS/IPClassifyUX/views/additionalData/ThumbnailAttribute","DS/IPClassifyUX/views/LibraryLeftSidePanelView"],function(e,t,i,n,r,o,a,s,l,d,c,u,h,f,p,g,m,v,_,b,C,y,S){"use strict";var I=e.extend({name:"LibraryContentController",_tagNavigator:null,_libraryContentView:null,_infoPanelView:null,_refreshProductStructure:!1,_LibraryLeftPanel:null,init:function(e){this._probeLoadElmt=a.createProbe("loadComponent");var n=this;e.additionalColumnsModules||(e.additionalColumnsModules=[]),e.thumbnailAttributeDelayed&&e.additionalColumnsModules.push(y),this._libraryContentView=new i(e),this.dataProvider=e.dataProvider,this.leftState=e.leftState,this.rightState=e.rightState,this.CSOProvider=e.CSOProvider,o.onContentReady(function(){n._OnPADComponentReady()}),this._logger=t.getLogger(I)},_OnPADComponentReady:function(){var e=this;e._LibraryLeftPanel=new S({padshell:e._libraryContentView.elements.padshell,dataProvider:e.dataProvider}),e.leftState&&!e.leftState.isWelcomePanelCollapsed?e.getView().elements.padshell.togglePanel("left"):(e.getView().elements.padshell.togglePanel("left"),e._mode="load",o.onPageToolBarExpand(function(){"load"!=e._mode&&(e._mode="open",e.getView().elements.padshell.togglePanel("left"),o.notifyPageToolBarExpanded())}),o.onPageToolBarCollapse(function(){e._mode="close",e.getView().elements.padshell.togglePanel("left"),o.notifyPageToolBarCollapse()}),o.onTaggerOpen(function(){e.getView().elements.padshell._modelEvents.publish({event:"triptych-hide-panel",data:"left"}),o.notifyPageToolBarCollapse()}),o.onTaggerClose(function(){"open"===e._mode?(e.getView().elements.padshell._modelEvents.publish({event:"triptych-show-panel",data:"left"}),o.notifyPageToolBarExpanded()):(e.getView().elements.padshell._modelEvents.publish({event:"triptych-hide-panel",data:"left"}),o.notifyPageToolBarCollapse())})),e._tagNavigator=new r,e._tagNavigator._initTaggerProxy(),e._libraryContentView.addTabPages(),e._libraryContentView.cleanColumns(),y.setCheckToShowThumbnail(e._libraryContentView.toShowThumbnail.bind(e._libraryContentView)),e._libraryContentView.addEvent("onToggleView",function(){e._libraryContentView.setTabStyleOnView(),e.loadContentAndSelect()}),l.getAvailableColumnsOpts()&&e.dataProvider.setColumnNames&&e.dataProvider.setColumnNames(l.getAvailableColumnsOpts(),l.getTreeColumn()),v.onSearchChange(function(t,i){e.loadContentAndSelect()}),o.onCurrentLibraryChange(function(t){e._libraryContentView.options.model.getModelEvents().publish({event:"titleRecalc",data:t.currentNode.getLabel()}),v.getSearchValue()||(e._isColumnUnderProcessing=!0,e.dataProvider.getTabsVisOnSelectionChange&&e._libraryContentView.setTabsVis(e.dataProvider.getTabsVisOnSelectionChange()),e._isColumnUnderProcessing=!1,e.loadContentAndSelect(this))}),o.onLibraryRename(function(t){var i=t.oldNode.getLabel();t.oldNode.id===e.CSOProvider.getCurrentObject().getID()&&UWA.is(widget)&&e._libraryContentView.options.model.getModelEvents().publish({event:"titleRecalc",data:i})}),o.onCurrentLibraryFilterChange(function(){e.loadContentAndSelect(null,null,!1,!0)}),o.onCurrentLibraryColumnChange(function(){e.loadContentAndSelect(null,null)}),o.onRemoveNodeInContent(function(t){e.getView().removeNodeInContent(t)}),o.onScrollEnd(function(){n.isMoreDataToFetch()?n.isFetchInProgress()||(n.setFetchInProgress(!0),e.loadContentAndSelect(null,null,!b.staleContentAfterSilentSwitch)):e._libraryContentView.infiniteScrollDone()}),o.onContentTabChange(function(){e._isColumnUnderProcessing=!0,e._libraryContentView.removeNodesInContent(),e._libraryContentView.toggleView("treeview"),e._libraryContentView.loadNewColumns(),e._isColumnUnderProcessing=!1,e.loadContentAndSelect(null,null)}),o.onColumnSortChange(function(){e._libraryContentView.saveSortModelInCache(),e.loadContentAndSelect(null,null)}),o.onFavoriteSectionEmpty(function(){e.managePlaceholderDisplay(0)&&e.getView()._addPlaceHolder()}),e._libraryContentView.setSortOnColumn().then(function(){var t=e.CSOProvider.getCurrentObject();t&&(e.dataProvider.getTabsVisOnSelectionChange&&e._libraryContentView.setTabsVis(e.dataProvider.getTabsVisOnSelectionChange()),e._libraryContentView.options.model.getModelEvents().publish({event:"titleRecalc",data:e.CSOProvider.getCurrentObject().getLabel()}),e.loadContentAndSelect(t))});var t=c.isIndexedMode();u.setAuthoringState(!t),e.dataProvider.hasLibrarianRole().then(function(t){(new p).initializePlatform({onComplete:function(i){e._infoPanelView=new f({padshell:e._libraryContentView.elements.padshell,CSOProvider:e.CSOProvider,securityContext:h.getSetting("pad_security_ctx"),platformUrls:i.platformurls,readOnly:t.readOnly,isLeaderRole:t.isLeader,isOwnerRole:t.isOwner,dataProvider:e.dataProvider})}})}).catch(function(e){console.log(e)});var i=widget.getValue("customLeftWidth");e._libraryContentView._addStyleOnTreeCont(i),null!=i&&e._libraryContentView.elements.padshell._modelEvents.publish({event:"triptych-set-size",data:{side:"left",size:i}}),e._libraryContentView.elements.padshell._modelEvents.subscribe({event:"triptych-panel-show-started"},function(t){"left"===t&&e._libraryContentView._addStyleOnTreeCont()}),e._libraryContentView.elements.padshell._modelEvents.subscribe({event:"triptych-panel-visible"},function(e){"left"===e&&s.clearJSStylesheet("treeContResize")}),e._libraryContentView.elements.padshell._modelEvents.subscribe({event:"triptych-resized"},function(e){"left"===e.side&&widget.setValue("customLeftWidth",e.width)}),o.notifyPageToolBarExpand(),this._probeLoadElmt.end()},webInWinCtxMenu:function(e,t){this._libraryContentView.showWebInWinCtxMenu(e,t)},onWebInWinFilterChange:function(e){this._tagNavigator.onFilterChange(e.data)},updateFilterBI:function(e){e?this._tagNavigator||(this._tagNavigator=new r,this._tagNavigator._initTaggerProxy()):this._tagNavigator&&this._tagNavigator.unsetTags(),u.setAuthoringState(!e);var t=this._libraryContentView.getPADTreeDocument();null!==t&&(t.options.filterBIComponentProxy=this._tagNavigator)},updateComputedColumns:function(){this._libraryContentView.setSortingForComputedAttrs()},loadContentAndSelect:function(e,t,i,n,r){var o,s,l,d=this;if(!d._isColumnUnderProcessing)return!0!==i&&(i=!1),!0!==n&&(n=!1),!0!==r&&(r=!1),d._libraryContentView.enableTreeColumnEdit(!1),d.dataProvider.initColumns&&d.dataProvider.initColumns(d._libraryContentView.getPADTreeListView().getManager().layout.getLeafColumns()),e||(e=d.CSOProvider.getCurrentObject()),e&&(e.getType&&(o=e.getType()),e.getID&&(s=e.getID()),l=e.options.mxid?e.options.mxid:""),new Promise(function(h,f){var p=null,g=_.getWidgetData();if(d.dataProvider.toEnableTreeColumnEdit&&d.dataProvider.toEnableTreeColumnEdit(o,g)&&d._libraryContentView.enableTreeColumnEdit(!0),u.setAuthoringState(!c.isIndexedMode()),d.dataProvider.isValidType(o)&&s)p=d.displayLibraryContents({containerType:o,containerId:s,containerMXID:l,idsToSelect:t,newCurrentContainer:e,isPaginationOperation:i,isFilterOperation:n,isNewInsertMode:r}),b.updateRefreshTime(),h(p);else if(d.dataProvider.isPaginatedSection(o))d.managePlaceholderDisplay()||d.getView().removePlaceHolder(),d._libraryContentView.cleanColumns(),d.displayAllLibraries({idsToSelect:t,isPaginationOperation:i,isFilterOperation:n,isNewInsertMode:r},o).then(function(e){b.updateRefreshTime(),h(e)});else if(d.dataProvider.isPreferenceSection(o))d.managePlaceholderDisplay()||d.getView().removePlaceHolder(),d._libraryContentView.cleanColumns(),d.displayFavouriteLibraries(t,o),b.updateRefreshTime(),h(p);else{var m=a.createProbe("unknown_container_clean");d._libraryContentView.cleanColumns(),v.isSearchActive()&&v.clearSearch(),d._libraryContentView.removeNodesInContent(),d._libraryContentView.maskContentDiv(!1),d._libraryContentView._endLoadAndSelect(),m.end(),b.updateRefreshTime(),h(p)}})},displayLibraryContents:function(e){var t=a.createProbe("probeDisplayLibraryContents"),i=this;i._libraryContentView.maskContentDiv(!0);var n=e.containerType,r=v.getSearchValue(),o=r?e.newCurrentContainer.options.mxid:e.containerId,s=!1;function l(){var e=!1;return"Library"===n&&!1===c.isIndexedMode()&&(e=!0),e}!r||-1==r.indexOf(":")&&-1==r.indexOf("=")&&-1==r.indexOf(">")&&-1==r.indexOf("<")||(s=!0);var d=l()&&(null==r||""===r);function u(t){var a=[],c=[];t&&(d?t.dynamicattributesName&&(c=t.dynamicattributesName):t.dynamicattributes&&(c=t.dynamicattributes),a.push(new Promise(function(e){i._libraryContentView.displayDynamicAttributes(t,d).then(function(t){e()})})),t.unitPredicates&&(c=c.concat(t.unitPredicates)));var u={};i._libraryContentView.getPADTreeListView().getManager().layout.getLeafColumns().forEach(function(e){if(e.convertInfos){var t=e.convertInfos,i=e.dataIndex;u[i]=t.dimension}}),Promise.all(a).then(function(){i.getContentOfLibraryOrClass({containerId:o,containerMXID:e.containerMXID,searchQuery:r,isExactSearch:s,selectedType:n,isStartFromBeg:!e.isPaginationOperation,dynamicattributes:c,libraryData:e,isAuthMode:d,isNewInsertMode:e.isNewInsertMode,attributesDimMap:u},l())})}e.isPaginationOperation||!this.dataProvider.getObjectDynamicAttributes?u():this.dataProvider.getObjectDynamicAttributes({id:o,type:n},d).then(function(e){e||i._libraryContentView.cleanColumns(),u(e)},function(){u(),t.end()})},getContentOfLibraryOrClass:function(e,t){var i=a.createProbe("probeDisplayLibraryContents"),r=this,o=!1===t&&r._tagNavigator?r._tagNavigator._getCurrentFilter():null,s=r._libraryContentView.getSortingOrder(e.isAuthMode);n.fetchLibraryContents({containerId:e.containerId,containerMXID:e.containerMXID,searchQuery:e.searchQuery,isExactSearch:e.isExactSearch,selectedType:e.selectedType,filters:o,isStartFromBeg:e.isStartFromBeg,dynamicattributes:e.dynamicattributes,sortOrder:s,physicalId:e.libraryData.containerId,attributesDimMap:e.attributesDimMap,isAuthoringMode:e.isAuthMode},r.dataProvider.getObjectContents).then(function(n){var o=n.contents,a=n.infos,s=n.facets;if(a&&b.updateLastIndexTime(a),r.managePlaceholderDisplay(n.contents.length)?r.getView()._addPlaceHolder():r.getView().removePlaceHolder(),r._tagNavigator)if(t)r._tagNavigator.unsetTags();else if(!e.libraryData.isPaginationOperation){var l=!e.libraryData.isFilterOperation;r._tagNavigator._setSubjectTags(s,e.libraryData.containerType,l),r._tagNavigator.activateTaggerProxy()}var d=v.isSearchInProgress();e.searchQuery&&a&&(v.setInfoIndex(a),e.libraryData.newCurrentContainer.options.contentAvailable=!0),r._libraryContentView._endContentSelect();var c=null;if(r.CSOProvider.getCurrentObject()&&(c=r.CSOProvider.getCurrentObject().getID(),e.searchQuery&&(c=r.CSOProvider.getCurrentObject().options.mxid)),c!==e.containerId)return r._libraryContentView._endRefreshView(),void r._libraryContentView._endLoadAndSelect();var u=null;if(null==o)d||r._libraryContentView.removeNodesInContent(),r._libraryContentView.maskContentDiv(!1);else{var h=[];if(r._refreshProductStructure){var f=r._libraryContentView.getPADTreeDocument().getRoots(),p=0,g=f.length;for(p=0;p<g;p++){var m=f[p];m.options.type;f[p].isExpanded()&&h.push(m)}}var _=!e.libraryData.isPaginationOperation;if(u=r._libraryContentView.displayContentNodes(o,h,e.libraryData.idsToSelect,_,e.isNewInsertMode),r._refreshProductStructure&&h.length>0){r._refreshProductStructure=!1;var C=r._libraryContentView.getPADTreeListView();r._libraryContentView.getPADTreeDocument().refresh({treelist:C,roots:[],cb:function(e){r._logger.log("Refresh PS : "+e.msg)}})}}return r._libraryContentView._endLoadAndSelect(),i.end(),u},function(e){var n,o=e.err,a=e.serverErr;r._logger.log("WebService content, Err : "+o),r._libraryContentView.removeNodesInContent(),r._tagNavigator&&t&&r._tagNavigator.unsetTags(),n=o&&"timeout"===o.type?g.msg_error_timeout:v.isSearchActive()&&a&&"object"==typeof a&&a.error&&a.error.errorCode?m.get(a.error.errorCode):e.msg,d.displayNotification({message:n,className:"error"}),r._libraryContentView.maskContentDiv(!1),r._libraryContentView._endLoadAndSelect(),i.end()})},displayFavouriteLibraries:function(e,t){var i=a.createProbe("probeDisplayFavLibraries"),r=this;r._libraryContentView.maskContentDiv(!0),n.fetchAllFavorites(this.dataProvider).then(function(n){r.managePlaceholderDisplay(n.length)?r.getView()._addPlaceHolder():r.getView().removePlaceHolder();var o="";r.CSOProvider.getCurrentObject()&&(o=r.CSOProvider.getCurrentObject().getType()),o==t?(r._libraryContentView.displayFavouriteNodes(n,e),r._tagNavigator&&(r._tagNavigator._setSubjectTags({},r._tagNavigator.CONTENT_TYPES.EMPTY,!0),r._tagNavigator.activateTaggerProxy())):r._libraryContentView._endRefreshView(),r._libraryContentView.maskContentDiv(!1),r._libraryContentView._endLoadAndSelect(),i.end()},function(e){r._logger.log("getFavorites, Err : "+e),r._libraryContentView.maskContentDiv(!1),r._libraryContentView._endLoadAndSelect(),i.end()})},displayAllLibraries:function(e,t){var i=a.createProbe("probeDisplayAllLibraries"),r=this,o=e.idsToSelect,s=e.isPaginationOperation,l=e.isNewInsertMode,c=v.getSearchValue();r._libraryContentView.maskContentDiv(!0);var u=r._libraryContentView.getSortingOrder();return new Promise(function(a){n.fetchAllLibraries({filters:r._tagNavigator?r._tagNavigator._getCurrentFilter():null,isStartFromBeg:!s,searchQuery:c,sortOrder:u},r.dataProvider.getPaginatedSectionContents).then(function(n){if(n&&n.infos&&(b.updateLastIndexTime(n.infos),n.infos.sources&&n.infos.sources.length>0&&n.infos.sources[0].error)){var c=n.infos.sources[0],u=c.error.errorMessage;console.error("Error with federated search: ["+c.error.errorCode+"] "+u),d.displayNotification({title:g.msg_error_with_federated_search_title,message:g.msg_error_with_federated_search_message,className:"error"})}r.managePlaceholderDisplay(n.results.length)?r.getView()._addPlaceHolder():r.getView().removePlaceHolder();var h="";if(r.CSOProvider.getCurrentObject()&&(h=r.CSOProvider.getCurrentObject().getType()),h==t){var f=(n="string"==typeof n?JSON.parse(n):n).results?n.results:[];if(r._tagNavigator&&!s){var p=!e.isFilterOperation;r._tagNavigator._setSubjectTags(n.facets,t,p),r._tagNavigator.activateTaggerProxy()}r._libraryContentView._endContentSelect();var m=!e.isPaginationOperation,v=r._libraryContentView.displayContentNodes(f,null,o,m,l)}else r._libraryContentView._endRefreshView();r._libraryContentView._endLoadAndSelect(),i.end(),a(v)},function(e){r._logger.log("WebService roots, Err : "+e),r._libraryContentView._endLoadAndSelect(),i.end(),a(null)})})},refreshLibraryContent:function(){var e=this.getView().getPADTreeDocument();e&&e.keepExpandedState();var t=this.CSOProvider.getCurrentObject(),i=t.getType();(!t.isVisible()&&!t.isFavorite||this.dataProvider.isSection(i))&&this.loadContentAndSelect(t)},switchLibraryTreeNodeLabelToWriteView:function(e){var t=!1;if(this._libraryContentView.getPADTreeDocument()&&e.getTreeDocument()===this._libraryContentView.getPADTreeDocument()){var i;"datagridview"===this._libraryContentView.getActiveView()&&(i=this._libraryContentView.getPADTreeListView());var n=i?i.getManager():void 0;if(n){var r=n.layout.getColumnIndex("tree"),o=n.layout.getCellsFromNodeModel(e)[r],a=n.getEditionManager(o);a.onF2&&(n.setActiveCell(o),a.onF2(o),t=!0)}}return t},getView:function(){return this._libraryContentView},managePlaceholderDisplay:function(e){if(s.isNatifEnvironnement())return!1;var t=this.CSOProvider.getCurrentObject().getType(),i=_.getWidgetData();return!!this.dataProvider.isValidTypeForPlaceholder(t,i)&&(!v.isSearchActive()&&0===e)}});return I});