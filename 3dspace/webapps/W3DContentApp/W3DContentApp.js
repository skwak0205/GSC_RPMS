define("DS/W3DContentApp/Views/InodeDetailView/inodeDetailViewFunc",["UWA/Class/View","UWA/Core","UWA/String","UWA/Array","DS/UIKIT/Tooltip","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e,t,n,i,o,r){"use strict";function s(e,t){return!e.action||t.isActionIdoK(e.action)}function a(e){const i=t.createElement("li",{class:"navigation__header",html:[{tag:"span",class:"navigation__icon fonticon "+n.format("fonticon-{0}",e.icon||"")},{tag:"span","data-key":e.key||"",class:"navigation__data"}]});return new o({target:i,body:e.nls}),e.selected&&i.classList.add("navigation__header--selected"),i}return{createHeader:function(e,n){let i;const s=t.createElement("div",{class:"inode-detail__header",html:[t.createElement("span",{class:"inode-detail__header-title",text:e.get("alias")?e.get("alias"):e.get("title")}),i]});return n&&"function"==typeof n.onClickCloseIcon&&(i=t.createElement("span",{class:"fonticon fonticon-close inode-detail__header-icon"}),new o({target:i,body:r.close}),i.addEventListener("click",n.onClickCloseIcon),s.insertBefore(i,s.firstChild)),s.destroy=function(){n&&"function"==typeof n.onClickCloseIcon&&i.removeEventListener("click",n.onClickCloseIcon)},s},refreshHeader:function(e,t){return e.classList.contains("inode-detail__header-title")||(e=e.querySelector(".inode-detail__header-title")),e?(e.innerText=t,e):e},getNavigationHeaderKey:function(e){if(e&&e.nodeType===Node.ELEMENT_NODE&&(e.classList.contains("navigation__data")||(e=e.querySelector(".navigation__data"))))return e.getAttribute("data-key")},getViewKey:function(e,t,n){if(e){var o=i.detect(n.detailViewsList,function(t){return e===t.key});if(o&&s(o,t))return o.key}return n.defaultView},createNavigation:function(e,t,n){var i=n.filter(function(e){return s(e,t)}).map(function(t){return t.selected=e===t.key,t}).map(a);i.length>2&&(i[0].classList.add("navigation__header--left"),i[i.length-1].classList.add("navigation__header--right"));var o=function(e){var t=document.createElement("ul");return t.classList.add("navigation"),[].concat(e).map(function(e){t.appendChild(e)}),t}(i);return o.classList.add("inode-detail__navigation"),o},refreshNavigation:function(e,t){var n=function(e,t){var n=e.querySelector(".navigation__data[data-key="+t+"]");if(n)return n.parentNode}(e,t);if(n){var i=n.parentNode.parentNode.querySelector(".navigation__header--selected");i&&n!==i&&(i&&i.classList.remove("navigation__header--selected"),n.classList.add("navigation__header--selected"))}},getBodyElemKey:function(e){return e.getAttribute("data-key")},wrapBody:function(e){var t=document.createElement("div");return t.classList.add("inode-detail__body-wrapper"),t.appendChild(e),t},createBody:function(e,t){if(!e)throw new Error("Missing input");var n=e.view;if("function"==typeof n){var i=n(t);return i.container.classList.add("inode-detail__body"),i.container.setAttribute("data-key",e.key),i}},refreshBodyWithView:function(e,t){e.classList.contains("inode-detail__body")||(e=e.querySelector(".inode-detail__body"));var n=e.parentNode;return n.removeChild(e),n.appendChild(t.container),t.render(),t},getView:function(t){var n=new e(t);return n.container.classList.add("inode-detail"),n}}}),define("DS/W3DContentApp/Components/copyLinkToClipboard",["DS/UIKIT/Input/Button","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e,t){"use strict";return function(n){if(!n||!n.urlLink)throw new Error("Missing input");return new e({className:"link",value:t.get("copyLink"),events:{onClick:function(){navigator.clipboard.writeText(n.urlLink).then(()=>{this.load(!0,t.get("copyLinkDone")),setTimeout(this.load.bind(this,!1),2e3)})}}})}}),define("DS/W3DContentApp/Views/InodeDetailView/versionsView",["DS/WebAppsFoundations/Views/CollectionView","DS/W3DXComponents/Views/EmptyView","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/W3DContentApp/W3DContentApp.css"],function(e,t,n){"use strict";return function(i){if(!i||!i.collection||!i.itemView)throw new Error("Missing input");var o=new e({className:"w3ddrive versions w3dx tiles fixed relaxed",collection:i.collection,emptyView:new t({icon:"navigation-history",title:n.noHistory})});return Object.assign(o,{_buildItemView:function(e){return i.itemView({model:e})}})}}),define("DS/W3DContentApp/Metas/permission",["DS/WebappsUtils/WebappsUtils"],function(e){"use strict";return function(){return{actionPubIds:{removePermission:"removePermission",makeReader:"makeReader",makeWriter:"makeWriter",makeWriterShare:"makeWriterShare",makeReaderShare:"makeReaderShare",enableShare:"enableShare",disableShare:"disableShare",transferOwnership:"transferOwnership",makeContributor:"makeContributor",makeAuthor:"makeAuthor",makeLeader:"makeLeader",makeLeaderOwner:"makeLeaderOwner",makeOwner:"makeOwner",makeMainOwner:"makeMainOwner",makePublicReader:"makePublicReader"},thumbnails:{people:e.getWebappsAssetUrl("W3DContentApp","thumbnails/default-people.png")}}}}),define("DS/W3DContentApp/Metas/errors",[],function(){"use strict";return function(){return{xmlhttprequestCodes:{BAD_REQUEST:400,UNAUTHORIZED:401,PAYMENT_REQUIRED:402,FORBIDDEN:403,NOT_FOUND:404,CONFLICT:409,PRECONDITION_FAILED:410,INTERNAL_SERVER_ERROR:500},w3ddrive:{ressourceAccess:"res_acc_err",noToken:"no_token_err",duplication:"duplication",inodeAccessError:"inodeAccessError"}}}}),define("DS/W3DContentApp/Utils/createTasksSession",["UWA/Class/Promise","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e,t){"use strict";function n(e){e.returnValue=t.get("onBeforeUnload")}return function(t){var i=t||7,o=function(){var e=[];return{push:function(t){return t=[].concat(t).filter(function(e){return"function"==typeof e}),e.push(t),e.length},shift:function(){var t=e[0];if(t){var n=t.shift();return t.length||e.splice(0,1),n}}}}();function r(){if(!(i<=0)){var e=o.shift();e&&(e().then(r),r())}}return function(t){var s=(t=[].concat(t).filter(function(e){return"function"==typeof e})).map(function(){return e.deferred()}),a=t.map(function(e,t){return function(){var n=e();return--i,n.then(function(){++i,s[t].resolve(Array.prototype.slice.apply(arguments))},function(){++i,s[t].reject(Array.prototype.slice.apply(arguments))})}});o.push(a),r(),window.addEventListener("beforeunload",n);var l=[],c=[];return s.reduce(function(e,t){return e.then(function(){return t.promise.then(function(){l.push(arguments[0])},function(){c.push(arguments[0])})})},e.resolve()).then(d,d);function d(){return window.removeEventListener("beforeunload",n),c.length?e.reject(c.reduce(function(e,t){return e.concat(t)},[])):e.resolve(l.reduce(function(e,t){return e.concat(t)},[]))}}}}),define("DS/W3DContentApp/Metas/inode",["DS/WebappsUtils/WebappsUtils"],function(e){"use strict";const t=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/SWV1_Part.svg"),n=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/SWV1_Assembly.svg"),i=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/SWV1_Drawing.svg"),o=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/CATV5_Assembly.svg"),r=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/CATV5_Drawing.svg"),s=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/CATV5_Part.svg"),a=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/EASM.svg"),l=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/EDRW.svg"),c=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/EPRT.svg"),d=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/STL.svg"),u=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/3DXML.svg"),p=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/DWG.svg"),m=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/IGES.svg"),f=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/DXF.svg"),g=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/OBJ.svg"),h=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/STEP.svg"),v=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/VRML.svg"),D=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/3MF.svg"),w=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/3PDF.svg"),b=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/SLDX.svg"),C=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/ComposerSmg.svg"),S=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/AxF.png"),y=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpac2DGrid.svg"),A=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacBlockModel.svg"),W=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacBlockModelConstraint.svg"),I=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacDataRecorderConfiguration.svg"),E=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacDTM.svg"),x=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacExperimentalVariogram.svg"),V=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacGeologyDatabase.svg"),T=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacGraphicsStyles.svg"),_=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacScript.svg"),L=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacPlot.svg"),P=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacPluginBlockModel.svg"),U=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacRange.svg"),O=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacString.svg"),N=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacSurpacWorkArea.svg"),k=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacSurveyDatabase.svg"),M=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacVariogram.svg"),F=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASDM.svg"),R=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/MineSched.svg"),B=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/MineSchedAnimation.svg"),j=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/SpreadsheetDocument.svg"),q=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/PresentationDocument.svg"),H=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/RichTextDocument.svg"),K=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/DIAG.svg"),z=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/PROJ.svg"),X=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/PDF.svg"),G=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/Image.svg"),J=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/Video.svg"),$=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/Audio.svg"),Q=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/Revit.png"),Y=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/TextDoc.svg"),Z=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/ZIP.svg"),ee=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/Email.svg");return function(){return{mimeType:{folder:"text/directory",pdf:"application/pdf",collabSpace:"collaborative Space"},ids:{trueRoot:"trueRootId",sharedWithMe:"sharedwithme"},actionPubIds:{share:"share",shareWithUsers:"shareWithUsers",publishTo3DSwym:"publishTo3DSwym",shareContent:"shareContent",moveTo:"moveTo",copy:"copy",changeProperties:"changeProperties",editTitle:"editTitle",editDescription:"editDescription",editDocument:"editDocument",del:"delete",delFinal:"deletefinal",createFolder:"createFolder",uploadFolder:"uploadFolder",upload:"upload",download:"download",preview:"preview",openWith:"openWith",insert:"insert",comment:"comment",viewInformation:"viewInformation",viewAccesses:"viewAccesses",viewHistory:"viewHistory",viewShareWithExternal:"viewShareWithExternal",createCollabSpace:"createCollabSpace",update:"update",editCS:"editCS",addMember:"addMember",addMemberRestricted:"addMemberRestricted",changeThumbnail:"changeThumbnail",addContent:"addContent",moveToCS:"moveToCS",editContent:"editContent",viewAnalytics:"viewAnalytics",downloadVersion:"downloadVersion",restoreVersion:"restoreVersion",restore:"restore",addToMyDrive:"addToMyDrive",changeAlias:"changeAlias",removeFromMyDrive:"removeFromMyDrive",removeOwnAccess:"removeOwnAccess",addToFavorites:"addToFavorites",removeFromFavorites:"removeFromFavorites",openFileLocation:"openFileLocation",getLink:"getLink"},thumbnails:{content:e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/UnknownFile.svg"),folder:e.getWebappsAssetUrl("W3DContentApp","thumbnails/folder.svg"),sharedFolder:e.getWebappsAssetUrl("W3DContentApp","thumbnails/folder-shared.svg"),sldprt:t,sldasm:n,slddrw:i,eprt:c,easm:a,edrw:l,catpart:s,catproduct:o,catdrawing:r,"3dxml":u,"3mf":D,dwg:p,dxf:f,sldxml:b,u3d:w,iges:m,igs:m,obj:g,stp:h,step:h,stpx:h,stpz:h,stpxz:h,stl:d,vrml:v,smg:C,smggeom:C,smgxml:C,smgview:C,smgsce:C,axf:S,bmf:P,bpr2:P,con:W,ddb:V,dm:P,dms:P,dtm:E,evg:x,grid:y,mdl:A,minesched:R,mineschedanimation:B,pf:L,rng:U,sdb:k,ssi:T,str:O,swa:N,sdm:F,sdf:I,tbc:_,tcl:_,vgm:M,xls:j,xlsb:j,xlsm:j,xlsx:j,xlt:j,xltm:j,xltx:j,numbers:j,csv:j,pot:q,potm:q,potx:q,pps:q,ppsm:q,ppsx:q,ppt:q,pptm:q,pptx:q,keynote:q,txt:Y,log:Y,doc:H,docm:H,docx:H,dot:H,dotm:H,dotx:H,rtf:H,msg:ee,mpp:z,vsd:K,vsdx:K,pdf:X,svg:G,png:G,jpg:G,jpeg:G,gif:G,tiff:G,tif:G,bmp:G,psd:G,ai:G,wmv:J,mp4:J,mov:J,avi:J,webm:J,mkv:J,ogv:J,mpg:$,wma:$,mp3:$,wav:$,rvt:Q,zip:Z},icons:{folder:"folder",sharedFolder:"folderShare"},mediaType:{sldprt:"3dmodel",sldasm:"3dmodel",slddrw:"3dmodel",eprt:"3dmodel",easm:"3dmodel",edrw:"3dmodel",catpart:"3dmodel",catproduct:"3dmodel",catdrawing:"3dmodel","3dxml":"3dmodel","3mf":"3dmodel",dwg:"3dmodel",dxf:"3dmodel",sldxml:"3dmodel",u3d:"3dmodel",iges:"3dmodel",igs:"3dmodel",obj:"3dmodel",stp:"3dmodel",step:"3dmodel",stpx:"3dmodel",stpz:"3dmodel",stpxz:"3dmodel",stl:"3dmodel",vrml:"3dmodel",smg:"3dmodel",smggeom:"3dmodel",smgxml:"3dmodel",smgview:"3dmodel",smgsce:"3dmodel",axf:"3dmodel",grid:"3dmodel",mdl:"3dmodel",con:"3dmodel",sdf:"3dmodel",dtm:"3dmodel",evg:"3dmodel",ddb:"3dmodel",ssi:"3dmodel",minesched:"3dmodel",mineschedanimation:"3dmodel",tcl:"3dmodel",tbc:"3dmodel",pf:"3dmodel",dm:"3dmodel",dms:"3dmodel",bmf:"3dmodel",bpr2:"3dmodel",rng:"3dmodel",str:"3dmodel",swa:"3dmodel",sdb:"3dmodel",vgm:"3dmodel",sdm:"3dmodel",rvt:"3dmodel",xls:"document",xlsx:"document",xlsm:"document",numbers:"document",csv:"document",ppt:"document",pptx:"document",keynote:"document",txt:"document",log:"document",doc:"document",docx:"document",msg:"document",mpp:"document",vsd:"document",vsdx:"document",pdf:"document",png:"picture",jpg:"picture",jpeg:"picture",gif:"picture",tiff:"picture",tif:"picture",bmp:"picture",psd:"picture",ai:"picture",wmv:"video",mp4:"video",mov:"video",avi:"video",mpg:"audio",wma:"audio",mp3:"audio",wav:"audio",zip:"document"}}}}),define("DS/W3DContentApp/Metas/drive",[],function(){"use strict";return function(){return{ids:{dropbox:"dropbox",google2:"google2",drivesHub:"drivesHub",onedrive:"onedrive",box:"box"},actionPubIds:{storage:"storage",disconnect:"disconnect"}}}}),define("DS/W3DContentApp/Views/Lightbox/lightboxPreviewVideo",["UWA/Class/Promise","css!DS/W3DContentApp/W3DContentApp.css"],function(e){"use strict";var t;return{init:function(i){function o(i){return i?i.getFileUrl().then(function(e){return n(t,e)}).catch(function(){return n(t,i.getDefaultThumbnail())}):e.resolve()}if(i=i||{},t)return o(i.inode),t;return t=Object.assign(function(){var e=document.createElement("video");e.setAttribute("controls",""),e.setAttribute("autoplay",!0),e.setAttribute("muted",!1),e.setAttribute("preload","auto"),e.setAttribute("width","100%"),e.setAttribute("height","100%"),e.setAttribute("controlslist","nodownload");var t=document.createElement("source");return t.classList.add("video-source"),e.appendChild(t),e}(),{refresh:o}),o(i.inode),t},pauseVideo:function(){document.pictureInPictureElement&&document.exitPictureInPicture();if(t)return t.pause();return}};function n(t,n){var i=function(e,t){var n=e;return n.classList.contains(t)||(n=n.querySelector("."+t)),n}(t,"video-source");return new e(function(e){i.setAttribute("src",n.url||""),i.setAttribute("type","video/"+n.extension||""),t.load(),e(t)})}}),define("DS/W3DContentApp/Views/SuperModal",["DS/UIKIT/SuperModal","css!DS/UIKIT/UIKIT.css"],function(e){"use strict";var t=new e({className:"w3ddrive",closable:!0,renderTo:document.body}),n=t.modalFactory,i=function(e){e.stopPropagation()};return t.modalFactory=function(){var e=n.apply(this,arguments),o=e.elements.container;return e.onShowModal=function(){t.next(),o.addEventListener("click",i)},e.onHide=function(){setTimeout(function(){o.removeEventListener("click",i)})},e},t}),define("DS/W3DContentApp/BusEvent",["UWA/Class/Events"],function(e){"use strict";return new e}),define("DS/W3DContentApp/Utils/IntegrationHelper",["DS/W3DDrive/widget","DS/W3DDrive/Metas/DSDrive/inode"],function(e,t){"use strict";var n=t(),i={};window.parent.swxDriveService&&(i.SWIntegration=window.parent.swxDriveService);var o=e.getValue("addinmode");return"catiav5"===o?i.CATIAV5=!0:"solidworks"===o&&(i.SW=!0),i.SWIntegration&&(i.SWCheckShared=function(e){for(var t=e;t&&t.collection;)if((t=t.collection.dot()).id===n.ids.sharedWithMe)return!0;return!1}),i}),define("DS/W3DContentApp/Views/UploadInodesView/taskViewSet",["DS/WebAppsFoundations/Views/Plugins/Set"],function(e){"use strict";return new e}),define("DS/W3DContentApp/Utils/Store",[],function(){"use strict";return{resetStore:function(){this.currentTenant=null,this.features={},this.servicesUrl={}},currentTenant:null,features:{},servicesUrl:{}}}),define("DS/W3DContentApp/Models/Stub",[],function(){"use strict";function e(e,t){if(t){var n=t.onComplete,i="function"==typeof e.toJSON?e.toJSON():{};"function"==typeof n&&n(e,i,t),"function"==typeof e.dispatchEvent&&e.dispatchEvent("onSync",[e,i,t])}}return{fetch:function(t){e(this,t)},save:function(t,n,i){e(this,i)}}}),define("DS/W3DContentApp/Utils/getKeyboardeventKey",[],function(){"use strict";var e,t={3:"Cancel",6:"Help",8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",28:"Convert",29:"NonConvert",30:"Accept",31:"ModeChange",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",41:"Select",42:"Print",43:"Execute",44:"PrintScreen",45:"Insert",46:"Delete",48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],91:"OS",93:"ContextMenu",144:"NumLock",145:"ScrollLock",181:"VolumeMute",182:"VolumeDown",183:"VolumeUp",186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"'],224:"Meta",225:"AltGraph",246:"Attn",247:"CrSel",248:"ExSel",249:"EraseEof",250:"Play",251:"ZoomOut"};for(e=1;e<25;e++)t[111+e]="F"+e;var n="";for(e=65;e<91;e++)n=String.fromCharCode(e),t[e]=[n.toLowerCase(),n.toUpperCase()];return function(e){if(e.key)return e.key;var n=t[e.which||e.keyCode];return Array.isArray(n)&&(n=n[+e.shiftKey]),n}}),define("DS/W3DContentApp/Views/UploadInodesView/taskView",["UWA/Core","UWA/Class/View","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e,t,n){"use strict";function i(e,t,i){if(!(e instanceof window.HTMLElement&&t))return!1;var o,r,s=t.progress,a=t.isCancelled,l=t.isError,c=0===s,d=100===s,u=e.querySelector(".status");if(Array.isArray(u)||(u=u?[u]:[]),d){var p=!(o=i.get("createdDate"),r=i.get("modifiedDate"),Math.abs(o-r)<=5e3)||i.collection&&i.collection.get(i.id)?n.updated:n.completed;return u.forEach(function(e){e.setText(p)}),e.removeClassName("processing"),e.addClassName("completed"),!0}if(a){var m=e.querySelector(".cancel-btn");return u.forEach(function(e){e.setText(n.cancelled)}),e.removeClassName("processing"),e.addClassName("cancelled"),m.addClassName("hidden"),!0}return l?(u.forEach(function(e){e.setText(n.error)}),e.removeClassName("processing"),e.addClassName("error"),!0):c?(u.forEach(function(e){e.setText(n.pending)}),e.removeClassName("processing"),e.addClassName("pending"),!0):void 0}return function(n,o){var r=new t(Object.assign({className:"w3ddrive task-view"},n)),s={isCancelled:!1},a=r.destroy;function l(){var e=i(r.container,Object.assign({},s,n),o);return e&&r.dispatchEvent("onFinish",[r]),e}function c(){return function(e,t){if(!(e instanceof window.HTMLElement&&t))return!1;var n=t.progress,i=e.querySelector("progress"),o=i.parentElement,r=e.querySelector(".cancel-btn");return 0<n&&n<100&&o.classList.add("processing"),n>0&&n<.9&&r.classList.remove("hidden"),n>=.9&&r.classList.add("hidden"),!!(i?[i]:[]).map(function(e){e.value=n})}(r.container,n)}function d(){return function(e,t){if(!(e instanceof window.HTMLElement&&t))return!1;var n=t.title,i=e.querySelector(".title");return Array.isArray(i)||(i=i?[i]:[]),!!i.map(function(e){e.textContent=n})}(r.container,n)}function u(){s.isCancelled=!0,function(e){!e||!e.dispatchEvent||(e.inode&&e.inode._dispatchers&&e.inode._dispatchers.onCancel&&e.inode._dispatchers.onCancel.bindings&&e.inode._dispatchers.onCancel.bindings.length?e.inode.dispatchEvent("onCancel"):e.inode.uploadCancelled=!0)}(r)}return r.inode=o,r.delegateDOMEvents({"click .cancel-btn":function(){var e=n.progress;e>0&&e<.9&&u()}}),Object.assign(r,{render:function(){r.container.setContent([e.createElement("div",{class:"title"}),e.createElement("progress"),e.createElement("div",{class:"status"}),e.createElement("div",{class:"cancel-wrapper",html:e.createElement("i",{class:"fonticon fonticon-status-ko cancel-btn hidden"})})]),l(),d(),c()},refreshStatus:l,refreshProgress:c,refreshTitle:d,cancelUpload:u,refreshError:function(e){e&&(s.isError=Boolean(e),l())},destroy:function(){return r.stopListening(),r.container=null,r.model=null,r.undelegateDOMEvents(),a.apply(r,arguments)}})}}),define("DS/W3DContentApp/Collections/Stub",[],function(){"use strict";return{comparator:null,fetch:function(e){!function(e,t){if(t){var n=t.onComplete,i="function"==typeof e.toJSON?e.toJSON():{};"function"==typeof n&&n(e,i,t),"function"==typeof e.dispatchEvent&&e.dispatchEvent("onSync",[e,i,t])}}(this,e)}}}),define("DS/W3DContentApp/Components/EmailBadgesForm",["UWA/Class/View","UWA/Core","UWA/String","DS/UIKIT/Badge","DS/UIKIT/Input/Text","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e,t,n,i,o,r){"use strict";return e.extend({tagName:"div",className:"emailbadges__component",setup:function(e={}){if(!(e&&e.hasOwnProperty("initialBadgesCount")&&e.existingPermissionsLink&&e.hasOwnProperty("maxBadgesLimit")))throw new Error("Missing input");return this.existingPermissionsLink=e.existingPermissionsLink,this.initialBadgesCount=e.initialBadgesCount,this.maxBadgesLimit=e.maxBadgesLimit,this.render()},render:function(){const e=this;this.elements.badgesContainerElement=t.createElement("div",{class:"badges__container"});const i=t.createElement("div",{html:r.get("addRestrictedEmailInstructions")});return this.elements.input=new o({placeholder:r.get("enterAnEmail"),disabled:this.initialBadgesCount>=this.maxBadgesLimit}),this.elements.badgesRemainingElement=t.createElement("div",{class:"badges__remaining",text:r.get("restrictionsCount",{count:this.initialBadgesCount,max:this.maxBadgesLimit})}),this.elements.badgesWarningMessageElement=t.createElement("div",{class:"badges__warningmessage hidden"}),this._isBadgesLimitReached()&&this._toggleLimitReachedMessage(!0),this.elements.input.getContent().addEventListener("keydown",function(e){9===e.keyCode&&(e.preventDefault(),e.stopPropagation())}),this.elements.input.getContent().addEventListener("keyup",function(t){let i=e.elements.input.getValue().trim();if(/(;)/i.test(i))i=i.substr(0,i.length-1);else if(![9,13].includes(t.keyCode))return;n.isEmail(i)&&(e._addNewBadge(i),e.elements.input.setValue(""))}),this.elements.input.getContent().addEventListener("drop",function(t){t.preventDefault(),t.dataTransfer.getData("text").split(";").forEach(t=>{n.isEmail(t)&&e._addNewBadge(t)})}),[i,this.elements.badgesContainerElement,this.elements.input,this.elements.badgesWarningMessageElement,this.elements.badgesRemainingElement].reduce((e,t)=>(t.nodeName||(t=t.getContent()),e.appendChild(t),e),this.container),this},_addNewBadge:function(e){const t=this;if(this._checkDuplicatedBadges(e))return this.elements.badgesWarningMessageElement.innerHTML=r.get("duplicatedRestriction",{name:e}),this.elements.badgesWarningMessageElement.classList.toggle("hidden",!1),void window.setTimeout(()=>{this.elements.badgesWarningMessageElement.classList.toggle("hidden",!0)},3e3);const n=new i({content:e,selectable:!0,closable:!0,events:{onClose:function(){t.elements.badgesContainerElement.removeChild(n.elements.container),t._updateRestrictionsCount(),t._isBadgesLimitReached()||(t.elements.input.enable(),t._toggleLimitReachedMessage(!1)),t._dispatchEvent({eventName:"onBadgeChange",eventOptions:{disableFormValidationButton:0===t._getRestrictionsCount()}})}}});this.elements.badgesContainerElement.appendChild(n.elements.container),this._updateRestrictionsCount(),this._isBadgesLimitReached()&&(this.elements.input.disable(),this._toggleLimitReachedMessage(!0)),t._dispatchEvent({eventName:"onBadgeChange",eventOptions:{disableFormValidationButton:0===this._getRestrictionsCount()}})},_getRestrictionsCount:function(){return this.initialBadgesCount+this._getBadgesCount()},_isBadgesLimitReached:function(){return this._getRestrictionsCount()>=this.maxBadgesLimit},_getBadgesCount:function(){return Array.prototype.slice.call(this.elements.badgesContainerElement.childNodes).length},_updateRestrictionsCount:function(){const e=this._getRestrictionsCount();this.elements.badgesRemainingElement.textContent=r.get("restrictionsCount",{count:e,max:this.maxBadgesLimit})},_checkDuplicatedBadges:function(e){return!!this.existingPermissionsLink.some(t=>t.get("emailAddress").toLowerCase()===e.toLowerCase())||Array.prototype.slice.call(this.elements.badgesContainerElement.childNodes).some(t=>t.textContent.toLowerCase()===e.toLowerCase())},_toggleLimitReachedMessage:function(e){this.elements.badgesWarningMessageElement.innerHTML=r.get("restrictedEmailsNumberLimitReached"),this.elements.badgesWarningMessageElement.classList.toggle("hidden",!e)},_dispatchEvent:function(e){if(!e||!e.eventName)throw new Error("Missing input");let t;const n=e.eventName;document.createEvent?(t=document.createEvent("Event")).initEvent(n,!0,!0):t=new Event(n),Object.assign(t,e.eventOptions),this.container.dispatchEvent(t)}})}),define("DS/W3DContentApp/Utils/Metrics",["DS/Usage/TrackerAPI","DS/W3DDrive/widget"],function(e,t){"use strict";return{trackAction:function(e){if(!e.model)throw new Error("A model is mandatory to track an action.");var i=e.model,o=t.data.is3DSpaceWidget?"X3DCSMA_AP":"X3DDRIV_AP",r=i.drive?i.drive.id:"",s="X3DCSMA_AP"===o?"3dspace.action":"3ddrive.action",a=i.drive?i.drive.get("title"):"",l=e.contextView?e.contextView.replace("-view",""):"",c=e.appContext||"",d=i.get("fileExtension"),u="";u="X3DCSMA_AP"===o?i.isContainer()?"collabspace":i.get("type")?i.get("type").value:"":i.isFolder()?"folder":"file";var p={pd1:a,pd2:l,pd3:c,pd4:d,pd5:e.hasLinkedFiles,pd6:u,pd7:e.recursiveDownload};n({tenantID:r,eventCategory:s,eventAction:e.eventAction,eventLabel:e.eventLabel,eventValue:e.eventValue,eventDimensions:p})},trackNavigation:function(e){var i=e.model,o=t.data.is3DSpaceWidget?"X3DCSMA_AP":"X3DDRIV_AP",r="",s="";r=e.tenant?e.tenant?e.tenant:"":t.getValue("saved-fragment")?t.getValue("saved-fragment").split("/")[1]:"";var a="X3DCSMA_AP"===o?"3dspace.navigation":"3ddrive.navigation";i&&(s="X3DCSMA_AP"===o?i.isContainer()?"collabspace":i.get("type")?i.get("type").value:"":i.isFolder()?"folder":"file");var l={pd6:s,pd8:e.startingRouteType};n({tenantID:r,eventCategory:a,eventAction:e.eventAction,eventLabel:e.eventLabel,eventValue:e.eventValue,eventDimensions:l})}};function n(n){var i=t.data.is3DSpaceWidget?"X3DCSMA_AP":"X3DDRIV_AP",o=n.tenantID||"",r=n.eventDimensions||{};return function(e){for(var t in e)e[t]?e[t]=e[t].toString():delete e[t]}(r),e.trackPageEvent({eventCategory:n.eventCategory,eventAction:n.eventAction,eventLabel:n.eventLabel,eventValue:n.eventValue,appID:i,tenant:o,persDim:r})}}),define("DS/W3DContentApp/Utils/drivesInputs",["i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e){"use strict";return function(t){if(!t)return{};var n={forbiddenChars:{},maxchars:{},maxcharsDesc:{}},i=n.maxchars,o=n.maxcharsDesc,r=n.forbiddenChars;switch(t.drive.id){case"box":case"dropbox":i.maxLength=255,i.maxLengthText=t.isFolder()?e.replace(e.get("folderMaxLength"),{length:"255"}):e.replace(e.get("fileMaxLength"),{length:"255"}),r.regex="^((?!/)(?!\\\\).)*$",r.text=e.replace(e.get("forbiddenChars"),{chars:"/ \\"});break;case"google":i.maxLength=255,i.maxLengthText=t.isFolder()?e.replace(e.get("folderMaxLength"),{length:"255"}):e.replace(e.get("fileMaxLength"),{length:"255"}),r.regex="(.)*",r.text=e.get("requiredField");break;case"onedrive":i.maxLength=255,i.maxLengthText=t.isFolder()?e.replace(e.get("folderMaxLength"),{length:"255"}):e.replace(e.get("fileMaxLength"),{length:"255"}),r.regex='^((?!<)(?!>)(?!/)(?!\\\\)(?!:)(?!\\?)(?!\\*)(?!")(?!\\|)(?!\\.$).)*$',r.text=e.replace(e.get("forbiddenChars"),{chars:'< > / \\ : ? * " |'});break;default:"myCollabSpaces"===t.id||"myCollabSpaces"===t.get("parentId")?(i.maxLength=32,i.maxLengthText=e.replace(e.get("csMaxLength"),{length:i.maxLength}),o.maxLength=255,r.regex="([  ! & ( ) + 0-9 = A-Z ^-{ }- -])+",r.text=e.get("csForbiddenChars")):t.isFolder()?(i.maxLength=255,i.maxLengthText=e.get("folderMaxLength",{length:i.maxLength}),r.regex='^((?!<)(?!>)(?!/)(?!\\\\)(?!:)(?!\\?)(?!\\*)(?!")(?!\\|)(?!\\.$).)*$',r.text=e.get("forbiddenChars",{chars:'< > / \\ : ? * " |'})):(i.maxLength=255,i.maxLengthText=e.replace(e.get("fileMaxLength"),{length:i.maxLength}),r.regex='^((?!<)(?!>)(?!/)(?!\\\\)(?!:)(?!\\?)(?!\\*)(?!")(?!\\|).)*$',r.text=e.replace(e.get("forbiddenChars"),{chars:'< > / \\ : ? * " |'}),r.notEmpty=e.get("notEmpty"))}return n}}),define("DS/W3DContentApp/Utils/stopPropagationDropdownMenu",["DS/UIKIT/DropdownMenu"],function(e){"use strict";return e.extend({_handleItemClick:function(e,t){this._parent(e,t),e.stopPropagation()}})}),define("DS/W3DContentApp/Utils/Helpers",["UWA/Core","DS/W3DDrive/widget","DS/TransientWidget/TransientWidget","DS/PlatformAPI/PlatformAPI","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e,t,n,i,o){"use strict";var r={result:function(t,n){var i;return t&&(i=t[n],e.is(i,"function")&&(i=i.call(t))),i},replaceWith:function(e,t){if(e){var n=e.getParent();if(n)return t?n.replaceChild(t,e):e.destroy(),t}return!1},filterXSS:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},isTransientWidget:function(){return n.isWidgetOpen()},isExternalDrivesDisabled:function(){return"true"===i.getApplicationConfiguration("app.3ddrive.disableExternalDrives")},computeFileExtension:function(e){if(!("string"==typeof e||e instanceof String))return"";const t={catanalysis:"CATAnalysis",catdrawing:"CATDrawing",catmaterial:"CATMaterial",catpart:"CATPart",catprocess:"CATProcess",catproduct:"CATProduct",catshape:"CATShape",catsystem:"CATSystem"};return t.hasOwnProperty(e.toLowerCase())?t[e.toLowerCase()]:e.toUpperCase()},computeNLSSize:function(e){let t,n;e=Number(e);if(isNaN(e))throw new Error("Size input is not a number");if(e<0)throw new Error("Size input is negative");if(0===e)t=0,n=0;else{if((n=Math.floor(Math.log(e)/Math.log(1024)))>5)throw new Error("Size input is too big");const i=e/Math.pow(2,10*n),o=Math.pow(10,n>0?2:0);1024===(t=Math.round(i*o)/o)&&n<8&&(t=1,n++)}return o.replace(o[["sizeB","sizeKB","sizeMB","sizeGB","sizeTB","sizePB"][n]],{size:t})},getActionIds:function(e){if(!e)return[];if(!(e=[].concat(e)).length)return[];var t=e.map(function(t){return t.getActionIds(e.length>1)});return t.length?t.reduce(function(e,t){return e.filter(function(e){return-1!==t.indexOf(e)})}):t},listenToHierarchy:function(e,t,n){t.collection&&t.collection._parentInode&&(e.listenTo(t.collection._parentInode,n),r.listenToHierarchy(e,t.collection._parentInode,n))},getDateStr:function(e,n){if(!e)throw new Error("Missing input");const i=new Date(e),o=i.toLocaleString(t.lang,{year:"numeric",month:"short",day:"2-digit"}),r=i.toLocaleString(t.lang,{hour:"2-digit",minute:"2-digit",second:"2-digit",hourCycle:"h23"});return n?o:o+" - "+r},getTimeStr:function(e){if(!e)return null;return new Date(e).toLocaleString(t.lang,{hour:"2-digit",minute:"2-digit",second:"2-digit",hourCycle:"h23"})},isToday:function(e){if(!e)return!1;const t=new Date;return(e=new Date(e)).getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()},getAppBehaviour:function(e){var t=window.parent.location.search.substring(1);if(t)for(var n=t.split("&"),i=0;i<n.length;i++){var o=n[i].split("=");if(2===o.length&&o[0]===e)return o[1]}},getQueryHashParameter:function(e,t){const n=window.parent.location.hash.substring(1);let i;if(n){n.split("/").forEach(n=>{if(2===(n=n.split(":")).length&&n[0]===e){n[1].split("&").forEach(e=>{2===(e=e.split("=")).length&&e[0]===t&&(i=e[1])})}})}return i},isOfficeDocumentSupported:function(e){return["doc","docx","rtf"].includes(e)||["xls","xlsx","csv"].includes(e)||["ppt","pptx"].includes(e)},isTouchDevice:function(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0},isAndroidOrIphone:function(){return/(android|iPhone|iPod)/i.test(navigator.userAgent)},getSortConfiguration:function(){const e=[];return e["title-a"]={id:"title-a",attributeName:"title",fonticon:"alpha-sorting-a-z",asc:!0},e["title-d"]={id:"title-d",attributeName:"title",fonticon:"alpha-sorting-z-a",asc:!1},e["modifiedDate-a"]={id:"modifiedDate-a",attributeName:"modifiedDate",fonticon:"date-sorting-1-31",asc:!0},e["modifiedDate-d"]={id:"modifiedDate-d",attributeName:"modifiedDate",fonticon:"date-sorting-31-1",asc:!1},e["createdDate-a"]={id:"createdDate-a",attributeName:"createdDate",fonticon:"date-sorting-1-31",asc:!0},e["createdDate-d"]={id:"createdDate-d",attributeName:"createdDate",fonticon:"date-sorting-31-1",asc:!1},e["size-a"]={id:"size-a",attributeName:"size",fonticon:"num-sorting-1-2",asc:!0},e["size-d"]={id:"size-d",attributeName:"size",fonticon:"num-sorting-2-1",asc:!1},e["type-a"]={id:"type-a",attributeName:"type",fonticon:"alpha-sorting-a-z",asc:!0},e["type-d"]={id:"type-d",attributeName:"type",fonticon:"alpha-sorting-z-a",asc:!1},e["creator-a"]={id:"creator-a",attributeName:"creator",fonticon:"alpha-sorting-a-z",asc:!0},e["creator-d"]={id:"creator-d",attributeName:"creator",fonticon:"alpha-sorting-z-a",asc:!1},e}};return r}),define("DS/W3DContentApp/Utils/drawerOrchestrator",[],function(){"use strict";return function(e){var t=0;function n(){t<=0?e.children[0].style.visibility="hidden":(e.children[0].style.width=t+"px",e.children[0].style["margin-right"]="auto",e.children[0].style["margin-left"]=0)}return e.parentNode.getBoundingClientRect().width,e.style.position="absolute",e.style.width="2000px",e.style.left="100%",e.style["will-change"]="transform",{refreshInnerDrawer:n,translateNoAnim:function(i){t!==i?(0!==i&&(e.children[0].style.visibility="visible"),e.classList.remove("animate-on-transforms"),e.style.transform="translateX(-"+i+"px)",t=i,requestAnimationFrame(n)):t<=0&&(e.children[0].style.visibility="hidden")},translateAnim:function(i){t!==i&&(0!==i&&(e.children[0].style.visibility="visible"),e.classList.add("animate-on-transforms"),e.style.transform="translateX(-"+i+"px)",t=i,e.addEventListener("transitionend",function t(){e.removeEventListener("transitionend",t),e.classList.remove("animate-on-transforms"),requestAnimationFrame(n)}))},getOpenedWidth:function(){return t}}}}),define("DS/W3DContentApp/Utils/dropdownContextmenu",["DS/UIKIT/DropdownMenu"],function(e){"use strict";return e.extend({_handleEvents:function(){var e,t,n,i=this.options;i.contextual&&(this.events.target={contextmenu:function(e){e.preventDefault(),this.updatePosition(e)}.bind(this)},e=this.events.target,t=i.target,n=!0,Object.keys(e).forEach(function(i){t.addEventListener(i,e[i],n)}))}})}),define("DS/W3DContentApp/Models/DriveTreeNodeModel",["UWA/Core","DS/Tree/TreeNodeModel"],function(e,t){"use strict";let n;return n=function(i={}){var o,r;const s=i.inode,a=s&&s.inodeTable;if(!s&&!a)throw new Error("An input options is invalid");const l=["recents","favorites","TRASH"].some(e=>e===s.get("id")),c={onRemove:function(){f(!0),o.remove()},"onChange:title":p("label"),"onChange:alias":p("label"),"onChange:iconLink":p("icons")},d={onAdd:m,onReset:function(){o.removeChildren(),a.toArray().map(function(e){m(e,a)})},onSync:function(){o.preExpandDone(),(o.getChildren()&&0===o.getChildren().length||l)&&o.setState({state:"noChildren"});o.sortChildren({isRecursive:!1,sortFunction:function(e,t){if(e.getNodeDepth()>1){var n=e.options.label.localeCompare(t.options.label,void 0,{numeric:!1});return n>=1?1:-1}return 0}})}};function u(){return{label:s.get("alias")||s.get("title"),icons:(e=>[{iconName:e.get("iconLink")}])(s),children:l?[]:a.filterFiles().filter(e=>{return!(i.hiddenRootInodes||[]).includes(e.id)}).map(e=>new n({inode:e,hiddenRootInodes:i.hiddenRootInodes})),useAsyncPreExpand:!0}}function p(e){return function(e){var t;t=u(),o.prepareUpdate(),o.options[e]=t[e],o.pushUpdate()}.bind(this,e)}function m(e,t){var r;if(e.isContainer()){r=new n({inode:e,hiddenRootInodes:i.hiddenRootInodes});var s=t.filter(function(e){return e.isFolder()}).indexOf(e);o.addChild(r,s)}}function f(e){var t;s[(t=e?"remove":"add")+"Events"](c),a[t+"Events"](d)}return o=new t(e.merge(i,u())),s.isFolder()&&!l||o.setState({state:"noChildren"}),r={inode:s,getChildWithInode:function(e){var t,n;if(t=o.getChildren())return t.forEach(function(t){t.inode!==e||(n=t)}),n}},e.extend(o,r),f(),o}}),define("DS/W3DContentApp/Utils/AdvancedHelpers",["DS/WAFData/WAFData","UWA/String"],function(e,t){"use strict";return{isMemberOfUserGroups:function(n,i){const o=n.get("auth").platform;let r,s,a;return new Promise(function(l){if(o)if(r="3DDrive-"+o.id+"-groups",s=JSON.parse(window.localStorage.getItem(r))||[],a=s&&s.find(function(e){return e.name===i}),""===i)l(!0);else if(void 0===i)l(!1);else if(a){let e=new Date(a.cacheDate);Math.abs(Date.now()-e.getTime())/36e5>12?c():l(a.isMember)}else c();else l(!1);function c(){const c=t.format("{0}/search",o.urls3DSearch);e.authenticatedRequest(c,{method:"POST",type:"json",headers:{"Content-Type":"application/json"},data:JSON.stringify({with_synthesis_hierarchical:!1,with_synthesis:!1,with_synthesis_attribute:!1,source:["usersgroup"],query:'[ds6w:label]:"'+i+'"',select_predicate:["ds6w:hasMember","ds6w:responsible"],label:"bot",tenant:o.id}),onComplete:function(e){const t=n.get("user").displayName;let o=!1,c=[];if(e&&e.results){e.results.forEach(function(e){c=c.concat(e.attributes)}),o=c.filter(function(e){return"ds6w:hasMember"===e.name&&e.value===t||"ds6w:responsible"===e.name&&e.value===t}).length>0}else o=!1;a?(a.isMember=o,a.cacheDate=(new Date).toISOString()):s.push({name:i,isMember:o,cacheDate:(new Date).toISOString()}),window.localStorage.setItem(r,JSON.stringify(s)),l(o)},onFailure:function(){l(!1)}})}})},isODEFeatureEnabled:function(e){if(!e)throw new Error("Input is missing");return new Promise(t=>{e.isDsDrive?require(["DS/OfficeDocumentEditorClient/Editor"],n=>{n.isGranted?n.isGranted({platformId:e.id}).then(()=>{t(!0)},()=>{t(!1)}):t(!1)}):t(!1)})}}}),define("DS/W3DContentApp/SearchProxy",["UWA/Core","UWA/Class/Events"],function(e,t){"use strict";let n=new t;return n=e.extend(n,{getQuery:function(){return this._query},setQuery:function(e){this._query=e,this.dispatchEvent("onSetQuery",[e])},resetQuery:function(e){e=e||{},delete this._query,e.silent||this.dispatchEvent("onResetQuery")}})}),define("DS/W3DContentApp/Collections/Pagination",["UWA/Core"],function(e){"use strict";return function(t){return t.extend({finiteInt:function(t,n){if("number"!==e.typeOf(t)||isNaN(t)||!isFinite(t)||~~t!==t)throw new TypeError("`"+n+"` must be a finite integer");return t},_computeTotalPages:function(e,t){return Math.ceil(e/t)},_checkState:function(e){if(e){var t=e.totalRecords,n=e.pageSize,i=e.currentPage,o=e.firstPage,r=e.totalPages;if(null!=t&&null!=n&&null!=i&&null!=o){if(t=this.finiteInt(t,"totalRecords"),n=this.finiteInt(n,"pageSize"),i=this.finiteInt(i,"currentPage"),o=this.finiteInt(o,"firstPage"),n<1)throw new RangeError("`pageSize` must be >= 1");if(r=e.totalPages=this._computeTotalPages(t,n),o<0||o>1)throw new RangeError("`firstPage must be 0 or 1`");if(e.lastPage=0===o?Math.max(0,r-1):r||o,i<o||r>0&&(o?i>r:i>=r))throw new RangeError("`currentPage` must be firstPage <= currentPage "+(o?"<=":"<")+" totalPages if "+o+"-based. Got "+i+".")}return e}},hasPreviousPage:function(){var e=this.state;return(e?e.currentPage:void 0)>e.firstPage},hasNextPage:function(){var e=this.state;return(e?e.currentPage:void 0)<(e?e.lastPage:void 0)},getFirstPage:function(e){return this.getPage("first",e)},getPreviousPage:function(e){return this.getPage("prev",e)},getNextPage:function(e){return this.getPage("next",e)},getLastPage:function(e){return this.getPage("last",e)},getPage:function(t,n){var i=this.state,o=i?i.currentPage:void 0,r=i?i.firstPage:void 0,s=i?i.lastPage:void 0,a=t;switch(n=n||{},t){case"first":a=r;break;case"prev":a=o-1;break;case"next":a=o+1;break;case"last":a=s;break;default:a=this.finiteInt(t,"index")}return this.state=this._checkState(e.extend(i,{currentPage:a})),n.from=o,n.to=a,n.permissions?(n.permissions.state=this.state,n.permissions.fetch(n)):this.fetch(n)}})}}),define("DS/W3DContentApp/Views/Lightbox/lightboxPreviewImg",["UWA/Core","UWA/Class/Promise","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/W3DContentApp/W3DContentApp.css"],function(e,t,n){"use strict";let i,o,r;const s=(e,n,i)=>new t(t=>{o.src=n;o.onload=(n=>{(e=>!(!e||!e.src)&&Boolean(e.src.contains("/assets/thumbnails")))(n.target)?r.classList.remove("hidden"):r.classList.add("hidden"),t(e)}),o.onerror=(()=>{o.src=i,r.classList.add("hidden"),t(e)})});return{init:a=>{const l=e=>{if(!e)return t.resolve();const n=e.getDefaultThumbnail();return e.getThumbnailLink().then(e=>s(i,e.medium,n),()=>s(i,n))};return a=a||{},i?(l(a.inode),i):(i=Object.assign((o=e.createElement("img"),r=e.createElement("div",{class:"preview-img__description-container",html:[{tag:"p",class:"preview-img__title",text:n.get("previewNotAvailable")},{tag:"p",class:"preview-img__description",text:n.get("extensionNotSupported")}]}),e.createElement("div",{class:"preview-img",html:[o,r]})),{refresh:l}),l(a.inode),i)}}}),define("DS/W3DContentApp/Utils/SetOfSelectedView",["UWA/Core","DS/WebAppsFoundations/Views/Plugins/Set"],function(e,t){"use strict";const n="oneToOne";return t.extend({mode:n,init:function(e,t={}){this.enable();const n=this._parent.apply(this,arguments);return t.disabled&&(this._enabled=!1),n},enable:function(){return this._enabled=!0,this},disable:function(){return this._enabled=!1,this},set:function(e,t={}){if(t.force||this._enabled)return this._parent.apply(this,arguments)},add:function(t,i={}){const o=this.mode;if(Array.isArray(t)||(t=t?[t]:[]),!i.force)switch(o){case n:if(t.length&&t.length>1)throw new Error("Use the force option if you want an unexpected mode behaviour");return this.set(t,e.extend({merge:!1},i))}return this._parent.apply(this,arguments)}})}),define("DS/W3DContentApp/Views/DriveView/driveViewPattern",["UWA/Core","UWA/Class/View"],function(e,t){"use strict";return function(e){var n=e.model,i=new t({model:n,className:"w3ddrive drive"}),o=e.header,r=e.authenticatedBody,s=i.render,a=i.destroy;return i.listenTo(n,{"onChange:authenticated":function(){i.render()}}),Object.assign(i,{render:function(){return i.container.setContent(o),n.get("authenticated")&&(i.container.addContent(r),r.render()),o.render(),s.apply(i,arguments)},destroy:function(){return i.stopListening(),o.destroy(),r.destroy(),a.apply(i,arguments)}})}}),define("DS/W3DContentApp/Utils/Actions/Iterations/Base",["DS/W3DContentApp/BusEvent"],function(e){"use strict";return function(t){var n={actions:[],init:function(e){var t=Object.assign({},e);this.model=t.model},toJSON:function(){var e=this.model,t=this.actions.filter(function(t){return e.isActionAllowed(t.id)});return t.length?t:null},dispatchIterationActions:function(t,n){e.dispatchEvent("iteration:"+t,n)}};return n.init(t),n}}),define("DS/W3DContentApp/Views/InodeDetailView/inodeFileHistoryView",["UWA/Class/View","DS/UIKIT/Scroller","DS/UIKIT/Spinner","DS/W3DContentApp/Views/InodeDetailView/versionsView","DS/W3DContentApp/BusEvent"],function(e,t,n,i,o){"use strict";return function(r){if(!r||!r.model||!r.itemView)throw new Error("Missing input");var s=new e,a=s.destroy,l=new n({className:"inode-version__spinner"}).show(),c=r.model,d=c.inodeVersions,u=i({collection:d,itemView:r.itemView}).render();return s.container.setContent([l,u]),s.listenTo(d,{onReset:function(){l&&l.hide()}}),s.listenTo(c,{"onChange:thumbnail":function(){o.dispatchEvent("inodeFileHistoryView:onVersions",[c])}}),s.container.classList.add("inode-detail__body"),s.container.classList.add("inode-versions"),o.dispatchEvent("inodeFileHistoryView:onVersions",[c]),new t({element:s.container}),Object.assign(s,{destroy:function(){l&&l.destroy(),u&&u.destroy(),a.apply(s,arguments),s.container=null,s.stopListening()}})}}),define("DS/W3DContentApp/Views/errorDetailsModal",["DS/W3DContentApp/Views/SuperModal","DS/UIKIT/Scroller","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/UIKIT/UIKIT.css","css!DS/W3DContentApp/W3DContentApp.css"],function(e,t,n){"use strict";return function(i){var o=i.title?i.title:n.details,r=i.message?i.message:"",s="",a=i.items,l=document.createElement("div"),c=document.createElement("div");c.classList.add("errorDetail"),a.map(function(e){return s=s.concat("- ").concat(e).concat("</br>")}),c.innerHTML=s,new t({element:c}).inject(l);var d=document.createElement("div");d.innerHTML=r,d.appendChild(l);var u={title:o,body:d,buttons:[{value:n.close,action:function(e){e.hide()}}]};e.dialog(u)}}),define("DS/W3DContentApp/Components/SearchFilterAccesses",["UWA/Class/View","UWA/Core","DS/UIKIT/DropdownMenu","DS/UIKIT/Input/Text","DS/UIKIT/Tooltip","DS/W3DContentApp/Utils/Metrics","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e,t,n,i,o,r,s){"use strict";return e.extend({tagName:"div",className:"search-filter-view",setup:function(e){if(!e||!e.collection||!e.filterConfig)throw new Error("Missing input");this.options=e,this.collection=e.collection,this.filters={title:"",accessright:"",type:""},this._buildSearchElement(e.searchConfig),this._buildFilterElement(e.filterConfig)},render:function(){return this.elements.searchElement&&this.elements.searchElement.inject(this.container),this.elements.filterElement&&this.elements.filterElement.inject(this.container),this},_buildSearchElement:function(e){const n=this;let a,l,c;this.elements.searchElement=t.createElement("div",{class:"search-container",html:[{tag:"span",class:"item fonticon fonticon-search fonticon-clickable",events:{click:function(){n.elements.searchElement.hasClassName("expanded")||(l.destroy(),n.elements.searchElement.toggleClassName("expanded"),a.focus(),r.trackAction({model:n.collection._parentInode,eventAction:"searchMembers"}))}}},{tag:"span",class:"fonticon fonticon-clear fonticon-clickable",events:{click:function(){a.setValue(""),a.focus(),a.dispatchEvent("onKeyDown")}}}]}),a=new i({placeholder:s.get("SearchMembers"),events:{onKeyDown:function(){setTimeout(function(){const t=a.getValue();n.elements.searchElement.toggleClassName("active",Boolean(t)),clearTimeout(c),t!==n.filters.title&&(c=setTimeout(function(){n.filters.title=t,e.handler&&e.handler.call(n)},1e3))})}}}).inject(this.elements.searchElement,"top"),l=new o({target:this.elements.searchElement.querySelector("span.fonticon-search"),body:s.get("SearchMembers"),position:"left"}),new o({target:this.elements.searchElement.querySelector(".fonticon-clear"),body:s.get("Clear"),position:"left"})},_buildFilterElement:function(e){const i=this;this.elements.filterElement=t.createElement("span",{class:"item fonticon fonticon-filter fonticon-clickable"}),this.elements.filterMenu=new n({target:this.elements.filterElement,multiSelect:e.multiSelect,items:e.items,events:{onClick:function(){const t=this.getSelectedItems();i.elements.filterElement.toggleClassName("active",Boolean(t.length));const n=t.filter(e=>"type"===e.category);if(i.options.is3DDrive){const e=this.items.filter(e=>"accessright"===e.category);2===t.filter(e=>"accessright"===e.category).length?e.forEach(e=>{e.selected||this.disableItem(e.id)}):e.forEach(e=>{this.enableItem(e.id)})}if(i.options.is3DSpace){const e=t.filter(e=>"role"===e.category);"role"===arguments[1].category&&e.forEach(e=>{e.id!==arguments[1].id&&this.toggleSelection(e)}),r.trackAction({model:i.collection._parentInode,eventAction:"filterMembers"})}"type"===arguments[1].category&&n.forEach(e=>{e.id!==arguments[1].id&&this.toggleSelection(e)}),e.handler&&e.handler.call(i)}}}),new o({target:this.elements.filterElement,body:s.get("Filter"),position:"left"})}})}),define("DS/W3DContentApp/Utils/Actions/delete",["DS/W3DContentApp/Views/SuperModal","DS/W3DDrive/Utils/StructureNavigation","DS/W3DDrive/Metas/DSDrive/inode","DS/UIKIT/Input/Toggle","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e,t,n,i,o){"use strict";var r=n();return function(n,a){void 0===(a=a||{}).isPermanent&&(a.isPermanent=!1);var l={};if(Array.isArray(n)||!0!==n.isCollabSpace())return Array.isArray(n)&&n.length>0?n[0].drive.getInode(r.ids.trash,{noCreate:!0})&&n[0].get("parentId")!==r.ids.trash||(a.isPermanent=!0):n.drive.getInode(r.ids.trash,{noCreate:!0})&&n.get("parentId")!==r.ids.trash||(a.isPermanent=!0),l=!0!==a.isPermanent&&t.isLinkedFile(n)?function(e,t){var n=t.dispatchEvent,r=o.get("deleteElem",{name:e.get("title")}),s=document.createElement("span");s.innerHTML=o.get("confirmDeletion");var a=document.createElement("div");a.innerHTML=o.get("options"),a.classList.add("deleteview__label-options");var l={name:"deleteType",className:"primary"},c=new i(Object.assign({},l,{value:"all",label:o.get("deleteLinkedFiles")})).check(),d=new i(Object.assign({},l,{value:"one",label:o.get("deleteFileOnly")})),u=document.createElement("div");return u.classList.add("deleteview"),u.appendChild(s),u.appendChild(a),u.appendChild(c.elements.container),u.appendChild(d.elements.container),{title:r,body:u,buttons:[{className:"primary",value:o.get("deleteText"),action:function(t){t.hide();var i={};c.isChecked()&&(i.queryStrings={expand:"true"}),n("onDelete",[e,i])}},{value:o.get("cancel"),action:function(e){e.hide()}}]}}(n,a):s(n,a),e.dialog(l);n.doesItHaveContent().then(function(t){return l=t.contentTotal>0?function(e,t){var n="",i="",r=e;n=o.get("deleteElem",{name:r.get("title")}),e.drive.isCollabSpace&&"myCollabSpaces"===e.get("parentId")&&(i=o.get("InfoCSNotEmpty"));return{title:n,body:i,buttons:[{value:o.get("ok"),action:function(e){e.hide()}}]}}(n):s(n,a),e.dialog(l)})};function s(e,t){var n=t.dispatchEvent,i="",r="";if(Array.isArray(e))i=o.get("deleteElems"),r=e.length>0&&e[0].drive.get("isDrivesHubProvider")?o.get("confirmDeleteElemsExternalService"):!0===t.isPermanent?o.get("confirmPermaDeletionElems"):o.get("confirmDeleteElems");else{var s=e;i=o.get("deleteElem",{name:s.get("title")}),r=e.drive.isCollabSpace&&"myCollabSpaces"===e.get("parentId")?o.get("confirmCSDeletion"):e.drive.get("isDrivesHubProvider")?o.get("confirmDeletionExternalService"):!0===t.isPermanent?o.get("confirmPermaDeletion"):o.get("confirmDeletion")}return{title:i,body:r,buttons:[{className:"primary",value:o.get("deleteText"),action:function(i){i.hide();var o={notrash:!!t.isPermanent};n("onDelete",[e,o])}},{value:o.get("cancel"),action:function(e){e.hide()}}]}}}),define("DS/W3DContentApp/Views/InodeDetailView/inodePropertiesView",["UWA/Class/View","DS/W3DContentApp/Utils/Helpers","css!DS/W3DContentApp/W3DContentApp.css"],function(e,t){"use strict";function n(e,t,n){const i=e.querySelector('*[model-key="'+t+'"]');i&&(Boolean(n)?(i.parentElement.classList.add("property-row--visible"),n instanceof HTMLElement?i.appendChild(n):i.textContent=n):i.parentElement.classList.remove("property-row--visible"))}function i(e,t,i){var o=document.createElement("div"),r=function(e){var t=document.createElement("div");return t.textContent=e,t}(t),s=function(e){var t=document.createElement("div");return t.setAttribute("model-key",e),t}(e);return r.classList.add("property-row__cell"),r.classList.add("property-row__cell--label"),s.classList.add("property-row__cell"),s.classList.add("property-row__cell--value"),o.classList.add("property-row"),o.classList.add("inode-properties-table__property-row"),[r,s].map(o.appendChild.bind(o)),n(o,e,i),o}function o(e,n){var i;switch(i=e.value?e.value(n):n.get(e.attribute),e.type){case"string":case"element":break;case"date":i=i?t.getDateStr(i):"";break;case"bytes":i=void 0===i||i<0||n.isFolder()?"":t.computeNLSSize(i);break;default:throw new Error("Missing attribute type")}return i}return function(t){var r=t.model,s=t.listProperties,a=new e(t),l=a.destroy,c=function(e,t){var i={};return e.forEach(function(e){i["onChange:"+e.attribute]=function(i,r){r=o(e,i),n(t.container,e.key,r)}}),i}(s,a);return a.container.classList.add("inode-detail-properties"),Object.assign(a,{render:function(){a.stopListening(),a.listenTo(r,c);var e,t,n=a.container,l=function(e,t){return"trueRootId"===t.get("parentId")&&(e=e.filter(function(e){return"type"===e.key})),e.map(function(e){const n=o(e,t);return{key:e.key,txt:e.nls,val:n}})}(s,r);return n.childNodes.length<1&&n.appendChild((e=l,(t=document.createElement("div")).classList.add("properties-table"),t.classList.add("inode-properties-table"),(e=e.map(function(e){return i(e.key,e.txt,e.val)})).map(t.appendChild.bind(t)),t)),a},destroy:function(){a.stopListening(),r=null,c=null,l.apply(a,arguments),a.container=null,a.model=null,t=null}})}}),define("DS/W3DContentApp/Utils/contextHelpers",["UWA/Utils/Client","DS/W3DContentApp/Metas/inode","DS/W3DContentApp/Utils/IntegrationHelper"],function(e,t,n){"use strict";var i,o,r,s={},a=t();return(s={contexts:{iOSContext:{id:"iOSContext",isActive:!(!e.Platform.hasOwnProperty("ios")||!0!==e.Platform.ios)},CATIAV5:{id:"CATIAV5",isActive:!!n.CATIAV5}}}).actionsFilters=(i={},o={iOSFilter:{context:s.contexts.iOSContext.id,forbiddenActions:[],filter:function(e){return"object"==typeof e&&(e=e.id),-1===this.forbiddenActions.indexOf(e)}},CATIAV5Filter:{context:s.contexts.CATIAV5.id,forbiddenActions:[a.actionPubIds.preview],filter:function(e){return"object"==typeof e&&(e=e.id),-1===this.forbiddenActions.indexOf(e)}}},r=function(e,t){return t.filter(function(t){return e.filter(t)})},i.apply=function(e,t){return!!o.hasOwnProperty(e)&&r(o[filerName],t)},i.applyContext=function(e,t){return Object.keys(o).map(function(n){o[n].context===e&&(t=r(o[n],t))}),t},i.applyCurrentContexts=function(e){var t=function(){var e=[];return Object.keys(s.contexts).map(function(t){("function"==typeof s.contexts[t].isActive&&!0===s.contexts[t].isActive()||"boolean"==typeof s.contexts[t].isActive&&!0===s.contexts[t].isActive)&&e.push(s.contexts[t].id)}),e}();return Object.keys(o).map(function(n){-1!==t.indexOf(o[n].context)&&(e=r(o[n],e))}),e},i),s}),define("DS/W3DContentApp/Metas/actions",["DS/W3DContentApp/Metas/inode","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e,t){"use strict";var n=e(),i=[{id:n.actionPubIds.viewInformation,text:t.get("viewInformation"),icon:"info",fonticon:"info"},{id:n.actionPubIds.preview,text:t.get("preview"),icon:"eye",fonticon:"eye"},{id:n.actionPubIds.openFileLocation,text:t.get("OpenFileLocation"),icon:"folder-opening",fonticon:"folder-opening"},{id:n.actionPubIds.share,text:t.get("share"),icon:"share-alt",fonticon:"share-alt"},{id:n.actionPubIds.getLink,text:t.get("getLink"),icon:"link",fonticon:"link"},{id:n.actionPubIds.shareContent,text:t.get("share"),icon:"share-alt",fonticon:"share-alt"},{id:n.actionPubIds.editDocument,text:t.get("editDocument"),icon:"pencil",fonticon:"pencil"},{id:n.actionPubIds.addToFavorites,text:t.get("AddToFavorites"),icon:"favorite-add",fonticon:"favorite-add"},{id:n.actionPubIds.removeFromFavorites,text:t.get("RemoveFromFavorites"),icon:"favorite-delete",fonticon:"favorite-delete"},{id:n.actionPubIds.moveTo,text:t.get("moveTo"),icon:"move-to",fonticon:"move-to"},{id:n.actionPubIds.copy,text:t.get("copyTo"),icon:"docs",fonticon:"docs"},{id:n.actionPubIds.changeProperties,text:t.get("changeProperties"),icon:"properties-pencil",fonticon:"properties-pencil"},{id:n.actionPubIds.createFolder,text:t.get("createFolder"),icon:"folder-add",fonticon:"folder-add"},{id:n.actionPubIds.uploadFolder,text:t.get("uploadFolder"),icon:"folder-upload",fonticon:"folder-upload"},{id:n.actionPubIds.upload,text:t.get("uploadFile"),icon:"doc-upload",fonticon:"doc-upload"},{id:n.actionPubIds.download,text:t.get("download"),icon:"download",fonticon:"download"},{id:n.actionPubIds.openWith,text:n.actionPubIds.openWith,icon:"export",fonticon:"export"},{id:n.actionPubIds.insert,text:t.get("insert"),icon:"import",fonticon:"import"},{id:n.actionPubIds.update,text:t.get("update"),icon:"update",fonticon:"update"},{id:n.actionPubIds.createCollabSpace,text:t.get("newCollabSpace"),icon:"folder-add",fonticon:"folder-add"},{id:n.actionPubIds.addContent,text:t.get("addContent"),icon:"upload",fonticon:"upload"},{id:n.actionPubIds.addMember,text:t.get("addMember"),icon:"user-add",fonticon:"user-add"},{id:n.actionPubIds.addMemberRestricted,text:t.get("addMember"),icon:"user-add",fonticon:"user-add"},{id:n.actionPubIds.editCS,text:t.get("EditProperties"),icon:"pencil",fonticon:"pencil"},{id:n.actionPubIds.changeThumbnail,text:t.get("changeThumbnail"),icon:"picture",fonticon:"picture"},{id:n.actionPubIds.del,text:t.get("deleteText"),icon:"trash",fonticon:"trash"},{id:n.actionPubIds.delFinal,text:t.get("deleteText"),icon:"trash",fonticon:"trash"},{id:n.actionPubIds.moveToCS,text:t.get("moveTo"),icon:"login",fonticon:"login"},{id:n.actionPubIds.editContent,text:t.get("EditProperties"),icon:"pencil",fonticon:"pencil"},{id:n.actionPubIds.downloadVersion,text:t.get("download"),icon:"download",fonticon:"download"},{id:n.actionPubIds.restoreVersion,text:t.get("restore"),icon:"rotate-ccw",fonticon:"rotate-ccw "},{id:n.actionPubIds.restore,text:t.get("restore"),icon:"rotate-ccw",fonticon:"rotate-ccw "},{id:n.actionPubIds.addToMyDrive,text:t.get("addToMyDrive"),icon:"drive-add",fonticon:"drive-add"},{id:n.actionPubIds.removeFromMyDrive,text:t.get("removeFromMyDrive"),icon:"drive-delete",fonticon:"drive-delete"},{id:n.actionPubIds.removeOwnAccess,text:t.get("revokeAccess"),icon:"block",fonticon:"block"}];return i.map(function(e){return Object.freeze(e)}),function(){return i.slice()}}),define("DS/W3DContentApp/Actions/Utils/actionsUtils",["UWA/Core","DS/W3DContentApp/Views/SuperModal","DS/UIKIT/Alert","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e,t,n,i){"use strict";return{showGenericConfirmationModal:function(e,n,o,r){return t.dialog({title:e,body:n,buttons:[{className:"warning",value:o,action:function(e){r(),e.hide()}},{value:i.cancel,action:function(e){e.hide()}}]})},getConfirmationModal:function(e,n,o,r,s){var a=document.createElement("div");a.className="proceed-modal";var l=i.fileIntelligenceError+"<br>",c=n.length;l+="<ul>";for(var d=0;d<c;d++)l+="<li>"+n[d]+"</li>";return l+="</ul><br>",s||(l+=i.replace(i.waitOrAction,{action:o.toLowerCase()})),a.innerHTML=l,t.dialog({title:e,body:a,buttons:[{className:"warning",value:i.proceedAnyway,action:function(e){r(),e.hide()}},{value:i.cancel,action:function(e){e.hide()}}]})},showMoreInfoPopup:function(e,o){var r=e.length,s=document.createElement("div"),a=i.get(o),l=i.replace(i.filesHaveNotbeen,{action:a}),c=document.createElement("span");c.innerHTML=l+".";var d=document.createElement("span");d.innerHTML=i.moreInfo,d.className="download-more-info",d.onclick=function(){var n=document.createElement("div");n.className="more-info-modal";for(var o=i.moreInfoDesc1+"<br><ul>",s=0;s<r;s++)o+="<li>"+e[s]+"</li>";return o+="</ul><br>",o+=i.replace(i.moreInfoDesc2,{action:a}),n.innerHTML=o,t.dialog({title:i.moreInfo,body:n,buttons:[{value:i.close,action:function(e){e.hide()}}]})},s.appendChild(c),s.appendChild(d),new n({closable:!0,renderTo:document.querySelector(".w3ddrive.alert.alert-root"),visible:!0,autoHide:!0,hideDelay:5e3}).add({message:s,className:"primary download-info-alert"})}}}),define("DS/W3DContentApp/Utils/Alert",["DS/UIKIT/Alert","DS/W3DContentApp/Utils/Helpers","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/UIKIT/UIKIT.css"],function(e,t,n){"use strict";var i,o,r=(i=new e({className:"w3ddrive",autoHide:!0,closable:!0,visible:!0,renderTo:document.body})).add;return i.add=function(e){return"error"!==e.className&&"warning"!==e.className||(i.options.hideDelay=1e4),e.message=t.filterXSS(e.message),r.call(i,e)},i.addWithLink=function(e,n){return"error"!==e.className&&"warning"!==e.className||(i.options.hideDelay=1e4),e.message=t.filterXSS(e.message),n.message=t.filterXSS(n.message),e.message+='<a href="'+n.url+'" target="_blank">'+n.message+" </a>",n.help&&(n.help=t.filterXSS(n.help),e.message+=n.help),r.call(i,e)},i.addAndCallback=function(e){var s={};o=e.callback,"error"!==e.className&&"warning"!==e.className||(i.options.hideDelay=1e4),s.className=e.className,s.message=t.filterXSS(e.message);var a=document.createElement("div");return a.className="btn-link",a.innerText=n.moreDetails,s.message+=a.outerHTML,r.call(i,s)},i.onClick=function(e,t){t.getElementsByClassName("btn-link").length>0&&o&&"function"==typeof o&&o()},i}),define("DS/W3DContentApp/Views/Lightbox/lightboxPreview3DPlay",["UWA/Class/Promise","DS/W3DContentApp/BusEvent","DS/W3DContentApp/Utils/Alert","DS/3DPlayHelper/3DPlayHelper","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/W3DContentApp/W3DContentApp.css"],function(e,t,n,i,o){"use strict";var r,s,a;return{init:function(e={}){if(s)return l(e.inode),s;return t=document.createElement("div"),t.classList.add("preview-3d"),a=t,s=Object.assign(a,{refresh:l}),l(e.inode),s;var t},hide3DPlayViewer:function(){r&&(r.informActiveState(!1),r.dispose(),r=null)}};function l(l){if(!l)return e.resolve();function c(){const e=l.get3DPlayOptions(),c={loading:"autoplay",callback:{onAnnotationShared:function(e){t.dispatchEvent("lightbox:onAnnotationShared",[e])}}};if(r?!l.annotation&&r.isReady()&&(r.informActiveState(!0),r.load({input:e,options:c})):r=new i({container:a,input:e,options:c}),l.annotation){let e,t=!1;const i=l.annotation;delete l.annotation,setTimeout(function(){clearTimeout(e),t||n.add({message:o.get("annotationLoadError"),className:"error"})},25e3),function n(){r.isReady()?(t=!0,r.loadAnnotations({annotation:i.data.annotationFile},{clean:!0})):e=setTimeout(n,100)}()}return s}return l.drive.isCollabSpace?l.get("type")&&l.collection&&l.collection._parentInode&&l.collection._parentInode.get("contexts")?c():new e(function(e,t){l.fetch({onComplete:function(){return e(c())}})}):l.getFileUrl().then(c)}}),define("DS/W3DContentApp/Views/PublishTo3DSwymService",["UWA/Class/View","UWA/Core","DS/UIKIT/Spinner","DS/W3DContentApp/Views/SuperModal","DS/W3DContentApp/Utils/Alert","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e,t,n,i,o,r){"use strict";return e.extend({spinner:null,setup:function(e){if(!e)throw new Error("Missing input");this.inode=e},render:function(){this.spinner=new n({className:"spinner-center",visible:!0});const e=t.createElement("div",{class:"sharetoswym",html:[{tag:"div",class:"shareview__description",html:r.publishTo3DSwymDescription},this.spinner,this._createPublishFormView(this.inode).then(t=>{this.spinner.hide(),e.appendChild(t)})]});return e},_createPublishFormView:function(e){return new Promise(function(i,s){let a,l,c,d;require(["DS/SwymPublishForm/script/publish-form-view"],function(s){(a=new s({mode:"jsevent",platformId:e._auth.getSwymService(),contentTitle:e.get("title")})).addEvent("StartUpload",function(t){const i=JSON.parse(t);l=i.platform_instance,c=i.community_id;const s=new Promise(function(e,t){setTimeout(t,1e4,"long transaction")}),u=new Promise(function(t,o){e.uploadFileToSwym(i).then(function(e){d=e.mediaid,t(),void 0!==d?a.createContent(d):n(r.mediaUploadTo3DSwymError)},function(i){if(i&&i.name)if("timeout"===i.name)n(r.replace(r.shareSwymTimeout,{tagName:e.get("title")}));else if(i.message&&i.message.errorID&&void 0!==i.message.errorID){const t=i.message.errorID;let o=r.get(t);n(o=o?r.replace(o,{tagName:e.get("title")}):r.contentCreationTo3DSwymError)}else n(r.contentCreationTo3DSwymError);t()})});Promise.race([s,u]).then(function(){},function(){if(a){if(a.container.hasClassName("masked")){const e=a.container.querySelector(".mask");o.add({className:"warning",message:r.publishTo3DSwymLongTransaction}).inject(e)}}})}),a.addEvent("ContentCreated",function(){o.addWithLink({message:"",className:"success"},{message:e.get("title"),url:l+"/#community:"+c+"/media:"+d,help:r.publishTo3DSwymSuccess}),t()}),a.addEvent("CancelShare",function(){t()}),a.render(),i(a.getContent())})});function t(){const e=i.modals.current;e&&e.hide()}function n(e){o.add({className:"error",message:e}),t()}}})}),define("DS/W3DContentApp/Utils/formFactory",["UWA/Core","DS/W3DContentApp/Views/SuperModal","DS/UIKIT/Input/Text","DS/UIKIT/Input/Select","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e,t,n,i,o){"use strict";return{createForm:function(t=[],n={}){let i="form-vertical form form-root";n.className&&(i+=" "+n.className);return e.createElement("form",{class:i,html:t})},createTextError:function(e,t){var n=document.createElement("span");return Object.assign(n,t,{className:"form__message-error",textContent:e})},createTextInput:function(e){var t=document.createElement("input");return Object.assign(t,{autofocus:"true",className:"form-control form-control-root",label:"Title",name:"newContainerName",placeholder:o.title,type:"text",autocomplete:"off"},e)},createTextArea:function(e){return new n(Object.assign({className:"",multiline:!0,rows:4,maxlength:255,required:!1},e))},createSelectInput:function(e){var t=new i({placeholder:!1});return e.options.map(function(e){var n={};n.value=e.value,n.name=e.name,n.id=e.id,n.label=e.label,n.innerText=e.label,n.selected=e.selected,n.disabled=e.disabled,t.add(n)}),t},createTextLabel:function(e,t){var n=document.createElement("span");return Object.assign(n,t,{className:"form__message-label",textContent:e})},createWarningLabel:function(e,t){var n=document.createElement("span");return Object.assign(n,t,{className:"form__message-warning",textContent:e})},disableValidationButton:d,enableValidationButton:u,invalidateInput:r,invalidateInputAndShowErrorMessage:function(e,t,n){return r(e),l(t,n),{input:e,errorMessageElement:t}},onCheckInput:function(e,t,n,i,o){(function(e,t,n,i){-1!==t.maxLength&&t.value.length>=e?c(n,i):function(e){e.classList.remove("form__message--warning")}(n)})(e,t,n,i.maxLengthText),function(e,t,n,i){e.checkValidity()?(s(e),function(e){e.classList.remove("form__message-error--active"),e.classList.add("form__message-error")}(t),document.getElementsByClassName("form__message-error form__message-error--active").length>0?d(i):u(i)):(r(e),l(t,n),d(i))}(t,n,i.chars,o)},showWarningMessage:c,validateInput:s};function r(e){return e.classList.add("form__input--error"),e}function s(e){return e.classList.remove("form__input--error"),e}function a(e){return e.textContent=null,e.classList.remove("form__message-error--active"),e.classList.remove("form__message--warning"),e}function l(e,t){return(e=a(e)).classList.add("form__message-error--active"),e.textContent=t,e}function c(e,t){return(e=a(e)).textContent=t,e.classList.add("form__message--warning"),e}function d(e){const n=t.modals.current.getFooter().getElement(e);n.disabled||(n.disabled=!0)}function u(e){if(!t.modals.current)return;const n=t.modals.current.getFooter().getElement(e);n.disabled&&(n.disabled=!1)}}),define("DS/W3DContentApp/Utils/shareFactory",["UWA/Core","UWA/String","DS/UIKIT/Input/Toggle","DS/UIKIT/Input/Button","DS/UIKIT/Input/ButtonGroup","DS/UIKIT/Accordion","DS/UIKIT/Toggler","DS/UIKIT/Input/Text","DS/W3DXComponents/Views/Item/PanelAddMemberView","DS/W3DContentApp/Views/SuperModal","DS/W3DContentApp/Utils/formFactory","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/W3DContentApp/W3DContentApp.css"],function(e,t,n,i,o,r,s,a,l,c,d,u){"use strict";return{closeShareModal:function(){c.modals.current.hide()},convertCategoriesToSharingRole:m,createAccordion:function(e){return new r(e)},createButton:function(e){return new i(Object.assign({},e))},createButtonGroup:function(e){return new o(Object.assign({},{buttons:e.buttons},e))},createCheckboxWithContent:function(e){var t=p(),i=e.content,o=!!e.isChecked;!0!==o&&i.hide();var r=e.checkboxOptions,s=new n(Object.assign({checked:o,events:{onChange:function(){s.isChecked()?i.show():(window.CheckboxOrgSelect=!1,i.hide())}}},r));return[s,i].reduce(f,t),t},createCheckInput:function(e){var t=p({element:"div",classes:["toggle"]}),n=p({element:"input"}),i=p({element:"label",classes:"control-label"});return n.type="checkbox",i.innerHTML=e.label,t.appendChild(n),t.appendChild(i),t},createInvitationView:function(e,n={}){if(!Array.isArray(e))throw new Error("You should provide a categories array input");for(var i,o,r,s,a,c,d,u,p,f,g,h,v=[],D=[],w=0;w<e.length;w++)e[w].id.contains("restricted")?v.push(e[w]):D.push(e[w]);n&&n.inode&&-1!==n.inode.get("actions").indexOf("add.members.restricted")&&(D=v);c={categories:D,suggestFormat:"{fname} {lname}",suggestKey:"login",labelFormat:"{fname} {lname}",placeholder:n.placeholder,typeDelay:500,minLength:2,getSuggestions:S,saveProcess:C},(u=new l(Object.assign(c,n))).elements.buttons.classList.add("shareview__footer"),o=u.render,r=u.destroy,f=Object.assign(u,{render:function(){var e=o.apply(u,arguments),t=u.container.querySelector("input.temp-autocomplete-input");return t&&t.focus(),u.show(),e},destroy:function(){return"function"==typeof i&&i(),r.apply(this,arguments)}}),n&&n.inode&&-1===n.inode.get("actions").indexOf("add.members.restricted")&&v.length>1?(d={categories:v,suggestFormat:"{fname} {lname}",suggestKey:"login",labelFormat:"{fname} {lname}",placeholder:"",typeDelay:500,minLength:2,getSuggestions:S,saveProcess:C},(p=new l(Object.assign(d,n))).elements.buttons.classList.add("shareview__footer"),s=p.render,a=p.destroy,g=Object.assign(p,{renderRestrictedRoles:function(){var e=s.apply(p,arguments),t=p.container.querySelector("input.temp-autocomplete-input");return t&&t.focus(),p.show(),e},destroyRestrictedRoles:function(){return"function"==typeof i&&i(),a.apply(this,arguments)}}),h=[f,g]):h=f;return h;function b(e){var n=e.item,i=n.email;return!i&&t.isEmail(e.selection)&&(i=e.selection),{displayName:n.name||i,emailAddress:i,fname:n.fname,pid:n.id,lname:n.lname,personID:e.selection,picture:n.picture,role:m([e.categoryId]).role,isRestricted:m([e.categoryId]).restricted}}function C(e){return e.map(b)}function S(e,n,o){if(i=function(){Object.keys(n).map(function(e){delete n[e]})},e)return n[e]?o(n[e]):t.isEmail(e)?o([{login:e,fname:e,lname:"",email:e,role:null}]):o([])}},createMessageElement:function(){const t=e.createElement("span",{class:"js-share-inode_message-label",text:u.get("labelWithCharactersCounter",{label:u.get("addMessage"),nbChars:0,totalChars:255})}),n=d.createTextArea({className:"js-share-inode_message",maxlength:255,required:!1,placeholder:u.get("shareMessage")});return n.getContent().addEventListener("keyup",()=>{const e=n.getValue().length||0;t.textContent=u.get("labelWithCharactersCounter",{label:u.get("addMessage"),nbChars:e,totalChars:255})}),[t,n].reduce((e,t)=>(t.tagName?e.appendChild(t):t.inject(e),e),document.createDocumentFragment())},createReshareElem:function(e){var t=e.className?e.className:[],n=e.id?e.id:"checkbox-share",i=p({element:"div",classes:["toggle","toggle-root","toggle-primary"].concat(t)}),o=p({element:"input",classes:"js_share-inode_reshare"});o.type="checkbox",o.value="reshare",o.id=n;var r=p({element:"label",classes:"control-label"});return r.setAttribute("for",n),r.textContent=u.get("allowReshare"),[o,r].reduce(function(e,t){return e.appendChild(t),e},i)},createTabItem:function(e){var t=p({element:"a",classes:[e.classes,"tab-item"]}),n=document.createTextNode(e.value),i=p({element:"span",classes:["fonticon",e.icon]});return t.appendChild(i),t.appendChild(n),t},createTextBlock:function(e){var t=Object.assign({},e),n=t.css,i=t.text||"",o=p(t);o.innerHTML=i,n&&Object.keys(n).map(function(e){o.style[e]=n[e]});return o},createTextInput:function(e){return new a(e)},createTextInputWithButton:function(e){var t=p({element:"div",classes:"input-group"}),n=p({element:"input",classes:"form-control"}),i=Object.assign({},e),o=i.css;n.type="text";var r=p({element:"span",classes:"input-group-btn"}),s=p({element:"button",classes:["btn","btn-default","input__button"]});s.innerHTML=i.buttonContent||"",r.appendChild(s),t.appendChild(n),t.appendChild(r),i.readonly&&(n.readOnly=!0);o&&Object.keys(o).map(function(e){t.style[e]=o[e]});return t},createToggler:function(e){if(e.buttons.length<=1)return p({element:"div"});for(var t=p({element:"div",classes:[e.classes,"tab"]}),n=0;n<e.buttons.length;n+=1)t.appendChild(e.buttons[n]);new s({container:t,type:e.type});return t},createToggleSwitch:function(e){return function(e){return new n(e)}(Object.assign({},{type:"switch"},e))},emptyModalFooter:function(){var e=c.modals.current;if(!e)return;e.getFooter().empty()},hideModalFooter:function(){var e=c.modals.current;if(!e)return;e.getFooter().hide()},getModalFooterButtons:function(e){var t=(e||{}).buttonClass,n=c.modals.current;if(!n)return[];var i=n.getFooter();if(!i)return[];var o="string"==typeof t?"button."+t:"button";return[].slice.call(i.querySelectorAll(o))},getModalTitle:function(e){return u.get("shareElem",{type:u[e.isFolder()?"folder":"file"],name:e.get("title")})},makeElement:p,onEmailAddress:function(e){return{resourceid:e,label:e,email:e}},showModalFooter:function(){var e=c.modals.current;if(!e)return;e.getFooter().show()},createCheckboxAndContent:function(e){var t=p(),i=e.normalView,o=e.restrictedView,r=e.checkboxOptions,s=new n(Object.assign({events:{onChange:function(){s.isChecked()?(i.hide(),o.show()):(o.hide(),i.show())}}},r));return[s,o,i].reduce(f,t),t}};function p(e){var t=e||{},n=t.element||"div";"string"==typeof t&&(n=t);var i=t.classes||[],o=document.createElement(n);if("string"==typeof i)return o.classList.add(i),o;for(var r=0;r<i.length;r+=1)o.classList.add(i[r]);return o}function m(e,t){var n,i,o=t||"reader";return e?(-1!==(e=[].concat(e)).indexOf("giveReadAccess")&&(o="reader"),-1!==e.indexOf("giveEditAccess")&&(o="writer"),-1!==e.indexOf("Reader")&&(o="Reader"),-1!==e.indexOf("PublicReader")&&(o="PublicReader"),-1!==e.indexOf("Contributor")&&(o="Contributor"),-1!==e.indexOf("Author")&&(o="Author"),-1!==e.indexOf("Leader")&&(o="Leader",i=!1),-1!==e.indexOf("Owner")&&(o="Owner",i=!0),-1!==e.indexOf("LeaderOwner")&&(o="Leader",i=!0),-1!==e.indexOf("Readerrestricted")&&(o="Reader",n=!0),-1!==e.indexOf("Contributorrestricted")&&(o="Contributor",n=!0),-1!==e.indexOf("Authorrestricted")&&(o="Author",n=!0),-1!==e.indexOf("Leaderrestricted")&&(o="Leader",n=!0,i=!1),-1!==e.indexOf("Ownerrestricted")&&(o="Owner",n=!0,i=!0),-1!==e.indexOf("LeaderOwnerrestricted")&&(o="Leader",n=!0,i=!0),-1!==e.indexOf("giveShareAccess")&&(o+="Sharer"),{role:o,restricted:n,isAdmin:i}):t}function f(e,t){return t.nodeName||(t=t.getContent()),e.appendChild(t),e}}),define("DS/W3DContentApp/Views/itemView",["UWA/Core","UWA/Class/View","UWA/Utils/Client","DS/i3DXCompassPlatformServices/OpenWith","DS/UIKIT/DropdownMenu","DS/UIKIT/Tooltip","DS/W3DContentApp/Utils/Helpers","DS/W3DDrive/Utils/CompassHelpers","css!DS/W3DContentApp/W3DContentApp.css"],function(e,t,n,i,o,r,s,a){"use strict";return function(l){const c=new t({model:l.model,className:"w3ddrive item"}),d=l.viewConf||{},u=c.destroy,p="selected",m={selected:!1};let f,g,h;function v(){const t=l.image,n=l.icon;if(t){const n=l.model.getDefaultThumbnail?l.model.getDefaultThumbnail():"";return e.createElement("div",{class:"image",html:[{tag:"img",src:t,draggable:!1,onerror:"this.src='"+n+"'; this.onerror = null;"}]})}if(n)return e.createElement("div",{class:"image",html:{tag:"span",class:n}})}function D(e,t,r,s={}){if(!Array.isArray(e)||!t)return null;if(n.Platform.ios||n.Platform.android||n.Platform.ipad||n.Platform.tablet){const t=e.findIndex(e=>"uploadFolder"===e.id);-1!==t&&e.splice(t,1)}const c=e.map(e=>({className:e.className||"",text:e.text||"",fonticon:e.icon,handler:e.handler&&r?e.handler.bind(r):null})),d=r.options.dropdownRenderTo||r.container.parentElement,u=new o({target:t,renderTo:d,className:"item-view-actions-menu",bound:!s.hasOwnProperty("bound")||s.bound,events:{onClickOutside:function(){this.hide()}},position:"right",items:c,contextual:!!s.hasOwnProperty("contextual")&&s.contextual});return u.getItem("openWith")&&(u.removeItem("openWith"),function(e){const t=a.get3DXContent([l.model]);l.model.isContainer()||(l.model.drive.isCollabSpace?t.data.items[0].objectTaxonomies=l.model.get("taxonomies"):t.data.items[0].objectTaxonomies=[l.model.get("fileExtension").toLowerCase()]),(new i).set3DXContent(t).render(e)}(u)),u}function w(){const t=l.actions;if(!t||!t.length)return null;const n=d.actionsFonticon?d.actionsFonticon:"chevron-down",i=e.createElement("div",{class:"actions fonticon fonticon-"+n});return d.actionsIconTooltip&&new r({target:i,body:d.actionsIconTooltip,position:"bottom"}),i}function b(){const t=[],n=l.iconType,i=l.title,o=l.metas;return n&&t.push({tag:"img",src:n}),i&&t.push({class:"header",text:i}),l.attributes&&Object.keys(l.attributes).forEach(e=>{t.push({class:e,html:l.attributes[e]||""})}),o&&t.push({tag:"div",class:"meta",html:[].concat(o).filter(Boolean).map(e=>({tag:"span",text:e}))}),e.createElement("div",{class:"content",html:t})}function C(e){const t=c.elements.dropDown;return t&&(t.destroy(),delete c.elements.dropDown),l.actions=e,c}function S(e){void 0!==e&&(m.selected=Boolean(e)),m.selected?c.container.addClassName(p):c.container.removeClassName(p)}return c.delegateDOMEvents({"click .actions":function(){const e=l.actions;d.noActionsMenu&&1===e.length?e[0].handler():c.elements.dropDown||(c.elements.dropDown=D(l.actions,h,c),c.elements.dropDown.show())}}),S(l.selected),Object.assign(c,{render:function(){c.container.empty(),f=null,g=null,f=v(),h||(h=w()),g=b();const t=[f,g,h];l.withSelectionIcon&&t.splice(0,0,e.createElement("span",{class:"item__selection_icon fonticon fonticon-check"})),c.container.setContent(t.filter(Boolean));const n=!d.hasOwnProperty("draggable")||d.draggable;return c.container.setAttribute("draggable",n),c},refreshImg:function(){const e=v();return f?s.replaceWith(f,e):g&&e.inject(g,"before"),f=e,c},refreshActions:C,refreshActionsDd:function(e={}){let t=c.elements.dropDown;const n=t&&t.isVisible;C(e.actions),document.body.querySelectorAll(".item-view-actions-menu").forEach(e=>{e.destroy()}),c.elements.dropDown=D(e.actions,h,c,e),c.elements.dropDown&&(e.contextual||!e.contextual&&!n)&&c.elements.dropDown.show()},toggleActionsElemVisibility:function(e=!0){h&&(h.style.visibility=e?"visible":"hidden")},refreshContent:function(){const e=b();return s.replaceWith(g,e),g=e,!h&&l.actions&&l.actions.length>0&&(h=w(),c.container&&h.inject(c.container)),(!l.actions||!l.actions.length&&h)&&(h.parentNode.removeChild(h),h=null),c},refreshSelected:S,destroy:function(){return c.undelegateDOMEvents(),c.container.removeEvents(),f=null,g=null,h=null,u.apply(c,arguments)}})}}),define("DS/W3DContentApp/Utils/Platform",["UWA/Class/Promise","DS/W3DDrive/widget","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/W3DContentApp/Utils/Helpers","DS/W3DContentApp/Utils/Alert","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e,t,n,i,o,r){"use strict";let s=[],a=void 0,l=void 0;const c=()=>{const e=t.getValue("driveId"),n=i.getQueryHashParameter("content","saved-fragment");let o;"string"==typeof n&&(o=n.replace(/%252F|%2F/g,"/").split("/")[1]);const r=decodeURIComponent(i.getQueryHashParameter("content","X3DContentId"));let s;const a=new RegExp(/("envId":)"([^"]*)"/gi);return a.test(r)&&(s=r.match(a)[0].replace(/"/g,"").split(":")[1]),e||o||s||t.getValue("x3dPlatformId")};return{getSelectedPlatformId:c,getAllPlatforms:function(){return new e((a,l)=>s.length>0?a(s):n.getPlatformServices({onComplete:function(n){(n=>{const o=i.getAppBehaviour("driveServiceUrl");return new e(i=>{if(n){const r=n.filter(e=>"true"===t.getValue("is3DSpaceWidget")?e["3DSpace"]:e["3DDrive"]).map(e=>({id:e.platformId,displayName:e.displayName,url:o||e["3DDrive"],urlSwym:e["3DSwym"],url3DSpace:e["3DSpace"],urlUsersGroup:e.usersgroup,urls3DSearch:e["3DSearch"],urlDrivesHub:e.driveshub,urlDashboard:e["3DDashboard"],urlDfcs:e.distributedfilestore,urlPassport:e["3dpassportnta"],urlODE:e.officedocumenteditor}));e.all(r).then(e=>{i(e)})}})})(n).then(e=>{if((e=>{if(!i.isTransientWidget()){const n=[];!t.showAllPlatforms&&e.length>1&&e.forEach(e=>{n.push({value:e.id,label:e.displayName})}),("true"!==t.getValue("is3DSpaceWidget")||"true"===t.getValue("is3DSpaceWidget")&&n.length>1)&&(t.addPreference({type:"list",name:"selectedPlatform",label:"3DEXPERIENCE Platform",options:n}),t.setValue("selectedPlatform",c()))}})(e),!t.showAllPlatforms&&c()){const n=e.filter(e=>e.id===c());0===n.length?(s=[].concat(e[0]),o.add({className:"warning",message:r.get("platformNotAccessible",{platformId:c()})}),t.deleteValue("x3dPlatformId")):s=n}else s=e;a(s)})},onFailure:l}))},resetPlatformsCache:function(){s=[]},getPassportUrl:function(){const t=this;return new e(e=>l?e(l):t.getAllPlatforms().then(t=>{const n=t.filter(e=>e.urlPassport),i=n.find(e=>e.id===c());i?l=i.urlPassport:n.forEach(e=>{l||(l=e.urlPassport)}),e(l)}))},getDrivesHubUrl:function(){const t=this;return new e(e=>a?e(a):t.getAllPlatforms().then(t=>{const n=t.filter(e=>e.urlDrivesHub),i=n.find(e=>e.id===c());i?a=i.urlDrivesHub:n.forEach(e=>{a||(a=e.urlDrivesHub)}),e(a)}))}}}),define("DS/W3DContentApp/Utils/RequestHelper",["DS/WAFData/WAFData","UWA/Data","UWA/String","UWA/Services/Auth","DS/W3DContentApp/Utils/Platform","DS/W3DDrive/widget","DS/W3DContentApp/Metas/errors","DS/W3DContentApp/Utils/Alert","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e,t,n,i,o,r,s,a,l){"use strict";const c=Boolean(r.getValue("isStandalone")),d=s().xmlhttprequestCodes;let u;const p={_tenant:null,_baseUrl:null,_uuid:r.getValue("3ddrive_uuid"),setTenant:function(e){this._tenant=e},getTenant:function(){return this._tenant},hasTenant:function(){return Boolean(this._tenant)},setBaseUrl:function(e){this._baseUrl=e},getBaseUrl:function(e){let t=this._baseUrl||e;return c?n.format("{0}/resources/3ddrive/v1/shared/bos",t):n.format("{0}/resources/3ddrive/v1/bos",t)},manageFailure:function(e,t,n,i){if(n&&"function"==typeof n)n(e,t,i);else switch(e){case d.CONFLICT:a.add({message:l.get("duplicationError",{msg:t.error.message,fileName:t.error.filename}),className:"error"});break;default:a.add({message:l.get("unexpectedError"),className:"error"})}},performRequest:function(e,t,n,i,o,s){r.getValue("is3DSpaceWidget")||(e+=-1!==e.indexOf("?")?"&":"?",e+="lastmodifier="+p._uuid);var a=p.performRequestWithOptions(e,{type:o||"json",method:s||"get",data:i||null,onComplete:t||null,onFailure:function(e,t){p.manageFailure(a.xhr.status,t,n,{xhr:a.xhr})}});return a},performExternalRequestWithOptions:function(e,n){return t.request(e,n)},performRequestWithOptions:function(t,n={}){let s;t=p.addQueryStrings({url:t,queryStrings:{tenant:o.getSelectedPlatformId()}}),!n.auth||n.auth instanceof i||(!1===p.hasTenant()&&n.auth&&!r.getValue("x3dPlatformId")&&(t=p.addQueryStrings({url:t,queryStrings:{tenant:n.auth.platformId}})),n.headers||(n.headers={}),n.headers["X-DS-CSRFTOKEN"]=u||"",s=n.onComplete,n.onComplete=function(e,t,n){var i=Object.keys(t).filter(function(e){return-1!==e.search(/x-ds-csrftoken/i)});u=i.length>0?t[i[0]]:u,"function"==typeof s&&s(e,t,n)}),n.type||(n.type="json");var a=null;let l;var d;if(n.onFailure&&(a=n.onFailure),n.onFailure=function(e,t){p.manageFailure(l.xhr.status,t,a,{xhr:l.xhr})},c&&-1!==t.indexOf("shared")&&(t=p.addQueryStrings({url:t,queryStrings:{token:r.getValue("token"),tenant:p._tenant}})),!r.getValue("is3DSpaceWidget"))if(n.data)if("string"==typeof n.data){try{d=JSON.parse(n.data)}catch(e){d={}}d.lastmodifier=p._uuid,n.data=JSON.stringify(d)}else(d=n.data?n.data:{}).lastmodifier=p._uuid,n.data=d;else t+=-1!==t.indexOf("?")?"&":"?",t+="lastmodifier="+p._uuid;return l=e.authenticatedRequest(t,n)},getRequestMethod:function(e,t){return!0===t||e.ajax&&e.ajax==p.performExternalRequestWithOptions?p.performExternalRequestWithOptions:p.performRequestWithOptions},addQueryStrings:function(e={}){if(!e.url)return"";let t=e.url.includes("?")?e.url:e.url+"?";const n=e.queryStrings;return n&&Object.keys(n).forEach(e=>{let i="&"+e;const o=n[e];void 0!==o&&(i+="string"==typeof o?"="+o:"","?"===t[t.length-1]&&(i=i.substring(1,i.length)),t+=i)}),t}};return p}),define("DS/W3DContentApp/Utils/Rerouter",["UWA/String","DS/W3DContentApp/Metas/inode","DS/W3DDrive/Metas/DSDrive/inode","DS/W3DContentApp/Metas/errors","DS/W3DContentApp/Utils/RequestHelper"],function(e,t,n,i,o){"use strict";var r=i().xmlhttprequestCodes,s=i().w3ddrive,a={Router:null,setRouter:function(e){this.Router=e},_getRessource:function(t,n){var i=e.format("{0}/share/v1/guest/{1}",t,encodeURIComponent(n));return new Promise(function(e,t){var n=o.performRequest(i,function(n){n?e(n):t({status:r.NOT_FOUND})},function(e,i){var o;i&&!0===i.hasOwnProperty("error")&&(o=i.error),t({status:n.xhr.status,msg:o})})})},_getContent:function(t,n){return this._getRessource(t,n).then(function(t){var n=e.format("{0}",t.url);return o.setTenant(t.tenant),o.setBaseUrl(t.url.split("/enovia")[0]+"/enovia"),new Promise(function(e,i){var s=o.performRequest(n,function(n){n?(n.tenant=t.tenant,e(n)):i({status:r.NOT_FOUND})},function(e,t){var n;t&&!0===t.hasOwnProperty("error")&&(n=t.error),i({status:s.xhr.status,msg:n})})})},function(e){return new Promise(function(t,n){n(e)})})},rerouteFromSharedToken:function(i,o){o?a._getContent(i,o).then(function(i){var o,r=t().mimeType.folder;o=i.mimetype===n().mimeType.folder?e.format("drives/{0}/mimetype/{1}/inode/{2}/content",i.tenant,encodeURIComponent(r),i.id):e.format("drives/{0}/mimetype/{1}/inode/{2}/content/{3}/preview",i.tenant,encodeURIComponent(r),i.parentid,i.id),a.Router.navigate(o,{trigger:!0})},function(t){var n;switch(t.status){case r.NOT_FOUND:n=e.format("error/{0}/{1}/{2}",s.ressourceAccess,t.status,encodeURIComponent(t.msg));break;default:n=e.format("error/{0}/$/{1}",s.ressourceAccess,encodeURIComponent(t.msg))}a.Router.navigate(n,{trigger:!0})}):a.Router.navigate(e.format("error/{0}/$/$",s.noToken),{trigger:!0})}};return a}),define("DS/W3DContentApp/Utils/inodeItemViewAttributes",["DS/W3DContentApp/Utils/Helpers","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e,t){"use strict";return function(n){if(!n)return[];let i=[];return i=n.drive.isDsDrive||n.drive.isDrivesHubDrive?"recents"===n.get("id")?[{classname:"title",key:"title",nls:t.get("title"),value:function(e){return[{tag:"span",text:e.get("alias")||e.get("title")},e.isShared()&&!e.isFolder()?{tag:"span",class:"fonticon fonticon-users"}:"",e.isFavorite()?{tag:"span",class:"fonticon fonticon-favorite-on"}:""]}},{classname:"interaction",key:"interaction",nls:t.get("LastAction"),value:function(e){return e.get("interaction")}},{classname:"interactionDate",key:"interactionDate",nls:t.get("Date"),value:function(n){const i=n.get("interactionDate");return e.isToday(i)?t.get("Today")+", "+e.getTimeStr(i):i?e.getDateStr(i,!0):null}},{classname:"size--recent",key:"size",nls:t.get("Size"),value:function(t){return t.isFolder()?"-":e.computeNLSSize(t.get("size"))}},{classname:"type--recent",key:"type",nls:t.get("Type"),value:function(e){return e.getNLSType()}}]:[{classname:"title",key:"title",nls:t.get("title"),value:function(e){return[{tag:"span",text:e.get("alias")||e.get("title")},e.isShared()&&!e.isFolder()?{tag:"span",class:"fonticon fonticon-users"}:"",e.isFavorite()?{tag:"span",class:"fonticon fonticon-favorite-on"}:""]},sortable:!0},{classname:"modifiedDate",key:"modifiedDate",nls:t.get("Modified"),value:function(t){const n=t.get("modifiedDate");return n?e.getDateStr(n,!0):null},sortable:!0},{classname:"size",key:"size",nls:t.get("Size"),value:function(t){return t.isFolder()?"-":e.computeNLSSize(t.get("size"))},sortable:!0},{classname:"type",key:"type",nls:t.get("Type"),value:function(e){return e.getNLSType()},sortable:!0},{classname:"creator",key:"creator",nls:t.get("Creator"),value:function(e){return e.getCreator()},sortable:!0}]:"myCollabSpaces"===n.id?[{classname:"title",key:"title",nls:t.get("title"),value:function(e){return[{tag:"span",text:e.get("title")}]},sortable:!0},{classname:"modifiedDate",key:"modifiedDate",nls:t.get("Modified"),value:function(t){const n=t.get("modifiedDate");return n?e.getDateStr(n,!0):null},sortable:!0},{classname:"visibility",key:"visibility",nls:t.get("Visibility"),value:function(e){return e.get("visibility")?e.get("visibility").name:""}},{classname:"family",key:"family",nls:t.get("Family"),value:function(e){return e.get("family")?e.get("family").name:""}}]:[{classname:"title",key:"title",nls:t.get("title"),value:function(e){return[{tag:"span",text:e.get("title")}]},sortable:!0},{classname:"modifiedDate",key:"modifiedDate",nls:t.get("Modified"),value:function(t){const n=t.get("modifiedDate");return n?e.getDateStr(n,!0):null},sortable:!0},{classname:"type",key:"type",nls:t.get("Type"),value:function(e){return e.get("type")?e.get("type").name:""}},{classname:"maturity",key:"maturity",nls:t.get("Maturity"),value:function(e){return e.get("maturity")?e.get("maturity").name:""}},{classname:"owner",key:"owner",nls:t.get("owner"),value:function(e){return e.getOwnerNames()}}]}}),define("DS/W3DContentApp/Views/InodeDetailView/inodeDetailView",["UWA/Utils","DS/W3DContentApp/Views/InodeDetailView/inodeDetailViewFunc","DS/W3DDrive/widget","css!DS/W3DContentApp/W3DContentApp.css"],function(e,t,n){"use strict";return function(i={}){const o=t.getView(i),r=i.model,s=o.destroy,a=i.viewSpecs;if(!a||!a.detailViewsList||!a.defaultView)throw new Error("Missing input");a.detailViewsList.forEach(e=>{if(!(e&&e.key&&e.view&&e.icon))throw new Error("Missing input")});const l={"onChange:title":function(e,n){t.refreshHeader(o.container,e.get("alias")?e.get("alias"):n)},"onChange:alias":function(e,n){t.refreshHeader(o.container,n)},"onChange:actions":function(){p()}},c={"onChange:shareByLink":function(){p()}};let d=!1;function u(n){const i=o.elements.bodyView;if(i){if(n===t.getBodyElemKey(i.container))return i;e.setImmediate(function(){i.destroy()})}const s=a.detailViewsList.find(e=>e.key===n);return o.elements.bodyView=t.createBody(s,{model:r}),o.elements.bodyView}function p(){if(o.stopListening(),o.listenTo(r,l),r.drive&&o.listenTo(r.drive,c),d)for(;o.container.firstChild;)o.container.removeChild(o.container.firstChild);else;const e=t.getViewKey(n.getValue("inodeDetailViewKey"),r,a),s=u(e);return o.container.setContent([t.createHeader(r,i.headerOptions),t.createNavigation(e,r,a.detailViewsList),t.wrapBody(s.container)]),s.render(),d=!0,o}return o.delegateDOMEvents({"click .navigation__header":function(e){let i=t.getNavigationHeaderKey(e.target);i=t.getViewKey(i,r,a),t.refreshNavigation(o.container,i),t.refreshBodyWithView(o.container,u(i)),n.dispatchEvent("onUpdateInodeDetailViewKey",i)}}),Object.assign(o,{render:p,destroy:function(){o.stopListening(),d=!1,o.undelegateDOMEvents(),s.apply(o,arguments),o.container=null,o.model=null},navigateToTab:function(e){const i=t.getViewKey("inode-detail-"+e,r,a);t.refreshNavigation(o.container,i),t.refreshBodyWithView(o.container,u(i)),n.dispatchEvent("onUpdateInodeDetailViewKey",i)},isTabActive:function(e){return Boolean(o.container.querySelector('.navigation__header.navigation__header--selected > span[data-key="inode-detail-'+e+'"]'))}})}}),define("DS/W3DContentApp/Actions/Accesses/Base",["DS/W3DContentApp/Views/SuperModal","DS/W3DContentApp/BusEvent","i18n!DS/W3DDrive/assets/nls/W3DDrive"],function(e,t,n){"use strict";return function(i){var o={actions:[],init:function(e){e=e||{},this.model=e.model},toJSON:function(){var e=this.model,t=this.actions.filter(function(t){return e.isActionAllowed(t.id)},this);return t.length?t:[]},openDialog:function(t){var i=document.createElement("div"),o=t.title,r=t.body,s=t.confirmAction;return r.reduce(function(e,t){return e.appendChild(t),e},i),e.dialog({title:o,body:i,buttons:[{className:"primary",value:s.title,action:function(e){e.hide(),s.handler()}},{value:n.cancel,action:function(e){e.hide()}}]})},dispatchAccessActions:function(e,n){t.dispatchEvent("access:"+e,n)}};return o.init(i),o}}),define("DS/W3DContentApp/Utils/scheduleTasksToGlobalSession",["DS/W3DContentApp/Utils/createTasksSession"],function(e){"use strict";return e(6)}),define("DS/W3DContentApp/Views/InodePanelView/inodeItemView",["UWA/Utils","DS/W3DDrive/InodeActions","DS/W3DDrive/inodesActions","DS/W3DContentApp/Utils/Helpers","DS/W3DContentApp/Views/itemView","DS/W3DContentApp/BusEvent","DS/W3DContentApp/Utils/inodeItemViewAttributes"],function(e,t,n,i,o,r,s){"use strict";return function(a){if(!a||!a.model)throw new Error("Missing input");const l=a.model,c=l.collection&&l.collection._parentInode,d=c&&c.configuration,u=!d||d.canMultiselect||void 0===d.canMultiselect,p={model:l,cid:l.cid,withSelectionIcon:u};let m,f,g=new t({model:l,context:"item-view"});const h=s(c);function v(){var e={id:"id",image:function(e){var t=e.get("thumbnailLink");return t&&(t=t.medium),t},metas:function(e){var t=[],n=e.get("modifiedDate");return n&&t.push(i.getDateStr(n,!0)),t.push(e.getCreator()),t},iconType:"icon"};p.attributes={},h.forEach(function(e){p.attributes[e.classname]=e.value(l)}),Object.keys(e).forEach(function(t){var n;n="function"==typeof e[t]?e[t](l):l.get(e[t]),p[t]=n}),g=new t({model:l,context:"item-view"}),p.actions=g.toJSON()}v(),m=o(p),f=m.destroy;const D=(e,i=!1)=>{require(["DS/W3DContentApp/Views/InodePanelView/inodePanelViewFunc"],function(o){const s=l.collection._parentInode.inodeTable;o.isElemSelected(o.getElemOf(document.querySelector(".inode-table"),l))||r.dispatchEvent("inodePanelView:selectItemAmongItems",[l,{unselectAllItemsBefore:!0}]);const a=o.getSelectedModelsOf(document.querySelector(".inode-table"),s),c=a.length>1?n.getActionsJSON(a):new t({model:l,context:"item-view"}).toJSON();return m.refreshActionsDd({actions:c,contextual:i,event:e,bound:!1})})};return m.delegateDOMEvents({"click .actions":function(e){D(e)}}),m.container.addEvents({contextmenu:function(e){e.preventDefault(),e.stopPropagation(),D(e,!0)},dragstart:function(e){e.dataTransfer.dropEffect="none"},dragover:function(e){!l.enableDrop(e.dataTransfer.types)||e.target.classList.contains("drag-start")?e.dataTransfer.dropEffect="none":e.dataTransfer.dropEffect="move",e.preventDefault()},dragenter:function(e){l.enableDrop(e.dataTransfer.types)&&(e.preventDefault(),e.target.classList.contains("drag-over")||e.target.classList.contains("drag-start")||e.target.classList.add("drag-over"),e.stopPropagation())},dragleave:function(e){e.target.classList.contains("drag-over")&&e.target.classList.remove("drag-over")},drop:function(e){if(l.enableDrop(e.dataTransfer.types)&&!e.target.classList.contains("drag-start")){e.target.classList.contains("drag-over")&&e.target.classList.remove("drag-over"),e.preventDefault(),e.stopPropagation();var t=e.dataTransfer,n=t.files,i=JSON.parse(t.getData("text")||"{}");if((!n||0===n.length)&&"3DXContent"===i.protocol){var o=[];i.data.items.forEach(function(e){o.push(e.objectId)}),r.dispatchEvent("inodesActions:onDnDMove",[o,l])}}}}),m.listenTo(l,{"onChange:thumbnailLink":function(){e.setImmediate(function(){m.refreshImg()})},"onChange:actions":function(){var n=new t({model:a.model,context:"item-view"}).toJSON();e.setImmediate(function(){m.refreshActions(n)})},onChange:function(){v(),e.setImmediate(function(){m.refreshContent()})},"inodeItemView:toggleActionsElemVisibility":function(e){m.toggleActionsElemVisibility(e)}}),m.container.addClassName("inode-item"),m.container.dataset.model_cid=l.cid,m.container.dataset.view_cid=m.cid,Object.assign(m,{destroy:function(){return m.undelegateDOMEvents(),m.container.removeEvents(),m.stopListening(),f.apply(m,arguments)}})}}),define("DS/W3DContentApp/Views/UploadInodesView/tasksView",["UWA/Core","UWA/Class/View","DS/W3DContentApp/Views/UploadInodesView/taskViewSet","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/UIKIT/UIKIT.css"],function(e,t,n,i){"use strict";function o(e){e instanceof window.HTMLElement&&(e.parentNode||e).classList[e.firstChild?"remove":"add"]("hidden")}function r(e,t){e instanceof window.HTMLElement&&((t=Array.isArray(t)?t:[t]).map(function(t){return e.appendChild(t)}),o(e))}return function(s){const a=new t(Object.assign({className:"w3ddrive tasks-view popover"},s,{domEvents:{"click .cancel-all-btn":function(){n._items.filter(e=>e.state.progress<100).forEach(e=>{e.cancelUpload()})},"click .minimize-btn":function(){var e=a.container.getElement(".minimize-btn"),t=e.hasClassName("fonticon-down-open");e[(t?"remove":"add")+"ClassName"]("fonticon-down-open"),e[(t?"add":"remove")+"ClassName"]("fonticon-up-open"),a.container.toggleClassName("minimized")}}}));function l(){return a.container.getElement(".popover-body")}return Object.assign(a,{render:function(){a.container.setContent([e.createElement("div",{class:"popover-arrow"}),e.createElement("div",{class:"popover-title",html:[{tag:"div",class:"title",text:s.title||""},{tag:"div",class:"cancel-all-btn",text:i.cancelAll},{tag:"i",class:"minimize-btn fonticon fonticon-clickable fonticon-down-open"}]}),e.createElement("div",{class:"popover-body",html:s.children})]),o(l())},addChildren:function(e){return r(l(),e)},removeChildren:function(e){return function(e,t){e instanceof window.HTMLElement&&(t=Array.isArray(t)?t:[t]).filter(function(t){return e.contains(t)}).map(function(t,n,i){setTimeout(function(){e&&e.removeChild(t),n===i.length-1&&o(e)},3e3)})}(l(),e)},resetChildren:function(e){return function(e,t){e instanceof window.HTMLElement&&(e.childNodes.map(function(t){e.removeChild(t)}),r(e,t))}(l(),e)}})}}),define("DS/W3DContentApp/Collections/AuthCollection",["UWA/Core","UWA/Promise","UWA/Class/Collection","DS/W3DContentApp/Utils/RequestHelper"],function(e,t,n,i){"use strict";return n.extend({_prepareModel:function(e,t){return(t=Object.assign({},t,{})).auth=this._auth,this._parent(e,t)},setup:function(e,t){t&&(this._auth=t.auth)},sync:function(t,n,o){return(o=e.clone(o||{},!1)).ajax=o.ajax||i.getRequestMethod(o),o.auth=this._auth,this._parent(t,n,o)},createMany:function(e,n){if(!Array.isArray(e))throw new Error("createMany should be used with an array for attributes param");const i=this,o=e.map(function(e){return new t(function(t,o){n=n||{};const r=Object.assign({},n);r.onComplete=function(e,i){t(e),"function"==typeof n.onComplete&&n.onComplete(e,i,n)},r.onFailure=function(e,t){o(e),"function"==typeof n.onFailure&&n.onFailure(e,t,n)},i.create(e,r)})});return t.resolve(o)}})}),define("DS/W3DContentApp/Views/UploadInodesView/uploadInodeTaskView",["DS/W3DContentApp/Views/UploadInodesView/taskView"],function(e){"use strict";return function(t){var n,i=t.model,o={title:i.get("title"),progress:0},r=e(o,i);r.state=o,n={onProgress:function(e){e.lengthComputable&&(o.progress=Math.ceil(100*e.loaded/e.total)/100,r.refreshProgress())}},r.listenTo(i,n);var s={onDestroy:function(){r.stopListening(i,n),r.refreshError(!0)},onError:function(){r.stopListening(i,n),r.refreshError(!0)},onUpdateCompleted:function(){o.progress=100,r.refreshStatus(),r.stopListening(i,n)}};return s["onChange:"+i.idAttribute]=function(){o.progress=100,r.refreshStatus(),r.stopListening(i,n)},r.listenToOnce(i,s),r}}),define("DS/W3DContentApp/Views/UploadInodesView/uploadInodeTasksView",["DS/W3DContentApp/Views/UploadInodesView/tasksView","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e,t){"use strict";return function(n){var i,o=n.children,r=e({title:t.uploads,children:o.toArray().map(function(e){return e.render(),e.container})}),s=r.destroy;return i={onFinish:function(e){r.removeChildren(e.container)},onAdd:function(e){e.render(),r.addChildren(e.container)},onRemove:function(e){r.removeChildren(e.container)},onReset:function(e){r.resetChildren(e.toArray().map(function(e){return e.render(),e.container}))}},r.listenTo(o,i),r.container.addClassName("upload bottom"),Object.assign(r,{destroy:function(){r.undelegateDOMEvents(),s.apply(r,arguments),r.stopListening(),r.container=null,o=null,i=null,n=null}})}}),define("DS/W3DContentApp/Views/panelSlider",["UWA/Core","UWA/Class/View","UWA/String","DS/UIKIT/Tooltip","DS/W3DContentApp/BusEvent","DS/W3DDrive/widget","i18n!DS/W3DDrive/assets/nls/W3DDrive","css!DS/W3DContentApp/W3DContentApp.css"],function(e,t,n,i,o,r,s){"use strict";let a=!1,l=0;function c(e){document.body.classList.contains("collapsed")&&!e?document.body.classList.remove("collapsed"):!1!==e&&document.body.classList.add("collapsed")}return function(d={}){const u=(d.panels||[]).slice();let p=d.activePanel;const m=(e,t)=>{if(a){const n=e.touches?e.touches[0].clientX:e.x,i=t.container.querySelector(".left-panel-resizer"),o=t.container.querySelector(".panel.left .drives-panel"),r=t.container.querySelector(".panel.right"),s=t.container.offsetWidth;i&&o&&n>280&&(n<s/2||l>s/2)&&(i.style.left=`calc(${n}px - 0.5em)`,o.style.maxWidth=n+"px",r.style.marginLeft=n+"px",r.style.maxWidth="calc(100% - "+n+"px)",l=n)}},f=new t({className:"w3ddrive panel-slider",domEvents:{"click .panel.left":function(e){e.target.classList.contains("left","panel")&&r.dispatchEvent("onToggleDrivePanelSideBarCollapsed")},mouseup:function(){a=!1},touchend:function(){a=!1},mousemove:function(e){m(e,this)},touchmove:function(e){m(e,this)}}}),g=f.render,h=f.destroy;let v;const D=[];let w;function b(e){const t=D[e];t&&p!==e&&(p=e,D.forEach(e=>{e.removeClassName("active")}),t.addClassName("active"))}function C(e,t){const n=D[e];if(n)return t?(u.splice(e,1,t),n.setContent(t)):(u.splice(e,1),n.empty()),v&&e?(v.inject(n,"top"),f):f}function S(){document.documentElement.clientWidth<560&&!document.body.classList.contains("collapsed")&&r.dispatchEvent("onToggleDrivePanelSideBarCollapsed")}return Object.assign(f,{refreshPanel:C,slideTo:b,render:function(t={}){w||(f.listenTo(r,{onDrivePanelSideBarCollapsedToggled:function(e){c(e)}}),f.listenTo(o,{"driveView:onNodeClick":S,"driveTreeView:onNodeClick":S})),f.container.empty(),c(r.getBool("isDrivePanelSideBarCollapsed")),t.viewSpecs.hideController||(v=function(){const t=e.createElement("div",{class:"controller",events:{click:function(e){r.dispatchEvent("onToggleDrivePanelSideBarCollapsed"),e.stopPropagation()}},html:[{tag:"span",class:"fonticon fonticon-menu"}]});return new i({target:t,body:s.get("menu")}),t}());const l=e=>(a=!0,(e=e||window.event).stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.returnValue=!1,!1);return e.createElement("div",{class:"left-panel-resizer",events:{mousedown:function(e){l(e)},touchstart:function(e){l(e)}},html:[{tag:"span",class:"fonticon fonticon-arrow-combo-horizontal resizer"}]}).inject(f.container),[0,1].forEach(t=>{D[t]=function(t){return e.createElement("div",{class:n.format("panel {0}",t?"right":"left")})}(t),C(t,u[t]),f.container.addContent(D[t])}),b(p||0),w=!0,g.apply(f,arguments)},destroy:function(){return u.forEach(function(e){e.destroy()}),f.stopListening(),h.apply(f,arguments)}})}}),define("DS/W3DContentApp/Actions/upload-manager/upload-manager",["UWA/Class/Promise","DS/W3DContentApp/Utils/scheduleTasksToGlobalSession","DS/W3DContentApp/Views/UploadInodesView/taskViewSet","DS/W3DContentApp/Views/UploadInodesView/uploadInodeTaskView","DS/W3DContentApp/Utils/Alert","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e,t,n,i,o,r){"use strict";return{askForFolderCreation:function(n,i,s){const a=function(t,n,i){if(!t||!n)return null;if(["<",">","/","\\",":","?","*",'"',"|"].some(function(e){return n.includes(e)}))return o.add({message:r.replace(r.get("forbiddenChars"),{chars:'< > / \\ : ? * " |'}),className:"error"});{const o=t.inodeTable;return Boolean(o)&&"function"==typeof o.create?(i=Object.assign({},i,{wait:!0}),function(){return new e(function(e,o){const r=i.onComplete,s=i.onFailure;i.onComplete=function(){"function"==typeof r&&r.apply(this,arguments),e()},i.onFailure=function(){"function"==typeof s&&s.apply(this,arguments),o()},t.inodeTable.create({parentId:t.id,title:n,mimeType:"text/directory"},i)})}):null}}(n,i,s);return t(a)},askForUpload:function(o,r,s){const a=Object.keys(r).filter(function(e){return"object"==typeof r[e]}).map(function(e){return r[e]}).map(function(t){return function(t,o,r){if(!t||!o)return null;const s=t.inodeTable;let a=Boolean(s);if(!(a=(a=a&&"function"==typeof s.create)&&"function"==typeof s._prepareModel))return null;r=Object.assign({},r,{file:o,wait:!0});const l=s._prepareModel({parentId:t.id,title:o.name||"",mimeType:o.type,description:o.description});return n.add(i({model:l})),function(){return new e(function(e,t){const n=r.onComplete,i=r.onFailure;r.onComplete=function(){"function"==typeof n&&n.apply(this,arguments),e()},r.onFailure=function(){"function"==typeof i&&i.apply(this,arguments),t()},s.create(l,r)})}}(o,t,s)});return t(a)},addUploadTask:function(e){n.add(i({model:e}))}}}),define("DS/W3DContentApp/Models/AuthModel",["UWA/Core","UWA/Class/Model","DS/W3DContentApp/Utils/RequestHelper"],function(e,t,n){"use strict";return t.extend({init:function(e,t){let n;return t&&(this._auth=t.auth),n=this._parent.apply(this,arguments)},sync:function(t,i,o){if(!0!==(o=e.clone(o||{},!1)).noSync)return o.ajax=o.ajax||n.getRequestMethod(o),o.auth=this._auth,this._parent(t,i,o)}})}),define("DS/W3DContentApp/Views/DriveView/driveTreeView",["UWA/Class/View","DS/Tree/FileTreeView","DS/W3DContentApp/BusEvent","DS/W3DContentApp/Utils/Alert","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/W3DContentApp/W3DContentApp.css"],function(e,t,n,i,o){"use strict";return function(r){const s=new t({treeDocument:r.treeDocument,selection:{toggle:!1,canMultiSelect:!1},enableExpandOnDoubleClick:!0,height:"inherit",enableDragAndDrop:!0,shouldAcceptDrag:function(){return!1},onDragOverCell:function(e,t){const n=e.dataTransfer.types,i=t.cellModel.options.value._options.inode;return i&&!i.enableDrop(n)?e.dataTransfer.dropEffect="none":e.dataTransfer.dropEffect="move",!0},onDropCell:function(e,t){const r=e.dataTransfer.types,s=t.cellModel.options.value._options.inode;if(s&&s.enableDrop(r)){const t=e.dataTransfer,i=t.files,o=JSON.parse(t.getData("text")||"{}");if(0===i.length&&"3DXContent"===o.protocol){const e=[];"favorites"===s.get("id")?(o.data.items.map(t=>e.push({inodeId:t.objectId,rootId:t.objectRootId})),n.dispatchEvent("inodesActions:onAddToFavorites",[e,{isDnD:!0,favoritesRootInode:s}])):(o.data.items.map(t=>e.push(t.objectId)),n.dispatchEvent("inodesActions:onDnDMove",[e,s]))}}else i.add({message:o.replace(o.dropError,{title:s.get("title")}),className:"error"})}}),a=new e({container:s.elements.container}),l=s.getManager().getDocument();return s.onNodeClick(function(e){const t=e.nodeModel.inode;n.dispatchEvent("driveTreeView:onNodeClick",[t])}),s.onPreExpand(function(e){const t=e.data.nodeModel.inode;n.dispatchEvent("driveTreeView:onPreExpand",[t])}),a.container.addClassName("w3ddrive drive-tree"),Object.assign(a,{getXSO:l.getXSO.bind(l),reverseExpand:function(e){if(!e)return[];const t=e.getParent();return!t||e.isRoot()?a:t.isExpanded()?void 0:(t.expand(),a.reverseExpand(t))}})}}),define("DS/W3DContentApp/Actions/Accesses/accessActionsFactory",["DS/W3DContentApp/Actions/Accesses/Base"],function(e){"use strict";return function(t){if(!t||!t.access||!t.shareAccessActions)throw new Error("Options are missing.");return function(){var n=new e({model:t.access});for(var i in arguments)if(arguments.hasOwnProperty(i)){var o=arguments[i];o(n)}return n}(t.shareAccessActions)}}),define("DS/W3DContentApp/Models/Inode",["UWA/Utils","DS/W3DDrive/widget","DS/W3DContentApp/Metas/inode","DS/W3DContentApp/Models/AuthModel","DS/W3DContentApp/Utils/Helpers","UWA/Class/Promise","DS/W3DContentApp/Utils/Alert","i18n!DS/W3DDrive/assets/nls/W3DDrive"],function(e,t,n,i,o,r,s,a){"use strict";var l=n();return i.extend({defaults:{id:void 0,name:void 0,parentId:void 0,title:"",mimeType:"",downloadUrl:"",fileExtension:"",size:"",description:"",createdDate:"",modifiedDate:"",modifiedByMeDate:"",sharedWithMeDate:"",iconLink:"",thumbnailLink:{small:l.thumbnails.content,medium:l.thumbnails.content,large:l.thumbnails.content},owners:[],lastModifyingUser:{},shared:!1},isContainer:function(){return this.isFolder()||this.isCollabSpace()},isCollabSpace:function(){return!1},isFolder:function(){return"text/directory"===this.get("mimeType")},isFavorite:function(){return this.get("favorite")},isShared:function(){return!1},isPlayable:function(){var e=(this.get("fileExtension")||"").toLowerCase();return e&&("jpg"===e||"jpeg"===e)},getURI:function(){return e.parseUrl(o.result(this,"url")).path},getOwnerNames:function(){return""},getCreator:function(){return this.getOwnerNames()},getLastModifyingUserName:function(){var e;if(e=this.get("lastModifyingUser"))return e.displayName||""},getFileUrl:function(){var e=this.get("fileUrl");return new r(function(t,n){t(e)})},getDownloadUrl:function(){var e=this.get("downloadUrl");return new r(function(t,n){t({url:e,method:"GET"})})},getNLSType:function(){if(this.isFolder())return a.get("folder");{const e=this.get("fileExtension");return e?o.computeFileExtension(e):""}},get3DPlayOptions:function(e){e=e||{};var t={},n={};return n=Object.assign(n,e),this.get("forcePlay")&&(this.set("forcePlay",!1),t.provider="FILE",t.filename="DS/3DPlay360Experiences/3DPlay360Experience",n.experience=Object.assign(t,e.experience)),n},getThumbnailLink:function(){var e=this.get("thumbnailLink");return new r(function(t,n){t(e)})},getDefaultThumbnail:function(){if(this.isFolder())return l.thumbnails.folder;var e=this.get("fileExtension");return e&&l.thumbnails[e.toLowerCase()]||l.thumbnails.content},getActionIds:function(){return[]},getDirectLink:function(){return null},isActionIdoK:function(e){return-1!==this.getActionIds().indexOf(e)},enableDrop:function(e){if(this.isFolder()&&e&&e.includes(this.getDropDataType())){var t=[].concat(this),n=function(e){var t={};return e&&e.length?(t[l.ids.sharedWithMe]=!0,t[l.ids.trueRoot]=!0,t):[]}(t);return!!t.reduce(function(e,t){return e&&function(e,t){var n=e.get("id");return!t[n]&&"TRASH"!=n}(t,n)},!0)}return!1},getDragDataType:function(){return!0===this.isActionIdoK("moveTo")||this.isActionIdoK("addToFavorites")?(t.getValue("appId")+"_"+t.id+"_"+this.drive.id).toLowerCase():null},getDropDataType:function(){return!0===this.isActionIdoK("upload")?(t.getValue("appId")+"_"+t.id+"_"+this.drive.id).toLowerCase():null},isAtLeastOneActionIdOk:function(e){if(!Array.isArray(e))throw new Error("The parameter is not an Array.");var t=this.getActionIds();return e.some(function(e){return-1!==t.indexOf(e)})},doesExistInBackend:function(){var e=this;return new r(function(n){!0!==t.getValue("isStandalone")?e.sync("GET",e,{onComplete:function(t){e.drive.set("blockactions",t.blockactions),t.title?n(!0):(n(!1),e.destroy({noSync:!0}))},onFailure:function(t){t.error&&t.error.code&&s.add({message:a.replace(a.tenantAccessError,{errorMsg:t.error.message}),className:"warning"}),n(!1),e.destroy({noSync:!0})}}):n(!0)})}})}),define("DS/W3DContentApp/Collections/Inodes",["DS/W3DContentApp/Collections/AuthCollection","DS/W3DContentApp/Collections/Pagination"],function(e,t){"use strict";let n=e.extend({_sorting:{logic:{attributeName:"title",asc:!0}},init:function(e,t={}){const n=t.parentInode;if(!n||!n.id)throw new Error("You must specify a valid parentInode options");return this._parentInode=n,this._parent.apply(this,arguments)},sort:function(e={}){return e.sorting&&(this._sorting=e.sorting),this._parent.apply(this,arguments)},_sortById:function(e,t){return e.get("id")>t.get("id")?1:-1},_sortByTitle:function(e,t){const n=e.get("title").toUpperCase(),i=t.get("title").toUpperCase().localeCompare(n);return 0===i?this._sortById(e,t):i},_sortByCreatedDate:function(e,t){const n=e.get("createdDate"),i=t.get("createdDate");return n===i?this._sortByTitle(e,t):n>=i?-1:1},_sortByModifiedDate:function(e,t){const n=e.get("modifiedDate"),i=t.get("modifiedDate");return n===i?this._sortByTitle(e,t):n>=i?-1:1},_sortBySize:function(e,t){const n=e.get("size"),i=t.get("size");return n===i?this._sortByTitle(e,t):n>=i?-1:1},_sortByType:function(e,t){const n=e.get("fileExtension"),i=t.get("fileExtension").localeCompare(n);return 0===i?this._sortByTitle(e,t):i},_sortByCreator:function(e,t){const n=e.get("originator"),i=t.get("originator").localeCompare(n);return 0===i?this._sortByTitle(e,t):i},_sortByAttrName:function(){let e;switch(this._sorting.logic.attributeName){case"title":e=this._sortByTitle;break;case"createdDate":e=this._sortByCreatedDate;break;case"modifiedDate":e=this._sortByModifiedDate;break;case"size":e=this._sortBySize;break;case"type":e=this._sortByType;break;case"creator":e=this._sortByCreator;break;default:return}return e=e.apply(this,arguments),this._sorting.logic.asc?-e:e},getInode:function(e){return this.get(e)?this.get(e):(this.map(t=>{if(t.inodeTable){const n=t.inodeTable.getInode(e);if(n)return n}}),null)},comparator:function(e,t){const n=e.isContainer(),i=t.isContainer();return n&&!i?-1:!n&&i?1:this._sortByAttrName.apply(this,arguments)},filterFiles:function(){return this.filter(e=>e.isContainer())}});return n=t(n)}),define("DS/W3DContentApp/Utils/Tagger6WProxy",["UWA/Core","UWA/Class/Model","UWA/Date","DS/TagNavigatorProxy/TagNavigatorProxy","DS/W3DContentApp/Collections/Inodes","DS/W3DContentApp/Models/Inode","UWA/Class/View","DS/W3DContentApp/Utils/Helpers","DS/W3DDrive/widget","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e,t,n,i,o,r,s,a,l,c){"use strict";var d,u;return d=new t,d=e.extend(d,{_currentTagger:void 0,_currentDriveId:void 0,isSet:function(e){return e.id===this._currentDriveId},setTaggerProxy:function(t){var n;t.isCollabSpace?(this._inodeTableView&&this._inodeTableView.collection&&(this._inodeTableView.collection.filterTagObj=null,this._inodeTableView.collection.isNewFilter=!0),this.isSet(t)?this._currentTagger&&this._currentTagger.clearLocalFilter():(this._currentTagger&&(this._currentTagger.die(),delete this._currentTagger),n={filteringMode:"FilteringOnServer",events:{},widgetId:l.id,tenant:t.id},this._currentTagger=i.createProxy(n),this.listenTo(this._currentTagger,{onFilterChange:this.onFilterChange}),this._currentDriveId=t.id)):this.isSet(t)||(this._currentTagger&&(this._currentTagger.die(),delete this._currentTagger),t.isDsDrive&&l.id&&(n={filteringMode:"WithFilteringServices",widgetId:l.id,pod:"6WTags"},t.isDsDrive&&(n=e.merge({tenant:t.id},n)),this._currentTagger=i.createProxy(n),this.listenTo(this._currentTagger,{onFilterSubjectsChange:this._onFilterSubjectsChange})),this._currentDriveId=t.id)},_parseToTags:function(e){var t;return e instanceof r&&(e=[e]),Array.isArray(e)||e instanceof o?(t={},e.forEach(function(e){t[this._parseInodeToSubjectURI(e)]=this._parseInodeToTags(e)},this)):t=e,t},_parseToSubjectURIs:function(e){return e instanceof r?[this._parseInodeToSubjectURI(e)]:e.map(function(e){return e instanceof r&&(e=this._parseInodeToSubjectURI(e)),e instanceof s&&(e=this._parseInodeToSubjectURI(e.model)),e},this)},_parseInodeToTags:function(e){var t,i,o,r,s,l,d,u;return t=[],i=e.getOwnerNames(),o=e.getCreator(),e.isFolder()?l=c.get("folder"):(l=c.get("file"),u=a.computeFileExtension(e.get("fileExtension"))),e.drive&&(d=e.drive.get("title")),r=this._parseDate(e.get("modifiedDate")),s=""!==e.get("createdDate")?this._parseDate(e.get("createdDate")):this._parseDate(e.get("modifiedDate")),i&&t.push({object:i,sixw:"ds6w:who/ds6w:responsible",dispValue:i}),o&&t.push({object:o,sixw:"ds6w:who/ds6w:responsible/ds6w:originator",dispValue:o}),r&&t.push({object:n.strftime(r,"%Y/%m/%d"),sixw:"ds6w:when/ds6w:modified",type:"date"}),s&&t.push({object:n.strftime(s,"%Y/%m/%d"),sixw:"ds6w:when/ds6w:created",type:"date"}),l&&t.push({object:l,sixw:"ds6w:what/ds6w:type",dispValue:l}),u&&t.push({object:u,sixw:"ds6w:what/ds6w:docExtension",dispValue:u}),d&&t.push({object:d,sixw:"ds6w:where/ds6w:source/ds6w:dataSource",dispValue:d}),t},_parseDate:function(e){return"number"==typeof e?new Date(parseInt(e,10)):new Date(e)},_parseInodeToSubjectURI:function(e){if(e)return(l.getValue("is3DSpaceWidget")?"pid://":"driveid:")+e.get("id")},_onAdd:function(e,t){this.addSubjectsTagsWithInode(t)},_onRemove:function(e,t){this.setSubjectsTagsWithInode(t)},_onReset:function(e){this.setSubjectsTagsWithInode(e)},onFilterChange:function(e){this._inodeTableView.collection.filterTagObj=e,this._inodeTableView.collection.isNewFilter=!0,this._currentTagger.setTags({},[]);var t,n={reset:!0,type:"json",evnt:"onFilterChange"};t=n.onComplete,n.onComplete=function(){t&&t(arguments)},this._inodeTableView.collection.getFirstPage(n)},_onFilterSubjectsChange:function(e){var t;t=e.filteredSubjectList,u=t.length===this._inodeTableView.collection.length||0===Object.keys(e.allfilters).length?void 0:t,this.dispatchEvent("onFilterSubjectsChange",e)},getFilteredSubjectList:function(){return u},setInodeTable:function(e){e&&e!==this.inodeTableView&&(this.unSetInodeTable(),this._inodeTableView=e,"true"===l.getValue("is3DSpaceWidget")?(this.listenTo(e.collection,{onFilterChange:this.onFilterChange,onAdd:this._onAdd,onRemove:this._onRemove,onReset:this._onReset}),this.setSubjectsTagsWithInode(e.collection)):(this.listenTo(e.collection,{onAdd:this._onAdd,onRemove:this._onRemove,onReset:this._onReset}),this.setSubjectsTagsWithInode(e.collection)))},updateSubjectsTags:function(){u=void 0,this._currentTagger&&(this._currentTagger.unsetTags(),this.addSubjectsTagsWithInode(this._inodeTableView.visibleItems))},unSetInodeTable:function(){this._inodeTableView&&this.stopListening(this._inodeTableView.collection),delete this._inodeTableView,u=void 0,this._currentTagger&&this._currentTagger.unsetTags()},addSubjectsTagsWithInode:function(e){if(this._currentTagger)return"true"===l.getValue("is3DSpaceWidget")?this._currentTagger.addSubjects(e):this._currentTagger.addSubjectsTags(this._parseToTags(e))},setSubjectsTagsWithInode:function(e){if(this._currentTagger)return"true"===l.getValue("is3DSpaceWidget")?this._currentTagger.addSubjects(e):this._currentTagger.setSubjectsTags(this._parseToTags(e))},focusOnSubjectsWithInode:function(e){if(this._currentTagger)return this._currentTagger.focusOnSubjects(this._parseToSubjectURIs(e))},unfocus:function(){this._currentTagger&&this._currentTagger.unfocus(arguments)},deactivate:function(){this._currentTagger&&this._currentTagger.deactivate()},activate:function(){this._currentTagger&&this._currentTagger.activate()}})}),define("DS/W3DContentApp/Utils/UIElementsFactory",["DS/W3DContentApp/Views/SuperModal","UWA/Core"],function(e,t){"use strict";function n(){return e.modals.current.getFooter().getElement(".btn-primary")}function i(e){if((e=e.elements?e.elements.input:e)&&e.closest(".form-group")){const t=e.closest(".form-group");t.classList.toggle("has-error",!1),t.classList.toggle("has-warning",!1)}}return{getModalSubmitButton:n,enableModalSubmitButton:function(){n().disabled=!1},disableModalSubmitButton:function(){n().disabled=!0},unvalidateInput:function(e,{customMessage:t,type:n="error"}={}){i(e=e.elements?e.elements.input:e),t&&(e.nextSibling.textContent=t);let o="has-error";switch(n){case"error":o="has-error";break;case"warning":o="has-warning";break;default:return}e&&e.closest(".form-group")&&e.closest(".form-group").classList.toggle(o,!0)},resetInput:i,createInputWithExtension:function(e,n={}){return t.createElement("div",{class:"form-control form__input-extension",html:[Object.assign({tag:"input",maxlength:255,autocomplete:"off",spellcheck:!1},n),{tag:"span",text:e}]})}}}),define("DS/W3DContentApp/Components/OfficeDocumentEditor",["UWA/Core","UWA/String","DS/WAFData/WAFData","DS/UIKIT/Mask","DS/OfficeDocumentEditorClient/Editor","DS/W3DContentApp/BusEvent","DS/W3DContentApp/Utils/Alert","DS/W3DContentApp/Views/SuperModal","DS/W3DContentApp/Actions/upload-manager/upload-manager","DS/W3DContentApp/Utils/RequestHelper","DS/W3DContentApp/Utils/formFactory","DS/W3DContentApp/Utils/UIElementsFactory","DS/W3DDrive/widget","DS/W3DContentApp/Utils/Metrics","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e,t,n,i,o,r,s,a,l,c,d,u,p,m,f){"use strict";const g={};let h,v,D,w={inode:null,title:null,extension:null,fileUrl:null};const b={docx:f.get("Document"),pptx:f.get("Presentation"),xlsx:f.get("Spreadsheet")},C={DOCUMENT_CREATION_FAILURE:"DOCUMENT_CREATION_FAILURE"},S=e=>{w.inode&&(w.inode.editMode=e)},y=()=>Boolean(w.inode&&w.inode.editMode);return g.init=function(t){function n(e){return e?(S(!1),e.getFileUrl().then(t=>{g.launch({inode:e,fileUrl:t.url,title:e.get("title"),extension:e.get("fileExtension")})}),h):Promise.resolve()}return t=t||{},h?(n(t.inode),h):(v=e.createElement("div",{class:"ode-container"}),h=Object.assign(v,{refresh:n}),n(t.inode),h)},g.destroy=function(){D&&(D.informActiveState(!1),D.dispose(),D=null),o.close()},g.launch=function(e={}){if(!(e.inode&&e.title&&e.extension&&e.fileUrl))throw new Error("Missing input");w.inode=e.inode,w.title=e.title,w.extension=e.extension,w.fileUrl=e.fileUrl,m.trackAction({model:w.inode,eventAction:y()?"ode-edit":"ode-preview"});const t=w.inode.get3DPlayOptions();o.init({title:w.title,ext:w.extension,url:w.fileUrl,readOnly:!y(),docKeyToUse:"3ddrive_"+w.inode.get("id"),useIframe:!0,rootElem:v,platformId:w.inode.drive?w.inode.drive.id:"",playerConfig:{input:t,options:{callback:{onAnnotationShared:e=>{r.dispatchEvent("lightbox:onAnnotationShared",[e])}}}},on3DPlayerReady:function(e){D=e;const t=w.inode;if(!y()&&t.annotation){let n,i=!1;const o=t.annotation;delete t.annotation;const r=()=>{e.isReady()?(i=!0,e.loadAnnotations({annotation:o.data.annotationFile},{clean:!0})):n=setTimeout(r,100)};setTimeout(()=>{clearTimeout(n),i||s.add({message:f.get("annotationLoadError"),className:"error"})},25e3),r()}}}).then(()=>{},e=>{switch(e){case o.ERROR.NO_DOCUMENT_URL_PROVIDED:s.add({message:f.get("noDocumentUrlProvided"),className:"error"});break;case o.ERROR.SERVICE_NOT_FOUND:s.add({message:f.get("serviceNotFound"),className:"error"});break;default:s.add({message:f.get("unknownError"),className:"error"})}})},g.launchInEditMode=function(){return S(!0),g.launch(w)},g.createDocument=function(e,t){const i=b[t],r="."+t,c=i+"."+t,p=255-t.length,g=f.get("forbiddenChars",{chars:'< > / \\ : ? * " |'}),h=u.createInputWithExtension(r,{placeholder:f.get("enterTitle"),required:!0,maxlength:p,pattern:'^((?!<)(?!>)(?!/)(?!\\\\)(?!:)(?!\\?)(?!\\*)(?!")(?!\\|).)*$',title:g,name:"title"}),v=h.getElement("input");v.addEventListener("keyup",function(e){"Escape"!==e.key&&S()});const D=d.createTextArea({maxlength:255,required:!1,placeholder:f.get("enterDescription"),name:"description"});D.elements.input.addEventListener("keyup",function(e){"Escape"!==e.key&&(u.resetInput(D),this.value.length>=255&&u.unvalidateInput(D,{customMessage:f.get("charsLimitReached"),type:"warning"}))});const w=d.createForm([{tag:"div",class:"form-group",html:[{tag:"label",html:[f.get("title"),{tag:"span",class:"label-field-required",text:" *"}]},h,{tag:"span",class:"form-control-error-text"}]},{tag:"div",class:"form-group",html:[{tag:"label",text:f.get("Description")},D,{tag:"span",class:"form-control-error-text"}]}]);function S(){u.resetInput(h),v.value.length>=p&&u.unvalidateInput(h,{customMessage:f.get("charsLimitReached"),type:"warning"}),v.checkValidity()?u.enableModalSubmitButton():(u.unvalidateInput(h,{customMessage:g,type:"error"}),u.disableModalSubmitButton())}w.addEventListener("submit",function(i){i.preventDefault();const c=(v.value||"").trim(),d=(D.getContent().value||"").trim();c&&v.checkValidity()&&e.inodeTable.autoname(c+r).then(i=>{if(i&&i.iteration)window.setTimeout(function(){u.unvalidateInput(v,{customMessage:f.get("titleNotUnique"),type:"error"}),u.disableModalSubmitButton()},100);else{!function(e,t,i,r){const a=e=>{e===C.DOCUMENT_CREATION_FAILURE&&s.add({className:"error",message:f.get("documentCreationFailed")})};o.getDocumentTemplatesURL({platformId:e.drive?e.drive.id:""}).then(o=>{n.request(o[i],{method:"GET",responseType:"blob",onComplete:n=>{const o=new File([n],t.concat(".",i));o.description=r,l.askForUpload(e,[o],{onComplete:e=>{m.trackAction({model:e,eventAction:"ode-create"}),require(["DS/W3DContentApp/w3DDriveView"],function(t){e.editMode=!0,t.showLightbox({inode:e})})},onFailure:(e,t)=>{if(t){let n=f.get("uploadError",{name:e.get("title")||""});t&&t.error&&"quotaExceed"===t.error.errorCode?n+=": "+f.get("allocatedDiskSpaceExceeded"):"Access denied"===t.message&&(n+=": "+f.get("accessDenied")),s.add({message:n,className:"error"})}e&&e.destroy&&e.destroy()}})},onFailure:()=>{a(C.DOCUMENT_CREATION_FAILURE)}})},()=>{a(C.DOCUMENT_CREATION_FAILURE)})}(e,c,t,d);const i=a.modals.current;i&&i.hide()}})}),a.dialog({title:f.get("NewDocumentType",{documentType:i.toLowerCase()}),body:w,buttons:[{className:"primary",value:f.get("create"),action:function(){w.dispatchEvent(new Event("submit",{cancelable:!0}))}},{value:f.get("cancel"),action:function(e){e.hide()}}]}),e.drive&&e.drive.isDsDrive&&e.inodeTable.autoname(c).then(e=>{v.value=e.iteration?f.get("documentAutoname",{title:i,iteration:e.iteration}):i,v.focus(),v.setSelectionRange(0,v.value.length),S()})},g.saveDocument=function(){m.trackAction({model:w.inode,eventAction:"ode-save"}),document.dispatchEvent(new Event("disableSaveButton")),i.mask(v,f.get("saving"));const r=w.inode;(function(e){return new Promise((i,o)=>{const r=t.format("{0}/ticket?id={1}",c.getBaseUrl(e._auth.platform.url),window.Date.now());n.authenticatedRequest(r,{method:"GET",type:"json",onComplete:(e,t)=>{e.csrf=t["x-ds-csrftoken"],i(e)},onFailure:o})})})(r).then(a=>{o.save({callbackUrl:a.actionurl,params:{"file-name":w.title,"file-title":w.title,"file-description":w.title,[a.jobticket]:a.ticket},headers:{},filenameForUpload:"file_0"}).then(o=>{if(o&&o.success)if(o.endpoint_body){(function(e,i){const o=w.inode,r=t.format("{0}/{1}",c.getBaseUrl(o._auth.platform.url),o.get("id"));return new Promise((t,o)=>{n.authenticatedRequest(r,{method:"PUT",type:"json",headers:e,data:JSON.stringify(i),onComplete:e=>{t(e)},onFailure:o})})})({"X-DS-CSRFTOKEN":a.csrf,Accept:"application/json","Content-Type":"application/json"},{receipt:function(t){return e.createElement("div").setHTML(t).getElement('[name="__fcs__jobReceipt"]').value}(o.endpoint_body),lastmodifier:p.getValue("3ddrive_uuid")||"",title:w.title}).then(e=>{e&&(r.set(r.parse(e)),s.add({message:f.get("saveDocumentSuccess"),className:"success"}))},()=>{s.add({message:f.get("saveDocumentError"),className:"error"})})}else o.success;else s.add({message:f.get("saveDocumentError"),className:"error"});document.dispatchEvent(new Event("enableSaveButton")),i.unmask(v)},()=>{document.dispatchEvent(new Event("enableSaveButton")),i.unmask(v),s.add({message:f.get("saveDocumentError"),className:"error"})})})},g.closeDocument=function(){return new Promise(e=>{const t=()=>{S(!1),w={},e(!0)};if(y()){const e=()=>a.confirm({title:f.get("closeDocumentTitle"),message:f.get("closeDocumentConfirmation"),callback:function(e){e&&t()}});o.state().then(n=>{n&&n.is_modified?e():t()},()=>{e()})}else t()})},g}),define("DS/W3DContentApp/Utils/History",["UWA/Class","UWA/Class/Events","UWA/Class/Listener","UWA/String","DS/W3DDrive/widget","DS/W3DContentApp/Utils/Metrics"],function(e,t,n,i,o,r){"use strict";let s,a=/^\/+|\/+$/g,l=!1;let c="";return(s=e.extend(t,n,{_getSavedFragment:function(){let e="",t="";if(o.getValue("X3DContentId")){const n=JSON.parse(o.getValue("X3DContentId"));if("X3DDRIV_AP"!==n.source&&n.data&&n.data.items&&n.data.items.length){const i=n.data.items[0];"3DDrive"===i.serviceId&&(t=`drives/${i.envId}/mimetype/text%2Fdirectory/inode/${i.objectId}`,"DriveFolder"===i.objectType?t+="/content":"DriveFile"===i.objectType&&(t+="/preview"),e=t,r.trackNavigation({eventAction:"load",startingRouteType:"open-with"}))}}if(!e)if(o.getValue("driveId")&&o.getValue("contentId")&&o.getValue("contentType")){var n=o.getValue("driveId"),i=o.getValue("contentId"),s=o.getValue("contentType");t="drives/"+n+"/mimetype/text%2Fdirectory/inode/"+i,"folder"===s?t+="/content":"file"===s&&(t+="/preview"),e=t,r.trackNavigation({eventAction:"load",startingRouteType:"direct-link"})}else o.getValue("enablePinNavigation")?(e=o.getValue("savedPinNavigation"),r.trackNavigation({eventAction:"load",startingRouteType:"pin-navigation"})):(e=o.getValue("saved-fragment"),r.trackNavigation({eventAction:"load",startingRouteType:"default"}));return e?(e&&e.length>0&&-1===e.indexOf("/")&&(e=decodeURIComponent(e)),e):null},_saveFragment:function(e){if(!o.getValue("isStandalone"))return o.setValue("saved-fragment",e)},_loadUrl:function(e,t){e=this.fragment=this.getFragment(e);var n=this.handlers.some(function(t){if(i.test(e,t.route))return t.callback(e),!0});return n||(console.log('No handler can be found for route = "'+e+'"'),!0===t)?n:this._loadUrl(c,!0)},init:function(){return this.handlers=[],this},setBaseURI:function(e){0!==e.indexOf("/")&&(e="/"+e),c=e},getFragment:function(e){return void 0===e&&(e=""),e.replace(a,"")},route:function(e,t){this.handlers.unshift({route:e,callback:t})},navigate:function(e,t){return!!l&&(t&&!0!==t||(t={trigger:!!t}),t.hasOwnProperty("loadBaseUri")&&!0===t.loadBaseUri&&(e=c),e=this.getFragment(e||""),this.fragment!==e||!0===t.force?(this.fragment=e,this._saveFragment(e),t.trigger?this._loadUrl(e):void 0):void 0)},start:function(e){if(e=e||{},l)throw new Error("Backbone.history has already been started");this.root=this._getSavedFragment()||e.root||c,this.root=("/"+this.root+"/").replace(a,"/"),l=!0,e.silent||this._loadUrl(this.root)},stop:function(){l=!1}})).singleton()}),define("DS/W3DContentApp/Utils/Router",["DS/W3DContentApp/Utils/Helpers","DS/W3DContentApp/Utils/History","UWA/Core","UWA/Class","UWA/Class/Events","UWA/Class/Listener","UWA/Class/Options"],function(e,t,n,i,o,r,s){"use strict";const a=["routes"],l=/\((.*?)\)/g,c=/(\(\?)?:\w+/g,d=/\*\w+/g,u=/[\-{}\[\]+?.,\\\^$|#\s]/g;return i.extend(s,o,r,{init:function(e){let t;e=n.clone(e||{},!1);for(let n=a.length-1;n>=0;n--)t=a[n],e.hasOwnProperty(t)&&(this[t]=e[t],delete e[t]);this._bindRoutes(),this.setup.apply(this,arguments)},setup:function(){},_routeToRegExp:function(e){return e=e.replace(u,"\\$&").replace(l,"(?:$1)?").replace(c,function(e,t){return t?e:"([^/?]+)"}).replace(d,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var n;return(n=e.exec(t).slice(1)).map(function(e,t){return t===n.length-1?e||null:e?decodeURIComponent(e):null})},_bindRoutes:function(){var t,n;if(this.routes)for(this.routes=e.result(this,"routes"),n=Object.keys(this.routes);null!=(t=n.pop());)this.route(t,this.routes[t])},execute:function(e,t){e&&e.apply(this,t)},getLastFragment:function(){return t.fragment},navigate:function(e,n){return t.navigate(e,n),this},setBaseURI:function(e){return t.setBaseURI(e)},route:function(e,i,o){var r,s;return r=this,n.is(e,"regexp")||(s=this._routeToRegExp(e)),n.is(i,"function")&&(o=i,i=""),o||(o=this[i]),t.route(s,function(n){var a,l={};a=r._extractParameters(s,n).map(function(t){if(t){var n=c.exec(e);n&&(l[n[0]]=t)}}),c.lastIndex=0,r.execute(o,l,i),r.dispatchEvent.apply(r,["onRoute:"+i].concat(a)),r.dispatchEvent("onRoute",i,a),t.dispatchEvent("onRoute",r,i,a)}),this}})}),define("DS/W3DContentApp/Views/InodePanelView/inodesViewFunc",["DS/WebAppsFoundations/Views/CollectionView","DS/W3DContentApp/SearchProxy","DS/W3DContentApp/Utils/Tagger6WProxy"],function(e,t,n){"use strict";function i(e){return Array.isArray(e)?e:[e]}function o(e=""){return"string"==typeof e?e.toUpperCase():e}function r(e,t,n){var o;return e=i(e),o="function"==typeof t?function(e){return t(e,n)}:function(e){return e===t},e.some(o)}function s(e,t){return r(e,function(e,n){return e==="driveid:"+t.get("id")},t)}function a(e,t){return i(t).filter(function(e){return"function"==typeof e}).reduce(function(t,n){return t&&n(e)},!0)}return{getView:function(t){var n=new e(Object.assign({},t));return n.container.addClassName("w3ddrive inodes"),n},filtererWith3DDProxys:function(e){return a(e,[function(e){var t=n.getFilteredSubjectList();return!t||s(t,e)},function(e){return void 0===t.getQuery()||r(t.getQuery(),function(e,t){const n=o(t.get("alias")).includes(o(e)),i=o(t.get("title")).includes(o(e));return n||i},e)}])},filtererWithTagProxy:function(e){return a(e,[function(e){var t=n.getFilteredSubjectList();return!t||s(t,e)},function(e){return!0}])}}}),define("DS/W3DContentApp/Views/InodePanelView/inodeTableViewFunc",["UWA/Core","DS/W3DDrive/widget","DS/W3DContentApp/BusEvent","DS/W3DContentApp/Views/InodePanelView/inodesViewFunc","DS/W3DContentApp/Views/InodePanelView/inodeItemView","DS/W3DContentApp/Utils/inodeItemViewAttributes","DS/W3DContentApp/Utils/Helpers","DS/W3DXComponents/Views/EmptyView","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e,t,n,i,o,r,s,a,l){"use strict";const c="thumbnailsLayout",d="tilesLayout";let u;function p(e,t){return new a({icon:e||"picture",title:t||l.noContent})}function m(e,t){if(!e||!t)throw new Error("Missing input");const n=e.classList.contains("thumbnails"),i=e.classList.contains("tiles"),o=e.classList.contains("list");return t===c?(n||e.classList.add("thumbnails"),e.classList.remove("tiles"),e.classList.remove("list")):t===d?(i||e.classList.add("tiles"),e.classList.remove("thumbnails"),e.classList.remove("list")):(o||e.classList.add("list"),e.classList.remove("thumbnails"),e.classList.remove("tiles")),e}return{getEmptyView:p,wrapWithLayout:m,getView:function(a){var l,c=Object.assign({emptyView:p(),ItemView:function(e){return o(Object.assign(e,{}))},filterer:"none"===a.filterType?i.filtererWithTagProxy:i.filtererWith3DDProxys},a);const d=a.collection&&a.collection._parentInode,f=d&&d.configuration,g=f&&f.defaultLayout;u=g||t.getValue("inodeTableLayoutKey");var h=i.getView(c);const v=r(a.collection._parentInode);var D=h.destroy;return h.destroy=function(){l&&window.cancelAnimationFrame(l),l=null,c&&c.emptyView&&(c.emptyView.destroy(),c.emptyView=null),D.apply(h,arguments),h.container=null,h.stopListening(),h.model=null,c=null},h.onRender=function(){if(c.collection&&c.collection.length){const i=[],o=c.collection._parentInode,r=o&&o.configuration;(!r||r.canMultiselect||void 0===r.canMultiselect)&&i.push({tag:"div",class:"item__selection_icon fonticon fonticon-check"});const a=s.getSortConfiguration()[c.sorting]||{},l=t.getValue("inodesSorting")?t.getValue("inodesSorting").logic:a,d="fonticon-expand-up",u="fonticon-expand-down";v.forEach(e=>{let t=e.classname;e.sortable&&(t=t.concat(" ","sortable"),e.key===l.attributeName&&(t=t.concat(" ","active"))),i.push({tag:"div",class:t,category:e.key,html:e.sortable?[{tag:"span",text:e.nls},{tag:"span",class:"fonticon-clickable fonticon "+(l&&l.asc?d:u)}]:{tag:"span",text:e.nls},events:{click:function(){const e=this.getElement("span.fonticon"),t=this.getAttribute("category");let i="";if(e){const o=e.classList;o.contains(u)?(o.replace(u,d),i=i.concat(t,"-a")):o.contains(d)&&(o.replace(d,u),i=i.concat(t,"-d"));const r="active";this.parentElement.getElementsByClassName(r).forEach(e=>{e.removeClassName(r)}),this.addClassName(r),n.dispatchEvent("inodePanelView:onSort",[{id:i,logic:s.getSortConfiguration()[i]}])}}}})}),h.container.prepend(e.createElement("div",{class:"list__header",html:i}))}},h.container.addClassName("w3ddrive inode-table w3dx link fixed reveal"),m(h.container,u),l=window.requestAnimationFrame(function e(){if(h&&h.container){var t=h.container,n=t.getBoundingClientRect().width,i=t.classList.contains("content-view--small"),o=t.classList.contains("content-view--medium"),r=t.classList.contains("content-view--large");n<380?(i||t.classList.add("content-view--small"),t.classList.remove("content-view--medium"),t.classList.remove("content-view--large")):n<580?(o||t.classList.add("content-view--medium"),t.classList.remove("content-view--small"),t.classList.remove("content-view--large")):n<850?(r||t.classList.add("content-view--large"),t.classList.remove("content-view--small"),t.classList.remove("content-view--medium")):(t.classList.remove("content-view--small"),t.classList.remove("content-view--medium"),t.classList.remove("content-view--large")),l=window.requestAnimationFrame(e)}}),h},thumbnailsLayoutKey:c,tilesLayoutKey:d,listLayoutKey:"listLayout"}}),define("DS/W3DContentApp/Views/setOfSelectedItemView",["UWA/Array","DS/W3DContentApp/Utils/SetOfSelectedView"],function(e,t){"use strict";return function(n){const i=new t(n);return i.addEvents({onAdd:function(e){e.refreshSelected(!0)},onRemove:function(e){e.refreshSelected(!1)},onReset:function(t,n){n.previousItems.forEach(e=>{e.refreshSelected(!1)}),e.invoke(i,"refreshSelected",!0)}}),i}}),define("DS/W3DContentApp/Views/InodePanelView/inodeTableView",["DS/W3DContentApp/Views/InodePanelView/inodeTableViewFunc","DS/W3DDrive/widget"],function(e,t){"use strict";return function(n){if(!n||!n.collection)throw new Error("Missing input");var i=n.collection,o=e.getView(n),r=o.destroy,s={onSort:function(){o.render()}};return o.listenTo(t,{onInodeTableLayoutKeyUpdated:function(t){e.wrapWithLayout(o.container,t)}}),i.addEvents(s),Object.assign(o,{destroy:function(){return i.removeEvents(s),o.stopListening(),r.apply(o,arguments)}})}}),define("DS/W3DContentApp/Collections/DriveTreeDocument",["UWA/Core","DS/Tree/TreeDocument","DS/W3DContentApp/Models/DriveTreeNodeModel"],function(e,t,n){"use strict";return function(i={}){const o=new t(e.merge(i,{useAsyncPreExpand:!1,shouldAcceptDrop:function(){return!1}})),r=o._getTrueRoot();function s(e,t){var n;return t||(t=r),[].concat(t.getChildren()).some(function(t){if(t&&t.inode===e)return n=t,!0}),n}return Object.assign(o,{searchWithInode:s,buildNodesPath:function(e,t,i={}){const a=e.slice(),l=a.shift();t||(t=r);const c=(i.hiddenRootInodes||[]).includes(l&&l.id);if(!e.length||c)return[t];let d=s(l,t);return d||(d=new n({inode:l,hiddenRootInodes:i.hiddenRootInodes}),t.addChild(d)),[d].concat(o.buildNodesPath(a,d,{hiddenRootInodes:i.hiddenRootInodes}))}})}}),define("DS/W3DContentApp/Views/DriveView/driveTreeViewWithDocument",["DS/W3DContentApp/Metas/inode","DS/W3DContentApp/Collections/DriveTreeDocument","DS/W3DContentApp/Views/DriveView/driveTreeView","css!DS/W3DContentApp/W3DContentApp.css"],function(e,t,n){"use strict";const i=e();return function(e={}){const o=new t({hiddenRootInodes:e.hiddenRootInodes}),r=n({treeDocument:o,model:e&&e.model?e.model:null});return Object.assign(r,{expandInodesPath:function(t){if(!t.length)return;const n=o.buildNodesPath(t,null,e),s=n[0];return s&&s.inode&&s.inode.id===i.ids.trueRoot?r.container.addClassName("with-true-root"):r.container.removeClassName("with-true-root"),r.reverseExpand(n[n.length-1]),n}})}}),define("DS/W3DContentApp/Views/accessItemView",["UWA/Utils","UWA/String","DS/W3DContentApp/Views/itemView","DS/W3DContentApp/Actions/Accesses/accessActionsFactory","DS/W3DDrive/widget","DS/UIKIT/Modal","DS/WebappsUtils/WebappsUtils","DS/W3DContentApp/Utils/RequestHelper","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e,t,n,i,o,r,s,a,l){"use strict";return function(c){if(!c||!c.model||!c.shareAccessActions)throw new Error("Missing input");var d,u,p=c.model,m=c.shareAccessActions,f={model:p};let g="permission-item";var h=i({access:p,shareAccessActions:m});function v(){var n;if(p.isGroup&&p.isGroup()){const r=(e=0)=>{const t=Number(e),n=1===t?l.get("groupMemberCount"):l.get("groupMembersCount");return l.replace(n,{total:t})};"OnPremise"!==p.collection._auth.platformId&&(g+=" hidden",function(){if(!p)throw new Error("Missing input");const e=p._auth.platformId,n=p.collection._parentInode.drive.get("user").id,i=Date.now(),r=(o.getValue("is3DSpaceWidget")?"X3DCSMA_AP":"X3DDRIV_AP").concat("-",n,"-",i),s=t.format("{0}/search",p._auth.platform.urls3DSearch);return new Promise((t,n)=>{a.performRequestWithOptions(s,{type:"json",method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},data:JSON.stringify({source:"usersgroup",query:'[ds6w:type]:("foaf:Group") AND ([ds6w:resourceUid]:"'+p.get("id")+'")',select_predicate:["ds6w:label","ds6w:type","dsaccess:groupMemberCount","dsusergroup:groupMaturity"],nresults:8,order_by:"desc",order_field:"relevance",with_synthesis:!1,with_synthesis_attribute:!1,tenant:e,locale:o.lang,label:r}),onComplete:e=>{let n,i=[];e.hasOwnProperty("results")&&(i=e.results.filter(e=>e.hasOwnProperty("attributes")).map(e=>e.attributes.filter(e=>e.hasOwnProperty("name")&&e.hasOwnProperty("value")).map(e=>(e.name.contains("ds6w:")&&(e.name=e.name.split("ds6w:").pop()),e.name.contains("dsaccess:")&&(e.name=e.name.split("dsaccess:").pop()),e.name.contains("dsusergroup:")&&(e.name=e.name.split("dsusergroup:").pop()),"type"===e.name&&e.value.contains("foaf:")&&(e.value=e.value.split("foaf:").pop()),e)).filter(e=>"resourceid"===e.name||"label"===e.name||"type"===e.name||"groupMemberCount"===e.name||"groupMaturity"===e.name).reduce((e,t)=>("groupMaturity"===t.name&&(t.value=t.value.split("dsusergroup:State.").pop()),e[t.name]=t.value,e),{}))),i.length>0&&(n=i[0]),t(n)},onFailure:n})})}().then(t=>{t?(d.container.classList.remove("hidden"),f.title=t.label,f.metas[1]=r(t.groupMemberCount),f.image="Private"===t.groupMaturity?s.getWebappsAssetUrl("W3DContentApp","thumbnails/default-private-group.svg"):s.getWebappsAssetUrl("W3DContentApp","thumbnails/default-group.svg"),e.setImmediate(function(){d.refreshImg(),d.refreshContent()})):d.destroy()},()=>{d.destroy()})),f.image=s.getWebappsAssetUrl("W3DContentApp","default-group.svg"),n={id:"id",title:"title",metas:function(e){let t=[];return t.push(i(e.get("accessright"))),t.push(r(e.get("members"))),t}}}else n={id:"id",image:"picture",title:function(e){let t=e.get("title")||e.get("emailAddress");return e.isPending&&e.isPending()&&(t+=" ("+l.get("pending")+")"),t},metas:function(e){let t=[];return t.push(i(e.get("accessright"))),t}};function i(e){const t={owner:l.get("owner"),read:l.get("can_view"),edit:l.get("can_edit"),read_share:l.get("can_view_share"),edit_share:l.get("can_edit_share")};return t[e]?t[e]:l.get(e)}Object.keys(n).forEach(function(e){let t;t="function"==typeof n[e]?n[e](p):p.get(n[e]),f[e]=t}),f.viewConf={draggable:!1},f.actions=h.toJSON(),f.actions&&p.isGroup&&p.isGroup()&&f.actions.push({handler:function(){require(["DS/i3DXRDFGroupViewer/js/GroupViewer"],function(e){const t=new e({platformId:f.model._auth.platformId,groupId:f.model.get("id"),language:o.lang});new r({renderTo:document.body,className:"group-viewer",visible:!0,closable:!0,header:l.get("viewGroupMembersTitle"),body:t.render()})})},icon:"fonticon fonticon-user-eye",id:"viewMembers",text:l.get("viewMembers")})}return v(),d=n(f),u=d.destroy,d.listenTo(p,{onChange:function(){v(),e.setImmediate(function(){d.refreshContent(),d.refreshActions(f.actions)})}}),d.container.addClassName(g),Object.assign(d,{destroy:function(){u.apply(d,arguments),p=null,h.model=null,d.stopListening()}})}}),define("DS/W3DContentApp/Views/InodePanelView/inodeTableScrollViewFunc",["DS/W3DContentApp/Utils/dropdownContextmenu"],function(e){"use strict";return{createActionsDD:function(t,n){if(!Array.isArray(t))throw new Error("Wrong type");var i=t.map(function(e){return{className:e.className||"",text:e.text||"",fonticon:e.icon,handler:e.handler&&n?e.handler.bind(n):null}}),o=n.container;return new e({className:"folder-contextmenu",target:o,items:i,removeOnHide:!1,contextual:!0})},processFiles:function(e){var t=[],n=[];if(e.files&&e.files.length>0){var i;for(i=0;i<e.files.length;i++)t.push(e.files.item(i));for(i=0;i<e.items.length;i++)"file"===e.items[i].kind&&n.push(e.items[i]);if(function(e){var t=!!e.items;return(t=t&&!!e.items.length)&&!!e.items[0].webkitGetAsEntry}(e))return function(e,t){return[].concat(e).filter(function(e,n){var i=t[n];if(!e||!i)return!1;var o=i.webkitGetAsEntry();return!!o&&!o.isDirectory})}(t,n);if(function(e){return!!e.mozSourceNode}(e))return function(e){return[].concat(e).filter(function(e){if(!e)return!1;if(e.type)return!0;try{return(new FileReader).readAsBinaryString(e.slice(0,5)),!0}catch(e){return!1}})}(t)}return t},eventHasFiles:function(e){return!(!e||!e.dataTransfer)&&Array.prototype.some.call(e.dataTransfer.types,function(e){return"Files"===e})},shouldActiveDropState:function(e){return 1===(e="number"==typeof e?e:0)},shouldDesactiveDropState:function(e,t){var n=!e;return t="number"==typeof t?t:-1,!(n=(n=n||0!==t)||e.visibleItems&&!e.visibleItems.length)}}}),define("DS/W3DContentApp/Utils/dialogTree",["UWA/Core","DS/UIKIT/Scroller","DS/W3DContentApp/Views/DriveView/driveTreeViewWithDocument","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e,t,n,i){"use strict";return function(o,r={}){const s=n({hiddenRootInodes:r.hiddenRootInodes}),a=s.getXSO(),l=e.createElement("div",{class:"modal__content-tree-wrapper",html:s.container}),c=e.createElement("div",{class:"modal__content-tree",html:[l,e.createElement("span",{class:"form__message-error",text:" "})]});a.onAdd(function(e={}){return function(){const t=e.xso,n=e.modalContentTree,o=e.excludeInodes||[];var r=function(e){return e.get().map(e=>e.inode)}(t),s=n.querySelector(".form__message-error"),a=n.parentElement.parentElement.querySelector(".js-validation-button"),l=r.reduce(function(e,t){return e&&function(e,t=[]){return!t.includes(e.get("id"))}(t,o)},!0);l||function(e,t){if(!e||!t)return;e.textContent=i.get("operationNotPossibleOnFolder",{name:t.get("title")})}(s,r[0]);var c=l;c&&e.checkForm&&(c=e.checkForm(!0)),function(e,t){if(!e)return;e.classList.toggle("disabled",t)}(a,!c),function(e,t){if(!e)return;e.classList.toggle("form__message-error--active",t)}(s,!l)}}({xso:a,modalContentTree:c,excludeInodes:r.excludeInodes,checkForm:r.checkForm}));const d=new t({element:l});return o.map(function(e){var t=!e.isContainer();t&&(e=e.collection.dot()),e.drive.getInodesPath(r.inodeFrom,e).then(function(e){var n=s.expandInodesPath(e);if(n&&n.length){var i=n[n.length-1];if(t)if("myCollabSpaces"===i.inode.get("parentId")){i.hide();var o=i._parentNode.getChildren(),r=["VPLMProjectLeader","VPLMCreator"];o.map(function(e){var t=e.inode.get("contexts")[0].role?e.inode.get("contexts")[0].role:e.inode.get("contexts")[1].split(".")[0];-1===r.indexOf(t)&&e.hide()})}else i.expand();else i.hide()}})}),{xso:a,scroller:d,treeView:s,modalContentTree:c}}}),define("DS/W3DContentApp/Utils/Actions/moveAndCopy",["UWA/Core","DS/W3DDrive/Metas/DSDrive/inode","DS/W3DContentApp/Utils/drivesInputs","DS/W3DContentApp/Utils/dialogTree","DS/W3DContentApp/Utils/formFactory","DS/W3DContentApp/Views/SuperModal","DS/W3DDrive/Utils/StructureNavigation","DS/UIKIT/Input/Toggle","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e,t,n,i,o,r,s,a,l){"use strict";const c=t();let d;return function(t,p={}){const m=[].concat(t);p.excludeInodes=function(e,t={}){if(!e||!e.length)return[];const n=[c.ids.sharedWithMe,c.ids.recents,c.ids.favorites,c.ids.trash];t.duplicate||e.forEach(e=>{const t=e.collection.dot();t&&n.push(t.get("id"))});return n}(m,p),p.hiddenRootInodes=[c.ids.recents,c.ids.favorites,c.ids.trash];let f="",g="",h="";const v=[];let D=!1;const w={};if(p.duplicate)f=l.get("copy"),h=l.get("copy"),v.push({label:l.get("copyLinkedFiles")}),v.push({label:l.get("copyFileOnly")});else if(p.restore){f=l.get("restore"),g=l.replace(1===p.errorCode?l.get("restoreNotAvailableParent"):l.get("restoreNotUniqueName"),{name:t.get("title")}),h=l.get("restore"),p.checkForm=function(e){e&&(D=!0);var n=document.getElementById("inputName"),i=u(y.xso);return"true"===n.getAttribute("validity")&&""!==n.value&&(2!==p.errorCode||n.value!==t.get("title")||i[0].id!==t.get("oldparentid"))&&(d=n.value,!0)};const i=n(t),r=i.maxchars;var b=o.createTextInput(Object.assign({pattern:i.forbiddenChars.regex,required:!0,title:i.forbiddenChars.text||"",value:t.get("title"),id:"inputName"},r)),C=o.createTextError({text:i.forbiddenChars.text}),S={chars:i.forbiddenChars.text,maxLengthText:r?r.maxLengthText:void 0};b.classList.add("modal_inputName"),b.setAttribute("validity",!0),b.onkeyup=function(){b.setAttribute("validity",this.checkValidity()),o.onCheckInput(r.maxLength,b,C,S,".js-validation-button");var e=b.parentElement.parentElement.parentElement.querySelector(".js-validation-button");D&&p.checkForm()?e.classList.remove("disabled"):e.classList.add("disabled")},w.modalNewTitle=b,w.header=e.createElement("div",{html:g,class:"shareview__header-text"}),w.textErrorInputName=C}else f=1===m.length?l.get("move"):l.get("moveElems",{count:m.length}),h=l.get("move"),v.push({label:l.get("moveLinkedFiles")}),v.push({label:l.get("moveFileOnly")});let y=i(m,p);if(s.isLinkedFile(t)){const e=function(e={}){if(!e.toggleItems)throw new Error("You must specify a valid options object with a toggleItems properties");const t=e.toggleItems,n={name:"transfertType",className:"primary"},i=new a(Object.assign({},n,{value:"all",label:t[0].label})).check(),o=new a(Object.assign({},n,{value:"one",label:t[1].label}));var r=document.createElement("div");return r.appendChild(i.elements.container),r.appendChild(o.elements.container),{container:r,toggleLinked:i,toggleOne:o}}({toggleItems:v});(y=Object.assign(y,e)).modalContentTree.appendChild(y.container)}const A=Object.assign({},w,y);r.dialog({title:f,body:[A.header,A.modalNewTitle,A.textErrorInputName,A.modalContentTree],buttons:[{className:"primary js-validation-button",value:h,action:function(e){e.hide(),function(e){const t=e.model,n=e.components,i=e.dispatchEvent,o=e.callback,r=e.fallback,s={data:{}};n.toggleLinked&&n.toggleLinked.isChecked()&&(s.queryStrings={expand:"true"});const a=u(n.xso);if(s.data.parentid=a[0].id,e.duplicate)return void i("onCopy",[t,a[0],s]);if(e.restore)return void t.restore({parentid:a[0].id,title:d}).then(o,r);s.itemView=e.itemView,i("onMove",[t].concat(a[0],s))}(Object.assign({},{model:t,components:y},p))}},{value:l.get("cancel"),action:function(e){e.hide()}}]});const W=r.modals.current.elements;W.footer.getElement(".js-validation-button").addClassName("disabled"),W.scroller=A.scroller,W.treeView=A.treeView};function u(e){return e.get().map(function(e){return e.inode})}}),define("DS/W3DContentApp/Views/InodePanelView/inodeTableScrollView",["DS/W3DXComponents/Views/Layout/ScrollView","DS/W3DContentApp/Views/InodePanelView/inodeTableScrollViewFunc","DS/W3DContentApp/Metas/inode","DS/W3DContentApp/Views/InodePanelView/inodeTableView","DS/W3DContentApp/Views/InodePanelView/inodeTableViewFunc","DS/W3DContentApp/BusEvent","DS/W3DContentApp/Utils/Alert","DS/W3DDrive/InodeActions","DS/UIKIT/Spinner","UWA/Utils/Client","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/W3DContentApp/W3DContentApp.css"],function(e,t,n,i,o,r,s,a,l,c,d){"use strict";const u=n();return function(n){if(!n||!n.inode||!n.viewSpecs)throw new Error("Missing input");const p=n.inode,m=n.viewSpecs;if(!p.isContainer())throw new Error("The inode should be a container");let f=!1,g=p.inodeTable;const h=()=>p.isAtLeastOneActionIdOk([u.actionPubIds.upload,u.actionPubIds.addContent]),v=p.configuration&&p.configuration.emptyView;let D=function(e={}){return e.emptyView?e.emptyView({isDnD:e.isDnd,icon:e.icon,title:e.title}):o.getEmptyView(e.icon,e.title)}({isDnd:h(),emptyView:m.contentViewSpecs&&m.contentViewSpecs.emptyView,icon:v&&v.icon,title:v&&v.title}),w=i({collection:g,emptyView:D,filterType:m.contentViewSpecs&&m.contentViewSpecs.filterType,sorting:m.sorting}),b=new e({view:w,usePullToRefresh:!1,events:{onInfiniteScroll:function(){"function"==typeof g.hasNextPage&&g.hasNextPage()?r.dispatchEvent("inodeTableScrollView:onNextPage",[g]):b.useInfiniteScroll(!1)}}});const C=e=>{const t=new a({model:e}).toJSON(),n=t.find(e=>"uploadFolder"===e.id),i=c.Platform.ios||c.Platform.android||c.Platform.ipad||c.Platform.tablet;return n&&i&&t.splice(t.findIndex(e=>"uploadFolder"===e.id),1),t},S=e=>{b.container.click(),b.dropdownMenu.show(!1,e)};let y=0,A=new l;const W=b.render,I=b.destroy;return b.container.classList.add("inode-table-scroll"),b.container.classList.add("w3ddrive"),b.listenTo(p,{"onChange:actions":function(e,n){n&&(h()&&(x(),D.toggleDnDView&&D.toggleDnDView(!0)),this.dropdownMenu&&(this.dropdownMenu=null,delete this.dropdownMenu,this.container.removeEventListener("contextmenu",S)),n.length&&(this.dropdownMenu=t.createActionsDD(C(p),this),this.container.addEventListener("contextmenu",S)))}}),b.listenTo(g,{onRequest:function(e){e._models&&V(!0)},onSync:function(){f&&(b.endLoading(),V(!1),b.useInfiniteScroll(!0))},onReset:function(){V(!0)},onError:function(){V(!1)}}),x(),Object.assign(b,{render:function(){return this.container.empty(),W.apply(this,arguments),A.inject(this.container,"top"),f=!0,this.dropdownMenu=t.createActionsDD(C(p),b),b.container.addEventListener("contextmenu",S),this},destroy:function(){f=!1,D&&(D.destroy(),D=null),b&&(I.apply(b,arguments),b.container.removeEvents(),b.stopListening(),b.container=null,b=null),A&&(A.destroy(),A=null),g=null}});function E(e){b.container.classList[e?"add":"remove"]("drag-over"),w._toggleElement(D.container,e)}function x(){b.container.removeEvents();const e=p.isAtLeastOneActionIdOk([u.actionPubIds.upload,u.actionPubIds.addContent]);b.container.addEvent("dragenter",function(n){!1!==t.eventHasFiles(n)&&(y+=1,t.shouldActiveDropState(y)&&e&&(E(!0),n.preventDefault()))}),b.container.addEvent("dragover",function(n){(!1!==t.eventHasFiles(n)||p.enableDrop(n.dataTransfer.types))&&e?t.shouldActiveDropState(y)&&n.preventDefault():(n.dataTransfer.dropEffect="none",n.preventDefault())}),b.container.addEvent("dragleave",function(e){t.eventHasFiles(e)&&(y-=1,t.shouldDesactiveDropState(w,y)&&(E(!1),e.preventDefault()))}),b.container.addEvent("drop",function(n){if(n.preventDefault(),y=0,E(!1),p.drive.get("blockactions"))return void s.add({message:d.get("allocatedSpaceExceeded"),className:"warning"});if(!e){E(0===g.length);const e=p&&p.drive&&p.drive.get("blockactions")?d.get("allocatedSpaceExceeded"):d.get("permissionUploadForbidden");return s.add({className:"error",message:e})}const i=t.processFiles(n.dataTransfer),o=n.dataTransfer.files.length;i.length>0&&r.dispatchEvent("inodeScrollTableView:onDrop",[g,i]),i.length<o&&(r.dispatchEvent("inodeScrollTableView:onFolderDrop",[p,n.dataTransfer]),E(0===g.length))})}function V(e){e?(b.container.addClassName("loading"),A.show()):(b&&b.container&&b.container.removeClassName("loading"),A&&A.hide())}}}),define("DS/W3DContentApp/Views/InodeDetailView/inodeDetailSocialView",["DS/W3DXComponents/Views/Layout/ScrollView","DS/W3DContentApp/BusEvent","DS/SocialToolbar/SocialToolbar","DS/W3DDrive/widget","DS/W3DContentApp/Utils/Helpers","css!DS/W3DContentApp/W3DContentApp.css"],function(e,t,n,i,o){"use strict";return function(r){let s,a,l=r.model;const c=r.focusComment||!1;let d=!1;s=i.getValue("is3DSpaceWidget")?l._auth.platform.url3DSpace:l._auth.platform.url,s+="/resources";const u={subjectURI:a=(i.getValue("is3DSpaceWidget")?"pid:":"driveid:")+l.id,tenantId:l.drive.get("auth").platformId,enableCommentLike:!0,commentProxyToken:{header:"X-DS-CSRFTOKEN"},serviceURL:s,enableShare:!1,events:{onMediaClick:function(e){e&&"annotation"===e.type&&!d&&(d=!0,setTimeout(()=>{d=!1},800),t.dispatchEvent("socialToolbar:onPreviewAnnotation",[l,e]))}}};if(c){const e=new RegExp(/(driveid:)(.*)(:comment:)(.*)/);let t=decodeURIComponent(o.getQueryHashParameter("content","commentURI"));t=t&&e.test(t)?t:"";let n=decodeURIComponent(o.getQueryHashParameter("content","replyURI"));n=n&&e.test(n)?n:"",u.commentToScrollToAtInit=n?{parentCommentUri:t,commentUri:n}:{commentUri:t}}let p=new n(u),m=new e({className:"w3ddrive socialtoolbar-scroll",useInfiniteScroll:!1,usePullToRefresh:!1,view:p});const f=m.destroy;return m.destroy=function(){f.apply(m,arguments),p=null,l=null,m.container=null},m}}),define("DS/W3DContentApp/Views/InodeDetailView/accessesView",["DS/WebAppsFoundations/Views/CollectionView","DS/W3DContentApp/Views/accessItemView","DS/W3DXComponents/Views/EmptyView","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/W3DContentApp/W3DContentApp.css"],function(e,t,n,i){"use strict";return function(o){var r=o.emptyView&&o.emptyView.icon||"search",s=o.emptyView&&o.emptyView.title||i.noMemberRetreived,a=new e({className:"w3ddrive permissions w3dx tiles fixed relaxed",collection:o.collection,emptyView:new n({icon:r,title:s})});return Object.assign(a,{_buildItemView:function(e){return t({model:e,shareAccessActions:o.shareAccessActions})}})}}),define("DS/W3DContentApp/Views/InodeDetailView/inodeAllAccessesView",["UWA/Class/View","DS/UIKIT/Spinner","DS/W3DXComponents/Views/Layout/ScrollView","DS/W3DContentApp/Views/InodeDetailView/accessesView","DS/W3DContentApp/BusEvent"],function(e,t,n,i,o){"use strict";function r(e){var t=e.container,n=e.elements.spinner;t.classList.add("loading"),n.show()}function s(e,t){var n=t.elements.scrollView,i=t.elements.spinner;e?(n.container.addClassName("loading"),i.show()):setTimeout(function(){n.container.removeClassName("loading"),i.hide()},150)}return function(a){var l=a.model,c=l.permissions,d=new e(a),u=d.destroy;return d.elements.spinner=new t({className:"inode-access__spinner"}),d.elements.scrollView=new n({className:"inode-access__scroll",usePullToRefresh:!1,view:i({collection:c,shareAccessActions:a.shareAccessActions,emptyView:{title:a.emptyView.title,icon:a.emptyView.icon}}),events:{onInfiniteScroll:function(){c.state&&"function"==typeof c.hasNextPage&&c.hasNextPage()?o.dispatchEvent("inodeAllAccessesView:onNextPage",c):d.elements.scrollView.useInfiniteScroll(!1)}}}),d.listenTo(c,{onSync:function(){!function(e){setTimeout(function(){var t=e.container,n=e.elements.spinner;t.classList.remove("loading"),n&&n.hide()},80)}(d)},onReset:function(){r(d)}}),d.elements.scrollView.listenTo(c,{onSync:function(){d.elements.scrollView.endLoading(),s(!1,d),c.state&&d.elements.scrollView.useInfiniteScroll(!0)},onReset:function(){s(!0,d)}}),c.isEmpty()&&r(d),o.dispatchEvent("inodeDetailAccessesView:onAccesses",[l]),Object.assign(d,{render:function(){return d.elements.scrollView.render(),d.container.setContent([d.elements.spinner,d.elements.scrollView]),d},destroy:function(){d.elements.scrollView.stopListening(),d.stopListening(),u.apply(d,arguments)}})}}),define("DS/W3DContentApp/Views/Lightbox/lightboxPreviewBody",["UWA/Class/Promise","DS/3DPlaySupport/AssetSupport","DS/W3DContentApp/Views/Lightbox/lightboxPreviewImg","DS/W3DContentApp/Views/Lightbox/lightboxPreviewVideo","DS/W3DContentApp/Utils/Helpers","DS/UIKIT/Spinner","DS/W3DDrive/widget","css!DS/W3DContentApp/W3DContentApp.css"],function(e,t,n,i,o,r,s){"use strict";let a,l;return{hidePreviewBody:p,init:function(m={}){if(c)return c;var f,g,h=new r({className:"preview-body__spinner"}),v=(f=[h.elements.container],(g=document.createElement("div")).classList.add("preview-body"),function(e,t){return(t=[].concat(t)).reduce(function(e,t){return e.appendChild(t),e},e)}(g,f));return c=Object.assign(v,{refresh:D,toggleInteraction:function(e){return d(v,e)}}),D(m.inode),c;function D(r,d){return h.show(),u(c),p(),r?t.checkSupport(r.get3DPlayOptions().asset,{usage:"preview"},function(t){const m={VIEWER_3DPLAY:"VIEWER_3DPLAY",VIEWER_ODE:"VIEWER_ODE"},f=t=>{if(!t)throw new Error("Missing viewerType attribute");return new e(i=>{switch(t){case m.VIEWER_3DPLAY:i((()=>new e(e=>{require(["DS/W3DContentApp/Views/Lightbox/lightboxPreview3DPlay"],function(t){e(a=t)})}))());break;case m.VIEWER_ODE:i((()=>new e(e=>{require(["DS/W3DContentApp/Components/OfficeDocumentEditor"],function(t){e(l=t)})}))());break;default:i(n)}})};return new e(e=>{const a=r&&r.drive.isCollabSpace;if(a)e(f(m.VIEWER_3DPLAY));else if(d)e(f(m.VIEWER_3DPLAY));else{if(!function(e){const t=document.createElement("video");return!s.getValue("is3DSpaceWidget")&&["probably","maybe"].includes(t.canPlayType("video/"+e))}(r.get("fileExtension")))return r&&r.drive&&r.drive.isDsDrive&&!s.getValue("isStandalone")&&r.drive.get("auth").platform.urlODE&&o.isOfficeDocumentSupported(r.get("fileExtension"))?(p({destroy3DPlayViewer:!0}),void e(f(m.VIEWER_ODE))):void e(t?f(m.VIEWER_3DPLAY):n);e(i)}}).then(e=>{const t=e.init();return function(e,t){if(e.contains(t))return t;t.classList.add("preview-body__adapter"),e.appendChild(t)}(c,t),t.refresh(r)}).then(e=>{u(c,e),h.hide()})}):e.resolve()}},getPreviewOfficeDocument:function(){return l}};var c;function d(e,t){var n=function(e,t){var n=e;return n.classList.contains(t)||(n=n.querySelector("."+t)),n}(e,"preview-body");return t?n.classList.add("preview-body--interactive"):n.classList.remove("preview-body--interactive"),e}function u(e,t){var n=e.querySelectorAll(".preview-body__adapter");return d(e,Array.prototype.map.call(n,function(e){return e===t?(e.classList.add("preview-body__adapter--visible"),!0):(e.classList.remove("preview-body__adapter--visible"),!1)}).reduce(function(e,t){return e||t},!1)),e}function p(e={destroy3DPlayViewer:!1}){a&&e.destroy3DPlayViewer&&a.hide3DPlayViewer(),l&&l.destroy(),i&&i.pauseVideo()}}),define("DS/W3DContentApp/Utils/DSAuth",["UWA/Class","DS/W3DContentApp/Utils/Platform"],function(e,t){"use strict";return e.extend({init:function(e,t){if(t&&t.id!==e)throw new Error("Invalid id in DSAuth");this.platform=t,this.platformId=e},getStorage:function(){return this.platform},getSwymService:function(){if(this.platform)return this.platform.urlSwym},clearIdentity:function(e,t){return this.platform=void 0,e()},hasIdentity:function(e,n){if(this.platform)return e();var i=this;t.getAllPlatforms().then(function(t){t.map(function(e){e.id===i.platformId&&(i.platform=e)}),e()}).catch(n)},authenticate:function(e,t){this.hasIdentity.apply(this,arguments)}})}),define("DS/W3DContentApp/Views/DriveView/driveDetailViewFunc",["UWA/Core","UWA/Class/View","UWA/String","DS/W3DContentApp/Utils/Helpers","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e,t,n,i,o){"use strict";return{toSizeStr:function(e){return e=e||0,i.computeNLSSize(e)},toPercentStr:function(e,t){return n.format("{0} %",t?Math.round(100*e/t):0)},createLegal:function(e){return new Promise(function(t,n){var i=document.createElement("div"),r=document.createElement("h5"),s=document.createElement("div");i.classList.add("legal"),e.getLegalInfo().then(function(e){e&&(r.textContent=o.legalTitle,s.innerHTML=e),i.appendChild(r),i.appendChild(s),t(i)},function(){t(null)})})},createAccountDetailElem:function(t){var n=e.createElement("div",{class:"account-detail"});if(!t||"function"!=typeof t.get)return n;var i=t.get("user"),r="",s="";return i&&(r=i.displayName||"",s=i.emailAddress||""),n.setContent([{tag:"h5",text:o.account},{tag:"div",class:"name",text:r},{tag:"div",class:"email",text:s}]),n},createAccountElem:function(t,n,i){var o=e.createElement("div",{class:"account"});if(!t||"function"!=typeof t.get||"function"!=typeof n)return o;var r=[n(t)];return i&&r.push(i),o.setContent(r),o},createStorageElem:function(t,n,i){var r=e.createElement("div",{class:"storage"});if(!t||"function"!=typeof t.get||"function"!=typeof n||"function"!=typeof i)return r;var s=t.get("quotaBytes"),a=0,l=0;s&&(a=s.used||0,l=parseInt(s.total)||0);var c=[{tag:"span",class:"used",text:n(a)}];return 0!==l&&c.push({tag:"span",class:"total",text:n(l)},{tag:"span",class:"percent",text:i(a,l)}),r.setContent([{tag:"h5",text:o.storage},{tag:"div",html:c}]),r},getRefreshElem:function(e,t,n){return function(){if(!(e&&e.container instanceof window.HTMLElement&&"function"==typeof t))return e;var o=e.container.querySelector(String(n));return o?(i.replaceWith(o,t()),e):e}},getView:function(e,n,i){var o=new t(Object.assign({},e));o.container.addClassName("w3ddrive drive-detail");var r=e.model;if(!r)return o;var s={};return"function"==typeof n&&(s["onChange:user"]=n),"function"==typeof i&&(s["onChange:quotaBytes"]=i),o.listenTo(r,s),o.destroy=function(){o.stopListening(),o.container=null,o.model=null,e=null},o}}}),define("DS/W3DContentApp/Models/Drive",["UWA/Core","UWA/Class/Model","UWA/Class/Promise","UWA/Utils","UWA/String","DS/W3DContentApp/Utils/DSAuth","DS/W3DContentApp/Metas/inode","DS/W3DContentApp/Utils/Alert","DS/W3DContentApp/Utils/Helpers","DS/W3DContentApp/Utils/RequestHelper"],function(e,t,n,i,o,r,s,a,l,c){"use strict";const d=s();function u(e,t){const n=e[t];if(!n)throw new Error("The object has no defined value for "+t);return n}return t.extend({_Inodes:void 0,_Permissions:void 0,_createInodeTable:function(t,n,i){return new(u(this,"_Inodes"))(n||[],e.merge({parentInode:t,auth:this.hasAuth()},i))},fetch:function(e){return(e=e||{}).ajax=c.getRequestMethod(e),this._parent.apply(this,arguments)},_createShareWiths:function(t,n,i){return new(u(this,"_Permissions"))(n||[],e.merge({parentInode:t,auth:this.hasAuth()},i))},_indexInode:function(e,t){let n,i,o,r,s;!(t=t||{}).hasOwnProperty("shouldIndex")||t.shouldIndex;if(void 0===(n=e.id))throw new Error("You can't index an inode with no id");if(e.drive=this,o=(i=this._index)[n]){if(e===o)return o;o.collection,s=o.permissions,r=o.inodeTable}else e.isContainer()&&(r=this._createInodeTable(e,this._lsIndexedInodes(n)),this._onResetInodes(r),r.dotDot=function(){const e=this.dot().collection;return e?e.dot():null},this.listenTo(r,{onAdd:this._indexInode,onReset:this._onResetInodes,"onChange:parentId":this._onChangeParentId}),this.listenTo(e,"onDestroy",this._onDestroyInode),this.listenTo(e,"onChange:"+this.inodeIdAttr,this._onChangeId));return s||(s=this._createShareWiths(e)),e.permissions=s,e.isContainer()?(r.dot=function(){return e},e.inodeTable=r,i[n]=e,e):e},_lsIndexedInodes:function(e){const t=[],n=this._index;let i,o,r;for(i in n)n.hasOwnProperty(i)&&(r=(o=n[i]).get("parentId"))&&r===e&&t.push(o);return t},_onResetInodes:function(e,t){e.forEach(function(e){this._indexInode(e,t)},this)},_onChangeId:function(e,t){const n=e.previous(this.inodeIdAttr);this._index[t]=this.getInode(n),delete this._index[n]},_onChangeParentId:function(e,t){const n=this.getInode(t);let o,r;n&&n.isContainer()&&(o=e.collection,r=n.inodeTable,i.setImmediate(function(){o.remove(e),r.add(e)}))},_onDestroyInode:function(e){let t;this.stopListening(e),e.isContainer()&&(t=e.inodeTable,delete e.inodeTable,this.stopListening(t),delete e.permissions,t.forEach(this._onDestroyInode,this)),delete this._index[e.id]},defaults:{id:"",title:"",iconLink:"",thumbnailLink:"",modified:"",quotaBytes:{total:"",used:""},user:{displayName:"",emailAddress:""},authenticated:void 0,granted:void 0},auth:void 0,init:function(){const e=u(this,"_Inodes").prototype.model;let t;return this._index={},null==(t=e.prototype.idAttribute)&&(t="id"),this.inodeIdAttr=t,this._parent.apply(this,arguments)},hasAuth:function(){return this.get("auth")?this.get("auth"):(this.set({auth:new r(this.id)}),this.get("auth"))},sync:function(e,t,i){let o=i.attrs;const r=this;let s,d;const u=this._parent;let p,m;return i.ajax=c.getRequestMethod(i),o||(o=t.toJSON?t.toJSON():t),d=function(e){return function(){return new n(function(t,n){e.hasIdentity(function(){t(!0)},function(){t(!1)})})}}(s=o.auth||this.hasAuth()),"read"===e?p=d().then(function(e){return Object.assign(o||{},{granted:!0,authenticated:e})}).then(function(o){return o.authenticated&&l.result(t,"url")?o.isDrivesHubProvider?o:new n(function(n,r){u(e,t,Object.assign({},i,{auth:s,onComplete:function(e){["quotaBytes","user"].map(function(e){delete o[e]}),n(Object.assign({},e,o))},onFailure:function(e){a.add({message:e.error?e.error.message:"",className:"error"}),r(e)}}))}):o}):"update"===e&&(p=(m=new n(function(e,i){var s,a=(s=r.get("auth"),function(){return new n(function(e,t){s.authenticate(function(){e.apply(this,arguments)},function(){t.apply(this,arguments)})})}),l=function(e){return function(){return new n(function(t,n){e.clearIdentity(function(){t.apply(this,arguments)},function(){n.apply(this,arguments)})})}}(r.get("auth")),c=o.authenticated;if(void 0===o.authenticated)return e();c?a().then(function(){e.apply(this,arguments)},function(){i.apply(this,arguments)}):l().then(function(){o=Object.assign(t.defaults,{granted:o.granted,authenticated:o.authenticated,id:t.id}),t.isDrivesHubDrive&&(o=Object.assign({},o,t.getDefaultsAttributes())),e.apply(this,arguments)},function(){i.apply(this,arguments)})})).then(function(e){return e&&void 0!==e.email&&(o.user.emailAddress=e.email),o})),p.then(i.onComplete,i.onFailure)},getLegalInfo:function(){return new n(function(e,t){t()})},getInode:function(t,n){let i,o,r,s,a,l=this.inodeIdAttr;if(!t)return null;if(t.hasOwnProperty&&t.hasOwnProperty(l))o=t;else if(e.is(t,"string"))(o={})[l]=t;else if(t.toJSON)o=t.toJSON();else{if(!e.is(t,"object"))return null;(o={})[l]=t}if(!(r=o[l]))return null;if(a=(s=this._index)[r])return a;if(t&&t.containerToSearchIn){const e=Object.keys(s).find(e=>e.toLowerCase()===t.containerToSearchIn.toLowerCase());if(e){const t=s[e].inodeTable.getInode(r);if(t)return t}}else for(let e in s){const t=s[e].inodeTable.getInode(r);if(t)return t}return n&&n.hasOwnProperty("noCreate")&&!0===n.noCreate?null:(a=new(i=u(this,"_Inodes").prototype.model)(o,e.merge({auth:this.hasAuth()})),this._indexInode(a),a)},getTrueRootInode:function(){const e={};return e.mimeType=d.mimeType.folder,e[this.inodeIdAttr]=d.ids.trueRoot,this.getInode(e)},getRootInodes:function(e){const t=this;if(!0===e)return new n(function(e,n){const i=t.getTrueRootInode();i.inodeTable.fetch({onComplete:function(){e(i.inodeTable)},onFailure:n})});return this.getTrueRootInode().inodeTable},getParentInode:function(e,t){const i=this;return new n(function(n,o){var r,s,a=i.getInode(e),l=a.inodeTable.dotDot();return l||a===i.getTrueRootInode()?n(l):void 0!==(r=a.get("parentId"))?((s={mimeType:d.mimeType.folder})[i.inodeIdAttr]=r,(l=i.getInode(s)).inodeTable.add(a),n(l)):t?o():a.fetch({onComplete:function(){i.getParentInode(e,!0).then(n,o)},onFailure:o})})},getInodesPath:function(e,t){const i=this;return function e(t,o){var r,s;return void 0===o&&(o=t,t=void 0),r=i.getInode(o),(s=i.getInode(t))||(s=i.getTrueRootInode()),new n(function(t,n){return r===s?t([s]):i.getParentInode(r).then(e.bind(void 0,s),n).then(function(e=[]){e.push(r),t(e)})})}(e,t).then(function(e){return e.map(function(e){return i._index[e.id]})})},getInodePanelURI:function(e,t={}){return e?o.format("/{0}/{1}/mimetype/{2}/inode/{3}","drives",window.encodeURIComponent(e.drive.id),window.encodeURIComponent(t.containerType?t.containerType:e.get("mimeType")),window.encodeURIComponent(t.containerId?t.containerId:e.id)):"drives"},getInodePanelContentURI:function(e,t={}){return o.format("{0}/content",this.getInodePanelURI(e,t))},getInodePreviewURI:function(e,t={}){return o.format("{0}/{1}/preview",this.getInodePanelContentURI(e.collection.dot(),t),window.encodeURIComponent(e.id))},destroy:function(){this.getTrueRootInode().destroy()}})}),define("DS/W3DContentApp/Models/DriveAbstract",["UWA/Core","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/W3DContentApp/Metas/inode","DS/W3DContentApp/Models/Drive","DS/WebappsUtils/WebappsUtils"],function(e,t,n,i,o){"use strict";const r=n(),s=i.prototype.defaults;return i.extend({_Inodes:void 0,_Permissions:void 0,url:"",defaults:e.merge({title:"3DEXPERIENCE",thumbnailLink:o.getWebappsAssetUrl("W3DDrive","3DDrive_40x30.png"),iconLink:o.getWebappsAssetUrl("W3DDrive","3DDrive_80x60.png"),shareWithinvitation:!1},s),getInodePanelURI:function(e){return!e||""!=e.get("mimeType")&&e.get("mimeType")||e.set("mimeType",r.mimeType.folder),this._parent.apply(this,arguments)},init:function(){const e=this;this._parent.apply(this,arguments),t.getPlatformConfig({key:"share",platformId:e.id,onComplete:function(t){e.set("shareWithinvitation",t)}}),t.getUser({onComplete:function(t){e.set("user",{displayName:t.firstname+" "+t.lastname,emailAddress:t.email,id:t.id})}})}})}),define("DS/W3DContentApp/Views/DriveView/driveDetailView",["UWA/Utils","DS/W3DContentApp/Views/DriveView/driveDetailViewFunc","css!DS/W3DContentApp/W3DContentApp.css"],function(e,t){"use strict";return function(n){var i,o=n.model,r=function(){return t.createAccountElem(o,t.createAccountDetailElem)},s=function(){return t.createStorageElem(o,t.toSizeStr,t.toPercentStr)},a=function(){return t.createLegal(o)};function l(){e.setImmediate(t.getRefreshElem(i,r,".account"))}function c(){e.setImmediate(t.getRefreshElem(i,s,".storage"))}var d=(i=t.getView(n,l,c,function(){e.setImmediate(t.getRefreshElem(i,a,".legal"))})).destroy;return Object.assign(i,{render:function(){return a().then(function(e){i.container.setContent([r(),s(),e])}),i},destroy:function(){return o=null,r=null,a=null,s=null,l=null,c=null,i.stopListening(),d.apply(i,arguments)}})}}),define("DS/W3DContentApp/Views/Lightbox/lightbox",["DS/vue/vue","text!DS/W3DContentApp/Views/Lightbox/Lightbox.html","UWA/Class/Promise","DS/W3DDrive/InodeActions","DS/W3DContentApp/Views/InodeDetailView/inodeDetailView","DS/W3DContentApp/Views/Lightbox/lightboxPreviewBody","DS/W3DContentApp/Views/InodeDetailView/inodeDetailSocialView","DS/W3DContentApp/BusEvent","DS/W3DContentApp/Utils/Helpers","DS/W3DContentApp/Utils/Alert","DS/W3DContentApp/Metas/inode","DS/W3DDrive/widget","DS/W3DContentApp/Utils/Store","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/W3DContentApp/W3DContentApp.css"],function(e,t,n,i,o,r,s,a,l,c,d,u,p,m){"use strict";let f,g,h,v,D,w;const b=d(),C=()=>{if(!w||!w.collection)return!1;return w.collection.filter(e=>!e.isFolder()).length>1};return{init:function(d={}){if(!d.viewSpecs||!d.inode)throw new Error("Missing input");f=d.viewSpecs,w=d.inode;let S=!1;function y(e,t){return new s({model:e,focusComment:!S&&t})}function A(e){const t=["inode-detail-properties","inode-detail-history","inode-detail-accesses","inode-detail-access-link"],n=JSON.parse(JSON.stringify(f));return n.detailViewSpecs.detailViewsList.forEach(e=>{const t=f.detailViewSpecs.detailViewsList.find(t=>t.key===e.key);e.view=t.view}),n.detailViewSpecs.detailViewsList=n.detailViewSpecs.detailViewsList.filter(e=>t.includes(e.key)),new o({model:e,viewSpecs:n.detailViewSpecs})}D=r.init(),w&&!w.drive.isDrivesHubDrive&&(h=y(w)),v=A();const W=function(){const n="vue-lightbox";let o;document.getElementById(n)||((o=document.createElement("div")).id=n,u.getValue("isStandalone")?document.body.prepend(o):document.body.querySelector(".w3ddrive.panel-slider").parentElement.appendChild(o));const s=e=>[{name:"edit-document",fonticon:"pencil",label:m.get("EditDocument"),hidden:!0},{name:"save-document",fonticon:"floppy",label:m.get("Save"),hidden:!0},{name:"comment",fonticon:"comment",label:m.get("Comments"),hidden:!0},{name:"share",fonticon:"share-alt",label:m.get("share"),hidden:!0,handler:()=>{const t=e.availableActions.find(e=>["share","shareContent"].includes(e.name));t&&t.handler()}},{name:"download",fonticon:"download",label:m.get("Download"),hidden:!0,handler:()=>{const t=e.availableActions.find(e=>"download"===e.name);t&&t.handler()}},{name:"information",fonticon:"info",label:m.get("Information")}],d=()=>C()?[{name:"previous",fonticon:"chevron-left",label:m.get("Previous"),disabled:!1},{name:"next",fonticon:"chevron-right",label:m.get("Next"),disabled:!1}]:[];return g=new e({el:"#"+n,template:t,data(){return{show:!0,isWidget:!u.getValue("isStandalone"),title:"",mediaType:"picture",availableActions:[],primaryActions:s(this),sideActions:d(),moreActionsLabel:m.get("More"),closeLabel:m.get("close"),panels:[{name:"comments",title:m.get("Comments"),show:!1,showClose:!0},{name:"information",title:m.get("Information"),show:!1,showClose:!0}],navigation:{previous:null,next:null}}},computed:{menuActions(){return this.availableActions.filter(e=>!this.primaryActions.find(t=>t.name===e.name||"shareContent"===e.name))},isLightboxVisible(){return this.show},isCommentsPanelVisible(){return this.panels.find(e=>"comments"===e.name).show}},methods:{refreshTitle(){this.title=w.get("alias")||w.get("title"),w&&w.drive&&w.drive.isCollabSpace?this.mediaType=w.get("type")&&"Document"===w.get("type").name?"document":"3dmodel":this.mediaType=w?b.mediaType[w.get("fileExtension")]:"picture"},toggleVisibility(e){this.show=void 0!==e?e:!this.show},refreshContent(e){null!=this.navigation[e]&&(a.dispatchEvent("lightbox:onArrowClick",[this.navigation[e]]),this.refreshNavigation())},refreshNavigation(){if(C()){const e=w.collection,t=e.get(w),n=e.indexOf(t),i=e.length>n-1?e.at(n-1):null,o=e.length>n+1?e.at(n+1):null;this.navigation.previous=i&&!i.isFolder()?i.drive.getInodePreviewURI(i):null,this.navigation.next=o&&!o.isFolder()?o.drive.getInodePreviewURI(o):null,this.sideActions[0].disabled=!i||i.isFolder(),this.sideActions[1].disabled=!o||o.isFolder()}},refreshActions(){this.$data.primaryActions=s(this),this.$data.sideActions=d();let e=new i({model:w,context:"lightbox"}).toJSON();const t=["viewInformation","preview","delete","deletefinal","moveTo","openWith","moveToCS","update","removeOwnAccess","openFileLocation","editDocument"];e=e.filter(e=>!t.find(t=>t===e.id));const n=[];e.forEach(e=>{n.push({name:e.id,fonticon:e.fonticon,text:e.text,handler:e.handler})}),w.isPlayable()&&n.push({name:"play-360",fonticon:"media-360",text:m.get("play"),handler:()=>{w.set("forcePlay",!0),a.dispatchEvent("lightbox:onPlay",[w])}}),this.availableActions=n,this.availableActions.find(e=>["share","shareContent"].includes(e.name))&&(this.primaryActions.find(e=>"share"===e.name).hidden=!1),this.availableActions.find(e=>"download"===e.name)&&(this.primaryActions.find(e=>"download"===e.name).hidden=!1),w.getActionIds().includes("comment")&&(this.primaryActions.find(e=>"comment"===e.name).hidden=!1);const o=this.primaryActions.find(e=>"edit-document"===e.name),r=this.primaryActions.find(e=>"save-document"===e.name),c=["edit","edit_share"].includes(w.get("accessright"));p.features.isODEFeatureAvailable&&c&&l.isOfficeDocumentSupported(w.get("fileExtension"))&&(w.editMode?(o.hidden=!0,r.hidden=!1):o.hidden=!1)},toggleInformationPanel(e){const t=this.panels.find(e=>"comments"===e.name),n=this.primaryActions.find(e=>"comment"===e.name);t.show=!1,n.selected=!1;const i=this.panels.find(e=>"information"===e.name),o=this.primaryActions.find(e=>"information"===e.name);"boolean"==typeof e&&e||!i.show?(i.show=!0,o.selected=!0):(i.show=!1,o.selected=!1)},comments(e){const t=this.panels.find(e=>"information"===e.name),n=this.primaryActions.find(e=>"information"===e.name);t.show=!1,n.selected=!1;const i=this.panels.find(e=>"comments"===e.name),o=this.primaryActions.find(e=>"comment"===e.name);"boolean"==typeof e&&e||!i.show?(i.show=!0,o.selected=!0):(i.show=!1,o.selected=!1)},editDocument(){l.isAndroidOrIphone()?c.add({message:m.get("ODdisabledActions"),className:"primary"}):(this.primaryActions.find(e=>"edit-document"===e.name).hidden=!0,this.primaryActions.find(e=>"save-document"===e.name).hidden=!1,r.getPreviewOfficeDocument().launchInEditMode())},saveDocument(){r.getPreviewOfficeDocument().saveDocument()},closeLightbox(){const e=()=>{this.panels.forEach(e=>e.show=!1),this.toggleVisibility(),a.dispatchEvent("lightbox:onCancelClick",[w.drive.getInodePanelContentURI(w.collection?w.collection.dot():null)])};p.features.isODEFeatureAvailable&&l.isOfficeDocumentSupported(w.get("fileExtension"))?r.getPreviewOfficeDocument().closeDocument().then(()=>{e()}):e()},toggleSaveButtonState(e){this.primaryActions.find(e=>"save-document"===e.name).disabled=!e}},mounted(){this.$nextTick(()=>{this.$refs.lightboxContent.appendChild(D),w.drive.isDrivesHubDrive||this.$refs.lightboxCommentsPanel.appendChild(h.container),this.$refs.lightboxInformationPanel.appendChild(v.container)})}}),o}();let I=function(e){return Boolean(e)};return Object.assign(W,{refresh:function(e={}){if(g.toggleVisibility(!0),w=e.inode,!I(w)&&!0!==e.force)return;const t={"onChange:title":()=>{g&&g.isLightboxVisible&&g.refreshTitle()},"onChange:actions":()=>{g&&g.isLightboxVisible&&g.refreshActions()},"onChange:fileExtension":()=>{const e=l.isOfficeDocumentSupported(w.get("fileExtension"));(!e||e&&!w.editMode)&&D.refresh(w)}},i=w.collection,o={onSync:()=>{g.refreshActions(),g.refreshNavigation()}};w.addEvents(t),i&&i.addEvents(o),w.drive.isDrivesHubDrive||function(){(function(e){const t=new n(t=>{requestAnimationFrame(()=>{const n=g.$refs.lightboxCommentsPanel,i=n.firstChild;n&&i&&(n.replaceChild(e.container,i),requestAnimationFrame(()=>{i.destroy()})),t()})}),i=new n(t=>{requestAnimationFrame(()=>{e.render(),t()})});return e.container.classList.add("lightbox__preview-properties"),n.all([t,i])}).apply(this,arguments).then(()=>{})}(h=y(w,e.focusComment)),e&&e.focusComment&&!S&&setTimeout(()=>{g.comments()},500),e.focusComment&&!S&&(S=!0),function(){(function(e){const t=new n(t=>{requestAnimationFrame(()=>{const n=g.$refs.lightboxInformationPanel,i=n.firstChild;n&&i&&(n.replaceChild(e.container,i),requestAnimationFrame(()=>{i.destroy()})),t()})}),i=new n(t=>{requestAnimationFrame(()=>{e.render(),t()})});return e.container.classList.add("lightbox__preview-properties"),n.all([t,i])}).apply(this,arguments).then(()=>{})}(v=A(w)),D.refresh(w),g.refreshTitle(),g.refreshActions(),g.refreshNavigation(),document.addEventListener("enableSaveButton",()=>{g.toggleSaveButtonState(!0)}),document.addEventListener("disableSaveButton",()=>{g.toggleSaveButtonState(!1)})},updatePreviewBody:(e,t)=>{D.refresh(e,t)},hideLightbox:()=>{g.toggleVisibility(!1),r.hidePreviewBody()},isLightboxVisible:()=>g&&g.isLightboxVisible,getCommentsPanel:()=>h,showCommentsPanel:e=>g&&g.comments(e),isCommentsPanelVisible:()=>g&&g.isCommentsPanelVisible,getContainer:()=>g})}}}),define("DS/W3DContentApp/Utils/Actions/drive",["UWA/Class/Events","DS/W3DContentApp/Views/SuperModal","DS/W3DContentApp/Metas/drive","DS/W3DContentApp/Views/DriveView/driveDetailView","DS/W3DContentApp/BusEvent","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e,t,n,i,o,r){"use strict";const s=n();function a(e,t){o.dispatchEvent("driveActions:"+e,t)}return function(n){const o=new e(n),l=n.model,c=[{id:s.actionPubIds.storage,text:r.get("storage"),icon:"database",handler:()=>{const e=i({model:l});e.render(),t.dialog({title:l.get("title"),body:e.container}),a("onStorage",[l])}},{id:s.actionPubIds.disconnect,text:r.get("disconnect"),icon:"box-times",handler:()=>{a("onDisconnect",[l])}}];return Object.assign(o,{toJSON:function(e){return function(e,t){const n=[];return t.forEach(function(t){(function(e,t){return t.isActionIdoK(e.id)})(t,e)&&n.push(t)},this),n}(l,c)}})}}),define("DS/W3DContentApp/Views/InodePanelView/sortView",["DS/W3DContentApp/Utils/Helpers","DS/W3DContentApp/BusEvent","DS/W3DDrive/widget","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/W3DContentApp/W3DContentApp.css"],function(e,t,n,i){"use strict";const o=e.getSortConfiguration();let r;function s(e){return{tag:"span",class:function(e){let t="fonticon fonticon-"+o[e].fonticon;return r===e&&(t+=" selected"),t}(e),events:{click:n=>{const i=n.target||n.srcElement;i.parentElement.parentElement.getElements(".selected").forEach(e=>{e.removeClassName("selected")}),i.parentElement.addClassName("selected"),i.addClassName("selected"),t.dispatchEvent("inodePanelView:onSort",[{id:e,logic:o[e]}])}}}}return function(t={}){const o=t.sortingList||[],a=e.getSortConfiguration()[t.sorting]||{},l=n.getValue("inodesSorting")?n.getValue("inodesSorting").logic:a;r=l.id;const c=l.attributeName,d=[],u=(e,t)=>({tag:"li",class:function(e,t){let n="item";return e===t&&(n+=" selected"),n}(c,e),html:[{tag:"span",class:"item-text",text:t},s(e+"-a"),s(e+"-d")]});return o.includes("title")&&d.push(u("title",i.get("title"))),o.includes("modifiedDate")&&d.push(u("modifiedDate",i.get("modificationDate"))),o.includes("createdDate")&&d.push(u("createdDate",i.get("creationDate"))),o.includes("size")&&d.push(u("size",i.get("Size"))),o.includes("type")&&d.push(u("type",i.get("Type"))),o.includes("creator")&&d.push(u("creator",i.get("Creator"))),{tag:"ul",html:d}}}),define("DS/W3DContentApp/Views/DriveView/driveItemView",["UWA/Utils","DS/W3DContentApp/Utils/Actions/drive","DS/W3DContentApp/Views/itemView","DS/W3DContentApp/BusEvent","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/W3DContentApp/W3DContentApp.css"],function(e,t,n,i,o){"use strict";return function(r={}){if(!r.model)throw new Error("Missing input");const s=r.model;let a,l,c={model:s},d=t({model:s}).toJSON();function u(){const e={id:"id",image:"thumbnailLink",icon:"iconLink",title:"title",metas:function(e){return e.getMeta()}};Object.keys(e).forEach(t=>{const n="function"==typeof e[t]?e[t](s):s.get(e[t]);c[t]=n}),c.actions=d}function p(e,t,n){return e.classList.contains(t)?n||e.classList.remove(t):!1!==n&&e.classList.add(t),e}function m(e){return p(a.container,"expanded",e)}function f(e){return p(a.container,"authenticated",e)}return u(),c.viewConf={noActionsMenu:1===d.length,actionsFonticon:1===d.length?d[0].icon:"cog",actionsIconTooltip:1===d.length?d[0].text:o.get("manageStorage")},a=n(c),l=a.destroy,a.container.addEvent("click",function(e){(e.target||e.srcElement)!==a.container.getElement(".actions")&&(a.dispatchEvent("onClick",[s]),i.dispatchEvent("driveView:onClick",[s]))}),a.listenTo(s,{"onChange:thumbnailLink":function(){e.setImmediate(function(){a.refreshImg()})},"onChange:authenticated":function(){f(s.get("authenticated"))},onChange:function(){u(),e.setImmediate(function(){a.refreshContent()})}}),a.container.addClassName("drive-item w3dx tile half fixed relaxed"),f(s.get("authenticated")),a.options=Object.assign(a.options,{dropdownRenderTo:document.body}),Object.assign(a,{toggleExpand:m,expand:function(){return m(!0)},collapse:function(){return m(!1)},destroy:function(){return d=null,c=null,a.model=null,a.stopListening(),l.apply(a,arguments)}})}}),define("DS/W3DContentApp/Views/InodePanelView/inodeTopBarViewFunc",["UWA/Core","UWA/Class/View","UWA/Utils/Client","DS/W3DDrive/InodeActions","DS/W3DContentApp/Views/InodePanelView/inodeTableViewFunc","DS/W3DContentApp/Views/InodePanelView/sortView","DS/W3DContentApp/Utils/Helpers","DS/W3DDrive/widget","DS/W3DContentApp/Utils/Store","DS/W3DContentApp/Utils/Alert","DS/UIKIT/Iconbar","DS/UIKIT/Input/Button","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],function(e,t,n,i,o,r,s,a,l,c,d,u,p){"use strict";function m(e){var t=(e=e||{}).target,n=e.uri;if(t=t.querySelector('.breadcrumb__elem-title[href="'+n+'"]'))return t.parentNode}function f(t={}){let n=t.target;const i=t.opts;if(n&&i&&(n.classList.contains("breadcrumb")||(n=n.querySelector(".breadcrumb")))){for(;n.lastElementChild;)n.removeChild(n.lastElementChild);Object.keys(i).map(e=>({uri:e,elem:m({target:n,uri:e}),...i[e]})).map(t=>(function(t){var n=(t=t||{}).uri,i=t.title,o=Boolean(t.shared);const r=e.createElement("div",{class:"breadcrumb__elem"});return[e.createElement("div",{class:"breadcrumb__elem-divider fonticon"}),e.createElement("div",{class:o?"breadcrumb__elem-icon fonticon breadcrumb__elem-icon_share":"breadcrumb__elem-icon fonticon"}),e.createElement("a",{class:"breadcrumb__elem-title",href:n,draggable:!1,text:i,target:"_blank"}),e.createElement("div",{class:"breadcrumb__elem-icon fonticon breadcrumb__elem-open-down hidden"})].reduce(function(e,t){return t&&e.appendChild(t),e},r)})(t)).reverse().reduce((e,t)=>(e.appendChild(t),e),n)}}function g(e,t,n){n=n||{};var i=e.querySelector(t);return i.firstChild&&i.removeChild(i.firstChild),n.iconbarElem&&i.appendChild(n.iconbarElem),e}function h(e,t){var n;e&&(n=e.querySelector?e.querySelector(".iconbar__item--info"):e.elements.container.querySelector(".iconbar__item--info"))&&(t?n.classList.add("item-info--opened"):n.classList.remove("item-info--opened"))}return{getBreadcrumbElem:m,refreshBreadcrumbElem:function(e){const t=(e=e||{}).target;if(t&&e.title){const n=t.querySelector(".breadcrumb__elem-title");n&&(n.textContent=e.title)}if(t&&void 0!==e.shared){const n=t.querySelector(".breadcrumb__elem-icon");n&&(e.shared?n.classList.add("breadcrumb__elem-icon_share"):n.classList.contains("breadcrumb__elem-icon_share")&&n.classList.remove("breadcrumb__elem-icon_share"))}return e},refreshBreadcrumb:f,createBreadcrumb:function(t={}){const n=e.createElement("div",{class:"breadcrumb"});return f({target:n,opts:t.opts}),n},getIconBarContainer:function(e){const t=document.createElement("div");return t.classList.add("top-bar__iconbar-container"),e&&t.appendChild(e),t},refreshIconBarContainer:function(e,t){return g(e,".top-bar__iconbar-container",t)},getFixedIconBarContainer:function(e){const t=document.createElement("div");return t.classList.add("top-bar__iconbar-container--fixed"),e&&t.appendChild(e),t},refreshFixedIconBarContainer:function(e,t){return g(e,".top-bar__iconbar-container--fixed",t)},getIconbarItems:function(e){if(!e)return[];Array.isArray(e)||(e=[].concat(e));const t=["openWith","viewInformation"];return e.filter(function(e){return e&&-1===t.indexOf(e.id)}).map(function(e){return Object.assign({index:1},e)}).reverse()},createIconbar:function(e){return new d({className:"top-bar__iconbar",items:[].concat(e),tooltipsPosition:"bottom"})},createFixedIconbar:function(e,t){const n=!t||t.canMultiselect||void 0===t.canMultiselect,i=!t||t.canChangeLayout||void 0===t.canChangeLayout,l=!t||t.canSort||void 0===t.canSort,c=t&&t.defaultLayout;let u=[{className:"divider"}];const m=(e,t)=>{let n=e.target;(n=n.classList.contains("fonticon")?n.parentElement:n).classList.toggle("item--active",t)};if(n&&(u=u.concat([{text:p.multiSelection,fonticon:"select-on",className:"iconbar__item--select-on"},{fonticon:"open-down",className:"iconbar__item--select-on-option",innerComponent:{type:"dropdownmenu",options:{className:"item-select-on__dropdown",items:[{text:p.selectAll,fonticon:"select-all",className:"dropdown__item--select-all",handler:function(){}},{text:p.unselectAll,fonticon:"select-none",className:"dropdown__item--select-none",handler:function(){}}]}}}])),i){const e=c||a.getValue("inodeTableLayoutKey")||"listLayout",t={listLayout:"view-list",thumbnailsLayout:"view-small-thb",tilesLayout:"view-small-tile"};u.push({fonticon:t[e],text:p.get("View"),className:"iconbar__item--layout",content:{type:"dropdownmenu",options:{items:[{fonticon:"view-list",text:p.get("ListView"),selectable:!0,selected:e===o.listLayoutKey,handler:function(){a.dispatchEvent("onUpdateInodeTableLayoutKey",o.listLayoutKey)}},{fonticon:"view-small-thb",text:p.get("ThumbnailsView"),selectable:!0,selected:e===o.thumbnailsLayoutKey,handler:function(){a.dispatchEvent("onUpdateInodeTableLayoutKey",o.thumbnailsLayoutKey)}},{fonticon:"view-small-tile",text:p.get("TilesView"),selectable:!0,selected:e===o.tilesLayoutKey,handler:function(){a.dispatchEvent("onUpdateInodeTableLayoutKey",o.tilesLayoutKey)}}],events:{onClick:function(e,t){this.options.target.children[0].className=t.elements.icon.className,this.options.target.classList.toggle("item--active",!1)},onClickOutside:function(){this.options.target.classList.toggle("item--active",!1)}}}},handler:function(e){m(e,!0)}})}if(l){const t=s.getSortConfiguration()[e.sorting]||{},n=a.getValue("inodesSorting")?a.getValue("inodesSorting").logic:t;u.push({text:p.get("sort"),fonticon:n.fonticon,className:"iconbar__item--sort",content:{type:"dropdown",options:{className:"sort-dropdown-menu",body:r({sortingList:e.sortingList,sorting:e.sorting}),events:{onClick:function(e){const t=e.target||e.srcElement;t&&t.classList.contains("fonticon")&&this.options.target.children[0].classList.replace(this.options.target.children[0].classList[1],t.classList[1])},onClickOutside:function(){this.options.target.classList.toggle("item--active",!1)}}}},handler:function(e){m(e,!0)}})}const f=new d({className:"top-bar__iconbar top-bar__iconbar--fixed",items:u.concat([{text:p.get("Information"),fonticon:"info",className:"iconbar__item--info",handler:function(){a.dispatchEvent("onToggleInodePanelSideBarVisibility")}}]),tooltipsPosition:"bottom"});return h(f,a.getBool("isInodePanelSideBarOpened")),f},getView:function(e){var n=new t(e);return n.container.classList.add("top-bar"),n},updateIconbarInfoColor:h,wrapActionBar:function(){var e=document.createElement("div");return e.classList.add("inode-panel__action-bar"),e},createNewButtonContainer:function(){return e.createElement("div",{class:"top-bar__new-btn"})},refreshNewButtonContainer:function(e){const t=e.target.querySelector(".top-bar__new-btn"),o=e.model;let r;t.querySelector("button")&&t.querySelector("button").parentElement.removeChild(t.querySelector("button"));const d=new i({model:o,context:"topbar"}).toJSON();if(0===d.length)return;const m=d.find(e=>"upload"===e.id),f=d.find(e=>"createFolder"===e.id),g=d.find(e=>"uploadFolder"===e.id),h=d.find(e=>"createCollabSpace"===e.id);if(m||f||g||h){if(a.getValue("is3DSpaceWidget"))h&&(r=new u({value:p.newCollabSpace,icon:"plus",className:"primary btn-sm",events:{onClick:function(){h.handler()}}}));else{const e=[];f&&e.push({name:"newfolder",text:f.text,fonticon:f.fonticon,handler:f.handler}),m&&e.push({name:"addcontent",text:m.text,fonticon:m.fonticon,handler:m.handler});const t=n.Platform.ios||n.Platform.android||n.Platform.ipad||n.Platform.tablet;g&&!t&&e.push({name:"uploadfolder",text:g.text,fonticon:g.fonticon,handler:g.handler}),r=new u({value:p.get("new"),icon:"plus",className:"primary btn-sm",dropdown:{items:e},events:{onClick:function(){var e=this.elements.container.parentElement.getBoundingClientRect();this.dropdown.options.altPosition={x:e.x,y:e.bottom}}}}),l.features.isODEFeatureAvailable&&!o.drive.get("blockactions")&&require(["DS/W3DContentApp/Components/OfficeDocumentEditor"],function(t){const n=e=>{s.isAndroidOrIphone()?c.add({message:p.get("ODdisabledActions"),className:"primary"}):t.createDocument(o,e)};e.push({className:"divider"}),e.push({text:p.get("CreateDocument"),fonticon:"doc-word",handler:function(){n("docx")}}),e.push({text:p.get("CreatePresentation"),fonticon:"doc-powerpoint",handler:function(){n("pptx")}}),e.push({text:p.get("CreateSpreadsheet"),fonticon:"doc-excel",handler:function(){n("xlsx")}}),r.setDropdown({items:e},!1)})}r.inject(t)}},refreshNewButtonState:function(e,t){e.querySelector(".top-bar__new-btn").classList.toggle("hidden",!t)}}}),define("DS/W3DContentApp/Views/DriveView/driveView",["DS/W3DContentApp/Views/DriveView/driveItemView","DS/W3DContentApp/Views/DriveView/driveTreeViewWithDocument","DS/W3DContentApp/Views/DriveView/driveViewPattern","DS/W3DContentApp/BusEvent"],function(e,t,n,i){"use strict";return function(o){var r=o.model,s=e({model:r}),a=t(o),l=n({model:r,header:s,authenticatedBody:a}),c=a.getXSO();return c.onAdd(function(){var e=c.get().filter(function(e){return e.isSelectionChangeFromUI()});e.length&&i.dispatchEvent("driveView:onNodeClick",e.map(function(e){return e.inode}))}),Object.assign(l,{refreshSelected:s.refreshSelected,expandInodesPath:a.expandInodesPath,toggleExpand:s.toggleExpand,expand:s.expand,collapse:s.collapse})}}),define("DS/W3DContentApp/Views/InodePanelView/inodeTopBarView",["DS/W3DDrive/InodeActions","DS/W3DContentApp/Utils/stopPropagationDropdownMenu","DS/W3DContentApp/Views/InodePanelView/inodeTopBarViewFunc","DS/W3DContentApp/Utils/Helpers","DS/W3DDrive/widget","UWA/Utils/Client","DS/W3DContentApp/BusEvent","css!DS/W3DContentApp/W3DContentApp.css"],function(e,t,n,i,o,r,s){"use strict";return function(a){let l=a.model,c=l.drive;const d=a.viewSpecs;let u;const p=n.getView(a),m=p.destroy;let f=!1;p.elements.fixediconbar=n.createFixedIconbar(d,l.configuration),p.elements.actionBarWrapper=n.wrapActionBar();const g={"onChange:shared":function(e,t){v(e,{shared:t})},"onChange:title":function(e,t){v(e,{title:t})},"onChange:alias":function(e,t){v(e,{title:t})},"onChange:actions":function(i,o){(n=>{if(n){p.elements.dropdown&&(p.elements.dropdown.destroy(),p.elements.dropdown=null,delete p.elements.dropdown);const n=p.container.querySelector(".breadcrumb__elem-open-down"),i=new e({model:l,context:"topbar"}).toJSON();i.length&&n&&(n.classList.toggle("hidden",!1),p.elements.dropdown=new t({target:n,items:i}))}})(o),n.refreshNewButtonContainer({target:p.elements.actionBarWrapper,model:i})},"onChange:parentId":function(){setTimeout(function(){b()},1e3)}},h={onSync:function(e){const t=e._parentInode?e._parentInode:e.collection._parentInode;n.refreshNewButtonContainer({target:p.elements.actionBarWrapper,model:t})},onRemove:function(e){const t=e.collection._parentInode;n.refreshNewButtonContainer({target:p.elements.actionBarWrapper,model:t})}};function v(e,t){var i=c[e.isContainer()?"getInodePanelContentURI":"getInodePreviewURI"](e);n.refreshBreadcrumbElem(Object.assign({target:n.getBreadcrumbElem({target:p.container,uri:i})},t)),D()}function D(){function e(){const e=p.elements.iconbar;e&&e.resize()}window.requestAnimationFrame?u=requestAnimationFrame(e):setTimeout(e)}function w(e){n.updateIconbarInfoColor(p.elements.actionBarWrapper.querySelector(".top-bar__iconbar-container--fixed"),e)}function b(){if(p.stopListening(),p.stopListening(l),p.stopListening(l,g),p.stopListening(c),p.listenTo(l,g),p.listenTo(l.inodeTable,h),p.listenTo(s,{driveFeaturesList:function(e){n.refreshNewButtonContainer({target:p.elements.actionBarWrapper,model:e})}}),setTimeout(function(){f&&i.listenToHierarchy(p,l,g)},1e3),f)for(;p.container.firstChild;)p.container.removeChild(p.container.firstChild);const o=l.isContainer()?l:l.collection.dot();return c.getInodesPath(o.id).then(function(i){const o=new e({model:l,context:"topbar"}).toJSON(),s=o.map(function(e){return e.id}).indexOf("uploadFolder"),a=r.Platform.ios||r.Platform.android||r.Platform.ipad||r.Platform.tablet;-1!==s&&a&&o.splice(s,1),i.shift();var d=i.reduce(function(e,t,n){var r=c.getInodePanelContentURI(t),s=n===i.length-1;return e[r]={title:t.get("alias")||t.get("title"),withOpenDown:s&&o.length>0,shared:t.get("shared")},e},{});n.refreshNewButtonContainer({target:p.elements.actionBarWrapper,model:l}),n.refreshBreadcrumb({target:p.container,opts:d});const u=p.container.querySelector(".breadcrumb__elem-open-down");o.length&&u&&(u.classList.toggle("hidden",!1),p.elements.dropdown=new t({target:u,items:o})),n.refreshFixedIconBarContainer(p.container,{iconbarElem:p.elements.fixediconbar&&p.elements.fixediconbar.elements.container}),D()}),[n.createNewButtonContainer(),n.getIconBarContainer(),n.getFixedIconBarContainer()].reduce(function(e,t){return e.appendChild(t),e},p.elements.actionBarWrapper),[n.createBreadcrumb(),p.elements.actionBarWrapper].reduce(function(e,t){return e.appendChild(t),e},p.container),f=!0,p}return p.delegateDOMEvents({"click .breadcrumb__elem-title":function(e){e.preventDefault()}}),o.addEvent("onInodePanelSideBarVisibilityToggled",w),Object.assign(p,{refreshIconBarActions:function(e){let t,i;e=[].concat(e),p.elements.iconbar&&(p.elements.iconbar.destroy(),p.elements.iconbar=null,delete p.elements.iconbar),i=p.elements.fixediconbar=n.createFixedIconbar(d,l.configuration),n.refreshFixedIconBarContainer(p.container,{iconbarElem:i&&i.elements.container}),e.length&&(t=p.elements.iconbar=n.createIconbar(n.getIconbarItems(e))),t&&n.refreshIconBarContainer(p.container,{iconbarElem:t&&t.elements.container})},toggleNewButtonState:function(e){n.refreshNewButtonState(p.elements.actionBarWrapper,e)},render:b,destroy:function(){u&&window.cancelAnimationFrame(u),u=null,this.stopListening(),this.undelegateDOMEvents(),f=!1,p.elements.actionBarWrapper.parentNode&&p.elements.actionBarWrapper.parentNode.removeChild(p.elements.actionBarWrapper),delete p.elements.actionBarWrapper,m.apply(p,arguments),this.elements=null,this.model=null,a=null,c=null,l=null,this.container=null,o.removeEvent("onInodePanelSideBarVisibilityToggled",w)}})}}),define("DS/W3DContentApp/Views/DrivesPanelView/drivesView",["DS/WebAppsFoundations/Views/CollectionView","DS/W3DContentApp/Views/setOfSelectedItemView","DS/W3DContentApp/Views/DriveView/driveView","DS/W3DContentApp/BusEvent","css!DS/W3DContentApp/W3DContentApp.css"],function(e,t,n,i){"use strict";return function(o){const r=o.collection,s=new e({className:"w3ddrive drives",collection:r,filterer:function(e){return e.get("granted")}}),a=t();function l(){s.children.forEach(e=>{e.collapse()}),a.forEach(e=>{e.expand()})}return s.listenTo(r,"onChange:granted",s.filter),s.listenTo(r,"onChange:authenticated",function(e){const t=s.findChildViewByModel(e);a.contains(t)&&!e.get("authenticated")&&a.remove(t)}),s.listenTo(a,{onAdd:l,onReset:l,onRemove:l}),s.listenTo(i,"driveView:onClick",function(e){const t=s.findChildViewByModel(e);a.contains(t)?t.toggleExpand():i.dispatchEvent("drivesView:onWannaChangeSelection",[e])}),Object.assign(s,{_buildItemView:function(e){return n({model:e})},selectedChildren:a})}}),define("DS/W3DContentApp/Views/InodePanelView/inodePanelViewFunc",["UWA/Class/View","DS/W3DContentApp/Views/InodeDetailView/inodeDetailView","DS/W3DContentApp/Views/InodePanelView/inodeTableScrollView","DS/W3DContentApp/Views/InodePanelView/inodeTopBarView","DS/W3DDrive/widget"],function(e,t,n,i,o){"use strict";var r=Object.freeze({multiSelection:"inode-panel--multi-select-active",ctrlSelection:"inode-panel--ctrl-select-active",shiftSelection:"inode-panel--shift-select-active",item:"inode-item",focusedItem:"inode-item--focused",selectedItem:"selected"});function s(e,t,n){if(!e||!t)throw new Error("you must specify valid classList and className");return e.contains(t)?!n&&(e.remove(t),!0):!1!==n&&(e.add(t),!0)}function a(e){return!(!e||!e.classList)&&e.classList.contains(r.multiSelection)}function l(e){return!(!e||!e.classList)&&e.classList.contains(r.ctrlSelection)}function c(e){return!(!e||!e.classList)&&e.classList.contains(r.shiftSelection)}function d(e){if(!e)return[];var t=r.selectedItem;return Array.prototype.slice.call(e.querySelectorAll("."+t))}function u(e,t){if(e&&e.dataset&&t&&t.get)return t.get(e.dataset.model_cid)}function p(e){if(!e||!e.classList)throw new Error("you must specify a valid elem");return e.classList.contains(r.selectedItem)}function m(e,t){if(!e||!e.classList)throw new Error("you must specify a valid elem");return s(e.classList,r.selectedItem,t)}function f(e){if(!e||!e.classList)throw new Error("you must specify a valid target");var t,n=e.parentElement;n&&(t=n.querySelector("."+r.focusedItem)),e.classList.add(r.focusedItem),t&&t!==e&&t.classList.remove(r.focusedItem)}function g(e){if(!e)return[];var t=r.item;return Array.prototype.map.call(e.querySelectorAll("."+t),function(e){return m(e,!1)&&e})}return{isMultiSelectionModeActive:a,isShifSelectionModeActive:c,toggleCtrlSelectionMode:function(e,t){if(!e||!e.classList)throw new Error("you must specify a valid target");return s(e.classList,r.ctrlSelection,t)},isCtrlSelectionModeActive:l,toggleMultiSelectionMode:function(e,t){if(!e||!e.classList)throw new Error("you must specify a valid target");return s(e.classList,r.multiSelection,t)},toggleShiftSelectionMode:function(e,t){if(!e||!e.classList)throw new Error("you must specify a valid target");return s(e.classList,r.shiftSelection,t)},isElemSelected:p,getSelectedOf:d,getFirstSelectedOf:function(e){if(e)return e.querySelector("."+r.selectedItem)},getModelOf:u,getElemOf:function(e,t){if(t&&e)return e.querySelector("."+r.item+'[data-model_cid="'+t.cid+'"]')},getSelectedModelsOf:function(e,t){return d(e).map(function(e){return u(e,t)}).filter(function(e){return Boolean(e)})},selectAll:function(e){return e?Array.prototype.filter.call(e.querySelectorAll("."+r.item),function(e){return e.offsetParent}).map(function(e){return m(e,!0)&&e}):[]},unSelectAll:g,selectAmongItems:function(e,t,n){if(e){if(!c(t))return a(t)||l(t)?(m(e,n),void f(e)):void function(e,t){if(e){var n=e.parentElement,i=p(e),o=[];n&&(o=g(n).filter(function(e){return e})),m(e,o.length>1||!i||Boolean(t)),f(e)}}(e,n);!function(e){if(e){var t=e.parentElement;if(t){var n=t.querySelector("."+r.focusedItem),i=Array.prototype.slice.call(t.querySelectorAll("."+r.item)),o=i.indexOf(n),s=i.indexOf(e),a=Math.min(o,s),l=Math.max(o,s);for(g(t);a<=l;)m(i[a],!0),a+=1}}}(e)}},createTopBar:function(e,t){var n=i({model:e,viewSpecs:t});return n.container.classList.add("inode-panel__top-bar"),n},createDetail:function(e,n){var i=t({model:e,headerOptions:{onClickCloseIcon:function(){o.dispatchEvent("onToggleInodePanelSideBarVisibility")}},viewSpecs:n});return i.container.classList.add("inode-panel__detail"),i},refreshDetailWithView:function(e,t,n){if(e.classList.contains("inode-panel__detail")||(e=e.querySelector(".inode-panel__detail")),e&&e!==t.container){var i=e.parentNode;return i.removeChild(e),i.appendChild(t.container),t.render(),n.refreshInnerDrawer(),t}},createContent:function(e,t){var i=n({inode:e,viewSpecs:t});return i.container.classList.add("inode-panel__content"),i},wrapSideBar:function(e){var t=document.createElement("div");return t.classList.add("inode-panel__side-bar"),e&&t.appendChild(e),t},getView:function(t){return new e(Object.assign({className:"inode-panel w3ddrive",attributes:{cid:t.model.cid}},t))},refreshSideBar:function(e,t,n,i){var o=n?293:0;t[i?"translateNoAnim":"translateAnim"](o),e.style["margin-right"]=o+"px"}}}),define("DS/W3DContentApp/Views/DrivesPanelView/drivesScrollView",["DS/W3DContentApp/Views/DrivesPanelView/drivesView","DS/W3DXComponents/Views/Layout/ScrollView","css!DS/W3DContentApp/W3DContentApp.css"],function(e,t){"use strict";return function(n){var i=n.collection,o=e({collection:i}),r=new t({className:"w3ddrive drives-scroll",useInfiniteScroll:!1,usePullToRefresh:!1,view:o});return Object.assign(r,{selectedChildren:o.selectedChildren,children:o.children,findChildViewByModel:o.findChildViewByModel})}}),define("DS/W3DContentApp/Views/InodePanelView/inodePanelView",["UWA/Utils","UWA/Core","DS/W3DDrive/InodeActions","DS/W3DDrive/inodesActions","DS/W3DDrive/Utils/CompassHelpers","DS/W3DContentApp/Utils/drawerOrchestrator","DS/W3DContentApp/Utils/getKeyboardeventKey","DS/W3DContentApp/Views/InodePanelView/inodePanelViewFunc","DS/W3DContentApp/BusEvent","DS/W3DContentApp/SearchProxy","DS/W3DContentApp/Utils/Tagger6WProxy","DS/W3DDrive/widget","css!DS/W3DContentApp/W3DContentApp.css"],function(e,t,n,i,o,r,s,a,l,c,d,u){"use strict";const p=500,m=560,f="inode-panel__content--responsive",g="side-bar--responsive",h="action-bar--responsive";function v(e){return a.toggleMultiSelectionMode(document.querySelector(".inode-panel"),e)}function D(e){return a.toggleCtrlSelectionMode(document.querySelector(".inode-panel"),e)}function w(e){return a.toggleShiftSelectionMode(document.querySelector(".inode-panel"),e)}function b(){return a.selectAll(document.querySelector(".inode-table"))}function C(){return a.unSelectAll(document.querySelector(".inode-table"))}function S(e,t){return a.selectAmongItems(e,document.querySelector(".inode-panel"),t)}function y(){a.getSelectedOf(document.querySelector(".inode-table")).length>1?v(!0):v(!1)}function A(e){"Control"===s(e)?(D(),y(),document.removeEventListener("keyup",A),document.removeEventListener("keydown",I)):document.addEventListener("keydown",I)}function W(e){"Shift"===s(e)&&(w(!1),y(),document.removeEventListener("keyup",W))}function I(e){const t=s(e);var n;"Control"===t||(n=document.activeElement.nodeName,["input","textarea"].some(e=>n.toLowerCase()===e))||(document.removeEventListener("keydown",I),"a"===t.toLowerCase()&&(document.querySelector(".inode-panel").addClassName("multi-select--select-all"),b(),l.dispatchEvent("inodePanelView:CtrlA"),e.preventDefault()))}function E(e){if(document.querySelector(".modal"))return;document.removeEventListener("keydown",E);const t=s(e);"Control"===t&&(D(!0),document.addEventListener("keyup",A),document.addEventListener("keydown",I)),"Shift"===t&&(w(!0),document.addEventListener("keyup",W))}function x(){document.addEventListener("keydown",E)}return(e=>{let t,n;document.body.addEventListener("click",i=>{const o=i.target;if(o)return o&&o.parentElement&&o.parentElement.classList.contains("inode-item")&&o.classList.contains("item__selection_icon")?(a.isElemSelected(o.parentElement)||v(!0),void S(o.parentElement)):o&&o.classList.contains("inode-item")&&t!==o?(clearTimeout(n),t=o,n=setTimeout(()=>{t=null},e+10),void S(o)):o.classList.contains("breadcrumb__elem-title")?(l.dispatchEvent("inodePanelView:onPathClick",[o.getAttribute("href")]),void i.preventDefault()):void((o.classList.contains("iconbar__item--select-on")||o.parentElement&&o.parentElement.classList.contains("iconbar__item--select-on"))&&(document.querySelector(".inode-panel").removeClassName("multi-select--select-all"),v(),l.dispatchEvent("inodePanelView:ontoggleMultiSelectionMode")))})})(p),function(s){if(!s||!s.viewSpecs||!s.model)throw new Error("Missing input");const D=s.model,w=D.inodeTable,y=s.viewSpecs,A=a.getView(s),W=A.destroy;let I,V,T,_=!1;A.elements.topBarView=a.createTopBar(D,y),A.elements.detailView=a.createDetail(D,y.detailViewSpecs),A.elements.contentView=a.createContent(D,y),A.elements.detailViewWrapper=a.wrapSideBar(A.elements.detailView.container);const L=D&&D.configuration;let P,U,O;(!L||L.canMultiselect||void 0===L.canMultiselect)&&(document.addEventListener("keyup",x),document.addEventListener("keydown",E));const N=y.contentViewSpecs;if(N&&N.quotaExceededView){const e=N.quotaExceededView;O=new e({inode:D,container:A.container,contentView:A})}function k(e){const t=A.elements&&A.elements.topBarView;if(!t)return null;e||(e=a.getSelectedModelsOf(document.querySelector(".inode-table"),w));const o=1===e.length?new n({model:e[0],context:"topbar"}).toJSON():i.getActionsJSON(e);return t.refreshIconBarActions(o)}function M(t,o={}){const r=document.querySelector(".inode-table");let s;s=t&&a.isElemSelected(t)?t:a.getFirstSelectedOf(r),s=a.getModelOf(s,w)||D;const c=a.getSelectedModelsOf(r,w);if(function(e){const t=A.elements&&A.elements.topBarView;t&&t.toggleNewButtonState(e)}(!c.length>0),e.setImmediate(()=>{k(c)}),e.setImmediate(()=>{u.getValue("isInodePanelSideBarOpened")&&function(t){const n=A.elements&&A.elements.detailView;n&&e.setImmediate(()=>{n.destroy()}),A.elements.detailView=a.createDetail(t,y.detailViewSpecs),a.refreshDetailWithView(A.container,A.elements.detailView,I)}(s)}),(o.previousSelectedModels||[]).forEach(e=>{e.dispatchEvent("inodeItemView:toggleActionsElemVisibility",e.get("actions")&&e.get("actions").length>0)}),t){const e=a.getModelOf(t,w);e.dispatchEvent("inodeItemView:toggleActionsElemVisibility",e.get("actions")&&e.get("actions").length>0)}const d=1===c.length?new n({model:c[0],context:"item-view"}).toJSON():i.getActionsJSON(c);c.forEach(e=>{e.dispatchEvent("inodeItemView:toggleActionsElemVisibility",d.length>0)}),l.dispatchEvent("inodePaneView:onChangeSelection",[s,c])}function F(){const e=a.getSelectedModelsOf(document.querySelector(".inode-table"),w);C(),M(null,{previousSelectedModels:e})}function R(e){const t=e.target;if(t&&t.parentElement&&t.parentElement.classList.contains("list__header")&&t.classList.contains("item__selection_icon")){const e=a.getSelectedModelsOf(document.querySelector(".inode-table"),w);return v(!0),A.container.toggleClassName("multi-select--select-all"),A.container.hasClassName("multi-select--select-all")?b():C(),void M(null,{previousSelectedModels:e})}return t.classList.contains("inode-item")?(T=t,clearTimeout(U),P===t?(P=null,void l.dispatchEvent("inodeView:onDblClick",[a.getModelOf(t,w)])):(P=t,U=setTimeout(()=>{P=null},p),void M(t))):t.classList.contains("item__selection_icon")?(T=t.parentElement,void M(t.parentElement)):t.classList.contains("dropdown__item--select-all")||t.parentElement&&t.parentElement.classList.contains("dropdown__item--select-all")?(b(),v(!0),M(),void A.container.addClassName("multi-select--select-all")):void((t.classList.contains("dropdown__item--select-none")||t.parentElement&&t.parentElement.classList.contains("dropdown__item--select-none"))&&(F(),A.container.removeClassName("multi-select--select-all")))}function B(){const e=A.elements.contentView;F(),e.view.filter()}function j(e){const t=document.querySelector(".inode-table");return a.getElemOf(t,e)}function q(e,t=!0){const n=j(e);S(n,t),M(n)}return Object.assign(A,{render:function(){if(_)for(;A.container.firstChild;)A.container.removeChild(A.container.firstChild);else document.addEventListener("click",R),A.listenTo(w,{onRemove:e=>{const t=j(e);t&&!a.isElemSelected(t)||M()},onReset:()=>{M()},"onChange:actions":()=>{k(a.getSelectedModelsOf(document.querySelector(".inode-table"),w))}}),A.listenTo(l,{"inodePanelView:CtrlA":()=>{M()},"inodePanelView:ontoggleMultiSelectionMode":()=>{a.isMultiSelectionModeActive(document.querySelector(".inode-panel"))||F()},"inodePanelView:selectItemAmongItems":function(e,t={}){const n=Boolean(t.selectItemIfNoItemsSelected),i=Boolean(t.unselectAllItemsBefore),o=Boolean(t.scrollToItem),r=a.getSelectedModelsOf(document.querySelector(".inode-table"),w);if(i&&F(),n&&0===r.length||!n){q(e);const t=j(e);o&&t&&t.scrollIntoView({block:"nearest"})}}}),A.listenTo(u,{onInodePanelSideBarVisibilityToggled:e=>{a.refreshSideBar(A.elements.contentView.container,I,e),e&&T&&M(T)}}),A.listenTo(d,{onFilterSubjectsChange:()=>{B()}}),A.listenTo(c,{onSetQuery:e=>{B(),"true"!==u.getValue("is3DSpaceWidget")&&d.updateSubjectsTags(),"function"==typeof w.onSearch&&w.onSearch(e)},onResetQuery:()=>{B(),d.setSubjectsTagsWithInode(w),"function"==typeof w.onSearch&&w.onSearch()}});const e=A.elements.topBarView,n=A.elements.contentView,i=A.elements.detailView,s=A.elements.detailViewWrapper;return[e.container,n.container,s].forEach(e=>{A.container.appendChild(e)}),A.container.addEvent("dragstart",e=>{const n=document.querySelector(".inode-table");let i=[],r=[];i=a.getSelectedOf(n,w),r=a.getSelectedModelsOf(n,w);const s=document.querySelector(".w3ddrive.item:hover"),l=a.getModelOf(s,w);if(l&&!r.includes(l)&&(r.push(l),i.push(s)),r.length&&(i.forEach(e=>{e.classList.add("drag-start")}),e.dataTransfer.setData("text",JSON.stringify(o.get3DXContent(r))),e.dataTransfer.setData(r[0].getDragDataType(),""),r.length>1)){const n=function(e,n){const i=Math.min(n.getSize().width,200),o=t.createElement("div",{class:"drag-ghost-container",styles:{width:i},html:[{tag:"div",class:"drag-ghost-panel",html:[{tag:"div",class:"drag-ghost-title",styles:{width:i},text:e[0].get("title")}]},{tag:"span",class:"drag-ghost-counter",styles:{left:i},text:e.length}]});return document.body.appendChild(o),o}(r,e.target);e.dataTransfer.setDragImage(n,0,0)}}),A.container.addEvent("dragend",e=>{e.target.classList.contains("drag-start")&&e.target.classList.remove("drag-start");const t=document.querySelector(".inode-table");let n=[],i=[];y.multisel&&(n=a.getSelectedOf(t,w),(i=a.getSelectedModelsOf(t,w)).length&&n.forEach(e=>{e.classList.contains("drag-start")&&e.classList.remove("drag-start")}));const o=document.getElementsByClassName("drag-ghost-container");o&&Array.prototype.forEach.call(o,e=>{document.body.removeChild(e)})}),I=null,I=r(s),a.refreshSideBar(n.container,I,u.getBool("isInodePanelSideBarOpened"),!0),e.render(),n.render(),i.render(),n.container.addEventListener("contextmenu",()=>{F()}),_=!0,V=window.requestAnimationFrame(function e(){if(A&&A.container){if(function(e,t){if(!t.elements)return!1;const n=document.querySelector(".quota-alert-wrapper");e?(t.elements.detailViewWrapper.classList.add(g),t.elements.contentView.container.classList.add(f),null!==n&&n.hasChildNodes()?(t.elements.contentView.container.style.removeProperty("paddingTop"),n.classList.add("responsive_view"),t.elements.contentView.container.classList.add("quota_exceeded")):t.elements.contentView.container.classList.remove("quota_exceeded"),t.elements.topBarView&&t.elements.topBarView.container.childNodes[1]&&t.elements.topBarView.container.childNodes[1].classList.add(h)):(t.elements.detailViewWrapper.classList.remove(g),t.elements.contentView.container.classList.remove(f),null!==n&&n.hasChildNodes()?(n.classList.remove("responsive_view"),t.elements.contentView.container.classList.add("quota_exceeded")):t.elements.contentView.container.classList.remove("quota_exceeded"),t.elements.topBarView&&t.elements.topBarView.container.childNodes[1]&&t.elements.topBarView.container.childNodes[1].classList.remove(h))}(A.container.getBoundingClientRect().width<m,A),!_)return;setTimeout(()=>{V=window.requestAnimationFrame(e)},500)}}),O&&O.render(),A},destroy:function(){document.removeEventListener("keyup",x),document.removeEventListener("keydown",E),A.stopListening(),A.undelegateDOMEvents(),document.removeEventListener("click",R),V&&window.cancelAnimationFrame(V),V=null,W.apply(A,arguments),_=!1,A.elements.topBarView=null,A.elements.contentView=null,A.elements.detailView=null,A.elements=null,A.container.empty(),A.container=null,O&&(O.destroy(),O=null)},getElementFromModel:j,handleItemSelection:q,refreshTopBarView:k})}}),define("DS/W3DContentApp/Views/DrivesPanelView/drivesPanelView",["UWA/Core","UWA/Class/View","UWA/Utils/Client","DS/UIKIT/Input/Button","DS/UIKIT/Tooltip","DS/W3DContentApp/Views/DrivesPanelView/drivesScrollView","DS/W3DDrive/widget","DS/W3DContentApp/BusEvent","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/W3DContentApp/W3DContentApp.css"],function(e,t,n,i,o,r,s,a,l){"use strict";return function(c={}){const d=c.collection,u=new t({className:"w3ddrive drives-panel"});let p;const m=u.destroy,f=r({collection:d,viewSpecs:c.viewSpecs}),g=[(()=>{const t=e.createElement("div",{class:"controller",html:[{tag:"span",class:"fonticon fonticon-close"}],events:{click:function(e){s.dispatchEvent("onToggleDrivePanelSideBarCollapsed"),e.stopPropagation()}}});return new o({target:t,body:l.get("close")}),t})(),f.container];let h;return!s.getValue("is3DSpaceWidget")&&n.Platform.windows&&(h=new i({value:l.get("checkingInstall"),className:"link block download-app",icon:"install"}),g.push(h.elements.container),require(["DS/i3DXCompassServices/i3DXCompassPubSub"],function(e){const t=(e={})=>{e.icon&&h.setIcon(e.icon),h.setValue(e.nls),h.setClassName(e.style),h.elements.container.addClassName("btn-block download-app "+e.classVariation),h.elements.container.addEventListener("click",()=>{a.dispatchEvent("driveActions:"+e.handler)})};let n=setTimeout(()=>{t({nls:l.get("installNativeApp"),style:"primary",handler:"onInstallApp"})},25e3);e.publish("detectInstallApp",{appId:"X3DDRVN_AP"},e=>{clearTimeout(n),e&&!e.error?t({icon:"refresh",nls:l.get("configureNativeApp"),style:"default",classVariation:"transparent",handler:"onLaunchApp"}):e&&"recommended_update"===e.error?t({nls:l.get("updateInstallNativeApp"),style:"info",handler:"onInstallApp"}):e&&"mandatory_update"===e.error?t({nls:l.get("updateInstallNativeApp"),style:"warning",handler:"onInstallApp"}):t({nls:l.get("installNativeApp"),style:"default",handler:"onInstallApp"})})})),Object.assign(u,{selectedChildren:f.selectedChildren,children:f.children,findChildViewByModel:f.findChildViewByModel,render:function(){const e=u.container;if(p)for(;e.firstChild;)e.removeChild(e.firstChild);return e.setContent(g),f.render(),p=!0,u},destroy:function(){return f.destroy(),m.apply(u,arguments)}})}}),define("DS/W3DContentApp/w3DDriveView",["UWA/Class/View","DS/UIKIT/Mask","DS/W3DContentApp/Utils/Helpers","DS/W3DContentApp/Views/panelSlider","DS/W3DDrive/Utils/drives","DS/W3DContentApp/Views/DrivesPanelView/drivesPanelView","DS/W3DContentApp/Views/InodePanelView/inodePanelView","DS/W3DContentApp/Views/Lightbox/lightbox","DS/W3DContentApp/Views/UploadInodesView/taskViewSet","DS/W3DContentApp/Views/UploadInodesView/uploadInodeTasksView","DS/W3DXComponents/Views/EmptyView","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/W3DContentApp/W3DContentApp.css"],function(e,t,n,i,o,r,s,a,l,c,d,u){"use strict";var p,m,f,g,h,v=i(),D=new e({container:v.container}),w=D.render,b=D.destroy,C=c({children:l});return Object.assign(D,{getFirstPanel:function(){return f.hideFirstPanel?null:p},getSecondPanel:function(){return m},getLightbox:function(){return h},render:function(e={}){if(!e.viewSpecs)throw new Error("Missing input");return f=e.viewSpecs,v.render({viewSpecs:{hideController:f.hideFirstPanel}}),t.mask(v.container),f.hideFirstPanel||(p=r({collection:o}),v.refreshPanel(0,p.container),p.render()),C.render(),C.inject(v.container),w.apply(D,arguments)},showEmptyView:function(){g||(g=new d({icon:"picture",title:u.get("noContent")})),g.render().inject(D.container)},hideEmptyView:function(){g&&g.destroy()},showSecondPanel:function(e){var n;if(m){if(m.model===e)return v.slideTo(1),D;n=m,m.container.remove(),n.destroy(),n=null,m=null}return e?(m=s({model:e,viewSpecs:f.inodePanelView}),v.refreshPanel(1,m.container).slideTo(1),m.render(),t.unmask(v.container),D):(m=null,D)},showFirstPanel:function(){return f.hideFirstPanel||v.slideTo(0),D},showLightbox:function(e){const t=Boolean(n.getQueryHashParameter("content","commentURI"));h||(h=a.init({inode:e.inode,viewSpecs:f.lightboxView})),h.animationFrameId=window.requestAnimationFrame(function(){h.refresh(Object.assign(e,{focusComment:t}))})},hideLightbox:function(){h.animationFrameId&&(window.cancelAnimationFrame(h.animationFrameId),h.animationFrameId=null),h.hideLightbox()},updateLightbox:function(e,t){h.updatePreviewBody(e,t)},destroy:function(){return v.destroy(),C.destroy(),b.apply(D,arguments)}})});