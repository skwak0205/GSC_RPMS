define("DS/LifecycleWebInWinWidget/LifecycleWebInWinWidget",["css!DS/LifecycleWidget/LifecycleWidget","css!DS/LifecycleWebInWinWidget/LifecycleWebInWinWidget","UWA/Controls/Abstract","DS/ENO6WPlugins/jQuery","DS/WAFData/WAFData","DS/WebInWinHelper/WebInWinHelper","DS/HistoryMultiPanel/HistoryMultiPanel","DS/LifecycleServices/LifecycleAlert","DS/LifecycleServices/LifecycleServicesSettings","i18n!DS/LifecycleWidget/assets/nls/LifecycleWidgetNls"],function(e,t,i,n,s,o,l,a,c,r){"use strict";return i.extend({defaultOptions:{wintop:!1},webToWinCom_Socket:null,ContextualMenus:null,context:null,displayNotification:function(e){a.displayNotification(e)},init:function(e,t,i){var s=this;this.widget=e,this.context=this,this.options=i,this.isWebInWinODTMode=i.isWebInWinODTMode,this.securityContext=null,this.firstUpdate=!0,o.getServices(s),c.app_initialization(function(){o.initTenant(s),c.setTenant(s.tenant)}),this.contextMenuObject=null,1==this.options.wintop&&(this.webToWinCom_Socket=o.createWebInWinSocket("webinwinhistory_socket_")),this.options.webToWinComSocket=this.webToWinCom_Socket,this.options.fromWebInWinWrapper=!0,this.parentWidget=t,this._parent(i);var a=UWA.createElement("div");this.elements.container=a,a.className="webinwin_history_frame",a.setAttribute("data-rec-id",a.className),this.titleDiv=UWA.createElement("div"),this.titleDiv.className="webinwin_history_title",this.titleDiv.setAttribute("data-rec-id",this.titleDiv.className),this.titleDiv.inject(this.elements.container),this.titleWidget=UWA.createElement("h4",{class:"ebinwin_history_title_widget","data-rec-id":"ebinwin_history_title_widget",text:UWA.i18n("")}),this.titleWidget.inject(this.titleDiv);var r={setObjects:function(e,t,i){s.updateObjects(e,t,i)},setTitleFromObject:function(e){s.setTitleFromObject(e)},postUpdateHandler:function(e){}};this.historyMultiPanel=new l(this,e,t,i,r),window.addEventListener("resize",function(e){s.historyMultiPanel.revisionFamily.onResize(e)}),this.historyMultiPanel.inject(this.elements.container),1==this.options.wintop&&n(document).ready(function(){n(window).resize(function(){s.historyMultiPanel.revisionFamily.onResize()})}),document.addEventListener("keydown",function(e){if(1==e.ctrlKey){if(79==e.keyCode){if(e.preventDefault&&(e.preventDefault(),null!=s.historyMultiPanel.selectedData)){var t={id:s.historyMultiPanel.selectedData.physicalid,displayName:s.historyMultiPanel.selectedData.displayName};o.fireWintopCommand(s.webToWinCom_Socket,t,"OpenSearch")}}else if(69==e.keyCode){if(e.preventDefault&&(e.preventDefault(),null!=s.historyMultiPanel.selectedData)){t={id:s.historyMultiPanel.selectedData.physicalid,displayName:s.historyMultiPanel.selectedData.displayName};o.fireWintopCommand(s.webToWinCom_Socket,t,"CATImmSendToNewVPMCmdRoot")}}}else if(1==e.altKey&&13==e.keyCode){if(e.preventDefault&&(e.preventDefault(),null!=s.historyMultiPanel.selectedData)){t={id:s.historyMultiPanel.selectedData.physicalid,displayName:s.historyMultiPanel.selectedData.displayName};o.fireWintopCommand(s.webToWinCom_Socket,t,"ImmSearchProperty")}}return!1})},setTitle:function(e){this.titleWidget.innerHTML=e},setTitleFromObject:function(e){e&&(e.cfgRevTitle?this.setTitle(e.cfgRevTitle):e.displayName&&this.setTitle(e.displayName+" "+e.revision))},sendSelection:function(e){o.setCSOSelection(this.options.webToWinComSocket,e)},reframeHistoryTree:function(){},updateObjects:function(e,t,i){var n=this;null!=this.options.webToWinComSocket&&(this.firstUpdate||o.setCSOSelection(this.options.webToWinComSocket,e)),this.firstUpdate=!1,0==i&&this.historyMultiPanel.revisionFamily.setObjects(e),setTimeout(function(){n.reframeHistoryTree()},1);var s=JSON.stringify(e);this.widget.setValue("Custo_roots_pids",s)},initDatafromWin:function(e){var t=this,i=[];e.forEach(function(e){var n=e.physicalId,s=e.name,o={physicalid:n,displayName:s,name:s,tenant:t.tenant};i.push(o)}),this.historyMultiPanel.setObjects(i,!1,!1)},onResize:function(){},onRefresh:function(){},initEnvfromWin:function(e){},onSetCtxMenuForItem:function(e){this.historyMultiPanel.revisionFamily.onSetCtxMenuForItem(e),null!==this.historyMultiPanel.revisionFamily.contextMenuObject&&this.historyMultiPanel.revisionFamily.contextMenuObject.physicalid}})});