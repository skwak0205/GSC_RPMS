define("DS/MPFOrderListComponent/NoStatusSelectorTileElement",["UWA/Class/View","DS/MPFUtils/MPFUtils","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(e,t){"use strict";var r,i;return(r=e.extend({className:"mpf-hidden",render:function(){return this},setIsSelected:t.doNothing,updateCount:t.doNothing})).getInstance=function(){return i||(i=new r),i},r}),define("DS/MPFOrderListComponent/RequestStatusTile",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFCartModel/CartModel","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(e,t,r,i,s){"use strict";var n,a={};return a.ACTIVE="active",a.FINISHED="finished",(n=t.extend({className:"mpf-request-status-tile",setup:function(e){r.requiredOfPrototype(e.cart,i,"options.cart must be a CartModel"),this.cart=e.cart},render:function(){return this.state=this._getState(),this.container.setContent([{tag:"span",class:"mpf-label",text:s.get("requestStatus")},{tag:"span",class:"mpf-status "+this.state,text:s.get(this.state)}]),this},destroy:function(){this.cart=null,this._parent(),this.container=null},_getState:function(){var e=this.cart.getState();return e===i.States.CANCELLED||e===i.States.FINISHED?a.FINISHED:a.ACTIVE}})).States=Object.freeze(a),n}),define("DS/MPFOrderListComponent/OrderListEvents",[],function(){"use strict";return Object.freeze({FILTER_BY_STATE:"filterByState",FILTER_BY_DATE:"filterByDate",SORT:"sort",CLEAR_DATE_FILTER:"clearFilter"})}),define("DS/MPFOrderListComponent/PriceTile",["UWA/Core","UWA/Promise","UWA/Event","UWA/Class/View","DS/MPFCartModel/CartModel","DS/MPFCartModel/CartModelHelper","DS/MPFServices/ObjectService","DS/MPFServices/MarketplaceServices","DS/MPFInvoiceModel/InvoiceFactory","DS/MPFInvoiceModel/InvoiceModel","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(e,t,r,i,s,n,a,o,c,l,d){"use strict";return i.extend({className:"mpf-price-tile",setup:function(t){a.requiredOfPrototype(t.cart,s,"options.cartItem must be a CartModel"),t.isSellerView&&t.cart.getGlobalState()===s.GlobalStates.DELIVERED&&a.requiredOfPrototype(t.invoiceFactory,c,"options.invoiceFactory must be a InvoiceFactory"),this.cart=t.cart,this.isSellerView=t.isSellerView,this.invoiceFactory=t.invoiceFactory,this.locale=t.locale||"fr-FR",this.service=e.is(t.service)?t.service:o.MAKE,this.price=this._createPrice(),this.taxComment=this._createTaxComment(),this.invoiceLink=this._createInvoiceLink()},render:function(){return this.container.setContent([this.price,this.taxComment,this.invoiceLink]),this},destroy:function(){this.cart=null,this._parent(),this.container=null},_createPrice:function(){var t,r=this.cart.get(s.Fields.PRICE_MINIMUM),i=this.cart.get(s.Fields.PRICE_MAXIMUM),a=r<0&&i>=0,c=r>=0&&i>=0,l=r>=0&&i<0;return t=this.service===o.STORE||this.service===o.IFWELOOP?this._formatPrice(this.cart.getNetAmountTotal()):a?this._formatPrice(i):c?this._formatPrice(r,{noSymbol:!0})+"- "+this._formatPrice(i,{noSymbol:!0})+n.getCurrencySymbol(this.cart):l?this._formatPrice(r,{noSymbol:!0})+"+ "+n.getCurrencySymbol(this.cart):"-- "+n.getCurrencySymbol(this.cart),e.createElement("div",{class:"mpf-price-tile-price",text:t})},_formatPrice:function(e,t){return t||(t={}),t.locale=this.locale,n.formatPrice(this.cart,e,t)},_createTaxComment:function(){return e.createElement("div",{class:"mpf-price-tile-tax-comment",text:d.get("taxExcludedAbbreviation")})},_createInvoiceLink:function(){var t;return this.isSellerView&&this.cart.getGlobalState()===s.GlobalStates.DELIVERED&&(t=e.createElement("a",{href:"#",events:{click:function(e){r.stopPropagation(e)}}}),this._getInvoiceFromCartId().then(function(e){e&&(t.setAttributes({href:e.getInvoice(),download:e.getName()}),t.setText(d.get("commissionInvoice")))})),t},_getInvoiceFromCartId:function(){var e;return(e=this.invoiceFactory.createCollection(c.Types.CART_INVOICE)).setParentResourceId(this.cart.id),e.fetchPromise().then(function(){return e.find(function(e){return e.getType()===l.Types.INVOICE})})}})}),define("DS/MPFOrderListComponent/StatusProgressTile",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFServices/MarketplaceServices","DS/MPFCartModel/CartModel","DS/MPFCartModel/CartItemModel","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(e,t,r,i,s,n,a){"use strict";var o={CANCELLED:"0",SUBMITTED:"14",WAITING_PAYMENT:"29",PROCESSING_PAYMENT:"43",PAID:"58",PROCESSING:"72",READY:"86",SHIPPED:"86",DELIVERED:"100"};return t.extend({className:"mpf-status-progress",setup:function(t){t||(t={}),this._parent(t),this._checkPrototypes(t),this.cart=t.cart,this.service=e.is(t.service)?t.service:i.MAKE},render:function(){return this.container.setContent([this._getProgressBarContainer(),this._getOrderStatusContainer()]),this},destroy:function(){this.cart=null,this._parent(),this.container=null},_getProgressBarContainer:function(){var t,r,i;if(i=this.cart.getGlobalState(),r=o[i],t=e.createElement("div",{class:"mpf-progress-bar",html:e.createElement("div",{class:"mpf-step-bar",styles:{width:r+"%"}})}),i===s.GlobalStates.DELIVERED&&t.addClassName("complete"),i===s.GlobalStates.SHIPPED){var n=new Date;new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds())-new Date(this.cart.getDeliveryDate())>0&&t.addClassName("late")}return t},_getOrderStatusContainer:function(){return e.createElement("div",{class:"mpf-status",html:[this._getIconContainer(),e.createElement("span",{class:"mpf-status-label",text:a.get(this.cart.getGlobalState().toLowerCase())})]})},_getIconContainer:function(){var t,r;return(r=this.cart.getGlobalState())===s.GlobalStates.SUBMITTED?t="fonticon fonticon-right":r===s.GlobalStates.WAITING_PAYMENT?t="fonticon fonticon-survey":r===s.GlobalStates.PROCESSING_PAYMENT?t="fonticon fonticon-hourglass":r===s.GlobalStates.PAID?t="fonticon fonticon-check":r===s.GlobalStates.PROCESSING?t="fonticon fonticon-clock":r===s.GlobalStates.READY?t="fonticon fonticon-parcel-ok":r===s.GlobalStates.DELIVERED?t="fonticon fonticon-status-ok":r===s.GlobalStates.CANCELLED?t="fonticon fonticon-wrong":r===s.GlobalStates.SHIPPED&&(t="fonticon fonticon-truck-delivery"),e.createElement("span",{class:t})},_checkPrototypes:function(e){r.requiredOfPrototype(e.cart,s,"options.cart must be a CartModel")}})}),define("DS/MPFOrderListComponent/LegalEntityTile",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFError/BadArgumentError","DS/MPFFiniteStateMachine/FiniteStateMachine","DS/MPFCartModel/CartModel","DS/MPFTCContractModel/TCContractModel","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(e,t,r,i,s,n,a,o){"use strict";var c,l={};return l.BUYER="buyer",l.SELLER="seller",l.EMP="emp",(c=t.extend({className:"mpf-legal-entity-tile",setup:function(e){r.requiredOfPrototype(this.model,n,"this.model must be a CartModel"),this.isSeller=!0===e.isSeller,this.stateMachine=this._createStateMachine(e.state),this.logo=this._createLogo(),this.title=this._createTitle(),this.subtitle=this._createSubtitle()},render:function(){return this.isSeller?this.container.addClassName("seller"):this.container.addClassName("buyer"),this.container.setContent([e.createElement("div",{class:"first-column",html:this.logo}),e.createElement("div",{class:"second-column",html:[this.title,this.subtitle]})]),this},destroy:function(){this.model=null,this._parent(),this.container=null},_createLogo:function(){var t=this.stateMachine.getState();return this.isSeller&&t===l.SELLER?e.createElement("span",{class:"fonticon"}):e.createElement("span",{class:this.isSeller?"fonticon fonticon-factory":"fonticon fonticon-user"})},_createTitle:function(){var t,r;return r=this.stateMachine.getState(),t=this.isSeller&&r!==l.SELLER?this.model.getShopName():this.isSeller?"":this.model.getOwnerData().FirstName+" "+this.model.getOwnerData().LastName.toUpperCase(),e.createElement("div",{class:"mpf-legal-entity-name",text:t})},_createSubtitle:function(){var t="";if(this.isSeller){if(this.isSeller&&e.is(this.model.getContractDocuments())&&this.model.getContractDocuments().length>0){var r=this.model.getContractDocuments().filter(function(e){return e.documentType===a.DOCUMENT_TYPES.NDA&&e.currentState!==a.STATUS.archived});if(r.length>0){var i=r[0].currentState;i===a.STATUS.draft?t+=o.get("NDA")+" - "+o.get("notSigned"):i===a.STATUS.inEffect&&(t+=o.get("NDA")+" - "+o.get("signed"))}}}else t+=this.model.getOwnerData().Company;return e.createElement("div",{class:"mpf-legal-entity-subtitle",text:t})},_createStateMachine:function(e){return new s({state:e,states:[l.BUYER,l.SELLER,l.EMP],transitions:[]})}})).States=Object.freeze(l),c}),define("DS/MPFOrderListComponent/3DExperienceServiceTile",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFCartModel/CartModel","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(e,t,r,i,s){"use strict";return t.extend({className:"mpf-3dexp-tile",setup:function(e){e||(e={}),r.requiredOfPrototype(e.cart,i,"options.cart must be a CartModel"),this.cart=e.cart},render:function(){var t;return t=this.cart.getActionType()===i.ActionTypes.RENEWAL?s.get("renewal"):s.get("order"),this.container.setContent([s.get("type")+" ",e.createElement("span",{class:"mpf-cart-type",text:t})]),this}})}),define("DS/MPFOrderListComponent/DetailItemsTile",["UWA/Core","UWA/Event","UWA/Class/View","DS/UIKIT/Input/Button","DS/MPFServices/ObjectService","DS/MPFFiniteStateMachine/FiniteStateMachine","DS/MPFCartModel/CartModel","DS/MPFCartModel/CartItemCollection","DS/MPFDataProxy/NoDataProxy","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(e,t,r,i,s,n,a,o,c,l){"use strict";var d={DETAILS_DISPLAYED:"DETAILS_DISPLAYED",DETAILS_NOT_DISPLAYED:"DETAILS_NOT_DISPLAYED"},h=r.extend({className:"mpf-detail-items",setup:function(e){e||(e={}),this._parent(e),this._checkPrototypes(e),this.locale=e.locale||"fr-FR",this.cart=e.cart,this.cartItems=this.cart.getItems(),this.stateMachine=this._createStateMachine(),this.detailsButton=this._createDetailsButton(),this.table=this._createTable()},render:function(){return this.container.setContent([this.detailsButton,this.table]),this.table.hide(),this},destroy:function(){this.cart=null,this.cartItems=null,this._parent(),this.container=null},_createItemRow:function(t){var r,i,s,n;return r=this.cart.getCurrency(),i=t.getUnitNetAmount().toLocaleString(this.locale,{style:"currency",currency:r,currencyDisplay:"code"}).replace(r,"").trim(),s=t.getUnitTaxesAmount().toLocaleString(this.locale,{style:"currency",currency:r,currencyDisplay:"code"}).replace(r,"").trim(),n=t.getTotalGrossAmount().toLocaleString(this.locale,{style:"currency",currency:r}),e.createElement("tr",{html:[e.createElement("td",{text:t.getProductDisplayName()}),e.createElement("td",{text:parseInt(t.getQuantity())}),e.createElement("td",{text:i}),e.createElement("td",{text:s}),e.createElement("td",{text:n})]})},_createTable:function(){return e.createElement("div",{class:"table-responsive",html:this._createTableContent()})},_createTableFooter:function(){return e.createElement("tfoot",{html:e.createElement("tr",{html:[e.createElement("td"),e.createElement("td"),e.createElement("td"),e.createElement("td",{text:l.get("total")}),e.createElement("td",{text:this.cart.getNetAmountTotal().toLocaleString(this.locale,{style:"currency",currency:this.cart.getCurrency()})+" "+l.get("taxExcludedAbbreviation")})]})})},_createTableBody:function(){return e.createElement("tbody",{html:this.cartItems.map(function(e){return this._createItemRow(e)},this)})},_createTableHeader:function(){return e.createElement("thead",{html:e.createElement("tr",{html:[e.createElement("th",{text:l.get("item")}),e.createElement("th",{text:l.get("quantity")}),e.createElement("th",{text:l.get("unitPrice")}),e.createElement("th",{text:l.get("taxes")}),e.createElement("th",{text:l.get("totalAmountWithTaxes")})]})})},_createTableContent:function(){return e.createElement("table",{class:"table table-hover",html:[this._createTableHeader(),this._createTableBody(),this._createTableFooter()]})},_onClickHandler:function(e){var r;t.stopPropagation(e),(r=this.stateMachine.getState())===d.DETAILS_NOT_DISPLAYED&&(this.table.show(),this.detailsButton.setIcon("eye-off"),this.detailsButton.setValue(l.get("hideDetails")),this.stateMachine.changeState(d.DETAILS_DISPLAYED)),r===d.DETAILS_DISPLAYED&&(this.table.hide(),this.detailsButton.setIcon("eye"),this.detailsButton.setValue(l.get("details")),this.stateMachine.changeState(d.DETAILS_NOT_DISPLAYED)),this.detailsButton.setFocus(!1)},_createDetailsButton:function(){return new i({className:"link",icon:"eye",value:l.get("details"),events:{onClick:this._onClickHandler.bind(this)}})},_createStateMachine:function(){return new n({state:d.DETAILS_NOT_DISPLAYED,states:[d.DETAILS_DISPLAYED,d.DETAILS_NOT_DISPLAYED],transitions:[{from:d.DETAILS_DISPLAYED,to:d.DETAILS_NOT_DISPLAYED},{from:d.DETAILS_NOT_DISPLAYED,to:d.DETAILS_DISPLAYED}]})},_checkPrototypes:function(e){s.requiredOfPrototype(e.cart,a,"options.cart must be a CartModel")}});return h.States=Object.freeze(d),h}),define("DS/MPFOrderListComponent/LastUpdateTile",["UWA/Core","UWA/Class/View","UWA/String","DS/MPFServices/ObjectService","DS/MPFCartModel/CartModel","DS/MPFCartModel/CartModelHelper","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(e,t,r,i,s,n,a){"use strict";return t.extend({className:"mpf-order-last-update",setup:function(e){e||(e={}),this._parent(e),this._checkPrototypes(e),this.cart=e.cart},render:function(){var t,r;return t=e.createElement("span",{class:"mpf-last-update-label",text:a.get("lastUpdate")}),r=e.createElement("span",{class:"mpf-last-update-value",text:this._getLastUpdateTime()}),this.container.setContent([t,r]),this},_getLastUpdateTime:function(){return r.format(a.get("timeAgo"),n.getElapsedTime(this.cart.getLastUpdate()||this.cart.getCreated()))},_checkPrototypes:function(e){i.requiredOfPrototype(e.cart,s,"options.cart must be a CartModel")}})}),define("DS/MPFOrderListComponent/StatusDateTile",["UWA/Core","UWA/Class/View","UWA/String","DS/MPFServices/ObjectService","DS/MPFCartModel/CartModel","DS/MPFCartModel/CartModelHelper","DS/MPFFiniteStateMachine/FiniteStateMachine","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(e,t,r,i,s,n,a,o){"use strict";var c={CREATION:"creation",DELIVERY:"delivery",DEADLINE:"deadline"},l={DELIVERED:"DELIVERED"},d=t.extend({className:"mpf-status-date",setup:function(e){e||(e={}),this._parent(e),this._checkPrototypes(e),this.cart=e.cart,this.stateMachine=this._createStateMachine(e.state)},render:function(){return this.stateMachine.getState()===c.CREATION?this.container.setContent(this._getCreationContent()):this.stateMachine.getState()===c.DELIVERY?this.container.setContent(this._getDeliveryContent()):this.stateMachine.getState()===c.DEADLINE&&this.container.setContent(this._getDeadlineContent()),this},destroy:function(){this.cart=null,this.stateMachine=null,this._parent(),this.container=null},_getCreationContent:function(){var t,i,s;return s=this.cart.getCreated(),t=e.createElement("div",{class:"mpf-time",html:[o.get("created")+" ",e.createElement("span",{text:r.format(o.get("timeAgo"),n.getElapsedTime(s))})]}),i=e.createElement("div",{class:"mpf-date",text:"("+this._getDateString(s)+")"}),this.container.addClassName("creation"),[t,i]},_getDeliveryContent:function(){var t,i,s,a=this.cart.getDeliveryDate();if(""===a)i=e.createElement("span",{text:o.get("notSet")}),t=e.createElement("div",{class:"mpf-time",html:o.get("deliveryNotSet",{notSet:i.outerHTML})}),s=e.createElement("div",{class:"mpf-date",html:"&nbsp;"});else{var c=new Date;new Date(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate(),c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds())-new Date(a)<0?(i=e.createElement("span",{text:n.getRemainingTime(a)}),t=e.createElement("div",{class:"mpf-time",html:o.get("deliveryIn",{time:i.outerHTML})})):(i=e.createElement("span",{text:r.format(o.get("timeAgo"),n.getElapsedTime(a))}),this.cart.getGlobalState()===l.DELIVERED?t=e.createElement("div",{class:"mpf-time",html:o.get("deliveryExpected",{timeAgo:i.outerHTML})}):(this.container.addClassName("attention"),t=e.createElement("div",{class:"mpf-time",html:[e.createElement("span",{class:"fonticon fonticon-attention"}),o.get("deliveryExpected",{timeAgo:i.outerHTML})]}))),s=e.createElement("div",{class:"mpf-date",text:"("+this._getDateString(a)+")"})}return this.container.addClassName("delivery"),[t,s]},_getDeadlineContent:function(){var t,r,i,s=this.cart.getDeadlineDate(),a=new Date,c=new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds());return new Date(s)-c>0?(r=e.createElement("span",{text:n.getRemainingTime(s)}),t=e.createElement("div",{class:"mpf-time",html:o.get("endsIn",{time:r.outerHTML})})):(r=e.createElement("span",{text:o.get("ended")}),t=e.createElement("div",{class:"mpf-time ended",html:r})),i=e.createElement("div",{class:"mpf-date",text:"("+this._getDateString(s)+")"}),this.container.addClassName("deadline"),[t,i]},_getDateString:function(e){var t,r={};return t=new Date(e),r.year="numeric",r.month="long",r.day="numeric",t.toLocaleDateString("en-EN",r)},_createStateMachine:function(e){return new a({state:e,states:[c.CREATION,c.DELIVERY],transitions:[]})},_checkPrototypes:function(e){i.requiredOfPrototype(e.cart,s,"options.cart must be a CartModel")}});return d.States=Object.freeze(c),d}),define("DS/MPFOrderListComponent/StatusSelectorTileElement",["UWA/Core","UWA/Class/View"],function(e,t){"use strict";return t.extend({className:"mpf-status-selector-tile-element",domEvents:{click:"onClick"},setup:function(e){this.title=e.title,this.count=e.count||0,this.setIsSelected(e.isSelected),this.titleElement=this._createTitleElement(),this.countElement=this._createCountElement(),this.container.addClassName(e.cssClass)},render:function(){return this.container.setContent([this.titleElement,this.countElement]),this},setIsSelected:function(e){this.isSelected=!0===e,this.isSelected?this.container.addClassName("mpf-selected"):this.container.removeClassName("mpf-selected")},onClick:function(){this.dispatchEvent("selected"),this.setIsSelected(!0)},destroy:function(){this._parent()},updateCount:function(e){this.countElement.setText("("+e+")")},_createTitleElement:function(){return e.createElement("p",{class:"mpf-title",text:this.title})},_createCountElement:function(){return e.createElement("p",{class:"mpf-count",text:"("+this.count+")"})}})}),define("DS/MPFOrderListComponent/PaymentDateTile",["UWA/Core","UWA/Class/View","UWA/String","DS/MPFServices/ObjectService","DS/MPFCartModel/CartModel","DS/MPFCartModel/CartModelHelper","DS/MPFFiniteStateMachine/FiniteStateMachine","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(e,t,r,i,s,n,a,o){"use strict";var c={PAID:"PAID",DUE_DATE:"DUE_DATE"},l=t.extend({className:"mpf-payment-date",setup:function(e){e||(e={}),this._parent(e),this._checkPrototypes(e),this.cart=e.cart,this.stateMachine=this._createStateMachine(e.state)},render:function(){return this.stateMachine.getState()===c.PAID?this.container.setContent(this._getPaidContent()):this.stateMachine.getState()===c.DUE_DATE&&this.container.setContent(this._getDueDateContent()),this},destroy:function(){this.cart=null,this._parent(),this.container=null},_getPaidContent:function(){var t,i,s;return s=this.cart.getCreated(),t=e.createElement("div",{class:"mpf-time",html:[o.get("paidLabel")+" ",e.createElement("span",{text:r.format(o.get("timeAgo"),n.getElapsedTime(s))})]}),i=e.createElement("div",{class:"mpf-date",text:"("+this._getDateString(s)+")"}),this.container.addClassName("paid"),[t,i]},_getDueDateContent:function(){var t,r,i;if(this.cart.getGlobalState()!==s.States.DELIVERED&&this.cart.getGlobalState()!==s.States.CANCELLED)return i=e.is(this.cart.get("dueDate"))&&""!==this.cart.get("dueDate")?n.getRemainingTime(this.cart.get("dueDate")):o.get("notSet"),t=e.createElement("div",{class:"mpf-time",html:o.get("dueDateIn",{time:e.createElement("span",{text:i}).outerHTML})}),r=e.createElement("div",{class:"mpf-date",text:e.is(this.cart.get("dueDate"))&&""!==this.cart.get("dueDate")?"("+this._getDateString(i)+")":""}),this.container.addClassName("due-date"),[t,r]},_getDateString:function(e){var t,r={};return t=new Date(e),r.year="numeric",r.month="long",r.day="numeric",t.toLocaleDateString("en-EN",r)},_createStateMachine:function(e){return new a({state:e,states:[c.PAID,c.DUE_DATE],transitions:[]})},_checkPrototypes:function(e){i.requiredOfPrototype(e.cart,s,"options.cart must be a CartModel")}});return l.States=Object.freeze(c),l}),define("DS/MPFOrderListComponent/OrderIdTile",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFCartModel/CartModel","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(e,t,r,i,s){"use strict";return t.extend({className:"mpf-order-id",setup:function(e){e||(e={}),this._parent(e),this._checkPrototypes(e),this.cart=e.cart},render:function(){var e=[];return this.cart.isTender()&&e.push({tag:"span",class:"mpf-tender-icon"+(this.cart.isTenderResponse()?" mpf-tender-response":""),html:[{tag:"span",class:"fonticon fonticon-megaphone"}]}),e.push({tag:"span",class:"mpf-cart-name",text:this.cart.getName()}),this.container.setContent(e),this},_checkPrototypes:function(e){r.requiredOfPrototype(e.cart,i,"options.cart must be a CartModel")}})}),define("DS/MPFOrderListComponent/NumberServiceProvidersTile",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFCartModel/CartModel","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(e,t,r,i,s){"use strict";return t.extend({className:"mpf-number-service-providers-tile",setup:function(e){r.requiredOfPrototype(e.cart,i,"options.cart must be a CartModel"),this.cart=e.cart},render:function(){var t=this.cart.getNumberSellers(),r=e.createElement("span",{class:"mpf-number",text:t||"?"});return this.container.setContent([{tag:"div",class:"first-column",html:[{tag:"span",class:"fonticon fonticon-factory"}]},{tag:"div",class:"second-column",html:[{tag:"div",class:"mpf-legal-entity-name",html:t>1?s.get("xServiceProvidersNotified",{number:r.outerHTML}):s.get("oneServiceProviderNotified",{number:r.outerHTML})}]}]),this},destroy:function(){this.cart=null,this._parent(),this.container=null}})}),define("DS/MPFOrderListComponent/StatusSelectorTile",["UWA/Class/View","DS/MPFOrderListComponent/StatusSelectorTileElement","DS/MPFOrderListComponent/NoStatusSelectorTileElement","DS/MPFCartModel/CartCollection","DS/MPFCartModel/CartFilters","DS/MPFOrderListComponent/OrderListEvents","DS/MPFServices/ObjectService","DS/MPFServices/MarketplaceServices","DS/MPFView/EmptyView","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent"],function(e,t,r,i,s,n,a,o,c,l){"use strict";return e.extend({className:"mpf-status-selector-tile",setup:function(e){a.requiredOfPrototype(e.carts,i,"options.carts must be a CartCollection"),this.carts=e.carts,this.statusSelectorInitValue=e.statusSelectorInitValue,this.service=e.service,this.pendingSelector=this._createPendingSelector(),this.deliveredSelector=this._createDeliveredSelector(),this.canceledSelector=this._createCanceledSelector(),this.allSelector=this._createAllSelector(),this.listenTo(this.pendingSelector,"selected",this._onPendingSelected.bind(this)),this.listenTo(this.deliveredSelector,"selected",this._onDeliveredSelected.bind(this)),this.listenTo(this.canceledSelector,"selected",this._onCanceledSelected.bind(this)),this.listenTo(this.allSelector,"selected",this._onAllSelected.bind(this)),this.listenTo(this.carts,"onReset",this._updateSelectorCounts.bind(this))},render:function(){return this.container.setContent([this.pendingSelector.render(),this.deliveredSelector.render(),this.canceledSelector.render(),this.allSelector.render()]),this},destroy:function(){this.stopListening(this.pendingSelector),this.stopListening(this.deliveredSelector),this.stopListening(this.canceledSelector),this.stopListening(this.allSelector),this.stopListening(this.carts),this._parent()},_updateSelectorCounts:function(){this.pendingSelector.updateCount(this.carts.pending),this.deliveredSelector.updateCount(this.carts.delivered),this.canceledSelector.updateCount(this.carts.cancelled),this.allSelector.updateCount(this.carts.all),this.render()},_createPendingSelector:function(){return new t({title:l.get("pending"),isSelected:this.statusSelectorInitValue===s.STATE_PENDING_FILTER,cssClass:"pending",count:this.carts.pending})},_createDeliveredSelector:function(){return this.service===o.ENGINEERING?r.getInstance():new t({title:l.get("delivered"),isSelected:this.statusSelectorInitValue===s.STATE_DELIVERED_FILTER,cssClass:"delivered",count:this.carts.delivered})},_createCanceledSelector:function(){return new t({title:l.get("canceled"),isSelected:this.statusSelectorInitValue===s.STATE_CANCELED_FILTER,cssClass:"canceled",count:this.carts.cancelled})},_createAllSelector:function(){return new t({title:l.get("all"),isSelected:this.statusSelectorInitValue===s.STATE_ALL_FILTER,cssClass:"all",count:this.carts.all})},_onPendingSelected:function(){var e={};this.deliveredSelector.setIsSelected(!1),this.canceledSelector.setIsSelected(!1),this.allSelector.setIsSelected(!1),e[s.FILTER_BY_STATE]=s.STATE_PENDING_FILTER,this.dispatchEvent(n.FILTER_BY_STATE,e)},_onDeliveredSelected:function(){var e={};this.pendingSelector.setIsSelected(!1),this.canceledSelector.setIsSelected(!1),this.allSelector.setIsSelected(!1),e[s.FILTER_BY_STATE]=s.STATE_DELIVERED_FILTER,this.dispatchEvent(n.FILTER_BY_STATE,e)},_onCanceledSelected:function(){var e={};this.pendingSelector.setIsSelected(!1),this.deliveredSelector.setIsSelected(!1),this.allSelector.setIsSelected(!1),e[s.FILTER_BY_STATE]=s.STATE_CANCELED_FILTER,this.dispatchEvent(n.FILTER_BY_STATE,e)},_onAllSelected:function(){var e={};this.pendingSelector.setIsSelected(!1),this.deliveredSelector.setIsSelected(!1),this.canceledSelector.setIsSelected(!1),e[s.FILTER_BY_STATE]=s.STATE_ALL_FILTER,this.dispatchEvent(n.FILTER_BY_STATE,e)}})}),define("DS/MPFOrderListComponent/OrderListCommandFilter",["UWA/Core","UWA/Class/View","DS/UIKIT/DropdownMenu","DS/MPFOrderListComponent/OrderListEvents","DS/MPFCartModel/CartFilters","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent"],function(e,t,r,i,s,n){"use strict";var a={CLEAR:"clearFilter",CREATION_DATE_TODAY:"creationDateToday",CREATION_DATE_LAST_7_DAYS:"creationDateLast7Days",CREATION_DATE_LAST_30_DAYS:"creationDateLast30Days",CREATION_DATE_LAST_6_MONTHS:"creationDateLast6Months",MODIFICATION_DATE_TODAY:"modificationDateToday",MODIFICATION_DATE_LAST_7_DAYS:"modificationDateLast7Days",MODIFICATION_DATE_LAST_30_DAYS:"modificationDateLast30Days",MODIFICATION_DATE_LAST_6_MONTHS:"modificationDateLast6Months"};return t.extend({className:"mpf-order-list-command-filter",setup:function(e){this.filterIcon=this._createFilterIcon(),this.filterMenu=this._createFilterMenu()},render:function(){return this.container.setContent([this.filterIcon]),this},destroy:function(){this._parent()},setActive:function(e){!0===e?this.filterIcon.addClassName("mpf-active"):this.filterIcon.removeClassName("mpf-active")},_createFilterIcon:function(){return e.createElement("div",{class:"fonticon fonticon-filter"})},_createFilterMenu:function(){return new r({target:this.container,renderTo:this.container,multiSelect:!1,items:[{text:n.get("creationDate"),items:[{text:n.get("today"),name:a.CREATION_DATE_TODAY,selectable:!0},{text:n.get("lastXDays",{number:7}),name:a.CREATION_DATE_LAST_7_DAYS,selectable:!0},{text:n.get("lastXDays",{number:30}),name:a.CREATION_DATE_LAST_30_DAYS,selectable:!0},{text:n.get("lastXMonths",{number:6}),name:a.CREATION_DATE_LAST_6_MONTHS,selectable:!0}]},{text:n.get("modificationDate"),items:[{text:n.get("today"),name:a.MODIFICATION_DATE_TODAY,selectable:!0},{text:n.get("lastXDays",{number:7}),name:a.MODIFICATION_DATE_LAST_7_DAYS,selectable:!0},{text:n.get("lastXDays",{number:30}),name:a.MODIFICATION_DATE_LAST_30_DAYS,selectable:!0},{text:n.get("lastXMonths",{number:6}),name:a.MODIFICATION_DATE_LAST_6_MONTHS,selectable:!0}]},{text:n.get("clearFilter"),name:a.CLEAR,selectable:!0,fonticon:"trash"}],events:{onClick:this._onFilterSelected.bind(this)}})},_onFilterSelected:function(e,t){switch(this._updateMenuSelection(t),t.name){case a.CREATION_DATE_TODAY:this._dispatchFilterCreationDateDays(0);break;case a.CREATION_DATE_LAST_7_DAYS:this._dispatchFilterCreationDateDays(7);break;case a.CREATION_DATE_LAST_30_DAYS:this._dispatchFilterCreationDateDays(30);break;case a.CREATION_DATE_LAST_6_MONTHS:this._dispatchFilterCreationDateMonths(6);break;case a.MODIFICATION_DATE_TODAY:this._dispatchFilterModificationDateDays(0);break;case a.MODIFICATION_DATE_LAST_7_DAYS:this._dispatchFilterModificationDateDays(7);break;case a.MODIFICATION_DATE_LAST_30_DAYS:this._dispatchFilterModificationDateDays(30);break;case a.MODIFICATION_DATE_LAST_6_MONTHS:this.dispatchEvent(i.FILTER_BY_DATE,{filter:s.FILTER_BY_MODIFICATION_DATE_MONTHS,months:6});break;case a.CLEAR:this.dispatchEvent(i.FILTER_BY_DATE,{filter:s.CLEAR})}},_updateMenuSelection:function(e){this.filterMenu.getSelectedItems().forEach(function(t){t!==e&&(t.elements.container.removeClassName("selected"),t.selected=!1)})},_dispatchFilterCreationDateDays:function(e){this.dispatchEvent(i.FILTER_BY_DATE,{filter:s.FILTER_BY_CREATION_DATE_DAYS,days:e})},_dispatchFilterCreationDateMonths:function(e){this.dispatchEvent(i.FILTER_BY_DATE,{filter:s.FILTER_BY_CREATION_DATE_MONTHS,months:e})},_dispatchFilterModificationDateDays:function(e){this.dispatchEvent(i.FILTER_BY_DATE,{filter:s.FILTER_BY_MODIFICATION_DATE_DAYS,days:e})},_dispatchFilterModificationDateMonths:function(e){this.dispatchEvent(i.FILTER_BY_DATE,{filter:s.FILTER_BY_MODIFICATION_DATE_MONTHS,months:e})}})}),define("DS/MPFOrderListComponent/OrderCardBody",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFServices/MarketplaceServices","DS/MPFFiniteStateMachine/FiniteStateMachine","DS/MPFCartModel/CartModel","DS/MPFPersonModel/PersonModel","DS/MPFOrderListComponent/LegalEntityTile","DS/MPFOrderListComponent/NumberServiceProvidersTile","DS/MPFOrderListComponent/StatusDateTile","DS/MPFOrderListComponent/PaymentDateTile","DS/MPFOrderListComponent/PriceTile","DS/MPFView/EmptyView","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(e,t,r,i,s,n,a,o,c,l,d,h,u,S){"use strict";var m={BUYER:"buyer",SELLER:"seller",EMP:"emp"},p=t.extend({className:"mpf-order-card-body",setup:function(t){t||(t={}),this._parent(t),this._checkPrototypes(t),this.isSellerView=!0===t.isSellerView,this.serviceView=t.serviceView,this.cart=t.cart,this.invoiceFactory=t.invoiceFactory,this.service=e.is(t.service)?t.service:i.MAKE,this.stateMachine=this._createStateMachine(this.isSellerView),this.actorEntitiesTiles=this._createAppropriateActorEntitiesTiles(),this.statusDateTiles=this._createStatusDateTiles(),this.priceTile=this._createPriceTile()},render:function(){var t,r,i=[];return r=e.createElement("div",{class:"mpf-actors-container",html:this.actorEntitiesTiles.map(function(e){return e.render()})}),t=e.createElement("div",{class:"mpf-time-container",html:this.statusDateTiles.map(function(e){return e.render()})}),i.push(this.serviceView.render()),i.push(r),i.push(t),i.push(this.priceTile.render()),this.container.setContent(i),this},_createStatusDateTiles:function(){var e;return this.cart.getDeadlineDate()?(e=[new l({state:l.States.DEADLINE,cart:this.cart})],this.cart.getDeliveryDate()?e.push(new l({state:l.States.DELIVERY,cart:this.cart})):e.push(new l({state:l.States.CREATION,cart:this.cart}))):e=this.service===i.ENGINEERING?[new l({state:l.States.CREATION,cart:this.cart})]:this.service===i.STORE?[new d({state:d.States.PAID,cart:this.cart}),new d({state:d.States.DUE_DATE,cart:this.cart})]:[new l({state:l.States.DELIVERY,cart:this.cart}),new l({state:l.States.CREATION,cart:this.cart})],e},_createPriceTile:function(){return!this.cart.isTender()||this.cart.isTenderResponse()||this.cart.hasPrice()?new h({service:this.service,cart:this.cart,isSellerView:this.isSellerView,invoiceFactory:this.invoiceFactory}):new u({className:"mpf-price-tile"})},_createAppropriateActorEntitiesTiles:function(){var e,t,r=this.stateMachine.getState(),i=[];return this.cart.getNumberSellers()?(r===m.SELLER&&(e=new o({isSeller:!1,model:this.cart,state:r}),i.push(e)),t=new c({cart:this.cart}),i.push(t)):r===m.BUYER?(t=new o({isSeller:!0,model:this.cart,state:r}),i.push(t)):r===m.SELLER?(e=new o({isSeller:!1,model:this.cart,state:r}),i.push(e),t=new o({isSeller:!0,model:this.cart,state:r}),i.push(t)):r===m.EMP&&(e=new o({isSeller:!1,model:this.cart,state:r}),i.push(e),t=new o({isSeller:!0,model:this.cart,state:r}),i.push(t)),i},_createStateMachine:function(e){var t;return t=null!==window.location.search.match(/esid=/)?m.EMP:this.isSellerView?m.SELLER:m.BUYER,new s({state:t,states:[m.BUYER,m.SELLER,m.EMP],transitions:[]})},_checkPrototypes:function(e){r.requiredOfPrototype(e.cart,n,"options.cart must be a CartModel")}});return p.States=Object.freeze(m),p}),define("DS/MPFOrderListComponent/OrderCardHeader",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFServices/MarketplaceServices","DS/MPFCartModel/CartModel","DS/MPFOrderListComponent/OrderIdTile","DS/MPFOrderListComponent/LastUpdateTile","DS/MPFOrderListComponent/StatusProgressTile","DS/MPFOrderListComponent/RequestStatusTile","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(e,t,r,i,s,n,a,o,c,l){"use strict";return t.extend({className:"mpf-order-card-header",setup:function(t){t||(t={}),this._parent(t),this._checkPrototypes(t),this.cart=t.cart,this.service=e.is(t.service)?t.service:i.MAKE,this.orderIdTile=new n({cart:this.cart}),this.lastUpdateTile=new a({cart:this.cart}),this.cart.isTender()&&this.cart.getDeadlineDate()?this.statusProgressTile=new c({cart:this.cart}):this.statusProgressTile=new o({service:this.service,cart:this.cart})},render:function(){var e=[];return e.push(this.orderIdTile.render()),this.service!==i.STORE&&e.push(this.lastUpdateTile.render()),this.container.setContent([{tag:"div",class:"mpf-order-card-header-content",html:[{tag:"div",class:"mpf-left-column",html:e},{tag:"div",class:"mpf-right-column",html:this.statusProgressTile.render()}]}]),this},_checkPrototypes:function(e){r.requiredOfPrototype(e.cart,s,"options.cart must be a CartModel")}})}),define("DS/MPFOrderListComponent/OrderListCommandSort",["UWA/Class/View","DS/UIKIT/Input/Select","DS/MPFOrderListComponent/OrderListEvents","DS/MPFCartModel/CartSorts","DS/MPFSort/SortOrder","DS/MPFSort/SortDirection","DS/MPFSortSelector/SortSelector","DS/MPFServices/MarketplaceServices","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent"],function(e,t,r,i,s,n,a,o,c){"use strict";return e.extend({className:"mpf-order-list-command-sort",setup:function(e){e||(e={}),this.company=e.company,this.me=e.me,this.isSellerView=e.isSellerView,this.service=e.service,this.sortSelector=this._createSortSelector(),this.listenTo(this.sortSelector,a.Events.SORT,this._onSortSelected.bind(this))},render:function(){return this.container.setContent([this.sortSelector.render()]),this},destroy:function(){this.company=null,this.me=null,this.stopListening(this.sortSelector),this.sortSelector.destroy(),this.sortSelector=null,this._parent(),this.container=null},_createSortSelector:function(){return new a({entries:this._createSortOptions()})},_createSortOptions:function(){return this.isSellerView?this._createSortOptionForSeller():this.company&&this.me.isAdminOfThisEMP(this.company.getEmpProjectName())?this._createSortOptionsForEmpAdmin():this._createSortOptionForBuyer()},_onSortSelected:function(e){var t;t=e.direction===n.DESCENDING?i.desc(e.sort):e.sort,this.dispatchEvent(r.SORT,{sort:t})},_createSortOptionForBuyer:function(){var e;return e=[{label:c.get("modificationDate"),name:i.MODIFICATION_DATE,order:s.NUMERICAL,selected:n.DESCENDING},{label:c.get("creationDate"),name:i.CREATION_DATE,order:s.NUMERICAL},{label:c.get("serviceProvider"),name:i.SERVICE_PROVIDER}],this.service!==o.ENGINEERING&&e.splice(2,0,{label:c.get("deliveryDate"),name:i.DELIVERY_DATE,order:s.NUMERICAL}),e},_createSortOptionForSeller:function(){var e;return e=[{label:c.get("modificationDate"),name:i.MODIFICATION_DATE,order:s.NUMERICAL,selected:n.DESCENDING},{label:c.get("creationDate"),name:i.CREATION_DATE,order:s.NUMERICAL},{label:c.get("customer"),name:i.CUSTOMER}],this.service!==o.ENGINEERING&&e.splice(2,0,{label:c.get("deliveryDate"),name:i.DELIVERY_DATE,order:s.NUMERICAL}),e},_createSortOptionsForEmpAdmin:function(){var e;return e=[{label:c.get("modificationDate"),name:i.MODIFICATION_DATE,order:s.NUMERICAL,selected:n.DESCENDING},{label:c.get("creationDate"),name:i.CREATION_DATE,order:s.NUMERICAL},{label:c.get("customer"),name:i.CUSTOMER},{label:c.get("serviceProvider"),name:i.SERVICE_PROVIDER}],this.service!==o.ENGINEERING&&e.splice(2,0,{label:c.get("deliveryDate"),name:i.DELIVERY_DATE,order:s.NUMERICAL}),e}})}),define("DS/MPFOrderListComponent/OrderCard",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFServices/MarketplaceServices","DS/MPFCartModel/CartModel","DS/MPFPersonModel/PersonModel","DS/MPFOrderListComponent/OrderCardHeader","DS/MPFOrderListComponent/OrderCardBody","DS/PlatformAPI/PlatformAPI","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(e,t,r,i,s,n,a,o,c,l){"use strict";var d={REFRESH_CARD:"refreshCard"},h=t.extend({className:"mpf-order-card",domEvents:{click:"_goToOrder"},setup:function(t){t||(t={}),this._parent(t),this._checkPrototypes(t),this.isSellerView=!0===t.isSellerView,this.redirectToOrder=!1!==t.redirectToOrder,this.cart=t.cart,this.serviceView=t.serviceView,this.invoiceFactory=t.invoiceFactory,this.service=e.is(t.service)?t.service:i.MAKE,this.orderCardHeader=new a({isSellerView:this.isSellerView,service:this.service,cart:this.cart}),this.orderCardBody=new o({isSellerView:this.isSellerView,serviceView:this.serviceView,cart:this.cart,invoiceFactory:this.invoiceFactory,service:this.service}),this.orderCardFooter=t.orderCardFooter,this.listenTo(this.orderCardFooter,d.REFRESH_CARD,this._refreshCard.bind(this))},render:function(){var e;return e=[this.orderCardHeader.render(),this.orderCardBody.render(),this.orderCardFooter.render()],this.redirectToOrder||this.container.addClassName("no-cursor"),this.container.setContent(e),this},destroy:function(){this.stopListening(),this.serviceView&&e.is(this.serviceView.destroy,"function")&&this.serviceView.destroy(),this.orderCardFooter&&e.is(this.orderCardFooter.destroy,"function")&&this.orderCardFooter.destroy(),this.serviceView=null,this.cart=null,this.nda=null,this._parent(),this.container=null},_goToOrder:function(){c.publish("changePage",{name:"order",attributes:{id:this.cart.id}})},_checkPrototypes:function(e){r.requiredOfPrototype(e.cart,s,"options.cart must be a CartModel")},_refreshCard:function(e){e.cart&&this.cart.set(e.cart.pick(this.cart.keys())),this.render()}});return h.Events=Object.freeze(d),h}),define("DS/MPFOrderListComponent/OrderListCommands",["UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFExportOrderModel/ExportOrderFactory","DS/MPFBuyer/BuyerType","DS/MPFPersonModel/PersonModel","DS/MPFExportOrdersComponent/ExportOrdersComponent","DS/MPFView/EmptyView","DS/MPFOrderListComponent/OrderListCommandFilter","DS/MPFOrderListComponent/OrderListCommandSort","DS/MPFOrderListComponent/OrderListEvents"],function(e,t,r,i,s,n,a,o,c,l){"use strict";return e.extend({className:"mpf-order-list-commands",setup:function(e){t.requiredOfPrototype(e.buyerType,i,"options.buyerType must be a BuyerType"),t.requiredOfPrototype(e.me,s,"options.me must be a PersonModel"),t.requiredOfPrototype(e.exportOrderFactory,r,"options.exportOrderFactory must be an ExportOrderFactory"),this.buyerType=e.buyerType,this.me=e.me,this.company=e.company,this.exportOrderFactory=e.exportOrderFactory,this.isSellerView=!0===e.isSellerView,this.service=e.service,this.exportCommand=this._createExportCommand(),this.filterCommand=this._createFilterCommand(),this.sortCommand=this._createSortCommand(),this.listenTo(this.filterCommand,l.FILTER_BY_DATE,this._onFilterByDate.bind(this)),this.listenTo(this.sortCommand,l.SORT,this._onSort.bind(this))},render:function(){return this.container.setContent([this.exportCommand.render(),this.filterCommand.render(),this.sortCommand.render()]),this},destroy:function(){this.stopListening(this.filterCommand),this.stopListening(this.sortCommand),this.filterCommand.destroy(),this.filterCommand=null,this.sortCommand.destroy(),this.sortCommand=null,this._parent()},setFilterActive:function(e){this.filterCommand.setActive(e)},_createExportCommand:function(){return this.isSellerView?new a:new n({buyerType:this.buyerType,me:this.me,company:this.company,exportOrderFactory:this.exportOrderFactory})},_createFilterCommand:function(){return new o},_createSortCommand:function(){return new c({company:this.company,me:this.me,isSellerView:this.isSellerView,service:this.service})},_onFilterByDate:function(e){this.dispatchEvent(l.FILTER_BY_DATE,e)},_onSort:function(e){this.dispatchEvent(l.SORT,e)}})}),define("DS/MPFOrderListComponent/OrderListHeader",["UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFCartModel/CartCollection","DS/MPFExportOrderModel/ExportOrderFactory","DS/MPFBuyer/BuyerType","DS/MPFPersonModel/PersonModel","DS/MPFOrderListComponent/StatusSelectorTile","DS/MPFOrderListComponent/OrderListCommands","DS/MPFOrderListComponent/OrderListEvents"],function(e,t,r,i,s,n,a,o,c){"use strict";return e.extend({className:"mpf-order-list-header",setup:function(e){e||(e={}),t.requiredOfPrototype(e.carts,r,"options.carts must be a CartCollection"),t.requiredOfPrototype(e.buyerType,s,"options.buyerType must be a BuyerType"),t.requiredOfPrototype(e.me,n,"options.me must be a PersonModel"),t.requiredOfPrototype(e.exportOrderFactory,i,"options.exportOrderFactory must be an ExportOrderFactory"),this.carts=e.carts,this.buyerType=e.buyerType,this.me=e.me,this.company=e.company,this.exportOrderFactory=e.exportOrderFactory,this.isSellerView=!0===e.isSellerView,this.service=e.service,this.statusSelectorTile=this._createStatusSelectorTile(e.statusSelectorInitValue),this.commands=this._createCommands(),this.stateFilter="all",this.listenTo(this.statusSelectorTile,c.FILTER_BY_STATE,this._onFilterByState.bind(this)),this.listenTo(this.commands,c.FILTER_BY_DATE,this._onFilterByDate.bind(this)),this.listenTo(this.commands,c.SORT,this._onSort.bind(this))},render:function(){return this.container.setContent([this.statusSelectorTile.render(),this.commands.render()]),this},destroy:function(){this.stopListening(this.statusSelectorTile),this.stopListening(this.commands),this.statusSelectorTile.destroy(),this.statusSelectorTile=null,this.commands.destroy(),this.commands=null,this._parent()},setFilterActive:function(e){this.commands.setFilterActive(e)},_createStatusSelectorTile:function(e){return new a({carts:this.carts,statusSelectorInitValue:e,service:this.service})},_createCommands:function(){return new o({buyerType:this.buyerType,me:this.me,company:this.company,exportOrderFactory:this.exportOrderFactory,isSellerView:this.isSellerView,service:this.service})},_onFilterByState:function(e){this.dispatchEvent(c.FILTER_BY_STATE,e)},_onFilterByDate:function(e){this.dispatchEvent(c.FILTER_BY_DATE,e)},_onSort:function(e){this.dispatchEvent(c.SORT,e)}})}),define("DS/MPFOrderListComponent/OrderListPage",["UWA/Core","UWA/Class/View","DS/UIKIT/Mask","DS/PlatformAPI/PlatformAPI","DS/MPFServices/MarketplaceServices","DS/MPFCartModel/CartCollection","DS/MPFCartModel/CartFilters","DS/MPFCartModel/CartSorts","DS/MPFExportOrderModel/ExportOrderFactory","DS/MPFBuyer/Buyer","DS/MPFBuyer/BuyerType","DS/MPFPersonModel/PersonModel","DS/MPFServices/ObjectService","DS/MPFOrderListComponent/OrderListHeader","DS/MPFOrderListComponent/OrderCard","DS/MPFPaginationComponent/PaginationComponent","DS/MPFOrderListComponent/OrderListEvents","DS/MPFView/EmptyView","DS/MPFUtils/MPFUtils","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent"],function(e,t,r,i,s,n,a,o,c,l,d,h,u,S,m,p,E,D,C,T){"use strict";var _;return(_=t.extend({className:"mpf-order-list-page",setup:function(t){u.requiredOfPrototype(t.carts,n,"options.carts must be a CartCollection"),u.requiredOfPrototype(t.me,h,"options.me must be a PersonModel"),u.requiredOfPrototype(t.exportOrderFactory,c,"options.exportOrderFactory must be an ExportOrderFactory"),this.isSellerView=!0===t.isSellerView,this.redirectToOrder=!1!==t.redirectToOrder,this.carts=t.carts,this.buyerType=t.buyerType,this.me=t.me,this.legalEntityId=t.legalEntityId,this.company=t.company,this.invoiceFactory=t.invoiceFactory,this.exportOrderFactory=t.exportOrderFactory,this.serviceViewFactory="function"==typeof t.serviceViewFactory?t.serviceViewFactory:C.doNothing,this.orderCardFooterFactory="function"==typeof t.orderCardFooterFactory?t.orderCardFooterFactory:C.doNothing,this.service=e.is(t.service)?t.service:s.MAKE,this.statusSelectorInitValue=e.is(t.statusSelectorInitValue)?t.statusSelectorInitValue:a.STATE_PENDING_FILTER,this.header=this._createHeader(),this.pagination=this._createPagination(),this.fetchOptions={reset:!0,start:0,size:10,company:this.legalEntityId},this.fetchOptions[a.FILTER_BY_STATE]=this.statusSelectorInitValue,this.listenTo(this.header,E.FILTER_BY_STATE,this._onFilterByState.bind(this)),this.listenTo(this.header,E.FILTER_BY_DATE,this._onFilterByDate.bind(this)),this.listenTo(this.header,E.SORT,this._onSort.bind(this)),this.listenTo(this.pagination,p.Events.CHANGE_PAGE,this._onChangePage.bind(this)),i.subscribe("SearchBar/search",this._onTopBarSearch.bind(this)),i.subscribe("SearchBar/clear",this._onTopBarClear.bind(this))},render:function(){var e;return this.carts.isEmpty()?e=[this._createEmptyListMessage()]:(e=this._createOrderCards().map(function(e){return e.render()})).push(this.pagination.render()),e.unshift(this.header.render()),this.container.setContent(e),this},destroy:function(){this.stopListening(this.header),this.stopListening(this.pagination),i.unsubscribe("SearchBar/search"),i.unsubscribe("SearchBar/clear"),this.header.destroy(),this.header=null,this.pagination.destroy(),this.pagination=null,this.carts=null,this.me=null,this._parent(),this.container=null},refresh:function(){return this._refreshCarts()},_createHeader:function(){return new S({carts:this.carts,buyerType:this.buyerType,me:this.me,company:this.company,exportOrderFactory:this.exportOrderFactory,isSellerView:this.isSellerView,statusSelectorInitValue:this.statusSelectorInitValue,service:this.service})},_createEmptyListMessage:function(){return e.createElement("div",{class:"mpf-message",html:[{tag:"i",class:"fonticon fonticon-doc-log"},{tag:"h4",text:T.get("orderListEmpty")},{tag:"p",text:T.get("noOrdersMatchingSearchCriteria")}]})},_createOrderCards:function(){return this.carts.map(function(e){var t,r;return t=this.serviceViewFactory({cart:e}),r=this.orderCardFooterFactory({cart:e}),new m({isSellerView:this.isSellerView,cart:e,serviceView:t||D.getInstance(),orderCardFooter:r||D.getInstance(),invoiceFactory:this.invoiceFactory,service:this.service,redirectToOrder:this.redirectToOrder})},this)},_createPagination:function(){return new p({collection:this.carts,pageSize:10})},_refreshCarts:function(){return r.mask(this.container),this.carts.fetchPromise(e.clone(this.fetchOptions)).then(this.render.bind(this)).finally(r.unmask.bind(null,this.container))},_onFilterByState:function(e){this._resetPage(),this.fetchOptions[a.FILTER_BY_STATE]=e[a.FILTER_BY_STATE],i.publish("MPF_ORDER_LIST",{filter:a.FILTER_BY_STATE,value:e[a.FILTER_BY_STATE]}),this._refreshCarts()},_onFilterByDate:function(e){switch(this._resetPage(),e.filter){case a.FILTER_BY_CREATION_DATE_DAYS:this._resetDateFilter(),this.fetchOptions[a.FILTER_BY_CREATION_DATE_DAYS]=e.days,this.header.setFilterActive(!0);break;case a.FILTER_BY_CREATION_DATE_MONTHS:this._resetDateFilter(),this.fetchOptions[a.FILTER_BY_CREATION_DATE_MONTHS]=e.months,this.header.setFilterActive(!0);break;case a.FILTER_BY_MODIFICATION_DATE_DAYS:this._resetDateFilter(),this.fetchOptions[a.FILTER_BY_MODIFICATION_DATE_DAYS]=e.days,this.header.setFilterActive(!0);break;case a.FILTER_BY_MODIFICATION_DATE_MONTHS:this._resetDateFilter(),this.fetchOptions[a.FILTER_BY_MODIFICATION_DATE_MONTHS]=e.months,this.header.setFilterActive(!0);break;case a.CLEAR:this._resetDateFilter(),this.header.setFilterActive(!1)}this._refreshCarts()},_resetDateFilter:function(){this.header.setFilterActive(!1),this.fetchOptions[a.FILTER_BY_CREATION_DATE_MONTHS]=null,this.fetchOptions[a.FILTER_BY_CREATION_DATE_DAYS]=null,this.fetchOptions[a.FILTER_BY_MODIFICATION_DATE_DAYS]=null,this.fetchOptions[a.FILTER_BY_MODIFICATION_DATE_MONTHS]=null},_onSort:function(e){this._resetPage(),e&&e.sort?this.fetchOptions[o.SORT]=e.sort:this.fetchOptions[o.SORT]=null,this._refreshCarts()},_onChangePage:function(e){var t;e||(e={}),t=e.page||1,this.fetchOptions.start=10*(t-1),this.header.container.scrollIntoView(!1),this._refreshCarts()},_resetPage:function(){this.pagination.changePage(1,{silent:!0}),this.fetchOptions.start=0},_onTopBarSearch:function(e){this._resetPage(),this.fetchOptions.search=e,this._refreshCarts()},_onTopBarClear:function(){this._resetPage(),this.fetchOptions.search="",this._refreshCarts()}})).ORDER_PER_PAGE=10,_.TOPIC="MPF_ORDER_LIST",_}),define("DS/MPFOrderListComponent/OrderListPageFactory",["UWA/Promise","DS/MPFOrderListComponent/OrderListPage","DS/MPFDataProxy/MarketplaceConnector","DS/MPFModelFactory/MPFFactoriesV2","DS/MPFCartModel/CartFactory","DS/MPFPersonModel/PersonFactory","DS/MPFCompanyModel/CompanyFactory","DS/MPFCartModel/CartModel","DS/MPFCartModel/CartFilters","DS/MPFModel/CollectionFetchOptions","DS/MPFBuyer/Buyer","DS/MPFBuyer/BuyerType"],function(e,t,r,i,s,n,a,o,c,l,d,h){"use strict";function u(t){var r;return r=i.getInstance(t),e.all([r.getFactory(i.Types.CART),r.getFactory(i.Types.PERSON),r.getFactory(i.Types.EXPORT_ORDER)])}function S(t){var r;return r=i.getInstance(t),e.all([r.getFactory(i.Types.CART),r.getFactory(i.Types.PERSON),r.getFactory(i.Types.EXPORT_ORDER),r.getFactory(i.Types.INVOICE)])}function m(r,i){var n=i[0],a=i[1],h=i[2];return e.all([function(e,r){var i,n=e.createCollection(s.Types.ME_V2);return(i={expand:[o.Expands.CART_ITEMS],start:0,size:t.ORDER_PER_PAGE})[c.FILTER_BY_STATE]=c.STATE_PENDING_FILTER,i[l.COMPANY]=r,n.fetchPromise(i)}(n,r),E(a),h]).then(function(t){var r=t[0],i=t[1],s=t[2];return e.all([r,i,s,d.fromPerson(i),!1])})}function p(r,i){var n=i[0],a=i[1],l=i[2],h=i[3];return e.all([function(e,r){var i,n=r.createCollection(s.Types.SELLER_CARTV2);return n.setParentResourceId(e),(i={expand:[o.Expands.CART_ITEMS],start:0,size:t.ORDER_PER_PAGE})[c.FILTER_BY_STATE]=c.STATE_PENDING_FILTER,n.fetchPromise(i)}(r,n),E(a),l]).then(function(t){var r=t[0],i=t[1],s=t[2];return e.all([r,i,s,d.fromPerson(i),!0,h])})}function E(e){return e.createModel(n.Types.ME).fetchPromise()}function D(e,r){var i,s,n=r[0],a=r[1],o=r[2],c=r[3],l=r[4],d=r[5];return i=c.getBuyerType(),s={service:e.service,carts:n,me:a,buyerType:i,exportOrderFactory:o,serviceViewFactory:e.serviceViewFactory,orderCardFooterFactory:e.orderCardFooterFactory,isSellerView:l,invoiceFactory:d,legalEntityId:e.legalEntityId},i===h.COMPANY&&(s.company=c.getModel()),new t(s)}return{fromMeBuyer:function(e){var t;return e||(e={}),t={service:e.service,serviceViewFactory:e.serviceViewFactory,orderCardFooterFactory:e.orderCardFooterFactory,legalEntityId:e.legalEntityId},r.fetchPromise(e).then(u).then(m.bind(null,e.legalEntityId)).then(D.bind(null,t))},fromSeller:function(e){var t,i;return i={service:e.service,serviceViewFactory:e.serviceViewFactory,orderCardFooterFactory:e.orderCardFooterFactory},e||(e={}),t=e.shopId,r.fetchPromise(e).then(S).then(p.bind(null,t)).then(D.bind(null,i))}}});