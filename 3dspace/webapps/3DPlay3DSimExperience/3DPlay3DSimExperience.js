/*!  Copyright 2020 Dassault Systemes. All rights reserved. */
define("DS/3DPlay3DSimExperience/3DPlay3DSimExperience",["UWA/Core","DS/CoreEvents/Events","DS/WebSystem/Environment","DS/WebUtils/ContextedSingleton","DS/3DPlayCommonSimulation/3DPlayCommonSimulation"],function(e,i,t,a,n){"use strict";var o=n.extend({_postCreateSequenceCallback:function(e){if(this._parent(e),e.annotations){var i=a.get(this.ctx,"ANNOTATION_MANAGER");if(!i){require(["DS/3DPlayAnnotation3D/AnnotationManager"],function(t){i=new t({frameWindow:this.frmWindow,context:this.ctx}),a.add(this.ctx,"ANNOTATION_MANAGER",i),i.drawAnnotationsFromJSON(e.annotations)}.bind(this))}}var n=t.isSet("3DPlay.Allow_3dsim_toOrigin");if(n){require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(e){e.getGrantedRoles(function(e){if(n=!!e&&void 0!==e.find(function(e){return"CSV"===e.id})){var i={id:"CATSPYOpenFrom3DSpaceCmdHdr",rsc:"SPYUI/SimulationPlayer"};this.args.mabModel.speeddial.splice(1,0,i),this.args.tabletMabModel.speeddial.splice(1,0,i);var t=globalThis&&globalThis.widget.body.offsetWidth>=800&&this.args.tabletMabModelmabModel?this.args.tabletMabModel:this.args.mabModel;this.loadWorkbench({name:"3DSimPlayer",module:"3DPlay3DSimExperience"},!1,t)}}.bind(this))}.bind(this))}},_manageContextualMenu:function(){},onPostCreate:function(){this._parent(),this.frmWindow.getViewer().setVisuEnv("None")},init:function(i){this._parent(i);this.args=e.extend(this.args,{workbenchs:[{name:"3DSimPlayerNoReturn",module:"3DPlay3DSimExperience"}]},!0),this._removeAmbiancesFromMab(),this.args.mabModel.speeddial.splice(1,2);var t={id:"CATSPYHideShowLegendCmdHdr",rsc:"SPYUI/SimulationPlayer"};this.args.mabModel.speeddial.splice(1,0,t),this._removeHeaderFromMabSections("CATSPYHideShowLegendCmdHdr"),this.args.tabletMabModel.speeddial.splice(1,1),this.args.tabletMabModel.speeddial.splice(4,1),this.dataFactoryPath="DS/SPY/CATSimNavData3DSimFactory"}});return e.namespace("DS/3DPlay3DSimExperience/3DPlay3DSimExperience",o)});