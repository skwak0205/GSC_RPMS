define("DS/WebExtensionServers/WebExtensionServer",["UWA/Class"],function(e){"use strict";return e.extend({init:function(e){this._extensionTable={},this._interfaceTable={},this._componentTable={}},_require:function(e){var t=UWA.Promise.deferred();return require([e],e=>{t.resolve(e)},e=>{t.reject(e)}),t.promise},DeclareDictionary:function(e){var t=null,n=()=>{for(var e=(e,t)=>Promise.race([e,UWA.Promise.resolve({myTestFunction:!0})]).then(e=>{e&&e.myTestFunction&&console.warn(Object.keys(this.requireToLoad)[t]+" still pending")}).catch(e=>{console.error(new Error("Can't load "+Object.keys(this.requireToLoad)[t]))}),r=0;r<this.requirePromises.length;r++)e(this.requirePromises[r],r);t=setTimeout(n,1e3)};return UWA.Promise.resolve().then(()=>{var r=[];return Object.keys(e.interfaces).forEach(t=>{r.push(this._require(e.interfaces[t]).then(e=>(this.AddInterface(t,e),t)))}),this.requireToLoad=e.interfaces,this.requirePromises=r,t=setTimeout(n,1e3),UWA.Promise.allSettled(r)}).then(r=>{r.forEach(e=>{"fullfilled"!==e.state&&console.warn(new Error("Unable to load "+e.value))}),t&&(clearTimeout(t),t=null);var i=[];return Object.keys(e.components).forEach(t=>{i.push(this._require(e.components[t]).then(e=>(this.AddComponent(t,e),t)))}),this.requireToLoad=e.components,this.requirePromises=i,t=setTimeout(n,1e3),UWA.Promise.allSettled(i)}).then(r=>{r.forEach(e=>{"fullfilled"!==e.state&&console.warn(new Error("Unable to load "+e.value))}),t&&(clearTimeout(t),t=null);var i=[];return Object.keys(e.extensions).forEach(t=>{Object.keys(e.extensions[t]).forEach(n=>{i.push(this._require(e.extensions[t][n]).then(e=>(e.GetOrigin=(()=>e),this.AddExtension(t,n,e),t+":"+n)))})}),this.requireToLoad=e.extensions,this.requirePromises=i,t=setTimeout(n,1e3),UWA.Promise.allSettled(i)}).then(e=>(e.forEach(e=>{"fullfilled"!==e.state&&console.warn(new Error("Unable to load "+e.value))}),t&&(clearTimeout(t),t=null),this))},AddExtension:function(e,t,n){var r=this._extensionTable[e];r?void 0===r[t]?(r[t]=n,this._extensionTable[e]=r):console.warn("trying to override existing extension"):((r={})[t]=n,this._extensionTable[e]=r)},AddInterface:function(e,t){void 0===this._interfaceTable[e]&&(this._interfaceTable[e]=t)},AddComponent:function(e,t){void 0===this._componentTable[e]&&(this._componentTable[e]=t)},GetExtension:function(e,t){var n=this._extensionTable[e];if(n)return n[t]},GetInterface:function(e){return this._interfaceTable[e]},GetComponent:function(e){return this._componentTable[e]}})});