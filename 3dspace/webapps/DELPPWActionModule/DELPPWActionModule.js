define("DS/DELPPWActionModule/ActionViewUI",["UWA/Core"],function(e){"use strict";return function(t,n,o,i,a){var r,c,l,d,s=i.getComponent("WUXDockAreaEnum"),u=i.getComponent("WUXFrameWindowsManager").getFrameWindow(t.getAppContext()).getImmersiveFrame();return r=function(r,u){var g=t.getElement(),h=i.createElement("div",{class:"tree-list-container"}),f=e.is(a)?a.getIconURLFromKey(u):"";h.inject(g),d=a.getNLSValue("View."+r+".Title")||"",n.loadDocument(o.getWUXNodeModel()),n.getContent().inject(h),(c=i.create("Panel",{position:{at:"right"},minWidth:300,minHeight:250,height:250,title:d,icon:f,side:s.RightDockArea,currentDockArea:s.RightDockArea,identifier:"panel-"+l,content:g,resizableFlag:!0,closeButtonFlag:!0,useBordersFlag:!0,visibleFlag:!1,collapsibleFlag:!0,verticallyStretchableFlag:!1})).close=function(){e.is(l)?t.notify("toggleCmdCheckHeaderState",{cmdName:l,cmdState:!1}):c.hide()}},{init:function(n,o,i){e.is(n,"string")?(l=n,r(o,i)):t.debug("ActionViewUI","Command name is not defined to create action UI.")},destroy:function(){o.emptyNodeModel(),e.is(c)&&(c.destroy(),c=void 0)},toggle:function(t){var n;t.state&&!c.visibleFlag?(c.immersiveFrame=u,n=u.getDockingElement(c.currentDockArea),e.is(n)&&(n.collapseDockingZoneFlag=!1),c.show()):c.hide()},updateTitle:function(t){e.is(t)&&""!==t?c.title=d+" - "+t:c.title=d}}}}),define("DS/DELPPWActionModule/ActionModule",["UWA/Core","DS/DELPPWActionModule/ActionViewUI"],function(e,t){"use strict";return{behaviors:["TreeListViewBehavior","WUXNodeModelBehavior","UXFactoryBehavior","LinkBehavior","CapableResourceLinkBehaviour","ModelBehavior","SelectionBehavior","SearchBehavior","ResourceBehavior","ViewBehavior","TaggerBehavior","ImplementBehavior"],creator:function(n,o,i,a,r,c,l,d,s,u,g,h){var f,m,v,p=[],C=[],A=null,S=function(t){return!(!e.is(t)||!e.is(t.get))&&C.indexOf(t.get("type"))>-1},R=function(){return p.indexOf("PROCESS")>-1},B=function(t){var i={action:[],parameters:[]};e.is(t,"array")&&t.length>0?(t.forEach(function(e,t){i.action[t]="addRoot",i.parameters[t]={rootReferencePID:e.id}}),o.processDropEffect(i)):n.debug("No search results")},I=function(){var t,o,a=d.getSelections();i.emptyNodeModel(),e.is(a,"array")&&1===a[1].length?(o=a[1][0],e.is(o)?(A=o,t=l.getReferenceModel(o),e.is(t)?(m.updateTitle(t.get("V_Name")),r.getConnectionsByModel(t,null,{silentMode:!0,onComplete:function(n){var o;e.is(A)&&Array.isArray(n)&&n.length>0&&(i.prepareUpdate(),n.forEach(function(n){S(n)&&n.get("from")===t.get("PID")&&(o=l.getReference(n.get("to")),e.is(o)&&(i.isNodeAdded(o.get("PID"))||i.addNode(o,{loadChildren:!1})))}),i.pushUpdate())}})):n.debug("Reference Model is empty for PID:"+o)):n.debug("No selection in mbom to load action view data.")):(A=null,m.updateTitle(""))};return{listenTo:function(){return{changeReference:this.onChangeIRPC,addConnection:this.onAddConnection,changeConnection:this.onChangeIRPC,removeConnection:this.onRemoveConnection,select:this.relaodUI,AlternateBL:this.onAlternateBL,CapableResourceBL:this.onCapableResourceBL,ActionRemove:this.onActionRemove,SearchAndAddCommand:this.onSearchAndAddCommand,refreshImpacted:this.relaodUI}},onStart:function(e){var r;p=(e=e||{}).pprTypes,C=e.linkTypes,f=e.relatedCmdId,v=e.moduleIcon,r=u.getNLSValue(f),(m=new t(n,o,i,a,u)).init(f,r,v),m.toggle({state:!0}),I()},onStop:function(){e.is(m)&&(m.destroy(),m=void 0),A=null},onBLCommands:function(t,n,o){var i,a=d.getSelections();e.is(a,"array")&&a.length>0&&1===a[1].length&&(i={url:t,method:"POST",context:this,onComplete:n,onFailure:o,data:e.Json.encode({pid:a[1]})},r.webServiceRequest(i))},onAlternateBL:function(){var e=this;e.onBLCommands("dsmfg/private/V0/invoke/getalternatefrombl",function(t){0===t.referenceIDS.length?n.warn(u.getNLSValue("AlternateBL.Info.Empty")):s.activate("Alternate search",B.bind(e),[],t.referenceIDS)},function(e){n.debug(e),n.warn(u.getNLSValue("AlternateBL.Error.Failure"))})},onCapableResourceBL:function(){var e=this;e.onBLCommands("dsmfg/private/V0/invoke/getResourcesFromBL",function(t){0===t.resourceIDS.length?n.warn(u.getNLSValue("CapableResourceBL.Info.Empty")):s.activate("Capable resource search",B.bind(e),[],t.resourceIDS)},function(e){n.debug(e),n.warn(u.getNLSValue("CapableResourceBL.Error.Failure"))})},onSearchAndAddCommand:function(){R()?s.activate(u.getNLSValue("InContextSearch.MBOM.Title"),B.bind(this)):p.indexOf("RESOURCE")>-1&&s.activate(u.getNLSValue("InContextSearch.EBOM.Title"),B.bind(this))},onActionRemove:function(){var t,o,i=d.getSelections();e.is(i,"array")&&i[0].length>0&&e.is(1===i[1].length)&&(o=l.getReferenceModel(i[1]),r.getConnectionsByModel(o,null,{onComplete:function(n){if(e.is(n,"array")&&n.length>0)for(t=0;t<i[0].length;t++)n.forEach(function(e){e.get("to")===i[0][t]&&r.deleteConnection(e.get("PID"))})},onFailure:function(){n.debug("Getting connections failed")}}))},onChangeIRPC:function(t){var n;t=Array.isArray(t)?t:[t],n=d.getSelections(),e.is(n,"array")&&n.length>0&&1===n[1].length&&i.withTransactionUpdate(function(){t.forEach(function(e){R()&&i.updateAttributes(e)})})},onAddConnection:function(t){var n=function(t){var n,o,a,r;S(t)&&(a=t.get("to"),n=d.getSelections(),e.is(n,"array")&&1===n[1].length&&(o=l.getReferenceModel(n[1][0]),e.is(o)&&o.get("PID")!==a&&(r=l.getReferenceModel(a),e.is(r)&&(i.isNodeAdded(r.get("PID"))||i.addNode(r,{loadChildren:!1})))))};e.is(t,"array")?t.forEach(function(e){n(e)}):n(t)},onRemoveConnection:function(t){var n=[],o=function(t){var o,i=t.get("to");S(t)&&(o=l.getReferenceModel(i),e.is(o)&&n.push(o.get("PID")))};i.withTransactionUpdate(function(){e.is(t,"array")?t.forEach(function(e){o(e)}):o(t),n.length>0&&i.removeNodes(n)})},relaodUI:function(t){e.is(t)&&I()}}}}});