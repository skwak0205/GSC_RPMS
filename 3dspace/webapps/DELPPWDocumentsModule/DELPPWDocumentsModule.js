define("DS/DELPPWDocumentsModule/DocumentsUIInfra",[],function(){"use strict";return function(e,t,n){return{buildDialog:function(o){var i,l=t.getComponent("WUXFrameWindowsManager").getFrameWindow(e.getAppContext());return i=t.create("Dialog",{domId:"DocumentMgmtUI-Dialog",horizontallyStretchableFlag:!0,immersiveFrame:l.getImmersiveFrame(),modalFlag:!0,visibleFlag:!1,resizableFlag:!0,snappableFlag:!1,title:o.title,content:o.body,buttons:{Ok:t.create("Button",{className:"ok primary",label:UWA.is(o.okBtn)&&UWA.is(o.okBtn.Title)?o.okBtn.Title:n.getNLSValue("DocumentMgmtUI.Attach"),emphasize:"primary",visibleFlag:!!UWA.is(o.okBtn),onClick:function(){UWA.is(o.okBtn.onClick,"function")&&o.okBtn.onClick()}}),Cancel:t.create("Button",{className:"cancel",label:UWA.is(o.cancelBtn)&&UWA.is(o.cancelBtn.Title)?o.cancelBtn.Title:n.getNLSValue("DocumentMgmtUI.Cancel"),visibleFlag:!!UWA.is(o.cancelBtn),onClick:function(){UWA.is(o.cancelBtn.onClick,"function")&&(i.destroy(),o.cancelBtn.onClick())}})}})}}}}),define("DS/DELPPWDocumentsModule/DocumentsMgmtUI",["UWA/Core","DS/DELPPWDocumentsModule/DocumentsUIInfra"],function(e,t){"use strict";return function(n,o,i,l,c){var a,u,s,r,d,m,g,D,f,h,p,U,v,b,I,S=[],y=[],C=i.getFileCommands(),M=new t(n,l,c);return v=function(t){var n,o=this,i=t.cellView.getContent(),a=t.cellModel.getCellContent();if(!t.isHeader&&e.is(a,"array")&&a.length>0)return n=e.createElement("div",{class:"commandsDiv"}),a.forEach(function(i){var a;e.is(o[i])&&((a=l.create("Button",{icon:{iconName:o[i].icon,fontIconFamily:WUXManagedFontIcons.Font3DS},className:"link",displayStyle:"icon",onClick:o[i].callback.bind(t.nodeModel)})).tooltipInfos=l.create("TooltipModel",{shortHelp:c.getNLSValue("DocumentMgmtUI.ToolTip.Command."+i)}),a.inject(n))}),setTimeout(function(){i.setAttribute("title","")},0),i.setContent(n),n},U=function(e){var t,n=e.cellView.getContent(),o=e.cellModel.getCellContent();if(!e.isHeader)return t=l.create("Editor",{value:o,disabled:!0}),n.setContent(t),t},p=function(t){var n,o=t.nodeModel.options.grid[t.dataIndex],i=e.is(o,"number")?1e3*o:o;return e.is(i)&&(n=new Date(i)),n},h=function(){var e,t;return e=function(e){return(e=e.isRoot(!0)?e:e.getParent()).options.grid.documentID},t=function(e){if(!e.isRoot(!0))return e.options.grid.documentID},{Download:{icon:"download",callback:function(){i.downloadDocument(e(this))}},Update:{icon:"plus",callback:function(){var t={id:e(this)};o.buildUpdateDocUI(t.id,function(e){i.attachFile(t,e)})}},Delete:{icon:"wrong",callback:function(){i.deleteDocument(u,e(this))}},Explore:{icon:"compass",callback:function(){n.notify("ExploreInWebApp",[[{documentPID:e(this)}]])}},DownloadFile:{icon:"download",callback:function(){i.downloadFile(e(this),t(this),this.options.label)}},ModifyFile:{icon:"upload",callback:function(){var n={id:e(this)},l=t(this),c=this.options.label;o.buildUpdateFileUI(n.id,function(e){e.id=l,i.modifyFile(n,e,c)})}},RemoveFile:{icon:"wrong",callback:function(){i.removeFile(e(this),t(this))}},ViewFile:{icon:"eye",callback:function(){i.viewFile(e(this),t(this),this.options.label)}}}},m=function(e){var t={showVerticalLines:!0,isSortable:!1,isDraggable:!1,isEditable:!1,apiVersion:2,height:"auto",defaultCellHeight:40,selection:{nodes:!1,cells:!1,canMultiSelect:!1,columnHeaders:!1,rowHeaders:!1},resize:{columns:!0,rows:!1},shouldDisplayTooltip:function(e){var t,n={longHelp:""};if(!e.isHeader)switch(t=e.cellModel.options.value,e.dataIndex){case"tree":n.longHelp=t.getLabel();break;case"file_desc":case"policy":case"creationDate":n.longHelp=t}return n}};return t.columns=[{dataIndex:"documentId",width:0,isHidden:!0},{text:c.getNLSValue("DocumentMgmtUI.FileName"),dataIndex:"tree",width:"20%"},{text:c.getNLSValue("DocumentMgmtUI.Commands"),dataIndex:"commands",width:"25%",isColumnMovable:!1,onCellRequest:v.bind(e)},{text:c.getNLSValue("DocumentMgmtUI.Description"),dataIndex:"file_desc",width:"20%",isColumnMovable:!1,onCellRequest:U},{text:c.getNLSValue("DocumentMgmtUI.DocPolicy"),dataIndex:"policy",isEditable:!1,width:"15%",isColumnMovable:!1},{text:c.getNLSValue("DocumentMgmtUI.FileDate"),dataIndex:"creationDate",isEditable:!1,typeRepresentation:"datetime",width:"20%",isColumnMovable:!1,getValue:p}],l.create("TreeListView",t)},g=function(e){var t=a.getDocument().search({match:function(t){if(t.nodeModel.options.grid.documentID===e)return!0}});return 1===t.length?t[0]:null},D=function(t){var n,o=g(t.id);e.is(o)&&(n=o.isExpanded(),o.removeChildren(),I(o,t.get("relateddata").files),n&&o.expand())},f=function(t){var n=g(t);e.is(n)&&n.remove()},I=function(e,t){var n;t.forEach(function(t){n=l.create("TreeNodeModel",{label:t.dataelements.title,grid:{documentID:t.id,commands:y,file_desc:t.dataelements.comments,creationDate:t.dataelements.created}}),e.addChild(n)})},b=function(t){var n,o,i,c;for(t=e.is(t,"array")?t:[t],n=0;n<t.length;n++)o=(c=t[n]).get("relateddata").files,i=l.create("TreeNodeModel",{label:c.get("dataelements").title,grid:{documentID:c.get("id"),commands:S,file_desc:c.get("dataelements").description,policy:c.get("dataelements").policy,creationDate:c.get("dataelements").originated}}),I(i,o),a.addRoot(i)},d=function(e){return a=m(h()),b(e),a},r=function(){var t,n;return n=e.createElement("div",{class:"dialogBody"}),l.create("WUXLoader",{text:c.getNLSValue("loading")}).inject(n).on(),(t=M.buildDialog({title:c.getNLSValue("DocumentMgmtUI.ManageDocs"),body:n,okBtn:{Title:c.getNLSValue("Dialog.Ok"),onClick:function(){t.destroy()}}})).show(),t},{buildDocMgmtUI:function(t,n){if(!e.is(t))throw new Error("Valid Reference ID is not provided");u=t,S=(n=n||!1)?C.document.authoring:C.document.nonAuthoring,y=n?C.file.authoring:C.file.nonAuthoring,s=r(),i.fetchDocuments(t,function(t){e.is(s)&&s.content.setContent(d(t))})},onAddConnection:function(t){var n,o;if(o=function(t){e.is(s)&&u===t.get("from")&&b(i.getDocument(t.get("to")))},e.is(t,"array"))for(n=0;n<t.length;n++)o(t[n]);else o(t)},onRemoveConnection:function(t){e.is(s)&&u===t.get("from")&&f(t.get("to"))},onChangeDocument:function(t){e.is(s)&&D(t)}}}}),define("DS/DELPPWDocumentsModule/DocumentsUploadUI",["DS/DELPPWDocumentsModule/DocumentsUIInfra"],function(e){"use strict";return function(t,n,o,i){var l,c,a,u=new e(t,o,i);return a=function(e,t,n){var i=o.create("Element","input",{attributes:{type:"file",accept:"*.*"},styles:{display:"none"},events:{change:n}});i.multiple=t,i.inject(e),i.click()},c=function(e,t){var n,l,c,u,s,r,d,m=[];if(t=UWA.merge(t||{},{multiSelection:!0}),UWA.is(t.docPolicy))m.push({selected:!0,value:t.docPolicy,label:i.getNLSValue(t.docPolicy)});else{if(!(UWA.is(t.docPolicies,"array")&&t.docPolicies.length>0))return(l=o.create("Element","div",{class:"documentDlgErrorDiv"})).setText(i.getNLSValue("DocumentMgmtUI.NoDocPolicesAvailable")),void l.inject(e);t.docPolicies.forEach(function(e){m.push({value:e,label:i.getNLSValue(e)})})}return n=[{type:"text",name:"DocumentTitle",required:!0,label:i.getNLSValue("DocumentMgmtUI.DocumentTitle"),placeholder:i.getNLSValue("DocumentMgmtUI.DocTitlePlaceholder"),disabled:!!UWA.is(t.docTitle),value:UWA.is(t.docTitle)?t.docTitle:null},{type:"text",name:"DocDescription",multiline:"true",label:i.getNLSValue("DocumentMgmtUI.DocDescription"),placeholder:i.getNLSValue("DocumentMgmtUI.DocDescPlaceholder"),disabled:!!UWA.is(t.docDescription),value:UWA.is(t.docDescription)?t.docDescription:null},{type:"select",name:"DocPolicy",required:!0,label:i.getNLSValue("DocumentMgmtUI.DocPolicy"),placeholder:i.getNLSValue("DocumentMgmtUI.DocPolicyPlaceholder"),options:m,disabled:!!UWA.is(t.docPolicy)}],r={name:"chooseFiles",value:t.multiSelection?i.getNLSValue("DocumentMgmtUI.ChooseFiles"):i.getNLSValue("DocumentMgmtUI.ChooseFile"),action:function(){a(e,t.multiSelection,function(){var e,n,l,a=[];for(u.getButtonInput("chooseFiles").disable(),u.getButtonInput("resetSelection").enable(),e=0;e<this.files.length;e++)l={type:"text",name:(n=this.files[e]).name,multiline:"true",label:n.name,placeholder:i.getNLSValue("DocumentMgmtUI.FileDescPlaceholder",{file:n.name})},a.push(l);a.length>0&&(s=o.create("Form",{className:"horizontal",grid:"4 8",fields:a})).inject(c),UWA.is(t.onChooseFiles,"function")&&t.onChooseFiles(this.files,s)})}},d={name:"resetSelection",disabled:!0,value:i.getNLSValue("DocumentMgmtUI.ResetSelection"),action:function(){u.getButtonInput("resetSelection").disable(),u.getButtonInput("chooseFiles").enable(),s.destroy(),UWA.is(t.onResetFileSelection,"function")&&t.onResetFileSelection()}},u=o.create("Form",{className:"horizontal",grid:"3 8",fields:n,buttons:[r,d]}),c=o.create("Element","div",{class:"filesFormDiv"}),u.inject(e),c.inject(e),u},l=function(e){var n,l,a,s,r,d,m;a=(e=e||{}).title,s=o.create("Element","div",{class:"dialogBody"}),r=c(s,UWA.merge({onChooseFiles:function(e,t){m=e,d=t},onResetFileSelection:function(){m=null,d=null}},e)),n={title:a,body:s,okBtn:{Title:e.okBtnTitle,onClick:function(){var n,o,c,a=[];if(r.validate())if(UWA.is(m)){for(o=d.getValues(),c={title:r.getValue("DocumentTitle"),description:r.getValue("DocDescription"),policy:r.getValue("DocPolicy")},n=0;n<m.length;n++)a.push({file:m[n],comments:o[m[n].name]});UWA.is(e.okBtnClick,"function")&&e.okBtnClick(c,a),l.destroy()}else t.warn(i.getNLSValue("DocumentMgmtUI.FilesRequired"));else t.warn(i.getNLSValue("DocumentMgmtUI.DocTitleRequired"))}},cancelBtn:{Title:e.cancelBtnTitle,onClick:function(){UWA.is(e.cancelBtnClick,"function")&&e.cancelBtnClick()}}},(l=u.buildDialog(n)).show()},{buildAttachDocUI:function(e){n.getDocumentsPolicies(function(t){l({title:i.getNLSValue("DocumentMgmtUI.AttachDocsHeader"),docPolicies:t,okBtnTitle:i.getNLSValue("DocumentMgmtUI.Attach"),okBtnClick:function(t,o){n.uploadDocument(e,t,o)}})})},buildUpdateDocUI:function(e,t){var o=n.getDocument(e),c=o.get("dataelements").title,a=o.get("dataelements").description,u=o.get("dataelements").policy;l({title:i.getNLSValue("DocumentMgmtUI.UpdateDocsHeader",{document:c}),docTitle:c,docDescription:a,docPolicy:u,okBtnTitle:i.getNLSValue("DocumentMgmtUI.Update"),okBtnClick:function(e,n){t(n)}})},buildUpdateFileUI:function(e,t){var o=n.getDocument(e),c=o.get("dataelements").title,a=o.get("dataelements").description,u=o.get("dataelements").policy;l({title:i.getNLSValue("DocumentMgmtUI.ModifyFileHeader"),docTitle:c,docDescription:a,docPolicy:u,multiSelection:!1,okBtnTitle:i.getNLSValue("DocumentMgmtUI.Update"),okBtnClick:function(e,n){t(n[0])}})}}}}),define("DS/DELPPWDocumentsModule/DocumentsModule",["UWA/Core","DS/DELPPWDocumentsModule/DocumentsUploadUI","DS/DELPPWDocumentsModule/DocumentsMgmtUI"],function(e,t,n){"use strict";return{behaviors:["DocumentBehavior","ModelBehavior","UXFactoryBehavior","SelectionBehavior","ResourceBehavior","SearchBehavior"],creator:function(o,i,l,c,a,u,s){var r,d,m,g,D,f,h,p,U,v,b,I;return v=function(t){(e.is(t,"array")?t:[t]).forEach(function(e){i.isDocConnection(e)&&(o.notify("manageDocCmdAvailability"),D.onAddConnection(e))})},b=function(t){var n=!1;(e.is(t,"array")?t:[t]).forEach(function(e){i.isDocConnection(e)&&(n=!0,D.onRemoveConnection(e))}),n&&o.notify("manageDocCmdAvailability")},I=function(e){D.onChangeDocument(e)},r=function(){var t,n=d(),o=!1;return e.is(n)&&e.is(n.get)&&(t=l.getPPRType(n),o=f.indexOf(t)>-1),o},d=function(){var e,t=a.getSelectedRefs();return t.length>0?e=t[0]:(t=a.getSelectedInsts(),e=l.getReferenceModelFromInstance(t[0])),e},m=function(){var t=d();return e.is(t)?t.id:""},h=function(){g.buildAttachDocUI(m())},p=function(){s.activate(u.getNLSValue("SearchDocumentCmd.SearchTitle"),function(e){var t=[];e.forEach(function(e){t.push(e.id)}),i.attachDocuments(m(),t)},i.getDocumentTypes(),null)},U=function(){D.buildDocMgmtUI(m(),r())},{listenTo:function(){return{AttachDocumentCmd:h,SearchDocumentCmd:p,ManageDocumentsCmd:U,addConnection:v,removeConnection:b,changeDocument:I}},onStart:function(e){(e=e||{}).pprTypes||o.debug("Authoring pprTypes list is not provided,DocumentModule would render in readOnly mode only"),f=e.pprTypes||[],g=new t(o,i,c,u),D=new n(o,g,i,c,u)},onStop:function(){g=null,D=null}}}}});