/*!  COPYRIGHT DASSAULT SYSTEMES 2015   */
var isCloud;function Player3DShare(e,t,i,n,r){"use strict";var s;return 1===arguments.length?(console.error("You're using a very old deprecated funtion, please use Player3DPlayWeb instead (same signature)"),s=arguments[0]):(console.error("You're using a very old deprecated funtion, please use Player3DPlayWeb instead (with {container:{}, input:{}, options:{}, widget:{} [,application:]})"),(s={}).container=arguments[0],s.input=arguments[1],s.options=arguments[2],s.widget=arguments[3],s.application=arguments[4]),Player3DPlayWeb(s)}define("DS/3DPlaySupport/ExperiencesList",["DS/WebSystem/Environment","UWA/Core"],function(e,t){"use strict";var i={"3DPlay2DExperience":{name:"2D Experience",description:"Experience for 2D documents",module:"DS/3DPlay2DExperience/3DPlay2DExperience"},"3DPlay2DExperiencePreview":{name:"2D Experience Preview",description:"Preview Experience for 2D documents",module:"DS/3DPlay2DExperience/3DPlay2DExperiencePreview"},"3DPlayModelViewer":{name:"ModelViewer Simple Experience",description:"Display 3DXML & CRG files in the web browser",module:"DS/3DPlayModelViewer/3DPlayModelViewer"},"3DPlayCollaborativeExperience":{name:"3DPlay Collaborative Experience",description:"Display 3DXML & CRG files in the web browser",module:"DS/3DPlayDefaultExperience/3DPlayDefaultExperience"},"3DPlayDrawingExperience":{name:"3DPlay Drawing Experience",description:"Experience for Drawings",module:"DS/3DPlayDrawingExperience/3DPlayDrawingExperience"},"3DPlayDrawingPreview":{name:"3DPlay Drawing Preview",description:"Preview Experience for Drawings",module:"DS/3DPlayDrawingExperience/3DPlayDrawingPreview"},"3DPlayUDLExperience":{name:"3DPlay Drawing UDL Experience",description:"Experience for UDL Drawings",module:"DS/3DPlayUDLExperience/3DPlayUDLExperience"},"3DPlayUDLExperiencePreview":{name:"3DPlay Drawing UDL Preview",description:"Preview Experience for UDL Drawings",module:"DS/3DPlayUDLExperience/3DPlayUDLExperiencePreview"},"3DPlaySVGExperience":{name:"3DPlay SVG new Viewer",description:"New 2D viewer extented exp for svg",module:"DS/3DPlay2DExperience/3DPlaySVGExperience"},"3DPlaySVGExperienceForDrawing":{name:"3DPlay SVG new Viewer for Drawing",description:"New 2D viewer extented exp for svg Drawing",module:"DS/3DPlay2DExperience/3DPlaySVGExperienceForDrawing"},"3DPlayImageExperience":{name:"3DPlay Image new Viewer",description:"New 2D viewer extented exp for Image",module:"DS/3DPlay2DExperience/3DPlayImageExperience"},"3DPlayTextExperience":{name:"3DPlay text new Viewer",description:"New 2D viewer extented exp for txt",module:"DS/3DPlay2DExperience/3DPlayTextExperience"},"3DPlayTextExperiencePreview":{name:"3DPlay text new Viewer",description:"New 2D viewer extented exp for txt",module:"DS/3DPlay2DExperience/3DPlayTextExperiencePreview"},"3DPlayPreviewSimulation":{name:"Simulation Preview Experience",description:"Preview Simulation light weight data in the web browser",module:"DS/3DPlayPreviewSimulation/3DPlayPreviewSimulation"},"3DPlayBasicSimulation":{name:"Simulation Player Experience",description:"Display Simulation light weight data in the web browser",module:"DS/3DPlayBasicSimulation/3DPlayBasicSimulation"},"3DPlayBasicSimulationNR":{name:"NR Simulation Experience",description:"NR Experience for Physics Simulations",module:"DS/3DPlaySimulationNR/3DPlayBasicSimulationNR"},"3DPlayFullSimulation":{name:"Simulation Player Experience",description:"Display and animate Simulation light weight data in the web browser",module:"DS/3DPlayFullSimulation/3DPlayFullSimulation"},"3DPlayFullFEM":{name:"Meshing Review Experience",description:"Display mesh light weight data in the web browser",module:"DS/3DPlayMesh/3DPlayFullFEM"},"3DPlay3DSimExperience":{name:"Simulation Media Experience",description:"Preview Simulation media in the web browser",module:"DS/3DPlay3DSimExperience/3DPlay3DSimExperience"},"3DPlayDMUExperience":{name:"3DReview experience",description:"Play Review",module:"DS/3DPlayDMUExperience/3DPlayDMUExperience"},"3DPlayReviewExperience":{name:"Review Experience",description:"",module:"DS/3DPlayReviewExperience/3DPlayReviewExperience"},"3DPlayHighlightExperience":{name:"Highlight Experience",description:"",module:"DS/3DPlayReviewExperience/3DPlayHighlightExperience"},ApproximationExperience:{name:"ApproximationExperience",description:"ApproximationExperience",module:"DS/SMAApproximationExperience/SMAApproximationExperience"},CATDIFAnnotationSetExperience:{name:"CATDIFAnnotationSetExperience",description:"",module:"DS/CAT3DAnnotXDefineExperiences/CATDIFAnnotationSetExperience"},PIMwebIsr3DPlayExperience:{name:"Interference Simulation",description:"",module:"DS/PIMweb3DPlayExperience/PIMwebIsr3DPlayExperience"},PIMwebItf3DPlayExperience:{name:"Interference Metric",description:"",module:"DS/PIMweb3DPlayExperience/PIMwebItf3DPlayExperience"},ENOSHOExp3DPlayMobile:{name:"3DMerchandising Experience",description:"Review 3D Merchandising experiences.",module:"ENOSHOExp3DPlayMobile/ENOSHOExp3DPlayMobile"},GEOswaExperience:{name:"swa Player Experience",description:"Display a swa file in a 3dViewer in the web browser",module:"DS/GEOswaExperience/GEOswaExperience"},VCXWebPlayerIn3DPlayExperience:{name:"Composer smg files Experience",description:"Play Composer smg files in the web browser",module:"DS/VCXWebComposer3DPlayExperience/VCXWebPlayerIn3DPlayExperience"},XCT3DPlayIntegratability:{name:"XCT3DPlayIntegratability Experience loader",description:"XCT3DPlayIntegratability experience",module:"DS/XCT3DPlayIntegratability/XCT3DPlayIntegratability"},"3DStoryExperience":{name:"3DStory Simple Experience",description:"Display 3DStories in the web browser",module:"DS/XCT3DStoryIFrame/3DStoryExperience"},CAT3DSketch3DPlayIntegrability:{name:"3DSketch",description:"3DSketch",module:"DS/CAT3DSKExperience/CAT3DSketchExperience"},"3DPlayRequirementExperience":{name:"Requirement experience",description:"",module:"DS/3DPlayRequirementExperience/3DPlayRequirementExperience"},DELMOMWKIExperience:{name:"",description:"",module:"DS/DELMOMWKIExperience/DELMOMWKIExperience"}};return e.isSet("3DPlay.GEOVIA")&&t.extend(i,{GEOMineSchedExperience:{name:"MineSched Player Experience",description:"Display a minesched viewer animation format in a 3dViewer in the webbrowser",module:"DS/GEOMineSchedExperience/GEOMineSchedExperience"}},!0),e.isSet("3DPlay.ProtoHTMLViewer")&&t.extend(i,{"3DPlayHtmlViewer":{name:"HtmlViewer Experience",description:"Display web pages & text content in the web browser",module:"DS/3DPlayHtmlViewer/3DPlayHtmlViewer"}},!0),e.isSet("3DPlay.Video")&&t.extend(i,{"3DPlayVideoExperience":{name:"3D Play video Experience",description:"Experience to display a video",module:"DS/3DPlayVideoExperience/3DPlayVideoExperience"}},!0),i.is3DPlay3DExperience=function(e){var t=e.getExperienceModule();return this["3DPlayModelViewer"].module===t||this["3DPlayCollaborativeExperience"].module===t},i.isDynamicRepLoadingCompatibleExperience=function(e){var t=e.getExperienceModule();return[this["3DPlayModelViewer"].module,this["3DPlayCollaborativeExperience"].module,this["3DPlayDMUExperience"].module,this["3DPlayReviewExperience"].module,this["3DPlayHighlightExperience"].module,this.PIMwebIsr3DPlayExperience.module,this.PIMwebItf3DPlayExperience.module,this.CATDIFAnnotationSetExperience.module,this.DELMOMWKIExperience.module].indexOf(t)>-1},i}),define("DS/3DPlaySupport/SupportList",["DS/WebSystem/Environment","UWA/Core","DS/WebUtils/ProbesManager"],function(e,t,i){"use strict";var n={preview:0,collaborate:1,NR:2,SimReview:3},r={"2D":"3DPlay2DExperience","3D":"3DPlayCollaborativeExperience"},s={"2D":["3DPlay2DExperiencePreview",r["2D"],"",""],"3D":["3DPlayModelViewer",r["3D"],r["3D"],""]},a={FILE:{"3dm":s["3D"],"3dsto":["3DStoryExperience","3DStoryExperience","",""],"3dsim":["3DPlay3DSimExperience","3DPlay3DSimExperience","3DPlay3DSimExperience","3DPlay3DSimExperience"],"3dskt":["CAT3DSketch3DPlayIntegrability","CAT3DSketch3DPlayIntegrability","CAT3DSketch3DPlayIntegrability",""],"3dwb":["CAT3DSketch3DPlayIntegrability","CAT3DSketch3DPlayIntegrability","CAT3DSketch3DPlayIntegrability",""],"3dxml":s["3D"],"3dxm":s["3D"],"3dxc":s["3D"],asat:s["3D"],asab:s["3D"],catpart:s["3D"],catproduct:s["3D"],cgr:s["3D"],dae:s["3D"],dgn:s["3D"],dsxm:["XCT3DPlayIntegratability","XCT3DPlayIntegratability","",""],dtm:["GEOswaExperience","GEOswaExperience","",""],easm:s["3D"],eprt:s["3D"],easmx:s["3D"],eprtx:s["3D"],exp:s["3D"],fbx:s["3D"],gml:s["3D"],ifc:s["3D"],ifczip:s["3D"],iges:s["3D"],igs:s["3D"],ipt:s["3D"],jt:s["3D"],model:s["3D"],p_b:s["3D"],p_t:s["3D"],obj:s["3D"],par:s["3D"],prt:s["3D"],rfa:s["3D"],rvt:s["3D"],sab:s["3D"],sat:s["3D"],sdm:["GEOswaExperience","GEOswaExperience","",""],sldasm:s["3D"],sldprt:s["3D"],smg:["VCXWebPlayerIn3DPlayExperience","VCXWebPlayerIn3DPlayExperience","VCXWebPlayerIn3DPlayExperience","VCXWebPlayerIn3DPlayExperience"],smgxml:["VCXWebPlayerIn3DPlayExperience","VCXWebPlayerIn3DPlayExperience","VCXWebPlayerIn3DPlayExperience","VCXWebPlayerIn3DPlayExperience"],stp:s["3D"],stpz:s["3D"],stpx:s["3D"],stpxz:s["3D"],step:s["3D"],stpa:s["3D"],stl:s["3D"],str:["GEOswaExperience","GEOswaExperience","",""],swa:["GEOswaExperience","GEOswaExperience","",""],vda:s["3D"],x_b:s["3D"],x_t:s["3D"],xcgm:s["3D"],xmp_bin:s["3D"],xmp_txt:s["3D"],xmt_bin:s["3D"],xmt_txt:s["3D"],xmlv43:s["3D"],zae:s["3D"],catdrawing:["3DPlayUDLExperiencePreview","3DPlayUDLExperience","3DPlayUDLExperience",""],cgm:["3DPlay2DExperiencePreview","3DPlaySVGExperience","3DPlaySVGExperience",""],slddrw:["3DPlayUDLExperiencePreview","3DPlayUDLExperience","3DPlayUDLExperience",""],edrw:["3DPlayUDLExperiencePreview","3DPlayUDLExperience","3DPlayUDLExperience",""],edrwx:["3DPlay2DExperiencePreview","3DPlaySVGExperience","3DPlaySVGExperience",""],bmp:["3DPlay2DExperiencePreview","3DPlayImageExperience","3DPlayImageExperience",""],dwg:["3DPlay2DExperiencePreview","3DPlaySVGExperience","3DPlaySVGExperience",""],dxf:["3DPlay2DExperiencePreview","3DPlaySVGExperience","3DPlaySVGExperience",""],jpg:["3DPlay2DExperiencePreview","3DPlayImageExperience","3DPlayImageExperience",""],jpeg:["3DPlay2DExperiencePreview","3DPlayImageExperience","3DPlayImageExperience",""],png:["3DPlay2DExperiencePreview","3DPlayImageExperience","3DPlayImageExperience",""],svg:{connector:"DS/3DPlayConnectors/SVGConnector",DefaultExperiencesList:["3DPlay2DExperiencePreview","3DPlaySVGExperienceForDrawing","3DPlaySVGExperienceForDrawing",""]},tif:["3DPlay2DExperiencePreview","3DPlaySVGExperience","3DPlaySVGExperience",""],tiff:["3DPlay2DExperiencePreview","3DPlaySVGExperience","3DPlaySVGExperience",""],pdf:s["2D"],txt:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],aptsource:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],log:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],catnccode:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],gcode:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],nc:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],ncc:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],cnc:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],hdm:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],tap:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],ngc:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],gc:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],mpt:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],mpf:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],spf:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],num:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],mod:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],dat:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],src:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],ls:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],dtx:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],pgx:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],asc:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],pac:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],tid:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],tip:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],as:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],prg:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],jbi:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],csr:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],einrichteblatt:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""],ing:["3DPlayTextExperiencePreview","3DPlayTextExperience","3DPlayTextExperience",""]},"3DSPACE":{"3DShape":s["3D"],Approximation:["ApproximationExperience","ApproximationExperience","ApproximationExperience","ApproximationExperience"],CATDrawing:["3DPlay2DExperiencePreview","3DPlaySVGExperience","3DPlaySVGExperience",""],CATPart:s["3D"],CATProduct:s["3D"],"ds6w:Product":s["3D"],"ds6w:Part":s["3D"],"ds6w:Occurrence":s["3D"],"ds6w:Document":s["3D"],"ds6w:ProdConf":s["3D"],DIFAnnotationSet:["CATDIFAnnotationSetExperience","CATDIFAnnotationSetExperience","",""],DesignSight:["3DPlayPreviewSimulation","3DPlayBasicSimulation","3DPlayBasicSimulationNR","3DPlayFullSimulation"],DeFaUltDtYpE:s["3D"],DMUMarkupRepReference:["3DPlayDMUExperience","3DPlayDMUExperience","",""],Markup:["3DPlayDMUExperience","3DPlayDMUExperience","",""],DOCUMENTS:{connector:"DS/3DSpaceDocumentConnector/3DSpaceDocumentConnector"},Document:{connector:"DS/3DSpaceDocumentConnector/3DSpaceDocumentConnector"},"Earth Resource":s["3D"],FEM:[r["3D"],"3DPlayCollaborativeExperience","","3DPlayFullFEM"],"Geological Feature":s["3D"],"Geological Unit":s["3D"],MediaVideo3DExp:["XCT3DPlayIntegratability","XCT3DPlayIntegratability","XCT3DPlayIntegratability","XCT3DPlayIntegratability"],Requirement:["3DPlayRequirementExperience","3DPlayRequirementExperience","",""],"Requirement Specification":["3DPlayRequirementExperience","3DPlayRequirementExperience","",""],"SW Assembly Family":s["3D"],"SW Assembly Instance":s["3D"],"SW Component Family":s["3D"],"SW Component Instance":s["3D"],VPMReference:s["3D"],VPMRepReference:s["3D"],ENOStrRefinementSpecification:s["3D"],XCADNonPSBaseRepReference:{connector:"DS/ENOXCADNonPSConnector/ENOXCADNonPSConnector"},SIMItfSimulation:["PIMwebIsr3DPlayExperience","PIMwebIsr3DPlayExperience","PIMwebIsr3DPlayExperience","PIMwebIsr3DPlayExperience"],PLMPIMMetricReference:["PIMwebItf3DPlayExperience","PIMwebItf3DPlayExperience","PIMwebItf3DPlayExperience","PIMwebItf3DPlayExperience"],DMUValidationValidation:["3DPlayReviewExperience","3DPlayReviewExperience","",""],DMUValidationExposedPresentation:["3DPlayHighlightExperience","3DPlayHighlightExperience","",""],DIFSheet:["3DPlayUDLExperiencePreview","3DPlayUDLExperience","",""],DIFLayout:["3DPlayUDLExperiencePreview","3DPlayUDLExperience","",""]},"3DSDM":{SDMBase:{connector:"DS/SDM3DPlayConnector/3DSDMConnector"}},"3DDRIVE":{DOCUMENT:{connector:"DS/3DPlayConnectors/3DDriveConnector"},Document:{connector:"DS/3DPlayConnectors/3DDriveConnector"},DriveFile:{connector:"DS/3DPlayConnectors/3DDriveConnector"}},ONEDRIVE:{DOCUMENT:{connector:"DS/3DPlayConnectors/OneDriveConnector"},Document:{connector:"DS/3DPlayConnectors/OneDriveConnector"}},DROPBOX:{DOCUMENT:{connector:"DS/3DPlayConnectors/DropboxConnector"},Document:{connector:"DS/3DPlayConnectors/DropboxConnector"}},GOOGLE:{DOCUMENT:{connector:"DS/3DPlayConnectors/GoogleConnector"},Document:{connector:"DS/3DPlayConnectors/GoogleConnector"}},"3DSWYM":{media:{connector:"DS/3DPlayConnectors/3DSwymConnector"}},BUFFER:{"3dxml":s["3D"],svg:["3DPlay2DExperiencePreview","3DPlaySVGExperienceForDrawing","3DPlaySVGExperienceForDrawing",""],xcaddrawing:["3DPlay2DExperiencePreview","3DPlaySVGExperienceForDrawing","3DPlaySVGExperienceForDrawing",""],udl:["3DPlayUDLExperiencePreview","3DPlayUDLExperience","3DPlayUDLExperience",""]},CROSSHIGHLIGHT:{VPMReference:1,VPMInstance:1,VPMRepInstance:1,VPMRepReference:1,"3DShape":1,CATProduct:1,CATPart:1,Viewable:1,CgrViewable:1,Reference3D:1,Instance3D:1},R2VSURVEY:{R2V_FeatureState:s["3D"]}},o=function(e){return e.toLowerCase()};a.FILE.reformatTypeID=o,a.BUFFER.reformatTypeID=o;var l=[];a.setPLatformServices=function(e){l=e},a.addPlatformData=function(e){return l.push({platformId:e}),this.getPlatformData(e)},a.getPlatformData=function(e){for(var t=l.length;t--;)if(l[t].platformId===e)return l[t];return null};var c=function(e,t,i){var n=e.serverurl;if(!n){var r=a.getPlatformData(e.tenant);n=r?r["3DSpace"]:null}require(["DS/WebUtils/WebServices"],function(r){r.getParentsType({serverUrl:n,tenant:e.tenant,contextid:e.contextId?e.contextId:e.contextid,physicalid:e.physicalid,dtype:e.dtype,onFailure:function(e){console.error(e),i(void 0)},onComplete:function(e){for(var n=e.length;n--;){var r=e[n];if(r&&a[t][r])return void i(r)}i(void 0)}})})},u={};return a["3DSPACE"].resolveParenting=function(e,t){var n=e.type;if(null==n&&(n="VPMReference"),a.EV6[n])t(n);else if(u[n])t(u[n]);else if(void 0!==e.tenant&&null!==e.tenant&&"string"==typeof e.tenant){var r=i.createFunctionProbe("resolveParenting",function(e){u[n]=e,t(e)});c(e,"3DSPACE",r)}else t(void 0)},a.CROSSHIGHLIGHT.resolveParenting=function(e,t){var i=e.type;1!==a.CROSSHIGHLIGHT[i]?void 0!==e.tenant&&null!==e.tenant&&"string"==typeof e.tenant?c(e,"CROSSHIGHLIGHT",t):t(void 0):t(i)},t.extend(a,{"3DSPACE":{Drawing:{connector:"DS/3DPlayConnectors/DrawingConnector"},V6Drawing:["3DPlayDrawingPreview","3DPlayDrawingExperience",""]}},!0),a.EV6=a["3DSPACE"],a.FILE.dwg=["3DPlayUDLExperiencePreview","3DPlayUDLExperience","3DPlayUDLExperience",""],a.FILE.dxf=["3DPlayUDLExperiencePreview","3DPlayUDLExperience","3DPlayUDLExperience",""],t.extend(a,{FILE:{udl:["3DPlayUDLExperiencePreview","3DPlayUDLExperience","3DPlayUDLExperience",""]}},!0),e.isSet("3DPlay.OfficeDocuments")&&"true"==e.get("3DPlay.OfficeDocuments")||t.extend(a,{FILE:{doc:s["2D"],docx:s["2D"],docm:s["2D"],dot:s["2D"],dotm:s["2D"],dotx:s["2D"],rtf:s["2D"],ppt:s["2D"],pptx:s["2D"],pot:s["2D"],potm:s["2D"],potx:s["2D"],pps:s["2D"],ppsm:s["2D"],ppsx:s["2D"],pptm:s["2D"],xls:s["2D"],xlsx:s["2D"],xlsm:s["2D"],xlsb:s["2D"],xlt:s["2D"],xltm:s["2D"],xltx:s["2D"],csv:s["2D"],msg:s["2D"]}},!0),e.isSet("3DPlay.ProtoSMM")&&t.extend(a,{FILE:{xls:s["2D"],xlsx:s["2D"],cgr:s["3D"],txt:s["2D"],fmu:s["2D"],mdl:s["2D"],html:s["2D"],trapatterns:s["2D"],catpart:s["2D"]}},!0),e.isSet("3DPlay.GEOVIA")&&t.extend(a,{FILE:{mineschedanimation:["GEOMineSchedExperience","GEOMineSchedExperience","",""]}},!0),e.isSet("3DPlay.Allow_simxml")&&t.extend(a,{FILE:{simxml:["3DPlayBasicSimulation","3DPlayBasicSimulation","3DPlayBasicSimulationNR",""]}},!0),e.isSet("3DPlay.ProtoHTMLViewer")&&t.extend(a,{FILE:{html:["3DPlayHtmlViewer","3DPlayHtmlViewer","",""]}},!0),e.isSet("3DPlay.Video.Enabled")&&t.extend(a,{FILE:{mp4:s["2D"],webm:s["2D"],ogv:s["2D"],ogg:s["2D"]}},!0),e.isSet("3DPlay.ProtoConvertSpatial")&&t.extend(a,{FILE:{asm:s["3D"],cgm3d:s["3D"],iam:s["3D"],session:s["3D"]}},!0),e.isSet("ODT_MODE")&&t.extend(a,{FILE:{tst_frommimetype:{connector:"DS/ODT_3DPlayInfra/3DPlayTstConnector"},tst_badreturnfile:{connector:"DS/ODT_3DPlayInfra/3DPlayTstConnector"},tst_failopen:{connector:"DS/ODT_3DPlayInfra/3DPlayTstConnector"},tst_failrequire:{connector:"DS/ODT_3DPlayInfra/WrongModuleID"},opened:s["2D"]},"3DSPACE":{resolveParenting:function(e,t){t(e.type)},tst_chainedopen:{connector:"DS/ODT_3DPlayInfra/3DPlayTstConnector",DefaultExperiencesList:s["3D"]},tst_fromdtype:{connector:"DS/ODT_3DPlayInfra/3DPlayTstConnector"},tst_badreturnev6:{connector:"DS/ODT_3DPlayInfra/3DPlayTstConnector"}},STREAM:{svg:s["2D"]}},!0),e.isSet("3DPlay.PersistedAnnotationsEnabled")&&t.extend(a,{FILE:{svg:{connector:"DS/3DPlayConnectors/SVGConnector"}}},!0),e.isSet("3DPlay.Video")&&t.extend(a,{FILE:{mp4:["3DPlayVideoExperience","3DPlayVideoExperience","",""]}},!0),a.getDefaultExperienceID=function(e){var t=e||{};return t.format=t.format||"3D",r[t.format]},a.getDefaultExperiencesIDList=function(e){var t=e||{};return t.format=t.format||"3D",s[t.format]},a.computeUsage=function(e){var t=n[e];return null==t&&(t=n.collaborate),t},a.openAsset=function(e,t,i,n){var r=a[e.provider][e.type].connector;"string"==typeof r?require([r],function(r){var s=new r;a[e.provider][e.type].connector=s,s.open(t,i,n)},function(){n()}):r.open(t,i,n)},a}),define("DS/WebSystem/Css",["DS/WebappsUtils/WebappsUtils"],function(e){"use strict";return function(t,i){if(Array.isArray(t)){for(var n=0;n<t.length;n++)this.loadCssFile(t[n],i);return this}var r=document.createElement("link");r.type="text/css",r.rel="stylesheet",r.href=void 0===i?t:e.getWebappsBaseUrl()+t,document.getElementsByTagName("head")[0].appendChild(r)}}),define("DS/WebSystem/FpsInfo",["UWA/Class"],function(e){"use strict";return e.extend({min:1/0,max:0,avg:0,init:function(){this.clear()},clear:function(){this.avg=this.max=0,this.min=1/0},toString:function(){return Math.round(this.min)+"/"+Math.round(this.max)+"/"+Math.round(this.avg)}})}),define("DS/3DPlayHelper/Tracker_Translation_Widget",[],function(){"use strict";return{widget:{Load_3DDashboard:2,Unified_Widget_1:3,Widget_EntryPoint:4,Unified_Widget_2:5,Widget_3DPlay:6,Widget_Ready:7,Splashscreen_Displayed:8}}}),define("DS/WebSystem/Downloader",function(){return function(e,t){var i="string"!=typeof t,n=i?URL.createObjectURL(t):t,r=document.createElement("a");r.download=e,r.innerHTML="Download File",r.href=n,r.onclick=function(e){document.body.removeChild(e.target),r=null,i&&setTimeout(function(){window.URL.revokeObjectURL(n),n=null},2e3)},r.style.display="none",document.body.appendChild(r),"ODT_TEST_DO_NOT_DOWNLOAD"===e&&(r.click=function(){window[e]="done"}),r.click()}}),define("DS/WebSystem/Scripting",["UWA/Class"],function(e){"use strict";return e.extend({name:"Scripting",init:function(){this._parent(),this.scriptableAPIdef={},this._subscribers=[]},dispose:function(){this.disposeAllScriptingFunctions()},disposeAllScriptingFunctions:function(){for(var e in this.scriptableAPIdef)this.removeScriptingFunction(e);this.scriptableAPIdef=null},addScriptingFunction:function(e,t,i,n,r,s){this.scriptableAPIdef[e]={callback:t,documentation:i,declare:n,dispose:r,callbackUsage:s};var a=this;if(n){var o=function(){return a.executeScriptingFunction(e,arguments)};Array.isArray(n)?n.forEach(function(t){t[e]=o}):n[e]=o}return this},removeScriptingFunction:function(e){if(this.scriptableAPIdef[e]){if(this.scriptableAPIdef[e].declare&&(Array.isArray(this.scriptableAPIdef[e].declare)?this.scriptableAPIdef[e].declare.forEach(function(t){t[e]=void 0}):this.scriptableAPIdef[e].declare[e]=void 0),this.scriptableAPIdef[e].dispose&&this.scriptableAPIdef[e].dispose(),this._subscribers[e]){for(var t in this._subscribers[e])this._subscribers[e][t]=null;this._subscribers[e]=null}this.scriptableAPIdef[e]=void 0,delete this.scriptableAPIdef[e]}return this},getScriptingFunctions:function(){return this.scriptableAPIdef},hasScriptingFunction:function(e){return this.scriptableAPIdef[e]},getFunctionsDoc:function(){var e={};for(var t in this.scriptableAPIdef)e[t]=this.scriptableAPIdef[t].documentation||"noDoc";return e},subscribeScriptingFunction:function(e,t){return this._subscribers[e]||(this._subscribers[e]=[]),this._subscribers[e].push(t),this},unsubscribeScriptingFunction:function(e,t){if(this._subscribers[e])for(var i in this._subscribers[e])this._subscribers[e][i]==t&&(this._subscribers[e][i]=null);return this},subscribeAllScriptingFunctions:function(e){for(var t in this.scriptableAPIdef)this.subscribeScriptingFunction(t,e)},unsubscribeAllScriptingFunctions:function(e){for(var t in this.scriptableAPIdef)this.unsubscribeScriptingFunction(t,e)},notifyScriptingFunction:function(e,t){if(this.scriptableAPIdef[e]&&this._subscribers[e])for(var i in this._subscribers[e])this._subscribers[e][i]&&this._subscribers[e][i](e,t);return this},executeScriptingFunction:function(e,t){var i=this.scriptableAPIdef[e];if(!i)throw"Unkown command";if(!i.callback)throw"internal error: callback not present";i.callbackUsage&&i.callbackUsage(e);var n=!1;try{void 0!==typeof t.callee}catch(e){n=!0}var r=n||void 0===t?t:[t];return i.callback.apply(this,r)}})}),define("DS/WebSystem/DetectBrowser",[],function(){"use strict";return function(e,t){var i,n={browser:{},os:{}},r=e||navigator.userAgent,s=r.match(/(opr|opera(?=\/))\/?\s*([\d\.]+)/i)||[];s[0]?s[1]="opera":(s=r.match(/(edge(?=\/))\/?\s*([\d\.]+)/i)||[])[0]?s[1]="ie":(s=r.match(/(edge|chrome|safari|firefox|msie|trident(?=\/))\/?\s*([\d\.]+)/i)||[],/trident/i.test(s[1])&&(i=/\brv[ :]+(\d+(\.\d+)?)/g.exec(r)||[],s[1]="ie",s[2]=i[1]||""),/edge/i.test(s[1])&&(i=/\brv[ :]+(\d+(\.\d+)?)/g.exec(r)||[],s[1]="ie",s[2]=i[1]||"")),s=s[2]?[s[1],s[2]]:[navigator.appName,navigator.appVersion,"-?"],n.browser.name=s[0].toLowerCase(),n.browser.version=s[1].split(".")[0],n.browser.mobile=/IEMobile|Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(t||navigator.appVersion),n.browser.arm=/ARM/.test(r),n.browser.hasTouch="ontouchstart"in document.documentElement||n.browser.mobile,n.browser.safariWithChrome=!1;var a=[{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows Vista",r:/Windows NT 6.0/},{v:"7",s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{v:"8",s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{v:"8.1",f:"winphone",s:"Windows Phone 8.1",r:/Windows Phone 8.1/},{v:"8",s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{v:"10",s:"Windows 10",r:/(Windows 10|Windows NT 10.0|Windows NT 6.3)/},{s:"android",r:/Android/},{s:"linux",r:/(Linux|X11)/},{s:"ios",r:/iP(hone|ad|od)/},{s:"macosx",r:/Mac OS X/},{s:"cros",r:/CrOS/}];for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];if(l.r.test(r)){n.os.name=l.s,l.v&&(n.os.version=l.v),l.f&&(n.os.name=l.f);break}}var c="";if(/Windows/.test(n.os.name))void 0!==n.os.version&&null!==(c=/Windows (\d.\d)/.exec(n.os.name))&&(c=c[1]),n.os.name="win";else switch(n.os.name){case"macosx":null!==(u=/Mac OS X (\d+)_(\d+)_?(\d+)?/.exec(r))?c=u[1]+"."+u[2]:null!==(u=/Mac OS X (\d+.\d+)/.exec(r))&&(c=u[1]);break;case"android":c=null!==(c=/Android ([\.\_\d]+)/.exec(r))?(c=c[1].split("."))[0]:4;break;case"ios":var u;c=(u=/OS (\d+)_(\d+)_?(\d+)?/.exec(t||navigator.appVersion))[1]+"."+u[2]}if(void 0===n.os.version&&(n.os.version=c),"safari"==n.browser.name.toLocaleLowerCase()){/(Chrome|CriOS)/i.test(navigator.userAgent)&&(n.browser.safariWithChrome=!0)}return n}}),define("DS/3DPlayWidget/W3DPlayPrefsCtrl",["UWA/Class","DS/CoreEvents/Events"],function(e,t){"use strict";var i,n,r,s={protocol:"3DXContent",version:"1.0",source:"X3DCSMA_AP",data:{items:[{envId:"defaultString",serviceId:"defaultString",contextId:"defaultString",objectId:"defaultString",objectType:"defaultString",displayName:"",displayType:"defaultString",displayIcon:"defaultStringUri",displayPreview:"defaultStringUri",selectedExperience:"defaultString"}]}};return e.extend({init:function(e,t,s){n=e,r=this,(i=t).plateformPromise.then(function(e){r.readAllPreferences(),r=null},function(e){console.error("getAllPlatformServices Error!"),console.dir(e)})},dispose:function(){i=n=r=null},readAllPreferences:function(){var e,n=i.getSwymModelIdPref(),r=i.getSwymTenantIdPref(),s=i.getCollabSpacePref(),a=i.getX3dContentPref(),o=i.getW3DPlayContentPref();this.isSwymIdValid(n)&&this.isW3DPlayContentEmpty()?(e=this.newSwymDataPreparation(n,r),i.setW3DPlayContent(e)):this.isCollabSpaceValid(s)&&this.isW3DPlayContentEmpty()?(e=this.newSpaceDataPreparation(s),i.setW3DPlayContent(e)):this.isX3DContentIdValid(a)&&(e=JSON.parse(a),i.setW3DPlayContent(e)),this.isW3DPlayContentEmpty()||(o=i.getW3DPlayContentPref(),i.setInitialContent(JSON.parse(o))),t.publish({event:"PrefsCtrl.PreferencesReady"})},isPreferencesEmpty:function(){var e=!0,t=i.getW3DPlayContentPref();return t&&null!=t&&(e=!1),e},isW3DPlayContentEmpty:function(){var e=!0,t=i.getW3DPlayContentPref();return t&&null!=t&&(e=!1),e},isSwymIdValid:function(e){return!(!UWA.is(e)||""==e||"false"==e||void 0===e)&&e},newSwymDataPreparation:function(e,t,i){var n=s.data.items[0];return n.envId=t,n.objectId=e,n.serviceId="3DSWYM",n.objectType="3DShape",i&&console.warn("wow very old ( <R416 ?) 3DPlay Widget Preferences!"),s},newSpaceDataPreparation:function(e){return JSON.parse(e)},isCollabSpaceValid:function(e){var t=!1;if(e&&"undefined"!==e){var i=JSON.parse(e);UWA.is(i,"object")&&i.hasOwnProperty("data")&&(t=!0)}return t},isX3DContentIdValid:function(e){var t=!1;if(e&&"undefined"!==e){var n=JSON.parse(e);UWA.is(n,"object")&&n.hasOwnProperty("data")&&(t=!0)}var r=i.getW3DPlayContentPref();return r&&null!=r&&(t=!1),t},deleteLegacyModelIdPref:function(){n.deleteValue("MODELID"),n.deleteValue("swymTenantId")},deleteLegacyPlatformdPref:function(){n.deleteValue("PLATFORM")},deleteAllLegacyPrefs:function(){this.deleteLegacyModelIdPref(),this.deleteLegacyPlatformdPref()},cleanCollabSpacePref:function(e){n.deleteValue("CollabSpacePref")}})}),define("DS/WebSystem/App",["UWA/Class"],function(e){var t={"3dswym":"X3DSWYM_AP",my3dexperience:"X3DSWYM_AP",ResultWebInWin:"X3DSEARWIN_AP","engineeringcentral/emxLaunch3DPlay.jsp":"ENOENBO_AP"};try{(window.top.require||window.require)(["DS/UWPClientCode/PublicAPI"],function(e){isCloud="true"===e.getApplicationConfiguration("app.build.isCloud")})}catch(e){}return{isInWidget:function(){return"undefined"!=typeof widget},isOnCloud:function(){return void 0!==isCloud?isCloud:!!window.widget&&"OnPremise"!==window.widget.getValue("x3dPlatformId")},is3DPlay:function(){return"X3DPLAW_AP"===this.getEmbeder()},is3DDrive:function(){return["X3PDRIV_AP","X3DDRIV_AP"].indexOf(this.getEmbeder())>-1},is3DSwym:function(){return["X3DMCTY_AP","X3DSWYM_AP","X3DWNEW_AP","X3DVIEW_AP"].indexOf(this.getEmbeder())>-1},is3DSearch:function(){return["X3DSEARWIN_AP","X3DSEAR_AP"].indexOf(this.getEmbeder())>-1},is3DSpace:function(){return["X3DCSMA_AP"].indexOf(this.getEmbeder())>-1},getEmbeder:function(){var e;try{if(window.WinJS?e="X3DPLAO_AP":window.HybridApp&&(window.HybridApp.isIOS&&window.HybridApp.isIOS()?e="X3DPLAI_AP":window.HybridApp.isAndroid&&window.HybridApp.isAndroid()&&(e="X3DPLAA_AP")),e||this.isInWidget()&&!(e=widget.getValue("appId"))&&window.parent&&window.parent.widget&&window.parent.widget.getValue&&(e=window.parent.widget.getValue("appId")),!e)for(var i in t)if(t.hasOwnProperty(i)&&window.location.href.indexOf(i)>-1){e=t[i];break}e||this.isInWidget()&&null===widget.id&&widget.body===window.document.body&&(e="X3DSEAR_AP")}catch(e){}return e||(e="Syndication"),e}}});var EnvironmentIsSet=function(e){return window&&window.localStorage&&void 0!==window.localStorage[e]};function Player3DPlayWeb(e){if(!window["3DPlay.ProbesManager.clapDone"]){var t="";"undefined"!=typeof widget&&widget.id&&(t=widget.id),window["3DPlay.ProbesManager.clapDone"]=!0,window.performance.mark(t+"clap");try{window.top.performance.mark(t+"clap")}catch(e){window["3DPlay.ProbesManager.TopWindowNotAvailable"]=!0}}var i,n=function(e){return window&&window.localStorage&&void 0!==window.localStorage[e]};try{var r,s=UWA.Utils.Client.Platform.ios;if(n("ODT_3DPLAYHELPER_IOS")&&(s=!0),s){var a=navigator.userAgent,o=a.indexOf("OS ");o>-1&&(r=a.substr(o+3,3).replace("_",".")),n("ODT_3DPLAYHELPER_IOS")&&(i="ODT_3DPLAYHELPER_IOS",r=window.localStorage[i])}return s&&r<8?(console.log("Player3DPlayWeb: Redirecting to the native app"),void require(["DS/3DPlayHelper/3DPlayNativePlayer"],function(t){t(e)})):Launch3DPlayWeb(e)}catch(t){return Launch3DPlayWeb(e)}}function Launch3DPlayWeb(e){"use strict";if("object"!=typeof e)switch(console.error('Player3DPlayWeb:R418 => This call is deprecated! Please use a JSON object in Player3DPlayWeb({container:"", input:{}; options:{}}'),arguments.length){case 1:return new Player3DShare(e);case 2:return new Player3DShare(arguments[0],arguments[1]);case 3:return new Player3DShare(arguments[0],arguments[1],arguments[2]);case 4:return new Player3DShare(arguments[0],arguments[1],arguments[2],arguments[3]);case 5:return new Player3DShare(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4])}var t,i={instance:void 0,loaded:!1,_check:function(){return this.isReady()?!!this.instance||(console.error("Experience is not created"),!1):(console.error("Experience is not ready"),!1)},getCtx:function(){if(this.instance&&this.instance.args)return this.instance.args.ctx},isReady:function(){return this.loaded},load:function(e,t){_check()},loadAsset:function(e,t){_check()},loadAnnotations:function(e,t){var i=e&&e.annotation?e.annotation:null,n=!(!t||!t.clean);return!(!this.instance||!i)&&(this.instance.loadAnnotations(i,n),!0)},getAnnotations:function(){if(this.instance&&this.instance.annotationManager)return this.instance.annotationManager.saveAnnotationsToJSON()}},n=!1;return(e=e||{}).options=e.options||{},e.options.widget3DPlay&&(n=!0),n||(n=!0,t="Splashscreen",window.performance.mark(t)),require(["DS/3DPlayHelper/3DPlayWebPlayer","DS/WebUtils/ProbesManager","DS/3DPlaySupport/SupportList","css!DS/3DPlayHelper/SplashScreen"],function(n,r,s,a){e.options.platformServices&&s.setPLatformServices(e.options.platformServices),t&&r.createProbe("Splashscreen_Displayed",t),n(i,e)}),i}define("DS/3DPlayHelper/3DPlayHelper",["UWA/Core"],function(e){"use strict";return Player3DPlayWeb}),define("DS/WebUtils/EventDisposer",["DS/CoreEvents/Events","UWA/Class"],function(e,t){"use strict";return t.extend({init:function(e){this._parent(),this.arr=[]},add:function(e){return this.arr.push(e),this},dispose:function(){for(var t=this.arr.length;t--;)e.unsubscribe(this.arr[t]),this.arr[t]=null;this.arr=null}})}),define("DS/3DPlayConnectors/CAT3DPlayConnector",["UWA/Class"],function(e){"use strict";return e.extend({init:function(e){this._parent(e)},getName:function(){return this.name||"Connector"},open:function(e,t,i){console.warn("Use of abstract connector.");try{t(e)}catch(e){console.log(e),i()}}})}),define("DS/WebUtils/3DPlayState",["DS/CefCommunication/CefCommunication"],function(e){"use strict";return{isWebinWin:function(){return e.isAvailable()}}}),define("DS/WebUtils/Clock",[],function(){"use strict";function e(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}return e.prototype={constructor:e,start:function(){this.startTime=(performance||Date).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running&&this.start(),this.running){var t=(performance||Date).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}},e}),define("DS/WebUtils/Profiler",["UWA/Class"],function(e){"use strict";var t=function(){return(new Date).getTime()};function i(e,n,r){this.father=n,this.name=e,this.startTime=this.stopTime=0,this.path=n?n.path:"",this.path+=e+"/",this.addProfile=function(e,t){this.children=this.children||{};var n=this.children[e];return n||(n=new i(e,this),this.children[e]=n),n.start()},this.addProfileFromObject=function(e){var t=this.addProfile(e.name);return t.startTime=e.startTime,t},this.stop=function(e){0===this.stopTime&&(this.stopTime=t());var i=this.stopTime-this.startTime;return e&&this.father&&this.father.stop(!0),i},this.start=function(){return this.stopTime=0,this.startTime=t(),this},this.getTime=function(){return(0===this.stopTime?t():this.stopTime)-this.startTime},this.isStopped=function(){return 0!==this.stopTime},this.dumpAsJSON=function(){var e=this.isStopped()?this.getTime():-1;if(this.children){e={time:e};var t=this.children;for(var i in t)e[i]=t[i].dumpAsJSON()}return e},this.getPath=function(){return this.path},this.dispose=function(){if(this.name=null,this.path=null,this.father=null,Array.isArray(this.children))for(var e=0;e<this.children.length;e++)this.children[e].dispose();this.children=null}}return e.singleton({Profiles:{},_searchNode:function(e,t,n){var r;if(-1!=e.indexOf("/")){var s=e.split("/"),a=s.shift();(r=t&&t.children?t.children[a]:this.Profiles[a])||(t?r=t.addProfile(a):n&&(r=new i(a),this.Profiles&&(this.Profiles[a]=r))),r&&s.length>0&&(r=this._searchNode(s.join("/"),r,n))}else t?(t.children&&(r=t.children[e]),!r&&n&&(r=t.addProfile(e))):r=this.Profiles[e];return r},init:function(e){},start:function(e,t){var n=this._searchNode(e,void 0,!0);return n||(n=new i(e),this.Profiles[e]=n),n.start()},stop:function(e,t){var i=this._searchNode(e,void 0,!1);return void 0!==i?i.stop(t):(console.warn("[PROFILER] unknown profile :",e),-1)},getTime:function(e){var t=this._searchNode(e,void 0,!1);return void 0!==t?t.getTime():(console.warn("[PROFILER] unknown profile :",e),-1)},dumpAsJSON:function(){var e={},t=this.Profiles;for(var i in t)e[i]=t[i].dumpAsJSON();return e}})}),define("DS/WebUtils/PhaseProgress",["UWA/Class","DS/WebInfraUI/Progress"],function(e,t){"use strict";return e.extend({init:function(){this.progressBarDivision=0,this.subProgressArray=[0],this._MaxValue=100,this.progress=new t},registerSubProgress:function(){return this.progressBarDivision++,this.subProgressArray[this.progressBarDivision]=0,this.progressBarDivision},registerMultipleSubProgress:function(e){for(var t=[],i=0;i<e;++i)t.push(this.registerSubProgress());return t},getSubProgressDivisions:function(){return this.progressBarDivision},resetProgress:function(){this._OldValue=0,this._CurrentValue=0,this.progressBarDivision=0,this.subProgressArray=[0]},dispose:function(){this.resetProgress(),this.progressBarDivision=void 0,this.subProgressArray=[],this._MaxValue=void 0,this.progress.dispose()},advanceToMax:function(e){e&&this.setAbsoluteProgress(e,this._MaxValue)},setAbsoluteProgress:function(e,t){e&&e<=this.progressBarDivision&&(t<=100&&(this.subProgressArray[e]=t),this._advance())},setIncrementalProgress:function(e,t){e&&e<=this.progressBarDivision&&(this.subProgressArray[e]+t<=100&&(this.subProgressArray[e]+=t),this._advance())},setIndeterminateState:function(){this.progress.updateProgression(-1)},showProgressBar:function(){this.progress.visible()},hideProgressBar:function(){this.progress.hide()},getProgressBarState:function(){return this.progress.getProgressBarState()},addProgressBarIntoUI:function(e){e.appendChild(this.progress.getContent())},_getProgress:function(){return{loaded:this._CurrentValue,total:this._MaxValue}},_advance:function(){var e=0;this.subProgressArray.forEach(function(t){0!==t&&(e+=t)}),e/=this.progressBarDivision,this._CurrentValue=e,this._CurrentValue-this._OldValue>=0?(this._OldValue=this._CurrentValue,this._updateProgressBar(),this.onAdvance&&this.onAdvance(this._getProgress())):this._CurrentValue-this._MaxValue>.001&&console.error("[3DPlay/PhaseProgress] _CurrentValue > _MaxValue ("+this._CurrentValue+" > "+this._MaxValue+")")},_updateProgressBar:function(){this.progress.updateProgression(this._CurrentValue)},_CurrentValue:0,_OldValue:0})}),define("DS/3DPlayWidgetControllers/3DPlayWidgetProxyBase",["UWA/Class","DS/PlatformAPI/PlatformAPI"],function(e,t){"use strict";return e.extend({tokens:[],prefix:"DS/MessageBusEvent",suffixe:void 0,init:function(e){this.configure(e)},configure:function(e){e&&(e.prefix&&(this.prefix=e.prefix),e.suffixe&&(this.suffixe=e.uffixe))},dispose:function(){for(var e=this.tokens.length;e--;)t.unsubscribe(this.tokens[e]);this.tokens=[]},computePath:function(e){var t=this.prefix+"/"+e;return this.suffixe&&(t+="/"+this.suffixe),t},publish:function(e,i){t.publish(this.computePath(e),i)},subscribe:function(e,i){this.tokens.push(t.subscribe(this.computePath(e),i))}})}),define("DS/WebSystem/Rsc",["DS/RuntimeView/RSCManager","UWA/Class"],function(e,t){"use strict";return t.singleton({init:function(e){},loadRsc:function(t){e.loadResource({resourceFile:t})},rsc:function(t,i,n){e.onResourceLoaded({resourceFile:t},function(){if(Array.isArray(i)){for(var e=[],t=0;t<i.length;t++)e[t]=this.getIcon({key:i[t].iconName,size:i[t].iconSize});n(e)}else n(this.getIcon({key:i.iconName,size:i.iconSize}))}),e._listOfResources&&e._listOfResources[t]||this.loadRsc(t)}})}),define("DS/WebUtils/StringUtils",["UWA/Class"],function(e){"use strict";var t={fileExtension:/(?:\.([^./]+)(?:\.\d)?)?$/,urlprotocol:/(^[A-Za-z]+)\:\/\//,urlhostname:/(?:\:\/\/)(?=(.+)\:|\/)/,urlhostport:/(?:\:)(?=([0-9]+))/,rooturi:/(?:\:\/\/[^\/]+\/)(?=(.+))/,isInt:/^(\-|\+)?([0-9]+|Infinity)$/};return e.singleton({init:function(e){},sprintf:function(){for(var e=arguments[0],t=0,i=arguments.length-1;t<i;t++)e=e.replace("{"+t+"}",arguments[t+1]);return e},parseUrl:function(e){var i={},n=e.match(/^(^[A-Za-z]+)\:\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/);if(n)i={protocol:n[1],host:n[2],hostname:n[3],port:n[4]?parseInt(n[4]):{http:80,https:443}[n[1]],pathname:n[5].substring(1),search:n[6],hash:n[7]};else{if(i.protocol=t.urlprotocol.exec(e),null===i.protocol||void 0===i.protocol)return null;i.protocol=i.protocol[1],i.hostname=t.urlhostname.exec(e),null!==i.hostname&&void 0!==i.hostname&&(i.hostname=i.hostname[1]),i.port=t.urlhostport.exec(e),null!==i.port&&void 0!==i.port&&(i.port=i.port[1]),i.pathname=t.rooturi.exec(e),null!==i.pathname&&void 0!==i.pathname&&(i.pathname=i.pathname[1])}if(i.pathname){var r=i.pathname.indexOf("/");i.rooturi=i.pathname.substring(0,r>-1?r:i.pathname.length)}return i},getExtension:function(e){if(null==e||""===e)return"";var i,n=e.indexOf("?")+1,r=e;n&&(r=e.substring(0,e.indexOf("?")));var s=t.rooturi.exec(r);return s=null!=s?s[1]:e,null!=(i=t.fileExtension.exec(s))&&(i=i[1]),null!=i?i:""},filterInt:function(e){return t.isInt.test(e)?Number(e):NaN}})}),define("DS/WebSystem/UrlTools",[],function(){return{getURLParameters:function(){var e,t={},i=/([^&=]+)=?([^&]*)/g,n=window.location.toString();for(n=n.substring(n.indexOf("?")+1);e=i.exec(n);)t[decodeURIComponent(e[1])]=decodeURIComponent(e[2]);return t}}}),define("DS/WebUtils/ContextedSingleton",["UWA/Class"],function(e){"use strict";return e.singleton({data:{},init:function(){},add:function(e,t,i){var n=this.data[e];void 0===n&&(n=this.data[e]={}),n[t]=i},get:function(e,t){var i=this.data[e];return void 0!==i?i[t]:i},remove:function(e,t){var i=this.data[e];return void 0!==i&&void 0!==i[t]&&(i[t].dispose&&i[t].dispose(),i[t]=null,delete i[t]),this},removeCtx:function(e){if(this.data[e]){for(var t in this.data[e])this.remove(e,t);delete this.data[e]}return this}})}),define("DS/WebUtils/State",["UWA/Class"],function(e){"use strict";var t=0;return e.extend({init:function(e){this.name=e.name||"undefined"+t++,this._restore=e.restore,this.getValue=e.getValue,this.initValue=e.getValue()},getValue:function(){},restore:function(){this._restore(this.initValue)},getInitialValue:function(){return this.initValue}})}),define("DS/WebUtils/FunctionDisposer",["UWA/Class"],function(e){"use strict";return e.extend({init:function(e){this._parent(),this.disposeFunctions=[]},add:function(e){this.disposeFunctions.push(e)},dispose:function(){for(var e=this.disposeFunctions.length;e--;)this.disposeFunctions[e]&&(this.disposeFunctions[e](),this.disposeFunctions[e]=null),delete this.disposeFunctions[e]}})}),define("DS/WebSystem/MemoryInfo",[],function(){"use strict";return function(e){var t=e&&e.size||1048576;return"undefined"!=typeof gc&&gc(),window.performance&&window.performance.memory&&window.performance.memory.usedJSHeapSize?Math.floor(window.performance.memory.usedJSHeapSize/t):0}}),define("DS/WebUtils/GraphicOption",["UWA/Class"],function(e){"use strict";return e.extend({init:function(e){this.name=e.name,this.settingName=e.settingName,this.defaultValue=e.defaultValue,this.nlsTitle=e.nlsTitle,this.enabled=!0,this.available=!0,this.viewer=e.viewer},enable:function(){this.enabled=!0,this.activateFunc(!0)},disable:function(){this.enabled=!1,this.activateFunc(!1)},refreshAvailability:function(){this.available=this.getCurrentState(),this.enabled=this.available},activateFunc:function(e){},getCurrentState:function(){return!0}})}),define("DS/WebSystem/Settings",["UWA/Core","UWA/Class"],function(e,t){"use strict";var i=t.singleton({init:function(){this.storageSystem=null;var e=!1;try{e="localStorage"in window&&null!==window.localStorage&&void 0!==window.localStorage}catch(t){e=!1}e&&void 0===this.localStorage.get("ODT_SETTINGS_COOKIE")?this.storageSystem=this.localStorage:this.storageSystem=this.cookies},set:function(e,t){this.storageSystem.set(e,t)},get:function(e,t){var i=this.storageSystem.get(e);return void 0===i&&(i=t),i},remove:function(e){this.storageSystem.remove(e)},localStorage:{set:function(e,t){localStorage[e]=t},get:function(e){return localStorage[e]},remove:function(e){localStorage.removeItem(e)}},cookies:{set:function(e,t){document.cookie=e+"="+t},get:function(e){var t=document.cookie,i=t.indexOf(" "+e+"=");if(-1==i&&(i=t.indexOf(e+"=")),-1==i)t=null;else{i=t.indexOf("=",i)+1;var n=t.indexOf(";",i);-1==n&&(n=t.length),t=unescape(t.substring(i,n))}return null!==t&&""!==t||(t=void 0),t},remove:function(e){document.cookie=e+"="}}});return e.namespace("SHARE/Settings",i)}),define("DS/WebSystem/DataUrlTools",["UWA/Class"],function(e){return e.singleton({toBlob:function(e){for(var t=e.match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/),i=atob(t[3]),n=new ArrayBuffer(i.length),r=new Uint8Array(n),s=0;s<r.length;s++)r[s]=i.charCodeAt(s);var a=new Blob([r],{type:t[1]});return window.URL.createObjectURL(a)}})}),define("DS/3DPlayHelper/SplashScreen",["DS/WebappsUtils/WebappsUtils","UWA/Core","UWA/Element","UWA/Controls/Abstract","css!DS/3DPlayHelper/SplashScreen","DS/CoreEvents/Events","i18n!DS/3DPlayHelper/assets/nls/SplashScreen"],function(e,t,i,n,r,s,a){"use strict";return n.extend({defaultOptions:{},views:{},init:function(e){if(this._parent(e),this._buildView(e),e){if(!0===e.autoplay)this.showView(this.views.loading),setTimeout(e.onClick);else{var t=function(){this.showView(this.views.loading),this.removeOnClick(),e.onClick&&e.onClick(this),t=null}.bind(this);this.setOnClick(t)}e.container&&(e.containerOptions?e.containerOptions.insertBefore&&e.container.insertBefore(this.elements.container,e.container.firstElementChild):this.inject(e.container)),e.callback&&e.callback(this)}},_buildView:function(t){var n=document.createDocumentFragment();this.formFactor="",n.ownerDocument.documentElement.offsetWidth>780&&n.ownerDocument.documentElement.offsetHeight>200?this.formFactor="L":n.ownerDocument.documentElement.offsetWidth<779&&n.ownerDocument.documentElement.offsetWidth>581&&n.ownerDocument.documentElement.offsetHeight>200?this.formFactor="M":n.ownerDocument.documentElement.offsetWidth<580&&n.ownerDocument.documentElement.offsetWidth>280&&n.ownerDocument.documentElement.offsetHeight>200?this.formFactor="S":n.ownerDocument.documentElement.offsetWidth<280||n.ownerDocument.documentElement.offsetHeight<200?this.formFactor="XS":this.formFactor="L",this.custoContainer=new i("div",{class:"PlayWeb-bgd-custo"}).inject(n);var r=this;if(t&&void 0!==t.custom&&null!==t.custom)if("string"==typeof t.custom){this.custoContainer.innerHTML=t.custom;var s=e.getWebappsBaseUrl()+"3DPlayHelper/assets/images/Xsmall_button_withHalo-03.svg";r.clickLogoImg=new i("div",{class:"click-logo-img",display:"block",styles:{"background-image":"url('"+s+"')"}}).inject(this.custoContainer)}else try{this.custoContainer.appendChild(t.custom)}catch(e){}var a=new i("div",{styles:{width:"100%",height:"100%"}}),o=t?t.logoDisplay:void 0,l=t&&"string"==typeof t.customLogoSrc?t.customLogoSrc:void 0,c=t&&"string"==typeof t.customAppName?t.customAppName:void 0;if(this._add3DPlayLogoView(a,o,l,c),this._addLoadingView(a),this._addNotificationView(a),this._addErrorView(a),this.showView=function(e){for(var t in this.views)this.views.hasOwnProperty(t)&&(this.views[t].style.display="none");e.style.display="block"},n.appendChild(a),"onHover"===o){r=this;a.addEvents({mouseenter:function(){r.clickLogoImg&&(r.clickLogoImg.style.opacity=1),void 0!==r.options.custom&&null!==r.options.custom||(r.viewLogo.style.opacity=1)},mouseleave:function(){r.clickLogoImg&&(r.clickLogoImg.style.opacity=0),void 0!==r.options.custom&&null!==r.options.custom||(r.viewLogo.style.opacity=0)}})}this.elements.container=new i("div",{class:"SHAREPluginless_background"}),t&&"string"==typeof t.customBgColor&&(this.elements.container.style.backgroundColor=t.customBgColor),this.elements.container.appendChild(n)},_add3DPlayLogoView:function(n,r,s,a){var o={display:"block","background-image":"url('"+(s||e.getWebappsBaseUrl()+"3DPlayHelper/assets/images/3DPlayOnclickPage.svg")+"')"};"onHover"===r&&t.extend(o,{opacity:0,transition:"opacity 0.5s ease-in-out"}),this.viewLogo=new i("div",{class:"PlayWeb-splash-view",styles:o}).inject(n),this.views.logo=this.viewLogo},_addLoadingView:function(t){var n,r=new Image;r.onload=function(){s.publish({event:"SPLASHSCREEN"})},this.viewLoading=new i("div",{class:"PlayWeb-splash-view",styles:{display:"none",cursor:"progress"}}).inject(t),"L"===this.formFactor?n=e.getWebappsBaseUrl()+"3DPlayHelper/assets/images/3DPlayLandingPage.svg":"M"===this.formFactor?n=e.getWebappsBaseUrl()+"3DPlayHelper/assets/images/3DPlayLandingPage.svg":"S"===this.formFactor?n=e.getWebappsBaseUrl()+"3DPlayHelper/assets/images/Small-02.svg":"XS"===this.formFactor&&(n=e.getWebappsBaseUrl()+"3DPlayHelper/assets/images/Xsmall-03.svg"),this.viewLoading.style.backgroundImage="url("+n+")",r.src=n,this.views.loading=this.viewLoading},_addNotificationView:function(t){this.notificationView=new i("div",{class:"PlayWeb-splash-view",styles:{display:"none","background-image":"url('"+e.getWebappsBaseUrl()+"3DPlayHelper/assets/images/3DPlayErrorPage.svg')"}}).inject(t),this.notificationContainer=document.createElement("p"),this.notificationContainer.setAttribute("class","SHAREPluginless_notif"),this.notificationView.appendChild(this.notificationContainer),this.views.notification=this.notificationView},_addErrorView:function(t){this.viewError=new i("div",{class:"PlayWeb-splash-view",styles:{display:"none","background-image":"url('"+e.getWebappsBaseUrl()+"3DPlayHelper/assets/images/3DPlayErrorPage.svg')"}}).inject(t),this.fatalContainer=document.createElement("p"),this.fatalContainer.setAttribute("class","SHAREPluginless_notif_fatal"),this.promptedContainer=document.createElement("p"),this.promptedContainer.setAttribute("class","PlayWeb-notif-prompted"),this.viewError.appendChild(this.fatalContainer),this.viewError.appendChild(this.promptedContainer),this.views.error=this.viewError},refreshOptions:function(e){for(;this.custoContainer.firstChild;)this.custoContainer.removeChild(this.custoContainer.firstChild);if(e&&void 0!==e.custom&&null!==e.custom)if("string"==typeof e.custom)this.custoContainer.innerHTML=e.custom;else try{this.custoContainer.appendChild(e.custom)}catch(e){console.error(e)}},setOnClick:function(e){this.clickCB&&this.removeOnClick(),this.clickCB=e,this.elements.container.style.cursor="pointer",this.elements.container.addEventListener("click",this.clickCB,!1)},removeOnClick:function(){void 0!==this.clickCB&&(this.elements.container.style.cursor="",this.elements.container.removeEventListener("click",this.clickCB,!1),this.clickCB=void 0)},showFatal:function(e,t,i,n){this.fatalContainer.innerHTML="",n&&n.name&&a.get(n.name)?this.fatalContainer.appendChild(document.createTextNode(a.get(n.name))):this.fatalContainer.appendChild(document.createTextNode(a.TextFatal)),t&&(this.promptedContainer.innerText="",this.promptedContainer.appendChild(document.createTextNode(e))),console.error("3DPlay Fatal : "+e),i&&this.fatalContainer.appendChild(i),this.showView(this.views.error),this.elements.container.style.display="block"},showNotification:function(e){this.notificationContainer.textContent=e,this.showView(this.views.notification),this.elements.container.style.display="block"}})}),define("DS/WebSystem/Context",["UWA/Class"],function(e){"use strict";var t={};return e.singleton({createContext:function(e){var i=e||"Context";return void 0===t[i]&&(t[i]=-1),t[i]++,i+(t[i]>0?"_"+t[i]:"")}})}),define("DS/WebUtils/Vector2",["UWA/Class"],function(e){"use strict";return e.extend({init:function(e,t){this.x=e||0,this.y=t||0},set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?this.addVectors(e,t):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?this.subVectors(e,t):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampLength:function(e,t){var i=this.length();return this.multiplyScalar(Math.max(e,Math.min(t,i))/i)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y;return t*t+i*i},distanceToManhattan:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.multiplyScalar(e/this.length())},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t){return this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var i=Math.cos(t),n=Math.sin(t),r=this.x-e.x,s=this.y-e.y;return this.x=r*i-s*n+e.x,this.y=r*n+s*i+e.y,this}})}),define("DS/3DPlayConnectors/OneDriveConnector",["DS/3DPlayConnectors/CAT3DPlayConnector","DS/WAFData/WAFData","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(e,t,i){"use strict";return e.extend({init:function(e){this._parent(e),this.xOneDriveId=null,this.currentDataTitle=null,this.xOneDriveParentUri1="/drive/v1/onedrive/contents/",this.xOneDriveParentUri2="/stream?xrequestedwith=xmlhttprequest",this.monoFileUri=null,this.assemblyUri=null,this.onFailCB=null,this.connectorsOnSuccessCB=null},open:function(e,t,i){var n=this;this.rawAsset=e,this.xOneDriveId=e.physicalid,this.onFailCB=i,this.connectorsOnSuccessCB=t,this._startOneDriveBusinessExpand(e,e.serverurl||!1,function(e){n._returnNewOneDriveAsset(e,t)})},_setOneDriveWSUri:function(e,t){var i=t[0].url,n=e.physicalid;this.metaDataWsUri=i+this.xOneDriveParentUri1+n,this.monoFileUri=i+this.xOneDriveParentUri1+n+this.xOneDriveParentUri2,this.assemblyUri=this.monoFileUri},_getOneDriveServiceURL:function(e,t){var n=this;i.getServiceUrl({serviceName:"driveshub",platformId:e,onComplete:function(e){t(e)},onFailure:function(){n.onFailCB("Error in  OneDriveConnector._getOneDriveServiceURL")}})},_startOneDriveBusinessExpand:function(e,t,i){var n=this;t&&UWA.is(t[0].url,"string")?(this._setOneDriveWSUri(e,t),this._getPartMetaData(i)):this._getOneDriveServiceURL("",function(t){UWA.is(t),n._startOneDriveBusinessExpand(e,t,i)})},_getPartMetaData:function(){var e=this,i=this.metaDataWsUri;t.authenticatedRequest(i,{method:"GET",type:"json",onComplete:function(t){e.currentDataTitle=t.title,e._returnNewOneDriveAsset(t)},onFailure:function(t){-1!==t.message.indexOf("404")?e.onFailCB({NLS_ID:"LoadingDocument404"}):e.onFailCB({NLS_ID:"LoadingError_LOAD"})}})},_returnNewOneDriveAsset:function(e){var t=this.monoFileUri,i=e.extension,n={provider:"FILE",filename:t,format:i,type:i,url:t,mimetype:i,requestsOptions:{proxy:"none",method:"GET",authentication:"passport"}};this.connectorsOnSuccessCB(n)}})}),define("DS/WebUtils/GeometryUtils",["DS/WebUtils/Vector2"],function(e){"use strict";return{convexHullCompute:function(e){for(var t=e.slice().sort(function(e,t){return e.x==t.x?e.y-t.y:e.x-t.x}),i=[],n=0;n<t.length;n++){for(;i.length>=2&&this._leftTurn(i[i.length-2],i[i.length-1],t[n]);)i.pop();i.push(t[n])}i.pop();var r=i.length+2;for(n=t.length-1;n>=0;n--){for(;i.length>=r&&this._leftTurn(i[i.length-2],i[i.length-1],t[n]);)i.pop();i.push(t[n])}return i.pop(),i},boundingBoxCompute:function(t){for(var i=Number.MAX_VALUE,n=[],r=[],s=0,a=0,o=0,l=0,c=0;c<t.length;c++)r.push(t[(c+1)%t.length].clone().sub(t[c]).normalize()),t[c].x<t[s].x&&(s=c),t[c].x>t[a].x&&(a=c),t[c].y<t[l].y&&(l=c),t[c].y>t[o].y&&(o=c);var u=new e(-1,0),d=new e(0,-1);for(c=0;c<t.length;c++){var p=[d.dot(r[s]),-d.dot(r[a]),u.dot(r[o]),-u.dot(r[l])];switch(p.indexOf(Math.max.apply(Math,p))){case 0:(u=r[s].clone()).set(u.y,-u.x),s=(s+1)%t.length;break;case 1:(u=r[a].clone().negate()).set(u.y,-u.x),a=(a+1)%t.length;break;case 2:u=r[o].clone(),o=(o+1)%t.length;break;case 3:u=r[l].clone().negate(),l=(l+1)%t.length}(d=u.clone().negate()).set(d.y,-d.x);var h=this._intersection(t[s],d,t[o]),D=this._intersection(t[a],d,t[o]),f=this._intersection(t[l],u,t[s]),g=this._intersection(t[l],u,t[a]),m=h.distanceTo(D)*h.distanceTo(f);m<i&&(n=[h,f,g,D],i=m)}return n},isIntersect:function(e,t){for(var i=0;i<e.length;i++)for(var n=0;n<t.length;n++)if(this._intersect(e[i],e[(i+1)%e.length],t[n],t[(n+1)%t.length]))return!0;return!1},isOverlap:function(e,t){var i=this.isIntersect(e,t);return!1===i&&(this._isInsidePolygon(e[0],t)&&(i=!0),this._isInsidePolygon(t[0],e)&&(i=!0)),i},getCurveLength:function(e){for(var t=0,i=0;i<e.length-1;i++)t+=e[i+1].clone().sub(e[i]).length();return t},getTopLeftPoint:function(t){new e(9999,9999);for(var i=9999,n=9999,r=0;r<t.length;r++)t[r].x<i&&(i=t[r].x),t[r].y<n&&(n=t[r].y);return new e(i,n)},getBarycenter2D:function(t){for(var i=new e,n=0;n<t.length;n++)i.x+=t[n].x,i.y+=t[n].y;return i.x/=t.length,i.y/=t.length,i},getBarycenter:function(e){for(var t={x:0,y:0,z:0},i=0;i<e.length;i++)t.x+=e[i].x,t.y+=e[i].y,t.z+=e[i].z;return t.x/=i,t.y/=i,t.z/=i,t},_isInsidePolygon:function(e,t){for(var i=0,n=0;n<t.length;n++)t[n].y<=e.y?t[(n+1)%t.length].y>e.y&&this._isLeft(t[n],t[(n+1)%t.length],e)&&i++:t[(n+1)%t.length].y<=e.y&&(this._isLeft(t[n],t[(n+1)%t.length],e)||i--);return!(0==i)},_isnearPolygon:function(e,t,i,n){var r=6;n&&(r=n),r/=i;for(var s=0;s<t.length;s++){var a=e.x-t[s].x,o=e.y-t[s].y;if(Math.sqrt(a*a+o*o)<r)return!0}return!1},_leftTurn:function(e,t,i){return(t.x-e.x)*(i.y-t.y)-(t.y-e.y)*(i.x-t.x)<=0},_isLeft:function(e,t,i){return(t.x-e.x)*(i.y-e.y)-(i.x-e.x)*(t.y-e.y)>=0},_intersect:function(e,t,i,n){return(this._isLeft(e,i,n)?1:0)^(this._isLeft(t,i,n)?1:0)&&(this._isLeft(i,e,t)?1:0)^(this._isLeft(n,e,t)?1:0)},_intersection:function(t,i,n){var r=((t.x-n.x)*i.x-(n.y-t.y)*i.y)/(-i.x*i.x-i.y*i.y);return new e(t.x+r*i.x,t.y+r*i.y)},_checkEqual:function(e,t){return Math.abs(t-e)<=.1},wrapText:function(e){var t=e.canvasCtx,i=e.text,n=e.width,r=e.height,s=[],a=0;if(!t){var o=document.createElement("canvas");o.width=n,o.height=r,(t=o.getContext("2d")).font=e.font}for(var l=i.split("\n"),c=0;c<l.length;c++){for(var u="",d="",p=l[c].split(" "),h=0;h<p.length;h++){var D=h<p.length-1?p[h]+" ":p[h],f=Math.max(t.measureText(p[h]).width,Math.abs(t.measureText(p[h]).actualBoundingBoxLeft)+Math.abs(t.measureText(p[h]).actualBoundingBoxRight));if(f<=n||this._checkEqual(f,n)){if(d+=D,(m=Math.max(t.measureText(d).width,Math.abs(t.measureText(d).actualBoundingBoxLeft)+Math.abs(t.measureText(d).actualBoundingBoxRight)))<=n||this._checkEqual(m,n))u=d;else s.push(u),a=(y=Math.max(t.measureText(u).width,Math.abs(t.measureText(u).actualBoundingBoxLeft)+Math.abs(t.measureText(u).actualBoundingBoxRight)))>a?y:a,u=d=d.substring(u.length)}else{if(u.length>0)s.push(u),a=(y=Math.max(t.measureText(u).width,Math.abs(t.measureText(u).actualBoundingBoxLeft)+Math.abs(t.measureText(u).actualBoundingBoxRight)))>a?y:a,d=d.substring(u.length),u="";for(var g=0;g<D.length;g++){var m;if(d+=D[g],(m=Math.max(t.measureText(d).width,Math.abs(t.measureText(d).actualBoundingBoxLeft)+Math.abs(t.measureText(d).actualBoundingBoxRight)))<=n||this._checkEqual(m,n))u=d;else s.push(u),a=(y=Math.max(t.measureText(u).width,Math.abs(t.measureText(u).actualBoundingBoxLeft)+Math.abs(t.measureText(u).actualBoundingBoxRight)))>a?y:a,u=d=d.substring(u.length)}}}var y;s.push(u),a=(y=Math.max(t.measureText(u).width,Math.abs(t.measureText(u).actualBoundingBoxLeft)+Math.abs(t.measureText(u).actualBoundingBoxRight)))>a?y:a}return{wrappedLines:s,width:a}}}}),define("DS/3DPlayConnectors/3DSwymConnector",["DS/3DPlayConnectors/CAT3DPlayConnector","DS/WAFData/WAFData","DS/i3DXCompassServices/i3DXCompassServices"],function(e,t,i){"use strict";return e.extend({init:function(e){this.name="3DSwymConnector",this._parent(e),this.x3DSwymMediaId=null,this.x3DSwymURI=null,this.x3DSwymServerToken=null,this.x3DSwymServerTokenUrl="/api/index/tk",this.x3DSwymGetMediaUrl="/api/media/get",this.inConnectorMode=!0,this.onFailCB=null},open:function(e,t,i){if(e&&e.objectId){var n=e.objectId.lastIndexOf(":");this.x3DSwymMediaId=n>-1?e.objectId.substring(n+1):e.objectId}this.onFailCB=i,e.serverurl&&UWA.is(e.serverurl,"string")?(this.x3DSwymURI=e.serverurl,this._getCSRFToken(this.x3DSwymURI,t)):this._get3DSwymServiceURL(e.envId,t)},_get3DSwymServiceURL:function(e,t){var n=this;i.getServiceUrl({serviceName:"3DSwym",platformId:e,onComplete:function(e){n.x3DSwymURI=e,n._getCSRFToken(n.x3DSwymURI,t)},onFailure:function(){n.onFailCB("Unable to retrieve 3DSwym Service URL")}})},_getCSRFToken:function(e,i){var n=e+this.x3DSwymServerTokenUrl,r=this;t.authenticatedRequest(n,{method:"GET",type:"json",onComplete:function(e){if(e&&e.result&&e.result.ServerToken){e.result.ServerToken;r.x3DSwymServerToken=e.result.ServerToken,r._getMediaInfosAndStreamUri(i)}else console.error("Services Reach, but Error in return "),r.onFailCB("Unable to retrieve 3DSwym Service URL")},onFailure:function(e){console.error("Service unReach",e)}})},_getMediaInfosAndStreamUri:function(e){var i=this,n=this.x3DSwymURI+this.x3DSwymGetMediaUrl,r=i.x3DSwymMediaId;t.authenticatedRequest(n,{method:"POST",type:"json",data:JSON.stringify({request_id:"0",params:{id_media:r}}),headers:{"Content-Type":"application/json","X-DS-SWYM-CSRFTOKEN":i.x3DSwymServerToken},onComplete:function(t){if(t.errorcode||""==t.errorcode)console.error(t.errorcode,t.errormsg),i.onFailCB("Unable to get Meta Data for this model");else{var n=t.result;i.inConnectorMode?e(i.returnSwymNewAsset(n)):e(n)}},onFailure:function(e){i.onFailCB("Unable to get Meta Data for this model")}})},get3DSwymMetaData:function(e,t,i){this.onFailCB=i,this.inConnectorMode=!1;var n=e.data.items[0];this.x3DSwymMediaId=n.objectId,this._get3DSwymServiceURL(n.envId,t)},returnSwymTransientUrl:function(e){var t=e.play;return t.hasOwnProperty("3d_streams")&&Array.isArray(t["3d_streams"])?t["3d_streams"][0].transient_url:t.download_original_url.transient_url_as_attachment},returnSwymAssetInfo:function(e,t){var i,n,r=e.play;if(r){if(r.hasOwnProperty("best_streams")){var s=r.best_streams;if(s){var a=r[s];if(Array.isArray(a)&&a.length>0){var o=r[s][0];o&&(i=o.format,n=o.transient_url)}}}if(null==n){var l=r.download_original_url;l&&(i=l.format)&&(n=l.transient_url_as_attachment)}if(n)return t.format=i,t.filename=n,t.swymAttr=e,t.swymServerToken=this.x3DSwymServerToken,"3dxml"===i&&(t.type=t.format=t.mimetype="XMLV43"),t}},returnSwymNewAsset:function(e){return this.returnSwymAssetInfo(e,{provider:"FILE",requestsOptions:{authentication:"passport",proxy:"none"}})}})}),define("DS/3DPlayConnectors/DropboxConnector",["DS/3DPlayConnectors/CAT3DPlayConnector","DS/WAFData/WAFData","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(e,t,i){"use strict";return e.extend({init:function(e){this._parent(e),this.xDropboxId=null,this.currentDataTitle=null,this.xDropboxParentUri1="/drive/v1/dropbox/contents/",this.xDropboxParentUri2="/stream?xrequestedwith=xmlhttprequest",this.monoFileUri=null,this.assemblyUri=null,this.onFailCB=null,this.connectorsOnSuccessCB=null},open:function(e,t,i){var n=this;this.rawAsset=e,this.xDropboxId=e.physicalid,this.onFailCB=i,this.connectorsOnSuccessCB=t,this._startDropboxBusinessExpand(e,e.serverurl||!1,function(e){n._returnNewDropboxAsset(e,t)})},_setDropboxWSUri:function(e,t){var i=t[0].url,n=e.physicalid;this.metaDataWsUri=i+this.xDropboxParentUri1+n,this.monoFileUri=i+this.xDropboxParentUri1+n+this.xDropboxParentUri2,this.assemblyUri=this.monoFileUri},_getDropboxServiceURL:function(e,t){var n=this;i.getServiceUrl({serviceName:"driveshub",platformId:e,onComplete:function(e){t(e)},onFailure:function(){n.onFailCB("Error in  thatDropboxConnector._getDropBoxServiceURL")}})},_startDropboxBusinessExpand:function(e,t,i){var n=this;t&&UWA.is(t[0].url,"string")?(this._setDropboxWSUri(e,t),this._getPartMetaData(i)):this._getDropboxServiceURL("",function(t){UWA.is(t),n._startDropboxBusinessExpand(e,t,i)})},_getPartMetaData:function(){var e=this,i=this.metaDataWsUri;t.authenticatedRequest(i,{method:"GET",type:"json",onComplete:function(t){e.currentDataTitle=t.title,e._returnNewDropboxAsset(t)},onFailure:function(t){-1!==t.message.indexOf("404")?e.onFailCB({NLS_ID:"LoadingDocument404"}):e.onFailCB({NLS_ID:"LoadingError_LOAD"})}})},_returnNewDropboxAsset:function(e){var t=this.monoFileUri,i=e.extension,n={provider:"FILE",filename:t,format:i,type:i,url:t,mimetype:i,requestsOptions:{proxy:"none",method:"GET",authentication:"passport"}};this.connectorsOnSuccessCB(n)}})}),define("DS/3DPlayConnectors/GoogleConnector",["DS/3DPlayConnectors/CAT3DPlayConnector","DS/WAFData/WAFData","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(e,t,i){"use strict";return e.extend({init:function(e){this._parent(e),this.xGoogleId=null,this.currentDataTitle=null,this.xGoogleParentUri1="/drive/v1/google/contents/",this.xGoogleParentUri2="/stream?xrequestedwith=xmlhttprequest",this.monoFileUri=null,this.assemblyUri=null,this.onFailCB=null,this.connectorsOnSuccessCB=null},open:function(e,t,i){var n=this;this.rawAsset=e,this.xGoogleId=e.physicalid,this.onFailCB=i,this.connectorsOnSuccessCB=t,this._startGoogleBusinessExpand(e,e.serverurl||!1,function(e){n._returnNewGoogleAsset(e,t)})},_setGoogleWSUri:function(e,t){var i=t[0].url,n=e.physicalid;this.metaDataWsUri=i+this.xGoogleParentUri1+n,this.monoFileUri=i+this.xGoogleParentUri1+n+this.xGoogleParentUri2,this.assemblyUri=this.monoFileUri},_getGoogleServiceURL:function(e,t){var n=this;i.getServiceUrl({serviceName:"driveshub",platformId:e,onComplete:function(e){t(e)},onFailure:function(){n.onFailCB("Error in  thatGoogleConnector._getGoogleServiceURL")}})},_startGoogleBusinessExpand:function(e,t,i){var n=this;t&&UWA.is(t[0].url,"string")?(this._setGoogleWSUri(e,t),this._getPartMetaData(i)):this._getGoogleServiceURL("",function(t){UWA.is(t),n._startGoogleBusinessExpand(e,t,i)})},_getPartMetaData:function(){var e=this,i=this.metaDataWsUri;t.authenticatedRequest(i,{method:"GET",type:"json",onComplete:function(t){e.currentDataTitle=t.title,e._returnNewGoogleAsset(t)},onFailure:function(t){-1!==t.message.indexOf("404")?e.onFailCB({NLS_ID:"LoadingDocument404"}):e.onFailCB({NLS_ID:"LoadingError_LOAD"})}})},_returnNewGoogleAsset:function(e){var t=this.monoFileUri,i=e.extension,n={provider:"FILE",filename:t,format:i,type:i,url:t,mimetype:i,requestsOptions:{proxy:"none",method:"GET",authentication:"passport"}};this.connectorsOnSuccessCB(n)}})}),define("DS/WebSystem/BrowserInfos",["DS/WebSystem/DetectBrowser"],function(e){"use strict";var t=e(),i=!!(navigator.userAgent.match(/(Android|iPhone|iPad)/i)||(/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)&&!window.MSStream),n=!1;return i&&"iPhone"==navigator.platform&&(n=!0),{isMobile:function(){return i},browser:t,is_iPhone:n}}),define("DS/WebSystem/Preference",["DS/WebSystem/Settings"],function(e){"use strict";let t;return setTimeout(function(){require(["DS/WebSystem/Environment"],function(e){t=e.isSet("3DPlay.EmulateWidgetPrefs")})},200),{isAvailable:function(){return"undefined"!=typeof widget},delete:function(i){t?e.remove(i):this.isAvailable()&&widget.deleteValue(i)},set:function(i,n){t?e.set(i,n):this.isAvailable()&&widget.setValue(i,n)},get:function(i){if(t)return e.get(i);let n;return this.isAvailable()&&(n=widget.getValue(i)),n},setObject:function(e,t){this.set(e,JSON.stringify(t))},getObject:function(e){let t=this.get(e);return t?JSON.parse(t):{}}}}),define("DS/WebSystem/Environment",["UWA/Class","UWA/Core","UWA/Utils","DS/WebSystem/Settings","DS/WebSystem/Preference"],function(e,t,i,n,r){"use strict";return e.singleton({_parseURL:function(e){if(""!==e){var n=t.extend({},i.parseQuery(e));for(var r in n)this.set(r,n[r])}},init:function(){this.data={};try{this._parseURL(window.top.location.search)}catch(e){}this._parseURL(window.location.search)},set:function(e,t){e&&(this.data[e]=t)},isSet:function(e,t){var i=this.get(e);return void 0!==t?i===t:void 0!==i},get:function(e){var t=this.data[e];return void 0===t&&void 0!==n&&(t=n.get(e)),void 0===t&&void 0!==r&&(t=r.get(e)),t},remove:function(e){void 0!==this.data[e]&&delete this.data[e]},isBoolActive:function(e){return this.isSet(e,"true")||this.isSet(e,"1")}})}),define("DS/WebSystem/Assert",["DS/WebSystem/DetectBrowser","DS/WebSystem/Environment"],function(e,t){"use strict";return function(e,i){if(t.isSet("System.Assert.EnableAsserts")){var n,r=!0;switch(arguments.length){case 2:"string"==typeof arguments[1]?"string"==typeof arguments[0]?r=arguments[1]==arguments[0]:(r=arguments[0],n=arguments[1]):r=arguments[1]==arguments[0];break;case 1:r=arguments[0];break;default:return}if(0==r){var s="Assert Failed !!!\n";n?s+=n:(s+="Tested value: "+arguments[0]+"\n",s+="Expected value: "+arguments[1]),console.error(s)}return r}}}),define("DS/3DPlayHelper/3DPlayNativePlayer",["DS/WebSystem/Environment"],function(e){"use strict";return function(t){var i,n=["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","UWA/Utils/InterCom"],r={isReady:function(){return!0},load:function(e){if(i){var n;try{n=e.options.splashscreen}catch(e){n=null}i.refreshOptions(n)}t=e},loadAsset:function(e,t){this.load({input:e,options:t})}};return require(["DS/3DPlayHelper/SplashScreen","i18n!DS/3DPlayHelper/assets/nls/3DPlayHelper","DS/WebUtils/StringUtils"],function(r,s,a){var o={};o=t.options.splashScreen||o,(i=new r(o)).showView(i.views.logo);var l=t.container;"string"==typeof l&&(l=document.getElementById(l)),i.inject(l),require(n,function(n,r){console.log("Player3DPlayWeb: Trying to Launch 3DPlay Native");var a=function(){i.showView(i.views.loading);var a,o,l={appId:"X3DPLAY_AP"},c=function(t){if(e.isSet("ODT_3DPLAYHELPER_IOS_EVENT"))require(["DS/Core/Events"],function(t){t.publish({event:e.get("ODT_3DPLAYHELPER_IOS_EVENT")})});else{var a=StringUtils.parseUrl(t.tenantURL).hostname;a=a.toLowerCase(),n.getPlatformServices({onComplete:function(e){for(var n=t.modelID,o=null,c=0;c<e.length;c++){var u=e[c];for(var d in u){if(u.hasOwnProperty(d)&&"string"==typeof u[d])if(u[d].toLowerCase().contains(a)){o=u.platformId;break}}if(o)break}if(n&&o){var p=new r.Socket("compassPageSocket");p.subscribeServer("com.ds.compass",window.parent),p.dispatchEvent("onSetObject",{objectId:n,envId:o},"compassPageSocket"),p.addListener("launchApp",function(e){(console.log("Response = "+JSON.stringify(e)),this.response=e.response,"COMPLETE"!=this.response)&&(!0===confirm("To experience this content you need to install 3DPlay")&&(window.location="itms://itunes.apple.com/us/app/3dplay/id825988585?ls=1&mt=8"))}),p.dispatchEvent("onLaunchApp",l,"compassPageSocket")}else i.showFatal(s.TenantError,!1),i.showView(i.views.logo);i.showView(i.views.logo)},onFailure:function(){i.showFatal(s.PlatformNotFound,!1),i.showView(i.views.logo)}})}},u={};t.input&&("string"==typeof t.input?a=t.input:"string"==typeof t.input.asset?a=t.input.asset:t.input.asset.provider&&"string"==typeof t.input.asset.provider&&("FILE"===t.input.asset.provider.toUpperCase()?(a="",t.input.asset.serverurl&&(a+=t.input.asset.serverurl),t.input.asset.filename&&(a+=t.input.asset.filename)):"EV6"===t.input.asset.provider.toUpperCase()&&(u.modelID=t.input.asset.physicalid,u.tenantURL=t.input.asset.serverurl)),c(a?((o=a).indexOf("proxy/passport?")>-1&&o.indexOf("url=")>-1&&((o=o.substr(o.indexOf("url=")+4,o.length)).indexOf("&")>-1&&(o=o.substr(0,o.indexOf("&"))),o=decodeURIComponent(o)),{modelID:o.substr(o.lastIndexOf("/")+1,o.length),tenantURL:o.substr(0,o.lastIndexOf("/")+1)}):u))},o=document.createElement("a");o.setAttribute("href","#"),o.innerHTML="<U>"+s.LaunchNativeApp+"</U>",o.setAttribute("title",s.LaunchNativeApp),o.addEventListener("click",a,!1),i.showFatal(s.DeviceNotFullySupported,!0,o),i.setOnClick(a),i.showView(i.views.logo),e.isSet("ODT_3DPLAYHELPER_IOS")&&a()},function(e){if("scripterror"==e.requireType){var t=e.requireModules.join(",");console.error("3DPlay ScripNotFoundError: ",t),i.showFatal(s.ScripNotFoundError+t,!1)}else console.error(e)})},function(e){console.error("Player3DPlayWeb: 3DPlayRequire failed: "+e)}),r}}),define("DS/WebUtils/ProbesManager",["UWA/Class","DS/WebSystem/Environment","DS/WebSystem/Downloader"],function(e,t,i){"use strict";var n=!t.isSet("3DPlay.DisableProbes"),r="3DPlay_";"undefined"!=typeof widget&&widget.id&&(r=widget.id+"_3DPlay_");var s=[],a=0;return{createProbe:function(e,t,i){if(!n)return{begin:function(){},end:function(){},getTime:function(){}};var o={probeName:e,id:r+e,strMarkBegin:t||e+"_Begin_"+a,strMarkEnd:i||e+"_End_"+a,begin:function(){return window.performance.mark(this.strMarkBegin),this},end:function(){try{window.performance.mark(this.strMarkEnd),window.performance.measure(this.id,this.strMarkBegin,this.strMarkEnd)}catch(e){console.log(this.probeName,e)}},getTime:function(){var e=window.performance.getEntriesByName(this.id).pop();return e?Math.floor(e.duration):0}};if(t&&i)try{window.performance.measure(o.id,o.strMarkBegin,o.strMarkEnd)}catch(e){}return a++,s.push(o),o},createFunctionProbe:function(e,t,i){return n?(r="string"==typeof e?this.createProbe(e).begin():e,s=t,function(){r.end(),UWA.is(s,"function")&&s.apply(r,Array.prototype.slice.call(arguments)),r=null,s=null}):t;var r,s},createNetWorkProbe:function(e,t){var i=this.createProbe(e);return t.onComplete=this.createFunctionProbe(i,t.onComplete),t.onFailure=this.createFunctionProbe(i,t.onFailure),i},_parse:function(e){var t=0;for(t=s.length;t--;)if(s[t].probeName===e)return s[t];0===t&&console.error("Probe not found : ",e)},begin:function(e){var t=this.createProbe(e);return t.begin(),t},end:function(e){var t=this._parse(e);t&&t.end()},getTime:function(e){var t=this._parse(e);return t?t.getTime():0},GetProcessedData:function(e){var t,i,n=0,r=0,s=[],a="";if(e=e||{},"undefined"!=typeof widget&&widget.id&&(a=widget.id),window["3DPlay.ProbesManager.TopWindowNotAvailable"])t=window.performance.getEntriesByName(a+"clap"),Array.isArray(t)&&(t=t[0]),n=t.startTime;else{var o=window.top.performance.getEntriesByName(a+"clap");Array.isArray(o)&&(o=o[0]),t=window.performance.getEntriesByName(a+"clap"),Array.isArray(t)&&(t=t[0]),o&&t&&(n=t.startTime,r=o.startTime-t.startTime)}if(window.performance.getEntriesByType("measure").forEach(function(t){t.duration>2&&((!e.only3DPlay||t.name.indexOf("3DPlay")>-1)&&s.push({name:t.name,startTime:t.startTime,duration:t.duration}))}),e.cleanNames)for(i=0;i<s.length;i++){var l=s[i],c=l.name.split("3DPlay_");c.length>=2&&(c=c.slice(1),l.name=c.join("_"))}return{iframeTime:r,adjustTime:n,probes:s}},GetSubProbesFrom:function(e,t){t=void 0===t||t;var i=[];if(e){var n=window.performance.getEntriesByName(e.id).pop();if(n){var r=this.GetProcessedData({topWindow:!1,cleanNames:!0}),s=n.startTime,a=s+n.duration;r.probes.forEach(function(t){e.probeName!==t.name&&t.duration>2&&t.startTime>=s&&t.startTime+t.duration<=a&&(i[t.name]=Math.floor(t.duration+.5))})}}return i},dump:function(e,t){e=e?e+"_":"";var n=new Date,r=n.getFullYear()+"-"+(n.getMonth()+1)+"-"+n.getDate()+"-"+n.getHours()+":"+n.getMinutes(),s=[];if(t)s=this.GetProcessedData({topWindow:!1,cleanName:!0,only3DPlay:!0});else{try{s=(s=window.top.performance.getEntriesByType("measure")).concat(window.top.performance.getEntriesByType("mark"))}catch(e){}s=(s=s.concat(window.performance.getEntriesByType("mark"))).concat(window.performance.getEntriesByType("measure"))}i("3DPlay.PCS_"+e+r+".json",new Blob([JSON.stringify(s)],{type:"text/plain"}))},cleanProbes:function(){s=[],window.performance.clearMeasures()}}});var BrowserSupport={none:0,blacklist:1,partial:2,perfo:3,ok:4},LogLevel={none:0,error:1,warning:2,log:3,debug:4},eventType={loading:"loading",modelLoading:"modelLoading",notif:"notif"},notification={info:"info",fatal:"fatal",error:"error",warning:"warning",success:"success"},experience={create:0,ready:1},loading={loading:"loading",launch:"launch",initialized:"initialized"},modelLoading={reload:"reload",load:"load",started:"started",progress:"progress",finished:"finished",error:"error"},loadingMode={autoplay:"autoplay",preload:"preload",onclick:"onclick"},pathMigration=function(e,t,i){console.error(e,"has been moved to",t,"in framework",i)};define("DS/3DPlay/3DPlay",["UWA/Core","DS/CoreEvents/Events","DS/WebSystem/Environment","DS/WebUtils/StringUtils","DS/WebUtils/ContextedSingleton","css!DS/3DPlay/3DPlay"],function(e,t,i,n,r,s){"use strict";var a=new Promise(function(e){require(["DS/3DPlaySupport/Loader"],e)}),o="6.420.0.0";require(["text!DS/3DPlay/.3DPlay.mkversion.mk"],function(t){if(t){var i=e.is(t,"string")?JSON.parse(t):t;i.version&&(o=i.version),console.log("3DPlay Build "+o)}},function(e){});var l=e.Class.singleton({name:"3DPlay",getApplicationWorkBenchs:function(){return this.workbenchs},workbenchs:[],initWorkbenchs:function(e){this.wbcb=e},init:function(e){this.args=e,this.Experiences={},this.SplashScreens={},this._setLang()},_setLang:function(){void 0!==window.widget&&null!==window.widget&&void 0!==widget.lang&&null!==widget.lang?this.lang=widget.lang:e&&e.Utils&&e.Utils.Client&&e.Utils.Client.Locale&&e.Utils.Client.Locale.lang?this.lang=e.Utils.Client.Locale.lang:this.lang="",i.isSet("3DPlay.DisableNls")&&(this.lang=""),this.lang&&i.set("3DPlay.Nls.Lang",this.lang)},loadNls:function(e){pathMigration("3DPlay.LoadNLS","System/Nls","WebInfra");var t=this;require(["DS/WebSystem/Nls"],function(i){i.loadNls(e,t.lang),t=null})},nls:function(e,t,i){pathMigration("3DPlay.nls","System/Nls","WebInfra");var n=this;require(["DS/WebSystem/Nls"],function(r){r.nls(e,t,i,n.lang),n=null})},getExperience:function(e){return this.Experiences[e]},getSplashScreen:function(e){return r.get(e,"helper").playerSplashScreen},loadCssFile:function(e,t){console.error("Deprecated, please now use require with css!"),console.error("Deprecated, please now use require with css!"),cssLoader(e,t)},displayFatalError:function(e,t){var i=r.get(e.ctx,"helper"),n=!0;if(i&&i.playerSplashScreen){var s,a=i.playerSplashScreen;a.showView(a.views.logo),void 0!==e.msg?(s=e.msg,this.publish(e.ctx,"EXPERIENCE/ERROR",e),console.error("3DPlay: "+e.msg)):"notSupported"!=e.eventID?(s=document.createTextNode("An exception occured during loading, see console for more details"),n=!1):"ScripNotFoundError"!==e.error&&"LoadingError_LOAD"!==e.NLS_ID||(n=!1),a.showFatal(s,n,!1,t)}var o=this.getExperience(e.ctx);o&&o.progress&&o.progress.hide()},displayNotification:function(e){var t=r.get(e.ctx,"helper");if(t&&t.playerSplashScreen){var i=t.playerSplashScreen;this.publish(e.ctx,"EXPERIENCE/ERROR",e),i.showNotification(e.msg)}var n=this.getExperience(e.ctx);n&&n.progress&&n.progress.hide()},endAllCommands:function(e){void 0!==e&&void 0!==e.ctx&&null!==e.ctx&&(WUX&&WUX.AFR&&WUX.AFR.CommandsManager?WUX.AFR.CommandsManager.endAll(e.ctx,e.resetDefaultCmd):require("DS/ApplicationFrame/CommandsManager",function(t){t&&t.endAll(e.ctx,e.resetDefaultCmd)}))},load:function(e){if(void 0!==e&&void 0!==e.ctx&&null!==e.ctx){var t=this.getSplashScreen(e.ctx);null!=t&&(t.removeFatal(),t.hide(),this.SplashScreens[e.ctx]=t=null);var i=this.getExperience(e.ctx);null!=i&&(this.Experiences[e.ctx]=i=null,delete this.Experiences[e.ctx]),e.ctx=void 0}this.createExperience(e)},createExperience:function(e){var t=this;void 0!==e&&(this.lang=e.lang||this.lang,e.lang=this.lang);var i=e.ctx||t.createContext();a.then(function(n){n(e.input,i,t.SplashScreens[i],function(n,s){e.input=s;var a=new n(e);t.Experiences[i]=a;var o=r.get(i,"helper");o&&(a.playerSplashScreen=o.playerSplashScreen);var c=[],u={};void 0!==l.wbcb&&null!==l.wbcb&&l.wbcb(u),void 0!==u.commandApplication&&!0!==u.commandApplication||(c=e.workbenchs,e.workbenchs=void 0,delete e.workbenchs),null!=u.workbenchs&&(c=c.concat(u.workbenchs)),a.args.workbenchs=c,a.publish("EXPERIENCE/EXPERIENCECREATED",a),e.options.loading==loadingMode.preload?a.initExperience():setTimeout(function(){a.start()},1)},function(e){if("scripterror"==e.requireType){var n=e.requireModules.join(",");console.error("3DPlay ScripNotFoundError: ",n),t.publish(i,"EXPERIENCE/ERROR",{exp:void 0,ScripNotFoundError:n}),require(["i18n!DS/3DPlay/assets/nls/3DPlay"],function(e){t.displayFatalError({ctx:i,msg:e.ScripNotFoundError+n,error:"ScripNotFoundError"})})}else console.error(e)},e.options)})}});return l.publish=function(e,i,n){t.publish({event:"/"+e+"/"+i+"/",data:n})},l.subscribe=function(e,i,n){return t.subscribe({event:"/"+e+"/"+i+"/"},n)},l.unsubscribe=function(e){return t.unsubscribe(e)},l.sendEvent=function(t,n,r,s){var a={};if(1==arguments.length?a=t:(a.ctx=t,a.eventType=n,a.eventID=r,e.extend(a,s,!0)),i.isBoolActive("3DPlay.Debug")&&console.log("Event : "+a.toString()),a.ctx){var o=this.getExperience(a.ctx);if(o)return a.eventType==eventType.notif?o._handleNotification(a):void this.publish(a.ctx,"EXPERIENCE/ERROR",{msg:"Event Not supported : "+a.eventType});console.error("unknown context")}else console.error("Event's context undefined or null")},l.sprintf=function(){return console.warn("sprintf has been moved to WebInfraWebUtils.mwebsrcStringUtils"),n.sprintf.apply(null,arguments)},l.getVersion=function(){return o},l.inputCbs=[],l.addCallbacks=function(e,t,i){for(var n in i=i||"/",t)if(t.hasOwnProperty(n)){var r=t[n],s=i+n+"/",a=Array.isArray(r);if("object"!=typeof r||a)if(void 0===this.inputCbs[e]&&(this.inputCbs[e]=[]),a)for(var o=0;o<r.length;o++)this.inputCbs[e].push(this.subscribe(e,s.toUpperCase(),r[o]));else this.inputCbs[e].push(this.subscribe(e,s.toUpperCase(),r));else l.addCallbacks(e,r,s)}},l.removeCallbacks=function(e){if(this.inputCbs[e]){for(var t=this.inputCbs[e],i=0;i<t.length;i++)this.unsubscribe(t[i]);this.inputCbs[e]=void 0}},e.namespace("SHARE/Core",l)}),define("DS/WebSystem/Nls",["UWA/Class","DS/WebSystem/Environment"],function(e,t){"use strict";var i,n,r=function(e){i?e(i):require(["DS/RuntimeView/NLSManager"],function(t){e(i=t)})};return e.singleton({init:function(e){n=this,t.isSet("3DPlay.Nls.Lang")&&this._setLang(t.get("3DPlay.Nls.Lang"))},_setLang:function(e){e&&(this.lang=e)},loadNls:function(e,t){t!==this.lang&&void 0!==t&&(this.lang=t),r(function(t){t.loadResource({resourceFile:e,language:n.lang})})},nls:function(e,t,i,s){console.error("catnls is deprecated in 3DPlay, please consider moving to nls infrastructure !"),r(function(r){r.onResourceLoaded({resourceFile:e},function(){if(Array.isArray(t)){for(var e=[],n=0;n<t.length;n++)e[n]=this.getKey({key:t[n]});i(e)}else i(this.getKey({key:t}))}),r._listOfResources[e]||n.loadNls(e,s)})}})}),define("DS/3DPlay/3DPlayRegister",["UWA/Class","DS/WebSystem/Nls"],function(e,t){"use strict";return e.extend({init:function(e){var i=this;this._parent(e),void 0!==e&&(e.registerID||console.log("ERROR: RegisterID missing"),this.registerID=e.registerID,this.title="Register_"+this.registerID,e.scenarioManager&&(this.scenarioManager=e.scenarioManager)),require(["i18n!DS/"+e.registerModule+"/assets/nls/"+e.registerName],function(t){t&&(i.title=t[e.registerName+"_Title"])},function(){t.nls(e.registerModule+"/"+e.registerName,e.registerName+".Title",function(e){i.title=e})})},getTitle:function(){return this.title},dispose:function(){this.scenarioManager=void 0,this.title=void 0,this.registerID=void 0}})}),define("DS/WebUtils/Logger",["DS/WebSystem/Environment","DS/Logger/Logger"],function(e,t){"use strict";return function(i,n){var r=t.getLogger(i);return r.setLevel(n&&e.isSet(n)||e.isSet("3DPlay.Debug")?"log":"warn"),r}}),define("DS/WebUtils/Tracker",["UWA/Class","DS/WebUtils/Logger","DS/Usage/TrackerAPI","DS/WebUtils/Profiler","DS/WebSystem/Environment"],function(e,t,i,n,r){"use strict";var s,a,o="3DPlay",l=r.isSet("3DPlay.Tracker.ProbesChecker")?"-probesChecker":"",c="X3DPLAW_AP",u=t("3DPlay.Tracker","3DPlay.Log.Tracker"),d=Date.now(),p=0;return{scenario:function(e){this.trackPageEvent("commands","scenario",e,void 0,{count:this.incCommandCounter()})},command:function(e,t){this.trackPageEvent("commands","command",e,t||void 0,{count:this.incCommandCounter()})},startCommand:function(e){n.start(e)},endCommand:function(e){this.command(e,Math.floor(n.stop(e)/1e3))},resetCommandCounter:function(){p=0},incCommandCounter:function(){return s||a||p++,p},trackPageEvent:function(e,t,n,r,p,h,D){var f,g={pd1:"undefined"!=typeof widget?widget.id:"default-widget-id"},m={pv1:Math.floor((Date.now()-d)/1e3)},y=1;if(p)for(var v in p)p.hasOwnProperty(v)&&void 0!==p[v]&&(D?y=D[v]:y++,y&&(g["pd"+y]=v,m["pv"+y]=p[v]));"undefined"!=typeof widget&&(f=widget.getValue("x3dPlatformId")),!f&&h&&(f=h);var P={};P.eventCategory=o+"-"+e+l,P.eventAction=t,P.eventLabel=n,P.eventValue=r,P.persDim=g,P.appID=c,P.tenant=f,P.persVal=m,s||a?s&&(s=!1):(i.trackPageEvent(P),u.log(P))},disableNext:function(){s=!0},pause:function(e){a=e},setAppInfos:function(e){o=e.Prefix,c=e.appId}}}),define("DS/3DPlayConnectors/3DDriveConnector",["DS/3DPlayConnectors/CAT3DPlayConnector","DS/WAFData/WAFData","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/CoreEvents/Events","DS/WebUtils/Tracker"],function(e,t,i,n,r){"use strict";return e.extend({init:function(e){this.name="3DDriveConnector",this._parent(e),this.x3DDriveId=null,this.currentDataTitle=null,this.x3DDriveParentUri1="/resources/3ddrive/v1/bos/",this.x3DDriveParentUri2="/fileurl?tenant=",this.monoFileUri=null,this.assemblyUri=null,this.onFailCB=null,this.connectorsOnSuccessCB=null},open:function(e,t,i){var n=this;this.rawAsset=e,this.x3DDriveId=e.physicalid,this.x3DriveTenantId=e.tenant,this.onFailCB=i,this.connectorsOnSuccessCB=t,e.fileFormat?this._returnNew3DDriveAsset({filename:e.filename,extension:e.fileFormat,url:e.url},null,null):this._start3DDriveBusinessExpand(e,e.serverurl||!1,function(e){n._returnNew3DDriveAsset(e,t)})},_set3DDriveWSUri:function(e,t){var i=t,n=e.physicalid,r=e.tenant;this.metaDataWsUri=i+this.x3DDriveParentUri1+n+"?tenant="+r,this.monoFileUri=i+this.x3DDriveParentUri1+n+this.x3DDriveParentUri2+r,this.assemblyUri=this.monoFileUri+"&expand=true",this.serviceUri=i},_get3DDriveServiceURL:function(e,t){var n=this;i.getServiceUrl({serviceName:"3DDrive",platformId:e,onComplete:t,onFailure:function(){n.onFailCB("Error in  3DDriveConnector._get3DDriveServiceURL")}})},_start3DDriveBusinessExpand:function(e,t,i){var n=this;t&&UWA.is(t,"string")?(this._set3DDriveWSUri(e,t),this._getPartMetaData(i)):this._get3DDriveServiceURL(e.tenant,function(t){UWA.is(t),n._start3DDriveBusinessExpand(e,t,i)})},_getRealAssetUri:function(e){var i=this,n=this.monoFileUri,s=null,a=e.extension.toLowerCase();"catproduct"!==a&&"gml"!==a&&"stpx"!==a&&"stpxz"!==a||(n+="&expand=true",s="catproduct"===a?"CATProduct":e.extension),t.authenticatedRequest(n,{method:"GET",type:"json",onComplete:function(t){i._returnNew3DDriveAsset(t,s,e)},onFailure:function(e,t,n){var s={NLS_ID:"LoadingError_LOAD"};if(t&&t.error&&t.error.errorCode){var o={};o[t.error.errorCode]=1,r.trackPageEvent("errors","3DDrive",a,0,o),["mainNotIndexed","linkInfoMissing"].indexOf(t.error.errorCode)>-1&&(console.error("3DDrive error",t.error.errorCode,":",t.error.message,":",(t.error.failingFiles||[]).join(",")),s={NLS_ID:"assembly_Not8indexed_FAIL"})}i.onFailCB(s)}})},_getPartMetaData:function(){var e=this,i=this.metaDataWsUri;t.authenticatedRequest(i,{method:"GET",type:"json",onComplete:function(t){e.currentDataTitle=t.title,e._getRealAssetUri(t),n.publish({event:"Model.changeTitle",data:t.title})},onFailure:function(t){var i="LoadingError_LOAD";-1!==t.message.indexOf("404")&&(i="LoadingDocument404"),e.onFailCB({NLS_ID:i});var n={};n[i]=1,r.trackPageEvent("errors","3DDrive","connector",0,n)}})},_returnNew3DDriveAsset:function(e,t,i){var n=e.url,r=e.extension,s={provider:"FILE",filename:e.filename||"",format:r,type:r,serverurl:n,url:n,mimetype:r,requestsOptions:{proxy:"none",method:"GET"},serviceURL:this.serviceUri,driveAttr:i};null!==t&&(s.format=s.type=t,s.filename=this.currentDataTitle+".zip",s.mimetype=t),this.connectorsOnSuccessCB(s)}})}),define("DS/WebUtils/Network",["DS/WAFData/WAFData","DS/WebUtils/ProbesManager","DS/WebUtils/Logger","DS/WebSystem/Environment"],function(e,t,i,n){"use strict";var r=i("DS/WebUtis/Network","3DPlay.Log.Network"),s={_updateOptions:function(e){e.timeout||(e.timeout=6e5)},_createContext:function(e,t,i){this._updateOptions(i);var s,a,o,l,c=n.isSet("3DPlay.Log.Network");i.onComplete=(s=i.onComplete,a=i.onStatistics,function(n){var o=this.getTime();c&&r.log(i.method,":",t," duration:",this.getTime()," data:",i.data," header:",i.headers," Response:",n),e.stats&&a&&(e.stats.time=o,a(e.stats),a=null),s(n),t=null,i=null,s=null,e=null}),i.onFailure=(o=i.onFailure,function(n){r.error(i.method,":",t," duration:",this.getTime()," data:",i.data," header:",i.headers," Response:",n),o&&o(n),t=null,i=null,o=null,e=null}),i.onCancel=function(){i.onCancel;return function(n){r.error(i.method,":",t," duration:",this.getTime()," data:",i.data," header:",i.headers," Response:",n),onCancel&&onCancel(n),t=null,i=null,onCancel=null,e=null}}(),i.onTimeout=function(t,n){var s=i.onTimeout;return function(n){r.error(i.method,":",t," duration:",this.getTime()," data:",i.data," header:",i.headers," Response:",n),s&&s(n),t=null,i=null,s=null,e=null}}(),i.onProgress=(l=i.onProgress,function(t){l&&l(t),e.stats=e.stats||{},e.stats.DownloadSize=t.total,0===e.stats.DownloadSize&&(e.stats.DownloadSize=t.loaded)})},authenticatedRequest:function(i,n,r){this._createContext({},i,n,r),t.createNetWorkProbe(r||"authenticatedRequest",n).begin(),e.authenticatedRequest(i,n)},handleRequest:function(i,n,r,s){this._createContext({},i,n),t.createNetWorkProbe(r||"handleRequest",n).begin(),s?e.handleRequest_HOOKED(i,n):e.handleRequest(i,n)},hookNetwork:function(e){this.functionHandler=e,this.hookhandleRequest()},hookhandleRequest:function(){e.handleRequest_HOOKED||(e.handleRequest_HOOKED=e.handleRequest,e.handleRequest=function(t,i){var n,r,a=s.functionHandler&&s.functionHandler(t);a?(s.functionHandler=null,a.onStatistics&&(i.onStatistics=a.onStatistics),a.onProgress&&(i.onProgress=(r=i.onProgress,function(e){r&&r(e),a.onProgress(e)})),i.onComplete=(n=i.onComplete,function(){a.onComplete(),n.apply(null,Array.prototype.slice.call(arguments)),n=null,a=null}),s.handleRequest(t,i,a.id,!0)):e.handleRequest_HOOKED(t,i)})},disableHook:function(){e.handleRequest_HOOKED&&(e.handleRequest=e.handleRequest_HOOKED,delete e.handleRequest_HOOKED)}};return s.hookhandleRequest(),s}),define("DS/3DPlayConnectors/SVGConnector",["DS/3DPlayConnectors/CAT3DPlayConnector","DS/WebSystem/Settings","DS/WebUtils/Network"],function(e,t,i){"use strict";var n,r;return e.extend({init:function(e){this._parent(e)},open:function(e,t,s){n=t,r=function(e){s(e)},function(e){var t=e.filename||e.url,s={method:"GET",authentication:"passport",proxy:"none",timeout:72e5,requestsOptions:{proxy:"none"},onComplete:function(e){n({data:e,dataFormat:"svg",provider:"BUFFER"})},onCancel:function(e){console.log("Error: "+e),r({NLS_ID:"LoadingDocumentError"})},onFailure:function(e){console.log("Error: "+e),r({NLS_ID:"LoadingDocumentError"})}};i.handleRequest(t,s)}(e)}})}),define("DS/WebUtils/WebServices",["DS/WebUtils/Network","DS/WebUtils/ProbesManager","DS/WebUtils/Logger","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/WebSystem/Environment"],function(e,t,i,n,r){"use strict";var s,a=i("DS/WebUtis/WebServices","3DPlay.Log.WebServices"),o={url:"/cvservlet/fetch/v2",method:"POST"},l={url:"/resources/modeler/pno/person?current=true&select=preferredcredentials&select=collabspaces",method:"GET"},c={getSecurityContext:function(t){return s||(s=new Promise(function(e){require([].concat("DS/PADUtils/PADSecurityCtxConverter"),e)})),new Promise(function(i,n){function a(){console.error(arguments)}if(!t)return a("Tenant is missing"),void n();c.getServiceUrl({serviceName:"3DSpace",platformId:t,onError:a,onSuccess:function(n){e.authenticatedRequest(n.url+l.url+"&tenant="+t,{timeout:6e6,onComplete:function(e){s.then(function(t){var n=t.prepareForStorage(JSON.parse(e));r.set("PreferredCredentials",n.securityContext),r.set("securityContext",n.cspaces),i(n.securityContext)})},onCancel:a,onFailure:a,onTimeout:a,method:l.method,headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":"en"}},"Person")}})})},getTenant:function(e){var t="OnPremise";if(e=e||widget&&widget.uwaUrl){var i=e.indexOf("-");i>-1&&(t=e.substring(e.indexOf("://")+3,i).toUpperCase())}return t},getPlatformServices:function(e){t.createNetWorkProbe("i3DXCompassPlatformServices.getPlatformServices",e).begin(),n.getPlatformServices(e)},getServiceUrl:function(e){var i=e.logger?e.logger:a;if(e.onError){if(!e.onSuccess)return i.error("onSuccess required"),void e.onError();if(!e.serviceName)return i.error("serviceName required"),void e.onError();e.onSuccess=t.createFunctionProbe("getServiceURL",e.onSuccess),n.getPlatformServices({platformId:e.platformId,onComplete:function(t){var i;if(t)if(Array.isArray(t)){for(var n={url:void 0},r=0;r<t.length;r++){var s=t[r];if(i=s[e.serviceName]){n.url=i,n.platformId=s.platformId;break}}n.url?e.onSuccess(n):e.onError({serviceName:e.serviceName})}else if(i=t[e.serviceName])e.onSuccess({url:i,platformId:e.platformId});else{if(e.platformId){var a=UWA.extend({},e);delete a.platformId,e=a}c.getServiceUrl(e)}else e.onError({serviceName:e.serviceName,error:"Compass Error"})},onFailure:function(t){i.error(t),e.onError({serviceName:e.serviceName,error:"Compass Error"})}})}else i.error("onError required")},isKindOf:function(e,t,i){this.getParentsType({physicalid:t.physicalid,tenant:t.tenant,onFailure:function(){i(!1)},onComplete:function(t){i(t&&Array.isArray(t)&&t.indexOf(e)>-1)}})},getParentsType:function(e){this.fetch({contextid:e.contextid,serverUrl:e.serverUrl,tenant:e.tenant,physicalid:[e.physicalid],select_predicate:["taxonomies"],responseType:"json",dtype:e.dtype,onFailure:e.onFailure||function(e){console.error(e)},onComplete:function(t){if(t.infos&&1===t.infos.nresults&&t.results)for(var i=t.results.length;i--;){var n=t.results[i];if(n.attributes)for(var r=n.attributes,s=r.length;s--;)if("taxonomies"===r[s].name.toLowerCase()){var a=r[s].value.split("/");a.length&&"types"===a[0]&&e.onComplete(a.slice(1))}}else"Document"===e.dtype?e.onComplete(["DOCUMENTS","Document"]):e.onFailure&&e.onFailure()}})},fetch:function(t){if(t.tenant)if(t.physicalid){var i=function(n,s){var a=n.url+o.url+"?xrequestedwith=xmlhttprequest&SecurityContext="+(s||(t.contextid?t.contextid:"preferred"));t.tenant&&(a+="&tenant="+t.tenant);var l={physicalid:t.physicalid,label:t.label||"X3DPLAW_AP-"+(new Date).getTime(),locale:"en"};t.tenant&&(l.tenant=t.tenant),t.select_predicate&&(l.select_predicate=t.select_predicate),t.select_file&&(l.select_file=t.select_file);var u={timeout:6e6,data:JSON.stringify(l),onComplete:function(e){"json"===t.responseType&&"string"==typeof e&&""!==e&&(e=JSON.parse(e)),e&&e.results?t.onComplete(e):c.getSecurityContext(t.tenant).then(function(e){r.set("PreferredCredentials",e),i(n,e)})},onCancel:t.onCancel||t.onFailure,onFailure:t.onFailure,onTimeout:t.onTimeout||t.onFailure,method:o.method,headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":"en"}};t.type&&(u.type=t.type),t.requiredAuth&&(u.authentication=t.requiredAuth),e.authenticatedRequest(a,u,"Fetch")};t.serverUrl?i({url:t.serverUrl}):this.getServiceUrl({serviceName:"3DSpace",platformId:t.tenant,onError:t.onFailure,onSuccess:i})}else t.onFailure&&t.onFailure("physicalid required");else t.onFailure&&t.onFailure("tenant required")}};return c}),define("DS/3DPlayConnectors/DrawingConnector",["DS/3DPlayConnectors/CAT3DPlayConnector","DS/WAFData/WAFData","DS/WebUtils/3DPlayState","DS/WebSystem/Environment","DS/WebUtils/WebServices"],function(e,t,i,n,r){"use strict";var s,a,o=function(e){if(e){var i={type:"text",timeout:72e5,cache:3600,onComplete:function(e){s({asset:{data:e,dataFormat:"xcaddrawing",provider:"BUFFER"}})},onCancel:function(e){console.log("ERROR: WAFData request cancelled while loading SVG file."),a({NLS_ID:"LoadingError_LOAD_ENTRY"})},onFailure:function(e){console.log("ERROR: WAFData request failed while loading SVG file."),a({NLS_ID:"LoadingError_LOAD_ENTRY"})}};UWA.merge(i,{method:"POST",authentication:"passport",proxy:"none"});t.handleRequest(e,i)}else console.log("Invalid URL."),a({NLS_ID:"BadUrl"})},l=function(e,i){n.isSet("3DPlay.downloadDrawingStream")&&t.authenticatedRequest(e,{method:"GET",headers:{"Content-Type":"application/json"},onComplete:function(e){var t=new Blob([e]),n=URL.createObjectURL(t),r=document.createElement("a");r.download="DrawingStream."+i,r.innerHTML="Download File",r.href=n,r.onclick=function(e){document.body.removeChild(e.target)},r.style.display="none",document.body.appendChild(r),r.click()}})},c=function(e){var r={label:"3DPlay_"+Date.now(),physicalid:[e.physicalid],select_file:["svg","udl"],select_predicate:["ds6w:cadMaster","ds6w:type"]},c=e.contextid?e.contextid:e.contextId?e.contextId:"preferred";n.get("PreferredCredentials")&&(c=n.get("PreferredCredentials"));var u=e.serverurl+"/cvservlet/fetch/v2?SecurityContext="+c,d={headers:{"Content-Type":"application/json"},method:"POST",type:"json",onComplete:function(t){var i=function(e){var t,i=UWA.is(e,"string")?JSON.parse(e):e;if(1==i.results.length&&i.results[0]){var n=i.results[0].attributes;if(n)for(var r=0;r<n.length;++r)if("udl"==n[r].name){t=n[r].value;break}}return t}(t),r=function(e){var t=!1,i=UWA.is(e,"string")?JSON.parse(e):e;if(1==i.results.length&&i.results[0]){var n=i.results[0].attributes;if(n)for(var r=0;r<n.length;++r)if("ds6w:cadMaster"==n[r].name){if(console.log("ds6w:cadMaster - "+n[r].value),"3DEXPERIENCE"!=n[r].value&&null!=n[r].value){t=!0;break}break}}return t}(t);if(i&&r||!r&&i&&!n.isSet("CAT_DFT_GENERATE_SVG_AND_UDL"))s({asset:{data:i,dataFormat:"udl",provider:"BUFFER"}}),l(i,"udl");else if(r)!function(e){var t=null,i=UWA.is(e,"string")?JSON.parse(e):e;if(1!==i.results.length)return console.log("ERROR: Incorrect data received for service."),void a({NLS_ID:"LoadingError_LOAD_ENTRY"});if(i.results[0]){for(var n=!1,r=i.results[0].attributes,c=0;c<r.length;c++)if("svg"===r[c].name){n=!0,void 0!==r[c].value&&null!==r[c].value&&""!==r[c].value?(t=r[c].value,o(t),l(t,"svg")):s({asset:{data:null,dataFormat:"svg",provider:"BUFFER"}});break}!1===n&&(console.log("ERROR: SVG attribute not available."),s({asset:{data:null,dataFormat:"svg",provider:"BUFFER"}}))}}(t);else{var c=JSON.parse(JSON.stringify(e));c.backup_type=e.type,c.backup_dtype=e.dtype,c.type="V6Drawing",c.dtype="V6Drawing",s({asset:c})}},onCancel:function(e){console.log("ERROR: WAFData request failed while opening Drawing."),a({NLS_ID:"LoadingError_LOAD_ENTRY"})},onFailure:function(e){console.log("ERROR: WAFData request failed while opening Drawing."),a({NLS_ID:"LoadingError_LOAD_ENTRY"})}};i.isWebinWin()&&(d.authentication=e.requiredAuth),d.data=JSON.stringify(r),t.authenticatedRequest(u,d)};return e.extend({init:function(e){this._parent(e)},open:function(e,t,i){var o=this;this.preventDoubleCallBack=!1,s=t,a=function(e){o.preventDoubleCallBack||(o.preventDoubleCallBack=!0,i(e))},n.get("PreferredCredentials")||window.__karma__?c(e):r.getSecurityContext(e.tenant).then(function(t){n.set("PreferredCredentials",t),c(e)})}})}),define("DS/3DPlaySupport/AssetSupport",["UWA/Class","DS/WebSystem/Environment","DS/3DPlaySupport/SupportList"],function(e,t,i){"use strict";var n={getDefaultExperienceID:function(e){return i.getDefaultExperienceID(e)},getDefaultExperiencesIDList:function(e){return i.getDefaultExperiencesIDList(e)},officeTypes:["DOC","DOCX","DOCM","DOT","DOTM","DOTX","RTF","PPT","PPTX","POT","POTM","POTX","PPS","PPSM","PPSX","PPTM","XLS","XLSX","XLSM","XLSB","XLT","XLTM","XLTX","CSV","MSG"],checkSupport:function(e,t,i){if("3DDRIVE"===e.provider.toUpperCase()&&null!=e.fileFormat&&(e.tempAsset={type:e.fileFormat,provider:"FILE",physicalid:e.physicalid}),e.requestsOptions&&e.requestsOptions.authentication&&"passport"==e.requestsOptions.authentication&&e.type&&this.officeTypes.indexOf(e.type.toUpperCase())>0)i(!1);else{t=t||{};var n=window.localStorage["3DPlay.OverrideSettings"];if(void 0!==n){console.warn("!! 3DPlay OverrideSetting variable environment Active");try{(n=JSON.parse(n))&&n.input&&n.input.experience&&i(!0)}catch(e){console.error("Override failed : JSON.parse error"+e)}}t.isCheckSupport=!0,"3DDRIVE"==e.provider.toUpperCase()&&"DRIVEFILE"==e.type.toUpperCase()&&(t.doOpen=!0),this.getExperienceID(e.tempAsset?e.tempAsset:e,t,function(e){i(null!==e)})}},getExperienceID:function(e,t,n){t=t||{};var r=i.computeUsage(t.usage);this.getExperiencesIDList(e,t,function(e){var t=e[r];null!=t&&"string"==typeof t&&""!==t||(t=null),n(t)})},getExperiencesIDList:function(e,t,r){var s=[];if(t=t||{},(e=e||{}).provider&&"string"==typeof e.provider&&e.type&&"string"==typeof e.type)if(e.provider=e.provider.toUpperCase(),null===i[e.provider]||void 0===i[e.provider])r(s);else{var a=i[e.provider];a.reformatTypeID&&(e.type=a.reformatTypeID(e.type));var o=function(a){var o=i[e.provider][a];null==o?r(s):!0===Array.isArray(o)?r(o):o.connector?t.doOpen&&!0!==e.isOpenned&&t.lastUsedConnector!==e.provider+"-"+a?i.openAsset({provider:e.provider,type:a},e,function(i){t.lastUsedConnector=e.provider+"-"+a,n.getExperiencesIDList(i,t,r)},function(){r(s)}):o.DefaultExperiencesList?r(o.DefaultExperiencesList):t.isCheckSupport?r(["Connector","Connector","Connector","Connector"]):r(s):r(s)};void 0===a.resolveParenting||null===a.resolveParenting?o(e.type):a.resolveParenting(e,function(e){o(e)})}else r(s)}};return n}),define("DS/3DPlayConnectors/ErrorManagement",["DS/3DPlay/3DPlay","i18n!DS/3DPlay/assets/nls/3DPlay"],function(e,t){"use strict";var i={"Cannot display document as multiple files are attached.":"Document_Multiple","Cannot display document as no files are attached.":"Document_No_File","An error occurred while downloading the file.":"Error_Downloading"},n=function(r,s){if(!s)return!1;if(r&&r.NLS_ID)return r.NLS_File_JS?require([r.NLS_File_JS],function(t){e.displayFatalError({ctx:s,msg:t[r.NLS_ID],error:r.NLS_ID})}):e.displayFatalError({ctx:s,msg:t[r.NLS_ID],error:r.NLS_ID}),!0;if("string"==typeof r){var a=i[r];if(a)return n({NLS_ID:a},s)}return console.error("Unknown error format or error"),!1};return n}),define("DS/3DPlayWidgetViews/W3DPlayMainView",["DS/CoreEvents/Events","DS/WebSystem/Environment","UWA/Class","css!DS/3DPlayWidget/assets/3DPlayWidget","DS/WebUtils/StringUtils","DS/WebSystem/Nls","i18n!DS/3DPlay/assets/nls/3DPlay"],function(e,t,i,n,r,s,a){"use strict";var o,l,c,u,d,p=[],h=!1;return i.extend({init:function(e,t){o=e,l=t,c=this,this.buildView(),this.createBlueBackground(),this.declareAllSubscribers()},buildView:function(){o.body.setStyle("height","100%"),this.buildCanvas()},buildCanvas:function(){if(l.applicationFrameOptions&&l.applicationFrameOptions.options&&(h=void 0!==l.applicationFrameOptions.options.pad3DViewer),this.canvasDiv=h&&l.applicationFrameOptions.options.appMainDiv?l.applicationFrameOptions.options.appMainDiv:document.getElementById("canvas-div"),!this.canvasDiv)if(this.canvasDiv=UWA.createElement("div",{class:"appMain",id:"canvas-div",html:"",styles:{overflow:"hidden"}}),h){var t=l.applicationFrameOptions.options.pad3DViewer.elements.container;this.canvasDiv.inject(t.parentNode),t.inject(this.canvasDiv)}else this.canvasDiv.inject(o.body);this.canvasDiv.id="canvas-div",this.canvasDiv.setAttribute("data-rec-id","canvasDivID"),this.canvasDiv.style.overflow="hidden",l.setCanvasDiv(this.canvasDiv),e.subscribeOnce({event:"Model.PreferencesReady"},function(e){if(!l.isPreferencesEmpty()){var t=l.getCurrentData();t.displayName&&c.updateWidgetTitle(t.displayName)}}),this.createDragAndDropZone(this.canvasDiv)},createBlueBackground:function(){if(this.backgroundContainer=document.getElementById("background_container"),!this.backgroundContainer){this.backgroundContainer=UWA.createElement("div",{id:"background_container",class:"blue_background_container",styles:{display:"none"}}),this.backgroundContainer.inject(this.canvasDiv),this.backgroundContainer.setContent({tag:"div",class:"background_container_display drop"});var e=l.getBoxMessageText("DROPIT");this.backgroundContainer.addContent({tag:"div",class:"drop_container_display"}),this.backgroundContainer.addContent({tag:"div",class:"drop_container_txt",html:[{tag:"h3",id:"drop_msg",class:"drop_invite_txt font-3dsregular drop",html:e}]})}this.drop_msgDom=this.backgroundContainer.getElement("h3.drop_invite_txt")},hideBlueBackground:function(e){this.backgroundContainer.setStyle("display",e)},displayBlueBackground:function(){this.hideBlueBackground("block")},updateBlueBackgroundMessage:function(e){var t=l.getBoxMessageText(e);this.drop_msgDom.setHTML(t)},create3DPlayInviteContainer:function(){if(this.inviteContainer=document.getElementById("pad_invite"),!this.inviteContainer){this.inviteContainer=UWA.createElement("div",{id:"pad_invite",class:"pad_invite_container",html:"Invite Container",styles:{display:"none"}}),this.inviteContainer.inject(this.canvasDiv,"before");var e=l.getBoxMessageText("DROPIT");this.inviteContainer.setContent([{tag:"div",class:"pad_invite_display drop",html:[{tag:"span",id:"invite_img",class:"pad_invite_img fonticon fonticon-3x fonticon-down-circled"},{tag:"h5",id:"invite_msg",class:"pad_invite_txt font-3dsregular drop",html:e}]}])}this.invite_imgDom=this.inviteContainer.getElement("span.pad_invite_img"),this.invite_msgDom=this.inviteContainer.getElement("h5.pad_invite_txt")},addWidgetNotification:function(e){u?d.addNotif({level:e.level,message:e.message,title:e.title,sticky:e.sticky}):require(["DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],function(t,i){d=t,(u=i).setNotificationManager(t),c.addWidgetNotification(e)})},hideLastWidgetNotification:function(){u&&u.removeLastNotificationDisplayed()},refresh:function(){var e=l.getCurrentData();e.displayName&&this.updateWidgetTitle(e.displayName)},updateWidgetHeight:function(){o.body.setStyle("height","100%")},declareAllSubscribers:function(){p.push(e.subscribe({event:"Model.changeTitle"},function(e){null!=e&&l.setCurrentTitle(e),c.refresh()}))},dispose:function(){c=null,this.removeDragAndDropZone&&this.removeDragAndDropZone(this.canvasDiv);for(var t=0;t<p.length;t++)e.unsubscribe(p[t]);p=[]},createDragAndDropZone:function(i){var n=function(e){this.removeClassName("drag_over_class"),c.hideBlueBackground("none")},s=function(i){i.preventDefault(),this.removeClassName("drag_over_class"),c.hideBlueBackground("none");var n,s=!1;l.drag=!0;try{n=JSON.parse(i.dataTransfer.getData("text"))}catch(e){}if(n)t.isSet("3DPlay.Debug")&&console.log("3DPlay.Debug:W3DPlayMainView.dropFunction",n),n&&n.data&&n.data.items&&n.data.items.length>1&&(s=!0),l.setCurrentContent(n);else if(i.dataTransfer.files&&i.dataTransfer.files.length>0&&void 0!==i.dataTransfer.files[0]){t.isSet("3DPlay.Debug")&&console.log("3DPlay.Debug:W3DPlayMainView.dropFunction",i.dataTransfer.files),s=i.dataTransfer.files.length>1;var o=i.dataTransfer.files[0],u=r.getExtension(o.name),d=["3DXML","PDF","STP","STEP"];t.isSet("3DPlay.STPA")&&d.push("STPA"),t.isSet("3DPlay.AllowDND")||d.indexOf(u.toUpperCase())>-1?e.publish({event:"Player.load",data:{input:{asset:{useConvertors:!1,localFile:o,format:u,filename:window.URL.createObjectURL(o),provider:"FILE",proxyurl:"none",requiredAuth:null,serverurl:""}}}}):(c.hideLastWidgetNotification(),c.addWidgetNotification({level:"error",title:"",message:a.DNDUnSupportedFileType+u,sticky:!1}))}if(s){c.hideLastWidgetNotification();var p={level:"info",title:a.FirstSelectedObjectLoaded_Title,message:a.FirstSelectedObjectLoaded,sticky:!1};if(l&&l.getPlayerRef()&&l.getPlayerRef().getExperience()&&c)l.getPlayerRef().getExperience().subscribeOnce("ASSET/LOADINGSTARTED",function(){c.addWidgetNotification(p)})}},o=function(e){e.preventDefault(),this.addClassName("drag_over_class"),c.displayBlueBackground(),c.updateBlueBackgroundMessage("DROPIT"),e.dataTransfer&&(e.dataTransfer.dropEffect="copy")};i.addEventListener("dragenter",o),i.addEventListener("dragover",o),i.addEventListener("dragleave",n),i.addEventListener("dragend",n),i.addEventListener("drop",s),this.removeDragAndDropZone=function(e){e.removeEventListener("dragenter",o),e.removeEventListener("dragover",o),e.removeEventListener("dragleave",n),e.removeEventListener("dragend",n),e.removeEventListener("drop",s)}},hideShowBoxMessage:function(e){this.inviteContainer.setStyle("display",e)},updateBoxMessage:function(e){var t=l.getBoxClassIcon(e),i=l.getBoxMessageText(e);"DEFAULT"==e?(this.invite_imgDom.removeClassName(t),this.invite_imgDom.addClassName("fonticon-down-circled")):(this.hideShowBoxMessage("block"),this.invite_msgDom.setHTML(i),this.invite_imgDom.removeClassName("fonticon-down-circled"),this.invite_imgDom.addClassName(t))},updateWidgetTitle:function(e){var t="3DPlay";o.setTitle(""),""!=e&&null!=e&&(t=e),o.setTitle(t)}})}),define("DS/WebSystem/SessionManager",["DS/WebUtils/WebServices","DS/WebUtils/Logger","DS/WebSystem/App","DS/WebSystem/Environment","DS/WebSystem/Preference","UWA/Utils"],function(e,t,i,n,r,s){"use strict";let a=t("WebSystem.SessionManager"),o="WebSystem.Session",l="data",c=[],u=[],d=("undefined"!=typeof widget&&widget.id,function(){(i.is3DPlay()||n.isSet("ODT_SessionManager_"))&&function(){}.apply(this)}),p={isReading:!1,version:1,hasLoaded:!1,session:{},listeners:{},loadingPromises:[],getSession:()=>{let e={version:1};return e[l]=p.session,function(e){let t=function(e,t,i){let n=r.get(t);if(n){try{n=JSON.parse(n)}catch(e){}a.log("Copy",t,i),e[i||t]=n}};c.forEach((i,n)=>{t(e,i.src,i.dst),r.delete(i)}),u.forEach(i=>{t(e,i)})}(e[l]),e},init:function(e){e&&(e.sessionKey&&(o=e.sessionKey),e.dataKey&&(l=e.dataKey),e.ToCopy&&(u=u.concat(e.ToCopy)),e.toMigrate&&(c=c.concat(e.toMigrate)))},isReady:function(){return!this.isReading},dispose:function(){this.listeners={},this.pendingSaveTimeout&&(clearTimeout(this.pendingSaveTimeout),this.pendingSaveTimeout=null),d.apply(this),this.session={}},getSessionEntry:function(e){return this.session[e]},setSessionEntry:function(e,t){this.isReady()&&(t?this.session[e]=t:delete this.session[e],function(){if(!this.pendingSaveTimeout){var e=this;this.pendingSaveTimeout=setTimeout(function(){d.apply(e),e.pendingSaveTimeout=null,e=null},2e3)}}.apply(this))},register:function(e){e&&e.key&&e.readCB?(this.listeners[e.key]={readCB:e.readCB},this.hasLoaded&&this.getSessionEntry(e.key)&&e.readCB(this.getSessionEntry(e.key),this.version,function(){})):a.error("Args error : ",e)},restoreSession:function(e){if(this.isReady()){this.hasLoaded=!1,this.isReading=!0,e?function(e){if(a.log("restoreSession",e),e){this.version=e.version||1,this.session=e[l]||{};var t=this;Object.keys(this.session).forEach(e=>{let i=this.listeners[e];i&&t.loadingPromises.push(new Promise(function(n,r){a.log(e,t.getSessionEntry(e)),i.readCB(t.getSessionEntry(e),t.version,n)}))}),this.loadingPromises.length>0?Promise.all(t.loadingPromises).then(function(){t.isReading=!1,t.loadingPromises=[],t=null}):(this.isReading=!1,t=null)}this.hasLoaded=!0}.apply(this,[e]):this.isReading=!1}},clearSession:function(){this.session={},this.hasLoaded=!1,c=[],u=[],d.apply(this)}};return p}),define("DS/3DPlay/3DPlayScenarioManager",["UWA/Core","UWA/Class","DS/ApplicationFrame/CommandsManager","DS/3DPlay/3DPlay","DS/WebSystem/Nls","DS/WebSystem/Environment","DS/WebappsUtils/WebappsUtils","DS/WebUtils/Network","DS/WebUtils/Tracker","DS/WebUtils/ContextedSingleton","DS/WebSystem/SessionManager"],function(e,t,i,n,r,s,a,o,l,c,u){"use strict";var d=1e3,p={};return t.singleton({init:function(e){this._currentID=void 0,this._registerLoaded=!1,this.annotJSON=void 0},getExperience:function(){if(void 0!==this._3DPlayExp)return this._3DPlayExp},loadManager:function(e){if(e){var t=this;u.register({key:"Scenario",readCB:function(e,i,n){let r=window.widget;void 0!==r&&r.setValue("3DPlay.scenarioActivated",e),t._scenarioPersistency(),n()}}),this._3DPlayExp=e,this._updateScenarioChooser();var i=this._3DPlayExp._name.split("/"),n=i[i.length-2];return this._loadRegisters(a.getWebappsBaseUrl()+n+"/assets/RegisterList.json"),this._3DPlayExp.EventDisposer.add(this._3DPlayExp.subscribe("/ASSET/LOADINGFINISHED",function(e){if(t._registerLoaded)t._scenarioPersistency();else var i=0,n=setInterval(function(){i++,t._registerLoaded?(clearInterval(n),t._scenarioPersistency()):5===i&&clearInterval(n)},1);var r=c.get(t._3DPlayExp.args.ctx,"ANNOTATION_MANAGER");r&&t.annotJSON&&r.drawAnnotationsFromJSON(t.annotJSON)})),this._3DPlayExp.EventDisposer.add(this._3DPlayExp.subscribe("ASSET/CHANGE",function(){t._3DPlayExp.stop(),t._3DPlayExp.workbenchIndex=0,t.changeFlag=!0,t.prevScenario=t._currentID,t._currentID=void 0,t.annotJSON=void 0,s.get("3DPlay.scenarioActivated")&&"undefined"!=typeof widget&&widget.setValue("3DPlay.scenarioActivated",void 0)})),null}},_scenarioPersistency:function(){var e=s.get("3DPlay.scenarioActivated");if(this.changeFlag&&this.prevScenario){var t=this._getScenario(this.prevScenario.registerID,this.prevScenario.scenarioID,this.prevScenario.subScenarioID);if(t)if(t.available){var i=t.scenario.getScenarioResetActionBarPolicy();this.changeScenario(this.prevScenario.registerID,this.prevScenario.scenarioID,this.prevScenario.subScenarioID,i,void 0,!1),this.changeFlag=!1}else this._3DPlayExp.manageWorkBenchs({createActionBar:!0,finishCallBack:function(){}})}this.currentScenarioName&&e&&e!==this.currentScenarioName&&this.getScenarioDetails(e)},addScenario:function(e){var t=e.registerID,i=e.scenario;if(!t||!i)return null;d++;var n={registerModule:p[t].registerModule,registerName:p[t].registerName,scenarioName:e.name,scenarioManager:this,id:d},r={scenarioID:d,available:e.available,scenario:new i(n),subScenario:{}};return r.scenario&&(p[t].scenario[d]=r),(!this._defaultRegisterID||!0===p[t].isDefault&&t!==this._defaultRegisterID)&&(this._defaultRegisterID=void 0,this._setDefaultRegister()),this._updateScenarioChooser(),r.scenarioID},removeScenario:function(e,t){if(!e||!t)return!1;var i=!0,n=p[e].scenario[t];if(n.scenario!==this._currentID){if(Object.keys(n.subScenario).length>0)for(var r in n.subScenario)i=this.removeSubScenario(e,t,n.subScenario[r].scenarioID);if(!0===i)return n.scenario.dispose(),n.scenario=void 0,n=void 0,delete p[e].scenario[t],this._defaultRegisterID&&this._defaultRegisterID===e&&this._setDefaultRegister(),i}return!1},addSubScenario:function(e){var t=e.registerID,i=e.scenarioID,n=e.subScenario;if(!t||!i||!n)return null;d++;var r={registerModule:p[t].registerModule,registerName:p[t].registerName,scenarioName:e.name,scenarioManager:this,id:d},s={scenarioID:d,available:e.available,parentScenarioID:i,scenario:new n(r)};return s.scenario&&(p[t].scenario[i].subScenario[d]=s),(!this._defaultRegisterID||!0===p[t].isDefault&&t!==this._defaultRegisterID)&&(this._defaultRegisterID=void 0,this._setDefaultRegister()),s.subScenarioID},removeSubScenario:function(e,t,i){if(!e||!t||!i)return!1;var n=p[e].scenario[t].subScenario[i];return scenario.scenario!==this._currentID&&(n.scenario.dispose(),n.scenario=void 0,n=void 0,delete p[e].scenario[t].subScenario[i],this._defaultRegisterID&&this._defaultRegisterID===e&&this._setDefaultRegister(),!0)},setAvailability:function(e,t){var i=t.iRegisterID,n=t.iScenarioID,r=t.iSubScenarioID,s=!1;return e||(e=!1),r&&n&&i&&p[i]&&p[i].scenario[n]?p[i].scenario[n].subScenario[r]&&(p[i].scenario[n].subScenario[r].available=e,s=!0):n&&i&&p[i]?p[i].scenario[n]&&(p[i].scenario[n].available=e,s=!0):i&&p[i]&&(p[i].available=e,i===this._defaultRegisterID&&this._setDefaultRegister(),s=!0),this._updateScenarioChooser(),s},initScenario:function(){this._updateScenarioChooser();var e=this._getDefaultScenario();this.changeScenario(e.registerID,e.scenarioID,e.subScenarioID,void 0,!0,!0)},getScenarioDetails:function(e){var t,i,n,r=!1,s=this;for(var a in p)if(!r&&p.hasOwnProperty(a)){var o=[];for(var l in p)o.push(p[l]);o.forEach(function(a){if(t=a.registerID,!r)for(var o in a.scenario)if(a.scenario[o].scenario.name===e){r=!0,i=a.scenario[o].scenarioID,n=a.scenario[o].subScenario.subScenarioID,s.changeScenario(t,i,n,!0,void 0,!0);break}})}},changeScenario:function(e,t,n,r,s,a){var o=c.get(this._3DPlayExp.args.ctx,"ANNOTATION_MANAGER");o&&o._annotViewpointList&&o._annotViewpointList.length>0&&(this.annotJSON=o.saveAnnotationsToJSON());var u=window.widget,d=!1;if(d=!a,r)this._resetScenario(e,t,n,void 0,void 0,a);else{if(n&&(this._currentID&&this._currentID.subScenarioID&&n!==this._currentID.subScenarioID||n)){var p=this._getScenario(e,t,n);if(this._3DPlayExp.publish("SCENARIO/CHANGE",{experience:this._3DPlayExp,ctx:this._3DPlayExp.args.ctx,scenario:p.scenario}),this._currentID&&this._currentID.registerID&&this._currentID.scenarioID&&this._currentID.subScenarioID)var h=this._getScenario(this._currentID.registerID,this._currentID.scenarioID,this._currentID.subScenarioID);if(this._currentID&&t===this._currentID.scenarioID&&this._currentID.subScenarioID)h.scenario.stop(),l.scenario(p.scenario.name),p.scenario.launch(),i.resetDefaultCommand(this._3DPlayExp.args.ctx);else{var D=this._getScenario(e,t);if(this._currentID&&this._currentID.registerID&&this._currentID.scenarioID)var f=this._getScenario(this._currentID.registerID,this._currentID.scenarioID);this._currentID&&this._currentID.subScenarioID&&h.scenario.stop(),f&&f.scenario&&f.scenario.stop(),l.scenario(D.scenario.name),D.scenario.launch(),p.scenario.launch(),i.resetDefaultCommand(this._3DPlayExp.args.ctx)}return this._currentID={registerID:e,scenarioID:t,subScenarioID:n},this.currentScenarioName=D.scenario.name,!0}if(t&&(this._currentID&&this._currentID.scenarioID&&t!==this._currentID.scenarioID||t)&&!n){D=this._getScenario(e,t);if(this._3DPlayExp.publish("SCENARIO/CHANGE",{experience:this._3DPlayExp,ctx:this._3DPlayExp.args.ctx,scenario:D.scenario}),this._currentID&&this._currentID.registerID&&this._currentID.scenarioID)f=this._getScenario(this._currentID.registerID,this._currentID.scenarioID);if(this._currentID&&this._currentID.subScenarioID)(h=this._getScenario(this._currentID.registerID,this._currentID.scenarioID,this._currentID.subScenarioID)).scenario.stop();return f&&f.scenario&&f.scenario.stop(),s||l.scenario(D.scenario.name),void 0!==u&&d&&u.setValue("3DPlay.scenarioActivated",D.scenario.name),D.scenario.launch(),i.resetDefaultCommand(this._3DPlayExp.args.ctx),this._currentID={registerID:e,scenarioID:t,subScenarioID:n},this.currentScenarioName=D.scenario.name,!0}}return!1},getAllRegisters:function(){return p},getAllScenarioForRegister:function(e){if(!e)return!1;var t=[],i=p[e].scenario;for(var n in i)if(Object.keys(i[n].subScenario).length>0){var r=i[n].subScenario;for(var s in r)t.push(r[s])}else t.push(i[n]);return t},getAllScenarios:function(){var e=[];for(var t in p)e=e.concat(this.getAllScenarioForRegister(p[t].registerID));return e},getCurrentScenario:function(){if(this._currentID)return this._getScenario(this._currentID.registerID,this._currentID.scenarioID,this._currentID.subScenarioID)},isAvaiable:function(e,t,i){return e&&t&&i?p[e].scenario[t].subScenario[i].available:e&&t?p[e].scenario[t].available:e?p[e].available:null},reset:function(){p=[],this._currentID=void 0,this._requiredRegister&&this._requiredRegister.length>0&&this._initRegisters(this._requiredRegister)},getScenarioAvailibility:function(){if(this._getAllAvailableScenarios().length>1)return!0},dispose:function(){this._requiredRegister=[],this._registerLoaded=!1,p=[],this._3DPlayExp=void 0},_updateScenarioChooser:function(){if(this._3DPlayExp&&this._3DPlayExp.args&&this._3DPlayExp.args.ctx){var e=i.getCommands(this._3DPlayExp.args.ctx);e&&e.Scenario&&(this._getAllAvailableScenarios().length>1?e.Scenario.enable():e.Scenario.disable())}},_initRegisters:function(e){var t;for(t=e.length-1;t>=0;t--){var i=e[t];if(i.registerClass){var n={registerID:++d,available:!0,scenario:{},isDefault:i.isDefault,registerName:i.registerName,registerModule:i.registerModule,register:i.registerClass};p[d]=n}}for(t in p)if(p.hasOwnProperty(t)){var r,s={};s.registerID=p[t].registerID,s.scenarioManager=this,s.registerName=p[t].registerName,s.registerModule=p[t].registerModule,"function"==typeof p[t].register&&(r=new p[t].register(s)),r&&(p[r.registerID].register=r,this._defaultRegisterID&&!0!==p[r.registerID].isDefault||(this._defaultRegisterID=r.registerID))}},_loadRegisters:function(e){var t=this;if(null==e||""===e)return!1;this._3DPlayExp.disposeFunctions.add(function(){t=null});var i=function(e){if(e&&e.list&&e.list.length>0){t._requiredRegister=[];var i=0;e.list.forEach(function(n){require([n.NS+"/"+n.module+"/"+n.name],function(r){i++;var s=!1;s=!(!n.isDefault||"true"!==n.isDefault.toLowerCase()),t._requiredRegister.push({registerName:n.name,registerModule:n.module,registerClass:r,isDefault:s}),i===e.list.length&&(t._registerLoaded=!0,t._initRegisters(t._requiredRegister),t.initScenario())},function(n){i++,console.log("ERROR : require failed "+n),i===e.list.length&&(t._initRegisters(t._requiredRegister),t.initScenario())})}),!0}else!1};if(this._3DPlayExp.RegisterList)i(this._3DPlayExp.RegisterList),delete this._3DPlayExp.RegisterList;else{var n=function(e){console.log("Did not find any registers, this is OK if you are not using Scenarios in your experience. Detailed Error: "+e)},r={type:"json",cache:3600,timeout:72e5,onComplete:i,onFailure:n,onCancel:n};o.handleRequest(e,r,"RegisterList")}},_setDefaultRegister:function(){this._defaultRegisterID&&!0===p[this._defaultRegisterID].available&&(this._getAllAvailableScenarioForRegister(this._defaultRegisterID).length<1&&(this._defaultRegisterID=void 0));if(!this._defaultRegisterID){for(var e in p){if(this._getAllAvailableScenarioForRegister(p[e].registerID).length>0&&!0===p[e].available&&!0===p[e].isDefault){this._defaultRegisterID=e;break}}if(!this._defaultRegisterID)for(var e in p){if(this._getAllAvailableScenarioForRegister(p[e].registerID).length>0&&!0===p[e].available){this._defaultRegisterID=e;break}}}this._updateScenarioChooser()},_getAllAvailableScenarioForRegister:function(e){if(!e)return!1;for(var t=this.getAllScenarioForRegister(e),i=[],n=0;n<t.length;n++)!0===t[n].available&&i.push(t[n]);return i},_getDefaultScenario:function(){this._setDefaultRegister();var e=null,t=null;if(null!==this._defaultRegisterID&&p[this._defaultRegisterID]&&p[this._defaultRegisterID].available){var i=this._getAllAvailableScenarioForRegister(this._defaultRegisterID);e=i[0].scenarioID,i[0].parentScenarioID&&(e=i[0].parentScenarioID,t=i[0].scenarioID)}return{registerID:this._defaultRegisterID,scenarioID:e,subScenarioID:t}},_getAllAvailableScenarios:function(){for(var e=this.getAllScenarios(),t=[],i=0;i<e.length;i++)!0===e[i].available&&t.push(e[i]);return t},_getScenario:function(e,t,i){if(!e||!t)return null;if(i){if(p&&p[e]&&p[e].scenario&&p[e].scenario[t]&&p[e].scenario[t].subScenario&&p[e].scenario[t].subScenario[i])return p[e].scenario[t].subScenario[i]}else if(p&&p[e]&&p[e].scenario&&p[e].scenario[t])return p[e].scenario[t];return null},_resetScenario:function(e,t,i,n,r,s){var a=this;this._3DPlayExp.stop(),this._3DPlayExp.workbenchIndex=0,this._3DPlayExp.manageWorkBenchs({createActionBar:!0,finishCallBack:function(){e&&t?(a._3DPlayExp.resetScenarioMAB(),a.changeScenario(e,t,i,n,r,s)):a.initScenario()}})}})}),define("DS/3DPlayWidgetControllers/3DPlayWidgetProxy",["DS/3DPlayWidgetControllers/3DPlayWidgetProxyBase"],function(e){"use strict";var t="3DPlayWidgetProxy initialization error :";return e.extend({init:function(e){this._parent(),this.onUpdate("x3dSharedId")},onUpdate:function(e){var i;this.dispose(),"undefined"!=typeof widget?((i=widget.getValue(e))||console.log(t+"x3dSharedId is undefined"),this.configure({suffixe:i})):console.log(t+"widget is undefined")},load:function(e){this.publish("Load",e)},waitLoadEvent:function(e){this.subscribe("Load",e)},refresh:function(e){this.publish("Refresh",e)},waitRefreshEvent:function(e){this.subscribe("Refresh",e)}})}),define("DS/WebUtils/MemoryProfiler",["DS/WebSystem/DetectBrowser","DS/WebInfraUI/DOMGraph"],function(e,t){"use strict";var i={update:console.log},n=1e3,r={chrome:!0},s=1073741824,a=function(){setTimeout(a,n),i.update(Math.floor(window.performance.memory.usedJSHeapSize/s))};return function(o){o=o||{};var l=e();r[l.browser.name]&&window.performance.memory?(n=o.updateTime||n,s=o.size||s,i=o.output?o.output:new t({updateLegend:o.updateLegend||"Ko",name:o.name||"Memory",container:o.container?o.container:document.body,color:o.color||"f00",length:o.length||200,updateSize:!0}),a()):console.warn('Memory Profiling is only supported by chrome whith " --enable-precise-memory-info" option')}}),define("DS/WebUtils/Statistics",["UWA/Class","DS/WebUtils/Profiler","DS/WebSystem/Environment","UWA/Class","DS/WebSystem/FpsInfo","DS/Controls/TreeBase","DS/Controls/TreeNodeBase","DS/WebInfraUI/DOMGraph","DS/WebUtils/MemoryProfiler","DS/WebUtils/ProbesManager"],function(e,t,i,n,r,s,a,o,l,c){"use strict";var u="";return n.extend({updateProfile:function(e){if(this.UpdateProbes){this.UpdateProbes=!1;var t=this.tree.getNthRoot(0),n=c.GetProcessedData({topWindow:"full"===i.get("3DPlay.Statistics"),cleanNames:!0,only3DPlay:"full"!==i.get("3DPlay.Statistics")});if(t._children)for(;t._children&&t._children.length;)t.removeChild(t._children[0]);for(var r=function(e,t){var i;if(e._children)for(var n=0;n<e._children.length;n++){var s=e._children[n];if(t.startTime>=s.options.probeModel.startTime&&t.startTime+t.duration<=s.options.probeModel.startTime+s.options.probeModel.duration){i=s;var a=r(s,t);a&&(i=a)}}return i},s=0;s<n.probes.length;s++){var o=n.probes[s],l=(h=o).name+": "+Math.floor(h.startTime+.5)+" | "+Math.floor(h.duration+.5),u=r(t,o);u?l+=" ("+Math.floor(.5+100*o.duration/u.options.probeModel.duration)+"%)":u=t,u.addChild(new a({label:l,probeModel:o}))}if(!document.getElementById("iframedelay")){var d="undefined"!=typeof widget&&"X3DPLAW_AP"!==widget.getValue("appId")?widget.getValue("appId"):"WAFR",p=document.createElement("div");p.id="iframedelay",p.innerHTML="Time in 3DDashBoard before Widget creation : "+Math.floor(n.iframeTime)+"<br> Time in "+d+" : "+Math.floor(n.adjustTime),this.tree.getContent().insertBefore(p,this.tree.getContent().firstChild)}t.expandAll()}var h},preProcess:function(){},postProcess:function(){var e=(new Date).getTime();if(this.frames++,this.totalFrames++,e>this.prevTime+this.updatetime){var t=Math.round(1e3*this.frames/(e-this.prevTime));this.fpsInfo.min>t?this.fpsInfo.min=t:this.fpsInfo.max<t&&(this.fpsInfo.max=t),this.fpsInfo.avg=1e3*this.totalFrames/(e-this.first),this.fpsHistory.length>this.history-1&&this.fpsHistory.shift(),this.fpsHistory.push(t);var i=Math.min(this.fpsHistory.length,this.history);this.fpsInfoHistory.clear();for(var n=0;n<i;n++){var r=this.fpsHistory[n];this.fpsInfoHistory.avg+=r,this.fpsInfoHistory.min>r?this.fpsInfoHistory.min=r:this.fpsInfoHistory.max<r&&(this.fpsInfoHistory.max=r)}this.fpsInfoHistory.avg=Math.round(this.fpsInfoHistory.avg/i),this.fpsGraph.update(t),this.frames=0,this.prevTime=e,this.hidden()||(u="FPS:"+t+" ("+this.fpsInfo.toString()+") history ("+this.fpsInfoHistory.toString()+")",this.tree.getNthRoot(0).elements.label.innerText="=> Task : Start time from 3DPlay Entry point | duration time",this.updateProfile())}},clearHistory:function(){this.fpsInfo=new r,this.fpsInfoHistory=new r;for(var e=history;e--;)this.fpsGraph.update(fps);this.fpsHistory=[],this.totalFrames=0,this.frames=0,this.startTime=(new Date).getTime(),this.prevTime=this.startTime,this.first=this.startTime,this.frameduration=this.startTime,this.frames=0,this.totalFrames=0},visibility:function(e){this.stats.style.display=e?"block":"none"},show:function(){this.visibility(!0)},hide:function(){this.visibility(!1)},hidden:function(){return"none"==this.stats.style.display},dispose:function(){this.hide(),this.fpsGraph.dispose(),this.fpsGraph=null,this.cleanDiv(),this.container=null,this.stats.empty&&this.stats.empty(),this.stats=null},cleanDiv:function(){try{this.container.removeChild(this.stats)}catch(e){}},set:function(e){this.container!=e.container&&(this.container=e.container,this.cleanDiv(),this.container.appendChild(this.stats))},init:function(e){this.UpdateProbes=!1,e=e||{},this.clearHistory(),this.updatetime=void 0!==e.updatetime?e.updatetime:200;var t=i.get("Statistics.updateTime");t&&(this.updatetime=parseInt(t)),this.historySecond=void 0!==e.historySecond?e.historySecond:50,this.history=void 0!==e.history?e.history:1e3*this.historySecond/this.updatetime,(t=i.get("Statistics.history"))&&(this.history=parseInt(t));this.stats=document.createElement("div"),this.stats.id="statistics",this.stats.style.cssText="top:25px;left:25px;position:absolute;height:100%",document.getElementById("Memory")||l({container:this.stats,length:this.history,updateTime:this.updatetime,size:1048576,updateLegend:"Mo"}),this.fpsGraph=new o({name:"FrameRate",container:this.stats,color:"0b5",length:this.history,caption:function(){return u}}),this.stats.appendChild(this.fpsGraph.getContainer()),this.tree=new s,this.tree.getContent().setStyles({minHeight:400,top:0,left:0,position:"relative",opacity:.8}),this.tree.addRoot({label:"Root"}),this.tree.inject(this.stats),this.hide();var n=this;document.addEventListener("keydown",function(e){222==e.keyCode&&(n.hidden()?n.show():n.hide())},!1),setTimeout(function(){n.show()},10),this._parent({name:"Statistics"})}})}),define("DS/3DPlayWidgetViews/W3DPlayerView",["DS/CoreEvents/Events","UWA/Class","DS/3DPlayHelper/3DPlayHelper","DS/3DPlaySupport/AssetSupport","i18n!DS/3DPlayHelper/assets/nls/SplashScreen","css!DS/3DPlayWidgetViews/W3DPlayerView","DS/WebSystem/Environment","DS/WebappsUtils/WebappsUtils","DS/WebUtils/Tracker"],function(e,t,i,n,r,s,a,o,l){"use strict";var c,u,d,p,h=[];return t.extend({init:function(t,i){c=t,u=i,this._parent(t,i),p=this,h.push(e.subscribeOnce({event:"PrefsCtrl.PreferencesReady"},function(e){p.instantiate3DPlayWebPlayer()})),h.push(e.subscribe({event:"Player.load"},function(e){d&&(d.load(e),e&&e.input&&e.input.asset&&e.input.asset.localFile&&c.setTitle(e.input.asset.localFile.name))})),h.push(e.subscribe({event:"Model.changeCurrent"},function(e){p.instantiate3DPlayWebPlayer()})),h.push(e.subscribe({event:"Model.changeCSO"},function(e){var t;d.instance&&d.instance.pad3DViewer&&(t=d.instance.pad3DViewer._lockCSONotification,d.instance.pad3DViewer._lockCSONotification=!0),d.emptySelection(),d.selectNode(e);setTimeout(function(){d.instance&&d.instance.pad3DViewer&&(d.instance.pad3DViewer._lockCSONotification=t)},50)}))},instantiate3DPlayWebPlayer:function(){var e=u.getCurrentData();a.isSet("3DPlay.Debug")&&console.log("3DPlay.Debug:instantiate3DPlayWebPlayer",e),e.displayName?u.setCurrentTitle(e.displayName):c.setTitle(""),u.get3DPlayWebInputObject(e,function(t){t.container=u.getCanvasDiv(),t.input&&t.input.asset&&(t.input.asset.displayname=e.displayName),p.startPlayer(t)})},dispose:function(t){d&&(d.dispose(t),d=null),c=null,u=null,p=null;for(var i=0;i<h.length;i++)e.unsubscribe(h[i]);h=[]},startPlayer:function(e){this.applicationFrameOptions&&e.options&&(e.options.callbacks&&(e.options.callbacks=UWA.extend(e.options.callbacks,this.applicationFrameOptions.options.callbacks,!0)),e.options=UWA.extend(e.options,this.applicationFrameOptions.options,!0),e.input&&this.applicationFrameOptions.experience&&(e.input.experience=this.applicationFrameOptions.experience,delete this.applicationFrameOptions.experience)),this.applicationFrameOptions&&this.applicationFrameOptions.options&&this.applicationFrameOptions.options.pad3DViewer&&delete this.applicationFrameOptions.options.pad3DViewer,d?d.isReady()?d.load(e):u.isPendingLoadingCozNotReady=!0:(e.options.callbacks.EXPERIENCE=e.options.callbacks.EXPERIENCE||{},e.options.callbacks.EXPERIENCE.EXPERIENCESPLASHSCREEN=function(e){if(!a.isSet("3DPlay.LandingPage.disable")){var t=e.elements.container;t.addClassName("Landing-Page_container");var i=new UWA.Element("div",{id:"Landing-Page",class:"Landing-Page"}).inject(t);i.addContent({tag:"div",class:"lp-txt-container",html:[{tag:"h4",id:"lp-msg",class:"lp-txt font-3dsregular",html:r.DROP_MSG_LP},{tag:"img",class:"lp-drop-img",src:o.getWebappsBaseUrl()+"3DPlayWidgetViews/assets/images/Drag_and_drop_lightgrey-04.png"}]});var n=function(){var e=this.container;if(0!==e.offsetWidth&&0!==e.offsetHeight){var t=this.view;e.offsetWidth>780&&e.offsetHeight>200?(t.style.backgroundImage="url('"+o.getWebappsBaseUrl()+"3DPlayHelper/assets/images/3DPlayLandingPage.svg')",t.getElementsByTagName("h4")[0].show(),t.getElementsByTagName("img")[0].show(),t.getElementsByTagName("img")[0].removeClassName("lp-drop-img-small"),t.getElementsByTagName("img")[0].addClassName("lp-drop-img")):e.offsetWidth<779&&e.offsetWidth>581&&e.offsetHeight>200?(t.style.backgroundImage="url('"+o.getWebappsBaseUrl()+"3DPlayHelper/assets/images/3DPlayLandingPage.svg')",t.getElementsByTagName("h4")[0].show(),t.getElementsByTagName("img")[0].show(),t.getElementsByTagName("img")[0].removeClassName("lp-drop-img-small"),t.getElementsByTagName("img")[0].addClassName("lp-drop-img")):e.offsetWidth<580&&e.offsetWidth>280&&e.offsetHeight>200?(t.style.backgroundImage="url('"+o.getWebappsBaseUrl()+"3DPlayHelper/assets/images/Small-02.svg')",t.getElementsByTagName("h4")[0].hide(),t.getElementsByTagName("img")[0].show(),t.getElementsByTagName("img")[0].removeClassName("lp-drop-img"),t.getElementsByTagName("img")[0].addClassName("lp-drop-img-small")):e.offsetWidth<280||e.offsetHeight<200?(t.style.backgroundImage="url('"+o.getWebappsBaseUrl()+"3DPlayHelper/assets/images/Xsmall-03.svg')",t.getElementsByTagName("h4")[0].hide(),t.getElementsByTagName("img")[0].hide(),t.getElementsByTagName("img")[0].removeClassName("lp-drop-img"),t.getElementsByTagName("img")[0].removeClassName("lp-drop-img-small")):(t.style.backgroundImage="url('"+o.getWebappsBaseUrl()+"3DPlayHelper/assets/images/3DPlayLandingPage.svg')",t.getElementsByTagName("h4")[0].show(),t.getElementsByTagName("img")[0].show(),t.getElementsByTagName("img")[0].removeClassName("lp-drop-img-small"),t.getElementsByTagName("img")[0].addClassName("lp-drop-img"))}}.bind({container:t,view:i});t.addEvent("resize",n),n()}},d=new i(e)),u.setPlayerRef(d)},widgetRefreshHandler:function(){var e;if(d){d.instance&&d.instance.refresh&&(e=d.instance.refresh());try{var t=d.instance.args.input.experience.filename||d.instance.args.input.experience;l.trackPageEvent("infos","refresh",t,e?1:0,{count:l.incCommandCounter()})}catch(e){}if(e)return!0;d.dispose(),d=null}return u.getCanvasDiv().empty(),!1},search:function(e){d&&d.instance&&d.instance.search&&d.instance.search(e)},resetsearch:function(e){d&&d.instance&&d.instance.resetsearch&&d.instance.resetsearch(e)}})}),define("DS/3DPlaySupport/XCADSpatialSupportedFormats",["UWA/Core","DS/WebSystem/Environment"],function(e,t){"use strict";var i={"3dm":"3dxml",asat:"3dxml",asab:"3dxml",catdrawing:"udl",catpart:"3dxml",catproduct:"asm",cgm:"svg",dae:"3dxml",dgn:"3dxml",dwg:"udl",dxf:"udl",eprt:"3dxml",eprtx:"3dxml",easm:"3dxml",easmx:"3dxml",edrw:"udl",edrwx:"udl",exp:"3dxml",fbx:"3dxml",gml:"asm",ifc:"3dxml",ifczip:"3dxml",iges:"3dxml",igs:"3dxml",ipt:"3dxml",jt:"3dxml",model:"3dxml",p_b:"3dxml",p_t:"3dxml",par:"3dxml",prt:"3dxml",rfa:"3dxml",rvt:"3dxml",sab:"3dxml",sat:"3dxml",sldasm:"3dxml",slddrw:"udl",sldprt:"3dxml",step:"3dxml",stp:"3dxml",stpz:"3dxml",stpx:"asm",stpxz:"asm",step_Convert:"3dxml",tif:"svg",tiff:"svg",x_b:"3dxml",x_t:"3dxml",xmp_bin:"3dxml",xmp_txt:"3dxml",xmt_bin:"3dxml",xmt_txt:"3dxml",vda:"3dxml",xcgm:"3dxml",zae:"3dxml"};return t.isSet("3DPlay.eDrawingSupport")&&e.extend(i,{eprt:void 0,eprtx:void 0,easm:void 0,easmx:void 0,edrw:void 0,edrwx:void 0,dwg:void 0,dxf:void 0,slddrw:void 0,sldprt:void 0,sldasm:void 0},!0),t.isSet("3DPlay.ProtoConvertSpatial")&&e.extend(i,{asm:"3dxml",catshape:"3dxml",cgm3d:"3dxml",iam:"3dxml",session:"3dxml"},!0),t.isSet("3DPlay.OfficeDocuments")&&"true"==t.get("3DPlay.OfficeDocuments")||e.extend(i,{doc:"pdf",docx:"pdf",docm:"pdf",dot:"pdf",dotm:"pdf",dotx:"pdf",rtf:"pdf",ppt:"pdf",pptx:"pdf",pot:"pdf",potm:"pdf",potx:"pdf",pps:"pdf",ppsm:"pdf",ppsx:"pdf",pptm:"pdf",xls:"pdf",xlsx:"pdf",xlsm:"pdf",xlsb:"pdf",xlt:"pdf",xltm:"pdf",xltx:"pdf",csv:"pdf",msg:"pdf"},!0),window.localStorage["3DPlayWinApp.3DXML_STP_Only"]&&(i={}),i}),define("DS/3DPlayConnectors/3DPlayInputPreProcessor",["UWA/Core","DS/WebUtils/StringUtils","DS/WebSystem/Environment","DS/3DPlaySupport/ExperiencesList","DS/3DPlaySupport/SupportList","DS/WebUtils/ProbesManager","DS/3DPlaySupport/XCADSpatialSupportedFormats","DS/WebUtils/Tracker"],function(e,t,i,n,r,s,a,o){"use strict";return function(){var n="",l=function(e,i,c){var u={error:{NLS_ID:"BadUrl"}};if(Array.isArray(e)||"function"==typeof e||null==e)c(u,i);else{if("string"==typeof e?((u={}).filename=e,u.provider="FILE"):"object"==typeof e&&"object"==typeof e.asset?(u={},u=e.asset):"object"==typeof e&&"string"==typeof e.asset?((u={}).filename=e.asset,u.provider="FILE"):u=e||u,u.provider=(u.provider||"FILE").toUpperCase(),"FILE"===u.provider){if(void 0===u.filename||null===u.filename)u.error={NLS_ID:"BadUrl"};else if(void 0!==u.format&&null!==u.format&&"string"==typeof u.format)u.mimetype=u.format.toLowerCase();else{var d=t.getExtension(u.filename);u.mimetype=""===d?"3dxml":d.toLowerCase(),!a[u.mimetype]&&u.url&&(u.serverurl="",u.filename=u.url)}u.format=u.mimetype,u.type=u.mimetype}else if("BUFFER"===u.provider)(void 0===u.dataFormat||null===u.dataFormat||""===u.dataFormat||"string"!=typeof u.dataFormat&&"svg"!=typeof u.dataFormat)&&(u=null),u.type=u.dataFormat;else if("EV6"===u.provider||"3DSPACE"===u.provider||"GEOVIA"===u.provider||"EV5"===u.provider){if(void 0===u.physicalid||null===u.physicalid||""===u.physicalid||"string"!=typeof u.physicalid||void 0===u.serverurl||null===u.serverurl||""===u.serverurl||"string"!=typeof u.serverurl)void 0!==u.physicalid&&null!==u.physicalid&&""!==u.physicalid&&"string"==typeof u.physicalid||o.trackPageEvent("errors","initialization","physicalid"),void 0!==u.serverurl&&null!==u.serverurl&&""!==u.serverurl&&"string"==typeof u.serverurl||o.trackPageEvent("errors","initialization","serverurl"),u.error={NLS_ID:"BadUrl"};else if(void 0===u.dtype||null===u.dtype||""===u.dtype||"string"!=typeof u.dtype){var p={};p[u.dtype]=1,o.trackPageEvent("errors","initialization","DeFaUltDtYpE",0,p),u.dtype="DeFaUltDtYpE"}u.type=u.dtype}var h=u._3DPlayDatas&&u._3DPlayDatas.externalDrive||"DROPBOX"===u.provider||"GOOGLE"===u.provider||"ONEDRIVE"===u.provider||u.filename&&u.filename.includes("driveshub")&&u.filename.includes("drive/v1/")||u.requestsOptions&&u.requestsOptions.authentication&&u.requestsOptions.authentication.Adapter&&u.requestsOptions.authentication.Adapter.options&&u.requestsOptions.authentication.Adapter.options.provider;null!=h&&(u._3DPlayDatas=u._3DPlayDatas||{},u._3DPlayDatas.externalDrive=h),u.type=u.type||u.dataFormat||u.dtype,n===u.provider+"-"+u.type?c(u,i):function(e,t,i,a){var o,l;if(null!==e&&(null===e.error||void 0===e.error)){var c=function(n){var c=function(n){if(e&&e.tenant&&(n.tenant=e.tenant),void 0!==e._3DPlayDatas&&null!==e._3DPlayDatas&&(n._3DPlayDatas=e._3DPlayDatas),n){var r,s,o,l=null;e&&(l=e.originalAsset||e,r=e.swymAttr,s=e.swymServerToken,o=e.driveAttr),n.asset?(n.asset.originalAsset=l,r&&(n.asset.swymAttr=r),s&&(n.asset.swymServerToken=s),o&&(n.asset.driveAttr=o)):(n.originalAsset=l,r&&(n.swymAttr=r),s&&(n.swymServerToken=s),o&&(n.driveAttr=o))}i(n,t,a)},u=function(i){e.error=i,a(e,t)};"string"==typeof n?require([n],s.createFunctionProbe("Connector_Require",function(t){(n=r[o][l].connector=new t).open(e,s.createFunctionProbe("Connector_Finished",c),u)}),function(){u({NLS_ID:"Preproc_REQUIRE_FAIL"})}):n.open(e,s.createFunctionProbe("Connector_Finished",c),u)},u=r[e.provider];if(u){if(o=e.provider,u.connector)return void c(u.connector);if(u.resolveParenting)return void u.resolveParenting(e,function(i){if(null!=i&&null!==u[i]&&void 0!==u[i]){var n=u[l=i].connector;if(n)return void c(n)}a(e,t)});l=e.type;var d=u[l]?u[l].connector:void 0;if(d)return n=e.provider+"-"+e.type,void c(d)}}a(e,t)}(u,i,l,c)}},c=function(e,t){var i=[null];if(null!=e){Array.isArray(e)?e.length>0&&(i=e):(i=new Array).push(e);for(var n=0,r=function(e,r){i[r]=e,++n===i.length&&t(i)},s=0;s<i.length;s++)l(i[s],s,r)}else t(i)};this.run=function(t,r){var s={asset:null};i.isSet("3DPlay.Debug")&&console.log("3DPlay.Debug:3DPlayInputPreProcessor.run",t);var a=window.localStorage["3DPlay.OverrideSettings"];if(void 0!==a){console.warn("!! 3DPlay OverrideSetting variable environment Active"),console.warn("Current inputs :"+JSON.stringify(t));try{(a=JSON.parse(a))&&(console.warn("Found inputs :"+JSON.stringify(a)),t=e.extend(t,a.input,!0))}catch(e){console.error("Override failed : JSON.parse error"+e)}console.warn("Resulting inputs :"+JSON.stringify(t))}if(null!=t&&!1===e.equals({},t)&&(!Array.isArray(t)||t.length>0))if("object"==typeof t&&!0===t.preProcessed)s=t;else{var o=function(e){n="",1===e.length?s.asset=e[0]:s.asset=e,s.preProcessed=!0,r(s)};if("object"!=typeof t||!(t.asset||t.experience||t.usage))return void c(t,o);if(s=t,void 0!==t.asset&&null!==t.asset&&!1===e.equals({},t.asset)&&(!Array.isArray(t.asset)||t.asset.length>0))return void(Array.isArray(t.asset)?c(t.asset,o):l(t.asset,0,o));s.asset=null}s.preProcessed=!0,r(s)}}}),define("DS/3DPlay/3DPlayScenario",["DS/3DPlay/3DPlay","UWA/Class","DS/WebappsUtils/WebappsUtils","DS/WebSystem/Environment","DS/WebSystem/Nls","DS/WebSystem/Rsc"],function(e,t,i,n,r,s){"use strict";return t.extend({init:function(e){var t=this;this.scenarioID=e.id,this.scenarioManager=e.scenarioManager,this.title="Scenario"+this.scenarioID,this.description="Description"+this.scenarioID,this.name=e.scenarioName,this.scenarioResetActionBarPolicy=!0,require(["i18n!DS/"+e.registerModule+"/assets/nls/"+e.registerName],function(i){i&&(t.title=i[e.scenarioName+"_Title"],t.description=i[e.scenarioName+"_Description"])},function(){r.nls(e.registerModule+"/"+e.registerName,e.registerName+"."+e.scenarioName+".Title",function(e){t.title=e}),r.nls(e.registerModule+"/"+e.registerName,e.registerName+"."+e.scenarioName+".Description",function(e){t.description=e})}),s.rsc(e.registerModule+"/"+e.registerName,{iconName:e.scenarioName,iconSize:"Normal"},function(e){t.icon=e})},setScenarioResetActionBarPolicy(e){this.scenarioResetActionBarPolicy=e},getScenarioResetActionBarPolicy(e){return this.scenarioResetActionBarPolicy},dispose:function(){this.scenarioManager=void 0,this.title=void 0,this.icon=void 0,this.description=void 0},getTitle:function(){return this.title},getDescription:function(){return this.description},getIcon:function(){return this.icon},launch:function(){},stop:function(){},loadWorkbench:function(e,t,i){e&&e.module&&e.name||console.error(this.title," did not provide a valid workbench");var n=void 0===t||t,r=this.scenarioManager.getExperience();r.WKPromise?r.WKPromise.then(function(){r.loadWorkbench(e,n,i),r=null}):r.loadWorkbench(e,n,i)},isMobileCompatible:function(){return!1}})}),define("DS/3DPlay/PlayScenario3D",["DS/3DPlay/3DPlayScenario"],function(e){"use strict";return e.extend({init:function(e){this._parent(e)}})}),define("DS/3DPlayWidget/3DPlayWidgetProxyEnopad",["DS/3DPlayWidgetControllers/3DPlayWidgetProxyBase","DS/WebUtils/Tracker"],function(e,t){"use strict";return e.extend({init:function(e,i){this._parent({prefix:"DS/PADUtils/PADCommandProxy"}),this.subscribe("select",function(e){if("undefined"!=typeof widget&&e&&e.metadata&&widget.id!==e.metadata.originWidgetId){for(var i=e.data.paths,n=i.length,r=[],s=0;s<n;s++)i[s].length>0&&r.push(i[s].join("/"));if(r.length){t.trackPageEvent("interactions","select",e.data.sharedID),t.pause(!0);try{this.setCurrentCSO(r)}catch(e){}t.pause(!1)}}}.bind(e))}})}),define("DS/3DPlayWidget/W3DPlayModel",["UWA/Class","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/CoreEvents/Events","DS/WebSystem/Environment","i18n!DS/3DPlayWidget/assets/nls/3DPlayWidget","DS/3DPlayConnectors/3DPlayInputPreProcessor","DS/WebUtils/WebServices"],function(e,t,i,n,r,s,a){"use strict";var o,l,c={protocol:"3DXContent",version:"1.0",source:"defaultString",data:{items:[{envId:"defaultString",serviceId:"defaultString",contextId:"defaultString",objectId:"defaultString",objectType:"defaultString",displayName:""}]}};return e.extend({init:function(e){o=this,l=e,this.boxMessage=this.constructBoxMessageData(),this.setBoxMessageText(),this.objIdx=0,this.availableExperiences=[],this.availableServices=[],this.currentContent=void 0,this.canvasDivRef=void 0,this.x3d=void 0,this.currentCSO=void 0,this.plateformPromise=this.getAllPlatformServices(),this.plateformPromise.then(function(e){var i=function(e){o.availableServices=e,n.set("3DPlay.Plateform.3DSpaceUrl",e);var r=n.get("x3dPlatformId");if(r){var s=!1;e.some(function(e){if(r==e.platformId&&e.url&&""!==e.url)return s=!0,!0}),s||setTimeout(function(){t.getServiceUrl({serviceName:"3DSpace",onComplete:i})},5e3)}};i(e)},function(e){console.error("getAllPlatformServices Error!"),console.dir(e)})},dispose:function(){l=null},getCollabSpacePref:function(){return l.getValue("CollabSpacePref")},getX3dContentPref:function(){return l.getValue("X3DContentId")},getSwymModelIdPref:function(){return l.getValue("MODELID")},getSwymTenantIdPref:function(){return l.getValue("swymTenantId")},getW3DPlayContentPref:function(){return l.getValue("W3DPlayContent")},getCurrentContent:function(){return this.currentContent},getCurrentData:function(e){return void 0!==this.currentContent&&(UWA.is(e)||(e=0),this.currentContent.data.items[e])},getCurrentProvider:function(){var e=this.getCurrentData();return e?e.serviceId:""},getWidgetMessage:function(e){if(UWA.is(e,"string")){if(r[e])return r[e];console.error("Unable to find Nls key for :",e)}else console.error("Invalid nls key > ",e)},getAllPlatformServices:function(){return new Promise(function(e,i){t.getServiceUrl({serviceName:"3DSpace",onComplete:e,onFailure:function(e){i(e),console.error("Error in i3DXCompassServices.getPlatformServices :",e)}})})},get3DSpaceServiceUrl:function(e){var t=!1;return e&&UWA.is(e,"string")&&this.availableServices.forEach(function(i){i.platformId===e&&(t=i.url)}),t},constructBoxMessageData:function(){return{invite_msgDom:"",invite_imgDom:"",DEFAULT:{classIcon:"fonticon-block",msg:""},REPLACE:{classIcon:"fonticon-down-circled",msg:""},DROPIT:{classIcon:"fonticon-down-circled",msg:""},ERROR:{classIcon:"fonticon-block",msg:""}}},getBoxMessageData:function(){return this.boxMessage},getBoxClassIcon:function(e){return this.boxMessage[e].classIcon},getBoxMessageText:function(e){return this.boxMessage[e].msg},getCanvasDiv:function(){return this.canvasDivRef},getCurrentCSO:function(){return this.currentCSO},setInitialContent:function(e){this.currentContent=e},setCurrentContentFromPublishedFile:function(e){UWA.clone(c).data.items[0];var t=UWA.clone(c);t.data.items[0]=e,e.displayName&&this.setCurrentTitle(e.displayName),this.setCurrentContent(t,!0),this.getAssetFromProvider(e,function(e){(new s).run(e,function(e){o.getPlayerRef().getExperience().args.input.asset=e.asset})})},setCurrentContentFromSwitch:function(e){if(e[0]){var t=require("DS/ENOPAD3DViewer/utils/PAD3DViewerModelServices").getNodeID(e[0]);if(t){var i=UWA.clone(c);i.data.items[0].objectId=t,i.data.items[0].serviceId="3DSPACE",i.data.items[0].envId=l.getValue("x3dPlatformId"),i.data.items[0].objectType="VPMReference",this.setCurrentContent(i,!0)}}},setCurrentContent:function(e,t){this.currentContent=e,t||this.update("Model.changeCurrent"),this.setW3DPlayContent(this.currentContent);var i=this.getCurrentData();i.displayName&&l.setValue("afrProductTitle",i.displayName)},setCurrentTitle:function(e){""!==e&&void 0!==e&&this.currentContent&&(this.currentContent.data.items[0].displayName=e,this.update("Model.changeTitle"))},setCanvasDiv:function(e){this.canvasDivRef=e},setW3DPlayContent:function(e){l.setValue("W3DPlayContent",JSON.stringify(e))},saveSwitchAppPreferences:function(e){var t=l.getValue("xsceneStoredObjects");t=UWA.is(t,"string")?JSON.parse(t):{products:{},filters:{}},"ENOStrRefinementSpecification"===e.objectType?e.rootBag&&(t.filters[e.objectId]={associatedProduct:require("DS/ENOPAD3DViewer/utils/PAD3DViewerModelServices").getNodeID(e.rootBag)}):t.products[e.objectId]={},l.setValue("xsceneStoredObjects",JSON.stringify(t))},setCurrentCSO:function(e){this.currentCSO=e,this.update("Model.changeCSO",this.currentCSO)},setPlayerRef:function(e){this.playerRef=e},getPlayerRef:function(){return this.playerRef},setBoxMessageText:function(){this.boxMessage.REPLACE.msg=this.getWidgetMessage("REPLACE_IT_MSG"),this.boxMessage.DROPIT.msg=this.getWidgetMessage("DROP_IT_MSG"),this.boxMessage.ERROR.msg=this.getWidgetMessage("DROP_ERROR_MSG")},isSwymIdValid:function(e){return!(!UWA.is(e)||""==e||"false"==e||void 0===e)&&e},isX3DContentIdValid:function(e){if(!e||"undefined"===e)return!1;var t=JSON.parse(e);return UWA.is(t,"object")?!!t.hasOwnProperty("data"):void 0},get3DPlayWebInputObject:function(e,t){var i={input:{},options:{loading:"autoplay",callbacks:{experience:{ExperienceReady:function(){if(o.isPendingLoadingCozNotReady)return o.isPendingLoadingCozNotReady=!1,void o.update("Model.changeCurrent")},dispose:function(){}},asset:{LoadingFinished:function(){o&&o.LoadingFinishedCB.apply(o,arguments)}}}}};e?o.getAssetFromProvider(e,function(e){var n=o.getCurrentContent();o.drag&&n.source&&(e.asset.source=n.source),o.drag=!1,void 0!==e&&(i.input=e),t(i)}):t(i)},getAssetFromProvider:function(e,t){var i,n=e.serviceId.toUpperCase();switch(n){case"3DSWYM":i=this.get3DSwymInput(e);break;case"3DSPACE":return void(i=this.get3DSpaceInput(e,t));case"3DDRIVE":case"GOOGLE":case"DROPBOX":case"ONEDRIVE":i=this.getDriveInput(e);break;case"2DLAYOUT":i=this.get2DLayoutInput(e);break;case"FILE":i={asset:e};break;case"R2VSURVEY":i={asset:e},e.provider=e.serviceId,e.type=e.objectType,e.dtype=e.objectType;break;default:console.warn("Missing provider, this must be set! ",n)}t(i)},isLoadingFinished:function(){var e=this.getPlayerRef();return!(!e||!e.instance)&&e.instance.isLoadingFinished()},LoadingFinishedCB:function(e){if(e&&e.loadAssetInfo&&e.loadAssetInfo.localFile&&-1===["STPA"].indexOf(e.loadAssetInfo.format.toUpperCase())){require(["DS/3DPlaySave/SaveServices","i18n!DS/3DPlaySave/assets/nls/SaveServices"],function(t,i){l.setTitle(e.loadAssetInfo.localFile.name+" ("+i.FileDnDFromDesktopNotif_PreviewTitle+")"),t(e,function(t){o.setCurrentContentFromPublishedFile(t),l.setTitle(e.loadAssetInfo.localFile.name)},o.getPlayerRef().getExperience())})}else{if(this.isPendingLoadingCozNotReady)return this.isPendingLoadingCozNotReady=!1,void this.update("Model.changeCurrent");var t=this.getCurrentContent();this.setW3DPlayContent(t);var i=this.getCurrentData();i.displayName?l.setValue("afrProductTitle",i.displayName):this.playerRef.instance&&this.playerRef.instance.pad3DViewer&&this.playerRef.instance.pad3DViewer.getContentName({callbacks:{onComplete:function(e){o&&o.setCurrentTitle(e.contentName),l.setValue("afrProductTitle",e.contentName)},onFailure:function(){}}}),"3DSWYM"===this.getCurrentProvider().toUpperCase()&&this.get3DSwymTitle(t)}},get3DSwymTitle:function(e){var t=this;if(this.x3d)this.x3d.get3DSwymMetaData(e,function(e){t.setCurrentTitle(e.title),t=null},console.error);else{require(["DS/3DPlayConnectors/3DSwymConnector"],function(i){t.x3d=new i,t.get3DSwymTitle(e)})}},get2DLayoutInput:function(e){var t={asset:e.asset};return t.asset.originalAsset={provider:"3DSPACE",type:"2DLayout"},t},get3DSwymInput:function(e){return{asset:{objectId:e.objectId,provider:"3DSwym",envId:e.envId,tenant:e.envId,type:"media"}}},getDriveInput:function(e){return{asset:{objectId:e.objectId,provider:e.serviceId.toUpperCase(),physicalid:e.objectId,requiredAuth:"passport",type:e.objectType,dtype:e.objectType,tenant:e.envId}}},get3DSpaceInput:function(e,t){var i=this.get3DSpaceServiceUrl(e.envId);i?a.getSecurityContext(e.envId).then(function(n){t({asset:{provider:"EV6",physicalid:e.objectId,serverurl:i,serviceId:e.serviceId,type:e.objectType,dtype:e.objectType,requiredAuth:"passport",tenant:e.envId,contextid:n||e.contextId,Play3DXContent:o.currentContent}})}):(console.warn("3DPlay WIDGET : Unable to find 3DSpace Service for Tenant > ",e.envId),t())},update:function(e,t){i.publish({event:e,data:t})}})});var Provider={FILE:"FILE",BUFFER:"BUFFER",EV6:"EV6"};define("DS/3DPlaySupport/Loader",["DS/WebSystem/Environment","DS/3DPlaySupport/AssetSupport","DS/3DPlaySupport/SupportList","DS/3DPlaySupport/ExperiencesList","DS/WebUtils/StringUtils","DS/WebSystem/Nls","DS/WebUtils/ProbesManager","DS/3DPlayConnectors/3DPlayInputPreProcessor","DS/3DPlayConnectors/ErrorManagement","DS/3DPlay/3DPlay","i18n!DS/3DPlay/assets/nls/3DPlay"],function(e,t,i,n,r,s,a,o,l,c,u){"use strict";return function(e,s,d,p,h,D){var f=a.createProbe("Create Experience");f.begin();var g=a.createProbe("Preprocessor");g.begin(),(new o).run(e,function(e){g.end(),g=null;var o=null,d=function(t){if(D&&D.getOnlyPath)p(t);else{var i=a.createProbe("Experience_Require");i.begin(),require([t],function(t){i.end(),f.end(),f=i=null,p(t,e)},h)}},m=function(t){var i=Array.isArray(t)?t[0]:t,a=n[i];if(void 0!==a)return console.log(r.sprintf('3DPlay: Product found : "{0}" in Experience "{1}"',a.name,a.module)),e.experience={},e.experience.filename=a.module,void d(a.module);c.displayFatalError({ctx:s,msg:u.NoExperience+i,error:"NoExperience"})};if(void 0!==e.experience){if("string"!=typeof e.experience){var y=e.experience;return void 0===y.provider&&(y.provider="FILE"),"FILE"===y.provider.toUpperCase()&&void 0!==y.filename&&null!==y.filename&&"string"==typeof y.filename?void d(y.filename):void SHARE.Core.displayFatalError({ctx:s,msg:u.BadExperience,error:"BadExperience"})}o=[e.experience]}else{var v=Array.isArray(e.asset)?e.asset[0]:e.asset;if(null!=v){if(v.error&&l(v.error,s))return;return void t.getExperienceID(v,{doOpen:!0,usage:e.usage},function(e){if(null!=e)m(e);else if("EV6"===v.provider)c.displayFatalError({ctx:s,msg:u.BadDType,error:"BadDType"});else if("FILE"===v.provider){var t=v.mimetype||v.format;c.displayFatalError({ctx:s,msg:u.UnsupportedMimeType1+t.toUpperCase()+u.UnsupportedMimeType2,error:"NoMimeType"})}else"3DSWYM"===v.provider&&c.displayFatalError({ctx:s,msg:v.type.toUpperCase()+u.UnsupportedMimeType2,error:"NoMimeType"})})}o=i.FILE["3dxml"]}Array.isArray(o)&&o.length>1&&(o=o[i.computeUsage(e.usage)]);m(o)})}}),define("DS/3DPlayHelper/3DPlayWebPlayer",["DS/3DPlay/3DPlay","DS/3DPlayHelper/SplashScreen","DS/3DPlayConnectors/3DPlayInputPreProcessor","DS/3DPlayConnectors/ErrorManagement","DS/WebSystem/Environment","DS/CoreEvents/Events","DS/WebSystem/Context","DS/WebUtils/ContextedSingleton","DS/WebUtils/ProbesManager","UWA/Core","DS/3DPlaySupport/Loader","DS/WebappsUtils/WebappsUtils","DS/WebSystem/BrowserInfos","DS/WebSystem/App","DS/WebUtils/Tracker","DS/3DPlayHelper/Tracker_Translation_Widget"],function(e,t,i,n,r,s,a,o,l,c,u,d,p,h,D,f){"use strict";var g=function(m,y){function v(e){var t=window.localStorage["3DPlay.OverrideSettings"];if(void 0!==t){console.warn("!! 3DPlay OverrideSetting variable environment Active"),console.warn("Current options :"+e.options);try{(t=JSON.parse(t))&&t.options&&(console.warn("Found options :"+t.options),e.options=c.extend(e.options,t.options,!0))}catch(e){console.error("Override failed : JSON.parse error"+e)}}return console.warn("Resulting options :"+e.options),e}l.end("Widget_3DPlay"),r.isSet("3DPlay.Debug")&&console.log("3DPlay.Debug:3DPlayWebPlayer",y);var P=function(e){return function(t){var i=window.document.getElementById("landing-page_container");i&&i.remove(),e.loaded=!0;try{var n=window.top.document.createEvent("CustomEvent");n.initCustomEvent("3DPLAYERROR",!0,!1,{helper:e}),window.top.document.dispatchEvent(n)}catch(e){}}};null!=y&&null!==y.input&&void 0!==y.input||(y.input={}),void 0!==y.options&&null!==y.options||(y.options={}),r.isSet("3DPlay.OverrideSettings")&&(y=v(y)),m.lastOptions=c.extend({},y);var S,x=y.options;void 0!==x.callbacks&&null!==x.callbacks||(x.callbacks={}),x.callbacks.eXPEriENcE={eRRoR:P(m),eXPEriENceReADy:(S=m,function(e){e&&(S.instance=e,S.loaded=!0);try{var t=window.top.document.createEvent("CustomEvent");t.initCustomEvent("3DPLAYREADY",!0,!1,{helper:S}),window.top.document.dispatchEvent(t)}catch(e){}})},x.callbacks.aSSeT={lOADinGfINIsheD:function(e){return function(t){try{var i=window.top.document.createEvent("CustomEvent");i.initCustomEvent("3DPLAYLOADINGFINISHED",!0,!1,{helper:e}),window.top.document.dispatchEvent(i)}catch(e){}}}(m)};!function(e){setTimeout(function(){e.loaded=!0},1e4)}(m);var w=y.ctx?y.ctx:y.options.ctx?y.options.ctx:a.createContext("Default");y.ctx=w,void 0!==y.options&&void 0!==y.options.callbacks&&e.addCallbacks(y.ctx,y.options.callbacks),m.inputPreProcessor=new i,m.endAllCommands=function(t){e.endAllCommands(t)},"string"==typeof y.container&&(y.container=document.getElementById(y.container)),o.add(w,"helper",m),y.options.splashscreen=y.options.splashscreen||{},m.instance=void 0,m.loaded=!1,m._check=function(){return this.isReady()?!!this.instance||(console.error("Experience is not created"),!1):(console.error("Experience is not ready"),!1)};for(var E=window;!E._swymData43DPlay&&E.parent&&E!==E.parent;)E=E.parent;if(E._swymData43DPlay&&E._swymData43DPlay[y.ctx]){var b=E._swymData43DPlay[y.ctx];window.getSwymContainer=function(){return b.container},window.widget=b.widget,delete b.widget,b.fullscreen&&(y.options.fullscreen=y.options.fullscreen||{},y.options.fullscreen.onActivate=b.fullscreen.onActivate,y.options.fullscreen.onDeactivate=b.fullscreen.onDeactivate,delete b.fullscreen),b.callback&&(y.options.callback=y.options.callback||{},y.options.callback=b.callback,delete b.callback),b.splashscreen&&(y.options.splashscreen=b.splashscreen,delete b.callback)}if(m.options=y,y.input&&"3DSwYm"===y.input.usage){delete y.input.usage;var C,I=y.container;window._swymData43DPlay=window._swymData43DPlay||{},window._swymData43DPlay[y.ctx]={widget:y.widget,container:y.container,splashscreen:y.options.splashscreen,callback:{}},delete y.options.splashscreen,delete y.container,delete y.widget;try{C=require("DS/PlatformAPI/PlatformAPI").getTenant()||(window.ds&&window.ds.swymTenant).toUpperCase()}catch(e){}var _=y.input;_.asset&&(_.asset.tenant=_.asset.tenant||C);var A=y.options.splashscreen;A&&A.custom&&(A.custom=A.custom.id);var T=y.options.fullscreen;T&&"CUSTOM"===T.mode&&(window._swymData43DPlay[y.ctx].fullscreen={onActivate:T.onActivate,onDeactivate:T.onDeactivate}),y.options&&y.options.callback&&(window._swymData43DPlay[y.ctx].callback=y.options.callback);var W=document.createElement("iframe");W.style.position="relative",W.style.width="100%",W.style.height="100%",W.style.border="0px",W.style.top="0px",W.style.left="0px",W.allowFullScreen=W.mozAllowFullScreen=W.webkitAllowFullScreen=!0,W.setAttribute("allowFullScreen","");var U,R=d.getProxifiedWebappsBaseUrl();try{(window.location.origin.indexOf("3dswym")>-1||null===R)&&(R=d.getWebappsBaseUrl())}catch(e){R=d.getWebappsBaseUrl()}W.src=R+"3DPlayHelper/3DPlaySyndication.html?params="+encodeURIComponent(JSON.stringify(y)),"string"==typeof y.container&&(I=document.getElementById(I));try{U={position:I.parentElement.style.position,visibility:I.parentElement.style.visibility,display:I.parentElement.style.display},I.parentElement.style.position="absolute",I.parentElement.style.visibility="hidden",I.parentElement.style.display="block"}catch(e){}I.appendChild(W);try{window.top.document.addEventListener("3DPLAYERROR",function(e){return function(t){U&&I&&I.parentElement&&(I.parentElement.style.position=U.position,I.parentElement.style.visibility=U.visibility,I.parentElement.style.display=U.display);var i=t.detail.helper;e.ctx===i.getCtx()&&e.options.callbacks&&e.options.callbacks.experience&&e.options.callbacks.experience.error&&e.options.callbacks.experience.error(m.getCtx())}}(y),!1),window.top.document.addEventListener("3DPLAYREADY",function(e){return function(t){U&&I&&I.parentElement&&(I.parentElement.style.position=U.position,I.parentElement.style.visibility=U.visibility);var i=t.detail.helper;e.ctx===i.getCtx()&&(m=c.extend(m,i,!0),e.options.callbacks&&(i.getExperience().addCallbacks(e.options.callbacks),e.options.callbacks.experience&&e.options.callbacks.experience.ExperienceReady&&e.options.callbacks.experience.ExperienceReady(m.getExperience())))}}(y),!1)}catch(e){}}else{var L=function(){l.createProbe("ExperienceReady").begin();var t=m.options.input.asset&&m.options.input.asset.tenant?m.options.input.asset.tenant:m.options.input.tenantID||m.options.input.tenant||y.options.tenant||y.options.tenantID;t&&(m.options.input.tenantID=t),e.createExperience(y)};if(!1===(void 0!==y.options.pad3DViewer||void 0===y.container)){if(y.options.splashscreen.custom&&"string"==typeof y.options.splashscreen.cutom)try{y.options.splashscreen.custom=window.top.getElementById(y.options.splashscreen.custom)}catch(e){}var O="autoplay"===y.options.loading;m.playerSplashScreen=new t({custom:y.options.splashscreen.custom,customBgColor:y.options.splashscreen.customBgColor,customLogoSrc:y.options.splashscreen.customLogoSrc,customAppName:y.options.splashscreen.customAppName,logoDisplay:y.options.splashscreen.logoDisplay,autoplay:O,container:y.container,callback:function(e){s.publish({event:"/"+w+"/EXPERIENCE/EXPERIENCESPLASHSCREEN",data:e})},onClick:L}),s.subscribeOnce({event:"SPLASHSCREEN"},function(){l.end("Splashscreen_Displayed"),l.end("Widget_Ready");var e=l.GetSubProbesFrom(l._parse("Widget_Ready"),!1),t=l.GetProcessedData();e.Load_3DDashboard=Math.floor(t.iframeTime),D.trackPageEvent("infos","embedder",h.getEmbeder(),p.isMobile()?1:0,e,void 0,f.widget)}),"preload"==y.options.loading&&L()}else L()}m.load=function(i){if(r.isSet("3DPlay.OverrideSettings")&&(i=v(i)),r.isSet("3DPlay.Debug")&&console.log("3DPlay.Debug:3DPlayWebPlayer.Load",i),this.instance&&(this.instance.stats&&l.cleanProbes(),this.instance.totalLoadingAssetProfiler=l.createProbe("_Load_").begin()),this.loaded){var s=!0;if(i){if(i.options=i.options||{},i.options.splashscreen=i.options.splashscreen||{},i.options.splashscreen&&i.options.splashscreen.custom&&"string"==typeof i.options.splashscreen.cutom)try{i.options.splashscreen.custom=window.top.getElementById(i.options.splashscreen.custom)}catch(e){}"onclick"===i.options.loading&&(s=!1,i.options.loading="autoplay")}var a=this,o=function(){a.playerSplashScreen&&a.playerSplashScreen.hide(),a.instance&&a.instance.clearView(),a.inputPreProcessor.run(i.input,function(t){i.input=t;var r=i.input.asset;if((!r.error||!n(r.error,w))&&(i.options||(i.options={}),i.options.newAsset=!1,a.isReady())){""===i.input.experience&&(i.input.experience=void 0),u(i.input,a.getCtx(),void 0,function(t){var n=void 0!==a.instance&&null!==a.instance?a.instance.args:a.lastOptions,r=void 0!==n.input.experience?n.input.experience.filename:"";if(i.options.newAsset=!0,t===r||r.indexOf(t)>-1||"3DPlayCollaborativeExperience"===t&&"DS/3DPlayDefaultExperience/3DPlayDefaultExperience"===r)return"string"==typeof i.input&&(i.input={asset:i.input}),i.input.experience={filename:r},void a.loadAsset(i.input,i.options);a.lastOptions.options&&a.lastOptions.options.splashscreen&&(a.lastOptions.options.splashscreen.custom=null),a.lastOptions.options.propertiesFacet&&delete a.lastOptions.options.propertiesFacet;try{a.dispose({clearSession:!0})}catch(e){console.log(e)}a.lastOptions.options&&delete a.lastOptions.options.pad3DViewer,a.loaded=!1,a.lastOptions.input=void 0,a.lastOptions.ctx=n.ctx,e.subscribe(a.lastOptions.ctx,"EXPERIENCE/ERROR",P(a));var s=c.extend(a.lastOptions,i,!0);g(a,s)},void 0,{getOnlyPath:!0})}})};if(s)o();else try{var d=this.playerSplashScreen.elements.container.parentElement;this.playerSplashScreen&&(this.playerSplashScreen.remove(),this.playerSplashScreen=null),this.playerSplashScreen=new t({custom:i.options.splashscreen.custom,customBgColor:i.options.splashscreen.customBgColor,customLogoSrc:i.options.splashscreen.customLogoSrc,customAppName:i.options.splashscreen.customAppName,logoDisplay:i.options.splashscreen.logoDisplay,container:d,containerOptions:{insertBefore:!0},onClick:o}),this.instance&&(this.instance.playerSplashScreen=this.playerSplashScreen)}catch(e){o()}}else this.options.input=i.input},m.loadAsset=function(e,t){if(r.isSet("3DPlay.Debug")&&console.log("3DPlay.Debug:3DPlayWebPlayer.loadAsset",e,t),null==e&&(t=!0),!0!==t&&!1!==t||(console.warn('3DPLAYWEB - DEPRECATED CALL - second argment is now an object for options. If you want to clear the scene graph, add to this object the property "clearSceneGraph" with the value "true"'),t={clearSceneGraph:t}),this.instance){var i=this;this.inputPreProcessor.run(e,function(e){i.instance.load(e,t),i=null})}},m.removeAsset=function(e){this._check()&&this.instance.remove(e)},m.sendEvent=function(e,t){this._check()};var M={};m.dispose=function(e){var t=window;if(t){do{t&&t._swymData43DPlay&&t._swymData43DPlay[this.getCtx()]&&delete t._swymData43DPlay[this.getCtx()],t&&(t=t.parent)}while(t&&t.parent&&t!==t.parent);if(this._check()){var i=this.getCtx();if(!i||M[i])return;M[i]=!0,this.instance.dispose(e),this.instance=null,this.loaded=void 0,this.ctx=void 0,o.removeCtx(i),delete M[i]}this.playerSplashScreen&&(this.playerSplashScreen.remove(),this.playerSplashScreen=null),this.ctx&&(this.ctx=null)}},m.informActiveState=function(e){if(this._check())return this.instance.informActiveState(e)},m.getExperience=function(){return this.instance}};return g}),
/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
define("DS/3DPlayWidget/Widget3DPlay",["DS/3DPlayWidget/W3DPlayModel","DS/3DPlayWidgetViews/W3DPlayMainView","DS/3DPlayWidgetViews/W3DPlayerView","DS/3DPlayWidget/W3DPlayPrefsCtrl","css!DS/3DPlayWidget/assets/3DPlayWidget","DS/CoreEvents/Events","DS/WebSystem/BrowserInfos","DS/WebSystem/Environment","DS/3DPlayWidget/3DPlayWidgetProxyEnopad","DS/WebUtils/Tracker"],function(e,t,i,n,r,s,a,o,l,c){"use strict";var u,d,p,h,D={},f=function(){D.wModel=new e(u),D.wModel.applicationFrameOptions=d,D.wView=new t(u,D.wModel),D.wPlayer=new i(u,D.wModel),D.wPlayer.applicationFrameOptions=d,D.wPCtrl=new n(u,D.wModel,D.wView),D._3DPlayWidgetProxyEnopad=new l(D.wModel),d&&d.widgetCB&&d.widgetCB(D),D.dispose=function(e){u.removeEvent("onRefresh",m),u.removeEvent("onLoad",f),u.removeEvent("onHide",y),u.removeEvent("onShow",v),u.removeEvent("onViewChange",P),u.removeEvent("onFocus",S),p&&(u.removeEvent("onSearch",p),p=null),h&&(u.removeEvent("onResetSearch",h),h=null),u=null,d=null,g(e)}},g=function(e){s.publish({event:"3DPLAY/PLAYFROMCOMPASS/DISABLE",data:{}}),D.wModel.dispose&&D.wModel.dispose(e),D.wModel=null,D.wView.dispose&&D.wView.dispose(e),D.wView=null,D.wPlayer.dispose&&D.wPlayer.dispose(e),D.wPlayer=null,D.wPCtrl.dispose&&D.wPCtrl.dispose(e),D.wPCtrl=null,D._3DPlayWidgetProxyEnopad.dispose(),D._3DPlayWidgetProxyEnopad=null},m=function(){D.wPlayer.widgetRefreshHandler()||(D.wView.buildCanvas(),D.wView.removeDragAndDropZone(D.wView.canvasDiv),D.wView.createBlueBackground(),D.wPlayer.instantiate3DPlayWebPlayer())},y=function(){this.fullscreen&&s.publish({event:"3DPLAY/PLAYFROMCOMPASS/DISABLE",data:{}}),a.isMobile()&&D.wModel.isLoadingFinished()&&g()},v=function(){a.isMobile()&&(D.wModel||f()),this.fullscreen&&setTimeout(function(){s.publish({event:"3DPLAY/PLAYFROMCOMPASS/ENABLE",data:{}})},500)},P=function(e){"maximized"===e.type||"fullscreen"===e.type?(console.log("fullscreen"),s.publish({event:"3DPLAY/FULLSCREEN/ENABLE",data:{}})):"windowed"!==e.type&&"minimized"!==e.type||(this.fullscreen=!1,s.publish({event:"3DPLAY/FULLSCREEN/DISABLE",data:{}}))},S=function(e){1==e?s.publish({event:"3DPLAY/WIDGETFOCUS/ENABLE",data:{}}):s.publish({event:"3DPLAY/WIDGETFOCUS/DISABLE",data:{}})};return p=function(e){D.wPlayer.search(e)},h=function(e){D.wPlayer.resetsearch(e)},function(e){u=e.widget,d=e.applicationFrameOptions,u.setMetas({helpPath:"3DPlayWidget/assets/help"}),u.addEvent("onLoad",f),u.addEvent("onRefresh",m),u.addEvent("onHide",y),u.addEvent("onShow",v),u.addEvent("onViewChange",P),u.addEvent("onFocus",S),u.fullscreen=!1,p&&u.addEvent("onSearch",p),h&&u.addEvent("onResetSearch",h)}});var id="";"undefined"!=typeof widget&&widget.id&&(id=widget.id),window["3DPlay.ProbesManager.clapDone"]=!0,window.performance.mark(id+"clap");try{window.top.performance.mark(id+"clap")}catch(e){window["3DPlay.ProbesManager.TopWindowNotAvailable"]=!0}var mark=id+"_3DPlayApp";window.performance.mark(mark);var status="";define("DS/3DPlayApp/3DPlayApp",["DS/WAfrContainer/App","DS/3DPlayWidget/Widget3DPlay","DS/WebSystem/Environment","DS/WebSystem/Settings","UWA/Promise","DS/WebUtils/ProbesManager","DS/WebUtils/Tracker","DS/3DPlaySupport/SupportList","DS/3DPlaySupport/AssetSupport","DS/WebUtils/Profiler","DS/3DPlayWidgetControllers/3DPlayWidgetProxy","DS/WebUtils/WebServices"],function(e,t,i,n,r,s,a,o,l,c,u,d){"use strict";var p=new u,h={};require(["i18n!DS/3DPlayApp/assets/nls/3DPlayApp"],function(e){h=e}),s.createProbe("Widget_Ready","WAfr_Mark_requestWAfrService_start"),s.createProbe("Unified_Widget_1","WAfr_Mark_requestWAfrService_start",mark),s.createProbe("Widget_EntryPoint",mark).end();var D=s.createProbe("Unified_Widget_2");D.begin();var f,g,m,y=!1,v=!1,P=!1,S=["3DSPACE","EV6","R2VSURVEY"];return widget.getValue("x3dPlatformId")||widget.setValue("x3dPlatformId",d.getTenant()),"OnPremise"!==widget.getValue("x3dPlatformId")&&i.set("3DPlay.Plateform.Cloud",!0),e.extend({init:function(e){m=this,this._parent(e)},onWillEnter:function(e){var t={};return e&&e.options&&t[e.options.id]?r.reject(new Error(t[e.options.id])):r.resolve()},onWillLeave:function(e){var t=!1;if(this.experience&&this.experience.acceptSwitch&&(t=this.experience.acceptSwitch(e)),t){v=!0,this.experience.publish("EXPERIENCE/TRANSITION",e),!f&&this.experience.args.input&&this.experience.args.input.asset&&g.wModel.saveSwitchAppPreferences({objectId:this.experience.args.input.asset.physicalid,objectType:this.experience.args.input.asset.dtype,rootBag:this.pad3DViewer.getRoots()});var i={timeIn3DPlay:c.stop("3DPlayAppTimer")};return c.start("3DPlayAppTimer"),a.trackPageEvent("transitions","transition-to",e?e.options.title:"",void 0,i),r.resolve()}return r.reject(new Error(h.SpecificData_NoTransition))},dispose:function(){if(status="outside",!P){P=!0;var e={disposeFrameWindow:!v,cleaarSession:!0};if(!0===y&&m.pad3DViewer){var t=m.pad3DViewer.getFrameWindow();m.experience&&(m.experience.clearView(),t.getViewer().render())}p.dispose(),g.dispose(e),this._parent(e),g=null,m.experience=null,m=null,v=!1}},setUp:function(e){D.end(),s.createProbe("Widget_3DPlay").begin(),P=!1;var i,n,r={};if(e&&(i=e.sourceApp),i){if(i.options.id===this.options.id)return e.done(),void(this.pad3DViewer=i.pad3DViewer);var o;if("outside"===status){var u=c.stop("3DPlayAppTimer");u>0&&(o={timeOustSide3DPlay:u})}a.trackPageEvent("transitions","transition-from",i.options.title,void 0,o),this.pad3DViewer=i.pad3DViewer;var d=void 0!==this.pad3DViewer;if(d){if(!i.isDisposeCalled()){var h={disposeFrameWindow:!1,appInfo:"X3DPLAW_AP"};i.dispose(h),h.preferredType&&(n=h.preferredType)}require(["DS/ApplicationFrame/CommandsManager"],function(e){e._reset()}),r={ctx:this.pad3DViewer.getCommandContext(),pad3DViewer:this.pad3DViewer,appMainDiv:i.appMainDiv};try{(f=m.pad3DViewer.getRoots())&&(f=!(!Array.isArray(f)||!f.length))}catch(e){f=!1}}}status="inside",c.start("3DPlayAppTimer"),r.callbacks={ASSET:{LOADINGFINISHED:function(e){if(f)return y=!1,void(f=!1);var t=e.loadAssetInfo;y="string"==typeof t||!(t&&S.indexOf(t.provider)>-1)}},experience:{experienceready:[function(e){m.pad3DViewer=e.pad3DViewer,m.experience=e,widget.dispatchEvent("onWidgetAndAppReady",m)}]}};var v={options:r,widgetCB:function(t){g=t,p.waitLoadEvent(function(e){g.wModel.setCurrentContent(e)}),p.waitRefreshEvent(function(){widget.dispatchEvent("onRefresh")}),m.appMainDiv=t.wModel.getCanvasDiv(),d?(e.done(),f&&g.wModel.setCurrentContentFromSwitch(m.pad3DViewer.getRoots())):e.done(m.appMainDiv)}};n?l.getExperienceID({provider:"3DSPACE",type:n},{},function(e){v.experience=e,t({widget:widget,applicationFrameOptions:v})}):t({widget:widget,applicationFrameOptions:v})}})});