define("DS/ENOXWelcomePanel/js/ENOXWelcomePanel",["UWA/Core","UWA/Class/View","DS/UIKIT/Tooltip","DS/UIKIT/Scroller","DS/UIKIT/Input/Button","DS/Handlebars/Handlebars","DS/ResizeSensor/js/ResizeSensor","text!DS/ENOXWelcomePanel/html/WelcomePanel.html","css!DS/ENOXWelcomePanel/css/WelcomePanel","css!DS/UIKIT/UIKIT.css"],function(e,t,i,n,s,l,a,o){"use strict";function c(t,i){if(""!==t.selectedItem){var n=e.extendElement(t.container).getElement("#"+t.selectedItem);e.is(n)&&n.classList.contains("selected")&&n.classList.remove("selected")}t.selectedItem=i.id,i.classList.contains("selected")||i.classList.add("selected")}function r(t){window.widget&&window.widget.log("registering listeners");var n=t._self,s=t.activities;if(t.footer&&(s=s.concat(t.footer)),e.is(s))for(var l=0;l<s.length;l++){var a=e.extendElement(n.container).getElement("#"+s[l].id);s[l].actions.forEach(function(t){var s,l,o=e.extendElement(a).getElement("#"+t.id);void 0!==t.tooltip&&null!==t.tooltip&&(t.tooltipElt=(s=o.querySelector(".activity-tooltip-element"),l=t.tooltip||t.text,new i({position:"right",target:s,body:l}))),o.addEvent("click",function(){t.isNotHighlightable||c(n,o),n.modelEvents.publish({event:"welcome-panel-action-selected",data:{id:t.id,param:n.companyId}})})})}}var d=l.compile(o);return t.extend({name:"welcome-panel-view",collapsed:!1,activities:[],selectedItem:"",className:function(){return this.getClassNames("-container")},tagName:"div",parentContainer:null,container:null,init:function(e){for(var t in e._self=this,["id","className","attributes","container","template","tagName","domEvents"].forEach(function(t){delete e[t]}),e)this[t]=e[t];this._parent(e)},setup:function(e){var t=this;t.container.setHTML(d(e)),!0===e.noborder&&t.container.classList.add("noborder"),r(e);var i=t.container.getElement(".panel-content"),s=t.container.getElement(".welcome-panel-element");new n({element:i}).inject(s,s.lastChild),t.container.inject(t.parentContainer),e.modelEvents&&(e.modelEvents.subscribe({event:"welcome-panel-toggle"},function(){t.toggle()}),e.modelEvents.subscribe({event:"welcome-panel-expand"},function(){t.show()}),e.modelEvents.subscribe({event:"welcome-panel-collapse"},function(){t.hide()}),e.modelEvents.subscribe({event:"welcome-panel-select-action"},function(e){t.selectAction(null),t.selectAction(e.id)}),e.modelEvents.subscribe({event:"welcome-panel-unselect-action"},function(){t.selectAction(null)}))},render:function(e){return this.applyViewMode(this.collapsed),this},show:function(){this.collapsed&&(this.collapsed=!1,this.applyViewMode(this.collapsed))},hide:function(){this.collapsed||(this.collapsed=!0,this.applyViewMode(this.collapsed))},toggle:function(){this.collapsed?this.show():this.hide()},attachResizeSensor:function(){var e=this;new a(e.container,function(){e.resize()})},resize:function(){this.container.offsetWidth<=40&&this.container.hasClassName("expanded")?this.applyViewMode(!0):this.container.hasClassName("collapsed")&&this.applyViewMode(!1)},applyViewMode:function(e){e?(this.container.addClassName("collapsed"),this.container.removeClassName("expanded"),this.modelEvents.publish({event:"welcome-panel-collapsed"})):(this.container.addClassName("expanded"),this.container.removeClassName("collapsed"),this.modelEvents.publish({event:"welcome-panel-expanded"}))},createNewActivitySection:function(t,i){var n=e.createElement("div",{html:d({activities:[t]})}),s=e.extendElement(this.container).getElement(".all-activity-section"),l=e.extendElement(n).getElement(".all-activity-section").getChildren();if(null==i)s.appendChild(l[0]),s.appendChild(l[1]),this.activities.push(t);else{var a=s.getElements(".activity-section")[i];s.insertBefore(l[0],a),s.insertBefore(l[1],a),this.activities.splice(i,0,t)}r({_self:this,activities:[t]})},createNewAction:function(t,i,n){var s={_self:this,activities:[{id:t,actions:[i]}]},l=e.createElement("div",{html:d(s)}),a=e.extendElement(this.container).getElement("#"+t),o=e.extendElement(l).getElement("#"+t).getChildren()[0],c=this._getIndexOfActivityFromId(t);if(null==n)a.appendChild(o),this.activities[c].actions.push(i);else{var v=a.getElements(".activity-btn")[n];a.insertBefore(o,v),this.activities[c].actions.splice(n,0,i)}r(s)},removeActivitySection:function(e){var t=this._getIndexOfActivityFromId(e);if(void 0!==t){for(var i=0;i<this.activities[t].actions.length;i++)void 0!==this.activities[t].actions[i].tooltipElt&&this.activities[t].actions[i].tooltipElt.destroy();this.activities.splice(t,1);var n=this.container.querySelector(".activity-section#"+e);if(null!==n){var s=n.nextElementSibling;n.parentElement.removeChild(n),s.parentElement.removeChild(s)}}},removeAction:function(e){var t=this,i=function(){for(var i=0;i<t.activities.length;i++)for(var n=0;n<t.activities[i].actions.length;n++)if(t.activities[i].actions[n].id===e)return{activity:i,action:n}}();if(void 0!==i.action){void 0!==t.activities[i.activity].actions[i.action].tooltipElt&&t.activities[i.activity].actions[i.action].tooltipElt.destroy(),t.activities[i.activity].actions.splice(i.action,1);var n=t.container.querySelector(".activity-btn#"+e);null!==n&&n.parentElement.removeChild(n)}},selectAction:function(e){var t=this.container.getElement(".activity-btn.selected");null!==t&&t.removeClassName("selected"),null!=e&&(this.container.getElement(".activity-btn#"+e).addClassName("selected"),this.selectedItem=e)},_getIndexOfActivityFromId:function(e){var t=this;return function(){for(var i=0;i<t.activities.length;i++)if(t.activities[i].id===e)return i}()}})});