/*!  Copyright 2016 Dassault Systemes. All rights reserved. */
define("DS/GEOMineSchedExperience/GEOMineSchedTablerSelectionManager",["UWA/Core","UWA/Event","DS/Core/Core","DS/Core/Events","DS/Selection/XSO","DS/Utilities/Object"],function(e,i,n,r,a,o){"use strict";var s=a.singleton({init:function(e){e={eventChannel:"GEOMineSchedTablerSelection/",areEquals:function(e,i){e._uxid,i._uxid}},this._parent(e)}});return e.namespace("WUX/Selection/GEOMineSchedTablerSelectionManager",s)}),define("DS/GEOMineSchedExperience/GEOMineSchedPlayerHelper",["UWA/Core","UWA/Class","UWA/Element","DS/ApplicationFrame/PlayerElements","DS/ApplicationFrame/AfrPlayerService"],function(e,i,n,r,a){"use strict";return i.singleton({init:function(e){var i=".wux-controls-playerview {background:rgba(0, 0, 0, 0);} /*.playerBorder .wux-controls-player-button { background: green; position:relative; }.wux-controls-player-button:after { content:attr(data-name);position:absolute; top:0;left:0;}.playerBorder .wux-controls-player-button[data-name=hamburger] { background: yellow; }*/",n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",r.styleSheet?r.styleSheet.cssText=i:r.appendChild(document.createTextNode(i)),n.appendChild(r)},isVisible:function(e){var i=e.getContent().getStyle("display"),n=e.getContent().getStyle("visibility");return"none"!==i&&"hidden"!==n},getCallbacks:function(e){var i={},n=void 0,r=(a.actions.PLAY,a.actions.PAUSE,a.actions.BACK,a.actions.NEXT,a.actions.BACKWARD,a.actions.FORWARD,a.actions.FIRST,a.actions.LAST,a.actions.STOP,a.actions.PLAYREVERSE,a.actions.SLIDER_CHANGE,a.actions.EDITOR_CHANGE,a.actions.LOOPRC,a.actions.LOOPRCBF,a.actions.LOOPRO,a.actions.PLAYLIST,a.actions.OPTIONS,a.actions.EXIT,function(i){e[i.event]=i,i.data.source.geoCurrentPeriod||(i.data.source.geoCurrentPeriod=0),i.data.source.geoCurrentSpeed||(i.data.source.geoCurrentSpeed=1);var n=e.FrameWindow.getRootNode().getChildByName("scene").getChildByName("Result3dNode"),r=n.msaResult3d.periods.length,a=1/(r-1);return{INTERVAL_TIME:1e3/i.data.source.geoCurrentSpeed,STEP:a,periodsSize:r,result3dNode:n}});return i[a.actions.PLAY]=function(i){0===a._state.progress&&(a._state.state="play");var o=r(i);void 0!==n&&window.clearInterval(n),n=setInterval(function(){var r=i.data.source.geoCurrentPeriod,s=document.getElementById("MSperiod"+r);if(s&&(s.style.backgroundColor="#A2CADF",s.style.color="black"),r>=o.periodsSize-1){i.data.source.geoCurrentPeriod=0;var d=0;window.clearInterval(n),a.setState({state:"pause",progress:d})}else{i.data.source.geoCurrentPeriod=i.data.source.geoCurrentPeriod+1;d=i.data.source.geoCurrentPeriod*o.STEP;a.setState({state:"play",progress:d})}o.result3dNode&&o.result3dNode.msaResult3d&&o.result3dNode.msaResult3d.applyPeriod(i.data.source.geoCurrentPeriod),e.FrameWindow.getViewer().render()},o.INTERVAL_TIME)},i[a.actions.PAUSE]=function(e){var i=r(e),o=e.data.source.geoCurrentPeriod;void 0!==n&&window.clearInterval(n),a.setState({state:"pause",progress:o*i.STEP})},i[a.actions.STOP]=function(e){r(e);void 0!==n&&window.clearInterval(n),a.setState({state:"pause",progress:0}),e.data.source.geoCurrentPeriod=0},i[a.actions.EXIT]=function(e){a._playerView,r(e);void 0!==n&&window.clearInterval(n),e.data.source.geoCurrentPeriod=0},i[a.actions.SLIDER_CHANGE]=function(i){var n=r(i),o=a.getState().state,s=i.data.source.geoCurrentPeriod,d=i.data.value*(n.periodsSize-1),t=Math.round(d);if(i.data.source.geoCurrentPeriod=t,i.data.source.geoCurrentPeriod!==s&&(n.result3dNode&&n.result3dNode.msaResult3d&&n.result3dNode.msaResult3d.applyPeriod(i.data.source.geoCurrentPeriod),e.FrameWindow.getViewer().render()),Math.abs(t-d)>.01*(n.periodsSize-1)){var c=i.data.source.geoCurrentPeriod*n.STEP;a.setState({state:o,progress:c})}var l=document.getElementById("MSperiod"+s);l&&(l.style.color="black",l.style.backgroundColor="#A2CADF");var m=document.getElementById("MSperiod"+t);m&&(m.style.backgroundColor="#368EC4",m.style.color="white")},i},createPlayerContainer:function(i){e.debug=!0;var r=new n("div",{id:"player",debug:!0});r.inject(i);var o=new n("div",{id:"borderPlayer",class:"playerBorder",styles:{width:"100%"}});return r.playerViewport=o,o.insertPlayer=function(e){e.inject(o),r.playerView=e},o.removePlayer=function(e){var n={data:{source:e}},a=e._callbacks;n.data.value=0,a.stop(n),e.remove(),i.removeChild(r)},o.inject(r),a.registerPlayerContainer(o),r}})}),define("GEOMineSchedExperience/GEOMineSchedExperience",["DS/GEOMineSchedExperience/GEOMineSchedExperience"],function(e){"use strict";return console.error("This module is deprecated. use DS/GEOMineSchedExperience/GEOMineSchedExperience instead of GEOMineSchedExperience/GEOMineSchedExperience"),console.error("This module is deprecated. use DS/GEOMineSchedExperience/GEOMineSchedExperience instead of GEOMineSchedExperience/GEOMineSchedExperience"),console.error("This module is deprecated. use DS/GEOMineSchedExperience/GEOMineSchedExperience instead of GEOMineSchedExperience/GEOMineSchedExperience"),e}),define("DS/GEOMineSchedExperience/GEOMineSchedExperience",["DS/3DPlayExperienceModule/PlayExperience3D","UWA/Core","DS/ApplicationFrame/FrameWindow3D","DS/GEOMineSchedExperience/GEOMineSchedPlayerHelper","DS/ApplicationFrame/PlayerStyle","DS/ApplicationFrame/AfrPlayerService","DS/ApplicationFrame/CommandsManager","DS/ApplicationFrame/Json2Html","DS/Controls/SpinBox"],function(e,i,n,r,a,o,s,d,t){"use strict";var c=e.extend({init:function(e){(e=e||{}).FrameWindow=n,""===e.input.asset.filename&&(e.input.asset.filename=e.input.asset.serverurl);this._parent(e);var r={workbenchs:[{name:"GEOMineSchedExperienceWkb",module:"GEOMineSchedExperience"}],swapVisible:!0,selection:!0,preSelection:!0,visu:{antiAliasing:!0,useShadowMap:!0,infinitePlane:!0,displayGrid:!1,displayLines:!1,debugShadowLight:!1,debugBSphere:!1,debugBBox:!1,control:"COMBINED",picking:!0,displayPicking:!0,prePicking:!0,displayprePicking:!0,autoUpdatePlane:!0,useMirror:!0,defaultAnimationLoop:!1},ui:{displayTree:!1,displayActionBar:!0}};this.args=i.extend(e,r,!0);var a=this.onModelLoadingCompleted;this.onModelLoadingCompleted=function(e){a(e);var i=s.getCommands("Default").GEOMSAnimateCmdHdr;i.beginExecute(),i.execute(),i.endExecute()},this.args.options.callbacks&&this.args.options.callbacks.ui&&(this.onDefaultDDActivation=this.args.options.callbacks.ui.DefaultActivationFinished),this.appSingleton=null},onPreCreate:function(){this.args&&(this.args.visu={showReferenceAxisSystem:!0}),this.mabModel={speeddial:[{id:"AnnotationCommands",rsc:"3DPlay/3DPlayExperience3D"},{id:"Reframe",rsc:"3DPlay/3DPlayExperience3D"}],sections:[{id:"ViewSelector",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",hideAB:!0,showBack:!0},{id:"VisibilityCommands",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D"},{id:"EnhancedExplode",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",hideAB:!0,showBack:!0},{id:"measure2CmdHdr",nls:"DMUBaseCommands/3DPlayPro",rsc:"DMUBaseCommands/3DPlayPro",hideAB:!0},{id:"section2CmdHdr",nls:"DMUBaseCommands/3DPlayPro",rsc:"DMUBaseCommands/3DPlayPro"},{id:"AnnotationTour",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",hideAB:!0,showBack:!0},{id:"Render",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",flyout:[{id:"VisuShading",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingEdgesNoSmoothEdges",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingEdgesHiddenEdges",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingMaterialEdges",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingMaterial",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingIllustration",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuNoShadingEdges",rsc:"ViewerCommands/ViewerCommands"}]},{id:"Ambiance",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",flyout:[{id:"VisuNoEnv",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuV6Env",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuCleanSpaceEnv",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuDarkBlueEnv",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuDarkGreyEnv",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShinyEnv",rsc:"ViewerCommands/ViewerCommands"}]},{id:"HideShowFilter",nls:"GEOHideShowFilterCmd/GEOHideShowFilterWkb",rsc:"GEOHideShowFilterCmd/GEOHideShowFilterCmd"},{id:"GEOMSAnimateCmdHdr",nls:"GEOMSCommands/GEOMSCommands",rsc:"GEOMSCommands/GEOMSCommands"},{id:"GEOMSDisplayActivitiesCmdHdr",nls:"GEOMSCommands/GEOMSCommands",rsc:"GEOMSCommands/GEOMSCommands"},{id:"GEOMSHideActivitiesCmdHdr",nls:"GEOMSCommands/GEOMSCommands",rsc:"GEOMSCommands/GEOMSCommands"},{id:"GEOMSDisplayStockpilesCmdHdr",nls:"GEOMSCommands/GEOMSCommands",rsc:"GEOMSCommands/GEOMSCommands"},{id:"GEOMSHideStockpilesCmdHdr",nls:"GEOMSCommands/GEOMSCommands",rsc:"GEOMSCommands/GEOMSCommands"},{id:"GEOMSAddProductionCmdHdr",nls:"GEOMSCommands/GEOMSCommands",rsc:"GEOMSCommands/GEOMSCommands"},{id:"GEOMSRemoveProductionCmdHdr",nls:"GEOMSCommands/GEOMSCommands",rsc:"GEOMSCommands/GEOMSCommands"},{id:"GEOMSSingleProductionCmdHdr",nls:"GEOMSCommands/GEOMSCommands",rsc:"GEOMSCommands/GEOMSCommands"},{id:"GEOMSHideProductionCmdHdr",nls:"GEOMSCommands/GEOMSCommands",rsc:"GEOMSCommands/GEOMSCommands"},{id:"GEOMSRestoreParamCmdHdr",nls:"GEOMSCommands/GEOMSCommands",rsc:"GEOMSCommands/GEOMSCommands"}]}},onPostCreate:function(){var e=this.frmWindow;this.immersiveFrame=e.getImmersiveFrame(),this.frmWindow.getViewer().setGrid(!1)}});return i.namespace("DS/GEOMineSchedExperience/GEOMineSchedExperience",c)});