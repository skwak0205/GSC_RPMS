define("DS/EV53DPlay/enoviav5",["UWA/Core","UWA/Class"],function(e,t){"use strict";return t.singleton({init:function(){},getWebServicesPath:function(){return"/resources/fedSearchV5"},getActionsPath:function(e){return getWebServicesPath()+"/actions"},get3DPlayProvider:function(e){return"EV5"}})}),define("DS/EV53DPlay/OxMQLV5Loader",["DS/WAFData/WAFData","DS/EV53DPlay/enoviav5"],function(e,t){"use strict";return function(n,o){var i=null,r=void 0!==o?o:null,a=null,l=null,s=null,u=null,c=null,d=null;function v(){a=null,l=null,s=null,u=null,i=null}function f(e,t,n){u&&u({rsc:"EV53DPlay/EV53DPlay_errors",type:e,level:void 0!==t?t:"warning",abort:void 0===n||n})}function g(){return c+t.getWebServicesPath()+"/SOPRequest/"}this.load=function(n,o,D,p,h,P){i={value:!1},a=o,s=D,l=function(){v(),p&&p()},u=h,d=n.physicalid,c=n.serverurl,console.log("Selected Object uuid: "+d),console.log("Selected Object Type: "+n.dtype),console.log("enoviav5 service URL: "+c),n.provider!==t.get3DPlayProvider()&&console.error("got a data for another provider "+n.provider+" (can only treat EV5 one)");var L=!1;L||(console.log(" ping V5"),function(){var t=g()+"Ping";console.log("ping url="+t);var n=[];n.method="GET",n.type="xml",n.async=!1,n.timeout=500,n.onComplete=function(e){console.log("pingV5 succeeded ",e)},n.onFailure=function(e){console.error(t+" has failed.!!  "+e)},n.onTimeout=function(e){console.error(t+" TimeOut.!!  "+e)},e.authenticatedRequest(t,n)}(),L=!0),function(){var n=g()+"Light3DEXPNavigation";console.log("url="+n);var o='<?xml version="1.0" encoding="UTF-8" ?><InputData Release = "419"><V53DEXPNavigation><NAVIGATION NAME="Expand3DPLAY" DEPTH="ALL"></NAVIGATION><UUIDList><UUID VALUE="'+d+'"/></UUIDList></V53DEXPNavigation></InputData>',i=[];i.method="POST",i.data=o,i.type="xml",i.headers={Accept:"text/xml","Content-Type":"text/xml"},i.onComplete=function(e){!function(e){var n=(new DOMParser).parseFromString(e,"text/xml");if(n instanceof XMLDocument){var o=n.firstChild;if("OutputData"===o.nodeName)if(1===o.childNodes.length&&"ListOfNodes"===o.childNodes[0].nodeName){var i=o.childNodes[0],d=i.attributes.length;require(["DS/Visualization/ModelLoader","DS/Visualization/Node3D","DS/Visualization/ThreeJS_DS"],function(e,n,o){var v=new e;v.setRenderCallback(r),v.setOnLoadedCallback(l),v.setOnProgressCallback(s),v.setOnErrorCallback(u);for(var g=0;g<d;g++)if("Data"===i.attributes[g].name){var D=i.attributes[g].value,p=JSON.parse(D),h=p.List.length;if(console.log("Total CGR Models: "+h),0!=h)for(var P="",L=[],S=0;S<h;S++){p.List[S]["ds6w:title"],P=p.List[S].LOC,(L=p.List[S].POS)[9]*=1e3,L[10]*=1e3,L[11]*=1e3;var E=new o.Matrix4(L[0],L[3],L[6],L[9],L[1],L[4],L[7],L[10],L[2],L[5],L[8],L[11],0,0,0,1),O=new n("Document CGR");O.productType="Reference3D",O.setMatrix(E),P=P.replace("_","/");var m=c+t.getWebServicesPath()+"/LightVault/"+P,N={provider:"FILE",filename:m,serverurl:"",format:"cgr",requestsOptions:{authentication:"passport"}};v.loadModel(N,O),s&&s({loaded:h-S,total:h}),a&&a(O)}else console.warn("No CGR Model Available In Selected Object"),f("NO_GEOMETRY","info","true"),l()}},function(e){var t=e.requireModules&&e.requireModules[0];console.error("Module "+t+" is missing.")})}else console.warn("No CGR Model Available In Selected Object"),f("NO_GEOMETRY","info","true"),l();else console.warn("Invalid XML Received From Light3DEXPNavigation"),l()}else console.warn("Light3DEXPNavigation Response Not Contains Any XML Data"),l()}((new XMLSerializer).serializeToString(e))},i.onFailure=function(e){console.error(n+" Query is failed.!!"),f("SERVIVE","error","true")},e.authenticatedRequest(n,i)}()},this.abort=function(){null!==i&&(i.value=!0,v())}}});