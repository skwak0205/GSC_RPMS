define("DS/ReqProperties/facets/RichAttribute/RichContentController",["UWA/Core","DS/PADUtils/PADContext","DS/TraceableRequirementsUtils/Services/RequirementWebServices","DS/RichView/RichContentEditor","DS/CKEditor/CKEditor","UWA/Class","UWA/Controls/Abstract","DS/TraceableRequirementsUtils/Utils","i18n!DS/ReqProperties/assets/nls/ReqProperties","css!DS/ReqProperties/ReqProperties.css"],function(e,t,n,i,s,a,r,o,c){"use strict";var l=null,d=require("DS/EditPropWidget/facets/Common/FacetsBase");require("DS/EditPropWidget/constants/EditPropConstants");return a.extend(r,d,{init:function(n){l=this,t.set(this),this._parent.apply(this,arguments),this.elements.container||(this.elements.container=e.createElement("div",{styles:{height:"100%","overflow-y":"scroll"},class:"proxy_container"}),this.elements.myControl=new e.Element("label",{html:"<h4>"+c.rich_attr_head+"</h4>",styles:{margin:"10px"}}),this.elements.firstLevel=e.createElement("div",{styles:{height:"100%"},class:"content-data",id:"mainContainer"}),this.elements.myControl.inject(this.elements.container),this.elements.firstLevel.inject(this.elements.container)),console.log("Printing from Rich View Controller"),l=this},onError:function(e){console.log(e)},updateFacet:function(){var e=this;document.getElementById("mainContainer").innerHTML="";var t=this.getModel();t&&(e.objectId=t._attributes.objectId),o.app_initialization(function(){console.log("Hello from utils AppInit")}),e.objectId&&n.getRichContentWithStreaming({id:e.objectId,onComplete:function(t){var n,s,a,r=0;e.options.data=e.objectId,JSON.parse(t).forEach(function(t){for(var i in t)if("csrf"==i&&(e.csrf=t.csrf),"csrf"!=i){for(var o=0;o<t.length;o++)n=t[o].Value,s=t[o].Name,a=t[o].displayName,r++,e._buildView(n,s,r,a);break}}),e._objectRichEditor=new i({selector:".rich-object",target:".content-data",richView:e}),e._objectRichEditor.startEditionForAll(),e._objectRichEditor.defaultEditorOptions.data={objectId:e.objectId,csrf:e.csrf,Property:".PropertyTab"};for(var o=1;o<=r;o++){var c=CKEDITOR.instances["editor"+o];void 0!==c&&c.destroy(),CKEDITOR.inline("editor"+o,e._objectRichEditor.defaultEditorOptions)}},onFailure:function(e,t){this.mediator.publish("onNotification",{className:"error",message:RichViewNls.RichView_Notif_FatalError})}})},_buildView:function(t,n,i,s){l.elements.attrHead=e.createElement("div",{class:"rich-object  right-border",physicalid:l.objectId}),l.elements.headingMainDiv=e.createElement("div",{class:"rich-object-header"}),l.elements.attrHead.inject(l.elements.firstLevel),l.elements.spanHead=e.createElement("span"),e.createElement("div",{class:"rich-object-title-editable",Title:n,html:s}).inject(l.elements.spanHead),l.elements.spanHead.inject(l.elements.headingMainDiv),l.elements.headingMainDiv.inject(l.elements.attrHead),l.elements.contentDataDiv=e.createElement("div",{class:"rich-object-body"}),l.elements.bar=e.createElement("div",{class:"rich-object-info"}),l.elements.bar.inject(l.elements.contentDataDiv),l.elements.contentContainer=e.createElement("div",{id:"richcontentid",class:"rich-object-content"}),e.createElement("textarea",{html:t,styles:{width:"50%",display:"block"},id:"editor"+i}).inject(l.elements.contentContainer),l.elements.contentContainer.inject(l.elements.contentDataDiv),l.elements.contentDataDiv.inject(l.elements.attrHead)},destroyComponent:function(){e.is(this.destroy,"function")&&this.destroy()}})}),define("DS/ReqProperties/facets/ReqDoc/ReqDocFacet",["UWA/Core","UWA/Controls/Abstract","UWA/Class","DS/EditPropWidget/facets/Common/FacetsBase","DS/ENOXAttachmentsUX/AttachmentsPane","DS/TraceableRequirementsUtils/Utils"],function(e,t,n,i,s,a){"use strict";return n.extend(t,i,{_docList:null,init:function(e){this._parent(e),this._initUI()},_initUI:function(){this.elements.container=e.createElement("div",{class:"relatedDocumentsv2"}),this.attachmentsPane=null},updateFacet:function(){var e=this,t=function(t){if(t)if(null===e.attachmentsPane)a.app_initialization(function(){var n=a.getTenantIndex();null==n&&(n=0);var i={parentObject:{parentId:t},connectorOptions:{fetchSecurityContext:function(){return a.getSecurityContextForProperties()},platformUrls:a.getPlatformServices()[n]}};e.attachmentsPane=new s(i),e.attachmentsPane.inject(e.elements.container)});else{if(!t)return;const n={parentId:t};e.attachmentsPane&&(e.attachmentsPane.show(),e.attachmentsPane.options.parentObject.parentId!==t&&e.attachmentsPane.setParentObject(n))}},n=this.getModel();n.isMergedModel()?t():"relationship"===n.get("metatype")?this.getOccurrence().addEventOnce("onChange:properties",function(){var n=e.getModel();t(n.get("objectId"))}):t(n.get("objectId"))},onRefresh:function(){this.updateFacet()}})});