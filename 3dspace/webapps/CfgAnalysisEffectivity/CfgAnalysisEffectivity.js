define("DS/CfgAnalysisEffectivity/scripts/CfgAnalysisUtility",["DS/CfgTracker/CfgTracker","DS/CfgTracker/CfgDimension","DS/CfgTracker/CfgValue","UWA/Drivers/Alone","DS/Core/Core","i18n!DS/CfgEvolutionUX/assets/nls/CfgEvolutionUX","DS/CfgBaseUX/scripts/CfgData","DS/CfgBaseUX/scripts/CfgContainerView","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgBaseUX/scripts/CfgXMLServices","DS/CfgVariantEffectivityEditor/scripts/CfgVariantEffectivityController","DS/CfgBaseUX/scripts/CfgFeatureOptionsView","DS/CfgEvolutionUX/CfgModelSelection","DS/Controls/Toggle","DS/UIKIT/Spinner","i18n!DS/CfgAnalysisEffectivity/assets/nls/CfgSelectByConfigurationCriteriaDialog"],function(e,t,i,n,o,a,s,r,l,c,d,u,p,C,f,g){"use strict";return{onApplyWhereUsed:function(e){return new Promise(function(t,i){if(0==e.selection.length||0==e.instances.length)t();else{var n={version:"1.0","detailedResults ":"yes",expressionView:"Current",operator:e.operator,instances:e.instances,selections:e.selection};n=JSON.stringify(n);l.makeWSCall("/resources/modeler/configuration/expressionServices/whereUsed","POST","enovia","application/json",n,function(e){t(e)},function(e){l.showwarning(g.OWU_Webservice_fail,"error"),i()},!0)}})},sendAPITracker:n=>{e.createEventBuilder({category:e.Category.USAGE,action:e.Events.CLICK,tenant:n.tenant}).setLabel(e.Labels.CONFIGURATION_ANALYSIS).setAppId(n.widget.id||"NO_APP_ID").addDimension(t.CONFIGURATION_ANALYSIS.CONFIGURATION_ANALYSIS_WIDGET,n.widget.name).addDimension(t.CONFIGURATION_ANALYSIS.CONFIGURATION_ANALYSIS_TYPE,void 0===n.analysis.type?"Common":n.analysis.type).addDimension(t.CONFIGURATION_ANALYSIS.CONFIGURATION_ANALYSIS_OPERATOR,void 0===n.analysis.operator?"AND":n.analysis.operator).addPersonalValue(i.CONFIGURATION_ANALYSIS.CONFIGURATION_ANALYSIS_NO_OF_VALUE_SELECTED,n.analysis.value_selected).addPersonalValue(i.CONFIGURATION_ANALYSIS.CONFIGURATION_ANALYSIS_NO_OF_VARIANT_AVAILABLE,n.analysis.variant_available).addPersonalValue(i.CONFIGURATION_ANALYSIS.CONFIGURATION_ANALYSIS_NO_OF_MODEL,n.analysis.model).send()},onApplyCommon:function(e){return new Promise(function(t,i){if(0==e.selectedOptionsPIDs.length||0==e.instances.length)t();else{var n={version:"1.0",modelPID:e.modelPID,occurrences:e.occurrences,criteriaPIDs:e.selectedOptionsPIDs};n=JSON.stringify(n);l.makeWSCall("/resources/modeler/configuration/expressionServices/commonOccurrencesFromCriterias","POST","enovia","application/json",n,function(e){t(e)},function(e){l.showwarning(g.Common_Webservice_fail,"error"),i()},!0)}})},onApplySpecific:function(e){return new Promise(function(t,i){if(0==e.selectedOptionsPIDs.length||0==e.instances.length)t();else{var n={version:"1.0",modelPID:e.modelPID,occurrences:e.occurrences,criteriaPIDs:e.selectedOptionsPIDs};n=JSON.stringify(n);l.makeWSCall("/resources/modeler/configuration/expressionServices/specificOccurrencesFromCriterias","POST","enovia","application/json",n,function(e){t(e)},function(e){l.showwarning(g.Specific_Webservice_fail,"error"),i()},!0)}})}}}),define("DS/CfgAnalysisEffectivity/scripts/CfgSelectByConfigurationCriteriaDialog",["DS/Core/Core","DS/CfgBaseUX/scripts/CfgController","DS/CfgBaseUX/scripts/CfgData","DS/CfgBaseUX/scripts/CfgContainerView","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgAnalysisEffectivity/scripts/CfgAnalysisUtility","DS/CfgVariantEffectivityEditor/scripts/CfgVariantEffectivityController","DS/CfgBaseUX/scripts/CfgColumnManager","DS/CfgBaseUX/scripts/CfgUserSettings","DS/CfgBaseUX/scripts/CfgFeatureOptionsView","DS/CfgEvolutionUX/CfgModelSelection","DS/Controls/Toggle","DS/Controls/TooltipModel","DS/Controls/ButtonGroup","DS/UIKIT/Spinner","i18n!DS/CfgAnalysisEffectivity/assets/nls/CfgSelectByConfigurationCriteriaDialog","text!DS/CfgBaseUX/assets/CfgUXEnvVariables.json"],function(e,t,i,n,o,a,s,r,l,c,d,u,p,C,f,g,m){"use strict";var h={create:function(e){i.clear(),i.configurationAnalysisMode="",this.options=e;var t=this;this.flagToShowWarningOnce=!1,h.selections=[],this.MainContainer=new UWA.Element("div",{class:"selectByConfigCriteriaMainContainer"}),this.MainContainer.addEvent("resize",function(){let e=!1;(null==t.options.displayCompactMode||!1===t.options.displayCompactMode)&&t.MainContainer.getDimensions().width<590?e=!0:1==t.options.displayCompactMode&&t.MainContainer.getDimensions().width<485&&(e=!0),e?(t.controls.addClassName("controlsDivResize"),t.variantsAndOptionsContainer.addClassName("variantsAndOptionsContainerResize")):(t.controls.removeClassName("controlsDivResize"),t.variantsAndOptionsContainer.removeClassName("variantsAndOptionsContainerResize"))}),l.retrieveUserSettings();var o;o={isHeader:!1,isFooter:!0,firstButtonText:g.CFG_Apply,secondButtonText:g.CFG_Close,onButtonClickCB:function(e){if("firstButton"==e.buttonId){null==h.containerView._firstButton.getAttribute("disabled")&&i.ModelEvents.publish({event:"SelectByConfigCriteriaApply",data:{selection:h.selections,modelPID:t.currentSelectedModelId.model.valueItem,operation:t.radioButtonGroup.value[0],operator:t.andConditionCheckFlag?"AND":"OR"}});let e="NA";"whereUsed"==t.radioButtonGroup.value[0]&&(e=t.andConditionCheckFlag?"AND":"OR"),a.sendAPITracker({tenant:widget.data.x3dPlatformId,widget:{id:widget.data.appId,name:widget.data.title||widget.options.title},analysis:{type:t.radioButtonGroup.value[0],operator:e,value_selected:h.selections.length,variant_available:t.featureOptionsView.featureOptionGridView.treeDocument.getRoots().length,model:t.modelSelectionComponent.options.Data.length}})}else"secondButton"==e.buttonId&&(i.configurationAnalysisMode="",i.ModelEvents.publish({event:"SelectByConfigCriteriaDlgClosed"}),t.containerView.destroy())},firstBtnAllowMultiClicks:!0},this.containerView=new n(o).render(),this.containerView._body.addClassName("selectByConfigCriteriaContainerViewBody"),this.containerView.inject(this.options.parent),this.MainContainer.inject(this.containerView._body),this.containerView._firstButton.setAttributeNode(document.createAttribute("disabled")),t.controls=new UWA.Element("div",{class:"selectByConfigCriteriaControlsDiv"}).inject(this.MainContainer),t.modelSelectionDiv=new UWA.Element("div",{class:"selectByConfigCriteriaModelSelectionDiv"}).inject(this.controls),t.radioButtonsInfoDiv=new UWA.Element("div",{class:"selectByConfigCriteriaRadioButtonsInfoDiv"}).inject(this.controls),t.radioButtonsDiv=new UWA.Element("div",{class:"selectByConfigCriteriaRadioButtonsDiv"}).inject(t.radioButtonsInfoDiv),t.radioButtonGroup=new C({type:"radio",touchMode:null==this.options.displayCompactMode||!1===this.options.displayCompactMode}),t.radioButtonGroup.addChild(new u({type:"radio",label:g.CFG_Label_Common,value:"common",checkFlag:!0})),t.radioButtonGroup.addChild(new u({type:"radio",label:g.CFG_Label_Specific,value:"specific"})),t.radioButtonGroup.addChild(new u({type:"radio",label:g.CFG_Label_WhereUsed,value:"whereUsed"})),t.radioButtonGroup.inject(t.radioButtonsDiv),t.radioButtonGroup.addEventListener("change",function(e){i.configurationAnalysisMode=e.dsModel.value[0],t.showORHideAndCondition(e.dsModel.value[0]),"specific"==i.configurationAnalysisMode&&(t.selections=[],t.flagToShowWarningOnce=!0),t.featureOptionsView.featureOptionGridView.treeDocument.getRoots().forEach(e=>{if("specific"==i.configurationAnalysisMode){let t=0;e.getChildren().forEach(e=>{1==e.options.grid.checkbx&&1==++t&&h.selections.push({optionID:e.options.data.self.physicalID}),1!=t&&e.updateOptions({grid:{checkbx:!1}})})}e.updateOptions({grid:{name:e.options.grid.name,type:e.options.grid.type,description:e.options.grid.description}})}),h.checkMaxSelection()}),t.spinner=new f({className:"selectByConfigCriteriaSpinner"}).inject(t.MainContainer),t.spinner.spin(),t.spinner.show(),t.modelSelectorLabel=new UWA.Element("div",{html:g.Model_Label,styles:{"margin-right":"10px"}}).inject(t.modelSelectionDiv);var s={};s.Data=this.options.modelList,s.currentindex=0,s.parentElement=t.modelSelectionDiv,t.modelSelectionComponent=new d(s),t.modelSelectionComponent.render(),null==this.options.displayCompactMode||!1===this.options.displayCompactMode?(this.options.modelList.length>1&&(t.modelSelectionComponent.combobox.touchMode=!0),t.controls.setAttributeNode(document.createAttribute("touch-mode")),this.containerView._body.setAttributeNode(document.createAttribute("touch-mode"))):(this.options.modelList.length>1&&(t.modelSelectionComponent.combobox.touchMode=!1),t.controls.removeAttribute("touch-mode"),this.containerView._body.removeAttribute("touch-mode"));var r={model:this.options.modelList[0]};return this.renderDialog(r),i.ModelEvents.subscribe({event:"modelUpdated"},function(e){t.getOptionDetailsforModelChange(e)}),this},getOptionDetailsforModelChange:function(e){this.spinner.show(),h.selections=[],this.handleApply(),this.MainContainer.getElement(".selectByConfigCriteriaToolbar").destroy(),this.MainContainer.getElement(".variantsAndOptionsContainer").destroy(),this.renderDialog(e)},updateDetailsforManagePropertiesChange:function(){this.featureOptionsView.updateColumnsFromSettings(),this.featureOptionsView.featureOptionGridView.inject(this.variantsAndOptionsContainer)},getFilterablesVariantGrid:function(e,t){for(var n=this,a=[],s=e.model.valueItem,r=0;r<t.length;r++)a.push({instancePID:t[r].physicalID});return new Promise(function(t,r){var l={version:"1.0",mode:"Display",modelPID:s,withBinaries:"NO",instances:a,modelMask:"",featureMask:"Read",optionMask:"Read"},c=JSON.stringify(l);o.makeWSCall("/resources/modeler/configuration/navigationServices/getFilterablesVariantGrid","POST","enovia","application/json",c,function(o){var a={features:o,name:e.model.name[0],displayValue:e.model.labelItem[0]};i.addDictionaryByCriteria(e.model.valueItem,a,"features"),n.renderDialog(e),t(o)},function(e){r(e)},!0)})},showColumnManager:function(e){var t=document.querySelector(".selectByConfigCriteriaContainerViewBody"),i={type:"VariantsAndOptionGroups",viewId:e.viewId,parent:t,onCloseCallback:h.onColumnManagerComplete,touchMode:!1};r.create(i)},onToolbarClickCallback:function(e){if("ID_USERSETTINGS"==e._event){var t={};t.viewId=e.viewId,h.showColumnManager(t)}},onColumnManagerComplete:function(e){var t=document.querySelector(".selectByConfigCriteriaContainerViewBody");null!=t.children[t.children.length-1]&&t.children[t.children.length-1].destroy(),h.updateDetailsforManagePropertiesChange()},renderDialog:function(e){var t=this;h.currentSelectedModelId=e;var n=t.options.childInstances,o=i.getDictionaryByCriteria(e.model.valueItem,"features");if(null==o.features)this.getFilterablesVariantGrid(e,n);else{t.spinner.hide(),t.toolbar=new UWA.Element("div",{class:"selectByConfigCriteriaToolbar"}).inject(t.MainContainer),t.variantsAndOptionsContainer=new UWA.Element("div",{class:"variantsAndOptionsContainer"}).inject(t.MainContainer);var a=s.processFilterablesVariantGrid(o),r=s.createDictionaryTreeDocument(a),l={analysisCmd:!0,touchMode:!t.options.displayCompactMode,treeDocument:r,onFeatureOptionSelectionChange:this.onSelection,features:a,onToolbarClickCallback:t.onToolbarClickCallback};this.featureOptionsView=new c(l),this.featureOptionsView.render(),this.featureOptionsView.setColumnRemoveWarningToShow(!1),this.featureOptionsView.featureOptionGridView.inject(this.variantsAndOptionsContainer),t.variantSearchContainer=new UWA.Element("div",{class:"variantSearchContainer"}).inject(t.toolbar),void 0===window.__karma__&&this.featureOptionsView.toolbar.inject(t.variantSearchContainer),t.featureOptionsView.toolbar.getNodeModelByID("ID_andCondition").onAttributeChange(function(e){t.andConditionCheckFlag=e.data.changedAttributeValue}),t.showORHideAndCondition(t.radioButtonGroup.value[0]),null==t.options.displayCompactMode||!1===t.options.displayCompactMode?(t.modelSelectionDiv.setAttributeNode(document.createAttribute("touch-mode")),t.toolbar.setAttributeNode(document.createAttribute("touch-mode")),t.variantsAndOptionsContainer.setAttributeNode(document.createAttribute("touch-mode"))):(t.modelSelectionDiv.removeAttribute("touch-mode"),t.toolbar.removeAttribute("touch-mode"),t.variantsAndOptionsContainer.removeAttribute("touch-mode"))}},checkSelection:function(e,t,n){if(t){var o=h.selections.findIndex(function(t){return t.optionID==e.physicalID});-1!=o&&h.selections.splice(o,1)}else{var a={optionID:e.physicalID};if("specific"==i.configurationAnalysisMode){let e=0,t=n.feature.options;for(let i=0;i<h.selections.length;i++){for(let n=0;n<t.length;n++)if(t[n].physicalID==h.selections[i].optionID){h.selections.splice(i,1),e=1;break}if(1==e)break}}h.selections.push(a)}},onSelection:function(e,t){if(e.self.options&&e.self.options.length>0)for(var i=0;i<e.self.options.length;i++)h.checkSelection(e.self.options[i],t,e);else h.checkSelection(e.self,t,e);h.checkMaxSelection()},checkMaxSelection:function(){if(this.maxSelectionDone=!1,"specific"==i.configurationAnalysisMode&&h.selections.length>g.Max_Selection_Limit){this.maxSelectionDone=!0;let e=g.Max_Selection_Limit_Error+g.Max_Selection_Limit;1==h.flagToShowWarningOnce&&(o.showwarning(e,"warning","Fast",h.MainContainer),h.flagToShowWarningOnce=!1)}this.handleApply()},handleApply:function(){0==h.selections.length||this.maxSelectionDone?h.containerView._firstButton.setAttributeNode(document.createAttribute("disabled")):h.containerView._firstButton.removeAttribute("disabled")},showORHideAndCondition:function(e){"whereUsed"==e?this.featureOptionsView.toolbar.updateNodeModel("ID_andCondition",{visibleFlag:!0}):this.featureOptionsView.toolbar.updateNodeModel("ID_andCondition",{visibleFlag:!1})}};return h});