define("DS/CAT3DWInfraVC/CAT3DWViewController",["UWA/Class"],function(e){"use strict";var t=e.extend({init:function(e){this.options=e,this._parent(e)},load:function(e){},unload:function(){},onRefresh:function(){},onResize:function(){},onDestroy:function(){},displayPreviousButton:function(){},setOption:function(e,t){this.options||(this.options={}),this.options[e]=t},getOption:function(e){return!!this.options&&this.options[e]},displayView:function(e,t){var n=this.getOption("navigationController");n&&(n.hideViewController(this),n.getViewControllerFromIndex(e,function(i){n._VisibleIndex=e,n.displayViewController(i,t)}))}});return UWA.namespace("DS/CAT3DWInfraVC/CAT3DWViewController",t)}),define("DS/CAT3DWInfraVC/CAT3DWNavigationController",["UWA/Core","DS/CAT3DWInfraVC/CAT3DWViewController","DS/CAT3DWInfra/CAT3DWPreferenceManager"],function(e,t,n){"use strict";var i=t.extend({defaultOptions:{NavigationControllerName:"MyNavigationController"},init:function(e){this._parent(e),this._Name=e.NavigationControllerName,this._ViewControllers=new Array,this._ViewControllersOptions=new Array,this._VisibleIndex=0},load:function(e){this._VisibleIndex=void 0!==e?e:0,this._ViewControllers.length>=0?this.getViewControllerFromIndex(this._VisibleIndex,function(e){this.displayViewController(e,null)}.bind(this)):(this._VisibleIndex=-1,UWA.log("Navigation Controller: startNavigationController error")),this.managePreviousButton()},SetTopBarAccess:function(e,t){this._topBarId=e,this._context=t,require(["DS/TopBarProxy/TopBarProxy","css!TopBar/TopBar.css"],function(e){this._topBarProxy=new e({id:this._topBarId}),this._topBarProxyReadyCB&&this._topBarProxyReadyCB()}.bind(this))},_onTopBarProxyReady:function(e){this._topBarProxyReadyCB=e},SetTopBarContent:function(e){if(e!=={}&&this._topBarId)if(this._topBarProxy){var t={profile:[]};e.handUse&&1==e.handUse.value&&t.profile.push({label:e.handUse.label,submenu:[{label:"Left",checked:"left"==n.getPreferenceValue("hand"),onExecute:this.onChangeProfile.bind(this,"left")},{label:"Right",checked:"right"==n.getPreferenceValue("hand"),onExecute:this.onChangeProfile.bind(this,"right")}]}),t.help=[],t.share=[],e.save&&1==e.save.value&&t.share.push({label:e.save.label,onExecute:this.onSave.bind(this)}),e.publish&&"3DDashboard"==this._context&&1==e.publish.value&&t.share.push({label:e.publish.label,onExecute:this.onPublish.bind(this)}),e.publish3DD&&"3DDashboard"==this._context&&1==e.publish3DD.value&&t.share.push({label:e.publish3DD.label,onExecute:this.onPublish3DD.bind(this)}),e.publishSketchDrive&&1==e.publishSketchDrive.value&&t.share.push({label:e.publishSketchDrive.label,onExecute:this.onPublish3DSketchDrive.bind(this)}),e.publishSketchSwym&&1==e.publishSketchSwym.value&&t.share.push({label:e.publishSketchSwym.label,onExecute:this.onPublish3DSketchSwym.bind(this)}),t.add=[],e.newShape&&1==e.newShape.value&&t.add.push({label:e.newShape.label,onExecute:this.onCreate.bind(this)}),e.open&&1==e.open.value&&t.add.push({label:e.open.label,onExecute:this.onOpen.bind(this)}),e.load3DSketch&&1==e.load3DSketch.value&&t.add.push({label:e.load3DSketch.label,onExecute:this.onLoad3dskt.bind(this)}),t.home=[],e.home&&1==e.home.value&&t.home.push({label:e.home.label,onExecute:this.onHome.bind(this)}),this._topBarProxy.setContent(t)}else this._onTopBarProxyReady(function(){this.SetTopBarContent(e)}.bind(this))},unload:function(){this._getCurrentViewController(function(e){e&&this.hideViewController(e)}.bind(this))},onChangeProfile:function(e,t){this._getCurrentViewController(function(n){n&&n.onChangeProfile(e),t&&t._attributes.label&&this.updateHandMenu(t._attributes.label)}.bind(this))},updateHandMenu:function(e){if(this._topBarProxy){var t=this._topBarProxy.get("profile").get("submenu")._models;if(t.length)for(var n=0;n<t.length;n++)if("Dominant hand"==t[n]._attributes.label)for(var i=0;i<t[n]._attributes.submenu._models.length;i++)t[n]._attributes.submenu._models[i]._attributes.label!=e?t[n]._attributes.submenu._models[i].set("checked",!1):t[n]._attributes.submenu._models[i].set("checked",!0)}},onRefresh:function(){this._getCurrentViewController(function(e){e&&e.onRefresh&&e.onRefresh()})},onResize:function(){this._getCurrentViewController(function(e){e&&e.onResize&&e.onResize()})},onCreate:function(){this._getCurrentViewController(function(e){e&&e.onCreate&&e.onCreate()})},onOpen:function(){this._getCurrentViewController(function(e){e&&e.onOpen&&e.onOpen()})},onSave:function(){this._getCurrentViewController(function(e){e&&e.onSave&&e.onSave()})},onPublish:function(){this._getCurrentViewController(function(e){e&&e.onPublish&&e.onPublish()})},onPublish3DD:function(){this._getCurrentViewController(function(e){e&&e.onPublish3DD&&e.onPublish3DD()})},onPublish3DSketchDrive:function(){this._getCurrentViewController(function(e){e&&e.onPublish3DSketchDrive&&e.onPublish3DSketchDrive()})},onLoad3dskt:function(){this._getCurrentViewController(function(e){e&&e.onLoad3dskt()})},onPublish3DSketchSwym:function(){this._getCurrentViewController(function(e){e&&e.onPublish3DSketchSwym&&e.onPublish3DSketchSwym()})},onHome:function(){this._getCurrentViewController(function(e){e&&e.onHome&&e.onHome()})},onDestroy:function(){this._getCurrentViewController(function(e){e&&e.onDestroy&&e.onDestroy()})},_getCurrentViewController:function(e){e&&(this._ViewControllers.length>=0?this._ViewControllers[this._VisibleIndex].instance?e(this._ViewControllers[this._VisibleIndex].instance):this.createVCInstance(this._ViewControllers[this._VisibleIndex],function(){e(this._ViewControllers[this._VisibleIndex].instance)}.bind(this)):UWA.log("Navigation Controller: no ViewControllers"),UWA.log("Navigation Controller: no ViewControllers"))},displayViewController:function(e,t){e&&(this.SetTopBarContent(this._ViewControllersOptions[this._VisibleIndex]),e.load(t))},hideViewController:function(e){e&&e.unload()},managePreviousButton:function(){this._VisibleIndex>0&&this.getViewControllerFromIndex(this._VisibleIndex,function(e){e.displayPreviousButton()})},getViewControllerFromIndex:function(e,t){if(t){var n=this._ViewControllers.length;return e<n&&(this._ViewControllers[e].instance?t(this._ViewControllers[e].instance):this.createVCInstance(this._ViewControllers[e],function(){t(this._ViewControllers[e].instance)}.bind(this))),null}},addViewController:function(e,n){var i={instance:null,data:{},waitInstance:!1,onInstanceReadyCB:[]};return e instanceof t?(i.instance=e,i.instance.setOption("navigationController",this)):(i.data=e,i.data.options?i.data.options.navigationController=this:i.data.options={navigationController:this}),this._ViewControllers.push(i),this._ViewControllersOptions.push(n),this._ViewControllers.length-1},createVCInstance:function(e,t){var i=e.data.path,o=e.data.options;e.waitInstance?e.onInstanceReadyCB.push(t):(this._loader&&this._loader.show(),e.waitInstance=!0,console.time("[PERFO - 3DSketch] require "+i),require([i],function(r){if((n.getPreferenceValue("debug")||"true"==n.getPreferenceValue("debugUrl"))&&console.timeEnd("[PERFO - 3DSketch] require "+i),this._loader&&this._loader.hide(),e.instance=new r(o),e.waitInstance=!1,e.onInstanceReadyCB.length){for(var s=0;s<e.onInstanceReadyCB.length;s++)e.onInstanceReadyCB[s](e.instance);e.onInstanceReadyCB=[]}t&&t(e.instance)}.bind(this)))},addLoader:function(e){this._loader=e},clearViewControllers:function(){}});return UWA.namespace("DS/CAT3DWInfraVC/CAT3DWNavigationController",i)});