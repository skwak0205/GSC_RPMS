/*!  COPYRIGHT DASSAULT SYSTEMES 2014   */
define("DS/SearchControlCenter/control/SCCColorPicker",["UWA/Core","UWA/Class","UWA/Class/Events","UWA/Element","UWA/Controls/Abstract","DS/Controls/Tab","DS/Controls/ColorPalette","DS/Controls/ColorChooser","DS/Controls/Popup","i18n!DS/SearchControlCenter/assets/nls/SearchControlCenter.json"],function(e,t,r,a,i,n,s,o,c,l){"use strict";return i.extend(r,{name:"scc-colorPicker",_colorPickerPopup:null,_tab:null,_defaultColorPalette:null,_recentColorPalette:null,_colorChooser:null,_currentColor:"#ffffff",divCustomColorChooser:null,_swatches_default:[{value:"#FEE000"},{value:"#009DDB"},{value:"#FF8A2E"},{value:"#9B2C98"},{value:"#00AA86"},{value:"#F564A3"},{value:"#8DDEE4"},{value:"#CC092F"},{value:"#E2D5CC"},{value:"#6FBC4B"},{value:"#70036B"},{value:"#002596"},{value:"#C6C68B"},{value:"#7F7F7F"},{value:"#4EA8B7"},{value:"#007A4C"},{value:"#ADADAD"},{value:"#127277"},{value:"#6D2815"},{value:"#000000"},{value:"#4D62BA"}],_swatches_recent:null,init:function(e){this._parent(e),this._buildUI(e)},_buildUI:function(t){e.is(t)&&e.is(t.initialValue)&&(this._currentColor=t.initialValue),this.elements.container=a.create("div",{class:"div-scc-color-picker"}),this.elements.content=a.create("div",{class:"scc-color-picker",styles:{"border-radius":"5px",border:"1px solid #000000",background:this._currentColor,width:"39px",height:"39px"},events:{click:this._buildColorPickerUI.bind(this)}}).inject(this.elements.container)},_buildColorPickerUI:function(t){var r=this;e.is(r.divCustomColorChooser)&&e.is(r._colorPickerPopup)||(r.divCustomColorChooser=a.create("div",{class:"container-custom-color-picker",id:"container_custom_color_picker"}),r._tab=new n({displayStyle:"strip"}).inject(r.divCustomColorChooser),r._tab.add({label:l.get("SCCColorPicker.tab.ColorPalette.title"),isSelected:!0,content:r._buildColorPalette()}),r._tab.add({label:l.get("SCCColorPicker.tab.ColorChooser.title"),content:r._buildColorChooser()}),r._colorPickerPopup=new c({target:t.target,trigger:"click",toggleFlag:!1,position:"top",alignment:"near",offset:{x:5,y:-255},touchMode:!0}),r._colorPickerPopup.show(),r._colorPickerPopup.setBody(r.divCustomColorChooser),r._colorPickerPopup.addEventListener("hide",function(e){e.stopPropagation(),r._cleanup()}))},_buildColorPalette:function(){var e=a.create("div",{class:"scc-custom-color-picker",id:"scc_custom_color_picker_palette_tab_container"}),t=a.create("div",{class:"div-scc-custom-color-picker",id:"div_scc_custom_color_picker_default"}).inject(e);a.create("p",{class:"scc-custom-color-picker-title",id:"scc_custom_color_picker_title_default",text:l.get("SCCColorPicker.ColorPalette.default.title")}).inject(t);if(this._defaultColorPalette=new s({swatches:this._swatches_default,domId:"color_palette_default",touchMode:!0}).inject(t),this._getRecentSwatches().length>0){var r=a.create("div",{class:"div-scc-custom-color-picker",id:"div_scc_custom_color_picker_recent"}).inject(e);a.create("p",{class:"scc-custom-color-picker-title",id:"scc_custom_color_picker_title_recent",text:l.get("SCCColorPicker.ColorPalette.recent.title")}).inject(r);this._recentColorPalette=new s({swatches:this._getRecentSwatches(),domId:"color_palette_recent",touchMode:!0}).inject(r),this._recentColorPalette.addEventListener("change",this._onColorChange.bind(this),!1)}return this._defaultColorPalette.addEventListener("change",this._onColorChange.bind(this),!1),e},_buildColorChooser:function(){var e=a.create("div",{class:"scc-custom-color-chooser .scc-chooser-tab-container",id:"scc_custom_color_chooser_palette_tab_container"});return this._colorChooser=new o({domId:"color_chooser",value:this._currentColor,referenceValue:this._currentColor,touchMode:!0}).inject(e),this._colorChooser.addEventListener("change",this._onColorChange.bind(this),!1),e},_onColorChange:function(t){t.stopPropagation();var r=this._getNewColor(t.dsModel.domId);if(e.is(r,"string")&&r.indexOf("#")<0&&(r="#"+r),this._currentColor!==r)this._currentColor=r,this.elements.content.setStyle("background",r),"color_chooser"===t.dsModel.domId&&this._storeRecentSwatches(r),this._cleanup(),this.dispatchEvent("onColorChange",{color:this._currentColor,target:this.elements.container});else{if(!this._colorChooser.pointerdownCanvasP&&"color_chooser"===t.dsModel.domId)return;this._cleanup()}},_getNewColor:function(e){switch(e){case"color_chooser":return this._colorChooser.pointerdownCanvasP?this._colorChooser.value:this._currentColor;case"color_palette_default":return this._defaultColorPalette.value;case"color_palette_recent":return this._recentColorPalette.value;default:return this._currentColor}},_getCurrentColor:function(){return this._currentColor},_getRecentSwatches:function(){var t=localStorage.getItem("_swatches_recent");return e.is(t)?JSON.parse(t):[]},_storeRecentSwatches:function(t){var r=JSON.parse(localStorage.getItem("_swatches_recent"));e.is(r,"array")||(r=[]);var a=r.findIndex(e=>e.value.trim()===t.trim());a>=0&&r.splice(a,1),r.length>=10&&r.shift(),r.push({value:t}),localStorage.setItem("_swatches_recent",JSON.stringify(r))},_cleanup:function(){e.is(this._defaultColorPalette)&&(this._defaultColorPalette.destroy(),this._defaultColorPalette=null),e.is(this._recentColorPalette)&&(this._recentColorPalette.destroy(),this._recentColorPalette=null),e.is(this._colorChooser)&&(this._colorChooser.destroy(),this._colorChooser=null),e.is(this._tab)&&(this._tab.destroy(),this._tab=null),e.is(this._colorPickerPopup)&&(this._colorPickerPopup.destroy(),this._colorPickerPopup=null),e.is(this.divCustomColorChooser)&&(this.divCustomColorChooser.destroy(),this.divCustomColorChooser=null)}})}),define("DS/SearchControlCenter/Model/SearchControlCenterFacetListModel",["UWA/Core","UWA/Class/Model"],function(e,t){"use strict";return t.extend({defaults:function(){return{id:"",title:"",subtitle:"",tooltip:"",domainid:"",facetJS:"",image:""}}})}),define("DS/SNResultUX/views/EnterpriseDictionaryTab",["UWA/Element","UWA/Core","DS/Controls/ComboBox","DS/UIKIT/Input/Button","DS/UIKIT/Input/File","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/SNInfraUX/Logger","i18n!DS/SearchControlCenter/assets/nls/SearchControlCenter.json"],function(e,t,r,a,i,n,s,o,c,l){var d={comboBox:null,importButton:null,fileChooser:null,rendurStatus:!1,xlsxReader:null,listOfTenants:[],onRenderFacet:function(_){var h=e.create("div",{styles:{"margin-top":"20px","margin-bottom":"20px",display:"flex"},class:"enterprise-dictionary-tab",id:"enterprise-dictionary-tab-tenant"}).inject(_),u=e.create("div",{class:"enterprise-dictionary-tab",id:"enterprise-dictionary-tab-tenant-text",styles:{"align-self":"center",position:"relative"}}).inject(h),p=e.create("div",{class:"enterprise-dictionary-tab",id:"enterprise-dictionary-tab-tenant-combo",styles:{width:"50%",position:"relative","align-self":"center","margin-left":"10px",display:"inline-grid"}}).inject(h);e.create("p",{styles:{margin:"unset"},text:l.get("dictionary-for-platform.title")}).inject(u),o.getServiceUrl({serviceName:"search",onComplete:function(e){if(t.is(e,"array")){for(var a=0;a<e.length;a++)t.is(e[a].platformId,"string")&&d.listOfTenants.push(e[a].platformId);d.comboBox=new r({elementsList:d.listOfTenants,nbDisplayedElements:d.listOfTenants.length,styles:{align:"left"},selectedIndex:0,touchMode:!0,enableSearchFlag:!0}).inject(p)}},onFailure:function(e){c.log(e)}}),void 0===window.notifs&&(window.notifs=n),s.setNotificationManager(window.notifs);var g=e.create("div",{class:"enterprise-dictionary-tab",id:"enterprise-dictionary-tab-file",styles:{"margin-bottom":"20px",display:"flex"}}).inject(_),f=e.create("div",{class:"enterprise-dictionary-tab",id:"enterprise-dictionary-tab-file-chooser",styles:{width:"50%",position:"relative"}}).inject(g),m=e.create("div",{class:"enterprise-dictionary-tab",id:"enterprise-dictionary-tab-file-import",styles:{width:"50%",position:"relative","margin-left":"5px"}}).inject(g);d.fileChooser=new i({multiple:!1,buttonBefore:!1,name:"file-input",buttonClassName:"default",placeholder:"Upload the enterprise dictionary...",buttonText:"Browse..",events:{onChange:this._onFileInputChange.bind(this)}}).inject(f);var C=this;d.importButton=new a({id:"import_button_id",value:l.get("importButton.title"),disabled:!0,className:"default",events:{onClick:function(){C._OnImportClick(),c.log("inside _OnImportClick() ")}}}).inject(m),d.rendurStatus=!0},_onFileInputChange:function(e){var r=e.target.files[0].name;if(t.is(r,"string")){var a=r.slice(2+(r.lastIndexOf(".")-1>>>0));if("xls"===a||"xlsx"===a)"undefined"!=typeof FileReader&&(d.xlsxReader=new FileReader,d.xlsxReader.readAsArrayBuffer(e.target.files[0]),d.importButton.enable());else{d.importButton.disable(),d.fileChooser.clear();var i={level:"error",message:l.get("wrongFileTypeSelectionWarning"),sticky:!1};window.notifs.addNotif(i)}}},_OnImportClick:function(){if(t.is(d.fileChooser)){var e=XLSX.read(d.xlsxReader.result,{type:"binary"});e.SheetNames.forEach(function(r){var a=XLSX.utils.sheet_to_json(e.Sheets[r]),i=(new DOMParser).parseFromString("<SuggestDictionary/>","text/xml"),n=i.documentElement;if(t.is(a,"array"))for(var s=0;s<a.length;s++)if(t.is(a[s])){var o=i.createElement("SuggestDictEntry");if(o.setAttribute("display",a[s].display),o.setAttribute("score",a[s].score),o.setAttribute("entry",a[s].entry),n.appendChild(o),0===s){var c=i.getElementsByTagName("SuggestDictionary");t.is(c[s])&&(c[s].setAttribute("subString",a[s].subString),c[s].setAttribute("subExpr",a[s].subExpr),c[s].setAttribute("maxEntries",a[s].maxEntries))}}new XMLSerializer})}},getTabInputsToStore:function(){},onResetTab:function(){},isCurrentTabRendered:function(){return d.rendurStatus}};return d}),define("DS/SearchControlCenter/scripts/SearchcontrolCenterModel",["UWA/Element","UWA/Core","UWA/Class","UWA/Class/Debug"],function(e,t,r,a){"use strict";var i=r.singleton(a,{_searchControlCenterSettingsJSON:{},_datasource_InternalName_Mapping:{},_types_InternalName_Mapping:{},_attributes_InternalName_Mapping:{},_local_AttributeDisplay_Cache_For_Types:[],_local_AttributeDisplay_Cache_For_6WTags:[],gate_Local_Attribute_Cache:function(){return this._local_AttributeDisplay_Cache_For_Types},gate_Local_6WTags_Cache:function(){return this._local_AttributeDisplay_Cache_For_6WTags},clear_Local_Attribute_Cache:function(){this._local_AttributeDisplay_Cache_For_Types.length>0&&(this._local_AttributeDisplay_Cache_For_Types=[])},clear_Local_6WTags_Cache:function(){this._local_AttributeDisplay_Cache_For_6WTags.length>0&&(this._local_AttributeDisplay_Cache_For_6WTags=[])},initiate_Local_Attribute_Cache:function(e){this._local_AttributeDisplay_Cache_For_Types.length>0&&(this._local_AttributeDisplay_Cache_For_Types=[]),e.length>0&&(this._local_AttributeDisplay_Cache_For_Types=e)},initiate_Local_6WTags_Cache:function(e){this._local_AttributeDisplay_Cache_For_6WTags.length>0&&(this._local_AttributeDisplay_Cache_For_6WTags=[]),e.length>0&&(this._local_AttributeDisplay_Cache_For_6WTags=e)},addTo_Local_Attribute_Cache:function(e){var r=this._local_AttributeDisplay_Cache_For_Types,a=e.datasource,i=e.type,n=!1,s=0,o=null,c=null;if(r.length>0){var l=e.attributes;if(t.is(r,"array")&&t.is(i,"string")&&t.is(a,"string"))for(var d=0;d<r.length;d++){var _=r[d];if(t.is(_)&&i===_.uri&&a===_.source){o=[];for(var h=0;h<l.length;h++)(c={}).uri=l[h],t.is(c.uri)&&o.push(c);if("SearchAttributes_preferredAttr"===e.parentDIVID)if(_.hasOwnProperty("predicates")){let e=_.predicates;if(e.length>0){let t=!1;for(s=0;s<e.length;s++)e[s].uri===o[0].uri&&(t=!0);!1===t&&e.push(o[0])}else _.predicates=o}else _.predicates=o;else if("SearchAttributes_moreAttr"===e.parentDIVID)if(_.hasOwnProperty("excluded_predicates")){let e=_.excluded_predicates;if(e.length>0){let t=!1;for(s=0;s<e.length;s++)e[s].uri===o[0].uri&&(t=!0);!1===t&&e.push(o[0])}else _.excluded_predicates=o}else _.excluded_predicates=o;n=!0}}}if(!1===n){var u=[],p={};for(p.source=a,p.uri=i,o=[],s=0;s<e.attributes.length;s++)(c={}).uri=e.attributes[s],t.is(c.uri)&&o.push(c);"SearchAttributes_preferredAttr"===e.parentDIVID?p.predicates=o:"SearchAttributes_moreAttr"===e.parentDIVID&&(p.excluded_predicates=o),r.length>0?r.push(p):(u.push(p),this._local_AttributeDisplay_Cache_For_Types=u)}},addTo_Local_Attribute_Cache_ForAllTypes:function(e){var r=this._local_AttributeDisplay_Cache_For_6WTags,a=e.datasource,i=!1,n=0,s=null,o=null;if(r.length>0){var c=e.attributes;if(t.is(r,"array")&&t.is(a,"string"))for(var l=0;l<r.length;l++){var d=r[l];if(t.is(d)&&a===d.source){s=[];for(var _=0;_<c.length;_++)(o={}).uri=c[_],t.is(o.uri)&&s.push(o);if("SCC6WTagsFilter_preferredAttr"===e.parentDIVID)if(d.hasOwnProperty("predicates")){let e=d.predicates;if(e.length>0){let t=!1;for(n=0;n<e.length;n++)e[n].uri===s[0].uri&&(t=!0);!1===t&&e.push(s[0])}else d.predicates=s}else d.predicates=s;else if("SCC6WTagsFilter_ExcludedAttr"===e.parentDIVID)if(d.hasOwnProperty("excluded_predicates")){let e=d.excluded_predicates;if(e.length>0){let t=!1;for(n=0;n<e.length;n++)e[n].uri===s[0].uri&&(t=!0);!1===t&&e.push(s[0])}else d.excluded_predicates=s}else d.excluded_predicates=s;i=!0}}}if(!1===i){var h=[],u={};for(u.source=a,s=[],n=0;n<e.attributes.length;n++)(o={}).uri=e.attributes[n],t.is(o.uri)&&s.push(o);"SCC6WTagsFilter_preferredAttr"===e.parentDIVID?u.predicates=s:"SCC6WTagsFilter_ExcludedAttr"===e.parentDIVID&&(u.excluded_predicates=s),r.length>0?r.push(u):(h.push(u),this._local_AttributeDisplay_Cache_For_6WTags=h)}},update_Local_Attribute_Cache:function(e){var r=this._local_AttributeDisplay_Cache_For_Types,a=e.datasource,i=e.type;if(r.length>0){var n=e.attributes;if(t.is(r,"array")&&t.is(i,"string")&&t.is(a,"string"))for(var s=0;s<r.length;s++){var o=r[s];if(t.is(o)&&i===o.uri&&a===o.source){for(var c=[],l=0;l<n.length;l++){var d={};d.uri=n[l],t.is(d.uri)&&c.push(d)}"SearchAttributes_preferredAttr"===e.parentDIVID?o.predicates=c:"SearchAttributes_moreAttr"===e.parentDIVID&&(o.excluded_predicates=c)}}}},update_Local_Attribute_Cache_ForAllTypes:function(e){var r=this._local_AttributeDisplay_Cache_For_6WTags,a=e.datasource;if(r.length>0){var i=e.attributes;if(t.is(r,"array")&&t.is(a,"string"))for(var n=0;n<r.length;n++){var s=r[n];if(t.is(s)&&a===s.source){for(var o=[],c=0;c<i.length;c++){var l={};l.uri=i[c],t.is(l.uri)&&o.push(l)}"SCC6WTagsFilter_preferredAttr"===e.parentDIVID?s.predicates=o:"SCC6WTagsFilter_ExcludedAttr"===e.parentDIVID&&(s.excluded_predicates=o)}}}},setSettingsJSON:function(e){t.is(e)&&(this._searchControlCenterSettingsJSON=e)},gateSettingsJSON:function(){return this._searchControlCenterSettingsJSON},gateTabSettingJSON:function(e){var r,a={};if(t.is(e,"string")&&(r=t.is(i._searchControlCenterSettingsJSON,"string")?JSON.parse(i._searchControlCenterSettingsJSON):i._searchControlCenterSettingsJSON,t.is(r)))for(var n=Object.keys(r),s=null,o=0;o<n.length;o++){var c=n[o];if(t.is(c)&&r.hasOwnProperty(c))if("search_settings"===c&&"SearchControl_General"===e){if(s=r.search_settings,t.is(s)){a=s,r.result_categories&&(a.result_categories=r.result_categories),r.search_synonyms&&(a.search_synonyms=r.search_synonyms);break}}else if("type_custo"===c&&"SearchControl_SearchTypes"===e)s=r.type_custo,t.is(s)&&(a.type_custo=s);else if("tagRelationships"===c&&"SearchControl_6WTags"===e)a.tagRelationships=r.tagRelationships;else if("tagColorization"===c&&"SearchControl_6WTags"===e)a.tagColorization=r.tagColorization;else if("hierarchical_predicates"===c&&"SearchControl_6WTags"===e)a.hierarchical_predicates=r.hierarchical_predicates;else if("controlledVocabulary"===c&&"SearchControl_6WTags"===e)a.controlledVocabulary=r.controlledVocabulary;else if("enterprise_ontology"===c&&"SearchControl_6WTags"===e)a.enterprise_ontology=r.enterprise_ontology;else if("attribute_custo"===c&&"SearchControl_6WTags"===e){if(s=r.attribute_custo,t.is(s)){if(s.hasOwnProperty("ds6w:type")){var l=s["ds6w:type"];if(t.is(l,"array"))for(var d=0;d<l.length;d++)if(UWA.is("AllDataSourcesandTypes"===l[d].source)){a=l[d];break}}s.hasOwnProperty("attributes_display")&&(a.attributes_display=s.attributes_display),s.hasOwnProperty("context_apps_predicates")&&(a.context_apps_predicates=s.context_apps_predicates)}}else"attribute_custo"===c&&"SearchControl_SearchTypes"===e&&(s=r.attribute_custo,t.is(s)&&(a.attribute_custo=s))}return a},updateSettingsJSON:function(e){var r,a,n,s=!1;if(r=t.is(e,"string")?JSON.parse(e):e,t.is(i._searchControlCenterSettingsJSON)?(a=t.is(i._searchControlCenterSettingsJSON,"string")?JSON.parse(i._searchControlCenterSettingsJSON):i._searchControlCenterSettingsJSON,t.is(a)&&(n=Object.keys(a))):s=!0,t.is(r))for(var o=Object.keys(r),c=0;c<o.length;c++){var l=o[c];if(t.is(l)&&r.hasOwnProperty(l))if("SearchControl_General"===l){var d=r.SearchControl_General,_=null,h=null;d&&d.result_categories&&(_=d.result_categories,delete d.result_categories),d&&d.search_synonyms&&(h=d.search_synonyms,delete d.search_synonyms),!0===s||0===n.length?(i._searchControlCenterSettingsJSON.search_settings=d,_&&(i._searchControlCenterSettingsJSON.result_categories=_),h&&(i._searchControlCenterSettingsJSON.search_synonyms=h)):(a.search_settings=d,_&&(a.result_categories=_),h&&(a.search_synonyms=h))}else if("SearchControl_SearchTypes"===l){var u=r.SearchControl_SearchTypes;if(!0===s||0===n.length)i._searchControlCenterSettingsJSON.type_custo=u;else if(n.length>0){let e=!1;for(let r=0;r<n.length;r++){let i=n[r];if(t.is(i)&&a.hasOwnProperty(i)&&"type_custo"===i){var p=a[i];p.type_display=u.type_display,p.SEARCH_INSTANCES=u.SEARCH_INSTANCES,p.easyTypeAccess=u.easyTypeAccess,p.excluded_types=u.excluded_types,p.default_datasourceandtype=u.default_datasourceandtype,e=!0}}!1===e&&(a.type_custo=u)}}else if("SearchControl_SearchAttributes"===l||"SearchControl_6WTags"===l){var g=!1,f=r.SearchControl_SearchAttributes;if(t.is(f)||(f=r.SearchControl_6WTags,g=!0),f.tagRelationships&&(i._searchControlCenterSettingsJSON.tagRelationships=f.tagRelationships),f.tagColorization&&(i._searchControlCenterSettingsJSON.tagColorization=f.tagColorization),f.hierarchical_predicates&&(i._searchControlCenterSettingsJSON.hierarchical_predicates=f.hierarchical_predicates),f.enterprise_ontology&&(i._searchControlCenterSettingsJSON.enterprise_ontology=f.enterprise_ontology),!0!==s&&0!==n.length||(i._searchControlCenterSettingsJSON.attribute_custo=f),f.controlledVocabulary)i._searchControlCenterSettingsJSON.controlledVocabulary=f.controlledVocabulary;else if(n.length>0){let e=!1;for(let r=0;r<n.length;r++){let i=n[r];if(t.is(i)&&a.hasOwnProperty(i)&&"attribute_custo"===i){var m=a[i];g&&(m.attributes_display=f.attributes_display);var C=m["ds6w:type"],v=f["ds6w:type"];if(t.is(v)&&v.length>0&&!g)m["ds6w:type"]=v;else{var y,b=!1;if(t.is(v,"array")&&v.length>0)for(var S=0;S<v.length;S++)if(v[S].hasOwnProperty("source")&&"AllDataSourcesandTypes"===v[S].source){y=v[S];break}if(t.is(C,"array")&&C.length>0&&t.is(y)){for(var x=0;x<C.length;x++){var D=C[x];t.is(D)&&D.source===y.source&&(C[x]=y,b=!0)}!1===b&&C.push(v[0])}else t.is(v)&&(m["ds6w:type"]=v)}if(f.hasOwnProperty("context_apps_predicates"))if(m.hasOwnProperty("context_apps_predicates")){var A=m.context_apps_predicates,T=f.context_apps_predicates,w=(b=!1,Object.keys(T[0]));if(w.length>0){for(var I=0;I<A.length;I++)if(A[I].hasOwnProperty(w[0])){A[I]=T[0],b=!0;break}!1===b&&A.push(T[0])}}else m.context_apps_predicates=f.context_apps_predicates;e=!0}}!1===e&&(a.attribute_custo=f)}}else"SearchControl_ColumnCusto"===l&&(a.column_custo=r.SearchControl_ColumnCusto)}},setDatasourceInternalMapping:function(e){t.is(e)&&(this._datasource_InternalName_Mapping=e)},getDatasourceInternalMappingValue:function(e){var r=this._datasource_InternalName_Mapping;if(t.is(r)&&t.is(e,"string"))for(var a=Object.keys(r),i=0;i<a.length;i++)if(r[a[i]]===e)return a[i]},getDatasourceDisplayMappingValue:function(e){var r=this._datasource_InternalName_Mapping;if(t.is(r)&&t.is(e,"string"))for(var a=Object.keys(r),i=0;i<a.length;i++)if(a[i]===e)return r[a[i]]},setAttributesInternalMappingForAllDataSourcesAndTypes:function(e,r){t.is(r)&&(this._types_InternalName_Mapping[e]=r)},getAttributesInternalMappingValueForAllDataSourcesAndTypes:function(e,r){if(t.is(r,"string")&&t.is(e,"string")){var a=this._types_InternalName_Mapping[e];if(t.is(a))for(var i=Object.keys(a),n=0;n<i.length;n++)if(a[i[n]]===r)return i[n]}},getAttributesDisplayMappingValueForAllDataSourcesAndTypes:function(e,r){if(t.is(r,"string")&&t.is(e,"string"))for(var a=Object.keys(this._types_InternalName_Mapping),i=0;i<a.length;i++){if(e===a[i])return this._types_InternalName_Mapping[e][r]}},setTypeInternalMapping:function(e,r){t.is(r)&&(this._types_InternalName_Mapping[e]=r)},getTypeInternalMappingValue:function(e,r){if(t.is(r,"string")&&t.is(e,"string")){var a=this._types_InternalName_Mapping[e];if(t.is(a))for(var i=Object.keys(a),n=0;n<i.length;n++)if(a[i[n]]===r)return i[n]}},getTypeDisplayMappingValue:function(e,r){if(t.is(r,"string")&&t.is(e,"string"))for(var a=Object.keys(this._types_InternalName_Mapping),i=0;i<a.length;i++){if(e===a[i])return this._types_InternalName_Mapping[e][r]}},getAppWisePredicates:function(e){var r,a={};if(t.is(e,"string")&&(r=t.is(i._searchControlCenterSettingsJSON,"string")?JSON.parse(i._searchControlCenterSettingsJSON):i._searchControlCenterSettingsJSON,t.is(r)&&r.hasOwnProperty("attribute_custo"))){var n=!1,s=r.attribute_custo;if(t.is(s)&&s.hasOwnProperty("context_apps_predicates")&&!0===s.attributes_display){var o=s.context_apps_predicates;if(t.is(o,"array"))for(var c=0;c<o.length;c++){var l=o[c];e===Object.keys(l)[0]&&(a=l[e],n=!0)}}if("X3DSEAR_AP"===e&&!1===n&&s.hasOwnProperty("ds6w:type")){var d=s["ds6w:type"];if(t.is(d,"array"))for(var _=0;_<d.length;_++)if(UWA.is("AllDataSourcesandTypes"===d[_].source)){t.is(d[_].predicates)&&(a.preferred_predicates=d[_].predicates),t.is(d[_].excluded_predicates)&&(a.excluded_predicates=d[_].excluded_predicates);break}}}return a},setAttributeInternalMapping:function(e,r,a){if(t.is(a)&&t.is(r,"string")&&t.is(e,"string")){var i={};i[r]=a;var n=Object.keys(this._attributes_InternalName_Mapping);if(n.length<=0)this._attributes_InternalName_Mapping[e]=i;else{for(var s=!1,o=0;o<n.length;o++)if(this._attributes_InternalName_Mapping[n[o]]===e){var c=this._attributes_InternalName_Mapping[n[o]];if(t.is(c)){c[r]=a,s=!0;break}}if(!1===s){var l=this._attributes_InternalName_Mapping[e];t.is(l)&&(l[r]=a)}}}},getAttributeInternalMapping:function(e,r,a){if(t.is(e,"string")&&t.is(r,"string")&&t.is(a,"string")){var i=this._attributes_InternalName_Mapping[e];if(t.is(i))for(var n=Object.keys(i),s=0;s<n.length;s++)if(n[s]===r)for(var o=i[n[s]],c=Object.keys(o),l=0;l<c.length;l++)if(o[c[l]]===a)return c[l]}}});return i}),define("DS/SearchControlCenter/control/SCCCard",["UWA/Core","UWA/Element","UWA/Controls/Abstract","DS/Controls/TooltipModel"],function(e,t,r,a){"use strict";return r.extend({name:"scc-card",_title:null,_body:null,_value:null,init:function(e){this._parent(e),this._buildUI(e)},_buildUI:function(r){this._title=r.header.label,this._value=e.is(r.header.value)?r.header.value:r.header.label,this.elements.container=t.create("div",{class:"scc-card-container"}),this.elements.header=t.create("div",{class:"scc-card-header scc-card-flex"}).inject(this.elements.container),e.is(r.className)&&this.elements.header.addClassName(r.className);var i=t.create("p",{class:"scc-card-header-text",text:this._truncateString(r.header.label,25)}).inject(this.elements.header);e.is(r.className)&&i.addClassName(r.className),i.tooltipInfos=new a({shortHelp:r.header.label,position:"top",touchMode:!0}),!0===r.closable&&t.create("div",{class:"fonticon fonticon-clear fonticon-x search_center_delete_button_margin scc-card-close-button",styles:{color:"#b4b6ba"},events:{click:this._onClick.bind(this),mouseover:this._onMouseOver.bind(this),mouseout:this._onMouseOut.bind(this)}}).inject(this.elements.header),!0===r.isBodyRequired&&(this.elements.header.setStyle("border-bottom","1px solid #b2adad"),this.elements.body=t.create("div",{class:"scc-card-body"}).inject(this.elements.container))},_onClick:function(t){let r=e.clone(this.options);r.target=this.elements.container,this.dispatchEvent("onClose",r)},_onMouseOver:function(e){e.currentTarget.setStyle("color","#3d3d3d")},_onMouseOut:function(e){e.currentTarget.setStyle("color","#b4b6ba")},getTitle:function(){return this._title},getValue:function(){return this._value},getHeaderElement:function(){return this.elements.header},getBodyElement:function(){return this.elements.body},appendChildToBody:function(e){e.inject(this.elements.body)},_truncateString:function(t,r){return!e.is(t)||t.length<=r?t:t.slice(0,r)+" ..."}})}),define("DS/SearchControlCenter/Collection/SearchControlCenterFacetListCollection",["UWA/Core","UWA/Utils","UWA/Class/Collection","DS/SearchControlCenter/Model/SearchControlCenterFacetListModel","WebappsUtils/WebappsUtils","DS/SearchControlCenter/scripts/SearchControlCenterServices","i18n!DS/SearchControlCenter/assets/nls/SearchControlCenter.json"],function(e,t,r,a,i,n,s){"use strict";return r.extend({model:a,setup:function(){e.log("SearchControlCenterFacetListCollection::setup"),this.url=i.getWebappsAssetUrl("SearchControlCenter","SearchControlCenter_Entries.json")},sync:function(t,r,a){e.log("SearchControlCenterFacetListCollection::sync"),a.proxy="passport",a.headers={"Accept-Language":widget.lang},this._parent.apply(this,[t,r,a])},parse:function(t){e.log("SearchControlCenterFacetListCollection::parse");var r=!1,a=null;e.is(window)&&e.is(window.location)&&e.is(window.location.search,"string")&&(a=window.location.search.substring(1)),e.is(a,"string")&&a.length>0&&(a.indexOf("AdminColumnsSearch")>=0||a.indexOf("SearchDisplayName")>=0)&&(r=!0);var i,o,c=[];return Array.isArray(t.facets)&&t.facets.forEach(function(e){i=s[e.facetID],o=s[e.facetID+".subTitle"];var t=n.getURL()+"/webapps/SearchControlCenter/assets/img/"+e.iconName;(r||!r&&"SearchControl_ColumnCusto"!==e.facetID)&&c.push({title:i,subtitle:o,introduction:"",image:t,facetJS:e.srcJS,domainid:e.facetID,id:e.facetID})}),c}})}),define("DS/SearchControlCenter/scripts/SearchControlCenterServices",["UWA/Element","UWA/Core","UWA/Promise","DS/UIKIT/Alert","DS/UIKIT/Mask","DS/SearchControlCenter/scripts/SearchcontrolCenterModel","DS/SNInfraUX/SearchLogin","DS/SNInfraUX/SearchUtils","DS/SNInfraUX/SNVocabAccess","DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/SNResultUX/utils/SearchServices","DS/SNResultUX/utils/SearchViewOptions","i18n!DS/SearchControlCenter/assets/nls/SearchControlCenter.json","css!DS/SearchControlCenter/SearchControlCenter"],function(e,t,r,a,i,n,s,o,c,l,d,_,h,u){"use strict";var p={parentCardDiv:null,draggedCardBlock:null,platformID:null,platformDisplayName:null,_datasourceList:[],_datSourceToVocabID:{},_Service_Nls_promise:r.deferred(),_applyButton:null,_restoreButton:null,_buttonStatus:!1,_URL:null,buildCardBlockRow:function(r){if(t.is(r.cardDiv)&&t.is(r.textOnCard)){var a=r.cardDiv,i=r.datasource,s=null,o=null,c=null;t.is(r.type)&&(s=r.type),t.is(r.uri)&&(o=r.uri),t.is(r.tabName)&&(c=r.tabName);var l=e.create("div",{class:"card-block search_center_general_display_flex search_center_top_margin card_block_design_elements",draggable:!0}).inject(a);if(l.appendChild(e.create("h3",{class:"card-title search_center_font_and_color",text:r.textOnCard})),!0===r.deleteOption){var d=e.create("div",{class:"fonticon fonticon-clear fonticon-x search_center_delete_button_margin"});l.appendChild(d),d.setStyle("color","#b4b6ba"),d.addEventListener("click",_,!1),d.addEventListener("mouseover",h,!1),d.addEventListener("mouseout",u,!1)}if(t.is(o)||(o=t.is(s)?this.getAttributesInternalName(i,s,r.textOnCard):this.getTypesInternalName(i,r.textOnCard)),l.setAttribute("sccuri",o),l.setAttribute("sccdatasource",i),l.setAttribute("scctype",s),y(l),t.is(c)&&"SearchControl_6WTags"===c){let e=[];if(e.push(l.getAttribute("sccuri")),"AllDataSourcesandTypes"===i){a.id}}if(t.is(c)&&"SearchControl_SearchAttributes"===c){let e=[];if(e.push(l.getAttribute("sccuri")),"AllDataSourcesandTypes"===i){let t={datasource:i,attributes:e,operation:"add",parentDIVID:a.id};n.addTo_Local_Attribute_Cache_ForAllTypes(t)}else{let t={datasource:i,type:s,attributes:e,operation:"add",parentDIVID:a.id};n.addTo_Local_Attribute_Cache(t)}}function _(e){if(t.is(e.currentTarget.parentElement)){var r=e.currentTarget.parentElement.parentElement;if(e.currentTarget.parentElement.destroy(),p.enableButtons(),t.is(c)&&"SearchControl_SearchAttributes"===c||"SearchControl_6WTags"===c){let e=r.childElementCount,l=[];for(var o=0;o<e;o++)l.push(r.children[o].getAttribute("sccuri"));if("AllDataSourcesandTypes"===i){let e={datasource:i,attributes:l,parentDIVID:a.id};n.update_Local_Attribute_Cache_ForAllTypes(e)}else{let e={datasource:i,type:s,attributes:l,parentDIVID:a.id};n.update_Local_Attribute_Cache(e)}"SearchControl_6WTags"===c&&1===r.childElementCount&&t.is(r.childNodes[0].childNodes[1])&&(a.childNodes[0].childNodes[1].hidden=!1)}0===r.childElementCount&&r.parentElement.parentElement.parentElement.children[0].addClassName("search_center_div search_center_margin search_center_general_display_flex")}}function h(e){e.currentTarget.setStyle("color","#3d3d3d")}function u(e){e.currentTarget.setStyle("color","#b4b6ba")}function g(e){p.draggedCardBlock=this,e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",this.outerHTML)}function f(e){e.preventDefault&&e.preventDefault(),this.classList.add("over"),e.dataTransfer.dropEffect="move"}function m(){this.classList.remove("over")}function C(){this.classList.remove("over")}function v(e){if(e.stopPropagation&&e.stopPropagation(),p.draggedCardBlock!==this){this.parentNode.removeChild(p.draggedCardBlock);var r=e.dataTransfer.getData("text/html");this.insertAdjacentHTML("beforebegin",r);var i=this.previousSibling;if(y(i),i.children[1].addEventListener("click",_,!1),i.children[1].addEventListener("mouseover",h,!1),i.children[1].addEventListener("mouseout",u,!1),t.is(c)&&("SearchControl_SearchAttributes"===c||"SearchControl_6WTags"===c)){let e=this.parentNode.childElementCount,t=[];for(var s=0;s<e;s++)t.push(this.parentNode.children[s].getAttribute("sccuri"));var o=i.getAttribute("sccdatasource");if("AllDataSourcesandTypes"===o){let e={datasource:o,attributes:t,parentDIVID:a.id};n.update_Local_Attribute_Cache_ForAllTypes(e)}else{let e={datasource:o,type:i.getAttribute("scctype"),attributes:t,parentDIVID:a.id};n.update_Local_Attribute_Cache(e)}p.enableButtons()}}this.classList.remove("over")}function y(e){e.addEventListener("dragstart",g,!1),e.addEventListener("dragover",f,!1),e.addEventListener("dragleave",m,!1),e.addEventListener("drop",v,!1),e.addEventListener("dragend",C,!1)}}},createWdgAlert:function(){return new a({closable:!0,visible:!0,autoHide:!0,hideDelay:2500})},updateButtons:function(e,r){t.is(e)&&t.is(r)&&(this._applyButton=e,this._restoreButton=r)},isButtonDisabled:function(){return this._buttonStatus=!1,t.is(this._applyButton)&&t.is(this._restoreButton)&&!0===this._applyButton.isDisabled()&&!0===this._restoreButton.isDisabled()&&(this._buttonStatus=!0),this._buttonStatus},disableButtons:function(){t.is(this._applyButton)&&t.is(this._restoreButton)&&(!1===this._applyButton.isDisabled()&&this._applyButton.setDisabled(!0),!1===this._restoreButton.isDisabled()&&this._restoreButton.setDisabled(!0))},enableButtons:function(){t.is(this._applyButton)&&t.is(this._restoreButton)&&(!0===this._applyButton.isDisabled()&&this._applyButton.setDisabled(!1),!0===this._restoreButton.isDisabled()&&this._restoreButton.setDisabled(!1))},enableRestoreButton:function(){t.is(this._restoreButton)&&!0===this._restoreButton.isDisabled()&&this._restoreButton.setDisabled(!1)},getButtonStatus:function(){return this._buttonStatus},reSetButtonStatus:function(){this._buttonStatus=!1},putMask:function(e){i.mask(e)},removeMask:function(e){i.unmask(e)},setPlatformID:function(e){t.is(e)&&(p.platformID=e)},getPlatformID:function(){if(t.is(p.platformID))return p.platformID},setPlatformDisplayName:function(e){t.is(e)&&(p.platformDisplayName=e)},getDataSourceList:function(e){var r=[],a=[];if(this._datasourceList.length>0)return this._datasourceList;if(t.is(p.platformID)){var i=s.getAvailableSources(p.platformID);if(t.is(i)){(e=e||{}).dataSources=i;var n=o.getValidDatasources(e);if(t.is(n)){if(t.is(n.dataSourceNames,"array")){a=n.dataSourceNames,a=d.filterSourceList(a);for(var l=0;l<a.length;l++)p._datSourceToVocabID[a[l]]=c.getVocabularyName(a[l])}t.is(n.dataSourceServices,"array")&&(r=n.dataSourceServices)}}return r.length>0&&this.getNLSValues(a,r,"ds6w:dataSource"),p._Service_Nls_promise.promise}},getNLSValues:function(e){var r={};r.dataSourceLists=e;var a=_.getNlsOfDataSources(r);if(t.is(a,"array")){var i={};i.AllDataSourcesandTypes=h.get("searchAttributes.DataSource.AllDataSourcesandTypes");for(var s=0;s<a.length;s++)i[e[s]]=a[s],p._datasourceList.push(a[s]);n.setDatasourceInternalMapping(i)}p._Service_Nls_promise.resolve(p._datasourceList)},getDatasourceInternalName:function(e){if(t.is(e))return n.getDatasourceInternalMappingValue(e)},getDatasourceDisplayName:function(e){if(t.is(e))return n.getDatasourceDisplayMappingValue(e)},updateAttributesMappingForAllDataSourcesAndTypes:function(e,r){t.is(e,"string")&&n.setAttributesInternalMappingForAllDataSourcesAndTypes(e,r)},getAttributesInternalNameForAllDataSourcesAndTypes:function(e,r){if(t.is(e))return n.getAttributesInternalMappingValueForAllDataSourcesAndTypes(e,r)},getAttributesDisplayNameForAllDataSourcesAndTypes:function(e,r){if(t.is(e))return n.getAttributesDisplayMappingValueForAllDataSourcesAndTypes(e,r)},updateTypesMapping:function(e,r){t.is(e,"string")&&n.setTypeInternalMapping(e,r)},getTypesInternalName:function(e,r){if(t.is(e))return n.getTypeInternalMappingValue(e,r)},getTypesDisplayName:function(e,r){if(t.is(e))return n.getTypeDisplayMappingValue(e,r)},updateAttributesMapping:function(e,r,a){t.is(e,"string")&&n.setAttributeInternalMapping(e,r,a)},getAttributesInternalName:function(e,r,a){if(t.is(e))return n.getAttributeInternalMapping(e,r,a)},getSettingsJSONFromTabName:function(e){if(t.is(e))return n.gateTabSettingJSON(e)},setLocalCacheForAttribute:function(e){if(t.is(e))return n.initiate_Local_Attribute_Cache(e)},setLocalCacheFor6WTags:function(e){if(t.is(e))return n.initiate_Local_6WTags_Cache(e)},getLocalCacheForAttribute:function(){return n.gate_Local_Attribute_Cache()},getLocalCacheFor6WTags:function(){return n.gate_Local_6WTags_Cache()},clearLocalCacheForAttribute:function(){return n.clear_Local_Attribute_Cache()},clearLocalCacheFor6WTags:function(){return n.clear_Local_6WTags_Cache()},getAppPredicates:function(e){if(t.is(e))return n.getAppWisePredicates(e)},setURL:function(e){this.url=e},getURL:function(){return this.url}};return p}),define("DS/SearchControlCenter/scripts/SearchcontrolColumnCusto",["UWA/Element","UWA/Core","UWA/Promise","DS/Controls/Toggle","DS/UIKIT/Input/File","DS/UIKIT/Input/Button","DS/UIKIT/Popover","DS/UIKIT/Mask","DS/MessageBus/MessageBus","DS/SNInfraUX/Logger","css!DS/SearchControlCenter/SearchControlCenter","DS/SNInfraUX/SearchControlCenterFetchService","i18n!DS/SearchControlCenter/assets/nls/SearchControlCenter.json","DS/SearchControlCenter/scripts/SearchControlCenterServices"],function(e,t,r,a,i,n,s,o,c,l,d,_,h,u){"use strict";var p={importButton:null,fileChooser:null,jsonReader:null,_uploadeJsonFileName:null,displayCustoImportButton:null,displayCustoFileChooser:null,displayCustoJsonReader:null,_displayCustoUploadeJsonFileName:null,_columnCustoMemoryObject:null,_displayNameMemoryObject:null,_showColumnCusto:!1,_showDisplayNameCusto:!1,onRenderFacet:function(t){var r=null;UWA.is(window)&&UWA.is(window.location)&&UWA.is(window.location.search,"string")&&(r=window.location.search.substring(1)),UWA.is(r,"string")&&r.length>0&&r.indexOf("AdminColumnsSearch")>=0&&(this._showColumnCusto=!0),UWA.is(r,"string")&&r.length>0&&r.indexOf("SearchDisplayName")>=0&&(this._showDisplayNameCusto=!0);var a=e.create("div",{class:"search_center_columncusto_main_div",id:"search-type-tab-view-mode"}).inject(t);if(!0===this._showColumnCusto){var s=e.create("div",{class:"search_center_general_tab_div search_center_margin",id:"search-type-display"}).inject(a),c=e.create("div",{class:"search_center_div_left_columncusto search_center_general_display_flex",id:"search-type-display-text"}).inject(s);e.create("p",{class:"search_center_right_text",text:h.get("SearchColumnCusto.ImportColumnCusto")}).inject(c);var d=e.create("div",{class:"search_center_general_tab_div search_center_margin",id:"search-type-display"}).inject(a);e.create("div",{class:"search_center_div_left_columncusto_chooser search_center_general_display_flex",id:"search-type-display-text"}).inject(d);var _=e.create("div",{class:"enterprise-dictionary-tab",id:"columncusto-tab-file-chooser",styles:{width:"90%",position:"relative"}}).inject(d),u=e.create("div",{class:"enterprise-dictionary-tab",id:"columncusto-file-import",styles:{width:"50%",position:"center","margin-left":"5px"}}).inject(d);p.fileChooser=new i({multiple:!1,buttonBefore:!1,name:"file-input",buttonClassName:"default",placeholder:"Upload Search Column Customization",buttonText:"Browse",events:{onChange:this._onFileInputChange.bind(this)}}).inject(_);var g=this;p.importButton=new n({id:"import_button_id",value:h.get("importButton.title"),className:"default",disabled:!0,events:{onClick:function(){g._OnImportClick(),l.log("inside _OnImportClick() ")}}}).inject(u);var f=e.create("div",{class:"search_center_general_tab_div search_center_margin",id:"search-column-custo-display"}).inject(a),m=e.create("div",{class:"search_center_div_left_columncusto search_center_general_display_flex"}).inject(f);e.create("p",{class:"search_center_right_text",id:"search-column-custo-display-text"}).inject(m)}if(!0===this._showDisplayNameCusto){var C=e.create("div",{class:"search_center_general_tab_div search_center_margin",id:"search-type-display"}).inject(a),v=e.create("div",{class:"search_center_div_left_columncusto search_center_general_display_flex",id:"search-type-display-text"}).inject(C);e.create("p",{class:"search_center_right_text",text:h.get("SearchColumnCusto.ImportDisplayNameCusto")}).inject(v);var y=e.create("div",{class:"search_center_general_tab_div search_center_margin",id:"search-type-display"}).inject(a);e.create("div",{class:"search_center_div_left_columncusto_chooser search_center_general_display_flex",id:"search-type-display-text"}).inject(y);var b=e.create("div",{class:"enterprise-dictionary-tab",id:"columncusto-tab-file-chooser",styles:{width:"90%",position:"relative"}}).inject(y),S=e.create("div",{class:"enterprise-dictionary-tab",id:"columncusto-file-import",styles:{width:"50%",position:"center","margin-left":"5px"}}).inject(y);p.displayCustoFileChooser=new i({multiple:!1,buttonBefore:!1,name:"file-input",buttonClassName:"default",placeholder:h.get("SearchColumnCusto.UploadDisplayNameCusto"),buttonText:"Browse",events:{onChange:this._onDisplayNameFileInputChange.bind(this)}}).inject(b);g=this;p.displayCustoImportButton=new n({id:"import_button_id",value:h.get("importButton.title"),className:"default",disabled:!0,events:{onClick:function(){g._OnDisplayNameImportClick(),l.log("inside _OnDisplayNameImportClick() ")}}}).inject(S);var x=e.create("div",{class:"search_center_general_tab_div search_center_margin",id:"search-column-custo-display"}).inject(a),D=e.create("div",{class:"search_center_div_left_columncusto search_center_general_display_flex"}).inject(x);e.create("p",{class:"search_center_right_text",id:"search-displayname-custo-display-text"}).inject(D)}o.unmask(widget.body)},_onFileInputChange:function(e){var r=e.target.files[0].name;(this._uploadeJsonFileName=r,t.is(r,"string"))&&("json"===r.slice(2+(r.lastIndexOf(".")-1>>>0))?"undefined"!=typeof FileReader&&(p.jsonReader=new FileReader,p.jsonReader.readAsText(e.target.files[0]),p.importButton.enable()):(p.importButton.disable(),p.fileChooser.clear(),alert(h.get("wrongJsonFileTypeSelectionWarning"))))},_OnImportClick:function(){document.getElementById("search-column-custo-display-text").innerHTML="The column custo file to upload: "+this._uploadeJsonFileName,p.importButton.disable(),u.enableButtons()},_onDisplayNameFileInputChange:function(e){var r=e.target.files[0].name;(this._displayCustoUploadeJsonFileName=r,t.is(r,"string"))&&("json"===r.slice(2+(r.lastIndexOf(".")-1>>>0))?"undefined"!=typeof FileReader&&(p.displayCustoJsonReader=new FileReader,p.displayCustoJsonReader.readAsText(e.target.files[0]),p.displayCustoImportButton.enable()):(p.displayCustoImportButton.disable(),p.fileChooser.clear(),alert(h.get("wrongJsonFileTypeSelectionWarning"))))},_OnDisplayNameImportClick:function(){document.getElementById("search-displayname-custo-display-text").innerHTML="The display name custo file to upload: "+this._displayCustoUploadeJsonFileName,p.displayCustoImportButton.disable(),u.enableButtons()},getTabInputsToStore:function(){t.is(this._uploadeJsonFileName)&&(document.getElementById("search-column-custo-display-text").innerHTML="The column custo file applied: "+this._uploadeJsonFileName,p.importButton.disable()),t.is(this._displayCustoUploadeJsonFileName)&&(document.getElementById("search-displayname-custo-display-text").innerHTML="The display name custo file applied: "+this._displayCustoUploadeJsonFileName,p.displayCustoImportButton.disable()),u.enableRestoreButton();var e={},r={};if(t.is(this._uploadeJsonFileName)?(t.is(p.jsonReader.result)&&t.is(p.jsonReader.result)&&((e=JSON.parse(p.jsonReader.result)).uploadedColumnCustoFileName=this._uploadeJsonFileName),r.searchColumnCustoInputs=e):r.searchColumnCustoInputs=this._columnCustoMemoryObject,t.is(this._displayCustoUploadeJsonFileName)){var a={};t.is(p.displayCustoJsonReader.result)&&t.is(p.displayCustoJsonReader.result)&&((a=JSON.parse(p.displayCustoJsonReader.result)).uploadedDisplayCustoFileName=this._displayCustoUploadeJsonFileName),r.searchDisplayCustoInputs=a}else r.searchDisplayCustoInputs=this._displayNameMemoryObject;return r},onResetTab:function(e){_.getSearchSettings({tenantID:u.platformID}).then(function(e){var r;let a="",i="";if((r=t.is(e,"string")?JSON.parse(e):e).hasOwnProperty("column_custo")){var n=r.column_custo;t.is(n)&&n.hasOwnProperty("searchColumnCustoInputs")&&(p._columnCustoMemoryObject=n.searchColumnCustoInputs,t.is(p._columnCustoMemoryObject)&&t.is(p._columnCustoMemoryObject.uploadedColumnCustoFileName,"string")&&(a=p._columnCustoMemoryObject.uploadedColumnCustoFileName)),t.is(n)&&n.hasOwnProperty("searchDisplayCustoInputs")&&(p._displayNameMemoryObject=n.searchDisplayCustoInputs,t.is(p._displayNameMemoryObject)&&t.is(p._displayNameMemoryObject.uploadedDisplayCustoFileName,"string")&&(i=p._displayNameMemoryObject.uploadedDisplayCustoFileName))}!0===p._showColumnCusto&&(document.getElementById("search-column-custo-display-text").innerHTML=a.trim().length>0?"Current applied custo file: "+a:"There is no custom file applied yet."),!0===p._showDisplayNameCusto&&(document.getElementById("search-displayname-custo-display-text").innerHTML=i.trim().length>0?"Current applied display custo file: "+i:"There is no custom file applied yet.")},function(){}),this._uploadeJsonFileName=null,!0===p._showColumnCusto&&(p.fileChooser.clear(),p.importButton.disable())}};return p}),define("DS/SearchControlCenter/scripts/ControlledVocabulary/ControlledVocabularyServices",["UWA/Core","UWA/Promise","DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/WAFData/WAFData","DS/SNInfraUX/SearchUtils","DS/SearchControlCenter/scripts/SearchControlCenterServices","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(e,t,r,a,i,n,s){"use strict";return{_tenantOntologies:{},_tenantCommunities:{},_fetchSwymCommunities:function(e,t){var r=this;let a=n.getPlatformID(),i=this._tenantCommunities[a];return i||(i=new Promise(function(e){r._apiCalltoFetchSwymCommunities(function(t){e(t)},function(t){e([])})}),this._tenantCommunities[a]=i),i},_apiCalltoFetchSwymCommunities:function(t,r){let o=n.getPlatformID();s.getServiceUrl({serviceName:"3DSearch",platformId:o,onComplete:function(n){!function(n){var s={label:"3DSearch-"+i.getUserId()+"-"+(new Date).getTime(),query:'[ds6w:type]:"swym:Community"',with_nls:!1,with_synthesis:!1,with_synthesis_hierarchical:!1,with_indexing_date:!1,select_file:[],source:["swym"],select_predicate:["ds6w:label"],tenant:o,nresults:1e3,refine:{},specific_source_parameter:{}},c={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},data:e.Json.encode(s),url:n+"/search",onComplete:function(e){try{e=JSON.parse(e)}catch(t){e=t}return t(e.results)},onFailure:function(e){try{e=JSON.parse(e)}catch(t){e=t}return r(e)}};a.authenticatedRequest(c.url,c)}(n)},onFailure:function(){r("FAILED to retrieve 3DSearch url for tenant")}})},_fetchOntologies:function(){let e=this,t=n.getPlatformID();var r=this._tenantOntologies[t];return r||(r=new Promise(function(t){e._apiCalltoFetchOntologies(function(e){t(e)},function(e){t([])})}),this._tenantOntologies[t]=r),r},_apiCalltoFetchOntologies:function(e,t){var r=n.getPlatformID();s.getServiceUrl({serviceName:"ontology",platformId:r,onComplete:function(r){!function(r){var i={method:"GET",headers:{Accept:"application/json"},url:r+"/3drdfpersist/resources/v1/ontologies",onComplete:function(t){try{t=JSON.parse(t)}catch(e){t=e}return e(t)},onFailure:function(e){try{e=JSON.parse(e)}catch(t){e=t}return t(e)}};a.authenticatedRequest(i.url,i)}(r)},onFailure:function(){resolve([])}})}}}),define("DS/SearchControlCenter/scripts/SearchcontrolSearchAttributes",["UWA/Element","UWA/Core","UWA/Promise","DS/Controls/Toggle","DS/Controls/ComboBox","DS/UIKIT/Popover","DS/UIKIT/Mask","DS/MessageBus/MessageBus","DS/SNInfraUX/SNVocabAccess","DS/FedDictionaryAccess/FedDictionaryAccessAPI","css!DS/SearchControlCenter/SearchControlCenter","i18n!DS/SearchControlCenter/assets/nls/SearchControlCenter.json","DS/SearchControlCenter/scripts/SearchControlCenterServices"],function(e,t,r,a,i,n,s,o,c,l,d,_,h){"use strict";var u={datasourceComboBox:null,selectTypeComboBox:null,preferredAttrCard:null,preferredAttrComboBox:null,divAdvanceSearchSpan:null,divDataSourceDisplaySpan:null,moreAttrCard:null,moreAttrComboBox:null,_attributesMap:{},_SearchAttributes_promise:r.deferred(),getAttributesPromise:function(){return this._SearchAttributes_promise.promise},onRenderFacet:function(r){var a=e.create("div",{class:"search_center_secondary_div",id:"search-center-Attriute"}).inject(r);u.divDataSourceDisplaySpan=e.create("div",{class:"search_center_general_tab_div search_center_margin search_center_disable",id:"search-type-display"}).inject(a);var o=e.create("div",{class:"search_center_div_left search_center_general_display_flex",id:"search-type-display-text"}).inject(u.divDataSourceDisplaySpan),l=e.create("div",{class:"search_center_div_right search_center_general_display_flex",id:"search-type-display-combo"}).inject(u.divDataSourceDisplaySpan);u.datasourceComboBox=new i({placeholder:_.get("Choose_data_source"),touchMode:!0,enableSearchFlag:!0}).inject(l),l.setStyle("display","grid"),u.datasourceComboBox.elements.container.setStyle("max-width","unset");var d=[],p=h.getDataSourceList();if(t.is(p,"array")){let e=p.length;for(let t=0;t<e;t++)d.push(p[t]);u.datasourceComboBox.elementsList=d}if(h._datasourceList.length>0){let e=h._datasourceList;if(t.is(e,"array")){let t=e.length;for(let r=0;r<t;r++)d.push(e[r]);u.datasourceComboBox.elementsList=d}}else h.getDataSourceList().then(function(e){if(t.is(e,"array")){let t=e.length;for(let r=0;r<t;r++)d.push(e[r]);u.datasourceComboBox.elementsList=d}});var g=this;u.datasourceComboBox.addEventListener("change",function(){h.enableButtons(),u.selectTypeComboBox.disabled=!1,u.preferredAttrComboBox.disabled=!0,u.moreAttrComboBox.disabled=!0,s.mask(v),g.cleanUpAttributeCards();var e=h.getDatasourceInternalName(u.datasourceComboBox.currentValue),r={};r.vocabId=h._datSourceToVocabID[e],r.tenantId=h.platformID,c.loadVocabularyClasses(r,function(r){if(r.classInfos.length>0){var a=[],i={};for(let e=0;e<r.classInfos.length;e++)t.is(r.classInfos[e].nlsName,"string")&&t.is(r.classInfos[e].uri)&&(a.push(r.classInfos[e].nlsName),i[r.classInfos[e].uri]=r.classInfos[e].nlsName);h.updateTypesMapping(e,i),u.selectTypeComboBox.elementsList=a}else{u.selectTypeComboBox.disabled=!0;var n=h.createWdgAlert(),o=_.get("SearchType.NoTypesWarning");n.add({className:"warning applyChangesAlert",message:o})}s.unmask(v),u._SearchAttributes_promise.resolve()})}),e.create("p",{class:"search_center_text",text:_.get("searchAttributes.DataSource")}).inject(o);var f=e.create("span",{class:"fonticon fonticon-info search_center_margin_icon"}).inject(u.divDataSourceDisplaySpan);new n({target:f,trigger:"hover",animate:"true",position:"top",body:_.get("searchAttributes.DataSource.popover"),title:""}),u.divAdvanceSearchSpan=e.create("div",{class:"search_center_disable",id:"search-type-display"}).inject(a);var m=e.create("div",{class:"search_center_general_tab_div",id:"search-type-display"}).inject(u.divAdvanceSearchSpan),C=e.create("div",{class:"search_center_div_left search_center_general_display_flex"}).inject(m),v=e.create("div",{class:"search_center_div_right search_center_general_display_flex",id:"search-preferred_attrs_combo"}).inject(m);e.create("p",{class:"search_center_text",text:_.get("searchAttributes.selectType")}).inject(C);var y=e.create("span",{class:"fonticon fonticon-info search_center_margin_icon"}).inject(m);new n({target:y,trigger:"hover",animate:"true",position:"top",body:_.get("searchAttributes.selectType.popover"),title:""}),u.selectTypeComboBox=new i({placeholder:_.get("Choose_type"),touchMode:!0,disabled:!0,enableSearchFlag:!0}).inject(v),v.setStyle("display","grid"),u.selectTypeComboBox.elements.container.setStyle("max-width","unset"),u.selectTypeComboBox.addEventListener("change",function(){h.enableButtons(),s.mask(T),s.mask(P);var e=h.getDatasourceInternalName(u.datasourceComboBox.currentValue),r=h.getTypesInternalName(e,u.selectTypeComboBox.currentValue);if(t.is(r)){var a={};a.className=r,a.tenantId=h.platformID,c.loadRelevantPredicates(a,function(a){if(g.cleanUpAttributeCards(),a.vocabularyPredicateInfo.length>0){a.vocabularyPredicateInfo.sort(function(e,r){var a=e.nlsName;t.is(a)||(a=e.uri),a=a.toUpperCase();var i=r.nlsName;return t.is(i)||(i=r.uri),a<(i=i.toUpperCase())?-1:a>i?1:0}),u.preferredAttrComboBox.disabled=!1,u.moreAttrComboBox.disabled=!1;var i=[];for(let e=0;e<a.vocabularyPredicateInfo.length;e++)if(t.is(a.vocabularyPredicateInfo[e].nlsName,"string")&&t.is(a.vocabularyPredicateInfo[e].uri)){if("ds6w:label"===a.vocabularyPredicateInfo[e].uri||"ds6w:identifier"===a.vocabularyPredicateInfo[e].uri||"ds6w:modified"===a.vocabularyPredicateInfo[e].uri||"ds6w:description"===a.vocabularyPredicateInfo[e].uri||"ds6w:responsible"===a.vocabularyPredicateInfo[e].uri||"ds6w:created"===a.vocabularyPredicateInfo[e].uri)continue;i.push(a.vocabularyPredicateInfo[e].nlsName),u._attributesMap[a.vocabularyPredicateInfo[e].uri]=a.vocabularyPredicateInfo[e].nlsName}h.updateAttributesMapping(e,r,u._attributesMap),u.preferredAttrComboBox.elementsList=i,u.moreAttrComboBox.elementsList=i;var n=h.getLocalCacheForAttribute();if(t.is(n)&&n.length>0)for(var o=0;o<n.length;o++){var c=n[o];if(r===c.uri&&e===c.source){var l=c.predicates;if(t.is(l)&&l.length>0){S.className="search_center_set_left_div search_center_top_margin search_center_general_display_flex";for(var d=0;d<l.length;d++){var _=c.predicates[d].uri;let t=u._attributesMap[_],a={cardDiv:u.preferredAttrCard,datasource:e,type:r,textOnCard:t,uri:_,tabName:"SearchControl_SearchAttributes",deleteOption:!0};h.buildCardBlockRow(a)}}var p=c.excluded_predicates;if(t.is(p)&&p.length>0){j.className="search_center_set_left_div search_center_top_margin search_center_general_display_flex";for(var f=0;f<p.length;f++){var m=c.excluded_predicates[f].uri;let t=u._attributesMap[m],a={cardDiv:u.moreAttrCard,datasource:e,type:r,textOnCard:t,uri:m,tabName:"SearchControl_SearchAttributes",deleteOption:!0};h.buildCardBlockRow(a)}}}}}else u.preferredAttrComboBox.disabled=!0,u.moreAttrComboBox.disabled=!0;s.unmask(T),s.unmask(P)})}else s.unmask(T),s.unmask(P)});var b=e.create("div",{class:"search_center_general_tab_div search_center_margin"}).inject(u.divAdvanceSearchSpan),S=e.create("div",{class:"search_center_div_left search_center_margin search_center_general_display_flex"}).inject(b),x=e.create("div",{class:"search_center_div_right"}).inject(b);e.create("p",{class:"search_center_text_normal",text:_.get("searchAttributes.Preffered_Attributes")}).inject(S);var D=e.create("span",{class:"fonticon fonticon-info search_center_margin_CardSpan_icon"}).inject(b);new n({target:D,trigger:"hover",animate:"true",position:"top",body:_.get("searchAttributes.Preffered_Attributes.popover"),title:""});var A=e.create("div",{class:"search_center_div_datasource search_center_only_grid search_center_bottom_margin search_center_top_margin"}).inject(x),T=e.create("div",{class:"search_center_div_type_combo search_center_only_grid",id:"SearchAttributes-preferred_attrs_combo"}).inject(A),w=["Datasource","Type","Title","Name","Modification date","Creation date"];u.preferredAttrComboBox=new i({elementsList:w,placeholder:_.get("searchAttributes.Add_preferredAttr"),touchMode:!0,disabled:!0}).inject(T),u.preferredAttrComboBox.elements.container.setStyle("max-width","unset"),u.preferredAttrComboBox.addEventListener("change",function(){var e=u.moreAttrCard.childNodes.length,r=[];for(let t=0;t<e;t++)r.push(u.moreAttrCard.childNodes[t].getAttribute("sccURI"));var a=u.preferredAttrCard.childNodes.length,i=[];for(let e=0;e<a;e++)i.push(u.preferredAttrCard.childNodes[e].getAttribute("sccURI"));var n=u.preferredAttrComboBox.currentValue;if(t.is(n,"string")){var s,o=h.getDatasourceInternalName(u.datasourceComboBox.currentValue),c=h.getTypesInternalName(o,u.selectTypeComboBox.currentValue);s=h.getAttributesInternalName(o,c,n);var l=!1,d=null;if(t.is(s))if(r.length>0&&r.indexOf(s)>-1&&(d=_.get("searchAttributes.preferredAttrWarning"),l=!0),i.length>0&&!1===l&&i.indexOf(s)>-1&&(d=_.get("searchAttributes.AttributeWarning"),l=!0),!1===l){S.className="search_center_set_left_div search_center_top_margin search_center_general_display_flex";var p={cardDiv:u.preferredAttrCard,datasource:o,type:c,textOnCard:n,tabName:"SearchControl_SearchAttributes",deleteOption:!0};h.buildCardBlockRow(p),h.enableButtons()}else{var g=h.createWdgAlert();g.inject(widget.body,"top"),g.add({className:"warning applyChangesAlert",message:d})}u.preferredAttrComboBox.selectedIndex=-1}});var I=e.create("div",{class:"search_center_div_card search_center_top_margin"}).inject(x);u.preferredAttrCard=e.create("div",{class:"card search_center_card_panel",id:"SearchAttributes_preferredAttr"}).inject(I);var N=e.create("div",{class:"search_center_general_tab_div "}).inject(u.divAdvanceSearchSpan),j=e.create("div",{class:"search_center_div_left search_center_margin search_center_general_display_flex"}).inject(N),O=e.create("div",{class:"search_center_div_right"}).inject(N);e.create("p",{class:"search_center_text_normal",text:_.get("searchAttributes.More_Attributes")}).inject(j);var W=e.create("span",{class:"fonticon fonticon-info search_center_margin_CardSpan_icon"}).inject(N);new n({target:W,trigger:"hover",animate:"true",position:"top",body:_.get("searchAttributes.More_Attributes.popover"),title:""});var B=e.create("div",{class:"search_center_div_datasource search_center_bottom_margin search_center_only_grid search_center_top_margin"}).inject(O),P=e.create("div",{class:"search_center_div_type_combo search_center_only_grid",id:"SearchAttributes_more_attrs_combo"}).inject(B);w=["Datasource","Type","Title","Name","Modification date","Creation date"];u.moreAttrComboBox=new i({elementsList:w,placeholder:_.get("searchAttributes.Add_moreAttr"),nbDisplayedElements:w.length,touchMode:!0,disabled:!0}).inject(P),u.moreAttrComboBox.elements.container.setStyle("max-width","unset"),u.moreAttrComboBox.addEventListener("change",function(){var e=u.preferredAttrCard.childNodes.length,r=[];for(let t=0;t<e;t++)r.push(u.preferredAttrCard.childNodes[t].getAttribute("sccURI"));var a=u.moreAttrCard.childNodes.length,i=[];for(let e=0;e<a;e++)i.push(u.moreAttrCard.childNodes[e].getAttribute("sccURI"));var n=u.moreAttrComboBox.currentValue;if(t.is(n,"string")){var s,o=h.getDatasourceInternalName(u.datasourceComboBox.currentValue),c=h.getTypesInternalName(o,u.selectTypeComboBox.currentValue);s=h.getAttributesInternalName(o,c,n);var l=!1,d=null;if(t.is(s))if(r.length>0&&r.indexOf(s)>-1&&(d=_.get("searchAttributes.excludeAttrWarning"),l=!0),i.length>0&&!1===l&&i.indexOf(s)>-1&&(d=_.get("searchAttributes.AttributeWarning"),l=!0),!1===l){j.className="search_center_set_left_div search_center_top_margin search_center_general_display_flex";var p={cardDiv:u.moreAttrCard,datasource:o,type:c,textOnCard:n,tabName:"SearchControl_SearchAttributes",deleteOption:!0};h.buildCardBlockRow(p),h.enableButtons()}else{var g=h.createWdgAlert();g.inject(widget.body,"top"),g.add({className:"warning applyChangesAlert",message:d})}u.moreAttrComboBox.selectedIndex=-1}});var F=e.create("div",{class:"search_center_div_card search_center_top_margin"}).inject(O);u.moreAttrCard=e.create("div",{class:"card search_center_card_panel",id:"SearchAttributes_moreAttr"}).inject(F)},getTabInputsToStore:function(){var e={},r=[],a=h.getLocalCacheForAttribute();if(t.is(a,"array")&&a.length>0)r=a;else{var i={};i.source=h.getDatasourceInternalName(u.datasourceComboBox.currentValue),i.uri=h.getTypesInternalName(i.source,u.selectTypeComboBox.currentValue);for(var n=[],s=u.preferredAttrCard.childNodes.length,o=0;o<s;o++){var c={};c.uri=u.preferredAttrCard.childNodes[o].getAttribute("sccURI"),t.is(c.uri)&&n.push(c)}i.predicates=n;for(var l=[],d=u.moreAttrCard.childNodes.length,_=0;_<d;_++){var p={};p.uri=u.moreAttrCard.childNodes[_].getAttribute("sccURI"),t.is(p.uri)&&l.push(p)}i.excluded_predicates=l,r.push(i)}return e["ds6w:type"]=r,e},isThisNotARootPredicates:function(e){return""!==e.subPropertyOf},filter6WRootPredicates:function(e){var t,r={},a={},i=[];if(e.ds6w.properties.length>0){var n=(t=e.ds6w.properties).length;if(void 0!==t&&n>0){e.ds6w.properties=t.filter(this.isThisNotARootPredicates),t.sort(function(e,t){var r=e.label;r=r.toUpperCase();var a=t.label;return r<(a=a.toUpperCase())?-1:r>a?1:0});for(var s=0;s<n;s++)"ds6w:project"!==t[s].curi&&"ds6w:community"!==t[s].curi&&(i.push(t[s].label),a[t[s].curi]=t[s].label,u._attributesMap[t[s].curi]=t[s].label)}}return r.predicates=i,r.typeMap=a,r},getPredicatesObject:function(){return new r(function(e,t){var r={onComplete:function(t){UWA.log("Got a predicates result!"+t),e(t)},onFailure:function(e){UWA.log("predicates service request Fail!"+e),t(e)},tenantId:h.platformID,lang:widget.lang,apiVersion:"R2019x"};l.getFedProperties(r)})},cleanUpAttributeCards:function(){for(var e=u.preferredAttrCard.childElementCount-1;e>=0;e--)u.preferredAttrCard.childNodes[e].destroy();u.preferredAttrCard.parentElement.parentElement.parentElement.children[0].addClassName("search_center_div_left search_center_margin search_center_general_display_flex");for(var t=u.moreAttrCard.childElementCount-1;t>=0;t--)u.moreAttrCard.childNodes[t].destroy();u.moreAttrCard.parentElement.parentElement.parentElement.children[0].addClassName("search_center_div_left search_center_margin search_center_general_display_flex")},onResetTab:function(e){var r;r=t.is(e,"string")?JSON.parse(e):e,h.clearLocalCacheForAttribute();if(this.cleanUpAttributeCards(),t.is(r)&&r.hasOwnProperty("ds6w:type")){var a=r["ds6w:type"];if(t.is(a,"array")){var i=t.clone(a,!0);h.setLocalCacheForAttribute(i);var n=a[a.length-1],s=n.source,o=n.uri,c=n.predicates,l=n.excluded_predicates,d=h.getDatasourceDisplayName(s);u.datasourceComboBox.elementsList.length>0&&(u.datasourceComboBox.currentValue=d,u.getAttributesPromise().then(function(){if(u.selectTypeComboBox.elementsList.length>0){var e=h.getTypesDisplayName(s,o);if(t.is(e)&&e===u.selectTypeComboBox.currentValue){if(t.is(c)&&c.length>0){u.preferredAttrCard.parentElement.parentElement.parentElement.children[0].className="search_center_set_left_div search_center_top_margin search_center_general_display_flex";for(let e=0;e<c.length;e++){let t=c[e].uri,r=u._attributesMap[t],a={cardDiv:u.preferredAttrCard,datasource:s,type:o,textOnCard:r,uri:t,tabName:"SearchControl_SearchAttributes",deleteOption:!0};h.buildCardBlockRow(a)}}if(t.is(l)&&l.length>0){u.moreAttrCard.parentElement.parentElement.parentElement.children[0].className="search_center_set_left_div search_center_top_margin search_center_general_display_flex";for(let e=0;e<l.length;e++){let t=l[e].uri,r=u._attributesMap[t],a={cardDiv:u.moreAttrCard,datasource:s,type:o,textOnCard:r,uri:t,tabName:"SearchControl_SearchAttributes",deleteOption:!0};h.buildCardBlockRow(a)}}}else u.selectTypeComboBox.currentValue=e,!1===h.isButtonDisabled()&&h.disableButtons()}}))}}},enableUI:function(){u.divDataSourceDisplaySpan.removeClassName("search_center_disable"),u.divAdvanceSearchSpan.removeClassName("search_center_disable")},disableUI:function(){u.divDataSourceDisplaySpan.addClassName("search_center_disable"),u.divAdvanceSearchSpan.addClassName("search_center_disable")}};return u}),define("DS/SearchControlCenter/scripts/SearchcontrolSearchTypes",["UWA/Element","UWA/Core","DS/Controls/Toggle","DS/Controls/ComboBox","DS/UIKIT/Popover","DS/UIKIT/Mask","DS/SearchControlCenter/scripts/SearchcontrolSearchAttributes","css!DS/SearchControlCenter/SearchControlCenter","i18n!DS/SearchControlCenter/assets/nls/SearchControlCenter.json","DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/SNInfraUX/SearchLogin","DS/SearchControlCenter/scripts/SearchControlCenterServices","DS/SNInfraUX/SNVocabAccess"],function(e,t,r,a,i,n,s,o,c,l,d,_,h){"use strict";var u={datasourceComboBox:null,typeComboBox:null,prefferedTypeDiv:null,moreTypeDiv:null,moreTypesdatasourceComboBox:null,moreTypestypeComboBox:null,defaultDatasourceComboBox:null,defaultTypeComboBox:null,checkboxInstanceSearch:null,checkboxTypeDisplay:null,preferredTypesCard:null,moreTypesCard:null,preferredTypesMap:{},excludeTypesMap:{},listofItemsArray:[],listofDatasourcesArray:[],_defaultDatasource:null,onRenderFacet:function(o){var l=e.create("div",{class:"search_center_main_div",id:"search-center-Types"}).inject(o),d=e.create("div",{class:"search_center_general_tab_div search_center_margin",id:"search-type-display"}).inject(l),p=e.create("div",{class:"search_center_div_left search_center_general_display_flex",id:"search-type-display-text"}).inject(d),g=e.create("div",{class:"search_center_div_right search_center_general_display_flex",id:"search-type-display-toggle"}).inject(d);u.checkboxTypeDisplay=new r({type:"checkbox",label:c.get("searchType.typeDisplay"),className:"primary",touchMode:"true"}).inject(g),e.create("p",{class:"search_center_text",text:c.get("searchType.Title")}).inject(p);var f=e.create("div",{class:"search_center_general_tab_div search_center_margin",id:"search-instance-search"}).inject(l),m=e.create("div",{class:"search_center_div_left search_center_general_display_flex",id:"search-type-display-text"}).inject(f),C=e.create("div",{class:"search_center_div_right search_center_general_display_flex",id:"search-type-instance-toggle"}).inject(f);u.checkboxInstanceSearch=new r({type:"checkbox",label:c.get("searchType.instanceSearch"),className:"primary",touchMode:"true"}).inject(C),e.create("p",{class:"search_center_text",text:c.get("searchType.instanceSearch.Title")}).inject(m);var v=e.create("div",{class:"search_center_general_tab_div search_center_margin search_center_disable",id:"search-type-display"}).inject(l),y=e.create("div",{class:"search_center_div_left search_center_general_display_flex search_center_margin ",id:"search-type-display-text"}).inject(v),b=e.create("div",{class:"search_center_div_right search_center_general_display_flex search_center_margin",id:"search-type-display-combo"}).inject(v);u.defaultDatasourceComboBox=new a({placeholder:c.get("Choose_default_datasource"),touchMode:!0,enableSearchFlag:!0}).inject(b),b.setStyle("display","grid"),u.defaultDatasourceComboBox.elements.container.setStyle("max-width","unset"),u.defaultDatasourceComboBox.addEventListener("change",function(){_.enableButtons();var e=c.get("General.None");u.defaultDatasourceComboBox.currentValue===e&&(u.defaultDatasourceComboBox.selectedIndex=-1)}),e.create("p",{class:"search_center_text_normal",text:c.get("SearchType.DefaultDataSource")}).inject(y);var S=e.create("span",{class:"fonticon fonticon-info search_center_margin_icon"}).inject(v);new i({target:S,trigger:"hover",animate:"true",position:"top",body:c.get("SearchType.DefaultDataSource.popover"),title:""});var x=e.create("div",{class:"search_center_general_tab_div search_center_margin search_center_disable search_preferred_types",id:"search-type-display"}).inject(l),D=e.create("div",{class:"search_center_div_left search_center_margin search_center_general_display_flex",id:"search-type-display-text"}).inject(x);e.create("p",{class:"search_center_text_normal",text:c.get("searchType.Prefferedtypes.Title")}).inject(D);var A=e.create("div",{class:"search_center_div_right",id:"search-type-display-text"}).inject(x),T=e.create("span",{class:"fonticon fonticon-info search_center_margin_CardSpan_icon"}).inject(x);new i({target:T,trigger:"hover",animate:"true",position:"top",body:c.get("searchType.Prefferedtypes.popover"),title:""});var w=e.create("div",{class:"search_center_div_datasource search_center_bottom_margin search_center_top_margin search_center_general_display_flex",id:"search-type-display-text"}).inject(A),I=e.create("div",{class:"search_center_div_type_combo search_center_general_display_flex",id:"search-type-display-text"}).inject(w);u.datasourceComboBox=new a({placeholder:c.get("Choose_data_source"),touchMode:!0}).inject(I),u.datasourceComboBox.addEventListener("change",function(){u.typeComboBox.disabled=!1,n.mask(u.prefferedTypeDiv);var e=_.getDatasourceInternalName(u.datasourceComboBox.currentValue),r={};r.vocabId=_._datSourceToVocabID[e],r.tenantId=_.platformID,r.lang=_._language,h.loadVocabularyClasses(r,function(r){if(r.classInfos.length>0){for(var a=[],i={},s=0;s<r.classInfos.length;s++)t.is(r.classInfos[s].nlsName,"string")&&t.is(r.classInfos[s].uri)&&(a.push(r.classInfos[s].nlsName),i[r.classInfos[s].uri]=r.classInfos[s].nlsName);_.updateTypesMapping(e,i),u.typeComboBox.elementsList=a}else{u.typeComboBox.disabled=!0;var o=_.createWdgAlert(),l=c.get("SearchType.NoTypesWarning");o.inject(widget.body,"top"),o.add({className:"warning applyChangesAlert",message:l})}n.unmask(u.prefferedTypeDiv)})}),u.prefferedTypeDiv=e.create("div",{class:"search_center_div_type_combo search_center_div_left_margin search_center_general_display_flex",id:"search-type-display-text"}).inject(w),u.typeComboBox=new a({placeholder:c.get("Add_preferred_types"),touchMode:!0}).inject(u.prefferedTypeDiv),u.typeComboBox.disabled=!0,u.typeComboBox.addEventListener("change",function(){var e=u.moreTypesCard.childNodes.length,r=[];for(let t=0;t<e;t++)r.push(u.moreTypesCard.childNodes[t].getAttribute("sccURI"));var a=u.preferredTypesCard.childNodes.length,i=[];for(let e=0;e<a;e++)i.push(u.preferredTypesCard.childNodes[e].getAttribute("sccURI"));D.className="search_center_set_left_div search_center_top_margin search_center_general_display_flex";var n=u.typeComboBox.currentValue;if(t.is(n,"string")){var s=_.getDatasourceInternalName(u.datasourceComboBox.currentValue),o=_.getTypesInternalName(s,n),l=!1,d=null;if(t.is(o))if(r.length>0&&r.indexOf(o)>-1&&(d=c.get("SearchType.preferredTypeWarning"),l=!0),i.length>0&&!1===l&&i.indexOf(o)>-1&&(d=c.get("searchType.TypeWarning"),l=!0),!1===l){var h={cardDiv:u.preferredTypesCard,datasource:s,textOnCard:n,deleteOption:!0};_.buildCardBlockRow(h),_.enableButtons()}else{var p=_.createWdgAlert();p.inject(widget.body,"top"),p.add({className:"warning applyChangesAlert",message:d})}u.typeComboBox.selectedIndex=-1}});var N=e.create("div",{class:"search_center_div_card search_center_top_margin search_center_top_margin",id:"search-type-display-text"}).inject(A);u.preferredTypesCard=e.create("div",{class:"card search_center_card_panel",id:"SearchTypes_preferredType"}).inject(N);var j=e.create("div",{class:"search_center_general_tab_div search_center_margin search_center_disable search_excluded_types",id:"search-type-display"}).inject(l),O=e.create("div",{class:"search_center_div_left search_center_margin search_center_general_display_flex",id:"search-type-display-text"}).inject(j);e.create("p",{class:"search_center_text_normal",text:c.get("searchType.Excludedtype.Title")}).inject(O);var W=e.create("div",{class:"search_center_div_right",id:"search-type-display-text"}).inject(j),B=e.create("span",{class:"fonticon fonticon-info search_center_margin_CardSpan_icon"}).inject(j);new i({target:B,trigger:"hover",animate:"true",position:"top",body:c.get("searchType.Excludedtype.popover"),title:""});var P=e.create("div",{class:"search_center_div_datasource search_center_bottom_margin search_center_top_margin search_center_general_display_flex",id:"search-type-display-text"}).inject(W),F=e.create("div",{class:"search_center_div_type_combo search_center_general_display_flex",id:"search-type-display-text"}).inject(P);u.moreTypesdatasourceComboBox=new a({placeholder:c.get("Choose_data_source"),touchMode:!0}).inject(F),u.moreTypesdatasourceComboBox.addEventListener("change",function(){u.moreTypestypeComboBox.disabled=!1,n.mask(u.moreTypeDiv);var e=_.getDatasourceInternalName(u.moreTypesdatasourceComboBox.currentValue),r={};r.vocabId=_._datSourceToVocabID[e],r.tenantId=_.platformID,r.lang=_._language,h.loadVocabularyClasses(r,function(r){if(r.classInfos.length>0){for(var a=[],i={},s=0;s<r.classInfos.length;s++)t.is(r.classInfos[s].nlsName,"string")&&t.is(r.classInfos[s].uri)&&(a.push(r.classInfos[s].nlsName),i[r.classInfos[s].uri]=r.classInfos[s].nlsName);_.updateTypesMapping(e,i),u.moreTypestypeComboBox.elementsList=a}else{u.moreTypestypeComboBox.disabled=!0;var o=_.createWdgAlert(),l=c.get("SearchType.NoTypesWarning");o.inject(widget.body,"top"),o.add({className:"warning applyChangesAlert",message:l})}n.unmask(u.moreTypeDiv)})}),u.moreTypeDiv=e.create("div",{class:"search_center_div_type_combo search_center_div_left_margin search_center_general_display_flex",id:"search-type-display-text"}).inject(P),u.moreTypestypeComboBox=new a({placeholder:c.get("Add_excluded_types"),touchMode:!0}).inject(u.moreTypeDiv),u.moreTypestypeComboBox.disabled=!0,u.moreTypestypeComboBox.addEventListener("change",function(){var e=u.preferredTypesCard.childNodes.length,r=[];for(let t=0;t<e;t++)r.push(u.preferredTypesCard.childNodes[t].getAttribute("sccURI"));var a=u.moreTypesCard.childNodes.length,i=[];for(let e=0;e<a;e++)i.push(u.moreTypesCard.childNodes[e].getAttribute("sccURI"));O.className="search_center_set_left_div search_center_top_margin search_center_general_display_flex";var n=u.moreTypestypeComboBox.currentValue;if(t.is(n,"string")){var s=_.getDatasourceInternalName(u.moreTypesdatasourceComboBox.currentValue),o=_.getTypesInternalName(s,n),l=!1,d=null;if(t.is(o))if(r.length>0&&r.indexOf(o)>-1&&(d=c.get("SearchType.excludeTypeWarning"),l=!0),i.length>0&&!1===l&&i.indexOf(o)>-1&&(d=c.get("searchType.TypeWarning"),l=!0),!1===l){var h={cardDiv:u.moreTypesCard,datasource:s,textOnCard:n,deleteOption:!0};_.buildCardBlockRow(h),_.enableButtons()}else{var p=_.createWdgAlert();p.inject(widget.body,"top"),p.add({className:"warning applyChangesAlert",message:d})}u.moreTypestypeComboBox.selectedIndex=-1}});var k=e.create("div",{class:"search_center_div_card search_center_top_margin",id:"search-type-display-text"}).inject(W);u.moreTypesCard=e.create("div",{class:"card search_center_card_panel",id:"SearchTypes_moreType"}).inject(k);var M=[];if(M.push(c.get("General.None")),_._datasourceList.length>0){let e=_._datasourceList;if(t.is(e,"array")){let r=M.concat(e);u.defaultDatasourceComboBox.elementsList=r,t.is(u._defaultDatasource)&&(u.defaultDatasourceComboBox.currentValue=u._defaultDatasource),u.datasourceComboBox.elementsList=e,u.moreTypesdatasourceComboBox.elementsList=e}}else _.getDataSourceList().then(function(e){if(t.is(e,"array")){let r=M.concat(e);u.defaultDatasourceComboBox.elementsList=r,t.is(u._defaultDatasource)&&(u.defaultDatasourceComboBox.currentValue=u._defaultDatasource,_.disableButtons()),u.datasourceComboBox.elementsList=e,u.moreTypesdatasourceComboBox.elementsList=e}});u.checkboxTypeDisplay.addEventListener("change",function(){_.enableButtons(),!1===u.checkboxTypeDisplay.checkFlag?(f.addClassName("search_center_disable"),x.addClassName("search_center_disable"),j.addClassName("search_center_disable"),v.addClassName("search_center_disable"),s.disableUI()):(f.removeClassName("search_center_disable"),x.removeClassName("search_center_disable"),j.removeClassName("search_center_disable"),v.removeClassName("search_center_disable"),s.enableUI())}.bind(this)),u.checkboxInstanceSearch.addEventListener("change",function(){if(_.enableButtons(),!0===u.checkboxInstanceSearch.checkFlag){var e=_.createWdgAlert(),t=c.get("SearchType.InstanceSearchWarning");e.inject(widget.body,"top"),e.add({className:"warning applyChangesAlert",message:t})}}),s.onRenderFacet(o)},getTabInputsToStore:function(){var e={type_display:u.checkboxTypeDisplay.checkFlag,SEARCH_INSTANCES:u.checkboxInstanceSearch.checkFlag},r=[],a={},i=_.getDatasourceInternalName(u.defaultDatasourceComboBox.currentValue);t.is(i)&&(a.source=i,r.push(a)),e.default_datasourceandtype=r;for(var n=[],o=u.preferredTypesCard.childNodes.length,c=0;c<o;c++){var l={};l.uri=u.preferredTypesCard.childNodes[c].getAttribute("sccURI"),l.source=u.preferredTypesCard.childNodes[c].getAttribute("sccDataSource"),t.is(l.uri)&&t.is(l.source)&&n.push(l)}e.easyTypeAccess=n;for(var d=[],h=u.moreTypesCard.childNodes.length,p=0;p<h;p++){var g={};g.uri=u.moreTypesCard.childNodes[p].getAttribute("sccURI"),g.source=u.moreTypesCard.childNodes[p].getAttribute("sccDataSource"),t.is(g.uri)&&t.is(g.source)&&d.push(g)}e.excluded_types=d;var f=s.getTabInputsToStore(),m={};return m.SearchControl_SearchTypes=e,m.SearchControl_SearchAttributes=f,m},onResetTab:function(e){for(var r=u.preferredTypesCard.childElementCount-1;r>=0;r--)u.preferredTypesCard.childNodes[r].destroy();u.preferredTypesCard.parentElement.parentElement.parentElement.children[0].addClassName("search_center_div search_center_general_display_flex");for(var a,i,n,o=u.moreTypesCard.childElementCount-1;o>=0;o--)u.moreTypesCard.childNodes[o].destroy();if(u.moreTypesCard.parentElement.parentElement.parentElement.children[0].addClassName("search_center_div search_center_general_display_flex"),(a=t.is(e,"string")?JSON.parse(e):e).hasOwnProperty("type_custo")&&(i=a.type_custo),a.hasOwnProperty("attribute_custo")&&(n=a.attribute_custo,s.onResetTab(n)),t.is(i)){if(i.hasOwnProperty("type_display")){var c=i.type_display;t.is(c)&&(u.checkboxTypeDisplay.checkFlag=c)}if(i.hasOwnProperty("SEARCH_INSTANCES")){var h=i.SEARCH_INSTANCES;t.is(h)&&(u.checkboxInstanceSearch.checkFlag=h)}else u.checkboxInstanceSearch.checkFlag=!1;if(i.hasOwnProperty("default_datasourceandtype")){var p=i.default_datasourceandtype;if(t.is(p)&&p.length>0){var g=p[p.length-1],f=_.getDatasourceDisplayName(g.source);u.defaultDatasourceComboBox.elementsList.length>0?u.defaultDatasourceComboBox.currentValue=f:u._defaultDatasource=f}else u.defaultDatasourceComboBox.selectedIndex=-1}else u.defaultDatasourceComboBox.selectedIndex=-1;var m=[],C=[],v=[],y=[];if(i.hasOwnProperty("easyTypeAccess")){var b=i.easyTypeAccess;if(t.is(b,"array"))for(let e=0;e<b.length;e++){let r=b[e].uri,a=b[e].source;t.is(a)&&C.push(a),t.is(r)&&m.push(r)}}if(i.hasOwnProperty("excluded_types")){var S=i.excluded_types;if(t.is(S,"array"))for(let e=0;e<S.length;e++){let r=S[e].uri,a=S[e].source;t.is(a)&&v.push(a),t.is(r)&&y.push(r)}}var x=m.concat(y),D=C.concat(v);if(x.length>0&&D.length>0&&x.length===D.length){let e=[],r=!0;for(let a=0;a<x.length;a++){let i=x[a];if(t.is(i)){let n=_.getTypesDisplayName(D[a],i);t.is(n)||(r=!1);let s=i.indexOf(":");if(s>=0){let t=i.substr(s+1);e.push(t)}else e.push(i)}}if(r){let e=!1;for(let t=0;t<m.length;t++){let r=_.getTypesDisplayName(C[t],m[t]),a={cardDiv:u.preferredTypesCard,datasource:C[t],textOnCard:r,uri:m[t],deleteOption:!0};_.buildCardBlockRow(a),e=!0}!0===e&&(u.preferredTypesCard.parentElement.parentElement.parentElement.children[0].className="search_center_set_left_div search_center_top_margin search_center_general_display_flex",e=!1);for(let t=0;t<y.length;t++){let r=_.getTypesDisplayName(v[t],y[t]),a={cardDiv:u.moreTypesCard,datasource:v[t],textOnCard:r,uri:y[t],deleteOption:!0};_.buildCardBlockRow(a),e=!0}!0===e&&(u.moreTypesCard.parentElement.parentElement.parentElement.children[0].className="search_center_set_left_div search_center_top_margin search_center_general_display_flex")}else{for(var A=[],T=0;T<D.length;T++)A.push({value:e[T],source:[d.getServiceFromSource(D[T])]});l.getNlsOfPropertiesValuesBySource({"ds6w:type":A},{tenantId:_.platformID,lang:_._language,onComplete:function(e){let t=e["ds6w:type"],r=!1;for(let e=0;e<m.length;e++){let a=null,i=m[e].indexOf(":"),n=t[a=i>=0?m[e].substr(i+1):m[e]],s={cardDiv:u.preferredTypesCard,datasource:C[e],textOnCard:n,uri:m[e],deleteOption:!0};_.buildCardBlockRow(s),r=!0}!0===r&&(u.preferredTypesCard.parentElement.parentElement.parentElement.children[0].className="search_center_set_left_div search_center_top_margin search_center_general_display_flex",r=!1);for(var a=0;a<y.length;a++){let e=null,i=y[a].indexOf(":"),n=t[e=i>=0?y[a].substr(i+1):y[a]],s={cardDiv:u.moreTypesCard,datasource:v[a],textOnCard:n,uri:y[a],deleteOption:!0};_.buildCardBlockRow(s),r=!0}!0===r&&(u.moreTypesCard.parentElement.parentElement.parentElement.children[0].className="search_center_set_left_div search_center_top_margin search_center_general_display_flex")},onFailure:function(){let e=!1;for(let t=0;t<m.length;t++){let r={cardDiv:u.preferredTypesCard,datasource:C[t],textOnCard:m[t],uri:m[t],deleteOption:!0};_.buildCardBlockRow(r),e=!0}!0===e&&(u.preferredTypesCard.parentElement.parentElement.parentElement.children[0].className="search_center_set_left_div search_center_top_margin search_center_general_display_flex",e=!1);for(let t=0;t<y.length;t++){let r={cardDiv:u.moreTypesCard,datasource:v[t],textOnCard:y[t],uri:y[t],deleteOption:!0};_.buildCardBlockRow(r),e=!0}!0===e&&(u.moreTypesCard.parentElement.parentElement.parentElement.children[0].className="search_center_set_left_div search_center_top_margin search_center_general_display_flex")}})}}}_.removeMask(widget.body)}};return u}),define("DS/SearchControlCenter/scripts/SCCTagColorizationHelper",["UWA/Core","UWA/Promise","DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/WAFData/WAFData","DS/SNInfraUX/SearchSettings","DS/SNInfraUX/SearchUtils","DS/SNInfraUX/SearchLogin","DS/SearchControlCenter/scripts/SearchControlCenterServices","DS/SNInfraUX/SearchPreferences"],function(e,t,r,a,i,n,s,o,c){"use strict";return{getAllPredicates:function(e){var a=this;return new t(function(t,i){var n={};a.getAllTags().then(function(i){var s=a._getPredicateValuesWithSource(i);a._mergeTags(s,e),n.sourceInfo=s,a.getPredicateValuesNls(s).then(function(e){var a=Object.keys(e).map(function(e){return e.split("/").pop()});r.getResourcesInfo(a.join(","),{tenantId:o.getPlatformID(),onComplete:function(r){var a={};r.vocabularyElementNLSInfo.forEach(function(e){a[e.uri]=e.nlsName}),Object.keys(e).forEach(function(t){e[t].nls=a[t.split("/").pop()]}),n.colorization=e,t(n)},onFailure:function(){n.colorization={},t(n)}})})})})},getAllTags:function(){var r=this;return new t(function(t,s){var l=e.is(i.getOption("tagColorQuery"))?i.getOption("tagColorQuery"):e.is(c.getItem("tagColorQuery"))?c.getItem("tagColorQuery"):"[ds6w:modified]>1970/01/01";c.setItem("tagColorQuery",l);var d={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},data:JSON.stringify({with_indexing_date:!0,with_nls:!1,label:"3DSearch-SCC-TagColorization"+n.getUserId()+"-"+(new Date).getTime(),locale:n.getLanguage(),query:l,refine:{},specific_source_parameter:{},select_predicate:["ds6w:label"],source:[],tenant:o.getPlatformID(),nresults:1,order_by:"desc",order_field:"relevance",start:0,with_synthesis:!0})};r.get3DSearchSericeURLPromise().then(function(e){d.onComplete=function(e){var a=JSON.parse(e),i=r._removeUnsupportedTagValues(a.facets);t(i)},d.onFailure=function(e){s(e)},a.authenticatedRequest(e+"/search",d)})})},_removeUnsupportedTagValues:function(t){var r=[];if(e.is(t,"array")){var a=i.getOption("tagColorization");r=t.filter(function(e){return a.supported_value_types.indexOf(e.type)>=0&&a.unsupported_predicates.indexOf(e.sixw)<0})}return r},getPredicateValuesNls:function(r){var a=this;return new t(function(t,i){var n={},o={},c={};e.is(r)&&(Object.keys(r).forEach(function(e){n[e]||(n[e]=[]),Object.keys(r[e]).forEach(t=>{n[e].push({value:t,source:[s.getServiceFromSource(r[e][t])]})})}),Object.keys(n).forEach(function(e){var t=e.split("/").pop();o[t]=n[e]}),a.getTagValuesNls(o).then(function(e){Object.keys(n).forEach(function(t){var r=t.split("/").pop();c[t]||(c[t]={values:e[r]})}),t(c)}))})},getTagValuesNls:function(e){return new t(function(t,a){r.getNlsOfPropertiesValuesBySource(e,{tenantId:o.getPlatformID(),lang:n.getLanguage(),onComplete:function(e){t(e)},onFailure:function(){t({})}})})},get3DSearchSericeURLPromise:function(){return n.getSericeURLPromise(o.getPlatformID(),"3DSearch")},_getPredicateValuesWithSource:function(t){var r={};return e.is(t,"array")&&t.forEach(t=>{if(e.is(t.object,"string")){var a=t.sixw;r[a]||(r[a]={}),r[a][t.object]=t.sources[0]}}),r},_mergeTags:function(t,r){e.is(t)&&e.is(r)&&Object.keys(r).forEach(a=>{e.is(t[a])?t[a]=e.merge(t[a],r[a]):t[a]=e.clone(r[a],!0)})}}}),define("DS/SearchControlCenter/scripts/ControlledOntology/OntologyDatasetsHelpers",["UWA/Core","UWA/Class","UWA/Class/Debug","UWA/Promise","DS/WAFData/WAFData","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/SNInfraUX/Api/SearchApi","DS/SNInfraUX/SearchRessources","DS/SNInfraUX/SearchLogin","DS/SNInfraUX/SearchUtils","DS/SNInfraUX/Logger","DS/SNInfraUX/SearchSettings","DS/SearchControlCenter/scripts/SearchControlCenterServices","text!DS/SearchControlCenter/assets/Ontology_Datasets.json"],function(e,t,r,a,i,n,s,o,c,l,d,_,h,u,p,g){"use strict";let f=t.singleton(r,{_treeDocument:null,_distributionServiceURLPromise:null,_ontologyServiceURLPromise:null,_urldistribution:"/3drdfpersist/governance/v3/datasets/",_distribution:"/distributions?mask=standard",_urlontology:"/3drdfklet/resources/v1/concepts/ds6wclassifier:Root/concepts?recurse=all&relation=broaderOf&offset=0&sessionId=",_testQA:u.getOption("allowEnterpriseDictionaryModification"),init:function(){this._distributionServiceURLPromise=f._getSericeURLPromise("lakegovernance"),this._ontologyServiceURLPromise=f._getSericeURLPromise("ontology"),this._treeDocument=new s({useAsyncPreExpand:!0,shouldAcceptDrag:function(){return!1},shouldAcceptDrop:function(){return!1}})},buildSearchResults:function(t){let r=this;e.is(t)&&e.is(t.onComplete,"function")&&(e.is(r._treeDocument)&&e.is(r._treeDocument.destroy,"function")&&(r._treeDocument.destroy(),r._treeDocument=null),r._treeDocument=new s({useAsyncPreExpand:!0,shouldAcceptDrag:function(){return!1},shouldAcceptDrop:function(){return!1}}),h.groupCollapsed("DS/SearchControlCenter/scripts/OntologyDatasetsHelpers::_buildSearchResults"),r._getResultPromise().then(function(a){h.log("response OK"),r._treeDocument.prepareUpdate(),e.is(a.results)&&a.results.forEach(function(e){let t=e.attributes,a={},i=!1;if(t.forEach(function(e){let t=e.value;"resourceid"===e.name?-1!==t.indexOf("<uuid:")&&(a.id=t,i=!0):!i||"ds6w:label"!==e.name&&"dcterms:title"!==e.name?!i||"ds6w:description"!==e.name&&"dcterms:description"!==e.name||(a.description=t,a.tooltip=t):a.label=t}),!0===i){let e=new o(a);r._treeDocument.addRoot(e)}}),r._treeDocument.pushUpdate(),t.onComplete.call(void 0,r._treeDocument),h.groupEnd()},function(){if(h.log("response KO"),!0===r._testQA){require(["text!DS/SearchControlCenterPO/assets/DataSetOntology_tst.json"],function(a){let i=JSON.parse(a);if(e.is(i,"array")){let a=i.length;r._treeDocument.prepareUpdate();for(let e=0;e<a;e++){let t=new o({id:i[e].dataset,label:i[e].datasetTitle});r._treeDocument.addRoot(t)}r._treeDocument.pushUpdate(),e.is(t.onFailure,"function")&&t.onFailure.call(void 0,r._treeDocument)}})}h.groupEnd()}))},setselected:function(t){if(!e.is(t,"array")||!e.is(this._treeDocument))return;let r=!1;this._treeDocument.prepareUpdate();let a=t.length,i=this._treeDocument.getRoots(),n=i.length;for(let s=0;s<a;s++){let a=t[s],o=a&&a.datasetTitle;if(e.is(o)&&o.length)for(let e=0;e<n;e++){let t=i[e];t&&t._options.label===o&&(t.select(),e=n,r=!0)}}return this._treeDocument.pushUpdate(),r},getConceptsOfConcept:function(t){let r;if(e.is(t)&&e.is(t.onComplete,"function")&&(r=e.is(t.sessionsId)?t.sessionsId:void 0,e.is(r))){let a=this;f._getontologySericeURLPromise().then(function(n){let s={method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(r,a){let i=JSON.parse(r);e.is(i)&&t.onComplete.call(void 0,i)},onFailure:function(e){h.log("DS/SearchControlCenter/scripts/OntologyDatasetsHelpers::getConceptsOfConcept onFailure: ",e)}},o=n+a._urlontology+r;i.authenticatedRequest(o,s)},function(){reject("Failed to retireve distribution service url")})}},getDataSetStructure:function(t){let r=this;if(h.groupCollapsed("DS/SearchControlCenter/scripts/OntologyDatasetsHelpers::getDataSetStructure"),!e.is(r._treeDocument)||!e.is(t)||!e.is(t.onComplete,"function"))return void h.groupEnd();let a=r._treeDocument.getXSO().get(),i=a.length;if(i){let n=a[i-1],s={id:n._options.id,object:n._options,onComplete:function(r){if(e.is(r,"object")){let e={dataset:n._options.id,datasetTitle:n._options.label,sessionId:r.identifier,"session@id":r["@id"],sessionTitle:r.title};t.onComplete.call(void 0,e),h.log("onComplete: ",e),h.groupEnd()}},onFailure:function(){if(!0===r._testQA){require(["text!DS/SearchControlCenterPO/assets/DataSetOntology_tst.json"],function(r){let a=JSON.parse(r);for(let r=0;r<a.length;r++){let i=a[r];if(i.datasetTitle===n._options.label){e.is(t.onFailure,"function")&&t.onFailure.call(void 0,i),h.log("onFailure: ",i);break}}})}h.groupEnd()}};r._querydistributions(s)}else t.onComplete.call(void 0,void 0),h.groupEnd()},clean:function(){e.is(this._treeDocument)&&e.is(this._treeDocument.removeRoots,"function")&&this._treeDocument.removeRoots(),e.is(this._treeDocument)&&e.is(this._treeDocument.destroy,"function")&&(this._treeDocument.destroy(),this._treeDocument=null)},destroy:function(){this._parent(),e.is(this._treeDocument)&&e.is(this._treeDocument.destroy,"function")&&(this._treeDocument.destroy(),this._treeDocument=null)},_getResultPromise:function(){let t=this;return new a(function(r,a){h.groupCollapsed("DS/SearchControlCenter/scripts/OntologyDatasetsHelpers::_getResultPromise");let i=e.extend(t._buildSearchQuery(),{onComplete:function(t){r(e.extend(t))},onFailure:function(e){a(e)}});h.log("searchOptions: ",i),c.search(i),h.groupEnd()})},_buildSearchQuery:function(){let t=this,r=JSON.parse(g);if(e.is(r,"object")){let e=t._getTenant(),a=r.nresults?r.nresults:u.getOption("max_selection_for_selectall",{tenant:e});r.tenant=e,r.nresults=a}return r},_querydistributions:function(t){if(h.log("DS/SearchControlCenter/scripts/OntologyDatasetsHelpers::_querydistributions"),!e.is(t)||!e.is(t.id))return;let r=this;f._getdistributionSericeURLPromise().then(function(a){let n={method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(r,a){let i=JSON.parse(r);if(e.is(i,"object")){let r=i.distributions;if(e.is(r,"array")){let a=r.length,i=0;for(;i<a;i++){let a=r[i];e.is(a,"object")&&e.is(a.identifier,"string")&&t.onComplete.call(void 0,a)}}}},onFailure:function(e){h.log("DS/SearchControlCenter/scripts/OntologyDatasetsHelpers::_querydistributions onFailure: ",e),t.onFailure.call(void 0,e)}},s=a+r._urldistribution+t.id+r._distribution;i.authenticatedRequest(s,n)},function(){reject("Failed to retireve distribution service url")})},_getSericeURLPromise:function(e){let t=this;return new a(function(r,a){let i=t._getTenant();n.getServiceUrl({serviceName:e,platformId:i,onComplete:function(e){e?r(e):!0===t._testQA?r(e):a()},onFailure:function(e){a(e)}})})},_getdistributionSericeURLPromise:function(){return this._distributionServiceURLPromise},_getontologySericeURLPromise:function(){return this._ontologyServiceURLPromise},_getTenant:function(){return e.is(p.platformID)?p.platformID:_.getActiveTenant()}});return f}),define("DS/SearchControlCenter/scripts/SearchControlCenterInfra",["UWA/Element","UWA/Core","UWA/Promise","DS/UIKIT/Input/Button","DS/UIKIT/Accordion","DS/UIKIT/Mask","DS/WAFData/WAFData","css!DS/SearchControlCenter/SearchControlCenter","i18n!DS/SearchControlCenter/assets/nls/SearchControlCenter.json","text!DS/SearchControlCenter/assets/3DSearchControl_UIsettings.json","DS/SNInfraUX/Logger","DS/SNInfraUX/SearchLogin","DS/SNInfraUX/SearchSettings","DS/SNInfraUX/SearchControlCenterFetchService","DS/SearchControlCenter/scripts/SearchControlCenterServices","DS/SearchControlCenter/scripts/SearchcontrolCenterModel","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/UIKIT/Alert","DS/SNInfraUX/SearchUtils"],function(e,t,r,a,i,n,s,o,c,l,d,_,h,u,p,g,f,m,C){"use strict";return{url3DSpacepromise:r.deferred(),CSVpromise:r.deferred(),initInfraPromise:r.deferred(),_postURL:null,_listOfFacets:[],_listOfFacetNames:[],uiRefresh:function(){this._listOfFacetNames.length>0?this._OnResetClick():this.init()},initInfra:function(){var e=this,r={onComplete:function(){var r={tenantID:p.platformID,key:"SCC_UI"};u.getSearchSettings(r).then(function(r){var a;if((a=t.is(r,"string")?JSON.parse(r):r).hasOwnProperty("attribute_custo")){var i=!1,n=a.attribute_custo;if(n.hasOwnProperty("ds6w:type")){var s=n["ds6w:type"];let e=!1;for(var o=0;o<s.length;o++){if("AllDataSourcesandTypes"===s[o].source){e=!0;break}}!1===e&&(i=!0)}else n["ds6w:type"]=[],i=!0;if(!0===i){let t={source:"AllDataSourcesandTypes"};t.predicates=e._getDefaultPredicates(),n["ds6w:type"].push(t)}}g.setSettingsJSON(a),e.initInfraPromise.resolve()},function(t){n.unmask(widget.body),e.initInfraPromise.reject();var r=p.createWdgAlert();r.inject(widget.body,"top");var a=c.get("SearchInfra.failuremsg");a+=t,r.add({className:"error",message:a})})},onFailure:function(){e.initInfraPromise.reject(),n.unmask(widget.body),d.log("Login fails !!")}};return r.tenantID=widget.getValue("x3dPlatformId"),t.is(r.tenantID)&&""!==r.tenantID||(r.tenantID="OnPremise"),f.getServiceUrl({serviceName:"3DSearch",platformId:r.tenantID,onComplete:function(e){var a;t.is(e,"array")?a=e[0].url:t.is(e,"string")&&(a=e),t.is(a)&&(r.fedSearchURL=a),t.is(r.tenantID,"string")&&(_.login(r),p.setPlatformID(r.tenantID))},onFailure:function(e){var t=p.createWdgAlert();t.inject(widget.body,"top");var r=c.get("SearchInfra.URLBuildError");r+=e,t.add({className:"error",message:r})}}),f.getPlatformConfig({serviceName:"3DSpace",onComplete:function(e){for(var t=0;t<e.length;t++){var a=e[t];if(a.platformId===r.tenantID){p.setPlatformDisplayName(a.displayName);break}}}}),this.initInfraPromise.promise},_getDefaultPredicates:function(){var e=[],r=!1,a=localStorage.getItem("TagNavigator-simplifiedTagger");return t.is(a)&&"true"===a&&(r=!0),r&&e.push({uri:"computedCountryInfo"}),e.push({uri:"ds6w:dataSource"}),e.push({uri:"ds6w:type"}),r||e.push({uri:"ds6w:category"}),e.push({uri:"ds6w:modified"}),r&&e.push({uri:"ds6w:created"}),e.push({uri:"ds6w:lastModifiedBy"}),e.push({uri:"ds6w:responsible"}),e},check3DSpaceAvailablity:function(){var e=widget.getValue("x3dPlatformId");t.is(e)&&""!==e||(e="OnPremise");var r=this;return f.getServiceUrl({serviceName:"3DSpace",platformId:e,onComplete:function(e){if(t.is(e))r.url3DSpacepromise.resolve(e);else{var a=new Error("no platform");r.url3DSpacepromise.reject(a)}},onFailure:function(){var e=new Error("no platform");r.url3DSpacepromise.reject(e)}}),this.url3DSpacepromise.promise},checkCSVAvailability:function(){var e=this;return C.getGrantedRoles(function(t){for(var r=!1,a=0;a<t.length;a++)if("CSV"===t[a].id){r=!0;break}if(r)e.CSVpromise.resolve(t);else{var i=new Error("no access");e.CSVpromise.reject(i)}}),this.CSVpromise.promise}}}),define("DS/SearchControlCenter/scripts/SCCTagColorization",["UWA/Element","UWA/Core","UWA/Promise","DS/Controls/ComboBox","DS/UIKIT/Popover","DS/SearchControlCenter/control/SCCCard","DS/SearchControlCenter/control/SCCColorPicker","DS/SearchControlCenter/scripts/SearchControlCenterServices","DS/SearchControlCenter/scripts/SCCTagColorizationHelper","i18n!DS/SearchControlCenter/assets/nls/SearchControlCenter.json","DS/Controls/Toggle","DS/Controls/LineEditor","DS/SNInfraUX/SearchPreferences","DS/SNInfraUX/SearchSettings"],function(e,t,r,a,i,n,s,o,c,l,d,_,h,u){"use strict";return{_tagColorizeMap:null,_parentDiv:null,_predicateToCBMap:null,render:function(e){this._parentDiv=e,this._tagColorizeMap={},this._predicateToCBMap=new Map},onRender:function(r){var n=this;n.tabSettings=r,n._cleanupUI();var s=t.is(n.tabSettings)&&t.is(n.tabSettings.sourceInfo)?n.tabSettings.sourceInfo:void 0;c.getAllPredicates(s).then(function(r){n.tagsToShowInCB=t.clone(r.colorization,!0),n.tagsSource=t.clone(r.sourceInfo,!0),n.div6WtagsColorizeSpan=e.create("div",{id:"search-center-tag-colorize"}).inject(n._parentDiv);var s=e.create("div",{class:"search_center_general_tab_div search_center_margin"}).inject(n.div6WtagsColorizeSpan),o=e.create("div",{class:"search_center_div_left search_center_margin search_center_general_display_flex search_center_6Wtags_align",id:"div_tag_olorize_text"}).inject(s);e.create("p",{class:"search_center_text",text:l.get("6WTagsFilter.ColorizeTagTitle")}).inject(o);var c=e.create("div",{class:"search_center_div_right",id:"div_tag_colorize_card_combo_span"}).inject(s);u.getOption("updateQuery")&&n._changeSearchQueryUI().inject(c);var d=e.create("div",{class:"search_center_div_datasource search_center_only_grid search_center_top_margin",id:"div_tag_colorize_combo_span"}).inject(c);n.tagColorizePredicatesComboBox=new a({elementsList:n._predicateToShowCB(),placeholder:l.get("6WTagsFilter.ColorizeTag.PredicateComboBox.placeholder"),touchMode:!0,mainElementVisibleFlag:!0}).inject(d),n.divTagColorizeCardSpan=e.create("div",{class:"div-tag-colorize-card-span",id:"div_tag_colorize_card_span"}).inject(c);var _=e.create("span",{class:"fonticon fonticon-info search_center_margin_CardSpan_icon"}).inject(s);new i({target:_,trigger:"hover",animate:"true",position:"top",body:l.get("6WTagsFilter.ColorizeTag.PredicateComboBox.info"),title:""}),n.tagColorizePredicatesComboBox.addEventListener("hide",n._onChangePredicates.bind(n),!1),t.is(n.tabSettings)&&n._createCardsWithStoredPredicates(n.tabSettings.colorization)})},_createCardsWithStoredPredicates:function(e){var r=this;t.is(e)&&Object.keys(e).length>0&&Object.keys(e).forEach(function(t){var a=e[t],i=r._createPredicateCard(t);Object.keys(r._storedValueToShow(t,a)).forEach(function(e){r._createPredicateValueCard(i.getBodyElement(),t,e,a[e])})})},_onChangePredicates:function(e){if(-1!==e.dsModel.selectedIndex){e.stopPropagation();var t=e.dsModel.value;e.dsModel.currentLabel;this._createPredicateCard(t),e.currentTarget.dsModel.selectedIndex=-1}},_createPredicateCard:function(r){var i=this,s=i.tagsToShowInCB[r].nls;if(i._isPredicateCardAlreadyPresent(r)){var o=l.get("6WTagsFilter.ColorizeTag.warning.predicateExist");this._showWarningAlert(o)}else{if(!(t.is(i._tagColorizeMap,"object")&&Object.keys(i._tagColorizeMap).length>=100)){var c=e.create("div",{class:"div-scc-card-container"}).inject(this.divTagColorizeCardSpan),d=new n({header:{label:s,value:r},closable:!0,isBodyRequired:!0,className:"scc-predicate-card"}).inject(c),_=e.create("div",{class:"div-tag-colorize-combo-box search_center_only_grid"}),h=new a({elementsList:i._valueToShowInCB(r),placeholder:l.get("6WTagsFilter.ColorizeTag.ValueComboBox.placeholder"),touchMode:!0,mainElementVisibleFlag:!0}).inject(_);return d.appendChildToBody(_),i._storePredicateInMemory(r),i._predicateToCBMap.set(r,h),h.addEventListener("hide",function(e){i._onChangeValues(e,r)},!1),d.addEvent("onClose",function(e){i._removePredicate(e,r)}),i._removeFromCBModel(this.tagColorizePredicatesComboBox,r),d}o=l.get("6WTagsFilter.ColorizeTag.warning.predicateExeedsLimit");this._showWarningAlert(o)}},_onChangeValues:function(e,t){if(e.stopPropagation(),o.enableButtons(),-1!==e.dsModel.selectedIndex){e.dsModel.currentLabel;var r=e.dsModel.currentValue,a=e.currentTarget.getParent().getParent();this._createPredicateValueCard(a,t,r),e.dsModel.selectedIndex=-1}},_createPredicateValueCard:function(r,a,i,o){var c=this;if(c._isValueCardAlreadyPresent(a,i)){var d=l.get("6WTagsFilter.ColorizeTag.warning.predicateValueExist");this._showWarningAlert(d)}else{var _=c._tagColorizeMap[a];if(t.is(_,"object")&&Object.keys(_).length>=21){d=l.get("6WTagsFilter.ColorizeTag.warning.valueExeedsLimit");this._showWarningAlert(d)}else{var h=c.tagsToShowInCB[a].values[i],u=e.create("div",{class:"div-tag-colorize-predicate-value scc-card-flex"}),p=new s({initialValue:o}).inject(u),g=new n({header:{label:h,value:i},closable:!0,isBodyRequired:!1,className:"scc-predicate-value-card"}).inject(u);u.inject(r),this._storePredicateValuesInMemory(a,i,p._getCurrentColor()),p.addEvent("onColorChange",function(e){c._onColorChange(e,a,i)}),g.addEvent("onClose",function(e){c._removePredicateValue(e,a,i)}),c._removeFromCBModel(c._predicateToCBMap.get(a),i)}}},_onColorChange:function(e,t,r){o.enableButtons(),this._storePredicateValuesInMemory(t,r,e.color)},_removePredicateValue:function(e,t,r){var a=e.target;o.enableButtons(),this._addToCBModel(this._predicateToCBMap.get(t),r,this.tagsToShowInCB[t].values[r]),this._removePredicateValueFromMemory(t,r),a.getParent().destroy()},_removePredicate:function(e,t){var r=e.target;o.enableButtons(),this._removePredicateFromMemory(t),this._addToCBModel(this.tagColorizePredicatesComboBox,t,this.tagsToShowInCB[t].nls),this._predicateToCBMap.delete(t),r.getParent().destroy()},getInputsToStore:function(){var e=this,r={};r.colorization=t.clone(this._tagColorizeMap,!0);var a={};return Object.keys(e._tagColorizeMap).forEach(t=>{Object.keys(e._tagColorizeMap[t]).forEach(r=>{a[t]||(a[t]={}),a[t][r]=e.tagsSource[t][r]})}),r.sourceInfo=a,e.tabSettings=r,r},_storePredicateInMemory:function(e){t.is(e)&&(t.is(this._tagColorizeMap[e])||(this._tagColorizeMap[e]={}))},_storePredicateValuesInMemory:function(e,r,a){if(t.is(e)&&t.is(r)&&t.is(a)){t.is(this._tagColorizeMap[e])||(this._tagColorizeMap[e]={});var i=this.tagsToShowInCB[e].values[r],n=this;Object.keys(this.tagsToShowInCB[e].values).forEach(function(t){n.tagsToShowInCB[e].values[t]==i&&(n._tagColorizeMap[e][t]=a)})}},_removePredicateValueFromMemory:function(e,r){if(t.is(e)&&t.is(r)){var a=this.tagsToShowInCB[e].values[r],i=this;Object.keys(this._tagColorizeMap[e]).forEach(function(t){i.tagsToShowInCB[e].values[t]==a&&delete i._tagColorizeMap[e][t]})}},_removePredicateFromMemory:function(e){t.is(e)&&delete this._tagColorizeMap[e]},_predicateToShowCB:function(){var e=this,t=[];return Object.keys(e.tagsToShowInCB).forEach(function(r){t.push({label:e.tagsToShowInCB[r].nls,value:r})}),t},_removeFromCBModel:function(e,r){var a=e.elementsList;if(t.is(a,"array")&&a.length>0){var i=t.clone(a,!0);i.forEach((t,a)=>{if(t.value===r)return i.splice(a,1),void(e.elementsList=i)})}},_addToCBModel:function(e,r,a){var i=e.elementsList;if(t.is(i,"array")){var n=t.clone(i,!0);n.push({label:a,value:r}),e.elementsList=n}},_valueToShowInCB:function(e){var t=this,r=[],a={};return Object.keys(t.tagsToShowInCB[e].values).forEach(function(i){var n=t.tagsToShowInCB[e].values[i];a[n]||(r.push({label:n,value:i}),a[n]=!0)}),r},_storedValueToShow:function(e,t){var r={},a={},i=this;return Object.keys(t).forEach(function(n){var s=i.tagsToShowInCB[e].values[n];r[s]||(a[n]=t[n],r[s]=!0)}),a},_isPredicateCardAlreadyPresent:function(e){return t.is(this._tagColorizeMap[e])},_isValueCardAlreadyPresent:function(e,r){return t.is(this._tagColorizeMap[e][r])},_showWarningAlert:function(e){var t=o.createWdgAlert();t.inject(widget.body,"top"),t.add({className:"warning applyChangesAlert",message:e})},_cleanupUI:function(){t.is(this.div6WtagsColorizeSpan)&&(this.div6WtagsColorizeSpan.destroy(),this.div6WtagsColorizeSpan=null),this._tagColorizeMap={},this._predicateToCBMap.clear()},_changeSearchQueryUI:function(){var t=this,r=e.create("div",{class:"div-change-search-query"}),a=e.create("div",{class:"div-change-search-query-toggle"}).inject(r),i=new d({type:"checkbox",label:l.get("6WTagsFilter.ColorizeTag.ChnageQuery.label"),checkFlag:!1,value:0}).inject(a),n=e.create("div",{class:"div-change-search-query-editor scc-card-flex search_center_disable",disabled:!0,styles:{height:"36px",border:"solid 1px #c9baba","border-radius":"4px"}}).inject(r),s=e.create("input",{placeholder:l.get("6WTagsFilter.ColorizeTag.ChnageQuery.placeholder"),type:"search",value:h.getItem("tagColorQuery"),styles:{width:"100%",border:"none","margin-left":"5px"}}).inject(n);e.create("div",{class:"fonticon fonticon-update",styles:{right:"12px",cursor:"pointer","margin-top":"6px","margin-right":"6px"},events:{click:function(){h.setItem("tagColorQuery",s.value),t.onRender(t.tabSettings)}}}).inject(n);return i.addEventListener("buttonclick",function(e){e.stopPropagation(),e.dsModel.checkFlag?n.removeClassName("search_center_disable"):n.addClassName("search_center_disable")}),r}}}),define("DS/SearchControlCenter/scripts/ControlledOntology/SCCControlledOntology",["UWA/Element","UWA/Core","UWA/Promise","DS/Controls/Toggle","DS/WUXAutoComplete/AutoComplete","DS/UIKIT/Popover","DS/SNInfraUX/SearchSettings","DS/SearchControlCenter/scripts/ControlledOntology/OntologyDatasetsHelpers","DS/SearchControlCenter/scripts/SearchControlCenterServices","i18n!DS/SearchControlCenter/assets/nls/SearchControlCenter.json"],function(e,t,r,a,i,n,s,o,c,l){"use strict";return{_structureToStore:[],_structureStored:null,_mainControlDivSection:null,_alreadyExist:!1,render:function(e){this._parentDiv=e,this.renderControlledSection(this._parentDiv)},destroy:function(){this._parent(),t.is(o)&&t.is(o.destroy,"function")&&(o.destroy(),o=null)},getTabInputsToStore:function(){return this._structureToStore},getInputFromStore:function(e){t.is(e,"array")&&0!==e.length&&(this._alreadyExist=!0,this._structureStored=e,this._structureToStore=e),this._mainControlDivSection&&this._mainControlDivSection.removeClassName("disable"),this._structureStored&&this._structureStored.length&&this._mainControlDivSection&&this._mainControlDivSection.addClassName("disable")},onUpdateUI:function(){this._mainControlDivSection&&this._mainControlDivSection.removeClassName("disable");let e=!1;this._structureStored&&this._structureStored.length?e=!0:this._structureToStore&&this._structureToStore.length&&(e=!0),!0===e?this._mainControlDivSection&&this._mainControlDivSection.addClassName("disable"):(this.checkboxActivateControlVocab.checkFlag=!1,this.toggleDisableStateOfInputFields(),this.datasetAutocomplete.value="",this.datasetAutocomplete.elementsTree=void 0,o.clean(),this.buildSearchResults())},renderControlledSection:function(t){this._mainControlDivSection=e.create("div",{class:"search_center_main_div",id:"control-Ontology-main"}).inject(t);var r=e.create("div",{class:"",id:"control-Ontology-title"}).inject(this._mainControlDivSection);e.create("p",{class:"control_Ontology_text_heading",text:l.get("6WTagsFilter.ControlledOntology.title")}).inject(r),this.renderActivateControlOntology(this._mainControlDivSection),this.renderDataSetSection(this._mainControlDivSection)},renderActivateControlOntology:function(t){var r=this,i=e.create("div",{class:"search_center_general_display_flex search_center_margin",id:"activate-control-ontology"}).inject(t),s=e.create("div",{class:"search_center_div_uidisplay search_center_general_display_flex",id:"activate-control_ontology-toggle"}).inject(i);this.checkboxActivateControlVocab=new a({type:"checkbox",label:l.get("6WTagsFilter.ControlledOntology.CheckBox.label"),className:"primary",touchMode:"true"}).inject(s);var o=e.create("span",{class:"fonticon fonticon-info search_center_margin_icon"}).inject(i);o.setStyle("color","#b4b6ba"),o.addEventListener("mouseover",this._manageMouseOver,!1),o.addEventListener("mouseout",this._manageMouseOut,!1),new n({target:o,trigger:"hover",animate:"true",position:"top",body:l.get("6WTagsFilter.ControlledOntology.popover"),title:""}),this.checkboxActivateControlVocab.addEventListener("change",function(e){r.toggleDisableStateOfInputFields()})},toggleDisableStateOfInputFields:function(){1==this.checkboxActivateControlVocab.checkFlag?this.divCategoriesSection.removeClassName("search_center_disable"):this.divCategoriesSection.addClassName("search_center_disable")},renderDataSetSection:function(t){this.divCategoriesSection&&this.divCategoriesSection.remove(),t||(t=this._parentDiv),this.divCategoriesSection=e.create("div",{class:"control_vocab_category_section search_center_disable"}).inject(t),this.renderAddCategorySection(this.divCategoriesSection)},renderAddCategorySection:function(t){this.divAddCategoriesSection=e.create("div",{class:"search_center_add_category_section"}).inject(t);var r=this._createAddCategoryRowSpan({class:"control_vocab search_center_margin",id:"add-search-result-category-row1",parentDiv:this.divAddCategoriesSection}),a=this._createDatasetControl({class:"control_vocab_community_title",divRow:r});this.datasetAutoCompleteDiv=a},_createAddCategoryRowSpan:function(t){var r=e.create("div",{class:t.class,id:t.id}).inject(t.parentDiv);return r.addClassName("control_vocab_add_category_row_span"),r},_createDatasetControl:function(t){let r=this;var a=e.create("div",{class:t.class,id:"Ontology_DataSet_Combo"}).inject(t.divRow);return r.datasetAutocomplete=new i({placeholder:l.get("6WTagsFilter.ControlledOntology.Dataset.title"),touchMode:!0,enableSearchFlag:!0,allowFreeInputFlag:!1,multiSearchMode:!0===s.getOption("allowEnterpriseDictionaryModification")}).inject(a),r.datasetAutocomplete.elements.container.setStyle("max-width","unset"),r.datasetAutocomplete.addEventListener("change",r._onChangeDataset.bind(r)),r.buildSearchResults(),r.datasetAutocomplete.addEventListener("change",function(){r.enableAddCategoryButton()}),r.datasetAutocomplete},buildSearchResults:function(){let e=this,r={onComplete:function(r){t.is(r)&&(e.datasetAutocomplete.elementsTree=r,!0===o.setselected(e._structureStored)&&(e.checkboxActivateControlVocab.checkFlag=!0,c.enableButtons()))},onFailure:function(r){t.is(r)&&(e.datasetAutocomplete.elementsTree=r,!0===o.setselected(e._structureStored)&&(e.checkboxActivateControlVocab.checkFlag=!0,c.enableButtons()))}};o.buildSearchResults(r)},enableAddCategoryButton:function(){this.datasetAutoCompleteDiv.value&&c.enableButtons()},_onChangeDataset:function(e){let r=this;if(!0===r._alreadyExist)return;let a=!0,i=r.datasetAutocomplete.value;if(t.is(i,"array")){a=!1;let e=i.length;if(0===e)return r._structureToStore=[],void c.enableButtons();let t=!1,n=r._structureToStore.length;if(e<n)for(let a=n-1;a>=0;a--){let n=r._structureToStore[a];t=!0;for(let r=0;r<e;r++){if(i[r]===n.datasetTitle){t=!1;break}}!0===t&&(r._structureToStore.splice(a,1),a=-1)}if(!0===t)return}else c.enableButtons();let n={onComplete:function(e){r._addOrnotInDataSetStructure(e,a)},onFailure:function(e){r._addOrnotInDataSetStructure(e,a)}};o.getDataSetStructure(n)},_addOrnotInDataSetStructure:function(e,r){let a=this,i=t.is(e)&&e.datasetTitle,n=!0,s=a._structureToStore.length-1;if(t.is(r)&&!0===r)a._structureToStore=[],n=!0;else for(let e=s;e>=0;e--){if(a._structureToStore[e].datasetTitle===i){a._structureToStore.splice(e,1),n=!1;break}}!0===n&&a._structureToStore.push(e)}}}),define("DS/SearchControlCenter/Views/SearchControlCenterLayoutView",["UWA/Core","UWA/Class/View","DS/UIKIT/Modal","DS/UIKIT/Mask","DS/UIKIT/Input/Button","DS/UIKIT/Alert","DS/SearchControlCenter/scripts/SearchControlCenterServices","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/SearchControlCenter/scripts/SearchcontrolCenterModel","text!DS/SearchControlCenter/assets/SearchControlCenter_defaults.json","css!DS/SearchControlCenter/SearchControlCenter","i18n!DS/SearchControlCenter/assets/nls/SearchControlCenter.json","DS/WAFData/WAFData","DS/SNInfraUX/Logger"],function(e,t,r,a,i,n,s,o,c,l,d,_,h,u){"use strict";var p=t.extend({tagName:"div",className:"generic-detail",_postURL:null,_sccDefaultSettings:null,_containerSpan:null,init:function(e){e&&(this.model=e.model),this._parent.call(this,e)},setup:function(t){e.log("SCCLayoutView::setup!"),e.log(t)},render:function(){e.log("SCCLayoutView::render");var t=this;t._containerSpan=new e.Element("div",{class:"search_center_scroll",id:"search-control-center-general"}),t._containerSpan.inject(t.container),t._containerSpan.classList.add("search_center_container"),a.mask(widget.body),require([t.model._attributes.facetJS],function(e){e.onRenderFacet(t._containerSpan);var r=t.model._attributes.id,a=s.getSettingsJSONFromTabName(r);e.onResetTab(a),s.disableButtons()});var r=new e.Element("div",{class:"search-control-buttonContainer"});r.inject(t.container);var n=new i({id:"id_in_app_apply",value:_.get("ApplyButton.title"),className:"default  primary in_app_search_center_btn",events:{onClick:function(){t._OnApplyClick(!1),u.log("inside _OnApplyClick() ")}}}).inject(r,"bottom"),o=new i({id:"id_in_app_cancel",value:_.get("CancelButton.title"),className:"default in_app_search_center_btn",events:{onClick:function(){t._OnCancelClick(),u.log("inside _OnCancelClick() ")}}}).inject(r);new i({id:"id_in_app_restore",value:_.get("RestoreButton.title"),className:"default in_app_search_center_btn search_center_button_right_margin",events:{onClick:function(){t._OnResetClick(),u.log("inside _OnResetClick() ")}}}).inject(r);return s.updateButtons(n,o),s.disableButtons(),this},_OnCancelClick:function(){s.reSetButtonStatus();var e=this;require([e.model._attributes.facetJS],function(t){var r=e.model._attributes.id,a=s.getSettingsJSONFromTabName(r);t.onResetTab(a),s.disableButtons()})},_OnApplyClick:function(t){s.reSetButtonStatus();var r=this,a=t;require([r.model._attributes.facetJS],function(t){var i=t.getTabInputsToStore();if(e.is(i)){var n=r.model._attributes.id,l={};"SearchControl_SearchTypes"===n?l=i:l[n]=i,c.updateSettingsJSON(l)}s.disableButtons(),o.getServiceUrl({serviceName:"3DSpace",platformId:s.platformID,onComplete:function(t){if(e.is(t,"string")){p._postURL=t+"/resources/SNAPI/infra_services/searchsettings?tenant="+s.platformID;var i=null;a?(i=r._sccDefaultSettings).enterprise_ontology=c.gateSettingsJSON().enterprise_ontology:i=c.gateSettingsJSON();var n={timeout:5e4,method:"POST",data:JSON.stringify(i),type:"json",headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(){if(a){r._updateMemoryModel(),(t=s.createWdgAlert()).inject(widget.body,"top");var e=_.replace(_.get("SearchInfra.restoreToDefaultsuccessmsg"),{tenant_name:s.platformDisplayName});t.add({className:"success applyChangesAlert",message:e})}else{var t;(t=s.createWdgAlert()).inject(widget.body,"top");e=_.replace(_.get("SearchInfra.successmsg"),{tenant_name:s.platformDisplayName});t.add({className:"success applyChangesAlert",message:e})}r._updateUI()},onFailure:function(e){if(a){(r=s.createWdgAlert()).inject(widget.body,"top");var t=_.get("SearchInfra.restoreToDefaultfailuremsg");t+=e,r.add({className:"error applyChangesAlert",message:t})}else{var r;(r=s.createWdgAlert()).inject(widget.body,"top");t=_.get("SearchInfra.failuremsg");t+=e,r.add({className:"error applyChangesAlert",message:t})}},onTimeout:function(e){var t=s.createWdgAlert();t.inject(widget.body,"top");var r=_.get("SearchInfra.timeoutmsg");r+=e,t.add({className:"error applyChangesAlert",message:r})}};require(["DS/SNInfraUX/SearchSettings"],function(e){(e.getOption("ODTLogs")||e.getOption("ODTLogs-SCCSettings"))&&u.warn("ODTLogs-SCCSettings:"+JSON.stringify(n))}),h.authenticatedRequest(p._postURL,n)}},onFailure:function(e){var t=s.createWdgAlert();t.inject(widget.body,"top");var r=_.get("SearchInfra.URLBuildError");r+=e,t.add({className:"error applyChangesAlert",message:r})}})})},_OnResetClick:function(){var t=this,a=new r({header:_.get("SearchInfra.restoreToDefaultHeader"),closable:!0,body:_.replace(_.get("SearchInfra.restoreToDefaultConfirmationmsg"),{tenant_name:s.platformDisplayName}),footer:[new i({className:"primary",value:_.get("SearchInfra.yesButton"),events:{onClick:function(){t._sccDefaultSettings=JSON.parse(l),e.is(t._sccDefaultSettings)&&t._OnApplyClick(!0),a.destroy()}}}),new i({value:_.get("SearchInfra.noButton"),events:{onClick:function(){a.destroy()}}})]}).inject(document.body);a.show()},_updateMemoryModel:function(){var e=this;e._sccDefaultSettings&&(c.setSettingsJSON(e._sccDefaultSettings),require([e.model._attributes.facetJS],function(t){var r=e.model._attributes.id,a=s.getSettingsJSONFromTabName(r);t.onResetTab(a),s.disableButtons()}))},_updateUI:function(){let t=this;require([t.model._attributes.facetJS],function(r){if(e.is(r)&&e.is(r.onUpdateUI,"function")){let e=t.model._attributes.id;r.onUpdateUI(e)}})},destroy:function(){this.stopListening(),this._parent.apply(this,arguments)}});return p}),define("DS/SearchControlCenter/scripts/SearchControlCenterWidget",["UWA/Core","UWA/Class/Model","UWA/Class/Collection","UWA/Class/View","WebappsUtils/WebappsUtils","DS/W3DXComponents/Skeleton","DS/W3DXComponents/ContentSet","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/SearchControlCenter/Views/SearchControlCenterLayoutView","DS/SearchControlCenter/scripts/SearchControlCenterInfra","DS/SearchControlCenter/scripts/SearchControlCenterServices","i18n!DS/SearchControlCenter/assets/nls/SearchControlCenter.json"],function(e,t,r,a,i,n,s,o,c,l,d,_){"use strict";var h={bones:null,height:"auto",licenceAlert:null,unMaximizedHeight:null,generalViewOpts:{contents:{useInfiniteScroll:!1,usePullToRefresh:!1}},setBodyHeight:function(e){e&&("auto"!==e&&(e+="px"),widget.body.setStyle("height",e))},buildSkeleton:function(){var t=c;return new n({domains:{collection:"DS/SearchControlCenter/Collection/SearchControlCenterFacetListCollection",view:null,swipe:!1,viewOptions:h.generalViewOpts,idCardOptions:{actions:function(){return null},facets:function(){return[{text:"Edit",icon:"tools",handler:n.getRendererHandler(t)}]}}}},{root:"domains",startRoute:"/domains/SearchControl_General/?facet=0",useRootChannelView:!1,responsiveTrigger:function(){var e=widget.getView().type;return"channel"===widget.getValue("view")&&("maximized"===e||"fullscreen"===e)},events:{onItemClick:function(t){e.log(t)},onSlide:function(t,r){e.log(t),e.log(r)}}})},onLoad:function(){function t(e){var t=d.createWdgAlert();t.options.autoHide=!1,t.inject(widget.body,"top"),t.add({className:"warning",message:e})}h.bones&&h.bones.destroy(),d.putMask(widget.body),l.check3DSpaceAvailablity(),l.checkCSVAvailability(),l.initInfra().then(function(r){l.check3DSpaceAvailablity().then(function(r){l.checkCSVAvailability().then(function(t){var r="";r=d.getPlatformID(),e.is(r)&&""!==r||(r=e.is(widget.getValue("x3dPlatformId"))?widget.getValue("x3dPlatformId"):"OnPremise",d.setPlatformID(r)),widget.setTitle(r),o.getServiceUrl({serviceName:"3DSpace",platformId:r,onComplete:function(e){d.setURL(e),h.bones=h.buildSkeleton(),widget.body.setContent(h.bones.render())},onFailure:function(e){var t=d.createWdgAlert();t.inject(widget.body,"top");var r=_.get("SearchInfra.URLBuildError");r+=e,t.add({className:"error applyChangesAlert",message:r})}})},function(e){t(_.get("html.license"))})},function(e){t(_.get("html.platform"))}),d.removeMask(widget.body)},function(e){t(_.get("html.InitInfra")),d.removeMask(widget.body)})},onRefresh:function(t){function r(e){var t=d.createWdgAlert();t.options.autoHide=!1,t.inject(widget.body,"top"),t.add({className:"warning",message:e})}h.bones&&h.bones.destroy(),d.putMask(widget.body),l.check3DSpaceAvailablity(),l.checkCSVAvailability(),l.check3DSpaceAvailablity().then(function(t){l.checkCSVAvailability().then(function(t){var r="";r=d.getPlatformID(),e.is(r)&&""!==r||(r=e.is(widget.getValue("x3dPlatformId"))?widget.getValue("x3dPlatformId"):"OnPremise",d.setPlatformID(r)),widget.setTitle(r),o.getServiceUrl({serviceName:"3DSpace",platformId:r,onComplete:function(e){d.setURL(e),h.bones=h.buildSkeleton(),widget.body.setContent(h.bones.render())},onFailure:function(e){var t=d.createWdgAlert();t.inject(widget.body,"top");var r=_.get("SearchInfra.URLBuildError");r+=e,t.add({className:"error applyChangesAlert",message:r})}})},function(e){r(_.get("html.license"))})},function(e){r(_.get("html.platform"))}),d.removeMask(widget.body)},onViewChange:function(e){}};return h}),define("DS/SearchControlCenter/scripts/SearchcontrolGeneralTabCategories",["UWA/Element","UWA/Core","UWA/Promise","DS/Controls/Button","DS/Controls/Toggle","DS/Controls/ComboBox","DS/WUXAutoComplete/AutoComplete","DS/Controls/LineEditor","DS/UIKIT/IconDropdown","DS/UIKIT/Popover","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/SNInfraUX/SNVocabAccess","DS/SNInfraUX/SearchResultCategories","DS/SearchControlCenter/scripts/SearchControlCenterServices","css!DS/SearchControlCenter/SearchControlCenter","i18n!DS/SearchControlCenter/assets/nls/SearchControlCenter.json","text!DS/SearchControlCenter/assets/SearchControlCenter_defaults.json","DS/SNInfraUX/SearchSettings","DS/SNInfraUX/SearchUtils","DS/SNInfraUX/SearchPreferences"],function(e,t,r,a,i,n,s,o,c,l,d,_,h,u,p,g,f,m,C,v,y){"use strict";var b="fake:dashboard",S={_categories:null,_parentDiv:null,_vocabPromise:{},render:function(e){this._parentDiv=e},loadCategories:function(){if(S._categories.suggestion=S._categories.suggestion||{},!t.is(S._categories.suggestion.list,"array")){var e=JSON.parse(m);S._categories.suggestion.list=e.result_categories.suggestion.list.concat([])}S._categories.suggestion.list=S._categories.suggestion.list||[];for(var r=S._categories.suggestion.list.length-1;r>=0;r--)!1===S._categories.suggestion.list[r].active&&S._categories.suggestion.list.splice(r,1);return S._categories},getTabInputsToStore:function(e){return-1!==["iphone","ipad","android"].indexOf(v.getDeviceCategory())?(y.setItem("InstantSearchSCC",!1),void y.commit()):C.getOption("deactivate_FUN108944")?void 0:(e.result_categories=S._categories,e.activate_instant_search=S.checkboxActivateInstantSearch.checkFlag,e.activate_instant_search_apps=S.checkboxActivateApplicationCategory.checkFlag,e)},onResetTab:function(e){if(-1!==["iphone","ipad","android"].indexOf(v.getDeviceCategory()))return y.setItem("InstantSearchSCC",!1),void y.commit();C.getOption("deactivate_FUN108944")||(this._categories=t.is(e.result_categories)?t.clone(e.result_categories):{},this.loadCategories(),this.renderInstantSearchSection(this._parentDiv),t.is(e.activate_instant_search)&&(this.checkboxActivateInstantSearch.checkFlag=e.activate_instant_search),t.is(e.activate_instant_search_apps)?this.checkboxActivateApplicationCategory.checkFlag=e.activate_instant_search_apps:this.checkboxActivateApplicationCategory.checkFlag=!0,this.setCategoriesSectionEnableState())},_checkActivateInstantSearch:function(){0==this._categories.suggestion.list.length?(this.checkboxActivateInstantSearch.checkFlag=!1,this.checkboxActivateInstantSearch.disabled=!0):this.checkboxActivateInstantSearch.disabled=!1},renderInstantSearchSection:function(t){this.divInstantSearchSection&&this.divInstantSearchSection.destroy(),this.divInstantSearchSection=e.create("div",{class:"",id:"general-tab-instantsearch-section"}).inject(t);var r=e.create("div",{class:"",id:"general-tab-instantsearch-title"}).inject(this.divInstantSearchSection);e.create("p",{class:"search_center_text_heading",text:f.get("General.Instant_search.Title")}).inject(r),this.renderActivateInstantSearch(this.divInstantSearchSection),this.renderActivateApplicationCategory(this.divInstantSearchSection),this.renderCategoriesSection(this.divInstantSearchSection)},renderActivateInstantSearch:function(t){var r=e.create("div",{class:"search_center_general_tab_div search_center_margin",id:"general-tab-activate-instant-search"}).inject(t),a=e.create("div",{class:"search_center_div_uidisplay search_center_general_display_flex",id:"general-tab-activate-instant-search-toggle"}).inject(r);this.checkboxActivateInstantSearch=new i({type:"checkbox",label:f.get("InstantSearch.Activate_Instant_Search"),className:"primary",touchMode:"true"}).inject(a);var n=e.create("span",{class:"fonticon fonticon-info search_center_margin_icon"}).inject(r);new l({target:n,trigger:"hover",animate:"true",position:"top",body:f.get("InstantSearch.Activate_Instant_Search.popover"),title:""}),this.checkboxActivateInstantSearch.addEventListener("change",function(){S.setCategoriesSectionEnableState(),p.enableButtons()})},renderActivateApplicationCategory:function(t){this.divActivateApplicationCategorySpan&&this.divActivateApplicationCategorySpan.destroy(),this.divActivateApplicationCategorySpan=e.create("div",{class:"search_center_general_tab_div search_center_margin",id:"general-tab-activate-application-category"}).inject(t);var r=e.create("div",{class:"search_center_div_uidisplay search_center_general_display_flex",id:"general-tab-activate-application-category-toggle"}).inject(this.divActivateApplicationCategorySpan);this.checkboxActivateApplicationCategory=new i({type:"checkbox",label:f.get("InstantSearch.Activate_Application_Category"),className:"primary",touchMode:"true"}).inject(r);var a=e.create("span",{class:"fonticon fonticon-info search_center_margin_icon"}).inject(this.divActivateApplicationCategorySpan);new l({target:a,trigger:"hover",animate:"true",position:"top",body:f.get("InstantSearch.Activate_Application_Category.popover"),title:""}),this.checkboxActivateApplicationCategory.addEventListener("change",function(){p.enableButtons()})},renderCategoriesSection:function(t){this.divCategoriesSection&&this.divCategoriesSection.remove(),t||(t=this._parentDiv),this.divCategoriesSection=e.create("div",{class:"search_center_category_section"}).inject(t),this.renderAddCategorySection(this.divCategoriesSection),this.renderCategories(this.divCategoriesSection),this._checkActivateInstantSearch()},renderCategories:function(t){var a=this;return this._renderedCategories=[],this.divCreatedCategoriesSection=e.create("div",{class:"search_center_created_categories_section"}).inject(t),this.divCreatedCategoriesSectionHeader=e.create("div",{class:"search_center_created_categories_section_header ",html:f.get("InstantSearch.Categories.section.header")}).inject(this.divCreatedCategoriesSection),new r(function(e,t){var i=a.loadCategories(),n=[];i.suggestion.list.forEach(function(e,t){n.push(a.ensureVocabLoaded(e.source))});var s=[];r.all(n).then(function(t){i.suggestion.list.forEach(function(e,r){s.push(a.renderCategoryRow(e,a.divCreatedCategoriesSection,t[r]))}),r.all(s).then(e)})})},setCategoriesSectionEnableState:function(){1==this.checkboxActivateInstantSearch.checkFlag?(this.divCategoriesSection.removeClassName("search_center_disable"),this.divActivateApplicationCategorySpan.removeClassName("search_center_disable")):(this.divCategoriesSection.addClassName("search_center_disable"),this.divActivateApplicationCategorySpan.addClassName("search_center_disable"))},_createAddCategoryRowSpan:function(t){var r=e.create("div",{class:t.class,id:t.id}).inject(t.parentDiv);return r.addClassName("search_center_add_category_row_span"),r},_createCategoryRowSpan:function(t){var r=e.create("div",{class:t.class,id:t.id}).inject(t.parentDiv);return r.addClassName("search_center_category_row_span"),r},_createCategoryTitleControl:function(t){var r=e.create("div",{class:t.class,id:t.id}).inject(t.divRow),a=new o({placeholder:f.get("InstantSearch.Title_Instant_Search"),touchMode:!0}).inject(r);a.elements.container.setStyle("display","grid"),a.elements.container.setStyle("max-width","unset");var i=this;return a.addEventListener("change",function(){var e=a.value.trim(),r=i._validateCategoryTitle(e,t.category_id);if(e&&r){if(!a.elements.container.hasClassName("result_category_input_error")){a.elements.container.addClassName("result_category_input_error");var n=p.createWdgAlert();n.inject(a.elements.container,"top");var s=f.get("InstantSearch.Category.DuplicateTitle",{title:r});n.add({className:"warning applyChangesAlert",message:s})}}else a.elements.container.removeClassName("result_category_input_error");i.enableAddCategoryButton()}),a},_createCategoryDatasourceControl:function(r){var a=e.create("div",{class:r.class,id:r.id}).inject(r.divRow),i=new n({placeholder:f.get("Choose_data_source"),touchMode:!0,enableSearchFlag:!0,elementsList:[]}).inject(a);i.elements.container.setStyle("width","100%"),this.getDataSourceList().then(function(e){if(i.elementsList=e,t.is(r.selectedSource)){var a=e.indexOf(p.getDatasourceDisplayName(r.selectedSource));a>=0&&(i.selectedIndex=a)}});var s=this;return i.addEventListener("change",function(){s.enableAddCategoryButton()}),i},_createCategoryTypeControl:function(r){var a=e.create("div",{class:r.class,id:r.id}).inject(r.divRow),i=new s({placeholder:f.get("Choose_type"),touchMode:!0,disabled:!0,enableSearchFlag:!0}).inject(a);function n(e,t){var r=[];return e.getChildren().forEach(function(e,a){t.indexOf(e.getAttributeValue("uri"))>=0&&r.push(e)}),r}function o(e){if(e.getChildren().length>0)i.elementsTree=e,i.disabled=!1,1==e.getChildren().length&&(i.selectedItems=n(e,e.getChildren()[0].getAttributeValue("uri")?[e.getChildren()[0].getAttributeValue("uri")]:[]),i.disabled=!0);else{i.disabled=!0;var t=p.createWdgAlert(),r=f.get("SearchType.NoTypesWarning");t.add({className:"warning applyChangesAlert",message:r})}c._promiseTypeListLoaded&&c._promiseTypeListLoaded.resolve(e)}i.elements.container.setStyle("max-width","unset");var c=this,l=r.datasourceComboBox;return l&&l.addEventListener("change",function(){var e=p.getDatasourceInternalName(l.currentValue);c.ensureVocabLoaded(e).then(o)}),r.vocabTypesTreeDocument&&(o(r.vocabTypesTreeDocument),t.is(r.selectedTypes,"array")&&(i.selectedItems=n(r.vocabTypesTreeDocument,r.selectedTypes))),i.addEventListener("change",function(){var e=i.selectedItems.length,t=C.getOption("instant_search_category_max_types");if(e>t){if(!i.elements.container.hasClassName("result_category_input_error")){i.elements.container.addClassName("result_category_input_error");var r=p.createWdgAlert();r.inject(i.elements.container,"top");var a=f.get("InstantSearch.Category.TypeCountMax",{max_count:t});r.add({className:"warning applyChangesAlert",message:a})}}else i.elements.container.removeClassName("result_category_input_error");c.enableAddCategoryButton()}),i},_getCategoryRowTitleHtml:function(e){return u.getCategoryTitleNls(e)},_getCategoryRowTitleAndSourceSeparatorHtml:function(){return" - "},_getCategoryRowSourceAndTypesSeparatorHtml:function(){return" - "},_getCategoryRowTypesSeparatorHtml:function(){return", "},_getCategoryRowSourceHtml:function(e){return p.getDatasourceDisplayName(e.source)||"Source Not Found"},_getCategoryRowTypesHtml:function(e,r){var a=this,i="";return t.is(e.types,"array")&&r.getChildren().forEach(function(t,r){var n=t.getAttributeValue("uri");e.types.indexOf(n)>=0?(i&&(i+=a._getCategoryRowTypesSeparatorHtml()),i+=p.getTypesDisplayName(e.source,n)):n==b&&(i+=t.getAttributeValue("nls"))}),i},_getCategoryRowHtml:function(e){var t=this._getCategoryRowTitleHtml(e.category);return t+=this._getCategoryRowTitleAndSourceSeparatorHtml(e),t+=this._getCategoryRowSourceHtml(e.category),t+=this._getCategoryRowSourceAndTypesSeparatorHtml(e),t+=this._getCategoryRowTypesHtml(e.category,e.model)},_createCategoryRowHtmlDiv:function(t){var r=e.create("div",{class:t.class,id:t.id,html:this._getCategoryRowHtml(t)}).inject(t.parentDiv);return r.addClassName("search_center_category_row_html"),r},_setSelectedDatasource:function(e){var r=this;this.getDataSourceList().then(function(a){if(r.datasourceComboBox.elementsList=a,t.is(e)){var i=a.indexOf(p.getDatasourceDisplayName(e));i>=0&&(r.datasourceComboBox.selectedIndex=i)}})},_setSelectedTypes:function(e,t){var r=[];e.getChildren().forEach(function(e,a){t.indexOf(e.getAttributeValue("uri"))>=0&&r.push(e)}),this.typeAutocomplete.selectedItems=r},_setCategoryInEditMode:function(e){var t=this;e.parentDiv.addClassName("search_category_row_in_edit"),t._categoryInMod=e.category.id,t._disableDeleteModifyAllCategories(),t.categoryTitleLine.value=u.getCategoryTitleNls(e.category),t._promiseTypeListLoaded=r.deferred(),t._promiseTypeListLoaded.promise.then(function(r){t._setSelectedTypes(r,e.category.types),t.divAddCategoriesSection.removeClassName("search_center_disable")}),t._setSelectedDatasource(e.category.source),t.cancelAddCategoryButton.show(),t.addCategoryButton.disabled=!0,t.addCategoryButton.label=f.get("InstantSearch.Category.Action.SaveCategory")},_createCategoryRowActionsDiv:function(t){var r=this,a=e.create("div",{class:t.class,id:t.id}).inject(t.parentDiv);a.addClassName("search_result_category_row_actions");var i=e.create("div",{class:"fonticon fonticon-1x fonticon-pencil search_result_category_row_action"}).inject(a);i.addEventListener("click",function(){r._setCategoryInEditMode(t)},!1),i.addEventListener("mouseover",function(){i.addClassName("search_category_action_mouse_hover")},!1),i.addEventListener("mouseout",function(){i.removeClassName("search_category_action_mouse_hover")},!1);var n=e.create("div",{class:"fonticon fonticon-trash search_result_category_row_action"}).inject(a);return n.addEventListener("click",function(){r._removeCategoryModel(t.category.id),p.enableButtons(),r.renderCategoriesSection()},!1),n.addEventListener("mouseover",r._manageMouseOver,!1),n.addEventListener("mouseout",r._manageMouseOut,!1),a},renderCategoryRow:function(e,t,a){var i=this;return new r(function(r,n){var s=i._createCategoryRowSpan({class:"search_center_general_tab_div search_center_margin",id:"search-result-category-"+e.id,parentDiv:t});i._createCategoryRowHtmlDiv({class:"search_center_general_tab_div search_center_margin",id:"search-result-category-html-"+e.id,parentDiv:s,category:e,model:a}),i._createCategoryRowActionsDiv({class:"search_center_margin",model:a,category:e,parentDiv:s}),i._renderedCategories.push({id:e.id,div:s}),r()})},enableAddCategoryButton:function(){this.categoryTitleLine.value.trim()&&!this.categoryTitleLine.elements.container.hasClassName("result_category_input_error")&&this.datasourceComboBox.currentValue&&!this.typeAutocomplete.elements.container.hasClassName("result_category_input_error")?this.addCategoryButton.disabled=!1:this.addCategoryButton.disabled=!0},renderAddButtonCategoryRow:function(t){var r=this,i=e.create("div",{class:"search_center_general_tab_div search_center_margin search_center_category_add",id:"add-search-result-category"}).inject(t),n=e.create("div",{class:"search_center_div_uidisplay search_center_general_display_flex search_center_category_add_cancel",id:"add-search-result-category-cancel-button"}).inject(i);this.cancelAddCategoryButton=new a({touchMode:!0,disabled:!1,label:f.get("InstantSearch.Category.Action.CancelAddCategory")}).inject(n),this.cancelAddCategoryButton.getContent().addEventListener("buttonclick",function(){r.renderCategoriesSection()}),this.cancelAddCategoryButton.hide();var s=e.create("div",{class:"search_center_div_uidisplay search_center_general_display_flex search_center_category_add_add",id:"add-search-result-category-add-button"}).inject(i);this.addCategoryButton=new a({emphasize:"primary",touchMode:!0,disabled:!0,label:f.get("InstantSearch.Category.Action.AddNewCategory")}).inject(s);var o=C.getOption("instant_search_category_max_categories");this._categories.suggestion.list.length>=o&&t.addClassName("search_center_disable"),this.addCategoryButton.getContent().addEventListener("buttonclick",function(){function e(e){r.typeAutocomplete.selectedItems&&r.typeAutocomplete.selectedItems.forEach(function(t,r){var a=t.getAttributeValue("uri");a&&(a==b&&(a="Dashboard",e.match_on="context_name"),e.types.push(a))})}if(r._categoryInMod){var t={id:r._categoryInMod,custom:!0,name:r.categoryTitleLine.value,source:p.getDatasourceInternalName(r.datasourceComboBox.currentValue),types:[]};e(t),r._replaceCategoryModel(t)}else{var a={id:(new Date).getTime(),custom:!0,name:r.categoryTitleLine.value,source:p.getDatasourceInternalName(r.datasourceComboBox.currentValue),types:[]};e(a),r._addCategoryModel(a)}p.enableButtons(),r.renderCategoriesSection()})},renderAddCategorySection:function(t){this.divAddCategoriesSection=e.create("div",{class:"search_center_add_category_section"}).inject(t);var r=this._createAddCategoryRowSpan({class:"search_center_general_tab_div search_center_margin",id:"add-search-result-category-row1",parentDiv:this.divAddCategoriesSection}),a=this._createCategoryTitleControl({class:"search_center_category_title",id:"search-result-category-title",divRow:r}),i=this._createCategoryDatasourceControl({class:"search_center_category_source",id:"add-search-result-category-source-combo",divRow:r});i.disabled=!1;var n=this._createAddCategoryRowSpan({class:"search_center_general_tab_div search_center_margin",id:"add-search-result-category-row2",parentDiv:this.divAddCategoriesSection}),s=this._createCategoryTypeControl({class:"search_center_category_types",id:"add-search-result-category-type-combo",divRow:n,datasourceComboBox:i});this.categoryTitleLine=a,this.datasourceComboBox=i,this.typeAutocomplete=s,this._categoryInMod=null,this.renderAddButtonCategoryRow(this.divAddCategoriesSection)},_removeCategoryModel:function(e){for(var t=0;t<this._categories.suggestion.list.length;t++)if(this._categories.suggestion.list[t].id==e){this._categories.suggestion.list.splice(t,1);break}},_replaceCategoryModel:function(e){for(var t=0;t<this._categories.suggestion.list.length;t++)if(this._categories.suggestion.list[t].id==e.id){this._categories.suggestion.list.splice(t,1,e);break}},_validateCategoryTitle:function(e,t){for(var r=0;r<this._categories.suggestion.list.length;r++){var a=u.getCategoryTitleNls(this._categories.suggestion.list[r]);if(a.toLowerCase()==e.toLowerCase()&&(!this._categoryInMod||this._categoryInMod&&this._categories.suggestion.list[r].id!=this._categoryInMod))return a}return!1},_addCategoryModel:function(e){this._categories.suggestion.list.push(e)},_disableDeleteModifyAllCategories:function(){S._renderedCategories.forEach(function(e,t){e.div.addClassName("search_center_disable")})},ensureVocabLoaded:function(e){var a=this;return this._vocabPromise[e]||(this._vocabPromise[e]=new r(function(r,i){a.getDataSourceList().then(function(){var a={};a.vocabId=p._datSourceToVocabID[e],a.tenantId=p.platformID,h.loadVocabularyClasses(a,function(a){var i=[],n={},s=new d;if(s.prepareUpdate(),"dashboard"==e&&0==a.classInfos.length&&(a.classInfos=[{nlsName:f.get("Type.dashboard"),uri:b}]),"drive"==e){var o=new _({label:""});s.addRoot(o)}else for(let e=0;e<a.classInfos.length;e++)if(t.is(a.classInfos[e].nlsName,"string")&&t.is(a.classInfos[e].uri)){i.push(a.classInfos[e].nlsName),n[a.classInfos[e].uri]=a.classInfos[e].nlsName;o=new _({label:a.classInfos[e].nlsName,grid:{nls:a.classInfos[e].nlsName,uri:a.classInfos[e].uri}});s.addRoot(o)}s.pushUpdate(),p.updateTypesMapping(e,n),r(s)})})})),this._vocabPromise[e]},getDataSourceList:function(){function e(e){for(var t=-1,r=e.concat(),a=0;a<r.length;a++)if("other"===p.getDatasourceInternalName(r[a])){t=a;break}return t>-1&&r.splice(t,1),r}return this._datasourceListPromise||(this._datasourceListPromise=new r(function(r,a){var i=C.getOption("dataSourcesToFilterFromAdvancedSearch");delete i.dashboard;var n=p.getDataSourceList({dataSourcesToFilterFromAdvancedSearch:i});t.is(n,"array")?r(e(n)):n.then(function(t){r(e(t))})})),this._datasourceListPromise}};return S}),define("DS/SearchControlCenter/scripts/SCCSynonymsDictonary",["UWA/Element","UWA/Core","DS/Controls/Toggle","DS/UIKIT/Input/File","DS/UIKIT/Input/Button","DS/UIKIT/Popover","DS/UIKIT/Modal","i18n!DS/SearchControlCenter/assets/nls/SearchControlCenter.json","DS/SearchControlCenter/scripts/SearchControlCenterServices"],function(e,t,r,a,i,n,s,o,c){"use strict";return{importButton:null,fileChooser:null,checkboxActivateSynonyms:null,jsonReader:null,newSynonymsToStore:null,storedSynonyms:null,onRender:function(s){var l=this,d=e.create("div",{class:"search_center_div_left search_center_general_display_flex",id:"general-tab-search_synonyms-text"}).inject(s);e.create("p",{class:"search_center_text_heading",text:o.get("GeneralTab.SearchSynonyms.title")}).inject(d);var _=e.create("div",{class:"search_center_general_tab_div search_center_margin",id:"general-tab-abbreviated-count"}).inject(s),h=e.create("div",{class:"search_center_div_uidisplay search_center_general_display_flex",id:"general-tab-activate-synonyms-toggle"}).inject(_);this.checkboxActivateSynonyms=new r({type:"checkbox",label:o.get("GeneralTab.SearchSynonyms.checkbox.label"),className:"primary",touchMode:"true"}).inject(h),this.checkboxActivateSynonyms.addEventListener("change",function(){!t.is(l.storedSynonyms)&&l.checkboxActivateSynonyms.checkFlag||c.enableButtons(),l._setBrowseFileState(l.checkboxActivateSynonyms.checkFlag)},!1);var u=e.create("span",{class:"fonticon fonticon-info search_center_margin_icon"}).inject(_);new n({target:u,trigger:"hover",animate:"true",position:"top",body:o.get("GeneralTab.SearchSynonyms.checkbox.info"),title:""}),this.divFileChooserSpan=e.create("div",{class:"search_center_margin search_center_disable",id:"div-file-chooser-span"}).inject(s);var p=e.create("div",{class:"",id:"div-file-chooser-lable"}).inject(this.divFileChooserSpan),g=(e.create("p",{class:"search_center_text",text:o.get("GeneralTab.SearchSynonyms.FileChooser.label"),styles:{}}).inject(p),e.create("div",{class:"search_center_div_uidisplay search_center_general_display_flex",id:"search-type-display"}).inject(this.divFileChooserSpan)),f=e.create("div",{class:"",id:"search-synonyms-file-chooser",styles:{width:"85%",position:"relative"}}).inject(g);this.fileChooser=new a({multiple:!1,buttonBefore:!1,name:"file-input",buttonClassName:"default",placeholder:o.get("GeneralTab.SearchSynonyms.FileChooser.placeholder.new"),buttonText:o.get("GeneralTab.SearchSynonyms.FileChooser.buttonText"),events:{onChange:this._onFileInputChange.bind(this)}}).inject(f);var m=e.create("div",{class:"",id:"search-synonyms-file-import",styles:{"margin-left":"5px","margin-right":"5px",width:"15%",position:"center"}}).inject(g),C=this;this.importButton=new i({id:"import_button_id",value:o.get("GeneralTab.SearchSynonyms.FileChooser.validate"),className:"default",disabled:!0,events:{onClick:function(){C._onImportClick()}}}).inject(m)},_onFileInputChange:function(e){var r=e.target.files[0],a=r.name;t.is(a,"string")&&("json"===a.slice(2+(a.lastIndexOf(".")-1>>>0))?t.is(this.storedSynonyms)?this._confirmAndReadFileAsText(r):this._readFileAsText(r):(this.importButton.disable(),this.fileChooser.clear(),this._showAlert(o.get("GeneralTab.SearchSynonyms.errors.JsonOnly"),"error")))},_onImportClick:function(){try{this._isValidJson(this.jsonReader)&&(c.enableButtons(),this._showAlert(o.get("GeneralTab.SearchSynonyms.success.ValidJson"),"success"))}catch(e){this.fileChooser.clear(),this._showAlert(e.message,"error")}this.importButton.disable()},_isValidJson:function(e){var r=null;if(!t.is(e.result))throw new Error(o.get("GeneralTab.SearchSynonyms.errors.InvalidJson"));try{r=JSON.parse(e.result)}catch(e){throw new Error(o.get("GeneralTab.SearchSynonyms.errors.ParsingError"))}if(!t.is(r,"object"))throw new Error(o.get("GeneralTab.SearchSynonyms.errors.UnsupportedFormat"));return Object.keys(r).forEach(function(e){if(!t.is(r[e],"array"))throw new Error(o.get("GeneralTab.SearchSynonyms.errors.UnsupportedFormat"));r[e].forEach(e=>{if(!t.is(e,"string"))throw new Error(o.get("GeneralTab.SearchSynonyms.errors.UnsupportedFormat"))})}),this.newSynonymsToStore=r,!0},updateTabInputsToStore:function(e){let r={};r.activateSnonyms=this.checkboxActivateSynonyms.checkFlag,r.synonyms=t.is(this.newSynonymsToStore)?this.newSynonymsToStore:this.storedSynonyms,e.search_synonyms=r},onResetTab:function(e){if(t.is(e)){var r=e.activateSnonyms;this.storedSynonyms=e.synonyms,this.checkboxActivateSynonyms.checkFlag=r,t.is(this.storedSynonyms)&&(this.fileChooser.elements.textfield.placeholder=o.get("GeneralTab.SearchSynonyms.FileChooser.placeholder.override"))}else this.fileChooser.elements.textfield.placeholder=o.get("GeneralTab.SearchSynonyms.FileChooser.placeholder.new"),this.checkboxActivateSynonyms.checkFlag=!1,this.storedSynonyms=null;this.fileChooser.clear(),this.importButton.disable()},_showAlert:function(e,t){var r=c.createWdgAlert();r.inject(widget.body,"top"),r.add({className:t,message:e})},_readFileAsText:function(e){"undefined"!=typeof FileReader&&(this.jsonReader=new FileReader,this.jsonReader.readAsText(e),this.importButton.enable())},_confirmAndReadFileAsText:function(e){var t=this,r=new s({header:o.get("GeneralTab.SearchSynonyms.warning.header"),closable:!1,escapeToClose:!1,visible:!0,body:o.get("GeneralTab.SearchSynonyms.warning.body"),footer:[new i({className:"primary",value:o.get("GeneralTab.SearchSynonyms.warning.button.Yes"),events:{onClick:function(){t._readFileAsText(e),r.destroy()}}}),new i({value:o.get("GeneralTab.SearchSynonyms.warning.button.No"),events:{onClick:function(){t.fileChooser.clear(),t.importButton.disable(),r.destroy()}}})]}).inject(document.body)},_setBrowseFileState:function(e){!0===e?this.divFileChooserSpan.removeClassName("search_center_disable"):this.divFileChooserSpan.addClassName("search_center_disable")}}}),define("DS/SearchControlCenter/scripts/SearchcontrolGeneralTab",["UWA/Element","UWA/Core","DS/Controls/Toggle","DS/Controls/ComboBox","DS/Controls/Editor","DS/UIKIT/Popover","DS/MessageBus/MessageBus","DS/SearchControlCenter/scripts/SearchControlCenterServices","DS/SearchControlCenter/scripts/SearchcontrolGeneralTabCategories","css!DS/SearchControlCenter/SearchControlCenter","i18n!DS/SearchControlCenter/assets/nls/SearchControlCenter.json","i18n!DS/SNResultUX/assets/nls/SNResultUX.json","DS/SNInfraUX/Logger","DS/SNInfraUX/SearchSettings","DS/SNResultUX/utils/SearchViewOptions","DS/SearchControlCenter/scripts/SCCSynonymsDictonary"],function(e,t,r,a,i,n,s,o,c,l,d,_,h,u,p,g){"use strict";var f={viewModeComboBox:null,deltaTimeComboBox:null,dateModeComboBox:null,csvSeparatorComboBox:null,revisionComboBox:null,numberResultComboBox:null,checkboxAbbreviatedcount:null,checkboxAccessPLMParameters:null,checkboxSuggestions:null,checkboxSnippets:null,checkboxForceAdvSearch:null,_viewModeObject:{},_dateModeObject:{},_csvSeparatorObject:{},_revisionObject:{},onRenderFacet:function(i){var s=u.getOption("OneSearch"),l=e.create("div",{class:"search_center_main_div",id:"search-center-general0"}).inject(i),m=e.create("div",{class:"search_center_div_left search_center_general_display_flex",id:"general-tab-resultsdisplay-text"}).inject(l);e.create("p",{class:"search_center_text_heading",text:d.get("General.Results_display")}).inject(m);var C=e.create("div",{class:"search_center_general_tab_div search_center_top_margin",id:"general-tab-view-mode"}).inject(l),v=e.create("div",{class:"search_center_div_left search_center_general_display_flex",id:"general-tab-view-mode-text"}).inject(C),y=e.create("div",{class:"search_center_div_right",id:"general-tab-view-mode-combo"}).inject(C);e.create("p",{class:"search_center_text",text:d.get("Default_View_Mode_After_CacheCleaning")}).inject(v);var b=e.create("span",{class:"fonticon fonticon-info search_center_margin_icon"}).inject(C);new n({target:b,trigger:"hover",animate:"true",position:"top",body:d.get("Default_View_Mode_After_CacheCleaning.popover"),title:""});var S=[],x=s;if(f._viewModeObject=p.getAvailableViews({simple_search_experience:x,getAllViews:!0}),t.is(f._viewModeObject)&&f._viewModeObject.length>0)for(let e=0;e<f._viewModeObject.length;e++){var D={},A=f._viewModeObject[e];D.labelItem=A.title,D.iconItem=A.icon,S.push(D)}f.viewModeComboBox=new a({elementsList:S,nbDisplayedElements:S.length,currentValue:S[0],touchMode:!0,enableSearchFlag:!0}).inject(y),y.setStyle("display","grid"),f.viewModeComboBox.elements.container.setStyle("max-width","unset");var T=e.create("div",{class:"search_center_general_tab_div search_center_margin",id:"general-tab-recent-time"}).inject(l),w=e.create("div",{class:"search_center_div_left search_center_general_display_flex",id:"general-tab-recent-time-text"}).inject(T),I=e.create("div",{class:"search_center_div_right",id:"general-tab-recent-time-combo"}).inject(T);e.create("p",{class:"search_center_text",text:d.get("Recent_Content_Delta_Time")}).inject(w);var N=e.create("span",{class:"fonticon fonticon-info search_center_margin_icon"}).inject(T);new n({target:N,trigger:"hover",animate:"true",position:"top",body:d.get("Recent_Content_Delta_Time.popover"),title:""});var j=["5"+d.get("Minutes"),"10"+d.get("Minutes"),"15"+d.get("Minutes"),"20"+d.get("Minutes"),"25"+d.get("Minutes"),"30"+d.get("Minutes")];if(f.deltaTimeComboBox=new a({elementsList:j,nbDisplayedElements:j.length,currentValue:j[0],touchMode:!0,enableSearchFlag:!0}).inject(I),I.setStyle("display","grid"),f.deltaTimeComboBox.elements.container.setStyle("max-width","unset"),f._dateModeObject=u.getOption("date_display_mode_array"),t.is(f._dateModeObject,"array")&&f._dateModeObject.length>0){var O=[];for(let e=1;e<f._dateModeObject.length;e++){var W=f._dateModeObject[e];t.is(W,"object")&&t.is(W.id,"string")?O.push(_.get(W.id+".title")):h.error("Bad definition of date_display_mode_array !!!",f._dateModeObject)}if(O.length>0){var B=e.create("div",{class:"search_center_general_tab_div search_center_top_margin",id:"general-tab-date-mode"}).inject(l),P=e.create("div",{class:"search_center_div_left search_center_general_display_flex",id:"general-tab-date-mode-text"}).inject(B),F=e.create("div",{class:"search_center_div_right",id:"general-tab-date-mode-combo"}).inject(B);e.create("p",{class:"search_center_text",text:_.get("Default_Date_Mode")}).inject(P),f.dateModeComboBox=new a({elementsList:O,nbDisplayedElements:O.length,currentValue:O[0],touchMode:!0,enableSearchFlag:!0}).inject(F),F.setStyle("display","grid"),f.dateModeComboBox.elements.container.setStyle("max-width","unset")}}if(f._csvSeparatorObject=u.getOption("csvSeparatorArray"),t.is(f._csvSeparatorObject,"array")&&f._csvSeparatorObject.length>0){var k=[];for(let e=1;e<f._csvSeparatorObject.length;e++){var M=f._csvSeparatorObject[e];t.is(M,"object")&&t.is(M.id,"string")?k.push(_.get(M.id+".title")):h.error("Bad definition of csvSeparatorArray !!!",f._csvSeparatorObject)}if(k.length>0){var R=e.create("div",{class:"search_center_general_tab_div search_center_top_margin",id:"general-tab-csv-mode"}).inject(l),E=e.create("div",{class:"search_center_div_left search_center_general_display_flex",id:"general-tab-csv-mode-text"}).inject(R),L=e.create("div",{class:"search_center_div_right",id:"general-tab-csv-mode-combo"}).inject(R);e.create("p",{class:"search_center_text",text:_.get("Default_Csv_Separator")}).inject(E),f.csvSeparatorComboBox=new a({elementsList:k,nbDisplayedElements:k.length,domId:"combo-csv-mode",currentValue:k[0],touchMode:!0,enableSearchFlag:!0}).inject(L),L.setStyle("display","grid"),f.csvSeparatorComboBox.elements.container.setStyle("max-width","unset")}}if(f._revisionObject=u.getOption("show_search_results_revision_array"),t.is(f._revisionObject)&&f._revisionObject.length>0){var U=[];for(let e=0;e<f._revisionObject.length;e++){var V=f._revisionObject[e];t.is(V,"object")&&t.is(V.id,"string")?U.push(_.get(V.id+".title")):h.error("Bad definition of show_search_results_revision_array !!!",f._revisionObject)}if(U.length>0){var H=e.create("div",{class:"search_center_general_tab_div search_center_top_margin",id:"general-tab-revision"}).inject(l),J=e.create("div",{class:"search_center_div_left search_center_general_display_flex",id:"general-tab-revision-type-text"}).inject(H),z=e.create("div",{class:"search_center_div_right",id:"general-tab-revision-type-combo"}).inject(H);e.create("p",{class:"search_center_text",text:_.get("Show_Search_Results")}).inject(J),f.revisionComboBox=new a({elementsList:U,nbDisplayedElements:U.length,currentValue:U[0],touchMode:!0,enableSearchFlag:!0}).inject(z),z.setStyle("display","grid"),f.revisionComboBox.elements.container.setStyle("max-width","unset")}}var X=e.create("div",{class:"search_center_general_tab_div search_center_margin",id:"general-tab-number-result"}).inject(l),G=e.create("div",{class:"search_center_div_left search_center_general_display_flex",id:"general-tab-number-result-text"}).inject(X),K=e.create("div",{class:"search_center_div_right",id:"general-tab-number-result-combo"}).inject(X);e.create("p",{class:"search_center_text",text:d.get("max_selection_for_selectall")}).inject(G);var q=e.create("span",{class:"fonticon fonticon-info search_center_margin_icon"}).inject(X);new n({target:q,trigger:"hover",animate:"true",position:"top",body:d.get("max_selection_for_selectall.popover"),title:""});var Q=["200"+d.get("Items"),"400"+d.get("Items"),"600"+d.get("Items"),"800"+d.get("Items"),"1000"+d.get("Items")];f.numberResultComboBox=new a({elementsList:Q,nbDisplayedElements:Q.length,currentValue:Q[0],touchMode:!0,enableSearchFlag:!0}).inject(K),K.setStyle("display","grid"),f.numberResultComboBox.elements.container.setStyle("max-width","unset");var Y=e.create("div",{class:"search_center_div_left search_center_general_display_flex",id:"general-tab-resultsdisplay-text"}).inject(l);e.create("p",{class:"search_center_text_heading",text:d.get("General.UI_display")}).inject(Y);var Z=e.create("div",{class:"search_center_general_tab_div search_center_margin",id:"general-tab-abbreviated-count"}).inject(l),$=e.create("div",{class:"search_center_div_uidisplay search_center_general_display_flex",id:"general-tab-abbreviated-count-toggle"}).inject(Z);f.checkboxAbbreviatedcount=new r({type:"checkbox",label:d.get("QuantityDisplay.Abbreviated_count_display"),className:"primary",touchMode:"true"}).inject($);var ee=e.create("span",{class:"fonticon fonticon-info search_center_margin_icon"}).inject(Z);new n({target:ee,trigger:"hover",animate:"true",position:"top",body:d.get("QuantityDisplay.Abbreviated_count_display.popover"),title:""});var te=e.create("div",{class:"search_center_general_tab_div",id:"general-tab-access-PLMParameters"}).inject(l),re=e.create("div",{class:"search_center_div_uidisplay search_center_general_display_flex",id:"general-tab-access-PLMParameters-toggle"}).inject(te);f.checkboxAccessPLMParameters=new r({type:"checkbox",label:d.get("Advancedsearch.Access_to_plmparameters.title"),className:"primary",touchMode:"true"}).inject(re);var ae=e.create("span",{class:"fonticon fonticon-info search_center_margin_icon"}).inject(te);new n({target:ae,trigger:"hover",animate:"true",position:"top",body:d.get("Advancedsearch.Access_to_plmparameters.popover"),title:""});var ie=u.getOption("OneSearchOFF");if(t.is(s)&&!0===s&&!0!==ie){var ne=e.create("div",{class:"search_center_general_tab_div",id:"general-tab-suggestions"}).inject(l),se=e.create("div",{class:"search_center_div_uidisplay search_center_general_display_flex",id:"general-tab-access-Suggestions-toggle"}).inject(ne);f.checkboxSuggestions=new r({type:"checkbox",label:d.get("suggestion.title"),className:"primary",touchMode:"true"}).inject(se);var oe=e.create("span",{class:"fonticon fonticon-info search_center_margin_icon"}).inject(ne);new n({target:oe,trigger:"hover",animate:"true",position:"top",body:d.get("suggestion.popover"),title:""});var ce=e.create("div",{class:"search_center_general_tab_div",id:"general-tab-snippets"}).inject(l),le=e.create("div",{class:"search_center_div_uidisplay search_center_general_display_flex",id:"general-tab-access-Snippets-toggle"}).inject(ce);f.checkboxSnippets=new r({type:"checkbox",label:d.get("search_snippets.title"),className:"primary",touchMode:"true"}).inject(le);var de=e.create("span",{class:"fonticon fonticon-info search_center_margin_icon"}).inject(ce);new n({target:de,trigger:"hover",animate:"true",position:"top",body:d.get("search_snippets.popover"),title:""}),f.checkboxSuggestions.addEventListener("change",function(){o.enableButtons()}),f.checkboxSnippets.addEventListener("change",function(){o.enableButtons()})}var _e=e.create("div",{class:"search_center_general_tab_div",id:"general-tab-force-AdvancedSearch"}).inject(l),he=e.create("div",{class:"search_center_div_uidisplay search_center_general_display_flex",id:"general-tab-force-AdvancedSearch-toggle"}).inject(_e);f.checkboxForceAdvSearch=new r({type:"checkbox",label:d.get("General.InContextSearch.forceAdvancedSearch.label"),className:"primary",touchMode:"true"}).inject(he);var ue=e.create("span",{class:"fonticon fonticon-info search_center_margin_icon"}).inject(_e);new n({target:ue,trigger:"hover",animate:"true",position:"top",body:d.get("General.InContextSearch.forceAdvancedSearch.popover"),title:""}),f.checkboxForceAdvSearch.addEventListener("change",function(){o.enableButtons()}),g.onRender(l),c.render(l),f.viewModeComboBox.addEventListener("change",function(){o.enableButtons()}),f.deltaTimeComboBox.addEventListener("change",function(){o.enableButtons()}),f.numberResultComboBox.addEventListener("change",function(){o.enableButtons()}),f.checkboxAbbreviatedcount.addEventListener("change",function(){o.enableButtons()}),f.checkboxAccessPLMParameters.addEventListener("change",function(){o.enableButtons()}),f.dateModeComboBox.addEventListener("change",function(){o.enableButtons()}),t.is(f.csvSeparatorComboBox)&&f.csvSeparatorComboBox.addEventListener("change",function(){o.enableButtons()}),f.revisionComboBox.addEventListener("change",function(){o.enableButtons()}),o.removeMask(widget.body)},getTabInputsToStore:function(){var e=f.deltaTimeComboBox.currentValue;t.is(e)&&(e=e.replace(d.get("Minutes"),""));var r=f.viewModeComboBox.currentValue;if(t.is(r))for(let e=0;e<f._viewModeObject.length;e++){var a=f._viewModeObject[e];if(r===a.title){r=a.id;break}}var i=f.numberResultComboBox.currentValue;t.is(i)&&(i=i.replace(d.get("Items"),""));var n=f.dateModeComboBox.currentValue;if(t.is(n))for(let e=0;e<f._dateModeObject.length;e++){var s=f._dateModeObject[e];if(n===_.get(s.id+".title")){n=s;break}}var o=t.is(f.csvSeparatorComboBox)?f.csvSeparatorComboBox.currentValue:_.get("COMMA.title");if(t.is(o))for(let e=0;e<f._csvSeparatorObject.length;e++){var l=f._csvSeparatorObject[e];if(o===_.get(l.id+".title")){o=l;break}}var h=f.revisionComboBox.currentValue;if(t.is(h))for(let e=0;e<f._revisionObject.length;e++){var p=f._revisionObject[e];if(h===_.get(p.id+".title")){h=p;break}}var m={defaultViewModeAfterCacheCleaning:r,defaultDateMode:n,defaultCsvSeparator:o,defaultRevision:h,Recent_Content_Delta_Time:e,max_selection_for_selectall:i,preciseCount:!0!==f.checkboxAbbreviatedcount.checkFlag,enablePLM:f.checkboxAccessPLMParameters.checkFlag,forceAdvancedSearch:f.checkboxForceAdvSearch.checkFlag},C=u.getOption("OneSearch"),v=u.getOption("OneSearchOFF");return t.is(C)&&!0===C&&!0!==v&&(m.suggest_admin=f.checkboxSuggestions.checkFlag,m.search_snippet_admin=f.checkboxSnippets.checkFlag),c.getTabInputsToStore(m),g.updateTabInputsToStore(m),m},onResetTab:function(e){var r;if(r=t.is(e,"string")?JSON.parse(e):e,t.is(r)){if(r.hasOwnProperty("defaultViewModeAfterCacheCleaning")){var a=r.defaultViewModeAfterCacheCleaning;if(t.is(a)){for(let e=0;e<f._viewModeObject.length;e++){var i=f._viewModeObject[e];if(a===i.id){a=i.title;break}}f.viewModeComboBox.currentValue=a}}if(r.hasOwnProperty("Recent_Content_Delta_Time")){var n=r.Recent_Content_Delta_Time;t.is(n)&&(n+=d.get("Minutes"),f.deltaTimeComboBox.currentValue=n)}if(r.hasOwnProperty("max_selection_for_selectall")){var s=r.max_selection_for_selectall;t.is(s)&&(s+=d.get("Items"),f.numberResultComboBox.currentValue=s)}if(r.hasOwnProperty("defaultDateMode")){var o=r.defaultDateMode;if(t.is(o)){for(let e=0;e<f._dateModeObject.length;e++){var l=f._dateModeObject[e];if(o.id===l.id){o=_.get(l.id+".title");break}}f.dateModeComboBox.currentValue=o}}else t.is(f._dateModeObject)&&t.is(f._dateModeObject[0])&&(f.dateModeComboBox.currentValue=_.get(f._dateModeObject[0].id+".title"));if(f.csvSeparatorComboBox)if(r.hasOwnProperty("defaultCsvSeparator")){var h=r.defaultCsvSeparator;if(t.is(h)){for(let e=0;e<f._csvSeparatorObject.length;e++){var p=f._csvSeparatorObject[e];if(h.id===p.id){h=_.get(p.id+".title");break}}f.csvSeparatorComboBox.currentValue=h}}else t.is(f._csvSeparatorObject)&&t.is(f._csvSeparatorObject[0])&&(f.csvSeparatorComboBox.currentValue=_.get(f._csvSeparatorObject[0].id+".title"));if(r.hasOwnProperty("defaultRevision")){var m=r.defaultRevision;if(t.is(m)){for(let e=0;e<f._revisionObject.length;e++){var C=f._revisionObject[e];if(m.id===C.id){m=_.get(C.id+".title");break}}f.revisionComboBox.currentValue=m}}else f.revisionComboBox.currentValue=_.get(f._revisionObject[0].id+".title");if(r.hasOwnProperty("preciseCount")){var v=r.preciseCount;t.is(v)&&(f.checkboxAbbreviatedcount.checkFlag=!0!==v)}if(r.hasOwnProperty("enablePLM")){var y=r.enablePLM;t.is(y)&&(f.checkboxAccessPLMParameters.checkFlag=y)}if(r.hasOwnProperty("forceAdvancedSearch")){var b=r.forceAdvancedSearch;t.is(b)&&(f.checkboxForceAdvSearch.checkFlag=b)}var S=u.getOption("OneSearch"),x=u.getOption("OneSearchOFF");if(t.is(S)&&!0===S&&!0!==x){if(r.hasOwnProperty("suggest_admin")){var D=r.suggest_admin;t.is(D)&&(f.checkboxSuggestions.checkFlag=D)}else f.checkboxSuggestions.checkFlag=!0;if(r.hasOwnProperty("search_snippet_admin")){var A=r.search_snippet_admin;t.is(A)&&(f.checkboxSnippets.checkFlag=A)}else f.checkboxSnippets.checkFlag=!0}c.onResetTab(r),g.onResetTab(r.search_synonyms)}}};return f}),define("DS/SearchControlCenter/scripts/ControlledVocabulary/SCCControlledVocabulary",["UWA/Element","UWA/Core","UWA/Promise","DS/Controls/Button","DS/Controls/Toggle","DS/Controls/ComboBox","DS/WUXAutoComplete/AutoComplete","DS/UIKIT/Popover","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/SearchControlCenter/scripts/ControlledVocabulary/ControlledVocabularyServices","DS/SearchControlCenter/scripts/SearchControlCenterServices","i18n!DS/SearchControlCenter/assets/nls/SearchControlCenter.json"],function(e,t,r,a,i,n,s,o,c,l,d,_,h){"use strict";return{communityOntologyMapping:[],render:function(e){this._parentDiv=e,this.renderControlledSection(this._parentDiv)},getTabInputsToStore:function(){return this.communityOntologyMapping},getInputFromStore:function(e){let t=this;e&&(this.communityOntologyMapping=e.slice(0)),this.ontologies&&0===Object.keys(this.ontologies).length&&empty.constructor===Object||t.divCreatedCategoriesSection&&(t.divCreatedCategoriesSection.empty(),t.communityOntologyMapping.forEach((e,r)=>{t.renderMappingsRow(t.divCreatedCategoriesSection,e)}))},renderControlledSection:function(t){this.mainControlDivSection=e.create("div",{class:"search_center_main_div ",id:"control-vocab-main"}).inject(t);var r=e.create("div",{class:"",id:"control-vocab-title"}).inject(this.mainControlDivSection);e.create("p",{class:"control_vocab_text_heading",text:h.get("6WTagsFilter.ControlledVocab.title")}).inject(r),this.renderActivateControlVocab(this.mainControlDivSection),this.renderCommunitySection(this.mainControlDivSection)},renderActivateControlVocab:function(t){var r=this,a=e.create("div",{class:"search_center_general_display_flex search_center_margin",id:"activate-control-vocab"}).inject(t),n=e.create("div",{class:"search_center_div_uidisplay search_center_general_display_flex",id:"activate-control_vocab-toggle"}).inject(a);this.checkboxActivateControlVocab=new i({type:"checkbox",label:h.get("6WTagsFilter.ControlledVocab.CheckBox.label"),className:"primary",touchMode:"true"}).inject(n);var s=e.create("span",{class:"fonticon fonticon-info search_center_margin_icon"}).inject(a);s.setStyle("color","#b4b6ba"),s.addEventListener("mouseover",this._manageMouseOver,!1),s.addEventListener("mouseout",this._manageMouseOut,!1),new o({target:s,trigger:"hover",animate:"true",position:"top",title:""}),this.checkboxActivateControlVocab.addEventListener("change",function(e){r.toggleDisableStateOfInputFields()})},toggleDisableStateOfInputFields:function(){1==this.checkboxActivateControlVocab.checkFlag?this.divCategoriesSection.removeClassName("search_center_disable"):this.divCategoriesSection.addClassName("search_center_disable")},renderCommunitySection:function(t){this.divCategoriesSection&&this.divCategoriesSection.remove(),t||(t=this._parentDiv),this.divCategoriesSection=e.create("div",{class:"control_vocab_category_section search_center_disable"}).inject(t),this.renderAddCategorySection(this.divCategoriesSection),this.renderMappings(this.divCategoriesSection)},_createAddCategoryRowSpan:function(t){var r=e.create("div",{class:t.class,id:t.id}).inject(t.parentDiv);return r.addClassName("control_vocab_add_category_row_span"),r},_createCommunityControl:function(r){var a=e.create("div",{class:r.class,id:r.id}).inject(r.divRow),i=new c;this.communityAutocomplete=new s({placeholder:h.get("6WTagsFilter.ControlledVocab.Community.title"),touchMode:!0,enableSearchFlag:!0,elementsTree:i,multiSearchMode:!1}).inject(a),this.communityAutocomplete.elements.container.setStyle("max-width","unset"),this.communityAutocomplete.addEventListener("change",this._onChangeCommunity.bind(this)),d._fetchSwymCommunities().then(function(e){t.is(e,"array")&&e.length?e.forEach((e,t)=>{if(e.hasOwnProperty("attributes")){let t,r;e.attributes.filter(function(e){if("internal"==e.format&&"resourceid"==e.name){let r=e.value.split(":");t=r[r.length-1]}"attribute"==e.format&&"ds6w:label"==e.name&&(r=e.value)}),i.addRoot(new l({label:r,value:t}))}}):console.log("The fed search failed")});var n=this;return this.selectedCommunity,this.communityAutocomplete.addEventListener("change",function(){n.enableAddCategoryButton()}),this.communityAutocomplete},_onChangeCommunity:function(e){if(this.communityAutocomplete.value){let e=this.communityAutocomplete.value,t=this.communityOntologyMapping.filter(function(t){return t.id==e});t&&t.length&&(this._updateCommunity=t[0].id,this.updateCategoryButton.elements.container.setStyle("display","inline-flex"),this.updateCategoryButton._disabledState=!1,this.updateCategoryButton.disabled=!1,this.addCategoryButton.elements.container.setStyle("display","none"))}else this.updateCategoryButton.elements.container.setStyle("display","none"),this.addCategoryButton.elements.container.setStyle("display","inline-flex")},_createOntologyControl:function(r){let a=this;var i=e.create("div",{class:r.class,id:r.id}).inject(r.divRow),n=new c;return this.ontologyAutocomplete=new s({placeholder:h.get("6WTagsFilter.ControlledVocab.Ontology.title"),touchMode:!0,enableSearchFlag:!0,elementsTree:n}).inject(i),this.ontologyAutocomplete.elements.container.setStyle("max-width","unset"),this.ontologiesObj={},d._fetchOntologies().then(function(e){t.is(e,"array")&&e.length?(e.forEach((e,t)=>{"ds6wclassifier:"!==e.shortURI&&e.hasOwnProperty("label")&&(a.ontologiesObj[e.shortURI]=e.label,n.addRoot(new l({label:e.label,value:e.shortURI})))}),a.getInputFromStore()):console.log("The failure is because:"+e)}),this.ontologyAutocomplete.addEventListener("change",function(){a.enableAddCategoryButton()}),this.ontologyAutocomplete},renderDisableFreeTagging:function(t){var r=e.create("div",{class:"search_center_general_display_flex search_center_margin",id:"disable-free-tagging"}).inject(t),a=e.create("div",{class:"search_center_div_uidisplay search_center_general_display_flex",id:"disable-free-tagging-toggle"}).inject(r);this.checkboxDisableFreeTagging=new i({type:"checkbox",label:h.get("6WTagsFilter.ControlledVocab.DisableFreeTagging.label"),className:"primary",touchMode:"true"}).inject(a);var n=e.create("span",{class:"fonticon fonticon-info search_center_margin_icon"}).inject(r);n.setStyle("color","#b4b6ba"),n.addEventListener("mouseover",this._manageMouseOver,!1),n.addEventListener("mouseout",this._manageMouseOut,!1),new o({target:n,trigger:"hover",animate:"true",position:"top",title:""})},enableAddCategoryButton:function(){this.communityAutoCompleteDiv.value&&this.ontologyAutoCompleteDiv.value&&this.ontologyAutoCompleteDiv.value.length?(this.addCategoryButton.disabled=!1,_.enableButtons()):this.addCategoryButton.disabled=!0},renderAddButtonCategoryRow:function(t){var r=e.create("div",{class:"search_center_div_uidisplay search_center_margin search_center_category_add_add",id:"add-btn-control_vocab"}).inject(t);this.addCategoryButton=new a({emphasize:"primary",touchMode:!0,disabled:!0,label:h.get("InstantSearch.Category.Action.AddNewCategory")}).inject(r),this.updateCategoryButton=new a({emphasize:"primary",touchMode:!0,disabled:!0,label:h.get("6WTagsFilter.ControlledVocab.UpdateButton.label")}).inject(r),this.updateCategoryButton.elements.container.setStyle("display","none"),this.addCategoryButton.getContent().addEventListener("buttonclick",this._onAddClick.bind(this)),this.updateCategoryButton.getContent().addEventListener("buttonclick",this._onAddClick.bind(this,!0))},_onAddClick:function(e){let t=this,r={type:"swym:Community"};if(this._updateCommunity){this.communityOntologyMapping.forEach(e=>{if(e.id==t._updateCommunity){if(t.ontologyAutoCompleteDiv.selectedItems.length){t.ontologyAutoCompleteDiv.value.forEach((r,a)=>{-1==e.ontologies.indexOf(r)&&e.ontologies.push(t.ontologyAutoCompleteDiv.value[a])})}e.freeInput=t.checkboxDisableFreeTagging.checkFlag}})}else r.id=t.communityAutoCompleteDiv.value,r.name=t.communityAutoCompleteDiv.selectedItems.getAttributeValue("label"),r.ontologies=t.ontologyAutoCompleteDiv.value,r.freeInput=t.checkboxDisableFreeTagging.checkFlag,t.communityOntologyMapping.push(r);console.log("The community mappings:"+JSON.stringify(t.communityOntologyMapping)),t.communityAutoCompleteDiv.value="",t.ontologyAutoCompleteDiv.value=[],t.checkboxDisableFreeTagging.checkFlag=!1,t.updateCategoryButton.elements.container.setStyle("display","none"),t.addCategoryButton.elements.container.setStyle("display","inline-flex"),this._updateCommunity=null,t.divCreatedCategoriesSection.empty(),t.communityOntologyMapping.forEach((e,r)=>{t.renderMappingsRow(t.divCreatedCategoriesSection,e)})},renderAddCategorySection:function(t){this.divAddCategoriesSection=e.create("div",{class:"search_center_add_category_section"}).inject(t);var r=this._createAddCategoryRowSpan({class:"control_vocab search_center_margin",id:"add-search-result-category-row1",parentDiv:this.divAddCategoriesSection}),a=this._createCommunityControl({class:"control_vocab_community_title",divRow:r}),i=this._createAddCategoryRowSpan({class:"control_vocab search_center_margin",id:"add-search-result-category-row2",parentDiv:this.divAddCategoriesSection}),n=this._createOntologyControl({class:"control_vocab_ontology_title",divRow:i}),s=this._createAddCategoryRowSpan({class:"control_vocab search_center_margin",id:"add-search-result-category-row2",parentDiv:this.divAddCategoriesSection});this.renderDisableFreeTagging(s);this.communityAutoCompleteDiv=a,this.ontologyAutoCompleteDiv=n,this.renderAddButtonCategoryRow(this.divAddCategoriesSection)},_createCategoryRowSpan:function(t){var r=e.create("div",{class:t.class}).inject(t.parentDiv);return r.addClassName("search_center_category_row_span"),r},_createCategoryRowHtmlDiv:function(t){var r=e.create("div",{class:t.class,html:this._getCategoryRowHtml(t)}).inject(t.parentDiv);return r.addClassName("search_center_category_row_html"),r},_getCategoryRowHtml:function(e){var t=this;let r=e.mappingInfo.ontologies.map(e=>t.ontologiesObj[e]);return e.mappingInfo.name+" - "+r},renderMappings:function(t){let r=this;this.divCreatedCategoriesSection=e.create("div",{class:"search_center_created_categories_section"}).inject(t),this.communityOntologyMapping&&this.communityOntologyMapping.length&&(this.divCreatedCategoriesSection.empty(),this.communityOntologyMapping.forEach((e,t)=>{r.renderMappingsRow(r.divCreatedCategoriesSection,e)}))},renderMappingsRow:function(e,t){var r=this._createCategoryRowSpan({class:"search_center_general_tab_div search_center_margin",parentDiv:e});this._createCategoryRowHtmlDiv({class:"search_center_general_tab_div search_center_margin",parentDiv:r,mappingInfo:t})}}}),define("DS/SearchControlCenter/scripts/Searchcontrol6WTagsFilter",["UWA/Element","UWA/Core","UWA/Promise","DS/Controls/Toggle","DS/Controls/ComboBox","DS/UIKIT/Popover","DS/UIKIT/Mask","DS/FedDictionaryAccess/FedDictionaryAccessAPI","css!DS/SearchControlCenter/SearchControlCenter","i18n!DS/SearchControlCenter/assets/nls/SearchControlCenter.json","text!DS/SearchControlCenter/assets/SearchControlCenter_AllowedApps.json","DS/SearchControlCenter/scripts/SearchControlCenterServices","DS/SearchControlCenter/scripts/SCCTagColorization","DS/SearchControlCenter/scripts/ControlledVocabulary/SCCControlledVocabulary","DS/SearchControlCenter/scripts/ControlledOntology/SCCControlledOntology","text!DS/SNInfraUX/assets/SearchcontrolCenter_TagRelationship.json","DS/SNInfraUX/SearchSettings","DS/SNInfraUX/SearchUtils"],function(e,t,r,a,i,n,s,o,c,l,d,_,h,u,p,g,f,m){"use strict";let C={preferredPredicatesComboBox:null,preferredWhatCards:null,preferredWhereCards:null,preferredWhoCards:null,preferredWhenCards:null,preferredHowCards:null,preferredWhyCards:null,excludedPredicatesComboBox:null,excludedWhatCards:null,excludedWhereCards:null,excludedWhoCards:null,excludedWhenCards:null,excludedHowCards:null,excludedWhyCards:null,checkboxAttributeDisplay:null,checkboxActivateTagRelationship:null,applicationCntxtComboBox:null,_attributesMap:{},_6WSubProperties:[],_6WPredicatesMap:[],_listOfDefaultAndTags:[],_listOfIrrelevantAndTags:[],_appsMap:{},_filter6WRootPredicatesPromise:r.deferred(),_rootWOfPredicatesPromise:r.deferred(),onRenderFacet:function(r){let o=e.create("div",{class:"search_center_main_div",id:"search-center-6WTags1"}).inject(r),c=e.create("div",{class:"search_center_general_tab_div search_center_margin",id:"search-type-display"}).inject(o),m=e.create("div",{class:"search_center_div_left search_center_general_display_flex",id:"search-type-display-text"}).inject(c),v=e.create("div",{class:"search_center_div_right search_center_general_display_flex",id:"search-predicates-display-combo"}).inject(c);C.checkboxAttributeDisplay=new a({type:"checkbox",label:l.get("searchAttributes.AttributeDisplay"),className:"primary",checkFlag:"true",touchMode:"true"}).inject(v),e.create("p",{class:"search_center_text",text:l.get("searchAttributes.CustomizedAttributes")}).inject(m);let y=e.create("div",{class:"search_center_general_tab_div search_center_margin",id:"search-type-display"}).inject(o),b=e.create("div",{class:"search_center_div_left search_center_6Wtags_align search_center_general_display_flex",id:"search-type-display-text"}).inject(y),S=e.create("div",{class:"search_center_div_right search_center_div_datasource search_center_only_grid search_center_top_margin",id:"context-Application-6WTags-combo"}).inject(y);C.applicationCntxtComboBox=new i({selectedIndex:0,touchMode:!0,mainElementVisibleFlag:!0}).inject(S),e.create("p",{class:"search_center_text",text:l.get("SearchCenter6WTagsFilter.Context")}).inject(b);let x=e.create("span",{class:"fonticon fonticon-info search_center_margin_CardSpan_icon"}).inject(y);new n({target:x,trigger:"hover",animate:"true",position:"top",body:l.get("SearchCenter6WTagsFilter.Context.Title.popover"),title:""});let D=e.create("div",{class:"search_center_general_tab_div search_center_margin "}).inject(o),A=e.create("div",{class:"search_center_div_left search_center_6Wtags_align search_center_margin search_center_general_display_flex",id:"search-type-display-text"}).inject(D);e.create("p",{class:"search_center_text",text:l.get("SearchCenter6WTagsFilter.Preferred.Title")}).inject(A);let T=e.create("div",{class:"search_center_div_right",id:"search-type-display-text"}).inject(D),w=e.create("div",{class:"search_center_div_datasource search_center_only_grid search_center_top_margin",id:"Preferred-6WTags-combo"}).inject(T);C.preferredPredicatesComboBox=new i({elementsList:[],placeholder:l.get("SearchCenter6WTagsFilter.AddPreferred_tags"),touchMode:!0,mainElementVisibleFlag:!0}).inject(w);let I=e.create("div",{class:"search_center_div_card search_center_top_margin",id:"search-type-display-text"}).inject(T);C.preferredWhatCards=e.create("div",{class:"card search_center_card_panel",id:"SCC6WTagsFilter_preferredWhatAttr"}).inject(I);let N=e.create("div",{class:"search_center_font_and_color search_center_general_display_flex",id:"SCC6WTagsFilter_preferredAttr"}).inject(C.preferredWhatCards);e.create("span",{class:"fonticon fonticon-3ds-what search_center_6Wtags_WSection search_center_font_and_color",text:" What"}).inject(N);this._buildNoSelectionMsgDiv(N),C.preferredWhereCards=e.create("div",{class:"card search_center_card_panel",id:"SCC6WTagsFilter_preferredWhereAttr"}).inject(I);let j=e.create("div",{class:"search_center_font_and_color search_center_general_display_flex",id:"SCC6WTagsFilter_preferredAttr"}).inject(C.preferredWhereCards);e.create("span",{class:"fonticon fonticon-3ds-where search_center_6Wtags_WSection",text:" Where"}).inject(j);this._buildNoSelectionMsgDiv(j),C.preferredWhoCards=e.create("div",{class:"card search_center_card_panel",id:"SCC6WTagsFilter_preferredWhoAttr"}).inject(I);let O=e.create("div",{class:"search_center_font_and_color search_center_general_display_flex",id:"SCC6WTagsFilter_preferredAttr"}).inject(C.preferredWhoCards);e.create("span",{class:"fonticon fonticon-3ds-who search_center_6Wtags_WSection",text:" Who"}).inject(O);this._buildNoSelectionMsgDiv(O),C.preferredWhenCards=e.create("div",{class:"card search_center_card_panel",id:"SCC6WTagsFilter_preferredWhenAttr"}).inject(I);let W=e.create("div",{class:"search_center_font_and_color search_center_general_display_flex",id:"SCC6WTagsFilter_preferredAttr"}).inject(C.preferredWhenCards);e.create("span",{class:"fonticon fonticon-3ds-when search_center_6Wtags_WSection",text:" When"}).inject(W);this._buildNoSelectionMsgDiv(W),C.preferredHowCards=e.create("div",{class:"card search_center_card_panel",id:"SCC6WTagsFilter_preferredHowAttr"}).inject(I);let B=e.create("div",{class:"search_center_font_and_color search_center_general_display_flex",id:"SCC6WTagsFilter_preferredAttr"}).inject(C.preferredHowCards);e.create("span",{class:"fonticon fonticon-3ds-how search_center_6Wtags_WSection",text:" How"}).inject(B);this._buildNoSelectionMsgDiv(B),C.preferredWhyCards=e.create("div",{class:"card search_center_card_panel",id:"SCC6WTagsFilter_preferredWhyAttr"}).inject(I);let P=e.create("div",{class:"search_center_font_and_color search_center_general_display_flex",id:"SCC6WTagsFilter_preferredAttr"}).inject(C.preferredWhyCards);e.create("span",{class:"fonticon fonticon-3ds-why search_center_6Wtags_WSection",text:" Why"}).inject(P);this._buildNoSelectionMsgDiv(P);let F=e.create("span",{class:"fonticon fonticon-info search_center_margin_CardSpan_icon"}).inject(D);new n({target:F,trigger:"hover",animate:"true",position:"top",body:l.get("SearchCenter6WTagsFilter.Preferred.Title.popover"),title:""});let k=this;C.preferredPredicatesComboBox.addEventListener("change",function(){let e=k._getCardsList("Excluded"),r=e.length,a=[];for(let t=0;t<r;t++)a.push(e[t].uri);let i=k._getCardsList("Preferred"),n=i.length,s=[];for(let e=0;e<n;e++)s.push(i[e].uri);let o=C.preferredPredicatesComboBox.currentValue;if(t.is(o,"string")){let e="AllDataSourcesandTypes",r=_.getAttributesInternalNameForAllDataSourcesAndTypes(e,o),i=!1,n=null;if(t.is(r)){let t;if(a.length>0&&(t=a.indexOf(r))>-1&&(n=l.get("6WTagsFilter.preferredAttrWarning"),i=!0),s.length>0&&!1===i&&(t=s.indexOf(r))>-1&&(n=l.get("searchAttributes.AttributeWarning"),i=!0),!1===i){let t=C._get6WDiv(r,"Preferred");A.className="search_center_set_left_div search_center_6Wtags_align search_center_margin search_center_general_display_flex";let a={cardDiv:t,datasource:e,type:"",textOnCard:o,uri:r,tabName:"SearchControl_6WTags",deleteOption:!0};_.buildCardBlockRow(a),_.enableButtons()}else{let e=_.createWdgAlert();e.inject(widget.body,"top"),e.add({className:"warning applyChangesAlert",message:n})}}C.preferredPredicatesComboBox.selectedIndex=-1}});let M=e.create("div",{class:"search_center_secondary_div",id:"search-center-6WTags2"}).inject(r);M.addClassName("search_center_secondary_div_topMargin");let R=e.create("div",{class:"search_center_general_tab_div search_center_margin"}).inject(M),E=e.create("div",{class:"search_center_div_left search_center_6Wtags_align search_center_margin search_center_general_display_flex",id:"search-type-display-text"}).inject(R);e.create("p",{class:"search_center_text",text:l.get("SearchCenter6WTagsFilter.Excluded.Title")}).inject(E);let L=e.create("div",{class:"search_center_div_right",id:"search-type-display-text"}).inject(R),U=e.create("div",{class:"search_center_div_datasource search_center_only_grid search_center_top_margin",id:"Excluded-6WTags-combo"}).inject(L);C.excludedPredicatesComboBox=new i({elementsList:[],placeholder:l.get("SearchCenter6WTagsFilter.AddExcluded_tags"),touchMode:!0,mainElementVisibleFlag:!0}).inject(U);let V=e.create("div",{class:"search_center_div_card search_center_top_margin",id:"search-type-display-text"}).inject(L);C.excludedWhatCards=e.create("div",{class:"card search_center_card_panel",id:"SCC6WTagsFilter_excludedWhatAttr"}).inject(V);let H=e.create("div",{class:"search_center_font_and_color search_center_general_display_flex",id:"SCC6WTagsFilter_preferredAttr"}).inject(C.excludedWhatCards);e.create("span",{class:"fonticon fonticon-3ds-what search_center_6Wtags_WSection search_center_font_and_color",text:" What"}).inject(H);this._buildNoSelectionMsgDiv(H),C.excludedWhereCards=e.create("div",{class:"card search_center_card_panel",id:"SCC6WTagsFilter_excludedWhereAttr"}).inject(V);let J=e.create("div",{class:"search_center_font_and_color search_center_general_display_flex",id:"SCC6WTagsFilter_preferredAttr"}).inject(C.excludedWhereCards);e.create("span",{class:"fonticon fonticon-3ds-where search_center_6Wtags_WSection search_center_font_and_color",text:" Where"}).inject(J);this._buildNoSelectionMsgDiv(J),C.excludedWhoCards=e.create("div",{class:"card search_center_card_panel",id:"SCC6WTagsFilter_excludedWhoAttr"}).inject(V);let z=e.create("div",{class:"search_center_font_and_color search_center_general_display_flex",id:"SCC6WTagsFilter_preferredAttr"}).inject(C.excludedWhoCards);e.create("span",{class:"fonticon fonticon-3ds-who search_center_6Wtags_WSection search_center_font_and_color",text:" Who"}).inject(z);this._buildNoSelectionMsgDiv(z),C.excludedWhenCards=e.create("div",{class:"card search_center_card_panel",id:"SCC6WTagsFilter_excludedWhenAttr"}).inject(V);let X=e.create("div",{class:"search_center_font_and_color search_center_general_display_flex",id:"SCC6WTagsFilter_preferredAttr"}).inject(C.excludedWhenCards);e.create("span",{class:"fonticon fonticon-3ds-when search_center_6Wtags_WSection search_center_font_and_color",text:" When"}).inject(X);this._buildNoSelectionMsgDiv(X),C.excludedHowCards=e.create("div",{class:"card search_center_card_panel",id:"SCC6WTagsFilter_excludedHowAttr"}).inject(V);let G=e.create("div",{class:"search_center_font_and_color search_center_general_display_flex",id:"SCC6WTagsFilter_preferredAttr"}).inject(C.excludedHowCards);e.create("span",{class:"fonticon fonticon-3ds-how search_center_6Wtags_WSection search_center_font_and_color",text:" How"}).inject(G);this._buildNoSelectionMsgDiv(G),C.excludedWhyCards=e.create("div",{class:"card search_center_card_panel",id:"SCC6WTagsFilter_excludedWhyAttr"}).inject(V);let K=e.create("div",{class:"search_center_font_and_color search_center_general_display_flex",id:"SCC6WTagsFilter_preferredAttr"}).inject(C.excludedWhyCards);e.create("span",{class:"fonticon fonticon-3ds-why search_center_6Wtags_WSection search_center_font_and_color",text:" Why"}).inject(K);this._buildNoSelectionMsgDiv(K);let q=e.create("span",{class:"fonticon fonticon-info search_center_margin_CardSpan_icon"}).inject(R);new n({target:q,trigger:"hover",animate:"true",position:"top",body:l.get("SearchCenter6WTagsFilter.Excluded.Title.popover"),title:""}),C.excludedPredicatesComboBox.addEventListener("change",function(){let e=k._getCardsList("Excluded"),r=e.length,a=[];for(let t=0;t<r;t++)a.push(e[t].uri);let i=k._getCardsList("Preferred"),n=i.length,s=[];for(let e=0;e<n;e++)s.push(i[e].uri);let o=C.excludedPredicatesComboBox.currentValue;if(t.is(o,"string")){let e="AllDataSourcesandTypes",r=_.getAttributesInternalNameForAllDataSourcesAndTypes(e,o),i=!1,n=null;if(t.is(r)){let t;if(a.length>0&&(t=a.indexOf(r))>-1&&(n=l.get("searchAttributes.AttributeWarning"),i=!0),s.length>0&&!1===i&&(t=s.indexOf(r))>-1&&(n=l.get("6WTagsFilter.excludeAttrWarning"),i=!0),!1===i){let t=C._get6WDiv(r,"Excluded");E.className="search_center_set_left_div search_center_6Wtags_align search_center_margin search_center_general_display_flex";let a={cardDiv:t,datasource:e,type:"",textOnCard:o,uri:r,tabName:"SearchControl_6WTags",deleteOption:!0};_.buildCardBlockRow(a),_.enableButtons()}else{let e=_.createWdgAlert();e.inject(widget.body,"top"),e.add({className:"warning applyChangesAlert",message:n})}}C.excludedPredicatesComboBox.selectedIndex=-1}});let Q=e.create("div",{class:"search_center_main_div",id:"search-center-TagReln"}).inject(r),Y=(e.create("div",{class:"search_center_main_div",id:"search-center-TagRelnEmpt"}).inject(r),e.create("div",{class:"search_center_general_tab_div search_center_margin",id:"search-center-TagReln-Span1"}).inject(Q)),Z=e.create("div",{class:"search_center_div_left search_center_general_display_flex",id:"search-center-TagReln-Span1-Text"}).inject(Y),$=e.create("div",{class:"search_center_div_right search_center_general_display_flex",id:"search-center-TagReln-Span1-chkbox"}).inject(Y);C.checkboxActivateTagRelationship=new a({type:"checkbox",label:l.get("SearchCenter6WTagsFilter.TagRelationship.specify.label"),className:"primary",checkFlag:!1,touchMode:"true"}).inject($),e.create("p",{class:"search_center_text",text:l.get("SearchCenter6WTagsFilter.TagRelationship.label")}).inject(Z);let ee=e.create("div",{class:"search_center_general_tab_div search_center_margin search_center_disable",id:"search-center-TagReln-Span2"}).inject(Q),te=e.create("div",{class:"search_center_div_left search_center_6Wtags_align search_center_margin search_center_general_display_flex",id:"search-center-TagReln-Span2-Text"}).inject(ee);e.create("p",{class:"search_center_text",text:l.get("SearchCenter6WTagsFilter.TagRelationship.Preferred.Title")}).inject(te);let re=e.create("div",{class:"search_center_div_right search_center_div_datasource search_center_only_grid search_center_top_margin",id:"Tag-Relationship-6WTags-combo"}).inject(ee);C.configTagRelationshipPredicatesComboBox=new i({elementsList:[],placeholder:l.get("SearchCenter6WTagsFilter.TagRelationship.AddPreferred_tags"),touchMode:!0,mainElementVisibleFlag:!0}).inject(re);let ae=e.create("span",{class:"fonticon fonticon-info search_center_margin_CardSpan_icon"}).inject(ee);new n({target:ae,trigger:"hover",animate:"true",position:"top",body:l.get("SearchCenter6WTagsFilter.TagRelationship.Preferred.Title.popover"),title:""});let ie=e.create("div",{class:"search_center_general_tab_div search_center_top_margin search_center_disable",id:"search-center-TagReln-Span3"}).inject(Q);C.tagRelationshipCards=e.create("div",{class:"search_center_created_categories_section_header scc-tag-relationship-row",id:"SCC6WTagsFilter_preferredHierarchicalWhatAttr"}).inject(ie);let ne=e.create("div",{class:"search_center_created_categories_section_header search_center_font_and_color search_center_general_display_flex",id:"SCC6WTagsFilter_preferredHierarchicalAttr"}).inject(C.tagRelationshipCards);e.create("span",{class:"search_center_font_and_color scc_6wtags_tag_relationship_orbtn",text:"OR"}).inject(ne),e.create("span",{class:"search_center_font_and_color scc_6wtags_tag_relationship_andbtn",text:"AND"}).inject(ne),e.create("span",{class:"search_center_font_and_color scc_6wtags_tag_relationship_xorbtn",text:"XOR"}).inject(ne);if(this._listOfDefaultAndTags.length<=0&&this._listOfIrrelevantAndTags.length<=0){let e=JSON.parse(g);if(t.is(e)&&e.hasOwnProperty("Predicates_Default_AND")&&t.is(e.Predicates_Default_AND,"array"))for(let t=0;t<e.Predicates_Default_AND.length;t++){let r=e.Predicates_Default_AND[t];this._listOfDefaultAndTags.push(r)}if(t.is(e)&&e.hasOwnProperty("Predicates_Irrelevant_AND")&&t.is(e.Predicates_Irrelevant_AND,"array"))for(let t=0;t<e.Predicates_Irrelevant_AND.length;t++){let r=e.Predicates_Irrelevant_AND[t];this._listOfIrrelevantAndTags.push(r)}}if(C.configTagRelationshipPredicatesComboBox.addEventListener("change",function(){let e=k._getTagRelationshipCards(),r=e.length,a=[];for(let t=0;t<r;t++)a.push(e[t].uri);let i=C.configTagRelationshipPredicatesComboBox.currentValue;if(t.is(i,"string")){let e="AllDataSourcesandTypes",r=_.getAttributesInternalNameForAllDataSourcesAndTypes(e,i),n=!1,s=null;if(t.is(r)){let e;if(a.length>0&&!1===n&&(e=a.indexOf(r))>-1&&(s=l.get("searchAttributes.AttributeWarning"),n=!0),!1===n){let e="OR";if(k._listOfDefaultAndTags.length>0){k._listOfDefaultAndTags.indexOf(r)>-1&&(e="AND")}te.className="search_center_set_left_div search_center_6Wtags_align search_center_margin search_center_general_display_flex";let t={cardDiv:C.tagRelationshipCards,textOnCard:i,uri:r,tabName:"SearchControl_6WTags",operator:e};k.renderTagRelationshipRow(t),C.tagRelationshipCards.childNodes[0].hidden=!1,_.enableButtons()}else{let e=_.createWdgAlert();e.inject(widget.body,"top"),e.add({className:"warning applyChangesAlert",message:s})}}C.configTagRelationshipPredicatesComboBox.selectedIndex=-1}}),C.checkboxActivateTagRelationship.addEventListener("change",function(){_.enableButtons(),!1===C.checkboxActivateTagRelationship.checkFlag?(ee.addClassName("search_center_disable"),ie.addClassName("search_center_disable")):(ee.removeClassName("search_center_disable"),ie.removeClassName("search_center_disable"))}.bind(this)),!0===f.getOption("activate_hierarchical_tag_depth")){let s=e.create("div",{class:"search_center_main_div",id:"search-center-6WTags3"}).inject(r),o=e.create("div",{class:"search_center_general_tab_div search_center_margin",id:"search-type-display-hiearchical-predicates"}).inject(s),c=e.create("div",{class:"search_center_div_left search_center_general_display_flex",id:"search-type-display-text-hiearchical-predicates"}).inject(o),d=e.create("div",{class:"search_center_div_right search_center_general_display_flex",id:"search-predicates-display-combo-hiearchical-predicates"}).inject(o);C.checkboxHierarchicalTagsDisplay=new a({type:"checkbox",label:l.get("SearchCenter6WTagsFilter.hierarchicalPredicates.specify.label"),className:"primary",checkFlag:!1,touchMode:"true"}).inject(d),e.create("p",{class:"search_center_text",text:l.get("SearchCenter6WTagsFilter.hierarchicalPredicates.label")}).inject(c);let h=e.create("div",{class:"search_center_general_tab_div search_center_margin search_center_disable"}).inject(s),u=e.create("div",{class:"search_center_div_left search_center_6Wtags_align search_center_margin search_center_general_display_flex",id:"search-type-display-text-hiearchical-predicates"}).inject(h);e.create("p",{class:"search_center_text",text:l.get("SearchCenter6WTagsFilter.hierarchicalPredicates.Preferred.Title")}).inject(u);let p=e.create("div",{class:"search_center_div_right",id:"search-type-display-text-hiearchical-predicates"}).inject(h),g=e.create("div",{class:"search_center_div_datasource search_center_only_grid search_center_top_margin",id:"Preferred-Hierarchical-6WTags-combo"}).inject(p),m=[];C.preferredHierarchicalPredicatesComboBox=new i({elementsList:m,placeholder:l.get("SearchCenter6WTagsFilter.hierarchicalPredicates.AddPreferred_tags"),touchMode:!0,mainElementVisibleFlag:!0}).inject(g);let v=e.create("div",{class:"search_center_div_card search_center_top_margin",id:"search-type-display-text-hiearchical-predicates"}).inject(p);C.preferredHierarchicalWhatCards=e.create("div",{class:"card search_center_card_panel",id:"SCC6WTagsFilter_preferredHierarchicalWhatAttr"}).inject(v);let y=e.create("div",{class:"search_center_font_and_color search_center_general_display_flex",id:"SCC6WTagsFilter_preferredHierarchicalAttr"}).inject(C.preferredHierarchicalWhatCards);e.create("span",{class:"fonticon fonticon-3ds-what search_center_6Wtags_WSection search_center_font_and_color",text:" What"}).inject(y);this._buildNoSelectionMsgDiv(y),C.preferredHierarchicalWhereCards=e.create("div",{class:"card search_center_card_panel",id:"SCC6WTagsFilter_preferredHierarchicalWhereAttr"}).inject(v);let b=e.create("div",{class:"search_center_font_and_color search_center_general_display_flex",id:"SCC6WTagsFilter_preferredHierarchicalAttr"}).inject(C.preferredHierarchicalWhereCards);e.create("span",{class:"fonticon fonticon-3ds-where search_center_6Wtags_WSection",text:" Where"}).inject(b);this._buildNoSelectionMsgDiv(b),C.preferredHierarchicalWhoCards=e.create("div",{class:"card search_center_card_panel",id:"SCC6WTagsFilter_preferredHierarchicalWhoAttr"}).inject(v);let S=e.create("div",{class:"search_center_font_and_color search_center_general_display_flex",id:"SCC6WTagsFilter_preferredHierarchicalAttr"}).inject(C.preferredHierarchicalWhoCards);e.create("span",{class:"fonticon fonticon-3ds-who search_center_6Wtags_WSection",text:" Who"}).inject(S);this._buildNoSelectionMsgDiv(S),C.preferredHierarchicalWhenCards=e.create("div",{class:"card search_center_card_panel",id:"SCC6WTagsFilter_preferredHierarchicalWhenAttr"}).inject(v);let x=e.create("div",{class:"search_center_font_and_color search_center_general_display_flex",id:"SCC6WTagsFilter_preferredHierarchicalAttr"}).inject(C.preferredHierarchicalWhenCards);e.create("span",{class:"fonticon fonticon-3ds-when search_center_6Wtags_WSection",text:" When"}).inject(x);this._buildNoSelectionMsgDiv(x),C.preferredHierarchicalHowCards=e.create("div",{class:"card search_center_card_panel",id:"SCC6WTagsFilter_preferredHierarchicalHowAttr"}).inject(v);let D=e.create("div",{class:"search_center_font_and_color search_center_general_display_flex",id:"SCC6WTagsFilter_preferredHierarchicalAttr"}).inject(C.preferredHierarchicalHowCards);e.create("span",{class:"fonticon fonticon-3ds-how search_center_6Wtags_WSection",text:" How"}).inject(D);this._buildNoSelectionMsgDiv(D),C.preferredHierarchicalWhyCards=e.create("div",{class:"card search_center_card_panel",id:"SCC6WTagsFilter_preferredHierarchicalWhyAttr"}).inject(v);let A=e.create("div",{class:"search_center_font_and_color search_center_general_display_flex",id:"SCC6WTagsFilter_preferredHierarchicalAttr"}).inject(C.preferredHierarchicalWhyCards);e.create("span",{class:"fonticon fonticon-3ds-why search_center_6Wtags_WSection",text:" Why"}).inject(A);this._buildNoSelectionMsgDiv(A);let T=e.create("span",{class:"fonticon fonticon-info search_center_margin_CardSpan_icon"}).inject(h);new n({target:T,trigger:"hover",animate:"true",position:"top",body:l.get("SearchCenter6WTagsFilter.hierarchicalPredicates.Preferred.Title.popover"),title:""});let w=this;C.preferredHierarchicalPredicatesComboBox.addEventListener("change",function(){let e=w._getCardsList("PreferredHierarchical"),r=e.length,a=[];for(let t=0;t<r;t++)a.push(e[t].uri);let i=C.preferredHierarchicalPredicatesComboBox.currentValue;if(t.is(i,"string")){let e="AllDataSourcesandTypes",n=_.getAttributesInternalNameForAllDataSourcesAndTypes(e,i),s=!1,o=null,c=f.getOption("max_deep_hierarchy_tags");if(r>=c){o=l.get("SearchCenter6WTagsFilter.hierarchicalPredicates.Message.MaxReached"),o=l.replace(o,{max:c});let e=_.createWdgAlert();return e.inject(widget.body,"top"),e.add({className:"error applyChangesAlert",message:o}),void(C.preferredHierarchicalPredicatesComboBox.selectedIndex=-1)}if(t.is(n)){let t;if(a.length>0&&!1===s&&(t=a.indexOf(n))>-1&&(o=l.get("searchAttributes.AttributeWarning"),s=!0),!1===s){let t=C._get6WDiv(n,"PreferredHierarchical");u.className="search_center_set_left_div search_center_6Wtags_align search_center_margin search_center_general_display_flex";let r={cardDiv:t,datasource:e,type:"",textOnCard:i,uri:n,tabName:"SearchControl_6WTags",deleteOption:!0};_.buildCardBlockRow(r),_.enableButtons()}else{let e=_.createWdgAlert();e.inject(widget.body,"top"),e.add({className:"warning applyChangesAlert",message:o})}}C.preferredHierarchicalPredicatesComboBox.selectedIndex=-1}}),C.checkboxHierarchicalTagsDisplay.addEventListener("change",function(){_.enableButtons(),!1===C.checkboxHierarchicalTagsDisplay.checkFlag?h.addClassName("search_center_disable"):h.removeClassName("search_center_disable")}.bind(this))}let se=e.create("div",{class:"search_center_third_div",id:"search-center-6WTags3"}).inject(r),oe=e.create("div",{class:"search_center_fourth_div",id:"search-center-6WTags4"}).inject(r);f.getOption("tagsColorCustomize")&&h.render(se),f.getOption("controlledVocabulary")&&(f.getOption("tagsColorCustomize")?u.render(oe):u.render(se)),!0===this._isOntologyActivated()&&p.render(se),s.mask(U),s.mask(w),k.getPredicatesObject().then(function(e){let r=k.filter6WRootPredicates(e);k.getRootWOfPredicates().then(function(a){k.cleanUpAttributeCards(),C.preferredPredicatesComboBox.elementsList=r.predicates,t.is(C.preferredHierarchicalPredicatesComboBox)&&(C.preferredHierarchicalPredicatesComboBox.elementsList=r.predicates),t.is(C.configTagRelationshipPredicatesComboBox)&&(C.configTagRelationshipPredicatesComboBox.elementsList=r.predicates),C.excludedPredicatesComboBox.elementsList=r.predicates,_.updateAttributesMappingForAllDataSourcesAndTypes("AllDataSourcesandTypes",r.typeMap);let i=_.getLocalCacheFor6WTags();if(t.is(i)&&i.length>0)for(let e=0;e<i.length;e++){let r=i[e];if("AllDataSourcesandTypes"===r.source){let e=r.predicates;if(t.is(e)&&e.length>0){A.className="search_center_set_left_div search_center_6Wtags_align search_center_margin search_center_general_display_flex";for(let t=0;t<e.length;t++){let e=r.predicates[t].uri,a={cardDiv:C._get6WDiv(e,"Preferred"),datasource:"AllDataSourcesandTypes",textOnCard:C._attributesMap[e],uri:e,tabName:"SearchControl_6WTags",deleteOption:!0};_.buildCardBlockRow(a)}}let a=r.excluded_predicates;if(t.is(a)&&a.length>0){E.className="search_center_set_left_div search_center_6Wtags_align search_center_margin search_center_general_display_flex";for(let e=0;e<a.length;e++){let t=r.excluded_predicates[e].uri,a={cardDiv:C._get6WDiv(t,"Excluded"),datasource:"AllDataSourcesandTypes",textOnCard:C._attributesMap[t],uri:t,tabName:"SearchControl_6WTags",deleteOption:!0};_.buildCardBlockRow(a)}}}}let n=[],s=JSON.parse(d);if(t.is(s)&&s.hasOwnProperty("applications")&&t.is(s.applications,"array"))for(let e=0;e<s.applications.length;e++){let t=s.applications[e];C._appsMap[t.nlsName]=t.appID,n.push(t.nlsName)}C.applicationCntxtComboBox.elementsList=n,C.applicationCntxtComboBox.addEventListener("change",function(){_.enableButtons(),k.cleanUpAttributeCards(),_.clearLocalCacheFor6WTags();let r=k.filter6WRootPredicates(e);k.cleanUpAttributeCards(),C.preferredPredicatesComboBox.elementsList=r.predicates,t.is(C.preferredHierarchicalPredicatesComboBox)&&(C.preferredHierarchicalPredicatesComboBox.elementsList=r.predicates),t.is(C.configTagRelationshipPredicatesComboBox)&&(C.configTagRelationshipPredicatesComboBox.elementsList=r.predicates),C.excludedPredicatesComboBox.elementsList=r.predicates,_.updateAttributesMappingForAllDataSourcesAndTypes("AllDataSourcesandTypes",r.typeMap);let a=_.getAppPredicates(C._appsMap[C.applicationCntxtComboBox.currentValue]),i=null,n=null;if(a.hasOwnProperty("preferred_predicates")&&(i=a.preferred_predicates),a.hasOwnProperty("excluded_predicates")&&(n=a.excluded_predicates),t.is(i)&&i.length>0){C.preferredWhatCards.parentElement.parentElement.parentElement.children[0].className="search_center_set_left_div search_center_6Wtags_align search_center_top_margin search_center_general_display_flex";for(let e=0;e<i.length;e++){let r=i[e].uri,a=C._get6WDiv(r,"Preferred"),n=C._attributesMap[r];if(t.is(a)&&t.is(n)){let e={cardDiv:a,datasource:"AllDataSourcesandTypes",type:"",textOnCard:n,uri:r,tabName:"SearchControl_6WTags",deleteOption:!0};_.buildCardBlockRow(e)}}}if(t.is(n)&&n.length>0){C.excludedWhatCards.parentElement.parentElement.parentElement.children[0].className="search_center_set_left_div search_center_6Wtags_align search_center_top_margin search_center_general_display_flex";for(let e=0;e<n.length;e++){let r=n[e].uri,a=C._get6WDiv(r,"Excluded"),i=C._attributesMap[r];if(t.is(a)&&t.is(i)){let e={cardDiv:a,datasource:"AllDataSourcesandTypes",type:"",textOnCard:i,uri:r,tabName:"SearchControl_6WTags",deleteOption:!0};_.buildCardBlockRow(e)}}}}.bind(k)),C.applicationCntxtComboBox.currentValue=n[0],_.disableButtons()}),s.unmask(widget.body),s.unmask(w),s.unmask(U)},function(){s.unmask(widget.body)}),C.checkboxAttributeDisplay.addEventListener("change",function(){_.enableButtons(),!1===C.checkboxAttributeDisplay.checkFlag?(D.addClassName("search_center_disable"),M.addClassName("search_center_disable"),y.addClassName("search_center_disable")):(D.removeClassName("search_center_disable"),M.removeClassName("search_center_disable"),y.removeClassName("search_center_disable"))}.bind(this))},isThisNotARootPredicates:function(e){return""!==e.subPropertyOf},renderTagRelationshipRow:function(r){let i=e.create("div",{class:"search_center_general_tab_div search_center_margin",id:r.textOnCard}).inject(r.cardDiv);i.addClassName("search_center_category_row_span");let n=e.create("div",{class:"search_center_general_tab_div search_center_margin",id:r.textOnCard+"Text_part",html:r.textOnCard}).inject(i);n.addClassName("search_center_category_row_html"),t.is(r.uri)&&n.setAttribute("sccuri",r.uri);let s=new a({type:"radio",value:1}).inject(i);s.elements.container.addClassName("scc_6wtags_tag_relationship_orbtn_toggle");let o=new a({type:"radio",value:0}).inject(i);if(o.elements.container.addClassName("scc_6wtags_tag_relationship_andbtn_toggle"),this._listOfIrrelevantAndTags.length>0&&t.is(r.uri)){this._listOfIrrelevantAndTags.indexOf(r.uri)>-1&&o.elements.container.addClassName("search_center_disable")}let c=new a({type:"radio",value:0}).inject(i);c.elements.container.addClassName("scc_6wtags_tag_relationship_xorbtn_toggle"),s.addEventListener("change",function(){_.enableButtons()}.bind(this)),o.addEventListener("change",function(){_.enableButtons()}.bind(this)),c.addEventListener("change",function(){_.enableButtons()}.bind(this)),t.is(r.operator)&&"AND"===r.operator?o.checkFlag=!0:t.is(r.operator)&&"OR"===r.operator?s.checkFlag=!0:c.checkFlag=!0;let l=e.create("div",{class:"fonticon fonticon-clear fonticon-x scc_6wtags_tag_relationship_delete"}).inject(i);l.setStyle("color","#b4b6ba"),l.addEventListener("click",function(e){if(t.is(e.currentTarget.parentElement)){let t=e.currentTarget.parentElement.parentElement;e.currentTarget.parentElement.destroy(),1===t.childNodes.length&&(t.childNodes[0].hidden=!0),_.enableButtons()}},!1),l.addEventListener("mouseover",function(e){e.currentTarget.setStyle("color","#3d3d3d")},!1),l.addEventListener("mouseout",function(e){e.currentTarget.setStyle("color","#b4b6ba")},!1)},_getKeyByValue:function(e,t){return Object.keys(e).find(r=>e[r]===t)},_buildNoSelectionMsgDiv:function(r){if(t.is(r)){let t=e.create("div",{class:"search_center_general_display_flex search_center_6Wtags_NoPredicateSection",id:"search-type-display-text"}).inject(r);e.create("p",{class:"search_center_text search_center_6Wtags",text:l.get("SearchCenter6WTagsFilter.No_Predicate")}).inject(t)}},_get6WDiv:function(e,r){let a=null,i=C._6WPredicatesMap.find(function(t){return t.curi===e});return t.is(i)?("ds6w:what"===i.lineage&&(a="Preferred"===r?C.preferredWhatCards:"PreferredHierarchical"===r?C.preferredHierarchicalWhatCards:C.excludedWhatCards),"ds6w:where"===i.lineage&&(a="Preferred"===r?C.preferredWhereCards:"PreferredHierarchical"===r?C.preferredHierarchicalWhereCards:C.excludedWhereCards),"ds6w:who"===i.lineage&&(a="Preferred"===r?C.preferredWhoCards:"PreferredHierarchical"===r?C.preferredHierarchicalWhoCards:C.excludedWhoCards),"ds6w:when"===i.lineage&&(a="Preferred"===r?C.preferredWhenCards:"PreferredHierarchical"===r?C.preferredHierarchicalWhenCards:C.excludedWhenCards),"ds6w:how"===i.lineage&&(a="Preferred"===r?C.preferredHowCards:"PreferredHierarchical"===r?C.preferredHierarchicalHowCards:C.excludedHowCards),"ds6w:why"===i.lineage&&(a="Preferred"===r?C.preferredWhyCards:"PreferredHierarchical"===r?C.preferredHierarchicalWhyCards:C.excludedWhyCards)):"computedCountryInfo"===e&&(a="Preferred"===r?C.preferredWhereCards:"PreferredHierarchical"===r?C.preferredHierarchicalWhereCards:C.excludedWhereCards),t.is(a)&&t.is(a.childNodes[0].childNodes[1])&&(a.childNodes[0].childNodes[1].hidden=!0),a},filter6WRootPredicates:function(e){let r,a,i={},n={},s=[],o=C.applicationCntxtComboBox.currentValue,c=C._appsMap[o];for(a in e)if(e[a].properties.length>0){let i=(r=e[a].properties).length;if(void 0!==r&&i>0){e[a].properties=r.filter(this.isThisNotARootPredicates),r.sort(function(e,t){let r=e.label;r=r.toUpperCase();let a=t.label;return r<(a=a.toUpperCase())?-1:r>a?1:0});for(let o=0;o<i;o++){if("X3DSEAR_AP"===c&&("ds6w:project"===r[o].curi||"ds6w:community"===r[o].curi||"ds6w:what"===r[o].curi||"ds6w:where"===r[o].curi||"ds6w:who"===r[o].curi||"ds6w:when"===r[o].curi||"ds6w:how"===r[o].curi||"ds6w:why"===r[o].curi))continue;let i=r[o].label;t.is(i)&&""!==i&&("ds6w"!==a&&(i=i+" ("+e[a].label+")"),s.push(i),n[r[o].curi]=i,C._attributesMap[r[o].curi]=i,C._6WSubProperties.push(r[o].curi))}}}let d=localStorage.getItem("TagNavigator-simplifiedTagger");if(t.is(d)&&"true"===d){let e=l.get("SearchCenter6WTagsFilter.Predicates.OwnerCountry"),t="computedCountryInfo";s.push(e),n[t]=e,C._attributesMap[t]=e}return i.predicates=s,i.typeMap=n,this._filter6WRootPredicatesPromise.resolve(),i},getPredicatesObject:function(){return new r(function(e,t){let r={onComplete:function(t){UWA.log("Got a predicates result!"+t),e(t)},onFailure:function(e){UWA.log("predicates service request Fail!"+e),t(e)},tenantId:_.platformID,lang:widget.lang,apiVersion:"R2021x"};o.getFedProperties(r)})},getRootWOfPredicates:function(){let e=this;if(C._6WSubProperties.length>0){let r=null;C._6WSubProperties.forEach(e=>{r=t.is(r)?r+","+e:e});let a={onComplete:function(r){UWA.log("Got a Root W of predicates result!"+r),t.is(r,"array")&&(C._6WPredicatesMap=r),e._rootWOfPredicatesPromise.resolve(r)},onFailure:function(t){UWA.log("getPropertiesRoots service request Fail!"+t),e._rootWOfPredicatesPromise.reject(t)},tenantId:_.platformID,lang:widget.lang};o.getPropertiesRoots(r,a)}return this._rootWOfPredicatesPromise.promise},cleanUpTagRelationCards:function(){for(let e=C.tagRelationshipCards.childElementCount-1;e>0;e--){let r=C.tagRelationshipCards.childNodes[e];t.is(r)&&r.destroy()}C.tagRelationshipCards.childNodes[0].hidden=!0},cleanUpAttributeCards:function(){let e=C.preferredWhatCards.parentElement.childElementCount;for(let r=0;r<e;r++){let e=C.preferredWhatCards.parentElement.childNodes[r];if(t.is(e)){for(let t=e.childElementCount-1;t>0;t--)e.childNodes[t].destroy();t.is(e.childNodes[0].childNodes[1])&&(e.childNodes[0].childNodes[1].hidden=!1)}}e=C.excludedWhatCards.parentElement.childElementCount;for(let r=0;r<e;r++){let e=C.excludedWhatCards.parentElement.childNodes[r];if(t.is(e)){for(let t=e.childElementCount-1;t>0;t--)e.childNodes[t].destroy();t.is(e.childNodes[0].childNodes[1])&&(e.childNodes[0].childNodes[1].hidden=!1)}}},_getCardsList:function(e){let r=[],a=null;if(t.is(e,"string")){"Preferred"===e?a=C.preferredWhatCards:"PreferredHierarchical"===e?a=C.preferredHierarchicalWhatCards:"Excluded"===e&&(a=C.excludedWhatCards);let i=a.parentElement.childElementCount;for(let e=0;e<i;e++){let i=a.parentElement.childNodes[e];if(t.is(i)){let e=i.childElementCount;for(let a=1;a<e;a++){let e={};e.uri=i.childNodes[a].getAttribute("sccURI"),t.is(e.uri)&&r.push(e)}}}}return r},_getTagRelationshipCards:function(){let e=[],r=C.tagRelationshipCards,a=r.childElementCount;for(let i=1;i<a;i++){let a=r.childNodes[i];if(t.is(a)){a.childElementCount;if(a.childElementCount>3){let r={};r.uri=a.childNodes[0].getAttribute("sccURI"),!0===a.childNodes[1].dsModel.checkFlag?r.operator="OR":!0===a.childNodes[2].dsModel.checkFlag?r.operator="AND":r.operator="XOR",t.is(r.uri)&&e.push(r)}}}return e},_getTagIrrelevantOperator:function(){let e={};return e.irrelevantANDPredicates=this._listOfIrrelevantAndTags,e},getTabInputsToStore:function(){let e={attributes_display:C.checkboxAttributeDisplay.checkFlag},r=[],a={},i=[];if(t.is(i,"array")&&1===i.length)t.is(i[0].source)&&(a.source=i[0].source),t.is(i[0].predicates)&&(a.predicates=i[0].predicates),t.is(i[0].excluded_predicates)&&(a.excluded_predicates=i[0].excluded_predicates),r.push(a);else{a.source="AllDataSourcesandTypes";let e=C._getCardsList("Preferred");a.predicates=e;let t=C._getCardsList("Excluded");a.excluded_predicates=t,r.push(a)}let n=[],s={},o={},c=C.applicationCntxtComboBox.currentValue,l=C._appsMap[c];return t.is(a.predicates)&&(o.preferred_predicates=a.predicates),t.is(a.excluded_predicates)&&(o.excluded_predicates=a.excluded_predicates),s[l]=o,n.push(s),e.context_apps_predicates=n,"X3DSEAR_AP"===l&&(e["ds6w:type"]=r),f.getOption("tagsColorCustomize")&&(e.tagColorization=h.getInputsToStore()),f.getOption("controlledVocabulary")&&(e.controlledVocabulary=u.getTabInputsToStore()),!0===this._isOntologyActivated()&&(e.enterprise_ontology=p.getTabInputsToStore()),!0===f.getOption("activate_hierarchical_tag_depth")&&(e.hierarchical_predicates={specify_hierarchical_predicates:C.checkboxHierarchicalTagsDisplay.checkFlag,hierarchical_predicates:C._getCardsList("PreferredHierarchical")},this._checkHierarchicalTagUpdate(e.hierarchical_predicates),this._prev_hierarchical_predicates=e.hierarchical_predicates),e.tagRelationships={activate_tag_relationship:C.checkboxActivateTagRelationship.checkFlag,tagRelationship_predicates:C._getTagRelationshipCards(),tagRelationship_IrrelevantOpert:C._getTagIrrelevantOperator()},e},_checkHierarchicalTagUpdate:function(e){let r=!1;if(t.is(this._prev_hierarchical_predicates))if(this._prev_hierarchical_predicates.specify_hierarchical_predicates!==e.specify_hierarchical_predicates)r=!0;else if(this._prev_hierarchical_predicates.hierarchical_predicates.length!==e.hierarchical_predicates.length)r=!0;else{let t=[];this._prev_hierarchical_predicates.hierarchical_predicates.forEach(e=>{t.push(e.uri)});for(let a=0;a<e.hierarchical_predicates.length;a++)if(t.indexOf(e.hierarchical_predicates[a].uri)<0){r=!0;break}}else r=!0;e.version=r?""+ +new Date:this._prev_hierarchical_predicates.version},onResetTab:function(e){let r;r=t.is(e,"string")?JSON.parse(e):e,_.clearLocalCacheFor6WTags();let a=this;if(a.cleanUpAttributeCards(),t.is(r)){if(r.hasOwnProperty("attributes_display")){let e=r.attributes_display;t.is(e)&&(C.checkboxAttributeDisplay.checkFlag=e)}let i="X3DSEAR_AP",n=this._getKeyByValue(C._appsMap,i);t.is(n)&&(C.applicationCntxtComboBox.currentValue=n),this.cleanUpAttributeCards();let s=null,o=null,c="AllDataSourcesandTypes";if(r.hasOwnProperty("context_apps_predicates")){let e=r.context_apps_predicates;if(t.is(e)){this.cleanUpAttributeCards();let e=_.getAppPredicates(i);e.hasOwnProperty("preferred_predicates")&&(s=e.preferred_predicates),e.hasOwnProperty("excluded_predicates")&&(o=e.excluded_predicates)}}else s=r.predicates,o=r.excluded_predicates;if(t.is(s)&&s.length>0)for(let e=0;e<s.length;e++){let t=s[e].uri,r={cardDiv:C._get6WDiv(t,"Preferred"),datasource:c,type:"",textOnCard:C._attributesMap[t],uri:t,tabName:"SearchControl_6WTags",deleteOption:!0};_.buildCardBlockRow(r)}if(t.is(o)&&o.length>0)for(let e=0;e<o.length;e++){let t=o[e].uri,r={cardDiv:C._get6WDiv(t,"Excluded"),datasource:c,type:"",textOnCard:C._attributesMap[t],uri:t,tabName:"SearchControl_6WTags",deleteOption:!0};_.buildCardBlockRow(r)}if(r.hasOwnProperty("tagRelationships")){let e=r.tagRelationships;t.is(e)&&(t.is(C.tagRelationshipCards)&&this.cleanUpTagRelationCards(),C.checkboxActivateTagRelationship.checkFlag=e.activate_tag_relationship,t.is(e.tagRelationship_predicates)&&e.tagRelationship_predicates.length>0&&a.getPredicatesObject().then(function(t){a.getRootWOfPredicates().then(function(t){for(let t=0;t<e.tagRelationship_predicates.length;t++){let r=e.tagRelationship_predicates[t].uri,i=C._attributesMap[r],n={cardDiv:C.tagRelationshipCards,textOnCard:i,uri:r,tabName:"SearchControl_6WTags",operator:e.tagRelationship_predicates[t].operator};a.renderTagRelationshipRow(n)}C.tagRelationshipCards.childNodes[0].hidden=!1,_.disableButtons()})}))}else t.is(C.checkboxActivateTagRelationship)&&(C.checkboxActivateTagRelationship.checkFlag=!1),t.is(C.tagRelationshipCards)&&(this.cleanUpTagRelationCards(),a.getPredicatesObject().then(function(e){a.getRootWOfPredicates().then(function(e){if(t.is(a._listOfDefaultAndTags)&&a._listOfDefaultAndTags.length>0){for(let e=0;e<a._listOfDefaultAndTags.length;e++){let t=a._listOfDefaultAndTags[e],r=C._attributesMap[t],i={cardDiv:C.tagRelationshipCards,textOnCard:r,uri:t,tabName:"SearchControl_6WTags",operator:"AND"};a.renderTagRelationshipRow(i)}C.tagRelationshipCards.childNodes[0].hidden=!1,_.disableButtons()}if(t.is(a._listOfIrrelevantAndTags)&&a._listOfIrrelevantAndTags.length>0){for(let e=0;e<a._listOfIrrelevantAndTags.length;e++){let t=a._listOfIrrelevantAndTags[e],r=C._attributesMap[t],i={cardDiv:C.tagRelationshipCards,textOnCard:r,uri:t,tabName:"SearchControl_6WTags",operator:"OR"};a.renderTagRelationshipRow(i)}C.tagRelationshipCards.childNodes[0].hidden=!1,_.disableButtons()}})}));if(!0===f.getOption("activate_hierarchical_tag_depth")){let e=r.hierarchical_predicates;t.is(e)?(C.checkboxHierarchicalTagsDisplay.checkFlag=e.specify_hierarchical_predicates,a._prev_hierarchical_predicates=e):t.is(C.checkboxHierarchicalTagsDisplay)&&(C.checkboxHierarchicalTagsDisplay.checkFlag=!1),a._cleanupHiearchicalPredicatesCardBlock(),a._buildHiearchicalPredicatesCardBlock(r,c)}f.getOption("tagsColorCustomize")&&h.onRender(e.tagColorization),f.getOption("controlledVocabulary")&&u.getInputFromStore(e.controlledVocabulary),!0===this._isOntologyActivated()&&p.getInputFromStore(e.enterprise_ontology)}},_buildTagRelationshipCards:function(e){if(t.is(e)&&e.length>0){for(let t=0;t<e.length;t++){let r=e[t].uri,a=C._attributesMap[r],i={cardDiv:C.tagRelationshipCards,textOnCard:a,uri:r,tabName:"SearchControl_6WTags",operator:e[t].operator};this.renderTagRelationshipRow(i)}C.tagRelationshipCards.childNodes[0].hidden=!1}},_buildHiearchicalPredicatesCardBlock:function(e,a){r.all([this._rootWOfPredicatesPromise.promise,this._filter6WRootPredicatesPromise.promise]).then(function(){let r=e.hierarchical_predicates;if(t.is(r)){let e=r.hierarchical_predicates;if(t.is(e)&&e.length>0)for(let t=0;t<e.length;t++){let r=e[t].uri,i=C._get6WDiv(r,"PreferredHierarchical"),n=C._attributesMap[r],s={cardDiv:i,datasource:a,type:"",textOnCard:n,uri:r,tabName:"SearchControl_6WTags",deleteOption:!0};_.buildCardBlockRow(s)}}})},_cleanupHiearchicalPredicatesCardBlock:function(){let e=C.preferredHierarchicalWhatCards.parentElement.childElementCount;for(let r=0;r<e;r++){let e=C.preferredHierarchicalWhatCards.parentElement.childNodes[r];if(t.is(e)){for(let t=e.childElementCount-1;t>0;t--)e.childNodes[t].destroy();t.is(e.childNodes[0].childNodes[1])&&(e.childNodes[0].childNodes[1].hidden=!1)}}},_isOntologyActivated:()=>!0===m.isInternalProduction()||!0===f.getOption("allowEnterpriseDictionaryModification"),onUpdateUI:function(e){!0===this._isOntologyActivated()&&p.onUpdateUI()}};return C});