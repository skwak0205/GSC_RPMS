define("DS/VCXWeb3DMaster/VCXModifiableOccurrenceComposer",["DS/CoreEvents/Events","DS/VCXWebExperienceBase/VCXModifiableOccurrenceExt","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebModifiables/VCXModelChangeListener","DS/VCXWebVisibility/VCXIVisibility","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueLink","DS/VCXWebProperties/VCXPropertyValueFloat","DS/VCXWebProperties/VCXPropertyInfoEnum","DS/VCXWebProperties/VCXPropertyValueEnum","DS/VCXWebProperties/VCXPropertyValueBoolean","DS/VCXWebProperties/VCXPropertyValueColor","DS/VCXWebKernelTools/VCXEnums","DS/VCXWebComponents/VCXWebComponentOccurrence","DS/Visualization/ThreeJS_DS","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables","i18n!DS/VCXWeb3DMaster/assets/nls/VCXWeb3DMaster"],function(e,t,r,i,a,n,o,l,s,c,p,h,d,u,g,y,M,C,b){"use strict";return t.extend({init:function(){this._parent(),this._requestedBOMID=null},OnChangeProperty:function(e,t,r){if(r||(r={}),r.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;if(r.fromChildClass=!0,!this._parent(e,t,r)){var i=null;switch(e){case"Actor.BomId":this._requestedBOMID=t.GetValue();break;case"Actor.Env.Effect":this._requestedEnvEffect=t.GetValue();break;case"Actor.PLM.Material":this._requestedPLMMaterial=t.GetValue();break;default:if(!e.startsWith("Actor.Highlight."))return!1;var a=e.substring(16);(i=this.GetObject()).HighlightData||(i.HighlightData=i.DefaultHighlightData),i.HighlightData[a]=t.GetValue()}}return!0},OnChangePropertiesEnd:function(){this._parent();var e=this.GetObject();if(null!==this._requestedBOMID){if(e.bomID!==this._requestedBOMID){var t=e._experienceBase.getManager("VCXModelChangeListener");t&&t.hasChanged(a.FChangeFlag.BomID,!0),e.bomID=this._requestedBOMID}this._requestedBOMID=null}if(void 0!==this._requestedEnvEffect&&(e._envID!==this._requestedEnvEffect&&(e._envID=this._requestedEnvEffect,e.setDirtyFlag(y.FDirty.Material|y.FDirty.EnvID)),e._envID!==g.EnvironmentalId.PLM&&(this._requestedPLMMaterial=null),delete this._requestedEnvEffect),void 0!==this._requestedPLMMaterial){e._envID!==g.EnvironmentalId.PLM&&(this._requestedPLMMaterial=null);var r=e._experienceBase.getManager("VCXCAT3DXModelManager");if(r){var i=this._requestedPLMMaterial,n=null;i&&(n=e._experienceBase.ComponentsMap.GetComponentFromID(i)),r.ApplyMaterial(this.GetObject(),n,!1)}delete this._requestedPLMMaterial}if(e.IsMesh()||this.GetObject()._experienceBase.getManager("VCXContextManager").isSupported("FullFeaturesOnNodes")){var o=!1;if(e.getDirtyFlag(y.FDirty.Material)&&(e._dirtyMask|=y.FDirty.Color,e._dirtyMask|=y.FDirty.Alpha,o=!0),e.getDirtyFlag(y.FDirty.Color)&&e._textureDocID&&(e._dirtyMask|=y.FDirty.Material),e.getDirtyFlag(y.FDirty.Alpha))switch(null==e._visibilityAlpha&&null==e._alpha||(e._localAlpha=1,null!=e._visibilityAlpha&&(e._localAlpha*=e._visibilityAlpha),null!=e._alpha&&(e._localAlpha*=e._alpha)),e._envID){case g.EnvironmentalId.Glass:e._localAlpha*=.3;break;case g.EnvironmentalId.GlassPlastic:e._localAlpha*=.5}}(e._dirtyMask||o)&&this.applyChanges()},applyChanges:function(){var t=this.GetObject(),r=t._experienceBase.getManager("VCXContextManager");if(t._dirtyMask){var i=(l=r.getActiveViewport())&&l.QueryInterface("VCXIModifiable").GetPropertyValue("Render.ChildrenStronger")||!1;if(t.getDirtyFlag(y.FDirty.Position)&&(t.setPosition(t.matrix),t.setDirtyFlag(y.FDirty.Position,!1)),t.getDirtyFlag(y.FDirty.Priority)&&(t.setRenderPriority(t.priority),t.setDirtyFlag(y.FDirty.Priority,!1)),t.getDirtyFlag(y.FDirty.LayerOpacity)&&(t.setRenderOpacity(t.layerOpacity),t.setDirtyFlag(y.FDirty.LayerOpacity,!1)),t.getDirtyFlag(y.FDirty.Alpha)&&(t.OverrideAlpha(t.localOpacityIsDefined?t.localAlpha*t.visibilityAlpha:1!==t.visibilityAlpha?t.visibilityAlpha:null,null,i),t.setDirtyFlag(y.FDirty.Alpha,!1)),t.getDirtyFlag(y.FDirty.Highlight)){if(!t.HighlightData||!t.HighlightData.Enabled)if(t._highlightSet)(n=t._experienceBase.getManager("VCXContextManager").getMainViewer()).removeHighlightSet(t._highlightSet),delete t._highlightSet;if(t.HighlightData&&t.HighlightData.Enabled){var a=t.QueryInterface("W3AISGNodeHolder").getPathElement(),n=t._experienceBase.getManager("VCXContextManager").getMainViewer();t.HighlightData||(t.HighlightData=t.DefaultHighlightData);var o=t.HighlightData.polite?new M.AdvancedPoliteHighlightData(t.HighlightData):new M.HaloHighlightData(t.HighlightData);t._highlightSet||(t._highlightSet=n.createHighlightSet(o,!1,t.HighlightData.polite,!0),t._highlightSet.add(a,{highlightColor:o},!0)),t._highlightSet.setHighlightData(t.HighlightData.polite,o)}}if((t.getDirtyFlag(y.FDirty.Color)||t.getDirtyFlag(y.FDirty.Material))&&(t.UpdateLocalMaterial(),t.OverrideMaterial(t.localMaterial,null,null,i),t.setDirtyFlag(y.FDirty.Color,!1),t.setDirtyFlag(y.FDirty.Material,!1)),t.getDirtyFlag(y.FDirty.RenderingMode)){var l,s=t.renderingMode;if(l=t._experienceBase.getManager("VCXVisuManager").getActiveViewport()){var c=l.QueryInterface("VCXIModifiable").GetPropertyValue("Render.Mode"),p=l.QueryInterface("VCXIModifiable").GetPropertyValue("Render.ShowConstructions");c!==y.ERenderingMode.Custom&&(s=c)}t.OverrideRenderingMode(s,null,i,p),t.setDirtyFlag(y.FDirty.RenderingMode,!1)}t.getDirtyFlag(y.FDirty.Visibility)&&(t.OverrideVisibility(t.localVisibility,null,i),t.setDirtyFlag(y.FDirty.Visibility,!1)),e.publish({event:"VCX_PROPERTIES_CHANGED"})}},GetProperty:function(e){var t=null,a=this.GetObject();a._experienceBase.getManager("VCXContextManager");let n,o;switch(e){case"Actor.Opacity":if(this.GetObject().localOpacityIsDefined)return this._parent(e);(n=new c).SetValue(1),(o=new i(e,0,!0,C)).SetBounds(0,1,.1),o.SetDefined(!1),t=new r(o,n);break;case"Actor.BomId":(n=new l).SetValue(this.GetObject().bomID),t=new r(new i(e,0,!0,b),n);break;case"Actor.Env.Effect":(o=new p(e,0,!0,b)).Seti18nGroup(C),o.SetGroupId("Group.Appearance"),o.SetVisible(!1),n=new h(a._envID),t=new r(o,n);break;case"Actor.PLM.Material.Choice":if(this.QueryInterface("CATI3DExperienceObject")){var y=this.GetProperty("Actor.Env.Effect")&&this.GetProperty("Actor.Env.Effect").GetPropertyValue().Value;V=y===g.EnvironmentalId.PLM?a.PLMMaterialID:y;var M={};a._MaterialDescription||(M={0:"material.none"});var D=0,v=g.EnvironmentalId.PLM+1,f=a._experienceBase.getManager("VCXMaterialManager").getPLMMaterials();for(v=0;v<f.length;v++)y===g.EnvironmentalId.PLM&&(V&&f[v].ID&&f[v].ID===V||!V&&a._MaterialDescription&&f[v].PID===a._MaterialDescription.PID)&&(D=v+g.EnvironmentalId.PLM+1),M[v+g.EnvironmentalId.PLM+1]=f[v].Name;(o=new p(e,1,!1,b)).SetMapChoiceEnum(M),o.SetGroupId("Group.Appearance"),n=new h(a._envID===g.EnvironmentalId.PLM||a._MaterialDescription?D:a._envID),t=new r(o,n)}break;case"Actor.PLM.Material":var V=a.PLMMaterialID;n=new s(V),(o=new i(e,0,!0,C)).SetGroupId("Group.Appearance"),o.SetVisible(!1),t=new r(o,n);break;case"Actor.Prop.Area":(n=new c).SetValue(a._area),(o=new i(e,0,!0,b)).Seti18nGroup(C),o.SetGroupId("Group.Geometry"),t=new r(o,n);break;case"Actor.Prop.Volume":(n=new c).SetValue(a._volume),(o=new i(e,0,!0,b)).Seti18nGroup(C),o.SetGroupId("Group.Geometry"),t=new r(o,n);break;case"Actor.Color.CAD":var P=a.BuildGraphicPropertiesStructure({getColor:!0});(n=new u).SetValue(P&&P[0].visible&&P[0].visible.ComputedColor),(o=new i(e,0,!1,b)).Seti18nGroup(C),o.SetGroupId("Group.Appearance"),t=new r(o,n);break;case"Actor.Material.CAD":(n=new l).SetValue(a._MaterialDescription&&a._MaterialDescription.Name),(o=new i(e,0,!1,b)).Seti18nGroup(C),o.SetGroupId("Group.Appearance"),t=new r(o,n);break;default:if(e.startsWith("Actor.Highlight.")){var G=e.substring(16);switch((o=new i(e,0,!0,b)).Seti18nGroup(C),o.SetGroupId("Group.Highlight"),G){case"Enabled":o.SetControlsGroupVisibility(!0),n=new d;break;case"colorEnabled":case"haloEnabled":case"outlineEnabled":case"polite":o.SetControlsGroupVisibility(!0),n=new d;break;case"color":case"haloColor":case"lineicHaloColor":case"outlineColor":case"lineicOutlineColor":n=new u;break;case"intensity":n=new c;break;case"haloIntensity":n=new c,o.SetBounds(0,8,.1);break;case"visibleAlpha":case"occludedAlpha":case"outlineAlpha":case"lineicOutlineAlpha":n=new c,o.SetBounds(0,1,.1);break;case"haloThickness":n=new c,o.SetBounds(0,4,.1);break;case"outlineThickness":n=new c,o.SetBounds(0,16,.1)}a.HighlightData||(a.HighlightData=a.DefaultHighlightData),n.SetValue(a.HighlightData[G]),t=new r(o,n)}else t=this._parent(e)}return t},RequestModification:function(e){if(e){var t=e.GetPropertyInfo().GetPropertyName();if("Actor.Highlight.color"===t){let t=this._parent(e),i=new p("Actor.Highlight.haloColor",0,!0,b);return t.AddOrModifyProperty(new r(i,e.GetPropertyValue().Clone())),i=new p("Actor.Highlight.outlineColor",0,!0,b),t.AddOrModifyProperty(new r(i,e.GetPropertyValue().Clone())),t}if("Actor.PLM.Material.Choice"===t){var i=new o,a=e.GetPropertyValue().Value,n=a>=g.EnvironmentalId.PLM,l=new p("Actor.Env.Effect",0,!0,b),c=new h(n?g.EnvironmentalId.PLM:a);return i.AddOrModifyProperty(new r(l,c)),n?UWA.Promise.resolve().then(()=>{var e=null;a&&(e=this.GetObject()._experienceBase.getManager("VCXMaterialManager").getPLMMaterials()[a-(g.EnvironmentalId.PLM+1)]);var t=this.GetObject();return t._MaterialDescription&&e.PID===t._MaterialDescription.PID?null:e&&e.ID?e.ID:this.GetObject()._experienceBase.getManager("VCXCAT3DXModelManager").GetMaterialFromMaterialDescription(e).then(e=>e&&e.GetID())}).then(e=>{let t=this.GetProperty("Actor.PLM.Material").GetPropertyInfo(),a=new s;return e&&a.SetValue(e),i.AddOrModifyProperty(new r(t,a)),i}):i}}return this._parent(e)},GetProperties:function(){var e=this._parent();return(this.GetObject().IsMesh()||this.GetObject()._experienceBase.getManager("VCXContextManager").isSupported("FullFeaturesOnNodes"))&&(e.AddOrModifyProperty(this.GetProperty("Actor.Env.Effect")),e.AddOrModifyProperty(this.GetProperty("Actor.PLM.Material"))),e},IsLiving:function(){var e=this.QueryInterface("VCXIVisibility");return!e||e.GetVisibility()!==n.EVisState.Hidden}})}),define("DS/VCXWeb3DMaster/VCXModifiableViewOccurrenceComposer",["DS/VCXWebExperienceBase/VCXModifiableViewOccurrenceExt","DS/VCXWebProperties/VCXPropertyGroup","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables","i18n!DS/VCXWeb3DMaster/assets/nls/VCXWeb3DMaster"],function(e,t,r,i){"use strict";return e.extend({init:function(){this._parent()},getPropertyGroups:function(e){e||(e={});var a=this.getGroupPropertiesOrders();if(this._parent(e),e["Group.Essentials"]||(e["Group.Essentials"]=new t({groupID:"Group.Essentials"}),e["Group.Essentials"].i18nGroup=r),e["Group.Essentials"].priority=0,e["Group.Essentials"].removeProperty,e["Group.Essentials"].addProperties([{propertyName:"Actor.Name",i18n:r},{propertyName:"Actor.Opacity",i18n:r}]),this.GetObject().IsMesh()||this.GetObject()._experienceBase.getManager("VCXContextManager").isSupported("FullFeaturesOnNodes")){this.GetObject()._experienceBase.getManager("VCXContextManager").getProdHighMode()&&e["Group.Essentials"].addProperties([{propertyName:"Actor.Position",i18n:r,hiddenFields:["Orientation","Pivot"]}]),e["Group.Appearance"]||(e["Group.Appearance"]=new t({groupID:"Group.Appearance"})),e["Group.Appearance"].priority=10,e["Group.Appearance"].i18nGroup=r,e["Group.Appearance"].setPropertiesOrder(a["Group.Appearance"]),e["Group.Appearance"].addProperties([{propertyName:"Actor.PLM.Material.Choice",i18n:i}]),e["Group.Highlight"]||(e["Group.Highlight"]=new t({groupID:"Group.Highlight"}),e["Group.Highlight"].visibility=!0,e["Group.Highlight"].PropertyControlingGroupVisibility="Actor.Highlight.Enabled"),e["Group.Highlight"].priority=10,e["Group.Highlight"].i18nGroup=r,e["Group.Highlight"].setPropertiesOrder(a["Group.Highlight"]),e["Group.Highlight"].addProperties([{propertyName:"Actor.Highlight.Enabled",i18n:r}]);var n=this.QueryInterface("VCXIModifiable");n&&n.GetProperty("Actor.Highlight.Enabled")&&n.GetProperty("Actor.Highlight.Enabled").GetPropertyValue().Value&&(e["Group.Highlight"].addProperties([{propertyName:"Actor.Highlight.color",i18n:r}]),e["Group.Highlight"].addProperties([{propertyName:"Actor.Highlight.haloEnabled",i18n:r}]),n.GetProperty("Actor.Highlight.haloEnabled").GetPropertyValue().Value&&(e["Group.Highlight"].addProperties([{propertyName:"Actor.Highlight.haloIntensity",i18n:r},{propertyName:"Actor.Highlight.haloThickness",i18n:r}]),n.GetProperty("Actor.Highlight.polite").GetPropertyValue().Value&&e["Group.Highlight"].addProperties([])),e["Group.Highlight"].addProperties([{propertyName:"Actor.Highlight.colorEnabled",i18n:r}]),n.GetProperty("Actor.Highlight.colorEnabled").GetPropertyValue().Value&&(n.GetProperty("Actor.Highlight.polite").GetPropertyValue().Value?e["Group.Highlight"].addProperties([{propertyName:"Actor.Highlight.visibleAlpha",i18n:r}]):e["Group.Highlight"].addProperties([{propertyName:"Actor.Highlight.intensity",i18n:r}])))}return this.GetObject()._experienceBase.ModifiablesAdvancedProperties&&(e["Group.Introspection"]||(e["Group.Introspection"]=new t({groupID:"Group.Introspection"}),e["Group.Introspection"].i18nGroup=r),e["Group.Introspection"].priority=200,e["Group.Introspection"].addProperty({propertyName:"Actor.3DReference",i18n:r})),e},_pushAdditionalPropertyButton:function(e,t,r){e[t]||(e[t]={}),e[t].buttons||(e[t].buttons=[]),e[t].buttons.push(r)},getAdditionalPropertySettings:function(){var e=this._parent()||{},t=this.QueryInterface("VCXIModifiable");t.GetProperty("Actor.Opacity.Defined")&&t.GetProperty("Actor.Opacity.Defined").GetPropertyValue()?this._pushAdditionalPropertyButton(e,"Actor.Opacity",{type:"Restore",data:{object:this.GetObject(),propertiesToRestore:["Actor.Opacity","Actor.Opacity.Defined"]},tooltip:"Restore default opacity",available:!0}):e["Actor.Opacity"]={},e["Actor.Opacity"].overridePropertyList=["Actor.Opacity","Actor.Opacity.Defined"],e["Actor.PLM.Material.Choice"]={overridePropertyList:["Actor.Env.Effect","Actor.PLM.Material"],disableLiveChange:500},this._pushAdditionalPropertyButton(e,"Actor.PLM.Material.Choice",{type:"Restore",data:{object:this.GetObject(),propertiesToRestore:["Actor.Env.Effect","Actor.PLM.Material"]},tooltip:"Restore default material",available:!0}),this._pushAdditionalPropertyButton(e,"Actor.PLM.Material.Choice",{functionCB:function(e){e&&e.data&&e.data.object&&e.data.object._experienceBase.getManager("VCXCAT3DXModelManager").SearchInApp("[ds6w:type]:dsc_matref_ref_Covering").then(function(t){if(t&&t.id&&t.label)return e.data.object._experienceBase.getManager("VCXCAT3DXModelManager").InsertMaterial(t.label,null,t.id,[e.data.object])})},type:"materialAdd",iconName:"material-add",tooltip:"Add a new material to the list",location:3,data:{object:this.GetObject()},available:!0});for(var r,i,a=this.GetObject().BuildGraphicPropertiesStructure({getColor:!0,getMaterial:!0,getOpacity:!0}),n=!1,o=1;o<a.length;o++)a&&a[o].override&&(!i&&a[o].override.Material&&(i=a[o].object),!r&&a[o].override.Opacity&&(r=a[o].object)),a&&a[o].cad&&a[o].cad.material&&(n=!0);return n&&(e["Actor.PLM.Material.Choice"].showUndefined=!0),i&&this._pushAdditionalPropertyButton(e,"Actor.PLM.Material.Choice",{type:"NavigateTo",data:{objectToNavigateTo:i},available:!0}),r&&this._pushAdditionalPropertyButton(e,"Actor.Opacity",{type:"NavigateTo",data:{objectToNavigateTo:r},available:!0}),e},getGroupPropertiesOrders:function(){var e=this._parent()||{};return UWA.extend(e,{"Group.Appearance":["Actor.Color","Actor.Color.Defined","Actor.PLM.Material.Choice"],"Group.Highlight":[]}),e}})}),define("DS/VCXWeb3DMaster/VCXNavigableAssetOccurrenceComposer",["DS/WebApplicationBase/VCXAModelNavigable"],function(e){"use strict";return e.extend({getAssetNavigable:function(){return this}})}),define("DS/VCXWeb3DMaster/VCXSGNodeHolderAssetOccurrenceComposer",["DS/WebApplicationBase/W3AASGNodeHolder","DS/Visualization/Node3D"],function(e,t){"use strict";return e.extend({init:function(){},buildSGNode:function(){if(!this._sgNode){this._sgNode=new t({name:"LoadedAsset"}),this._sgNode.productType="Instance3D"}var e=this.QueryInterface("VCXIModelNavigable");if(e){var r=e.getParent();if(r){var i=r.QueryInterface("W3AISGNodeHolder");i&&(i.getSGNode().addChild(this._sgNode),this._pathElement=i.getPathElement().clone(),this._pathElement.addElement(this._sgNode))}}return this._sgNode},isSelfManagedPathElement:function(){return!0}})}),define("DS/VCXWeb3DMaster/VCXComponentOccurrenceComposer",["DS/VCXWebExperienceBase/VCXComponentOccurrenceExt","DS/VCXWebComponents/VCXWebComponentOccurrence","DS/Visualization/SceneGraphFactory","DS/SceneGraphOverrides/GenericOverride","DS/VCXWebKernelTools/VCXEnums","DS/Visualization/SceneGraphUtils","DS/Visualization/OccurrenceExplorer","DS/Visualization/PrimitiveIterator","DS/Visualization/ThreeJS_DS"],function(e,t,r,i,a,n,o,l,s){"use strict";var c=e.extend({init:function(){this._parent(),this._bomID="",this._isRenderable=!1,this._isMesh=!1,this._envID=a.EnvironmentalId.None,this._area=-1,this._volume=-1},IsRenderable:function(){return this._isRenderable},IsMesh:function(){return this._isMesh},SetIsRenderable:function(e){this._isRenderable=e},BuildGraphicPropertiesStructure:function(e){for(var t=this._experienceBase.getManager("VCXContextManager"),r=t&&t.getMainViewer(),i=e&&(e.getColor||e.getAll),a=e&&(e.getOpacity||e.getAll),o=e&&(e.getMaterial||e.getAll||i||a),l=e&&(e.getWorldPosition||e.getAll),c=e&&(e.getVisibility||e.getAll),p=e&&(e.getRenderStyle||e.getAll),h=[],d=this,u=0;d;){u++;var g={};g.object=d;var y=d.QueryInterface("W3AISGNodeHolder").getPathElement();if(y){if(g.pathElement=y,1===u){g.cad={};var M=n.getCurrentGraphicProperties({pathElement:y,getMaterial:o,getColor:i,getOpacity:a});M&&M.length>0&&(o&&(g.cad.Material=M[0].material),i&&(g.cad.Color=M[0].color),a&&(g.cad.Opacity=M[0].opacity),c&&(g.cad.Visibility=n.getCurrentVisibility(y)),l&&(g.cad.WorldPosition=y.getWorldMatrix(r)))}var C=d.getSharedSceneGraphOverride&&d.getSharedSceneGraphOverride(y);if(C){var b={},D=!1;o&&null!=C.getMaterial()&&(D=!0,b.Material=C.getMaterial()),i&&null!=C.getColor()&&(D=!0,b.Color=new s.Color(C.getColor())),a&&null!=C.getOpacity()&&(D=!0,b.Opacity=C.getOpacity()),c&&null!=C.getVisibility()&&(D=!0,b.Visibility=C.getVisibility()),p&&null!=C.getRenderStyle()&&(D=!0,b.RenderStyle=C.getRenderStyle()),D&&(g.override=b)}}h.push(g),d=d.QueryInterface("VCXIModelNavigable")&&d.QueryInterface("VCXIModelNavigable").getParent()&&d.QueryInterface("VCXIModelNavigable").getParent().GetObject()}for(var v=0;v<1;v++){h[v].visible={},h[v].cad?(o&&h[v].cad.hasOwnProperty("Material")&&(h[v].visible.Material=h[v].cad.Material),i&&h[v].cad.hasOwnProperty("Color")&&(h[v].visible.Color=h[v].cad.Color),a&&h[v].cad.hasOwnProperty("Opacity")&&(h[v].visible.Opacity=h[v].cad.Opacity),c&&h[v].cad.hasOwnProperty("Visibility")&&(h[v].visible.Visibility=h[v].cad.Visibility)):(o&&(h[v].visible.Material=null),i&&(h[v].visible.Color=new s.Color),a&&(h[v].visible.Opacity=1),c&&(h[v].visible.Visibility=!0),p&&(h[v].visible.RenderStyle=0));for(var f=v;f<h.length;f++)h[f].override&&(o&&h[f].override.hasOwnProperty("Material")&&(h[v].visible.Material=h[f].override.Material),i&&h[f].override.hasOwnProperty("Color")&&(h[v].visible.Color=h[f].override.Color),a&&h[f].override.hasOwnProperty("Opacity")&&(h[v].visible.Opacity=h[f].override.Opacity),c&&h[f].override.hasOwnProperty("Visibility")&&!1===h[f].override.Visibility&&(h[v].visible.Visibility=!1),p&&h[f].override.hasOwnProperty("RenderStyle")&&(h[v].visible.RenderStyle=h[f].override.RenderStyle));if(a){var V=h[v].visible&&h[v].visible.Material,P=1;V&&(P=V.getOpacity()),h[v].visible.ComputedOpacity=P*(h[v].visible.hasOwnProperty("Opacity")?h[v].visible.Opacity:1)}i&&(h[v].visible.hasOwnProperty("Material")&&h[v].visible.Material&&h[v].visible.Material.color?h[v].visible.ComputedColor=h[v].visible.Material.color:h[v].visible.hasOwnProperty("Color")&&(h[v].visible.ComputedColor=h[v].visible.Color))}return h},SetIsMesh:function(e){this._isMesh=e,e&&(this._isRenderable=!0)},getSharedSceneGraphOverride:function(e,t){var r=e;e||(r=this.QueryInterface("W3AISGNodeHolder").getPathElement());return this._experienceBase.getManager("VCXContextManager").getSharedSceneGraphOverride(r,t)},getMaterial:function(){var e=this.getSharedSceneGraphOverride();return e?e._values.fullMaterial&&void 0!==e._values.fullMaterial?e._values.fullMaterial:e.getMaterial():null},setMaterial:function(e,t){var r=this.getSharedSceneGraphOverride(null,!0);r&&r.setMaterial(e,t)},getColor:function(){var e=this.getSharedSceneGraphOverride();return e?e.getColor():null},setColor:function(e,t){var r=this.getSharedSceneGraphOverride(null,!0);r&&r.setColor(e,t)},getOpacity:function(){var e=this.getSharedSceneGraphOverride();return e?e.getOpacity():null},setOpacity:function(e,t){var r=this.getSharedSceneGraphOverride(null,!0);r&&r.setOpacity(e,t)},getVisibility:function(){var e=this.getSharedSceneGraphOverride();return e?e.getVisibility():null},setVisibility:function(e,t){var r=this.getSharedSceneGraphOverride(null,!0);r&&r.setVisibility(e,t),this._experienceBase.getManager("VCXContextManager").partHasMoved=!0},setPickability:function(e){var t=this.getSharedSceneGraphOverride(null,!0);t&&t.setPickability(e)},setPosition:function(e){var t=this.getSharedSceneGraphOverride(null,!0);t&&t.setPosition(e),this._experienceBase.getManager("VCXContextManager").partHasMoved=!0},getPosition:function(){var e=this._experienceBase.getManager("VCXContextManager"),t=this.QueryInterface("W3AISGNodeHolder");if(t)return t.getMatrix(e.getMainViewer());console.error("We shouldn't be here");var r=this.getSharedSceneGraphOverride();return r?r.getPosition():null},getRenderPriority:function(){return this._priority},setRenderPriority:function(e,t){this._priority=e;var r=this._experienceBase.getManager("VCXContextManager"),i=this.QueryInterface("W3AISGNodeHolder");i&&r&&n.setRenderPriority&&n.setRenderPriority(i.getPathElement(),this._priority,r.getMainViewer())},getRenderOpacity:function(){return this._layerOpacity},setRenderOpacity:function(e,t){this._layerOpacity=e;var r=this._experienceBase.getManager("VCXContextManager"),i=this.QueryInterface("W3AISGNodeHolder");i&&r&&n.setRenderPriorityOpacity&&n.setRenderPriorityOpacity(i.getPathElement(),this._layerOpacity,r.getMainViewer())},HasMaterialOverrideToApply:function(){return!!this.GetObject()._experienceBase.getManager("VCXContextManager").isSupported("FullFeaturesOnNodes")||!!this.IsMesh()&&(this.PLMMaterialID&&this._envID===a.EnvironmentalId.PLM||this._envID||-1!==this._textureDocID||this.renderingMode>2)},HasColorOverrideToApply:function(){if(this.GetObject()._experienceBase.getManager("VCXContextManager").isSupported("FullFeaturesOnNodes"))return this.localColorIsDefined;if(!this.IsMesh())return!0;var e=!1;switch(this._envID){case a.EnvironmentalId.Chromic:case a.EnvironmentalId.Glass:case a.EnvironmentalId.Gold:case a.EnvironmentalId.Aluminium:case a.EnvironmentalId.Satin:case a.EnvironmentalId.PLM:e=!1;break;case a.EnvironmentalId.None:case a.EnvironmentalId.Metal:case a.EnvironmentalId.MetalBrushed:case a.EnvironmentalId.Plastic:case a.EnvironmentalId.GlassPlastic:case a.EnvironmentalId.ChromicWithColor:e=!0,-1!==this._textureDocID&&(e=!1);break;default:e=!1}return e},HasOpacityOverrideToApply:function(){return!0},UpdateLocalMaterial:function(){this._parent(),(this.IsMesh()||this.GetObject()._experienceBase.getManager("VCXContextManager").isSupported("FullFeaturesOnNodes"))&&(!1===this.HasMaterialOverrideToApply()?this._localMaterial=null:(this._localMaterial=this._PLMMaterial,this._MaterialNoShared=null),this._dirtyMask&=~t.maskMaterialParamsDirty)},OverrideAlpha:function(e,t,r){var i=this.getSharedSceneGraphOverride(t,!0);i&&i.setOpacity(this.HasOpacityOverrideToApply()?e:null,r)},OverrideVisibility:function(e,t,r){var i=this.getSharedSceneGraphOverride(t,!0);i&&i.setVisibility(e,r)},OverrideColor:function(e,t,r){if(this.HasColorOverrideToApply()){var i=this.getSharedSceneGraphOverride(t,!0);i&&(e?i.setColor(e,r):i.resetColor())}},OverrideMaterial:function(e,t,r,a){var n=this.getSharedSceneGraphOverride(r,!0);if(n){var o=this.HasMaterialOverrideToApply()?e:null;if(o?n.setMaterial(o,a):n.setMaterial(null,a),this.HasColorOverrideToApply()){var l=null;t?l=t:this.localColor&&(!0===this.localColorIsDefined||this.HasMaterialOverrideToApply()&&e)&&(l=this.localColor),n.setColor(l,a)}else o?n.setColor(i.NO_COLOR,a):n.setColor(null,a)}},OverrideRenderingMode:function(e,r,i,a){var n=this.getSharedSceneGraphOverride(r,!0);if(n){var o=this._experienceBase.getManager("VCXMaterialManager");if(o){var l=null;switch(e){case t.ERenderingMode.Custom:l=o.getRenderStyle(this.renderingMode,t.EOutlineType.Smart,a);break;case t.ERenderingMode.SmoothOutline:case t.ERenderingMode.Technical:case t.ERenderingMode.FlatTechnical:case t.ERenderingMode.Silhouette:var s=2,c=this._experienceBase.getManager("VCXVisuManager").getActiveViewport();c&&(s=c.QueryInterface("VCXIModifiable").GetPropertyValue("Render.OutlineType")),l=o.getRenderStyle(e,s,a)}n.setRenderStyle(l,i)}}},debugVisu:function(){function e(e,t){var r,i,a,n,o=l._authorizedTeamsOnly_getKey();e.getColor();for(r=e.getMesh3D(),n=t.getLastElement(!0)===r?t:r,e.getWorldMatrix(),i=new l(n,o),a=0;a<i.getNbPrimitives();a++)console.log(i.getGas(a)._alpha);return[]}var t=this._experienceBase.getManager("VCXContextManager"),r=new o(t.getMainViewer()),i=this.QueryInterface("W3AISGNodeHolder").getPathElement();r.explore(function(t){var r,a,n=(a=t.getOccurrenceItf(i)).getRenderableDescendants();for(r=0;r<n.length;r++)(a=n[r]).getVisibility()&&e(a,i)})}});return Object.defineProperty(c.prototype,"bomID",{enumerable:!0,get:function(){return this._bomID},set:function(e){this._bomID=e}}),Object.defineProperty(c.prototype,"DefaultHighlightData",{enumerable:!0,get:function(){return{Enabled:!1,polite:!0,priority:-1,colorEnabled:!0,color:new s.Color(16703488),intensity:1,visibleAlpha:.6,occludedAlpha:.15,haloEnabled:!0,haloColor:new s.Color(16703488),lineicHaloColor:new s.Color(16703488),haloIntensity:2,haloThickness:4,outlineEnabled:!1,outlineColor:new s.Color(16703488),lineicOutlineColor:new s.Color(16703488),outlineAlpha:1,outlineThickness:1}}}),Object.defineProperty(c.prototype,"HighlightData",{enumerable:!0,get:function(){return this._highlightData},set:function(e){let r=this.QueryInterface("VCXIModelNavigable"),i=0;for(;r;)r=r.getParent(),i++;e.priority=-i,this._highlightData=e,this._dirtyMask|=t.FDirty.Highlight}}),Object.defineProperty(c.prototype,"PLMMaterial",{enumerable:!0,get:function(){return this._PLMMaterial},set:function(e){this._PLMMaterial=e,this._dirtyMask|=t.FDirty.Material|t.FDirty.Color|t.FDirty.Alpha}}),c.mask=t.FDirty.Alpha|t.FDirty.Color|t.FDirty.Material|t.FDirty.Visibility|t.FDirty.RenderingMode,c.maskInv=~c.mask,t.addDirtyFlags(["EnvID","TextureDocID","TextureProjectionType","TextureProjectionMatrix","TextureUVMatrix","TextureUVscale","TextureUVratio","TextureBlending","TextureTransparency","TextureBorderMode","Geometry"]),t.maskForceMaterialUpdate=t.FDirty.TextureDocID|t.FDirty.TextureTransparency|t.FDirty.EnvID|t.FDirty.TextureProjectionType|t.FDirty.TextureBorderMode,t.maskMaterialParamsDirty=t.FDirty.TextureDocID|t.FDirty.TextureProjectionType|t.FDirty.TextureProjectionMatrix|t.FDirty.TextureUVMatrix|t.FDirty.TextureUVscale|t.FDirty.TextureUVratio|t.FDirty.TextureBlending|t.FDirty.TextureTransparency|t.FDirty.TextureBorderMode,Object.defineProperty(c.prototype,"componentType",{enumerable:!0,get:function(){return"VCXComponentOccurrenceComposer"}}),c}),define("DS/VCXWeb3DMaster/VCXComponentAssetOccurrenceComposer",["DS/VCXWeb3DMaster/VCXComponentOccurrenceComposer"],function(e){"use strict";var t=e.extend({init:function(){this._parent(),this._nodeID=null,this._assetID=null,this._eType=0,this._bIsLoaded=!1},SetAssetID:function(e){this._assetID=e},GetAssetID:function(){return this._assetID},SetNodeID:function(e){this._nodeID=e},GetNodeID:function(){return this._nodeID},SetAssetType:function(e){this._eType=e},GetAssetType:function(){return this._eType},SetIsLoaded:function(e){this._bIsLoaded=e},IsLoaded:function(){return this._bIsLoaded}});return Object.defineProperty(t.prototype,"componentType",{enumerable:!0,get:function(){return"VCXComponentAssetOccurrenceComposer"}}),t}),define("DS/VCXWeb3DMaster/VCXModifiableAssetOccurrenceComposer",["DS/VCXWeb3DMaster/VCXModifiableOccurrenceComposer","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueEnum","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyInfoEnum","DS/Visualization/ModelLoader","DS/CoreEvents/Events","UWA/Utils","i18n!DS/VCXWeb3DMaster/assets/nls/VCXWeb3DMaster"],function(e,t,r,i,a,n,o,l,s,c){"use strict";return e.extend({init:function(){this._parent()},OnChangeProperty:function(e,t,r){if(r||(r={}),r.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;if(r.fromChildClass=!0,!this._parent(e,t,r))switch(e){case"Actor.NodeID":var i=this.GetObject(),a=t.GetValue();i.GetNodeID()!==a&&i.SetNodeID(a);break;case"Actor.AssetID":i=this.GetObject(),a=t.GetValue();i.GetAssetID()!==a&&i.SetAssetID(a);break;case"Actor.AssetType":i=this.GetObject(),a=t.GetValue();i.GetAssetType()!==a&&i.SetAssetType(a);break;default:return!1}return!0},OnChangePropertiesEnd:function(){if(this._parent(),!this.GetObject().IsLoaded()){var e=this.GetObject();e.SetIsLoaded(!0);var t=e.GetAssetID(),r=this.QueryInterface("W3AISGNodeHolder").getSGNode(),i=t.split(".")[0];if(e.GetNodeID());else{var a=i+"-"+s.getUUID().substr(0,18);e.SetNodeID(a)}if(e.name=i,r.setName(e.GetNodeID()),e.name=i,e._experienceBase._mapAssetsBlob){var n=e._experienceBase._mapAssetsBlob[t],c=e.GetAssetType();if(n&&0===c){var p=e._experienceBase.getManager("VCXContextManager").getMainViewer(),h=new o(p.getWebGLContext(),!1);h.setFileType("xmlv43"),h.activateSmartLoading(p.getRenderer()),h.setRenderCallback(p.render),h.setOnLoadedCallback(function(){l.publish({event:"VCX_ASSET_LOADED",data:e})}),h.loadModel(n,r)}else if(n&&1===c){require(["DS/VCXWebInteropSMG/VCXSmgGeomLoader"],function(t){t&&new t(e._experienceBase).LoadAsModel(n,r,function(){l.publish({event:"VCX_ASSET_LOADED",data:e})})})}}}},GetProperty:function(e){if("Actor.NodeID"===e)return(o=new t).SetValue(this.GetObject().GetNodeID()),new i(new a(e,0,!0,c),o);if("Actor.AssetID"===e)return(o=new t).SetValue(this.GetObject().GetAssetID()),new i(new a(e,0,!0,c),o);if("Actor.AssetType"===e){var o;(o=new r).SetValue(this.GetObject().GetAssetType());var l=new n(e,1,!0,c);return l.AddOrModifyChoice(0,"AssetType.3dxml"),l.AddOrModifyChoice(1,"AssetType.smgGeom"),new i(l,o)}return this._parent(e)},GetProperties:function(){var e=this._parent();return e.AddOrModifyProperty(this.GetProperty("Actor.NodeID")),e.AddOrModifyProperty(this.GetProperty("Actor.AssetID")),e.AddOrModifyProperty(this.GetProperty("Actor.AssetType")),e}})});