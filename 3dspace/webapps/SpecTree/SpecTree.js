define("DS/SpecTree/SpecTreeVault",["DS/Tree/TreeDocument","DS/TreeModel/TreeNodeModel"],function(e,t){"use strict";var o="default",i={MODEL:"model",FAKE:"fake",LAYOUT:"layout"},n={NONE:{icon:void 0,color:"transparent"},ERROR:{icon:{fontIconFamily:WUXManagedFontIcons.FontAwesome,iconName:"exclamation-circle",className:"wux-spectree-notification-icon"},color:"#EA4F37"},INFO:{icon:{fontIconFamily:WUXManagedFontIcons.FontAwesome,iconName:"info-circle",className:"wux-spectree-notification-icon"},color:"#42A2DA"},WARNING:{icon:{fontIconFamily:WUXManagedFontIcons.FontAwesome,iconName:"exclamation-triangle",className:"wux-spectree-notification-icon"},color:"#E87B00"},OUTOFDATE:{icon:{fontIconFamily:WUXManagedFontIcons.Font3DS,iconName:"update",className:"wux-spectree-notification-icon"},color:"#007DA3"}};function s(){return this.TYPES_VAULT={},this.RESOLVED_TYPES_VAULT={},this.DEFAULT_APP_NS=o,this.NODE_CATEGORIES=i,this.NOTIFICATIONS=n,this}return s.prototype.registerModelNodeType=function(e){return e.nodeCategory=this.NODE_CATEGORIES.MODEL,this._registerNodeType(e)},s.prototype.registerFakeNodeType=function(e){return e.nodeCategory=this.NODE_CATEGORIES.FAKE,this._registerNodeType(e)},s.prototype.registerLayoutNodeType=function(e){return e.nodeCategory=this.NODE_CATEGORIES.LAYOUT,this._registerNodeType(e)},s.prototype._registerNodeType=function(e){var t=e.application?e.application:this.DEFAULT_APP_NS,o=e.nodeType,i=e.nodeCategory;if(!e.nodeType)throw"Cannot register a nodeType without a nodeType option specified";if(!e.nodeCategory)throw"Cannot register a nodeCategory without a nodeCategory option specified";if(!0===this.doesNodeTypeExist(e))throw"This node type has already been registered";var n=this;if(!Object.keys(this.NODE_CATEGORIES).some(function(t){return n.NODE_CATEGORIES[t]===e.nodeCategory}))throw'Node type: "'+o+'" has already been registered';var s=function(e,t,o){if(!(t.length>1))return e[t[0]]={__definition__:o},e;var i=t[0];void 0===e[i]&&(e[i]={}),t.shift(),s(e[i],t,o)};n=this;if(this.getRegisteredNodeType(i,o,t))throw'Node type: "'+o+'" has already been registered';var r,a,l='Error registering nodeType: "'+o+'"';if(!e.buildLabel)throw l+', "buildLabel" callback has not been defined';r=e,a=(t+"."+i+"."+o).split("."),s(n.TYPES_VAULT,a,r)},s.prototype.doesNodeTypeExist=function(e){return e.application=e.application?e.application:this.DEFAULT_APP_NS,!1!==UWA.Json.path(this.TYPES_VAULT,"$."+[e.application,e.nodeCategory,e.nodeType].join("."))},s.prototype.searchNodeType=function(e){var t=UWA.Json.path(this.TYPES_VAULT,"$.."+e.nodeType,{resultType:"PATH"});return t?t.map(function(e){return JSON.parse(e.replace("$","").replace(/\]\[/g,",").replace(/'/g,'"'))}):[]},s.prototype.getResolvedNodeOptions=function(e){return void 0===this.RESOLVED_TYPES_VAULT[e.application]&&(this.RESOLVED_TYPES_VAULT[e.application]={}),void 0===this.RESOLVED_TYPES_VAULT[e.application][e.nodeCategory]&&(this.RESOLVED_TYPES_VAULT[e.application][e.nodeCategory]={}),void 0===this.RESOLVED_TYPES_VAULT[e.application][e.nodeCategory][e.nodeType]&&(this.RESOLVED_TYPES_VAULT[e.application][e.nodeCategory][e.nodeType]=this._mergeNodeType(e.nodeCategory,e.nodeType,e.application)),this.RESOLVED_TYPES_VAULT[e.application][e.nodeCategory][e.nodeType]},s.prototype.getResolvedNodeType=function(e,t,o){return this.getResolvedNodeOptions({application:o,nodeCategory:e,nodeType:t})},s.prototype._processNodeType=function(e,t,o,i,n){var s,r=this,a=t.split("."),l=function(e,t,o,n){var d;((d=r.getRegisteredNodeType(e,t,r.DEFAULT_APP_NS))&&i({nodeCategory:e,nodeType:t,application:r.DEFAULT_APP_NS,options:d}),o)&&((d=r.getRegisteredNodeType(e,t,o))&&i({nodeCategory:e,nodeType:t,application:o,options:d}));return a.length>1?(a.shift(),s=l(e,t+"."+a[0],o,n)):s=n,s};return l(e,a[0],o,{})},s.prototype._mergeNodeType=function(e,t,o){var i=t.split("."),n=this,s=function(e,t,o,r){var a;return i.length>1?((a=n.getRegisteredNodeType(e,t,o))&&(r=UWA.extend(r,a,!0)),i.shift(),s(e,t+"."+i[0],o,r)):((a=n.getRegisteredNodeType(e,t,o))&&(r=UWA.extend(r,a,!0)),r)};return s(e,i[0],o,{})},s.prototype.getRegisteredNodeCategory=function(e,t){void 0===t&&(t=this.DEFAULT_APP_NS);var o=UWA.Json.path(this.TYPES_VAULT[t],"$"+e);return o&&1===o.length?o[0]:void 0},s.prototype.getRegisteredNodeType=function(e,t,o){if(void 0===o&&(o=this.DEFAULT_APP_NS),this.TYPES_VAULT[o]&&this.TYPES_VAULT[o][e]){var i=UWA.Json.path(this.TYPES_VAULT[o][e],"$"+t+".__definition__");return i&&1===i.length?i[0]:void 0}},s.prototype.getNotificationInfos=function(e){var t=this.NOTIFICATIONS[e];return t||{icon:void 0,color:"transparent"}},s}),define("DS/SpecTree/SpecTreeFilter",["DS/TreeModel/BaseFilter"],function(e){"use strict";return e.inherit({name:"SpecTreeFilter",publishedProperties:{},isDataFiltered:function(e){var t=this.filterModel;return!(!t||!t.filterString||""===t.filterString)&&!e.isMatching(t.filterString)},isEmpty:function(){var e=this.filterModel;return!e||!e.filterString||""===e.filterString}})}),define("DS/SpecTree/SpecTreeDocument",["DS/SpecTree/SpecTreeVault","DS/Tree/TreeDocument","DS/TreeModel/TreeNodeModel"],function(e,t,o){"use strict";var i="default";function n(e,t,o){var n,r=o.application?o.application:i,a=o.nodeType;if(a){if(!e.getRegisteredNodeType(t,a,r))throw"Cannot create node. No registered node type"+r+" "+t+" "+a;n={icons:o.icons,label:o.label,grid:{tree:o.label},children:o?o.children:null}}else n={icons:o.icons,label:o.label,grid:{tree:o.label},children:o?o.children:null};var l=new s(n);if(l.__private__={nodeCategory:o.nodeCategory,nodeType:o.nodeType,notification:o.notification,notificationMsg:o.notificationMsg,color:o.color,borderColor:o.borderColor,activeFlag:o.activeFlag,rollbackContainer:o.rollbackContainer},l._setNodeCategory(t),l._setNodeType(o.nodeType),void 0===l._getNodeCategory()||void 0===l._getNodeType())throw"Node is not compliant with the SpecTree Model";return l}var s=o.extendNode({__private__:{},_getContext:function(){var e=this.getTreeDocument();if(e){var t=e.getCurrentApplication(),o=this._getNodeCategory(),i=this._getNodeType();return{treeDocument:e,treeVault:e._specTreeVlt,application:t,nodeCategory:o,nodeType:i}}},getState:function(){return this._isLayoutNode("layout-horizontal")?"noChildren":this._parent()},isExpanded:function(){return!!this._isLayoutNode("layout-horizontal")||this._parent()},_getRowID:function(e){return e&&(this._rowID=this._computeRowID()),this._rowID},_getResolved:function(){var e=this._getContext();if(e&&e.nodeCategory&&e.nodeType&&e.application){var t=e.treeVault.getResolvedNodeType(e.nodeCategory,e.nodeType,e.application);if(t)return this.__resolved__=t,this.__resolved__;throw console.error(e),"Node context is uncorrect, check that application, nodeCategory or nodeType is correct and has been registered"}return{}},_getResolvedAndCall:function(e,t){var o=this._getResolved()[e];return o?o({nodeModel:this}):t?t({nodeModel:this}):void 0},getResolved:function(){return this._getResolved()},getResolvedAndCall:function(e,t){return this._getResolvedAndCall(e,t)},addChild:function(e,t){var o=function(e){e&&e instanceof s&&(e._setUIActive(!0),e.notifyUIActiveChange(),e.getTreeDocument()._listOfUIActiveNodes.push(e))},i=this,n=void 0,r=i.getResolved();r&&r.onPreAddChild&&r.onPreAddChild(i,e,t);var a=i.isUIActive(),l=!1;if(e instanceof Array)0===e.length?n=this._parent(e,t):(i.prepareUpdate(),e.forEach(function(e,n){var s=i.addChild(e,t+n);a&&o(s)}),i.pushUpdate());else{var d=this;if(r&&r.getTrueParent&&(l=!!(d=r.getTrueParent(i,e))&&d._isLayoutNode()),e instanceof s)if(d!==i){var c=d.addChild(e,t);a&&!l&&o(c)}else n=d._parent(e,t);else if(d!==i){c=d.addChild(new s(e),t);a&&!l&&o(c)}else n=d._parent(new s(e),t)}if(a&&!l&&o(n),n&&n.isActive()){var u=n.getTreeDocument();u&&(u.activeNode=n)}r&&r.onPostAddChild&&r.onPostAddChild(i,e)},removeChild:function(e){var t=e;if(t&&t.isActive()){var o=t.getTreeDocument();o&&(o.activeNode=void 0)}var i,n=this.getResolved();n&&n.getTrueParent&&(i=n.getTrueParent(this,e)),n&&n.onPreRemoveChild&&n.onPreRemoveChild(this,e),i&&i!==this?i.removeChild(e):this._parent(e),n&&n.onPostRemoveChild&&n.onPostRemoveChild(this,e)},hasNoRepresentation:function(){return!!this.getResolvedAndCall("hasNoRepresentation")||this._parent()},hasRowID:function(){return(!this.getParent()||!this.getParent()._isLayoutNode("layout-horizontal"))&&this._parent()},getIcons:function(){return this._getResolvedAndCall("buildIcons")||this.options.icons},getLabel:function(){var e=this._getResolvedAndCall("buildLabel");return"string"!=typeof e&&(e=this.options.label),e},setLabel:function(e){return this.setAttribute("tree",e),o.prototype.setLabel.call(this,e)},getEditableLabel:function(){var e=this._getResolvedAndCall("buildEditableLabel");return"string"!=typeof e&&(e=this.options.label),e},getBadges:function(){return this._getResolvedAndCall("buildBadges",function(){return{topLeft:"",topRight:"",bottomLeft:"",bottomRight:""}})},getColor:function(){var e=this._getResolved().buildColor;return e?e({nodeModel:this}):this.__private__.color||"transparent"},getBorderColor:function(){var e=this._getResolved().buildBorderColor;return e?e({nodeModel:this}):this.__private__.borderColor||"transparent"},getTypeId:function(){return this._getResolvedAndCall("getTypeId",function(){return this._getNodeType()}.bind(this))},isActive:function(){return this.__private__.activeFlag||!1},applyDropTreeNodeModel:function(e){var t=this.getResolved();return!(!t||!t.applyDrop)&&t.applyDrop({nodeModel:this,draggedNodes:e.droppedNodes,position:e.dropPosition,dropNode:e.dropNode})},_isDraggable:function(){return!!this.getResolvedAndCall("isDraggable")},_shouldAcceptDrop:function(e,t,o){var i=this.getResolved();return i&&i.shouldAcceptDrop?(e.nodeModel=this,i.shouldAcceptDrop(e,t,o)):(t(!1),!1)},isRollbackable:function(){return!!this.getResolvedAndCall("isRollbackable")},supportsRollback:function(){return!!this.getResolvedAndCall("supportsRollback")},getNotification:function(){return this.__private__.notification},getNotificationMsg:function(){return this.__private__.notificationMsg},getInactiveState:function(){return!!this.__private__.inactiveState&&this.__private__.inactiveState},setInactiveState:function(e){this.__private__.inactiveState!==e&&(this.prepareUpdate(),this.__private__.inactiveState=e,this.notifyModelUpdate(),this.pushUpdate())},activate:function(){var e=this.getTreeDocument();if(e){e.activeNode=this,this.isRollbackable()?(e.prepareUpdate(),this.__private__.activeFlag=!0,this.notifyModelUpdate(),e.pushUpdate()):(this.__private__.activeFlag=!0,this.notifyModelUpdate());var t=e._getTrueRoot();t&&t._modelEvents.publish({event:"uiActiveUpdate",context:e})}},deactivate:function(){if(this.__private__.activeFlag){this.__private__.activeFlag=!1,this.notifyModelUpdate();var e=this.getTreeDocument();if(e){var t=e._getTrueRoot();t&&t._modelEvents.publish({event:"uiActiveUpdate",context:e})}}},defineAsRollbackedNode:function(){this._getResolvedAndCall("onRollbackDefine")},setNotification:function(e,t){this.__private__.notification=e,this.__private__.notificationMsg=t},getPath:function(){return this._parent().filter(function(e){return!e._isLayoutNode()})},_getParentModel:function(){var e=this.getParent();if(e)return e.isModelNode()?e:e._getParentModel()},getAndProcessFeatures:function(e){return this.getChildren()?this.getChildren().filter(function(t){!0===t.options.isFeature&&e(t)}):[]},isMatching:function(e){return!!(e&&""!==e&&(JSON.stringify(this.options.grid)+"  "+this._getNodeType()+" "+this.getLabel()).toLowerCase().indexOf(e.toLowerCase())>=0)},select:function(e){if(this._isLayoutNode("layout-horizontal"))this.withTransactionUpdate(function(){this.isSelected()&&!e||this._parent(e),this.areAllChildrenSelected()||this.getChildren().forEach(function(e){e.isSelected()||e.select(!1)})});else{var t=this.getParent();t&&t._isLayoutNode("layout-horizontal")?this.withTransactionUpdate(function(){this.isSelected()&&!e||this._parent(e),t.areAllChildrenSelected()&&!t.isSelected()&&t.select(!1)}):this._parent(e)}},unselect:function(){if(this._isLayoutNode("layout-horizontal"))this.withTransactionUpdate(function(){this.isSelected()&&this._parent(),this.hasChildren()&&this.areAllChildrenSelected()&&this.getChildren().forEach(function(e){e.isSelected()&&e.unselect()})});else{var e=this.getParent();e&&e._isLayoutNode("layout-horizontal")?this.withTransactionUpdate(function(){this.isSelected()&&this._parent(),e.areAllChildrenSelected()||!e.isSelected()||this.getTreeDocument().getXSO().isBeingEmptied()||e.unselect()}):this._parent()}},preExpandDone:function(e){this._parent.call(this,e)},_getNodeCategory:function(){return this.__private__.nodeCategory},_getNodeType:function(){return this.__private__.nodeType},_setNodeCategory:function(e){this.__private__.nodeCategory=e},_setNodeType:function(e){this.__private__.nodeType=e},isModelNode:function(e){return e?"model"===this._getNodeCategory()&&this._getNodeType()===e:"model"===this._getNodeCategory()},isFakeNode:function(e){return this._isFakeNode(e)},_isLayoutNode:function(e){return e?"layout"===this._getNodeCategory()&&this._getNodeType()===e:"layout"===this._getNodeCategory()},_isFakeNode:function(e){return e?"fake"===this._getNodeCategory()&&this._getNodeType()===e:"fake"===this._getNodeCategory()},_isSubnode:function(){return this.getParent()&&this.getParent()._isLayoutNode("layout-horizontal")},getNextVisibleNode:function(){var e=o.prototype.getNextVisibleNode.apply(this);if(e)return e._isLayoutNode()?e.getNextVisibleNode():e},getPreviousVisibleNode:function(){var e=o.prototype.getPreviousVisibleNode.apply(this);if(e)return e._isLayoutNode()?e.getPreviousVisibleNode():e},collapse:function(e){if(!this._isLayoutNode())return o.prototype.collapse.apply(this,e);this.prepareUpdate(),this._modelEvents.publish({event:"preCollapse",data:{nodeModel:this,virtualRowID:this._rowID},context:this}),this._modelEvents.publish({event:"collapse",data:{nodeModel:this,virtualRowID:this._rowID},context:this}),this._modelEvents.publish({event:"postCollapse",data:{nodeModel:this,virtualRowID:this._rowID},context:this}),this.pushUpdate()},isVisibleInSpecTree:function(){return void 0===this._specTreeVisibility&&(this._specTreeVisibility=!0),this._specTreeVisibility},setVisibilityInSpecTree:function(e){if(this._isLayoutNode("layout-horizontal"))this.withTransactionUpdate(function(){this._specTreeVisibility=e,this.notifyModelUpdate(),this.getChildren().forEach(function(t){t._specTreeVisibility=e,t.notifyModelUpdate()})});else{var t=this.getParent();t&&t._isLayoutNode("layout-horizontal")?this.withTransactionUpdate(function(){this._specTreeVisibility=e,t.areAllChildrenVisibleInSpecTree()===!e&&t.isVisibleInSpecTree()===!e&&t.setVisibilityInSpecTree(e),this.notifyModelUpdate()}):this.withTransactionUpdate(function(){this._specTreeVisibility=e,this.notifyModelUpdate()})}},areAllChildrenVisibleInSpecTree:function(){var e=!0;if(this.hasChildren())for(var t=this.getChildren(),o=0;o<t.length&&e;o++)!1===t[o].isVisibleInSpecTree()&&(e=!1);return e},isUIActive:function(e){return void 0!==this._isUIActive&&this._isUIActive},_setUIActive:function(e){this._isUIActive=e},_getIsActivePath:function(){return void 0!==this._isActivePath&&this._isActivePath},_setIsActivePath:function(e){this._isActivePath=e},_suppress:function(){!1===this._isSuppressed()&&(this.__isSuppressed=!0,this.notifyModelUpdate())},_isSuppressed:function(){return void 0!==this.__isSuppressed&&this.__isSuppressed},_unsuppress:function(){!0===this._isSuppressed()&&(this.__isSuppressed=!1,this.notifyModelUpdate())},_afterRollbackCursor:function(e){!1===this._isAfterRollbackCursor()&&(this.__isAfterRollbackCursor=!0,e&&this.notifyModelUpdate())},_beforeRollbackCursor:function(e){!0===this._isAfterRollbackCursor()&&(this.__isAfterRollbackCursor=!1,e&&this.notifyModelUpdate())},_isAfterRollbackCursor:function(){return void 0!==this.__isAfterRollbackCursor&&this.__isAfterRollbackCursor},isRollbackContainer:function(){return this.__private__.rollbackContainer},setAsRollbackContainer:function(e,t){this.__private__.rollbackContainer!==e&&(this.__private__.rollbackContainer=e,t&&this.notifyModelUpdate())},matchSearch:function(e){return this._isMatchingSearchFocused=e,this._parent()},unmatchSearch:function(){return this._isMatchingSearchFocused=!1,this._parent()},notifyUIActiveChange:function(e){var t=this._getNodeInfos();e&&(t.attributes=e),this._modelEvents.publish({event:"uiActiveChange",data:t,context:this})}}),r=t.extend({defaultOptions:{useAsyncPreExpand:!0,shouldBeSelected:function(e){return e._getNodeCategory()===this._specTreeVlt.NODE_CATEGORIES.MODEL||(e._getNodeCategory()===this._specTreeVlt.NODE_CATEGORIES.FAKE||e._getNodeCategory()===this._specTreeVlt.NODE_CATEGORIES.LAYOUT&&"layout-horizontal"===e._getNodeType())},shouldBeEditable:function(e){if(e){var t=e.getResolvedAndCall("shouldBeEditable");if(void 0!==t)return t}return!0},shouldAcceptDrag:function(e){return!("function"!=typeof e._isDraggable||!e._isDraggable())&&(this._dropInfosStack={},!0)},shouldAcceptDrop:function(e,t,o){var i=e.parentTreeNodeModel,n=e.dropNode,s=e.dropPosition;if(i&&n&&s){var r=n._getID();this._dropInfosStack&&this._dropInfosStack.hasOwnProperty(r)&&this._dropInfosStack[r].hasOwnProperty(s)?t(this._dropInfosStack[r][s]):"function"==typeof i._shouldAcceptDrop?(this._dropInfosStack&&(this._dropInfosStack.hasOwnProperty(r)||(this._dropInfosStack[r]={}),this._dropInfosStack[r][s]=null),this._latestAcceptDropRequired={node:i,dropInfos:e},i._shouldAcceptDrop(e,function(o){this._dropInfosStack&&this._dropInfosStack.hasOwnProperty(r)&&(this._dropInfosStack[r][s]=o),this._latestAcceptDropRequired.node===i&&this._latestAcceptDropRequired.dropInfos===e&&t(o)}.bind(this),o)):o()}else o()},nodeModelClass:s},cleanDropInfosStack:function(){this.options&&this.options._dropInfosStack&&(this.options._dropInfosStack={})},init:function(t){this._parent(t),this._handleEvents(),this._currentApplication=null,this._listOfUIActiveNodes=[],this._secondaryActivecontainerPathNodes=[],this._specTreeVlt=new e,this._registerDefaultNodes(),this._manageResolvedCallbacks()},getVault:function(){return this._specTreeVlt},setVault:function(e){this._specTreeVlt=e},_isInSecondaryActiveContainerPath:function(e){return this._secondaryActivecontainerPathNodes.indexOf(e)>-1},_setSecondaryActiveContainerPath:function(e){this._secondaryActivecontainerPathNodes=e},usesAsyncDndCallbacks:function(){return!0},_manageResolvedCallbacks:function(){this.onPreExpand(function(e){var t=e.target;setTimeout(function(){var e=t._getResolved().onPreExpand;e?e({nodeModel:t}):t.preExpandDone()},0)});var e=this.getXSO();e.onAdd(function(e){var t=e._getResolved().onSelect;t&&t({nodeModel:e})}),e.onRemove(function(e){var t=e._getResolved().onUnselect;t&&t({nodeModel:e})});var t=this.getPXSO();t.onAdd(function(e){var t=e._getResolved().onPreSelect;t&&t({nodeModel:e})}),t.onRemove(function(e){var t=e._getResolved().onPreUnselect;t&&t({nodeModel:e})})},_registerDefaultNodes:function(){!1===this._specTreeVlt.doesNodeTypeExist({application:this.getCurrentApplication(),nodeCategory:this._specTreeVlt.NODE_CATEGORIES.FAKE,nodeType:"section"})&&this._specTreeVlt.registerFakeNodeType({icons:[{iconName:"expand-right"}],nodeType:"section",buildIcons:function(e){return e.nodeModel.options.icons},buildLabel:function(e){return e.nodeModel.options.label},buildBadges:function(){},onPreExpand:function(e){e.nodeModel.preExpandDone()}}),!1===this._specTreeVlt.doesNodeTypeExist({application:this.getCurrentApplication(),nodeCategory:this._specTreeVlt.NODE_CATEGORIES.FAKE,nodeType:"more/less"})&&this._specTreeVlt.registerFakeNodeType({icons:[],nodeType:"more/less",buildIcons:function(e){return e.nodeModel.isExpanded()?[{iconName:"minus"}]:[{iconName:"plus"}]},buildLabel:function(e){return(e.nodeModel.isExpanded()?"less on":"more on")+" "+e.nodeModel.getParent().options.label},buildBadges:function(){},onPreExpand:function(e){e.nodeModel.preExpandDone()}}),!1===this._specTreeVlt.doesNodeTypeExist({application:this.getCurrentApplication(),nodeCategory:this._specTreeVlt.NODE_CATEGORIES.LAYOUT,nodeType:"layout-horizontal"})&&this._specTreeVlt.registerLayoutNodeType({icons:[{iconName:"folder"}],nodeType:"layout-horizontal",buildIcons:function(){return[]},buildLabel:function(){return""},buildBadges:function(){},onPreExpand:function(e){e.nodeModel.preExpandDone()}}),!1===this._specTreeVlt.doesNodeTypeExist({application:this.getCurrentApplication(),nodeCategory:this._specTreeVlt.NODE_CATEGORIES.LAYOUT,nodeType:"rollbackable-children"})&&this._specTreeVlt.registerLayoutNodeType({icons:[{iconName:"folder"}],nodeType:"rollbackable-children",buildIcons:function(){return[]},buildLabel:function(){},buildBadges:function(){},onPreExpand:function(e){e.nodeModel.preExpandDone()}})},setCurrentApplication:function(e){this._currentApplication=e},getCurrentApplication:function(){return this._currentApplication&&""!==this._currentApplication?this._currentApplication:this._specTreeVlt.DEFAULT_APP_NS},_handleEvents:function(){},onPreExpand:function(e){var t=this;this._parent(function(o){t.prepareUpdate(),o.target.search({match:function(e){return e.nodeModel.options.isFeature}}).forEach(function(e){e.remove()}),e.call(this,o),t.pushUpdate()})},createModelNode:function(e){if(!e.nodeType)throw"A model node must have a nodeType";var t=["","","","#57B847","#00B8DE","#EA4F37"];return e.biColor=t[Math.floor(Math.random()*t.length)],n(this._specTreeVlt,this._specTreeVlt.NODE_CATEGORIES.MODEL,e)},createFakeNode:function(e){return n(this._specTreeVlt,this._specTreeVlt.NODE_CATEGORIES.FAKE,e)},_createLayoutNode:function(e){return n(this._specTreeVlt,this._specTreeVlt.NODE_CATEGORIES.LAYOUT,{nodeType:e.nodeType})},createSubNodes:function(e){var t=this,o=this._createLayoutNode({nodeType:"layout-horizontal"}),i=[];return e.forEach(function(e){var o;if((o=e instanceof s?e:t.createModelNode(e)).hasChildren())throw"A sub-node cannot have children";i.push(o)}),o.addChild(i),o.expand(),o},createRollbackableNodes:function(e){var t=this,o=this._createLayoutNode({nodeType:"rollbackable-children"}),i=[];return e.forEach(function(e){var o;if((o=e instanceof s?e:t.createModelNode(e)).hasChildren())throw"A sub-node cannot have children";i.push(o)}),o.addChild(i),o.expand(),o},isNodeUIActive:function(e){return!!this._uiActiveNode&&this._uiActiveNode._getID()===e._getID()},unsetUIActiveNode:function(){for(;this._listOfUIActiveNodes[0];)this._listOfUIActiveNodes[0]._setUIActive(!1),this._listOfUIActiveNodes.shift();this._uiActiveNode=null,this._getTrueRoot()._modelEvents.publish({event:"uiActiveUpdate",context:this})},getUIActiveNode:function(){return this._uiActiveNode},setUIActiveNode:function(e){for(var t=this;this._listOfUIActiveNodes[0];)this._listOfUIActiveNodes[0]._setUIActive(!1),this._listOfUIActiveNodes[0].notifyUIActiveChange(),this._listOfUIActiveNodes.shift();this._uiActiveNode&&this._uiActiveNode.notifyModelUpdate(),this._uiActiveNode=e,e._setUIActive(!0),e.notifyModelUpdate(),this._listOfUIActiveNodes.push(e),e.processDescendants({processNode:function(e){e.nodeModel._setUIActive(!0),e.nodeModel.notifyUIActiveChange(),t._listOfUIActiveNodes.push(e.nodeModel)}}),t._getTrueRoot()._modelEvents.publish({event:"uiActiveUpdate",context:t})},registerLayoutNodeType:function(e){return this.getVault().registerLayoutNodeType(e)},registerFakeNodeType:function(e){return this.getVault().registerFakeNodeType(e)},registerModelNodeType:function(e){return this.getVault().registerModelNodeType(e)},getNotificationInfos:function(e){return this.getVault().getNotificationInfos(e)}});return r.DEFAULT_APP_NS=i,r._buildSpecTreeDocumentFromSearchResult=function(e){var t=new r({shouldBeEditable:function(){return!1}});return t.prepareUpdate(),e.searchResults.forEach(function(e){var o={};for(var i in e.options)"children"!==i&&(o[i]=e.options[i]);o._originalID=e._getID(),o.path=e.getPath();var n=new s(o);n._setNodeCategory(e._getNodeCategory()),n._setNodeType(e._getNodeType()),t.addChild(n)}),t.pushUpdate(),t},r}),define("DS/SpecTree/SpecTreeView",["DS/Tree/TreeListView","DS/SpecTree/SpecTreeDocument","DS/Tree/Manager","DS/TreeModel/TreeNodeModel","DS/Tree/TreeNodeView","DS/TreeModel/ModelUtils","DS/Core/PointerEvents","DS/Controls/Button","DS/Controls/Abstract","DS/Controls/TooltipModel","DS/Utilities/Dom","DS/Utilities/Utils","DS/TreeModel/TreeDocument","DS/SpecTree/SpecTreeFilter","DS/Controls/Toolbar","DS/Controls/Breadcrumb","DS/Utilities/TouchUtils","i18n!DS/SpecTree/assets/nls/view.json"],function(e,t,o,i,n,s,r,a,l,d,c,u,h,p,g,_,f,v){"use strict";var m={NOTIFICATION_COLOR:{text:"notification",dataIndex:"notification_color",isEditable:!1,isHidden:!1,isStatic:!0,icon:{fontIconFamily:WUXManagedFontIcons.FontAwesome,iconName:"exclamation-circle"},width:2,onCellRequest:function(e){e.cellView.reuseCellContent("__notificationcolor__").style.backgroundColor=e.manager.getDocument()._specTreeVlt.getNotificationInfos([e.nodeModel.getNotification()]).color}},SELECTION:{text:"",dataIndex:"selection",isStatic:!0,width:20,onCellRequest:function(e){e.cellView.reuseCellContent("_specTreeSelection")}},TREE:{dataIndex:"tree",isSortable:!1,isEditable:!0,setValue:function(e){if(void 0!==e.value&&""!==e.value){var t=e.nodeModel;t.prepareUpdate(),t.updateOptions({label:e.value}),t._getResolvedAndCall("onEditLabel",function(t){t.nodeModel.updateOptions({label:e.value})}),e.cellView._saveChanges(),t.pushUpdate()}else e.cellView._cancelChanges()}},COLOR:{icon:{iconName:"palette"},headerTooltip:v.tooltip_columnColor,dataIndex:"color",isEditable:!1,isHidden:!1,isStatic:!0,width:20,onCellRequest:function(e){var t=e.nodeModel;t._isSubnode()||t._getNodeCategory()===e.manager.getDocument()._specTreeVlt.NODE_CATEGORIES.FAKE||t._getNodeCategory()===e.manager.getDocument()._specTreeVlt.NODE_CATEGORIES.LAYOUT?e.cellView.getContent().empty():e.cellView.reuseCellContent("__color__").style.backgroundColor=t.getColor()}},BORDER_COLOR:{text:"",dataIndex:"borderColor",isEditable:!1,isHidden:!1,isStatic:!0,width:4,onCellRequest:function(e){var t=e.nodeModel;t._isSubnode()||t._getNodeCategory()===e.manager.getDocument()._specTreeVlt.NODE_CATEGORIES.FAKE||t._getNodeCategory()===e.manager.getDocument()._specTreeVlt.NODE_CATEGORIES.LAYOUT?e.cellView.getContent().empty():e.cellView.reuseCellContent("__bordercolor__").style.backgroundColor=t.getBorderColor()}},NOTIFICATION_ICON:{text:"notification_icon",icon:{fontIconFamily:WUXManagedFontIcons.FontAwesome,iconName:"exclamation-circle"},headerTooltip:v.tooltip_columnNotificationIcon,dataIndex:"notification_icon",isEditable:!1,width:20,isStatic:!0,isHidden:!1,onCellRequest:function(e){var t=e.manager.getDocument()._specTreeVlt.getNotificationInfos(e.nodeModel.getNotification()),o=c.generateIcon(t.icon);o?(o.style.color=t.color,o.tooltipInfos=new d({title:v[e.nodeModel.getNotification()],shortHelp:e.nodeModel.getNotificationMsg()}),e.cellView.getContent().setContent(o)):e.cellView.getContent().innerText=""}},HIDE_SHOW:{text:"visibility",icon:{fontIconFamily:WUXManagedFontIcons.Font3DS,iconName:"eye-off"},headerTooltip:v.tooltip_columnVisibility,dataIndex:"visibility",isEditable:!1,isStatic:!0,isHidden:!1,width:26,onCellRequest:function(e){e.cellView.getContent().empty();var t=e.cellView.reuseCellContent("__visibility__"),o=e.nodeModel.isVisibleInSpecTree();t._reflectValue(o),t.value=o,e.cellView.getContent().setStyle("text-align","left")}},ACTION:{text:"action",dataIndex:"action",isEditable:!1,width:20,isStatic:!0,isHidden:!1,onCellRequest:function(e){e.cellView.reuseCellContent("__action__")}}};var b=l.inherit({publishedProperties:{value:{defaultValue:!0,type:"boolean"},map:{defaultValue:!0,type:"object"}},_mouseEnterCb:function(e){this._reflectPreviewValue(!this.value)},_mouseLeaveCb:function(e){this._reflectValue(this.value)},_preBuildView:function(){this.elements.container=new UWA.Element("div",{class:"wux-cell-icon"});var e=this;c.addEventOnElement(this,this.elements.container,"mouseenter",function(t){e._mouseEnterCb(t)}),c.addEventOnElement(this,this.elements.container,"mouseleave",function(t){e._mouseLeaveCb(t)}),void 0===window.jasmine||window.WEBUX_DO_NOT_TEST_SPECTREEVIEW||setTimeout(function(){e.getContent().getParent()&&new UWA.Element("div",{html:"DO NOT TEST THE VIEW PLEASE",styles:{background:"red",color:"white",height:"100%",width:"100%",position:"absolute",top:0,bottom:0,left:0,right:0,zIndex:5e6}}).inject(e.elements.container)},1e3)},_applyProperties:function(e){this._applyValue(),this._parent(e)},_applyValue:function(){this._applyMap()},_applyMap:function(){this.getContent().setContent(c.generateIcon(this.map[this.value].value))},_reflectPreviewValue:function(e){this.getContent().setContent(c.generateIcon(this.map[e].valuePreview))},_reflectValue:function(e){this.getContent().setContent(c.generateIcon(this.map[e].value))}}),C=n.extend({init:function(e){this._parent(e),this.elements.badgeTopRight.classList.add("wux-layouts-spectreeview-badge"),this.elements.badgeTopLeft.classList.add("wux-layouts-spectreeview-badge"),this.elements.badgeBottomRight.classList.add("wux-layouts-spectreeview-badge"),this.elements.badgeBottomLeft.classList.add("wux-layouts-spectreeview-badge"),this.elements.badgeTopRight.classList.add("wux-layouts-spectreeview-badge-top-right"),this.elements.badgeTopLeft.classList.add("wux-layouts-spectreeview-badge-top-left"),this.elements.badgeBottomRight.classList.add("wux-layouts-spectreeview-badge-bottom-right"),this.elements.badgeBottomLeft.classList.add("wux-layouts-spectreeview-badge-bottom-left")},debouncedUpdateInternalParameters:function(){var e=this.getCellInfos(),t=e.nodeModel;e.virtualRowID>-1&&(this.getContent().setAttribute("node-category",t._getNodeCategory()),this.getContent().setAttribute("node-type",t._getNodeType()),this.getContent().setAttribute("node-notification",t.getNotification()),this.getContent().setAttribute("node-is-hidden",!t.isVisibleInSpecTree()),t.isMatchingSearch()?this.getContent().setAttribute("match-search",t._isMatchingSearchFocused):this.getContent().removeAttribute("match-search"))},_isSubNode:function(e){var t=this.getCellInfos(),o=t.nodeModel;return!!(t.virtualRowID>-1&&o&&o.getParent()&&o.getParent()._isLayoutNode(e))},_manageHoverBarButton:function(){var e=this.getCellInfos();if(e&&"object"==typeof e.nodeModel){var t=e.nodeModel._getNodeCategory(),o=e.nodeModel._getNodeType(),i=!1,n=e.manager.getDocument().getVault().getRegisteredNodeType(t,o);if(n&&n.buildHoverBar){var s=[],a=n.buildHoverBar({nodeModel:e.nodeModel,hoverBarModel:UWA.clone(s)});(Array.isArray(a)&&a.length||Array.isArray(s)&&s.length)&&(i=!0,this.elements.hoverbarDotMenu?this.elements.hoverbarDotMenu.inject(this.elements.nodeContainer):(this.elements.hoverbarDotMenu=new UWA.Element("div",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-menu-dot wux-spectree-hoverbar-button"}).inject(this.elements.nodeContainer),this.elements.hoverbarDotMenu.addEvent("click",function(e){this.getCellInfos().manager._showHoverBar(this.getCellModel().getCellContent())}.bind(this)),this.elements.hoverbarDotMenu.addEvent(r.POINTERHIT,function(e){e.stopPropagation()})))}!i&&this.elements.hoverbarDotMenu&&this.elements.hoverbarDotMenu.remove()}},updateInternalParameters:function(){var e=this.getCellInfos();this._parent(),this._isSubNode()?(this.getContent().removeAttribute("is-hidden"),this.getContent().setAttribute("is-subnode",e.nodeModel.getParent()._getNodeType())):this.getContent().removeAttribute("is-subnode"),e.isHeader||(this._manageHoverBarButton(),this.getContent().setAttribute("node-is-uiactive",e.nodeModel.isUIActive()),e.nodeModel._isInWorkNode?this.getContent().setAttribute("node-is-inwork",!0):this.getContent().removeAttribute("node-is-inwork"),this.getContent().setAttribute("node-is-inwork-path",e.nodeModel._getIsActivePath()),e.nodeModel._isAfterRollbackCursor()?this.getContent().setAttribute("node-is-after-rollback-cursor",!0):this.getContent().setAttribute("node-is-after-rollback-cursor",!1),this.getContent().setAttribute("inactiveState",e.nodeModel.getInactiveState())),this.debouncedUpdateInternalParameters()},unsetBadges:function(){this.elements.badgeTopLeft.style.backgroundImage="",this.elements.badgeTopLeft.style.visibility="hidden",this.elements.badgeTopLeft.className="",this.elements.badgeTopLeft.addClassName("wux-layouts-treeview-badge wux-layouts-spectreeview-badge wux-layouts-treeview-badge-top-left wux-layouts-spectreeview-badge-top-left"),this.elements.badgeBottomLeft.style.backgroundImage="",this.elements.badgeBottomLeft.style.visibility="hidden",this.elements.badgeBottomLeft.className="",this.elements.badgeBottomLeft.addClassName("wux-layouts-treeview-badge wux-layouts-spectreeview-badge wux-layouts-treeview-badge-bottom-left wux-layouts-spectreeview-badge-bottom-left"),this.elements.badgeTopRight.style.backgroundImage="",this.elements.badgeTopRight.style.visibility="hidden",this.elements.badgeTopRight.className="",this.elements.badgeTopRight.addClassName("wux-layouts-treeview-badge wux-layouts-spectreeview-badge wux-layouts-treeview-badge-top-right wux-layouts-spectreeview-badge-top-right"),this.elements.badgeBottomRight.style.backgroundImage="",this.elements.badgeBottomRight.style.visibility="hidden",this.elements.badgeBottomRight.className="",this.elements.badgeBottomRight.addClassName("wux-layouts-treeview-badge wux-layouts-spectreeview-badge wux-layouts-treeview-badge-bottom-right wux-layouts-spectreeview-badge-bottom-right")},addIcon:function(e,t){void 0===t&&("element"===UWA.typeOf(e)?new UWA.Element("div",{class:"wux-layouts-treeview-icon",html:e,styles:{display:"inline-block"}}).inject(this.elements.iconsContainer):this._parent(e,t))},_getRelativeIncrementFactor:function(e){var t=this.getCellInfos(),o=t.nodeModel.getParents();return t.manager._getRelativeIncrementFactorForNode(o[e])},_setDepth:function(e){var t=this.getCellInfos();t.nodeModel.getParent()._isLayoutNode("layout-horizontal")&&"tree"===t.dataIndex?(this.elements.linksContainer.setStyle("width",0),this.elements.nodeContainer.setStyle("left",0)):this._parent(e)},_getSubNodeCellWidth:function(){var e=this.getCellInfos().manager;return Math.min(45,e.getColumnWidth("tree")/4)},getPosition:function(){var e=this.getCellInfos(),t=e.nodeModel,o=e.manager;return this._isSubNode("layout-horizontal")?{top:o.getRowPosition(e.nodeModel.getParent()._getRowID()),left:o._getAbsoluteIncrementFactorForNode(e.nodeModel)+20+o.getColumnPosition("tree")+this._getSubNodeCellWidth()*t._getLocalID()}:this._parent()},getDimensions:function(){var e=this.getCellInfos().manager;return this._isSubNode("layout-horizontal")?{width:this._getSubNodeCellWidth(),height:e.options.defaultCellHeight}:this._parent()}}),y=o.extend({init:function(e,t){this._parent(e,t),this._manageActiveNode()},getDocumentOwner:function(){return this._getDocumentOwner()},_getDocumentOwner:function(){var e=document;return this.getContent()&&this.getContent().ownerDocument&&(e=this.getContent().ownerDocument),e},_manageKeyboard:function(){this._parent()},loadDocument:function(e){if(this._parent(e),e){var t=e.getFilterManager();t&&t.registerFilter("SpecTreeFilter",p)}this._manageUIActiveArea()},_updateBreadCrumb:function(e,t){var o=[];t.forEach(function(e){var t,i=e.getIcons();i&&i.length>0&&(t=i[0]),o.push({label:e.getLabel(),icon:t,node:e})}),e.value=o},_reflectNewActiveNode:function(){var e=this,t=e.getActiveNode(),o=e._getCellViewDom(-1,"tree");if(t&&o){var i=o.dsView.reuseCellContent("__breadcrumb__");i._lock=!0,e._updateBreadCrumb(i,t.getPath().filter(function(t){switch(t._getNodeCategory()){case e.getDocument()._specTreeVlt.NODE_CATEGORIES.FAKE:return"more/less"!==t._getNodeType();default:return!0}})),i._lock=!1}},_manageActiveNode:function(){var e=u.throttle(this._reflectNewActiveNode,100).bind(this);this._modelEvents.subscribe({event:"active"},this._reflectNewActiveNode.bind(this)),this.onGridResize(e)},isUIActiveAreaEnabled:function(){return!!this._uiActiveAreaBGEnabled&&this._uiActiveAreaBGEnabled},_manageUIActiveArea:function(){var e=this;this._uiActiveAreaBGEnabled=!1,this._uiActiveAreaBG=null;var t=u.debounce(this._updateUIActiveArea.bind(this),20);this._bindJSEventOnDocument(this.getContent(),r.POINTERHIT,function(t,o){if(2===t.multipleHitCount){e.getDocument();o&&!1===o.isHeader&&"tree"===o.dataIndex&&o.nodeModel._getResolvedAndCall("onEdit")}}),this._bindEventOnDocument("uiActiveUpdate",function(o){e.updateView(),t()}),this._bindEventOnDocument("modelUpdate",function(e){e.options.updateType&&(e.options.updateType&WUXModelUpdateTypes.Addition||e.options.updateType&WUXModelUpdateTypes.Removal||e.options.updateType&WUXModelUpdateTypes.Expand||e.options.updateType&WUXModelUpdateTypes.VisibilityChange||e.options.updateType&WUXModelUpdateTypes.Filtering)&&t()}),this._bindEventOnDocument("uiActiveChange",function(t){var o=t.data.nodeModel;if(o){var i=e.getCell(o._getRowID(),"tree");if(i){var n=i.getView();n&&n.elements.container.setAttribute("node-is-uiactive",t.data.nodeModel.isUIActive())}}})},_updateUIActiveArea:function(e){var t=this,o=t.getDocument(),i=o.getUIActiveNode();if(i){t.getContent().addClassName("wux-ui-state-uiactive-mode");var n,s=i._getRowID();this._activeSupportRollbackNode=void 0,this._lockRollbackbar=!1;for(var a=function(e){if("collapsed"===e.getState())return e;var t=e.getChildren();return t&&t.length>0?a(t[t.length-1]):e},l=a(i);l&&l.hasNoRepresentation();){var d=l.getPreviousVisibleNode();if(!d||l===d)break;l=d}var c=l._getRowID();t._inWorkPath&&t._inWorkPath.forEach(function(e){e._setIsActivePath(!1);var o=t.getCell(e._getRowID(),"tree");if(o){var i=o.getView();i&&i.elements.container.setAttribute("node-is-inwork-path",e._getIsActivePath())}}),t._inWorkPath=[];var u=i.getResolvedAndCall("getRollbackInfos");if(void 0!==u){if(u&&u.rollbackContainer&&(this._activeSupportRollbackNode=u.rollbackContainer,u.rollbackNode)){(n=u.rollbackNode)._beforeRollbackCursor(!0);var h=n.getTreeDocument();h._inWorkNode&&h._inWorkNode!==n&&(h._inWorkNode._isInWorkNode=!1,h._inWorkNode.notifyModelUpdate()),h._inWorkNode=n,n._isInWorkNode=!0,h._inWorkNode.notifyModelUpdate()}}else{var p=[];i.processDescendants({onlyVisibleNodes:!0,treeTraversalOrder:"preOrder",processNode:function(e){var t=e.nodeModel;t&&!t.hasNoRepresentation()&&(p.push(t),n||this._activeSupportRollbackNode||"function"!=typeof t.isActive||!t.isActive()||("function"==typeof t.supportsRollback&&t.supportsRollback()?this._activeSupportRollbackNode=t:"function"==typeof t.isRollbackable&&t.isRollbackable()?(this._activeSupportRollbackNode||(this._activeSupportRollbackNode=t.getParent()),n=t):(this._activeSupportRollbackNode=t,this._lockRollbackbar=!0)),t._beforeRollbackCursor(!0))}.bind(this)})}var g=t.getRowPosition(s),_=t.getRowPosition(c)-t.getRowPosition(s)+t.getRowHeight(c);t._uiActiveAreaBG||(t._uiActiveAreaBG=new UWA.Element("div",{class:"wux-spectree-uiactive-area-bg"}),t._uiActiveAreaBG.inject(t.elements.poolContainerRel)),t._uiActiveAreaFG||(t._uiActiveAreaFG=new UWA.Element("div",{class:"wux-spectree-uiactive-area-fg"}),t._uiActiveAreaFG.inject(t.elements.poolContainerRel)),t._uiActiveAreaFG.setStyles({display:"block",top:g,left:0,right:0,height:_}),t._uiActiveAreaBG.setStyles({display:"block",top:g,left:0,right:0,height:_});if(this._activeSupportRollbackNode){t._inWorkPath=[];for(var f=this._activeSupportRollbackNode,v=this._getTrueRoot();f!=v;){f._setIsActivePath(!0);var m=t.getCell(f._getRowID(),"tree");if(m){var b=m.getView();b&&b.elements.container.setAttribute("node-is-inwork-path",f._getIsActivePath())}t._inWorkPath.push(f),f=f.getParent()}var C=this._activeSupportRollbackNode.getVisibleChildren();if(Array.isArray(C)&&C.length){this._lockRollbackbar=!n;var y,w=C[0];this._firstRollbackableChild=void 0,this._lastRollbackableChild=void 0;for(var T,N,S,D=n;D&&(!D.isVisible()||D.hasNoRepresentation());)D=D.getParent();if(D&&(o.prepareUpdate(),T=D._getRowID()),this._activeSupportRollbackNode.processDescendants({onlyVisibleNodes:!0,treeTraversalOrder:"preOrder",processNode:function(e){var t=e.nodeModel;t&&!t.hasNoRepresentation()&&(D&&(e.virtualRowID<=T?t._beforeRollbackCursor(!0):t._afterRollbackCursor(!0)),this._firstRollbackableChild||(this._firstRollbackableChild=t),this._lastRollbackableChild=t,y=t)}.bind(this)}),D&&o.pushUpdate(),this._firstRollbackableChild&&(this._minLocalCursorPosition=t.getRowPosition(this._firstRollbackableChild._getRowID())),this._lastRollbackableChild&&(this._maxLocalCursorPosition=t.getRowPosition(this._lastRollbackableChild._getRowID())),!t._rollbackSlider){var R,A;t._rollbackSlider=new UWA.Element("div",{class:"wux-spectree-rollback-slider"}),t._rollbackSliderRail=new UWA.Element("div",{class:"wux-spectree-rollback-slider-rail"}).inject(t._rollbackSlider),t._rollbackSliderBar=new UWA.Element("div",{class:"wux-spectree-rollback-slider-bar"}).inject(t._rollbackSliderRail),t._rollbackSliderCursor=new UWA.Element("div",{class:"wux-spectree-rollback-slider-cursor"}).inject(t._rollbackSliderRail);var I=!1,E=function(e){var o=t.getDocument();o&&R&&(o.prepareUpdate(),this._activeSupportRollbackNode.processDescendants({onlyVisibleNodes:!0,treeTraversalOrder:"postOrder",processNode:function(e){var t=e.nodeModel;t&&!t.hasNoRepresentation()&&(e.virtualRowID<=R.rowID?t._beforeRollbackCursor(!0):R.rowID<=this._lastRollbackableChild._getRowID()&&t._afterRollbackCursor(!0))}.bind(this)}),o.pushUpdate())}.bind(this);t.getContent().addEvent(r.POINTERMOVE,function(e){if(R=t._getCoordinatesFromEvent(e),void 0!==window.jasmine&&e.sliderCellInfos&&(R=e.sliderCellInfos),I){R.rowID<this._firstRollbackableChild._getRowID()?R.rowID=this._firstRollbackableChild._getRowID():R.rowID>this._lastRollbackableChild._getRowID()&&(R.rowID=this._lastRollbackableChild._getRowID()),A=t.getTreeNodeModelFromRowID(R.rowID);var o=this._getDocumentOwner();"function"==typeof A.isRollbackable&&A.isRollbackable()?o.body.style.cursor="default":o.body.style.cursor="not-allowed"}else{(o=this._getDocumentOwner()).body.style.cursor="default"}}.bind(this));var M=function(e){if(I){var o=t.getRowHeight(R.rowID)/2,i=function(e,t){var o=(t=t||e.target||e.srcElement).currentStyle||window.getComputedStyle(t,null),i=parseInt(o.borderLeftWidth,10),n=parseInt(o.borderTopWidth,10),s=t.getBoundingClientRect();return{offsetX:e.clientX-i-s.left,offsetY:e.clientY-n-s.top}}(e,t._rollbackSlider),n=this._minLocalCursorPosition+(i.offsetY-o+2);n>this._maxLocalCursorPosition&&(n=this._maxLocalCursorPosition+2),n<this._minLocalCursorPosition&&(n=this._minLocalCursorPosition+2),t._rollbackSliderBar.setStyles({height:n-this._minLocalCursorPosition}),t._rollbackSliderCursor.setStyles({top:n-this._minLocalCursorPosition}),E(e)}}.bind(this),k=function(e){I=!1;var o=this._getDocumentOwner();o.removeEventListener(r.POINTERMOVE,M),o.removeEventListener(r.POINTERUP,k),(A=t.getTreeNodeModelFromRowID(R.rowID)).defineAsRollbackedNode(),t.unlockUI()}.bind(this);t._rollbackSlider.addEvent(r.POINTERDOWN,function(e){if(e.preventDefault(),!this._lockRollbackbar){I=!0;var o=this._getDocumentOwner();o.addEventListener(r.POINTERMOVE,M),o.addEventListener(r.POINTERUP,k),t.lockUI()}}.bind(this)),t._rollbackSlider.inject(t.elements.poolContainerRel),t._rollbackSlider.addEventListener("dragstart",function(e){return e.preventDefault(),e.stopPropagation(),!1})}this._lockRollbackbar?(S=w,N=t.getRowPosition(y._getRowID())+t.getRowHeight(y._getRowID())-t.getRowPosition(w._getRowID())):(S=this._firstRollbackableChild,N=t.getRowPosition(this._lastRollbackableChild._getRowID())+t.getRowHeight(this._lastRollbackableChild._getRowID())-t.getRowPosition(this._firstRollbackableChild._getRowID()));var P=14;if(this._activeSupportRollbackNode.hasNoRepresentation()&&(P+=t._getRelativeIncrementFactorForNode(this._activeSupportRollbackNode)),t._rollbackSlider.setStyles({display:"block",position:"absolute",top:t.getRowPosition(S._getRowID()),left:t._getAbsoluteIncrementFactorForNode(this._activeSupportRollbackNode)+P,height:N-2,zIndex:1e13}),this._lockRollbackbar)t._rollbackSliderBar.setStyles({display:"none"}),t._rollbackSliderCursor.setStyles({display:"none"});else{var O=t.getRowPosition(D._getRowID())-t._minLocalCursorPosition;t._rollbackSliderBar.setStyles({display:"block",height:O+t.getRowHeight(n._getRowID())/2-2}),n.isVisible()?t._rollbackSliderCursor.setStyles({display:"block",height:t.getRowHeight(n._getRowID())-4,top:O+2}):t._rollbackSliderCursor.setStyles({display:"none"})}}else t._rollbackSlider&&t._rollbackSlider.setStyles({display:"none"})}else t._rollbackSlider&&t._rollbackSlider.setStyles({display:"none"})}else for(var F in t.getContent().removeClassName("wux-ui-state-uiactive-mode"),t._rollbackSlider&&t._rollbackSlider.hide(),t._uiActiveAreaFG&&t._uiActiveAreaFG.hide(),t._uiActiveAreaBG&&t._uiActiveAreaBG.hide(),t._uiInWorkArea&&t._uiInWorkArea.hide(),t._inWorkPath&&(t._inWorkPath=[]),t._listOfInWorkDot)t._listOfInWorkDot[F].destroy(),delete t._listOfInWorkDot[F]},_shoulBeSelected:function(e){var t=this.getDocument();return t.options.shouldBeSelected.call(t,e)},selectRow:function(e,t){this._shoulBeSelected(this.getTreeNodeModelFromRowID(e))&&this._parent(e,t)},_setHeadersDimensions:function(e){this._parent(e),this._getParent().options.enableStaticColumns},_syncRowModelWithTreeNodeModel:function(e){return this.updateCellView(e._getRowID(),-1),this._parent(e)},_doFeaturesNeedToBeDisplayed:function(e){return e.hasFeatures()&&e.isExpanded()},_getAbsoluteIncrementFactorForNode:function(e){for(var t=0,o=e.getParents(),i=0;i<o.length;i++)t+=this._getRelativeIncrementFactorForNode(o[i]);return t},_getRelativeIncrementFactorForNode:function(e){var t;switch(e._getNodeCategory()){case this.getDocument()._specTreeVlt.NODE_CATEGORIES.LAYOUT:t=e._isLayoutNode("rollbackable-children")?20:0;break;case this.getDocument()._specTreeVlt.NODE_CATEGORIES.FAKE:t=20;break;default:if(e.hasNoRepresentation()){for(var o=e;o&&o.hasNoRepresentation();)o=o.getPreviousBrother();t=o&&o._isLayoutNode()?20:0}else t=20}return t},_computeStyleForActiveState:function(e){var t,o,i=e._getRowID();if(t=this.getRowPosition(i),o=this.getRowHeight(i),e._isSubnode("layout-horizontal")){t=this.getRowPosition(e.getParent()._getRowID());var n=this.getColumnIDFromDataIndex("tree"),s=this.elements.container.querySelector('.wux-datagrid-cell[virtual-row-id="'+i+'"][virtual-column-id="'+n+'"]');if(s){var r=s.dsView,a=r.getDimensions();return{top:t,left:r.getPosition().left,height:a.height,width:a.width}}return this._parent(e)}return{top:t,left:0,height:o,right:0}},_indexRowsPosition:function(){},getRowPosition:function(e){var t;if(-1===e)t=this._parent(e);else{this.getTreeNodeModelFromRowID(e);t=this._parent(e)}return t},getRowHeight:function(e){if(-1===e)return this._parent(e);var t=e;return"number"==typeof e&&(t=this.getTreeNodeModelFromRowID(e)),t&&t.getParent()&&t.getParent()._isLayoutNode("layout-horizontal")?0:t&&t._isLayoutNode("rollbackable-children")?0:this._parent(e)},_createDocument:function(e){this._parent(e),this._manageHoverBar()},_manageHoverBar:function(){var e=this;this.elements.poolContainerRel.addEvent("mouseleave",function(){e._mouseCursorOut=!0,e._hideHoverBar(!0)});(this.addEventListener(r.POINTERMOVE,function(e,t){if(void 0!==window.jasmine&&e.cellInfos&&(t=e.cellInfos),t&&t.cellView&&t.cellView.elements.hoverbarDotMenu&&t.cellView.elements.hoverbarDotMenu.isHidden()){t.cellView.elements.hoverbarDotMenu.addClassName("wux-spectree-hoverbar-button-display");var o=function(){t&&(t.cellView.elements.hoverbarDotMenu.removeClassName("wux-spectree-hoverbar-button-display"),t.cellView.elements.container.removeEvent("mouseleave",o))};t.cellView.elements.container.addEvent("mouseleave",o)}}),this.addEventListener("mouseenter",function(){!0,e._mouseCursorOut=!1}),this._treeDocument)&&this._treeDocument.getXSO().onPostRemove(function(t){e._hideHoverBar()})},_hideHoverBar:function(e){this.elements.hoverbarContainer&&(e?setTimeout(function(){this._mouseCursorOut&&this.elements.hoverbarContainer.setAttribute("visibility","false")}.bind(this),1e3):this.elements.hoverbarContainer.setAttribute("visibility","false"))},_showHoverBar:function(e){if(void 0===this.elements.hoverbarContainer){var t=function(e){e.stopPropagation()};this.elements.hoverbarContainer=new UWA.Element("div",{class:"wux-spectree-hoverbar",events:{mousedown:t,touchstart:t,mouseup:t,touchend:t}}),this.elements.hoverbarContainerRel=new UWA.Element("div",{class:"wux-spectree-hoverbar-rel"}).inject(this.elements.hoverbarContainer),this.elements.hoverbarContainerBlurMask=new UWA.Element("div",{class:"wux-spectree-hoverbar-blur"}).inject(this.elements.hoverbarContainerRel),this.elements.hoverbarContainer.inject(this.elements.poolContainerRel),this.elements.hoverbarToolbar=new g({overflowManagement:"dropdown",direction:"horizontal",adaptSizeToParent:!0}).inject(this.elements.hoverbarContainerRel)}else this.elements.hoverbarToolbar.clear();var o=e._getRowID();this.elements.hoverbarContainer.setStyles({top:this.getRowPosition(o),height:this.getRowHeight(o),right:0});var i=this;if(e){var n=this.getDocument(),s=e._getNodeCategory(),r=e._getNodeType(),l=this._getParent().options,d=[],c=[];if(n._specTreeVlt._processNodeType(s,r,l.application,function(t){var o=t.options;o&&o.buildHoverBar&&!e._isSubnode()&&(d=o.buildHoverBar({nodeModel:e,hoverBarModel:UWA.clone(d)}))},"buildHoverBar"),!(d instanceof Array))throw"SpecTree: buildHoverBar does not return an array";d.forEach(function(e){c.push(e)}),c.forEach(function(t){var o=new a({label:"",displayStyle:"icon",icon:t.icon}),n=i.getRowHeight(e)-4;o.getContent().setStyle("min-height",n+"px"),o.getContent().setStyle("min-width",n+4+"px"),o.elements.iconPlaceholder.style.lineHeight=n-4+"px",o.addEventListener("buttonclick",function(o){t.callback&&(i.elements.hoverbarContainer.setStyle("PointerEvents","none"),t.callback({nodeModel:e}),setTimeout(function(){i.elements.hoverbarContainer.setStyle("PointerEvents",""),i._showHoverBar(e)},100))}),i.elements.hoverbarToolbar.add("element",{element:o.getContent(),position:"far"})}),c.length>0?i.elements.hoverbarContainer.setAttribute("visibility","true"):i.elements.hoverbarContainer.setAttribute("visibility","false")}}}),w=e.extend({defaultOptions:{specTreeVault:null,cellClass:C,managerClass:y,application:t.APP_DEFAULT_NS,expanderStyle:"triangle",performances:{renderingMode:"adaptive",numberOfRowsFactor:3,numberOfColumnsFactor:1,buildLinks:!1,preloadPool:!0,resizeDebounceTimeout:200,useRequestAnimationFrameRendering:!0,automaticSizeTreeColumnToFit:!1,minimumScrollDistance:10},apiVersion:2,show:{rowHeaders:!0,columnHeaders:!0},selection:{rowHeaders:!1,preSelection:!0,nodes:!0,canMultiSelect:!0,enableListSelection:!0,toggle:!1,contextMenuSelection:!1},defaultYDistanceOfTopBadgesFromIconCenter:4,defaultYDistanceOfBottomBadgesFromIconCenter:10,changeColorOnFocus:!1,showLinesSeparator:!1,enableExpandOnDoubleClick:!1,enableStaticColumns:!0,isEditable:!0,enableActiveUI:!0,enableKeyboardNavigation:!0,enableTreeColumnEllipsisOverflow:!0,showScrollbarsOnHover:!0,columns:[m.BORDER_COLOR,m.TREE,m.NOTIFICATION_ICON,m.COLOR,m.HIDE_SHOW,m.SELECTION],onDragStartCellDefault:function(e,t){var o=[];t.manager.getNodesXSO().get().concat().sort(function(e,t){return e._getRowID()>t._getRowID()?1:-1}).forEach(function(e){o.push(e._getID()),e._getResolvedAndCall("onDragStart")}),this.serializeDragAndDropEvent(e,{data:{"dswebux/x-tree.treenodemodel+json":o,"dswebux/x-tree.treenodemodel+number":t.nodeModel._getID()}})},onDragEnterCellDefault:function(e,t){var o="middle"===t.dropPosition?t.nodeModel:t.nodeModel.getParent(),i=t.manager.getNodesXSO().get();if(Array.isArray(i)&&i.length)new Promise(function(e,n){var s;if(void 0!==t.rowID&&void 0!==t.columnID){var r=t.manager.getCellModel(t.rowID,t.columnID);r&&(s=r.getCellContent())}t.manager.getDocument().options.shouldAcceptDrop({parentTreeNodeModel:o,draggedNodes:i,dropPosition:t.dropPosition,dropNode:s},e,n)}).then(function(o){o||(e.dataTransfer.dropEffect="none"),t.manager.enableDragOverStateForRow(t.virtualRowID,t.dropPosition)})},onDropBlankDefault:function(e,t){},onDragOverCellDefault:function(e,t){var o="middle"===t.dropPosition?t.nodeModel:t.nodeModel.getParent(),i=t.manager.getNodesXSO().get();if(Array.isArray(i)&&i.length)new Promise(function(e,n){var s;if(void 0!==t.rowID&&void 0!==t.columnID){var r=t.manager.getCellModel(t.rowID,t.columnID);r&&(s=r.getCellContent())}t.manager.getDocument().options.shouldAcceptDrop({parentTreeNodeModel:o,draggedNodes:i,dropPosition:t.dropPosition,dropNode:s},e,n)}).then(function(o){o||(e.dataTransfer.dropEffect="none"),t.manager.setDragOverStateForNode(t.nodeModel,t.dropPosition)})},onDragLeaveCellDefault:function(e,t){var o="middle"===t.dropPosition?t.nodeModel:t.nodeModel.getParent(),i=t.manager.getNodesXSO().get();if(Array.isArray(i)&&i.length)new Promise(function(e,n){var s;if(void 0!==t.rowID&&void 0!==t.columnID){var r=t.manager.getCellModel(t.rowID,t.columnID);r&&(s=r.getCellContent())}t.manager.getDocument().options.shouldAcceptDrop({parentTreeNodeModel:o,draggedNodes:i,dropPosition:t.dropPosition,dropNode:s},e,n)}).then(function(o){o||(e.dataTransfer.dropEffect="none"),t.manager.disableDragOverStateForBlank(),t.manager.disableDragOverStateForRow()})},onContextualEvent:{callback:function(e){if(e&&e.treeview){var t=e.treeview.manager._getParent().options;if(e.treeview.virtualRowID>-1&&e.treeview.virtualColumnID>-1){var o=e.data.event;if(o.stopPropagation(),!0===t.selection.contextMenuSelection){var i=e.treeview.nodeView;"contextmenu"!==o.type&&o.type!==r.LONGHOLD||i._selectionAlgorithm(o,"down")}var n=e.treeview.nodeModel._getNodeCategory(),s=e.treeview.nodeModel._getNodeType(),a=void 0,l=void 0;return e.treeview.manager.getDocument()._specTreeVlt._processNodeType(n,s,t.application,function(t){var o=t.options;o&&o.buildContextualMenu&&(a=o.buildContextualMenu({nodeModel:e.treeview.nodeModel,contextualMenuModel:a}))},"buildContextualMenu"),a||(a=[]),a.forEach(function(e){e.action?(l||(l=[]),l.push(e)):console.error("Contextual menu item has been ignored because it doesn't contain an action callback")}),l}}}}},init:function(e){e.apiVersion=2,e.enableStaticColumns=void 0===e.enableStaticColumns||e.enableStaticColumns,e.show=UWA.extend({rowHeaders:!0,columnHeaders:!0},e.show);var o=this;if(this._hasNotificationIconColumn=!1,e.enableStaticColumns){e.show={rowHeaders:void 0!==e.show.rowHeaders&&e.show.rowHeaders,columnHeaders:void 0!==e.show.columnHeaders&&e.show.columnHeaders},e.staticColumns=[];var i=0,n=e.columns||UWA.clone(this.defaultOptions.columns);n=n.filter(function(t){return t.dataIndex===m.NOTIFICATION_ICON.dataIndex&&(o._hasNotificationIconColumn=!0),!t.isStatic||(i+=t.width,e.staticColumns.push(UWA.clone(t)),!1)}),e.columns=n,e.headersDimensions={width:e.show.rowHeaders?i:0,height:e.show.columnHeaders?40:0}}(e=UWA.extend(UWA.clone(this.defaultOptions),e)).treeDocument=e.treeDocument||new t,this._parent(e);var s=this.getManager();if(this.getContent().addClassName("wux-spectreeview"),this.options.showLinesSeparator?this.elements.container.setAttribute("show-lines-separator","true"):this.elements.container.setAttribute("show-lines-separator","false"),this.options.treeDocument.setCurrentApplication(this.options.application),this._registerReusables(),this.options.enableStaticColumns){0;var r=this.getManager()._reusableCellContentManager.use("__staticcolumns__").component;o.options.staticColumns.forEach(function(e){var t=r.subCells[e.dataIndex];if(o.options.show.columnHeaders)if(e.icon){var i=c.generateIcon(e.icon);c.setContent(t,i),i.tooltipInfos=new d({shortHelp:e.headerTooltip})}else c.setContent(t,e.text)}),r.inject(this.getManager().elements.corner),this.getManager().onColumnHeaderRequest(function(e){"tree"===e.dataIndex&&s._reflectNewActiveNode()}),this.getManager().onRowHeaderRequest(function(e){var t=e.cellView.reuseCellContent("__staticcolumns__");e.nodeModel=s.getTreeNodeModelFromRowID(e.virtualRowID),e.nodeModel&&o.options.staticColumns.forEach(function(o){var i=t.subCells[o.dataIndex],n=e.cellView;e.manager=s,e.cellView=i,t.appendChild(i),o.onCellRequest(e),e.cellView=n})})}this._manageSelectionColumn(),this._manageZoom(),this._manageAutomaticResize(),this._mapBehaviorToNodeTypes();var a=function(){var e=!!f.getTouchMode();this.getManager().touchMode!==e&&(this.getManager().touchMode=e)}.bind(this);a(),document.addEventListener("touchChange",function(){a()}.bind(this))},destroy:function(){},getIconsToDisplay:function(e){var t=e?Array.from(e.getIcons()||[]):[];if(!this._hasNotificationIconColumn&&e){var o=this.getDocument()._specTreeVlt.getNotificationInfos(e.getNotification());o&&o.icon&&(o.icon.tooltipInfos={title:v[e.getNotification()],shortHelp:e.getNotificationMsg()},t.push(o.icon))}return t},_manageAutomaticResize:function(){this._lastRegisteredTreeColumnWidth=0;var e=this,t=this.getManager();e.getManager().onReady(function(){var o={x:0,y:0};var i=u.debounce(function(i){var n=t._computeMinimalColumnWidth("tree");e._lastRegisteredTreeColumnWidth===n&&t.__lastScrollPos.x===o.x||(t.prepareUpdateView(),t.setColumnWidth("tree",n),t.pushUpdateView(),e._lastRegisteredTreeColumnWidth=n,o=t.__lastScrollPos,console.info("sizeTreeColumnToFit"))},600);e.options.performances.automaticSizeTreeColumnToFit&&(e.options.treeDocument.onPostExpand(i),e.options.treeDocument.onPostCollapse(i),e.getManager().getScroller().onScrollEnd(i))})},_registerReusables:function(){var e=this,t=this.getManager();this.getManager().registerReusableCellContent({id:"__staticcolumns__",buildContent:function(){var o=new UWA.Element("div",{class:"wux-datagrid-static-cell"});return o.subCells={},e.options.staticColumns.forEach(function(e){var i,n=new UWA.Element("div",{class:"wux-datagrid-subcell",styles:{width:e.width}}).inject(o);o.subCells[e.dataIndex]=n,n.getContent=function(){return n},n._disposeReusableContent=function(){i&&(i.__disposable__.dispose(),i=void 0)},n._setReusableContent=function(e){n._disposeReusableContent(),i=e,n.setContent(i.getContent&&i.getContent()||i)},n.reuseCellContent=function(e){return t._reuseCellContent(e,n)}}),o}}),this.getManager().registerReusableCellContent({id:"__action__",buildContent:function(){var t=new UWA.Element("div",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-menu-dot",styles:{display:"block",textAlign:"center",lineHeight:e.options.defaultCellHeight+"px",fontSize:14}});return t.addEvent("click",function(e){var o=document.createEvent("HTMLEvents");o.initEvent("contextmenu",!0,!1),o.pageX=e.pageX,o.pageY=e.pageY,t.dispatchEvent(o)}),t}}),this.getManager().registerReusableCellContent({id:"__visibility__",buildContent:function(){function e(e){var t=!1;if(e)if(e._getResolved().onShow&&e._getResolved().onHide)t=!0;else if(e._isLayoutNode()){for(var o=0,i=e.getChildren(),n=0;Array.isArray(i)&&n<i.length;n++)i[n]._getResolved("onShow")&&i[n]._getResolved("onHide")&&o++;Array.isArray(i)&&o===i.length&&(t=!0)}return t}var o=new b({value:!0,map:{false:{value:{iconName:"eye-off"},valuePreview:{iconName:"eye-off"}},true:{valuePreview:{iconName:"eye-off"},value:{}}}});return o._mouseEnterCb=function(i){if(void 0===o._hasShowHideCb){var n=t._getCellInfosFromEventTarget(i);o._hasShowHideCb=e(n.nodeModel)}var s=o.map[o.value].valuePreview;o._hasShowHideCb||(s={}),o.getContent().setContent(c.generateIcon(s))},o._mouseLeaveCb=function(i){if(void 0===o._hasShowHideCb){var n=t._getCellInfosFromEventTarget(i);o._hasShowHideCb=e(n.nodeModel)}var s=o.map[o.value].value;o._hasShowHideCb||(s={}),o.getContent().setContent(c.generateIcon(s))},o.getContent().addEvent("click",function(i){var n=void 0;if(void 0===o._hasShowHideCb&&(n=t._getCellInfosFromEventTarget(i).nodeModel,o._hasShowHideCb=e(n)),!0===o._hasShowHideCb){i.stopPropagation(),o.value=!o.value,n||(n=t._getCellInfosFromEventTarget(i).nodeModel);var s=o.value?"onShow":"onHide";if(n.setVisibilityInSpecTree(o.value),n._isLayoutNode())for(var r=n.getChildren(),a=0;Array.isArray(r)&&a<r.length;a++)r[a].setVisibilityInSpecTree(o.value),r[a]._getResolvedAndCall(s);n._getResolvedAndCall(s)}}),o},cleanContent:function(e){e&&(e._hasShowHideCb=void 0)}}),this.getManager().registerReusableCellContent({id:"__color__",buildContent:function(){return new UWA.Element("span",{styles:{position:"absolute",top:10,left:4,right:4,bottom:10,borderRadius:"2px"}})}}),this.getManager().registerReusableCellContent({id:"__bordercolor__",buildContent:function(){return new UWA.Element("span",{styles:{position:"absolute",top:0,left:0,right:0,bottom:0}})}}),this.getManager().registerReusableCellContent({id:"__notification__",buildContent:function(){return new b({value:!0,map:{false:{valuePreview:void 0,value:void 0},true:{valuePreview:{iconName:"info"},value:{iconName:"info"}}}})}}),this.getManager().registerReusableCellContent({id:"__notificationcolor__",buildContent:function(){return new UWA.Element("div",{styles:{width:"100%",height:"100%"}})}}),this.getManager().registerReusableCellContent({id:"__breadcrumb__",buildContent:function(){var e=new _({value:[]});return e.displayLabels=4,e.displayIcons=1,e._lock=!1,e.addEventListener("change",function(o){if(!1===e._lock){var i=o.dsModel.value[o.dsModel.value.length-1].node;t.prepareUpdateView(),i.select(!0),t.setActiveNode(i),t.scrollToNode(i,"middle"),t.pushUpdateView()}}),e}})},_manageZoom:function(){var e=this;e._zoom=1,UWA.Element.addEvent.call(this.elements.container,"mousewheel",function(t){var o=UWA.Event.wheelDelta(t);if(t.ctrlKey){t.preventDefault(),1===Math.abs(o)&&(o*=.05);var i=e._zoom+o;i>=.55&&i<=1.5&&(e._zoom=i,e.getManager().elements.container.setStyle("zoom",e._zoom.toFixed(2)),e.getManager().updateView(!0),e.getManager().onPostUpdateViewOnce(function(){e.getManager()._updateUIActiveArea()}))}})},_manageSelectionColumn:function(){var e=this;e.getManager().registerReusableCellContent({id:"_specTreeSelection",buildContent:function(){var e=new UWA.Element("div",{class:"wux-spectreeview-selection-area",html:"&nbsp;"});return e.addEventListener("focus",function(e){e.preventDefault(),e.stopPropagation()}),e}});var t,o,i,n,s,r=e.getManager(),a=0,l=-1,d=[],u=!1;r._draggable({begin:function(o,a){if(-1===a.columnID&&c.firstParentWithClass(o.target,"wux-spectreeview-selection-area")){o.preventDefault(),o.stopPropagation(),s=r.getDocument(),n=s.getXSO(),d=n.get().slice();var l=r.getTreeNodeModelFromRowID(a.rowID);u=l.isSelected(),e.options.selection.canMultiSelect?l.withTransactionUpdate(function(){r.selectRow(a.rowID,!1),r.setActiveNode(l),l.select(),r._preventNextUpdateView()}):l.withTransactionUpdate(function(){r.setActiveNode(l),l.select(!0)}),t=a.rowID,i=a.rowID}},drag:function(u,h){c.hasClass(u.target,"wux-spectreeview-selection-area")&&u.stopPropagation(),r.getScrollerPosition().y<0&&(u.stopPropagation(),u.preventDefault()),-1===h.columnID&&c.firstParentWithClass(u.target,"wux-spectreeview-selection-area")&&function(c,u){if(s=r.getDocument(),n=s.getXSO(),e.options.selection.canMultiSelect){if(0===n.get().length&&t>=0){var h=r.getTreeNodeModelFromRowID(t);h.withTransactionUpdate(function(){r.selectRow(t,!1),r.setActiveNode(h),h.select(),r._preventNextUpdateView()})}if(0!==n.get().length){var p=r.getTreeNodeModelFromRowID(u.rowID);if(a=p._getRowID()-n.get()[0]._getRowID(),0!=p._getRowID()-i){r._modeIsListSel=!0,r._modeIsMultiSel=!0,o=u.rowID,i=u.rowID,r.prepareUpdateView(),r._preventNextUpdateView(),n.empty();for(var g,_,f=r.getSelectedRows();void 0!==f[0];)r.unselectRow(f[0]);a>0?(g=t,_=o):(_=t,g=o),d.forEach(function(e){r.unselectRow(e._getRowID())}),d=[];for(var v=g;v<=_;v++)!1===(m=r.getTreeNodeModelFromRowID(v)).isSelected()&&m.select(),r.selectRow(v,!1);if(l>_)for(v=_+1;v<=l;v++){var m;(m=r.getTreeNodeModelFromRowID(v))&&m.unselect(),r.unselectRow(v)}r.setActiveNode(p),l=_,r._modeIsListSel=!1,r._modeIsMultiSel=!1,r.pushUpdateView()}}}}(0,h)},end:function(e,o){if(-1===o.columnID&&void 0!==t&&c.firstParentWithClass(e.target,"wux-spectreeview-selection-area")){if(r.getTreeNodeModelFromRowID(t)._isLayoutNode()&&(o=r._getCellInfosFromEventTarget(e)),-1===o.columnID&&t===o.rowID&&u){var i=r.getTreeNodeModelFromRowID(o.rowID);r.setActiveNode(i),i.unselect()}r.updateView()}}})},_applyDropCell:function(e,t){var o=e.data["dswebux/x-tree.treenodemodel+number"];if("middle"!==t.dropPosition||t.nodeModel._getID()!==o){var i=t.nodeModel,n="middle"===t.dropPosition?i:i.getParent();if(n){var s=[],r=e.data["dswebux/x-tree.treenodemodel+json"];t.manager.getNodesXSO().get().forEach(function(e){var t=r.indexOf(e._getID());t>=0&&(r.splice(t,1),s.push(e))}),s.length&&n.applyDropTreeNodeModel({droppedNodes:s,dropPosition:t.dropPosition,dropNode:t.manager.getCellModel(t.rowID,t.columnID).getCellContent()})}}},_mapBehaviorToNodeTypes:function(){var e=this.getDocument();this.getManager().addEventListener("click",function(t,o){if(o&&!1===o.isHeader){var i=o.nodeModel;switch(i._getNodeCategory()){case e._specTreeVlt.NODE_CATEGORIES.FAKE:i.isExpanded()?i.collapse():i.expand()}}})},findInterface:function(e){if(e&&e.specTreeShell){e.specTreeShell.closeDrawer();var t=this.getManager().getDocument();t&&(t.prepareUpdate(),t.getFilterManager().setPropertyFilterModel("SpecTreeFilter",{filterId:"SpecTreeFilter",filterModel:{}}),t.processDescendants({onlyVisibleNodes:!1,treeTraversalOrder:"postOrder",processNode:function(t){t.nodeModel.isMatching(e.value)?t.nodeModel.matchSearch():t.nodeModel.unmatchSearch()}}),t.pushUpdate())}},filterInterface:function(e){if(e&&e.specTreeShell){e.specTreeShell.closeDrawer();var t=this.getManager().getDocument();t&&(t.prepareUpdate(),t.processDescendants({onlyVisibleNodes:!1,treeTraversalOrder:"postOrder",processNode:function(e){e.nodeModel.unmatchSearch()}}),t.getFilterManager().setPropertyFilterModel("SpecTreeFilter",{filterId:"SpecTreeFilter",filterModel:{filterString:e.value}}),t.pushUpdate())}},_search:function(e){var t=[],o=this.getManager().getDocument();return o.prepareUpdate(),o.processDescendants({onlyVisibleNodes:!1,treeTraversalOrder:"postOrder",processNode:function(o){var i=o.nodeModel.getChildren();"noChildren"===o.nodeModel.getState()&&Array.isArray(i)&&i.length&&o.nodeModel.setState({state:"expanded"}),o.nodeModel.show(),o.nodeModel.unmatchSearch(),o.nodeModel.isMatching(e.value)&&t.push(o.nodeModel)}}),o.pushUpdate(),t},searchInterface:function(e){e.specTreeShell.openDrawer({height:200});var o=this,i=this.getManager().getDocument(),n=this._search({value:e.value}),s=t._buildSpecTreeDocumentFromSearchResult({searchResults:n});s.getXSO().onAdd(function(e){var t=i.search({useTransaction:!1,match:function(t){return e.options._originalID===t.nodeModel._getID()}});o.getManager().scrollToNode(t[0],"middle",!1),t[0].select(!0)});var r=m.NOTIFICATION_COLOR,a=m.NOTIFICATION_ICON;a.isHidden=!e.showNotifications,r.isHidden=!e.showNotifications,this.elements.filteredTreeListView||(this.elements.filteredTreeListView=new w({height:"auto",enableStaticColumns:!1,defaultCellHeight:40,isEditable:!0,changeColorOnFocus:!1,show:{rowHeaders:!1,columnHeaders:!1},columns:[a,{dataIndex:"path",width:"auto",getValue:function(e){return e.nodeModel.options.path},setValue:function(){},onCellRequest:function(e){if(!1===e.isHeader){var t=e.cellView.reuseCellContent("__breadcrumb__");t._lock=!0,e.manager._updateBreadCrumb(t,e.nodeModel.options.path),t._lock=!1}}}]}),this.elements.filteredTreeListView.getContent().addClassName("wux-spectreeview"),this.elements.filteredTreeListView.getContent().addClassName("wux-state-filtered"),this.elements.filteredTreeListView.getManager().hideColumn("tree")),this.elements.filteredTreeListView.getManager().loadDocument(s),e.specTreeShell.elements.topDockingElement.dockingZoneContent=this.elements.filteredTreeListView.getContent()}});return Object.defineProperty(w,"DEFAULT_COLUMNS",{get:function(){return UWA.clone(m)}}),w}),define("DS/SpecTree/SpecTreeShell",["DS/SpecTree/SpecTreeView","DS/SpecTree/SpecTreeDocument","DS/Tree/Manager","DS/TreeModel/TreeNodeModel","DS/Tree/TreeNodeView","DS/Core/PointerEvents","DS/Controls/Button","DS/Controls/Abstract","DS/Controls/ComboBox","DS/Utilities/Dom","DS/Controls/LineEditor","DS/Controls/Find","DS/Windows/DockingElement","DS/Utilities/Utils","DS/TreeModel/TreeDocument","DS/Controls/Toolbar","DS/Controls/TooltipModel","i18n!DS/SpecTree/assets/nls/shell.json"],function(e,t,o,i,n,s,r,a,l,d,c,u,h,p,g,_,f,v){"use strict";var m=a.inherit({publishedProperties:{mode:{defaultValue:"find",type:"string"},value:{defaultValue:"",type:"string"},relatedWidget:{defaultValue:void 0,type:"object"},onFindRequest:{defaultValue:void 0,type:"function"},onFindPreviousResult:{defaultValue:void 0,type:"function"},onFindNextResult:{defaultValue:void 0,type:"function"},displayNavigationButtons:{defaultValue:!0,type:"boolean"}},_displayOptions:{search:!1,filter:!0},_applyProperties:function(e){this._parent(e),this.isDirty("mode")&&this._applyMode(e.mode),this.isDirty("value")&&this._applyValue(e.value),this.isDirty("relatedWidget")&&this._applyRelatedWidget(e.relatedWidget),this.isDirty("onFindRequest")&&this._applyOnFindRequest(e.onFindRequest),this.isDirty("onFindPreviousResult")&&this._applyOnFindPreviousResult(e.onFindPreviousResult),this.isDirty("onFindNextResult")&&this._applyOnFindNextResult(e.onFindNextResult),this.isDirty("displayNavigationButtons")&&this._applyDisplayNavigationButtons(e.displayNavigationButtons)},_preBuildView:function(){this._ignoreChangeEvents=!1,this.elements.container=UWA.createElement("div",{class:"wux-spectreeshell-search"}),(this._displayOptions.search||this._displayOptions.filter)&&(this.elements.inputSearch=new u({findStr:this.value,displayMatchCaseToggle:!1,displayClose:!1,onFindRequest:this.onFindRequest,onFindPreviousResult:this.onFindPreviousResult,onFindNextResult:this.onFindNextResult,placeholder:v["placeholder_"+this.mode]}).inject(this.elements.container),this.elements.inputSearch.getContent().addClassName("wux-spectreeshell-find")),this._displayOptions.search&&(this.elements.btnSearch=new r({icon:"search",displayStyle:"lite",type:"check"}).inject(this.elements.container)),this._displayOptions.filter&&(this.elements.btnFilter=new r({icon:{iconName:"filter",fontIconFamily:WUXManagedFontIcons.Font3DS},displayStyle:"lite",type:"check"}),this.elements.btnFilter.getContent().addClassName("wux-spectreeshell-modeButton"),this.elements.btnFilter.tooltipInfos=new f({shortHelp:"",longHelp:""}),this.elements.btnFilter.tooltipInfos.shortHelp=this.elements.btnFilter.checkFlag?v.tooltip_filter:v.tooltip_find,this.elements.btnFilter.inject(this.elements.container)),this._bindEvents()},_bindEvents:function(){var e=this;this.elements.inputSearch&&this.elements.inputSearch.addEventListener("uncommittedChange",function(t){e.value=e.elements.inputSearch.findStr}),this.elements.btnSearch&&this.elements.btnSearch.addEventListener("change",function(){!1===e._ignoreChangeEvents&&(e.elements.btnSearch.checkFlag?e.mode="search":e.mode="find")}),this.elements.btnFilter&&this.elements.btnFilter.addEventListener("change",function(t){if(e.elements.btnFilter.checkFlag?(e.mode="filter",e.elements.btnFilter.tooltipInfos.shortHelp=v["tooltip_"+e.mode]):(e.mode="find",e.elements.btnFilter.tooltipInfos.shortHelp=v["tooltip_"+e.mode]),e.onFindRequest){var o=e.elements.inputSearch;e.onFindRequest.call(o.relatedWidget,o.findStr,o.matchCase,o.currentValue)}})},_applyMode:function(){switch(this._ignoreChangeEvents=!0,this.mode){case"find":this.elements.btnSearch&&(this.elements.btnSearch.checkFlag=!1),this.elements.btnFilter&&(this.elements.btnFilter.checkFlag=!1);break;case"search":this.elements.btnSearch&&(this.elements.btnSearch.checkFlag=!0),this.elements.btnFilter&&(this.elements.btnFilter.checkFlag=!1);break;case"filter":this.elements.btnSearch&&(this.elements.btnSearch.checkFlag=!1),this.elements.btnFilter&&(this.elements.btnFilter.checkFlag=!0)}this.elements.inputSearch&&(this.elements.inputSearch.placeholder=v["placeholder_"+this.mode]),this._ignoreChangeEvents=!1},_applyValue:function(){this.elements.inputSearch&&(this.elements.inputSearch.findStr=this.value)},_applyRelatedWidget:function(){this.elements.inputSearch&&(this.elements.inputSearch.relatedWidget=this.relatedWidget)},_applyOnFindRequest:function(){this.elements.inputSearch&&(this.elements.inputSearch.onFindRequest=this.onFindRequest)},_applyOnFindPreviousResult:function(){this.elements.inputSearch&&(this.elements.inputSearch.onFindPreviousResult=this.onFindPreviousResult)},_applyOnFindNextResult:function(){this.elements.inputSearch&&(this.elements.inputSearch.onFindNextResult=this.onFindNextResult)},_applyDisplayNavigationButtons:function(e){this.elements.inputSearch&&(this.elements.inputSearch.displayNavigationButtons=this.displayNavigationButtons)}});return a.inherit({publishedProperties:{height:{defaultValue:"",type:"string"},representations:{defaultValue:[],type:"array"}},_preBuildView:function(){var e=this;this.elements.container=UWA.createElement("div",{class:"wux-spectreeshell"}),this.elements.header=UWA.createElement("div",{class:"wux-spectreeshell-header",styles:{zIndex:1e6}}).inject(this.getContent()),this.elements.searchField=new m({onFindRequest:this._onFindRequest.bind(this)}),this.elements.topDockingElement=new h({side:WUXDockAreaEnum.TopDockArea,collapsibleFlag:!1,collapseDockingZoneFlag:!0,visibleDockingZoneFlag:!1});var t=UWA.createElement("div",{styles:{position:"absolute",top:40,bottom:0,left:0,right:0}});this.elements.topDockingElement.inject(t),t.inject(this.elements.container),this.elements.topDockingElement.visibleDockingZoneFlag=!0,this.elements.topDockingElement.visibleDockingZoneFlag=!1,void 0===window.jasmine||window.WEBUX_DO_NOT_TEST_SPECTREEVIEW||setTimeout(function(){e.getContent().getParent()&&UWA.createElement("div",{html:"DO NOT TEST THE VIEW PLEASE",styles:{background:"red",color:"white",height:"100%",width:"100%",position:"absolute",top:0,bottom:0,left:0,right:0,zIndex:5e6}}).inject(e.elements.container)},1)},_buildHeader:function(){this.elements.toolbar=new _({overflowManagement:"dropdown",direction:"horizontal"}).inject(this.elements.header),this.elements.toolbar.adaptSizeToParent=!0,this.elements.toolbar.add("element",{element:this.elements.searchField.getContent(),position:"far"})},_getCurrentViewOptions:function(){var e=-1;return this.representations.length>1?e=this.elements.representationsControl.selectedIndex:1===this.representations.length&&(e=0),this.representations[e]},_applyProperties:function(e){this.isDirty("representations")&&this._applyRepresentations(),this._parent(e)},_applyRepresentations:function(e){var t=this;if(this.elements.toolbar||this._buildHeader(),this.elements.representationsControl&&(this.elements.toolbar.clearPosition("near"),this.elements.representationsControl.destroy()),this.elements.representationsControl=void 0,this.representations.length>1)this.elements.representationsControl=new l({elementsList:[],selectedIndex:0,enableSearchFlag:!1,actionOnClickFlag:!0}),this.elements.representationsControl.addEventListener("change",function(e){t.elements.topDockingElement.freeZoneContent=e.dsModel.currentValue()}),this.elements.representationsControl.elementsList=this.representations.map(function(e){return{labelItem:e.label,valueItem:e.mainView,iconItem:e.icon}});else if(1===this.representations.length){this.elements.representationsControl=UWA.createElement("div",{class:"wux-ui-disable-selection"}),void 0!==this.representations[0].icon&&(this.elements.representationsControl.iconPlaceholder=UWA.createElement("div").inject(this.elements.representationsControl),this.elements.representationsControl.icon=d.generateIcon(this.representations[0].icon).inject(this.elements.representationsControl.iconPlaceholder),this.elements.representationsControl.icon.style.margin="0px 8px 0px 8px"),void 0!==this.representations[0].label&&(this.elements.representationsControl.label=UWA.createElement("span").inject(this.elements.representationsControl),this.elements.representationsControl.label.innerHTML=this.representations[0].label,void 0===this.representations[0].icon&&(this.elements.representationsControl.label.style.margin="0px 8px 0px 8px"));var o=this.representations[0].mainView();this.elements.topDockingElement.freeZoneContent=o,o&&"function"==typeof o.goToPreviousMatchingCell&&"function"==typeof o.goToNextMatchingCell?(this.elements.searchField.relatedWidget=o,this.elements.searchField.onFindPreviousResult=o.goToPreviousMatchingCell,this.elements.searchField.onFindNextResult=o.goToNextMatchingCell,this.elements.searchField.displayNavigationButtons=!0):(this.elements.searchField.displayNavigationButtons=!1,this.elements.searchField.relatedWidget=o)}this.elements.toolbar.add("element",{element:1===this.representations.length?this.elements.representationsControl:this.elements.representationsControl.getContent(),position:"near"})},updateRepresentationsLabels:function(){this.representations.length>1?this.elements.representationsControl.elementsList=this.representations.map(function(e){return{labelItem:e.label,valueItem:e.mainView,iconItem:e.icon}}):1===this.representations.length&&(this.elements.representationsControl.icon&&this.elements.representationsControl.icon.remove(),void 0!==this.representations[0].icon&&(this.elements.representationsControl.icon=d.generateIcon(this.representations[0].icon).inject(this.elements.representationsControl.iconPlaceholder),this.elements.representationsControl.icon.style.margin="0px 8px 0px 8px"),void 0!==this.representations[0].label&&(this.elements.representationsControl.label.innerHTML=this.representations[0].label,void 0===this.representations[0].icon&&(this.elements.representationsControl.label.style.margin="0px 8px 0px 8px")))},_onFindRequest:function(e,t,o){this._search()},_search:function(e){var t=this.elements.searchField.value;switch(this.elements.searchField.mode){case"find":this._getCurrentViewOptions().onFind({value:t,specTreeShell:this});break;case"search":this._getCurrentViewOptions().onSearch({value:t,specTreeShell:this});break;case"filter":this._getCurrentViewOptions().onFilter({value:t,specTreeShell:this})}},openDrawer:function(e){this.elements.topDockingElement.dockingZoneSize=e.height,this.elements.topDockingElement.visibleDockingZoneFlag=!0,this.elements.topDockingElement.dockingZoneContent=e.content},closeDrawer:function(){this.elements.topDockingElement.visibleDockingZoneFlag=!1}})});