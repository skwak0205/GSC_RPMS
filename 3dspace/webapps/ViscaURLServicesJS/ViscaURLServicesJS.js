define("DS/ViscaURLServicesJS/VisuRepServices",["DS/WAFData/WAFData"],function(e){"use strict";var t=function(){};t.RepType=Object.freeze({AV1:"av1",RR:"rr",PR:"pr"});return t.prototype.GetStaticUrls=function(r,o,i){if("object"==typeof r&&"object"==typeof o&&Array.isArray(i)){var a="function"==typeof r.onCompleteCB,n=[],s=function(){var s={async:a,timeout:r.timeout,authentication:"passport",proxy:"passport",method:"POST",data:JSON.stringify({label:"VisuRepServices-"+r.user+"-"+Date.now(),physicalid:i,select_predicate:["physicalid","cgrwms","3dthbwms"],select_file:[o.type==t.RepType.AV1?"cgr":"thumbnail_3d"],fcs_url_mode:"REDIRECT"}),headers:{"Content-type":"application/json",SecurityToken:r.user+"|"+r.securityCtx+"|preferred",SecurityContext:r.securityCtx},onComplete:function(e,t){if("string"==typeof e&&0!==e.length){var o=JSON.parse(e);if("object"==typeof o&&Array.isArray(o.results)){var i=[];o.results.forEach(function(e){if(Array.isArray(e.attributes)){var t={};e.attributes.forEach(function(e){"physicalid"==e.name?t.boid=e.value:"cgr"==e.name||"thumbnail_3d"==e.name?t.url=e.value:"string"==typeof t.version||"cgrwms"!=e.name&&"3dthbwms"!=e.name||(t.version=e.value)}),"string"==typeof t.boid&&"string"==typeof t.url&&i.push(t)}}),a?r.onCompleteCB(i):n=i}else r.onFailureCB()}else r.onFailureCB()},onFailure:function(){r.onFailureCB&&r.onFailureCB()},onPassportError:function(){r.onFailureCB&&r.onFailureCB()},onTimeout:function(){r.onFailureCB&&r.onFailureCB()}};e.authenticatedRequest(r.spaceUrl+"/cvservlet/fetch/v2?tenant="+r.tenant,s)};if(o.type!=t.RepType.AV1&&"string"==typeof r.viscaUrl){var l=[];i.forEach(function(e){l.push({source:o.source,boid:e,type:o.type})});var c={async:a,timeout:r.timeout,authentication:"passport",proxy:"passport",method:"POST",data:JSON.stringify({files:l}),headers:{"Content-type":"application/json",SecurityContext:r.securityCtx},onComplete:function(e,t){if("string"==typeof e&&0!==e.length){var o=JSON.parse(e);if("object"==typeof o&&Array.isArray(o.urls)){var i=[];o.urls.forEach(function(e){i.push({boid:e.boid,url:e.url,version:e.version})}),i.length>0?a?r.onCompleteCB(i):n=i:s()}else s()}else s()},onFailure:function(){s()},onPassportError:function(){s()},onTimeout:function(){s()}};e.authenticatedRequest(r.viscaUrl+"/api/v1/urls",c)}else s();return a?void 0:n}r.onFailureCB&&r.onFailureCB()},t}),define("DS/ViscaURLServicesJS/ViscaURLServices",function(){"use strict";var e=function(){};function t(e){for(var t=e.split("&"),r={},o=0;o<t.length;o++){var i=t[o].split("=");"s"===i[0]?r.source=i[1]:"t"===i[0]?r.tenant=i[1]:"id"===i[0]?r.boid=i[1]:"f"===i[0]?r.filename=i[1]:"fmt"===i[0]?r.format=i[1]:"v"===i[0]?r.version=i[1]:"ts"===i[0]?r.timestamp=i[1]:"type"===i[0]?r.type=i[1]:"sgn"===i[0]&&(r.signature=i[1])}return r}return e.prototype.CreateURLsRequestBody=function(e,t){if(void 0!==e&&0!==e.length){for(var r={},o={files:[]},i=0;i<e.length;i++){if(void 0===e[i])return;o.files.push(e[i])}return"object"==typeof t&&"boolean"==typeof t.fallback&&t.fallback&&(o.fallback=!0),r.body=JSON.stringify(o),r}},e.prototype.CreateBatchURLAndBody=function(e,r){if(void 0!==e&&0!==e.length){for(var o={},i={files:[]},a=0;a<e.length;a++){if(void 0===e[a])return;var n=e[a].toLowerCase().search("api/v1/rep?");if(-1===n)return;0===a&&(o.url=e[a].substring(0,n)+"api/v1/reps");var s=t(e[a].substring(n+"api/v1/rep?".length,e[a].length));i.files.push(s)}return"object"==typeof r&&"boolean"==typeof r.allowPartial&&r.allowPartial&&(i.allowPartial=!0),"object"==typeof r&&"boolean"==typeof r.fallback&&r.fallback&&(i.fallback=!0),"object"==typeof r&&"string"==typeof r.emptyFallback&&r.emptyFallback.length>0&&(i.emptyFallback=emptyFallback),"object"==typeof r&&"boolean"==typeof r.checkVersion&&r.checkVersion&&(i.checkVersion=!0),o.body=JSON.stringify(i),o}},e.prototype.CreateFetchURLAndBody=function(e,r,o){if(void 0!==e&&0!==e.length&&void 0!==r&&r.length===e.length){for(var i={},a={files:[]},n=0;n<e.length;n++){if(void 0===e[n])return;var s=e[n].toLowerCase().search("api/v1/rep?");if(-1===s)return;0===n&&(i.url=e[n].substring(0,s)+"api/v1/fetch");var l=t(e[n].substring(s+"api/v1/rep?".length,e[n].length));l.correlationID=r[n],a.files.push(l)}return"object"==typeof o&&"number"==typeof o.splitTargetedSize&&o.splitTargetedSize>0&&(a.splitTargetedSize=o.splitTargetedSize),"object"==typeof o&&"boolean"==typeof o.allowPartial&&o.allowPartial&&(a.allowPartial=!0),"object"==typeof o&&"boolean"==typeof o.checkVersion&&o.checkVersion&&(a.checkVersion=!0),i.body=JSON.stringify(a),i}},e});