function mock(e,t){return this instanceof mock?(this.object=e,this.fn=t,this.orgFn=e[t],this):new mock(e,t)}mock.prototype={returnValue:function(e){return this.object[this.fn]=function(){return e},this},callFake:function(e){var t=this;this.object[this.fn]=function(){var i=Array.prototype.slice.call(arguments);return i.push(t),e.apply(this,i)}}},define("DS/LifecycleWidget/utils/LifecycleAlert",["DS/Logger/Logger","UWA/Class","css!DS/UIKIT/UIKIT.css","DS/UIKIT/Alert"],function(e,t,i,n){var s=t.singleton({name:"lifecycle_alert",_logger:null,_alert:null,_error:null,init:function(){this._logger=e.getLogger(s),_alert=null,_error=null},resetContainer:function(e){if(this._logger.log("resetContainer"),!e)throw new Error("Invalid Container");this._alert=new n({className:this.name,closable:!0,visible:!0,autoHide:!0,hideDelay:3e3}).inject(e,"top"),this._error=new n({className:this.name,closable:!0,visible:!0,autoHide:!1}).inject(e,"top")},setContainer:function(e){if(this._logger.log("setContainer"),this._alert)throw new Error("LifecycleAlert Container already set");if(!e)throw new Error("Invalid Container");this.resetContainer(e)},displayNotification:function(e){if(this._logger.log("displayNotification"),null===this._alert)throw new Error("LifecycleAlert Container has not been set");if(e.msg){var t=e.msg;"function"==typeof t.replace&&(t=t.replace(/(?:\r\n|\r|\n)/g,"<br />")),"warning"===e.eventID?this._error.add({className:e.eventID,message:t}):this._alert.add({className:e.eventID?e.eventID:"primary",message:t})}else console.error("displayNotification: message has not been set")}});return s}),define("DS/LifecycleWidget/utils/LifecycleWidgetSearchUtil",["UWA/Core","UWA/Utils/InterCom"],function(e,t){"use strict";return{initialize:function(){this.socketName="search_socket_"+(new Date).getTime(),this.socket=new t.Socket(this.socketName,{dispatchRetryInterval:5}),this.socket.subscribeServer("SearchComServer"),this.listener=this.objectsSelected.bind(this),this.socket.addListener("Selected_Objects_search",this.listener);var e=this.options();return this.socket.dispatchEvent("RegisterContext",e),this},options:function(e,t,i,n,s,o,a){var l={};return l.title=e,l.mode="furtive",l.app_socket_id=this.socketName,null!==widget&&void 0!==widget?l.widget_id=widget.id:l.widget_id="",l.default_with_precond=!0,l.show_precond=!1,l.idcard_activated=!1,l.multiSel=s,l.role=i,t&&(l.precond="",(t=t.split(",")).forEach(function(e,t){0!==t&&(l.precond+=" OR "),l.precond+='flattenedtaxonomies:"types/'+e+'"'})),o&&(l.precond?l.precond="( "+l.precond+") AND "+o:l.precond=o),a&&a.length>0&&(l.columns=a),l},destroy:function(){var e={};e.widget_id=widget.id,this.socket.dispatchEvent("unregisterSearchContext",e),this.socket.unsubscribeServer("SearchComServer"),this.socket.removeListener("Selected_Objects_search",this.listener),this.socket.disconnect(),delete this.socket},activate:function(e,t,i,n,s,o,a,l){var r=this.options(e,t,i,n,s,a,l);this.callback=o,this.socket.dispatchEvent("InContextSearch",r)},isAvailable:function(){return e.is(this.socket)},configureSearch:function(e){this.isAvailable()||this.initialize(e)},launchSearch:function(e){this.initialize(),this.activate("",e.allowedTypes,e.role||"",e.criteria,e.bMultiSel,function(t){e.in_apps_callback(t)},e.additionalQuery,e.selectable)},objectsSelected:function(e){var t,i,n=[];if(this.callback){for(t=0,i=e.length;t<i;t++)n.push(e[t]);this.callback(n)}}}}),define("DS/LifecycleWidget/CommandRouter",["UWA/Class","DS/LifecycleCmd/DuplicateCmd","DS/LifecycleCmd/ReviseCmd","DS/LifecycleCmd/NewBranchCmd","DS/LifecycleCmd/ReviseFromCmd","DS/LifecycleCmd/DeleteCmd","DS/LifecycleCmd/IterationsCmd","DS/LifecycleCmd/MaturityCmd","DS/LifecycleCmd/HistoryCmd","DS/LifecycleCmd/ClearAllCmd","DS/LifecycleCmd/TilesLayoutCmd","DS/LifecycleCmd/LargeTilesLayoutCmd","DS/LifecycleCmd/ThumbnailsLayoutCmd"],function(e,t,i,n,s,o,a,l,r,c,d,u,h){"use strict";return e.singleton({init:function(){this.router={DeleteHdr:{commandName:"Delete",oldPath:"DS/LifecycleWidget/LifecycleCmd",newPath:"DS/LifecycleCmd/DeleteCmd",cmd:null,factory:function(e){return new o(e)}},RevisionHdr:{commandName:"Revise",oldPath:"DS/LifecycleWidget/LifecycleCmd",newPath:"DS/LifecycleCmd/ReviseCmd",cmd:null,factory:function(e){return new i(e)}},NewBranchHdr:{commandName:"NewBranch",oldPath:"DS/LifecycleWidget/LifecycleCmd",newPath:"DS/LifecycleCmd/NewBranchCmd",cmd:null,factory:function(e){return new n(e)}},ReviseFromHdr:{commandName:"ReviseFrom",oldPath:"DS/LifecycleWidget/LifecycleCmd",newPath:"DS/LifecycleCmd/ReviseFromCmd",cmd:null,factory:function(e){return new s(e)}},DuplicateHdr:{commandName:"Duplicate",oldPath:"DS/LifecycleWidget/LifecycleCmd",newPath:"DS/LifecycleCmd/DuplicateCmd",cmd:null,factory:function(e){return new t(e)}},IterationsHdr:{commandName:"Iterations",oldPath:"DS/LifecycleWidget/LifecycleCmd",newPath:"DS/LifecycleCmd/IterationsCmd",cmd:null,factory:function(e){return new a(e)}},MaturityHdr:{commandName:"Maturity",oldPath:"DS/LifecycleWidget/LifecycleCmd",newPath:"DS/LifecycleCmd/MaturityCmd",cmd:null,factory:function(e){return new l(e)}},HistoryHdr:{commandName:"History",oldPath:"DS/LifecycleWidget/LifecycleCmd",newPath:"DS/LifecycleCmd/HistoryCmd",cmd:null,factory:function(e){return new r(e)}},ClearAllHdr:{commandName:"ClearAll",oldPath:"DS/LifecycleWidget/LifecycleCmd",newPath:"DS/LifecycleCmd/ClearAllCmd",cmd:null,factory:function(e){return new c(e)}},TilesLayoutCmdHdr:{commandName:"TilesLayout",oldPath:"DS/LifecycleWidget/LifecycleCmd",newPath:"DS/LifecycleCmd/TilesLayoutCmd",cmd:null,factory:function(e){return new d(e)}},LargeTilesLayoutCmdHdr:{commandName:"LargeTilesLayout",oldPath:"DS/LifecycleWidget/LifecycleCmd",newPath:"DS/LifecycleCmd/LargeTilesLayoutCmd",cmd:null,factory:function(e){return new u(e)}},ThumbnailsLayoutCmdHdr:{commandName:"ThumbnailsLayout",oldPath:"DS/LifecycleWidget/LifecycleCmd",newPath:"DS/LifecycleCmd/ThumbnailsLayoutCmd",cmd:null,factory:function(e){return new h(e)}}}},isRoutedCommand:function(e){return this.router.hasOwnProperty(e)},initCommand:function(e){if(this.router.hasOwnProperty(e.ID)){var t=this.router[e.ID];t.cmd&&(t.cmd=null),console.warn("Deprecated command path for "+t.commandName+" command.",'Old deprecated path: "'+t.oldPath+'"','Use new path:  "'+t.newPath+'"'),t.cmd=t.factory(e)}else console.error("Invalid header sent to CommandRouter.initCommand")},execute:function(e){if(this.router.hasOwnProperty(e)){var t=this.router[e];t.cmd?t.cmd.execute():console.error("Command "+t.commandName+"is not initialized")}else console.error("Invalid header sent to CommandRouter.execute")}})}),define("DS/LifecycleWidget/LifecycleSelection",["UWA/Controls/Abstract"],function(e){"use strict";return e.extend({init:function(e){this.object=e},getLabel:function(){return this.object.displayName},getDisplayName:function(){return this.object.displayName+" "+this.object.revision},getID:function(){return this.object.physicalid},getTenant:function(){return this.object.tenant}})}),define("DS/LifecycleWidget/SidePanel",["UWA/Class/View","DS/EditPropWidget/EditPropWidget","DS/EditPropWidget/constants/EditPropConstants","DS/EditPropWidget/models/EditPropModel","i18n!DS/LifecycleWidget/assets/nls/LifecycleWidgetNls"],function(e,t,i,n,s){"use strict";var o=null;return e.extend({slideInContent:"",setup:function(){this.slideInContent=UWA.createElement("div",{id:"slideInPropertiesContent",styles:{height:"95%",width:"100%"}})},getPlatformId:function(){return"undefined"!=typeof widget&&widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise"},buildSlideIn:function(e,a,l,r){var c=new t({typeOfDisplay:i.ALL,displayType:i.STANDARD,readOnly:!1,extraNotif:!1,setEditButton:!0,readOnly:!1});c.addFacets([{position:1,require:"DS/ENORIPE_Relations/views/RelationsTab",facet:{name:"relations",text:s.get("relations_tab"),icon:"object-related"}},{require:"DS/ENOXVersionExplorerUtils/RevisionsTabFacet",facet:{name:"revisions",text:"Revisions",icon:"object-related"}}]);for(var d=e,u=this.getPlatformId(),h=[],p=0;p<d.length;p++){var m=d[p].object.physicalid,f=new n({metatype:"businessobject",tenant:u,objectId:m});h.push(f)}c.initDatas(h),c.inject(this.slideInContent),o=UWA.extendElement(this.slideInContent);var g=l.getRightPanelContent();return o.inject(g),o}})}),define("DS/LifecycleWidget/DesignMode/mockRequest",["text!DS/LifecycleWidget/DesignMode/MockData/simpleAssy_part1/attributeList.json","text!DS/LifecycleWidget/DesignMode/MockData/simpleAssy_part1/attributeListNewRevFrom.json","text!DS/LifecycleWidget/DesignMode/MockData/simpleAssy_part1/navigate.json","text!DS/LifecycleWidget/DesignMode/MockData/simpleAssy_part1/navigateDup.json","text!DS/LifecycleWidget/DesignMode/MockData/simpleAssy_part1/state.json","text!DS/LifecycleWidget/DesignMode/MockData/simpleAssy_part1/family.json","text!DS/LifecycleWidget/DesignMode/MockData/simpleAssy_part1/links.json","text!DS/LifecycleWidget/DesignMode/MockData/simpleAssy_part1/dupOpts.json","text!DS/LifecycleWidget/DesignMode/MockData/simpleAssy_part1/deleteOpts.json","text!DS/LifecycleWidget/DesignMode/MockData/culasse110/attributeList.json","text!DS/LifecycleWidget/DesignMode/MockData/culasse110/state.json","text!DS/LifecycleWidget/DesignMode/MockData/culasse110/family.json","text!DS/LifecycleWidget/DesignMode/MockData/culasse110/links.json","text!DS/LifecycleWidget/DesignMode/MockData/culasse110/delOptions.json","text!DS/LifecycleWidget/DesignMode/MockData/culasse110/dupOptions.json","text!DS/LifecycleWidget/DesignMode/MockData/culasse110/expand.json","text!DS/LifecycleWidget/DesignMode/MockData/culasse110/expandDup.json","text!DS/LifecycleWidget/DesignMode/MockData/culasse110/expandDupAdvanced.json","text!DS/LifecycleWidget/DesignMode/MockData/culasse110/attributeListNewRevFrom.json","text!DS/LifecycleWidget/DesignMode/MockData/culbuteur/attListNewRevPick1.json","text!DS/LifecycleWidget/DesignMode/MockData/culbuteur/attListNewRevPick2.json","text!DS/LifecycleWidget/DesignMode/MockData/culbuteur/attributeList.json","text!DS/LifecycleWidget/DesignMode/MockData/culbuteur/family.json","text!DS/LifecycleWidget/DesignMode/MockData/culbuteur/links.json","text!DS/LifecycleWidget/DesignMode/MockData/culbuteur/state.json","text!DS/LifecycleWidget/DesignMode/MockData/culbuteur/expand.json","text!DS/LifecycleWidget/DesignMode/MockData/culbuteur/expandPick1.json","text!DS/LifecycleWidget/DesignMode/MockData/culbuteur/expandPick2.json","text!DS/LifecycleWidget/DesignMode/MockData/simpleAssy_part1/securityContext.json","text!DS/LifecycleWidget/DesignMode/MockData/common/enforceFolderLink.json"],function(e,t,i,n,s,o,a,l,r,c,d,u,h,p,m,f,g,y,b,v,D,C,S,w,N,I,P,j,O,A){var L=function(e){var t,i,n=0;if(0===e.length)return n;for(t=0,i=e.length;t<i;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n};function M(){this.map=[],this.add(-1580602268,e,!0),this.add(-1711554991,e,!0),this.add(-742845072,e,!0),this.add(1834356537,o,!1),this.add(684301714,s,!0),this.add(-499419683,a,!1),this.add(-2023735749,a,!1),this.add(716480295,i,!0),this.add(-368422264,l,!0),this.add(575246942,r,!0),this.add(1408127645,c,!0),this.add(-850201785,c,!0),this.add(1881182438,c,!0),this.add(-716167182,u,!1),this.add(1391380968,d,!0),this.add(-345377001,d,!0),this.add(1496977470,d,!0),this.add(-626771260,h,!1),this.add(-924744780,h,!1),this.add(-1550534267,p,!0),this.add(-223640063,m,!0),this.add(-525842663,f,!0),this.add(-1520147171,g,!0),this.add(1943635073,b,!0),this.add(654572325,y,!0),this.add(-1165212465,C,!0),this.add(-700969585,C,!0),this.add(2110900526,C,!0),this.add(-1698767068,S,!1),this.add(1148999378,w,!1),this.add(-1388157850,w,!1),this.add(929462890,N,!0),this.add(0,v,!0),this.add(0,D,!0),this.add(-460782979,I,!0),this.add(0,P,!0),this.add(0,j,!0),this.add(2011935415,O,!0),this.add(-1302739405,A,!0)}return M.prototype={add:function(e,t,i){this.map.push({key:e,data:t,parseJson:i})},find:function(e){for(var t=this.map.length,i=0;i<t;++i)if(this.map[i].key===e)return this.map[i].parseJson?JSON.parse(this.map[i].data):this.map[i].data;return null}},{call:function(e,t,i){if(-1!=e.indexOf("mocked")){var n;n=void 0!==t.data?L(e+t.data):L(e),this.reqMap=this.reqMap||new M;var s=this.reqMap.find(n);if(null==s)return console.log("Missing mock data"),console.log("hash:",n),console.log("path:",e),console.log("data",t.data),void t.onFailure("Mock data not found!\nURL:"+e);window.setTimeout(function(){t.onComplete(s)},0)}else i.orgFn.apply(this,arguments)}}}),define("DS/LifecycleWidget/DesignMode/setup",["DS/LifecycleServices/LifecycleServicesSettings","DS/WAFData/WAFData","DS/LifecycleWidget/DesignMode/mockRequest","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","text!DS/LifecycleWidget/DesignMode/MockData/simpleAssy_part1/platformSvc.json"],function(e,t,i,n,s){return{init:function(){console.log("setup.init()"),designModeLC=!0,mock(n,"getPlatformServices").callFake(function(e){e.onComplete(JSON.parse(s))}),mock(UWA.Data,"request").callFake(function(e,t,n){i.call(e,t,n)}),mock(t,"authenticatedRequest").callFake(function(e,t,n){i.call(e,t,n)}),e.init(),mock(e,"get3DSpaceWSUrl").callFake(function(e,t){return"http://mocked"+t}),mock(e,"get3DSpaceBaseUrl").callFake(function(e){return"http://mocked"}),mock(e,"getCurrentFolderID").returnValue(42),mock(e,"hasPARRole").callFake(function(e){e(!0)})},onLoaded:function(e){console.log("setup.onLoaded()"),e.uwaUrl="https://mocked/3DSpace/webapps/LifecycleWidget/LifecycleWidget.html",e.myLifecycleWidget.setObjects([{physicalid:"061AB556976F000053D3465784280A00"}])}}}),define("DS/LifecycleWidget/LifecycleCmd",["css!DS/LifecycleWidget/LifecycleWidget","DS/ApplicationFrame/Command","DS/LifecycleWidget/CommandRouter"],function(e,t,i){"use strict";return t.extend({name:"lifecycle_actionbar",context:null,init:function(e){i.isRoutedCommand(e.ID)&&i.initCommand(e),this._parent(e,{mode:"exclusive",isAsynchronous:!1})},execute:function(){if(i.isRoutedCommand(this._id))i.execute(this._id);else try{commandHdr}catch(i){if("function"==typeof this.context.displayNotification){var e=i;i.hasOwnProperty("message")&&(e=i.message);var t={eventID:"warning",msg:e};this.context.displayNotification(t)}console.log(i.message)}}})}),define("DS/LifecycleWidget/LifecycleWidget",["UWA/Controls/Abstract","UWA/Class/Promise","DS/ENO6WPlugins/jQuery","DS/PlatformAPI/PlatformAPI","DS/MaturityWidget/MaturityWidget","DS/ApplicationFrame/ActionBar","DS/LifecycleWidget/LifecycleCmd","DS/HistoryMultiPanel/HistoryMultiPanel","DS/CollectionView/ResponsiveThumbnailsCollectionView","DS/CollectionView/ResponsiveTilesCollectionView","DS/CollectionView/ResponsiveLargeTilesCollectionView","DS/CollectionView/modelProviders/CollectionViewUWACollectionModelProvider","UWA/Class/Collection","UWA/Class/Model","DS/LifecycleWidget/LifecycleSelection","DS/LifecycleServices/LifecycleAlert","DS/ApplicationFrame/CommandsManager","DS/WAFData/WAFData","i18n!DS/LifecycleWidget/assets/nls/LifecycleWidgetNls","UWA/Utils/InterCom","DS/LifecycleServices/LifecycleServicesSettings","DS/LifecycleServices/LifecycleServices","DS/LifecycleServices/LifecycleObjectBlacklist","DS/LifecycleCmd/MessageMediator","DS/HistoryExplorer/ExternalRefresh","DS/LifecycleWidget/utils/LifecycleWidgetSearchUtil","DS/UIKIT/Input/Button","WebappsUtils/WebappsUtils","DS/ENOXEmptyContent/js/ENOXEmptyContent","text!DS/LifecycleWidget/assets/search_config/search_config.json","DS/RuntimeView/NLSManager","css!DS/Core/wux-3ds-fonticons.css","css!DS/Core/wux.css","DS/ENOXTriptych/js/ENOXTriptych","DS/LifecycleWidget/SidePanel","DS/CoreEvents/ModelEvents","DS/Core/PointerEvents","css!DS/UIKIT/UIKIT.css","DS/LifecycleCmd/CommandAPI","DS/i3DXCompassPlatformServices/OpenWith","DS/UIKIT/Mask","DS/PubSub/PubSub","DS/LifecycleControls/CredentialList","DS/UIKIT/Tooltip"],function(e,t,i,n,s,o,a,l,r,c,d,u,h,p,m,f,g,y,b,v,D,C,S,w,N,I,P,j,O,A,L,M,x,T,E,_,W,k,R,V,F,U,B,H){"use strict";var q,X,J,z,K,G,Q="DS/ENONewWidget/command/sample/LifecycleWidgetNewCmdOptions";return e.extend({name:"Lifecycle-container",tenant:null,enovia3dspaceurl:null,collabsharing:!1,addinmode:null,init:function(e,t,i){this.widget=e,this.widget.lifecycleWidget=this,this.parentWidget=t,this.addinmode=this.widget.getValue("addinmode");var s=this;this.widgetType="LifecycleWidget",window.location.href.indexOf("ENOLCMS_AP")>-1&&(console.log("LifecycleWidget: In Collab Sharing App!!!"),s.collabsharing=!0),this.droppable=i.droppable,this.responsiveThumbOptions={height:"inherit",displayedOptionalCellProperties:["contextualMenu"],allowUnsafeHTMLContent:!1},this.autolaunch="",this.transientSearch=!1,this.fromSearch=!1,this.startAttributeIncrement=200,this.attributeIncrement=this.startAttributeIncrement,this.minimumAttributeIncrement=25,this.odtMode=!1,i.hasOwnProperty("odtMode")&&(this.odtMode=i.odtMode),void 0===i.droppable?this.droppable=!0:this.droppable=i.droppable,this._parent(i),this.objects=[],this.objectsPID=[],this.objectsLID=[],this.setTitle(b.lifecycleTitle),this.selectedNodes=[],this.selectedNodesPID=[],this.selectedNodesObjects=[],this.model=new h,this.modelPIDs=[],this.containerResponsiveThumbnailOrTile=null,this._actionBar=null,this.actionBarReady=!1,this.historyMultiPanel=null,this.maturityWidget=null,this.multiViewType=1,this.secretMultiViewFlag=!1,this.secretMultiViewFlagCheck=!1,this.stack=[],this.selectedObjIdFromSearch=null,this.refreshSub=n.subscribe("Lifecycle.Modification",this._processRefresh.bind(this)),require(["DS/PADUtils/PADCommandProxy"],function(e){s.commandProxy=e.create({events:{onRefresh:function(e){UWA.is(e.authored.modified,"array")&&e.authored.modified.length>0&&s.updateObjectAtttributes(e.authored.modified),UWA.is(e.authored.deleted,"array")&&e.authored.deleted.length>0&&s.removeObjects(e.authored.deleted)}}})}),this.lifecycleDropArea=null,this.lifecycleDroppableArea=null,this.elements.container=null,this.setInfoIcon(),this.buildSkeleton();s=this;this.clearView=function(e){e.empty()},D.app_initialization(function(){s.tenant=D.getTenant();var e=D.getOption("platform_services",null);null!=e&&e.length>0&&Array.isArray(e)&&e.forEach(function(e){null!=e&&e.hasOwnProperty("platformId")&&(1==i.odtMode&&(s.reloadSavedObjects(),s.useCompassContent()),C.getSecurityContextList(e.platformId,function(){0===e.platformId.localeCompare(s.tenant)&&(s.reloadSavedObjects(),s.useCompassContent()),s.getSecurityContext=C.getSecurityContextForCollaborativeSharingCommands}))})}),require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"]),require([Q],function(e){Q=e}),"solidworks"==this.addinmode&&e.addEvent("endEdit",function(){s.useCompassContent()})},_processRefresh:function(e){try{var t=JSON.parse(e);if(null!=t&&t.hasOwnProperty("Refresh")&&t.hasOwnProperty("AppID")&&"ENOLCMI_AP"===t.AppID){var i=t.Refresh;Array.isArray(i.created)&&i.created[0].forceLoad?this.historyMultiPanel.revisionFamily.versionExplorer._forceLoad():null!=i.created&&i.created.length>0&&this.addObjects(i.created)}}catch(e){console.log(e)}},_subcribe:function(){this.modelEvents.subscribe({event:"LifecycleWidget-info-icon-close"},function(){infoicon.classList.remove("selected")})},setInfoIcon:function(){var e=new _;this.modelEvents=e,this.subscribeInfoEvents(e),this._subcribe()},subscribeInfoEvents:function(e){var t=this;e.subscribe({event:"LifecycleWidget-info-panel-open"},function(){t._displayProperties()}),e.subscribe({event:"LifecycleWidget-info-panel-close"},function(){t._hidePropertiesPanel()})},_displayProperties:function(e){var t=this.selectedNodes;if(0!=t.length){var i=new E;i.buildSlideIn(t,e,X),X._showPanel(" ")}else X._showPanel(" ")},_hidePropertiesPanel:function(){if(!0===X._isRightOpen){var e=document.getElementById("slideInPropertiesContent");null!=e&&e.destroy(),X._hidePanel(" ")}},clearAllSelectedNodes:function(){this.selectedNodes=[],this.selectedNodesPID=[],this.selectedNodesObjects=[],this.containerResponsiveThumbnailOrTile&&this.containerResponsiveThumbnailOrTile.unselectAll()},selectThisNode:function(e){if(this.containerResponsiveThumbnailOrTile){var t=this.modelPIDs.indexOf(e);t>=0&&this.containerResponsiveThumbnailOrTile.selectCell(t,!0,!1,!1)}},selectNodes:function(e){this.clearAllSelectedNodes();for(var t=0;t<e.length;t++){var i=new m(e[t]);this.selectedNodes.push(i),this.selectedNodesPID.push(e[t].physicalid),this.selectedNodesObjects.push(e[t]),this.selectThisNode(e[t].physicalid)}this.doPickContext(this.contextMenuObject,this.isOpenWithCatiaV5Available)},setCurrentWidgetPreferences:function(){var e=this.tenant?this.tenant:D.getTenant();currentTenantCredentialPreference&&widget.setValue("xPref_3DEXPERIENCE_PLATFORM",e)},largeTilesLayout:function(){this.multiViewType="LargeTiles",this.changeViewType()},tilesLayout:function(){this.multiViewType="Tiles",this.changeViewType()},thumbnailsLayout:function(){this.multiViewType="Thumbnails",this.changeViewType()},changeViewType:function(){if(0!=this.isMultiView()&&(this.containerResponsiveThumbnailOrTile.destroy(),this.containerResponsiveThumbnailOrTile=null,this.buildCollectionView(this.lifecycleDiv),this.containerResponsiveThumbnailOrTile.loadApplicativeModel(this.model),this.selectedNodesPID&&this.selectedNodesPID.length>0))for(var e=0;e<this.selectedNodesPID.length;e++){var t=this.selectedNodesPID[e];this.selectThisNode(t)}},buildSkeleton:function(){var e=this,t=this.elements.container=UWA.createElement("div",{class:this.getClassNames()}).inject(widget.body);1==this.droppable&&(this.elements.container.addEventListener("drop",function(t){e.onDrop(t)}),this.elements.container.addEventListener("dragover",function(t){e.onDragOver(t)}),this.elements.container.addEventListener("dragenter",function(t){e.onDragEnter(t)}),this.elements.container.addEventListener("dragleave",function(t){e.onDragLeave(t)}));for(var i=this.parentWidget;document!=i;){if("onunload"in i){i.onunload=function(t){if(!0===e.fromSearch&&!0===e.transientSearch){n.publish("search.secondaryMenu:lastSearchResults",{})}};break}i=i.parentNode}this.searchView=UWA.createElement("div",{class:"searchView"}).inject(t);e=this;var s=new P({value:b.get("searchBtnLabel"),className:"primary"}),o=JSON.parse(A),a=Object.values(o).join(",");s.addEvent("onClick",function(){I.launchSearch({allowedTypes:a,role:"",criteria:A.type_act_physical,additionalQuery:"",bMultiSel:!0,in_apps_callback:e.onSelectedFromSearch.bind(e)})}),this.dropArea=document.createElement("div"),this.dropArea.className="lifecycle-main",this.droppableArea=document.createElement("div"),this.droppableArea.className="lifecycle-filter fonticon fonticon-3x fonticon-drag-drop";var l=UWA.Element("div",{class:"font-3ds-regular"});l.innerHTML=b.dropHere,this.droppableArea.appendChild(l),this.dropArea.appendChild(this.droppableArea),!0===this.droppable&&(this.dropArea.addEventListener("drop",function(t){e.onDrop(t)}),this.dropArea.addEventListener("dragover",function(t){e.onDragOver(t)}),this.dropArea.addEventListener("dragenter",function(t){e.onDragEnter(t)}),this.dropArea.addEventListener("dragleave",function(t){e.onDragLeave(t)})),this._LifecycleWidgetEmptyContent=new O({sentences:[{type:"drop",text:b.dropHere,DOMelement:e.dropArea},{type:"dom",DOMelement:s.getContent()}]}),this._LifecycleWidgetEmptyContent.inject(this.searchView),widget.endEdit=this.changeCurrentCredential.bind(this)},changeCurrentCredential:function(e){if(null!=e&&e.hasOwnProperty("submitted")&&e.submitted&&widget.hasPreference("xPref_CREDENTIAL")){var t=widget.getPreference("xPref_CREDENTIAL");if(t.defaultValue=t.value,widget.addPreference(t),widget.hasPreference("xPref_3DEXPERIENCE_PLATFORM")){var i=widget.getPreference("xPref_3DEXPERIENCE_PLATFORM");i.defaultValue=i.value,widget.addPreference(i),this.setTenant(i.value)}D.setOption(D.getTenant(),{defaultValue:t.value})}},_updateUI:function(e){e?this.searchView&&this.searchView.hide():this.searchView&&this.searchView.show()},updateObjectTitle:function(e,t){0==this.isMultiView()&&this.historyMultiPanel.updateObjectTitle(e,t)},refreshFromStack:function(e){var t=this;C.getSecurityContextPromise(this.tenant).then(function(i){t.refreshFromStackReq(e,i)})},refreshFromStackReq:function(e,t){var i,n=this,s=D.get3DSpaceWSUrl(this.tenant,"/resources/lifecycle/product/getAllValidObjFromStack",null),o=this.getAttributesId(),a=null,l=[];if(null!=e&&e.length>0){for(i=0;i<e.length;i++){var r=e[i];null!=r&&r.hasOwnProperty("id")&&void 0!==r.id&&null!==r.id?l.push(r.id):l.push(r)}a={data:l,attributes:o}}y.authenticatedRequest(s,{type:"json",method:"POST",proxy:"passport",data:UWA.Json.encode(a),headers:D.getHeaders(t),onComplete:function(e){var t=e.results;if(null==t||0==t.length)n.empty();else{var i,s=[],o=!1,a=!0;for(i=0;i<t.length;i++)"#DENIED!"==t[i].owner?o=!0:(a=!1,t[i].tenant=n.tenant,s.push(t[i]),n.fixImagePath(t[i],n.tenant));var l={evintID:"warning",msg:b.someObjectsNotFound},r={evintID:"warning",msg:b.allObjectsNotFound};!0===a?(this.displayNotification(r),n.empty()):!0===o?(this.displayNotification(l),n.objects=[],n.updateObjects(s),n.updateCommands()):(n.objects=[],n.updateObjects(s),n.updateCommands())}},onFailure:function(e){console.log("refreshFromStack: Failure..."+e)},onTimeout:function(){console.log("refreshFromStack: A connection timeout occured.")}})},getExtendedStack:function(){return this.isMultiView()||void 0!==this.modelPIDs&&0!=this.modelPIDs.length?(this.historyMultiPanel&&(this.historyMultiPanel.destroy(),this.historyMultiPanel=null,this.externalRefresh&&(this.externalRefresh.done(),this.externalRefresh=null)),this.maturityWidget&&(this.maturityWidget.destroy(),this.maturityWidget=null),this.stack=this.modelPIDs):this.stack=[this.historyMultiPanel.revisionFamily.currentObject],this.stack},refresh:function(){var e=widget.getValue("Custo_roots_pids");widget.data&&(widget.data.appId="ENOLCMI_AP"),"[]"!=e&&this.refreshFromStack(this.getExtendedStack())},setTenant:function(e){if(this.tenant=e,widget.setValue("x3dPlatformId",e),D.setTenant(e),widget.hasPreference("xPref_3DEXPERIENCE_PLATFORM")){var t=widget.getPreference("xPref_3DEXPERIENCE_PLATFORM");t.defaultValue=e,t.value=e,widget.addPreference(t)}},removeContextMenu:function(e){var t=null;if(0!=this.objects.length){!1===this.isMultiView()?this.maturityWidget&&this.maturityWidget.elements&&(t=this.maturityWidget.elements.container):this.multiContent&&(t=this.multiContent);var i=document.createEvent("MouseEvents");i.initMouseEvent("mousedown",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),t&&t.dispatchEvent(i)}},onDrop:function(e){e.preventDefault(),this.removeContextMenu(e),this.selectedNodes=[],this.selectedNodesPID=[],this.selectedNodesObjects=[];for(var t=0,i=UWA.is(e.dataTransfer.types.indexOf,"function")?"indexOf":"contains",n="",s=["text/searchitems","text/plain","Text"],o=0;o<s.length&&""===n;o++){var a=e.dataTransfer.types[i](s[o]);(UWA.is(a,"number")&&a>=0||UWA.is(a,"boolean")&&!0===a)&&(n=s[o])}""!==n&&(t=e.dataTransfer.getData(n));var l,r,c,d=JSON.parse(t),u=D.getOption(d.data.items[0].envId,null),h=!1;if(D.getTenant()!=d.data.items[0].envId&&0===this.objects.length){if(u){this.setTenant(d.data.items[0].envId),this.setCurrentWidgetPreferences();var p={eventID:"info",msg:b.currentPlatformHasChanged+d.data.items[0].envId+".\n"+b.currentSecurityContextHasChanged+this.getNLSCredential(widget.getValue("xPref_CREDENTIAL"))}}else p={eventID:"warning",msg:b.NoAccessToTenant+d.data.items[0].envId};this.displayNotification(p)}else if(D.getTenant()!=d.data.items[0].envId&&this.objects.length>0){h=!0;p={eventID:"warning",title:b.multipleTenantSelectionTitle,subtitle:b.multipleTenantSelectionSubtitle};this.displayNotification(p)}this.externalRefresh&&this.externalRefresh.setTenant(this.tenant);var m=[],f=!1,g=!1;for(l=0;l<d.data.items.length;l++)r=d.data.items[l].serviceId,c=d.data.items[l].objectId,"3dplan"===r?f=!0:0===c.indexOf("swym:")?g=!0:h||m.push(d.data.items[l]);if(!0===f){p={eventID:"warning",msg:b.PlanNotSupported};this.displayNotification(p)}if(!0===g){p={eventID:"warning",msg:b.nonCollabSpaceObject};this.displayNotification(p)}if(u){var y,v=0;this.objects&&(v=this.objects.length);var C=[],S=this.objectsPID;for(y=0;y<m.length;y++){var w=m[y].objectId,N={physicalid:w,displayName:m[y].displayName,objectType:m[y].objectType,serviceId:r};v>0?-1==S.indexOf(w)&&C.push(N):C.push(N)}var I=(C=this.removeBlacklistedTypes(C)).length;if(v<2&&I>0){if(this._actionBar){this.actionBarReady=!1;try{this._actionBar.destroy()}catch(e){console.error(e)}}this._actionBar=null}if(I>0){var P=this.isCID(this.objects)||this.isCID(C);this.buildDataPresenter(I+v,P),v>0?this.setObjectsAdd(C):this.setObjects(C)}}},addNewObject:function(e){var t,i=0;this.objects&&(i=this.objects.length);var n=[],s=this.objectsPID;for(t=0;t<droppedObject.data.items.length;t++){var o={physicalid:e=droppedObject.data.items[t].objectId,displayName:droppedObject.data.items[t].displayName,objectType:validObjects[t].objectType};i>0?-1==s.indexOf(e)&&n.push(o):n.push(o)}var a=(n=this.removeBlacklistedTypes(n)).length;if(i<2&&a>0){if(this._actionBar){this.actionBarReady=!1;try{this._actionBar.destroy()}catch(e){console.error(e)}}this._actionBar=null}if(a>0){var l=this.isCID(this.objects)||this.isCID(n);this.buildDataPresenter(a+i,l),i>0?this.setObjectsAdd(n):this.setObjects(n)}},addNewObject1:function(e){var t,i=0;this.objects&&(i=this.objects.length);var n=[],s=this.objectsPID,o=e.data.items;for(t=0;t<o.length;t++){var a=o[t],l={physicalid:a.objectId,displayName:a.displayName,objectType:a.objectType};i>0?-1==s.indexOf(a.objectId)&&n.push(l):n.push(l)}var r=(n=this.removeBlacklistedTypes(n)).length;i<2&&r>0&&(this._actionBar=null),r>0&&(this.buildDataPresenter(r+i),i>0?this.setObjectsAdd(n):this.setObjects(n))},getENONewContext:function(){return Q.LCwidgetContext||(Q.LCwidgetContext=this),Q},getNLSCredential:function(e){var t=e,i=widget.getPreference("xPref_CREDENTIAL");if(i&&i.options)for(var n=i.options,s=0;s<n.length;s++)if(n[s].value==e){t=n[s].label;break}return t},onDragOver:function(e){e.preventDefault()},onDragEnter:function(e){e.preventDefault()},onDragLeave:function(e){e.preventDefault()},removeBlacklistedTypes:function(e,t){var i,n=[],s=e.length,o=!1;for(i=0;i<s;i++)if(S.isBlacklisted(e[i].objectType))o=!0;else{var a=t?t[e[i].physicalid]:void 0;a&&(e[i].serviceId=a),n.push(e[i])}if(!0===o){if(1===s)var l={eventID:"warning",msg:b.objectTypeNotSupported};else l={eventID:"warning",msg:b.someObjectTypesNotSupported};this.displayNotification(l)}return n},incrementalValidObjAtt:function(e){var t=this;C.getSecurityContextPromise(this.tenant).then(function(i){t.incrementalValidObjAttReq(e,i)})},fixImagePath:function(e,t){var i,n=D.get3DSpaceBaseUrl(t),s=e.options.icons,o=s.length,a=[];for(i=0;i<o;i++){var l=s[i];l&&l.startsWith("/")&&(l=n+l),a.push(l)}e.options.icons=a},incrementalValidObjAttReq:function(e,t){var i=this,n=D.get3DSpaceWSUrl(this.tenant,"/resources/lifecycle/product/getAllValidObjFromStack",null),s={data:e,attributes:i.getAttributesId()};y.authenticatedRequest(n,{type:"json",method:"POST",proxy:"passport",data:UWA.Json.encode(s),headers:D.getHeaders(t),onComplete:function(e){var t=e.results;if(null==t||0==t.length)i.empty();else{var n,s=[];for(n=0;n<t.length;n++)"#DENIED!"==t[n].owner||(t[n].tenant=i.tenant,s.push(t[n]),i.fixImagePath(t[n],i.tenant));i.incrementalValidObjectsAttributes(s)}},onFailure:function(e){console.log("incrementalValidObjAttReq: Failure..."+e)},onTimeout:function(){console.log("incrementalValidObjAttReq: A connection timeout occured.")}})},removeValidObj:function(e){var t,i=e.length,n=(D.get3DSpaceBaseUrl(this.tenant),[]);for(t=0;t<i;t++){var s=e[t],o=this.objectsPID.indexOf(s);if(o>=0){this.objects.splice(o,1),this.objectsPID.splice(o,1),this.objectsLID.splice(o,1);var a=this.stack.indexOf(s);a>=0&&this.stack.splice(a,1),this.removeSelectedPID(s);var l=this.modelPIDs.indexOf(s);n.push(l)}}for(t=0;t<i;t++){s=e[t],l=this.modelPIDs.indexOf(s);this.modelPIDs.splice(l,1)}this.removeModelObjects(s,n);var r=JSON.stringify(this.objects);widget.setValue("Custo_roots_pids",r),0==this.objects.length&&this.searchView.show()},updateValidObjAtt:function(e){var t=this;C.getSecurityContextPromise(this.tenant).then(function(i){t.updateValidObjAttReq(e,i)})},updateValidObjAttReq:function(e,t){var i=this,n=D.get3DSpaceWSUrl(this.tenant,"/resources/lifecycle/product/getAllValidObjFromStack",null),s={data:e,attributes:i.getAttributesId()};y.authenticatedRequest(n,{type:"json",method:"POST",proxy:"passport",data:UWA.Json.encode(s),headers:D.getHeaders(t),onComplete:function(e){var t=[],n=e.results;if(null==n||0==n.length)i.empty();else{var s,o=[];for(s=0;s<n.length;s++)if("#DENIED!"==n[s].owner){if(!0!==i.isMultiView()){o=[],t=[];break}t.push(n[s].objectId)}else n[s].tenant=i.tenant,o.push(n[s]),i.fixImagePath(n[s],i.tenant);o.length+t.length>0?i.updateValidObjectsAttributes(o):i.empty()}t.length>0&&i.removeObjects(t)},onFailure:function(e){console.log("updateValidObjAttReq: Failure..."+e)},onTimeout:function(){console.log("updateValidObjAttReq: A connection timeout occured.")}})},updateValidObjectsAttributes(e){var t,i=e.length,n=D.get3DSpaceBaseUrl(this.tenant);for(t=0;t<i;t++){var s=e[t],o=s.physicalid,a=this.objectsPID.indexOf(o);a>=0&&(this.objects[a]=s);var l=this.selectedNodesPID.indexOf(o);if(l>=0){this.selectedNodesObjects[l]=s;var r=new m(s);this.selectedNodes[l]=r}var c=this.modelPIDs.indexOf(o);c>=0&&this.replaceModelObject(s,c,n)}var d=JSON.stringify(this.objects);widget.setValue("Custo_roots_pids",d)},incrementalValidObjectsAttributes(e){var t,i=e.length,n=D.get3DSpaceBaseUrl(this.tenant);for(t=0;t<i;t++){var s=e[t],o=s.physicalid;this.objects.push(s),this.objectsPID.push(o),this.objectsLID.push(s.logicalid),this.stack.push(o),s.tenant=this.tenant,this.addModelObject(s,n)}var a=JSON.stringify(this.objects);widget.setValue("Custo_roots_pids",a)},updateObjectAtttributes:function(e){if(this.objects.length>1||0==this.isMultiView()){var t,i=[],n=e.length;for(t=0;t<n;t++){var s=e[t];this.objectsPID.indexOf(s)>=0&&i.push(s)}i.length>0&&this.updateValidObjAtt(i)}},removeObjects:function(e){if(this.objects.length>1||1==this.objects.length&&this.isMultiView()){var t,i=[],n=e.length;for(t=0;t<n;t++){var s=e[t];this.objectsPID.indexOf(s)>=0&&i.push(s)}i.length>0&&this.removeValidObj(i),1==this.objects.length&&this.reloadSavedObjects()}},addObjects:function(e){if(this.objects.length>1||!0===this.isMultiView()){var t,i=[],n=e.length;for(t=0;t<n;t++){var s=e[t];"Revise"!=s.operation&&"Branch"!=s.operation&&"Duplicate"!=s.operation||0<=this.objectsPID.indexOf(s.sourceObjectId)&&i.push(e[t].physicalid)}i.length>0&&this.incrementalValidObjAtt(i)}},updateObjectsAdd:function(e,t,i){if(e&&0!==e.length){var n=!1;if(this.objects&&this.objects.length>0&&(n=!0),0!==(e=this.removeBlacklistedTypes(e)).length){if(e&&1==e.length&&!1===n&&!1===this.isMultiView()){try{this.historyMultiPanel.setObjects(e,t,i)}catch(e){}try{this.maturityWidget.setObjects(e)}catch(e){console.log("updateObject Error: "+e)}this.updateLifecycleWidget(e)}else this.buildModel(this.objects,e),!0===n?this.updateLifecycleWidgetAdd(e):this.updateLifecycleWidget(e);var s=JSON.stringify(this.objects);widget.setValue("Custo_roots_pids",s)}}},updateObjects:function(e,t,i){if(e&&0!==e.length&&0!==(e=this.removeBlacklistedTypes(e)).length){if(e&&1==e.length&&!1===this.isMultiView()){try{this.historyMultiPanel.setObjects(e,t,i)}catch(e){}try{this.maturityWidget.setObjects(e)}catch(e){console.log("updateObject Error: "+e)}this.updateLifecycleWidget(e)}else this.buildModel(this.objects,e),this.updateLifecycleWidget(e);var n=JSON.stringify(this.objects);widget.setValue("Custo_roots_pids",n)}},updateLifecycleWidget:function(e){var t,i=this;for(i.objects=e,i.objectsPID=[],t=0;t<e.length;t++)i.objectsPID.push(e[t].physicalid),i.objectsLID.push(e[t].logicalid);if(1==e.length&&i.isMultiView()?i.setTitleFromObject(e[0]):i.setTitle(b.lifecycleTitle),i.setSelectedNodes(e),-1===i.stack.indexOf(e[0].physicalid)){var n;i.stack=[].concat(i.objectsPID);var s=[];for(n=0;n<e.length;n++)s.push(e[n].physicalid);i.stack=s}if(0!=i.autolaunch.localeCompare("")){switch(i.fromSearch=!0,i.autolaunch){case"LifecycleDelete":i._actionBar&&(i.actionBarReady?i.runDeleteCommand():i._actionBar.onActionBarReady(function(){var e=g.getCommand("MaturityHdr",i);e&&(0==i.isMultiView()?e.setShouldEnable(!1):e.setShouldEnable(!0)),(e=g.getCommand("HistoryHdr",i))&&(0==i.isMultiView()?e.setShouldEnable(!1):e.setShouldEnable(!0)),(e=g.getCommand("TilesLayoutCmdHdr",i))&&(0==i.isMultiView()?e.setShouldEnable(!1):e.setShouldEnable(!0)),(e=g.getCommand("LargeTilesLayoutCmdHdr",i))&&(0==i.isMultiView()?e.setShouldEnable(!1):e.setShouldEnable(!0)),(e=g.getCommand("ThumbnailsLayoutCmdHdr",i))&&(0==i.isMultiView()?e.setShouldEnable(!1):e.setShouldEnable(!0)),i.updateCommands(),i.runDeleteCommand(),i.actionBarReady=!0,console.log("onActionBarReady called when trying to autolaunch, line 1453")}))}i.autolaunch=""}},updateLifecycleWidgetAdd:function(e){this.objects=[].concat(this.objects,e),this.setTitle(b.lifecycleTitle);var t,i=[],n=[];for(t=0;t<e.length;t++)i.push(e[t].physicalid),n.push(e[t].logicalid);this.objectsPID=[].concat(this.objectsPID,i),this.objectsLID=[].concat(this.objectsLID,n),this.setSelectedNodes(e),this.stack=[].concat(this.stack,i)},setTitleFromObject:function(e){var t=e.displayName||e["attribute[PLMEntity.V_Name]"];if(e["attribute[Marketing Name]"]&&(t=e["attribute[Marketing Name]"]),e&&t){if("OnPremise"==widget.getValue("x3dPlatformId")||void 0===widget.getValue("x3dPlatformId"))this.setTitle(t+" "+e.revision);else{var i=D.getOption("platform_services"),n=widget.getValue("x3dPlatformId"),s=n;if(null!=i&&Array.isArray(i)&&i.length>0)for(const e of i)if(null!=e&&e.hasOwnProperty("platformId")&&e.platformId===n){s=e.displayName;break}widget.getPreference("xPref_CREDENTIAL").value;var o=widget.getPreference("xPref_CREDENTIAL").options,a="";if(e.hasOwnProperty("project")&&void 0!==e.project&&null!==e.project&&e.project.trim().length>0){var l=e.project;if(null!=o&&Array.isArray(o))for(const e of o){var r=e.value;if(r.slice(r.lastIndexOf(".")+1)==l){a=e.label.substring(0,e.label.indexOf("●")).trim();break}}}this.setTitle(a+" - "+t+" - "+e.revision+" ("+s+")")}this.selectedNodes&&this.selectedNodes[0]&&this.selectedNodes[0].object&&!this.selectedNodes[0].object.displayName&&(this.selectedNodes[0].object.displayName=t)}},setTitle:function(e){this.widget.setTitle(e)},updateIterationsCommand:function(e){var t=g.getCommand("IterationsHdr",this);if(null!=t)if(1==e.length){var i=e[0];"CATPart"==i.type||"3DShape"==i.type?t.enable():t.disable()}else t.disable()},updateCommands:function(){var e=this;this.app="lifecycle",(t=g.getCommand("MaturityHdr",o))&&(0==e.isMultiView()?t.setShouldEnable(!1):t.setShouldEnable(!0)),(t=g.getCommand("HistoryHdr",o))&&(0==e.isMultiView()?t.setShouldEnable(!1):t.setShouldEnable(!0)),(t=g.getCommand("TilesLayoutCmdHdr",o))&&(0==o.isMultiView()?t.setShouldEnable(!1):t.setShouldEnable(!0)),(t=g.getCommand("LargeTilesLayoutCmdHdr",o))&&(0==o.isMultiView()?t.setShouldEnable(!1):t.setShouldEnable(!0)),(t=g.getCommand("ThumbnailsLayoutCmdHdr",o))&&(0==o.isMultiView()?t.setShouldEnable(!1):t.setShouldEnable(!0)),w.dispatchEvent("LC_CmdMgr_UpdateUI",{getSelectedNodes:function(){var t,i=e.getSelectedNodes(),n=[];if(i.length>0)for(t=0;t<i.length;t++)i[t].object&&n.push(i[t].object);return n}});var t,i=(o=this).getSelectedNodes(),n=o.isCID(i);if(1===i.length){var s=i[0].type;-1!==["Workspace","Workspace Vault","Personal Workspace","Folder"].indexOf(s)&&!0}if((t=g.getCommand("CompareHdr",o))&&t.enable(),o.disableIfCID(t,n),(t=g.getCommand("ActionBar_Attributes",o))&&o.disableIfNoneSelected(t,i.length),(t=g.getCommand("Properties",o))&&t.setCommandAvailability(t.getEnableCmd()),(t=g.getCommand("CompareHdr",o))&&t.setCommandAvailability(t.getEnableCmd()),o.disableIfCID(t,n),(t=g.getCommand("ListSnapshotsHdr",o))&&t.setCommandAvailability(t.getEnableCmd()),o.disableIfCID(t,n),(t=g.getCommand("CreateSnapshotHdr",o))&&t.setCommandAvailability(t.getEnableCmd()),o.disableIfCID(t,n),(t=g.getCommand("ActionBar_ReserveCmd",o))&&o.disableIfNoneSelected(t,i.length),(t=g.getCommand("ActionBar_UnreserveCmd",o))&&o.disableIfNoneSelected(t,i.length),(t=g.getCommand("SubscribeHdr",o))&&o.disableIfNoneSelected(t,i.length),o.disableIfCID(t,n),(t=g.getCommand("UnSubscribeHdr",o))&&o.disableIfNoneSelected(t,i.length),o.disableIfCID(t,n),(t=g.getCommand("EditSubscribeHdr",o))&&o.disableIfNoneSelected(t,i.length),o.disableIfCID(t,n),(t=g.getCommand("ActionBar_ChangeOwner",o))&&o.disableIfNoneSelected(t,i.length),(t=g.getCommand("ActionBar_TransferOwnership",o))&&o.disableIfNoneSelected(t,i.length),(t=g.getCommand("ActionBar_AccessRightCmd",o))&&(o.disableIfNoneSelected(t,i.length),!window.__karma__&&"ActionBar_AccessRightCmd"===t._id)){var o=this,a=t;let e=B.loadCredentials(this.tenant);UWA.Promise.all([e,o.getSecurityContext]).then(e=>{e.length<2||!UWA.is(e[0],"array")?console.error("Missing credentials"):B.filterCredentials(this.tenant,e[0],"accessRight").then(e=>{e.length;0==e.length&&o.disableIfNoneSelected(a,0)}).catch(e=>{console.error("FAiled to call credential filter svc, error:",e),reject("checkAccessRole for ActionBar_AccessRightCmd failed...")})})}},disableIfNoneSelected:function(e,t){e&&(0===t?e.disable():e.enable())},disableIfOneObjOrNonSelected:function(e,t,i){e&&(0===t||i<=1?e.disable():e.enable())},disableIfOneObjOrNotOneSelected:function(e,t,i){e&&(0===t||i<=1||t>1?e.disable():e.enable())},disableIfMultiSelect:function(e){e&&this.isMultiView()&&e.disable()},disableIfNotMultiSelect:function(e){e&&0==this.isMultiView()&&e.disable()},disableIfCID:function(e,t){t&&e&&e.disable()},reportSelection:function(e){if(e.length>0){var t,i=[],n=(e.length,[]),s={},o=D.getTenant();C.getSecurityContext(D.getTenant(),function(a){for(t=0;t<e.length;t++){var l={type:e[t].type,label:e[t].displayName};s[e[t].physicalid]=l,n.push(e[t].physicalid),i.push({envId:o,serviceId:e[t].serviceId?e[t].serviceId:"3DSpace",contextId:a,objectId:e[t].physicalid,objectType:e[t].type,type:e[t].type,displayName:e[t].displayName})}var r={protocol:"3DXContent",version:"1.0",source:"ENOLCMI_AP",data:{items:i}};require(["DS/i3DXCompassServices/i3DXCompassPubSub"],function(e){e.publish("setX3DContent",r)}),1!=K&&1==e.length&&require(["DS/WidgetServices/commandProxy/CommandProxy"],function(e){var t={paths:[],attributes:{}},i=n;t.paths=[i],t.attributes=s,e.publishSelect({data:t})}),K=!1},function(e){console.log("reportSelection ",e)})}},setX3DContent:function(e){var t,i=[];if(e.length>0)for(t=0;t<e.length;t++){var n="";e[t].hasOwnProperty("tenant")&&(n=e[t].tenant);var s="";e[t].hasOwnProperty("sourceid")&&(s=e[t].sourceid),""===s&&(s=e[t].serviceId?e[t].serviceId:"3DSpace"),i.push({envId:n,serviceId:s,contextId:"",objectId:e[t].physicalid,objectType:e[t].type,displayName:e[t].displayName})}var o={protocol:"3DXContent",version:"1.0",source:"ENOLCMI_AP",data:{items:i}},a=new v.Socket("compassPageSocket");a.subscribeServer("com.ds.compass",window.parent),a.dispatchEvent("onSetX3DContent",o,"compassPageSocket")},addSelectedNode:function(e){var t=e._attributes.physicalid;if(-1==this.selectedNodesPID.indexOf(t)){var i=this.objectsPID.indexOf(t),n=this.objects[i];this.selectedNodesObjects.push(n),this.selectedNodesPID.push(t),this.selectedNodes.push(new m(n)),this.reportSelection(this.selectedNodesObjects),this.setX3DContent(this.selectedNodesObjects),this.updateCommands(),this.doPickContext(this.contextMenuObject,this.isOpenWithCatiaV5Available)}},removeSelectedNode:function(e){var t=e._attributes.physicalid;this.removeSelectedPID(t)},removeSelectedPID:function(e){var t=this.selectedNodesPID.indexOf(e);t>=0&&(this.selectedNodesPID.splice(t,1),this.selectedNodes.splice(t,1),this.selectedNodesObjects.splice(t,1),this.reportSelection(this.selectedNodesObjects),this.setX3DContent(this.selectedNodesObjects),this.updateCommands(),this.doPickContext(this.contextMenuObject,this.isOpenWithCatiaV5Available))},setSelectedNodes:function(e){this.reportSelection(e),this.setX3DContent(e);var t=this;this.selectNodes(e),t._actionBar&&(t._actionBar.onActionBarReady(function(){var e=t.isMultiView(),i=g.getCommand("MaturityHdr",t);i&&(0==e?i.setShouldEnable(!1):i.setShouldEnable(!0)),(i=g.getCommand("HistoryHdr",t))&&(0==e?i.setShouldEnable(!1):i.setShouldEnable(!0)),(i=g.getCommand("TilesLayoutCmdHdr",t))&&(0==e?i.setShouldEnable(!1):i.setShouldEnable(!0)),(i=g.getCommand("LargeTilesLayoutCmdHdr",t))&&(0==e?i.setShouldEnable(!1):i.setShouldEnable(!0)),(i=g.getCommand("ThumbnailsLayoutCmdHdr",t))&&(0==e?i.setShouldEnable(!1):i.setShouldEnable(!0)),t.updateCommands(),t.actionBarReady=!0,console.log("onActionBarReady called in setSelectedNodes, line 1775")}),t.updateCommands())},getSelectedNodes:function(){return this.selectedNodes},refreshView:function(e){},getObjectAttributes:function(e){var t=this,i=[];return t.attributeIncrement=t.startAttributeIncrement,new UWA.Class.Promise(function(n,s){C.getSecurityContextPromise(t.tenant).then(function(s){t.getObjectAttributesIncremental(e,i,s).then(function(e){n(e)}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})})},getObjectAttributesIncremental:function(e,t,i){var n=this;return new UWA.Class.Promise(function(s,o){n.getObjectAttributesReq(e,t,i).then(function(t){t.length==e.length?s(t):n.getObjectAttributesIncremental(e,t,i).then(function(e){s(e)})})})},getObjectAttributesReq:function(e,t,i){var n=this,s=t.length;return new UWA.Class.Promise(function(o,a){var l,r=n.getAttributesId(),c=e.length,d=c;c>s+n.attributeIncrement&&(d=s+n.attributeIncrement);var u=[];for(l=s;l<d;l++)u.push(e[l].physicalid);var h={data:u,attributes:r},p=D.get3DSpaceWSUrl(n.tenant,"/resources/lifecycle/product/getAllValidObjFromStack",null);y.authenticatedRequest(p,{type:"json",method:"POST",proxy:"passport",data:UWA.Json.encode(h),headers:D.getHeaders(i),onComplete:function(e){var i=e.results;if(i&&i.length>0){var s;for(s=0;s<i.length;s++)i[s].tenant=n.tenant,n.fixImagePath(i[s],n.tenant);t=t.concat(i),o(t)}else{var a={eventID:"error",msg:b.objectNotFound};n.displayNotification(a)}},onFailure:function(e,t,i){if(null!=t&&t.hasOwnProperty("error")&&void 0!==t.error&&null!==t.error&&t.error.trim().length>0){var s=t.error;if(s.contains("1501009")||s.contains("1500178")){var o={eventID:"error",msg:b.invalidCredential};n.displayNotification(o)}}a("getAttributeList:Failure..."+e)},onTimeout:function(){n.attributeIncrement>n.minimumAttributeIncrement&&(n.attributeIncrement=n.attributeIncrement/2,o(t)),a("getObjectAttributesReq: A connection timeout occured.")}})})},getAttributesId:function(){var e=[];return e.push("owner"),e.push("project"),e.push("organization"),e.push("revision"),e.push("current"),e.push("physicalid"),e.push("logicalid"),e.push("type"),e.push("name"),e.push("locker"),e.push("majorid"),e.push("minorrevision"),e.push("majorrevision"),e.push("versionid"),e.push("policy"),e.push("attribute[Marketing Name]"),e.push("attribute[DOCUMENTS.Title]"),e.push("attribute[Title]"),e.push("attribute[PLMEntity.PLM_ExternalID]"),e.push("attribute[PLMEntity.V_usage]"),e.push("attribute[PLMEntity.V_Name]"),e.push("attribute[PLMReference.V_DerivedFrom]"),e.push("attribute[PLMReference.V_fromExternalID]"),e.push("attribute[PLMReference.V_isLastVersion]"),e.push("attribute[PLMCoreRepReference.V_isOnceInstantiable]"),e.push("attribute[XCADEmbeddedCmp.V_IsEmbeddedComponent]"),e.push("tenant"),e},setObjects:function(e){var t={};if(0!==(e=this.removeBlacklistedTypes(e)).length){for(var i=0;i<e.length;i++)t[e[i].physicalid]=e[i].serviceId;this._updateUI(!0);var n=this;this.getObjectAttributes(e).then(function(i){var s=0,o=[],a=[];for(s=0;s<i.length;s++)"#DENIED!"==i[s].owner?o.push(i[s].objectId):a.push(i[s]);if(o.length>0&&0==n.isMultiView()&&(a=[]),null==a||0==a.length){var l,r=[];if(n.stack.length>0)for(l=0;l<n.stack.length;l++){var c=n.stack[l];c&&r.push(c)}if(r.length>0){if(n.refreshFromStack(r),o.length>0){var d={eventID:"warning",msg:1==o.length?b.objectNotFound:b.allObjectsNotFound};n.displayNotification(d)}}else{n.empty();d={eventID:"warning",msg:b.objectNotFound};n.displayNotification(d),n.clearView(n)}}else{if(0===(e=n.removeBlacklistedTypes(i,t)).length)return;n.updateObjects(e,!1,!1),o.length>0&&n.removeObjects(o)}})}},setObjectsAdd:function(e){if(0!==(e=this.removeBlacklistedTypes(e)).length){this._updateUI(!0);var t=this;this.getObjectAttributes(e).then(function(i){var n=0,s=[],o=[];for(n=0;n<i.length;n++)"#DENIED!"==i[n].owner?s.push(i[n].objectId):o.push(i[n]);if(null==o||0==o.length){var a,l=[];if(t.stack.length>0)for(a=0;a<t.stack.length;a++){var r=t.stack[a];r&&l.push(r)}if(l.length>0){if(t.refreshFromStack(l),s.length>0){var c={eventID:"warning",msg:1==s.length?b.objectNotFound:b.allObjectsNotFound};t.displayNotification(c)}}else{t.empty();c={eventID:"warning",msg:b.objectNotFound};t.displayNotification(c),t.clearView(t)}}else{if(0===(e=t.removeBlacklistedTypes(o)).length)return;if(t.updateObjectsAdd(e,!1,!1),s.length>0){c={eventID:"warning",msg:b.someObjectsNotIncluded};t.displayNotification(c)}}})}},setObjectsWithExceptions:function(e,t,i){var n={};e=this.removeBlacklistedTypes(e);for(var s=0;s<e.length;s++)n[e[s].physicalid]=e[s].serviceId;var o=this;this.getObjectAttributes(e).then(function(e){var s=0,a=[],l=[],r=[];for(s=0;s<e.length;s++){var c=e[s].objectId;1==o.isMultiView()?o.objectsPID.indexOf(c)>=0&&(r.push(e[s]),"#DENIED!"==e[s].owner?a.push(c):l.push(e[s])):"#DENIED!"!=e[s].owner&&(l.push(e[s]),r.push(e[s]))}if(r.length>0&&0==l.length&&(r=[]),r.length>0)l.length>0&&(r=o.removeBlacklistedTypes(r,n),o.updateObjects(r,t,i)),a.length>0&&o.removeObjects(a);else if(a.length>0){d=1==a.length?{errorMsg:b.objectNotFound}:{errorMsg:b.allObjectsNotFound},o.maturityWidget.displayError(d),a.length>0&&o.empty()}else if(0==o.isMultiView()&&o.objectsPID.length>0){o.historyMultiPanel.revisionFamily.displayError(b.noObject);var d={errorMsg:b.noObject};o.maturityWidget.displayError(d)}else if(0==o.isMultiView()){var u={eventID:"warning",msg:b.objectNotFound};o.displayNotification(u)}})},displayNotification:function(e){f.displayNotification(e)},empty:function(){var e=this;e.stack=[],e.selectedNodes=[],e.selectedNodesPID=[],e.selectedNodesObjects=[],e.objects=[],e.objectsPID=[],e.objectsLID=[],e.model=new h,e.modelPIDs=[],e.containerResponsiveThumbnailOrTile=null,require(["DS/i3DXCompassServices/i3DXCompassPubSub"],function(e){e.publish("resetObject"),e.publish("resetX3DContent");var t=UWA.is(widget.getValue("X3DContentId"),"string")?JSON.parse(widget.getValue("X3DContentId")):null;UWA.is(t)&&UWA.is(t.data)&&(t.data.items=[],widget.setValue("X3DContentId",JSON.stringify(t))),widget.setValue("Custo_roots_pids","[]")}),require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"],function(t){e.CAJson={},t.get2(function(t){e.CAJson=t}),e.setTitle(b.lifecycleTitle),e.updateCommands(),e._actionBar&&(e._actionBar.destroy(),e._actionBar=null),e.actionBarReady=!1,0==e.isMultiView()&&(e.historyMultiPanel&&(e.historyMultiPanel.destroy(),e.historyMultiPanel=null,e.externalRefresh&&(e.externalRefresh.done(),e.externalRefresh=null)),e.maturityWidget&&(e.maturityWidget.destroy(),e.maturityWidget=null));var i=e.elements.container.querySelector(".mainDiv_container");i&&i.parentNode.removeChild(i),e.searchView&&e.searchView.show()})},gotSavedObjects:function(){if(widget.getValue("Custo_roots_pids")&&null==this.addinmode){if(1==this.odtMode)return!0;var e=JSON.parse(widget.getValue("Custo_roots_pids"));if("undefined"!==e&&null!==e&&e.length>0)return!0}return!1},reloadSavedObjects:function(){if(this.gotSavedObjects()){var e,t=null;t=1==this.odtMode?widget.getValue("Custo_roots_pids"):JSON.parse(widget.getValue("Custo_roots_pids"));var i=[];for(e=0;e<t.length;e++){var n=t[e].serviceId,s=t[e].type,o={physicalid:t[e].physicalid,displayName:t[e].displayName,serviceId:n,type:s,tenant:t[e].tenant};i.push(o)}var a=t[0].tenant;null!=a&&null!=a&&a.trim().length>0&&this.setTenant(t[0].tenant),this.externalRefresh&&this.externalRefresh.setTenant(this.tenant);var l=i.length;if(l>0){if(this._actionBar){this.actionBarReady=!1;try{this._actionBar.destroy()}catch(e){console.error(e)}}this._actionBar=null}this.buildDataPresenter(l,this.isCID(i)),this.setObjects(i)}else widget.addPreference({name:"Custo_roots_pids",type:"hidden",defaultValue:"[]"})},useCompassContent:function(){if(!this.gotSavedObjects()){var e=void 0!==this.widget.getValue("X3DContentId")?JSON.parse(widget.getValue("X3DContentId")):null;if(null!==e){var t=e.data;if(e.hasOwnProperty("commandId")&&(this.autolaunch=e.commandId),e.hasOwnProperty("widgetId")&&0===e.widgetId.indexOf("preview")&&(this.transientSearch=!0),null!==t){var i=[],n=[];if(t.items.length>0){var s,o=t.items.length;for(s=0;s<o;s++){null!==(a=t.items[s]).objectId&&void 0!==a.objectId&&n.push(a)}for(this.setTenant(n[0].envId),this.externalRefresh&&this.externalRefresh.setTenant(this.tenant),o=n.length,s=0;s<o;s++){var a,l={physicalid:(a=n[s]).objectId};null!==a.displayName&&void 0!==a.displayName&&(l.displayName=a.displayName),null!==a.objectType&&void 0!==a.objectType&&(l.objectType=a.objectType),i.push(l)}}if((i=this.removeBlacklistedTypes(i)).length>0){var r=i.length;this.buildDataPresenter(r,this.isCID(i)),this.setObjects(i)}}}}},onSelectedFromSearch:function(e){this.clearAllSelectedNodes();var t,i=0;this.objects&&(i=this.objects.length);var n=[],s=this.objectsPID;for(t=0;t<e.length;t++){var o=e[t].id,a={physicalid:o,type:e[t]["ds6w:type"],displayName:e[t]["ds6w:label"],sourceid:e[t].sourceid};i>0?-1==s.indexOf(o)&&n.push(a):n.push(a)}var l=(n=this.removeBlacklistedTypes(n)).length;if(1==this.isMultiView()){if(this._actionBar){this.actionBarReady=!1;try{this._actionBar.destroy()}catch(e){console.error(e)}}this._actionBar=null}if(l>0){var r=this.isCID(this.objects)||this.isCID(n);this.buildDataPresenter(l+i,r),i>0?this.setObjectsAdd(n):this.setObjects(n)}},createLifecycleDiv:function(){var e,t=this,i=null;if(t.elements&&t.elements.container?i=t.elements.container.querySelector(".lifecycle"):t.buildSkeleton(),i){!function(e){for(var t=e;e.hasChildNodes();)t.hasChildNodes()?t=t.lastChild:(t=t.parentNode).removeChild(t.lastChild)}(i),i.parentNode.removeChild(i)}if(this.searchView&&this.searchView.hide(),i=t.elements.container.querySelector(".mainDiv_container"))(e=this.lifecycleDiv=document.createElement("div")).className="lifecycle",e.style.display="table";else{z=UWA.createElement("div",{class:"mainDiv_container"}),(e=this.lifecycleDiv=document.createElement("div")).className="lifecycle",e.style.display="table",this.elements.container.appendChild(z),J=UWA.createElement("div",{class:"rightPanelDiv_container"}),q=UWA.createElement("div",{class:"centerPanelDiv_container"});var n=UWA.createElement("div",{class:"toolbar"});z.appendChild(n);var s=UWA.createElement("div",{class:"floatcontainer"});n.appendChild(s);var o=UWA.createElement("div",{class:"information-panel panel-icon-wrapper"});s.appendChild(o);var a=UWA.createElement("span",{class:"fonticon fonticon-2x fonticon-info"});o.appendChild(a),this.infoPanel=o,new H({target:a,body:"Information",position:"bottom"}).elements.container.style.zIndex=99999,o.addEventListener("click",function(e){var i=t.infoPanel,n=!1;if(i){i=i.getElement(".fonticon");i.classList.contains("selected")?(n=!0,i.classList.remove("selected")):(n=!1,i.classList.add("selected"))}n?(!1,t.modelEvents.publish({event:"LifecycleWidget-info-panel-close"})):(!0,t.modelEvents.publish({event:"LifecycleWidget-info-panel-open"}))})}(q.appendChild(e),i)||((X=new T).init({left:{resizable:!0,originalSize:240,originalState:"close",overMobile:!0},right:{resizable:!0,originalState:"close",overMobile:!0,autoCloseFlag:!0},borderRight:!0,borderLeft:!0,withtransition:!0},null,q,J),X.inject(z),X._container.getElementsByClassName("triptych-close-right fonticon fonticon-wrong")[0].hidden=!0);return e},isCID:function(e){var t=!1,i=e.length;if(i>0)if(e[0].physicalid){for(var n=0;n<i;n++)if(0===e[n].physicalid.indexOf("cid:")){t=!0;break}}else if(e[0].object&&e[0].object.physicalid)for(n=0;n<i;n++)if(0===e[n].object.physicalid.indexOf("cid:")){t=!0;break}return t},isCIDinPIDList:function(e){for(var t=!1,i=e.length,n=0;n<i;n++)if(0===e[n].indexOf("cid:")){t=!0;break}return t},isMultiView:function(){return!this.historyMultiPanel},buildDataPresenter:function(e,t){var i=this;if(!1===i.secretMultiViewFlagCheck)return new UWA.Class.Promise(function(n,s){C.getSecurityContextPromise(i.tenant).then(function(n){i.getNoSingleObjectModePromise(e,t,n),["catch"](function(e){console.log(e)})}).catch(function(e){console.log(e)})});i.buildDataPresenterReq(e,t)},getNoSingleObjectModePromise:function(e,t,i){var n=this;return new UWA.Class.Promise(function(s,o){var a=D.get3DSpaceWSUrl(n.tenant,"/resources/lifecycle/util/getExpression",null);y.authenticatedRequest(a,{type:"json",method:"GET",proxy:"passport",headers:D.getHeaders(i),data:{expression:"LifecycleExpressionNoSingleObjectMode"},onComplete:function(i){i.hasOwnProperty("result")?"true"===i.result?(n.secretMultiViewFlag=!0,n.secretMultiViewFlagCheck=!0):(n.secretMultiViewFlag=!1,n.secretMultiViewFlagCheck=!0):(n.secretMultiViewFlag=!1,n.secretMultiViewFlagCheck=!0);n.buildDataPresenterReq(e,t)},onFailure:function(i,s,o){if(null!=s&&s.hasOwnProperty("error")&&void 0!==s.error&&null!==s.error&&s.error.trim().length>0){var a=s.error;if(a.contains("1501009")||a.contains("1500178")){var l={eventID:"error",msg:b.invalidCredential};n.displayNotification(l)}}console.log("getNoSingleObjectModeReq:Failure..."+i),n.buildDataPresenterReq(e,t)},onTimeout:function(){console.log("getNoSingleObjectModeReq: A connection timeout occured."),n.buildDataPresenterReq(e,t)}})})},buildDataPresenterReq:function(e,t){var i=this,n=i.createLifecycleDiv();if(i.historyMultiPanel&&(i.historyMultiPanel.destroy(),i.historyMultiPanel=null,this.externalRefresh&&(this.externalRefresh.done(),this.externalRefresh=null)),i.maturityWidget&&(i.maturityWidget.destroy(),i.maturityWidget=null),1===e?void 0!==i.addinmode||!0===i.secretMultiViewFlag?i.buildCollectionView(n):i.buildMaturityGraph(n):e>1&&i.buildCollectionView(n),!i._actionBar)if(this.collabsharing)this._actionBar=new o({context:i,file:"lifecycle_fromlifecycle_cs.xml",module:"LifecycleWidget"}).inject(globalDiv),this._actionBar&&(this._actionBar.elements.container.setStyle("position","sticky"),this._actionBar.elements.container.setStyle("z-index","4006")),this._actionBar.onActionBarReady(function(){var e=g.getCommand("MaturityHdr",i);e&&(0==i.isMultiView()?e.setShouldEnable(!1):e.setShouldEnable(!0)),(e=g.getCommand("HistoryHdr",i))&&(0==i.isMultiView()?e.setShouldEnable(!1):e.setShouldEnable(!0)),(e=g.getCommand("TilesLayoutCmdHdr",i))&&(0==i.isMultiView()?e.setShouldEnable(!1):e.setShouldEnable(!0)),(e=g.getCommand("LargeTilesLayoutCmdHdr",i))&&(0==i.isMultiView()?e.setShouldEnable(!1):e.setShouldEnable(!0)),(e=g.getCommand("ThumbnailsLayoutCmdHdr",i))&&(0==i.isMultiView()?e.setShouldEnable(!1):e.setShouldEnable(!0)),i.updateCommands(),console.log("onActionBarReady called when trying to autolaunch, line 1453"),i.actionBarReady=!0}),this.dispatchEvent("actionBarCreated",{});else{i._actionBar=new o({context:i,file:"lifecycle_fromlifecycle.xml",module:"LifecycleWidget"}),null!==this.lifecycleDiv&&void 0!==this.lifecycleDiv&&(this._actionBar.inject(z),this._actionBar&&(this._actionBar.elements.container.setStyle("position","fixed"),this._actionBar.elements.container.setStyle("z-index","4006"))),this._actionBar.onActionBarReady(function(){var e=g.getCommand("MaturityHdr",i);e&&(0==i.isMultiView()?e.setShouldEnable(!1):e.setShouldEnable(!0)),(e=g.getCommand("HistoryHdr",i))&&(0==i.isMultiView()?e.setShouldEnable(!1):e.setShouldEnable(!0)),(e=g.getCommand("TilesLayoutCmdHdr",i))&&(0==i.isMultiView()?e.setShouldEnable(!1):e.setShouldEnable(!0)),(e=g.getCommand("LargeTilesLayoutCmdHdr",i))&&(0==i.isMultiView()?e.setShouldEnable(!1):e.setShouldEnable(!0)),(e=g.getCommand("ThumbnailsLayoutCmdHdr",i))&&(0==i.isMultiView()?e.setShouldEnable(!1):e.setShouldEnable(!0)),i.updateCommands(),console.log("Activating PanelHelp MODE from buildDataPresenter : UAContainer = "+G),G?(G.inject(q),console.log("We already have the UAContainer")):((G=new UWA.Element("div",{class:"wux-control-inline-container",style:{"vertical-align":"top"}})).inject(q),require(["DS/Windows/ImmersiveFrame"],function(e){var t=new e;t.inject(G),require(["DS/WebUAUtils/WebUAUtils"],function(e){e.setPanelHelpMode({immersiveFrame:t}),console.log("PanelHelp MODE ACTIVATED ! from buildDataPresenter")})})),console.log("onActionBarReady in buildDataPresenter, line 2837"),i.actionBarReady=!0}),i.dispatchEvent("actionBarCreated",{})}1===e&&void 0===this.addinmode&&!1===i.secretMultiViewFlag?require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"],function(e){var t=i.elements.container.querySelector(".lifecycle-content.revision"),n=i.elements.container.querySelector("#BubbleContainer");if(null==n){e.initialize2(t,null,"show","bottom-right",function(e){i.dispatchEvent("onAuthoringCtxAvailable",e)}),void 0===i.CAJson&&(i.CAJson={},e.get2(function(e){i.CAJson=e})),void 0!==i.CAJson&&i.CAJson.version&&e.set2(i.CAJson,function(e){console.log(e)})}}):(e>1||null!=this.addinmode||!0===i.secretMultiViewFlag)&&require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"],function(e){var t=i.elements.container.querySelector(".lifecycle-content.multi"),n=i.elements.container.querySelector("#BubbleContainer");if(null==n){i.containerResponsiveThumbnailOrTile&&(e.initialize2(t,null,"show","bottom-right",function(e){i.dispatchEvent("onAuthoringCtxAvailable",e)}),void 0===i.CAJson&&(i.CAJson={},e.get2(function(e){i.CAJson=e})),void 0!==i.CAJson&&i.CAJson.version&&e.set2(i.CAJson,function(e){console.log(e)}))}}),widget.endEdit=this.changeCurrentCredential.bind(this),this._updateUI(!0)},resolveIcon:function(e,t){return"url("+j.getWebappsBaseUrl()+(t||"HistoryExplorer")+"/assets/icons/32/"+e+")"},buildCollectionView:function(e){var t=this;K=!1,this.isOpenWithCatiaV5Available=!0,e||(e=t.createLifecycleDiv()),D.isOpenWithCATIAV5Available(function(e){t.isOpenWithCatiaV5Available=e});var i=UWA.Element("div");i.className="lifecycle-content multi",e.appendChild(i),this.multiContent=i;switch(t.multiViewType){case"Tiles":t.containerResponsiveThumbnailOrTile=new c(t.responsiveThumbOptions).inject(i);break;case"LargeTiles":t.containerResponsiveThumbnailOrTile=new d(t.responsiveThumbOptions).inject(i);break;case"Thumbnails":t.containerResponsiveThumbnailOrTile=new r(t.responsiveThumbOptions).inject(i);break;default:t.containerResponsiveThumbnailOrTile=new c(t.responsiveThumbOptions).inject(i)}t.containerResponsiveThumbnailOrTile.useDragAndDrop=!0,t.containerResponsiveThumbnailOrTile.onDragStartCell=function(e){for(var i=[],n=0;n<t.selectedNodesPID.length;n++){var s={envId:D.getTenant(),serviceId:t.selectedNodesObjects[n].serviceId?t.selectedNodesObjects[n].serviceId:"3DSpace",contextId:"",objectId:t.selectedNodesObjects[n].physicalid,objectType:t.selectedNodesObjects[n].type,displayName:t.selectedNodesObjects[n].displayName,session_object:!1};i.push(s)}var o={protocol:"3DXContent",version:"1.0",source:"ENOSTDE_AP",data:{items:i}};try{e.dataTransfer.setData("Text",JSON.stringify(o)),console.log(e)}catch(t){e.dataTransfer.setData("Text",JSON.stringify(o)),console.log(e)}},t.containerResponsiveThumbnailOrTile.onSelectionAdd(function(e){t.addSelectedNode(e),t.dispatchEvent("objectSelectionChanged",{})}),t.containerResponsiveThumbnailOrTile.onSelectionRemove(function(e){t.removeSelectedNode(e),t.dispatchEvent("objectSelectionChanged",{})}),this.addEvent("objectSelectionChanged",function(e){if(!0===X._isRightOpen){K=!0;var t=document.getElementById("slideInPropertiesContent");null!=t&&t.destroy();var i=this.selectedNodes;if(0!=i.length){var n=new E;n.buildSlideIn(i,e,X)}}}),t.containerResponsiveThumbnailOrTile.modelProvider=new u,t.containerResponsiveThumbnailOrTile.selectionManagedByView=!0,t.containerResponsiveThumbnailOrTile.onContextualEvent={callback:function(e){return t._buildContextMenu(e)}}},_createMenuItemForSingleSelect:function(e){var t=this;return{type:"PushItem",title:R.getTitle(e),fonticon:R.getFontIcon(e),action:{callback:function(i){var n=[{physicalid:t.containerResponsiveThumbnailOrTile.activeNode._attributes.physicalid,id:t.containerResponsiveThumbnailOrTile.activeNode._attributes.physicalid,displayName:t.containerResponsiveThumbnailOrTile.activeNode._attributes.label,revision:t.containerResponsiveThumbnailOrTile.activeNode._attributes.subLabel,name:t.containerResponsiveThumbnailOrTile.activeNode._attributes.label,type:t.containerResponsiveThumbnailOrTile.activeNode._attributes.type,pos:[],selectedNodes:[]}];R.runCommand(e,n,t.widget,C.getSecurityContextPromise(t.tenant))}}}},_createMenuItemForMultiSelect:function(e){var t=this;return{type:"PushItem",title:R.getTitle(e),fonticon:R.getFontIcon(e),action:{callback:function(i){for(var n=[],s=0;s<t.selectedNodesPID.length;s++){var o={physicalid:t.selectedNodesObjects[s].physicalid,id:t.selectedNodesObjects[s].physicalid,displayName:t.selectedNodesObjects[s].displayName,revision:t.selectedNodesObjects[s].revision,name:t.selectedNodesObjects[s].displayName,type:t.selectedNodesObjects[s].type,pos:[],selectedNodes:[]};n.push(o)}R.runCommand(e,n,t.widget,C.getSecurityContextPromise(t.tenant))}}}},_buildContextMenu:function(e){var t=this,i=[];if(e.menu&&e.menu.length)if(1==t.selectedNodesPID.length&&0==t.isMultiView()){["Properties","RevisionHdr","ReviseFromHdr","NewBranchHdr","DuplicateHdr","DeleteHdr"].forEach(function(e){R.checkAvailability(e,[t.containerResponsiveThumbnailOrTile.activeNode._attributes],t.widget,null)&&i.push(t._createMenuItemForSingleSelect(e))}),i.push({type:"PushItem",title:b.whereUsed,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-object-related",family:WUXManagedFontIcons.Font3DS},action:{callback:function(e){var i=require("DS/PADUtils/PADCommandProxy").create();require(["DS/PADUtils/PADUtilsServices"],function(e){var n=[];n.push({envId:"",serviceId:"",contextId:"",objectId:t.containerResponsiveThumbnailOrTile.activeNode._attributes.physicalid,objectType:t.containerResponsiveThumbnailOrTile.activeNode._attributes.type,displayName:t.containerResponsiveThumbnailOrTile.activeNode._attributes.label});var s={protocol:"3DXContent",version:"1.0",source:"ENOLCMI_AP",data:{items:n}},o={attributes:{},paths:[],version:"1.1"};o.attributes[t.containerResponsiveThumbnailOrTile.activeNode._attributes.physicalid]={label:t.containerResponsiveThumbnailOrTile.activeNode._attributes.label,type:t.containerResponsiveThumbnailOrTile.activeNode._attributes.type},o.paths.push([t.containerResponsiveThumbnailOrTile.activeNode._attributes.physicalid]);var a=new v.Socket("compassPageSocket");a.subscribeServer("com.ds.compass",window.parent),a.dispatchEvent("onSetX3DContent",s,"compassPageSocket"),a.addListener("launchApp",function(e){i.select(o),i.destroy(),console.log("Response = "+JSON.stringify(e))}),a.dispatchEvent("onLaunchApp",{appId:"ENORIPE_AP"},"compassPageSocket")})}}}),i.push(t.nodesCN[0])}else{i.push({type:"PushItem",title:R.getTitle("Properties"),fonticon:R.getFontIcon("Properties"),action:{callback:function(e){for(var i=[],n=0;n<t.selectedNodesPID.length;n++){var s={getID:function(){return n-=1,t.selectedNodesPID[n]}};i.push(s)}var o={_context:C.getSecurityContextPromise(t.tenant),mergeSupport:!0,_selection:i,getSecurityContext:function(){return this._context},getSelectedNodes:function(){return this._selection},displayNotification:function(){}};require(["DS/LifecycleControls/EditPropDialog"],function(e){(new e).launchProperties(o)})}}});var n=["ReviseFromHdr"],s=t.selectedNodesObjects.length;["RevisionHdr","ReviseFromHdr","NewBranchHdr","DuplicateHdr","DeleteHdr"].forEach(function(e){var o,a=!0;if(s>1){var l=0;for(l=0;l<s;l++)n[l]===e&&(a=!1)}for(o=0;o<s;o++)if(!R.checkAvailability(e,[t.selectedNodesObjects[o]],t.widget,null)){a=!1;break}a&&i.push(t._createMenuItemForMultiSelect(e))}),t.isCID(t.selectedNodesObjects)||i.push({type:"PushItem",title:b.whereUsed,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-object-related",family:WUXManagedFontIcons.Font3DS},action:{callback:function(e){var i=require("DS/PADUtils/PADCommandProxy").create();require(["DS/PADUtils/PADUtilsServices"],function(e){for(var n=[],s=0;s<t.selectedNodesPID.length;s++){var o={envId:"",serviceId:"",contextId:"",objectId:t.selectedNodesObjects[s].physicalid,objectType:t.selectedNodesObjects[s].type,displayName:t.selectedNodesObjects[s].displayName};n.push(o)}var a={protocol:"3DXContent",version:"1.0",source:"ENOLCMI_AP",data:{items:n}},l=[],r={attributes:{},paths:[],version:"1.1"};for(s=0;s<t.selectedNodesPID.length;s++)r.attributes[t.selectedNodesObjects[s].physicalid]={label:t.selectedNodesObjects[s].displayName,type:t.selectedNodesObjects[s].type},r.paths.push([t.selectedNodesObjects[s].physicalid]),l.push(r);var c=new v.Socket("compassPageSocket");c.subscribeServer("com.ds.compass",window.parent),c.dispatchEvent("onSetX3DContent",a,"compassPageSocket"),c.addListener("launchApp",function(e){i.select(r),i.destroy(),console.log("Response = "+JSON.stringify(e))}),c.dispatchEvent("onLaunchApp",{appId:"ENORIPE_AP"},"compassPageSocket")})}}}),i.push(t.nodesCN[0])}return i},runDeleteCommand:function(){var e=this.createContextMenuData(this.selectedNodesPID,this.selectedNodesObjects);R.runCommand("DeleteHdr",e,this.widget,C.getSecurityContextPromise(this.tenant))},createContextMenuData:function(e,t){for(var i=[],n=0;n<e.length;n++){var s=this.createContextMenuNode(t[n]);i.push(s)}return i},createContextMenuNode:function(e){var t="",i="",n="";if("options"in e){var s=e.options;"ds6w:status"in s&&(t=s["ds6w:status"]),"ds6w:type"in s&&(n=s["ds6w:type"]),"icons"in s&&(i=s.icons[0])}return{physicalid:e.physicalid,id:e.physicalid,displayName:e.displayName,revision:e.revision,name:e.displayName,type:e.type,"ds6w:type":n,"ds6w:status":t,icon:i,pos:[],selectedNodes:[]}},doPickContext:function(e,t){var i=this;if(this._getParentContainer=function(){return this.parentWidget?this.parentWidget:this.widget},1==i.options.wintop){i._doPickContext(e,t,void 0)}else C.getSecurityContext(D.getTenant(),function(n){i._doPickContextWithOpen(n,e,t,D.getTenant())},function(e){console.error("_displayOpen",e)})},_doPickContextWithOpen:function(e,t,i,n,s,o,a){var l=this;if(!(l.selectedNodesPID.length<1)){for(var r=[],c=0;c<l.selectedNodesPID.length;c++){var d={envId:n,serviceId:"3DSpace",contextId:e,objectId:l.selectedNodesObjects[c].physicalid,objectType:l.selectedNodesObjects[c].type,pos:[],selectedNodes:[],displayName:l.selectedNodesObjects[c].displayName};r.push(d)}var u=[],h={protocol:"3DXContent",version:"1.0",source:"ENOLCMI_AP",data:{items:r}},p=new V;p.set3DXContent(h,!0),UWA.is(p.retrieveCompatibleApps,"function")&&p.retrieveCompatibleApps(function(n){n.forEach(function(e){u.push({type:"PushItem",title:e.text,fonticon:void 0!==e.fonticon&&null!==e.fonticon&&e.fonticon.length>0?{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+e.fonticon,family:WUXManagedFontIcons.Font3DS}:void 0,icon:void 0!==e.icon&&null!==e.icon&&e.icon.length>0?e.icon:"",action:{callback:e.handler}})}),0===u.length&&u.push({type:"PushItem",title:"CATIA V5",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-play",family:WUXManagedFontIcons.Font3DS},action:{callback:null}}),l._doPickContext(e,t,i,u)})}},_doPickContext:function(e,t,i,n){this.nodesCN=[];var s=this,o=this,a=[];j.getWebappsBaseUrl();this.objectIds=[],this.selected_objects={version:"1",structures:{references:[],connections:[],trees:{}}},this.selectedItems=[];var l={attributes:{},paths:[],version:"1.1"};this.selected_nodes=[];for(var r=0;r<s.selectedNodesPID.length;r++){var c={physicalid:s.selectedNodesObjects[r].physicalid,id:s.selectedNodesObjects[r].physicalid,displayName:s.selectedNodesObjects[r].displayName,revision:s.selectedNodesObjects[r].revision,name:s.selectedNodesObjects[r].displayName,type:s.selectedNodesObjects[r].type,pos:[],selectedNodes:[]},d={objectId:s.selectedNodesObjects[r].physicalid,envId:D.getTenant(),contextId:e};s.selected_nodes.push(d),this.selected_objects.structures.references.push({localid:r,physicalid:s.selectedNodesObjects[r].physicalid,type:"CATProduct"}),this.selected_objects.structures.trees[r]={selected:!0},this.selectedItems.push(l),this.objectIds.push(c)}if(a.push({label:b.whereUsed,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-object-related",family:WUXManagedFontIcons.Font3DS},callback:function(){var e=require("DS/PADUtils/PADCommandProxy").create();require(["DS/PADUtils/PADUtilsServices"],function(t){var i={protocol:"3DXContent",version:"1.0",source:"ENOLCMI_AP",data:{items:this.objectIds}},n=new v.Socket("compassPageSocket");n.subscribeServer("com.ds.compass",window.parent),n.dispatchEvent("onSetX3DContent",i,"compassPageSocket"),n.addListener("launchApp",function(t){e.select(s.selectedItems),e.destroy(),console.log("Response = "+JSON.stringify(t))}),n.dispatchEvent("onLaunchApp",{appId:"ENORIPE_AP"},"compassPageSocket")})}}),this._displayOpen(o,!0,n)){var u=function(e){F.mask(s._getParentContainer(),b.openCATIALaunchMessage),require(["DS/PADUtils/PADUtilsServices","DS/PADUtils/PADWSAccess"],function(e,t){var i={data:s.selected_objects,onComplete:function(t){var i=UWA.is(t,"string")?JSON.parse(t):t;e.setStructure_4_open_in_cv5({completeselection:i});var n=new v.Socket("compassPageSocket");n.subscribeServer("com.ds.compass",window.parent),n.addListener("launchApp",function(e){console.log("Response = "+JSON.stringify(e)),F.unmask(s._getParentContainer())}),n.dispatchEvent("onLaunchApp",{appId:"ENOV5MA_AP"},"compassPageSocket")},onFailure:function(e){console.error("PADWSAccess.completeselection",e),F.unmask(s._getParentContainer())},timeout:0};console.log("isWidget true, initialize PADSettingsMgt and PADUtilsServices"),require("DS/PADUtils/PADSettingsMgt").set_app_context("enopad"),e.app_initialization(function(){t.completeselection(i)})})};n.forEach(function(e){e.title.contains("CATIA V5")&&(e.action.callback=u)});var h={title:b.OpenWith,label:b.OpenWith,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-export",family:WUXManagedFontIcons.Font3DS},type:"PushItem",callback:u,submenu:n};a.push(h)}if(s._displayOpen(o,!1,n)){u=function(e){C.getSecurityContext(D.getTenant(),function(e){F.mask(s._getParentContainer(),b.openCATIALaunchMessage),require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"],function(t){var i={version:"2.4",completionOnCAD:"yes"};i.results=[{id:"0",phid:o.contextMenuObject.physicalid}],i.structures=[{structure:[{id:"0",show:!0,select:!0,children:[]}]}],i.viewpoint=[];var n=t.get();n&&(i.workUnder=n);var a=JSON.stringify(i);require(["DS/i3DXCompassServices/i3DXCompassPubSub"],function(t){var n=new v.Socket("compassPageSocket");if(n.subscribeServer("com.ds.compass",window.parent),n.addListener("launchApp",function(e){console.log("Response = "+JSON.stringify(e)),F.unmask(s._getParentContainer())}),void 0!==i.workUnder&&i.workUnder.AuthoringContextHeader){var l={appId:"MAP-CATCDVEAP",fileContent:a,fileName:"-file",widgetId:o.id,envId:D.getTenant(),contextId:e};t.publish("resetObject"),n.dispatchEvent("onLaunchApp",l,"compassPageSocket")}else t.publish("setObject",this.selected_nodes),n.dispatchEvent("onLaunchApp",{appId:"MAP-CATCDVEAP"},"compassPageSocket")})})},function(e){console.error("_displayOpen",e),F.unmask(s._getParentContainer())})};n.forEach(function(e){e.title.contains("CATIA V5")&&(e.action.callback=u)});h={title:b.OpenWith,label:b.OpenWith,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-export",family:WUXManagedFontIcons.Font3DS},type:"PushItem",callback:u,submenu:n};a.push(h)}for(var p=!1,m=[],f=(a=["OpenWith"].map(function(e){return"|"===e?{type:useNewMenu?"SeparatorItem":"separator"}:a.find(function(t){return b[e]===t.label})}).filter(function(e){return e})).length,g=0;g<f;g++)if("SeparatorItem"===a[g].type||"separator"===a[g].type){if(0===m.length||!0===p)continue;m.push(a[g]),p=!0}else m.push(a[g]),p=!1;a=(a=m).map(function(e){return"string"==typeof e.type?e:UWA.extend(e,{title:e.label,type:"PushItem",action:{this:o,callback:e.callback}})});this.nodesCN=a},_displayOpen:function(e,t,i){try{return!(!Array.isArray(i)||0==i.length)&&(!e.options.wintop&&(!C.isInPSEditorWidget(e.context.widget)&&(C.isInXCADEditorWidget(e.context.widget)?t:C.isDECType(e.contextMenuObject.type)?t:!t)))}catch(e){return t}},replaceModelObject:function(e,t,i){var n=this.containerResponsiveThumbnailOrTile.model[t];this.updateModelObject(e,i,n)},removeModelObjects:function(e,t){if(this.containerResponsiveThumbnailOrTile){var i,n=t.length,s=[];for(i=0;i<n;i++)s.push(this.model._models[t[i]]);var o={};this.model.remove(s,o);o={updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1};this.containerResponsiveThumbnailOrTile.invalidateLayout(o)}},updateModelObject:function(e,t,i){var n=e.options.icons[1];n&&n.startsWith("/")&&(n=t+n);var s,o=e.options.icons[0];o&&o.startsWith("/")&&(o=t+o),s=e["attribute[PLMEntity.V_Name]"]&&e["attribute[PLMEntity.V_Name]"].length>0?e["attribute[PLMEntity.V_Name]"]:e["attribute[DOCUMENTS.Title]"]&&e["attribute[DOCUMENTS.Title]"].length>0?e["attribute[DOCUMENTS.Title]"]:e["attribute[Title]"]&&e["attribute[Title]"].length>0?e["attribute[Title]"]:e.name;var a="",l="";null!=e.options&&null!=e.options&&null!=e.options["ds6w:type"]&&null!=e.options["ds6w:type"]&&(l=e.options["ds6w:type"]),""!=l&&(a=l);var r="";null!=e.revision&&null!=e.revision&&(r=e.revision),""!=r&&(a=a+"|"+r);var c="";null!=e.options&&null!=e.options&&null!=e.options["ds6w:status"]&&null!=e.options["ds6w:status"]&&(c=e.options["ds6w:status"]),""!=c&&(a=a+"|"+c);var d="";null!=e.ownerFullName&&null!=e.ownerFullName&&(d=e.ownerFullName),""!=d&&(a=a+"|"+d);var u="";null!=e.project&&null!=e.project&&(u=e.project),""!=u&&(a=a+"|"+u);var h={physicalid:e.physicalid,label:s,subLabel:a,picture:n,icon:o,type:e.type,multipleTitleLineNumber:!1,ownerFullName:e.ownerFullName,contextualMenu:["Properties","RevisionHdr","ReviseFromHdr","NewBranchHdr","DuplicateHdr","DeleteHdr"],activeFlag:!1};i.set(h)},addModelObject:function(e,t){var i=this.buildModelObject(e,t),n=[];n.push(i),this.model.push(n);var s=this.model.length-1,o=this.model._models;this.modelPIDs.push(o[s]._attributes.physicalid)},buildModelObject:function(e,t){var i,n;e.options&&e.options.icons&&((i=e.options.icons[1])&&i.startsWith("/")&&(i=t+i),(n=e.options.icons[0])&&n.startsWith("/")&&(n=t+n));var s=e.displayName,o="",a="";e.options&&(void 0!==e.options["ds6w:status"]&&(a=e.options["ds6w:status"]),void 0!==e.options["ds6w:type"]&&(o=e.options["ds6w:type"]));var l="";e.revision&&(l=e.revision);var r="";e.ownerFullName&&(r=e.ownerFullName);var c="";e.project&&(c=e.project);var d=o+"|"+l+"|"+a+"|"+r+"|"+c;return new p({physicalid:e.physicalid,label:s,subLabel:d,picture:i,icon:n,type:e.type,multipleTitleLineNumber:!1,ownerFullName:e.ownerFullName,contextualMenu:["Properties","RevisionHdr","ReviseFromHdr","NewBranchHdr","DuplicateHdr","DeleteHdr"],activeFlag:!1})},buildModel:function(e,t){var i;this.isMultiView();this.historyMultiPanel&&(this.historyMultiPanel.destroy(),this.historyMultiPanel=null,this.externalRefresh&&(this.externalRefresh.done(),this.externalRefresh=null)),this.maturityWidget&&(this.maturityWidget.destroy(),this.maturityWidget=null);var n=[],s=t,o=e.length;1===o&&(s=[].concat(e,t));var a=s.length,l=D.get3DSpaceBaseUrl(this.tenant);for(i=0;i<a;i++){var r=this.buildModelObject(s[i],l);n.push(r)}o<=1&&this.model.reset(),this.model.push(n),this.containerResponsiveThumbnailOrTile.loadApplicativeModel(this.model);var c,d=this.model._models,u=d.length;for(this.modelPIDs=[],c=0;c<u;c++)this.modelPIDs.push(d[c]._attributes.physicalid);var h=o+a;if(u!==h&&(h=u),u>o)for(c=o;c<h;c++)this.modelPIDs[c]},buildMaturityGraph:function(e){var t=this;e||(e=t.createLifecycleDiv()),e.style.display="grid";var i=document.createElement("div");i.className="lifecycle-container",e.appendChild(i);var n=document.createElement("div");n.className="lifecycle-container maturity",i.appendChild(n);var o=document.createElement("div");o.className="lifecycle-header maturity";var a=document.createElement("div");a.className="lifecycle-expand",o.appendChild(a),o.addEventListener("click",function(e){var t=document.querySelector("div.lifecycle-content.maturity");"none"===t.style.display?(t.style.display="block",a.className=a.className.replace(" no","")):(t.style.display="none",a.className=a.className+" no")}),n.appendChild(o);var r=document.createTextNode("Maturity Graph");o.appendChild(r);var c=UWA.Element("div");c.className="lifecycle-content maturity",n.appendChild(c),this.maturityWidget=new s({context:t,type:"lifecycleWidget"}),this.maturityWidget.inject(c);var d=document.createElement("div");d.className="lifecycle-container revision",i.appendChild(d);var u=document.createElement("div");u.className="lifecycle-header revision";var h=document.createElement("div");h.className="lifecycle-expand",u.appendChild(h),u.addEventListener("click",function(e){var t=document.querySelector("div.lifecycle-content.revision");"none"===t.style.display?(t.style.display="block",h.className=h.className.replace(" no","")):(t.style.display="none",h.className=h.className+" no")}),d.appendChild(u);var p=document.createTextNode("History Explorer");u.appendChild(p);var m=document.createElement("div");m.className="lifecycle-content revision",d.appendChild(m);var f=this,g={setObjects:function(e,t,i){f.setObjectsWithExceptions(e,t,i)},setTitleFromObject:function(e){f.setTitleFromObject(e)},onDropEvent:function(e){f.onDrop(e)}};this.historyMultiPanel=new l(this,this.widget,this.parentWidget,{wintop:!1,disableMaturityButton:!0},g);var y={load:function(e){f.setObjectsWithExceptions([e],!1,!1)},clear:function(){f.empty()}};this.externalRefresh?this.externalRefresh.resetViews(this.historyMultiPanel.revisionFamily):this.externalRefresh=new N(this.historyMultiPanel.revisionFamily,y),this.historyMultiPanel.inject(m),this.widget.onResize=function(){t.historyMultiPanel&&t.historyMultiPanel.revisionFamily&&t.historyMultiPanel.revisionFamily.onResize()},this.historyMultiPanel.revisionFamily.versionExplorer.addEventListener("ENOXVersionExplorerLoadCompleted",function(){n.scrollIntoView();var e=t.historyMultiPanel.revisionFamily.versionExplorer.getObjects(),i=document.querySelector(".subway-edge-view"),s=document.querySelector(".versionexplorer-toolbar"),o=document.querySelector(".wux-layouts-gridengine-columns-header-container");if(null!=o){var a=o.getBoundingClientRect().height,l="30";null!=i&&(l=i.getBoundingClientRect().height+15);var r=a+s.getBoundingClientRect().height+l*e.length+40;m.style.height=r+"px";for(var c=document.getElementsByClassName("wux-ui-state-focused"),d=0;d<c.length;d++)c[d].addEventListener("focus",function(e){n.scrollIntoView()})}},!1),this.historyMultiPanel.revisionFamily.versionExplorer.addEventListener("_ENOXVersionExplorerInternalRefreshCompleted",function(){n.scrollIntoView()},!1),this.historyMultiPanel.revisionFamily.versionExplorer.addEventListener("_ENOXVersionExplorerViewChanged",function(){n.scrollIntoView()},!1);var b=t.widget.getValue("lang");t.widget.hasOwnProperty("lang")&&(b=t.widget.lang),L.DEFAULT_LANGUAGE=b}})});