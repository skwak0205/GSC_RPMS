define("DS/RouteWebAppUX/Commands/AttachmentOpenWith",["UWA/Core","DS/i3DXCompassPlatformServices/OpenWith","UWA/Class/Promise"],function(e,t,n){"use strict";let o=function(o){let s=function(e){let t=e,n=[],o={envId:widget.getValue("x3dPlatformId"),serviceId:"3DSpace",contextId:"",objectId:a(t,"id"),objectType:a(t,"Type"),displayName:a(t,"Title"),displayType:a(t,"Type"),facetName:"realized",path:[{resourceid:a(t,"id"),type:a(t,"Type")}]};return n.push(o),{protocol:"3DXContent",version:"1.1",source:widget.getValue("appId"),widgetId:widget.id,data:{items:n}}}(o),r=new t;r.set3DXContent(s);let l=[];if(e.is(r.retrieveCompatibleApps,"function"))return new n(function(e,t){r.retrieveCompatibleApps(function(t){t.forEach(function(e){l.push(i(e,null))}),e(l)},function(){t(new Error("Error while getting Open with menus"))})})},i=function(e,t){return{id:e.text,title:e.text,icon:e.icon,type:"PushItem",multisel:!1,action:{context:t,callback:e.handler}}},a=function(e,t){let n="";return e&&e.options.grid.id&&(n=e.options.grid[t]),n};return{getOpenWithMenu:e=>o(e)}}),define("DS/RouteWebAppUX/Utilities/RouteWebAppRouteViewUtils",["i18n!DS/RouteWebAppUX/assets/nls/RouteWebAppUX"],function(e){"use strict";const t={icon:"thumbs-up",title:e.approve,action:"Approve",emphasize:"success"},n={icon:"thumbs-down",title:e.reject,action:"Reject",emphasize:"high-attention"},o={icon:"comment",title:e.comment,action:"Comment",emphasize:"info"},i={icon:"check",title:e.accept,action:"Accept",emphasize:"success"};return{getRouteActivityStateNLS:t=>(function(t){let n,o;if(t)return t.contains("(")?(n=t.split("(")[0],o=t.split("(")[1],n=n.toLowerCase().replace(/ /g,""),e[n]+" ("+o):(t=t.toLowerCase().replace(/ /g,""),t=e[t])})(t),getRouteActivityStateIcon:e=>(function(e){let t="";if(e)return e.contains("Awaiting")?t="hourglass":"Approved"==e?t="thumbs-up":"Commented"==e?t="comment":"Stopped"==e?t="stop":"Rejected"==e?t="thumbs-down":"Notified"==e?t="notification-read":"Not Started"==e?t="play-flash-off":"Abstained"==e&&(t="ignore"),t})(e),getApprovalActionIcon:e=>(function(e){const a=[];return"Approve"===e?(a.push(t),a.push(n)):"Comment"===e?a.push(o):"Review"===e&&(a.push(i),a.push(n)),a})(e)}}),define("DS/RouteWebAppUX/Utilities/RouteWebAppParseJSONUtil",["UWA/Class"],function(e){"use strict";return e.extend({createDataForRequest:function(e,t){void 0===t&&(t=widget.data.csrf);var n={dataelements:e},o=new Array;return o.push(n),{csrf:t,data:o}}})}),define("DS/RouteWebAppUX/Utilities/Search/RouteWebAppSearchUtil",["UWA/Class","DS/UIKIT/Alert","i18n!DS/RouteWebAppUX/assets/nls/RouteWebAppUX"],function(e,t,n){"use strict";return{getRefinementToSnN:(e,t,o,i)=>(function(e,t,o,i){var a={title:n[t],role:"",mode:"furtive",default_with_precond:!0,show_precond:!1,multiSel:o,idcard_activated:!1,select_result_max_idcard:!1,itemViewClickHandler:"",app_socket_id:e,widget_id:e,search_delegation:"3dsearch",default_search_criteria:"",source:["3dspace"],recent_search:{types:i},tenant:"OnPremise"};return a.global_actions=[{id:"incontextHelp",title:n["search.help"],icon:"fonticon fonticon-help",overflow:!1}],a})(e,t,o,i),getPrecondForDocumentSearch:()=>'( NOT (flattenedtaxonomies:"types/Person" OR flattenedtaxonomies:"types/Business Role" OR flattenedtaxonomies:"types/Security Context" OR flattenedtaxonomies:"types/Route" OR flattenedtaxonomies:"types/Route Template" OR flattenedtaxonomies:"types/Inbox Task"))'}}),define("DS/RouteWebAppUX/Model/RouteWebAppTaskAttachmentModel",["DS/Tree/TreeDocument","DS/Tree/TreeNodeModel"],function(e,t){"use strict";let n=new e;return{createModel:(e,o)=>(function(e){return n.prepareUpdate(),e.forEach(function(e){var o=new t({label:e.dataelements.title,width:300,grid:{id:e.id,Title:e.dataelements.title,Name:e.dataelements.name,Maturity:e.dataelements.stateNLS,Type:e.dataelements.typeNLS},icons:[e.dataelements.icon]});n.addRoot(o)}),n.pushUpdate(),n})(e),getModel:()=>n,getSelectedRowsModel:()=>WrapperDataGridView.getSelectedRowsModel(n),getContentIDs:()=>(function(){if(null!=n){for(var e=n.getChildren(),t=[],o=0;o<e.length;o++)t.push(e[o]._options.grid.id);return t}})(),destroy:()=>{n=new e},deleteSelectedRows:()=>(function(){var e=n.getSelectedNodes();n.prepareUpdate();for(var t=0;t<e.length;t++)n.removeRoot(e[t]);if(n.pushUpdate(),0==n.getChildren().length){var o=document.querySelector(".taskAttachments-gridView-View");o&&o.addClassName("hideView")}})()}}),define("DS/RouteWebAppUX/Commands/ApprovalMaturityCmd",[],function(){"use strict";return{lifeCycle:e=>(function(e){require(["DS/LifecycleCmd/MaturityCmd"],function(t){let n=[],o=e.model.id;n.push({physicalid:o}),(new t).executeAsync(n).then(function(e){widget.routeWebAppMediator.publish("maturity-save",{model:e})})})})(e)}}),define("DS/RouteWebAppUX/Components/RouteWebAppMediator",["DS/CoreEvents/ModelEvents"],function(e){"use strict";var t=null,n=function(){t=new e};return n.prototype.publish=function(e,n){t.publish({event:e,data:n})},n.prototype.subscribe=function(e,n){return t.subscribe({event:e},n)},n.prototype.subscribeOnce=function(e,n){return t.subscribeOnce({event:e},n)},n.prototype.unsubscribe=function(e){t.unsubscribe(e)},n.prototype.getEventBroker=function(){return t},n.prototype.destroy=function(){t.destroy()},n}),define("DS/RouteWebAppUX/Components/RouteWebAppNotifications",["DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],function(e,t){"use strict";let n=null,o=function(){n=e,t.setNotificationManager(n),t.setStackingPolicy(9)};return o.prototype.handler=function(){return document.getElementById("TaskApprovalDialog")?(t.inject(document.getElementById("TaskApprovalDialog")),document.getElementById("TaskApprovalDialog").scrollIntoView()):document.getElementsByClassName("wux-notification-screen").length>0||t.inject(document.body),n},o.prototype.notifview=function(){return t},o}),define("DS/RouteWebAppUX/RouteWebAppBootstrap",["UWA/Core","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/WAFData/WAFData","DS/RouteWebAppUX/Components/RouteWebAppMediator","DS/RouteWebAppUX/Components/RouteWebAppNotifications"],function(e,t,n,o,i){"use strict";let a,s,r,l;const u=function(){return c(),p(),new Promise(function(e,n){let o=new Promise(function(e,n){let o=widget.getValue("x3dPlatformId");t.getServiceUrl({serviceName:"3DSpace",platformId:o,onComplete:function(t){a="string"==typeof t?t:t[0].url,e()},onFailure:function(){a="",n()}})}),i=new Promise(function(e,n){t.getServiceUrl({serviceName:"3DSearch",onComplete:function(t){var n="OnPremise";if(r=t)for(var o=0;o<r.length;o++)if(n===r[o].platformId){s=r[o].url;break}e()},onFailure:function(e){r=[],n()}})}),u=new Promise(function(e,n){var o=widget.getValue("x3dPlatformId");t.getServiceUrl({serviceName:"3DDashboard",platformId:o,onComplete:function(t){l="string"==typeof t?t:t[0].url,e()},onFailure:function(){l="",n()}})});Promise.all([o,i,u]).then(t=>{e(t)},e=>{n(e)})})},c=function(){widget.routeWebAppMediator=new o},p=function(){widget.routeWebAppNotify=new i};return{init:(e,t,n)=>u(),getRouteServiceBaseURL:()=>(function(){if(a)return a+"/resources/v1/modeler/routes"})(),getTaskServiceBaseURL:()=>(function(){if(a)return a+"/resources/v1/modeler/tasks"})(),getCSRFToken:()=>new Promise(function(t,o){n.authenticatedRequest(a+"/resources/v1/application/E6WFoundation/CSRF",e.extend({method:"GET",onComplete:function(e){t(e)}}))}),getTenantValue:()=>widget.data.routeCredentials&&widget.data.routeCredentials.tenant?widget.data.routeCredentials.tenant:widget.getValue("x3dPlatformId"),getSecurityContextValue:()=>widget.data.routeCredentials&&widget.data.routeCredentials.securityContext?widget.data.routeCredentials.securityContext:widget.ChangeMaturityWidget.options.SecurityContext,get3DSpaceURL:()=>(function(){if(a)return a})(),getDashboardURL:()=>(function(){if(l)return l})(),getSearchUrl:()=>(function(){if(s)return s})(),authenticatedRequest:(e,t)=>(function(e,t){n.authenticatedRequest(e,t)})(e,t)}}),define("DS/RouteWebAppUX/Utilities/CompassDataExchange",["DS/RouteWebAppUX/RouteWebAppBootstrap","i18n!DS/RouteWebAppUX/assets/nls/RouteWebAppUX"],function(e,t){"use strict";let n=function(t){return{envId:e.getTenantValue()?e.getTenantValue():"OnPremise",serviceId:"3DSpace",contextId:e.getSecurityContextValue(),objectId:t.dataelements.id,objectType:"Route",displayName:t.dataelements.name,path:[{resourceid:t.dataelements.id,type:"Route"}]}},o=function(e){if("hyperlink"==e.fromPage){for(var t=[],n=0;n<e.route.length;n++)e.route[n].dataelements.approvalTaskId&&t.push(e.route[n].dataelements.id);return 1==t.length?"Inbox Task":"Route"}return"Route"},i=function(e,t){return{protocol:"3DXContent",version:"1.1",source:widget.getValue("appId")?widget.getValue("appId"):"ENXROUT_AP",widgetId:widget.id,data:{items:t,approvalObjectType:e}}};const a=function(e){return"Awaiting your Comment"==e?"Comment":"Awaiting your Approval"==e?"Approve":"Awaiting your Review"==e?"Review":void 0},s=function(e){let t=e.dataelements.contentApprovalStatus,n=e.relateddata.route;for(let e in n){let o=n[e];if(t===o.dataelements.activityState&&o.dataelements.approvalTaskId&&""==!o.dataelements.approvalTaskId){let e={};return e.routeId=o.dataelements.id,e.taskId=o.dataelements.approvalTaskId,null==o.dataelements.showAbstain||1==o.dataelements.showAbstain?e.showAbstain=!0:e.showAbstain=!1,e}}};return{getContentToLink:e=>(function(e){let t=[],a=o(e);return"Inbox Task"==a?e.route.forEach(function(e){if(e.dataelements.approvalTaskId){let o=n(e);o.objectId=e.dataelements.approvalTaskId,t.push(o)}}):"hyperlink"==e.fromPage?e.route.forEach(function(e){e.dataelements.activityState.indexOf("Awaiting your")>-1&&t.push(n(e))}):e.route.forEach(function(e){t.push(n(e))}),i(a,t)})(e),getContentforApprovalLink:e=>(function(e){let t=o(e),a=[];return e.route.forEach(function(e){e.dataelements.activityState.indexOf("Awaiting your")>-1&&a.push(n(e))}),i(t,a)})(e),createModel:e=>(function(e){let t={model:{}},n=e.dataelements;t.model.id=e.id,t.model.name=n.name,t.model.title=n.name,t.model.type=e.type,t.model.state="In Process",t.model.current=n.current,t.model.Activity_State=n.contentApprovalStatus,t.model.approvalAction=a(t.model.Activity_State);let o=s(e);return o&&o.routeId&&o.taskId&&(t.model.routeId=o.routeId,t.model.taskId=o.taskId,t.model.showAbstain=o.showAbstain),e.relateddata&&(t.model.route=e.relateddata.route),t})(e),getActionsBasedOnApprovalStatus:e=>(function(e){return"Approve"==e?["Approve","Reject","Abstain"]:"Comment"==e?["Comment"]:"Review"==e?["Review"]:[]})(e),getApprovalAction:e=>a(e)}}),define("DS/RouteWebAppUX/Services/RouteWebAppRouteTaskServices",["UWA/Class/Promise","DS/WAFData/WAFData","DS/RouteWebAppUX/RouteWebAppBootstrap","DS/RouteWebAppUX/Utilities/RouteWebAppParseJSONUtil"],function(e,t,n,o){"use strict";return{makeWSCall:(e,o,i,a,s,r,l,u)=>(function(e,o,i,a,s,r,l,u){u=u||null;var c="",p=n.getSearchUrl();null!=u&&null!=u.isfederated&&1==u.isfederated&&(c=p+e);null!=u&&null!=u.acceptType&&""!=u.acceptType&&u.acceptType;null!=u&&null!=u.encodeSecurityContext&&""!=u.encodeSecurityContext&&u.encodeSecurityContext;var d=(new Date).getTime();c=-1==c.indexOf("?")?c+"?tenant=OnPremise&timestamp="+d:c+"&tenant=OnPremise&timestamp="+d,r=r||function(){},l=l||function(){};var m={};m.method=o,m.timeout=12e7,null!=u&&null!=u.isSwymUrl&&0!=u.isSwymUrl||(m.type="json"),i&&(m.auth={passport_target:i}),s&&(m.data=s),m.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":"en"},m.onComplete=function(e){r(e)},m.onFailure=function(e,t){console.log("Error in calling url: "+c),console.log("Error Detail: "+e),console.log("Error Data: "+JSON.stringify(t)),l(e,t)},m.onTimeout=function(){console.log("Timedout for url: "+c),widget.body&&Mask.unmask(widget.body)},t.authenticatedRequest(c,m)})(e,o,i,0,s,r,l,u)}}),define("DS/RouteWebAppUX/Utilities/RouteLinkWidget",["DS/WidgetLink/WidgetLink","DS/RouteWebAppUX/Utilities/CompassDataExchange","i18n!DS/RouteWebAppUX/assets/nls/RouteWebAppUX"],function(e,t,n){"use strict";let o,i;return o={init:(t,n)=>(function(t,n){return(i=e.get(widget)).setLinkability(n),i})(0,n),checkIfLinked:()=>0!=i.getLinked().length,getWidgetLinkInstance:()=>i,loadContent:e=>(function(e){i.publish("DS/ExternalWdgtCom/LoadData",{dropData:e})})(e),removeContent:e=>(function(e){i.publish("DS/ExternalWdgtCom/RemoveRoot",{data:e})})(e),removeAllContent:()=>{i.publish("DS/ExternalWdgtCom/RemoveAll")}}}),define("DS/RouteWebAppUX/Commands/RouteWebAppRouteDocumentCommands",["DS/RouteWebAppUX/RouteWebAppBootstrap"],function(e){"use strict";let t=function(t,n,o,i,a,s){let r={document:{id:n,contextId:e.getSecurityContextValue(),serviceId:"3DSpace",envId:e.getTenantValue(),index:1,data:function(e){let t={};if(Array.isArray(e))for(let n=0;n<e.length;n++)t.title=e[n].Title,t.type=e[n].Type,t.name=e[n].Name;return t}(i),type:"Document"},platformUrls:{"3DSpace":e.get3DSpaceURL(),"3DDashboard":e.getDashboardURL()},onComplete:function(e){s&&s(e)}};r.document.filesCallback=function(e){a(e)};let l=new t;l.init(r);l.render()};return{init:(e,n,o,i,a,s)=>t(e,n,0,i,a,s)}}),define("DS/RouteWebAppUX/Commands/RouteApprovalProcess",["UWA/Core","UWA/Class","DS/i3DXCompassPlatformServices/OpenWith","UWA/Class/Promise","DS/RouteWebAppUX/RouteWebAppBootstrap","DS/RouteWebAppUX/Utilities/CompassDataExchange","i18n!DS/RouteWebAppUX/assets/nls/RouteWebAppUX"],function(e,t,n,o,i,a,s){"use strict";let r=function(e){return{id:s.approvalProcess,title:s.approvalProcess,icon:"route",type:"PushItem",multisel:!1,action:{callback:e.handler}}};return{getOpenWithMenu:t=>(function(t){let i=a.getContentToLink(t),l=new n;l.set3DXContent(i);let u=[];if(e.is(l.retrieveCompatibleApps,"function"))return new o(function(e,t){0==i.data.items.length&&e(),l.retrieveCompatibleApps(function(t){t.forEach(function(e){u.push(r(e,null))}),e(u[0])},function(){t(new Error(s.openWithError))})})})(t)}}),define("DS/RouteWebAppUX/Services/RouteWebAppCollabTaskServices",["UWA/Class/Promise","DS/RouteWebAppUX/RouteWebAppBootstrap"],function(e,t){"use strict";var n={};let o=function(n,o,i,a){return new e(function(e,o){var s,r=t.getTaskServiceBaseURL()+"/"+n.model.id;"Review"==n.model.state?(s={routeTaskReviewerComments:n.model.comments},"Accept"==n.model.taskReviewButton?s.state="Complete":"Reject"==n.model.taskReviewButton&&(s.state="Assign")):(s={routeTaskApprovalComments:n.model.comments},"saveForLater"!=n.model.taskActionButton&&("Yes"==n.model.needsOwnerReview?s.state="Review":s.state="Complete"),"Approve"!=n.model.taskActionButton&&"Reject"!=n.model.taskActionButton&&"Abstain"!=n.model.taskActionButton||(s.routeTaskApprovalAction=n.model.taskActionButton));var l={method:"PUT",type:"json",timeout:0,headers:{"Content-Type":"application/ds-json"},wait:!0},u={dataelements:s},c=new Array;c.push(u);var p={csrf:a.csrf,data:c};"saveForLater"==n.model.taskActionButton&&0!=i.length&&(p.data[0].relateddata={references:i}),l.data=JSON.stringify(p),l.onComplete=function(t){e(t)},l.onFailure=function(e,t){o(t||e)},t.authenticatedRequest(r,l)})},i=function(n,o,i){return new e(function(e,a){if(0==o.length)e();else{var s=t.getTaskServiceBaseURL()+"/"+n.model.id,r={method:"PUT",type:"json",timeout:0,headers:{"Content-Type":"application/ds-json"},wait:!0},l={dataelements:{}},u=new Array;u.push(l);var c={csrf:i.csrf,data:u};c.data[0].relateddata={references:o},r.data=JSON.stringify(c),r.onComplete=function(t){e(t)},r.onFailure=function(e,t){a(t||e)},t.authenticatedRequest(s,r)}})};return{fetchRouteTask:n=>(function(n){return new e(function(e,o){var i=t.getTaskServiceBaseURL()+"/"+n+"?$include=none,assignees,references&$fields=references.icon,revision",a={method:"GET",type:"json",timeout:0,headers:{"Content-Type":"application/ds-json"},wait:!0,onComplete:function(t){e(t)},onFailure:function(e,t){o(t||e)}};t.authenticatedRequest(i,a)})})(n),updateComment:(i,a,s)=>(function(i,a,s){return new e(function(e,o){t.getCSRFToken().then(function(t){n.csrf=JSON.parse(t).csrf,e()})}).then(function(){return o(i,a,s,n)})})(i,a,s),updateTaskAttachment:(o,a)=>(function(o,a){return new e(function(e,o){t.getCSRFToken().then(function(t){n.csrf=JSON.parse(t).csrf,e()})}).then(function(){return i(o,a,n)})})(o,a)}}),define("DS/RouteWebAppUX/Controller/RouteWebAppCollabTaskServicesController",["DS/RouteWebAppUX/Services/RouteWebAppCollabTaskServices","UWA/Promise"],function(e,t){"use strict";let n;return n={fetchRouteTask:function(n){return new t(function(t,o){e.fetchRouteTask(n).then(e=>{t(e)},e=>{o(e)})})},updateComment:function(n,o,i){return new t(function(t,a){e.updateComment(n,o,i).then(e=>{t(e)},e=>{a(e)})})},updateTaskAttachment:function(n,o){return new t(function(t,i){e.updateTaskAttachment(n,o).then(e=>{t(e)},e=>{i(e)})})}}}),define("DS/RouteWebAppUX/Views/Loader/RouteWebAppInitiateDocumentChooser",["DS/RouteWebAppUX/Utilities/Search/RouteWebAppSearchUtil","DS/TreeModel/TreeNodeModel","DS/TreeModel/TreeDocument","i18n!DS/RouteWebAppUX/assets/nls/RouteWebAppUX","css!DS/RouteWebAppUX/RouteWebAppUX.css"],function(e,t,n,o){"use strict";let i;var a=function(e,n){for(var o=0;o<n.length;o++){var a,s=n[o];s&&(a=new t({label:s["ds6w:label"],value:s.id,name:s["ds6w:identifier"],type:s["ds6w:type"]}),null==i.selectedItems?i.selectedItems=a:i.selectedItems.push(a),i._applySelectedItems())}};return{init:(t,n,o)=>(function(t,n,o){i=n;var s=[];null!=o&&(s=JSON.parse(JSON.stringify(o))),null!=i&&null!=i.selectedItems&&0!=i.selectedItems.length&&i.selectedItems.forEach(function(e){null==e.options.value.name&&s.push(e.options.value)});var r=t.dsModel,l=UWA.Utils.getUUID();require(["DS/SNInfraUX/SearchCom"],function(t){var n=t.createSocket({socket_id:l}),o=e.getRefinementToSnN(l,"addExistingAttachment",!0,["Document"]);if(o.precond=e.getPrecondForDocumentSearch(),o.resourceid_not_in=s,!UWA.is(n))throw new Error("Socket not initialized");n.dispatchEvent("RegisterContext",o),n.addListener("Selected_Objects_search",a.bind(r,"")),n.dispatchEvent("InContextSearch",o)})})(t,n,o)}}),define("DS/RouteWebAppUX/Services/RouteWebAppApprovalStatusService",["UWA/Core","UWA/Class/Promise","DS/RouteWebAppUX/RouteWebAppBootstrap"],function(e,t,n){"use strict";const o=function(e){return new t(function(t,o){null!=e&&null!=e.data&&0!=e.data.length||t();let i=n.getRouteServiceBaseURL()+"/contentsApprovalStatus",a={method:"POST",headers:{"Content-Type":"application/json"}};a.data=JSON.stringify(e),a.onComplete=function(e){let n=JSON.parse(e);t(n)},a.onFailure=function(e,t,n){o()},n.authenticatedRequest(i,a)})};return{fetchApprovalStatusForContent:e=>(function(e){return new t(function(t,o){null==e&&t(),n.getCSRFToken().then(function(n){e.csrf=JSON.parse(n).csrf,t()})}).then(function(){return o(e)})})(e)}}),define("DS/RouteWebAppUX/Controller/RouteWebAppApprovalStatusServiceController",["DS/RouteWebAppUX/Services/RouteWebAppApprovalStatusService","UWA/Promise"],function(e,t){"use strict";let n;return n={fetchApprovalStatusForContent:function(n){return new t(function(t,o){e.fetchApprovalStatusForContent(n).then(e=>{t(e)},e=>{o(e)})})}}}),define("DS/RouteWebAppUX/Services/RouteWebAppESignServices",["UWA/Class/Promise","DS/RouteWebAppUX/RouteWebAppBootstrap","DS/RouteWebAppUX/Utilities/RouteWebAppParseJSONUtil","DS/WAFData/WAFData"],function(e,t,n){"use strict";let o,i;return i=function(o,i){return new e(function(e,a){var s=t.get3DSpaceURL()+"/resources/v1/modeler/ESignRecord/"+i,r={},l={method:"PUT",type:"json",headers:{"Content-Type":"application/json"},wait:!0};r=(new n).createDataForRequest(r);var u=o.model.needsOwnerReview,c=""!=u&&"Yes"==u?"Review":"Complete",p={actionType:[{ObjectRevision:o.model.revision},{MaturityChange:{before:"To Do",after:c}}]};r.data[0].dataelements={ObjectActionTaken:JSON.stringify(p),ObjectReference:o.model.id,ObjectServiceID:"3DSpace",ObjectURI:"/resources/v1/modeler/tasks/"},l.data=JSON.stringify(r),l.onComplete=function(t){e(t)},l.onFailure=function(e,t){a(t||e)},t.authenticatedRequest(s,l)})},o={updateEsignRecordInformation:(e,t)=>i(e,t)}}),define("DS/RouteWebAppUX/Views/Menu/AttachmentContextualMenuItems",["DS/RouteWebAppUX/Commands/AttachmentOpenWith","i18n!DS/RouteWebAppUX/assets/nls/RouteWebAppUX"],function(e,t){"use strict";let n=function(e,n){var o=[];return e&&o.push({name:t.deleteContent,title:t.deleteContent,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-remove"},data:null,action:{callback:function(){n()}}}),o};return{addDownloadCommand:(e,t)=>(function(e,t){let n=e.Download,o={name:n.name,title:n.title,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x fonticon-"+n.fonticon},action:{callback:n.handler}};return t.push(o),t})(e,t),getOpenWithMenu:n=>(function(n){let o=[];return new Promise(function(i,a){e.getOpenWithMenu(n).then(e=>{e&&e.length>0&&o.push({id:"OpenWith",type:"PushItem",title:t.openWith,icon:"export",submenu:e}),i(o)},e=>{i(o)})})})(n),deleteMenuForAttachments:(e,t)=>(function(e,t){var o=!0;return e.forEach(e=>{"false"==e.canDeleteContent&&(o=!1)}),n(o,t)})(e,t)}}),define("DS/RouteWebAppUX/Controller/RouteWebAppESignServicesController",["DS/RouteWebAppUX/Services/RouteWebAppESignServices","UWA/Promise"],function(e,t){"use strict";let n;return n={updateEsignRecordInformation:function(n,o){return new t(function(t,i){e.updateEsignRecordInformation(n,o).then(e=>{t(e)},e=>{i(e)})})}}}),define("DS/RouteWebAppUX/Views/Menu/AttachmentContextualMenu",["DS/Menu/Menu","DS/RouteWebAppUX/Commands/RouteWebAppRouteDocumentCommands","DS/RouteWebAppUX/RouteWebAppBootstrap","DS/RouteWebAppUX/Views/Menu/AttachmentContextualMenuItems","i18n!DS/RouteWebAppUX/assets/nls/RouteWebAppUX"],function(e,t,n,o,i){"use strict";let a,s,r=[],l=function(n,i,a,r,l,u,c){a.preventDefault(),a.stopPropagation();let p=a.target.getBoundingClientRect(),d={position:{x:p.left,y:p.top+20}},m=[],f=[],A=["Remove","Download","Preview"];m.push(n[0].options.grid),1===n.length?o.getOpenWithMenu(i).then(function(n){f=f.concat(n),s?function(n,i,a,r,l){var u=[];s&&(widget.routeWebAppNotify.handler(),t.init(s,i,e,a,function(e){-1!==n.indexOf("Download")&&(u=o.addDownloadCommand(e,u)),r(u)},l))}(A,r,m,function(t){f=f.concat(t),l||(f=f.concat(o.deleteMenuForAttachments(m,u))),e.show(f,d)},c):(l||(f=f.concat(o.deleteMenuForAttachments(m,u))),e.show(f,d))}):(l||(f=f.concat(o.deleteMenuForAttachments(m,u))),e.show(f,d))};return a={isDocumentManagementInstalled:()=>{require(["DS/DocumentCommands/ENOXDocumentCommands","DS/DocumentCommands/TypeDerivativesCache"],function(e,t){s=e;let o=["Document"];t.getTypeDerivatives(o,function(e){r=e[o[0]]},n.get3DSpaceURL())},function(e){widget.routeWebAppNotify.handler().addNotif({level:"error",subtitle:i.documentManagementNotInstalled,sticky:!1})})},taskAttachmentContextualMenu:(e,t,n,o,i)=>(function(e,t,n,o,i){let a=e.data.event,s=e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel;if(e&&e.cellInfos&&e.cellInfos.cellModel){let e=t.getTreeDocument().getSelectedNodes(),r=e[0]._options.grid.id;l(e,s,a,r,n,o,i)}})(e,t,n,o,i)}}),define("DS/RouteWebAppUX/Views/Form/RouteWebAppTaskViewUtil",["i18n!DS/RouteWebAppUX/assets/nls/RouteWebAppUX","DS/ENXESignature/Views/Dialogs/ESignatureAuthDialog","DS/Windows/ImmersiveFrame","DS/RouteWebAppUX/Model/RouteWebAppTaskAttachmentModel","DS/RouteWebAppUX/Controller/RouteWebAppCollabTaskServicesController","DS/DocumentManagement/DocumentManagement","DS/RouteWebAppUX/RouteWebAppBootstrap","DS/RouteWebAppUX/Controller/RouteWebAppESignServicesController"],function(e,t,n,o,i,a,s,r){"use strict";let l,u=function(t,n,o,a,s){var r=[];let l=[],u=[],f=[];var A=o.autoCompleteComponent;null!=A&&null!=A.selectedItems&&0!=A.selectedItems.length&&A.selectedItems.forEach(function(e){if(e.options.grid&&"upload"==e.options.grid.action)r.push(e.options.value);else{let t={};t.id=e.options.value,t.updateAction="CONNECT",l.push(t),u.push(e.options.value)}}),p(t,l,f),d(r,t.model.id).then(o=>{var r=o;null!=o&&0!=o.length&&o.forEach(function(e){let t={};t.id=e.data[0].id,t.updateAction="CONNECT",l.push(t)}),"saveForLater"==t.model.taskActionButton?c(t,n,l,a,s,r):i.updateTaskAttachment(t,l).then(e=>{c(t,n,l,a,s,r,u,f)},t=>{widget.routeWebAppMediator.publish("approval-dialog-button-enable");var n=e.failAttachment;null!=r&&m(r),t.error?widget.routeWebAppNotify.handler().addNotif({level:"error",title:n,message:t.error,sticky:!1}):widget.routeWebAppNotify.handler().addNotif({level:"error",subtitle:n,sticky:!1})})},t=>{widget.routeWebAppMediator.publish("approval-dialog-button-enable");var n=e.failUpload;t&&t.result&&m(t.result),t.error?widget.routeWebAppNotify.handler().addNotif({level:"error",title:n,message:t.error,sticky:!1}):widget.routeWebAppNotify.handler().addNotif({level:"error",subtitle:n,sticky:!1})})},c=function(e,t,n,o,a,s,l,u){i.updateComment(e,t,n).then(t=>{if(null!=e.model.eSignRecordId){let t=e.model.eSignRecordId;r.updateEsignRecordInformation(e,t).then(t=>{let n={level:"success",subtitle:o,sticky:!1};widget.routeWebAppMediator.publish("approval-dialog-close"),widget.routeWebAppMediator.publish("approval-dialog-show-message",{message:n}),widget.routeWebAppMediator.publish("task-action-on-save",e)},e=>{console.log("Failed to update esign"+e)})}else{let t={level:"success",subtitle:o,sticky:!1};widget.routeWebAppMediator.publish("approval-dialog-close"),widget.routeWebAppMediator.publish("approval-dialog-show-message",{message:t}),widget.routeWebAppMediator.publish("task-action-on-save",e)}},t=>{null!=s&&m(s),null!=l&&f(l,e.model.id),null!=u&&u.length>0&&i.updateTaskAttachment(e,u),widget.routeWebAppMediator.publish("approval-dialog-button-enable"),t.error?widget.routeWebAppNotify.handler().addNotif({level:"error",title:a,subtitle:t.error,sticky:!1}):widget.routeWebAppNotify.handler().addNotif({level:"error",subtitle:a,sticky:!1})})},p=function(e,t,n){if(e.model.taskAttachments){let i=o.getContentIDs(),a=[];for(let t=0;t<e.model.taskAttachments.length;t++)a.push(e.model.taskAttachments[t].id);for(let e=0;e<a.length;e++)if(!i.includes(a[e])){let o={},i={};o.id=a[e],o.updateAction="DISCONNECT",t.push(o),(i=JSON.parse(JSON.stringify(o))).updateAction="CONNECT",n.push(i)}}},d=function(e,t){var n=[],o=0;return new Promise(function(t,i){0==e.length&&t();for(var r=0;r<e.length;r++){var l={onFailure:function(e){e.result=n,i(e)},onComplete:function(e){o++,n.push(e),r==o&&t(n)}};l.tenant=s.getTenantValue(),l.securityContext=s.getSecurityContextValue(),l.tenantUrl=s.get3DSpaceURL();var u={fileName:e[r].name,fileInfo:{file:e[r]}};a.createDocument(u,l)}})},m=function(e){var t=0;return new Promise(function(n,o){0==e.length&&n();for(var i=0;i<e.length;i++){var r={onFailure:function(e){o()},onComplete:function(e){i==++t&&n()}};r.tenant=s.getTenantValue(),r.securityContext=s.getSecurityContextValue(),r.tenantUrl=s.get3DSpaceURL(),a.deleteDocument(e[i].data[0].id,r)}})},f=function(e,t){var n=0;return new Promise(function(o,i){0==e.length&&o();for(var r=0;r<e.length;r++){var l={onFailure:function(e){i()},onComplete:function(e){r==++n&&o()}};l.relInfo={parentId:t,parentRelName:"Reference Document",parentDirection:"from"},l.tenant=s.getTenantValue(),l.securityContext=s.getSecurityContextValue(),l.tenantUrl=s.get3DSpaceURL(),a.disconnectDocumentFromParent(e[r],l)}})};return l={taskActionUpdate:(n,o)=>(function(n,o){var i={model:{}};i.model.id=n.taskId,i.model.comments=n.taskComment.value,i.model.taskActionButton=n.taskAction,i.model.needsOwnerReview=n.needsOwnerReview,i.model.taskAttachments=n.taskAttachments,i.model.revision=n.revision,"Review"==n.state&&(i.model.state=n.state,i.model.reviewersComments=n.taskComment.value,i.model.taskReviewButton=n.taskAction);var a=e.taskSave,r=e.taskSaveError;if("saveForLater"!=n.taskAction&&"Review"!=n.state?"Yes"==i.model.needsOwnerReview?(a=e.taskSentForReview,r=e.taskSentForReviewError):(a=e.taskCompleted,r=e.taskCompletedError):"saveForLater"!=n.taskAction&&"Review"==n.state&&(a=e.successReviewTaskPromote,r=e.failReviewTask,"Reject"==n.taskAction&&(a=e.successReviewTaskDemote)),"Approve"!=n.taskAction&&"Reject"!=n.taskAction&&"Abstain"!=n.taskAction||"True"!=o.requiresEsign)u(i,o,n,a,r);else{var l,c;c=s.getTenantValue();var p=n.taskAssigneeUserName,d=i.model.taskActionButton;"Reject"==d&&(d="Disapprove"),l={eSignPolicyReference:"ESignConfigRoute",Username:p,x3dPlatformId:c,ObjectActionType:d};var m="",f=t.init(l);f.subscribe("ESign-Dialog-Close",function(){widget.routeWebAppMediator.publish("approval-dialog-button-enable")}),f.subscribe("ESign-Authenticated",function(e){m=e.ESignRecordId,i.model.eSignRecordId=m,u(i,o,n,a,r)})}})(n,o)}}),define("DS/RouteWebAppUX/Views/Grid/RouteWebAppTaskAttachmentsDataGridView",["DS/RouteWebAppUX/Views/Menu/AttachmentContextualMenu","DS/RouteWebAppUX/Model/RouteWebAppTaskAttachmentModel","DS/DataGridView/DataGridViewLayout","DS/DataGridView/DataGridView","i18n!DS/RouteWebAppUX/assets/nls/RouteWebAppUX"],function(e,t,n,o,i){"use strict";let a,s,r={},l=function(){t.deleteSelectedRows(),u()},u=function(){var e=document.querySelector("#approvalDialogTaskAttachments-dataGridViewContainer");!e&&s&&(e=s);let t=a.getRowModelLength();s&&(t<5?s.setStyle("height",41*t+"px"):s.setStyle("height","200px"))},c=function(t,i,s){return r={treeDocument:t,columns:i,layout:new n({rowsHeader:!1,columnsHeader:!1,rowSpacing:5,cellWidth:2}),defaultColumnDef:{widthd:"auto",typeRepresentation:"string"},virtuallyLoadAllModelItems:!0,cellDragEnabledFlag:!1,showRowBorderFlag:!0,showOutlineFlag:!0,showAlternateBackgroundFlag:!1,showContextualMenuColumnFlag:!0,onContextualEvent:function(t){t&&t.cellInfos&&e.taskAttachmentContextualMenu(t,t.cellInfos.nodeModel,!1,l,function(e){console.log("asd")})}},(a=new o(r)).layout.cellHeight=35,a.rowSelection="multiple",a.cellSelection="none",a.getContent().style.top="50 px",a.inject(s),s};return{build:e=>(function(e){s=UWA.createElement("div",{id:"approvalDialogTaskAttachments-dataGridViewContainer",class:"approval-dialog-taskAttachments-gridView-View"});let t=[{text:i.title,dataIndex:"tree"}],n=c(e,t,s);return u(),require(["DS/RouteWebAppUX/Views/Menu/AttachmentContextualMenu"],function(e){e.isDocumentManagementInstalled()}),n})(e)}}),define("DS/RouteWebAppUX/Views/Form/RouteTaskAttachments",["DS/WUXAutoComplete/AutoComplete","DS/UIKIT/Input/File","DS/TreeModel/TreeNodeModel","DS/RouteWebAppUX/Views/Loader/RouteWebAppInitiateDocumentChooser","DS/RouteWebAppUX/Services/RouteWebAppRouteTaskServices","DS/RouteWebAppUX/Model/RouteWebAppTaskAttachmentModel","DS/RouteWebAppUX/Views/Grid/RouteWebAppTaskAttachmentsDataGridView","i18n!DS/RouteWebAppUX/assets/nls/RouteWebAppUX","css!DS/RouteWebAppUX/RouteWebAppUX.css"],function(e,t,n,o,i,a,s,r){"use strict";let l=function(e){return new t({input:!1,multiple:!0,buttonText:"",buttonClassName:"fonticon fonticon-upload",events:{onChange:function(t){for(var o=0;o<t.target.files.length;o++){var i=new n({label:t.target.files[o].name,value:t.target.files[o],grid:{action:"upload"}});i.options.value.options="",null==e.selectedItems?e.selectedItems=i:e.selectedItems.push(i),e._applySelectedItems()}}}})},u=function(e){var t=UWA.createElement("div",{class:"fonticon fonticon-plus",id:"attachmentSearch",title:r.addExistingAttachment});return t.addEventListener("click",function(t){o.init(t,e.autoCompleteComponent,a.getContentIDs())}),t};return{drawListOfAttachments:(e,t)=>(function(e,t){var n=new UWA.Element("div",{id:"approvalDialogTaskAttachmentsId",class:""});if(e&&e.length>0){a.destroy(),a.createModel(e),a.getModel().RouteId=t.id;let o=a.getModel();s.build(o).inject(n)}return n})(e,t),renderAttachmentField:e=>(function(e){var t=new UWA.Element("div",{class:"attachmentField"});new UWA.Element("h5",{class:"attachmentHeader",text:r.attachments}).inject(t);var n=new UWA.Element("div",{class:"attachmentButton"}),o=l(e.autoCompleteComponent);o.elements.input.title=r.upload,o.inject(n),u(e).inject(n),n.inject(t),t.inject(e.formFields)})(e),getAutoComponent:t=>(function(t){return new e({multiSearchMode:!0,elementsTree:function(e){return new Promise(function(n,o){var s=a.getContentIDs();null!=t.autoCompleteComponent&&null!=t.autoCompleteComponent.selectedItems&&0!=t.autoCompleteComponent.selectedItems.length&&t.autoCompleteComponent.selectedItems.forEach(function(e){null==e.options.value.name&&s.push(e.options.value)});var r={with_indexing_date:!0,with_nls:!1,label:"yus-1515078503005",locale:"en",select_predicate:["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:responsible","ds6wg:fullname"],select_file:["icon","thumbnail_2d"],query:"("+e+' AND NOT (flattenedtaxonomies:"types/Person" OR flattenedtaxonomies:"types/Business Role" OR flattenedtaxonomies:"types/Security Context" OR flattenedtaxonomies:"types/Route" OR flattenedtaxonomies:"types/Route Template" OR flattenedtaxonomies:"types/Inbox Task"))',order_by:"desc",order_field:"relevance",nresults:1e3,start:"0",source:[],tenant:"OnPremise",resourceid_not_in:s};r=JSON.stringify(r);var l={isfederated:!0};i.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",r,function(e){var t=[];e&&e.results&&Array.isArray(e.results)&&e.results.forEach(function(e){var n={};e.attributes.forEach(function(e){"ds6w:what/ds6w:type"===e.name&&(n.type=e.value),"resourceid"===e.name&&(n.value=e.value),"ds6w:label"===e.name&&(n.label=e.value),"ds6w:identifier"===e.name&&(n.name=e.value)}),n.data=n,t.push(n)}),n(t)},function(e){o(e)},l)})},placeholder:r.typeToSearch,minLengthBeforeSearch:3,allowFreeInputFlag:!1})})(t)}}),define("DS/RouteWebAppUX/Views/Dialog/TaskApprovalDialog",["DS/Windows/Dialog","DS/Controls/Editor","DS/Controls/Button","DS/Windows/ImmersiveFrame","DS/RouteWebAppUX/Controller/RouteWebAppCollabTaskServicesController","DS/RouteWebAppUX/Views/Form/RouteTaskAttachments","DS/RouteWebAppUX/Views/Form/RouteWebAppTaskViewUtil","i18n!DS/RouteWebAppUX/assets/nls/RouteWebAppUX"],function(e,t,n,o,i,a,s,r){"use strict";let l,u=function(i,l,u){let p,d=new UWA.Element("div",{id:"TaskApprovalDialog",class:""});!function(){let e=new UWA.Element("h5",{class:"required",text:r.comments}).inject(d);UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(e),"Review"==i.state?i.taskComment=i.taskReviewComment:i.taskComment=i.taskApproveComment;i.taskComment=new t({placeholder:r.addCommentPlaceHolder,widthInCharNumber:30,nbRows:4,newLineMode:"enter",value:i.taskComment}).inject(d);let n=i.taskComment._myInput;null!=n&&(n.style.width="100%",n.style.resize="both",n.style.overflow="auto")}(),i.formFields=new UWA.Element("div",{id:"taskAttachmentContainer",class:"task-attachment-container"}),i.formFields.inject(d),i.autoCompleteComponent=a.getAutoComponent(i),a.renderAttachmentField(i),i.autoCompleteComponent.inject(i.formFields),new UWA.Element("div",{html:"&nbsp;"}).inject(i.formFields),c(i,l);let m=!0;i.taskComment.value&&""!=i.taskComment.value&&(m=!1);let f=u,A=r[f],b=r[f+"Progressing"],v=i.taskAttachments.length,g=v<4?249+41*v:380,h=new o;function R(){p.buttons.Ok.disabled=!0,p.buttons.Apply.disabled=!0}h.inject(document.body),p=new e({modalFlag:!0,width:432,height:g,title:A+" - "+i.taskTitle,content:d,immersiveFrame:h,resizableFlag:!0,buttons:{Ok:new n({label:A,disabled:m,onClick:function(e){e.dsModel.label=b,R(),i.taskAction=u,s.taskActionUpdate(i,l),widget.routeWebAppMediator.subscribe("approval-dialog-close",function(){e.dsModel.dialog.close()})}}),Apply:new n({label:r.save,disabled:m,onClick:function(e){e.dsModel.label=r.SaveProgressing,R(),i.taskAction="saveForLater",s.taskActionUpdate(i,l),widget.routeWebAppMediator.subscribe("approval-dialog-close",function(){e.dsModel.dialog.close()})}}),Cancel:new n({label:r.cancel,onClick:function(e){e.dsModel.dialog.close()}})}}),i.taskComment.addEventListener("change",function(){""!=i.taskComment.value.trim()?(p.buttons.Ok.disabled=!1,p.buttons.Apply.disabled=!1):(p.buttons.Ok.disabled=!0,p.buttons.Apply.disabled=!0)}),widget.routeWebAppMediator.subscribe("approval-dialog-button-enable",function(){p.buttons.Ok.disabled=!1,p.buttons.Apply.disabled=!1,p.buttons.Ok.label=A,p.buttons.Apply.label=r.save}),p.addEventListener("close",function(){widget.routeWebAppMediator.publish("approval-commands-buttons-enable")})},c=function(e,t){if(e.taskAttachments&&e.taskAttachments.length>0){a.drawListOfAttachments(e.taskAttachments,t).inject(e.formFields)}},p=function(e,t){return"Assigned"==e||"Assign"==e?["Approve","Reject","Abstain","Comment"].includes(t):"Review"==e&&["Accept","Reject"].includes(t)};return l={init:e=>(function(e){let t=e.routeId,n=e.taskId,o=e.action,a=r.taskIdIncorrect;if(e.securityContext&&e.tenant&&(widget.data.routeCredentials={securityContext:e.securityContext,tenant:e.tenant}),!t||!n||""==t||""==n)return widget.routeWebAppMediator.publish("approval-commands-buttons-enable"),void widget.routeWebAppNotify.handler().addNotif({level:"error",subtitle:a,sticky:!1});i.fetchRouteTask(n).then(e=>{var i=e.data[0];if(!p(i.dataelements.state,o))return widget.routeWebAppMediator.publish("approval-commands-buttons-enable"),void widget.routeWebAppNotify.handler().addNotif({level:"error",subtitle:r.actionNotAllowed,sticky:!1});let a={},s={};a.taskId=n,a.taskTitle=i.dataelements.title,a.taskApproveComment=i.dataelements.routeTaskApprovalComments,a.taskReviewComment=i.dataelements.routeTaskReviewerComments,a.needsOwnerReview=i.dataelements.needsReview,a.taskAssigneeUserName=i.relateddata.assignees[0].dataelements.name,a.state=i.dataelements.state,a.taskAttachments=i.relateddata.references,s.id=t,s.requiresEsign=i.dataelements.routeTaskRequiresESign,a.revision=i.dataelements.revision,u(a,s,o)},e=>{widget.routeWebAppMediator.publish("approval-commands-buttons-enable"),e.error?widget.routeWebAppNotify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.routeWebAppNotify.handler().addNotif({level:"error",subtitle:a,sticky:!1})})})(e)}}),define("DS/RouteWebAppUX/Views/Menu/RouteTaskActionsCtxMenu",["DS/Menu/Menu","DS/RouteWebAppUX/Views/Dialog/TaskApprovalDialog","DS/RouteWebAppUX/Commands/RouteApprovalProcess","DS/RouteWebAppUX/Commands/ApprovalMaturityCmd","DS/RouteWebAppUX/Utilities/RouteLinkWidget","DS/RouteWebAppUX/Utilities/CompassDataExchange","i18n!DS/RouteWebAppUX/assets/nls/RouteWebAppUX","css!DS/RouteWebAppUX/RouteWebAppUX.css"],function(e,t,n,o,i,a,s){"use strict";const r={Approve:{icon:"thumbs-up",title:s.approve,color:"#57b847",className:"RActionApprove"},Reject:{icon:"thumbs-down",title:s.reject,color:"#ea4f37",className:"RActionReject"},Abstain:{icon:"ignore",title:s.abstain},Comment:{icon:"comment",title:s.comment},Accept:{icon:"check",title:s.accept,color:"#57b847",className:"RActionAccept"}},l=function(e,t){return new Promise(function(n,o){let a=[];if(t&&null!=e.model&&null!=e.model.route&&0!=e.model.route.length)if(-1!==t.indexOf("Approve")?(a.push(u("Approve",e)),a.push(u("Reject",e)),1==e.model.showAbstain&&a.push(u("Abstain",e))):-1!==t.indexOf("Comment")?a.push(u("Comment",e)):-1!==t.indexOf("Review")&&(a.push(u("Accept",e)),a.push(u("Reject",e))),"idcard-ctxCommand"==e.model.fromPage&&a.push(p(e)),i.getWidgetLinkInstance()&&i.checkIfLinked())a.push(d(e)),n(a);else{m(e.model).then(e=>{a.push(c(e)),n(a)},e=>{n(a)})}else n(a)})},u=function(e,n){let o="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+r[e].icon;return r[e].color&&(o+=" "+r[e].className),{name:r[e].title,title:r[e].title,type:"PushItem",fonticon:{content:o},data:null,action:{callback:function(){n.model.action=e,t.init(n.model)}}}},c=function(e){return{name:e.title,title:e.title,type:e.type,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+e.icon},data:null,action:{callback:function(){e.action.callback()}}}},p=function(e){return{name:s.maturity,title:s.maturity,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-collaborative-lifecycle-management"},data:null,action:{callback:function(){o.lifeCycle(e)}}}},d=function(e){return{name:s.approvalProcess,title:s.approvalProcess,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-route"},data:null,action:{callback:function(){let t=a.getContentToLink(e.model);i.loadContent(t)}}}},m=function(e){return n.getOpenWithMenu(e)};return{renderApprovalsActionMenu:(t,n)=>(function(t,n){if(!n)return"";return UWA.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-chevron-down ",title:s.idCardCtxMenuTooltip,styles:{"font-size":"18px"},events:{click:function(o){let i=o.target.getBoundingClientRect(),a={position:{x:i.left,y:i.top+20}};t.model.fromPage="idcard-ctxCommand",l(t,n).then(t=>{e.show(t,a)})}}})})(t,n),getApprovalActionsMenu:(e,t)=>l(e,t),getApprovalCommandMenu:e=>m(e)}}),define("DS/RouteWebAppUX/Views/RouteActivityState",["DS/RouteWebAppUX/Utilities/RouteWebAppRouteViewUtils","DS/RouteWebAppUX/Views/Menu/RouteTaskActionsCtxMenu","DS/RouteWebAppUX/Utilities/RouteLinkWidget","DS/RouteWebAppUX/Utilities/CompassDataExchange","i18n!DS/RouteWebAppUX/assets/nls/RouteWebAppUX","css!DS/RouteWebAppUX/RouteWebAppUX.css"],function(e,t,n,o,i){"use strict";const a=function(e){if(e.model.fromPage="hyperlink",n.getWidgetLinkInstance()&&n.checkIfLinked()){let t=o.getContentToLink(e.model);n.loadContent(t)}else{t.getApprovalCommandMenu(e.model).then(e=>{e.action.callback()},e=>{})}};return{renderActivityState:t=>(function(t){let n;if(t.model.state&&"In Process"==t.model.state){n=UWA.createElement("div",{class:"activity-state-container"});let o=e.getRouteActivityStateIcon(t.model.Activity_State),i=e.getRouteActivityStateNLS(t.model.Activity_State),s="";"thumbs-up"==o||"comment"==o||"notification-read"==o?s="#008000":"thumbs-down"==o||"stop"==o?s="#ff0000":("ignore"==o||"play-flash-off"==o||"hourglass"==o&&!i.contains("your"))&&(s="#77797c");let r=UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+o,styles:{color:s}}).inject(n);if(t.model.Activity_State&&t.model.Activity_State.contains("your")){let e;if(t.model.Activity_State.contains("(")){const t=i.split("(");i=t[0],e="("+t[1]}r.addClassName("awaiting-tasks"),UWA.createElement("a",{class:"rt-activity-state",html:"&nbsp;"+i,title:i,events:{click:function(e){a(t)}},styles:{cursor:"pointer"}}).inject(n),e&&UWA.createElement("a",{class:"rt-activity-state-counter",html:"&nbsp;"+e+"&nbsp;",title:i,events:{click:function(e){a(t)}},styles:{cursor:"pointer"}}).inject(n)}else UWA.createElement("span",{class:"rt-activity-state",html:"&nbsp;"+i+"&nbsp;",title:i,styles:{color:"#77797c"}}).inject(n)}return n})(t),getRouteActivityState:(t,n)=>(function(t,n){let o=e.getRouteActivityStateNLS(t),i={icon:e.getRouteActivityStateIcon(t),label:o};return t&&t.contains("your")?(i.func=function(e){a(n)},i.icon+=" awaiting-tasks"):i.func=void 0,i})(t,n)}}),define("DS/RouteWebAppUX/scripts/RouteWebAppApprovalStatusUX",["DS/RouteWebAppUX/Controller/RouteWebAppApprovalStatusServiceController","DS/RouteWebAppUX/Utilities/RouteWebAppRouteViewUtils","DS/RouteWebAppUX/Views/RouteActivityState","DS/RouteWebAppUX/RouteWebAppBootstrap","DS/RouteWebAppUX/Views/Menu/RouteTaskActionsCtxMenu","DS/RouteWebAppUX/Utilities/CompassDataExchange","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","i18n!DS/RouteWebAppUX/assets/nls/RouteWebAppUX"],function(e,t,n,o,i,a,s,r,l){"use strict";return{getName:function(){return l.approvalStatus},getColumnApprovalStatusValue:function(t){return new Promise(function(i,u){t&&t.option&&(widget.data.routeCredentials={securityContext:t.option.securityContext,tenant:t.option.tenant},t.option=void 0),o.init().then(o=>{e.fetchApprovalStatusForContent(t).then(e=>{var t;if(null!=e){t={};for(var o=0;o<e.data.length;o++){var s=a.createModel(e.data[o]),r=e.data[o].id;t[r]={},t[r].approvalStatus=n.getRouteActivityState(s.model.Activity_State,s),t[r].approvalStatusModel=s}}i(t)},e=>{r.setNotificationManager(s),s.addNotif({level:"error",subtitle:l.errorMessage,sticky:!1}),i()})})})},compareApprovalStatus:function(e,t){let n,o;return n=e&&e.label?e.label.trim():"",o=t&&t.label?t.label.trim():"",n.localeCompare(o)},getColumnApprovalStatusMenu:function(e){e.model.fromPage="summarypage-ctxCommand";var t=a.getActionsBasedOnApprovalStatus(e.model.approvalAction);return i.getApprovalActionsMenu(e,t)}}}),define("DS/RouteWebAppUX/Views/RouteTaskActionsCmd",["DS/RouteWebAppUX/Utilities/RouteWebAppRouteViewUtils","DS/RouteWebAppUX/Views/Dialog/TaskApprovalDialog","DS/Controls/Button","i18n!DS/RouteWebAppUX/assets/nls/RouteWebAppUX","css!DS/RouteWebAppUX/RouteWebAppUX.css"],function(e,t,n,o){"use strict";return{renderTaskActionCommands:i=>(function(i){if(i.model.state&&"In Process"==i.model.state){let a=i.model.approvalAction,s=!0,r=UWA.createElement("div",{class:"approval-action-container"}),l=e.getApprovalActionIcon(a);for(const e of l){let l=new n({displayStyle:"normal",domId:"RApprovalAction",emphasize:e.emphasize,icon:{iconName:e.icon,fontIconFamily:WUXManagedFontIcons.Font3DS}});l.inject(r),l.getContent().addEventListener("buttonclick",function(){l.disabled=!0,i.model.action=e.action,t.init(i.model)}),widget.routeWebAppMediator.subscribe("approval-commands-buttons-enable",function(){l.disabled=!1,s=!0}),"Comment"==a&&UWA.createElement("a",{class:"approval-action-text",html:o.comment,events:{click:function(n){1==s&&(s=!1,i.model.action=e.action,t.init(i.model))}}}).inject(r)}return r}})(i)}}),define("DS/RouteWebAppUX/RouteApprovalsIDCardUX",["DS/RouteWebAppUX/Views/RouteActivityState","DS/RouteWebAppUX/Views/Menu/RouteTaskActionsCtxMenu","DS/RouteWebAppUX/Views/RouteTaskActionsCmd","DS/RouteWebAppUX/Controller/RouteWebAppApprovalStatusServiceController","DS/RouteWebAppUX/RouteWebAppBootstrap","DS/RouteWebAppUX/Utilities/CompassDataExchange","i18n!DS/RouteWebAppUX/assets/nls/RouteWebAppUX","css!DS/RouteWebAppUX/RouteWebAppUX.css"],function(e,t,n,o,i,a,s){"use strict";let r,l,u,c,p=[];const d=function(o,i,s){r=o,l=s,u=i,widget.data.routeCredentials={securityContext:i.securityContext,tenant:i.tenant},m(i).then(i=>{if(""===i.model.Activity_State)return void s();c=UWA.createElement("div",{class:"route-approvals-container"}).inject(o);let r=UWA.createElement("div",{class:"route-approval-status-container"}).inject(c);if(i.model.approvalAction){n.renderTaskActionCommands(i).inject(r)}else{e.renderActivityState(i).inject(r)}let l=a.getActionsBasedOnApprovalStatus(i.model.approvalAction);t.renderApprovalsActionMenu(i,l).inject(c),f()})},m=function(e){let t=[];var n={};n.id=e.id,t.push(n);let i={data:t};return new Promise(function(e,t){o.fetchApprovalStatusForContent(i).then(t=>{let n=a.createModel(t.data[0]);e(n)},t=>{widget.routeWebAppNotify.handler().addNotif({level:"error",subtitle:s.errorMessage,sticky:!0}),e()})})};const f=function(){let e=widget.routeWebAppMediator.subscribe("task-action-on-save",function(e){A()});p.push(e),e=widget.routeWebAppMediator.subscribe("maturity-save",function(e){A()}),p.push(e),function(){let e=widget.routeWebAppMediator.subscribe("approval-dialog-show-message",function(e){widget.routeWebAppNotify.handler().addNotif(e.message)});p.push(e)}()},A=function(){b(),d(r,u,l)},b=function(){c.destroy(),p.forEach((e,t)=>{widget.routeWebAppMediator.unsubscribe(e)})};return{init:(e,t,n)=>{i.init().then(o=>{d(e,t,n)})}}});