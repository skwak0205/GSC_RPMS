define("DS/WebInWinHelper/WebInWinHelper",["UWA/Class","DS/WebToWinInfra/WebToWinCom","DS/WebappsUtils/WebappsUtils","DS/LifecycleServices/LifecycleServicesSettings"],function(e,t,i,n){"use strict";return e.singleton({init:function(){},createWebInWinSocket:function(e){return t.createSocket({socket_id:e+Math.floor(1e5*Math.random()+1)})},parseContextualMenu:function(e){return t.parseContextualMenu(e)},createJSONArraySelect:function(e){for(var t=[],i=0;i<e.length;i++){var n={id:e[i].physicalid,session_object:!1};t.push(n)}return'{ "objects_name": '+JSON.stringify(t)+"}"},createJSONArraySelectWithCSOTrue:function(e){for(var t=[],i=0;i<e.length;i++){var n={id:e[i].physicalid,session_object:!0};t.push(n)}return'{ "objects_name": '+JSON.stringify(t)+"}"},createJSONArrayActionWithArgs:function(e,t){for(var i={action:e,objectIds:[],Args:[]},n=0;n<t.length;n++)i.objectIds.push(t[n].physicalid),i.Args.push({Name:t[n].Name,Value:t[n].Value});return JSON.stringify(i)},createMaturityJSONArray:function(e,t,i){for(var n=[],a=0;a<e.length;a++){var o={},r=[],s=Object.getOwnPropertyNames(e[a]);for(let t in s)if(s.hasOwnProperty(t)){var c=s[t];r.push({name:c,value:e[a][c]})}o.attributes=r,n.push(o)}var l={objects_name:[{action:"Maturity",report:t,objectId:n,status:i}]};JSON.stringify(l);return JSON.stringify(l)},createJSONArrayActionWithStates:function(e,t,i,n){for(var a={action:e,report:i,Args:[],status:n},o=0;o<t.length;o++)a.Args.push({Name:t[o].Name,Value:t[o].Value});return JSON.stringify(a)},setContextRestoreSelection:function(e,t){},setCSOSelection:function(e,t,i){var n=[];t.forEach(function(e){var t,i;void 0!==e.physicalId?t=e.physicalId:void 0!==e.physicalid?t=e.physicalid:void 0!==e.id?t=e.id:void 0!==e._options&&void 0!==e._options.id&&(t=e._options.id),void 0!==e.name?i=e.name:void 0!==e.displayName?i=e.displayName:void 0!==e._options&&void 0!==e._options.label&&(i=e._options.label);var a={physicalid:t,name:i};n.push(a)});var a=this.createJSONArraySelect(n);e.dispatchEvent("onDispatchToWin",{notif_name:void 0!==i&&!0===i?"onAddToCSODirect":"onAddToCSO",notif_parameters:a},"lf_web_in_win")},setCSOSelectionIteration:function(e,t){var i=[];t.forEach(function(e){var t,n;void 0!==e.physicalId?t=e.physicalId:void 0!==e.physicalid?t=e.physicalid:void 0!==e.id&&(t=e.id),void 0!==e.name?n=e.name:void 0!==e.displayName&&(n=e.displayName);var a={physicalid:t,name:n};i.push(a)});var n=this.createJSONArraySelectWithCSOTrue(i);e.dispatchEvent("onDispatchToWin",{notif_name:"onAddToCSO",notif_parameters:n},"lf_web_in_win")},fetchContextFromSelection:function(e,t){var i=[];t.forEach(function(e){var t,n;void 0!==e.physicalId?t=e.physicalId:void 0!==e.physicalid&&(t=e.physicalid),void 0!==e.name?n=e.name:void 0!==e.displayName&&(n=e.displayName);var a={physicalid:t,name:n};i.push(a)});var n=this.createJSONArraySelect(i);e.dispatchEvent("onDispatchToWin",{notif_name:"onActionClickDottedNoCSO",notif_parameters:n},"lf_web_in_win")},closePanel:function(e){e.dispatchEvent("onDispatchToWin",{notif_name:"ClosePanel",notif_parameters:"ClosePanel"},"lf_web_in_win")},viewReadyFireWintopNotif:function(e){e.dispatchEvent("onDispatchToWin",{notif_name:"onViewReady",notif_parameters:'{ "action": "onViewReady" }'},"lf_web_in_win")},fireWintopCommand:function(e,i,n){var a=[];null!==i&&a.push({physicalid:i.id,id:i.id,displayName:i.displayName});var o=t.createJSONArrayAction(n,a);if(o.length>0){this.setCSOSelection(e,a),e.dispatchEvent("onDispatchToWin",{notif_name:"onCtxMenuClick",notif_parameters:o},"lf_web_in_win")}},onBuildWinContextMenu:function(e,t,n,a){for(var o,r=i.getWebappsBaseUrl()+"WebInWinHelper/assets/icons/32/",s=0;s<t.length;s++){var c=t[s];if(void 0===c.items){var l=c.actionId;if("Copy"!=l){var p=c.icon,d=(c.menu,c.text),h=c.accelerator;o=""==p||void 0===p?"":"url("+r+(p=p.replace(".png",""))+".png)",this.addMenuContextNode(e,n,l,d,h,o,a)}}else{var u=[];this.onBuildWinContextMenu(e,c.items,u,a);var f={title:c.text,submenu:u,type:"PushItem"};n.push(f)}}},addMenuContextNode:function(e,t,i,n,a,o,r){var s=this,c=i,l={callback:function(){s.fireWintopCommand(e,r,c)}};t.push({title:n,type:"PushItem",icon:o,action:l,accelerator:a})},launchWinRestoreIterations:function(e,i,n){var a=[];null!==i&&a.push({physicalid:i.physicalid}),null!==n&&a.push({physicalid:n.physicalid});var o=t.createJSONArrayAction("CATImmRestoreItertionCmd",a);o.length>0&&e.dispatchEvent("onDispatchToWin",{notif_name:"onCtxMenuClick",notif_parameters:o},"lf_web_in_win")},launchWinCompareIterations:function(e,t,i){var n=[];null!==t&&n.push({physicalid:t.physicalid,Name:"name1",Value:t.name}),null!==i&&n.push({physicalid:i.physicalid,Name:"name2",Value:i.name});var a=this.createJSONArrayActionWithArgs("CATImmCompareIterationBaseCmd",n);a.length>0&&e.dispatchEvent("onDispatchToWin",{notif_name:"onCtxMenuClick",notif_parameters:a},"lf_web_in_win")},sendGetLicenseNotif:function(e){e.dispatchEvent("onDispatchToWin",{notif_name:"controlLicense"},"lf_web_in_win")},sendModelLoadedNotif:function(e){e.dispatchEvent("onDispatchToWin",{notif_name:"modelLoaded"},"lf_web_in_win")},launchWinOpenIterations:function(e,t){var i={action:"CATImmOpenIterationCmd",Args:[]};if(0!=t.length){for(var n=0;n<t.length;n++){var a=n+1,o="name".concat(a),r="date".concat(a),s="physicalId".concat(a);i.Args.push({Name:o,Value:t[n].name},{Name:r,Value:t[n].date},{Name:s,Value:t[n].physicalid})}var c=JSON.stringify(i);c.length>0&&e.dispatchEvent("onDispatchToWin",{notif_name:"onCtxMenuClick",notif_parameters:c},"lf_web_in_win")}},launchWinCompare:function(e,i,n){var a=[];null!==n&&a.push({physicalid:n.id}),null!==i&&a.push({physicalid:i.id});var o=t.createJSONArrayAction("CATPLMCompareHdr",a);o.length>0&&e.dispatchEvent("onDispatchToWin",{notif_name:"onCtxMenuClick",notif_parameters:o},"lf_web_in_win")},getJSONArrayFromSelectionData:function(e,t,i){var n;if(null!==t&&void 0!==t.selectedNodes)for(n=0;n<t.selectedNodes.length;n++)i.push({physicalid:t.selectedNodes[n]._options.id,displayName:t.selectedNodes[n]._options.label})},fireWintopCommandWithArgs:function(e,i,n){var a,o=n,r=[];if(null!==i&&void 0!==i.selectedNodes)for(a=0;a<i.selectedNodes.length;a++)r.push({physicalid:i.selectedNodes[a]._options.id});var s=t.createJSONArrayAction(o,r);s.length>0&&e.dispatchEvent("onDispatchToWin",{notif_name:"onCtxMenuClick",notif_parameters:s},"lf_web_in_win")},fireWintopMaturityCompletedCommandWithArgs:function(e,t,i){var n,a=i,o=[],r=[],s="";if(t&&t.hasOwnProperty("data")&&null!==t.data)for(n=0;n<t.data.length;n++)o.push({Name:t.data[n].physicalid,Value:{fromstate:t.data[n].fromstate,tostate:t.data[n].tostate}});t&&t.hasOwnProperty("report")&&(r=t.report),t&&t.hasOwnProperty("status")&&(s=t.status);var c=this.createJSONArrayActionWithStates(a,o,r,s);c.length>0&&e.dispatchEvent("onDispatchToWin",{notif_name:"onCtxMenuClick",notif_parameters:c},"lf_web_in_win")},getServices:function(e){if(e.options.wintop){var t;t=void 0===e.options.platform_services?e.options.serverUrl:e.options.platform_services;var i={wintop:e.options.wintop,platform_services:t};return n.getInstance(i)}return n},initTenant:function(e){e.options.wintop&&void 0!==e.options.serverUrl&&e.options.serverUrl.length>0&&void 0!==e.options.serverUrl[0].platformId&&(e.tenant=e.options.serverUrl[0].platformId)},loadCssfile:function(e){var t=document.createElement("link");void 0!==t&&(t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",e),document.getElementsByTagName("head")[0].appendChild(t))}})});