define("DS/Windows/DockingElement",["UWA/Core","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Utils","DS/Utilities/Dom","UWA/Utils/Client","DS/WebRecordEnabler/Adapter","DS/WebRecordBase/Constants","DS/Core/WebUXGlobalEnums"],function(e,t,i,n,o,s,a,r,l){"use strict";var d=t.inherit({name:"dockingElement",markForRecordFlag:!0,publishedProperties:{identifier:{defaultValue:"",type:"string",readOnly:!0,category:"Behavior"},dockingZoneSize:{defaultValue:100,type:"number",advancedSetter:!0,recordFlag:!0},minSize:{defaultValue:20,type:"number"},maxSize:{defaultValue:screen.width,type:"number"},side:{defaultValue:WUXDockAreaEnum.TopDockArea,type:"number"},interactiveDockAreaVisibleFlag:{defaultValue:!1,type:"boolean"},collapsibleFlag:{defaultValue:!0,advancedSetter:!0,type:"boolean"},collapseDockingZoneFlag:{defaultValue:!1,advancedSetter:!0,type:"boolean",recordFlag:!0},overlayDockingZoneFlag:{defaultValue:!1,type:"boolean"},visibleCollapserFlag:{defaultValue:!0,type:"boolean"},visibleDockingZoneFlag:{defaultValue:!0,type:"boolean"},resizableFlag:{defaultValue:!0,type:"boolean"},dockingZoneContent:{defaultValue:null,type:"object"},freeZoneContent:{defaultValue:null,type:"object"},useBordersFlag:{defaultValue:!0,type:"boolean"},useBackgroundFlag:{defaultValue:!1,type:"boolean"},alignment:{defaultValue:"near",type:"string",category:"Appearance"},autoExpandFlag:{defaultValue:!0,type:"boolean"}},_hideClassName:"wux-docking-element-hide-docking-zone",buildView:function(){this.elements.container.addClassName("wux-windows-docking-element"),a.setElementRecordMode(this.elements.container,r.RecordModes.DEFAULT_AND_CHILD),this.elements.dockingWithCollapserContainer=new e.Element("div",{class:"wux-windows-docking-and-collapser"}),this.elements.collapser=new e.Element("div",{class:"wux-windows-docking-element-collapser"}),s.Engine.ie||this.elements.collapser.addClassName("collapser-not-IE"),this.elements.dockingZoneMask=new e.Element("div",{class:"wux-windows-docking-element-docking-zone-mask"}),this.elements.fixedArea=new e.Element("div",{class:"wux-windows-docking-element-fixed-area"}).inject(this.elements.dockingZoneMask),this.elements.dockingZone=new e.Element("div",{class:"wux-windows-docking-element-docking-zone"}).inject(this.elements.dockingZoneMask),this.elements.resizeHandler=new e.Element("div",{class:"wux-windows-docking-element-resize-handler"}).inject(this.elements.dockingZoneMask),this.elements.freeZone=new e.Element("div",{class:"wux-windows-docking-element-free-zone"}),this.elements.hackResize=new e.Element("div",{class:"wux-windows-docking-element-hack-resize"}).inject(this.elements.container),this.elements.hackResize.addClassName(this._hideClassName),this.elements.interactiveDockArea=new e.Element("div",{class:"wux-windows-docking-element-interactive-dock-area"}),this._scrollBarSize=0,this._resizerSize=14,this._collapserSize=20,this._interactiveTimeout=void 0,this._dockingSensibilityZoneSize=30,this.collapseMemory=!1,this.visibleMemory=!1,this._collapserTimer=null,this._expanderTimer=null,this._collapseHoverFlag=!1},_postBuildView:function(){var e=this._getCollapseDockingZoneFlagFromPreferences();e&&(this.collapseDockingZoneFlag=e.collapseDockingZoneFlag)},_applySide:function(){var e=this._getClassName();this.elements.container.addClassName(e),this.elements.collapser.addClassName(e),this.elements.dockingWithCollapserContainer.addClassName(e),this.elements.dockingZoneMask.addClassName(e),this.elements.dockingZone.addClassName(e),this.elements.resizeHandler.addClassName(e),this.elements.freeZone.addClassName(e),this.elements.interactiveDockArea.addClassName(e),this.side&WUXDockAreaEnum.LeftDockArea||this.side&WUXDockAreaEnum.TopDockArea?(this.elements.dockingWithCollapserContainer.inject(this.elements.container),this.elements.collapser.inject(this.elements.dockingWithCollapserContainer),this.elements.dockingZoneMask.inject(this.elements.dockingWithCollapserContainer),this.elements.freeZone.inject(this.elements.container)):(this.elements.freeZone.inject(this.elements.container),this.elements.dockingWithCollapserContainer.inject(this.elements.container),this.elements.dockingZoneMask.inject(this.elements.dockingWithCollapserContainer),this.elements.collapser.inject(this.elements.dockingWithCollapserContainer)),this.elements.interactiveDockArea.inject(this.elements.dockingZoneMask)},_preEditDockingZoneSize:function(e,t){if("100%"===t)return!0;if(void 0!==this.maxSize&&t>this.maxSize)return{validValue:this.maxSize};if(void 0!==this.minSize&&t<this.minSize)return{validValue:this.minSize};if(!o.isCurrentlyCalledFromUIInteraction()&&0===this.getContainedWindows().length){var i=this._getDockingZoneSizeFromPreferences();if(i)return{validValue:i.size}}return!0},_applyDockingZoneSize:function(e){if(this._updateDockingZoneSize(),this._scrollToBottom(),void 0!==e&&this.dockingZoneSize!==e)for(var t=this.getContainedWindows(),i=0;i<t.length;i++)t[i]._fireAndBroadcast("resize",{bubbles:!1})},_applyIdentifier:function(e){this.identifier?(this.getContent().setAttribute("wux-identifier",this.identifier),this.elements.dockingWithCollapserContainer.setAttribute("wux-identifier",this.identifier)):(this.getContent().removeAttribute("wux-identifier"),this.elements.dockingWithCollapserContainer.removeAttribute("wux-identifier"))},_updateContainedWindows:function(){for(var e=this.getContainedVisibleWindows(),t=0;t<e.length;t++){e[t]._getTitleBarHeight();e[t]._updateContentHeight(),e[t]._setTitleBarCenteredFlag("center"===this.alignment),e[t].isAWindowGroup()&&(e[t]._updateMaxTabbarWidth(),e[t]._updateMinWidth())}},_updateFromContainedWindows:function(){this._updateFitToChildState();var e=this.side,t=24,i=this.getContainedVisibleWindows();if(i&&i.length>0)for(var n=i[0]._getTitleBarHeight(),o=0;o<i.length;o++){var s=i[o];s&&(e===WUXDockAreaEnum.LeftDockArea||e===WUXDockAreaEnum.RightDockArea?t=s.minWidth>t?s.minWidth:t:e!==WUXDockAreaEnum.TopDockArea&&e!==WUXDockAreaEnum.BottomDockArea||(t=s.minHeight+n>t?s.minHeight+n:t))}this.minSize=t,this._updateCollapserSize()},_updateFitToChildState:function(){var e=!1;if("center"===this.alignment){var t=this.getContainedVisibleWindows();if(1===t.length){e=!0;var i=t[0];(i&&i.horizontallyStretchableFlag&&(this.side==WUXDockAreaEnum.TopDockArea||this.side==WUXDockAreaEnum.BottomDockArea)||i.verticallyStretchableFlag&&(this.side==WUXDockAreaEnum.LeftDockArea||this.side==WUXDockAreaEnum.RightDockArea))&&(e=!1)}}e?this.elements.dockingZone.addClassName("wux-docking-element-fit-to-child"):this.elements.dockingZone.removeClassName("wux-docking-element-fit-to-child")},_getClassName:function(){var e="";switch(this.side){case WUXDockAreaEnum.LeftDockArea:e="wux-docking-element-left";break;case WUXDockAreaEnum.RightDockArea:e="wux-docking-element-right";break;case WUXDockAreaEnum.TopDockArea:e="wux-docking-element-top";break;case WUXDockAreaEnum.BottomDockArea:e="wux-docking-element-bottom"}return e},_saveDockingZoneSizeInPreferences:function(){if(""!==this.identifier)for(var e=this.getContainedVisibleWindows(),t=0;t<e.length;t++)e[t]._saveDockedDimensionsInPreferences()},_getDockingZoneSizeFromPreferences:function(){var e=void 0;if(""!==this.identifier)for(var t=this.getContainedVisibleWindows(),i=this.side===WUXDockAreaEnum.LeftDockArea||this.side===WUXDockAreaEnum.RightDockArea?"width":"height",n=0;n<t.length;n++){var o=t[n]._getDockedDimensionsFromPreferences();if(o&&o[i]){e=o[i];break}}return e},_saveCollapseDockingZoneFlagInPreferences:function(){if(""!==this.identifier){var e={collapseDockingZoneFlag:this.collapseDockingZoneFlag};n.saveDataInLocalPreferences(this,this._getClassName(),"collapseDockingZoneFlag",e)}},_getCollapseDockingZoneFlagFromPreferences:function(){var e=void 0;return""!==this.identifier&&(e=n.getDataFromLocalPreferences(this,this._getClassName(),"collapseDockingZoneFlag")),e},_updateDockingZoneSize:function(){var e=this.getContainedVisibleWindows(),t=!1,i=this.side;if(e.length>0&&(this._updateContainedWindows(),t=this._hasScrollbar()),t&&0===this._scrollBarSize?this._scrollBarSize=n.getScrollbarWidth():t||(this._scrollBarSize=0),i===WUXDockAreaEnum.TopDockArea||i===WUXDockAreaEnum.BottomDockArea){var o=this._getFixedAreaHeight();this.elements.dockingZone.setStyle("height","100%"===this.dockingZoneSize?"100%":this.dockingZoneSize+this._scrollBarSize-o+"px"),this.elements.dockingZone.setStyle("margin-top",o+"px"),this.collapseDockingZoneFlag?this.elements.dockingZoneMask.setStyle("height","0px"):this.elements.dockingZoneMask.setStyle("height","100%"===this.dockingZoneSize?"100%":this.dockingZoneSize+this._scrollBarSize+"px"),this.visibleDockingZoneFlag?this.collapseDockingZoneFlag?0!==this._collapserSize?this.elements.freeZone.setStyle("height","calc(100% - "+this._collapserSize+"px)"):this.elements.freeZone.setStyle("height","100%"):this.overlayDockingZoneFlag?this.elements.freeZone.setStyle("height","100%"):this.elements.freeZone.setStyle("height","calc(100% - "+(this.dockingZoneSize+this._collapserSize+this._scrollBarSize)+"px)"):this.elements.freeZone.setStyle("height","100%")}else i!==WUXDockAreaEnum.LeftDockArea&&i!==WUXDockAreaEnum.RightDockArea||(this.elements.dockingZone.setStyle("width","100%"===this.dockingZoneSize?"100%":this.dockingZoneSize+this._scrollBarSize+"px"),this.collapseDockingZoneFlag?(this.elements.dockingZoneMask.setStyle("width","0px"),this.elements.dockingWithCollapserContainer.setStyle("width",this._collapserSize+"px")):(this.elements.dockingZoneMask.setStyle("width","100%"===this.dockingZoneSize?"100%":this.dockingZoneSize+this._scrollBarSize+"px"),this.elements.dockingWithCollapserContainer.setStyle("width","100%"===this.dockingZoneSize?"100%":this.dockingZoneSize+this._collapserSize+this._scrollBarSize+"px")),this.visibleDockingZoneFlag?this.collapseDockingZoneFlag?0!==this._collapserSize?this.elements.freeZone.setStyle("width","calc(100% - "+this._collapserSize+"px)"):this.elements.freeZone.setStyle("width","100%"):this.overlayDockingZoneFlag?this.elements.freeZone.setStyle("width","100%"):this.elements.freeZone.setStyle("width","calc(100% - "+(this.dockingZoneSize+this._collapserSize+this._scrollBarSize)+"px)"):(this.elements.freeZone.setStyle("width","100%"),this.elements.dockingWithCollapserContainer.setStyle("width","0px")))},getContainedWindows:function(){for(var e=this.elements.dockingZone.getChildren(),t=[],i=0;i<e.length;i++)e[i].hasClassName("wux-windows-window")&&t.push(e[i].dsModel);return t},getContainedVisibleWindows:function(){for(var e=this.elements.dockingZone.getChildren(),t=[],i=0;i<e.length;i++)e[i].hasClassName("wux-windows-window")&&"none"!==e[i].getStyle("display")&&t.push(e[i].dsModel);return t},_applyInteractiveDockAreaVisibleFlag:function(){this._interactiveTimeout&&clearTimeout(this._interactiveTimeout),this.interactiveDockAreaVisibleFlag?this.elements.interactiveDockArea.addClassName("wux-windows-docking-element-active-interactive"):this.elements.interactiveDockArea.removeClassName("wux-windows-docking-element-active-interactive")},_preEditCollapsibleFlag:function(e,t){return t||(this.collapseDockingZoneFlag=!1),!0},_applyCollapsibleFlag:function(e){this._updateCollapserSize(),this._updateDockingZoneSize()},_updateCollapserSize:function(){this.collapsibleFlag&&this.visibleDockingZoneFlag&&this.visibleCollapserFlag?(this._collapserSize=20,this.elements.collapser.removeClassName(this._hideClassName)):(this._collapserSize=0,this.elements.collapser.addClassName(this._hideClassName))},_preEditCollapseDockingZoneFlag:function(){return this.collapsibleFlag},_applyOverlayDockingZoneFlag:function(){if(this.overlayDockingZoneFlag){switch(this.side){case WUXDockAreaEnum.TopDockArea:this.elements.dockingWithCollapserContainer.addClassName("wux-windows-docking-element-overlay-top");break;case WUXDockAreaEnum.BottomDockArea:this.elements.dockingWithCollapserContainer.addClassName("wux-windows-docking-element-overlay-bottom");break;case WUXDockAreaEnum.LeftDockArea:this.elements.dockingWithCollapserContainer.addClassName("wux-windows-docking-element-overlay-left");break;case WUXDockAreaEnum.RightDockArea:this.elements.dockingWithCollapserContainer.addClassName("wux-windows-docking-element-overlay-right")}this.elements.container.addClassName("wux-windows-docking-element-overlayed")}else this.elements.dockingWithCollapserContainer.removeClassName("wux-windows-docking-element-overlay-top"),this.elements.dockingWithCollapserContainer.removeClassName("wux-windows-docking-element-overlay-bottom"),this.elements.dockingWithCollapserContainer.removeClassName("wux-windows-docking-element-overlay-left"),this.elements.dockingWithCollapserContainer.removeClassName("wux-windows-docking-element-overlay-right"),this.elements.container.removeClassName("wux-windows-docking-element-overlayed");this._updateDockingZoneSize()},_applyVisibleCollapserFlag:function(){this._updateCollapserSize()},_applyCollapseDockingZoneFlag:function(e){var t=this;if(this.onTransitionEnd=function(){t.elements.dockingZone.removeClassName("wux-docking-anim-collapse"),t.elements.dockingZoneMask.removeClassName("wux-docking-anim-collapse"),t.elements.freeZone.removeClassName("wux-docking-anim-collapse"),t.elements.dockingWithCollapserContainer.removeClassName("wux-docking-anim-collapse"),o.removeEventOnElement(t,t.elements.freeZone,"transitionend",t.onTransitionEnd),t.fire("dimensionsChanged")},n.browserIsIE()||(this.elements.dockingZone.addClassName("wux-docking-anim-collapse"),this.elements.dockingZoneMask.addClassName("wux-docking-anim-collapse"),this.elements.freeZone.addClassName("wux-docking-anim-collapse"),this.elements.dockingWithCollapserContainer.addClassName("wux-docking-anim-collapse")),o.addEventOnElement(this,this.elements.freeZone,"transitionend",t.onTransitionEnd),this.collapseDockingZoneFlag){if(this.getContent().setAttributeNode(document.createAttribute("collapsed")),this.elements.dockingWithCollapserContainer.setAttributeNode(document.createAttribute("collapsed")),this.resizableFlag&&this.elements.resizeHandler.addClassName(this._hideClassName),this.collapsibleFlag)switch(this._updateDockingZoneSize(),this.side){case WUXDockAreaEnum.TopDockArea:this.elements.dockingZone.getStyle("top")===-this.dockingZoneSize+"px"&&"0px"===this.elements.dockingZoneMask.getStyle("height")?this.onTransitionEnd():this.elements.dockingZone.setStyle("top",-this.dockingZoneSize+"px");break;case WUXDockAreaEnum.BottomDockArea:"0px"===this.elements.dockingZoneMask.getStyle("height")&&this.onTransitionEnd();break;case WUXDockAreaEnum.LeftDockArea:this.elements.dockingZone.getStyle("left")===-this.dockingZoneSize+"px"&&"0px"===this.elements.dockingZoneMask.getStyle("width")?this.onTransitionEnd():this.elements.dockingZone.setStyle("left",-this.dockingZoneSize+"px");break;case WUXDockAreaEnum.RightDockArea:"0px"===this.elements.dockingZoneMask.getStyle("width")&&this.onTransitionEnd()}else this.collapseDockingZoneFlag=!1;this.fire("collapse")}else{switch(this._updateDockingZoneSize(),this.getContent().removeAttribute("collapsed"),this.elements.dockingWithCollapserContainer.removeAttribute("collapsed"),this.resizableFlag&&this.elements.resizeHandler.removeClassName(this._hideClassName),this.side){case WUXDockAreaEnum.TopDockArea:"0px"!==this.elements.dockingZone.getStyle("top")&&""!==this.elements.dockingZone.getStyle("top")||"0px"===this.elements.dockingZoneMask.getStyle("height")?this.elements.dockingZone.setStyle("top","0px"):this.onTransitionEnd();break;case WUXDockAreaEnum.BottomDockArea:this.elements.dockingZoneMask.getStyle("height")===this.dockingZoneSize+"px"&&this.onTransitionEnd();break;case WUXDockAreaEnum.LeftDockArea:"0px"!==this.elements.dockingZone.getStyle("left")&&""!==this.elements.dockingZone.getStyle("left")||"0px"===this.elements.dockingZoneMask.getStyle("width")?this.elements.dockingZone.setStyle("left","0px"):this.onTransitionEnd();break;case WUXDockAreaEnum.RightDockArea:this.elements.dockingZoneMask.getStyle("width")===this.dockingZoneSize+"px"&&this.onTransitionEnd()}this.fire("expand")}this._updateContentVisibleStateChange()},_updateContentVisibleStateChange:function(){for(var e=this.getContainedWindows(),t=0;t<e.length;t++)e[t]._updateContentVisibleStateChange()},_applyVisibleDockingZoneFlag:function(){this.visibleDockingZoneFlag?(!0===this.resizableFlag&&this.elements.resizeHandler.removeClassName(this._hideClassName),this.elements.dockingZone.removeClassName(this._hideClassName),this.elements.dockingZoneMask.removeClassName(this._hideClassName)):(this.elements.resizeHandler.addClassName(this._hideClassName),this.elements.dockingZone.addClassName(this._hideClassName),this.elements.dockingZoneMask.addClassName(this._hideClassName)),this._updateCollapserSize(),this._updateDockingZoneSize(),this._updateContentVisibleStateChange()},_applyResizableFlag:function(){!1===this.resizableFlag?this.elements.resizeHandler.addClassName(this._hideClassName):this.elements.resizeHandler.removeClassName(this._hideClassName)},_applyMinSize:function(){void 0!==this.minSize&&null!==this.minSize&&(this.minSize>this.dockingZoneSize&&(this.dockingZoneSize=this.minSize),void 0!==this.maxSize&&null!==this.maxSize&&this.minSize>this.maxSize&&(this.maxSize=this.minSize))},_applyMaxSize:function(){if(void 0!==this.maxSize&&null!==this.maxSize){if(void 0!==this.minSize&&null!==this.minSize&&this.minSize>this.maxSize)return void(this.maxSize=this.minSize);this.maxSize<this.dockingZoneSize&&(this.dockingZoneSize=this.maxSize)}},_applyDockingZoneContent:function(t){t&&t.remove(),this.dockingZoneContent&&(e.is(this.dockingZoneContent,"element")&&(this.dockingZoneContent=new e.extendElement(this.dockingZoneContent)),this.dockingZoneContent.inject(this.elements.dockingZone))},_applyFreeZoneContent:function(t){t&&t.remove(),this.freeZoneContent&&(e.is(this.freeZoneContent,"element")&&(this.freeZoneContent=new e.extendElement(this.freeZoneContent)),this.freeZoneContent.inject(this.elements.freeZone))},_applyUseBordersFlag:function(e){this.useBordersFlag?this.elements.dockingZone.addClassName("wux-docking-element-useBorders"):this.elements.dockingZone.removeClassName("wux-docking-element-useBorders")},_applyUseBackgroundFlag:function(e){this.useBackgroundFlag?this.elements.dockingZone.addClassName("wux-docking-element-use-background"):this.elements.dockingZone.removeClassName("wux-docking-element-use-background")},_applyAlignment:function(e){"center"===this.alignment?(this.elements.dockingZoneMask.removeClassName("wux-docking-element-align-near"),this.elements.dockingZoneMask.removeClassName("wux-docking-element-align-far"),this.elements.dockingZoneMask.addClassName("wux-docking-element-align-center")):"far"===this.alignment?(this.elements.dockingZoneMask.removeClassName("wux-docking-element-align-near"),this.elements.dockingZoneMask.removeClassName("wux-docking-element-align-center"),this.elements.dockingZoneMask.addClassName("wux-docking-element-align-far")):(this.elements.dockingZoneMask.removeClassName("wux-docking-element-align-center"),this.elements.dockingZoneMask.removeClassName("wux-docking-element-align-far"),this.elements.dockingZoneMask.addClassName("wux-docking-element-align-near")),this._updateContainedWindows(),this._updateFitToChildState(),this._updateDockingZoneSize()},_applyAutoExpandFlag:function(e){var t=this;this._collapserMouseEnterFun||(this._mouseMoveOnDocument=function(e){h(t.elements.dockingWithCollapserContainer,e.clientX,e.clientY)?!0===t._collapseHoverFlag&&(clearTimeout(t._expanderTimer),t._expanderTimer=null):t._expanderTimer||(t._expanderTimer=setTimeout(function(){o.pushUserInteractionContext(),t.setPropertyFromUIInteraction("collapseDockingZoneFlag",!0),t._collapseHoverFlag=!1,t.collapseMemory=!1,t.elements.dockingWithCollapserContainer.removeAttribute("expand-hover"),o.removeEventOnElement(t,document,i.POINTERMOVE,t._mouseMoveOnDocument),t._listenToMouseMove=null,o.popUserInteractionContext()},1e3))},this._collapserMouseEnterFun=function(e){!0!==t.collapseDockingZoneFlag||t._collapserTimer||(t._collapseHoverFlag=!0,t._collapserTimer=setTimeout(function(){o.pushUserInteractionContext(),t.setPropertyFromUIInteraction("collapseDockingZoneFlag",!1),t.elements.dockingWithCollapserContainer.setAttributeNode(document.createAttribute("expand-hover")),t._collapserTimer=null,o.popUserInteractionContext()},300),t._listenToMouseMove||(o.addEventOnElement(t,document,i.POINTERMOVE,t._mouseMoveOnDocument),t._listenToMouseMove=!0))}),this._collapserMouseLeaveFun||(this._collapserMouseLeaveFun=function(e){t._collapserTimer&&(clearTimeout(t._collapserTimer),t._collapserTimer=null)}),this._dockingMouseEnterFun||(this._dockingMouseEnterFun=function(){!0===t._collapseHoverFlag&&clearTimeout(t._expanderTimer)}),this.autoExpandFlag&&!e?(o.addEventOnElement(this,this.elements.collapser,"mouseenter",this._collapserMouseEnterFun),o.addEventOnElement(this,this.elements.collapser,"mouseleave",this._collapserMouseLeaveFun),o.addEventOnElement(this,this.elements.dockingWithCollapserContainer,"mouseenter",this._dockingMouseEnterFun)):(o.removeEventOnElement(this,this.elements.collapser,"mouseenter",this._collapserMouseEnterFun),o.removeEventOnElement(this,this.elements.collapser,"mouseleave",this._collapserMouseLeaveFun),o.removeEventOnElement(this,this.elements.dockingWithCollapserContainer,"mouseenter",this._dockingMouseEnterFun))},_applyProperties:function(e){this._parent(e),this._applyIdentifier(),this._applySide(),this._applyDockingZoneSize(),this._applyInteractiveDockAreaVisibleFlag(),this._applyResizableFlag(),this._applyDockingZoneContent(),this._applyFreeZoneContent(),this._applyCollapsibleFlag(),this._applyVisibleDockingZoneFlag(),this.isDirty("useBordersFlag")&&this._applyUseBordersFlag(e.useBordersFlag),this.isDirty("useBackgroundFlag")&&this._applyUseBackgroundFlag(e.useBackgroundFlag),this._applyCollapseDockingZoneFlag(),this.isDirty("overlayDockingZoneFlag")&&this._applyOverlayDockingZoneFlag(),this.isDirty("visibleCollapserFlag")&&this._applyVisibleCollapserFlag(),this.isDirty("alignment")&&this._applyAlignment(e.alignment),this.isDirty("autoExpandFlag")&&this._applyAutoExpandFlag(e.autoExpandFlag)},_getFixedArea:function(){return this.elements.fixedArea},_getFixedAreaHeight:function(){return this.elements.fixedArea?this.elements.fixedArea.offsetHeight:0},_getFixedAreaWidth:function(){return this.elements.fixedArea?this.elements.fixedArea.offsetWidth:0},handleEvents:function(){var e=this,t=0,n=0,s=0,a=0,r=0,l=0;function d(t){t.preventDefault(),a=t.pageY-n;var i=s;i=s+a>e.minSize?s+a<m.call(e,e.maxSize,l)?s+a:m.call(e,e.maxSize,l):e.minSize,e.setPropertyFromUIInteraction("dockingZoneSize",i),e.immersiveFrame&&e.immersiveFrame._updateAllDockingZoneSize(),e.fire("dockIsResizing")}function h(t){t.preventDefault(),a=t.pageY-n;var i=s;i=s-a>e.minSize?s-a<m.call(e,e.maxSize,l)?s-a:m.call(e,e.maxSize,l):e.minSize,e.setPropertyFromUIInteraction("dockingZoneSize",i),e.immersiveFrame&&e.immersiveFrame._updateAllDockingZoneSize(),e.fire("dockIsResizing")}function u(i){i.preventDefault(),a=i.pageX-t;var n=s;n=s+a>e.minSize?s+a<m.call(e,e.maxSize,r)?s+a:m.call(e,e.maxSize,r):e.minSize,e.setPropertyFromUIInteraction("dockingZoneSize",n),e.immersiveFrame&&e.immersiveFrame._updateAllDockingZoneSize(),e.fire("dockIsResizing")}function g(i){i.preventDefault(),a=i.pageX-t;var n=s;n=s-a>e.minSize?s-a<m.call(e,e.maxSize,r)?s-a:m.call(e,e.maxSize,r):e.minSize,e.setPropertyFromUIInteraction("dockingZoneSize",n),e.immersiveFrame&&e.immersiveFrame._updateAllDockingZoneSize(),e.fire("dockIsResizing")}function p(t){document.body.removeAttribute("resizing"),o.removeEventOnElement(e,document,i.POINTERMOVE,u),o.removeEventOnElement(e,document,i.POINTERMOVE,g),o.removeEventOnElement(e,document,i.POINTERMOVE,d),o.removeEventOnElement(e,document,i.POINTERMOVE,h),o.removeEventOnElement(e,document,i.POINTERUP,p),e.elements.hackResize.addClassName(e._hideClassName),e.elements.hackResize.setStyle("cursor","default"),e.fire("dockResize");for(var n=e.getContainedWindows(),s=0;s<n.length;s++)n[s]._fireAndBroadcast("stopResize");e._saveDockingZoneSizeInPreferences()}o.addEventOnElement(this,this.elements.resizeHandler,i.POINTERDOWN,function(a){if(!1===e.collapseDockingZoneFlag&&!0===e.resizableFlag){document.body.setAttributeNode(document.createAttribute("resizing")),t=a.pageX,n=a.pageY;var m="e-resize";switch(s=e.dockingZoneSize,e.side){case WUXDockAreaEnum.TopDockArea:case WUXDockAreaEnum.BottomDockArea:l=c.call(e).offsetHeight+s-50,m="s-resize";break;case WUXDockAreaEnum.LeftDockArea:case WUXDockAreaEnum.RightDockArea:r=c.call(e).offsetWidth+s-50,m="e-resize"}e.elements.hackResize.setStyle("cursor",m),e.elements.hackResize.removeClassName(this._hideClassName),o.addEventOnElement(e,document,i.POINTERUP,p);var f="left";switch(e.side){case WUXDockAreaEnum.TopDockArea:o.addEventOnElement(e,document,i.POINTERMOVE,d),f="bottom";break;case WUXDockAreaEnum.BottomDockArea:o.addEventOnElement(e,document,i.POINTERMOVE,h),f="top";break;case WUXDockAreaEnum.LeftDockArea:o.addEventOnElement(e,document,i.POINTERMOVE,u),f="right";break;case WUXDockAreaEnum.RightDockArea:o.addEventOnElement(e,document,i.POINTERMOVE,g),f="left"}for(var w=e.getContainedWindows(),v=0;v<w.length;v++)w[v]._fireAndBroadcast("startResize",{side:f,cursor:m}),e.immersiveFrame||(e.immersiveFrame=w[v].immersiveFrame)}}),this._manageAutoCollapse=function(){o.removeEventOnElement(e,document,i.POINTERMOVE,e._mouseMoveOnDocument),e._listenToMouseMove=null,!1===e._collapseHoverFlag&&e.setPropertyFromUIInteraction("collapseDockingZoneFlag",!e.collapseDockingZoneFlag),e._saveCollapseDockingZoneFlagInPreferences(),clearTimeout(e._collapserTimer),e._collapseHoverFlag=!1,e.elements.dockingWithCollapserContainer.removeAttribute("expand-hover")},o.addEventOnElement(this,this.elements.collapser,"click",function(t){e._manageAutoCollapse()}),o.addEventOnElement(this,this.elements.dockingZone,"scroll",function(){e._resetInteractiveDockArea()}),o.addEventOnElement(this,this.elements.dockingZone,"DOMNodeRemoved",function(t){if(t.target&&t.target.hasOwnProperty("hasClassName")&&t.target.hasClassName("wux-windows-window")){var i=e.elements.dockingZone.getChildren(),n=t.target.dsModel,o=0;let a=!1;for(var s=0;s<i.length;s++){if(!i[s].hasClassName("wux-windows-window")){a=!0;break}i[s].dsModel.getContent()!==n.getContent()&&i[s].dsModel.visibleFlag&&o++}0!==o||a||(e.visibleDockingZoneFlag=!1)}}),o.addEventOnElement(this,this.elements.dockingZone,"DOMNodeInserted",function(t){if(t.target&&t.target.hasOwnProperty("hasClassName")&&t.target.hasClassName("wux-windows-window")){var i=t.target.dsModel;i&&i.visibleFlag&&(e.visibleDockingZoneFlag=!0)}})},getSensibilityDockArea:function(){var e=this.getContent().getBoundingClientRect();switch(this.side){case WUXDockAreaEnum.TopDockArea:return{x:e.left,y:e.top-this._dockingSensibilityZoneSize,width:e.width,height:2*this._dockingSensibilityZoneSize};case WUXDockAreaEnum.BottomDockArea:return{x:e.left,y:e.bottom-this._dockingSensibilityZoneSize,width:e.width,height:2*this._dockingSensibilityZoneSize};case WUXDockAreaEnum.LeftDockArea:return{x:e.left-this._dockingSensibilityZoneSize,y:e.top,width:2*this._dockingSensibilityZoneSize,height:e.height};case WUXDockAreaEnum.RightDockArea:return{x:e.right-this._dockingSensibilityZoneSize,y:e.top,width:2*this._dockingSensibilityZoneSize,height:e.height}}},_getStretchSize:function(){return this.side===WUXDockAreaEnum.TopDockArea||this.side==WUXDockAreaEnum.BottomDockArea?parseInt(window.getComputedStyle(this.elements.dockingZoneMask).width):parseInt(window.getComputedStyle(this.elements.dockingZoneMask).height)},_resetInteractiveDockArea:function(){if(this.side==WUXDockAreaEnum.LeftDockArea||this.side==WUXDockAreaEnum.RightDockArea){this.elements.interactiveDockArea.setStyle("top",0);var e=this.elements.dockingZone.scrollTop;this.elements.interactiveDockArea.setStyle("top",e)}else if(this.side==WUXDockAreaEnum.TopDockArea||this.side==WUXDockAreaEnum.BottomDockArea){this.elements.interactiveDockArea.setStyle("left",0);var t=this.elements.dockingZone.scrollLeft;this.elements.interactiveDockArea.setStyle("left",t)}},_scrollToBottom:function(){if(this.side&WUXDockAreaEnum.LeftDockArea||this.side&WUXDockAreaEnum.RightDockArea){for(var e=this.elements.dockingZone.scrollTop,t=0,i=this.getContainedVisibleWindows(),n=0;n<i.length;n++)t+=i[n].getContent().offsetHeight;if(this.elements.dockingZone.offsetHeight>0&&e+this.elements.dockingZone.offsetHeight>=t){i[i.length-1];this.elements.dockingZone.scrollTop=t-this.elements.dockingZone.offsetHeight}}else{var o=this.elements.dockingZone.scrollLeft,s=0;for(i=this.getContainedVisibleWindows(),n=0;n<i.length;n++)s+=i[n].getContent().offsetWidth;if(this.elements.dockingZone.offsetWidth>0&&o+this.elements.dockingZone.offsetWidth>=s){i[i.length-1];this.elements.dockingZone.scrollLeft=s-this.elements.dockingZone.offsetWidth}}},_pointerEventsAllIfOveflowY:function(){this._pointerEventsAllIfOverflow()},_pointerEventsAllIfOverflow:function(){this.getContent().getComputedSize(),this.elements&&this.elements.dockingZone&&(this._hasScrollbar()?this.elements.dockingZone.setStyle("pointer-events","all"):this.elements.dockingZone.setStyle("pointer-events",""),this._resetInteractiveDockArea())},pointerEventsAllIfOverflow:function(){this._pointerEventsAllIfOverflow()},_hasScrollbar:function(){var e=this.side==WUXDockAreaEnum.RightDockArea||this.side==WUXDockAreaEnum.LeftDockArea;if(!e&&"number"==typeof this.elements.dockingZone.scrollWidth)return this.elements.dockingZone.scrollWidth>this.elements.dockingZone.offsetWidth;if(e){var t,i,n=this.elements.dockingZone;void 0!==n.currentStyle&&(t=n.currentStyle.overflow),t=t||(window.getComputedStyle(n,"")?window.getComputedStyle(n,"").overflow:""),void 0!==n.currentStyle&&(i=n.currentStyle.overflowY),i=i||(window.getComputedStyle(n,"")?window.getComputedStyle(n,"").overflowY:"");for(var o=0,s=this.getContainedVisibleWindows(),a=0;a<s.length;a++)o+=s[a].getContent().offsetHeight;var r=o>n.clientHeight&&0!==n.clientHeight,l=/^(visible|auto)$/.test(t)||/^(visible|auto)$/.test(i);return r&&l||("scroll"===t||"scroll"===i)}return!1}}),h=function(e,t,i){var n=e.getBoundingClientRect();return t>=n.left&&t<=n.left+n.width&&i>=n.top&&i<=n.top+n.height},c=function(){for(var e=this.elements.freeZone,t=!1;!t;){var i=e.getChildren();t=!0;for(var n=0;n<i.length;n++)if(i[n].hasClassName("wux-windows-docking-element")){var o=i[n].dsModel;o&&(e=o.elements.freeZone,t=!1)}}return e},m=function(e,t){return e<t?e:t};return a.register(d,"DS/ControlsRec/AbstractRec"),d}),define("DS/Windows/WindowActivator",["UWA/Core","UWA/Class","DS/Core/BaseComponent","DS/Utilities/Utils"],function(e,t,i,n){"use strict";return t.singleton({defaultOptions:{},FindFocusableInChildren:function(e,t){var i=null;if(null==e)return null;if(0==t&&(e.getAttribute("tabindex")||e.tabIndex>=0))return e;for(var n=e.childNodes,o=0;o<n.length;o++){var s=n[o];if(1==s.nodeType){if(s.getAttribute("tabindex")||s.tabIndex>=0){i=s;break}if(i=this.FindFocusableInChildren(s,!1))break}}return i},getFocusedWidget:function(e){var t=null;if(null==e||null==e)return null;var i=document.activeElement;if(e==i)return e;if(e)for(var n=e.childNodes,o=0;o<n.length;o++){var s=n[o];if(1==s.nodeType){if(s==i){t=s;break}if(t=this.getFocusedWidget(s))break}}return t}})}),define("DS/Windows/WindowManager",["UWA/Core","UWA/Class","DS/Core/BaseComponent","DS/Utilities/Utils"],function(e,t,i,n){"use strict";return t.singleton({defaultOptions:{},init:function(e){this._parent(e)},setActiveWindow:function(e){if(this._activeWindow!==e){var t=this._activeWindow;this._activeWindow=e,this._activeWindow&&(this._activeWindow.activeFlag=!0),t&&!t._isBeingClosed&&(t.activeFlag=!1)}},getActiveWindow:function(){return this._activeWindow},bringToFront:function(e){if(e&&!e.getDockedFlag()&&!e.maximizedFlag){var t=e.getZIndex();let l=e._floatLayer?e._floatLayer:"middle";var i=-1,n=e.immersiveFrame;if(n){let t=[n];n._linkedImmersiveFrames&&t.push(...n._linkedImmersiveFrames);for(let n=0;n<t.length;n++){let r=t[n];for(var o in r.windows){let t=(a=r.windows[o])._floatLayer?a._floatLayer:"middle";if(a&&!a.getDockedFlag()&&a!==e&&t===l){var s=a.getZIndex();i<s&&(i=s)}}}if("bottom"===l&&i>=100){let t=[];for(var o in n.windows){var a;let i=(a=n.windows[o])._floatLayer?a._floatLayer:"middle";a&&a!==e&&i===l&&t.push(a)}t.sort(function(e,t){return e.getZIndex()>t.getZIndex()});for(let e=0;e<t.length;e++)i=e+1,t[e].setStyle("z-index",i)}}if(-1!==i&&i>=t){var r=i+1;e.getContent().setStyle("z-index",r)}}}})});var WUXSnapAreaEnum={NoneArea:0,OutsideArea:1,TopArea:2,BottomArea:3,LeftArea:4,RightArea:5,InsideArea:6};Object.freeze(WUXSnapAreaEnum);var WUXWindowGroupTypeEnum={GroupAsGrid:0,GroupAsTab:1};Object.freeze(WUXWindowGroupTypeEnum);var WUXStandardButtonRoleEnum={InvalidRole:0,AcceptRole:1,RejectRole:2,DestructiveRole:3,HelpRole:4,YesRole:5,NoRole:6,ApplyRole:7,ResetRole:8};Object.freeze(WUXStandardButtonRoleEnum);var WUXStandardButtonEnum={Ok:{name:"Ok",value:1,role:WUXStandardButtonRoleEnum.AcceptRole},Open:{name:"Open",value:2,role:WUXStandardButtonRoleEnum.AcceptRole},Save:{name:"Save",value:4,role:WUXStandardButtonRoleEnum.AcceptRole},Apply:{name:"Apply",value:8,role:WUXStandardButtonRoleEnum.ApplyRole},Reset:{name:"Reset",value:16,role:WUXStandardButtonRoleEnum.ResetRole},RestoreDefaults:{name:"RestoreDefaults",value:32,role:WUXStandardButtonRoleEnum.ResetRole},Help:{name:"Help",value:64,role:WUXStandardButtonRoleEnum.HelpRole},SaveAll:{name:"SaveAll",value:128,role:WUXStandardButtonRoleEnum.AcceptRole},Yes:{name:"Yes",value:256,role:WUXStandardButtonRoleEnum.YesRole},YesToAll:{name:"YesToAll",value:512,role:WUXStandardButtonRoleEnum.YesRole},No:{name:"No",value:1024,role:WUXStandardButtonRoleEnum.NoRole},NoToAll:{name:"NoToAll",value:2048,role:WUXStandardButtonRoleEnum.NoRole},Abort:{name:"Abort",value:4096,role:WUXStandardButtonRoleEnum.RejectRole},Retry:{name:"Retry",value:8192,role:WUXStandardButtonRoleEnum.AcceptRole},Ignore:{name:"Ignore",value:16384,role:WUXStandardButtonRoleEnum.AcceptRole},Discard:{name:"Discard",value:32768,role:WUXStandardButtonRoleEnum.DestructiveRole},Cancel:{name:"Cancel",value:65536,role:WUXStandardButtonRoleEnum.RejectRole},Close:{name:"Close",value:1<<17,role:WUXStandardButtonRoleEnum.RejectRole}};Object.freeze(WUXStandardButtonEnum);var windowPrefKey="wux-windows-window";define("DS/Windows/Window",["UWA/Core","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Utils","DS/Windows/WindowManager","DS/Utilities/Dom","DS/Windows/WindowActivator","DS/Controls/Button","i18n!DS/Windows/assets/nls/translation","DS/Utilities/KeyboardUtils","DS/WebRecordEnabler/Adapter","DS/WebRecordBase/Constants","DS/Controls/TooltipModel","DS/Menu/ContextualMenu","DS/Core/TooltipManager","DS/Utilities/DeviceUtils","DS/Utilities/TouchUtils"],function(e,t,i,n,o,s,a,r,l,d,h,c,m,u,g,p,f){"use strict";var w=t.inherit({name:"window",markForRecordFlag:!0,contentVisibleState:!1,publishedProperties:{identifier:{defaultValue:void 0,type:"string",readOnly:!0,category:"Behavior"},title:{defaultValue:"",type:"string",category:"Appearance"},icon:{defaultValue:"",type:"object",category:"Appearance"},header:{defaultValue:null,type:"object",category:"Appearance"},content:{defaultValue:null,type:"object",category:"Behavior"},immersiveFrame:{defaultValue:null,type:"object",category:"Behavior"},position:{type:"object",category:"Appearance",recordFlag:["my","at"]},activeFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},movableFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},closeButtonFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},expandedFlag:{defaultValue:!0,type:"boolean",category:"Behavior",recordFlag:!0},allowedDockAreas:{defaultValue:WUXDockAreaEnum.NoneDockArea,type:"integer",category:"Behavior"},currentDockArea:{defaultValue:WUXDockAreaEnum.NoneDockArea,type:"integer",category:"Behavior",advancedSetter:!0,recordFlag:!0},windowGroup:{defaultValue:null,type:"object",category:"Behavior",recordFlag:["_computedIdentifier"]},activeSnapArea:{defaultValue:WUXSnapAreaEnum.NoneArea,type:"integer",category:"Behavior"},resizableFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},width:{defaultValue:-1,type:"integer",category:"Appearance",advancedSetter:!0,recordFlag:!0},height:{defaultValue:-1,type:"integer",category:"Appearance",advancedSetter:!0,recordFlag:!0},minWidth:{defaultValue:150,defaultTouchValue:200,advancedSetter:!0,type:"integer",category:"Appearance"},minHeight:{defaultValue:0,type:"integer",category:"Appearance"},maximizedFlag:{defaultValue:!1,type:"boolean",category:"Behavior",recordFlag:!0},allowMaximizeFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},maximizeButtonFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},horizontallyStretchableFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},verticallyStretchableFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},autoCloseFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},titleBarVisibleFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},usePaddingFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},ensureHeightDefinitionOnHierarchy:{defaultValue:!1,type:"boolean",category:"Behavior"},activateButtonsIfActionPerformed:{defaultValue:!0,type:"boolean",category:"Behavior"},buttons:{defaultValue:{},type:"object",category:"Behavior"},touchMode:{defaultValue:void 0,type:"boolean",category:"Accessibility",advancedSetter:!0},onContextualEvent:{defaultValue:function(e){return this._buildOrDelagateContextualMenu(e)},type:"function"},getDefaultFocusableWidget:{defaultValue:void 0,type:"function",category:"Behavior"}},_privateProperties:{_floatLayer:{defaultValue:void 0,type:"string",category:"Behavior"}},_titleBarCenteredFlag:!1,_buttonsVisibleFlag:!0,_savedPreferencesKeys:[],buildView:function(){h.setElementRecordMode(this.elements.container,c.RecordModes.DEFAULT_AND_CHILD),this.defaultButton=null,this.escapeButton=null,this._prefRestorationState=WUXPreferenceRestorationStateEnum.NotRestored,this.elements.container.addClassName("wux-windows-window wux-element-contentbox"),this.elements.container.id=e.Utils.getUUID(),this.elements._titleBarDiv=new e.Element("div",{class:"wux-windows-window-titlebar wux-element-contentbox"}),this.elements._titleBarDiv.inject(this.elements.container),this.elements._titleDiv=new e.Element("div",{class:"wux-windows-window-header-title"}).inject(this.elements._titleBarDiv),this.elements.iconPlaceholder=new e.Element("div",{class:"wux-window-icon-placeholder"}).inject(this.elements._titleDiv),this.elements._titleP=new e.Element("p",{text:this.title}),this.elements._titleP.inject(this.elements._titleDiv),this.elements._titlebarButtonsDiv=new e.Element("div",{class:"wux-windows-window-header-buttons-div"}),this.elements._titlebarButtonsDiv.inject(this.elements._titleBarDiv),this.elements._mainCollapsibleContainer=new e.Element("div",{class:"wux-windows-window-mask-content"}),this.elements._mainCollapsibleContainer.inject(this.elements.container),this.elements._mainContentDiv=new e.Element("div",{class:"wux-windows-window-maincontent wux-element-contentbox"}),this.elements._mainContentDiv.inject(this.elements._mainCollapsibleContainer),this.elements._headerDiv=new e.Element("div",{class:"wux-windows-window-header wux-element-contentbox"}),this.elements._headerDiv.inject(this.elements._mainContentDiv),this.elements._contentDiv=new e.Element("div",{class:"wux-windows-window-content wux-element-contentbox"}),this.elements._contentDiv.inject(this.elements._mainContentDiv),this.elements._ghostFloatableElement=new e.Element("div",{class:"wux-windows-window-ghost-floatable-element"}),this.elements._topResizeHandler=new e.Element("div",{class:"wux-windows-window-resize-handler wux-windows-window-resize-handler-top wux-windows-window-resize-handler-side"}),this.elements._topResizeHandler.inject(this.elements.container),this.elements._topRightResizeHandler=new e.Element("div",{class:"wux-windows-window-resize-handler wux-windows-window-resize-handler-top-right wux-windows-window-resize-handler-corner"}),this.elements._topRightResizeHandler.inject(this.elements.container),this.elements._rightResizeHandler=new e.Element("div",{class:"wux-windows-window-resize-handler wux-windows-window-resize-handler-right wux-windows-window-resize-handler-side"}),this.elements._rightResizeHandler.inject(this.elements.container),this.elements._bottomRightResizeHandler=new e.Element("div",{class:"wux-windows-window-resize-handler wux-windows-window-resize-handler-bottom-right wux-windows-window-resize-handler-corner"}),this.elements._bottomRightResizeHandler.inject(this.elements.container),this.elements._bottomResizeHandler=new e.Element("div",{class:"wux-windows-window-resize-handler wux-windows-window-resize-handler-bottom wux-windows-window-resize-handler-side"}),this.elements._bottomResizeHandler.inject(this.elements.container),this.elements._bottomLeftResizeHandler=new e.Element("div",{class:"wux-windows-window-resize-handler wux-windows-window-resize-handler-bottom-left wux-windows-window-resize-handler-corner"}),this.elements._bottomLeftResizeHandler.inject(this.elements.container),this.elements._leftResizeHandler=new e.Element("div",{class:"wux-windows-window-resize-handler wux-windows-window-resize-handler-left wux-windows-window-resize-handler-side"}),this.elements._leftResizeHandler.inject(this.elements.container),this.elements._topLeftResizeHandler=new e.Element("div",{class:"wux-windows-window-resize-handler wux-windows-window-resize-handler-top-left wux-windows-window-resize-handler-corner"}),this.elements._topLeftResizeHandler.inject(this.elements.container),this.elements._topSnapAreaDiv=new e.Element("div",{class:"wux-windows-window-snap-area wux-windows-window-snap-area-top"}),this.elements._topSnapAreaDiv.inject(this.elements.container),this.elements._bottomSnapAreaDiv=new e.Element("div",{class:"wux-windows-window-snap-area wux-windows-window-snap-area-bottom"}),this.elements._bottomSnapAreaDiv.inject(this.elements.container),this.elements._leftSnapAreaDiv=new e.Element("div",{class:"wux-windows-window-snap-area wux-windows-window-snap-area-left"}),this.elements._leftSnapAreaDiv.inject(this.elements.container),this.elements._rightSnapAreaDiv=new e.Element("div",{class:"wux-windows-window-snap-area wux-windows-window-snap-area-right"}),this.elements._rightSnapAreaDiv.inject(this.elements.container),this.elements._insideSnapAreaDiv=new e.Element("div",{class:"wux-windows-window-snap-area wux-windows-window-snap-area-inside"}),this.elements._insideSnapAreaDiv.inject(this.elements._titleBarDiv)},_postBuildView:function(){this._parent(),this._updateContentVisibleStateChange();var e=this;s.onNodeRendered(this.getContent(),function(){e._isRendered=!0,e&&e.elements&&e.elements.container&&(e._applyHeight(),e._updateTitleMaxWidth(),e._applyPosition(),!0===e.activeFlag&&e._setFocus())}),this._manageContextualMenu()},_manageContextualMenu:function(){if(void 0===this._ctxMenuToken){var e=this;this._launchWebUXContextMenu=!1,this._ctxMenuToken=u.addEventListener(this.elements._titleBarDiv,{callback:function(t){var i=[];return e._launchWebUXContextMenu?i=e.onContextualEvent.call(e,{context:t.context,window:e,infos:t.info,data:t.data}):i}});var t=function(){if(!e._launchWebUXContextMenu){var t=event.offsetX,i=event.offsetY;e._activateWindowForContextMenu(event.target),e._launchWebUXContextMenu=!0;var n=document.createEvent("HTMLEvents");n.initEvent("contextmenu",!0,!1),n.pageX=event.target.getOffsets().x+t,n.pageY=event.target.getOffsets().y+i,event.target.dispatchEvent(n),e._launchWebUXContextMenu=!1}};if(p.isMobileiOS()){var n,o=function(){window.getSelection?(window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges(),window.getSelection().empty&&window.getSelection().empty()):document.selection&&document.selection.empty&&document.selection.empty()};s.addEventOnElement(this,this.elements._titleBarDiv,"DSlonghold",function(i){g.hide(),t(),n=setInterval(o,e,500)}),s.addEventOnElement(this,this.elements._titleBarDiv,i.POINTERUP,function(e){setTimeout(function(){clearInterval(n)},1e3)})}this._rightClickToken=s.addEventOnElement(this,this.elements._titleBarDiv,"contextmenu",function(e){t()})}},_activateWindowForContextMenu:function(e){this.activeFlag=!0},_buildOrDelagateContextualMenu:function(e){var t=[],i=e.window;return e&&i&&(t=i.buildDefaultContextualMenu(e)),t},buildDefaultContextualMenu:function(t,i){this._supportedMenus=["close","maximize"];i=e.extend({close:!0,maximize:!0},i);var n=this,o=[];return this._supportedMenus.forEach(function(e){if(!0===i[e]){var s=e.substring(0,1).toUpperCase()+e.substring(1,e.length),a=n["_create"+s+"ContextualMenu"](t);o=o.concat(a)}}),o},_createCloseContextualMenu:function(e){var t=this,i=[],n=t._getMenuToAddData("close",e);return n.canbeAdded&&i.push({type:"PushItem",title:n.closeAll?l.get("closeAllContextualMenu"):l.get("close"),icon:{iconName:"close",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{callback:function(e){t._onCloseContextMenuAction(e.context)},context:n.menuTarget}}),i},_createMaximizeContextualMenu:function(e){var t=this,i=[],n=this._getMenuToAddData("maximize",e),o=!!this.maximizedFlag;return n.canbeAdded&&i.push({type:"PushItem",title:o?l.get("restore"):l.get("maximize"),icon:{iconName:o?"resize-small":"resize-full",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{callback:function(e){t.maximizedFlag=!o}}}),i},_getMenuToAddData:function(e,t){var i=!1;return"close"===e?i=this.closeButtonFlag:"maximize"===e&&(i=this.maximizeButtonFlag),{canbeAdded:i}},_onCloseContextMenuAction:function(e){this.close()},_applyTitle:function(e){this.elements._titleP.setText(this.title),this.title?this.elements._titleP.setStyle("padding-left",""):this.elements._titleP.setStyle("padding-left","0"),this.windowGroup&&this.windowGroup._updateTitle()},_applyIdentifier:function(e){this.identifier?this.getContent().setAttribute("wux-identifier",this.identifier):this.getContent().removeAttribute("wux-identifier")},_applyTouchMode:function(){this._parent(),!0===this._getCurrentTouchMode()?this.elements._titleBarDiv.setAttributeNode(document.createAttribute("touch-mode")):this.elements._titleBarDiv.removeAttribute("touch-mode"),this._postEditTouchMode()},_applyDisabled:function(){this._parent(),this.disabled?(this.elements.contentDisabler||(this.elements.contentDisabler=n.createContentDisablerDiv()),this.elements._mainCollapsibleContainer.appendChild(this.elements.contentDisabler)):this.elements.contentDisabler&&this.elements._mainCollapsibleContainer.removeChild(this.elements.contentDisabler)},_postEditTouchMode:function(){this._parent();var e=this._getCurrentTouchMode();this.windowGroup&&(this.windowGroup.touchMode=e),!0===e?this.minWidth===this.publishedProperties.minWidth.defaultValue&&(this.minWidth=this.publishedProperties.minWidth.defaultTouchValue):this.minWidth===this.publishedProperties.minWidth.defaultTouchValue&&(this.minWidth=this.publishedProperties.minWidth.defaultValue),this._applyWidth(),this._applyHeight(),this._applyPosition(),this._updateTitleMaxWidth()},getDefaultButtonLabel:function(e){var t;switch(e){case WUXStandardButtonEnum.Ok.name:t=l.get("ok");break;case WUXStandardButtonEnum.Open.name:t=l.get("open");break;case WUXStandardButtonEnum.Save.name:t=l.get("save");break;case WUXStandardButtonEnum.SaveAll.name:t=l.get("saveAll");break;case WUXStandardButtonEnum.Yes.name:t=l.get("yes");break;case WUXStandardButtonEnum.YesToAll.name:t=l.get("yesToAll");break;case WUXStandardButtonEnum.Retry.name:t=l.get("retry");break;case WUXStandardButtonEnum.Ignore.name:t=l.get("ignore");break;case WUXStandardButtonEnum.Cancel.name:t=l.get("cancel");break;case WUXStandardButtonEnum.Apply.name:t=l.get("apply");break;case WUXStandardButtonEnum.Reset.name:t=l.get("reset");break;case WUXStandardButtonEnum.RestoreDefaults.name:t=l.get("restoreDefaults");break;case WUXStandardButtonEnum.Help.name:t=l.get("help");break;case WUXStandardButtonEnum.No.name:t=l.get("no");break;case WUXStandardButtonEnum.NoToAll.name:t=l.get("noToAll");break;case WUXStandardButtonEnum.Abort.name:t=l.get("abort");break;case WUXStandardButtonEnum.Discard.name:t=l.get("discard");break;case WUXStandardButtonEnum.Close.name:t=l.get("close")}return t},_applyIcon:function(e){if("object"==typeof this.icon)this.icon.iconClasses||(this.icon.iconClasses=""),this.icon.iconName||(this.icon.iconName=""),void 0===this.icon.fontIconFamily&&(this.icon.fontIconFamily=WUXManagedFontIcons.Font3DS),this.icon.fontIconSize||(this.icon.fontIconSize="1x");else if("string"==typeof this.icon&&""!==this.icon&&!s.isAPath(this.icon)){var t={iconName:this.icon};this.icon=t}(function(){this.elements.icon&&(this.elements.icon.remove(this.elements.iconPlaceholder),delete this.elements.icon);var e=s.generateIcon(this.icon);e?(this.elements.icon=e,this.elements.iconPlaceholder.show(),this.elements.icon.style.margin="0px",this.elements.icon.inject(this.elements.iconPlaceholder)):this.elements.iconPlaceholder.hide()}).call(this),this.icon?(this.elements.iconPlaceholder.setStyle("padding-left",""),this.elements.iconPlaceholder.setStyle("padding-right","")):(this.elements.iconPlaceholder.setStyle("padding-left","0"),this.elements.iconPlaceholder.setStyle("padding-right","0")),this.windowGroup&&this.windowGroup._updateTitle()},_applyHeader:function(e){this.elements._headerDiv.setContent(this.header),this.header?this.elements._headerDiv.show():this.elements._headerDiv.hide(),this._applyPosition()},_applyContent:function(e){this.elements._contentDiv.setContent(this.content),this._applyPosition()},_applyPosition:function(e){if(this.position){var t=!1;if(!(this.getEmbeddedState()||this.maximizedFlag&&this.allowMaximizeFlag)){var i=this._getCompletePosition();i&&(t=n.setPosition(this,i))}this._isRendered?this._visibility||(this.fire("_preVisibilityChange"),this._visibility=!0,this.getContent().setStyle("visibility","visible"),this.fire("visibilityChange")):(this._visibility=!1,this.getContent().setStyle("visibility","hidden")),t&&this.fire("move")}else this.position={}},_getCompletePosition:function(){var e=this._getDefaultPosition();return{my:this.position&&this.position.my?this.position.my:e.my,at:this.position&&this.position.at?this.position.at:e.at,of:this.position&&this.position.of?this.position.of:e.of,constraint:this.position&&this.position.constraint?this.position.constraint:e.constraint,offsetX:this.position&&void 0!==this.position.offsetX?this.position.offsetX:e.offsetX,offsetY:this.position&&void 0!==this.position.offsetY?this.position.offsetY:e.offsetY,collision:this.position&&this.position.collision?this.position.collision:e.collision}},_applyActiveFlag:function(){this.windowGroup?this.activeFlag&&(this.windowGroup.activeFlag=this.activeFlag):this.activeFlag?o.getActiveWindow()!=this&&(o.setActiveWindow(this),this.bringToFront()):o.getActiveWindow()===this&&o.setActiveWindow(null),this.activeFlag?(this.fire("activate"),this._setFocus(this.lastFocusedWidget)):(this.fire("deactivate"),this._unsetFocus())},_setFocus:function(e){var t=null;null!=e&&s.isElementInside(e,this.getContent())&&(t=e);var i=this.elements._contentDiv;if(this.visibleFlag){if(null==t&&null!=(t=a.getFocusedWidget(i)))return;if(null==t&&null==(t=this.getDefaultFocusableWidget?this.getDefaultFocusableWidget():a.FindFocusableInChildren(i,!0))&&(this.defaultButton&&(t=this.defaultButton.getContent()),null==t&&this.escapeButton&&(t=this.escapeButton.getContent())),t){if(f.getTouchMode()&&t instanceof HTMLInputElement)return;t.focus({preventScroll:!0})}this.lastFocusedWidget=t}},_unsetFocus:function(){var e=this.lastFocusedWidget;e&&(e.blur(),null!=e.dsModel&&null!=e.dsModel&&e.dsModel._resetFocus())},_applyCloseButtonFlag:function(){if(this.closeButtonFlag){var t=this;this.elements._closeButton||(this.elements._closeButton=new e.Element("button",{type:"button",class:"wux-windows-window-header-button wux-windows-window-header-close wux-ui-3ds wux-ui-3ds-wrong"}),this.elements._closeButton.tooltipInfos=new m({owner:this.elements._closeButton,shortHelp:l.get("close")}),s.addEventOnElement(t,t.elements._closeButton,"click",function(e){e.stopPropagation(),t._onCloseButtonClick()})),this.elements._closeButton.inject(this.elements._titlebarButtonsDiv,"bottom")}else this.elements._closeButton&&this.elements._closeButton.remove();this.windowGroup&&this.windowGroup._updateCloseButtonFlag(),this._updateTitleMaxWidth()},_applyExpandedFlag:function(e){var t=this;if(this.expandedFlag)s.addEventOnElement(this,this.elements._mainContentDiv,"transitionend",function e(i){i.target===t.elements._mainContentDiv&&(i.stopPropagation(),s.removeEventOnElement(t,t.elements._mainContentDiv,"transitionend",e),t.managePointerEvents())}),this.elements._mainContentDiv.removeClassName("wux-windows-window-maincontent-force-collapse"),this.getContent().removeAttribute("collapsed"),this.elements._mainContentDiv.setStyles({"margin-top":"0px"}),this.expandedFlag&&!e&&this.fire("expand");else if(!this.expandedFlag){if(this.getCollapsibleState()){s.addEventOnElement(this,this.elements._mainContentDiv,"transitionend",function e(i){i.target===t.elements._mainContentDiv&&(i.stopPropagation(),t.elements._mainContentDiv.addClassName("wux-windows-window-maincontent-force-collapse"),s.removeEventOnElement(t,t.elements._mainContentDiv,"transitionend",e),t.managePointerEvents())});var i=this.elements._mainContentDiv.getSize().height;this.elements._mainContentDiv.setStyles({"margin-top":"-"+i+"px"}),this.getContent().setAttributeNode(document.createAttribute("collapsed"))}else this.expandedFlag=!0;!this.expandedFlag&&e&&this.fire("collapse")}void 0!==e&&this.expandedFlag!==e&&this._updateContentVisibleStateChange()},_applyVisibleFlag:function(e){if(this._parent(),this.activeFlag&&this._setFocus(),this._updateContentVisibleStateChange(),this.fire("visibleStateChange"),this.immersiveFrame&&this.currentDockArea!==WUXDockAreaEnum.NoneDockArea){var t=this.immersiveFrame.getDockingElement(this.currentDockArea);t&&(t._updateFromContainedWindows(),t._updateContainedWindows()),this.managePointerEvents()}this.visibleFlag&&this._readWindowPreferences(),this.windowGroup&&this.windowGroup._setWindowVisibility(this),!1===e&&this.visibleFlag&&this._applyPosition()},_applyMovableFlag:function(){this.windowGroup&&this.windowGroup._updateMovableFlag()},_applyEnsureHeightDefinitionOnHierarchy:function(){this.ensureHeightDefinitionOnHierarchy?this.getContent().setAttribute("ensureheightdefinitiononhierarchy",""):this.getContent().removeAttribute("ensureheightdefinitiononhierarchy","")},_applyButtons:function(t){if(null!=this.elements._buttonsDiv)for(;this.elements._buttonsDiv.childNodes.length>0;){if(!((o=this.elements._buttonsDiv.childNodes[0])&&o.dsModel instanceof r))break;o.remove()}if(this.defaultButton=null,this.escapeButton=null,this.elements._headerPopup&&(void 0===this.elements._panelButtonsDiv&&(this.elements._panelButtonsDiv=new e.Element("div",{class:"wux-windows-expander-buttons"})),this.elements._panelButtonsDiv.inject(this.elements._buttonsDiv)),this.buttons){var i=Object.keys(this.buttons);i.sort(function(e,t){return WUXStandardButtonEnum[e]&&WUXStandardButtonEnum[t]?WUXStandardButtonEnum[e].value-WUXStandardButtonEnum[t].value:e-t});for(var n=0;n<i.length;n++){var o,s=i[n];if(s&&WUXStandardButtonEnum[s]){if((o=this.buttons[s])&&o instanceof r){var a=WUXStandardButtonEnum[s].role;a===WUXStandardButtonRoleEnum.AcceptRole||a===WUXStandardButtonRoleEnum.YesRole?this.defaultButton||(this.defaultButton=o):a!==WUXStandardButtonRoleEnum.RejectRole&&a!==WUXStandardButtonRoleEnum.NoRole||this.escapeButton||(this.escapeButton=o),o.value=s,o.dialog=this,null!=this.elements._buttonsDiv&&(this.elements._headerPopup&&this.elements._panelButtonsDiv?o.inject(this.elements._panelButtonsDiv):o.inject(this.elements._buttonsDiv))}}else console.log('Error in Window : "'+s+'" is not a valid standard button')}}this._applyPosition()},_apply_floatLayer:function(){this.getContent().removeAttribute("bottom-layer"),this.getContent().removeAttribute("top-layer"),"bottom"===this._floatLayer?this.getContent().setAttributeNode(document.createAttribute("bottom-layer")):"top"===this._floatLayer&&this.getContent().setAttributeNode(document.createAttribute("top-layer"))},getEmbeddedState:function(){return Boolean(null!==this.getContent().getAttribute("docked")||this.windowGroup)},getCollapsibleState:function(){return!1},getFloatableState:function(){return!0},getMovableState:function(){return this.movableFlag},getContentVisibleState:function(){var e=this.visibleFlag&&this.expandedFlag;if(this.windowGroup){e=e&&this.windowGroup.getContentVisibleState();var t=this.windowGroup.currentWindows;null!=t&&0!==t.length&&-1===t.indexOf(this)&&(e=!1)}if(this.getDockedFlag()&&this.immersiveFrame){var i=this.immersiveFrame.getDockingElement(this.currentDockArea);i&&(e=e&&!i.collapseDockingZoneFlag&&i.visibleDockingZoneFlag)}return e},_updateContentVisibleStateChange:function(){var e=this.getContentVisibleState();this.contentVisibleState!==e&&(this.contentVisibleState=e,this.fire("contentVisibleStateChange",{contentVisibleState:this.contentVisibleState}))},getResizableFlag:function(){return this.resizableFlag},_updateFromEmbeddedState:function(){this.getEmbeddedState()?this.getContent().setAttributeNode(document.createAttribute("embedded")):this.getContent().removeAttribute("embedded"),this._updateContentHeight()},_updateFromCollapsibleState:function(){!this.getCollapsibleState()||!this.allowMaximizeFlag&&this.maximizedFlag?(this.getContent().removeAttribute("collapsible"),this.expandedFlag=!0):this.getContent().setAttributeNode(document.createAttribute("collapsible"))},_preEditCurrentDockArea:function(e,t){return(t===WUXDockAreaEnum.NoneDockArea||t===WUXDockAreaEnum.TopDockArea||t===WUXDockAreaEnum.BottomDockArea||t===WUXDockAreaEnum.LeftDockArea||t===WUXDockAreaEnum.RightDockArea)&&(!!(this.allowedDockAreas&t||t===WUXDockAreaEnum.NoneDockArea)&&!(t===WUXDockAreaEnum.NoneDockArea&&!this.getFloatableState()))},_applyCurrentDockArea:function(e){if(null!==this.immersiveFrame&&void 0!==this.immersiveFrame&&!this._isBeingClosed){function t(){this._applyResizableFlag(),this._updateFromCollapsibleState(),this._updateFromEmbeddedState(),this._updateMinWidth(),this._applyWidth(),this._applyHeight(),this._applyPosition(),this.currentDockArea!==e&&(this.fire("placeChange"),this._fireAndBroadcast("resize",{bubbles:!1}));var t=this.immersiveFrame.getDockingElement(e);t&&(!this.immersiveFrame._ActionBar_V3||e!==WUXDockAreaEnum.BottomDockArea&&e!==WUXDockAreaEnum.TopDockArea||this._moveTitleBar(!1,t),t._updateFromContainedWindows(),t._updateContainedWindows());var i=this.immersiveFrame.getDockingElement(this.currentDockArea);i?(i._updateFromContainedWindows(),i._updateContainedWindows()):e===WUXDockAreaEnum.BottomDockArea&&this._setTitleBarCenteredFlag(!1),this.immersiveFrame._manageAllPointerEventsOnDockingElements()}if(this.currentDockArea===WUXDockAreaEnum.NoneDockArea)this.currentDockArea!==e&&this.fire("prePlaceChange",{previousPlace:{currentDockArea:e}}),this.windowGroup&&this.windowGroup.currentDockArea===this.currentDockArea||(this.windowGroup=null,e&&(this.immersiveFrame.undockWindow(this),this._updateAllWindowsPreferencesInOldDockingElement(e),this.activeFlag&&this.bringToFront())),this.getContent().removeAttribute("docked"),t.call(this);else{function i(){if(this.currentDockArea){this.currentDockArea!==e&&this.fire("prePlaceChange",{previousPlace:{currentDockArea:e}}),this.immersiveFrame.dockWindow(this,this.currentDockArea);var i=document.createAttribute("docked");switch(this.currentDockArea){case WUXDockAreaEnum.TopDockArea:i.value="top";break;case WUXDockAreaEnum.BottomDockArea:i.value="bottom";break;case WUXDockAreaEnum.LeftDockArea:i.value="left";break;case WUXDockAreaEnum.RightDockArea:i.value="right"}this.getContent().setAttributeNode(i),t.call(this)}}this.windowGroup&&this.windowGroup.currentDockArea!==this.currentDockArea&&(this.windowGroup=null),this.windowGroup||this._visibility||-1!==this.width&&(this.currentDockArea===WUXDockAreaEnum.LeftDockArea||this.currentDockArea===WUXDockAreaEnum.RightDockArea)||-1!==this.height&&(this.currentDockArea===WUXDockAreaEnum.TopDockArea||this.currentDockArea===WUXDockAreaEnum.BottomDockArea)?i.call(this):(this.addEventListener("_preVisibilityChange",i.bind(this),{once:!0}),this._moveToImmersiveFrame())}}},managePointerEvents:function(){this.immersiveFrame&&this.currentDockArea!==WUXDockAreaEnum.NoneDockArea&&this.immersiveFrame.getDockingElement(this.currentDockArea)._pointerEventsAllIfOverflow()},_applyImmersiveFrame:function(e){void 0!==e&&this.immersiveFrame!==e&&this.fire("prePlaceChange",{previousPlace:{immersiveFrame:e}}),e&&e.removeWindow(this),this.immersiveFrame&&(this.immersiveFrame.addWindow(this),this._readWindowPreferences(),this.activeFlag&&this.bringToFront(),this._properties.currentDockArea.dirty=!1,this._applyCurrentDockArea(),this.maximizedFlag&&(this._properties.maximizedFlag.dirty=!1,this._applyMaximizedFlag()),this._updateMaxWidth(),this._updateMaxHeight(),this._applyHeight()),void 0!==e&&this.immersiveFrame!==e&&this.fire("placeChange")},_applyWindowGroup:function(e){if(void 0!==e&&this.windowGroup!==e&&this.fire("prePlaceChange",{previousPlace:{windowGroup:e}}),e&&(e.detachWindow(this),e._updateAllowedDockAreas()),this.windowGroup){if(!this.windowGroup.containsWindow(this)){var t=null,i=this.windowGroup.getEmbeddedWindows();i&&(t=i[i.length-1]),this.windowGroup.attachWindow(this,t,WUXSnapAreaEnum.InsideArea)}var n=document.createAttribute("attached-to-group");switch(this.windowGroup.groupType){case WUXWindowGroupTypeEnum.GroupAsGrid:n.value="grid";break;case WUXWindowGroupTypeEnum.GroupAsTab:n.value="tab"}this.getContent().setAttributeNode(n),this.windowGroup._updateAllowedDockAreas()}else this.getContent().removeAttribute("attached-to-group");this._updateFromEmbeddedState(),void 0!==e&&this.windowGroup!==e&&(this._updateContentVisibleStateChange(),this.fire("placeChange"))},_applyActiveSnapArea:function(e){if(this.activeSnapArea===WUXSnapAreaEnum.NoneArea||this.activeSnapArea===WUXSnapAreaEnum.OutsideArea)this.getContent().removeAttribute("active-snap-area"),this.elements._titleBarDiv.removeAttribute("active-snap-area");else{var t=document.createAttribute("active-snap-area");switch(this.activeSnapArea){case WUXSnapAreaEnum.TopArea:t.value="top";break;case WUXSnapAreaEnum.BottomArea:t.value="bottom";break;case WUXSnapAreaEnum.LeftArea:t.value="left";break;case WUXSnapAreaEnum.RightArea:t.value="right";break;case WUXSnapAreaEnum.InsideArea:t.value="inside";var i=document.createAttribute("active-snap-area");i.value="inside",this.elements._titleBarDiv.setAttributeNode(i)}this.getContent().setAttributeNode(t)}},_applyResizableFlag:function(e){!0===this.resizableFlag?(this.getContent().addClassName("wux-windows-window-vertically-resizable"),this.getContent().addClassName("wux-windows-window-horizontally-resizable")):"vertical"===this.resizableFlag?(this.getContent().addClassName("wux-windows-window-vertically-resizable"),this.getContent().removeClassName("wux-windows-window-horizontally-resizable")):"horizontal"===this.resizableFlag?(this.getContent().addClassName("wux-windows-window-horizontally-resizable"),this.getContent().removeClassName("wux-windows-window-vertically-resizable")):(this.getContent().removeClassName("wux-windows-window-vertically-resizable"),this.getContent().removeClassName("wux-windows-window-horizontally-resizable"))},_preEditMinWidth:function(e,t){return null!=t&&!isNaN(t)},_applyMinWidth:function(e){this._applyWidth(),this.windowGroup&&this.windowGroup._updateMinWidth(),!this.immersiveFrame||this.currentDockArea!==WUXDockAreaEnum.LeftDockArea&&this.currentDockArea!==WUXDockAreaEnum.RightDockArea||this.immersiveFrame.getDockingElement(this.currentDockArea)._updateFromContainedWindows()},_updateMinWidth:function(){if(!this.windowGroup)if(!this.immersiveFrame||!this.immersiveFrame._ActionBar_V3||this.currentDockArea!==WUXDockAreaEnum.TopDockArea&&this.currentDockArea!==WUXDockAreaEnum.BottomDockArea||this.maximizedFlag)this._floatingMinWidth&&(this.minWidth=this._floatingMinWidth);else{var e=this.elements._titleDiv,t=window.getComputedStyle(e,null),i=parseInt(t.borderLeft.slice(0,-2)),n=parseInt(t.borderRight.slice(0,-2)),o=parseInt(t.paddingLeft.slice(0,-2)),a=parseInt(t.paddingRight.slice(0,-2)),r=s.computeStringWidth(this.title,parseInt(t.fontSize),t.fontFamily)+o+a+i+n+this._getDragZoneWidth()+3;r>this.minWidth&&(this._floatingMinWidth=this.minWidth,this.minWidth=r)}},_preEditWidth:function(e,t){var i=this.minWidth;return!(-1!==t&&void 0!==i&&t<i)||((-1===e||e>i)&&(this.width=i),!1)},_applyWidth:function(e){this._updateMaxWidth();var t=this.width;if(t&&-1!==t)t<this.minWidth&&(t=this.minWidth);else if(this.elements.container&&this.getContent().parentNode){var i=window.getComputedStyle(this.getContent());i&&Math.round(parseInt(i.width))<t&&(t=this.minWidth)}-1===t?(this.getContent().setStyle("width","auto"),this.elements._mainContentDiv.setStyle("width","auto"),this.elements._footerDiv&&this.elements._footerDiv.setStyle("width","100%")):(this.elements._mainContentDiv.setStyle("width",t+"px"),this.currentDockArea===WUXDockAreaEnum.NoneDockArea||this.currentDockArea===WUXDockAreaEnum.TopDockArea||this.currentDockArea===WUXDockAreaEnum.BottomDockArea?this.elements._footerDiv&&this.elements._footerDiv.setStyle("width",t+"px"):this.elements._footerDiv&&this.elements._footerDiv.setStyle("width","100%")),null!==this.header&&this._updateContentHeight(),void 0!==e&&t!==e&&this._fireAndBroadcast("resize",{bubbles:!1}),this.immersiveFrame&&this.immersiveFrame._updateAllDockingZoneSize(),this.windowGroup&&this.windowGroup.width!==t&&this.windowGroup._updateWidthAndHeight(),this._updateTitleBarWidth()},_updateTitleBarWidth:function(){if(this.currentDockArea===WUXDockAreaEnum.TopDockArea&&this.immersiveFrame&&this.immersiveFrame._ActionBar_V3&&1===this.immersiveFrame.getDockingElement(WUXDockAreaEnum.TopDockArea).getContainedVisibleWindows().length){var e=-1!==this.width?this.width:Math.round(parseFloat(window.getComputedStyle(this.elements._mainContentDiv).width)),t=Math.round(parseFloat(window.getComputedStyle(this.immersiveFrame.getDockingElement(WUXDockAreaEnum.TopDockArea).elements.dockingZone).width));e>t&&(e=t),e=Math.round(e),this.elements._titleBarDiv.setStyle("width",e+"px")}else this.elements._titleBarDiv.setStyle("width","");this.elements._titleDiv.scrollWidth>this.elements._titleDiv.clientWidth?(this.elements._titleDiv.setAttributeNode(document.createAttribute("overflow")),this.elements._titleDiv.tooltipInfos=new m({shortHelp:this.title,owner:this.elements._titleDiv})):(this.elements._titleDiv.removeAttribute("overflow"),this.elements._titleDiv.tooltipInfos=void 0)},_getDragZoneWidth:function(){return this._titleBarCenteredFlag?0:(this._getCurrentTouchMode()?36:22)+this.elements._titlebarButtonsDiv.clientWidth},_updateTitleMaxWidth:function(){var e=0;this._titleBarCenteredFlag||(e=(this._getCurrentTouchMode()?36:24)+this.elements._titlebarButtonsDiv.clientWidth);this.elements._titleDiv.setStyle("max-width","calc(100% - "+e+"px)")},_preEditHeight:function(e,t){if(null!=t&&-1!==t)if(t>=this.minHeight||!this.minHeight){var i=this._getFixedContentHeight();if(t<i)return this.height=i,!1}else if(this.minHeight&&t<this.minHeight)return this.height=this.minHeight,!1;return!0},_applyHeight:function(e){this._updateMaxHeight(),null!==this.height&&void 0!==this.height&&(-1===this.height?this.elements._mainContentDiv.setStyle("height",""):this.elements._mainContentDiv.setStyle("height",this.height+"px"),this._updateContentHeight(),void 0!==e&&this.height!==e&&this._fireAndBroadcast("resize",{bubbles:!1})),this.immersiveFrame&&this.immersiveFrame._updateAllDockingZoneSize(),this._applyMinHeight(),this.windowGroup&&this.windowGroup._updateWidthAndHeight()},getMaxWidth:function(){return this.immersiveFrame.getContent().clientWidth-2},getMaxHeight:function(){return this.immersiveFrame.getContent().clientHeight-2},_computeDropInsertionData:function(e){var t="after",i=this.immersiveFrame._snapTargetWindow;if(!e)return{targetWindow:i,beforeOrAfter:t};var n=this._getTitleWidth(),o=this.elements._titleDiv.getBoundingClientRect();return{targetWindow:i,beforeOrAfter:t=e.x<o.x+n/2?"before":"after"}},_updateMaxWidth:function(){if(this.immersiveFrame&&this.immersiveFrame.elements&&this.immersiveFrame.elements.container&&this.immersiveFrame.getContent().clientWidth>0)if(this.currentDockArea!==WUXDockAreaEnum.NoneDockArea||this.windowGroup)this._titleBarCenteredFlag&&this.isAWindowGroup()&&this._updateMaxTabbarWidth(),this.getContent().setStyle("maxWidth",""),this.elements._titleBarDiv.setStyle("maxWidth",""),this.elements._mainContentDiv.setStyle("maxWidth",""),this.elements._footerDiv&&this.elements._footerDiv.setStyle("maxWidth","");else{var e=this.getMaxWidth();this.getContent().setStyle("maxWidth",e+"px"),this.elements._titleBarDiv.setStyle("maxWidth",e-2+"px"),this.elements._mainContentDiv.setStyle("maxWidth",e-2+"px"),this.elements._footerDiv&&this.elements._footerDiv.setStyle("maxWidth",e-2+"px")}},_updateMaxHeight:function(){if(this.immersiveFrame&&this.immersiveFrame.elements&&this.immersiveFrame.elements.container&&this.immersiveFrame.getContent().clientHeight>0)if(this.currentDockArea!==WUXDockAreaEnum.NoneDockArea||this.windowGroup)this.getContent().setStyle("maxHeight",""),this.elements._contentDiv.setStyle("maxHeight",""),this.elements._mainContentDiv.setStyle("maxHeight","");else{var e=this.getMaxHeight();this.getContent().setStyle("maxHeight",e+"px");var t=this._getTitleBarHeight(),i=this._getFixedContentHeight();this.elements._mainContentDiv.setStyle("maxHeight",e-t+"px"),this.elements._contentDiv.setStyle("maxHeight",e-t-i+"px")}},_getFixedContentHeight:function(){var e=this.header?this.elements._headerDiv.offsetHeight:0,t=this.elements._footerDiv?this.elements._footerDiv.offsetHeight:this.elements._buttonsDiv?this.elements._buttonsDiv.offsetHeight:0,i=window.getComputedStyle(this.elements._contentDiv),n=i?i.getPropertyValue("padding-top"):"";n=""===n?0:parseInt(n,10);var o=i?i.getPropertyValue("padding-bottom"):"";return e+t+(n+(o=""===o?0:parseInt(o,10)))},_updateContentHeight:function(){var e=this._getFixedContentHeight(),t=this.currentDockArea;if(this.maximizedFlag&&!this.windowGroup&&this.allowMaximizeFlag||this.maximizedFlag&&this.windowGroup&&this.windowGroup.allowMaximizeFlag||t==WUXDockAreaEnum.TopDockArea||t==WUXDockAreaEnum.BottomDockArea||this.verticallyStretchableFlag&&(t==WUXDockAreaEnum.RightDockArea||t==WUXDockAreaEnum.LeftDockArea)){var i=0;this.elements._titleBarDiv.getParent()===this.elements.container&&(i=this._getTitleBarHeight()),0===i?this.elements._mainCollapsibleContainer.setStyle("height","100%"):this.elements._mainCollapsibleContainer.setStyle("height","calc(100% - "+i+"px)"),this.elements._contentDiv.setStyle("height","calc(100% - "+e+"px)")}else this.elements._mainCollapsibleContainer.setStyle("height",""),-1==this.height?this.elements._contentDiv.setStyle("height","auto"):this.elements._contentDiv.setStyle("height",this.height-e+"px")},_applyMinHeight:function(e){var t=this.minHeight;this.height&&-1!==this.height&&this.height<t&&(this.height=t);var i=this._getFixedContentHeight();void 0!==t?this.elements._contentDiv.setStyle("min-height",t-i+"px"):this.elements._contentDiv.setStyle("min-height",""),this.windowGroup&&this.windowGroup._updateMinHeight(),!this.immersiveFrame||this.currentDockArea!==WUXDockAreaEnum.TopDockArea&&this.currentDockArea!==WUXDockAreaEnum.BottomDockArea||this.immersiveFrame.getDockingElement(this.currentDockArea)._updateFromContainedWindows()},_applyMaximizedFlag:function(e){if(this.immersiveFrame){if(this._updateFromCollapsibleState(),void 0!==e&&this.maximizedFlag!==e&&this.fire("prePlaceChange",{previousPlace:{maximizedFlag:e}}),this.maximizedFlag&&this.allowMaximizeFlag){var t=document.createAttribute("maximized");this.getContent().setAttributeNode(t),this.windowGroup?this.windowGroup.maximizedFlag=!0:this.immersiveFrame.moveWindowToMaximizeZone(this),this._updateMaximizeButtonIcon()}else if(!0===e){if(this.getContent().removeAttribute("maximized"),this.windowGroup&&this.windowGroup.maximizedFlag!==this.maximizedFlag&&(this.windowGroup=null),this.getDockedFlag()||this.windowGroup||this.currentDockArea!==WUXDockAreaEnum.NoneDockArea){if(!this.windowGroup&&this.currentDockArea!==WUXDockAreaEnum.NoneDockArea){var i=this.currentDockArea;this.currentDockArea=WUXDockAreaEnum.NoneDockArea,this.immersiveFrame.dockWindow(this,i,{restoreDockedDimensions:!0})}}else this._moveToImmersiveFrame(),this.bringToFront();this._updateMaximizeButtonIcon()}this._updateContentHeight(),void 0!==e&&this.maximizedFlag!==e&&(this._updateContentVisibleStateChange(),this.fire("placeChange"),this._fireAndBroadcast("resize,",{bubbles:!1}))}},_applyAllowMaximizeFlag:function(e){this.allowMaximizeFlag||(this.maximizedFlag=!1),this._applyMaximizeButtonFlag(),this.windowGroup&&this.windowGroup._updateAllowedDockAreas(),this._updateTitleMaxWidth()},_updateMaximizeButtonIcon(){this.elements._maximizeButton&&(this.maximizedFlag?(this.elements._maximizeButton.addClassName("wux-ui-3ds-resize-small"),this.elements._maximizeButton.removeClassName("wux-ui-3ds-resize-full"),this.elements._maximizeButton.tooltipInfos.shortHelp=l.get("restore")):(this.elements._maximizeButton.addClassName("wux-ui-3ds-resize-full"),this.elements._maximizeButton.removeClassName("wux-ui-3ds-resize-small"),this.elements._maximizeButton.tooltipInfos.shortHelp=l.get("maximize")))},_applyMaximizeButtonFlag:function(){if(this.maximizeButtonFlag&&this.allowMaximizeFlag){if(!this.elements._maximizeButton){var t=this;this.elements._maximizeButton=new e.Element("button",{type:"button",class:"wux-windows-window-header-button wux-windows-window-header-maximize wux-ui-3ds"}),this.elements._maximizeButton.tooltipInfos=new m({owner:this.elements._maximizeButton,shortHelp:l.get("maximize")}),this._updateMaximizeButtonIcon(),s.addEventOnElement(t,t.elements._maximizeButton,"click",function(e){e.stopPropagation(),t._onMaximizeButtonClick(),t._saveMaximizeInPreferences()})}this.elements._maximizeButton.inject(this.elements._titlebarButtonsDiv,"top")}else this.elements._maximizeButton&&this.elements._maximizeButton.remove();this.windowGroup&&this.windowGroup._updateMaximizeButtonFlag(),this._updateTitleMaxWidth()},_applyHorizontallyStretchableFlag:function(e){if(this.horizontallyStretchableFlag?(this.getContent().addClassName("wux-windows-window-horizontally-stretchable"),this.immersiveFrame&&this.immersiveFrame._ActionBar_V3&&this.elements._titleBarDiv.addClassName("wux-windows-window-horizontally-stretchable")):(this.getContent().removeClassName("wux-windows-window-horizontally-stretchable"),this.immersiveFrame&&this.immersiveFrame._ActionBar_V3&&this.elements._titleBarDiv.removeClassName("wux-windows-window-horizontally-stretchable")),this._applyResizableFlag(),this.managePointerEvents(),this.windowGroup&&this.windowGroup._updateHorizontallyStretchableFlag(),this.immersiveFrame){var t=this.currentDockArea;if(t===WUXDockAreaEnum.TopDockArea||t===WUXDockAreaEnum.BottomDockArea){var i=this.immersiveFrame.getDockingElement(t);i&&i._updateFitToChildState()}}this._updateTitleBarWidth()},_applyVerticallyStretchableFlag:function(e){this.verticallyStretchableFlag?this.getContent().addClassName("wux-windows-window-vertically-stretchable"):this.getContent().removeClassName("wux-windows-window-vertically-stretchable"),this._applyResizableFlag(),this._updateContentHeight(),this.managePointerEvents(),this.windowGroup&&this.windowGroup._updateVerticallyStretchableFlag()},_applyTitleBarVisibleFlag:function(e){this.elements._titleBarDiv&&(this.titleBarVisibleFlag?this.elements._titleBarDiv.removeClassName("wux-windows-unvisible"):this.elements._titleBarDiv.addClassName("wux-windows-unvisible"))},_applyUsePaddingFlag:function(){this.usePaddingFlag?this.getContent().removeAttribute("no-padding"):this.getContent().setAttributeNode(document.createAttribute("no-padding"))},_applyAllowedDockAreas:function(e){if(this.windowGroup&&this.windowGroup._updateAllowedDockAreas(),!(this.getFloatableState()&&this.currentDockArea==WUXDockAreaEnum.NoneDockArea||this.currentDockArea&this.allowedDockAreas))for(var t in this.getFloatableState()&&(this.currentDockArea=WUXDockAreaEnum.NoneDockArea),WUXDockAreaEnum)if(WUXDockAreaEnum[t]!==WUXDockAreaEnum.NoneDockArea&&WUXDockAreaEnum[t]&this.allowedDockAreas){this.currentDockArea=WUXDockAreaEnum[t];break}},_applyProperties:function(e){this._parent(e),this.isDirty("identifier")&&this._applyIdentifier(e.identifier),this.isDirty("content")&&this._applyContent(e.content),this.isDirty("title")&&this._applyTitle(e.title),this.isDirty("_floatLayer")&&this._apply_floatLayer(e._floatLayer),this.isDirty("immersiveFrame")&&this._applyImmersiveFrame(e.immersiveFrame),this.isDirty("icon")&&this._applyIcon(e.icon),this.isDirty("header")&&this._applyHeader(e.header),this.isDirty("position")&&this._applyPosition(e.position),this.isDirty("activeFlag")&&this._applyActiveFlag(),this.isDirty("closeButtonFlag")&&this._applyCloseButtonFlag(),this.isDirty("currentDockArea")&&this._preEditCurrentDockArea(e.currentDockArea,this.currentDockArea)&&this._applyCurrentDockArea(e.currentDockArea),this.isDirty("windowGroup")&&this._applyWindowGroup(e.windowGroup),this.isDirty("activeSnapArea")&&this._applyActiveSnapArea(e.activeSnapArea),this.isDirty("resizableFlag")&&this._applyResizableFlag(e.resizableFlag),this.isDirty("width")&&this._preEditWidth(e.width,this.width)&&this._applyWidth(e.width),this.isDirty("height")&&this._preEditHeight(e.height,this.height)&&this._applyHeight(e.height),this.isDirty("minWidth")&&this._preEditMinWidth(e.minWidth,this.minWidth)&&this._applyMinWidth(e.minWidth),this.isDirty("minHeight")&&this._applyMinHeight(e.minHeight),this.isDirty("expandedFlag")&&this._applyExpandedFlag(e.expandedFlag),this.isDirty("maximizedFlag")&&this._applyMaximizedFlag(e.maximizedFlag),this.isDirty("horizontallyStretchableFlag")&&this._applyHorizontallyStretchableFlag(e.horizontallyStretchableFlag),this.isDirty("verticallyStretchableFlag")&&this._applyVerticallyStretchableFlag(e.verticallyStretchableFlag),this.isDirty("titleBarVisibleFlag")&&this._applyTitleBarVisibleFlag(e.titleBarVisibleFlag),this.isDirty("usePaddingFlag")&&this._applyUsePaddingFlag(e.usePaddingFlag),this.isDirty("buttons")&&this._applyButtons(e.buttons),this.isDirty("ensureHeightDefinitionOnHierarchy")&&this._applyEnsureHeightDefinitionOnHierarchy(),this.isDirty("touchMode")&&this._postEditTouchMode(),this.isDirty("visibleFlag")&&this._applyVisibleFlag(),this._applyMaximizeButtonFlag()},_setTitleBarCenteredFlag:function(e){this._titleBarCenteredFlag!==e&&(this._titleBarCenteredFlag=e,this.elements._titleBarDiv&&(this._titleBarCenteredFlag?(this.elements._titleBarDiv.addClassName("wux-windows-window-titlebar-align-center"),this.elements.container.addClassName("wux-windows-window-align-center")):(this.elements._titleBarDiv.removeClassName("wux-windows-window-titlebar-align-center"),this.elements.container.removeClassName("wux-windows-window-align-center"))),this._updateTitleMaxWidth()),this._setButtonsVisibleFlag(!e)},_moveTitleBar:function(e,t){if(this.elements._titleBarDiv){var i=this.elements._titleBarDiv.getParent();if(e&&t){var n=t._getFixedArea();n&&i!==n&&this.elements._titleBarDiv.inject(n)}else i!==this.elements.container&&this.elements._titleBarDiv.inject(this.elements.container,"top")}},_setButtonsVisibleFlag:function(e){this._buttonsVisibleFlag!==e&&(this._buttonsVisibleFlag=e,this.elements._titlebarButtonsDiv&&(this._buttonsVisibleFlag?this.elements._titlebarButtonsDiv.removeClassName("wux-windows-unvisible"):this.elements._titlebarButtonsDiv.addClassName("wux-windows-unvisible")))},getAbsolutePosition:function(){return this.windowGroup&&this.windowGroup.groupType===WUXWindowGroupTypeEnum.GroupAsTab?this.windowGroup.getAbsolutePosition():this.getContent().getPosition(document.body)},setAbsolutePosition:function(e){if(e){var t=this.getOffsetParentPosition(),i=this.getOffsetParentMargins(),n={x:e.x-t.x-i.left,y:e.y-t.y-i.top},o=this._getReferencePosRelativeToOffsetParent();this.position.offsetX=n.x-o.x,this.position.offsetY=n.y-o.y,this._applyPosition()}},getOffsetParentPosition:function(){var e=this.getContent().getOffsetParent(),t={x:0,y:0};return e&&(t=e.getPosition(document.body)),t},getOffsetParentMargins:function(){var e=this.getContent().getOffsetParent(),t={left:0,right:0,top:0,bottom:0};if(e){var i=window.getComputedStyle(e);""===i.marginLeft?t.left=0:t.left=parseInt(i.marginLeft,10),""===i.marginRight?t.right=0:t.right=parseInt(i.marginRight,10),""===i.marginTop?t.top=0:t.top=parseInt(i.marginTop,10),""===i.marginBottom?t.bottom=0:t.bottom=parseInt(i.marginBottom,10)}return t},getPositionRelativeToOffsetParent:function(){var e=this.getContent().getOffsetParent();return this.getContent().getPosition(e)},close:function(){this._isBeingClosed=!0,this.fire("close"),this.autoCloseFlag&&this.destroy(),this._isBeingClosed=!1},destroy:function(){this._isBeingClosed=!0,this.windowGroup&&(this.windowGroup=null),o.getActiveWindow()===this&&o.setActiveWindow(null),this._ctxMenuToken&&u.removeEventListener(this.elements.container,this._ctxMenuToken),this._rightClickToken&&this.elements._titleBarDiv.removeEventListener("contextmenu",this._rightClickToken),this.immersiveFrame=null,this._parent(),this._isBeingClosed=!1},getDockedFlag:function(){return this.currentDockArea!==WUXDockAreaEnum.NoneDockArea},getZIndex:function(){var e=parseInt(getComputedStyle(this.getContent()).zIndex);return isNaN(e)&&(e=-1),e},bringToFront:function(){this.windowGroup?this.windowGroup.bringToFront():o.bringToFront(this)},ensureVisible:function(){if(this.visibleFlag=!0,this.expandedFlag=!0,this.windowGroup){this.windowGroup.ensureVisible();var e=this.windowGroup.currentWindows;null!=e&&0!==e.length&&-1===e.indexOf(this)&&(this.windowGroup.currentWindows=[this])}if(this.getDockedFlag()&&this.immersiveFrame){var t=this.immersiveFrame.getDockingElement(this.currentDockArea);t&&(t.collapseDockingZoneFlag=!1)}var i=this.getContent();i&&(i.parentNode.scrollTop=i.offsetTop,i.parentNode.scrollLeft=i.offsetLeft)},getTitleBar:function(){return this.elements._titleBarDiv},_getTitleBarHeight:function(){return this.elements._titleBarDiv.offsetHeight},_getTitleWidth:function(){return this.elements._titleDiv.offsetWidth},_ensureTitleBarUnderPointer:function(e){var t=this.getOffsetParentPosition(),i=this.getOffsetParentMargins(),n=this.getContent().getSize(),o=this._getTitleBarHeight(),s=this.getPositionRelativeToOffsetParent();(s.x+t.x+n.width<e.x||s.x+t.x>=e.x)&&(s.x=e.x-n.width/2-t.x-i.left),(s.y+t.y+o<e.y||s.y+t.y>=e.y)&&(s.y=e.y-o/2-t.y-i.top);var a=this._getReferencePosRelativeToOffsetParent();this.position.offsetX=s.x-a.x,this.position.offsetY=s.y-a.y,this._applyPosition(),this._initialPointerPosition&&(this._initialPointerPosition.x=e.x,this._initialPointerPosition.y=e.y),this._initialWindowOffset&&(this._initialWindowOffset.x=this.position.offsetX,this._initialWindowOffset.y=this.position.offsetY)},_canBeSnapSource:function(e,t){return!1},_canBeSnapTarget:function(e,t){return!1},getBoundingClientRect:function(){var e=this.getContent().getBoundingClientRect(),t=this.currentDockArea;if((t===WUXDockAreaEnum.BottomDockArea||t===WUXDockAreaEnum.TopDockArea)&&this.elements._titleBarDiv.getParent()!==this.elements.container){var i=this._getTitleBarHeight();(e={top:e.top,left:e.left,bottom:e.bottom,right:e.right,x:e.x,y:e.y,width:e.width,height:e.height}).top-=i,e.height+=i}return e},_getSnapAreaRect:function(e){var t=this.getBoundingClientRect();switch(e){case WUXSnapAreaEnum.OutsideArea:return t;case WUXSnapAreaEnum.TopArea:return{left:t.left,top:t.top,width:t.width,height:10};case WUXSnapAreaEnum.BottomArea:return{left:t.left,top:t.top+t.height-10,width:t.width,height:10};case WUXSnapAreaEnum.LeftArea:return{left:t.left,top:t.top,width:10,height:t.height};case WUXSnapAreaEnum.RightArea:return{left:t.left+t.width-10,top:t.top,width:10,height:t.height};case WUXSnapAreaEnum.InsideArea:var i=this._getTitleBarHeight();return{left:t.left,top:t.top,width:t.width,height:i}}},isAWindowGroup:function(){return Boolean(this.getContent().hasClassName("wux-windows-windowgroup"))},attachToWindow:function(e,t,i){return this._attachToWindow(e,t,i,!1)},_locateAndAttachToWindow:function(e,t,i){if(this.immersiveFrame){var n=e;if("["===e.charAt(0)){var o=e.split(";");n=(n=o[o.length-1]).substring(0,n.length-1)}var s=this.immersiveFrame._getWindowFromIdentifier(n);if(s)return this._attachToWindow(s,t,i,!0),!0}return!1},_attachToWindow:function(e,t,i,n){var o=-1;if(this.elements&&this.elements.container){var s=this.isAWindowGroup();if(e&&!n){var a=this._getDetachedFromPreferences();if(e.windowGroup||e.isAWindowGroup())for(var r=(e.isAWindowGroup()?e:e.windowGroup).getEmbeddedWindows(),l=0;l<r.length;l++){var d=r[l];if(d&&-1!==a.indexOf(d.identifier))return-1}else if(-1!==a.indexOf(e.identifier))return-1}if(e&&t!==WUXSnapAreaEnum.NoneArea&&t!==WUXSnapAreaEnum.OutsideArea&&this._canBeSnapSource(e,t)&&e._canBeSnapTarget(this,t)){var h=t===WUXSnapAreaEnum.InsideArea?WUXWindowGroupTypeEnum.GroupAsTab:WUXWindowGroupTypeEnum.GroupAsGrid,c=e.isAWindowGroup()?e:null;if((!c||c.groupType!==h)&&(c=e.windowGroup)&&c.groupType!==h){if(h===WUXWindowGroupTypeEnum.GroupAsGrid){var m=this.windowGroup;return m&&m===c?(m.detachWindow(this),o=this._attachToWindow(e,t,i,n),this._applyHeight(),this._applyWidth(),e._postEditTouchMode(),c._postEditTouchMode(),o):(o=this._attachToWindow(c,t,i,n),this._postEditTouchMode(),e._postEditTouchMode(),c._postEditTouchMode(),o)}c=null}if(c||(c=e._createWindowGroup(h))&&(c.immersiveFrame=e.immersiveFrame,c._stackWindowNextTo(e,null,WUXSnapAreaEnum.NoneArea,i,n),e._postEditTouchMode(),c._postEditTouchMode()),c){if(e.isAWindowGroup()){let t=e.getEmbeddedWindows();e=t[t.length-1]}o=c._stackWindowNextTo(this,e,t,i,n);var u=!0,g=!1;for(l=0;l<c.getEmbeddedWindows().length;l++){var p=c.getEmbeddedWindows()[l];if(!1===p.allowMaximizeFlag){u=!1;break}!0===p.maximizeButtonFlag&&(g=!0)}c.maximizeButtonFlag=u&&g,c._postEditTouchMode()}o&&(!n||s&&0===this.getEmbeddedWindows().length||this._saveWindowGroupInPreferences())}}return o},_moveToImmersiveFrame:function(){this.immersiveFrame&&this.immersiveFrame.moveWindowToImmersiveFrame(this)},_getDefaultPosition:function(){return{my:"top left",at:"top left",of:this.immersiveFrame?this.immersiveFrame.getContent():document.body,constraint:this.immersiveFrame?this.immersiveFrame.getContent():document.body,offsetX:0,offsetY:0,collision:"fit"}},_getReferencePosRelativeToOffsetParent:function(){var e=this._getCompletePosition();return e.offsetX=0,e.offsetY=0,n.getPositionRelativeToOffsetParent(this,e)},_fireAndBroadcast:function(e,t){this.fire(e,t)},_onDragPointerDown:function(e){document.body.setAttributeNode(document.createAttribute("dragging"));var t=this;function n(e){e.preventDefault(),t._onDragPointerMove(e)}function o(e){t._onDragPointerUp(e),t.elements.container&&(s.removeEventOnElement(t,t.elements.container.ownerDocument,i.POINTERMOVE,n),s.removeEventOnElement(t,t.elements.container.ownerDocument,i.POINTERUP,o)),t._savePositionInPreferences(),t._onDragPointerDownInfos.dimensions.height===t.height&&t._onDragPointerDownInfos.dimensions.width===t.width||t._saveDimensionsInPreferences(),t._onDragPointerDownInfos.maximizedFlag!==t.maximizedFlag&&t._saveMaximizeInPreferences(),document.body.removeAttribute("dragging"),t.immersiveFrame&&t.immersiveFrame._resetStackedWindowData()}if(t._onDragPointerDownInfos={dimensions:{height:t.height,width:t.width},maximizedFlag:t.maximizedFlag},s.addEventOnElement(t,t,"close",function(e){s.removeEventOnElement(t,t.elements.container.ownerDocument,i.POINTERMOVE,n),s.removeEventOnElement(t,t.elements.container.ownerDocument,i.POINTERUP,o)}),this.getMovableState()){if(!this.getFloatableState()){this.immersiveFrame&&this.elements._ghostFloatableElement.inject(this.immersiveFrame.elements.container),this.elements._ghostFloatableElement.setStyles({width:this.elements.container.getStyle("width"),height:this.elements.container.getStyle("height")}),this._initialGhostWindowOffset||(this._initialGhostWindowOffset={x:0,y:0});var a=this.getPositionRelativeToOffsetParent(),r=this._getReferencePosRelativeToOffsetParent();this._initialGhostWindowOffset.x=a.x-r.x,this._initialGhostWindowOffset.y=a.y-r.y}this._initialPointerPosition.x=e.clientX,this._initialPointerPosition.y=e.clientY;var l=this.getPositionRelativeToOffsetParent(),d=this._getReferencePosRelativeToOffsetParent();this._initialWindowOffset.x=l.x-d.x,this._initialWindowOffset.y=l.y-d.y,s.addEventOnElement(this,this.elements.container.ownerDocument,i.POINTERMOVE,n),s.addEventOnElement(this,this.elements.container.ownerDocument,i.POINTERUP,o),this.fire("startWindowDrag")}},_onDragPointerMove:function(e){if(0===e.button){e.preventDefault();var t=e.clientX-this._initialPointerPosition.x,i=e.clientY-this._initialPointerPosition.y;if(0!==t||0!==i){var o={};if("top left"!==this.position.my||"top left"!==this.position.at){o.my="top left",o.at="top left";var s=this.getPositionRelativeToOffsetParent();this._initialWindowOffset.x=s.x,this._initialWindowOffset.y=s.y}if(o.offsetX=this._initialWindowOffset.x+t,o.offsetY=this._initialWindowOffset.y+i,this.modifyObjectFromUIInteraction("position",o),this.getFloatableState()){if(this.maximizedFlag&&(Math.abs(t)>15||Math.abs(i)>15)){this.setPropertyFromUIInteraction("maximizedFlag",!1),this._saveMaximizeInPreferences();var a={};a.x=e.clientX,a.y=e.clientY,this._ensureTitleBarUnderPointer(a)}}else{if(!this.ghostPosition){var r=this._getCompletePosition();this.ghostPosition=r}this.ghostPosition.offsetX=this._initialGhostWindowOffset.x+t,this.ghostPosition.offsetY=this._initialGhostWindowOffset.y+i,n.setPosition(this.elements._ghostFloatableElement,this.ghostPosition),this.elements._ghostFloatableElement.show()}(this.immersiveFrame?this.immersiveFrame._computeFiringWindowDragEvents(this):this).fire("windowDrag",{x:e.clientX,y:e.clientY,deltaX:t,deltaY:i})}}},_onDragPointerUp:function(e){this.elements._ghostFloatableElement.hide(),this._setFocus(this.lastFocusedWidget),this.fire("stopWindowDrag",{x:e.clientX,y:e.clientY})},_onCloseButtonClick:function(e){this.disabled||this.callMethodFromUIInteraction("close")},_onMaximizeButtonClick:function(e){this.allowMaximizeFlag&&this.setPropertyFromUIInteraction("maximizedFlag",!this.maximizedFlag)},handleEvents:function(){var e=this;s.addEventOnElement(this,document,"touchChange",function(){e._applyWidth(),e._applyHeight(),e._applyPosition()}),s.addEventOnElement(this,this.getContent(),"dimensionsChanged",function(t){if((-1===e.height||e.maximizedFlag||e.header)&&e._updateContentHeight(),-1!==e.height&&-1!==e.width||(e._applyPosition(),e.windowGroup?e.windowGroup._updateTitleBarWidth():e._updateTitleBarWidth()),e.currentDockArea!==WUXDockAreaEnum.NoneDockArea){var i=e.immersiveFrame.getDockingElement(e.currentDockArea);i&&i._pointerEventsAllIfOverflow()}t.stopPropagation()}),s.addEventOnElement(this,this.elements.container,"keydown",function(t){var i=null;switch(t.keyCode){case d.ENTER:i=e.defaultButton;break;case d.ESCAPE:i=e.escapeButton}i&&(e._buttonOnKeydownPressed=i,t.stopPropagation())}),s.addEventOnElement(this,this.elements.container,"keyup",function(t){var i=null;if(!t.altKey&&!t.shiftKey&&!t.ctrlKey){switch(t.keyCode){case d.ENTER:i=e.defaultButton;break;case d.ESCAPE:i=e.escapeButton}if(i&&(t.keyCode!==d.ENTER||!s.isElementInside(t.target,e.elements._buttonsDiv))&&e._buttonOnKeydownPressed===i&&(e.activateButtonsIfActionPerformed||!t.actionPerformed)){var n=document.createEvent("MouseEvents");n.initEvent("click",!0,!0),i.elements.button.dispatchEvent(n),t.stopPropagation(),t.preventDefault()}e._buttonOnKeydownPressed=void 0}}),this._initialPointerPosition||(this._initialPointerPosition={x:0,y:0}),this._initialWindowOffset||(this._initialWindowOffset={x:0,y:0}),this._initialWindowSize||(this._initialWindowSize={height:0,width:0}),s.addEventOnElement(this,e.elements.container,i.POINTERDOWN,function(t){e.activeFlag||(e.setPropertyFromUIInteraction("activeFlag",!0),s.addEventOnElement(e,document.body,i.POINTERUP,function(t){s.isElementInside(t.target,e.getContent())&&!s.isElementInside(document.activeElement,e.getContent())&&e._setFocus(e.lastFocusedWidget)},{once:!0}))}),s.addEventOnElement(this,e.elements._titleBarDiv,i.POINTERDOWN,function(t){e.setPropertyFromUIInteraction("activeFlag",!0),s.isElementInside(t.target,e.elements._titlebarButtonsDiv)||e.elements._tabBarContainer&&s.isElementInside(t.target,e.elements._tabBarContainer)||0!==t.button||e._onDragPointerDown(t)}),s.addEventOnElement(this,e.elements._titleBarDiv,i.POINTERHIT,function(t){2===t.multipleHitCount&&(t.preventDefault(),!e.getCollapsibleState()||s.isElementInside(t.target,e.elements._titlebarButtonsDiv)||e.elements._tabBarContainer&&s.isElementInside(t.target,e.elements._tabBarContainer)||(t.stopPropagation(),e.setPropertyFromUIInteraction("expandedFlag",!e.expandedFlag)))});var t=function(t,i){e._deltaPositionY=t-e._initialPointerPosition.y,"fit"===e._getCompletePosition().collision&&e._initialBoundingRect.top+e._deltaPositionY<0&&(e._deltaPositionY=-e._initialBoundingRect.top),e._initialWindowSize.height-e._deltaPositionY<i&&(e._deltaPositionY=e._initialWindowSize.height-i)};function n(i){i.preventDefault();var n=e._getFixedContentHeight();t(i.clientY,n),e.setPropertyFromUIInteraction("height",e._initialWindowSize.height-e._deltaPositionY),e._deltaPositionY=e._initialWindowSize.height-e.height,v.call(e,null,"top","topHandlerPointerMove")}var o=function(t,i){e._deltaPositionY=t-e._initialPointerPosition.y;var n=e.immersiveFrame?e.immersiveFrame.getContent().clientHeight-e.immersiveFrame.getContent().clientTop:document.body.clientHeight||window.innerHeight,o=n-e._initialBoundingRect.bottom-e._deltaPositionY;"fit"===e._getCompletePosition().collision&&o<0&&(e._deltaPositionY=n-e._initialBoundingRect.bottom),e._initialWindowSize.height+e._deltaPositionY<i&&(e._deltaPositionY=i-e._initialWindowSize.height)};function a(t){t.preventDefault();var i=e._getFixedContentHeight();o(t.clientY,i),e.setPropertyFromUIInteraction("height",e._initialWindowSize.height+e._deltaPositionY),e._deltaPositionY=e.height-e._initialWindowSize.height,v.call(e,null,"bottom","bottomHandlerPointerMove")}var r=function(t){e._deltaPositionX=t-e._initialPointerPosition.x;var i=e.immersiveFrame?e.immersiveFrame.getContent().clientWidth-e.immersiveFrame.getContent().clientLeft:document.body.clientWidth||window.innerWidth;"fit"===e._getCompletePosition().collision&&e._deltaPositionX>i-e._initialBoundingRect.right&&(e._deltaPositionX=i-e._initialBoundingRect.right),e._initialWindowSize.width+e._deltaPositionX<0&&(e._deltaPositionX=-e._initialWindowSize.width)};function l(t){t.preventDefault(),r(t.clientX);var i=e._deltaPositionX;e.currentDockArea===WUXDockAreaEnum.BottomDockArea&&"center"===e.immersiveFrame.getDockingElement(WUXDockAreaEnum.BottomDockArea).alignment&&(i=2*e._deltaPositionX),e.setPropertyFromUIInteraction("width",e._initialWindowSize.width+i),e._deltaPositionX=e.width-e._initialWindowSize.width,v.call(e,"right",null,"rightHandlerPointerMove")}var h=function(t){e._deltaPositionX=t-e._initialPointerPosition.x,"fit"===e._getCompletePosition().collision&&e._initialBoundingRect.left+e._deltaPositionX<0&&(e._deltaPositionX=-e._initialBoundingRect.left),e._initialWindowSize.width-e._deltaPositionX<0&&(e._deltaPositionX=e._initialWindowSize.width)};function c(t){t.preventDefault(),h(t.clientX),e.setPropertyFromUIInteraction("width",e._initialWindowSize.width-e._deltaPositionX),e._deltaPositionX=e._initialWindowSize.width-e.width,v.call(e,"left",null,"leftHandlerPointerMove")}function m(t){n.call(e,t),c.call(e,t)}function u(t){n.call(e,t),l.call(e,t)}function g(t){a.call(e,t),l.call(e,t)}function p(t){a.call(e,t),c.call(e,t)}function f(t){if(e._fireAndBroadcast("stopResize"),s.removeEventOnElement(e,e.elements.container.ownerDocument,i.POINTERMOVE,n),s.removeEventOnElement(e,e.elements.container.ownerDocument,i.POINTERMOVE,l),s.removeEventOnElement(e,e.elements.container.ownerDocument,i.POINTERMOVE,a),s.removeEventOnElement(e,e.elements.container.ownerDocument,i.POINTERMOVE,c),s.removeEventOnElement(e,e.elements.container.ownerDocument,i.POINTERMOVE,m),s.removeEventOnElement(e,e.elements.container.ownerDocument,i.POINTERMOVE,u),s.removeEventOnElement(e,e.elements.container.ownerDocument,i.POINTERMOVE,g),s.removeEventOnElement(e,e.elements.container.ownerDocument,i.POINTERMOVE,p),s.removeEventOnElement(e,e.elements.container.ownerDocument,i.POINTERUP,f),document.body.removeAttribute("resizing"),e.immersiveFrame){var o=e.immersiveFrame.getDockingElement(e.currentDockArea);o&&(e.managePointerEvents(),o._scrollToBottom())}e._saveDimensionsInPreferences(),e._savePositionInPreferences()}function w(t){document.body.setAttributeNode(document.createAttribute("resizing")),e.setPropertyFromUIInteraction("activeFlag",!0),e._initialPointerPosition.x=t.clientX,e._initialPointerPosition.y=t.clientY,e._initialBoundingRect=e.elements.container.getBoundingClientRect(),e.immersiveFrame&&e.currentDockArea===WUXDockAreaEnum.NoneDockArea&&(e._initialBoundingRect=_.call(e)),e._initialWindowSize.width=e.elements._mainContentDiv.clientWidth,e._initialWindowSize.height=e.elements._mainContentDiv.clientHeight;var i=e.getPositionRelativeToOffsetParent(),n=e._getReferencePosRelativeToOffsetParent();e._initialWindowOffset.x=i.x-n.x,e._initialWindowOffset.y=i.y-n.y}this.elements._resizeZone&&s.addEventOnElement(this,this.elements._resizeZone,i.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"bottom right",cursor:"nw-resize"}),w(t),s.addEventOnElement(e,e.elements.container.ownerDocument,i.POINTERMOVE,g),s.addEventOnElement(e,e.elements.container.ownerDocument,i.POINTERUP,f)}),s.addEventOnElement(this,this.elements._topResizeHandler,i.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"top",cursor:"s-resize"}),w(t),s.addEventOnElement(e,e.elements.container.ownerDocument,i.POINTERMOVE,n),s.addEventOnElement(e,e.elements.container.ownerDocument,i.POINTERUP,f)}),s.addEventOnElement(this,this.elements._bottomResizeHandler,i.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"bottom",cursor:"s-resize"}),w(t),s.addEventOnElement(e,e.elements.container.ownerDocument,i.POINTERMOVE,a),s.addEventOnElement(e,e.elements.container.ownerDocument,i.POINTERUP,f)}),s.addEventOnElement(this,this.elements._rightResizeHandler,i.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"right",cursor:"w-resize"}),w(t),s.addEventOnElement(e,e.elements.container.ownerDocument,i.POINTERMOVE,l),s.addEventOnElement(e,e.elements.container.ownerDocument,i.POINTERUP,f)}),s.addEventOnElement(this,this.elements._leftResizeHandler,i.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"left",cursor:"w-resize"}),w(t),s.addEventOnElement(e,e.elements.container.ownerDocument,i.POINTERMOVE,c),s.addEventOnElement(e,e.elements.container.ownerDocument,i.POINTERUP,f)}),s.addEventOnElement(this,this.elements._topLeftResizeHandler,i.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"top left",cursor:"nw-resize"}),w(t),s.addEventOnElement(e,e.elements.container.ownerDocument,i.POINTERMOVE,m),s.addEventOnElement(e,e.elements.container.ownerDocument,i.POINTERUP,f)}),s.addEventOnElement(this,this.elements._topRightResizeHandler,i.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"top right",cursor:"sw-resize"}),w(t),s.addEventOnElement(e,e.elements.container.ownerDocument,i.POINTERMOVE,u),s.addEventOnElement(e,e.elements.container.ownerDocument,i.POINTERUP,f)}),s.addEventOnElement(this,this.elements._bottomRightResizeHandler,i.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"bottom right",cursor:"nw-resize"}),w(t),s.addEventOnElement(e,e.elements.container.ownerDocument,i.POINTERMOVE,g),s.addEventOnElement(e,e.elements.container.ownerDocument,i.POINTERUP,f)}),s.addEventOnElement(this,this.elements._bottomLeftResizeHandler,i.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"bottom left",cursor:"sw-resize"}),w(t),s.addEventOnElement(e,e.elements.container.ownerDocument,i.POINTERMOVE,p),s.addEventOnElement(e,e.elements.container.ownerDocument,i.POINTERUP,f)})},_hasValidIdentifier:function(){if(""!==this.identifier){var e=Math.floor(Number(this.identifier));return e<0||String(e)!==this.identifier}return!1},_saveDataInPreferences:function(e,t){this._hasValidIdentifier()&&n.saveDataInLocalPreferences(this,windowPrefKey,e,t)},_getDataFromPreferences:function(e){var t=void 0;return this._hasValidIdentifier()&&(t=n.getDataFromLocalPreferences(this,windowPrefKey,e)),t},_savePositionInPreferences:function(){if(this.identifier){var e=this;this.windowGroup&&(e=this.windowGroup);var t={my:e.position.my,at:e.position.at,collision:e.position.collision,offsetX:e.position.offsetX,offsetY:e.position.offsetY},i="position";this._saveDataInPreferences(i,t),-1===this._savedPreferencesKeys.indexOf(i)&&this._savedPreferencesKeys.push(i)}},_getPositionFromPreferences:function(){return this._getDataFromPreferences("position")},_saveDimensionsInPreferences:function(){if(this.identifier){var e={height:this.height,width:this.width},t="dimension";this._saveDataInPreferences(t,e),-1===this._savedPreferencesKeys.indexOf(t)&&this._savedPreferencesKeys.push(t)}},_getDimensionsFromPreferences:function(){return this._getDataFromPreferences("dimension")},_saveDockedDimensionsInPreferences:function(){if(this.identifier){var e;this.currentDockArea===WUXDockAreaEnum.NoneDockArea?e={height:void 0,width:void 0}:((e=this._getDockedDimensionsFromPreferences())||(e={}),this.currentDockArea===WUXDockAreaEnum.LeftDockArea||this.currentDockArea===WUXDockAreaEnum.RightDockArea?e.width=this.immersiveFrame.getDockingElement(this.currentDockArea).dockingZoneSize:e.height=this.immersiveFrame.getDockingElement(this.currentDockArea).dockingZoneSize);var t="dockedDimensions";this._saveDataInPreferences(t,e),-1===this._savedPreferencesKeys.indexOf(t)&&this._savedPreferencesKeys.push(t)}},_getDockedDimensionsFromPreferences:function(){return this._getDataFromPreferences("dockedDimensions")},_updateAllWindowsPreferencesInOldDockingElement:function(e,t){if(this.immersiveFrame){let i=[],n=[];e!==WUXDockAreaEnum.NoneDockArea&&((n=this.immersiveFrame.getDockingElement(e).getContainedVisibleWindows()).length>0&&n.map(e=>{e._hasValidIdentifier()&&i.push(e.identifier)}),n.length>0&&n.map(n=>{n._hasValidIdentifier()&&(n._saveDataInPreferences("dockAreaOrder",i),t&&n._saveDataInPreferences("dockArea",e))}))}},_saveDockAreaInPreferences:function(){if(this.identifier&&this.immersiveFrame){let t=[],i=[];this.currentDockArea!==WUXDockAreaEnum.NoneDockArea&&(i=this.immersiveFrame.getDockingElement(this.currentDockArea).getContainedVisibleWindows());var e=this.currentDockArea;i.length>0?this._updateAllWindowsPreferencesInOldDockingElement(e,!0):this._saveDataInPreferences("dockAreaOrder",t),this._saveDataInPreferences("dockArea",e),-1===this._savedPreferencesKeys.indexOf("dockArea")&&this._savedPreferencesKeys.push("dockArea")}},_getDockAreaFromPreferences:function(){return this._getDataFromPreferences("dockArea")},_getDockAreaOrderFromPreferences:function(){return this._getDataFromPreferences("dockAreaOrder")},_saveMaximizeInPreferences:function(){if(this.identifier){var e=this.maximizedFlag,t="maximizedFlag";this._saveDataInPreferences(t,e),-1===this._savedPreferencesKeys.indexOf(t)&&this._savedPreferencesKeys.push(t)}},_getMaximizedFlagFromPreferences:function(){return this._getDataFromPreferences("maximizedFlag")},_getWindowGroupAsTabFromPreferences:function(){var e=this._getDataFromPreferences("windowGroupAsTab");return e||(e=[]),e},_saveWindowGroupAsTabInPreferences:function(e){this._saveDataInPreferences("windowGroupAsTab",e)},_getSnappingFromPreferences:function(){var e=this._getDataFromPreferences("windowGroupAsGrid");return e||(e=[]),e},_saveSnappingInPreferences:function(e){this._saveDataInPreferences("windowGroupAsGrid",e)},_getDetachedFromPreferences:function(){var e=this._getDataFromPreferences("detachedFrom");return e||(e=[]),e},_saveDetachedInPreferences:function(e){this._saveDataInPreferences("detachedFrom",e)},_saveWindowGroupInPreferences:function(e){if(this.isAWindowGroup())for(var t=this.getEmbeddedWindows(),i=0;i<t.length;i++){(l=t[i])&&void 0!==l.identifier&&(!e||e.isAWindowGroup()&&0===e.getEmbeddedWindows().length||l._saveWindowGroupInPreferences(e))}else if(this.identifier)if(e){var n=this._getDetachedFromPreferences();if(e.isAWindowGroup())for(t=e.getEmbeddedWindows(),i=0;i<t.length;i++){if((l=t[i])&&void 0!==l.identifier){0!==n.length&&-1!==n.indexOf(l.identifier)||l.identifier===this.identifier||n.push(l.identifier);var o=l._getDetachedFromPreferences();0!==o.length&&-1!==o.indexOf(this.identifier)||(o.push(this.identifier),l._saveDetachedInPreferences(o))}}else{void 0===e.identifier||0!==n.length&&-1!==n.indexOf(e.identifier)||n.push(e.identifier);var s=e._getDetachedFromPreferences();0!==s.length&&-1!==s.indexOf(this.identifier)||void 0===e.identifier||(s.push(this.identifier),e._saveDetachedInPreferences(s))}if(this._saveDetachedInPreferences(n),e.isAWindowGroup())for(t=e.getEmbeddedWindows(),this._getWindowGroupAsTabFromPreferences(),i=0;i<t.length;i++){(l=t[i])&&void 0!==l.identifier&&(this._saveWindowGroupAsTabInPreferences(this._locateAndRemoveWindowFromWGAsTabPreferencesArray(this,l.identifier,this._getWindowGroupAsTabFromPreferences())),l._saveWindowGroupAsTabInPreferences(this._locateAndRemoveWindowFromWGAsTabPreferencesArray(l,this.identifier,l._getWindowGroupAsTabFromPreferences())))}else void 0!==e.identifier&&(this._saveWindowGroupAsTabInPreferences(this._locateAndRemoveWindowFromWGAsTabPreferencesArray(this,e.identifier,this._getWindowGroupAsTabFromPreferences())),e._saveWindowGroupAsTabInPreferences(this._locateAndRemoveWindowFromWGAsTabPreferencesArray(e,this.identifier,e._getWindowGroupAsTabFromPreferences())));this.windowGroup&&this._saveWindowGroupInPreferences()}else if(this.windowGroup){var a=this.windowGroup;if(a.groupType===WUXWindowGroupTypeEnum.GroupAsTab){var r=[];a.windowGroup&&a.windowGroup.groupType===WUXWindowGroupTypeEnum.GroupAsGrid&&a.windowGroup;for(t=a.getEmbeddedWindows(),i=0;i<t.length;i++){(l=t[i])&&void 0!==l.identifier&&r.push(l.identifier)}for(i=0;i<t.length;i++){(l=t[i])&&void 0!==l.identifier&&l._saveWindowGroupAsTabInPreferences(l._addWGAsTabPreferences(r))}for(i=0;i<t.length;i++){var l;if((l=t[i])&&void 0!==l.identifier){n=l._getDetachedFromPreferences();if(l.identifier===this.identifier){for(var d=0;d<r.length;d++){var h=r[d];-1!==n.indexOf(h)&&n.splice(n.indexOf(h),1)}l._saveDetachedInPreferences(n)}else-1!==n.indexOf(this.identifier)&&(n.splice(n.indexOf(this.identifier),1),l._saveDetachedInPreferences(n))}}}else a.groupType===WUXWindowGroupTypeEnum.GroupAsGrid&&a}else console.log("Saving the preferences of a Window that is being attached to nothing... failed")},_locateAndRemoveWindowFromWGAsTabPreferencesArray:function(e,t,i){for(var n=0;n<i.length;n++){var o=i[n];if(-1!==o.indexOf(t)){o.splice(o.indexOf(t),1),1===o.length&&(o[0]===e.identifier?i.splice(n,1):console.log("There is a WindowGroup preferences that is composed of only one Window, but it is not the Window in question"));break}}return i},_addWGAsTabPreferences:function(e){var t=this._getWindowGroupAsTabFromPreferences();if(-1===t.indexOf(e)){for(var i=0;i<e.length;i++){var n=e[i];n!==this.identifier&&(t=this._locateAndRemoveWindowFromWGAsTabPreferencesArray(this,n,t))}return t.push(e),t}console.log("preferences for this WindowGroup have already been saved : "+this.identifier)},_readWindowPreferences:function(){if(this._hasValidIdentifier()&&this.visibleFlag&&this.immersiveFrame&&this.immersiveFrame.containsWindow(this)&&this._prefRestorationState===WUXPreferenceRestorationStateEnum.NotRestored){if(this._prefRestorationState=WUXPreferenceRestorationStateEnum.BeingRestored,this.visibleFlag){var e=this._getDimensionsFromPreferences();e&&(this._properties.height.dirty=!1,this._properties.width.dirty=!1,this.height=e.height,this.width=e.width,this._savedPreferencesKeys.push("dimension"))}let g=this._getDockAreaFromPreferences(),p=this._getDockAreaOrderFromPreferences();if(void 0!==g){this._properties.currentDockArea.dirty=!1;let e=this.immersiveFrame&&this.immersiveFrame.windows?this.immersiveFrame.windows:[];p&&p.length>0?p.map(t=>{let i=e[t];i&&(i.currentDockArea!==WUXDockAreaEnum.NoneDockArea&&(i.currentDockArea=WUXDockAreaEnum.NoneDockArea),i.currentDockArea=g)}):this.currentDockArea=g,this._savedPreferencesKeys.push("dockArea"),this._savedPreferencesKeys.push("dockAreaOrder")}var t=this._getMaximizedFlagFromPreferences();void 0!==t&&(this._properties.maximizedFlag.dirty=!1,this.maximizedFlag=t,this._savedPreferencesKeys.push("maximizedFlag"));var i=this._getWindowGroupAsTabFromPreferences();if(i&&i.length>0){for(var n=i.length-1;n>=0;n--){for(var o,s,a,r=i[n],l=0;l<r.length;l++){var d=r[l];if(d===this.identifier)o=l;else if(this.immersiveFrame.windows[d]){if(void 0!==o){if(a){if(o-s>l-o){a=d,s=l;break}break}a=d,s=l;break}a=d,s=l}}if(void 0!==o&&a&&void 0!==s){var h=o<s?"before":"after",c=this.immersiveFrame.windows[a];if(c.currentDockArea===this.currentDockArea&&c.maximizedFlag===this.maximizedFlag){this.attachToWindow(c,WUXSnapAreaEnum.InsideArea,h);break}a=void 0,s=void 0,o=void 0}}this._savedPreferencesKeys.push("windowGroupAsTab")}var m=this._getPositionFromPreferences();if(m){var u={};u.at=m.at,u.collision=m.collision,u.my=m.my,u.offsetX=m.offsetX,u.offsetY=m.offsetY,this.windowGroup?this.windowGroup.position=u:(this._properties.position.dirty=!1,this.position=u),this._savedPreferencesKeys.push("position")}this._prefRestorationState=WUXPreferenceRestorationStateEnum.Restored}},deleteWindowPreferences:function(){for(var e=0;e<this._savedPreferencesKeys.length;e++){var t=this._savedPreferencesKeys[e];n.deleteDataFromLocalPreferences(this,windowPrefKey,t)}var i=this._getDetachedFromPreferences();for(e=0;e<i.length;e++){var o=i[e],s=n.getDataFromLocalPreferences(o,windowPrefKey,"detachedFrom");s.splice(s.indexOf(this.identifier),1),n.saveDataInLocalPreferences(o,windowPrefKey,"detachedFrom",s)}n.deleteDataFromLocalPreferences(this,windowPrefKey,"detachedFrom");var a=this._getWindowGroupAsTabFromPreferences();for(e=0;e<a.length;e++)for(var r=a[e],l=0;l<r.length;l++){var d=r[l];if(d!==this.identifier){var h=n.getDataFromLocalPreferences(d,windowPrefKey,"windowGroupAsTab");if(h){for(var c=0;c<h.length;c++){var m=h[c];-1!==m.indexOf(this.identifier)&&m.splice(m.indexOf(this.identifier),1),m.length<=1&&h.splice(c,1)}n.saveDataInLocalPreferences(d,windowPrefKey,"windowGroupAsTab",h)}}}n.deleteDataFromLocalPreferences(this,windowPrefKey,"windowGroupAsTab"),this.immersiveFrame&&this._updateAllWindowsPreferencesInOldDockingElement(this.currentDockArea,!1),n.deleteDataFromLocalPreferences(this,windowPrefKey,"dockAreaOrder")},_locateAndModifyWindowGroup:function(e){}}),v=function(e,t){var i=!1,n=void 0,o=void 0,s=this._getCompletePosition();if(t&&(this.height>=this.minHeight||void 0===this.minHeight&&this.height>=0)){var a=this._getFixedContentHeight();this.height>=a&&(s.my.indexOf(t)>-1&&(o=this._initialWindowOffset.y+this._deltaPositionY,i=!0),(s.my.indexOf("center")>-1||"left"===s.my||"right"===s.my)&&(o=this._initialWindowOffset.y+this._deltaPositionY/2,i=!0))}e&&(this.width>=this.minWidth||void 0===this.minWidth&&this.width>=0)&&(s.my.indexOf(e)>-1&&(n=this._initialWindowOffset.x+this._deltaPositionX,i=!0),(s.my.indexOf("center")>-1||"top"===s.my||"bottom"===s.my)&&(n=this._initialWindowOffset.x+this._deltaPositionX/2,i=!0));var r={};return void 0!==n&&(r.offsetX=n),void 0!==o&&(r.offsetY=o),this.modifyObjectFromUIInteraction("position",r),i},_=function(){if(this.immersiveFrame){var e={};return e.top=this.getContent().getBoundingClientRect().top-this.immersiveFrame.getContent().getBoundingClientRect().top,e.height=this.getContent().clientHeight,e.bottom=e.top+e.height,e.left=this.getContent().getBoundingClientRect().left-this.immersiveFrame.getContent().getBoundingClientRect().left,e.width=this.getContent().clientWidth,e.right=e.left+e.width,e}};return h.register(w,"DS/ControlsRec/AbstractRec"),w}),define("DS/Windows/Dialog",["UWA/Core","DS/Windows/Window","DS/Controls/Button","DS/Utilities/Dom","DS/Controls/Toggle","DS/Controls/TooltipModel"],function(e,t,i,n,o,s){"use strict";var a=t.inherit({name:"dialog",publishedProperties:{modalFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},checkboxInfos:{defaultValue:void 0,type:"object",category:"Behavior"},customButtonsDefinition:{defaultValue:void 0,type:"object",category:"Behavior"}},buildView:function(){var t=this;this._parent(),this.elements.container.addClassName("wux-windows-dialog"),this.elements._footerDiv=new e.Element("div",{class:"wux-windows-dialog-footer"}),this.elements._footerDiv.inject(this.elements._mainContentDiv),this.elements._buttonsDiv=new e.Element("div",{class:"wux-windows-dialog-buttons"}),this.elements._buttonsDiv.inject(this.elements._footerDiv),this.elements._resizeZone=new e.Element("div",{class:"wux-windows-dialog-resize-zone"}),this.elements._resizeZone.inject(this.elements._footerDiv),this._applyCurrentDockArea(),n.onNodeRendered(this.getContent(),function(){t.elements.container&&t._applyMinWidth()})},_applyRecId:function(e){if(this._parent(e),this.buttons)for(var t=Object.keys(this.buttons),n=0;n<t.length;n++){var o=t[n],s=this.buttons[o];s&&s instanceof i&&!s.recId&&(s.recId=this.recId+"_"+o)}},_applyImmersiveFrame:function(e){this._parent(e),!this.immersiveFrame&&!this._isBeingClosed&&this.visibleFlag&&this.elements&&this.elements.container&&!this.elements.container.parentNode&&this.inject(document.body),this._applyModalFlag()},_applyResizableFlag:function(e){this._parent(e),!0===this.resizableFlag?(this.elements._resizeZone.show(),this.elements._footerDiv.addClassName("resize-padding")):(this.elements._resizeZone.hide(),this.elements._footerDiv.removeClassName("resize-padding"))},_applyButtons:function(e){if(this._parent(e),this.buttons&&Object.keys(this.buttons).length>0)for(var t=Object.keys(this.buttons),n=0;n<t.length;n++){var o=t[n];if(o&&WUXStandardButtonEnum[o]){var s=this.buttons[o];if(s&&s instanceof i){s.label||(s.label=this.getDefaultButtonLabel(o)),this.recId&&!s.recId&&(s.recId=this.recId+"_"+o);var a=WUXStandardButtonEnum[o].role;a===WUXStandardButtonRoleEnum.AcceptRole||a===WUXStandardButtonRoleEnum.YesRole?s.emphasize="primary":s.emphasize="secondary"}}}else this.customButtonsDefinition&&this._applyCustomButtonsDefinition();0===this.elements._buttonsDiv.childNodes.length?this.elements._footerDiv.hide():this.elements._footerDiv.show(),this._applyMinWidth(),this._applyHeight()},_applyCustomButtonsDefinition:function(){if(this.customButtonsDefinition&&Array.isArray(this.customButtonsDefinition)&&(!this.buttons||0===Object.keys(this.buttons).length)){if(this.defaultButton=null,this.escapeButton=null,this._customButtons)for(var e=0;e<this._customButtons.legnth;e++)this._customButtons[e].destroy();if(this._customButtons=[],null!=this.elements._buttonsDiv)for(;this.elements._buttonsDiv.childNodes.length>0;){var t=this.elements._buttonsDiv.childNodes[0];if(!(t&&t.dsModel instanceof i))break;t.remove()}for(e=0;e<this.customButtonsDefinition.length;e++){let t=new i(this.customButtonsDefinition[e]);this._customButtons.push(t),t.dialog=this,null!=this.elements._buttonsDiv&&t.inject(this.elements._buttonsDiv),this.customButtonsDefinition[e].role&&(this.customButtonsDefinition[e].role===WUXCustomButtonRoleEnum.Validate?this.defaultButton=t:this.customButtonsDefinition[e].role===WUXCustomButtonRoleEnum.Escape&&(this.escapeButton=t))}0===this.elements._buttonsDiv.childNodes.length?this.elements._footerDiv.hide():this.elements._footerDiv.show(),this._applyMinWidth(),this._applyHeight()}},getCustomButtons:function(){if(this.customButtonsDefinition&&Array.isArray(this.customButtonsDefinition)&&(!this.buttons||0===Object.keys(this.buttons).length))return this._customButtons},_applyCheckboxInfos:function(){if(this.elements._footerDiv.removeAttribute("has-checkbox"),this.checkboxInfos&&this.checkboxInfos.label){if(this.elements._footerDiv.setAttributeNode(document.createAttribute("has-checkbox")),this.elements._checkbox){this.elements._checkbox.visibleFlag=!0,this.elements._checkbox.label=this.checkboxInfos.label,this.elements._checkbox.checkFlag=!!this.checkboxInfos.checkFlag;const e=this.checkboxInfos.tooltipInfos?this.checkboxInfos.tooltipInfos:{shortHelp:this.checkboxInfos.label};this.elements._checkbox.tooltipInfos=new s(e)}else{let t=this;this.elements._checkboxDiv=new e.Element("div",{class:"wux-windows-dialog-checkbox"}),this.elements._checkboxDiv.inject(this.elements._buttonsDiv,"before");const i=this.checkboxInfos.tooltipInfos?this.checkboxInfos.tooltipInfos:{shortHelp:this.checkboxInfos.label};this.elements._checkbox=new o({type:"checkbox",label:this.checkboxInfos.label,checkFlag:!!this.checkboxInfos.checkFlag,tooltipInfos:new s(i)}),this.elements._checkbox.addEventListener("change",function(e){t.checkboxInfos.checkFlag=t.elements._checkbox.checkFlag}),this.elements._checkbox.inject(this.elements._checkboxDiv)}this._applyMinWidth()}else this.elements._checkbox&&this.elements._checkbox.visibleFlag&&(this.elements._checkbox.visibleFlag=!1)},_applyMinWidth:function(){this._parent();var e=r.call(this);e>this.minWidth&&(this.minWidth=e)},_updateTitleMaxWidth:function(){var e=this.elements._titlebarButtonsDiv.clientWidth;this.elements._titleDiv.setStyle("max-width","calc(100% - "+e+"px)")},_applyModalFlag:function(){if(void 0!==this.elements.container){var t;this.isDirty("modalFlag");if(!0===this.modalFlag){if(this.elements.container.setAttributeNode(document.createAttribute("modal")),i=this.elements.container.parentNode)this.elements._modalDiv||(this.elements._modalDiv=new e.Element("div",{class:"wux-windows-modalDialog"})),i!==(t=this.elements._modalDiv)&&(i.removeChild(this.elements.container),t.appendChild(this.elements.container),i.dsModel&&void 0!==i.dsModel.rootContainer&&(i=i.dsModel.rootContainer),i.appendChild(t)),t.show()}else if(this.elements.container.removeAttribute("modal"),(t=this.elements._modalDiv)&&t.hasClassName("wux-windows-modalDialog")){if(this.immersiveFrame)this._moveToImmersiveFrame();else{var i,n=t.getParent();if(n)n.removeChild(t),(i=this.elements.container.parentNode)&&i.removeChild(this.elements.container),n.appendChild(this.elements.container)}t.destroy(),delete this.elements._modalDiv}else this._moveToImmersiveFrame()}},_moveToImmersiveFrame:function(){this.immersiveFrame&&!this.modalFlag?this.immersiveFrame.moveWindowToImmersiveFrame(this):this.modalFlag&&this.elements._modalDiv.appendChild(this.elements.container)},_applyVisibleFlag:function(e){if(!0===this.modalFlag){var t=this.elements._modalDiv;t&&(!1===this.visibleFlag?t.hide():t.show())}this._parent(e),!this.immersiveFrame&&!this._isBeingClosed&&this.visibleFlag&&this.elements&&this.elements.container&&!this.elements.container.parentNode&&this.inject(document.body)},_applyProperties:function(e){var t=this.isDirty("modalFlag");this._parent(e),this.isDirty("customButtonsDefinition")&&this._applyCustomButtonsDefinition(e.customButtonsDefinition),t&&this._applyModalFlag(),this.isDirty("resizableFlag")&&this._applyResizableFlag(),this.isDirty("checkboxInfos")&&this._applyCheckboxInfos()},_applyCurrentDockArea:function(e){this._parent(e);var t=this.elements._titleBarDiv.clientHeight;this.elements._buttonsDiv.childNodes.length>0&&(t+=this.elements._footerDiv.clientHeight),0!==t&&this.elements._mainCollapsibleContainer.setStyle("height","calc(100% - "+t+"px)")},_applyMaximizedFlag:function(e){this.immersiveFrame&&(this._updateFromCollapsibleState(),void 0!==e&&this.maximizedFlag!==e&&this.fire("prePlaceChange",{previousPlace:{maximizedFlag:e}}),this.maximizedFlag&&this.allowMaximizeFlag?(this.getContent().setAttributeNode(document.createAttribute("maximized")),this._updateMaximizeButtonIcon()):(this.getContent().removeAttribute("maximized"),this._updateMaximizeButtonIcon()),this._updateContentHeight(),void 0!==e&&this.maximizedFlag!==e&&(this._updateContentVisibleStateChange(),this.fire("placeChange"),this._fireAndBroadcast("resize,",{bubbles:!1})))},_getDefaultPosition:function(){return{my:"center",at:"center",of:this.immersiveFrame?this.immersiveFrame.getContent():document.body,constraint:this.immersiveFrame?this.immersiveFrame.getContent():document.body,offsetX:0,offsetY:0,collision:"fit"}}}),r=function(){if(this.buttons){let a=0,r=0;for(var e in this.buttons){var t=window.getComputedStyle(this.buttons[e].getContent())?window.getComputedStyle(this.buttons[e].getContent()).getPropertyValue("min-width"):"";t=""===t?0:parseInt(t,10);var i=window.getComputedStyle(this.buttons[e].getContent())?window.getComputedStyle(this.buttons[e].getContent()).getPropertyValue("margin-left"):"";i=""===i?0:parseInt(i,10);var n=window.getComputedStyle(this.buttons[e].getContent())?window.getComputedStyle(this.buttons[e].getContent()).getPropertyValue("margin-right"):"";a=a+t+i+(n=""===n?0:parseInt(n,10))}var o,s=0;return this.elements._footerDiv&&(o=window.getComputedStyle(this.elements._footerDiv)?window.getComputedStyle(this.elements._footerDiv).getPropertyValue("padding-left"):"",s=window.getComputedStyle(this.elements._footerDiv)?window.getComputedStyle(this.elements._footerDiv).getPropertyValue("padding-right"):"",o=""===o?0:parseInt(o,10),s=""===s?0:parseInt(s,10),this.checkboxInfos&&(r=80)),a=a+o+s+r}return 0};return a}),define("DS/Windows/DockingElementForImmersiveFrame",["UWA/Core","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Utils","DS/Windows/DockingElement"],function(e,t,i,n,o){"use strict";return o.inherit({buildView:function(){this._parent(),this.elements.dockingWithCollapserContainer.addClassName("wux-windows-docking-element-immersiveFrameStyle"),this.elements.dockingZoneMask.addClassName("wux-windows-docking-element-immersiveFrameStyle"),this.elements.expanderBar=new e.Element("div",{class:"wux-windows-docking-element-expanderBar"}).inject(this.elements.dockingZone,"before"),this.elements.collapseIconContainer=new e.Element("div",{class:"wux-windows-docking-element-collapse-icon-container"}).inject(this.elements.expanderBar),this.elements.collapseIcon=new e.Element("span",{class:"wux-ui-3ds wux-ui-3ds-1x wux-windows-docking-element-collapseIcon"}).inject(this.elements.collapseIconContainer),this.useBordersFlag=!1,this.useBackgroundFlag=!1},_applyCollapseDockingZoneFlag:function(e){this._updatePinIcon(),this._updateCollapserSize();var t=e?0:this.dockingZoneSize,i=this.collapseDockingZoneFlag?this._scrollBarSize:0,n=t+this._collapserSize+i;this.side&WUXDockAreaEnum.TopDockArea||this.side&WUXDockAreaEnum.BottomDockArea?this.elements.freeZone.setStyle("height","calc(100% - "+n+"px)"):(this.side&WUXDockAreaEnum.LeftDockArea||this.side&WUXDockAreaEnum.RightDockArea)&&this.elements.freeZone.setStyle("width","calc(100% - "+n+"px)"),(this.side&WUXDockAreaEnum.LeftDockArea||this.side&WUXDockAreaEnum.RightDockArea)&&(e?this.elements.dockingWithCollapserContainer.setStyle("width",this._collapserSize+"px"):this.elements.dockingWithCollapserContainer.setStyle("width",this.dockingZoneSize+this._collapserSize+this._scrollBarSize+"px"));this.elements.freeZone.getStyle("height");this._parent()},handleEvents:function(){var e=this;this._parent(),this.elements.expanderBar.addEventListener("click",function(t){e._manageAutoCollapse(),e._updatePinIcon()}),this.elements.collapser.addEventListener("click",function(t){e._updatePinIcon()})},_updateContainedWindows:function(){if(this.side===WUXDockAreaEnum.BottomDockArea||this.side===WUXDockAreaEnum.TopDockArea){var e=null,t=this.getContainedVisibleWindows();1===t.length&&(e=t[0]),e&&(e._moveTitleBar(!0,this),e._updateTitleBarWidth());for(var i=this.getContainedWindows(),n=0;n<i.length;n++){var o=i[n];o&&o!==e&&(o._moveTitleBar(!1,this),o._updateTitleBarWidth())}}this._parent()},_updateFromContainedWindows:function(){var e="left";this.side===WUXDockAreaEnum.BottomDockArea&&(1===this.getContainedVisibleWindows().length&&(e="center"));this.alignment=e,this._parent()},_updateCollapserSize:function(){this.collapsibleFlag&&this.visibleDockingZoneFlag&&this.collapseDockingZoneFlag&&0!==this.getContainedVisibleWindows().length?(this._collapserSize=20,this.elements.collapser.removeClassName(this._hideClassName)):(this._collapserSize=0,this.elements.collapser.addClassName(this._hideClassName))},_updatePinIcon:function(){this.collapseDockingZoneFlag||this._collapseHoverFlag?(this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-left"),this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-up"),this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-down"),this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-right"),this.elements.collapseIcon.addClassName("wux-ui-3ds-pin")):(this.elements.collapseIcon.removeClassName("wux-ui-3ds-pin"),this.side&WUXDockAreaEnum.RightDockArea?(this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-left"),this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-up"),this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-down"),this.elements.collapseIcon.addClassName("wux-ui-3ds-open-right")):this.side&WUXDockAreaEnum.BottomDockArea?(this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-right"),this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-left"),this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-up"),this.elements.collapseIcon.addClassName("wux-ui-3ds-open-down")):this.side&WUXDockAreaEnum.LeftDockArea?(this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-right"),this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-up"),this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-down"),this.elements.collapseIcon.addClassName("wux-ui-3ds-open-left")):this.side&WUXDockAreaEnum.TopDockArea&&(this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-right"),this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-left"),this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-down"),this.elements.collapseIcon.addClassName("wux-ui-3ds-open-up")))},_pointerEventsAllIfOverflow:function(){this.elements&&this.elements.dockingZone&&(this._hasScrollbar()?(this.elements.dockingZone.setStyle("pointer-events","all"),this.elements.dockingZoneMask.removeClassName("wux-windows-docking-element-has-background")):this.side&WUXDockAreaEnum.TopDockArea?(this.elements.dockingZoneMask.addClassName("wux-windows-docking-element-has-background"),this.elements.dockingZone.setStyle("pointer-events","")):(this.elements.dockingZoneMask.removeClassName("wux-windows-docking-element-has-background"),this.elements.dockingZone.setStyle("pointer-events","")),this._resetInteractiveDockArea())},_getStretchSize:function(){return this.side===WUXDockAreaEnum.TopDockArea||this.side==WUXDockAreaEnum.BottomDockArea?parseInt(window.getComputedStyle(this.elements.dockingZoneMask).width)-parseInt(window.getComputedStyle(this.elements.expanderBar).width)-1:parseInt(window.getComputedStyle(this.elements.dockingZoneMask).height)-parseInt(window.getComputedStyle(this.elements.expanderBar).height)-1}})}),define("DS/Windows/WindowGroup",["UWA/Core","UWA/Array","DS/Windows/Window","DS/Controls/Tab","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Utilities/Utils"],function(e,t,i,n,o,s,a){"use strict";var r;Object.defineProperty(Array.prototype,"inter",{enumerable:!1,writable:!0,value:function(e){for(var t=[],i=this.concat(e),n=0;n<i.length;n++){var o=i[n];-1!=e.indexOf(o)&&-1!=this.indexOf(o)||t.push(o)}return t}}),r=i.inherit({publishedProperties:{groupType:{defaultValue:WUXWindowGroupTypeEnum.GroupAsTab,readOnly:!0},currentWindows:{defaultValue:[]},width:{defaultValue:-1,type:"integer",category:"Appearance"},height:{defaultValue:-1,type:"integer",category:"Appearance"}},_computedIdentifier:"",buildView:function(){this._parent(),this.elements.container.addClassName("wux-windows-windowgroup"),this.elements._contentDiv.addClassName("wux-windows-windowgroup-content"),this.elements._tabBarContainer=new e.Element("div",{class:"wux-windows-windowgroup-tab-bar-container"}),this.elements._tabBarContainer.inject(this.elements._titleDiv,"before"),this.elements._titleDiv.hide(),this.elements._draggableZoneDiv=new e.Element("div",{class:"wux-windows-windowgroup-draggable-zone"}),this.elements._draggableZoneDiv.inject(this.elements._titleP,"before"),this._tab=new n({tabBarDOMContainer:this.elements._tabBarContainer,tabPanelContainer:this.elements._contentDiv,multiSelFlag:!0,displayStyle:["panel","wide"],showComboBoxFlag:!0,autoCloseFlag:!1,reorderFlag:!1}),this._tab.tabBar.pinFlag=!0,this._tab.tabBar.centeredFlag=!1,this._tab.tabBar.closeButtonFlag=this.closeButtonFlag,this.allowedDockAreas=WUXDockAreaEnum.TopDockArea|WUXDockAreaEnum.BottomDockArea|WUXDockAreaEnum.LeftDockArea|WUXDockAreaEnum.RightDockArea},destroy:function(){var e=this.getEmbeddedWindows();if(e.length>0)for(var t=0;t<e.length;t++)e[t].destroy();else this._tab&&(this._tab.destroy(),this._tab=void 0),this._parent()},_applyTouchMode:function(){this._parent(),this._postEditTouchMode()},_postEditTouchMode:function(){this._parent();var e=this._getCurrentTouchMode();this._tab&&(this._tab.touchMode=e),this._updateMaxTabbarWidth()},_applyCurrentWindows:function(t){var i=[],n=[],o=this._tab.tabBar.pinnedList;if(o&&(n=this._tab.getIndexesFromValues(o)),null!=this.currentWindows&&0!==this.currentWindows.length){if(this.currentWindows.length>=1)for(var s=0;s<this.currentWindows.length;s++){var a=this._getIndexFromWindow(this.currentWindows[s]),r=this._tab.getPageValueFromIndex(a);if(n.length>0){for(var l=!0,d=0;d<n.length;d++)a==n[d]&&(l=!1);(l||-1!=this._tab.tabBar.value.indexOf(r))&&i.push(r)}else i.push(r)}e.equals(this._tab.value,i)||(this._tab.value=i)}if(this._updateResizableFlag(),this._updateWidthAndHeight(),this._updateMinWidth(),this._updateMinHeight(),this._updateMovableFlag(),this._tab.tabBar._slideToValue(),t)for(d=0;d<t.length;d++){var h=t[d];h&&-1==this.currentWindows.indexOf(h)&&h.windowGroup===this&&(h.activeFlag=!1)}if(this._updateCurrentWindowsActiveFlag(),this.currentDockArea!=WUXDockAreaEnum.NoneDockArea){var c=this.immersiveFrame?this.immersiveFrame.getDockingElement(this.currentDockArea):null;c&&(c._pointerEventsAllIfOverflow(),c._updateDockingZoneSize())}},_updateCurrentWindowsActiveFlag:function(){var e=this.getEmbeddedWindows();if(e)for(var t=0;t<e.length;t++){var i=e[t];i&&this.currentWindows&&-1!=this.currentWindows.indexOf(i)?i.activeFlag=this.activeFlag:i&&(i.activeFlag=!1)}},_applyActiveFlag:function(){this._parent(),this._updateCurrentWindowsActiveFlag()},_applyImmersiveFrame:function(e){this._parent(e);for(var t=this.immersiveFrame,i=this.getEmbeddedWindows(),n=0;n<i.length;n++){var o=i[n];o&&(o.immersiveFrame=t)}},_applyCurrentDockArea:function(e){var t=this.currentDockArea;t===WUXDockAreaEnum.BottomDockArea||t===WUXDockAreaEnum.TopDockArea?this._setTabMultiSelLayout("horizontal"):this._setTabMultiSelLayout("vertical"),this._parent(e);for(var i=this.getEmbeddedWindows(),n=0;n<i.length;n++){var o=i[n];o&&(o.currentDockArea=t)}this._updateWidthAndHeight(),this._updateMinWidth(),this._tab.tabBar.redrawTabBar()},_applyRecId:function(e){this._parent(e),void 0!==this.recId&&null!==this.recId&&(this._tab.recId=this.recId+"_Tab")},_applyMinWidth:function(e){if(this._parent(e),this.currentDockArea===WUXDockAreaEnum.BottomDockArea&&this._tab&&this._tab.tabBar&&this._tab.tabBar.centeredFlag){var t=this.minWidth;void 0!==t?this.elements._mainContentDiv.setStyle("min-width",t+"px"):this.elements._mainContentDiv.setStyle("min-width","")}else this.elements._mainContentDiv.setStyle("min-width","")},_applyWidth:function(e){null!==this.width&&(this._updateMaxWidth(),-1===this.width?(this.getContent().setStyle("width","auto"),this.elements._mainContentDiv.setStyle("width","auto"),this.currentDockArea===WUXDockAreaEnum.NoneDockArea||this.currentDockArea===WUXDockAreaEnum.TopDockArea||(this.currentDockArea,WUXDockAreaEnum.BottomDockArea),this.elements._footerDiv&&this.elements._footerDiv.setStyle("width","calc(100% - 10px)")):void 0!==this.minWidth&&(this.width>=this.minWidth?(l.call(this,this.width),this.elements._mainContentDiv.setStyle("width",this.width+"px")):this.width=this.minWidth),e&&this.width!==e&&this._fireAndBroadcast("resize",{bubbles:!1})),this._tab.tabBar.redrawTabBar(),this._updateTitleBarWidth()},_applyHeight:function(e){this._updateMaxHeight(),null!==this.height&&(-1===this.height?(this.elements._mainContentDiv.setStyle("height",""),this._updateContentHeight()):(this.height>=this.minHeight?(d.call(this,this.height),this._updateContentHeight()):this.height=this.minHeight,e&&this.height!==e&&this.fire("resize",{bubbles:!1})))},_applyMaximizedFlag:function(e){if(this._parent(e),this.currentWindows)for(var t=0;t<this.getEmbeddedWindows().length;t++){this.getEmbeddedWindows()[t].maximizedFlag=this.maximizedFlag}this._updateTabCloseButtons()},_applyCloseButtonFlag:function(){this._parent(),this._updateMaxTabbarWidth()},_applyMaximizeButtonFlag:function(){this._parent(),this._updateMaxTabbarWidth()},_applyAllowMaximizeFlag:function(){this._parent(),this._updateMaxTabbarWidth()},_updateWidthAndHeight:function(){if(this.currentWindows.length>0)if(this._updateResizableFlag(),"horizontal"!==this._getTabMultiSelLayout()){for(var e=this.currentWindows[0].width,t=-1===this.currentWindows[0].height,i=t?parseInt(window.getComputedStyle(this.currentWindows[0].getContent()).height):this.currentWindows[0].height,n=1;n<this.currentWindows.length;n++){-1!==(r=this.currentWindows[n]).width&&(e=e>r.width?e:r.width),-1===r.height?i=i+parseInt(window.getComputedStyle(r.getContent()).height)+1:(t=!1,i=i+r.height+1)}this.width!==e?this.width=e:this._applyWidth(),t?this.height=-1:i&&this.height!==i?this.height=i:this._applyHeight()}else{var o=this.currentWindows[0].height,s=-1===this.currentWindows[0].width,a=s?parseInt(window.getComputedStyle(this.currentWindows[0].getContent()).width):this.currentWindows[0].width;for(n=1;n<this.currentWindows.length;n++){var r;!1!==(r=this.currentWindows[n]).resizableFlag&&"horizontal"!==r.resizableFlag||(o=o>r.height?o:this.currentWindows[n].height),-1===r.width?a=a+parseInt(window.getComputedStyle(r.getContent()).width)+1:(s=!1,a=a+r.width+1)}s?this.width=-1:a&&this.width!==a?this.width=a:this._applyWidth(),o&&this.height!==o?this.height=o:this._applyHeight()}},_updateMaxTabbarWidth:function(){var e=0;this.closeButtonFlag&&e++,this.maximizeButtonFlag&&this.allowMaximizeFlag&&e++;var t=24;if(this.touchMode&&(t=36),this._tab.tabBar.centeredFlag){var i="100%",n=this.immersiveFrame.getDockingElement(this.currentDockArea);n&&(i=n._getFixedAreaWidth()-t+"px"),this.elements._tabBarContainer.setStyle("max-width",i)}else this.elements._tabBarContainer.setStyle("max-width","calc(100% - "+t*(e+1)+"px)")},_applyProperties:function(e){this._parent(e),this.isDirty("currentWindows")&&this._applyCurrentWindows(e.currentWindows),this._postEditTouchMode()},_setTitleBarCenteredFlag:function(e){this._parent(e),this._tab&&this._tab.tabBar&&(this._tab.tabBar.centeredFlag=e),this.elements._draggableZoneDiv&&(e?this.elements._draggableZoneDiv.hide():this.elements._draggableZoneDiv.show())},_computeDropInsertionData:function(e){var t=-1,i="after",n=-1,o=this._tab.tabBar._getVisibleTabButtons(),s=this.elements._titleBarDiv.getBoundingClientRect().left,a=s;if(this._tab.tabBar.showComboBoxFlag&&this._tab.tabBar.tabComboBox&&this._tab.tabBar.tabComboBox.visibleFlag){var r=this._tab.tabBar.tabComboBox.getContent().getBoundingClientRect().right;if(e.x>r)return{movedWindowNewIndex:t,targetWindow:this._getWindowFromIndex(this.getEmbeddedWindows().length-1),beforeOrAfter:i,stopWindowGroupTabBarSliding:!0}}for(var l=0;l<o.length;l++){var d=this._tab.tabBar.getButtonFromValue(this._tab.getPageValueFromIndex(l)),h=d.getContent().getBoundingClientRect().left,c=d.getContent().getBoundingClientRect().right,m=0;if(!(c<=s)){if(m=h<=s?Math.abs(c-s):this._tab.tabBar.getWidthOfButton(d),e.x<a+m/2){t=l,n=l,i="before";break}if(e.x<a+m){t=l+1<o.length?l+1:l,n=l,i="after";break}a+=m}}return{movedWindowNewIndex:t,targetWindow:-1!=n?this._getWindowFromIndex(n):this._getWindowFromIndex(this.getEmbeddedWindows().length-1),beforeOrAfter:i}},getCollapsibleState:function(){for(var e=0;e<this.currentWindows.length;e++)if(!this.currentWindows[e].collapsibleFlag)return!1;return this.groupType===WUXWindowGroupTypeEnum.GroupAsTab&&this.currentDockArea!==WUXDockAreaEnum.TopDockArea&&this.currentDockArea!==WUXDockAreaEnum.BottomDockArea},getFloatableState:function(){for(var e=!0,t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];if(n&&!(e=n.getFloatableState()))break}return e},getEmbeddedWindows:function(){var e=[];if(this._tab)for(var t=this._tab.getPageCount(),i=0;i<t;i++){var n=this._getWindowFromIndex(i);e.push(n)}return e},getVisibleEmbeddedWindows:function(){for(var e=[],t=this._tab.getPageCount(),i=0;i<t;i++){var n=this._getWindowFromIndex(i);n.visibleFlag&&e.push(n)}return e},containsWindow:function(e){var t=!1;if(e)for(var i=this.getEmbeddedWindows(),n=i.length;n--;){if(i[n]===e){t=!0;break}}return t},attachWindow:function(e,t,i){var n=-1;return e&&this.groupType===WUXWindowGroupTypeEnum.GroupAsTab&&(n=this._stackWindowNextTo(e,t,i,void 0)),n},_stackWindowNextTo:function(e,t,i,n,a){var r=this;var l=-1;if(e&&this.groupType===WUXWindowGroupTypeEnum.GroupAsTab){if(this.containsWindow(e))return l;if(e&&e.isAWindowGroup()&&e.groupType===WUXWindowGroupTypeEnum.GroupAsTab){var d=e.getEmbeddedWindows();for(var h in l=1,d){l=-1===d[h]._attachToWindow(t,i,n,a)?-1:l}return l}if(e&&e._canBeSnapSource(t,i)&&e!==t&&(!t||i===WUXSnapAreaEnum.InsideArea&&t._canBeSnapTarget(e,i))){var c=e.activeFlag;if(t?l=t===this?1:this.containsWindow(t)?1:-1:0===this.getEmbeddedWindows().length&&(l=1),l<0)return l;var m=e.windowGroup;if(m){if(m===this&&this.containsWindow(e))return 1;var u=!1,g=m.getAbsolutePosition();if(!t&&m.groupType===WUXWindowGroupTypeEnum.GroupAsGrid){if((l=m._attachToWindow(this,e,WUXSnapAreaEnum.BottomArea,n,a))<0)return l;u=!0}m.detachWindow(e);u&&m.setAbsolutePosition(g)}t&&e.getDockedFlag()&&(e.currentDockArea=WUXDockAreaEnum.NoneDockArea),e.expandedFlag=!0,!0!==e.resizableFlag&&"true"!==e.resizableFlag&&"vertical"!==e.resizableFlag&&"horizontal"!==e.resizableFlag||i===WUXSnapAreaEnum.InsideArea&&(!0!==e.resizableFlag&&"true"!==e.resizableFlag&&"horizontal"!==e.resizableFlag||(e.width=this._getMonoSelectionWidth()),!0!==e.resizableFlag&&"true"!==e.resizableFlag&&"vertical"!==e.resizableFlag||(t.currentDockArea!==WUXDockAreaEnum.RightDockArea&&t.currentDockArea!==WUXDockAreaEnum.LeftDockArea||!t.verticallyStretchableFlag)&&(-1===t.height?e.height=t.elements._mainContentDiv.clientHeight:e.height=t.height)),e.setPropertyFromUIInteraction("maximizedFlag",this.maximizedFlag),!t&&e.getDockedFlag()&&(this.setPropertyFromUIInteraction("currentDockArea",e.currentDockArea),this.inject(e.getContent(),"before"));var p,f=e.getAbsolutePosition();if(e.remove(),n){var w=this.getEmbeddedWindows();if(-1!==w.indexOf(t)){var v=w.indexOf(t);"before"===n?p=v:"after"===n&&(p=v+1)}}this._tab.addTab(e.title,e.getContent(),p,!0,void 0,e.icon,e.closeButtonFlag,e.showTitleFlag||!e.icon),e.windowGroup=this,this._updateRecId();var _=this._tab.tabBar.getButtonFromValue(this._tab.value[0]);_&&s.addEventOnElement(this,_,o.POINTERDOWN,function(t){e._onDragPointerDown(t);var i=t.dsModel,n=r._getWindowFromIndex(r._tab.getPageIndexFromValue(i.value));e.addEventListener("stopWindowDrag",function(){i&&n&&!r.containsWindow(n)&&(i.destroy(),0===r.getEmbeddedWindows().length&&r.destroy())})}),this.getDockedFlag()?e.currentDockArea=this.currentDockArea:t||e.getDockedFlag()&&(this.currentDockArea=e.currentDockArea),t||this.setAbsolutePosition(f),this._updateVisibleState(),this._updateTitle(),this._updateCloseButtonFlag(),this._updateAllowedDockAreas(),this._updateResizableFlag(),this._updateMaximizedState(),this._postEditTouchMode(),this._updateTabCloseButtons(),this._updateMaximizeButtonFlag(),this._updateAllowMaximizeFlag(),e.visibleFlag||this._setWindowVisibility(e,e.visibleFlag),(this.activeFlag||c)&&(this.activeFlag=!0,this._updateCurrentWindows())}}return this._updateComputedIdentifier(),l},detachWindow:function(e){return this._detachWindow(e,!1)},_detachWindow:function(e,t){var i=-1;if(e){if(!this.containsWindow(e))return i;if(this.groupType===WUXWindowGroupTypeEnum.GroupAsTab){this.currentWindows.length;var n=this.getAbsolutePosition();i=1;var o=this.activeFlag;this.activeFlag=!1,e.getContent().hide();var s=2===this.getEmbeddedWindows().length?this.getEmbeddedWindows()[0]===e?this.getEmbeddedWindows()[1]:this.getEmbeddedWindows()[0]:this;t&&1!==this.getEmbeddedWindows().length?this._tab.removeTab(e.getContent(),!0):this._tab.removeTab(e.getContent(),!1),e.windowGroup===this&&(e.windowGroup=null),t&&e._saveWindowGroupInPreferences(s),e._isBeingClosed||(this.immersiveFrame&&(e.getDockedFlag()?1===this.getEmbeddedWindows().length?this.immersiveFrame.dockWindow(e,e.currentDockArea):(e.currentDockArea=WUXDockAreaEnum.NoneDockArea,this.immersiveFrame.moveWindowToImmersiveFrame(e)):this.immersiveFrame.moveWindowToImmersiveFrame(e)),e.visibleFlag&&e.getContent().show(),e._updateFromEmbeddedState());var a=this.getEmbeddedWindows();if(0===a.length){var r=this.windowGroup;if(r&&!e._isBeingClosed?(n=r.getAbsolutePosition(),i=r.attachWindow(e,this,WUXSnapAreaEnum.BottomArea)):this.immersiveFrame&&(this.immersiveFrame.dockWindow(e,this.currentDockArea),e.inject(this.getContent(),"before")),t?this.visibleFlag=!1:this.destroy(),r)return r.setAbsolutePosition(n),i}else{if(this._updateVisibleState(),this._updateCloseButtonFlag(),this._updateMaximizeButtonFlag(),this._updateAllowMaximizeFlag(),this._applyResizableFlag(),1===a.length){s=a[0];this._detachWindow(s,t),s.maximizedFlag=this.maximizedFlag}a.length>=1&&(e.maximizedFlag=!1)}o&&(e.activeFlag=!0),e.setAbsolutePosition(n),e._applyWidth(),e._applyHeight(),a.length>1&&(this._updateTitle(),this._updateAllowedDockAreas(),this._updateMovableFlag())}}return this._updateComputedIdentifier(),this._updateRecId(),i},_createWindowGroup:function(e){return new r({groupType:e,immersiveFrame:this.immersiveFrame})},_canBeSnapSource:function(e,t){for(var i=!0,n=this.getEmbeddedWindows(),o=0;o<n.length;o++){var s=n[o];if(s&&!(i=s._canBeSnapSource(e,t)))break}return i},_canBeSnapTarget:function(e,t){for(var i=!0,n=this.getEmbeddedWindows(),o=0;o<n.length;o++){var s=n[o];if(s&&!(i=s._canBeSnapTarget(e,t)))break}return i},attachToWindow:function(e,t){var i=-1;if(e&&t!==WUXSnapAreaEnum.NoneArea&&t!==WUXSnapAreaEnum.OutsideArea&&this._canBeSnapSource(e,t)&&e._canBeSnapTarget(this,t)&&this.groupType===WUXWindowGroupTypeEnum.GroupAsTab)if(i=1,t===WUXSnapAreaEnum.InsideArea){for(var n=this.currentWindows.slice(),o=this.getEmbeddedWindows(),s=0;s<o.length;s++){var a=o[s];if(a){var l=a.attachToWindow(e,t);l<0&&(i=l)}}e instanceof r?e.currentWindows=n:e.windowGroup&&(e.windowGroup.currentWindows=n)}else i=this._parent(e,t);return i},_pinOrUnpinWindow:function(e){if(e&&-1!==this.getEmbeddedWindows().indexOf(e)){var t=this._tab.getPageValueFromIndex(this._getIndexFromWindow(e));this._tab.tabBar.pinTab(t)}},_setTabMultiSelLayout:function(e){this._tab.multiSelLayout=e},_getTabMultiSelLayout:function(){return this._tab.multiSelLayout},_fireAndBroadcast:function(e,t){this._parent(e,t);for(var i=this.currentWindows,n=0;n<i.length;n++){var o=i[n];o&&o._fireAndBroadcast(e,t)}},_updateTitle:function(){for(var e="",t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];if(n){if(0===i?e="[":e+=", ",e+=n.title,i===t.length-1)e+="]";else if(5===i){e+=", ...]";break}var o=this._tab.getPageValueFromIndex(this._getIndexFromWindow(n));this._tab.getOptionFromButton("label",o)!==n.title&&this._tab.setOptionFromButton("label",n.title,o),this._tab.getOptionFromButton("icon",o)!==n.icon&&this._tab.setOptionFromButton("icon",n.icon,o)}}this.title=e},_updateVisibleState:function(){for(var e=!1,t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];n&&n.visibleFlag&&(e=!0)}this.visibleFlag=e},_updateContentVisibleStateChange:function(){this._parent();for(var e=this.currentWindows,t=0;t<e.length;t++){e[t]._updateContentVisibleStateChange()}},_updateCloseButtonFlag:function(){for(var e=!1,t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];if(n&&n.closeButtonFlag){e=!0;break}}this.closeButtonFlag=e,this.maximizedFlag&&this._updateTabCloseButtons()},_updateTabCloseButtons:function(){for(var e=this.getEmbeddedWindows(),t=0;t<e.length;t++){var i=e[t];i&&this.maximizedFlag?this._tab.tabBar.setAllowClosableFlagOnValue(this._tab.getPageValueFromIndex(this._getIndexFromWindow(i)),i.closeButtonFlag):this._tab.tabBar.setAllowClosableFlagOnValue(this._tab.getPageValueFromIndex(this._getIndexFromWindow(i)),!1)}},_updateMaximizeButtonFlag:function(){var e=!0;if(this.allowMaximizeFlag)for(var t=this._getCurrentAndPinnedWindows(),i=0;i<t.length;i++){var n=t[i];if(n&&(!n.maximizeButtonFlag||!n.allowMaximizeFlag)){e=!1;break}}else e=!1;this.maximizeButtonFlag=e},_updateAllowMaximizeFlag:function(){for(var e=this.getEmbeddedWindows(),t=0;t<e.length;t++){var i=e[t];if(i&&!i.allowMaximizeFlag)return void(this.allowMaximizeFlag=!1)}this.allowMaximizeFlag=!0},_updateAllowedDockAreas:function(){for(var e=WUXDockAreaEnum.LeftDockArea+WUXDockAreaEnum.TopDockArea+WUXDockAreaEnum.RightDockArea+WUXDockAreaEnum.BottomDockArea,t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];if(n)for(var o in WUXDockAreaEnum){var s=WUXDockAreaEnum[o];if(!(n.allowedDockAreas&s)&&e&s&&0===(e-=s))break}}this.allowedDockAreas=e},_updateRecId:function(){for(var e="WindowGroup_",t=e,i=this.getEmbeddedWindows(),n=0;n<i.length;n++){var o=i[n];o&&o.recId&&(t!==e&&(t+=";"),t+=o.recId)}t!==e&&(this.recId=t)},_onCloseButtonClick:function(e){var t=this.getVisibleEmbeddedWindows();if(t)for(var i=t.length-1;i>=0;i--){var n=t[i];n&&n.closeButtonFlag&&(n.disabled||n.callMethodFromUIInteraction("close"))}},_updateComputedIdentifier:function(){for(var e="[",t=this.getEmbeddedWindows(),i=0;i<t.length;i++)0!==i&&(e+=";"),e+=t[i].identifier;e+="]",this._computedIdentifier=e},_updateMaximizedState:function(){for(var e=!1,t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];if(n&&n.maximizedFlag){e=!0;break}}this.maximizedFlag=e},_updateResizableFlag:function(){var e=!1,t=this.currentWindows;if(1!==t.length){for(var i="horizontal"!==this._getTabMultiSelLayout(),n=0;n<t.length;n++){var o=t[n];if(o){if(i&&(!0===o.resizableFlag||"true"===o.resizableFlag||"horizontal"===o.resizableFlag)){e="horizontal";break}if(!i&&(!0===o.resizableFlag||"true"===o.resizableFlag||"horizontal"===o.resizableFlag)){e="vertical";break}}}this.resizableFlag=e}else this.resizableFlag=this.currentWindows[0].resizableFlag},_updateMinWidth:function(){if(this.currentWindows&&this.currentWindows.length>0&&this.immersiveFrame&&this.immersiveFrame.isInsertedInDOM()){var e,t=0;if((this.currentDockArea===WUXDockAreaEnum.BottomDockArea||this.currentDockArea===WUXDockAreaEnum.TopDockArea)&&this._tab&&this._tab.tabBar){var i;if(this._tab.tabBar.centeredFlag)i=parseInt(window.getComputedStyle(this.elements._tabBarContainer).width)+2;else{i=this._tab.tabBar.getWidthOfAllVisibleButtons(),this._tab.tabBar._applyInheritWidthToButtons();var n=parseInt(window.getComputedStyle(this.elements._titleBarDiv).width),o=parseInt(window.getComputedStyle(this.elements._tabBarContainer).width);isNaN(n)||isNaN(o)||(i=i+n-o)}if(t=i,this.immersiveFrame){var s=this.immersiveFrame.getDockingElement(this.currentDockArea)._getStretchSize();t>s&&(t=s-1)}}for(var a=0;a<this.currentWindows.length;a++)(e=this.currentWindows[a])&&-1!=e.width&&t<e.minWidth&&(t=e.minWidth);t=parseInt(t),this.minWidth=t}},_updateMinHeight:function(){if(this.currentWindows&&this.currentWindows.length>0){for(var e,t=this.currentWindows[0].minHeight,i=0;i<this.currentWindows.length;i++)(e=this.currentWindows[i])&&t<e.minHeight&&(t=e.minHeight);this.minHeight=t}},_updateMovableFlag:function(){for(var e=!0,t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];if(n&&!n.movableFlag){e=!1;break}}this.movableFlag=e},_getMonoSelectionWidth:function(){var e=this._getCurrentAndPinnedWindows();if(1===e.length)return-1===this.width?parseInt(window.getComputedStyle(e[0].getContent()).width):this.width;if(e.length>1){for(var t=0;t<e.length;t++){var i=e[t];if(-1!==i.width)return i.width}return parseInt(window.getComputedStyle(e[0].getContent()).width)}},_getCurrentAndPinnedWindows:function(){for(var e=this._tab.value,t=[],i=this._tab.getIndexesFromValues(e),n=0;n<i.length;n++){var o=i[n];if(o>=0)(r=this._getWindowFromIndex(o))&&t.push(r)}var s=this._tab.tabBar.pinnedList;if(s){var a=this._tab.getIndexesFromValues(s);for(n=0;n<a.length;n++){var r,l=a[n];if(l>=0&&-1==i.indexOf(l))(r=this._getWindowFromIndex(l))&&t.push(r)}}return t},_updateCurrentWindows:function(){var e=this._getCurrentAndPinnedWindows();this._updateHorizontallyStretchableFlag(),this._updateVerticallyStretchableFlag();var t=this.currentWindows.inter(e);this.currentWindows=e;for(var i=0;i<t.length;i++){t[i]._updateContentVisibleStateChange()}this._applyPosition()},_updateHorizontallyStretchableFlag:function(){for(var e=this._getCurrentAndPinnedWindows(),t=!1,i=0;i<e.length;i++)if(e[i]&&!0===e[i].horizontallyStretchableFlag){t=!0;break}this.horizontallyStretchableFlag=t},_updateVerticallyStretchableFlag:function(){for(var e=this._getCurrentAndPinnedWindows(),t=!1,i=0;i<e.length;i++)if(e[i]&&!0===e[i].verticallyStretchableFlag){t=!0;break}this.verticallyStretchableFlag=t},_getWindowFromIndex:function(e){var t=this._tab.getPageContentFromIndex(e);return t&&t.dsModel?t.dsModel:t},_getIndexFromWindow:function(e){return this._tab.getIndexOf(e.getContent())},_setWindowVisibility:function(e){var t=e.visibleFlag;if(this._tab._setTabVisibility(this._tab.getPageValueFromIndex(this._getIndexFromWindow(e)),t),t)t&&0===this.currentWindows.length&&(this.currentWindows=[e]);else if(-1!==this.currentWindows.indexOf(e)&&this.currentWindows.splice(this.currentWindows.indexOf(e),1),0===this.currentWindows.length)for(var i=this.getEmbeddedWindows(),n=0;n<i.length;n++){var o=i[n];if(o.visibleFlag){this.currentWindows=[o];break}}this._updateVisibleState()},_manageReorder:function(e,t){var i=this._getIndexFromWindow(e);if(this._tab.tabBar.showComboBoxFlag&&this._tab.tabBar.tabComboBox&&this._tab.tabBar.tabComboBox.visibleFlag){if(!a.isMouseOverElement(this._tab.tabBar.buttonGroup.getContent(),t))return void this.immersiveFrame._stopWindowGroupTabBarSliding();var n=this.elements._titleBarDiv.getBoundingClientRect().left,o=this._tab.tabBar.buttonGroup.getContent().getBoundingClientRect().right;Math.abs(t.x-n)<=7?this.immersiveFrame._startWindowGroupTabBarSliding(this._tab.tabBar,"left"):Math.abs(t.x-o)<=7?this.immersiveFrame._startWindowGroupTabBarSliding(this._tab.tabBar,"right"):this.immersiveFrame._stopWindowGroupTabBarSliding()}var s=this._computeDropInsertionData(t);s.stopWindowGroupTabBarSliding&&this.immersiveFrame._stopWindowGroupTabBarSliding(),i!==s.movedWindowNewIndex&&(this._tab.tabBar._exchangeTabs(this._tab.getPageValueFromIndex(i),this._tab.getPageValueFromIndex(s.movedWindowNewIndex)),this._tab.tabBar._slideToValue())},close:function(){if(this.autoCloseFlag){var e=this.activeFlag,t=this.getEmbeddedWindows();if(t)for(var i=t.length-1;i>=0;i--){var n=t[i];n&&n.close()}(t=this.getEmbeddedWindows())&&t.length>1&&e&&(this.activeFlag=!0)}else this.fire("close")},_saveDockAreaInPreferences:function(){for(var e=0;e<this.getEmbeddedWindows().length;e++){this.getEmbeddedWindows()[e]._saveDockAreaInPreferences()}},_saveMaximizeInPreferences:function(){for(var e=0;e<this.getEmbeddedWindows().length;e++){this.getEmbeddedWindows()[e]._saveMaximizeInPreferences()}},_savePositionInPreferences:function(){for(var e=0;e<this.getEmbeddedWindows().length;e++){this.getEmbeddedWindows()[e]._savePositionInPreferences()}},_saveDimensionsInPreferences:function(){for(var e=0;e<this.getEmbeddedWindows().length;e++){this.getEmbeddedWindows()[e]._saveDimensionsInPreferences()}},_saveDockedDimensionsInPreferences:function(){for(var e=0;e<this.getVisibleEmbeddedWindows().length;e++){this.getVisibleEmbeddedWindows()[e]._saveDockedDimensionsInPreferences()}},_getDockedDimensionsFromPreferences:function(){for(var e={},t=0;t<this.getVisibleEmbeddedWindows().length;t++){var i=this.getVisibleEmbeddedWindows()[t]._getDockedDimensionsFromPreferences();if(i&&(!e.width&&i.width&&(e.width=i.width),!e.height&&i.height&&(e.height=i.height),e.width&&e.height))break}return e},handleEvents:function(){this._parent();var e=this;this._tab.tabBar.addEventListener("pinStateChange",function(t){var i=e._getWindowFromIndex(e._tab.getPageIndexFromValue(t.options.value));i&&void 0!==t.options.pinnedFlag?(i._properties.pinnedFlag.value=t.options.pinnedFlag,void 0!==i.identifier&&i._savePinnedFlagInPreferences()):console.log(t)}),this._tab.addEventListener("change",function(t){e._applyPosition(),e._updateCurrentWindows()}),this._tab.tabBar.onRemoveTabEvent(function(t){e._getWindowFromIndex(t.index).close()}),this._tab.tabBar.onPinTab(function(t){e._updateCurrentWindows()}),this._tab.tabBar.onUnpinTab(function(t){e._updateCurrentWindows()}),this.elements._contentDiv.addEventListener("placeChange",function(e){}),this.addEventListener("move",function(t){e._tab.tabBar.tabComboBox._hidePopup()})},_buildOrDelagateContextualMenu:function(e){var t=[];if(e&&e.infos&&e.infos.target){var i=this._firstParentWithClass(e.infos.target,"wux-controls-button"),n=i?i.dsModel:void 0,o=n?n.value:this.currentWindows&&this.currentWindows.length>0?this._getIndexFromWindow(this.currentWindows[0]):0,s=this._getWindowFromIndex(this._tab.getPageIndexFromValue(o));e.isGroupTarget=!n,s&&(t=s.onContextualEvent(e))}return t},_getMenuToAddData:function(e,t){var i,n=!1,o=!1;if(t.infos&&t.infos.target){var s=this._firstParentWithClass(t.infos.target,"wux-controls-button");i=s?s.dsModel:void 0,"close"===e?(n=i&&void 0!==i.value?void 0!==this._tab.tabBar.getButtonFromValue(i.value).elements._closeButton:this.closeButtonFlag,i||(o=!0)):"maximize"===e&&(n=this.maximizeButtonFlag)}return{canbeAdded:n,menuTarget:i,closeAll:o}},_firstParentWithClass:function(e,t){var i=e;return i?(" "+i.className+" ").replace(/[\n\t]/g," ").indexOf(" "+t+" ")>-1?i:this._firstParentWithClass(i.parentNode,t):void 0},_onCloseContextMenuAction:function(e){e?this._tab.tabBar._closeListener(e):this.close()},_activateWindowForContextMenu:function(e){var t=this._firstParentWithClass(e,"wux-controls-button"),i=t?t.dsModel:void 0;i&&(this.activeFlag=!0,i.checkFlag=!0)}});var l=function(e){if((!0===this.resizableFlag||"true"===this.resizableFlag||"horizontal"===this.resizableFlag)&&e>=this.minWidth)for(var t=this.getEmbeddedWindows(),i=0;i<t.length;i++)!0!==t[i].resizableFlag&&"true"!==t[i].resizableFlag&&"horizontal"!==t[i].resizableFlag||(t[i].width=e)},d=function(e){if((!0===this.resizableFlag||"true"===this.resizableFlag||"vertical"===this.resizableFlag)&&e>=this.minHeight)for(var t=this.getEmbeddedWindows(),i=0;i<t.length;i++)!0!==t[i].resizableFlag&&"true"!==t[i].resizableFlag&&"vertical"!==t[i].resizableFlag||(t[i].height=e)};return r}),define("DS/Windows/Panel",["UWA/Core","DS/Windows/Window","DS/Windows/WindowGroup","DS/Utilities/Utils","DS/Controls/Button","DS/Controls/Expander","DS/Core/PointerEvents","DS/Utilities/Dom"],function(e,t,i,n,o,s,a,r){"use strict";return t.inherit({name:"panel",publishedProperties:{collapsibleFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},snappableFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},floatableFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},headerPopupContent:{defaultValue:void 0,type:Object,category:"Behavior"},pinnedFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},showTitleFlag:{defaultValue:!0,type:"boolean",category:"Behavior"}},buildView:function(){this._parent(),this.elements.container.addClassName("wux-windows-panel wux-medium-background"),this.elements._titleBarDiv.addClassName("wux-windows-panel"),this.elements._buttonsDiv=new e.Element("div",{class:"wux-windows-panel-buttons"}),this.elements._buttonsDiv.inject(this.elements._mainContentDiv,"top"),this.elements._buttonsDiv.hide(),this.allowedDockAreas=WUXDockAreaEnum.TopDockArea|WUXDockAreaEnum.BottomDockArea|WUXDockAreaEnum.LeftDockArea|WUXDockAreaEnum.RightDockArea},_applyHeaderPopupContent:function(t){function i(e){if(l.elements._headerPopup&&l.elements._headerPopup.elements&&!r.isElementInside(e.target,l.elements._headerPopup.elements.header)&&!r.isElementInside(e.target,l.elements._headerPopup.elements.expanderContainer)){var t=Object.keys(l.buttons).length;void 0!==l.buttons&&t>0&&e.target.parentNode!==l.buttons.Ok.getContent()&&e.target!==l.buttons.Ok.getContent()&&e.target.parentNode!==l.buttons.Cancel.getContent()&&e.target!==l.buttons.Cancel.getContent()?l.elements._headerPopup.close():0===t&&l.elements._headerPopup.close()}}function n(e){if(l.elements._headerPopup&&l.elements._headerPopup.elements&&!r.isElementInside(e.target,l.elements._headerPopup.elements.header)&&!r.isElementInside(e.target,l.elements._headerPopup.elements.expanderContainer)){var t=Object.keys(l.buttons).length;void 0!==l.buttons&&t>0&&e.target.parentNode!==l.buttons.Ok.getContent()&&e.target!==l.buttons.Ok.getContent()&&e.target.parentNode!==l.buttons.Cancel.getContent()&&e.target!==l.buttons.Cancel.getContent()?(l.elements._headerPopup.close(),e.target!==l.elements._titleBarDiv&&e.stopPropagation()):0===t&&(l.elements._headerPopup.close(),e.stopPropagation())}}function o(e){l.elements._headerPopup.close()}if(this.headerPopupContent.content){this.elements._headerPopup&&(this.elements._headerPopup.hasClassName&&this.elements._headerPopup.hasClassName("wux-windows-panel-simplesuperfeature")||this.elements._headerPopup.getContent&&this.elements._headerPopup.getContent()&&this.elements._headerPopup.getContent().hasClassName("wux-windows-panel-simplesuperfeature"))&&(this.elements._headerPopup.destroy(),delete this.elements._headerPopup),this.elements._headerPopup?(this.elements._headerPopup.header=this.headerPopupContent.title,this.elements._headerPopup.body=this.headerPopupContent.content):this.elements._headerPopup=new s({header:this.headerPopupContent.title,body:this.headerPopupContent.content,style:"mode-selector"}),this.elements._buttonsDiv.removeClassName("wux-windows-panel-buttons"),this.elements._buttonsDiv.addClassName("wux-windows-panel-expander"),this.elements._mainContentDiv.style.background="",this.elements._contentDiv.style.animation="wux-unblur 0.3s forwards",this.elements._mainContentDiv.style.pointerEvents="all",document.removeEventListener(a.POINTERUP,i),document.removeEventListener(a.POINTERDOWN,n,!0),t&&t.content&&r.removeEventOnElement(this,t.content,"buttonclick",o),this.elements._buttonsDiv.show();var l=this;r.addEventOnElement(this,this.headerPopupContent.content,"buttonclick",o),r.addEventOnElement(this,this.elements._headerPopup,"transitionend",function(e){e.target===l.elements._headerPopup&&e.stopPropagation()}),r.addEventOnElement(this,this.elements._headerPopup,"expand",function(e){l.elements._mainContentDiv.style.background="rgba(255, 255, 255, 0.76)",l.elements._contentDiv.style.animation="wux-blur 0.3s forwards",l.elements._mainContentDiv.style.pointerEvents="none",document.addEventListener(a.POINTERUP,i),document.addEventListener(a.POINTERDOWN,n,!0)}),r.addEventOnElement(this,this.elements._headerPopup,"collapse",function(e){l.elements._mainContentDiv.style.background="",l.elements._contentDiv.style.animation="wux-unblur 0.3s forwards",l.elements._mainContentDiv.style.pointerEvents="all",document.removeEventListener(a.POINTERUP,i),document.removeEventListener(a.POINTERDOWN,n,!0)}),r.addEventOnElement(this,this.elements._titleBarDiv,a.POINTERDOWN,function(e){l.elements._headerPopup.close()})}else this.elements._headerPopup&&!this.elements._headerPopup.hasClassName("wux-windows-panel-simplesuperfeature")&&(this.elements._headerPopup.destroy(),delete this.elements._headerPopup),this.elements._headerPopup?this.elements._headerPopup.setText(this.headerPopupContent.title):(this.elements._headerPopup=new e.Element("div",{class:"wux-windows-panel-simplesuperfeature",text:this.headerPopupContent.title}),this.elements._buttonsDiv.addClassName("wux-windows-panel-buttons"),this.elements._buttonsDiv.removeClassName("wux-windows-panel-expander"));this.elements._headerPopup.inject(this.elements._buttonsDiv),this._applyButtons()},_applyTouchMode:function(){this._parent(),this._postEditTouchMode()},_postEditTouchMode:function(){this._parent()},_superFeatureCallback:function(e,t,i,n){return i&&(this.headerPopupContent={title:e.label,content:n}),e.checkFlag=!0,t&&t(),e.label},buildSuperFeature:function(t){var i=this,n=!t.title,a=void 0;if(this.elements._buttonsDiv.hasChildNodes()&&this.elements._headerPopup)for(var r=0;r<this.elements._buttonsDiv.childNodes.length;r++){var l=this.elements._buttonsDiv.childNodes[r];(l.dsModel&&l.dsModel instanceof s||l.hasClassName("wux-windows-panel-simplesuperfeature"))&&(l.remove(),this.elements._headerPopup=void 0)}if(t.content){(a=new e.Element("div",{class:"wux-windows-panel-superfeature"})).setStyles({display:"flex","justify-content":"space-around"});for(r=0;r<t.content.length;r++){var d=new o({type:"radio",label:t.content[r].label,icon:t.content[r].icon,value:r,displayStyle:"lite-borders",clickMode:1,onClick:function(e){i._superFeatureCallback(e.dsModel,t.content[e.dsModel.value].onSelect,n,a)}});d.inject(a),d.getContent().setStyle("flex-grow","1"),0===r&&this._superFeatureCallback(d,t.content[0].onSelect,n,a)}}return t.content||n?this.headerPopupContent={title:t.title?t.title:t.content[0].label,content:a}:this.headerPopupContent={title:t.title},this.headerPopupContent},buildStandardButtons:function(){var e=new o({icon:{iconName:"check",fontIconFamily:WUXManagedFontIcons.Font3DS},emphasize:"secondary"});e.elements.container.addClassName("wux-windows-panel-apply");var t=new o({icon:{iconName:"wrong",fontIconFamily:WUXManagedFontIcons.Font3DS}});t.elements.container.addClassName("wux-windows-panel-cancel"),this.buttons={Ok:e,Cancel:t},r.addEventOnElement(this,e,a.POINTERUP,function(e){e.stopPropagation()}),r.addEventOnElement(this,t,a.POINTERUP,function(e){e.stopPropagation()})},getCollapsibleState:function(){return this.collapsibleFlag&&this.currentDockArea!==WUXDockAreaEnum.TopDockArea&&this.currentDockArea!==WUXDockAreaEnum.BottomDockArea&&!this.maximizedFlag&&!(this.currentDockArea===WUXDockAreaEnum.LeftDockArea&&this.verticallyStretchableFlag)&&!(this.currentDockArea===WUXDockAreaEnum.RightDockArea&&this.verticallyStretchableFlag)},getFloatableState:function(){return this.floatableFlag},supportsGroupType:function(e){return e===WUXWindowGroupTypeEnum.GroupAsTab},_canBeSnapSource:function(e,t){var i=e&&this.snappableFlag&&e!==this||t===WUXSnapAreaEnum.OutsideArea||t===WUXSnapAreaEnum.NoneArea;if(i&&e&&(i=e.immersiveFrame===this.immersiveFrame),i&&t!==WUXSnapAreaEnum.OutsideArea&&t!==WUXSnapAreaEnum.NoneArea){var n=t===WUXSnapAreaEnum.InsideArea?WUXWindowGroupTypeEnum.GroupAsTab:WUXWindowGroupTypeEnum.GroupAsGrid;i=this.supportsGroupType(n)}return i&&e&&t!==WUXSnapAreaEnum.OutsideArea&&e.getDockedFlag()&&(i=this.allowedDockAreas&e.currentDockArea),i&&e&&e.maximizedFlag&&!this.allowMaximizeFlag&&(i=!1),i},_canBeSnapTarget:function(e,t){var i=e&&e!==this&&(t===WUXSnapAreaEnum.OutsideArea||this.snappableFlag);if(i&&t!==WUXSnapAreaEnum.OutsideArea&&t!==WUXSnapAreaEnum.NoneArea){var n=t===WUXSnapAreaEnum.InsideArea?WUXWindowGroupTypeEnum.GroupAsTab:WUXWindowGroupTypeEnum.GroupAsGrid;i=this.supportsGroupType(n)}if(i&&e&&(i=e.immersiveFrame===this.immersiveFrame),i&&this.getDockedFlag())switch(this.currentDockArea){case WUXDockAreaEnum.LeftDockArea:case WUXDockAreaEnum.RightDockArea:i=t===WUXSnapAreaEnum.OutsideArea||t===WUXSnapAreaEnum.TopArea||t===WUXSnapAreaEnum.BottomArea||t===WUXSnapAreaEnum.InsideArea;break;case WUXDockAreaEnum.TopDockArea:case WUXDockAreaEnum.BottomDockArea:i=t===WUXSnapAreaEnum.OutsideArea||t===WUXSnapAreaEnum.LeftArea||t===WUXSnapAreaEnum.RightArea||t===WUXSnapAreaEnum.InsideArea}return i},_createWindowGroup:function(e){var t=this.width,o=this.height,s={my:"top left",at:"top left",of:(a=this._getCompletePosition()).of,collision:a.collision},a=n.getPositionRelativeToOffsetParent(this,s);return new i({groupType:e,immersiveFrame:this.immersiveFrame,activeFlag:!1,width:t,height:o,position:a,maximizedFlag:this.maximizedFlag})},_updateFromCollapsibleState:function(){this._parent()},_applyButtons:function(e){this._parent(e),0==this.elements._buttonsDiv.childNodes.length?this.elements._buttonsDiv.hide():(this.elements._headerPopup||this.elements._buttonsDiv.addClassName("wux-windows-panel-buttons"),this.elements._buttonsDiv.show())},_applyCollapsibleFlag:function(){this._updateFromCollapsibleState()},_applyFloatableFlag:function(){if(!this.floatableFlag&&!this.currentDockArea){var e=WUXDockAreaEnum.LeftDockArea;if(!(e&this.allowedDockAreas))for(var t in WUXDockAreaEnum)WUXDockAreaEnum[t]!=WUXDockAreaEnum.NoneDockArea&&WUXDockAreaEnum[t]&this.allowedDockAreas&&(e=WUXDockAreaEnum[t]);this.windowGroup?this.windowGroup.currentDockArea=e:this.currentDockArea=e}},_applyWindowGroup:function(e){this._parent(e),this.pinnedFlag&&this._applyPinnedFlag()},_applyPinnedFlag:function(){this.windowGroup&&this.windowGroup._pinOrUnpinWindow(this)},_applyShowTitleFlag:function(){this.showTitleFlag||!this.icon||""===this.icon.iconName?this.elements._titleP.setStyle("display",""):this.elements._titleP.setStyle("display","none"),this._updateTitleStyle()},_applyIcon:function(e){this._parent(e),this._applyShowTitleFlag(),this._updateTitleStyle()},_applyTitle:function(e){this._parent(e),this._applyShowTitleFlag(),this._updateTitleStyle()},_applyProperties:function(e){this._parent(e),this.isDirty("collapsibleFlag")&&this._applyCollapsibleFlag(),this.isDirty("floatableFlag")&&this._applyFloatableFlag(),this._applyShowTitleFlag()},_applyVerticallyStretchableFlag:function(e){this._parent(e),this._applyCollapsibleFlag()},handleEvents:function(){this._parent()},_updateTitleStyle:function(){"none"===this.elements._titleP.getStyle("display")||""===this.title?this.elements.iconPlaceholder.addClassName("wux-windows-icon-no-title"):this.elements.iconPlaceholder.removeClassName("wux-windows-icon-no-title")},_savePinnedFlagInPreferences:function(){var e={pinnedFlag:this.pinnedFlag},t="pinnedFlag";this._saveDataInPreferences(t,e),-1===this._savedPreferencesKeys.indexOf(t)&&this._savedPreferencesKeys.push(t)},_getPinnedFlagFromPreferences:function(){return this._getDataFromPreferences("pinnedFlag")},_readWindowPreferences:function(){this._parent();var e=this._getPinnedFlagFromPreferences();e&&(this.pinnedFlag=e.pinnedFlag)}})}),define("DS/Windows/ImmersiveWindow",["DS/Windows/Panel"],function(e){"use strict";return e.inherit({name:"immersiveWindow",publishedProperties:{useBackgroundFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},decorationFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},opacity:{defaultValue:void 0,type:"number",category:"Appearance"},snappableFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},collapsibleFlag:{defaultValue:!1,type:"boolean",category:"Behavior"}},buildView:function(){this._parent(),this.elements.container.addClassName("wux-windows-immersive-window"),this.allowedDockAreas=WUXDockAreaEnum.NoneDockArea},_applyUseBackgroundFlag:function(){this.useBackgroundFlag?(this.getContent().removeAttribute("no-background"),this.elements._titleBarDiv.removeAttribute("no-background")):(this.getContent().setAttributeNode(document.createAttribute("no-background")),this.elements._titleBarDiv.setAttributeNode(document.createAttribute("no-background")))},_applyDecorationFlag:function(){this.decorationFlag?this.getContent().removeAttribute("no-decoration"):this.getContent().setAttributeNode(document.createAttribute("no-decoration"))},_applyOpacity:function(){void 0!==this.opacity?this.getContent().setStyle("opacity",this.opacity):this.getContent().setStyle("opacity","")},_applyProperties:function(e){this._parent(e),this.isDirty("useBackgroundFlag")&&this._applyUseBackgroundFlag(e.useBackgroundFlag),this.isDirty("decorationFlag")&&this._applyDecorationFlag(e.decorationFlag),this.isDirty("opacity")&&this._applyOpacity(e.opacity)}})}),define("DS/Windows/ImmersiveFrame",["UWA/Core","DS/Controls/Abstract","DS/Utilities/Utils","DS/Utilities/Dom","DS/Windows/DockingElement","DS/Windows/DockingElementForImmersiveFrame","DS/Windows/Window","DS/WebRecordEnabler/Adapter","DS/WebRecordBase/Constants","DS/WebRecordBase/Utils","DS/Windows/Panel","i18n!DS/Windows/assets/nls/translation"],function(e,t,i,n,o,s,a,r,l,d,h,c){"use strict";function m(e,t){var n=null,o=WUXSnapAreaEnum.NoneArea;if(e)for(var s in this.windows){var a=this.windows[s];if(a&&(a.windowGroup&&a.windowGroup.groupType===WUXWindowGroupTypeEnum.GroupAsTab&&(a=a.windowGroup),a!==e)){var r=a.getBoundingClientRect();if(i.rectContains(r,t)){if(e._canBeSnapSource(a,WUXSnapAreaEnum.LeftArea)&&a._canBeSnapTarget(e,WUXSnapAreaEnum.LeftArea)){var l=a._getSnapAreaRect(WUXSnapAreaEnum.LeftArea);i.rectContains(l,t)&&(n=a,o=WUXSnapAreaEnum.LeftArea)}if(!n&&e._canBeSnapSource(a,WUXSnapAreaEnum.RightArea)&&a._canBeSnapTarget(e,WUXSnapAreaEnum.RightArea)){var d=a._getSnapAreaRect(WUXSnapAreaEnum.RightArea);i.rectContains(d,t)&&(n=a,o=WUXSnapAreaEnum.RightArea)}if(!n&&e._canBeSnapSource(a,WUXSnapAreaEnum.TopArea)&&a._canBeSnapTarget(e,WUXSnapAreaEnum.TopArea)){var h=a._getSnapAreaRect(WUXSnapAreaEnum.TopArea);i.rectContains(h,t)&&(n=a,o=WUXSnapAreaEnum.TopArea)}if(!n&&e._canBeSnapSource(a,WUXSnapAreaEnum.BottomArea)&&a._canBeSnapTarget(e,WUXSnapAreaEnum.BottomArea)){var c=a._getSnapAreaRect(WUXSnapAreaEnum.BottomArea);i.rectContains(c,t)&&(n=a,o=WUXSnapAreaEnum.BottomArea)}if(!n&&void 0===a._isFakeWindowForStacking&&e._canBeSnapSource(a,WUXSnapAreaEnum.InsideArea)&&a._canBeSnapTarget(e,WUXSnapAreaEnum.InsideArea)){var m=a._getSnapAreaRect(WUXSnapAreaEnum.InsideArea);i.rectContains(m,t)&&(n=a,o=WUXSnapAreaEnum.InsideArea)}if(n)break}}}this._snapTargetWindow!==n&&(this._snapTargetWindow&&(this._snapTargetWindow.activeSnapArea=WUXSnapAreaEnum.NoneArea),this._snapTargetWindow=n,this._snapTargetWindow&&(this._snapPointer=t,this._snapTargetWindow.activeSnapArea=o,e&&this._initStackingWindowsTimer(this._snapTargetWindow,e)))}function u(e,t,i){if(this._snapTargetWindow){if(!d.isReplaying()){var n=i||this._snapTargetWindow,o=this._snapTargetWindow.activeSnapArea,s=n.isAWindowGroup()?n._computedIdentifier:n.identifier;s&&e.callMethodFromUIInteraction("_locateAndAttachToWindow",s,o,t),e._attachToWindow(n,o,t,!0)}var a=e.elements.container?e:n;a._saveWindowGroupInPreferences(),a._saveDockAreaInPreferences(),this._snapTargetWindow.activeSnapArea=WUXSnapAreaEnum.NoneArea,this._snapTargetWindow=null}else this._activeDockingElement&&(d.isReplaying()||e.setPropertyFromUIInteraction("currentDockArea",this._activeDockingElement.side),e.currentDockArea===this._activeDockingElement.side&&(e._saveDockAreaInPreferences(),1===this._activeDockingElement.getContainedVisibleWindows().length&&this._activeDockingElement._saveDockingZoneSizeInPreferences()));this._activeDockingElement&&(this._activeDockingElement.interactiveDockAreaVisibleFlag=!1,this._activeDockingElement=null),e.elements.container&&e.elements.container.removeClassName("wux-windows-window-furtive")}function g(e){e&&(e.interactiveDockAreaVisibleFlag=!1,e.collapseMemory&&(e.collapseDockingZoneFlag=!0,e.collapseMemory=!1),0===e.getContainedVisibleWindows().length&&(e.visibleDockingZoneFlag=!1))}function p(e){var t=this.getContent().getBoundingClientRect(),i=this.getDockingElement(e).getContent().getBoundingClientRect();switch(e){case WUXDockAreaEnum.TopDockArea:return{x:t.left,y:i.top-this._dockingSensibilityZoneSize,width:t.width,height:2*this._dockingSensibilityZoneSize};case WUXDockAreaEnum.BottomDockArea:return{x:t.left,y:i.bottom-this._dockingSensibilityZoneSize,width:t.width,height:2*this._dockingSensibilityZoneSize};case WUXDockAreaEnum.LeftDockArea:return{x:i.left-this._dockingSensibilityZoneSize,y:t.top,width:2*this._dockingSensibilityZoneSize,height:t.height};case WUXDockAreaEnum.RightDockArea:return{x:i.right-this._dockingSensibilityZoneSize,y:t.top,width:2*this._dockingSensibilityZoneSize,height:t.height}}}var f=t.inherit({name:"immersiveFrame",markForRecordFlag:!0,_linkedImmersiveFrames:void 0,publishedProperties:{identifier:{defaultValue:"",type:"string",readOnly:!0,category:"Behavior"},_ActionBar_V3:{defaultValue:!1,type:"boolean",category:"Appearance",noNeedToApplyFlag:!0},dockingElementsPriority:{defaultValue:[WUXDockAreaEnum.LeftDockArea,WUXDockAreaEnum.RightDockArea,WUXDockAreaEnum.TopDockArea,WUXDockAreaEnum.BottomDockArea],type:"Array",readOnly:!0,category:"Behavior"},reactToPointerEventsFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},dockingElementsAutoExpandFlag:{defaultValue:!0,type:"boolean",category:"Behavior"}},windows:void 0,dockingElements:void 0,resizerSize:10,_preBuild:function(e){this._parent(e),e&&e._ActionBar_V3&&this._properties.dockingElementsPriority&&(this._properties.dockingElementsPriority.value=[WUXDockAreaEnum.TopDockArea,WUXDockAreaEnum.BottomDockArea,WUXDockAreaEnum.LeftDockArea,WUXDockAreaEnum.RightDockArea])},_postBuildView:function(){this.elements.container.addClassName("wux-windows-immersive-frame"),r.setElementRecordMode(this.elements.container,l.RecordModes.DEFAULT_AND_CHILD);for(var t=0;t<this.dockingElementsPriority.length;t++)this._addDockingZone(this.dockingElementsPriority[t],200);this.getFreeZone().addClassName("wux-windows-immersive-frame-freeZone"),this._snapTargetWindow=null,this._activeDockingElement=null,this._dockingSensibilityZoneSize=22,this.elements.pointerEventsDiv=new e.Element("div",{class:"wux-windows-immersive-frame-pointer-events"}).inject(this.elements.container),this.elements.pointerEventsDiv.hide();var i=this;n.onNodeRendered(this.getContent(),function(){i._insertedInDOM=!0,i._onResizeFun&&i._onResizeFun()})},_applyIdentifier:function(e){this.identifier?this.getContent().setAttribute("wux-identifier",this.identifier):this.getContent().removeAttribute("wux-identifier")},isInsertedInDOM:function(){return!!this._insertedInDOM},init:function(e){this.windows={},this.dockingElements=[],this._parent(e)},_applyReactToPointerEventsFlag:function(e){this.reactToPointerEventsFlag?this.elements.container.removeClassName("wux-windows-immersive-frame-no-pointerevents"):this.elements.container.addClassName("wux-windows-immersive-frame-no-pointerevents")},dockWindow:function(e,t,i){if(e&&e.allowedDockAreas&&e.allowedDockAreas&t){var o=this.getDockingElement(t);if(o){let c=this.getWindowsInDockingElement(t),m=c[0]===e&&c.length>1?c[1]:c[0];if(!(i&&i.attachToOtherDockedWindow&&c.length>0&&m!==e)||e.windowGroup&&m.windowGroup&&e.windowGroup===m.windowGroup){if(!e.windowGroup||e.currentDockArea!=t){if(o.interactiveDockAreaVisibleFlag=!1,o.visibleDockingZoneFlag=!0,o.onTransitionEnd(),0===o.getContainedVisibleWindows().length){var s=o.dockingZoneSize,a=window.getComputedStyle(e.getTitleBar()),r=e._getDockedDimensionsFromPreferences(),l=t===WUXDockAreaEnum.LeftDockArea||t===WUXDockAreaEnum.RightDockArea?"width":"height";if((!n.isCurrentlyCalledFromUIInteraction()||i&&i.restoreDockedDimensions)&&r&&r[l])s=r[l];else if(e._prefRestorationState===WUXPreferenceRestorationStateEnum.Restored&&o.side===WUXDockAreaEnum.TopDockArea||o.side==WUXDockAreaEnum.BottomDockArea){e.getContent().offsetParent||-1!==e.height||this.moveWindowToImmersiveFrame(e);var d=-1===e.height?window.getComputedStyle(e.getContent()).height:e.height+parseInt(a.height);s=parseInt(d),0===parseInt(a.borderTop)&&s++,o.useBordersFlag&&s++}else if(e._prefRestorationState===WUXPreferenceRestorationStateEnum.Restored){e.getContent().offsetParent||-1!==e.width||this.moveWindowToImmersiveFrame(e);var h=-1===e.width?window.getComputedStyle(e.getContent()).width:e.width;s=parseInt(h)+1,0===parseInt(a.borderLeft)&&s++,o.useBordersFlag&&s++}isNaN(s)||(o.dockingZoneSize=s)}e.getContent().isInjected(o.elements.dockingZone)||e.inject(o.elements.dockingZone)}}else e.attachToWindow(c[0],WUXSnapAreaEnum.InsideArea,"after");e.immersiveFrame=this,e.currentDockArea=t,o._updateFromContainedWindows(),o._updateContainedWindows()}}return e.currentDockArea===t?1:-1},getWindowsInDockingElement:function(e){let t=[];for(const[i,n]of Object.entries(this.windows))n.currentDockArea!==e||n.maximizedFlag||n.windowGroup||t.push(n);return t},undockWindow:function(e){if(e){var t=e.currentDockArea,i=this.getDockingElement(t);if(e._isBeingClosed){var n=e.getContent().getParent();n&&n.removeChild(e.getContent())}else{if(!e.windowGroup||t!==WUXDockAreaEnum.NoneDockArea){var o=e.getAbsolutePosition();this.moveWindowToImmersiveFrame(e),e.getContent().setStyle("z-index",""),e.activeFlag&&e.bringToFront(),e.setAbsolutePosition(o)}e.currentDockArea=WUXDockAreaEnum.NoneDockArea}i&&(i._updateFromContainedWindows(),i._updateContainedWindows(),i._pointerEventsAllIfOverflow(),i._resetInteractiveDockArea())}},getFreeZone:function(){return this.dockingElements[this.dockingElements.length-1].elements.freeZone},setContentInBackgroundLayer:function(t){t?(this._backgroundLayerDiv||(this._backgroundLayerDiv=new e.Element("div",{styles:{top:0,bottom:0,right:0,left:0,position:"absolute",width:"100%",height:"100%",pointerEvents:"all"}}),this._backgroundLayerDiv.inject(this.getContent(),"top")),t.inject?t.inject(this._backgroundLayerDiv):this._backgroundLayerDiv.appendChild(t)):this._backgroundLayerDiv&&(this._backgroundLayerDiv.empty(),this._backgroundLayerDiv.remove(),delete this._backgroundLayerDiv)},setViewer:function(e){this._viewer=e},getViewer:function(e){return this._viewer},moveWindowToMaximizeZone:function(e){e&&(e.inject(this.getFreeZone()),!this._ActionBar_V3||e.currentDockArea!==WUXDockAreaEnum.TopDockArea&&e.currentDockArea!==WUXDockAreaEnum.BottomDockArea||e._moveTitleBar(!1,this.getDockingElement(e.currentDockArea)))},moveWindowToImmersiveFrame:function(e){e&&e.getContent().getParent()!==this.elements.container&&(e.inject(this.elements.container),this._ActionBar_V3&&(e.currentDockArea===WUXDockAreaEnum.TopDockArea||e.currentDockArea===WUXDockAreaEnum.BottomDockArea?e._moveTitleBar(!0,this.getDockingElement(e.currentDockArea)):e._moveTitleBar(!1,this.getDockingElement(e.currentDockArea))))},_addDockingZone:function(e,t){var i=this._ActionBar_V3?s:o,n="";switch(e){case WUXDockAreaEnum.LeftDockArea:n="LeftDockArea";break;case WUXDockAreaEnum.RightDockArea:n="RightDockArea";break;case WUXDockAreaEnum.TopDockArea:n="TopDockArea";break;case WUXDockAreaEnum.BottomDockArea:n="BottomDockArea"}var a=new i({identifier:this.identifier+"_"+n,side:e,dockingZoneSize:t,visibleDockingZoneFlag:!1,collapseDockingZoneFlag:!1,recId:this.recId?n:void 0,autoExpandFlag:this.dockingElementsAutoExpandFlag});a.elements.container.addClassName("wux-immersive-frame-component"),this._ActionBar_V3||(a.useBackgroundFlag=!0),0===this.dockingElements.length?a.inject(this.elements.container):a.inject(this.dockingElements[this.dockingElements.length-1].elements.freeZone),this.dockingElements.push(a)},_removeDockingZone:function(e){this.dockingElements.length<=e||e<0||(e!==this.dockingElements.length-1&&(0===e?this.dockingElements[e+1].inject(this.elements.container):this.dockingElements[e+1].inject(this.dockingElements[e-1].elements.freeZone)),this.dockingElements[e].hide(),this.dockingElements.splice(e,1))},_updateAllDockingZoneSize:function(){for(var e=0;e<this.dockingElements.length;e++){var t=this.dockingElements[e];t&&t._updateDockingZoneSize()}},_applyProperties:function(e){this._parent(e),this.isDirty("reactToPointerEventsFlag")&&this._applyReactToPointerEventsFlag(e.reactToPointerEventsFlag,this.reactToPointerEventsFlag),this.isDirty("identifier")&&this._applyIdentifier(e.identifier,this.identifier)},addWindow:function(e){var t=this;e.windowGroup&&this.addWindow(e.windowGroup),this.containsWindow(e)||(this.windows[t._computeUniqueIdentifier(e)]=e,e.currentDockArea!==WUXDockAreaEnum.NoneDockArea||e.maximizedFlag||e.windowGroup||this.moveWindowToImmersiveFrame(e),e.immersiveFrame=this,e._applyPosition(),e.addEventListener("windowDrag",function(n){t.elements.pointerEventsDiv.show();var o=n.dsModel;if(o){if(!1===o.visibleFlag)return;if((Math.abs(n.options.deltaX)>15||Math.abs(n.options.deltaY)>15)&&(o.getDockedFlag()||o.windowGroup)){var s=o.getContent().getSize();if(o.windowGroup){if(i.isMouseOverElement(o.windowGroup.elements._titleBarDiv,n.options))return void o.windowGroup._manageReorder(o,n.options);var a=o.windowGroup;if(2===a.getEmbeddedWindows().length)for(var r=0;r<2;r++){var l=a.getEmbeddedWindows()[r];if(l!==o){a=l;break}}o.windowGroup.activeSnapArea=WUXSnapAreaEnum.NoneArea,o.windowGroup._detachWindow(o,e._isCurrentlyCalledFromUIInteraction()),t._clearStackingWindowsTimer(),t._stopWindowGroupTabBarSliding(),(o=t._replaceFakedWindowByReallyMovedWindow(o))._saveWindowGroupInPreferences(a)}o.getFloatableState()&&(o.currentDockArea=WUXDockAreaEnum.NoneDockArea,o._saveDockAreaInPreferences()),o.activeFlag=!0,o.bringToFront();var d=o.getContent().getSize();d.width===s.width&&d.height===s.height||o._ensureTitleBarUnderPointer(n.options)}o.windowGroup||(m.call(t,o,n.options),function(e,t){var i=null;if(e.immersiveFrame===this&&e.allowedDockAreas)for(var n=0;n<this.dockingElements.length;n++){var o=this.dockingElements[n];if(e.allowedDockAreas&o.side&&!this._snapTargetWindow&&!i){var s=p.call(this,o.side);if(t.x<s.x||t.x>=s.x+s.width||t.y<s.y||t.y>=s.y+s.height)g(o);else{if(o.collapseDockingZoneFlag&&(o.collapseMemory=!0,o.collapseDockingZoneFlag=!1),!o.visibleDockingZoneFlag){if(0===o.getContainedVisibleWindows().length){var a=o.dockingZoneSize,r=window.getComputedStyle(e.getContent());a=o.side===WUXDockAreaEnum.TopDockArea||o.side==WUXDockAreaEnum.BottomDockArea?parseInt(r.height):parseInt(r.width),isNaN(a)||(o.dockingZoneSize=a)}o.visibleDockingZoneFlag=!0}o.interactiveDockAreaVisibleFlag=!0,i=o}}else o.interactiveDockAreaVisibleFlag=!1}this._activeDockingElement!==i&&(this._activeDockingElement&&g(this._activeDockingElement),this._activeDockingElement=i)}.call(t,o,n.options),t._snapTargetWindow||t._activeDockingElement?o.elements.container.addClassName("wux-windows-window-furtive"):o.elements.container.removeClassName("wux-windows-window-furtive"))}}),e.addEventListener("stopWindowDrag",function(e){var i,n;if(t._stopWindowGroupTabBarSliding(),t._fakeStackedWindow&&t._snapSourceWindow.show(),t._fakeStackedWindow&&t._fakeStackedWindow.windowGroup){var o=t._fakeStackedWindow.windowGroup.getEmbeddedWindows(),s=o.indexOf(t._fakeStackedWindow);s<o.length-1?(n=o[s+1],i="before"):(n=o[s-1],i="after"),t._fakeStackedWindow.windowGroup._detachWindow(t._fakeStackedWindow),t.undockWindow(t._fakeStackedWindow),m.call(t,e.dsModel,e.options),t._fakeStackedWindow.hide()}u.call(t,e.dsModel,i,n),t._resetStackedWindowData(),t.elements.pointerEventsDiv.hide()}),e.addEventListener("startResize",function(e){t.elements.pointerEventsDiv.show(),t.elements.pointerEventsDiv.setStyle("cursor",e.options.cursor)}),e.addEventListener("stopResize",function(e){t.elements.pointerEventsDiv.hide(),t.elements.pointerEventsDiv.setStyle("cursor","default")}),e.addEventListener("visibleStateChange",function(i){if(e.currentDockArea!==WUXDockAreaEnum.NoneDockArea){var n=t.getDockingElement(e.currentDockArea);if(n)if(e.visibleFlag)n.visibleDockingZoneFlag=!0;else{for(var o=n.getContainedVisibleWindows(),s=0,a=0;a<o.length;a++)o[a].getContent().hasClassName("wux-windows-window")&&"none"!==o[a].getContent().getStyle("display")&&s++;0===s&&(n.visibleDockingZoneFlag=!1)}}}),this.fire("addWindow",{window:e}))},removeWindow:function(e){if(e){for(var t in this.windows){var i=this.windows[t];if(i&&i===e){e.currentDockArea!==WUXDockAreaEnum.NoneDockArea&&this.undockWindow(e),e.position.of===this.getContent()&&(e.position.of=null),e.position.constraint===this.getContent()&&(e.position.constraint=null),this.elements&&this.elements.container&&e.remove(),delete this.windows[t],e.immersiveFrame=null;break}}this.fire("removeWindow",{window:e})}},getDockingElement:function(e){return this.dockingElements[this.dockingElementsPriority.indexOf(e)]},containsWindow:function(e){var t=!1;if(e)for(var i in this.windows){var n=this.windows[i];if(n&&n===e){t=!0;break}}return t},_computeUniqueIdentifier:function(e){if(e){for(var t=void 0!==e.identifier&&""!==e.identifier?e.identifier:"1",i=2;void 0!==this.windows[t];)t=i,i++;return t}},_getWindowFromIdentifier:function(e){for(var t in this.windows)if(this.windows.hasOwnProperty(t)){var i=this.windows[t];if(i.identifier===e)return i}},handleEvents:function(){var e=this;document.addEventListener("touchChange",function(){e._manageAllPointerEventsOnDockingElements()});for(var t=0;t<e.dockingElements.length;t++){(a=e.dockingElements[t])&&a.addEventListener("dockResize",function(t){e._manageAllPointerEventsOnDockingElements()})}e._onResizeFun=function(){if(e.elements.container){for(var t in e.windows){var i=e.windows[t];i&&i.visibleFlag&&(i._applyWidth(),i._applyHeight(),i._applyPosition())}e._manageAllPointerEventsOnDockingElements();var n=window.getComputedStyle(e.getContent()),o=parseInt(n.width)>480&&parseInt(n.height)>640;for(var s in WUXDockAreaEnum){var a=e.getDockingElement(WUXDockAreaEnum[s]);a&&(a.autoExpandFlag=o&&e.dockingElementsAutoExpandFlag)}}},e._resizeFreeZoneFun=function(t){e.fire("freeZoneResize")},n.addResizeListener(this.elements.container,e._onResizeFun),n.addResizeListener(this.getFreeZone(),e._resizeFreeZoneFun),n.removeEventOnElement(this,this.elements.pointerEventsDiv,"click",function(){e.elements.pointerEventsDiv.hide()});var i=function(){e._manageAllPointerEventsOnDockingElements(),e.removeEventListener("transitionend",i)},o=function(){e.addEventListener("transitionend",i)};for(var s in WUXDockAreaEnum){var a;(a=this.getDockingElement(WUXDockAreaEnum[s]))&&(a.addEventListener("collapse",o),a.addEventListener("expand",o))}},destroy:function(){if(this.elements&&this.elements.container){if(n.removeResizeListener(this.elements.container,this._onResizeFun),n.removeResizeListener(this.getFreeZone(),this._resizeFreeZoneFun),this._fakeStackedWindowSaved&&(this._fakeStackedWindowSaved.destroy(),this._fakeStackedWindowSaved=null),this.windows)for(var e=Object.keys(this.windows),t=0;t<e.length;t++)this.windows[e[t]]&&this.windows[e[t]].destroy();var i=Object.keys(this.dockingElements);for(t=i.length-1;t>=0;t--){var o=this.dockingElements[i[t]];o.destroy&&o.destroy()}this._parent()}},destroyAllWindows:function(){this.destroyWindows(this.windows)},destroyWindows:function(e){function t(e){e.destroy&&e.destroy()}if(Array.isArray(e))for(var i=0;i<e.length;i++)t(e[i]);else for(var n=Object.keys(e).length;n>0;)t(this.windows[Object.keys(e)[0]]),n=Object.keys(e).length},_manageAllPointerEventsOnDockingElements:function(){this.getDockingElement(WUXDockAreaEnum.BottomDockArea)._pointerEventsAllIfOverflow(),this.getDockingElement(WUXDockAreaEnum.BottomDockArea)._resetInteractiveDockArea(),this.getDockingElement(WUXDockAreaEnum.TopDockArea)._pointerEventsAllIfOverflow(),this.getDockingElement(WUXDockAreaEnum.TopDockArea)._resetInteractiveDockArea(),this.getDockingElement(WUXDockAreaEnum.LeftDockArea)._pointerEventsAllIfOverflow(),this.getDockingElement(WUXDockAreaEnum.LeftDockArea)._resetInteractiveDockArea(),this.getDockingElement(WUXDockAreaEnum.RightDockArea)._pointerEventsAllIfOverflow(),this.getDockingElement(WUXDockAreaEnum.RightDockArea)._resetInteractiveDockArea()},_initStackingWindowsTimer:function(e,t){this._clearStackingWindowsTimer();var i=this;this._stopDragOccured=!1,this._stackingTimeOut=setTimeout(function(){if(i._stopDragOccured||e.activeSnapArea!==WUXSnapAreaEnum.InsideArea)e&&(e.activeSnapArea=WUXSnapAreaEnum.NoneArea);else{i._snapTargetWindowForFeedback=e;var n=e._computeDropInsertionData(i._snapPointer),o=i._getOrCreateFakePanelForStacking(t);i._snapSourceWindow=t,u.call(i,o,n.beforeOrAfter,n.targetWindow),t.hide(),i._fakeStackedWindow.windowGroup&&(i._fakeStackedWindow.windowGroup.activeSnapArea=WUXSnapAreaEnum.InsideArea)}},400)},_clearStackingWindowsTimer:function(){this._stackingTimeOut&&(clearTimeout(this._stackingTimeOut),this._stackingTimeOut=null)},_startWindowGroupTabBarSliding:function(e,t){if(!this._windowGroupTabBarSlidingInterval){var i=this;this._windowGroupTabBarSliding=e,this._windowGroupTabBarSlidingDirection=t,this._windowGroupTabBarSlidingInterval=window.setInterval(function(){i._windowGroupTabBarSliding&&i._windowGroupTabBarSliding._slideTabBar(i._windowGroupTabBarSlidingDirection)},900)}},_stopWindowGroupTabBarSliding:function(){this._windowGroupTabBarSlidingInterval&&(window.clearInterval(this._windowGroupTabBarSlidingInterval),delete this._windowGroupTabBarSlidingInterval,this._windowGroupTabBarSlidingInterval=null,this._windowGroupTabBarSliding=null,this._windowGroupTabBarSlidingDirection=null)},_getOrCreateFakePanelForStacking:function(t){var n,o,s,a;if(!this._fakeStackedWindow){if(this._fakeStackedWindow=this._fakeStackedWindowSaved,!this._fakeStackedWindow)a=new e.Element("div",{class:"wux-window-stacking-place-holder-container"}),new e.Element("div",{class:"wux-window-stacking-place-holder"}).inject(a).innerText=c.get("stackingPlaceHolder"),this._fakeStackedWindow=new h({resizableFlag:!0,immersiveFrame:this,content:a}),this._fakeStackedWindow._isFakeWindowForStacking=!0;this._fakeStackedWindowSaved||(this._fakeStackedWindowSaved=this._fakeStackedWindow)}return t.isAWindowGroup()?(n="( "+t.getEmbeddedWindows().length+" )",s="folder",o=!0):(n=t.title,o=t.showTitleFlag,s=t.icon),this._fakeStackedWindow.title=n,this._fakeStackedWindow.showTitleFlag=o,this._fakeStackedWindow.icon=s,i.setPosition(this._fakeStackedWindow,t.position),this._fakeStackedWindow.show(),this._fakeStackedWindow},_computeFiringWindowDragEvents:function(e){var t=e;return this._fakeStackedWindow&&e!==this._fakeStackedWindow&&(t=this._fakeStackedWindow.visibleFlag?this._fakeStackedWindow:this._snapSourceWindow),t},_replaceFakedWindowByReallyMovedWindow:function(e){return e===this._fakeStackedWindow?(this._fakeStackedWindow.hide(),i.setPosition(this._snapSourceWindow,e.position),this._snapSourceWindow.show(),this._snapSourceWindow.activeFlag=!0,this._snapSourceWindow):e},_resetStackedWindowData:function(e){this._fakeStackedWindow=null,this._snapSourceWindow=null,this._stopDragOccured=!0},_onFocusReceived:function(){this._parent();var e=document.activeElement;if(e){var t=this._getContainingWindow(e);t&&(t.lastFocusedWidget=e)}},_getContainingWindow:function(e){for(var t=e;t;){if(t&&t.dsModel&&t.dsModel instanceof a)return t.dsModel;t=t.parentElement}return null},_linkToOtherImmersiveFrame:function(e){this._linkedImmersiveFrames||(this._linkedImmersiveFrames=[]),-1===this._linkedImmersiveFrames.indexOf(e)&&(this._linkedImmersiveFrames.push(e),e._linkToOtherImmersiveFrame(this))}});return r.register(f,"DS/ControlsRec/AbstractRec"),f});