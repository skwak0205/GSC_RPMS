define("DS/CATFLWidgetProperties/CATFLPropertiesServices",["UWA/Class","UWA/Class/Options","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/PlatformAPI/PlatformAPI","DS/Logger/Logger"],function(e,t,i,n,s){"use strict";var o=e.singleton(t,{tenant:null,init:function(e){this._parent(),this._logger=s.getLogger(o)},instance:function(){return this._logger.log("instance"),this},getTenant:function(){return this._logger.log("getTenant"),this.tenant},setTenant:function(e){this._logger.log("setTenant"),this.tenant=e},getInstance:function(e){this._logger.log("getInstance",e);try{this.init(e)}catch(e){}for(var t in e)this.options[t]=e[t];return this},get3DSpaceUrl:function(e){this._logger.log("get3DSpaceUrl",e);var t=location.protocol+"//"+location.hostname;return e&&(e.serverUrl=t,e.serverUri="3DSpace"),t+"/3DSpace"},get3DSpaceBaseUrl:function(e){this._logger.log("get3DSpaceBaseUrl");var t;if(!UWA.is(this.getOption("platform_services"),"array"))throw new Error("Platform services not initialize yet");UWA.is(e)||(e=getTenant());try{for(var i=0;i<this.getOption("platform_services").length;i++)if(this.getOption("platform_services")[i].platformId==e){t=this.getOption("platform_services")[i]["3DSpace"];break}}catch(e){t=this.get3DSpaceUrl()}return t},app_initialization:function(e,t){this._logger.log("app_initialization");var n=this,s=!1;try{UWA.is(this.getOption("platform_services"),"array")||(s=!0)}catch(e){s=!0}s?t?(n.setOption("platform_services",t),e()):(n._logger.log("get Platform Services"),i.getPlatformServices({onComplete:function(t){n.setOption("platform_services",t),void 0!==window.widget&&window.widget&&void 0!==window.widget.getValue("x3dPlatformId")&&window.widget.getValue("x3dPlatformId")&&window.widget.getValue("x3dPlatformId").trim().length>0?n.tenant=window.widget.getValue("x3dPlatformId"):n.tenant=t[0].platformId,e()},onFailure:function(e){throw n._logger.error("Cannot retrieve the Platform Services"),new Error("Cannot retrieve the Platform Services")}})):(n._logger.log("Platform Services already initialized"),e())},getSecurityContext:function(){return this._logger.log("getSecurityContext"),widget.hasPreference("xPref_CREDENTIAL")?widget.getValue("xPref_CREDENTIAL"):widget.hasPreference("security_ctx")?widget.getValue("security_ctx"):widget.getValue("securityContext")}});return o}),define("DS/CATFLWidgetProperties/facets/CATFLSpecificationDocumentFacet",["UWA/Core","UWA/Class","UWA/Controls/Abstract","DS/Logger/Logger","DS/EditPropWidget/facets/Common/FacetsBase","DS/CATFLWidgetProperties/CATFLPropertiesServices","i18n!DS/CATFLWidgetProperties/assets/nls/CATFLProperties.json","css!DS/CATFLWidgetProperties/CATFLWidgetProperties.css"],function(e,t,i,n,s,o,r,a){"use strict";var l=i.extend(s,{init:function(e){this._logger=n.getLogger(l),this._parent(e),this.buildView()},buildView:function(){this._logger.log("buildView");this.elements.container=e.createElement("div",{class:"relatedDocuments_spec"}),this.multiselDisplay=e.createElement("div",{class:"notSupported"}).inject(this.elements.container),this.iconHolder=e.createElement("span",{class:"blockIcon"}).inject(this.multiselDisplay),this.infoMsgH2Tag=e.createElement("h2",{class:"information_msg"}).inject(this.multiselDisplay),this.multiselDisplay.hide()},initSpecificationsPane:function(){this._logger.log("initSpecificationsPane");var e=this;require(["DS/ENOXSpecificationsUX/SpecificationsPane"],function(t){var i=e.getModel()?e.getModel().getTenant():o.getTenant(),n={parentObject:{},connectorOptions:{fetchSecurityContext:function(){return o.getSecurityContext()},platformUrls:{"3DSpace":o.get3DSpaceBaseUrl(i),platformId:i},webinwin:!1},supportedTypes:{includedTypes:["Document"]}};e.getModelID()&&(n.parentObject.parentId=e.getModelID()),e.documentsPane=new t(n),e.documentsPane.modelEvents.subscribe({event:"upload-attachment-complete"},e.refreshNode.bind(e)),e.documentsPane.modelEvents.subscribe({event:"attach-attachment-complete"},e.refreshNode.bind(e)),e.documentsPane.modelEvents.subscribe({event:"detach-attachment-complete"},e.refreshNode.bind(e)),e.elements.container.appendChild(e.documentsPane.elements.container),e.multiselDisplay.isHidden()||e.documentsPane.hide()},function(){e._logger.warn("require of DS/ENOXSpecificationsUX/SpecificationsPane failed"),e.notApplicable()})},refreshNode:function(e){this._logger.log("refreshNode",e);var t=this;require(["DS/PADUtils/PADCommandProxy"],function(i){var n={authored:{modified:[t.getModelID()],documentdata:e}},s=i.create();s.authored({authored:!0}),s.refresh(n),s.destroy()})},getModelID:function(){return this.getModel().get("objectId")},isRelationship:function(){return"relationship"===this.getModel().get("metatype")},updateFacet:function(){this._logger.log("updateFacet");if(!this.getModel())return this.notApplicable(),!1;var e=this.getModelID();if(!e||this.isRelationship())return this.notApplicable(),!1;this.multiselDisplay.hide(),this.documentsPane?(this.documentsPane.show(),this.documentsPane.options.parentObject.parentId!==e&&this.documentsPane.setParentObject({parentId:e})):o.app_initialization(this.initSpecificationsPane.bind(this))},destroyComponent:function(){this._logger.log("destroyComponent"),e.is(this.destroy,"function")&&this.destroy()},notApplicable:function(){this._logger.log("notApplicable");this.infoMsgH2Tag.setText(r.msg_not_supported_selection),this.iconHolder.addClassName("wux-ui-3ds wux-ui-3ds-5x wux-ui-3ds-block"),this.multiselDisplay.show(),this.documentsPane&&this.documentsPane.hide()},onResize:function(){this._logger.log("onResize")},onRefresh:function(){this._logger.log("onRefresh"),this.updateFacet()}});return l}),define("DS/CATFLWidgetProperties/facets/CATFLAttachementFacet",["UWA/Core","UWA/Class","UWA/Controls/Abstract","DS/Logger/Logger","DS/EditPropWidget/facets/Common/FacetsBase","DS/CATFLWidgetProperties/CATFLPropertiesServices","i18n!DS/CATFLWidgetProperties/assets/nls/CATFLProperties.json","css!DS/CATFLWidgetProperties/CATFLWidgetProperties.css"],function(e,t,i,n,s,o,r,a){"use strict";var l=i.extend(s,{init:function(e){this._logger=n.getLogger(l),this._parent(e),this.buildView(e)},buildView:function(t){this._logger.log("buildView");this.elements.container=e.createElement("div",{class:"relatedDocuments"}),this.multiselDisplay=e.createElement("div",{class:"notSupported"}).inject(this.elements.container),this.iconHolder=e.createElement("span",{class:"blockIcon"}).inject(this.multiselDisplay),this.infoMsgH2Tag=e.createElement("h2",{class:"information_msg"}).inject(this.multiselDisplay),this.multiselDisplay.hide()},initAttachmentsPane:function(){this._logger.log("initAttachmentsPane");var e=this;require(["DS/ENOXAttachmentsUX/AttachmentsPane"],function(t){var i=e.getModel()?e.getModel().getTenant():o.getTenant(),n={parentObject:{},connectorOptions:{fetchSecurityContext:function(){return o.getSecurityContext()},platformUrls:{"3DSpace":o.get3DSpaceBaseUrl(i),platformId:i},webinwin:!1},supportedTypes:{includedTypes:["Document"]}};e.getModelID()&&(n.parentObject.parentId=e.getModelID()),e.documentsPane=new t(n),e.elements.container.appendChild(e.documentsPane.elements.container),e.multiselDisplay.isHidden()||e.documentsPane.hide()},function(){e._logger.warn("require of DS/ENOXSpecificationsUX/SpecificationsPane failed"),e.notApplicable()})},refreshNode:function(e){this._logger.log("refreshNode",e);var t=this;require(["DS/PADUtils/PADCommandProxy"],function(i){var n={authored:{modified:[t.getModelID()],data:e}},s=i.create();s.authored({authored:!0}),s.refresh(n),s.destroy()})},getModelID:function(){return this.getModel().get("objectId")},isRelationship:function(){return"relationship"===this.getModel().get("metatype")},updateFacet:function(){this._logger.log("updateFacet");if(!this.getModel())return this.notApplicable(),!1;var e=this.getModelID();if(!e||this.isRelationship())return this.notApplicable(),!1;this.multiselDisplay.hide(),this.documentsPane?(this.documentsPane.show(),this.documentsPane.options.parentObject.parentId!==e&&this.documentsPane.setParentObject({parentId:e})):o.app_initialization(this.initAttachmentsPane.bind(this))},destroyComponent:function(){this._logger.log("destroyComponent"),e.is(this.destroy,"function")&&this.destroy()},notApplicable:function(){this.infoMsgH2Tag.setText(r.msg_not_supported_selection),this.iconHolder.addClassName("wux-ui-3ds wux-ui-3ds-5x wux-ui-3ds-block"),this.multiselDisplay.show(),this.documentsPane&&this.documentsPane.hide()},onResize:function(){this._logger.log("onResize")},onRefresh:function(){this._logger.log("onRefresh"),this.updateFacet()}});return l});