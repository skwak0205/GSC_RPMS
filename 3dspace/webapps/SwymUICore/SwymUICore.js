define("DS/SwymUICore/script/feature/core/6wtag/model/6wtag-model",["require","exports","UWA/Class/Model"],function(e,t,i){"use strict";return i.extend({})}),define("DS/SwymUICore/script/feature/community/member/collection/member-collection-v2",["DS/SwymUICore/script/feature/core/user/collection/user-and-users-group-collection"],function(e){"use strict";return e.extend({_collectionName:"member-collection-v2",_actionsCollectionClass:null,_addActionsOnModel:!1,init:function(e,t){return t&&(t.hasOwnProperty("actionsCollectionClass")&&(this._actionsCollectionClass=t.actionsCollectionClass),t.hasOwnProperty("addActionsOnModel")&&(this._addActionsOnModel=t.addActionsOnModel)),this._parent.apply(this,arguments)},onAdd:function(e,t){return this._addActionsOnModel&&t===this&&e&&(e.setActionsCollectionClass(this._actionsCollectionClass),e.addActions()),this._parent.apply(this,arguments)},onReset:function(e){var t=this;return this._addActionsOnModel&&e===this&&e.forEach(function(e){e.setActionsCollectionClass(t._actionsCollectionClass),e.addActions()}),this._parent.apply(this,arguments)}})}),define("DS/SwymUICore/script/feature/core/mobile/communication-manager",["UWA/Class","DS/PlatformAPI/PlatformAPI","DS/Logger/Logger"],function(e,t,i){"use strict";var n=window.ds&&"MOBILE"===window.ds.env,o=["notificationReceived","onAppForeground","mediaReady"],s=!1,r=e.singleton({_subscriptionTopics:o,_subscriptionListeners:{},setup:function(){var e=this;this._subscriptionTopics.forEach(function(t){e._subscriptionListeners[t]=[]}),this._subscribeToTopic()},_subscribeToTopic:function(){t.subscribe("wap.mobile.swym",function(e){var t;if(e&&e.action&&this._subscriptionListeners[e.action]){t=this._subscriptionListeners[e.action];for(var i=0;i<t.length;i++)t[i](e.data)}}.bind(this))},listenToNotification:function(e){this._subscriptionListeners&&this._subscriptionListeners.notificationReceived&&this._subscriptionListeners.notificationReceived.push(e)},listenToOnAppForeground:function(e){this._subscriptionListeners&&this._subscriptionListeners.onAppForeground&&this._subscriptionListeners.onAppForeground.push(e)},stopListeningToOnAppForeground:function(e){var t=this._subscriptionListeners&&this._subscriptionListeners.onAppForeground,i=t&&t.indexOf(e);t&&i>=0&&t.splice(i,1)},listenToOnMediaReady:function(e){this._subscriptionListeners&&this._subscriptionListeners.mediaReady&&this._subscriptionListeners.mediaReady.push(e)},stopListeningToOnMediaReady:function(e){var t=this._subscriptionListeners&&this._subscriptionListeners.mediaReady,i=t&&t.indexOf(e);t&&i>=0&&t.splice(i,1)},_publishToTopic:function(e){i.log("Publishing to topic",e),t.publish("wap.mobile.swym",e)},sendOpenMediaRequest:function(e){this._publishToTopic({action:"openMedia",data:e})},sendDownloadMediaRequest:function(e){this._publishToTopic({action:"downloadMedia",data:e})},sendOpenAppRequest:function(e){this._publishToTopic({action:"openApp",data:e})},sendLoginRequest:function(e){this._publishToTopic({action:"requestLogin",data:e})},sendLightboxIsShown:function(){this._publishToTopic({action:"lightboxShown"})},sendLightboxIsHidden:function(){this._publishToTopic({action:"lightboxHidden"})}});return r.NOTIFICATION_RECEIVED="notificationReceived",n&&!s&&(r.setup(),s=!0),r}),define("DS/SwymUICore/script/feature/core/error/error",["require","exports","DS/UWPClientControls/PlatformNotify","i18n!DS/SwymUICore/assets/nls/utils/error"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.displayError=void 0,t.displayError=function(e){e&&e.length>0&&n.hasOwnProperty(e)?i.info(n[e]):i.info(n.Anerrorhasoccured)}}),define("DS/SwymUICore/script/lib/6wpanel/6wtaggable",["UWA/Core","UWA/Class","DS/WebappsUtils/Console"],function(e,t,i){return t.extend({is6wTaggable:!0,resetTaggingSession:function(){},_recomputeTags:function(){},getTags:function(){},onTagCreation:function(e,t){},onTagDeletion:function(e,t){},getSixwURIs:function(){}})}),define("DS/SwymUICore/script/feature/core/config/interapp-communication/manager",["require","exports","DS/PlatformAPI/PlatformAPI","DS/Logger/Logger"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommunicationManager=t.SUBSCRIPTION_TOPICS_ARRAY=t.ON_INITIALIZATION_END=t.CONTEXT_CHANGE_RESPONSE=t.CONTEXT_CHANGE_REQUEST=t.CONTEXT_CHANGE=t.NAVIGATION_REQUEST=t.TOPIC=void 0,t.TOPIC="app.3DSwym",t.NAVIGATION_REQUEST="navigationRequest",t.CONTEXT_CHANGE="contextChange",t.CONTEXT_CHANGE_REQUEST="contextChangeRequest",t.CONTEXT_CHANGE_RESPONSE="contextChangeResponse",t.ON_INITIALIZATION_END="onInitializationEnd",t.SUBSCRIPTION_TOPICS_ARRAY=[t.NAVIGATION_REQUEST,t.CONTEXT_CHANGE_REQUEST];var o=function(){function e(){this._subscriptionTopics=t.SUBSCRIPTION_TOPICS_ARRAY,this._subscriptionListeners={}}return e.prototype.setup=function(){var e=this;this._subscriptionTopics.forEach(function(t){e._subscriptionListeners[t]=[]}),this._subscribeToTopic()},e.prototype._subscribeToTopic=function(){i.subscribe(t.TOPIC,function(e){var t;if(e&&e.action&&this._subscriptionListeners[e.action]){t=this._subscriptionListeners[e.action];for(var i=0;i<t.length;i++)t[i](e.data)}}.bind(this))},e.prototype.listenToNavigationRequest=function(e){this._subscriptionListeners&&this._subscriptionListeners[t.NAVIGATION_REQUEST]&&this._subscriptionListeners[t.NAVIGATION_REQUEST].push(e)},e.prototype.listenToContextChangeRequest=function(e){this._subscriptionListeners&&this._subscriptionListeners[t.CONTEXT_CHANGE_REQUEST]&&this._subscriptionListeners[t.CONTEXT_CHANGE_REQUEST].push(e)},e.prototype.stopListeningToNavigationRequest=function(e){var i=this._subscriptionListeners&&this._subscriptionListeners[t.NAVIGATION_REQUEST],n=i&&i.indexOf(e);i&&n>=0&&i.splice(n,1)},e.prototype._publishToTopic=function(e){n.log("Publishing to topic",e),i.publish(t.TOPIC,e)},e.prototype.sendContextChangeData=function(e,i){void 0===i&&(i=t.CONTEXT_CHANGE);var n={},o={containerId:function(e){return e.communityId},containerType:function(e){return e.dmId?"conversation":"community"},path:function(e){return e.path},quadrant:function(e){return e.quadrant}};Object.keys(o).forEach(function(t){n[t]=o[t](e)}),this._publishToTopic({action:i,data:n})},e.prototype.sendInitializationEndNotification=function(){var e=t.ON_INITIALIZATION_END;this._publishToTopic({action:e,data:{}})},e.getInstance=function(){return e.instance||(e.instance=new e,e.instance.setup()),e.instance},e}();t.CommunicationManager=o}),define("DS/SwymUICore/script/utils/feature-activation-constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.COLLABORATION_GROUP_BETA_NAME=t.PHONE_CALL_GROUP_BETA_NAME=t.ODE_GROUP_BETA_NAME=t.SUGGESTIONS_GROUP_BETA_NAME=t.RDV_GROUP_BETA_NAME=t.FEATURES_ACTIVATED=t.ACTIVATED_BETA_FEATURES=void 0,t.ACTIVATED_BETA_FEATURES={rdv:{isActivated:!1,isCloudOnly:!0,uwpAdminActivationVariableName:"activateRdv"},rdvInConversation:{isActivated:!1,isCloudOnly:!0,uwpAdminActivationVariableName:"activateRdvInConversation"},ritual:{isActivated:!1,isCloudOnly:!0,uwpAdminActivationVariableName:"activateRitual"},odecollab:{isActivated:!0,isCloudOnly:!0,uwpAdminActivationVariableName:"activateODECollab"},wbcollab:{isActivated:!0,isCloudOnly:!0,uwpAdminActivationVariableName:"activateWBCollab"},phoneCall:{isActivated:!1,isCloudOnly:!0,uwpAdminActivationVariableName:"activatePhoneCall"},forwardWiki:{isActivated:!1,isCloudOnly:!0,uwpAdminActivationVariableName:"activateForwardWiki"},workforce:{isActivated:!1,isCloudOnly:!0,uwpAdminActivationVariableName:"activate3DWorkforce"}},t.FEATURES_ACTIVATED={activateUsersGroup:!1,enableBrowserNotifications:!1,activateBots:!1,activateSwymBot:!1,activateConversationTopic:!0,activateM3DETaggerAndSearch:!1,activateM3DENetwork:!0,activateM3DEChannels:!0,activateWestQuadrant:!0,activateCenterQuadrant:!1,activateSouthQuadrant:!0,activateWedo:!0,deactivate3DSpace:!0,activateEastDelegation:!1,activateSwymPrefixForFedsearchQuery:!1,activateSketchCreation:!0,activateStoryCreation:!1,activateNewIdeaTransferProtocol:!0,activateIMSendButton:!0,activateCommentSendButton:!0,activateAnswerSendButton:!0,activateSketchCoreview:!1,activateEditForSketchAndStory:window.ds&&window.ds.isMDE,activateSuggestions:!1,activateTemplate:!0,activate3DOrganization:!1,activateODEEditor:!1,activateODEViewer:!1,activateWikiLock:!1,activateRTOptionsForAllUsersInConversation:!1},t.RDV_GROUP_BETA_NAME="ds-swym-rdv-beta",t.SUGGESTIONS_GROUP_BETA_NAME="ds-swym-suggestions-beta",t.ODE_GROUP_BETA_NAME="ds-swym-ode-beta",t.PHONE_CALL_GROUP_BETA_NAME="ds-swym-phone-call",t.COLLABORATION_GROUP_BETA_NAME="ds-swym-collab"});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/SwymUICore/script/lib/pub-sub",["require","exports","UWA/Core","UWA/Class","UWA/Class/Events","UWA/Class/Listener"],function(e,t,i,n,o,s){"use strict";var r=s.extend(o,{});return function(e){function t(){var t=e.call(this)||this;return t._persistedEvents={},t._eventMgr=new r,t}return __extends(t,e),t.prototype._addEvent=function(e,t,n,o,s,r){var a=this._persistedEvents[e];return!0!==r&&this._eventMgr.addEvent(e,t,n,s),!1!==o&&a?(t.apply(n,i.is(a,"array")?a:[a]),t):(!0===r&&this._eventMgr.addEventOnce(e,t,n,s),!0)},t.prototype._listenTo=function(e,t,i,n,o){return!0===o?this._eventMgr.listenToOnce(e,t,i,n):this._eventMgr.listenTo(e,t,i,n),!0},t.prototype.addEvent=function(e,t,i,n,o){return this._addEvent(e,t,i,n,o,!1)},t.prototype.addEvents=function(e,t,i,n){for(var o in e)e.hasOwnProperty(o)&&this.addEvent(o,e[o],t,i,n)},t.prototype.addEventOnce=function(e,t,i,n,o){return this._addEvent(e,t,i,n,o,!0)},t.prototype.listenTo=function(e,t,i,n){return this._listenTo(e,t,i,n,!1)},t.prototype.listenToOnce=function(e,t,i,n){return this._listenTo(e,t,i,n,!0)},t.prototype.removeEvent=function(e,t,i){return this._eventMgr.removeEvent(e,t,i)},t.prototype.removeEvents=function(e){return this._eventMgr.removeEvents(e)},t.prototype.stopListening=function(e,t,i){return this._eventMgr.stopListening(e,t,i)},t.prototype.dispatchEvent=function(e,t,i){var n=this._eventMgr.dispatchEvent(e,t);return i&&(t=t||[],this._persistedEvents[e]=t),n},t.prototype.removePersisted=function(e){delete this._persistedEvents[e]},t}(n)}),define("DS/SwymUICore/script/feature/core/mobile/utils",["UWA/Promise"],function(e){"use strict";function t(e){return"3dxml"===e.format}var i=["sound","video"];return{shouldBePlayedInLightbox:function(e){return"animatedPicture"!==e&&!this.isFormatNativelyPlayable(e)},isFormatNativelyPlayable:function(e){return i.indexOf(e)>=0},getTransientUrlForAV:function(e){var t=e.get("play->av_streams");return(t&&t[0]||{}).transient_url},getTransientUrlFor3DModel:function(e){var i=e.get("play->3d_streams");return(i&&i.filter(t)[0]||{}).transient_url},getTransientUrlForDocument:function(e){return this.getTransientUrlForDownload(e)},getTransientUrlForDownload:function(e){return e.get("play->download_original_url->transient_url",{escapeHTML:!1})},getExtensionForAV:function(e){var t=e.get("play->av_streams");return(t&&t[0]||{}).format},getExtensionFor3DModel:function(e){var i=e.get("play->3d_streams");return(i&&i.filter(t)[0]||{}).format},getExtensionForDocument:function(e){return this.getExtensionForDownload(e)},getExtensionForDownload:function(e){return e.get("play->download_original_url->format")},getExtension:function(e){var t;switch(e.get("media_type")){case"sound":case"video":t=this.getExtensionForAV(e);break;case"document":t=this.getExtensionForDocument(e);break;case"3d_model":t=this.getExtensionFor3DModel(e)}return t},getTransientUrl:function(e){var t;switch(e.get("media_type")){case"sound":case"video":t=this.getTransientUrlForAV(e);break;case"document":t=this.getTransientUrlForDocument(e);break;case"3d_model":t=this.getExtensionFor3DModel(e)}return t},getWakeUpUrl:function(e){return e.get("play")&&e.get("play").wake_up_url},authenticateForPlayOnNativeMobileDevice:function(t){var i,n,o,s,r=this;return new e(function(e){require(["DS/SwymUICore/script/feature/core/mobile/communication-manager"],function(t){i=t,e()})}).then(function(){return!(n=r.getTransientUrl(t))&&new e(function(e,i){t.fetch({onComplete:e,onFailure:i})})||e.resolve()}).then(function(){n=r.getTransientUrlForDownload(t),o=r.getExtensionForDownload(t),s=r.getWakeUpUrl(t),i.sendOpenMediaRequest({transientURL:n,extension:o,wakeUpUrl:s})}).then(function(){return new e(function(e){i.listenToOnMediaReady(e)})}).then(function(){i.stopListeningToOnMediaReady()})},downloadMediaInNativeMobileDevice:function(e){var t=this;require(["UWA/Promise","DS/SwymUICore/script/feature/core/mobile/communication-manager"],function(i,n){var o,s;(!(o=t.getTransientUrlForDownload(e))&&new i(function(t,i){e.fetch({onComplete:t,onFailure:i})})||i.resolve()).then(function(){o=t.getTransientUrlForDownload(e),s=t.getExtensionForDownload(e),n.sendDownloadMediaRequest({transientURL:o,extension:s})})})},openMediaInNativeMobileDevice:function(e){var t=this;require(["UWA/Promise","DS/SwymUICore/script/feature/core/mobile/communication-manager"],function(i,n){var o,s;(!(o=t.getTransientUrl(e))&&new i(function(t,i){e.fetch({onComplete:t,onFailure:i})})||i.resolve()).then(function(){o=t.getTransientUrl(e),s=t.getExtension(e),n.sendOpenMediaRequest({transientURL:o,extension:s})})})}}}),define("DS/SwymUICore/script/utils/mobile-rte-utils",["UWA/Core","UWA/Class/Events","UWA/Event","UWA/Utils/Client"],function(e,t,i,n){"use strict";function o(e){n.Features.touchEvents&&function(e){var t=i.getElement(e),n=t&&t.getClosest(".layout");n&&setTimeout(function(){n.setStyle("height","90%"),setTimeout(function(){n.setStyle("height","")},100)},100)}(e)}return t.singleton({setupListeners:function(t){return function(t){var i={};i['focusout .cke_editable[contenteditable="true"]']=o,e.extendElement(t).addEvents(i,!1,1)}(t)}}).init()}),define("DS/SwymUICore/script/feature/community/media/editor/model/operation-model",["UWA/Core","UWA/Class/Model","DS/WebappsUtils/Console"],function(e,t,i){return t.extend({_modelName:"operation",_canvas:null,params:null,setup:function(e){this._canvas=e.canvas,this.params=e.params},setCanvas:function(e){this._canvas=e},getCanvas:function(){return this._canvas}})}),define("DS/SwymUICore/script/utils/i18n",function(){"use strict";return{test2:"test2",replace:function(e,t){return e.replace(/\{([\w\-]+)\}/g,function(e,i){return void 0!==t[i]?t[i]:""})}}});var __awaiter=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,s){function r(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,a)}c((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){var i,n,o,s,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,n=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(o=(o=r.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){r=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){r.label=s[1];break}if(6===s[0]&&r.label<o[1]){r.label=o[1],o=s;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(s);break}o[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],n=0}finally{i=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};define("DS/SwymUICore/script/utils/compass-proxy",["require","exports","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/i3DXCompassPlatformServices/i3DXCompassRegistryClient","DS/UWPClientCode/PublicAPI","DS/PlatformAPI/PlatformAPI"],function(e,t,i,n,o,s){"use strict";var r,a,c=null;return{getAllPlatformIdByUserPromise:function(e){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(i){return[2,new Promise(function(i,n){t.getAllPlatformDetailsByUserPromise(e).then(function(e){return i(e.map(function(e){return e.id}))},function(e){return n(e)})})]})})},getAllPlatformDetailsByUserPromise:function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,new Promise(function(t,n){a?Array.isArray(a.platforms)?t(a.platforms.map(function(e){return{id:e.id,displayName:e.name}})):t([{id:a.platforms.id,displayName:a.platforms.name}]):i.getUser({config:e||void 0,onComplete:function(e){a=e,Array.isArray(a.platforms)?t(a.platforms.map(function(e){return{id:e.id,displayName:e.name}})):t([{id:a.platforms.id,displayName:a.platforms.name}])},onFailure:function(e){return n(e)}})})]})})},getCurrentTenantId:function(){return r||(r=s.getTenant()||window.ds.swymTenant||this.getTenantIdFromUrl()),r},getTenantIdFromUrl:function(){return(window.ds&&window.ds.isMDE&&s.getApplicationConfiguration("app.swymfeature.my3dexp.baseurl")?s.getApplicationConfiguration("app.swymfeature.my3dexp.baseurl").toString():window.dsBaseUrl).match(/\/(\w+)/)[1]},getRegistryURL:function(){return c||(c=o.getApplicationConfiguration("app.urls.registry")||s.getApplicationConfiguration("app.urls.registry")?o.getApplicationConfiguration("app.urls.registry")||s.getApplicationConfiguration("app.urls.registry"):this.getMyAppsUrlForRegistry()),c},getMyAppsUrlForRegistry:function(){var e=o.getApplicationConfiguration("app.urls.myapps")||s.getApplicationConfiguration("app.urls.myapps");return e?"".concat(e,"/resources/AppsMngtRegistry/"):null},getPlatformServices:function(e){var t=this;return new Promise(function(o,s){if(t.getRegistryURL()&&!e.forcePlatformServicesAPI){if(!e.platformId&&!e.platforms){var r=new Error("platform is missing");throw s(r),r}if(!e.services){r=new Error("services is missing");throw s(r),r}e&&Array.isArray(e.platforms)&&"onpremise"===e.platforms[0].toLowerCase()&&(e.platforms=["OnPremise"]);var a=e.platforms?e.platforms:[e.platformId],c=e.services;n.getServicesByPlatform({platforms:a,services:c,config:{url:t.getRegistryURL()}}).then(function(i){e.onComplete?t.getAllPlatformDetailsByUserPromise().then(function(t){if(e.platformId){var n={"3DSwym":"",platformId:"",displayName:""};n.displayName=t.find(function(e){return e.id===i[0].id}).displayName,n.platformId=e.platformId,i[0].services.forEach(function(e){var t=c.find(function(t){return t.toUpperCase()===e.id});n[t]=e.url}),e.onComplete(n)}else{var o=[];i.forEach(function(e){var i={"3DSwym":"",platformId:"",displayName:""};i.displayName=t.find(function(t){return t.id===e.id}).displayName,e.services.forEach(function(e){var t=c.find(function(t){return t.toUpperCase()===e.id});i[t]=e.url}),i.platformId=e.id,o.push(i)}),e.onComplete(o)}}):o(i)},function(t){e.onFailure?e.onFailure(t):s(t)})}else e.onComplete?(delete e.forcePlatformServicesAPI,i.getPlatformServices(e)):s(new Error("No Registry Available"))})},getServiceUrl:function(e){if(!e.platformId)throw new Error("platformId is missing");if(!e.serviceName)throw new Error("serviceName is missing");"onpremise"===e.platformId.toLowerCase()&&(e.platformId="OnPremise"),this.getRegistryURL()?n.getServicesByPlatform({platforms:[e.platformId],services:[e.serviceName],config:{url:this.getRegistryURL()}}).then(function(t){if(e.onComplete&&t.length)e.onComplete(t[0].services[0].url);else if(e.onFailure){var i=new Error("No Platform url available");e.onFailure(i)}},function(t){e.onFailure&&e.onFailure(t)}):e.onComplete&&i.getServiceUrl(e)}}}),define("DS/SwymUICore/script/lib/model/generic/subscribable",["require","exports"],function(e,t){"use strict";return{_subjectURI:null,_subServiceUrl:null,_services:{hasCurrentUserSubscribed:{method:"GET",parse:function(){return{}}},subscribe:{method:"POST"},unsubscribe:{method:"DELETE"}},getSubjectURI:function(){throw new Error("This function must be implemented!")},_buildUrl:function(e){this._subServiceUrl="api/user/subscriptions/"+e},hasCurrentUserSubscribed:function(e){var t=this;this._buildUrl(this.getSubjectURI()),this.action("hasCurrentUserSubscribed",{url:this._subServiceUrl,onComplete:function(i,n){t.setCustomProperty("currentUserSubscribed",null!=n.result),e.onComplete(t.getCustomProperty("currentUserSubscribed"))},onFailure:function(){window.require(["DS/UWPClientControls/PlatformNotify","i18n!DS/SwymUICore/assets/nls/lib/model/generic/subscribable"],function(e,t){e.error(t.ServiceNotAvailable)}),e.onFailure(t.getCustomProperty("currentUserSubscribed"))}})},subscribe:function(){var e=this;this._buildUrl(this.getSubjectURI()),this.action("subscribe",{url:this._subServiceUrl,onComplete:function(){e.setCustomProperty("currentUserSubscribed",!0)},onFailure:function(){e.setCustomProperty("currentUserSubscribed",!1)}})},unsubscribe:function(e){var t=this;this._buildUrl(this.getSubjectURI()),this.action("unsubscribe",{url:this._subServiceUrl,onComplete:function(){t.setCustomProperty("currentUserSubscribed",!1)},onFailure:function(){t.setCustomProperty("currentUserSubscribed",!0)}})}}}),define("DS/SwymUICore/script/constants/community-constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TEMP_ID=t.CONTENT=t.CTY_ROLE=t.CTY_CONTENT_LIST_SORT_MODE=t.CTY_CONTENT_LIST_MODE=void 0,function(e){e.WHATSNEW_MODE="WHATSNEW_MODE",e.TIMELINE_MODE="TIMELINE_MODE",e.COMPACTVIEW_MODE="COMPACTVIEW_MODE"}(t.CTY_CONTENT_LIST_MODE||(t.CTY_CONTENT_LIST_MODE={})),function(e){e.CREATION_DATE="CREATION_DATE",e.LATEST_CONTRIBUTIONS_DATE="LATEST_CONTRIBUTIONS_DATE"}(t.CTY_CONTENT_LIST_SORT_MODE||(t.CTY_CONTENT_LIST_SORT_MODE={})),function(e){e[e.SUPERUSER=4]="SUPERUSER",e[e.OWNER=3]="OWNER",e[e.AUTHOR=2]="AUTHOR",e[e.CONTRIBUTOR=1]="CONTRIBUTOR"}(t.CTY_ROLE||(t.CTY_ROLE={})),function(e){e.idea="idea",e.media="media",e.iquestion="iquestion",e.post="post",e.survey="survey",e.wiki="wiki",e.wedo="wedo",e.ritual="ritual",e["social-event"]="social-event",e.message="message",e.instantmessage="instantmessage"}(t.CONTENT||(t.CONTENT={})),function(e){e.TEMP_NODE_ID="TemporaryTreeNodeId"}(t.TEMP_ID||(t.TEMP_ID={}))}),define("DS/SwymUICore/script/utils/es6-utils",["require","exports"],function(e,t){"use strict";return"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),n=1;n<arguments.length;n++){var o=arguments[n];if(null!=o)for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(i[s]=o[s])}return i},writable:!0,configurable:!0}),{Object:Object}}),define("DS/SwymUICore/script/utils/date",["require","exports","DS/UWPClientCode/I18n","UWA/Core","i18n!DS/SwymUICore/assets/nls/utils/date"],function(e,t,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAverageElapsedTime=t.getDateInMilliSec=t.getCurrentDate=t.prettyDate=t.convertISODateIntoUsualDate=t.textDate=t.simpleHour=t.prettyHour=t.prettyDay=t.conciseDay=t.simpleDay=t.convertDateAndKeepSwymFormat=t.convertDate=t.simpleDate=void 0;var s=/(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(\.(\d{3}))?Z/;function r(){var e;try{e=window.dsLang||window.top.dsLang}catch(t){e=i.getCurrentLanguage()}return e}function a(e,t){return new Date(u(e)-6e4*(new Date).getTimezoneOffset())}function c(e){if("string"==typeof e&&e.match(/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z)/)){var t=new Date(new Date(e).getTime());t&&t.toISOString()&&(e=t.toISOString().split("T")[0]+" "+t.toISOString().split("T")[1].split(".")[0])}return e}function u(e){var t,i=0;if(!e)return null;if("string"==typeof e&&e.match(/(\/|&#x2F;)/g)&&(e=e.replace("-"," ").replace(/(\/|&#x2F;)/g,"-")),(t=e.match(s))&&(e=e.replace("T"," ").replace(/.\d{3}Z$/,""),i=parseInt(t[t.length-1],10)),"-"!=e.substring(4,5)||"-"!=e.substring(7,8)||" "!=e.substring(10,11)||":"!=e.substring(13,14)||":"!=e.substring(16,17))return null;var n=e.split(" "),o=n[0].split("-"),r=n[1].split(":"),a=new Date;return a.setFullYear(o[0]),a.setMonth(o[1]-1),a.setDate(o[2]),a.setHours(r[0]),a.setMinutes(r[1]),a.setSeconds(r[2]),a.setMilliseconds(i),a.getTime()}t.simpleDate=function(e,t){var i;n.is(e,"number")?i=new Date(e+6e4*(new Date).getTimezoneOffset()):n.is(e,"string")&&e.endsWith("Z")?i=new Date(e):(i=new Date(u(e)),i=new Date(i.getTime()-6e4*(new Date).getTimezoneOffset()));var o=t||r();return o||(o="en"),i.toLocaleDateString(o,{day:"2-digit",month:"2-digit",year:"numeric"}).replace(/\//g,"-")+" "+i.toLocaleTimeString(o,{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})},t.convertDate=a,t.convertDateAndKeepSwymFormat=function(e){return c(a(e).toISOString())},t.simpleDay=function(e){var t=r(),i=new Date(e).toLocaleDateString(t,{day:"numeric",month:"long"}).replace(/\//g,"-");return(new Date).toLocaleDateString(t,{day:"numeric",month:"long"}).replace(/\//g,"-")===i?o.Today:i},t.conciseDay=function(e){var t=new Date(e);return t.toLocaleString("UTC",{year:"numeric"})+"-"+t.toLocaleString("UTC",{month:"2-digit"})+"-"+t.toLocaleString("UTC",{day:"2-digit"})},t.prettyDay=function(e){var t=r(),i=new Date(e),n=i.getFullYear()===(new Date).getFullYear()?{weekday:"long",month:"long",day:"numeric"}:{weekday:"long",year:"numeric",month:"long",day:"numeric"};return i.toLocaleDateString(t,n)},t.prettyHour=function(e){var t=r(),i=new Date(e);return new Intl.DateTimeFormat(t,{hour:"numeric",minute:"numeric"}).format(i)},t.simpleHour=function(e){return new Date(u(e)-6e4*(new Date).getTimezoneOffset()).toLocaleTimeString(r(),{hour:"2-digit",minute:"2-digit"})},t.textDate=function(e){var t,i=new Array(12);i[0]=o.Jan,i[1]=o.Feb,i[2]=o.Mar,i[3]=o.Apr,i[4]=o.May,i[5]=o.Jun,i[6]=o.Jul,i[7]=o.Aug,i[8]=o.Sep,i[9]=o.Oct,i[10]=o.Nov,i[11]=o.Dec,"object"!=typeof e?(String(e).indexOf("-")>=0&&(t=e.replace(/-/gi,"/")),t=new Date((t||"").replace(/-/g,"/").replace(/[TZ]/g," "))):t=e;var n=t.getFullYear();return n=n.toString(),[i[t.getMonth()]," ",n].join("")},t.convertISODateIntoUsualDate=c,t.prettyDate=function(e){if(!e)return o.justnow;if("string"==typeof e&&e.match(/(\/|&#x2F;)/g)&&(e=e.replace("-"," ").replace(/(\/|&#x2F;)/g,"-")),"string"==typeof e&&e.match(s)){var t=new Date(new Date(e).getTime());t&&t.toISOString()&&(e=t.toISOString().split("T")[0]+" "+t.toISOString().split("T")[1].split(".")[0])}var n,r=u(e+":00"),a=new Date((new Date).valueOf()+6e4*(new Date).getTimezoneOffset()).getTime(),c=r>a,l=(a-r)/1e3;if(c&&(l=-l),n=Math.floor(l/86400),isNaN(n)||n<0)return o.justnow;if(n>=31){var d=new Date(r),m=d.getDate(),h=d.getMonth()+1;return[d.getFullYear(),"-",h=h<10?"0"+h:h,"-",m=m<10?"0"+m:m].join("")}if(!c)return 0===n&&(l<60&&o.justnow||l<120&&o.oneminago||l<3600&&i.replace(o.minutesCountminsago,{minutesCount:Math.floor(l/60)})||l<7200&&o.onehrago||l<86400&&1===Math.floor(l/3600)&&o.onehrago||l<86400&&i.replace(o.hoursCounthrsago,{hoursCount:Math.floor(l/3600)}))||1==n&&o.yesterday||n<7&&i.replace(o.daysCountdaysago,{daysCount:n})||n<31&&1==Math.ceil(n/7)&&i.replace(o.weekCountweekago,{weeksCount:Math.ceil(n/7)})||n<31&&Math.ceil(n/7)>1&&i.replace(o.weeksCountweekago,{weeksCount:Math.ceil(n/7)});if(0===n){if(l<60)return o.justnow;if(l<120)return o.in1min;if(l<3600)return i.replace(o.inminutesCountmins,{minutesCount:Math.floor(l/60)});if(l<86400)return i.replace(o.inhoursCounthrs,{hoursCount:Math.floor(l/3600)})}if(1==n)return o.tomorrow;if(n<7)return i.replace(o.daysCountdays,{daysCount:n});if(n<31){if(1==Math.ceil(n/7))return i.replace(o.weeksCountweek,{weeksCount:Math.ceil(n/7)});if(Math.ceil(n/7)>1)return i.replace(o.weeksCountweeks,{weeksCount:Math.ceil(n/7)})}},t.getCurrentDate=function(){var e=new Date((new Date).valueOf()+6e4*(new Date).getTimezoneOffset());return e=[e.getFullYear(),e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,e.getDate()<10?"0"+e.getDate():e.getDate()].join("-")+" "+[e.getHours()<10?"0"+e.getHours():e.getHours(),e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds()].join(":")},t.getDateInMilliSec=u,t.getAverageElapsedTime=function(e){var t="-";if(e>0){var i=Math.round(e/31557600),n=Math.round(e/2592e3-12*i),s=Math.round(e/604800-4*n),r=Math.round(e/86400-7*s),a=Math.round(e/3600-24*r),c=Math.round(e/60-60*a),u=Math.round(e-60*c);i<1?n<1?s<1?r<1?a<1?c<1?t=u<1?"-":u+" "+(u>1?o.seconds:o.second):(u>30&&c++,t=c+" "+(c>1?o.minutes:o.minute)):(c>30&&a++,t=a+" "+(a>1?o.hours:o.hour)):(a>12&&r++,t=r+" "+(r>1?o.days:o.day)):(r>3&&s++,t=s+" "+(s>1?o.weeks:o.week)):(s>2&&n++,t=n+" "+(n>1?o.months:o.month)):(n>6&&i++,t=i+" "+(i>1?o.years:o.year))}return t}}),define("DS/SwymUICore/script/feature/core/config/environments",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}),define("DS/SwymUICore/script/utils/ts-utils",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeMixins=t.applyMixins=void 0,t.applyMixins=function(e,t){t.forEach(function(t){Object.getOwnPropertyNames(t.prototype).forEach(function(i){Object.defineProperty(e.prototype,i,Object.getOwnPropertyDescriptor(t.prototype,i))})})},t.mergeMixins=function(e,t){t.forEach(function(t){Object.getOwnPropertyNames(t.prototype).forEach(function(i){e.prototype[i]||Object.defineProperty(e.prototype,i,Object.getOwnPropertyDescriptor(t.prototype,i))})})}});var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};__awaiter=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,s){function r(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,a)}c((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){var i,n,o,s,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,n=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(o=(o=r.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){r=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){r.label=s[1];break}if(6===s[0]&&r.label<o[1]){r.label=o[1],o=s;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(s);break}o[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],n=0}finally{i=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};define("DS/SwymUICore/script/utils/exalead-interceptor",["require","exports"],function(e,t){"use strict";return{_exaleadModesInRead:["latestContributions"],fetchPage:function(e,t){return __awaiter(this,void 0,void 0,function(){var i,n,o,s,r,a;return __generator(this,function(c){switch(c.label){case 0:t||(t={}),i=t.serviceName||this.lastCalledService||"read",n=this._parent,o=!1,c.label=1;case 1:return c.trys.push([1,5,,6]),t.data&&t.data.query&&"#all"!==t.data.query?(o=!1,[3,4]):[3,2];case 2:return"filter"===i||this._exaleadModesInRead.indexOf(this.mode)>-1?[4,this.checkStats(t.data)]:[3,4];case 3:o=c.sent(),c.label=4;case 4:return[3,6];case 5:return s=c.sent(),console.error("CHECKSTATS FAILED",s),[3,6];case 6:return o&&((r=new Date).setFullYear(r.getFullYear()-1),a=r.toISOString(),t.data=__assign(__assign({},t.data),{query:'[ds6w:modified]>="'.concat(a,'"')})),[2,n.call(this,e,t)]}})})},checkStats:function(e){var t=this;return new Promise(function(i,n){window.require(["DS/SwymUICore/script/lib/request/data"],function(o){var s=e&&e.contentType,r=null;s&&(r=s.split("+")),o.request({url:"/api/exalead/searchstats",method:"POST",data:{community_id:t.communityId,content_type:r||(t.exaleadContentType?[t.exaleadContentType]:null)},onComplete:function(e){i(e.limitedResults)},onFailure:n})})})}}}),define("DS/SwymUICore/script/feature/core/mobile/app-foreground-subscriber-mixin",["DS/SwymUICore/script/feature/core/mobile/communication-manager"],function(e){"use strict";return{init:function(){return this.onAppBroughtToForeground&&(this.onAppBroughtToForegroundBound=this.onAppBroughtToForeground.bind(this),e.listenToOnAppForeground(this.onAppBroughtToForegroundBound)),this._previous.apply(this,arguments)},destroy:function(){return this.onAppBroughtToForegroundBound&&e.stopListeningToOnAppForeground(this.onAppBroughtToForegroundBound),this._previous.apply(this,arguments)}}}),define("DS/SwymUICore/script/feature/community/media/editor/collection/operation-collection",["UWA/Core","UWA/Class/Collection","DS/SwymUICore/script/feature/community/media/editor/model/operation-model","DS/WebappsUtils/Console"],function(e,t,i,n){return t.extend({model:i,resetCollection:function(e){0===e&&e++;var t=this.slice(0,e);this.reset(t)},getOperationsAfterBrightness:function(e){var t=this.slice(e,this.length);return this.remove(t),t}})}),define("DS/SwymUICore/script/lib/6wpanel/utils",["require","exports","DS/Logger/Logger","UWA/Core","UWA/String","DS/SwymUICore/script/utils/date"],function(e,t,i,n,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTagFilterForMedia=t.getTagNavigatorFiltersForModel=t.get6WTagsFromHTML=t.parseSearchResult=t.requestLegacyFormatForExaleadSearches=t.getExaleadFiltersFromTagger=t.extractTagsFromExaleadSingleResult=t.extractExplicitTagsFromTaggerResponseForSingleSubject=t.extractTagsFromExaleadResponse=t.reformatFilters=t.processTagAttribute=void 0;var r="xsd:",a=/^xsd:/,c="ds6w",u="ds6w:what",l="&#47;";function d(e){return e.replace(/:/g,"_58_").replace(/\//g,"_47_")}function m(e){var t,i,o,s,a,u,m,h="",p=[];if(e)for(m in e)if(e.hasOwnProperty(m))for(a=e[m].length,s=0;s<a;s++){if(i=(u=e[m][s]).type,o=u.object,t=r+i,"date"!==i)Array.isArray(o)?(o.forEach(function(e,t){o[t]=e.replace(/\//g,l)}),o=o.join("/")):o=o.replace(/\//g,l);else if(0===m.indexOf("sixw:ds6w:when/")&&"object"===n.typeOf(o)){o.from&&(h+="".concat(""!==h?" AND ":"","(").concat(d(m.replace("sixw:ds6w:when/","")),">=").concat(o.from,")")),o.to&&(h+="".concat(""!==h?" AND ":"","(").concat(d(m.replace("sixw:ds6w:when/","")),"<=").concat(o.to,")"));continue}p.push("f/".concat(c).concat(d("/".concat(m)),"/").concat(t,"/").concat(o))}return{queryPart:h,refineParam:p}}function h(e,t,i,n){var o,s,r,c,u,l,d,m,p,g=t.categories;if(g&&g.length>0)for(r=0,c=g.length;r<c;r++)e=h(e,g[r],i,n);else{for(p=[],u=-1,r=2,c=(m=t.fullPath.split("/")).length;r<c;r++){switch(d=m[r]){case"implicit":case"explicit":u=r;break;default:p.push(d)}if(u>0)break}s=p.join("/"),o=m[u+1],l=n>u+1?t.fullPath.replace("".concat(i,"/"),"").split("/"):m.splice(u+2),"string"==typeof o&&("date"===(o=o.replace(a,""))?l=l.join("/"):(l.forEach(function(e,t){l[t]=e.replace(/&#47;/g,"/")}),1===l.length&&(l=l[0]))),e.push({sixw:s,object:l,type:o,count:parseInt(t.count,10)})}return e}t.processTagAttribute=function(e,t,i,n){var o,r,c,l,d,m,h;if(n="array"===n?"array":"object",e)for("array"===n?i=i||[]:(i=i||{})[e]=i[e]||[],o=0,r=t.length;o<r;o++)d=(m=t[o]).predicate?m.predicate:u,"date"===(c="string"==typeof m.type?m.type.replace(a,""):null)?(l=[(l=new Date(s.getDateInMilliSec(m.tag))).getFullYear(),l.getMonth()+1,l.getDate()].join("/"),c="string"):((l=Array.isArray(m.tag)?m.tag:String(m.tag).split("/")).forEach(function(e,t){l[t]=e.replace(/&#47;/g,"/")}),1===l.length&&(l=l[0])),0!==l.length&&(h={object:l,sixw:d,type:c,subjectURI:e},"array"===n?i.push(h):i[e].push(h));return i},t.reformatFilters=function(e){var t,i=!0;if(n.is(e,"object")&&n.is(e.allfilters,"object")){for(t in e.allfilters)if(e.allfilters.hasOwnProperty(t)){i=!1;break}}else i=!0;return!1===i?m(e.allfilters):{queryPart:"",refineParam:[]}},t.extractTagsFromExaleadResponse=function(e){var t,n,o,s,r;if(e&&void 0!==e.groups){for(s=[],t=0,n=(r=e.groups).length;t<n;t++)(o=r[t]).id.substring(0,4)===c&&(s=h(s,o,o.root,o.root.split("/").length));return s}return i.error("Invalid arguments"),[]},t.extractExplicitTagsFromTaggerResponseForSingleSubject=function(e){return e.data[0]&&e.data[0].tag.map(function(e){return{predicate:e.predicate,tag:e.object.literal,id:e.id}})},t.extractTagsFromExaleadSingleResult=function(e){return this.extractTagsFromExaleadResponse(e)},t.getExaleadFiltersFromTagger=function(e){if(e&&"function"==typeof e.getFilters)return m(e.getFilters());throw new Error("Invalid arguments")},t.requestLegacyFormatForExaleadSearches=function(){return!1},t.parseSearchResult=function(e){var t,i,n,o,s,r,a,c,u=[],l=e.hits;if(Array.isArray(l))for(t=0,n=l.length;t<n;t++){for(c=(s=l[t]).metas,r={source:s.source},i=0,o=c.length;i<o;i++)r[(a=c[i]).name]=a.value;u.push(r)}return u},t.get6WTagsFromHTML=function(e){var t={};switch(n.typeOf(e)){case"string":e=n.createElement("div",{html:e});break;case"element":n.extendElement(e);break;default:throw new Error("The HTML content is invalid!")}return e.getElements("a.s6m-tag-link[data-predicate]").forEach(function(e){var i=e.dataset,n=i.predicate,o=i.tagValue||e.getText(),s="".concat(n,"/").concat(o);t[s]={predicate:n,object:o}}),t},t.getTagNavigatorFiltersForModel=function(e,t){var i=[],n={};switch(e){case"post":case"idea":case"survey":i=[o.ucfirst(e)];break;case"iquestion":i=["Question"];break;case"media":i=["Picture","AnimatedPicture","Document","Sound","Video","3dModel","Drawing","SimulationMedia","Story","Sketch","Whiteboard"];break;case"wiki":i=["WikitreePage"];break;case"wedo":i=["WeDo"];break;case"social-event":i=["Conference"]}return n["ds6w:what/".concat(!0===t?"swym:eventSubjectType":"ds6w:type")]=i.map(function(e){return{object:"swym:".concat(e),type:"string",disptext:e}}),n},t.getTagFilterForMedia=function(e){return"f/ds6w_47_ds6w_58_what_47_ds6w_58_type/xsd:string/swym:".concat(e)}}),define("DS/SwymUICore/script/utils/platform-utils",["require","exports","DS/UWPClientCode/PublicAPI","DS/PlatformAPI/PlatformAPI","DS/WAFData/WAFData","DS/SwymUICore/script/utils/compass-proxy","DS/Logger/Logger"],function(e,t,i,n,o,s,r){"use strict";var a=null,c=null,u=null,l=null;return{get3DDriveURL:function(e,t,i){s.getServiceUrl({serviceName:"3DDrive",platformId:e,onComplete:function(e){t(e)},onFailure:i})},get3DCommentURL:function(e,t,i){s.getServiceUrl({serviceName:"3DComment",platformId:e,onComplete:function(e){t(e)},onFailure:i})},getCsrfToken:function(e,t,i){return window.ds&&"MOBILE"===window.ds.env?t["x-ds-swym-csrftoken"]:e.getResponseHeader(i||"x-ds-swym-csrftoken")},get3DDriveCSRFToken:function(e,t,i){var n=this;n.get3DDriveURL(e,function(s){o.authenticatedRequest("".concat(s,"/resources/3ddrive/v1/bos/DSROOT?tenant=").concat(e),{method:"GET",type:"json",headers:{Accept:"application/json;charset=UTF-8","Content-Type":"application/json;charset=UTF-8"},onComplete:function(e,i,o){t(n.getCsrfToken(o,i,"X-DS-CSRFTOKEN"))},onFailure:i})})},get3DPassportCSRFToken:function(e,t){var i,n=this;this.getPassportURLPromise().then(function(s){i=s,o.authenticatedRequest("".concat(i,"/api/authenticated/user/fields"),{method:"GET",timeout:6e4,headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(t,i,o){e(n.getCsrfToken(o,i,"X-DS-IAM-CSRFTOKEN"))},onFailure:t})})},get3DSpaceUrl:function(e){return new Promise(function(t){a?t(a):s.getServiceUrl({serviceName:"3DSpace",platformId:e,onComplete:function(e){e?a=e:r.error("There is no 3dspace url returned by CompassProxy.getServiceUrl",e),t(a)},onFailure:function(e){r.error("Error on CompassProxy.getServiceUrl",e)}})})},getPassportURLPromise:function(){return new Promise(function(e){if(u)e(u);else{var t=s.getCurrentTenantId();s.getPlatformServices({platforms:[t],services:["3dpassport"]}).then(function(t){t.length?(u=t[0].services[0].url,e(u)):r.error("There is no passport url returned by I3DXCompassRegistryClient.getServicesByPlatform",t)},function(t){r.error("Error on I3DXCompassRegistryClient.getServicesByPlatform",t),u=window.ds&&"3DD"===window.ds.env?n.getApplicationConfiguration("app.urls.passport"):i.getApplicationConfiguration("app.urls.passport"),e(u)})}})},getPassportVersion:function(){return"3DD"===window.ds.env?n.getApplicationConfiguration("app.urls.passport.version"):i.getApplicationConfiguration("app.urls.passport.version")},getMyAppsURLPromise:function(){return new Promise(function(e){if(l)e(l);else{var t=s.getCurrentTenantId();s.getPlatformServices({platforms:[t],services:["3DCompass"]}).then(function(t){t.length?(l=t[0].services[0].url,e(l)):r.error("There is no myApps url returned by I3DXCompassRegistryClient.getServicesByPlatform",t)},function(t){r.error("Error on I3DXCompassRegistryClient.getServicesByPlatform",t),l=window.ds&&"3DD"===window.ds.env?n.getApplicationConfiguration("app.urls.myapps"):i.getApplicationConfiguration("app.urls.myapps"),e(l)})}})},getFedsearchURL:function(e){return new Promise(function(t,i){c?t(c):s.getServiceUrl({serviceName:"3DSearch",platformId:e,onComplete:function(e){e?c=e:r.error("There is no fedsearch url returned by CompassProxy.getServiceUrl",e),t(c)},onFailure:i})})},resetAllPlatformsURL:function(){a=null,c=null,u=null}}}),define("DS/SwymUICore/script/utils/routing",["require","exports","DS/UWPClientCode/PublicAPI","DS/PlatformAPI/PlatformAPI","DS/SwymUICore/script/utils/platform-utils","UWA/Utils"],function(e,t,i,n,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPathNameFromUrl=t.requireAuthentication=t.isAuthenticationCheckRequired=t.hasPublicPage=t.isSocial=t.isPublic=t.getPublicPageBaseUrl=t.getSocialPageBaseUrl=t.getSocialRedirectUrl=t.getSwymAPIUrl=t.getMDEUrl=t.getSwymUrl=t.initSwymAPIUrl=t.ROUTES=t.PRIVATE=t.PUBLIC=t.HASH_REGEX=t.QUERY_REGEX=t.PATH_REGEX=t.WELCOME=t.SOCIAL=void 0,t.SOCIAL="social",t.WELCOME="welcome",t.PATH_REGEX=/^\/[^#?]+/,t.QUERY_REGEX=/\?[^#]+/,t.HASH_REGEX=/#[^?]+/,t.PUBLIC="public",t.PRIVATE="private",t.ROUTES=[{path:t.SOCIAL,access:t.PRIVATE,card:"Social",defaultPage:!1},{path:t.WELCOME,access:t.PUBLIC,card:"Welcome Page",defaultPage:!0}];var r,a=window.dsBaseUrl||window.location.protocol+"//"+window.location.host+window.location.pathname,c=a&&"/"===a.slice(-1)?a.substring(0,a.length-1):a,u=c,l=window.ds&&"3DD"===window.ds.env?null:c;function d(){return!(!window.ds||!window.ds.isMDE)}t.initSwymAPIUrl=function(e){var n=null,o=(new RegExp("/"+t.SOCIAL+".*"),new RegExp("/"+t.WELCOME+".*"),i.getApplicationConfiguration("app.swymfeature.my3dexp.baseurl"));window.ds&&window.ds.isMDE&&o?(r=o,console.info("PublicAPIBaseUrl used /!\\:",r)):window.widget&&window.widget.getValue("v2BaseUrl")?(r=window.widget.getValue("v2BaseUrl"),console.info("v2BaseUrl used /!\\:",r)):(n=s.getQueryString(window.location.href,"v2BaseUrl"))?(r=n,console.info("v2BaseUrl used /!\\:",r)):r=e||(window.ds&&window.ds.isMDE?a.replace("my3dexperience","3dswym"):a),r&&"/"===r.slice(-1)&&(r=r.substring(0,r.length-1)),window.ds&&"3DD"===window.ds.env&&(l=r)},t.getSwymUrl=function(){return l},t.getMDEUrl=function(){return u},t.getSwymAPIUrl=function(){return r},t.getSocialRedirectUrl=function(e,i){var n,o=(n=e.match(t.QUERY_REGEX))&&n[0],s=(n=e.match(t.QUERY_REGEX))&&n[0];return[i,"/"+t.SOCIAL,s,o].join("")},t.getSocialPageBaseUrl=function(){return window.ds&&window.ds.isMDE?"".concat(u,"/").concat(t.SOCIAL):l},t.getPublicPageBaseUrl=function(){return window.ds&&window.ds.isMDE?"".concat(u,"/").concat(t.WELCOME):""},t.isPublic=function(e){var i=e&&"/"===e.substr(0,1)?e.substr(1):e,n=i&&t.ROUTES.find(function(e){return 0===i.indexOf(e.path)});return!(!n||n.access!==t.PUBLIC)},t.isSocial=function(e){return 0===(e&&"/"===e.substr(0,1)?e.substr(1):e).indexOf(t.SOCIAL)},t.hasPublicPage=function(){return!!t.ROUTES.find(function(e){return e.access===t.PUBLIC})},t.isAuthenticationCheckRequired=d,t.requireAuthentication=function(e){var t=n.getUser(),i=e||document.location.href;return!(!d()||t.login||("MOBILE"===window.ds.env?window.require(["DS/SwymUICore/script/feature/core/mobile/communication-manager","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/core/context/context-constants"],function(e,t,n){var o=t.getInstance(),s={};s[n.NORTH_QUADRANT]="north",s[n.CENTER_QUADRANT]="play";var r=i.includes("#")?i.split("#")[1]:i,a=o.extractContextInfoFromRoute(r),c=s[a.quadrant]?s[a.quadrant]:a.quadrant;e.sendLoginRequest({quadrant:c})}):o.getPassportURLPromise().then(function(e){document.location.replace(e+"/login?service="+encodeURIComponent(i))}),0))},t.getPathNameFromUrl=function(e){var i,n=null,o=window.ds&&window.ds.isMDE?u:l,s=o&&o.length;return o&&0===e.indexOf(o)&&e.length>s&&(n=(i=e.substr(s).match(t.PATH_REGEX))&&i[0]),n}}),define("DS/SwymUICore/script/lib/event-manager",["UWA/Core","UWA/Class","DS/SwymUICore/script/lib/pub-sub"],(e,t,i)=>i.singleton({eventsWhitelist:["requestContentListUpdate","onBeforeCKEditorLoad","onAfterCKEditorLoad","onTaggerFilteringRequest","onAddTagFilteringRequest","onRemoveTagFilteringRequest","onSidePanelExpand","onSidePanelCollapse","onCommunityMembersUpdate","onCreateProxyManager","onThreadUnreadStatusChange","onAccordionClick","onEventReply","onCreationFailed","onContentCreationExpand","onCommunitySelected","commentIconClickedInCompactView","switchToReportMode"],isEventWhitelisted(e){if(this.eventsWhitelist.indexOf(e)>=0)return!0;throw new Error(`The event ${e} is not supported by this event manager. Please add it to the events whitelist.`)},_addEvent(e){if(this.isEventWhitelisted(e))return this._parent.apply(this,arguments)},dispatchEvent(e){if(this.isEventWhitelisted(e))return this._parent.apply(this,arguments)}})),define("DS/SwymUICore/script/feature/core/history/history-model",["require","exports","UWA/Core","DS/SwymUICore/script/lib/pub-sub"],function(e,t,i,n){"use strict";function o(){return window.ds&&"3DSwym"===window.ds.env}var s=window.history,r=null,a=null,c=null,u=null,l=null,d=n.singleton({getStateListing:function(){return a?i.clone(a.stateObject):null},getState:function(){return o()?s.state:r?i.clone(r.stateObject):null},pushState:function(e,t,n,d){var m,h=d.isPreviousPathAListing();if(!e||!e.previousContext)throw new Error("A state object needs to be provided and should contain a previousContext");m=i.clone(e),o()?s.pushState(m,t,n):r={stateObject:m,title:t,url:n},!u&&n.match("#search:")&&(l=i.clone(a),u={stateObject:m,title:t,url:n}),h&&(c=i.clone(a),a={stateObject:m,title:t,url:n}),this.dispatchEvent("onHistoryStateChange",[m,t,n],!0)},backToListing:function(){window.require(["DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/feature/core/context/context-model"],function(e,t){var i,n;a?(i=a&&a.stateObject&&a.stateObject.previousContext,(n=t.getInstance()).path!==i.path?n.reset(i,{}):e.goToQuadrantHome()):e.goToQuadrantHome()})},back:function(){window.require(["DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/feature/core/context/context-model"],function(e,t){var i,n,u,l=t.getInstance();o()?(u=d.getState())&&u.previousContext?s.back():e.goToUrl(e.HOME):r?(i=r&&r.stateObject&&r.stateObject.previousContext,n=c&&c.stateObject&&c.stateObject.previousContext,i.path||(i.path="home"),i.contentId&&l.contentId&&l.contentId!==i.contentId&&(n=a&&a.stateObject&&a.stateObject.previousContext),l.reset(i,{previousAttributes:n})):e.goToUrl(e.HOME)})},backToContextBeforeSearch:function(){window.require(["DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUIComponents/script/utils/content-creation-types-manager"],function(e,t){var i=u&&u.stateObject&&u.stateObject.previousContext,n=l&&l.stateObject&&l.stateObject.previousContext;"social-event"===t.getInstance().getCurrentContentType()&&(n=null),e.getInstance().reset(i,{previousAttributes:n}),l=null,u=null})}});return d}),define("DS/SwymUICore/script/feature/core/favorite/abstract-favorite-manager",["UWA/Promise","DS/SwymUICore/script/lib/pub-sub"],function(e,t){"use strict";return t.extend({_collection:null,_modelClass:null,getFavorites:function(t,i){var n=this;return new e(function(e,o){t&&i?n._collection.fetch({data:{page:t,limit:i},onComplete:function(t){n.dispatchEvent("onCollectionFetched"),e(t)},onFailure:function(){o(!1)}}):n._collection?e(n._collection):n.addEventOnce("onCollectionFetched",function(){e(n._collection)})})},onRemove:function(t,i){var n=this;return new e(function(e,o){new n._modelClass({mid:t,external_id:t}).remove({data:{mid:t,external_id:t},onComplete:function(o){n._collection.remove(o.get("id")),n.dispatchEvent("onFavoriteRemoved",t),!i&&n.dispatchEvent("onFavoriteRemovedExternalView",t),e(o)},onFailure:function(){o(!1)}})})},onChange:function(t,i,n,o){var s=this;return new e(function(e,r){new s._modelClass({mid:t}).save({external_id:t,position:i>=0?i+1:null,title:n||""},{onComplete:function(i){s._collection.add(i),s.dispatchEvent("onFavoriteAdded",t),!o&&s.dispatchEvent("onFavoriteAddedExternalView",t),e(i)},onFailure:function(){r(!1)}})})},isFavorite:function(e){},isFavoriteSync:function(e){return!!this._collection.findWhere({mid:e})}})}),define("DS/SwymUICore/script/lib/view/generic/img-view",["DS/SwymUICore/script/lib/view/generic/swym-model-view"],function(e){return e.extend({_imageRenderingOptions:null,name:"img-view",setup:function(e){return e&&e.imageRenderingOptions&&(this._imageRenderingOptions=e.imageRenderingOptions),this._parent.apply(this,arguments)},setWidget:function(e){return e?this._parent.apply(this,arguments):this}})}),define("DS/SwymUICore/script/feature/core/suggestion/collection/suggestions-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/mixed-collection"],function(e,t){"use strict";return t.extend({_collectionName:"suggestion-collection",_services:{read:{recommendation:{url:"api/recommendation/posts",method:"GET",dataFn:function(){return{limit:this._limit}}}}},modes:["recommendation"]})}),define("DS/SwymUICore/sharefromcatia-init",["UWA/Class/Promise","DS/SwymUICore/script/feature/core/config/bootstrap-model"],function(e,t){"use strict";var i={},n=function(){var i=e.deferred(),n=t.getInstance();return n.initialize(),n.addEventOnce("onSync",function(){i.resolve()}),i.promise};return i.start=function(){var t=e.deferred();return e.resolve().then(n).then(t.resolve),t.promise},i});__extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/SwymUICore/script/feature/core/realtime/realtime-updates-manager",["require","exports","DS/SwymUICore/script/lib/pub-sub","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/PlatformAPI/PlatformAPI","DS/Logger/Logger"],function(e,t,i,n,o,s){"use strict";var r,a={instance:null,topics:{GENERIC_NOTIF_TOPIC:"intf-ws-topic",PUSH_3DNOTIFICATION_TOPIC:"pushto3dnotification",REALTIME_NEW_CONTENT_UPDATE_TOPIC:null}},c=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.setup=function(){var e=n.getInstance();this.tenantOID=e&&e.get("config")&&e.get("config").tenant&&e.get("config").tenant.online_instance_id,r="tenant_"+this.tenantOID+"_new_message",a.topics&&(a.topics.REALTIME_NEW_CONTENT_UPDATE_TOPIC=r),this.setupSecurityTokenExchange(),this.subscribeToRealtimeContentUpdates()},i.prototype.setupSecurityTokenExchange=function(){var e=this;o.publish("pushto3dnotification",{method:"pushplatformid",data:{provider:"3dswym",data:e.tenantOID}}),o.subscribe("intf-ws-topic",function(t){s.log("instantMessagingData",t),t&&"ready"===t.event&&o.publish("pushto3dnotification",{method:"pushplatformid",data:{provider:"3dswym",data:e.tenantOID}})})},i.prototype.subscribeToRealtimeContentUpdates=function(){var t=this;o.subscribe(r,function(i){s.log("newContentUpdateData",i),"INTERNAL_CONTENT"===i.message_type&&(t.dispatchEvent("contentPublished",i),e(["DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/feature/community/wiki/model/wiki-model"],function(e,t){e.getInstanceFetched(function(e){e.get("login")!==i.triggered_by&&new t({id:i.message_details.model_id}).set("outdated",!0)})}))})},i}(i);return a.instance=new c,a});__extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/SwymUICore/script/feature/core/notification/notification-manager",["require","exports","UWA/Class","UWA/String","DS/PlatformAPI/PlatformAPI","DS/SwymUICore/script/utils/navigation"],function(e,t,i,n,o,s){"use strict";var r=window.ds&&"MOBILE"===window.ds.env,a={conference:"social-event"};return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.setup=function(){var e=this.listenToNotifications.bind(this);o.subscribe("common.3DNotification.topic",e),r&&window.require(["DS/SwymUICore/script/feature/core/mobile/communication-manager"],function(t){t.listenToNotification(e)})},t.prototype.listenToNotifications=function(e){var t;switch((t=r?e:this._extractNotifData(e.data.url)).appName){case"X3DMCTY_AP":if(t.contentId)if("instantmessage"===t.modelName)"dm"===t.communityType?s.goToDM(t.communityId,void 0,void 0,{messageUuid:t.messageId}):s.goToCommunity(t.communityId,void 0,void 0,!1,{messageUuid:t.messageId});else{var i=t.modelName;i&&a[i]&&(i=a[i]),s.goToContent(t.contentId,i,t.communityId,!1,t.commentUri,t.replyUri,void 0,t.answerUri?{answerUri:t.answerUri}:void 0)}else window.require(["DS/SwymUICore/script/feature/community/community/model/community-model"],function(e){var i=new e({mid:t.communityId});i.hasCurrentUserAccess()?"dm"===i.get("community_type")?s.goToDM(t.communityId):s.goToCommunity(t.communityId):i.fetch({onComplete:function(){i.setUserAccess(i.get("hasUserAccess")),"dm"===i.get("community_type")?s.goToDM(t.communityId):s.goToCommunity(t.communityId)},onFailure:function(){s.goToCommunity(t.communityId)}})});break;case"X3DPRFL_AP":t.login||console.error("A notification to a User Profile does not contain any login.",e.data.url),s.goToProfile({login:t.login});break;case"X3DOPSW_AP":if(t.tab)switch(t.tab){case 1:s.goToUrl("admin-tenant/whatsnew");break;case 0:default:s.goToUrl("admin-tenant/communities")}else s.goToUrl("admin-tenant")}},t.prototype._extractNotifData=function(e){var t=e.split("#app:")[1].split("/")[0],i={appName:t,communityId:void 0,communityType:void 0,modelName:void 0,messageId:void 0,replyUri:void 0,commentUri:void 0,answerUri:void 0},o=e.split("content:")[1].split("&").reduce(function(e,t){var i=t.split("=");return e[n.camelCase(i[0]).valueOf()]=i[1],e},{});for(var s in"X3DMCTY_AP"!==t&&"X3DPRFL_AP"!==t&&"X3DOPSW_AP"!==t&&console.error("The notification points to a non supported Swym app:",t),o)if(o.hasOwnProperty(s))switch(s){case"community":if(o[s].startsWith("swym")){var r=decodeURIComponent(o[s]);i.communityId=r.split("community:")[1]}else i.communityId=o[s];break;case"communityType":i.communityType=o[s];break;case"contentType":i.modelName=o[s];break;case"messageId":i.messageId=o[s];break;case"contentId":case"login":case"tab":i[s]=decodeURIComponent(o[s]);break;case"commentUri":o.parentCommentUri?i.replyUri=decodeURIComponent(o[s]):i.commentUri=decodeURIComponent(o[s]);break;case"parentCommentUri":i.commentUri=decodeURIComponent(o[s]);break;case"replyUri":o.commentUri&&(i.replyUri=decodeURIComponent(o[s]));break;case"answerUri":i.answerUri=decodeURIComponent(o[s])}return i},t}(i)}),define("DS/SwymUICore/script/feature/community/media/model/media-file-extension-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/WebappsUtils/Console"],function(e,t,i){"use strict";i.log("DS/SwymUICore/script/feature/community/media/model/media-file-extension-model");var n=t.extend({_modelName:"media-files-extension",_services:{read:{url:"api/media/getsupportedfileextensionspertype"}},loadingStatus:t.STATUS.notRequested,"onRequest:read":function(){this.loadingStatus=t.STATUS.pending},"onSync:read":function(){this.loadingStatus=t.STATUS.valid,this._createDocumentedFileExtensions()},"onError:read":function(){this.loadingStatus=t.STATUS.invalid,i.log("Get supported types -> Call error.")},_attributesMapping:{_authorizedFileFormats:"authorizedFormats",_documentedFileFormats:"documentedFormats",_maxSizeForFiles:"maxSizes"},_createDocumentedFileExtensions:function(){for(var t=this.getAttributes(),i={skipusage:t.skipusage,image:t.picture,picture:t.picture,video:t.video,audio:t.sound,sound:t.sound,"3dmodel":t["3d_model"],"3d_model":t["3d_model"],document:t.document,drawing:t.drawing,simulation:t.simulationMedia},n=e.clone(i),o=0,s=i.skipusage.length;o<s;o++){var r=i.skipusage[o];for(var a in n)if("skipusage"!==a){var c=n[a].indexOf(r);-1!==c&&n[a].splice(c,1)}}this.set("authorizedFormats",i),this.set("documentedFormats",n),this.set("maxSizes",t.maxsize),this.dispatchEvent("onDocumentedFileExtensionsCreated")}}),o=null,s={getInstance:function(e){return null===o?(o=n.singleton()).fetch({onComplete:function(t){e&&t.addEvent("onSync:read",e)}}):e&&e(),o}};return s.__testonly__={Class:n},s}),define("DS/SwymUICore/script/feature/core/annotation/annotation-mixin",["require","exports","DS/SwymUICore/script/utils/navigation"],function(e,t,i){"use strict";function n(e,t){var n=t.contentModel.getCommunity(),o=t.contentModel.get("mid"),s=t.contentModel.getModelName(),r=n.get("mid"),a="media"!==s?t.model.get("mid"):null;i.goToContent(o,s,r,!1,void 0,void 0,"dm"===n.get("community_type"),{mediaId:a,dataAnnotation:e})}Object.defineProperty(t,"__esModule",{value:!0}),t.loadAnnotation=t.goToMedia=void 0,t.goToMedia=n,t.loadAnnotation=function(e,t){var i=t.contentModel;return new Promise(function(e){i&&(i.hasBeenFetched()?e(""):i.fetch({onComplete:e}))}).then(function(){window.require(["DS/SwymUICore/script/feature/community/media/model/media-model"],function(o){var s,r,a,c={model:null,isAutoplayActivated:!0,_widget:t._widget,contentModel:i},u=e&&e.relatedMediaUri,l=u&&u.split(":").pop();l||(l=(a=(r=i.getAssociated("embeddedMedia"))&&r.at(0))&&a.get("mid")),l&&((s=new o({mid:l})).hasBeenFetched()?(c.model=s,n(e,c)):s.fetch({onComplete:function(t){c.model=t,n(e,c)}}))})})}});__extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/SwymUICore/script/utils/call-scheduler",["require","exports","UWA/Class","DS/SwymUICore/script/feature/core/context/context-model"],function(e,t,i,n){"use strict";var o=n.getInstance(),s=!1;return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._activated=!0,t}return __extends(t,e),t.prototype.delayLoadingOfLowPriorityModules=function(){if(this._activated&&!s){s=!0;var e=window.require,t={},i=["DS/InstantMessaging","DS/NotificationManager","DS/DSNodeSocketioClient"],n={"DS/InstantMessaging":4e3,"DS/NotificationManager":4e3,"DS/DSNodeSocketioClient":4e3},r=function(s,r){var a,c,u=void 0,l=null,d=arguments,m=s;if(Array.isArray(m)&&1===m.length&&(a=m[0])&&(u=i.filter(function(e){return a.startsWith(e)})[0]),!u)return e.apply(this,d);t[u]?t[u].push({scope:this,args:d}):t[u]=[{scope:this,args:d}],1===t[u].length&&(c=function(){var n=i.indexOf(u);n>=0&&(i.splice(n,1),0===i.length&&(window.require=e),t[u].forEach(function(t){e.apply(t.scope,t.args)}),t[u]=[])},"function"==typeof o.addOnce("onPageLoad",function(){l&&clearTimeout(l),setTimeout(function(){c()},1e3)},null,!0)||(l=setTimeout(c,n[u])))};for(var a in e)e.hasOwnProperty(a)&&(r[a]=e[a]);window.require=r}},t.prototype.executeAfterPageLoad=function(e,t,i){var n=null,s=!1,r=function(){!1===s&&(s=!0,e())};if(!e)throw new Error("The callback is missing");!0===this._activated?(t>0||(t=3e3),i>=0||(i=0),n=setTimeout(r,t),o.addOnce("onPageLoad",function(){clearTimeout(n),setTimeout(r,i)},null,!0)):e()},t.prototype.activate=function(){this._activated=!0},t.prototype.deactivate=function(){this._activated=!1},t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t}(i)}),define("DS/SwymUICore/script/feature/community/wedo/collection/wedo-collection",["UWA/Core","DS/SwymUICore/script/lib/6wpanel/utils","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/community/wedo/model/wedo-model","DS/SwymUICore/script/utils/exalead-interceptor"],function(e,t,i,n,o){return i.extend(o,{_collectionName:"wedo-collection",_services:{filter:{all:{url:"api/exalead/search",tagsWithoutSubjectURI:!0},community:{url:"api/exalead/search",dataFn:function(t){return e.extend(t||{},{refineUsingQuery:this.communityId?'community_id:"'+this.communityId+'"':null})},tagsWithoutSubjectURI:!0},"community-tactical-wedos":{url:"api/exalead/whatsnew",dataFn:function(t){return t&&delete t.content_type,e.merge({contentType:this.exaleadContentType,legacyFormat:!1,community_id:this.communityId,with_synthesis:!0},t||{})},tagsWithoutSubjectURI:!0},latestContributions:{url:"api/exalead/whatsnew",paramsMapping:{limit:"nresults",startFrom:"start"},dataFn:function(e){return{legacyFormat:!1,community_id:this.communityId,contentType:this.exaleadContentType,query:"#all",with_synthesis:!0,order_by:"desc",order_field:"ds6w_58_lastcontributed",start:(this._currentPage-1)*this._limit,nresults:this._limit,...e}},tagsWithoutSubjectURI:!0}},read:{"community-tactical-wedos":{url:"api/feed/whatsnew",dataFn:function(e){return{content_type:"wedo",community_id:this.communityId,...e}}},latestContributions:{url:"api/exalead/whatsnew",paramsMapping:{limit:"nresults",startFrom:"start"},dataFn:function(e){return{legacyFormat:!1,community_id:this.communityId,contentType:this.exaleadContentType,query:"#all",with_synthesis:!0,order_by:"desc",order_field:"ds6w_58_lastcontributed",start:(this._currentPage-1)*this._limit,nresults:this._limit,...e}},tagsWithoutSubjectURI:!0,parse:t.parseSearchResult}}},hasNext:function(){return this._limit*this._currentPage<=this.length},model:n,modes:["community-tactical-wedos","latestContributions"],exaleadContentType:"wedo",setup:function(e,t){t.communityId&&(this.communityId=t.communityId),this.addEvent("onSync:remove",this.refresh,this)}})}),define("DS/SwymUICore/script/feature/community/iquestion/collection/iquestion-collection",["UWA/Core","DS/SwymUICore/script/lib/6wpanel/utils","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/community/iquestion/model/iquestion-model","DS/SwymUICore/script/utils/exalead-interceptor"],function(e,t,i,n,o){return i.extend(o,{_collectionName:"iquestion-collection",_services:{read:{all:{url:"api/IquestionsQuestions/list",dataFn:function(){return{page:this._currentPage,limit:this._limit}}},communityPublished:{url:"api/IquestionsQuestions/list",dataFn:function(){return{published:1,page:this._currentPage,limit:this._limit,community_id:this.communityId}}},communityAll:{url:"api/IquestionsQuestions/list",dataFn:function(){return{limit:this._limit,page:this._currentPage,community_id:this.communityId}}},published:{url:"api/IquestionsQuestions/list",dataFn:function(){return{published:1,page:this._currentPage,limit:this._limit}}},validated:{url:"api/IquestionsQuestions/list",dataFn:function(){return{validated:1,page:this._currentPage,limit:this._limit}}},communityWhatsnewQuestions:{url:"api/feed/whatsnew",dataFn:function(e){return{content_type:"question",community_id:this.communityId,...e}}},latestContributions:{url:"api/exalead/whatsnew",paramsMapping:{limit:"nresults",startFrom:"start"},dataFn:function(e){return{legacyFormat:!1,community_id:this.communityId,contentType:this.exaleadContentType,query:"#all",with_synthesis:!0,order_by:"desc",order_field:"ds6w_58_lastcontributed",start:(this._currentPage-1)*this._limit,nresults:this._limit,...e}},tagsWithoutSubjectURI:!0,parse:t.parseSearchResult}},filter:{published:{url:"api/exalead/search",tagsWithoutSubjectURI:!0},communityPublished:{url:"api/exalead/search",dataFn:function(t){return e.extend(t||{},{refineUsingQuery:this.communityId?'community_id:"'+this.communityId+'"':null})},tagsWithoutSubjectURI:!0},communityQuestionsPublishedNotValidated:{url:"api/exalead/search",dataFn:function(e){return{query:"#all",contentType:this.exaleadContentType,limit:this._limit,legacyFormat:!1,refineUsingQuery:'community_id:"'+this.communityId+'" -categories:"ds6w/ds6w:what/ds6w:status/implicit/xsd:string/ds6w:status.swym_validated"',...e}}},communityWhatsnewQuestions:{url:"api/exalead/whatsnew",dataFn:function(t){return t&&delete t.content_type,e.merge({contentType:this.exaleadContentType,legacyFormat:!1,community_id:this.communityId,with_synthesis:!0},t||{})},tagsWithoutSubjectURI:!0},latestContributions:{url:"api/exalead/whatsnew",paramsMapping:{limit:"nresults",startFrom:"start"},dataFn:function(e){return{legacyFormat:!1,community_id:this.communityId,contentType:this.exaleadContentType,query:"#all",with_synthesis:!0,order_by:"desc",order_field:"ds6w_58_lastcontributed",start:(this._currentPage-1)*this._limit,nresults:this._limit,...e}},tagsWithoutSubjectURI:!0}}},model:n,modes:["all","published","validated","communityPublished","communityWhatsnewQuestions","communityAll","communityQuestionsPublishedNotValidated","latestContributions"],exaleadContentType:"iquestion",setup:function(e,t){t.communityId&&(this.communityId=t.communityId)}})}),define("DS/SwymUICore/script/feature/community/ritual/collection/ritual-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/community/ritual/model/ritual-model","DS/SwymUICore/script/lib/6wpanel/utils"],function(e,t,i,n){return t.extend({_collectionName:"ritual-collection",exaleadContentType:"conferencetemplate",_services:{read:{all:{url:"/api/rituals",method:"GET"}}},model:i,modes:["all"]})}),define("DS/SwymUICore/script/feature/core/notification/collection/notification-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/lib/model/generic/swym-model","DS/WebappsUtils/Console"],function(e,t,i,n){"use strict";var o=i.extend({_modelName:"notification"});return t.extend({model:o,_services:{sendInvitations:{sendInvitations:{url:"api/notification/send/",dataFn:function(e){return{type:"Network",do:"invite",recipient_hash:e.hash_keys,message:e.message,related_model_id:e.groupIdProfessionnal}}}}},sendInvitations:function(e){return this.action("sendInvitations",e)},modes:["sendInvitations"],setup:function(e,t){}})}),define("DS/SwymUICore/script/feature/core/error/view/error-view",["UWA/Core","i18n!DS/SwymUICore/assets/nls/feature/core/error/view/error-view","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/utils/utils","DS/WebappsUtils/WebappsUtils"],function(e,t,i,n,o){"use strict";return i.extend({name:"error-view",_error:null,_errorCode:403,_createContent:function(){var e=o.getWebappsBaseUrl()+"SwymUICore/assets/";return{styles:{"padding-top":"30px",width:"100%","min-height":"calc(100vh)",background:'no-repeat center center fixed url("'+e+'bg.jpg")',"background-size":"cover"},html:{styles:{position:"relative","margin-left":"auto","margin-right":"auto",padding:"10px",border:"1px solid white","box-shadow":"1px 1px 3px 0 #424242","border-radius":"10px",width:"952px","line-height":"normal",height:"497px",background:'no-repeat url("'+e+'ifweswymoverview.jpg")'},html:[{styles:{"background-color":"white",padding:"10px","border-radius":"5px","margin-bottom":"87px",color:"#1A79B1","font-weight":"bold",overflow:"auto"},html:[{styles:{float:"left"},tag:"span",html:t.Error+" "+this._errorCode+" - "+(403===this._errorCode?t.Forbidden:t.NotFound)},{styles:{float:"right"},tag:"span",html:t.Swym}]},{styles:{"padding-left":"165px"},html:[{styles:{color:"white","font-size":"22px"},html:t.SocialInnovationApplication},{styles:{"font-size":"22px",color:"#305164","margin-top":"60px"},html:t.Sorry},{styles:{"font-size":"110px",color:"#305164"},html:this._errorCode+"!"},{styles:{"font-size":"22px",color:"#305164","margin-top":"10px"},html:function(){switch(this._error&&this._error.errorcode){case"ERROR_ACCESS_FORBIDDEN_LICENSE_EXPIRED":return t.YourLicenceIsExpiredOrUnavailable;case"ERROR_ACCESS_FORBIDDEN_LICENSE_FULLY_CONSUMED":return t.YourLicenceIsFullyConsumed;case"ERROR_LICENSING_EXTENSION_KO":return t.LicensingPHPExtensionIsNotProperlyInstalled;case"ERROR_ACCESS_FORBIDDEN_NOT_ACTIVE":return t.YourAccountIsNotActive;case"ERROR_ACCESS_FORBIDDEN_CSRF_KO":return t.AnErrorHasOccurred;case"ERROR_ACCESS_NO_LICENSE":return t.YouDontHaveAnyLicense;default:return 403===this._errorCode?t.ThePageRequestedIsForbidden:t.TheRequestedPageDoesNotExist}}.bind(this)()}]}]}}},setup:function(e){return e&&(e.hasOwnProperty("error")&&(this._error=e.error),e.hasOwnProperty("errorCode")&&(this._errorCode=e.errorCode)),this._parent.apply(this,arguments)}})}),define("DS/SwymUICore/script/feature/community/community/collection/community-request-count-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/lib/model/generic/swym-model"],function(e,t,i){"use strict";return t.extend({_collectionName:"community-request-count",_services:{read:{count:{url:"api/communityRequest/totalRequestPerStatus"}}},modes:["count"],model:i.extend({_modelName:"community-request-count"})})}),define("DS/SwymUICore/script/feature/community/community/collection/community-request-collection",["UWA/Core","DS/SwymUICore/script/feature/core/pagination/collection/paginated-collection","DS/SwymUICore/script/feature/community/community/model/community-request-model","DS/WebappsUtils/Console"],function(e,t,i,n){"use strict";return t.extend({_collectionName:"community-request-collection",_status:[2],_services:{read:{all:{url:"api/communityRequest/listbystatus",dataFn:function(){return{page:this._currentPage,limit:10,status:this._status}}},user:{url:"api/communityRequest/listbyuser",dataFn:function(){return{page:this._currentPage,limit:10}}}}},model:i,modes:["all","user"],init:function(t,i){return e.is(i.status)&&(this._status=i.status),this._parent(t,i)}})}),define("DS/SwymUICore/script/lib/view/generic/swym-collection-view",["require","exports","UWA/Core","UWA/Utils","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/Logger/Logger"],function(e,t,i,n,o,s,r){"use strict";var a=o.extend({_collectionClass:null,_collectionEventsForAutoRefresh:["onCollectionChange"],_collectionEvents:{},_notifyOfItemViewSelection:!0,_modelViewsKeys:null,_body:null,_modeSwitch:null,_delegateSpriteReloadToParentView:!1,_onlyBodyUpdateOnIncrementalRefresh:!1,_addEmptyView:!1,collection:null,MODEL_VIEWS_INDEX_PREFIX:"MODEL_VIEW_",name:null,modelViewClass:null,modelViewsCfg:null,bodyAttributes:null,_setupBody:function(){var e=this.bodyAttributes.tag||"div";return delete this.bodyAttributes.tag,this._body=i.createElement(e,this.bodyAttributes),this.bodyAttributes.tag=e,this._body},_beforeRefresh:function(){},_afterRefresh:function(){},_isCollectionEmpty:function(e){var t=e||this.collection;return!(t&&t.length>0)},_createEmptyContent:function(){return null},_createModelView:function(e){var t,n,s=this,r=null;switch(i.typeOf(this.modelViewsCfg)){case"object":n=i.clone(this.modelViewsCfg);break;case"function":n=this.modelViewsCfg.call(this,e);break;default:n={}}return n.widget=this._widget,n.model=e,(t=this.modelViewClass.prototype instanceof o?this.modelViewClass:"function"===i.typeOf(this.modelViewClass)?this.modelViewClass.call(this,e):this.modelViewClass[e.getModelName()])&&(r=new t(n),!0===this._notifyOfItemViewSelection&&r.container.addEvent("click",function(){s.dispatchEvent("onItemViewSelect",[r,s])}),r.select||(r.select=function(){}),r.unSelect||(r.unSelect=function(){})),r},_createAndAddModelView:function(e){var t=this._createModelView(e);return t&&this.addChildView(this.MODEL_VIEWS_INDEX_PREFIX+t.cid,t),t},_updateBodyCompletelyWithModelViews:function(e){this._body.setContent(e)},_refreshBodyCompletely:function(e){var t,i=this._body,o=this._setupBody(),s=e&&e.modelArray||this.collection.toArray(),r=[],a=[],c=this._modelViewsKeys,u=this._childViews,l=this.MODEL_VIEWS_INDEX_PREFIX;return s.forEach(function(e){(t=this._createModelView(e))&&(r.push(t),a.push(l+t.cid),this.addChildView(l+t.cid,t))},this),this._modelViewsKeys=a,this._updateBodyCompletelyWithModelViews(r),(c.length>0||i)&&(i&&i.hide(),n.setImmediate(function(){for(var e,t=0,n=c.length;t<n;t++)(e=u[c[t]])&&e.destroy();i&&(i.empty(),i.destroy())})),o},_getIncrementallyCreatedModelViewContainer:function(){return this._body},_updateBodyIncrementalyWithModelViews:function(e){var t,i=e.modelViewList;e.newModelViewList.forEach(function(e,n){var o;e!==i[n]&&(i[n]?(i[n].container.isInjected()||r.error("Model view has not been injected because it was not found. Do not destroy the modelView by yourself."),e.inject(i[n].container,"before"),-1!==(o=i.indexOf(e))&&i.splice(o,1),i.splice(n,0,e)):(t=this._getIncrementallyCreatedModelViewContainer(e,n))&&(e.inject(t,"bottom"),i.splice(n,0,e)))},this)},_refreshBodyIncrementally:function(e){var t,o,s,r=i.clone(e,!1)||{},a=null,c=this._body||this._setupBody(),u=e&&e.modelArray||this.collection.toArray(),l=this.collection,d=[],m=[],h=[],p={},g=this._modelViewsKeys,f=[],_=this._childViews,y=this.MODEL_VIEWS_INDEX_PREFIX;for(t=0,o=g.length;t<o;t++)a=_[g[t]],s=a.model.id||a.model.cid,d.push(a),l.get(s)?p[s]=a:(a.hide(),f.push(a));return u.forEach(function(e){s=e.id||e.cid,(a=p[s])||(a=this._createModelView(e)),a&&(m.push(a),h.push(y+a.cid),this.addChildView(y+a.cid,a))},this),r.modelViewList=d,r.newModelViewList=m,this._modelViewsKeys=h,this._updateBodyIncrementalyWithModelViews(r),f.length>0&&n.setImmediate(function(){for(var e=0,t=f.length;e<t;e++)f[e].destroy()}),c},_getEmptyContentContainer:function(){return this._body||this._setupBody(),this._body},_checkEmptyness:function(e){var t,n;if(this.elements._emptyContent&&(this.elements._emptyContent.destroy(),delete this.elements._emptyContent),this._isCollectionEmpty(e&&e.modelArray)&&(t=this._createEmptyContent(),n=this._getEmptyContentContainer(),i.is(t))){if(this.elements._emptyContent=t,!0!==this._addEmptyView)return n.setContent(t),this._body;this.addEventOnce("onRedraw",function(){this.elements._emptyContent===t&&t.inject(n)})}},_createContent:function(e){return e&&this.collection&&!0===e.showSubsetOfModelViews&&parseInt(e.modelViewsToDisplay,10)>0&&!e.modelArray&&(e.modelArray=this.collection.slice(-parseInt(e.modelViewsToDisplay,10))),this._checkEmptyness(e),e&&!0===e._incrementalRefresh?this._refreshBodyIncrementally(e):this._refreshBodyCompletely(e)},_updateContainer:function(){var e,t,n=this.collection,o=i.clone(this._lastRefreshOptions,!1);if(o&&!0===o.showSubsetOfModelViews&&parseInt(o.modelViewsToDisplay,10)>0&&(o.modelArray=n.slice(-parseInt(o.modelViewsToDisplay,10))),this._body&&this.container.contains(this._body)&&(!o||!0!==o.reset)){if(!0===this._onlyBodyUpdateOnIncrementalRefresh)return void this._refreshBodyIncrementally(o);o||(o={}),o._incrementalRefresh=!0}t=this._createContent.call(this,o),!1!==this._toBeTemporarilyRemovedFromDomOnRefresh&&(e=this.removeForFutureReinsertion(this.container)),this.container.setContent(t),!1!==this._toBeTemporarilyRemovedFromDomOnRefresh&&e()},_checkCollection:function(e,t){return this._checkInstance(e,t||this._collectionClass)},init:function(e){return e instanceof s?e={collection:e}:e||(e={}),this._modelViewsKeys=[],["modelViewsCfg","bodyAttributes","_collectionEvents"].forEach(function(e){i.is(this[e])?this[e]=i.clone(this[e],!1):this[e]={}},this),i.is(this._collectionEventsForAutoRefresh,"array")?this._collectionEventsForAutoRefresh=[].concat(this._collectionEventsForAutoRefresh):this._collectionEventsForAutoRefresh=[],this.addEvent("onRedraw",function(){this._modeSwitch&&this._modeSwitch.applyMode()}),this._parent.call(this,e)},getBody:function(){return this._body},getModelViews:function(){var e=this._childViews;return this._modelViewsKeys?this._modelViewsKeys.map(function(t){return e[t]}):[]},addCollectionEventsForAutoRefresh:function(e){if(e){if(!0===i.is(e,"array")){var t=[].concat(e);t.forEach(function(e,t,i){this._collectionEventsForAutoRefresh.indexOf(e)>=0&&i.splice(t,1)},this),this._collectionEventsForAutoRefresh=this._collectionEventsForAutoRefresh.concat(t)}else!0===i.is(e,"string")&&this._collectionEventsForAutoRefresh.indexOf(e)<0&&this._collectionEventsForAutoRefresh.push(e);this.reactTo(this.collection,e,this.refresh)}},setCollection:function(e,t){var n,o;(n=i.is(t,"object")?i.extend({},t):{})._initializing&&this.collection&&(e||(e=this.collection),this.collection=null);var a,u=n.roleToTrack,l=this._collectionEvents,d=!1!==n.refresh,m=[].concat(this._collectionEventsForAutoRefresh),h=m.indexOf("onReset");if(!1!==n.checkCollection&&(e=this._checkCollection(e)),this.collection){if(!0===this.collection.equals(e))return this;this.stopReactingTo(this.collection)}else if(!(e instanceof s))throw new Error("Provided collection is invalid!");if(o=this.collection,this.collection=e,h>-1&&(this.reactTo(this.collection,"onReset",c),m.splice(h,1)),this.reactTo(this.collection,m,this.refresh),u&&u.name&&u.associated&&this.reactTo(this.collection,"onReplace:"+u.name,{listener:function(e,t,i){this.collection.equals(e)&&i.equals(u.associated)&&this.setCollection(t)},initialEmitterOwnEvents:!0}),l)for(var p in l)if(l.hasOwnProperty(p)){if("string"==typeof(a=l[p])&&"function"==typeof this[a]&&(a=this[a]),"function"!=typeof a){r.error("Specified listener is not valid");break}this.reactTo(this.collection,p,a)}return!1!==d&&this._rendered&&this.refresh({reset:!0}),this.dispatchEvent("onSetCollection",[this,o,this.collection]),this},setup:function(e){this._parent.apply(this,arguments),e&&(e.hasOwnProperty("modelViewsCfg")&&(this.modelViewsCfg=e.modelViewsCfg),e.hasOwnProperty("modeSwitch")&&this.setModeSwitch(e.modeSwitch),e.hasOwnProperty("bodyAttributes")&&(this.bodyAttributes=e.bodyAttributes),e.hasOwnProperty("modelViewClass")&&(this.modelViewClass=e.modelViewClass),e.hasOwnProperty("collectionEvents")&&(this._collectionEvents=i.extend(this._collectionEvents?i.clone(this._collectionEvents,!1):{},e.collectionEvents)),e.hasOwnProperty("collectionEventsForAutoRefresh")?this._collectionEventsForAutoRefresh=e.collectionEventsForAutoRefresh:this._collectionEventsForAutoRefresh=i.clone(this._collectionEventsForAutoRefresh,!1));var t=this.options.className;return this.options.className=this.bodyAttributes.class||"",this.bodyAttributes.class=this.getClassNames("-body"),this.options.className=t,""===this.bodyAttributes.class&&delete this.bodyAttributes.class,(e.collection||this.collection&&!0===e._initializing)&&this.setCollection(e.collection,{refresh:e.hasOwnProperty("refresh")?e.refresh:!e._initializing,_initializing:e._initializing}),this},setModeSwitch:function(e){return this._modeSwitch=e,e.setTarget(this),this},destroy:function(){return this.collection=null,this._modelViewsKeys=null,this._modeSwitch=null,this.bodyAttributes=null,this.modelViewsCfg=null,this._collectionEventsForAutoRefresh=null,this._collectionEvents=null,this._refresh=null,this._body&&(this._body.destroy(),this._body=null),this._parent.apply(this,arguments)}}),c=function(){return this.refresh({reset:!0})};return a}),define("DS/SwymUICore/script/feature/core/realtime/realtime-topic-manager",["require","exports","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","DS/SwymUICore/script/feature/core/realtime/rt-connector"],function(e,t,i,n){"use strict";return function(){function e(){n.init(),this.listenToChangeTopic()}return e.prototype.listenToChangeTopic=function(){this.indexForRTSubscription=n.subscribe(function(e){e&&e.message_details&&"setTopic"===e.message_details.action&&new i({id:e.message_details.subject_id},{}).set("topic",e.message_details.subject_title)})},e.prototype.destroy=function(){n.unsubscribe(this.indexForRTSubscription),this.indexForRTSubscription=null},e}()}),define("DS/SwymUICore/script/feature/core/favorite/favorite-communities-manager",["DS/SwymUICore/script/feature/core/favorite/abstract-favorite-manager","DS/SwymUICore/script/feature/core/favorite/collection/favorite-communities-collection","DS/SwymUICore/script/feature/core/favorite/model/favorite-communities-model"],function(e,t,i){"use strict";var n,o=e.extend({_modelClass:i,init:function(){return this._parent.apply(this,arguments),this._collection=new t([],{mode:"my-favorites-communities",page:1,limit:999}),this}});return{getInstance:function(){return n||(n=new o),n},resetInstance:function(){n&&(n=null)}}}),define("DS/SwymUICore/script/feature/community/post/collection/post-collection",["UWA/Core","DS/SwymUICore/script/lib/6wpanel/utils","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/community/post/model/post-model","DS/SwymUICore/script/utils/exalead-interceptor"],function(e,t,i,n,o){return i.extend(o,{_collectionName:"post-collection",_services:{read:{all:{url:"api/filter/post",dataFn:function(){return{page:this._currentPage,limit:this._limit}}},community:{url:"api/filter/post",dataFn:function(){return{community_id:this.communityId,page:this._currentPage,limit:this._limit}}},communityWhatsnewPosts:{url:"api/feed/whatsnew",dataFn:function(e){return{content_type:"post",community_id:this.communityId,...e}}},latestContributions:{url:"api/exalead/whatsnew",paramsMapping:{limit:"nresults",startFrom:"start"},dataFn:function(e){return{legacyFormat:!1,community_id:this.communityId,contentType:this.exaleadContentType,query:"#all",with_synthesis:!0,order_by:"desc",order_field:"ds6w_58_lastcontributed",start:(this._currentPage-1)*this._limit,nresults:this._limit,...e}},tagsWithoutSubjectURI:!0,parse:t.parseSearchResult}},filter:{all:{url:"api/exalead/search",tagsWithoutSubjectURI:!0},community:{url:"api/exalead/search",dataFn:function(t){return e.extend(t||{},{refineUsingQuery:this.communityId?'community_id:"'+this.communityId+'"':null})},tagsWithoutSubjectURI:!0},communityWhatsnewPosts:{url:"api/exalead/whatsnew",dataFn:function(t){return t&&delete t.content_type,e.merge({contentType:this.exaleadContentType,legacyFormat:!1,community_id:this.communityId,with_synthesis:!0},t||{})},tagsWithoutSubjectURI:!0},latestContributions:{url:"api/exalead/whatsnew",paramsMapping:{limit:"nresults",startFrom:"start"},dataFn:function(e){return{legacyFormat:!1,community_id:this.communityId,query:"#all",with_synthesis:!0,order_by:"desc",order_field:"ds6w_58_lastcontributed",start:(this._currentPage-1)*this._limit,nresults:this._limit,...e}},tagsWithoutSubjectURI:!0}}},model:n,modes:["all","community","communityWhatsnewPosts","latestContributions"],exaleadContentType:"posts",setup:function(e,t){t.communityId&&(this.communityId=t.communityId),this.addEvent("onSync:remove",this.refresh,this)}})}),define("DS/SwymUICore/script/feature/core/favorite/favorite-dm-manager",["DS/SwymUICore/script/feature/core/favorite/abstract-favorite-manager","DS/SwymUICore/script/feature/core/favorite/collection/favorite-dm-collection","DS/SwymUICore/script/feature/core/favorite/model/favorite-dm-model"],function(e,t,i){"use strict";var n,o=e.extend({_modelClass:i,init:function(){return this._parent.apply(this,arguments),this._collection=new t([],{mode:"my-favorites-dm"}),this}});return{getInstance:function(){return n||(n=new o),n},resetInstance:function(){n&&(n=null)}}}),define("DS/SwymUICore/script/feature/core/tenant/collection/users-processes-collection",["DS/SwymUICore/script/feature/core/pagination/collection/paginated-collection","DS/SwymUICore/script/feature/core/tenant/model/users-process-model"],function(e,t){"use strict";return e.extend({model:t,mode:"processes",modes:["processes"],_communityId:null,_asAdmin:!1,_services:{read:{processes:{url:"api/member/getbatchlist",dataFn:function(e){return{start:(this._currentPage-1)*this._limit,limit:this._limit,community_id:this._communityId,user_type:4,as_admin:this._asAdmin}},parse:function(e){return e.forEach(function(e,t){e.real_id=e.id,e.mid=t}),e}}}},setup:function(e,t){this._parent.apply(this,arguments),t&&t.community_id&&(this._communityId=t.community_id),t&&t.asAdmin&&(this._asAdmin=t.asAdmin)}})}),define("DS/SwymUICore/script/feature/community/report-abuse/collection/report-abuse-collection-v2",["UWA/Core","UWA/Array","UWA/Json","DS/SwymUICore/script/feature/core/pagination/collection/paginated-collection","DS/SwymUICore/script/feature/community/report-abuse/model/report-abuse-model-v2","DS/Logger/Logger"],function(e,t,i,n,o,s){"use strict";return n.extend({_collectionName:"report-abuse-collection",_services:{read:{all:{url:"commentproxy/reportabuses",method:"GET",paramsMapping:{page:"page_number",limit:"page_size"},dataFn:function(e){return e}}}},defaultOptions:{state:{firstPage:0,currentPage:0},queryParams:{currentPage:"page_number",pageSize:"page_size"}},model:o,mode:"all",modes:["all"],parse:function(n,o){var s=e.is(n,"string")?i.decode(n):n;return s&&s.hasOwnProperty("totalRecords")&&(void 0===s.totalRecords&&t.isArray(s.result)?this.setTotalItems(s.result.length):this.setTotalItems(s.totalRecords)),this._parent(n,o)}})}),define("DS/SwymUICore/script/feature/core/context/context-change-actions",["UWA/Core","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/core/history/history-model","DS/SwymUICore/script/feature/core/context/context-constants"],function(e,t,i,n){var o=[function(){var e,i,o=!1,s=t.getInstance();s&&s.isPreviousPathAListing(s)&&(e=[n.COMMUNITY_BLOG,n.COMMUNITY_MEDIA,n.COMMUNITY_IDEAS,n.COMMUNITY_SURVEYS],i=s.getCommunityPageContext(s.path),e.indexOf(i)<0&&(o=!0)),o&&require(["DS/SwymUICore/script/feature/community/iquestion/model/iq-answer-model"],function(e){window.localStorage.removeItem(e.LocalStorageKeyForSort)})}];i.addEvent("onHistoryStateChange",function(){for(var e=0,t=o.length;e<t;e++)o[e]()})}),define("DS/SwymUICore/script/feature/core/realtime/realtime-wiki-concurrent-edition-manager",["require","exports","DS/SwymUICore/script/feature/core/realtime/rt-connector","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/feature/community/wiki/model/wiki-model"],function(e,t,i,n,o){"use strict";return function(){function e(e){i.init(),this.callback=e,this.listenToWikiEdition()}return e.prototype.listenToWikiEdition=function(){var e=this;this.indexForRTSubscription=i.subscribe(function(t){"INTERNAL_CONTENT"===t.message_type&&n.getInstanceFetched(function(i){i.get("login")!==t.triggered_by&&(e.callback(t),new o({id:t.message_details.model_id},{}).set("outdated",!0))})})},e.prototype.destroy=function(){i.unsubscribe(this.indexForRTSubscription),this.indexForRTSubscription=null},e}()}),define("DS/SwymUICore/script/feature/community/idea/collection/idea-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/community/idea/model/idea-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/lib/6wpanel/utils","DS/SwymUICore/script/utils/exalead-interceptor"],function(e,t,i,n,o,s){return t.extend(s,{_collectionName:"idea-collection",_services:{read:{community:{url:"api/feed/whatsnew",dataFn:function(e){return{content_type:"idea",community_id:this.communityId,...e}}},"transfer-to-idea-list":{url:"api/Ideation/list",dataFn:function(){return{community_id:this.communityId,limit:this._limit,page:this._currentPage}}},"community-full-list":{url:"api/Ideation/getfullpipeline",dataFn:function(){return{community_id:this.communityId,derived_type_id:this.contentTypeName,order:"DESC"}},parse:function(e){return this.statusInfos=e.status,e.ideas}},latestContributions:{url:"api/exalead/whatsnew",paramsMapping:{limit:"nresults",startFrom:"start"},dataFn:function(e){return{legacyFormat:!1,community_id:this.communityId,contentType:this.exaleadContentType,query:"#all",with_synthesis:!0,order_by:"desc",order_field:"ds6w_58_lastcontributed",start:(this._currentPage-1)*this._limit,nresults:this._limit,...e}},tagsWithoutSubjectURI:!0,parse:o.parseSearchResult}},filter:{community:{url:"api/exalead/search",dataFn:function(t){return e.extend(t||{},{refineUsingQuery:this.communityId?'community_id:"'+this.communityId+'"':null,order_field:"update",order_by:"desc"})},tagsWithoutSubjectURI:!0},"transfer-to-idea-list":{url:"api/exalead/search",dataFn:function(t){return e.extend(t||{},{refineUsingQuery:this.communityId?'community_id:"'+this.communityId+'"':null,order_field:"update",order_by:"desc"})},tagsWithoutSubjectURI:!0},"community-full-list":{url:"api/exalead/search",dataFn:function(t){return e.extend(t||{},{refineUsingQuery:this.communityId?'community_id:"'+this.communityId+'"':null,order_field:"update",order_by:"asc"})},postProcess:function(e){var t=this.communityId,i=new n({mid:t}),s=o.extractTagsFromExaleadResponse(e),r=Array.isArray(s)&&s.filter(function(e){return"ds6w:what/ds6w:status"===e.sixw}).map(function(e){return{community_id:t,status_nb:e.count,title:e.object}});return i&&r&&r.length>0&&i.set("ideation_status_filtered_array",r),e},tagsWithoutSubjectURI:!0},latestContributions:{url:"api/exalead/whatsnew",paramsMapping:{limit:"nresults",startFrom:"start"},dataFn:function(e){return{legacyFormat:!1,community_id:this.communityId,contentType:this.exaleadContentType,query:"#all",with_synthesis:!0,order_by:"desc",order_field:"ds6w_58_lastcontributed",start:(this._currentPage-1)*this._limit,nresults:this._limit,...e}},tagsWithoutSubjectURI:!0}}},model:i,modes:["community","community-full-list","latestContributions","transfer-to-idea-list"],exaleadContentType:"idea",setup:function(e,t){t.communityId&&(this.communityId=t.communityId),t.contentTypeName&&(this.contentTypeName=t.contentTypeName),this.addEvent("onSync:remove",this.refresh,this)},collectionPostProcess:function(e){this.forEach(function(t){var i=e.find(function(e){return e.get("mid")===t.get("status_id")});i&&t.set({status_title:i.get("title",{escapeHTML:!1}),color:i.get("color"),status_color:i.get("color")})})}})}),define("DS/SwymUICore/script/feature/community/social-event/collection/social-event-collection",["UWA/Core","DS/SwymUICore/script/lib/6wpanel/utils","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/community/social-event/model/social-event-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/utils/exalead-interceptor"],function(e,t,i,n,o,s){return i.extend(s,{_collectionName:"social-event-collection",exaleadContentType:"conference",_services:{filter:{"fake-filtered-social-event":{urlFn:function(){return"/api/communities/"+this.communityUri+"/conferences"},method:"GET",parse:function(e){return e}},communityWhatsnewSocialEvents:{url:"api/exalead/whatsnew",dataFn:function(t){return t&&delete t.content_type,e.merge({contentType:this.exaleadContentType,legacyFormat:!1,community_id:this.communityId,with_synthesis:!0},t||{})},tagsWithoutSubjectURI:!0},latestContributions:{url:"api/exalead/whatsnew",paramsMapping:{limit:"nresults",startFrom:"start"},dataFn:function(e){return{legacyFormat:!1,community_id:this.communityId,contentType:this.exaleadContentType,query:"#all",with_synthesis:!0,order_by:"desc",order_field:"ds6w_58_lastcontributed",start:(this._currentPage-1)*this._limit,nresults:this._limit,...e}},tagsWithoutSubjectURI:!0}},read:{"fake-filtered-social-event":{urlFn:function(){return"/api/communities/"+this.communityUri+"/conferences"},method:"GET"},communityWhatsnewSocialEvents:{url:"api/feed/whatsnew",dataFn:function(e){return{content_type:"conference",community_id:this.communityId,...e}}},latestContributions:{url:"api/exalead/whatsnew",paramsMapping:{limit:"nresults",startFrom:"start"},dataFn:function(e){return{legacyFormat:!1,community_id:this.communityId,contentType:this.exaleadContentType,query:"#all",with_synthesis:!0,order_by:"desc",order_field:"ds6w_58_lastcontributed",start:(this._currentPage-1)*this._limit,nresults:this._limit,...e}},tagsWithoutSubjectURI:!0,parse:t.parseSearchResult}}},hasNext:function(){return this._limit*this._currentPage<=this.length},model:n,modes:["fake-filtered-social-event","communityWhatsnewSocialEvents","latestContributions"],setup:function(e,t){var i;t.communityId&&(this.communityId=t.communityId,(i=new o({mid:this.communityId}).get("subject6wuri"))&&(this.communityUri=i))},fetchPage:function(e,t){var i=this,n=i._parent.bind(i);return this.communityUri?n(e,t):new Promise(function(e){new o({mid:this.communityId},{autoPopulate:!0,onPopulate:function(t){e(t.get("subject6wuri"))}})}).then(function(o){return i.communityUri=o,n(e,t)}.bind(this))}})}),define("DS/SwymUICore/script/feature/core/network/collection/activity-collection",["UWA/Core","DS/SwymUICore/script/feature/core/pagination/collection/paginated-collection","DS/SwymUICore/script/feature/core/network/model/activity-model","DS/SwymUICore/script/utils/utils","DS/WebappsUtils/Console"],function(e,t,i,n,o){"use strict";return t.extend({_services:{read:{activity:{url:"api/network/getnetworkactivity",dataFn:function(e){return{only_main_activity:!0,only_raw_data:!0,hash_key:this.hash_key,page:this._currentPage,limit:this._limit}}}}},paginationMode:"PREV_NEXT",model:i,modes:["activity"],setup:function(e,t){t.hash_key&&(this.hash_key=t.hash_key)}})}),define("DS/SwymUICore/script/feature/community/idea/collection/license-collection",["DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/community/idea/model/license-model","DS/SwymUICore/script/feature/core/config/bootstrap-model"],function(e,t,i){"use strict";return e.extend({model:t,_collectionName:"license-collection",_3dspaceUrl:null,_dsCSRFToken:null,modes:["default"],_services:{read:{default:{urlFn:function(){return this._3dspaceUrl+"/resources/v1/discovery/integration?tenant="+i.getInstance().get("config").tenant.online_instance_id},method:"GET",noCsrfToken:!0,type:"json",headers:{"Content-Type":"application/json; charset=utf-8",Accept:"application/json, text/javascript, */*"},parse:function(e,t){var i=this;this._dsCSRFToken=t.request.xhr.getResponseHeader("x-ds-csrftoken");var n=[];return e.results.forEach(function(e){n.push({name:e.name,label:e.label,subtypes:e.types,serviceURI:e.uri,threeDSpaceUrl:i._3dspaceUrl})}),n}}}},getDSCSRFToken:function(){return this._dsCSRFToken},set3DSpaceUrl:function(e){this._3dspaceUrl=e}}).singleton({mode:"default"})}),define("DS/SwymUICore/script/feature/core/favorite-communities/favorite-communities-manager",["UWA/Promise","DS/SwymUICore/script/lib/pub-sub","DS/SwymUICore/script/feature/core/favorite-communities/model/favorite-communities-model","DS/SwymUICore/script/feature/core/favorite-communities/collection/favorite-communities-collection","DS/SwymUICore/script/feature/community/community/model/community-model","i18n!DS/SwymUICore/assets/nls/feature/core/favorite-communities/favorite-communities-manager"],function(e,t,i,n,o,s){"use strict";var r,a=t.extend({_isReady:!1,_model:null,_collection:null,_serviceAvailable:!1,_executeOnReady:function(t){var i=this;return new e(function(e,n){i._isReady?t(e,n):i.addEventOnce("onFavoriteCommunitiesModelIsReady",t.bind(i,e,n))})},getFavorites:function(){var e=this;return this._executeOnReady(function(t,i){if(e._serviceAvailable){var o,s=e._model.get("favoriteCommunities").list,r=[];if(e._collection&&e._collection.hasBeenFetched())t(e._collection);else{for(o in s)s.hasOwnProperty(o)&&s[o].hasOwnProperty("id")&&r.push(s[o].id);e._collection=new n([],{mode:"all",limit:999,listIds:r}),r.length>0?e._collection.fetch({onComplete:function(i){e._collection=i,t(e._collection)}}):t(e._collection)}}else i("service unavailable")})},onRemove:function(e){var t=this._model.get("favoriteCommunities").list,i=[];for(var n in t)t.hasOwnProperty(n)&&t[n].id!==e&&i.push(t[n]);return this._storeFavorites(i,"removed",e)},onChange:function(e,t){var i,n=this._model.get("favoriteCommunities").list,o=!0,s="added";return!t&&0!==t||!n.hasOwnProperty(t)&&t===n.length?(n.push({id:e}),this._storeFavorites(n,s,e)):n.hasOwnProperty(t)&&n[t].hasOwnProperty("id")&&n[t].id!==e?((i=this._getFavoritePosition(e))?(i<t&&(o=!1),s="ordered"):n.push({id:e}),n=this._ordering(o,t,e,n),this._storeFavorites(n,s,e)):void 0},_ordering:function(e,t,i,n){var o=n[t].id,s=n,r=t;return s[t]={id:i},e?r+=1:r-=1,this._recursiveOrdering(e,r,i,s,o)},_recursiveOrdering:function(e,t,i,n,o){var s=t,r=n,a=r[s].id;return a!==i?(r[s]={id:o},e?s+=1:s-=1,this._recursiveOrdering(e,s,i,r,a)):(r[s]={id:o},r)},_getFavoritePosition:function(e){var t,i=this._model.get("favoriteCommunities").list;for(t in i)if(i.hasOwnProperty(t)&&i[t].hasOwnProperty("id")&&i[t].id===e)return t;return!1},isFavorite:function(e){var t,i=this;return this._executeOnReady(function(n,o){if(i._serviceAvailable){for(var s in t=i._model.get("favoriteCommunities").list)t.hasOwnProperty(s)&&t[s].id===e&&n(!0);n(!1)}else n(!1)})},isFavoriteSync:function(e){if(!this._serviceAvailable||!this._isReady)return!1;var t=this._model&&this._model.get("favoriteCommunities").list;for(var i in t)if(t.hasOwnProperty(i)&&t[i].id===e)return!0;return!1},_storeFavorites:function(t,i,n){var r=this,a=this._model&&this._model.get("favoriteCommunities").list,c=[];return this._model.get("favoriteCommunities").list=t,new e(function(e,u){r._model.save({},{onComplete:function(){var s,a=[];for(var u in t)t.hasOwnProperty(u)&&t[u].hasOwnProperty("id")&&(s=new o({id:t[u].id}),c.push(t[u].id),a.push(s));switch(r._collection.listIds=c,r._collection.reset(a),i){case"added":r.dispatchEvent("onFavoriteAdded",n);break;case"removed":r.dispatchEvent("onFavoriteRemoved",n);break;case"ordered":r.dispatchEvent("onFavoriteOrdered")}e()},onFailure:function(){r._model.favoriteCommunities.list=a,require(["DS/UWPClientControls/PlatformNotify"],function(e){e.error(s.WeWereNotAbleToSaveYourFavorites)}),u()}})})},init:function(){var e=this;return this._parent.apply(this,arguments),this.favoritesCommunities=i.getInstance(),this.favoritesCommunities.fetch({onComplete:function(t){e._model=t,e._isReady=!0,e._serviceAvailable=!0,e.dispatchEvent("onFavoriteCommunitiesModelIsReady")},onFailure:function(){e._model={},e._isReady=!0,e._serviceAvailable=!1,e.dispatchEvent("onFavoriteCommunitiesModelIsReady")}}),this}});return{getInstance:function(){return r||(r=new a),r},resetInstance:function(){r&&(r=null,i.resetInstance())}}}),define("DS/SwymUICore/script/feature/core/language/collection/language-list-collection",["DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/UWPClientCode/I18n"],function(e,t,i,n,o){var s=e.extend({_services:{read:{getlanglist:{url:"api/SpokenLanguage/getlanglist"}}},_collectionName:"language-list-collection",model:t.extend({_modelName:"list-language-model"}),comparator:function(e){return e.get("translated")||e.get("lang_english")},_callNlsTranslationToTagger:function(e){for(var t,r=s.getCollection(),a=[],c=0,u=r.length;c<u;c++)t=r.at(c),a.push(t.get("iso_code"));var l={"ds6w:language":a};n.getNlsOfPropertiesValues(JSON.stringify(l),{lang:o.getCurrentLanguage(),tenantId:i.getInstance().get("config").tenant.online_instance_id,apiVersion:"R2019x",onComplete:function(i){for(var n=i["ds6w:language"],o=0,a=r.length;o<a;o++)(t=r.at(o)).set("translated",n[t.get("iso_code")]);e.onComplete(r),s.prototype.dispatchEvent("globalSync",r)},onFailure:function(){e.onComplete(r),s.prototype.dispatchEvent("globalSync",r)}})},fetchOnce:function(e){var t=s.getCollection();null===t?!1===s.isBeingFetched?(s.isBeingFetched=!0,this.fetch({onComplete:function(t){s.setCollection(t),this._callNlsTranslationToTagger(e)}.bind(this)})):s.prototype.addEvent("globalSync",function(t){e.onComplete(t)}.bind(this)):e.onComplete(t)},modes:["getlanglist"]});return s.isBeingFetched=!1,s.collection=null,s.setCollection=function(e){s.collection=e},s.getCollection=function(){return s.collection},s}),define("DS/SwymUICore/script/feature/core/user/collection/member-collection",["UWA/Core","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/community/member/model/mixin/community-member","DS/W3DXComponents/Collections/ActionsCollection","DS/WebappsUtils/Console"],function(e,t,i,n,o,s,r){"use strict";var a=i.extend(o,{_actionsCollectionClass:s,init:function(){this._parent.apply(this,arguments),this.addActions()}});return t.extend({model:a})}),define("DS/SwymUICore/script/feature/core/network/collection/request-collection",["UWA/Core","DS/SwymUICore/script/feature/core/pagination/collection/paginated-collection","DS/SwymUICore/script/feature/core/network/model/request-model","DS/SwymUICore/script/feature/core/group/collection/group-collection","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/WebappsUtils/Console"],function(e,t,i,n,o,s){"use strict";return t.extend({Hashkey:null,_associations:{groups:{Class:n},users:{Class:o}},_services:{read:{sentRequests:{url:"api/network/getsentrequests",dataFn:function(){return{hash_key:this.Hashkey,start:(this._currentPage-1)*this._limit,limit:this._limit}}},receivedRequests:{url:"api/network/getpendingrequests",dataFn:function(){return{hash_key:this.Hashkey}}}}},model:i,modes:["sentRequests","receivedRequests"],init:function(e,t){try{return t&&t.Hashkey&&this.setHashkey(t.Hashkey),this._parent(e,t)}catch(e){return void s.error("Error initializing collection: "+e.message)}},getHashkey:function(){return this.Hashkey},setHashkey:function(e){this.Hashkey=e}})}),define("DS/SwymUICore/script/feature/community/derived-type/derived-type-data-utils",["require","exports","DS/SwymUICore/script/feature/core/context/context-constants"],function(e,t,i){"use strict";var n;function o(e){return!!e.match(i.DERIVED_TYPE_NAME_REGEXP)}function s(e){if(e){if(e.parent===n.POST)return i.POST_DERIVED_TYPE_PREFIX+e.id;if(e.parent===n.IDEA)return i.IDEA_DERIVED_TYPE_PREFIX+e.id}}function r(e){var t=e.match(i.DERIVED_TYPE_NAME_REGEXP);return t&&t[1]}function a(e){var t=e.match(i.COMMUNITY_DERIVED_TYPE_PAGE_REGEXP);return t&&t[1]}function c(e){var t=e.match(i.COMMUNITY_DERIVED_TYPE_IDEAS_PIPELINE_PAGE_REGEXP);return t&&t[1]}Object.defineProperty(t,"__esModule",{value:!0}),t.getTagNavigatorFilters=t.createDerivedTypeDataFromTags=t.createIconWrapperClassForDerivedTypeModel=t.getDerivedTypeIdFromCommunityPipelinePageName=t.getDerivedTypeIdFromCommunityPageName=t.getDerivedTypeIdFromDerivedTypeName=t.getDerivedTypeNameFromCommunityPipelinePageName=t.getDerivedTypeNameFromCommunityPageName=t.getCommunityPipelinePageNameFromDerivedTypeName=t.getCommunityPageNameFromDerivedTypeName=t.createCommunityPageNameForDerivedType=t.getParentFromDerivedTypeName=t.createTypeNameForDerivedType=t.createIconClassForDerivedTypeModel=t.isDerivedTypeCommunityPageName=t.isIdeaDerivedType=t.isPostDerivedType=t.isDerivedTypeName=t.DERIVED_TYPE_PARENT=void 0,function(e){e.POST="POST",e.IDEA="IDEATION"}(n=t.DERIVED_TYPE_PARENT||(t.DERIVED_TYPE_PARENT={})),t.isDerivedTypeName=o,t.isPostDerivedType=function(e){return e.parent===n.POST},t.isIdeaDerivedType=function(e){return e.parent===n.IDEA},t.isDerivedTypeCommunityPageName=function(e){return!!e.match(i.COMMUNITY_DERIVED_TYPE_PAGE_REGEXP)},t.createIconClassForDerivedTypeModel=function(e){return e&&e.icon&&e.icon.replace("fonticon-","")},t.createTypeNameForDerivedType=s,t.getParentFromDerivedTypeName=function(e){if(e&&o(e)){var t=e.match(i.DERIVED_TYPE_PARENT_NAME_REGEXP),n=t&&t[1];if(n===i.POST_DERIVED_TYPE_PREFIX)return i.POST;if(n===i.IDEA_DERIVED_TYPE_PREFIX)return i.IDEATION}},t.createCommunityPageNameForDerivedType=function(e){if(e){if(e.parent===n.POST)return i.COMMUNITY_POST_DERIVED_TYPE_PAGE_PREFIX+e.id;if(e.parent===n.IDEA)return i.COMMUNITY_IDEA_DERIVED_TYPE_PAGE_PREFIX+e.id}},t.getCommunityPageNameFromDerivedTypeName=function(e){var t=r(e);return e.startsWith(i.POST_DERIVED_TYPE_PREFIX)?"".concat(i.COMMUNITY_POST_DERIVED_TYPE_PAGE_PREFIX).concat(t):e.startsWith(i.IDEA_DERIVED_TYPE_PREFIX)?"".concat(i.COMMUNITY_IDEA_DERIVED_TYPE_PAGE_PREFIX).concat(t):void 0},t.getCommunityPipelinePageNameFromDerivedTypeName=function(e){var t=r(e);if(e.startsWith(i.IDEA_DERIVED_TYPE_PREFIX))return"ideaspipeline-".concat(i.COMMUNITY_IDEA_DERIVED_TYPE_PAGE_PREFIX).concat(t)},t.getDerivedTypeNameFromCommunityPageName=function(e){var t=a(e);return e.startsWith(i.COMMUNITY_POST_DERIVED_TYPE_PAGE_PREFIX)?"".concat(i.POST_DERIVED_TYPE_PREFIX).concat(t):e.startsWith(i.COMMUNITY_IDEA_DERIVED_TYPE_PAGE_PREFIX)?"".concat(i.IDEA_DERIVED_TYPE_PREFIX).concat(t):void 0},t.getDerivedTypeNameFromCommunityPipelinePageName=function(e){var t=c(e);if(e.startsWith("ideaspipeline-".concat(i.COMMUNITY_IDEA_DERIVED_TYPE_PAGE_PREFIX)))return"".concat(i.IDEA_DERIVED_TYPE_PREFIX).concat(t)},t.getDerivedTypeIdFromDerivedTypeName=r,t.getDerivedTypeIdFromCommunityPageName=a,t.getDerivedTypeIdFromCommunityPipelinePageName=c,t.createIconWrapperClassForDerivedTypeModel=function(e){return s(e)},t.createDerivedTypeDataFromTags=function(e){var t={"swym:Idea":n.IDEA,"swym:Post":n.POST};return{label:e.ds6w_58_kind,parent:t[e.ds6w_58_type],icon:e.ds6w_58_typeFontIcon,color:e.ds6w_58_typeColor,id:e.ds6w_58_typeId}},t.getTagNavigatorFilters=function(e,t){var i,n,o="ds6w:what/".concat(!0===t?"swym:eventSubjectType":"ds6w:type");return null==e?((i={})[o]=[],i):((n={})[o]=[{object:e.label,type:"string",disptext:e.label}],n)}});__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},__awaiter=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,s){function r(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,a)}c((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){var i,n,o,s,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,n=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(o=(o=r.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){r=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){r.label=s[1];break}if(6===s[0]&&r.label<o[1]){r.label=o[1],o=s;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(s);break}o[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],n=0}finally{i=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};define("DS/SwymUICore/script/utils/utils",["require","exports","DS/SwymUICore/script/constants/community-constants","UWA/Core","UWA/Utils","UWA/Promise","UWA/Class/Events","DS/WebappsUtils/WebappsUtils","DS/UWPClientCode/PublicAPI","DS/PlatformAPI/PlatformAPI","UWA/String","i18n!DS/SwymUICore/assets/nls/feature/community/community/model/community-model","DS/SwymUICore/script/utils/routing","DS/SwymUICore/script/feature/community/derived-type/derived-type-data-utils","DS/SwymUICore/script/utils/feature-activation-constants","DS/Logger/Logger"],function(e,t,i,n,o,s,r,a,c,u,l,d,m,h,p,g){"use strict";var f,_,y=new RegExp("\\".concat(":","([%A-Za-z0-9-_$.+!*'()~]+)?"),"g"),w=new r;var C={TRANSIENT_WIDGET_ID_PREFIX:"preview-",WHATSNEW_MODE:i.CTY_CONTENT_LIST_MODE.WHATSNEW_MODE,TIMELINE_MODE:i.CTY_CONTENT_LIST_MODE.TIMELINE_MODE,COMPACTVIEW_MODE:i.CTY_CONTENT_LIST_MODE.COMPACTVIEW_MODE,SWYM_IM_CENTRAL_COLUMN_DEFAULT_MODE_COMMUNITY:i.CTY_CONTENT_LIST_MODE.WHATSNEW_MODE,SWYM_IM_CENTRAL_COLUMN_DEFAULT_MODE_CONVERSATION:i.CTY_CONTENT_LIST_MODE.TIMELINE_MODE,SWYM_IM_CENTRAL_COLUMN_DEFAULT_SORT_MODE:i.CTY_CONTENT_LIST_SORT_MODE.CREATION_DATE,debounce:function(e,t){if("function"==typeof e)return i=null,n=null,o=t||50,s=null,r=function(){e.apply(n,i)},function(){n=this,i=arguments,s&&clearTimeout(s),s=setTimeout(r,o)};var i,n,o,s,r;throw new Error("First argument is supposed to be a function")},throttle:function(e,t){var i,n;return function(){var o=this,s=arguments;n?(clearTimeout(i),i=setTimeout(function(){Date.now()-n>=t&&(e.apply(o,s),n=Date.now())},t-(Date.now()-n))):(e.apply(o,s),n=Date.now())}},cancellableThrottle:function(e,t){var i,n;return{throttle:function(){var o=this,s=arguments;n?(clearTimeout(i),i=setTimeout(function(){Date.now()-n>=t&&(e.apply(o,s),n=Date.now())},t-(Date.now()-n))):(e.apply(o,s),n=Date.now())},cancel:function(){i&&clearTimeout(i)}}},setWidgetTitle:function(e,t){e.elements&&e.elements.header&&e.elements.header.getElement("span.title")&&t&&e.elements.header.getElement("span.title").setHTML(t)},getTopBarMainId:function(){return"topBarProxyDefault"},get:function(e,t,i,n){return"function"==typeof e[t]?e[t].apply(i,n):e[t]},getMediaDefaultThumbnail:function(e){var t="xl_thumb_default_";switch("string"==typeof e?e:e.get("media_type")||e.getChanges("media_type")){case"picture":t+="pic";break;case"sound":t+="sound";break;case"video":t+="vid";break;case"3d_model":t+="3D";break;case"drawing":t+="drawing";break;case"document":default:t+="doc"}return a.getWebappsAssetUrl("SwymUIComponents","media-default-thumb/"+t+".png")},getMediaIconName:function(e){var t,i,n="";switch("string"==typeof e?n=e:(n=e.get("media_type")||e.getChanges("media_type")||window.ds&&window.ds.isMDE&&(e.get("drive_media_type")||"step"===e.get("media_file_ext")&&"3d_model"),t=e.get("media_file_ext")||e.get("play")&&e.get("play").original_file_extension),n){case"sound":i="sound";break;case"video":i="video";break;case"simulationMedia":i="run";break;case"3d_model":i="cube";break;case"document":switch(t){case"pptx":case"ppt":i="presentation-slide-layout";break;case"xlsx":case"xls":i="table";break;case"docx":case"doc":i="doc-log";break;default:i="doc"}break;case"animatedPicture":i="picture-animated";break;case"sketch":i="app-3dsketch";break;case"story":i="app-3dstory";break;case"whiteboard":i="app-whiteboard";break;default:i="picture"}return i},getIconFromModel:function(e,t){var i,n="";if(n="string"==typeof e?e:e.getContentType(),h.isDerivedTypeName(n))return e.get&&e.get("derived_type")?i=e.get("derived_type"):t?i=t:g.warn("Derived type information is not available"),h.createIconClassForDerivedTypeModel(i);switch(n){case"post":return"newspaper";case"media":return this.getMediaIconName(e);case"question":case"iquestion":return"help";case"idea":case"ideation":return"lamp";case"wiki":case"wiki_page":return"book-open";case"survey":return"clipboard";case"wedo":return"task";case"social-event":return"calendar";default:return""}},getContentIconUrl:function(e){var t,i,n="";switch(t="string"==typeof e?e:e.getModelName()){case"post":case"idea":case"wiki":n=t;break;case"iquestion":n="iq";break;case"media":if(n="picture","string"!=typeof e)switch(i=e.get("media_type")){case"sound":case"video":case"document":n=i;break;case"3d_model":n="threed-file"}}return n?this.getBaseUrl()+"/webapps/SwymUIComponents/assets/content-icon/"+n+".png":""},removeForFutureReinsertion:function(e){var t=e.getParent(),i=e.nextSibling;return i||t?(e.remove(),function(n){i?(n||e).inject(i,"before"):(n||e).inject(t,"bottom")}):function(){}},validateURL:function(e){try{new URL(e)}catch(e){return!1}return!0},getMyCommunitiesAppKey:function(){return"X3DMCTY_AP"},getProfileAppKey:function(){return"X3DPRFL_AP"},getContentReaderAppKey:function(){return"X3DVIEW_AP"},getControlCenterAppKey:function(){return"X3DOPSW_AP"},getAnalyticsAppKey:function(){return"X3DSTAT_AP"},pinToDashboard:function(e){n.is(e.failure)||(e.failure=function(){window.require(["DS/UWPClientControls/PlatformNotify","i18n!DS/SwymUICore/assets/nls/utils/utils"],function(e,t){e.error(t.UnableToPinToTab)})}),top.require(["DS/Dashboard/PublicAPI"],function(t){e.tabId=t.getActiveTab().id,t.addModule(e)})},get3DDTransientAppUrl:function(e){"instantmessage"===e.contentType&&(e.contentType="message");var t=n.clone(e),i=["url=".concat(o.encodeUrl(C.getBaseUrl()))],s=top.window.location,r="".concat(s.protocol,"//").concat(s.hostname).concat(s.port?":".concat(s.port):"").concat(s.pathname?s.pathname:""),a="".concat(e.origin||r,"/#app:").concat(e.appId);for(var c in delete t.url,delete t.appId,delete t.origin,t)t.hasOwnProperty(c)&&t[c]&&i.push("".concat(c,"=").concat(t[c]));return a+="/content:".concat(i.join("&"))},getMyCommunitiesAppUrl:function(e){return(e=e||{}).appId=C.getMyCommunitiesAppKey(),C.get3DDTransientAppUrl(e)},getProfileAppUrl:function(e){return(e=e||{}).appId=C.getProfileAppKey(),C.get3DDTransientAppUrl(e)},getLabelOfWidgetListPreference:function(e,t,i){var n=null,o=null,s=e.getPreference(t);return s&&s.options?(n=s.options.filter(function(e){return e.value===(i||s.value)}))&&n.length>0&&(o=n[0].label):s&&s.label&&(o=s.label),o},getTenantIdFromUrlPreference:function(e){var t=e&&e.getPreference("url");return t&&t.options?t.options.filter(function(e){return e.value===t.value})[0].id:t?t.id:""},setWidgetListPreferenceWithId:function(e,t,i){var n=null,o=null,s=e.getPreference(t);return s&&s.options&&(n=s.options.filter(function(e){return e.id===i}))&&n.length>0&&(o=n[0].value,e.setValue(t,o)),o},initFedSearchUrl:function(e){f=String(e),w.dispatchEvent("onFedSearchUrlInitialized")},getFedSearchUrlPromise:function(){return new s(function(e,t){f?e(f):w.addEvent("onFedSearchUrlInitialized",function(){e(f)})})},initCurrentTenantId:function(e){var t=String(e)&&String(e);window.ds&&(window.ds.swymTenant=t.toLowerCase()),u.setTenant(t),_=t},getCurrentTenantId:function(){return _},initBaseUrl:function(e){return m.initSwymAPIUrl(e)},getBaseUrl:function(){return m.getSwymAPIUrl()},isFeatureActivated:function(e){return!(0===e.indexOf("activateWedo")&&!this.isCloud())&&p.FEATURES_ACTIVATED[e]},isBetaFeatureActivated:function(e){return p.ACTIVATED_BETA_FEATURES[e].isActivated},getCustomWikiLockDuration:function(){return __awaiter(this,void 0,void 0,function(){var e,t,i,n;return __generator(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,new Promise(function(e){window.ds&&"3DD"===window.ds.env&&window.top.require(["DS/UWPClientCode/PublicAPI"],e),e(c)})];case 1:return e=o.sent(),t=e.getApplicationConfiguration("app.swymfeature.customWikiLockDuration"),i=parseInt(t,10),[2,Number.isNaN(i)?120:i];case 2:return n=o.sent(),console.error(n),[2,120];case 3:return[2]}})})},getDelayedSyncTask:function(e,t,i){if("function"==typeof e)return o=null,s=null,r=!1,a=!0,c=t||30,u=i?n.extend({},i):{},l=function(){for(;!0===a;)a=!1,e.apply(s,o);"function"==typeof u.after&&u.after.apply(s,o),r=!1},function(){a=!0,s=this,o=arguments,!1===r&&(r=!0,"function"==typeof u.before&&u.before.apply(s,o),setTimeout(l,c))};var o,s,r,a,c,u,l;throw new Error("Invalid parameter")},isCORSActivated:function(){return!(function(e){if(window.require&&window.require.defined)return window.require.defined(e);try{return window.require(e),!0}catch(e){return!1}}("DS/PlatformAPI/PlatformAPI")&&"disabled"===String(window.require("DS/PlatformAPI/PlatformAPI").getApplicationConfiguration("com.3ds.wp.passport.cors")))},getClientInformation:function(){var e=o.Client,t=e.Platform,i=e.Engine;return{isIpad:!0===t.ipad,isIphone:"safari"===i.name&&t.ios&&!1===t.ipad,isIos:"safari"===i.name&&t.ios,isSafari:"safari"===i.name}},getContainedMediaIds:function(e){return function(e,t,i){i||(i=1);for(var n,o=[];n=t.exec(e);)o.push(n[i]);return o}(e,/<img\s[^>]*data-media-id="([A-Za-z0-9-_]*)"\s[^>]*>/g,1)},hasMediaBeenDeleted:function(e,t,i){var n=!1;return t&&(t.filter(function(t){return t.media_id===e})[0]||C.getContainedMediaIds("string"==typeof i?i:i.outerHTML).indexOf(e)>=0&&(n=!0)),n},isCloud:function(){var e=u.getAllApplicationConfigurations();return e&&e.length>0&&"true"===e.filter(function(e){return"app.build.isCloud"===e.propertyKey})[0].propertyValue},isSubject6wURI:function(e){return e.includes("swym:")},extractDataFromSubject6wURI:function(e){var t,i,n=null,o=null,s=e.split(":"),r=s[3];switch(r?t=s[4]:(r=s[0],t=s[1]),r){case"conference":r="social-event",i="Conference";break;case"idea":case"ideation":r="idea",i="Idea";break;case"people":case"iam":r="user",o="/feature/core/";case"media":case"survey":case"community":i=l.ucfirst(r);break;case"communitypost":case"post":r="post",i="Posts";break;case"qnaquestion":case"question":r="iquestion",i="iQuestion";break;case"wikitree":case"wiki":r="wiki",i="Wikitree";break;case"dm":r="dm",i="Conversation";default:i=r=null}return n="user"===r?{login:t}:{mid:t},{tenantId:s[2],modelName:r,extraAttrs:n,exaleadType:i,modelAMDModuleRoot:o}},extractDataFromSubject6wURI2:function(e){var t,n="",o=e.split(":"),s=o[3],r=null,a="",c="",u="";switch(s?t=o[4]:(s=o[0],t=o[1]),s){case"idea":case"ideation":r=i.CONTENT.idea,u=t;break;case"media":r=i.CONTENT.media,u=t;break;case"survey":r=i.CONTENT.survey,u=t;break;case"people":case"iam":n=t;break;case"community":a=t;break;case"communitypost":case"post":r=i.CONTENT.post,u=t;break;case"qnaquestion":case"question":r=i.CONTENT.iquestion,u=t;break;case"wikitree":case"wiki":r=i.CONTENT.wiki,u=t;break;case"dm":c=t,a=t}return{communityId:a,dmId:c,contentId:u,contentType:r,userHashKey:n}},compareObjects:function(e,t){var i;if("object"!=typeof e||"object"!=typeof t)return!1;for(i in e){if(!e.hasOwnProperty(i)||!t.hasOwnProperty(i))return!1;if(e[i]&&t[i]&&"object"==typeof e[i]&&"object"==typeof t[i])return this.compareObjects(e[i],t[i]);if(e[i]!==t[i])return!1}return!0},cloneNode:function(e,t){var i,o=e.cloneNode(t||!0);for(i in e._events)e._events.hasOwnProperty(i)&&e._events[i].dispatcher.bindings.forEach(function(e){e.delegates.length>0?(o=n.extendElement(o)).addEvent("".concat(i," ").concat(e.delegates[0]),e.listener):o.addEventListener(i,e.listener)});return o},getContextFromRoute:function(e){var t=e||"";return n.is(e,"string")&&(e.match(y)?(t=e.replace(y,"")).endsWith("/")&&(t=t.slice(0,t.length-1)):[]),t},prettySize:function(e){if(e=parseInt(e,10),n.is(e,"number")){var t=e,i=0,o=[];for(o[0]="b",o[1]="Kb",o[2]="Mb",o[3]="Gb",o[4]="Tb",o[5]="Pb",o[6]="Eb",o[7]="Zb",o[7]="Yb";t>1;)e=t,t/=1024,i++;return e!==t&&(i-=1),"".concat(Math.round(e)," ").concat(o[i])}return""},getNbLayoutColumns:function(){var e=document.querySelector(".swym-im")||document.querySelector(".app-content")||document.querySelector(".swym-app"),t=e&&e.getBoundingClientRect();if(t&&t.width){if(t.width<800)return 1;if(t.width<1140)return 2}return 3},getTranslatedRoleFromRoleTag:function(e){var t="";switch(e){case"ds6w:role.swym_mainowner":t=d.Mainowner;break;case"ds6w:role.swym_owner":t=d.Owner;break;case"ds6w:role.swym_author":t=d.Author;break;case"ds6w:role.swym_contributor":t=d.Contributor}return t},setBodyPageDataAttribute:function(e){document.body.setAttribute("data-swym-page",e)},isMobile:function(){var e=window.document.getElementsByTagName("html")[0].classList,t=e.contains("touch"),i=e.contains("ipados");return t&&!i},formatThumbnailsInfos:function(e){var t=this,i=[];return void 0!==e&&Array.isArray(e)&&e.length>0&&(i=e.map(function(e){return __assign(__assign({},e),t.isSubject6wURI(e.media_id)&&{media_id:t.extractDataFromSubject6wURI(e.media_id).extraAttrs.mid})})),i}};return C});__extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/SwymUICore/script/feature/core/context/context-constants",["require","exports","DS/SwymUICore/script/utils/utils"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.M3DEChangeEvents=t.ChangeEvents=t.M3DEContextAttributesClass=t.ContextAttributesClass=t.DIRECT_MESSAGE_URL_PART=t.COMMUNITY_URL_PART=t.CENTER_QUADRANT=t.WEST_QUADRANT=t.SOUTH_QUADRANT=t.EAST_QUADRANT=t.NORTH_QUADRANT=t.Quadrant=t.CONTENT_URL_PART=t.CHANNEL_CREATION_URL_PART=t.STORY_CREATION_URL_PART=t.WHITEBOARD_CREATION_URL_PART=t.SKETCH_CREATION_URL_PART=t.SWYM_BRAND_NAME=t.MY3DEXPERIENCE_BRAND_NAME=t.DRIVE_REGEXP=t.COCKPIT_REGEXP=t.NETWORK_URL_PART=t.COCKPITS_URL_PART=t.DRIVES_URL_PART=t.COCKPIT_URL_PART=t.DRIVE_URL_PART=t.THREE_DDRIVE_ID_URL_PART=t.MY_SUGGESTIONS=t.MY_BOOKMARKS=t.MY_NETWORK_ACTIVITY=t.COMMUNITYPAGE_TO_CONTENTTYPE=t.COMMUNITYPAGE_TO_CONTENTTYPE_STATIC=t.BACKEND_CONTENT_TYPE_TO_UI_CONTENT_TYPE_TEMP=t.CONTENTTYPE_TO_COMMUNITYPAGE=t.CONTENTTYPE_TO_COMMUNITYPAGE_STATIC=t.COMMUNITY_DERIVED_TYPE_IDEAS_PIPELINE_PAGE_PATH_REGEXP=t.COMMUNITY_DERIVED_TYPE_IDEAS_PIPELINE_PAGE_REGEXP=t.COMMUNITY_DERIVED_TYPE_PAGE_PATH_REGEXP=t.COMMUNITY_DERIVED_TYPE_PAGE_REGEXP=t.DERIVED_TYPE_PARENT_NAME_REGEXP=t.DERIVED_TYPE_NAME_REGEXP=t.SEARCH_REGEXP=t.TENANT_ADMIN_COMMUNITY_REGEXP=t.TENANT_ADMIN_PATERN=t.RITUAL=t.SOCIAL_EVENT=t.WEDO=t.MESSAGE=t.SURVEY=t.WIKI=t.MEDIA=t.IDEATION=t.POST=t.QUESTION=t.IQUESTION=t.IFWE_PARENT_COMMENT_URI_REGEXP=t.IFWE_REPLY_URI_REGEXP=t.IFWE_ANSWER_URI_REGEXP=t.IFWE_COMMENT_URI_REGEXP=t.IFWE_CONTENT_URI_REGEXP=t.IFWE_CONTENT_ID_REGEXP=t.IFWE_CONTENT_TYPE_ID_REGEXP=t.IFWE_OTHER_MESSAGE_ID_REGEXP=t.IFWE_MESSAGE_ID_REGEXP=t.IFWE_COMMUNITY_TYPE_DM_REGEXP=t.IFWE_DM_ID_REGEXP=t.IFWE_COMMUNITY_ID_REGEXP=t.COMMUNITY_CONTENT_LIST_REGEXP=t.COMMUNITY_WIKI_ROOT_REGEXP=t.COMMUNITY_WIKI_HOME_REGEXP=t.WIKI_IN_COMMUNITY_WIKI_ROOT=t.WIKI_IN_COMMUNITY_WIKI_HOME=t.COMMUNITY_MEDIA_HOME_REGEXP=t.MEDIA_IN_COMMUNITY_MEDIA_HOME=t.COMPACTVIEW_MODE=t.TIMELINE_MODE=t.WHATSNEW_MODE=t.SEARCH=t.RITUALS_CREATION=t.RITUALS_CALENDAR=t.RITUALS=t.MEDIA_FILTERED=t.DISCOVER_COMMUNITIES=t.MY_COMMUNITIES=t.COMMUNITY_WIKI_ROOT=t.COMMUNITY_SOCIAL_EVENTS=t.COMMUNITY_WEDO=t.COMMUNITY_SURVEYS=t.COMMUNITY_MY_CONTRIBUTIONS=t.COMMUNITY_STATS=t.COMMUNITY_SETTINGS=t.COMMUNITY_MEMBERS=t.COMMUNITY_WIKI=t.COMMUNITY_QUESTIONS=t.COMMUNITY_IDEAS_PIPELINE=t.COMMUNITY_IDEAS=t.COMMUNITY_GALLERY=t.COMMUNITY_MEDIA=t.COMMUNITY_BLOG=t.COMMUNITY_MESSAGE=t.DIRECT_MESSAGE_PREFIX=t.DM_MESSAGE_REGEXP=t.COMMUNITY_MESSAGE_REGEXP=t.DM_CONTENT_MEDIA_REGEXP=t.DM_CONTENT_REGEXP=t.RITUAL_CONTENT_REGEXP=t.COMMUNITY_CONTENT_MEDIA_REGEXP=t.COMMUNITY_CONTENT_REGEXP=t.HOME_PAGE_CONTENT_REGEXP=t.EDITION_MODE_REGEXP=t.MESSAGE_REGEXP_PATTERN=t.CONTENT_REGEXP_PATTERN=t.COMMUNITY_IDEAS_PIPELINE_DERIVED_TYPE_PAGE_PREFIX=t.COMMUNITY_IDEA_DERIVED_TYPE_PAGE_PREFIX=t.COMMUNITY_POST_DERIVED_TYPE_PAGE_PREFIX=t.IDEA_DERIVED_TYPE_PREFIX=t.POST_DERIVED_TYPE_PREFIX=t.ANSWER_REGEXP=t.REPLY_REGEXP=t.COMMENT_REGEXP=t.RITUAL_REGEXP=t.DM_REGEXP=t.COMMUNITY_REGEXP=t.USER_REGEXP=t.REPLY_REGEXP_PATTERN=t.ANSWER_REGEXP_PATTERN=t.COMMENT_REGEXP_PATTERN=t.USER_REGEXP_PATTERN=t.RITUAL_REGEXP_PATTERN=t.DM_REGEXP_PATTERN=t.COMMUNITY_REGEXP_PATTERN=t.UUID_REGEXP=t.USER_LOGIN_HASH_KEY_REGEXP=t.BASE64_REGEXP=t.EDITION_MODE_REGEXP_PATTERN=t.HOME=t.RITUAL_PAGE_MATCHER=t.DM_PAGE_MATCHER=t.COMMUNITY_PAGE_MATCHER=t.FACET_MATCHER=t.COMMUNITY_ROUTE_MATCHER=t.UNKNOWN_CONTEXT_ID=t.TITLE_PART_SEPARATOR=t.SWYM_STANDALONE_TITLE=t.DM_FEEDMODE_PREF_KEY=t.COMMUNITY_FEEDMODE_PREF_KEY=void 0,t.COMMUNITY_FEEDMODE_PREF_KEY="communityFeedMode",t.DM_FEEDMODE_PREF_KEY="dmFeedMode",t.SWYM_STANDALONE_TITLE="3DEXPERIENCE Platform",t.TITLE_PART_SEPARATOR=" - ",t.UNKNOWN_CONTEXT_ID="default",t.COMMUNITY_ROUTE_MATCHER=/communities\/community:\d+\/?/,t.FACET_MATCHER=/communities\/community:\d+\/(\w+)\/?/,t.COMMUNITY_PAGE_MATCHER=/community:[A-Za-z0-9-_]+\/([\w-]+)\/?/,t.DM_PAGE_MATCHER=/dm:[A-Za-z0-9-_]+\/([\w-]+)\/?/,t.RITUAL_PAGE_MATCHER=/ritual:?[A-Za-z0-9-_]+/,t.HOME="home",t.EDITION_MODE_REGEXP_PATTERN="/edit$",t.BASE64_REGEXP="[A-Za-z0-9-_%.:]+",t.USER_LOGIN_HASH_KEY_REGEXP="[A-Za-z0-9-_%.:@]+",t.UUID_REGEXP="[A-Za-z0-9]{8}-[A-Za-z0-9]{4}-[A-Za-z0-9]{4}-[A-Za-z0-9]{4}-[A-Za-z0-9]{12}",t.COMMUNITY_REGEXP_PATTERN="community:([^/]+)",t.DM_REGEXP_PATTERN="dm:("+t.BASE64_REGEXP+")",t.RITUAL_REGEXP_PATTERN="ritual:("+t.BASE64_REGEXP+")",t.USER_REGEXP_PATTERN="people:("+t.USER_LOGIN_HASH_KEY_REGEXP+")",t.COMMENT_REGEXP_PATTERN="comment:([%A-Za-z0-9-_]+)",t.ANSWER_REGEXP_PATTERN="answer:([%A-Za-z0-9-_]+)",t.REPLY_REGEXP_PATTERN="reply:([%A-Za-z0-9-_]+)",t.USER_REGEXP=new RegExp(t.USER_REGEXP_PATTERN+"?"),t.COMMUNITY_REGEXP=new RegExp(t.COMMUNITY_REGEXP_PATTERN+"?"),t.DM_REGEXP=new RegExp(t.DM_REGEXP_PATTERN+"?"),t.RITUAL_REGEXP=new RegExp(t.RITUAL_REGEXP_PATTERN+"?"),t.COMMENT_REGEXP=new RegExp(t.COMMENT_REGEXP_PATTERN+"?"),t.REPLY_REGEXP=new RegExp(t.REPLY_REGEXP_PATTERN+"?"),t.ANSWER_REGEXP=new RegExp(t.ANSWER_REGEXP_PATTERN+"?"),t.POST_DERIVED_TYPE_PREFIX="dt-post-",t.IDEA_DERIVED_TYPE_PREFIX="dt-idea-",t.COMMUNITY_POST_DERIVED_TYPE_PAGE_PREFIX="dt-posts-",t.COMMUNITY_IDEA_DERIVED_TYPE_PAGE_PREFIX="dt-ideas-",t.COMMUNITY_IDEAS_PIPELINE_DERIVED_TYPE_PAGE_PREFIX="ideaspipeline-dt-ideas-",t.CONTENT_REGEXP_PATTERN="(post|media|iquestion|question|idea|ideation|survey|wiki|wikiroot|wedo|social-event|".concat(t.POST_DERIVED_TYPE_PREFIX).concat(t.BASE64_REGEXP,"|").concat(t.IDEA_DERIVED_TYPE_PREFIX).concat(t.BASE64_REGEXP,"):(").concat(t.BASE64_REGEXP,")"),t.MESSAGE_REGEXP_PATTERN="message:("+t.UUID_REGEXP+")",t.EDITION_MODE_REGEXP=new RegExp(t.EDITION_MODE_REGEXP_PATTERN),t.HOME_PAGE_CONTENT_REGEXP=new RegExp(t.CONTENT_REGEXP_PATTERN+"?"),t.COMMUNITY_CONTENT_REGEXP=new RegExp(t.COMMUNITY_REGEXP_PATTERN+"/"+t.CONTENT_REGEXP_PATTERN+"?"),t.COMMUNITY_CONTENT_MEDIA_REGEXP=new RegExp(t.COMMUNITY_REGEXP_PATTERN+"/"+t.CONTENT_REGEXP_PATTERN+"/media:("+t.BASE64_REGEXP+")?"),t.RITUAL_CONTENT_REGEXP=new RegExp(t.RITUAL_REGEXP_PATTERN+"/"+t.CONTENT_REGEXP_PATTERN+"/?"),t.DM_CONTENT_REGEXP=new RegExp(t.DM_REGEXP_PATTERN+"/"+t.CONTENT_REGEXP_PATTERN+"/?"),t.DM_CONTENT_MEDIA_REGEXP=new RegExp(t.DM_REGEXP_PATTERN+"/"+t.CONTENT_REGEXP_PATTERN+"/media:("+t.BASE64_REGEXP+")?"),t.COMMUNITY_MESSAGE_REGEXP=new RegExp(t.COMMUNITY_REGEXP_PATTERN+"/"+t.MESSAGE_REGEXP_PATTERN+"?"),t.DM_MESSAGE_REGEXP=new RegExp(t.DM_REGEXP_PATTERN+"/"+t.MESSAGE_REGEXP_PATTERN+"?"),t.DIRECT_MESSAGE_PREFIX="DM-",t.COMMUNITY_MESSAGE="message",t.COMMUNITY_BLOG="blog",t.COMMUNITY_MEDIA="media",t.COMMUNITY_GALLERY="gallery",t.COMMUNITY_IDEAS="ideas",t.COMMUNITY_IDEAS_PIPELINE="ideaspipeline",t.COMMUNITY_QUESTIONS="questions",t.COMMUNITY_WIKI="wiki",t.COMMUNITY_MEMBERS="members",t.COMMUNITY_SETTINGS="settings",t.COMMUNITY_STATS="stats",t.COMMUNITY_MY_CONTRIBUTIONS="mycontributions",t.COMMUNITY_SURVEYS="surveys",t.COMMUNITY_WEDO="wedos",t.COMMUNITY_SOCIAL_EVENTS="social-events",t.COMMUNITY_WIKI_ROOT="wikiroot",t.MY_COMMUNITIES="mycommunities",t.DISCOVER_COMMUNITIES="allcommunities",t.MEDIA_FILTERED="("+t.COMMUNITY_MEDIA+")/?$",t.RITUALS="rituals",t.RITUALS_CALENDAR="rituals/calendar",t.RITUALS_CREATION="rituals/add",t.SEARCH="search",t.WHATSNEW_MODE=i.WHATSNEW_MODE,t.TIMELINE_MODE=i.TIMELINE_MODE,t.COMPACTVIEW_MODE=i.COMPACTVIEW_MODE,t.MEDIA_IN_COMMUNITY_MEDIA_HOME="("+t.COMMUNITY_MEDIA+")/?$",t.COMMUNITY_MEDIA_HOME_REGEXP=new RegExp("(?:community|dm):[A-Za-z0-9-_]+/"+t.MEDIA_IN_COMMUNITY_MEDIA_HOME),t.WIKI_IN_COMMUNITY_WIKI_HOME="("+t.COMMUNITY_WIKI+")/?$",t.WIKI_IN_COMMUNITY_WIKI_ROOT="("+t.COMMUNITY_WIKI_ROOT+")/?$",t.COMMUNITY_WIKI_HOME_REGEXP=new RegExp(t.COMMUNITY_REGEXP_PATTERN+"/"+t.WIKI_IN_COMMUNITY_WIKI_HOME),t.COMMUNITY_WIKI_ROOT_REGEXP=new RegExp(t.COMMUNITY_REGEXP_PATTERN+"/"+t.WIKI_IN_COMMUNITY_WIKI_ROOT),t.COMMUNITY_CONTENT_LIST_REGEXP=new RegExp("(?:community|dm):[A-Za-z0-9-_]+/("+t.COMMUNITY_BLOG+"|"+t.COMMUNITY_MEDIA+"|"+t.COMMUNITY_GALLERY+"|"+t.COMMUNITY_IDEAS+"|"+t.COMMUNITY_QUESTIONS+"|"+t.COMMUNITY_WIKI+"|"+t.COMMUNITY_WEDO+"|"+t.COMMUNITY_SOCIAL_EVENTS+"|"+t.COMMUNITY_SURVEYS+"|"+t.COMMUNITY_POST_DERIVED_TYPE_PAGE_PREFIX+t.BASE64_REGEXP+"|"+t.COMMUNITY_IDEA_DERIVED_TYPE_PAGE_PREFIX+t.BASE64_REGEXP+")/?$"),t.IFWE_COMMUNITY_ID_REGEXP=new RegExp("community=("+t.BASE64_REGEXP+")?"),t.IFWE_DM_ID_REGEXP=new RegExp("dm=("+t.BASE64_REGEXP+")?"),t.IFWE_COMMUNITY_TYPE_DM_REGEXP=new RegExp("communityType=dm"),t.IFWE_MESSAGE_ID_REGEXP=new RegExp("message=("+t.UUID_REGEXP+")?"),t.IFWE_OTHER_MESSAGE_ID_REGEXP=new RegExp("messageId=("+t.UUID_REGEXP+")?"),t.IFWE_CONTENT_TYPE_ID_REGEXP=new RegExp("contentType=("+t.BASE64_REGEXP+")?"),t.IFWE_CONTENT_ID_REGEXP=new RegExp("contentId=("+t.BASE64_REGEXP+")?"),t.IFWE_CONTENT_URI_REGEXP=new RegExp("contentUri=("+t.BASE64_REGEXP+")?"),t.IFWE_COMMENT_URI_REGEXP=new RegExp("commentUri=("+t.BASE64_REGEXP+")?","i"),t.IFWE_ANSWER_URI_REGEXP=new RegExp("answerUri=("+t.BASE64_REGEXP+")?","i"),t.IFWE_REPLY_URI_REGEXP=new RegExp("replyUri=("+t.BASE64_REGEXP+")?","i"),t.IFWE_PARENT_COMMENT_URI_REGEXP=new RegExp("parentCommentUri=("+t.BASE64_REGEXP+")?"),t.IQUESTION="iquestion",t.QUESTION="question",t.POST="post",t.IDEATION="ideation",t.MEDIA="media",t.WIKI="wiki",t.SURVEY="survey",t.MESSAGE="message",t.WEDO="wedo",t.SOCIAL_EVENT="social-event",t.RITUAL="ritual",t.TENANT_ADMIN_PATERN="admin-tenant",t.TENANT_ADMIN_COMMUNITY_REGEXP=new RegExp(t.TENANT_ADMIN_PATERN+"/community:("+t.BASE64_REGEXP+")/(members|stats|settings)"),t.SEARCH_REGEXP=new RegExp(t.SEARCH+":(.*)"),t.DERIVED_TYPE_NAME_REGEXP=new RegExp("^(?:".concat(t.POST_DERIVED_TYPE_PREFIX,"|").concat(t.IDEA_DERIVED_TYPE_PREFIX,")(").concat(t.BASE64_REGEXP,")")),t.DERIVED_TYPE_PARENT_NAME_REGEXP=new RegExp("^(".concat(t.POST_DERIVED_TYPE_PREFIX,"|").concat(t.IDEA_DERIVED_TYPE_PREFIX,")(").concat(t.BASE64_REGEXP,")")),t.COMMUNITY_DERIVED_TYPE_PAGE_REGEXP=new RegExp("^(?:".concat(t.COMMUNITY_POST_DERIVED_TYPE_PAGE_PREFIX,"|").concat(t.COMMUNITY_IDEA_DERIVED_TYPE_PAGE_PREFIX,")(").concat(t.BASE64_REGEXP,")")),t.COMMUNITY_DERIVED_TYPE_PAGE_PATH_REGEXP=new RegExp("^community:(?:".concat(t.BASE64_REGEXP,")/((?:").concat(t.COMMUNITY_POST_DERIVED_TYPE_PAGE_PREFIX,"|").concat(t.COMMUNITY_IDEA_DERIVED_TYPE_PAGE_PREFIX,")(?:").concat(t.BASE64_REGEXP,"))")),t.COMMUNITY_DERIVED_TYPE_IDEAS_PIPELINE_PAGE_REGEXP=new RegExp("^ideaspipeline-(?:".concat(t.COMMUNITY_IDEA_DERIVED_TYPE_PAGE_PREFIX,")(").concat(t.BASE64_REGEXP,")")),t.COMMUNITY_DERIVED_TYPE_IDEAS_PIPELINE_PAGE_PATH_REGEXP=new RegExp("^community:(?:".concat(t.BASE64_REGEXP,")/(ideaspipeline-((?:").concat(t.COMMUNITY_IDEA_DERIVED_TYPE_PAGE_PREFIX,")(?:").concat(t.BASE64_REGEXP,")))")),t.CONTENTTYPE_TO_COMMUNITYPAGE_STATIC={post:t.COMMUNITY_BLOG,media:t.COMMUNITY_MEDIA,idea:t.COMMUNITY_IDEAS,iquestion:t.COMMUNITY_QUESTIONS,wiki:t.COMMUNITY_WIKI,survey:t.COMMUNITY_SURVEYS,wedo:t.COMMUNITY_WEDO,"social-event":t.COMMUNITY_SOCIAL_EVENTS},t.CONTENTTYPE_TO_COMMUNITYPAGE=function(e){if(t.CONTENTTYPE_TO_COMMUNITYPAGE_STATIC[e])return t.CONTENTTYPE_TO_COMMUNITYPAGE_STATIC[e];if(e.match(t.DERIVED_TYPE_NAME_REGEXP)){if(e.startsWith(t.POST_DERIVED_TYPE_PREFIX))return t.COMMUNITY_POST_DERIVED_TYPE_PAGE_PREFIX;if(e.startsWith(t.IDEA_DERIVED_TYPE_PREFIX))return t.COMMUNITY_IDEA_DERIVED_TYPE_PAGE_PREFIX}},t.BACKEND_CONTENT_TYPE_TO_UI_CONTENT_TYPE_TEMP={conference:t.SOCIAL_EVENT,ideation:"idea",question:"iquestion"};var n,o={};for(var s in t.CONTENTTYPE_TO_COMMUNITYPAGE_STATIC)t.CONTENTTYPE_TO_COMMUNITYPAGE_STATIC.hasOwnProperty(s)&&(o[t.CONTENTTYPE_TO_COMMUNITYPAGE_STATIC[s]]=s);t.COMMUNITYPAGE_TO_CONTENTTYPE_STATIC=o,t.COMMUNITYPAGE_TO_CONTENTTYPE=function(e){if(t.COMMUNITYPAGE_TO_CONTENTTYPE_STATIC[e])return t.COMMUNITYPAGE_TO_CONTENTTYPE_STATIC[e];if(e.match(t.COMMUNITY_DERIVED_TYPE_PAGE_REGEXP)){if(e.startsWith(t.COMMUNITY_POST_DERIVED_TYPE_PAGE_PREFIX))return t.POST_DERIVED_TYPE_PREFIX;if(e.startsWith(t.COMMUNITY_IDEA_DERIVED_TYPE_PAGE_PREFIX))return t.IDEA_DERIVED_TYPE_PREFIX}},t.MY_NETWORK_ACTIVITY="mynetworkactivity",t.MY_BOOKMARKS="mybookmarks",t.MY_SUGGESTIONS="mysuggestions",t.THREE_DDRIVE_ID_URL_PART="3ddrive",t.DRIVE_URL_PART="drive",t.COCKPIT_URL_PART="cockpit",t.DRIVES_URL_PART="drives",t.COCKPITS_URL_PART="cockpits",t.NETWORK_URL_PART="network",t.COCKPIT_REGEXP=new RegExp("cockpit:("+t.BASE64_REGEXP+")?"),t.DRIVE_REGEXP=new RegExp("drive:("+t.BASE64_REGEXP+")?"),t.MY3DEXPERIENCE_BRAND_NAME="My3DEXPERIENCE",t.SWYM_BRAND_NAME="3DSwym",t.SKETCH_CREATION_URL_PART="sketchcreation",t.WHITEBOARD_CREATION_URL_PART="whiteboardcreation",t.STORY_CREATION_URL_PART="storycreation",t.CHANNEL_CREATION_URL_PART="channelcreation",t.CONTENT_URL_PART="content",function(e){e.North="home",e.South="south",e.East="east",e.West="west",e.Center="center"}(n=t.Quadrant||(t.Quadrant={})),t.NORTH_QUADRANT=n.North,t.EAST_QUADRANT=n.East,t.SOUTH_QUADRANT=n.South,t.WEST_QUADRANT=n.West,t.CENTER_QUADRANT=n.Center,t.COMMUNITY_URL_PART="community",t.DIRECT_MESSAGE_URL_PART="dm";var r=function(){return function(){this.communityId=null,this.dmId=null,this.ritualId=null,this.feedMode=null,this.sortMode=null,this.contentId="",this.mediaId=null,this.commentUri="",this.replyUri="",this.answerUri="",this.messageUuid="",this.contentType=null,this.userHashKey=null,this.path="",this.editionMode=!1,this.query="",this.communityFacet="",this.communityFacetName="",this.x3dsearchOptions={},this.previousAttributes={},this.contextId="",this.tenantId="",this.tenantLabel="",this.temporaryState=null,this.tenantAdminCommunityFacetName="",this.transferredToIdea=!1,this.dataAnnotation={},this.editProperties=null}}();t.ContextAttributesClass=r;var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.containerId=null,t.containerType=null,t.quadrant=null,t._initialState=null,t.coreviewData=null,t.previousAttributes={},t}return __extends(t,e),t}(r);t.M3DEContextAttributesClass=a;var c=function(){return function(){this.contextChange=!1,this.searchChange=!1,this.communityChange=!1,this.directMessageChange=!1,this.feedModeChange=!1,this.sortModeChange=!1,this.contentChange=!1,this.peopleChange=!1,this.peopleTabChange=!1,this.contextIdChange=!1,this.contentTypeChange=!1,this.tenantChange=!1}}();t.ChangeEvents=c;var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.quadrantChange=!1,t.containerChange=!1,t}return __extends(t,e),t}(c);t.M3DEChangeEvents=u}),define("DS/SwymUICore/script/lib/view/generic/swym-view",["UWA/Core","UWA/Class/View","UWA/Utils/Client","DS/UIKIT/Spinner","DS/UIKIT/Scroller","DS/SwymUICore/script/utils/utils","DS/UWPClientCode/UWA/Element","DS/WebappsUtils/Console","UWA/String"],function(e,t,i,n,o,s,r,a,c){"use strict";var u=function(){this._destroyed||!0===this._onPage||(this._onPage=!0,this._hidden||this.dispatchEvent("onShow",[this]))},l=function(){this._destroyed||!1===this._onPage||(this._onPage=!1,this._hidden||this.dispatchEvent("onHide",[this]))},d=function(e,t,i){for(var n,o=0,s=e._managedListeners[i],r=s.length;o<r;)(n=s[o]).initialEmitter===t||"function"==typeof n.initialEmitter.equals&&n.initialEmitter.equals(t)?(n.initialEmitter.removeEvent(i,n.listener,e),s.splice(o,1),r--):o++},m=function(){var e=this.getElement("> .loading-mask");e&&e.destroy(),this.removeClassName("masked")},h=function(){return this.hasClassName("masked")},p=t.extend({_widget:null,_skeleton:null,_onPage:null,_hidden:null,_rendered:null,_destroyed:null,_childViews:null,_parentView:null,_controls:null,_addScroller:null,_scrollerContentSelector:null,_managedListeners:null,_lastRefreshOptions:null,_pendingImageReloadOptions:null,_displayRichTooltips:!0,_delegateSpriteReloadToParentView:!0,_bufferImagesReload:!0,_linkGeneration:!1,_renderAfterInjection:!0,_displayPropertyBeforeHide:"",_toBeTemporarilyRemovedFromDomOnRefresh:!0,name:null,renderTo:null,container:null,imageReloadOptions:{nonReloadedImagesOnly:!0},_createContent:function(){return e.createElement("div")},_updateContainer:function(){var e,t=this._createContent.call(this,this._lastRefreshOptions);!1!==this._toBeTemporarilyRemovedFromDomOnRefresh&&(e=this.removeForFutureReinsertion(this.container)),this.container.setContent(t),!1!==this._toBeTemporarilyRemovedFromDomOnRefresh&&e()},_refresh:function(){return this.container&&(this._rendered?(this._updateContainer(),this.generateLinks(),this.bindEvents(),this.dispatchEvent("onRefresh",[this]),this.dispatchEvent("onRedraw",[this])):a.warn("Tried to refresh a non-rendered view !")),this},_checkInstance:function(t,i){var n;if(!t)throw new Error("Provided instance is not valid");if(i){if(e.is(i,"array")){n=!1;for(var o=0,s=i.length;o<s;o++)if(t instanceof i[o]){n=!0;break}}else n=t instanceof i;if(!n)throw new Error("Provided instance is not an instance of expected Class(es)")}else n=!0,a.warn("Missing Class in view definition",this.name);return t},_createOrUpdateChildView:function(e,t,i){var n=null;return i&&!0!==t.forceCreation&&i.constructor===t.Class?i.setup(t):((n=this._childViews[e]=new t.Class(t)).setParentView(e,this),i&&i.replaceWith(n)),n},getClassNames:function(){var e=this._parent.apply(this,arguments).trim().split(" ");return(e=e.filter(function(e,t,i){return i.indexOf(e)===t})).join(" ")},inject:function(){null===this._renderAfterInjection&&this.render();var e=this._parent.apply(this,arguments);return!0===this._renderAfterInjection&&this.render(),e},reactTo:function(t,i,n){var o,s=[],r=[];if(e.is(i,"object"))Object.keys(i).forEach(function(o){this.reactTo(t,o,e.merge({listener:i[o]},n))},this);else{switch(typeof n){case"function":o={listener:n};break;case"string":if("function"!=typeof this[n])throw new Error("Invalid listener");o={listener:this[n]};break;case"object":if(o=e.extend({},n),"string"==typeof n.listener&&"function"==typeof this[n.listener]&&(o.listener=this[n.listener]),"function"!=typeof o.listener)throw new Error("Missing listener");break;default:throw new Error("Invalid options")}t&&i&&(e.is(t,"array")?r=t:t&&r.push(t),"string"==typeof i?s.push(i):e.is(i,"array")&&(s=i),this._managedListeners=this._managedListeners||{},r.forEach(function(e){s.forEach(function(t){this._managedListeners[t]=this._managedListeners[t]||[],this._managedListeners[t].push({initialEmitter:e,listener:o.listener}),e.addEvent(t,o.listener,o.scope||this,o.priority||0)},this)},this))}return this},stopReactingTo:function(t,i){var n,o,s,r,a=[],c=[],u=this._managedListeners;if(e.is(t,"array")?c=t:t&&c.push(t),e.is(i,"array")?a=i:"string"==typeof i&&a.push(i),c.length>0)if(a.length>0)c.forEach(function(e){a.forEach(function(t){Object.hasOwnProperty.call(u,t)&&d(this,e,t)},this)},this);else for(n=0,o=c.length;n<o;n++)for(s in u)Object.hasOwnProperty.call(u,s)&&d(this,c[n],s);else for(s in u)if(Object.hasOwnProperty.call(u,s)){for(n=0,o=(r=u[s]).length;n<o;n++)r[n].initialEmitter.removeEvent(s,r[n].listener,this);r.splice(0)}return this},init:function(t){var i=e.extend({},e.is(t,"object")?t:{});return this._rendered=!1,this._destroyed=!1,this._hidden=!1,this._onPage=!0,this._controls={},this._childViews={},this._managedListeners={},this._bufferImagesReload=!1!==i.bufferImagesReload||i.bufferImagesReload,this.tagName||(this.tagName="div"),["attributes","imageReloadOptions"].forEach(function(t){e.is(this[t],"object")?this[t]=e.extend({},this[t]):this[t]={}},this),i._initializing=!0,Object.hasOwnProperty.call(i,"displayRichTooltips")&&(this._displayRichTooltips=i.displayRichTooltips),this._parent.call(this,i),!1===this._displayRichTooltips&&this.container.addClassName("no-rich-tooltip"),!1===this._delegateSpriteReloadToParentView&&this.container.addClassName("no-sprite-reload-delegation"),this.dispatchEvent("onInit",[this]),this.removeEvent("onInit"),this},refresh:function(e){this._lastRefreshOptions=e&&e.constructor===Object?e:null,this.isVisible()?this._refresh():this.addEventOnce("onShow",this._refresh,this)},bindEvents:function(){},isRendered:function(){return this._rendered},render:function(t){try{if(e.is(t,"object")||(t={target:t}),!0!==this.isRendered()){var i,n="bottom";switch("top"===t.position?n="top":"before"===t.position?n="before":"after"===t.position&&(n="after"),i=(i=t.target?t.target:t)||this.renderTo,e.typeOf(i)){case"string":i=window.document.getElementById(i);case"element":i=e.extendElement(i);break;default:i=null}this.renderTo=i,this.container.setContent(this._createContent.apply(this)),!0!==t.emptyTarget||"top"!==n&&"bottom"!==n||i.empty(),this._rendered=!0,this.renderTo&&this.inject(this.renderTo,n),!0!==t.emptyTarget||"before"!==n&&"after"!==n||(i.remove(),"function"==typeof i.destroy&&i.destroy()),this.generateLinks(),this.bindEvents(t),this.dispatchEvent("onRender",[this]),this.dispatchEvent("onRedraw",[this])}return this}catch(e){this.alert("warn","An error has been detected. Sorry for the inconvenience."),console.error(e)}},setWidget:function(e){var t=this._childViews;if(!e)return this;if(!this._widget)for(var i in this._parentView||(this.reactTo(e,"onDestroy",this.destroy),this.reactTo(e,"onShow",u),this.reactTo(e,"onHide",l)),this._widget=e,t)Object.hasOwnProperty.call(t,i)&&t[i].setWidget(this._widget);return this},setSkeleton:function(e){var t=this._childViews;if(!this._skeleton)for(var i in this._skeleton=e,t)Object.hasOwnProperty.call(t,i)&&t[i].setSkeleton(this._skeleton);return this},createDummyView:function(){return new g},setParentView:function(e,t){return"string"==typeof e&&t instanceof p&&(this._parentView||(this._parentView=t,this.reactTo(t,{onShow:u,onHide:l}),this._widget&&this.stopReactingTo(this._widget,["onDestroy","onShow","onHide"]),t.addChildView(e,this))),this},addChildView:function(t,i,n){var o,s,r,a,c=this,u=null,l=n&&n.callback;if("string"!=typeof t)throw new Error("The child view index is missing");if(this.isDestroyed())return null;if(a=this._childViews[t],i instanceof p)i!==a&&(u=i,this._childViews[t]=i,i.setWidget(this._widget),i.setSkeleton(this._skeleton),i.setParentView(t,this),a&&a.replaceWith(i),l&&l.call(this,i),this.dispatchEvent("onChildViewAdd:"+t,[i]));else{if(!e.is(i,"object"))throw new Error("Passed argument is neither a view nor a view configuration object");if(!(o=i.Class))throw new Error("The child view class is missing");if("string"==typeof o)return r=a||this.addChildView(t,this.createDummyView()),window.require([o],function(o){c.addChildView(t,e.merge({Class:o},i),e.merge({importChildViews:!0},n))}),r;(s=e.extend({},i)).widget=this._widget,s.skeleton=this._skeleton,u=this._createOrUpdateChildView(t,s,a,n),l&&l.call(this,u||a),this.dispatchEvent("onChildViewAdd:"+t,[u])}return u&&this.listenTo(u,"onDestroy",function(e){this._childViews[t]===e&&delete this._childViews[t]}),this._childViews[t]},addChildViews:function(t,i){var n=[];return e.is(t,"object")&&(n=Object.keys(t).map(function(e){return this.addChildView(e,t[e],i)},this)),n},removeChildView:function(e){if("string"!=typeof e)throw new Error("Invalid arguments");return this._childViews[e]&&(this._childViews[e].destroy(),delete this._childViews[e]),this},getChildView:function(e){return this._childViews[e]},getChildViews:function(t){var i;return t?(i={},t.forEach(function(e){i[e]=this.getChildView(e)})):i=e.extend({},this._childViews),i},addControl:function(e,t){if(t&&"string"==typeof e){if(this._controls[e])try{this._controls[e].destroy()}catch(e){}return this._controls[e]=t,t}throw new Error("Invalid arguments")},removeControl:function(e){if("string"==typeof e){if(this._controls[e]){try{this._controls[e].destroy()}catch(e){}delete this._controls[e]}return this}throw new Error("Invalid arguments")},getControl:function(e){return this._controls[e]},setOptions:function(t){this._parent.call(this,t);var i=!1,n=!1,o=e.extend({},t);return o?Object.hasOwnProperty.call(o,"tagName")&&(Object.hasOwnProperty.call(o,"attributes")?o.attributes.tag=o.tagName:o.attributes={tag:o.tagName}):o={},Object.hasOwnProperty.call(o,"id")&&(this.id=o.id),Object.hasOwnProperty.call(o,"domEvents")&&(this.domEvents=o.domEvents),Object.hasOwnProperty.call(o,"className")?Object.hasOwnProperty.call(o,"attributes")?o.attributes.class=o.className:o.attributes={class:o.className}:void 0!==this.className?o.className=this.className:Object.hasOwnProperty.call(this.attributes,"class")?o.className=this.attributes.class:o.className=this.options.className||"",this.options.className=o.className,Object.hasOwnProperty.call(o,"container")&&(i=!0),Object.hasOwnProperty.call(o,"attributes")&&(n=!0,this.attributes=e.extend(this.attributes,o.attributes)),this.tagName=this.attributes.tag||o.tagName||this.tagName,delete this.attributes.tag,this.className=this.attributes.class=this.getClassNames("-container"),""===this.attributes.class&&delete this.attributes.class,["container","id","attributes","className","tagName","domEvents"].forEach(function(e){void 0!==this[e]&&(o[e]=this[e])},this),o&&!0===o._initializing||(i?this.setContainer(o.container):n&&this.container.set(this.attributes)),this._parent.call(this,o)},setup:function(t){try{return t||(t={}),Object.hasOwnProperty.call(t,"renderTo")&&(this.renderTo=t.renderTo),Object.hasOwnProperty.call(t,"imageReloadOptions")&&(this.imageReloadOptions=e.extend(this.imageReloadOptions,t.imageReloadOptions)),Object.hasOwnProperty.call(t,"addScroller")&&(this._addScroller=t.addScroller),!0===this._addScroller?(this.addScroller(),this.addEvent("onRedraw",this.insertScroller)):(this.removeScroller(),this.removeEvent("onRedraw",this.insertScroller)),this.setWidget(t.widget),this.setSkeleton(s.get(t,"skeleton")),!0!==t._initializing&&this.setOptions(t),this}catch(e){console.error(e),this.alert("warn","An error has been detected. Sorry for the inconvenience.")}},generateLinks:function(){if(!0===this._linkGeneration&&this.isVisible()&&!this._destroyed){var e=this.container;window.require(["DS/SwymUICore/script/utils/link-builder-utils"],function(t){t.addHREFToLinks(e)})}},mask:function(t,o){if("element"!==e.typeOf(o)&&(o=this.container),o)return o.mask?o.mask(t):function(t){var o,s;h.call(this)&&m.call(this),this.addClassName("masked"),"static"===this.getStyle("position")?this.addClassName("relative-if-masked"):this.removeClassName("relative-if-masked"),o=e.createElement("div",{class:"loading-mask"}),i.Engine.ie&&(s=this.getSize(),o.setStyles({height:s.height+"px",width:s.width+"px"})),e.createElement("div",{class:"msg-wrap",html:{tag:"div",class:"msg-ctn",html:{tag:"p",html:[new n({className:"msg-animation",visible:!0,animate:!0,spin:!0}),e.is(t,"string")&&t?{tag:"span",class:"msg-text",text:t}:null]}}}).inject(o),o.inject(this)}.call(o,t)},unmask:function(t){if("element"!==e.typeOf(t)&&(t=this.container),t)return t.unmask?t.unmask():m.apply(t)},isMasked:function(t){if("element"!==e.typeOf(t)&&(t=this.container),t)return t.isMasked?t.isMasked():h.apply(t)},show:function(){var e=this.isVisible();if(this.container)return this.container.setStyle("display",this._displayPropertyBeforeHide),this._hidden=!1,this._onPage&&!e&&this.dispatchEvent("onShow",[this]),this.container},hide:function(){var e=this.isVisible();if(this.container&&!this._hidden){var t=this.container.getAttribute("display");if("none"!==t)return this._displayPropertyBeforeHide=t||"",this.container.setStyle("display","none"),this._hidden=!0,e&&this.dispatchEvent("onHide",[this]),this.container}},isVisible:function(){return!(!this._onPage||this._hidden)},getDelayedSyncTask:s.getDelayedSyncTask,replaceWith:function(e,t){return this.container.getParent()&&e.inject(this.container,"before"),!0===this._hidden&&e.hide(),!1!==t?this.destroy():this.container.remove(),e},getScroller:function(){return this.getControl("scroller_for_view_"+this.cid)},insertScroller:function(){var t,i=this._scrollerContentSelector;if(t="string"==typeof i?this.container.getElement(i):this.container){var n=e.createElement("div",{html:t.getChildren(),styles:{height:"100%"}});t.setContent(n),this.addControl("scroller_for_view_"+this.cid,new o({element:t.firstElementChild})).inject(t)}},addScroller:function(){return this.getScroller()||this.insertScroller(),this},removeScroller:function(){var e=this.getScroller();if(e){var t=e.elements.content.getChildren();this.container.setContent(t),this.removeControl("scroller_for_view_"+this.cid),delete e.elements.container}return this},alert:function(e,t){window.require(["DS/UWPClientControls/PlatformNotify"],function(i){switch(e){case"error":i.error(t);break;case"success":i.success(t);break;case"warn":i.warn(t);break;case"info":i.info(t);break;default:throw new Error("Invalid alert options"+e+"does not exist")}})},removeForFutureReinsertion:s.removeForFutureReinsertion,destroy:function(){if(!0!==this._destroyed){var e,t,i=this._controls,n=this._childViews;for(e in this._destroyed=!0,i)Object.hasOwnProperty.call(i,e)&&((i[e].container||i[e].elements&&i[e].elements.container)&&i[e].destroy(),delete i[e]);for(e in n)Object.hasOwnProperty.call(n,e)&&n[e].destroy();return this.dispatchEvent("onDestroy",[this]),this.stopReactingTo(),this.stopListening(),this._parentView=null,this._widget=null,this._skeleton=null,this._renderTo=null,this._managedListeners=null,this._lastRefreshOptions=null,this._rendered=!1,t=this._parent(),this.container=null,this.tagName=null,this.className=null,this.attributes=null,this.domEvents=null,t}},isDestroyed:function(){return this._destroyed}}),g=p.extend({name:"dummy-view"});return p}),define("DS/SwymUICore/script/utils/usage-tracker",["require","exports","UWA/Core","DS/Usage/TrackerAPI","DS/SwymUICore/script/utils/utils","DS/Logger/Logger","DS/SwymUICore/script/utils/routing"],function(e,t,i,n,o,s,r){"use strict";var a={FavoriteCommunities:["createFavorite","reorderFavorite","deleteFavorite","navigateToAllMyCommunities"],FavoriteConversations:["createFavorite","reorderFavorite","deleteFavorite"],ThreadTabs:["showCommunities","showConversations"],ThreadToolbar:["searchCommunity","searchConversation","filterActiveCommunities","filterActiveConversations","createConversation"],ThreadPage:["openContextualMenu","clickItemInContextualMenu"],MyCommunities:["navigateToCommunity","navigateToActiveCommunity","navigateToActiveFavoriteCommunity","navigateToFavoriteCommunity","navigateToWhatsNew","loadNextCommunitiesPage","navigateToAllMyCommunities","createFavoriteThroughContextualMenu","deleteFavoriteThroughContextualMenu","unFollowThroughContextualMenu","markAsReadThroughContextualMenu"],MyConversations:["creationWithStartNowLink","navigateToConversation","navigateToActiveFavoriteConversation","navigateToFavoriteConversation","navigateToActiveConversation","hideAConversation","loadNextConversationsPage","createFavoriteThroughContextualMenu","deleteFavoriteThroughContextualMenu","closeThroughContextualMenu","markAsReadThroughContextualMenu","restoreThroughContextualMenu"],SwitchWhatsNewTimeline:["clickOnSwitcher","clickOnSorter","sortByCreation","sortByLatest","switchToCompactView","switchToWhatsNew","switchToTimeline"],Communication:["startAudioCall","startVideoCall"],UnreadMessageAlert:["goToFirstUnreadMessage","closeFirstUnreadMessageAlert","FirstUnreadMessageDisplayed"],NewMessageAlert:["goToNewlyReceivedMessage","closeNewlyReceivedMessageAlert","NewlyReceivedMessageDisplayed"],SocialToolbar:["like","unlike","share","reply","comment","commentSavedWithEnterKey","commentSavedWithSendButton"],ContentCreation:["cancelCreation","switchToAdvancedCreation","automaticSwitchToAdvancedCreation","saveAsDraft","publishContent","publishFailed","openMediaLibrary","uploadMedia","openParagraphFormatter","closeParagraphFormatter","messageSavedWithSendButton","messageSavedWithEnterKey","publishSketch","publishStory","publishWhiteboard","createSketchIconClick","createStoryIconClick","createWhiteboardIconClick","createTextIconClick","createSlideIconClick","createTableIconClick"],AutoSave:["contentSaved","contentDestroyed","contentRestored"],Collaboration:["readOfficeDocumentInODE","editOfficeDocumentInODE"],Bookmark:["createBookmark","deleteBookmark","navigateToBookmark","navigateToMyBookmarks"],Ritual:["navigateToRituals","navigateToRitual"],Rendezvous:["startReport","startEditDraftReport","publishReport","saveReportAsDraft","exitReportMode","startEditPublishedReport"],NetworkActivity:["navigateToMyNetworkActivity"],Accordion:["open","close"],NavigationMenu:["navigateToWhatsNew","navigateToMyNetworkActivity","navigateToConversations","navigateToRituals","navigateToMyBookmarks","navigateToManagement"],ContentContextualActionMenu:["forwardContent","forwardFailed","editClicked"],PlusMenu:["addMessage","addPost","addMedia","addQuestion","addIdea","addWikiPage","addSurvey","addWedo","addConference","createCommunity","createConversation"],CommunityTags:["selectTagInCommunityHeader","deselectTagInCommunityHeader","clickViewMoreInCommunityHeader","clickViewLessInCommunityHeader","selectTagInContentCreationFooter","deselectTagInContentCreationFooter","clickViewMoreInContentCreationFooter","clickViewLessInContentCreationFooter","selectTagInContentEditionFooter","deselectTagInContentEditionFooter","clickViewMoreInContentEditionFooter","clickViewLessInContentEditionFooter","selectTagInContentDisplayFooter","creationInlineTag","creationInlineCommunityTag","selectInlineTagInContentDisplay","selectInlineCommunityTagInContentDisplay","addCommunityTagsInSettings","removeCommunityTagsInSettings","clickApplyInSettings","clickCancelInSettings"],DesktopNotification:["displayDesktopNotification","clickDesktopNotification"],ConversationMembers:["createNewConversationFromPrivateConversation","addMemberToGroupConversation","goToRecentConversation","createNewConversationFromModal","editConversationMembers"],Lightbox:["ViewLightboxCreation","closeViewLightbox","iconComment","iconDownload","iconShare","iconInformation","iconNext","iconPrevious","editMediaPropertiesSecondaryMenu","editMediaPropertiesInfoPanel","PublishPropertiesButtonClick","ViewLightboxEdition","SaveAsDraftButtonClick","PublishButtonClick","CloseLightboxEdition"],Annotation:["loadAnnotation","createAnnotation"],WikiLockConcurrentEdition:["wikiLockPopupDisplayed","clickOkWikiOutdatedPopupWithAutomaticRefresh","clickCloseWikiOutdatedPopupWithAutomaticRefresh","clickOkWikiOutdatedPopupForManualMerge","clickCancelWikiOutdatedPopupForManualMerge"]},c=["drag","drop","play","hover","pause","click","input","scroll","cut","copy","paste","upload"];function u(e){var t={},i=1;return e.forEach(function(e){t["pd".concat(i)]=e,i+=1}),t}function l(){return window.ds&&"3DD"===window.ds.env&&window.widget?window.widget.getAppName&&window.widget.getAppName():window.ds&&window.ds.isMDE?"My3DExperience":"3DSwym"}return{trackPageView:function(e,t){var i=o.getNbLayoutColumns(),a=null,c=null,d=null;try{r.isPublic(r.getPathNameFromUrl(window.location.href))?n.trackPageView(e,t):(a=1===i?"1ColumnLayout":"".concat(i,"ColumnsLayout"),window.require(["DS/SwymUICore/script/feature/core/config/bootstrap-model"],function(i){var o=i.getInstance();o.executeWhenReady(function(){window.require(["DS/SwymUICore/script/feature/core/context/context-model"],function(i){c=[o.get("config").tenant.id,l(),a],(d=i.getInstance().isCommunityContext())&&c.push(d),n.trackPageView(e,t,u(c))})})}))}catch(e){s.error("UsageTracker@trackPageView error: ".concat(e))}},trackPageEvent:function(e){try{window.require(["DS/SwymUICore/script/feature/core/config/bootstrap-model"],function(t){var o=Object.hasOwnProperty.call(e,"category")&&Object.hasOwnProperty.call(e,"label")&&function(e,t){if(Object.hasOwnProperty.call(a,e)){if(a[e].indexOf(t)>=0)return!0;s.error("Label: ".concat(t," does not exist for following category: ").concat(e))}else s.error("Category: ".concat(e," is not declared as a tracker category"));return!1}(e.category,e.label),r=o?"swym."+e.category:null,d=o?e.label:null,m=Object.hasOwnProperty.call(e,"event")&&function(e){return c.indexOf(e)>=0||(e&&""!==e&&s.error("Event: ".concat(e," is not a valid event for a tracker.")),!1)}(e.event)?e.event:"",h=Object.hasOwnProperty.call(e,"value")&&e.value===parseInt(e.value,10)?e.value:1,p=Object.hasOwnProperty.call(e,"view")?{pd1:e.view}:{},g=t.getInstance(),f={tenant:void 0,appID:void 0};if(p=Object.hasOwnProperty.call(e,"contentType")?i.extend(p,{pd2:e.contentType}):p,Object.keys(e).length>Object.keys(p).length+3){var _=[];Object.keys(e).forEach(function(t){["event","label","content","value","view","contentType","category"].includes(t)||_.push(e[t])}),p=i.extend(p,u(_))}g.executeWhenReady(function(){f.tenant=g.get("config").tenant.id,f.appID=l(),r&&d&&n.trackPageEvent(r,m,d,h,p,f)})})}catch(e){s.error("UsageTracker@trackPageEvent error: ".concat(e))}}}}),define("DS/SwymUICore/script/feature/container/container-utils",["require","exports","DS/SwymUICore/script/feature/core/context/context-constants"],function(e,t,i){"use strict";var n=/^drive:/,o=/^swym:/,s=/^dashboard:/,r="DriveFile";return{getContainerTypeFromSource:function(e){var t=null;return(e=e||"").match(n)?t=i.DRIVE_URL_PART:e.match(s)?t=i.COCKPIT_URL_PART:e.match(o)&&(t=i.COMMUNITY_URL_PART),t},getContainerIdFromSource:function(e,t){var n=null;return e===i.DRIVE_URL_PART&&(n=i.THREE_DDRIVE_ID_URL_PART),e===i.COCKPIT_URL_PART&&(n=t.get("mid")),e===i.COMMUNITY_URL_PART&&(n=encodeURIComponent(t.get("ds6w:community"))),n},isDriveFile:function(e){var t=!1;return e===r&&(t=!0),t}}}),define("DS/SwymUICore/script/feature/community/derived-type/derived-type-styles-manager",["require","exports","DS/SwymUICore/script/feature/community/derived-type/derived-type-data-utils","DS/Logger/Logger"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getClassNameFromTypeName=t.addDerivedTypeStyle=void 0;var o=new Set,s=document.createElement("style");document.head.appendChild(s);var r=s.sheet;t.addDerivedTypeStyle=function(e){var t,s,a,c,u,l,d,m,h,p,g,f,_,y,w,C,S,I,v,T=i.createTypeNameForDerivedType(e),E=e.color,b=new RegExp("^-?[_a-zA-Z]+[_a-zA-Z0-9-]*$");"string"==typeof T&&b.test(T)?o.has(T)||(t=".item.".concat(T," .fonticon"),s=".community-content-wrapper .content-icon.".concat(T),a=".content-in-feed-summary-view-container.".concat(T," .content-title-section"),c=".content-in-feed-view-container.".concat(T,".full-content"),u='body.swym-im .community-filters-view .community-filter-item[data-content-type="'.concat(T,'"]'),l='body.swym-im .community-filters-view[data-content-type-selected="'.concat(T,'"] .community-filter-item[data-content-type="').concat(T,'"]'),d=".scrollable-body .ideas-pipeline-view-container .home-view-wrapper .contribution-model-view.".concat(T," .content-icon"),m=".preview-container .icon-type-container.".concat(T),h=".community-my-contributions-view-container .fonticon.content-icon.".concat(T),p=".scrollable-body .ideas-pipeline-view-container .title-wrapper .content-icon.".concat(T),g=".scrollable-body .ideas-pipeline-view-container .title-wrapper.".concat(T),f='.community-contextual-action-menu .item[name="'.concat(T,'"] .fonticon'),_="background-color: ".concat(E,"; \n"),I="background-color: ".concat(E,"; \n"),v="border-top: 3px solid ".concat(E,"; \n"),y="border-top: 2px solid ".concat(E," !important; \n"),w=" background-color: ".concat(E,"; \n\n                            transition: opacity 1s ease; \n\n                            opacity: 1; \n\n                            font-size: 21px; \n\n                            margin-top: 1px; \n\n                            margin-bottom: 0px; \n\n            "),C=" border-radius: 4px;\n                            color: white;\n                            background-color: ".concat(E,";\n                            font-size: 22px;\n                            margin: 0 0;\n                            height: 38px;\n                            min-width: 38px;\n                            line-height: 38px;\n            "),S="color: ".concat(E,"; \n"),r.insertRule("".concat(t,"{").concat(_,"}"),r.cssRules.length),r.insertRule("".concat(s,"{").concat(_,"}"),r.cssRules.length),r.insertRule("".concat(a,"{").concat(y,"}"),r.cssRules.length),r.insertRule("".concat(c,"{").concat(y,"}"),r.cssRules.length),r.insertRule("".concat(u,"{").concat(_,"}"),r.cssRules.length),r.insertRule("".concat(l,"{").concat(w,"}"),r.cssRules.length),r.insertRule("".concat(d,"{").concat(C,"}"),r.cssRules.length),r.insertRule("".concat(m,"{").concat(_,"}"),r.cssRules.length),r.insertRule("".concat(h,"{").concat(_,"}"),r.cssRules.length),r.insertRule("".concat(f,"{").concat(S,"}"),r.cssRules.length),r.insertRule("".concat(p,"{").concat(I,"}"),r.cssRules.length),r.insertRule("".concat(g,"{").concat(v,"}"),r.cssRules.length),o.add(T)):n.error("dtkey is not a valid css class",T)},t.getClassNameFromTypeName=function(e){return i.createTypeNameForDerivedType(e)}}),define("DS/SwymUICore/script/feature/core/context/mde/south-context-mixin",["require","exports","DS/SwymUICore/script/feature/core/context/context-constants"],function(e,t,i){"use strict";return{_extractContextInfoFromRouteSouth:function(e,t){var n;(n=e.match(i.DRIVE_REGEXP))&&(t.containerType=i.DRIVE_URL_PART,t.containerId=n[1]),(n=e.match(i.COMMUNITY_REGEXP))&&(t.containerType="community",t.containerId=decodeURIComponent(n[1]))},_dispatchChangeEventsSouth:function(e){}}}),define("DS/SwymUICore/script/feature/core/context/mde/east-context-mixin",["require","exports","DS/SwymUICore/script/feature/core/context/context-constants"],function(e,t,i){"use strict";return{_extractContextInfoFromRouteEast:function(e,t){var n,o,s;(n=e.match(i.COCKPIT_REGEXP))?(t.containerType=i.COCKPIT_URL_PART,t.containerId=n[1]):(o=e.split("/")).length>1&&((s=o[1].split(":"))[0]&&(t.containerType=s[0]),s[1]&&(t.containerId=s[1]))},_dispatchChangeEventsEast:function(e){}}}),define("DS/SwymUICore/script/feature/core/context/mde/west-context-mixin",["require","exports","DS/SwymUICore/script/feature/core/context/context-constants"],function(e,t,i){"use strict";return{_extractContextInfoFromRouteWest:function(e,t){var n;(n=e.match(i.DRIVE_REGEXP))&&(t.containerType=i.DRIVE_URL_PART,t.containerId=n[1]),(n=e.match(i.COMMUNITY_REGEXP))&&(t.containerType="community",t.containerId=decodeURIComponent(n[1]))},_dispatchChangeEventsWest:function(e){}}}),define("DS/SwymUICore/script/lib/request/lost-session-manager",["require","exports","DS/SwymUICore/script/utils/utils","DS/WAFData/WAFData","DS/Logger/Logger","UWA/Class/Promise","DS/SwymUICore/script/utils/platform-utils"],function(e,t,i,n,o,s,r){"use strict";var a,c;return window.require(["DS/SwymUICore/script/lib/request/data"],function(e){a=e}),window.require(["DS/SwymUICore/script/feature/core/config/bootstrap-model"],function(e){c=e}),function(){function e(){this._sessionReestablishmentSequenceOngoing=!1,this._pendingCalls=[]}return e.prototype._fetchServiceTicket=function(){var e;c.getInstance().get("config").tenant.online_instance_id;return new s(function(t){r.getPassportURLPromise().then(function(s){e=s+"/login?service="+i.getBaseUrl()+"/api/index/tk&gateway=true",n.authenticatedRequest(e,{onComplete:function(e){var i=JSON.parse(e);i&&i.access_token&&i.x3ds_service_url?t(i.access_token):o.error("Passport error, no service ticket fetched",arguments)}})})})},e.prototype._authAndFetchToken=function(e){var t=c.getInstance(),r=t.get("config").tenant.online_instance_id;return new s(function(s){n.authenticatedRequest(i.getBaseUrl()+"/api/index/tk?ticket="+e,{onComplete:function(e){var i=JSON.parse(e);i&&i.result&&i.result.ServerToken?(t.setCSRFToken(i.result.ServerToken,r),s(i.result.ServerToken)):o.error("Passport error, no service ticket fetched",arguments)}})})},e.prototype._reestablishSession=function(){var e=this;return this._sessionReestablishmentSequenceOngoing=!0,this._fetchServiceTicket().then(this._authAndFetchToken,o.error).then(function(){e._sessionReestablishmentSequenceOngoing=!1})},e.prototype._reExecuteCalls=function(){for(var e;this._pendingCalls.length>0;)e=this._pendingCalls.shift(),a.request(e)},e.prototype.reExecuteCall=function(e){this._sessionReestablishmentSequenceOngoing||s.resolve("").then(this._reestablishSession.bind(this),o.error).then(this._reExecuteCalls.bind(this),o.error),this._pendingCalls.push(e)},e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e}()}),define("DS/SwymUICore/script/lib/request/data",["require","exports","UWA/Core","UWA/Class/Events","UWA/Json","UWA/Utils","DS/WAFData/WAFData","DS/SwymUICore/script/utils/utils","DS/UWPClientCode/PublicAPI","DS/SwymUICore/script/lib/request/lost-session-manager","DS/Logger/Logger","DS/SwymUICore/script/utils/platform-utils"],function(e,t,i,n,o,s,r,a,c,u,l,d){"use strict";var m,h=null;window.require(["DS/SwymUICore/script/feature/core/config/bootstrap-model"],function(e){h=e});var p=function(e){var t,n=e||{};if(!n.variableName)throw new Error("Variable name is missing");if(!n.callback)throw new Error("Callback is missing");""===n.variableName?d.getPassportURLPromise().then(function(e){t=e}):t=c.getApplicationConfiguration(n.variableName),t?e.callback():(i.is(n.retries,"number")?n.retries=n.retries-1:n.retries=0,n.retries>=0&&setTimeout(function(){p.call(this,n)}.bind(this),n.delay||200))},g=function(e){_(e),f(e)},f=function(e){e&&e.new_cas_session?(l.log("SEND CAS SESSION REFRESH"),l.error("CASSessionRefresh event fired, to be migrated!!!!!!")):e||l.error("handleNewCASSession : bad data ")},_=function(e){e&&e.logout&&d.getPassportURLPromise().then(function(e){var t=e+"/cas/logout";""!==t?(l.log("RECEIVED LOGOUT NOTIFICATION "+t),window.location.href=t):l.log("no passport logout url")})},y=function(e,t,n,o){var r;switch(e&&"string"==typeof e.message&&(r=e.message.replace(/.*(\d{3}).*/g,"$1")),r=parseInt(r,10)){case 403:return t&&t.errorcode&&["ERROR_ACCESS_FORBIDDEN_LICENSE_EXPIRED","ERROR_ACCESS_FORBIDDEN_LICENSE_FULLY_CONSUMED","ERROR_LICENSING_EXTENSION_KO","ERROR_ACCESS_FORBIDDEN_NOT_ACTIVE","ERROR_ACCESS_FORBIDDEN_CSRF_KO","ERROR_ACCESS_NO_LICENSE"].indexOf(t.errorcode)>-1?"ERROR_ACCESS_FORBIDDEN_NOT_ACTIVE"===t.errorcode?function(e){var t,i,n=e&&e.url&&new URL(e.url),o=window.location.host.split("-")[0].toUpperCase(),r=s.base64Encode(window.location.href).replace(/\+/g,"-").replace(/\//g,"-").replace(/=+$/,"");"MY.3DEXPERIENCE.3DS.COM"===o&&n&&"MY.3DEXPERIENCE.3DS.COM"!==(i=n.host.split("-")[0].toUpperCase())&&(o=i),d.getMyAppsURLPromise().then(function(e){t=e+"/resources/AppsMngtSynchro/api/v1/?service=3DSwym&url="+r+"&platform="+o,l.log("handleInactiveUser, redirectUrl:"+t),window.location.href=t})}(o):"ERROR_ACCESS_FORBIDDEN_CSRF_KO"===t.errorcode?u.getInstance().reExecuteCall(o):window.require(["DS/SwymUICore/script/feature/core/error/view/error-view"],function(e){var n=new e({error:t,errorCode:r});i.extendElement(document.body).empty(),n.inject(document.body)}):w(this,t,n,o,r),!1;case 404:!window.ds||"3DSwym"!==window.ds.env&&"catia"!==window.ds.env?window.ds&&"3DD"===window.ds.env&&w(this,t,n,o,r):(l.error("404 error",arguments),o.onFailure&&o.onFailure(t));break;default:w(this,t,n,o,r)}},w=function(e,t,i,n,o){l.error("HTTP error",o),n.onFailure&&n.onFailure.call(e,t,i,n)},C=function(e,t,i,n){g(t),y(e,t,i,n)},S=function(e,t){return!0===t.proxifiedRequest?r.proxifiedRequest(e,t):r.authenticatedRequest(e,t)};return(m=n.singleton({executeWhenPublicApiInfoIsAvailable:p,request:function(e){var t=!1,n=e.url,r=this,c=a.getBaseUrl(),u=i.merge({onComplete:function(t,i,n){if("string"==typeof t&&i&&i["Content-Type"]&&i["Content-Type"].contains("application/json"))try{t=o.decode(t)}catch(e){t={},l.warn("The result of the request is not in a JSON format")}(function(e,t,i,n){try{if(e&&(e.errorcode||e.errorid))C.call(this,new Error(e.errorcode||e.errorid),e,t,i);else if(g(e),i.onComplete){var o=function(e){h=e,s()},s=function(){i.onComplete.call(this,e,t,i,n)};h?o(h):window.require(["DS/SwymUICore/script/feature/core/config/bootstrap-model"],o)}}catch(e){l.error("Exception caught",e)}}).call(this,t,i,e,n)},onFailure:function(t,i,n){C.call(this,t,i,n,e)}},e);if(n.contains("://")||0===n.indexOf(c)||(n=c+("/"===n[0]?"":"/")+n),i.merge(u,{headers:{},method:"POST",type:"json"}),u.data&&"get"===u.method.toLowerCase()?u.data=s.toQueryString(u.data):"json"!==u.dataType&&void 0!==u.dataType||(u.data&&(!1!==u.wrapData?u.data=o.encode({params:u.data}):u.data=o.encode(u.data)),u.headers["Content-Type"]||(u.headers["Content-Type"]="application/json;charset=utf-8")),h){var d=h.getInstance();d&&d.getCSRFToken()&&!0!==u.noCsrfToken?u.headers["X-DS-SWYM-CSRFTOKEN"]=d.getCSRFToken():l.log("No token yet")}else l.log("No bootstrap yet");if(window.ds&&"3DSwym"===window.ds.env){var m,p={cancel:function(){t=!0,m&&m.cancel&&m.cancel()}},f=function(e){return t||(!0===u.bypassConfigLoadCheck||!0===u.noCsrfToken?(m=S(n,u),r.dispatchEvent("onRequest",[m.xhr])):e.getInstance().executeWhenReady(function(){if(!t){var e=this.getCSRFToken();e&&(u.headers["X-DS-SWYM-CSRFTOKEN"]=e),m=S(n,u),r.dispatchEvent("onRequest",[m.xhr])}})),m};return h?f(h):window.require(["DS/SwymUICore/script/feature/core/config/bootstrap-model"],f),m||p}return S(n,u)}})).init(),m}),define("DS/SwymUICore/script/feature/core/context/mde/center-context-mixin",["require","exports","DS/SwymUICore/script/feature/core/context/context-constants"],function(e,t,i){"use strict";return{_extractContextInfoFromRouteCenter:function(e,t){var n;(n=e.match(i.DRIVE_REGEXP))&&(t.containerType=i.DRIVE_URL_PART,t.containerId=n[1]),(n=e.match(i.COMMUNITY_REGEXP))&&(t.containerType="community",t.containerId=decodeURIComponent(n[1]))},_dispatchChangeEventsCenter:function(e){}}}),define("DS/SwymUICore/script/feature/core/stats-manager/stats-manager",["require","exports","UWA/Core","DS/SwymUICore/script/lib/request/data","UWA/Json","UWA/Class","UWA/Utils/Client"],function(e,t,i,n,o,s,r){"use strict";return s.singleton({defaultOptions:{serviceUrl:null,sessionUid:null,delay:60},_stats:[],setup:function(e){this.options=i.extend(this.defaultOptions,e),window.setInterval(this.save.bind(this,!1),1e3*this.options.delay),window.addEventListener("beforeunload",this.save.bind(this,!0))},push:function(e){this._stats.push(i.clone(e))},save:function(e){var t,s=this.options,a=this._stats,c={"Content-Type":"application/json","X-DS-SWYM-CSRFTOKEN":s.csrfToken};a.length>0&&(t={session_uid:s.sessionUid,history:i.clone(this._stats)},a.length=0,!0===e&&i.is(window.fetch,"function")&&(!r.Engine.firefox||window.ds&&"3DSwym"===window.ds.env)?window.fetch(s.serviceUrl,{method:"POST",cache:"no-cache",credentials:"include",headers:c,body:o.encode({params:t})}):n.request({url:s.serviceUrl,timeout:15e3,method:"POST",async:!e,headers:c,data:t}))}})}),define("DS/SwymUICore/script/feature/core/context/mde/north-context-mixin",["require","exports","UWA/Core","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/stats-manager/stats-manager","DS/SwymUICore/script/feature/core/context/context-constants"],function(e,t,i,n,o,s){"use strict";var r;window.require(["DS/SwymUICore/script/utils/app-navigation-state"],function(e){r=e});var a=null,c=null,u=null,l=null;return{_getURLForStatsManager:function(){var e,t=document.location.href;return window.ds&&"3DSwym"===ds.env||(e=window.widget?window.widget.getValue("appId"):"",t=n.getBaseUrl()+"?app="+e+"/"+this.path),t},_pushStat:function(e){var t=this._getURLForStatsManager(),i={type:"api",url:e.url||t};e.model&&(i.model=e.model),e.model_id&&(i.model_id=e.model_id),o.push(i)},_sendStats:function(e){e.contentChange?this._pushStat({model:this.contentType,model_id:this.contentId,community_id:this.communityId}):null!==this.communityId&&null===this.contentId?this._pushStat({model:"community",model_id:this.communityId,community_id:this.communityId}):e.peopleChange?this._pushStat({model:"user",model_id:this.userHashKey}):e.searchChange&&this.query&&window.ds&&"3DSwym"===ds.env?window.require(["DS/SwymUICore/script/utils/navigation"],function(e){this._pushStat({url:n.getBaseUrl()+"/"+e.URLPART_SEARCH+encodeURIComponent(this.query)+(this.searchType?e.URLTYPE_SEARCH+this.searchType:"")})}.bind(this)):e.tenantChange&&window.ds&&"3DSwym"===ds.env?window.require(["DS/SwymUICore/script/utils/navigation"],function(e){this._pushStat({url:n.getBaseUrl()+"/"+e.URLPART_ADMIN})}.bind(this)):e.contextIdChange||this.contentId||this._pushStat({model:this.communityId?"community":null,model_id:this.communityId,community_id:this.communityId})},_dispatchChangeEventsNorth:function(e){e.communityChange&&(this.isAdminContext()||this.dispatchEvent("onCommunityChange",{communityId:this.communityId},!0),e.directMessageChange&&this.dispatchEvent("onDirectMessageChange",{dmId:this.dmId},!0)),e.feedModeChange&&(this.dmId?(r.saveDMFeedMode(this.feedMode),c=this.feedMode):(r.saveCtyFeedMode(this.feedMode),a=this.feedMode),this.dispatchEvent("onFeedModeChange",{feedMode:this.feedMode},!0)),e.sortModeChange&&(this.dmId?(r.saveDMSortMode(this.sortMode),u=this.sortMode):(r.saveCtySortMode(this.sortMode),l=this.sortMode),this.dispatchEvent("onSortModeChange",{sortMode:this.sortMode},!0)),(e.communityChange||e.directMessageChange)&&this.dispatchEvent("onThreadChange",{dmId:this.dmId,communityId:this.communityId},!0);var t,i,n,o={contentId:this.contentId};if(e.contentChange||e.contentTypeChange){switch(this.contentType){case"idea":t="onIdeaChange";break;case"media":t="onMediaChange";break;case"iquestion":t="onIQuestionChange";break;case"post":t="onPostChange";break;case"survey":t="onSurveyChange";break;case"wiki":t="onWikiChange",o.communityId=this.communityId}this.dispatchEvent(t,o,!0)}if(e.peopleTabChange||e.peopleChange){if(n="0",i=this.path.split("/")[1])switch(i){case"activities":n="0";break;case"aboutme":n="1";break;case"connections":n="2";break;case"settings":n="3"}e.peopleChange&&this.dispatchEvent("onPeopleChange",{userHashKey:this.userHashKey,tabNumber:n},!0),e.peopleTabChange&&this.dispatchEvent("onPeopleTabChange",{userHashKey:this.userHashKey,tabNumber:n},!0)}e.searchChange&&this.dispatchEvent("onSearchChange",{query:this.query,x3dsearchOptions:this.x3dsearchOptions},!0),e.tenantChange&&this.dispatchEvent("onTenantChange",{tenantId:this.tenantId,tenantLabel:this.tenantLabel},!0),this.dispatchEvent("onContextChangeAttempt",{success:e.contextChange})},_throwErrorsOnResetNorth:function(e){if(!e.path||!e.path.contains("#content:")){if(e.contentId&&!e.containerId&&!e.contentType&&!e.communityId)throw new Error("Trying to reset the context with a contentId without a contentType or a communityId");if(e.commentUri&&!e.contentId)throw new Error("Trying to reset the context with a commentUri without a contentId");if(e.replyUri&&!e.commentUri)throw new Error("Trying to reset the context with a replyUri without a commentUri");if(e.answerUri&&(!e.contentId||"iquestion"!==e.contentType))throw new Error("Trying to reset the answer's URI without providing the related question");if(e.messageUuid&&!e.communityId)throw new Error("Trying to reset the context with a messageUuid without a communityId")}},_specialTreatmenForFeedModeInNorthQuadrant:function(e,t){e.feedModeChange||(this.dmId&&(this.isPreviousContextACommunity()||this.isPreviousContextNotACommunityOrDM(this.previousAttributes))?(this.feedMode=r.getDMFeedMode()||n.SWYM_IM_CENTRAL_COLUMN_DEFAULT_MODE_CONVERSATION,t.feedMode=this.feedMode,c=this.feedMode):!this.dmId&&this.communityId&&(this.isPreviousContextADM()||this.isPreviousContextNotACommunityOrDM(this.previousAttributes))?(this.feedMode=r.getCtyFeedMode()||n.SWYM_IM_CENTRAL_COLUMN_DEFAULT_MODE_COMMUNITY,t.feedMode=this.feedMode,a=this.feedMode):this.feedMode=this.dmId?c:a)},_defaultSettingForSortModeInNorthQuadrant:function(e,t){e.sortModeChange||(this.dmId&&(this.isPreviousContextACommunity()||this.isPreviousContextNotACommunityOrDM(this.previousAttributes))?(this.sortMode=r.getDMSortMode()||n.SWYM_IM_CENTRAL_COLUMN_DEFAULT_SORT_MODE,t.sortMode=this.sortMode,u=this.sortMode):!this.dmId&&this.communityId&&(this.isPreviousContextADM()||this.isPreviousContextNotACommunityOrDM(this.previousAttributes))?(this.sortMode=r.getCtySortMode()||n.SWYM_IM_CENTRAL_COLUMN_DEFAULT_SORT_MODE,t.sortMode=this.sortMode,l=this.sortMode):this.sortMode=this.dmId?u:l)},isPreviousContextACommunity:function(){var e=this.previousAttributes;return e.communityId&&!e.dmId},isPreviousContextADM:function(){return this.previousAttributes.dmId},isPreviousContextNotACommunityOrDM:function(e){return!e.dmId&&!e.communityId},isPreviousPathAListing:function(e){var t=e||this.previousAttributes,o=t.path,r=t.userHashKey,a=t.communityId,c=t.contentId,u=window.widget&&window.widget.getAppName&&window.widget.getAppName()===n.getContentReaderAppKey(),l=[s.COMMUNITY_MY_CONTRIBUTIONS,s.COMMUNITY_BLOG,s.COMMUNITY_MEDIA,s.COMMUNITY_GALLERY,s.COMMUNITY_IDEAS,s.COMMUNITY_IDEAS_PIPELINE,s.COMMUNITY_QUESTIONS,s.COMMUNITY_SURVEYS,s.COMMUNITY_WIKI,s.COMMUNITY_WEDO,s.COMMUNITY_SOCIAL_EVENTS],d=this.getCommunityPageContext(o),m=!1;return u?"home"===o&&(m=!0):(o===s.EAST_QUADRANT||o===s.SOUTH_QUADRANT||o===s.WEST_QUADRANT||o.match(/^east\/channel:[^\/]+$/g)||""===o||"home"===o||o===s.MY_BOOKMARKS||o===s.MY_SUGGESTIONS||a&&!d||l.indexOf(d)>-1&&!c||r||i.is(o,"string")&&o.contains("search")&&t.query||"admin-tenant/whatsnew"===o||"admin-tenant/media"===o)&&(m=!0),m},getLastAccessedContentListContext:function(){var e=this.previousAttributes||{},t=e&&e.path;return!t&&this.isCommunityContext()&&this.path!=="community:"+this.communityId&&(t="community:"+this.communityId,e={communityId:this.communityId,path:t}),t&&t.startsWith("community")?e&&this.isContentContext(e)?{communityId:e.communityId,path:"community:"+e.communityId}:e:{communityId:null,path:"home"}},getLayoutPath:function(e){var t=void 0,i=e?this.getRoute(e):this.getRoute(),n=i.match(s.COMMUNITY_MEDIA_HOME_REGEXP),o=i.match(s.COMMUNITY_WIKI_HOME_REGEXP);n&&2===n.length&&n[1]===s.COMMUNITY_MEDIA&&(t=i.replace(new RegExp(s.MEDIA_FILTERED),"mediaFiltered")),o&&o[2]===s.COMMUNITY_WIKI&&(t=i.replace(new RegExp(s.WIKI_IN_COMMUNITY_WIKI_HOME),"communitywiki"));var r=i.split("/content:");return r.length>1&&(t="generic-content:"+r[1]),t||i},computeRoute:function(e){var t="",i=window.widget&&window.widget.getAppName&&window.widget.getAppName()===n.getContentReaderAppKey();return e.userHashKey?t="people:"+e.userHashKey+"/activities":(e.dmId?(t="dm:"+e.dmId,e.messageUuid&&(t+="/message:"+e.messageUuid)):e.communityId?i||(t="community:"+e.communityId,e.messageUuid&&(t+="/message:"+e.messageUuid)):e.query&&(t="search:"+encodeURIComponent(e.query)),(e.dmId||e.communityId||i)&&(e.contentType&&this.isContentContext(e)&&(t+=(t?"/":"")+e.contentType+(e.contentId?":"+e.contentId+(e.answerUri?"/answer:"+encodeURIComponent(e.answerUri):"")+(e.commentUri?"/comment:"+encodeURIComponent(e.commentUri)+(e.replyUri?"/reply:"+encodeURIComponent(e.replyUri):""):""):""),e.mediaId&&(t+="/media:"+e.mediaId)),!0===e.editionMode&&(t+="/edit")),t||(t=e.path||"home")),t},_extractContextInfoFromRouteNorth:function(e,t){var i;t.editionMode=Boolean(t.path.match(s.EDITION_MODE_REGEXP)),(i=t.path.match(s.COMMUNITY_CONTENT_MEDIA_REGEXP)||t.path.match(s.DM_CONTENT_MEDIA_REGEXP)||t.path.match(s.COMMUNITY_CONTENT_REGEXP)||t.path.match(s.COMMUNITY_WIKI_HOME_REGEXP)||t.path.match(s.COMMUNITY_WIKI_ROOT_REGEXP)||t.path.match(s.DM_CONTENT_REGEXP))?(t.communityId=i[1],t.dmId=t.path.match(s.DM_CONTENT_REGEXP)?i[1]:void 0,t.contentType=s.BACKEND_CONTENT_TYPE_TO_UI_CONTENT_TYPE_TEMP[i[2]]||i[2],t.contentId=i[3],t.mediaId=i.length>4?i[4]:null,(i=t.path.match(s.ANSWER_REGEXP))&&(t.answerUri=decodeURIComponent(i[1])),(i=t.path.match(s.COMMENT_REGEXP))&&(t.commentUri=decodeURIComponent(i[1]),(i=t.path.match(s.REPLY_REGEXP))&&(t.replyUri=decodeURIComponent(i[1])))):(i=t.path.match(s.COMMUNITY_MESSAGE_REGEXP)||t.path.match(s.DM_MESSAGE_REGEXP))?(t.communityId=i[1],t.dmId=t.path.match(s.DM_MESSAGE_REGEXP)?i[1]:void 0,t.messageUuid=i[2]):(i=t.path.match(s.COMMUNITY_CONTENT_REGEXP))?(t.communityId=i[1],t.contentType=s.BACKEND_CONTENT_TYPE_TO_UI_CONTENT_TYPE_TEMP[i[2]]||i[2],t.contentId=i[3]):(i=t.path.match(s.HOME_PAGE_CONTENT_REGEXP))?(t.contentType=s.BACKEND_CONTENT_TYPE_TO_UI_CONTENT_TYPE_TEMP[i[1]]||i[1],t.contentId=i[2]):(i=t.path.match(s.TENANT_ADMIN_COMMUNITY_REGEXP))?(t.communityId=i[1],t.tenantAdminCommunityFacetName=i[2]):(i=t.path.match(s.COMMUNITY_REGEXP))?t.communityId=i[1]:(i=t.path.match(s.DM_REGEXP))?(t.dmId=i[1],t.communityId=i[1]):(i=t.path.match(s.RITUAL_REGEXP))?t.ritualId=i[1]:(i=t.path.match(s.USER_REGEXP))?t.userHashKey=i[1]:(i=t.path.match(s.SEARCH_REGEXP))&&(t.query=decodeURIComponent(i[1]))},_extractContextInfoFromSearchResultSelectedRouteNorth:function(e,t){var o=decodeURIComponent(decodeURI(e)),s=JSON.parse(o.substring(o.indexOf("{"),o.lastIndexOf("}")+1)),r=s.data.items[0].objectId,a=n.extractDataFromSubject6wURI2(r);t=i.extend(t,a),"swym:DirectMessage"===s.data.items[0].objectType&&(t.dmId=t.communityId)},_extractContextInfoFromTransientRouteNorth:function(e,t){var i;(i=e.match(s.IFWE_COMMUNITY_ID_REGEXP))&&(t.communityId=i[1],(i=e.match(s.IFWE_MESSAGE_ID_REGEXP))&&(t.messageUuid=i[1]),(i=e.match(s.IFWE_OTHER_MESSAGE_ID_REGEXP))&&(t.messageUuid=i[1])),(i=e.match(s.IFWE_DM_ID_REGEXP))?(t.dmId=i[1],t.communityId=i[1],(i=e.match(s.IFWE_MESSAGE_ID_REGEXP))&&(t.messageUuid=i[1]),(i=e.match(s.IFWE_OTHER_MESSAGE_ID_REGEXP))&&(t.messageUuid=i[1])):e.match(s.IFWE_COMMUNITY_TYPE_DM_REGEXP)&&(t.dmId=t.communityId,(i=e.match(s.IFWE_OTHER_MESSAGE_ID_REGEXP))&&(t.messageUuid=i[1])),(i=e.match(s.IFWE_CONTENT_TYPE_ID_REGEXP))&&(t.contentType=i[1],t.contentType&&s.BACKEND_CONTENT_TYPE_TO_UI_CONTENT_TYPE_TEMP[t.contentType.toLowerCase()]&&(t.contentType=s.BACKEND_CONTENT_TYPE_TO_UI_CONTENT_TYPE_TEMP[t.contentType.toLowerCase()])),(i=e.match(s.IFWE_CONTENT_ID_REGEXP))&&(t.contentId=decodeURIComponent(i[1]),t.contentType.toLowerCase()===s.SOCIAL_EVENT&&(i=e.match(s.IFWE_CONTENT_URI_REGEXP))&&(t.contentId=decodeURIComponent(i[1]))),(i=e.match(s.IFWE_MESSAGE_ID_REGEXP))&&(t.contentId=decodeURIComponent(i[1])),(i=e.match(s.IFWE_ANSWER_URI_REGEXP))&&(t.answerUri=decodeURIComponent(i[1])),(i=e.match(s.IFWE_COMMENT_URI_REGEXP))&&(t.commentUri=decodeURIComponent(i[1]),(i=e.match(s.IFWE_PARENT_COMMENT_URI_REGEXP))?(t.replyUri=t.commentUri,t.commentUri=decodeURIComponent(i[1])):(i=e.match(s.IFWE_REPLY_URI_REGEXP))&&(t.replyUri=decodeURIComponent(i[1])))},isFilterableContentListsContext:function(){var e=[s.COMMUNITY_BLOG,s.COMMUNITY_MEDIA,s.COMMUNITY_IDEAS,s.COMMUNITY_QUESTIONS,s.COMMUNITY_SURVEYS,s.COMMUNITY_WIKI,s.COMMUNITY_WEDO,s.COMMUNITY_SOCIAL_EVENTS],t=this.getCommunityPageContext();return this.isHomePageContext()||this.isCommunityHomePageContext()||(e.indexOf(t)>=0||t&&t.match(s.COMMUNITY_DERIVED_TYPE_PAGE_REGEXP))&&!this.isContentContext()},isContentEditionContext:function(e){return e?!0===e.editionMode:!0===this.editionMode},is3DStoryOr3DSketchCreationContext:function(e){return e?e.path.includes("sketchcreation")||e.path.includes("storycreation")||e.path.includes("whiteboardcreation"):this.path.includes("sketchcreation")||this.path.includes("storycreation")||this.path.includes("whiteboardcreation")},isRitualsContext:function(){return this.path.includes("rituals")},isRitualContext:function(){return this.path.test(s.RITUAL_PAGE_MATCHER)},isContentContext:function(e){return e||(e=this),e.contentId||e.path&&e.path.match(s.COMMUNITY_WIKI_ROOT_REGEXP)},isCommunityContext:function(){return this.communityId},isDirectMessageContext:function(){return this.dmId},isUserProfileContext:function(){return this.userHashKey},isSearchContext:function(){return this.path.contains(s.SEARCH)&&this.query},setTemporaryState:function(e){this.temporaryState!==e&&(this.temporaryState=!0===e,this.dispatchEvent("onTemporaryStateChange",[e]))},isInTemporaryState:function(){return!0===this.temporaryState},getCommunityPageContext:function(e){var t=(e||this.path).match(s.COMMUNITY_PAGE_MATCHER);return t&&2===t.length&&t[1]!==s.COMMUNITY_MESSAGE?t[1]:this.getDirectMessagePageContext(e)},getCommunityDerivedTypePageContext:function(e){var t=!1,i=(e||this.path).match(s.COMMUNITY_DERIVED_TYPE_PAGE_PATH_REGEXP);return i&&2===i.length&&i[1]!==s.COMMUNITY_MESSAGE&&(t=i[1]),t},getCommunityDerivedTypePipelinePageContext:function(e){var t=!1,i=(e||this.path).match(s.COMMUNITY_DERIVED_TYPE_IDEAS_PIPELINE_PAGE_PATH_REGEXP);return i&&3===i.length&&(t=i[1]),t},getDirectMessagePageContext:function(e){var t=!1,i=(e||this.path).match(s.DM_PAGE_MATCHER);return i&&2===i.length&&(t=i[1]),t},getCommunityContentListContext:function(e){var t=("string"==typeof e?e:this.path).match(s.COMMUNITY_CONTENT_LIST_REGEXP);if(t&&2===t.length)return t[1]},isHomePageContext:function(){return(""===this.path||"home"===this.path)&&!this.query},isCommunityHomePageContext:function(){return this.isCommunityContext()&&!this.getCommunityPageContext()},isCommunityTimelineMessageContext:function(e){var t=!1,i=(e||this.path).match(s.COMMUNITY_PAGE_MATCHER);return i&&2===i.length&&(t=i[1]===s.COMMUNITY_MESSAGE),t},isDMTimelineMessageContext:function(e){var t=!1,i=(e||this.path).match(s.DM_PAGE_MATCHER);return i&&2===i.length&&(t=i[1]===s.COMMUNITY_MESSAGE),t},isCommunityContentListContext:function(){return i.is(this.getCommunityContentListContext())},isAdminContext:function(){return i.is(this.path,"string")&&this.path.startsWith("admin-tenant")},isBookmarkContext:function(){return i.is(this.path,"string")&&this.path.startsWith("mybookmarks")},isSuggestionsContext:function(){return i.is(this.path,"string")&&this.path.startsWith("mysuggestions")},isMyCommunitiesContext:function(){return this.path===s.MY_COMMUNITIES},isDiscoverCommunitiesContext:function(){return this.path===s.DISCOVER_COMMUNITIES},isMyNetworkActivityContext:function(){return this.path===s.MY_NETWORK_ACTIVITY},isCommunityListsContext:function(){return this.isMyCommunitiesContext()||this.isDiscoverCommunitiesContext()}}});__extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/SwymUICore/script/feature/core/context/context-model",["require","exports","UWA/Core","UWA/Class","UWA/String","UWA/Class/Events","DS/SwymUICore/script/feature/core/history/history-model","DS/SwymUICore/script/utils/usage-tracker","DS/SwymUICore/script/feature/core/context/context-constants","DS/SwymUICore/script/feature/core/context/mde/north-context-mixin","DS/SwymUICore/script/feature/core/context/mde/south-context-mixin","DS/SwymUICore/script/feature/core/context/mde/east-context-mixin","DS/SwymUICore/script/feature/core/context/mde/west-context-mixin","DS/SwymUICore/script/feature/core/context/mde/center-context-mixin","DS/SwymUICore/script/utils/routing"],function(e,t,i,n,o,s,r,a,c,u,l,d,m,h,p){"use strict";var g,f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(s),_=Object.keys(new c.M3DEContextAttributesClass),y={},w=new f,C=n.extend({_realTimeEventManager:null,_handledAppsIds:[],_currentAppName:null,previousAttributes:{},_coreviewData:null,_onContextChange:function(e){var t,i,n=this.getRoute(),o=window.ds&&"3DSwym"===ds.env,s=window.ds&&window.ds.isMDE,u=this.getPreviousPath(),l=o&&u&&this.getPathFromUrl()===n;if(n!==(o?s?this.getPathFromUrl():this.getPathFromUrl(u):this.previousAttributes&&this.previousAttributes.path||"")){if(!l){var d="/"+p.SOCIAL+"/",m=window.ds&&window.ds.isMDE,h=m?p.getMDEUrl():p.getSwymUrl();if(n.match("#content:"))t=h+(m?d:"/")+"#"+n;else{var g=this.getPathPrefixFromCurrentPageUrl();t=(m?p.getSocialRedirectUrl(g,h):g)+"#"+n}i={url:n,previousContext:this.previousAttributes},(!e||e&&!e.appLeftPanelTabChange)&&r.pushState(i,c.SWYM_STANDALONE_TITLE,t,this)}var f=this;window.require(["DS/SwymUICore/script/utils/app-navigation-state"],function(e){f.isDirectMessageContext()?e.saveDM(f.isDirectMessageContext()):(f.isCommunityContext()||f.isHomePageContext())&&e.saveCommunity(f.isCommunityContext())}),a.trackPageView(n,window.document.title)}else console.debug("No url change detected!!")},isCommunityContainerContext:function(){return"community"===this.containerType?this.containerId:null},_addListener:function(e,t,n,o,s,r){void 0===n&&(n=null),void 0===o&&(o=!1),void 0===s&&(s=0),void 0===r&&(r=!1);var a=y[e];return!0!==r&&w.addEvent(e,t,n,s),o&&a?(t.apply(n,i.is(a,"array")?a:[a]),t):(!0===r&&w.addEventOnce(e,t,n,s),!0)},getAppTitle:function(e){var t=[];return e.rootPanelTitlePart&&t.push(e.rootPanelTitlePart),o.unescapeHTML(t.join(c.TITLE_PART_SEPARATOR))},getAppName:function(){var e="";return this._currentAppName&&(e=this._currentAppName),e},getCoreviewData:function(){return this._coreviewData},setCoreviewData:function(e){this._coreviewData=e},setAppName:function(e){return this._currentAppName=e,this},_getContextInfoReset:function(e){var t=new c.M3DEContextAttributesClass;return delete t.contextId,t.path=e,t},_setDefaultValues:function(){var e=new c.M3DEContextAttributesClass;delete e.contextId,i.extend(this,e)},initializeAttributes:function(){this._initialState=!0,this.tenantId=null,this.tenantLabel=null,this._handledAppsIds=[],this._currentAppName=null,this.temporaryState=!1,this.contextId=null,this._coreviewData=null,this._setDefaultValues()},init:function(){this._parent.apply(this,arguments),this.initializeAttributes()},set:function(e){this.reset(e,{doNotReset:!0})},addListener:function(e,t,i,n,o){return this._addListener(e,t,i,n,o,!1)},addOnce:function(e,t,i,n,o){return this._addListener(e,t,i,n,o,!0)},_remove:function(e,t,i){w.removeEvent(e,t,i)},removeListener:function(e,t,n){if(i.is(t,"function"))return this._remove.call(this,e,t,n);throw new Error("The listener to be removed is not a function")},dispatchEvent:function(e,t,i){w.dispatchEvent(e,t),i&&(t=t||[],y[e]=t)},removePersisted:function(e){delete y[e]},hasEvent:function(e){return w.hasEvent(e)},handleAppTitle:function(e){console.warn("The handle AppTitle has been called")},getRoute:function(e){var t=e||this;return t.path?t.path:this.computeRoute(t)},_quadrantListing:[c.CENTER_QUADRANT,c.SOUTH_QUADRANT,c.EAST_QUADRANT,c.WEST_QUADRANT],_extractContentId:function(e,t){var i=e.split(c.CONTENT_URL_PART+":");i.length>1&&(t.contentId=i[i.length-1])},extractContextInfoFromRoute:function(e){var t=null;return e&&(t=this._getContextInfoReset(e),this._quadrantListing.forEach(function(i){if(e.startsWith(i))switch(this._extractContentId(e,t),t.quadrant=i,i){case c.CENTER_QUADRANT:this._extractContextInfoFromRouteCenter(e,t);break;case c.SOUTH_QUADRANT:this._extractContextInfoFromRouteSouth(e,t);break;case c.WEST_QUADRANT:this._extractContextInfoFromRouteWest(e,t);break;case c.EAST_QUADRANT:this._extractContextInfoFromRouteEast(e,t)}}.bind(this)),e.match("app:")?(this._extractContextInfoFromTransientRouteNorth(e,t),t.path=""):e.match("#content:")?this._extractContextInfoFromSearchResultSelectedRouteNorth(e,t):t.quadrant||(t.quadrant=c.NORTH_QUADRANT,this._extractContextInfoFromRouteNorth(e,t))),t||{}},reset:function(e,t){var n,o,s={},r={};for(var a in i.is(e,"object")||(e={}),this._throwErrorsOnResetNorth(e),!e.communityId&&e.dmId&&(e.communityId=e.dmId),t&&t.previousAttributes?(o=t.previousAttributes,r.contextChange=!0):o=this.getData(),t&&t.doNotReset||this._setDefaultValues(),e.coreviewData&&(this._coreviewData=e.coreviewData),e.contextId||e.tenantId||(e.path?e=i.extend(this.extractContextInfoFromRoute(e.path),e):(n=i.extend(this.getData(),e),e.path=this.computeRoute(n))),e.x3dsearchOptions&&(this.x3dsearchOptions=i.extend(o.x3dsearchOptions,e.x3dsearchOptions),r.searchChange=!0,delete e.x3dsearchOptions),e)if(e.hasOwnProperty(a)){if(-1===_.indexOf(a))throw new Error("The attribute "+a+" does not exist in the Context object");if(this[a]=e[a],o[a]!==e[a]){switch(a){case"communityId":r.communityChange=!0,e.feedMode&&(r.feedModeChange=!0);break;case"dmId":r.directMessageChange=!0,e.feedMode&&(r.feedModeChange=!0);break;case"feedMode":e[a]&&(r.feedModeChange=!0);break;case"sortMode":e[a]&&(r.sortModeChange=!0);break;case"contentId":r.contentChange=!0;break;case"quadrant":r.quadrantChange=!0;break;case"containerId":case"containerType":r.containerChange=!0;break;case"userHashKey":r.peopleChange=!0;break;case"path":e.userHashKey&&(r.peopleTabChange=!0);break;case"query":r.searchChange=!0;break;case"contextId":e[a]&&(this[a]=this[a]||c.UNKNOWN_CONTEXT_ID,r.contextIdChange=!0);break;case"contentType":r.contentTypeChange=!0;break;case"tenantId":case"tenantLabel":r.tenantChange=!0;break;case"tenantAdminCommunityFacetName":this[a]}r.contextChange=!0,s[a]=e[a]}}if(r.contextChange&&(i.extend(this.previousAttributes,o),this.previousAttributes&&this.previousAttributes.previousAttributes&&delete this.previousAttributes.previousAttributes,this._specialTreatmenForFeedModeInNorthQuadrant(r,s),this._defaultSettingForSortModeInNorthQuadrant(r,s),t&&t.avoidContextChange||(this._onContextChange(t&&t.contextChangeEventData),t&&t.noDispatchContextChange||this.dispatchEvent("onContextChange",i.merge(i.merge({path:this.path},s),t&&t.contextChangeEventData),!0)),(this.path!==o.path||this._initialState)&&(this._initialState=!1,this._sendStats(r))),e.quadrant){var u=document.querySelector(".swym-im");u&&u.setAttribute("quadrant",e.quadrant)}switch(this._dispatchChangeEvents(r),e.quadrant){case c.NORTH_QUADRANT:this._dispatchChangeEventsNorth(r);break;case c.SOUTH_QUADRANT:this._dispatchChangeEventsSouth(r);break;case c.EAST_QUADRANT:this._dispatchChangeEventsEast(r);break;case c.WEST_QUADRANT:this._dispatchChangeEventsWest(r);break;case c.CENTER_QUADRANT:this._dispatchChangeEventsCenter(r)}},_dispatchChangeEvents:function(e){e.contextIdChange&&this.dispatchEvent("onContextIdChange",{contextId:this.contextId},!0),e.quadrantChange&&this.dispatchEvent("onQuadrantChange",{quadrant:this.quadrant},!0),e.containerChange&&this.dispatchEvent("onContainerChange",{containerId:this.containerId,containerType:this.containerType},!0),e.contentChange&&this.containerId&&this.dispatchEvent("onContentIdChange",{contentId:this.contentId},!0)},isContainerContext:function(){return this.containerType},getPathPrefixFromCurrentPageUrl:function(){return document.location.href.split("#")[0]},getPathFromUrl:function(e){var t=document.location.href,i=e||t.split("#")&&t.split("#")[1]||"",n=t.search("#content:");return-1!==n?t.substring(n,t.length):(-1!==i.lastIndexOf("/")&&i.lastIndexOf("/")===i.length-1&&(i=i.substring(0,i.length-1)),i)},getPreviousPath:function(){return this.previousAttributes&&this.previousAttributes.path},getData:function(){var e={};return _.forEach(function(t){e[t]=this[t]},this),e}});return C=C.extend(u),window.ds&&window.ds.isMDE&&(C=C.extend(l,d,m,h)),{getInstance:function(){return g||(g=new C,window.require(["DS/SwymUICore/script/feature/core/context/context-change-actions"],function(){})),g},resetInstance:function(){return g=null,this.getInstance()}}}),define("DS/SwymUICore/script/utils/navigation",["require","exports","UWA/Core","UWA/Json","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/error/error","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/lib/event-manager","DS/Logger/Logger","DS/SwymUICore/script/constants/community-constants","DS/SwymUICore/script/feature/core/context/context-constants","DS/SwymUICore/script/utils/routing","DS/SwymUICore/script/feature/community/derived-type/derived-type-data-utils"],function(e,t,i,n,o,s,r,a,c,u,l,d,m){"use strict";var h;function p(){return window.ds&&"3DSwym"===window.ds.env}function g(){return window.ds&&"3DD"===window.ds.env}function f(e,t,i){window.ds&&"MOBILE"===window.ds.env?window.require(["DS/SwymUICore/script/feature/core/mobile/communication-manager"],function(n){n.sendOpenAppRequest({appKey:e,appTitle:t,appData:i})}):window.require(["DS/TransientWidget/TransientWidget"],function(n){n.showWidget(e,t,i)})}function _(e,t,r,d,g){var y=p(),S=h.getInstance(),F=g&&g.messageUuid,k=g&&g.feedMode,L=g&&g.inRitualContext,W="".concat(!0===d?"dm":L?"ritual":"community",":").concat(e).concat(t?"/".concat(t):F?"/message:".concat(F):""),j=[A,O,v,T],q=i.is(g&&g.tagNavigatorFilteringOptions,"object")?g.tagNavigatorFilteringOptions:void 0;p()||window.widget&&window.widget.getAppName&&window.widget.getAppName()===nt?window.require(["DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","DS/SwymUICore/script/feature/community/ritual/model/ritual-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/core/history/history-model","i18n!DS/SwymUICore/assets/nls/feature/community/community/model/community-model"],function(i,n,o,h,p,g){var f,Y=function(){if(q){var e="onTaggerFilteringRequest",i=!0===d?C:w,n=!0;if(q&&q.mode){switch(q.mode){case"add":e="onAddTagFilteringRequest",i=t?"".concat(i,"/").concat(t):i,n=!1;break;case"remove":e="onRemoveTagFilteringRequest",i=t?"".concat(i,"/").concat(t):i,n=!1}i.includes("/wiki")&&(i=i.replace("/wiki","/communitywiki"))}n&&(y?S.dispatchEvent("onTaggerShowRequest"):window.widget&&window.widget.requestView({type:"maximized"})),a.dispatchEvent(e,[i,q],!0)}},G=function(t,i){if(t.setUserAccess(!1),i&&i.hasOwnProperty("result")&&i.result.hasOwnProperty("title")&&(t.set("title",i.result.title),t.set("description",i.result.description)),h.getInstance().isFeatureActivated("activate_community_join_request")&&(t.getVisibility()===g.Private||i&&i.result)){window.require(["DS/SwymUIComponents/script/feature/community/community/view/community-signup-request-launcher"],function(e){e.show(t)})}else!r&&i&&s.displayError(i.errorcode);if(e===S.communityId){var n=p.getState();window.require(["DS/SwymUICore/script/utils/app-navigation-state"],function(t){t.getLastCommunity()===e&&t.saveCommunity(null)}),W!=="community:".concat(e)||n&&n.hasOwnProperty("previousContext")&&n.previousContext.hasOwnProperty("communityId")&&n.previousContext.communityId!==e?p.back():S.reset({path:"home"})}},V=function(i){if(d||i.hasCurrentUserAccess()){var n=!1;if(t){var o=i.getCommunityFeaturesAccess();if(t&&(t.match(l.COMMUNITY_DERIVED_TYPE_PAGE_REGEXP)||t.match(l.COMMUNITY_IDEAS_PIPELINE_DERIVED_TYPE_PAGE_PREFIX))){var s=i.get("derivedTypes").map(m.createCommunityPageNameForDerivedType);s.includes(t)?n=!0:t.startsWith("ideaspipeline-")&&s.includes(t.slice("ideaspipeline-".length))&&(n=!0)}else switch(t){case A:case O:case v:case T:case I:case P:case x:n=!0;break;case E:case l.COMMUNITY_IDEAS_PIPELINE:n=o.ideation_feature;break;case b:n=o.qna_feature;break;case U:case D:n=o.wiki_feature;break;case N:n=o.survey_feature;break;case M:n=o.stats_feature;break;case R:n=o.settings_feature;break;default:return void c.error("Unknown Community Page")}}else n=!0;if(!0!==n)_(i.get("mid"),void 0,void 0,d);else if(W===S.path)f={communityId:e,dmId:!0===d?e:void 0,messageUuid:F,path:W},k&&(f.feedMode=k),F&&(f.feedMode=u.CTY_CONTENT_LIST_MODE.TIMELINE_MODE),S.reset(f),Y();else{W.match(/community:[A-Za-z0-9-_]+?/)&&(f={communityId:e,dmId:!0===d?e:void 0,messageUuid:F,path:W},k&&(f.feedMode=k),F&&(f.feedMode=u.CTY_CONTENT_LIST_MODE.TIMELINE_MODE),S.reset(f),Y())}}else G(i)},B=new(!0===d?n:L?o:i)({mid:e}),H=B.hasCurrentUserAccess();switch(H){case!1:if(B.hasBeenFetched())G(B);else if(t&&(t.match(l.COMMUNITY_DERIVED_TYPE_PAGE_REGEXP)||t.match(l.COMMUNITY_IDEAS_PIPELINE_DERIVED_TYPE_PAGE_PREFIX))&&!B.derivedTypesListAvailable()){var X=new Promise(function(e,t){B.action("getDerivedTypes",{onComplete:e,onFailure:t})}),K=new Promise(function(e,t){B.fetch({fromCache:!0,onFailure:t,onComplete:e})});Promise.all([X,K]).then(function(){V(B)})}else B.fetch({fromCache:!0,onFailure:G,onComplete:V});break;case!0:case null:default:if(f={communityId:e,dmId:!0===d?e:void 0,ritualId:!0===L?e:void 0,messageUuid:F,path:W},k&&(f.feedMode=k),F&&(f.feedMode=u.CTY_CONTENT_LIST_MODE.TIMELINE_MODE),S.reset(f),!0!==H||t&&j.indexOf(t)<0)if(t&&(t.match(l.COMMUNITY_DERIVED_TYPE_PAGE_REGEXP)||t.match(l.COMMUNITY_IDEAS_PIPELINE_DERIVED_TYPE_PAGE_PREFIX))&&!B.derivedTypesListAvailable()){X=new Promise(function(e,t){B.action("getDerivedTypes",{onComplete:e,onFailure:t})}),K=new Promise(function(e,t){B.fetch({fromCache:!0,onFailure:t,onComplete:e})});Promise.all([X,K]).then(function(){V(B)})}else B.fetch({fromCache:!0,onComplete:V,onFailure:G});else Y()}}):f(nt,"",{community:e,dm:!0===d?e:void 0,route:W,url:o.getBaseUrl(),tagNavigatorFilteringOptions:n.encode(q)})}function y(e,t){var i;switch(e){case"hash_key":i=t.match(Ze);break;case"login":i=t.match(tt)}return i&&i.length>=3?i[2]:null}h=r;var w="community",C="dm",S=l.RITUAL,I=l.COMMUNITY_BLOG,v=l.COMMUNITY_MEDIA,T=l.COMMUNITY_GALLERY,E=l.COMMUNITY_IDEAS,b=l.COMMUNITY_QUESTIONS,U=l.COMMUNITY_WIKI,D=l.COMMUNITY_WIKI_ROOT,A=l.COMMUNITY_MEMBERS,P=l.COMMUNITY_SOCIAL_EVENTS,R=l.COMMUNITY_SETTINGS,M=l.COMMUNITY_STATS,O=l.COMMUNITY_MY_CONTRIBUTIONS,N=l.COMMUNITY_SURVEYS,x=l.COMMUNITY_WEDO,F=l.MY_COMMUNITIES,k=l.DISCOVER_COMMUNITIES,L=l.MY_BOOKMARKS,W=l.RITUALS,j=l.RITUALS_CALENDAR,q=l.RITUALS_CREATION,Y=l.MY_SUGGESTIONS,G=l.MY_NETWORK_ACTIVITY,V=l.SKETCH_CREATION_URL_PART,B=l.WHITEBOARD_CREATION_URL_PART,H=l.STORY_CREATION_URL_PART,X=l.IQUESTION,K=l.POST,Q=l.IDEATION,z=l.MEDIA,J=l.WIKI,$=l.SURVEY,Z=l.MESSAGE,ee=l.WEDO,te=l.SOCIAL_EVENT,ie=l.POST_DERIVED_TYPE_PREFIX,ne=l.IDEA_DERIVED_TYPE_PREFIX,oe="people",se="#?app:".concat(o.getProfileAppKey()),re="#?app:".concat(o.getMyCommunitiesAppKey()),ae="#".concat(w,":"),ce="#".concat(C,":"),ue="#".concat(S,":"),le="#".concat(oe,":"),de="#".concat(X,":"),me="#".concat(K,":"),he="#".concat(Q,":"),pe="#".concat(z,":"),ge="#".concat(J,":"),fe="#".concat($,":"),_e="#".concat(ee,":"),ye="#".concat(te,":"),we="#".concat("cockpit",":"),Ce="#".concat("drive",":"),Se="#".concat("admin-tenant"),Ie="#".concat("search",":"),ve="/".concat(O),Te="/".concat(E),Ee="/".concat(I),be="/".concat(M),Ue="/".concat(R),De="/".concat(v),Ae="/".concat(b),Pe="/".concat(U),Re="/".concat(N),Me="/".concat(P),Oe="/".concat(A),Ne="/".concat("search"),xe="/".concat(X,":"),Fe="/".concat(K,":"),ke=function(e){return"/".concat(e,":")},Le=function(e){return"/".concat(e,":")},We="/".concat(Q,":"),je="/".concat(z,":"),qe="/".concat(J,":"),Ye="/".concat($,":"),Ge="/".concat(Z,":"),Ve="/".concat(ee,":"),Be="/".concat(te,":"),He="/".concat("activities"),Xe="/".concat("connections"),Ke="/".concat("aboutme"),Qe="/".concat("settings"),ze="/".concat("communities"),Je="/".concat("whatsnew"),$e="/".concat("media"),Ze=new RegExp(".*(".concat(se,"/.+hash_key=)(\\w+)?(&)?")),et=new RegExp(".*(".concat(se,"/.+facet=)([0-3]{1})?(&)?")),tt=new RegExp(".*(".concat(se,"/.+login=)([A-Za-z0-9-_.]{2,64})?(&)?")),it={0:He,1:Ke,2:Xe,3:Qe},nt=o.getMyCommunitiesAppKey(),ot=o.getProfileAppKey(),st=o.getContentReaderAppKey(),rt=o.getAnalyticsAppKey(),at=o.getControlCenterAppKey(),ct={TOPFRAME_OVERLAP_CLS:"topframe-overlap",HOME:"home",COMMUNITY:w,COMMUNITY_BLOG:I,COMMUNITY_MEDIA:v,COMMUNITY_IDEAS:E,COMMUNITY_QUESTIONS:b,COMMUNITY_WIKI:U,COMMUNITY_MEMBERS:A,COMMUNITY_SETTINGS:R,COMMUNITY_STATS:M,COMMUNITY_MY_CONTRIBUTIONS:O,COMMUNITY_SURVEYS:N,COMMUNITY_WEDO:x,IQUESTION:X,POST:K,IDEATION:Q,MEDIA:z,WIKI:J,SURVEY:$,MESSAGE:Z,MY_COMMUNITIES:F,DISCOVER_COMMUNITIES:k,MY_BOOKMARKS:L,MY_SUGGESTIONS:Y,MY_NETWORK_ACTIVITY:G,SEARCH:"search",USER_PROFILE:oe,ADMIN_TENANT:"admin-tenant",ADMIN_COMMUNITIES:"communities",ADMIN_WHATSNEW:"whatsnew",PEOPLE_ABOUTME:"activities",PEOPLE_CONNECTIONS:"connections",PEOPLE_ACTIVITIES:"aboutme",PEOPLE_SETTINGS:"settings",PROFILE_FACET_MAPPING:it,URLPART_COMMUNITY:ae,URLPART_DM:ce,URLPART_RITUAL:ue,URLPART_PEOPLE:le,URLPART_CONTENT_IQUESTION:de,URLPART_CONTENT_POST:me,URLPART_CONTENT_IDEATION:he,URLPART_CONTENT_MEDIA:pe,URLPART_CONTENT_WIKI:ge,URLPART_CONTENT_SURVEY:fe,URLPART_CONTENT_WEDO:_e,URLPART_CONTENT_SOCIAL_EVENT:ye,URLPART_PEOPLE_IN_3DD:se,URLPART_CONTENT_IN_3DD:re,URLPART_ADMIN:Se,URLPART_SEARCH:Ie,URLTAB_CONTRIBUTIONS:ve,URLTAB_IDEATION:Te,URLTAB_BLOG:Ee,URLTAB_STATS:be,URLTAB_SETTINGS:Ue,URLTAB_MEDIA:De,URLTAB_IQUESTIONS:Ae,URLTAB_WIKI:Pe,URLTAB_SURVEYS:Re,URLTAB_SOCIAL_EVENTS:Me,URLTAB_MEMBERS:Oe,URLTAB_SEARCHINCOMMUNITY:Ne,URLCONTENT_IQUESTION:xe,URLCONTENT_POST:Fe,URLCONTENT_IDEATION:We,URLCONTENT_MEDIA:je,URLCONTENT_WIKI:qe,URLCONTENT_SURVEY:Ye,URLCONTENT_MESSAGE:Ge,URLPEOPLE_ABOUTME:He,URLPEOPLE_CONNECTIONS:Xe,URLPEOPLE_ACTIVITIES:Ke,URLPEOPLE_SETTINGS:Qe,URLTYPE_SEARCH:"/type:",URLADMIN_COMMUNITIES:ze,URLADMIN_WHATSNEW:Je,URLADMIN_PROCESSING:$e,REGEXP_3DD_URLPART_PEOPLE_HASHKEY:Ze,REGEXP_3DD_URLPART_PEOPLE_FACET:et,REGEXP_3DD_URLPART_PEOPLE_LOGIN:tt,getUrlFromContentType:function(e,t,i){var n="";switch(i.toLowerCase()){case"post":case"communitypost":case"comment":n=this.URLPART_COMMUNITY+e+this.URLCONTENT_POST+t;break;case"media":case"mediacomment":n=this.URLPART_COMMUNITY+e+this.URLCONTENT_MEDIA+t;break;case"qnaquestion":case"qnacomment":case"qnaanswer":n=this.URLPART_COMMUNITY+e+this.URLCONTENT_IQUESTION+t;break;case"dsi_ideation_ideation":case"ideation":case"ideationcomment":n=this.URLPART_COMMUNITY+e+this.URLCONTENT_IDEATION+t;break;case"dsi_dfstree_wikitree":case"wikitree":case"wikiTreecomment":n=this.URLPART_COMMUNITY+e+this.URLCONTENT_WIKI+t;break;case"poll":n=this.URLPART_COMMUNITY+e+this.URLCONTENT_SURVEY+t}return n},extractUserHashkeyFromAppUrl:function(e){return y("hash_key",e)},extractUserLoginFromAppUrl:function(e){return y("login",e)},extractProfileFacetFromUrl:function(e){var t,i;return e.indexOf(ot)>=0?(i=e.match(et))&&i.length>=3&&(t=it[i[2]]):e.indexOf("activities")>0?t="activities":e.indexOf("aboutme")>0?t="aboutme":e.indexOf("connections")>0?t="connections":e.indexOf("settings")>0&&(t="settings"),t},extractProfileFacetNumberFromUrl:function(e){var t,i,n;if(e.indexOf(ot)>=0)(i=e.match(et))&&i.length>=3&&(t=i[2]);else{for(var o in n={},it)it.hasOwnProperty(o)&&(n[it[o]]=o);e.indexOf(He)>0?t=n[He]:e.indexOf(Ke)>0?t=n[Ke]:e.indexOf(Xe)>0?t=n[Xe]:e.indexOf(Qe)>0&&(t=n[Qe])}return t},goToWelcomePage:function(){window.require(["DS/UWPClientCode/Navigation","DS/SwymUICore/script/utils/usage-tracker","DS/SwymUICore/script/utils/utils"],function(e,t,i){e.routeTo(d.WELCOME),setTimeout(function(){t.trackPageView(d.WELCOME,window.document.title)},1),window.location.href.includes("welcome")&&i.setBodyPageDataAttribute("welcome")})},goToQuadrantHome:function(){var e=h.getInstance().getData();window.ds&&window.ds.isMDE&&(e.quadrant===l.EAST_QUADRANT||e.quadrant===l.WEST_QUADRANT||e.quadrant===l.SOUTH_QUADRANT||e.quadrant===l.CENTER_QUADRANT)?this.goToUrl(e.quadrant):this.goToUrl(this.HOME)},goToUrl:function(e){var t,n,s=null,r=e.search("#content:"),a={fromGoToUrl:!0},c=["search","admin-tenant",F,k,"home",W,j,q,L,G,Y,V,B,H],m=h.getInstance(),g=o.getBaseUrl();if(window.ds&&window.ds.isMDE&&e&&d.hasPublicPage()&&d.isPublic(d.getPathNameFromUrl(e)));else{if(d.requireAuthentication(e),-1!==r){n=e.substring(r,e.length);var _=decodeURIComponent(n),y=JSON.parse(_.substring(_.indexOf("{"),_.lastIndexOf("}")+1)),w=y.data.items[0].objectId;t=o.extractDataFromSubject6wURI2(w),"swym:DirectMessage"===y.data.items[0].objectType&&(t.dmId=t.communityId),"swym:WeDo"===y.data.items[0].objectType&&(t.contentId=y.data.items[0].objectId,t.contentType="wedo")}else n=e.indexOf("#")>=0?e.substring(e.indexOf("#")+1):e,e=n,t=m.extractContextInfoFromRoute(n);if(window.ds&&window.ds.isMDE&&(t.quadrant===l.EAST_QUADRANT||t.quadrant===l.WEST_QUADRANT||t.quadrant===l.SOUTH_QUADRANT||t.quadrant===l.CENTER_QUADRANT))m.reset(t);else if(t.contentId&&t.contentType){if(t.contentType===u.CONTENT.message||t.contentType===u.CONTENT.instantmessage)return void this.goToCommunity(t.communityId,void 0,void 0,!!t.dmId,{messageUuid:t.messageUuid||t.contentId});s=!(!t.communityId||!t.dmId)||!(t.communityId&&!t.dmId)&&null,t.answerUri&&i.extend(a,{answerUri:t.answerUri}),t.mediaId&&i.extend(a,{mediaId:t.mediaId}),this.goToContent(t.contentId,t.contentType,t.dmId||t.communityId,t.editionMode,t.commentUri,t.replyUri,s,a)}else if(t.dmId)if(m.isDMTimelineMessageContext(e))this.goToDM(t.dmId,void 0,void 0,{messageUuid:t.messageUuid});else{var C=m.getCommunityPageContext(e);this.goToDM(t.dmId,C||void 0)}else if(t.ritualId)this.goToRitual(t.ritualId);else if(t.communityId&&!t.contentId&&-1===e.indexOf("admin-tenant"))if(m.isCommunityTimelineMessageContext(e))this.goToCommunity(t.communityId,void 0,void 0,!1,{messageUuid:t.messageUuid});else{C=m.getCommunityPageContext(e);this.goToCommunity(t.communityId,C||void 0)}else if(t.userHashKey){var S=ct.extractProfileFacetNumberFromUrl(e);ct.goToProfile({hash_key:t.userHashKey,facet:S})}else if(""===e||c.some(function(t){return e.startsWith(t)}))""===e&&(e="home"),e.startsWith("search")?m.reset({path:e,query:decodeURIComponent(e.split(":")[1]),x3dsearchOptions:m.x3dsearchOptions}):e.startsWith("admin-tenant")?p()||window.widget&&window.widget.getAppName&&window.widget.getAppName()===at?m.reset(t):f(at,"",{url:g}):p()||window.widget&&window.widget.getAppName&&(window.widget.getAppName()===nt||window.widget.getAppName()===st)?m.reset(t):f(nt,"",{route:e,url:g});else if(e.indexOf(nt)>-1)f(nt,"",{route:e,url:g});else if(e.indexOf(ot)>-1){var I=void 0;(I=ct.extractUserLoginFromAppUrl(e))?p()?this.goToProfile({login:I}):f(ot,"",{login:I,url:g}):(I=ct.extractUserHashkeyFromAppUrl(e))&&(p()?this.goToProfile({hash_key:I}):f(ot,"",{hash_key:I,url:g}))}else e.indexOf(at)>-1?p()?this.goToAdminPlatformWhatsNew():f(at,"",{url:g}):e.indexOf(st)>-1?f(st,"",{url:g}):e.indexOf(rt)>-1?f(rt,"",{url:g}):this.goTo3DSwymHomePage()}},goToContainer:function(e){var t=e.containerId,i=e.containerType,n=e.quadrant,o=h.getInstance();e.path=i?"".concat(n,"/").concat(i).concat(t?":".concat(t):""):n,o.reset(e)},goToContentInContainer:function(e){var t=e.containerId,i=e.containerType,n=e.contentId,o=e.quadrant,s=h.getInstance();e.path=l.NORTH_QUADRANT,t&&i&&n&&o&&(e.path="".concat(o,"/").concat(i,":").concat(t,"/content:").concat(n)),s.reset(e)},goTo3DSwymHomePage:function(e){var t=p(),s=h.getInstance(),r=i.is(e&&e.tagNavigatorFilteringOptions,"object")?e.tagNavigatorFilteringOptions:void 0;if(t||window.widget&&window.widget.getAppName&&window.widget.getAppName()===nt){if(this.goToUrl("home"),r){t?s.dispatchEvent("onTaggerShowRequest"):window.widget&&window.widget.requestView({type:"maximized"});var c="onTaggerFilteringRequest";if(r&&r.mode)switch(r.mode){case"add":c="onAddTagFilteringRequest";break;case"remove":c="onRemoveTagFilteringRequest"}a.dispatchEvent(c,["home",r],!0)}}else f(nt,"",{route:"home",url:o.getBaseUrl(),tagNavigatorFilteringOptions:n.encode(r)})},goToAdminPlatformCommunities:function(){this.goToUrl(this.URLPART_ADMIN+this.URLADMIN_COMMUNITIES)},goToAdminPlatformWhatsNew:function(){this.goToUrl(this.URLPART_ADMIN+this.URLADMIN_WHATSNEW)},goToSketchCreation:function(e){this.goToUrl(V+(e?":".concat(e):""))},goToWhiteboardCreation:function(e){this.goToUrl(B+(e?":".concat(e):""))},goToStoryCreation:function(e){this.goToUrl(H+(e?":".concat(e):""))},in3DSwym:p,in3DD:g,inMobile:function(){return window.ds&&"MOBILE"===window.ds.env},getContentURLForSwym:function(e,t,i,n,o){var s,r="";if(i){switch(t){case"post":s=Fe;break;case"iquestion":s=xe;break;case"idea":s=We;break;case"media":s=je;break;case"survey":s=Ye;break;case"wiki":s=qe;break;case"instantmessage":s=Ge;break;case"wedo":s=Ve;break;case"social-event":s=Be;break;default:if(t.startsWith(ie))s=ke(t);else{if(!t.startsWith(ne))throw new Error("Content Type has not been specified");s=Le(t)}}r=o===C?ce+i+s+e:o===S?ue+i+s+e:ae+i+s+e}else{switch(t){case"post":s=me;break;case"iquestion":s=de;break;case"idea":s=he;break;case"media":s=pe;break;case"survey":s=fe;break;case"wiki":s=ge;break;case"wedo":s=_e;break;case"cockpit":s=we;break;case"drive":s=Ce;break;case"social-event":s=ye;break;default:throw new Error("Content Type has not been specified")}r=s+e}return r+(n?"/edit":"")},goToCommunity:_,goToCockpit:function(e){var t=h.getInstance(),i="east/cockpit:".concat(e);t.reset({path:i,contentType:"cockpit",quadrant:"east",containerId:e})},goToDM:function(e,t,i,n){return _(e,t,i,!0,n)},goToRitual:function(e){return _(e,null,null,!1,{inRitualContext:!0})},goToContent:function(e,t,i,n,r,a,c,u){var l,d=h.getInstance(),g="",y=u&&u.answerUri,w=u&&u.mediaId,C=u&&u.dataAnnotation,S=u&&u.editProperties,I=u&&u.fromGoToUrl,v=p()||window.widget&&window.widget.getAppName&&(window.widget.getAppName()===nt||window.widget.getAppName()===st);c&&(l=i),t||e?v||!i?(i&&(g=d.getRoute({contentId:e,contentType:t,communityId:i,dmId:l,editionMode:n||!1,commentUri:r,replyUri:a,answerUri:y,mediaId:w})),window.require(["DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/core/history/history-model"],function(u,l){window.require([u.getModuleNameFromModelName(t)],function(u){var h;if(h=function(e,t){var i;if(t&&("SocialSecurityException"!==t.errorcode&&"ContainerNotFoundException"!==t.errorcode&&"ERROR_NO_RIGHTS_TO_EDIT_THIS_CONTENT"!==t.errorcode&&"ERROR_TRY_TO_EDIT_ENDED_SURVEY"!==t.errorcode||s.displayError(t.errorcode)),d.path===g){if(t&&(i=e.getCommunity()))return void _(i.get("mid"),null,!0,c);l.back()}else d.path||d.reset({path:"home"})},g&&null!==c){var p="media"===t||w||m.isDerivedTypeName(t);d.reset({path:g},{noDispatchContextChange:p})}new u({mid:e,community_id:i},{autoPopulate:!0,onPopulate:function(e){var i=e.get("mid"),s=e.getCommunity(),u=s.get("mid")||s.id;if(null===c||d.path===g){if(s.get("users")&&"dm"===s.get("community_type")&&(c=!0),"0"===e.get("published")&&(n=!0),n&&!e.canUpdate()){n=!1;var l="survey"===e.getModelName()&&e.hasEnded()&&e;h(e,{errorcode:l?"ERROR_TRY_TO_EDIT_ENDED_SURVEY":"ERROR_NO_RIGHTS_TO_EDIT_THIS_CONTENT"})}if(v){if(d.reset({path:g,contentId:i,contentType:t,communityId:u,dmId:!0===c?u:void 0,editionMode:n||!1,commentUri:r||null,replyUri:a||null,answerUri:y,mediaId:w,dataAnnotation:C,editProperties:S}),I&&"wiki"===e.getModelName()&&n){var m=e.getSubjectURI();window.require(["DS/SwymUICore/script/feature/core/edit-info/edit-info-manager"],function(e){return e.directlyAccessedWikis.add(m)})}}else f(nt,"",{contentId:i,contentType:t,community:u,dm:!0===c?u:void 0,editionMode:n||!1,commentURI:r,replyURI:a,url:o.getBaseUrl(),answerURI:y})}},onFailure:h})})})):f(nt,"",{contentId:e,contentType:t,community:i,dm:!0===c?i:void 0,editionMode:n||!1,url:o.getBaseUrl()}):this.goTo3DSwymHomePage()},goToProfile:function(e){var t,i=e.hash_key||e.hashKey||e.userHashKey,n=e.login,s=i||n;if(s){if(p())h.getInstance().reset({path:"".concat(oe,":").concat(s).concat(e.facet?it[e.facet]:He),userHashKey:i||n});else if(g()){t=o.getBaseUrl();var r=window.widget&&window.widget.getAppName&&window.widget.getAppName()===ot;if(!r||r&&i!==window.widget.getValue("hash_key")){var a=e.login?{login:n,url:t,facet:e.facet}:{hash_key:i,url:t,facet:e.facet};f(ot,"",a)}}}else c.log("Please use a hash key or login in order to have a working link")},showTransientWidget:f};return ct});__extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/SwymUICore/script/feature/core/config/bootstrap-model",["require","exports","UWA/Core","UWA/Class/Events","DS/SwymUICore/script/lib/request/data","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/utils/platform-utils","DS/Logger/Logger","UWA/Element","UWA/Class/Promise","DS/SwymUICore/script/utils/navigation"],function(e,t,i,n,o,s,r,a,c,u,l){"use strict";return function(e){function t(){var t=e.call(this)||this;return t.loaded=!1,t.envList=null,t.attributes=null,t.bootstrapConditions=null,t.attributes={csrfTokens:{}},t.bootstrapConditions={},t}return __extends(t,e),t.prototype.initialize=function(e,t){a.log("init");var n=(t?t.baseUrl:null)||s.getBaseUrl(),c=n+(n.endsWith("/")?"":"/")+"api/index/options"+(e?"?ticket="+e:""),u=this.attributes,l=null,d={bypassConfigLoadCheck:!0,method:"GET",type:"json",onComplete:function(e,t,n,o){e&&e.errorcode||(e&&e.result&&e.result.options&&(u=i.extend(u,e.result.options)).config&&u.config.tenant&&u.config.tenant.id&&s.initCurrentTenantId(u.config.tenant.id),e&&e.result&&e.result.LicenseNearlyConsumed&&window.require(["DS/UWPClientControls/PlatformNotify","i18n!DS/SwymUICore/assets/nls/feature/core/config/bootstrap-model"],function(e,t){e.warn(t.YourLicenseIsNearlyConsumed)}),(l=r.getCsrfToken(o,t))?(u.csrfToken=l,u.config&&u.config.tenant&&u.config.tenant.online_instance_id&&(u.csrfTokens[u.config.tenant.online_instance_id]=l)):a.error("Missing mandatory csrf token!"),this.loaded=!0,this.dispatchEvent("onSync",[this]))}.bind(this),onFailure:function(){window.ds&&"3DSwym"===window.ds.env||this.dispatchEvent("onFailure")}.bind(this),url:c};return window.ds&&"3DSwym"===window.ds.env&&this.loaded||o.request(d),this},t.prototype.get=function(e){return i.clone(this.attributes[e],!1)||null},t.prototype.getAttributes=function(){return this.attributes},t.prototype.setAttributes=function(e){this.attributes=e},t.prototype.resetLoaded=function(){this.loaded=!1},t.prototype.updateTenantAttributes=function(e){for(var t in e)e.hasOwnProperty(t)&&this.attributes.config&&this.attributes.config.tenant&&this.attributes.config.tenant.hasOwnProperty(t)&&(this.attributes.config.tenant[t]=e[t])},t.prototype.setTenantAttributes=function(e){for(var t in e)e.hasOwnProperty(t)&&this.attributes.config&&this.attributes.config.tenant&&!this.attributes.config.tenant.hasOwnProperty(t)&&(this.attributes.config.tenant[t]=e[t])},t.prototype.getCSRFToken=function(e){return e?this.attributes.csrfTokens[e]:this.attributes.csrfToken},t.prototype.setCSRFToken=function(e,t){t&&(this.attributes.csrfTokens[t]=e),this.attributes.csrfToken=e},t.prototype.executeWhenReady=function(e){!0===this.loaded?e.apply(this):this.addEventOnce("onSync",e)},t.prototype.fullfillBootstrapCondition=function(e){!0!==this.bootstrapConditions[e]&&(this.bootstrapConditions[e]=!0,this.dispatchEvent("_onConditionMet:"+e))},t.prototype.isBootstrapConditionMet=function(e){return!0===this.bootstrapConditions[e]},t.prototype.executeWhenBootstrapConditionIsMet=function(e,t){this.isBootstrapConditionMet(e)?t.apply(this):this.addEventOnce("_onConditionMet:"+e,t)},t.prototype.isFeatureActivated=function(e){return!this.attributes||"2"!==this.attributes["X-DS-SWYM-VERSION"]||!i.is(this.attributes[e])||this.attributes[e]},t.prototype.isRealtimeFeatureActivated=function(e){return this.get("config").realtime[e]&&!0===this.get("config").realtime[e].activate},t.prototype.getBackendVersion=function(){if(this.attributes&&this.attributes["X-DS-SWYM-VERSION"])return parseInt(this.attributes["X-DS-SWYM-VERSION"]);throw"No backend version returned by the service"},t.prototype.getStartupTenantsInfo=function(e,t,i){var n=this,o=n.envList;o?(i&&"function"==typeof i.callbackJustAfterCallHasBeenSent&&i.callbackJustAfterCallHasBeenSent(),e&&e.call(this,o)):this.executeWhenReady(function(){window.require(["DS/WAFData/WAFData"],function(s){r.getMyAppsURLPromise().then(function(r){var a=r+"/resources/AppsMngt/user/startup?platform="+n.get("config").tenant.online_instance_id;s.authenticatedRequest(a,{method:"GET",type:"json",headers:{"Accept-Language":window.dsLang,Accept:"application/json","Content-Type":"application/json"},onComplete:function(t){var i=this;t&&!0!==t.logout&&(o=n.envList=t,e&&n.executeWhenReady(function(){e.call(i,o)}))},onFailure:function(){t&&t.apply(this,arguments)}}),i&&"function"==typeof i.callbackJustAfterCallHasBeenSent&&i.callbackJustAfterCallHasBeenSent()})})})},t.prototype.loginToFedSearch=function(e,t,i){var n=e&&e.swym&&e.swym[0]&&e.swym[0].id,o=e&&e.search&&e.search[0]&&e.search[0].url;window.require(["DS/WAFData/WAFData","DS/SwymUICore/script/utils/utils"],function(e,s){e.authenticatedRequest(o+"/login",{data:{tenant:n,mde:!0},method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(e){s.initFedSearchUrl(o),t()},onFailure:function(e){i()}})})},t.prototype.initCatalog=function(){return new u(function(e,t){window.require(["DS/TopFrame/TopFrame","DS/UWPClientCode/Bootstrap","DS/UWPClientCode/WidgetFactory","DS/UWPClientCode/WidgetCatalog"],function(t,n,o,s){var r=c.extend(document.body).getElement(".site-container");if(void 0===r){l.goToUrl(document.location.href),r=null,s.init(document.body);var a=n.getStartPageMode(),u={id:null,data:null,title:null,parent:null,widgetId:null,el:null};switch(a[0]){case"instance":u.id=a[1];break;case"widget":u.data=a[1].data,u.title=a[1].name,u.parent=!0,u.widgetId=a[1].id;break;default:u.id=a[1]}u.el=c.create("div",{class:"module site-module"}),i.is(o.showWidget,"function")?o.showWidget(u):o.load(u),r=i.createElement("div",{class:"site-container",html:u.el}),t&&t.appContainer?r.inject(t.appContainer):r.inject(document.body),e("")}})})},t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t}(n)}),define("DS/SwymUICore/script/lib/model/model-manager",["require","exports","UWA/Core","UWA/Class","UWA/Class/Events","UWA/Class/Listener","DS/SwymUICore/script/feature/core/context/context-model","DS/Logger/Logger"],function(e,t,i,n,o,s,r,a){"use strict";var c=!1,u={onDestroy:!0,onPrePublishing:!0,onPublishing:!0,onDraftCreation:!0,onCreate:!0,onCommentCreation:!0,onCreationFailed:!0},l=new(s.extend(o,{})),d={},m={};function h(e){var t=e.getCacheId(),i=e.getCacheKey(),n=!1;return i&&e&&t&&(Array.isArray(t)||(t=[t]),t.forEach(function(e){e&&d[i]&&d[i][e]&&(n=d[i][e])})),n}function p(e){var t,n,o,s,r,a,c,u,l,m,p,g,f,_,y,w,C,S={};if(!i.is(e,"object"))throw new Error("Invalid arguments");if(i.is(e.instance,"object")?(m=e.instance,u=e.isComplete,w=e.areModelDataFromServer,g=e.cachePrioritaryFields):m=e,!m||m.isNew())return!1;if(C=m.cid,r=m.getCacheId(),a=m.getCacheKey(),u=!0===u,w=!0===w,g=g||[],c=h(m)){if((p=c.instance)!==m){for(t in i.merge(p,m),p)"_attributes"!==t&&"_dispatchers"!==t&&"collection"!==t&&p.hasOwnProperty(t)&&"object"==typeof p[t]&&"object"==typeof m[t]&&i.merge(p[t]||{},m[t]||{});if((o=m._dispatchers)!==(s=p._dispatchers))for(n in o)if(o.hasOwnProperty(n)&&o[n].bindings.length>0)if(s.hasOwnProperty(n))for(f=0,_=o[n].bindings.length;f<_;f++)!0===(y=o[n].bindings[f]).isOnce?p.addEventOnce(n,y.listener,y.context,y.priority):p.addEvent(n,y.listener,y.context,y.priority);else s[n]=o[n];if(!0===w||!0!==c.areModelDataFromServer){if(g.length>0)for(t in S=p.getAttributes(g,{escapeHTML:!1}))S.hasOwnProperty(t)&&void 0===S[t]&&delete S[t];p.set(i.extend(m.toJSON(),S))}else p.set(i.extend(m.toJSON(),p.toJSON()));if(l=m.collection||p.collection,i.extend(m,p),m.cid=C,m.collection=l,!1===u&&!0===c.isComplete||!1===w&&!0===c.areModelDataFromServer)return!0}u&&!0!==c.isComplete&&(c.isComplete=u,c.areModelDataFromServer=w)}else a&&r&&(Array.isArray(r)||(r=[r]),c=d[a]=d[a]||{},r.forEach(function(e){c[e]={instance:m},!0!==c[e].isComplete&&(c[e].isComplete=u,c[e].areModelDataFromServer=w)}));return!0}function g(e,t,i){i&&"object"==typeof i&&function(e){var t=w(e);if(!1!==t)return delete m[e.url][t],m[e.url].length--,!0}({url:i.url,data:i.data})}function f(e,t,i){return e.removeEvent("onError:read",_),g(0,0,i)}function _(e,t,i){return e.removeEvent("onSync:read",f),g(0,0,i)}function y(e,t,i){if(i)switch(i.serviceName){case"read":case"update":case"patch":p({instance:e,isComplete:"read"===i.serviceName,areModelDataFromServer:!0});break;case"delete":l.stopListening(e),h(e)&&function(e){try{var t=!1,i=e.getCacheId(),n=e.getCacheKey();e&&n&&i&&(Array.isArray(i)||(i=[i]),i.forEach(function(e){e&&d[n]&&d[n][e]&&(delete d[n][e],t=!0)}))}catch(e){a.error("Error uncaching instance:"+e.message)}}(e)}}function w(e){var t,n,o,s,r;if(e&&e.url&&e.data)for(o=e.url,s=e.data,m[o]=m[o]||[],t=0,n=(r=m[o]).length;t<n;t++)if(i.equals(r[t],s))return t;return!1}return n.singleton({init:function(){if(!0===c)throw new Error("Singleton has already been created");return c=!0,r.getInstance().addListener("onTenantChange",function(){l.stopListening(),d={}}),this},followUpForCacheUpdates:function(e){l.listenTo(e,"onSync",y)},ignoreForCacheUpdates:function(e){e&&l.stopListening(e,"onSync",y)},isPendingCall:function(e,t){return!0!==t?Boolean(w(e)):!function(e){if(!e.instance)throw new Error("Provided instance is invalid!");return!1===w(e)&&(m[e.url]=m[e.url]||[],m[e.url].push(e.data),e.instance.addEventOnce("onSync:read",f),e.instance.addEventOnce("onError:read",_),!0)}(e)},populate:function(e,t){if(e){var n=null;if((t=t||{}).autoPopulate=!0===t.autoPopulate,t.areModelDataFromServer=!0===t.areModelDataFromServer,!e.getModelName())throw new Error("Instance model name is missing");return e.isNew()?t.provokeCacheUpdates=!1:(n=h(e),t.provokeCacheUpdates=!1!==t.provokeCacheUpdates),n?(!0!==t.provokeCacheUpdates?!0===t.areModelDataFromServer?e.set(i.merge(e.toJSON(),n.instance.toJSON())):e.set(n.instance.toJSON()):p({instance:e,areModelDataFromServer:t.areModelDataFromServer,cachePrioritaryFields:t.cachePrioritaryFields}),!0!==n.isComplete&&!0===t.autoPopulate?("function"==typeof t.onPopulate&&(t.onComplete=t.onPopulate),e.fetch(t)):"function"==typeof t.onPopulate&&t.onPopulate.call(e,e,{},t)):(!0===t.provokeCacheUpdates&&p({instance:e,isComplete:!1,areModelDataFromServer:t.areModelDataFromServer}),!0===t.autoPopulate?("function"==typeof t.onPopulate&&(t.onComplete=t.onPopulate.bind(e)),e.fetch(t)):e.dispatchEvent("onLoaded",[e])),e}throw new Error("Instance id and model name are required")},isModelInCache:function(e){return!!h(e)},getInstance:function(){return this},addListener:function(e,t,i,n,o){if(u.hasOwnProperty(e))return!0===n?l.addEventOnce(e,t,i,o):l.addEvent(e,t,i,o)},removeListener:function(e,t){return l.removeEvent(e,t)},notify:function(e,t,i){if(u.hasOwnProperty(e))return l.dispatchEvent(e,t,i)},addListenerOnDestroy:function(e,t,i,n){return this.addListener("onDestroy",e,t,i,n)},addListenerOnCreation:function(e,t,i,n){return this.addListener("onCreate",e,t,i,n)},addListenerOnPublishing:function(e,t,i,n){return this.addListener("onPublishing",e,t,i,n)},addListenerOnPrePublishing:function(e,t,i,n){return this.addListener("onPrePublishing",e,t,i,n)},addListenerOnCreationFailed:function(e,t,i,n){return this.addListener("onCreationFailed",e,t,i,n)},addListenerOnCommentCreation:function(e,t,i,n){return this.addListener("onCommentCreation",e,t,i,n)},addListenerOnDraftCreation:function(e,t,i,n){return this.addListener("onDraftCreation",e,t,i,n)},removeListenerOnCommentCreation:function(e){return this.removeListener("onCommentCreation",e)},removeListenerOnPrePublishing:function(e){return this.removeListener("onPrePublishing",e)},removeListenerOnDestroy:function(e){return this.removeListener("onDestroy",e)},removeListenerOnCreation:function(e){return this.removeListener("onCreate",e)},removeListenerOnPublishing:function(e){return this.removeListener("onPublishing",e)},removeListenerOnCreationFailed:function(e){return this.removeListener("onCreationFailed",e)},removeListenerOnDraftCreation:function(e){return this.removeListener("onDraftCreation",e)},getAttributesFromCache:function(e,t){var i=d[e]||{};return(i=i[t])&&(i=i.instance.toJSON()),i},cleanCache:function(){d={},m={}}}).init()}),define("DS/SwymUICore/script/lib/model/generic/swym-model",["UWA/Core","UWA/Json","UWA/Utils","DS/SwymUICore/script/lib/request/data","DS/SwymUICore/script/lib/model/model-manager","UWA/Class/Model","UWA/Class/Collection","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/date","DS/WebappsUtils/Console","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/context/context-constants"],function(e,t,i,n,o,s,r,a,c,u,l,d){"use strict";u.log("DS/SwymUICore/script/lib/model/generic/swym-model");var m={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"},h=function(){Object.hasOwnProperty.call(this,"_associations")||(e.is(this._associations,"object")?(this._associations=e.extend({},this._associations||{}),Object.keys(this._associations||{}).forEach(function(t){if(this._associations[t]=e.extend({},this._associations[t]||{}),e.owns(this._associations,t)){var i=this._associations[t];i&&"function"!=typeof i.onSourceAttributeChange&&(i.onSourceAttributeChange=function(i,n,o){return function(t,i,n,o){var a=this._associations[t],c=a.Class||this.constructor.prototype._associations[t].Class;if(c&&a.associated){var u,l=a.options||{};if(e.is(n,"object")&&c.prototype instanceof s||e.is(n,"array")&&c.prototype instanceof r)!1!==o.areModelDataFromServer&&(l.areModelDataFromServer=!0),c.prototype instanceof s?(u=new c(n,l),a.associated.equals(u)||i.setAssociated(t,u)):a.associated.set(n,l);else{if(!(null===n&&c.prototype instanceof s))throw new Error("The attribute is supposed to be an object or an array");u=new c({},l),a.associated.equals(u)||i.setAssociated(t,u)}}}.call(this,t,i,n,o)},this.addEvent("onChange:"+(i.sourceAttribute||t),i.onSourceAttributeChange,this))}},this)):this._associations={})},p=function(e,t,i){var n,o,s;switch(e){case"onRequest":(o=t[2])&&o.serviceName&&this._parent.call(this,e+":"+o.serviceName,t,i);break;case"onSync":if(s=t[0],n=t[1],o=t[2],void 0===n||n&&void 0!==n.errorcode)return this.dispatchEvent("onError",t,i);o&&o.serviceName&&s instanceof this.constructor&&this._parent.call(this,"onSync:"+o.serviceName,t,i);break;case"onError":s=t[0],(o=t[2])&&o.serviceName&&s instanceof this.constructor&&this._parent.call(this,"onError:"+o.serviceName,t,i)}return this._parent.apply(this,arguments)},g=null;return(g=s.extend({_modelName:null,_tableName:null,_customProperties:null,_services:null,_changes:null,_previousChanges:null,_modelIdAttribute:"mid",_attributesMapping:{id:"mid"},_associations:null,_provokeCacheUpdates:!0,_cacheKey:"",HTML_ATTRIBUTES:null,defaults:{},lastCallsParams:null,lastCalledService:null,_updateIdAttribute:function(e){if(e[this._modelIdAttribute]){var t=String(e[this._modelIdAttribute]),i=t.split(this._modelName+":");t=i[i.length-1],e[this.idAttribute]=[this._modelName,":",t].join(""),e[this._modelIdAttribute]=t}return e},_callService:function(t,i,n){var s=void 0,r=void 0,a=this._services?e.extend({},"patch"===t?this._services.update:this._services[t]):{};return n&&(n=e.merge(n,a)),!0===n.parse&&"function"==typeof a.parse&&(n.parse=a.parse),n.postProcess||"function"!=typeof a.postProcess||(n.postProcess=a.postProcess),n.serviceName=t,this.adaptService(n),this.lastCalledService=t,this.lastCallsParams[t]=n.data,"read"!==t?g.parentSync.call(this,t,i,n):!0===o.isPendingCall({url:n.url,data:n.data,instance:this},!0)&&o.isModelInCache(this)?("function"==typeof n.originalOnComplete&&(s=function(e,t){var i=n.originalOnComplete;return r&&this.removeEvent("onError:read",r),this.removeEvent("onSync:read",s),delete n.originalOnComplete,delete n.originalOnFailure,i(e,t,n)},this.addEventOnce("onSync:read",s,this,10)),"function"==typeof n.originalOnFailure&&(r=function(e,t){var i=n.originalOnFailure;return s&&this.removeEvent("onSync:read",s),this.removeEvent("onError:read",r),delete n.originalOnComplete,delete n.originalOnFailure,i(e,t,n)},this.addEventOnce("onError:read",r,this,10)),!1):g.parentSync.call(this,t,i,n)},_breakLineAttributeIfNeeded:function(e,t,i){if("string"==typeof t)switch(i&&i.breakline){case!0:t=t.replace(/(?:\n)/g,"<br>")}return t},_escapeAttributeIfNeeded:function(e,t,i){if("string"==typeof t)switch(i&&i.escapeHTML){case!0:t=t.escapeHTML();break;case!1:break;default:this.HTML_ATTRIBUTES&&-1!==this.HTML_ATTRIBUTES.indexOf(e)||(t=t.escapeHTML())}return t},_treatAttributeIfNeeded:function(e,t,i){return t=this._escapeAttributeIfNeeded(e,t,i),i&&i.breakline&&(t=this._breakLineAttributeIfNeeded(e,t,i)),t},_doPreSaveOperations:function(t,i,n){var o={};return!t||e.is(t,"object")?(o=t||{},n=i||{}):(o[t]=i,n=n||{}),o.update=c.getCurrentDate(),this.addChanges(o,n),n.data={},n.data=e.extend({},this._changes),this.has(this._modelIdAttribute)&&(n.data.mid=this.get(this._modelIdAttribute)),n},_doPostSaveOperations:function(){var e=void 0;for(e in this._previousChanges)Object.hasOwnProperty.call(this._previousChanges,e)&&delete this._previousChanges[e];for(e in this._changes)Object.hasOwnProperty.call(this._changes,e)&&(this._previousChanges[e]=this._changes[e])},_defineOwnAssociations:h,init:function(t,i){try{var n,s,r=t,a=l.getBaseUrl(),c=e.merge({},i),u=this._attributesMapping;return this.urlRoot=c.urlRoot||a,r=r?this.applyAttributesMapping(r):{},this.defaults=n=this.applyAttributesMapping(this.defaults),(s=Object.keys(this.defaults)).forEach(function(e){Object.hasOwnProperty.call(u,e)&&delete n[e]}),this._dispatchers={},this._attributes={},Object.hasOwnProperty.call(r,this._modelIdAttribute)&&(this._attributes[this._modelIdAttribute]=r[this._modelIdAttribute],this._attributes.id=r.id),Object.hasOwnProperty.call(c,"cacheKey")&&(this._cacheKey=i.cacheKey),!1===c.provokeCacheUpdates&&(this._provokeCacheUpdates=!1),this._changes={},this.lastCallsParams={},this._previousChanges={},this._customProperties={},this._parent(r,c),o.isModelInCache(this)&&!1!==this._provokeCacheUpdates||(this._defineOwnAssociations(),this.addEvents({onSync:function(){this._customProperties.beingFetched=!1},onError:function(){this._customProperties.beingFetched=!1}},this,1e4)),this.getCacheId()&&this.getCacheKey()&&!1!==this._provokeCacheUpdates&&(c.cachePrioritaryFields=(d=[],s.forEach(function(e){Object.hasOwnProperty.call(r,e)||d.push(e)}),d),o.followUpForCacheUpdates(this),o.populate(this,c)),!0!==this._customProperties.fetched&&this.addEventOnce("onSync:read",function(){this._customProperties.fetched=!0},this,1e4),this}catch(e){console.error(e)}var d},isNew:function(){return!!this._parent.apply(this,arguments)||"0"===this.get("mid")},shouldProvokeCacheUpdates:function(){return this._provokeCacheUpdates},hasBeenFetched:function(){return!0===this._customProperties.fetched},isBeingFetched:function(){return!0===this._customProperties.beingFetched},extractValue:function(){return g.extractValue.apply(this,arguments)},applyMapping:function(){return g.applyMapping.apply(this,arguments)},applyAttributesMapping:function(){return g.applyAttributesMapping.apply(this,arguments)},applyServiceParamsMapping:function(){return g.applyServiceParamsMapping.apply(this,arguments)},adaptService:function(){return g.adaptService.apply(this,arguments)},getAttributes:function(e,t){var i,n={};if(e&&e.length>0&&Array.isArray(e))e.forEach(function(e){n[e]=this.get(e,t)},this);else for(var o in i=this._attributes)Object.hasOwnProperty.call(i,o)&&(n[o]=this.get(o,t));return n},getCustomProperty:function(e){return this._customProperties[e]},setCustomProperty:function(e,t){this._customProperties[e]=t},deleteCustomProperty:function(e){delete this._customProperties[e]},getModelName:function(){return this._modelName},getModelIdAttribute:function(){return this._modelIdAttribute},getTableName:function(){return this._tableName},addChanges:function(t,i,n){var o,s=null,r={},a=!1,c=[],u=e.extend({},this._changes);switch(e.typeOf(t)){case"string":(r={})[t]=i;break;case"object":r=t;case!1:n=i}if(n||(n={}),!this._validate(r,n))return!1;if(o=e.extend({},r),!Object.hasOwnProperty.call(n,"force")||!0!==n.force){for(s in o)Object.hasOwnProperty.call(o,s)&&o[s]===this.get(s)&&(delete o[s],void 0!==this._changes[s]&&c.push(s));this.removeChanges(c)}if(this._changes=e.extend(this._changes,o),!n||n&&!0!==n.silent){for(s in r)Object.hasOwnProperty.call(r,s)&&u[s]!==r[s]&&(a=!0,this.dispatchEvent("onVirtualChange:"+s,[this,Object.hasOwnProperty.call(this._changes,s)?r[s]:this.get(s),n]));!0===a&&this.dispatchEvent("onVirtualChange",[this,n])}return!0},removeChanges:function(t){var i,n=void 0,o=null,s=!1;switch(e.typeOf(t)){case"string":(o=[]).push(t);break;case"array":o=t}if(o)for(n=0,i=o.length;n<i;n++)s=!0,delete this._changes[o[n]];else for(n in this._changes)Object.hasOwnProperty.call(this._changes,n)&&(s=!0,delete this._changes[n]);return!0===s&&this.dispatchEvent("onVirtualChange",[this]),!0},getChanges:function(t){var i=null;return t?"string"==typeof t?i=e.clone(this._changes[t],!1):Array.isArray(t)&&(i={},t.forEach(function(t){"string"==typeof t&&void 0!==this._changes[t]&&(i[t]=e.clone(this._changes[t],!1))},this)):i=e.extend({},this._changes),i},hasVirtuallyChanged:function(e){if(e)return Boolean(this._changes[e]);for(var t in this._changes)if(Object.hasOwnProperty.call(this._changes,t))return!0;return!1},get:function(e,t){var i,n,o,s=void 0;if("string"==typeof e&&(i=e.split("->"),s=this._parent(i[0]),(o=i.length)>1))for(n=1;n<o&&s&&"object"==typeof s;)s=s[i[n]],++n;return this._treatAttributeIfNeeded(e,s,t)},validate:function(t){var i,n=null;if("function"==typeof this.validateField&&e.is(t,"object"))for(n in t)if(Object.hasOwnProperty.call(t,n)&&(i=this.validateField(n,t[n])))return n+":"+i;return!1},set:function(e,t,i){var n;return e?(n=this.applyAttributesMapping(e,t),this._parent(n,t||i)):this},sync:function(){return this._customProperties.beingFetched=!0,g.sync.apply(this,arguments)},parse:function(i,n){var o=e.is(i,"object")||!e.is(i,"string")?i:t.decode(i),s=o&&o.result?o.result:o;switch(n.serviceName){case"update":case"create":case"patch":s=e.is(s,"object")?e.merge(s,this._previousChanges):e.merge({},this._previousChanges)}return s="function"==typeof n.parse?n.parse.call(this,s,n):this._parent(s,n),"function"==typeof n.postProcess&&n.postProcess.call(this,i,n,s),s},fetch:function(t){if(t&&("function"==typeof t.onComplete&&(t.originalOnComplete=t.onComplete),"function"==typeof t.onFailure&&(t.originalOnFailure=t.onFailure)),t&&!0===t.fromCache){var i=e.extend({},t);return i.autoPopulate=!0,"function"==typeof i.onComplete&&(i.onPopulate=i.onComplete),delete i.fromCache,o.populate(this,i)}return this._parent.apply(this,arguments)},save:function(e,t,i){var n,s,r=void 0;return this.isNew()&&(r=(i=i||{}).onComplete,i.onComplete=function(){if(o.isModelInCache(this)||(o.followUpForCacheUpdates(this),o.populate(this)),"function"==typeof r)return r.apply(this,arguments)}.bind(this)),n=this._doPreSaveOperations(e,t,i),s=this._parent(n.data,n),this._doPostSaveOperations(),s},destroy:function(e){if(this.isNew())throw new Error("Model id is not available");return void 0===(e=e||{}).wait&&(e.wait=!0),this._parent.call(this,e)},dispatchEvent:p,equals:function(e){return this===e||!!(e instanceof g&&(t=this.get(this.idAttribute)))&&t===e.get(this.idAttribute);var t},action:function(e,t){var i,n,o=this;return void 0===(t=t||{}).parse&&(t.parse=!0),i=t.onComplete,t.onComplete=function(e){var n;return!(null!==(n=o.parse(e,t))&&"object"==typeof n&&!1!==t.set&&!o.set(n,t))&&(i&&i(o,e,t),o.dispatchEvent("onSync",[o,e,t]))},n=t.onFailure,t.onFailure=function(e){n&&n(o,e,t),o.dispatchEvent("onError",[o,e,t])},this.sync(e,this,t)},hasAssociation:function(t){return e.owns(this._associations,t)},getAssociated:function(){return g.getAssociated.apply(this,arguments)},hasAssociated:function(){return g.hasAssociated.apply(this,arguments)},setAssociated:function(){return g.setAssociated.apply(this,arguments)},getDelayedSyncTask:l.getDelayedSyncTask,getId:function(){return this.get("id")||this.cid},getCacheKey:function(){return this._cacheKey||this._modelName},getCacheId:function(){return this.get(this._modelIdAttribute)},"onSync:update":function(){this.removeChanges()},"onSync:patch":function(){this.removeChanges()},"onSync:create":function(){this.removeChanges()}})).extractValue=function(t,i,n){var o=void 0;if(e.is(t,"stringad")&&e.is(i,"object")&&(o=i[t],e.is(n,"object")&&!o))for(var s in i)Object.hasOwnProperty.call(i,s)&&n[s]===t&&(o=i[s]);return o},g.applyMapping=function(t,i){var n,o,s,r=void 0,a=void 0,c=void 0,u={};if("object"==typeof i&&"object"==typeof t&&null!==i&&null!==t){for(r in t)if(Object.hasOwnProperty.call(t,r)){if("object"==typeof(o=t[r])&&null!==o)for(a in o)if(Object.hasOwnProperty.call(i,r+"->"+a))u[i[r+"->"+a]]=o[a];else if("object"==typeof(s=t[r][a])&&null!==s)for(c in s)Object.hasOwnProperty.call(i,r+"->"+a+"->"+c)&&(u[i[r+"->"+a+"->"+c]]=o[a][c]);Object.hasOwnProperty.call(i,r)?"object"==typeof(o=u[i[r]])&&null!==o&&"object"==typeof t[r]?e.extend(o,t[r]):u[i[r]]=t[r]:u[r]=t[r]}for(r in u)Object.hasOwnProperty.call(u,r)&&(2===(n=r.split("->",2)).length?(u[n[0]]=u[n[0]]||{},u[n[0]][n[1]]=u[r],delete u[r]):3===n.length&&(u[n[0]]=u[n[0]]||{}))}return u},g.applyAttributesMapping=function(t,i){var n,o=void 0,s={},r={};switch(typeof t){case"object":null!==t&&(s=e.extend({},t));break;case"string":s[t]=i}if(this._attributesMapping){if(r=g.applyMapping(s,this._attributesMapping),this._attributes)for(o in r)Object.hasOwnProperty.call(r,o)&&e.is(r[o],"object")&&(n=this.get(o),e.is(n,"object")&&(r[o]=e.extend(e.merge({},n),r[o])))}else r=s;return this._updateIdAttribute(r),r},g.applyServiceParamsMapping=function(t,i){return e.is(t,"object")&&e.is(i,"object")&&e.is(i.paramsMapping,"object")&&(t=g.applyMapping(t,i.paramsMapping)),t},g.adaptService=function(t){if(e.is(t,"object")){e.is(t.method,"string")||(t.method="POST");var i,n=e.is(t.dataType)?t.dataType:"post"===t.method.toLowerCase()?"json":null,o=t.url;t.dataType=n,"function"==typeof t.urlFn&&(t.url=t.urlFn.call(this,t.data)),o=t.url,i=t.urlRoot||this.urlRoot||l.getBaseUrl(),"string"!=typeof o||o.contains("://")||0===o.indexOf(i)||(t.url=i+("/"===o[0]||"/"===i[i.length-1]?"":"/")+o),!0===t.noParam?t.data=null:(e.is(t.data,"object")||(t.data={}),"function"==typeof t.dataFn&&(t.data=t.dataFn.call(this,t.data)),t.data&&(t.data=g.applyServiceParamsMapping(t.data,t))),function(e){var t,i,n,o=this;if(void 0!==e)return t=e.serviceName,i=e.onFailure,n=function(n){switch(t){case"create":case"update":case"patch":!e.wait&&o instanceof s&&o.set(o._previousAttributes);break;case null:case void 0:u.warn("Called service has no name")}u.error("Call failed: ",e,n),i&&i.apply(this,arguments)},e.onFailure=n,e;throw new Error("Invalid service !")}.call(this,t)}return t},g.sync=function(e,t,i){var n=!1;if(window.ds){var o=a.getInstance();if(!o.getCSRFToken()&&ds&&"3DSwym"===ds.env){var s=!1;n={cancel:function(){s=!0}};o.addEventOnce("onSync",function(){if(!s){var o=this._callService(e,t,i);o&&o.cancel&&(n.cancel=o.cancel.bind(o))}},this)}}return n||this._callService(e,t,i)},g.STATUS={notRequested:0,pending:1,valid:2,invalid:3},g.getModuleNameFromModelName=function(e,t){var i={question:"iquestion",ideation:"idea",wikipage:"wiki",wikiroot:"wiki",instantmessage:"instant-message",message:"instant-message",comment:"instant-comment",dm:"direct-message"};if("string"!=typeof t&&(t="/feature/community/"),i[e])e=i[e];else{if(e.startsWith(d.POST_DERIVED_TYPE_PREFIX))return"DS/SwymUICore/script/feature/community/post/model/post-derived-type-model";if(e.startsWith(d.IDEA_DERIVED_TYPE_PREFIX))return"DS/SwymUICore/script/feature/community/idea/model/idea-derived-type-model"}return"direct-message"===e&&(t="/feature/core/"),"DS/SwymUICore/script"+t+e+"/model/"+e+"-model"},g.saveModelWithDefaultParams=function(t,i,n,s){return new Promise(e=>{s&&s.parent?require(["DS/SwymUICore/script/feature/community/derived-type/derived-type-model-factory"],function(t){e(t.getDerivedTypeModelClass(s))}):require([g.getModuleNameFromModelName(t)],function(t){e(t)})}).then(t=>{require(["DS/SwymUICore/script/feature/core/config/bootstrap-model"],function(s){var r=n?e.clone(n,!1):{},a=r.onComplete,c={published:0,author:s.getInstance().get("user")},u=new t;r.onComplete=function(){return u.getCacheId()&&u.getCacheKey()&&!1!==u.shouldProvokeCacheUpdates()&&o.populate(u,{areModelDataFromServer:!0}),a.apply(this,arguments)},u.save(e.extend(c,i),r)})})},g.defineOwnAssociations=h,g.hasAssociated=function(e){return!!(Object.hasOwnProperty.call(this,"_associations")&&this._associations[e]&&this._associations[e].associated)&&this._associations[e].associated},g.getAssociated=function(t){if(Object.hasOwnProperty.call(this,"_associations")||this._defineOwnAssociations(),!Object.hasOwnProperty.call(this,"_associations"))throw new Error("Instance own associations are not available");var i,n,o,r=null,a=this._associations[t];if(a){if(i=a.Class||this.constructor.prototype._associations[t].Class,!(o=a.associated)){if(!i)throw new Error("No class has been declared for the associated instance. Please establish an association using setAssociated() method before calling getAssociated().");n=e.merge({urlRoot:this.urlRoot},a.options),this instanceof s&&(r=this.get(a.sourceAttribute||t)),i.prototype instanceof s?(e.is(r,"object")||(r={}),e.is(n.provokeCacheUpdates,"boolean")||(n.provokeCacheUpdates=this._provokeCacheUpdates)):(e.is(r,"array")||(r=[]),void 0===n.mode&&(n.mode=t)),!1!==n.areModelDataFromServer&&(n.areModelDataFromServer=!0),o=new i(r,n),this.setAssociated(t,o),a.oppositeRole&&o.setAssociated(a.oppositeRole,this),!0===a.autoFetch&&o.fetch({fromCache:!0})}return o}throw new Error("The requested association is missing from associations declaration")},g.setAssociated=function(e,t){if(Object.hasOwnProperty.call(this,"_associations")||this._defineOwnAssociations(),!Object.hasOwnProperty.call(this,"_associations"))throw new Error("Instance own associations are not available");if(e&&t){var i,n=this._associations[e],o=n.Class||this.constructor.prototype._associations[e].Class;if(n){if(!o||t instanceof o)return i=n.associated,n.associated=t,i&&!t.equals(i)&&i.dispatchEvent("onReplace:"+e,[i,t,this]),this.dispatchEvent("onSetAssociated:"+e,[this,i,t]),t;throw new Error("Provided argument is not an instance of expected class")}throw new Error("Provided role is missing from associations declaration")}throw new Error("Invalid arguments")},g.parentSync=function(t,i,o){var s,r,a,c,u,l,d,h;return e.is(o)||(o={}),r=m[t],e.merge(o,{emulateHTTP:!1,emulateJSON:!1}),a={method:r},o.url||(a.url=(d="url",h=void 0,(l=i)&&(h=l[d],e.is(h,"function")&&(h=h.call(l))),h||function(){throw new Error('A "url" property or function must be specified')}())),e.is(o.data)||!i||"create"!==t&&"update"!==t&&"patch"!==t||(a.type="json",a.data=o.attrs||i.toJSON(o)),o.emulateJSON&&(a.type="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),!o.emulateHTTP||"PUT"!==r&&"DELETE"!==r&&"PATCH"!==r||(a.method="POST",o.emulateJSON&&(a.data._method=r),s=o.beforeSend,o.beforeSend=function(e){if(e.setRequestHeader("X-HTTP-Method-Override",r),s)return s.apply(this,arguments)}),"GET"===a.method||o.emulateJSON||(a.processData=!1),c=e.extend(a,o),u=o.request=n.request(c),i.dispatchEvent("onRequest",[i,u,o]),u},g.dispatchEvent=p,g}),define("DS/SwymUICore/script/feature/core/tenant/model/tenant-model",["DS/SwymUICore/script/lib/model/generic/swym-model"],function(e){"use strict";return e.extend({_modelName:"tenant",stats:null,footer:null,tenantContextId:null,_attributesMapping:{id:"mid"},_services:{read:{url:"admin/api/tenant/get",dataFn:function(){return{id:this.get("mid")}}},update:{url:"admin/api/tenant/edit",paramsMapping:{mid:"id"}},listOptions:{url:"admin/api/tenant/listoption"},editOptions:{url:"admin/api/tenant/editoption"},editLogo:{url:"admin/api/tenant/setlogo"},getTenantInfo:{url:"api/analytics/infotenant",dataFn:function(){var e,t,i,n=new Date;return{date00:"2008-01-01",date01:(e=n.getFullYear(),t=n.getMonth()+1,i=n.getDate(),10>i&&(i="0"+i),10>t&&(t="0"+t),e+"-"+t+"-"+i),tenant_uuid:this.get("mid")}},parse:function(e){return this.stats=e[0],e}}},listOptions:function(e){return this.action("listOptions",e)},editOptions:function(e){return this.action("editOptions",e)},editLogo:function(e){return this.action("editLogo",e)},getTenantInfo:function(e){return this.action("getTenantInfo",e)}})}),define("DS/SwymUICore/script/lib/collection/generic/swym-collection",["UWA/Core","UWA/Json","DS/SwymUICore/script/lib/model/generic/swym-model","UWA/Class/Collection","DS/SwymUICore/script/utils/utils"],(e,t,i,n,o)=>{return n.extend({_collectionName:null,_services:null,_associations:null,_fetched:!1,_beingFetched:!1,lastCallsParams:null,lastCalledService:null,model:i,mode:null,modes:null,communityId:null,_callService(t,n,o){let s;const r=this._services;if(o||(o={}),o.areModelDataFromServer=!0,!t)throw new Error("Method is required");if(s=r&&r[t]&&r[t][this.mode],!e.is(s,"object"))throw new Error(`No service has been declared for method "${t}" and mode "${this.mode}"`);if(!this.mode)throw{name:"Mode not provided",message:"This call cannot be done without specifying the mode."};return!0===(o=e.merge(o,e.extend({},s))).parse&&s&&"function"==typeof s.parse&&(o.parse=s.parse),!o.postProcess&&s&&"function"==typeof s.postProcess&&(o.postProcess=s.postProcess),o.serviceName=t,i.adaptService.call(this,o),this.lastCalledService=t,this.lastCallsParams[t][this.mode]=o.data,i.parentSync.call(this,t,n,o)},_defineOwnAssociations:i.defineOwnAssociations,init(t,i){let n,s;const r=this,a=this._services;if(i=i||{},this._checkModel(i),this.modes=this.modes||[],this.setMode(i.mode),this.lastCallsParams={},this.urlRoot=i.urlRoot||o.getBaseUrl(),a)for(s in a)a.hasOwnProperty(s)&&(this.lastCallsParams[s]={});e.is(this._associations,"object")?(this._associations=e.extend({},this._associations||{}),(n=Object.keys(this._associations||{})).forEach(function(t){this._associations[t]=e.extend({},this._associations[t]||{})},this)):this._associations={},this.addEvents({onSync(e){e===this&&(this._beingFetched=!1)},onError(e){e===this&&(this._beingFetched=!1)}},this,1e4),this.addEventOnce("onSync:read",function(e){e===this&&(this._fetched=!0)},this,1e4);const c=o.getDelayedSyncTask(function(){let e=[];arguments.length>=1&&(e=Array.prototype.slice.call(arguments,arguments.length-1)),r.dispatchEvent("onCollectionChange",e)});return this.addEventOnce("onSync",function(){this._fetched=!0}),this.addEvents({onAdd:c,onRemove:c,onSort:c,onReset:c}),this._parent(t,i)},resetUrlRoot(e){this.urlRoot=e||o.getBaseUrl()},_getRefreshParams(i){let n;return i=i||this.lastCalledService||"read",n=this.lastCallsParams[i]&&this.mode&&this.lastCallsParams[i][this.mode],(n=e.is(n,"object")?e.clone(n):t.isJson(n)?t.decode(n):{}).params&&(n=n.params),e.is(n,"object")?n:{}},_checkModel(t){let n,{model:o}=this;if(e.is(t,"object")&&t.model instanceof i&&this.model instanceof i){if(!(t.model.prototype instanceof this.model))throw(n=this.model.prototype.getModelName())?new Error(`Provided model Class is not and does not derive from ${n.ucfirst()} Class`):new Error("Provided model Class is not and does not derive from expected Class");o=t.model}return o},setMode(e){const t=this.mode;if(e){if(!(this.modes.indexOf(e)>=0))throw{name:"Unknown mode provided",message:"The mode provided is not present in this collection's 'modes' parameter"};this.mode=e,this.dispatchEvent("onModeChange",[this,e])}return t},getCollectionName(){return this._collectionName},indexOf(e,t){let i;const n=this._parent(e,t);return n>=0?n:(i=this.get(e))?this._parent(i,t):-1},lastIndexOf(e,t){const i=this.get(e);return i?this._parent(i,t):-1},set(e,t){return t?void 0===t.parse&&(t.parse=!0):t={parse:!0},this._parent.call(this,e,t)},sync(){return this._beingFetched=!0,i.sync.apply(this,arguments)},parse(n,o){const s=e.is(n,"string")?t.decode(n):n;let r=s&&s.result?s.result:s;if("function"==typeof o.parse?(r=o.parse.call(this,r,o),o.parse=!0):r=this._parent(r,o),"function"==typeof o.postProcess&&(o.postProcess.call(this,n,o,r),delete o.postProcess),this.model&&this.model.prototype instanceof i&&e.is(r,"array")){let e;const t=[],{prototype:n}=this.model;for(let o=0,s=r.length;o<s;o++)(e=r[o])instanceof i?t.push(e):t.push(n.applyAttributesMapping(e));return t}return r},create(e,t){void 0===(t=t||{}).wait&&(t.wait=!0),this._parent.call(this,e,t)},dispatchEvent:i.dispatchEvent,_onModelEvent(e,t,i,n){switch(e){case"onDestroy":return this.dispatchEvent(e,[t,i,n]);case"onSync:delete":this.remove(t,n);default:return this._parent.apply(this,arguments)}},action(e,t){let i,n,o;const s=this;return void 0===(t=t||{}).parse&&(t.parse=!0),i=t.onComplete,t.onComplete=function(e){return t.reevaluateOptions&&t.reevaluateOptions(s,e,t),s[t.reset?"reset":"set"](e,t),i&&i(s,e,t),s.dispatchEvent("onSync",[s,e,t])},n=t.onFailure,t.onFailure=function(e){n&&n(s,e,t),s.dispatchEvent("onError",[s,e,t])},o=this.sync(e,this,t)},refresh(t,i){return(i=i||{}).data=i.data||{},t=t||this.lastCalledService||"read",e.merge(i.data,this._getRefreshParams(t)||{}),this.action(t,i)},equals(e){return this===e},hasAssociation(t){return e.owns(this._associations,t)},getAssociated:i.getAssociated,setAssociated:i.setAssociated,getDelayedSyncTask:o.getDelayedSyncTask,hasBeenFetched(){return this._fetched},isBeingFetched(){return!!(!0===this._beingFetched&&this.mode&&this.lastCalledService&&this.lastCallsParams[this.lastCalledService][this.mode])},getId(){return"function"==typeof this.id?this.id():this.id||this.cid}})}),define("DS/SwymUICore/script/feature/core/pagination/collection/paginated-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/swym-collection"],function(e,t){"use strict";return t.extend({_pages:null,_currentPage:null,_previousPage:null,_pageMode:"page",_limit:10,_previousTotalItems:null,_totalItems:null,_infiniteScroll:!1,_reachedLastPage:null,paginationMode:"NORMAL",paginationModes:["NORMAL","PREV_NEXT"],_setCurrentPage:function(t,i){t=parseInt(t,10),e.is(t,"number")&&t!==this._currentPage&&(this._currentPage=t,!0===i&&this.resetCollection())},_addPage:function(e,t,i){this._pages[t]={models:e,totalItems:i}},_removePage:function(e){delete this._pages[e]},_removePages:function(e,t){if(e=parseInt(e,10),t){var i=this._pages;for(var n in i)i.hasOwnProperty(n)&&n>=e&&delete i[n]}else this._removePage(e)},_removeAllModels:function(e){var t=this.slice();return this.remove(t,e),t},_rollbackPageChange:function(){this._currentPage=this._previousPage,this._previousPage=null},_isNewPage:function(e){var t=null,i=this._pageMode;if("number"==typeof e||"string"==typeof e)t=parseInt(e,10);else{if("object"!=typeof e)throw new Error("Invalid arguments");if(!e[i])throw{name:"No parameter "+i+" set",message:"A parameter "+i+" needs to be set for a fetch to be done"};t=parseInt(e[i],10)}return t!==this._currentPage&&t},_setPage:function(e,t){return!1!==t&&(e=this._isNewPage(e)),!1!==e&&(this._previousPage=this._currentPage,this._setCurrentPage(e)),e},getNbResults:function(e){var t;return e&&(e.hasOwnProperty("nb_result")?t=e.nb_result:e.hasOwnProperty("nhits")&&(t=e.nhits)),t},init:function(e,t){if(t||(t={}),this.setPageMode(t.pageMode),!(t.limit>0))throw{name:"No limit specified",message:"In a paginated collection, a limit must be defined on init"};return this.setLimit(t.limit),this._pages={},t.paginationMode&&(this.paginationMode=t.paginationMode),"number"==typeof t.currentPage&&this._setPage(t.currentPage),t.hasOwnProperty("infiniteScroll")&&(this._infiniteScroll=!0===t.infiniteScroll),this._parent(e,t)},getPageMode:function(){return this._pageMode},setPageMode:function(e){var t=this._pageMode;return"page"!==e&&"start"!==e&&"pageStartAtZero"!==e||(this._pageMode=e),t},getCurrentPage:function(){return this._currentPage},getLimit:function(){return this._limit},setLimit:function(e,t){(e=parseInt(e,10))>0&&e!==this._limit&&(this._limit=e,!0===t&&this.resetCollection())},getTotalItems:function(){return this._totalItems},setTotalItems:function(e){this._previousTotalItems=this._totalItems,this._totalItems=parseInt(e,10)},set:function(e,t){var i,n,o;return!0!==this.hasBeenFetched()||void 0!==this.getNbResults(e)||t&&!0===t.silent?o=this._parent.apply(this,arguments):(i=this.length,n=this.getTotalItems(),o=this._parent.apply(this,arguments),this.length-i!=this.getTotalItems()-n&&this.setTotalItems(n+(this.length-i))),o},remove:function(){var e=this.length,t=this.getTotalItems(),i=this._parent.apply(this,arguments);return!0===this.hasBeenFetched()&&this.length-e!=this.getTotalItems()-t&&this.setTotalItems(t+(this.length-e)),i},getLastPageNum:function(){var e,t=this.getLimit(),i=this.getTotalItems(),n=this.getCurrentPage();return n&&(i||!0!==this._reachedLastPage)?("PREV_NEXT"===this.paginationMode?this.length>=t||i===t?i===t?e=n+1:i>t?(e=parseInt(i/t,10),i%t>0&&e++):e=n:e=n:(e=parseInt(i/t,10),i%t>0&&e++),e):this.currentPage||1},hasPrevious:function(){return this._currentPage>1},hasNext:function(){var e=this.getLastPageNum();return e>1?"PREV_NEXT"!==this.paginationMode?e>this._currentPage:e!==this._currentPage:!this.hasBeenFetched()&&!this.isBeingFetched()},resetCollection:function(e,t){this._pages={},this._previousPage=null,e&&this._setCurrentPage(e),this.fetchPage(this._currentPage,t),this.dispatchEvent("onReset",[this,t])},goToPage:function(t,i){var n,o,s;if(o=this._isNewPage(t),i||(i={}),e.is(o,"number")){if(!this._pages.hasOwnProperty(o))return this.fetchPage(t,i);this.dispatchEvent("onBeforePageChange",[this,this._currentPage,this._previousPage]),o=this._setPage(o,!1),(n=this.toArray()).length>0&&this._previousPage&&(s=this._previousPage,this._addPage(n,s,this.getTotalItems())),n=this._pages[o].models,this.setTotalItems(this._pages[o].totalItems),this.reset(n,i),this._removePage(o),this.dispatchEvent("onAfterPageChange",[this,this._currentPage])}},fetchPage:function(t,i){var n,o,s,r,a,c=t,u=this.lastCalledService;return n=this._isNewPage(t),i||(i={}),u===i.serviceName&&!0!==i.ignoreCache||(this.dispatchEvent("onBeforePageChange",[this,this._currentPage,this._previousPage]),n=this._setPage(n,!1),o=this.toArray(),s=i.onComplete,i.onComplete=function(e,t,i){if(e._currentPage>1&&0===e.length&&!e._emptyCalls)e._removePages(1,!0),e.goToPage(parseInt(e._currentPage)-1);else{var n;if(!0!==i.ignoreCache&&!0!==e._infiniteScroll&&u===e.lastCalledService&&o.length>0&&e._previousPage)n=i.parse?e._previousTotalItems:e.getTotalItems(),e._currentPage===c?e._removePages(c,!0):e._addPage(o,String(e._previousPage),n);s&&s.call(e,e,t,i),e.dispatchEvent("onAfterPageChange",[e,e._currentPage])}},r=i.onFailure,i.onFailure=function(e,t,i){e._rollbackPageChange(),r&&r.call(e,e,t,i)}),i.data||(i.data={}),(a=this._getRefreshParams(i.serviceName))&&e.merge(i.data,a),n&&!1!==i.reset&&(i.reset=!0),this.action(i.serviceName||this.lastCalledService||"read",i)},sync:function(t,i,n){null===this._currentPage&&(this._currentPage=1);var o={limit:this._limit},s=n||{};return s||(s={}),s.data&&("page"===this.getPageMode()?(o.page=this._currentPage,delete s.data.start):"pageStartAtZero"===this.getPageMode()?(o.page=this._currentPage-1,delete s.data.start):(o.start=(this._currentPage-1)*this._limit,delete s.data.page)),s.data=e.extend(s.data||{},o),this.lastCalledService&&this.lastCalledService!==t&&this._removePages(1,!0),this._parent(t,i,s)},parse:function(t,i){var n,o=!1,s=null,r=e.is(t,"string")?e.Json.decode(t):t;return r&&(s=this.getNbResults(r)),s&&(this._reachedLastPage=null,Array.isArray(r.result)&&(void 0===s||r.result.length>s)?s=r.result.length:o=!0,this.setTotalItems(s)),n=this._parent(t,i),o&&Array.isArray(n)&&n.length<this._limit&&(this._reachedLastPage=!0),n},setMode:function(e){var t=this._parent(e);return t!==this._mode&&this._removePages(1,!0),t},"onSync:delete":function(){},getNbLoadedModels:function(){var e=this._models.length;for(var t in this._pages)this._pages.hasOwnProperty(t)&&(e+=this._pages[t].models.length);return e}})}),define("DS/SwymUICore/script/feature/core/realtime/rt-connector",["require","exports","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/PlatformAPI/PlatformAPI"],function(e,t,i,n){"use strict";return function(){function e(){this.GENERIC_NOTIF_TOPIC="intf-ws-topic",this.CONNECTION_READY="ready",this.PUSH_3DNOTIFICATION_TOPIC="pushto3dnotification",e.tenantOID=i.getInstance().get("config").tenant.online_instance_id,e.rtNewMessageTopic="tenant_"+e.tenantOID+"_new_message",this.setupSecurityTokenExchange()}return e.prototype.setupSecurityTokenExchange=function(){this.publish3DNotificationTopic(),n.subscribe(this.GENERIC_NOTIF_TOPIC,this.subscribeGenericNotif.bind(this))},e.prototype.subscribeGenericNotif=function(e){e&&e.event===this.CONNECTION_READY&&this.publish3DNotificationTopic()},e.prototype.publish3DNotificationTopic=function(){n.publish(this.PUSH_3DNOTIFICATION_TOPIC,{method:"pushplatformid",data:{provider:"3dswym",data:e.tenantOID}})},e.RTMainCallback=function(t){e.callbackFunctionsMapping.forEach(function(e){console.log("in the RTMaincallback"),e(t)})},e.subscribeToRT=function(){this.subscribeGenericNotifSubscription||(this.subscribeGenericNotifSubscription=n.subscribe(this.rtNewMessageTopic,this.RTMainCallback))},e.subscribe=function(e){this.subscribeToRT();var t=this.indexSubscriber;return this.callbackFunctionsMapping.set(t,e),this.indexSubscriber++,t},e.unsubscribe=function(e){this.callbackFunctionsMapping.delete(e)},e.init=function(){return e.instance||(e.instance=new e),e.instance},e.indexSubscriber=0,e.callbackFunctionsMapping=new Map,e}()}),define("DS/SwymUICore/script/feature/community/member/model/mixin/community-member",["require","exports","i18n!DS/SwymUICore/assets/nls/feature/core/user/collection/member-collection","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/Logger/Logger"],function(e,t,i,n,o){"use strict";var s="1",r="2",a="3",c="ds6w:role.swym_contributor",u="ds6w:role.swym_author",l="ds6w:role.swym_owner",d="ds6w:role.swym_mainowner";return{_associations:{community:{}},_actionsCollectionClass:null,actions:null,collection:null,setActionsCollectionClass:function(e){this._actionsCollectionClass=e},getCommunityRoleFromExaleadRole:function(e){switch(e){case c:return s;case u:return r;case d:case l:return a}return""},getInlineActionsUpdate:function(e,t){var n=null,s=this._actionsCollectionClass;switch(e){case"1":n=[{id:"author",title:i.Setasauthor,icon:"user"},{id:"owner",title:i.Setasowner,icon:"user"},{id:"delete",title:i.Delete,icon:"trash"}];break;case"2":n=[{id:"contributor",title:i.Setascontributor,icon:"user"},{id:"owner",title:i.Setasowner,icon:"user"},{id:"delete",title:i.Delete,icon:"trash"}];break;case"3":n=[{id:"contributor",title:i.Setascontributor,icon:"user"},{id:"author",title:i.Setasauthor,icon:"user"},{id:"delete",title:i.Delete,icon:"trash"}];break;default:o.log("Member's role is not defined")}return"array"!==t&&(n=new s(n)),n},updateActions:function(e){var t;(t=this.get("relation")||e)&&this.actions.reset(this.getInlineActionsUpdate(t,"array"))},addActions:function(){if(this.collection){var e,t,i=this.collection,o=n.getInstance().get("user").hash_key;i&&(e=i.getAssociated("owned"))&&e.get("mid")&&(e.has("this")&&parseInt(e.get("this").getCurrentUserRights,10)>=3||!0===this.collection.as_admin)&&(t=e.getAssociated("owner").get("hash_key"),this.get("hash_key")!==o&&this.get("hash_key")!==t&&(this.actions?this.actions.reset(this.getInlineActionsUpdate(this.get("relation"),"array")):this.actions=this.getInlineActionsUpdate(this.get("relation"))))}}}}),define("DS/SwymUICore/script/feature/community/survey/model/answer-model",["DS/SwymUICore/script/lib/model/generic/swym-model"],function(e){return e.extend({_modelName:"survey-answer",HTML_ATTRIBUTES:["description","custom_text"],getPercentage:function(){var e;return 0===parseInt(this.get("nbVotes"),10)?e="0":this.collection?e=parseFloat(this.get("nbVotes")/this.collection.getTotalVotes()*100,10).toFixed(1):(console.warn("Something is trying to access the collection but it is not defined and maybe not used at all ?"),e=0),e},getRoundedPercentage:function(){var e,t=this.collection;if(t&&t.indexOf(this)===t.length-1){for(var i=0,n=0,o=t.length;n<o-1;n++)i+=parseFloat(t.at(n).getPercentage());e=0!==parseInt(this.get("nbVoters"),10)?parseFloat(100-i).toFixed(1):"0"}else e=this.getPercentage();return e}})}),define("DS/SwymUICore/script/feature/community/social-event/model/takeaway-model",["require","exports","DS/SwymUICore/script/lib/model/generic/swym-model"],function(e,t,i){"use strict";return i.extend({_modelName:"takeaway",defaults:{id:"",title:"",type:"",uri:"",position:0},isNew:function(){return!1},destroy:function(e){return this.dispatchEvent("onTakeawayRemove",this),this._parent.apply(this,arguments)}})}),define("DS/SwymUICore/script/utils/localstorage-manager",["require","exports","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/Logger/Logger","UWA/Class"],function(e,t,i,n,o){"use strict";return o.singleton({init:function(){return this},setItem:function(e,t){try{window.localStorage.setItem(e,JSON.stringify(t))}catch(e){console.error(e)}},getItem:function(e,t){return JSON.parse(window.localStorage.getItem(e))},removeItem:function(e,t){window.localStorage.removeItem(e)},setPrefixedItem:function(e,t,i){try{window.localStorage.setItem(this._buildPrefixedKey(e,i),JSON.stringify(t))}catch(e){console.error(e)}},getPrefixedItem:function(e,t){return JSON.parse(window.localStorage.getItem(this._buildPrefixedKey(e,t)))},removePrefixedItem:function(e,t){window.localStorage.removeItem(this._buildPrefixedKey(e,t))},_buildPrefixedKey:function(e,t){var o,s="3DSWYM",r=!1,a=i.getInstance();if(!t)throw new Error("The options object is not defined");return!0===t.tenant&&t.widget&&t.widget.id?a.get("config")&&a.get("config").hasOwnProperty("tenant")&&a.get("config").tenant.hasOwnProperty("id")&&(s+="-"+a.get("config").tenant.id+"-"+t.widget.id,r=!0):!0===t.tenant?a.get("config")&&a.get("config").hasOwnProperty("tenant")&&a.get("config").tenant.hasOwnProperty("id")&&(s+="-"+a.get("config").tenant.id,r=!0):t.widget&&t.widget.id&&(s+="-"+t.widget.id,r=!0),!0===r?o=s+"-"+e:n.error("Either the tenant or the widget should be specified in the options object"),o}}).init()}),define("DS/SwymUICore/script/feature/community/social-event/model/pres-support-model",["DS/SwymUICore/script/lib/model/generic/swym-model"],function(e){return e.extend({_modelName:"presentation-support",defaults:{id:"",type:"",source:"",label:"",preview_url:""},HTML_ATTRIBUTES:["id"],_attributesMapping:{id:"id"},isNew:function(){return!1},destroy:function(e){this.dispatchEvent("onPresentationSupportRemove",this)}})}),define("DS/SwymUICore/script/utils/app-navigation-state",["require","exports","UWA/Class","DS/SwymUICore/script/utils/localstorage-manager","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/core/context/mde/north-context-mixin"],function(e,t,i,n,o,s,r,a){"use strict";var c={version:"1.1",leftPanelState:"dmTab",route:"",lastThreadAccessed:{community:"home",dm:""},feedMode:{community:s.SWYM_IM_CENTRAL_COLUMN_DEFAULT_MODE_COMMUNITY,dm:s.SWYM_IM_CENTRAL_COLUMN_DEFAULT_MODE_CONVERSATION},sortMode:{community:s.SWYM_IM_CENTRAL_COLUMN_DEFAULT_SORT_MODE,dm:s.SWYM_IM_CENTRAL_COLUMN_DEFAULT_SORT_MODE},lightboxPanelState:"comment"};//! Anytime the keys are modified, the version should be updated
return i.singleton({_navigationState:c,_context:null,_version:"1.1",_bootstapModel:null,_appNavStateTenantId:"",init:function(){var e=this;return this._bootstrapModel=o.getInstance(),this._parent.apply(this,arguments),this._bootstrapModel.executeWhenReady(function(){e._setupNavigationPreferences(),e._initNavigationState(),e._context=r.getInstance(),e._context.addListener("onContextChange",e._onContextChangeCallback.bind(e)),e._context.addListener("onTenantChange",e._initNavigationState.bind(e))}),this},_setupNavigationPreferences:function(){if(window.ds&&"3DD"===window.ds.env){var e=widget.getValue("BEContentId"),t=widget.getValue("X3DContentId");if(e||t){var i=e||t,n={};a._extractContextInfoFromSearchResultSelectedRouteNorth(i,n);var o=widget.getValue("BEUsageData"),r=widget.getValue("__be");if(o&&r){var c=JSON.parse(o),u=JSON.parse(r.beData);if(null!==u.contentType){var l=u.contentType,d=null,m=null,h=null,p=null,g=null,f=null,_=null;if(null===u.contentToDisplay){switch(l){case"post":d="/blog";break;case"media":d="/media";break;case"ideation":case"idea":d="/ideas";break;case"question":d="/questions";break;case"wiki":d="/wiki";break;default:p=c[u.contentType],f="ideation"===u.contentToReuse?"idea":u.contentToReuse,d="/dt-".concat(f,"s-").concat(p)}_="".concat(d)}else{switch(l){case"post":case"media":case"idea":case"ideation":case"question":case"wiki":d="/".concat(l),h=c[u.contentToDisplay],g=s.extractDataFromSubject6wURI(h),m=":".concat(g.extraAttrs.mid);break;default:p=c[u.contentType],f="ideation"===u.contentToReuse?"idea":u.contentToReuse,d="/dt-".concat(f,"-").concat(p),h=c[u.contentToDisplay],g=s.extractDataFromSubject6wURI(h),m=":".concat(g.extraAttrs.mid)}_="".concat(d).concat(m),widget.setValue("contentId","".concat(g.extraAttrs.mid))}n.communityId&&(widget.setValue("route","community:".concat(n.communityId).concat(_)),widget.setValue("community","".concat(n.communityId)),widget.setValue("contentType","".concat(d.slice(1))))}else n.communityId&&(widget.setValue("route","community:".concat(n.communityId)),widget.setValue("community","".concat(n.communityId)))}widget.setValue("persistNav",!1),widget.setValue("BEContentId",void 0),widget.setValue("X3DContentId",void 0)}}},_initNavigationState:function(){var e;if(window.ds&&"3DD"===window.ds.env&&!1===this._isRightPanel()?(this._appNavStateTenantId=this._getTenantId(),e=n.getPrefixedItem("nav",{tenant:!0,widget:widget})):(window.ds&&"3DD"!==window.ds.env||!0===this._isRightPanel())&&(e=n.getPrefixedItem("nav",{tenant:!0})),e&&(e.sortMode||(e.sortMode=c.sortMode),this._navigationState=e),window.ds&&"3DD"===window.ds.env&&!1===this._isRightPanel()&&!widget.getValue("persistNav")&&(this._navigationState.route=widget.getValue("route")?widget.getValue("route"):this._navigationState.route,n.getItem(widget.id))){var t=n.getItem(widget.id).route;this._navigationState.route=t||"home"}window.widget&&window.widget.getValue&&"closed"===window.widget.getValue("leftPanelState")&&(this._navigationState.leftPanelState=window.widget.getValue("leftPanelState"))},_saveNavigationState:function(){if(window.ds&&"3DD"===window.ds.env&&!1===this._isRightPanel())if(this._getTenantId()===this._appNavStateTenantId)n.setPrefixedItem("nav",this._navigationState,{tenant:!0,widget:widget});else for(var e in this._navigationState)"route"!==e&&widget.deleteValue(e);else(window.ds&&"3DD"!==window.ds.env||this._isRightPanel())&&n.setPrefixedItem("nav",this._navigationState,{tenant:!0})},_isRightPanel:function(){return!(!window.widget||!window.widget.body||!0!==widget.body.className.contains("environment-sidepanel"))},_onContextChangeCallback:function(){this._context.isHomePageContext()||1!==s.getNbLayoutColumns()||this.saveLeftPanelState("closed"),this.saveRoute(this._context.getRoute())},saveLeftPanelState:function(e){(1===s.getNbLayoutColumns()||window.ds&&"3DD"===window.ds.env&&!0===widget.getValue("persistNav"))&&(this._navigationState.leftPanelState=e,this._saveNavigationState())},getLeftPanelState:function(){return this._navigationState.leftPanelState},getLastCommunity:function(){return this._navigationState.lastThreadAccessed.community},getLastDM:function(){return this._navigationState.lastThreadAccessed.dm},saveCommunity:function(e){var t={};this._navigationState&&(t=this._navigationState.lastThreadAccessed),t.community=e,this._navigationState.lastThreadAccessed=t,this._saveNavigationState()},saveDM:function(e){var t={};this._navigationState&&(t=this._navigationState.lastThreadAccessed),t.dm=e,this._navigationState.lastThreadAccessed=t,this._saveNavigationState()},saveCtyFeedMode:function(e){var t={};this._navigationState&&(t=this._navigationState.feedMode),t.community=e,this._navigationState.feedMode=t,this._saveNavigationState()},saveDMFeedMode:function(e){var t={};this._navigationState&&(t=this._navigationState.feedMode),t.dm=e,this._navigationState.feedMode=t,this._saveNavigationState()},saveCtySortMode:function(e){var t={};this._navigationState&&(t=this._navigationState.sortMode),t.community=e,this._navigationState.sortMode=t,this._saveNavigationState()},saveDMSortMode:function(e){var t={};this._navigationState&&(t=this._navigationState.sortMode),t.dm=e,this._navigationState.sortMode=t,this._saveNavigationState()},getCtyFeedMode:function(){return this._navigationState.feedMode.community},getDMFeedMode:function(){return this._navigationState.feedMode.dm},getCtySortMode:function(){return this._navigationState.sortMode.community},getDMSortMode:function(){return this._navigationState.sortMode.dm},saveRoute:function(e){this._navigationState.route=e,window.ds&&"3DD"===window.ds.env&&(widget.getValue("persistNav")||""===e)?n.setPrefixedItem("nav",this._navigationState,{tenant:!0,widget:widget}):this._saveNavigationState()},getRoute:function(){return this._navigationState&&this._navigationState.route?this._navigationState.route:this._context.getRoute()},saveLightboxPanelState:function(e){this._navigationState.lightboxPanelState=e,this._saveNavigationState()},getLightboxPanelState:function(){return this._navigationState.lightboxPanelState},_isVersionInLSUpToDate:function(e){return!!e.version&&this._version===this._navigationState.version},
//! \\ _migrateLegacyNavState is commented to see if this is why the navigation is lost after an upgrade
_getTenantId:function(){var e="";if(widget&&widget.getPreference("url"))e=widget.getPreference("url").id;else{if(!this._bootstrapModel||!this._bootstrapModel.get("config"))throw new Error("No tenant found");e=this._bootstrapModel.get("config").tenant.online_instance_id}return e}}).init()}),define("DS/SwymUICore/script/feature/community/idea/model/status-model",["DS/SwymUICore/script/lib/model/generic/swym-model"],function(e){"use strict";return e.extend({_modelName:"status",_attributesMapping:{id:"mid",position:"status_nb"}})}),define("DS/SwymUICore/script/feature/community/idea/collection/status-collection",["DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/community/idea/model/status-model"],function(e,t){"use strict";return e.extend({_services:{read:{model:{urlFn:function(){return"api/v2/communities/"+this.getAssociated("model").getCommunityId()+"/ideaStatuses"},method:"GET",dataFn:function(){const e=this.getAssociated("model"),t=e&&e.get("name")||"";return t?{derived_type_id:t}:{}}}}},_associations:{model:{}},mode:null,modes:["model"],model:t,hasBeenFetched:function(){return this._parent.apply(this,arguments)},ideaIsMature:function(e){var t,i;return this.length>0&&(this.forEach(function(n,o){n.get("is_mature")&&(t=o+1),e.get("status_id")==n.get("mid")&&(i=parseInt(n.get("status_nb"),10))}),t||(t=this.length),i>=t)},comparator:function(e,t){return parseInt(e.get("status_nb"),10)<parseInt(t.get("status_nb"),10)?-1:1}})}),define("DS/SwymUICore/script/feature/core/6wtag/collection/6wtag-collection",["require","exports","UWA/Core","UWA/Json","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/core/6wtag/model/6wtag-model","DS/SwymUICore/script/lib/6wpanel/utils","DS/Logger/Logger","DS/SwymUICore/script/utils/utils"],function(e,t,i,n,o,s,r,a,c){"use strict";var u=null,l=o.extend({_collectionName:"6wtag-collection",_associations:{tagged:{}},_defaultParsingFn:function(e,t){var n=[];return e&&e.facets&&i.is(e.facets,"array")&&(e=e.facets),i.is(e,"array")?e.length>0&&e[0].sixw&&e[0].object&&(n=e):!0===t.tagsWithoutSubjectURI&&(n=r.extractTagsFromExaleadResponse(e)),n},_defaultPostProcessFn:function(e,t,n){var o,s,r,a,c,u={},l=[];try{if((a=this._associations.tagged.associated)&&(s=(c=a.getSixwURIs())&&c.length)>0)for(o=0;o<s;o+=1)u[c[o]]=[]}catch(e){}if(e&&e.tags&&Array.isArray(e.tags)&&e.tags.length>0)l=e.tags;else if(i.is(n,"array")&&n.length>0)for(o=0,s=n.length;o<s;o+=1)(r=n[o])&&"object"==typeof r&&(r.subjectURI?(u[r.subjectURI]=u[r.subjectURI]||[],u[r.subjectURI].push(r)):l.push(r));this._tagsWithSubjectURIData=u,this._tagsWithoutSubjectURIData=l},_services:{read:{"mixed-collection:whats-new":{url:"api/exalead/whatsnew",tagsWithoutSubjectURI:!0},"mixed-collection:community":{url:"api/exalead/whatsnew",tagsWithoutSubjectURI:!0},"mixed-collection:latestContributions":{url:"api/exalead/whatsnew",tagsWithoutSubjectURI:!0},"post-collection:all":{url:"api/exalead/search",tagsWithoutSubjectURI:!0},"post-collection:community":{url:"api/exalead/search",tagsWithoutSubjectURI:!0},"post-collection:communityWhatsnewPosts":{url:"api/exalead/whatsnew",tagsWithoutSubjectURI:!0},"post-collection:latestContributions":{url:"api/exalead/whatsnew",tagsWithoutSubjectURI:!0},"media-collection:all":{url:"api/exalead/search",tagsWithoutSubjectURI:!0},"media-collection:communityMedia":{url:"api/exalead/search",tagsWithoutSubjectURI:!0},"media-collection:mediaByTenant":{url:"api/exalead/search",tagsWithoutSubjectURI:!0},"media-collection:communityHighSemanticMedia":{url:"api/exalead/whatsnew",tagsWithoutSubjectURI:!0},"media-collection:latestContributions":{url:"api/exalead/whatsnew",tagsWithoutSubjectURI:!0},"iquestion-collection:published":{url:"api/exalead/search",tagsWithoutSubjectURI:!0},"iquestion-collection:communityPublished":{url:"api/exalead/search",tagsWithoutSubjectURI:!0},"iquestion-collection:communityQuestionsPublishedNotValidated":{url:"api/exalead/search",tagsWithoutSubjectURI:!0},"iquestion-collection:latestContributions":{url:"api/exalead/whatsnew",tagsWithoutSubjectURI:!0},"iquestion-collection:communityWhatsnewQuestions":{url:"api/exalead/whatsnew",tagsWithoutSubjectURI:!0},"idea-collection:community":{url:"api/exalead/search",tagsWithoutSubjectURI:!0},"idea-collection:community-full-list":{url:"api/exalead/search",tagsWithoutSubjectURI:!0},"idea-collection:transfer-to-idea-list":{url:"api/exalead/search",tagsWithoutSubjectURI:!0},"idea-collection:latestContributions":{url:"api/exalead/whatsnew",tagsWithoutSubjectURI:!0},"survey-collection:community-surveys":{url:"api/exalead/search",tagsWithoutSubjectURI:!0},"survey-collection:latestContributions":{url:"api/exalead/whatsnew",tagsWithoutSubjectURI:!0},"wedo-collection:community-tactical-wedos":{url:"api/exalead/whatsnew",tagsWithoutSubjectURI:!0},"wedo-collection:latestContributions":{url:"api/exalead/whatsnew",tagsWithoutSubjectURI:!0},"wiki-collection:community":{url:"api/exalead/whatsnew",tagsWithoutSubjectURI:!0},"wiki-collection:communityLastUpdatedWiki":{url:"api/exalead/search",tagsWithoutSubjectURI:!0},"wiki-collection:latestContributions":{url:"api/exalead/whatsnew",tagsWithoutSubjectURI:!0},"social-event-collection:communityWhatsnewSocialEvents":{url:"api/exalead/whatsnew",tagsWithoutSubjectURI:!0},"mixed-collection:search":{url:"api/exalead/search",tagsWithoutSubjectURI:!0},"mixed-collection:customlist":{url:"api/exalead/search",tagsWithoutSubjectURI:!0},"community-collection:my-communities":{url:"api/exalead/searchmycommunities",tagsWithoutSubjectURI:!0},"community-collection:all-my-communities":{url:"api/exalead/searchmycommunities",tagsWithoutSubjectURI:!0},"community-collection:discover-communities":{url:"api/exalead/searchdiscovercommunities",tagsWithoutSubjectURI:!0},"community-collection:tenant-communities":{url:"api/exalead/search",tagsWithoutSubjectURI:!0},"community-collection:my-communities-detailed":{url:"api/exalead/searchmycommunities",tagsWithoutSubjectURI:!0},"community-collection:my-non-dm-communities":{url:"api/exalead/searchmycommunities",tagsWithoutSubjectURI:!0},"user-collection:listmembers":{url:"api/exalead/searchcommunitymembers",tagsWithoutSubjectURI:!0},"member-collection-v2:listmembers":{url:"api/exalead/searchcommunitymembers",tagsWithoutSubjectURI:!0},"community-tl-collection:community":{method:"GET",url:"api/community/timeline",tagsWithoutSubjectURI:!0,data:{limit:0}},"community-tl-collection:communityByContentType":{method:"POST",url:"api/community/timeline",tagsWithoutSubjectURI:!0,data:{limit:0}},"contents-collection:whats-new":{urlFn:function(){return"".concat(u,"/search")},noCsrfToken:!0,tagsWithoutSubjectURI:!0,data:{limit:1}},"contents-collection:container":{urlFn:function(){return"".concat(u,"/search")},noCsrfToken:!0,tagsWithoutSubjectURI:!0},"6wtaggingserver:subject":{method:"GET",parse:function(e){return r.extractExplicitTagsFromTaggerResponseForSingleSubject(e)}},"idea-dt-collection:fake-filtered-idea-derived-type":{},"idea-dt-collection:exalead-filtered-idea-derived-type":{url:"api/exalead/search",tagsWithoutSubjectURI:!0},"idea-dt-collection:latestContributions":{url:"api/exalead/whatsnew",tagsWithoutSubjectURI:!0},"post-dt-collection:fake-filtered-post-derived-type":{},"post-dt-collection:latestContributions":{url:"api/exalead/whatsnew",tagsWithoutSubjectURI:!0}}},model:s,mode:null,modes:["mixed-collection:whats-new","mixed-collection:community","mixed-collection:latestContributions","post-collection:all","post-collection:community","post-collection:communityWhatsnewPosts","post-collection:latestContributions","media-collection:all","media-collection:communityMedia","media-collection:mediaByTenant","media-collection:communityHighSemanticMedia","media-collection:latestContributions","iquestion-collection:published","iquestion-collection:communityPublished","iquestion-collection:communityQuestionsPublishedNotValidated","iquestion-collection:latestContributions","iquestion-collection:communityWhatsnewQuestions","idea-collection:community","idea-collection:community-full-list","idea-collection:transfer-to-idea-list","idea-collection:latestContributions","survey-collection:community-surveys","survey-collection:latestContributions","wedo-collection:community-tactical-wedos","wedo-collection:latestContributions","wiki-collection:community","wiki-collection:communityLastUpdatedWiki","wiki-collection:latestContributions","social-event-collection:communityWhatsnewSocialEvents","mixed-collection:search","mixed-collection:customlist","community-collection:my-communities","community-collection:all-my-communities","community-collection:discover-communities","community-collection:tenant-communities","community-collection:my-communities-detailed","community-collection:my-non-dm-communities","user-collection:listmembers","member-collection-v2:listmembers","community-tl-collection:community","community-tl-collection:communityByContentType","contents-collection:whats-new","contents-collection:container","6wtaggingserver:subject","idea-dt-collection:fake-filtered-idea-derived-type","idea-dt-collection:exalead-filtered-idea-derived-type","idea-dt-collection:latestContributions","post-dt-collection:fake-filtered-post-derived-type","post-dt-collection:latestContributions"],_tagsWithoutSubjectURIData:null,_tagsWithSubjectURIData:null,init:function(e,t){return this._tagsWithoutSubjectURIData=[],this._tagsWithSubjectURIData={},this._parent(e,t)},parse:function(e,t){try{var o=i.is(e,"string")?n.decode(e):e,s=o&&(o.tags||o.result)||o;return!0===(t=t||{}).parse&&(this.mode?"function"!=typeof this._services.read[this.mode].parse:"function"!=typeof this._services.read.parse)&&(t.parse=this._defaultParsingFn),"function"!=typeof t.postProcess&&(this.mode?"function"!=typeof this._services.read[this.mode].postProcess:"function"!=typeof this._services.read.postProcess)&&(t.postProcess=this._defaultPostProcessFn),this._parent.call(this,s,t)}catch(e){return a.error("Error parsing result: ".concat(e.message)),!1}},sync:function(e,t,i){try{return(i=i||{}).reset=!1!==i.reset,i.data=i.data||{},i.data.legacyFormat=r.requestLegacyFormatForExaleadSearches(),this._parent(e,t,i)}catch(e){a.error("Error syncing tag collection: ".concat(e.message))}},create:function(){},getTagsWithoutSubjectURIData:function(){return this._tagsWithoutSubjectURIData},getTagsWithSubjectURIData:function(){return this._tagsWithSubjectURIData},getTagged:function(){return this.getAssociated("tagged")},onTaggedModeChange:function(e,t){try{this.setMode("".concat(e.getCollectionName(),":").concat(t))}catch(e){a.warn(e.message)}},"onSetAssociated:tagged":function(e,t,i){if(i instanceof o){try{this.setMode("".concat(i.getCollectionName(),":").concat(i.mode))}catch(e){a.warn(e.message)}i.addEvent("onModeChange",this.onTaggedModeChange,this)}t instanceof o&&t.removeEvent("onModeChange",this.onTaggedModeChange,this)}});return window.ds&&window.ds.isMDE&&c.getFedSearchUrlPromise().then(function(e){u=e}),l});__extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/SwymUICore/script/lib/model/generic/6wtaggable-model",["require","exports","UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/lib/6wpanel/6wtaggable","DS/SwymUICore/script/lib/6wpanel/utils","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/6wtag/collection/6wtag-collection","DS/SwymUICore/script/utils/ts-utils"],function(e,t,i,n,o,s,r,a,c){"use strict";var u=function(){var e;return!!this.getSubjectURIForTagger()&&(e=this._getTagSet(this.get("tags6w")||this.get("tags"),this.get("tags6w_implicit")),this.resetTaggingSession(),this.getTags().reset(e,{parse:!0}),!0)},l=function(e){function t(i,n){var o=e.call(this,i,n)||this;return o._associations={"6wtags":{Class:a,oppositeRole:"tagged",options:{mode:""}}},o._attributesMapping={id:"mid",resourceid:"subject6wuri"},o._recomputeTags=u,o._recomputeTags||(o._recomputeTags=r.getDelayedSyncTask(t.recomputeTags)),o._tagsToSendArray||(o._tagsToSendArray={add:{},remove:{}}),o._reformattedTaggingActions6w||(o._reformattedTaggingActions6w={add:{},remove:{}}),o}return __extends(t,e),t.prototype.getTags=function(){return this.getAssociated("6wtags")},t.prototype.resetTaggingSession=function(){return this._tagsToSendArray&&this._reformattedTaggingActions6w?(this._tagsToSendArray.add=[],this._tagsToSendArray.remove=[],this._reformattedTaggingActions6w.add={},this._reformattedTaggingActions6w.remove={}):(this._tagsToSendArray={add:[],remove:[]},this._reformattedTaggingActions6w={add:{},remove:{}}),this.removeChanges(["tags6w","taggingActions6w"]),this},t.prototype._updateTaggingActionsList=function(e,t){if(this.getSubjectURIForTagger()){var i,n,o,s,r,a=!1,c={},u=this.getSubjectURIForTagger(),l=this._tagsToSendArray,d=this._reformattedTaggingActions6w,m=this.getChanges("taggingActions6w")||{add:[{subject:u,tag:[]}],remove:[{subject:u,tag:[]}]};if(s="remove"===(t="remove"===t?"remove":"add")?"add":"remove",d&&e&&e.object){if(c.predicate=e.predicate,o=e.predicate+"/"+e.object,c.object={literal:e.object},d[s][o]){for(delete d[s][o],i=0,n=(r=l[s]).length;i<n;i++)if(r[i].predicate+"/"+r[i].object.literal===o){r.splice(i,1);break}m[s][0].tag=r,a=!0}else d[t][o]||(d[t][o]=c,l[t].push(c),m[t][0].tag=l[t],a=!0);return!0===a&&this.addChanges("taggingActions6w",m),a}}return!1},t.prototype.getSubjectURIForTagger=function(){return this.get("subject6wuri")},t.prototype._getTagSet=function(e,t){var i,n=[],o=this.getSubjectURIForTagger();return o?(n=(n=e||[]).concat(t||[]),i=s.processTagAttribute(o,n,[],"array")):i=[],i},t.prototype.getTagsToBeShown=function(){var e,t=new a;return t.setAssociated("tagged",this),e=this.hasVirtuallyChanged("tags6w")?this.getChanges("tags6w"):i.clone(this.get("tags6w"),!1),t.reset(this._getTagSet(e,this.get("tags6w_implicit"))),t},t.prototype.save=function(t,i,n){var o=e.prototype.save.call(this,t,i,n);return this.resetTaggingSession(),o},t.prototype.onTagCreation=function(e,t){var n,o,s,r;for(n=0,o=(s=(s=!0!==t&&this.hasVirtuallyChanged("tags6w")?this.getChanges("tags6w"):i.clone(this.get("tags6w"),!1))||[]).length;n<o;n++)if(s[n].predicate===e.predicate&&s[n].tag===e.object){r=n;break}return void 0!==r?null:(s.push({predicate:e.predicate,tag:e.object.replace(/\//g,"&#47;")}),!0!==t?(this.addChanges("tags6w",s),this._updateTaggingActionsList(e,"add")):this.set("tags6w",s),this)},t.prototype.onTagDeletion=function(e,t){var n,o,s,r;if(s=!0!==t&&this.hasVirtuallyChanged("tags6w")?this.getChanges("tags6w"):i.clone(this.get("tags6w"),!1),i.is(s,"array")){for(n=0,o=s.length;n<o;n++)if(s[n].predicate===e.predicate&&s[n].tag===e.object){r=n;break}if(void 0===r)return null;s.splice(r,1),!0!==t?(this.addChanges("tags6w",s),this._updateTaggingActionsList(e,"remove")):this.set("tags6w",s)}return this},t.prototype.getSixwURIs=function(){var e=[];return this.getSubjectURIForTagger()&&e.push(this.getSubjectURIForTagger()),e},t.prototype.deriveTagActionsFromContentChanges=function(e,t,n){var o,r,a,c=void 0;if(i.is(t)){for(c in o=i.is(e)?s.get6WTagsFromHTML(e):[],r=s.get6WTagsFromHTML(t),a=(this.get("tags6w")||[]).reduce(function(e,t){return e[t.predicate+"/"+t.tag]={predicate:t.predicate,object:t.tag},e},{}),o)o.hasOwnProperty(c)&&(r.hasOwnProperty(c)||this.onTagDeletion(o[c],!1));for(c in r)r.hasOwnProperty(c)&&(o.hasOwnProperty(c)&&a.hasOwnProperty(c)||this.onTagCreation(r[c],!1))}},t.prototype["onChange:tags6w"]=function(e,t,i){this._recomputeTags()},t.prototype["onChange:tags6w_implicit"]=function(e,t,i){this._recomputeTags()},t.prototype["onChange:tags"]=function(e,t,i){this._recomputeTags()},t.prototype["onChange:subject6wuri"]=function(e,t,i){window.require(["DS/SwymUICore/script/feature/core/6wtag/collection/6wtag-collection"],function(e){this._associations["6wtags"].Class=e,this._recomputeTags()}.bind(this))},t.recomputeTags=u,t}(n);return c.mergeMixins(l,[o]),l});__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};define("DS/SwymUICore/script/feature/community/idea/model/idea-type-model",["require","exports","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/idea/collection/status-collection"],function(e,t,i,n){"use strict";return i.extend({_modelName:"idea-type",_associations:{statusCollection:{Class:n,oppositeRole:"model",sourceAttribute:"ideation_status",options:{mode:"model"}}},_services:{nbIdeasPerStatus:{url:"api/Ideation/getnbideaperstatus",dataFn:function(){return __assign({community_id:this.get("communityId")},this.get("name")&&{derived_type_id:this.get("name")})},parse:function(e){var t=this.getStatusCollection();return e.forEach(function(e){t.findWhere({mid:e.status_id}).set("nb_ideas",e.nb_ideas)}),e}}},init:function(e){if("COMMUNITY"===e.parent){if(e.communityId&&!e.mid)e.mid=e.communityId;else if(!e.communityId&&!e.mid)throw new Error("Community id is needed for a default idea type")}else e.mid=e.id,e.name=e.id;return this._parent.apply(this,arguments)},getCommunityId:function(){return this.get("communityId")},getStatusCollection:function(){var e=this,t=this.getAssociated("statusCollection");return t.hasBeenFetched()||t.isBeingFetched()||t.fetch({onComplete:function(t){e.set("ideation_status",t.toJSON())}}),t},getNbIdeasPerStatus:function(e){return this.action("nbIdeasPerStatus",e)}})}),define("DS/SwymUICore/script/feature/core/stats/model/column-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/utils/date","DS/WebappsUtils/Console"],function(e,t,i,n){return t.extend({_modelName:"column",_communityId:null,_tenantId:null,_fromDate:null,_toDate:null,_title:null,_asAdmin:!1,_attributesMapping:{},_servicesMode:{rangeuservisits:{read:{url:"api/analytics/rangeuservisits",dataFn:function(){return{community_id:this._communityId,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(e){return this._format(e,["nb_users"])}}},rangeposts:{read:{url:"api/analytics/rangeposts",dataFn:function(){return{community_id:this._communityId?this._communityId:null,tenant_id:this._tenantId?this._tenantId:null,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(e){return this._format(e,["nb_posts"])}}},rangemessages:{read:{url:"api/analytics/rangemessages",dataFn:function(){return{community_id:this._communityId?this._communityId:null,tenant_id:this._tenantId?this._tenantId:null,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(e){return this._format(e,["nb_messages"])}}},rangecontents:{read:{url:"api/analytics/rangecontentpertype",dataFn:function(){return{tenant_id:this._tenantId?this._tenantId:null,date00:this._fromDate,date01:this._toDate,metrics:["wedos","surveys","posts","media","questions","answers","ideations","wikipages","conferences"]}},parse:function(e){return this._format(e,["nb_wedos","nb_surveys","nb_posts","nb_media","nb_questions","nb_answers","nb_ideas","nb_wikipages","nb_conferences"])}}},rangecomments:{read:{url:"api/analytics/rangemetrics",dataFn:function(){return{community_id:this._communityId?this._communityId:null,tenant_id:this._tenantId?this._tenantId:null,date00:this._fromDate,date01:this._toDate,metrics:["postcomments","mediacomments","answercomments","ideationcomments","wikipagecomments"],merge:!0,as_admin:this._asAdmin}},parse:function(e){return this._format(e,["nb_post_comments","nb_media_comments","nb_answer_comments","nb_idea_comments","nb_wikipage_comments"])}}},rangecontent:{read:{url:"api/analytics/rangecontent",dataFn:function(){return{community_id:this._communityId,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(e){return this._format(e,["nb_content"])}}},rangereportabuses:{read:{url:"api/analytics/rangereportabuses",dataFn:function(){return{community_id:this._communityId?this._communityId:null,tenant_id:this._tenantId?this._tenantId:null,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(e){return this._format(e,["nb_report_abuses"])}}},rangecommunities:{read:{url:"api/analytics/rangecommunities",dataFn:function(){return{community_id:this._communityId?this._communityId:null,tenant_id:this._tenantId?this._tenantId:null,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(e){return this._format(e,["nb_communities","nb_directmessages"])}}}},defaults:{},init:function(t,i){var n=i.columnType;switch(n){case"rangeuservisits":case"rangeposts":case"rangemessages":case"rangecontents":case"rangecomments":case"rangecontent":case"rangereportabuses":case"rangecommunities":case"rangeconversations":this._services=this._servicesMode[n]}return this._communityId=i.communityId,this._tenantId=i.tenantId,this._fromDate=i.fromDate,this._toDate=i.toDate,this._title=i.title,e.is(i.asAdmin)&&(this._asAdmin=i.asAdmin),this._parent(t,i)},_format:function(t,n){var o,s,r={};if(0!==t.length)for(o in t)for(s=0;s<n.length;s++)e.is(t[o][n[s]])&&(e.is(r[n[s]])||(r[n[s]]={}),r[n[s]][o]=t[o][n[s]]);else for(o=i.getCurrentDate().split(" ")[0],s=0;s<n.length;s++)r[n[s]]={},r[n[s]][o]=0;return r},getTitle:function(){return this._title}})}),define("DS/SwymUICore/script/feature/core/experience/model/experience-model",["require","exports","UWA/Core","i18n!DS/SwymUICore/assets/nls/feature/core/generic-errors","DS/SwymUICore/script/lib/model/generic/swym-model","DS/UWPClientControls/PlatformNotify"],function(e,t,i,n,o,s){"use strict";return o.extend({_modelName:"experience",_attributesMapping:{},defaults:{description:"",date_end:"",date_begin:"",industry:"",place:"",not_finished:"0",title:"",work_name:""},_services:{create:{url:"api/Work/create"},update:{url:"api/Work/update",dataFn:function(){var e=i.clone(i.merge(this.getChanges(),this.toJSON()));return e.id=e.mid,e},paramsMapping:{mid:"id"}},delete:{url:"api/Work/delete",dataFn:function(){return{id:this.get("mid")}}}},validate:function(e,t){e=i.merge(this.getChanges(),this.toJSON());var o=[];this.hasVirtuallyChanged()||o.push(n.Nothingchanged),e.title&&/\S/.test(e.title)||o.push(n.titleError),e.work_name&&/\S/.test(e.work_name)||o.push(n.workError);var r=new Date(e.date_begin),a=new Date(e.date_end);if(r.getTime()>a.getTime()&&"0"===e.not_finished&&o.push(n.dateError),o.length>0)return s.error(o.join(", ")),o}})}),define("DS/SwymUICore/script/feature/core/skill/model/skill-model",["require","exports","UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model"],function(e,t,i,n){"use strict";return n.extend({_modelName:"skill",_services:{create:{url:"api/skill/create",dataFn:function(){return i.merge(this.getChanges(),this._attributes)}},update:{url:"api/skill/update",dataFn:function(e){return i.merge(this.getChanges(),this.getAttributes(["mid","title","description","level",{escapeHTML:!1}]))},paramsMapping:{mid:"id"}},delete:{url:"api/skill/delete",dataFn:function(){return{id:this.get("mid")}}}},defaults:{title:"",description:"",level:"1"},getLevelFromDBToJS:function(){var e=parseInt(this.get("level"));return 3!==e&&4!==e||e--,e},getStarsHtml:function(){for(var e="",t=this.getLevelFromDBToJS(),i=0;i<t;i++)e+='<span class="fonticon fonticon-2x active-blue fonticon-star"></span>';for(var n=0,o=3-t;n<o;n++)e+='<span class="fonticon fonticon-2x unactive-blue fonticon-star"></span>';return e}})}),define("DS/SwymUICore/script/feature/community/idea/model/collab-space-model",["DS/SwymUICore/script/lib/model/generic/swym-model"],function(e){"use strict";return e.extend({_modelName:"collab-space",defaults:{name:"",label:"",title:""}})}),define("DS/SwymUICore/script/feature/community/survey/collection/answer-collection",["DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/community/survey/model/answer-model"],function(e,t){return e.extend({_associations:{question:{}},model:t,modes:["answers"],getTotalVotes:function(){for(var e=0,t=0,i=this._models.length;t<i;t++)e+=parseInt(this._models[t].get("nbVotes"),10);return e}})}),define("DS/SwymUICore/script/feature/community/survey/model/question-model",["DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/survey/collection/answer-collection","DS/SwymUICore/script/feature/community/survey/model/answer-model","i18n!DS/SwymUICore/assets/nls/lib/model/generic/community-content"],function(e,t,i,n){return exports=e.extend({_modelName:"question-survey",_hasAnOpenAnswerAdded:!1,_associations:{survey:{},answers:{Class:t,oppositeRole:"question"}},HTML_ATTRIBUTES:["description"],addAnswer:function(e){var t=new i(e),n=this.getAssociated("answers").length;return this._hasAnOpenAnswerAdded?this.getAssociated("answers").add(t,{at:n-1}):this.getAssociated("answers").add(t),t},hasAnOpenAnswerAdded:function(){return this._hasAnOpenAnswerAdded},addAnswerIsOpen:function(){var e=new i({is_open:"1",description:n.Other,position:"1"});return this._hasAnOpenAnswerAdded=!0,this.getAssociated("answers").push(e),e},removeAnswerIsOpen:function(){this._hasAnOpenAnswerAdded=!1,this.getAssociated("answers").pop()}}),exports}),define("DS/SwymUICore/script/feature/core/skill/collection/skill-collection",["require","exports","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/core/skill/model/skill-model"],function(e,t,i,n){"use strict";return i.extend({_collectionName:"skill-collection",model:n,_associations:{user:{}}})});__extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/SwymUICore/script/feature/core/group/model/group-model",["require","exports","DS/SwymUICore/script/lib/model/generic/swym-model"],function(e,t,i){"use strict";var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(i);return n.prototype._modelName="group",n}),define("DS/SwymUICore/script/feature/core/group/collection/group-collection",["DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/core/group/model/group-model","DS/WebappsUtils/Console"],function(e,t,i){"use strict";return e.extend({_associations:{currentUser:{oppositeRole:"groups",options:{mode:""}}},_services:{read:{getnetworkgroupsbyuser:{url:"api/networkgroup/getnetworkgroupsbyuser",dataFn:function(e){return{hash_key:this.getAssociated("currentUser").get("hash_key")}}}}},_collectionName:"group-collection",model:t,modes:["getnetworkgroupsbyuser"],init:function(e,t){try{return this._parent(e,t)}catch(e){return void i.error("Error initializing collection: "+e.message)}},getIdGroupProfessional:function(){var e=this.findWhere({name:"connections"});return e?e.get("mid"):null}})}),define("DS/SwymUICore/script/feature/community/social-event/collection/takeaway-collection",["require","exports","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/community/social-event/model/takeaway-model"],function(e,t,i,n){"use strict";return i.extend({model:n,modes:["takeaways"],setup:function(e,t){return this.addEvent("onTakeawayRemove",this.removeTakeaway,this),this._parent(e,t)},removeTakeaway:function(e){this.length>0&&(this.remove(e),this.forEach(function(e,t){e.set("position",t+1)}))}})}),define("DS/SwymUICore/script/feature/core/tenant/model/users-process-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model"],function(e,t){"use strict";return t.extend({_modelName:"users-process",_asAdmin:!1,_services:{getResults:{url:"api/member/getprocessresults",dataFn:function(t){var i;return i=t&&e.is(t.asAdmin)?t.asAdmin:this._asAdmin,{id:this.get("real_id"),start:0,limit:this._limit||999,as_admin:i}}},deleteProcess:{url:"api/member/deleteprocess",dataFn:function(t){var i;return i=t&&e.is(t.asAdmin)?t.asAdmin:this._asAdmin,{process_id:this.get("real_id"),process_type:t.processType,as_admin:i}}}},defaults:{processName:"",type:"",userStatus:"",details:[0,0]},getResults:function(e){return this.action("getResults",e)},deleteProcess:function(e){return this.action("deleteProcess",e)},setup:function(e,t){this._parent.apply(this,arguments),t&&t.asAdmin&&(this._asAdmin=t.asAdmin)}})}),define("DS/SwymUICore/script/feature/core/language/model/language-model",["require","exports","UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model"],function(e,t,i,n){"use strict";return n.extend({_modelName:"language",_services:{create:{url:"api/SpokenLanguage/create",dataFn:function(){return i.merge(this.getChanges(),this._attributes)}},update:{url:"api/SpokenLanguage/update",dataFn:function(){return i.merge(this.getChanges(),this.getAttributes(["mid","language_id","description","level"],{escapeHTML:!1}))},paramsMapping:{mid:"id"}},delete:{url:"api/SpokenLanguage/delete",dataFn:function(){return{id:this.get("mid")}}}},defaults:{language_id:"af",description:"",level:"1",lang_english:"Afrikaans",lang_native:"Afrikaans",iso_code:"af"},getLevelFromDBToJS:function(){var e=parseInt(this.get("level"));return 3!==e&&4!==e||e--,e},getStarsHtml:function(){for(var e="",t=this.getLevelFromDBToJS(),i=0;i<t;i++)e+='<span class="fonticon fonticon-2x active-blue fonticon-star"></span>';for(var n=0,o=3-t;n<o;n++)e+='<span class="fonticon fonticon-2x unactive-blue fonticon-star"></span>';return e}})}),define("DS/SwymUICore/script/lib/view/generic/swym-model-view",["require","exports","UWA/Core","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/lib/model/generic/swym-model","DS/Logger/Logger"],function(e,t,i,n,o,s){"use strict";var r=n.extend({_modelEvents:null,_modelClass:null,model:null,name:null,_checkModel:function(e,t){return this._checkInstance(e,t||this._modelClass)},init:function(e){return e instanceof o?e={model:e}:e||(e={}),this._modelEvents||(this._modelEvents={}),this._modelEventsForAutoRefresh||(this._modelEventsForAutoRefresh=[]),this._parent.call(this,e)},addModelEventsForAutoRefresh:function(e){if(e){if(!0===i.is(e,"array"))[].concat(e).forEach(function(e,t,i){this._modelEventsForAutoRefresh.indexOf(e)>=0&&i.splice(t,1)},this),this._modelEventsForAutoRefresh=this._modelEventsForAutoRefresh.concat(e);else!0===i.is(e,"string")&&this._modelEventsForAutoRefresh.indexOf(e)<0&&this._modelEventsForAutoRefresh.push(e);this.reactTo(this.model,e,"refresh")}return this},reactToModelEvents:function(e){var t;if(e)for(var i in e)if(e.hasOwnProperty(i)){if("string"==typeof(t=e[i])&&"function"==typeof this[t]&&(t=this[t]),"function"!=typeof t){s.error("Specified listener is not valid");break}this.reactTo(this.model,i,t)}},setModel:function(e,t){var n,s;(n=i.is(t,"object")?i.extend({},t):{})._initializing&&this.model&&(e||(e=this.model),this.model=null);var r=n.roleToTrack,a=this._modelEvents,c=!1!==n.refresh;if(!1!==n.checkModel&&(e=this._checkModel(e)),this.model){if(!0===this.model.equals(e))return this;this.stopReactingTo(this.model)}else if(!(e instanceof o))throw new Error("Provided model is invalid!");return s=this.model,this.model=e,this.reactTo(this.model,this._modelEventsForAutoRefresh,"refresh"),r&&r.name&&r.associated&&this.reactTo(this.model,"onReplace:"+r.name,function(e,t,i){this.model.equals(e)&&i.equals(r.associated)&&this.setModel(t)}),this.reactToModelEvents(a),this.dispatchEvent("onSetModel",[this,s,this.model]),!1!==c&&this._rendered&&this.refresh(),this},setup:function(e){return this._parent.apply(this,arguments),e||(e={}),e.hasOwnProperty("modelEvents")&&(this._modelEvents=e.modelEvents),e.hasOwnProperty("modelEventsForAutoRefresh")?this._modelEventsForAutoRefresh=e.modelEventsForAutoRefresh:this._modelEventsForAutoRefresh=i.clone(this._modelEventsForAutoRefresh,!1),(e.model||this.model&&!0===e._initializing)&&this.setModel(e.model,{refresh:e.hasOwnProperty("refresh")?e.refresh:!e._initializing,_initializing:e._initializing}),this},createAttributeView:function(e,t,n){var o;if(i.is(e,"string")&&i.is(t,"string")){if("function"==typeof n)o=r.extend({_modelClass:this._modelClass,_createContent:n});else if(i.is(n,"object"))o=r.extend(i.merge({_modelClass:this._modelClass},n));else{if(!(n instanceof r))throw new Error("Error creating attribute view: Invalid arguments");o=n}return this.addChildView(e,{Class:o,widget:this._widget,model:this.model}).addModelEventsForAutoRefresh("onChange:"+t)}throw new Error("Error creating attribute view: Either the view name or the name of concerned attribute is not available")},destroy:function(){return this.model=null,this._modelEventsForAutoRefresh=null,this._modelEvents=null,this.refresh=null,this._parent.apply(this,arguments)}});return r}),define("DS/SwymUICore/script/feature/core/user/model/bot-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/member/model/mixin/community-member","DS/Logger/Logger"],function(e,t,i,n){"use strict";return t.extend(i,{_modelName:"bot",getModelIdAttribute:function(){return"uri"}})}),define("DS/SwymUICore/script/feature/core/experience/collection/experience-collection",["require","exports","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/core/experience/model/experience-model"],function(e,t,i,n){"use strict";return i.extend({_services:{read:{experience:{url:"api/user/getworksbyhashkey",dataFn:function(e){return{hash_key:e.hash_key}}}}},_collectionName:"experience-collection",comparator:function(e,t){var i=0,n=new Date(e.get("date_begin")).getTime(),o=new Date(e.get("date_end")).getTime(),s=new Date(t.get("date_begin")).getTime(),r=new Date(t.get("date_end")).getTime();return n>s?i=-1:n<s?i=1:n===s&&(o>r?i=-1:o<r?i=1:o===r&&(i=0)),n||o||(i=-1),s||r||(i=1),i},model:n,modes:["experience"],_associations:{user:{}},onSync:function(){this.sort()},onAdd:function(){this.sort()}})}),define("DS/SwymUICore/script/feature/core/language/collection/language-collection",["require","exports","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/core/language/model/language-model"],function(e,t,i,n){"use strict";return i.extend({_collectionName:"language-collection",model:n,modes:["getlanglist"],_associations:{user:{}}})}),define("DS/SwymUICore/script/feature/core/stats/model/table-model",["UWA/Core","i18n!DS/SwymUICore/assets/nls/feature/core/stats/model/table-model","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/utils/date","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/WebappsUtils/Console"],function(e,t,i,n,o,s){return i.extend({_modelName:"table",_communityId:null,_tenantId:null,_fromDate:null,_toDate:null,_title:null,_asAdmin:!1,_attributesMapping:{},_servicesMode:{communityinfo:{read:{url:"api/analytics/infocommunity",dataFn:function(){return{community_id:this._communityId,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(e){return this.format(e)}}},mostviewedposts:{read:{url:"api/analytics/mostviewedposts",dataFn:function(){return{community_id:this._communityId,tenant_id:this._tenantId,date00:this._fromDate,date01:this._toDate,max_items:5,as_admin:this._asAdmin}},parse:function(e){return this.formatTitle(e,"Read")}}},mostendorsedposts:{read:{url:"api/analytics/mostendorsedposts",dataFn:function(){return{community_id:this._communityId,tenant_id:this._tenantId,date00:this._fromDate,date01:this._toDate,max_items:5,as_admin:this._asAdmin}},parse:function(e){return this.formatTitle(e,"Endorsed")}}},mostreadcontributors:{read:{url:"api/analytics/mostreadcontributors",dataFn:function(){return{community_id:this._communityId,tenant_id:this._tenantId,date00:this._fromDate,date01:this._toDate,max_items:5,as_admin:this._asAdmin}},parse:function(e){return this.formatNickname(e,"Visited")}}},mostcommentedposts:{read:{url:"api/analytics/mostcommentedposts",dataFn:function(){return{community_id:this._communityId,date00:this._fromDate,date01:this._toDate,max_items:5,as_admin:this._asAdmin}},parse:function(e){return this.formatTitle(e,"Commented")}}}},defaults:{},init:function(t,i){var n=i.tableType;switch(n){case"communityinfo":case"mostviewedposts":case"mostendorsedposts":case"mostreadcontributors":case"mostcommentedposts":this._services=this._servicesMode[n]}return this._communityId=i.communityId,this._tenantId=i.tenantId,this._fromDate=i.fromDate,this._toDate=i.toDate,this._title=i.title,e.is(i.asAdmin)&&(this._asAdmin=i.asAdmin),this._parent(t,i)},format:function(e){var i={};if(Object.keys(e).length>0)for(var o in e.avgPostEndorsements=(Math.round(e.nb_post_endorsements/e.nb_posts*100)/100).toString(),e.avgPostComments=(Math.round(e.nb_post_comments/e.nb_posts*100)/100).toString(),e)["nb_messages","nb_endorsed_posts","nb_commented_posts","avgPostComments","avgPostEndorsements"].indexOf(o)>-1?i[t[o]]=e[o]&&"NaN"!==e[o]?e[o].toString():"-":"avg_time_answer_question"===o&&(i[t[o]]=e[o]?n.getAverageElapsedTime(e[o]):"-");else i[t.nb_posts]="-",i[t.nb_commented_posts]="-",i[t.nb_endorsed_posts]="-",i[t.avgPostEndorsements]="-",i[t.avgPostComments]="-",i[t.nb_questions]="-",i[t.avg_time_answer_question]="-";return i},formatTitle:function(e,i){var n={};if(e.length>0)for(var o=0;o<e.length;o++)n[e[o].title]=t[i]+" "+e[o].counter+" "+t.Times;else n[""]="-";return n},formatNickname:function(e,i){var n={};if(e.length>0)for(var o=0;o<e.length;o++)nickname=e[o].first_name+" "+e[o].last_name,n[nickname]={login:e[o].login,counter:t[i]+" "+e[o].counter+" "+t.Times};else n[""]="-";return n},getTitle:function(){return this._title}})}),define("DS/SwymUICore/script/feature/core/user/model/users-group-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/member/model/mixin/community-member","DS/Logger/Logger"],function(e,t,i,n){"use strict";return t.extend(i,{_modelName:"users-group",_modelIdAttribute:"subject6wuri",_attributesMapping:{id:"id",id:"mid",resourceid:"subject6wuri",uri:"subject6wuri"},defaults:{subject6wuri:void 0,name:"",nb_members:-1},_updateIdAttribute:function(e){return e}})}),define("DS/SwymUICore/script/feature/core/interest/model/interest-model",["require","exports","UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model"],function(e,t,i,n){"use strict";return n.extend({_modelName:"interest",_services:{create:{url:"api/interest/create",dataFn:function(){return i.merge(this.getChanges(),this._attributes)}},update:{url:"api/interest/update",dataFn:function(){return i.merge(this.getChanges(),this.getAttributes(["mid","title","description"],{escapeHTML:!1}))},paramsMapping:{mid:"id"}},delete:{url:"api/interest/delete",dataFn:function(){return{id:this.get("mid")}}}},defaults:{title:"",description:""}})}),define("DS/SwymUICore/script/feature/community/survey/collection/question-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/community/survey/model/question-model","DS/WebappsUtils/Console"],function(e,t,i,n){return t.extend({model:i,modes:["questions"],_associations:{survey:{}},setup:function(e,t){t.questions&&(this.questions=t.questions)},moveUp:function(e){var t=this.indexOf(e);t>0&&(this.remove(e,{silent:!0}),this.add(e,{at:t-1}),this.forEach(function(e,t){e.set("position",t+1)}))},moveDown:function(e){var t=this.indexOf(e);t<this.length&&(this.remove(e,{silent:!0}),this.add(e,{at:t+1}),this.forEach(function(e,t){e.set("position",t+1)}))}})}),define("DS/SwymUICore/script/feature/core/interest/collection/interest-collection",["require","exports","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/core/interest/model/interest-model"],function(e,t,i,n){"use strict";return i.extend({_collectionName:"interest-collection",model:n,_associations:{user:{}}})}),define("DS/SwymUICore/script/feature/community/wedo/model/attachment-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model"],function(e,t){"use strict";return t.extend({_modelName:"attachment",_modelIdAttribute:"id",_attributesMapping:{id:"id","@id":"id","dscom:ServiceHosting":"serviceHosting"},_associations:{},_services:{},defaults:{},isUploading:function(){return!1},isNew:function(){return!1}})}),define("DS/SwymUICore/script/feature/core/stats/model/pie-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/WebappsUtils/Console"],function(e,t,i){return t.extend({_modelName:"pie",_communityId:null,_tenantId:null,_fromDate:null,_toDate:null,_title:null,_asAdmin:!1,_attributesMapping:{},_servicesMode:{totalinteractions:{read:{url:"api/analytics/totalinteractions",dataFn:function(){return{community_id:this._communityId,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(e){var t={nb_ideas:e.nb_ideas,nb_media:e.nb_media,nb_posts:e.nb_posts,nb_questions:e.nb_questions,nb_surveys:e.nb_surveys,nb_wikipages:e.nb_wikipages,nb_wedos:e.nb_wedos,nb_conferences:e.nb_conferences};return this._format(t)}}},totalmediapertype:{read:{url:"api/analytics/totalmediapertype",dataFn:function(){return{community_id:this._communityId?this._communityId:null,tenant_id:this._tenantId?this._tenantId:null,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(e){return this._format(e)}}},totalusersperrole:{read:{url:"api/analytics/totalusersperrole",dataFn:function(){return{community_id:this._communityId?this._communityId:null,tenant_id:this._tenantId?this._tenantId:null,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(e){return this._format(e)}}},totalquestionsperstatus:{read:{url:"api/analytics/totalquestionsperstatus",dataFn:function(){return{community_id:this._communityId?this._communityId:null,tenant_id:this._tenantId?this._tenantId:null,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(e){return this._format(e)}}},totalcommunitiespertype:{read:{url:"api/analytics/totalcommunitiespertype",dataFn:function(){return{tenant_id:this._tenantId,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(e){return this._format(e)}}},totalcommunitiespervisibility:{read:{url:"api/analytics/totalcommunitiespervisibility",dataFn:function(){return{tenant_id:this._tenantId,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(e){return this._format(e)}}},totalpollsperstatus:{read:{url:"api/analytics/totalpollsperstatus",dataFn:function(){return{tenant_id:this._tenantId,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(e){return this._format(e)}}}},defaults:{},init:function(t,i){var n=i.pieType;switch(n){case"totalinteractions":case"totalmediapertype":case"totalusersperrole":case"totalquestionsperstatus":case"totalcommunitiespertype":case"totalcommunitiespervisibility":case"totalpollsperstatus":this._services=this._servicesMode[n]}return this._communityId=i.communityId,this._tenantId=i.tenantId,this._fromDate=i.fromDate,this._toDate=i.toDate,this._title=i.title,e.is(i.asAdmin)&&(this._asAdmin=i.asAdmin),this._parent(t,i)},_format:function(e){var t={};for(var i in e)t[i]=parseInt(e[i]);return t},getTitle:function(){return this._title}})}),define("DS/SwymUICore/script/feature/community/wedo/collection/attachment-collection",["UWA/Core","UWA/Json","UWA/Array","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/wedo/model/attachment-model","DS/SwymUICore/script/lib/collection/generic/swym-collection"],function(e,t,i,n,o,s,r){"use strict";var a=n.getInstance();return r.extend({_collectionName:"attachment-collection",_cloneOfCollection:null,hasBeenFetchedAtLeastOnce:!1,model:s,_getQuery:function(e){return"[ds6w:resourceUid]:("+this.map(function(e){return'"'+(e.get("id")||e.get("resourceid"))+'"'}).join(" BOR ")+")"},modes:["searchBySubjectUri"],_services:{read:{searchBySubjectUri:{method:"POST",url:"search",noCsrfToken:!0,wrapData:!1,dataFn:function(){return{source:["swym"],tenant:a.get("config").tenant.online_instance_id,start:0,select_predicate:["ds6w:type"],label:"3DSwym-"+a.get("user").login+"-"+(new Date).getTime(),query:this._getQuery(),with_synthesis_attribute:!1,with_synthesis:!1}},parse:function(e){return i.isArray(e&&e.results)?e.results.reduce(function(e,t){var i={};return t.attributes.forEach(function(e){i[e.name]=e.value}),e.push(i),e},[]):[]}}}},sync:function(){var e=this,t=arguments,i=this._parent;if("searchBySubjectUri"!==e.mode)return this.urlRoot="",i.apply(e,t);require(["DS/SwymUICore/script/utils/compass-proxy"],function(n){n.getServiceUrl({serviceName:"3DSearch",platformId:a.get("config").tenant.online_instance_id,onComplete:function(n){if(n&&"string"==typeof n)return e.urlRoot=n,i.apply(e,t);throw new Error("Fedsearch server could not be found!")},onFailure:function(){throw new Error("Fedsearch server could not be found!")}})})},fetchDataFromFederatedSearch:function(){this.hasBeenFetchedAtLeastOnce||(this.hasBeenFetchedAtLeastOnce=!0,this._cloneOfCollection=this.clone(),this.setMode("searchBySubjectUri"),this.fetch({onComplete:function(e){var t=this._cloneOfCollection.length-e.length;t>0&&this._cloneOfCollection.forEach(function(t){e.findWhere({resourceid:t.get("id")})||e.push(t)}),this._cloneOfCollection=null}.bind(this)}))}})}),define("DS/SwymUICore/script/feature/core/user/model/user-group-utils",["require","exports","DS/WAFData/WAFData","DS/SwymUICore/script/utils/platform-utils","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/localstorage-manager","DS/SwymUICore/script/utils/utils"],function(e,t,i,n,o,s,r){"use strict";var a=null,c=function(e,t,o,r,c){n.getFedsearchURL(c).then(function(n){i.authenticatedRequest(n+"/search",{method:"POST",headers:{"Content-Type":"application/json"},type:"json",data:JSON.stringify({with_synthesis:!1,with_nls:!1,label:o,select_predicate:["ds6w:hasMember"],with_synthesis_hierarchical:!1,query:'[ds6w:type]:"foaf:Group" AND [ds6w:label]:"'+r+'"',source:["usersgroup"],tenant:c}),onComplete:function(t){var i=!1,n=t.results;i=!!Array.isArray(n)&&n.some(function(e){return e&&e.attributes&&e.attributes.some(function(e){return"ds6w:hasMember"===e.name&&e.value===o})});var c=a&&a.find(function(e){return e.name===r});if(c)c.isMember=i,c.cacheDate=(new Date).toISOString();else{var u={name:r,isMember:i,cacheDate:(new Date).toISOString()};a.push(u)}s.setPrefixedItem("feature-groups",a,{tenant:!0}),e(i)},onFailure:function(e){t(e)}})})};return{isMember:function(e,t){var i=o.getInstance().get("config").tenant.online_instance_id;if(r.isCloud()){a=s.getPrefixedItem("feature-groups",{tenant:!0})||[];var n=(a=s.getPrefixedItem("feature-groups",{tenant:!0})||[])&&a.find(function(e){return e.name===t});return new Promise(function(o,s){if(n){var r=new Date(n.cacheDate);Math.abs(Date.now()-r.getTime())/36e5>48?c(o,s,e,t,i):o(n.isMember)}else c(o,s,e,t,i)})}return new Promise(function(e,t){e(!1)})},isUserGroupAvailable:function(e){var t=o.getInstance().get("config").tenant.online_instance_id;return r.isCloud()?new Promise(function(o,s){!function(e,t,o,s){n.getFedsearchURL(s).then(function(n){i.authenticatedRequest(n+"/search",{method:"POST",headers:{"Content-Type":"application/json"},type:"json",data:JSON.stringify({with_synthesis:!1,with_nls:!1,label:o,with_synthesis_hierarchical:!1,query:'[ds6w:type]:"foaf:Group" AND [ds6w:label]:"'+o+'"',source:["usersgroup"],tenant:s}),onComplete:function(t){var i=!1,n=t.results;i=!!Array.isArray(n)&&n.some(function(e){return e&&e.attributes&&e.attributes.some(function(e){return"ds6w:label"===e.name&&e.value===o})}),e(i)},onFailure:function(e){t(e)}})})}(o,s,e,t)}):new Promise(function(e,t){e(!1)})}}}),define("DS/SwymUICore/script/feature/core/favorite-communities/model/favorite-communities-model",["DS/SwymUICore/script/lib/model/generic/swym-model"],function(e){"use strict";var t={},i=e.extend({_modelName:"favorite-communities",_services:{create:{url:"api/user/favorites",wrapData:!1,method:"POST",dataFn:function(e){return{blob:JSON.stringify({favoriteCommunities:this.get("favoriteCommunities")})}},parse:function(e){return e}},read:{url:"api/user/favorites",method:"GET",parse:function(e){try{return JSON.parse(e.blob)}catch(e){return{}}}},update:{url:"api/user/favorites",wrapData:!1,dataType:"json",method:"POST",dataFn:function(e){return this},parse:function(e){return this}},delete:{url:"api/user/favorites",method:"POST"}},defaults:{favoriteCommunities:{list:[]}},get:function(e,t){return this._parent.apply(this,[e,t])}}),n=null;return t.getInstance=function(){return null===n&&(n=new i),n},t.resetInstance=function(){n&&(n=null)},t}),define("DS/SwymUICore/script/feature/community/social-event/collection/pres-support-collection",["DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/community/social-event/model/pres-support-model"],function(e,t){return e.extend({model:t,modes:["presentationSupports"],setup:function(e,t){return this.addEvent("onPresentationSupportRemove",this.removePres,this),this._parent(e,t)},removePres:function(e){this.remove(e)},_getAllItemsIds:function(){let e=[];return this.forEach(t=>{e.push(t.get("id"))}),e},buildFedSearchQuery:function(){let e=this._getAllItemsIds();return(e=e.map(e=>`[ds6w:resourceUid]:"${e}"`)).join(" OR ")}})}),define("DS/SwymUICore/script/feature/community/idea/collection/collab-space-collection",["DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/community/idea/model/collab-space-model","DS/SwymUICore/script/utils/utils"],function(e,t,i){"use strict";return e.extend({_collectionName:"collab-space-collection",model:t,mode:"default",modes:["default"],_serviceURI:null,_3dspaceURL:null,_type:null,_services:{read:{default:{urlFn:function(){return this._3dspaceURL+"/"+this._serviceURI+"/collabspace?type="+this._type},method:"GET",type:"json",noCsrfToken:!0,headers:{"Content-Type":"application/json; charset=utf-8",Accept:"application/json, text/javascript, */*"},parse:function(e){var t=[];return e.results&&e.results.length>0&&e.results.forEach(function(e,i){t.push({selected:0===i,label:e.label,name:e.name,title:e.title})}),t}}}},setup:function(e,t){if(!t.type)throw"A type is required";if(this._type=t.type,!t.serviceURI)throw"A serviceURI is required";if(this._serviceURI=t.serviceURI,!t.threeDSpaceUrl)throw"A threeDSpaceUrl is required";this._3dspaceURL=t.threeDSpaceUrl,this._parent.apply(this,arguments)}})}),define("DS/SwymUICore/script/feature/core/command/commands-controller",["UWA/Core","UWA/Utils","UWA/Data","UWA/String","UWA/Promise","DS/WAFData/WAFData","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/utils","UWA/Class/Events"],function(e,t,i,n,o,s,r,a,c,u){"use strict";return u.extend({_commandsConfInitialized:!1,_commandsConf:{},_botsConf:[],_appsParameters:{},_swymServiceUrl:null,_nlsIsLoaded:!1,_nlsArrayModule:[],_nls:[],_activate3DSwymBot:c.isFeatureActivated("activateSwymBot"),executeWhenNlsIsReady:function(e){this._nlsIsLoaded?e.apply(this):this.addEventOnce("onNlsSync",e)},_getPromiseRetrieveAllApps:function(){var e=[];return new o(function(t,i){r.getAppsInfo({onComplete:function(n){n.forEach(function(t){(t.swymIntegration&&"X3DMCTY_AP"!==t.id||"X3DMCTY_AP"===t.id&&!0===this._activate3DSwymBot)&&(this._appsParameters[t.id]=t,e.push(this._getPromiseForAnApp(t)))}.bind(this)),o.all(e).then(function(){this._initRetrieveNlsFiles(),t()}.bind(this),i)}.bind(this),onFailure:i})}.bind(this))},_getPromiseGettingSwymURLService:function(){var e=a.getInstance();return new o(function(t,i){r.getServiceUrl({platformId:e.get("config").tenant.online_instance_id,serviceName:"3DSwym",onComplete:function(e){this._commandsConfInitialized=!0,this._swymServiceUrl=e,t()}.bind(this),onFailure:function(){console.error("3DCompass call failed"),i()}})}.bind(this))},_getPromiseForAnApp:function(e){var t;return new o(function(n,o){this._getServiceUrl(e.serviceId,function(o){i.request(o+"/"+e.swymIntegration,{type:"json",onFailure:function(){console.error("Failed retrieving swymIntegration conf for app app.id"),n()},onComplete:function(i){i.nlsModulePath&&this._nlsArrayModule.push({moduleName:i.nlsModulePath,appId:e.id}),this._botsConf.push({desc:i.desc,botUsername:i.botUsername.toLowerCase(),appName:e.title,appId:e.id,appIconURL:e.icon}),(t=i.commands)?t.forEach(function(t){this._commandsConf[t.name]||(this._commandsConf[t.name]=[]),this._commandsConf[t.name].push({appId:e.id,botUsername:i.botUsername.toLowerCase(),serviceName:e.serviceId,desc:t.desc,appName:e.title,appIconURL:e.icon,uri:t.uri})}.bind(this)):console.error("no commands defined for app",e.id),n()}.bind(this)})}.bind(this))}.bind(this))},_getCommands:function(e){!0===this._commandsConfInitialized?e(this._commandsConf,this._botsConf):o.all([this._getPromiseGettingSwymURLService(),this._getPromiseRetrieveAllApps()]).then(function(){e(this._commandsConf,this._botsConf)}.bind(this),function(){console.error("At least one call failed to retrieve all confs for the bots")})},_getServiceUrl:function(e,t){var i=a.getInstance();r.getPlatformServices({platformId:i.get("config").tenant.online_instance_id,onComplete:function(i){Object.keys(i).length;var n=!1;Object.keys(i).forEach(function(o,s){o.toLowerCase()===e.toLowerCase()&&(n=!0,t(i[o]))}),!1===n&&t(null)}.bind(this),onFailure:function(){console.error("3DCompass call failed")}})},_getNlsCallPromise:function(e){return new o(function(t,i){require([e.moduleName],function(i){i&&(this._nls[e.appId]=i),t()}.bind(this),function(){console.error("Failed retrieving the following NLs Json Module for Bots",e.moduleName),t()})}.bind(this))},getNlsValue:function(e,t){var i="",n=this._nls[e];return"string"==typeof t?i=t:t.nlsKey&&n&&(i=t.data?n.replace(t.nlsKey,t.data):n.get(t.nlsKey)),i},getFastNlsForOneApp:function(e,t){var n=this._nls[e];n?t(n):r.getAppsInfo({data:[e],onComplete:function(e){var n=e&&e[0];n&&this._getServiceUrl(n.serviceId,function(e){i.request(e+"/"+n.swymIntegration,{type:"json",onFailure:function(){console.error("Failed retrieving swymIntegration conf for app app.id"),t()},onComplete:function(e){e.nlsModulePath?require([e.nlsModulePath],function(i){i&&(this._nls[e.appId]=i,t(i))}.bind(this),function(){console.error("Failed retrieving the following NLs Json Module for Bots",e.nlsModulePath),t()}):(console.error("No nls module Path defined"),t())}.bind(this)})}.bind(this))}.bind(this),onFailure:function(){console.error("failed retrieving app info through my apps service"),t()}})},_initRetrieveNlsFiles:function(){var e=[];this._nlsArrayModule.forEach(function(t){e.push(this._getNlsCallPromise(t))}.bind(this)),o.all(e).then(function(){this._nlsIsLoaded=!0,this.dispatchEvent("onNlsSync",[this])}.bind(this))},_getCommandFromHtmlStringIfExist:function(e,t){this._getCommands(function(){var i=null,o=new RegExp("/(.*?) "),s=n.unescapeHTML(e),r=s.match(o);r&&r[0]&&r[1]&&(i=this._commandsConf[r[1]]&&this._commandsConf[r[1]][0])&&(i.command_input=s.replace(r[0],""),i.commandName=r[1]),t(i)}.bind(this))},executePrimaryCommandIfInputMatched:function(e){this._getCommandFromHtmlStringIfExist(e.content,function(t){t&&this._getServiceUrl(t.serviceName,function(i){this._callCommand(i+t.uri,{app_id:t.appId,channel_id:e.community_id,channel_name:e.channel_name,channel_type:e.isDMContext?"dm":"community",command:t.commandName,command_input:t.command_input,"3dswym_service":this._swymServiceUrl})}.bind(this))}.bind(this))},executeSecondaryCommand:function(e){this._getCommands(function(){this._getServiceUrl(this._appsParameters[e.app_id].serviceId,function(t){this._callCommand(t+e.uri,{app_id:e.app_id,channel_id:e.channel_id,channel_type:e.channel_type,channel_name:e.channel_name,command:e.command,command_params:e.options,command_input:"",message_id:e.message_id,"3dswym_service":this._swymServiceUrl})}.bind(this))}.bind(this))},_callCommand:function(e,t){s.authenticatedRequest(e,{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},data:JSON.stringify(t),onFailure:function(e){},onComplete:function(e){}})}}).singleton()});__extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/SwymUICore/script/feature/core/link/model/link-model",["require","exports","UWA/Core","i18n!DS/SwymUICore/assets/nls/feature/core/link/model/link-model","DS/SwymUICore/script/lib/model/generic/swym-model","DS/UWPClientControls/PlatformNotify"],function(e,t,i,n,o,s){"use strict";var r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._services={create:{url:"api/Link/add"},update:{url:"api/Link/update",dataFn:function(){var e=i.clone(i.merge(this.getChanges(),this.toJSON()));return e.id=e.mid,e},paramsMapping:{mid:"id"}},delete:{url:"api/Link/delete",dataFn:function(){return{id:this.get("mid")}}}},t._socialDomains=["facebook.com","plus.google.com","twitter.com","linkedin.com"],t._socialMappingFonticons={"youtube.com":"video","facebook.com":"facebook","plus.google.com":"gplus","twitter.com":"twitter","pinterest.com":"pinterest","linkedin.com":"linkedin","github.com":"github","vimeo.com":"vimeo","flickr.com":"flickr","tumblr.com":"tumblr"},t._typeMapping={"facebook.com":"1","linkedin.com":"2","youtube.com":"4","flickr.com":"6","plus.google.com":"7","twitter.com":"8"},t}return __extends(t,e),t.prototype.getTypeFromUrl=function(){for(var e,t=null,i=this.getChanges("url")||this.get("url"),n=this._socialDomains.length,o=0;o<n;o++)if(e=this._socialDomains[o],i.indexOf(e)>-1){t=this._typeMapping[e];break}return t},t.prototype.getIconName=function(){var e=null;if(!0===this.isSocialLink())if(["1","2","4","6","7","8"].indexOf(this.getChanges("type")||this.get("type"))>-1)switch(this.getChanges("type")||this.get("type")){case"1":e="facebook";break;case"2":e="linkedin";break;case"4":e="video";break;case"6":e="flickr";break;case"7":e="gplus";break;case"8":e="twitter"}else for(var t,i=this.getChanges("url")||this.get("url"),n=this._socialDomains.length,o=0;o<n;o++)if(t=this._socialDomains[o],i.indexOf(t)>-1){e=this._socialMappingFonticons[t];break}return e},t.prototype.isSocialUrl=function(){for(var e,t=!1,i=this.getChanges("url")||this.get("url"),n=this._socialDomains.length,o=0;o<n;o++)if(e=this._socialDomains[o],i.indexOf(e)>-1){t=!0;break}return t},t.prototype.isSocialLink=function(){return["1","2","6","7","8"].indexOf(this.getChanges("type")||this.get("type"))>-1||this.isSocialUrl()},t.prototype.validate=function(e){e=i.merge(this.getChanges(null),this.toJSON());var t=[];if(this.hasVirtuallyChanged(null)||t.push(n.nothinghaschanged),e.url&&/\S/.test(e.url)||t.push(n.titleNotSpecified),e.type&&/\S/.test(e.type)||t.push(n.pleaseSelect),t.length>0)return s.error(t.join(", ")),t},t}(o);return r.prototype.defaults={description:"",title:"",type:"",url:""},r.prototype._modelName="link",r}),define("DS/SwymUICore/script/feature/community/idea/model/enovia-object-attributes-model",["DS/SwymUICore/script/lib/model/generic/swym-model"],function(e){"use strict";return e.extend({_modelName:"enovia-object-attributes",defaults:{name:"",label:"",type:"",options:null}})}),define("DS/SwymUICore/script/feature/core/education/model/education-model",["require","exports","UWA/Core","i18n!DS/SwymUICore/assets/nls/feature/core/generic-errors","DS/SwymUICore/script/lib/model/generic/swym-model","DS/UWPClientControls/PlatformNotify"],function(e,t,i,n,o,s){"use strict";return o.extend({_modelName:"education",_attributesMapping:{},defaults:{description:"",date_end:"",date_begin:"",degree:"",field_of_study:"",not_finished:"0",place:"",school_name:""},_services:{create:{url:"api/Education/create",dataFn:function(){return this.getChanges()}},update:{url:"api/Education/update",dataFn:function(){var e=i.clone(i.merge(this.getChanges(),this.toJSON()));return e.id=e.mid,e},paramsMapping:{mid:"id"}},delete:{url:"api/Education/delete",dataFn:function(){return{id:this.get("mid")}}}},validate:function(e,t){e=i.merge(this.getChanges(),this.toJSON());var o=[];this.hasVirtuallyChanged()||o.push(n.Nothingchanged),e.school_name&&/\S/.test(e.school_name)||o.push(n.schoolError),e.field_of_study&&/\S/.test(e.field_of_study)||o.push(n.fieldError);var r=new Date(e.date_begin),a=new Date(e.date_end);if(r.getTime()>a.getTime()&&"0"===e.not_finished&&o.push(n.dateError),o.length>0)return s.error(o.join(", ")),o}})}),define("DS/SwymUICore/script/feature/core/link/collection/link-collection",["require","exports","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/core/link/model/link-model"],function(e,t,i,n){"use strict";return i.extend({_services:{read:{link:{url:"api/user/getlinksbyhashkey",dataFn:function(e){return{hash_key:e.hash_key}}}}},comparator:function(e,t){var i=e.isSocialLink();return i===t.isSocialLink()?0:!0===i?-1:1},_collectionName:"link-collection",model:n,modes:["link"],_associations:{user:{}},onSync:function(){this.sort()}})}),define("DS/SwymUICore/script/feature/community/idea/collection/enovia-object-attributes-collection",["DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/community/idea/model/enovia-object-attributes-model"],function(e,t){"use strict";return e.extend({model:t,_collectionName:"enovia-object-attributes-collection",_serviceURI:null,_3dspaceURL:null,mode:"default",modes:["default"],_services:{read:{default:{urlFn:function(){return this._3dspaceURL+"/"+this._serviceURI+"/types/"+this._type},method:"GET",noCsrfToken:!0,type:"json",headers:{"Content-Type":"application/json; charset=utf-8",Accept:"application/json, text/javascript, */*"},parse:function(e){var t=[];return e.fields.forEach(function(e){t.push({label:e.label,name:e.name,type:e.type,options:e.options})}),t}}}},setup:function(e,t){if(!t.type)throw"A type is required";if(this._type=t.type,!t.serviceURI)throw"A serviceURI is required";if(this._serviceURI=t.serviceURI,!t.threeDSpaceUrl)throw"A threeDSpaceUrl is required";this._3dspaceURL=t.threeDSpaceUrl,this._parent.apply(this,arguments)}})}),define("DS/SwymUICore/script/feature/core/education/collection/education-collection",["require","exports","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/core/education/model/education-model"],function(e,t,i,n){"use strict";return i.extend({_services:{read:{education:{url:"api/user/getschoolsbyhashkey",dataFn:function(e){return{hash_key:e.hash_key}}}}},_collectionName:"education-collection",comparator:function(e,t){var i=0,n=new Date(e.get("date_begin")).getTime(),o=new Date(e.get("date_end")).getTime(),s=new Date(t.get("date_begin")).getTime(),r=new Date(t.get("date_end")).getTime();return n>s?i=-1:n<s?i=1:n===s&&(o>r?i=-1:o<r?i=1:o===r&&(i=0)),n||n||(i=-1),s||r||(i=1),i},model:n,modes:["education"],_associations:{user:{}},onSync:function(){this.sort()},onAdd:function(){this.sort()}})}),define("DS/SwymUICore/script/feature/core/user/model/user-model",["require","exports","UWA/Data","DS/SwymUICore/script/lib/model/generic/6wtaggable-model","DS/SwymUICore/script/feature/core/skill/collection/skill-collection","DS/SwymUICore/script/feature/core/language/collection/language-collection","DS/SwymUICore/script/feature/core/interest/collection/interest-collection","DS/SwymUICore/script/feature/core/experience/collection/experience-collection","DS/SwymUICore/script/feature/core/education/collection/education-collection","DS/SwymUICore/script/feature/core/link/collection/link-collection","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/utils/date","DS/SwymUICore/script/feature/community/member/model/mixin/community-member","DS/WAFData/WAFData","DS/Logger/Logger","DS/SwymUICore/script/utils/platform-utils","DS/SwymUICore/script/feature/core/user/model/user-group-utils","i18n!DS/SwymUICore/assets/nls/feature/core/user/model/user-model"],function(e,t,i,n,o,s,r,a,c,u,l,d,m,h,p,g,f,_,y,w){"use strict";var C,S={DEFAULT:w.errorPassportDefault,USER_ALREADY_EXISTS_UPDATE:w.errorPassportUserAlreadyExistsUpdate};!function(e){e.USER_ALREADY_EXISTS_UPDATE="user.already.exists.update"}(C||(C={}));var I="",v=window.ds&&"MOBILE"===window.ds.env,T=n.extend(p,{_modelName:"user",_attributesMapping:{user_id:"id",user_picture_update:"picture_update",name:"nickname",firstName:"first_name",lastName:"last_name",updated:"update",displayName:"nickname","image->updated":"picture_update",user_picture_fingerprint:"user_picture_fingerprint",user_statistics_comments:"nb_comment",user_statistics_posts:"nb_post",user_statistics_media:"nb_media",user_statistics_questions:"nb_question",user_statistics_ideas:"nb_ideation",user_statistics_answers:"nb_answer","dsaccess:accountName":"login","@id":"id",resourceUid:"id","foaf:firstName":"first_name","foaf:lastName":"last_name","foaf:givenName":"first_name","foaf:familyName":"last_name"},_attributesMappingForPassport:{firstName:"first_name",lastName:"last_name",telephone:"tel",address:"address",city:"city",country:"country_code",zip:"zip",email:"email",company:"company",language:"language"},_passportAttributesConstraints:{},_attributesEditableByPassport:{},_services:{read:{url:"api/user/find",dataFn:function(){return{hash_key:this.has("hash_key")?this.get("hash_key"):"",login:this.has("login")?this.get("login"):""}},parse:function(e){var t=new RegExp(/^\d\d\d\d-\d\d-\d\d \d\d:\d\d:\d\d$/),i=e.schools,n=e.works;return i&&Array.isArray(i)&&i.forEach(function(e){e.date_begin&&e.date_begin.match&&e.date_begin.match(t)&&(e.date_begin=h.convertDate(e.date_begin),e.date_end=h.convertDate(e.date_end))}),n&&Array.isArray(n)&&n.forEach(function(e){e.date_begin&&e.date_begin.match&&e.date_begin.match(t)&&(e.date_begin=h.convertDate(e.date_begin),e.date_end=h.convertDate(e.date_end))}),e.ID=e.id,e}},readwithoutcache:{url:"api/user/find",dataFn:function(){return{detailedInfos:!0,hash_key:this.get("hash_key"),login:this.get("login"),disablecache:!0}}},saveuserinfos:{url:"api/user/saveuserinfos"},uploadpreviewpicture:{url:"api/user/uploadpreviewpicture/"},uploadpicture:{url:"api/user/uploadpicture"},sendInvitation:{url:"api/notification/send/",dataFn:function(e){return{type:"Network",do:"invite",recipient_hash:this.get("hash_key"),message:e.message,related_model_id:e.groupIdProfessionnal}}},deleteuserfromnetwork:{url:"api/networkgroup/deleteuserfromnetwork",dataFn:function(){return{hash_key:this.get("hash_key"),login:this.get("login")}}},getInvitationStatus:{url:"api/network/getinvitationstatus",dataFn:function(){return{hash_key:this.get("hash_key"),login:this.get("login")}}},setvisibility:{url:"api/user/setvisibility",dataFn:function(e){return{visibility:e.visibility}}},removeSuggestion:{url:"api/Recommendation/blacklistitem",dataFn:function(){return{itemToBlacklistId:this.get("ID"),mode:"offline",limit:6,itemType:"User",maxNbOfCommonElements:"5"}}}},_associations:{skills:{Class:o,oppositeRole:"user",options:{mode:null}},interests:{Class:r,oppositeRole:"user",options:{mode:null}},languages:{Class:s,oppositeRole:"user",options:{mode:null}},works:{Class:a,oppositeRole:"user",options:{mode:null}},schools:{Class:c,oppositeRole:"user",options:{mode:null}},links:{Class:u,oppositeRole:"user",options:{mode:null}},contactsSharedWithCurrentUSer:{oppositeRole:"networkGroupOwner",options:{mode:"getmysharedcontacts",limit:10}},community:{}},_modelIdAttribute:"login",defaults:{},init:function(){if(this._parent.apply(this,arguments),this.get("user_community_role")&&!this.get("relation")){var e=this.getCommunityRoleFromExaleadRole(this.get("user_community_role"));e&&this.set("relation",e)}},isCurrentUser:function(){var e=this.get("login"),t=this.get("hash_key");return e&&e===this.getCurrentLogin()||t&&t===this.getCurrentHashKey()},getCurrentHashKey:function(){return l.getInstance().get("user").hash_key},getCurrentLogin:function(){return l.getInstance().get("user").login},readwithoutcache:function(e){return this.action("readwithoutcache",e)},uploadpreviewpicture:function(e){return this.action("uploadpreviewpicture",e)},uploadpicture:function(e){return this.action("uploadpicture",e)},sendInvitation:function(e){return this.action("sendInvitation",e)},saveuserinfos:function(e){return this.action("saveuserinfos",e)},deleteuserfromnetwork:function(e){return this.action("deleteuserfromnetwork",e)},removeSuggestion:function(e){return this.action("removeSuggestion",e)},setvisibility:function(e){return this.action("setvisibility",e)},getInvitationStatus:function(e){var t=this.get("ut_state");if(2!=t&&3!=t)return this.action("getInvitationStatus",e)},extractErrorCodeFromPassportResponse:function(e){var t=new RegExp("errorCode=(.*), msgKey").exec(e);if(null!==t)return t[1]},handleErrorFromPassport:function(e){var t=e.result,i=e.error;if("failed"===t)return function(e){var t=Object.keys(C).find(function(t){return C[t]===e});return t?S[t]:S.DEFAULT}(i&&this.extractErrorCodeFromPassportResponse(i))},updatePassportFields:function(e){var t=this;if(!0===this.isCurrentUser()){var i=e.data;i.username=this.get("username"),_.getPassportURLPromise().then(function(n){n&&g.authenticatedRequest("".concat(n,"/api/authenticated/user/fields"),{data:JSON.stringify({fields:i}),type:"json",method:"POST",timeout:6e4,headers:{"X-DS-IAM-CSRFTOKEN":I,Accept:"application/json","Content-Type":"application/json"},onComplete:e.onComplete,onFailure:function(i,n){f.log(i),f.log(n),f.log("3dpassport server error"),window.require(["DS/UWPClientControls/PlatformNotify"],function(e){var i=t.handleErrorFromPassport(n);e.error(i)}),e.onFailure()}})})}},_CSRFPASSPORTATTRIBUTE:"X-DS-IAM-CSRFTOKEN",passwordEditUrl:null,twoFAURL:null,adminURL:null,emailValidationURL:null,dppConsent:!1,syncPassportInformationIfNeeded:function(){var e=this,t=this;!0===this.isCurrentUser()&&_.getPassportURLPromise().then(function(i){i&&g.authenticatedRequest("".concat(i,"/api/authenticated/user/fields"),{method:"GET",timeout:6e4,headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(e,i,n){I=_.getCsrfToken(n,i,t._CSRFPASSPORTATTRIBUTE);var o,s,r,a,c=JSON.parse(e),u=c.fields;for(o in this._attributesMappingForPassport)this._attributesMappingForPassport.hasOwnProperty(o)&&u.hasOwnProperty(o)&&(s=u[o].value,a=!u[o].readOnly,r=this._attributesMappingForPassport[o],this._passportAttributesConstraints[r]=u[o].fieldConstraint,r&&(this.set(r,s),this._attributesEditableByPassport[r]=a));this.emailValidationURL=c.emailValidationURL,this.passwordEditUrl=c.pwdUpURL,this.twoFAURL=c.twoFAURL,this.adminURL=c.adminToolsURL,u.dpp_consent&&(this.dppConsent=u.dpp_consent),u.marketing_consent&&(this.marketing_consent=u.marketing_consent.value),this.dispatchEvent("onPassportSynced")}.bind(e),onFailure:function(){f.warn("Call to passport failed !!! This is a serious problem"),this.dispatchEvent("onPassportFailed")}.bind(e)})})},getPassportAttributeConstraints:function(e){var t,i=this._passportAttributesConstraints[e],n={maxlength:void 0,required:void 0,pattern:void 0};if(i)for(var o=0,s=i.length;o<s;o++)switch((t=i[o]).nameConstraint){case"stringLength":n.maxlength=t.maximumLength;break;case"mandatory":n.required=!0;break;case"string-pattern":n.pattern=t.pattern}return n},fetchCountries:function(e){var t=this;!0===this.isCurrentUser()&&_.getPassportURLPromise().then(function(i){i&&g.authenticatedRequest("".concat(i,"/api/public/countries/?languages=").concat(t.get("language")),{method:"GET",timeout:6e4,cache:!1,headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(t){for(var i,n=JSON.parse(t),o=[],s=0,r=n.length;s<r;s++)i=n[s],o.push({value:i.iso3,label:i.label});e.onComplete(o)}})})},isEditableByPassport:function(e){var t=this._attributesEditableByPassport[e];return void 0===t&&(t=!1),t},getRelativePath:function(){return m.URLPART_PEOPLE+(this.get("hash_key")?this.get("hash_key"):this.get("login"))+m.URLPEOPLE_ABOUTME},getRelativePathToConnections:function(){return m.URLPART_PEOPLE+this.get("hash_key")+m.URLPEOPLE_CONNECTIONS},getRelativePathToActivities:function(){return m.URLPART_PEOPLE+this.get("hash_key")+m.URLPEOPLE_ACTIVITIES},getRelativePathToSettings:function(){return m.URLPART_PEOPLE+this.get("hash_key")+m.URLPEOPLE_SETTINGS},isPendingUser:function(){return"0"===this.get("ut_state")},getNickname:function(){return this.get("nickname")?this.get("nickname"):this.get("first_name")&&this.get("last_name")?"".concat(this.get("first_name")," ").concat(this.get("last_name")):this.isPendingUser()?this.get("ut_invitation_email")||this.get("email"):""},isAnonymized:function(){var e,t;return 9===this.get("ut_state")||(e=this.get("login"),t=this.get("nickname"),e&&t?0===e.indexOf("_ANONYMISED_")||"Anonymized User"==t:null)},getCacheId:function(){return this.has("login")?this.get("login"):this._parent.apply(this,arguments)},isNew:function(){return!this.get("hash_key")&&!this.get("login")&&this._parent.apply(this,arguments)},"onChange:user_community_role":function(e,t){var i=this.getCommunityRoleFromExaleadRole(t);return i&&this.set("relation",i),this._previous.apply(this,arguments)}});return T=T.extend(y,{is3DWorkforceIntegrationEnabled:function(){var e=this;return new Promise(function(t,i){"".concat(e.get("first_name")," ").concat(e.get("last_name"));d.isCloud()&&d.isBetaFeatureActivated("workforce")?t(!0):t(!1)})}}),window.require(["DS/SwymUICore/script/feature/core/user/collection/user-collection"],function(e){T.prototype._associations.contactsSharedWithCurrentUSer.Class=e}),T.constructUserPictureUrl=function(e,t,n,o){var s="".concat(d.getBaseUrl(),"/api/user/getpicture/").concat(e?"login/".concat(e):n?"hash_key/".concat(n):"").concat(t?"/update/".concat(t):"").concat(o&&"normal"!==o?"/format/".concat(o):"");return v&&(s=i.proxifyUrl(s,{proxy:"passport"})),s},T}),define("DS/SwymUICore/script/feature/core/user/collection/commenters-collection",["require","exports","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/core/user/model/user-model"],function(e,t,i,n){"use strict";return i.extend({model:n,mode:null,modes:["comment","answer","edit","vote"],_associations:{commented:{},answersVote:{}},_services:{read:{comment:{url:"api/comment/listcommenters",dataFn:function(){var e=this.getAssociated("commented");if(this.parentId=e&&e.get("mid"),"iq-answer"===e.getModelName()){var t=e.getAssociated("answeredFor");return{model:t.getTableName(),model_id:t.get("mid"),answer_id:e.get("mid"),limit:9999}}return{model:e.getTableName(),model_id:e.get("mid"),limit:9999}}},answer:{url:"api/iquestionsAnswer/getwhoanswered",dataFn:function(){var e=this.getAssociated("commented");return this.parentId=e&&e.get("mid"),{qna_id:e.get("mid"),limit:9999}}},vote:{url:"api/iquestionsAnswer/getwhorated",dataFn:function(){return{answer_id:this.getAssociated("answersVote").get("mid"),limit:9999,page:1}}},edit:{url:"api/WikiTree/getwhoedited",dataFn:function(){var e=this.getAssociated("commented");return this.parentId=e&&e.get("mid"),{id:e.get("mid"),limit:9999}}}}}})}),define("DS/SwymUICore/script/feature/core/user/model/currentuser-model",["UWA/Core","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/core/group/collection/group-collection","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/utils"],function(e,t,i,n,o){"use strict";var s=t.extend({_modelName:"current-user",_attributesMapping:{user_id:"mid"},_associations:{groups:{Class:i,options:{mode:"getnetworkgroupsbyuser"}},_communities:{Class:null,options:{mode:"my-communities",limit:10}}},_services:{read:{CurrentUser:{url:"api/user/getcurrent",dataFn:function(){return{detailedView:!1,get_autosaved_content:!0}}}},setAccess:{url:"api/tenantAcl/setaccess",dataFn:function(e){return{hash_key:this.get("hash_key"),access:"4"}}},unsetAccess:{url:"api/tenantAcl/unsetaccess",dataFn:function(e){return{hash_key:this.get("hash_key"),access:"4"}}}},mode:null,defaultMode:"CurrentUser",modes:["CurrentUser"],defaults:{},init:function(e,t){try{this.setMode(t)}catch(e){return}this._parent(e,t)},setMode:function(e){try{if(e){var t=e.mode;t||(this.mode=this.defaultMode),t&&this.modes.indexOf(t)>=0?this.mode=t:delete e.url}}catch(e){return}},setAccess:function(e){return this.action("setAccess",e)},unsetAccess:function(e){return this.action("unsetAccess",e)},sync:function(t,i,n){try{var o={};return"read"===t&&(o=this.mode?this._services?this._services.read[this.mode]:{}:this._services?this._services.read[this.defaultMode]:{}),e.merge(n||{},o),this._parent(t,i,n)}catch(e){return!1}},getLastVisitedCommunities:function(e,t,i){var n=this;require(["DS/SwymUICore/script/feature/community/community/collection/community-collection","DS/SwymUICore/script/lib/model/generic/swym-model"],function(o,s){n.constructor.prototype._associations._communities.Class=o;var r=n.getAssociated("_communities");r.getLimit()<e&&(r.setLimit(e),r.loadingStatus=s.STATUS.notRequested),function n(){switch(r.loadingStatus){default:case s.STATUS.notRequested:r.fetchPage(1,{data:{order:"users_community_stats.last_connection DESC"},onComplete:function(){t.call(null,r.toJSON().slice(0,e))},onFailure:i});break;case s.STATUS.valid:t.call(null,r.toJSON().slice(0,e));break;case s.STATUS.invalid:i.call(null);break;case s.STATUS.pending:r.addEventOnce("onLoadingStatusChange",n)}}()})},isAllowedToCreateCommunity:function(){var e=n.getInstance().get("config").tenant,t="1"===this.get("tenant_admin"),i=!0===this.get("canCreateCommunity"),o=!i&&!1!==e.plan_a_community,s=!1!==e.allow_add_community_for_everyone;this.get("tenant_user_status");return!!(t||i||o||s)}}),r=null;return s.getInstance=function(){return null===r&&(r=new s({id:1})),r},s.getInstanceFetched=function(e){var t=n.getInstance(),i=o.getBaseUrl(),a=r&&r.urlRoot;return a&&i.toLowerCase()!==a.toLowerCase()&&this.reinitializeInstance(),null!==r&&r.hasBeenFetched()?e&&e(r):t.executeWhenReady(function(){null===r&&(r=new s(t.get("user"))),r.addEventOnce("onSync",function(t){e&&e(t)}),!1===r.isBeingFetched()&&r.fetch({fromCache:!0})}),r},s.reinitializeInstance=function(){return null!==r&&(r=null),this.getInstance()},s}),define("DS/SwymUICore/script/feature/core/user/model/assignee-model",["DS/SwymUICore/script/feature/core/user/model/user-model","i18n!DS/SwymUICore/assets/nls/feature/community/community/model/community-model"],function(e,t){"use strict";return e.extend({_modelName:"assignee",getNickname:function(){var e=this._parent.apply(this,arguments);return e||t.PendingUser},isPendingAssignee:function(){return!this.get("first_name")||!this.get("last_name")},_modelIdAttribute:"hash_key",get:function(e){return"login"===e&&this.isPendingAssignee()?this.get("mid"):this._parent.apply(this,arguments)}})}),define("DS/SwymUICore/script/feature/community/comment/model/comment-model",["require","exports","UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/date"],function(e,t,i,n,o,s,r){"use strict";var a=n.extend({_modelName:"comment",_tableName:"Comment",_attributesMapping:{id:"mid",emplid:"author->empl_id","user_id.emplid":"author->emplid",hash_key:"author->hash_key","user_id.hash_key":"author->hash_key",first_name:"author->first_name",last_name:"author->last_name",nickname:"author->nickname","user_id.nickname":"author->nickname",user_id:"author->mid","user_id.accept_share_info":"author->accept_share_info","user_id.email":"author->email","user_id.first_name":"author->first_name","user_id.last_name":"author->last_name","user_id.login":"author->login",picture_update:"author->picture_update","user_id.picture_update":"author->picture_update"},_associations:{author:{Class:o},commented:{},contentMedia:{}},_servicesMode:{post:{create:{url:"api/comment/add",dataFn:function(){return{comment:this.get("comment"),community_post_id:this.get("parentId")}}},update:{url:"api/comment/edit",paramsMapping:{mid:"id"}},remove:{url:"api/comment/delete",dataFn:function(){return{id:this.get("mid")}}},delete:{url:"api/comment/delete",dataFn:function(){return{id:this.get("mid")}}}},idea:{create:{url:"api/IdeationComment/add",dataFn:function(){return{comment:this.get("comment"),id:this.get("parentId")}}},update:{url:"api/IdeationComment/edit",paramsMapping:{mid:"id"}},remove:{url:"api/IdeationComment/delete",dataFn:function(){return{id:this.get("mid")}}},delete:{url:"api/IdeationComment/delete",dataFn:function(){return{id:this.get("mid")}}}},wiki:{create:{url:"api/WikiTreeComment/add",dataFn:function(){return{comment:this.get("comment"),wikitree_id:this.get("parentId")}}},update:{url:"api/WikiTreeComment/edit",paramsMapping:{mid:"id"}},remove:{url:"api/WikiTreeComment/delete",dataFn:function(){return{id:this.get("mid")}}},delete:{url:"api/WikiTreeComment/delete",dataFn:function(){return{id:this.get("mid")}}}},media:{create:{url:"api/MediaComment/add",dataFn:function(){return{comment:this.get("comment"),media_id:this.get("parentId")}}},update:{url:"api/MediaComment/edit",paramsMapping:{mid:"id"}},remove:{url:"api/MediaComment/delete",dataFn:function(){return{id:this.get("mid")}}},delete:{url:"api/MediaComment/delete",dataFn:function(){return{id:this.get("mid")}}}}},HTML_ATTRIBUTES:["comment"],defaults:{_acl:{update:{privilege:null,access:!1},delete:{privilege:null,access:!1}}},init:function(e,t){var n=s.getInstance().get("user"),o=n.first_name+" "+n.last_name,r=n.hash_key,a=n.picture_update;this.defaults=i.extend({},this.defaults||{}),this.defaults.author||(this.defaults.author={nickname:o,hash_key:r,picture_update:a});var c=t.commentType?t.commentType:t.collection.mode;switch(c){case"post":case"media":case"wiki":case"idea":case"topic":this._services=this._servicesMode[c]}return this._parent(e,t)},remove:function(e){return this.action("remove",e)},getAuthor:function(){return this.getAssociated("author")},"onSync:remove":function(){var e=s.getInstance().get("user");this.getAssociated("author").get("hash_key")===e.hash_key?this.set("moderation_status","deleted_by_author"):this.set("moderation_status","deleted"),this.set("update",r.getCurrentDate()),this._parent.apply(this,arguments)},"onSync:update":function(){var e=s.getInstance().get("user");this.getAssociated("author").get("hash_key")===e.hash_key?this.set("moderation_status","updated_by_author"):this.set("moderation_status","updated"),this._parent.apply(this,arguments)}});return window.require(["DS/SwymUICore/script/feature/community/media/collection/media-collection"],function(e){a.prototype._associations.contentMedia.Class=e,a.prototype._associations.contentMedia.oppositeRole="usedIn"}),a}),define("DS/SwymUICore/script/feature/community/comment/collection/comment-collection",["require","exports","UWA/Core","UWA/Utils","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/community/comment/model/comment-model","DS/Logger/Logger"],function(e,t,i,n,o,s,r){"use strict";var a=function(e){return!e||!e.status_id},c=function(e){return!e||!e.moderation_status||"deleted"!==e.moderation_status&&"deleted_by_author"!==e.moderation_status},u=function(e){return window.ds&&"v3"===window.ds.swymVersion&&i.is(e,"array")&&(e=e.filter(c)),e},l=s.extend({_modelName:"post-comment-model"}),d=s.extend({_modelName:"media-comment-model"}),m=s.extend({_modelName:"idea-comment-model"}),h=s.extend({_modelName:"answer-comment-model"}),p=s.extend({_modelName:"wiki-comment-model"}),g=s.extend({_modelName:"topic-comment-model"});return o.extend({model:function(e,t){var i=null;switch(t.collection.mode){case"post":i=l;break;case"iq-answer":i=h;break;case"idea":i=m;break;case"media":i=d;break;case"wiki":i=p;break;case"topic":i=g}return new i(e,t)},mode:null,modes:["iq-answer","post","media","idea","wiki","topic"],parentId:null,_associations:{commented:{}},_services:{read:{"iq-answer":{url:"api/IquestionsComment/list",dataFn:function(){if(!this.parentId){var e=this.getAssociated("commented");this.parentId=e&&e.get("mid")}return{answer_id:this.parentId,limit:9999}},parse:u,postProcess:function(e){i.is(e,"object")&&i.is(e.result,"array")&&e.result.forEach(function(e){e&&e.qna_id&&(e.id=e.qna_id)})}},post:{url:"api/comment/list",dataFn:function(){if(!this.parentId){var e=this.getAssociated("commented");this.parentId=e&&e.get("mid")}return{community_post_id:this.parentId,limit:9999}},parse:u},media:{url:"api/MediaComment/list",dataFn:function(){if(!this.parentId){var e=this.getAssociated("commented");this.parentId=e&&e.get("mid")}return{media_id:this.parentId,limit:9999,order:"asc"}},parse:u},idea:{url:"api/IdeationComment/list",dataFn:function(){if(!this.parentId){var e=this.getAssociated("commented");this.parentId=e&&e.get("mid")}return{id:this.parentId,limit:9999}},parse:u},wiki:{url:"api/WikiTreeComment/list",dataFn:function(){if(!this.parentId){var e=this.getAssociated("commented");this.parentId=e&&e.get("mid")}return{wikitree_id:this.parentId,limit:9999}},parse:u},topic:{url:"api/conferences/tuIBkLxuQv2yl-FHOiGXkw/topics/9w239bIZTRO2hd1gB3QCnQ/comments",parse:u}}},setup:function(e,t){t.parentId&&(this.parentId=t.parentId)},_addAssociationFromCollectionToModels:function(e,t){var i,n,o=(t=t||this._models)?t.length:0;if(n=this.getAssociated(e))for(i=0;i<o;i++)t[i].setAssociated(e,n)},_updateCommentCounter:function(){var e;(e=this.getAssociated("commented"))&&e.set("nb_comments",this.length)},"onSetAssociated:commented":function(e,t,i){this===e&&(this.stopListening(t,"onSync"),this._addAssociationFromCollectionToModels("commented"))},onAdd:function(e){this._addAssociationFromCollectionToModels("commented",[e])},addComment:function(e){if(!(e instanceof s))throw{name:"Incorrect comment type",message:"The comment you are trying to add is not for an IQuestion."};var t=this,i=n.getUUID();e.set("X-Request-ID",i),e.save({},{headers:{"X-Request-ID":i},onComplete:function(e){t.add(e)}})},editComment:function(e){try{if(!(e instanceof s))throw{name:"Incorrect model type",message:"The model you are trying to edit is not a comment."};e.save({})}catch(e){return void r.error("Error in saving changes to comment: "+e.message)}},filterDeletedAndStatusRelatedComments:function(e){return i.is(e,"array")||(e=this.toJSON()),e.filter(c).filter(a)}})}),define("DS/SwymUICore/script/feature/community/idea/model/license-model",["DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/idea/collection/collab-space-collection","DS/SwymUICore/script/feature/community/idea/collection/enovia-object-attributes-collection"],function(e,t,i){"use strict";return e.extend({_modelName:"license",_selectedSubType:null,defaults:{label:"",name:"",subtypes:null,serviceURI:"",threeDSpaceUrl:""},_associations:{"collab-spaces":{Class:t,options:{mode:"default"}},attributes:{Class:i,options:{mode:"default"}}},getCollabSpaces:function(){var e=null;return this.hasAssociated("collab-spaces")||(e=new t([],{type:this._selectedSubType,serviceURI:this.getServiceURI(),threeDSpaceUrl:this.get("threeDSpaceUrl",{escapeHTML:!1})}),this.setAssociated("collab-spaces",e)),this.getAssociated("collab-spaces")},getAttributes:function(){var e=null;return this.hasAssociated("attributes")||(e=new i([],{type:this._selectedSubType,serviceURI:this.getServiceURI(),threeDSpaceUrl:this.get("threeDSpaceUrl",{escapeHTML:!1})}),this.setAssociated("attributes",e)),this.getAssociated("attributes")},setSelectedSubType:function(e){this._selectedSubType=e},getServiceURI:function(){return this.get("serviceURI",{escapeHTML:!1})},getCSRFToken:function(){return this.getAssociated("attributes").getCSRFToken()}})});__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};define("DS/SwymUICore/script/feature/core/network/model/activity-model",["require","exports","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/core/user/model/currentuser-model","i18n!DS/SwymUICore/assets/nls/feature/core/timeline/model/activity-model","DS/SwymUICore/script/feature/community/derived-type/derived-type-data-utils"],function(e,t,i,n,o,s,r){"use strict";return i.extend({_modelName:"activity",HTML_ATTRIBUTES:["img","text"],attr:"",_errorMessage:"error: message not found",_attributesMapping:{feed_time:"date",user_name:"url",feed_text:"text","community->title":"communityTitle"},setup:function(){var e=this.get("user"),t=this.get("date"),i=this._buildContent();this.set({text:i!==this._errorMessage?i:"",date:t.replace(" ","T")+"Z",img:n.constructUserPictureUrl(e.login,e.user_picture_fingerprint)})},_getContentType:function(e){var t=this.get("derived_type");if(t)return t=__assign(__assign({},t),{parent:e.toUpperCase()}),r.createTypeNameForDerivedType(t);switch(e){case"question":return"iquestion";case"ideation":return"idea";case"wikipage":return"wiki";default:return e}},_getCommunityId:function(){var e=this.get("community");return e&&e.id||this.get("community_id")},_getTargetLabel:function(){return this.get("target_label")||""},_buildContent:function(){var e=this.get("communityTitle"),t=this._getTargetLabel(),i=this.get("target_id"),n=this._getMessage(),o=this.get("type"),r=this.get("subtype"),a=this.get("user"),c='<a class="link" data-content-type="person" data-login="'+a.login+'">'+a.first_name+" "+a.last_name+"</a>",u='<a class="link" data-content-type="person" data-login="'+this.get("target_id")+'">'+t+"</a>",l=t,d='<a class="link" data-facet="1" data-content-type="person" data-login="'+a.login+'">'+a.first_name+" "+a.last_name+"</a>",m=this._getCommunityId(),h=m?'<a class="link" data-content-type="community" data-content-id="'+m+'">'+e+"</a>":"",p='<a data-type="internal" data-content-type="'+this._getContentType("endorse"===o?r:o)+'" data-community-id="'+this._getCommunityId()+'" data-content-id="'+i+'" data-source="swym">'+t+"</a>",g=this._getRole(),f=this.get("derived_type");return n=n&&n!==this._errorMessage?s.replace(n,{http_user_link:c,http_community_link:h,http_post_link:p,http_media_link:p,http_document_link:p,http_wikipage_link:p,http_iquestion_link:p,http_ideation_link:p,http_target_user_link:u,item_title:p,http_content_link:p,http_profile_update:l,http_profile_link:d,user_role:g,derived_type_label:f&&f.label}):this._errorMessage},_getRole:function(){var e="";if(this.attr&&this.attr.action&&this.attr.type&&"update"===this.attr.action&&"community"===this.attr.type&&this.attr.subtype)switch(this.attr.subtype){case"1":e=s.Contributor;break;case"2":e=s.Author;break;case"3":e=s.Owner}return e},_getMessage:function(){var e=this._errorMessage,t=this.get("action"),i=this.get("type"),n=this.get("subtype"),r=!!this.get("content_uri_list")&&this.get("content_uri_list").filter(function(e){return"Comment"===e.content_type}).length>0,a=this.get("derived_type")?"Derived":"";if(i&&t)switch(i){case"post":e=n&&"comment"===n?s[t+a+"PostCommentText"]:s[t+a+"PostText"];break;case"question":case"iquestion":n?"comment"===n?e=s[t+"AnswerCommentText"]:"answer"===n&&(e=s[t+"AnswerText"]):e=s[t+"QuestionText"];break;case"media":e=n&&"comment"===n?s[t+"MediaCommentText"]:s[t+"MediaText"];break;case"survey":e=s[t+"SurveyText"];break;case"idea":case"ideation":e=n&&"comment"===n?s[t+a+"IdeationCommentText"]:s[t+a+"IdeationText"];break;case"wiki":case"wikipage":e=n&&"comment"===n?s[t+"WikiPageCommentText"]:s[t+"WikiPageText"];break;case"social-event":case"conference":e=n&&"comment"===n?s[t+"SocialEventCommentText"]:s[t+"SocialEventText"];break;case"wedo":e=n&&"comment"===n?s[t+"WedoCommentText"]:s[t+"WedoText"];break;case"community":e=s[t+"CommunityMembershipText"];break;case"endorse":switch(n){case"post":e=r?s[t+a+"PostCommentEndorseText"]:s[t+a+"PostEndorseText"];break;case"media":e=r?s[t+"MediaCommentEndorseText"]:s[t+"MediaEndorseText"];break;case"question":case"iquestion":e=r?s[t+"QuestionCommentEndorseText"]:s[t+"QuestionEndorseText"];break;case"idea":case"ideation":e=r?s[t+a+"IdeationCommentEndorseText"]:s[t+a+"IdeationEndorseText"];break;case"wiki":case"wikipage":e=r?s[t+"WikiPageCommentEndorseText"]:s[t+"WikiPageEndorseText"];break;case"wedo":e=r?s[t+"WedoCommentEndorseText"]:s[t+"WedoEndorseText"];break;case"conference":case"social-event":e=s[t+"SocialEventEndorseText"]}break;case"skill":e=s[t+"ProfileSkillText"];break;case"interest":e=s[t+"ProfileInterestText"];break;case"education":e=s[t+"ProfileEducationText"];break;case"work":e=s[t+"ProfileWorkText"];break;case"spokenlanguage":e=s[t+"ProfileSpokenLanguageText"];break;case"link":e=s[t+"ProfileLinkText"];break;case"profile":e=s[t+"ProfileText"];break;case"network":var c=o.getInstanceFetched();e=c&&c.get("login")===this.attr.target_id?s.addSelfUserNetworkText:s[t+"NetworkMembershipText"]}return e}})}),define("DS/SwymUICore/script/feature/community/iquestion/model/iqa-comment-model",["UWA/Core","DS/SwymUICore/script/feature/community/comment/model/comment-model","DS/SwymUICore/script/utils/date"],function(e,t,i){return t.extend({_modelName:"iqa-comment",_tableName:"QnaComment",_attributesMapping:{qna_id:"mid",qna_update:"update",qna_answer_id:"answer_id","user_id.nickname":"nickname","user_id.hash_key":"hash_key"},_services:{create:{url:"api/IquestionsComment/add",dataFn:function(e){return(e=e||{}).qna_answer_id=this.get("answer_id")||this.get("parentId"),e.comment=e.comment||this.get("comment"),e}},update:{url:"api/IquestionsComment/edit",paramsMapping:{mid:"id"}},remove:{url:"api/IquestionsComment/delete",dataFn:function(){return{id:this.get("mid")}}},delete:{url:"api/IquestionsComment/delete",dataFn:function(){return{id:this.get("mid")}}}},defaults:{},"onSync:update":function(){this.set("update",i.getCurrentDate())},"onSync:remove":function(){this.set("update",i.getCurrentDate())},remove:function(e){return this.action("remove",e)}})}),define("DS/SwymUICore/script/feature/core/edit-info/model/edit-info-model",["DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/core/user/model/user-model"],(e,t)=>{return e.extend({_modelName:"edit-info-model",_services:{read:{url:"/api/editingpercontent/list",method:"GET",dataFn(){return{content_uri:this.get("mid"),page_number:0,page_size:10}},parse:e=>({editors:e.map(e=>({...e,author:new t(e.author)}))})},delete:{urlFn(){return`/api/editingpercontent/delete?content_uri=${encodeURIComponent(this.get("mid"))}`},method:"DELETE"}}})}),define("DS/SwymUICore/script/feature/community/iquestion/model/iq-answer-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/comment/collection/comment-collection","DS/SwymUICore/script/feature/core/user/collection/commenters-collection","DS/SwymUICore/script/feature/community/iquestion/model/iqa-comment-model","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/date","DS/SwymUICore/script/utils/navigation","DS/WebappsUtils/Console"],function(e,t,i,n,o,s,r,a,c,u){"use strict";var l=(window.widget&&window.widget.id?window.widget.id+"-":"")+"answerSortField",d=t.extend({_modelName:"iq-answer",_tableName:"QnaAnswer",_attributesMapping:{qna_id:"mid",answer_id:"mid",nickname:"author->nickname",hash_key:"author->hash_key",login:"author->login","user_id.nickname":"author->nickname","user_id.hash_key":"author->hash_key",question_id:"iquestion_id",qna_question_id:"question_id",comment_count:"nb_comments",count_comment:"nb_comments",stats_comments:"nb_comments"},_associations:{author:{Class:s},comments:{Class:i,oppositeRole:"commented",options:{mode:"iq-answer",model:o}},commenters:{Class:n,oppositeRole:"commented",options:{mode:"comment"}},answeredFor:{},whoRated:{Class:n,oppositeRole:"answersVote",options:{mode:"vote"}}},_services:{create:{url:"api/IquestionsAnswer/add",dataFn:function(e){return(e=e||{}).answer=e.answer||this.get("answer"),e.qna_question_id=this.get("iquestion_id")||this.get("parentId"),e}},update:{url:"api/IquestionsAnswer/edit",paramsMapping:{mid:"id"},parse:function(e){return e&&e.moderation_date&&(e.update=e.moderation_date),e}},validateAnswer:{url:"api/IquestionsAnswer/validanswer",dataFn:function(){return{answer_id:this.get("mid")}}},invalidateAnswer:{url:"/api/answer/invalidate",dataFn:function(){return{answer_id:this.get("mid")}}},positiveRate:{url:"api/IquestionsAnswer/addrate",dataFn:function(){return{qna_answer_id:this.get("mid"),ratevalue:1}},parse:function(e){return e.my_rate="1",e}},negativeRate:{url:"api/IquestionsAnswer/addrate",dataFn:function(){return{qna_answer_id:this.get("mid"),ratevalue:0}},parse:function(e){return e.my_rate="0",e}},remove:{url:"api/IquestionsAnswer/delete",dataFn:function(){return{id:this.get("mid")}}},delete:{url:"api/IquestionsAnswer/delete",dataFn:function(){return{id:this.get("mid")}}},positiveRate:{url:"api/IquestionsAnswer/addrate",dataFn:function(){return{qna_answer_id:this.get("mid"),ratevalue:1}},parse:function(e){return e.my_rate="1",e}}},defaults:{title:"",rate:0,nb_comments:0,has_rated:0,can_vote:0,validate:"0",_acl:{update:{groupIdentifier:"CONTENT_OWNER",access:!0},delete:{groupIdentifier:"CONTENT_OWNER",access:!0}},moderation_status:"no_moderation"},HTML_ATTRIBUTES:["answer"],_getNbCommentsFromCommentCollection:function(){var e=this._associations&&this._associations.comments.associated;return!(!e||!e.hasBeenFetched())&&e.filterDeletedAndStatusRelatedComments().length},_recomputeNbCommentsIfNeeded:function(){var e=this._getNbCommentsFromCommentCollection();if(!1!==e)return this.set("nb_comments",e)},init:function(e,t){var i=r.getInstance().get("user"),n=i.first_name+" "+i.last_name,o=i.hash_key;return this.defaults.nickname=n,this.defaults.hash_key=o,this.defaults.login=i.login,this._parent(e,t)},getCommenters:function(){return this.getAssociated("commenters")},getCommentCollection:function(){return this.getAssociated("comments")},fetchComments:function(e){this.getCommentCollection().fetch(e)},addComment:function(e){try{this.getCommentCollection().addComment(e),this.getCommentCollection().addEventOnce("onAdd",function(){this.dispatchEvent("commentCreated")}.bind(this))}catch(e){u.error("Error adding new answer to collection: "+e.message)}},getNbComments:function(){var e=this._getNbCommentsFromCommentCollection();return!1!==e?e:this.get("nb_comments")},getWhoRated:function(){return this.getAssociated("whoRated")},"onSetAssociated:comments":function(e,t,i){return this.listenTo(i,"onCollectionChange",this._recomputeNbCommentsIfNeeded),this._parent.apply(this,arguments)},"onChange:nb_comments":function(){this._recomputeNbCommentsIfNeeded()},"onSync:positiveRate":function(){this.set("has_rated",1)},"onSync:negativeRate":function(){this.set("has_rated",1)},"onSync:update":function(){this.set("update",a.getCurrentDate())},"onSync:remove":function(){this.set("update",a.getCurrentDate())},positiveRate:function(e){return this.action("positiveRate",e)},negativeRate:function(e){return this.action("negativeRate",e)},validateAnswer:function(e){return this.action("validateAnswer",e)},invalidateAnswer:function(e){return this.action("invalidateAnswer",e)},remove:function(e){return this.action("remove",e)},getAuthor:function(){return this.getAssociated("author")},getCommunity:function(){var t=this.getAssociated("answeredFor");if(e.is(t.getCommunity,"function"))return t.getCommunity();throw new Error("This was not supposed to happen!")},getRelativePath:function(){return this.get("community_id")||u.log("exception : there is no community defined !!!"),c.URLPART_COMMUNITY+this.get("community_id")+c.URLCONTENT_IQUESTION+this.get("iquestion_id")}});return d.LocalStorageKeyForSort=l,d.DateField="pubdate",d.VoteField="rate",d}),define("DS/SwymUICore/script/feature/community/report-abuse/model/report-abuse-model-v2",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/user/model/user-model","DS/Logger/Logger"],function(e,t,i,n,o){"use strict";var s=n.extend({_provokeCacheUpdates:!1,_attributesMapping:{firstName:"first_name",lastName:"last_name"}});return t.extend({_modelName:"report-abuse",_modelIdAttribute:"reportAbuseUri",_attributesMapping:{id:"id"},_services:{create:{url:"",wrapData:!1,dataFn:function(e){return{subjectUri:e.subjectUri||"",parentCommentUri:e.parentCommentUri,subjectUrl:e.subjectUrl||"",subjectType:e.subjectType||"",subjectTitle:e.subjectTitle||"",contextUri:e.contextUri||"",description:e.description||"",reasons:e.reasons||[]}}}},_associations:{author:{Class:s}},defaults:{reportAbuseUri:void 0,parentCommentUri:void 0,linkServiceName:"",linkUri:"",subjectUri:"",subjectUrl:"",subjectType:"",subjectTitle:"",contextUri:"",description:"",reasons:null,serviceName:"3DSwym",author:null,creationDate:""},_computeUrlRoot:function(){var e=this.get("subjectUri");if(e)return i.getBaseUrl()+"/commentproxy/subjects/"+e+"/reportabuses";throw new Error("No subject URI found on Report Abuse model")},sync:function(){return this.urlRoot=this._computeUrlRoot(),this._parent.apply(this,arguments)}})}),define("DS/SwymUICore/script/feature/community/iquestion/collection/iq-answer-collection",["UWA/Core","UWA/Utils","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/feature/community/iquestion/model/iq-answer-model","DS/WebappsUtils/Console"],(e,t,i,n,o,s)=>{const{DateField:r}=o,{VoteField:a}=o,c=function(e){return!e||!e.moderation_status||"deleted"!==e.moderation_status&&"deleted_by_author"!==e.moderation_status},u=function(t){return t&&t.id&&delete t.id,e.is(t,"array")&&(t=t.filter(c)),t};return i.extend({_services:{read:{"iq-answers":{url:"api/IquestionsAnswer/list",dataFn(e){return{iQuestions_id:this.getIquestionId(),limit:e.limit||"1000",orderBy:this.sortAttribute,page:1}},parse:u},"iq-answers-validated":{url:"api/IquestionsAnswer/list",dataFn(e){return{iQuestions_id:this.getIquestionIdForValidAnswers(),limit:e.limit||"1000",orderBy:this.sortAttribute,page:1,validate:1}},parse:u}}},_associations:{answeredFor:{}},_communityId:null,_iquestionId:null,mode:null,modes:["iq-answers-validated","iq-answers"],model:o,sortAttribute:r,setup(e,t){t.communityId&&(this._communityId=t.communityId),t.iquestionId&&(this._iquestionId=t.iquestionId)},_addAssociationFromCollectionToModels(e,t){let i,n,o;const s=(t=t||this._models)?t.length:0;if(o=this.getAssociated(e))for(i=0;i<s;i++)(n=t[i]).setAssociated(e,o)},_updateAnswerCounter(){let e;(e=this.getAssociated("answeredFor"))&&e.set("nb_answers",this.length)},"onSetAssociated:answeredFor":function(e){this===e&&this._addAssociationFromCollectionToModels("answeredFor")},onAdd(e){this._addAssociationFromCollectionToModels("answeredFor",[e])},getIquestionId(){return this.getAssociated("answeredFor").get("mid")},getIquestionIdForValidAnswers(){return this.getAssociated("answeredFor").get("mid")},getCommunityId(){return this._communityId},setCommunityId(e){this._communityId=e},getSortAttribute(){return this.sortAttribute},setSortAttribute(e){return(e===a||e===r)&&(this.sortAttribute=e,!0)},comparator(e){return this.sortAttribute===a?-e.get(a):e.get(r)},addAnswer(e){try{const i=this;if(!(e instanceof o))throw{name:"Incorrect answer type",message:"The answer you are trying to add is not an IQuestion."};{const n=t.getUUID();e.set("X-Request-ID",n),e.save({},{headers:{"X-Request-ID":n},onComplete(e){let t,n,o;(t=i.getAssociated("answeredFor"))&&(n=t.get("author"))&&(o=n.mid)&&e.set("target_user",o);const s=t.get("answers")||[];s.push(e.toJSON()),t.set("answers",s)}})}}catch(e){s.error(`Error adding new answer to collection: ${e.message}`)}},"onSync:positiveRate":function(){this.sort()},"onSync:negativeRate":function(){this.sort()}})}),define("DS/SwymUICore/script/feature/core/network/model/request-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/core/user/model/user-model"],function(e,t,i){"use strict";return t.extend({_modelName:"request",_attributesMapping:{first_name:"user->first_name",hash_key:"user->hash_key",last_name:"user->last_name",nickname:"user->nickname",user_id:"user->mid"},_associations:{user:{Class:i}},_services:{moderate:{url:"api/network/updaterequestsnetwork",dataFn:function(e){return{notification_id:this.get("mid"),group_id:e.group_id,accept_status:e.accept_status}}}},moderate:function(e){return this.action("moderate",e)},defaults:{}})}),define("DS/SwymUICore/script/feature/core/auto-save/model/auto-save-model",["DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/core/user/model/currentuser-model"],(e,t)=>{const i={};let n=!1;const o=e.extend({_modelName:"auto-save",_modelIdAttribute:"autosave_id",_services:{create:{url:"api/autosaves",wrapData:!1,method:"POST"},read:{url:"api/autosaves",method:"GET"},update:{url:"api/autosaves",wrapData:!1,dataType:"json",method:"PUT",dataFn(){return{content_type:this.get("content_type"),community_id:this.get("community_id"),content_id:this.get("content_id"),content_title:this.get("content_title"),content_message:this.get("content_message"),content_options:this.get("content_options")}}},delete:{url:"api/autosaves",method:"DELETE"}},get(e,t){return t={escapeHTML:!1},this._parent.apply(this,[e,t])},localDestroy(){this.dispatchEvent("onDestroy",[this])}});let s=null;return i.getInstance=function(){return null===s&&(s=new o),s},i.deleteInstance=function(e){s&&s.get("autosave_id")&&(e&&!0===e.localAutoSaveClearOnly?s.localDestroy():s.destroy()),n=!0,s=null},i}),define("DS/SwymUICore/script/lib/6wpanel/community-tags-manager",["DS/SwymUICore/script/lib/pub-sub","DS/SwymUICore/script/feature/core/context/context-model","DS/TagNavigator/userTags/utils/UserTagsUtils","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/feature/core/config/bootstrap-model"],(e,t,i,n,o,s,r)=>{let a=null;const c=e=>!0===e.isCommunityTag,u=r.getInstance(),l=n.getMyCommunitiesAppKey(),d=e.extend({firstFetch:!1,tags:[],communityId:void 0,listeningTo:null,getCurrentUserPromise:()=>new Promise(e=>{s.getInstanceFetched(t=>{e(t)})}),getPlatformId:()=>u.get("config").tenant.online_instance_id.toUpperCase(),getCommunityId(){return this.communityId},async getCommunityTags({communitySubjectURI:e,edition:t}){try{const n=this.getPlatformId(),o=await this.getCurrentUserPromise(),s={communityId:e,platformId:n,appName:l,currentUser:o.get("login")};!0!==t&&(s.mode="database");const r=await i.getCommunityTags(s);if(r&&r.communityTags&&Array.isArray(r.communityTags)){return r.communityTags.map(e=>({...e,label:e.label||e.dispValue}))}}catch(e){console.error("err",e)}return[]},async getTagsForHeaders({communitySubjectURI:e,existingTags:t,dontSetTags:n}){try{const o=(t||[]).map(e=>{const t={...e};return Array.isArray(t.object)?t:("string"==typeof t.object&&t.object.indexOf("&#47;")>-1&&(t.object=t.object.split("&#47;")),t)}),s=this.getPlatformId(),r=await this.getCurrentUserPromise(),a=await i.filterCommunityTags({communityId:e,platformId:s,appName:l,currentUser:r.get("login"),summary:o});if(a&&a.communityTags&&Array.isArray(a.communityTags)){const e=a.communityTags.filter(c);return!0!==n&&(this.firstFetch=!0,this.tags=e),e}}catch(e){console.error("err",e)}return[]},getInputTags:e=>i.getSelectedCommunityTags(e),async getSuggestions({communitySubjectURI:e,text:t}){if(!e)throw new Error("We need a communitySubjectURI for community tags");try{const n=this.getPlatformId(),o=await this.getCurrentUserPromise();return await i.getSuggestionsFor3DSwymContent({communityId:e,platformId:n,appName:l,currentUser:o.get("login"),text:t})}catch(e){return console.error("err",e),[]}},async saveTags({communitySubjectURI:e,tags:t}){try{const n=this.getPlatformId(),o=await this.getCurrentUserPromise();return await i.updateCommunityTags({communityId:e,platformId:n,appName:l,currentUser:o.get("login"),communityTags:t}),!0}catch(e){throw console.error("err",e),new Error("Add tags failed: ",e.message)}},getTags(){return this.tags},getCommunitySubjectURI({communityId:e}){return new Promise((i,n)=>{e||(e=t.getInstance().communityId),e?require(["DS/SwymUICore/script/feature/community/community/model/community-model"],t=>{const o=new t({mid:e});o.hasBeenFetched()||(this.listenToOnce(o,"onSync",()=>{i(o.getSubjectURI())}),o.isBeingFetched()||o.fetch({onComplete(){i(o.getSubjectURI())},onFailure:n}));try{const e=o.getSubjectURI();i(e)}catch(e){n(e)}}):n(new Error("Not a community context"))})},async updateCommunity({communityId:e,proxy:t,isDM:i}){try{if(this.communityId=void 0,i)return this.tags=[],this.communityId=e,void this.dispatchEvent("tagsUpdated",[this.tags,e]);require(["DS/SwymUICore/script/feature/community/community/model/community-model"],async n=>{const o=new n({mid:e});if(!t)return;const s=t.proxyObj.getClient();if(!s)return void this.listenToOnce(t.proxyObj,"onSetClient",this.updateCommunity.bind(this,{communityId:e,proxy:t,isDM:i}));if(s.communityId!==e)return void this.listenToOnce(t.proxyObj,"onClientChange",this.updateCommunity.bind(this,{communityId:e,proxy:t,isDM:i}));const r=s.getTags();if(!r)return;if(!r.hasBeenFetched())return void this.listenToOnce(r,"onSync",this.updateCommunity.bind(this,{communityId:e,proxy:t,isDM:i}));const a=o.getSubjectURI(),c=r.toJSON();await this.getTagsForHeaders({communitySubjectURI:a,existingTags:c}),this.communityId=e,this.dispatchEvent("tagsUpdated",[this.tags,e])})}catch(e){console.error("err",e)}},applyTagToContext({communityId:e,communityPage:t,tag:i,mode:n}){const s={[i.sixw]:[{object:i.object,type:"string"}]};o.goToCommunity(e,t,void 0,!1,{tagNavigatorFilteringOptions:{filter:s,mode:n}})},async tagsFetched(e){const t=e.getTagged();if(!t.communityId)return;const{communityId:i}=t,n=await this.getCommunitySubjectURI({communityId:i}),o=e.toJSON();await this.getTagsForHeaders({communitySubjectURI:n,existingTags:o}),this.communityId=i,this.dispatchEvent("tagsUpdated",[this.tags,this.communityId])},addClient(e){if(this.listeningTo)throw new Error("Already listening to a client");this.listenTo(e,"onCollectionChange",this.clientHandler.bind(this)),this.listeningTo=e},removeClient(){this.listeningTo&&(this.stopListening(this.listeningTo,"onCollectionChange",this.clientHandler),this.listeningTo=null)},clientHandler(){this.tagsFetched(this.listeningTo)}});return d.getInstance=(()=>(a||(a=new d),a)),d.tagAsObject=(e=>{let t="";return e.object?t=e.object_db||e.object:e.label&&(t=e.label),{predicate:e.sixw,object:t}}),d.getFilterDescription=i.getFilterDescription,d.getDefaultSuggestions=(({text:e})=>i.getDefaultSuggestions({text:e}).filter(e=>e.object_db)),d}),define("DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection",["UWA/Core","UWA/Json","UWA/Array","DS/SwymUICore/script/feature/core/pagination/collection/paginated-collection","DS/SwymUICore/script/feature/core/6wtag/collection/6wtag-collection","DS/SwymUICore/script/lib/6wpanel/6wtaggable","DS/SwymUICore/script/lib/6wpanel/utils","DS/SwymUICore/script/lib/6wpanel/community-tags-manager","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/utils/utils","DS/WebappsUtils/Console"],(e,t,i,n,o,s,r,a,c,u,l)=>{function d(e,t,i){e instanceof m&&(e.removeEvent("onSync:read",d),!0===e.fetchTagsSeparatelyOnRefresh&&(i&&i.data&&1===parseInt(i.data.page,10)||1===e.getCurrentPage())&&(e._tagFetchDelay>0&&!1===e.tagsFetchedAtleastOnce?setTimeout(()=>{e.tagsFetchedAtleastOnce=!0,e.fetchTagsSeparately()},e._tagFetchDelay):e.fetchTagsSeparately()))}var m=n.extend(s,{_associations:{"6wtags":{Class:o,oppositeRole:"tagged",options:{mode:""}}},_defaultSearchOptions:{},_tagFetchDelay:1500,tagsFetchedAtleastOnce:!1,taggerFilters:null,exaleadFilters:null,exaleadQuery:"#all",exaleadContentType:null,fetchTagsSeparatelyOnRefresh:!1,_getRemoteFilteringParams(t,i){return e.merge({refine:i},e.merge(this._getRefreshParams()||{},this.getDefaultSearchOptions()||{}))},_defaultParamsMappingForSearch:{page:"start",limit:"nresults"},_defaultParsingFn:r.parseSearchResult,_updateTagsMode(){this.getTags().setMode(`${this._collectionName}:${this.mode}`)},init(e,t){if(this._parent.apply(this,arguments),t=t||{},Object.hasOwnProperty.call(t,"is6wTaggable")&&(this.is6wTaggable=t.is6wTaggable),Object.hasOwnProperty.call(t,"fetchTagsSeparatelyOnRefresh")&&(this.fetchTagsSeparatelyOnRefresh=!0===t.fetchTagsSeparatelyOnRefresh),Object.hasOwnProperty.call(t,"defaultSearchOptions")&&this.setDefaultSearchOptions(t.defaultSearchOptions),Object.hasOwnProperty.call(t,"exaleadContentType")&&(this.exaleadContentType=t.exaleadContentType),!0===this.fetchTagsSeparatelyOnRefresh)try{this.checkIfModeAllowsFiltering(),this.addEvent("onSync:read",d)}catch(e){l.warn(e.message)}return this},setDefaultSearchOptions(e){this._defaultSearchOptions=e},getDefaultSearchOptions(){return this._defaultSearchOptions},resetCollection(e,t){return"read"===(t&&t.serviceName||this.lastCalledService||"read")&&!0===this.fetchTagsSeparatelyOnRefresh&&this.addEvent("onSync:read",d),this._parent(e,t)},fetchTagsSeparately(){let e={};const t=this._getRefreshParams()||{};e={data:t,paramsMapping:this._defaultParamsMappingForSearch},t.nresults=1,t.limit=0,t.start=0,this.exaleadContentType&&(t.contentType=this.exaleadContentType),t.query=t.query||this.exaleadQuery||"#all",this.mode?"function"==typeof this._services.filter[this.mode].dataFn&&(e.data=this._services.filter[this.mode].dataFn.call(this,t)):l.warn("The current 6W filterable has no mode!"),this.getTags().fetch(e)},checkIfModeAllowsFiltering(){if(this._services&&this.mode&&this._services.filter&&this._services.filter[this.mode])return!0;throw new Error("The current mode is invalid and does not support 6w filtering."+`Please define a "filter" service for "${this.mode}" mode.`)},parse(e,t){return t&&"filter"===t.serviceName&&this.mode&&!0===t.parse&&"function"!=typeof this._services[t.serviceName][this.mode].parse&&(t.parse=this._defaultParsingFn),this._parent.call(this,e,t)},sync(t,i,n){let o,s;n||(n={});const a=e.merge({},n.data);return"filter"===t?(this.checkIfModeAllowsFiltering(),s=this.setPageMode("start"),delete a.start,delete a.nresults,this.exaleadContentType&&(a.contentType=this.exaleadContentType),a.query=a.query||this.exaleadQuery||"#all",a.legacyFormat=r.requestLegacyFormatForExaleadSearches(),e.is(n.paramsMapping,"object")||e.is(this._services[t][this.mode].paramsMapping,"object")||(n.paramsMapping=this._defaultParamsMappingForSearch),n.data=a,o=this._parent(t,i,n),this.setPageMode(s)):o=this._parent(t,i,n),o},getTags(){return this.getAssociated("6wtags")},"onSync:filter":function(e,t,i){i=i||{};const n=this.getTags(),o={parse:!0,tagsWithSubjectURI:i.tagsWithSubjectURI,tagsWithoutSubjectURI:i.tagsWithoutSubjectURI};return n.reset(i&&i.data&&!1===i.data.with_synthesis?n.toJSON():t,o),this._parent(e,t,i)},"onError:filter":function(e,t,i){return this._parent(e,t,i)},"onSetAssociated:tags":function(){this.mode&&this._updateTagsMode(this,this.mode),this.addEvent("onModeChange",this._updateTagsMode)},onBrowserFilteringRequest(t){let i;return this.checkIfModeAllowsFiltering(),this.taggerFilters=t,this.exaleadFilters=null,e.is(t,"object")&&e.is(t.filteredSubjectList,"array")?this.filter(e=>(i=e.get("subject6wuri"))&&t.filteredSubjectList.indexOf(i)>=0):this.toArray()},getFilteringOptions(t,i,n){let o,s,a,l;const m=c.getInstance();function h(){let e;t={allfilters:l.getValue("tags")},n=n||{data:{}},l.getValue("query")?n.data.query=l.getValue("query"):n.data.query||(n.data.query="#all"),e=r.reformatFilters(t),n.data.query+=e.queryPart,i=e.refineParam}return e.is(window.widget)&&!i&&(l=window.widget,e.is(l.getAppName,"function")&&l.getAppName()===u.getMyCommunitiesAppKey()&&!1===l.getValue("persistNav")&&(""===l.getValue("tags")&&""===l.getValue("query")||(m.isFilterableContentListsContext()&&"community-collection"!==this.getCollectionName()?l.getValue("route")===m.getRoute()&&h():m.isCommunityListsContext()&&"community-collection"===this.getCollectionName()&&l.getValue("route")===m.getRoute()&&h()))),o=(a=e.merge({},n)).data||{},this.taggerFilters=t||null,this.exaleadFilters=i||null,this.exaleadQuery=o.query&&"*"!==o.query?o.query:"#all",a.reset=!0,e.is(i,"array")&&i.length>0||o.query?(o.query=this.exaleadQuery,s=this._getRemoteFilteringParams(t,i),e.merge(o,s||{}),this._removePages(1,!0),a.serviceName="filter"):(!0===this.fetchTagsSeparatelyOnRefresh&&this.addEvent("onSync:read",d),o=this._getRefreshParams("read")||{},a.serviceName="read"),a.data=o,a.ignoreCache=!0,a},onServerFilteringRequest(e,t,i){const n=this.getFilteringOptions(e,t,i);return n.data.with_synthesis=!0,a.getInstance().dispatchEvent("onServerFilteringRequest",[e,n]),this.fetchPage(1,n)}});return m}),define("DS/SwymUICore/script/feature/core/user/collection/user-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/core/user/model/user-model","DS/WebappsUtils/Console"],function(e,t,i,n){"use strict";return t.extend({_communityId:null,_tenantId:null,_filters:null,_usersOnly:null,_collectionName:"user-collection",_hasAPageBeenFetched:!1,_associations:{owned:{},authorized:{},networkGroupOwner:{Class:i},wedo:{}},_services:{read:{similaruserusingskill:{url:"api/skill/search",dataFn:function(e){return{keyword:e.keyword,exclude:e.exclude,page:this._currentPage,limit:this._limit}}},similaruserusinglanguage:{url:"api/SpokenLanguage/search",dataFn:function(e){return{keyword:e.keyword,exclude:e.exclude,page:this._currentPage,limit:this._limit}}},getpeoplefamiliartocurrentuser:{url:"api/Recommendation/getpeoplefamiliartocurrentuser",dataFn:function(e){return{idsToFilterArr:e&&e.idsToFilterArr?e.idsToFilterArr:[],mode:"offline",limit:this._limit,itemType:"User",maxNbOfCommonElements:"5"}},parse:function(e){var t=e&&e.hits;if(t)for(var i=0,n=t.length;i<n;i++)t[i].ID=t[i].id;else t=[];return t}},similaruserusinginterest:{url:"api/interest/search",dataFn:function(e){return{keyword:e.keyword,exclude:e.exclude,page:this._currentPage,limit:this._limit}}},getnetworkbyuser:{url:"api/network/getnetworkbyuser",dataFn:function(e){return{hash_key:e.hash_key,page:this._currentPage}},parse:function(e){return e.users},postProcess:function(e){this.groups=e.result.groups}},listbots:{url:"api/community/listmembers",dataFn:function(){return{community_id:this._communityId,limit:this._limit,member_type:"external_application_bot"}}},listmembers:{url:"api/community/listmembers",dataFn:function(t){var i,n,o;return!this._communityId&&(i=this.getAssociated("owned"))&&(this._communityId=i&&i.get("mid")),n=t&&e.is(t.displayTotalCount)?t.displayTotalCount:e.is(this._displayTotalCount)?this._displayTotalCount:!this._hasAPageBeenFetched,o=t&&t.hasOwnProperty("usersOnly")?t.usersOnly:this._usersOnly,{community_id:this._communityId,page:this._currentPage,limit:this._limit,filters:this._filters,member_type:!0===o?"tenant_user":void 0,displayTotalCount:n,as_admin:!!this.as_admin,order_by_last_member:!!this._orderByLastMember&&this._orderByLastMember}},postProcess:function(){!1===this._hasAPageBeenFetched&&(this._hasAPageBeenFetched=!0)}},getmysharedcontacts:{url:"api/network/getmysharedcontacts",dataFn:function(e){var t=null,i=null;if(e&&(i=e.hash_key||this.getNetworkGroupOwner().get("hash_key"),t=e.login||this.getNetworkGroupOwner().get("login")),!i&&!t)throw new Error("User hashkey and user login are missing!");return{hash_key:i,login:t}},parse:function(e){if(e)return e.users}},listtenantmoderators:{url:"api/user/listTenantModerators",dataFn:function(){return{acl:5,newcommunity:!0}}},getpathrelationshipfull:{url:"api/network/getpathrelationshipfull",dataFn:function(e){return{hash_key:e.hash_key}},parse:function(e){if(e&&e[0])return e[0]}},getauthorizedusers:{url:"api/WikiTree/getauthorizedusers",dataFn:function(e){return{id:this.getAssociated("authorized").get("mid"),community_id:e&&e.community_id?e.community_id:null,page:1,limit:999,start:0}},parse:function(e){return Array.isArray(e)&&e.forEach(function(e){!e.login&&e.username&&(e.login=e.username)}),e}},searchbyname:{url:"api/user/search",dataFn:function(t){return e.extend({limit:this._limit||10,start:0,community_id:this._communityId,locale:void 0,as_admin:!1},t)}}},filter:{listmembers:{url:"api/exalead/searchcommunitymembers",tagsWithoutSubjectURI:!0,dataFn:function(t){var i;return!this._communityId&&(i=this.getAssociated("owned"))&&(this._communityId=i&&i.get("mid")),e.extend(t||{},{idForCommunityMembers:this._communityId})}}}},groups:null,model:i,modes:["listbots","getpathrelationshipfull","getnetworkbyuser","listmembers","getmysharedcontacts","similaruserusingskill","similaruserusinglanguage","similaruserusinginterest","listtenantmoderators","getpeoplefamiliartocurrentuser","getauthorizedusers","searchbyname"],exaleadContentType:"user",init:function(t,i){return i&&(i.communityId&&(this._communityId=i.communityId),i.hasOwnProperty("usersOnly")&&(this._usersOnly=i.usersOnly),i.filters&&this.setFilters(i.filters),i.communityModel&&this.setAssociated("owned",i.communityModel),i.tenantId&&(this._tenantId=i.tenantId),e.is(i.displayTotalCount)&&(this._displayTotalCount=i.displayTotalCount),e.is(i.orderByLastMember)&&(this._orderByLastMember=i.orderByLastMember)),this._parent(t,i)},getFilters:function(){return this._filters},setFilters:function(e,t){this._filters=e,!0===t&&this.resetCollection(1)},getNetworkGroupOwner:function(){return this.getAssociated("networkGroupOwner")},parse:function(e,t){return"listmembers"===this.mode&&null===e.nb_result&&delete e.nb_result,this._parent.call(this,e,t)}})}),define("DS/SwymUICore/script/feature/core/network/model/network-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/core/group/collection/group-collection","DS/WebappsUtils/Console"],function(e,t,i,n,o,s){"use strict";return t.extend({_modelName:"network",_attributesMapping:{},_services:{read:{url:"api/network/getnetworkbyuser",dataFn:function(){return{hash_key:this.get("hash_key")}}}},defaults:{},_associations:{users:{Class:i,options:{mode:null,limit:10}},groups:{Class:o,options:{mode:null}},user:{Class:n}}})}),define("DS/SwymUICore/script/feature/community/community/model/community-model",["UWA/Core","UWA/Promise","DS/SwymUICore/script/lib/model/generic/6wtaggable-model","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/community/idea/model/idea-type-model","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/SwymUICore/script/feature/community/idea/collection/status-collection","DS/SwymUICore/script/lib/model/model-manager","DS/SwymUICore/script/lib/event-manager","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/utils/navigation","i18n!DS/SwymUICore/assets/nls/feature/community/community/model/community-model","DS/SwymUICore/script/lib/model/generic/subscribable","DS/SwymUICore/script/utils/app-navigation-state","DS/WebappsUtils/Console","DS/WAFData/WAFData","DS/SwymUICore/script/feature/core/config/bootstrap-model"],function(e,t,i,n,o,s,r,a,c,u,l,d,m,h,p,g,f,_){"use strict";var y=i.extend(h,{_modelName:"community",_asAdmin:!1,_attributesMapping:{community_id:"mid",creationDate:"creation_date",owner_hash_key:"owner->hash_key",user_id_hash_key:"owner->hash_key","user_id.hash_key":"owner->hash_key",hash_key:"owner->hash_key",name:"owner->nickname",nickname:"owner->nickname",user_name:"owner->nickname","user_id.nickname":"owner->nickname",owner_display_name:"owner->nickname",user_id_emplid:"owner->empl_id","user_id.email":"owner->email","user_id.first_name":"owner->first_name","user_id.last_name":"owner->last_name","user_id.login":"owner->login",user_picture_fingerprint:"owner->user_picture_fingerprint",userPictureUpdate:"owner->picture_update","user_id.picture_update":"owner->picture_update",user_picture_update:"owner->picture_update",owner_picture_update:"owner->picture_update",media_id:"thumbnail->mid",thumbnail_id:"thumbnail->mid",logo_media_id:"thumbnail->mid",uri:"subject6wuri",id:"mid",published:"crdate",updated:"update",displayName:"title",summary:"description",community_description:"description",username:"owner->login"},_services:{create:{url:"api/community/add",parse:function(e){var t={"this->getCurrentUserRights":3,qna_is_enabled:!0,qna_min_acl:2,ideation_is_enabled:!0,ideation_min_acl:2,survey_is_enabled:!0,survey_min_acl:2,wiki_is_enabled:!0,wiki_min_acl:2};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&!e[i]&&(e[i]=t[i]);return e}},read:{url:"api/community/get",dataFn:function(e){return{id:this.get("mid"),return_6wtags:!1,as_admin:!!e.as_admin&&e.as_admin||this._asAdmin}},parse:function(e){return e}},update:{url:"api/community/edit",paramsMapping:{mid:"community_id"},parse:function(e){return e.as_admin=null,e}},delete:{url:"api/community/disablecommunities",dataFn:function(){return{list_communities:this.get("mid")+":1"}}},getDerivedTypes:{method:"GET",urlFn:function(){return"api/v2/communities/"+this.get("mid")+"/derivedtypes"},parse:function(e){return{derivedTypes:e}}},"read-tags":{url:"api/community/get",dataFn:function(){return{id:this.get("mid"),return_6wtags:!0}},parse:function(e){return{tags6w:e.tags6w,tags6w_implicit:e.tags6w_implicit}}},transformToCommunity:{},follow:{url:"api/userPreferences/follow",dataFn:function(){return{id:this.get("mid"),model:"Community"}}},unfollow:{url:"api/userPreferences/unfollow",dataFn:function(){return{id:this.get("mid"),model:"Community"}}},contentHighlightMask:{},deletecurrentuserfromcommunity:{url:"api/community/deletercurrentuserfromcommunity",dataFn:function(){return{community_id:this.get("mid")}}},checktitleuniqueness:{url:"api/community/checktitleuniqueness",dataFn:function(){return{title:this.getChanges("title")}}},getidcardstats:{url:"api/community/idcardstats",dataFn:function(){return{id:this.get("mid")}}},setlogo:{url:"api/community/edit",dataFn:function(e){return e&&e.reset_to_default?{logo_media_uri:"",community_id:this.get("mid"),as_admin:!!e.as_admin&&e.as_admin||this._asAdmin}:{logo_type:e.logo_type||2,community_id:this.get("mid"),logo_media_uri:e.logo_media_uri,as_admin:!!e.as_admin&&e.as_admin||this._asAdmin}}},editmembers:{url:"api/community/editmembers",dataFn:function(e){return{community_id:this.get("mid"),settings_members:e.settings_members,as_admin:!!e.as_admin&&e.as_admin}}},changerolerequest:{url:"api/notification/changerolerequest",dataFn:function(e){return{community_id:this.get("mid"),message:e.message}}},addFavorite:{url:"api/favorites/communities",wrapData:!1,dataType:"json",method:"PATCH",dataFn:function(){return{external_id:this.get("mid"),position:this.get("position")}}},removeFavorite:{url:"api/favorites/communities",method:"DELETE",dataType:"json",wrapData:!1,dataFn:function(){return{external_id:this.get("mid")}}},createImportBatch:{url:"api/member/addbatch",dataType:"formData",dataFn:function(e){return e.fd}}},_associations:{owner:{Class:n},thumbnail:{Class:null},owners:{Class:r,oppositeRole:"owned",options:{mode:"listmembers",limit:9999,filters:[{type:"team_role_filter",values:3}]}},"possible-main-owners":{Class:r,oppositeRole:"owned",options:{mode:"listmembers",limit:9999,usersOnly:!0,filters:[{type:"team_role_filter",values:3}]}},bots:{Class:r,options:{mode:"listbots",limit:999}},members:{Class:r,options:{mode:"listmembers",limit:9999}},wiki:{Class:null}},HTML_ATTRIBUTES:["description"],defaults:{_containsContentUnreadByCurrentUser:void 0,isBlacklisted:!1,title:"",description:"",popup_members:"",mark:void 0,last_message:void 0,is_favorite:!1},isDirectMessage:function(){switch(this.get("community_type")){case"dm":return!0;case"community":return!1;default:return null}},isBusinessExperienceCommunity:function(){switch(this.get("community_be")){case!0:return!0;case!1:return!1;default:return null}},getMainOwner:function(){return this.getAssociated("owner")},getOwners:function(){return this.getAssociated("owners")},getPossibleMainOwners:function(){return this.getAssociated("possible-main-owners")},getMembers:function(){return this.getAssociated("members")},_buildContentHighlightMaskUrl:function(){return"api/community/"+this.get("mid")+"/user/hiddenHlContent"},createImportBatch:function(e){return this.action("createImportBatch",e)},_resultIsMaskHighlighted:"",isContentHighlightHidden:l.debounce(function(e){var t;return""===this._resultIsMaskHighlighted?t=this.action("contentHighlightMask",{wrapdData:!1,method:"GET",url:this._buildContentHighlightMaskUrl(),onComplete:function(t,i){this._resultIsMaskHighlighted=i,e.onComplete.apply(this,arguments)}.bind(this),onFailure:function(){}}):e.onComplete(this,this._resultIsMaskHighlighted),t},300),hideContentHighlight:function(e){return this.action("contentHighlightMask",{wrapdData:!1,method:"POST",url:this._buildContentHighlightMaskUrl(),onComplete:e.onComplete,onFailure:e.onFailure})},isDMTransformationExpected:function(){return this.has("dmIdToBeTransformed")},isFavorite(){return this.get("is_favorite")},isBlacklisted(){return this.get("isBlacklisted")},addRemoveFavorite:function(e,t,i,n){var o=this;f.authenticatedRequest(t,{method:i,type:"json",headers:{Accept:"application/json;charset=UTF-8","Content-Type":"application/json;charset=UTF-8","X-DS-CSRFTOKEN":e},data:JSON.stringify(n),timeout:"30000",onComplete:function(){},onFailure:function(e,s){"ERROR_ACCESS_FORBIDDEN_CSRF_KO"==s.errorcode&&window.require(["DS/Bookmark/script/BookmarkManager"],function(e){const s=_.getInstance().get("config").tenant.online_instance_id;e.addEventOnce("onReady",function(){const s=e._csrfToken;o.addRemoveFavorite(s,t,i,n)}),e.setConfig({platformId:s})})}})},updateFavorite:function(e,t){var i,n,o=this;const s=this.get("subject6wuri"),r="community"===this.get("community_type")?"community":"dm",a={subject_uri:s,service_name:"3DSwym",type:r,position:t};e?(o.set({is_favorite:!0,position:t||"null"}),i="PATCH"):(o.set("is_favorite",!1),i="DELETE"),window.require(["DS/Bookmark/script/BookmarkManager"],function(t){const c=t._csrfToken;let u=t._serviceUrl+"/api/favorites";n=e?u:u+"/"+encodeURIComponent(s)+"/service_name/3DSwym/type/"+r,o.addRemoveFavorite(c,n,i,a)})},destroy:function(e){return this.action("delete",e)},checktitleuniqueness:function(e){return this.action("checktitleuniqueness",e)},getidcardstats:function(e){return this.action("getidcardstats",e)},follow:function(e){return this.action("follow",e)},save:function(e,t){return this.has("dmIdToBeTransformed")&&"community"===this.getModelName()?this.action("transformToCommunity",{url:"api/community/dmToCommunity/"+this.get("dmIdToBeTransformed"),dataType:"json",method:"POST",dataFn:function(){return{hash_key:this.getChanges("hash_key"),title:this.getChanges("title"),description:this.getChanges("description")}},onComplete:function(){this.isDMTransformationExpected()&&(p.saveDM(""),this.unset("dmIdToBeTransformed")),t.onComplete(this)}.bind(this),onFailure:t.onFailure}):this._parent.apply(this,arguments)},unfollow:function(e){return this.action("unfollow",e)},deletecurrentuserfromcommunity:function(e){return this.action("deletecurrentuserfromcommunity",e)},changerolerequest:function(e){return this.action("changerolerequest",e)},getCommunityType:function(e){return this.action("getCommunityType",e)},fetchTags:function(e){return this.action("read-tags",e)},validateField:function(e,t){switch(e){case"title":return t&&""!==t.trim()?t.length>255&&"err-length":"err-empty";case"description":return(!t||""===t.trim())&&"err-empty";default:return!1}},getUserRole:function(){return this.has("this")&&this.get("this").getCurrentUserRights?parseInt(this.get("this").getCurrentUserRights,10):this.get("user_access")?parseInt(this.get("user_access"),10):this.get("access")?parseInt(this.get("access"),10):void 0},getCommunityLogoUrl:function(e){var t="thumb",i="m_thumb";return e&&(e.type&&(t=e.type),e.key&&(i=e.key)),l.getBaseUrl()+"/api/media/getcommunitylogo/community_id/"+this.get("mid")+"/type/"+t+"/key/"+i+"/"+new Date(this.get("update")).getTime()},hasDefaultLogo:function(){var e=this.get("thumbnail->mid");return 2!==parseInt(this.get("logo"),10)&&(!e||"0"===e)},derivedTypesListAvailable:function(){var e=this.get("derivedTypes"),t=!1;return Array.isArray(e)&&(t=!0),t},getDerivedTypesList:function(){var e=[],t=this.get("derivedTypes");return t&&t.length>0&&(e=t.map(e=>e.id)),e},canCreateDerivedType:function(e){var t=!1;const i=this.get("derivedTypes").find(t=>t.id===e);return i&&i.acl&&!0===i.acl.create&&(t=!0),t},creationRightsAvailable:function(){var e=!1;return this.has("this")&&this.get("this").getCurrentUserRights&&this.has("qna_is_enabled")&&this.has("qna_min_acl")&&this.has("ideation_is_enabled")&&this.has("ideation_min_acl")&&this.has("wiki_is_enabled")&&this.has("wiki_min_acl")&&this.has("survey_is_enabled")&&this.has("survey_min_acl")&&(e=!0),e},canCreateMessages:function(){return this.get("instant_message_is_enabled")},canCreatePosts:function(){var e=!1;return this.has("this")&&this.get("this").getCurrentUserRights&&parseInt(this.get("this").getCurrentUserRights,10)>=parseInt(this.get("post_min_acl"),10)&&(e=!0),e},canCreateMedia:function(){var e,t=!1;return this.has("this")&&this.get("this").getCurrentUserRights?e=parseInt(this.get("this").getCurrentUserRights,10):this.has("user_access")&&(e=parseInt(this.get("user_access"))),e&&e>=2&&(t=!0),t},canCreateWedo:function(){var e,t=!1;return this.has("this")&&this.get("this").getCurrentUserRights&&this.has("wedo_is_enabled")&&this.has("wedo_min_acl")&&(e=parseInt(this.get("this").getCurrentUserRights,10),!0===this.get("wedo_is_enabled")&&e>=parseInt(this.get("wedo_min_acl"),10)&&(t=!0)),t},canCreateSocialEvent:function(){var e,t=!1;return this.has("this")&&this.get("this").getCurrentUserRights&&this.has("conference_is_enabled")&&this.has("conference_min_acl")&&(e=parseInt(this.get("this").getCurrentUserRights,10),!0===this.get("conference_is_enabled")&&e>=parseInt(this.get("conference_min_acl"),10)&&(t=!0)),t},canViewSocialEvent:function(){var e=!1;return l.isBetaFeatureActivated("rdv")&&(e=!0),e},canCreateQuestions:function(){var e,t=!1;return this.has("this")&&this.get("this").getCurrentUserRights&&this.has("qna_is_enabled")&&this.has("qna_min_acl")&&(e=parseInt(this.get("this").getCurrentUserRights,10),!0===this.get("qna_is_enabled")&&e>=parseInt(this.get("qna_min_acl"),10)&&(t=!0)),t},canCreateIdeas:function(){var e,t=!1;return this.has("this")&&this.get("this").getCurrentUserRights&&this.has("ideation_is_enabled")&&this.has("ideation_min_acl")&&(e=parseInt(this.get("this").getCurrentUserRights,10),!0===this.get("ideation_is_enabled")&&e>=parseInt(this.get("ideation_min_acl"),10)&&(t=!0)),t},canCreateWikiPages:function(){var e,t=!1;return this.has("this")&&this.get("this").getCurrentUserRights&&this.has("wiki_is_enabled")&&this.has("wiki_min_acl")&&(e=parseInt(this.get("this").getCurrentUserRights,10),!0===this.get("wiki_is_enabled")&&e>=parseInt(this.get("wiki_min_acl"),10)&&(t=!0)),t},canReorganizeWikiPages:function(){var e,t=!1;return this.has("this")&&this.get("this").getCurrentUserRights&&this.has("wiki_is_enabled")&&this.has("wiki_min_acl")&&(e=parseInt(this.get("this").getCurrentUserRights,10),!0===this.get("wiki_is_enabled")&&e>=parseInt(this.get("wiki_min_acl"),10)&&e>=3&&(t=!0)),t},canCreateSurveys:function(){var e,t=!1;return this.has("this")&&this.get("this").getCurrentUserRights&&this.has("survey_is_enabled")&&this.has("survey_min_acl")&&(e=parseInt(this.get("this").getCurrentUserRights,10),!0===this.get("survey_is_enabled")&&e>=parseInt(this.get("survey_min_acl"),10)&&(t=!0)),t},isCommunityFeaturesAccessAvailable:function(){var e=!1;return this.has("this")&&this.get("this").getCurrentUserRights&&this.has("wiki_is_enabled")&&this.has("wiki_min_acl")&&this.has("ideation_is_enabled")&&this.has("ideation_min_acl")&&this.has("survey_is_enabled")&&this.has("survey_min_acl")&&this.has("qna_is_enabled")&&this.has("qna_min_acl")&&(e=!0),e},getCommunityFeaturesAccess:function(){var e,t,i,n,o,s=!1,r=!1,a=!1,c=!1,u=!1,l=!1;return this.has("this")&&this.get("this").getCurrentUserRights&&this.has("wiki_is_enabled")&&this.has("wiki_min_acl")&&this.has("ideation_is_enabled")&&this.has("ideation_min_acl")&&this.has("survey_is_enabled")&&this.has("survey_min_acl")&&this.has("qna_is_enabled")&&this.has("qna_min_acl")&&(e=parseInt(this.get("this").getCurrentUserRights,10),t=this.get("wiki_is_enabled"),i=this.get("ideation_is_enabled"),n=this.get("survey_is_enabled"),!0===this.get("qna_is_enabled")&&(s=!0),!0===t&&(r=!0),!0===i&&(a=!0),!0===n&&(c=!0),4!==(o=parseInt(this.get("stats_min_acl"),10))&&o<=e&&(u=!0),e>=3&&(l=!0)),{qna_feature:s,wiki_feature:r,ideation_feature:a,survey_feature:c,stats_feature:u,settings_feature:l}},isContributorCreationEnabledInSettings:function(e,t){var i=!1;return!0===e&&1===t&&(i=!0),i},isIdeationContributorCreationEnabledInSettings:function(e,t){return this.isContributorCreationEnabledInSettings(e,t)},isSurveyContributorCreationEnabledInSettings:function(e,t){return this.isContributorCreationEnabledInSettings(e,t)},isWedoContributorCreationEnabledInSettings:function(e,t){return this.isContributorCreationEnabledInSettings(e,t)},isConferenceContributorCreationEnabledInSettings:function(e,t){return this.isContributorCreationEnabledInSettings(e,t)},getRelativePath:function(){var e=this.get("mid");return e||g.log("exception : there is no ID community defined !!!"),("community"===this.get("community_type")?d.URLPART_COMMUNITY:d.URLPART_DM)+e},getRelativePathToStats:function(){var e=this.get("mid");return e||g.log("exception : there is no ID community defined !!!"),d.URLPART_COMMUNITY+e+d.URLTAB_STATS},getRelativePathToSettings:function(){var e=this.get("mid");return e||g.log("exception : there is no ID community defined !!!"),d.URLPART_COMMUNITY+e+d.URLTAB_SETTINGS},getRelativePathToMedia:function(){var e=this.get("mid");return e||g.log("exception : there is no ID community defined !!!"),d.URLPART_COMMUNITY+e+d.URLTAB_MEDIA},getRelativePathToIdeations:function(){var e=this.get("mid");return e||g.log("exception : there is no ID community defined !!!"),d.URLPART_COMMUNITY+e+d.URLTAB_IDEATION},getRelativePathToIquestions:function(){var e=this.get("mid");return e||g.log("exception : there is no ID community defined !!!"),d.URLPART_COMMUNITY+e+d.URLTAB_IQUESTIONS},getRelativePathToWiki:function(){var e=this.get("mid");return e||g.log("exception : there is no ID community defined !!!"),d.URLPART_COMMUNITY+e+d.URLTAB_WIKI},getRelativePathToSurveys:function(){var e=this.get("mid");return e||g.log("exception : there is no ID community defined !!!"),d.URLPART_COMMUNITY+e+d.URLTAB_SURVEYS},getRelativePathToMembers:function(){var e=this.get("mid"),t=this.isDirectMessage()?d.URLPART_DM:d.URLPART_COMMUNITY;return e||g.log("exception : there is no ID community defined !!!"),t+e+d.URLTAB_MEMBERS},getTranslatedRole:function(){var e=this.get("role")?this.get("role"):this.getUserRole();if(3===e||"Owner"===e||"Co-Owner"==e){var t=this.getMainOwner(),i=s.getInstance().get("login");t.get("login")===i&&(e="MainOwner")}switch(e){case"Super Admin":case 4:e=m.SuperAdmin;break;case"MainOwner":e=m.Mainowner;break;case"Co-Owner":case"Owner":case 3:e=m.Owner;break;case"Author":case 2:e=m.Author;break;case"Contributor":case 1:e=m.Contributor;break;default:e=m.None}return e},getDeleteRight:function(){var e=null,t=s.getInstance().get("tenant_user_status"),i=s.getInstance().get("login"),n=!0;return e="0"==t?this.get("access"):this.get("extranet_access"),"None"!=this.get("role")&&i!=this.get("UserLogin")&&1!=e&&i!=this.getMainOwner().get("login")||(n=!1),n},getVisibility:function(){var t;switch(1===parseInt(s.getInstance().get("tenant_user_status"),10)?(t=this.get("extranet_access"),e.is(t)||(t=this.get("community_extranet_access"))):(t=this.get("access"),e.is(t)||(t=this.get("community_intranet_access"))),t){case 0:case"0":case"Private":return m.Private;case 1:case"1":case"Public":return m.Public;case 4:case"4":case"Secret":return m.Secret;default:return"Unknown"}},hasCurrentUserAccess:function(){var t,i=this.get("user_access");return e.is(i)?t=0!==parseInt(i,10):(t=this.get("hasUserAccess"),e.is(t,"boolean")||(t=null)),t},setUserAccess:function(e){e=!0===e?1:0,this.set("user_access",e)},setup:function(t){return e.is(t.asAdmin)&&(this._asAdmin=t.asAdmin),this._parent.apply(this,t)},getSubjectURI:function(){var e=this.getSixwURIs();if(e.length<1)throw new Error("The object does not have any subjecturi!");return e[0]},getMark:function(){return this.get("mark")},hasUnreadContent:function(){return this.get("_containsContentUnreadByCurrentUser")},getLastUnreadContentSummary:function(){var t=this.get("last_message")&&this.get("last_message").message_details;if(t&&t.media_type)return'<span class="fonticon fonticon-'+l.getMediaIconName(t.media_type)+'"></span><span>'+m.Media+"</span>";if(t&&"Comment"===t.model){const i=e.createElement("div",{html:t.model_content}),n=i.getElement("img");if(n&&""===i.getText().trim())return'<span class="fonticon fonticon-'+l.getMediaIconName("picture")+'"></span><span>'+m.Media+"</span>";if(n)return i.getText()}return t&&(t.content||t.title&&t.title.escapeHTML()||t.model_content)},updateUnreadContentStatus:function(){var e=this.get("mark"),t=void 0,i=this.get("_containsContentUnreadByCurrentUser"),n=this.get("last_message"),o=s.getInstance().get("login"),r=n&&n.author&&n.author.login;i!==(t=!(!n||!n.message_id||e&&e.message_id&&(e.message_id===n.message_id||o===r)))&&(this.set("_containsContentUnreadByCurrentUser",t),u.dispatchEvent("onThreadUnreadStatusChange",[this,t,n]))},canSupportTemplate:function(){return!!(this.canCreatePosts()||this.canCreateIdeas()||this.canCreateQuestions())},"onSync:read":function(){var e=this;window.ds&&!0===window.ds.swymIM&&require(["DS/SwymUICore/script/feature/core/context/context-model"],function(t){t.getInstance().isCommunityContext();e.get("mid")})},"onSync:subscribe":function(){require(["DS/UWPClientControls/PlatformNotify"],function(e){e.success(m.SubscribeSuccess)})},"onError:subscribe":function(){require(["DS/UWPClientControls/PlatformNotify"],function(e){e.error(m.SubscribeFailure)})},"onSync:unsubscribe":function(){require(["DS/UWPClientControls/PlatformNotify"],function(e){e.success(m.UnsubscribeSuccess)})},"onError:unsubscribe":function(){require(["DS/UWPClientControls/PlatformNotify"],function(e){e.error(m.UnsubscribeFailure)})},"onError:createImportBatch":function(){require(["DS/UWPClientControls/PlatformNotify"],function(e){e.error(m.BatchError)})},"onChange:mark":function(){this.updateUnreadContentStatus()},"onChange:last_message":function(){this.updateUnreadContentStatus()}});return y.COMMUNITY_SUPERUSER_ROLE=4,y.COMMUNITY_OWNER_ROLE=3,y.COMMUNITY_AUTHOR_ROLE=2,y.COMMUNITY_CONTRIBUTOR_ROLE=1,y.FEATURE_ENABLED=1,y.FEATURE_CREATION_CONTRIBUTORS_ENABLED=1,y.DIRECT_MESSAGE_PREFIX="DM-",require(["DS/SwymUICore/script/feature/community/media/model/media-model"],function(e){y.prototype._associations.thumbnail.Class=e}),y}),define("DS/SwymUICore/script/feature/core/stats/collection/stats-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/core/stats/model/pie-model","DS/SwymUICore/script/feature/core/stats/model/column-model","DS/SwymUICore/script/feature/core/stats/model/table-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/WebappsUtils/Console"],function(e,t,i,n,o,s,r){return t.extend({init:function(e,t){if((null===e||0===e.length)&&void 0!==t){var r=new Date,a=r.getFullYear()-1+"-"+(r.getMonth()+1<10?"0"+(r.getMonth()+1):r.getMonth()+1)+"-"+(r.getDate()<10?"0"+r.getDate():r.getDate()),c=r.getFullYear()+"-"+(r.getMonth()+1<10?"0"+(r.getMonth()+1):r.getMonth()+1)+"-"+(r.getDate()<10?"0"+r.getDate():r.getDate());(e=[new i(null,{pieType:"totalinteractions",communityId:t.community.get("mid"),title:"NumberOfContents",fromDate:a,toDate:c,tenantId:t.community.get("tenant_id"),asAdmin:t.asAdmin}),new i(null,{pieType:"totalusersperrole",communityId:t.community.get("mid"),title:"NumberOfUsersPerRole",fromDate:a,toDate:c,tenantId:t.community.get("tenant_id"),asAdmin:t.asAdmin}),new i(null,{pieType:"totalmediapertype",communityId:t.community.get("mid"),title:"MediaPerType",fromDate:a,toDate:c,tenantId:t.community.get("tenant_id"),asAdmin:t.asAdmin}),new n(null,{columnType:"rangeuservisits",communityId:t.community.get("mid"),title:"NumberOfVisits",fromDate:a,toDate:c,tenantId:t.community.get("tenant_id"),asAdmin:t.asAdmin}),new n(null,{columnType:"rangeposts",communityId:t.community.get("mid"),title:"NumberOfPosts",fromDate:a,toDate:c,tenantId:t.community.get("tenant_id"),asAdmin:t.asAdmin}),new n(null,{columnType:"rangemessages",communityId:t.community.get("mid"),title:"NumberOfMessages",fromDate:a,toDate:c,tenantId:t.community.get("tenant_id"),asAdmin:t.asAdmin})]).push(new n(null,{columnType:"rangecontent",communityId:t.community.get("mid"),title:"NumberOfContentsPerDay",fromDate:a,toDate:c,tenantId:t.community.get("tenant_id"),asAdmin:t.asAdmin})),e.push(new o(null,{tableType:"communityinfo",communityId:t.community.get("mid"),title:"CommunityInfo",fromDate:a,toDate:c,tenantId:t.community.get("tenant_id"),asAdmin:t.asAdmin})),e.push(new o(null,{tableType:"mostviewedposts",communityId:t.community.get("mid"),title:"MostReadPosts",fromDate:a,toDate:c,tenantId:t.community.get("tenant_id"),asAdmin:t.asAdmin})),e.push(new o(null,{tableType:"mostreadcontributors",communityId:t.community.get("mid"),title:"MostReadContributors",fromDate:a,toDate:c,tenantId:t.community.get("tenant_id"),asAdmin:t.asAdmin})),e.push(new s({id:t.community.get("mid"),asAdmin:t.asAdmin}))}return this._parent(e,t)},fetch:function(){this._models.forEach(function(e){"community"!==e.getModelName()&&e.fetch({},{as_admin:e._asAdmin})})},updateModels:function(e,t){var i;this._models.forEach(function(n){i=n.getModelName(),null!==e?("community"===i&&n.set("fromDate",e),n._fromDate=e):null!==t&&("community"===i&&n.set("toDate",t),n._toDate=t)}),this.fetch()}})}),define("DS/SwymUICore/script/utils/link-builder-utils",["UWA/Core","UWA/Class/Events","UWA/Event","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/Logger/Logger"],function(e,t,i,n,o,s,r,a){var c="generated",u="a.s6m-tag-link[data-predicate]",l="a[data-users-group-uri]",d="a[data-login]",m="drives";function h(e,t){e.setAttribute("href",t),e.dataset.link=c}function p(e){var t=e.srcElement||e.target,i=t&&t.getAttribute("data-content-id");o.in3DSwym()?h(t,o.URLPART_COMMUNITY+i):h(t,n.getMyCommunitiesAppUrl({community:i,url:n.getBaseUrl()}))}function g(e){var t=e.srcElement||e.target,i=t&&t.getAttribute("data-content-id");o.in3DSwym()?h(t,o.URLPART_DM+i):h(t,n.getMyCommunitiesAppUrl({dm:i,url:n.getBaseUrl()}))}function f(e){var t=e._uwaTarget||e.target||e.srcElement,i=t&&t.getAttribute("data-content-id"),s=t&&t.getAttribute("data-content-type"),a=t&&t.getAttribute("data-community-id"),c=t&&t.getAttribute("data-dm-id"),u=new r({mid:a||c}),l=c||u.isDirectMessage()?"dm":null;s&&(o.in3DSwym()?h(t,o.getContentURLForSwym(i,s,c||a,!1,l)):h(t,n.getMyCommunitiesAppUrl({appId:n.getMyCommunitiesAppKey(),community:a,contentType:s,contentId:i})))}function _(e){var t=y(e),i=e.srcElement||e.target;t.anonymous||(o.in3DSwym()?h(i,o.URLPART_PEOPLE+(t.hash_key||t.login)+o.PROFILE_FACET_MAPPING[t.facet]):h(i,n.getProfileAppUrl({login:t.login||"",hash_key:t.hash_key||"",facet:t.facet||"0"})))}function y(e){var t={anonymous:!1},n=e.srcElement||e.target,o=i.getElement(e);return n&&n.dataset&&(t.hash_key=n.dataset.hashKey,t.login=n.dataset.login,t.facet=n.dataset.facet),t.hash_key||t.login||!o.dataset||(t.hash_key=o.dataset.hashKey,t.login=o.dataset.login,t.facet=o.dataset.facet),t.facet||(t.facet="0"),t.login?"anonymous"!==t.login&&0!==t.login.indexOf("_ANONYMISED_")||(t.anonymous=!0):t.hash_key||a.error("no login nor hash_key defined, please provide at least one to get a working navigation system"),t}function w(e){if(!0!==e.ctrlKey){a.log("click on link user model"),E(e);var t=y(e);t.anonymous||o.goToProfile(t)}}function C(e){if(!0!==e.ctrlKey){var t=i.getElement(e);const n=e.target.getClosest(".tile-action-menu"),s=e.target.getClosest(".tile-menu");E(e),!t||n||s||o.goToCommunity(t.getAttribute("data-content-id"))}}function S(e){var t=e.target.getClosest(".tile-action-menu");const n=e.target.getClosest(".tile-menu");if(!0!==e.ctrlKey){var s=i.getElement(e);E(e),!s||t||n||o.goToDM(s.getAttribute("data-content-id"))}}function I(t){const n=i.getElement(t);n.getParent(".content-editor-view-container")||require(["DS/SwymUICore/script/feature/core/history/history-model","DS/SwymUICore/script/lib/6wpanel/community-tags-manager","DS/SwymUICore/script/utils/usage-tracker"],function(t,i,r){var a={},c=s.getInstance(),u=t.getStateListing(),l=(c.isInTemporaryState()?c.getData():u&&u.previousContext)||{};const{tagValue:d}=n.dataset,m=null==d?n.getText():d;a[n.dataset.predicate]=[{object:i.getFilterDescription(m),type:"string"}],!c.isCommunityContext()||c.isContentContext()&&l.contentId||c.contentId&&("home"===l.path||!l.path)?o.goTo3DSwymHomePage({tagNavigatorFilteringOptions:{filter:a,replace:!0}}):o.goToCommunity(c.communityId,void 0,void 0,e.is(c.dmId),{tagNavigatorFilteringOptions:{filter:a,replace:!0}});const h=i.getInstance();h.getCommunitySubjectURI({communityId:c.communityId}).then(e=>h.getTagsForHeaders({communitySubjectURI:e,existingTags:[{object:i.getFilterDescription(m),sixw:n.dataset.predicate}],dontSetTags:!0})).then(e=>{e.length?r.trackPageEvent({category:"CommunityTags",label:"selectInlineCommunityTagInContentDisplay",view:"content-detailed-view",event:"click"}):r.trackPageEvent({category:"CommunityTags",label:"selectInlineTagInContentDisplay",view:"content-detailed-view",event:"click"})}).catch(()=>{r.trackPageEvent({category:"CommunityTags",label:"selectInlineTagInContentDisplay",view:"content-detailed-view",event:"click"})})})}function v(e){E(e),i.getElement(e).destroy()}function T(t){if((o.in3DD()||o.inMobile())&&!0!==t.ctrlKey){var n=i.getElement(t);if(n&&e.is(n.href,"string")&&n.href.startsWith("blob:"))return;e.is(n.dataset.type,"string")&&"internal"===n.dataset.type||e.is(n.dataset.contentType,"string")?E(t):e.is(n.href,"string")&&(n.href.startsWith("http://")||n.href.startsWith("https://"))&&!n.href.contains(document.URL)&&-1===n.href.indexOf(m)&&(window.open(n.href,"_blank"),E(t))}}function E(e){e.preventDefault(),e.stopPropagation()}return t.singleton({activateLink:t=>(function(t){var i={};i["click a"]=T,i['click *[data-content-type="person"]:not([data-is-link="false"])']=w,i['mouseover a[data-content-type="person"]:not([data-is-link="false"])']=_,i['click *[data-content-type="community"][data-content-id]:not([data-is-link="false"])']=C,i['mouseover a[data-content-type="community"][data-content-id]:not([data-is-link="false"])']=p,i['click *[data-content-type="direct-message"][data-content-id]:not([data-is-link="false"])']=S,i['mouseover a[data-content-type="direct-message"][data-content-id]:not([data-is-link="false"])']=g,i[`click .content-editor-view-container ${u}`]=v,i[`click ${u}`]=I,e.extendElement(t).addEvents(i,!1,1)})(t),displayProfile:w,onContentClick:function(e){var t,n,s,a,c,m,h=!1,p=e.target&&e.target.getParents();if(!0!==e.ctrlKey){for(m in p)Object.prototype.hasOwnProperty.call(p,m)&&p[m].hasClassName&&p[m].hasClassName("content-edition")&&(h=!0);if(!h){var g=i.getElement(e),f="true"===g.getAttribute("data-edition-mode");E(e),!g||e.target.match(u)||e.target.match(d)||e.target.match(l)||("wiki"===g.getAttribute("data-content-type")?require(["DS/SwymUICore/script/feature/core/config/bootstrap-model"],function(e){!1===e.getInstance().isFeatureActivated("active_wiki")?require(["DS/UWPClientControls/PlatformNotify","i18n!DS/SwymUICore/assets/nls/utils/link-builder-utils"],function(e,t){e.warn(t.Sorrythewikifeatureisnotcurrentlyavailable)}):(n=g.getAttribute("data-community-id"),s=g.getAttribute("data-dm-id"),t=new r({mid:s||n}),o.goToContent(g.getAttribute("data-content-id"),g.getAttribute("data-content-type"),n||s,f,void 0,void 0,Boolean(s)||t.isDirectMessage()))}):(n=g.getAttribute("data-community-id"),s=g.getAttribute("data-dm-id"),t=new r({mid:s||n}),a=g.getAttribute("data-content-type"),c=g.getAttribute("data-content-id"),"instantmessage"===a?s?o.goToDM(s,void 0,void 0,{messageUuid:c}):o.goToCommunity(n,void 0,void 0,!1,{messageUuid:c}):o.goToContent(c,a,n||s,f,void 0,void 0,Boolean(s)||t.isDirectMessage())))}}},displayContentHREF:f,blockEventPropagation:E,addHREFToLinks(e){var t,i,o,s;if(!0===n.getClientInformation().isIos){for(o=e.getElements('a[data-content-id]:not([data-content-type="community"]):not([data-is-link="false"])'),s=e.getElements('a[data-content-type="community"][data-content-id]:not([data-is-link="false"])'),t=0,i=o.length;t<i;t++)f({target:o[t]});for(t=0,i=s.length;t<i;t++)p({target:o[t]})}}}).init()}),define("DS/SwymUICore/script/feature/core/user/collection/user-and-users-group-collection",["UWA/Core","UWA/Json","UWA/Array","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/core/user/model/users-group-model","DS/SwymUICore/script/feature/core/user/model/bot-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/UWPClientCode/I18n"],function(e,t,i,n,o,s,r,a,c,u){"use strict";var l=n.getInstance(),d=function(t,i){var n,o=e.clone(t,!1);switch(t.member_type){case"users_group":n=r;break;case"tenant_user":n=s;break;case"external_application_bot":n=a;break;default:switch(t["ds6w:what/ds6w:type"]){case"Group":n=r;break;case"pno:Person":default:n=s}}return e.extend(o,o.details),delete o.member_type,delete o.details,new n(o,i)},m=o.extend({_collectionName:"user-and-users-group-collection",model:d,_services:{read:{searchbyname:{method:"POST",url:"search",noCsrfToken:!0,wrapData:!1,dataFn:function(e){var t=new c({id:this._communityId});return{source:e.disableUserGroup?["swym"]:["usersgroup","swym"],specific_source_parameter:{usersgroup:{additional_query:" AND ([ds6w:label]:("+e.query.trim()+'*) OR [ds6w:label]:"'+e.query.trim()+'")'},swym:{additional_query:" AND personOrGroup:("+e.query+")",containerUid:t.get("subject6wuri")}},order_by:"desc",order_field:"relevance",locale:u.getCurrentLanguage()||"en",tenant:l.get("config").tenant.online_instance_id,start:0,nresults:this._limit||10,select_predicate:["ds6w:label","ds6w:type","ds6w:role","ds6w:resourceUid"],label:"3DSwym-"+l.get("user").login+"-"+(new Date).getTime(),query:e.disableUserGroup?'[ds6w:type]:("pno:Person")':'[ds6w:type]:("foaf:Group" OR "pno:Person")',with_synthesis_attribute:!1,with_synthesis:!1}},parse:function(e){return i.isArray(e&&e.results)?e.results.reduce(function(e,t){var n={},o=null,s=i.detect(t.attributes,function(e){if("ds6w:label"===e.name){if(o=e,!e.value)return!0;n.ds6w_58_label=e.value}n[e.name]=e.value});return o&&!s&&e.push(n),e},[]):[]}}}},modes:["searchbyname","listmembers"],sync:function(){var e=this,t=arguments,i=this._parent;if("searchbyname"!==e.mode)return this.urlRoot="",i.apply(e,t);require(["DS/SwymUICore/script/utils/compass-proxy"],function(n){n.getServiceUrl({serviceName:"3DSearch",platformId:l.get("config").tenant.online_instance_id,onComplete:function(n){if(n&&"string"==typeof n)return e.urlRoot=n,i.apply(e,t);throw new Error("Fedsearch server could not be found!")},onFailure:function(){throw new Error("Fedsearch server could not be found!")}})})}});return d.prototype.idAttribute="id",m}),define("DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model",["UWA/Core","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/app-navigation-state","DS/SwymUICore/script/utils/utils","DS/WebappsUtils/Console"],(e,t,i,n,o,s,r,a)=>{let c=15;const u=t.extend({_attributesMapping:{"ds6w:label":"topic",subject6wuri:"subject6wuri"},_modelName:"dm",defaults:{this:{getCurrentUserRights:2}},_associations:{users:{Class:i,oppositeRole:"owned",options:{mode:"listmembers",limit:20}},community:{Class:t}},_services:{create:{url:"api/directmessages",method:"POST",wrapData:!1,dataFn(){const t=this.getChanges("topic"),i={users:e.merge(this.getChanges("users"),this.get("users"))};return t&&(i.topic=t),i},parse:e=>e},addFavorite:{url:"api/favorites/directmessages",wrapData:!1,dataType:"json",method:"PATCH",dataFn(){return{external_id:this.get("mid"),position:this.get("position")}}},read:{urlFn(){return`api/directmessages/${this.get("mid")}`},method:"GET",data:{}},removeFavorite:{url:"api/favorites/directmessages",method:"DELETE",dataType:"json",wrapData:!1,dataFn(){return{external_id:this.get("mid")}}},delete:{method:"PATCH",dataType:"json",wrapData:!1,dataFn:()=>({hide:!0})},hide:{method:"PATCH",dataType:"json",wrapData:!1,dataFn:()=>({hide:!0})},unhide:{method:"PATCH",dataType:"json",wrapData:!1,dataFn:()=>({hide:!1})},editmembers:{urlFn(){return`api/directmessages/editmembers/${this.get("mid")}`},wrapData:!1,dataType:"json",method:"PATCH",dataFn:e=>({member_ids:e.users})},removemembers:{urlFn(){return`api/directmessages/removemembers/${this.get("mid")}`},wrapData:!1,dataType:"json",method:"PATCH",dataFn:e=>({member_ids:e.users})},addmembers:{urlFn(){return`api/directmessages/addmembers/${this.get("mid")}`},wrapData:!1,dataType:"json",method:"PATCH",dataFn:e=>({member_ids:e.users})},setTopic:{}},setTopic(e){return this.action("setTopic",{url:`api/directmessages/settopic/${this.get("mid")}`,wrapData:!1,dataType:"json",method:"PATCH",dataFn:()=>({topic:e.topic}),onComplete:e.onComplete,onFailure:e.onFailure})},setPersistency(e){return this.action("setPersistency",{url:`api/directmessages/setpersistency/${this.get("mid")}`,wrapData:!1,dataType:"json",method:"PATCH",dataFn:()=>({is_persistent:e.isPersistent}),onComplete:e.onComplete,onFailure:e.onFailure})},canCreateSocialEvent:()=>!!r.isBetaFeatureActivated("rdvInConversation"),canViewSocialEvent:()=>!!r.isBetaFeatureActivated("rdvInConversation"),"onChange:mid":function(){this.setAssociated("community",new t({mid:this.get("mid")}))},"onSetAssociated:community":function(t,i,n){this.listenTo(n,"onSync:read",function(){this.set(e.merge(this.toJSON(),n.toJSON()))})},"onSync:read":function(){const t=this.getAssociated("community");t.set(e.merge(t.toJSON(),this.toJSON())),this._parent.apply(this,arguments)},destroy(e){return e.url=`api/directmessages/${this.get("mid")}`,this._parent.call(this,e)},hide(e){return this.set("is_hidden",!0),this.set("is_favorite",!1),e.url=`api/directmessages/${this.get("mid")}`,s.getLastDM()===this.get("mid")&&s.saveDM(""),this.action("hide",e)},unhide(e){return this.set("is_hidden",!1),this.set("is_favorite",!1),e.url=`api/directmessages/${this.get("mid")}`,s.saveDM(this.get("mid")),this.action("unhide",e)},isHidden(){return this.get("is_hidden")},validateField:()=>!1,getRelativePath(){let e;const t=this.get("mid");return t||a.log("exception : there is no ID DM defined !!!"),e=n.URLPART_DM+t},getConsolidatedTitle(){const{login:e}=o.getInstance().get("user");return this.get("topic")?this.get("topic"):this.getMembersTitle(e)},getMembersTitle(e){let t="";const i=this.getAssociated("users").filter(t=>t.get("login")!==e),n=i.length;let o,s;if(1===n)t=i[0].getNickname();else for(let e=0,r=Math.min(7,n);e<r;e++)s=e!==r-1?", ":"",t+=(o=i[e]).getNickname()+s;return t}});return o.getInstance().executeWhenReady(()=>{const{max_number_conversation_members:e}=o.getInstance().get("config").tenant;e&&(c=e)}),u.MAX_NB_USERS_IN_DM=c,u.DM_TYPE_PRIVATE="private",u.DM_TYPE_GROUP="group",u});__awaiter=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,s){function r(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,a)}c((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){var i,n,o,s,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,n=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(o=(o=r.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){r=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){r.label=s[1];break}if(6===s[0]&&r.label<o[1]){r.label=o[1],o=s;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(s);break}o[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],n=0}finally{i=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};define("DS/SwymUICore/script/feature/core/edit-info/edit-info-manager",["require","exports","DS/SwymUICore/script/feature/core/edit-info/model/edit-info-model","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/lib/model/model-manager","DS/UIKIT/SuperModal","DS/UWPClientControls/PlatformNotify","DS/SwymUICore/script/utils/date","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/utils/usage-tracker","i18n!DS/SwymUICore/assets/nls/feature/core/edit-info/edit-info-manager"],function(e,t,i,n,o,s,r,a,c,u,l,d,m){"use strict";var h;Object.defineProperty(t,"__esModule",{value:!0}),t.showConcurrentEditionModal=t.unlockContentForEdit=t.isContentLockedForEdit=t.removeEditInfo=t.getEditInfo=t.directlyAccessedWikis=void 0,function(e){e.FETCH="read",e.REMOVE="delete"}(h||(h={}));var p,g=new Map,f=null;t.directlyAccessedWikis=new Set;var _=function(e){var t=u.convertDate(e.modification_date).valueOf();return Date.now()-t<p},y=function(e,t){return new Promise(function(i,n){e.action(t||h.FETCH,{onComplete:i,onFailure:n,onTimeout:n})})},w=function(e){if(!g.has(e)){var t=new i({mid:e},{});g.set(e,t)}return g.get(e)};t.getEditInfo=function(e){return __awaiter(void 0,void 0,void 0,function(){var t;return __generator(this,function(i){switch(i.label){case 0:return t=w(e),[4,y(t)];case 1:return i.sent(),[2,t]}})})};t.removeEditInfo=function(e){return __awaiter(void 0,void 0,void 0,function(){var t;return __generator(this,function(i){switch(i.label){case 0:t=w(e),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,y(t,h.REMOVE)];case 2:return i.sent(),[3,4];case 3:return i.sent(),console.error("REMOVAL OF EDIT INFO FAILED"),[2,!1];case 4:return[2,!0]}})})};t.isContentLockedForEdit=function(e){return __awaiter(void 0,void 0,void 0,function(){var i,o,s,r,a,c;return __generator(this,function(u){switch(u.label){case 0:return u.trys.push([0,4,,5]),l.isFeatureActivated("activateWikiLock")?[4,__awaiter(void 0,void 0,void 0,function(){var e,t;return __generator(this,function(i){switch(i.label){case 0:if(void 0!==p)return[2];e=120,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,l.getCustomWikiLockDuration()];case 2:return e=i.sent(),[3,4];case 3:return t=i.sent(),console.error(t),[3,4];case 4:return p=60*e*1e3,[2]}})})]:[2,[]];case 1:return u.sent(),[4,new Promise(function(e){n.getInstanceFetched(e)})];case 2:return i=u.sent(),[4,(0,t.getEditInfo)(e)];case 3:return o=u.sent(),s=o.get("editors"),(r=(s||[]).filter(_))&&r.length?(a=r.filter(function(e){return e.author.get("login")!==i.get("login")}),c=r.find(function(e){return e.author.get("login")===i.get("login")}),[2,a.length&&!c?a:[]]):[2,[]];case 4:return u.sent(),[2,[]];case 5:return[2]}})})};t.unlockContentForEdit=function(e){return __awaiter(void 0,void 0,void 0,function(){return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),l.isFeatureActivated("activateWikiLock")?[4,(0,t.removeEditInfo)(e)]:[2,!0];case 1:return i.sent()?(g.delete(e),[2,!0]):[2,!1];case 2:return i.sent(),[2,!1];case 3:return[2]}})})};var C=function(e){s.in3DSwym()?window.open("".concat(s.URLPART_DM).concat(e),"_blank"):s.showTransientWidget(l.getMyCommunitiesAppKey(),"",{community:e,dm:e,route:"dm:".concat(e),url:l.getBaseUrl()})},S=function(e){return e?'<a \n    data-content-type="person"\n    data-hash-key="'.concat(e.get("hash_key"),'"\n    data-login="').concat(e.get("login"),'"\n    data-is-link="false"\n    target="_blank"\n    href="').concat((t=e.get("login"),i=e.get("hash_key"),s.in3DSwym()?"".concat(s.URLPART_PEOPLE).concat(i||t):l.getProfileAppUrl({login:t||"",hash_key:i||"",facet:"0"})),'"\n  >').concat(e.getNickname()||[e.get("first_name"),e.get("last_name")].join(" "),"</a>"):"some user";var t,i};t.showConcurrentEditionModal=function(e,t){if(void 0===t&&(t={}),f||(f=new a({className:"wiki-lock-supermodal"})),!e){var i=t.users&&t.users[0]?t.users[0].author:void 0;f.dialog({title:m.get("PageEditionNotAllowed"),body:{tag:"p",html:m.replace(m.get("YouCannotEditThisPage"),{user:S(i)})},buttons:[{className:"primary",value:m.get("Ok"),action:function(e){e.hide()}},{className:"contact-editor-btn default pull-left",icon:"chat-alt",value:m.replace(m.get("ContactUser"),{user:"".concat(i.getNickname()||[i.get("first_name"),i.get("last_name")].join(" "))}),action:function(){var e;e=i,new o({},{}).save("users",[e.get("login")],{onComplete:function(e){C(e.get("mid"));var t=new o(e.toJSON(),{});r.notify("onCreate",t)},onFailure:function(e,t){if(t&&t.result&&t.result.id){C(t.result.id);var i=new o(t.result,{});return i.set("is_hidden",!1),void r.notify("onCreate",i)}console.error(e,t),c.error(m.get("AnErrorOccurred"))}})}}]});var n=function(e){var t=e.target;if(t&&"A"===t.tagName&&t.dataset.login){e.preventDefault();var n=i.get("login"),o=i.get("hash_key");if(s.in3DSwym())window.open("".concat(s.URLPART_PEOPLE).concat(o||n),"_blank");else{var r={url:l.getBaseUrl(),facet:"0"};n?r.login=n:r.hash_key=o,s.showTransientWidget(l.getProfileAppKey(),"",r)}}};document.body.addEventListener("click",n),f.onHide=function(){document.body.removeEventListener("click",n),t.onHide&&t.onHide(),d.trackPageEvent({category:"WikiLockConcurrentEdition",label:"wikiLockPopupDisplayed",view:t.view||"edit-info-manager",event:"click"})}}}}),define("DS/SwymUICore/script/lib/model/generic/community-content",["require","exports","UWA/Core","UWA/Utils","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/lib/model/generic/6wtaggable-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/lib/model/model-manager","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/lib/6wpanel/utils","DS/SwymUICore/script/lib/model/generic/subscribable","DS/SwymUICore/script/feature/container/container-utils"],function(e,t,i,n,o,s,r,a,c,u,l,d,m,h,p){"use strict";function g(e){var t=e.get("update");t&&e.getCommunity().set("update",t)}var f=s.extend(h,{_iconCls:null,_iconWrapperCls:null,getIconClass:function(){return this._iconCls},getIconWrapperClass:function(){return this._iconWrapperCls},getContentType:function(){return this.getModelName()},_attributesMapping:{model_id:"mid",hash_key:"author->hash_key",user_hash_key:"author->hash_key",user_id_hash_key:"author->hash_key","user_id.hash_key":"author->hash_key",user_id_emplid:"author->empl_id",owner_hashkey:"author->hash_key","user.hash_key":"author->hash_key",emplid:"author->empl_id","user_id.emplid":"author->emplid",user_id:"author->mid","user_id.accept_share_info":"author->accept_share_info","user_id.email":"author->email",username:"author->login",first_namdatee:"author->first_name",last_name:"author->last_name","user_id.first_name":"author->first_name","user_id.last_name":"author->last_name",user_first_name:"author->first_name",user_last_name:"author->last_name","dskern:owner->foaf:firstName":"author->first_name","dskern:owner->foaf:lastName":"author->last_name","dskern:owner->foaf:givenName":"author->first_name","dskern:owner->foaf:familyName":"author->last_name",nickname:"author->nickname",user_name:"author->nickname","user_id.nickname":"author->nickname",name:"author->nickname",user_nickname:"author->nickname",owner_nickname:"author->nickname",owner_name:"author->nickname","user.nickname":"author->nickname","user_id.address":"author->address","user_id.city":"author->city","user_id.company":"author->company","user_id.country":"author->country","user_id.job_title":"author->job_title",user_picture_update:"author->picture_update",userPictureUpdate:"author->picture_update","user_id.picture_update":"author->picture_update","user.picture_update":"author->picture_update",user_picture_fingerprint:"author->user_picture_fingerprint",stats_nb_endorse:"nb_endorse",nb_endorsements:"nb_endorse",comment_count:"nb_comments",count_comment:"nb_comments",stats_comments:"nb_comments",stats_viewed:"nb_views",stats_nb_rates:"nb_rates",published_date:"publish_date",community_id:"community->mid",community_title:"community->title",communityTitle:"community->title",ds6w_58_community:"community->title",text:"summary",ds6w_58_description:"summary","this->getSummary":"summary",media_id:"thumbnail->mid",thumbnail_id:"thumbnail->mid",first_media_id:"thumbnail->mid","this->getFirstMediaId":"thumbnail->mid",preview_fingerprint:"thumbnail->preview_fingerprint",preview_media_type:"thumbnail->media_type",preview_media_file_ext:"thumbnail->media_file_ext",preview_original_width:"thumbnail->width",preview_original_height:"thumbnail->height",preview_media_id:"thumbnail->mid",preview_media_processing_version:"thumbnail->processing_version",preview_media_processing_status:"thumbnail->status",_community:"community",container:"community",actor:"author",target:"community",id:"mid",objectType:"type",updated:"update",displayName:"title",forwarded_from:"originalAuthor"},_prevNextId:null,_associations:{author:{Class:c},community:{Class:r},thumbnail:{},originalAuthor:{Class:c}},_services:{getpreviousandnextcontent:{url:"api/community/getpreviousandnextcontent",dataFn:function(){return{model:"idea"===this.getModelName()?"ideation":this.getModelName(),model_id:this.get("mid"),community_id:this.get("community->mid")}}},forwardToThread:{wrapData:!1,urlFn:function(){var e=this.getModelName();return"api/".concat(e="iquestion"===e?"question":e,"/forward")},dataFn:function(e){return{community_uri:e.threadUri,content_uri:this.get("subject6wuri"),target_uri:e.target}}},forwardPermissions:{method:"GET",wrapData:!1,urlFn:function(e){var t=this.getModelName();return"api/".concat(t="iquestion"===t?"question":t,"/forward/permissions?content_uri=").concat(encodeURIComponent(this.get("subject6wuri")),"&community_uri=").concat(encodeURIComponent(e&&e.threadUri))}}},HTML_ATTRIBUTES:["content"],defaults:{title:"",description:"",content:"",summary:"",stats_rating:0,nb_rates:0,nb_endorse:0,nb_comments:0,nb_views:0,crdate:"",update:"",_acl:{update:{privilege:null,access:!1},delete:{privilege:null,access:!1}},originalAuthor:{}},_getNbCommentsFromCommentCollection:function(){var e=this._associations&&this._associations.comments&&this._associations.comments.associated;return!(!e||!e.hasBeenFetched())&&e.filterDeletedAndStatusRelatedComments().length},_recomputeNbCommentsIfNeeded:function(){var e=this._getNbCommentsFromCommentCollection();if(!1!==e)return this.set("nb_comments",e)},canUpdate:function(){var e=this.get("_acl");return e&&e.update&&e.update.access},canDelete:function(){var e=this.get("_acl");return e&&e.delete&&e.delete.access},init:function(e,t){return this._prevNextId={status:o.STATUS.notRequested},this._parent(e,t)},hasFirstMedia:function(){var e=this.getThumbnail()&&this.getThumbnail().get("mid")?this.getThumbnail().get("mid"):null;return null!=e},getNbComments:function(){var e=this._getNbCommentsFromCommentCollection();return!1!==e?e:this.get("nb_comments")},create:function(e){if(this.get("community->mid"))return this._parent(e);throw new Error("Community id is not available. Please populate this instance first.")},validateField:function(e,t){switch(e){case"title":return t&&""!==t.trim()?t.length>255&&"err-length":"err-empty";case"content":return(!t||""===t.trim())&&"err-empty";default:return!1}},getRelativePath:function(e,t,i){return e||!(e=this.get("community->mid"))&&this.get("community")&&(e=this.get("community").mid||this.get("community").id),t||(t=this.get("mid")),"string"!=typeof i&&(i="/".concat(this._modelName,":"),"idea"===this._modelName&&(i=d.URLCONTENT_IDEATION)),d.URLPART_COMMUNITY+e+i+t},save:function(e,t,o){var s,r,a,c=this,l={},d=!1;if(!e||i.is(e,"object")?(l=e||{},o=t||{}):(l[e]=t,o=o||{}),i.merge(l,this._changes),this.isNew()&&void 0===this.get("published")&&this.set("published",0),this.isNew()&&!this.get("X-Request-ID")){var m=n.getUUID();this.set("X-Request-ID",m),o.headers||(o.headers={}),o.headers["X-Request-ID"]=m}switch(1!==l.published&&1!==parseInt(this.get("published"),10)&&(o.validate=!1),o.notify){case"draft":(this.isNew()||this.has("published")&&0===parseInt(this.get("published"),10))&&(s="onDraftCreation");break;case"publish":0===parseInt(this.get("published"),10)&&(s="onPublishing")}return s&&window.ds&&!0===window.ds.swymIM&&"onPublishing"===s&&(e.author&&c.set("author",e.author),e.community_id&&c.set("community_id",e.community_id),c.set("published",e.published),c.set("enhanced_summary",e.content),c.addChanges(e,{force:!0}),o.force=!0,(!e.visibility||0!==parseInt(e.visibility,10)&&2!==parseInt(e.visibility,10))&&u.notify("onPrePublishing",[c])),r=o.onComplete,o.onComplete=function(e,t,i){var n;"function"==typeof r&&r(e,t,i),s&&(u.notify(s,[c]),e.dispatchEvent(s)),!0===d&&t&&Array.isArray(t.sourceInfos)&&(n=t.sourceInfos.find(function(e){if("6WTags"===e.name)return!0}))&&!1===n.status&&window.require(["DS/UWPClientControls/PlatformNotify","i18n!DS/SwymUICore/assets/nls/lib/model/generic/community-content"],function(e,t){e.warn(t.get("TheListOfTagsOnThisContentCouldNotBeUpdated"))})},o.data=o.data||{},(a=this.getCommunity()).has("mid")&&this.addChanges("community_id",a.get("mid")),this.addChanges(l),this.deriveTagActionsFromContentChanges(this.get("content"),l.content,{onTagDeletionOptions:{showAlertIfTagAlsoPresentInBody:!1}}),d=this.hasVirtuallyChanged("tags6w"),this._parent(e,t,o)},onTagDeletion:function(e,t,i){var n,o=this._parent.apply(this,arguments);return!0===t||!o||i&&!0===i.showAlertIfTagAlsoPresentInBody||(n=this.hasVirtuallyChanged("content")?this.getChanges("content"):this.get("content"),m.get6WTagsFromHTML(n)["".concat(e.predicate,"/").concat(e.object)]&&window.require(["DS/UWPClientControls/PlatformNotify","i18n!DS/SwymUICore/assets/nls/lib/model/generic/community-content"],function(e,t){e.warn(t.get("TheRemovedTagIsAlsoPresentInTheContentBody"))})),o},destroy:function(e){var t=this,i=e&&e.onComplete;return e||(e={}),e.onComplete=function(e,n,o){"function"==typeof i&&i(e,n,o),u.notify("onDestroy",[t]),e.dispatchEvent("onDestroy")},this._parent(e)},getCommunity:function(){var e=this.getAssociated("community");if(e.get("mid")){var t=new a({mid:e.get("mid")},{});t.has("subject6wuri")&&e.set("subject6wuri",t.get("subject6wuri"))}return e},getAuthor:function(){return this.getAssociated("author")},getThumbnail:function(){return this.getAssociated("thumbnail")},getPreviousAndNextContent:function(e){return this.action("getpreviousandnextcontent",e)},"onSync:create":function(){return g(this),this.populateEmbeddedMediaAssociation(),this._parent.apply(this,arguments)},"onSync:update":function(){return g(this),this.updateContainedMedia(),this.setCustomProperty("edited",!0),this.populateEmbeddedMediaAssociation(),this._parent.apply(this,arguments)},populateEmbeddedMediaAssociation:function(){var e=this.get("thumbnails_infos");Array.isArray(e)&&e.length>0&&this.getAssociated("embeddedMedia")},hasEmbeddedMedia:function(){var e=this.get("thumbnails_infos");return!!(Array.isArray(e)&&e.length>0)},"onSync:read":function(){if(i.is(this.model)){var e=this.model.getAssociated("comments");e.hasBeenFetched()&&this.set("nb_comments",e.filterDeletedAndStatusRelatedComments(e.toJSON()).length)}return this.populateEmbeddedMediaAssociation(),this._parent.apply(this,arguments)},getContainedMediaIds:function(){return l.getContainedMediaIds(this.has("content")?this.get("content"):"")},getDeletedContainedMediaIds:function(){var e=this;return this.getContainedMediaIds().reduce(function(t,i){return l.hasMediaBeenDeleted(i,e.get("thumbnails_infos"),e.get("content")||"")&&t.push(i),t},[])},updateContainedMedia:function(){if(1===parseInt(this.get("published"))){var e=this.getContainedMediaIds();window.require(["DS/SwymUICore/script/feature/community/media/model/media-model"],function(t){e.forEach(function(e){new t({id:e}).set("published","1")})})}},"onSetAssociated:comments":function(e,t,i){return this.listenTo(i,"onCollectionChange",this._recomputeNbCommentsIfNeeded),this._parent.apply(this,arguments)},"onChange:nb_comments":function(){this._recomputeNbCommentsIfNeeded()},onDestroy:function(){return this.set("_deleted",!0),this._parent.apply(this,arguments)},getPublishingDate:function(){return this.get("pubdate")||this.get("publish_date")||this.get("creation_date")},getSubjectURI:function(){var e=this.getSixwURIs();if(e.length<1)throw new Error("The object does not have any subjecturi!");return e[0]},"onSync:subscribe":function(){window.require(["DS/UWPClientControls/PlatformNotify","i18n!DS/SwymUICore/assets/nls/lib/model/generic/community-content"],function(e,t){e.success(t.SubscribeSuccess)})},"onError:subscribe":function(){window.require(["DS/UWPClientControls/PlatformNotify","i18n!DS/SwymUICore/assets/nls/lib/model/generic/community-content"],function(e,t){e.error(t.SubscribeFailure)})},"onSync:unsubscribe":function(){window.require(["DS/UWPClientControls/PlatformNotify","i18n!DS/SwymUICore/assets/nls/lib/model/generic/community-content"],function(e,t){e.success(t.UnsubscribeSuccess)})},"onError:unsubscribe":function(){window.require(["DS/UWPClientControls/PlatformNotify","i18n!DS/SwymUICore/assets/nls/lib/model/generic/community-content"],function(e,t){e.error(t.UnsubscribeFailure)})},getSource:function(){return this.get("sourceid")},getContainerType:function(){var e=this.getSource();return p.getContainerTypeFromSource(e)},forwardToThread:function(e){return this.action("forwardToThread",e)},forwardPermissions:function(e){return this.action("forwardPermissions",e)},getThreadType:function(){return this.getAssociated("community").get("community_type")},getThreadId:function(){return this.getAssociated("community").get("mid")}}),_=f.extend({_attributesMapping:{"ds6w:label":"title","ds6w:who/ds6w:responsible":"author->nickname","ds6w:responsible":"author->nickname","ds6w:responsibleUid":"author->login","ds6w:snippet":"description","ds6w:description":"enhanced_summary","ds6w:what/ds6w:docExtension":"media_file_ext","ds6w:docExtension":"media_file_ext","ds6w:when/ds6w:created":"publish_date","ds6w:created":"publish_date",resourceid:"subject6wuri","ds6w:where/ds6w:context/ds6w:community":"community->title"}});return window.ds&&window.ds.isMDE?_:f}),define("DS/SwymUICore/script/feature/community/media/model/media-model",["require","exports","UWA/Core","UWA/Data","UWA/Json","UWA/Promise","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/utils/date","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/feature/community/comment/collection/comment-collection","DS/SwymUICore/script/feature/core/user/collection/commenters-collection","DS/SwymUICore/script/utils/utils","DS/Logger/Logger","DS/WAFData/WAFData","DS/SwymUICore/script/feature/container/container-utils","DS/SwymUICore/script/lib/model/model-manager","i18n!DS/SwymUICore/assets/nls/feature/community/media/model/media-model","DS/SwymUICore/script/utils/platform-utils"],function(e,t,i,n,o,s,r,a,c,u,l,d,m,h,p,g,f,_){"use strict";var y=["sldasm"],w=window.ds&&"MOBILE"===window.ds.env,C={DIMENSIONS:{M1:520,L1:960,XL1:1920},KEY:{M1:"m1",L1:"l1",XL1:"xl1",O1:"o1"},TYPE:1},S={OK:"processed",KO:"error",NOT_PROCESSED:"non-processed",READY:"ready-to-process"},I=["simxml","json","3dxml","3dxm","sdm","str","smg","3dskt","3dsto","dsxm","3dsim","3dwb","svg","udl"],v=["onTimeOut","onUploadProgress"],T=["create","update","patch"],E={mid:"id_media",content:"description"},b={content:"description","community->mid":"community_id"},U=function(e,t,i){var n={status:null},o=t.getCustomProperty("uploadRequest"),s=i.onComplete,a=i.onFailure;!o||o&&o.status!==r.STATUS.pending?(n.status=r.STATUS.pending,t.setCustomProperty("uploadRequest",n),i.onComplete=function(){t.getCustomProperty("uploadRequest").status=r.STATUS.valid,"function"==typeof s&&s.apply(t,arguments)},i.onFailure=function(){t.getCustomProperty("uploadRequest").status=r.STATUS.invalid,"function"==typeof a&&a.apply(t,arguments)}):m.log("An upload is already in progress")},D=c.extend({_modelName:"media",_tableName:"Media",_iconWrapperCls:"media",getIconClass:function(){return d.getMediaIconName(this)},_uploadRequest:{status:r.STATUS.notRequested,file:null},mediaFileAttribute:"userFile",_attributesMapping:{id_media:"mid",media_id:"mid",model_id:"mid",description:"content",MediaType:"media_type",preview_fingerprint:"preview_fingerprint",preview_media_type:"media_type",preview_media_file_ext:"media_file_ext",preview_original_width:"width",preview_original_height:"height",preview_media_id:"mid",preview_media_processing_version:"processing_version",preview_media_processing_status:"status"},_associations:{comments:{Class:u,oppositeRole:"commented",options:{mode:"media"}},commenters:{Class:l,oppositeRole:"commented",options:{mode:"comment"}}},_services:{create:{url:"api/media/addmedia",dataType:"formData",timeout:432e5,dataFn:function(e){var t,n,s,r,a,c,u,l,d,m=["fileName","userFile","community_id","title"],h=this.getChanges()||{},p=new FormData;for(e||(e={}),n=0,s=(t=Object.keys(h)).length;n<s;n++)r=t[n],e.hasOwnProperty(r)||(e[r]=h[r]);for(n=0,s=m.length;n<s;n++){var g=m[n];if(!h.hasOwnProperty(g)&&!e.hasOwnProperty(g))if(this.has(g))e[g]=this.get(g).trim?this.get(g).trim():this.get(g);else{if("community_id"!==g||!this.has("community->mid"))throw new Error("The "+g+" is necessary to create a media");e.community_id=this.get("community->mid")}}for(e.hasOwnProperty("is_illustration")||(e.is_illustration=!0),e.hasOwnProperty("published")||(e.published=0),t=Object.keys(e),a=Object.keys(b),n=0,s=t.length;n<s;n++)if("userFile"===(r=t[n]))if((u=e.userFile)instanceof File)p.append(r,e[r]);else if(i.is(u,"string")&&(l=u.split(","))){if(d=null,"data:image/png;base64"===l[0]?d=e.fileName.split(".")[0]+".png":"data:image/jpeg;base64"===l[0]?d=e.fileName.split(".")[0]+".jpeg":"data:application/vndopenxmlformats-officedocumentwordprocessingmldocument;base64"===l[0]?d=e.fileName.split(".")[0]+".docx":"data:application/vndopenxmlformats-officedocumentpresentationmlpresentation;base64"===l[0]?d=e.fileName.split(".")[0]+".pptx":"data:application/vndopenxmlformats-officedocumentspreadsheetmlsheet;base64"===l[0]&&(d=e.fileName.split(".")[0]+".xlsx"),d){var f={type:l[0],"Content-Transfer-Encoding":"base64"};u=new Blob([l[1]],f),p.append("userFile",u,d),p.append("base64_encoded","1")}}else u instanceof Blob&&(u.fileName?p.append("userFile",u,u.fileName):e.fileName?
//! add information of the media type of the userfile for the BE. For now it is useful for SwymRequestor used by Sketch team
p.append("userFile",u,e.fileName):p.append("userFile",u));else c=e[r],(i.is(c,"object")||i.is(c,"array"))&&(c=o.encode(c)),a.indexOf(r)>=0?p.append(b[r],c):p.append(r,c);return p},parse:function(e){var t,i;if(e&&e.mediaUploaded){for(t in i=e.mediaUploaded)i.hasOwnProperty(t)&&(e[t]=i[t]);delete e.mediaUploaded}return e}},read:{url:"api/media/getmedia",dataFn:function(){return{id_media:this.get("mid"),detailedInfos:!0}}},update:{url:"api/media/editmedia",dataType:"formData",timeout:432e5,dataFn:function(e){var t,n,s,r,a,c,u,l,d,m=this.getChanges()||{},h=new FormData;for(e||(e={}),n=0,s=(t=Object.keys(m)).length;n<s;n++)r=t[n],e.hasOwnProperty(r)||(e[r]=m[r]);for(t=Object.keys(e),a=Object.keys(E),n=0,s=t.length;n<s;n++)if("userFile"===(r=t[n])){if((u=e.userFile)instanceof File)h.append(r,e[r]);else if(u instanceof Blob)u.lastModifiedDate=new Date,u.name=this.get("orig_name"),h.append(r,u,u.name);else if(i.is(u,"string")&&(l=u.split(","))&&(d=null,"data:image/png;base64"===l[0]?d=this.get("orig_name").split(".")[0]+".png":"data:image/jpeg;base64"===l[0]&&(d=this.get("orig_name").split(".")[0]+".jpeg"),d)){var p={type:l[0],"Content-Transfer-Encoding":"base64"};u=new Blob([l[1]],p),h.append("userFile",u,d),h.append("base64_encoded","1")}}else c=e[r],(i.is(c,"object")||i.is(c,"array"))&&(c=o.encode(c)),a.indexOf(r)>=0?h.append(E[r],c):h.append(r,c);return h}},delete:{url:"api/media/deletemedia",dataFn:function(){return{id:this.get("community->mid"),com_id:this.get("community->mid"),id_media:this.get("mid"),med_type:this.get("media_type")}}},deleteContribution:{url:"api/community/deletecontribution",dataFn:function(){return{mediaIds:[this.get("mid")],community_id:this.get("community->mid")||this.get("community").mid||this.get("community").id}}},remove:{url:"api/community/deletecontribution",dataFn:function(){return{ids:[this.get("mid")],community_id:this.get("community->mid")}}},reprocess:{url:"/api/media/restartprocessing",dataFn:function(){return{id_media:this.get("mid")}}}},defaults:{published:0,category_id:0,download_original_file:0,processing_version:0},init:function(){this._parent.apply(this,arguments),this._addFakeDimIfNecessary(),this._whiteListPDFFiles(),this.setupPictureviewConfig()},_addFakeDimIfNecessary:function(){!this.is3DStoExtension()||0!==this.get("height")&&0!==this.get("width")||(this.set("height",292),this.set("width",520))},_whiteListPDFFiles:function(){"document"===this.get("media_type")&&"error"===this.get("status")&&("pdf"===this.get("media_file_ext")||this.get("fileName")&&this.get("fileName").endsWith(".pdf"))&&(this.set("height",240),this.set("width",320),this.set("status","processed"))},hasExtensionType:function(e){return this.get("format_3dsa")===e||this.get("media_file_ext")===e||this.get("fileName")&&this.get("fileName").endsWith("."+e)||this.get("orig_name")&&this.get("orig_name").endsWith("."+e)},hasFirstMedia:function(){return!1},onSync:function(){this._parent.apply(this,arguments),this.setupPictureviewConfig()},setupPictureviewConfig:function(){if(1===parseInt(this.get("processing_version"),10)&&!this.get("pictureviewConfig")){var e,t,i={o1:null,m1:null,l1:null,xl1:null},n=C,o=n.DIMENSIONS.M1,s=n.DIMENSIONS.L1,r=n.DIMENSIONS.XL1,a=parseInt(this.get("preview_original_height"),10)||parseInt(this.get("height"),10),c=parseInt(this.get("preview_original_width"),10)||parseInt(this.get("width"),10),u=c/a;(e="landscape"===(t=c>=a?"landscape":"portrait")?c:a)<=r&&(i.o1={width:c,height:a}),e>o&&(i.m1="landscape"===t?{width:o,height:o/u}:{width:o*u,height:o}),e>s&&(i.l1="landscape"===t?{width:s,height:s/u}:{width:s*u,height:s}),e>r&&(i.xl1="landscape"===t?{width:r,height:r/u}:{width:r*u,height:r}),this.set("pictureviewConfig",i)}},sync:function(e,t,i){T.indexOf(e)>=0&&(v.forEach(function(e){!function(e,t,i){var n=i[t];i[t]=function(){"function"==typeof n&&n.apply(e,arguments),e.dispatchEvent(t,arguments),T.indexOf(i.serviceName)>=0&&e.dispatchEvent(t+":"+i.serviceName,arguments)}}(t,e,i)}),U(0,t,i)),this._parent.apply(this,arguments)},isMediaAPlayableGIF:function(){var e=this.get("media_type"),t=this.get("play");return"animatedPicture"===e&&t&&t.av_streams&&t.av_streams.length>0},is3DSketchExtension:function(){return"3dskt"===this.getFileExtension()},is3DStoExtension:function(){return"3dsto"===this.getFileExtension()},is3DWhiteboardExtension:function(){return"3dwb"===this.getFileExtension()},isDocumentOfficeExtension:function(){return["docx","doc","xlsx","xls","ppt","pptx","csv"].includes(this.getFileExtension())},isPDFExtension:function(){return"pdf"===this.getFileExtension()},isSolidworksFileExtension:function(){var e=this.getFileExtension();return y.includes(e.toLowerCase())},isDownloadDefaultBehaviour:function(){var e="document"===this.get("media_type");return this&&(this.isDocumentOfficeExtension()&&!d.isFeatureActivated("activateODEViewer")||e&&!this.isDocumentOfficeExtension()&&!this.isPDFExtension())},addDownloadableFilesFormat:function(){var e=this.getFileExtension();y.push(e.toLowerCase())},validateField:function(e,t){switch(e){case"title":case"content":return!1;default:return this._parent(e,t)}},getCommenters:function(){return this.getAssociated("commenters")},getComments:function(){return this.getAssociated("comments")},getFileExtension:function(){var e="",t=this.get("userFile");return i.is(this.get("media_file_ext"))?e=this.get("media_file_ext"):i.is(this.get("play"))?e=this.get("play").download_original_url.format:t&&t.fileName&&t.fileName.match(/.pdf$/i)&&(e="pdf"),e},addComment:function(e){try{this.getAssociated("comments").addComment(e)}catch(e){m.log("exception:",e)}},remove:function(e){return this.action("remove",e)},reprocess:function(e){var t=this;return this.action("reprocess",{onComplete:function(){t.set("status",S.READY);var i=a.convertISODateIntoUsualDate((new Date).toISOString());t.set("update",i),window.require(["DS/UWPClientControls/PlatformNotify"],function(e){e.success(f.Themediaisbeingprocessed)}),e.onComplete&&e.onComplete()},onFailure:function(t){window.require(["DS/UWPClientControls/PlatformNotify"],function(e){var i=f.SorryAnerroroccuredwhileperformingthisaction;t&&"ERROR_ACCESS_DENIED"===t.errorcode&&(i=f.Onlysuperusersareauthorizedtoperformthisaction),e.error(i)}),e.onFailure&&e.onFailure()}})},deleteContribution:function(e){return this.action("deleteContribution",e)},getRssLink:function(e){return e||(e=10),"/rss/filter/feed/model/media/limit/"+e+"/community_id/"+this.getCommunity().get("mid")+"/model_id/"+this.get("mid")},isConsideredAsA360MediaModel:function(){var e=this.get("media_file_ext"),t="jpg"===e||"jpeg"===e||this.get("play")&&this.get("play").download_original_url&&("jpg"===this.get("play").download_original_url.format||"jpeg"===this.get("play").download_original_url.format);return"picture"===this.get("media_type")&&parseInt(this.get("width"),10)>500&&!0===t},isUploading:function(){var e=this.getCustomProperty("uploadRequest");return!(!e||e.status!==r.STATUS.pending)},publishFrom3DDriveToSwym:function(e){_.get3DDriveURL(this.get("envId"),function(t){t?_.get3DDriveCSRFToken(this.get("envId"),function(n){U(0,this,e),h.authenticatedRequest(t+"/resources/3ddrive/v1/bos/"+this.get("objectId")+"/publish?tenant="+this.get("envId"),{data:JSON.stringify({platformid:d.getBaseUrl(),communityid:this.getChanges("community_id")||this.getAssociated("community").get("mid"),isillustration:!i.is(this.getChanges("is_illustration"))||this.getChanges("is_illustration"),ispublished:"publish"===e.notify||"1"===this.getChanges("published")}),headers:{"X-DS-CSRFTOKEN":n,Accept:"application/json;charset=UTF-8","Content-Type":"application/json;charset=UTF-8"},type:"json",method:"POST",timeout:6e4,onComplete:function(t,i){var n,o;if((t=t.result)&&t.mediaUploaded){for(n in o=t.mediaUploaded)o.hasOwnProperty(n)&&(t[n]=o[n]);delete t.mediaUploaded}this.set(t),e.onComplete(),this.dispatchEvent("onSync:create",[this,t]),"publish"===e.notify&&g.notify("onPublishing",[this])}.bind(this),onFailure:function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];e.onFailure.apply(e,t),this.dispatchEvent("onError:create",[this])}.bind(this)})}.bind(this),function(){m.error("3DDrive CSRF token not found")}):m.error("envid or 3ddrive url is undefined")}.bind(this),function(){m.error("3DDRIVE url is undefined")})},isDriveFile:function(){return p.isDriveFile(this.get("ds6w:what/ds6w:type"))},isOfSource3DDrive:function(){return 0===this.get("sourceid").indexOf("drive:")},getDriveFileUrl:function(e){var t,i=this,n=i.get("drive_file_url");return n?t=new s(function(e,t){e(n)}):!1!==e&&(t=new s(function(e,t){window.require(["DS/My3DExpUICore/script/feature/drive/drive-file"],function(n){n.getDriveFileUrl(i.get("mid")).then(function(n){n?(i.set("drive_file_url",n),e(n)):t(n)})})})),t},updateContainedMedia:function(){},get3DFileURL:function(){var e,t=this.get("play")["3d_streams"]||this.get("play")["2d_streams"]||[],i="";if(window.ds&&!0===window.ds.isMDE&&this.isDriveFile())i=this.get("drive_file_url").unescapeHTML();else if(this.hasExtensionType("svg"))i=this.get("play").download_original_url&&this.get("play").download_original_url.transient_url;else{for(var n=0,o=t.length;n<o;n++)if(e=t[n],I.includes(e.format)){i=e.transient_url,console.log("streams file url - "+i);break}!i&&this.hasExtensionType("3dxml")&&(i=this.get("play").download_original_url&&this.get("play").download_original_url.transient_url)}return i},get3DFileFormat:function(){var e,t=this.get("play")["3d_streams"]||this.get("play")["2d_streams"]||[],i="";if(window.ds&&!0===window.ds.isMDE&&this.isDriveFile())e=this.get("media_file_ext");else{for(var n=0,o=t.length;n<o;n++)if(e=t[n],I.includes(e.format)){i=e.format;break}!i&&this.hasExtensionType("svg")&&(i=this.get("play")&&this.get("play").download_original_url.format),!i&&this.hasExtensionType("3dxml")&&(i=this.get("play")&&this.get("play").download_original_url.format)}return i}});return window.require(["DS/SwymUICore/script/feature/community/community/model/community-model"],function(e){D.prototype._associations.community.Class=e}),D.MEDIA_THUMBNAIL={DIMENSIONS:{SMALL:{WIDTH:66,HEIGHT:50},MEDIUM:{WIDTH:200,HEIGHT:150},LARGE:{WIDTH:320,HEIGHT:240},XLARGE:{WIDTH:520,HEIGHT:390}},KEY:{SMALL:13,MEDIUM:1,LARGE:2,XLARGE:16},TYPE:0},D.PICTUREVIEW_V0={DIMENSIONS:{SMALL:{WIDTH:320,HEIGHT:240},MEDIUM:{WIDTH:640,HEIGHT:480},LARGE:{WIDTH:960,HEIGHT:800}},KEY:{SMALL:17,MEDIUM:18,LARGE:19},TYPE:9},D.PICTUREVIEW_V1=C,D.MEDIA_PROCESSING_STATUS=S,D.constructThumbnailUrl=function(e,t,i,o){var s=d.getBaseUrl()+"/api/media/streammedia/"+("media"===e?"id/":"model/"+e+"/model_id/")+t+"/type/thumb/key/"+i;return o&&(s+="/update/"+o),w&&(s=n.proxifyUrl(s,{proxy:"passport"})),s},D.constructPictureViewUrl=function(e,t,i){var o=d.getBaseUrl()+"/api/media/streammedia/id/"+e+"/type/picture/key/"+t;return i?o+="/update/"+i:m.warn("No fingerprint provided for picture view url"),w&&(o=n.proxifyUrl(o,{proxy:"passport"})),o},D.constructSpriteUrl=function(e){return w&&(e=n.proxifyUrl(e,{proxy:"passport"})),e},D.constructGenericPreviewUrl=function(e){var t=e;return w&&(t=n.proxifyUrl(t,{proxy:"passport"})),t},D}),define("DS/SwymUICore/script/feature/core/sprite/sprite",["UWA/Core","UWA/Utils","UWA/Class","DS/SwymUICore/script/utils/date","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/feature/community/media/model/media-model","DS/Logger/Logger","DS/WebappsUtils/WebappsUtils"],function(e,t,i,n,o,s,r,a,c,u){"use strict";function l(e){var t=e&&e.target,i=t&&t.dataset&&t.dataset.stylesToRemoveAfterLoad&&t.dataset.stylesToRemoveAfterLoad.split(",")||[];if("true"!==t.dataset.backupImage){for(var n=0,o=i.length;n<o;n++)t.setStyle(i[n].trim(),"");i&&t.removeAttribute("data-styles-to-remove-after-load")}}function d(e){var t=e&&e.target,i=t.dataset.mediaWidth,n=t.dataset.mediaHeight;i&&n&&!0!==window.__testmode__&&(t.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 '+i+" "+n+'"%3E%3C/svg%3E',t.dataset.backupImage="true"),t.onerror=null}return i.singleton({_normalPictureSelector:'img[data-type="ENoPicture"]',_miniPictureSelector:'img[data-type="EMiPicture"]',_uminiPictureSelector:'img[data-type="EUmPicture"]',_thumbnailSelector:'img[data-type="MediaNoPicture"]',_communityLogoSelector:'img[data-type="CommunityNoPicture"]',_nonReloadedImagesSelector:'[data-status="NonReloaded"]',_deletedMediaSelector:'[data-deleted-media="true"]',getUserPictureAttributes:function(e){if(e){var t,i;switch("string"!=typeof e.format&&(e.format="normal"),e.format=e.format.toLowerCase(),e.format){default:case"normal":t="ENoPicture",i="e-nopicture";break;case"mini":t="EMiPicture",i="e-mipicture";break;case"umini":t="EUmPicture",i="e-umpicture"}var o="",r={class:[i," ",e.cls||""].join(""),"data-status":"Reloaded","data-type":t,"data-content-type":"person","data-is-link":"true"};return e.title&&(r.title=e.title),e.imageFingerprint?o=e.imageFingerprint:e.imageUpdateTime&&(o=n.getDateInMilliSec(e.imageUpdateTime)),r["data-fingerprint"]=o,e.login&&(r["data-login"]=e.login,r.src=s.constructUserPictureUrl(e.login,o)),e.hash_key&&(r["data-hash-key"]=e.hash_key,r.src=s.constructUserPictureUrl(e.login,o,e.hash_key)),e.size&&(r["data-size"]=e.size),e.clsOver&&(r["data-cls-over"]=e.clsOver),void 0!==e.dataIsLink&&(r["data-is-link"]=String(e.dataIsLink)),r}return{}},renderUserPicture:function(t){return e.createElement("img",this.getUserPictureAttributes(t))},getMediaThumbnailAttributes:function(t){if(t){t.width=t.width||320,t.height=t.height||240;var i,o=t.imageKind||"thumb",s=t.size||"m",r="",c={src:[u.getWebappsBaseUrl(),"SwymUIComponents/assets/thumb.png"].join(""),"data-status":"Reloaded","data-to-width":t.width,"data-crop":!1!==t.crop?1:0,"data-type":!0===t.useVariableSizeSprite?"VariableSizeMediaThumbnail":!0===t.communityLogo?"CommunityNoPicture":"MediaNoPicture","data-is-link":"false"};return t.as_admin&&(c["data-as-admin"]=t.as_admin),t.community_id&&(c["data-community-id"]=t.community_id),t.mediaType&&(c["data-media-type"]=t.mediaType),t.title&&(c.title=t.title),t.modelName&&(c["data-content-type"]=t.modelName,t.modelId&&(c["data-content-id"]=t.modelId)),t.mediaId&&(c["data-media-id"]=t.mediaId),t.height&&(c["data-to-height"]=t.height),t.heightToDisplay&&(c["data-height-to-display"]=t.heightToDisplay),t.widthToDisplay&&(c["data-width-to-display"]=t.widthToDisplay),t.spriteURL&&(i=["-",t.yPosition||0,"px"].join(""),c.styles={},c.styles.background=['url("',t.spriteURL,'")'," 0px ",i].join("")),t.cls&&(c.class=t.cls),t.spriteKey&&(c["data-sprite-key"]=t.spriteKey),t.spriteType&&(c["data-sprite-type"]=t.spriteType),t.isLink&&(c["data-is-link"]=t.isLink),t.clsOver&&(c["data-cls-over"]=t.clsOver),t.size&&(c["data-size"]=t.size),t.imageFingerprint?c["data-fingerprint"]=t.imageFingerprint:t.imageUpdateTime?c["data-fingerprint"]=n.getDateInMilliSec(t.imageUpdateTime):c["data-fingerprint"]="",!0===t.deletedMedia&&(c["data-deleted-media"]="true"),t.extraAttributes&&(c=e.extend(c,t.extraAttributes)),"thumb"===o&&(s+="_thumb"),r="thumb"===o?a.constructThumbnailUrl(t.modelName,t.modelId,s,c["data-fingerprint"]):window.ds&&!0===window.ds.isMDE&&"generic_preview"===o?a.constructGenericPreviewUrl(t.previewUrl):a.constructPictureViewUrl(t.modelId||t.mediaId,s,c["data-fingerprint"]),!0===t.isAdmin&&(r+="/admin/true"),c.src=r,c}return{}},renderMediaThumbnail:function(t){var i=e.createElement("img",this.getMediaThumbnailAttributes(t));return i.dataset&&i.dataset.stylesToRemoveAfterLoad&&(i.onload=l,i.onerror=d),i}}).init()}),define("DS/SwymUICore/script/feature/community/media/collection/media-collection",["UWA/Core","DS/SwymUICore/script/lib/6wpanel/utils","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/utils/exalead-interceptor"],function(e,t,i,n,o){"use strict";return i.extend(o,{_asAdmin:!1,_collectionName:"media-collection",_services:{read:{all:{url:"api/media/listallmedia",dataFn:function(){return{page:this._currentPage,limit:this._limit}}},communityMedia:{url:"api/media/listallmedia",dataFn:function(){return{as_admin:this._asAdmin,page:this._currentPage,limit:this._limit,community_id:this.communityId}}},communityLatestMedia:{url:"api/media/listallmedia",dataFn:function(){return{page:this._currentPage,limit:this._limit,community_id:this.communityId}}},communityHighSemanticMedia:{url:"api/feed/whatsnew",dataFn:function(e){return{content_type:"media",community_id:this.communityId,...e}}},mediaByTenant:{url:"api/media/listallmediasbytenant",dataFn:function(){return{page:this._currentPage,start:(this._currentPage-1)*this._limit,limit:this._limit,sort:"id_media",dir:"DESC"}}},listallmediafrommypublicprivatecommunities:{url:"api/media/listallmediafrommypublicprivatecommunities",dataFn:function(){return{as_admin:this._asAdmin,page:this._currentPage,limit:this._limit}}},latestContributions:{url:"api/exalead/whatsnew",paramsMapping:{limit:"nresults",startFrom:"start"},dataFn:function(e){return{legacyFormat:!1,community_id:this.communityId,contentType:this.exaleadContentType,query:"#all",with_synthesis:!0,order_by:"desc",order_field:"ds6w_58_lastcontributed",start:(this._currentPage-1)*this._limit,nresults:this._limit,...e}},tagsWithoutSubjectURI:!0,parse:t.parseSearchResult}},filter:{all:{url:"api/exalead/search",tagsWithoutSubjectURI:!0},tenantMedia:{url:"api/exalead/search",dataFn:function(t){return e.extend(t||{},{as_admin:this._asAdmin,order_field:"pubdate",order_by:"desc"})},tagsWithoutSubjectURI:!0},communityMedia:{url:"api/exalead/search",dataFn:function(t){return e.extend(t||{},{refineUsingQuery:this.communityId?'community_id:"'+this.communityId+'"':null,as_admin:this._asAdmin,order_field:"pubdate",order_by:"desc"})},tagsWithoutSubjectURI:!0},communityLatestMedia:{url:"api/exalead/search",dataFn:function(t){return e.extend(t||{},{refineUsingQuery:this.communityId?'community_id:"'+this.communityId+'"':null,order_field:"pubdate",order_by:"desc",as_admin:this._asAdmin})},tagsWithoutSubjectURI:!0},communityHighSemanticMedia:{url:"api/exalead/whatsnew",dataFn:function(t){return t&&delete t.content_type,e.merge({contentType:this.exaleadContentType,legacyFormat:!1,community_id:this.communityId,with_synthesis:!0},t||{})},tagsWithoutSubjectURI:!0},mediaByTenant:{url:"api/exalead/search",tagsWithoutSubjectURI:!0,dataFn:function(t){var i=e.extend(t||{},{contentType:"media",legacyFormat:!1,as_admin:!0});return i.query||(i.query="#all"),delete i.dir,delete i.sort,i}},latestContributions:{url:"api/exalead/whatsnew",paramsMapping:{limit:"nresults",startFrom:"start"},dataFn:function(e){return{legacyFormat:!1,community_id:this.communityId,contentType:this.exaleadContentType,query:"#all",with_synthesis:!0,order_by:"desc",order_field:"ds6w_58_lastcontributed",start:(this._currentPage-1)*this._limit,nresults:this._limit,...e}},tagsWithoutSubjectURI:!0}}},model:n,modes:["all","communityMedia","tenantMedia","communityLatestMedia","communityHighSemanticMedia","filteredMedia","mediaByTenant","listallmediafrommypublicprivatecommunities","latestContributions"],exaleadContentType:"media",setup:function(t,i){i.communityId&&(this.communityId=i.communityId),i.filters&&(this.filters=i.filters),e.is(i.asAdmin)&&(this._asAdmin=i.asAdmin),this._parent.apply(this,arguments)},setFilters:function(e,t){this.filters=e,!0===t&&this.resetCollection(1)},parse:function(){var e,t=this._parent.apply(this,arguments);return Array.isArray(t)&&t.forEach(function(t){if(t){switch(t.ds6w_58_jobStatus){case"ds6w:jobStatus.swym_media_processed":e=n.MEDIA_PROCESSING_STATUS.OK;break;case"ds6w:jobStatus.swym_media_error":e=n.MEDIA_PROCESSING_STATUS.KO;break;case"ds6w:jobStatus.swym_media_non_processed":e=n.MEDIA_PROCESSING_STATUS.NOT_PROCESSED;break;case"ds6w:jobStatus.swym_media_ready_to_process":e=n.MEDIA_PROCESSING_STATUS.READY;break;default:return}t.status=e}}),t}})}),define("DS/SwymUICore/script/feature/community/wiki/model/wiki-model",["UWA/Core","UWA/Utils","i18n!DS/SwymUICore/assets/nls/feature/community/wiki/model/wiki-model","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/feature/community/comment/collection/comment-collection","DS/SwymUICore/script/feature/core/user/collection/commenters-collection","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/SwymUICore/script/feature/community/media/collection/media-collection","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/lib/model/generic/6wtaggable-model","DS/WebappsUtils/Console","DS/WebappsUtils/WebappsUtils"],(e,t,i,n,o,s,r,a,c,u,l,d,m)=>{l.extend({_modelName:"content-creation-dummy-taggable-model"});const h=n.extend({_modelName:"wiki",_tableName:"Dsi_DFSTree_WikiTree",_iconCls:"book-open",_iconWrapperCls:"wiki",_subPages:null,_attributesMapping:{message:"content",id:"mid",crdate:"crdate",update:"update"},_associations:{thumbnail:{Class:r},comments:{Class:o,oppositeRole:"commented",options:{mode:"wiki"}},commenters:{Class:s,oppositeRole:"commented",options:{mode:"comment"}},contributors:{Class:s,oppositeRole:"commented",options:{mode:"edit"}},authorizedusers:{Class:a,oppositeRole:"authorized",options:{mode:"getauthorizedusers",limit:999}},embeddedMedia:{Class:c,sourceAttribute:"thumbnails_infos",options:{limit:2,mode:"communityMedia"}}},_services:{create:{url:"api/WikiTree/addChild",dataFn(e){let t;if(e||(e={}),e.parent_id=this.get("parent_id"),e.parent_id&&(t=new h({mid:e.parent_id}))&&t.has("visibility")){const i=parseInt(t.get("visibility"),10);2!==i&&0!==i||(e.visibility=0)}return this.unset("minor_edition"),this.removeChanges("minor_edition"),e},paramsMapping:{content:"message"},parse:e=>(e&&(e.published="1"),e)},delete:{url:"api/WikiTree/delete",dataFn(e){return{id:this.get("mid"),mustDeleteSubpages:e.mustDeleteSubpages}}},read:{url:"api/WikiTree/get_instance",dataFn(t){const i=this.get("mid");let n=this.get("is_root");const o=this.get("community")?this.get("community").mid:null;return i||(n=!0),{id:n?null:i||(t?t.id:null),community_id:o,diff:!(!t||!t.diff)&&t.diff,revision:e.is(t.revision)?t.revision.toString():null,withThumbnailsInfo:!0}},parse(t){!0===t.is_root&&""===t.message&&(t.message=`<p><b>${i.Wiki_Welcome}</b></p><h1>${i.Wiki_h1_Usage}</h1><p>${i.Wiki_Usage_contents_p1}.</p><p>${i.Wiki_Usage_contents_p2}</p><p>${i.Wiki_Usage_contents_p3}</p><p><ul><li>${i.Wiki_Usage_contents_p4}</li><li>${i.Wiki_Usage_contents_p5}</li><li>${i.Wiki_Usage_contents_p6}</li><li>${i.Wiki_Usage_contents_p7}</li></ul></p><h1>${i.Wiki_h1_Structure}</h1><p>${i.Wiki_Structure_contents_p1}</p><p>${i.Wiki_Structure_contents_p2}</p><h1>${i.Wiki_h1_Edition}</h1><p>${i.Wiki_Edition_contents_p1}</p><p>${i.Wiki_Edition_contents_p2}</p><h1>${i.Wiki_h1_Started}</h1><p><ol><li>${i.Wiki_GetStart_contents_p1}</li><li>${i.Wiki_GetStart_contents_p2}</li></ol></p>`),t&&(t.published="1");const n=e.clone(t);let o,s;if(n.diff=this.lastCallsParams.read.diff,n){o=parseInt(n.revision_index,10),s=!0===n.diff?"_revisionsWithDiff":"_revisions";const e=o<0?"Current":o,i=this.get(s);return i[`revision${e}`]=n,this.set(s,i),(!0===n.diff||"Current"!==e&&this.get("_revisionToDisplay")===o)&&(this.set("diff",n.diff),this.dispatchEvent("onRevisionReceived",{id:o,attributes:n}),d.log("onRevisionReceived: id",o,"attributes",n)),(o>=0||!0===n.diff)&&(t={}),t&&t.thumbnails_infos&&(t.thumbnails_infos=u.formatThumbnailsInfos(t.thumbnails_infos)),t}}},getNbOfRevisions:{url:"api/WikiTree/infosrevision",dataFn(){return{modelId:this.get("mid"),modelType:"WikiTree"}}},toggleLockPage:{url:"api/WikiTree/lock",dataFn(){return{id:this.get("mid")}}},toggleLockPageAndChildren:{url:"api/WikiTree/lockall",dataFn(){return{id:this.get("mid")}}},update:{url:"api/WikiTree/update",paramsMapping:{mid:"id",content:"message"},dataFn(e){return e=e||{},this.getChanges("revision_description")||(e.revision_description=this._previousAttributes.revision_description),e.minor_edition?e.is_minor_edit=e.minor_edition:e.is_minor_edit="1","1"!==e.is_minor_edit&&this.set("nb_revisions",parseInt(this.get("nb_revisions"),10)+1),this.unset("minor_edition"),this.removeChanges("minor_edition"),e.withThumbnailsInfo=!0,e.content_etag=this.get("content_etag"),e},parse:e=>(e&&e.thumbnails_infos&&(e.thumbnails_infos=u.formatThumbnailsInfos(e.thumbnails_infos)),e)},revert:{url:"api/WikiTree/reverttorevision",dataFn(){return{modelId:this.get("mid"),revision:this.getCurrentRevision()}},parse(){this.set("nb_revisions",parseInt(this.get("nb_revisions"),10)+1),this.get("_revisionsWithDiff").revisionCurrent=null,this.get("_revisions").revisionCurrent=null}},move:{url:"api/WikiTree/move",dataFn(e){return{id:e.id||this.get("mid"),relation:e.relation,targetid:e.targetId||e.targetid}}}},defaults:{_revisions:{},_revisionsWithDiff:{},_revisionToDisplay:-1,diff:!1,title:"",author:{},visibility:"1",hasChild:!1},getCurrentRevision(){return this.get("_revisionToDisplay")},getCommenters(){return this.getAssociated("commenters")},getContributors(){return this.getAssociated("contributors")},getComments(){return this.getAssociated("comments")},addComment(e){try{this.getAssociated("comments").addComment(e)}catch(e){d.log("exception:",e)}},toggleLockPage(e){return this.action("toggleLockPage",e)},toggleLockPageAndChildren(e){return this.action("toggleLockPageAndChildren",e)},revert(e){return this.action("revert",e)},setup(e,t){this._parent(e,t)},getSubject6wuri(e){let t;return this.get("tree").forEach(i=>{i.id===e&&(t=i.subject6wuri)}),t},"onSync:create":function(){const e=this;require(["DS/SwymUICore/script/feature/community/wiki/model/wikitree-model"],t=>{if(e.has("community")){const i=new t({mid:e.get("community").mid,community_id:e.get("community").mid});i.fetch(),e.get("mid")&&i.setCurrentPage(e.get("mid"))}})},"onSync:update":function(){const t=this.get("nb_revisions"),i=this.get("_revisions");if(i&&i.revisionCurrent&&"1"!==this.get("is_minor_edit")&&(i[`revision${parseInt(t,10)-1}`]=e.clone(i.revisionCurrent),this.get("_revisionsWithDiff")[`revision${t}`]=e.clone(this.get("_revisionsWithDiff").revisionCurrent),this.get("_revisionsWithDiff").revisionCurrent=void 0,delete this.get("_revisionsWithDiff").revisionCurrent,this.set("revision_index",-1),i.revisionCurrent=e.clone(this._attributes),this.set("_revisions",i)),"locked"in this._previousChanges||"visibility"in this._previousChanges){const e=this.get("mid"),t=this.getCommunity().get("mid");window.require(["DS/SwymUICore/script/feature/community/wiki/model/wikitree-model"],i=>{new i({community_id:t}).getSubPages(e).forEach(e=>{new h({mid:e}).fetch()})})}return this._parent.apply(this,arguments)},_fetchNthRevision(e,t){if(!(e>=-1))throw new Error(`Unknown revision n: ${e}`);(t=t||{}).revision=e,this.fetch({data:t})},_setNthRevision(e,t){let i,n;if(i=!(!t||!0!==t.diff),!(n=this.getRevisionData(e,i)))throw new Error(`No cache exists for revision ${e}`);this.dispatchEvent("onRevisionReceived",{id:e,attributes:n}),d.log(`onRevisionReceived (from cache ${i}): id`,e,"attributes",n)},_getNthRevision(e,t){let i,n;n=!(!t||!0!==t.diff),i=this.getRevisionData(e,n),this.dispatchEvent("onRevisionRequested"),d.log("onRevisionRequested"),i?this._setNthRevision(e,t):this._fetchNthRevision(e,t)},goToPrevRevision(e){const t=this.get("_revisionToDisplay"),i=this.get("nb_revisions");let n;if(void 0===i||0===i||"0"===i)throw new Error("This wiki page has not been modified yet");if(!(t>0||-1===t))throw 0===t?new Error("This wiki page is already on the first revision"):new Error(`The wiki is in an unknown revision ${t}`);t>0?n=t-1:-1===t&&(n=i-2),this._getNthRevision(n,e),this.set("_revisionToDisplay",n)},goToNextRevision(e){const t=this.get("_revisionToDisplay"),i=this.get("nb_revisions");let n;if(void 0===i||0===i||"0"===i)throw new Error("This wiki page has not been modified yet");if(!(t>=0))throw-1===t?new Error("This wiki page is already on the latest revision"):new Error(`The wiki is in an unknown revision ${t}`);if(t===i-2)n=-1;else{if(!(t<i-2))throw new Error(`The wiki is in an unknown revision ${t}`);n=t+1}this._getNthRevision(n,e),this.set("_revisionToDisplay",n)},goToNthRevision(e,t){const i=this.get("nb_revisions");if(void 0===i||0===i||"0"===i)throw new Error("This wiki page has not been modified yet");if(!(e>=-1&&e<=i))throw new Error(`The revision ${e} asked for, does not exist yet`);e===i&&(e=-1),this._getNthRevision(e,t),this.set("_revisionToDisplay",e)},goToFirstRevision(e){this.goToNthRevision(0,e)},goToLastRevision(e){const t=this.get("nb_revisions");this.goToNthRevision(t,e)},_replaceStreammediaUrl:e=>e.replace(/src="([^"]*)\/streammedia\/.+?"/gi,['src="',m.getWebappsBaseUrl(),'SwymUIComponents/assets/thumb.png"'].join("")),getRevisionData(e,t){let i,n;return!0===t?-1===e||"Current"===e?(i=parseInt(this.get("nb_revisions")),"1"===this.get("is_minor_edit")&&(i-=1),n="_revisionsWithDiff"):(i=e,n="_revisionsWithDiff"):(i=-1===e||"Current"===e?"Current":e,n="_revisions"),this.get(n)&&this.get(n)[`revision${i}`]},getToc(){const t=[],i=this.get("content"),n=e.createElement("div",{html:i?this._replaceStreammediaUrl(i):""}).querySelectorAll("h1, h2, h3"),o=[];for(let e=n.length;e--;o.unshift(n[e]));return o&&o.forEach(e=>{""!==e.innerText.trim()&&t.push({name:e.innerText,id:e.getAttribute("id"),level:e.tagName})}),t},generateToc(t){let i,n,o,s;const r=e.createElement("div",{html:t?this._replaceStreammediaUrl(t):""}),a=r.querySelectorAll("h1, h2, h3"),c=[];for(let e=a.length;e--;c.unshift(a[e]));return c&&c.forEach(e=>{i=e.attributes,o=i.getNamedItem("id"),s=Math.floor(99999*Math.random()),o?o.value=`content-${e.tagName}-${s}`:((n=document.createAttribute("id")).value=`content-${e.tagName}-${s}`,i.setNamedItem(n))}),r.getHTML()},isLeafNode(){const e=this;let t;const i=this.get("mid");return new Promise((n,o)=>{window.require(["DS/SwymUICore/script/feature/community/wiki/model/wikitree-model"],o=>{const s=new o({mid:e.getCommunity().get("mid")});t=s.isLeafNode(i),n(Boolean(t))})})},getRssLink(e){return e||(e=10),`/rss/filter/feed/model/wiki/limit/${e}/community_id/${this.getCommunity().get("mid")}/model_id/${this.get("mid")}`},setSubPages(){const e=this,t=this.get("mid"),i=this.getCommunity().get("mid");return new Promise((n,o)=>{window.require(["DS/SwymUICore/script/feature/community/wiki/model/wikitree-model"],s=>{new s({community_id:i},{autoPopulate:!0,onPopulate(i){e._subPages=i.getSubPages(t),n()},onFailure(...e){o(...e)}})})})},deleteContribution(e){return this.destroy(e)}});return h}),define("DS/SwymUICore/script/feature/community/timeline/model/event-model",["DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/utils/date"],function(e,t,i,n){"use strict";var o=i.extend({_modelName:"event",_attributesMapping:{message_id:"mid",community_id:"community->mid",community_type:"community->community_type"},getAuthorModelAttributes:function(){},init:function(){this._parent.apply(this,arguments),this.setAssociated("author",new e(this.getAuthorModelAttributes()))},_associations:{author:{Class:e},community:{Class:t}},getAuthor:function(){return this.getAssociated("author")},getCommunity:function(){return this.getAssociated("community")},getReferenceTimestamp:function(){return n.getDateInMilliSec(this.getReferenceDateValue())},getReferenceDate:function(){return n.convertISODateIntoUsualDate(this.getReferenceDateValue())},getReferenceDateValue:function(){return this.get("creation_date")},getReferenceDay:function(){return n.conciseDay(this.getReferenceDateValue())},getPrettyDate:function(){return n.prettyHour(this.getReferenceDateValue())},getGroupStatus:function(){return this.getCustomProperty("groupStatus")},setGroupStatus:function(e){var t=this.getGroupStatus();if("group-body"!==e&&"group-head"!==e&&"last-im-in-group"!==e)throw new Error("Unknown group status received");t!==e&&(this.setCustomProperty("groupStatus",e),t&&this.dispatchEvent("onChangeCustomProperty: groupStatus",[e]))},removeGroupStatus:function(){this.getGroupStatus()&&(this.setCustomProperty("groupStatus",""),this.dispatchEvent("onChangeCustomProperty: groupStatus",[""]))}});return o.LAST_IM_IN_GROUP="last-im-in-group",o.ACTIVE_STATE="ACTIVE",o.DELETED_STATE="DELETED",o.NOT_AVAILABLE="NOT_AVAILABLE",o.GROUP_HEAD="group-head",o.GROUP_BODY="group-body",o}),define("DS/SwymUICore/script/feature/community/post/model/post-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/feature/community/comment/collection/comment-collection","DS/SwymUICore/script/feature/core/user/collection/commenters-collection","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/community/media/collection/media-collection","DS/SwymUICore/script/utils/utils","DS/WebappsUtils/Console"],function(e,t,i,n,o,s,r,a){"use strict";return t.extend({_modelName:"post",_tableName:"CommunityPost",_iconCls:"newspaper",_iconWrapperCls:"post",_attributesMapping:{id:"mid",model_id:"mid",community_post_id:"mid",message:"content"},_associations:{thumbnail:{Class:o},comments:{Class:i,oppositeRole:"commented",options:{mode:"post"}},commenters:{Class:n,oppositeRole:"commented",options:{mode:"comment"}},embeddedMedia:{Class:s,sourceAttribute:"thumbnails_infos",options:{limit:2,mode:"communityMedia"}}},_services:{create:{url:"api/post/addpost",paramsMapping:{mid:"community_post_id",content:"message"},dataFn:function(e){return(e=e||{}).withThumbnailsInfo=!0,e}},read:{url:"api/post/get_instance",dataFn:function(){return{community_post_id:this.get("mid"),withThumbnailsInfo:!0}},parse:e=>(e&&e.thumbnails_infos&&(e.thumbnails_infos=r.formatThumbnailsInfos(e.thumbnails_infos)),e)},update:{url:"api/post/updatepost",paramsMapping:{mid:"community_post_id",content:"message"},dataFn:function(e){return(e=e||{}).withThumbnailsInfo=!0,e},parse:e=>(e&&e.thumbnails_infos&&(e.thumbnails_infos=r.formatThumbnailsInfos(e.thumbnails_infos)),e)},delete:{url:"api/community/deletecontribution",dataFn:function(){return{ids:[this.get("mid")],community_id:this.get("community->mid")||this.get("community").mid||this.get("community").id}}}},defaults:{},getCommenters:function(){return this.getAssociated("commenters")},getComments:function(){return this.getAssociated("comments")},addComment:function(e){try{this.getAssociated("comments").addComment(e)}catch(e){a.log("exception:",e)}},deleteContribution:function(e){return this.destroy(e)},getRssLink:function(e){return e||(e=10),"/rss/filter/feed/model/post/limit/"+e+"/community_id/"+this.getCommunity().get("mid")+"/model_id/"+this.get("mid")}})}),define("DS/SwymUICore/script/feature/community/iquestion/model/iquestion-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/iquestion/collection/iq-answer-collection","DS/SwymUICore/script/feature/core/user/collection/commenters-collection","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/community/media/collection/media-collection","DS/SwymUICore/script/utils/utils","DS/WebappsUtils/Console"],function(e,t,i,n,o,s,r,a,c){var u=function(e){return!e||!e.moderation_status||"deleted"!==e.moderation_status&&"deleted_by_author"!==e.moderation_status},l=function(t){var i={answers:[],validatedAnswers:[]};return t&&t.id&&delete t.id,e.is(t,"array")&&((t=t.filter(u))[0]&&1===parseInt(t[0].validate,10)&&(i.validatedAnswers=[t.shift()]),i.answers=t),i};return t.extend({_modelName:"iquestion",_tableName:"QnaQuestion",_iconCls:"help",_iconWrapperCls:"iquestion",_attributesMapping:{qna_id:"mid",model_id:"mid",question:"content",qna_crdate:"crdate",qna_update:"update",count_answer:"nb_answers",qna_answer_count:"nb_answers",validate_lists:"validatedAnswers",validatedAnswers:"validatedAnswers",answers:"answers"},_associations:{thumbnail:{Class:s},validatedAnswers:{Class:n,oppositeRole:"answeredFor",options:{mode:"iq-answers-validated"}},answers:{Class:n,oppositeRole:"answeredFor",options:{mode:"iq-answers"}},commenters:{Class:o,oppositeRole:"commented",options:{mode:"comment"}},whoanswered:{Class:o,oppositeRole:"commented",options:{mode:"answer"}},embeddedMedia:{Class:r,sourceAttribute:"thumbnails_infos",options:{limit:2,mode:"communityMedia"}}},_services:{create:{url:"api/IquestionsQuestions/add",paramsMapping:{content:"question"},dataFn:function(e){return(e=e||{}).withThumbnailsInfo=!0,e}},read:{url:"api/IquestionsQuestions/getquestioninfos",dataFn:function(){return{iQuestions_id:this.get("mid"),withThumbnailsInfo:!0}},parse:function(e){return e&&e.qna_id&&(e.id=e.qna_id),e&&e.thumbnails_infos&&(e.thumbnails_infos=a.formatThumbnailsInfos(e.thumbnails_infos)),e}},fetchAllAnswers:{url:"api/IquestionsAnswer/list",dataFn:function(e){return{iQuestions_id:this.get("mid"),limit:e.limit||"1000",page:1,returnAll:!0,orderBy:"rate",detailedInfos:!1}},parse:l},fetchAllDetailedAnswers:{url:"api/IquestionsAnswer/list",dataFn:function(e){return{iQuestions_id:this.get("mid"),limit:e.limit||"1000",page:1,orderBy:"rate",returnAll:!0}},parse:l},update:{url:"api/IquestionsQuestions/update",paramsMapping:{mid:"qna_id",content:"question"},dataFn:function(e){return(e=e||{}).withThumbnailsInfo=!0,e},parse:e=>(e&&e.thumbnails_infos&&(e.thumbnails_infos=a.formatThumbnailsInfos(e.thumbnails_infos)),e)},delete:{url:"api/community/deletecontribution",dataFn:function(){return{iquestionIds:[this.get("mid")],community_id:this.get("community->mid")||this.get("community").mid||this.get("community").id}}}},defaults:{nb_answers:0,categories:null,mainCategorie:null,question:"",relatedDocuments:null,title:""},"onSetAssociated:answers":function(e,t,i){t&&(this.stopListening(t,"onAdd"),this.stopListening(t,"commentCreated")),this.listenTo(i,"onAdd",function(){this.set("nb_answers",this.getAnswerCollection().length+this.getValidatedAnswerCollection().length)}),this.listenTo(i,"commentCreated",function(){this.set("nb_comments",parseInt(this.get("nb_comments"),10)+1)})},"onSetAssociated:validatedAnswers":function(e,t,i){t&&this.stopListening(t,"commentCreated"),this.listenTo(i,"commentCreated",function(){this.set("nb_comments",parseInt(this.get("nb_comments"),10)+1)})},init:function(){var e=this._parent.apply(this,arguments);return this._customProperties&&(this.addEventOnce("onRequest:fetchAllAnswers",function(){this._customProperties.answersBeingFetched=!0}),this.addEventOnce("onSync:fetchAllAnswers",function(){this._customProperties.answersFetched=!0,this._customProperties.answersBeingFetched=!1}),this.addEventOnce("onRequest:fetchAllDetailedAnswers",function(){this._customProperties.detailedAnswersBeingFetched=!0}),this.addEventOnce("onSync:fetchAllDetailedAnswers",function(){this._customProperties.detailedAnswersFetched=!0,this._customProperties.detailedAnswersBeingFetched=!1})),e},haveAnswersBeenFetched:function(){return!0===this._customProperties.answersFetched},areAnswersBeingFetched:function(){return!0===this._customProperties.answersBeingFetched},haveDetailedAnswersBeenFetched:function(){return!0===this._customProperties.detailedAnswersFetched},areDetailedAnswersBeingFetched:function(){return!0===this._customProperties.detailedAnswersBeingFetched},setup:function(){this._fetchStatus={modelFetchStatus:i.STATUS.notRequested,validatedAnswersFetchStatus:i.STATUS.notRequested,answersFetchStatus:i.STATUS.notRequested}},getCommenters:function(){return this.getAssociated("commenters")},getWhoAnswered:function(){return this.getAssociated("whoanswered")},getAnswerCollection:function(){return this.getAssociated("answers")},getValidatedAnswerCollection:function(){return this.getAssociated("validatedAnswers")},fetchAllAnswers:function(e){return this.action("fetchAllAnswers",e)},fetchAllDetailedAnswers:function(e){return this.action("fetchAllDetailedAnswers",e)},overrideFetchOptions:function(t,n){var o=this,s=e.merge({},t);return this._fetchStatus[n]=i.STATUS.pending,s.onComplete=function(){var s=null;return o._fetchStatus[n]=i.STATUS.valid,t&&"function"===e.typeOf(t.onComplete)&&(s=t.onComplete.apply(this,arguments)),s},s.onFailure=function(){var s=null;return o._fetchStatus[n]=i.STATUS.invalid,t&&"function"===e.typeOf(t.onFailure)&&(s=t.onFailure.apply(this,arguments)),s},s},overrideAnswerFetchOptions:function(t){var i=e.merge({},t),n=this.getValidatedAnswerCollection(),o=this;return i.onComplete=function(){var i=null;return n&&n.length>0?o.set("nb_validate",1):o.set("nb_validate",0),t&&"function"===e.typeOf(t.onComplete)&&(i=t.onComplete.apply(this,arguments)),i},i},fetch:function(e){var t=this.overrideFetchOptions(e,"modelFetchStatus");return this._parent.apply(this,[t])},fetchAnswers:function(e){if(!this.isNew()){var t=this.overrideFetchOptions(e,"answersFetchStatus");this.getAnswerCollection().fetch(t)}},fetchValidatedAnswers:function(e){var t=this.getValidatedAnswerCollection();if(!this.isNew()){var i=this.overrideFetchOptions(e,"validatedAnswersFetchStatus"),n=this.overrideAnswerFetchOptions(i);t.setSortAttribute("rate"),t.fetch(n)}},isValidated:function(){var e=this.get("nb_validate");return void 0===e?e:1===e},addAnswer:function(e){try{this.getAnswerCollection().addAnswer(e)}catch(e){return void c.error("Error adding new answer to collection: "+e.message)}},deleteContribution:function(e){return this.destroy(e)},getRssLink:function(e){return e||(e=10),"/rss/filter/feed/model/iquestion/limit/"+e+"/community_id/"+this.getCommunity().get("mid")+"/model_id/"+this.get("mid")},"onChange:validate_lists":function(){var e=this.get("validate_lists");e&&e.length&&this.getValidatedAnswerCollection().add(e[0])}})}),define("DS/SwymUICore/script/feature/community/survey/model/survey-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/feature/community/survey/collection/question-collection","DS/SwymUICore/script/feature/community/survey/model/question-model","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/community/media/collection/media-collection","DS/SwymUICore/script/utils/date","DS/SwymUICore/script/utils/utils"],function(e,t,i,n,o,s,r,a){var c=new Date,u=new Date,l=c.getHours(),d=(parseInt(l,10)<=9?"0"+parseInt(l,10):parseInt(l,10))+":00",m=c.getFullYear(),h=parseInt(c.getMonth(),10),p=parseInt(c.getDate(),10),g=m+"-"+(h<9?"0"+(h+1):h+1)+"-"+(p<9?"0"+p:p);u.setMonth(u.getMonth()+1),m=u.getFullYear();var f=parseInt(u.getMonth(),10),_=m+"-"+(f<9?"0"+(f+1):f+1)+"-"+((u=parseInt(u.getDate(),10))<9?"0"+u:u);return t.extend({_modelName:"survey",_tableName:"Poll",_iconCls:"clipboard",_iconWrapperCls:"survey",_associations:{questions:{Class:i,oppositeRole:"survey"},thumbnail:{Class:o},embeddedMedia:{Class:s,sourceAttribute:"thumbnails_infos",options:{limit:2,mode:"communityMedia"}}},_attributesMapping:{model_id:"mid"},_convertDateAndHoursIntoGMT:function(e){var t=e.date,i=e.hour.split(":"),n=parseInt(i[0],10),o=parseInt(i[1],10),s=new Date(t),r={};return n&&s.setHours(n),"number"==typeof o&&s.setMinutes(o),r.date=s.getUTCFullYear()+"-"+("0"+(s.getUTCMonth()+1)).slice(-2)+"-"+("0"+s.getUTCDate()).slice(-2),r.hour=("0"+s.getUTCHours()).slice(-2)+":"+s.getUTCMinutes(),r},_convertDateAndHoursIntoLocal:function(e){var t=e.date,i=e.hour.split(":"),n=parseInt(i[0],10),o=parseInt(i[1],10),s=new Date(t),r={};return n&&s.setUTCHours(n),o&&s.setUTCMinutes(o),r.date=s.getFullYear()+"-"+("0"+(s.getMonth()+1)).slice(-2)+"-"+("0"+s.getDate()).slice(-2),r.hour=("0"+s.getHours()).slice(-2)+":"+(s.getMinutes()<10?"0":"")+s.getMinutes(),r},init:function(e,t){var i=this._parent(e,t);if(t&&!0!==t.autoPopulate){var n=this._convertDateAndHoursIntoLocal({date:this.get("startDate"),hour:this.get("startHour")}),o=this._convertDateAndHoursIntoLocal({date:this.get("endDate"),hour:this.get("endHour")});this.set({startDate:n.date,startHour:n.hour,endDate:o.date,endHour:o.hour})}return i},_services:{create:{url:"api/poll/createpoll",dataFn:function(){var t=e.merge(this.getChanges(),this.getAttributes()),i=new Date,n=new Date;n.setMonth(n.getMonth()+1);var o={endDate:n.getFullYear()+"-"+(parseInt(n.getMonth(),10)+1<=9?"0"+(parseInt(n.getMonth(),10)+1):parseInt(n.getMonth(),10)+1)+"-"+(parseInt(n.getDate(),10)<=9?"0"+parseInt(n.getDate(),10):parseInt(n.getDate(),10)),endHour:(parseInt(n.getHours(),10)<=9?"0"+parseInt(n.getHours(),10):parseInt(n.getHours(),10))+":"+(parseInt(n.getMinutes(),10)<=9?"0"+parseInt(n.getMinutes(),10):parseInt(n.getMinutes(),10)),model:"Community",modelId:t.community.mid,published:0,showResultsAfterVote:!1,startDate:i.getFullYear()+"-"+(parseInt(i.getMonth(),10)+1<=9?"0"+(parseInt(i.getMonth(),10)+1):parseInt(i.getMonth(),10)+1)+"-"+(parseInt(i.getDate(),10)<=9?"0"+parseInt(i.getDate(),10):parseInt(i.getDate(),10)),startHour:(parseInt(i.getHours(),10)<=9?"0"+parseInt(i.getHours(),10):parseInt(i.getHours(),10))+":"+(parseInt(i.getMinutes(),10)<=9?"0"+parseInt(i.getMinutes(),10):parseInt(i.getMinutes(),10)),title:""};e.merge(t,o),t.questions=[],this.getAssociated("questions").forEach(function(i){var n=i.toJSON();e.extend(n,i.getChanges()),n.answers=[],"Single"===i.get("type")||"Multiple"===i.get("type")?i.getAssociated("answers").forEach(function(e){n.answers.push(e.toJSON())}):"Open"===i.get("type")?n.answers.push({is_open:"1",description:"Open"}):"Scale"===i.get("type")&&n.answers.push({is_open:"0",description:"Scale"}),t.questions.push(n)});var s=this._convertDateAndHoursIntoGMT({date:t.startDate,hour:t.startHour}),r=this._convertDateAndHoursIntoGMT({date:t.endDate,hour:t.endHour});if(t.startDate=s.date,t.startHour=s.hour,t.endDate=r.date,t.endHour=r.hour,"0000-00-00"==t.startDate){var a=new Date;t.startDate=a.toLocaleFormat("%Y-%m-%d"),t.startHour=(a.getHours()<=9?"0":"")+a.getHours()+":"+(a.getMinutes()<=9?"0":"")+a.getMinutes()}return t},postProcess:function(e){if(e&&e.result&&this.set("mid",e.result.id||e.result),e&&e.result){var t=e.result,i=this._convertDateAndHoursIntoLocal({date:t.startDate,hour:t.startHour}),n=this._convertDateAndHoursIntoLocal({date:t.endDate,hour:t.endHour});return t.startDate=i.date,t.startHour=i.hour,t.endDate=n.date,t.endHour=n.hour,t}}},read:{url:"api/poll/getpoll",dataFn:function(){return{pollId:this.get("mid")}},postProcess:function(e){if(e&&e.result){var t=e.result,i=this._convertDateAndHoursIntoLocal({date:t.startDate,hour:t.startHour}),n=this._convertDateAndHoursIntoLocal({date:t.endDate,hour:t.endHour});return t.startDate=i.date,t.startHour=i.hour,t.endDate=n.date,t.endHour=n.hour,t}}},update:{url:"api/poll/updatepoll",dataFn:function(){var t=e.merge(this.getChanges(),this.toJSON());t.id=this.get("mid"),t.questions=[],this.getAssociated("questions").forEach(function(t){var i=t.toJSON();e.extend(i,t.getChanges()),i.answers=[],"Open"!==t.get("type")||"Open"===t.get("type")&&1===t.getAssociated("answers").length?t.getAssociated("answers").forEach(function(e,t){var i=e.toJSON();i.id=i.mid,i.position=t+1,this.answers.push(i)}.bind(i)):"Open"===t.get("type")&&t.getAssociated("answers").length>1&&i.answers.push({is_open:"1",description:"Open",position:"1"}),i.id=i.mid,this.questions.push(i)}.bind(t));var i=this._convertDateAndHoursIntoGMT({date:t.startDate,hour:t.startHour}),n=this._convertDateAndHoursIntoGMT({date:t.endDate,hour:t.endHour});if(t.startDate=i.date,t.startHour=i.hour,t.endDate=n.date,t.endHour=n.hour,"0000-00-00"==t.startDate){var o=new Date;t.startDate=o.toLocaleFormat("%Y-%m-%d"),t.startHour=(o.getHours()<=9?"0":"")+o.getHours()+":"+(o.getMinutes()<=9?"0":"")+o.getMinutes()}return t},postProcess:function(e){if(e&&e.result){var t=e.result,i=this._convertDateAndHoursIntoLocal({date:t.startDate,hour:t.startHour}),n=this._convertDateAndHoursIntoLocal({date:t.endDate,hour:t.endHour});return t.startDate=i.date,t.startHour=i.hour,t.endDate=n.date,t.endHour=n.hour,t}}},saveuseranswers:{url:"api/poll/saveuseranswers"},isansweredbyme:{url:"api/poll/isansweredbyme",dataFn:function(){return{pollId:this.get("mid")}},parse:function(e){e=!1===e.result?e.result:e,this.set("userHasAlreadyAnswered",e)}},delete:{url:"api/community/deletecontribution",dataFn:function(){return{pollIds:[this.get("mid")],community_id:this.get("community->mid")||this.get("community").mid||this.get("community").id}}},getResults:{url:"api/poll/exportresults",dataFn:function(){return{pollId:this.get("mid")}}}},defaults:{title:"",endHour:d,startHour:d,endDate:_,startDate:g,published:0,showResultsAfterVote:!1},isansweredbyme:function(e){return this.action("isansweredbyme",e)},validateField:function(e,t){switch(e){case"content":return!1;default:return this._parent(e,t)}},addQuestion:function(e){var t=this.getAssociated("questions");e.position=t.length+1;var i=new n(e);return t.add(i),i},deleteContribution:function(e){return this.destroy(e)},saveAnswers:function(t,i){return this.action("saveuseranswers",e.merge({data:{answers:t}},i||{}))},getStartDate:function(){var e=this.get("start")||this.get("startDate")+" "+this.get("startHour")+":00";return new Date(r.getDateInMilliSec(e))},getEndDate:function(){var e=this.get("end")||this.get("endDate")+" "+this.get("endHour")+":00";return new Date(r.getDateInMilliSec(e))},hasEnded:function(){return(new Date).getTime()>this.getEndDate().getTime()},isOpen:function(){var e=new Date,t=this.getEndDate(),i=this.getStartDate();return t.getTime()-e.getTime()>0&&e.getTime()-i.getTime()>0},hasStarted:function(){var e=new Date,t=this.getStartDate();return e.getTime()-t.getTime()>0},_convertMS:function(e){var t=2592e6,i=Math.floor(e/t),n=Math.floor((e-i*t)/864e5),o=Math.floor((e-i*t-864e5*n)/36e5),s=Math.round((e-i*t-864e5*n-36e5*o)/6e4);return 60===s&&(o++,s=0),24===o&&(n++,o=0),30===n&&(i++,n=0),{months:parseInt(i,10),days:parseInt(n,10),hours:parseInt(o,10),minutes:parseInt(s,10)}},getSurveyOpeningTimeRemaining:function(){var e=this.hasStarted(),t=new Date,i=this.getStartDate(),n=e?0:i.getTime()-t.getTime();return this._convertMS(n)},removeChanges:function(){for(var e,t=this.get("questions")||[],i=[],o=0,s=t.length;o<s;o++)e=new n(t[o]),i.push(e);return 0!==i.length&&this.getAssociated("questions").reset(i),this._parent.apply(this,arguments)},updateContainedMedia:function(){},getResults:function(e){return this.action("getResults",e)}})}),define("DS/SwymUICore/script/feature/community/survey/collection/survey-collection",["UWA/Core","DS/SwymUICore/script/lib/6wpanel/utils","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/community/survey/model/survey-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/utils/exalead-interceptor"],function(e,t,i,n,o,s){return i.extend(s,{_collectionName:"survey-collection",model:n,modes:["community-surveys","community-stats-surveys","open-community-surveys","latestContributions"],exaleadContentType:"survey",_asAdmin:!1,_associations:{community:{Class:o}},_services:{read:{"community-surveys":{url:"api/feed/whatsnew",dataFn:function(e){return{content_type:"survey",community_id:this.communityId,...e}}},"community-stats-surveys":{url:"api/analytics/infosurvey",dataFn:function(t){return t&&t.page&&delete t.page,t&&t.limit&&delete t.limit,e.extend(t||{},{community_id:this.getAssociated("community").get("mid"),page_size:this._limit,page_number:this._currentPage-1,as_admin:this._asAdmin})}},latestContributions:{url:"api/exalead/whatsnew",paramsMapping:{limit:"nresults",startFrom:"start"},dataFn:function(e){return{legacyFormat:!1,community_id:this.communityId,contentType:this.exaleadContentType,query:"#all",with_synthesis:!0,order_by:"desc",order_field:"ds6w_58_lastcontributed",start:(this._currentPage-1)*this._limit,nresults:this._limit,...e}},tagsWithoutSubjectURI:!0,parse:t.parseSearchResult}},filter:{"community-surveys":{url:"api/exalead/search",dataFn:function(t){var i=this.communityId||this.getAssociated("community").get("mid");return e.extend(t||{},{refineUsingQuery:i?'community_id:"'+i+'"':null,contentType:this.exaleadContentType})},tagsWithoutSubjectURI:!0},"open-community-surveys":{url:"api/exalead/search",dataFn:function(t){var i=this.communityId||this.getAssociated("community").get("mid");return e.extend(t||{},{refineUsingQuery:(i?'community_id:"'+i+'"':"")+' -categories:"ds6w/ds6w:what/ds6w:status/implicit/xsd:string/ds6w:status.swym_survey_closed"',contentType:this.exaleadContentType})},tagsWithoutSubjectURI:!0},latestContributions:{url:"api/exalead/whatsnew",paramsMapping:{limit:"nresults",startFrom:"start"},dataFn:function(e){return{legacyFormat:!1,community_id:this.communityId,contentType:this.exaleadContentType,query:"#all",with_synthesis:!0,order_by:"desc",order_field:"ds6w_58_lastcontributed",start:(this._currentPage-1)*this._limit,nresults:this._limit,...e}},tagsWithoutSubjectURI:!0}}},setup:function(t,i){return i.communityId&&(this.communityId=i.communityId),i.only_not_answered_by_me&&(this.only_not_answered_by_me=i.only_not_answered_by_me),e.is(i.asAdmin)&&(this._asAdmin=i.asAdmin),this.addEvent("onSync:remove",this.refresh,this),this._parent(t,i)}})}),define("DS/SwymUICore/script/feature/community/community/collection/community-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/lib/model/generic/swym-model"],function(e,t,i,n){"use strict";var o=null,s=function(e){return 0===e.title.indexOf(i.DIRECT_MESSAGE_PREFIX)},r=function(e){return 0!==e.title.indexOf(i.DIRECT_MESSAGE_PREFIX)},a=t.extend({_hashKey:null,_onlyWithStatsAccess:!1,_filters:null,_collectionName:"community-collection",_updatableOptions:{listeners:["threadCreation"],add:{append:!0}},_services:{getmyblacklist:{"my-communities-detailed":{url:"api/userPreferences/getmyblacklist",dataFn:function(){return{model:"Community"}}}},read:{"my-communities-people":{url:"/api/community/getsharednonpubliccommunities",dataFn:function(){return{limit:this._limit,page:this._currentPage,hash_key:this._hashKey}}},"my-communities":{url:"api/community/listmycommunities",dataFn:function(e){return{limit:this._limit,page:this._currentPage,only_with_stats_access:this._onlyWithStatsAccess,order:e&&e.order?e.order:void 0,without_favorites:e&&e.without_favorites?e.without_favorites:void 0}}},"my-dm-communities":{url:"api/community/listmycommunities",dataFn:function(e){return{limit:999,page:this._currentPage,only_with_stats_access:this._onlyWithStatsAccess,order:e&&e.order?e.order:void 0,without_favorites:e&&e.without_favorites?e.without_favorites:void 0}},parse:function(e){return e=e.filter(s)}},"my-non-dm-communities":{url:"api/community/listmycommunities",dataFn:function(e){return{limit:this._limit,page:this._currentPage,only_with_stats_access:this._onlyWithStatsAccess,order:e&&e.order?e.order:void 0,without_favorites:e&&e.without_favorites?e.without_favorites:void 0}},parse:function(e){return e=e.filter(r)}},"my-favorites-communities":{url:"api/community/listmycommunities",dataFn:function(e){return{limit:5,page:this._currentPage,only_with_stats_access:this._onlyWithStatsAccess,order:e&&e.order?e.order:void 0}},parse:function(t){return e.is(t.values,"array")?t.values:t}},"all-my-communities":{url:"api/community/listmycommunities",dataFn:function(){return{limit:this._limit,page:this._currentPage,only_with_stats_access:this._onlyWithStatsAccess}}},"my-communities-with-iquestion-enabled":{url:"api/community/listmycommunities",dataFn:function(e){return{feature_enabled_for:"iquestion",with_pagination:void 0!==e.with_pagination?e.with_pagination:this._currentPage>0,limit:this._limit,page:this._currentPage,only_with_stats_access:this._onlyWithStatsAccess}}},"my-communities-with-idea-enabled":{url:"api/community/listmycommunities",dataFn:function(e){return{feature_enabled_for:"ideation",with_pagination:void 0!==e.with_pagination?e.with_pagination:this._currentPage>0,limit:this._limit,page:this._currentPage,only_with_stats_access:this._onlyWithStatsAccess}}},"my-communities-with-wiki-enabled":{url:"api/community/listmycommunities",dataFn:function(e){return{feature_enabled_for:"wikitree",with_pagination:void 0!==e.with_pagination?e.with_pagination:this._currentPage>0,limit:this._limit,page:this._currentPage,only_with_stats_access:this._onlyWithStatsAccess}}},"my-communities-with-survey-enabled":{url:"api/community/listmycommunities",dataFn:function(e){return{feature_enabled_for:"survey",with_pagination:void 0!==e.with_pagination?e.with_pagination:this._currentPage>0,limit:this._limit,page:this._currentPage,only_with_stats_access:this._onlyWithStatsAccess}}},"discover-communities":{url:"api/community/discovercommunities",parse:function(e){return e&&e.length>0&&e.forEach(function(e){e.hasUserAccess=!1}),e}},"my-communities-detailed":{url:"api/community/listmycommunities",dataFn:function(){return{limit:this._limit,filters:this._filters,page:this._currentPage}}},"discover-communities-detailed":{url:"api/community/discovercommunities",parse:function(e){return e&&e.length>0&&e.forEach(function(e){e.hasUserAccess=!1}),e}},"communities-with-rights":{url:"api/community/listmycommunities",dataFn:function(e){return{limit:this._limit,creation_granted_for:e&&e.model||this.getModel()}}},"tenant-communities":{url:"admin/api/member/gettenantcommunities",dataFn:function(t){return e.merge(t,{context:"tenant",query:t.query||null,limit:this._limit,page:this._currentPage,start:(parseInt(this._currentPage,10)-1)*this._limit})}},listmypublicprivatecommunities:{url:"api/community/listmycommunities",dataFn:function(){return{without_secret_communities:!0,limit:this._limit,page:this._currentPage}}},findCommunity:{url:"api/exalead/search",dataFn:function(t){var i=t&&t.model||this.getModel();return e.merge(t,{query:"#all",myCommunitiesOnly:!0,with_synthesis:!1,contentType:"community",nresults:this._limit,creation_granted_for:i?[i]:void 0})},parse:function(){return this._defaultParsingFn.apply(this,arguments)}}},filter:{"my-communities":{url:"api/exalead/search",dataFn:function(t){return e.extend(t||{},{myCommunitiesOnly:!0,withNoTags:!0})},tagsWithoutSubjectURI:!0},"all-my-communities":{url:"api/exalead/searchmycommunities",tagsWithoutSubjectURI:!0},"tenant-communities":{url:"api/exalead/search",dataFn:function(t){return e.extend(t||{},{as_admin:!0})},tagsWithoutSubjectURI:!0},"discover-communities":{url:"api/exalead/searchdiscovercommunities",tagsWithoutSubjectURI:!0},"my-non-dm-communities":{url:"api/exalead/search",dataFn:function(t){return e.extend(t||{},{myCommunitiesOnly:!0,withNoTags:!0!==this.fetchTagsSeparatelyOnRefresh})},tagsWithoutSubjectURI:!0},"my-communities-detailed":{url:"api/exalead/searchmycommunities",tagsWithoutSubjectURI:!0},findCommunity:{url:"api/exalead/search",tagsWithoutSubjectURI:!0,dataFn:function(t){var i=t&&t.model||this.getModel();return e.merge(t,{query:"#all",myCommunitiesOnly:!0,with_synthesis:!1,contentType:"community",nresults:this._limit,creation_granted_for:i?[i]:void 0})}}}},model:i,modes:["my-communities-people","my-communities","all-my-communities","my-communities-with-iquestion-enabled","my-communities-with-idea-enabled","my-communities-with-wiki-enabled","my-communities-with-survey-enabled","discover-communities","my-communities-detailed","discover-communities-detailed","communities-with-rights","tenant-communities","listmypublicprivatecommunities","my-favorites-communities","my-dm-communities","my-non-dm-communities","findCommunity"],exaleadContentType:"community",loadingStatus:n.STATUS.notRequested,init:function(e,t){return t&&t.filters&&this.setFilters(t.filters),t&&t.hash_key&&this.setHashKey(t.hash_key),t&&t.only_with_stats_access&&this.setOnlyWithStatsAccess(t.only_with_stats_access),t&&t.modelParam&&this.setModel(t.modelParam),t&&void 0!==t.directMessage&&(this._directMessage=t.directMessage),this._parent(e,t)},getHashKey:function(){return this._hashKey},setHashKey:function(e){this._hashKey=e},setOnlyWithStatsAccess:function(e){this._onlyWithStatsAccess=e},setModel:function(e){this.modelParam=e},getModel:function(){return this.modelParam},getFilters:function(){return this._filters},isDMCommunityList:function(){return this._directMessage},setFilters:function(e,t){this._filters=e,!0===t&&this.resetCollection()},_setIsBlacklistedAttribute:function(){o&&o.length>0&&o.forEach(function(e){e.set("isBlacklisted",!0)})},getBlacklistedCommunitiesCollection:function(e){var t=this;return o?e&&e():(o=new a([],{mode:"my-communities-detailed",limit:99999})).getmyblacklist({onComplete:function(i){o=i,t._setIsBlacklistedAttribute(),e&&e()},onFailure:function(){e&&e()}}),o},getmyblacklist:function(e){return this.action("getmyblacklist",e)},"onRequest:read":function(){this.loadingStatus=n.STATUS.pending,this.dispatchEvent("onLoadingStatusChange",[this])},"onSync:read":function(){this.loadingStatus=n.STATUS.valid,this.dispatchEvent("onLoadingStatusChange",[this])},"onError:read":function(){this.loadingStatus=n.STATUS.invalid,this.dispatchEvent("onLoadingStatusChange",[this])}});return a}),define("DS/SwymUICore/script/feature/core/realtime/realtime-whatsnew-manager",["require","exports","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/core/realtime/rt-connector","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/community/community/collection/community-collection"],function(e,t,i,n,o,s){"use strict";return function(){function e(e){n.init(),this.callback=e,this.listenToContentCreation()}return e.prototype.isANonProcessedMedia=function(e){return e&&e.message_details&&"Media"===e.message_details.model&&"processed"!==e.message_details.preview_media_processing_status},e.prototype.listenToContentCreation=function(){var e=this;this.indexForRTSubscription=n.subscribe(function(t){var n=i.getInstance().get("user").login;t&&"INTERNAL_CONTENT"===t.message_type&&t.author&&t.author.login!==n&&"dm"!==t.community_type&&!e.isANonProcessedMedia(t)&&s.prototype.getBlacklistedCommunitiesCollection(function(){new o({mid:t.community_id}).get("isBlacklisted")||e.callback(t)})})},e.prototype.destroy=function(){n.unsubscribe(this.indexForRTSubscription),this.indexForRTSubscription=null},e}()}),define("DS/SwymUICore/script/feature/community/social-event/model/topic-model",["require","exports","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/comment/collection/comment-collection","DS/SwymUICore/script/feature/core/user/collection/commenters-collection","DS/SwymUICore/script/feature/community/social-event/collection/takeaway-collection","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/community/social-event/model/takeaway-model","DS/SwymUICore/script/feature/community/social-event/collection/pres-support-collection","DS/SwymUICore/script/feature/community/social-event/model/pres-support-model"],function(e,t,i,n,o,s,r,a,c,u,l,d){"use strict";return i.extend({_modelName:"topic",_isCollapsed:!1,defaults:{id:"",title:"",uri:"",description:"",position:0,access_state:"",minutes:"",duration:0},HTML_ATTRIBUTES:["title","description","minutes"],_attributesMapping:{uri:"subject6wuri",id:"id"},_associations:{comments:{Class:n,oppositeRole:"commented",options:{mode:"topic"}},commenters:{Class:o,oppositeRole:"commented",options:{mode:"comment"}},speakers:{Class:r},takeaways:{Class:s},presentationSupports:{Class:l,sourceAttribute:"presentation_supports"}},previousTopicAttributes:{},isCollapsed:function(){return this._isCollapsed},addEmptyTakeaway:function(e){var t=this.getAssociated("takeaways"),i=Object.assign(e,{position:t.length+1}),n=new u(i,{});t.add(n)},addEmptyPresentationSupport:function(e){var t=this.getAssociated("presentationSupports"),i=new d(e,{});t.add(i)},savePreviousAttributes:function(){this.previousTopicAttributes={minutes:this.get("minutes"),takeaways:this.getAssociated("takeaways").toArray()}},restorePreviousTopicAttributes:function(){this.set("minutes",this.previousTopicAttributes.minutes),this.setAssociated("takeaways",new s(this.previousTopicAttributes.takeaways))},setCollapsed:function(e){this._isCollapsed=e,this.dispatchEvent("onChange"),this.dispatchEvent("onTopicCollapseChange")},resetCollapsed:function(){this._isCollapsed=!1},getCommunity:function(){var e=a.getInstance();return new c({id:e.communityId})},isNew:function(){return!1},destroy:function(e){this.dispatchEvent("onTopicRemove",this)}})}),define("DS/SwymUICore/script/feature/community/post/model/post-derived-type-model",["require","exports","DS/SwymUICore/script/feature/community/post/model/post-model","DS/SwymUICore/script/feature/community/derived-type/derived-type-styles-manager","DS/SwymUICore/script/feature/community/derived-type/derived-type-data-utils","DS/SwymUICore/script/feature/core/context/context-constants"],function(e,t,i,n,o,s){"use strict";return i.extend({_attributesMapping:{container:"community",body:"content"},init:function(e){var t=null;return e&&e.derived_type&&(t=e.derived_type)&&t.id&&(n.addDerivedTypeStyle(t),this._iconCls=o.createIconWrapperClassForDerivedTypeModel(t),this._iconWrapperCls=o.createIconWrapperClassForDerivedTypeModel(t)),this._parent.apply(this,arguments)},set:function(e,t,i){var s=null;return"object"==typeof e&&e.derived_type?s=e.derived_type:"derived_type"===e&&(s=t),s&&s.id&&(n.addDerivedTypeStyle(s),this._iconCls=o.createIconClassForDerivedTypeModel(s),this._iconWrapperCls=o.createIconWrapperClassForDerivedTypeModel(s)),this._parent(e,t,i)},canUpdate:function(){var e=this.get("acl");return e&&e.update},canDelete:function(){var e=this.get("acl");return e&&e.delete},getIconClass:function(){return this._iconCls},getIconWrapperClass:function(){return this._iconWrapperCls},getContentType:function(){var e=this.get("derived_type");return e?"".concat(s.POST_DERIVED_TYPE_PREFIX).concat(e.id):this._parent()},_services:{read:{urlFn:function(){return"api/v2/posts/"+this.get("mid")},method:"GET"},create:{url:"api/v2/posts",wrapData:!1,paramsMapping:{mid:"community_post_id",content:"body",contentType:"derived_type_id",community_id:"container_id"},dataFn:function(e){return(e=e||{}).publication_state=1===e.published?"PUBLISHED":"DRAFT",delete e.published,e.withThumbnailsInfo=!0,e}}}})});__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};var __spreadArray=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var n,o=0,s=t.length;o<s;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};define("DS/SwymUICore/script/feature/community/post/collection/post-derived-type-collection",["require","exports","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/community/post/model/post-derived-type-model","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/community/derived-type/derived-type-data-utils","DS/SwymUICore/script/lib/6wpanel/utils"],function(e,t,i,n,o,s,r){"use strict";var a=o.getInstance();return i.extend({_collectionName:"post-dt-collection",_services:{filter:{"fake-filtered-post-derived-type":{urlFn:function(){return"/api/v2/communities/".concat(this.communityId,"/posts")},method:"GET",dataFn:function(){return{derived_type_id:this.typeId}},parse:function(e){return e}},latestContributions:{url:"api/exalead/whatsnew",paramsMapping:{limit:"nresults",startFrom:"start"},dataFn:function(e){return __assign({legacyFormat:!1,community_id:this.communityId,contentType:"posts",query:"#all",with_synthesis:!0,order_by:"desc",order_field:"ds6w_58_lastcontributed",start:(this._currentPage-1)*this._limit,nresults:this._limit,derived_type_id:this.typeId},e)},tagsWithoutSubjectURI:!0,parse:function(e){return r.parseSearchResult(e).map(function(e){var t=e;return t.derived_type=s.createDerivedTypeDataFromTags(e),t})}}},read:{"fake-filtered-post-derived-type":{urlFn:function(){return"/api/v2/communities/".concat(this.communityId,"/posts")},method:"GET",dataFn:function(){return{derived_type_id:this.typeId}}},latestContributions:{url:"api/exalead/whatsnew",paramsMapping:{limit:"nresults",startFrom:"start"},dataFn:function(e){return __assign({legacyFormat:!1,community_id:this.communityId,contentType:"posts",query:"#all",with_synthesis:!0,order_by:"desc",order_field:"ds6w_58_lastcontributed",start:(this._currentPage-1)*this._limit,nresults:this._limit,derived_type_id:this.typeId},e)},tagsWithoutSubjectURI:!0,parse:function(e){return r.parseSearchResult(e).map(function(e){var t=e;return t.derived_type=s.createDerivedTypeDataFromTags(e),t})}}}},typeId:null,communityId:null,model:n,modes:["fake-filtered-post-derived-type","latestContributions"],setup:function(e,t){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var o=a.getCommunityPageContext(),r=s.getDerivedTypeIdFromCommunityPageName(o);return this.typeId=r||null,t.communityId&&(this.communityId=t.communityId),this._parent.apply(this,__spreadArray([e,t],i,!1))}})}),define("DS/SwymUICore/script/feature/core/favorite/model/favorite-communities-model",["DS/SwymUICore/script/feature/community/community/model/community-model"],function(e){"use strict";return e.extend({_modelName:"community",_attributesMapping:{external_id:"mid"},defaults:{isFavorite:!0},_services:{read:{url:"api/favorites/communities",method:"GET",dataFn:function(e){return{external_id:e.external_id,position:e.position}}},update:{url:"api/favorites/communities",wrapData:!1,dataType:"json",method:"PATCH",dataFn:function(e){return{external_id:e.external_id,position:e.position}}},remove:{url:"api/favorites/communities",method:"DELETE",dataType:"json",wrapData:!1,dataFn:function(e){return{external_id:e.external_id}}}},remove:function(e){return this.action("remove",e)},validateField:function(e,t){return!1},getModelName:function(){return"community"},get:function(e,t){return t={escapeHTML:!1},this._parent.apply(this,[e,t])}})}),define("DS/SwymUICore/script/feature/core/favorite/model/favorite-dm-model",["DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model"],function(e,t,i){"use strict";return i.extend({_modelName:"dm",_cacheKey:"dm",_attributesMapping:{external_id:"mid"},_associations:{users:{Class:t,options:{mode:"listmembers",limit:20}}},_services:{read:{url:"api/favorites/directmessages",method:"GET",dataFn:function(e){return{external_id:e.external_id,position:e.position}}},update:{url:"api/favorites/directmessages",wrapData:!1,dataType:"json",method:"PATCH",dataFn:function(e){return{external_id:e.external_id,position:e.position}}},remove:{url:"api/favorites/directmessages",method:"DELETE",dataType:"json",wrapData:!1,dataFn:function(e){return{external_id:e.external_id}}}},remove:function(e){return this.action("remove",e)},get:function(e,t){return t={escapeHTML:!1},this._parent.apply(this,[e,t])}})}),define("DS/SwymUICore/script/feature/community/social-event/collection/topic-collection",["require","exports","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/community/social-event/model/topic-model"],function(e,t,i,n){"use strict";return i.extend({model:n,modes:["topics"],_associations:{container:{}},setup:function(e,t){return this.addEvent("onTopicRemove",this.removeTopic,this),this.addEvent("onTopicCollapseChange",this._onTopicCollapseChange,this),this._parent(e,t)},collapseAll:function(){this.forEach(function(e){e.setCollapsed(!0)}),this.dispatchEvent("onChange")},expandAll:function(){this.forEach(function(e){e.setCollapsed(!1)}),this.dispatchEvent("onChange")},_onTopicCollapseChange:function(){this.dispatchEvent("onTopicViewModeChange")},resetCollapseStates:function(){this.forEach(function(e){e.resetCollapsed()})},removeTopic:function(e){this.length>0&&(this.remove(e),this.forEach(function(e,t){e.set("position",t+1)}))},ascendTopic:function(e){var t=this.indexOf(e);t>0&&(this.remove(e,{silent:!0}),this.add(e,{at:t-1}),this.forEach(function(e,t){e.set("position",t+1)}))},descendTopic:function(e){var t=this.indexOf(e);t<this.length&&(this.remove(e,{silent:!0}),this.add(e,{at:t+1}),this.forEach(function(e,t){e.set("position",t+1)}))}})});__spreadArray=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var n,o=0,s=t.length;o<s;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};define("DS/SwymUICore/script/feature/community/social-event/model/social-event-model",["require","exports","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/feature/community/comment/collection/comment-collection","DS/SwymUICore/script/feature/core/user/collection/commenters-collection","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/community/media/collection/media-collection","DS/SwymUICore/script/feature/community/social-event/collection/topic-collection","DS/SwymUICore/script/feature/community/social-event/model/topic-model"],function(e,t,i,n,o,s,r,a,c){"use strict";return i.extend({defaults:{id:"",title:"",description:"",duration:0,start_date:"",scribe:null,external_users:[],isReportPublished:!1,minutes:"",publication_state:""},_iconCls:"calendar",_iconWrapperCls:"social-event",_modelName:"social-event",_tableName:"CommunityConference",_attributesMapping:{uri:"subject6wuri",resourceid:"subject6wuri",description:"content"},_associations:{thumbnail:{Class:s},comments:{Class:n,oppositeRole:"commented",options:{mode:"post"}},commenters:{Class:o,oppositeRole:"commented",options:{mode:"comment"}},embeddedMedia:{Class:r,sourceAttribute:"thumbnails_infos",options:{limit:2,mode:"communityMedia"}},topics:{Class:a,oppositeRole:"container"}},HTML_ATTRIBUTES:["enhanced_summary","content","app_join_uri","minutes"],init:function(e,t){return e&&e.subject6wuri&&(e.mid=e.subject6wuri),this._parent(e,t)},set:function(e,t,i){return"object"==typeof e&&e.subject6wuri?e.mid=e.subject6wuri:"subject6wuri"===e&&this.set("mid",t),this._parent(e,t,i)},addEmptyTopic:function(){var e=this.getAssociated("topics"),t=new c({position:e.length+1},{});e.add(t)},isRdvFromRitual:function(){return!0===this.get("from_ritual")||"true"===this.get("from_ritual")},getIconClass:function(){return this.isRdvFromRitual()?"calendar-clock":this._iconCls},getEndDate:function(){var e=new Date(this.get("start_date")),t=Math.floor(this.get("duration")/60),i=this.get("duration")%60;return e.setHours(e.getHours()+t),e.setMinutes(e.getMinutes()+i),e},isSocialEventNow:function(){var e=!1,t=new Date(this.get("start_date")),i=t&&(t.getTime()-Date.now())/36e5;return i&&i<3&&i>=-3&&(e=!0),e},_services:{create:{method:"POST",timeout:6e4,urlFn:function(){var e=this.getCommunity().get("subject6wuri");return"api/communities/".concat(e,"/conferences")},wrapData:!1,dataFn:function(e){return{provider:e.provider,title:e.title,description:e.content,start_date:e.start_date,topics:e.topics||[],duration:e.duration,external_users:e.external_users,scribe:e.scribe,tags6w:e.tags6w,taggingActions6w:e.taggingActions6w}},parse:function(e){return e.uri&&(e.subject6wuri=e.uri),e&&e.provider_join_uri&&(e.app_join_uri=e.provider_join_uri),e}},update:{method:"PUT",timeout:6e4,urlFn:function(){var e=this.get("mid");return"api/conferences/".concat(e)},wrapData:!1,dataType:"json",dataFn:function(e){var t=Object.assign(this.getAttributes(),{title:this.get("title",{escapeHTML:!1})});return Object.assign(e,t),e&&e.content&&(e.description=e.content),e},parse:function(e){return e.uri&&(e.subject6wuri=e.uri),e&&e.provider_join_uri&&(e.app_join_uri=e.provider_join_uri),e&&e.content&&(e.description=e.content),e}},read:{urlFn:function(){var e=this.get("subject6wuri")||this.get("mid");return"api/conferences/".concat(e)},method:"GET",parse:function(e){return e}},delete:{urlFn:function(){var e=this.get("mid");return"api/conferences/".concat(e)},method:"DELETE"}},hasTopics:function(){return this.getAssociated("topics").length>0},getRssLink:function(e){return e||(e=10),"/rss/feed/whatsnew/model/conference/limit/".concat(e,"/community_id/").concat(this.getCommunity().get("mid"),"/model_id/").concat(this.get("mid"))},deleteContribution:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.action.apply(this,__spreadArray(["delete"],e,!1))}})}),define("DS/SwymUICore/script/feature/community/idea/model/link-model",["DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/community/model/community-model"],function(e,t){"use strict";return e.extend({_modelName:"idea-link",_attributesMapping:{id:"mid",community_id:"community->mid",community_title:"community->title"},_associations:{community:{Class:t},linkedModel:{}},_services:{create:{url:"api/IdeationLink/add",paramsMapping:{content_title:"title"}},delete:{url:"api/IdeationLink/delete",dataFn:function(){return{ideation_link_id:this.get("mid")}}}},linksToEnoviaObject:function(){var e=this.get("type");return e.includes("enovia-object:")||e.includes("enovia_")}})}),define("DS/SwymUICore/script/feature/community/ritual/model/ritual-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/community/media/collection/media-collection","DS/SwymUICore/script/feature/community/social-event/model/topic-model","DS/SwymUICore/script/feature/community/social-event/collection/topic-collection"],function(e,t,i,n,o,s){"use strict";return t.extend({defaults:{id:"",title:"",description:"",duration:0,start_date:"",end_date:"",external_users:[]},_iconCls:"calendar-clock",_iconWrapperCls:"ritual",_modelName:"ritual",_tableName:"CommunityRitual",_attributesMapping:{uri:"subject6wuri",description:"content"},_associations:{thumbnail:{Class:i},embeddedMedia:{Class:n,sourceAttribute:"thumbnails_infos",options:{limit:2,mode:"communityMedia"}},topics:{Class:s}},HTML_ATTRIBUTES:["enhanced_summary","content","app_join_uri"],addEmptyTopic:function(){const e=this.getAssociated("topics"),t=new o({position:e.length+1},{});e.add(t)},_services:{create:{method:"POST",timeout:6e4,urlFn:function(){return"api/communities/"+this.getCommunity().get("subject6wuri")+"/rituals"},wrapData:!1,dataFn:function(e){return{description:e.description,duration:e.duration,external_users:e.external_users,provider:e.provider,recurrence:e.recurrence,start_date:e.start_date,end_date:e.end_date,title:e.title,topics:e.topics}},parse:function(e){return e.uri&&(e.subject6wuri=e.uri),e&&e.provider_join_uri&&(e.app_join_uri=e.provider_join_uri),e}},read:{urlFn:function(){return"api/rituals/"+this.get("mid")},method:"GET",parse:function(e){return e}},delete:{urlFn:function(){return"api/rituals/"+this.get("mid")},method:"DELETE"}},hasTopics:function(){return this.getAssociated("topics").length>0},hasCurrentUserAccess:function(){return!0},getRssLink:function(e){return e||(e=10),"/rss/feed/whatsnew/model/ritual/limit/"+e+"/community_id/"+this.getCommunity().get("mid")+"/model_id/"+this.get("mid")},validateField:function(e,t){switch(e){case"content":return!1;default:return this._parent(e,t)}}})}),define("DS/SwymUICore/script/feature/thread/collection/thread-lite-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/community/ritual/model/ritual-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model"],(e,t,i,n,o)=>{const s=function(e){return e.result.map(e=>{const t=e;return t.hasUserAccess=!0,t.user_access=1,Object.hasOwnProperty.call(t,"users")&&(t.subject6wuri=t.subject_uri),t})};return t.extend({_collectionName:"thread-lite-collection",_services:{read:{community:{url:"api/communities/lite?with_favorites=false",method:"GET",parse:e=>e.map(e=>{const t=e;return t.isBlacklisted=t.is_hidden,t.subject6wuri=t.subject_uri,t.community_type="community",delete t.is_hidden,t}),postProcess:s,dataFn:()=>({})},conversation:{url:"api/directmessages/lite?with_favorites=false",method:"GET",parse:e=>e.map(e=>{const t=e;return t.subject6wuri=t.subject_uri,t.community_type="dm",t}),postProcess:s,dataFn:()=>({})},rituals:{url:"api/rituals",method:"GET",postProcess:s,dataFn:()=>({})}},lastMessage:{community:{method:"GET",dataFn:()=>({}),postProcess(t){e.is(t,"object")&&e.is(t.result,"array")&&t.result.forEach(function(e){new("conversation"===this.mode?o:n)({mid:e.community_id}).set("last_message",e)},this)}},conversation:{method:"GET",dataFn:()=>({}),postProcess(t){e.is(t,"object")&&e.is(t.result,"array")&&t.result.forEach(function(e){new("conversation"===this.mode?o:n)({mid:e.community_id}).set("last_message",e)},this)}}},filter:{community:{url:"api/exalead/search",method:"POST",dataFn:t=>e.extend(t||{},{contentType:"community",limit:100,with_synthesis:!1}),tagsWithoutSubjectURI:!0},conversation:{url:"api/exalead/search",method:"POST",dataFn:t=>e.extend(t||{},{contentType:"directmessage",limit:100,with_synthesis:!1}),tagsWithoutSubjectURI:!0}}},modes:["community","conversation","rituals"],getLastMessage(){const e={};let t,i,n,o;const s=this.length&&this.slice(Math.floor((this.length-1)/this.getLimit())*this.getLimit(),this.length-1).map(e=>{const t=e.get("last_message")&&e.get("last_message").message_id,i=e.get("mark")&&e.get("mark").message_id;let n=!1;return!t||i&&i===t||(n=!0),n&&t}).filter(Boolean);if(s.length>0){o=Math.ceil(s.length/10);for(let r=0;r<o;r+=1)i=10*r,n=Math.min(10*(r+1),s.length),t=s.slice(i,n),e.url=`api/community/timeline/messages/${t.join(",")}`,e.remove=!1,this.action("lastMessage",e)}},init(e,t,...s){const r=t;switch(r.mode){case"conversation":this.model=o;break;case"ritual":this.model=i;break;default:this.model=n}r.limit=10,this._parent(e,r,...s)}})}),define("DS/SwymUICore/script/feature/community/wiki/collection/wiki-collection",["UWA/Core","DS/SwymUICore/script/lib/6wpanel/utils","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/community/wiki/model/wiki-model","DS/SwymUICore/script/utils/exalead-interceptor"],function(e,t,i,n,o){"use strict";return i.extend(o,{_collectionName:"wiki-collection",_services:{read:{community:{url:"api/feed/whatsnew",dataFn:function(e){return{content_type:"wikipage",community_id:this.communityId,...e}}},latestContributions:{url:"api/exalead/whatsnew",paramsMapping:{limit:"nresults",startFrom:"start"},dataFn:function(e){return{legacyFormat:!1,community_id:this.communityId,contentType:this.exaleadContentType,query:"#all",with_synthesis:!0,order_by:"desc",order_field:"ds6w_58_lastcontributed",start:(this._currentPage-1)*this._limit,nresults:this._limit,...e}},tagsWithoutSubjectURI:!0,parse:t.parseSearchResult}},filter:{community:{url:"api/exalead/whatsnew",dataFn:function(t){return t&&delete t.content_type,e.merge({contentType:this.exaleadContentType,legacyFormat:!1,community_id:this.communityId,with_synthesis:!0},t||{})},tagsWithoutSubjectURI:!0},communityLastUpdatedWiki:{url:"api/exalead/search",dataFn:function(e){return{query:"#all",contentType:this.exaleadContentType,limit:this._limit,legacyFormat:!1,order_field:"update",order_by:"desc",refineUsingQuery:'community_id:"'+this.communityId+'"',...e}}},latestContributions:{url:"api/exalead/whatsnew",paramsMapping:{limit:"nresults",startFrom:"start"},dataFn:function(e){return{legacyFormat:!1,community_id:this.communityId,contentType:this.exaleadContentType,query:"#all",with_synthesis:!0,order_by:"desc",order_field:"ds6w_58_lastcontributed",start:(this._currentPage-1)*this._limit,nresults:this._limit,...e}},tagsWithoutSubjectURI:!0}}},model:n,modes:["community","communityLastUpdatedWiki","latestContributions"],exaleadContentType:"wikitree",setup:function(e,t){t.communityId&&(this.communityId=t.communityId)}})}),define("DS/SwymUICore/script/feature/community/wiki/model/wikitree-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/wiki/model/wiki-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/community/wiki/collection/wiki-collection"],function(e,t,i,n,o){"use strict";return t.extend({_modelName:"wikitree",_attributesMapping:{community_id:"community->mid"},currentPage:null,_associations:{community:{Class:n}},_services:{read:{url:"api/WikiTree/getfulltree",timeout:6e4,dataFn:function(){return{community_id:this.getCommunity().get("mid")}},parse:function(e){if(Array.isArray(e)&&e.length>0){for(let t=0;t<e.length-1;t++)e[t].depth>=e[t+1].depth?e[t].hasChild=!1:e[t].hasChild=!0,e[e.length-1].hasChild=!1;return this.getAssociated("community")&&this.getAssociated("community").setAssociated("wiki",new o(e,{autoPopulate:!1,limit:9999})),{tree:e}}throw new Error("Problem with the result tree received")}},forwardToThread:{wrapData:!1,urlFn:function(){return"/api/wiki/forwardasync"},dataFn:function(e){return{community_uri:e.threadUri,target_uri:e.target,content_uri_list:e.sourceList}}},move:{url:"api/WikiTree/move",dataFn:function(e){return{id:e.id||this.getCustomProperty("currentPage").get("mid"),relation:e.relation,targetid:e.targetId||e.targetid}}}},init:function(e,t){return e&&e.community_id&&(e.mid=e.community_id),this._parent.call(this,e,t)},updateTreeNodeVisibility:function(e,t){this.get("tree").forEach(function(i){var n=i.id;(Array.isArray(e)&&e.indexOf(n)>=0||!Array.isArray(e)&&e===n)&&(i.visibility=t)})},isLeafNode:function(e){var t=this.get("tree");return Array.isArray(t)&&t.find(function(t,i,n){return t.id===e&&(i===n.length-1||t.depth>=n[i+1].depth)})},onCurrentPageDeleted:function(){this.getCustomProperty("currentPage").removeEvent("onDestroy",this.onCurrentPageDeleted,this),this.fetch()},onCurrentPageUpdated:function(e,t,i){var n=this.get("tree");this.hasBeenFetched()&&n?(n.forEach(function(t){t.id===e.get("mid")&&(t.title=e.get("title",{escapeHTML:!1}),t.visibility=e.get("visibility"))}),this.dispatchEvent("onModelUpdated",[e,t,i])):console.log("onCurrentPageUpdated: tree not fetched yet",e&&e.get("mid"))},setCurrentPage:function(e,n){var o,s=this.getCustomProperty("currentPage");if(e instanceof t)this.setCustomProperty("currentPage",e),o=e.get("mid");else if("string"==typeof e&&e)o=e,this.setCustomProperty("currentPage",new i({id:o}));else{if("number"!=typeof e)throw new Error("Current Page is not specified in the correct format");o=e,this.setCustomProperty("currentPage",new i({id:o}))}s&&(s.removeEvent("onDestroy",this.onCurrentPageDeleted,this),s.removeEvent("onSync:update",this.onCurrentPageUpdated,this)),this.getCustomProperty("currentPage").addEvent("onDestroy",this.onCurrentPageDeleted,this,-10),this.getCustomProperty("currentPage").addEvent("onSync:update",this.onCurrentPageUpdated,this),this.getCustomProperty("currentPage").addEvent("onSync:read",this.onCurrentPageUpdated,this);var r,a=0,c=this.get("tree");if(c&&(r=c.length))for(a=0;a<r;a++)if((e=c[a]).id===o){const t={...e};t.title&&delete t.title,this.getCustomProperty("currentPage").set(t);break}this.dispatchEvent("onCurrentPageChange",{id:o}),!0===n&&require(["DS/SwymUICore/script/utils/navigation"],function(e){e.goToContent(o,"wiki",this.get("community->mid"))}.bind(this))},move:function(e){return e.set=e.set||!1,this.action("move",e)},"onSync:move":function(){this.fetch()},setCurrentPageOnSync:function(){this.getCustomProperty("currentPage")&&this.setCurrentPage(this.getCustomProperty("currentPage"))},getCommunity:function(){return this.getAssociated("community")},getSubject6wuri:function(e){let t;return this.get("tree").forEach(i=>{i.id===e&&(t=i.subject6wuri)}),t},containsPrivatePage:function(){let e=!1;const t=this.get("tree");for(let i=0;i<t.length;i++)if(1!==t[i].visibility){e=!0;break}return e},getSubPages(e){const t=this.get("tree")||[],i=[],n=t.findIndex(t=>t.id===e);if(-1===n)return[];const o=t[n].depth;for(let e=n+1;e<t.length;e++){const n=t[e];if(n.depth<=o)break;i.push(n.id)}return i},forwardToThread:function(e){return this.action("forwardToThread",e)}})}),define("DS/SwymUICore/script/feature/community/timeline/model/external-event-model",["DS/SwymUICore/script/feature/community/timeline/model/event-model"],function(e){"use strict";return e.extend({_modelName:"external-event",getAuthorModelAttributes:function(){return this.get("author")}})}),define("DS/SwymUICore/script/feature/community/instant-message/model/instant-message-model",["UWA/Core","UWA/String","UWA/Utils","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/lib/request/data","DS/SwymUICore/script/lib/model/model-manager","DS/SwymUICore/script/feature/core/command/commands-controller","DS/SocialToolbar/Models/Subject","DS/SocialToolbar/Utils/SocialToolbarSharedOptions","DS/SwymUICore/script/utils/navigation"],function(e,t,i,n,o,s,r,a,c,u,l,d,m,h,p){"use strict";return n.extend({_modelName:"instant-message",_iconCls:"chat-alt",_iconWrapperCls:"message",_attributesMapping:{id:"mid",content:"richMessage"},HTML_ATTRIBUTES:["content","richMessage"],_associations:{community:{}},_customProperties:{subject:null,sharedOptions:null,commentModel:null},getCommunity:function(){return this.community},init:function(e,t){var i,n=this._parent.apply(this,arguments);if(!this.getCommentModel()){if(!(i=t&&t.commentInstance)&&e&&e.community){this.community="dm"===e.community.community_type?new s({community_id:e.community.mid}):new o({community_id:e.community.mid});var r={richMessage:e.richMessage,commentUri:e.subject6wuri,author:e.author,originalAuthor:e.originalAuthor},a=this._getSubject(this.community.get("subject6wuri")).getComments();(i=new(0,a.model)(r,{subject:this._getSubject(this.community.get("subject6wuri"))})).collection=a}i&&this.setCommentModel(i)}return n},setCommentModel:function(e){if(e){var t=this.getCommentModel();if(t)return t;this._customProperties.commentModel=e,this.listenTo(e,{"onChange:accessState":function(){e.get("accessState")===e.ACCESS_STATE.DELETED&&this.dispatchEvent("onStateChange",["DELETED_STATE"])}})}},getCommentModel:function(){return this._customProperties.commentModel},_getSubject:function(e){if(!this._customProperties.subject){var t=r.getInstance(),i=t.get("user");this._customProperties.sharedOptions=new h({"3DSwymUrl":a.getBaseUrl(),"3DSwymServerToken":t.getCSRFToken(),tenantId:t.get("config").tenant.online_instance_id,userLogin:i.login,userName:i.first_name+" "+i.last_name,serviceUrl:t.get("3dcommentUrl")||a.getBaseUrl()}),this._customProperties.subject=new m({subjectUri:e},{sharedOptions:this._customProperties.sharedOptions})}return this._customProperties.subject},getRelativePath:function(e,t,i){return e||!(e=this.get("community->mid"))&&this.get("community")&&(e=this.get("community").mid||this.get("community").id),t||(t=this.get("mid")),"string"!=typeof i&&(i="/message:"),p.URLPART_COMMUNITY+e+i+t},save:function(e,i){this.community=e.isDMContext?new s({community_id:e.community_id}):new o({community_id:e.community_id}),0!==t.unescapeHTML(e.content).indexOf("/")||e.isDMContext?t.unescapeHTML(e.content)&&this._saveOperations(e,i):d._getCommandFromHtmlStringIfExist(e.content,function(t){if(t){var n=this.community.getAssociated("bots");n._communityId=e.community_id,n.hasBeenFetched()?this._checkBotActivationInCommunity(n,t,e,i):n.goToPage(1,{onComplete:function(o){this._checkBotActivationInCommunity(n,t,e,i)}.bind(this),onFailure:function(){console.error("Call to retrieve bots has failed")}})}else this._saveOperations(e,i)}.bind(this))},_buildUrl:function(){return"api/community/"+this.community.get("mid")+"/instantmessages"},_checkBotActivationInCommunity:function(e,t,i,n){e.findWhere({"details->uri":t.botUsername})?(i.channel_name=this.community.get("title")||"",i.community_id=this.community.get("subject6wuri"),d.executePrimaryCommandIfInputMatched(i)):this._saveOperations(i,n)},_saveOperations:function(e,t){var n,o,s=this,a=r.getInstance().get("user"),c=this.getCommentModel(),u=i.getUUID(),d={author:{login:a.login,displayName:a.first_name+" "+a.last_name},accessState:null,commentUri:null,comments:null,endorsements:null,moderationState:null,parentCommentUri:null,richMessage:e.content,taggingActions6w:e.taggingActions6w};e.parentMessageUri&&(d.parentCommentUri=e.parentMessageUri),this.set("X-Request-ID",u),this.action("create",{wrapData:!1,data:d,headers:{"X-Request-ID":u},url:this._buildUrl(),onComplete:function(e,i){c.set(e.toJSON()),l.populate(s,{areModelDataFromServer:!0}),l.notify("onPublishing",[s]),"function"==typeof t.onComplete&&t.onComplete()},onFailure:function(){"function"==typeof t.onFailure&&t.onFailure(),l.notify("onCreationFailed",[this])}.bind(this)}),(c=this.getCommentModel())||(o=(n=this._getSubject(this.community.get("subject6wuri")).getComments()).model,(c=new o({author:{login:a.login,displayName:a.first_name+" "+a.last_name},accessState:null,commentUri:null,comments:null,endorsements:null,moderationState:null,parentCommentUri:null,richMessage:e.content,taggingActions6w:e.taggingActions6w},{subject:this._getSubject(this.community.get("subject6wuri"))})).collection=n,s.setCommentModel(c)),s.parentMessageUUID=e.parentMessageUUID,s.set(e),l.notify("onPrePublishing",[s])},_services:{create:{method:"POST"},forwardToThread:{wrapData:!1,urlFn:function(e){var t=e&&e.threadUri;return"api/community/"+encodeURIComponent(t)+"/instantmessages?source_uri="+encodeURIComponent(this.get("subject6wuri"))},dataFn:function(){return{}}}},defaults:{},set:function(e,t,i){var n,o;return e?((n=this.applyAttributesMapping(e,t)).hasOwnProperty("commentUri")&&(n.mid||(o=n.commentUri.split(":"),n.mid=o[o.length-1]),n.subject6wuri=n.commentUri),this._parent.call(this,n,i)):this}})}),define("DS/SwymUICore/script/feature/core/direct-message/collection/direct-message-collection",["DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/platform-utils"],function(e,t,i,n,o){"use strict";var s="",r="",a=n.getInstance();return a.executeWhenReady(function(){r=this.get("config").tenant.online_instance_id,o.getFedsearchURL(r).then(function(e){s=e})}),e.extend({modes:["my-dm-communities","findConversation"],_collectionName:"direct-message-collection",model:function(e,n){var o,s=e["ds6w:type"];return"pno:Person"===s?o=i:"swym:DirectMessage"===s&&(o=t),new o(e,n)},_services:{read:{findConversation:{wrapData:!1,noCsrfToken:!0,urlFn:function(){return s+"/search"},dataFn:function(e){return Object.assign({with_synthesis:!1,with_synthesis_attribute:!1,source:["swym"],tenant:r,start:0,label:"3DSwym-"+a.get("user").login+"-"+(new Date).getTime()},e)},parse:function(e){return Array.isArray(e&&e.results)?e.results.reduce(function(e,t){var i={};return t.attributes.forEach(function(e){i[e.name]=e.value}),e.push(i),e},[]):[]}}},filter:{findConversation:{url:"api/exalead/search",tagsWithoutSubjectURI:!0,dataFn:function(e){return Object.assign({query:"#all",myCommunitiesOnly:!0,with_synthesis:!1,contentType:"directmessage",nresults:this._limit},e)}}}}})}),define("DS/SwymUICore/script/feature/community/idea/collection/link-collection",["DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/community/idea/model/link-model"],function(e,t){return e.extend({_enoviaLink:null,_services:{read:{community:{url:"api/IdeationLink/list",dataFn:function(){if(!this.parentId){var e=this.getAssociated("linked");this.parentId=e&&e.get("mid")}return{ideation_id:this.parentId}}}}},_associations:{linked:{}},mode:null,modes:["community"],model:t,parentId:null,setup:function(e,t){t.parentId&&(this.parentId=t.parentId)},onAdd:function(e){var t,i,n;if("internal"===e.get("type")){switch(e.get("model")){case"CommunityPost":i="post",t="DS/SwymUICore/script/feature/community/post/model/post-model";break;case"Media":i="media",t="DS/SwymUICore/script/feature/community/media/model/media-model";break;case"QnaQuestion":i="iquestion",t="DS/SwymUICore/script/feature/community/iquestion/model/iquestion-model";break;case"Dsi_Ideation_Ideation":i="idea",t="DS/SwymUICore/script/feature/community/idea/model/idea-model";break;case"Dsi_DFSTree_WikiTree":i="wiki",t="DS/SwymUICore/script/feature/community/wiki/model/wiki-model";break;case"Survey":i="survey",t="DS/SwymUICore/script/feature/community/survey/model/survey-model";break;case"Wedo":i="wedo",t="DS/SwymUICore/script/feature/community/wedo/model/wedo-model"}require([t],function(t){n=new t({id:e.get("model_id")}),e.setAssociated("linkedModel",n),n.addEvent("onDestroy",function(){this.collection&&this.collection.remove(this)},e),this.dispatchEvent("onAddIdeaLink",e)}.bind(this)),e.set("contentTypeUrlPart",i)}return e},hasAnEnoviaLink:function(){var e=this;return new Promise(function(t){var i=function(){if(!e._enoviaLink){var i=e.find(function(e){return e.get("type").includes("enovia_")||e.get("type").includes("enovia-object:")});e._enoviaLink=i}t(void 0!==e._enoviaLink)};e.hasBeenFetched()?i():(e.addEvent("onSync:read",i),e.fetch())})},getEnoviaLink:function(){var e=this;return new Promise(function(t){e.hasAnEnoviaLink().then(function(){t(e._enoviaLink)})})},removeEnoviaLink:function(){var e=this;if(!this._enoviaLink)throw"There is no enovia link to remove!";return new Promise(function(t){e.remove(e._enoviaLink),e._enoviaLink.destroy({onComplete:function(){e._enoviaLink=null,t()}})})}})}),define("DS/SwymUICore/script/feature/community/idea/model/idea-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/feature/community/idea/model/link-model","DS/SwymUICore/script/feature/community/idea/collection/link-collection","DS/SwymUICore/script/feature/community/comment/collection/comment-collection","DS/SwymUICore/script/feature/core/user/collection/commenters-collection","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/community/idea/model/status-model","DS/SwymUICore/script/feature/community/idea/model/idea-type-model","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/idea/collection/status-collection","DS/SwymUICore/script/feature/community/media/collection/media-collection","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/utils/utils","DS/WebappsUtils/Console","i18n!DS/SwymUICore/assets/nls/feature/community/idea/idea-model"],function(e,t,i,n,o,s,r,a,c,u,l,d,m,h,p,g){return t.extend({_modelName:"idea",_tableName:"Dsi_Ideation_Ideation",_iconCls:"lamp",_iconWrapperCls:"idea",ideation_status:null,linkCollection:null,_attributesMapping:{id:"mid",crdate:"crdate",update:"update",message:"content",ideation_color:"status_color",color:"status_color"},_associations:{status:{Class:a},derived_type:{Class:c},thumbnail:{Class:r},comments:{Class:o,oppositeRole:"commented",options:{mode:"idea"}},links:{Class:n,oppositeRole:"linked",options:{mode:"community"}},commenters:{Class:s,oppositeRole:"commented",options:{mode:"comment"}},embeddedMedia:{Class:d,sourceAttribute:"thumbnails_infos",options:{limit:2,mode:"communityMedia"}}},_services:{create:{url:"api/Ideation/add",paramsMapping:{content:"message"},dataFn:function(e){return(e=e||{}).withThumbnailsInfo=!0,e}},read:{url:"api/Ideation/get",dataFn:function(){return{id:this.get("mid"),withThumbnailsInfo:!0}},parse:e=>(e&&e.thumbnails_infos&&(e.thumbnails_infos=h.formatThumbnailsInfos(e.thumbnails_infos)),e)},update:{url:"api/Ideation/update",paramsMapping:{mid:"id",content:"message"},dataFn:function(e){return(e=e||{}).withThumbnailsInfo=!0,e},parse:e=>(e&&e.thumbnails_infos&&(e.thumbnails_infos=h.formatThumbnailsInfos(e.thumbnails_infos)),e)},updateideationstatus:{url:"api/Ideation/updateideationstatus",dataFn:function(e){return p.log(e),{id:this.get("mid"),status_id:e.status_id,out:e.out,status_comment:e.status_comment}}},delete:{url:"api/community/deletecontribution",dataFn:function(){return{ideationIds:[this.get("mid")],community_id:this.get("community->mid")||this.get("community->id")}}}},defaults:{message:"",title:"",derived_type:{label:null,icon:null,color:null,name:null,id:null,parent:"COMMUNITY",communityId:null}},deleteContribution:function(e){return this.destroy(e)},getRelativePath:function(e,t,i){return"string"!=typeof i&&(i=m.URLCONTENT_IDEATION),this._parent.call(this,e,t,i)},editStatus:function(e){return this.action("updateideationstatus",e)},getLabelColor:function(){let e,t=this.get("status_color");return t||(t=(e=this.getStatus()).get("color")),this.isOut()?"#D8D8D8":t},getLabelTitle:function(){let e,t=this.get("status_title",{escapeHTML:!1});return t||(t=(e=this.getStatus()).get("title",{escapeHTML:!1})),this.isOut()?g.Out:t},getStatus:function(){var t;return this.hasAssociation("status")&&!this.getAssociated("status").get("mid")&&(t={mid:this.get("status_id"),title:this.get("status_title"),color:this.get("status_color")},e.is(t.color)||delete t.color,e.is(t.status_title)||delete t.status_title,this.setAssociated("status",new a(t))),this.getAssociated("status")},getIdeaType:function(){const e=this.getCommunity().get("mid");return this.set("derived_type->communityId",e),this.getAssociated("derived_type")},canChangeStatus:function(){return this.get("acl_status")||this.get("acl")&&this.get("acl").update_status},isOut:function(){var e=this.get("out");return!0===e||"1"===e},getLinks:function(){return this.getAssociated("links")},addLink:function(e,t){var n=new i,o=this;return e.ideation_id=this.get("mid"),n.save(e,{onComplete:function(e){o.getAssociated("links")&&o.getAssociated("links").unshift(e),n.linksToEnoviaObject()&&o.dispatchEvent("TransferChange",!0),t&&t.onComplete&&t.onComplete(e)},onFailure:function(e,i){t&&t.onFailure&&t.onFailure(e,i)}}),n},getCommenters:function(){return this.getAssociated("commenters")},getComments:function(){return this.getAssociated("comments")},addComment:function(e){try{var t=this.getComments(),i=t.filterDeletedAndStatusRelatedComments(t.toJSON()).length;t.addEventOnce("onAdd",function(){this.set("nb_comments",i+1)}.bind(this)),t.addComment(e)}catch(e){p.log("exception:",e)}},getRssLink:function(e){return e||(e=10),"/rss/filter/feed/model/idea/limit/"+e+"/community_id/"+this.getCommunity().get("mid")+"/model_id/"+this.get("mid")},isTransferredToEnovia:function(){return this.getAssociated("links").hasAnEnoviaLink()},getEnoviaLink:function(){return this.getAssociated("links").getEnoviaLink()},isMature:function(){var e=this;return new Promise(function(t){var i=e.getIdeaType().getStatusCollection(),n=function(){t(i.ideaIsMature(this))};i.hasBeenFetched()?n.call(e):i.addEvent("onSync:read",n.bind(e))})},removeEnoviaLink:function(){var e=this;return new Promise(function(t){e.getAssociated("links").removeEnoviaLink().then(function(){e.dispatchEvent("TransferChange",!1),t()})})}})}),define("DS/SwymUICore/script/feature/community/idea/model/enovia-object-model",["DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/idea/model/idea-model","DS/WAFData/WAFData","DS/SwymUICore/script/utils/utils","UWA/Core","UWA/Json","DS/Logger/Logger","DS/SwymUICore/script/feature/core/config/bootstrap-model","i18n!DS/SwymUICore/assets/nls/feature/community/idea/enovia-object-model","DS/UWPClientCode/I18n","DS/UWPClientControls/PlatformNotify"],function(e,t,i,n,o,s,r,a,c,u,l){"use strict";return e.extend({_serviceURI:null,_collabSpace:null,_3dspaceUrl:null,_dsCSRFToken:null,_ideaStatusTitle:null,_ideaModelRelativePath:null,_objectLabel:null,_modelName:"enovia-object",HTML_ATTRIBUTES:["content"],_objectUrl:null,defaults:{type:"",title:"",content:"",fields:null,mid:null},_associations:{idea:{Class:t}},setup:function(e){if(!e.threeDSpaceUrl)throw"A threeDSpaceUrl is required";this._3dspaceUrl=e.threeDSpaceUrl},_processContent:function(){var e,t,i,s,r,a,u,l=this.get("content")+"<p>"+c.Originalidea+' <a target="_blank" href="'+n.getBaseUrl()+"/"+this._ideaModelRelativePath+'">'+this.get("title")+"</a> "+c.Instatus+' "'+this._ideaStatusTitle+'"</p>',d=o.createElement("div",{html:l}),m=d.getElements("img[data-media-id]");for(a=0,u=m.length;a<u;a++)s=(e=m[a]).attributes,t=e.dataset.mediaId,i=e.dataset.communityId,e.removeAttribute("style"),e.removeAttribute("alt"),(r=document.createAttribute("style")).value="width: 300px;",s.setNamedItem(r),t&&(i&&((r=document.createAttribute("onclick")).value="window.open('"+n.getBaseUrl()+"/#community:"+i+"/media:"+t+"')",s.setNamedItem(r)),s.getNamedItem("src")||((r=document.createAttribute("src")).value=n.getBaseUrl()+"/api/media/streammedia/id/"+t+"/type/picture/key/o1/",s.setNamedItem(r)));this.set("content",btoa(unescape(encodeURIComponent(d.getHTML()))))},_checkSaveOptions:function(e){if(!e.serviceURI)throw"A serviceURI is required";if(this._serviceURI=e.serviceURI,!e.collabSpace)throw"A serviceURI is required";if(this._collabSpace=e.collabSpace,!e.dsCSRFToken)throw"A dsCSRFToken is required";if(this._dsCSRFToken=e.dsCSRFToken,!e.ideaStatusTitle)throw"A ideaStatusTitle is required";if(this._ideaStatusTitle=e.ideaStatusTitle,!e.ideaModelRelativePath)throw"A ideaModelRelativePath is required";if(this._ideaModelRelativePath=e.ideaModelRelativePath,!e.objectLabel)throw"An objectLabel is required";this._objectLabel=e.objectLabel},save:function(e){this._checkSaveOptions(e),this._processContent();var t=this,n=this._3dspaceUrl+"/"+this._serviceURI+"/types",o={method:"POST",type:"json",headers:{"Content-Type":"application/json;charset=UTF-8",Accept:"application/json;charset=UTF-8",SecurityContext:this._collabSpace,"X-DS-CSRFTOKEN":this._dsCSRFToken},data:s.encode({type:this.get("type"),title:this.get("title"),content:this.get("content"),fields:this.get("fields")}),onComplete:function(i){var n,o;if(!i.result||!i.result.object_id)return l.error(u.replace(c.ObjectCreationFailed,{objectName:t._objectLabel,error:i.errorMessage})),r.error("The enovia object creation failed:",i.errorMessage),void(e.onFailure&&e.onFailure());o=i.result.object_id,t.set("mid",o),n=t.getAssociated("idea").addLink({type:"enovia-object:"+t.get("type"),content_key:o,content_title:t._objectLabel}),e&&"function"==typeof e.onComplete&&e.onComplete.call(this,n)},onFailure:function(e){r.error("The creation of the enovia object of type "+this.get("type")+"failed:",e)}};i.authenticatedRequest(n,o)},_computeObjectUrl:function(e){return this._objectUrl=this._3dspaceUrl+"/common/emxNavigator.jsp?objectId="+e+"&tenant="+a.getInstance().get("config").tenant.online_instance_id,this._objectUrl},getObjectUrl:function(){return this._objectUrl},fetchObjectURL:function(){var e=this;return new Promise(function(t,n){var o=e._3dspaceUrl+"/resources/bps/physicalids?oid_list="+e.get("mid"),s={method:"GET",type:"json",headers:{"Content-Type":"application/json;charset=UTF-8",Accept:"application/json;charset=UTF-8"},onComplete:function(i){i&&i[0]&&""!==i[0]?t(e._computeObjectUrl(i[0])):t(null)},onFailure:function(t){r.error("The call to check for the object "+e.get("mid")+" has failed",t),n()}};i.authenticatedRequest(o,s)})}})}),define("DS/SwymUICore/script/feature/core/auto-save/auto-save-manager",["UWA/Core","UWA/Class","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/core/auto-save/model/auto-save-model","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/utils/date","DS/SwymUICore/script/feature/community/post/model/post-model","DS/SwymUICore/script/feature/community/iquestion/model/iquestion-model","DS/SwymUICore/script/feature/community/survey/model/survey-model","DS/SwymUICore/script/feature/community/idea/model/idea-model","DS/SwymUICore/script/feature/community/wiki/model/wiki-model","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/lib/pub-sub","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/utils/usage-tracker","i18n!DS/SwymUICore/assets/nls/feature/core/auto-save/auto-save-manager"],function(e,t,i,n,o,s,r,a,c,u,l,d,m,h,p,g,f,_){var y,w=h.extend({_wasOnHomePage:!1,_wasOnCommunityHomePage:!1,_askForRestoration:!1,_isReady:!1,hasBeenRestored:!1,setup(){},ignore(){n.deleteInstance(),f.trackPageEvent({category:"AutoSave",label:"contentDestroyed",view:"auto-save-manager",event:"click"})},restoreContent(){var e,t=i.getInstance(),o=n.getInstance();this._askForRestoration=!0,this._wasOnHomePage=!!t.isHomePageContext(),this._wasOnCommunityHomePage=!!t.isCommunityHomePageContext(),f.trackPageEvent({category:"AutoSave",label:"contentRestored",view:"auto-save-manager",event:"click"}),(e=o.get("community_id")?new g({mid:o.get("community_id")}):null)?e.fetch({onComplete:function(e){this._performNavigation(e)}.bind(this)}):this._performNavigation()},_performNavigation(e){var t=i.getInstance(),o=n.getInstance(),s=t.isContentEditionContext();o.get("content_id")&&o.get("community_id")?s&&o.get("content_id")===t.contentId?this.dispatchEvent("onContentRecoveryRequest"):(t.addOnce("onContextChange",function(){this.dispatchEvent("onContentRecoveryRequest")},this,!1,-1),m.goToContent(o.get("content_id"),o.get("content_type"),o.get("community_id"),!0)):t.communityId===o.get("community_id")&&t.isCommunityHomePageContext()?this.dispatchEvent("onContentRecoveryRequest"):e&&"dm"===e.get("community_type")?(t.addOnce("onContextChange",function(){this.dispatchEvent("onContentRecoveryRequest")},this,!1,-1),m.goToDM(o.get("community_id"))):t.isHomePageContext()?this.dispatchEvent("onContentRecoveryRequest"):(t.addOnce("onContextChange",function(){this.dispatchEvent("onContentRecoveryRequest")},this,!1,-1),m.goToUrl(m.HOME))},getAutoSaveModel(){if(this._askForRestoration){var t,i,o,m=n.getInstance(),h=m.get("content_type"),p={post:r,iquestion:a,idea:u,survey:c,wiki:l};if(i={content:m.get("content_message"),title:m.get("content_title"),community_id:m.get("community_id")},m.get("content_message")){const e=m.get("content_message").match(/<img.*?>/g),t=m.get("content_message").match(/<img[^>]*?data-media-id=.*?>/g),i=e&&e.length||0,n=t&&t.length||0,o=i-n;if(o>0&&require(["DS/UWPClientControls/PlatformNotify"],function(e){e.warn(_.replace(_.YouHadMediaNotRecovered,{number:o}))}),n>0){t.map(e=>{const t=e.match(/data-media-id=\"(?<id>[^\"].*?)\"/);return t&&t.groups&&t.groups.id}).map(e=>new Promise(function(t){new d({mid:e}).fetch({fromCache:!0,onComplete:t})}))}}if("survey"===h&&(o={options:m.get("content_options"),endDate:m.get("content_options").endDate,startDate:m.get("content_options").startDate,endHour:m.get("content_options").endHour,startHour:m.get("content_options").startHour,showResultsAfterVote:m.get("content_options").showResultsAfterVote},e.extend(i,o)),"wiki"===h&&(o={options:m.get("content_options"),revision_description:m.get("content_options").revision_description,locked:m.get("content_options").locked},e.extend(i,o)),m.get("content_id")){if((t=new p[h]({id:m.get("content_id")})).addChanges(i),"wiki"===h){const e=((e,t)=>{const i=new Date(s.getDateInMilliSec(e)),n=new Date(i.getTime()-6e4*(new Date).getTimezoneOffset()).valueOf();return new Date(t).valueOf()>n})(t.get("update"),m.get("autosave_date"));t.addChanges({expired:!e})}}else t=Object.hasOwnProperty.call(p,h)&&new p[h](i);return t}return null},isAvailable(t){var i=n.getInstance();this._isReady?!i.isNew()&&(!e.is(window.widget)||e.is(window.widget)&&window.widget.getAppName&&window.widget.getAppName()===o.getMyCommunitiesAppKey())?t(!0):t(!1):this.addEventOnce("onAutoSaveModelIsReady",this.isAvailable.bind(this,t))},init(){var e=this;return this._parent.apply(this,arguments),p.getInstanceFetched(function(t){var i=t.get("autosaved_content"),o=n.getInstance();i&&(o.set("id",i.autosave_id),o.set("community_id",i.community_id),o.set("content_id",i.content_id),o.set("content_message",i.content_message),o.set("content_options",JSON.parse(i.content_options)),o.set("content_title",i.content_title),o.set("content_type",i.content_type),o.set("autosave_id",i.autosave_id),o.set("autosave_date",i.autosave_date)),e._isReady=!0,e.dispatchEvent("onAutoSaveModelIsReady")}),this}});return{getInstance:()=>(y||(y=new w),y)}}),define("DS/SwymUICore/script/feature/community/idea/model/idea-derived-type-model",["require","exports","DS/SwymUICore/script/feature/community/idea/model/idea-model","DS/SwymUICore/script/feature/community/derived-type/derived-type-styles-manager","DS/SwymUICore/script/feature/community/derived-type/derived-type-data-utils","DS/SwymUICore/script/feature/core/context/context-constants"],function(e,t,i,n,o,s){"use strict";return i.extend({_attributesMapping:{container:"community",body:"content","status->id":"status_id",creation_date:"crdate"},init:function(e){var t=null;return e&&e.derived_type&&(t=e.derived_type)&&t.id&&(n.addDerivedTypeStyle(t),this._iconCls=o.createIconWrapperClassForDerivedTypeModel(t),this._iconWrapperCls=o.createIconWrapperClassForDerivedTypeModel(t)),this._parent.apply(this,arguments)},set:function(e,t,i){var s=null;return"object"==typeof e&&e.derived_type?s=e.derived_type:"derived_type"===e&&(s=t),s&&s.id&&(n.addDerivedTypeStyle(s),this._iconCls=o.createIconClassForDerivedTypeModel(s),this._iconWrapperCls=o.createIconWrapperClassForDerivedTypeModel(s)),this._parent(e,t,i)},canUpdate:function(){var e=this.get("acl");return e&&e.update},canDelete:function(){var e=this.get("acl");return e&&e.delete},getIconClass:function(){return this._iconCls},getIconWrapperClass:function(){return this._iconWrapperCls},getContentType:function(){var e=this.get("derived_type");return e?"".concat(s.IDEA_DERIVED_TYPE_PREFIX).concat(e.id):this._parent()},_services:{read:{urlFn:function(){return"api/v2/ideas/"+this.get("mid")},method:"GET"},create:{url:"api/v2/ideas",wrapData:!1,paramsMapping:{mid:"community_post_id",content:"body",contentType:"derived_type_id",community_id:"container_id"},dataFn:function(e){return(e=e||{}).publication_state=1===e.published?"PUBLISHED":"DRAFT",delete e.published,e.withThumbnailsInfo=!0,e}}}})});__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},__spreadArray=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var n,o=0,s=t.length;o<s;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};define("DS/SwymUICore/script/feature/community/idea/collection/idea-derived-type-collection",["require","exports","UWA/Core","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/community/idea/model/idea-derived-type-model","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/community/derived-type/derived-type-data-utils","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/lib/6wpanel/utils"],function(e,t,i,n,o,s,r,a,c){"use strict";var u=s.getInstance();return n.extend({_collectionName:"idea-dt-collection",_services:{filter:{"fake-filtered-idea-derived-type":{urlFn:function(){return"/api/v2/communities/".concat(this.communityId,"/ideas")},method:"GET",dataFn:function(){return{derived_type_id:this.typeId}}},"exalead-filtered-idea-derived-type":{urlFn:function(){return"/api/exalead/search"},dataFn:function(e){return console.log("###JVY4: idea-derived-type-collection -> filter -> test"),i.extend(e||{},{refineUsingQuery:this.communityId?'community_id:"'.concat(this.communityId,'"'):null,order_field:"update",order_by:"asc",derived_type_id:this.typeId})},parse:function(e){return c.parseSearchResult(e).map(function(e){var t=e;return t.derived_type=r.createDerivedTypeDataFromTags(e),t})}},latestContributions:{url:"api/exalead/whatsnew",paramsMapping:{limit:"nresults",startFrom:"start"},dataFn:function(e){return __assign({legacyFormat:!1,community_id:this.communityId,contentType:"idea",query:"#all",with_synthesis:!0,order_by:"desc",order_field:"ds6w_58_lastcontributed",start:(this._currentPage-1)*this._limit,nresults:this._limit,derived_type_id:this.typeId},e)},tagsWithoutSubjectURI:!0,parse:function(e){return c.parseSearchResult(e).map(function(e){var t=e;return t.derived_type=r.createDerivedTypeDataFromTags(e),t})}}},read:{"fake-filtered-idea-derived-type":{urlFn:function(){return"/api/v2/communities/".concat(this.communityId,"/ideas")},method:"GET",dataFn:function(){return{derived_type_id:this.typeId}},parse:function(e){var t=this,i=new a({mid:this.communityId}).get("derivedTypes"),n=i&&i.find(function(e){return e.id===t.typeId});if(n&&Array.isArray(e)){var o={color:n.color,icon:n.icon,label:n.label,id:n.id,parent:n.parent};e.forEach(function(e){e.derived_type=o})}return e}},"exalead-filtered-idea-derived-type":{urlFn:function(){return"/api/v2/communities/".concat(this.communityId,"/ideas")},method:"GET",dataFn:function(){return{derived_type_id:this.typeId}},parse:function(e){var t=this,i=new a({mid:this.communityId}).get("derivedTypes"),n=i&&i.find(function(e){return e.id===t.typeId});if(n&&Array.isArray(e)){var o={color:n.color,icon:n.icon,label:n.label,id:n.id,parent:n.parent};e.forEach(function(e){var t=e;t.out=t.out?"1":"0",t.derived_type=o})}return e}},latestContributions:{url:"api/exalead/whatsnew",paramsMapping:{limit:"nresults",startFrom:"start"},dataFn:function(e){return __assign({legacyFormat:!1,community_id:this.communityId,contentType:"idea",query:"#all",with_synthesis:!0,order_by:"desc",order_field:"ds6w_58_lastcontributed",start:(this._currentPage-1)*this._limit,nresults:this._limit,derived_type_id:this.typeId},e)},tagsWithoutSubjectURI:!0,parse:function(e){return c.parseSearchResult(e).map(function(e){var t=e;return t.derived_type=r.createDerivedTypeDataFromTags(e),t})}}}},typeId:null,communityId:null,model:o,modes:["fake-filtered-idea-derived-type","exalead-filtered-idea-derived-type","latestContributions"],setup:function(e,t){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var o=u.getCommunityPageContext(),s=u.getCommunityDerivedTypePipelinePageContext(),a=s&&r.getDerivedTypeIdFromCommunityPipelinePageName(s)||o&&r.getDerivedTypeIdFromCommunityPageName(o);return this.typeId=a||null,t.communityId&&(this.communityId=t.communityId),this._parent.apply(this,__spreadArray([e,t],i,!1))},collectionPostProcess:function(e){this.forEach(function(t){var i=e.find(function(e){return e.get("mid")===t.get("status_id")});i&&t.set({status_title:i.get("title",{escapeHTML:!1}),color:i.get("color"),status_color:i.get("color")})})}})}),define("DS/SwymUICore/script/feature/community/derived-type/derived-type-model-factory",["require","exports","DS/SwymUICore/script/feature/community/post/model/post-derived-type-model","DS/SwymUICore/script/feature/community/idea/model/idea-derived-type-model","DS/SwymUICore/script/feature/community/derived-type/derived-type-data-utils"],function(e,t,i,n,o){"use strict";var s={},r=new Set,a={POST:i,IDEATION:n};function c(e){var t=function(e){return{_iconCls:o.createIconClassForDerivedTypeModel(e),_iconWrapperCls:o.createIconWrapperClassForDerivedTypeModel(e)}}(e),i=e.parent;return a[i].extend(t)}function u(e){var t=e.id;if(r.has(t))return s[t];var i=c(e);return r.add(t),s[t]=i,i}return{getDerivedTypeModelClass:u,getDerivedTypeModelClassFromTags:function(e){var t=o.createDerivedTypeDataFromTags(e);return e.derived_type=t,u(t)}}}),define("DS/SwymUICore/script/feature/community/instant-comment/model/instant-comment-model",["UWA/Core","UWA/String","UWA/Utils","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/lib/request/data","DS/SwymUICore/script/lib/model/model-manager","DS/SocialToolbar/Models/Subject","DS/SocialToolbar/Utils/SocialToolbarSharedOptions","DS/SwymUICore/script/utils/navigation","DS/WebappsUtils/Console"],function(e,t,i,n,o,s,r,a,c,u,l,d,m,h,p){"use strict";return n.extend({_modelName:"instant-comment",_iconCls:"chat-alt",_iconWrapperCls:"message",_attributesMapping:{id:"mid",richMessage:"content",parentCommentUri:"parent_uri"},_associations:{community:{}},_customProperties:{subject:null,sharedOptions:null,commentModel:null},getCommunity:function(){return this.community},init:function(e,t){var i,n=this._parent.apply(this,arguments);if(!this.getCommentModel()){if(!(i=t&&t.commentInstance)&&e&&e.community){this.community="dm"===e.community.community_type?new s({community_id:e.community.mid}):new o({community_id:e.community.mid});var r={richMessage:e.richMessage,parentCommentUri:e.parentCommentUri,commentUri:e.model_uri,author:e.author},a=this._getSubject(e.subject6wuri).getComments();(i=new(0,a.model)(r,{subject:this._getSubject(e.subject6wuri)})).collection=a}i&&this.setCommentModel(i)}return n},setCommentModel:function(e){if(e){var t=this.getCommentModel();if(t)return t;this._customProperties.commentModel=e,this.listenTo(e,{"onChange:accessState":function(){e.get("accessState")===e.ACCESS_STATE.DELETED&&this.dispatchEvent("onStateChange",["DELETED_STATE"])}})}},getCommentModel:function(){return this._customProperties.commentModel},_getSubject:function(e){if(!this._customProperties.subject){var t=r.getInstance(),i=t.get("user");this._customProperties.sharedOptions=new m({"3DSwymUrl":a.getBaseUrl(),"3DSwymServerToken":t.getCSRFToken(),tenantId:t.get("config").tenant.online_instance_id,userLogin:i.login,userName:i.first_name+" "+i.last_name,serviceUrl:t.get("3dcommentUrl")||a.getBaseUrl()}),this._customProperties.subject=new d({subjectUri:e},{sharedOptions:this._customProperties.sharedOptions})}return this._customProperties.subject},save:function(e,t){this.community=e.isDMContext?new s({community_id:e.community_id}):new o({community_id:e.community_id}),this._saveOperations(e,t)},_saveOperations:function(e,t){var n,o,s=this,a=r.getInstance().get("user"),c=this._getSubject(e.subject6wuri),u=i.getUUID(),d={author:{login:a.login,displayName:a.first_name+" "+a.last_name},parentCommentUri:e.parentCommentUri,richMessage:e.content,taggingActions6w:e.taggingActions6w,subject_model:e.subject_model,model:"comment",model_content:e.content,subject_id:e.subject_id};this.set("X-Request-ID",u),n=c.getComments(),(o=n.create(d,{headers:{"X-Request-ID":u},subject:c,onComplete:function(e){s.set("mid",e.get("commentUri")),s.set("subject6wuri",e.get("commentUri")),o.set(e.toJSON()),l.populate(s,{areModelDataFromServer:!0}),l.notify("onPublishing",[s]),"function"==typeof t.onComplete&&t.onComplete()},onFailure:function(){t.onFailure()}})).collection=n,s.setCommentModel(o),s.parentMessageUUID=e.parentMessageUUID,s.set(d),s.set(e),l.notify("onPrePublishing",[s])},defaults:{},set:function(e,t,i){var n,o;return e?((n=this.applyAttributesMapping(e,t)).hasOwnProperty("commentUri")&&(n.mid||(o=n.commentUri.split(":"),n.mid=o[o.length-1]),n.subject6wuri=n.commentUri),this._parent.call(this,n,i)):this}})}),define("DS/SwymUICore/script/feature/community/timeline/model/im-event-model",["UWA/Core","DS/SwymUICore/script/feature/community/timeline/model/event-model","DS/SwymUICore/script/feature/community/instant-message/model/instant-message-model","DS/SwymUICore/script/feature/core/user/model/user-model","DS/Logger/Logger"],function(e,t,i,n,o){"use strict";var s=t.extend({_modelName:"im-event",HTML_ATTRIBUTES:["message_details->content"],_attributesMapping:{subject_uri:"subject6wuri"},init:function(e,t){var i=this._parent.apply(this,arguments);return t&&t.instantMessageInstance&&this.setInstantMessage(t.instantMessageInstance),i},_associations:{instantMessage:{Class:i},originalAuthor:{Class:n,sourceAttribute:"message_details->forwarded_from"}},setInstantMessage:function(e){var n,s,r,a={},c=this.get("subject6wuri")||null;if(e?(e.get("mid"),s=e.get("community"),a=e.toJSON()):a={mid:(r=c?c.split(":"):[]).length>0?r[r.length-1]:null,subject6wuri:c,community:s=this.get("community"),richMessage:this.get("message_details->content"),originalAuthor:this.get("message_details->forwarded_from"),author:this.get("author")},!s)throw new Error("Community info is required");return(n=this.hasAssociated("instantMessage"))?(n.set(a),n):(e||(e=new i(a)),this.setAssociated("instantMessage",e),this.listenTo(e,{onStateChange:function(e){switch(e){case"ACTIVE_STATE":case"NOT_AVAILABLE":case"DELETED_STATE":this.set("subject_state",t[e]);break;default:o.warn("Unknown state: ",e)}}}),e)},getInstantMessage:function(){return this.hasAssociated("instantMessage")||this.setInstantMessage(),this.getAssociated("instantMessage")},getAuthorModelAttributes:function(){return this.get("author")},getMessageTitle:function(){var t=this.get("message_details->richMessage",{escapeHTML:!1});return t&&(t=e.createElement("div",{html:t}).getText()),t},getParentIMEvent:function(){var e=this.getAssociated("parentIMEventModel");return e.get("community")||e.set("community",this.get("community")),e},setParentIMEvent:function(e){return this.setAssociated("parentIMEventModel",e)},"onChange:community":function(e,t,i){i&&i.instantMessageInstance||this.setInstantMessage()},"onChange:subject6wuri":function(e,t,i){i&&i.instantMessageInstance||this.get("community")&&this.setInstantMessage()}});return s.prototype._associations.parentIMEventModel={Class:s,sourceAttribute:"message_details->parent_message"},s}),define("DS/SwymUICore/script/feature/community/timeline/mark/tl-mark-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","DS/SwymUICore/script/utils/utils","DS/Logger/Logger"],function(e,t,i,n,o,s){"use strict";var r="api/community/timeline/marks",a=t.extend({_modelName:"tl-mark-model",_attributesMapping:{community_id:"thread->mid"},_associations:{thread:{Class:i,oppositeRole:"mark",options:{provokeCacheUpdates:!0}}},_services:{create:{wrapData:!1,url:r,dataFn:function(){return{message_id:this.get("mark").message_id}}},update:{wrapData:!1,url:r,dataFn:function(){return{message_id:this.get("mark").message_id}}}},defaults:{mark:void 0},init:function(e,t){var i;if(!e)throw new Error("Mark attributes are missing");if(!t||!t.threadType)throw new Error("Thread type is missing");if("dm"===t.threadType&&(this._defineOwnAssociations(),this._associations.thread.Class=n),!(i=this.applyAttributesMapping(e)).thread)throw new Error("This mark is not linked to any thread");i.mid=i.thread.mid,this._parent.call(this,i,t),this.getThread()},getThread:function(){return this.getAssociated("thread")},"onSetAssociated:thread":function(e,t,i){i.set("mark",e.toJSON()),i.listenTo(e,"onChange:mark",function(){this.set("mark",e.toJSON())})}});return a.URL_ROOT=r,a}),define("DS/SwymUICore/script/feature/community/timeline/model/community-event-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/community/timeline/model/event-model","DS/SwymUICore/script/feature/community/instant-comment/model/instant-comment-model"],function(e,t,i,n,o,s){"use strict";return o.extend({_modelName:"community-event",_attributesMapping:{"message_details->richMessage":"message_details->model_content"},HTML_ATTRIBUTES:["message_details->model_content"],init:function(e,t){var i=this._parent.apply(this,arguments);return t&&t.instantCommentInstance&&this.setInstantComment(t.instantCommentInstance),i},getAuthorModelAttributes:function(){return this.get("author")},getMessageModelName:function(){let e=this.get("message_details");return e&&e.model},getMessageSubjectModel:function(){let e=this.get("message_details");return e&&e.subject_model},getMessageSubjectId:function(){let e=this.get("message_details");return e&&e.subject_id},_associations:{sharedContent:{},instantComment:{Class:s},community:{Class:i}},_flagSubjectAsDeleted:function(){this.set("subject_state",o.DELETED_STATE)},getMessageTitle:function(){var t=this.get("message_details->model_content",{escapeHTML:!1});return t&&(t=e.createElement("div",{html:t}).getText()),t},setInstantComment:function(t){var i,n,r={},a=this.get("message_details->model_uri"),c=this.get("message_details->parent_uri")||this.get("message_details->model_uri")||null,u=this.get("message_details->commentable_uri");return t?(t.get("mid"),t.get("community"),r=t.toJSON()):r={mid:(n=a?a.split(":"):[]).length>0?n[n.length-1]:null,parentCommentUri:c,model_uri:a,subject6wuri:u,community:this.get("community"),richMessage:this.get("message_details->model_content"),author:this.get("author"),subject_model:this.getMessageSubjectModel(),subject_id:this.getMessageSubjectId()},(i=this.hasAssociated("instantComment"))?(i.set(t?r:e.extend(r,i.toJSON())),i):(t||(t=new s(r)),this.setAssociated("instantComment",t),this.listenTo(t,{onStateChange:function(e){switch(e){case"ACTIVE_STATE":case"NOT_AVAILABLE":case"DELETED_STATE":this.set("subject_state",o[e]);break;default:Logger.warn("Unknown state: ",e)}}}),u||(t.get("subject6wuri")?this.set(t.get("subject6wuri")):this.listenToOnce(t,{"onChange:subject6wuri":function(){this.set(t.get("subject6wuri"))}})),t)},getInstantComment:function(){return this.hasAssociated("instantComment")||this.setInstantComment(),this.getAssociated("instantComment")},"onSetAssociated:sharedContent":function(e,t,i){return this.listenTo(i,"onDestroy",this._flagSubjectAsDeleted),this._parent.apply(this,arguments)}})}),define("DS/SwymUICore/script/feature/community/timeline/mark/marks-manager",["UWA/Core","UWA/Utils/Client","DS/SwymUICore/script/lib/request/data","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/community/timeline/mark/tl-mark-model","UWA/Json","UWA/Element","UWA/Class"],function(e,t,i,n,o,s,r,a,c){"use strict";return c.singleton({defaultOptions:{delay:60,maxMarksToSendPerRequest:10,csrfToken:void 0,serviceUrl:void 0},_threads:null,_threadIds:null,_intervalId:void 0,_save:function(n){var o,s=this.options,a=this._threads,c={"Content-Type":"application/json","X-DS-SWYM-CSRFTOKEN":s.csrfToken};a.length>0&&(this._threadIds.splice(0),o={marks:this._threads.splice(0).reduce(function(e,t){var i=t.get("mark->message_id"),n=t.get("mid");return e.push({message_id:i,community_id:n}),e},[])},!0===n&&e.is(window.fetch,"function")&&(!t.Engine.firefox||window.ds&&"3DSwym"===ds.env)?window.fetch(s.serviceUrl,{method:"POST",cache:"no-cache",credentials:"include",headers:c,body:r.encode(o)}):i.request({url:s.serviceUrl,timeout:15e3,method:"POST",async:!n,headers:c,wrapData:!1,data:o}))},setup:function(t){var i;if(this._intervalId?(i=!1,window.clearInterval(this._intervalId),this._save()):(i=!0,this._threads=[],this._threadIds=[]),this.options=e.extend(this.defaultOptions,t),this.options.csrfToken||(this.options.csrfToken=o.getInstance().getCSRFToken()),!this.options.csrfToken)throw new Error("Missing CSRF token");this.options.serviceUrl||(this.options.serviceUrl=n.getBaseUrl()+"/"+s.URL_ROOT),!0===i&&a.addEvent.call(window,"beforeunload",this._save.bind(this,!0)),this._intervalId=window.setInterval(this._save.bind(this,!1),1e3*this.options.delay)},push:function(e){var t;e&&(t=e.get("mid"),this._threadIds&&-1===this._threadIds.indexOf(t)&&(this._threadIds.push(t),this._threads&&this._threads.push(e),this._threadIds.length>=this.options.maxMarksToSendPerRequest&&this._save(!1)))}})}),define("DS/SwymUICore/script/feature/core/favorite/collection/favorite-dm-collection",["DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/core/favorite/model/favorite-dm-model"],function(e,t){"use strict";return e.extend({_asAdmin:!1,_collectionName:"favorite-dm-collection",_services:{read:{"my-favorites-dm":{url:"api/favorites/directmessages",method:"GET",dataFn:function(e){return{page:e.page,limit:e.limit}}}}},model:t,modes:["my-favorites-dm"]})}),define("DS/SwymUICore/script/feature/community/community/model/community-request-model",["UWA/Core","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/utils/date"],function(e,t,i){return t.extend({_modelName:"community-request",_attributesMapping:{id:"mid",community_id:"community_id"},_services:{create:{url:"api/communityRequest/create"},read:{url:"api/communityRequest/get",dataFn:function(){return{id:this.get("mid")}}},decline:{url:"api/communityRequest/sendback",dataFn:function(){return{id:this.get("mid"),status:"decline",additional_comment:this.get("additional_comment",{escapeHTML:!1})}}},sendback:{url:"api/communityRequest/sendback",dataFn:function(){return{id:this.get("mid"),status:"sendback",additional_comment:this.get("additional_comment",{escapeHTML:!1})}}},accept:{url:"api/communityRequest/accept",dataFn:function(){return{id:this.get("mid")}}},update:{url:"api/communityRequest/update",dataFn:function(){return{id:this.get("mid"),benefits:this.get("benefits",{escapeHTML:!1}),description:this.get("description",{escapeHTML:!1}),primary_community_owner_hash_key:this.get("primary_community_owner_hash_key"),intranet_access:this.get("intranet_access"),title:this.get("title",{escapeHTML:!1}),type_id:this.get("type_id"),lifespan:this.get("lifespan"),go_live_date:this.get("go_live_date"),tags:this.get("tags")}}}},defaults:{tags:"",lifespan:1,go_live_date:i.getCurrentDate()}})}),define("DS/SwymUICore/script/feature/core/user/collection/assignee-collection",["DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/SwymUICore/script/feature/core/user/model/assignee-model"],function(e,t){"use strict";return e.extend({_collectionName:"assignee-collection",model:t})}),define("DS/SwymUICore/script/feature/community/wedo/model/wedo-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/feature/community/comment/collection/comment-collection","DS/SwymUICore/script/feature/core/user/collection/commenters-collection","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/SwymUICore/script/feature/core/user/collection/assignee-collection","DS/SwymUICore/script/feature/community/wedo/collection/attachment-collection","DS/WebappsUtils/Console","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/core/user/model/assignee-model","i18n!DS/SwymUICore/assets/nls/lib/model/generic/community-content"],function(e,t,i,n,o,s,r,a,c,u,l,d){"use strict";var m=t.extend({_modelName:"wedo",_iconCls:"task",_iconWrapperCls:"wedo",maturityConstants:{OPEN_MATURITY:"dsxplan:Open",OPEN_FILTERING_MATURITY:"ds6w:status.task_open",IN_PROGRESS_FILTERING_MATURITY:"ds6w:status.task_inprogress",IN_PROGRESS_MATURITY:"dsxplan:InProgress",DONE_FILTERING_MATURITY:"ds6w:status.task_done",DONE_MATURITY:"dsxplan:Done"},_attachmentsHasAnUnsupportedSource:!1,_attributesMapping:{model_id:"mid","@id":"mid",resourceid:"mid","dsxplan:label":"title","dsxplan:comment":"content","dsxplan:hasAssignee->member":"assignees","timeline_event->community_id":"community->mid","attributes->dsxplan:hasMaturity->@id":"maturityId","attributes->dsxplan:estimatedEndDate":"estimatedEndDate","attributes->@id":"mid",plannedEnd:"estimatedEndDate","attributes->dsxplan:hasAttachment->member":"attachments","attributes->dsxplan:hasAssignee->member":"assignees","ds6w:assignee":"assignees","attributes->dsxplan:workscopeParent":"projectDetails","dsxplan:workscopeParent->dsxplan:label":"projectName","dsxplan:workscopeParent->@id":"projectId","dsxplan:workscopeParent->hasProjectAccess":"projectAccessible","dsxplan:estimatedEndDate":"estimatedEndDate","dsxplan:hasMaturity->@id":"maturityId","dsxplan:hasAttachment->member":"attachments",wedo_maturity:"maturityId","ds6w:status":"maturityId",ds6w_58_status:"maturityId","dskern:owner->dsaccess:accountName":"author->login","dskern:owner->foaf:firstName":"author->first_name","dskern:owner->foaf:lastName":"author->last_name"},_associations:{comments:{Class:i,oppositeRole:"commented",options:{mode:"wedo"}},commenters:{Class:n,oppositeRole:"commented",options:{mode:"comment"}},thumbnail:{Class:o},assignees:{Class:r,oppositeRole:"wedo",options:{limit:10,mode:null}},attachments:{Class:a,options:{mode:"searchBySubjectUri"}}},_services:{create:{url:"wedoproxy/send",wrapData:!1,dataFn:function(e){e=e||{};const t=this.getCommunity(),i=t&&t.get("subject6wuri");var n={},o=e.diffAssignees?e.diffAssignees.filter(function(e){return"add"===e.operation}).map(function(e){return e.value}):[];return e.title&&(n["dsxplan:label"]=e.title),e.content&&(n["dsxplan:comment"]=e.content),n["dsxplan:hasAssignee"]=o,e.plannedEnd&&(n["dsxplan:estimatedEndDate"]=this._dateToUTCDate({date:e.plannedEnd,isEnd:!0})),e.diffAttachment&&(n["dsxplan:hasAttachment"]=e.diffAttachment),e.maturity&&(n["dsxplan:hasMaturity"]=e.maturity),{community_data:{taggingActions6w:e.taggingActions6w,event_action:"create",action:"create",community_id:e.subject6wuri||i,additional_actors:o,additional_media:e.diffAttachment&&e.diffAttachment.addOperation.map(function(e){return e.id})},payload:n}},parse:function(e){var t=e.response["@id"];return t["dsxplan:hasMaturity"]={"@id":e.timeline_event.event_data.maturity},t.subject6wuri=t.mid=t["@id"],e&&e.wedo_data&&e.wedo_data.enhanced_summary&&(t.enhanced_summary=e.wedo_data.enhanced_summary),t.community_type=e.isDMContext?"dm":"community",e.response["@id"]}},read:{url:"wedoproxy/send",wrapData:!1,dataFn:function(){return{community_data:{event_action:"read",action:"read",wedo_id:this.get("mid")},payload:{ids:[this.get("mid")]}}},parse:function(e){var t,i=e.wedo_data||{},n={},o=0,s=[];(e&&e.community_data&&(e.community_data._acl&&(n=e.community_data._acl),e.community_data.nb_views&&(o=e.community_data.nb_views),e.community_data.tags6w_implicit&&(s=e.community_data.tags6w_implicit),e.community_data.tags6w_subjecturi&&(t=e.community_data.tags6w_subjecturi)),e&&e.member&&e.member[0]&&(e=e.member[0]),e["dsxplan:hasAttachment"]&&e["dsxplan:hasAttachment"].member)&&(e["dsxplan:hasAttachment"].member=e["dsxplan:hasAttachment"].member.filter(function(e){return"3DSwym"===e["dscom:ServiceHosting"]||(this._attachmentsHasAnUnsupportedSource=!0),"3DSwym"===e["dscom:ServiceHosting"]}.bind(this)));return e._acl=n,e.nb_views=o,e.tags6w_implicit=s,e.taggerSubject6wuri=t,Object.assign(i,e)}},update:{url:"wedoproxy/send",wrapData:!1,dataFn:function(e){var t={"@id":this.get("mid"),"dsxplan:label":e.title||"","dsxplan:comment":e.content||"","dsxplan:hasAssignee":e.diffAssignees,"dsxplan:hasAttachment":e.diffAttachment};return e.maturity&&(t["dsxplan:hasMaturity"]=e.maturity),e.plannedEnd&&(t["dsxplan:estimatedEndDate"]=this._dateToUTCDate({date:e.plannedEnd,isEnd:!0})),{community_data:{action:"update",event_action:e.maturity?"changeStatus":"update",wedo_id:this.get("mid"),additional_actors:e.diffAssignees?e.diffAssignees.filter(function(e){return"add"===e.operation}).map(function(e){return e.value}):[],additional_media:e.diffAttachment&&e.diffAttachment.addOperation.map(function(e){return e.id})},payload:t}},parse:function(e){var t,i=e.wedo_data.attributes;(e.wedo_data.enhanced_summary&&(i.enhanced_summary=e.wedo_data.enhanced_summary),i["dsxplan:hasAttachment"]&&i["dsxplan:hasAttachment"].member)&&(i["dsxplan:hasAttachment"].member=i["dsxplan:hasAttachment"].member.filter(function(e){return(t="3DSwym"===e["dscom:ServiceHosting"])||(this._attachmentsHasAnUnsupportedSource=!0),t}.bind(this)));return delete i["dskern:owner"],{...i,attributes:i}}},delete:{url:"wedoproxy/send",wrapData:!1,dataFn:function(){return{community_data:{event_action:"delete",action:"delete",wedo_id:this.get("mid")},payload:{"@id":this.get("mid")}}}}},defaults:{},validateField:function(e){return"content"!==e&&this._parent.apply(this,arguments)},getRssLink:function(e){return e||(e=10),"/rss/filter/feed/model/wedo/limit/"+e+"/community_id/"+this.getCommunity().get("mid")+"/model_id/"+this.get("mid")},get:function(e){var t=this._parent.apply(this,arguments);return"subject6wuri"===e?this.get("mid"):t},getSubjectURIForTagger:function(){return this.get("taggerSubject6wuri")},getSubjectURI:function(){return this.get("subject6wuri")},getLabelColor:function(){var e="#4D62BA";switch(this.get("maturityId")){case this.maturityConstants.OPEN_MATURITY:case this.maturityConstants.OPEN_FILTERING_MATURITY:e="#4D62BA";break;case this.maturityConstants.IN_PROGRESS_MATURITY:case this.maturityConstants.IN_PROGRESS_FILTERING_MATURITY:e="#00B8DE";break;case this.maturityConstants.DONE_MATURITY:case this.maturityConstants.DONE_FILTERING_MATURITY:e="#57B847"}return e},getLabelTitle:function(){var e=d.TODO;switch(this.get("maturityId")){case this.maturityConstants.OPEN_MATURITY:case this.maturityConstants.OPEN_FILTERING_MATURITY:e=d.TODO;break;case this.maturityConstants.IN_PROGRESS_MATURITY:case this.maturityConstants.IN_PROGRESS_FILTERING_MATURITY:e=d.InProgress;break;case this.maturityConstants.DONE_MATURITY:case this.maturityConstants.DONE_FILTERING_MATURITY:e=d.Done}return e},hasCurrentUserEditRights:function(){var e=this.get("_acl");return e.update&&e.update.access},getCommenters:function(){return this.getAssociated("commenters")},getComments:function(){return this.getAssociated("comments")},addComment:function(e){try{this.getAssociated("comments").addComment(e)}catch(e){c.log("exception:",e)}},deleteContribution:function(e){return this.destroy(e)},_dateToUTCDate({date:e,isEnd:t}){const i=e.getFullYear(),n=e.getMonth(),o=e.getDate(),s=t?17:9;return new Date(Date.UTC(i,n,o,s)).toISOString()}});return m.maturityConstants={OPEN_MATURITY:"dsxplan:Open",IN_PROGRESS_MATURITY:"dsxplan:InProgress",DONE_MATURITY:"dsxplan:Done"},m}),define("DS/SwymUICore/script/utils/mixed-collection-utils",["require","exports","UWA/Core","DS/SwymUICore/script/feature/community/derived-type/derived-type-model-factory","DS/SwymUICore/script/feature/community/post/model/post-model","DS/SwymUICore/script/feature/community/iquestion/model/iquestion-model","DS/SwymUICore/script/feature/community/idea/model/idea-model","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/community/wiki/model/wiki-model","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/community/survey/model/survey-model","DS/SwymUICore/script/feature/community/wedo/model/wedo-model","DS/SwymUICore/script/feature/community/social-event/model/social-event-model"],function(e,t,i,n,o,s,r,a,c,u,l,d,m,h){"use strict";var p={wedo:"wedo",post:"post",posts:"post",communitypost:"post",iquestion:"iquestion",question:"iquestion",iquestions:"iquestion",qnaquestion:"iquestion",wiki:"wiki",dsi_dfstree_wikitree:"wiki",wikitree:"wiki",wiki_page:"wiki",idea:"idea",ideation:"idea",dsi_ideation_ideation:"idea",media:"media",community:"community",user:"user",survey:"survey","quick survey":"survey",conference:"social-event","social-event":"social-event"},g=function(e){var t=null;if(e.type&&(e.model=e.type),e.model=e.model||e.source,e.model){if(t=e.model.toLowerCase(),p[t]){if(t=p[t],e.derived_type)switch(t){case"post":case"idea":t=n.getDerivedTypeModelClass(e.derived_type);break;default:throw new Error("No class found for derived type model:"+t)}else if(e.ds6w_58_kind)switch(t){case"post":case"idea":t=n.getDerivedTypeModelClassFromTags(e);break;default:throw new Error("No class found for derived type model:"+t)}else switch(t){case"post":t=o;break;case"iquestion":t=s;break;case"idea":t=r;break;case"media":t=a;break;case"community":t=c;break;case"wiki":t=u;break;case"user":t=l;break;case"survey":t=d;break;case"wedo":t=m;break;case"social-event":t=h;break;default:throw{name:"No class found",message:"No class found for model: ".concat(t)}}return t}throw{name:"Invalid model",message:"There is no class attached to the model specified"}}if(e.topics)return h;throw{name:"No model provided",message:"An attribute model should be present in each item of the result returned from the server"}};return{getNItemsFromArrayRandomly:function(e,t){var i=e.length;t=Math.min(t,i);for(var n=new Array(t),o=new Array(i);t--;){var s=Math.floor(Math.random()*i);n[t]=e[s in o?o[s]:s],o[s]=--i}return n},mergeAuthorData:function(e){return i.is(e,"object")&&i.is(e.result,"array")&&e.result.forEach(function(e){"object"==typeof e.author&&(i.merge(e,e.author),!e.nickname&&e.first_name&&e.last_name&&(e.nickname="".concat(e.first_name," ").concat(e.last_name)))}),e},searchResultExtraParse:function(e){var t,i,n=0;for(n=0,t=e.length;n<t;n++)switch((i=e[n]).ds6w_58_type.split(":").pop()||i.source){case"Posts":i.type="post";break;case"Wikitree":i.type="wiki"}return e},modelMapping:p,getModel:g,getModelInstance:function(e,t){return new(g(e))(e,t)}}}),define("DS/SwymUICore/script/lib/collection/contributions-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/utils/mixed-collection-utils","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/utils/date","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model"],(e,t,i,n,o,s,r)=>{const a=t.extend({_collectionName:"contributions-collection",_lastResultsLength:-1,_jsonCache:new Map,_services:{read:{mycontributions:{urlFn(){return`api/v2/communities/${this.communityId}/contributions`},dataFn:e=>({page_size:e.limit,page_number:e.page}),method:"GET",parse(e){let t,i,n;if(Array.isArray(e))for(t=0,i=e.length,t=0;t<i;t+=1)(n=e[t]).id||(n.id=n.contribution_id),n.update||(n.update=n.time),n.summary||(n.summary=n.description),n.state||(n.state=n.publication_state);return e}}},filter:{}},communityId:null,model:n.getModelInstance,mode:null,modes:["mycontributions"],init(e,t){if(t){if(t.model)throw delete t.model,new Error("No model should be provided for a contributions collection");t.communityId&&(this.communityId=t.communityId)}return this._parent.call(this,e,t),t.paginationMode||(this.paginationMode="PREV_NEXT"),this},hasNext(){return-1===this._lastResultsLength||this._lastResultsLength>=this._limit},parse(t,o){let s,r,a;const c=this._parent(t,o);if(e.is(c,"array")){r=[];for(let e=0,t=c.length;e<t;e+=1)(a=c[e])instanceof i?r.push(a):(s=n.getModel(a),r.push(s.prototype.applyAttributesMapping(a)))}else r=c;return this._lastResultsLength=r.length,r},toJSON(){return this.map(e=>{let t,i=!1;if(e.get("state")?i="published"===e.get("state").toLowerCase():e.has("published")&&(i="1"===e.get("published")||1===e.get("published")),e.has("publication_date")?t=e.get("publication_date"):e.has("pubdate")&&(t=e.get("pubdate")),this._jsonCache.has(e.get("mid")))return{...this._jsonCache.get(e.get("mid")),publishDate:i?s.prettyDate(t):""};const n=e.get("derived_type"),r=n&&n.id?n:null,a=e.has("validatedAnswers")?e.get("validatedAnswers").length:0,c={activated:!!r||this.isActivated(e),icon:o.getIconFromModel(e),color:r?r.color:void 0,isValidatedQuestion:a>0,title:e.get("title",{escapeHTML:!1}),isDraft:!i,publishDate:i?s.prettyDate(t):"",mid:e.get("mid"),contentType:e.getContentType(),mediaType:e.get("media_type"),contentName:r?r.name:e.getContentType(),relPath:e.getRelativePath()};return this._jsonCache.set(e.get("mid"),c),c})},isActivated(e){let t=!1;const i=e.getModelName();if(["post","media","wedo"].indexOf(i)>=0)return!0;let n=e.getCommunity();n.isDirectMessage()&&(n=new r(n.toJSON()));const o=n.getCommunityFeaturesAccess();switch(i){case"post":case"media":case"wedo":t=!0;break;case"survey":t=o.survey_feature;break;case"iquestion":t=o.qna_feature;break;case"idea":t=o.ideation_feature;break;case"wiki":t=o.wiki_feature;break;case"social-event":t=n.canViewSocialEvent()}return t},_uncacheItem(e){this._jsonCache.delete(e.get("mid")),this.dispatchEvent("cacheUpdate")},"onChange:title":function(e){this._uncacheItem(e)},"onChange:state":function(e){this._uncacheItem(e)},"onChange:published":function(e){this._uncacheItem(e)},"onChange:validatedAnswers":function(e){this._uncacheItem(e)}});return n.getModelInstance.prototype.idAttribute="id",a}),define("DS/SwymUICore/script/feature/community/timeline/model/community-content-event-model",["DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/community/iquestion/model/iquestion-model","DS/SwymUICore/script/feature/community/post/model/post-model","DS/SwymUICore/script/feature/community/idea/model/idea-model","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/community/wiki/model/wiki-model","DS/SwymUICore/script/feature/community/wedo/model/wedo-model","DS/SwymUICore/script/feature/community/survey/model/survey-model","DS/SwymUICore/script/feature/community/social-event/model/social-event-model","DS/SwymUICore/script/feature/community/timeline/model/event-model","DS/SwymUICore/script/feature/community/derived-type/derived-type-model-factory","DS/SwymUICore/script/feature/core/context/context-model"],function(e,t,i,n,o,s,r,a,c,u,l,d){"use strict";return u.extend({_modelName:"community-content-event",getAuthorModelAttributes:function(){return this.get("message_details->author")},getSharedContentClass:function(){var e,u=this.get("message_details->model")||this.get("message_details->contentType"),d=this.get("message_details->derived_type");if(d&&"object"==typeof d)switch(u){case"post":case"CommunityPost":case"idea":case"Dsi_Ideation_Ideation":e=l.getDerivedTypeModelClass(d);break;default:throw new Error("No class found for derived type model:"+u)}else switch(u){case"post":case"CommunityPost":e=i;break;case"idea":case"Dsi_Ideation_Ideation":e=n;break;case"iquestion":case"QnaQuestion":e=t;break;case"Media":e=o;break;case"Survey":e=a;break;case"Dsi_DFSTree_WikiTree":e=s;break;case"Wedo":e=r;break;case"Conference":e=c}return e},getSharedContentModelAttributes:function(){return this.get("message_details")},is3DSketchOr3DStoryMedia:function(e){const t=e.get("media_type");return!(!t||"story"!==t&&"sketch"!==t&&"whiteboard"!==t)},update3DSketchOr3DStoryModelAfterProcessing:function(e,t){const i="ready-to-process"===e.get("status"),n="processed"===t.preview_media_processing_status;if(i&&n){const t=d.getInstance(),i=()=>{t.path.includes("media")||(e.fetch({fromCache:!1}),t.removeListener("onContextChange",i))};t.addListener("onContextChange",i,this,!0)}},init:function(e,t){var i=t&&t.sharedContent;if(this._parent.apply(this,arguments),!i){var n=this.getSharedContentClass(),o=this.getSharedContentModelAttributes();n&&o&&(i=new n(o),this.is3DSketchOr3DStoryMedia(i)&&this.update3DSketchOr3DStoryModelAfterProcessing(i,e.message_details))}this.setAssociated("sharedContent",i)},_associations:{sharedContent:{sourceAttribute:"message_details"}},_flagSubjectAsDeleted:function(){this.set("subject_state",u.DELETED_STATE)},getMessageTitle:function(){return this.get("message_details->title")},"onSetAssociated:sharedContent":function(e,t,i){return this.listenTo(i,"onDestroy",this._flagSubjectAsDeleted),this._parent.apply(this,arguments)}})}),define("DS/SwymUICore/script/utils/im-core-utils",["UWA/Core","DS/SwymUICore/script/feature/community/timeline/model/community-event-model","DS/SwymUICore/script/feature/community/timeline/model/community-content-event-model","DS/SwymUICore/script/feature/community/timeline/model/im-event-model","DS/SwymUICore/script/feature/community/timeline/model/external-event-model"],function(e,t,i,n,o){"use strict";function s(e){var s;switch(e.message_type){case r:s=i;break;case a:s=t;break;case c:s=n;break;case u:s=o;break;default:throw new Error("Unknown type of message found")}return s}var r="INTERNAL_CONTENT",a="INTERNAL_EVENT",c="INSTANT_MESSAGE",u="EXTERNAL_EVENT";return{EVENT_NAMES:{CONTENT_MESSAGE:"INTERNAL_CONTENT",INTERNAL_EVENT:"INTERNAL_EVENT",IM_MESSAGE:"INSTANT_MESSAGE"},TYPES:{COMMENT_TYPE:"comment",ANSWER_TYPE:"answer",POST_MODEL_TYPE_TABLE:"CommunityPost",IDEA_MODEL_TYPE_TABLE:"Dsi_Ideation_Ideation",QUESTION_MODEL_TYPE_TABLE:"QnaQuestion",MEDIA_MODEL_TYPE_TABLE:"Media",WIKI_MODEL_TYPE_TABLE:"Dsi_DFSTree_WikiTree",SURVEY_MODEL_TYPE_TABLE:"poll",SOCIAL_EVENT_MODEL_TYPE_TABLE:"Conference",POST_MODEL_TYPE:"post",IDEA_MODEL_TYPE:"ideation",QUESTION_MODEL_TYPE:"question",MEDIA_MODEL_TYPE:"Media",WIKI_MODEL_TYPE:"wikipage",SURVEY_MODEL_TYPE:"Survey",COMMUNITY_MODEL_TYPE:"community",WEDO_MODEL_TYPE:"wedo",SOCIAL_EVENT_MODEL_TYPE:"social-event"},ACTIONS:{VALIDATED_ANSWER:"validate"},getEventModel:s,getEventModelInstance:function(t,i){var n=(this.getEventModel||s)(t),o=i?e.clone(i,!1):{};return o.areModelDataFromServer||(o.areModelDataFromServer=!0),new n(t,o)}}}),define("DS/SwymUICore/script/feature/core/realtime/realtime-bullet-manager",["require","exports","DS/SwymUICore/script/utils/im-core-utils","DS/SwymUICore/script/lib/event-manager","DS/SwymUICore/script/feature/community/timeline/mark/marks-manager","DS/SwymUICore/script/feature/community/timeline/model/event-model","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","DS/SwymUICore/script/feature/community/community/collection/community-collection","DS/SwymUICore/script/feature/core/direct-message/collection/direct-message-collection","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/realtime/rt-connector"],function(e,t,i,n,o,s,r,a,c,u,l){"use strict";return function(){function e(){l.init(),this.threadsWithUnreadContent={communities:new a([],{limit:999}),dms:new c([],{limit:999})}}return e.prototype.trackThreadUnreadStatus=function(){n.addEvent("onThreadUnreadStatusChange",this.onThreadUnreadStatusChange,this)},e.prototype.stopTrackingThreadUnreadStatus=function(){n.removeEvent("onThreadUnreadStatusChange",this.onThreadUnreadStatusChange,this)},e.prototype.onThreadUnreadStatusChange=function(e,t,i){var n;i&&!0===t&&(n=new s(i,{}),e.setCustomProperty("newestNewMessageDetails",{id:n.get("mid"),timestamp:n.getReferenceTimestamp()})),e instanceof r?!0===t?this.threadsWithUnreadContent.dms.unshift(e):this.threadsWithUnreadContent.dms.remove(e):!0===t?this.threadsWithUnreadContent.communities.unshift(e):this.threadsWithUnreadContent.communities.remove(e)},e.prototype.flagThreadsOnContentCreation=function(){this.indexForRTSubscription=l.subscribe(this.onContentCreationCb.bind(this))},e.prototype.onContentCreationCb=function(e){if(e&&"delete"!==e.action){var t=i.getEventModelInstance(e),n=void 0,a=void 0;if((t&&t.get("subject_state"))!==s.DELETED_STATE&&("function"==typeof t.getCommunity&&(n=t.getCommunity()),n&&("function"==typeof t.getAuthor?a=t.getAuthor():t.hasAssociation("sharedContent")&&(a=t.getAssociated("sharedContent").getAuthor()),a))){if(!a.isCurrentUser()){n.setCustomProperty("newestNewMessageDetails",{id:t.get("mid"),timestamp:t.getReferenceTimestamp()});var c=n.getCustomProperty("oldestNewMessageDetails");c?t.getReferenceTimestamp()<c.timestamp&&n.setCustomProperty("oldestNewMessageDetails",{id:t.get("mid"),timestamp:t.getReferenceTimestamp()}):n.setCustomProperty("oldestNewMessageDetails",{id:t.get("mid"),timestamp:t.getReferenceTimestamp()})}var l=void 0,d=!0;if("dm"===e.community_type){var m=n.toJSON();delete m.id,delete m.mark,delete m.last_message,delete m._containsContentUnreadByCurrentUser,delete m.is_favorite;var h=(l=new r(m,{areModelDataFromServer:!0})).get("users");Array.isArray(h)&&h.length>1&&(d=!1)}else l=n,d=!1;l.set("last_message",e),a.isCurrentUser()&&(l.set("mark",{message_id:t.get("mid")}),o.push(l)),!0===d&&u.getNbLayoutColumns()>1&&l.fetch({fromCache:!0})}}},e.prototype.stopFlaggingThreadsOnContentCreation=function(){null!==this.indexForRTSubscription&&(l.unsubscribe(this.indexForRTSubscription),this.indexForRTSubscription=null)},e.prototype.getUnreadCommunitiesCollection=function(){return this.threadsWithUnreadContent.communities},e.prototype.getUnreadDirectMessagesCollection=function(){return this.threadsWithUnreadContent.dms},e.prototype.destroy=function(){this.stopFlaggingThreadsOnContentCreation(),this.stopTrackingThreadUnreadStatus(),this.threadsWithUnreadContent=null},e}()}),define("DS/SwymUICore/script/feature/core/realtime/updatable",["require","exports","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/core/realtime/rt-connector","DS/SwymUICore/script/utils/im-core-utils","DS/SwymUICore/script/lib/model/model-manager"],function(e,t,i,n,o,s){"use strict";var r=[o.EVENT_NAMES.CONTENT_MESSAGE,o.EVENT_NAMES.INTERNAL_EVENT,o.EVENT_NAMES.IM_MESSAGE];return{setup:function(){n.init(),this._subscribeToRealtimeUpdates(),this._subscribeToOptimisticUpdates(),this._idForMessagesCreationSubscription=null,this._parent.apply(this,arguments)},_getMessageAssociatedWithOptimisticModel:function(e){var t,i=this._updatableOptions.add&&!0===this._updatableOptions.add.append,n=e.message_details&&e.message_details.model_id;return e.message_type===o.EVENT_NAMES.CONTENT_MESSAGE&&n&&(t=this.findWhere(i?{mid:n}:{"message_details->mid":n})),t||(e["X-Request-ID"]?t=this.findWhere(i?{"X-Request-ID":e["X-Request-ID"]}:{"message_details->X-Request-ID":e["X-Request-ID"]}):void 0)},_checkForOptimisticTreatment:function(e){var t=this._updatableOptions.add&&!0===this._updatableOptions.add.append,n=o.getEventModelInstance(e).getAssociated("author"),s=i.getInstance().get("user").login;n&&n.get("login")===s&&this._getMessageAssociatedWithOptimisticModel(e)&&this._getMessageAssociatedWithOptimisticModel(e).set(t?"optimisticFlag":"message_details->optimisticFlag",!1)},_filterMessagesDeleted:function(e){if("delete"===e.action&&this.communityId===e.community_id){var t=this.findWhere({mid:e.message_id});t||(t=this.findWhere({mid:e.model_id})),t&&this.remove(t)}},_filterMessagesCreatedOrEditedInTimeline:function(e){console.log("new messages has been caught : ",e);var t=e&&e.message_type;if(t&&r.includes(t)){var i=o.getEventModelInstance(e);if(this._updatableOptions&&i.getCommunity().get("mid")===this.communityId){var n=this._updatableOptions.add&&!0===this._updatableOptions.add.append,s=this._getMessageAssociatedWithOptimisticModel(e);if(n){var a=i.hasAssociation("sharedContent")&&i.getAssociated("sharedContent");a&&!s&&this.unshift(a)}else s?s.set(e):this._updatableOptions&&!1!==this._updatableOptions.addModelsDirectlyFromUpdatable?this.add(i):this.dispatchEvent("onModelReceivedFromUpdatable",[i])}}},_listenerOnPrePublishing:function(e){this._pushContentInCollection(e,{prepublish:!0})},_listenerOnCreationFailed:function(e){var t=this.findWhere({"message_details->publish_date":e.get("publish_date")});t&&this.remove(t)},_pushContentInCollection:function(e,t){e.getCommunity().get("mid")===this.communityId&&(this._completeModelWithDefaultData&&(e=this._completeModelWithDefaultData(e)),this._pushModelInCollection(e,t))},_pushModelInCollection:function(e,t){if(this._convertModelIntoPushableModelInTheCollection&&(e=this._convertModelIntoPushableModelInTheCollection(e)),e){var i=Object.assign(t||{},{addedByUpdatable:!0});this._updatableOptions.add&&!0===this._updatableOptions.add.append?this.unshift(e,i):this.add(e,i)}},_subscribeToOptimisticUpdates:function(){var e=this._updatableOptions.listeners||[];e.includes("contentCreation")&&s.addListenerOnPrePublishing(this._listenerOnPrePublishing.bind(this)),e.includes("failedCreation")&&s.addListenerOnCreationFailed(this._listenerOnCreationFailed.bind(this))},_subscribeToRealtimeUpdates:function(){var e=this._updatableOptions.listeners||[];e.includes("contentCreation")&&(this._idForMessagesCreationSubscription=n.subscribe(this._filterMessagesCreatedOrEditedInTimeline.bind(this))),e.includes("contentDeletion")&&(this._idForMessagesDeletionSubscription=n.subscribe(this._filterMessagesDeleted.bind(this)))},clean:function(){n.unsubscribe(this._idForMessagesCreationSubscription),this._idForMessagesCreationSubscription=null,n.unsubscribe(this._idForMessagesDeletionSubscription),this._idForMessagesDeletionSubscription=null,s.removeListenerOnPrePublishing(this._listenerOnPrePublishing.bind(this)),s.removeListenerOnCreationFailed(this._listenerOnCreationFailed.bind(this))}}}),define("DS/SwymUICore/script/lib/collection/mixed-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/lib/6wpanel/utils","DS/SwymUICore/script/utils/mixed-collection-utils","DS/SwymUICore/script/utils/exalead-interceptor"],function(e,t,i,n,o,s){"use strict";var r=t.extend(s,{_collectionName:"mixed-collection",_exaleadModesInRead:["latestContributions","search","customlist","recentpublications"],_services:{read:{"whats-new":{url:"api/feed/whatsnew",dataFn:function(t){return e.extend({page:this._currentPage,limit:this._limit,community_id:this.communityId,hash_key:this.hash_key},t||{})},postProcess:o.postProcessCallback},"ritual-whats-new":{method:"GET",urlFn(){return`/api/rituals/${this.communityId}/conferences`},dataFn:function(){return{page_number:this._currentPage-1,page_size:this._limit+1,after:this.getDefaultSearchOptions().after}},postProcess:o.postProcessCallback},"rituals-whats-new":{method:"GET",urlFn:()=>"/api/rituals/whatsnew",dataFn:function(){return{page_number:this._currentPage-1,page_size:this._limit+1}},postProcess:o.postProcessCallback},community:{url:"api/feed/whatsnew",dataFn:function(t){return e.extend({page:this._currentPage,limit:this._limit,community_id:this.communityId},t||{})},postProcess:o.postProcessCallback},latestContributions:{url:"api/exalead/whatsnew",paramsMapping:{limit:"nresults",startFrom:"start"},dataFn:function(e){return{start:(this._currentPage-1)*this._limit,nresults:this._limit,community_id:this.communityId,query:"#all",order_by:"desc",order_field:"ds6w_58_lastcontributed",legacyFormat:!1,...e}},parse:function(){var e=this._defaultParsingFn.apply(this,arguments);return o.mergeAuthorData(e)}},mycontributions:{urlFn:()=>"api/community/listcontribution",dataFn:function(t){return t=t||{},e.extend({start:(this._currentPage-1)*this._limit,limit:this._limit,id:this.communityId,hash_key:this.hash_key},t||{})},parse:function(e){var t,i,n;if(Array.isArray(e))for(t=0,i=e.length,t=0;t<i;t++)(n=e[t]).id=n.contribution_id,n.update=n.time,n.summary=n.description;return e}},search:{url:"api/exalead/search/",paramsMapping:{limit:"nresults"},dataFn:function(t){return e.extend(t||{},{legacyFormat:n.requestLegacyFormatForExaleadSearches(),query:this.exaleadQuery,contentType:this.exaleadContentType,refineUsingQuery:this.refineUsingQuery})},parse:function(){var e=this._defaultParsingFn.apply(this,arguments);return o.mergeAuthorData.call(this,e)}},customlist:{url:"api/exalead/search/",paramsMapping:{limit:"nresults"},dataFn:function(t){return e.extend({legacyFormat:n.requestLegacyFormatForExaleadSearches(),query:this.exaleadQuery,contentType:this.exaleadContentType,refineUsingQuery:this.refineUsingQuery},t||{})},parse:function(e,t){var i,n=this._defaultParsingFn.apply(this,arguments);return(i=t.additionalParsingFunction)&&"function"==typeof i?i(o.mergeAuthorData.call(this,n)):o.mergeAuthorData.call(this,n)}},recentpublications:{url:"api/exalead/whatsnew",paramsMapping:{limit:"nresults",startFrom:"start"},dataFn:function(e){return e||{}},parse:function(){var e=o.getNItemsFromArrayRandomly(this._defaultParsingFn.apply(this,arguments),5);return o.mergeAuthorData.call(this,e)}}},filter:{"whats-new":{url:"api/exalead/whatsnew",tagsWithoutSubjectURI:!0,dataFn:function(e){return this.hash_key&&(e.hash_key=this.hash_key),e}},"ritual-whats-new":{urlFn(){return`/api/rituals/${this.communityId}/whatsnew`},dataFn:function(t){return e.extend({page:this._currentPage,limit:this._limit,community_id:this.communityId,hash_key:this.hash_key},t||{})},postProcess:o.postProcessCallback},"rituals-whats-new":{urlFn:()=>"/api/rituals/whatsnew",dataFn:function(t){return e.extend({page_number:this._currentPage,page_size:this._limit},t||{})},postProcess:o.postProcessCallback},community:{url:"api/exalead/whatsnew",dataFn:function(t){return e.extend(t||{},{community_id:this.communityId})},tagsWithoutSubjectURI:!0},latestContributions:{url:"api/exalead/whatsnew",dataFn:function(t){return e.extend(t||{},{community_id:this.communityId,order_by:"desc",order_field:"ds6w_58_lastcontributed"})},tagsWithoutSubjectURI:!0},search:{url:"api/exalead/search",tagsWithoutSubjectURI:!0,dataFn:function(t){return e.extend(t||{},{refineUsingQuery:this.refineUsingQuery})},parse:function(){var e=this._defaultParsingFn.apply(this,arguments);return o.mergeAuthorData.call(this,e)}},customlist:{url:"api/exalead/search",tagsWithoutSubjectURI:!0,dataFn:function(t){return e.extend({refineUsingQuery:this.refineUsingQuery},t||{})},parse:function(){var e=this._defaultParsingFn.apply(this,arguments);return o.mergeAuthorData.call(this,e)}},recentpublications:{url:"api/exalead/whatsnew",paramsMapping:{limit:"nresults",startFrom:"start"},dataFn:function(e){return e||{}},parse:function(){var e=this._defaultParsingFn.apply(this,arguments);return o.mergeAuthorData.call(this,e)}}}},hash_key:null,communityId:null,refineUsingQuery:null,model:o.getModelInstance,mode:null,modes:["whats-new","ritual-whats-new","rituals-whats-new","mycontributions","community","search","customlist","recentpublications","bookmarks","latestContributions"],init:function(t,i){if(i){if(i.model)throw delete i.model,{name:"Model provided",message:"No model should be provided for a mixed collection"};i.communityId&&(this.communityId=i.communityId),i.hash_key&&(this.hash_key=i.hash_key),i.refineUsingQuery&&(this.refineUsingQuery=i.refineUsingQuery)}return this._parent(t,i),"whats-new"!==this.mode&&"community"!==this.mode||i.paginationMode||(this.paginationMode="PREV_NEXT"),!0===i.removeMediaIfNotHighSemanticAnymore&&this.addEvent("onChange:is_illustration",function(t){e.is(t.getModelName,"function")&&"media"===t.getModelName()&&(!0!==t.get("is_illustration")&&"1"!==t.get("is_illustration")||this.remove(t))}),this},parse:function(t,n){var s,r,a,c=this._parent(t,n);if(e.is(c,"array")){r=[];for(var u=0,l=c.length;u<l;u++)(a=c[u])instanceof i?r.push(a):(s=o.getModel(a),r.push(s.prototype.applyAttributesMapping(a)))}else r=c;return r}});return o.getModelInstance.prototype.idAttribute="id",r}),define("DS/SwymUICore/script/feature/core/favorite-communities/collection/favorite-communities-collection",["UWA/Core","DS/SwymUICore/script/feature/community/community/collection/community-collection"],function(e,t){"use strict";var i=function(e){var t,i,n,o=[],s={};for(i in e.hits)if(e.hits.hasOwnProperty(i)){for(n in s={},t=e.hits[i].metas)t.hasOwnProperty(n)&&(s[t[n].name]=t[n].value);o.push(s)}return o};return t.extend({_collectionName:"favorite-communities-collection",comparator:function(e,t){return this.listIds.indexOf(e.get("mid"))>this.listIds.indexOf(t.get("mid"))?1:-1},_services:{read:{all:{url:"api/exalead/searchmycommunities",method:"POST",dataFn:function(){return{nresults:999,legacyFormat:!1,start:0,only_with_stats_access:!1,contentType:"community",query:this._buildIdQuery()}},parse:i,tagsWithoutSubjectURI:!0}},filter:{all:{url:"api/exalead/searchmycommunities",method:"POST",dataFn:function(t){var i=this._buildIdQuery();return e.extend(t||{},{refineUsingQuery:i})},parse:i,tagsWithoutSubjectURI:!0}}},modes:["all"],setup:function(e,t){this.listIds=t.listIds},_buildIdQuery:function(){var e,t="";for(e in this.listIds)this.listIds.hasOwnProperty(e)&&(t+=(""!==t?" OR ":"")+'id:"'+this.listIds[e]+'"');return t}})}),define("DS/SwymUICore/script/feature/core/favorite/collection/favorite-communities-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/core/favorite/model/favorite-communities-model"],function(e,t,i){"use strict";return t.extend({_asAdmin:!1,_tempCollection:null,_collectionName:"favorite-communities-collection",_services:{read:{"my-favorites-communities":{url:"api/favorites/communities",method:"GET",dataFn:function(e){return{page:e.page,limit:e.limit}}}},filter:{"my-favorites-communities":{url:"api/exalead/search",method:"POST",dataFn:function(t){return e.extend(t||{},{favorite_communities:"only",contentType:"community",with_synthesis:!1})},parse:function(e){var t,i,n,o=[],s={};for(i in e.hits)if(e.hits.hasOwnProperty(i)){for(n in s={},t=e.hits[i].metas)t.hasOwnProperty(n)&&(s[t[n].name]=t[n].value);o.push(s)}return o},tagsWithoutSubjectURI:!0}}},model:i,modes:["my-favorites-communities"],comparator:function(e,t){return e.get("position")>t.get("position")?1:-1}})});