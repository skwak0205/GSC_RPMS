define("DS/Mesh/ThreeJS_Base",[],function(){"use strict";var t=t||{REVISION:"57"};t.extend=function(t,i){if(Object.keys)for(var e=Object.keys(i),s=0,n=e.length;s<n;s++){var r=e[s];Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(i,r))}else{var h={}.hasOwnProperty;for(var r in i)h.call(i,r)&&(t[r]=i[r])}return t},String.prototype.hashCode=function(){var t,i=0;if(0===this.length)return i;for(t=0;t<this.length;t++)i=(i<<5)-i+this.charCodeAt(t),i|=0;return i},t.SplitTrimStickString=function(t){return t.split("\n").map(t=>t.trim()).filter(t=>t.length>0&&!t.startsWith("//")).join("\n")},String.prototype.includes||(String.prototype.includes=function(t,i){return"number"!=typeof i&&(i=0),!(i+t.length>this.length)&&-1!==this.indexOf(t,i)}),Array.prototype.findLastIndex||Object.defineProperty(Array.prototype,"findLastIndex",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');if("function"!=typeof t)throw new TypeError("predicate must be a function");return Array.from(this).reverse().findIndex(t)},configurable:!0,writable:!0}),Uint32Array.prototype.slice||Object.defineProperty(Uint32Array.prototype,"slice",{value:function(t,i){return new Uint32Array(Array.prototype.slice.call(this,t,i))}}),Float32Array.prototype.slice||Object.defineProperty(Float32Array.prototype,"slice",{value:function(t,i){return new Float32Array(Array.prototype.slice.call(this,t,i))}}),"function"!=typeof Object.values&&Object.defineProperty(Object,"values",{value:function(t){var i=[];for(var e in t)t.hasOwnProperty(e)&&i.push(t[e]);return i},writable:!0,configurable:!0}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t,i){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),s=1;s<arguments.length;s++){var n=arguments[s];if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},writable:!0,configurable:!0}),Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{value:function(t){if(null==this)throw new TypeError("this is null or not defined");for(var i=Object(this),e=i.length>>>0,s=arguments[1]>>0,n=s<0?Math.max(e+s,0):Math.min(s,e),r=arguments[2],h=void 0===r?e:r>>0,o=h<0?Math.max(e+h,0):Math.min(h,e);n<o;)i[n]=t,n++;return i}}),Float32Array.prototype.fill||(Float32Array.prototype.fill=Array.prototype.fill),Uint32Array.prototype.fill||(Uint32Array.prototype.fill=Array.prototype.fill),t.getWebVisualizationLevel=function(){return 425},t.getWebVisualizationFDLevel=function(){return 1},t._webglPerformanceProfile=function(){return"true"===localStorage.getItem("__WEBVISU_USE_HIGHPERFORMANCE_PROFILE__")?"high-performance":"default"},t.GeomTypeEnum={EDGE:1,WIRE_EDGE:2,BOUNDARY_EDGE:4,SHARP_EDGE:8,SMOOTH_EDGE:16,HIDDEN_SEAM_EDGE:32,BOUNDARY_POINT:64,SHARP_POINT:128,SMOOTH_POINT:256,SURFACIC_POINT:512,FREE_POINT:1024,HIDDEN_SEAM_POINT:2048,INFINITE_FACE:4096,FACE:8192,UNKNOWN:16384,_OUTLINE:32768,_SECTION_LINE:65536,AXIS_SYSTEM:1<<17,UNKNOWN_2D:1<<18,UNKNOWN_1D:1<<19,UNKNOWN_0D:1<<20},t.AllGeomTypesMask=2097151,t._VisuFilterType={GAS_INHERIT:0,POLYGON_OFFSET:1,ZMODE:2,GEOM_TYPE:3,DO_NOT_PICK_UNDER:4,LOOK:5,_STATIC_GEOM_TYPE:6,FURTIVE:7,_MATERIAL_TO_USE:8},t.FixedSizeFiltering={Include:0,Exclude:1,CenterOnly:2},t.PriorityMode={ClassicPriority:0,SceneGraphOrder:1,Advanced:2,DepthPriority:3,ClassicPriority2D:4},t.AlphaTestMode={DISCARD:0,DISCARD_OR_OPAQUE:1},t.FilterMode={Replace:0,Cumulative:1,None:2,V4Master:3},t.PolygonOffsetForceStatus={DEFAULT:0,ENABLED:1,DISABLED:2},t.TextureBlendOperations={DECAL:0,MODULATE:1,BLEND:2,REPLACE:3,IGNORE:4,KEEP_DEFAULT:5},t.AnchorPoint={BOTTOM_LEFT:0,BOTTOM_CENTER:1,BOTTOM_RIGHT:2,BASE_LEFT:3,BASE_CENTER:4,BASE_RIGHT:5,TOP_LEFT:6,TOP_CENTER:7,TOP_RIGHT:8},t.MappingType={DISABLED:-1,NONE:0,PLANAR:1,SPHERICAL:2,CUBIC:3,FINITE_CYLINDRICAL:4,INFINITE_CYLINDRICAL:5,SPHERICAL_NORMALIZED:6,INFINITE_CYLINDRICAL_NORMALIZED:7,INFINITE_CYLINDRICAL_NORM_ANGLE_PRES:8},t.MappingTransformSemantic={DEFAULT:1,SEPARATE_TRANSLATION:2,ROTATION_AROUND_CENTER:3},t._BinaryPrimitives=!1,t.IsIE11=null!=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent),t.isIOS=function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1},t.isAndroid=function(){return navigator.userAgent.match(/(Android)/i)},t.isMacOS=function(){return!t.isIOS()&&navigator.platform.toUpperCase().indexOf("MAC")>=0},t.isAppleDevice=function(){return t.isIOS()||t.isMacOS()},t.isMobile=function(){return t.isIOS()||t.isAndroid()},t.__unrolledHighlight=function(){return t.isAppleDevice()};var i=["LARGE_SCALE","NON_UNIFORM_SCALE","OIT","COMPRESSED_VERTICES","COMPRESSED_UVS","COMPRESSED_COLORS","COMPRESSED_NORMALS","FIXED_SIZE","FIXED_SIZE_CENTER","BILLBOARD","LIGHT_MAP","POLITE_HIGHLIGHT","PRIMITIVE_HIGHLIGHT","ADJACENCE_HIGHLIGHT","NOZ_OBJECT","DECALS","MAPPING_OPERATOR","MAPPING_OPERATOR_VERTEX","SKIP_TRANSPAR","SKINNING","SKINNING_INSTANCING","VERTEX_COLORS"];if(i.length>24)throw"too many program ids";for(var e,s,n,r,h,o=new Object,a=0;a<i.length;a++)o[i[a]]=1<<a+6;t.ProgramIDs=o,t.AssetSource={MANUAL:0,MATERIAL_MANAGER:1},t.__visibleInCurrentSpaceSimple=function(t,i,e,s){var n=!0;if(!(n=i?t:e?t:!t)&&s&&s.layers)for(var r=s&&s.layers,h=0;h<r.length;h++){var o=r[h].drawableInterval;if(o&&!o.skip(null,null)&&o.gas&&o.gas.isGAS&&(!o.gas._show||o.gas._showFree))return!0}return n},t.__visibleInCurrentSpace=function(i,e,s,n,r){var h=t.__visibleInCurrentSpaceSimple(i,e,s,n);return r&&r._isFurtiveFiltered()&&(h=!1),h},t.setValuesToObject=function(i,e,s){if(e)for(var n in e){var r=e[n];if(void 0!==r&&!s.has(n)&&n in i){var h=i[n];h instanceof t.Color&&r instanceof t.Color?h.copy(r):h instanceof t.Color?h.set(r):h instanceof t.Vector3&&r instanceof t.Vector3?h.copy(r):h instanceof t.Vector2&&r instanceof t.Vector2?h.copy(r):h instanceof Float32Array&&r instanceof Float32Array?i[n]=new Float32Array(r):i[n]=r}}},t.EventDispatcher=function(){var t={};this.addEventListener=function(i,e){void 0===t[i]&&(t[i]=[]),-1===t[i].indexOf(e)&&t[i].push(e)},this.removeEventListener=function(i,e){var s=t[i].indexOf(e);-1!==s&&(t[i][s]=null)},this.dispatchEvent=function(i){var e=t[i.type];if(void 0!==e){i.target=this;for(var s=!1,n=0,r=e.length;n<r;n++)e[n]?e[n].call(this,i):s=!0;if(s){var h=[];for(n=0,r=e.length;n<r;n++)e[n]&&h.push(e[n]);t[i.type]=h}}}},t.VisualizationTraces={_traces:[],info:function(t){var i=new Error,e=t+" - "+(i.stack?i.stack.split("\n")[2]:"");this._traces.push(e)},displayInfo:function(){console.log(this._traces)}},t.Quaternion=function(t,i,e,s){this.x=t||0,this.y=i||0,this.z=e||0,this.w=void 0!==s?s:1},t.Quaternion.prototype={constructor:t.Quaternion,set:function(t,i,e,s){return this.x=t,this.y=i,this.z=e,this.w=s,this},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},createJSON:function(){return{x:this.x,y:this.y,z:this.z,w:this.w}},setFromJSON:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},setFromEuler:function(t,i){var e=Math.cos(t.x/2),s=Math.cos(t.y/2),n=Math.cos(t.z/2),r=Math.sin(t.x/2),h=Math.sin(t.y/2),o=Math.sin(t.z/2);return void 0===i||"XYZ"===i?(this.x=r*s*n+e*h*o,this.y=e*h*n-r*s*o,this.z=e*s*o+r*h*n,this.w=e*s*n-r*h*o):"YXZ"===i?(this.x=r*s*n+e*h*o,this.y=e*h*n-r*s*o,this.z=e*s*o-r*h*n,this.w=e*s*n+r*h*o):"ZXY"===i?(this.x=r*s*n-e*h*o,this.y=e*h*n+r*s*o,this.z=e*s*o+r*h*n,this.w=e*s*n-r*h*o):"ZYX"===i?(this.x=r*s*n-e*h*o,this.y=e*h*n+r*s*o,this.z=e*s*o-r*h*n,this.w=e*s*n+r*h*o):"YZX"===i?(this.x=r*s*n+e*h*o,this.y=e*h*n+r*s*o,this.z=e*s*o-r*h*n,this.w=e*s*n-r*h*o):"XZY"===i&&(this.x=r*s*n-e*h*o,this.y=e*h*n-r*s*o,this.z=e*s*o+r*h*n,this.w=e*s*n+r*h*o),this},setFromAxisAngle:function(t,i){var e=i/2,s=Math.sin(e);return this.x=t.x*s,this.y=t.y*s,this.z=t.z*s,this.w=Math.cos(e),this},toEuler:function(){var i=new t.Vector3;return i.x=Math.atan2(2*(this.w*this.x+this.y*this.z),1-2*(this.x*this.x+this.y*this.y)),i.y=Math.asin(2*(this.w*this.y-this.z*this.x)),i.z=Math.atan2(2*(this.w*this.z+this.x*this.y),1-2*(this.y*this.y+this.z*this.z)),i},setFromRotationMatrix:function(t){var i,e=t.elements,s=e[0],n=e[4],r=e[8],h=e[1],o=e[5],a=e[9],u=e[2],c=e[6],l=e[10],y=s+o+l;return y>0?(i=.5/Math.sqrt(y+1),this.w=.25/i,this.x=(c-a)*i,this.y=(r-u)*i,this.z=(h-n)*i):s>o&&s>l?(i=2*Math.sqrt(1+s-o-l),this.w=(c-a)/i,this.x=.25*i,this.y=(n+h)/i,this.z=(r+u)/i):o>l?(i=2*Math.sqrt(1+o-s-l),this.w=(r-u)/i,this.x=(n+h)/i,this.y=.25*i,this.z=(a+c)/i):(i=2*Math.sqrt(1+l-s-o),this.w=(h-n)/i,this.x=(r+u)/i,this.y=(a+c)/i,this.z=.25*i),this},toRotationMatrix:function(){var i=2*this.x,e=2*this.y,s=2*this.z,n=i*this.w,r=e*this.w,h=(this.w,i*this.x),o=(this.x,s*this.x),a=e*this.y,u=s*this.y;this.z,(new t.Matrix3).elements;return new t.Vector3(o-r,u+n,1-(h+a))},inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},normalize:function(){var t=this.length();return 0===t?(this.x=0,this.y=0,this.z=0,this.w=1):(t=1/t,this.x=this.x*t,this.y=this.y*t,this.z=this.z*t,this.w=this.w*t),this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},sub:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this},multiply:function(t,i){return void 0!==i?(console.warn("DEPRECATED: Quaternion's .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,i)):this.multiplyQuaternions(this,t)},multiplyQuaternions:function(t,i){var e=t.x,s=t.y,n=t.z,r=t.w,h=i.x,o=i.y,a=i.z,u=i.w;return this.x=e*u+r*h+s*a-n*o,this.y=s*u+r*o+n*h-e*a,this.z=n*u+r*a+e*o-s*h,this.w=r*u-e*h-s*o-n*a,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},multiplyVector3:function(t){return console.warn("DEPRECATED: Quaternion's .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},log:function(){if(Math.abs(this.w)>=1)return this.w=0,this;var t=Math.acos(this.w),i=Math.sin(t);if(this.w=0,Math.abs(i)<.001)return this;var e=t/i;return this.x*=e,this.y*=e,this.z*=e,this},exp:function(){var t=this.length();this.w=Math.cos(t);var i=Math.sin(t);if(Math.abs(t)<.001)return this;var e=i/t;return this.x*=e,this.y*=e,this.z*=e,this},slerp:function(t,i){var e=this.x,s=this.y,n=this.z,r=this.w,h=r*t.w+e*t.x+s*t.y+n*t.z;if(h<0?(this.w=-t.w,this.x=-t.x,this.y=-t.y,this.z=-t.z,h=-h):this.copy(t),h>=1)return this.w=r,this.x=e,this.y=s,this.z=n,this;var o=Math.acos(h),a=Math.sqrt(1-h*h);if(Math.abs(a)<.001)return this.w=.5*(r+this.w),this.x=.5*(e+this.x),this.y=.5*(s+this.y),this.z=.5*(n+this.z),this;var u=Math.sin((1-i)*o)/a,c=Math.sin(i*o)/a;return this.w=r*u+this.w*c,this.x=e*u+this.x*c,this.y=s*u+this.y*c,this.z=n*u+this.z*c,this},intermediatePoint:function(i,n,r){return e||(e=new t.Quaternion),s||(s=new t.Quaternion),e.copy(n).inverse().multiply(i).log(),s.copy(n).inverse().multiply(r).log(),e.add(s).multiplyScalar(-.25),this.copy(n).multiply(e.exp()),this.normalize(),this},squad:function(i,e,s,n,r){this.copy(i).slerp(n,r,!1),this.normalize();var h=(new t.Quaternion).copy(e).slerp(s,r);return h.normalize(),this.slerp(h,2*r*(1-r)).normalize()},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},clone:function(){return new t.Quaternion(this.x,this.y,this.z,this.w)}},t.Quaternion.slerp=function(t,i,e,s){return e.copy(t).slerp(i,s)},t.Curve=function(){},t.Curve.prototype.getPoint=function(t){return console.log("Warning, getPoint() not implemented!"),null},t.Curve.prototype.getPointAt=function(t,i){var e=this.getUtoTmapping(t,i);return this.getPoint(e)},t.Curve.prototype.getPoints=function(t){t||(t=5);var i,e=[];for(i=0;i<=t;i++)e.push(this.getPoint(i/t));return e},t.Curve.prototype.getSpacedPoints=function(t){t||(t=5);var i,e=[];for(i=0;i<=t;i++)e.push(this.getPointAt(i/t));return e},t.Curve.prototype.getLength=function(t){var i=this.getLengths();if(void 0!==t){var e=t*(i.length-1),s=Math.floor(e),n=e-s;return s+1>=i.length?i[s]:(1-n)*i[s]+n*i[s+1]}return i[i.length-1]},t.Curve.prototype.getLengths=function(t){if(t||(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var i,e,s=[],n=this.getPoint(0),r=0;for(s.push(0),e=1;e<=t;e++)r+=(i=this.getPoint(e/t)).distanceTo(n),s.push(r),n=i;return this.cacheArcLengths=s,s},t.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0,this.getLengths()},t.Curve.prototype.getUtoTmapping=function(t,i){var e,s=this.getLengths(),n=0,r=s.length;e=i||t*s[r-1];for(var h,o=0,a=r-1;o<=a;)if((h=s[n=Math.floor(o+(a-o)/2)]-e)<0)o=n+1;else{if(!(h>0)){a=n;break}a=n-1}if(s[n=a]==e)return n/(r-1);var u=s[n];return(n+(e-u)/(s[n+1]-u))/(r-1)},t.Curve.prototype.getTangent=function(t){var i=t-1e-4,e=t+1e-4;i<0&&(i=0),e>1&&(e=1);var s=this.getPoint(i);return this.getPoint(e).clone().sub(s).normalize()},t.Curve.prototype.getTangentAt=function(t){var i=this.getUtoTmapping(t);return this.getTangent(i)},t.Curve.create=function(i,e){return i.prototype=Object.create(t.Curve.prototype),i.prototype.getPoint=e,i},t.Curve.Utils={tangentQuadraticBezier:function(t,i,e,s){return 2*(1-t)*(e-i)+2*t*(s-e)},tangentCubicBezier:function(t,i,e,s,n){return-3*i*(1-t)*(1-t)+3*e*(1-t)*(1-t)-6*t*e*(1-t)+6*t*s*(1-t)-3*t*t*s+3*t*t*n},tangentSpline:function(t,i,e,s,n){return 6*t*t-6*t+(3*t*t-4*t+1)+(-6*t*t+6*t)+(3*t*t-2*t)},interpolate:function(t,i,e,s,n){var r=.5*(e-t),h=.5*(s-i),o=n*n;return(2*i-2*e+r+h)*(n*o)+(-3*i+3*e-2*r-h)*o+r*n+i}},t.QuaternionSpline=function(t){this.controlPts=[],this.tangentPts=[],this.setPoints(t)},t.QuaternionSpline.prototype={constructor:t.QuaternionSpline,setPoints:function(t){this.controlPts=t,t&&this._updateTangents()},clear:function(){this.controlPts=[],this.tangentPts=[]},getNbPoints:function(){return this.controlPts.length},addPoint:function(t){this.controlPts.push(t),this._updateTangents()},insertPoint:function(t,i){return!(t<0||t>this.controlPts.length)&&(this.controlPts.splice(t,0,i),this._updateTangents(),!0)},updatePoint:function(t,i){return!(t<0||t>=this.controlPts.length)&&(this.controlPts[t]=i,this._updateTangents(),!0)},removePoint:function(t){return!(t<0||t>=this.controlPts.length)&&(this.controlPts.splice(t,1),this._updateTangents(),!0)},interpolate:function(t){var i=t*(this.controlPts.length-1),e=Math.floor(i);return this._interpolate(e,i-e)},_interpolate:function(i,e){return i===this.controlPts.length-1?this.controlPts[i]:0===e?this.controlPts[i]:1===e?this.controlPts[i+1]:(new t.Quaternion).squad(this.controlPts[i],this.tangentPts[i],this.tangentPts[i+1],this.controlPts[i+1],e)},_updateTangents:function(){var i=this.controlPts.length;if(!(i<2)){this.controlPts[i-1].normalize();for(var e=i-1;e>0;e--)this.controlPts[e-1].normalize(),this.controlPts[e-1].dot(this.controlPts[e])<=0&&this.controlPts[e-1].multiplyScalar(-1);var s=this.controlPts[0].equals(this.controlPts[i-1]);for(e=0;e<i;++e){var n,r,h=this.controlPts[e];e?e===i-1?(n=this.controlPts[e-1],r=s?this.controlPts[1]:h):(n=this.controlPts[e-1],r=this.controlPts[e+1]):(r=this.controlPts[1],n=s?this.controlPts[i-2]:h),this.tangentPts[e]||(this.tangentPts[e]=new t.Quaternion),this.tangentPts[e].intermediatePoint(n,h,r)}}}},t.PositionSpline=function(t){this.controlPts=[],t&&this.setPoints(t)},t.PositionSpline.prototype={constructor:t.PositionSpline,getPointAt:t.Curve.prototype.getPointAt,getLength:t.Curve.prototype.getLength,getLengths:t.Curve.prototype.getLengths,updateArcLengths:t.Curve.prototype.updateArcLengths,getUtoTmapping:t.Curve.prototype.getUtoTmapping,getPoint:function(t){var i=t*(this.controlPts.length-1),e=Math.floor(i);return this._interpolate(e,i-e)},getNbPoints:function(){return this.controlPts.length},setPoints:function(t){this.controlPts=t,this._updateCurve()},clear:function(){this.controlPts=[],this._updateCurve()},addPoint:function(t){this.controlPts.push(t),this._updateCurve()},insertPoint:function(t,i){return!(t<0||t>this.controlPts.length)&&(this.controlPts.splice(t,0,i),this._updateCurve(),!0)},updatePoint:function(t,i){return!(t<0||t>=this.controlPts.length)&&(this.controlPts[t]=i,this._updateCurve(),!0)},removePoint:function(t){return!(t<0||t>=this.controlPts.length)&&(this.controlPts.splice(t,1),this._updateCurve(),!0)},_updateCurve:function(){this.updateArcLengths()},_interpolate:function(i,e){var s=this.controlPts.length;if(s<2)return null;if(i===s-1)return this.controlPts[i];if(0===e)return this.controlPts[i];if(1===e)return this.controlPts[i+1];var n,r,h,o=this.controlPts[0].equals(this.controlPts[s-1]),a=this.controlPts[i];o?(n=i?this.controlPts[i-1]:this.controlPts[s-2],r=i>s-2?this.controlPts[1]:this.controlPts[i+1],h=i===s-1?this.controlPts[2]:i===s-2?this.controlPts[1]:this.controlPts[i+2]):(n=i?this.controlPts[i-1]:a,r=i>s-2?a:this.controlPts[i+1],h=i>s-3?r:this.controlPts[i+2]);var u=void 0!==this.controlPts[0].w,c=u?new t.Vector4:new t.Vector3;return c.x=this._CatmullInterpolate(n.x,a.x,r.x,h.x,e),c.y=this._CatmullInterpolate(n.y,a.y,r.y,h.y,e),c.z=this._CatmullInterpolate(n.z,a.z,r.z,h.z,e),u&&(c.w=this._CatmullInterpolate(n.w,a.w,r.w,h.w,e)),c},_CatmullInterpolate:function(t,i,e,s,n){var r=.5*(e-t),h=.5*(s-i),o=n*n;return(2*i-2*e+r+h)*(n*o)+(-3*i+3*e-2*r-h)*o+r*n+i}},t.Vector2=function(t,i){this.x=t||0,this.y=i||0},t.Vector2.prototype={constructor:t.Vector2,set:function(t,i){return this.x=t,this.y=i,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,i){return void 0!==i?(console.warn("DEPRECATED: Vector2's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this)},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this},addScalar:function(t){return this.x+=t,this.y+=t,this},sub:function(t,i){return void 0!==i?(console.warn("DEPRECATED: Vector2's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this)},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divideScalar:function(t){return 0!==t?(this.x/=t,this.y/=t):this.set(0,0),this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this},clamp:function(t,i){return this.x<t.x?this.x=t.x:this.x>i.x&&(this.x=i.x),this.y<t.y?this.y=t.y:this.y>i.y&&(this.y=i.y),this},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var i=this.x-t.x,e=this.y-t.y;return i*i+e*e},setLength:function(t){var i=this.length();return 0!==i&&t!==i&&this.multiplyScalar(t/i),this},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this},equals:function(t){return t.x===this.x&&t.y===this.y},toArray:function(){return[this.x,this.y]},clone:function(){return new t.Vector2(this.x,this.y)}},t.Vector3=function(t,i,e){this.x=t||0,this.y=i||0,this.z=e||0},t.Vector3.prototype={constructor:t.Vector3,set:function(t,i,e){return this.x=t,this.y=i,this.z=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},barycentricCoordinates:function(i,e,s){var n=(new t.Vector3).subVectors(i,this),r=(new t.Vector3).subVectors(e,this),h=(new t.Vector3).subVectors(s,this),o=(new t.Vector3).subVectors(i,e),a=(new t.Vector3).subVectors(i,s),u=1/(new t.Vector3).crossVectors(o,a).length();return{alpha:(new t.Vector3).crossVectors(r,h).length(),beta:(new t.Vector3).crossVectors(h,n).length(),gamma:(new t.Vector3).crossVectors(n,r).length(),normalisationFactor:u}},setFromJSON:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},setFromArray:function(t){return this.x=t[0],this.y=t[1],this.z=t[2],this},createJSON:function(){return{x:this.x,y:this.y,z:this.z}},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},getMaxAxis:function(){var t=0,i=this.x;return this.y>i&&(t=1,i=this.y),this.z>i&&(t=2,i=this.z),t},add:function(t,i){return void 0!==i?(console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this},sub:function(t,i){return void 0!==i?(console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this},multiply:function(t,i){return void 0!==i?(console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,i)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this},applyMatrix3:function(t){var i=this.x,e=this.y,s=this.z,n=t.elements;return this.x=n[0]*i+n[3]*e+n[6]*s,this.y=n[1]*i+n[4]*e+n[7]*s,this.z=n[2]*i+n[5]*e+n[8]*s,this},applyMatrix4:function(t){if(!t)return this;var i=this.x,e=this.y,s=this.z,n=t.elements;return this.x=n[0]*i+n[4]*e+n[8]*s+n[12],this.y=n[1]*i+n[5]*e+n[9]*s+n[13],this.z=n[2]*i+n[6]*e+n[10]*s+n[14],this},applyRotation:function(t){if(!t)return this;var i=this.x,e=this.y,s=this.z,n=t.elements;return this.x=n[0]*i+n[4]*e+n[8]*s,this.y=n[1]*i+n[5]*e+n[9]*s,this.z=n[2]*i+n[6]*e+n[10]*s,this},applyProjection:function(t){var i=this.x,e=this.y,s=this.z,n=t.elements,r=1/(n[3]*i+n[7]*e+n[11]*s+n[15]);return this.x=(n[0]*i+n[4]*e+n[8]*s+n[12])*r,this.y=(n[1]*i+n[5]*e+n[9]*s+n[13])*r,this.z=(n[2]*i+n[6]*e+n[10]*s+n[14])*r,this},applyQuaternion:function(t){var i=this.x,e=this.y,s=this.z,n=t.x,r=t.y,h=t.z,o=t.w,a=o*i+r*s-h*e,u=o*e+h*i-n*s,c=o*s+n*e-r*i,l=-n*i-r*e-h*s;return this.x=a*o+l*-n+u*-h-c*-r,this.y=u*o+l*-r+c*-n-a*-h,this.z=c*o+l*-h+a*-r-u*-n,this},transformDirection:function(t){var i=this.x,e=this.y,s=this.z,n=t.elements;return this.x=n[0]*i+n[4]*e+n[8]*s,this.y=n[1]*i+n[5]*e+n[9]*s,this.z=n[2]*i+n[6]*e+n[10]*s,this.normalize(),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return 0!==t?(this.x/=t,this.y/=t,this.z/=t):(this.x=0,this.y=0,this.z=0),this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this.z>t.z&&(this.z=t.z),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this.z<t.z&&(this.z=t.z),this},clamp:function(t,i){return this.x<t.x?this.x=t.x:this.x>i.x&&(this.x=i.x),this.y<t.y?this.y=t.y:this.y>i.y&&(this.y=i.y),this.z<t.z?this.z=t.z:this.z>i.z&&(this.z=i.z),this},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){var i=this.length();return 0!==i&&t!==i&&this.multiplyScalar(t/i),this},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this},cross:function(t,i){if(void 0!==i)return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,i);var e=this.x,s=this.y,n=this.z;return this.x=s*t.z-n*t.y,this.y=n*t.x-e*t.z,this.z=e*t.y-s*t.x,this},crossVectors:function(t,i){return this.x=t.y*i.z-t.z*i.y,this.y=t.z*i.x-t.x*i.z,this.z=t.x*i.y-t.y*i.x,this},applyAxisAngle:function(i,e){return void 0===h&&(h=new t.Quaternion),this.applyQuaternion(h.setFromAxisAngle(i,e)),this},projectOnVector:function(i){return void 0===n&&(n=new t.Vector3),n.copy(i).normalize(),r=this.dot(n),this.copy(n).multiplyScalar(r)},projectOnPlane:function(){var i;return function(e){return void 0===i&&(i=new t.Vector3),i.copy(this).projectOnVector(e),this.sub(i)}}(),reflect:function(){var i;return function(e){return void 0===i&&(i=new t.Vector3),this.sub(i.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(i){var e=this.dot(i)/(this.length()*i.length());return Math.acos(t.Math.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var i=this.x-t.x,e=this.y-t.y,s=this.z-t.z;return i*i+e*e+s*s},getPositionFromMatrix:function(t){return this.x=t.elements[12],this.y=t.elements[13],this.z=t.elements[14],this},getColumnFromMatrix:function(t,i){var e=4*t,s=i.elements;return this.x=s[e],this.y=s[e+1],this.z=s[e+2],this},setEulerFromRotationMatrix:function(t,i){function e(t){return Math.min(Math.max(t,-1),1)}var s=t.elements,n=s[0],r=s[4],h=s[8],o=s[1],a=s[5],u=s[9],c=s[2],l=s[6],y=s[10];return void 0===i||"XYZ"===i?(this.y=Math.asin(e(h)),Math.abs(h)<.99999?(this.x=Math.atan2(-u,y),this.z=Math.atan2(-r,n)):(this.x=Math.atan2(l,a),this.z=0)):"YXZ"===i?(this.x=Math.asin(-e(u)),Math.abs(u)<.99999?(this.y=Math.atan2(h,y),this.z=Math.atan2(o,a)):(this.y=Math.atan2(-c,n),this.z=0)):"ZXY"===i?(this.x=Math.asin(e(l)),Math.abs(l)<.99999?(this.y=Math.atan2(-c,y),this.z=Math.atan2(-r,a)):(this.y=0,this.z=Math.atan2(o,n))):"ZYX"===i?(this.y=Math.asin(-e(c)),Math.abs(c)<.99999?(this.x=Math.atan2(l,y),this.z=Math.atan2(o,n)):(this.x=0,this.z=Math.atan2(-r,a))):"YZX"===i?(this.z=Math.asin(e(o)),Math.abs(o)<.99999?(this.x=Math.atan2(-u,a),this.y=Math.atan2(-c,n)):(this.x=0,this.y=Math.atan2(h,y))):"XZY"===i&&(this.z=Math.asin(-e(r)),Math.abs(r)<.99999?(this.x=Math.atan2(l,a),this.y=Math.atan2(h,n)):(this.x=Math.atan2(-u,y),this.y=0)),this},setEulerFromQuaternion:function(t,i){function e(t){return Math.min(Math.max(t,-1),1)}var s=t.x*t.x,n=t.y*t.y,r=t.z*t.z,h=t.w*t.w;return void 0===i||"XYZ"===i?(this.x=Math.atan2(2*(t.x*t.w-t.y*t.z),h-s-n+r),this.y=Math.asin(e(2*(t.x*t.z+t.y*t.w))),this.z=Math.atan2(2*(t.z*t.w-t.x*t.y),h+s-n-r)):"YXZ"===i?(this.x=Math.asin(e(2*(t.x*t.w-t.y*t.z))),this.y=Math.atan2(2*(t.x*t.z+t.y*t.w),h-s-n+r),this.z=Math.atan2(2*(t.x*t.y+t.z*t.w),h-s+n-r)):"ZXY"===i?(this.x=Math.asin(e(2*(t.x*t.w+t.y*t.z))),this.y=Math.atan2(2*(t.y*t.w-t.z*t.x),h-s-n+r),this.z=Math.atan2(2*(t.z*t.w-t.x*t.y),h-s+n-r)):"ZYX"===i?(this.x=Math.atan2(2*(t.x*t.w+t.z*t.y),h-s-n+r),this.y=Math.asin(e(2*(t.y*t.w-t.x*t.z))),this.z=Math.atan2(2*(t.x*t.y+t.z*t.w),h+s-n-r)):"YZX"===i?(this.x=Math.atan2(2*(t.x*t.w-t.z*t.y),h-s+n-r),this.y=Math.atan2(2*(t.y*t.w-t.x*t.z),h+s-n-r),this.z=Math.asin(e(2*(t.x*t.y+t.z*t.w)))):"XZY"===i&&(this.x=Math.atan2(2*(t.x*t.w+t.y*t.z),h-s+n-r),this.y=Math.atan2(2*(t.x*t.z+t.y*t.w),h+s-n-r),this.z=Math.asin(e(2*(t.z*t.w-t.x*t.y)))),this},getScaleFromMatrix:function(t){var i=this.set(t.elements[0],t.elements[1],t.elements[2]).length(),e=this.set(t.elements[4],t.elements[5],t.elements[6]).length(),s=this.set(t.elements[8],t.elements[9],t.elements[10]).length();return this.x=i,this.y=e,this.z=s,this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},toArray:function(){return[this.x,this.y,this.z]},clone:function(){return new t.Vector3(this.x,this.y,this.z)},isNaN:function(){return!(isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z))}},t.Vector4=function(t,i,e,s){this.x=t||0,this.y=i||0,this.z=e||0,this.w=void 0!==s?s:1},t.Vector4.prototype={constructor:t.Vector4,set:function(t,i,e,s){return this.x=t,this.y=i,this.z=e,this.w=s,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,i){return void 0!==i?(console.warn("DEPRECATED: Vector4's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this.w=t.w+i.w,this},sub:function(t,i){return void 0!==i?(console.warn("DEPRECATED: Vector4's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this.w=t.w-i.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){if(!t)return this;var i=this.x,e=this.y,s=this.z,n=this.w,r=t.elements;return this.x=r[0]*i+r[4]*e+r[8]*s+r[12]*n,this.y=r[1]*i+r[5]*e+r[9]*s+r[13]*n,this.z=r[2]*i+r[6]*e+r[10]*s+r[14]*n,this.w=r[3]*i+r[7]*e+r[11]*s+r[15]*n,this},divideScalar:function(t){return 0!==t?(this.x/=t,this.y/=t,this.z/=t,this.w/=t):(this.x=0,this.y=0,this.z=0,this.w=1),this},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var i=Math.sqrt(1-t.w*t.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/i,this.y=t.y/i,this.z=t.z/i),this},setAxisAngleFromRotationMatrix:function(t){var i,e,s,n,r=t.elements,h=r[0],o=r[4],a=r[8],u=r[1],c=r[5],l=r[9],y=r[2],f=r[6],x=r[10];if(Math.abs(o-u)<.01&&Math.abs(a-y)<.01&&Math.abs(l-f)<.01){if(Math.abs(o+u)<.1&&Math.abs(a+y)<.1&&Math.abs(l+f)<.1&&Math.abs(h+c+x-3)<.1)return this.set(1,0,0,0),this;i=Math.PI;var p=(h+1)/2,m=(c+1)/2,g=(x+1)/2,d=(o+u)/4,v=(a+y)/4,w=(l+f)/4;return p>m&&p>g?p<.01?(e=0,s=.707106781,n=.707106781):(s=d/(e=Math.sqrt(p)),n=v/e):m>g?m<.01?(e=.707106781,s=0,n=.707106781):(e=d/(s=Math.sqrt(m)),n=w/s):g<.01?(e=.707106781,s=.707106781,n=0):(e=v/(n=Math.sqrt(g)),s=w/n),this.set(e,s,n,i),this}var z=Math.sqrt((f-l)*(f-l)+(a-y)*(a-y)+(u-o)*(u-o));return Math.abs(z)<.001&&(z=1),this.x=(f-l)/z,this.y=(a-y)/z,this.z=(u-o)/z,this.w=Math.acos((h+c+x-1)/2),this},getColumnFromMatrix:function(t,i){var e=4*t,s=i.elements;return this.x=s[e],this.y=s[e+1],this.z=s[e+2],this.w=1,this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this.z>t.z&&(this.z=t.z),this.w>t.w&&(this.w=t.w),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this.z<t.z&&(this.z=t.z),this.w<t.w&&(this.w=t.w),this},clamp:function(t,i){return this.x<t.x?this.x=t.x:this.x>i.x&&(this.x=i.x),this.y<t.y?this.y=t.y:this.y>i.y&&(this.y=i.y),this.z<t.z?this.z=t.z:this.z>i.z&&(this.z=i.z),this.w<t.w?this.w=t.w:this.w>i.w&&(this.w=i.w),this},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t,i){return Math.sqrt(this.distanceToSquared(t,i))},distanceToSquared:function(t,i){var e=this.x-t.x,s=this.y-t.y,n=this.z-t.z,r=e*e+s*s+n*n;return i&&(r+=this.w-t.w),r},setLength:function(t){var i=this.length();return 0!==i&&t!==i&&this.multiplyScalar(t/i),this},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this.w+=(t.w-this.w)*i,this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new t.Vector4(this.x,this.y,this.z,this.w)}},t.Matrix3=function(t,i,e,s,n,r,h,o,a){this.elements=new Float32Array(9),this.set(void 0!==t?t:1,i||0,e||0,s||0,void 0!==n?n:1,r||0,h||0,o||0,void 0!==a?a:1)},t.Matrix3.prototype={constructor:t.Matrix3,set:function(t,i,e,s,n,r,h,o,a){var u=this.elements;return u[0]=t,u[3]=i,u[6]=e,u[1]=s,u[4]=n,u[7]=r,u[2]=h,u[5]=o,u[8]=a,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},isIdentity:function(){var t=this.elements;return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&1===t[4]&&0===t[5]&&0===t[6]&&0===t[7]&&1===t[8]},copy:function(t){var i=t.elements;return this.set(i[0],i[3],i[6],i[1],i[4],i[7],i[2],i[5],i[8]),this},multiplyVector3:function(t){return console.warn("DEPRECATED: Matrix3's .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){var i=new t.Vector3;return function(t){for(var e=0,s=t.length;e<s;e+=3)i.x=t[e],i.y=t[e+1],i.z=t[e+2],i.applyMatrix3(this),t[e]=i.x,t[e+1]=i.y,t[e+2]=i.z;return t}}(),multiplyScalar:function(t){var i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=t,i[4]*=t,i[7]*=t,i[2]*=t,i[5]*=t,i[8]*=t,this},multiplyMatrices:function(t,i){if(!i)return this.copy(t),this;var e=t.elements,s=i.elements,n=this.elements,r=e[0],h=e[3],o=e[6],a=e[1],u=e[4],c=e[7],l=e[2],y=e[5],f=e[8],x=s[0],p=s[3],m=s[6],g=s[1],d=s[4],v=s[7],w=s[2],z=s[5],M=s[8];return n[0]=r*x+h*g+o*w,n[3]=r*p+h*d+o*z,n[6]=r*m+h*v+o*M,n[1]=a*x+u*g+c*w,n[4]=a*p+u*d+c*z,n[7]=a*m+u*v+c*M,n[2]=l*x+y*g+f*w,n[5]=l*p+y*d+f*z,n[8]=l*m+y*v+f*M,this},determinant:function(){var t=this.elements,i=t[0],e=t[1],s=t[2],n=t[3],r=t[4],h=t[5],o=t[6],a=t[7],u=t[8];return i*r*u-i*h*a-e*n*u+e*h*o+s*n*a-s*r*o},getInverse:function(t,i){var e=t.elements,s=this.elements;s[0]=e[10]*e[5]-e[6]*e[9],s[1]=-e[10]*e[1]+e[2]*e[9],s[2]=e[6]*e[1]-e[2]*e[5],s[3]=-e[10]*e[4]+e[6]*e[8],s[4]=e[10]*e[0]-e[2]*e[8],s[5]=-e[6]*e[0]+e[2]*e[4],s[6]=e[9]*e[4]-e[5]*e[8],s[7]=-e[9]*e[0]+e[1]*e[8],s[8]=e[5]*e[0]-e[1]*e[4];var n=e[0]*s[0]+e[1]*s[3]+e[2]*s[6];if(0===n){var r="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(i)throw new Error(r);return console.warn(r),this.identity(),this}return this.multiplyScalar(1/n),this},transpose:function(){var t,i=this.elements;return t=i[1],i[1]=i[3],i[3]=t,t=i[2],i[2]=i[6],i[6]=t,t=i[5],i[5]=i[7],i[7]=t,this},getNormalMatrix:function(t){return this.getInverse(t).transpose(),this},transposeIntoArray:function(t){var i=this.elements;return t[0]=i[0],t[1]=i[3],t[2]=i[6],t[3]=i[1],t[4]=i[4],t[5]=i[7],t[6]=i[2],t[7]=i[5],t[8]=i[8],this},clone:function(){var i=this.elements;return new t.Matrix3(i[0],i[3],i[6],i[1],i[4],i[7],i[2],i[5],i[8])},flattenToArray:function(t){var i=this.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t},scale:function(t){var i=this.elements,e=t.x,s=t.y;return i[0]*=e,i[3]*=s,i[1]*=e,i[4]*=s,i[2]*=e,i[5]*=s,this},getMatrix4:function(){var t=this.elements;return new Matrix4(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1)}},t._Float32Matrix4=function(t,i,e,s,n,r,h,o,a,u,c,l,y,f,x,p){this.elements=new Float32Array(16)},t._Float32Matrix4.prototype={constructor:t._Float32Matrix4,set:function(t,i,e,s,n,r,h,o,a,u,c,l,y,f,x,p){var m=this.elements;return m[0]=t,m[4]=i,m[8]=e,m[12]=s,m[1]=n,m[5]=r,m[9]=h,m[13]=o,m[2]=a,m[6]=u,m[10]=c,m[14]=l,m[3]=y,m[7]=f,m[11]=x,m[15]=p,this},_fromMatrix4WithLowPartTranslation(t){this.elements.set(t.elements);var i=t.getLowPartTranslation();return this.elements[3]=i.x,this.elements[7]=i.y,this.elements[11]=i.z,this},isIdentity:function(){var t=this.elements;return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]},_multiplyMatricesMV:function(t,i){var e=t.elements,s=i.elements,n=this.elements,r=e[0],h=e[4],o=e[8],a=e[12],u=e[1],c=e[5],l=e[9],y=e[13],f=e[2],x=e[6],p=e[10],m=e[14],g=s[0],d=s[4],v=s[8],w=s[12],z=s[1],M=s[5],b=s[9],P=s[13],E=s[2],A=s[6],S=s[10],T=s[14];return n[0]=r*g+h*z+o*E,n[4]=r*d+h*M+o*A,n[8]=r*v+h*b+o*S,n[12]=r*w+h*P+o*T+a,n[1]=u*g+c*z+l*E,n[5]=u*d+c*M+l*A,n[9]=u*v+c*b+l*S,n[13]=u*w+c*P+l*T+y,n[2]=f*g+x*z+p*E,n[6]=f*d+x*M+p*A,n[10]=f*v+x*b+p*S,n[14]=f*w+x*P+p*T+m,n[3]=0,n[7]=0,n[11]=0,n[15]=1,this},multiplyMatricesAndInverse:function(i,e){var s=(new t.Matrix4).multiplyMatrices(i,e);return this.getInverse(s)},transpose:function(){var t,i=this.elements;return t=i[1],i[1]=i[4],i[4]=t,t=i[2],i[2]=i[8],i[8]=t,t=i[6],i[6]=i[9],i[9]=t,t=i[3],i[3]=i[12],i[12]=t,t=i[7],i[7]=i[13],i[13]=t,t=i[11],i[11]=i[14],i[14]=t,this},getInverse:function(t,i){var e=this.elements,s=t.elements,n=s[0],r=s[4],h=s[8],o=s[12],a=s[1],u=s[5],c=s[9],l=s[13],y=s[2],f=s[6],x=s[10],p=s[14],m=s[3],g=s[7],d=s[11],v=s[15];e[0]=c*p*g-l*x*g+l*f*d-u*p*d-c*f*v+u*x*v,e[4]=o*x*g-h*p*g-o*f*d+r*p*d+h*f*v-r*x*v,e[8]=h*l*g-o*c*g+o*u*d-r*l*d-h*u*v+r*c*v,e[12]=o*c*f-h*l*f-o*u*x+r*l*x+h*u*p-r*c*p,e[1]=l*x*m-c*p*m-l*y*d+a*p*d+c*y*v-a*x*v,e[5]=h*p*m-o*x*m+o*y*d-n*p*d-h*y*v+n*x*v,e[9]=o*c*m-h*l*m-o*a*d+n*l*d+h*a*v-n*c*v,e[13]=h*l*y-o*c*y+o*a*x-n*l*x-h*a*p+n*c*p,e[2]=u*p*m-l*f*m+l*y*g-a*p*g-u*y*v+a*f*v,e[6]=o*f*m-r*p*m-o*y*g+n*p*g+r*y*v-n*f*v,e[10]=r*l*m-o*u*m+o*a*g-n*l*g-r*a*v+n*u*v,e[14]=o*u*y-r*l*y-o*a*f+n*l*f+r*a*p-n*u*p,e[3]=c*f*m-u*x*m-c*y*g+a*x*g+u*y*d-a*f*d,e[7]=r*x*m-h*f*m+h*y*g-n*x*g-r*y*d+n*f*d,e[11]=h*u*m-r*c*m-h*a*g+n*c*g+r*a*d-n*u*d,e[15]=r*c*y-h*u*y+h*a*f-n*c*f-r*a*x+n*u*x;var w=s[0]*e[0]+s[1]*e[4]+s[2]*e[8]+s[3]*e[12];if(0==w){var z="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(i)throw new Error(z);return console.warn(z),this.identity(),this}return this.multiplyScalar(1/w),this},multiplyScalar:function(t){var i=this.elements;return i[0]*=t,i[4]*=t,i[8]*=t,i[12]*=t,i[1]*=t,i[5]*=t,i[9]*=t,i[13]*=t,i[2]*=t,i[6]*=t,i[10]*=t,i[14]*=t,i[3]*=t,i[7]*=t,i[11]*=t,i[15]*=t,this}};var u=new Float32Array(1);t.SplitFloat32=function(t){u[0]=t;var i=u[0];return{low:t-i,high:i}},t._SplitFloat32PositiveError=function(t){u[0]=t;var i=u[0],e=t-i;return e<0&&(i-=2*(e=-e)),{low:e,high:i}};var c,l,y,f,x,p;return t.Matrix4=function(t,i,e,s,n,r,h,o,a,u,c,l,y,f,x,p){this.elements=void 0!==t?[t,n,a,y,i,r,u,f,e,h,c,x,s,o,l,p]:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},t.Matrix4.prototype={constructor:t.Matrix4,getLowPartTranslation:function(){var i=t.SplitFloat32(this.elements[12]),e=t.SplitFloat32(this.elements[13]),s=t.SplitFloat32(this.elements[14]),n=new t.Vector3;return n.x=i.low,n.y=e.low,n.z=s.low,n},set:function(t,i,e,s,n,r,h,o,a,u,c,l,y,f,x,p){var m=this.elements;return m[0]=t,m[4]=i,m[8]=e,m[12]=s,m[1]=n,m[5]=r,m[9]=h,m[13]=o,m[2]=a,m[6]=u,m[10]=c,m[14]=l,m[3]=y,m[7]=f,m[11]=x,m[15]=p,this},getValue:function(t,i){return this.elements[4*(i-1)+t-1]},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},isIdentity:function(){var t=this.elements;return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]},copy:function(t){var i=t.elements;return this.set(i[0],i[4],i[8],i[12],i[1],i[5],i[9],i[13],i[2],i[6],i[10],i[14],i[3],i[7],i[11],i[15]),this},createJSON:function(){if(this.isIdentity())return"identity";var t,i=[],e=this.elements;if(1===e[0]&&0===e[1]&&0===e[2]&&0===e[3]&&0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]&&0===e[8]&&0===e[9]&&1===e[10]&&0===e[11]&&1===e[15])i.push(e[12]),i.push(e[13]),i.push(e[14]);else for(t=0;t<16;t++)i.push(this.elements[t]);return i},setFromJSON:function(t){if("identity"===t)this.identity();else if(3===t.length)this.identity(),this.elements[12]=t[0],this.elements[13]=t[1],this.elements[14]=t[2];else{var i;for(i=0;i<16;i++)this.elements[i]=t[i]}return this},setRotationFromEuler:function(t,i){var e=this.elements,s=t.x,n=t.y,r=t.z,h=Math.cos(s),o=Math.sin(s),a=Math.cos(n),u=Math.sin(n),c=Math.cos(r),l=Math.sin(r);if(void 0===i||"XYZ"===i){var y=h*c,f=h*l,x=o*c,p=o*l;e[0]=a*c,e[4]=-a*l,e[8]=u,e[1]=f+x*u,e[5]=y-p*u,e[9]=-o*a,e[2]=p-y*u,e[6]=x+f*u,e[10]=h*a}else if("YXZ"===i){var m=a*c,g=a*l,d=u*c,v=u*l;e[0]=m+v*o,e[4]=d*o-g,e[8]=h*u,e[1]=h*l,e[5]=h*c,e[9]=-o,e[2]=g*o-d,e[6]=v+m*o,e[10]=h*a}else if("ZXY"===i){m=a*c,g=a*l,d=u*c,v=u*l;e[0]=m-v*o,e[4]=-h*l,e[8]=d+g*o,e[1]=g+d*o,e[5]=h*c,e[9]=v-m*o,e[2]=-h*u,e[6]=o,e[10]=h*a}else if("ZYX"===i){y=h*c,f=h*l,x=o*c,p=o*l;e[0]=a*c,e[4]=x*u-f,e[8]=y*u+p,e[1]=a*l,e[5]=p*u+y,e[9]=f*u-x,e[2]=-u,e[6]=o*a,e[10]=h*a}else if("YZX"===i){var w=h*a,z=h*u,M=o*a,b=o*u;e[0]=a*c,e[4]=b-w*l,e[8]=M*l+z,e[1]=l,e[5]=h*c,e[9]=-o*c,e[2]=-u*c,e[6]=z*l+M,e[10]=w-b*l}else if("XZY"===i){w=h*a,z=h*u,M=o*a,b=o*u;e[0]=a*c,e[4]=-l,e[8]=u*c,e[1]=w*l+b,e[5]=h*c,e[9]=z*l-M,e[2]=M*l-z,e[6]=o*c,e[10]=b*l+w}return this},setRotationFromQuaternion:function(t){var i=this.elements,e=t.x,s=t.y,n=t.z,r=t.w,h=e+e,o=s+s,a=n+n,u=e*h,c=e*o,l=e*a,y=s*o,f=s*a,x=n*a,p=r*h,m=r*o,g=r*a;return i[0]=1-(y+x),i[4]=c-g,i[8]=l+m,i[1]=c+g,i[5]=1-(u+x),i[9]=f-p,i[2]=l-m,i[6]=f+p,i[10]=1-(u+y),this},makeRotationFromQuaternion:function(t){var i=this.elements,e=t.x,s=t.y,n=t.z,r=t.w,h=e+e,o=s+s,a=n+n,u=e*h,c=e*o,l=e*a,y=s*o,f=s*a,x=n*a,p=r*h,m=r*o,g=r*a;return i[0]=1-(y+x),i[4]=c-g,i[8]=l+m,i[1]=c+g,i[5]=1-(u+x),i[9]=f-p,i[2]=l-m,i[6]=f+p,i[10]=1-(u+y),i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this},lookAt:(c=new t.Vector3,l=new t.Vector3,y=new t.Vector3,function(t,i,e){var s=this.elements;return y.subVectors(t,i).normalize(),0===y.length()&&(y.z=1),c.crossVectors(e,y).normalize(),0===c.length()&&(y.x+=1e-4,c.crossVectors(e,y).normalize()),l.crossVectors(y,c),s[0]=c.x,s[4]=l.x,s[8]=y.x,s[1]=c.y,s[5]=l.y,s[9]=y.y,s[2]=c.z,s[6]=l.z,s[10]=y.z,this}),multiply:function(t,i){return void 0!==i?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,i)):this.multiplyMatrices(this,t)},multiplyMatrices:function(t,i){if(!i)return this.copy(t),this;var e=t.elements,s=i.elements,n=this.elements,r=e[0],h=e[4],o=e[8],a=e[12],u=e[1],c=e[5],l=e[9],y=e[13],f=e[2],x=e[6],p=e[10],m=e[14],g=e[3],d=e[7],v=e[11],w=e[15],z=s[0],M=s[4],b=s[8],P=s[12],E=s[1],A=s[5],S=s[9],T=s[13],_=s[2],I=s[6],V=s[10],O=s[14],C=s[3],R=s[7],D=s[11],N=s[15];return n[0]=r*z+h*E+o*_+a*C,n[4]=r*M+h*A+o*I+a*R,n[8]=r*b+h*S+o*V+a*D,n[12]=r*P+h*T+o*O+a*N,n[1]=u*z+c*E+l*_+y*C,n[5]=u*M+c*A+l*I+y*R,n[9]=u*b+c*S+l*V+y*D,n[13]=u*P+c*T+l*O+y*N,n[2]=f*z+x*E+p*_+m*C,n[6]=f*M+x*A+p*I+m*R,n[10]=f*b+x*S+p*V+m*D,n[14]=f*P+x*T+p*O+m*N,n[3]=g*z+d*E+v*_+w*C,n[7]=g*M+d*A+v*I+w*R,n[11]=g*b+d*S+v*V+w*D,n[15]=g*P+d*T+v*O+w*N,this},multiplyToArray:function(t,i,e){var s=this.elements;return this.multiplyMatrices(t,i),e[0]=s[0],e[1]=s[1],e[2]=s[2],e[3]=s[3],e[4]=s[4],e[5]=s[5],e[6]=s[6],e[7]=s[7],e[8]=s[8],e[9]=s[9],e[10]=s[10],e[11]=s[11],e[12]=s[12],e[13]=s[13],e[14]=s[14],e[15]=s[15],this},multiplyScalar:function(t){var i=this.elements;return i[0]*=t,i[4]*=t,i[8]*=t,i[12]*=t,i[1]*=t,i[5]*=t,i[9]*=t,i[13]*=t,i[2]*=t,i[6]*=t,i[10]*=t,i[14]*=t,i[3]*=t,i[7]*=t,i[11]*=t,i[15]*=t,this},multiplyVector3:function(t){return console.warn("DEPRECATED: Matrix4's .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),t.applyProjection(this)},multiplyVector4:function(t){return console.warn("DEPRECATED: Matrix4's .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){var i=new t.Vector3;return function(t){for(var e=0,s=t.length;e<s;e+=3)i.x=t[e],i.y=t[e+1],i.z=t[e+2],i.applyProjection(this),t[e]=i.x,t[e+1]=i.y,t[e+2]=i.z;return t}}(),rotateAxis:function(t){console.warn("DEPRECATED: Matrix4's .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(i){var e=this.elements,s=new t.Vector4;return s.x=e[0]*i.x+e[4]*i.y+e[8]*i.z+e[12]*i.w,s.y=e[1]*i.x+e[5]*i.y+e[9]*i.z+e[13]*i.w,s.z=e[2]*i.x+e[6]*i.y+e[10]*i.z+e[14]*i.w,s.w=i.w?e[3]*i.x+e[7]*i.y+e[11]*i.z+e[15]*i.w:1,s},determinant:function(){var t=this.elements,i=t[0],e=t[4],s=t[8],n=t[12],r=t[1],h=t[5],o=t[9],a=t[13],u=t[2],c=t[6],l=t[10],y=t[14];return t[3]*(+n*o*c-s*a*c-n*h*l+e*a*l+s*h*y-e*o*y)+t[7]*(+i*o*y-i*a*l+n*r*l-s*r*y+s*a*u-n*o*u)+t[11]*(+i*a*c-i*h*y-n*r*c+e*r*y+n*h*u-e*a*u)+t[15]*(-s*h*u-i*o*c+i*h*l+s*r*c-e*r*l+e*o*u)},transpose:function(){var t,i=this.elements;return t=i[1],i[1]=i[4],i[4]=t,t=i[2],i[2]=i[8],i[8]=t,t=i[6],i[6]=i[9],i[9]=t,t=i[3],i[3]=i[12],i[12]=t,t=i[7],i[7]=i[13],i[13]=t,t=i[11],i[11]=i[14],i[14]=t,this},flattenToArray:function(t){var i=this.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],t},setFromArray:function(t){var i=this.elements;return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],this},flattenToArrayOffset:function(t,i){var e=this.elements;return t[i]=e[0],t[i+1]=e[1],t[i+2]=e[2],t[i+3]=e[3],t[i+4]=e[4],t[i+5]=e[5],t[i+6]=e[6],t[i+7]=e[7],t[i+8]=e[8],t[i+9]=e[9],t[i+10]=e[10],t[i+11]=e[11],t[i+12]=e[12],t[i+13]=e[13],t[i+14]=e[14],t[i+15]=e[15],t},getPosition:function(){var i=new t.Vector3;return function(){console.warn("DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.getPositionFromMatrix( matrix ) instead.");var t=this.elements;return i.set(t[12],t[13],t[14])}}(),setPosition:function(t){var i=this.elements;return i[12]=t.x,i[13]=t.y,i[14]=t.z,this},getInverse:function(t,i){var e=this.elements,s=t.elements,n=s[0],r=s[4],h=s[8],o=s[12],a=s[1],u=s[5],c=s[9],l=s[13],y=s[2],f=s[6],x=s[10],p=s[14],m=s[3],g=s[7],d=s[11],v=s[15];e[0]=c*p*g-l*x*g+l*f*d-u*p*d-c*f*v+u*x*v,e[4]=o*x*g-h*p*g-o*f*d+r*p*d+h*f*v-r*x*v,e[8]=h*l*g-o*c*g+o*u*d-r*l*d-h*u*v+r*c*v,e[12]=o*c*f-h*l*f-o*u*x+r*l*x+h*u*p-r*c*p,e[1]=l*x*m-c*p*m-l*y*d+a*p*d+c*y*v-a*x*v,e[5]=h*p*m-o*x*m+o*y*d-n*p*d-h*y*v+n*x*v,e[9]=o*c*m-h*l*m-o*a*d+n*l*d+h*a*v-n*c*v,e[13]=h*l*y-o*c*y+o*a*x-n*l*x-h*a*p+n*c*p,e[2]=u*p*m-l*f*m+l*y*g-a*p*g-u*y*v+a*f*v,e[6]=o*f*m-r*p*m-o*y*g+n*p*g+r*y*v-n*f*v,e[10]=r*l*m-o*u*m+o*a*g-n*l*g-r*a*v+n*u*v,e[14]=o*u*y-r*l*y-o*a*f+n*l*f+r*a*p-n*u*p,e[3]=c*f*m-u*x*m-c*y*g+a*x*g+u*y*d-a*f*d,e[7]=r*x*m-h*f*m+h*y*g-n*x*g-r*y*d+n*f*d,e[11]=h*u*m-r*c*m-h*a*g+n*c*g+r*a*d-n*u*d,e[15]=r*c*y-h*u*y+h*a*f-n*c*f-r*a*x+n*u*x;var w=s[0]*e[0]+s[1]*e[4]+s[2]*e[8]+s[3]*e[12];if(0==w){var z="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(i)throw new Error(z);return console.warn(z),this.identity(),this}return this.multiplyScalar(1/w),this},extractBasis:function(t,i,e){var s=this.elements;return t.set(s[0],s[1],s[2]),i.set(s[4],s[5],s[6]),e.set(s[8],s[9],s[10]),this},makeBasis:function(t,i,e){return this.set(t.x,i.x,e.x,0,t.y,i.y,e.y,0,t.z,i.z,e.z,0,0,0,0,1),this},extractPosition:function(t){var i=this.elements,e=t.elements;return i[12]=e[12],i[13]=e[13],i[14]=e[14],this},extractRotation:function(i){var e=new t.Vector3;return function(t){var i=this.elements,s=t.elements,n=1/e.set(s[0],s[1],s[2]).length(),r=1/e.set(s[4],s[5],s[6]).length(),h=1/e.set(s[8],s[9],s[10]).length();return i[0]=s[0]*n,i[1]=s[1]*n,i[2]=s[2]*n,i[4]=s[4]*r,i[5]=s[5]*r,i[6]=s[6]*r,i[8]=s[8]*h,i[9]=s[9]*h,i[10]=s[10]*h,this}}(),extractMatrix3:function(i){new t.Vector3;return function(t){var i=this.elements,e=t.elements;return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[8]=e[8],i[9]=e[9],i[10]=e[10],this}}(),translate:function(t){var i=this.elements,e=t.x,s=t.y,n=t.z;return i[12]=i[0]*e+i[4]*s+i[8]*n+i[12],i[13]=i[1]*e+i[5]*s+i[9]*n+i[13],i[14]=i[2]*e+i[6]*s+i[10]*n+i[14],i[15]=i[3]*e+i[7]*s+i[11]*n+i[15],this},rotateX:function(t){var i=this.elements,e=i[4],s=i[5],n=i[6],r=i[7],h=i[8],o=i[9],a=i[10],u=i[11],c=Math.cos(t),l=Math.sin(t);return i[4]=c*e+l*h,i[5]=c*s+l*o,i[6]=c*n+l*a,i[7]=c*r+l*u,i[8]=c*h-l*e,i[9]=c*o-l*s,i[10]=c*a-l*n,i[11]=c*u-l*r,this},rotateY:function(t){var i=this.elements,e=i[0],s=i[1],n=i[2],r=i[3],h=i[8],o=i[9],a=i[10],u=i[11],c=Math.cos(t),l=Math.sin(t);return i[0]=c*e-l*h,i[1]=c*s-l*o,i[2]=c*n-l*a,i[3]=c*r-l*u,i[8]=c*h+l*e,i[9]=c*o+l*s,i[10]=c*a+l*n,i[11]=c*u+l*r,this},rotateZ:function(t){var i=this.elements,e=i[0],s=i[1],n=i[2],r=i[3],h=i[4],o=i[5],a=i[6],u=i[7],c=Math.cos(t),l=Math.sin(t);return i[0]=c*e+l*h,i[1]=c*s+l*o,i[2]=c*n+l*a,i[3]=c*r+l*u,i[4]=c*h-l*e,i[5]=c*o-l*s,i[6]=c*a-l*n,i[7]=c*u-l*r,this},rotateByAxis:function(t,i){var e=this.elements;if(1===t.x&&0===t.y&&0===t.z)return this.rotateX(i);if(0===t.x&&1===t.y&&0===t.z)return this.rotateY(i);if(0===t.x&&0===t.y&&1===t.z)return this.rotateZ(i);var s=t.x,n=t.y,r=t.z,h=Math.sqrt(s*s+n*n+r*r),o=(s/=h)*s,a=(n/=h)*n,u=(r/=h)*r,c=Math.cos(i),l=Math.sin(i),y=1-c,f=s*n*y,x=s*r*y,p=n*r*y,m=s*l,g=n*l,d=r*l,v=o+(1-o)*c,w=f+d,z=x-g,M=f-d,b=a+(1-a)*c,P=p+m,E=x+g,A=p-m,S=u+(1-u)*c,T=e[0],_=e[1],I=e[2],V=e[3],O=e[4],C=e[5],R=e[6],D=e[7],N=e[8],L=e[9],F=e[10],k=e[11];return e[0]=v*T+w*O+z*N,e[1]=v*_+w*C+z*L,e[2]=v*I+w*R+z*F,e[3]=v*V+w*D+z*k,e[4]=M*T+b*O+P*N,e[5]=M*_+b*C+P*L,e[6]=M*I+b*R+P*F,e[7]=M*V+b*D+P*k,e[8]=E*T+A*O+S*N,e[9]=E*_+A*C+S*L,e[10]=E*I+A*R+S*F,e[11]=E*V+A*D+S*k,this},scale:function(t){var i=this.elements,e=t.x,s=t.y,n=t.z;return i[0]*=e,i[4]*=s,i[8]*=n,i[1]*=e,i[5]*=s,i[9]*=n,i[2]*=e,i[6]*=s,i[10]*=n,i[3]*=e,i[7]*=s,i[11]*=n,this},getMaxScaleOnAxis:function(){var t=this.elements,i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],e=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],s=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(i,Math.max(e,s)))},getScaleOnAxisX:function(){var t=this.elements,i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];return Math.sqrt(i)},getScaleOnAxisY:function(){var t=this.elements,i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6];return Math.sqrt(i)},getScaleOnAxisZ:function(){var t=this.elements,i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(i)},makeTranslation:function(t,i,e){return this.set(1,0,0,t,0,1,0,i,0,0,1,e,0,0,0,1),this},makeRotationX:function(t){var i=Math.cos(t),e=Math.sin(t);return this.set(1,0,0,0,0,i,-e,0,0,e,i,0,0,0,0,1),this},makeRotationY:function(t){var i=Math.cos(t),e=Math.sin(t);return this.set(i,0,e,0,0,1,0,0,-e,0,i,0,0,0,0,1),this},makeRotationZ:function(t){var i=Math.cos(t),e=Math.sin(t);return this.set(i,-e,0,0,e,i,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,i){var e=Math.cos(i),s=Math.sin(i),n=1-e,r=t.x,h=t.y,o=t.z,a=n*r,u=n*h;return this.set(a*r+e,a*h-s*o,a*o+s*h,0,a*h+s*o,u*h+e,u*o-s*r,0,a*o-s*h,u*o+s*r,n*o*o+e,0,0,0,0,1),this},makeScale:function(t,i,e){return this.set(t,0,0,0,0,i,0,0,0,0,e,0,0,0,0,1),this},makeFrustum:function(t,i,e,s,n,r){var h=this.elements,o=2*n/(i-t),a=2*n/(s-e),u=(i+t)/(i-t),c=(s+e)/(s-e),l=-(r+n)/(r-n),y=-2*r*n/(r-n);return h[0]=o,h[4]=0,h[8]=u,h[12]=0,h[1]=0,h[5]=a,h[9]=c,h[13]=0,h[2]=0,h[6]=0,h[10]=l,h[14]=y,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this},makePerspective:function(i,e,s,n,r,h){var o=s*Math.tan(t.Math.degToRad(.5*i)),a=-o,u=a*e,c=o*e;return r&&(u+=r*=Math.abs(c-u),c+=r),h&&(a+=h*=Math.abs(o-a),o+=h),this.makeFrustum(u,c,a,o,s,n)},makeOrthographic:function(t,i,e,s,n,r){var h=this.elements,o=i-t,a=e-s,u=r-n,c=(i+t)/o,l=(e+s)/a,y=(r+n)/u;return h[0]=2/o,h[4]=0,h[8]=0,h[12]=-c,h[1]=0,h[5]=2/a,h[9]=0,h[13]=-l,h[2]=0,h[6]=0,h[10]=-2/u,h[14]=-y,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this},clone:function(){var i=this.elements;return new t.Matrix4(i[0],i[4],i[8],i[12],i[1],i[5],i[9],i[13],i[2],i[6],i[10],i[14],i[3],i[7],i[11],i[15])},setRotation:function(t){var i=this.elements;return i[0]=t[0],i[4]=t[1],i[8]=t[2],i[1]=t[3],i[5]=t[4],i[9]=t[5],i[2]=t[6],i[6]=t[7],i[10]=t[8],this},equals:function(t,i){var e=this.elements,s=t.elements;if(void 0===i){for(var n=0;n<16;n++)if(e[n]!==s[n])return!1}else for(n=0;n<16;n++)if(Math.abs(e[n]-s[n])>i)return!1;return!0}},t.IdentityMatrix=new t.Matrix4,t.extend(t.Matrix4.prototype,{compose:(f=new t.Matrix4,x=new t.Matrix4,function(t,i,e){var s=this.elements;return f.identity(),f.setRotationFromQuaternion(i),x.makeScale(e.x,e.y,e.z),this.multiplyMatrices(f,x),s[12]=t.x,s[13]=t.y,s[14]=t.z,this}),decompose:function(){var i=new t.Vector3,e=new t.Vector3,s=new t.Vector3,n=new t.Matrix4;return function(r,h,o){var a=this.elements;return i.set(a[0],a[1],a[2]),e.set(a[4],a[5],a[6]),s.set(a[8],a[9],a[10]),r=r instanceof t.Vector3?r:new t.Vector3,h=h instanceof t.Quaternion?h:new t.Quaternion,(o=o instanceof t.Vector3?o:new t.Vector3).x=i.length(),o.y=e.length(),o.z=s.length(),r.x=a[12],r.y=a[13],r.z=a[14],n.copy(this),n.elements[0]/=o.x,n.elements[1]/=o.x,n.elements[2]/=o.x,n.elements[4]/=o.y,n.elements[5]/=o.y,n.elements[6]/=o.y,n.elements[8]/=o.z,n.elements[9]/=o.z,n.elements[10]/=o.z,h.setFromRotationMatrix(n),[r,h,o]}}()}),t.Color=function(t){return void 0!==t&&this.set(t),this},t.Color.prototype={constructor:t.Color,r:1,g:1,b:1,set:function(t){switch(typeof t){case"number":this.setHex(t);break;case"string":this.setStyle(t);break;case"object":if(t.length&&t.length>=3){this.setRGB(t[0],t[1],t[2]);break}this.copy(t)}return this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,i,e){return this.r=t,this.g=i,this.b=e,this},setHSV:function(t,i,e){return console.log("DEPRECATED: Color's .setHSV() will be removed. Use .setHSL( h, s, l ) instead."),this.setHSL(t,i*e/((t=(2-i)*e)<1?t:2-t),t/2)},setHSL:function(t,i,e){if(0===i)this.r=this.g=this.b=e;else{var s=function(t,i,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?t+6*(i-t)*e:e<.5?i:e<2/3?t+6*(i-t)*(2/3-e):t},n=e<=.5?e*(1+i):e+i-e*i,r=2*e-n;this.r=s(r,n,t+1/3),this.g=s(r,n,t),this.b=s(r,n,t-1/3)}return this},setStyle:function(i){if(/^rgb\((\d+),(\d+),(\d+)\)$/i.test(i)){var e=/^rgb\((\d+),(\d+),(\d+)\)$/i.exec(i);return this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,this}if(/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.test(i)){e=/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.exec(i);return this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,this}if(/^\#([0-9a-f]{6})$/i.test(i)){e=/^\#([0-9a-f]{6})$/i.exec(i);return this.setHex(parseInt(e[1],16)),this}if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(i)){e=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(i);return this.setHex(parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3],16)),this}if(/^(\w+)$/i.test(i))return this.setHex(t.ColorKeywords[i]),this},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyToLinear:function(t,i){return i?(this.r=t.r*t.r,this.g=t.g*t.g,this.b=t.b*t.b):(this.r=t.r<.04045?t.r/12.92:Math.pow((t.r+.055)/1.055,2.4),this.g=t.g<.04045?t.g/12.92:Math.pow((t.g+.055)/1.055,2.4),this.b=t.b<.04045?t.b/12.92:Math.pow((t.b+.055)/1.055,2.4)),this},copyGammaToLinear:function(t){return this.r=t.r*t.r,this.g=t.g*t.g,this.b=t.b*t.b,this},copyLinearToGamma:function(t){return this.r=Math.sqrt(t.r),this.g=Math.sqrt(t.g),this.b=Math.sqrt(t.b),this},convertGammaToLinear:function(){var t=this.r,i=this.g,e=this.b;return this.r=t*t,this.g=i*i,this.b=e*e,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:(p={h:0,s:0,l:0},function(){var t,i,e=this.r,s=this.g,n=this.b,r=Math.max(e,s,n),h=Math.min(e,s,n),o=(h+r)/2;if(h===r)t=0,i=0;else{var a=r-h;switch(i=o<=.5?a/(r+h):a/(2-r-h),r){case e:t=(s-n)/a+(s<n?6:0);break;case s:t=(n-e)/a+2;break;case n:t=(e-s)/a+4}t/=6}return p.h=t,p.s=i,p.l=o,p}),getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,i,e){var s=this.getHSL();return s.h+=t,s.s+=i,s.l+=e,this.setHSL(s.h,s.s,s.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,i){return this.r=t.r+i.r,this.g=t.g+i.g,this.b=t.b+i.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},desaturate:function(t){var i=.587*this.g+.299*this.r+.114*this.b,e=Math.min(Math.max(1-t,1e-5),1);return this.r=this.r*e+t*i,this.g=this.g*e+t*i,this.b=this.b*e+t*i,this},saturate:function(t){var i=.587*this.g+.299*this.r+.114*this.b,e=1/Math.min(Math.max(1-t,1e-5),1);return this.r=(this.r-t*i)*e,this.g=(this.g-t*i)*e,this.b=(this.b-t*i)*e,this},alphaBlend:function(t,i){var e=1-(i=Math.min(Math.max(i,0),.99999));return this.r=t.r*i+this.r*e,this.g=t.g*i+this.g*e,this.b=t.b*i+this.b*e,this},negative:function(){return this.r=1-this.r,this.g=1-this.g,this.b=1-this.b,this},lerp:function(t,i){return this.r+=(t.r-this.r)*i,this.g+=(t.g-this.g)*i,this.b+=(t.b-this.b)*i,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},clone:function(){return(new t.Color).setRGB(this.r,this.g,this.b)},toArray:function(){return[this.r,this.g,this.b]}},t.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},t}),define("Mesh/ThreeJS_Base",["DS/Mesh/ThreeJS_Base","DS/DSMigration/DSMigration"],function(t,i){return i.deprecateModule("Mesh/ThreeJS_Base"),t});