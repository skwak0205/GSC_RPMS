define("DS/ModelLoader_mineschedanimation/GEOMSAResult3D",["UWA/Core","UWA/Class"],function(e,t){"use strict";return t.extend({init:function(t){t.canvassetting&&(this.canvassetting=e.extend({locations:{colouring:"by location"},mining:{visibility:"removed",visible:"true"},filling:{visibility:"added",visible:"true"},development:{visibility:"added",visible:"true"},activities:{visible:"true"},stockpiles:{visible:"true"},tags:{visible:"false"}},t.canvassetting,!0),this.initCanvassetting=e.extend({locations:{colouring:"by location"},mining:{visibility:"removed",visible:"true"},filling:{visibility:"added",visible:"true"},development:{visibility:"added",visible:"true"},activities:{visible:"true"},stockpiles:{visible:"true"},tags:{visible:"false"}},t.canvassetting,!0)),this.node=t.node,this.periods=[],t.periods&&t.periods.length&&(this.periods=t.periods),this.currentPeriod=0,this.msaNodes=[]},applyPeriod:function(e){var t=this.currentPeriod;void 0!==e&&(t=e),void 0!==t&&(this.msaNodes.forEach(function(e){e.applyPeriod(t)}),this.currentPeriod=t)},modifyFillingVisibility:function(e){if("added"===e||"removed"===e||"single"===e){this.canvassetting.filling.visible="true";var t=this.canvassetting.filling.visibility,i=t.split(" ");this.canvassetting.filling.visibility=t.replace(i[0],e)}else"false"===e&&(this.canvassetting.filling.visible="false")},modifyMiningVisibility:function(e){if("added"===e||"removed"===e||"single"===e){this.canvassetting.mining.visible="true";var t=this.canvassetting.mining.visibility,i=t.split(" ");this.canvassetting.mining.visibility=t.replace(i[0],e)}else"false"===e&&(this.canvassetting.mining.visible="false")},modifyDvlpVisibility:function(e){if("added"===e||"removed"===e||"single"===e){this.canvassetting.development.visible="true";var t=this.canvassetting.development.visibility,i=t.split(" ");this.canvassetting.development.visibility=t.replace(i[0],e)}else"false"===e&&(this.canvassetting.development.visible="false")},setting:function(e,t){if(void 0!==t&&void 0!==e)switch(t){case"activity":this.canvassetting.activities.visible=e;break;case"stockpile":this.canvassetting.stockpiles.visible=e;break;case"production":this.modifyDvlpVisibility(e),this.modifyFillingVisibility(e),this.modifyMiningVisibility(e);break;default:console.log("This parameter is not implemented")}console.log("init"),console.log(this.initCanvassetting)},restore:function(){this.canvassetting.activities.visible=this.initCanvassetting.activities.visible,this.canvassetting.development.visible=this.initCanvassetting.development.visible,this.canvassetting.filling.visible=this.initCanvassetting.filling.visible,this.canvassetting.mining.visible=this.initCanvassetting.mining.visible,this.canvassetting.stockpiles.visible=this.initCanvassetting.stockpiles.visible,this.canvassetting.tags.visible=this.initCanvassetting.tags.visible,this.canvassetting.development.visibility=this.initCanvassetting.development.visibility,this.canvassetting.filling.visibility=this.initCanvassetting.filling.visibility,this.canvassetting.mining.visibility=this.initCanvassetting.mining.visibility},inWitchSetting:{mining:"mining",filling:"filling",development:"development",activity:"activities",stockpile:"stockpiles"}})}),define("DS/ModelLoader_mineschedanimation/GEOMSAMeshNode",["UWA/Core","UWA/Class","DS/Visualization/ThreeJS_DS","DS/Mesh/Mesh"],function(e,t,i,s){"use strict";return t.extend({init:function(e){this.tag=e.tag,this.visibility=e.visibility,this.overridevisibility=e.overridevisibility,this.result3dNode=e.result3dNode,this.node=e.node,this.result3dNode&&this.result3dNode.msaResult3d&&this.result3dNode.msaResult3d.msaNodes&&this.result3dNode.msaResult3d.msaNodes.push(this),this.color=e.color,this.node.css3DNode&&"stockpile"===this.visibility||(this.period=e.period)},_getVisibility:function(){var e="single";if(this.result3dNode&&this.result3dNode.msaResult3d&&this.result3dNode.msaResult3d.canvassetting&&this.visibility){var t=this.result3dNode.msaResult3d.inWitchSetting[this.visibility];this.result3dNode.msaResult3d.canvassetting[t].visibility&&(e=this.result3dNode.msaResult3d.canvassetting[t].visibility),this.overridevisibility&&(e=this.overridevisibility)}var i={};return i.isAtStart=!this.period||e.includes("at start"),e.includes("added")?i.mode="added":e.includes("removed")?(i.mode="removed",i.isAtStart=!0):i.mode="single",i},_getVisible:function(){var e=!0;if(this.result3dNode&&this.result3dNode.msaResult3d&&this.result3dNode.msaResult3d.canvassetting)if(this.node.css3DNode&&"true"!==this.result3dNode.msaResult3d.canvassetting.tags.visible)e=!1;else if(this.visibility){var t=this.result3dNode.msaResult3d.inWitchSetting[this.visibility];e=void 0===this.result3dNode.msaResult3d.canvassetting[t].visible||"true"===this.result3dNode.msaResult3d.canvassetting[t].visible}return e},_getColors:function(){var e;if(this.color)if(e={"by location":this.color},"mining"!==this.visibility&&"filling"!==this.visibility&&"development"!==this.visibility)e["by period"]=e["by location"];else if(this.result3dNode&&this.result3dNode.msaResult3d&&this.result3dNode.msaResult3d.canvassetting){var t=this.period%12;e["by period"]={a:this.color.a},e["by period"].r=t<3||t>9?255:t>3&&t<9?0:127,e["by period"].g=t<1||t>7?0:t>1&&t<7?255:127,e["by period"].b=t<5||t>11?0:t>5&&t<11?255:127}return e},applyColorSettings:function(){var e=this._getColors();if(e&&e["by period"]&&e["by location"]&&this.result3dNode&&this.result3dNode.msaResult3d&&this.result3dNode.msaResult3d.canvassetting){var t,i=new s.Color(e["by period"].r/255,e["by period"].g/255,e["by period"].b/255,e["by period"].a/255),n=new s.Color(e["by location"].r/255,e["by location"].g/255,e["by location"].b/255,e["by location"].a/255);if(t=this.result3dNode.msaResult3d.canvassetting.locations&&"by period"===this.result3dNode.msaResult3d.canvassetting.locations.colouring?i:n,this.node.css3DNode)this.node.css3DNode.element.style.backgroundColor="rgba("+255*t.r+", "+255*t.g+", "+255*t.b+", 0.5)";else if(this.node.mesh3js){var a=this.node.mesh3js.sceneGraph.children[0];a.getPrimitivesCount()&&(a.getPrimitiveGroup(0).gas.color.r=t.r,a.getPrimitiveGroup(0).gas.color.g=t.g,a.getPrimitiveGroup(0).gas.color.b=t.b)}}},applyPeriod:function(e){var t=!1;if(this._getVisible()){var i=this._getVisibility();this.node.css3DNode?void 0===this.period||"added"===i.mode&&this.period===e||"single"===i.mode&&this.period===e||"removed"===i.mode&&this.period===e+1?(t=!0,this.node.css3DNode.element.style.removeProperty("display")):t=!1:t=0===e?!(!i.isAtStart||this.node.css3DNode):void 0===this.period||"added"===i.mode&&this.period<=e||"single"===i.mode&&this.period===e||"removed"===i.mode&&this.period>e}this.node.setVisibility(t)}})}),define("DS/ModelLoader_mineschedanimation/loader",["UWA/Core","UWA/Utils","DS/WebappsUtils/WebappsUtils","DS/Mesh/Mesh","DS/Visualization/SceneGraphFactory","DS/Visualization/Node3D","DS/Visualization/ThreeJS_DS","DS/WAFData/WAFData","DS/Visualization/Utils","DS/SceneGraphNodes/CSS3DNode","DS/SceneGraphNodes/CSS2DNode","DS/ModelLoader_mineschedanimation/GEOMSAMeshNode","DS/ModelLoader_mineschedanimation/GEOMSAResult3D"],function(e,t,i,s,n,a,r,l,o,d,u,h,c){"use strict";return function(){this.load=function(e,t,i,s){this.scene=new a,this.scene.name="scene";var n=e,r={scene:this.scene,url:n,callbacks:{progress:i,done:s}};this._readMineSchedAnimationFD1(r),t&&t(this.scene)},this._downloadFileFD1=function(e,t){e.provider&&"FILE"===e.provider?l.request(e.filename,{method:"GET",responseType:"arraybuffer",type:"arraybuffer",onComplete:t}):l.handlerequest(e,{method:"GET",responseType:"arraybuffer",type:"arraybuffer",onComplete:t})},this.creDelegUnzip=function(e){var t=this,i=t._msaworker.promises.length;e.id=i;var s={},n=new Promise(function(i){t._msaworker.postMessage(e),s.resolve=function(e){i(e)}});return t._msaworker.promises[i]=s,n},this._readMineSchedAnimationFD1=function(e){var s=this,n=i.getWebappsBaseUrl(),a=t.matchUrl(n,window.location)?null:"Passport",r=[{provider:"FILE",filename:"AmdLoader.js",serverurl:n+"AmdLoader/",requiredAuth:a},{provider:"FILE",filename:"ThreeJS_Base.js",serverurl:n+"Mesh/",requiredAuth:a},{provider:"FILE",filename:"GEO7zip.js",serverurl:n+"GEO7zip/",requiredAuth:a},{provider:"FILE",filename:"minizip-asm.min.js",serverurl:n+"GEO7zip/nodejs/node_modules/minizip-asm.js/lib/",requiredAuth:a},{provider:"FILE",filename:"mineschedanimationWorker.js",serverurl:n+"GEOV1Workers/",requiredAuth:a}];if(!s._msaworker){s._msaworker={promises:[],initialize:function(e){if(5===s._msaworker.workers.length)s._msaworker.workers.forEach(function(t){t.postMessage(e)});else var t=setInterval(function(){5===s._msaworker.workers.length&&(clearInterval(t),s._msaworker.initialize(e))},50)},postMessage:function(e){var t=s._msaworker.workers.shift();s._msaworker.workers.push(t),t.postMessage(e)},terminate:function(){s._msaworker.workers.forEach(function(e){e.terminate()})},workers:[]};for(var l=function(e){var t=s._msaworker.promises[e.data.id],i={data:e.data.data,zipSize:e.data.zipSize,meshInputs:e.data.meshInputs};t.resolve(i)},d=1;d<=5;d++)o.getWorkerBlobFromSpecs(r,function(e){var t=new Worker(e);t.onmessage=function(e){l(e)},s._msaworker.workers.push(t)})}if(!s._plyworker){s._plyworker={promises:[],postMessage:function(e){var t=s._plyworker.workers.shift();s._plyworker.workers.push(t),t.postMessage(e)},terminate:function(){s._plyworker.workers.forEach(function(e){e.terminate()})},workers:[]};for(var u=function(e){var t=s._plyworker.promises[e.data.id],i={meshInputs:e.data.meshInputs};t.resolve(i)},h=1;h<=3;h++)o.getWorkerBlobFromSpecs(r,function(e){var t=new Worker(e);t.onmessage=function(e){u(e)},s._plyworker.workers.push(t)})}s._downloadFileFD1(e.url,function(t){if(s._msaworker){var i=s._msaworker.promises.length,n={},a=new Promise(function(e){s._msaworker.initialize({arraybuffer:t,id:i}),n.resolve=function(t){e(t)}});s._msaworker.promises[i]=n,a.then(function(){return s.creDelegUnzip({meshName:"results3d.xml"}).then(function(t){s.totalprogress||(s.totalprogress=t.zipSize,s.progress=0),s.progress+=1,e.callbacks.progress&&e.callbacks.progress({loaded:s.progress,total:s.totalprogress});var i=s._createResult3D(e,t.data),n={loaderinputs:e,result3DEntry:t.data,result3DNode:i};return s._appendMeshes(n)}).then(function(){s._msaworker.terminate(),s._plyworker.terminate(),e.callbacks.done()})})}})},this._createResult3D=function(e,t){var i=new a;i.name="Result3dNode",i.productType="Reference3D",e.scene.addChild(i);for(var s=(new DOMParser).parseFromString(t.data,"text/xml"),n={},r=s.evaluate("/results3d/settings/canvassettings/*",s,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),l=0;l<r.snapshotLength;l++){var o=r.snapshotItem(l);n.canvassetting||(n.canvassetting={});var d=o.nodeName;n.canvassetting[d]={};for(var u=s.evaluate("./*",o,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),h=0;h<u.snapshotLength;h++){var v=u.snapshotItem(h),p=v.nodeName,m=v.textContent;n.canvassetting[d][p]=m}}for(var g,f=s.evaluate("/results3d/period",s,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),b=[],N=0;N<f.snapshotLength;N++){0===N&&b.push({number:0}),g=f.snapshotItem(N);var P=s.evaluate("./number",g,null,XPathResult.ANY_TYPE,null),y=s.evaluate("./start",g,null,XPathResult.ANY_TYPE,null),_=s.evaluate("./end",g,null,XPathResult.ANY_TYPE,null),E=P.iterateNext().textContent,D=y.iterateNext(),R=_.iterateNext(),w=new Date(D.attributes.year.value,D.attributes.month.value,D.attributes.day.value),x=new Date(R.attributes.year.value,R.attributes.month.value,R.attributes.day.value),S={number:parseInt(E),start:w,end:x};b.push(S)}n.node=i,n.periods=b;var A=new c(n);return i.msaResult3d=A,i},this._appendMeshes=function(e){var t=[];return t=(t=(t=t.concat(this._appendStaticMeshes(e))).concat(this._appendMeshForPeriod(e))).concat(this._appendScaledMesh(e)),Promise.all(t)},this._appendStaticMeshes=function(e){for(var t,i=this,s=[],n=(new DOMParser).parseFromString(e.result3DEntry.data,"text/xml"),a=n.evaluate("/results3d/staticmesh",n,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),r=0;r<a.snapshotLength;r++){t=a.snapshotItem(r);var l=n.evaluate("./filename",t,null,XPathResult.ANY_TYPE,null),o=n.evaluate("./color/r",t,null,XPathResult.ANY_TYPE,null),d=n.evaluate("./color/g",t,null,XPathResult.ANY_TYPE,null),u=n.evaluate("./color/b",t,null,XPathResult.ANY_TYPE,null),h=n.evaluate("./color/a",t,null,XPathResult.ANY_TYPE,null),c=l.iterateNext().textContent,v={Red:o.iterateNext().textContent,Green:d.iterateNext().textContent,Blue:u.iterateNext().textContent,Alpha:h.iterateNext().textContent};v.color={r:parseInt(v.Red),g:parseInt(v.Green),b:parseInt(v.Blue),a:parseInt(v.Alpha)},v.result3dNode=e.result3DNode;var p,m=n.evaluate("./tag/line",t,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);if(m){v.Tags=[],v.tag=[];for(var g=0;g<m.snapshotLength;g++)p=m.snapshotItem(g),v.Tags.push(p.textContent),v.tag.push(p.textContent)}if(i._msaworker){var f=i.creDelegUnzip({meshName:c}),b=Promise.resolve(v),N=Promise.all([b,f]).then(function(t){var s=t[0],n=t[1].data;return i._parsePLY(n.data,s).then(function(t){var s=t.createdMesh,n=t.parameters;return new Promise(function(t){n.bs=s.getBoundingSphere(),n.bb=s.getBoundingBox();var a=i._createTagNode(n);e.result3DNode.addChild(s),a&&e.result3DNode.addChild(a),s.mesh3js.sceneGraph.children[0].solid=1,t(s)})})});s.push(N),N.then(function(){i.progress+=1,e.loaderinputs.callbacks.progress&&e.loaderinputs.callbacks.progress({loaded:i.progress,total:i.totalprogress})})}}return s},this._appendMeshForPeriod=function(e){for(var t,i=this,s=[],n=(new DOMParser).parseFromString(e.result3DEntry.data,"text/xml"),a=n.evaluate("/results3d/meshforperiod",n,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),r=0;r<a.snapshotLength;r++){t=a.snapshotItem(r);var l=n.evaluate("./filename",t,null,XPathResult.ANY_TYPE,null),o=n.evaluate("./color/r",t,null,XPathResult.ANY_TYPE,null),d=n.evaluate("./color/g",t,null,XPathResult.ANY_TYPE,null),u=n.evaluate("./color/b",t,null,XPathResult.ANY_TYPE,null),h=n.evaluate("./color/a",t,null,XPathResult.ANY_TYPE,null),c=n.evaluate("./period",t,null,XPathResult.ANY_TYPE,null),v=n.evaluate("./visibility",t,null,XPathResult.ANY_TYPE,null),p=n.evaluate("./overridevisibility",t,null,XPathResult.ANY_TYPE,null),m=l.iterateNext().textContent,g={Red:o.iterateNext().textContent,Green:d.iterateNext().textContent,Blue:u.iterateNext().textContent,Alpha:h.iterateNext().textContent,Period:c.iterateNext().textContent};if(g.color={r:parseInt(g.Red),g:parseInt(g.Green),b:parseInt(g.Blue),a:parseInt(g.Alpha)},g.period=parseInt(g.Period),v){var f=v.iterateNext();f&&(g.visibility=f.textContent)}if(p){var b=p.iterateNext();b&&(g.overridevisibility=b.textContent)}g.result3dNode=e.result3DNode;var N,P=n.evaluate("./tag/line",t,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);if(P){g.Tags=[],g.tag=[];for(var y=0;y<P.snapshotLength;y++)N=P.snapshotItem(y),g.Tags.push(N.textContent),g.tag.push(N.textContent)}if(i._msaworker){var _=i.creDelegUnzip({meshName:m}),E=Promise.all([Promise.resolve(g),_]).then(function(t){var s=t[0],n=t[1].data;return i._parsePLY(n.data,s).then(function(t){var s=t.createdMesh,n=t.parameters;return new Promise(function(t){n.bs=s.getBoundingSphere(),n.bb=s.getBoundingBox();var a=i._createTagNode(n);e.result3DNode.addChild(s),a&&e.result3DNode.addChild(a),s.mesh3js.sceneGraph.children[0].solid=1,t(s)})})});s.push(E),E.then(function(){i.progress+=1,e.loaderinputs.callbacks.progress&&e.loaderinputs.callbacks.progress({loaded:i.progress,total:i.totalprogress})})}}return s},this._appendScaledMesh=function(t){for(var i,s=this,n=[],r=(new DOMParser).parseFromString(t.result3DEntry.data,"text/xml"),l=r.evaluate("/results3d/scaledmesh",r,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),o=0;o<l.snapshotLength;o++){i=l.snapshotItem(o);for(var d=r.evaluate("./filename",i,null,XPathResult.ANY_TYPE,null),u=r.evaluate("./color/r",i,null,XPathResult.ANY_TYPE,null),h=r.evaluate("./color/g",i,null,XPathResult.ANY_TYPE,null),c=r.evaluate("./color/b",i,null,XPathResult.ANY_TYPE,null),v=r.evaluate("./color/a",i,null,XPathResult.ANY_TYPE,null),p=r.evaluate("./location/x",i,null,XPathResult.ANY_TYPE,null),m=r.evaluate("./location/y",i,null,XPathResult.ANY_TYPE,null),g=r.evaluate("./location/z",i,null,XPathResult.ANY_TYPE,null),f=r.evaluate("./scalefactors/factor",i,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),b=[],N=0;N<f.snapshotLength;N++){var P=f.snapshotItem(N),y=r.evaluate("./period",P,null,XPathResult.ANY_TYPE,null),_=r.evaluate("./scale",P,null,XPathResult.ANY_TYPE,null);b[N]={period:y.iterateNext().textContent,scale:_.iterateNext().textContent}}var E=d.iterateNext().textContent,D={Red:u.iterateNext().textContent,Green:h.iterateNext().textContent,Blue:c.iterateNext().textContent,Alpha:v.iterateNext().textContent,LocationX:p.iterateNext().textContent,LocationY:m.iterateNext().textContent,LocationZ:g.iterateNext().textContent,ScaleFactors:b};D.color={r:parseInt(D.Red),g:parseInt(D.Green),b:parseInt(D.Blue),a:parseInt(D.Alpha)},D.visibility="stockpile";var R,w=r.evaluate("./tag/line",i,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);if(w){D.Tags=[],D.tag=[];for(var x=0;x<w.snapshotLength;x++)R=w.snapshotItem(x),D.Tags.push(R.textContent),D.tag.push(R.textContent)}if(s._msaworker){var S=s.creDelegUnzip({meshName:E}),A=Promise.all([Promise.resolve(D),S]).then(function(i){var n=i[0],r=i[1].data,l=n.ScaleFactors,o=n.LocationX,d=n.LocationY,u=n.LocationZ,h=new a(r.name);t.result3DNode.addChild(h);for(var c=[],v=0;v<l.length;v++){var p=l[v],m=e.clone(n);m.Scale=p.scale,m.period=parseInt(p.period),m.result3dNode=t.result3DNode;var g=s._parsePLY(r.data,m).then(function(e){var t=e.createdMesh;return new Promise(function(e){t.translateX(1e3*o),t.translateY(1e3*d),t.translateZ(1e3*u),h.addChild(t),t.mesh3js.sceneGraph.children[0].solid=1,e(t)})});c.push(g)}n.bs=h.getBoundingSphere(),n.bb=h.getBoundingBox();var f=s._createTagNode(n);return f&&t.result3DNode.addChild(f),Promise.all(c)});n.push(A),A.then(function(){s.progress+=1,t.loaderinputs.callbacks.progress&&t.loaderinputs.callbacks.progress({loaded:s.progress,total:s.totalprogress})})}}return n};this._parsePLY=function(e,t){var i=this;if(3===i._plyworker.workers.length){var a=i._plyworker.promises.length,l={},o=new Promise(function(s){i._plyworker.postMessage({ply:e,parameters:{color:t.color,Scale:t.Scale},id:a}),l.resolve=function(e){s(e)}});return i._plyworker.promises[a]=l,Promise.all([Promise.resolve(t),o]).then(function(e){return new Promise(function(t){var i=e[0],a=e[1].meshInputs,l=function(e,t,i,a,l){var o=new s.PrimitiveGroup;o.fillAttr=new s.FillAttributes,o.lineAttr=new s.LineAttributes,o.pointAttr=new s.PointAttributes;var d=new s.Buffer;d.size=9*e,d.component=s.VertexComponentEnum.POSITION,d.format=s.DataTypeEnum.FLOAT,d.dimension=3,d.data=t;var u=new s.Buffer;u.size=9*e,u.component=s.VertexComponentEnum.NORMAL,u.format=s.DataTypeEnum.FLOAT,u.dimension=3,u.data=i;var h=null;a&&((h=new s.Buffer).size=4*e,h.component=s.VertexComponentEnum.DIFFUSE_COLOR,h.format=s.DataTypeEnum.FLOAT,h.dimension=4,h.data=l),o.addBuffer(0,d),o.addBuffer(1,u),a&&o.addBuffer(2,h);var c=new s.Primitive({identifier:"face"});c.geomType="FACE",c.nbIndices=3*e,c.connectivity=s.ConnectivityTypeEnum.TRIANGLES,c.attr={fill:new s.FillAttributes(new s.Color(l[0]/255,l[1]/255,l[2]/255,l[3]/255)),line:new s.LineAttributes,point:new s.PointAttributes};var v=new r.MeshPhongMaterial({color:(new r.Color).setRGB(l[0]/255,l[1]/255,l[2]/255),opacity:l[3]/255,side:r.DoubleSide});v.force=!0,c.material=v;var p=new s.VertexComponent;p.component=s.VertexComponentEnum.POSITION,p.nbVertices=3*e,p.nbValuesPerVertex=3,p.format=s.DataTypeEnum.FLOAT,p.cardinality=0,p.bufferId=0,p.indices=null;var m=new s.VertexComponent;m.component=s.VertexComponentEnum.NORMAL,m.nbVertices=3*e,m.nbValuesPerVertex=3,m.format=s.DataTypeEnum.FLOAT,m.cardinality=0,m.bufferId=1,m.indices=null,c.addVertexComponent(p),c.addVertexComponent(m);var g=null;return a&&((g=new s.VertexComponent).component=s.VertexComponentEnum.DIFFUSE_COLOR,g.nbVertices=3*e,g.nbValuesPerVertex=4,g.format=s.DataTypeEnum.FLOAT,g.cardinality=0,g.bufferId=2,g.indices=null,c.addVertexComponent(g)),o.addPrimitive(c),n.createMeshNode(o)}(a.nbFaces,a.vertices,a.normals,!0,a.colors),o=i.Tags;l.tags=o,i.node=l;var d=new h(i);l.msaNode=d,d.applyColorSettings(),d.applyPeriod(0),t({createdMesh:l,parameters:i})})})}var d=setInterval(function(){3===i._plyworker.workers.length&&(clearInterval(d),_parsePLY(e,t))},50)},this._createTagNode=function(){}}});