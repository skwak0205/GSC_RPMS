define("DS/NotificationManager/NotifiManagerTracker",["UWA/Core","DS/Usage/TrackerAPI"],function(t,e){"use strict";return{trackNotifSystem:function(t){},trackAlertNotifications:function(i){var n={eventCategory:"notification.managerview",eventAction:i.eventAction,eventLabel:i.eventLabel,eventValue:i.eventValue,persDim:i.persDim,persVal:i.persVal,appID:"X3DNTFC_AP"};try{e.trackPageEvent(n)}catch(e){t.log("Analytics request failed : "+e)}}}}),define("DS/NotificationManager/view/notificationManagerView",["UWA/Core","UWA/Class/View","UWA/Controls/Abstract","DS/NotifAlert/NotifAlert","css!DS/NotificationManager/NotificationManager.css"],function(t,e,i,n){"use strict";return e.extend({defaultOptions:{itemView:n,language:"en"},setup:function(e){this.maxItems=3,this.isInject=!1,this.isClosed=!1,this.itemView=e&&e.itemView?e.itemView:this.options.itemView,this.language=e&&e.language?e.language:this.options.language,this.listenTo(this.collection,"onAdd",this.add),this.listenTo(this.collection,"onRemove",this.deleteModel),this.collection.addEvents({"onChange:readState":function(e){t.log("AlertBox model changed")}}),this.setContainer({tag:"div",class:"RTnotification"})},add:function(e){var i;if(this.isInject)if(this.collection.length<=this.maxItems){t.log("AlertBox - Add"),i=new this.itemView({model:e});var n=t.createElement("div",{class:"RTnotif-alert",html:i}).inject(this.container,"top");e.get("isInNotifCenter")||(this._createAlertShowFx(e,n),i.show(),e.showAlertFx.start({top:["0px","0px"],right:["-400px","15px"],opacity:[0,1]}))}else{this._timeToRemove&&(clearTimeout(this._timeToRemove),this._timeToRemove=void 0);var o=this;this._timeToRemove=setTimeout(function(){o.closeAllAlerts()},1e3)}},deleteModel:function(e){if(e){t.log("AlertBox model deleted"),e.showAlertFx&&(e.showAlertFx.fade("out").onComplete=function(){this.element&&this.element.destroy()})}},inject:function(t){this.isInject=!0,this.container.inject(t);for(var e=0;e<this.collection.size();e++)this.add(this.collection.at(e))},checkExistingAlert:function(){return!!document.querySelector(".RTnotif-alert")},_createAlertShowFx:function(e,i){e.showAlertFx=new t.Fx(i,{duration:500,transition:"linear",events:{onComplete:function(){}}})},closeAllAlerts:function(){for(;!this.collection.isEmpty();)this.collection.pop()}})}),define("DS/NotificationManager/notificationDriver",["UWA/Core","UWA/Class","DS/PlatformAPI/PlatformAPI","UWA/Class/Events","DS/DSNodeSocketioClient_4.4.1/DSNodeSocketioClient_4.4.1","DS/WAFData/WAFData"],function(t,e,i,n,o,s){"use strict";return e.extend(n,{defaultOptions:{notifServer:"",currentLanguage:"en"},init:function(t){var e=this;this._listenedEvents=t.listenedEvents,this._socket=void 0,this._server=void 0,this._token=void 0,this._socketOptions=void 0,this.USE_RETRY=!0,this.IN_RETRY=!1,this.MAX_CONNECTION_TRIES=t.MAX_CONNECTION_TRIES,isNaN(this.MAX_CONNECTION_TRIES)&&"Infinity"!=this.MAX_CONNECTION_TRIES&&(this.MAX_CONNECTION_TRIES=10),i.subscribe("3dNotifCenterInit",function(){e._socket?i.publish("3dNotifManagerInit",!0):i.publish("3dNotifManagerInit",!1)}),this.listenNetworkEvent(),this.listenVisibilityEvent()},listenVisibilityEvent:function(){var e,i;void 0!==document.hidden?(e="hidden",i="visibilitychange"):void 0!==document.msHidden?(e="msHidden",i="msvisibilitychange"):void 0!==document.webkitHidden&&(e="webkitHidden",i="webkitvisibilitychange"),void 0===document.addEventListener||void 0===e?t.log("NotificationDriver requires a browser that supports the Page Visibility API."):document.addEventListener(i,function(e){document.hidden||(this.IN_RETRY&&t.log("NotificationDriver visible but in retry process."),this.checkSocketStatus())}.bind(this))},listenNetworkEvent:function(){this.USE_RETRY&&(window.addEventListener("online",this.checkSocketStatus.bind(this)),window.addEventListener("offline",this.checkSocketStatus.bind(this)))},removeNetworkEvent:function(){window.removeEventListener("online",this.checkSocketStatus.bind(this)),window.removeEventListener("offline",this.checkSocketStatus.bind(this))},checkSocketStatus:function(){t.log("NotificationDriver checkSocketStatus use retry "+this.USE_RETRY),this.USE_RETRY&&(navigator.onLine?this._socket&&this._socket.disconnected?this.IN_RETRY?t.log("NotificationDriver already in retry process!"):(this.alertRetryEvent("alert_reconnectOngoing"),this.IN_RETRY=!0,this._socket.io.reconnection(!0),this._socket.io.connect(),t.log("NotificationDriver retry process connect socket.")):this._socket||(this.alertRetryEvent("alert_reconnectOngoing"),this.activeConnection(this._socketOptions),t.log("NotificationDriver need to do whole init/login socket again!")):(this._socket&&(!this._socket.connected&&this._socket.disconnected||(t.log("NotificationDriver no network then disonnect socket & dont retry."),this._socket.io.reconnection(!1),this._socket.io.disconnect())),this.IN_RETRY=!1,this.alertRetryEvent("alert_connexionNetworkLost"),t.log("NotificationDriver no network!")))},alertRetryEvent:function(e){t.log("NotificationDriver alert: "+e)},activeConnection:function(e){t.log("3DNOTIF - NotificationManager activeConnection");var n=this,a={"force new connection":!1,reconnection:!!this.MAX_CONNECTION_TRIES,reconnectionDelayMax:13e4,reconnectionAttempts:this.MAX_CONNECTION_TRIES,timeout:1e4,transports:["websocket"]};if(this._socketOptions=e,this._server||(this._server=e.notifServer),this._server&&(this._socket=o.connect(this._server,a)),this._socket){isNaN(this.MAX_CONNECTION_TRIES)||(this._socket.io.reconnectionAttempts(a.reconnectionAttempts),this._socket.io.reconnectionDelayMax(a.reconnectionDelayMax));for(var r=0;r<n._listenedEvents.length;r++)!function(t){n._socket.on(t,function(e){n.dispatchListenedEvents(e,t)})}(n._listenedEvents[r]);this._socket.on("connect",function(){var o={onComplete:function(o){var s;if("object"!=typeof o)try{s=JSON.parse(o)}catch(e){t.log("3DNotification : error parsing cas validate ticket response :"+e)}else s=o;if(s&&s.access_token){n._token=s.access_token,n._socket.emit("new_user",{pseudo:e.login.toLowerCase(),pass:n._token,language:e.currentLanguage,tenant:e.tenant}),delete n._token,n._token=void 0,i.publish("intf-ws-topic",{event:"ready",code:200})}else{t.log("3DNotification : json null or no acess token");for(var a=0;a<n._listenedEvents.length;a++)!function(t){n._socket.off(t)}(n._listenedEvents[a]);n._socket.off("connect"),n._socket.off("error"),n._socket.close(),delete n._socket}},onFailure:function(i){e.iamUrl===e.tenantAgnosticIamUrl?t.log(i):(e.iamUrl=e.tenantAgnosticIamUrl,s.authenticatedRequest(e.iamUrl,o))},onTimeout:function(e){t.log(e)},type:"json"};s.authenticatedRequest(e.iamUrl,o),n.IN_RETRY&&n.alertRetryEvent("alert_connexionRetrieved"),n.IN_RETRY=!1}),this._socket.on("error",function(e){t.log("3DNotification Socket Connection Error\n"+e)}),this._socket.on("reconnect_attempt",function(e){return function(i){return isNaN(i)?console.error("Notif socket io onReConnectAttempt arg is not a number !"):!(!e._socket||!e._socket.io||isNaN(e.MAX_CONNECTION_TRIES))&&void(i==e.MAX_CONNECTION_TRIES-1?(e.IN_RETRY=!0,e._socket.io.reconnection(!0),e._socket.io.reconnectionDelay(12e4),t.log("Notif websocket "+i+" tries to connect to server have occured, the reconnection delay has been raised to 2min")):i>=e.MAX_CONNECTION_TRIES?(t.log("Notif websocket max tries quantity have been reached. Stopping connection attempts"),e.IN_RETRY=!1,e._socket.io.reconnection(!1),e._socket.close()):(e.IN_RETRY=!0,e._socket.io.reconnection(!0),e._socket.io.reconnectionDelay(1e3*i),t.log("Notif websocket "+i+" tries to connect to server have occured, the reconnection delay has been raised to "+i+"s")))}}(this))}},dispatchListenedEvents:function(t,e){this.dispatchEvent(e,t)},emit:function(t,e){this._socket&&this._socket.emit(t,e)}})}),define("DS/NotificationManager/view/notificationMessageView",["UWA/Class","UWA/Class/Events","UWA/Class/Model","UWA/Class/View","i18n!DS/NotificationManager/assets/nls/feed","DS/UIKIT/Tooltip"],function(t,e,i,n,o,s){"use strict";var a=i.extend(),r=n.extend({tagName:"div",id:"NTFMsgMiniNotification",className:"NTFMsgMiniNotification"}),c=n.extend({tagName:"div",className:"buddyContainer",render:function(){return this.container.setContent([{tag:"div",class:"buddyBubble buddyBubbleHidden",html:[{tag:"span",class:"fonticon handler fonticon-users buddyBubbleIcon"}]}]),this}}),l=n.extend({tagName:"div",id:"convNotifViewArrowList",className:"convNotifViewArrowList"}),d=n.extend({tagName:"div",id:"convNotifViewScroll",className:"convNotifViewScroll"}),f=n.extend({tagName:"div",id:"convNotifViewList",className:"convNotifViewList",y:0}),p=n.extend({tagName:"div",className:"convNotifContainer",updateModel:function(t){var e=this.container.getElementsByClassName("convBubbleMsg");e&&e.length>0&&(this.model.set({message:t}),this.container.getElementsByClassName("convBubbleMsg")[0].innerText=this.model.get("message"))},render:function(){return this.container.setContent([{tag:"div",class:"convNotifView",html:[{tag:"div",class:"convBubble",html:[{tag:"img",class:"convBubblePicture",src:this.model.get("pathPicture")}]},{tag:"div",class:"convBubbleAuthorView",html:[{tag:"div",class:"convBubbleAuthorViewContainer",html:[{tag:"div",class:"convBubbleAuthor",text:this.model.get("author")},{tag:"span",class:"fonticon fonticon-popup launchChatPanelIcon"},{tag:"span",class:"fonticon fonticon-cancel closeIcon"}]}]},{tag:"div",class:"convBubbleMsgView",html:[{tag:"div",class:"convBubbleMsgViewContainer",html:[{tag:"div",class:"convBubbleMsg",text:this.model.get("message")}]}]}]}]),this}}),u=n.extend({tagName:"div",className:"arrowView",setup:function(t){this.icon="up"==t?"fonticon-up-open":"fonticon-down-open"},render:function(){return this.container.setContent([{tag:"span",class:"fonticon "+this.icon+" arrowIcon"}]),this}}),g=n.extend({tagName:"span",className:"convNotifExtBadge fonticon fonticon-popup"});return t.extend(e,{init:function(t){var e=this;this.deleteBubbleHandler=t.deleteBubbleHandler,this.isMobileApp=t.isMobileApp,this.currentTenant=t.tenant,UWA.log("3DNotification Bubble init"),this.globalView=new r,this.buddyView=new c,this.notifViewArrowList=new l,this.notifViewScroll=new d,this.notifViewList=new f,this.arrowUp=new u("up"),this.arrowDown=new u("down"),this.views={},UWA.Event.onDomReady(function(){e.globalView.render(),e.buddyView.render().inject(e.globalView.container),e.notifViewArrowList.render().inject(e.globalView.container),e.arrowUp.render().inject(e.notifViewArrowList.container),e.notifViewScroll.render().inject(e.notifViewArrowList.container),e.arrowDown.render().inject(e.notifViewArrowList.container),e.notifViewArrowList.container.toggleClassName("convNotifViewArrowListMinifiedHidden",!0),e.notifViewList.render().inject(e.notifViewScroll.container),e.arrowUp.container.toggleClassName("hideElement",!0),e.arrowDown.container.toggleClassName("hideElement",!0),e.arrowUp.container.addEventListener("click",function(){e._scrollUp(100)}),e.arrowDown.container.addEventListener("click",function(){e._scrollDown(100)}),e.notifViewScroll.container.addEventListener("wheel",function(t){if(Object.keys(e.views).length>9){var i=Math.abs(t.deltaY);t.deltaY<0?e._scrollUp(i):t.deltaY>0&&e._scrollDown(i)}}),e.buddyView.getElement(".buddyBubble").addEvent("click",function(){var t=e.buddyView.getElement(".buddyBubble");t.hasClassName("buddyBubbleMinified")?(t.toggleClassName("buddyBubbleVisible",!0).toggleClassName("buddyBubbleMinified",!1),setTimeout(function(){e.notifViewArrowList.container.toggleClassName("convNotifViewArrowListMinifiedHidden")},500)):t.hasClassName("buddyBubbleVisible")?(t.toggleClassName("buddyBubbleMinified",!0).toggleClassName("buddyBubbleVisible",!1),e.notifViewArrowList.container.toggleClassName("convNotifViewArrowListMinifiedHidden")):(t.toggleClassName("buddyBubbleMinified"),setTimeout(function(){e.notifViewArrowList.container.toggleClassName("convNotifViewArrowListMinifiedHidden")},100))})})},addNotification:function(t){var e,i=this;if(this.views[t.platformId]&&this.views[t.platformId][t.communityId]&&this.views[t.platformId][t.communityId][t.userLogin])(e=this.views[t.platformId][t.communityId][t.userLogin]).updateModel(t.infoTxt),e.getElement(".convBubble").toggleClassName("convBubbleBlink",!0),setTimeout(function(){e.getElement(".convBubble").toggleClassName("convBubbleBlink",!1)},3e3);else{var n=new a({platformId:t.platformId,communityId:t.communityId,login:t.userLogin,author:t.userName,message:t.infoTxt,pathPicture:t.pathPicture});(e=new p({model:n})).clickEvent=t.events.click,e.render().inject(i.notifViewList.container,"bottom"),e.container.getElement(".convNotifView").toggleClassName("convNotifViewHidden",!0);var r=e.model.get("platformId"),c=e.model.get("communityId"),l=e.model.get("login");this.views[r]||(this.views[r]={}),this.views[r][c]||(this.views[r][c]={}),this.views[r][c][l]=e,r==this.currentTenant?e.getElement(".launchChatPanelIcon").remove():(new s({target:e.getElement(".launchChatPanelIcon"),body:o.openInNewTab,trigger:"hover focus"}),(new g).render().inject(e.container,"bottom")),new s({target:e.getElement(".closeIcon"),body:o.close,trigger:"hover focus"}),this.notifViewList.y-=this._getDistanceToBottom(),Object.keys(this.views).length>9&&(this.notifViewList.y-=10,this.arrowDown.container.toggleClassName("hideElement",!1),this.arrowUp.container.toggleClassName("hideElement",!1)),this.notifViewList.container.setStyle("transform","translateY("+i.notifViewList.y+"px)");var d=this.buddyView.getElement(".buddyBubble");d.hasClassName("buddyBubbleHidden")?d.toggleClassName("buddyBubbleHidden",!1):d.hasClassName("buddyBubbleMinified")&&d.toggleClassName("buddyBubbleMinified",!1).toggleClassName("buddyBubbleVisible",!0),this.notifViewArrowList.container.toggleClassName("convNotifViewArrowListMinifiedHidden",!1),e.container.getElement(".convNotifView").toggleClassName("convNotifViewHidden",!1),setTimeout(function(){e.container.getElement(".convNotifView").toggleClassName("convNotifViewAppear",!0),setTimeout(function(){e.container.getElement(".convNotifView").toggleClassName("convNotifViewAppear",!1)},1500)},500),e.container.addEventListener("click",function(){i._clickBubble(e,!1,!1,!0,!0)}),e.getElement(".closeIcon").addEventListener("click",function(t){i._clickBubble(e,!0,!1,!0,!1),t.stopPropagation()})}},deleteBubblesFromConv:function(t,e,i){if(this.views[t]&&this.views[t][e]){var n;if(i)return void((n=this.views[t][e][i])&&this._clickBubble(n,!0,!1,!1,!1));for(i in this.views[t][e])n=this.views[t][e][i],this._clickBubble(n,!0,!1,!1,!1)}},_clickBubble:function(t,e,i,n,o){var s=t.model.get("platformId"),a=t.model.get("communityId"),r=t.model.get("login");if(this.views[s]&&this.views[s][a]&&this.views[s][a][r]){if(e||t.clickEvent(i),t.destroy(),delete this.views[s][a][r],0==Object.keys(this.views[s][a]).length&&delete this.views[s][a],0==Object.keys(this.views[s]).length&&delete this.views[s],o&&this.deleteBubblesFromConv(s,a,void 0),n&&this.deleteBubbleHandler({platformId:s,communityId:a}),Object.keys(this.views).length<10)this.notifViewList.y=0,this.arrowDown.container.toggleClassName("hideElement",!0),this.arrowUp.container.toggleClassName("hideElement",!0);else{var c=this._getDistanceToTop(),l=this._getDistanceToBottom();c<0?this.notifViewList.y=0:l<-15&&(this.notifViewList.y-=l+15)}this.notifViewList.container.setStyle("transform","translateY("+this.notifViewList.y+"px)"),0==Object.keys(this.views).length&&(this.buddyView.getElement(".buddyBubble").toggleClassName("buddyBubbleHidden",!0),this.notifViewArrowList.container.toggleClassName("convNotifViewArrowListMinifiedHidden",!0),this.buddyView.getElement(".buddyBubble").toggleClassName("buddyBubbleMinified",!1).toggleClassName("buddyBubbleVisible",!1))}},_getDistanceToTop:function(){var t=this.notifViewScroll.container.getBoundingClientRect(),e=this.notifViewList.container.getBoundingClientRect();return t.top-e.top},_getDistanceToBottom:function(){var t=this.notifViewScroll.container.getBoundingClientRect();return this.notifViewList.container.getBoundingClientRect().bottom-t.bottom},_scrollUp:function(t){var e=this._getDistanceToTop();if((e=Math.floor(e))>0){var i=Math.min(t,e);this.notifViewList.y+=i,this.notifViewList.container.setStyle("transform","translateY("+this.notifViewList.y+"px)")}},_scrollDown:function(t){var e=this._getDistanceToBottom();if(Object.keys(this.views).length>9&&(e+=15),(e=Math.floor(e))>-15){var i=Math.min(t,e);this.notifViewList.y-=i,this.notifViewList.container.setStyle("transform","translateY("+this.notifViewList.y+"px)")}},getView:function(){return this.globalView},destroy:function(){var t,e,i;for(t in this.views)for(e in this.views[t])for(i in this.views[t][e])this.views[t][e][i].destroy();this.notifViewList.destroy(),this.notifViewScroll.destroy(),this.arrowUp.destroy(),this.arrowDown.destroy(),this.notifViewArrowList.destroy(),this.buddyView.destroy(),this.globalView.destroy()}})}),define("DS/NotificationManager/notificationManager",["UWA/Core","UWA/Class","UWA/Data","UWA/Controls/Abstract","UWA/Class/Model","DS/WAFData/WAFData","DS/PlatformAPI/PlatformAPI","DS/UWPClientCode/PublicAPI","DS/UWPClientCode/I18n","DS/NotificationManager/view/notificationManagerView","DS/i3DXCompass/i3DXCompass","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/i3DXCompassPlatformServices/i3DXCompassRegistryClient","DS/TopBar/TopBar","DS/NotificationManager/notificationDriver","DS/NotifAlert/NotifAlert","DS/NotificationManager/view/notificationMessageView","DS/NotificationManager/NotifiManagerTracker"],function(t,e,i,n,o,s,a,r,c,l,d,f,p,u,g,h,v,m){"use strict";var b;return e.extend({init:function(e){if(b=this,this.login=e.login,this.ODT=e.ODT,this.isMobileApp=e.isMobileApp||window&&window.ds&&"MOBILE"==window.ds.env,this.ODT||this.isMobileApp||(this.frame=require("DS/TopFrame/TopFrame"),this.appName=this.frame.helpMenuOptions.appNameAbout.toLowerCase()),this.topBar=u.MainMenuBar,this.swymServer=e.swymServer,this.badge=0,this.isFiltered=!1,this.listOfAppw={},this.listOfService=void 0,this._notifManagerView=void 0,this.blockAlert=!1,this._listenedEvents=void 0,this._emmitedEvents=void 0,this.initListenedEvents(),this.initEmmitedEvents(),this.getServices(),this.swymContext=void 0,this.tenantAgnosticMode=void 0,this._notificationDriver=new g({listenedEvents:Object.keys(b._listenedEvents)}),this._notificationDriver.addEvent("newINTFTokenConnection",function(){var t=b.getParams();t&&t.login&&b.requestProxyTicket(t)}),this.initConnection(e.login,e.passportServer,e.tenant),this.InitPushTo3dNotif("pushto3dnotification"),this.initListeners(),!this.notifCollection&&!this._notifManagerView){this.notifCollection=new t.Class.Collection,this._notifManagerView=new l({collection:this.notifCollection});try{this._notifConvView=new v({deleteBubbleHandler:function(e){t.log("emit syncSwymConvNotif"+JSON.stringify(e)),b._notificationDriver.emit("syncSwymConvNotif",e)},isMobileApp:b.isMobileApp,tenant:b.tenant}),this._notifConvView.getView().inject(document.body)}catch(e){t.log("3DNotification - ERROR - instantiate bubble: "+e)}this._notifManagerView.inject(document.body),this.ODT||this.initFrameEvents()}this.addListener("3dnotifinterne",b.getActions),this.addListener("INTFSubscriptionTopic",function(t){b._notificationDriver.emit("subscription",t)}),(this.isMobileApp||"3dswym"==this.appName||"my3dexperience"==this.appName)&&(this.addListener("app.3DSwym",b.doSwymEvents),a.publish("app.3DSwym",{action:"contextChangeRequest",from:{app:"3DNotification",component:"conversationNotification"}}))},initEmmitedEvents:function(){this._emmitedEvents={notifCenterOpened:"notifCenterOpened",resetNotifications:"resetNotifications",notificationRead:"notificationRead",decrementBadge:"decrementBadge",getHistory:"getHistory",getFilterHistory:"getFilterHistory",getUnreadTotal:"getUnreadTotal",getFilterTotal:"getFilterTotal",getStarredTotal:"getStarredTotal",getSettings:"getSettings",updateSettings:"updateSettings",notificationDelete:"notificationDelete",deleteAllNotification:"deleteAllNotification",unsubscribe:"unsubscribe",filter:"filter",rollback:"rollback",rollbackPopupconfirmation:"rollbackPopupconfirmation",pushToken:"pushToken",deleteAllFilteredNotification:"deleteAllFilteredNotification",syncSwymConvNotif:"syncSwymConvNotif",getBadge:"getBadge",getMerge:"getMerge",closeNotifCenter:"closeNotifCenter",getTenantAgnosticMode:"getTenantAgnosticMode",updateTenantAgnosticMode:"updateTenantAgnosticMode"}},initListenedEvents:function(){this._listenedEvents={notify:this.notify,notifyCenter:this.notifyCenter,notifySystem:this.notifySystem.bind(this),setHistory:this.setHistory,setUnreadTotal:this.setUnreadTotal,setFilteredTotal:this.setFilteredTotal,setStarredTotal:this.setStarredTotal,setSettings:this.setSettings,refreshCenterView:this.refreshCenterView,setSetting:this.setSetting,updateBadge:this.updateBadge,readNotification:this.readNotification,deleteNotification:this.deleteNotification,setTenants:this.setTenants,setDates:this.setDates,setWhoSettings:this.setWhoSettings,setNotifications:this.setNotifications,setSubscribedState:this.setSubscribedState,refreshForRollback:this.refreshForRollback,authenticated:this.authenticated,authenticate_error:this.authenticate_error,token_registered:this.token_registered,token_registered_error:this.token_registered_error,deleteSwymConvNotif:this.deleteSwymConvNotif.bind(this),setMerge:this.setMerge,setTenantAgnosticMode:this.setTenantAgnosticMode}},initListeners:function(){for(var t in this._listenedEvents)this._listenedEvents.hasOwnProperty(t)&&this._notificationDriver.addEvent(t,this._listenedEvents[t])},initConnection:function(e,i,n){if(!n)try{n=require("DS/TopFrame/TopFrame")._tenantId}catch(e){t.log("3DNotification: did not find tenant with TopFrame, try with URL")}if(!n){var o=window.location.href.match(/https:\/\/([A-z0-9]+)-([A-z0-9]+)-[A-z0-9]+(-|.)/);n=o&&4==o.length&&("-"==o[3]||o[1]&&o[1].length>4)?(n=o[1]).toUpperCase():this.findCurrentTenant()}this.getPlatformServicesUrl(e,i,n)},getPlatformServicesUrl:function(e,i,n){var o=!1,s=this;function r(r){f.getServiceUrl({serviceName:"3dnotifications",platformId:n,onComplete:function(c){if(c){s.passportUrl||("string"==typeof r&&(s.passportUrl=r),s.passportUrl||(s.passportUrl=i||a.getApplicationConfiguration("app.urls.passport"))),s.tenantAgnosticPassportUrl||(s.tenantAgnosticPassportUrl=i||a.getApplicationConfiguration("app.urls.passport"));var l=s.getParams(e);if(l.tenant=n,"object"==typeof c){for(var d=0;d<c.length;d++)if(c[d].url&&(s.notifServer=s.extractDomain(c[d].url),o=!0),o){l&&l.login&&s.requestProxyTicket(l);break}}else"string"==typeof c&&(s.notifServer=s.extractDomain(c),l&&l.login&&s.requestProxyTicket(l));s.notifServer||t.log("3DNotification error : no intf url found need visual information")}else s.getPlatformServicesUrl(e,i)}})}this.tenant=n,a.getApplicationConfiguration("app.urls.registry")&&n?p.getServicesByPlatform({services:["3DPassport"],platforms:[n],config:{url:a.getApplicationConfiguration("app.urls.registry")}}).then(t=>{let e;t&&t.length>0&&t[0].id&&t[0].id.toLowerCase()===n.toLowerCase()&&t[0].services&&t[0].services.length>0&&t[0].services[0].id&&"3dpassport"===t[0].services[0].id.toLowerCase()&&(e=t[0].services[0].url),r(e)},function(){r()}):r()},findCurrentTenant:function(){var e=r.getApplicationConfiguration("app.mp.tenant");if(t.log("findCurrentTenant selected the PublicAPI.app.mp.tenant "+e),!e){try{var i,n=JSON.parse(r.user.properties.dashboards)}catch(e){t.log("3DNotification error: unable to parse user dahboards")}for(i in n)if(n[i].platformId){e=n[i].platformId,t.log("findCurrentTenant selected the first PublicAPI.user.properties.dashboards tenant "+e);break}}return t.log("findCurrentTenant ends with "+e),e},initFrameEvents:function(){var t=this;t.frame&&t._notifManagerView&&t._notificationDriver&&(t.frame.addEvent("onRightPanelOpened",function(e){t._notifManagerView.closeAllAlerts(),"notification"===t.frame._visibleApp&&(t.topBar.setBadge("notification",0),t.badge=0,t.blockAlert=!0,t._notificationDriver.emit("notifCenterOpened",t.blockAlert))}),t.frame.addEvent("onRightPanelClosed",function(e){t.blockAlert=!1,t._notificationDriver.emit("resetNotifications",t.blockAlert)}))},getParams:function(t){var e={};return e.currentLanguage=c.getCurrentLanguage(),e.currentLanguage||(e.currentLanguage=window.navigator.language),a.getUser()&&(e.login=a.getUser().login),e.login||(e.login=t),b.language=e.currentLanguage,e},getServices:function(){void 0===this.listOfService?f.getPlatformServices({onComplete:function(t){for(var e=0;e<t.length;e++)for(var i in t[e])t[e].hasOwnProperty(i)&&i.toLowerCase()!=i&&(t[e][i.toLowerCase()]=t[e][i],delete t[e][i]);b.listOfService=t,a.publish("3dnotifinterne",{action:"setServices",services:b.listOfService})}}):a.publish("3dnotifinterne",{action:"setServices",services:b.listOfService})},getServiceUrl:function(t){if(!t||!t.name)return;if(!this.listOfService||this.listOfService.length<1)return;let e,i=t.name.toLowerCase(),n=t.platformId&&t.platformId.toLowerCase();if(n){for(let t of this.listOfService){if(t.platformid.toLowerCase()==n&&t[i])return t[i];e=e||t[i]}return e}for(let t of this.listOfService)if(t[i])return t[i]},getAppInfos:function(e,i){var n=this;if(this.listOfAppw[e.appID])if(e.notif){if(i)return this.listOfAppw[e.appID];e.notif.dispatchEvent("updatePicture",[{src:this.listOfAppw[e.appID]}])}else{if(i)return this.listOfAppw[e.appID];a.publish("3dnotifinterne",{action:"setAppInfos",src:this.listOfAppw[e.appID],notifID:e.notifID})}else d.getAppInfo({appId:e.appID,onComplete:function(o){if(t.log(o),o)if(n.listOfAppw[o.id]=o.icon,e.notif){if(i)return n.listOfAppw[o.id];e.notif.dispatchEvent("updatePicture",[{src:o.icon}])}else{if(i)return n.listOfAppw[o.id];a.publish("3dnotifinterne",{action:"setAppInfos",src:o.icon,notifID:e.notifID})}}})},addListener:function(t,e){a.subscribe(t,e)},addItem:function(t){var e=this;t.addEvent("publish",function(t){a.publish(t.topic,t.data)}),t.addEvent("read",function(i){e._notificationDriver.emit("notificationRead",i),e._notificationDriver.emit("decrementBadge",{platformId:t._attributes.platformId}),a.publish("3dnotifinterne",{action:"read",params:{id:i.id,read:!0}})}),t.addEvent("actioned",function(t){a.publish("3dnotifinterne",{action:"actioned",params:{id:t.id,actioned:!0}})}),t.addEvent("alertBoxClosed",function(){e.badge-=1,e._notificationDriver.emit("decrementBadge",{platformId:t._attributes.platformId})}),t.addEvent("updateLabel",function(t){if(t&&t.id){var i={action:"updateLabel",updateLabel:"updateLabel",params:{id:t.id,label:t.label,flag:t.flag}};a.publish("3dnotifinterne",i)}e._notificationDriver.emit("notificationRead",i)}),e.notifCollection.add(t),m.trackAlertNotifications({eventAction:"notifAlerts",eventLabel:"Notif alerts in dashboard",eventValue:t.id,persDim:{pd1:t._attributes.provider,pd2:t.cid}})},addNotification:function(t){a.publish("3dnotifinterne",{action:"addNotification",notification:JSON.stringify(t),appName:b.appName,currentTenant:b.tenant})},getActions:function(e){switch(e.action){case"rollback":a.publish("3dnotifinterne",{action:"rollbackPopup",params:{file:e.file,id:e.id,isInNotifCenter:e.isInNotifCenter}});break;case"rollbackPopupconfirmation":b._notificationDriver.emit("rollback",{filename:e.file,user:a.getUser().login,confirmPopupResult:e.confirmPopupResult,id:e.id});break;case"getHistory":b._notificationDriver.emit("getHistory",{type:e.type,oldID:e.oldID,groupIDs:e.groupIDs});break;case"getFilterHistory":b._notificationDriver.emit("filter",{type:e.type,oldID:e.oldID,groupIDs:e.groupIDs,msg:b.filterValues.msg,first_date:b.filterValues.first_date,last_date:b.filterValues.last_date,tenants:b.filterValues.tenants,whoSettings:b.filterValues.whoSettings,archive:b.filterValues.archive});break;case"getUnreadTotal":b._notificationDriver.emit("getUnreadTotal");break;case"getFilterTotal":b._notificationDriver.emit("getFilterTotal",{msg:b.filterValues.msg,first_date:b.filterValues.first_date,last_date:b.filterValues.last_date,tenants:b.filterValues.tenants,whoSettings:b.filterValues.whoSettings,archive:b.filterValues.archive});break;case"getStarredTotal":b._notificationDriver.emit("getStarredTotal");case"getAppInfos":b.getAppInfos({appID:e.appID,notifID:e.notifID});break;case"getSettings":b._notificationDriver.emit("getSettings");break;case"getTenants":b._notificationDriver.emit("getTenants");break;case"getDates":b._notificationDriver.emit("getDates");break;case"getWhoSettings":b._notificationDriver.emit("getWhoSettings");break;case"getParams":a.publish("3dnotifinterne",{action:"setParams",params:{passportUrl:b.options.passportUrl,swymUrl:b.options.swymServer}});break;case"getServices":b.getServices();break;case"notificationRead":b.isFiltered&&(e.archive=b.filterValues.archive),b._notificationDriver.emit("notificationRead",e);break;case"actioned":b._notificationDriver.emit("notificationRead",e);break;case"updateSettings":b._notificationDriver.emit("updateSettings",e);break;case"notificationDelete":b.isFiltered&&(e.archive=b.filterValues.archive),b._notificationDriver.emit("notificationDelete",e);break;case"deleteAllNotification":b._notificationDriver.emit("deleteAllNotification",e);break;case"deleteAllFilteredNotification":e.archive=b.filterValues.archive,b._notificationDriver.emit("deleteAllFilteredNotification",e);break;case"unsubscribe":b._notificationDriver.emit("unsubscribe",e);break;case"NotifCenterOpened":b._notificationDriver.emit("NotifCenterOpened",e.blockAlert);break;case"resetNotifications":b._notificationDriver.emit("resetNotifications",b.blockAlert);break;case"filter":for(var i=[],n=0;n<e.values.what.length;n++)i.push(e.values.what[n]);0===i.length&&(i[0]=" "),b.filterValues={msg:i,first_date:b.getFormattedDate(new Date(e.values.first_date)),last_date:b.getFormattedDate(new Date(e.values.last_date)),tenants:e.values.tenants,whoSettings:e.values.whoSettings,archive:e.values.archive},b.isFiltered=!0,b._notificationDriver.emit("filter",b.filterValues);break;case"notifyBrowser":var o=e.titleNotif||"3DSwym Conversations",s=e.textNotif,r=b.swymServer||b.getServiceUrl({name:"3dswym",platformId:e.tenant}),c=r&&e.login?r+"/api/user/getpicture/login/"+e.login+"/format":"./resources/en/1/webapps/NotifAlertBox/assets/icons/notifIcon.png";b.notifyWeb(e.tag,o,{ICON:c},s,"en",!1,function(){t.log("browser notif has been clicked"),window.focus(),this.close()});break;case"getMerge":b._notificationDriver.emit("getMerge",{id:e.id,groupID:e.groupID,toBeActioned:e.toBeActioned,archive:b.isFiltered&&b.filterValues.archive});break;case"getTenantAgnosticMode":b._notificationDriver.emit("getTenantAgnosticMode",e);break;case"updateTenantAgnosticMode":b._notificationDriver.emit("updateTenantAgnosticMode",e);break;case"closeNotifCenter":b.frame&&"notification"===b.frame._visibleApp&&b.frame.closePanel("right");break;case"resetFilter":b.isFiltered=!1;break;default:t.log("Unknown action published on 3dnotifinterne : "+e.action)}},InitPushTo3dNotif:function(t){var e;a.subscribe(t,function(t){switch(t.method){case"pushplatformid":t.data&&"3dswym"===t.data.provider.toLowerCase()&&b._notificationDriver.emit("getTokens",t.data.data);break;case"registerTenantApp":t.data&&(e=t.data.provider.toLowerCase()),e&&(b.listOfTenantApp[e]||(b.listOfTenantApp[e]=[])),b.listOfTenantApp[e].push(t.data.data);break;case"unregisterTenantApp":t.data&&(e=t.data.provider.toLowerCase()),e&&b.listOfTenantApp[e]&&b.listOfTenantApp[e].splice(b.listOfTenantApp[e].indexOf(t.data.data),1)}})},requestProxyTicket:function(t){var e=this.passportUrl+"/login?service=INTF",i=this.tenantAgnosticPassportUrl+"/login?service=INTF";b._notificationDriver.activeConnection({login:t.login,currentLanguage:t.currentLanguage,tenant:t.tenant,iamUrl:e,tenantAgnosticIamUrl:i,notifServer:b.notifServer})},computeAlertBox:function(t,e,i){var n;if(e.ICON?"appID"===e.ICON.type?(i=!0,n=e.ICON.data,e.ICON=this.getAppInfos({appID:e.ICON.data},!0),e&&!e.ICON&&(e.ICON=this.listOfAppw[n])):e.ICON=this.getIconInfo(e):i=!1,t.actions)for(var s=0;s<t.actions.length;s++){var a=t.actions[s];if(a.options&&a.options.event&&("url"===a.options.event.type||"UI"===a.options.event.type)){var r=a.options.event;if(a.options&&a.options.event&&"UI"===a.options.event.type){var c=a.options.event.options;if(c.attachments&&c.attachments.length>0)for(var l=0;l<c.attachments.length;l++)"button"===c.attachments[l].type&&(r=c.attachments[l].options.event)}if(r.options&&r.options.service&&r.options.uri){var d=this.getServiceUrl({name:r.options.service,platformId:e.PLATFORMID});r.options.url=d+r.options.uri,"USASWYM_AP"===e.APPID&&(r.options.csrf=d+"/api/index/tk/")}else if("select"===a.type&&r.options&&r.options.length>0)for(var f=0;f<r.options.length;f++){d=this.getServiceUrl({name:r.options[f].service,platformId:e.PLATFORMID});r.options[f].url=d+r.options[f].uri,"USASWYM_AP"===e.APPID&&(r.options[f].csrf=d+"/api/index/tk/")}}}return new o({id:e.ID,img:e.ICON,text:t.nls.msg,options:t.actions,appIconBorder:i,listOfService:this.listOfService,readState:!1,isInNotifCenter:!1,actioned:!1,provider:e.APPID,refresh:e.REFRESH,platformId:e.PLATFORMID?e.PLATFORMID:"",appName:this.appName,currentTenant:this.tenant})},getIconInfo:function(t){if(t.ICON){if("url"===t.ICON.type){if(!t.ICON.data.service)return t.ICON.data;if(t.PLATFORMID){for(var e=0;e<b.listOfService.length;e++)if(b.listOfService[e].platformid===t.PLATFORMID)return b.listOfService[e][t.ICON.data.service.toLowerCase()]+t.ICON.data.uri}else for(var i in b.listOfService[0])if(t.ICON.data.service.toLowerCase()===i.toLowerCase())return b.listOfService[0][i]+t.ICON.data.uri}else if("login"===t.ICON.type){if(t.PLATFORMID)for(var n=0;n<b.listOfService.length;n++)if(b.listOfService[n].platformid===t.PLATFORMID){b.swymServer=b.listOfService[n]["3dswym"];break}return b.swymServer+"/api/user/getpicture/login/"+t.ICON.data+"/format"}}else t.ICON="./resources/en/1/webapps/NotifAlertBox/assets/icons/notifIcon.png"},authenticated:function(){t.log("3DNotification : socket connected !")},authenticate_error:function(e){t.log("3DNotification : socket error :"+JSON.stringify(e))},token_registered:function(){t.log("3DNotification : token registred !")},token_registered_error:function(e){t.log("3DNotification : token registred error"+JSON.stringify(e))},updateBadge:function(t){b.blockAlert||void 0!==t.badge&&(b.topBar.setBadge("notification",t.badge),b.badge=t.badge)},refreshCenterView:function(){a.publish("3dnotifinterne",{action:"refreshCenterView"})},setSetting:function(t){a.publish("3dnotifinterne",{action:"setSetting",setting:t.setting})},setSettings:function(e){for(var i=[],n=0;n<e.settings.length;n++)-1===i.indexOf(e.settings[n].APPID)&&i.push(e.settings[n].APPID);d.getAppsInfo({data:i,onComplete:function(i){if(t.log(i),i){for(var n,o,s=[],r=0;r<e.settings.length;r++){n=0===r?null:e.settings[r-1].APPID,o=r===e.settings.length-1?null:e.settings[r+1].APPID;for(var c=0;c<i.length;c++)e.settings[r].APPID!==i[c].id||e.settings[r].APPID!==n&&e.settings[r].APPID!==o||s.push({id:e.settings[r].ID,name:e.settings[r].NAME,serviceName:i[c].title,service:i[c].id,icon:i[c].icon,subscribe:e.settings[r].SUBSCRIBE,notif_by_ui:e.settings[r].NOTIF_BY_UI,notif_by_email:e.settings[r].NOTIF_BY_EMAIL,notif_by_browser:e.settings[r].NOTIF_BY_BROWSER,unsubscribe_date:e.settings[r].UNSUBSCRIBE_DATE}),b.listOfAppw[i[c].id]=i[c].icon}s.sort(function(t,e){var i=t.serviceName.toLowerCase(),n=e.serviceName.toLowerCase();return i<n?-1:i>n?1:0}),a.publish("3dnotifinterne",{action:"setSettings",settings:s})}}})},checkRegisteredApp:function(t,e,i){return!this.listOfTenantApp[t]||!this.listOfTenantApp[t][e]||(a.publish("3dnotifexterneapi",{action:"getCurrentConversation"}),!1)},refreshForRollback:function(){a.publish("3dnotifinterne",{action:"refreshForRollback"})},setUnreadTotal:function(t){var e=JSON.parse(t.unread);e&&a.publish("3dnotifinterne",{action:"setUnreadTotal",unread:e[0].UNREAD})},setFilteredTotal:function(t){void 0!==t.count&&a.publish("3dnotifinterne",{action:"setFilteredTotal",count:t.count,notifications:t.notifications})},setStarredTotal:function(t){var e=JSON.parse(t.starred);e&&a.publish("3dnotifinterne",{action:"setStarredTotal",starred:e[0].STARRED})},setHistory:function(t){a.publish("3dnotifinterne",{action:"setHistory",notifications:t.notifications,language:b.language,appName:b.appName,starred:t.action,currentTenant:b.tenant})},setMerge:function(t){a.publish("3dnotifinterne",{action:"setMerge",notifications:t.notifications,id:t.id,appName:b.appName,toBeActioned:t.toBeActioned,currentTenant:b.tenant})},setNotifications:function(t){a.publish("3dnotifinterne",{action:"setNotifications",notifications:t.notifications,appName:b.appName,currentTenant:b.tenant})},setDates:function(t){a.publish("3dnotifinterne",{action:"setDates",Dates:t})},setWhoSettings:function(t){a.publish("3dnotifinterne",{action:"setWhoSettings",settings:t})},setTenants:function(t){var e=JSON.parse(t.tenants),i=[];f.getPlatformServices({onComplete:function(t){for(var n=0;n<e.length;n++)for(var o=0;o<t.length;o++)e[n].PLATFORMID===t[o].platformId&&(e[n].displayName=t[o].displayName,i.push(e[n]));a.publish("3dnotifinterne",{action:"setTenants",tenants:JSON.stringify(i)})}})},setSubscribedState:function(t){a.publish("INTFSubscriptionTopic",{action:"setSubscribedState",state:t.state})},doSwymEvents:function(t){"contextChange"!=t.action&&"contextChangeResponse"!=t.action||(t.data&&t.data.containerId&&"conversation"==t.data.containerType?(b.swymContext=t.data.containerId,b._notifConvView.deleteBubblesFromConv(b.tenant,b.swymContext),b._notificationDriver.emit("syncSwymConvNotif",{platformId:b.tenant,communityId:b.swymContext})):b.swymContext=void 0)},notifySystem:function(e,i){var n,o=this;if(e&&e.message){var r=decodeURIComponent(escape(atob(e.message)));n=JSON.parse(r)}if(n){a.publish(n.actions[0].options.event.options.topic,n.actions[0].options.event.options.data),m.trackNotifSystem({eventAction:"notifySystem",eventLabel:"System notification",persDim:{pd1:n.actions[0].options.event.options.topic}});try{if(!this.isMobileApp&&this._notifConvView){var c=n.actions[0].options.event.options.data.external_app_id;if("3DSWYM"===c&&"INSTANT_MESSAGE"===n.actions[0].options.event.options.data.message_type){var l=n.actions[0].options.event.options.data.author.login;if(l&&l!==o.login){n.actions[0].options.event.options.data.message_uri;var d=n.actions[0].options.event.options.topic,f=(n.actions[0].options.event.options.data.subject_uri,n.actions[0].options.event.options.data.community_id),p=n.actions[0].options.event.options.data.community_type,u=n.actions[0].options.event.options.data.message_details.content;u&&(u=t.String.unescapeHTML(u));var g,h,v=n.actions[0].options.event.options.data.author.firstName+" "+n.actions[0].options.event.options.data.author.lastName;if(d=(d=d.substring(d.indexOf("_")+1,d.length)).substring(0,d.indexOf("_")),"3dswym"==o.appName?(g=o.getServiceUrl({name:o.appName,platformId:d}),h=g):"my3dexperience"==o.appName?(g=o.getServiceUrl({name:o.appName,platformId:d}),g+="/social",h=o.getServiceUrl({name:"3dswym",platformId:d})):(h=o.getServiceUrl({name:"3dswym",platformId:d}),g=h),g&&"dm"===p&&l!==a.getUser().login){var b=h+"/api/user/getpicture/login/"+l+"/format";b=s.proxifyUrl(b,{proxy:"passport"})||b;var w={platformId:d,communityId:f,userLogin:l,userName:v,infoTxt:u,pathPicture:b,events:{click:function(t){if(!o.isMobileApp&&t)window.open(g+"/#dm:"+f,"_blank").focus();else if(o.isMobileApp||("3dswym"==o.appName||"my3dexperience"==o.appName)&&d==o.tenant)a.publish("app.3DSwym",{action:"navigationRequest",data:{containerId:f,containerType:"conversation"},from:{app:"3DNotification",component:"conversationNotification"}});else{window.open(g+"/#dm:"+f,o.appName+d).focus()}m.trackNotifSystem({eventAction:"notifySystem",eventLabel:"Bubble notification",persDim:{pd1:o.appName,pd2:c,pd3:v}})}}};if(("dm"===p||o.tenantAgnosticMode||d&&o.tenant&&d.toLowerCase()==o.tenant.toLowerCase())&&o.swymContext!=f?this._notifConvView.addNotification(w):t.log("3DNotification: 3DSwym context prevented bubble display"),!i)if("Notification"in window){if("dm"===p||o.tenantAgnosticMode||d&&o.tenant&&d.toLowerCase()==o.tenant.toLowerCase()){var N=function(){o.notifyWeb(e.tag,"3DSwym Conversations",{ICON:h+"/api/user/getpicture/login/"+l+"/format"},u,"en",!1,function(){window.open(g+"/#dm:"+f,"_self").focus()})};"granted"===Notification.permission?N():"denied"===Notification.permission&&"default"!==Notification.permission||Notification.requestPermission(function(t){"granted"===t&&N()})}}else t.log("This browser does not support desktop notification")}}}}}catch(t){console.log("3DNotification - Error : "+JSON.stringify(t))}}},notifyCenter:function(t){b.addNotification(t)},readNotification:function(t){a.publish("3dnotifinterne",{action:"read",params:{id:t.id,read:t.read,scope:t.scope||null,starred:t.starred,starredState:t.param}})},deleteNotification:function(t){a.publish("3dnotifinterne",{action:"delete",params:{id:t.id,read:t.read}})},notify:function(t){var e=decodeURIComponent(escape(window.atob(t.MESSAGE))),i=JSON.parse(e),n=!0,o=!0;if(b.isFiltered)if(t.CREATION_DATE>=b.filterValues.first_date&&t.CREATION_DATE<=b.filterValues.last_date)for(var s=0;s<b.filterValues.tenants.length;s++)if(t.PLATFORMID===b.filterValues.tenants[s])for(var a=0;a<b.filterValues.msg.length;a++){if(-1!==JSON.stringify(i).search(b.filterValues.msg[a])){n=!0;break}n=!1}else n=!1;else n=!1;if(n){if(!b.blockAlert){var r=b.computeAlertBox(i,t,!1);b.addItem(r),o=!1}t.NOTIFBROWSER&&b.notifyWeb(t.tag,"3DEXPERIENCE Platform Notification",t,i.nls.msg,b.language,o),b.addNotification(t)}},extractDomain:function(t){var e;return(e=t.indexOf("://")>-1?t.split("/")[2]:t.split("/")[0]).indexOf(":")>-1?e:e+":443"},getFormattedDate:function(t){var e=t.getFullYear(),i=(1+t.getMonth()).toString();i=i.length>1?i:"0"+i;var n=t.getDate().toString();return e+"-"+i+"-"+(n=n.length>1?n:"0"+n)},notifyWeb:function(e,i,n,o,s,a,r){var c;if(c=a?b.getIconInfo(n):n.ICON,"granted"===Notification.permission&&document.hidden){t.log("3DNotification Browser notification"),o=o.replace(/<(?!\strong)[^>]*>/gi,"");var l=new Notification(i,{lang:s,body:o,icon:c,tag:e});l.onclick=function(t){if(t.preventDefault(),r)r();else{l.close();var e=window.open("","notification");e.focus(),e.close()}};setTimeout(function(){l.close()},5e3)}},deleteSwymConvNotif:function(t){t&&this._notifConvView.deleteBubblesFromConv(t.platformId,t.communityId,t.login)},setTenantAgnosticMode:function(t){t&&(a.publish("3dnotifinterne",{action:"setTenantAgnosticMode",tenantAgnosticMode:t.tenantAgnosticMode,hidePlatformSelection:t.hidePlatformSelection}),this.tenantAgnosticMode=t.tenantAgnosticMode)}})});