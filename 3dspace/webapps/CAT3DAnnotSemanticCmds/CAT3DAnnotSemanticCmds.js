/*!  Copyright 2016 Dassault Systemes. All rights reserved. */
define("DS/CAT3DAnnotSemanticCmds/CAT3DAnnotSemanticSolveAttrLinkCmd",["UWA/Class","DS/ENOCollabSharingCmds/commands/EditPropCmd/EditPropCmdBase"],function(t,e){"use strict";return t.extend(e,{init:function(t){this._parent(t,{mode:"shared",isAsynchronous:!0}),this.setRepeatMode(!1)}})}),define("DS/CAT3DAnnotSemanticCmds/CAT3DAnnotSemanticAttrBrowserCmd",["DS/ApplicationFrame/CommandCheckHeader","DS/PADUtils/PADContext","DS/CAT3DAnnotationAttributeController/CAT3DAnnotationAttributeController"],function(t,e,n){"use strict";return t.extend({init:function(t){this._parent(t,{});var i,o=this,a=this.onStateChange(function(){i||(i=e.get()),n.get3DAnnotAttrBrowserController({context:i}).setActiveState(o.getState()),localStorage.setItem("CAT3DAnnotSemanticAttrBrowserCmd",o.getState()?"true":"false")}),r=this._destroy;this._destroy=function(){i&&n.unreference3DAnnotAttrBrowserController({context:i}),o._modelEvents.unsubscribe(a),r.call(o)},this.setState("false"!==localStorage.getItem("CAT3DAnnotSemanticAttrBrowserCmd"),!0)},_destroy:function(){this._parent()}})}),define("DS/CAT3DAnnotSemanticCmds/CAT3DAnnotSemanticCmds",[],function(){}),define("DS/CAT3DAnnotSemanticCmds/CAT3DAnnotSemanticShowRelatedAnnotCmd",["DS/ApplicationFrame/Command","DS/Selection/CSOManager","DS/Selection/HSOManager","DS/PADUtils/PADContext","DS/CAT3DAnnotationController/CAT3DAnnotationController"],function(t,e,n,i,o){"use strict";return t.extend({init:function(t){this._parent(t,{mode:"shared",isAsynchronous:!0}),this.setRepeatMode(!1)},beginExecute:function(){var t=function(t){if(!t)return null;var e=void 0!==t.getLastElement(!0).getAnnotationID?t.getLastElement(!0).getAnnotationID():null,n=t.getParentPath().getParentPath();if(!n.getLastElement(!0).getAnnotationClassType||"tpsAnnotationSet"!==n.getLastElement(!0).getAnnotationClassType())return null;var i,o,a=null,r=n.getChildrenPathes();for(i=0;i<r.length;i++)if("RootViews"===r[i].getLastElement(!0).getAnnotationType()){a=r[i];break}if(a){var s=a.getChildrenPathes();for(i=0;i<s.length;i++){var l=s[i].getLastElement(!0).getTPSList();if(l&&l.length)for(o=0;o<l.length;o++)if(l[o]===e)return s[i]}}},n=e.get();n.length||this.end(),this.ctxBarPosition=this.getFrameWindow().getContextualUIManager().getContextualBar().getPosition(),this.ctxBarPosition=this.ctxBarPosition?{x:this.ctxBarPosition.x,y:this.ctxBarPosition.y}:{x:0,y:0};var a,r,s,l=i.get(),h=o.giveAnnotationController({context:l}),g=[],c=[];for(a=0;a<n.length;a++){var d=h.getPontingAnnotations(n[a].pathElement);if(d&&d.length)for(r=0;r<d.length;r++){g.push(d[r]);var m=t(d[r]);m&&m.getLastElement(!0).isVisible()&&-1===g.indexOf(m)&&g.push(m);var A=d[r].getParentPath().getParentPath();-1===c.indexOf(A)&&c.push(A)}}if(c&&c.length)for(a=0;a<c.length;a++){var C=c[a].getChildrenPathes();for(r=0;r<C.length;r++){var u=C[r].getChildrenPathes();for(s=0;s<u.length;s++)u[s].getLastElement(!0).setVisibility(!1)}}if(g&&g.length)for(a=0;a<g.length;a++)g[a].getLastElement(!0).setVisibility(!0);this.end()},endExecute:function(){for(var t=e.get(),i=[],o=0;o<t.length;o++)i.push({pathElement:t[o].pathElement.clone()});e.empty(),n.empty(),e.add(i),n.add(i),this.getFrameWindow().getContextualUIManager().showContextualBar({hideWithDistance:!0,x:this.ctxBarPosition.x,y:this.ctxBarPosition.y}),this.getFrameWindow().getViewer().render(),this.ctxBarPosition=null}})}),define("DS/CAT3DAnnotSemanticCmds/CAT3DAnnotSemanticShowGeomAttachCmd",["DS/ApplicationFrame/Command","DS/Selection/CSOManager","DS/Selection/HSOManager"],function(t,e,n){"use strict";return t.extend({init:function(t){this._parent(t,{mode:"shared",isAsynchronous:!0}),this.setRepeatMode(!1)},beginExecute:function(){var t=e.get();t.length||this.end(),this.ctxBarPosition=this.getFrameWindow().getContextualUIManager().getContextualBar().getPosition(),this.ctxBarPosition=this.ctxBarPosition?{x:this.ctxBarPosition.x,y:this.ctxBarPosition.y}:{x:0,y:0};for(var n=0;n<t.length;n++)if(t[n].pathElement.getLastElement(!0).isVisible()){var i=t[n].pathElement.getLastElement(!0).getGeometricalAttachmentList();if(i&&i.length)for(var o=t[n].pathElement.getParentPath().getParentPath().getLastElement(!0).children,a=0;a<o.length;a++)if("RootViews"!==o[a].getAnnotationType()&&"RootCaptures"!==o[a].getAnnotationType()&&"RootGeometries"!==o[a].getAnnotationType())for(var r=o[a].children,s=0;s<r.length;s++){-1===i.indexOf(r[s].getAnnotationID())||r[s].isVisible()||r[s].setVisibility(!0)}}this.end()},endExecute:function(){for(var t=e.get(),i=[],o=0;o<t.length;o++)i.push({pathElement:t[o].pathElement.clone()});e.empty(),n.empty(),e.add(i),n.add(i),this.getFrameWindow().getContextualUIManager().showContextualBar({hideWithDistance:!0,x:this.ctxBarPosition.x,y:this.ctxBarPosition.y}),this.getFrameWindow().getViewer().render(),this.ctxBarPosition=null}})}),define("DS/CAT3DAnnotSemanticCmds/CAT3DAnnotSemanticWidgetDefaultCmd",["DS/CAT3DAnnotationCommands/CAT3DAnnotationWidgetDefaultCmd"],function(t){"use strict";return t.extend({init:function(t){var e=t||{};e.annotControllerLib="DS/CAT3DAnnotSemanticController/CAT3DAnnotSemanticContInstance",this._parent(e)}})});