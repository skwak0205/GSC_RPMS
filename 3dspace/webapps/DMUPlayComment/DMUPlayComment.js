define("DS/DMUPlayComment/DMUSelectPreviousCommentCmd",["DS/ApplicationFrame/Command","DS/DMUBaseUIControllers/DMUCommentsController"],function(e,t){"use strict";return e.extend({init:function(e){e.mode="shared",this._parent(e);var n=this;this._parentBeginExecute=this.beginExecute,this.beginExecute=function(){this._parentBeginExecute();var e=t.giveDMUCommentsController({context:n.getFrameWindow()});e&&e.selectNextOrPreviousComment(!1),n.end()}}})}),define("DS/DMUPlayComment/DMUCommentImport",["UWA/Class"],function(e){"use strict";return e.extend({init:function(e){this.importData=function(t,n,i){t&&n&&e&&(n.fillObjectAttributes(e,t,i),n.registerForPostImport(e))},this.afterImport=function(){if(e){for(var t=e;t&&"DMUMarkup"!==t.getType();)t=t.getParent();e.fireEvent("onDMUObjectInitialized",{dmuObject:e,dmuCont:t})}}}})}),define("DS/DMUPlayComment/DMUSelectNextCommentCmd",["DS/ApplicationFrame/Command","DS/DMUBaseUIControllers/DMUCommentsController"],function(e,t){"use strict";return e.extend({init:function(e){e.mode="shared",this._parent(e);var n=this;this._parentBeginExecute=this.beginExecute,this.beginExecute=function(){this._parentBeginExecute();var e=t.giveDMUCommentsController({context:n.getFrameWindow()});e&&e.selectNextOrPreviousComment(!0),n.end()}}})}),define("DS/DMUPlayComment/DMUComment",["require","exports","DS/DMUPlayComment/DMUCommentImport","DS/DMUBaseExperience/DMUContextManager","DS/Selection/CSOManager","DS/DMUBaseReview/DMUOverloadableObject","DS/DMUBaseUI/DMUNode3D"],function(e,t,n,i,o,r,s){"use strict";let a=[{name:"sOwner",type:"string",JSONname:"PropertiesCommentBase.Owner"},{name:"sTextContents",type:"string",JSONname:"PropertiesCommentBase.TextContents",defaultValue:[""]},{name:"fCreationDate",type:"float",JSONname:"PropertiesCommentBase.CreationDate"},{name:"fLastModificationDate",type:"float",JSONname:"PropertiesCommentBase.LastModificationDate"},{name:"sParentCommentId",type:"string",JSONname:"PropertiesComment.ParentCommentId"},{name:"lReplies",type:"listObjects",JSONname:"PropertiesComment.Replies",defaultValue:null}];return class extends r{constructor(e,t,r){super(e,t),this.addParameters(a);let m,l=this,u=r;const d="DS/DMUComment/DMUCommentContextualBar",g="Marker";let c;this.setAttribute("sType","Comment"),this.initAuthoringData=function(){-1!==i.getAuthoringFeatureTypes().indexOf(g)&&(-1===i.getAuthoringFeatureTypes().indexOf(g)||l.getSharedContextualMenuCommandList||window.require([d],function(e){let t=new e;l.getSharedContextualMenuCommandList=t.getSharedContextualMenuCommandList,l.getContextualMenuCommandList=t.getContextualMenuCommandList,t.register({frmWindow:l.getFrameWindow(),type:l.getType()});let n=1===o.get().length?o.get()[0].pathElement.clone():null;n&&n.getLastElement(!0).getDMUType&&n.getLastElement(!0)===l.getNode()&&(o.empty(),o.add({pathElement:n}))}))},this.removeAuthoringData=function(){-1!==i.getAuthoringFeatureTypes().indexOf(g)&&-1!==i.getAuthoringFeatureTypes().indexOf(g)&&window.require([d],function(e){let t=new e;l.getSharedContextualMenuCommandList=null,l.getContextualMenuCommandList=null,t.unregister({frmWindow:l.getFrameWindow()})})};let p=new n(l);this.importData=p.importData,this.afterImport=p.afterImport,this.initAuthoringData();let h=new s({frmWindow:this.getFrameWindow(),getType:this.getType});h.setPickParent(!0),this.setNode(h),this.setReadOnly(Boolean(r)),this.isExternal=function(){return Boolean(u)},this.setAlertFlag=function(e){e!==m&&(m=e,l.fireEvent("onDMUObjectVisuRefreshRequired",{dmuObject:l}))},this.hasAlertFlag=function(){return m},this.isReply=function(){return Boolean(l.getAttribute("sParentCommentId"))};let C=this.refreshNode;this.refreshNode=function(){let e=l.getNode();if(e&&(!t||!t.isImporting())){e.setName(l.getAttribute("sName"));let t=l.getActiveFlag()&&l.isDisplayed()&&l.isVisible();e.setVisibility(t),e.setVisibilityFree(!t),C()}},this.setAssociatedHighlightData=function(e){c=e,l.fireEvent("onDMUCommentAssociatedToHighlight",{dmuObject:l,highlightData:c})},this.getAssociatedHighlightData=function(){return c},this.importDeprecatedReplies=(e=>{let t=l.getAttribute("lReplies");if(t){t=t.slice();let n=e.getDMUComments().indexOf(l);t.forEach(function(t,i){l.getNode().removeChild(t.getNode()),t.setAttributes([{name:"sType",value:"Comment"},{name:"sParentCommentId",value:l.getAttribute("sUuid")}]),e.addDMUComment(t,n+1+i)}),l.setAttribute("lReplies",null)}}),this.deprecatedAddDMUReply=function(e,t){if(!e||!e.getType||"DMUComment"!==e.getType())return;let n=l.getAttribute("lReplies")||[];"number"==typeof t?n.splice(t,0,e):n.push(e),l.setAttribute("lReplies",n),e.getNode&&l.getNode().addChild(e.getNode()),l.fireEvent("onDMUObjectAddedInObject",{dmuObject:e,parentObject:l})}}}});