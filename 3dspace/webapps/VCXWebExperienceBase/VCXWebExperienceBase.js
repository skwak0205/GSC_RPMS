define("DS/VCXWebExperienceBase/VCXComponentOccurrenceExperience",["DS/VCXWebComponents/VCXWebComponentOccurrence"],function(e){"use strict";var t=e.extend({init:function(){this._parent(),this._tooltip="$(##Actor.Name)",this._hyperlinkID=-1,this._eFreeze=0}});return Object.defineProperty(t.prototype,"tooltip",{enumerable:!0,get:function(){return this._tooltip},set:function(e){this._tooltip=e}}),Object.defineProperty(t.prototype,"hyperlinkID",{enumerable:!0,get:function(){return this._hyperlinkID},set:function(e){this._hyperlinkID=e}}),Object.defineProperty(t.prototype,"eFreeze",{enumerable:!0,get:function(){return this._eFreeze},set:function(e){this._eFreeze=e}}),Object.defineProperty(t.prototype,"componentType",{enumerable:!0,get:function(){return"VCXComponentOccurrenceExperience"}}),t}),define("DS/VCXWebExperienceBase/VCXWebBaseKernelTools",[],function(){"use strict";Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null===this)throw new TypeError('"this" is null or not defined');var r=Object(this),n=r.length>>>0;if(0===n)return!1;for(var i=0|t,o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;){if(r[o]===e)return!0;o++}return!1}}),String.prototype.includes||(String.prototype.includes=function(e,t){return"number"!=typeof t&&(t=0),!(t+e.length>this.length)&&-1!==this.indexOf(e,t)})}),define("DS/VCXWebExperienceBase/VCXSceneGraphOverridesServices",["DS/SceneGraphOverrides/SceneGraphOverrideSet"],function(e){"use strict";return{createAndPushSceneGraphOverrideSet:function(t,r){var n=null,i=t.getManager("VCXContextManager").getRootNode();if(i&&(r||(r=t.getManager("VCXContextManager").getMainViewer()),r)){var o=r.getSceneGraphOverrideSetManager();n=new e(i),o.pushSceneGraphOverrideSet(n)}return n},removeSceneGraphOverrideSet:function(e,t,r){var n=!1;if(!e||!t)return n;if(r);else r=e.getManager("VCXContextManager").getMainViewer();r&&(r.getSceneGraphOverrideSetManager().removeSceneGraphOverrideSet(t),n=!0);return n},getSceneGraphOverride:function(e,t){var r=null;return e&&((r=e.getUniqueOverrideFromPathElement(t))||(r=e.createOverride(t))),r}}}),define("DS/VCXWebExperienceBase/VCXBaseDictionary",[],function(){"use strict";var e={VCXWebComponentOccurrence:{VCXIModifiable:"DS/VCXWebModifiablesImpl/VCXModifiableOccurrence",VCXIModifiableView:"DS/VCXWebModifiablesImpl/VCXModifiableViewOccurrence",VCXIVisibility:"DS/VCXWebVisibilityImpl/VCXVisibilityOccurrence",VCXIModelNavigable:"DS/WebApplicationBase/VCXAModelNavigable",W3AISGNodeHolder:"DS/WebApplicationBase/W3AASGNodeHolder"},VCXScenario:{VCXIModifiable:"DS/VCXWebModifiablesImpl/VCXModifiableScenario",VCXIModifiableView:"DS/VCXWebModifiablesImpl/VCXModifiableViewScenario",VCXIReadiness:"DS/WebApplicationBase/VCXAReadiness"},VCXScenarioSequence:{VCXIModifiable:"DS/VCXWebSequenceManager/VCXModifiableSequence",VCXIModifiableView:"DS/VCXWebModifiables/VCXModifiableView",VCXISensible:"DS/VCXWebComposer/VCXASensible"},VCXContextManager:{W3AIManager:"DS/WebApplicationBase/W3AAManager"},VCXAnalyticsTrackerBaseManager:{W3AIManager:"DS/WebApplicationBase/W3AAManager"},VCXScenarioManager:{VCXIModifiable:"DS/VCXWebScenarioManager/VCXModifiableScenarioManager",VCXIModifiableView:"DS/VCXWebModifiables/VCXModifiableView",W3AIManager:"DS/WebApplicationBase/W3AAManager"},VCXSequenceManager:{W3AIManager:"DS/WebApplicationBase/W3AAManager"},VCXDocManager:{VCXIModifiable:"DS/VCXWebModifiablesImpl/VCXModifiableDocManager",VCXIModifiableView:"DS/VCXWebModifiables/VCXModifiableView",W3AIManager:"DS/WebApplicationBase/W3AAManager"},VCXCommandManager:{VCXIModifiable:"DS/VCXWebModifiablesImpl/VCXModifiableCommandManager",VCXIModifiableView:"DS/VCXWebModifiables/VCXModifiableView",W3AIManager:"DS/WebApplicationBase/W3AAManager"},VCXMetaPropertyManager:{W3AIManager:"DS/WebApplicationBase/W3AAManager"},VCXLinkedPropertyManager:{W3AIManager:"DS/WebApplicationBase/W3AAManager"},VCXUnitManager:{VCXIModifiable:"DS/VCXWebUnits/VCXUnitManagerModifiable",VCXIModifiableView:"DS/VCXWebModifiables/VCXModifiableView",W3AIManager:"DS/WebApplicationBase/W3AAManager"},VCXModelChangeListener:{W3AIManager:"DS/WebApplicationBase/W3AAManager"}},t={VCXIModifiable:"DS/VCXWebModifiables/VCXIModifiable",VCXIModifiableView:"DS/VCXWebModifiables/VCXIModifiableView",VCXIVisibility:"DS/VCXWebVisibility/VCXIVisibility",W3AISGNodeHolder:"DS/WebApplicationBase/W3AISGNodeHolder",W3AIManager:"DS/WebApplicationBase/W3AIManager",VCXIModelNavigable:"DS/WebApplicationBase/VCXIModelNavigable"},r={VCXScenario:"DS/VCXKeyFramer/VCXScenario",VCXScenarioSequence:"DS/VCXWebSequenceManager/VCXScenarioSequence",VCXWebComponentOccurrence:"DS/VCXWebComponents/VCXWebComponentOccurrence",VCXDocManager:"DS/VCXWebExperienceBase/VCXDocManager",VCXScenarioManager:"DS/VCXWebScenarioManager/VCXScenarioManager",VCXSequenceManager:"DS/VCXWebSequenceManager/VCXSequenceManager",VCXCommandManager:"DS/VCXWebKernelCommands/VCXCommandManager",VCXContextManager:"DS/VCXWebExperienceBase/VCXContextManager",VCXAnalyticsTrackerBaseManager:"DS/VCXWebKernelTools/VCXAnalyticsTrackerBaseManager",VCXMetaPropertyManager:"DS/VCXWebModifiables/VCXMetaPropertyManager",VCXLinkedPropertyManager:"DS/VCXWebModifiables/VCXLinkedPropertyManager",VCXUnitManager:"DS/VCXWebUnits/VCXUnitManager",VCXModelChangeListener:"DS/VCXWebModifiables/VCXModelChangeListener"};return{GetDictionary:function(){return{interfaces:t,components:r,extensions:e}}}}),define("DS/VCXWebExperienceBase/VCXNLSManager",["UWA/Class"],function(e){"use strict";var t=e.extend({init:function(){this._NLSMap={}},initialize:function(){},unInitialize:function(){},GetNLS:function(e){return this._NLSMap[e]},AddNLS:function(e,t){this._NLSMap[e]=t}});return Object.defineProperty(t.prototype,"componentType",{enumerable:!0,get:function(){return"VCXNLSManager"}}),t}),define("DS/VCXWebExperienceBase/VCXPathElementTools",["UWA/Class","DS/Visualization/PathElement"],function(e,t){"use strict";return e.singleton({getMesh3dPathElements:function(e,r){var n=[];if(!e.externalPath||!e.externalPath.length)return n;"Mesh3D"===e.getLastElement().getNodeType()&&n.push(e);for(var i=new t,o=0;o<e.externalPath.length;++o)i.addElement(e.externalPath[o]);var a=i.getLastElement();for(o=0;o<a.children.length;++o){for(var s=!0,c=0;c<r.length;++c)if(r[c]===a.children[o].productType){s=!1;break}if(s){var l=i.clone();l.addElement(a.children[o]);var u=this.getMesh3dPathElements(l,r);u&&u.length&&(n=n.concat(u))}}return n},getLeafNameOfPathElement:function(e){if(!e)return"";var t=e.externalPath.length-1;if(t<0)return"";do{var r=e.externalPath[t].getName();if(r&&""!==r)return r;t-=1}while(t>0);return""},buildPathElement:function(e,t){if(!e)return null;for(var r=[],n=t;n&&e.getLastElement()&&n.id!==e.getLastElement().id;)r.push(n),n=n.parents[0];for(var i=e.clone(),o=r.length-1;o>=0;--o)i.addElement(r[o]);return i}})}),define("DS/VCXWebExperienceBase/VCXModifiableViewOccurrenceExperience",["DS/VCXWebModifiablesImpl/VCXModifiableViewOccurrence","DS/VCXWebProperties/VCXPropertyGroup","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables"],function(e,t,r){"use strict";return e.extend({init:function(){this._parent()},getPropertyGroups:function(e){e||(e={}),this._parent(e);var n=this.getGroupPropertiesOrders();e["Group.Actions"]||(e["Group.Actions"]=new t({groupID:"Group.Actions"}),e["Group.Actions"].i18nGroup=r),e["Group.Actions"].setPropertiesOrder(n["Group.Actions"]),e["Group.Actions"].priority=50,e["Group.Actions"].addProperty({propertyName:"Actor.Hyperlink",i18n:r});var i=this.GetObject().QueryInterface("VCXIPulseBehavior");return i&&i.getPropertyGroups(e),e},getGroupPropertiesOrders:function(){var e={"Group.Actions":["Actor.Hyperlink"]},t=this.GetObject().QueryInterface("VCXIPulseBehavior");t&&(e["Group.Effect"]=t.getGroupPropertiesOrders());var r=this._parent()||{};return UWA.extend(r,e),r}})}),require(["DS/VCXWebExperienceBase/VCXWebBaseKernelTools"],function(e){}),define("DS/VCXWebExperienceBase/VCXExperienceBase",["DS/WebApplicationBase/WebApplicationBase","DS/VCXWebExperienceBase/VCXBaseDictionary","DS/VCXWebKernelCommands/VCXCmdChangeComponent"],function(e,t,r){"use strict";var n=e.extend({init:function(){this._parent()},initialize:function(e){return UWA.Promise.resolve().then(function(){return this.AddDictionaryDescription(t.GetDictionary())}.bind(this)).then(function(){if(e&&(e._experienceBase=this,e.addDictionaries))return e.addDictionaries()}.bind(this)).then(function(){var e=this.Factory.BuildComponent("VCXCommandManager");e.SetID("VCXCommandManagerID"),e.SetPersistency(1),this._ManagerSet.addManager("VCXCommandManager",e);var t=this.Factory.BuildComponent("VCXScenarioManager");t.SetID("VCXScenarioManagerID"),t.SetPersistency(1),this._ManagerSet.addManager("VCXScenarioManager",t);var n=this.Factory.BuildComponent("VCXDocManager");n.SetID("VCXDocManagerID"),n.SetPersistency(1),this._ManagerSet.addManager("VCXDocManager",n);var i=this.Factory.BuildComponent("VCXContextManager");i.SetID("VCXContextManagerID"),i.SetPersistency(1),this._ManagerSet.addManager("VCXContextManager",i);var o=this.Factory.BuildComponent("VCXMetaPropertyManager");o.SetID("VCXMetaPropertyManagerID"),o.SetPersistency(1),this._ManagerSet.addManager("VCXMetaPropertyManager",o);var a=this.Factory.BuildComponent("VCXLinkedPropertyManager");a.SetID("VCXLinkedPropertyManagerID"),a.SetPersistency(1),this._ManagerSet.addManager("VCXLinkedPropertyManager",a);var s=this.Factory.BuildComponent("VCXUnitManager");s.SetID("VCXUnitManagerID"),s.SetPersistency(1),this._ManagerSet.addManager("VCXUnitManager",s);var c=this.Factory.BuildComponent("VCXModelChangeListener");c.SetID("VCXModelChangeListenerID"),c.SetPersistency(1),this._ManagerSet.addManager("VCXModelChangeListener",c);var l=this.Factory.BuildComponent("VCXSequenceManager");l.SetID("VCXSequenceManagerID"),l.SetPersistency(1),this._ManagerSet.addManager("VCXSequenceManager",l);var u=new r(this.getManager("VCXCommandManager"),this.ComponentsMap);u.AddComponents([e,t,n,i,o,a,l]),this.getManager("VCXCommandManager").Do(u),this._bModifiablesAdvancedProperties=!1}.bind(this))},Clean:function(){this._parent()}});return Object.defineProperty(n.prototype,"ModifiablesAdvancedProperties",{enumerable:!0,get:function(){return this._bModifiablesAdvancedProperties},set:function(e){this._bModifiablesAdvancedProperties=e}}),Object.defineProperty(n.prototype,"isValid",{enumerable:!0,get:function(){return this._ManagerSet&&this._ManagerSet._loopReady}}),n}),define("DS/VCXWebExperienceBase/VCXDocManager",["DS/CoreEvents/Events","UWA/Class","DS/VCXWebProperties/VCXPropertyValuePath","DS/VCXWebProperties/VCXPropertyValueInt","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueLink","DS/VCXWebProperties/VCXPropertyValueDocId","DS/VCXWebProperties/VCXPropertyValueHyperlinkId","DS/VCXWebProperties/VCXPropertyValueBoolean","DS/VCXWebKernelCommands/VCXCmdChangeNeutralProperties"],function(e,t,r,n,i,o,a,s,c,l){"use strict";var u=t.extend({initialize:function(){this._map=[],this._defaultImageIdx=-1,this.actorDocManager=null,this._initializingResMan=!1,this._promisesMap={}},_addUrl:function(e,t){console.log("resName : "+t),console.log("resolveAsset OK"),console.log("url = "+e);var a=new r,s=0;if(-1!=e.search("KeyFramer://")&&(e=e.substring("KeyFramer://".length)),-1!=e.search("play://"))s=0;else if(-1!=e.search("scenario://"))s=0;else if(-1!=e.search("GoToScenario://")){s=1;var l=e.substring("GoToScenario://".length);(u=new o).SetValue(l),a.SetValueLink(u),e=""}else if(-1!=e.search("PlayFromMarker://")){s=2;l=e.substring("PlayFromMarker://".length);(u=new o).SetValue(l),a.SetValueLink(u),e=""}else if(-1!=e.search("PlayScenario://")){s=2;l=e.substring("PlayScenario://".length);(u=new o).SetValue(l),a.SetValueLink(u),e=""}else if(-1!=e.search("GoToMarker://")){s=3;l=e.substring("GoToMarker://".length);(u=new o).SetValue(l),a.SetValueLink(u),e=""}else if(-1!=e.search("PlayUntilMaker://[Current position]"))s=4,e="[Current position]";else if(-1!=e.search("PlayMakerSequence://")){s=4;l=e.substring("PlayMakerSequence://".length);(u=new o).SetValue(l),a.SetValueLink(u),e=""}else if(-1!=e.search("PlayScenarioUntilMaker://")){s=4;var u;l=e.substring("PlayScenarioUntilMaker://".length);(u=new o).SetValue(l),a.SetValueLink(u),e=""}var p=new n;p.SetValue(s),a.SetPathType(p);var d=new c;d.SetValue(!0),a.SetValueBool(d);var h=new i;h.SetValue(e),a.SetValueURL(h),this.AddOrModifyDoc(a,void 0,parseInt(t))},addResourcesFromResManager:function(e){var t=this,o=e.QueryInterface("CATI3DExperienceObject");if(o){var a=o.GetValueByName("_varName"),s=e.GetObject().GetType(),l=e.QueryInterface("CATI3DXPictureResourceAsset");if(l)return l.getPicture().then(function(e){var o=e.src;console.log("resName : "+a),console.log("resolveAsset OK"),console.log("url = "+o);var s=new r,l=new n;l.SetValue(0),s.SetPathType(l);var u=new c;u.SetValue(!0),s.SetValueBool(u);var p=new i;return p.SetValue(o),s.SetValueURL(p),t.AddOrModifyDoc(s,void 0,parseInt(a)),UWA.Promise.resolve()});var u=e.QueryInterface("CATI3DXURLResourceAsset");if(u)return u.getURL().then(function(e){return this._addUrl(e,a),UWA.Promise.resolve()}.bind(this));if(u=e.QueryInterface("CATI3DXKeyframerResourceAsset"))return u.getKey().then(function(e){return this._addUrl(e,a),UWA.Promise.resolve()}.bind(this));let p="ERROR : addResourcesFromResManager "+a+" type = "+s;return console.log(p),UWA.Promise.reject(new Error(p))}return UWA.Promise.reject(new Error("ERROR : CATI3DExperienceObject for resource"))},initFromResourcesManager:function(){var e=this;return this._initializingResMan=!0,UWA.Promise.resolve().then(function(){console.log("Initialization of DocManager from ResourceManager");var t=[],r=e._experienceBase.getManager("VCXContextManager").getRootComponent().QueryInterface("CATICXPResourcesMgr");if(r){var n=r.ListResources();console.log("NbRes in ResManager :"+n.length);for(var i=0;i<n.length;i++)t.push(e.addResourcesFromResManager(n[i]))}else console.log("CATICXPResourcesMgr FAILED");return UWA.Promise.allSettled(t)}).then(function(){e._initializingResMan=!1})},initActorDocManager:function(){if(this.actorDocManager)return UWA.Promise.resolve();console.log("First creation a ActorDocManager");var e=this;if(e._experienceBase.getManager("VCXCAT3DXModelManager")&&!e._experienceBase.getManager("VCXContextManager").IsLocalMode()){var t=e._experienceBase.getManager("VCXContextManager").getRootComponent();return t?e._experienceBase.getManager("VCXCAT3DXModelManager").CreateActor("VCXActorDocManager",void 0,t).then(function(t){return t?(e.actorDocManager=t,e.actorDocManager.QueryInterface("VCXIModifiable").GetProperties(),UWA.Promise.resolve()):UWA.Promise.reject(new Error("VCXActorDocManager not built !"))}):UWA.Promise.reject(new Error("Missing father experience !"))}return UWA.Promise.resolve()},unInitialize:function(){this._map=[],this._defaultImageIdx=-1,this._initializingResMan=!1,this._promisesMap={}},postInitialize:function(){},SetDefaultImageIndex:function(e){this._defaultImageIdx=e},GetDefaultImageIndex:function(){return this._defaultImageIdx},AddOrModifyDoc:function(t,r,n,i){if(null!==t){var o=this.AddOrModifyDocInt(t,r,n,i),s=new a;return s.SetValue(o),e.publish({event:"VCX_DOC_ADDED"}),s}console.log("DocManager::AddOrModifyDoc vcxPropPath NULL !!")},AddOrModifyDocInt:function(e,t,r,n){var i=this.HasDocInt(e),o=0;if(i>=0)o=i;else{if(void 0!==r&&r>=0)o=r;else for(;this._map[o];)o++;this._map[o]=e}if(this.actorDocManager)if(this._experienceBase.getManager("VCXContextManager").IsLocalMode()||!this._experienceBase.getManager("VCXContextManager").getUseResourcesManager())this.actorDocManager.AddDocToBase64Map(o,e,t);else if(!this._initializingResMan){if(n)return this.UpdatePersistentResourcesToEMS().then(function(){return o});console.warn("The method AddOrModifyDocInt is ASYNC."),this.UpdatePersistentResourcesToEMS()}return n?UWA.Promise.resolve(o):o},RemoveDocument:function(e){delete this._map[e],this.actorDocManager&&this.actorDocManager.RemoveDocument(e)},AddOrModifyHyperlink:function(t){var r=new s;if(null!==t){var n=this.AddOrModifyDocInt(t);r.SetValue(n),e.publish({event:"VCX_DOC_ADDED"})}else r.SetValue(-1);return r},HasDocInt:function(e){for(var t=-1,r=!1,n=0;n<this._map.length&&!r;n++){var i=this._map[n];e&&e.IsEqualTo(i)&&(r=!0,t=n)}return t},GetPropPath:function(e){return this._map[e]},IsEmpty:function(){return!(this._map.length>0)},NumberOfDoc:function(){return this._map.length},BuildPathFromString:function(e,t){if("string"==typeof e){var o=new r,a=new n;a.SetValue(0),o.SetPathType(a);var s=new i;if(s.SetValue(e),o.SetValueURL(s),e.indexOf("blob:")>=0){t||(t="");var c=new i;c.SetValue(t),o.SetFileName(c)}return o}console.log("DocManager: strData is empty !!")},BuildPathFromLink:function(e,t){var i=null;if(!e)return i;var a=new o;a.SetValue(e);var s=new n,c=1;return t&&(c=t),s.SetValue(c),(i=new r).SetPathType(s),i.SetValueLink(a),i},AddFileNameToDoc:function(e,t){if("undefined"!==e&&t){t.indexOf(".")<0&&(t="."+t);var r=e+t,n=this._map[e],o=n.GetFileName();o||(o=new i),o.SetValue(r),n.SetFileName(o)}},GetDocMapClone:function(){var e={};for(var t in this._map)if(this._map.hasOwnProperty(t)){var r=this._map[t];e[t]=r.Clone()}return e},UpdateResoucesToEMS:function(e){var t=this.GetPropPath(e);if(!t)return UWA.Promise.resolve();this._promisesMap[e]=!0;var r=this,n=this._experienceBase.getManager("VCXContextManager").getRootComponent().QueryInterface("CATICXPResourcesMgr");return UWA.Promise.resolve().then(function(){if(t.GetValueBool().GetValue()){console.log("############### UpdateResoucesToEMS for res = "+e);var i="";t.GetFileName()&&(i=t.GetFileName().GetValue()),console.log("### filename : ["+i+"]");var o,a=i.split(".").pop();""==a&&(a="jpg"),a=a.toLowerCase(),console.log("### extension : ["+a+"]");var s=t.GetValueURL().GetValue();if(console.log("### URL : ["+s+"]"),s.indexOf("blob:")>=0)o="CXPPictureResource_Spec";else{var c=t.GetPathType().GetValue();if(0==c)-1!=(s=t.GetValueURL().GetValue()).search("play://")?s="KeyFramer://"+s:-1!=s.search("scenario://")&&(s="KeyFramer://"+s);else if(1==c)s="KeyFramer://GoToScenario://"+t.GetValueLink().GetValue();else if(2==c){var l=t.GetValueLink().GetValue();(u=r._experienceBase.ComponentsMap.GetComponentFromID(l))?s="VCXComponentMarker"==u.GetType()?"KeyFramer://PlayFromMarker://"+l:"KeyFramer://PlayScenario://"+l:console.log("warning : scenario or marker unknown")}else if(3==c)s="KeyFramer://GoToMarker://"+t.GetValueLink().GetValue();else if(4==c){var u;if(""==(l=t.GetValueLink().GetValue()))s="KeyFramer://PlayUntilMaker://[Current position]";else(u=r._experienceBase.ComponentsMap.GetComponentFromID(l))?s="VCXComponentMarker"==u.GetType()?"KeyFramer://PlayMakerSequence://"+l:"KeyFramer://PlayScenarioUntilMaker://"+l:console.log("warning : scenario or marker unknown")}o=-1!=s.search("KeyFramer://")?"CXPKeyframerResource_Spec":"CXPURLResource_Spec"}var p=e.toString(),d=n.GetResourceByName(p);if(d){var h=d.GetType();if(o!=h)return console.log("CHANGING of RES TYPE -> Need to recreate resources with new type !"),n.DeleteResource(d).done(function(){return console.log("DeleteResource OK"),console.log("url = "+s),console.log("now creating :"+p),"CXPPictureResource_Spec"==o?n.CreateBinaryResource(p,s,a,!0).done(function(){console.log("CreateBinaryResource OK: "+p)}).catch(function(e){return console.log("CreateBinaryResource FAIL: "+p),UWA.Promise.reject(e)}):n.CreateURLResource(p,s).done(function(){console.log("CreateURLResource OK: "+p)}).catch(function(e){return console.log("CreateURLResource FAIL: "+p),UWA.Promise.reject(e)})}).catch(function(e){console.log("DeleteResource FAIL")});if("CXPPictureResource_Spec"==o){var g=d.QueryInterface("CATI3DXPictureResourceAsset");return g?g.getPicture().then(function(e){return e.src==s?(console.log("Resource not to be update: "+p),UWA.Promise.resolve()):n.UpdateBinaryResource(d,s,a,!0).done(function(){console.log("UpdateBinaryResource OK: "+p)}).catch(function(e){return console.log("UpdateBinaryResource FAIL: "+p),UWA.Promise.reject(e)})}):UWA.Promise.reject(o+" not implementing CATI3DXPictureResourceAsset")}var C=d.QueryInterface("CATI3DXURLResourceAsset");return C?C.getURL().then(function(e){return e==s?(console.log("Resource not to be update: "+p),UWA.Promise.resolve()):n.UpdateURLResource(d,s).done(function(){console.log("UpdateURLResource OK: "+p)}).catch(function(e){return console.log("UpdateURLResource FAIL: "+p),UWA.Promise.reject(e)})}):(C=d.QueryInterface("CATI3DXKeyframerResourceAsset"))?C.getKey().then(function(e){return e==s?(console.log("Resource not to be update: "+p),UWA.Promise.resolve()):n.UpdateURLResource(d,s).done(function(){console.log("UpdateURLResource OK: "+p)}).catch(function(e){return console.log("UpdateURLResource FAIL: "+p),UWA.Promise.reject(e)})}):UWA.Promise.reject(o+" not implementing CATI3DXURLResourceAsset or CATI3DXKeyframerResourceAsset")}return console.log("now creating :"+p),console.log("url = "+s),"CXPPictureResource_Spec"==o?n.CreateBinaryResource(p,s,a,!0).then(function(){console.log("CreateBinaryResource OK: "+p)}).catch(function(e){return console.log("CreateBinaryResource FAIL: "+p),UWA.Promise.reject(e)}):n.CreateURLResource(p,s).then(function(){console.log("CreateURLResource OK: "+p)}).catch(function(e){return console.log("CreateURLResource FAIL: "+p),UWA.Promise.reject(e)})}}).then(function(){delete r._promisesMap[e]}).catch(function(t){delete r._promisesMap[e],console.log(new Error(t))})},RemoveResourcesFromResMan:function(){for(var e=[],t=this._experienceBase.getManager("VCXContextManager").getRootComponent().QueryInterface("CATICXPResourcesMgr"),r=t.ListResources(),n=0;n<r.length;n++){var i=r[n],o=i.QueryInterface("CATI3DExperienceObject");if(o){var a=o.GetValueByName("_varName"),s=parseInt(a);this.GetPropPath(s)||(console.log("deleting resource : "+a),e.push(t.DeleteResource(i).done(function(){console.log("DeleteResource OK")}).catch(function(e){console.log("DeleteResource FAIL")})))}}return UWA.Promise.all(e)},UpdateResourcesManagerToEMS:function(){var e=this;if(this._experienceBase.getManager("VCXContextManager").getRootComponent().QueryInterface("CATICXPResourcesMgr"))return console.log("updating resource manager"),this.RemoveResourcesFromResMan().then(function(){for(var t=[],r=e.NumberOfDoc(),n=0;n<r;n++)e._promisesMap[n]||t.push(e.UpdateResoucesToEMS(n));return UWA.Promise.all(t)});var t=new Error("No ResourceManager !! CATICXPResourcesMgr failed : check your dictionnary");return console.error(t),UWA.Promise.reject(t)},RemoveActorDocManagerNeutrals:function(){var e=this.actorDocManager;if(e){var t=e.QueryInterface("VCXIModifiable");console.log("capturing neutral properties of actorDocManager"),this._experienceBase.getManager("VCXContextManager").IsLocalMode()||!this._experienceBase.getManager("VCXContextManager").getUseResourcesManager()||this._experienceBase.getManager("VCXScenarioManager").RemoveNeutrals(t.GetHashing());var r=new l(this._experienceBase.getManager("VCXScenarioManager"));r.CaptureNeutralProperties(t),r.Do()}},UpdatePersistentResourcesToEMS:function(){if(this._experienceBase.getManager("VCXContextManager").getUseResourcesManager()&&!this._experienceBase.odt){var e=this;return this.UpdateResourcesManagerToEMS().then(function(){return e.RemoveActorDocManagerNeutrals()})}return UWA.Promise.resolve()}});return Object.defineProperty(u.prototype,"componentType",{enumerable:!0,get:function(){return"VCXDocManager"}}),u}),define("DS/VCXWebExperienceBase/VCXContextManager",["DS/CoreEvents/Events","UWA/Class","DS/Visualization/Node3D","DS/WebappsUtils/WebappsUtils","DS/SceneGraphOverrides/SceneGraphOverrideSet","DS/Visualization/PathElement"],function(e,t,r,n,i,o){var a,s=t.extend({init:function(){this._showRoomMode=!1,this._playerMode=!1,this._openSMG=!1,this._openSMGXML=!1,this._cityMode=!1,this._prodHighMode=!1,this._ExperienceIn3DPlay=!1,this._ExperienceInGuidedTour=!1,this._ExperienceInConnectedPlayer=!1,this.useTraverseGraph=!1,this._trapSelectionPick=null,this._trapSelectionPrePick=null,this.setSupported("DisplayUI",!0),this.setSupported("DisplayUIAssemblyPanel",!0),this.setSupported("DisplayUIDressupsPanel",!0),this.setSupported("DisplayUIScenariosPanel",!0),this.setSupported("DisplayUIPropertiesPanel",!0),this.setSupported("Paper",!0),this.setSupported("PaperControlV2",!1),this.setSupported("PropertyPanelV2",!1),this.setSupported("Section",!1),this.setSupported("CameraDisplay",!0),this.setSupported("EnvironmentDisplay",!0),this.setSupported("Paths",!1),this.setSupported("DisplayPaperCtrlBtns",!0),this.setSupported("PaperVisible",!1),this.setSupported("FrameUnboxing",!1),this.setSupported("SimpleTapContextualMenu",!1),this.setSupported("PropAndScnPanelExpandOverride",!1),this.setSupported("ScenarioPanelExpand",!0),this.setSupported("PropertiesPanelExpand",!0),this._rootInfos={componentType:"VCXWebComponentOccurrence",productType:"Reference3D",name:"Experience",id:"VCX_Root"},this._openProduct=!1,this._openAmbience=!1,this._openMaterial=!1,this._simulatePlayMode=!1,this._applicationMode=s.EApplicationMode.FILE,this.InitApplicationMode()},initialize:function(){this._nRootNode=null,this._nPartsNode=null,this.viewers=[],this._UseOverrideSet=!0,this.getUseResourcesManager()||widget.setTitle("!!! NO RESOURCES MANAGER !!!")},postInitialize:function(){delete this._activeCamera,delete this._activeGround,delete this._activeViewport,delete this._currentWorkingRoot,delete this._activeBOM;var e=this.getMainViewer();e&&("boolean"!=typeof this._trapSelectionPick&&e.picking&&(this._trapSelectionPick=Boolean(e.picking.trapSelection)),"boolean"!=typeof this._trapSelectionPrePick&&e.pPicking&&(this._trapSelectionPrePick=Boolean(e.pPicking.trapSelection))),this.InitEventListeners(),this.traverseGraphMustBePerformed=!0},getUpdatePriority:function(){return-8},unInitialize:function(){if(this._SharedSceneGraphOverrideSet){var e=this.getMainViewer();if(e)e.getSceneGraphOverrideSetManager().removeSceneGraphOverrideSet(this._SharedSceneGraphOverrideSet);this._SharedSceneGraphOverrideSet=null}if(this.UnInitEventListeners(),this._nRootNode&&(this.isSupported("3DSync")||this._experienceBase.getManager("VCXContextManager").getMainViewer().removeNode(this._nRootNode),this._nRootNode=null,this._nPartsNode=null,this._pRootPathElement=null),this._currentWorkingRoot=null,this._activeCamera=null,this._activeGround=null,this._activeBOM=null,this._activeViewport=null,this._cRootComponent){var t=this._cRootComponent.QueryInterface("VCXIModelNavigable");t&&t.clear(),this._cRootComponent=null}this._playerMode=!1,this._openSMG=!1,this._openSMGXML=!1,this._cityMode=!1,this._prodHighMode=!1,this._showRoomMode=!1,this._ExperienceIn3DPlay=!1,this._ExperienceInConnectedPlayer=!1,this._trapSelectionPick=null,this._trapSelectionPrePick=null},isErrorTolerantMode:function(){var e=this.getUrlVars().ErrorTolerantMode;return void 0===e||"false"!==e},getUrlVars:function(){return s.getUrlVars()},isIE11:function(){return void 0!==document.body.style.msTextCombineHorizontal},useOverrideSet:function(e){this._UseOverrideSet=e},setPlayerMode:function(){this._playerMode=!0},getPlayerMode:function(){return this._playerMode},setOpenSMG:function(){this._openSMG=!0},getOpenSMG:function(){return this._openSMG},setOpenSMGXML:function(){this._openSMGXML=!0},getOpenSMGXML:function(){return this._openSMGXML},setSmgXmlRoot:function(e){this._smgXmlRoot=e},getSmgXmlRoot:function(){return this._smgXmlRoot},setCityMode:function(){this._cityMode=!0},getCityMode:function(){return this._cityMode},setProdHighMode:function(){this._prodHighMode=!0},getProdHighMode:function(){return this._prodHighMode},setSimulatePlayMode:function(){this._simulatePlayMode=!0,console.log("SET SIMULATE PLAY!")},getSimulatePlayMode:function(){return this._simulatePlayMode},setTrapSelectionRequirements:function(e){e&&("boolean"==typeof e.pick&&(this._trapSelectionPick=e.pick),"boolean"==typeof e.prePick&&(this._trapSelectionPrePick=e.prePick))},getTrapSelectionRequirements:function(){return{pick:this._trapSelectionPick,prePick:this._trapSelectionPrePick}},setExperienceIn3DPlay:function(){this._ExperienceIn3DPlay=!0},getExperienceIn3DPlay:function(){return this._ExperienceIn3DPlay},setExperienceInGuidedTour:function(){this._ExperienceInGuidedTour=!0},getExperienceInGuidedTour:function(){return this._ExperienceInGuidedTour},setExperienceInConnectedPlayer:function(){this._ExperienceInConnectedPlayer=!0},getExperienceInConnectedPlayer:function(){return this._ExperienceInConnectedPlayer},getIfStanAlonePlayerIsInDevMode:function(){var e=!1;return!this._ExperienceInConnectedPlayer&&this._ExperienceIn3DPlay&&"true"===localStorage.getItem("DS_Composer_Player_Standalone_DevMode")&&(e=!0),e},InitEventListeners:function(){a=this,this.event_VCX_PROPERTIES_CHANGED=e.subscribe({event:"VCX_PROPERTIES_CHANGED"},function(e){a.renderAll()}),this.event_VCX_MODIFIABLE_CHANGED=e.subscribe({event:"VCX_MODIFIABLE_CHANGED"},function(){a.renderAll({updateInfinitePlane:!0})}),this._animStarted=function(){a._experienceBase.getManager("VCXVisuManager").hideDecorations("Transition",a.getMainViewer()),a.applyToViewers(function(e){e.setGroundShadowAutomaticUpdate(!1)})},this._animStopped=function(){a.applyToViewers(function(e){e.setGroundShadowAutomaticUpdate(!0)}),a._experienceBase.getManager("VCXVisuManager").showDecorations("Transition",a.getMainViewer()),a.renderAll({updateInfinitePlane:!0})},this.event_VCX_BEGIN_TRANSITION=e.subscribe({event:"VCX_BEGIN_TRANSITION"},this._animStarted),this.event_VCX_START_PLAY=e.subscribe({event:"VCX_START_PLAY"},this._animStarted),this.event_VCX_END_TRANSITION=e.subscribe({event:"VCX_END_TRANSITION"},this._animStopped),this.event_VCX_STOP_PLAY=e.subscribe({event:"VCX_STOP_PLAY"},this._animStopped),this.event_VCX_PAUSE_PLAY=e.subscribe({event:"VCX_PAUSE_PLAY"},this._animStopped)},setShowRoomMode:function(){this._showRoomMode=!0},getShowRoomMode:function(){return this._showRoomMode},UnInitEventListeners:function(){a=null,e.unsubscribe(this.event_VCX_PROPERTIES_CHANGED),delete this.event_VCX_PROPERTIES_CHANGED,e.unsubscribe(this.event_VCX_MODIFIABLE_CHANGED),delete this.event_VCX_MODIFIABLE_CHANGED,e.unsubscribe(this.event_VCX_BEGIN_TRANSITION),delete this.event_VCX_BEGIN_TRANSITION,e.unsubscribe(this.event_VCX_START_PLAY),delete this.event_VCX_START_PLAY,e.unsubscribe(this.event_VCX_END_TRANSITION),delete this.event_VCX_END_TRANSITION,e.unsubscribe(this.event_VCX_STOP_PLAY),delete this.event_VCX_STOP_PLAY,e.unsubscribe(this.event_VCX_PAUSE_PLAY),delete this.event_VCX_PAUSE_PLAY,delete this._animStopped,delete this._animStarted},setFrameWindow:function(e){void 0===this.frameWindow&&(this.frameWindow=e),this.addViewer("MainViewer",this.getMainViewer())},getFrameWindow:function(){return this.frameWindow},getContext:function(){return this.getFrameWindow()&&this.getFrameWindow().options&&this.getFrameWindow().options.context},getUIFrame:function(){return this.getFrameWindow().getUIFrame()},getViewers:function(){return this.viewers},addViewer:function(t,r){r.viewerID=t,this.viewers||(this.viewers=[]),this.viewers.push(r),e.publish({event:"VCX_VIEWER_ADDED",data:{viewer:r}})},removeViewer:function(t){for(var r=0;r<this.viewers.length;r++)if(this.viewers[r].viewerID===t)return e.publish({event:"VCX_VIEWER_BEFORE_REMOVED",data:{viewer:this.viewers[r]}}),this.viewers[r]=null,void this.viewers.splice(r,1)},applyToViewers:function(e){if(e)for(var t=0;t<this.viewers.length;t++)e(this.viewers[t])},getMainViewer:function(){return this.frameWindow?this.frameWindow.getViewer():null},setActiveCamera:function(e){this._activeCamera=e},getActiveCamera:function(){if(this._activeCamera||null===this._activeCamera)return this._activeCamera;var e=this._experienceBase.ComponentsMap.GetComponentFromType("CXPCameraActor_Spec");if(e&&e.length>0)return this._activeCamera=e[0],e[0];var t=this._experienceBase.ComponentsMap.GetComponentFromType("VCXWebComponentCamera");return t&&t.length>0?(this._activeCamera=t[0],t[0]):void 0},setActiveViewport:function(e){this._activeViewport=e},getActiveViewport:function(){if(this._activeViewport||null===this._activeViewport)return this._activeViewport;var e=this._experienceBase.ComponentsMap.GetComponentFromType("VCXViewport_Spec");return e&&e.length>0?(this._activeViewport=e[0],this._activeViewport):null},setActiveGround:function(e){this._activeGround=e},getActiveGround:function(){return this._activeGround},setActiveBOM:function(e){this._activeBOM=e},getActiveBOM:function(){if(this._activeBOM||null===this._activeBOM)return this._activeBOM;var e=this._experienceBase.ComponentsMap.GetComponentFromType("VCXBOM_Spec");return e&&1===e.length&&(this._activeBOM=e[0]),this._activeBOM},getActionBar:function(){return this.frameWindow.getActionBar()},setRootNode:function(e){if(!this._nRootNode||!e||this._nRootNode.id!==e.id){if(this._nRootNode=e,this._SharedSceneGraphOverrideSet){var t=this.getMainViewer();if(t)t.getSceneGraphOverrideSetManager().removeSceneGraphOverrideSet(this._SharedSceneGraphOverrideSet);this._SharedSceneGraphOverrideSet=null}if(this.getRootComponent()){var r=this.getRootComponent().QueryInterface("W3AISGNodeHolder");r&&(this._pRootPathElement=new o([this._nRootNode]),r.setPathElement(this._pRootPathElement))}}},getRootComponent:function(){if(!this._cRootComponent){var t,r=this.getRootComponentType();if(this._cRootComponent=this._experienceBase.Factory.BuildComponent(r),this._cRootComponent)this._cRootComponent.SetPersistency(0),this._cRootComponent.SetID("VCX_Root"),(t=this._cRootComponent.QueryInterface("VCXIModelNavigable")).setWorkingRoot(t),this._currentWorkingRoot||(this._currentWorkingRoot=t),this._experienceBase.ComponentsMap.AddComponent(this._cRootComponent),e.publish({event:"VCX_ROOT_COMPONENT_CREATED",data:{RootComponent:this._cRootComponent}}),this.getRootNode()}return this._cRootComponent},getRootComponentName:function(){var e=null,t=this.getRootComponent();if(!t)return e;for(var r=t.QueryInterface("VCXIModelNavigable").getChildren(),n=0;n<r.length;++n){var i=t.QueryInterface("VCXIModelNavigable").getChildren()[n];if(i){var o=i.QueryInterface("VCXIModifiable");if(o){var a=o.GetProperty("Actor.AssetID");if(a){var s=a.GetPropertyValue().Value;if(s&&s.lastIndexOf(".")>0){var c=s.lastIndexOf(".");e=s.substr(0,c);break}}}}}return e},getRootComponentType:function(){return this._rootInfos.componentType},getRootNode:function(){if(!this._nRootNode){var e=new r;e.productType=this._rootInfos.productType,e.name=this._rootInfos.name,e.VCX_ROOT_ID=this._rootInfos.id,this.getMainViewer().addNode(e),this.setRootNode(e)}return this._nRootNode},getRootPathElement:function(){return this._pRootPathElement||this.getRootNode(),this._pRootPathElement},_extractModuleFromUrl:function(e){return e.split("/")[0]},_loadCssRessource:function(e,t){for(var r=document.getElementsByTagName("head")[0],i=r.getElementsByTagName("link"),o=null,a=0;a<i.length;a++)if((o=i[a]).href.search(e)>-1)return void(o.disabled=!1);(o=document.createElement("link")).type="text/css",o.rel="stylesheet",o.href=void 0===t?e:n.getWebappsBaseUrl()+e,r.appendChild(o)},loadCssFile:function(e,t){var r=this._extractModuleFromUrl(e);this._loadCssRessource(e,t);var n=r+"/"+r+".css";n!==e&&this._loadCssRessource(n,t)},unloadCssFile:function(e){var t=this._extractModuleFromUrl(e);this._unloadCssRessource(e);var r=t+"/"+t+".css";r!==e&&this._unloadCssRessource(r)},_unloadCssRessource:function(e){for(var t=document.getElementsByTagName("head")[0].getElementsByTagName("link"),r=0;r<t.length;r++){var n=t[r];if(n.href.search(e)>-1)return void(n.disabled=!0)}},isTouchCompliantDevice:function(){var e=navigator.userAgent.toLowerCase();return!!("ontouchstart"in document.documentElement||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0||e.match(/(iphone|ipod|ipad)/)||e.match(/(android)/)||e.match(/(iemobile)/)||e.match(/iphone/i)||e.match(/ipad/i)||e.match(/ipod/i)||e.match(/blackberry/i)||e.match(/bada/i))},renderAll:function(e){this.applyToViewers(function(t){t.render(e)})},setAllViewerSensitive:function(e){var t=this._experienceBase.getManager("VCXPaperManager");this.applyToViewers(function(r){r.setManipulators({activated:e,preActivate:e}),r.currentViewpoint.setControlActive({viewpoint:e,picking:e}),t&&(t.Lock=!e)})},takeReleaseControlActive:function(e){e||(e=this.getMainViewer()),this.setAllViewerSensitive(!1),e.setManipulators({activated:!0,preActivate:!0}),e.currentViewpoint.setControlActive({viewpoint:!0,picking:!0})},getSharedSceneGraphOverrideSet:function(){if(this._UseOverrideSet&&!this._SharedSceneGraphOverrideSet){var e=this.getRootNode(),t=this.getMainViewer();if(e&&t)this._SharedSceneGraphOverrideSet=new i(e),t.getSceneGraphOverrideSetManager().pushSceneGraphOverrideSet(this._SharedSceneGraphOverrideSet)}return this._SharedSceneGraphOverrideSet},getSharedSceneGraphOverride:function(e,t){if(e){var r=this.getSharedSceneGraphOverrideSet();if(r){var n=r.getUniqueOverrideFromPathElement(e);n||void 0!==t&&!t||(n=r.createOverride(e))}}return n},update:function(e){if(this._parent(e),this.traverseGraphMustBePerformed&&this.useTraverseGraph){var t=this.getRootComponent();t&&t.TraverseGraph&&(t.TraverseGraph(null,null,null,0),this.traverseGraphMustBePerformed=!1),this.odtPerfo||this.renderAll()}this.odtPerfo&&this.renderAll()},postUpdate:function(e){this._parent(e),this.partHasMoved=!1},zoomFitAll:function(){this.applyToViewers(function(e){e.currentViewpoint.reframe(null,0)})},setRootOptions:function(e){var t={componentType:!0,productType:!0,name:!0,id:!0};for(var r in e)e.hasOwnProperty(r)&&t[r]&&(this._rootInfos[r]=e[r])},CheckInputFile:function(e,t){var r={supported:!0};if(this._experienceBase.getManager("VCXCAT3DXModelManager")){var n=this.GetApplicationMode();e||0===n?e&&0===n&&(r.supported=!1,r.message="Feature not supported: open file from collabspace (file mode)."):t&&this.isSupported("Import3DXML")&&"3dxml"===t[0]||(r.supported=!1,r.message="Feature not supported: open file from disk.")}else e&&(r.supported=!1,r.message="Feature not supported: open file from collabspace (file mode).");return r},CheckInputExtension:function(e){var t={supported:!0},r=this.getCityMode();"ctps"!==e&&"ctxp"!==e||r||(t.supported=!1,t.message="Extension not supported.");var n=this.getProdHighMode(),i=this.getPlayerMode(),o=this.getExperienceIn3DPlay();return"smgxml"!==e&&"smg"!==e&&"smgs"!==e&&"smggeom"!==e&&"3dxml"!==e&&"json"!==e&&"exprd"!==e||n||i||o||(t.supported=!1,t.message="Extension not supported in CityIllustration."),"tga"===e&&(t.supported=!1,t.message="Feature not supported: creation of 2D panel with TGA image"),t},isSupported:function(e){let t=this.getUrlVars()._ForceSupportedFeature_;if(t){if("1"===this.getUrlVars()[e]||"true"===this.getUrlVars()[e])return!0;if("0"===this.getUrlVars()[e]||"false"===this.getUrlVars()[e])return!1}if(null!==(t=localStorage.getItem(e))){if("1"===t||"true"===t)return!0;if("0"===t||"false"===t)return!1}return!!this._supportedFeatures&&this._supportedFeatures[e]},setSupported:function(e,t){this._supportedFeatures||(this._supportedFeatures={}),this._supportedFeatures[e]=void 0===t||t},getCat3DXIntegration:function(){return this.isSupported("Cat3DXIntegration")},SetApplicationMode:function(e){this._applicationMode=e},GetApplicationMode:function(){return null===this._applicationMode&&console.warn("Application mode is missing."),this._applicationMode},getUseResourcesManager:function(){var e=this.getUrlVars().resManager;return void 0===e||"false"!==e||(console.log("! ========== WARNING : Resources Manager desactivated ======== !"),console.log("! ========== WARNING : Resources Manager desactivated ======== !"),console.log("! ========== WARNING : Resources Manager desactivated ======== !"),!1)},InitApplicationMode:function(){localStorage.setItem("EWS_AuthoringV2","true"),"true"===localStorage.getItem("EWS_AuthoringV2")?console.log("*** JSONV2 enabled ***"):console.log("*** JSONV2 disabled ***");var e=this.getUrlVars().file;if(console.log(" window.loading3DXML = "+window.loading3DXML),"undefined"==typeof widget||widget.isLocalMode||e||window.loading3DXML)return this.SetApplicationMode(s.EApplicationMode.FILE),void console.log("APPLICATION MODE: FILE + "+this.GetApplicationMode());this.SetApplicationMode(s.EApplicationMode.EMS),console.log("APPLICATION MODE: EMS + "+this.GetApplicationMode())},IsLocalMode:function(){return this.GetApplicationMode()===s.EApplicationMode.FILE},IsEMSMode:function(){return this.GetApplicationMode()===s.EApplicationMode.EMS}});return s.getUrlVars=function(){var e,t={},r={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,r,n){t[r]=decodeURIComponent(n)});return t.widgetDomain?e=t.widgetDomain:t.uwaUrl&&(e=t.uwaUrl),e?e.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,t,n){r[t]=n}):r=t,r},s.EApplicationMode={FILE:0,EMS:1},Object.defineProperty(s.prototype,"componentType",{enumerable:!0,get:function(){return"VCXContextManager"}}),s}),define("DS/VCXWebExperienceBase/VCXModifiableOccurrenceExperience",["DS/VCXWebModifiablesImpl/VCXModifiableOccurrence","DS/VCXWebModifiablesServices/VCXModifiablesAccess","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyGroup","DS/VCXWebProperties/VCXPropertyGroupSet","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyInfoEnum","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueHyperlinkId","DS/VCXWebProperties/VCXPropertyValueEnum","i18n!DS/VCXWebExperienceBase/assets/nls/VCXWebExperienceBase"],function(e,t,r,n,i,o,a,s,c,l,u){"use strict";return e.extend({init:function(){this._parent(),this._requestedHyperlinkID=-1},OnChangeProperty:function(e,t,r){if(r||(r={}),r.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;switch(e){case"Actor.Hyperlink":var n=t.GetValue();return void 0!==n&&(this._requestedHyperlinkID=n),!0;case"Actor.ToolTip":var i=this.GetObject(),o=t.GetValue();return i.tooltip!==o&&(i.tooltip=o),!0;case"Actor.Freeze":i=this.GetObject();var a=t.GetValue();return void 0!==a&&(i.eFreeze=a),!0;default:var s=!1,c=(i=this.GetObject()).QueryInterface("VCXIPulseBehavior");return c&&(s=c.OnChangeProperty(e,t,r)),!!s||(r.fromChildClass=!0,this._parent(e,t,r))}return!1},OnChangePropertiesEnd:function(){var e=this.GetObject();if(e.hyperlinkID!==this._requestedHyperlinkID){e.hyperlinkID=this._requestedHyperlinkID;var t=this.GetObject()._experienceBase.getManager("VCXHyperlinkManager");t&&(e.hyperlinkID>=0?t.RegisterInteractableObject(this.GetObject()):t.UnRegisterInteractableObject(this.GetObject()))}return this._parent()},GetProperty:function(e){var n=null;if("Actor.Hyperlink"===e){var i=this.GetObject(),p=new c;p.SetValue(i.hyperlinkID),(M=new o(e,0,!0,u)).SetGroupId("Group.Actions"),n=new r(M,p)}else if("Actor.ToolTip"===e){i=this.GetObject();(f=new s).SetValue(i.tooltip),(n=new r(new o(e,0,!0,u),f)).GetPropertyInfo().IsVisible()&&n.GetPropertyInfo().SetVisible(!1)}else if(e.endsWith("._ComputedText")){var d=e.substring(0,e.length-"._ComputedText".length),h=this.GetProperty(d),g="";if(h){var C=h.GetPropertyValue().ToString();C&&(g=t.ValuateLinkedProperties(C,this.GetObject()._experienceBase,this.GetObject().GetID(),this.GetObject().GetID(),null))}var f=new s(g),M=new o(d,1,!1);n=new r(M,f)}else if("Actor.Freeze"===e){i=this.GetObject();var V=new l;V.SetValue(i.eFreeze);var S=new a(e,1,!1,u);S.AddOrModifyChoice(0,"Freeze.NoFreeze"),S.AddOrModifyChoice(1,"Freeze.Freeze"),S.AddOrModifyChoice(2,"Freeze.FreezeInPlay"),n=new r(S,V)}else{var y=this.GetObject().QueryInterface("VCXIPulseBehavior");y&&(n=y.GetProperty(e))}return n||(n=this._parent(e)),n},GetProperties:function(e){var t=this._parent();t.AddOrModifyProperty(this.GetProperty("Actor.ToolTip")),t.AddOrModifyProperty(this.GetProperty("Actor.Hyperlink"));var r=this.GetObject().QueryInterface("VCXIPulseBehavior");return r&&r.GetProperties(t),t}})}),define("DS/VCXWebExperienceBase/VCXInteractableObjectsManager",["UWA/Class","DS/VCXWebModifiablesServices/VCXModifiablesServices","DS/VCXWebModifiables/VCXModelChangeListener","DS/VCXWebVisibility/VCXIVisibility"],function(e,t,r,n){"use strict";var i=e.extend({initialize:function(){this._registredInteractableObjects=[],this._bActiveInteraction=!1,this._dirty=!1,this._sorted=!1},GetActiveInteraction:function(){if(this._experienceBase.getManager("VCXModelChangeListener")&&this._dirty){this._dirty=!1,this._sorted=!1,this._bActiveInteraction=!1;for(var e=0;e<this._registredInteractableObjects.length;e++){var t=this._experienceBase.ComponentsMap.GetComponentFromID(this._registredInteractableObjects[e]);if(t)if("VCXComponentHotspot"===t.GetType()){if(t.QueryInterface("VCXIModifiable").GetProperty("Actor.Enable").GetPropertyValue().GetValue()){this._bActiveInteraction=!0;break}}else{var r=t.QueryInterface("VCXIVisibility");if(r&&r.GetVisibility()!==n.EVisState.Hidden){var i=t.QueryInterface("VCXIModifiable").GetProperty("Actor.Opacity");if(i&&i.GetPropertyValue()&&i.GetPropertyValue().Value){this._bActiveInteraction=!0;break}}}}}return this._bActiveInteraction},update:function(e){var t=this._experienceBase.getManager("VCXModelChangeListener");t&&t.hasChanged(r.FChangeFlag.Visibility)&&(this._sorted=!1,this._dirty=!0)},RegisterInteractableObject:function(e){this._registredInteractableObjects.push(e.GetID()),this._sorted=!1,this._dirty=!0},UnRegisterInteractableObject:function(e){var t=this._registredInteractableObjects.indexOf(e.GetID());t>-1&&(this._registredInteractableObjects.splice(t,1),this._dirty=!0)},GetSortedInteractableObjects:function(){return this._sorted||(this._registredInteractableObjects=t.sortListDisplayPriority(this._experienceBase,this._registredInteractableObjects),this._sorted=!0),this._registredInteractableObjects}});return Object.defineProperty(i.prototype,"componentType",{enumerable:!0,get:function(){return"VCXInteractableObjectsManager"}}),i}),define("DS/VCXWebExperienceBase/VCXHyperlinkManagerBase",["DS/VCXWebExperienceBase/VCXInteractableObjectsManager","DS/VisuEvents/EventsManager","DS/VCXWebModifiablesServices/VCXModifiablesAccess"],function(e,t,r){"use strict";var n=e.extend({init:function(){this._strEventToListen=""},initialize:function(){this._parent()},postInitialize:function(){var e=this;this.onVisuEvent=function(t){if(e.GetActiveInteraction()){var n=r.GetModifiableFromEvent(t,e._experienceBase);if(n){var i=n.GetObject().GetID();e._experienceBase.getManager("VCXAPIManager").ActivateHyperlink(i)}}},this._strEventToListen&&t.addEvent(this._experienceBase.getManager("VCXContextManager").getMainViewer().canvas,this._strEventToListen,this.onVisuEvent)},unInitialize:function(){this._parent(),t.removeEvent(this._experienceBase.getManager("VCXContextManager").getMainViewer().canvas,this._strEventToListen,this.onVisuEvent),this._strEventToListen=""},OpenHyperlink:function(e){},_getHyperlinkInfos:function(e){var t=null;e&&(t=this._getPropertyPathFromModifiable(e));var r={};return t&&(r=this._getHyperlinkInfosFromProperty(t)),r},_getPropertyPathFromModifiable:function(e){if(e){var t=null,r=-1,n=e.GetProperty("Actor.Hyperlink"),i=!1;if(n){var o=n.GetPropertyValue();(r=parseInt(o.GetValue(),10))>=0&&(i=!0)}if(i){var a=this._experienceBase.getManager("VCXDocManager");a&&(t=a.GetPropPath(r))}return t}},_getHyperlinkInfosFromProperty:function(e){var t={},r=-1;e&&(r=e.GetPathType().GetValue());0===r&&(t={url:e.GetValueURL().GetValue(),filename:e.GetFileName().GetValue()});return t},BuildPropertyForHyperlink:function(e,t){var r=-1,n="";t.indexOf("blob:")<0?r=0:n=t.toLowerCase(),n.indexOf("http")>=0&&(r=0);var i=!1;if(0===r){i=!0;var o=this._experienceBase.getManager("VCXDocManager").BuildPathFromString(t,"");t=this._experienceBase.getManager("VCXDocManager").AddOrModifyHyperlink(o).GetValue()}return i||(t=e.GetProperty("Actor.Hyperlink").GetPropertyValue().GetValue()),t}});return Object.defineProperty(n.prototype,"componentType",{enumerable:!0,get:function(){return"VCXHyperlinkManagerBase"}}),n}),define("DS/VCXWebExperienceBase/VCXModifiableOccurrenceExt",["DS/VCXWebExperienceBase/VCXModifiableOccurrenceExperience","DS/VCXWebComponents/VCXWebComponentOccurrence","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyInfoEnum","DS/VCXWebProperties/VCXPropertyValueEnum","DS/VCXWebProperties/VCXPropertyValueFloat","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables"],function(e,t,r,n,i,o,a,s){"use strict";return e.extend({OnChangeProperty:function(e,t,r){if(r||(r={}),r.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;switch(e){case"Actor.LayerOpacity":this.GetObject().layerOpacity=t.GetValue();break;case"Actor.Rendering":this.GetObject().renderingMode=t.GetValue();break;case"Actor.Priority":this.GetObject().priority=t.GetValue();break;default:return r.fromChildClass=!0,this._parent(e,t,r)}return!0},OnChangePropertiesEnd:function(){var e=this.GetObject();if(e.getDirtyFlag(t.FDirty.Priority)){var r=e._experienceBase.getManager("VCXVisuManager");r&&r.dirtifyRenderPriority()}return this._parent()},GetProperty:function(e){var c=null;if("Actor.LayerOpacity"===e){var l=this.GetObject().layerOpacity,u=new a;u.SetValue(l),(g=new n(e,0,!0,s)).SetBounds(0,1,.1),g.SetGroupId("Group.CustomRendering"),c=new r(g,u)}else if("Actor.Rendering"===e){var p=this.GetObject()._experienceBase.getManager("VCXContextManager"),d=this.GetObject().renderingMode,h=new o;h.SetValue(d),(g=new i(e,0,!0,s)).AddOrModifyChoice(t.ERenderingMode.Smooth,"Actor.Rendering.Smooth"),g.AddOrModifyChoice(t.ERenderingMode.SmoothOutline,"Actor.Rendering.SmoothOutline"),p.isSupported("3DSync")||(g.AddOrModifyChoice(t.ERenderingMode.Technical,"Actor.Rendering.Technical"),g.AddOrModifyChoice(t.ERenderingMode.FlatTechnical,"Actor.Rendering.FlatTechnical")),g.AddOrModifyChoice(t.ERenderingMode.Silhouette,"Actor.Rendering.Silhouette"),g.SetGroupId("Group.CustomRendering"),c=new r(g,h)}else if("Actor.Priority"===e){var g,C=this.GetObject().priority,f=new o;f.SetValue(C),(g=new i(e,0,!0,s)).AddOrModifyChoice(0,"Actor.Priority.VeryLow"),g.AddOrModifyChoice(1,"Actor.Priority.Low"),g.AddOrModifyChoice(2,"Actor.Priority.Normal"),g.AddOrModifyChoice(3,"Actor.Priority.High"),g.AddOrModifyChoice(4,"Actor.Priority.VeryHigh"),g.SetGroupId("Group.CustomRendering"),c=new r(g,f)}else c=this._parent(e);return c},GetProperties:function(e){var t=this._parent();return t.AddOrModifyProperty(this.GetProperty("Actor.LayerOpacity")),t.AddOrModifyProperty(this.GetProperty("Actor.Rendering")),t.AddOrModifyProperty(this.GetProperty("Actor.Priority")),t}})}),define("DS/VCXWebExperienceBase/VCXModifiableViewOccurrenceExt",["DS/VCXWebExperienceBase/VCXModifiableViewOccurrenceExperience","DS/VCXWebProperties/VCXPropertyGroup","DS/VCXWebComponents/VCXWebComponentOccurrence","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables"],function(e,t,r,n){"use strict";return e.extend({getPropertyGroups:function(e){e||(e={}),this._parent(e);var i=this.getGroupPropertiesOrders();e["Group.CustomRendering"]||(e["Group.CustomRendering"]=new t({groupID:"Group.CustomRendering"}),e["Group.CustomRendering"].i18nGroup=n),e["Group.CustomRendering"].setPropertiesOrder(i["Group.CustomRendering"]),e["Group.CustomRendering"].priority=60;var o={};o[r.ERenderingMode.Smooth]="Actor.Rendering.Smooth",o[r.ERenderingMode.SmoothOutline]="Actor.Rendering.SmoothOutline",o[r.ERenderingMode.Technical]="Actor.Rendering.Technical",o[r.ERenderingMode.FlatTechnical]="Actor.Rendering.FlatTechnical",o[r.ERenderingMode.Silhouette]="Actor.Rendering.Silhouette",e["Group.CustomRendering"].addProperties([{propertyName:"Actor.LayerOpacity",i18n:n},{propertyName:"Actor.Rendering",i18n:n,mapChoiceEnum:o},{propertyName:"Actor.Priority",i18n:n,mapChoiceEnum:{0:"Actor.Priority.VeryLow",1:"Actor.Priority.Low",2:"Actor.Priority.Normal",3:"Actor.Priority.High",4:"Actor.Priority.VeryHigh"}}])},getGroupPropertiesOrders:function(){var e=this._parent()||{};return UWA.extend(e,{"Group.CustomRendering":["Actor.Rendering","Actor.Priority","Actor.LayerOpacity"]}),e},getCollapsedGroupsNames:function(){return this._parent().concat(["Group.CustomRendering"])}})}),define("DS/VCXWebExperienceBase/VCXOverridesChangeServices",["DS/Visualization/ThreeJS_DS","DS/VCXWebExperienceBase/VCXPathElementTools","DS/VCXWebExperienceBase/VCXSceneGraphOverridesServices"],function(e,t,r){"use strict";return{Ghost:function(e,n,i,o,a){var s=t.getMesh3dPathElements(n,["Instance3D"]);if(!s)return!1;void 0===i&&(i=!0),i&&void 0===o&&(o=.1),void 0===a&&(a=2);for(var c=0;c<s.length;++c){var l=r.getSceneGraphOverride(e,s[c]);l&&(i&&l.setOpacity(o,!0),1===a?l.setPickability("PICKABLE"):2===a&&l.setPickability("IGNORED"))}return!0},UnGhost:function(e,n){var i=t.getMesh3dPathElements(n,["Instance3D"]);if(!i)return!1;for(var o=0;o<i.length;++o){var a=r.getSceneGraphOverride(e,i[o]);a&&e.deleteOverride(a)}}}}),define("DS/VCXWebExperienceBase/VCXComponentOccurrenceExt",["DS/VCXWebExperienceBase/VCXComponentOccurrenceExperience","DS/VCXWebComponents/VCXWebComponentOccurrence"],function(e,t){"use strict";var r=e.extend({init:function(){this._parent(),this._renderingMode=0,this._layerOpacity=.5,this._priority=2,this._localMaterial=null,this._globalMaterial=null},descriptionDump(){var e=function(e){return e&&{name:e.name,type:e.getType&&e.getType(),subType:e.getSubType&&e.getSubType()}},t=function(e){return e&&{faceMode:e._faceMode,mask:e._renderMode&&e._renderMode._mask,outlineWidth:e._renderMode&&e._renderMode._outlineWidth,renderLineMask:e._renderMode&&e._renderMode._useRenderLineMask,renderFaceMask:e._renderMode&&e._renderMode._useRenderFaceMask,renderPointMask:e._renderMode&&e._renderMode._useRenderPointMask}},r=this.BuildGraphicPropertiesStructure({getAll:!0});return r[0].objectName=r[0].object.name,r[0].peKey=r[0].pathElement._key,delete r[0].object,delete r[0].pathElement,r[0].cad&&r[0].cad.Material&&(r[0].cad.Material=e(r[0].cad.Material)),r[0].visible&&r[0].visible.Material&&(r[0].visible.Material=e(r[0].visible.Material)),r[0].override&&r[0].override.Material&&(r[0].override.Material=e(r[0].override.Material)),r[0].cad&&r[0].cad.RenderStyle&&(r[0].cad.RenderStyle=t(r[0].cad.RenderStyle)),r[0].visible&&r[0].visible.RenderStyle&&(r[0].visible.RenderStyle=t(r[0].visible.RenderStyle)),r[0].override&&r[0].override.RenderStyle&&(r[0].override.RenderStyle=t(r[0].override.RenderStyle)),r[0]}});return Object.defineProperty(e.prototype,"layerOpacity",{enumerable:!0,get:function(){return this._layerOpacity},set:function(e){this._layerOpacity!==e&&(this._layerOpacity=e,this._dirtyMask|=t.FDirty.LayerOpacity)}}),Object.defineProperty(e.prototype,"renderingMode",{enumerable:!0,get:function(){return this._renderingMode},set:function(e){this._renderingMode!==e&&(this._renderingMode=e,this._dirtyMask|=t.FDirty.RenderingMode|t.FDirty.Priority)}}),Object.defineProperty(e.prototype,"priority",{enumerable:!0,get:function(){return this._priority},set:function(e){this._priority!==e&&(this._priority=e,this._dirtyMask|=t.FDirty.Priority)}}),Object.defineProperty(e.prototype,"localMaterial",{enumerable:!0,get:function(){return this._localMaterial},set:function(e){this._localMaterial=e,this._dirtyMask|=t.FDirty.Material|t.FDirty.Color|t.FDirty.Alpha}}),Object.defineProperty(e.prototype,"globalMaterial",{enumerable:!0,get:function(){return this._globalMaterial}}),t.addDirtyFlags(["LayerOpacity","RenderingMode","Priority","Material"]),Object.defineProperty(r.prototype,"componentType",{enumerable:!0,get:function(){return"VCXComponentOccurrenceExt"}}),r});