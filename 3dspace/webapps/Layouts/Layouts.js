define("DS/Layouts/GridEngineCellAbstract",["UWA/Core","UWA/Controls/Abstract","DS/Utilities/Dom","UWA/Utils"],function(e,t,i,n){"use strict";return t.extend({defaultOptions:{gridEngine:null,parent:null,width:100,height:28,useTranslate3d:!1},init:function(e){this._parent(e),this._uxid=n.getUUID(),this._buildView(),this._virtualRowID=-1,this._virtualColumnID=-1,this._dataToBeTransferred={},this._cachedCellInfos=null},_clean:function(){},_free:function(){},getGridEngine:function(){return this.options.gridEngine},getCellInfos:function(){if(!this._cachedCellInfos){var e=this.getVirtualCoordinates();this._cachedCellInfos={virtualRowID:e.virtualRowID,virtualColumnID:e.virtualColumnID,virtualCellID:e.virtualCellID,cellModel:this.getGridEngine().getCellModel(e.virtualRowID,e.virtualColumnID),cellView:this,manager:this.getGridEngine(),isHeader:-1===e.virtualRowID||-1===e.virtualColumnID}}return this._cachedCellInfos},isHeader:function(){var e=this.getVirtualCoordinates();return-1===e.virtualRowID||-1===e.virtualColumnID},_setReusableContent:function(e){this._disposeReusableContent(),this._reusableContent=e,this.getContent().setContent(this._reusableContent.getContent&&this._reusableContent.getContent()||this._reusableContent)},_disposeReusableContent:function(){this._reusableContent&&(this._reusableContent.__disposable__.dispose(),this._reusableContent=void 0)},reuseCellContent:function(e){return this.getGridEngine()._reuseCellContent(e,this)},getParent:function(){return this.options.parent},getPosition:function(){var e=this.getVirtualCoordinates(),t={top:e.virtualRowID*this.getGridEngine()._getCellHeight(),left:e.virtualColumnID*this.getGridEngine()._getCellWidth()};return t.top<0&&(t.top=0),t.left<0&&(t.left=0),t},destroy:function(){this._disposeReusableContent(),this._cachedCellInfos=null,this._parent()},placeCell:function(e){void 0===e&&(e=this.getPosition()),this.elements.container.style.left=e.left+"px",this.elements.container.style.top=e.top+"px"},_setVirtualCoordinates:function(e){this._cachedCellInfos=null,this._virtualRowID=e.virtualRowID,this._virtualColumnID=e.virtualColumnID,void 0!==e.rowID&&this.elements.container.setAttribute("row-id",e.rowID),void 0!==e.columnID&&this.elements.container.setAttribute("column-id",e.columnID),this.elements.container.setAttribute("virtual-row-id",this._virtualRowID),this.elements.container.setAttribute("virtual-column-id",this._virtualColumnID),i.setStyles(this.getContent(),{width:this._virtualColumnID>-1?this.getGridEngine().options.defaultCellWidth:this.getGridEngine().getHeadersDimensions().width,height:this._virtualRowID>-1?this.getGridEngine().options.defaultCellHeight:this.getGridEngine().getHeadersDimensions().height})},_requestCell:function(){this.getGridEngine()._isRequestingCell=!0;var e=this.getCellInfos();e.cellModel&&(e.isHeader?-1===e.virtualRowID?this.getGridEngine()._onRequestColumnHeaderCB&&this.getGridEngine()._onRequestColumnHeaderCB.call(this,e):this.getGridEngine()._onRequestRowHeaderCB&&this.getGridEngine()._onRequestRowHeaderCB.call(this,e):this.getGridEngine()._onRequestCellCB&&this.getGridEngine()._onRequestCellCB.call(this,e)),this.getGridEngine()._isRequestingCell=!1},updateInternalParameters:function(){this.getGridEngine().options.performances.debounceCellRequest&&this._requestCell()},isFiltered:function(){return this._isFiltered},getVirtualCoordinates:function(){return{virtualRowID:this._virtualRowID,virtualColumnID:this._virtualColumnID,virtualCellID:this._virtualRowID*this.getGridEngine()._numberOfColumns+this._virtualColumnID}},_buildView:function(){this.elements.container=e.createElement("div",{class:"wux-datagrid-cell "+(this.options.isHeader?"wux-font-3dsregular":""),styles:{lineHeight:this.options.height+"px",width:this.options.width,height:this.options.height}}),this.elements.container.dsView=this},getDimensions:function(){var e=this.getGridEngine().options.cellSpacing;return{width:this.options.width+e.horizontal,height:this.options.height+e.vertical}},hide:function(){this._isHidden||(this._isHidden=!0,this.elements.container.style.display="none")},show:function(e){(this._isHidden||e)&&(this._isHidden=!1,this.elements.container.style.display="block")},isHidden:function(){return this._isHidden}})}),define("DS/Layouts/TreeNavigationNodeAbstract",["UWA/Core","DS/Controls/TreeNodeBase","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents"],function(e,t,i,n){}),define("DS/Layouts/SlidingViews",["UWA/Drivers/Alone","UWA/Controls/Abstract","DS/WebappsUtils/WebappsUtils","DS/CoreEvents/ModelEvents","DS/UIBehaviors/Kinetic","DS/Core/PointerEvents","DS/Utilities/Dom"],function(e,t,i,n,o,s,l){"use strict";window._flagFrameIsLoaded=[];var r=function(e){return 0===e.indexOf("http://")||0===e.indexOf("https://")?e:i.getWebappsBaseUrl()+e};return t.extend({defaultOptions:{kinetic:!0,orientation:"horizontal",showPager:!0,views:[],viewsBar:null,activateViewOn:null,viewsWidth:"100%",translateFactor:100,effectDuration:"0.2s",pageBuilder:function(t){return new e.Element("div",{class:"wux-layouts-slidingviews-page-content",styles:{overflowY:"auto",overflowX:"hidden",whiteSpace:"normal"}})},selectedViewsIndicatorBuilder:function(t){return new e.Element("div",{class:"wux-layouts-slidingviews-views-item-selection wux-font-arial-regular"})},viewsIndicatorBuilder:function(t){return new e.Element("div",{class:"wux-layouts-slidingviews-views-item",html:t.label})},pagerTarget:null,prevPage:null,nextPage:null},init:function(e){this._parent(e),this._modelEvents=new n,this._selectedContentIndex=-1,this._views=[],this._buildLayout(),this._buildviews(),this.options.kinetic&&this._bindKinetic();var t=this;l.onNodeRendered(t.elements.selection,function(){t.goToNthView(0)})},_buildLayout:function(){this.elements.container=new e.Element("div",{class:"wux-layouts-slidingviews"}),this.elements.views=new e.Element("div",{class:"wux-layouts-slidingviews-views",styles:{height:"auto",borderTop:"none",textAlign:"center",padding:"5px 10px",position:"relative",display:this.options.showPager?"block":"none"}}).inject(this.elements.container),this.elements.viewsContainer=new e.Element("div",{styles:{position:"relative",display:"inline-block"}}).inject(this.elements.views),this.elements.contentView=new e.Element("div",{class:"wux-layouts-slidingviews-content-view",styles:{height:"inherit"}}).inject(this.elements.container),this.elements.contentViewContainer=new e.Element("ul",{class:"wux-layouts-slidingviews-content-view-container wux-ui-stack-h",styles:{position:"relative",height:"100%"}}).inject(this.elements.contentView),this.elements.contentViewContainer.setStyles({transition:"all "+this.options.effectDuration+" ease-in-out"})},_buildviews:function(){var e=this;this._lastSelectedContentIndex=null,this._selectedContentIndex=0,this.elements.selection=e.options.selectedViewsIndicatorBuilder({}),this.options.pagerTarget?this.elements.selection.inject(e.options.pagerTarget):this.elements.selection.inject(e.elements.viewsContainer),this.elements.viewsItems=[],this.options.views.forEach(function(t,i){e.addView(t,i)})},_bindKinetic:function(){this._kin=new o({target:this.elements.contentViewContainer,scrollX:!0,scrollY:!1,range:{xMin:0,xMax:100*(this._views.length-1),yMin:0,yMax:0},duration:100,viscosity:500});var e=this;this._kin.onRelease(function(){e.goToNthView(this.getFinalPositionPercent().x/100,void 0,!0)})},addView:function(t,n){var o=this;void 0===n&&(n=o.elements.viewsItems.length);var l,a,u=o.options.viewsIndicatorBuilder({index:n+1,label:t.title||n});u.addEvent(s.POINTERUP,function(e){o.elements.contentViewContainer.setStyles({transition:"all "+o.options.effectDuration+" ease-in-out"}),o.goToNthView(n)}),o.elements.viewsItems.splice(n,0,u),this.options.pagerTarget?u.inject(o.options.pagerTarget):u.inject(o.elements.viewsContainer);var h=t.content;if("string"==typeof h.html)if(h.iframe){a=new e.Element("iframe",{allowfullscreen:"true",src:r(h.html),frameborder:0,onload:"window._flagFrameIsLoaded["+n+"]=true",styles:{width:"100%",position:"absolute",top:0,bottom:0,height:"100%",overflow:"auto","-webkit-overflow-scrolling":"touch"}});var d=0,m=window.setInterval(function(){++d>20&&(window.clearInterval(m),t.contentError&&(a.src=r(t.contentError)))},100)}else{a=new e.Element("div",{styles:{padding:10,overflowY:"auto",overflowX:"hidden",whiteSpace:"normal"}});var c="Ajax";"../"!==i.getWebappsBaseUrl()&&(c="Data"),e[c].request(h.html,{async:!0,onComplete:function(e){a.setHTML(e),h.onLoad&&h.onLoad(e)}})}else a=t.content.html;t.styles||(t.styles={}),t.styles.verticalAlign="top",t.styles.width=this.options.viewsWidth,l=this.options.pageBuilder.call(this,n),a&&l.setHTML(a);var _=t.class?t.class:"",p=new e.Element("li",{html:l,class:"wux-layouts-slidingviews-page "+_,styles:t.styles});return p.getContent?p.getContent().setHTML(l):p.setHTML(l),p.inject(o.elements.contentViewContainer),o._views.splice(n,0,l),l},removeView:function(e){this.getViews().length>1&&(this.elements.viewsItems[e].destroy(),this.elements.viewsItems.splice(e,1),this._views[e].destroy&&this._views[e].destroy(),this._views[e]&&this._views[e].remove&&this._views[e].remove(),this._views.splice(e,1),e===this._selectedContentIndex&&this.goToNthView(Math.max(0,e-1)))},getViews:function(){return this._views},getView:function(e){return this._views[e]},getCurrentViewID:function(){return-1===this._selectedContentIndex?0:this._selectedContentIndex},getCurrentView:function(){return this.getView(this.getCurrentViewID())},goToPreviousView:function(){return this.goToNthView(this.getCurrentViewID()-1)},goToNthView:function(e,t,i){var n=this;void 0===t&&(t=!0),e>n.elements.viewsItems.length-1&&(e=n.elements.viewsItems.length-1),e<0&&(e=0),n._lastSelectedContentIndex=n._selectedContentIndex,n._selectedContentIndex=e,null!==n._lastSelectedContentIndex&&n.elements.viewsItems[n._lastSelectedContentIndex]&&n.elements.viewsItems[n._lastSelectedContentIndex].removeClassName("wux-ui-state-active");var o=n.elements.viewsItems[e];if(o){var s=-e*this.options.translateFactor+"%";n.elements.contentViewContainer.setStyles({transform:"translate3d("+s+", 0px, 0)"}),!i&&this.options.kinetic&&n._kin._registerPosition(s);var l;o.getOffsets().x-parseInt(o.getStyle("paddingLeft"),10)/2,l=o.getPosition().x,n.elements.selection.setHTML(n.elements.viewsItems[e].getHTML()),n.elements.selection.setStyles({position:"absolute",top:"auto",transform:"translate3d("+l+"px, 0px, 0)",height:o.getDimensions().height,width:o.getDimensions().width}),o.addClassName("wux-ui-state-active"),t&&this._modelEvents.publish({event:"CHANGE",data:{viewID:e}})}else console.warn("Something gone wrong, try to reach view with index:",e);return this.getView(e)},onViewChange:function(e){return this._modelEvents.subscribe({event:"CHANGE"},e)}})}),define("DS/Layouts/TreeNavigation",["UWA/Core","UWA/Controls/Abstract","DS/Controls/TreeBase","DS/Controls/TreeNodeBase","DS/Layouts/TreeNavigationNodeAbstract","DS/Layouts/SlidingViews","DS/Core/PointerEvents","DS/Utilities/Dom"],function(e,t,i,n,o,s,l,r){}),define("DS/Layouts/GridEngine",["UWA/Drivers/Alone","UWA/Core","UWA/Element","DS/Core/Core","UWA/Controls/Abstract","DS/WebappsUtils/WebappsUtils","DS/CoreEvents/ModelEvents","DS/Controls/Scroller","DS/Utilities/Dom","DS/Core/PointerEvents","DS/Layouts/GridEngineCellAbstract","DS/Utilities/Data","DS/Core/ActionsStack","DS/Controls/Gauge","DS/Utilities/Debug","DS/Utilities/Utils","UWA/Utils/Client","UWA/Utils","UWA/Class","DS/Utilities/Array","DS/Utilities/RAFDispatcher","DS/Utilities/ReusableContentsManager"],function(e,t,i,n,o,s,l,r,a,u,h,d,m,c,_,p,f,C,w,g,v,D){"use strict";var R=!1,I=0,b=f.Engine,y=b.ie||b.chrome||b.edge;function O(e,t){var i=e;if(i)return(" "+i.className+" ").replace(/[\n\t]/g," ").indexOf(" "+t+" ")>-1?i:O(i.parentNode,t)}return o.extend({defaultOptions:{model:null,parent:null,defaultCellMouseWidth:null,defaultCellMouseHeight:null,defaultCellTouchWidth:null,defaultCellTouchHeight:null,defaultCellWidth:100,defaultCellHeight:28,useDynamicCellSpacing:!1,allowUnsafeHTMLContent:void 0,shouldCellAllowUnsafeHTMLContentAt:function(e){return e.manager.options.allowUnsafeHTMLContent},cellClass:h,showRowsHeader:!1,showColumnsHeader:!1,headersDimensions:{width:void 0,height:void 0},cellSpacing:{horizontal:0,vertical:0},height:400,infiniteScrolling:!1,pageScrollValueTriggeringInfiniteScroll:void 0,virtualModelSize:null,numberOfColumns:null,deferredProcessingTimeout:100,useTransparentScroller:!1,showScrollbarsOnHover:!1,virtualView:!0,performances:{renderingMode:"standard",renderingOptimization:0,preloadPool:!1,enableColumnVirtualization:!0,useRequestAnimationFrameRendering:!1,use2PassRendering:!1,resizeDebounceTimeout:100,numberOfRowsFactor:2,numberOfColumnsFactor:2,fullUpdateFactor:.75,modelViewportFactor:.5,minimumScrollDistance:0},debug:{minDurationBeforeNextRendering:0}},_applyTouchMode:function(e){this._isTouch=e,this._isTouch?(this.options.defaultCellTouchWidth&&(this.options.defaultCellWidth=this.options.defaultCellTouchWidth),this.options.defaultCellTouchHeight&&(this.options.defaultCellHeight=this.options.defaultCellTouchHeight)):(this.options.defaultCellMouseWidth&&(this.options.defaultCellWidth=this.options.defaultCellMouseWidth),this.options.defaultCellMouseHeight&&(this.options.defaultCellHeight=this.options.defaultCellMouseHeight)),this._isTouch?this.getContent().setAttributeNode(document.createAttribute("touch-mode")):this.getContent().removeAttribute("touch-mode"),this.updateView(!0)},_setUpdateViewOptions:function(t){void 0===this._updateViewOptions&&(this._updateViewOptions=this._updateViewDefaultOptions),this._updateViewOptions=e.merge(e.clone(this._updateViewDefaultOptions),this._updateViewOptions,t)},destroy:function(){for(this._freeUpPool(3),this._modelEvents.destroy(),this._updateCellsContentDebounced=null,delete this._updateCellsContentDebounced;this.options.model.length>0;){for(var e=this.options.model[this.options.model.length-1];e&&e.length>0;){var t=e[e.length-1];t&&t.destroy&&t.destroy(),e.pop()}this.options.model.pop()}g.clear(this.options.model),this.options=null;for(var i=0;i<this._listOfFreeCells.length;i++)this._listOfFreeCells[i].destroy();for(i=0;i<this._listOfFreeRowHeaders.length;i++)this._listOfFreeRowHeaders[i].destroy();for(i=0;i<this._listOfFreeColumnHeaders.length;i++)this._listOfFreeColumnHeaders[i].destroy();if(g.clear(this._listOfFreeCells),g.clear(this._listOfFreeRowHeaders),g.clear(this._listOfFreeColumnHeaders),this.elements.container){var n=this.elements.container;if(n.__resizeListeners__)for(i=n.__resizeListeners__.length-1;i>=0;i--)a.removeResizeListener(n,n.__resizeListeners__[i])}this._reusableCellContentManager.destroy(),this._gridContainerDimensionsModified(),this.removeMe(),this._parent()},init:function(t){this._parent(t);var i=this;this._name="GRIDENGINE",this._buildLayout(),this.getContent().setAttribute("platform-name",f.Platform.name),this.__gridengineUUID=e.Utils.getUUID(),this.options.defaultCellMouseWidth||(this.options.defaultCellMouseWidth=this.options.defaultCellWidth),this.options.defaultCellMouseHeight||(this.options.defaultCellMouseHeight=this.options.defaultCellHeight),this.options.defaultCellTouchWidth||(this.options.defaultCellTouchWidth=this.options.defaultCellWidth),this.options.defaultCellTouchHeight||(this.options.defaultCellTouchHeight=this.options.defaultCellHeight),this._isTouch=!1,Object.defineProperty(this,"touchMode",{get:function(){return i._isTouch},set:function(e){i._applyTouchMode(e)}}),this._debugPerformanceIssues=!1,this._modelEvents=new l,this.__preventNextUpdateViewCounter=0,this._needToApplyCellContainerSize=!1,this._reusableCellContentManager=new D,this._listOfRenderedCells={},this._listOfFreeCells=[],this._listOfRenderedRowHeaders={},this._listOfFreeRowHeaders=[],this._listOfRenderedColumnHeaders={},this._listOfFreeColumnHeaders=[],this.__lastScrollPos={x:0,y:0},this._onModelRequestCB=null,this._onInfiniteScrollCB=null,this._deltaScrollPositionFromBeginning={x:0,y:0},this._onRequestRowHeaderCB=function(e){var t=e.virtualRowID.toString();e.cellView.getContent&&(e.cellView.getContent().innerText=t)},this._onRequestColumnHeaderCB=function(e){var t=e.virtualColumnID.toString();e.cellView.getContent&&e.cellView.getContent().setText(t)},this._onInternalRequestRowHeaderCB=function(e){if(this._headersDimension.width>0){if(this._isRequestingCell=!0,this._onRequestRowHeaderCB&&this._onRequestRowHeaderCB.call(i,e),e.cellView)(e=e.cellView.getCellInfos()).cellView.nodeColor.inject(e.cellView.getContent()),e.nodeModel&&e.nodeModel.options.color&&"initial"!=e.nodeModel.options.color?(e.cellView.nodeColor.style.background=e.nodeModel.options.color,e.cellView.nodeColor.style.display="",e.cellView.getContent().addClassName("wux-datagrid-cell-with-color")):(e.cellView.nodeColor.style.display="none",e.cellView.getContent().removeClassName("wux-datagrid-cell-with-color"));this._isRequestingCell=!1}},this._onInternalRequestColumnHeaderCB=function(e){if(this._headersDimension.height>0){if(this._isRequestingCell=!0,i.options.showColumnsHeader&&i._doesColumnNeedToBeRequested(e.virtualColumnID)){var t=e.cellView.getCellInfos();this._onRequestColumnHeaderCB&&this._onRequestColumnHeaderCB.call(i,t)}this._isRequestingCell=!1}},this._onInternalRequestCellCB=function(e){this._isRequestingCell=!0;var t=i.getModelSize();if(e.virtualRowID>=0&&e.virtualRowID<t.numberOfRows&&e.virtualColumnID>=0&&e.virtualColumnID<t.numberOfColumns){var n=e.cellView.getCellInfos();i._onRequestCellCB&&(void 0!==n.cellModel&&(n.rowID=e.rowID,n.columnID=e.columnID,this._onRequestCellCB.call(i,n),e.cellView.show(!0)),i._toDeferredProcessing&&clearTimeout(i._toDeferredProcessing),i._listOfCellFilters.process({actionParamsList:[{virtualRowID:e.virtualRowID,virtualColumnID:e.virtualColumnID,cellView:e.cellView,cellModel:i.getCellModel(e.virtualRowID,e.virtualColumnID)}],chunckProcess:!1}))}this._isRequestingCell=!1},this._isMonoDimension=null,this.cellInfosCB=null,this._columnHeadersPool=[],this._updateCounter=0,this._renderOrder=0,this._poolDimensions={},this._numberOfRowsToRemove=0,this._numberOfColumnsToRemove=0,this._listOfCellsToBeUpdated={},this._updateViewDefaultOptions={generatePool:!1,detachAllViews:!0,updateCells:!0,updateColumnsHeaders:!0,onPreUpdate:null,onPostUpdate:null},this._updateViewOptions=this._updateViewDefaultOptions,this._listOfCellFilters=new m,this._virtualPos={virtualRowID:-1,virtualColumnID:-1},this._viewportBbox={minRowID:-1,minColumnID:-1,maxRowID:-1,maxColumnID:-1},this._modelSize={numberOfRows:0,numberOfColumns:0},this._poolContainerSize={},this._poolSize={numberOfRows:0,numberOfColumns:0},this.options.model&&this.loadModel(this.options.model,!0),this._observeEvents(),this.removeMe=function(){i=null}},_observeEvents:function(){var e=!1,t=this;this.onReady(function(){if(!1===e){e=!0;var i={timeStamp:0,target:null,type:null};this.elements.container.addEvent(u.POINTERUP,function(e){if(e.originalEvent){var n={timeStamp:e.originalEvent.timeStamp,target:e.originalEvent.target,type:e.originalEvent.type};if(n.timeStamp!==i.timeStamp||n.target!==i.target||"mouseup"!==n.type||"touchend"!==i.type){i={timeStamp:e.originalEvent.timeStamp,target:e.originalEvent.target,type:e.originalEvent.type};var o=O(e.target,"wux-datagrid-cell");if(1===e.which&&o&&o.dsView){var s=o.dsView.getCellInfos(),l=s.cellView.getVirtualCoordinates(),r=t.getCellModel(l.virtualRowID,l.virtualColumnID);void 0!==r&&t._modelEvents.publish({event:"CLICK",context:r,data:s.cellView.getCellInfos()})}}}}),this.elements.container.addEvent(u.POINTERDOWN,function(e){var i=O(e.target,"wux-datagrid-cell");if(1===e.which&&i&&i.dsView){var n=i.dsView.getCellInfos();n.event=e,void 0!==n.cellModel&&t._modelEvents.publish({event:"pointerDown",context:n.cellModel,data:n})}})}})},registerReusableCellContent:function(e){this._reusableCellContentManager.register(e)},_reuseCellContent:function(e,t){var i=this._reusableCellContentManager.use(e,t);return t._setReusableContent(i.component),i.component},_processModelRequest:function(e){var t=this;!t._isRequestingModelUpdate&&t._onModelRequestCB&&(t._isRequestingModelUpdate=!0,setTimeout(function(){t._onModelRequestCBisAsync&&t._modelEvents.subscribe({event:"modelRequestDone"},function(){e&&(t.initialize(!0),t.updateView(!0)),t._isRequestingModelUpdate=!1});var i=t.getVirtualViewport();t._modelViewPort={minRowID:Math.max(0,i.minRowID-t.getPoolNumberOfRows()*t.options.performances.modelViewportFactor),maxRowID:Math.ceil(i.maxRowID+t.getPoolNumberOfRows()*t.options.performances.modelViewportFactor),minColumnID:Math.max(0,i.minColumnID-t.getPoolNumberOfColumns()*t.options.performances.modelViewportFactor),maxColumnID:Math.ceil(i.maxColumnID+t.getPoolNumberOfColumns()*t.options.performances.modelViewportFactor)},t._onModelRequestCB.call(t,{model:t.options.model,virtualRowID:i.maxRowID,virtualColumnID:i.maxColumnID,modelViewPort:t._modelViewPort}),t._onModelRequestCBisAsync||(e&&(t.initialize(!0),t.updateView(!0)),t._isRequestingModelUpdate=!1)},1))},_computeModelSize:function(e){var t,i,n=this;return n._checkIfMonoDimension(),n._isMonoDimension?n.options.numberOfColumns?i=n.options.numberOfColumns:(i=Math.floor(n.getContent().getDimensions().width/n._getCellWidth()),n.options.model.length>0&&n.options.model.length<i&&(i=n.options.model.length)):(t=n.options.model.length,i=n.options.model[this._getModelMinRowID()]?n.options.model[this._getModelMinRowID()].length:0),n.options.model.length>0&&0===i&&(i=1),n._numberOfColumns=i,n._modelSize.numberOfColumns=n._numberOfColumns,n._isMonoDimension&&(t=0!==i?Math.ceil(n.options.model.length/i):0),n.options.model.length>0&&0===t&&(t=1),n._modelSize.numberOfRows=t,null===this.options.virtualModelSize||e?n.setCellsContainerSize({width:i*n._getCellWidth(),height:t*n._getCellHeight()},e):n.setCellsContainerSize({width:this.options.virtualModelSize.numberOfColumns*n._getCellWidth(),height:this.options.virtualModelSize.numberOfRows*n._getCellHeight()},e),{numberOfRows:t,numberOfColumns:i}},prepareUpdateView:function(){0===this._updateCounter&&this.elements.container&&this._willBeUpdated(),this._updateCounter++},_willBeUpdated:function(){},_hasBeenUpdated:function(){this._modelEvents.publish({event:"UPDATE_VIEW_COMPLETED",context:this,data:{hasAborted:!1}})},pushUpdateView:function(e){this._updateCounter--,0===this._updateCounter&&(0===this.__preventNextUpdateViewCounter?this.updateView(e):(this.__preventNextUpdateViewCounter=0,this._hasBeenUpdated())),this._updateCounter<0&&console.warn("[WARNING]","You pushed too many updateView")},lockUI:function(t){t=e.extend({changeOpacity:!0},t),this.__preventFFLockUIWhenScrollOnDragOver||this.getScroller().getContent().addClassName("wux-ui-locked"),this.getScroller().getContent().setAttribute("wux-opacity",t.changeOpacity)},unlockUI:function(){this.getScroller().getContent().removeClassName("wux-ui-locked"),this.getScroller().getContent().removeAttribute("wux-opacity")},_preventNextUpdateView:function(){this.__preventNextUpdateViewCounter=1},_unpreventNextUpdateView:function(){this.__preventNextUpdateViewCounter=0},removeRow:function(e){this.prepareUpdateView(),this.options.model.splice(e,1),this.pushUpdateView(!0)},loadModel:function(e,t){var i=this;if(void 0===t&&(t=!1),!t){this._destroyPool(),e||(e=this.options.model);var n=e.length;if(n>=0)for(var o=0;o<n;o++){e[o].length>=0&&(e[o]=[])}this.options.model=[]}this.options.model=e,this._gridDimension={width:"100%",height:this.options.height},this._adjustLayout(),this._computeModelSize(),t&&(this._adjustLayout(),this._computeModelSize(),this._alreadyRendered=!1,a.onNodeRendered(i.elements.container,function(){if(!1===i._alreadyRendered){i._alreadyRendered=!0,i.options.model.length&&(i.options.model.length&&(void 0===i.options.model[0]||void 0!==i.options.model[0]&&!i.options.model[0].length)?(i._isMonoDimension=!0,i.elements.container.setAttribute("is-mono-dimensional","true")):(i._isMonoDimension=!1,i.elements.container.setAttribute("is-mono-dimensional","false"))),i._computeModelSize(),!0===i.options.performances.preloadPool&&i.__preloadPool(),i.getViewportDimensions(!0),i.initialize(),i.options.useDynamicCellSpacing&&i._computeDynamicCellSpacing(),i.runEngine(),i._heavyDataColumnModelRequest("onReady"),i._onEndResizeOrOnReadyModelCompletionRequest("onReady"),i._modelEvents.publish({event:"READY",context:i});var e=document.createEvent("Event");e.initEvent("dimensionsChanged",!0,!1),i.getContent().dispatchEvent(e)}else i._computeModelSize(),i.actualizeScrollerPosition(),i.updateView(!0)}),i.options.manageHeight||a.addEndResizeListener(this.elements.container,i._endResizeCallback.bind(this),this.options.performances.resizeDebounceTimeout))},_endResizeCallback:function(){var e=document.activeElement;if(e&&e.tagName&&"input"===e.tagName.toLowerCase()&&a.firstParentWithClass(e,"wux-layouts-gridengine")===this.elements.container)return;var t=this;if(t.elements&&t.elements.container){this._debugPerformanceIssues&&console.log("["+t._name+"]:resize"),t._gridContainerDimensionsModified(),t.getViewportDimensions(!0),t._gridDimension={width:"100%",height:t.elements.container.getDimensions().height},t.options.useDynamicCellSpacing&&t._computeDynamicCellSpacing(),t._adjustLayout(),t._freeUpPool(2),t._computePoolSize(),t._renderViewPort(!0),t._onEndResizeOrOnReadyModelCompletionRequest("onResize"),t._modelEvents.publish({event:"RESIZE",context:t,data:t.getContent().getDimensions()});var i=document.createEvent("Event");i.initEvent("dimensionsChanged",!0,!1),t.getContent().dispatchEvent(i)}},_heavyDataColumnModelRequest:function(e,t){if(this._onHeavyDataColumnModelRequestCB){var i=[],n=[];this.processPoolCells(function(e){var t=e.cellView.getCellInfos();-1===n.indexOf(t.virtualRowID)&&(i.push(t.nodeModel),n.push(t.virtualRowID))});var o=this.getVirtualViewport(!1),s=o.minColumnID,l=o.maxColumnID,r="showColumn"==e&&t&&t.columnID?t.columnID:void 0;if(r&&(r<s||r>l))return;var a={shownColumnID:r,minVisibleColumnID:s,maxVisibleColumnID:l};i.length&&this._onHeavyDataColumnModelRequestCB.call(this,{displayNodesArray:i,context:e,data:a})}},_onEndResizeOrOnReadyModelCompletionRequest:function(e){var t=this;if(t._onEndResizeOrOnReadyModelRequestCB&&t.options.infiniteScrolling){var i=t.getViewportDimensions(!0),n=Math.floor((i.width-t.options.cellSpacing.horizontal)/(t.options.defaultCellWidth+t.options.cellSpacing.horizontal)),o=Math.ceil((i.height-t.options.cellSpacing.vertical)/(t.options.defaultCellHeight+t.options.cellSpacing.vertical));t._isRequestingEndResizeOrOnReadyGridViewModelUpdate=!0,setTimeout(function(){t._onEndResizeOrOnReadyModelRequestCBisAsync&&t._modelEvents.subscribeOnce({event:"endResizeOrOnReadyModelRequestDone"},function(){t.initialize(!0,!0),t.updateView(!0),t._isRequestingEndResizeOrOnReadyGridViewModelUpdate=!1}),t._onEndResizeOrOnReadyModelRequestCB.call(t,{model:t.options.model,RowMaxNumber:o,ColumnsMaxNumber:n,viewportDimensions:i,context:e}),t._onEndResizeOrOnReadyModelRequestCBisAsync||(t.initialize(!0),t.updateView(!0),t._isRequestingEndResizeOrOnReadyGridViewModelUpdate=!1)},1)}},_checkIfMonoDimension:function(){var e=this;if(null===this._isMonoDimension){var t=this.getVirtualViewport();e.options.model.length>0?e.options.model.length&&(void 0===e.options.model[t.minRowID]||void 0!==e.options.model[t.minRowID]&&!e.options.model[t.minRowID].length)?(e._isMonoDimension=!0,e.elements.container.setAttribute("is-mono-dimensional","true")):(e._isMonoDimension=!1,e.elements.container.setAttribute("is-mono-dimensional","false")):this._isMonoDimension=null}},_adjustLayout:function(){var e=this;void 0!==e.options.headersDimensions.width||void 0!==e.options.headersDimensions.height?e._setHeadersDimensions({width:e.options.showRowsHeader?e.options.headersDimensions.width:0,height:e.options.showColumnsHeader?e.options.headersDimensions.height:0}):e._setHeadersDimensions({width:e.options.showRowsHeader?e._getCellWidth():0,height:e.options.showColumnsHeader?e._getCellHeight():0})},onGridResize:function(e){return this._modelEvents.subscribe({event:"RESIZE"},e)},onReady:function(e){return this._alreadyRendered?e.call(this):this._modelEvents.subscribe({event:"READY"},e)},onPerformanceAnalysisAvailbale:function(e){return this._modelEvents.subscribe({event:"performanceAnalysisAvailable"},e)},initialize:function(e,t){var i=this;t||(i.__cachedScrollPos={x:0,y:0},i.__cachedScrollDistance=0);var n,o=i.options.model.length;n=i.options.model[0]&&i.options.model[0].length?i.options.model[0].length:i.options.numberOfColumns?i._numberOfColumns:Math.floor(i.getContent().getDimensions().width/i._getCellWidth()),this.updateModelSize({numberOfRows:o,numberOfColumns:n}),e||(i._generatePool(),i._setVirtualPosition({virtualRowID:0,virtualColumnID:0}))},_setVirtualPosition:function(t,i){e.extend(this._virtualPos,t),this._computeVirtualViewport(i)},_computeVirtualViewportFromScrollPosition:function(){var e=this._getVirtualPositionFromScrollPosition(),t=this.getPoolNumberOfRows(),i=this.getPoolNumberOfColumns();e.rowID=e.rowID+Math.floor(t/this.options.performances.numberOfRowsFactor/2),e.columnID=e.columnID+Math.floor(i/this.options.performances.numberOfColumnsFactor/2);var n=Math.floor(t/2),o=Math.floor(i/2);return{minRowID:Math.max(e.rowID-n,0),maxRowID:Math.min(e.rowID-n+t,this._modelSize.numberOfRows-1),minColumnID:Math.max(e.columnID-o,0),maxColumnID:Math.min(e.columnID-o+i,this._modelSize.numberOfColumns-1)}},_computeVirtualViewport:function(){var e=this.getViewportDimensions(),t=this.getScrollerPosition(),i=this.getModelSize(),n=i.numberOfRows,o=i.numberOfColumns,s=Math.floor(t.y/this._getCellHeight())-2,l=Math.floor((t.y+e.height)/this._getCellHeight())+2,r=Math.floor(t.x/this._getCellWidth())-2,a=Math.floor((t.x+e.width)/this._getCellWidth())+2;return s=Math.max(0,s),l=Math.min(l,n-1),r=Math.max(0,r),a=Math.min(a,o-1),this._viewportBbox={minRowID:s,maxRowID:l,minColumnID:r,maxColumnID:a},this._virtualPos={virtualRowID:this._viewportBbox.minRowID,virtualColumnID:this._viewportBbox.minColumnID},this._viewportBbox},_computeDeltaViewport:function(){var e=this._viewportBbox,t=this._computeVirtualViewport();return{minRowID:t.minRowID-e.minRowID,maxRowID:t.maxRowID-e.maxRowID,minColumnID:t.minColumnID-e.minColumnID,maxColumnID:t.maxColumnID-e.maxColumnID}},getVirtualViewport:function(e){return this._viewportBbox},setCellsContainerSize:function(t,i){void 0===i&&(i=!0),(this._poolContainerSize.width!==t.width&&t.width>=0||this._poolContainerSize.height!==t.height&&t.height>=0)&&(e.extend(this._poolContainerSize,t),this._needToApplyCellContainerSize=!0)},getCellsContainerSize:function(){return this._poolContainerSize},updateModelSize:function(e){var t=this.options.virtualModelSize;if(null!==t)this._modelSize.numberOfRows=t.numberOfRows,this._modelSize.numberOfColumns=t.numberOfColumns;else if(e)this._modelSize.numberOfRows=e.numberOfRows,this._modelSize.numberOfColumns=e.numberOfColumns,this._numberOfColumns=e.numberOfColumns;else{var i,n=this.options.model.length;this.options.model[0]&&this.options.model[0].length?i=this.options.model[0].length:this.options.numberOfColumns?(i=this.options.numberOfColumns,this._numberOfColumns=this.options.numberOfColumns):0===(i=Math.floor(this._viewportDimensions.width/this._getCellWidth()))&&(i=1),this.updateModelSize({numberOfRows:n,numberOfColumns:i})}},getModelSize:function(e){return void 0===e&&(e=!0),e&&this.updateModelSize(),this._modelSize},updateHeight:function(e){this.elements.container.setStyle("height","auto"===e?"100%":e),this._gridContainerDimensionsModified()},_buildLayout:function(){this.elements.container=new e.Element("div",{class:"wux-layouts-gridengine",styles:{overflow:"hidden",width:"100%",position:"relative",height:"auto"===this.options.height?"100%":this.options.height}}),"auto"===this.options.height&&a.setStyles(this.elements.container,{position:"absolute",top:0,left:0,bottom:0,width:"100%"}),this.elements.topHeaderLayout=new e.Element("ul",{class:"wux-ui-stack-h",styles:{display:"block",position:"relative",zIndex:400002}}).inject(this.elements.container),this.elements.corner=new e.Element("li",{class:"wux-layouts-gridengine-corner"}).inject(this.elements.topHeaderLayout),this.elements.columnsHeaderContainer=new e.Element("li",{class:"wux-layouts-gridengine-columns-header-container",styles:{position:"absolute",top:0,bottom:0,right:0,whiteSpace:"nowrap",overflow:"hidden"}}).inject(this.elements.topHeaderLayout),this.elements.columnsHeaderContainerRel=new e.Element("div",{class:"",styles:{position:"relative",height:"100%",width:"100%"}}).inject(this.elements.columnsHeaderContainer),this.elements.mainLayout=new e.Element("ul",{class:"wux-ui-stack-h",styles:{display:"block",position:"relative"}}).inject(this.elements.container),this.elements.rowsHeaderContainer=new e.Element("li",{class:"wux-layouts-gridengine-rows-header-container",styles:{position:"absolute",top:0,bottom:0,left:0,overflow:"hidden"}}).inject(this.elements.mainLayout),this.elements.rowsHeaderContainerRel=new e.Element("div",{class:"",styles:{position:"relative",height:"100%",width:"100%"}}).inject(this.elements.rowsHeaderContainer),this.elements.gridHeaderContainer=new e.Element("li",{class:"",styles:{position:"absolute",top:0,bottom:0,right:0}}).inject(this.elements.mainLayout),this.elements.gridHeaderContainerRel=new e.Element("div",{class:"wux-layouts-gridengine-scroller-container","show-at-hover":this.options.showScrollbarsOnHover,styles:{position:"relative"}}).inject(this.elements.gridHeaderContainer),this.elements.poolContainerRel=new e.Element("div",{class:"wux-layouts-gridengine-poolcontainer-rel",styles:{position:"relative",height:"100%",width:"100%"}}),this.elements.poolContainerRelDettachable=new e.Element("div",{}).inject(this.elements.poolContainerRel),this.elements.poolContainerRel.inject(this.elements.container)},_beginUpdate:function(){0},_endUpdate:function(){0},setHeadersDimensions:function(e){this._setHeadersDimensions(e)},_setHeadersDimensions:function(e){void 0!==e.width&&(0===e.width?(this.elements.corner.hide(),this.elements.rowsHeaderContainer.hide()):(this.elements.corner.show(),this.elements.rowsHeaderContainer.show())),void 0!==e.height&&(0===e.height?this.elements.columnsHeaderContainer.hide():this.elements.columnsHeaderContainer.show()),a.setStyles(this.elements.rowsHeaderContainer,{width:e.width}),a.setStyles(this.elements.gridHeaderContainer,{left:e.width}),a.setStyles(this.elements.mainLayout,{position:"absolute",top:e.height,left:0,right:0,bottom:0});var t=0;this.getScroller()&&(t=this.getScroller().getPosition().x);a.setStyles(this.elements.columnsHeaderContainer,{left:e.width+t}),a.setStyles(this.elements.corner,{width:e.width}),a.setStyles(this.elements.topHeaderLayout,{height:e.height}),this._headersDimension=e},getHeadersDimensions:function(){return void 0===this._headersDimension.width&&(this._headersDimension.width=this._getCellWidth()),void 0===this._headersDimension.height&&(this._headersDimension.height=this._getCellHeight()),this._headersDimension},getCellModel:function(e,t){if(void 0===t)return this._isMonoDimension?this.options.model[e]:this.options.model[Math.floor(e/this._numberOfColumns)][e%this._numberOfColumns];if(this._isMonoDimension)return this.options.model[e*this._numberOfColumns+t];if(-1!==t&&-1!==e){var i=this.getModelSize();return e<i.numberOfRows&&t<i.numberOfColumns&&this.options.model[e]?this.options.model[e][t]:void 0}},onModelRequest:function(e){this._onModelRequestCBisAsync=!1,this._onModelRequestCB=e},onModelRequestAsync:function(e){this._onModelRequestCBisAsync=!0,this._onModelRequestCB=e},modelRequestAsyncDone:function(){return this._modelEvents.publish({event:"modelRequestDone",context:this})},onEndResizeOrOnReadyModelRequest:function(e){this._onEndResizeOrOnReadyModelRequestCBisAsync=!1,this._onEndResizeOrOnReadyModelRequestCB=e},onEndResizeOrOnReadyModelRequestAsync:function(e){this._onEndResizeOrOnReadyModelRequestCBisAsync=!0,this._onEndResizeOrOnReadyModelRequestCB=e},EndResizeOrOnReadyModelRequestAsyncDone:function(){return this._modelEvents.publish({event:"endResizeOrOnReadyModelRequestDone",context:this})},onInfiniteScroll:function(e){this._onInfiniteScrollCBisAsync=!1,this._onInfiniteScrollCB=e},onInfiniteScrollAsync:function(e){this._onInfiniteScrollCBisAsync=!0,this._onInfiniteScrollCB=e},infiniteScrollAsyncProcessDone:function(){return this._modelEvents.publish({event:"BottomReachedDone",context:this})},onHeavyDataColumnModelRequest:function(e){this._onHeavyDataColumnModelRequestCB=e},onCellRequest:function(e){this._onRequestCellCB=e},addEventListener:function(e,t,i){var n=this,o=function(e){if(!n._isRequestingCell){var i=a.firstParentWithClass(e.target,"wux-datagrid-cell");if(i){var o=i.dsView.getCellInfos();t(e,o)}else t(e)}};return n.getContent().addEventListener(e,o,i),o},removeEventListener:function(e,t,i){this.getContent().removeEventListener(e,t,i)},onCellClick:function(e){return this._modelEvents.subscribe({event:"CLICK"},e)},onCellPointerDown:function(e){return this._modelEvents.subscribe({event:"pointerDown"},e)},onRowHeaderRequest:function(e){this._onRequestRowHeaderCB=e},onColumnHeaderRequest:function(e){this._onRequestColumnHeaderCB=e},getScroller:function(){return this.elements.scroller},_getScrollerDimensions:function(e){if(!this._scrollerDimensions||e){var t=this.getScroller();t&&t.elements&&t.elements.container&&(this._scrollerDimensions=t.getContent().getDimensions())}return this._scrollerDimensions},getScrollerPosition:function(e){if(this.__cachedScrollPos&&!e)return this.__cachedScrollPos;if(this.getScroller()){var t=this.getScroller()._scrollPosition;return{x:t.x,y:t.y}}return{x:0,y:0}},_syncScrollPositionToHeaders:function(){var e=this.getScrollerPosition(!0);a.setStyles(this.elements.columnsHeaderContainer,{left:-e.x+this._headersDimension.width}),a.setStyles(this.elements.rowsHeaderContainer,{top:-e.y})},setScrollerPosition:function(e,t){this._computePoolSize(),0===this.getPoolNumberOfRows()&&0===this.getPoolNumberOfColumns()?this.onPostUpdateViewOnce(function(){this._computePoolSize(),this._applyScrollerPosition(e)}):this._applyScrollerPosition(e,t)},_applyScrollerPosition:function(e,t){this.getScroller()&&(t||this.prepareUpdateView(),e.x=e.x||0,e.y=e.y||0,this.getScroller().elements.container.scrollLeft=e.x,this.getScroller().elements.container.scrollTop=e.y,t||this.pushUpdateView(!0))},actualizeScrollerPosition:function(){if(this.getScroller()){const e=this.getScroller().getContent().scrollLeft,t=this.getScroller().getContent().scrollTop;this.__cachedScrollPos={x:e,y:t},this.getScroller().setPosition({x:e,y:t})}else this.__cachedScrollPos={x:0,y:0}},getRowPosition:function(e){return e*this._getCellHeight()},getColumnPosition:function(e){return e*this._getCellWidth()},_doesColumnNeedToBeRequested:function(e){return!0},_getVirtualPositionFromScrollPosition:function(e){return void 0===e&&(e=this.getScroller()?this.getScrollerPosition():{x:0,y:0}),{rowID:parseInt(Math.abs(e.y)/this._getCellHeight(),10),columnID:parseInt(Math.abs(e.x)/this._getCellWidth(),10)}},_getCoordinatesFromEvent:function(e){var t=this.getScrollerPosition(),i=this.getHeadersDimensions(),n=this.elements.container.style.zoom?parseFloat(this.elements.container.style.zoom,10):1,o=function(e,t,i){void 0===i&&(i=1);var n=t?e.currentTarget:e.target||e.srcElement,o=n.currentStyle||window.getComputedStyle(n,null),s=parseInt(o.borderLeftWidth,10),l=parseInt(o.borderTopWidth,10),r=n.getBoundingClientRect(),a=e.changedTouches&&e.changedTouches.length?e.changedTouches[0].clientX:e.clientX,u=e.changedTouches&&e.changedTouches.length?e.changedTouches[0].clientY:e.clientY;return{offsetX:a*i-s-r.left,offsetY:u*i-l-r.top}}(e,!0,1-n+1),s=o.offsetX+t.x-i.width*n,l=o.offsetY+t.y-i.height*n;return o.offsetX<i.width*n?{rowID:this._getVirtualPositionFromScrollPosition({x:s,y:l}).rowID,columnID:-1}:o.offsetY<i.height*n?{columnID:this._getVirtualPositionFromScrollPosition({x:s,y:l}).columnID,rowID:-1}:this._getVirtualPositionFromScrollPosition({x:s,y:l})},_getRowIDFromEvent:function(e){return this._getCoordinatesFromEvent(e).rowID},_getColumnIDFromEvent:function(e){return this._getCoordinatesFromEvent(e).rowID},_getCellInfosFromDom:function(e){if(e&&e.dsView){var t=e.dsView.getCellInfos();return t.rowID=t.virtualRowID,t.columnID=t.virtualColumnID,t}return{virtualRowID:void 0,virtualColumnID:void 0,cellModel:void 0,cellView:void 0,dataIndex:void 0,typeRepresentation:void 0,manager:void 0,isHeader:void 0}},_getCellInfosFromEventTarget:function(e){var t=O(e.target,"wux-datagrid-cell");return this._getCellInfosFromDom(t)},_draggable:function(e){var t=!1,i=this,n=function(n){n.type,t=!0;var o=i._getCellInfosFromEventTarget(n);o&&e.begin(n,o)},o=function(n){t=!1;var o=i._getCoordinatesFromEvent(n);o&&e.end(n,o)};this.elements.container.addEventListener("touchstart",n),this.elements.container.addEventListener("mousedown",n),this.elements.container.addEventListener(u.POINTERMOVE,function(n){if(t){var o=i._getCoordinatesFromEvent(n);o&&e.drag(n,o)}}),this.elements.container.addEventListener("mouseup",o),this.elements.container.addEventListener("touchend",o)},runEngine:function(){var t,i=this;this.elements.scroller=new r(this.elements.poolContainerRel,{eventPeriod:0,useUWAScroller:this.options.useTransparentScroller}).inject(this.elements.gridHeaderContainerRel),a.setStyles(this.elements.scroller.getContent(),{position:"absolute",left:0,top:0,bottom:0,width:"100%",height:"100%"}),i._hasBeenUpdated(),i.getScroller().getContent().addEventListener(u.POINTERMOVE,function(e){u.isTouchEvent(e)&&(i._preventSelectionForTouchScroll=!0,clearTimeout(t),t=setTimeout(function(){i._preventSelectionForTouchScroll=!1},2e3))},!1);var n=0;this.elements.scroller.onScrollBegin(function(){i._beginScrollPosition=this.getPosition(),i._scrollPositionFromBeginning={x:0,y:0},i.lockUI({changeOpacity:!1})}),this.elements.scroller.onScroll(function(t){i._deltaScrollPositionFromBeginning=this.getDeltaScrollPositionFromBeginning();var o=i.getScrollerPosition(!0);i._syncScrollPositionToHeaders(),i.__cachedScrollDistance=Math.sqrt((o.x-i.__cachedScrollPos.x)*(o.x-i.__cachedScrollPos.x)+(o.y-i.__cachedScrollPos.y)*(o.y-i.__cachedScrollPos.y)),n+=i.__cachedScrollDistance;var s={x:o.x-i.__cachedScrollPos.x,y:o.y-i.__cachedScrollPos.y};if(i.__cachedScrollPos=o,n>=i.options.performances.minimumScrollDistance){n=0;var l=this.getPosition();i._scrollDirection=s,i.__lastScrollPos=l;var r=5*parseInt(i._getCellHeight(),10),a=5*parseInt(i._getCellWidth(),10),u=i.getCellsContainerSize(),h=u.height-i._viewportDimensions.height;h-r>0&&(h-=r);var d=u.width-i._viewportDimensions.width;d-a>0&&(d-=a);var m=!1,c=!1,_=!1,p=!1,f=i.options.pageScrollValueTriggeringInfiniteScroll;if(null!=f){if(e.is(f,"number")){if(f<=0||f>=1)throw"You gave a wrong value for pageScrollValueTriggeringInfiniteScroll option. Please provide a value strictly between 0 and 1.";c=Math.abs(o.y)+f*i._viewportDimensions.height>=f*u.height,p=Math.abs(o.y)>=h&&h>0,m=Math.abs(o.x)>=d&&d>0}else if(e.is(f,"object")){if(null!=f.x){if(f.x<=0||f.x>=1)throw"You gave a wrong value for pageScrollValueTriggeringInfiniteScroll.x option. Please provide a value strictly between 0 and 1.";m=Math.abs(o.x)+f.x*i._viewportDimensions.width>=f.x*u.width,_=Math.abs(o.x)>=d&&d>0}else m=Math.abs(o.x)>=d&&d>0;if(null!=f.y){if(f.y<=0||f.y>=1)throw"You gave a wrong value for pageScrollValueTriggeringInfiniteScroll.y option. Please provide a value strictly between 0 and 1.";c=Math.abs(o.y)+f.y*i._viewportDimensions.height>=f.y*u.height,p=Math.abs(o.y)>=h&&h>0}else c=Math.abs(o.y)>=h&&h>0}}else m=Math.abs(o.x)>=d&&d>0,c=Math.abs(o.y)>=h&&h>0;(s.x>0&&m||s.y>0&&c)&&i._onInfiniteScrollCB&&i.options.infiniteScrolling&&(s.x>=0||s.y>=0)&&(i._isRequestingModelUpdate||(i._isRequestingModelUpdate=!0,setTimeout(function(){i._onInfiniteScrollCBisAsync?i._modelEvents.subscribeOnce({event:"BottomReachedDone"},function(){i.prepareUpdateView(),i.pushUpdateView(!0),i._isRequestingModelUpdate=!1}):i.prepareUpdateView();var e=i.getVirtualViewport();i._onInfiniteScrollCB.call(i,{reachBottom:c,reachRight:m,model:i.options.model,virtualRowID:e.maxRowID,virtualColumnID:e.maxColumnID,isVeryCloseFromRight:_,isVeryCloseFromBottom:p}),i._onInfiniteScrollCBisAsync||(i.initialize(!0),i._computeModelSize(),i._isRequestingModelUpdate=!1)},1)));var C=function(){switch(i.options.performances.renderingMode){case"adaptive":i.updateView();break;case"standard":var e=i.getViewportDimensions();if(Math.abs(l.y)===u.height-i._gridDimension.height)i.updateView();else{var t=Math.abs(s.y)<=i.options.performances.fullUpdateFactor*e.height,n=Math.abs(s.x)<=i.options.performances.fullUpdateFactor*e.width;!i._isDebouncingUpdateView&&t&&n?i.iterativeUpdate(l,s):(i._freeUpPool(1),i.updateView())}}};i.options.performances.useRequestAnimationFrameRendering?v.addTask({namespace:"wux-gridengine-render"+i._uuid,callback:function(){C()},taskArgs:[]},"wux-gridengine-render"+i._uuid):C()}}),this.elements.scroller.onScrollEnd(function(){i._preventSelectionForTouchScroll=!1,0===i._deltaScrollPositionFromBeginning.x&&0===i._deltaScrollPositionFromBeginning.y||(0!==i._deltaScrollPositionFromBeginning.y||0!==i._deltaScrollPositionFromBeginning.x&&i.options.performances.enableColumnVirtualization)&&i._heavyDataColumnModelRequest("onScrollEnd"),"adaptive"===i.options.performances.renderingMode&&i._renderViewPort(),i._preventScrollEnd?i._preventScrollEnd=!1:(i._preventFullUpdate=!1,i._requestModelIfNeeded(!0)),i.unlockUI()}),this._modelEvents.subscribe({event:"UPDATE_VIEW"},function(){i._renderViewPort()}),i._renderViewPort(!0)},_applyCellsContainerSizeIfNeeded:function(){!0===this._needToApplyCellContainerSize&&this.getContent().offsetParent&&(a.setStyles(this.elements.poolContainerRel,{width:this._poolContainerSize.width,height:this._poolContainerSize.height<=0?1:this._poolContainerSize.height}),(!b.chrome||window.navigator.userAgent.indexOf("Edge"))&&this._poolContainerSize.height>21474836&&(this.elements.poolContainerRel.style.height="1e+07px"),this._needToApplyCellContainerSize=!1,this._viewportDimensions.width<this._poolContainerSize.width?this.elements.gridHeaderContainerRel.setAttribute("has-overflow-x",!0):this.elements.gridHeaderContainerRel.setAttribute("has-overflow-x",!1),this._viewportDimensions.height<this._poolContainerSize.height?this.elements.gridHeaderContainerRel.setAttribute("has-overflow-y",!0):this.elements.gridHeaderContainerRel.setAttribute("has-overflow-y",!1))},getListOfCellsInVisibleViewport:function(e){void 0===e&&(e={});for(var t=this._computeVirtualViewport(),i={},n=t.minColumnID;n<=t.maxColumnID;n++){i["-1_"+n]=!0,e.callback&&e.callback({virtualRowID:-1,virtualColumnID:n})}for(n=t.minRowID;n<=t.maxRowID;n++){i[n+"_-1"]=!0,e.callback&&e.callback({virtualRowID:n,virtualColumnID:-1})}for(n=t.minRowID;n<=t.maxRowID;n++)for(var o=t.minColumnID;o<=t.maxColumnID;o++){i[n+"_"+o]=!0,e.callback&&e.callback({virtualRowID:n,virtualColumnID:o})}return i},_renderViewPort:function(e){if(this.getScroller())switch(this.options.performances.renderingMode){case"adaptive":if(!0!==this._viewportBboxIsRendering){if(this._listOfColumnCellPerformances={},this._beginUpdate(),this._updateViewOptions.onPreUpdate){var t=this._updateViewOptions.onPreUpdate;this._updateViewOptions.onPreUpdate=null,t.call(this)}this._applyCellsContainerSizeIfNeeded(),"inherit"===this.options.height&&this._applyInheritedHeight(),this._modelEvents.publish({event:"preFullUpdateView",context:this,data:{}}),this._debugPerformanceIssues&&(console.time("["+this._name+"]:render viewport"),window.performance.mark("gridengine_gridengine_renderviewport_begin")),this._viewportBboxIsRendering=!0;var i=this.getListOfCellsInVisibleViewport({callback:function(e){this._renderCell(e)}.bind(this)});for(var n in this._listOfRenderedCells)void 0===i[n]&&this._freeUpCellFromIdentifier(n);for(var n in this._listOfRenderedRowHeaders)void 0===i[n]&&this._freeUpCellFromIdentifier(n);for(var n in this._listOfRenderedColumnHeaders)void 0===i[n]&&this._freeUpCellFromIdentifier(n);this._viewportBboxIsRendering=!1,this._debugPerformanceIssues&&console.timeEnd("["+this._name+"]:render viewport"),this._notifyUpdateViewCompleted()}else console.log("[E]");break;case"standard":if(this._listOfColumnCellPerformances={},this._beginUpdate(),e&&this._freeUpPool(0),this._updateViewOptions.onPreUpdate){t=this._updateViewOptions.onPreUpdate;this._updateViewOptions.onPreUpdate=null,t.call(this)}this._applyCellsContainerSizeIfNeeded(),"inherit"===this.options.height&&this._applyInheritedHeight(),this._modelEvents.publish({event:"preFullUpdateView",context:this,data:{}});var o=this._getVirtualPositionFromScrollPosition();this.getPoolNumberOfRows(),this.getPoolNumberOfColumns(),o=this._computeVirtualViewport();this._debugPerformanceIssues&&(console.time("["+this._name+"]:render viewport"),window.performance.mark("gridengine_gridengine_renderviewport_begin")),this._viewportBboxIsRendering=!0,!0===this.options.showColumnsHeader&&this._renderRow(-1);var s=this.getNumberOfRows();!0===this.options.showColumnsHeader&&0===s&&this._renderRow(0);for(var l=o.minRowID;l<=this._viewportBbox.maxRowID&&l<s;l++)this._renderRow(l);this._viewportBboxIsRendering=!1,this._debugPerformanceIssues&&console.timeEnd("["+this._name+"]:render viewport"),this._notifyUpdateViewCompleted()}},_notifyUpdateViewCompleted:function(){if(this._endUpdate(),this._validateLayout(),this._debugPerformanceIssues){for(var e in console.groupCollapsed("["+this._name+"]:Update View"),this._listOfColumnCellPerformances){var t=this._listOfColumnCellPerformances[e],i=t.reduce(function(e,t){return e+t}),n=i/t.length;console.info("rendering time for column",e+":",Math.round(100*i)/100,"ms . Mean time per cell:",Math.round(1e3*n)/1e3,"ms","for",t.length,"cells")}window.performance.mark("gridengine_gridengine_renderviewport_end"),this._modelEvents.publish({event:"performanceAnalysisAvailable",context:this,data:this._listOfColumnCellPerformances}),this._listOfColumnCellPerformances={},console.groupEnd("["+this._name+"]:Update View")}this._modelEvents.publish({event:"UPDATE_VIEW_COMPLETED",context:this,data:{hasAborted:!1}})},_renderColumn:function(e){var t=this,i=this.getPoolNumberOfRows(),n=this._viewportBbox;t._renderCell({virtualRowID:-1,virtualColumnID:e});for(var o=-1,s=0;s<i&&o<t._modelSize.numberOfRows-1;s++)o=Math.min(t._modelSize.numberOfRows-1,n.minRowID+s),t._renderCell({virtualCellID:o*t._numberOfColumns+e,virtualRowID:o,virtualColumnID:e})},_renderRowCB:function(e){var t=this,i=t.getVirtualViewport();if(-1===e&&!0===t.options.showColumnsHeader)for(var n=-1,o=i.minColumnID;o<=i.maxColumnID;o++)t._renderCell({virtualRowID:e,virtualColumnID:o});else if(e<t._modelSize.numberOfRows){this._applyCellsContainerSizeIfNeeded(),a.setUWAElementVisibility(this.elements.poolContainerRelDettachable,!0),e>=0&&!0===t.options.showRowsHeader&&t._renderCell({virtualRowID:e,virtualColumnID:-1});for(n=-1,o=i.minColumnID;o<=i.maxColumnID&&n<t._modelSize.numberOfColumns-1;o++)n=Math.min(t._modelSize.numberOfColumns-1,o),t._renderCell({virtualRowID:e,virtualColumnID:o});t._lastRenderedRowID=e}else this._needToApplyCellContainerSize=!0,this.elements.poolContainerRel.setStyle("height","1px"),a.setUWAElementVisibility(this.elements.poolContainerRelDettachable,!1)},_renderRow:function(e){switch(this.options.performances.renderingMode){case"adaptive":!0!==this._viewportBboxIsRendering&&this._renderRowCB(e);break;case"standard":this._renderRowCB(e)}},_freeUpRow:function(e){for(var t=this._viewportBbox.minColumnID;t<=this._viewportBbox.maxColumnID;t++)this._freeUpCell(e,t)},_freeUpPool:function(e){var t;for(t in this._lastRenderedRowID=null,void 0===e&&(e=1),this._listOfRenderedCells){(i=this._listOfRenderedCells[t])._clean(),i._disposeReusableContent(),3===e&&i.destroy(),2===e&&(i.getContent().remove(),this._listOfFreeCells.unshift(i)),1===e&&(i.getContent().hide(),this._listOfFreeCells.unshift(i)),0===e&&this._listOfFreeCells.unshift(i),delete this._listOfRenderedCells[t]}for(t in this._listOfRenderedRowHeaders){(i=this._listOfRenderedRowHeaders[t])._clean(),i._disposeReusableContent(),3===e&&i.destroy(),2===e&&(i.getContent().remove(),this._listOfFreeRowHeaders.unshift(i)),1===e&&(i.getContent().hide(),this._listOfFreeRowHeaders.unshift(i)),0===e&&this._listOfFreeRowHeaders.unshift(i),delete this._listOfRenderedRowHeaders[t]}for(t in this._listOfRenderedColumnHeaders){var i;(i=this._listOfRenderedColumnHeaders[t])._clean(),i._disposeReusableContent(),3===e&&i.destroy(),2===e&&(i.getContent().remove(),this._listOfFreeColumnHeaders.unshift(i)),1===e&&(i.getContent().hide(),this._listOfFreeColumnHeaders.unshift(i)),0===e&&this._listOfFreeColumnHeaders.unshift(i),delete this._listOfRenderedColumnHeaders[t]}},_freeUpCellFromIdentifier:function(e){var t=e.split("_"),i=parseInt(t[0],10),n=parseInt(t[1],10);return this._freeUpCell(i,n)},_freeUpCell:function(e,t){var i=e+"_"+t,n=this._getListOfRenderedForCellAt({virtualRowID:e,virtualColumnID:t}),o=this._getListOfFreeForCellAt({virtualRowID:e,virtualColumnID:t});if(n[i]){var s=n[i];s.getContent().style.display="none",s._clean(),s._disposeReusableContent(),o.push(s),delete n[i]}},_getListOfFreeForCellAt:function(e){var t;return-1!==e.virtualRowID&&-1!==e.virtualColumnID?t=this._listOfFreeCells:-1===e.virtualRowID?t=this._listOfFreeColumnHeaders:-1===e.virtualColumnID&&(t=this._listOfFreeRowHeaders),t},_addToListOfRenderedForCellAt:function(e,t){var i=e.virtualRowID+"_"+e.virtualColumnID;return-1!==e.virtualRowID&&-1!==e.virtualColumnID?this._listOfRenderedCells[i]=t:-1===e.virtualRowID?this._listOfRenderedColumnHeaders[i]=t:-1===e.virtualColumnID&&(this._listOfRenderedRowHeaders[i]=t),t},_getListOfRenderedForCellAt:function(e){var t;return-1!==e.virtualRowID&&-1!==e.virtualColumnID?t=this._listOfRenderedCells:-1===e.virtualRowID?t=this._listOfRenderedColumnHeaders:-1===e.virtualColumnID&&(t=this._listOfRenderedRowHeaders),t},_isCellRendered:function(e){var t=this._getListOfRenderedForCellAt(e),i=e.virtualRowID+"_"+e.virtualColumnID;return Boolean(t[i])},_freeUpColumn:function(e){for(var t=this._viewportBbox.minRowID;t<=this._viewportBbox.maxRowID;t++)this._freeUpCell(t,e)},__preloadPool:p.debounce(function(){var e=this._poolSizeMax.numberOfRows,t=e*this._poolSizeMax.numberOfColumns-(Object.keys(this._listOfRenderedCells).length+this._listOfFreeCells.length);if(t>0)do{var i;if(t%e==0)(i=this.__createRowHeaderCell())._free(),this._listOfFreeRowHeaders.push(i),t--;(i=this.__createCell())._free(),this._listOfFreeCells.push(i),t--}while(t>0)},10),__createCell:function(){var e=new this.options.cellClass({gridEngine:this,rootMargin:this.options.rootMargin,childrenMargin:this.options.childrenMargin,parent:this.options.parent,width:this._getCellWidth(),height:this._getCellHeight()});return e.POOL_CELL_ID=I++,R&&e.getContent().setStyles({transition:"all 1s"}),e.inject(this.elements.poolContainerRelDettachable),this._modelEvents.publish({context:e,data:{cellView:e,rowID:-1,columnID:-1},event:"EVT_CELL_CREATION"}),e},__createRowHeaderCell:function(){var t=this.getHeadersDimensions(),i=new this.options.cellClass({gridEngine:this,parent:this.options.parent,width:t.width,height:this._getCellHeight(),isHeader:!0});return i.getContent().addClassName("wux-datagrid-header"),i.inject(this.elements.rowsHeaderContainerRel),i.nodeColor=new e.Element("div",{class:"wux-datagrid-node-color"}),this._modelEvents.publish({context:i,data:{cellView:i,rowID:-1,columnID:-1},event:"EVT_CELL_CREATION"}),i},__createColumnHeaderCell:function(){var e=this.getHeadersDimensions(),t=new this.options.cellClass({gridEngine:this,parent:this.options.parent,width:this._getCellWidth(),height:e.height,isHeader:!0});t.getContent().addClassName("wux-datagrid-header"),t.inject(this.elements.columnsHeaderContainerRel);var i=this;return t.getContent().addEvent(u.POINTERUP,function(){i._modelEvents.subscribe({context:i,data:null,event:"COLUMN_HEADER_CLICK"})}),this._modelEvents.publish({context:t,data:{cellView:t,rowID:-1,columnID:-1},event:"EVT_CELL_CREATION"}),t},_createCell:function(e){return-1!==e.virtualRowID&&-1!==e.virtualColumnID?this.__createCell():-1===e.virtualRowID?this.__createColumnHeaderCell():this.__createRowHeaderCell()},__getCellFromPool:function(e){var t,i=e.virtualRowID+"_"+e.virtualColumnID;if(this._isCellRendered(e)){var n=this._getListOfRenderedForCellAt(e);t=n[i]}else{var o=this._getListOfFreeForCellAt(e);0===o.length?t=this._createCell(e):(t=o.pop(),R&&t.getContent().setStyles({background:"rgb(15, 237, 197)",boxShadow:"0 0 10px silver",zIndex:1e4}),t.getContent().style.display="block",-1!==e.virtualRowID&&-1!==e.virtualColumnID?t.inject(this.elements.poolContainerRelDettachable):-1===e.virtualRowID?t.inject(this.elements.columnsHeaderContainerRel):t.inject(this.elements.rowsHeaderContainerRel),R&&setTimeout(function(){t.getContent().setStyles({background:"",boxShadow:"",zIndex:""})},1e3)),this._addToListOfRenderedForCellAt(e,t)}if(!t)throw"Error cannot get a cell from pool";return t},_isLayoutValid:function(){return!(!0===this.__layoutIsInvalid)},_invalidateLayout:function(){this.__layoutIsInvalid=!0},_validateLayout:function(){this.__layoutIsInvalid=!1},needToRequestContentAt:function(e){return!1},needToRenderCellAt:function(e){return-1!==e.virtualColumnID&&-1!==e.virtualRowID||(!0===this.options.showRowsHeader&&-1===e.virtualColumnID||!0===this.options.showColumnsHeader&&-1===e.virtualRowID)},_renderCell:function(e){if(void 0!==this.getCellModel(e.virtualRowID,e.virtualColumnID)||-1===e.virtualRowID||-1===e.virtualColumnID)if(!1===this._isCellRendered(e)||"standard"===this.options.performances.renderingMode)this._renderCellCB(e);else{var t=!1===this._isLayoutValid(),i=this.needToRequestContentAt(e),n=this.needToRenderCellAt(e);"adaptive"===this.options.performances.renderingMode&&(t||i)&&n&&this._renderCellCB(e)}},_renderCellCB:function(e){e.cellView=this.__getCellFromPool(e);var t,i=this.getPoolNumberOfRows()+1,n=this.getPoolNumberOfColumns()+1,o=-1===e.virtualRowID?e.virtualRowID:e.virtualRowID%i,s=-1===e.virtualColumnID?e.virtualColumnID:e.virtualColumnID%n;switch(e.rowID=o,e.columnID=s,e.cellID=o*this._numberOfColumns+e.virtualColumnID,this._debugPerformanceIssues&&(void 0===this._listOfColumnCellPerformances[e.virtualColumnID]&&(this._listOfColumnCellPerformances[e.virtualColumnID]=[]),t=window.performance?performance.now():Date.now()),this.options.performances.renderingOptimization){case 1:e.cellView.getContent().style.display="none";break;case 2:e.cellView.getContent().remove()}switch(this.options.performances.use2PassRendering&&e.cellView.updateInternalParameters(),e.cellView.getContent().style.display="none",e.cellView._setVirtualCoordinates({rowID:e.rowID,columnID:e.columnID,virtualRowID:e.virtualRowID,virtualColumnID:e.virtualColumnID}),e.cellView.updateInternalParameters(),this.__requestCellContent(e),e.cellView.placeCell(),this.options.performances.renderingOptimization){case 1:e.cellView.getContent().style.display="block";break;case 2:e.cellView.getContent().style.display="",-1===e.virtualRowID?this.elements.columnsHeaderContainerRel.appendChild(e.cellView.getContent()):-1===e.virtualColumnID?this.elements.rowsHeaderContainerRel.appendChild(e.cellView.getContent()):this.elements.poolContainerRelDettachable.appendChild(e.cellView.getContent());break;default:e.cellView.getContent().style.display=""}if(this._debugPerformanceIssues){var l=window.performance?performance.now():Date.now();this._listOfColumnCellPerformances[e.virtualColumnID].push(l-t)}},__requestCellContent:function(e){-1===e.virtualColumnID?this._onInternalRequestRowHeaderCB&&this._onInternalRequestRowHeaderCB.call(this,e):-1===e.virtualRowID?this._onInternalRequestColumnHeaderCB&&this._onInternalRequestColumnHeaderCB.call(this,e):this._onInternalRequestCellCB&&this._onInternalRequestCellCB.call(this,e)},_enableVisualDebug:function(){R=!0},_disableVisualDebug:function(){R=!1},enablePerformanceAnalysis:function(e){void 0!==e&&(this._name=e),this._debugPerformanceIssues=y},disablePerformanceAnalysis:function(){this._debugPerformanceIssues=!1},isPerformanceAnalysis:function(){return this._debugPerformanceIssues},iterativeUpdate:function(e,t){var i=this;i._requestModelIfNeeded(!0),this._deltaViewport=this._computeDeltaViewport(),t.y>0&&i.shiftDownRecursive(e.y),t.y<0&&i.shiftUpRecursive(e.y),t.x>0&&i.shiftRightRecursive(e.x),t.x<0&&i.shiftLeftRecursive(e.x)},updateModel:function(e){this._internalUpdateModel(e)},_internalUpdateModel:function(e){e&&(this.options.model=e),this.initialize(!0),this.prepareUpdateView(),this.pushUpdateView(!0)},_requestModelIfNeeded:function(e){var t=this,i=t._modelViewPort&&!(t._modelViewPort.minRowID<=t.getVirtualViewport().minRowID&&t._modelViewPort.maxRowID>=t.getVirtualViewport().maxRowID),n=t._modelViewPort&&!(t._modelViewPort.minColumnID<=t.getVirtualViewport().minColumnID&&t._modelViewPort.maxColumnID>=t.getVirtualViewport().maxColumnID),o=t._modelViewPort&&(i||n);(void 0===t._modelViewPort||o)&&t._processModelRequest(e)},_applyInheritedHeight:function(){var e=this._getScrollerDimensions(),t=e&&this.getCellsContainerSize().width>e.width?20:0,i=this.getCellsContainerSize().height+this.getHeadersDimensions().height+t;this.options.maxHeight&&(i=Math.min(i,this.options.maxHeight)),this.updateHeight(i+"px"),this._resetViewportDimensions()},updateView:function(e){(e||this._updateViewOptions.generatePool)&&this._generatePool(),this._modelEvents.publish({event:"UPDATE_VIEW",context:this}),this._hasBeenUpdated()},onRightReached:function(e){return this._modelEvents.subscribe({event:"RIGHT_REACHED"},e)},onLeftReached:function(e){return this._modelEvents.subscribe({event:"LEFT_REACHED"},e)},onTopReached:function(e){return this._modelEvents.subscribe({event:"TOP_REACHED"},e)},onBottomReached:function(e){return this._modelEvents.subscribe({event:"BOTTOM_REACHED"},e)},shiftUpRecursive:function(e){if(this._deltaViewport.minRowID<0)for(var t=this._viewportBbox.minRowID-this._deltaViewport.minRowID;t>=this._viewportBbox.minRowID;t--)this._renderRow(t);if(this._deltaViewport.maxRowID<0)for(t=this._viewportBbox.maxRowID-this._deltaViewport.maxRowID;t>=this._viewportBbox.maxRowID;t--)this._freeUpRow(t)},shiftLeftRecursive:function(e){if(this._deltaViewport.minColumnID<0)for(var t=this._viewportBbox.minColumnID-this._deltaViewport.minColumnID;t>=this._viewportBbox.minColumnID;t--)this._renderColumn(t);if(this._deltaViewport.maxColumnID<0)for(t=this._viewportBbox.maxColumnID-this._deltaViewport.maxColumnID;t>=this._viewportBbox.maxColumnID;t--)this._freeUpColumn(t)},shiftDownRecursive:function(e){if(this._deltaViewport.minRowID>0)for(var t=this._viewportBbox.minRowID-this._deltaViewport.minRowID;t<=this._viewportBbox.minRowID;t++)this._freeUpRow(t);if(this._deltaViewport.maxRowID>0)for(t=this._viewportBbox.maxRowID-this._deltaViewport.maxRowID;t<=this._viewportBbox.maxRowID;t++)this._renderRow(t)},shiftRightRecursive:function(e){if(this._deltaViewport.minColumnID>0)for(var t=this._viewportBbox.minColumnID-this._deltaViewport.minColumnID;t<=this._viewportBbox.minColumnID;t++)this._freeUpColumn(t);if(this._deltaViewport.maxColumnID>0)for(t=this._viewportBbox.maxColumnID-this._deltaViewport.maxColumnID;t<=this._viewportBbox.maxColumnID;t++)this._renderColumn(t)},shiftDown:function(e,t){var i=this._viewportBbox.maxRowID+1;this._renderRow(i,!0)},shiftRight:function(e){this._renderColumn(e)},shiftUp:function(e){this._renderRow(e,!0)},shiftLeft:function(e){this._renderColumn(e)},_getModelMinRowID:function(){var e=-1;for(var t in this.options.model){e=t;break}return e},getNumberOfRows:function(){return this.options.model.length},getPoolNumberOfRows:function(){return this._poolSize.numberOfRows},getPoolNumberOfColumns:function(){return this._poolSize.numberOfColumns},_removeCellsFromPool:function(e,t){this._numberOfRowsToRemove=e,this._numberOfColumnsToRemove=t},_getEstimatedPoolSize:function(){var e=this.elements.scroller.getDimensions();return{numberOfRows:1*parseInt(e.height/this._getCellHeight(),10)+2,numberOfColumns:1*parseInt(e.width/this._getCellWidth(),10)+2}},_destroyPool:function(){this._freeUpPool(2)},_doINeedToGeneratePool:function(){var e=void 0!==this._poolDimensions.numberOfRows?this._poolDimensions.numberOfRows:this._computeModelSize().numberOfRows;return Math.floor(parseInt(this.getViewportDimensions().height/this._getCellHeight(),10)*this.options.performances.numberOfRowsFactor)>=e},getViewportDimensions:function(e){return void 0!==this._viewportDimensions&&!0!==e||(this._viewportDimensions={width:this.elements.gridHeaderContainerRel.offsetWidth,height:this.elements.gridHeaderContainerRel.offsetHeight}),this._viewportDimensions},_resetViewportDimensions:function(){this._viewportDimensions=void 0},_generatePool:function(e,t){var i=this.__computePoolSize(e,t);this._freeUpPool(1),this._poolSizeMax=i.poolSizeMax,this._poolSize=i.poolSize;var n="[GridEngine] - generate pool --";_.beginMeasure(n);this._needToApplyCellContainerSize=!0,this._updateViewOptions.generatePool=!1,this._modelEvents.publish({context:this,event:"POOL_UPDATE"}),_.endMeasure(n)},_computePoolSize:function(e,t){var i=this._computeModelSize();void 0===e&&(e=void 0!==this._poolDimensions.numberOfRows?this._poolDimensions.numberOfRows:i.numberOfRows),void 0===t&&(t=void 0!==this._poolDimensions.numberOfColumns?this._poolDimensions.numberOfColumns:i.numberOfColumns);var n,o,s,l,r=this.getViewportDimensions();s=Math.ceil(1*parseInt(r.height/this._getCellHeight(),10)*this.options.performances.numberOfRowsFactor),l=Math.ceil(1*parseInt(r.width/this._getCellWidth(),10)*this.options.performances.numberOfColumnsFactor),n=Math.ceil(Math.max(1,Math.min(1*parseInt(r.height/this._getCellHeight(),10)*this.options.performances.numberOfRowsFactor,e))+this._numberOfRowsToRemove),o=this.options.performances.enableColumnVirtualization?Math.floor(Math.max(1,Math.max(Math.min(1*parseInt(r.width/this._getCellWidth(),10)*this.options.performances.numberOfColumnsFactor,t),1))+this._numberOfColumnsToRemove):t,this._poolSizeMax={numberOfRows:s,numberOfColumns:l},this._poolSize={numberOfRows:n,numberOfColumns:o}},__computePoolSize:function(e,t){var i=this._computeModelSize();void 0===e&&(e=void 0!==this._poolDimensions.numberOfRows?this._poolDimensions.numberOfRows:i.numberOfRows),void 0===t&&(t=void 0!==this._poolDimensions.numberOfColumns?this._poolDimensions.numberOfColumns:i.numberOfColumns);var n,o,s=this.getViewportDimensions(!0);return n=Math.ceil(1*parseInt(s.height/this._getCellHeight(),10)*this.options.performances.numberOfRowsFactor),o=Math.ceil(1*parseInt(s.width/this._getCellWidth(),10)*this.options.performances.numberOfColumnsFactor),{poolSize:{numberOfRows:Math.ceil(Math.max(1,Math.min(1*parseInt(s.height/this._getCellHeight(),10)*this.options.performances.numberOfRowsFactor,e))+this._numberOfRowsToRemove),numberOfColumns:this.options.performances.enableColumnVirtualization?Math.floor(Math.max(1,Math.max(Math.min(1*parseInt(s.width/this._getCellWidth(),10)*this.options.performances.numberOfColumnsFactor,t),1))+this._numberOfColumnsToRemove):t},poolSizeMax:{numberOfRows:n,numberOfColumns:o}}},onPreUpdateView:function(e){return this._modelEvents.subscribe({event:"preFullUpdateView"},e)},onPreUpdateViewOnce:function(e){return this._modelEvents.subscribeOnce({event:"preFullUpdateView"},e)},onPostUpdateView:function(e){return void 0!==window.__karma__?this.onPostUpdateViewODT(e):this._modelEvents.subscribe({event:"UPDATE_VIEW_COMPLETED"},e)},onPostUpdateViewODT:function(e){return this._modelEvents.subscribe({event:"UPDATE_VIEW_COMPLETED"},p.debounce(e,200))},onPostUpdateViewOnce:function(e){return void 0!==window.__karma__?this.onPostUpdateViewOnceODT(e):this._modelEvents.subscribeOnce({event:"UPDATE_VIEW_COMPLETED"},e)},onPostUpdateViewOnceODT:function(e,t){return t?this._modelEvents.subscribeOnce({event:"UPDATE_VIEW_COMPLETED"},e):this._modelEvents.subscribeOnce({event:"UPDATE_VIEW_COMPLETED"},p.debounce(e,200))},onPoolUpdate:function(e){return this._modelEvents.subscribe({event:"POOL_UPDATE"},e)},onPoolCellCreation:function(e){this._modelEvents.subscribe({event:"EVT_CELL_CREATION"},e)},onPoolCellDestruction:function(e){this._modelEvents.subscribe({event:"EVT_CELL_DESTRUCTION"},e)},processPoolCells:function(e){var t;for(t in this._listOfRenderedCells){var i=this._listOfRenderedCells[t];e.call(this,{cellView:i})}},addCellsFilter:function(t){t=e.extend({match:function(e){},onMatch:function(e){},onMismatch:function(e){}},t);var i=this;this._listOfCellFilters.pushAction({actionFunc:function(e){t.match.call(i,e)?(e.cellView._isFiltered=!0,t.onMatch.call(i,e)):e.cellView._isFiltered&&t.onMismatch.call(i,e)}})},search:function(t){t=e.extend({match:function(e){},onComplete:function(e){}},t);var i=this,n=[];d.forEach(this.options.model,function(e,o){i._isMonoDimension||e.forEach(function(e,s){var l={cellModel:i.getCellModel(o,s),virtualRowID:o,virtualColumnID:s,virtualCellID:o*i._numberOfColumns+s};t.match.call(i,l)&&n.push(l)})},100,function(){t.onComplete&&t.onComplete.call(i,{listOfMatchedCellModels:n})})},removeAllCellsFilters:function(){this._listOfCellFilters.clear(),this.updateView(!0)},_getGridContainerDimensions:function(e){return this.__gridContainerDimensions&&!e||(this.__gridContainerDimensions=this.getContent().getBoundingClientRect()),this.__gridContainerDimensions},_gridContainerDimensionsModified:function(){this.__gridContainerDimensions=void 0,this._scrollerDimensions=void 0},_getCellWidth:function(){return this.options.defaultCellWidth+this.options.cellSpacing.horizontal},_getCellHeight:function(){return this.options.defaultCellHeight+this.options.cellSpacing.vertical},_computeDynamicCellSpacing:function(){if(this.getScroller()){var e=this._getScrollerDimensions();e.width=e.width-20;var t=e.width%this.options.defaultCellWidth/(Math.floor(e.width/this.options.defaultCellWidth)+1);this.options.cellSpacing={horizontal:t,vertical:t}}},_enableAutoScroll:function(e,t){if(this._autoScrollDistance=e||{x:0,y:0},this._autoScrollPeriod=t||20,this._disableAutoScroll(),void 0===this._autoScrollInterval){var i=this;this._autoScrollInterval=window.setInterval(function(){var e=i.getScroller().elements.container,t=e.scrollTop,n=e.scrollLeft;t>=0&&(e.scrollTop=t+i._autoScrollDistance.y),n>=0&&(e.scrollLeft=n+i._autoScrollDistance.x)},this._autoScrollPeriod)}},_setAutoScrollVelocity:function(e){this._autoScrollDistance=e||{x:0,y:0}},_disableAutoScroll:function(){void 0!==this._autoScrollInterval&&(window.clearInterval(this._autoScrollInterval),delete this._autoScrollInterval)}})}),define("DS/Layouts/ChannelView",["DS/Layouts/GridEngine","DS/Controls/ThumbnailCellView"],function(e,t){"use strict";return e.extend({defaultOptions:{cellClass:t,numberOfColumns:1,defaultCellWidth:260,defaultCellHeight:170},init:function(e){e.numberOfColumns=e.model.length,this._parent(e),this.elements.container.setStyles({height:this.options.defaultCellHeight+20})}})}),define("DS/Layouts/ListViewCellAbstract",["UWA/Core","UWA/Class","DS/Layouts/GridEngineCellAbstract"],function(e,t,i){"use strict";return i.extend({defaultOptions:{width:"100%"},init:function(e){this._parent(e),this.elements.container.addClassName("wux-layouts-listview-cell")}})}),define("DS/Layouts/ListView",["UWA/Core","UWA/Class","DS/Layouts/GridEngine","DS/Layouts/ListViewCellAbstract"],function(e,t,i,n,o){"use strict";return i.extend({defaultOptions:{cellClass:n,defaultCellHeight:28,numberOfColumns:1},init:function(e){this._parent(e);var t=this;this.onPoolUpdate(function(){t.setCellsContainerSize({width:"100%"})}),this.elements.container.addClassName("wux-layouts-listview")}})});