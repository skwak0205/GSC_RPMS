define("DS/XTaskApp/Views/XPlanColumnView",["UWA/Class","UWA/Element","UWA/Event","UWA/Class/Events","UWA/Class/Collection","DS/UIKIT/Scroller","DS/Handlebars/Handlebars4","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Collections/CollectionTaggerHelper","DS/CollaborativeTasks/Views/CardView","DS/CollaborativeTasks/Views/ColumnView","DS/CollaborativeTasks/Views/CardViewHandler","DS/E6WCommonUI/DragUtil","DS/E6WCommonUI/UIHelper","DS/UIKIT/Tooltip","DS/E6WCommonUI/CompassUtil","DS/E6WCommonUI/Views/FoundationBaseView","DS/E6WCommonUI/Views/E6WHandlebarsHelpers","DS/E6WCommonApps/SmartSchedulerUtils","DS/E6WCommonApps/Models/RDFTaskModel","DS/E6WCommonApps/Collections/PaginatedTasksCollection","DS/E6WCommonApps/Collections/FTSTaskPseudoCollection","i18n!DS/E6WCommonApps/assets/nls/CollaborativeTasksNLS","text!DS/CollaborativeTasks/assets/templates/column.html.handlebars"],function(e,t,n,o,i,a,s,r,l,c,d,h,p,u,g,m,C,v,f,D,T,S,y,b){"use strict";var F=y.get.bind(y),k=s.compile(b),E=i.extend().implement(l),_=e.extend(o,{init:function(e){this.element=e.element,this.column=e.column,this.model=e.model,this._parent.apply(arguments)},onClickTaskCard:function(){this.column.dispatchEvent("onTaskCardClicked",this)},onSelect:function(){this.element.classList.add("active"),m.publishOnPlatformAPI(window.widget.getValue("appId")+".select",this.model)},onUnselect:function(){this.element.classList.remove("active"),m.publishOnPlatformAPI(window.widget.getValue("appId")+".unselect",this.model)},destroy:function(){this.element=void 0,this.column=void 0,this.model=void 0}}),w=C.extend({_uwaClassName:"XPlanColumnView",tagName:"div",className:"column ds-dialog",name:"CollaborativeTasks.ColumnView",cardViewMenuButtons:new Map,domEvents:{"dragstart .card-content":"onDragStart","dragenter .card":"onCardDragEnter","dragleave .card":"onCardDragLeave","dragover .card":"onCardDragOver","drop .card":"onCardDrop","dragenter .ui-droppable":"onColumnDragEnter","dragleave .ui-droppable":"onColumnDragLeave","dragover .ui-droppable":"onColumnDragOver","dragend .ui-droppable":"onDragEnd","drop .ui-droppable":"onColumnDrop"},setup:function(e){this._parent.apply(this,arguments),this.offset=0,this._handleScroll=function(){this.requestIsContinousScroll?this._renderChunk(this.offset):(this._renderChunk(this.offset,!1),this.scrollFetchIntervalId?this.scrollFetchUpdate=!1:(this.scrollFetchIntervalId=setInterval(function(){this.scrollFetchUpdate?(this.collection.getMissingDataInRange(this.offset,30,!1)&&this.collection.fetch({offset:this.offset,limit:T.INITIAL}),clearInterval(this.scrollFetchIntervalId),delete this.scrollFetchIntervalId):this.scrollFetchUpdate=!0}.bind(this),50),this.scrollFetchUpdate=!0)),this.requestIsContinousScroll=!1}.bind(this),this.lastScroll=0,this.range={top:this.offset,bottom:30},this.awaitingData=!0,this.cardMenuHandler=new h({column:this}),this.activeCard=null,this._addCollectionListeners(),this._cardDragEventTargets=new Map,this._colDragEventTargets=new Map,this._fakeTagCollection=new E,this._nlsValue=e.attrDisplayValue,this._attrValue=e.attrValue,this._cardViewHandler=new h({column:this}),this.scrollPane={}},id:function(){return this.collection.extid},onContextualMenuClick:function(e){var t=e.target.getParent(".card");if(t){var n=t.getElement(".card-content").getAttribute("data-id"),o=this.menuSelected(t,r.getObjectById(n));u.showAndUpdateContextualDropdownMenuPosition(o,e)}},onClick:function(e){for(var t=e.target,n=null;null!==t&&null===n;)t.classList.value.includes("card ")?n=t:t=t.parentElement;if(null!==n){var o=parseInt(n.id.replace("cardc","")),i=this.collection._models[o];e.target&&e.target.classList.contains("fonticon-open-down")?this.menuSelected(n,i):null===n&&this.activeCard.div===n||this.cardClicked(n,i)}},resizeBuffer:function(){},menuSelected:function(e,t){this.cardMenuHandler.setModel(t,e);var n=this.cardViewMenuButtons.get(t);if(!n){n=this.cardMenuHandler.generateMenu(e),this.cardViewMenuButtons.set(t,n),n.dropdown.show();var o=this,i=function(){var i=o.cardMenuHandler.generateMenu(e);o.cardViewMenuButtons.set(t,i),n.dropdown.isVisible&&t.hasFetchedAccessData()&&(n.dropdown.hide(),i.dropdown.show())};t.canModify(),this.listenTo(t,{onModifyAccessChanged:i,onDeleteAccessChanged:i})}return this._visibleMenu=n,n.dropdown},cardClicked:function(e,t){this.activeCard&&this.activeCard.model===t?(this.activeCard.onClickTaskCard(),this.activeCard=void 0):(this.activeCard=new _({element:e,column:this,model:t}),this.activeCard.onClickTaskCard())},onFocusOut:function(){this.activeCard&&(this.activeCard.classList.remove("active"),this.activeCard=null)},render:function(){this.renderChunkTimeout=null,this.container.innerHTML=this.template(),this.columnContent=this.getElement(".body"),this._scroller&&this._scroller.destroy(),this._scroller=new a({element:this.getElement(".cards.task-list")}).inject(this.columnContent),this.scrollPane=this._scroller.elements.content,this.scrollPane.innerHTML='<div id="cardsFullViewport"><div id="cardsFragment"/></div>',this.cardsFullViewport=this.scrollPane.childNodes[0],this.cardsFragment=this.cardsFullViewport.childNodes[0],this._addEventListeners();var e=this.container.getElement(".fonticon-filter");return e&&this.setCompletedTaskFilterToolTip(e),this.collection.length&&this._renderChunk(0,!1),this},setCompletedTaskFilterToolTip:function(e){var t=widget.getValue("completedTasksDisplayPref"),n=F("emxCollaborativeTasks.Label.CompletedTaskTopCountFilterToolTip");n=n.replace("%DAY_COUNT%",t),this._taskFilterTooltip=new g({target:e,body:n+"<br><br>"+F("emxCollaborativeTasks.Label.ChangeCompletedTaskFiltering")})},_addEventListeners:function(){this.scrollPane.addEventListener("wheel",this.onWheel.bind(this)),this.scrollPane.addEventListener("scroll",this.onScroll.bind(this)),this.scrollPane.addEventListener("click",this.onClick.bind(this)),this.scrollPane.addEventListener("contextmenu",this.onContextualMenuClick.bind(this)),this.scrollPane.addEventListener("focus",this.onFocusOut.bind(this)),this.scrollPane.addEventListener("blur",this.onFocusOut.bind(this))},_addCollectionListeners:function(){this.listenTo(this.collection,T.Events.SizeEvent,this.onCollectionSizeChange),this.listenTo(this.collection,T.Events.ModelsAdded,this.modelsAdded),this.listenTo(this.collection,"onChange",this._onTaskChanged),this.listenTo(this.collection,"onRemove",this._onRemove)},onCollectionSizeChange:function(e){this.dispatchEvent(w.Events.InitialLoadComplete),this.collectionSize=e;var t=this.getElement(w.TitleObjectCountId);t&&(t.setText(w.TitleObjectCountString.replace("%COUNT%",e)),this.cardsFullViewport.style.height=85*e+"px")},modelsAdded:function(){this.collectionSize||this.onCollectionSizeChange(this.collection.size());var e=this.range.bottom-this.range.top,t=this.collection.getMissingDataInRange(this.range.top,e);this.awaitingData&&!t&&(this.awaitingData=!1,this._renderChunk(this.offset,!1))},_renderChunk:function(e,t){void 0===t&&(t=!0);var n,o=[],i=85*e,a=30+e;a=a>this.collection._models.length?this.collection._models.length:a;var s=!0;for(n=e;n<a;n++)if(!this.collection.at(n).isBlank){s=!1;break}if(!s||s&&!this.previousChunkWasBlank){this.previousChunkWasBlank=s;var l='<div id="cardsFragment" '+('style="transform: translateY('+i+'px)";')+">",c=!1;for(n=e;n<a;n++){var d=this.collection.at(n);d.isBlank?c=!0:d.hasDataForMask("dsplan:MVMask.Task.ScheduleView")||o.push(d.id),l+=this._cardViewHandler.getCardHtml(d,n)}this.awaitingData=c,l+="</div>",this.cardsFragment.outerHTML=l,this.cardsFragment=this.cardsFullViewport.childNodes[0]}else{for(n=0;n<this.cardsFragment.childNodes.length;n++)this.cardsFragment.childNodes[n].setAttribute("cardId",n+e);this.cardsFragment.style.transform="translateY("+i+"px)"}if(this.range.top=e,this.range.bottom=a,t){var h,p,u=this.scrollDown?this.range.top:this.range.bottom,g=this.collection.getMissingDataInRange(u,T.LIMIT,!this.scrollDown);if(g)g.start?(h=g.start,p=g.start+T.LIMIT):(h=g.end-T.LIMIT>=0?g.end-T.LIMIT:0,p=g.end),this.collection.fetch({offset:h,limit:p-h})}else r.complete(D,o,{mask:"dsplan:MVMask.Task.ScheduleView",onlyIfNeeded:!0});if(this.activeCard&&!this.activeCard.element.isInjected()){const e=this.getCardElementByModel(this.activeCard.model);e&&(this.activeCard.element.classList.contains("active")&&e.classList.add("active"),this.activeCard.element=UWA.extendElement(e))}this.clearCardViewButtons(),this.dispatchEvent("onRenderChunk")},clearCardViewButtons:function(){this.cardViewMenuButtons.clear();var e=this;this.cardViewMenuButtons.forEach(function(t,n){this.stopListening(n,"onDestroy",e.remove)})},template:function(){var e=v.i18n;v.i18n=F;var t=this.collection.dataForRendering(),n=t.filteredByValue&&t.filteredByValue.actualValue;"all"===widget.getValue(f.COMPLETED_TASK_PREF_NAME)||"Done"!==n&&"Complete"!==n||(t.completedTaskFilterOn=!0);var o=k(t);return v.i18n=e,o},onWheel:function(){this.wheelIntervalId?this.resetWheelInterval=!0:(this.isContinuousScroll=!0,this.resetWheelInterval=!0,this.wheelIntervalId=window.setInterval(function(){this.resetWheelInterval?this.resetWheelInterval=!1:(window.clearInterval(this.wheelIntervalId),delete this.wheelIntervalId,this.isContinuousScroll=!1)}.bind(this),100))},onScroll:function(){var e=this.getMaxVisibleCards(),t=parseInt(this.scrollPane.scrollTop/85),n=t,o=t+e,i=this.scrollPane.scrollTop>this.lastScroll;this.lastScroll=this.scrollPane.scrollTop;var a=-1,s=this.collection._models;i&&this.range.bottom>=this.collectionSize||(i&&this.range.bottom-5<o?a=(a=n-5)>s.length-15?s.length-30:a:!i&&this.range.top+5>n&&(a=(a=n-(30-(e+5)))<0?0:a),-1!==a&&a!==this.range.top&&(this.offset=a,this.scrollDown=i,this.requestIsContinousScroll=this.isContinuousScroll,window.requestAnimationFrame(this._handleScroll)))},getMaxVisibleCards:function(){return this.maxNoOfCards&&this.lastScrollHeight===this.scrollPane.offsetHeight||(this.maxNoOfCards=parseInt(this.scrollPane.offsetHeight/85)+2),this.maxNoOfCards},_onTaskChanged:function(e){var t=this.getElement('[data-id="'+e.id+'"]');t&&(t.innerHTML=this._cardViewHandler.getCardContentHtml(e))},getVisibleModels:function(){var e=this.getMaxVisibleCards(),t=parseInt(this.scrollPane.scrollTop/85);return this.collection.getSelection(t,e)},repaint:function(){var e=this;this._repaintAF=window.requestAnimationFrame(function(){e._renderChunk(e.range.top,!1)})},refresh:function(){this.collectionSize=void 0,this.awaitingData=!0,this.collection.reset({offset:this.range.top})},getDisplayName:function(){return this.collection._valueForFiltering},add:function(e,t){var n=this.collection.add(e,t);n>=this.range.top&&n<=this.range.bottom&&(this.repaint(),t&&t.select&&this.listenToOnce(this,"onRenderChunk",function(){requestAnimationFrame(function(){this.selectByModel(e)}.bind(this))}))},getCardElementByModel:function(e){return this.getElement('[data-id="'+e.id+'"]').getParent(".card")},selectByModel:function(e){var t=this.getCardElementByModel(e);this.cardClicked(t,e)},_onRemove:function(e,t,n){var o=n&&n.index;o>=this.range.top&&o<=this.range.bottom&&this.repaint()},onDragStart:function(e){var t=r.getObjectById(e.target.getAttribute("data-id"));p.setDragView({container:e.target}),c.prototype.handleDragStart.call({model:t},e)},onCardDragEnter:function(e){if(0===this._cardDragEventTargets.size){var t=r.getObjectById(n.getElement(e).getElement(".card-content").getAttribute("data-id"));c.prototype.handleDragEnter.call({model:t,canDragOverCard:c.prototype.canDragOverCard,container:n.getElement(e)},e)}this._cardDragEventTargets.set(e.target,!0)},onCardDragOver:function(e){var t=r.getObjectById(n.getElement(e).getElement(".card-content").getAttribute("data-id"));return c.prototype.handleDragOver.call({model:t,canDragOverCard:c.prototype.canDragOverCard,container:n.getElement(e)},e)},onCardDragLeave:function(e){var t=n.getElement(e).getElement(".card-content");t||(t=n.getElement(e).getParent(".card").getElement(".card-content")),setTimeout(function(){this._cardDragEventTargets.delete(e.target),0===this._cardDragEventTargets.size&&c.prototype.handleDragLeave({target:t})}.bind(this),1)},onCardDrop:function(){var e=r.getObjectById(n.getElement(event).getElement(".card-content").getAttribute("data-id"));c.prototype.handleDrop.call({model:e,canDragOverCard:c.prototype.canDragOverCard,container:t.extend(event.target.closest(".card")),processDropData:c.prototype.processDropData,_getFieldConfigForValidatingDrop:c.prototype._getFieldConfigForValidatingDrop,validateDroppedObject:c.prototype.validateDroppedObject,_getIdForDroppedItem:c.prototype._getIdForDroppedItem,addAttributeToRDFTask:c.prototype.addAttributeToRDFTask,isValidObjectType:c.prototype.isValidObjectType},event)},onDragEnd:function(){d.prototype.handleDragEnd.call(this)},getColumnFilterAttrValue:function(){return this.collection._view},onColumnDragEnter:function(){0===this._colDragEventTargets.size&&d.prototype.handleDragEnter.call({canDragOverColumn:d.prototype.canDragOverColumn,_parentView:this._parentView,getColumnViewName:d.prototype.getColumnViewName,getColumnFilterAttrValue:this.getColumnFilterAttrValue.bind(this),container:this.container,collection:this.collection}),this._colDragEventTargets.set(event.target,!0)},onColumnDragLeave:function(e){setTimeout(function(){this._colDragEventTargets.delete(e.target),0===this._colDragEventTargets.size&&d.prototype.handleDragLeave.call({adjustScrolling:d.prototype.adjustScrolling,_parentView:this._parentView},e)}.bind(this),1)},onColumnDragOver:function(e){d.prototype.handleDragOver.call({canDragOverColumn:d.prototype.canDragOverColumn,_parentView:this._parentView,getColumnViewName:d.prototype.getColumnViewName,getColumnFilterAttrValue:this.getColumnFilterAttrValue.bind(this),container:this.container,collection:this.collection},e)},onColumnDrop:function(e){var t=this.collection._valueForFiltering;this.collection._valueForFiltering=this._nlsValue,d.prototype.handleDrop.call({canDragOverColumn:d.prototype.canDragOverColumn,_parentView:this._parentView,getColumnViewName:d.prototype.getColumnViewName,getColumnFilterAttrValue:this.getColumnFilterAttrValue.bind(this),container:this.container,collection:this.collection,processModelDrop:d.prototype.processModelDrop,getElement:function(){return e.target.closest(".drop-zone-mask")}},e),this.collection._valueForFiltering=t},destroy:function(){this._repaintAF&&cancelAnimationFrame(this._repaintAF),this._repaintAF=void 0,this.scrollPane.innerHTML="",this.collection.destroy&&this.collection.destroy(),this._parent()},afterRDFIndexFetch:function(e){if(!this.isDestroyed){var t=!1,n=e.items.member.length,o=[];if(S.isWorkingCorrectly()){for(var i=0;i<n;i++){var a=e.items.member[i],s=r.getExistingAndMerge(a);s||(s=new D(a,{parse:!0,mask:"dsplan:MVMask.Task.CollaborativeTask.Basic"}),this.collection.add(s,{replace:!0}),this.repaint()),this.collection.contains(s)||(t=!0,o.push(s))}t&&(this._fakeTagCollection.reset(o),this._fakeTagCollection.federatedTaggerServiceRequest({onComplete:function(){o.forEach(function(e){var t={};e.tagsData.forEach(function(e){t[e.sixw.split(":").pop()]=e.object}),e.set("_tagData",t)})}}))}else this.collection.set(e.items.member,{at:0,totalItems:e.items.member.length})}}});return w.CssSelectorMarkingInsertionPoint=".top-buffer",w.CssSelectorMarkingBottomInsertionPoint=".bottom-buffer",w.TitleObjectCountId=".object-count",w.TitleObjectCountString="(%COUNT%)",w.Events={InitialLoadComplete:"initialLoadComplete"},w}),define("DS/XTaskApp/Models/XTaskAppTypeDictionary",["UWA/Core","DS/CollaborativeTasks/Models/RDFTasksWorkscopeModel","DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/Models/WorkscopeModel","DS/E6WCommonApps/E6WCommonAppsTypeDictionary"],function(e,t,n,o){"use strict";return n.typeDictionary.mapping.forEach(function(e){e.type===o&&(e.type=t)}),n.typeDictionary.masksStrength["dsplan:MVMask.WorkPackage.CollaborativeTasks"]=29,n.typeDictionary}),define("DS/XTaskApp/Models/ScopeModelContainer",["UWA/Core","UWA/Class","UWA/Class/Events","UWA/Class/Listener","DS/RDFFoundation/Models/ResultModel","DS/RDFFoundation/Collections/ResultCollection","DS/Foundation2/Models/ReferenceModel","DS/Foundation2/FoundationV2Data","DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/Models/WorkscopeModel","DS/E6WCommonApps/XTaskScope","DS/E6WCommonUI/PlatformManager","DS/E6WCommonUI/Views/ObjectCardView","DS/E6WCommonApps/Views/LinkLauncherUtils","DS/E6WCommonApps/SmartSchedulerUtils","DS/RDFFoundation/FederatedSearchUtil","DS/CollaborativeTasks/Models/RDFTasksWorkscopeModel","DS/E6WCommonApps/Views/E6WObjectCardView","DS/Foundation/WidgetUwaUtils","DS/Foundation/WidgetAPIs","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/Models/E6WCommonAppsConstants"],function(e,t,n,o,i,a,s,r,l,c,d,h,p,u,g,m,C,v,f,D,T,S){"use strict";T.fixDisplayMessageMethod();var y=function(){return r.getWidgetConstant.apply(this,arguments)},b=["dsplan:Project","dsplan:xProject"],F=t.extend(n,o,{_uwaClassName:"scopeModelContainer",init:function(e){this._collection=e.collection,this.collection=this._collection,this._scope=void 0},get:function(e){var t;return"scope"===e?t=this._scope:"canEdit"===e&&(t=!0),t},add:function(t,n,o){var i=e.clone(o||{},!1);if(this.getScope()&&this.getScope().id===n)return[];i.detailedObjects&&(i.detailedObject=i.detailedObjects[0]);var a=T.getObjectDataFromDropSearchOrTypeAhead(i)||{};return i.isRDF||a.serviceId===S.SERVICE_3DPLAN?this._addRDFScope(n,o,a):this._addNonRDFScope(n,i)},_addNonRDFScope:function(t,n){var o=e.clone(n||{},!1),i=this.collection.getRelatedObject("scopes",t,void 0,void 0,{urlParam:"$fields=collabSpace"});if(n.scopeType&&i.set("type",n.scopeType),i.get("title")||n.dontCheckTypes)return this._onModelLoaded(i,n);this.listenToOnce(i,"onChange",function(){this._onModelLoaded(i,n)}),this.collection.dictionaryLoaded||this.listenToOnce(this.collection,"onChange:dictionary",function(){o.ignoreEmptyTitle=!0,this._onModelLoaded(i,o)})},_addRDFScope:function(t,n,o){var i=this,a=e.clone(n||{},!1),s=l.getObjectForAdding(C,t,{mask:"dsplan:MVMask.WorkPackage.CollaborativeTasks.Basic",attrs:{"dsxplan:jsType":o.type},onFailure:function(){i.removeScopeOnDelete(a.initialLoad)}});if(a.dontCheckTypes=!0,!s.fetching)return this._onModelLoaded(s,a);this.listenToOnce(s,"onSync",function(){this._onModelLoaded(s,a)})},validateRDFScopeWithServer:function(e){var t=this;e instanceof C&&l.getObjectForAdding(C,e.get("@id")||e.get("id"),{mask:"dsplan:MVMask.WorkPackage.CollaborativeTasks.Basic",attrs:{"dsxplan:jsType":e.get("type")||e.get("@type")||e.get("dsxplan:jsType")},onFailure:function(){t.removeScopeOnDelete()}})},_getProjectTypesList:function(){var e=this.collection.projectTypes();return e&&e.split(/,|\n/)||[]},_onModelLoaded:function(t,n){var o=[],a=e.clone(n||{},!1),s=!1,r=t instanceof i&&"dsplan:DeletedProject"===t.get("dsxplan:jsType"),l=!(t instanceof i||t.get("title"));if(!(r||!a.ignoreEmptyTitle&&l)){if(!a.dontCheckTypes){var c=this.collection.scopesTypes()+","+this.collection.projectTypes();if(-1===(c&&c.split(/,|\n/)||[]).indexOf(t.get("type")))return e.is(a.onFailure)&&a.onFailure(),o;if(f.getContext()===D.TSK_PRIVATE_SPACE){var d=this._getProjectTypesList(),h=t&&t.get("type");h&&-1===d.indexOf(h)&&(s=!0)}}var p=this.getScope();return a.silent=!0,p&&p===t?o:(this.setScope(t,a),s&&T.displayMessage(y("emxCollaborativeTasks.Info.CredentialsContextNotValid")),this._fireRelationshipChangeEvents("scope",n),this.listenTo(this._scope,"onDestroy",this.removeScopeOnDelete),[t])}this.removeScopeOnDelete(a.initialLoad)},toJSON:function(e){var t=this.getScope(),n={canEdit:!0};return t&&(n.scope=e&&e.dataForRendering?t.dataForRendering(e):t.toJSON(e)),n},dataForRendering:function(t){var n=e.clone(t||{},!1);return n.dataForRendering=!0,this.toJSON(n)},removeScopeOnDelete:function(e){this.removeScopeInternal(e),this.dispatchEvent("onScopeDestroyed",[e])},removeScopeInternal:function(e){this.remove("scope",0,{doNotShowConfirmBox:!0,initialLoad:e})},remove:function(e,t,n){var o=this,i=function(){var t=o.getScope();o.setScope(null,n),t&&o._fireRelationshipChangeEvents(e,n)};this.confirmRemoveScope&&n&&!n.doNotShowConfirmBox?this.confirmRemoveScope(i):i()},_fireRelationshipChangeEvents:function(){return s.prototype._fireRelationshipChangeEvents.apply(this,arguments)},_use3DPlanInSearch:function(){return h.hasAccess("3dplan")&&"onpremise"!==h.getTenant().toLowerCase()},_getDropTypes:function(){var e={"3dspace":(this.collection.scopesTypes()+","+this.collection.projectTypes()).split(",")};return h.hasAccess("3dplan")&&(e["3dplan"]=b),e},_getSearchSource:function(){var e=["3dspace"];return this._use3DPlanInSearch()&&e.push("3dplan"),m.filterSearchSources(e)},_getSearchSourceTypes:function(){var e={"3dspace":(this.collection.scopesTypesForSearch()+","+this.collection.projectTypesForSearch()).split(",")};return this._use3DPlanInSearch()&&(e["3dplan"]=b),e},config:function(){return[{readWrite:"true",name:"scope",attributeToDisplay:"name",imageAttribute:"image",singleObjectOnly:!0,searchSourceTypes:this._getSearchSourceTypes(),dropTypes:this._getDropTypes(),searchTitle:y("emxCollaborativeTasks.Label.referencesAssociatedWithTitle"),placeHolder:this.getPlaceHolderText(),type:"object",customView:v,typeAheadCallback:l.typeAheadCallback,linkCallback:u.launchProperties,getDropDownMenuItems:g.getDocumentTypeDropDownMenuItems,searchSource:this._getSearchSource(),excludeSearchTypes:{"3dspace":["Task","Inbox Task","Project Baseline","Experiment","Project Snapshot"]}}]},getPlaceHolderText:function(){return y("emxCollaborativeTasks.Label.ShowTasksForObject").replace("%NAME%",y("emxCollaborativeTasks.WidgetLabel.MyTasks"))},setScope:function(e,t){var n=t||{},o=!1;if(this._scope!==e){var i=d.getScopeId(),a=d.getScopeType();e?(i===e.id&&a===(e.get("type")||"")||d.setScopeData({id:e.id,type:e.get("type")||"",isRDF:Boolean(e.isRDF)}),o=!n.initialLoad,this._scope=e):(o=Boolean(i),n.initialLoad?d.removeUserScopeData():d.removeScopeData(),delete this._scope),this.dispatchEvent("onChange:scopeId",[o])}},getScope:function(){return this._scope}});return F.RDFWorkscopeModel=c,F});