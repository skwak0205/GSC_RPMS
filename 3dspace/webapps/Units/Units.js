define("DS/Units/Units",["UWA/Controls/Abstract","UWA/Core","DS/WebappsUtils/WebappsUtils"],function(n,t,i){"use strict";var e={usi:[{unit:"g",useSubUnits:!0},{unit:"m",useSubUnits:!0},{unit:"deg",useSubUnits:!1},{unit:"rad",useSubUnits:!1}],listOfUnits:{},usiConversion:{from:["rad","deg"],to:["deg","radian"],factor:[function(n){return 180*n/Math.PI%360},function(n){return n%360*Math.PI/180}]}},o={from:["miles","radian","degree","degree","degree"],to:["kilometer","degree","grade","quadrant","radian"],factor:[1.609344,function(n){return 180*n/Math.PI%360},1,1111,function(n){return n%360*Math.PI/180}]},s=["k","h","da","","d","c","m"],r={k:1e3,h:100,da:10,d:.1,c:.01,m:.001};function u(n,t){var i=n.charAt(n.indexOf("value")+1),e=parseFloat(n.substr(n.indexOf(i)+1));switch(i){case"*":return t*e;case"/":return t/e;default:console.log("Operateur non reconnu")}}e.usi.forEach(function(n,t){n.useSubUnits?s.forEach(function(t,i){var o=t+n.unit;e.listOfUnits[o]=n.unit}):e.listOfUnits[n.unit]=n.unit});var a=n.extend({defaultOptions:{unit:"",_unitIndex:null,value:null},init:function(n){this._parent(n),this.options.unit=this.options.unit.toLowerCase()},to:function(n){var t,i,o,s=this.options.unit,u=n,f=e.listOfUnits[s],c=e.listOfUnits[u],l=parseFloat(this.options.value,10);if(f){if(s!==f){var d=s.replace(new RegExp(f+"$"),"");0,t=r[d]*l}else t=l;if(f!==c){for(var p,v,h=0;h<e.usiConversion.from.length&&!v;h++)e.usiConversion.from[h]===f&&e.usiConversion.to[h]===c&&(p=h,v=!0);if(!v)throw"Conversion factor not found for : "+f+"--\x3e"+c;if(p>=0){switch(typeof e.usiConversion.factor[p]){case"function":o=e.usiConversion.factor[p](parseFloat(this.options.value,10));break;default:o=parseFloat(this.options.value,10)/e.usiConversion.factor[p]}0}}else o=t;if(u!==c){var U=u.replace(new RegExp(c+"$"),"");0,i=o/r[U]}else i=o;return new a({value:i,unit:u})}throw"unit√© non reconnu : "+n},toString:function(){return this.options.value+" "+this.options.unit},_getUnitIndex:function(n){var t=e[void 0].units_names.indexOf(n),i=e[void 0].units_names_short.indexOf(n);return-1!==t?t:i},convert:function(n,t){var i=this.options.knowledge;for(var e in i.UNITS_KNOWLEDGE)console.log(e),n===e.description&&u(e.description,t)},addUnitRule:function(n,t,i){o.from.push(n),o.to.push(t),o.factor.push(i)}});return a});