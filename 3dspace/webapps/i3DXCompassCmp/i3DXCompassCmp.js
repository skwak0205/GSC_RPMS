define("DS/i3DXCompassCmp/Views/TileAddView",["UWA/Core","DS/W3DXComponents/Views/Item/TileView","css!DS/i3DXCompassCmp/i3DXCompassCmp"],function(e,t){"use strict";return t.extend({tagName:"div",name:"platform-management",render:function(){return this.container.addClassName("grid add-container"),this._parent(),this.container.getElement(".platform-management-header").setContent({tag:"i",styles:{height:70,width:60,"vertical-align":"middle",display:"table-cell"},class:this.model.get("fonticon")}),this.container.getElement(".platform-management-body").removeClassName("tile-body").setContent({tag:"div",styles:{height:70,"vertical-align":"middle",display:"table-cell"},text:this.model.get("title")}),this.container.addEvent("click",this.model.get("action")),this}})}),define("DS/i3DXCompassCmp/Modal/PrereqError",["UWA/Core","UWA/Controls/Abstract","DS/UIKIT/Modal","DS/UIKIT/Input/Toggle","DS/i3DXCompassCore/Model/ProcessModel","DS/UIKIT/Input/Button","DS/i3DXCompassCore/Utils","i18n!DS/i3DXCompassCmp/assets/nls/i3DXCompassCmp"],function(e,t,n,i,s,o,a,r){"use strict";return t.extend({defaultOptions:{prereq:[],onCancel:function(){},onRemovedRequired:function(){}},needed:!1,disableOKButton:!1,clickOkPressed:!1,requiredByOption:0,requiredByAnd:0,init:function(e){var t=this;t._parent(e),this.modal=new n({closable:!0,className:a.getPlatformManagementWrapperClassName(""),header:"",body:"",footer:"",events:{onHide:function(){t.options.onCancel(t.asRemovedRequired),this.destroy(),a.manageSupportOfMultiModal()}}}),this.elements.container=this.modal,t.options.model.isTPA()||(t.options.selectedCollection.forEach(function(e){e.get("prereq")&&(e.get("prereq")&&!e.get("prereq").empty&&"and"===e.get("prereq").type?e.get("prereq").process.forEach(function(n){t.options.model.get("uid")===n.uid&&(t.options.prereq.push(e),t.requiredByAnd++)}):e.get("prereq")&&!e.get("prereq").empty&&"or"===e.get("prereq").type&&e.get("prereq").process.forEach(function(n){t.options.model.get("uid")===n.uid&&t.options.prereq.push(e),t.options.selectedCollection.get(n.uid)&&t.requiredByOption++}))}),t.options.prereq.length>0&&(t.requiredByOption<=1||t.requiredByAnd>0)&&(t.needed=!0))},_findRequiredRoles:function(e,t,n){if(n.push(e.get("uid")),e._hasPrereq())for(var i=e.get("prereq").process,o=0;o<i.length;o++){var a=new s(i[o]);if(a.get("uid")===t)return a;var r=this._findRequiredRoles(a,t,n);if(r)return r}return!1},_removeRequired:function(){var e=this,t=this.options.selectedCollection,n=this.options.model.get("uid"),i=[];return t.forEach(function(t){var s=[];e._findRequiredRoles(t,n,s)&&s.forEach(function(e){i.push(e)})}),i.push(n),t.remove(i),i},isNeeded:function(){return this.needed},show:function(){this.modal.setHeader(this.getTitle()),this.modal.setBody(this.getContent()),this.modal.setFooter(this.getButtons()),this.modal.inject(document.body).show()},getTitle:function(){return"<h3>"+(this.options.model.get("option")?r.get("This option is required by"):r.get("This role is required by"))+"</h3>"},getContent:function(){var t=this,n=[];return this.options.prereq.forEach(function(e){n.push(t.getContentItem(e))}),[e.createElement("table",{class:"table",html:n}),{class:"text-error text-right",text:r.get("You need to remove required roles first")}]},getContentItem:function(e){return{tag:"tr",html:[{tag:"td",html:new i({className:"primary",type:"checkbox",name:"prereq-licenses[]",value:e.get("uid"),label:e.get("name"),checked:!1,disabled:!0})}]}},getButtons:function(){var e=this,t=[];return this.options.removeRequired&&t.push(new o({value:r.get("Remove required roles"),className:"default",events:{onClick:function(){e.asRemovedRequired=!0,e.options.onRemovedRequired(e._removeRequired()),e.destroy()}}})),t.push(new o({value:r.get("Cancel"),className:"default",events:{onClick:function(){e.modal.hide()}}})),t}})}),define("DS/i3DXCompassCmp/Modal/FullScreenModal",["UWA/Core","DS/UIKIT/Modal","DS/UIKIT/Mask","DS/i3DXCompassCore/Utils","DS/UIKIT/Scroller","UWA/Class/View"],function(e,t,n,i,s,o){"use strict";var a=function(t){return e.is(t,"string")&&!/<[\s\S]*>/i.test(t)};return t.extend({init:function(t){return t.className=e.String.format(i.getPlatformManagementWrapperClassName("modal-scrollable big-modal {0}"),t.className||""),a(t.header)&&(t.header=e.String.format("<h3>{0}</h3>",t.header)),this._parent(t)},setHeader:function(t){return a(t)&&(t=e.String.format("<h3>{0}</h3>",t)),this._parent(t)},setBody:function(t){return t instanceof o&&(t=t.getContent()),this._parent(new s({element:e.createElement("div",{class:"scrollable-body",styles:{height:"100%"},html:t})}))},_isMasked:function(){return this.masked},mask:function(){this._isMasked()||(n.mask(this.getBody()),this.masked=!0)},unmask:function(){this._isMasked()&&n.unmask(this.getBody()),this.masked=null}})}),define("DS/i3DXCompassCmp/Controls/Tags",["UWA/Core","UWA/Controls/Abstract","UWA/Event","DS/UIKIT/Input/Text","DS/UIKIT/Touch","DS/UIKIT/Spinner","DS/i3DXCompassCore/Utils"],function(e,t,n,i,s,o,a){"use strict";return t.extend({defaultOptions:{text:null,onChange:function(){},onDestroy:function(){}},init:function(e){this._parent(e),this.buildContainer()},destroy:function(){this.options.onDestroy(),this._parent()},processChange:function(t,n){if(e.is(n.getParent("div"))){var i=-1===this.getSelected().indexOf(t);this.options.validator(t)&&i?(this.options.text=t,n.getParent("div").removeClassName("has-error"),this.getContent().setContent(this.setReadInput()),this.asyncCheck()):(n.focus(),e.log(n),n.getParent("div").hasClassName("has-error")||(n.getParent("div").addClassName("has-error"),this.options.onError&&!i&&this.options.onError()))}},setEditInput:function(){var t=this;this.input=new i({value:this.options.text,attributes:{type:"email",styles:{width:t.getContent().getSize().width},events:{keyup:function(e){e.preventDefault(),e.stopPropagation(),13===e.keyCode&&t.processChange(this.value,this)},blur:function(n){var i=this;n.preventDefault(),n.stopPropagation(),e.is(i)&&setTimeout(function(){t.processChange(i.value,i)},100)}}}}),this.getContent().setContent(this.input),this.input.focus()},getButton:function(){var t=this;return this.button||(this.button=e.createElement("button",{class:"btn btn-default",html:{tag:"span",class:"fonticon fonticon-cancel"},events:{click:function(e){this.getElement(".fonticon").hasClassName("fonticon-cancel")&&(t.destroy(),n.stop(e))}}})),{tag:"span",class:"input-group-btn",html:this.button}},getInputText:function(){var t=this;return this.inputText=e.createElement("span",{class:"form-control",text:this.options.text,events:a.isTouchActivate()?null:{dblclick:function(){t.setEditInput()}}}),a.isTouchActivate()&&(this.touch=new s(this.inputText).on("hold",function(e){e.preventDefault(),e.stopPropagation(),t.setEditInput()})),this.inputText},setReadInput:function(){return e.createElement("div",{class:"input-group",html:[this.getInputText(),this.getButton()]})},buildContainer:function(){this.elements.container=e.createElement("div",{class:"uwa-input-tags uwa-input",html:this.setReadInput()})},setLoading:function(e){var t=this.button.getElement(".fonticon");e?(t.removeClassName("fonticon-cancel"),this.button.addClassName("is-loading"),new o({visible:!0}).inject(t)):(this.button.removeClassName("is-loading"),t.addClassName("fonticon-cancel"),t.setContent(""))},setError:function(e){var t=this.inputText.getParent("div");e?t.hasClassName("has-error")||t.addClassName("has-error"):t.removeClassName("has-error"),this.options.onChange()},asyncCheck:function(){var e=this;this.options.validatorAsync&&(this.setLoading(!0),this.options.syncInputSize(),this.options.validatorAsync(this.inputText.getText(),{onComplete:function(){e.getContent().setContent(e.setReadInput()),e.setLoading(),e.setError(!1),e.options.syncInputSize()},onFailure:function(){e.setLoading(),e.setError(!0),e.options.syncInputSize()}}))},getSelected:function(){var e=[];return this.elements.container.getParent().getElements(".uwa-input-tags span.form-control").forEach(function(t){e.push(t.getHTML())}),e}})}),define("DS/i3DXCompassCmp/Controls/Input/Text",["UWA/Core","UWA/Controls/Abstract","DS/UIKIT/Input/Text"],function(e,t,n){"use strict";return t.extend({defaultOptions:{},init:function(e){this.open=e.open||!1,this.minChar=e.minChar||0,this.isCollapsable=!1,e.attributes.value||(e.attributes.value=""),""===e.attributes.value&&(this.isCollapsable=e.isCollapsable||!1),this._parent(e),this.elements.container=this.buildContainer()},openInput:function(){this.isCollapsable&&this.elements.input.elements.input.removeClassName("hidden"),this.open=!0,this.elements.input.elements.input.focus(),this.options.attributes&&this.options.attributes.placeholder&&this.elements.input.elements.input.setAttribute("placeholder",this.options.attributes.placeholder)},updateInputClosedAttribute:function(){this.elements.input.elements.input.addClassName("hidden"),this.elements.input.elements.input.setAttribute("placeholder","")},buildContainer:function(){var t=this,i=0;return t.keyUp=e.clone(t.options.attributes.events.keyup),t.options.attributes.events.keyup=function(){var e=t.elements.input.getValue().length;e>=t.minChar&&(t.getContent().getElement(".fonticon-cancel-squared").toggleClassName("hidden",0===e),clearTimeout(i),i=setTimeout(function(){t.keyUp.call(t.elements.input.getContent())},400))},this.elements.input=new n(this.options),this.isCollapsable&&(this.elements.input.elements.input.addEvent("click",function(){t.open||t.openInput()}),this.updateInputClosedAttribute()),e.createElement("div",{class:"input-search-center",html:{class:"input-search-wrapper",html:[{tag:"i",class:"fonticon fonticon-cancel-squared pointer"+(""===this.options.attributes.value?" hidden":""),events:{click:function(){t.elements.input.setValue(""),t.elements.input.focus(),t.getContent().getElement(".fonticon-cancel-squared").addClassName("hidden"),t.keyUp.call(t.elements.input.getContent())}}},{tag:"i",class:"fonticon fonticon-search pointer",events:{click:function(e){var n=t.elements.input.getValue().length;e.preventDefault(),e.stopPropagation(),t.open?n>=t.minChar&&t.keyUp.call(t.elements.input.getContent()):t.openInput()}}},this.elements.input]}})}})}),define("DS/i3DXCompassCmp/Utils/ImageUploader",["UWA/Core","UWA/Class","UWA/Class/Events","DS/UIKIT/Mask","DS/UIKIT/Tooltip","DS/i3DXCompassCmp/Utils","DS/i3DXCompassCore/Controls/PlatformNotify","i18n!DS/i3DXCompassCmp/assets/nls/i3DXCompassCmp"],function(e,t,n,i,s,o,a,r){"use strict";var l=["png","jpeg","jpg","gif","svg"];return t.extend(n,{defaultSrc:null,actions:[],className:"image-uploader",elements:{},init:function(t){var n=this;this.defaultSrc=t.defaultSrc,this.src=t.src,t.className&&(this.className=t.className),this.actions=[{id:"upload",title:e.String.format(r.get("Upload, {0}"),this._getAllowedExtension()),handler:function(){n.openFile()}},{id:"trash",title:r.get("Delete"),handler:function(){n.setValue(n.defaultSrc),n.container.getElement(".input-file-hidden").setContent(n.buildUploadIcon()),n._hideTrashAction(),n.dispatchEvent("onHideTrashAction")}}],this.width=t.width||64,this.height=t.height||64,this.imgWidth=t.imgWidth||120,this.imgHeight=t.imgHeight||120},_hideTrashAction:function(){this.container&&(this.container.getElements(".actions")[0].setStyle("height",this.height),this.container.getElements(".actions")[1].addClassName("hidden"))},_showTrashAction:function(){this.container&&(this.container.getElements(".actions")[0].setStyle("height",this.height/this.actions.length),this.container.getElements(".actions")[1].removeClassName("hidden"))},_manageFiles:function(e){var t,n=this,s=this.container.getElement(".preview-icon"),r=s.getParent("div"),u=new FileReader,c="";e.length>0&&(c=this._isFile(e)?e[0].name:e,t=o.getFileExtension(c),l.indexOf(t)>-1?(i.mask(r,""),this._isFile(e)?(u.readAsDataURL(e[0]),u.onload=function(e){n._manageImage(e.target.result,s,r)}):n._manageImage(c,s,r)):a.alert(n._getAllowedExtension()))},_getAllowedExtension:function(){return e.String.format(r.get("Allowed extensions are .{0}"),l.join(", ."))},_isFile:function(e){return e[0]&&e[0].name},_manageImage:function(e,t,n){var s=this;setTimeout(function(){var l=new Image;0!==e.indexOf("data:")&&(l.crossOrigin="Anonymous"),l.onload=function(){var e,a,r=document.createElement("canvas");r.width=l.width,r.height=l.height,r.getContext("2d").drawImage(l,0,0),((e=l.width>l.height?s.imgWidth/l.width:s.imgHeight/l.height)<0||e>1)&&(e=1),a=o.downScaleCanvas(r,e),t.src=a.toDataURL(),s.imageIsValid=!0,s.dispatchEvent("onChange",t.src),s._showTrashAction(),s.dispatchEvent("onShowTrashAction"),i.unmask(n,"")},l.onerror=function(){i.unmask(n,""),a.alert(r.get("The selected file is not a valid Image"))},l.src=e},100)},onChange:function(){},_buildActions:function(){var e=this,t=[];return this.actions.forEach(function(n,i){t.push(e._buildAction(n,i))}),t},_buildAction:function(t,n){var i=this,o=e.createElement("div",{class:"actions",styles:{top:this.height/this.actions.length*n,height:this.height/this.actions.length,width:this.width},html:{class:e.String.format("fonticon fonticon-{0} pointer action-icon",t.id)},events:{click:function(){t.handler(),i.container.removeClassName("hover")}}});return t.title&&new s({target:o,body:t.title,position:"right"}),o},_getSrc:function(){return this.src||this.defaultSrc},render:function(){var t=this,n=this.buildUploadIcon(),i=[];return i.push(this._buildActions()),i.push({tag:"img",src:this._getSrc(),class:"preview-icon pointer",events:{click:function(){n.click()},error:function(){this.setAttribute("src",t._getSrc())}}}),i.push({class:"hidden input-file-hidden",html:n}),this.container=e.createElement("div",{styles:{width:this.width,height:this.height},class:this.className,events:{mouseenter:function(){this.addClassName("hover")},mouseleave:function(){this.removeClassName("hover")},touchstart:function(e){return!!this.hasClassName("hover")||(this.addClassName("hover"),e.preventDefault(),e.stopPropagation(),!1)},dragover:function(e){e.preventDefault()},drop:function(e){e.preventDefault(),t._manageFiles(e.dataTransfer.getData("URL")||e.dataTransfer.files)}},html:i}),this._getSrc()===this.defaultSrc&&(this._hideTrashAction(),this.dispatchEvent("onHideTrashAction")),this.container},openFile:function(){this.elements.input.click()},setValue:function(e){this.container&&(this.container.getElement(".preview-icon").src=""===e?this.defaultSrc:e)},getBase64Value:function(){return this.container.getElement(".preview-icon").src===this.defaultSrc?"":this.container.getElement(".preview-icon").src},buildUploadIcon:function(){var t=this;return this.elements.input=e.createElement("input",{type:"file",class:"hidden",events:{change:function(){t._manageFiles(this.files)}}}),this.elements.input}})}),define("DS/i3DXCompassCmp/Modal/Prereq",["UWA/Core","UWA/Controls/Abstract","DS/i3DXCompassCmp/Modal/FullScreenModal","DS/UIKIT/Input/Toggle","DS/i3DXCompassCore/Model/ProcessModel","DS/UIKIT/Input/Button","DS/i3DXCompassCore/Collection/ProcessCollection","DS/i3DXCompassCore/Utils","UWA/Event","i18n!DS/i3DXCompassCmp/assets/nls/i3DXCompassCmp"],function(e,t,n,i,s,o,a,r,l,u){"use strict";return t.extend({defaultOptions:{prereq:[],onConfirm:function(){},onCancel:function(){},number:1,type:"and"},needed:!1,disableOKButton:!1,clickOkPressed:!1,content:null,neededPrereq:null,prereqOptionsMissing:!0,init:function(e){var t=this,i=e.model;this._parent(e),this.model=i,this.selectMode=e.selectMode,i.isTPA()||(this.modal=new n({closable:!0,header:"",className:r.getPlatformManagementWrapperClassName("prereq-needed"),body:"",footer:"",events:{onHide:function(){t.clickOkPressed||t.options.onCancel(),this.destroy(),r.manageSupportOfMultiModal()}}}),this._asPrereq(i)&&"or"===i.get("prereq").type&&1===i.get("prereq").process.length&&(i.get("prereq").type="and"),this._asPrereq(i)&&(t.options.prereq=i.get("prereq").process.filter(function(e){return"and"!==i.get("prereq").type||!t.options.selectedCollection.get(e.uid)}),"or"===i.get("prereq").type&&(t.prereqOptionsMissing=i.get("prereq").process.filter(function(e){return!t.options.selectedCollection.get(e.uid)}),t.prereqOptionsMissing=t.prereqOptionsMissing.length>0)),t.options.prereq.length>0&&(t.needed=!0,"or"===i.get("prereq").type&&(this.disableOKButton=!0,this.options.okButton&&t.prereqOptionsMissing&&this.options.okButton.setDisabled(t.disableOKButton))),i.get("prereq")&&"or"===i.get("prereq").type&&!t.prereqOptionsMissing&&(t.needed=!1)),this.elements.container=this.modal},getMandatoryPrereq:function(){var e=new a,t=this.model;return this._asPrereq(t)&&"and"===t.get("prereq").type&&this._manageSubPrereq(t,e),this.prereqOptionsMissing||this._asPrereq(t)&&"or"===t.get("prereq").type&&this._manageSubPrereq(t,e),e},isNeeded:function(){return this.needed},confirm:function(){this.modal.setHeader("<h3>"+this.getTitle()+"</h3>"),this.modal.setBody(this.getContent()),this.modal.setFooter(this.getButtons()),this.modal.inject(document.body).show(),this.manageDefaultSelection()},_manageButtonActivation:function(){var t,n=!1;"or"===this.model.get("prereq").type?(t=this.getContent().getElements('tr[data-level="0"] input'),n=e.Array.detect(t,function(e){return!0===e.checked})):n=(t=this.getContent().getElements("tr input")).every(function(e){return!0===e.checked}),this.options.okButton&&this.options.okButton.setDisabled(!n)},manageDefaultSelection:function(){var e=this;"or"===this.model.get("prereq").type&&(this.options.selectedCollection.forEach(function(t){var n,i=[];e.getContent().getElement('[value="'+t.get("uid")+'"]')&&(i=e.getContent().getElements('[data-prereq="'+t.get("uid")+'"] input'),e.getContent().getElement('[value="'+t.get("uid")+'"]:not(:disabled)')&&(e.getContent().getElement('[value="'+t.get("uid")+'"]:not(:disabled)').checked=!0,i.forEach(function(e){e.checked=!0}))),n=e.elements.container.getBody().getElements("[name=prereq-licenses\\[\\]]:checked"),e.model.get("prereq")&&"or"===e.model.get("prereq").type&&(e.disableOKButton=n.length>0,e.options.okButton&&e.options.okButton.setDisabled(e.disableOKButton))}),0===this.options.selectedCollection.size()&&(e.disableOKButton=!0,e.options.okButton&&e.options.okButton.setDisabled(e.disableOKButton))),this._manageButtonActivation()},getTitle:function(){var e=this.model.get("option")?u.get("Granting this option will also grant"):u.get("Granting this role will also grant");return"and"===this.model.get("prereq").type?e:u.get("You need to select at least one of these roles")},getContentOld:function(){var t=this,n=[];return t.content||(this.options.prereq=new a(this.options.prereq),this.options.prereq.forEach(function(i){var s,o=!1;t._asPrereq(i)&&(s=t.getOptionsDetail(i,"or"===t.model.get("prereq").type),o=e.Array.detect(s.getElements("tr[data-free]"),function(e){return"false"===e.getAttribute("data-free")})),n.push(t.getContentItem(i,t.model.get("prereq").type,null,0,!!o)),s&&n.push(s)}),t.content=e.createElement("table",{class:"table",html:n})),t.content},getContent:function(){var t=this,n=[];return t.content||(this.options.prereq=new a(this.options.prereq),this.options.prereq.forEach(function(i){var s=[],o=!1;t._asPrereq(i)&&(t._manageSubPrereq(i,t.options.prereq,s,"or"===t.model.get("prereq").type),e.Array.detect(s,function(e){return"and"===e.getAttribute("data-type")})&&(o=e.Array.detect(s,function(e){return"false"===e.getAttribute("data-free")}))),n.push(t.getContentItem(i,t.model.get("prereq").type,null,0,!!o)),s&&n.push(s)}),t.content=e.createElement("table",{class:"table",html:n})),t.content},_asPrereq:function(e){return e.get("prereq")&&e.get("prereq").process&&e.get("prereq").process.length>0},_isChecked:function(e,t,n){return this.options.selectedCollection.get(e.get("uid"))||e.hasFree(this.options.number)&&"and"===t&&!n},_isDisabled:function(e,t,n){return this.options.selectedCollection.get(e.get("uid"))||"and"===t||(e.get("free")<this.options.number||n)&&(0!==e.get("total")&&!1===e.get("withLicenses")||e.get("total")>0)},getContentItem:function(t,n,s,o,a){var r=this,u=this._isChecked(t,n,s);o||(o=0),u/*!model.hasFree() && type === 'and'*/||(this.disableOKButton=!0,this.options.okButton&&this.options.okButton.setDisabled(r.disableOKButton),this.modal.getContent().addClassName("big-modal"));var c=new i({className:"primary",type:"checkbox",name:"prereq-licenses[]",value:t.get("uid"),label:t.get("name"),checked:u,disabled:!!this._isDisabled(t,n,a)});return e.createElement("tr",{"data-level":o,"data-free":t.get("free")>=this.options.number,"data-type":n,html:[{tag:"td",styles:{"padding-left":15*o+8},html:c},{tag:"td",class:"text-right status",html:this.getInformation(t)}],events:{click:function(e){if(c.isDisabled())l.stop(e);else{var t=!c.isChecked();if(c.setCheck(t),"or"===this.getAttribute("data-type")){r._checkAllSubRow(this,c.isChecked(),o);var n=this;if(1===parseInt(this.getAttribute("data-level"),10)&&(n=r._getFirstLevel(this)),n)if(n.getElement("input:checked")){var i=n.nextElementSibling;i&&"or"===i.getAttribute("data-type")&&parseInt(i.getAttribute("data-level"),10)<parseInt(n.getAttribute("data-level"),10)?i.getElement('[data-type="or"][data-level="1"] input:checked')?(r.disableOKButton=!1,r.options.okButton&&r.options.okButton.setDisabled(!1)):(r.disableOKButton=!0,r.options.okButton&&r.options.okButton.setDisabled(!0)):(r.disableOKButton=!1,r.options.okButton&&r.options.okButton.setDisabled(!1))}else r.disableOKButton=!0,r.options.okButton&&r.options.okButton.setDisabled(!0)}l.stop(e)}}}})},_getFirstLevel:function(e){var t=e.previousSibling;return t&&0===parseInt(t.getAttribute("data-level"),10)||!t?t||e:this._getFirstLevel(t)},_checkAllSubRow:function(e,t,n){var i=e.nextElementSibling;i&&parseInt(i.getAttribute("data-level"),10)>n&&(i.getElement("input").checked=t,this._checkAllSubRow(i,t,n))},_manageSubPrereq:function(e,t,n,i,o){var a=this;o||(o=0),this._asPrereq(e)&&(o++,e.get("prereq").process.forEach(function(r){var l=new s(r);n&&n.push(a.getContentItem(l,e.get("prereq").type,i,o)),t.add(l),a._manageSubPrereq(l,t,n,i,o)}))},getOptionsDetail:function(t,n){var i=[];return this._manageSubPrereq(t,this.options.prereq,i,n),e.createElement("tr",{html:[{tag:"td",colspan:2,styles:{padding:0},html:e.createElement("table",{class:"table role-option-prereq","data-prereq":t.get("uid"),html:i})}]})},getInformation:function(t){var n="",i=this.options.selectedCollection.get(t.get("uid"));return i?this.selectMode?n+=u.get("Already selected:")+" ":n+=u.get("Already granted:")+" ":0===t.get("total")&&!1===t.get("withLicenses")?n+=u.get("No license associated"):t.hasFree()||(n+=u.get("No more role available:")+" "),0===t.get("total")&&!1===t.get("withLicenses")?n+="":n+=e.String.format(u.get("Used: {0}/{1}"),t.get("total")-t.get("free"),t.get("total")),{tag:"span",class:0===t.get("total")&&!1===t.get("withLicenses")||!t.hasFree()&&!i?"text-error":"",text:n}},getButtons:function(){var e=this;return e.options.okButton=new o({value:u.get("Ok"),className:"primary",disabled:this.disableOKButton,events:{onClick:function(){var t=e.elements.container.getBody().getElements("[name=prereq-licenses\\[\\]]:checked"),n=new a;t.forEach(function(t){n.add(e.options.prereq.get(t.value))}),e.clickOkPressed=!0,e.model.get("prereq")&&"or"===e.model.get("prereq").type?e.options.onConfirm(n):e.options.onConfirm(e.getMandatoryPrereq()),e.modal.hide()}}}),[e.options.okButton,new o({value:u.get("Cancel"),className:"default",events:{onClick:function(){e.modal.hide()}}})]}})}),define("DS/i3DXCompassCmp/Controls/Tagger",["UWA/Core","UWA/Controls/Abstract","DS/UIKIT/Input/Text","DS/i3DXCompassCmp/Controls/Tags","DS/i3DXCompassCore/Utils","i18n!DS/i3DXCompassCmp/assets/nls/i3DXCompassCmp"],function(e,t,n,i,s,o){"use strict";return t.extend({defaultOptions:{validator:function(e){return e.length>0},onSuccess:function(){},onError:function(){},onLimitError:function(){},placeholder:"",limit:null,onChange:function(){}},isFirst:!0,init:function(e){var t=this;t._parent(e),this.buildContainer(),setTimeout(function(){t.elements.input.focus()},1)},buildContainer:function(){this.elements.container=e.createElement("div",{html:[{class:"tags-input-wrapper",html:[{class:"tag-wrapper"},{class:"tag-input-wrapper",html:this.buildInput()}]},{class:"clearfix"}]})},buildInput:function(){var e=this;return this.elements.input=new n({className:"pull-right",attributes:{type:"email",placeholder:this.options.placeholder,autofocus:this.options.focus||null,events:{keydown:function(t){9===t.keyCode&&e.paste(!1,!0)},keyup:function(t){17!==t.keyCode&&(13===t.keyCode||188===t.keyCode?e.paste(!1,!0):e.paste(!0,!0))},drop:function(){e.paste(!1,!0)},paste:function(){e.paste(!1,!0)},blur:function(){e.paste(!1,!1)}}}}),this.elements.input},paste:function(e,t){var n=this;setTimeout(function(){var i,o,a,r,l=n.elements.input.getValue(),u=l,c=n.elements.container.getElement(".tags-input-wrapper"),p=n.elements.container.getElement(".tag-input-wrapper"),h=!0;!e&&l.contains(" ")&&(r=s.extractEmails(l))&&(l=r.join(";")),(e&&l.indexOf(";")>-1||!e)&&((i=l.split(";")).forEach(function(e,t){""!==e&&(n.options.validator(e)&&null!==n.options.limit&&n.getSelected().length<n.options.limit?-1===n.getSelected().indexOf(e)&&((o=n.buildTag(e)).inject(c),o.asyncCheck(),h=!1,a=t+1===i.length?"":";",l=l.replace(e+a,"")):n.options.validator(e)&&n.getSelected().length===n.options.limit&&(p.hasClassName("has-error")||(p.addClassName("has-error"),n.options.onLimitError())))}),l!==u&&(n.elements.input.setValue(l),n.syncInputSize(),t&&setTimeout(function(){n.elements.input.focus()},1)),h&&n.validate())},0)},buildTag:function(e){var t=this;return new i({text:e,onDestroy:function(){setTimeout(function(){t.syncInputSize(),t.validate()},10)},onChange:function(){t.syncInputSize(),t.validate()},onError:function(){t.syncInputSize(),t.options.onError()},syncInputSize:t.syncInputSize.bind(this),validator:t.options.validator,validatorAsync:t.options.validatorAsync})},isFirstEmailAlreadySelected:function(){var e=this.elements.input.getValue().split(";");return this.getSelected().indexOf(e[0])>-1},validate:function(){var e=this;setTimeout(function(){var t=e.elements.container.getElement(".tag-input-wrapper");t&&(""!==e.elements.input.getValue()||0!==e.getContent().getElements(".uwa-input-split.has-error").length?(t.hasClassName("has-error")||t.addClassName("has-error"),""!==e.elements.input.getValue()&&e.isFirstEmailAlreadySelected()?e.options.onError(!0):""!==e.elements.input.getValue()?e.options.onError():e.options.onError(!0)):(t.removeClassName("has-error"),e.options.onSuccess()))},10)},proceedRemove:function(){var e=this.elements.container.getElements(".uwa-input-tags.focus");e.length>0?(e.forEach(function(e){e.destroy()}),this.syncInputSize()):(e=this.elements.container.getElements(".uwa-input-tags")).length>0&&(e[e.length-1].destroy(),this.syncInputSize()),this.validate()},syncInputSize:function(){var e=0,t=this,n=t.elements.container.getSize().width,i=n,s=[];t.elements.container.getElements(".uwa-input-tags").forEach(function(e){e.inject(t.elements.container.getElement(".tags-input-wrapper"))}),t.elements.container.getElements(".uwa-input-tags").forEach(function(i){e+=i.getDimensions().outerWidth,t.isFirst&&(e+=5),s.push(i),e>n-200&&(s.forEach(function(e){t.elements.container.getElement(".tag-wrapper").grab(e)}),s=[],e=0)}),t.isFirst&&(t.isFirst=!1),n-e>200&&(i=n-e),e>0?t.elements.container.getElement("input").setStyle("width",i-5):t.elements.container.getElement("input").setStyle("width","100%"),t.options.onChange()},getSelected:function(){var e=[];return this.elements.container.getElements(".uwa-input-tags span.form-control").forEach(function(t){e.push(t.getHTML())}),e}})});