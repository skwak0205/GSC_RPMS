define("DS/ENONewWidget/ENONew/Controller/ENONewController",["UWA/Controls/Abstract","DS/ENONewWidget/ENONew/Controller/ENONewDialogController","DS/UIKIT/Input/Button","DS/Controls/Button","DS/ENONewWidget/ajaxRequests/ENONewServices","DS/ENONewWidget/ajaxRequests/ENONewAjaxRequests","DS/LifecycleControls/CredentialList","DS/ENOCollabSharingCmds/commands/Notification/Notification","i18n!DS/ENONewWidget/assets/nls/ENONewWidgetNls"],function(e,t,i,n,o,a,s,r,c){return e.extend({skeleton:null,defaultOptions:{},defaultEvents:{onSuccess:function(){},onFailure:function(){},onCancel:function(){}},defaultAttributes:{},init:function(e){console.log("ENONew Controller init");this.id=e.id,this.context=e.context,this.labelTopBar=e.labelTopBar,this.commandName=e.commandName,this.overlay=e.overlay,this.responseFormat=e.responseFormat,this.facets=e.facets,this.viewType=e.viewType,this._parent(e),this.objInfo={type:e.type,options:e.options,events:e.events},this.silentMode=e.silentMode,this.notification=e.notification,this.Services=new o(e.context,{parsedResult:e.parsed}),this.buttons={};var t=this.objInfo.events;for(eventID in t){var i=t[eventID];this.addEvent(eventID,i)}this.silentMode?this.silentCreation():this._setup()},getUI:function(e){var i=this;return new UWA.Promise(function(e){i.dialog||(i.dialog=new t),e(i.dialog)})},_setup:function(){var e=this,t=e.getUI(),i={type:this.objInfo.type,preferedType:this.objInfo.options.preferedType,subTypes:!0},n=e._getTypeInfo(i),o=this.Services.getSecurityContextList();UWA.Promise.all([o,n,t]).then(function(t){console.log("ENONew PromiseAll SecurityContext, typeInfo"),e.postFetchAttributes(t[1],"launch"),e.defaultAttributes.SecurityContext=t[0],e.defaultAttributes.Type=t[1].Type,e.attributes=t[1].attributes,e.interfaces=t[1].interfaces,t[1].reInitOnSecCtxChange&&e.defaultAttributes.SecurityContext&&(e.defaultAttributes.SecurityContext.reInitOnSecCtxChange=!0),e.displayDialog()}).catch(function(t){e.handleError(t),e.destroyComponent()})},silentCreation:function(){var e=this,t={type:this.objInfo.type,subTypes:!1},i=e._getTypeInfo(t,!0),n=this.Services.getPreferedSecurityContext();UWA.Promise.all([n,i]).then(function(t){var i=t[0],n=t[1],o={eventID:"createClose",securityContext:i};e._create(n,o)}).catch(function(t){e.handleError(t),e.destroyComponent()})},displayDialog:function(){var e=this,t={defaultAttributes:this.defaultAttributes,attributes:this.attributes,interfaces:this.interfaces},i={overlay:this.overlay,title:this.labelTopBar?this.labelTopBar:c.get("new")+" "+e.getCurrentTypeNLS(),persistId:"ENONew_"+(this.id?+this.id:this.buildID()),facets:this.facets,viewType:this.viewType},n={onChangeAttribute:function(t){console.log("ENONew Controller onchnage"),e._onChangeAttribute(t)},onClose:function(){e.destroyComponent()}};this.dialog.setup(t,i,this.buttons,n,function(t,i){e.onSubmit(t,i)})},refreshDialog:function(){var e={defaultAttributes:this.defaultAttributes,attributes:this.attributes,interfaces:this.interfaces};this.dialog.reloadContent(e),this.dialog.resetButtons()},reloadDialog:function(e){var t=this,i={type:e};this._getTypeInfo(i).then(function(e){t.attributes=e.attributes,t.interfaces=e.interfaces,t.refreshDialog()}).catch(function(e){t.handleError(e),t.destroyComponent()})},onSubmit:function(e,t){this.defaultAttributes=e.defaultAttributes;var i,n,o=e.defaultAttributes;for(var a in o){var s=o[a],r=s.name;if("Type"===r){i=s.value;var c=s.persistData;for(var l in c){var d=c[l];d.name===i&&(e.subTypes=[d])}}else"SecurityContext"===r&&(n=s.value)}t.securityContext=n,e.type=i,delete e.defaultAttributes,this._create(e,t)},_getTypeInfo:function(e,t){var i=e.type?e.type:this.objInfo.type,n=e.preferedType?e.preferedType:"",o=!!e.subTypes&&e.subTypes,a=e.securityContext?e.securityContext:void 0,s={type:i,preferedType:n,typeName:this.objInfo.options.typeName,parentOrigin:this.objInfo.options.parentOrigin,domainAttributes:this.objInfo.options.domainAttributes,subTypes:o,securityContext:a};return this.objInfo.options.preferedType=n||i,this.Services.getTypeInfo(s,t)},_onChangeAttribute:function(e){var t=this;if(e)for(var i in console.log(e),e){if("New-Type"===i){var n=e[i].valueDB;this.objInfo.type=n;var o={type:n};t._getTypeInfo(o).then(function(e){t.defaultAttributes.Type.value=n,t.attributes=e.attributes,t.interfaces=e.interfaces,t.postFetchAttributes(e,"onChangeType"),t.refreshDialog()}).catch(function(e){t.dispatchEvent("onFailure",[e]),t.destroyComponent()})}if("New-SecurityContext"===i){if(t.defaultAttributes.SecurityContext.reInitOnSecCtxChange){var a=e[i].valueDB;t._getTypeInfo({securityContext:a}).then(function(e){t.defaultAttributes.SecurityContext.value=a,t.attributes=e.attributes,t.interfaces=e.interfaces,t.postFetchAttributes(e,"onChangeSecurityContext"),t.refreshDialog()}).catch(function(e){t.dispatchEvent("onFailure",[e]),t.destroyComponent()})}}else if("3DPartTemplate"===i){var s=e[i],r=s.valueDB,c=s.authorizedValues.includes(r);t.PartTemplate3D=c?r:""}}},_create:function(e,t){var i=this;if(e){t=t||{};var n={};n.typeName=this.objInfo.options.typeName,n.aggregating_context=this.objInfo.options.parentPIDs,n.select=this.objInfo.options.select,n.folderID=this.objInfo.options.folderID,this.objInfo.options.selectedIDs&&(n.selectedIDs=this.objInfo.options.selectedIDs),n.activeFolder=this.objInfo.options.activeFolder;var o={queryParams:n,securityContext:t.securityContext};i.Services.createContent(e,o,function(n,o){setTimeout(function(){i.onSuccessOfCreation(n,o,function(){"create"===t.eventID?i.reloadDialog(e.type):"createClose"===t.eventID&&i.destroyComponent()})},0)},function(n){i.handleError(n),"create"===t.eventID?i.reloadDialog(e.type):"createClose"===t.eventID&&i.destroyComponent()})}},onSuccessOfCreation:function(e,t,i){var n=this;if("success"===e.status)if(n.responseFormat){if(2==n.responseFormat&&(e.parsedResult=JSON.parse(e.parsedResult),"FAILURE"!==e.parsedResult.result&&(e.parsedResult.rawAttr=JSON.parse(e.parsedResult.rawAttr),e.parsedResult.instances))){var o=e.parsedResult.instances;for(var a in o){var s=o[a];s.hasOwnProperty("to[CAD SubComponent].physicalid")?(s.relationphysicalid=s["to[CAD SubComponent].physicalid"],delete s["to[CAD SubComponent].physicalid"]):s.hasOwnProperty("to[VPMInstance].physicalid")&&(s.relationphysicalid=s["to[VPMInstance].physicalid"],delete s["to[VPMInstance].physicalid"]),s.hasOwnProperty("instanceName")&&(s.relationname=s.instanceName,delete s.instanceName)}}}else{var r=e.result,c=[];for(var l in r){var d=r[l],u={identifier:d.identifier?d.identifier:d.physicalid,source:t,type:d.type};d.relations&&(u.relations=d.relations),c.push(u)}e.result=c}else n.handleError(e),i();n.dialog?n.dialog.postCreation(e,function(){n.dispatchEvent("onSuccess",[e]),i()}):(n.dispatchEvent("onSuccess",[e]),i())},handleError:function(e){var t=e.result;if(void 0!==t&&this.notification)for(var i in t){var n=t[i];if(n.errors)for(ind1 in n.errors){var o=n.errors[ind1];this.setNotification("error",o)}}this.dispatchEvent("onFailure",[e])},getCurrentTypeNLS:function(){if(this.commandName)return this.commandName;var e=this.defaultAttributes.Type.value,t=e,i=this.defaultAttributes.Type.range,n=this.defaultAttributes.Type.rangeNLS,o=i.indexOf(e);return o>=0&&o<n.length&&(t=n[o]),t},setNotification:function(e,t){var i=t.errorCode,n=t.errorTitle?t.errorTitle:c[i+"_Title"],o=t.errorSubtitle?t.errorSubtitle:c[i+"_Subtitle"],a="";if(t.errorMessages&&0!=t.errorMessages.length)for(var s in t.errorMessages){a&&(a+="<br>"),a+=t.errorMessages[s]}else a=c[i+"_Msg"];"ENONEW_ERROR_5001"!==i&&"InvalidAccess"!==i||t.errorTitle||(n=c.cantCreateObject+": "+this.getCurrentTypeNLS()),"ENONEW_ERROR_0003"!==i&&"ENONEW_ERROR_1003"!==i&&"ENONEW_ERROR_1002"!==i||(n=c.ObjCreationFailed),"ENONEW_ERROR_4005"!==i&&"ENONEW_ERROR_0002"!==i||(n+=": "+this.getCurrentTypeNLS()),"ENONEW_ERROR_0007"===i&&(n+=this.commandName?": "+this.commandName:"."),"ENONEW_ERROR_1004"===i&&(n=c.cantCreateObject1+": "+this.getCurrentTypeNLS(),o=c.contactYourAdmin),n||"error"!==e||(n=n=c.ObjCreationFailed);var r={level:e,title:n,subtitle:o,message:a};this._setNotification(r)},_setNotification:function(e){r.display(e)},update:function(e){this.dialogView.updateView(e)},destroyComponent:function(){var e={preferedType:this.objInfo.options.preferedType};this.dispatchEvent("onCancel",[e]),this.dialog&&this.dialog.destroy(),this.destroy()},_raiseNotif:function(e,t){this.dispatchEvent("onNotification",{msg:e,eventID:t})},getSaveBtn:function(){var e=this,t=new n({label:c.saveBtn,onClick:function(i){if(!e.dialog.onEscKeyDown){var n=e.objInfo.options.preferedType;n&&""!=n&&null!=n&&null!=n||(n=e.objInfo.type);var o=n;if(n){var a=e.defaultAttributes.Type.range,s=e.defaultAttributes.Type.rangeNLS,r=a.indexOf(n);r>=0&&r<s.length&&(o=s[r])}o&&require(["DS/UIKIT/SuperModal"],function(i){new i({closable:!0,animate:!1,overlay:!0}).confirm({title:c.saveSettingsTitle,message:c.get("confirmsaveSettingsMsg",{type:o}),callback:function(i){if(t.label=c.saveBtnLoading,i){var a=e.PartTemplate3D;if(a){var s={type:n,UUID:a};e.Services.set3DPartTemplate(s,void 0,function(t){e.dialog._addNotif({msg:c.get("confirmsaveSuccessMsg",{type:o}),eventID:"success"})},function(t){e.dialog._addNotif({msg:c.get("confirmsaveErrorMsg",{type:o}),eventID:"error"})})}else e.dialog._addNotif({msg:c.get("confirmsaveErrorMsg",{type:o}),eventID:"error"})}t.label=c.saveBtn}})})}}});return t},postFetchAttributes:function(e,t){if(e&&e.attributes.volatileAttributes){var i=e.attributes.volatileAttributes;for(var n in i){var o=i[n];if("3DPartTemplate"===o.name&&(this.PartTemplate3D=o.value,"launch"===t)){var a=this.getSaveBtn();a.visibleFlag=!1,this.buttons.Close=a}}}},buildID:function(){var e="ID_";return this.objInfo.options.typeName&&(e+=this.objInfo.options.typeName),this.objInfo.type&&(e+=this.objInfo.type),this.Services&&(e+=this.Services.tenant),e.replaceAll(" ","_")}})}),define("DS/ENONewWidget/ENONewLauncher",["UWA/Controls/Abstract","DS/LifecycleServices/LifecycleServicesSettings"],function(e,t){return t.app_initialization(function(){}),e.extend({CreateNew:function(e){e&&require(["DS/ENONewWidget/ENONew/ENONewEngine"],function(t){new t(e)})}})}),define("DS/ENONewWidget/ajaxRequests/ENONewAjaxRequests",["DS/LifecycleServices/LifecycleServices","DS/LifecycleServices/LifecycleServicesSettings","DS/WidgetServices/WidgetServices","DS/WAFData/WAFData","DS/LifecycleControls/CredentialList","DS/WidgetServices/securityContextServices/SecurityContextServices"],function(e,t,i,n,o,a){return{_get:function(e,t,i){var o=Date.now().toString(),a="timestamp"+o;e.params[a]=o;var s=e.service+"?tenant="+e.tenant;-1!=s.indexOf("?")?s+="&":s+="?";var r=e.params;for(var c in r){var l=r[c];l instanceof Array?l.forEach(function(e){s+=c+"="+e+"&"}):s+=c+"="+l+"&"}var d=this.getHeaders(e.header);n.authenticatedRequest(s,{method:"GET",headers:d,timeout:864e5,type:"json",onComplete:function(e){t(e)},onFailure:function(e,t){var n=e.message;n.startsWith("NetworkError:")&&n.contains("401")?i({result:[{errors:[{errorCode:"InvalidAccess"}]}]}):i({result:[{errors:[{errorCode:"NetworkError"}]}]})},onTimeout:function(){i({result:[{errors:[{errorCode:"NetworkError"}]}]})}})},_post:function(e,t,i,o){var a=JSON.stringify(e),s=t.service+"?tenant="+t.tenant;for(var r in-1!=s.indexOf("?")?s+="&":s+="?",t.params){var c=t.params[r];c instanceof Array?c.forEach(function(e){s+=r+"="+e+"&"}):s+=r+"="+c+"&"}var l=this.getHeaders(t.header);n.authenticatedRequest(s,{method:"POST",headers:l,timeout:864e5,data:a,type:"json",onComplete:function(e){i(e)},onFailure:function(e,t){var i=e.message;i.startsWith("NetworkError:")&&i.contains("401")?o({result:[{errors:[{errorCode:"InvalidAccess"}]}]}):o({result:[{errors:[{errorCode:"NetworkError"}]}]})},onTimeout:function(){o({result:[{errors:[{errorCode:"NetworkError"}]}]})}})},getHeaders:function(e){var t={Accept:"application/json","Content-Type":"application/json","Accept-Language":widget.lang};for(var i in e){var n=e[i];"SecurityContext"===i&&(n=encodeURIComponent(n)),t[i]=n}return t}}}),define("DS/ENONewWidget/ENONew/View/Facet/ENONewFacetBase",["DS/EditPropWidget/facets/Common/FacetsBase"],function(e){return e.extend({init:function(e,t){this.sharedOptions=t,this.facetValidation=!0,this._parent(e)},updateFacet:function(){console.log("ENONewFacetBase : updateFacet() "+this.options.tabId)},setFacetValidation:function(e){this.facetValidation=e,this.getOccurrence().setValidation(e)},getFacetvalidation:function(){return this.facetValidation},publishInfo:function(e,t){e&&t&&this.getOccurrence().addInfo(this.options.tabId,e,t)},fetchInfo:function(e,t){e&&this.getOccurrence().getInfo(e,t)},listenToPublishedInfo:function(e,t){t=t||"",setTimeout(()=>{this.getOccurrence().addEvent("publishinfo."+t,e)})},postCreation:function(e){var t=this;return console.log("onComplete : "+this.options.tabId),new UWA.Promise(function(e){e({name:t.options.tabId})})},destroy:function(){this._parent()}})}),define("DS/ENONewWidget/validation/FileName",["UWA/Class"],function(e){"use strict";var t={name:"CATIAV5",require:"DS/ENOXCADCATIAV5UI/ENOXCADFileNameValidation"};return{validate:function(e,i){var n=e.value,o=t.require;console.log("require "+o),require([o],function(e){e.checkfilenameValidity(n,function(e){var t;null!=e&&(console.log("ENOXCADFileNameValidation : "+e),t={message:e,eventID:"warning"}),i(t)})})}}}),define("DS/ENONewWidget/utils/ENONewConstants",[],function(){"use strict";return{ATTRIBUTES:"attributes",INTERFACES:"interfaces",PUBLIC_ATTRIBUTES:"publicAttributes",EXTN_ATTRIBUTES:"extensionAttributes",VOLATILE_ATTRIBUTES:"volatileAttributes",TYPES:{INTEGER:"integer",REAL:"real",TIMESTAMP:"timestamp",PERSON:"person",BOOLEAN:"boolean",ENUM:"enum"},DIALOG:{TAB_VIEW:"tabView",WIZARD_VIEW:"wizardView",LIST_VIEW:"listView"},DOMAIN_ATTRIBUTES:"domainAttributes"}}),define("DS/ENONewWidget/command/NewContentDialog",["UWA/Class","DS/Windows/ImmersiveFrame","DS/Windows/Panel","DS/Controls/Expander","DS/Controls/Button","DS/Controls/LineEditor","i18n!DS/ENONewWidget/assets/nls/ENONewWidgetNls","css!DS/ENONewWidget/ENONewWidget.css"],function(e,t,i,n,o,a,s){var r,c=s.newContentLabel;return e.extend({init:function(){r=new t({identifier:"ENONew_NewContentDialog_Frame"})},injectImmersiveFrame(e){e||(e=new UWA.Element("div")).inject(widget.body),r.inject(e)},display(e,t,i){var n,o=new UWA.Element("div");if(o.inject(widget.body),r.inject(o),e){var a=0;Object.keys(e).forEach(function(t){e[t]&&(a+=e[t].length)}),console.log("ENONewInfra NewContentDialog: noOfTypesToList="+a)}if(e&&0!=a){console.log("ENONew : Not prepared");var c={label:s.get("Type"),UIType:"Expander",items:[],expanded:!0};if(e){var l={};for(var d in e){var u=e[d];u&&u.length>0&&u.forEach(function(e){if(e){var t={UIType:"Command",label:e.nls,icon:e.icon,newType:d,objType:e.name},i=e.package,n=l[i];n||(n={UIType:"Expander",label:i,items:[],expanded:!0},l[i]=n,c.items.push(n)),n.items.push(t)}})}}for(var f in l)l[f];n=this.displayDialog([c],t,function(e){var t=e.dsModel.value;t&&i({type:t.objType,newType:t.newType,commandName:t.label})})}else n=this.buildInputTypeField(t,i);return n},displayDialog:function(e,t,a){var s=new UWA.Element("div");function l(e){var t=new UWA.Element("div",{class:"expander_container grid-cell-expander"}),i=e.label?e.label:"",o=!!e.expanded&&e.expanded,a=new UWA.Element("div",{class:"expander_content grid-container-content"}),s=e.items;f(s).inject(a);var r=new n({header:i,body:a,style:"simple",expandedFlag:o});return r.inject(t),r}s.inject(widget.body);var d,u,f=function(e){var t,i,n,s,r,c;if(e)for(var d in t=new UWA.Element("div"),e){var u,f=e[d];"Expander"===f.UIType?u=l(f):"Command"===f.UIType?(i=f,n=void 0,s=void 0,r=void 0,c=void 0,n=new UWA.Element("div",{class:"command_content grid-cell-btn"}),s=i.label?i.label:"",r=i.icon?i.icon:"",(c=i.launcherOptions?i.launcherOptions:"")||(c=i),new o({value:c,label:s,icon:r,displayStyle:"lite",onClick:a,styles:{display:"block",width:"fit-content"}}).inject(n),u=n):(console.log("NewContent : Incomplete data"),console.log(f)),u&&u.inject(t)}else console.log("NewContent : No data");return t},h=f(e),p=t.labelTopBar?t.labelTopBar:c;t.dimension&&(d=void 0!==t.dimension.height?t.dimension.height:-1,u=void 0!==t.dimension.width?t.dimension.width:-1);var v=void 0===t.resizable||t.resizable,g=new i({allowedDockAreas:WUXDockAreaEnum.NoneDockArea,immersiveFrame:r,title:p,content:h,height:d,width:u,resizableFlag:v,position:{my:"center",at:"center",of:r},identifier:"ENONew_NewContentDialog_Dialog"});return r.inject(s),g},buildDialog:function(e){var t,n,o=e.identifier?e.identifier:"ENONew_NewContentDialog",a=e.labelTopBar?e.labelTopBar:c;e.dimension&&(t=void 0!==e.dimension.height?e.dimension.height:-1,n=void 0!==e.dimension.width?e.dimension.width:-1);var s=void 0===e.resizable||e.resizable,l=e.content?e.content:void 0;return new i({identifier:o,allowedDockAreas:WUXDockAreaEnum.NoneDockArea,immersiveFrame:r,title:a,content:l,height:t,width:n,resizableFlag:s,position:{my:"center",at:"center",of:r}})},buildInputTypeField(e,t){var i=new UWA.Element("div",{class:"command_content_vma12 input_type"}),n=new UWA.Element("div",{class:"lineContainer input_type"});n.inject(i),new UWA.Element("span",{text:"Dictionary Type"}).inject(n);var s=new a({placeholder:"Enter a value",value:"VPMReference"});s.inject(n);var r=new UWA.Element("div",{class:"lineContainer button_create"});r.inject(i);var c=function(){t({type:s.value,newType:"Default"})},l=(new o({value:"Create",label:"Create",onClick:c,emphasize:"primary",styles:{display:"block",width:"fit-content"}}).inject(r),this.buildDialog({content:i}));return l.addEventListener("keydown",function(e){13==e.keyCode&&c()}),l},destroyDialog:function(){r.destroyAllWindows()}})}),define("DS/ENONewWidget/ENONew/View/Facet/ENONewFacetHelper",["i18n!DS/ENONewWidget/assets/nls/ENONewWidgetNls"],function(e){var t={},i={facetObject:{require:"",alwaysCalled:!0,facet:{name:"",text:"",icon:""},options:{data:{}}},getFacetDefinition:function(e){return t[e]},getFacetList:function(e,t){var n=[],o=this.getDefaultFacet();return o.options.data=e,n.push(o),t&&t.forEach(function(e){var t=i.getFacetDefinition(e.name);t&&(e.facetoptions&&(t.options=e.facetoptions),n.push(t))}),n},getDefaultFacet:function(){return{require:"DS/ENONewWidget/ENONew/View/Facet/ENOListViewFacet",facet:{name:this.getDefaultFacetName(),text:e.get("Create"),icon:"attributes"},options:{}}},getDefaultFacetName:function(){return"ENOCreate"}};return i}),define("DS/ENONewWidget/utils/ENONewAttributeUtil",["DS/EditPropWidget/models/EditPropAttributeModel","i18n!DS/ENONewWidget/assets/nls/ENONewWidgetNls"],function(e,t){"use strict";function i(e,t){if(e){console.log("vma save local pref : "+e);var i="ENONew";t&&(i+="_"+t),i+="_"+e;var n=localStorage.getItem(i);return console.log(i),n}}return{_buildAttributesModel:function(t,n,o){var a=[];if(UWA.is(t,"array"))for(var s in t){var r=t[s],c=r.name,l=r.nls,d=r.type,u=r.value,f=r.value,h=r.isReadOnly,p=r.visible,v=r.extension,g=r.range,m=r.authorizedValuesRequired,N=r.rangeNLS,w=r.rangeGroup,y=r.icons,E=r.forbiddenChar,C=r.dimension,b=r.unitName,D=r.dimensionType,O=r.maxlength,S=r.multiline,I=r.multivalued,T=r.positionUI,A=r.positionGroup,F=r.modified,_=r.mandatory,x=r.visibility,W=r.defaultAttribute,V=r.storeLocalPreference,U=r.validationService,L=r.sortedOptions,B=r.dropdownMode;if(p){d||(d="string");var j=d;if("string"===(d=d.toLowerCase()))j="text";else if("integer"===d)j="integer";else if("real"===d)j="real";else if("boolean"===d)j="boolean";else if("date"===d||"timestamp"===d){if(""!=u){var M=parseInt(u),k=new Date(M);f=this._convertDateToStandard(k,!0).valueDB}j="timestamp"}var R=c;R=v?v+"-"+R:R,W&&(R="New-"+c);var P=new e({path:R,name:c,label:l,value:u,valueDB:f,type:j,readOnly:h});"3DPartTemplate"==c&&P.set("autocomplete",!0),"boolean"!==j&&g&&(g&&P.set("authorizedValues",g),N&&P.set("authorizedValuesNLS",N),w&&P.set("authorizedValuesGroup",w),y&&P.set("authorizedValuesIcon",y),m&&P.set("authorizedValuesRequired",m),P.set("customSelect",!0)),p&&P.set("visible",p),E&&P.set("forbiddenChar",E),L&&P.set("sortedOptions",L),U&&P.set("validationService",U),O>0&&P.set("maxlength",O),x&&P.set("visibility",x),S&&P.set("multiline",S),F&&P.set("modified",F),I&&P.set("multivalue",I),_&&P.set("mandatory",_),W&&P.set("defaultAttribute",W),B&&P.set("dropdownMode",B),_||P.set("facet","ExtensionsFacet");var z=2;W?z=6:o&&(z=9),A&&(z=A);var q=1;v&&(z="4."+v),T||0===T||(q=2,T=0,P.set("masked",!1));var K=z+"-"+q+"-"+T;if(P.set("positionUI",K),V){P.set("storeLocalPreference",V);var H=i(R,"attribute");H&&(g&&g.includes(H)||!g)&&H!=f&&(P.set("valueDB",H),P.set("isModified",!0))}null!=C&&(P.set("dimension",C),P.set("unitName",b),P.set("dimensionType",D))}null!=P&&a.push(P)}return a},_parseAttributeModels:function(e,t){t&&e&&(e.hasOwnProperty("value")&&e.value!==t.valueDB&&(e.value=t.valueDB,e.modified=!0,t.storeLocalPreference&&function(e,t,n){if(e&&t){console.log("vma save local pref : "+e+" = "+t);var o="ENONew";n&&(o+="_"+n),o+="_"+e,console.log(o),localStorage.setItem(o,t),console.log(i(e,n))}}(t.getIdentifier(),t.valueDB,"attribute")))},_convertDateToStandard:function(e,t){if(!e)return{value:"",valueDB:""};var i=t?e:new Date,n=e.getUTCFullYear(),o=e.getUTCMonth()+1,a=e.getUTCDate(),s=i.getUTCHours(),r=i.getUTCMinutes(),c=i.getUTCSeconds();return o<10&&(o="0"+o),a<10&&(a="0"+a),s<10&&(s="0"+s),r<10&&(r="0"+r),c<10&&(c="0"+c),i.setYear(n),i.setMonth(e.getMonth()),i.setDate(a),{value:i.toLocaleString(widget.lang),valueDB:n+"/"+o+"/"+a+"@"+s+":"+r+":"+c+":GMT"}}}}),define("DS/ENONewWidget/ENONewWidget",[],function(){}),define("DS/ENONewWidget/command/NewContentCmdMap",["UWA/Class"],function(e){var t={newType1_dummy:{cmdRequire:"",command:{label:"",icon:"",shortHelp:""}}};return e.singleton({getCmdDetails:e=>t[e]})}),define("DS/ENONewWidget/ENONew/ENONewEngine",["UWA/Core","UWA/Controls/Abstract","DS/WidgetServices/WidgetServices","DS/ENONewWidget/ENONew/Controller/ENONewController","DS/ENONewWidget/utils/ENONewConstants"],function(e,t,i,n,o){var a=["DummyBookmark"];return t.extend({objInfo:{id:"",context:{header:{SecurityContext:""},tenant:"",service:"",serviceBaseUrl:""},labelTopBar:"",commandName:"",overlay:!0,type:"",silentMode:!1,responseFormat:0,notification:!0,options:{preferedType:"",typeName:"",select:[],parentPIDs:[],selectedIDs:[],parentOrigin:[],folderID:[],activeFolder:!1,domainAttributes:[{name:"",value:[]}]},facets:[],viewType:"listView",events:{onSuccess:function(){},onFailure:function(){},onCancel:function(){}}},_getController:function(e){return this.controller?this.controller:new n(e)},init:function(e,t){if(console.log("ENONew Engine init"),t&&i.setWidgetObject(t),this._parent(e),e&&void 0!==e.type){this.context=e.context,this.objInfo.id=void 0!==e.id?e.id:"",this.objInfo.context=e.context?e.context:{},this.objInfo.type=e.type,this.objInfo.silentMode=!0===e.silentMode,this.objInfo.responseFormat=e.responseFormat?e.responseFormat:0,this.objInfo.responseFormat&&(this.objInfo.parsed=!0),this.objInfo.labelTopBar=e.labelTopBar,this.objInfo.commandName=e.commandName,this.objInfo.overlay=0!=e.overlay,this.objInfo.notification=0!=e.notification,this.objInfo.facets=e.facets?e.facets:[],this.objInfo.viewType=e.viewType?e.viewType:o.DIALOG.LIST_VIEW;var n=this.objInfo.options;for(var s in n){if(s===o.DOMAIN_ATTRIBUTES){var r=e.options[s],c=[];r&&(r.forEach(function(e){if(e&&e.name&&a.includes(e.name)){var t={name:e.name};e.value&&(t.value=e.value),c.push(t)}}),e.options[s]=c)}n[s]=e.options[s]}var l=this.objInfo.events;for(var d in l)l[d]=e.events[d];this.controller=this._getController(this.objInfo)}},destroyComponent:function(){this.controller&&this.controller.destroyComponent(),this.destroy()}})}),define("DS/ENONewWidget/command/NewContentCommandBase",["DS/ApplicationFrame/Command","DS/ENONewWidget/ENONewLauncher"],function(e,t){"use strict";return e.extend({init:function(e){if(this._parent(e),e.context){var i=e.context.getENONewContext;UWA.is(i,"function")&&(this.ENONewContext=e.context.getENONewContext(),console.log("ENONewContext set"))}this.launcher=new t},launchCreateNew(e){this.launcher&&this.launcher.CreateNew(e)},execute(){var e=this.getCreateOptions({});this.launchCreateNew(e)},getCreateOptions(e){var t,i,n=this.ENONewContext;if(n&&n.getCreateOptions&&UWA.is(n.getCreateOptions,"function")&&(i=n.getCreateOptions(e)),this.getOptions&&UWA.is(this.getOptions,"function")&&(t=this.getOptions(e)),t){if(i)for(var o in i){var a=i[o];if("events"===o)Object.assign(t[o],a);else if(a)if(UWA.is(a,"object")&&"options"===o)if(t[o])for(var s in a){var r=a[s];r&&(t[o][s]=r)}else t[o]=a;else t[o]=a}}else i&&(t=i);return this.getType&&UWA.is(this.getType,"function")&&(t.type=this.getType()),t}})}),define("DS/ENONewWidget/command/sample/ENONewDummyCmd",["DS/ENONewWidget/command/NewContentCommandBase"],function(e){"use strict";return e.extend({defaults:{type:"VMADocument"},init:function(e){console.log("DummyCmd init"),this._parent(e)},getType(){return this.defaults.type},execute:function(){this.launchCreationDialog()},launchCreationDialog(){var e=this.getCreateOptions({});this.launchCreateNew(e)},getOptions:e=>({options:{typeName:"DummyImpl"},events:{onSuccess:function(e){console.log("object creation successful"),console.log(e)},onFailure:function(e){console.log("object creation failure")},onCancel:function(e){console.log("object creation cancellled")}}})})}),define("DS/ENONewWidget/command/sample/ENONewMockDocumentCmd",["DS/ENONewWidget/command/NewContentCommandBase"],function(e){"use strict";return e.extend({defaults:{type:"MockDocument"},init:function(e){console.log("DummyCmd init"),this._parent(e)},getType(){return this.defaults.type},execute:function(){this.launchCreationDialog()},launchCreationDialog(){var e=this.getCreateOptions({});this.launchCreateNew(e)},getOptions:e=>({options:{},events:{onSuccess:function(e){console.log("object creation successful"),console.log(e)},onFailure:function(e){console.log("object creation failure")},onCancel:function(e){console.log("object creation cancellled")}}})})}),define("DS/ENONewWidget/ENONew/View/ENOListView",["UWA/Core","UWA/Controls/Abstract","DS/EditPropWidget/facets/Properties/Properties","DS/EditPropWidget/models/EditPropAttributeModel","DS/EditPropWidget/models/EditPropModel","DS/EditPropWidget/utils/AttributesUtils","DS/ENONewWidget/utils/ENONewAttributeUtil","DS/ENONewWidget/utils/ENONewConstants","i18n!DS/ENONewWidget/assets/nls/ENONewWidgetNls","css!DS/ENONewWidget/ENONewWidget.css"],function(e,t,i,n,o,a,s,r,c){return t.extend({init:function(t){this.customEvents=[],this.floatingAttributes={},this.attributesForValidationService=[],this.persistAttribute={},this.enableNotif=!1,this.identifier=t.identifier,this.skeleton=e.createElement("div",{class:"Attributes_container","data-rec-id":"Attributes_container_rec-id",styles:{width:"100%",height:"100%",display:"flex","overflow-y":"auto","overflow-x":"hidden","flex-direction":"column"}});var n=t.events;for(eventID in n){var o=n[eventID];this.addEvent(eventID,o)}this.onComplete=t.onComplete,this.buttons=t.buttons;var a=new i({setCloseButton:!1,editMode:!0,readOnly:!1,scroller:!1,identifier:this.identifier,events:{onCancel:function(){},onNotification:function(e){}}}).inject(this.skeleton);this.propUI=a;a.setAccordionProperties({ExtensionsFacet:{name:"ExtensionsFacet",nameNLS:"Extensions",weight:-10}})},buildModel:function(e){this.data=e,this.propModel=new o;var t=this._buildAttributesModel(e);this.setPropModel(t)},setPropModel:function(e){var t,i=this,o=this.propModel;if(e){for(var a in this.customEvents){var s=this.customEvents[a];o.addEvent(s.eventID,s.callback.bind(s))}t=o.set(e)}if(o.addEvent("onEnterKeyDown",function(e){i.dispatchEvent("onEnterKeyDown",[e])}),t){o.addEvent("onChange",function(e){console.log("ENONew onChange");var t=e._changed;for(var i in console.log(t),t){var n=t[i];n.isModified||(n.isModified=!0),n.isUIModified=!0}}),o.addEvent("onChange:New-Type",function(){console.log("ENONew Type Changed"),i.dispatchEvent("onChangeAttribute",[this._changed])}),o.addEvent("onChange:New-SecurityContext",function(){console.log("ENONew SecurityContext Changed"),i.dispatchEvent("onChangeAttribute",[this._changed])}),o.get("3DPartTemplate")&&o.addEvent("onChange:3DPartTemplate",function(e,t){console.log("ENONew 3DPartTemplate Changed"),i.dispatchEvent("onChangeAttribute",[this._changed])});var r=o.get("ExtensionsFacet-Filename")?"ExtensionsFacet-Filename":!!o.get("Filename")&&"Filename";if(r){var c=o.get("PLMEntity.V_Name")?"PLMEntity.V_Name":!!o.get("ExtensionsFacet-PLMEntity.V_Name")&&"ExtensionsFacet-PLMEntity.V_Name";c||(c=o.get("V_Name")?"V_Name":!!o.get("ExtensionsFacet-V_Name")&&"ExtensionsFacet-V_Name");var l=!1;o.addEvent("onChange:"+c,function(){if(!l){var e=o.get(r),t=o.get(c);if(e&&e.visible){var i=new n(e);i.set("value",t.get("value")),i.set("valueDB",t.get("valueDB")),o.set(i.getIdentifier(),i),l=!1}}}),o.addEvent("onChange:"+r,function(){l=!0})}}return t},loadView:function(e){this.propUI.initData([this.propModel],{new:!0}),this.propModel.clearChangedValue(),this._resizeHandler(),this.manageAccordion(this.propUI),this.enableNotif=!0,this.focusFirstLine()},refresh:function(){this.enableNotif=!1,this.propUI.addData([this.propModel]),this.manageAccordion(this.propUI),this.enableNotif=!0},focusFirstLine:function(){var e=this;setTimeout(function(){var t=e.propUI.elements.formSection.elements.accordion.items[0].name;e.propUI.elements.formSection.elements._organizers[t].focusLine(0,0)})},updateResizeHandler:function(){var e=this;this.propUI.elements.formSection.elements.accordion.items.forEach(function(t){var i=t.name;e.propUI.elements.formSection.elements._organizers[i]._forms[0].dispatchEvent("resetDisplay1")})},manageAccordion:function(e){var t=e.elements.formSection.elements.accordion;if(t){var i;t._expanderItems[0]&&t._expanderItems[0].elements.header.hide();t._expanderItems[1]&&(i=t._expanderItems[1]),i&&(!0===i.expandedFlag?i.header=c.collapseExtension:i.header=c.expandExtension,t.getContent().addEventListener("expand",function(e){if("ExtensionsFacet"===e.options.expanderTarget.domId){var t=c.collapseExtension;e.dsModel._expanderItems[e.options.expanderIndex].header=t}}),t.getContent().addEventListener("collapse",function(e){if("ExtensionsFacet"===e.options.expanderTarget.domId){var t=c.expandExtension;e.dsModel._expanderItems[e.options.expanderIndex].header=t}}))}},destroy:function(){console.log("ENONew destroy")},_addNotif:function(e){console.log(e),this.enableNotif&&this.dispatchEvent("onFacetNotification",[e])},onSubmit:function(t){var i=this,n=function(n){!0===e.is(n,"array")&&n.forEach(function(e){i._addNotif({customClass:e.customClass,eventID:e.eventID,msg:e.message})}),t(!1)},o=(i=this,[]);this.propModel.getAttributeFromField().forEach(function(e){e.visible&&o.push(e)}),this.propModel.lockModel(!0);var s=a.validateAttributes(this.propModel,o);s?n(s):this.validationFromService(function(){var e=i._parseModel(i.data,i.propModel);t(e)},n)},validationFromService:function(t,i){var n=this.attributesForValidationService,o=[];for(var a in n){var s=n[a],r=this.propModel.get(s);if(r&&r.visible){var c=new e.Promise(function(e,t){var i=r.validationService,n={name:r.name,value:r.valueDB};require([i],function(t){t.validate(n,function(t){e(t)})})});o.push(c)}}e.Promise.all(o).then(function(e){console.log(e);var n=[];for(var o in e){var a=e[o];a&&n.push(a)}0==n.length?t():i(n)}).catch(function(e){console.log("vma validation service failed, proceeding for object creation"),t()})},_buildAttributesModel:function(e){var t=this,i={},n=[],o=e.defaultAttributes,a=[];for(var c in o){var l=o[c];a.push(l)}if(a.length>0){var d=s._buildAttributesModel(a);n=n.concat(d)}var u=e[r.ATTRIBUTES],f=e[r.INTERFACES];if(u){var h=u[r.PUBLIC_ATTRIBUTES];if(h){d=s._buildAttributesModel(h,f);n=n.concat(d)}var p=u[r.EXTN_ATTRIBUTES];if(p){d=s._buildAttributesModel(p,f);n=n.concat(d)}var v=u[r.VOLATILE_ATTRIBUTES];if(v){d=s._buildAttributesModel(v,f,!0);n=n.concat(d)}for(var g in n){var m=n[g];if(this.persistAttribute[m.getIdentifier()]){var N=this.persistAttribute[m.getIdentifier()];m.set("value",N.value),m.set("valueDB",N.valueDB),m.set("isModified",!0)}var w=m.visibility;if(w)for(var c in w){var y={attrID:m.getIdentifier(),list:w[c],eventID:"onChange:"+c,callback:function(e,i){var n=this;console.log("onchange "+i.valueDB);var o=i.valueDB,a=!1;n.list.includes(o)&&(a=!0),setTimeout(function(){t.addAttributeOnUI(n.attrID,a)},0)}};this.customEvents.push(y)}i[m.getIdentifier()]=m,m.validationService&&this.attributesForValidationService.push(m.getIdentifier())}}return i},addAttributeOnUI:function(e,t){var i=this.propModel;if(i&&i.get(e)&&(i.get(e).visible=t,this.propUI.elements.formSection.toggleFormOrgLine(e,t),"3DPartTemplate"===e)){var n=this.buttons.Close;n&&(n.visibleFlag=t)}},_parseModel:function(e,t){if(t&&e){var i={},n=t.getAttributeFromField(),o=e.attributes,a=e.defaultAttributes;for(attrId in n)if(attrModel=n[attrId],attrModel.isModified){var r=attrModel.name,c=null,l=!1;if(attrModel.defaultAttribute)for(var d in a)(c=a[d]).name===r&&s._parseAttributeModels(c,attrModel);else if(o){var u=function(e,t){for(ind in t)if((c=t[ind]).name===e&&(l=!0),l)break};for(AttrGrp in o){if(u(r,o[AttrGrp]),l)break;c=null}null!=c&&s._parseAttributeModels(c,attrModel)}if(attrModel.isUIModified){var f={name:attrModel.name,value:attrModel.value,valueDB:attrModel.valueDB};this.persistAttribute[attrModel.getIdentifier()]=f}}i.attributes=o,i.defaultAttributes=a;var h=e.interfaces;return h&&(i.interfaces=h),i}},getUI:function(){return this.propUI},getContentSize:function(){var e=this.propUI.getContent();if(e)return e.getSize()},_resizeHandler:function(){var e=this;this.propUI.elements.formSection.elements.container.addEvent("resize",function(){e.isLoaded=!0;var t=e.getContentSize();e.dispatchEvent("onResize",[t])})}})}),define("DS/ENONewWidget/ENONew/View/Facet/ENOListViewFacet",["UWA/Core","DS/UIKIT/Scroller","DS/ENONewWidget/ENONew/View/Facet/ENONewFacetBase","DS/ENONewWidget/ENONew/View/ENOListView","DS/ENONewWidget/ENONew/View/Facet/ENONewFacetHelper"],function(e,t,i,n,o){return i.extend({init:function(i){this._parent(i),console.log("vma12 : Create facet init"),this.skeleton=e.createElement("div",{class:"CreateFacet_container",styles:{width:"100%",height:"100%",display:"flex","overflow-y":"auto","overflow-x":"hidden","flex-direction":"column"}});var o=new t({element:this.skeleton});this.listview=new n(i),this.listview.propUI.inject(o.elements.content),this.listview.buildModel(i.data),this.listview.loadView()},updateFacet:function(e){this.listview.buildModel(e.data),this.listview.loadView()},_getUI:function(){return this.skeleton},getUI:function(){return this.skeleton},onSubmit:function(e,t){this.listview.onSubmit(t)},onComplete:function(t){return new e.Promise(function(e){e({name:o.getDefaultFacetName()})})},destroy:function(){this.listview.destroy(),this._parent()}})}),define("DS/ENONewWidget/command/NewContentOptions",["UWA/Class","DS/ENONewWidget/utils/ENONewConstants","i18n!DS/ENONewWidget/assets/nls/ENONewWidgetNls"],function(e,t,i){return e.extend({init(){this.prefType},getNewTypeList:function(){return[]},getCreateOptions:function(e){return this.launcherOptions||(this.launcherOptions={type:e.type,context:{service:"3DSpace"},silentMode:!1,notification:!0,options:{typeName:e.newType,parentPIDs:[],selectedIDs:[],domainAttributes:[]},events:{onSuccess:function(){console.log("Creation Successful")},onFailure:function(){console.log("Creation Error")},onCancel:function(e){console.log("Creation dialog closed")}}}),this.launcherOptions}})}),define("DS/ENONewWidget/command/sample/LifecycleWidgetNewCmdOptions",["DS/ENONewWidget/command/NewContentOptions"],function(e){return e.singleton({getNewTypeList:function(){return[]},getCreateOptions:function(e){var t=this;return this.launcherOptions||(this.launcherOptions={silentMode:!1,events:{onSuccess:function(e){console.log("ENONew LC Widget Creation Successful ");var i=e.result;if(i){var n=[];i.forEach(function(e){n.push({objectId:e.identifier})}),t.LCwidgetContext.addNewObject1({data:{items:n}}),t.LCwidgetContext.displayNotification({eventID:"success",msg:"Object creation successful"})}},onFailure:function(){console.log("ENONew LC Widget Creation Error")},onCancel:function(e){console.log("ENONew LC Widget Creation dialog closed")}}}),this.launcherOptions}})}),define("DS/ENONewWidget/command/sample/ENONewDummyCmdOptions",["DS/ENONewWidget/command/NewContentOptions"],function(e){return e.singleton({getCreateOptions:function(e){return this.launcherOptions||(this.launcherOptions={context:{service:"3DSpace"},silentMode:!1,notification:!0,options:{parentPIDs:e.parentPIDs,selectedIDs:[],domainAttributes:[{name:"DummyBookmark"}]}},this.events&&(this.launcherOptions.events=this.events)),this.launcherOptions}})}),define("DS/ENONewWidget/ENONew/View/ENOTabView",["UWA/Core","UWA/Controls/Abstract","DS/EditPropWidget/constants/EditPropConstants","DS/EditPropWidget/UI/IDCardSkeleton","DS/EditPropWidget/models/OccurrenceModel","DS/ENONewWidget/ENONew/View/Facet/ENONewFacetHelper"],function(e,t,i,n,o,a){return t.extend({init:function(t){this.opts=t,this._parent(t),this.sharedInfo={},console.log("vma12 : tab view init"),this.skeleton=e.createElement("div",{class:"ENONewTab_container",styles:{width:"100%",height:"100%"}}),this.facets=t.facets,this.setupDefaultFacet()},setupDefaultFacet:function(){var e=this,t=this._getFacetFromName(a.getDefaultFacetName());t.options.events={};var i=!0;t.options.events.onResize=function(t){if(i){i=!1;var n={height:t.height+e.idCardSkeleton.elements.tabContainer.getSize().height+8,width:t.width};e.dispatchEvent("onResize",[n]),e.isLoaded=!0}},t.options.events.onChangeAttribute=function(t){e.dispatchEvent("onChangeAttribute",[t])},t.options.events.onEnterKeyDown=function(){e.dispatchEvent("onEnterKeyDown")},t.options.events.onFacetNotification=function(t){e.dispatchEvent("onFacetNotification",[t])}},_getFacetFromName:function(e){return this.facets.find(t=>t.facet.name===e)},buildModel:function(e){console.log(e)},loadView:function(){var e=this,t={name:"ENONew tab_content",className:"ENONew_TabView_MasterContain",typeOfDisplay:i.ONLY_EDIT_PROPERTIES,selectionType:i.NO_SELECTION,readOnly:!1,extraNotif:!1,showIdCard:!1,closeButton:!1,showTopBar:!1};t.sharedContext=new o,t.sharedContext.addInfo=function(i,n,o){if(i&&n){e.sharedInfo[i]||(e.sharedInfo[i]={}),e.sharedInfo[i][n]=o;var s=i===a.getDefaultFacetName()?"":i;t.sharedContext.dispatchEvent("publishinfo."+s,[n,o])}},t.sharedContext.getInfo=function(t,i){if(t)return i||(i=a.getDefaultFacetName()),e.sharedInfo[i][t]},t.sharedContext.setValidation=function(){e.dispatchEvent("refreshValidationStatus")},this.idCardSkeleton=new n(this.facets,t),this.idCardSkeleton.elements.container.inject(this.skeleton),this.idCardSkeleton._manageFacetVisibility(),this.idCardSkeleton.elements.tabs.addEventListener("tabButtonClick",function(t){var i=t.options.value,n=e._getFacetFromName(i);e.dispatchEvent("onTabChange",[n])})},loadFacet:function(e,t,i){this.idCardSkeleton._loadFacet(e,t,i)},refreshView:function(){this.idCardSkeleton.selectFacet(a.getDefaultFacetName())},getUI:function(){return this._getUI()},_getUI:function(){return this.skeleton}})}),define("DS/ENONewWidget/ENONew/View/ENOWizardView",["UWA/Class/Events","UWA/Class/Promise","UWA/Controls/Abstract","UWA/Core","DS/ENONewWidget/ENONew/View/Facet/ENONewFacetHelper"],function(e,t,i,n,o){return i.extend(e,{name:"DS/ENONewWidget/ENONew/View/facet/wizardView",isLoaded:null,init:function(e){for(var t in this.options=e,this._parent(e),this.navigator={container:null,toggler:null},this.content={container:null},this.activeView="",this.activeMode="multi-step",this._sharedOptions={},this.facets=e.facets,e.events)this.addEvent(t,e.events[t]);this.setupDefaultFacet(),this.addEvent("onTabChange",e.events.onTabChange),this.skeleton=n.createElement("div",{class:"create-view-body multi-step",styles:{width:"100%",height:"100%"}})},setupDefaultFacet:function(){var e=this,t=this._getFacetFromName(o.getDefaultFacetName());t.options.events={};var i=!0;t.options.events.onResize=function(t){if(i){i=!1;var n=e.navigator.container.getSize(),o={height:t.height+n.height+8,width:n.width};e.dispatchEvent("onResize",[o]),e.setRopeLength(e.activeView)}e.isLoaded=!0},t.options.events.onChangeAttribute=function(t){e.dispatchEvent("onChangeAttribute",[t])},t.options.events.onEnterKeyDown=function(){e.dispatchEvent("onEnterKeyDown")},t.options.events.onFacetNotification=function(t){e.dispatchEvent("onFacetNotification",[t])}},loadView:function(){var e=this;e.navigator.container=n.createElement("nav",{class:"create-view-navigator-container"}).inject(e.skeleton),n.createElement("div",{class:"evolve-container",html:[n.createElement("div",{class:"evolve-rope-placeholder"}),n.createElement("div",{class:"evolve-rope"})]}).inject(e.navigator.container);var t=n.createElement("nav",{class:"create-view-navigator"}).inject(e.navigator.container);e.facets.forEach(function(i){if(i.facet){var n=e._tabItem(i.facet);i.navItem=n,n.container.inject(t)}}),e.content.container=n.createElement("div",{class:"create-view-content"}).inject(e.skeleton),e.facetContainer=n.createElement("div",{class:"wizardFacetContainer",styles:{width:"100%",height:"100%"}}).inject(e.content.container),e.switchView(o.getDefaultFacetName())},getContext:function(){return this._sharedContext},setContext:function(e){this._sharedContext=e},refreshView:function(){this.switchView(o.getDefaultFacetName())},_tabItem:function(e){var t=this,i={};return i.container=n.createElement("a",{id:e.name,class:"nav-item"}),i.container.addEventListener("dragover",function(){t.switchView(e.name)}),i.activeIndicator=n.createElement("div",{class:"nav-item-active-indicator"}).inject(i.container),n.createElement("span",{class:"fonticon fonticon-expand-down"}).inject(i.activeIndicator),i.circle=n.createElement("div",{class:"nav-item-circle"}).inject(i.container),n.createElement("span",{class:"fonticon fonticon-"+e.icon}).inject(i.circle),i.label=n.createElement("div",{class:"nav-item-label",html:e.text}).inject(i.container),i},switchView:function(e){var t=this,i=this.activeView;if(t.navigator&&t.navigator.container&&e){var n=t.navigator.container.getElements("a"),o=!1;n.forEach(function(n){!1===o?n.removeClassName("filled").addClassName("filled"):n.removeClassName("filled"),n.id===i&&n.removeClassName("active"),n.id===e&&(n.addClassName("active"),t.setRopeLength(e),o=!0)})}var a=this._getFacetFromName(i);a&&a.content&&a.content.hide();var s=this._getFacetFromName(e);s&&s.content?s.content.show():t._loadFacet(s,!0,function(){console.log("Done loading facet")}),t.activeView=e,t.dispatchEvent("onTabChange",[s])},setRopeLength:function(e){if(e){var t=this._getFacetFromName(e).navItem.circle;if(t){var i=t.getDimensions().outerWidth,n=(t.getPosition().x-10+i)/this.navigator.container.getSize().width*100;this.navigator.container.getElement(".evolve-rope").setStyles({width:n+"%",height:"2px"})}}},loadFacet:function(e,t,i){this._loadFacet(e,t,i)},_loadFacet:function(e,t,i){var n=this;if(e&&"loading"!==e.content)if(e.content)i.call(n);else{e.content="loading";var o=++window.top.perfoIncrem;window.top.performance.mark("start_prereqFacet:"+o),require([e.require],function(a){window.top.performance.mark("end_prereqFacet:"+o),e.content=null;var s=n.activeView,r=e.facet.name===s;if(!t||r){var c=e.options?e.options:{},l=c.events?c.events:{};c.events=l,e.options=c,e.options.tabId=e.facet.name,e.options.eventThread=n.options.eventThread+"."+e.facet.name,e.content=new a(e.options,n._sharedOptions);var d=e.content.getUI(),u="function"==typeof d.addClassName?d:d.container?d.container:d.elements?d.elements.container:null;u&&u.addClassName("ENONew_wizard_Container ENONew_wizard_"+e.facet.name),e.content.getUI().inject(n.facetContainer),r||e.content.hide(),i.call(n)}})}},_getFacetFromName:function(e){return this.facets.find(t=>t.facet.name===e)},_getFacetIndexFromName:function(e){return this.facets.findIndex(t=>t.facet.name===e)},getActiveFacet:function(){return this._getFacetFromName(this.activeView)},isFirstFacet:function(e){return 0===this._getFacetIndexFromName(e)},isLastFacet:function(e){return this._getFacetIndexFromName(e)===this.facets.length-1},switchToRelativeFacet:function(e){var t=this.activeView,i=this._getFacetIndexFromName(t),n=this.facets[i+e];this.switchView(n.facet.name)}})}),define("DS/ENONewWidget/ENONew/Controller/ENONewDialogController",["UWA/Controls/Abstract","DS/Windows/ImmersiveFrame","DS/Controls/Button","DS/Windows/Dialog","DS/ENONewWidget/ENONew/View/ENOListView","DS/ENONewWidget/ENONew/View/ENOTabView","DS/ENONewWidget/ENONew/View/ENOWizardView","DS/ENONewWidget/ENONew/View/Facet/ENONewFacetHelper","i18n!DS/ENONewWidget/assets/nls/ENONewWidgetNls"],function(e,t,i,n,o,a,s,r,c){return e.extend({init:function(e){this._parent(e),this.immersiveFrame=new t({}),this.immersiveFrame.inject(widget.body)},setup:function(e,t,i,n,o){for(eventID in n=n||{}){var a=n[eventID];this.addEvent(eventID,a)}if(this.ServiceCallback=o,this.viewType="listView",t){if(t.facets&&t.facets.length&&t.viewType&&(this.viewType=t.viewType,this.facets=r.getFacetList(e,t.facets)),this.identifier=t.persistId?t.persistId:"ENONew_Id",this.footerButtons=this.getDefaultButtons(this.viewType),i)for(var s in i)this.footerButtons[s]=i[s];this.buildContent(e,t);var l={identifier:this.identifier,title:t.title?t.title:c.CreateNew,modalFlag:t.overlay,content:this.View.skeleton,width:580,position:{my:"center",at:"center",collision:"fit"},buttons:this.footerButtons,escapeButton:this.footerButtons.Discard};this.myDialog=this.buildDialog(l),this.manageButtons()}},buildDialog:function(e){var t=this;e.resizableFlag=!0,e.immersiveFrame=this.immersiveFrame,e.activeFlag=!0;var i=new n(e);return i.addEventListener("close",function(){t.dispatchEvent("onClose")}),this.disableBtnClickOnEnter=!1,i.addEventListener("keydown",function(e){13===e.keyCode?t.disableBtnClickOnEnter=!0:27===e.keyCode&&(t.onEscKeyDown=!0)}),i.addEventListener("keyup",function(e){13===e.keyCode?(t.onEnterKeyDown=!1,t.disableBtnClickOnEnter=!1):27===e.keyCode&&(t.onEscKeyDown=!1,t.dispatchEvent("onClose"))}),i},buildContent:function(e,t,i){var n=this,r=!0;if("listView"===this.viewType)this.View=new o({identifier:this.identifier,events:{onChangeAttribute:function(e){n.dispatchEvent("onChangeAttribute",[e])},onFacetNotification:function(e){n._addNotif(e)},onEnterKeyDown:function(){n.onEnterKeyDown=!0},onResize:function(e){r&&(r=!1,n.View.focusFirstLine(),setTimeout(function(){n.myDialog.minHeight=n.myDialog.elements._footerDiv.offsetHeight+80})),n.View.updateResizeHandler()}},buttons:n.footerButtons}),this.View.buildModel(e),this.View.loadView();else{var c={identifier:this.identifier,facets:this.facets,buttons:n.footerButtons,events:{onTabChange:function(e){n.manageButtons(e)},onChangeAttribute:function(e){n.dispatchEvent("onChangeAttribute",[e])},onFacetNotification:function(e){n._addNotif(e)},onEnterKeyDown:function(){n.onEnterKeyDown=!0},onResize:function(e){if(setTimeout(function(){n.myDialog.minHeight=n.myDialog.elements._footerDiv.offsetHeight+80}),!n.myDialog._getDimensionsFromPreferences()){var t=n.myDialog.elements.container.getSize().height-n.myDialog.elements._contentDiv.getSize().height;n.myDialog.height=e.height+t,n.myDialog._applyPosition()}},refreshValidationStatus:function(){n.evaluateValidationStatus()}}};"tabView"===this.viewType?this.View=new a(c):"wizardView"===this.viewType&&(this.View=new s(c)),this.View.loadView()}return this.View},showDialog:function(){this.myDialog.show()},reloadContent:function(e){if("listView"===this.viewType)this.View.buildModel(e),this.View.loadView();else{this.View.refreshView();var t=r.getDefaultFacetName();this.View.facets.forEach(function(i){if(i.content&&UWA.is(i.content.updateFacet,"function")){var n=i.options;e&&i.facet.name===t&&(n.data=e),i.content.updateFacet(n)}})}},onSubmitDialog:function(e){var t=this,i=function(i){i?"create"!==e&&"createClose"!==e||t.ServiceCallback&&"function"==typeof t.ServiceCallback&&t.ServiceCallback(i,{eventID:e}):t.resetButtons()};"listView"===this.viewType?this.View.onSubmit(i):this.onSubmit(e,i)},_addNotif:function(e){var t=e.msg,i=e.eventID,n=e.eventID;switch(i){case"error":t=t||e.json,this._addError(t,n);break;case"warning":this._addWarning(t,n);break;case"success":this._addSuccess(t,n);break;default:this._addInfo(t,n)}},_addInfo:function(e,t){var i=this;this._getErrorManager(function(n){var o=n.addInfo(e,t);i.dispatchEvent("onNotification",o)})},_addWarning:function(e,t){var i=this;this._getErrorManager(function(n){var o=n.addWarning(e,t);i.dispatchEvent("onNotification",o)})},_addSuccess:function(e,t){var i=this;this._getErrorManager(function(n){var o=n.addSuccess(e,t);i.dispatchEvent("onNotification",o)})},_addError:function(e,t){var i=this;this._getErrorManager(function(n){var o=n.addError(e,t);i.dispatchEvent("onNotification",o)})},_getErrorManager:function(e){var t=this;this.errorOverlay?e.call(null,this.errorOverlay):require(["DS/ErrorWidget/ErrorWidget"],function(i){t.errorOverlay||(t.errorOverlay=new i(widget,t.myDialog.elements.container,{className:"newcontent_errorManager"})),e.call(null,t.errorOverlay)})},getDefaultButtons:function(e){var t=this,i={},n=[];return"listView"===e||"tabView"===e?n=["Ok","Apply","Discard"]:"wizardView"===e&&(n=["Ok","Apply","Discard","Reset","RestoreDefaults"]),n.forEach(function(e){i[e]=t.buildButton(e)}),i},buildButton:function(e){var t,n=this._getButtonProperty(e);return n&&(t=new i(n)),t},manageButtons:function(e){if("wizardView"===this.viewType&&this.View){var t=this.View.getActiveFacet(),i=this.View.isFirstFacet(t.facet.name),n=this.View.isLastFacet(t.facet.name);this.footerButtons.Reset.visibleFlag=!i,this.footerButtons.RestoreDefaults.visibleFlag=!n,this.footerButtons.Ok.visibleFlag=n,this.footerButtons.Apply.visibleFlag=n}},evaluateValidationStatus:function(){for(var e=!0,t=0;t<this.View.facets.length;t++){var i=this.View.facets[t];if(i.content&&!i.content.facetValidation){e=!1;break}}e?this.resetButtons():(this.permanentDisable=!0,this.disableFormSubmit(!0))},_getButtonProperty:function(e){var t,i=this;switch(e){case"Apply":t={id:"create",label:c.createBtn,onClick:function(e){this.permanentDisable=!0,i.disableFormSubmit(!0),e.dsModel.label=c.creatingButton,i.onSubmitDialog("create")}};break;case"Ok":t={name:"createClose",label:c.createCloseBtn,onClick:function(e){if(!i.disableBtnClickOnEnter||i.disableBtnClickOnEnter&&i.onEnterKeyDown){if(i.disableBtnClickOnEnter&&i.onEnterKeyDown&&"wizardView"===i.viewType)return void i.footerButtons.RestoreDefaults.onClick();this.permanentDisable=!0,i.disableFormSubmit(!0),e.dsModel.label=c.creatingButton,i.onSubmitDialog("createClose")}}};break;case"Discard":t={name:"close",label:c.closeBtn,onClick:function(e){i.dispatchEvent("onClose")}};break;case"Reset":t={name:"previous",label:c.previousBtn,onClick:function(e){UWA.is(i.View.switchToRelativeFacet,"function")&&i.View.switchToRelativeFacet(-1)}};break;case"RestoreDefaults":t={name:"next",label:c.nextBtn,onClick:function(e){UWA.is(i.View.switchToRelativeFacet,"function")&&i.View.switchToRelativeFacet(1)}}}return t},disableFormSubmit:function(e){if(this.footerButtons)for(var t in this.permanentDisable&&(e=!0),this.footerButtons){var i=this.footerButtons[t];"Ok"!=i.value&&"Apply"!=i.value||(i.disabled=e)}},resetButtons:function(){if(this.footerButtons)for(var e in this.footerButtons){var t=this.footerButtons[e];if("Ok"==t.value||"Apply"==t.value){t.disabled=!1;var i=this._getButtonProperty(e);t.label=i.label}}},onSubmit:function(e,t){this.View.facets[0].content.onSubmit(e,t)},postCreation:function(e,t){var i=this;if("listView"===this.viewType)t();else{var n=e.result,o=new Set,a={};this.facetDependency?a=this.facetDependency:(this.View.facets.forEach(function(e){e.dependee&&e.dependee.length>0?(a[e.facet.name]||(a[e.facet.name]={}),a[e.facet.name].to=new Set(e.dependee),e.dependee.forEach(function(t){a[t]||(a[t]={});var i=a[t];i.from||(i.from=new Set),i.from.add(e.facet.name)})):o.add(e.facet.name)}),this.facetDependency=a),this.independentFacetList?o=this.independentFacetList:this.independentFacetList=o,function e(){var s=[];o.forEach(function(e){var t=i.View._getFacetFromName(e);if(t.content&&UWA.is(t.content.postCreation,"function")){var o=t.content.postCreation(n);o&&(o.then(function(e){i.markComplete(t.facet.name,e)}),s.push(o))}}),UWA.Promise.allSettled(s).then(function(n){var s=new Set;o.forEach(e=>{if(a[e]){var t=a[e].from;t&&t.forEach(t=>{var i=a[t].to;i&&(i.delete(e),0==i.size&&s.add(t))})}}),(o=s).size>0?e():(i.closeView(n),t(n))}).catch(function(e){console.log("ENONew : postCreation failed")})}()}},markComplete:function(e,t){console.log("markComplete:"+e),console.log(t)},closeView:function(e){console.log("closeView"),console.log(e)},destroy:function(){this.myDialog&&this.myDialog.destroy(),this.immersiveFrame&&this.immersiveFrame.destroy(),this._parent()}})}),define("DS/ENONewWidget/ajaxRequests/ENONewServices",["UWA/Class","UWA/Controls/Abstract","DS/LifecycleControls/CredentialList","DS/LifecycleServices/DefaultCredential","DS/LifecycleServices/LifecycleServicesSettings","DS/ENONewWidget/ajaxRequests/ENONewAjaxRequests","i18n!DS/ENONewWidget/assets/nls/ENONewWidgetNls"],function(e,t,i,n,o,a,s){return Services=t.extend({init:function(e,t){this._parent(e),e&&(e.tenant?this.tenant=e.tenant:this.tenant=o.getTenant(),e.serviceBaseUrl?this.service=e.serviceBaseUrl:e.service&&(this.service=o.getPlatformBaseUrl(e.service,this.tenant)),this.service||(this.service=o.getPlatformBaseUrl("3DSpace",this.tenant)),e.header&&(this.header=e.header,e.header.SecurityContext&&(this.prefSecCont=e.header.SecurityContext)),t&&(this.parsedResult=!!t.parsedResult))},getTypeInfo:function(e,t){var i=this,n={};return n.objType=e.type?e.type:"",e.preferedType&&(n.preferedType=e.preferedType),e.typeName&&(n.typeName=e.typeName),e.subTypes&&(n.subTypes=e.subTypes),e.parentOrigin&&(n.parentOrigin=e.parentOrigin),e.domainAttributes&&(n.domainAttributes=encodeURIComponent(JSON.stringify(e.domainAttributes))),e.securityContext&&(this.prefSecCont=e.securityContext),new UWA.Promise(function(e,o){i._getTypeInfo(n,function(n){n&&"success"===n.status?e(i.parseTypeInfo(n,t)):o(n)},function(e){console.log("vma rejected"),o(e)})})},_getTypeInfo:function(e,t,i){var n=this.header?this.header:{},o={service:this.service+"/resources/v1/collabServices/authoring/createContent/typeInfo",tenant:this.tenant,params:e};this.prefSecCont?(n.SecurityContext=this.prefSecCont,o.header=n,a._get(o,t,i)):this.getPreferedSecurityContext().then(function(e){this.prefSecCont=e,n.SecurityContext=this.prefSecCont,o.header=n,a._get(o,t,i)}).catch(function(e){console.log("vma security context failure"),console.log(e)})},parseTypeInfo:function(e,t){var i={};this.rawTypeInfo=e.result;var n=e.result[0];if(t)return n;var o=n.type,a=n.subTypes;if(a=UWA.is(a,"array")?a:[]){var r=[],c=[];for(var l in a){var d=a[l];r.push(d.name),c.push(d.nls)}var u=r.length>1,f={name:"Type",nls:s.Type,type:"String",value:o,range:r,rangeNLS:c,positionUI:1,positionGroup:6,visible:u,defaultAttribute:!0,sortedOptions:!0,mandatory:!0,persistData:a,dropdownMode:"click"};i.Type=f}return i.attributes=n.attributes,i.interfaces=n.interfaces,i.reInitOnSecCtxChange=1==n.reInitOnSecCtxChange,i},createContent:function(e,t,i,n){var o=this,s=this.service+"/resources/v1/collabServices/authoring/createContent/Create",r={tenant:this.tenant,service:s},c=this.header?this.header:{};for(var l in c.SecurityContext=t.securityContext,r.header=c,e){var d=e[l];this.rawTypeInfo[0][l]=d}var u={create:this.rawTypeInfo},f={typeName:"",select:[],aggregating_context:[],parsed:this.parsedResult,folderID:[],selectedIDs:[],activeFolder:!1};if(e){if(t.queryParams){for(var l in f)val=t.queryParams[l],val&&(f[l]=val);r.params=f}a._post(u,r,function(e){i(e,o.service)},n)}},getSecurityContextList:function(){var e=this,t=this.getPreferedSecurityContext(),n=i.loadCredentials(e.tenant);return new UWA.Promise(function(i){UWA.Promise.all([t,n]).then(function(t){t.length<2||!UWA.is(t[1],"array")?console.error("Missing credentials"):i(function(t){var i=this.prefSecCont;i&&""!=i||(i=t[0]),e.preferedSecCtx=i;var n=t[1],o=[],a=[];for(var r in n){var c=n[r];o.push(c.ctx),a.push(c.displayName)}var l=o.length>1;return{name:"SecurityContext",nls:s.SecurityContext,type:"String",value:i,range:o,rangeNLS:a,visible:l,positionUI:1,positionGroup:8,defaultAttribute:!0,sortedOptions:!0,mandatory:!0,dropdownMode:"click"}}(t))})})},getPreferedSecurityContext:function(){var e=this;return this.prefSecCont?new UWA.Promise(function(t){t(e.prefSecCont)}):n.loadDefaultContexCredential({tenant:this.tenant,context:this.context})},set3DPartTemplate:function(e,t,i,n){var o=this.service+"/resources/v1/collabServices/authoring/op/set3DPartTemplateExpression",s={securityContext:this.prefSecCont,tenant:this.tenant,service:o},r={data:[e]};e&&a._post(r,s,i,n)},getListofTypes:function(e,t,i){var n=this.header?this.header:{},o=this.service+"/resources/v1/collabServices/authoring/createContent/listOfTypes",s={tenant:this.tenant,service:o,params:e};e&&(this.prefSecCont?(n.SecurityContext=this.prefSecCont,s.header=n,a._get(s,t,i)):this.getPreferedSecurityContext().then(function(e){this.prefSecCont=e,n.SecurityContext=this.prefSecCont,s.header=n,a._get(s,t,i)}).catch(function(e){console.log("vma security context failure"),console.log(e)}))}}),Services}),define("DS/ENONewWidget/command/NewContentCmd",["DS/ENONewWidget/command/NewContentCommandBase","DS/ENONewWidget/ENONewLauncher","DS/ENONewWidget/command/NewContentDialog","DS/ENONewWidget/ajaxRequests/ENONewServices"],function(e,t,i,n){"use strict";return e.extend({init:function(e){this._parent(e);var o=this.ENONewContext;o?o.getNewTypeList||(this.existingImpl=!0,o.updatedListOfTypes&&UWA.is(o.updatedListOfTypes,"function")?this.updatedListOfTypes=o.updatedListOfTypes:console.log("updatedListOfTypes function is invalid"),o.getLaunchOptions&&UWA.is(o.getLaunchOptions,"function")?this.getLaunchOptions=o.getLaunchOptions:console.log("getLaunchOptions function is invalid")):console.log("ENONewContext object is empty"),this.dialog=new i,this.launcher=new t,this.services=new n({}),this.isCreateDialogOpen=!1,this.enable()},execute:function(){var e,t=this;if(!this.isCreateDialogOpen)if(this.disable(),this.existingImpl){var i=this.updatedListOfTypes();i=i||this.ENONewContext.panelContent.data;var n=this.ENONewContext.options?this.ENONewContext.options:{};(e=this.dialog.displayDialog(i,n,function(e){var i=e.dsModel;if(console.log("btn clicked : "+i.label),i){var n=i.value;n?t.launchPanel(n):console.log("Failed to get type Info")}else console.log("Failed to get view Model")}))&&(e.addEventListener("close",function(e){t.isCreateDialogOpen=!1,t.dialog.destroyDialog(),t.enable()}),t.isCreateDialogOpen=!0)}else{var o=this.getNewTypeList();this.getTypeList(o,function(i){(e=t.dialog.display(i,{},function(e){t.launchTypeCmd(e)}))&&(e.addEventListener("close",function(e){t.closeNewContentPanel()}),t.isCreateDialogOpen=!0)})}},getType(){return this._type},getNewTypeList(){var e=this.ENONewContext;if(e&&e.getNewTypeList&&UWA.is(e.getNewTypeList,"function"))return e.getNewTypeList()},getTypeList(e,t){e&&e.length>0?this.services.getListofTypes({newTypes:e},function(e){console.log("vma12:Success:getTypeList"),t(e.result)},function(){console.log("vma12:Fail:getTypeList")}):t()},launchTypeCmd(e){this._type=e.type,this.typeDetails=e;var t=this.getCreateOptions(e);this.launchCreateNew(t)},addObjectInLifecycleWidget(e){var t;e&&(t=[],e.forEach(function(e){var i={objectId:e.identifier,displayName:e.V_name,objectType:e.type};t.push(i)}),this.options.context.addNewObject1({data:{items:t}}))},getOptions(e){var t=this;return{context:{},type:e.type,options:{typeName:e.newType},events:{onSuccess:function(e){t.addObjectInLifecycleWidget(e.result)},onFailure:function(e){},onCancel:function(e){}}}},closeNewContentPanel(){this.isCreateDialogOpen=!1,this.dialog&&this.dialog.destroyDialog(),this.enable()},launchPanel:function(e){var t=this.getLaunchOptions(e);this.launcher.CreateNew(t),this.isCreateDialogOpen=!1,this.dialog.destroyDialog(),this.enable()}})});