define("DS/WAfrUIModelManagers/ContextualUIComponentManager",["UWA/Core","UWA/Class","DS/Selection/CSOManager","DS/WAfrControls/WAfrContextualBar","DS/CoreEvents/Events","DS/Core/PointerEvents","DS/WAfrControls/WAfrContextualMenu","DS/WAfrHandlers/mod_HandlerComponent"],function(e,t,n,i,o,r,a,s){"use strict";return t.extend({init:function(){this._parent()}}).extend({defaultOptions:{onContextualBarReady:function(e){return null},onContextualMenuReady:function(e){return null},subscribersId:void 0},setContext:function(e){var t=this;void 0!==e.executionContext&&(t._executionContext=e.executionContext),void 0!==e.UIComponent&&(t._uiComponent=e.UIComponent),void 0!==e.UIFrame&&(t._uiFrame=e.UIFrame,t._container=t._uiFrame.getContainer(),void 0!==t._container&&(t._unbindBehaviors(),t._bindBehaviors())),void 0!==e.Viewer&&(t._viewer=e.Viewer)},init:function(t){var i=this;i.options=e.extend(e.clone(this.defaultOptions),t),i._parent(),i._contextBar=null,i._isInViewpointManipulation=!1,i._listOfSubscribers=[],i._ContextualBarAvailable=!0,i._ContextualBarOnLeftClic=!0,i._ContextualMenuOnRightClic=!0,n.onEmpty(function(){i.hideContextualMenus()})},register:function(t){(t=e.extend(e.clone(this.defaultOptions),t)).merge?this._listOfSubscribers.push(t):(this._listOfSubscribers=[],this._listOfSubscribers.push(t))},registerUnshift:function(t){(t=e.extend(e.clone(this.defaultOptions),t)).merge?this._listOfSubscribers.unshift(t):(this._listOfSubscribers=[],this._listOfSubscribers.unshift(t))},unregister:function(e){if(e)for(var t=0;t<this._listOfSubscribers.length;t++)if(this._listOfSubscribers[t].subscriberId===e){this._listOfSubscribers.splice(t,1);break}},dispose:function(){o.unsubscribe(this._visuEventToken),o.unsubscribe(this._ctxbarHiddenEventToken)},hideContextualMenus:function(){document.body.removeEventListener("mouseup",this._hideListener),i.hide()},hideContextualMenu:function(){},buildDefaultHandlerContextMenuItem:function(e){var t=this._executionContext.getComponent(s.DEFAULT_COMPONENT_NAME);return a._createHandlerModel(e,t)},buildCheckHandlerContextMenuItem:function(e){var t=this._executionContext.getComponent(s.DEFAULT_COMPONENT_NAME);return a._createCheckHandlerModel(e,t)},deactivateContextualBarOnLeftClic:function(){this._ContextualBarOnLeftClic=!1},activateContextualBarOnLeftClic:function(){this._ContextualBarOnLeftClic=!0},deactivateContextualBar:function(){this._ContextualBarAvailable=!1},activateContextualBar:function(){this._ContextualBarAvailable=!0},deactivateContextualMenuOnRightClic:function(){this._ContextualMenuOnRightClic=!1},activateContextualMenuOnRightClic:function(){this._ContextualMenuOnRightClic=!0},getContextualBar:function(){return i},_onBarDisplayed:null,_onMenuDisplayed:null,_showContextualBar:function(e){void 0===e&&(e={});var t=this;if(e.freeZone=t._uiFrame.getImmersiveFrame().getFreeZone(),document.body.removeEventListener("mouseup",this._hideListener),document.body.addEventListener("mouseup",this._hideListener),t._contextBar?t._contextBar.hide():t.getContextualBar()&&void 0!==t.getContextualBar()&&t.getContextualBar().hide(),t._listOfSubscribers.length){e.executionContext=t._executionContext,e.viewer=void 0;let n=t._executionContext.getApplicationComponent("Viewer");n&&(e.viewer=n.get3DViewer()),e.uiFrame=t._uiFrame.getUIFrame(),e.uiComponent=t._uiComponent,!0===t._isTouch?(e.Xposition=void 0===e.x?t._initMousePos.x:e.x,e.Yposition=void 0===e.y?t._initMousePos.y:e.y):(e.Xposition=void 0===e.x?t._mousePos.x:e.x,e.Yposition=void 0===e.y?t._mousePos.y:e.y),e.subscribersOptions=void 0===e.fillingList||0===e.fillingList.length?t._listOfSubscribers:e.fillingList,e.hideWithDistance=void 0===e.hideWithDistance||e.hideWithDistance,null!==t._onBarDisplayed&&(e.eventCallback=t._onBarDisplayed.bind(t)),e.Xoffset=void 0===e.Xoffset?45:e.Xoffset,e.Yoffset=void 0===e.Yoffset?-45:e.Yoffset,t._ContextualBarAvailable&&i.show(e)}},_showContextMenu:function(e){void 0===e&&(e={});var t=this;e.freeZone=t._uiFrame.getImmersiveFrame().getFreeZone(),document.body.removeEventListener("mouseup",this._hideListener),document.body.addEventListener("mouseup",this._hideListener);let n=void 0;if(t._listOfSubscribers.length){e.executionContext=t._executionContext,e.viewer=void 0;let i=t._executionContext.getApplicationComponent("Viewer");i&&(e.viewer=i.get3DViewer()),e.uiFrame=t._uiFrame.getUIFrame(),e.uiComponent=t._uiComponent,!0===t._isTouch?(e.Xposition=void 0===e.x?t._initMousePos.x:e.x,e.Yposition=void 0===e.y?t._initMousePos.y:e.y):(e.Xposition=void 0===e.x?t._mousePos.x:e.x,e.Yposition=void 0===e.y?t._mousePos.y:e.y),e.subscribersOptions=void 0===e.fillingList||0===e.fillingList.length?t._listOfSubscribers:e.fillingList,e.Xoffset=void 0===e.Xoffset?45:e.Xoffset,e.Yoffset=void 0===e.Yoffset?-45:e.Yoffset,n=a.show(e)}return n},_onRightClick:function(e){document.body.removeEventListener("mouseup",this._hideListener),document.body.addEventListener("mouseup",this._hideListener);var t=this;e.preventDefault();let n=t._uiFrame.getContainer().getBoundingClientRect();if(t._finalMousePos={x:e.clientX-n.left,y:e.clientY-n.top},!t._isInViewpointManipulation&&t._initMouseOffset.x===t._finalMousePos.x&&t._initMouseOffset.y===t._finalMousePos.y&&t._initMousePos.x===t._finalMousePos.x&&t._initMousePos.y===t._finalMousePos.y&&!1!==t._ContextualMenuOnRightClic){var i={hideWithDistance:!1,x:t._mousePos.x,y:t._mousePos.y,Xoffset:0,Yoffset:-5,withContextMenu:!0};t._isTouch&&(i.x=t._finalMousePos.x,i.y=t._finalMousePos.y);let e=t._showContextMenu(i);if(void 0!==e&&(i.rectCtxMenuInfo=e.ctxMenuDimPos),t._showContextualBar(i),!0===t.getContextualBar()._isShown&&void 0!==e){t.getContextualBar().getContent().getBoundingClientRect().x<i.x&&i.x>=i.rectCtxMenuInfo.x&&(i.x=i.x+i.Xoffset-i.rectCtxMenuInfo.width,a._display(e.menuContent,i))}}},_convertToMenuOptions:function(e){var t=this._executionContext.getComponent(s.DEFAULT_COMPONENT_NAME);return a._convertToMenuOptions(e,t)},_bindBehaviors:function(){var t=this;t._mousePos={x:0,y:0};let n=t._uiFrame.getContainer().getBoundingClientRect();this._uiFrame.getContainer().addEvent("mousemove",function(e){t._mousePos={x:e.clientX-n.left,y:e.clientY-n.top}}),this._hideListener=function(t){e.Event.findElement(t,".wux-afr-contextual-bar")},t._uiFrame.getContainer().addEvent(r.POINTERDOWN,t._onPointerDown.bind(t)),t._uiFrame.getContainer().addEvent("mousedown",t._onMouseDown.bind(t)),t._uiFrame.getContainer().addEvent(r.POINTERUP,t._onMouseUp.bind(t)),t._uiFrame.getContainer().addEvent("contextmenu",t._onRightClick.bind(t));var i=0,a=function(e){i=0},s=!1;t._visuEventToken=o.subscribe({event:"/VISU/"},function(e){var n={};"@onViewpointChange"===e.eventType?(0===i&&(!0===t.getContextualBar()._isShown&&(s=!0),t.hideContextualMenus(),t._uiFrame.getContainer().removeEvent("mouseup",a),t._uiFrame.getContainer().addEvent("mouseup",a)),i++):"@onViewpointBeginMove"===e.eventType?(i=0,t._isInViewpointManipulation=!0,s=!1):"@onViewpointEndMove"===e.eventType?(t._isInViewpointManipulation=!1,!0===s&&(t.hideContextualMenus(),n.hideWithDistance=!0,t._showContextualBar(n))):"@onClickEvent"===e.eventType&&!0===t._ContextualBarOnLeftClic&&("@pickNothing"!==e.eventID&&"@pickPrimitive"!==e.eventID&&"@pickRep"!==e.eventID&&"@pickMesh"!==e.eventID||(t.hideContextualMenus(),(n={x:e.event.currentPosition.x,y:e.event.currentPosition.y}).hideWithDistance="Touch"!==e.event.type,t._showContextualBar(n)))}),this._ctxbarHiddenEventToken=o.subscribe({event:"WUX/AFR/ctxBarHidden"},function(e){t.hideContextualMenu()})},_unbindBehaviors:function(){var e=this;e._uiFrame.getContainer().removeEvent(r.POINTERDOWN,e._onPointerDown.bind(e)),e._uiFrame.getContainer().removeEvent("mousedown",e._onMouseDown.bind(e)),e._uiFrame.getContainer().removeEvent(r.POINTERUP,e._onMouseUp.bind(e)),e._uiFrame.getContainer().removeEvent("contextmenu",e._onRightClick.bind(e)),o.unsubscribe(this._ctxbarHiddenEventToken)},_onMouseUp:function(e){1===e.button&&(this._isInViewpointManipulation=!1)},_onMouseDown:function(e){let t=this._uiFrame.getContainer().getBoundingClientRect();this._initMousePos={x:e.clientX-t.left,y:e.clientY-t.top},this._initMouseOffset={x:e.offsetX,y:e.offsetY},1===e.button&&(this._isInViewpointManipulation=!0)},_onPointerDown:function(e){let t=this._uiFrame.getContainer().getBoundingClientRect();this._initMousePos={x:e.clientX-t.left,y:e.clientY-t.top},this._initMouseOffset={x:e.offsetX,y:e.offsetY},this._isTouch=r.isTouchEvent(e)}})}),define("DS/WAfrUIModelManagers/mod_ActionBarResponsiveManager",[],function(){"use strict";let e=Object.create(null);return e.ActionBarResponsiveManager=class{constructor(e,t){this._private=Object.create(null),this._private._actionBar=e,this._private._smallViewportActionBar=t,this._private._state=null,this.configureMediaQueries()}getSmallViewportActionBar(){return this._private._smallViewportActionBar}getActionBar(){return this._private._actionBar}configureMediaQueries(){this._private._mediaQueryXS=window.matchMedia("screen and (max-width: 240px), screen and (max-height: 240px)"),this._private._boundOnMediaQueryXS=function(){this.compute()}.bind(this),this._private._mediaQueryXS.addListener(this._private._boundOnMediaQueryXS),this._private._mediaQuerySVAB=window.matchMedia("screen and (min-width: 241px) and (max-width: 580px), screen and (min-height:241px) and (max-height: 280px)"),this._private._boundOnMediaQuerySVAB=function(){this.compute()}.bind(this),this._private._mediaQuerySVAB.addListener(this._private._boundOnMediaQuerySVAB)}compute(){let e=null;return e=this._private._mediaQueryXS.matches?this.setState(null):this._private._smallViewportActionBar&&this._private._mediaQuerySVAB.matches?this.setState("SVAB"):this.setState("SAB")}setState(e){let t=Promise.resolve();return null===e?(this._private._actionBar.hide(),this._private._smallViewportActionBar&&this._private._smallViewportActionBar.hide()):"SAB"===e?(this._private._smallViewportActionBar&&this._private._smallViewportActionBar.hide(),t=this._private._actionBar.show()):"SVAB"===e&&(this._private._actionBar.hide(),this._private._smallViewportActionBar&&(t=this._private._smallViewportActionBar.show())),t}clean(){this._private._mediaQueryXS.removeListener(this._private._boundOnMediaQueryXS),this._private._mediaQuerySVAB.removeListener(this._private._boundOnMediaQuerySVAB)}},e}),define("DS/WAfrUIModelManagers/MainUIComponentManager",["css!DS/WAfrUI/wafr.css","UWA/Core","UWA/Class","DS/Windows/Panel","DS/Menu/ContextualMenu","DS/WAfrModelEvents/mod_ModelEvents","DS/Utilities/TouchUtils","DS/WAfrUIStandardComponents/mod_TreeModel","DS/WAfrTweakers/TweakerHandlerGenerateMethods","DS/WAfrUIComponents/mod_SmallViewportActionBar","DS/WAfrUIModelManagers/mod_ActionBarResponsiveManager","DS/WAfrDebug/mod_Performances","i18n!DS/WAfrUIModelManagers/assets/nls/ActionBarContextMenu"],function(e,t,n,i,o,r,a,s,l,u,d,c,h){"use strict";const _=!("false"===localStorage.getItem("ACTION_BAR_OPTIMIZED_WINDOW_GROUP_CREATION")),p=u.SmallViewportActionBar,f=d.ActionBarResponsiveManager,m=c.Performances,v="[DS/WAfrUIModelManagers/MainUIComponentManager]",g=new m;var C=r.DEFAULT_COMPONENT_NAME;if(!C||0===C.length)throw new Error("mod_ModelEvents.DEFAULT_COMPONENT_NAME has to be defined");const w=46,M=74,b=52,x=70,A=96,B=88,E=112;function y(e){const t=e._showLabelFlag,n=e._touchMode,i=e._panels;if(i&&i.length>0){let e=w;if(t?e=M:n&&(e=b),i[0].minWidth!==e)for(const t of i)t.minWidth=e}}function S(e,t){let n=x;return e&&t?n=E:e?n=B:t&&(n=A),n}function W(e){return e.getData().view=document.createDocumentFragment(),Promise.resolve()}function D(e){let t=e.getData(),n=document.createElement("div");return n.classList.add("wafr-toolbar-section-group"),t.view=n,Promise.resolve()}function I(e,t,n,i){let o=e.getData(),r=g.start([v,"[Async] generateTweaker",e.getId()].join(" ")),a=[],s=e.getForwardIterator();for(;s.isValid();){let e=s.get().getData();a.push(e.handler),s.next()}let l=t.handlerSet({value:{items:a},typePath:o.type,touchMode:i,modelEventsCpt:n});return this._tweakersView.push(l),o.view=l.getContent(),g.stop(r),Promise.resolve()}function F(e,t,n,i){let o=null,r=e.getData();if(r.handler){let e=r.handler,a=g.start([v,"[Async] generateTweaker",e.getId()].join(" ")),s=t[r.type]({value:e,typePath:r.type,touchMode:i,modelEventsCpt:n});this._tweakersView.push(s);let l=s.getContent();r.view=l,g.stop(a),o=Promise.resolve()}else console.error(r.label,"is not a handler"),o=Promise.resolve(new Error(r.label+" is not a handler"));return o}function P(e){return Object.assign({},e)}function O(){if(!this)throw new Error("panel must be defined");var e=g.start([v,"[Sync] computeCompactWidth",this.identifier].join(" "));if(this._afr._isContentInitialized){var t=this.content.parentNode.getBoundingClientRect().height;if(t<0)throw g.stop(e),new Error("panelHeight must not be a negative number");if(0!==t){var n=this.content.getElementsByClassName("wafr-toolbar-section-group"),i=0;if(n.length>0){var o=window.getComputedStyle(n[0],null);t-=parseInt(o.paddingTop,10),t-=parseInt(o.paddingBottom,10),i=parseInt(o.paddingLeft,10)+parseInt(o.paddingRight,10)}for(var r=null,a=null,s=0,l=0,u=0,d=n.length,c=null,h=null;u<d;++u){if(!(h=(c=n[u]).getElementsByClassName("wafr-tweakers")))throw g.stop(e),new Error("Empty group");if(null===r){var _=window.getComputedStyle(h[0],null),p=parseInt(_.paddingTop,10)+parseInt(_.paddingBottom,10);r=h[0].getBoundingClientRect().height+p}var f=Math.floor(t/r);0===f&&(f=1);for(var m=Math.ceil(h.length/f),C=0,w=1,M=0,b=0;C<m;++C){for(var x=h[M].getBoundingClientRect().width;w<=f&&M<h.length;)(a=h[M].getBoundingClientRect().width)>x&&(x=a),++M,++w;w=1,b+=x}s=b+(u>0?1:0),c.style.width=Math.ceil(s+i)+"px",l+=Math.ceil(s+i)}this.content.style.width=l+"px",this.fire("dimensionsChanged"),g.stop(e)}else g.stop(e)}else g.stop(e)}function k(e){for(var t=g.start([v,"[Sync] computeAndResizeForAllPanels"].join(" ")),n=0,i=e.length,o=null;n<i;++n)!1!==(o=e[n])._afr._isContentInitialized&&(o.content.classList.contains("column")?(-1!==o.height&&(o.height=-1),o.windowGroup&&-1!==o.windowGroup.height&&(o.windowGroup.height=-1)):(-1!==o.width&&(o.width=-1),o.windowGroup&&-1!==o.windowGroup.width&&(o.windowGroup.width=-1)),o.currentDockArea!==WUXDockAreaEnum.TopDockArea&&o.currentDockArea!==WUXDockAreaEnum.BottomDockArea||o._afr._bound_computeCompactWidth());g.stop(t)}function U(){var e=g.start([v,"[Sync] onPrePlaceChangeCB"].join(" ")),t=this.panel;if(!t)throw g.stop(e),new Error("panel must be defined");t.currentDockArea===WUXDockAreaEnum.TopDockArea||t.currentDockArea===WUXDockAreaEnum.BottomDockArea?(t.content.classList.remove("column"),t.resizableFlag="vertical",t.minHeight>0&&(t.height=t.minHeight),t.removeEventListener("resize",t._afr._bound_computeCompactWidth),t.addEventListener("resize",t._afr._bound_computeCompactWidth),t.removeEventListener("activate",t._afr._bound_computeCompactWidth),t.addEventListener("activate",t._afr._bound_computeCompactWidth)):(t.removeEventListener("resize",t._afr._bound_computeCompactWidth),t.removeEventListener("activate",t._afr._bound_computeCompactWidth),function(e){e.content.style.height="",e.content.style.width="auto";for(var t=e.content.getElementsByClassName("wafr-toolbar-section-group"),n=0,i=t.length;n<i;++n)t[n].style.width="auto"}(t),t.content.classList.add("column"),t.resizableFlag="horizontal"),k(this.mainUIComponentManager._panels),g.stop(e)}return n.extend({defaultOptions:{availability:!0,visibleFlag:!0},init:function(e){this.options=t.extend(t.clone(this.defaultOptions),e),this._parent(),this._panels=[],this._tweakersView=[],this._touchMode=a.getTouchMode(),this._defaultTabOrder=[],this._isViewGenerated=!1,this._showLabelFlag=!1,this._originalTouchValue=this._touchMode,this._handleTouchChange(),this._manageBrowserZoom()},createView:function(e,t,n,o,r,a){var l=this;let u=[],d=function(e,t,n){let i=new(0,s.TreeModel)({identifier:"root"});for(let t=0,o=e.length;t<o;++t){let o=P(e[t].options.grid);if(o.hasOwnProperty("category")&&void 0!==o.category){let e=o.category;Array.isArray(o.category)&&(e=o.category[0]);let t=null,r=i.getChild(e);if(!r){let t=e;n&&n[e]&&n[e].internationalization&&n[e].internationalization.title&&(t=n[e].internationalization.title),r=i.addChild({identifier:e,title:t,type:"section"})}if(t=r,o.group||(o.group=`${e}_defaultGroup`),o.hasOwnProperty("group")&&void 0!==o.group){let e=t.getChild(o.group);e||(e=t.addChild({identifier:o.group,type:"group"})),t=e}if(o.hasOwnProperty("set")&&void 0!==o.set){let e=t.getChild(o.set);e||(e=t.addChild({identifier:o.set,type:"set"})),t=e}t.addChild(o)}else console.error("Item must at least have a category property",o)}return t&&i.reorder(t),i}(e,t,n);{let e={section:W,group:D,set:I,item:F},t=[],n=[];{let e=d.getForwardIterator();for(;e.isValid();)"WAfrFront"!==e.get().getId()&&t.push(e.get()),e.next()}let s=[...t];for(;s.length>0;){let t=s.pop(),i=t.getData().type;if("section"!==i&&"group"!==i&&"set"!==i&&(i="item"),n.push(e[i].call(this,t,o,r,a)),"set"===i)continue;let l=t.getBackwardIterator();for(;l.isValid();)s.push(l.get()),l.next()}u.push(Promise.all(n).then(function(){for(s=[...t];s.length>0;){let e=s.pop(),t=e.getData().type;if("section"!==t&&"group"!==t&&"set"!==t&&(t="item"),"set"===t)continue;let n=e.getForwardIterator(),i=e.getData().view;for(;n.isValid();){let e=n.get(),t=e.getData();s.push(e),t.view&&i.appendChild(t.view),n.next()}}}).then(function(){s=[...t];let e=null,n=l._uiFrame.getUIFrame(),o=l._uiFrame.getImmersiveFrame();o.remove();for(let t=0,n=s.length;t<n;++t){let n=s[t].getData(),r=n.title,u=document.createElement("div");u.classList.add("wafr-toolbar-section"),u.setAttribute("wafr-po-use-only-section-title",n.title),u.appendChild(n.view);let d="WAfrUIModelMainComponent"+n.identifier,c=new i({title:r,identifier:d,content:u,immersiveFrame:_?null:o,resizableFlag:!0,movableFlag:!0,currentDockArea:WUXDockAreaEnum.BottomDockArea,closeButtonFlag:!1,usePaddingFlag:!1,minHeight:a?50:48,minWidth:a?b:w,onContextualEvent:function(e){return l.getCtxMenu({that:l,panel:this,params:e})}});c._afr=Object.create(null),c._afr._bound_computeCompactWidth=O.bind(c),c._afr._bound_onPrePlaceChangeCB=U.bind({panel:c,mainUIComponentManager:l}),c.addEventListener("prePlaceChange",c._afr._bound_onPrePlaceChangeCB),c._afr._isContentInitialized=!0,_||c._afr._bound_onPrePlaceChangeCB(),n.view=c,l._panels.push(c),e?c.attachToWindow(e,WUXSnapAreaEnum.InsideArea):e=c}if(_)for(const e of l._panels)e.immersiveFrame=o,e._afr._bound_onPrePlaceChangeCB();if(e){let t,n=e.windowGroup;if(n){if((t=n.getEmbeddedWindows())&&t.length&&t.length>1){let i=[t[0]];("WAfrUIModelMainComponentWAfrStandard"===e.identifier||"WAfrUIModelMainComponentFixed Area"===e.identifier&&t.length>2)&&(i.push(t[1]),sessionStorage.getItem("WAfrABV3FirstLaunch")||(sessionStorage.setItem("WAfrABV3FirstLaunch","true"),"WAfrUIModelMainComponentWAfrStandard"===e.identifier?l.pinSection("WAfrStandard"):"WAfrUIModelMainComponentFixed Area"===e.identifier&&l.pinSection("Fixed Area"))),n.currentWindows=i}n._tab.tabBar.addEventListener("pinStateChange",e=>{l._panels[e.dsModel.value].pinnedFlag||(l._panels[e.dsModel.value]._afr._pinnedByCode=void 0)})}}let r=o.getDockingElement(WUXDockAreaEnum.BottomDockArea);void 0!==r&&(r.minSize=S(l._touchMode,l._showLabelFlag),r.dockingZoneSize=r.minSize,r.elements.dockingWithCollapserContainer.classList.add("WAfrPageObjectUseOnly-WAfr-Actionbar")),o.inject(n),k(l._panels),l._isViewGenerated=!0}))}return Promise.all(u)},generate:function(e){var t=g.start([v,"[Sync] generate"].join(" ")),n=this;if(void 0===n||void 0===n._uiComponent||void 0===n._uiComponent._properties||void 0===n._uiComponent._properties.flatModel)return void g.stop(t);var i=n._uiComponent._properties;n._touchMode=e.touchMode;var o=i.flatModel.getChildren();if(void 0===o||void 0===o.length||0===o.length)return void g.stop(t);let r=this._uiComponent.getExecutionContext();if(!r)throw new Error("executionContext not found");let a=r.getComponent(C);if(!a)throw new Error("modelEventsCpt not found");let s=null;if(this._uiComponent._isMABAvailable){let t=new p(n._uiFrame.getContainer(),l);s={hide:function(){t.isGenerated()&&t.hide()},show:function(){let i=Promise.resolve();return t.isGenerated()||(i=t.generate(o,n._defaultTabOrder,n._uiComponent.getCategories(),l,a,e.touchMode)),i.then(function(){t.show()})},destroy:function(){t.destroy()}}}let u={hide:function(){n.isGenerated()&&n.hide()},show:function(){let t=Promise.resolve();return n.isGenerated()||(t=n.createView(o,n._defaultTabOrder,n._uiComponent.getCategories(),l,a,e.touchMode)),t.then(function(){return n.show()})}};return this._actionBarResponsiveManager=new f(u,s),this._actionBarResponsiveManager.compute().then(()=>(g.stop(t),Promise.resolve()))},setContext:function(e){void 0!==e.executionContext&&(this._executionContext=e.executionContext),void 0!==e.UIComponent&&(this._uiComponent=e.UIComponent),void 0!==e.UIFrame&&(this._uiFrame=e.UIFrame)},getCtxMenu:function(e){var t=e.that,n=[];return n.push({type:"PushItem",title:h.get(!0===t._showLabelFlag?"iconLabelHide.title":"iconLabel.title"),icon:"",action:{callback:function(e){t.toggleButtonLabel()}}},{type:"PushItem",title:h.get("resetActionBar.title"),icon:"",action:{callback:function(e){t.resetPositionMainComponent()}}}),n},resetPositionMainComponent:function(){var e,t,n,i;this._panels.forEach(function(i){i.deleteWindowPreferences(),void 0===e?(n=(e=i).windowGroup,i.currentDockArea=WUXDockAreaEnum.BottomDockArea):(i.windowGroup=null,i.attachToWindow(t,WUXSnapAreaEnum.InsideArea,"after")),t=i}),i=[this._panels[0]],("WAfrUIModelMainComponentWAfrStandard"===e.identifier||"WAfrUIModelMainComponentFixed Area"===e.identifier&&this._panels.length>2)&&i.push(this._panels[1]),n.currentWindows=i},toggleButtonLabel:function(e){var t=this;if(t._showLabelFlag=!0!==t._showLabelFlag,t._tweakersView.forEach(function(e){void 0!==e&&(e.showLabelFlag=t._showLabelFlag)}),!t._panels[0].immersiveFrame)throw new Error("no immersive frame related to this panel",t._panels[0]);y(t);var n=t._panels[0].immersiveFrame.getDockingElement(WUXDockAreaEnum.BottomDockArea);if(!n)throw new Error("no bottom dock area in this immersive frame",t._panels[0].immersiveFrame);n.minSize=S(t._touchMode,t._showLabelFlag),n.dockingZoneSize=n.minSize,t._panels.forEach(function(e){e.fire("dimensionsChanged"),e.currentDockArea!==WUXDockAreaEnum.TopDockArea&&e.currentDockArea!==WUXDockAreaEnum.BottomDockArea||e._afr._bound_computeCompactWidth()})},clean:function(){var e,t=this,n=t._uiFrame;if(n&&(e=n.getImmersiveFrame()),t._tweakersView=[],e&&t._panels)for(var i;0!==t._panels.length||void 0!==t._panels[0];){i=t._panels[0],t._panels.splice(0,1),i.removeEventListener("resize",i._afr._bound_computeCompactWidth),i.removeEventListener("activate",i._afr._bound_computeCompactWidth),i.removeEventListener("prePlaceChange",i._afr._bound_onPrePlaceChangeCB),delete i._afr._bound_computeCompactWidth,delete i._afr._bound_onPrePlaceChangeCB,delete i._afr._isContentInitialized,delete i._afr._pinnedByCode;var o=null;for(o in i._afr)i._afr.hasOwnProperty(o)&&console.error(o," must be cleaned");i&&(e.removeWindow(i),i.destroy())}if(this._actionBarResponsiveManager){let e=this._actionBarResponsiveManager.getSmallViewportActionBar();e&&e.destroy(),this._actionBarResponsiveManager.clean(),delete this._actionBarResponsiveManager}this._isViewGenerated=!1,delete this._isHidden,sessionStorage.removeItem("WAfrABV3FirstLaunch")},hide:function(){if(!this._isHidden){this._isHidden=!0;var e=this;e._activatedSections=[],void 0!==e&&void 0!==e._panels&&(e._activatedSections=e.getActiveSections(),e._panels.forEach(function(e){e.visibleFlag&&(e.visibleFlag=!1)}))}},isGenerated:function(){return this._isViewGenerated},show:function(){let e=null;if(void 0===this._isHidden||this._isHidden){this._isHidden=!1;var t=this;if(t._uiComponent._isMABAvailable&&t._mabOnScreen)return;if(void 0!==t&&void 0!==t._panels&&void 0!==t._uiComponent._properties&&void 0!==t._uiComponent._properties.flatModel)if(0===t._panels.length){var n=t._uiComponent._properties.flatModel.getChildren();void 0!==n&&0!==n.length&&(e=t.generate({touchMode:t._touchMode}))}else t._panels.forEach(function(e){e.visibleFlag||(e.visibleFlag=!0)});t._activatedSections&&t.activateSections(t._activatedSections)}return e||Promise.resolve()},activateSection:function(e){var t=this;void 0!==t&&void 0!==t._panels&&void 0!==t._uiComponent._properties&&void 0!==t._uiComponent._properties.flatModel&&0!==t._panels.length&&t._panels.forEach(function(t){var n="WAfrUIModelMainComponent"+e;t.identifier===n&&(t.ensureVisible(),t.currentDockArea===WUXDockAreaEnum.BottomDockArea&&t._afr._bound_computeCompactWidth())})},activateSections:function(e){var t=this;if(void 0!==t&&void 0!==t._panels&&void 0!==t._uiComponent._properties&&void 0!==t._uiComponent._properties.flatModel&&0!==t._panels.length){var n=[];e.forEach(function(e){var i="WAfrUIModelMainComponent"+e;t._panels.forEach(function(e){e.identifier===i&&(e.expandedFlag=!0,e.visibleFlag=!0,e.windowGroup&&(e.windowGroup.ensureVisible(),n.push(e),e.windowGroup.currentWindows=n),e.currentDockArea===WUXDockAreaEnum.BottomDockArea&&e._afr._bound_computeCompactWidth())})})}},getActiveSections:function(){var e=this,t=[];return void 0!==e&&void 0!==e._panels&&void 0!==e._uiComponent&&void 0!==e._uiComponent._properties&&void 0!==e._uiComponent._properties.flatModel&&0!==e._panels.length&&e._panels.forEach(function(e){e.windowGroup&&-1!==e.windowGroup.currentWindows.indexOf(e)&&t.push(e.identifier.replace("WAfrUIModelMainComponent",""))}),t},pinSection:function(e){var t=this;if(void 0!==t&&void 0!==t._panels&&void 0!==t._uiComponent._properties&&void 0!==t._uiComponent._properties.flatModel&&0!==t._panels.length){var n="WAfrUIModelMainComponent"+e;for(const e of t._panels)if(e.identifier===n)return e._afr._pinnedByCode=!0,e.pinnedFlag=!0,!0}return!1},unpinSection:function(e){var t=this;if(void 0!==t&&void 0!==t._panels&&void 0!==t._uiComponent._properties&&void 0!==t._uiComponent._properties.flatModel&&0!==t._panels.length){var n="WAfrUIModelMainComponent"+e;for(const e of t._panels)if(e.identifier===n)return e._afr._pinnedByCode=!1,e.pinnedFlag=!1,!0}return!1},isSectionPinnedByUser:function(e){var t=this;if(void 0!==t&&void 0!==t._panels&&void 0!==t._uiComponent._properties&&void 0!==t._uiComponent._properties.flatModel&&0!==t._panels.length){var n="WAfrUIModelMainComponent"+e;for(const e of t._panels)if(e.identifier===n&&e.pinnedFlag&&void 0===e._afr._pinnedByCode)return!0}return!1},setTouchMode:function(e){e!==this._touchMode&&this.toggleButtonLabel()},setActivatedCategory:function(e){this._defaultActivatedCategory=e},setCategoriesOrder:function(e){void 0!==e&&void 0!==e.length&&(this._defaultTabOrder=e)},_setActiveCategory:function(e){if(void 0!==e&&void 0!==e.windowGroup&&void 0!==e.windowGroup.getEmbeddedWindows&&void 0!==e.windowGroup.getEmbeddedWindows()&&e.activeCategoryId){var t=e.windowGroup.getEmbeddedWindows(),n=0;for(n=0;n<t.length;n++){var i=t[n].identifier;if(0===i.search("WAfrUIModelMainComponent")&&i.slice(24)===e.activeCategoryId){e.windowGroup.currentWindows=[t[n]];break}}}},_reorderCategories:function(e){var t=e.orderPreferences,n=e.tabPanels;if(void 0!==e&&void 0!==n&&void 0!==t&&void 0!==t.length){var i=0,o=0,r=-1;for(i=0;i<t.length;i++){var a=t[i];for(o=0;o<n.length;o++){var s=n[o].identifier;if(0===s.search("WAfrUIModelMainComponent")&&s.slice(24)===a){if(r>o){var l=n.splice(o,1);n.splice(r,0,l[0])}else r=o;break}}}}},_handleTouchChange:function(){var e=this;document.addEventListener("touchChange",function(){if(e._touchMode=!e._touchMode,e._panels&&e._panels.length>0){if(!e._panels[0].immersiveFrame)throw new Error("no immersive frame related to this panel",e._panels[0]);y(e);var t=e._panels[0].immersiveFrame.getDockingElement(WUXDockAreaEnum.BottomDockArea);if(!t)throw new Error("no bottom dock area in this immersive frame",e._panels[0].immersiveFrame);t.minSize=S(e._touchMode,e._showLabelFlag),t.dockingZoneSize=t.minSize,k(e._panels)}})},_manageBrowserZoom:function(){var e=this;let t=window.devicePixelRatio||window.screen.availWidth/document.documentElement.clientWidth;window.addEventListener("resize",function(){var n=window.devicePixelRatio||window.screen.availWidth/document.documentElement.clientWidth;n!=t&&(t=n,k(e._panels))})}})});