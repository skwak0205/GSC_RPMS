/*!  COPYRIGHT DASSAULT SYSTEMES 2015   */
define("DS/WebRunloop/Runloop",["UWA/Class"],function(t){"use strict";return t.extend({init:function(t){this.name=t.name||"Runloop",this.running=!1,this.data=t.data,this.setRunloopCB(t.func),this.onStart=t.onStart,this.onStop=t.onStop,this.onError=t.onError,t.autoStart&&this.start()},setRunloopCB:function(t){if(t){this.func=t;var n=this,i=(new Date).getTime();this.data?this.runloop=function(){n.running&&(n.id=requestAnimationFrame(n.runloop));var t=(new Date).getTime();n.func.apply(n.data,[{time:t-n.starttime,deltaTime:t-i}]),i=t}:this.runloop=function(){n.running&&(n.id=requestAnimationFrame(n.runloop));var t=(new Date).getTime();n.func({time:t-n.starttime,deltaTime:t-i}),i=t}}},start:function(){this.runloop?(this.running=!0,this.id=requestAnimationFrame(this.runloop),this.starttime=(new Date).getTime(),this.onStart&&this.onStart()):(console.error("runloop have not loop function"),this.onError&&this.onError())},stop:function(){this.running=!1,cancelAnimationFrame(this.id),this.onStop&&this.onStop()},dispose:function(){!0===this.running&&this.stop(),this.func=null,this.data=null,this.runloop=null}})});