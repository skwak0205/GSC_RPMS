define("DS/TopBarProxy/Debuggable",["UWA/Core","UWA/Class/Debug"],function(t,e){"use strict";return e.extend({log:function(e){var n=t.is(this.uwaClassName,"string")?this.uwaClassName:"[UNKNOWN]";return this._parent(t.String.format(n+": "+e,[].slice.call(arguments,1)))}})}),define("DS/TopBarProxy/MenuItem",["UWA/Core","UWA/Utils","UWA/Class/Model","DS/TopBarProxy/Debuggable","require"],function(t,e,n,i,s){"use strict";return n.extend(i,{uwaClassName:"DS/TopBarProxy/MenuItem",debugMode:!0,submenuType:"DS/TopBarProxy/Menu",defaults:{label:"",disabled:!1,contextId:"",submenu:null,countBadge:0,countBadgeSum:0,selectable:!1,selected:!1,className:""},setup:function(e,n){var i;n&&(i=n.proxyId||n.collection&&n.collection.proxyId,t.is(i,"string")&&i.length&&this.set("proxyId",i,{silent:!0})),this.updateId(),this.addEvents({"onChange:proxyId":this.updateId,"onChange:countBadge":this._dispatchCountBadgeSum,"onChange:submenu":this._listenToSubMenuCountBadgesEvents},this),this.debugMode&&this.addEvents({onBadgeSumChange:this._logUpdateCountBadgeSum,onValidationFailure:this._logInvalidBadgeCountSet},this),this._listenToSubMenuCountBadgesEvents(this,this.get("submenu"))},updateId:function(){!t.is(this.get("id"))&&t.is(this.get("proxyId"))&&this.set("id",this.get("proxyId")+"/"+this.cid)},setProxyId:function(t){this.set("proxyId",t,{silent:!0}),this.updateId()},onAdd:function(e,n){t.is(this.get("proxyId"))||t.is(n.proxyId)&&this.setProxyId(n.proxyId)},set:function(n,i,o){var u,a,r,d;"proxyId"===n?t.is(a=this.get("submenu"))&&a.forEach&&(a.proxyId=i,a.forEach(function(t){t.setProxyId(i)})):("submenu"===n?a=i:"object"===t.typeOf(n)&&t.is(n.submenu)&&(a=n.submenu),t.is(a)&&(d=(r=n.proxyId||(o?o.proxyId:void 0))?{proxyId:r}:{},u=s(this.submenuType),this._attributes.submenu?(this._attributes.submenu.set(a),a=this._attributes.submenu):(a instanceof u?r&&a.forEach(function(t){t.setProxyId(r)}):a=new u(a=e.splat(a),d),a.addEvents({onExecute:this.execute,onSubMenuDisplayed:this.fireOnSubMenuDisplayed,onChange:function(t){t.hasChanged("id")&&t._changing||this.dispatchEvent("onChange",[t])},onAdd:function(){this.dispatchEvent("onChange",[this,"onAddSubMenuItem"])},onRemove:function(){this.dispatchEvent("onChange",[this,"onRemoveSubMenuItem"])}},this)),"submenu"===n?i=a:n.submenu=a)),this._parent(n,i,t.extend(t.clone(o||{},!1),{validate:!0}))},validate:function(e){var n=e.countBadge;if(null!=n&&(!t.is(n,"number")||0!=n%1||0>n))return"Invalid badgeCount attribute "+n+' set on MenuItem {0} labeled "{1}"" : Must be a positive integer or zero!'},_logInvalidBadgeCountSet:function(t,e){this.log(e,this.id||this.cid,this.get("label"))},toJSON:function(e){var n=this._parent(e);return t.is(n.submenu)&&t.is(n.submenu.toJSON)&&(n.submenu=n.submenu.toJSON()),t.is(n.onExecute)&&(n.onExecute=!0),t.is(n.onSubMenuDisplayed)&&(n.onSubMenuDisplayed=!0),n},dump:function(e){t.log(e+"MenuItem label:"+this.get("label")+" id: "+this.get("id")+" proxyId: "+this.get("proxyId")),t.is(this.get("submenu"))&&(t.log(e+" -> submenu:"),this.get("submenu").dump(e+"   "))},execute:function(e,n){e=e||this.get("proxyId"),(n=n||[]).unshift(this.id),t.is(this.get("onExecute"),"function")?this.get("onExecute").call(this):this.dispatchEvent("onExecute",[e,n])},fireOnSubMenuDisplayed:function(t,e){(e=e||[]).unshift(this.id),this.dispatchEvent("onSubMenuDisplayed",[t,e])},fireOnSubMenuReady:function(t){(t=t||[]).unshift(this.id),this.dispatchEvent("onSubMenuReady",[t])},_getCountsSum:function(){var t=this.get("submenu");return(this.get("countBadge")||0)+(t?t._getCountsSum():0)},_listenToSubMenuCountBadgesEvents:function(t,e){var n=this.previous("submenu");n&&n.removeEvent("onSumChange",this._dispatchCountBadgeSum,this),e&&e.addEvent("onSumChange",this._dispatchCountBadgeSum,this)},_dispatchCountBadgeSum:function(t){t!==this&&this.set("countBadgeSum",this._getCountsSum()),this.dispatchEvent("onBadgeSumChange")},_logUpdateCountBadgeSum:function(){this.log('Count Badge on MenuItem {0} labeled "{1}" has been updated to {2}.',this.id||this.cid,this.get("label"),this._getCountsSum())}})}),define("TopBarProxy/MenuItem",["DS/TopBarProxy/MenuItem"],function(t){"use strict";return t}),define("DS/TopBarProxy/Menu",["UWA/Core","UWA/Class/Model","UWA/Class/Collection","DS/TopBarProxy/Debuggable","DS/TopBarProxy/MenuItem"],function(t,e,n,i,s){"use strict";return n.extend(i,{uwaClassName:"DS/TopBarProxy/Menu",model:s,_prepareModel:function(e,n){var i;return e instanceof s&&n&&(i=n.proxyId,t.is(i,"string")&&i!==e.get("proxyId")&&e.setProxyId(i)),this._parent.apply(this,arguments)},setup:function(t,e){e.proxyId&&(this.proxyId=e.proxyId),this.addEvents({onBadgeSumChange:this._dispatchCountBadgeSum,onAdd:this._dispatchCountBadgeSumIfNotNull,onRemove:this._dispatchCountBadgeSumIfNotNull},this)},setItems:function(t,e){var i,s,o;i=this.where({proxyId:t}),s=new n(i.map(function(t){return{id:t.id}})),o=[],s.addEvent("onRemove",function(t){o.push(t)}),s.set(e),this.remove(o),this.set(e,{proxyId:t,remove:!1})},dump:function(t){this.log("{0}Menu containing {1} items, with proxyId {2}",t,this.length,this.proxyId),this.invoke("dump",t)},getActiveProxyIds:function(){return this.activeProxyIds},setActiveProxyIds:function(t){this.activeProxyIds=t,this.dispatchEvent("onChangeActivatedProxyIds",[this,this.activeProxyIds])},_dispatchCountBadgeSum:function(){this.dispatchEvent("onSumChange")},_dispatchCountBadgeSumIfNotNull:function(t){t._getCountsSum()&&this._dispatchCountBadgeSum()},_getCountsSum:function(){var t=0;return this.getActiveItems().forEach(function(e){t+=e._getCountsSum()}),t},getActiveItems:function(){var t,e=this;if(this.activeProxyIds)for(e=[],t=0;t<this.activeProxyIds.length;t++)e=e.concat(this.where({proxyId:this.activeProxyIds[t]}));return e},get:function(e){var n,i;return t.is(e,"array")?(i=this,!1===e.some(function(t){return n=i&&i.get(t),i=n.get("submenu"),!n})?n:void 0):this._parent(e)}})}),define("TopBarProxy/Menu",["DS/TopBarProxy/Menu"],function(t){"use strict";return t}),
/*!
  Script: MenuBarItem.js
*/
define("DS/TopBarProxy/MenuBarItem",["UWA/Core","DS/TopBarProxy/MenuItem"],function(t,e){"use strict";return e.extend({setup:function(t,e){this._parent.apply(this,arguments),this.set("fonticon",function(t){var e;switch(t){case"profile":case"me":e="user-alt";break;case"add":e="plus";break;case"share":e="mail-forward-alt";break;case"home":e="home-alt";break;case"help":e="question-circle";break;case"content":e="component";break;case"social":e="users-alt";break;case"notification":e="bell-alt";break;case"context":e="cloud-alt";break;default:e=""}return e}(this.id))},getActiveProxyIds:function(){return this.activeProxyIds},setActiveProxyIds:function(t){var e=this.get("submenu");this.activeProxyIds=t,e.setActiveProxyIds(t),this.set("disabled",e.length>0&&0===e.getActiveItems().length),this.dispatchEvent("onChange:activatedProxyIds",[this,t])},toJSON:function(){var e=this.get("submenu");return t.is(e)?e.toJSON():null}})}),define("DS/TopBarProxy/TopBarProxy",["UWA/Core","UWA/Utils","UWA/Utils/InterCom","DS/TopBarProxy/Menu","DS/TopBarProxy/MenuBarItem"],function(t,e,n,i,s){"use strict";return i.extend({model:s,uwaClassName:"DS/TopBarProxy/TopBarProxy",init:function(t){var i=this,s=e.getUUID(),o=t.content,u=t.options||{};this._socketId=s,this._channelId=t.id,this._parent(void 0,{}),this._socket=new n.Socket(s),this._socket.subscribeServer("MainMenuBar",u.rightParentWindow||window.parent,"*"),this._socket.dispatchEvent("subscribeToChannel",this._channelId),this._socket.addListener("onExecute",function(t){i.execute(t)}),this._socket.addListener("onSubMenuDisplayed",function(t){i.onSubMenuDisplayed(t)}),this.addEvent("onChange",this._dispatchContentEvent,this),this.addEvent("onSubMenuReady",function(t){this.log("Proxy #{0} is sending a Sub Menu Ready notif through InterCom...",s),this._socket.dispatchEvent("onSubMenuReady",t)},this),o&&this.setContent(o)},setup:function(){var t;t=this._socketId,this.add(["profile","add","share","home","help","search","content","social","notification"].map(function(e){return{id:e,proxyId:t,submenu:[]}},this),{silent:!0})},_dispatchContentEvent:function(){return this.log("Proxy #{0} is sending a change of content through InterCom...",this._socketId),this._socket.dispatchEvent("setContent",this.toJSON()),this},addOnSubMenuDisplayedEvent:function(t){return Object.keys(t).forEach(function(e){this.get(e).set("onSubMenuDisplayed",t[e])},this),this},setContent:function(t){return this._setContent(t)},_setContent:function(t,e){var n;return n=this._socketId,Object.keys(t).forEach(function(i){this.get(i).get("submenu")[e||"set"](t[i],{proxyId:n,silent:!0})},this),this._dispatchContentEvent()},addContent:function(t){return this._setContent(t,"add")},empty:function(){return this.setContent({profile:[],add:[],share:[],home:[],help:[]})},die:function(){["addContent","setContent","addOnSubMenuDisplayedEvent","die","activate","deactivate","empty","setSearchOptionValues"].forEach(function(t){this[t]=function(t,e){var n="Cannot call method "+e+" on zombie "+t.uwaClassName+" #"+t._socketId+" (channel:"+t._channelId+")";return function(){throw new Error(n)}}(this,t)},this),this._socket.dispatchEvent("die",this._channelId)},activate:function(){return this._socket.dispatchEvent("activate",this._channelId),this},deactivate:function(){return this._socket.dispatchEvent("deactivate",this._channelId),this},setSearchOptionValues:function(t,e){this._socket.dispatchEvent("onSearchOptionChange",{searchOptionBox:t,searchPlaceHolder:e})},toJSON:function(t){var e,n={onSubMenuDisplayed:{}};return this.forEach(function(i){e=i.id,n[e]=i.toJSON(t),n.onSubMenuDisplayed[e]=!!i.get("onSubMenuDisplayed")},this),n},execute:function(t){return this._callMenuItemCb(t,"onExecute")},onSubMenuDisplayed:function(t){return this._callMenuItemCb(t,"onSubMenuDisplayed")},_callMenuItemCb:function(t,e){var n=this.get(t);n&&n.get(e)&&n.get(e).call(n,n)},dump:function(e){e||(e=" "),t.log("Dumping TopBarProxy: "),this.invoke("dump",e),t.log("JSON value: "),t.log(this.toJSON())}})}),define("TopBarProxy",["TopBarProxy/TopBarProxy"],function(t){"use strict";return t}),define("TopBarProxy/TopBarProxy",["DS/TopBarProxy/TopBarProxy"],function(t){"use strict";return t});