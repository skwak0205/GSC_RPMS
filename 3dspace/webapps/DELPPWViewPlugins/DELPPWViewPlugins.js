define("DS/DELPPWViewPlugins/RelationsPlugin",["UWA/Core","DS/DELPPWWebServices/WebserviceUtils"],function(e,t){"use strict";return function(n){var i,o,s=n.getLogger(),r=n.getConfig().resource.relationsColumnMappingXML,a={},l=new Set,c=!1,u=null,d={};return o=function(n){t.getXMLValues(r,function(t){var i,o,s,r;if(t.RelationsColumnMapping.RelationsColumns&&t.RelationsColumnMapping.RelationsColumns.RelationsColumn&&(i=t.RelationsColumnMapping.RelationsColumns.RelationsColumn,Array.isArray(i)||(i=[i]),a={},i.forEach(function(t){for(a[t.name]={},(o=e.is(t.Relation)?Array.isArray(t.Relation)?t.Relation:[t.Relation]:[]).some(function(e){return"From"===e.direction})&&l.add(t.name),s=e.is(t.LinkedObjectConstraint)?Array.isArray(t.LinkedObjectConstraint)?t.LinkedObjectConstraint:[t.LinkedObjectConstraint]:[],r=0;r<o.length;r++)a[t.name][o[r].name]=o[r],r<s.length&&(u=t.name,e.is(s[r].Attribute)?a[t.name][s[r].dicoType]=Array.isArray(s[r].Attribute)?s[r].Attribute:[s[r].Attribute]:a[t.name][s[r].dicoType]=[],c=!0)}),n()),t.RelationsColumnMapping.RelationsDisplayAttributes){let n,i;n=t.convert("RelationsColumnMapping.RelationsDisplayAttributes.Type","name"),i=t.convert("RelationsColumnMapping.RelationsDisplayAttributes.Relation","linkName"),d=e.merge(n,i)}})},i=function(e){Promise.all([new Promise(o)]).then(function(){s.debug("RelationsPlugin initialized!"),e()},function(t){s.debug("Failed to load Relations Plugin. Error Description:"+t),e()})},{name:"RelationsPlugin",onStart:function(e){i(e)},onStop:function(){a=void 0,d=void 0,l.clear()},getRelationsConfiguredOnColumn:function(t){var n=null;return e.is(t)&&e.is(a)&&(n=a[t]),n},getInverseRelationNameSet:function(){return l},isObjectConstraint:function(){return c},getConstraintRelationName:function(){return u},getRelationsColumnDisplayAttribute:function(t,n){return e.is(t)&&e.is(d)?e.is(n)&&"display_icon"===n?d[t][n]:d[t]:null},getRelationsColumnDisplayOptions:function(t){var n={};return e.is(t)&&e.is(d)&&(n=e.is(d[t])?d[t]:{},e.is(n)&&e.is(n.Attribute)?n.Attribute=Array.isArray(n.Attribute)?n.Attribute:[n.Attribute]:n.Attribute=[]),n},getAllRelationDisplayAttributes:function(){var t,n,i=[];return Object.keys(a).forEach(function(o){t=a[o],Object.keys(t).forEach(function(o){n=t[o],e.is(n)&&e.is(n.attribute_source,"string")&&n.attribute_source.includes("Relation")&&(o=d[o],(Array.isArray(o.Attribute)?o.Attribute:[o.Attribute]).forEach(function(e){-1===i.indexOf(e.name)&&i.push(e.name)}))})}),i}}}}),define("DS/DELPPWViewPlugins/ProxyPlugin",["UWA/Core","DS/TagNavigatorProxy/TagNavigatorProxy","DS/ENOFilterBIUX/FilterBIComponentProxy"],function(e,t,n){"use strict";return function(i){var o,s,r=i.getLogger();return s=function(e,i){var s;switch(e){case o.FilterProxy:s=new n(i);break;case o.TaggerProxy:i.hasOwnProperty("filteringMode")||(i.filteringMode=t.filteringMode.FilteringOnServer),s=t.createProxy(i);break;default:r.debug("Invalid proxy. Proxy creation failed")}return s},{name:"ProxyPlugin",PROXY:o={FilterProxy:"FilterProxy",TaggerProxy:"TaggerProxy"},create:function(t,n){var o,a,l=i.getPlugins("WebServicePlugin"),c=n||{},u=null;return e.is(l)?(l=l.instance,o={appId:(a=i.getConfig().appContext).widget.data.appId,widgetId:a.widget.getId(),tenant:l.getTenant(),colorize:!0},e.merge(c,o),u=s(t,c)):r.debug("WebServicePlugin not available"),u},onStart:function(){},onStop:function(){}}}}),define("DS/DELPPWViewPlugins/RootsPlugin",["UWA/Core","UWA/Json"],function(e,t){"use strict";return function(n){var i,o,s,r,a,l,c,u,d,g,m=n.getConfig().resource.rootsMappingPath,f=new Map;return r=function(){var t=widget.getValue("storedRoots");return e.Json.isJson(t)?e.Json.decode(t):t},o=function(t,n){var i=r();e.owns(i,"Default")?e.owns(i.Default,t)?-1===i.Default[t].indexOf(n)&&i.Default[t].push(n):i.Default[t]=[n]:((i={}).Default={},i.Default[t]=[n]),widget.setValue("storedRoots",e.Json.encode(i))},s=function(t,n){var i=-1,o=r();e.owns(o,"Default")&&e.owns(o.Default,t)&&-1<(i=o.Default[t].indexOf(n))&&(o.Default[t].splice(i,1),widget.setValue("storedRoots",e.Json.encode(o)),u(n))},a=function(t){var n,i=[],o=e.is(t)&&""!==t?t:"Default",s=r();if(e.owns(s,o))for(n in s[o])e.owns(s[o],n)&&(i=i.concat(s[o][n]));return i},l=function(t,n){var o,s,a=[],l=e.is(n)&&""!==n?n:"Default";return e.is(i)&&e.is(t)&&(s=i[t],e.is(s,"array")&&(o=r(),e.is(o[l])&&(a=s.map(function(e){return o[l][e]||[]})))),a},c=function(e,t){f.set(e,t)},u=function(e){f.delete(e)},d=function(e){return f.get(e)},g=function(t){const n=e=>Array.isArray(e)&&1===e.length;let i="",o=!1;const s=d(t);if(e.is(s)){if(n(s.filters)){const t=s.filters[0];n(Object.keys(t))&&e.owns(t,"config_filter")&&(i=t.config_filter,o=!0)}}else o=!0;return{isCompatibleFilter:o,configurationFilter:i}},{name:"RootsPlugin",onStart:function(o){require(["text!"+m],function(s){e.is(s)?i=e.is(s,"string")?t.decode(s):s:n.getLogger().debug("roots mapping is not defined."),o()}),widget.addPreference({name:"storedRoots",type:"hidden",defaultValue:{}})},onStop:function(){f.clear()},addRoot:function(t,n){e.is(t)&&o(t,n)},removeRoot:function(t,n){e.is(t)&&e.is(n)&&s(t,n)},addRootFilter:function(e,t){c(e,t)},getRootFilter:function(e){return d(e)},removeRootFilter:function(e){u(e)},getCompatibleConfigurationFilters:function(e){const t=e.map(e=>({...g(e),rootId:e}));let n=null;return(e=>e.some(e=>!e.isCompatibleFilter))(t)||(n=t.reduce((e,t)=>(e[t.rootId]=t.configurationFilter,e),{})),n},getRoots:function(t){return e.is(t)?l(t):a()},getStoreRoots:function(t,n){var i=[];return e.is(t)&&(i=e.is(n)?l(n,t):a(t)),i},isRoot:function(t){var n=!1;return e.is(t)&&(n=a().indexOf(t)>-1),n},createStore:function(t){var n=r();e.owns(n,"Default")&&(n[t]=n.Default),widget.setValue("storedRoots",e.Json.encode(n))},removeStore:function(t){var n;e.is(t)&&"Default"!==t&&(n=r(),e.owns(n,t)&&(delete n[t],widget.setValue("storedRoots",e.Json.encode(n))))},getStoresList:function(){var e=r(),t=[];return Object.keys(e).forEach(function(e){"Default"!==e&&t.push(e)}),t},removeRoots:function(t){var n=r();Object.keys(n).forEach(function(i){"Default"===i&&e.owns(n[i],t)&&(n[i][t]=[])}),widget.setValue("storedRoots",e.Json.encode(n))}}}}),define("DS/DELPPWViewPlugins/ImplementPlugin/ImplementBase",["UWA/Core","DS/DELPPWModelServices/CollectionUtils"],function(e,t){"use strict";return function(n,i,o,s,r,a){var l,c,u,d,g,m,f,p="ImplementBase",h=i,C=o,P=s,v=r;if(a=!e.is(a)||a,!e.is(h))throw new Error("Error: scope link name is not defined!");if(!e.is(P))throw new Error("Error: implment link name is not defined!");return m=function(t){var n=!1;return e.is(t)&&e.is(t.type,"string")&&("BL Error"===t.type||"Specific Error"===t.type)&&e.is(t.message,"string")&&t.message.length>0&&(n=!0),n},l=function(n,i,o){var s=[h];return e.is(i,"string")&&(s=[i]),t.getImpactedConnections(n,null,{isRefRefOnly:!0,relationTypes:s,fromXEN:o})},c=function(n,i,o){var s=[C];return e.is(i,"string")&&(s=[i]),t.getImpactedConnections(n,null,{isRefRefOnly:!0,relationTypes:s,fromXEN:o})},u=function(n,i,o){var s=[v];return e.is(i,"string")&&(s=[i]),t.getImpactedConnections(n,null,{isRefRefOnly:!0,relationTypes:s,fromXEN:o})},d=function(e){var i,o=e;return Array.isArray(e)&&((i=e).length>0?o=t.getInstanceFromCollection(i[i.length-1]).get("isInstanceOf"):(o=null,n.debug(p,"Error: expected reference id for root node"))),o},g=function(i){var o=[];return e.is(i,"function")?o=t.findSomeConnection(function(e){var t=P===e.get("type"),n=!1;return t&&(n=i(e.get("from"),e.get("to"))),t&&n}):n.debug(p,'Error: _getImplementLinks: expected a predicate method "funcHasImplement"'),o},f=function(i,o){var s=o||{},r={onComplete:function(){e.is(s.onComplete)&&s.onComplete("ImplementPlugin.DeleteImpl.Success")},onFailure:function(t,n){e.is(s.onFailure)&&(m(n)?o.onFailure("ImplementPlugin.DeleteImpl.Failed",n.message):o.onFailure("ImplementPlugin.DeleteImpl.Failed"))}};e.is(i)?t.deleteConn(i,r):(n.debug(p,"Input connection ID is invalid."),s.onFailure("ImplementPlugin.DeleteImpl.Failed"))},{getReferencePID:function(e){return d(e)},filterImplementLinks:function(e){return g(e)},findInstanceWhoseParentIsScoped:function(n){var i,o,s,r,a=null;for(i=n.length-1;i>=0;i--)if(o=t.getInstanceFromCollection(n[i]),e.is(o)&&(r=o.get("isAggregatedBy"),(s=l(r)).length>0)){a={absPathIndex:i,instanceModel:o,scopeLinks:s};break}return a},findInstanceWhoseParentIsPartialScoped:function(n){var i,o,s,r,a=null;for(i=n.length-1;i>=0;i--)if(o=t.getInstanceFromCollection(n[i]),e.is(o)&&(r=o.get("isAggregatedBy"),(s=c(r)).length>0)){a={absPathIndex:i,instanceModel:o,scopeLinks:s};break}return a},getScopedParent:function(t){var n,i=null;return e.is(t,"array")&&t.length>0&&(n=this.findInstanceWhoseParentIsScoped(t),e.is(n)&&(i=n.instanceModel.get("isAggregatedBy"))),i},getPartialScopedParent:function(t){var n,i=null;return e.is(t,"array")&&t.length>0&&(n=this.findInstanceWhoseParentIsPartialScoped(t),e.is(n)&&(i=n.instanceModel.get("isAggregatedBy"))),i},isUnderScope:function(t){var i,o=!1;return e.is(t,"array")?t.length>0&&(i=this.findInstanceWhoseParentIsScoped(t),e.is(i)&&(o=!0)):(n.debug(p,"Error: isUnderScope: expected absolute path"),o=null),o},isUnderPartialScope:function(t){var i,o=!1;return e.is(t,"array")?t.length>0&&(i=this.findInstanceWhoseParentIsPartialScoped(t),e.is(i)&&(o=!0)):(n.debug(p,"Error: isUnderScope: expected absolute path"),o=null),o},isScoped:function(e){return this.getScopeLinks(e).length>0},isPartialScoped:function(e){return this.getPartialScopeLinks(e).length>0},isResultingLinked:function(e){return this.getResultingProductLinks(e).length>0},getScopeLinks:function(e,t,n){var i=d(e),o=[];return i&&(o=l(i,t,n)),o},getPartialScopeLinks:function(e,t,n){var i=d(e),o=[];return i&&(o=c(i,t,n)),o},getResultingProductLinks:function(e){var t=d(e),n=[];return t&&(n=u(t)),n},getResultingProductLinksOfImplementing:function(e,t){var i,o=d(e),s=[];return o&&(i=u(o,v,t),Array.isArray(i)&&(1===i.length?s=i:i.length>1&&n.debug(p,"ERROR: getResultingProductsLinksOfImplementing found more than one scope link for MfgItem: "+e))),s},getResultingProductLinksOfImplemented:function(e){var t,i=d(e),o=[];return i&&(t=u(i,v),Array.isArray(t)&&(1===t.length?o=t:t.length>1&&n.debug(p,"ERROR: getResultingProductsLinksOfImplementing found more than one scope link for MfgItem: "+e))),o},getScopeLinksOfImplemented:function(e){var t,n=d(e),i=[];return n&&(t=l(n,h),Array.isArray(t)&&(i=t)),i},getPathToScope:function(t){var n,i=[];return n=this.findInstanceWhoseParentIsScoped(t),e.is(n)&&(i=t.slice(n.absPathIndex)),i},getPathToPartialScope:function(t){var n,i=[];return n=this.findInstanceWhoseParentIsPartialScoped(t),e.is(n)&&(i=t.slice(n.absPathIndex)),i},getPathsToScope:function(e,t){return{implementingPathToScope:this.getPathToScope(e),implementedPathToScope:this.getPathToScope(t)}},getImplLinks:function(t){var n,i,o;return e.is(t,"array")?(n=t[t.length-1],i=this.getPathToScope(t),o=g(function(t,o){return n===t||e.Json.encode(i)===e.Json.encode(o)})):o=null,o},getImplLinksOfImplemented:function(t){var n,i;return Array.isArray(t)?(n=this.getPathToScope(t),i=g(function(t,i){return e.equals(n,i)})):i=null,i},hasCrossScope:function(n,i,o,s){var r,a,c,u,d,g=[],m=[],f=[],p=[],h=null,C=!1,P=null,v=null,S=!1,I=!1;return d=function(e,t){var n=null;return e.some(function(e){return l(e).some(function(e){var i=!1,o=e.get("to");return t.indexOf(o)>-1&&(i=!0,n=e),i})}),n},e.is(s,"array")&&s.length>0&&s.forEach(function(n,o){var r=t.getInstanceFromCollection(n);0===o&&f.push(r.get("isAggregatedBy")),s.length-1!==o?f.push(r.get("isInstanceOf")):e.is(i)||(i=r.get("isInstanceOf"))}),e.is(o,"array")&&o.length>0&&o.forEach(function(i,s){var r=t.getInstanceFromCollection(i);0===s&&g.push(r.get("isAggregatedBy")),o.length-1!==s?g.push(r.get("isInstanceOf")):e.is(n)||(n=r.get("isInstanceOf"))}),e.is(i)&&g.length>0&&t.expandOnBackbone(i,{referencesPID:p,instancesPID:[]}),e.is(n)&&f.length>0&&t.expandOnBackbone(n,{referencesPID:m,instancesPID:[]}),!e.is(h)&&g.length>0&&p.length>0&&(h=d(g,p),e.is(h)&&(S=!0)),!e.is(h)&&m.length>0&&f.length>0&&(h=d(m,f),e.is(h)&&(I=!0)),e.is(h)&&(C=!0,r=h.getAttribute("from"),c=t.getReferenceFromCollection(r),e.is(c)&&(P=c.get("V_Name")),a=h.getAttribute("to"),u=t.getReferenceFromCollection(a),e.is(u)&&(v=u.get("V_Name"))),{hasCrossScope:C,implementingName:P,implementedName:v,isParentCrossScope:S,isChildCrossScope:I}},getScopeLinkType:function(){return h},getPartialScopeLinkType:function(){return C},getResultingProductLinkType:function(){return v},getImplementLinkType:function(){return P},deleteImplementLink:function(e,t){f(e,t)},deleteScopeLink:function(i,o){var s;s={onComplete:function(){e.is(o)&&e.is(o.onComplete)&&o.onComplete("ImplementPlugin.DeleteScope.Success")},onFailure:function(t,n){e.is(o)&&e.is(o.onFailure)&&(m(n)?o.onFailure("ImplementPlugin.DeleteScope.Failed",n.message):o.onFailure("ImplementPlugin.DeleteScope.Failed"))}},e.is(i)?t.deleteConn(i,s):(n.debug(p,"Input connection ID is invalid."),s.onFailure("ImplementPlugin.DeleteScope.Failed"))},createImplementLink:function(n,i,o){var s,r,l;o=o||{},l=function(t,n){e.is(o.onFailure,"function")&&(m(n)?o.onFailure("ImplementPlugin.CreateImpl.Failed",n.message):o.onFailure("ImplementPlugin.CreateImpl.Failed"))},a?(n=n.toString(),i=i.toString()):(n=e.is(n,"array")?n[n.length-1]:n,i=e.Json.encode(i)),s={type:P,IDFrom:n,IDTo:i},e.is(o.connectionParams)&&(s.connectionParams=o.connectionParams),r={onFailure:l,onTimeout:l,onCancel:l,onComplete:function(t){e.is(o.onComplete,"function")&&o.onComplete("ImplementPlugin.CreateImpl.Success",t)},securityContextOverride:o.securityContextOverride},t.createConn(s,r)},createScopeLink:function(n,i,o){var s,r,a=function(t,n){e.is(o.onFailure,"function")&&(m(n)?o.onFailure("ImplementPlugin.CreateScope.Failed",n.message):o.onFailure("ImplementPlugin.CreateScope.Failed"))};o=o||{},s={type:h,IDFrom:n,IDTo:i},r={onFailure:a,onTimeout:a,onCancel:a,onComplete:function(){e.is(o.onComplete,"function")&&o.onComplete("ImplementPlugin.CreateScope.Success")}},t.createConn(s,r)}}}}),define("DS/DELPPWViewPlugins/MoreAttributesWizard",["UWA/Core","UWA/Controls/Abstract","DS/Controls/Button","DS/Controls/Loader","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/DataGridView/DataGridView","DS/DataGridView/DataGridViewLayout","DS/Utilities/Utils","DS/PlatformAPI/PlatformAPI","DS/DELPPWDicoServices/DicoUtils","DS/DELPPWResourceServices/ResourceUtils","DS/DELPPWWebServices/WebserviceUtils","DS/DELWeb3DViewer/MoreAttributesManager"],(e,t,n,i,o,s,r,a,l,c,u,d,g,m)=>{const f=JSON.parse(m.getTxtWizardSteps()),p={properties:[function(){return{property:"dataIndex",value:this.options.grid.dataIndex}},function(){return{property:"attrName",value:this.options.grid.attrName}},function(){return{property:"attrParent",value:this.options.grid.attrParent}},function(){return{property:"attrDim",value:this.options.grid.attrDim}},function(){return{property:"attrUnit",value:this.options.grid.attrUnit}},function(){return{property:"internalName",value:this.options.grid.internalName}},function(){return{property:"label",value:this.options.label}},function(){return{property:"kind",value:this.options.grid.attrKind}},function(){return{property:"description",value:this.options.grid.attrDesc}},function(){return{property:"attrSelectable",value:this.options.grid.attrSelectable}},function(){return{property:"attrNature",value:this.options.grid.attrNature}},function(){return{property:"attrUserAccess",value:this.options.grid.attrUserAccess}},function(){return{property:"attrIsSelected",value:this.options.grid.attrSel}},function(){return{property:"attrIsInXML",value:this.options.grid.attrInXML}}]};var h,C,P=new Map;return t.extend({name:"more-attr",defaultOptions:{baseTypes:[],baseInstanceTypes:[],selectedTypes:[],automaticExtensions:[],selectedExtensions:[],selectedAttributes:[],preSelectedAttributes:[],unSelectableAttributes:[],defaultTypes:[],defaultExtensions:[],subscribeTokens:[],modelEvents:c,renderTo:null,steps:null,activeView:null,maps:{referenceTypes:[],instanceTypes:[]},views:{typesView:null,extensionsView:null,attributesView:null},toolbar:null,grids:{},models:{},dgvOptions:{defaultColumnDef:{width:"auto",typeRepresentation:"string"},showRowBorderFlag:!0,alternateBackgroundFlag:!1,columns:[{icon:{iconName:"check",fontIconFamily:1},dataIndex:"attrSel",typeRepresentation:"boolean",alwaysVisibleFlag:!0,width:40,resizableFlag:!1,editableFlag:!0,editionPolicy:"EditionInPlace",getCellEditableState:function(e){var t=!0;return e.nodeModel&&e.nodeModel.getReferenceValue("attrRO")&&(t=!1),t}},{dataIndex:"attrParent",editableFlag:!1,width:30,sortableFlag:!0,resizableFlag:!1,getCellTypeRepresentation:function(e){return e.nodeModel&&e.nodeModel.options.grid.attrParent?e.nodeModel.options.grid.attrParent:"Unknown"},getCellSemantics:function(e){if(e.nodeModel)return{disabled:!0}}},{dataIndex:"tree",text:m.getNLSAttributeTitle()}]},dgvLayoutOptions:{cellHeight:26,columnHeaderHeight:38,rowsHeader:!1}},init:function(e){this._parent(e),this._realInit(e)},_realInit:async function(){const t=m.isWebInWinContext()?"-immersivePanelWebInWin":"-immersivePanel";this.elements.container=e.createElement("div",{class:this.getClassNames(t)}),this.elements.container.inject(this.options.container),this.options.dialog.show(),preSelectedAttributes=this.options.preSelectedAttributes,unSelectableAttributes=this.options.unSelectableAttributes,await this._buildBody(),await this._buildFooter(),this.switchView(f.activeStep),this.options.subscribeTokens.push(this.options.modelEvents.subscribe({event:"ENXViews/WizardSteps/stepChanged"},e=>{const t=e.stepId;this.switchView(t)})),this.options.modelEvents.publish({event:"ENXViews/Views/showInWidgetBody",data:{restore:!0}}),this.options.modelEvents.publish({event:"ENXViews/Views/showInWidgetBody",data:{idView:"moreAttr",html:this.elements.container}})},destroy:function(){this.options.subscribeTokens.forEach(e=>this.options.modelEvents.unsubscribe(e)),this.options.toolbar.destroy(),Object.keys(this.options.grids).forEach(e=>{this.options.grids[e].destroy(),this.options.grids[e]=null}),this._parent()},_buildBody:function(){return new Promise(t=>{this.elements.wizard=e.createElement("div",{class:this.getClassNames("-wizard")}).inject(this.elements.container),this.options.wizard=m.getNewWizardSteps(this.options.modelEvents,this.elements.wizard,f);const n=e.createElement("div",{class:this.getClassNames("-toolbar-container")}).inject(this.elements.container);this.elements.content=e.createElement("div",{class:this.getClassNames("-content")}).inject(this.elements.container),this._generateToolbar({renderTo:n}),t()})},_buildFooter:function(){var t=this;return new Promise((i,o)=>{this.elements.footer=e.createElement("div",{class:this.getClassNames("-footer"),styles:{"padding-top":"10px"}}).inject(this.elements.container);const s=new n({label:m.getNLSNext(),value:"next",emphasize:"primary",touchMode:!0});this.elements.nextButton=s,s.addEventListener("click",()=>{if("typesView"===this.options.activeView){const e=this.options.models.typesView.search({match:e=>!0===e.nodeModel.options.grid.attrSel}).map(e=>e.dump(p));this.options.selectedTypes=[],e.forEach(function(e){t.options.selectedTypes.push(e.attrName)}),this.options.wizard.changeStep("extensionsView")}else if("extensionsView"===this.options.activeView){const e=this.options.models.extensionsView.search({match:e=>!0===e.nodeModel.options.grid.attrSel}).map(e=>e.dump(p));this.options.selectedExtensions=[],e.forEach(function(e){t.options.selectedExtensions.push(e.label)}),this.options.wizard.changeStep("attributesView")}else if("attributesView"===this.options.activeView){const e=this.options.models.attributesView.search({match:e=>(e.nodeModel.options.grid.attrSel||e.nodeModel.options.grid.attrInXML)&&!e.nodeModel.options.grid.attrRO}).map(e=>e.dump(p));executeDoneButton=l.debounce(function(e,t){e.options.modelEvents.publish({event:"MGA/MoreAttributesWizard/selectedAttributes",data:{selectedAttributes:t,selectedTypes:e.options.selectedTypes,selectedExtensions:e.options.selectedExtensions}}),e.destroy()},100),executeDoneButton(this,e)}}),s.inject(this.elements.footer);const r=new n({label:m.getNLSCancel(),emphasize:"secondary",touchMode:!0});this.elements.closeButton=r,r.addEventListener("click",()=>{this.options.dialog.close(),this.destroy()}),r.inject(this.elements.footer),i()})},switchView:function(t){if(this.options.activeView!==t)if(this.elements.toolbarSearch.clear(!0),this.__setToolbarCmds(t),this.options.previousView=this.options.activeView,this.options.activeView=t,null===this.options.views[t]){const o=this.elements.content.getElement("div.more-attr-chooser-view");o&&this.elements.content.removeChild(o),e.is(this.elements.loader)||(this.elements.loaderDiv=e.createElement("div",{class:this.getClassNames("-loader")}).inject(this.elements.content),this.elements.loader=(new i).inject(this.elements.loaderDiv),this.elements.loader.getContent().addClassName("enx-loader")),this.elements.loaderDiv.removeClassName("hidden"),this.elements.loader.on();const s=[];let r=null,a=0,l=f.steps.length;do{f.steps[a].id===t&&(r=f.steps[a]),a++}while(a<l||null===r);if(r.prerequisiteViews)for(var n=0;n<r.prerequisiteViews.length;n++)null===this.options.views[r.prerequisiteViews[n]]&&s.push(this["_build"+r.prerequisiteViews[n]](!0));Promise.all(s).then(()=>{this["_build"+t]().then(e=>{this.elements.loaderDiv.addClassName("hidden"),this.elements.loader.off()})})}else{const e=this.elements.content.getElements("div.more-attr-chooser-view");if(e&&Array.isArray(e)&&e.forEach(e=>{this.elements.content.removeChild(e)}),this.options.views[t].inject(this.elements.content),!0===this.typesUpdated&&"extensionsView"===this.options.activeView)this.__updateExtensionsView().then(()=>{delete this.typesUpdated,this.extensionsUpdated=!0});else if(!0!==this.typesUpdated&&!0!==this.extensionsUpdated||"attributesView"!==this.options.activeView){this.options.grids[this.options.activeView].getContent().removeClassName("loading"),"extensionsView"===this.options.activeView||"typesView"===this.options.activeView?this.elements.nextButton.label=m.getNLSNext():this.elements.nextButton.label=m.getNLSDone()}else this.__updateAttributesView().then(()=>{delete this.typesUpdated,delete this.extensionsUpdated})}},_buildtypesView:function(t){return new Promise((n,i)=>{this.elements.nextButton.label=m.getNLSNext(),this.elements.nextButton.disabled=!0,this.options.wizard.getContent().addClassName("disabled"),this.options.views.typesView=e.createElement("div",{class:this.getClassNames("-typesView more-attr-chooser-view")});const s=e.createElement("div",{class:this.getClassNames("-typesViewDgv more-attr-dgv-container")}).inject(this.options.views.typesView),l=e.extend({identifier:"MoreAttrWizard-"+m.uid()},e.clone(this.options.dgvOptions));l.layout=new a(this.options.dgvLayoutOptions);const c=this.options.grids.typesView=new r(l);this._declareInstRefTypeReps(c),c.onContextualEvent=(()=>[]),c.getCellTooltip=(e=>{const t=this.options.grids.typesView.getColumnOrGroup(e.columnID).dataIndex;if(e.dataIndex=t,-1===e.rowID)return{shortHelp:m.getNLSShortHelp(t),updateModel:!1}}),c.mandatorySelected=this.options.defaultTypes,this.options.models.typesView=new o({}),c.treeDocument=this.options.models.typesView,c.getContent().addClassName("enxdatagridview loading"),c.getContent().inject(s),this.options.views.typesView.inject(this.elements.content),c.onReady(()=>{this.__updateTypesViewModel().finally(()=>{!0!==t&&(c.getContent().removeClassName("loading"),this.elements.nextButton.disabled=!1,this.options.wizard.getContent().removeClassName("disabled")),n()}),c.addEventListener("change",this._changeType.bind(this))})})},_changeType:function(e,t){var n=this.options.grids[this.options.activeView];if(t&&t.nodeModel&&t.nodeModel.options.grid&&"attrSel"===n.layout.getDataIndexFromColumnIndex(t.columnID)){var i=t.nodeModel.getReferenceValue("attrName"),o=this.options.selectedTypes.indexOf(i);!0===t.nodeModel.options.grid.attrSel?-1===o&&this.options.selectedTypes.push(i):-1!==o&&this.options.selectedTypes.splice(o),this.typesUpdated=!0}},_buildextensionsView:function(t){var n=this;return new Promise(function(i,s){n.elements.nextButton.label=m.getNLSNext(),n.elements.nextButton.disabled=!0;n.options.wizard.getContent().addClassName("disabled"),n.options.views.extensionsView=e.createElement("div",{class:n.getClassNames("-extensionsView more-attr-chooser-view")});var l=e.createElement("div",{class:n.getClassNames("-extensionsView-Dgv more-attr-dgv-container")}).inject(n.options.views.extensionsView),c=e.extend({identifier:"MoreAttrWizard-"+m.uid()},e.clone(n.options.dgvOptions));c.layout=new a(n.options.dgvLayoutOptions);var u=n.options.grids.extensionsView=new r(c);n._declareInstRefTypeReps(u),u.onContextualEvent=function(){return[]},u.getCellTooltip=function(e){var t=n.options.grids.extensionsView.getColumnOrGroup(e.columnID).dataIndex;return e.dataIndex=t,-1===e.rowID?{shortHelp:m.getNLSShortHelp(t),updateModel:!1}:e.nodeModel?{shortHelp:m.getNLSShortHelpReplace(e.nodeModel.getReferenceValue("attrInTypeNLS").join("\n")),updateModel:!1}:void 0}.bind(n),u.mandatorySelected=n.options.defaultExtensions,n.options.models.extensionsView=new o({}),u.treeDocument=n.options.models.extensionsView,u.getContent().addClassName("enxdatagridview loading"),u.getContent().inject(l),n.options.views.extensionsView.inject(n.elements.content),u.onReady(function(){n.__updateExtensionsViewModel(!0).finally(function(){!0!==t&&(u.getContent().removeClassName("loading"),n.elements.nextButton.disabled=!1,n.options.wizard.getContent().removeClassName("disabled")),i({})}),u.addEventListener("change",n._changeExtension.bind(n))})})},_changeExtension:function(e,t){const n=this.options.grids[this.options.activeView];if(t&&t.nodeModel&&t.nodeModel.options.grid&&"attrSel"===n.layout.getDataIndexFromColumnIndex(t.columnID)){const e=t.nodeModel.getReferenceValue("attrName");var i=this.options.selectedExtensions.indexOf(e);!0===t.nodeModel.options.grid.attrSel?-1===i&&this.options.selectedExtensions.push(e):-1!==i&&this.options.selectedExtensions.splice(i),this.extensionsUpdated=!0}},_buildattributesView:function(t){var n=this;return new Promise(function(i){n.elements.nextButton.label=m.getNLSDone(),n.elements.nextButton.disabled=!0;n.options.wizard.getContent().addClassName("disabled"),n.options.views.attributesView=e.createElement("div",{class:n.getClassNames("-attributesView more-attr-chooser-view")});var s=e.createElement("div",{class:n.getClassNames("-attributesView-Dgv more-attr-dgv-container")}).inject(n.options.views.attributesView),l=e.extend({identifier:"MoreAttrWizard-"+m.uid()},e.clone(n.options.dgvOptions));l.layout=new a(n.options.dgvLayoutOptions);var c=n.options.grids.attributesView=new r(l);c.onContextualEvent=function(){return[]},c.getCellTooltip=function(e){var t=n.options.grids.attributesView.getColumnOrGroup(e.columnID).dataIndex;if(e.dataIndex=t,-1===e.rowID)return{shortHelp:m.getNLSShortHelp(t),updateModel:!1};if(e.nodeModel){var i=e.nodeModel.getReferenceValue("attrInTypeNLS");return{shortHelp:m.getNLSShortHelpReplace(i?i.join("\n"):""),updateModel:!1}}}.bind(n),c.mandatorySelectedWithParent={Reference:["ds6w:label","ds6w:type"]},n.options.models.attributesView=new o({}),c.treeDocument=n.options.models.attributesView,c.getContent().addClassName("enxdatagridview loading"),c.getContent().inject(s),n.options.views.attributesView.inject(n.elements.content),c.onReady(function(){var e=[];void 0===n.options.grids.extensionsView&&e.push(n._buildextensionsView(!0)),Promise.all(e).then(n.__updateAttributesViewModel.bind(n)).finally(function(){!0!==t&&(c.getContent().removeClassName("loading"),n.elements.nextButton.disabled=!1,n.options.wizard.getContent().removeClassName("disabled")),i()}),c.addEventListener("change",n._changeAttributes.bind(n))})})},_changeAttributes:function(e,t){var n=this.options.grids[this.options.activeView];if(t&&t.nodeModel&&t.nodeModel.options.grid&&"attrSel"===n.layout.getDataIndexFromColumnIndex(t.columnID)){var i=this.options.selectedAttributes.indexOf(t.nodeModel.getLabel());!0===t.nodeModel.options.grid.attrSel?-1===i&&this.options.selectedAttributes.push(t.nodeModel.getLabel()):-1!==i&&this.options.selectedAttributes.splice(i)}},_generateToolbar:function(t){var n=this,i=l.debounce(function(e){n.options.models[n.options.activeView].withTransactionUpdate(function(){var t=e.searchStr,i=!0;n.options.filterInProgress=!0,n.options.models[n.options.activeView].search({match:function(e){(function(e,t){var n=!1,i=new RegExp(e,"i");return(i.test(t.nodeModel.options.grid.attrTitle)||i.test(t.nodeModel.getLabel()))&&(n=!0),n})(t,e)&&n._isNodeVisible(e.nodeModel)?(e.nodeModel.show(),t.length>0&&i?(e.nodeModel.select(!0),e.nodeModel.matchSearch(),i=!1):(e.nodeModel.unmatchSearch(),e.nodeModel.unselect())):(e.nodeModel.unmatchSearch(),e.nodeModel.unselect(),e.nodeModel.hide())}}),n.options.filterInProgress=!1}),n.options.models[n.options.activeView].getXSO().onPostAdd(function(){}),n.options.models[n.options.activeView].getXSO().onPostRemove(function(){})},500);this.elements.toolbar=e.createElement("div",{class:this.getClassNames("-toolbar")}).inject(t.renderTo);var o=e.createElement("div",{class:this.getClassNames("-toolbar-input")}).inject(this.elements.toolbar);this.elements.toolbarIconbar=e.createElement("div",{class:this.getClassNames("-toolbar-iconbar")}).inject(this.elements.toolbar);o.addEventListener("touchstart",function(e){e.target.style.fontSize="16px"},!1),o.addEventListener("mouseleave",function(e){e.target.style.fontSize="14px"},!1),this.elements.toolbarSearch=m.getNewSearchInput(i,o)},_isNodeVisible:function(e){switch(this.currentSelectFilter+"-"+this.currentInstRefFilter){case"none-none":return!0;case"selected-none":return!0===e.getReferenceValue("attrSel");case"unselected-none":return!1===e.getReferenceValue("attrSel");case"none-reference":return"Instance"!==e.getReferenceValue("attrParent");case"none-instance":return"Reference"!==e.getReferenceValue("attrParent");case"selected-reference":return!0===e.getReferenceValue("attrSel")&&"Instance"!==e.getReferenceValue("attrParent");case"selected-instance":return!0===e.getReferenceValue("attrSel")&&"Reference"!==e.getReferenceValue("attrParent");case"unselected-reference":return!1===e.getReferenceValue("attrSel")&&"Instance"!==e.getReferenceValue("attrParent");case"unselected-instance":return!1===e.getReferenceValue("attrSel")&&"Reference"!==e.getReferenceValue("attrParent")}return!0},__setToolbarCmds:function(e){var t=this;this.currentSelectFilter="none",this.currentInstRefFilter="none";var n,i=function(){t.options.models[t.options.activeView].withTransactionUpdate(function(){for(var e=t.options.models[t.options.activeView].getRoots(),n=(t.currentSelectFilter,t.currentInstRefFilter,0);n<e.length;n++){t._isNodeVisible(e[n])?e[n].show():e[n].hide()}}),t.options.models[t.options.activeView].getXSO().onPostAdd(function(){}),t.options.models[t.options.activeView].getXSO().onPostRemove(function(){})},o={fonticon:"tag-active",text:m.getNLSFilterRowsKind(),name:"filter-kind",content:{type:"dropdownmenu",options:{items:[{fonticon:"block",text:m.getNLSNone(),name:"none",selectable:!0,selected:!0},{fonticon:"product",text:m.getNLSFilterReference(),name:"reference",selectable:!0},{fonticon:"flow-cascade",text:m.getNLSFilterInstance(),name:"instance",selectable:!0}],events:{onClick:function(e,n){var o;o=n.name,t.currentInstRefFilter=o,i()}}}}},s={fonticon:"filter",text:m.getNLSFilterRows(),name:"filter",content:{type:"dropdownmenu",options:{items:[{fonticon:"block",text:m.getNLSNone(),name:"none",selectable:!0,selected:!0},{fonticon:"checkbox-on",text:m.getNLSSelected(),name:"selected",selectable:!0},{fonticon:"checkbox-off",text:m.getNLSUnSelected(),name:"unselected",selectable:!0}],events:{onClick:function(e,n){var o;o=n.name,t.currentSelectFilter=o,i()}}}}};if(!this.options.toolbar||this.options.toolbar.currentView!==e){switch(e){case"typesView":case"extensionsView":case"attributesView":n=[o,s]}var r={renderTo:this.elements.toolbarIconbar,items:n};this.options.toolbar&&(this.options.toolbar.destroy(),this.options.toolbar=null),this.options.toolbar=m.getNewIconBar(r),this.options.toolbar.elements.container.setStyle("display",void 0)}},_declareInstRefTypeReps:function(e){var t={Reference:{stdTemplate:"functionIcon",semantics:{icon:{iconName:"product",fontIconFamily:WUXManagedFontIcons.Font3DS}}},Instance:{stdTemplate:"functionIcon",semantics:{icon:{iconName:"flow-cascade",fontIconFamily:WUXManagedFontIcons.Font3DS}}},Both:{stdTemplate:"functionIcon",semantics:{icon:{iconName:"part-replace",fontIconFamily:WUXManagedFontIcons.Font3DS}}},Extension:{stdTemplate:"functionIcon",semantics:{icon:{iconName:"part-add",fontIconFamily:WUXManagedFontIcons.Font3DS}}},Unknown:{stdTemplate:"functionIcon",semantics:{icon:{iconName:"i-question",fontIconFamily:WUXManagedFontIcons.Font3DS}}}};e.getTypeRepresentationFactory().registerTypeRepresentations(JSON.stringify(t))},__updateTypesViewModel:async function(){h=u.getReferenceTypes(),C=u.getInstanceTypes(),this.options.baseTypes=h,this.options.baseInstanceTypes=C;var t=this.options.baseInstanceTypes.length?this.options.baseTypes.concat(this.options.baseInstanceTypes):this.options.baseTypes;t=this.options.selectedTypes.filter(e=>t.includes(e));const n=[];t.forEach(function(t){var i=u.getTypeInfo(t);n.push({displayName:t,parent:"VPMReference",iconUrl:d.getIconURLFromKey(t),IconName:e.is(i)?i.IconName:""})}),n.forEach(e=>{const t=-1!==this.options.selectedTypes.indexOf(e.displayName),n=e.parent||e.displayName,i=-1!==this.options.baseTypes.indexOf(n)?"Reference":-1!==this.options.baseInstanceTypes.indexOf(n)?"Instance":"Unknown",o=new s({label:e.displayName,grid:{attrName:e.displayName,attrTitle:e.displayName,attrSel:!1,attrParent:i},icons:[e.iconUrl]});this.options.models.typesView.addRoot(o,t?0:void 0);let r=null;switch(i){case"Reference":r=this.options.maps.referenceTypes;break;case"Instance":r=this.options.maps.instanceTypes;break;default:r=null}r&&-1===r.indexOf(e)&&r.push(e)})},__updateExtensionsView:async function(){this.elements.loader.on(),this.elements.loaderDiv.removeClassName("hidden"),this.options.grids.extensionsView.getContent().addClassName("loading"),this.elements.nextButton.disabled=!0,this.options.wizard.getContent().addClassName("disabled"),this.options.models.extensionsView.removeRoots(),await this.__updateExtensionsViewModel(!0),this.elements.loader.off(),this.options.grids.extensionsView.getContent().removeClassName("loading"),this.elements.nextButton.disabled=!1,this.options.wizard.getContent().removeClassName("disabled")},__updateExtensionsViewModel:async function(){var t=this,n={classes:this.options.selectedTypes},i=new Map;var o={extensions:[],automaticExtensions:[]};g.webServiceRequest({url:"dictionary/interfaces",method:"POST",data:e.Json.encode(n),onComplete:function(n){n.results.forEach(function(t){var n=t.name;t.interfaces.forEach(function(t){var s;s=i.get(t.name),e.is(s)?o.extensions[s].declareIn.push(n):(t.declareIn=[n],o.extensions.push(t),i.set(t.name,o.extensions.length-1))})}),o.extensions.forEach(e=>{const n=-1!==t.options.selectedExtensions.indexOf(e.name);let i=!1,o=!1,r=[];e.declareIn.forEach(e=>{-1!==t.options.baseTypes.indexOf(e)&&(i=!0),-1!==t.options.baseInstanceTypes.indexOf(e)&&(o=!0),r.push(e)});let a="";a=!0===i&&!0===o?"Both":!0===i?"Reference":!0===o?"Instance":"Unknown",P.has(e.name)&&"Unknown"!==P.get(e.name)?P.set(e.name,"Both"):P.set(e.name,a);const l=new s({label:e.nlsName,grid:{attrName:e.name,attrTitle:e.nlsName,attrSel:n,attrInType:e.declareIn,attrInTypeNLS:r,attrParent:a}});t.options.models.extensionsView.addRoot(l,n?0:void 0)});const r=Reflect.ownKeys(o.automaticExtensions);t.options.automaticExtensions.push(...r)}})},__updateAttributesView:async function(){this.elements.loader.on(),this.elements.loaderDiv.removeClassName("hidden"),this.options.grids.attributesView.getContent().addClassName("loading"),this.elements.nextButton.disabled=!0,this.elements.nextButton.label=m.getNLSDone(),this.options.wizard.getContent().addClassName("disabled"),this.options.models.attributesView.removeRoots(),await this.__updateAttributesViewModel(!0),this.elements.loader.off(),this.options.grids.attributesView.getContent().removeClassName("loading"),this.elements.nextButton.disabled=!1,this.options.wizard.getContent().removeClassName("disabled")},__updateAttributesViewModel:async function(){var t=[],n=this,i=new Map;const o=[].concat(this.options.automaticExtensions).concat(this.options.selectedExtensions).concat(this.options.selectedTypes);payload={classes:o},g.webServiceRequest({url:"dictionary/class/properties",method:"POST",data:e.Json.encode(payload),onComplete:function(o){o.results.forEach(function(n){var o,s,r=!1;-1!==h.indexOf(n.name)&&(o="Reference"),-1!==C.indexOf(n.name)&&(o="Reference"===o?" Both":"Instance"),e.is(o)||(r=!0,"Unknown"!==(o=P.get(n.name))&&e.is(o)||(o="Reference")),s=n.name,n.properties.forEach(function(n){var a,l,c;n.instOrRef=o,n.from=[s],n.isFromExtension=r,"Both"===o?((c=JSON.parse(JSON.stringify(n))).instOrRef="Reference",a=i.get(c.name+c.instOrRef),e.is(a)?-1===t[a].from.indexOf(s)&&t[a].from.push(s):(t.push(c),i.set(c.name+c.instOrRef,t.length-1)),(l=JSON.parse(JSON.stringify(n))).instOrRef="Instance",a=i.get(l.name+l.instOrRef),e.is(a)?-1===t[a].from.indexOf(s)&&t[a].from.push(s):(t.push(l),i.set(l.name+l.instOrRef,t.length-1))):(a=i.get(n.name+o),e.is(a)?t[a].from.push(s):(t.push(n),i.set(n.name+o,t.length-1)))})}),t.forEach(e=>{var t,i,o,r=e.instOrRef;t=e.isFromExtension?e.from[0]+"."+e.name+"."+r.toLowerCase():e.name+"."+r.toLowerCase(),i=-1!==preSelectedAttributes.indexOf(t),o=-1!==unSelectableAttributes.indexOf(t);const a=new s({label:e.nlsName,grid:{attrName:e.name,dataIndex:t,attrTitle:e.nlsName,attrNature:e.from[0],attrSelectable:!0,attrSel:i,attrRO:o,attrInXML:i,attrParent:r,attrInType:e.from,attrInTypeNLS:e.from}});n.options.models.attributesView.addRoot(a,i?0:void 0)})}})}})}),define("DS/DELPPWViewPlugins/UXComponentsPlugin/InclusiveLineEditor",["UWA/Core","DS/Controls/SpinBox","DS/Controls/Toggle","DS/Controls/Abstract"],function(e,t,n,i){"use strict";var o;return i.inherit({name:"InclusiveLineEditor",init:function(e){o=e||{},this._parent(o)},buildView:function(){var i=this,s=o.value.value,r=o.value.inclusive,a=!e.is(r)||"NotSet"===r;i._unit="",this.elements.container.addClassName("inclusive-editor-group"),this._myInputGroup=new e.Element("div",{class:"inclusive-editor"}),this._inclusiveCheckbox=new n({type:"checkbox",label:"",checkFlag:!a}),this._inclusiveCheckbox.elements.container.addClassName("check-enabled"),this._inclusiveInput=new t({value:!a&&e.is(s)?Number(s):void 0,minValue:0,stepValue:o.step,units:o.unit,pageStepValue:1,displayStyle:"lite",disabled:a}),this._inclusiveInput.elements.container.addClassName("inclusive-input"),this._includeCheckBox=new n({type:"checkbox",label:"Included",checkFlag:"Included"===r,disabled:a}),this._includeCheckBox.elements.container.addClassName("check-included"),this._inclusiveCheckbox.inject(this._myInputGroup),this._inclusiveInput.inject(this._myInputGroup),this._includeCheckBox.inject(this._myInputGroup),this._myInputGroup.inject(this.elements.container),this._inclusiveCheckbox.addEventListener("change",function(e){e.dsModel.checkFlag?(i._includeCheckBox.disabled=!1,i._inclusiveInput.disabled=!1):(i._inclusiveInput.value=void 0,i._includeCheckBox.checkFlag=!1,i._includeCheckBox.disabled=!0,i._inclusiveInput.disabled=!0)}),this._inclusiveInput.addEventListener("input",function(e){0==e.target.value.length&&i._includeCheckBox.checkFlag&&(i._includeCheckBox.checkFlag=!1)})},setUnit:function(e){this._inclusiveInput.setProperties({units:e})},setValue:function(e){this._inclusiveCheckbox.checkFlag&&this._inclusiveInput.setProperties({value:Number(e)})},isSet:function(){return this._inclusiveCheckbox.checkFlag},getValue:function(){var e=this._inclusiveInput.value,t=this._includeCheckBox.checkFlag;return{value:e||"",inclusive:this._inclusiveCheckbox.checkFlag?t?"Included":"Excluded":"NotSet"}},getInputValue:function(){return this._inclusiveInput.value}})}),define("DS/DELPPWViewPlugins/UXComponentsPlugin/UnitsEditor",["UWA/Core","DS/Controls/LineEditor","css!DS/DELPPWViewPlugins/assets/css/UnitsEditor.css"],function(e,t){"use strict";return t.inherit({name:"UnitsEditor",buildView:function(){this.elements.container.addClassName("wux-controls-lineeditor custom-controls-unitseditor"),this._myInputGroup=new e.Element("div",{class:"input-group  unitseditor-input-group"}),this._myUnit=new e.Element("span",{class:"input-group-addon unitseditor-group-addon"}),this._myInput=new e.Element("input",{type:"text",tabindex:0,autocomplete:"off"}),this._myInput.inject(this._myInputGroup),this._myUnit.inject(this._myInputGroup),this._myInputGroup.inject(this.elements.container),this._myInput.addClassName("wux-ui-state-"+this.options.type),this._validFlag=!0,this.displayClearFieldButtonFlag&&this._layoutClearFieldButton()},setUnit:function(e){this._myUnit.setContent(e)},getUnit:function(){return this._myUnit.getText()},setInputName:function(e){this._myInput.name=e}})}),define("DS/DELPPWViewPlugins/TreeViewPlugin/CfgColumnsPlugin",["UWA/Core","UWA/Promise","text!DS/DELPPWViewPlugins/assets/json/CfgColumnsPlugin/AdditionalAMDs.json"],function(e,t,n){"use strict";const i=function(t,n){let i={...t};return e.extend(i,n,!0),i},o=function(e,t){return e.concat(t)};return function(s){const r=JSON.parse(n);let a=new Map,l=new Map,c=null;const u=function(t,n){const i=n||null;let o=new Map;return(...n)=>{const s=e.is(i,"function")?i(...n):n[0];let r;return o.has(s)?r=o.get(s):(r=t(...n),o.set(s,r)),r}}(t=>{let n=new Map;return Object.values(t).forEach(t=>{const i=t.amdModuleId;if(e.owns(t,"commandIds")){const e=t.commandIds;if(Array.isArray(e))for(const t of e)n.has(t)?n.set(t,n.get(t).concat(i)):n.set(t,[].concat(i))}}),n}),d=function(){return Array.from(a.values())},g=function(e){let t=[];for(const n of e)a.has(n)&&t.push(a.get(n));return t},m=function(e){return e.getManagedColumnNames()},f=function(e,t){l.set(e,t)},p=function(e){var t;(t=e,Array.from(t.entries())).map(([e,t])=>(function(e,t){return[e,t]})(e,m(t))).forEach(([e,t])=>{for(const n of t)f(n,e)})},h=function(n){var i;require((i=r,Object.values(i).map(e=>e.amdModulePath)),function(...i){const o=function(e,t){const n=Math.min(e.length,t.length);let i=[];for(let o=0;o<n;o++)i[o]=[e[o],t[o]];return i}((s=r,Object.values(s).map(e=>e.amdModuleId)),i).map(([e,n])=>((e,n)=>new t(t=>{n.isAdditionalColumnsAvailable(function(i){t({isAvailable:i,amdModuleId:e,amdModule:n})})}))(e,n));var s;t.all(o).then(t=>{!function(e){e.forEach(({amdModuleId:e,amdModule:t})=>{a.set(e,t)})}(t.filter(((t,n)=>i=>e.equals(i[t],n))("isAvailable",!0)).map((t=>n=>{let i={};for(const o of t)e.owns(n,o)&&(i[o]=n[o]);return i})(["amdModuleId","amdModule"]))),p(a),n()})})},C=function(e){const t=function(e){let t=[];return e.getAdditionalColumnsUXDGV(t),t}(e);return function(e,t){const n=Math.min(e.length,t.length);let i={};for(let o=0;o<n;o++)i[e[o]]=t[o];return i}(m(e),t)},P=function(){return d().map(e=>(function(e){return C(e)})(e)).reduce(i,{})},v=function(e,n){const o=n();let s;if(Array.isArray(o)){const n=o.map(n=>(n=>new t(function(t){n.updateAttributes(e,function(e){t(e)})}))(n));s=t.all(n).then(e=>{const n=e.reduce(i,{});return t.resolve(n)})}else s=t.reject("getAvailableAdditionalColumnAMDsSupplier is not returning Column AMDs");return s};return{name:"CfgColumnsPlugin",onStart:function(e){h(e)},onStop:function(){},getConfigColumns:function(){return P()},updateAttributes:function(t,n=null){let i;return i=e.is(n,"function")?v(t,n):v(t,d)},getUpdatedCfgAttributesBasedOnCommand:function(n,i){let o;if(e.is(i,"string")){const e=((e,t)=>e.has(t)?e.get(t):null)(u(r),i);o=Array.isArray(e)?v(n,()=>g(e)):t.reject("No valid Command to AMD Module Mapping")}else o=t.reject("No valid Command Name given");return o},getConfigColDataIndexSet:function(){let t;if(e.is(c))t=c;else{const e=d().map(e=>m(e)).reduce(o,[]);t=new Set(e),c=t}return t},isDataIndexAvailable:function(e){return this.getConfigColDataIndexSet().has(e)},getAdditionalColumnAMDsBasedOnDataIndices:function(e){const t=e.reduce((e,t)=>(l.has(t)&&e.add(l.get(t)),e),new Set);return t.size>0?g(t):[]},getColumnsFromPreferences:function(t){return function(t){const n=s.getPlugins("TreeViewPlugin");let i;if(e.is(n)){const o=n.instance.getViewColumnPreferences(t);i=e.is(o)?o.Columns.Column:[]}return i}(t)},getTypeRepresentations:function(){return d().map(e=>e.getTypeRepresentations()).reduce(i,{})}}}}),define("DS/DELPPWViewPlugins/TreeViewPlugin/LayoutPreferencesUI",["UWA/Core","DS/DELPPWResourceServices/ResourceUtils"],function(e,t){"use strict";return function(n,i,o,s,r){var a,l,c,u,d,g,m,f,p,h,C,P,v,S,I,w,b=0,y="widget-layout-block",D="button-container",L="border-selected",k="side-block",E="main-block",R=i.getComponent("Dialog"),x=i.getComponent("Button"),V=i.getComponent("Element"),A=i.getComponent("WUXDockAreaEnum"),T=Object.create(null),M=Object.create(null),O=Object.create(null),F=Object.create(null),N=n.getLayoutConfig();return e.merge(T,r.viewsInDockingZones),e.merge(M,r.viewsInFreeZone),d=function(e){var t,n,i,o=e.getRowColumnMap(),s=[];for(t=e.getRowIds().length,a=new Array(t),i=0;i<t;i++)n=o[i].length,s.push({columns:n}),a[i]=new Array(n);return s},g=function(e,t){t?e.hasClassName(L)||e.addClassName(L):e.hasClassName(L)&&e.removeClassName(L)},m=function(e,t,n){e.buttons[t].checkFlag=n,g(e.buttonContainer,n)},f=function(t,n,i,o){var s=a[t][n];e.is(s)&&m(s,i,o)},p=function(t,n,i){var o=O[t];e.is(o)&&m(o,n,i)},h=function(e,i,o){var s,r,a,l,c=[],u=function(e){var t=e.dsModel;!0===t.checkFlag?(c.some(function(e){var n=!1;return!0===e.checkFlag&&e.domId!==t.domId&&(e.checkFlag=!1,n=!0),n}),g(a,!0)):g(a,!1)};for(s=n.createBlocLayout({rows:[{columns:1}]}),a=new V("div",{class:D+" "+i}),l=0;l<o;l++)r=new x({type:"check",label:t.getNLSValue(i+".LayoutPreferencesUI."+F[i][l]),value:"button",onClick:u,domId:i+"-"+b++}),c.push(r),r.inject(a);return O[e]={buttons:c,buttonContainer:a,viewId:i},s.setColumnContent(0,0,a),s},C=function(n,i,o,s){var r,l,c,u=[],d=function(t){var n,i,o,s,r=t.dsModel;if(!0===r.checkFlag)u.some(function(e){var t=!1;return!0===e.checkFlag&&e.domId!==r.domId&&(e.checkFlag=!1,t=!0),t}),g(c,!0);else{for(n=!0,o=0;o<a.length;o++)for(s=0;s<a[o].length;s++)e.is(a[o][s])&&(i=a[o][s].buttons.every(function(e){return!1===e.checkFlag}),n=n&&i);n?r.checkFlag=!0:g(c,!1)}};for(c=new V("div",{class:D+" "+o}),l=0;l<s;l++)r=new x({type:"check",label:t.getNLSValue(o+".LayoutPreferencesUI."+F[o][l]),value:"button",onClick:d,domId:o+"-"+b++}),u.push(r),r.inject(c);a[n][i]={buttons:u,buttonContainer:c,viewId:o}},P=function(){var t,i,o,s,r,g,m,f;for(t in T)switch(o=(i=T[t]).views.length,F[t]=i.views,i.dockArea){case A.LeftDockArea:c=h(i.dockArea,t,o);break;case A.RightDockArea:u=h(i.dockArea,t,o)}for(t in g=n.getBlocLayout(),r=d(g),M)i=M[t],e.is(i.views,"array")&&i.views.length>0&&(o=i.views.length,F[t]=i.views,s=N[t],e.is(s)&&C(s.row,s.col,t,o));for(l=n.createBlocLayout({rows:r}),m=0;m<a.length;m++)for(f=0;f<a[m].length;f++)e.is(a[m][f])&&l.setColumnContent(m,f,a[m][f].buttonContainer)},v=function(){M=null,a=null,T=null,O=null,F=null},S=function(){var t,n,i,o={};for(t in T)o[t]="";for(t in M)i=M[t],e.is(i.views,"array")&&i.views.length>0&&(n=i.views[0],o[t]=n);return o},I=function(){var t,n,i,o,r,a=function(e,t){var n,i,o=e.length;for(i=0;i<o;i++)if(e[i]===t){n=i;break}return n};for(t in s)if(s.hasOwnProperty(t)){if(""===(n=s[t]))continue;r=a(F[t],n),e.is(T[t])?p(T[t].dockArea,r,!0):(o=M[t],e.is(o)&&e.is(o.views)&&(i=N[t],f(i.row,i.col,r,!0)))}},w=function(n){var s,r,a=new V("div",{class:y}),d=function(e,t){var n;n=new V("div",{class:t}),e.inject(n),n.inject(a)};return P(),e.is(O[A.LeftDockArea])&&d(c,k),d(l,E),e.is(O[A.RightDockArea])&&d(u,k),r=i.getComponent("WUXFrameWindowsManager").getFrameWindow(o),(s=new R({domId:"LayoutPreferencesUI-Dialog",immersiveFrame:r.getImmersiveFrame(),modalFlag:!0,visibleFlag:!1,snappableFlag:!1,title:t.getNLSValue("LayoutPreferencesUI.Header"),content:a,resizableFlag:!0,buttons:{Ok:new x({className:"ok primary",label:t.getNLSValue("LayoutPreferencesUI.Ok"),emphasize:"primary",onClick:function(){e.is(n,"function")&&n(),s.close()}}),Cancel:new x({className:"cancel",label:t.getNLSValue("LayoutPreferencesUI.Cancel"),onClick:function(){s.close()}})}})).close=function(){s.destroy(),a=null,v()},s},{name:"LayoutPreferencesUI",showDialog:function(t){var n;n=w(t),e.is(s)||(s=S()),I(),n.show()},decipherPreferencesFromButtonStates:function(){var t,n,i,o,s,r={},l=function(e){var t=F[e];r[e]="",n.forEach(function(n,i){var o,s=i,a=n.checkFlag;o=t[s],!0===a&&(r[e]=o)})};for(t in O)i=O[t].viewId,n=O[t].buttons,l(i);for(o=0;o<a.length;o++)for(s=0;s<a[o].length;s++)e.is(a[o][s])&&(i=a[o][s].viewId,n=a[o][s].buttons,l(i));return r}}}}),define("DS/DELPPWViewPlugins/UXComponentsPlugin/PPRDataGridView",["UWA/Core","DS/DataGridView/DataGridView","css!DS/DELPPWViewPlugins/assets/css/DataGridView.css"],function(e,t){"use strict";function n(e){return-1===e.rowID&&e.columnID>=0}return t.extend({name:"PPRDataGridView",init:function(t){this._parent(t),this.layout.cellHeight=e.is(t.cellHeight)?t.cellHeight:32,this.layout.columnHeaderHeight=e.is(t.columnHeaderHeight)?t.columnHeaderHeight:32},registerColumnsEnum:function(){var t=this.getTypeRepresentationFactory();this.columns.forEach(function(n){e.is(n.hasRangeDefined)&&n.hasRangeDefined&&t.registerEnum(n.dataIndex.replaceAll(".",""),n.authorizedValues)})},registerColumnTypeRepresentations:function(e){this.getTypeRepresentationFactory().registerTypeRepresentations(e)},updateNodeKPIColor:function(e){this.showNodeKPIColorFlag=e},getColumnIndexByDataIndex:function(e){return this.layout.getColumnIndex(e)},setColumnWidth:function(e,t){this.layout.setColumnWidth(e,t)},isColumnHidden:function(e){return!this.layout.getColumnVisibleState(e)},hideColumn:function(e,t){this.layout.setColumnVisibleFlag(e,!1,t)},setColumnOptions:function(t,n){-1!==t&&("string"==typeof t&&(t=this.getColumnIndexByDataIndex(t)),e.extend(this.columns[t],n))},showColumn:function(e){this.layout.setColumnVisibleFlag(e,!0)},getColumnMinWidth:function(e){return this.layout.getColumnOptionValue(e,"minWidth")},getColumnWidth:function(e){return this.layout.getColumnOptionValue(e,"width")},moveColumn:function(e,t){this.layout.moveColumn(e,t)},_requestCellContent:function(e){var t;e.isHeader=n(e),(t=e.cellView.collectionView.getColumnOrGroup(e.columnID))&&(e.dataIndex=t.dataIndex),this._parent(e)},_setTweakerForCell:function(e){this._parent(e,{touchMode:!1})},sortColumn:function(e,t){this.sortModel=[{dataIndex:e,sort:t}],this._applySortModel()},clearSort:function(){this.sortModel=[{}],this._applySortModel()},getLightCellInfosAt:function(e){var t,i=this._parent(e);return i.isHeader=n(i),(t=this.getColumnOrGroup(i.columnID))&&(i.dataIndex=t.dataIndex),i},getLayout:function(){return this.layout}})}),define("DS/DELPPWViewPlugins/KeyBindingPlugin",[],function(){"use strict";return function(e){return{name:"KeyBindingPlugin",createHandler:function(t){var n,i=this,o=e.getLogger();n=function(e){var n,s,r;(e=e||window.event)?(n=e.keyCode,s=e.ctrlKey||e.metaKey,r=e.shiftKey,s&&67===n?t.onCtrlC&&t.onCtrlC(e):s&&86===n?t.onCtrlV&&t.onCtrlV(e):s&&88===n?t.onCtrlX&&t.onCtrlX(e):46===n?t.onSuppr&&t.onSuppr(e):8===n?t.onBackspace&&t.onBackspace(e):s&&65===n?t.onCtrlA&&t.onCtrlA(e):r&&9===n?t.onShiftTab&&t.onShiftTab(e):9===n?t.onTab&&t.onTab(e):40===n?t.onDownArrow&&t.onDownArrow(e):38===n&&t.onUpArrow&&t.onUpArrow(e)):o.debug(i.name,"could not get event from keydown event")},(t=t||{}).domElement?t.domElement.onkeydown=n:o.debug(i.name,"No dom element given to listen key bindings on. Exiting")},onStart:function(){},onStop:function(){}}}}),define("DS/DELPPWViewPlugins/TreeViewPlugin/RootsStoreUI",["UWA/Core","DS/DELPPWResourceServices/ResourceUtils"],function(e,t){"use strict";return function(n,i,o,s){var r,a=o.getComponent("Button"),l=o.getComponent("LineEditor"),c=o.getComponent("ComboBox"),u=o.getComponent("Element"),d=function(e){return new u("div",e)},g=d({class:"ViewPreferencesUI-TabContent store-view-container"});return r=function e(){var o,r,u,m,f,p,h,C=s.getStoresList(),P=function(){-1<C.indexOf(m.value)?(p.show(),h.show()):(p.hide(),h.hide())},v=function(){var e=m.value;""!==e&&i.getMediator().notify("LoadRecentContent",{store:e}),n.buttons.Ok.fire("buttonclick")},S=function(){var t=m.value;""!==t&&s.removeStore(t),g.empty(!0),e()};o=d({class:"store-view-div"}),(u=new l({placeholder:t.getNLSValue("RootsStoreUI.Store_name.Title")}).inject(o)).getContent().addClassName("store-view-control"),u.addEventListener("uncommittedChange",function(){""!==u._myInput.value?f.show():f.hide()}),(f=new a({label:t.getNLSValue("RootsStoreUI.Save_views.Title"),onClick:function(){var t=u.value;""!==t&&(s.createStore(t),g.empty(),e())}}).inject(o)).getContent().addClassName("store-view-btn"),f.hide(),o.inject(g),(C=s.getStoresList()).length>0&&(r=d({class:"store-view-div"}),(m=new c({elementsList:C,placeholder:t.getNLSValue("RootsStoreUI.Store_select.Placeholder"),currentValue:"Default",enableSearchFlag:!0,reachablePlaceholderFlag:!0}).inject(r)).getContent().addClassName("store-view-control"),m.addEventListener("change",P),(p=new a({label:t.getNLSValue("RootsStoreUI.Load_store.Title"),onClick:v}).inject(r)).getContent().addClassName("store-view-btn"),(h=new a({label:t.getNLSValue("RootsStoreUI.Remove_store.Title"),onClick:S}).inject(r)).getContent().addClassName("store-view-btn"),p.hide(),h.hide(),r.inject(g))},e.is(n)&&r(),{getContent:function(){return g}}}}),define("DS/DELPPWViewPlugins/SearchPlugin/SearchPlugin",["UWA/Core","UWA/Utils/InterCom","DS/PlatformAPI/PlatformAPI"],function(e,t,n){"use strict";return function(i){var o,s,r,a,l,c,u;return r=function(t,n,i){var s={};return s.title=t,s.mode="furtive",s.app_socket_id=o,s.widget_id=widget.id,s.default_with_precond=!0,s.show_precond=!1,s.source=["3dspace"],s.default_search_criteria="",s.precond="",e.is(i,"array")&&i.forEach(function(e){""!==s.default_search_criteria&&(s.default_search_criteria+=" OR "),s.default_search_criteria+=e}),e.is(n,"array")&&(n.forEach(function(e){""!==s.precond&&(s.precond+=" OR "),s.precond+='flattenedtaxonomies:"types/'+e+'"'}),s.precond="("+s.precond+")"),s},a=function(e){var t={};t.widget_id=widget.id,s.dispatchEvent("unregisterSearchContext",t),s.dispatchEvent("RegisterContext",e),s.addListener("onCloseTransient",function(){s.removeListener("onCloseTransient")})},l=function(){var e={widget_id:widget.id};s.dispatchEvent("unregisterSearchContext",e),s.dispatchEvent("UnregisterContext",e),s.unsubscribeServer("SearchComServer"),s.removeListener("Selected_Objects_search",c),s.disconnect()},c=function(t){e.is(u)&&u(t)},{name:"SearchPlugin",onStart:function(){o="search_socket_"+(new Date).getTime(),(s=new t.Socket(o,{dispatchRetryInterval:5})).addListener("Selected_Objects_search",c),s.subscribeServer("SearchComServer")},onStop:function(){l()},activate:function(t,n,i,o){var l;e.is(i)&&(i=e.is(i,"array")?i:[i]),l=r(t,i,o),e.is(n,"function")||(l.mode="default"),u=n,a(l),s.dispatchEvent("InContextSearch",l)},subscribeToSelectEvent:function(e){n.subscribe("DS/PADUtils/PADCommandProxy/select",e)}}}}),define("DS/DELPPWViewPlugins/UXComponentsPlugin/ExtendedCustomDialog",["UWA/Core","DS/Windows/Dialog"],function(e,t){"use strict";var n,i=null;return t.extend({name:"CustomDialog",init:function(e){n=e||{},this._parent(n)},_setup:function(t){this.clearMessages(),i=new e.Element("div",{class:"custom-dialog-message-container"}),new e.Element("span",{class:t.iconSpanClass}).inject(i),new e.Element("span",{class:t.textSpanClass}).inject(i).innerHTML=t.message,e.is(n.content,"string")||i.inject(n.content)},error:function(t){this._setup({iconSpanClass:"wux-notification-icon wux-ui-3ds wux-ui-3ds-attention",textSpanClass:"custom-dialog-error-message",message:t}),e.is(n.buttons.Ok)&&(n.buttons.Ok.disabled=!0)},info:function(t){this._setup({iconSpanClass:"wux-notification-icon wux-ui-3ds wux-ui-3ds-info",textSpanClass:"custom-dialog-info-message",message:t}),e.is(n.buttons.Ok)&&(n.buttons.Ok.disabled=!1)},warning:function(t){this._setup({iconSpanClass:"wux-notification-icon wux-ui-3ds wux-ui-3ds-alert",textSpanClass:"custom-dialog-warn-message",message:t}),e.is(n.buttons.Ok)&&(n.buttons.Ok.disabled=!1)},clearMessages:function(){e.is(i)&&i.destroy()}})}),define("DS/DELPPWViewPlugins/SelectionPlugin/SelectionPlugin",["UWA/Core","UWA/Json"],function(e,t){"use strict";return function(n){var i,o,s,r,a,l={},c=n.getConfig().resource.selectionMappingPath;return r=function(t){var i,o,r,a=[],c=[];if(!e.is(s)||!e.is(t))return a;if(i=s[t],e.is(i,"array"))for(r=0;r<i.length;r++)o=i[r],e.is(o,"string")?(c=[],e.is(l[o])&&(c=l[o].map(function(e){return e.id})),a.push(c||[])):n.getLogger().debug("ModuleId is invalid in selection mapping. ModuleId:"+o);return a},a=function(t){var i,o,r,a=[],c=[];if(!e.is(s)||!e.is(t))return a;if(i=s[t],e.is(i,"array"))for(r=0;r<i.length;r++)o=i[r],e.is(o,"string")?(c=[],e.is(l[o])&&(c=l[o].map(function(e){return e})),a.push(c||[])):n.getLogger().debug("ModuleId is invalid in selection mapping. ModuleId:"+o);return a},{name:"SelectionPlugin",onStart:function(r){o=Object.create(null),require(["text!"+c],function(o){e.is(o)?(i=e.is(o,"string")?t.decode(o):o)&&(s=i.selection):n.getLogger().debug("Selection mapping is not defined."),r()})},onStop:function(){l={},o=null},setSelection:function(t,n){e.is(t)&&(l[t]=n)},getSelections:function(t){return e.is(t)?r(t):null},getSelectionsWithPaths:function(t){return e.is(t)?a(t):null},getSelectionMapping:function(t){var n=null;return e.is(t)&&Object.prototype.hasOwnProperty.call(s,t)&&(n=s[t]),n},removeFromHighlightMap:function(e){delete o[e.toString()]},setNodeIdsToHighlight:function(e,t){o[e.toString()]=t},getNodeIdsToHighlight:function(e){return o[e.toString()]},getSelectedNodesCount:function(t){var n,i=this.getSelections(t),o=0;if(e.is(i,"array"))for(n=0;n<i.length;n++)o+=i[n].length;return o},getModuleSelections:function(t){var n=[];return e.is(l[t])&&(n=l[t]),n}}}}),define("DS/DELPPWViewPlugins/View",["UWA/Core","UWA/Controls/Abstract","UWA/Element"],function(e,t,n){"use strict";return function(i){return t.extend({init:function(e){this._parent(e),this.container=new n("div",{class:e?e.class?e.class:"":"view-container"}),this.elements={},this.setup.apply(this,arguments)},setup:function(){},render:function(){return this},setContainer:function(t){var i;if(t instanceof n)this.container=t;else if("element"===(i=e.typeOf(t)))this.container=e.extendElement(t);else{if("object"!==i)throw new Error("Invalid type of container");this.container=e.createElement(t.tag,t)}},destroy:function(){this._parent()}})}}),define("DS/DELPPWViewPlugins/Viewer3DPlugin",["UWA/Core","DS/PlatformAPI/PlatformAPI","DS/DELPPWModelServices/CollectionUtils"],function(e,t,n){"use strict";return function(i){var o,s,r,a,l,c,u,d="drop",g="remove",m="applyFilter",f="select",p="cleanAll",h="toggleVisibility",C="unHideAll",P="exclusiveShow",v="resetViewer",S="Reframe",I="Show",w="Hide",b="Highlight",y="RemoveAll",D=i.getConfig().appContext.widget.getId(),L=[],k=[];return o=function(t){var n,o=[];return n=function(){var t,n;return t=widget.getValue("x3dSharedId"),e.is(t)||(n=i.getConfig().appContext,e.is(n)&&e.is(n.widget)&&e.is(n.widget.data)&&(t=n.widget.data.app3DSharedId)),t}(),e.is(n)&&o.push(n),o.concat(t,"MFNMGA").join("/")},s=function(n,i){var s=o(n),r=i||{};e.merge(r,{originWidgetId:D}),t.publish(s,r)},r=function(){s(p,null)},l=function(t){var n,i,o,s,r,a,l=[];if(e.is(t.data.paths)&&e.is(t.data.attributes))for(o=t.data.paths,s=t.data.attributes,n=0;n<=o.length-1;n++){for(r=o[n],a=[],i=0;i<=r.length-1;i++)"VPMReference"===s[r[i]].type&&a.push(r[i]);l.push(a)}else l=t.data.paths;return l},c=function(e,t){var n,i=null;for(n=t.length-1;n>=0&&null===(i=e.getNodeModel(t[n],!0));n--);return i},a=function(t){var n,o=i.getBehavior("EBOM","WUXNodeModelBehavior"),s=i.getBehavior("EBOM","CrossHighlightBehavior"),r=t.data.paths;e.is(t.metadata)&&(e.is(t.metadata)&&e.is(t.metadata.originWidgetId)&&D===t.metadata.originWidgetId||e.is(t.metadata.fromWidget)||(0===r.length?o.getSelectedNodes().forEach(function(e){e.from3DViewer=!0,e.unselect(),s.crossHighlightFrom3DViewer([e.getID()],e.getAbsolutePath(),!1)}):l(t).forEach(function(t){e.is(t,"array")&&(n=c(o,t),e.is(n)&&(n.from3DViewer=!0,o.selectNode(n.getID()),s.crossHighlightFrom3DViewer([n.getID()],n.getAbsolutePath(),!0)))})))},u=function(t,n){let o=i.getPlugins("InterWidgetComPlugin");e.is(o)&&(o=o.instance).isWidgetLinked("DELOER_AP")&&o.publishEvent("DS/DELExternalWidgetCom/"+t,n)},{name:"Viewer3DPlugin",onStart:function(){L.push(i.addExternalListener("refreshAll",r)),t.subscribe("DS/PADUtils/PADCommandProxy/select",a)},onStop:function(){for(;L.length>0;)i.removeExternalListener(L.pop())},generateInterWidgetEventName:function(e){return o(e)},drop3D:function(t,n){var i=d,o=n||{},r=e.is(o.filterQuery3d)?o.filterQuery3d:null,a=e.is(o.usePaths)?o.usePaths:null;k=t,s(i,{rootReferenceIds:t,filterQuery3d:r,usePaths:a})},remove3D:function(t,n){var o=g,r=n||{},a=!1,l={rootReferenceIds:t,usePaths:e.is(r.usePaths)?r.usePaths:null};const c=i.getService("ConfigService");if(e.is(c)){const n=c.getPreference("MfgItem3DViewerModule_Preferences");if(e.is(n)){const i=n.loadedObjInfos;e.is(i)&&(a=t.some(function(e){let t=!1;return e!==i.rootPID&&e!==i.scopedPrdPID||(t=!0),t}))}}a&&u(y,{items:[{id:t}]}),s(o,l)},apply3DFilter:function(t,n,i){var o=m,r=i||{},a=!!e.is(r.removeFilter,"boolean")&&r.removeFilter;s(o,{rootReferenceIds:t,filterQuery3d:n,removeFilter:a})},selectIn3D:function(e,t){var i,o,r=f;return i=e.map(function(e){return n.transformToRIROccurrencePath(e)}),o=!0===t?{occRIRPaths:e}:{occRIRPaths:i},u(b,{path:i,clear:!0}),s(r,o),o},cleanAll:function(){s(p,null)},exclusiveShow:function(e){s(P,e)},change3DVisibility:function(e,t){var i,o,r=h;o={occRIRPaths:i=e.map(function(e){return n.transformToRIROccurrencePath(e)}),toShow:t},u(t?I:w,{path:i}),s(r,o)},resetViewer:function(){s(v,null)},unHideAll3D:function(){s(C,null)},getRoots:function(){return k},reframeIn3DViewer:function(e){const t=e.map(function(e){return n.transformToRIROccurrencePath(e)});u(S,{path:t})}}}}),define("DS/DELPPWViewPlugins/UXComponentsPlugin/RichTextEditor",["UWA/Core","DS/CKEditor/CKEditor","DS/Controls/Abstract","DS/DELPPWResourceServices/ResourceUtils","css!DS/DELPPWViewPlugins/assets/css/RichTextEditor.css"],function(e,t,n,i){"use strict";return n.inherit({name:"RichTextEditor",_editorContainer:null,_editorOptions:null,init:function(t){t=t||{},this._editorOptions=e.is(t.editorOptions)?t.editorOptions:{},this._parent(t)},buildView:function(){this.elements.container.addClassName("wux-richTextEditor-mainContainer"),this._editorContainer=new e.Element("div",{class:"wux-richTextEditor-editorContainer"}),this._editorContainer.inject(this.elements.container),this._editor=t.replace(this._editorContainer,e.merge(this._editorOptions,{width:"100%",height:"300px",language:widget.lang,toolbar:[{name:"document",items:["Print","-","Templates"]},{name:"clipboard",items:["Cut","Copy","-","Undo","Redo"]},{name:"editing",items:["Find","Replace"]},{name:"basicstyles",items:["Bold","Italic","Underline","Strike","Subscript","Superscript","-","CopyFormatting","RemoveFormat"]},"/",{name:"paragraph",items:["JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock","-","NumberedList","BulletedList","-","BidiLtr","BidiRtl"]},{name:"links",items:["Link","Unlink","Anchor"]},{name:"insert",items:["SpecialChar","Image","Table","HorizontalRule","InsertLocalImage"]},"/",{name:"styles",items:["Font","FontSize"]},{name:"colors",items:["TextColor","BGColor"]}],extraPlugins:"tableresize"})),this._addCustomCommands(),this._editor.on("instanceReady",function(e){e.editor.removeMenuItem("paste")})},_addCustomCommands:function(){var t=this;this._editor.addCommand("InsertLocalImage",{exec:function(n){var i=new e.Element("input",{attributes:{type:"file",accept:"image/*"},styles:{display:"none"},events:{change:function(){var t=this.files[0],i=new FileReader;i.onload=function(){var o=new e.Element("img");o.src=i.result,o.alt=t.name,n.insertHtml(o.outerHTML)},i.readAsDataURL(t)}}});i.multiple=!1,i.inject(t.elements.container),i.click()}}),this._editor.ui.addButton("InsertLocalImage",{label:i.getNLSValue("RichTextEditor.Command.InsertLocalImage.Title"),command:"InsertLocalImage",toolbar:"insert",icon:i.getIconURLFromKey("ImageUpload")})},getData:function(){var e="";return(e=(e=(e=(e=e.concat('<?xml version="1.0" encoding="UTF-8" ?>↵<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><head><title>Html export</title></head>')).concat("<body>")).concat(this._editor.getData())).concat("</body></html>")).match(/(.|[\r\8000]){1,8000}/g)},setData:function(e){var t,n=e.indexOf("<body>"),i=e.indexOf("</body>");n>-1&&i>-1&&(t=e.slice(n+6,i),this._editor.setData(t))}})}),define("DS/DELPPWViewPlugins/TreeViewPlugin/PlatformPlugin",["UWA/Core","UWA/Class","DS/DELPPWModelServices/BehaviorUtil"],function(e,t,n){"use strict";return function(){return{name:"PlatformPlugin",isNewDragNDrop:function(){return n.isNewDragNDrop()},shouldLoadRootOnly:function(){return n.shouldLoadRootOnly()},isCloud:function(){return n.isCloud()},useRootStorage:function(){return n.useRootStorage()},isSwipeableMenuPrefDisplayed:function(){return n.isSwipeableMenuPrefDisplayed()},isNavigateOnIndexedDBPrefDisplayed:function(){return n.isNavigateOnIndexedDBPrefDisplayed()},isDialogDisplayedAtDDinCaseOfMove:function(){return n.isDialogDisplayedAtDDinCaseOfMove()},isSuppressHideShow3DColumn:function(){return n.isSuppressHideShow3DColumn()},isExpandFetchFetchEnabled:function(){return n.isExpandFetchFetchEnabled()},isInsertButtonInInsertCmdDisplayed:function(){return n.isInsertButtonInInsertCmdDisplayed()},displayDocumentManagementCmds:function(){return n.displayDocumentManagementCmds()},isDescHighlightFromEBOMEnabled:function(){return n.isDescHighlightFromEBOMEnabled()},isChangeRequiredSyncronizationEnabled:function(){return n.isChangeRequiredSyncronizationEnabled()},isResultingProductSyncronizationEnabled:function(){return n.isResultingProductSyncronizationEnabled()},isMGALoadRelationsOnDemand:function(){return n.shouldLoadRelationsOnDemand()},isLoadOOTBProcedures:function(){return n.shouldLoadOOTBProcedures()}}}}),define("DS/DELPPWViewPlugins/ImplementPlugin/ProductImplementPlugin",["UWA/Core","DS/DELPPWModelServices/ModelUtils","DS/DELPPWModelServices/CollectionUtils","DS/DELPPWWebServices/WebserviceUtils","DS/DELPPWNavigationServices/NavigateUtil","DS/DELPPWViewPlugins/ImplementPlugin/ImplementBase"],function(e,t,n,i,o,s){"use strict";return function(r){var a,l,c,u="ProductImplementPlugin",d="ProductImplementLink",g=function(t,n,i,o){var s,r=o||{};e.is(i)&&(a.debug(u,t+"failed with error: %s ",JSON.stringify(i)),e.is(i.message,"string")&&(s=i.message)),e.is(r.onFailure,"function")&&r.onFailure(n,s)};return l=new s(r.getLogger(),d,"PartialProductImplementLink","ProductImplementLinkOcc","ResultingProductLink",!1),c=function(t,i){var o=i||{},s={onComplete:function(t){e.is(o)&&e.is(o.onComplete)&&o.onComplete("ImplementPlugin.DeleteScope.Success",t)},onFailure:function(n,i){e.is(o.onFailure)&&g("Delete scope link for id:"+t,"ImplementPlugin.DeleteScope.Failed",i,o)}};e.is(t)?n.deleteConn(t,s):o.onFailure("Connection ID is not valid.")},e.extend(l,{onStart:function(){a=r.getLogger()},getImplLinksOfImplemented:function(t){var i,o,s=Object.create(null),r=t.length,a=null;if(Array.isArray(t)){for(i=1;i<=r;i++)o=t.slice(r-i),s[o.length.toString()]=o;a=l.filterImplementLinks(function(t,n){var i=s[n.length.toString()],o=!1;return e.is(i)&&(o=e.equals(i,n)),o}).filter(function(t){var i=t.get("from"),o=!1;return e.is(i,"string")&&(o=n.isInstance(i)),o})}return a},getScopeLinksOfImplementing:function(e,t){var n,i=[];return n=l.getScopeLinks(e,d,t),Array.isArray(n)&&(1===n.length?i=n:n.length>1&&a.debug(u,"ERROR: getScopeLinksOfImplementing found more than one scope link for MfgItem: "+e)),i},getPartialScopeLinksOfImplementing:function(e,t){var n,i=[];return n=l.getPartialScopeLinks(e,"PartialProductImplementLink",t),Array.isArray(n)&&(1===n.length?i=n:n.length>1&&a.debug(u,"ERROR: getPartialScopeLinksOfImplementing found more than one scope link for MfgItem: "+e)),i},deleteScopeLink:function(e,t){c(e,t)},consumeImplementedItems:function(s,a,l,c,u){var d=u||{},m={rootProductID:s,productOccPaths:a,rootMfgItemID:l,targetMfgItemID:c,expandBy:t.getNavigateOnIndex()?"index":"database",computeResultReport:!!e.is(u.computeResultReport)&&u.computeResultReport},f=function(e,t){g("Create mbom from ebom","ImplementPlugin.Consumption.Failed",t,d)},p={url:"dsmfg/private/V0/invoke/MfgItem/CreateMBOMFromEBOM",method:"POST",context:this,headers:i.getHeaders({isAuthoringCtx:!0,isJsonOnly:!0}),data:e.Json.encode(m),onComplete:function(t){var i,s,a=[],l=o.getConnectionParser(),c={stackedReferences:[],stackedInstances:[],stackedConnections:[],onComplete:function(n){var i=[],o=[],s=r.getPlugins("BIPlugin");e.is(n.instancesAndReferences,"array")&&n.instancesAndReferences.length>0&&(n.instancesAndReferences.forEach(function(e){e.isInstance()?i.push(e):o.push(e)}),i.length>0&&r.getMediator().notify("addInstance",[i]),o.length>0&&r.getMediator().notify("changeReference",[o])),e.is(s)&&(s=s.instance).getBICmdState()&&s.computeBI(),e.is(d.onComplete,"function")&&(d.onComplete("ImplementPlugin.Consumption.Success",n,t),r.getMediator().notify("consumeProductOnDragAndDrop"))},onFailure:f};e.is(t)&&e.is(t.instancesAndReferences,"array")&&e.is(t.connections,"array")&&t.connections.length>0?(t.instancesAndReferences.forEach(function(t){var n=e.is(t.attributesValue)?t.attributesValue:t;Object.prototype.hasOwnProperty.call(n,"isInstanceOf")?c.stackedInstances.push(t):(c.stackedReferences.push(t),a.push(n.PID))}),t.connections.forEach(function(e){l.parse(e,c)}),e.is(t.reusedReferences)&&(i=t.reusedReferences.filter(function(t){var i=e.is(n.getReferenceFromCollection(t)),o=-1!==a.indexOf(t);return!(i||o)})),s=function(){n.addToCollections(c)},e.is(i,"array")&&i.length>0?o.getDescendantsFromServer(i,s,{expandLevel:0,silentMode:!0}):s()):e.is(d.onComplete,"function")&&d.onComplete("ImplementPlugin.Consumption.Failed",null,t)},onFailure:f,onTimeout:f,onCancel:f};i.webServiceRequest(p)},createScopeAndImplementLink:function(t,s,a,l,c){var u,d=c||{},m={productID:a,processID:t,processInstancePID:s,productPath:e.Json.encode(l)},f=function(e,t){g("Create scope and implement link","ImplementPlugin.CreateScope.Failed",t,d)};u={url:"dsmfg/private/V0/invoke/createscopeandimplementlink",method:"POST",headers:i.getHeaders({isAuthoringCtx:!0,isJsonOnly:!0}),data:e.Json.encode(m),onFailure:f,onTimeout:f,onCancel:f,onComplete:function(t){var i=o.getConnectionParser(),s={stackedReferences:[],stackedInstances:[],stackedConnections:[],onComplete:function(t){var n=[];e.is(t.instancesAndReferences,"array")&&t.instancesAndReferences.length>0&&(t.instancesAndReferences.forEach(function(e){e.isReference()&&n.push(e)}),n.length>0&&r.getMediator().notify("changeReference",[n])),e.is(t.connections,"array")&&t.connections.length>0&&(r.getMediator().notify("addConnection",[t.connections]),e.is(d.onComplete,"function")&&d.onComplete("ImplementPlugin.CreateScope.Success",t))}};e.is(t)&&e.is(t.instancesAndReferences,"array")&&e.is(t.connections,"array")&&t.connections.length>0?(t.instancesAndReferences.forEach(function(t){var n=e.is(t.attributesValue)?t.attributesValue:t;Object.prototype.hasOwnProperty.call(n,"isInstanceOf")?s.stackedInstances.push(t):s.stackedReferences.push(t)}),t.connections.forEach(function(e){i.parse(e,s)}),n.addToCollections(s)):f()}},i.webServiceRequest(u)},canCreateScopeLink:function(t,n){var i,o,s,a=d,l=!0,c=r.getPlugins("ResourcePlugin").instance;return i=t.fromSideRefPID,this.isScoped(i)&&(l=!1),e.is(t.fromSideInstPID)&&e.is(t.toSideInstPID)?(o=t.fromSideInstPID,s=t.toSideInstPID):(o=t.fromSideRefPID,s=t.toSideRefPID),n?{canCreateLink:l,data:{type:a,implementingPID:o,implementedPID:s,implementingAbsPath:t.fromSideAbsPath,implementedAbsPath:t.toSideAbsPath,displayText:c.getNLSValue(a,null,"CreateLink"),buttonIdentifier:c.getNLSValue(a,null,"CreateLink")}}:l},canCreateResultingProductLink:function(t){var n,i="ResultingProductLink",o=t.fromSideRefPID,s=t.toSideRefPID,a=r.getPlugins("ResourcePlugin").instance,l=!0,c={};return n=o,!0===this.isResultingLinked(n)&&(l=!1),c={canCreateLink:l},l&&(c.data=e.merge({type:i,IDFrom:o,IDTo:s,displayText:a.getNLSValue(i,null,"CreateLink"),buttonIdentifier:a.getNLSValue(i,null,"CreateLink")},e.clone(t))),c},getImplLinksOfImplementing:function(e){var t,n,i=[];return Array.isArray(e)&&e.length>0?(t=e[e.length-1],n=this.filterImplementLinks(function(e){return t===e}),Array.isArray(n)&&(1===n.length?i=n:n.length>1&&(a.debug(u,"ERROR: getImplLinksOfImplementing found more than one implement link for MfgItem: "+e),i=null))):i=null,i},canCreateImplementLink:function(t){var n,i,o,s="ProductImplementLinkOcc",a=r.getPlugins("ResourcePlugin").instance,l={};return n=t.fromSideAbsPath,i=t.toSideAbsPath,l={canCreateLink:o=this.isImplementLinkPossible(n,i)},o&&(l.data=e.merge({type:s,implementingAbsPath:n,implementedAbsPath:i,displayText:a.getNLSValue(s,null,"CreateLink"),buttonIdentifier:a.getNLSValue(s,null,"CreateLink")},e.clone(t))),l},isImplementLinkPossible:function(t,i){var o,s,r=!1,a=null;return e.is(t,"array")&&t.length>0&&e.is(i,"array")&&i.length>0&&(o=this.getScopedParent(t),s=this.getScopedParent(i),e.is(o)&&e.is(s)&&!0===(r=n.hasConnection({to:s,from:o,type:d}))&&(a=this.getImplLinksOfImplementing(t),Array.isArray(a)&&a.length>0&&(r=!1))),r},validateIfScoped:function(t,i){var o,s,r,a,l,c,u,d,g=!1,m=function(e,t){return e.some(function(e){return t(e.get("from"))})};if(e.is(t,"array")&&t.length>0?(s=n.getInstanceFromCollection(t[t.length-1]),r=s.get("isInstanceOf"),a=this.getScopeLinks(r),e.is(a,"array")&&0===a.length&&(r=this.getScopedParent(t))):n.isReference(t)&&(r=t),u=new Set,n.traverseInstanceModels(r,function(e){u.add(e.get("isInstanceOf"))}),e.is(i,"array")&&i.length>0)for(o=i.length-1;o>=0;o--)if(d=n.getInstanceFromCollection(i[o]),e.is(d)){if(c=d.get("isAggregatedBy"),m(l=this.getScopeLinksOfImplemented(c),function(e){return e===r})){g=!0;break}if(0!==o&&m(l,function(e){return u.has(e)}))break}return g},createEngMadeFromItem:function(t,n){return new Promise((o,s)=>{let a=r.getPlugins("DatabasePlugin"),l=r.getPlugins("DicoPlugin");e.is(a)&&e.is(a.instance)||(r.getLogger().debug("DatabasePlugin is not available."),s()),e.is(l)&&e.is(l.instance)||(r.getLogger().debug("DicoPlugin is not available."),s()),a=a.instance,l=l.instance;const c={mfgRefID:n,prdRefID:t},u=()=>{s()},d={url:"dsmfg/private/V0/invoke/createEngMadeFromItem",method:"POST",context:this,headers:i.getHeaders({isAuthoringCtx:!0,isJsonOnly:!0}),data:e.Json.encode(c),onComplete:t=>{const n={stackedReferences:[],stackedInstances:[],stackedConnections:[],onComplete:o},i=a.getConnectionParser();e.is(t)?(e.is(t.instancesAndReferences,"array")&&t.instancesAndReferences.forEach(t=>{n.stackedInstances.push(e.merge(t.attributesValue,{queriedForConnections:!0})),n.stackedReferences.push(e.merge(t["to.attributesValue"],{queriedForChildren:!0,queriedForConnections:!0,queriedForDocuments:!1}))}),e.is(t.connections,"array")&&t.connections.forEach(e=>{i.parse(e,n)}),a.addToCollections(n)):s()},onFailure:u,onTimeout:u,onCancel:u};i.webServiceRequest(d)})},consumeReferenceWithScopeLink:function(t,n,o,s,a){return new Promise((l,c)=>{let u=r.getPlugins("DatabasePlugin"),d=r.getPlugins("DicoPlugin");e.is(u)&&e.is(u.instance)||(r.getLogger().debug("DatabasePlugin is not available."),c()),e.is(d)&&e.is(d.instance)||(r.getLogger().debug("DicoPlugin is not available."),c()),u=u.instance,d=d.instance;const g={scopeIntent:t,implementingParentRefPID:o,implementedRefPID:n,mfgInstanceId:s,attributes:a},m=()=>{c()},f={url:"dsmfg/private/V0/invoke/consumeReferenceWithScopeLink",method:"POST",context:this,headers:i.getHeaders({isAuthoringCtx:!0,isJsonOnly:!0}),data:e.Json.encode(g),onComplete:t=>{const n={stackedReferences:[],stackedInstances:[],stackedConnections:[],onComplete:l},i=u.getConnectionParser();e.is(t)?(e.is(t.instancesAndReferences,"array")&&t.instancesAndReferences.forEach(t=>{n.stackedInstances.push(e.merge(t.attributesValue,{queriedForConnections:!0})),n.stackedReferences.push(e.merge(t["to.attributesValue"],{queriedForChildren:!0,queriedForConnections:!0,queriedForDocuments:!1}))}),e.is(t.connections,"array")&&t.connections.forEach(e=>{i.parse(e,n)}),u.addToCollections(n)):c()},onFailure:m,onTimeout:m,onCancel:m};i.webServiceRequest(f)})},manageScopeAndImplementLink:function(t,s,a,l,c){var u,d=c||{},m={productPID:a,processPID:t,processInstancePID:s,partialScopeAction:d.cmdAction},f=function(t,n){e.is(d.isCreatePartialScopeLink)&&d.isCreatePartialScopeLink?g("Create scope and implement link","ImplementPlugin.CreatePartialScope.Failed",n,d):e.is(d.isDeletePartialScopeLink)&&d.isDeletePartialScopeLink?g("Delete Partial scope and implement link","ImplementPlugin.DeletePartialScope.Failed",n,d):e.is(d.isStretchPartialScopeLink)&&d.isStretchPartialScopeLink?g("Stretch scope and implement link","ImplementPlugin.StretchPartialScope.Failed",n,d):e.is(d.isSwitchToPartialScopeLink)&&d.isSwitchToPartialScopeLink&&g("Swtich To Full scope link","ImplementPlugin.SwitchPartialScope.Failed",n,d)};e.is(d.isStretchPartialScopeLink)&&d.isStretchPartialScopeLink?(m.targetPrdOccPath=d.targetPrdOccPath,m.targetProductPID=d.targetProductID,m.prdOccPath=l):e.is(d.isDeletePartialScopeLink)&&d.isDeletePartialScopeLink?m.targetPrdOccPath=d.targetPrdOccPath:(e.is(d.isCreatePartialScopeLink)&&d.isCreatePartialScopeLink||e.is(d.isSwitchToPartialScopeLink)&&d.isSwitchToPartialScopeLink)&&(m.prdOccPath=l),u={url:"dsmfg/private/V0/invoke/MfgItem/managePartialScopeAndImplementLink",method:"POST",headers:i.getHeaders({isAuthoringCtx:!0,isJsonOnly:!0}),data:e.Json.encode(m),onFailure:f,onTimeout:f,onCancel:f,onComplete:function(t){var i=o.getConnectionParser(),s={stackedReferences:[],stackedInstances:[],stackedConnections:[],deletedObjects:[],deletedConnections:[],onComplete:function(t){var n=[];e.is(t.instancesAndReferences,"array")&&t.instancesAndReferences.length>0&&(t.instancesAndReferences.forEach(function(e){e.isReference()&&n.push(e)}),n.length>0&&r.getMediator().notify("changeReference",[n])),e.is(t.connections,"array")&&t.connections.length>0&&r.getMediator().notify("addConnection",[t.connections]),e.is(d.onComplete,"function")&&(e.is(d.isCreatePartialScopeLink)&&d.isCreatePartialScopeLink?d.onComplete("ImplementPlugin.CreatePartialScope.Success",t):e.is(d.isDeletePartialScopeLink)&&d.isDeletePartialScopeLink?d.onComplete("ImplementPlugin.DeletePartialScope.Success",t):e.is(d.isStretchPartialScopeLink)&&d.isStretchPartialScopeLink?d.onComplete("ImplementPlugin.StretchPartialScope.Success",t):e.is(d.isSwitchToPartialScopeLink)&&d.isSwitchToPartialScopeLink&&d.onComplete("ImplementPlugin.SwitchPartialScope.Success",t))}};e.is(t)?(e.is(t.instancesAndReferences,"array")&&t.instancesAndReferences.length>0&&t.instancesAndReferences.forEach(function(t){var n=e.is(t.attributesValue)?t.attributesValue:t;Object.prototype.hasOwnProperty.call(n,"isInstanceOf")?s.stackedInstances.push(t):s.stackedReferences.push(t)}),e.is(t.connections,"array")&&t.connections.length>0&&t.connections.forEach(function(e){i.parse(e,s)}),e.is(t.deletedObjects,"array")&&t.deletedObjects.length>0&&(s.deletedObjects=s.deletedObjects.concat(t.deletedObjects)),e.is(t.deletedConnections,"array")&&t.deletedConnections.length>0&&(s.deletedConnections=s.deletedConnections.concat(t.deletedConnections)),n.addToCollections(s)):f()}},i.webServiceRequest(u)}})}}),define("DS/DELPPWViewPlugins/UXComponentsPlugin/UXComponentsPlugin",["UWA/Core","UWA/Element","UWA/Utils","DS/Windows/Panel","DS/Windows/Dialog","DS/UIKIT/Form","DS/UIKIT/Modal","DS/UIKIT/SuperModal","DS/UIKIT/Tooltip","DS/UIKIT/Alert","DS/Tree/Tree","DS/Controls/Button","DS/Controls/ButtonGroup","DS/Controls/LineEditor","DS/Controls/Loader","DS/Controls/ModalContainer","DS/Controls/Tab","DS/Tree/TreeListView","DS/Tree/TreeNodeModel","DS/Tree/TreeDocument","DS/Controls/TooltipModel","DS/CoreEvents/Events","DS/Controls/Toggle","DS/Controls/ComboBox","DS/WUXAutoComplete/AutoComplete","DS/Controls/Editor","DS/Controls/DatePicker","DS/UIBehaviors/ContextualMenuManager","DS/ApplicationFrame/FrameWindowsManager","DS/ApplicationFrame/CommandsManager","DS/etree/syncwidget","DS/etree/syncviewsFactory","DS/Controls/ProgressBar","DS/Controls/Accordeon","DS/DELPPWViewPlugins/UXComponentsPlugin/UnitsEditor","DS/DELPPWViewPlugins/UXComponentsPlugin/ExtendedCustomDialog","DS/DELPPWViewPlugins/UXComponentsPlugin/PPRDataGridView","DS/DELPPWViewPlugins/UXComponentsPlugin/RichTextEditor","DS/DELPPWViewPlugins/UXComponentsPlugin/InclusiveLineEditor","DS/egraph/core","DS/egraph/views","DS/egraph/iact","DS/egraph/utils","DS/TreeModel/DataModelSet","DS/Controls/Breadcrumb","DS/Controls/SelectionChipsEditor","css!egraph/views","css!DS/egraph/views_default.css","css!etree/syncviews","css!DS/etree/overviewui.css","css!DS/UIKIT/UIKIT.css"],function(e,t,n,i,o,s,r,a,l,c,u,d,g,m,f,p,h,C,P,v,S,I,w,b,y,D,L,k,E,R,x,V,A,T,M,O,F,N,W,U,_,B,j,H,X,z){"use strict";return function(){return{name:"UXComponentsPlugin",getComponent:function(n){var G;switch(n){case"WUXDockAreaEnum":G=WUXDockAreaEnum;break;case"Element":G=t;break;case"Panel":G=i;break;case"Dialog":G=o;break;case"CustomDialog":G=O;break;case"Form":G=s;break;case"Tooltip":G=l;break;case"Modal":G=r;break;case"Alert":G=c;break;case"Button":G=d;break;case"ButtonGroup":G=g;break;case"LineEditor":G=m;break;case"TooltipModel":G=S;break;case"TreeListView":G=C;break;case"TreeNodeModel":G=P;break;case"TreeDocument":G=v;break;case"DataGridView":G=F;break;case"Tree":G=u;break;case"WUXEvent":G=I;break;case"Segmented":G=e.Controls.Segmented;break;case"ContextualMenuManager":G=k;break;case"WUXFrameWindowsManager":G=E;break;case"WUXCommandsManager":G=R;break;case"WUXLoader":G=f;break;case"Toggle":G=w;break;case"ComboBox":G=b;break;case"AutoComplete":G=y;break;case"Editor":G=D;break;case"DatePicker":G=L;break;case"SuperModal":G=a;break;case"ETree":G=x;break;case"ETreeViewsFactory":G=V;break;case"ProgressBar":G=A;break;case"Accordeon":G=T;break;case"UnitsEditor":G=M;break;case"WUXTab":G=h;break;case"EGraphCore":G=U;break;case"EGraphViews":G=_;break;case"EGraphIact":G=B;break;case"EGraphUtils":G=j;break;case"DataModelSet":G=H;break;case"RichTextEditor":G=N;break;case"Breadcrumb":G=X;break;case"ModalContainer":G=p;break;case"InclusiveLineEditor":G=W;break;case"Array":G=null;break;case"Chips":G=z}return G}}}}),define("DS/DELPPWViewPlugins/ImplementPlugin/ProcessImplementPlugin",["UWA/Core","DS/DELPPWModelServices/CollectionUtils","DS/DELPPWDicoServices/DicoUtils","DS/DELPPWViewPlugins/ImplementPlugin/ImplementBase","text!DS/DELPPWViewPlugins/assets/RolesOnImplementLink.json"],function(e,t,n,i,o){"use strict";return function(s){const r="ProcessImplementLink",a="ProcessImplementLinkOcc",l="PartialProcessImplementLink";var c,u,d,g,m,f,p,h,C,P,v,S,I;return h=function(t){var i=[];return Object.keys(f).forEach(function(o){n.isAKindOf(t,o)&&(i=f[o],i=e.clone(i))}),i},C=function(e,t){var i,o=null;return Object.keys(p).forEach(function(s){n.isAKindOf(e,s)&&(i=p[s],Object.keys(i).forEach(function(e){n.isAKindOf(t,e)&&(o=p[s][e])}))}),o},P=function(){return e.is(c)||(c=s.getPlugins("DatabasePlugin").instance),c},v=function(){return e.is(u)||(u=s.getPlugins("ResourcePlugin").instance),u},S=function(){return e.is(d)||(d=s.getPlugins("WebServicePlugin").instance),d},I=function(e){let t=e.from,n=e.to,i=t[t.length-1],o=n[n.length-1],s=P(),r=s.getImpacted(i,!1,{relationTypes:["ProcessImplementLinkOcc"]}).filter(function(e){var t=e.get("to");return t[t.length-1]===o});r.length>0&&s.removeConnection(r[0].get("PID"))},g=new i(s.getLogger(),r,l,a),e.extend(g,{name:"ProcessImplementPlugin",onStart:function(){m=e.Json.decode(o),p=m.DefaultRoles,f=m.Roles},isImplementLinkValidForOccPath:function(t,n,i){var o,s,r=!1,a=!1;return o=this.getPathToScope(i),(e.equals(t,o)||e.equals(n,o))&&(r=!0),s=this.getPathToPartialScope(i),(e.equals(t,s)||e.equals(n,s))&&(a=!0),r||a},canCreateScopeLink:function(t,n){var i,o,s,a,l,c=r,u=v(),d=!0;return n=!!e.is(n)&&n,o=t.fromSideRefPID,s=t.toSideRefPID,t.fromSideAbsPath,t.toSideAbsPath,this.isScoped(o)&&(i=this.getScopeLinks(o),e.is(i,"array")&&i.length>0&&i.some(function(t){var n=t.get("from"),i=t.get("to");return e.equals(n,o)&&e.equals(i,s)})&&(d=!1)),e.is(t.fromSideInstPID)&&e.is(t.toSideInstPID)?(a=t.fromSideInstPID,l=t.toSideInstPID):(a=t.fromSideRefPID,l=t.toSideRefPID),n?{canCreateLink:d,data:{type:c,implementingPID:a,implementedPID:l,implementingAbsPath:t.fromSideAbsPath,implementedAbsPath:t.toSideAbsPath,displayText:u.getNLSValue(c,null,"CreateLink"),buttonIdentifier:u.getNLSValue(c,null,"CreateLink")}}:d},getImplLinksOfImplementing:function(t){var n,i,o=[];return Array.isArray(t)&&t.length>0?(i=this.getPathToScope(t),n=this.filterImplementLinks(function(t,n){return e.equals(i,t)}),Array.isArray(n)&&(o=n)):o=null,o},getScopeLinksOfImplementing:function(e,t){return g.getScopeLinks(e,r,t)},getPartialScopeLinksOfImplementing:function(e,t){return g.getPartialScopeLinks(e,l,t)},getPossiblePartialScopeLinkOnHeaderOperation:function(t){var n,i,o,s=g.getReferencePID(t),r=P(),a=v(),c={errorMessage:null,linksData:[]},u=this;return this.getImplLinksOfImplementing(t).length>0?c.errorMessage=a.getNLSValue("LinkBehavior.canCreatePartialScopeLinkError.HasImplemenLink"):(n=this.findInstanceWhoseParentIsScoped(t),0===(i=e.is(n,"object")?n.scopeLinks:[]).length?c.errorMessage=a.getNLSValue("LinkBehavior.canCreatePartialScopeLinkError.NoScopeOnParent"):(i.forEach(function(e){c.linksData.push({IDFrom:s,IDTo:e.get("to"),type:l,implementingAbsPath:t})}),c.linksData=c.linksData.filter(function(e){return!0===u.canCreatePartialScopeLink(e).canCreateLink}),0===c.linksData.length&&(o=r.getReference(s),c.errorMessage=a.getNLSValue("ImplementBehavior.CreateMGAPartialScopeLink.MatchedWithFirstUpperScope",{implementinRef:o.get("V_Name")})))),c},canCreatePartialScopeLink:function(e){var t,n=e.IDFrom,i=e.IDTo,o=e.implementingAbsPath,s=P(),r=v(),a=!0,c={};return this.getImplLinksOfImplementing(o).length>0&&(a=!1,t=r.getNLSValue("LinkBehavior.canCreatePartialScopeLinkError.HasImplemenLink")),a&&s.hasConnection({from:n,to:i,type:l})&&(a=!1,t=r.getNLSValue("LinkBehavior.canCreatePartialScopeLinkError.LinkAlreadyExists")),c.canCreateLink=a,a?(delete e.implementingAbsPath,c.data=e):c.errorMessage=t,c},canCreateImplementLink:function(t){var n,i,o,s,r,l=a,c=P(),u=v(),d={},g={};return i=t.fromSideAbsPath,o=t.toSideAbsPath,n=this.isImplementLinkPossible(i,o),g={canCreateLink:n,data:[]},n&&(d={type:l,implementingAbsPath:i,implementedAbsPath:o,displayText:u.getNLSValue(l,null,"CreateLink"),buttonIdentifier:u.getNLSValue(l,null,"CreateLink")},d=e.merge(d,e.clone(t)),g.data.push(d),s=o[o.length-1],r=c.getReferenceModel(s).get("type"),h(r).forEach(function(n){var s,r,a;s=u.getNLSValue("Role."+n),r=u.getNLSValue(l+".roles",{role:s},"CreateLink"),a={type:l,implementingAbsPath:i,implementedAbsPath:o,displayText:r,buttonIdentifier:r,connectionParams:{role:n}},a=e.merge(a,e.clone(t)),g.data.push(a)})),g},hasPartialScopeLinks:function(e){var t=e.get("PID"),i=[];return n.isAKindOf(e,"DELLmiHeaderOperationReference")&&(i=this.getPartialScopeLinksOfImplementing(t)),i.length>0},createHOPMfgItemPartialScopeLink:function(t,n){var i,o,s=v(),r=P(),l=S(),c={info:[]},u=this;t.forEach(function(e){var t=r.getReference(e.IDFrom).get("V_Name"),n=r.getReference(e.IDTo).get("V_Name");c.info.push(t+" To "+n)}),o={connectionParams:t},i={url:"dsmfg/private/V0/MfgElement/connection/CreateMGAPartialScopeLink",method:"POST",data:e.Json.encode(o),context:u,onComplete:function(t){var i=r.getConnectionParser(),o={stackedReferences:[],stackedConnections:[]};e.is(t.connections)&&t.connections.forEach(function(e){i.parse(e,o)}),o.stackedConnections.forEach(function(e){e.type===a&&I.call(u,e)}),r.addToCollections({stackedConnections:o.stackedConnections,silentMode:!1,onComplete:function(){var t=s.getNLSValue("ImplementBehavior.CreateMGAPartialScopeLink.Success",{info:c.info.join()});e.is(n.onSuccess,"function")&&n.onSuccess(t)}})},onFailure:function(){var t=s.getNLSValue("ImplementBehavior.CreateMGAPartialScopeLink.Failed",{info:c.info.join()});e.is(n.onFailure,"function")&&n.onFailure(t)}},l.webServiceRequest(i)},isImplementLinkPossible:function(e,t){var n,i=e[e.length-1],o=t[t.length-1],s=P(),r=!1;return(this.validateIfScoped(e,t)||this.validateIfPartialScoped(e,t))&&(r=!this.getImplLinksOfImplementing(e).some(function(e){return e.getAttribute("to")===o})),r&&(n=s.getReferenceModel(i),r=!this.hasPartialScopeLinks(n)),r},validateIfScoped:function(i,o){var s,a,l,c,u=!1;return e.is(i,"array")&&i.length>0?(s=t.getInstanceFromCollection(i[i.length-1]),l=s.get("isInstanceOf"),a=this.getScopeLinks(l),e.is(a,"array")&&0===a.length&&(l=this.getScopedParent(i))):t.isReference(i)&&(l=i),c=t.getReferenceModel(l),e.is(o,"array")&&o.length>0&&!n.isAKindOf(c,"DELLmiHeaderWorkPlanReference")&&(u=o.slice().reverse().some(function(n){var i=!1,o=t.getInstanceFromCollection(n);return e.is(o)&&(i=t.hasConnection({to:o.get("isAggregatedBy"),from:l,type:r})),i})),u},validateIfPartialScoped:function(n,i){var o,s,r,a,c=!1;return e.is(n,"array")&&n.length>0?(o=t.getInstanceFromCollection(n[n.length-1]),r=o.get("isInstanceOf"),s=this.getPartialScopeLinks(r),e.is(s,"array")&&0===s.length&&(r=this.getPartialScopedParent(n))):t.isReference(n)&&(r=n),a=t.getReferenceModel(r),e.is(a)&&e.is(i,"array")&&i.length>0&&(c=i.slice().reverse().some(function(n){var i=!1,o=t.getInstanceFromCollection(n);return e.is(o)&&(i=t.hasConnection({to:o.get("isAggregatedBy"),from:r,type:l})),i})),c},getPathsToScope:function(n,i){var o,s,r=null,a=null,l=null,c=null,u={},d=!1,g=function(e){var t=null;return e.some(function(e){var n=!1,o=s.lastIndexOf(e.get("to"));return o>-1&&(t=i.slice(o),n=!0),n}),t};return s=[],i.forEach(function(e){var n=t.getInstanceFromCollection(e);s.push(n.get("isAggregatedBy"))}),o=this.findInstanceWhoseParentIsPartialScoped(n),e.is(o)&&(l=n.slice(o.absPathIndex),(c=g(o.scopeLinks))&&(d=!0,u={implementingPathToScope:l,implementedPathToScope:c})),d||(o=this.findInstanceWhoseParentIsScoped(n),e.is(o)&&(r=n.slice(o.absPathIndex),(a=g(o.scopeLinks))&&(d=!0,u={implementingPathToScope:r,implementedPathToScope:a}))),u},getRolesForTargrtObject:function(e){var t=P(),n=t.getConnection(e).get("to"),i=n[n.length-1],o=t.getReferenceModel(i).get("type");return h(o)},getRoleFromModelOrComputed:function(t){var n,i,o,s,r,a,l,c,u,d=P(),g=v(),m=d.getConnection(t),f=m.get("V_usage");return e.is(f)&&"NULL"!==f?n=g.getNLSValue("Role."+f):(i=m.get("from"),o=m.get("to"),s=i[i.length-1],r=o[o.length-1],a=d.getReferenceModel(s),l=d.getReferenceModel(r),c=a.get("type"),u=l.get("type"),n="*"+g.getNLSValue("Role."+C(c,u))),n},getConnectedObjects:function(t,n,i,o){var s=[];return e.is(o)&&(o=Array.isArray(o)?o:[o]).forEach(function(o){var c,u,d,g,m,f=o.get("type"),p=o.get("from"),h=o.get("to");switch(f){case r:case l:m=p===t?h:p;break;case a:c=p[p.length-1],u=p.toString(),d=h[h.length-1],g=h.toString(),i=Array.isArray(i)?i.toString():i,n===c&&i.indexOf(u)>-1?m=h:n===d&&i.indexOf(g)>-1&&(m=p);break;default:console.log("Invalid Type")}e.is(m)&&s.push(m)}),s}})}}),define("DS/DELPPWViewPlugins/TreeViewPlugin/ViewPreferencesUI",["UWA/Core","DS/Utilities/Utils","DS/DELPPWResourceServices/ResourceUtils","DS/DELPPWModelServices/BehaviorUtil","DS/DELPPWModelServices/ModelUtils","DS/DELPPWViewPlugins/TreeViewPlugin/RootsStoreUI","DS/DELPPWViewPlugins/MoreAttributesWizard","DS/CoreEvents/Events","DS/DELPPWWebServices/WebserviceUtils","DS/DocumentManagement/DocumentManagement","DS/ZipJS2/ZipJS2","DS/DELPPWServices/ConfigService/CustoParametersSet"],function(e,t,n,i,o,s,r,a,l,c,u,d){"use strict";return function(g,m,f,p,h){var C,P,v,S,I,w,b,y,D,L,k,E,R,x,V,A=f.getComponent("Element"),T=f.getComponent("Dialog"),M=f.getComponent("Button"),O=f.getComponent("WUXTab"),F=f.getComponent("TreeListView"),N=f.getComponent("TreeNodeModel"),W=f.getComponent("Editor"),U=f.getComponent("Toggle");return I=function(t){P=new A("div",{class:"ViewPreferencesUI-Content"}),(C=new T({domId:"ViewPreferencesUI-Dialog",immersiveFrame:m.getImmersiveFrame(),modalFlag:!0,visibleFlag:!1,resizableFlag:!0,snappableFlag:!1,title:n.getNLSValue("ViewPreferencesUI.Header"),content:P,buttons:{Ok:new M({domId:"ViewPreferencesUI-Dialog-Ok",className:"ok primary",label:n.getNLSValue("ViewPreferencesUI.Ok"),emphasize:"primary",onClick:function(){var n=R();C.close(),e.is(t,"function")&&t(n)}}),Cancel:new M({domId:"ViewPreferencesUI-Dialog-Cancel",className:"cancel",label:n.getNLSValue("ViewPreferencesUI.Cancel"),onClick:function(){C.close()}}),Apply:new M({domId:"ViewPreferencesUI-Dialog-Apply",className:"moreAttr",label:n.getNLSValue("ViewPreferencesUI.MoreAttributes"),onClick:E})}})).close=function(){this.destroy(),P=null,S=null,v=null}},D=function(t,n){var i,o=[];return t.selectedAttributes.forEach(function(e){e.attrIsSelected&&!e.attrIsInXML?n.Config.Columns.Column.push({dataIndex:e.dataIndex,dicoType:e.attrNature,display:"true",minWidth:"50"}):!e.attrIsSelected&&e.attrIsInXML&&o.push(e.dataIndex)}),i=(i=(i='<?xml version="1.0" encoding="UTF-8"?>\n')+'<Config name="'+n.Config.name+'" xmlns="DS_DELPPWConfiguration" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="DS_DELPPWConfiguration ../xsd/ColumnConfig.xsd" Title="'+n.Config.Title+'" Description="'+n.Config.Description+'">\n')+'<Label dataIndex="'+n.Config.Label.dataIndex+'" dicoType="'+n.Config.Label.dicoType+'"/>\n',i+="<Columns>\n",n.Config.Columns.Column.forEach(function(t){o.includes(t.dataIndex)||(i=i+'<Column dataIndex="'+t.dataIndex+'"  ',e.is(t.displayType)&&(i=i+'displayType="'+t.displayType+'" '),e.is(t.display)&&(i=i+'display="'+t.display+'" '),e.is(t.dicoType)?e.is(t.dicoType,"array")?(i+=">\n",t.dicoType.forEach(function(e){i=i+'<dicoType dicoType="'+e.dicoType+'" />\n'}),i+="</Column>\n"):(i=i+'dicoType="'+t.dicoType+'" ',i+="/>\n"):i+="/>\n")}),i+="</Columns>\n",i+="</Config>\n\n"},k=function(t,i,s){var r,a,m,f,p=l.get3DSpaceUrl().slice(0,-1),h=l.getSecurityContext(),C=o.getWidgetTrigram()+"ParametersViewColumnConfig";e.is(i)&&""!==i?(f=new File([new Blob(['{"title":"'+i+'"}'],{type:"application/json"})],"meta_"+widget.lang+".json",{type:"application/json"}),t.add(f.name,new u.BlobReader(f),{password:null,onstart:function(){},onprogress:function(){}}).then(function(){a={tenantUrl:p,additionalHeaders:{SecurityContext:h},onComplete:function(){widget.setValue("custoParametersSet",i),location.reload()},onFailure:function(){V.destroy(),V=null}},c.getDocuments([i],{tenantUrl:p,additionalHeaders:{SecurityContext:h},onComplete:function(e){var o=e.data[0].relateddata.files[0].id;new Promise(function(e,t){new d(g.getConfig().resource.custoParameterRegExp,g.getLogger(),l,n).retrieveCustoParametersSetsInfo(e,t)}).then(function(e){var n=[],l=new Map(Object.entries(e[1])).keys();Array.from(l).forEach(function(i){var o;i===s||i.includes(".json")||(o=new File([new Blob([e[1][i]],{type:"text/xml"})],i,{type:"application/json"}),n.push(t.add(o.name,new u.BlobReader(o),{password:null,onstart:function(){},onprogress:function(){}})))}),Promise.all(n).then(function(){t.close().then(function(e){m=new File([e],"xmlparams.zip",{type:"application/zip"}),r={id:i,fileInfo:{file:m}},c.deleteFile(i,o,{tenantUrl:p,onComplete:function(){c.addFileToDocument(r,a)}})})})})}})})):c.createDocument({},{tenantUrl:p,additionalHeaders:{SecurityContext:h},csrf:{name:"ENO_CSRF_TOKEN",value:l.getCSRFToken("3DSpace")},onComplete:function(e){f=new File([new Blob(['{"title":"'+e.data[0].id+'"}'],{type:"application/json"})],"meta_"+widget.lang+".json",{type:"application/json"}),t.add(f.name,new u.BlobReader(f),{password:null,onstart:function(){},onprogress:function(){}}).then(function(){t.close().then(function(t){m=new File([t],"xmlparams.zip",{type:"application/zip"}),c.addFileToDocument({id:e.data[0].id,fileInfo:{file:m}},{tenantUrl:p,additionalHeaders:{SecurityContext:h},csrf:{name:"ENO_CSRF_TOKEN",value:l.getCSRFToken("3DSpace")},onComplete:function(){c.modifyDocument({id:e.data[0].id,title:C+"/"+e.data[0].id},{tenantUrl:p,onComplete:function(){widget.setValue("custoParametersSet",e.data[0].id),location.reload()},onFailure:function(){V.destroy(),V=null}})},onFailure:function(){V.destroy(),V=null,g.getLogger().warn(self.name,"Document creation failed")}})})})},onFailure:function(){V.destroy(),V=null,g.getLogger().warn(self.name,"Document creation failed")}})},L=function(e,t,n,i){var o,s,r,a;const l=g.getService("ConfigService");u.configure({maxWorkers:3}),a=new u.ZipWriter(new u.BlobWriter("application/zip"),{bufferedWrite:!0}),r=l.getConfigurationPID(),o=D(e,n),s=new File([new Blob([o],{type:"text/xml"})],i,{type:"text/xml"}),a.add(s.name,new u.BlobReader(s),{password:null,onstart:function(){},onprogress:function(){}}).then(function(){k(a,r,i)})},E=function(){var t,i,o,s={modelEvents:a,settingManager:null},c=m.getImmersiveFrame().elements.container.getSize(),u=new A("div",{class:"MoreWizardContainer-Content",styles:{height:c.height-60,width:c.width-20}}),d=[],g=[];switch(x[S._properties.value.value[0]]){case"MANUFACTURING":t=l.getXMLValues("MANUFACTURING.columnConfigPath"),i="ManufacturingViewColumnConfig.xml",o=["CreateAssembly","CreateMaterial","Provide","CreateKit","Installation","Transform","Fasten","DELFmiFunctionIdentifiedInstance"];break;case"MBOM":t=l.getXMLValues("MBOM.columnConfigPath"),i="ProcessColumnConfig.xml",o=["CreateAssembly","CreateMaterial","Provide","CreateKit","Installation","Transform","Fasten","DELFmiFunctionIdentifiedInstance"];break;case"RESOURCE":t=l.getXMLValues("RESOURCE.columnConfigPath"),i="ResourceViewColumnConfig.xml",o=["Worker","ResourceArea","Transport","Conveyor","Machine","Robot","Storage","Sensor","IndustrialMachine","NCMachine","ToolDevice","Inspect","UserDefined","Organizational","ResourceManufacturingSetup","ControlDevice"];break;case"EBOM":t=l.getXMLValues("EBOM.columnConfigPath"),i="ProductPartColumnConfig.xml",o=["VPMInstance","VPMReference"];break;case"ROUTINGS":t=l.getXMLValues("ROUTINGS.columnConfigPath"),i="RoutingsViewColumnConfig.xml",o=["DELLmiHeaderWorkPlanReference","DELLmiGeneralSystemInstance","DELLmiWorkPlanSystemInstance","DELLmiTransformationSystemInstance","DELLmiTransferSystemInstance","DELLmiStorageSystemInstance","DELLmiServiceWorkPlanSystemInstance","DELWkiSignOffInstance","DELWkiDataCollectInstance","DELWkiInstructionInstance","DELWkiAlertInstance","DELLmiUnLoadingOperationInstance","DELLmiCurveOperationInstance","DELLmiPunctualOperationInstance","DELLmiSourceOperationInstance","DELLmiSinkOperationInstance","DELLmiBufferOperationInstance","DELLmiInterruptOperationInstance","DELLmiTransferOperationInstance","DELLmiRemoveMaterialOperationInstance","DELLmiGeneralOperationInstance","DELLmiLoadingOperationInstance","DELLmiPickingOperationInstance","DELLmiHeaderOperationInstance","DELLmiGeneralSystemReference","DELLmiWorkPlanSystemReference","DELLmiTransformationSystemReference","DELLmiTransferSystemReference","DELLmiStorageSystemReference","DELLmiServiceWorkPlanSystemReference","DELWkiSignOffReference","DELWkiDataCollectReference","DELWkiInstructionReference","DELWkiAlertReference","DELLmiUnLoadingOperationReference","DELLmiCurveOperationReference","DELLmiPunctualOperationReference","DELLmiSourceOperationReference","DELLmiSinkOperationReference","DELLmiBufferOperationReference","DELLmiInterruptOperationReference","DELLmiTransferOperationReference","DELLmiRemoveMaterialOperationReference","DELLmiGeneralOperationReference","DELLmiLoadingOperationReference","DELLmiPickingOperationReference","DELLmiHeaderOperationReference"];break;case"FORMULA":t=l.getXMLValues("FORMULA.columnConfigPath"),i="FormulaViewColumnConfig.xml",o=["CreateAssembly","CreateMaterial","Provide","DELFmiFunctionIdentifiedInstance","ProcessContinuousCreateMaterial","ProcessContinuousProvide","ContinuousByProduct","DiscreteByProduct"];break;case"RECIPE":t=l.getXMLValues("RECIPE.columnConfigPath"),i="RecipeViewColumnConfig.xml",o=["DELLmiHeaderWorkPlanReference","DELLmiWorkPlanSystemInstance","DELWkiSignOffInstance","DELWkiDataCollectInstance","DELWkiInstructionInstance","DELWkiAlertInstance","DELLmiGeneralOperationInstance","DELLmiHeaderOperationInstance","DELLmiWorkPlanSystemReference","DELWkiSignOffReference","DELWkiDataCollectReference","DELWkiInstructionReference","DELWkiAlertReference","DELLmiGeneralOperationReference","DELLmiHeaderOperationReference"];break;default:return""}t.Config.Columns.Column.forEach(function(t){var n=null;e.is(t.dataIndex[0])&&e.is(t.dataIndex[1])&&(n=t.dataIndex,e.is(t.displayType)?(d.push(n),g.push(n)):g.push(n))}),V=new T({domId:"MoreWizard-Dialog",immersiveFrame:m.getImmersiveFrame(),modalFlag:!0,visibleFlag:!1,resizableFlag:!0,snappableFlag:!1,title:n.getNLSValue("ViewPreferencesUI.MoreAttributesWizardTitle"),content:u,buttons:{}}),s.modelEvents.subscribe({event:"MGA/MoreAttributesWizard/selectedAttributes"},function(e){L(e,0,t,i)}),V.close=function(){this.destroy(),V=null},new r({container:u,dialog:V,settingManager:s.settingManager,modelEvents:s.modelEvents,selectedTypes:o,selectedExtensions:["XCADExtension","XP_VPMReference_Ext","EnterpriseExtension","TlgCast","XP_VPMRepReference_Ext","XP_VPMReference_Ext"],selectedAttributes:[],preSelectedAttributes:g,unSelectableAttributes:d})},w=function(){e.is(P)&&(S=new O({reorderFlag:!0,showComboBoxFlag:!0,pinFlag:!1,multiSelFlag:!1,editableFlag:!0,touchMode:!0,displayStyle:["strip"]})).inject(P)},b=function(i){var o,s,r,a={showVerticalLines:!0,isSortable:!1,isDraggable:!0,isEditable:!0,apiVersion:2,height:"auto",defaultCellHeight:40,performances:{resizeDebounceTimeout:200},selection:{cells:!1,canMultiSelect:!1,columnHeaders:!1},resize:{columns:!0,rows:!1},enableActiveUI:!0,enableKeyboardNavigation:!0,shouldDisplayTooltip:function(t){var i,o={longHelp:""};if(!t.isHeader)switch(t.dataIndex){case"colName":case"width":case"minWidth":o.longHelp=t.cellModel.options.value;break;case"colVisibility":i=t.cellModel.options.value,e.is(i.display,"boolean")&&(i.display?o.longHelp=n.getNLSValue("ViewPreferencesUI.ToolTip.ColumnVisible"):o.longHelp=n.getNLSValue("ViewPreferencesUI.ToolTip.ColumnHidden"))}return o},onDropCellDefault:function(e,t){var n,i,o,s,r;if(e.preventDefault(),n=this.unserializeDragAndDropEvent(e)){if(i=n.data["dswebux/x-tree.treenodemodel+number"],o=n.data["dswebux/x-tree.treenodemodel+json"],t.nodeModel._getID()===i)return;o&&o.forEach(function(e){if(s=new N(e),t.cellView){if(r=t.nodeModel,t.manager.getDocument().options.shouldAcceptDrop({parentTreeNodeModel:r,draggedTreeNodeModel:s,dropPosition:t.dropPosition})){if(t.manager.getDocument().prepareUpdate(),t.manager.getDocument().getXSO().get().forEach(function(e){e.remove()}),t.manager.getDocument().pushUpdate(),-1!==t.virtualRowID){switch(t.dropPosition){case"top":r.getParent().insertBefore(s,r);break;default:case"middle":r.getParent().addChild(s,t.virtualRowID);break;case"bottom":r.getParent().addChild(s,r.getParent().getChildren().indexOf(r)+1)}return!1}return!0}return!1}})}}},l=function(e){var t,n=e.cellView.getContent(),i=e.cellModel.getCellContent();if(!e.isHeader)return t=new W({value:i}),n.setContent(t),t},c=t.debounce(function(e){e.nodeModel.options.grid[e.dataIndex]=e.value},100,!0),u=t.debounce(function(e){e.nodeModel.options.grid[e.dataIndex].display=e.cellView.getOption("toggle").checkFlag},100,!0);for(a.columns=[{dataIndex:"tree",isHidden:!0},{text:"",dataIndex:"colPosition",isEditable:!1,width:"5%",isColumnMovable:!1,onCellRequest:function(e){var t=e.cellView.getContent();if(!e.isHeader)return t.setContent(e.nodeModel.getLabel()),e.nodeModel.getLabel()}},{text:"HeaderName",dataIndex:"colName",isEditable:!1,width:"auto",isColumnMovable:!1},{text:"IsVisible",dataIndex:"colVisibility",isEditable:!1,width:"20%",isColumnMovable:!1,onCellRequest:function(t){var n,i=t.cellView.getContent(),o=t.cellModel.getCellContent();if(!t.isHeader)return n=new U({type:"switch",label:""}),"string"===e.typeOf(o)&&(o=e.Json.decode(o)),!0===o.display&&(n.checkFlag=!0),!0===o.mandatory&&(n.disabled=!0),i.setContent(n),i.title="",t.cellView.setOption("toggle",n),n},setValue:u},{text:"Width",dataIndex:"width",isEditable:!1,width:"20%",isColumnMovable:!1,onCellRequest:l,setValue:c},{text:"MinWidth",dataIndex:"minWidth",isEditable:!1,width:"20%",isColumnMovable:!1,onCellRequest:l,setValue:c}],s=(o=new F(a)).getDocument(),r=0;r<i.length;r++)s.addRoot(new N({label:r.toString(),grid:e.merge({colName:p.getColumnDisplayValue(i[r])},i[r])}));return o},y=function(t,o,r){var a;e.is(S)&&(v={},x=t,t.forEach(function(t){var i,s=o[t],a=b(s),l=new A("div",{class:t+"-Content ViewPreferencesUI-TabContent"});v[t]=a,l.setContent(a),(i=S.add({label:n.getNLSValue("ViewPreferencesUI."+t+".TabTitle"),content:l,index:S.getPageCount(),icon:"table",isSelected:0===S.getPageCount()})).button.elements.container.addClassName(t+"-TabButton"),e.is(r[t])&&i.button.elements.iconPlaceholder.setContent(r[t])}),i.useRootStorage()&&(a=new s(C,g,f,h),S.add({id:"store-view-block",index:S.getPageCount(),icon:n.getIconURLFromKey("StoreViews"),label:n.getNLSValue("ViewPreferencesUI.StoreView.TabTitle"),content:a.getContent()})))},R=function(){var t,n,i,o,s={};for(n in v)if(v.hasOwnProperty(n))for(s[n]=[],o=v[n].getRoots(),t=0;t<o.length;t++)i=o[t].options.grid,e.is(i.colName)&&delete i.colName,s[n].push(i);return s},{name:"ViewPreferencesUI",buildView:function(t,n){return e.is(C)&&C.close(),I(n),w(),y(t.views,t.viewPreferences,t.viewIcons),C}}}}),define("DS/DELPPWViewPlugins/TreeViewPlugin/TreeViewPlugin",["UWA/Core","DS/DELPPWWebServices/WebserviceUtils","DS/DELPPWResourceServices/ResourceUtils","DS/DELPPWViewPlugins/TreeViewPlugin/ViewPreferencesUI","DS/DELPPWViewPlugins/TreeViewPlugin/LayoutPreferencesUI","DS/CoreEvents/Events"],function(e,t,n,i,o,s){"use strict";return function(r){var a,l,c,u,d,g,m,f,p,h,C,P,v,S,I,w,b,y,D,L={"revision.reference":{command:"HistoryHdr"},"current.reference":{command:"MaturityHdr"},"owner.reference":{command:"ActionBar_ChangeOwner"},"organization.reference":{command:"ActionBar_ChangeOwner"},"project.reference":{command:"ActionBar_ChangeOwner"},"EnterpriseExtension.V_PartNumber.reference":{command:"SetThePartNumber",defaultValue:n.getNLSValue("Column.EnterpriseExtension.V_PartNumber.DefaultValue")}},k={Type:"referenceType.group",Reference:"referenceID.group"},E={"referenceType.group":"type.reference","referenceID.group":"PID.reference"},R={},x=new Set,V=new Set,A=[],T="",M=Object.create(null);return v=function(e){var t=-1;return C.some(function(n,i){var o=!1;return n.viewID===e&&(t=i,o=!0),o}),t},d=function(e){return(""!==a.getConfigurationPID()?a.getConfigurationPID()+"_":"")+e+"_ColumnPreferences"},g=function(e){return a.getPreference(d(e))},m=function(e,t){return a.setPreference(d(e),t)},f=function(){var t,n=null;return t=a.getPreference("widgetLayoutValues"),e.is(t)&&(n=e.Json.decode(t)),n},p=function(t){a.setPreference("widgetLayoutValues",e.Json.encode(t))},h=function(n,i){var o,s,a,l,c=t.getXMLValues(i),u=g(n);if(u=e.is(u)?u:[],c=e.is(c)?e.clone(c.Config.Columns.Column):[],c=e.is(c,"array")?c:[c],l=r.getPlugins("CfgColumnsPlugin"),e.is(l)){for(l=l.instance,o=u.length-1;o>=0;o--){for(a=!1,s=c.length-1;s>=0;s--)if(c[s].dataIndex===u[o].dataIndex){e.is(c[s].mandatory,"boolean")&&(u[o].colVisibility.mandatory=c[s].mandatory,c[s].mandatory&&(u[o].colVisibility.display=c[s].mandatory)),a=!0,c.splice(s,1);break}a||u.splice(o,1)}const t=l.getConfigColDataIndexSet();c.filter(function(n){let i=!0;return e.owns(n,"displayType")&&"CFG"===n.displayType&&(t.has(n.dataIndex)||(i=!1)),i}).forEach(function(t){u.push({colVisibility:{display:!e.is(t.display)||t.display,mandatory:!!e.is(t.mandatory)&&t.mandatory},dataIndex:t.dataIndex,dicoType:t.dicoType,width:e.is(t.width)?t.width:"auto",minWidth:e.is(t.minWidth)?t.minWidth:"100"})}),m(n,u)}return u},P=function(){var t,o,s,a,l,c={views:[],viewPreferences:{},viewIcons:{}};o=r.getPlugins("AttributePlugin"),t=r.getPlugins("UXComponentsPlugin"),s=r.getPlugins("RootsPlugin"),e.is(o)&&e.is(t)&&e.is(s)?(o=o.instance,t=t.instance,s=s.instance,l=t.getComponent("WUXFrameWindowsManager").getFrameWindow(r.getConfig().appContext),a=new i(r,l,t,o,s),C.forEach(function(e){var t=g(e.viewID);c.views.push(e.viewID),c.viewPreferences[e.viewID]=t,e.viewIcon&&(c.viewIcons[e.viewID]=n.getIconElem(e.viewIcon))}),a.buildView(c,function(t){var n,i;for(n in t)e.owns(t,n)&&(i=t[n],m(n,i));r.getMediator().notify("TreeViewPrefModified")}).show()):r.getLogger().debug("Attribute Plugin or UXComponents Plugin or Roots Plugin is not available.")},S=function(){var t,n,i,s={viewsInDockingZones:u,viewsInFreeZone:c};n=r.getPlugins("UXComponentsPlugin"),e.is(n)&&(n=n.instance,i=f(),(t=new o(l,n,r.getConfig().appContext,i,s)).showDialog(function(){var e=t.decipherPreferencesFromButtonStates();p(e),r.getMediator().notify("widgetLayoutChanged")}))},I=function(e){return L[e]},w=function(t){return t&&e.is(R[t])?R[t]:[]},b=function(t,n){t&&n&&(e.is(R[t])||(R[t]=[]),R[t].push(n))},D=function(){var e,t=!1;for(e in R)if(Array.isArray(R[e])&&R[e].length>0){t=!0;break}return t},y=function(e){e&&(R[e]=[])},{name:"TreeViewPlugin",onStart:function(t){C=[],u={},c={},a=r.getService("ConfigService"),e.is(a)||r.getLogger().debug("TreeViewPlugin initialization failed as ConfigService is not available"),l=r.getService("LayoutService"),e.is(l)||r.getLogger().debug("TreeViewPlugin initialization failed as LayoutService is not available"),A.push(r.addExternalListener("EditViewPreferencesCmd",P)),A.push(r.addExternalListener("LayoutPreferences",S)),t()},onStop:function(){var e,t;for(C=null,u=null,c=null,e=0,t=A.length;e<t;e++)r.removeExternalListener(A[e]);A=[],x.clear()},registerViewforColumnPref:function(t){var n=!1;return e.is(t)&&(e.is(t.viewID)||e.is(t.columnConfigName))?-1===v(t.viewID)?(C.push(t),h(t.viewID,t.columnConfigName),n=!0):r.getLogger().debug(t.viewID+" Module has already registered for Column Preferences"):r.getLogger().debug(" viewID or columnConfigName has not been defined, so cannot register for  Column Preferences"),n},syncViewColumnPreferences:function(t){var n,i,o;if(e.is(t))return(n=v(t))>-1?(i=C[n],h(i.viewID,i.columnConfigName),o=this.getViewColumnPreferences(i.viewID)):r.getLogger().debug(t+" Module has already registered for Column Preferences"),o;r.getLogger().debug(" viewID has not been defined, so cannot sync Column Preferences")},getViewColumnPreferences:function(n,i){var o,s,a,l,c,u,d,m=r.getPlugins("AttributePlugin"),f=r.getPlugins("ResourcePlugin");if(e.is(m)&&e.is(f)){if(m=m.instance,f=f.instance,e.is(n)){if((o=v(n))>-1)s=g(n),c=C[o].columnConfigName,l=t.getXMLValues(c),a=e.is(l)?l.Config.Columns.Column:[],a=e.is(a,"array")?a:[a],s.forEach(function(t,n){a.some(function(i){var o=!1;return i.dataIndex===t.dataIndex&&(s[n]=e.merge({isHidden:!t.colVisibility.display,width:t.width,minWidth:t.minWidth},i),o=!0),o})}),l.Config.Columns.Column=s;else{if(!e.is(i))return void r.getLogger().debug(n+" Module has not registered for Column Preferences");l=t.getXMLValues(i)}return e.is(l)&&(u=l.Config.Label,e.is(u)&&(d=m.getAttributeInfoFromColumn({dataIndex:u.dataIndex}),M[n]={attributeName:d.attributeName,labelIsOnRef:"reference"===d.objType,dicoType:u.dicoType})),e.is(l)?l.Config:void 0}r.getLogger().debug(" viewID has not been defined, so cannot retrieve Column Preferences")}else r.getLogger().debug("AttributePlugin or ResourcePlugin not available")},unRegisterViewforColumnPref:function(t){var n,i=!1;return e.is(t)?(n=v(t))>-1?(C.splice(n,1),i=!0):r.getLogger().debug(t+" Cannot unregister as Module is not registered for Column Preferences"):r.getLogger().debug(" viewID has not been defined, so cannot unRegister for  Column Preferences"),i},getLabelInfo:function(e){return M[e]},getViewLabelMap:function(){return M},registerViewforWidgetLayout:function(t){var n;e.is(t)&&(e.is(t.viewID)||e.is(t.viewType))?(n=t.viewID,e.is(t.dockArea)?e.is(u[n])?u[n].views.push(t.viewType):u[n]={views:[t.viewType],dockArea:t.dockArea}:e.is(c[n])?c[n].views.push(t.viewType):c[n]={views:[t.viewType]}):r.getLogger().debug("viewID or viewType has not been defined, so cannot register for Layout Preferences")},unregisterViewforWidgetLayout:function(t,n){var i,o,s,a=!1;return e.is(c[t])?i=c:e.is(u[t])&&(i=u),e.is(i)&&-1!==(s=(o=i[t]).views.indexOf(n))&&(o.views.splice(s,1),0===o.views.length&&delete i[t],a=!0),a||r.getLogger().debug('Cannot unregister as Module "'+t+'" or "'+n+'" is not registered for Layout Preferences'),a},setCurrentView:function(t,n){e.is(n)&&(e.is(t)||e.is(n.currentView))?e.is(c[t])?c[t].currentView=n.currentView:c[t]={currentView:n.currentView}:r.getLogger().debug("moduleId or currentView has not been defined, so cannot setup Module Current View")},updateViewPreferences:function(t,n,i){var o,s=g(t);Array.isArray(s)&&e.is(n)&&e.is(i)&&(o=s.detect(function(e){return e.dataIndex===n},this),e.is(o)&&(Object.keys(i).forEach(function(e){switch(e){case"visibility":o.colVisibility.display=i.visibility;break;default:r.getLogger().debug("Invalid option! No parameters to manage for the selected column!")}}),m(t,s)))},getCurrentView:function(){return c},setActiveView:function(e){T=e},getActiveView:function(){return T},getURLColumnInfo:function(e){return I(e)},executeCommand:function(t,n){var i,o,a,l=r.getConfig().appContext,c=r.getPlugins("UXComponentsPlugin").instance.getComponent("WUXCommandsManager"),u=c.getCommand(t,l);a=function(e){var t;return{displayName:(t=r.getPlugins("DatabasePlugin").instance.getReference(e.getReferencePID())).get("V_Name"),id:t.get("PID"),revision:t.get("revision"),type:t.get("type")}},i=(n||{}).node,e.is(u)?(e.is(i)&&(o=a(i)),!0===i.fromXEN&&e.is(i.getParent()._treeDocument)?s.publish({event:"FacetCommandManager/executeCommand",data:{commandName:t,targetNode:o}}):u.execute(o)):(u=c.getCommandCheckHeader(t,l),e.is(u)&&!1===u.getState()&&(u.options.node={referencePID:i.getReferencePID(),instancePID:i.getInstancePID(),absPath:i.getAbsolutePath()},u.toggleState()))},addColumnForGrouping:function(e,t){b(e,t)},getColumnsForGrouping:function(e){return w(e)},isGroupingExist:function(){return D()},getGroupingAdditonalColumns:function(){return k},resetColumnsForGrouping:function(e){y(e)},getCollectionSpecificDataIndex:function(e){return E[e]},registerModuleForRecursiveGrouping:function(e){x.add(e)},doesModuleHaveRecursiveGrouping:function(e){return x.has(e)},unRegisterModuleForRecursiveGrouping:function(e){x.delete(e)},registerModuleColumnsAsImmutable:function(e){V.add(e)},areModuleColumnsImmutable:function(e){return V.has(e)}}}});