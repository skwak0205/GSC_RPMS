define("DS/VCXWebKernel/VCXModelNavigableActorList",["DS/WebApplicationBase/VCXAModelNavigable"],function(e){"use strict";return e.extend({init:function(){},getChildren:function(){for(var e=this.QueryInterface("VCXIModifiable").GetProperty("Actor.ListActors").GetPropertyValue().GetValue(),t=[],i=0;i<e.length;i++){var n=e[i],r=this.GetObject()._experienceBase.ComponentsMap.GetComponentFromLink(n);r&&t.push(r)}return t},isSelfOrganized:function(){return!0}})}),define("DS/VCXWebKernel/VCXCmdChangeMarker",["DS/CoreEvents/Events","DS/VCXWebKernelCommands/VCXCommand","DS/VCXWebKernelCommands/VCXCmdChangeModifiable","DS/VCXWebKernelCommands/VCXCmdChangeComponent"],function(e,t,i,n){"use strict";return t.extend({init:function(e,t,i){this._parent(),this._scenarioManager=e,this._commandManager=t,this._ComponentsMap=i,this._markersToAdd={},this._markerToRemove={},this._scenario=null,this._bLockEvents=!1,this._type="VCXCmdChangeMarker"},GetType:function(){return this._type},GetTitle:function(){return"Change markers"},AddMarkerToScenario:function(e,t,i){e&&"undefined"!==i&&(this._markersToAdd[i]=e),this._scenario=t},RemoveMarkerFromScenario:function(e,t){if(e){var i=e.QueryInterface("VCXIModifiable").GetProperty("Actor.TimePos").GetPropertyValue().GetValue();this._markerToRemove[i]=e}this._scenario=t},Do:function(){if(this._scenario){var t=new i(this._scenarioManager),r=new n(this._commandManager,this._ComponentsMap);for(var o in this._markersToAdd)if(this._markersToAdd.hasOwnProperty(o)){var a=this._markersToAdd[o];r.AddComponents(a),t.AddModifiables(a.QueryInterface("VCXIModifiable"))}for(var o in this._markerToRemove)if(this._markerToRemove.hasOwnProperty(o)){a=this._markerToRemove[o];r.RemoveComponents(a),t.RemoveModifiables(a.QueryInterface("VCXIModifiable"))}for(var o in this._commandManager.Push(r),this._commandManager.Push(t),this._markersToAdd)if(this._markersToAdd.hasOwnProperty(o)){a=this._markersToAdd[o];this._scenario.AddMarker(o,a),a.SetParentScenario(this._scenario.GetID())}for(var o in this._markerToRemove)this._markerToRemove.hasOwnProperty(o)&&this._scenario.RemoveMarker(o);if(this._bLockEvents);else{var s={arrayToAdd:this._markersToAdd,arrayToRemove:this._markerToRemove};e.publish({event:"VCX_MARKERS_CHANGED",data:s})}}else console.log("VCXCmdChangeMarker: scenario not found")},Invert:function(){var e=this._markersToAdd;this._markersToAdd=this._markerToRemove,this._markerToRemove=e},SetLockEvents:function(e){this._bLockEvents=e}})}),define("DS/VCXWebKernel/VCXComponentActorList",["DS/VCXWebExperienceBase/VCXComponentOccurrenceExperience"],function(e){"use strict";var t=e.extend({init:function(){this._arrayActors=[],this._bEnable=!0},SetName:function(e){e&&(this._name=e)},GetName:function(){return this._name},SetArrayActors:function(e){if(Array.isArray(e)&&0!==e.length)for(var t=0;t<e.length;t++){var i=e[t];this.AddActor(i)}},GetArrayActors:function(){return this._arrayActors},AddActor:function(e){for(var t=!1,i=0;i<this._arrayActors.length;i++){if(this._arrayActors[i]===e){t=!0;break}}if(!t){var n=this._experienceBase.ComponentsMap.GetComponentFromID(e);if(n)this._arrayActors.push(e);else{var r=this._experienceBase.getManager("VCXContextManager");if(r.getOpenSMGXML()){var o=r.getSmgXmlRoot();if(o){var a=o.GetComponentsMap();a.has(e)&&(n=a.get(e))&&this._arrayActors.push(n.GetID())}}}}},RemoveActor:function(e){for(var t=0;t<this._arrayActors.length;t++){if(this._arrayActors[t]===e){this._arrayActors.splice(t,1);break}}}});return Object.defineProperty(t.prototype,"enable",{enumerable:!0,get:function(){return this._bEnable},set:function(e){this._bEnable=e}}),Object.defineProperty(t.prototype,"componentType",{enumerable:!0,get:function(){return"VCXComponentActorList"}}),t}),define("DS/VCXWebKernel/VCXModifiableDRMManager",["UWA/Core","DS/VCXWebModifiables/VCXModifiable","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyValueBoolean","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables"],function(e,t,i,n,r,o,a){"use strict";return t.extend({init:function(){this._parent()},OnChangeProperty:function(e,t,i){if(i||(i={}),i.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;if("Display.Tree"===e){var n=t.GetValue();this.GetObject().GetDisplayTree()!==n&&this.GetObject().SetDisplayTree(n)}else if("Display.Timeline"===e){var r=t.GetValue();this.GetObject().GetDisplayTimeline()!==r&&this.GetObject().SetDisplayTimeline(r)}else if("Display.PropertiesPanel"===e){var o=t.GetValue();this.GetObject().GetDisplayPropertiesPanel()!==o&&this.GetObject().SetDisplayPropertiesPanel(o)}else if("Display.ScenariosPanel"===e){var a=t.GetValue();this.GetObject().GetDisplayScenariosPanel()!==a&&this.GetObject().SetDisplayScenariosPanel(a)}else{if("Display.ImmersiveNavigation"!==e){i.fromChildClass=!0;var s=this._parent(e,t,i);return s||console.log("property not found : '"+e+"'"),s}var c=t.GetValue();this.GetObject().GetImmersiveNavigation()!==c&&this.GetObject().SetImmersiveNavigation(c)}return!0},GetProperty:function(e){var t=null;if("Display.Tree"===e){var i=this.GetObject().GetDisplayTree();(p=new o).SetValue(i),t=new n(new r(e,2,!0,a),p)}else if("Display.Timeline"===e){var s=this.GetObject().GetDisplayTimeline();(p=new o).SetValue(s),t=new n(new r(e,2,!0,a),p)}else if("Display.PropertiesPanel"===e){var c=this.GetObject().GetDisplayPropertiesPanel();(p=new o).SetValue(c),t=new n(new r(e,2,!0,a),p)}else if("Display.ImmersiveNavigation"===e){var l=this.GetObject().GetImmersiveNavigation();(p=new o).SetValue(l),t=new n(new r(e,2,!0,a),p)}else if("Display.ScenariosPanel"===e){var p,h=this.GetObject().GetDisplayScenariosPanel();(p=new o).SetValue(h),t=new n(new r(e,2,!0,a),p)}return t},GetProperties:function(){var e=new i;return e.AddOrModifyProperty(this.GetProperty("Display.Tree")),e.AddOrModifyProperty(this.GetProperty("Display.Timeline")),e.AddOrModifyProperty(this.GetProperty("Display.PropertiesPanel")),e.AddOrModifyProperty(this.GetProperty("Display.ScenariosPanel")),e.AddOrModifyProperty(this.GetProperty("Display.ImmersiveNavigation")),e}})}),define("DS/VCXWebKernel/VCXModifiableMarker",["DS/VCXWebModifiables/VCXModifiable","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyValueInt","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueBoolean","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables"],function(e,t,i,n,r,o,a,s){"use strict";return e.extend({init:function(){this._parent()},OnChangeProperty:function(e,t,i){if(i||(i={}),i.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;if("Actor.Name"===e){var n=t.GetValue();this.GetObject().name!==n&&(this.GetObject().name=n)}else if("Actor.TimePos"===e){var r=t.GetValue();this.GetObject().timePos!==r&&(this.GetObject().timePos=r)}else{if("Actor.IsMilestone"!==e){i.fromChildClass=!0;var o=this._parent(e,t,i);return o||console.log("property not found : '"+e+"'"),o}var a=t.GetValue();this.GetObject().isMileStone!==a&&(this.GetObject().isMileStone=a)}return!0},GetProperty:function(e){var t=null;if("Actor.Name"===e){var c=this.GetObject().name;if(c){var l=new o;l.SetValue(c),t=new i(new n(e,2,!0,s),l)}}else if("Actor.TimePos"===e){var p=this.GetObject().timePos;if(null!==p){var h=new r;h.SetValue(p),t=new i(new n(e,0,!0,s),h)}}else if("Actor.IsMilestone"===e){var u=this.GetObject().isMileStone;if(null!==u){var d=new a;d.SetValue(u),t=new i(new n(e,0,!0,s),d)}}return t},GetProperties:function(){var e=new t;return e.AddOrModifyProperty(this.GetProperty("Actor.TimePos")),e.AddOrModifyProperty(this.GetProperty("Actor.Name")),e.AddOrModifyProperty(this.GetProperty("Actor.IsMilestone")),e}})}),define("DS/VCXWebKernel/VCXCmdChangeSelection",["DS/CoreEvents/Events","DS/VCXWebKernelCommands/VCXCommand"],function(e,t){"use strict";var i={AddToSelection:3,RemoveFromSelection:3,SetSelection:3,SetModifiablesSelection:3};return t.extend({init:function(e,t){this._DoNotUpdateCSO=!1,t&&(this._DoNotUpdateCSO=!0),this._parent(),this._compToAdd=[],this._compToRemove=[],this._selectionManager=e,this._bLockEvents=!1,this._type="VCXCmdChangeSelection"},_sendWarningIfNecessary:function(e,t){i[t]>0&&(console.warn(e),--i[t])},GetType:function(){return this._type},GetTitle:function(){return"Change selection"},Do:function(){this._selectionManager.addComponentsToSelection(this._compToAdd,this._DoNotUpdateCSO),this._selectionManager.removeComponentsFromSelection(this._compToRemove,this._DoNotUpdateCSO),this._bLockEvents||e.publish({event:"VCX_SELECTION_CHANGED"})},Redo:function(){this._selectionManager.addComponentsToSelection(this._compToAdd,this._DoNotUpdateCSO),this._selectionManager.removeComponentsFromSelection(this._compToRemove,this._DoNotUpdateCSO),this._bLockEvents||e.publish({event:"VCX_SELECTION_CHANGED"})},Invert:function(){var e=this._compToAdd;this._compToAdd=this._compToRemove,this._compToRemove=e},SaveContext:function(){},AddComponentsToSelection:function(e){if(!e)return!1;this._compToAdd=this._compToAdd.concat(e)},AddToSelection:function(e){if(e.QueryInterface("VCXIModifiable")===e){this._sendWarningIfNecessary("The method 'AddToSelection' used with a modifiable as parameter is now deprecated. Please use a component instead of a modifiable.","AddToSelection"),e=e.GetObject()}this._compToAdd.push(e)},RemoveComponentsFromSelection:function(e){if(!e)return!1;this._compToRemove=this._compToRemove.concat(e)},RemoveFromSelection:function(e){if(e.QueryInterface("VCXIModifiable")===e){this._sendWarningIfNecessary("The method 'RemoveFromSelection' used with a modifiable as parameter is now deprecated. Please use a component instead of a modifiable.","RemoveFromSelection"),e=e.GetObject()}this._compToRemove.push(e)},SetSelection:function(e){if(e&&e.QueryInterface("VCXIModifiable")===e){this._sendWarningIfNecessary("The method 'SetSelection' used with a modifiable as parameter is now deprecated. Please use a component instead of a modifiable.","SetSelection"),e=e.GetObject()}var t=this._selectionManager.GetComponentsFromCurrentSelection();if(e){var i,n=!1;(i=e.GetID())||console.log("VCXCmdChangeSelection: id is not defined for this component !");for(var r=0;r<t.length;r++){var o=t[r].GetID();o?o!==i?this.RemoveFromSelection(t[r]):n=!0:console.log("VCXCmdChangeSelection: currentId is empty !")}!n&&i&&this.AddToSelection(e)}else this.RemoveComponentsFromSelection(t)},SetComponentsSelection:function(e){for(var t=this._selectionManager.GetComponentsFromCurrentSelection(),i=0;i<t.length;i++){var n=t[i];if(n){for(var r=!1,o=0;o<e.length;o++){var a=e[o];if(a&&a===n){r=!0;break}}r||this.RemoveFromSelection(n)}}this.AddComponentsToSelection(e)},SetModifiablesSelection:function(e){this._sendWarningIfNecessary("/!\\ The method SetModifiablesSelection(arrModifiables) is DEPRECATED /!\\\nPlease use method cmdChangeSelection.SetComponentsSelection(arrComponents) instead.","SetModifiablesSelection");var t=e.map(function(e){return e.GetObject()});this.SetComponentsSelection(t)},SetLockEvents:function(e){this._bLockEvents=e}})}),define("DS/VCXWebKernel/VCXMarkerManager",["UWA/Class","DS/CoreEvents/Events"],function(e,t){"use strict";var i=e.extend({initialize:function(){this._callback=null;var e=this;this._tokenMarkerSeq=t.subscribe({event:"VCX_UPDATE_MARKER_SEQ"},function(t){e.UpdateMarkerSequence(t)})},unInitialize:function(){this._callback=null,this._tokenMarkerSeq&&(t.unsubscribe(this._tokenMarkerSeq),this._tokenMarkerSeq=null)},UpdateMarkerSequence:function(e){if(this._callback){var t=e.scenarioID,i=this._experienceBase.ComponentsMap.GetComponentFromID(t);if(i){var n=i.GetTrackMarkers();if(n){var r=n.GetPreviousKey(e.time);if(r){var o=r.GetValue();if(i.GetCurrentMarkerSequence()!==o&&(i.SetCurrentMarkerSequence(o),this._callback)){var a=this._experienceBase.ComponentsMap.GetComponentFromID(o);if(a){var s=a.GetTimePos(),c=a.GetName(),l=a.IsMilestone();this._callback(c,s,l,t,o)}}}}}}},RegisterMarkerSequenceCB:function(e){this._callback=e}});return Object.defineProperty(i.prototype,"componentType",{enumerable:!0,get:function(){return"VCXMarkerManager"}}),i}),define("DS/VCXWebKernel/VCXAContextualContent",["UWA/Class"],function(e){"use strict";var t=e.extend({appendContent:function(e,t,i){}});return t.content=[],t}),define("DS/VCXWebKernel/VCXMultiUserInputManager",["UWA/Class"],function(e){"use strict";var t=e.extend({postInitialize:function(){this._parent(),this._runningCommand=[]},unInitialize:function(){this._parent()},update:function(e){for(var t=0;t<this._runningCommand.length;t++)this._runningCommand[t].update&&this._runningCommand[t].update(e)},preRender:function(e){for(var t=0;t<this._runningCommand.length;t++)this._runningCommand[t].preRender&&this._runningCommand[t].preRender(e)},postRender:function(e){for(var t=0;t<this._runningCommand.length;t++)this._runningCommand[t].postRender&&this._runningCommand[t].postRender(e)},postUpdate:function(e){for(var t=0;t<this._runningCommand.length;t++)this._runningCommand[t].postUpdate&&this._runningCommand[t].postUpdate(e)},registerCommand:function(e){this._runningCommand.push(e)},unRegisterCommand:function(e){this._runningCommand.pop(e)}});return Object.defineProperty(t.prototype,"componentType",{enumerable:!0,get:function(){return"VCXMultiUserInputManager"}}),t}),define("DS/VCXWebKernel/VCXCmdGoToMarker",["DS/CoreEvents/Events","DS/VCXWebKernelCommands/VCXCommand","DS/VCXWebKernelCommands/VCXCmdChangeTimePos","DS/VCXWebKernelCommands/VCXCmdGoToScenario","DS/WebRBTree/WebRBIterator"],function(e,t,i,n,r){"use strict";return t.extend({init:function(e,t,i){this._parent(),this._scenarioManager=e,this._commandManager=t,this._ComponentsMap=i,this._bLockEvents=!1,this._targetMarker=null,this._frameForDo=null,this._frameForUndo=null,this._type="VCXCmdGoToMarker"},GetType:function(){return this._type},GetTitle:function(){return"Go to markers"},GoToMarker:function(e){this._targetMarker=this._ComponentsMap.GetComponentFromID(e),this._targetMarker&&(this._frameForDo=this._targetMarker.QueryInterface("VCXIModifiable").GetProperty("Actor.TimePos").GetPropertyValue().GetValue())},GoToNextMarker:function(){var e=this._scenarioManager.GetCurrentFrame(),t=this._scenarioManager.GetCurrentScenario(),i=this._ComponentsMap.GetComponentFromID(t),n=i.GetTrackMarkers(),r=!1;if(n){var o=n.GetNextStrictKey(e);if(null!==o){var a=o.GetValue(),s=o.GetFrame();this._targetMarker=this._ComponentsMap.GetComponentFromID(a),this._frameForDo=s,r=!0}}r||(this._frameForDo=i.GetMaxFrame())},GoToPreviousMarker:function(){var e=this._scenarioManager.GetCurrentFrame(),t=this._scenarioManager.GetCurrentScenario(),i=this._ComponentsMap.GetComponentFromID(t).GetTrackMarkers(),n=!1;if(i){var r=i.GetPreviousStrictKey(e);if(null!==r){var o=r.GetValue(),a=r.GetFrame();this._targetMarker=this._ComponentsMap.GetComponentFromID(o),this._frameForDo=a,n=!0}}n||(this._frameForDo=0)},Do:function(){if(this._targetMarker){var t=this._targetMarker.GetParentScenario();if(t!==this._scenarioManager.GetCurrentScenario()){var r=new n(this._scenarioManager,this._commandManager);r.GoToScenario(t),this._commandManager.Push(r)}}var o=new i(this._scenarioManager);o.ChangeTimePos(this._frameForDo),this._commandManager.Push(o);this._bLockEvents||e.publish({event:"VCX_GOTO_MARKER",data:this._frameForDo}),this._callback&&this._callback(this._parameter)},SaveContext:function(){this._frameForUndo=this._scenarioManager.GetCurrentFrame()},Redo:function(){this._bLockEvents||e.publish({event:"VCX_GOTO_MARKER",data:this._frameForDo})},Undo:function(){this._bLockEvents||e.publish({event:"VCX_GOTO_MARKER",data:this._frameForUndo})},Invert:function(){},SetLockEvents:function(e){this._bLockEvents=e}})}),define("DS/VCXWebKernel/VCXNotificationManager",["UWA/Class","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/VCXWebKernelTools/VCXLogServices","DS/UIKIT/Spinner","DS/Controls/ModalContainer","DS/Controls/ProgressBar","UWA/Core","css!DS/VCXWebKernel/VCXWebKernel.css","DS/Controls/Button","DS/VCXWebKernelTools/VCXTextTools"],function(e,t,i,n,r,o,a,s,c,l,p){"use strict";var h=e.extend({_notifCounter:0,_notifStack:{},_parentContainer:null,_curtainView:null,_progressBarView:null,_wuxNotifManager:null,_displayProgressBarInCurtainCounter:0,initialize:function(){i.setNotificationManager(t),i.setStackingPolicy(7),i.setRemoveStackOnFirstTimeoutFlag(!0)},postInitialize:function(){"undefined"!=typeof widget?this._parentContainer=widget.body:this._parentContainer=document.body,this._curtainView=new u,this._curtainView.setNotificationManager(this),this._curtainView.initialize(),this._progressBarView=new d,this._progressBarView.setNotificationManager(this),this._progressBarView.initialize()},unInitialize:function(){this.clearAllProgressNotifications(),this.clearAllNotifications(),this._curtainView.dispose(),delete this._curtainView,this._progressBarView.dispose(),delete this._progressBarView,this._notifStack={},this._resetNotificationIdGenerator(),this._parentContainer=null},getParentContainer:function(){return this._parentContainer},addNotification:function(e){e.category=e.message,e.idx=t.addNotif(e)},removeNotification:function(e,t){i.removeNotifications(e,t)},clearAllNotifications:function(){i.removeNotifications("",""),i.removeNotifications()},_generateNotificationId:function(){return this._notifCounter++,this._notifCounter},_resetNotificationIdGenerator:function(){this._notifCounter=0},_getNextNotificationWaiting:function(e){var t;for(var i in this._notifStack)if(this._notifStack.hasOwnProperty(i)){if(this._notifStack[i].maskDisplayAdd&this._notifStack[i].maskDisplayAddWaiting&e){t=i;break}if(this._notifStack[i].maskDisplayEnd&this._notifStack[i].maskDisplayEndWaiting&e){t=i;break}if(this._notifStack[i].maskDisplayErr&this._notifStack[i].maskDisplayErrWaiting&e){t=i;break}}return t},_hasNotificationDisplayed:function(e){var t=!1;for(var i in this._notifStack)if(this._notifStack.hasOwnProperty(i)){if(this._notifStack[i].maskDisplayAdd&~this._notifStack[i].maskDisplayAddWaiting&e){t=!0;break}if(this._notifStack[i].maskDisplayEnd&~this._notifStack[i].maskDisplayEndWaiting&e){t=!0;break}if(this._notifStack[i].maskDisplayErr&~this._notifStack[i].maskDisplayErrWaiting&e){t=!0;break}}return t},_getPercentValueToDisplay:function(e,t){var i,n=0;if(this._notifStack[e].displayProgressBarInCurtainFlag===h.FDisplayModeProgressBarInCurtain.CURRENT)this._notifStack[e].percentValue&&this._notifStack[e].maskDisplayAdd&t&&(n=this._notifStack[e].percentValue);else if(this._notifStack[e].displayProgressBarInCurtainFlag===h.FDisplayModeProgressBarInCurtain.SUM)for(i in this._notifStack)this._notifStack.hasOwnProperty(i)&&this._notifStack[i].percentValue&&this._notifStack[i].maskDisplayAdd&t&&(n+=this._notifStack[i].percentValue);else if(this._notifStack[e].displayProgressBarInCurtainFlag===h.FDisplayModeProgressBarInCurtain.MIN)for(i in this._notifStack)this._notifStack.hasOwnProperty(i)&&this._notifStack[i].percentValue&&this._notifStack[i].maskDisplayAdd&t&&(n=Math.min(n,this._notifStack[i].percentValue));else if(this._notifStack[e].displayProgressBarInCurtainFlag===h.FDisplayModeProgressBarInCurtain.MAX)for(i in this._notifStack)this._notifStack.hasOwnProperty(i)&&this._notifStack[i].percentValue&&this._notifStack[i].maskDisplayAdd&t&&(n=Math.max(n,this._notifStack[i].percentValue));return n},_completeVCXInputOptions:function(e){e.strObjectType=e.strObjectType||"",e.strObjectName=e.strObjectName||e.strObjectType,e.strAction=e.strAction||"Loading",e.strObjectType=p.htmlDecode(e.strObjectType),e.strObjectName=p.htmlDecode(e.strObjectName),e.strAction=p.htmlDecode(e.strAction),e.iPromise=e.iPromise||void 0,e.totalProgressLevel=e.totalProgressLevel||1,e.currentProgressLevel=e.currentProgressLevel||1,e.percentValue=e.percentValue||0,e.displayProgressBarInCurtainFlag=e.displayProgressBarInCurtainFlag||h.FDisplayModeProgressBarInCurtain.NONE,e.maskDisplayAdd=e.maskDisplayAdd||h.FDisplayMode.CONSOLE|h.FDisplayMode.BUBBLEFLOW,e.maskDisplayEnd=e.maskDisplayEnd||h.FDisplayMode.CONSOLE,e.maskDisplayErr=e.maskDisplayErr||h.FDisplayMode.CONSOLE|h.FDisplayMode.BUBBLEFLOW,e.maskDisplayAddWaiting=0,e.maskDisplayEndWaiting=0,e.maskDisplayErrWaiting=0},_updateVCXOptionsLabels:function(e,t){e.strObjectType=t.strObjectType||e.strObjectType,e.strObjectName=t.strObjectName||e.strObjectType,e.strAction=t.strAction||e.strAction,e.totalProgressLevel=t.totalProgressLevel||e.totalProgressLevel,e.currentProgressLevel=t.currentProgressLevel||e.currentProgressLevel,e.percentValue=t.percentValue||e.percentValue},getMaskFlag:function(e,t){return e&t},setMaskFlag:function(e,t,i){return void 0===i||i?e|=t:e&=~t,e},_completeWuxInfoOptions:function(e,t){t.level="info",t.sticky=!0,t.message=t.message||"",t.title=e.strAction+" "+e.strObjectType,t.subtitle=e.strObjectName},_completeWuxSuccessOptions:function(e,t){t.level="success",t.sticky=!1,t.message="",t.title=e.strAction+" "+e.strObjectType,t.subtitle=e.strObjectName},_completeWuxErrorOptions:function(e,t,i){t.level="error",t.sticky=!0,t.message=i,t.title=e.strAction+" "+e.strObjectType,t.subtitle=e.strObjectName},_completeWuxWarningOptions:function(e,t,i){t.level="warning",t.sticky=!0,t.message=i,t.title=e.strAction+" "+e.strObjectType,t.subtitle=e.strObjectName},addProgressNotification:function(e){var i=this._generateNotificationId();if(this._completeVCXInputOptions(e),this._notifStack[i]=e,this._notifStack[i].iPromise){var r=e.strAction+" "+e.strObjectType+" "+e.strObjectName;n.memoryLog(r,!0);var o=this;this._notifStack[i].iPromise.then(function(){o.endProgressNotification(i),n.memoryLog(r,!1)}).catch(function(e){o.errorProgressNotification(i,e),n.memoryLog(r,!1)})}if((this._notifStack[i].maskDisplayAdd&h.FDisplayMode.CURTAIN||this._notifStack[i].maskDisplayAdd&h.FDisplayMode.BUBBLEFLOWBUTCURTAIN&&this._hasNotificationDisplayed(h.FDisplayMode.CURTAIN))&&(this._curtainView.addNotificationElement(i,this._notifStack[i].strAction,this._notifStack[i].strObjectName)||(this._notifStack[i].maskDisplayAdd&h.FDisplayMode.CURTAIN?this._notifStack[i].maskDisplayAddWaiting=this.setMaskFlag(this._notifStack[i].maskDisplayAddWaiting,h.FDisplayMode.CURTAIN,!0):this._notifStack[i].maskDisplayAddWaiting=this.setMaskFlag(this._notifStack[i].maskDisplayAddWaiting,h.FDisplayMode.BUBBLEFLOWBUTCURTAIN,!0)),this._notifStack[i].displayProgressBarInCurtainFlag>h.FDisplayModeProgressBarInCurtain.NONE)){this._displayProgressBarInCurtainCounter++;var a=this._getPercentValueToDisplay(i,h.FDisplayMode.CURTAIN);this._displayProgressBarInCurtainCounter>0&&a&&(this._curtainView.updateProgressBar(a),this._curtainView._displayProgressBar())}if(this._notifStack[i].cancelButton&&this._curtainView._cancelButton.getContent().show(),this._notifStack[i].maskDisplayAdd&h.FDisplayMode.BUBBLEFLOW||this._notifStack[i].maskDisplayAdd&h.FDisplayMode.BUBBLEFLOWBUTCURTAIN&&!this._hasNotificationDisplayed(h.FDisplayMode.CURTAIN)){var s={};this._completeWuxInfoOptions(this._notifStack[i],s),this._notifStack[i].wuxNotifId=t.addNotif(s)}return this._notifStack[i].maskDisplayAdd&h.FDisplayMode.PROGRESSBAR&&(this._progressBarView.addNotificationElement(i,this._notifStack[i].strAction,this._notifStack[i].strObjectName)||(this._notifStack[i].maskDisplayAddWaiting=this.setMaskFlag(this._notifStack[i].maskDisplayAddWaiting,h.FDisplayMode.PROGRESSBAR,!0))),this._notifStack[i].maskDisplayAdd&h.FDisplayMode.CONSOLE&&console.log("addProgressNotification: "+this._notifStack[i].strAction+" : "+this._notifStack[i].strObjectName),i},updateProgressNotification:function(e,i){if(this._notifStack[e]){var n="",r="";if(i?this._updateVCXOptionsLabels(this._notifStack[e],i):(r=": "+(n=this._notifStack[e].currentProgressLevel+"/"+this._notifStack[e].totalProgressLevel),this._notifStack[e].currentProgressLevel=Math.min(this._notifStack[e].currentProgressLevel+1,this._notifStack[e].totalProgressLevel)),(this._notifStack[e].maskDisplayAdd&~this._notifStack[e].maskDisplayAddWaiting&h.FDisplayMode.CURTAIN||this._notifStack[e].maskDisplayAdd&~this._notifStack[e].maskDisplayAddWaiting&h.FDisplayMode.BUBBLEFLOWBUTCURTAIN&&this._hasNotificationDisplayed(h.FDisplayMode.CURTAIN))&&(this._curtainView.updateNotificationElement(e,this._notifStack[e].strAction,this._notifStack[e].strObjectName+r),this._notifStack[e].displayProgressBarInCurtainFlag>0)){var o=this._getPercentValueToDisplay(e,h.FDisplayMode.CURTAIN);this._displayProgressBarInCurtainCounter>0&&o&&(this._curtainView.updateProgressBar(o),this._curtainView._displayProgressBar())}if(this._notifStack[e].maskDisplayAdd&~this._notifStack[e].maskDisplayAddWaiting&h.FDisplayMode.BUBBLEFLOW||this._notifStack[e].maskDisplayAdd&~this._notifStack[e].maskDisplayAddWaiting&h.FDisplayMode.BUBBLEFLOWBUTCURTAIN&&!this._hasNotificationDisplayed(h.FDisplayMode.CURTAIN)){var a={message:n};this._completeWuxInfoOptions(this._notifStack[e],a),this._notifStack[e].wuxNotifId&&t.modifyNotif(this._notifStack[e].wuxNotifId,a)}this._notifStack[e].maskDisplayAdd&~this._notifStack[e].maskDisplayAddWaiting&h.FDisplayMode.PROGRESSBAR&&this._progressBarView.updateNotificationElement(e,this._notifStack[e].strAction,this._notifStack[e].strObjectName+r),this._notifStack[e].maskDisplayAdd&~this._notifStack[e].maskDisplayAddWaiting&h.FDisplayMode.CONSOLE&&console.log("updateProgressNotification: "+this._notifStack[e].strAction+" "+this._notifStack[e].strObjectName+r)}else console.error("unexpected behavior: updateProgressNotification called on a non stacked notification: "+e)},_endDisplayInProgress:function(e){if(this._notifStack[e]){var n,r,o;if(this._notifStack[e].maskDisplayAdd&h.FDisplayMode.CURTAIN||this._notifStack[e].maskDisplayAdd&h.FDisplayMode.BUBBLEFLOWBUTCURTAIN&&this._hasNotificationDisplayed(h.FDisplayMode.CURTAIN))if(~this._notifStack[e].maskDisplayAddWaiting&(h.FDisplayMode.CURTAIN|h.FDisplayMode.BUBBLEFLOWBUTCURTAIN)){if(this._curtainView.removeNotificationElement(e),this._notifStack[e].maskDisplayAdd=this.setMaskFlag(this._notifStack[e].maskDisplayAdd,h.FDisplayMode.CURTAIN,!1),this._notifStack[e].maskDisplayAdd=this.setMaskFlag(this._notifStack[e].maskDisplayAdd,h.FDisplayMode.BUBBLEFLOWBUTCURTAIN,!1),this._notifStack[e].displayProgressBarInCurtainFlag>h.FDisplayModeProgressBarInCurtain.NONE&&this._displayProgressBarInCurtainCounter--,this._displayProgressBarInCurtainCounter<1&&this._curtainView._hideProgressBar(),n=this._getNextNotificationWaiting(h.FDisplayMode.CURTAIN)){if(o=!(r=this._curtainView.addNotificationElement(n,this._notifStack[n].strAction,this._notifStack[n].strObjectName)),this._notifStack[n].maskDisplayAddWaiting=this.setMaskFlag(this._notifStack[n].maskDisplayAddWaiting,h.FDisplayMode.CURTAIN,o),this._notifStack[n].displayProgressBarInCurtainFlag>h.FDisplayModeProgressBarInCurtain.NONE){var a=this._getPercentValueToDisplay(n,h.FDisplayMode.CURTAIN);this._displayProgressBarInCurtainCounter>0&&a&&(this._curtainView.updateProgressBar(a),this._curtainView._displayProgressBar())}}else if(this._hasNotificationDisplayed(h.FDisplayMode.CURTAIN))(n=this._getNextNotificationWaiting(h.FDisplayMode.BUBBLEFLOWBUTCURTAIN))&&(o=!(r=this._curtainView.addNotificationElement(n,this._notifStack[n].strAction,this._notifStack[n].strObjectName)),this._notifStack[n].maskDisplayAddWaiting=this.setMaskFlag(this._notifStack[n].maskDisplayAddWaiting,h.FDisplayMode.BUBBLEFLOWBUTCURTAIN,o));else for(n in this._notifStack)if(this._notifStack.hasOwnProperty(n)&&(this._notifStack[n].maskDisplayAdd|this._notifStack[n].maskDisplayAddWaiting)&h.FDisplayMode.BUBBLEFLOWBUTCURTAIN){this._curtainView.isNotificationElementDisplayed(n)?this._curtainView.removeNotificationElement(n):this._notifStack[n].maskDisplayAddWaiting=this.setMaskFlag(this._notifStack[n].maskDisplayAddWaiting,h.FDisplayMode.BUBBLEFLOWBUTCURTAIN,!1);var s={};this._completeWuxInfoOptions(this._notifStack[n],s),this._notifStack[n].wuxNotifId=t.addNotif(s)}}else this._notifStack[e].maskDisplayAddWaiting=this.setMaskFlag(this._notifStack[e].maskDisplayAddWaiting,h.FDisplayMode.CURTAIN,!1),this._notifStack[e].maskDisplayAddWaiting=this.setMaskFlag(this._notifStack[e].maskDisplayAddWaiting,h.FDisplayMode.BUBBLEFLOWBUTCURTAIN,!1);this._notifStack[e].cancelButton&&this._curtainView._cancelButton.getContent().hide(),(this._notifStack[e].maskDisplayAdd&h.FDisplayMode.BUBBLEFLOW||this._notifStack[e].maskDisplayAdd&h.FDisplayMode.BUBBLEFLOWBUTCURTAIN&&!this._hasNotificationDisplayed(h.FDisplayMode.CURTAIN))&&(i.removeNotification(this._notifStack[e].wuxNotifId),this._notifStack[e].maskDisplayAdd=this.setMaskFlag(this._notifStack[e].maskDisplayAdd,h.FDisplayMode.BUBBLEFLOW,!1),this._notifStack[e].maskDisplayAdd=this.setMaskFlag(this._notifStack[e].maskDisplayAdd,h.FDisplayMode.BUBBLEFLOWBUTCURTAIN,!1)),this._notifStack[e].maskDisplayAdd&h.FDisplayMode.PROGRESSBAR&&(~this._notifStack[e].maskDisplayAddWaiting&h.FDisplayMode.PROGRESSBAR?(this._progressBarView.removeNotificationElement(e),this._notifStack[e].maskDisplayAdd=this.setMaskFlag(this._notifStack[e].maskDisplayAdd,h.FDisplayMode.PROGRESSBAR,!1),(n=this._getNextNotificationWaiting(h.FDisplayMode.PROGRESSBAR))&&(r=this._progressBarView.addNotificationElement(n,this._notifStack[n].strAction,this._notifStack[n].strObjectName),this._notifStack[n].maskDisplayAddWaiting=r?this.setMaskFlag(this._notifStack[n].maskDisplayAddWaiting,h.FDisplayMode.PROGRESSBAR,!1):this.setMaskFlag(this._notifStack[n].maskDisplayAddWaiting,h.FDisplayMode.PROGRESSBAR,!0))):this._notifStack[e].maskDisplayAddWaiting=this.setMaskFlag(this._notifStack[e].maskDisplayAddWaiting,h.FDisplayMode.PROGRESSBAR,!1))}else console.error("unexpected behavior: _endDisplayInProgress called on a non stacked notification: "+e)},endProgressNotification:function(e){if(this._notifStack[e]){if(this._endDisplayInProgress(e),this._notifStack[e].maskDisplayEnd&h.FDisplayMode.BUBBLEFLOW||this._notifStack[e].maskDisplayEnd&h.FDisplayMode.BUBBLEFLOWBUTCURTAIN&&!this._hasNotificationDisplayed(h.FDisplayMode.CURTAIN)){var i={};this._completeWuxSuccessOptions(this._notifStack[e],i),this._notifStack[e].wuxNotifId=t.addNotif(i)}this._notifStack[e].maskDisplayEnd&~this._notifStack[e].maskDisplayEndWaiting&h.FDisplayMode.CONSOLE&&console.log("endProgressNotification: "+this._notifStack[e].strAction+" "+this._notifStack[e].strObjectName),delete this._notifStack[e]}else console.error("unexpected behavior: endProgressNotification called on a non stacked notification: "+e)},errorProgressNotification:function(e,i){var n="object"==typeof i&&i.message?i.message:i;if(this._notifStack[e]){if(this._endDisplayInProgress(e),this._notifStack[e].maskDisplayErr&h.FDisplayMode.BUBBLEFLOW||this._notifStack[e].maskDisplayErr&h.FDisplayMode.BUBBLEFLOWBUTCURTAIN&&!this._hasNotificationDisplayed(h.FDisplayMode.CURTAIN)){var r={};this._completeWuxErrorOptions(this._notifStack[e],r,n),this._notifStack[e].wuxNotifId=t.addNotif(r)}this._notifStack[e].maskDisplayErr&h.FDisplayMode.CONSOLE&&(console.log("errorProgressNotification: "+this._notifStack[e].strAction+" "+this._notifStack[e].strObjectName+" : "+n),console.error(i)),delete this._notifStack[e]}else console.error("unexpected behavior: endProgressNotification called on a non stacked notification: "+e)},stopProgressNotification:function(e){console.log("stopProgressNotification: "+this._notifStack[e].strAction+" "+this._notifStack[e].strObjectName),this._notifStack[e]?(this._endDisplayInProgress(e),delete this._notifStack[e]):console.error("unexpected behavior: stopProgressNotification called on a non stacked notification: "+e)},clearAllProgressNotifications:function(){for(var e in this._notifStack)this._notifStack.hasOwnProperty(e)&&this.stopProgressNotification(e)}});Object.defineProperty(h.prototype,"componentType",{enumerable:!0,get:function(){return"VCXNotificationManager"}});var u=e.extend({_counter:0,_notificationElements:{},_maxLength:4,_notificationCurtainContainer:null,_notificationCurtainContent:null,_notificationCurtainTileTop:null,_notificationCurtainTileMiddle:null,_notificationCurtainHeader:null,_notificationCurtainTitle:null,_notificationCurtainList:null,_notificationCurtainSpinner:null,_notificationCurtainTileBottom:null,_notificationCurtainProgressBar:null,_manager:null,initialize:function(){this._buildView()},dispose:function(){this._deleteView(),this._manager=null,this._counter=0,this._notificationElements={}},setNotificationManager:function(e){this._manager!==e&&(this._manager=e,this._manager)},addNotificationElement:function(e,t,i){var n=!1;if(this._counter<this._maxLength){var r=s.createElement("p",{text:i});r.setAttribute("title",i),r.inject(this._notificationCurtainList),this._notificationElements[e]=r,this._counter++,1===this._counter&&(this._notificationCurtainTitle.innerHTML=t,this._displayView()),n=!0}else n=!1;return n},isNotificationElementDisplayed:function(e){var t=!1;return this._notificationElements[e]&&(t=!0),t},updateNotificationElement:function(e,t,i){this._notificationElements[e]&&(this._notificationElements[e].innerHTML=i,this._notificationElements[e].setAttribute("title",i),this._notificationCurtainTitle.innerHTML=t,this._displayView())},updateProgressBar:function(e){this._notificationCurtainProgressBar.value=void 0!==e?e:0},removeNotificationElement:function(e){this._notificationElements[e]&&(this._notificationElements[e].remove(),delete this._notificationElements[e],this._counter--,0===this._counter&&this._hideView())},_buildView:function(){if(!this._notificationCurtainContainer&&this._manager){var e=this._manager.getParentContainer();if(e){this._notificationCurtainContainer=s.Element("div",{html:"",class:"vcx-Notification-Curtain-Container"}).inject(e).hide(),this._notificationCurtainContent=s.Element("div",{html:"",class:"vcx-Notification-Curtain-Content xapp-waiting-container"}),this._notificationCurtainContent.setAttribute("isVisible","false"),this._notificationCurtainTileTop=s.Element("div",{html:"",class:"vcx-Notification-Curtain-Tile-Top"}).inject(this._notificationCurtainContent),this._notificationCurtainTileMiddle=s.Element("div",{html:"",class:"vcx-Notification-Curtain-Tile-Middle xapp-waiting-title"}).inject(this._notificationCurtainContent);var t=this;this._cancelButton=new l({label:"Cancel"}).inject(this._notificationCurtainContent),this._cancelButton.getContent().addEventListener("buttonclick",function(){return t._manager._experienceBase.getManager("VCXPlatformServicesManager").DisplayConfirmCancelModal()}),this._cancelButton.elements.container.classList.add("vcx-Notification-Cancel-Button"),this._cancelButton.getContent().hide(),this._notificationCurtainHeader=s.Element("div",{text:"",class:"vcx-Notification-Curtain-Header xapp-spinner-thumbnail"}).inject(this._notificationCurtainTileMiddle),this._notificationCurtainSpinner=new r,this._notificationCurtainHeader.addContent(this._notificationCurtainSpinner),this._notificationCurtainTitle=s.Element("div",{text:"",class:"vcx-Notification-Curtain-Title xapp-waiting-type"}).inject(this._notificationCurtainHeader),this._notificationCurtainList=s.Element("div",{html:"",class:"vcx-Notification-Curtain-List xapp-waiting-model"}).inject(this._notificationCurtainTileMiddle),this._notificationCurtainTileBottom=s.Element("div",{html:"",class:"vcx-Notification-Curtain-Tile-Bottom"}).inject(this._notificationCurtainContent),this._notificationCurtainProgressBar=new a({displayStyle:"lite",infiniteFlag:!1,value:0}).inject(this._notificationCurtainTileBottom),this._hideProgressBar();try{o.createModal(this._notificationCurtainContainer,this._notificationCurtainContent)}catch(e){console.error("WebUX/Controls.mweb/ModalContainer/createModal throws an error : VCXWebKernel.css probably not finished to be loaded"),console.error(e)}}}},_deleteView:function(){this._notificationCurtainTileTop&&(this._notificationCurtainTileTop.remove(),delete this._notificationCurtainTileTop),this._notificationCurtainList&&(this._notificationCurtainList.remove(),delete this._notificationCurtainList),this._notificationCurtainTitle&&(this._notificationCurtainTitle.remove(),delete this._notificationCurtainTitle),this._notificationCurtainSpinner&&(this._notificationCurtainSpinner.remove(),delete this._notificationCurtainSpinner),this._notificationCurtainHeader&&(this._notificationCurtainHeader.remove(),delete this._notificationCurtainHeader),this._notificationCurtainTileMiddle&&(this._notificationCurtainTileMiddle.remove(),delete this._notificationCurtainTileMiddle),this._cancelButton&&(this._cancelButton.remove(),delete this._cancelButton),this._notificationCurtainProgressBar&&(this._notificationCurtainProgressBar.remove(),delete this._notificationCurtainProgressBar),this._notificationCurtainTileBottom&&(this._notificationCurtainTileBottom.remove(),delete this._notificationCurtainTileBottom),this._notificationCurtainContent&&(this._notificationCurtainContent.remove(),delete this._notificationCurtainContent);try{o.removeModal(this._notificationCurtainContainer)}catch(e){}this._notificationCurtainContainer&&(this._notificationCurtainContainer.remove(),delete this._notificationCurtainContainer)},_addTempStyle:function(){console.warn("adding temporary style");var e=document.querySelector(".xapp-background-image");console.warn(e),e&&(e.style.webkitFilter="blur(5px)",e.style.filter="blur(5px)");var t=document.querySelector(".xapp-app-container");console.warn(t),t&&(t.style.visibility="hidden");var i=document.querySelector(".vcx-Notification-Curtain-Title");i&&(i.style.fontSize="4rem")},_removeTempStyle:function(){console.warn("removing temporary style");var e=document.querySelector(".xapp-background-image");e&&(e.style.webkitFilter=null,e.style.filter=null);var t=document.querySelector(".xapp-app-container");t&&(t.style.visibility=null)},_displayView:function(){this._notificationCurtainContainer.show(),this._notificationCurtainSpinner.show(),this._manager._displayProgressBarInCurtainCounter>0&&this._displayProgressBar(),this._notificationCurtainContent.setAttribute("isVisible","true"),this._addTempStyle()},_hideView:function(){if(this._notificationCurtainContainer&&this._notificationCurtainContent&&this._notificationCurtainTitle)this._notificationCurtainContent.setAttribute("isVisible","false"),this._removeTempStyle(),this._notificationCurtainTitle.innerHTML="",this._notificationCurtainContainer.hide();else{console.error(new Error("VCXNotificationManagerViewInCurtain._hideView: Unexpected behavior! _notificationCurtainContainer is undefined"))}},_displayProgressBar:function(){this._notificationCurtainProgressBar.show()},_hideProgressBar:function(){this._notificationCurtainProgressBar.hide()}}),d=e.extend({_counter:0,_notificationElements:{},_maxLength:1,_notificationProgressBarContainer:null,_notificationProgressBarContent:null,_notificationProgressBarTile:null,_progressBar:null,_manager:null,initialize:function(){this._buildView()},dispose:function(){this._deleteView(),this._manager=null,this._counter=0,this._notificationElements={}},setNotificationManager:function(e){this._manager!==e&&(this._manager=e,this._manager)},addNotificationElement:function(e,t,i){var n=!1;if(this._counter<this._maxLength){var r=t+" "+i,o=s.createElement("p",{text:r});o.setAttribute("title",r),o.inject(this._notificationProgressBarTile),this._notificationElements[e]=o,this._counter++,1===this._counter&&this._displayView(),n=!0}else n=!1;return n},updateNotificationElement:function(e,t,i){var n=t+" "+i;this._notificationElements[e]&&(this._notificationElements[e].innerHTML=n,this._notificationElements[e].setAttribute("title",n),this._displayView())},removeNotificationElement:function(e){this._notificationElements[e]&&(this._notificationElements[e].remove(),delete this._notificationElements[e],this._counter--,0===this._counter&&this._hideView())},_buildView:function(){if(!this._notificationProgressBarContainer&&this._manager){var e=this._manager.getParentContainer();if(e){this._notificationProgressBarContainer=s.Element("div",{html:"",class:"vcx-Notification-Progress-Bar-Container"}).inject(e).hide(),this._notificationProgressBarContent=s.Element("div",{html:"",class:"vcx-Notification-Progress-Bar-Content"}),this._notificationProgressBarContent.setAttribute("isVisible","false"),this._notificationProgressBarTile=s.Element("div",{text:"",class:"vcx-Notification-Progress-Bar-Tile"}).inject(this._notificationProgressBarContent),this._progressBar=new a({displayStyle:"lite"}).inject(this._notificationProgressBarTile),this._progressBar.infiniteFlag=!0;try{o.createModal(this._notificationProgressBarContainer,this._notificationProgressBarContent)}catch(e){console.error("WebUX/Controls.mweb/ModalContainer/createModal throws an error : VCXWebKernel.css probably not finished to be loaded"),console.error(e)}}}},_deleteView:function(){this._progressBar&&(this._progressBar.remove(),delete this._progressBar),this._notificationProgressBarContent&&(this._notificationProgressBarContent.remove(),delete this._notificationProgressBarContent);try{o.removeModal(this._notificationProgressBarContainer)}catch(e){}this._notificationProgressBarContainer&&(this._notificationProgressBarContainer.remove(),delete this._notificationProgressBarContainer)},_displayView:function(){this._notificationProgressBarContainer.show(),this._notificationProgressBarContent.show(),this._progressBar.show(),this._notificationProgressBarContent.setAttribute("isVisible","true")},_hideView:function(){if(this._notificationProgressBarContainer)this._notificationProgressBarContent.setAttribute("isVisible","false"),this._notificationProgressBarContainer.hide();else{console.error(new Error("VCXNotificationManagerViewInProgressBar._hideView: Unexpected behavior! _notificationProgressBarContainer is undefined"))}}});return h.FDisplayMode={SILENT:1,CONSOLE:2,BUBBLEFLOW:4,PROGRESSBAR:8,CURTAIN:16,BUBBLEFLOWBUTCURTAIN:32},h.FDisplayModeProgressBarInCurtain={NONE:0,CURRENT:1,SUM:2,MIN:3,MAX:4},h}),define("DS/VCXWebKernel/VCXDRMManager",["UWA/Class"],function(e){"use strict";var t=e.extend({init:function(){},initialize:function(){this._bDisplayWatermark=!1,this._bDisplaySignature=!1,this._bValidSignature=!0,this._bDisplayTree=!0,this._bValidDate=!0,this._bDisplayTimeline=!0,this._bDisplayPropertiesPanel=!0,this._bDisplayScenariosPanel=!0,this._bImmersiveNavigation=!0,this._bDisplayPaper=!1},SetDisplayWatermark:function(e){this._bDisplayWatermark=e},GetDisplayWatermark:function(){return this._bDisplayWatermark},SetDisplaySignature:function(e){this._bDisplaySignature=e},GetDisplaySignature:function(){return this._bDisplaySignature},SetValidSignature:function(e){this._bValidSignature=e},GetValidSignature:function(){return this._bValidSignature},SetDisplayTree:function(e){this._bDisplayTree=e},GetDisplayTree:function(){var e=this._experienceBase.getManager("VCXContextManager").getSimulatePlayMode();return("undefined"==typeof widget||!e)&&this._bDisplayTree},SetValidDate:function(e){this._bValidDate=e},GetValidDate:function(){return this._bValidDate},SetDisplayTimeline:function(e){this._bDisplayTimeline=e},GetDisplayTimeline:function(){return this._bDisplayTimeline},SetDisplayPropertiesPanel:function(e){this._bDisplayPropertiesPanel=e},GetDisplayPropertiesPanel:function(){var e=this._experienceBase.getManager("VCXContextManager").getSimulatePlayMode();return("undefined"==typeof widget||!e)&&this._bDisplayPropertiesPanel},SetDisplayScenariosPanel:function(e){this._bDisplayScenariosPanel=e},GetDisplayScenariosPanel:function(){return this._bDisplayScenariosPanel},SetImmersiveNavigation:function(e){this._bImmersiveNavigation=e},GetImmersiveNavigation:function(){var e=this._experienceBase.getManager("VCXContextManager").getSimulatePlayMode();return!("undefined"==typeof widget||!e)||this._bImmersiveNavigation},SetDisplayPaper:function(e){this._bDisplayPaper=e},GetDisplayPaper:function(){return this._bDisplayPaper},GetType:function(){return"VCXDRMManager"}});return t.LitSignatureMode={LIT_SIGNATURE_DISPLAY_AND_BLOCK:0,LIT_SIGNATURE_DISPLAY_AND_PASS:1,LIT_SIGNATURE_NO_DISPLAY:2},t}),define("DS/VCXWebKernel/VCXWebSelectionManager",["DS/Core/Core","DS/CoreEvents/Events","UWA/Class","DS/VCXWebModifiablesServices/VCXModifiablesAccess","DS/VCXWebModifiablesServices/VCXModifiablesServices","DS/VCXWebExperienceBase/VCXSceneGraphOverridesServices","DS/SceneGraphOverrides/SceneGraphOverrideSet"],function(e,t,i,n,r,o,a){"use strict";var s=i.extend({postInitialize:function(){this._setComponents={},this.activatePrepicking(!0),this._defaultHLValue=!0;var e=this._experienceBase.getManager("VCXContextManager").getTrapSelectionRequirements();this.setTrapSelection(e.pick,e.prePick),this._excludeParts=!1,this._excludeDressups=!1,this._keepLinkSelectable=!0,this._keepHotspotsSelectable=!0,this._keepAssemblySelectionModeActive=!1,this._apiCBAddSel=null,this._apiCBRemoveSel=null,this._WUXEventTokens={},this._WUXEventTokens.VCX_SELECTION_COMPONENTSLIST_ADD=t.subscribe({event:"VCX_SELECTION_COMPONENTSLIST_ADD"},e=>{if(this._apiCBAddSel){for(var t=[],i=0;i<e.length;i++){var n=e[i];n&&t.push(n.GetID())}this._apiCBAddSel(t)}}),this._WUXEventTokens.VCX_SELECTION_COMPONENTSLIST_REMOVE=t.subscribe({event:"VCX_SELECTION_COMPONENTSLIST_REMOVE"},e=>{if(this._apiCBRemoveSel){for(var t=[],i=0;i<e.length;i++){var n=e[i];n&&t.push(n.GetID())}this._apiCBRemoveSel(t)}}),this._WUXEventTokens.VCX_TEMPORARILY_HIDE_DECORATION=t.subscribe({event:"VCX_TEMPORARILY_HIDE_DECORATION"},e=>{e&&e.viewer&&this.SetHighlightRenderVisibility(e.viewer,!1)}),this._WUXEventTokens.VCX_RESTORE_TEMPORARILY_HIDDEN_DECORATION=t.subscribe({event:"VCX_RESTORE_TEMPORARILY_HIDDEN_DECORATION"},e=>{e&&e.viewer&&this.SetHighlightRenderVisibility(e.viewer,!0)}),this._WUXEventTokens.previewModeEvent=t.subscribe({event:"VCX_PREVIEW_MODE_CHANGED"},e=>{this.previewModeActivated=e;var t=(this._experienceBase&&this._experienceBase.getManager("VCXContextManager")).getMainViewer();this.SetHighlightRenderVisibility(t,!e)})},unInitialize:function(){for(var i in this._WUXEventTokens)this._WUXEventTokens.hasOwnProperty(i)&&this._WUXEventTokens[i]&&(t.unsubscribe(this._WUXEventTokens[i]),this._WUXEventTokens[i]=null);e.Selection.CSOManager.empty(!1),e.Selection.HSOManager.empty(!1),e.Selection.PSOManager.empty(!1),this._setComponents={},this.filterXSO(),this._apiCBAddSel=null,this._apiCBRemoveSel=null},SetHighlightRenderVisibility:function(e,t){if(t){if(this.previewModeActivated)return;if(!this.LockVCXEvents)return;if((i=e&&e.internalSceneGraph&&e.internalSceneGraph&&e.internalSceneGraph.selectionHL)&&this.HLData)(n=i.getHighlightData()).colorEnabled=this.HLData.colorEnabled,n.haloEnabled=this.HLData.haloEnabled,n.outlineEnabled=this.HLData.outlineEnabled,n.priority=this.HLData.priority,i.setHighlightData(this.HLData.polite,n);if((i=e&&e.internalSceneGraph&&e.internalSceneGraph&&e.internalSceneGraph.selectionPreHL)&&this.PreHLData)(n=i.getHighlightData()).colorEnabled=this.PreHLData.colorEnabled,n.haloEnabled=this.PreHLData.haloEnabled,n.outlineEnabled=this.PreHLData.outlineEnabled,n.priority=this.PreHLData.priority,i.setHighlightData(this.PreHLData.polite,n);this.LockVCXEvents=!1}else{if(this.LockVCXEvents)return;var i;if(this.LockVCXEvents=!0,i=e&&e.internalSceneGraph&&e.internalSceneGraph&&e.internalSceneGraph.selectionHL){this.HLData={},this.HLData.polite=i.advanced;var n=i.getHighlightData();this.HLData.colorEnabled=n.colorEnabled,this.HLData.haloEnabled=n.haloEnabled,this.HLData.outlineEnabled=n.outlineEnabled,this.HLData.priority=n.priority,n.colorEnabled=!1,n.haloEnabled=!1,n.outlineEnabled=!1,n.priority=-100,i.setHighlightData(!0,n)}if(i=e&&e.internalSceneGraph&&e.internalSceneGraph&&e.internalSceneGraph.selectionPreHL){this.PreHLData={},this.PreHLData.polite=i.advanced;n=i.getHighlightData();this.PreHLData.colorEnabled=n.colorEnabled,this.PreHLData.haloEnabled=n.haloEnabled,this.PreHLData.outlineEnabled=n.outlineEnabled,this.PreHLData.priority=n.priority,n.colorEnabled=!1,n.haloEnabled=!1,n.outlineEnabled=!1,n.priority=-100,i.setHighlightData(!0,n)}}},RegisterAddSelectionCB:function(e){this._apiCBAddSel=e},RegisterRemoveSelectionCB:function(e){this._apiCBRemoveSel=e},_getSubStructNameFromComponent:function(e){var t="others";return e.IsKindOf("VCXScenario")?t="scenarios":e.QueryInterface("W3AISGNodeHolder")&&(t="visu"),this._setComponents[t]||(this._setComponents[t]={}),t},GetSelection:function(t){var i=null;return"CSO"===t?i=e.Selection.CSOManager:"HSO"===t?i=e.Selection.HSOManager:"PSO"===t&&(i=e.Selection.PSOManager),i.get()},ProcessComponentsFromSelection:function(e,t){if(t)for(var i=this.GetComponentsFromSelection(e),n=0;n<i.length;n++)t(i[n])},ChangeSelectionForContextual:function(){if(!this._experienceBase.getManager("VCXGUIManager").isTouchActivated()){var e=!1,t=this.GetComponentsFromSelection("CSO");this.GetComponentsFromSelection("PSO").length<1||(this.ProcessComponentsFromSelection("PSO",function(i){for(var n=i&&i.QueryInterface("VCXIModelNavigable");n&&!e;)t.includes(n.GetObject())&&(e=!0),n=n.getParent()===n?null:n.getParent()}),e||(this.removeComponentsFromSelection(t,!1),this.addComponentsToSelection(this.GetComponentsFromSelection("PSO"))))}},GetComponentsFromSelection:function(e){if("CSO"===e)return this.GetComponentsFromCurrentSelection();var t=[],i=this.GetSelection(e);if(void 0===i)return t;for(var r={},o=i.length,a=0;a<o;a++){var s=i[a];if(void 0!==s){var c=this._experienceBase.ComponentsMap.GetComponentFromPathElement(s.pathElement);if(!c){var l=n.BuildCleanedPathElement(s.pathElement);(c=this._experienceBase.ComponentsMap.GetComponentFromPathElement(l))&&c.IsKindOf("VCXDressup_Spec")&&(c=null)}c&&!r[c.GetID()]&&(t.push(c),r[c.GetID()]=c)}}return t},setComponentsAsSelection:function(e,t){if(this._experienceBase.odt){var i=this.GetComponentsFromCurrentSelection();this._logForODTRecord(i,!0)}this._setComponents={},this.addComponentsToSelection(e,!0),t||this.RefreshXSO()},addComponentsToSelection:function(e,i){if(Array.isArray(e)){if(0!==e.length){"boolean"!=typeof i&&(i=!1);var n=[],r=[];if(this._keepAssemblySelectionModeActive){for(var o=0;o<e.length;++o){var a=e[o];if(a&&a.IsKindOf("VCXComponentOccurrenceExt")&&a.IsMesh()){var s,c=a.QueryInterface("VCXIModelNavigable").getParent();c&&(s=c.GetObject())&&(n.push(s),r.push(a))}}n.length<=0&&(n=e),this._addToSelectionCache(n)}else this._addToSelectionCache(e);if(this._componentsJustAdded&&0!==this._componentsJustAdded.length){var l=this._componentsJustAdded.slice(0);this._componentsJustAdded=null,i||this.RefreshXSO(),this.LockVCXEvents||(t.publish({event:"VCX_SELECTION_COMPONENTSLIST_ADD",data:l}),this._keepAssemblySelectionModeActive&&t.publish({event:"VCX_SELECTION_COMPONENTSLIST_REMOVE_FROM_TREE_ASSY_SEL",data:r})),this._experienceBase.odt&&this._logForODTRecord(l,!1)}}}else console.log("[VCXWebSelectionManager] An array is required as first argument of the 'addComponentsToSelection' method.")},removeComponentsFromSelection:function(e,i){if(Array.isArray(e)){if(0!==e.length&&("boolean"!=typeof i&&(i=!1),this._removeFromSelectionCache(e),this._componentsJustRemoved&&0!==this._componentsJustRemoved.length)){var n=this._componentsJustRemoved.slice(0);this._componentsJustRemoved=null,i||this.RefreshXSO(n),this.LockVCXEvents||t.publish({event:"VCX_SELECTION_COMPONENTSLIST_REMOVE",data:n}),this._experienceBase.odt&&this._logForODTRecord(n,!0);var r=this;r.HasActors()||(r.outTimer=window.setTimeout(function(){r.HasActors()||this.LockVCXEvents||t.publish({event:"VCX_SELECTED_ACTORS_EMPTY"})},200))}}else console.log("[VCXWebSelectionManager] An array is required as first argument of the 'removeComponentsFromSelection' method.")},_alterSelectionCache:function(e,t){var i="_removeFromSelectionCache",n="_removeCompChildrenToSelectionCache";t&&(i="_addToSelectionCache",n="_addCompChildrenToSelectionCache");for(var r=0;r<e.length;++r){var o=e[r];if(o){var a=o.QueryInterface("VCXIModifiable"),s=o.QueryInterface("VCXISelectBehavior");if(s){var c=s.GetListForSelection();this[i](c)}else if(a){var l=o.GetID(),p=this._getSubStructNameFromComponent(o);l&&(t&&this._setComponents[p][l]!==o?(this._setComponents[p][l]=o,this._componentsJustAdded||(this._componentsJustAdded=[]),this._componentsJustAdded.push(o)):t||this._setComponents[p][l]!==o||(delete this._setComponents[p][l],this._componentsJustRemoved||(this._componentsJustRemoved=[]),this._componentsJustRemoved.push(o)))}else this[n](o)}}},_addToSelectionCache:function(e){this._alterSelectionCache(e,!0)},_removeFromSelectionCache:function(e){this._alterSelectionCache(e,!1)},_alterSelectionCacheWithCompChildren:function(e,t){for(var i=e.QueryInterface("VCXIModelNavigable"),n=i&&i.getChildren(),r=0;r<n.length;++r){var o=n[r].GetObject(),a=o.GetID();if(a){var s=this._getSubStructNameFromComponent(o);t&&this._setComponents[s][a]!==o?(this._setComponents[s][a]=o,this._componentsJustAdded||(this._componentsJustAdded=[]),this._componentsJustAdded.push(o)):t||this._setComponents[s][a]!==o||(delete this._setComponents[s][a],this._componentsJustRemoved||(this._componentsJustRemoved=[]),this._componentsJustRemoved.push(o))}}},_addCompChildrenToSelectionCache:function(e){this._alterSelectionCacheWithCompChildren(e,!0)},_removeCompChildrenToSelectionCache:function(e){this._alterSelectionCacheWithCompChildren(e,!1)},HasActors:function(){for(var e=this.GetComponentsFromCurrentSelection(),t=0;t<e.length;t++){var i=e[t];if(i.IsDressup||i.IsKindOf("VCXWebComponentOccurrence"))return!0}return!1},GetComponentsFromCurrentSelection:function(e){if("VCXScenario"===e)return this.GetScenariosComponentsFromCurrentSelection();var t=[];for(var i in this._setComponents)if(this._setComponents.hasOwnProperty(i)){var n=this._setComponents[i];for(var r in n)if(n.hasOwnProperty(r)){var o=n[r];if(!o)continue;var a=!0;e&&(o.IsKindOf(e)||(a=!1)),a&&t.push(o)}}return t},GetScenariosComponentsFromCurrentSelection:function(){var e=[];if(this._setComponents.scenarios)for(var t in this._setComponents.scenarios)if(this._setComponents.scenarios.hasOwnProperty(t)){var i=this._setComponents.scenarios[t];i&&e.push(i)}return e},GetSGComponentsFromCurrentSelection:function(){var e=[];if(this._setComponents.visu)for(var t in this._setComponents.visu)if(this._setComponents.visu.hasOwnProperty(t)){var i=this._setComponents.visu[t];i&&e.push(i)}return e},isIn:function(e){var t=e,i=(t.QueryInterface("VCXIModifiable"),!1);for(var n in this._setComponents)if(this._setComponents.hasOwnProperty(n)){var r=this._setComponents[n];if(i=i||r.hasOwnProperty(t.GetID()))break}return i},setTrapSelection:function(e,t){"boolean"==typeof e?(this._experienceBase.getManager("VCXContextManager").getMainViewer().setPicking({trapSelection:e,trapPrimitive:!1}),e&&"boolean"==typeof t&&this._experienceBase.getManager("VCXContextManager").getMainViewer().setPrePicking({trapSelection:t,trapPrimitive:!1})):console.warn("[VCXWebSelectionManager] Method setTrapSelection: a boolean is needed as first argument")},activatePrepicking:function(e){this._experienceBase.getManager("VCXContextManager").getMainViewer().setPrePicking({activated:e})},setDefaultHighlightValue:function(e){this._defaultHLValue=e},getDefaultHighlightValue:function(){return this._defaultHLValue},_logForODTRecord:function(e,t){for(var i=[],n=0;n<e.length;++n){var r=e[n];if(!r||"VCXComponentHotspot"!==r.GetType()){var o=r&&r.GetID();o&&i.push(o)}}if("record"===this._experienceBase.odt){var a=this._experienceBase.getManager("VCXODTManager");a._isActivatingSelSetHotspotGr||a.LogAPI(t?"VCXRemoveSelection":"VCXAddSelection",i)}else if("replay"===this._experienceBase.odt)i.length},buildXSOfilter:function(){if(this.excludeDressups||this.excludeParts){var e=[],t=[],i=this._experienceBase.getManager("VCXHotspotManager"),n=this._experienceBase.getManager("VCXContextManager").getRootComponent();if(n){var r=n.QueryInterface("VCXIModelNavigable");r&&r.traverse((n,r,o)=>{var a=!1,s=n.GetObject();!a&&this.keepLinkSelectable&&(a=s.hyperlinkID>=0),!a&&this.keepHotspotsSelectable&&(a=i&&i.GetEnabledHotspotFromComponentID(s.GetID())),s.IsKindOf("VCXComponentOccurrenceExt")?a&&e.push(s):s.IsKindOf("VCXDressup_Spec")&&a&&t.push(s)},null,null)}var o={};this.excludeDressups&&(o.Dressups=t),this.excludeParts&&(o.Parts=e),this.filterXSO(o)}else this.filterXSO()},filterXSO:function(e){var t=e&&e.Dressups;if(!this.dressupsOverrideSet&&t){var i=this._experienceBase.getManager("VCXDressupManager").QueryInterface("W3AISGNodeHolder").giveSGNode(),n=this._experienceBase.getManager("VCXContextManager").getMainViewer().getSceneGraphOverrideSetManager();this.dressupsOverrideSet=new a(i),n.pushSceneGraphOverrideSet(this.dressupsOverrideSet)}if(this.dressupsOverrideSet){if(this.dressupsOverrideSet.deleteOverrides(this.dressupsOverrideSet.getOverrides()),t){var r=[];if(p=this._experienceBase.getManager("VCXContextManager").getRootComponent())(h=p.QueryInterface("VCXIModelNavigable"))&&h.traverse(function(e,i,n){if(e.GetObject().IsKindOf("VCXDressup_Spec")&&t.indexOf(e.GetObject())<0){var o=e.GetObject().QueryInterface("W3AISGNodeHolder");o.getPathElement()&&r.push(o.getPathElement())}},null,null);if(r&&r.length>0)this.dressupsOverrideSet.createOverride({pathes:r,enabled:!0}).setPickability("NOT_PICKABLE")}t||(o.removeSceneGraphOverrideSet(this._experienceBase,this.dressupsOverrideSet,this._experienceBase.getManager("VCXContextManager").getMainViewer()),delete this.dressupsOverrideSet)}var s=e&&e.Parts;if(!this.partsOverrideSet&&s&&(this.partsOverrideSet=o.createAndPushSceneGraphOverrideSet(this._experienceBase,this._experienceBase.getManager("VCXContextManager").getMainViewer())),this.partsOverrideSet){if(this.partsOverrideSet.deleteOverrides(this.partsOverrideSet.getOverrides()),s){for(var c=[],l=0;l<s.length;l++){s[l].QueryInterface("VCXIModelNavigable").traverse(function(e,t,i){e.GetObject().IsKindOf("VCXComponentOccurrenceExt")&&e.GetObject().IsMesh()&&c.indexOf(e.GetObject())<0&&c.push(e.GetObject())},null,null)}var p,h,u=[];if(p=this._experienceBase.getManager("VCXContextManager").getRootComponent())(h=p.QueryInterface("VCXIModelNavigable"))&&h.traverse(function(e,t,i){if(e.GetObject().IsKindOf("VCXComponentOccurrenceExt")&&e.GetObject().IsMesh()&&c.indexOf(e.GetObject())<0){var n=e.GetObject().QueryInterface("W3AISGNodeHolder");n.getPathElement()&&u.push(n.getPathElement())}},null,null);if(u&&u.length>0)this.partsOverrideSet.createOverride({pathes:u,enabled:!0}).setPickability("NOT_PICKABLE")}s||(o.removeSceneGraphOverrideSet(this._experienceBase,this.partsOverrideSet,this._experienceBase.getManager("VCXContextManager").getMainViewer()),delete this.partsOverrideSet)}}});return Object.defineProperty(s.prototype,"componentType",{enumerable:!0,get:function(){return"VCXWebSelectionManager"}}),Object.defineProperty(s.prototype,"excludeDressups",{enumerable:!0,get:function(){return this._excludeDressups},set:function(e){this._excludeDressups=e,this.buildXSOfilter()}}),Object.defineProperty(s.prototype,"excludeParts",{enumerable:!0,get:function(){return this._excludeParts},set:function(e){this._excludeParts=e,this.buildXSOfilter()}}),Object.defineProperty(s.prototype,"keepLinkSelectable",{enumerable:!0,get:function(){return this._keepLinkSelectable},set:function(e){this._keepLinkSelectable=e,this.buildXSOfilter()}}),Object.defineProperty(s.prototype,"keepHotspotsSelectable",{enumerable:!0,get:function(){return this._keepHotspotsSelectable},set:function(e){this._keepHotspotsSelectable=e,this.buildXSOfilter()}}),Object.defineProperty(s.prototype,"keepAssemblySelectionModeActive",{enumerable:!0,get:function(){return this._keepAssemblySelectionModeActive},set:function(e){this._keepAssemblySelectionModeActive=e}}),s}),define("DS/VCXWebKernel/VCXIContextualContent",["DS/WebComponentModeler/CATWebInterface"],function(e){"use strict";return e.singleton({interfaceName:"VCXIContextualContent",required:{appendContent:function(e,t,i){}}})}),define("DS/VCXWebKernel/VCXModifiableActorList",["DS/VCXWebExperienceBase/VCXModifiableOccurrenceExperience","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXPropertyGroupSet","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyValueBoolean","DS/VCXWebProperties/VCXPropertyValueLink","DS/VCXWebProperties/VCXPropertyValueList","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables"],function(e,t,i,n,r,o,a,s,c){"use strict";return e.extend({init:function(){this._parent()},OnChangeProperty:function(e,t,i){if(i||(i={}),i.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;var n=t.GetValue();if("Actor.Enable"===e)this.GetObject().enable!==n&&(this.GetObject().enable=n);else if("Actor.ListActors"===e)for(var r=t.GetValue(),o=0;o<r.length;o++){var a=r[o].GetValue();this.GetObject().AddActor(a)}else{if("Actor.GroupID"!==e){i.fromChildClass=!0;var s=this._parent(e,t,i);return s||console.log("property not found : '"+e+"'"),s}this.GetObject()._groupID=t.GetValue()}return!0},GetProperty:function(e){var t=null;if("Actor.Enable"===e){var i=new o;i.SetValue(this.GetObject().enable),t=new n(new r(e,2,!0,c),i)}else if("Actor.ListActors"===e){var l=new s,p=this.GetObject().GetArrayActors();if(p)for(var h=0;h<p.length;h++){var u=p[h],d=new a;d.SetValue(u),l.PushPropertyValue(d)}(f=new r(e,2,!0,c)).SetVisible(!1),t=new n(f,l)}else if("Actor.GroupID"===e){var f,C=new a,m=this.GetObject()._groupID;m&&C.SetValue(m),(f=new r(e,0,!0,c)).SetVisible(!1),t=new n(f,C)}else t=this._parent(e);return t},GetProperties:function(){var e=new t;return e.AddOrModifyProperty(this.GetProperty("Actor.Name")),e.AddOrModifyProperty(this.GetProperty("Actor.Color")),e.AddOrModifyProperty(this.GetProperty("Actor.Enable")),e.AddOrModifyProperty(this.GetProperty("Actor.ToolTip")),e.AddOrModifyProperty(this.GetProperty("Actor.Hyperlink")),e.AddOrModifyProperty(this.GetProperty("Actor.ListActors")),e}})}),define("DS/VCXWebKernel/VCXComponentMarker",["UWA/Class"],function(e){"use strict";var t=e.extend({init:function(){this._parentScenarioID="",this._timePos=null,this._isMileStone=!1,this._name=null},GetType:function(){return this.componentType},SetName:function(e){this.name!==e&&(this.name=e)},GetName:function(){return this.name},GetTimePos:function(){return this.timePos},IsMilestone:function(){return this.isMileStone},SetParentScenario:function(e){this._parentScenarioID=e},GetParentScenario:function(){return this._parentScenarioID}});return Object.defineProperty(t.prototype,"name",{enumerable:!0,get:function(){return this._name},set:function(e){this._name!==e&&(this._name=e)}}),Object.defineProperty(t.prototype,"timePos",{enumerable:!0,get:function(){return this._timePos},set:function(e){this._timePos=e}}),Object.defineProperty(t.prototype,"isMileStone",{enumerable:!0,get:function(){return this._isMileStone},set:function(e){this._isMileStone=e}}),Object.defineProperty(t.prototype,"componentType",{enumerable:!0,get:function(){return"VCXComponentMarker"}}),t}),define("DS/VCXWebKernel/VCXModifiableViewActorList",["DS/VCXWebExperienceBase/VCXModifiableViewOccurrenceExperience"],function(e){"use strict";return e.extend({init:function(){this._parent()},getPropertyGroups:function(e){e||(e={}),this._parent(e);this.getGroupPropertiesOrders();return e["Group.Essentials"].removeProperty("Actor.Opacity"),e}})}),define("DS/VCXWebKernel/VCXActorDocManager",["UWA/Class","DS/VCXWebKernelTools/VCXFileServices"],function(e,t){"use strict";var i=e.extend({init:function(){this._mapDataB64=[]},Build:function(){this._experienceBase.getManager("VCXDocManager").actorDocManager=this},GetType:function(){return this.componentType},RemoveDocument:function(e){delete this._mapDataB64[e]},AddDocToBase64Map:function(e,i,n){if(void 0===n){var r=this,o=i.GetValueURL().GetValue(),a=i.GetFileName().GetValue();t.BlobURLToBase64(o,a,function(e,t){e&&(r._mapDataB64[t]=e)},e)}else this._mapDataB64[e]=n}});return Object.defineProperty(i.prototype,"componentType",{enumerable:!0,get:function(){return"VCXActorDocManager"}}),i}),define("DS/VCXWebKernel/ExpTrackManager_Spec",["UWA/Class"],function(e){"use strict";var t=e.extend({init:function(){},GetType:function(){return this.componentType}});return Object.defineProperty(t.prototype,"componentType",{enumerable:!0,get:function(){return"ExpTrackManager_Spec"}}),t}),define("DS/VCXWebKernel/VCXModifiableActorDocManager",["UWA/Core","DS/VCXWebModifiables/VCXModifiable","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXPropertyValueMap","DS/VCXWebProperties/VCXPropertyValueBin","DS/VCXWebProperties/VCXPropertyValueInt","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValuePath","DS/VCXWebProperties/VCXPropertyValueBoolean","DS/VCXWebProperties/VCXPropertyValueDocId","DS/VCXWebKernelTools/VCXFileServices","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables"],function(e,t,i,n,r,o,a,s,c,l,p,h,u,d){"use strict";return t.extend({init:function(){this._parent()},OnChangeProperty:function(e,t,i){if(i||(i={}),i.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;switch(e){case"DocManager.defaultIndex":var n=this.GetObject()._experienceBase.getManager("VCXDocManager");console.log("DocManager.defaultIndex = "+t.GetValue()),n.SetDefaultImageIndex(t.GetValue());break;case"DocManager.documents":console.log("Initialization of DocManager from VCXModifiableActorDocManager"),console.log("onchange property with DocManager.documents");n=this.GetObject()._experienceBase.getManager("VCXDocManager");if(t instanceof o)for(var r=0;r<t._value.length;r++){var a=t._value[r];if(a){var s=new l;a.GetValueAtIndex(0)&&s.SetPathType(a.GetValueAtIndex(0)),a.GetValueAtIndex(2)&&s.SetFileName(a.GetValueAtIndex(2)),a.GetValueAtIndex(3)&&s.SetValueLink(a.GetValueAtIndex(3));var h=new p;h.SetValue(!0),s.SetValueBool(h),a.GetValueAtIndex(4)&&s.SetDocIdParent(a.GetValueAtIndex(4));var d=a.GetValueAtIndex(1);s.SetValueURL(d);var f=a.GetValueAtIndex(5);if(f){var C="data:"+d.GetValue()+";base64,"+f.GetValue(),m=u.dataURLToBlob(C),_=window.URL.createObjectURL(m),g=new c;g.SetValue(_),console.log("-------- DOC blobURL ="+_+"\n"),s.SetValueURL(g),!this.GetObject()._experienceBase.getManager("VCXContextManager").IsLocalMode()&&this.GetObject()._experienceBase.getManager("VCXContextManager").getUseResourcesManager()||(n.actorDocManager._mapDataB64[r]=C)}n._map[r]=s}}break;default:return i.fromChildClass=!0,this._parent(e,t,i)}return!0},OnChangePropertiesEnd:function(){},GetProperty:function(e){var t=null;if("DocManager.defaultIndex"===e){var r=new s,l=this.GetObject()._experienceBase.getManager("VCXDocManager");r.SetValue(l.GetDefaultImageIndex()),t=new i(new n(e,n.EBehaviorType.Singleton),r)}else if("DocManager.documents"===e){l=this.GetObject()._experienceBase.getManager("VCXDocManager");for(var p=new o,h=l.NumberOfDoc(),u=0;u<h;u++){var f=l.GetPropPath(u);if(f)if(f.GetValueBool().GetValue()){var C=new o;if(C.SetValueAtIndex(0,f.GetPathType()),C.SetValueAtIndex(2,f.GetFileName()),C.SetValueAtIndex(3,f.GetValueLink()),C.SetValueAtIndex(4,f.GetDocIdParent()),f.GetValueURL().GetValue().indexOf("blob:")>=0){var m=l.actorDocManager._mapDataB64[u];if(m){var _=m.split(";base64,"),g=_[0].split(":")[1],S=new a;S.SetValue(_[1]),C.SetValueAtIndex(5,S);var v=new c;v.SetValue(g),C.SetValueAtIndex(1,v)}else console.log("docmanager : BAD base64 cache !!")}else C.SetValueAtIndex(1,f.GetValueURL());p.SetValueAtIndex(u,C)}}var b=new n(e,n.EBehaviorType.Singleton,!0,d);b.SetVisible(!1),t=new i(b,p)}else t=this._parent(e);return t},GetProperties:function(){var e=this._parent();return!this.GetObject()._experienceBase.getManager("VCXContextManager").IsLocalMode()&&this.GetObject()._experienceBase.getManager("VCXContextManager").getUseResourcesManager()||e.AddOrModifyProperty(this.GetProperty("DocManager.documents")),e.AddOrModifyProperty(this.GetProperty("DocManager.defaultIndex")),e}})}),define("DS/VCXWebKernel/VCXModifiableSelectionManager",["UWA/Core","DS/VCXWebModifiables/VCXModifiable","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyValueMap","DS/VCXWebProperties/VCXPropertyValueLink"],function(e,t,i,n,r,o,a){"use strict";return t.extend({init:function(){this._parent()},GetListSelection:function(){return this.GetObject().GetComponentsFromSelection("CSO")},GetProperty:function(e){var t=null;if("SelectionManager.ListCSO"===e){for(var i=this.GetListSelection(),s=[],c=0;c<i.length;c++){var l=i[c].GetID();s.push(l)}var p=new o,h=0;s.sort();for(c=0;c<s.length;c++){l=s[c];var u=new a;u.SetValue(l),p.SetValueAtIndex(h,u),h++}t=new n(new r(e,2),p)}return t},GetProperties:function(){var e=new i;return e.AddOrModifyProperty(this.GetProperty("SelectionManager.ListCSO")),e}})}),define("DS/VCXWebKernel/VCXModifiableHotspot",["DS/VCXWebKernel/VCXModifiableActorList","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueHyperlinkId","DS/VCXWebProperties/VCXPropertyValueBoolean","DS/VCXWebProperties/VCXPropertyValueColor","DS/VCXWebProperties/VCXPropertyValueList","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables"],function(e,t,i,n,r,o,a,s,c,l){"use strict";return e.extend({init:function(){this._parent()},OnChangeProperty:function(e,t,i){if(i||(i={}),i.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;if("highlight.color"!==e){i.fromChildClass=!0;var n=this._parent(e,t,i);return n||console.log("property not found : '"+e+"'"),n}return this.GetObject().highlight=t.GetValue()[0],!0},OnChangePropertiesEnd:function(){if(this._previousEnableValue!==this.GetProperty("Actor.Enable").GetPropertyValue().Value){this._previousEnableValue=this.GetProperty("Actor.Enable").GetPropertyValue().Value;var e=this.GetObject()._experienceBase.getManager("VCXSelectionManager");e&&e.buildXSOfilter&&e.buildXSOfilter()}this._parent()},GetProperty:function(e){var t=null;if("highlight.color"===e){if(this.GetObject().highlight){var r=new s,o=this.GetObject().highlight.getColorHighlight();o&&r.GetValue().SetThreeColor(o.color);var a=new n(e,2,!0,l);t=new i(a,r)}}else"highlight.color.actors"===e||(t=this._parent(e));return t},GetProperties:function(){var e=this._parent();return this.GetObject()._experienceBase.odt&&(e.AddOrModifyProperty(this.GetProperty("highlight.color")),e.AddOrModifyProperty(this.GetProperty("highlight.color.actors"))),e}})}),define("DS/VCXWebKernel/VCXComponentGroupHotspot",["DS/VCXWebKernel/VCXComponentActorList"],function(e){"use strict";var t=e.extend({init:function(){this._parent(),this._bEnable=!1},Build:function(){this.QueryInterface("VCXISelectBehavior").SetSelectMode(1)}});return Object.defineProperty(t.prototype,"componentType",{enumerable:!0,get:function(){return"VCXComponentGroupHotspot"}}),t}),define("DS/VCXWebKernel/VCXComponentGroupSelectionSet",["DS/VCXWebKernel/VCXComponentActorList"],function(e){"use strict";var t=e.extend({init:function(){this._parent()},Build:function(){this.QueryInterface("VCXISelectBehavior").SetSelectMode(1)},AddActor:function(e){this._parent(e)}});return Object.defineProperty(t.prototype,"componentType",{enumerable:!0,get:function(){return"VCXComponentGroupSelectionSet"}}),t}),define("DS/VCXWebKernel/VCXSelectionManager",["DS/Core/Core","DS/VCXWebKernel/VCXWebSelectionManager"],function(e,t){"use strict";var i=t.extend({RefreshXSO:function(){for(var t=[],i=this.GetSGComponentsFromCurrentSelection(),n=0;n<i.length;++n){var r=i[n].QueryInterface("W3AISGNodeHolder");if(r&&r.getPathElement){var o=r.getPathElement();o&&t.push({pathElement:o})}else console.log("Found a component without sgNode/pathElement in selection from visu.")}var a=this._experienceBase.getManager("VCXSelectManager");a.blockEventCallback("all","SELECTION"),a.blockEventCallback("all","HIGHLIGHT"),e.Selection.CSOManager.empty(!0),e.Selection.HSOManager.empty(!0),e.Selection.CSOManager.add(t),e.Selection.HSOManager.add(t),a.unblockEventCallback("all","SELECTION"),a.unblockEventCallback("all","HIGHLIGHT")}});return Object.defineProperty(i.prototype,"componentType",{enumerable:!0,get:function(){return"VCXSelectionManager"}}),i}),define("DS/VCXWebKernel/VCXSelectManager",["DS/Core/Core","DS/CoreEvents/Events","DS/VCXWebKernel/VCXCmdChangeSelection","DS/VCXWebModifiablesServices/VCXModifiablesAccess","UWA/Class"],function(e,t,i,n,r){"use strict";var o={add:"onAdd",postAdd:"onPostAdd",remove:"onRemove",postRemove:"onPostRemove",preEmpty:"onPreEmpty",empty:"onEmpty"};Object.freeze(o);var a=r.extend({postInitialize:function(){this._subscribeEvents(),this._bPreviewMode=this._experienceBase.getManager("VCXExperience").GetPreviewMode(),this._excludedFromXSOHyperlinksPathes=[],this._componentsToAdd=[],this._componentsToRemove=[],this.blockedCBFlags={SELECTION:1,HIGHLIGHT:2,PREHIGHLIGHT:4},this.blockedCBEvents={add:0,postAdd:0,preRemove:0,remove:0,postRemove:0,preEmpty:0,empty:0},this._selectionManager=this._experienceBase.getManager("VCXSelectionManager")},getInitPhase:function(){return 9},unableSelectionInPlayMode:function(){this._experienceBase.getManager("VCXContextManager").getMainViewer().setPicking({activated:!1}),this._experienceBase.getManager("VCXContextManager").getMainViewer().setPrePicking({activated:!1})},blockEventCallback:function(e,t){if("all"===e)for(var i=Object.keys(this.blockedCBEvents),n=0;n<i.length;++n){var r=i[n];this.blockedCBEvents[r]=this.blockedCBEvents[r]|this.blockedCBFlags[t]}else this.blockedCBEvents.hasOwnProperty(e)&&(this.blockedCBEvents[e]=this.blockedCBEvents[e]|this.blockedCBFlags[t])},unblockEventCallback:function(e,t){if("all"===e)for(var i=Object.keys(this.blockedCBEvents),n=0;n<i.length;++n){var r=i[n];this.blockedCBEvents[r]=this.blockedCBEvents[r]&~this.blockedCBFlags[t]}else this.blockedCBEvents.hasOwnProperty(e)&&(this.blockedCBEvents[e]=this.blockedCBEvents[e]&~this.blockedCBFlags[t])},isEventCallbackBlocked:function(e,t){return Boolean(this.blockedCBEvents[e]&this.blockedCBFlags[t])},_subscribeEvents:function(){var i=e.Selection.CSOManager,n=e.Selection.HSOManager,r=e.Selection.PSOManager,a=this,s=function(e,t){var i=o[e];return function(n){a.isEventCallbackBlocked(e,t)||a[i](n,t)}};this._xsoEventSubscrArray={CSO:[],HSO:[],PSO:[]};for(var c=Object.keys(o),l=0;l<c.length;++l){var p=c[l],h=o[p];this._xsoEventSubscrArray.CSO.push(i[h](s(p,"SELECTION"))),this._xsoEventSubscrArray.HSO.push(n[h](s(p,"HIGHLIGHT"))),this._xsoEventSubscrArray.PSO.push(r[h](s(p,"PREHIGHLIGHT")))}this._tokens={};this._tokens.previewModeEvent=t.subscribe({event:"VCX_PREVIEW_MODE_CHANGED"},function(e){this._bPreviewMode=e,!0===e&&0!==this._excludedFromXSOHyperlinksPathes.length&&this.switchOnSensibilityForAllHyperlinks()}.bind(this))},_unsubscribeEvents:function(){var i={CSO:e.Selection.CSOManager,HSO:e.Selection.HSOManager,PSO:e.Selection.PSOManager},n=[];for(this._xsoEventSubscrArray&&(n=Object.keys(this._xsoEventSubscrArray));0!==n.length;){for(var r=0;r<n.length;++r){var o=n[r],a=this._xsoEventSubscrArray[o].pop();i[o].unsubscribe(a),0===this._xsoEventSubscrArray[o].length&&delete this._xsoEventSubscrArray[o]}n=Object.keys(this._xsoEventSubscrArray)}for(var s in this._tokens)this._tokens.hasOwnProperty(s)&&t.unsubscribe(this._tokens[s]);this._tokens={}},unInitialize:function(){this._unsubscribeEvents(),this._selectionManager=null},switchSensibilityForPreviewHyperlinks:function(e,t){if(e&&"boolean"==typeof t){var i=n.BuildCleanedPathElement(e);if(i){var r=this._experienceBase.ComponentsMap.GetComponentFromPathElement(i);if(r&&r.QueryInterface){var o=null;if(t)(o=r.QueryInterface("VCXISensible"))&&(o.setSelectable(t),o.setHighlightable(t));else this._experienceBase.getManager("VCXHyperlinkManager").ObjectHasHyperlink(r)&&(o=r.QueryInterface("VCXISensible"))&&(o.setSelectable(t),o.setHighlightable(t))}}}},switchOnSensibilityForAllHyperlinks:function(){for(;0!==this._excludedFromXSOHyperlinksPathes.length;){var e=this._excludedFromXSOHyperlinksPathes.pop();this.switchSensibilityForPreviewHyperlinks(e,!0)}},_storeToAddCompFromPathElement:function(e){var t=n.BuildCleanedPathElement(e),i=this._experienceBase.ComponentsMap.GetComponentFromPathElement(t);if(i&&i.QueryInterface){var r=!1,o=this._experienceBase.getManager("VCXHotspotManager").GetEnabledHotspotFromComponentID(i.GetID(),!0);if(o&&(r=!0,this._experienceBase.getManager("VCXHotspotManager").DeactivateAllHotspots(),this._experienceBase.getManager("VCXHotspotManager").DeactivateAllHotspots(!0),this._experienceBase.getManager("VCXAPIManager").SelectHotspot(o.GetID())),!r){var a=i.QueryInterface("VCXISensible");a&&a.getSelectable()&&(this._selectionManager.isIn(i)||this._componentsToAdd.push(i))}}},_storeToRemoveCompFromPathElement:function(e){var t=n.BuildCleanedPathElement(e),i=this._experienceBase.ComponentsMap.GetComponentFromPathElement(t);i&&this._selectionManager.isIn(i)&&this._componentsToRemove.push(i)},onAdd:function(e,t){var i=null;this._bPreviewMode&&"PREHIGHLIGHT"===t?(i=e).pathElement&&(this.switchSensibilityForPreviewHyperlinks(i.pathElement,!1),this._excludedFromXSOHyperlinksPathes.push(i.pathElement)):"SELECTION"===t&&(i=e).pathElement&&this._storeToAddCompFromPathElement(i.pathElement)},onPostAdd:function(e,n){if("SELECTION"!==n)0!==e.length&&t.publish({event:"VCX_"+n+"_ADD",data:e});else if("SELECTION"===n&&0!==this._componentsToAdd.length){var r=new i(this._selectionManager,!0);r.AddComponentsToSelection(this._componentsToAdd),this._experienceBase.getManager("VCXCommandManager").Do(r)}this._componentsToAdd=[]},onRemove:function(e,t){var i=null;if(this._bPreviewMode&&"PREHIGHLIGHT"===t){var n=null;(i=e).pathElement&&(this.switchSensibilityForPreviewHyperlinks(i.pathElement,!0),n=this._excludedFromXSOHyperlinksPathes.indexOf(i.pathElement),this._excludedFromXSOHyperlinksPathes.splice(n,1))}else"SELECTION"===t&&(i=e).pathElement&&this._storeToRemoveCompFromPathElement(i.pathElement)},onPostRemove:function(e,n){if("SELECTION"!==n)0!==e.length&&t.publish({event:"VCX_"+n+"_REMOVE",data:e});else if("SELECTION"===n&&this._componentsToRemove&&0!==this._componentsToRemove.length){var r=new i(this._selectionManager,!0);r.RemoveComponentsFromSelection(this._componentsToRemove),this._experienceBase.getManager("VCXCommandManager").Do(r)}this._componentsToRemove=[]},onPreEmpty:function(e,i){this.blockEventCallback("remove",i),t.publish({event:"VCX_"+i+"_PREEMPTY",data:e})},onEmpty:function(e,n){if(this._bPreviewMode&&"PREHIGHLIGHT"===n)this.switchOnSensibilityForAllHyperlinks();else if("SELECTION"===n){var r=this._selectionManager.GetSGComponentsFromCurrentSelection();if(0!==r.length){var o=new i(this._selectionManager,!0);o.RemoveComponentsFromSelection(r),this._experienceBase.getManager("VCXCommandManager").Do(o)}}t.publish({event:"VCX_"+n+"_EMPTY",data:e}),this.unblockEventCallback("remove",n)}});return Object.defineProperty(a.prototype,"componentType",{enumerable:!0,get:function(){return"VCXSelectManager"}}),a}),define("DS/VCXWebKernel/VCXModifiableGroupActorList",["DS/VCXWebKernel/VCXModifiableActorList","DS/VCXWebProperties/VCXPropertySet"],function(e,t){"use strict";return e.extend({init:function(){this._parent()},GetProperties:function(){var e=new t;return e.AddOrModifyProperty(this.GetProperty("Actor.ListActors")),e}})}),define("DS/VCXWebKernel/VCXModifiableSelectionSet",["DS/VCXWebKernel/VCXModifiableActorList","DS/VCXWebProperties/VCXPropertySet"],function(e,t){"use strict";return e.extend({init:function(){this._parent()},GetProperties:function(){var e=new t;return e.AddOrModifyProperty(this.GetProperty("Actor.ListActors")),e}})}),define("DS/VCXWebKernel/VCXComponentSelectionSet",["DS/VCXWebKernel/VCXComponentActorList"],function(e){"use strict";var t=e.extend({init:function(){this._parent()},Build:function(){this.QueryInterface("VCXISelectBehavior").SetSelectMode(1)}});return Object.defineProperty(t.prototype,"componentType",{enumerable:!0,get:function(){return"VCXComponentSelectionSet"}}),t}),define("DS/VCXWebKernel/VCXComponentHotspot",["DS/VCXWebKernel/VCXComponentActorList"],function(e){"use strict";var t=e.extend({init:function(){this._parent(),this._highlight=null,this._alpha=null},AddActor:function(e){for(var t=!1,i=0;i<this._arrayActors.length;i++){if(this._arrayActors[i]===e){t=!0;break}}if(!t){this._arrayActors.push(e);var n=this._experienceBase.getManager("VCXHotspotManager");n&&n.addComponentToMapPrehighlight(e,this)}},RemoveActor:function(e){for(var t=0;t<this._arrayActors.length;t++){if(this._arrayActors[t]===e){this._arrayActors.splice(t,1);break}}}});return Object.defineProperty(t.prototype,"highlight",{enumerable:!0,get:function(){return this._highlight},set:function(e){this._highlight=e}}),Object.defineProperty(t.prototype,"componentType",{enumerable:!0,get:function(){return"VCXComponentHotspot"}}),t}),define("DS/VCXWebKernel/VCXAPIManager",["DS/CoreEvents/Events","UWA/Class","DS/VCXWebKernel/VCXCmdChangeSelection","DS/VCXWebKernelCommands/VCXCmdChangeTimePos","DS/VCXWebKernel/VCXCmdGoToMarker","DS/VCXWebKernelCommands/VCXCmdChangePropertiesAutokey","DS/VCXWebProperties/VCXPropertyMap","DS/VCXWebExperienceLoader/VCXExperienceSaverBase","DS/VCXWebExperienceLoader/VCXExperienceLoaderBase","DS/VCXWebKernelCommands/VCXCmdChangeVisibility","DS/VCXWebVisibility/VCXIVisibility"],function(e,t,i,n,r,o,a,s,c,l,p){"use strict";var h=t.extend({initialize:function(){this._experienceSaver=new s,this._experienceLoader=new c,this._experienceLoader.InitLoader(this._experienceBase),this._buildInfo=null,this._mapVerNumbers=new Map,this._mapVerNumbers.set("423","R2021x"),this._mapVerNumbers.set("424","R2022x"),this._mapVerNumbers.set("425","R2023x"),this._mapVerNumbers.set("426","R2024x")},unInitialize:function(){this._experienceSaver=null,this._experienceLoader=null},GoToScenario:function(e,t){e&&this._experienceBase.getManager("VCXGUIManager").GoToScenarioContext()&&this._experienceBase.getManager("VCXExperience").GoToScenarioWithInterpolation(e,t)},HasAnimation:function(e){var t=this._experienceBase.ComponentsMap.GetComponentFromID(e);if(t)return t.HasAnimation();console.log("APIManager:: HasAnimation. Scenario not found.")},PlayAnimation:function(t){var i=this,n=this._experienceBase.getManager("VCXScenarioManager"),r=n.GetCurrentScenario();if(t){if(t===r&&this._experienceBase.getManager("VCXScenarioManager").GetIsPlayingCurrentScenario())return}else t=r;var o=this._experienceBase.ComponentsMap.GetComponentFromID(t);o||console.log("VCXAPIManager : NO scenario for PlayAnimation");var a=function(){if(o.HasAnimation()){e.publish({event:"VCX_START_PLAY"});var t=i._experienceBase.getManager("VCXContextManager");t&&("0"==t.getUrlVars().boost||o.BuildAnimatedModifiablesSets(n._keyframer)),n.SetIsPlayingCurrentScenario(!0)}},s=function(){n.GetCurrentScenario()!==t?i.GoToScenario(t,a):a()};this._experienceBase.getManager("VCXExperience").GetPreviewMode()&&this._experienceBase.getManager("VCXPulseManager")?this._experienceBase.getManager("VCXPulseManager").StopPulse(s):s()},PauseAnimation:function(){var t=this._experienceBase.getManager("VCXScenarioManager");t.GetIsPlayingCurrentScenario()&&(t.SetIsPlayingCurrentScenario(!1),e.publish({event:"VCX_PAUSE_PLAY"}))},StopAnimation:function(){var t=this._experienceBase.getManager("VCXScenarioManager");if(t.GetIsPlayingCurrentScenario()){var i=t.GetCurrentScenario(),r=this._experienceBase.ComponentsMap.GetComponentFromID(i).GetCurrentFrame(),o=new n(this._experienceBase.getManager("VCXScenarioManager"));o.ChangeTimePos(0,r),this._experienceBase.getManager("VCXCommandManager").Push(o),t.SetIsPlayingCurrentScenario(!1),e.publish({event:"VCX_STOP_PLAY"})}},GetAnimationTime:function(){var e=this._experienceBase.getManager("VCXScenarioManager").GetCurrentTime();return console.log("API GetAnimationTime : "+e),e},GetAnimationDuration:function(e){var t=0;if(e){var i=this._experienceBase.getManager("VCXScenarioManager");if(i)t=i.GetMaxFrame(e)/i.GetFPS();console.log("API GetAnimationDuration : "+t)}return t},GoToMarker:function(e,t){if(this._experienceBase.ComponentsMap.GetComponentFromID(e)){var i=new r(this._experienceBase.getManager("VCXScenarioManager"),this._experienceBase.getManager("VCXCommandManager"),this._experienceBase.ComponentsMap);i.GoToMarker(e),i.SetCallback(t),this._experienceBase.getManager("VCXCommandManager").Push(i)}},ActivateSelectionSet:function(e){var t=this._experienceBase.ComponentsMap.GetComponentFromID(e);if(t){var n=new i(this._experienceBase.getManager("VCXSelectionManager"));n.AddToSelection(t),this._experienceBase.getManager("VCXCommandManager").Do(n)}else console.log("Component selection set not found.")},DeactivateSelectionSet:function(e){var t=this._experienceBase.ComponentsMap.GetComponentFromID(e);if(t){var n=new i(this._experienceBase.getManager("VCXSelectionManager"));n.RemoveFromSelection(t),this._experienceBase.getManager("VCXCommandManager").Do(n)}else console.log("Component selection set not found.")},ActivateHotspotOnClick:function(e){this.ActivateHyperlink(e)},ActivateHyperlink:function(e,t){var i=this._experienceBase.ComponentsMap.GetComponentFromID(e);if(i){var n=i.QueryInterface("VCXIModifiable");this._experienceBase.getManager("VCXHyperlinkManager").OpenHyperlink(n,t)}else console.log("Component not found.")},SelectHotspot:function(e){var t=this._experienceBase.ComponentsMap.GetComponentFromID(e);t?(this._experienceBase.getManager("VCXHotspotManager").ActivateHotspotFromTree(t),this._experienceBase.getManager("VCXContextManager").renderAll()):console.log("Component hotspot not found.")},DeselectHotspot:function(e){var t=this._experienceBase.ComponentsMap.GetComponentFromID(e);t?(this._experienceBase.getManager("VCXHotspotManager").DeactivateHotspotFromTree(t),this._experienceBase.getManager("VCXContextManager").renderAll()):console.log("Component hotspot not found.")},RegisterAddSelectionCB:function(e){this._experienceBase.getManager("VCXSelectionManager").RegisterAddSelectionCB(e)},RegisterRemoveSelectionCB:function(e){this._experienceBase.getManager("VCXSelectionManager").RegisterRemoveSelectionCB(e)},RegisterMarkerSequenceCB:function(e){this._experienceBase.getManager("VCXMarkerManager").RegisterMarkerSequenceCB(e)},GetAllHotspots:function(){for(var e={},t=this._experienceBase.ComponentsMap.GetComponentFromType("VCXComponentHotspot"),i=0;i<t.length;i++){var n=t[i];if(n){var r=n.GetArrayActors();e[n.GetID()]=r}}return e},GetSelectedObjects:function(){for(var e=[],t=this._experienceBase.getManager("VCXSelectionManager").GetComponentsFromCurrentSelection(),i=0;i<t.length;i++){var n=t[i];n&&e.push(n.GetID())}return e},ChangeProperties:function(e){var t=this._experienceLoader.LoadPropMap(e),i=new o(this._experienceBase.getManager("VCXScenarioManager"),this._experienceBase.getManager("VCXCommandManager"));i.ChangePropertiesFromMap(t),this._experienceBase.getManager("VCXCommandManager").Do(i)},GetProperties:function(e,t){var i=this._experienceBase.ComponentsMap.GetComponentFromID(e);if(i){var n=new a,r=i.QueryInterface("VCXIModifiable");if(t){var o=r.GetProperty(t);o&&n.AddOrModifyProperty(r.GetHashing(),o)}else{var s=r.GetProperties();n.AddOrModifyPropertySet(r.GetHashing(),s)}return this._experienceSaver._PropMapToJson(this._experienceBase,n)}console.log("Object not found")},ActivateTooltipDisplayOnPartHover:function(e){if(this._experienceBase){var t=this._experienceBase.getManager("VCXGUIManager");t&&t.setTooltipDisplay(!0)}},DeactivateTooltipDisplayOnPartHover:function(e){if(this._experienceBase){var t=this._experienceBase.getManager("VCXGUIManager");t&&t.setTooltipDisplay(!1)}},SetPreventPartsFromBeingSelectable:function(e){this._experienceBase&&(this._experienceBase.getManager("VCXSelectionManager").excludeParts=e)},GetPreventPartsFromBeingSelectable:function(){return this._experienceBase&&this._experienceBase.getManager("VCXSelectionManager").excludeParts},SetPreventCollaborativeActorsFromBeingSelectable:function(e){this._experienceBase&&(this._experienceBase.getManager("VCXSelectionManager").excludeDressups=e)},GetPreventCollaborativeActorsFromBeingSelectable:function(){return this._experienceBase&&this._experienceBase.getManager("VCXSelectionManager").excludeDressups},SetKeepLinkSelectable:function(e){this._experienceBase&&(this._experienceBase.getManager("VCXSelectionManager").keepLinkSelectable=e)},GetKeepLinkSelectable:function(){return this._experienceBase&&this._experienceBase.getManager("VCXSelectionManager").keepLinkSelectable},SetKeepHotspotsSelectable:function(e){this._experienceBase&&(this._experienceBase.getManager("VCXSelectionManager").keepHotspotsSelectable=e)},GetKeepHotspotsSelectable:function(){return this._experienceBase&&this._experienceBase.getManager("VCXSelectionManager").keepHotspotsSelectable},SetKeepAssemblySelectionModeActive:function(e){this._experienceBase&&(this._experienceBase.getManager("VCXSelectionManager").keepAssemblySelectionModeActive=e)},GetKeepAssemblySelectionModeActive:function(){return this._experienceBase&&this._experienceBase.getManager("VCXSelectionManager").keepAssemblySelectionModeActive},GetAllActors:function(e){var t,i,n=[],r=!1;""===e&&(r=!0);var o,a=e.toLowerCase();if(r||"mesh"===a)for(var s=this._experienceBase.ComponentsMap.GetComponentFromType("VCXComponentOccurrenceExt"),c=0;c<s.length;++c){var l=s[c];l&&(l.IsMesh()&&n.push(l.GetID()))}if((r||"collab"===a)&&(i=this._experienceBase.ComponentsMap.GetComponentFromType("VCXDressup_Spec")),(r||"pmi"===a)&&(t=this._experienceBase.ComponentsMap.GetComponentFromType("VCXComponentCompositePmi")),i&&t?o=i.concat(t):i?o=i:t&&(o=t),o)for(c=0;c<o.length;++c){var p=o[c];p&&n.push(p.GetID())}return n},SelectActors:function(e){for(var t=[],n=0;n<e.length;++n){var r=this._experienceBase.ComponentsMap.GetComponentFromID(e[n]);r&&t.push(r)}var o=new i(this._experienceBase.getManager("VCXSelectionManager"));t&&t.length<=0?o.SetSelection(null):o.AddComponentsToSelection(t),this._experienceBase.getManager("VCXCommandManager").Do(o)},ZoomFitAll:function(e){var t=this._experienceBase.getManager("VCXUserInputControllerManager");t&&t.ZoomFitSelection(e)},SetVisibility:function(e,t){for(var i=[],n=0;n<e.length;++n){var r=this._experienceBase.ComponentsMap.GetComponentFromID(e[n]);if(r)r.QueryInterface("VCXIVisibility")&&i.push(r)}if(0!==i.length){var o=new l(this._experienceBase.getManager("VCXScenarioManager"),this._experienceBase.ComponentsMap,this._experienceBase.getManager("VCXCommandManager")),a=p.EVisState.Hidden;t&&(a=p.EVisState.Visible),o.ChangeVisibility(i,a),this._experienceBase.getManager("VCXCommandManager").Push(o)}},GetVisibility:function(e){var t=-1,i=this._experienceBase.ComponentsMap.GetComponentFromID(e);if(!i)return t;var n=i.QueryInterface("VCXIVisibility");if(n){var r=n.GetVisibility();r===p.EVisState.Hidden?t=0:r===p.EVisState.Visible&&(t=1)}return t},GetViewport:function(){var e=this._experienceBase.ComponentsMap.GetComponentFromType("VCXViewport_Spec");if(e&&e.length>0)return e[0].GetID()}});return Object.defineProperty(h.prototype,"componentType",{enumerable:!0,get:function(){return"VCXAPIManager"}}),Object.defineProperty(h.prototype,"preventCollaborativeActorsFromBeingSelectable",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").excludeDressups},set:function(e){this._experienceBase.getManager("VCXSelectionManager").excludeDressups=e}}),Object.defineProperty(h.prototype,"preventPartsFromBeingSelectable",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").excludeParts},set:function(e){this._experienceBase.getManager("VCXSelectionManager").excludeParts=e}}),Object.defineProperty(h.prototype,"keepLinkSelectable",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").keepLinkSelectable},set:function(e){this._experienceBase.getManager("VCXSelectionManager").keepLinkSelectable=e}}),Object.defineProperty(h.prototype,"keepHotspotSelectable",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").keepHotspotsSelectable},set:function(e){this._experienceBase.getManager("VCXSelectionManager").keepHotspotsSelectable=e}}),Object.defineProperty(h.prototype,"keepAssemblySelectionModeActive",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").keepAssemblySelectionModeActive},set:function(e){this._experienceBase.getManager("VCXSelectionManager").keepAssemblySelectionModeActive=e}}),h}),define("DS/VCXWebKernel/VCXComposerAPIManager",["UWA/Core","DS/CoreEvents/Events","DS/VCXWebKernelCommands/VCXCmdChangeTimePos","DS/VCXWebKernel/VCXAPIManager","DS/VCXWebProperties/VCXPropertyValueEnum"],function(e,t,i,n,r){"use strict";var o=n.extend({initialize:function(){this._parent(),this._APIMngr=this._experienceBase.getManager("VCXAPIManager"),this._versionInfo=null,this._ApiCBEndSce=null,this._WUXEventTokens={};var e=this;this._WUXEventTokens.VCX_END_TRANSITION=t.subscribe({event:"VCX_END_TRANSITION"},function(t){e._ApiCBEndSce&&t._name&&t._ID&&e._ApiCBEndSce(t._name,t._ID)})},unInitialize:function(){this._parent(),this._APIMngr=null,this._ApiCBEndSce=null},GoToScenario:function(e,t){this._APIMngr.GoToScenario(e,t)},PlayAnimation:function(e){if(null==e&&(e="AnimationSmgID",this.GetAnimationTime()>=this.GetAnimationDuration(e))){var t=new i(this._experienceBase.getManager("VCXScenarioManager"));t.ChangeTimePos(0,!1),this._experienceBase.getManager("VCXCommandManager").Push(t)}this._APIMngr.PlayAnimation(e)},HasAnimation:function(e){return null==e&&(e="AnimationSmgID"),this._APIMngr.HasAnimation(e)},PauseAnimation:function(){return this._APIMngr.PauseAnimation()},StopAnimation:function(){return this._APIMngr.StopAnimation()},GetAnimationTime:function(){return this._APIMngr.GetAnimationTime()},GetAnimationDuration:function(e){return null==e&&(e="AnimationSmgID"),this._APIMngr.GetAnimationDuration(e)},GoToView:function(e,t){this._APIMngr.GoToScenario(e,t)},GoToMarker:function(e,t){this._APIMngr.GoToMarker(e,t)},ActivateSelectionSet:function(e){this._APIMngr.ActivateSelectionSet(e)},DeactivateSelectionSet:function(e){this._APIMngr.DeactivateSelectionSet(e)},SelectHotspot:function(e){this._experienceBase.ComponentsMap.GetComponentFromID(e)&&(this._experienceBase.getManager("VCXHotspotManager").DeactivateAllHotspots(),this._experienceBase.getManager("VCXHotspotManager").DeactivateAllHotspots(!0),this._APIMngr.SelectHotspot(e))},DeselectHotspot:function(e){this._APIMngr.DeselectHotspot(e)},RegisterAddSelectionCB:function(e){this._APIMngr.RegisterAddSelectionCB(e)},RegisterRemoveSelectionCB:function(e){this._APIMngr.RegisterRemoveSelectionCB(e)},RegisterMarkerSequenceCB:function(e){this._APIMngr.RegisterMarkerSequenceCB(e)},RegisterEndScenarioCB:function(e){this._ApiCBEndSce=e},RegisterDoubleClickCB:function(e){this._experienceBase.getManager("VCXUserInputControllerManager").RegisterDoubleClickCB(e)},GetAllHotspots:function(){return this._APIMngr.GetAllHotspots()},ChangeAntialiasing:function(e){const t={NoAA:0,SMAA:1,MLAA:2,FXAA:3,FSAA:4,SSAA:6,TAA:8};let i=this._experienceBase.getManager("VCXContextManager"),n=this._experienceBase.getManager("VCXContextManager").getActiveViewport();if(n&&i){let o=n.QueryInterface("VCXIModifiable");o&&o.OnChangeProperty("Environment.AA",new r(t[e])),i.applyToViewers(function(t){t.setAntiAliasing(e)}),i.renderAll()}else console.error("Change Antialiasing API Failed")},GetAntialiasingMode:function(){let e=null,t=this._experienceBase.getManager("VCXContextManager");return t?(t.applyToViewers(function(t){e=t.antiAliasing}),e):(console.error("Get Antialiasing API Failed"),"Something went wrong")},GetSelectedObjects:function(){return this._APIMngr.GetSelectedObjects()},ChangeProperties:function(e){this._APIMngr.ChangeProperties(e)},GetProperties:function(e,t){return this._APIMngr.GetProperties(e,t)},ActivateTooltipDisplayOnPartHover:function(){this._APIMngr.ActivateTooltipDisplayOnPartHover()},DeactivateTooltipDisplayOnPartHover:function(){this._APIMngr.DeactivateTooltipDisplayOnPartHover()},SetPreventPartsFromBeingSelectable:function(e){this._APIMngr.SetPreventPartsFromBeingSelectable(e)},GetPreventPartsFromBeingSelectable:function(){return this._APIMngr.GetPreventPartsFromBeingSelectable()},SetPreventCollaborativeActorsFromBeingSelectable:function(e){this._APIMngr.SetPreventCollaborativeActorsFromBeingSelectable(e)},GetPreventCollaborativeActorsFromBeingSelectable:function(){return this._APIMngr.GetPreventCollaborativeActorsFromBeingSelectable()},SetKeepLinkSelectable:function(e){this._APIMngr.SetKeepLinkSelectable(e)},GetKeepLinkSelectable:function(){return this._APIMngr.GetKeepLinkSelectable()},SetKeepHotspotsSelectable:function(e){this._APIMngr.SetKeepHotspotsSelectable(e)},GetKeepHotspotsSelectable:function(){return this._APIMngr.GetKeepHotspotsSelectable()},SetKeepAssemblySelectionModeActive:function(e){this._APIMngr.SetKeepAssemblySelectionModeActive(e)},GetKeepAssemblySelectionModeActive:function(){return this._APIMngr.GetKeepAssemblySelectionModeActive()},GetAllActors:function(e){return this._APIMngr.GetAllActors(e)},SelectActors:function(e){return this._APIMngr.SelectActors(e)},ZoomFitAll:function(e){return this._APIMngr.ZoomFitAll(e)},GetViewport:function(){return this._APIMngr.GetViewport()},SetVisibility:function(e,t){return this._APIMngr.SetVisibility(e,t)},GetVisibility:function(e,t){return this._APIMngr.GetVisibility(e)},FetchInformation:function(e){if(this._experienceBase.getManager("VCXContextManager").getIfStanAlonePlayerIsInDevMode()){var t=e.lastIndexOf("/"),i=e.slice(0,t);t=i.lastIndexOf("/");var n=(i=i.slice(0,t))+"/ComposerWebPlayer/version.json",r=new XMLHttpRequest;r.open("GET",n);var o=this;r.onreadystatechange=function(){if(4===r.readyState&&(200===r.status||0===r.status)){var e=r.responseText,t=/{.*{(.*)}.*{(.*)}.(.*)}/,i=t.exec(e),n=i[1],a=/.*"(.*)",.*"(.*)"/.exec(n),s=i[3],c=(t=/([A-Z]{2}).*"(.*)"/).exec(s);o._versionInfo=a[1]+" "+c[1]+" "+c[2],o._buildInfo=a[2]}},r.send()}},AddInformation:function(e,t){if(this._experienceBase.getManager("VCXContextManager").getIfStanAlonePlayerIsInDevMode()){this.AddFileOpenOptions(e,t);var i=e.getElementById("DivLogo"),n=e.getElementById("buildVersion");if(this._versionInfo&&this._buildInfo&&!n){var r=e.createElement("div");r.id="divBuildVersion";var o=this._versionInfo.slice(this._versionInfo.indexOf(".")+1,this._versionInfo.lastIndexOf(".")),a=this._versionInfo.slice(this._versionInfo.lastIndexOf(".")+1),s=o.slice(0,o.indexOf(".")),c=a.slice(a.lastIndexOf(" ")+1),l=a.slice(0,a.indexOf(" "));this._mapVerNumbers&&this._mapVerNumbers.has(s)&&(s=this._mapVerNumbers.get(s));var p=e.createElement("text");p.id="buildVersion";var h="Version: "+s+" FD"+c+" ("+l+")";p.innerHTML=h,r.appendChild(p);var u=e.createElement("br");r.appendChild(u);var d=this._buildInfo.slice(0,this._buildInfo.indexOf(".")),f=this._buildInfo.slice(this._buildInfo.indexOf(".")+1),C=e.createElement("text");C.id="builddate";var m="  Build: "+d+" ("+f+")";C.innerHTML=m,r.appendChild(C),i?i.insertBefore(r,i.childNodes[0]):window.alert(h+"\n"+m)}}},AddFileOpenOptions:function(e,t){var i=e.getElementById("SelectSMG"),n=e.getElementById("BrowseSMG");if(i&&!n){var r=e.createElement("br");i.appendChild(r);var o=e.createElement("a");o.id="BrowseSMG",o.href="#",o.text="Browse SMG file on disk",i.appendChild(o);var a=this;o.onclick=function(){a.OpenFileBrowser(t)}}},OpenFileBrowser:function(e){var t=document.createElement("input");t.type="file",t.id="fileBrowserId",t.click(),console.log("Load smg file"),t.addEventListener("change",function(t){var i=this.files,n=i.length?i[0]:null;if(n&&n instanceof Blob){n.name;var r=new window.FileReader;r.onloadend=function(){var t=r.result,i=new Blob([t],{type:n.type}),o=window.URL.createObjectURL(i),a={experience:{filename:"DS/VCXWebAuthoringApp/VCXWebPlayerExperience"}};a.asset={filename:o,mimetype:"smg",type:"smg",format:"smg",provider:"FILE"},e.loadAsset(a)},r.readAsArrayBuffer(n)}})}});return Object.defineProperty(o.prototype,"componentType",{enumerable:!0,get:function(){return"VCXComposerAPIManager"}}),Object.defineProperty(o.prototype,"preventCollaborativeActorsFromBeingSelectable",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").excludeDressups},set:function(e){this._experienceBase.getManager("VCXSelectionManager").excludeDressups=e}}),Object.defineProperty(o.prototype,"preventPartsFromBeingSelectable",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").excludeParts},set:function(e){this._experienceBase.getManager("VCXSelectionManager").excludeParts=e}}),Object.defineProperty(o.prototype,"keepLinkSelectable",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").keepLinkSelectable},set:function(e){this._experienceBase.getManager("VCXSelectionManager").keepLinkSelectable=e}}),Object.defineProperty(o.prototype,"keepHotspotSelectable",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").keepHotspotsSelectable},set:function(e){this._experienceBase.getManager("VCXSelectionManager").keepHotspotsSelectable=e}}),o});