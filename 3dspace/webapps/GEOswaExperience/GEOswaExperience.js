define("DS/GEOswaExperience/GEOswaExperience",["DS/3DPlayExperienceModule/PlayExperience3D","UWA/Core","DS/Core/Events","DS/Visualization/ThreeJS_DS","DS/Visualization/Viewpoint","DS/WebappsUtils/WebappsUtils","DS/WebUtils/StringUtils"],function(e,i,n,s,a,r,o){return e.extend({init:function(e){that=this,this._parent(e);var n={workbenchs:[{name:"GEOswaExperienceWkb",module:"GEOswaExperience"}],swapVisible:!0,selection:!0,preSelection:!0,visu:{antiAliasing:!0,useShadowMap:!0,infinitePlane:!0,displayGrid:!1,displayLines:!1,debugShadowLight:!1,debugBSphere:!1,debugBBox:!1,control:"COMBINED",picking:!0,displayPicking:!0,prePicking:!1,displayprePicking:!1,autoUpdatePlane:!0,useMirror:!0,defaultAnimationLoop:!1},ui:{displayTree:!1,displayActionBar:!0}};that.args=i.extend(e,n,!0)},loadModel:function(e,i,n){this.backup=arguments;this.frmWindow.getViewer();var s=e?e.asset:this.args.input?this.args.input.asset:null;void 0!==s.filename&&null!==s.filename&&""!==s.filename||(s.filename=s.originalAsset.displayname),!0===(null==s||""===s||"string"!=typeof s&&(void 0===s.filename||null===s.filename||""===s.filename)&&(void 0===s.physicalid||null===s.physicalid||""===s.physicalid))&&(s=r.getWebappsBaseUrl()+"3DPlay/assets/models3d/3DS_emblem.cgr");var a="",t=s;if("string"==typeof t){if(""===t)return;a=t;var d=o.getExtension(t);""!==d&&"3dxml"!=(d=d.toLowerCase())&&this.modelLoader.setFileType(d)}else{if(!(void 0!==t.provider&&null!==t.provider&&"file"!==t.provider.toLowerCase()||null!=(a=t.filename)&&""!==a))return;i&&i.tenant&&(t.tenant=i.tenant)}if(this.pad3DViewer&&t.provider&&"FILE"!==t.provider){e.asset.id=e.asset.physicalid;var l=[e.asset];this.pad3DViewer.addRoots({objects:l},!1)}else this.modelName=a.split("/").pop(),this.modelLoader.loadModel(t);this.onModelLoadingStarted(n)},onPreCreate:function(){this.args&&(this.args.visu={showReferenceAxisSystem:!0}),this.mabModel={speeddial:[{id:"AnnotationCommands",rsc:"3DPlay/3DPlayExperience3D"},{id:"Reframe",rsc:"3DPlay/3DPlayExperience3D"}],sections:[{id:"ViewSelector",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",hideAB:!0,showBack:!0},{id:"VisibilityCommands",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D"},{id:"EnhancedExplode",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",hideAB:!0,showBack:!0},{id:"measure2CmdHdr",nls:"DMUBaseCommands/3DPlayPro",rsc:"DMUBaseCommands/3DPlayPro",hideAB:!0},{id:"section2CmdHdr",nls:"DMUBaseCommands/3DPlayPro",rsc:"DMUBaseCommands/3DPlayPro"},{id:"AnnotationTour",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",hideAB:!0,showBack:!0},{id:"Render",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",flyout:[{id:"VisuShading",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingEdgesNoSmoothEdges",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingEdgesHiddenEdges",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingMaterialEdges",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingMaterial",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingIllustration",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuNoShadingEdges",rsc:"ViewerCommands/ViewerCommands"}]},{id:"Ambiance",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",flyout:[{id:"VisuNoEnv",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuV6Env",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuCleanSpaceEnv",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuDarkBlueEnv",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuDarkGreyEnv",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShinyEnv",rsc:"ViewerCommands/ViewerCommands"}]},{id:"HideShowFilter",nls:"GEOHideShowFilterCmd/GEOHideShowFilterWkb",rsc:"GEOHideShowFilterCmd/GEOHideShowFilterCmd"}]}},onPostCreate:function(){var e=this,i=e.frmWindow.getViewer();e.frmWindow.getContextualUIManager().register({workbenchName:"GEOswaExperienceWkb",module:"GEOswaExperience",cmdPrefix:"",fileName:"GEOswaExperienceWkb.xml",onContextualMenuReady:function(e,n){if(n&&n.XmousePosition){var a=new s.Vector2(n.XmousePosition,n.YmousePosition),r=i.getMousePosition(a);if(0==i.pick(r,"mesh",!0).path.length)return{cmdList:[{name:"Dropdown_1",line:1,hdr_list:["VisuNoEnv"]},{name:"Dropdown_2",line:1,hdr_list:["VisuV6Env"]},{name:"Dropdown_2",line:1,hdr_list:["VisuCleanSpaceEnv"]},{name:"Dropdown_2",line:1,hdr_list:["VisuDarkBlueEnv"]},{name:"Dropdown_2",line:1,hdr_list:["VisuDarkGreyEnv"]},{name:"Dropdown_2",line:1,hdr_list:["VisuShinyEnv"]}]}}}}),n.subscribe({event:"GEOSwaViewpoint"},function(n){var r=e.frmWindow.getViewpoint(),o=new s.Vector3(n.viewport.positionX+n.viewport.datumX,n.viewport.positionY+n.viewport.datumY,n.viewport.positionZ+n.viewport.datumZ);r.setEyePosition(o);var t=new s.Vector3(n.viewport.targetX+n.viewport.datumX,n.viewport.targetY+n.viewport.datumY,n.viewport.targetZ+n.viewport.datumZ);r.setTarget(t);var d=new s.Vector3(n.viewport.upX,n.viewport.upY,n.viewport.upZ);r.setUpDirection(d),r.setProjectionType(a.ORTHOGRAPHIC),i.render()})}})});