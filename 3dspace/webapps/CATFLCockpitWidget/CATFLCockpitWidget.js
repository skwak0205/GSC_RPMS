define("DS/CATFLCockpitWidget/utils/group.util",["UWA/Core","UWA/Class/Promise","UWA/Utils/InterCom","DS/WAFData/WAFData","DS/PlatformAPI/PlatformAPI","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","text!DS/CATFLCockpitWidget/assets/config/webservices.conf.json","text!DS/CATFLCockpitWidget/assets/config/masks.conf.json","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json"],function(e,t,i,n,o,r,s,a,l,c,d){"use strict";return{getGroupNodeParent:function(e){let t=this,i=e.getParent();return i.getID?i:t.getGroupNodeParent(i)},removeGroupNodesOnEmpty:function(e){let t=this,i=e.getParent();return e.getChildren()&&0!==e.getChildren().length||e.remove(),i.getID?void 0:t.removeGroupNodesOnEmpty(i)}}}),define("DS/CATFLCockpitWidget/utils/config.util",["UWA/Core","UWA/Class/Promise","UWA/Utils/InterCom","DS/WAFData/WAFData","DS/PlatformAPI/PlatformAPI","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","text!DS/CATFLCockpitWidget/assets/config/webservices.conf.json","text!DS/CATFLCockpitWidget/assets/config/masks.conf.json","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json"],function(e,t,i,n,o,r,s,a,l,c,d){"use strict";var u={nlsBasicAttributesBO:{},nlsBasicAttributesRel:{},identifiers:JSON.parse(d),masks:JSON.parse(l),localStorageKeys:JSON.parse(c),webservices:JSON.parse(a),mappingType:{}};return u.mappingType[u.identifiers.type_act_logref]={nlsName:u.identifiers.type_logicalref,icon:"I_VPMNavLogical.png"},u.mappingType[u.identifiers.type_act_loginstance]={nlsName:u.identifiers.rel_logicalInstance},u.mappingType[u.identifiers.type_document]={icon:"I_TextDoc22x22.png"},u.mappingType[u.identifiers.type_requirement]={icon:"iconReqTypeRequirement.png"},u.mappingType[u.identifiers.type_act_functref]={icon:"I_VPMNavFunction.png"},u.mappingType[u.identifiers.type_act_physical]={icon:"I_VPMNavProduct.png"},{cleanRecentlyAuthoredItemsInLocalStorage:function(){var e=1e3*parseInt(widget.getPreference(u.localStorageKeys.timeoutIndex).value,10);let t=this;for(var i=localStorage.length-1;i>=0;i--){var n=localStorage.key(i);-1!==n.indexOf(u.localStorageKeys.recentlyAuthored)&&Date.now()-JSON.parse(t.SAXStorage().getItem(n),10)>e&&localStorage.removeItem(n)}},setAuthIDforWIW:function(e,t){this.AuthIDForWIW={workunder:e,value:t}},getAuthorizedWorkUnder:function(e){var t={},i=s.get();if(e){let e="DS-Configuration-Authoring-Context",i=null;this.AuthIDForWIW&&this.AuthIDForWIW.value&&("evolution"===this.AuthIDForWIW.workunder?i="pid:"+this.AuthIDForWIW.value:(e="DS-Change-Authoring-Context",i=this.AuthIDForWIW.value),t[e]=i)}else if(i&&i&&i.AuthoringContextHeader)for(var n in i.AuthoringContextHeader)t[n]=i.AuthoringContextHeader[n];return t},getEntry:function(e){return u[e]},getFullConfig:function(){return u},getPlatformServices:function(){var i=this;return new t(function(t,n){r.getPlatformServices({onComplete:function(n){var o={};e.is(n,"array")&&n.length>0&&n.forEach(function(e){o[e.platformId]=e}),i._platformServices=o,i.retrieveSecurityContext().then(function(e){t(e)})},onFailure:n})})},retrieveCurrentUser:function(){var e=this;return new t(function(t,i){if(e._user&&e._user.id)return t(e._user);r.getUser({onComplete:function(i){e._user={id:i.id,email:i.email,firstName:i.firstname,lastName:i.lastname},t(e._user)},onFailure:i})})},getSecurityContext:function(){var e=widget.getPreference(u.localStorageKeys.credentials),t=widget.getValue("widgetSecCtxPref");return e&&e.value?this._securityContext=e.value:this._securityContext=t&&null!=t?t:null,this._securityContext},getServiceURL:function(e){var t=this.getTenant();return this._platformServices[t][e]},retrieveSecurityContext:function(){var i=this,o=null;return new t(function(t,r){var s=i.getServiceURL("3DSpace")+u.webservices.pnoCredential+"&tenant="+i.getTenant();n.authenticatedRequest(s,{method:"GET",type:"json",headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(n){e.is(n.collabspaces,"array")&&0===n.collabspaces.length&&t(!1),o=i.credentialDataParser(n),t(o)},onFailure:r,onTimeout:r})})},getTenant:function(){return e.is(this._tenant)||(this._tenant=widget.getValue("x3dPlatformId")),this._tenant},switchPlatform:function(e){return!(!e||!e instanceof String)&&(widget.setValue("x3dPlatformId",e),this._tenant=e,!0)},getUser:function(e){var t="";if(this._user)return"isFullName"===e?t=this._user.firstName+" "+this._user.lastName:"isTrigram"===e?t=this._user.id:t},form3DXContent:function(e){return{protocol:"3DXContent",version:"1.1",source:widget.getValue("appId"),widgetId:widget.id,data:{items:this.getItemDetailsToShare(e)}}},getItemDetailsToShare:function(e){var t=this,i=[];return e.forEach(function(e){i.push({envId:t.getTenant(),serviceId:"3DSpace",contextId:t.getSecurityContext(),objectId:e.getID(),objectType:e.getType(),displayName:e.getLabel(),facetName:"realized",path:[{resourceid:e.getID(),type:e.getType()}]})}),i},setObjectOnCompass:function(t){var n=e.is(widget)&&widget.id?"flcockpitcompassSocket_"+widget.id:"flcockpitcompassSocket";this.flcockpitIntercom||(this.flcockpitIntercom=new i.Socket(n),this.flcockpitIntercom.subscribeServer("com.ds.compass",window.parent)),0==t.data.items.length?(this.flcockpitIntercom.dispatchEvent("onResetObject",{}),this.flcockpitIntercom.dispatchEvent("onResetX3DContent",{},n)):(this.flcockpitIntercom.dispatchEvent("onSetObject",t.data.items[0]),this.flcockpitIntercom.dispatchEvent("onSetX3DContent",t,n))},launchCrossAppSelection:function(e){var t={attributes:e.reduce(function(e,t){return e[t.getID()]={type:t.getType(),label:t.getLabel()},e},{}),paths:e.map(function(e){return e.getOccurencePath()}),version:"1.1"},i={metadata:{uid:Math.random(),originUid:Math.random(),timestamp:Date.now(),appid:widget.getValue("appId")+"_"+widget.id},data:t};o.publish("DS/PADUtils/PADCommandProxy/select",i)},getTypeIconUrl:function(e){var t=u.mappingType[e];return{iconPath:this.getServiceURL("3DSpace")+"/snresources/images/icons/small/"+t.icon,iconSize:{width:"16px",height:"16px"}}},credentialDataParser:function(e){var t,i,n;this._theListSC=[],this._theListSC_NLS=[],this.returnList=[],this._SCPreferredDB=null;var o=e.preferredcredentials;if(o.collabspace&&o.role&&o.organization){var r=o.collabspace,s=o.role,a=o.organization;t=r.name,i=s.name,n=a.name,this._SCPreferredDB=i+"."+n+"."+t}var l=e.collabspaces;if(l&&l.length>0){for(var c=!1,d=void 0,u=0;u<l.length;u++){for(var p=(f=l[u]).couples||[],g=0;g<p.length;g++){var m=p[g];if(void 0===d&&(d=m.organization.name),d!==m.organization.name){c=!0;break}}if(c)break}for(u=0;u<l.length;u++){var f,h=(f=l[u]).name,v=f.title;for(p=f.couples,g=0;g<p.length;g++){var C=p[g],b=C.organization,y=C.role,_=b.name,D=b.title,S=y.name,w=y.nls,I=S+"."+_+"."+h,A=c?v+" ● "+D+" ● "+w:v+" ● "+w;this._theListSC.push(I),this._theListSC_NLS.push(A),this.returnList.push({label:A,value:I})}}}return{optionList:this.returnList,defaultValue:this._SCPreferredDB}},retrieveCSRFToken:function(){var e=this;return new t(function(t,i){var o=e.getServiceURL("3DSpace")+u.webservices.getCSRFToken+"?tenant="+e.getTenant();n.authenticatedRequest(o,{method:"GET",type:"json",headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(i){e.csrfToken=i.csrf.value,t()},onFailure:i,onTimeout:i})})},refreshCSRFToken:function(){var e=this;setTimeout(function(){e.retrieveCSRFToken(),e.refreshCSRFToken()},9e5)},getCSRFToken:function(){return this.csrfToken},SAXStorage:function(){return{setItem(e,t){localStorage.setItem(e,t),widget.setValue(e,t)},getItem:e=>widget.getValue(e)||localStorage.getItem(e)||null}}}}),define("DS/CATFLCockpitWidget/utils/model.events.util",["UWA/Core","DS/CoreEvents/ModelEvents"],function(e,t){"use strict";var i={},n=[];return{createAppEventObject:function(e){return i[e]=new t,i[e]},subscribeEvent:function(){},getFLWebModelEventsObj:function(e){return i[e]},publishEvent:function(e){this.getFLWebModelEventsObj(e.userAction).publish({event:e.eventName,data:e.eventData}),this.cleanSubscriptionAndUserAction(e)},cleanSubscriptionAndUserAction:function(e){this.getFLWebModelEventsObj(e.userAction).unsubscribe({event:e.eventName})},deleteAppEventObject:function(e){delete i[e]},addToSubscriptionList:function(e){n.push(e)},getSubscriptionList:function(){return n},removeFromSubscriptionList:function(e){n=n.filter(function(t){return t!==e})},clearSubscriptionList:function(){n=[]}}}),define("DS/CATFLCockpitWidget/utils/search.util",["UWA/Core","UWA/Utils/InterCom","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i){"use strict";var n={initialize:function(){this.socketName="search_socket_"+(new Date).getTime(),this.socket=new t.Socket(this.socketName,{dispatchRetryInterval:5}),this.socket.subscribeServer("SearchComServer"),this.listener=this.objectsSelected.bind(this),this.socket.addListener("Selected_Objects_search",this.listener);var e=this.options();return this.socket.dispatchEvent("RegisterContext",e),this},options:function(t,i,n,o,r,s,a){var l={};return l.title=t,l.mode="furtive",l.app_socket_id=this.socketName,l.widget_id=widget.id,l.default_with_precond=!0,l.show_precond=!1,l.idcard_activated=!1,l.multiSel=!!e.is(r)&&r,l.role=n,i&&(l.precond="",(i=i.split(",")).forEach(function(e,t){0!==t&&(l.precond+=" OR "),l.precond+='flattenedtaxonomies:"types/'+e+'"'})),l.recent_search={types:i},s&&(l.precond?l.precond="( "+l.precond+") AND "+s:l.precond=s),a&&a.length>0&&(l.columns=a),l},destroy:function(){var e={};e.widget_id=widget.id,this.socket.dispatchEvent("unregisterSearchContext",e),this.socket.unsubscribeServer("SearchComServer"),this.socket.removeListener("Selected_Objects_search",this.listener),this.socket.disconnect(),delete this.socket},activate:function(e,t,i,n,o,r,s,a){var l=this.options(e,t,i,n,o,s,a);this.callback=r,this.socket.dispatchEvent("RegisterContext",l),this.socket.dispatchEvent("InContextSearch",l)},isAvailable:function(){return e.is(this.socket)},configureSearch:function(e){this.isAvailable()||this.initialize(e)},launchSearch:function(e){var t=e.searchTitle||i.label_search_title;this.activate(t,e.allowedTypes,e.role||"",e.criteria,e.bMultiSel,function(t){e.in_apps_callback(t)},e.additionalQuery,e.selectable)},objectsSelected:function(e){var t,i,n=[];if(this.callback){for(t=0,i=e.length;t<i;t++)n.push(e[t]);this.callback(n)}}};return n.initialize(),n}),define("DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrixToolbar",["DS/Tweakers/GeneratedToolbar","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t){"use strict";var i=function(e,t){this.wrapper=e,this.render(t)};return i.prototype.render=function(t){var i={entries:[]};this._addExpandActionEntry(i),this._addCollapseActionEntry(i),this._addExportActionEntry(i),this._addSwitchMatrixActionEntry(i),this._addFilterActionEntry(i);var n=e.prototype.createTreeDocument(i);this.catflGeneratedToolbar=new e({overflowManagement:"dropdown",direction:"horizontal",items:n}),this.catflGeneratedToolbar.inject(t)},i.prototype._addExpandActionEntry=function(e){var i=this;e.entries.push({id:"expAll_btn",dataElements:{typeRepresentation:"functionMenuIconCount",tooltip:t.action_expand,value:{menu:[{type:"PushItem",title:"0",action:{callback:function(){i.wrapper.trMatrix.setExpandLevel(0),i.catflGeneratedToolbar.getNodeModelByID("expAll_btn")._associatedView.count=-1}}},{type:"PushItem",title:"1",action:{callback:function(){i.wrapper.trMatrix.setExpandLevel(1),i.catflGeneratedToolbar.getNodeModelByID("expAll_btn")._associatedView.count=1}}},{type:"PushItem",title:"2",action:{callback:function(){i.wrapper.trMatrix.setExpandLevel(2),i.catflGeneratedToolbar.getNodeModelByID("expAll_btn")._associatedView.count=2}}},{type:"PushItem",title:"3",action:{callback:function(){i.wrapper.trMatrix.setExpandLevel(3),i.catflGeneratedToolbar.getNodeModelByID("expAll_btn")._associatedView.count=3}}},{type:"PushItem",title:"4",action:{callback:function(){i.wrapper.trMatrix.setExpandLevel(4),i.catflGeneratedToolbar.getNodeModelByID("expAll_btn")._associatedView.count=4}}},{type:"PushItem",title:"N",action:{callback:function(){i.wrapper.trMatrix.setExpandLevel(-1),i.catflGeneratedToolbar.getNodeModelByID("expAll_btn")._associatedView.count=0}}}]},icon:{iconName:"flow-tree-expand-down",fontIconFamily:1},count:-1,position:"far",category:"1"}})},i.prototype._addCollapseActionEntry=function(e){e.entries.push({id:"collapse_btn",dataElements:{typeRepresentation:"functionIcon",action:{module:"DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrixToolbarActions",func:"executeToolbarCmd",argument:{id:"collapse_btn",toolbarCtx:this}},tooltip:t.action_collapse_all,icon:{iconName:"flow-tree-expand-up",fontIconFamily:1},position:"far",category:"1"}})},i.prototype._addExportActionEntry=function(e){e.entries.push({id:"export_btn",dataElements:{typeRepresentation:"functionIcon",action:{module:"DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrixToolbarActions",func:"executeToolbarCmd",argument:{id:"export_btn",toolbarCtx:this}},tooltip:t.action_export_2_excel,icon:{iconName:"export",fontIconFamily:1},position:"far",category:"2"}})},i.prototype._addSwitchMatrixActionEntry=function(e){e.entries.push({id:"switchMatrix_btn",dataElements:{typeRepresentation:"functionIcon",action:{module:"DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrixToolbarActions",func:"executeToolbarCmd",argument:{id:"switchMatrix_btn",toolbarCtx:this}},tooltip:t.action_switch_matrix,icon:{iconName:"table-row-column",fontIconFamily:1},position:"far",category:"2"}})},i.prototype._addFilterActionEntry=function(e){e.entries.push({id:"filter_btn",dataElements:{typeRepresentation:"functionIcon",action:{module:"DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrixToolbarActions",func:"executeToolbarCmd",argument:{id:"filter_btn",toolbarCtx:this}},tooltip:t.action_Filter,icon:{iconName:"filter",fontIconFamily:1},position:"far",category:"3"}})},i}),define("DS/CATFLCockpitWidget/utils/modelObj.util",["UWA/Class/Model"],function(e){"use strict";var t=e.extend({setup:function(e){this._parent(e)},getID:function(){return this.get("physicalid")},getLabel:function(){return this.get("label")},getType:function(){return this.get("type")},getDisplayName:function(){return this.get("label")},getParent:function(){return this.get("parent")?new t(this.get("parent")):null},getRelationID:function(){return this.get("relID")}});return t}),define("DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel",["DS/TreeModel/TreeNodeModel","DS/WebappsUtils/WebappsUtils"],function(e,t){"use strict";var i=["RFLPLMFunctionalConnection","RFLVPMLogicalConnection"],n=["RFLPLMFlowExpositionInstance","RFLVPMSystemTypeExpositionInstance","RFLPLMFunctionalConnector","RFLVPMLogicalPort"];function o(t){this.options={grid:{},color:"rgba(0, 0, 0, 0)",isUIActive:!1,relationid:"",physicalid:"",type:"",basetype:"",relationtype:"",virtual:!1},this.options.grid.active_color="rgba(0, 0, 0, 0)",this.options.grid.bi_color="rgba(0, 0, 0, 0)",this.options=UWA.extend(this.options,t),e.call(this,this.options)}function r(e){e._getFilterInfo||(e._getFilterInfo=o.prototype._getFilterInfo.bind(e),e._getChildrenFilterInfo=o.prototype._getChildrenFilterInfo.bind(e),e._removeChildrenFilterInfo=o.prototype._removeChildrenFilterInfo.bind(e),e.filterInChild=o.prototype.filterInChild.bind(e),e.filterOutChild=o.prototype.filterOutChild.bind(e))}return o.prototype=Object.create(e.prototype),o.prototype.getRealPath=function(){var e=this.getPath();return e.length>0&&e[0].isVirtual()&&e.shift(),e},o.prototype.isVirtual=function(){return this.options.virtual},o.prototype.getAttribute=function(e){return"ds6w:label-Instance"===e&&(e="instanceName"),this.getAttributeValue(e)},o.prototype.isConnection=function(){return i.indexOf(this.getBaseType())>=0},o.prototype.isConnector=function(){return n.indexOf(this.getBaseType())>=0},o.prototype.getType=function(){return this.options.type},o.prototype.getBaseType=function(){return this.options.basetype},o.prototype.getRelationType=function(){return this.options.relationtype},o.prototype.getGroups=function(){let e;return e=this.options.merged?this.options.grp:UWA.Utils.splat(this.options.grp)},o.prototype.setID=function(e){this.options.physicalid=e},o.prototype.getID=function(){return this.options.physicalid},o.prototype.getReferenceID=function(){return this.options.physicalid},o.prototype.getRelationID=function(){return this.options.relationid},o.prototype.setRelationID=function(e,t){this.options.relationid=e,this.options.relationtype=t},o.prototype.addChild=function(e,t){if(!Array.isArray(e)){var i=this.getTreeDocument();if(i&&e.options.physicalid&&e.options.physicalid.length>0){var n=i.getRoots()[0];0==Object.keys(i.mappedNodesToIds).length&&n.options.physicalid.length>0&&(i.mappedNodesToIds[n.options.physicalid]=[n]),i.mappedNodesToIds[e.options.physicalid]||(i.mappedNodesToIds[e.options.physicalid]=[]),i.mappedNodesToIds[e.options.physicalid].push(e)}return this._addChild(e,t)}},o.prototype.removeChild=function(t){if(!Array.isArray(t)){var i=this.getTreeDocument();if(i&&t.options.physicalid&&t.options.physicalid.length>0){var n=i.mappedNodesToIds[t.options.physicalid];if(n){for(var o=n.length-1;o>=0;o--){n[o]._id===t._id&&n.splice(o,1)}n.length<=0&&delete i.mappedNodesToIds[t.options.physicalid]}}return Object.create(e.prototype).removeChild.call(this,t)}},o.prototype.getNodesById=function(e){var t={listOfFoundNodes:[]};return this._groupingOptions?this.getChildrenFromGroupById(e,t):this._getNodesById(e,t),t.listOfFoundNodes},o.prototype.getChildrenFromGroupById=function(e,t){this.getChildren().forEach((i,n)=>{i.getID?i._getNodesById(e,t):o.prototype.getChildrenFromGroupById.call(i,e,t)})},o.prototype._getNodesById=function(e,t){var i=!1;if(this.getID()===e)t.listOfFoundNodes.push(this),i=!0;else{var n=this.getChildren();if(n)for(var o=0;n&&o<n.length;o++)i=n[o]._getNodesById(e,t)||i}return i},o.prototype.getNodesByRelId=function(e){var t={listOfFoundNodes:[],foundId:void 0};return this._groupingOptions?this.getChildrenFromGroupByRelId(e,t):this._getNodesByRelId(e,t),t.listOfFoundNodes},o.prototype.getChildrenFromGroupByRelId=function(e,t){this.getChildren().forEach((i,n)=>{i.getID?i._getNodesByRelId(e,t):o.prototype.getChildrenFromGroupByRelId.call(i,e,t)})},o.prototype._getNodesByRelId=function(e,t){var i=this.options.relationid,n=this.getID();if(i===e)t.listOfFoundNodes.push(this),t.foundId=n;else if(n!==t.foundId){var o=this.getChildren();if(o)for(var r=0;r<o.length;r++)o[r]._getNodesByRelId(e,t)}},o.prototype.getOccurencePath=function(e){UWA.is(e,"function")&&e(this);var t=this.options.actualParent||this.getParent();if(this.isRoot()||this.isVirtual()||!t)return[this.options.physicalid];var i=t.getOccurencePath(e);return this.options.isGroupingNode?i:(i.push(this.options.instance.physicalid),i.push(this.options.physicalid),i)},o.prototype.setActive=function(e){this.updateOptions({isUIActive:e})},o.prototype.isActive=function(){return this.options.isUIActive},o.prototype.setColor=function(e){this.updateOptions({color:e,grid:{active_color:e}})},o.prototype._removeFilterInfo=function(){delete this.options._filterInfo},o.prototype._removeChildrenFilterInfo=function(){delete this.options._childrenFilterInfo},o.prototype._getFilterInfo=function(e){return!this.options._filterInfo&&Boolean(e)&&(this.options._filterInfo={}),this.options._filterInfo},o.prototype._getChildrenFilterInfo=function(e){return!this.options._childrenFilterInfo&&Boolean(e)&&(this.options._childrenFilterInfo={}),this.options._childrenFilterInfo},o.prototype.filterOut=function(){var e=this.isRoot()?this.getTreeDocument():this.getParent();null!==e&&(r(e),e.filterOutChild(this))},o.prototype.filterIn=function(e){var t=this._getFilterInfo();if(t&&t.parentBeforeFiltering){var i=t.parentBeforeFiltering;r(i),i.filterInChild(this)}if(Boolean(e)){var n,o=this._getChildrenFilterInfo();(n=o&&o.childrenBeforeFiltering?o.childrenBeforeFiltering:this.getChildren())&&n.forEach(function(t){t.filterIn(e)})}},o.prototype.filterOutChild=function(e){var t=this.getChildren();if(t.indexOf(e)<0)throw"Not a child";var i=this._getChildrenFilterInfo(!0);if(!i.childrenBeforeFiltering){i.childrenBeforeFiltering=t&&t.length>0?t.slice(0):[];UWA.is(this._expandState)&&(i.expandStateBeforeFiltering={noExpandState:"noChildren",expandingState:"expanding",partiallyExpandedState:"partiallyExpanded",collapseState:"expanded",expandState:"collapsed"}[this._expandState])}e._getFilterInfo(!0).parentBeforeFiltering=this,UWA.is(this.removeChild,"function")?this.removeChild(e):this.removeRoot(e,!0,!0),UWA.is(this.setState,"function")&&this.setState({state:i.expandStateBeforeFiltering}),i.filteredOutChildren||(i.filteredOutChildren=[]),i.filteredOutChildren.push(e)},o.prototype.filterInChild=function(e){var t=this._getChildrenFilterInfo();if(t){var i=t.childrenBeforeFiltering;if(i){var n=i.indexOf(e);if(n>=0){var o=e._getFilterInfo();if(o&&o.parentBeforeFiltering===this){var r,s=this.getChildren();if(s)for(var a=0;a<s.length;a++){var l=s[a];if(i.indexOf(l)>n){r=l;break}}delete o.parentBeforeFiltering,void 0!==e.options.isRootAttached?!0===e.options.isRootAttached&&this.insertBefore(e,r):this.insertBefore(e,r),UWA.is(this.setState,"function")&&this.setState({state:t.expandStateBeforeFiltering}),e._removeFilterInfo();var c=t.filteredOutChildren.indexOf(e);t.filteredOutChildren.splice(c,1),0===t.filteredOutChildren.length&&this._removeChildrenFilterInfo()}}}}},o.prototype.isDescendantOf=function(e){var t;if(t=e instanceof o?e.getID():e,this.getID()===t)return!0;if(!this.isRoot()){var i=this.getParent();if(i)return i.isDescendantOf(t)}return!1},o}),define("DS/CATFLCockpitWidget/components/PropertiesPanel/facets/RelatedDocumentsFacet",["UWA/Core","UWA/Class","UWA/Controls/Abstract","DS/CATFLCockpitWidget/utils/config.util","DS/EditPropWidget/facets/Common/FacetsBase","DS/ENOXAttachmentsUX/AttachmentsPane","DS/ENOXSpecificationsUX/SpecificationsPane","DS/CATFLCockpitWidget/utils/model.events.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l){let c=a.getFLWebModelEventsObj("flcockpit-content-list-view");return t.extend(i,o,{init:function(e){this._parent(e),this.buildView(e)},buildView:function(){var t=this;t.elements.container=e.createElement("div",{class:t.options.specificationDocuments?"relatedDocuments_spec":"relatedDocuments"}),t.multiselDisplay=e.createElement("div",{class:"notSupported"}).inject(t.elements.container),t.iconHolder=e.createElement("span",{class:"blockIcon"}).inject(t.multiselDisplay),t.infoMsgH2Tag=e.createElement("h2",{class:"information_msg"}).inject(t.multiselDisplay),t.multiselDisplay.hide();var i={parentObject:{},connectorOptions:{fetchSecurityContext:function(){return n.getSecurityContext()},getWorkUnderHeaders:function(){return n.getAuthorizedWorkUnder()},platformUrls:{"3DSpace":n.getServiceURL("3DSpace"),platformId:n.getTenant()},webinwin:!1}};t.options.specificationDocuments?(t.documentsPane=new s(i),t.documentsPane.modelEvents.subscribe({event:"upload-attachment-complete"},function(){t.refreshNode()}),t.documentsPane.modelEvents.subscribe({event:"attach-attachment-complete"},function(){t.refreshNode()}),t.documentsPane.modelEvents.subscribe({event:"detach-attachment-complete"},function(){t.refreshNode()})):t.documentsPane=new r(i),t.elements.container.appendChild(t.documentsPane.elements.container),t.multiselDisplay.isHidden()||t.documentsPane.hide()},refreshNode:function(e){var t=this.getActiveNodeDetails().node;c.publish({event:"refresh-documents-by-id",data:{nodes:[t],docType:"specificationDocumentsCategory"}})},getActiveNodeDetails:function(){var e=null,t=null,i=this.options.appContext.contentView.treeDocument.getSelectedNodes();0===i.length?this.options.appContext.contentView.treeDocument.getRoots()[0]&&(e=this.options.appContext.contentView.treeDocument.getRoots()[0].options.physicalid,t=this.options.appContext.contentView.treeDocument.getRoots()[0]):1===i.length&&(e=i[0].options.physicalid,t=i[0]);return{nodeID:e,node:t}},updateFacet:function(){var e=this.getActiveNodeDetails().nodeID;!e||"specificationDocumentsCategory"==this.getActiveNodeDetails().node.getParent().options.type&&"SPECIFICATION_DOCUMENT"==this.options.tabId?this.notApplicable():(this.multiselDisplay.hide(),this.documentsPane&&(this.documentsPane.show(),this.documentsPane.options.parentObject.parentId!==e&&this.documentsPane.setParentObject({parentId:e})))},destroyComponent:function(){},notApplicable:function(){this.infoMsgH2Tag.setText(l.msg_not_supported_selection),this.iconHolder.addClassName("wux-ui-3ds wux-ui-3ds-5x wux-ui-3ds-block"),this.multiselDisplay.show(),this.documentsPane&&this.documentsPane.hide()},onResize:function(){},onRefresh:function(){}})}),define("DS/CATFLCockpitWidget/components/CommandsCtrl/ReplaceByRevisionCmd",["UWA/Class","DS/ApplicationFrame/Command","DS/AuthGenericCommands/AppContext","DS/AuthGenericCommands/commands/AuthGenericCmdRevisionUpdate","DS/CATFLCockpitWidget/utils/model.events.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget","i18n!DS/AuthGenericCommands/assets/nls/AuthGenericCommandsCatalog.json"],function(e,t,i,n,o,r,s){"use strict";var a={RFLVPMLogicalReference:!0,RFLVPMLogicalInstance:!0};return e.extend(t,n,{init:function(e){let t=this;i.isExternalContext=!0,i._is2DContext=function(){return!0},i.isThereARootSelected=function(){return!1},i.getOrdering=function(){return{}},i.refresh=function(e){e.operations&&e.operations.length>0&&o.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-items-on-replace",data:{replaceDetails:e.operations,selectedNodes:t.selectedNodes}})},i.getParentWithChild=function(e){if(null!=e&&e.length){for(var t=[],i=e.length,n=0;n<i;n++)for(var o=e[n],r=0;r<i;r++)if(n!==r)for(var s=e[r],a=s.getParent();a;)a===o&&t.push({parent:o,child:s}),a=a.getParent();return t}return[]},this._parent(e)},defaultOptions:{modeler:"v1/modeler/dsfl",version:"1.0",bAllOrNothing:!1,availability:"multiSelection",commandName:r.action_replace_other_rev,reportTitle:r.action_replace_other_rev_report,commandMode:"FlatList",options:{webInWin:!1,visibleColumn:{IsModified:!0,Title:!0,Revision:!0,Maturity:!0,Type:!0,Responsible:!0,Candidate:!0,ReplaceAction:!0,ExpectedRevision:!0,ExpectedMaturity:!0},EnableByRevision:!0,EnableBubbleup:!1,EnableCompare:!1},remapErrors:[{modeler:"Input parameters are not valid",user:s.ERR_008},{modeler:"You don't have the required license for this command.",user:s.error_license},{modeler:"Embedded Component not supported",user:r.authoring_failed_EC},{modeler:"ERR_FUN092398",user:r.ERR_FUN092398}],isValidSelection:function(e,t){var n={valid:[],invalid:[],status:!0},o=[],r=[];e.forEach(function(e){if(i.isRoot(e)){var t=i.getName(e);r.push({node:e,why:"ROOT",name:t})}else o.push(e)}),i.getParentWithChild(o).forEach(function(e){var t=e.child,n=o.indexOf(t);if(n>-1){o.splice(n,1);var s=i.getName(t);r.push({node:t,why:"CHILD",name:s,parent:e.parent})}}),o.forEach(function(e){var t=e.getType();if(!0===a[t])n.valid.push(e);else{var o=i.getName(e);r.push({node:e,why:"TYPE",name:o})}}),n.invalid=r,n.status=0===r.length,t(n)}}})}),define("DS/CATFLCockpitWidget/components/CommandsCtrl/ReplaceByLatestRevisionCmd",["UWA/Class","DS/ApplicationFrame/Command","DS/AuthGenericCommands/AppContext","DS/AuthGenericCommands/commands/AuthGenericCmdReplaceByLatestRevision","DS/CATFLCockpitWidget/utils/model.events.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget","i18n!DS/AuthGenericCommands/assets/nls/AuthGenericCommandsCatalog.json"],function(e,t,i,n,o,r,s){"use strict";var a={RFLVPMLogicalReference:!0,RFLVPMLogicalInstance:!0};return e.extend(t,n,{init:function(e){let t=this;i.isExternalContext=!0,i.isThereARootSelected=function(){return!1},i.getOrdering=function(){return{}},i.getParentWithChild=function(e){if(null!=e&&e.length){for(var t=[],i=e.length,n=0;n<i;n++)for(var o=e[n],r=0;r<i;r++)if(n!==r)for(var s=e[r],a=s.getParent();a;)a===o&&t.push({parent:o,child:s}),a=a.getParent();return t}return[]},i._is2DContext=function(){return!0},i.refresh=function(e){e.operations&&e.operations.length>0&&o.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-items-on-replace",data:{replaceDetails:e.operations,selectedNodes:t.selectedNodes}})},this._parent(e)},defaultOptions:{modeler:"v1/modeler/dsfl",version:"1.0",bAllOrNothing:!1,availability:"multiSelection",commandName:r.action_replace_latest_rev,reportTitle:r.action_replace_latest_rev_report,remapErrors:[{modeler:"Input parameters are not valid",user:s.ERR_008},{modeler:"You don't have the required license for this command.",user:s.error_license},{modeler:"Embedded Component not supported",user:r.authoring_failed_EC},{modeler:"ERR_FUN092398",user:r.ERR_FUN092398}],isValidSelection:function(e,t){var i={valid:[],invalid:[],status:!0};e.forEach(function(e){var t=e.getType();a[t]?i.valid.push(e):(i.invalid.push(e),i.status=!1)}),t(i)}}})}),define("DS/CATFLCockpitWidget/utils/configuration.util",["UWA/Core","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/CollectionView/ResponsiveLargeTilesCollectionView","DS/CATFLCockpitWidget/utils/config.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r){"use strict";return{updateContentWithListOfModels:function(e){let s=e.container,a=e.cfgContexts;var l=new t,c=new n({selectionBehavior:{canMultiSelect:e.canMultiSelect||!1,toggle:e.toggle||!1,unselectAllOnEmptyArea:e.unselectAllOnEmptyArea||!1}}).inject(s);return a.forEach((e,t)=>{var n=e.content&&e.content.results&&e.content.results.length>0?e.content.results[0]:null;if(n){var s="",a="",c="",d="",u=o.getServiceURL("3DSpace")+"/common/images/I_Model_Thumbnail.png";n.data&&n.data.length>0&&n.data[0]&&n.data[0].value&&n.data[0].value.length>0&&n.data[0].value[0]&&"Marketing Name"==n.data[0].name&&(s=n.data[0].value[0]),n.basicData.forEach((e,t)=>{"name"===e.name&&e.value&&e.value.length>0&&e.value[0]&&(a=e.value[0]),"owner"===e.name&&e.value&&e.value.length>0&&e.value[0]&&(c=e.value[0]),"current"===e.name&&e.value&&e.value.length>0&&e.value[0]&&(d=e.value[0])});var p=new i({label:s,thumbnail:n.preview_url&&""!==n.preview_url?n.preview_url:u,subLabel:a+" | "+c,description:r.label_maturity+" : "+d,dataModel:{physicalid:n.physicalID,name:a,title:s}});l.addRoot(p)}}),c.loadApplicativeModel(l),c}}}),define("DS/CATFLCockpitWidget/utils/common.util",["UWA/Core","DS/UIKIT/Mask","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/UIKIT/Alert","UWA/Controls/Drag","DS/Windows/Panel","DS/Controls/Tab","DS/Controls/ComboBox","DS/Utilities/KeyboardUtils","WebappsUtils/WebappsUtils","DS/CATFLCockpitWidget/utils/model.events.util","DS/DataDragAndDrop/DataDragAndDrop","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget","DS/CATFLCockpitWidget/utils/config.util","DS/i3DXCompassPlatformServices/OpenWith"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,g,m,f,h){"use strict";var v=f.getFullConfig(),C=JSON.parse(g),b=i;n.setNotificationManager(b);var y={alertMessage:function(e,t,i,n){i=i?i.replace(/(\r\n|\n|\r)/gm,"<br>"):"",n=n?n.replace(/(\r\n|\n|\r)/gm,"<br>"):"",b.addNotif({level:e,title:t,subtitle:i,message:n,sticky:!1})},displayError:function(t,i,n,o){var r=o;t.errorResp&&t.errorResp.message&&500!==t.errorResp.status?r=t.errorResp.message:e.is(t.error,"string")&&(r=t.error),n=n?n.replace(/(\r\n|\n|\r)/gm,"<br>"):"",r=r?r.replace(/(\r\n|\n|\r)/gm,"<br>"):"",y.alertMessage("error",i,n,r)},create3DXJsonFromDGVSelection:function(e,t){var i,n=[];t=void 0===t||t;for(var o=0;o<e.length;o++){if(i={contextId:"ctx::"+f.getSecurityContext(),displayName:e[o].options.label,displayType:e[o].options.grid.actualType||e[o].options.type,objectId:e[o].options.physicalid,objectType:e[o].options.grid.actualType||e[o].options.type,envId:f.getTenant(),serviceId:"3DSpace"},t){var r=e[o].getParent().options.physicalid;void 0!==r&&r.length>0&&(i.path=this._createPathFor3DXContent(e[o]))}n.push(i)}return{protocol:"3DXContent",version:"1.1",source:widget&&widget.getValue("appId"),widgetId:widget.id,data:{items:n}}},_createPathFor3DXContent:function(e){for(var t=[],i=e;void 0!==i.options.physicalid;)t.push({resourceid:i.options.physicalid,type:v.identifiers.type_act_logref}),i.options.instance&&i.options.instance.physicalid&&t.push({resourceid:i.options.instance.physicalid,type:v.identifiers.type_act_loginstance}),i=i.getParent();return t.reverse()},debounce:function(e,t,i){var n;return function(){var o=this,r=arguments,s=i&&!n;clearTimeout(n),n=setTimeout(function(){n=null,i||e.apply(o,r)},t),s&&e.apply(o,r)}},getFileInput:function(){var t=new e.createElement("input",{id:"fileExplorer",type:"file",styles:{display:"none"}}).inject(widget.body);return t.removeEvents(),t},makeDroppable:function(t,i,n){var o=t.getElement("#drop-invite");o||(o=new e.createElement("div",{id:"drop-invite",class:"hidden",html:i}).inject(t)),o.callback=n;var r={enter:this._manageDragEvents.bind(this),leave:this._manageDragEvents.bind(this),over:this._manageDragEvents.bind(this),drop:this._manageDropEvent.bind(this)};p.droppable(t,r)},_manageDragEvents:function(e,t){var i,n=(i=e).getElement("#drop-invite");switch(t.type){case"dragenter":i.addClassName("droppable"),n.removeClassName("hidden"),n.addClassName("show");break;case"dragleave":if(t.target!==n)return!1;i.removeClassName("droppable"),n.removeClassName("show"),n.addClassName("hidden");break;case"dragover":i.addClassName("droppable"),n.removeClassName("hidden"),n.addClassName("show")}return!0},_manageDropEvent:function(t,i){var n,o=(n=i).getElement("#drop-invite");if(t.trim().length>0){if(e.is(t,"string"))try{t=JSON.parse(t)}catch(e){t=null}else t=t;var r=t&&t.data&&t.data.items?t.data.items:null;o.callback(r)}n.hasClassName("droppable")&&n.removeClassName("droppable"),o.removeClassName("show"),o.addClassName("hidden")},cleanDragNDrop:function(e,t){p.clean(e,t)},formatDate:function(e){return e.indexOf("@")>=0&&(e=e.replace("@"," ")),e.indexOf(":GMT")>=0&&(e=e.replace(":GMT"," GMT")),new Date(e)},displayDate:function(e){return e instanceof Date?e.toLocaleString():new Date(e).toLocaleString()},checkIfRecentlyAuthored:function(e,t){var i;i=t?C.recentlyAuthoredStructure:C.recentlyAuthored;var n=f.SAXStorage().getItem(i+e);if(null!==n){if(Date.now()-parseInt(n,10)<1e3*parseInt(widget.getPreference(C.timeoutIndex).value,10))return!0;localStorage.removeItem(i+e)}return!1},checkIfMaturityIsReleasedOrObsolete:function(e){return null!=e&&(-1!==e.indexOf("RELEASED")||-1!==e.indexOf("OBSOLETE"))},setAuthoringMode:function(e){var t=widget.getValue("xArch_items_mode");if(t||(t={}),!e){var i=widget.getValue("previouslyOpenedItems");void 0!==i&&(e=(i=JSON.parse(i))[i.length-1])}e&&(t[e]||y.alertMessage("info",null,null,m.info_disabling_index_mode),t[e]=Date.now()),widget.setValue("xArch_items_mode",t)},isItemAuthored:function(){var e,t=widget.getValue("xArch_items_mode"),i=widget.getValue("previouslyOpenedItems");if(void 0!==i&&(e=(i=JSON.parse(i))[i.length-1]),t&&t[e]){var n=t[e];if(null!==n){if(Date.now()-parseInt(n,10)<1e3*parseInt(widget.getPreference(C.timeoutIndex).value,10))return!0;delete t[e]}}return!1},getUserWorkUnderPositionPref:function(){try{return widget.getPreference(C.workunderpos).value}catch(e){return null}},setCfgAuthoringContextDragEvent:function(e){e||(e=widget.body.getElement(".fl-cockpit-triptych-main-container")),!this.bubbleDragControl&&e&&(this.bubbleDragControl=new r.Move({container:e,delegate:"#BubbleContainer > *",centerHandles:!0,handles:function(e){return e.target.getClosest("#BubbleContainer")},stop:function(){var t=e.querySelector("#BubbleContainer");if(t){var i=t.style.top,n=t.style.left;widget.setValues({"bubble-top":i,"bubble-left":n})}}}))},unsetCfgAuthoringContextDragEvent:function(){if(this.bubbleDragControl){this.bubbleDragControl&&(this.bubbleDragControl.destroy(),this.bubbleDragControl=null);var e=widget.getElement(".fl-cockpit-triptych-main-container").querySelector("#BubbleContainer");if(e){var t=e.style.top,i=e.style.left;(t||i)&&e.setStyles({top:null,left:null})}widget.setValue("bubble-top",null),widget.setValue("bubble-left",null)}},getOpenWithCompatibleApps:function(t,i){if(t){var n=f.form3DXContent([t]);i&&(n.data.items[0].objectTaxonomies=i,n.data.items[0].objectTaxonomies.push(t.options.grid.actualType));var o=new h;return o.set3DXContent(n,!1),e.is(o.retrieveCompatibleApps,"function")?new Promise(function(t,i){e.is(o.retrieveCompatibleApps,"function")?o.retrieveCompatibleApps(function(e){t(e)}):t([])}):void 0}},formObjForEditProp:function(e,t){var i=[];if(0===e.length){var n=widget.getValue("currentOpenedItem");i.push({physicalid:n,rootPID:n,metatype:"businessobject"})}else e.forEach(function(e){e.options.instance&&e.options.instance.physicalid?i.push({physicalid:e.options.instance.physicalid,rootPID:e.getRoot().options.physicalid,metatype:"relationship"}):e.options.linkInfo&&e.options.linkInfo.objType&&t?i.push({physicalid:e.options.linkInfo.implementId,rootPID:e.getRoot().options.physicalid,metatype:"businessobject"}):e.options.physicalid&&i.push({physicalid:e.options.physicalid,rootPID:e.getRoot().options.physicalid,metatype:"businessobject"})});return i},downloadFile:function(e,t,i){var n="text/plain;charset=utf-8";if(i&&(t="\ufeff"+t),window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(new Blob([t],{type:n}),e);else if(document.queryCommandSupported("SaveAs")){var o=document.createElement("iframe");o.setAttribute("style","display:none;"),document.body.appendChild(o),o.contentWindow.document.open("text/html","replace"),o.contentWindow.document.write(t),o.contentWindow.document.close(),o.contentWindow.focus(),o.contentWindow.document.execCommand("SaveAs",!0,e),document.body.removeChild(o)}else{var r,s=window.document.createElement("a");"download"in s?(r=URL.createObjectURL(new Blob([t],{type:n})),s.setAttribute("download",e)):(r="data:"+n+","+encodeURIComponent(t),s.setAttribute("target","_blank"),s.setAttribute("download",e)),s.href=r,s.setAttribute("style","display:none;"),document.body.appendChild(s),setTimeout(function(){if(s.click)s.click();else if(document.createEvent){var e=document.createEvent("MouseEvents");e.initEvent("click",!0,!0),s.dispatchEvent(e)}document.body.removeChild(s)},0)}},convertToDoubleDigit:function(e){var t=e;return e<10&&(t="0"+e),t},validateTenant:function(e){var t=f.getTenant(),i=e.envId;return f.switchPlatform(i)?(y.alertMessage("info",null,m.info_platform_changed),!0):(y.alertMessage("error",null,m.replace(m.error_incorrect_platform,{displayName:e.displayName,tenant:t})),!1)},getUserCustomAttributes:function(e){return e?v.userAdditionalAttributesForPhysicalProduct:v.userAdditionalAttributes},getUserCustomAttributesCURI:function(){var e={bo:[],rel:[]},t=y.getUserCustomAttributes();return t&&t.forEach(function(t){t.bo&&!e.bo.includes(t.curi)?e.bo.push(t.curi):t.bo||e.rel.includes(t.curi)||e.rel.push(t.curi)}),e},createBatchServiceReqExecution:function(e,i,n,o,r){var s=e.length,a=this;if(0==s)return;o||(a.occNodesToExpand={});let l=widget.getValue(C.componentView);var c=Math.ceil(s/10),d=widget.getValue("currentConfig"),p=null;d&&d.filterCompiledForm&&(p=d.filterCompiledForm),require(["DS/CATFLCockpitWidget/utils/gridview.util.extended"],function(s){var d,g,m=[];a.bSubscImplLinksLoaded||u.getFLWebModelEventsObj("flcockpit-content-list-view").subscribe({event:"content-list-view-referenceLinks-loaded"},function(t){if(a.occNodesToExpand&&Object.keys(a.occNodesToExpand).length>0){let o=[];if(t.forEach(function(e){a.occNodesToExpand[e]&&(o=o.concat(a.occNodesToExpand[e]),delete a.occNodesToExpand[e])}),o.length>0){let t=a.expandNodesBasedonLevel.bind(a,e,i,n);a.occNodesToExpand&&0!==Object.keys(a.occNodesToExpand).length?s.addOccImplementLinksToNodesInBatch(o):s.addOccImplementLinksToNodesInBatch(o,t)}}}),async function(){for(var f=0;f<c;f++){d=10*f,g=e.slice(d,d+10),m.push(s.getExpandServicesForBatchCalls(g,p,o,i,n));await Promise.all(m).then(function(){g.forEach(function(e){e.options.noIndexOrDBExpand=!0,e.options.hasBeenExpanded=!0,n&&n.onPreExpand?e.preExpandDone():e.expand(),o||("-1"===i?e.options.dontExpandAllLvl=!0:"2"===i&&(e.options.dontExpandTwoLvl=!0))})});if(o&&r){if(l===C.structuredView){a.occNodesToExpand||(a.occNodesToExpand={});let e=[];g.forEach(function(t){let i=t.options.actualParent;i.options.implementLinks&&e.push(i.options.physicalid);let n=a.occNodesToExpand[i.options.physicalid]||[];n.push(t),a.occNodesToExpand[i.options.physicalid]=n}),a.actionPendingNodes||(a.actionPendingNodes={}),a.actionPendingNodes[r.options.physicalid]||(a.actionPendingNodes[r.options.physicalid]={node:r,level:i}),e.length>0&&u.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-referenceLinks-loaded",data:e})}else"-1"===i?r.expandAll():"2"===i&&r.expandNLevels({numberOfLevelsToExpand:"2"});t.unmask(n.collectionView.getContent())}else t.unmask(n.collectionView.getContent())}}()})},expandNodesBasedonLevel:function(e,t,i){let n=this;for(let e in n.actionPendingNodes){let t=n.actionPendingNodes[e].level,i=n.actionPendingNodes[e].node;"-1"===t?i.expandAll():"2"===t&&i.expandNLevels({numberOfLevelsToExpand:"2"}),delete n.actionPendingNodes[e]}},sortNodesIntoDBandIndex:function(e,t){let i,n={},o=[],r=[];return e&&e.length>0&&e.forEach(function(e){if(t){if(!(i=y.checkIfRecentlyAuthored(e.options.physicalid,!0))){let t=e.getOccurencePath();for(let e=0;e<t.length;e+=2)if(y.checkIfRecentlyAuthored(t[e],!0)){i=!0;break}}}else i=y.checkIfRecentlyAuthored(e.options.physicalid);i?o.push(e):r.push(e)}),n.databaseNodes=o,n.indexNodes=r,n},createComboBoxOnlyWithAuthorizedValues:function(e){var t=new l(e);return t.lastCorrectSelectedIndex=void 0,t._getMainElement().addEventListener("keydown",function(e){e.keyCode===c.TAB&&t._hidePopup(!0)}),t.addEventListener("change",function(e){-1===e.dsModel.selectedIndex&&(void 0!==t.lastCorrectSelectedIndex?t.selectedIndex=t.lastCorrectSelectedIndex:(t.value=void 0,t._getMainElement().value="",t._lastCustomEntry=""))}),t.addEventListener("preselectionChange",function(e){-1!==e.dsModel.selectedIndex&&(t.lastCorrectSelectedIndex=e.dsModel.selectedIndex)}),t},createReportStatusPanel:function(t,i){var n=new e.Element("div"),o=new a({displayStyle:"strip"});o.reorderFlag=!1,o.pinFlag=!0,o.showComboBoxFlag=!1,o.editableFlag=!1,o.multiSelFlag=!0,o.centeredFlag=!1,o.touchMode=!0;var r=0;function l(t,i,n){n&&n.length>0&&(t.add({label:i+" ("+n.length+")",content:function(t){for(var i=new e.Element("ul"),n=0,o=t.length;n<o;n++){var r=e.Element("div",{styles:{"white-space":"pre-line"}});r.textContent=t[n],i.appendChild(new e.Element("li").appendChild(r))}var s=new e.Element("div",{styles:{padding:"2px","word-wrap":"break-word"}});return s.appendChild(new e.Element("div").appendChild(i)),s}(n),isSelected:0===r,index:r}),r++)}return l(o,m.success_header,i.success),l(o,m.warning_header,i.warning),l(o,m.error_header,i.error),o.inject(n),new s({title:t,content:n,position:{my:"center",at:"center"},width:600,allowedDockAreas:0,immersiveFrame:widget.immersiveFrame,resizableFlag:!0,collapsibleFlag:!1,minWidth:600,minHeight:85})}};return y}),define("DS/CATFLCockpitWidget/utils/xhr.util",["DS/WAFData/WAFData","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n){"use strict";var o=t.getFullConfig(),r=o.webservices.getCSRFToken;return{get:function(e,t,i){return this.makeServiceCall(e,"GET",null,null,null,t)},post:function(e,t,i,n){return this.customTimeout=i,this.makeServiceCall(e,"POST",t,null,null,n)},patch:function(e,t){return this.makeServiceCall(e,"PATCH",t)},put:function(e,i,n,o){var r,s;return r=n?{method:"PUT",headers:n,data:i||null}:this.generateFetchOptions("PUT",!0,!0,!0,!1,i),s=o&&o.targetService?o.targetService:"3DSpace",r.targetService=s,e=t.getServiceURL(s)+e,this.buildAjaxCall(e,r,"PUT")},makeServiceCall:function(e,i,n,o,r,s){var a,l,c,d,u;a=!s||"boolean"!=typeof s.accept||s.accept,l=!s||"boolean"!=typeof s.content||s.content,c=!s||"boolean"!=typeof s.secCtx||s.secCtx,d=!s||"boolean"!=typeof s.authoringCtx||s.authoringCtx,s&&"number"==typeof s.timeout&&(this.customTimeout=s.timeout);var p=r?this.generateFetchOptions("POST",!1,!0,!0,!0,n):this.generateFetchOptions(i,a,l,c,d,n),g="",m=!1;return window.location.href.indexOf("createLogicalReferencesFromDiagram.html")>-1||window.location.href.indexOf("setArchitectureNumberOnPSpool.html")>-1?(g=window.location.href.substring(0,window.location.href.indexOf("/webapps")),m=!0):(u=s&&s.targetService?s.targetService:r?"3DSearch":"3DSpace",g=t.getServiceURL(u)),(p=r?this.generateFetchOptions("POST",!1,!0,!0,!0,n):this.generateFetchOptions(i,a,l,c,d,n,m)).targetService=u,s&&s.responseType&&(p.responseType=s.responseType),e=r?t.getServiceURL("3DSearch")+"/search":g+e,this.buildAjaxCall(e,p,i,o)},makeMultipleServiceCalls:function(e,t){var i=this;if(t)return UWA.Promise.all(e);var n=e.map(function(e){return i.makeServiceCall(e.url,e.method,e.data,e.noCSRF,e.isIndexCall)});return UWA.Promise.all(n)},generateFetchOptions:function(e,i,n,o,r,s,a){var l={};l["Accept-Language"]=widget.lang,i&&(l.Accept="application/json"),n&&(l["Content-Type"]="application/json"),o&&(l.SecurityContext=t.getSecurityContext());var c=t.getAuthorizedWorkUnder(a);return r&&c&&"GET"!==e&&Object.assign(l,c),{method:e,headers:l,data:s||null}},buildAjaxCall:function(e,i,n,o){var s=this;return o||"POST"!==n&&"PATCH"!==n&&"DELETE"!==n?s.createPromiseFunction(e,i):window.location.href.indexOf("createLogicalReferencesFromDiagram.html")>-1||window.location.href.indexOf("setArchitectureNumberOnPSpool.html")>-1?s.get(r).then(function(t){return i.headers.ENO_CSRF_TOKEN=JSON.parse(t).csrf.value,s.get("/resources/pno/person/getsecuritycontext").then(function(t){return i.headers.SecurityContext=JSON.parse(t).SecurityContext,s.createPromiseFunction(e,i)})}):(i.headers.ENO_CSRF_TOKEN=t.getCSRFToken(),s.createPromiseFunction(e,i))},createPromiseFunction:function(r,s){var a=this;return new Promise(function(l,c){Number.isInteger(a.customTimeout)&&(s.timeout=a.customTimeout),s.onComplete=l,s.onFailure=function(e,t,i){try{t=JSON.parse(t)}catch(e){t={}}c({error:e,errorResp:t})},s.onTimeout=function(e){i.alertMessage("error","",n.error_request_timedOut),c({error:e})},o.identifiers.tenant_based_services.indexOf(s.targetService)>=0&&(r.indexOf("?")>=0?r+="&tenant="+t.getTenant():r+="?tenant="+t.getTenant()),e.authenticatedRequest(r,s)})}}}),define("DS/CATFLCockpitWidget/services/common.service",["DS/PlatformAPI/PlatformAPI","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s){"use strict";var a=i.getFullConfig();r=JSON.parse(r);return{getItemInfo:function(e){var i=a.webservices.getItemInfo+a.webservices.getConfigInfoMask;return t.post(i,JSON.stringify(e),0).then(function(e){return JSON.parse(e)})},applyWorkUnderEvolution:function(n,r){var s=n.model,l=n.modelVer;s.physicalid&&l.physicalid||reject(new Error("invalid input"));var c=a.webservices.evolutionExpr.url,d=a.webservices.evolutionExpr.xmlExpr;d=(d=(d=(d=(d=d.replace(new RegExp("{modelName}","g"),s.name)).replace(new RegExp("{productName}","g"),l.backEndName)).replace(new RegExp("{productRevision}","g"),l.revision)).replace(new RegExp("{productTitle}","g"),l.name)).replace(new RegExp("{modelTitle}","g"),s.name);var u={"Dictionary Contexts":s.physicalid,"Evolution Expression":d};if(r){return t.post(c,JSON.stringify(u)).then(function(e){if(null!=(e=JSON.parse(e)).ACId&&""!=e.ACId&&null!=e.XSLTExpr&&""!=e.XSLTExpr)return i.setAuthIDforWIW("evolution",e.ACId),"Success"}).catch(function(e){console.error(e)})}t.post(c,JSON.stringify(u)).then(function(t){if(null!=(t=JSON.parse(t)).ACId&&""!=t.ACId&&null!=t.XSLTExpr&&""!=t.XSLTExpr){var i=o.get();i.evolution.id=t.ACId,i.evolution.displayExpression=t.XSLTExpr,o.setEffectivity(i),e.publish("sessionEff",i),e.publish("toggleActiveSE")}}).catch(function(e){console.error(e)})},getUserPreferences:function(e){var i=a.webservices.getUserPreferences;i=i+"?name="+e;return t.get(i,{secCtx:!1,targetService:"3DCompass"}).then(function(e){var t={};return e&&""!==e&&(t=JSON.parse(e)),t}).catch(function(e){n.displayError(e,null,null,s.error_get_user_pref)})},setUserPreferences:function(e){var i=a.webservices.setUserPreferences,o={};e&&(o=e);return t.put(i,o,{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},{targetService:"3DCompass"}).then(function(e){return JSON.parse(e)}).catch(function(e){n.displayError(e,null,null,s.error_set_user_pref)})},getKindOfRFLP:function(e){var i=a.webservices.getItemInfo+a.webservices.isKindOfFetchField;return t.post(i,JSON.stringify(e)).then(function(e){var t=[];return e&&(e=UWA.is(e,"string")?JSON.parse(e):e).member&&e.member[0]&&e.member[0].kindOfRFLP&&e.member.forEach(function(e,i){t.push(e.kindOfRFLP)}),t})},getVisualCues:function(){var e=a.webservices.getVisualCues;return t.post(e,JSON.stringify({})).then(function(e){return JSON.parse(e)}).catch(function(e){})},exportVisualCues:function(e,i){var o=a.webservices.exportConvergenceCues;return this.getUserPreferences(r.user_pref_cues).then(function(r){var a=r.cues_state,l=r.combined_state;if(a&&Object.keys(a).length>0){var c=Object.values(a),d={};if(l&&l.active){for(var u in l.combinedCues)l.combinedCues[u]=l.combinedCues[u];d={isCombinedConvergenceActivated:!0,combinedConvergenceOperator:l.operator,combinedConvergenceDefinition:l.combinedCues}}else d.isCombinedConvergenceActivated=!1;var p={cueInfo:c,instanceIds:e,occurrenceInfo:i,combinedConvergenceInfo:d};return t.post(o,JSON.stringify(p),0,{responseType:"arraybuffer"}).then(function(e,t){var i=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,"}),o=document.createElement("a");o.href=URL.createObjectURL(i);var r=new Date,a=n.convertToDoubleDigit(r.getMonth()+1),l=n.convertToDoubleDigit(r.getDate()),c=n.convertToDoubleDigit(r.getHours()),d=n.convertToDoubleDigit(r.getMinutes()),u=n.convertToDoubleDigit(r.getSeconds()),p=a+"_"+l+"_"+r.getFullYear()+"_"+c+"_"+d+"_"+u;o.download=s.label_export_cues_filename+"_"+p+".xlsx",o.click(),URL.revokeObjectURL(o.href),o.remove(),n.alertMessage("success",null,s.msg_cue_export_success)}).catch(function(e){return n.displayError(e,null,null,s.error_export_cues_failed),Promise.reject()})}n.alertMessage("error",null,s.msg_userPref_cues)})},validateVisualCues:function(e,i){var o=a.webservices.validateVisualCues;return this.getUserPreferences(r.user_pref_cues).then(function(r){var a=r.cues_state,l=r.combined_state;if(a&&Object.keys(a).length>0){var c=Object.values(a),d={};if(l&&l.active){for(var u in l.combinedCues)l.combinedCues[u]=l.combinedCues[u];d={isCombinedConvergenceActivated:!0,combinedConvergenceOperator:l.operator,combinedConvergenceDefinition:l.combinedCues}}else d.isCombinedConvergenceActivated=!1;var p={cueInfo:c,instanceIds:e,occurrenceInfo:i,combinedConvergenceInfo:d};return t.post(o,JSON.stringify(p),0).then(function(e){return JSON.parse(e)})}n.alertMessage("error",null,s.msg_userPref_cues)})},getCuesReportOnInstance:function(e,i,o){var r=a.webservices.cuesReportOnInst,l={cueInfo:e,instanceId:i,occurrenceInfo:o};return t.post(r,JSON.stringify(l),0).then(function(e){return JSON.parse(e)}).catch(function(e){return n.displayError(e,null,null,s.msg_generic_error_get_failed),Promise.reject()})},getParameterizationSetting:function(e){var i=a.webservices.getParameterizationSetting;return t.post(i,JSON.stringify(e)).then(function(e){return JSON.parse(e)}).catch(function(e){return n.displayError(e,null,null,s.msg_generic_error_get_failed),Promise.reject()})},getTypeSchemaDetails:function(e){var i=a.webservices.getTypeSchemaDetails;return t.post(i,JSON.stringify(e)).then(function(e){return JSON.parse(e)}).catch(function(e){return n.displayError(e,null,null,s.msg_generic_error_get_failed),Promise.reject()})},getExtensionsForClass:function(e){return t.post(a.webservices.getExtensionsForClass,JSON.stringify({class:e})).then(function(e){return JSON.parse(e).results}).catch(function(e){return n.displayError(e,null,null,s.error_get_extensions),[]})},getPredicateValues:function(e){var i=a.webservices.predicateValue;return t.post(i,JSON.stringify(e)).then(function(e){return JSON.parse(e)}).catch(function(e){})},getTypeHierarchy:function(e){let i;return a._typeHierarchies||(a._typeHierarchies={}),a._typeHierarchies[e]&&(i=a._typeHierarchies[e]),new Promise(function(n,o){if(i)return void n(i);let r={types:[e]};var s=a.webservices.getTypeHierarchy;return t.post(s,JSON.stringify(r)).then(function(e){e=JSON.parse(e),a._typeHierarchies[e.types_hierarchies[0].type]=e.types_hierarchies[0].hierarchy,n(e.types_hierarchies[0].hierarchy)}).catch(function(e){n([])})})}}}),define("DS/CATFLCockpitWidget/services/model.service",["DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/WAFData/WAFData","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r){var s=e.getFullConfig();return{getModelPIDFromLogicalReference:function(e){return i.get(s.webservices.dsfl_getLogItem+e+"/model").then(function(e){var t=JSON.parse(e);if(void 0!==t.rootObjects){var i=t.rootObjects[0],n={};return i.attributes.forEach(function(e){void 0!==e.value&&(n[e.name]=e.value)}),i.attributes=n,i}return null}).catch(function(e){var i=e.error.message.slice(e.error.message.indexOf("ResponseCode")),n=r.error_get_model;i&&i.indexOf("404")>=0&&(n=r.error_get_model_media),t.displayError(e,null,null,n)})},getModelVersionFromModelPID:function(t){let i=this,o=t.name,r=t.physicalid?t.physicalid:t.id;window.location.href.indexOf("createLogicalReferencesFromDiagram.html")>-1?(host=window.location.href.substring(0,window.location.href.indexOf("/webapps")),isWIWcall=!0):host=e.getServiceURL("3DSpace");var s=host+"/resources/modeler/browsing/browseservice/pid:"+r+"/configurationdictionary?products=1&attributes=1&tenant="+e.getTenant(),a=new FormData;let l={filterExpression:'<?xml version="1.0" encoding="UTF-8"?><CfgFilterExpression xmlns="urn:com:dassault_systemes:config" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:com:dassault_systemes:config CfgFilterExpression.xsd"><FilterSelection SelectionMode="Strict"><Context xmlns="urn:com:dassault_systemes:config" HolderType="Model" HolderName="'+o+'"/></FilterSelection></CfgFilterExpression>'};return a.append("evolutionExpression",JSON.stringify(l)),new Promise(function(t,o){var r={method:"POST",headers:{SecurityContext:e.getSecurityContext()||"","Accept-Language":widget.lang},data:a,onComplete:function(e){var n=JSON.parse(e).products,o=[];Object.keys(n).length>0&&(n.created=new Date(n.originated).getTime(),o.push(n)),i._addNextRevisionAndOrBranchToModelVersionsList(o,n),o=o.sort(function(e,t){return e.created>t.created?1:e.created<t.created?-1:0}),t(o)},onFailure:o,onTimeout:o};n.authenticatedRequest(s,r)})},_addNextRevisionAndOrBranchToModelVersionsList:function(e,t){if(t["Main Derived"]&&void 0!==t["Main Derived"].id&&(t["Main Derived"].created=new Date(t["Main Derived"].originated).getTime(),e.push(t["Main Derived"]),this._addNextRevisionAndOrBranchToModelVersionsList(e,t["Main Derived"])),t.Derived&&t.Derived.length>0)for(var i=0;i<t.Derived.length;i++)t.Derived[i].created=new Date(t.Derived[i].originated).getTime(),e.push(t.Derived[i]),this._addNextRevisionAndOrBranchToModelVersionsList(e,t.Derived[i])},getProductConfigurationsFromModelVersion:function(e,t){var n="/resources/modeler/browsing/model/"+e+'/getproductconfigurations?filteringCriteria={"version": "1.0.0", "input": {"status": "0","basics": "to[Product Configuration].from.attribute[Marketing Name],to[Product Configuration].from.revision","attributes": "FilterCompiledForm","productPIDs":"'+t+'"}}';return i.get(encodeURI(n)).then(function(e){return JSON.parse(e).productconfigurations})},createVolatileFilter:function(e){var t=s.webservices.getVolatileFilter,n='<CfgFilterExpression xs:schemaLocation = "urn:com:dassault_systemes:config CfgFilterExpression.xsd" xmlns:xs = "http://www.w3.org/2001/XMLSchema-instance" xmlns = "urn:com:dassault_systemes:config"><FilterSelection SelectionMode="150%" SelectionView="'+widget.getValue("evolutionView")+'"><TreeSeries Type = "ProductState" Name = "'+e.modelName+'"><Single Name = "'+e.modelVerName+'" Revision = "'+e.modelVerRev+'"/></TreeSeries></FilterSelection></CfgFilterExpression>';return i.post(t,JSON.stringify({version:"1.2",output:{targetFormat:"TXT"},expression:{version:"0.1",format:"xml",content:n},dictionary:{version:"0.1",id:{pid:e.modelID}}})).then(function(e){return JSON.parse(e)})},getConfigContextInfo:function(e){var n=s.webservices.getConfigContextInfo,o={version:"1.0",modelMask:"Read",enabledCriteria:"NO",cfgCtxt:"YES",pidList:e};return i.post(n,JSON.stringify(o),0).then(function(e){return JSON.parse(e)}).catch(function(e){t.alertMessage("error",null,r.error_get_config_ctx)})},getEffectivityInfo:function(e,t){var n=s.webservices.getEffectivityInfo,r={version:"1.3",output:{targetFormat:t||"TXT",withDescription:"YES",view:"ALL",domains:"ALL"},pidList:e},a=null;return"function"==typeof o.getConfigurationRevisionDetails&&(a=o.getConfigurationRevisionDetails().configurationRevision),a&&a.configRevision&&(r.configurationRev=a.configRevision[0].id),i.post(n,JSON.stringify(r),0).then(function(e){return JSON.parse(e).expressions}).catch(function(e){})},setMultipleFilterableObjectInfo:function(e,n){var o=s.webservices.setMultipleFilterableObjectInfo;let a={version:"1.2",expression:{output:{targetFormat:"TXT",withDescription:"YES",view:"All",domains:"All"},contentFormat:"XML",expressionList:e,dictionary:{version:"0.1",idList:n,format:"xml"}}};return i.post(o,JSON.stringify(a),0).then(function(e){return JSON.parse(e)}).catch(function(e){let i=e.errorResp?e.errorResp.errorMessage:r.error_wiw_copy_eff;t.alertMessage("error",r.error_wiw_title_copy_eff,i)})},filterModelVersionValidation:function(e,t,n){var o=[];n=n||!1,t.forEach(function(e,t){var i;i=n?[{name:"physicalId ",value:e.physicalId},{name:"V_CompiledExpression",value:e.compiledExpression}]:[{name:"physicalId ",value:e.physicalId}],o.push({path:[{attributes:i}]})});var r=s.webservices.getFilterValidation;return i.post(r,JSON.stringify({version:"1.0",detailedResults:"No",filter:{format:"bin",value:e},occurrences:{ApplyMasterComposition:"no",withBinaries:n?"yes":"no",paths:o}}),0).then(function(e){if(parsedResult=JSON.parse(e),"SUCCEEDED"===parsedResult.occurrences.status){var t=[];return parsedResult.occurrences.paths.forEach(function(e,i){t.push({status:e.status,PIDInstance:e.path[0].pid})}),t}return Promise.reject(new Error("Service_failed"))}).catch(function(e){return Promise.reject(new Error("Service_failed"))})},allFilterModelVersionsValidation:function(e,t,n){var o=[],r=this;if(o=(n=n||!1)?e.map(function(e){return{physicalId:e.options.instance.physicalid,compiledExpression:e.options.instance.effectivitycompiledform}}):e.map(function(e){return{physicalId:e.options.instance.physicalid}}),t)return r.getModelVersionFromModelPID(t).then(function(s){if(s.length<1)return Promise.reject(new Error("No_ModelVersions"));var a=[];return s.forEach(function(e,i){a.push(r.createVolatileFilter({modelID:t.physicalid,modelName:t.name,modelVerName:e.name,modelVerRev:e.revision}))}),i.makeMultipleServiceCalls(a,!0).then(function(t){var a=[];return t.forEach(function(e,t){a.push(r.filterModelVersionValidation(e.filterBinaryForExpand,o,n))}),i.makeMultipleServiceCalls(a,!0).then(function(t){var i=[];return t.forEach(function(t,n){var o=[];t.forEach(function(t,i){o.push({filterValidationStatus:t.status,nodeInstance:e[i]})}),i.push({modelversion:s[n],instances:o})}),i})})})}}}),define("DS/CATFLCockpitWidget/components/ModelPCSelector/configurationSelector",["DS/UIKIT/Modal","DS/UIKIT/Input/Button","DS/Handlebars/Handlebars4","DS/UIKIT/Autocomplete","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/utils/search.util","UWA/Core","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/common.util","text!DS/CATFLCockpitWidget/components/ModelPCSelector/modelPCSelector.html","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,g){var m="MODELVERSION",f="PC",h=JSON.parse(p);return{setActiveModel:function(e){this.configDetails.model=e},setActiveModelVersion:function(e){this.configDetails.modelVersion=e},setActiveProductConfig:function(e){this.configDetails.productConfiguration=e},getActiveModel:function(){return this.configDetails.model},getActiveModelVersion:function(e){return this.configDetails.modelVersion},getActiveProdConfig:function(){return this.configDetails.productConfiguration},init:function(t,i,o,a,l){var c,d=this;d.itemID=i,d.configDetails={model:{},modelVersion:{},productConfiguration:{}},d.configurationType=t,o&&(Array.isArray(o)&&o.length>0?d.allModels=o:d.setActiveModel({physicalid:o.physicalid?o.physicalid:o.id,name:o.name,revision:o.revision,objId:o.id})),a&&d.setActiveModelVersion({physicalid:a.physicalid?a.physicalid:a.id,name:a.name,revision:a.revision,current:a.current,backEndName:a.backEndName}),l&&d.setActiveProductConfig({physicalid:l.physicalid?l.physicalid:l.id,name:l.name,filterCompiledForm:l.filterCompiledForm,objId:l.id}),d.modalWindow&&d.modalWindow.destroy(),s.configureSearch();var u=d.getModalContent();d.modalWindow=new e({className:"modelPCSelector",escapeToClose:u.escapeToClose,closable:u.closable,header:u.header,body:u.content,footer:u.footer});var p=d.modalWindow.getContent().getElement("#modelVersionRow"),m=d.modalWindow.getContent().getElement("#productConfRow"),h=d.getActiveModel(),v=d.getActiveModelVersion(),C=d.getActiveProdConfig();if(p){var b=p.getElement(".autoCompleteContainer"),y=p.getElement(".searchContainer");b&&(c=v.physicalid,d.modVerAutoComplete=new n({showSuggestsOnFocus:!0,placeholder:u.modverPlaceholder,minLengthBeforeSearch:3,events:{onSelect:function(e){var t=e.physicalid?e.physicalid:e.modelVersionID;t.indexOf("pid")>=0&&(t=t.substring(4)),t!==c?d.submitButton.enable():d.submitButton.disable(),e.model&&d.setActiveModel({physicalid:e.model.physicalid?e.model.physicalid:e.model.id,name:e.model.name,objId:e.model.id?e.model.id:e.model.objId}),d.setActiveModelVersion({physicalid:t,name:e.name?e.name:e.modelVersionName,revision:e.revision,backEndName:e.backEndName,current:e.current})},onUnselect:function(){this.selectedItems&&0===this.selectedItems.length&&(c?d.submitButton.enable():d.submitButton.disable(),d.setActiveModelVersion({physicalid:null,name:null,revision:null,backEndName:null,current:null}))}}}),d.formAutocomplMVDataset(),d.modVerAutoComplete.inject(b)),y&&(y.onclick=d.searchModVer.bind(d))}if(m){var _=m.getElement(".autoCompleteContainer"),D=m.getElement(".searchContainer");_&&(d.pcAutoComplete=new n({showSuggestsOnFocus:!0,placeholder:g.ph_header_config_pc,minLengthBeforeSearch:3,events:{onSelect:function(e){e.physicalid.indexOf("pid")>=0&&(e.physicalid=e.physicalid.substring(4)),d.setActiveProductConfig({physicalid:e.physicalid?e.physicalid:e.id,name:e.name,label:e.label,filterCompiledForm:e.attributes.FilterCompiledForm})},onUnselect:function(){this.selectedItems&&0===this.selectedItems.length&&d.setActiveProductConfig({physicalid:null,name:null,filterCompiledForm:null})}}}),d.pcAutoComplete.inject(_),d.configurationType===f&&r.getProductConfigurationsFromModelVersion(h.physicalid,v.physicalid).then(function(e){d._cleanAutocompleteDatasets(d.pcAutoComplete),e.forEach(function(e){e.value=e.marketingName,e.physicalid=e.id}),d.pcAutoComplete.addDataset({name:"product_configuration_select_data",items:e}),C.physicalid&&d._retrieveItemInProductConfigurationDataset(C.physicalid)})),D&&(D.onclick=d.searchPC.bind(d))}return d.modalWindow},getModalContent:function(){var e=this,n=e.configurationType,o={closable:!0,escapeToClose:!0,header:"",content:"",footer:[]},r=i.compile(u),s={};return e.submitButton=new t({id:"configurationSubmit",value:g.confirmation_button,className:"primary",events:{onClick:e.onSubmitCallback.bind(e)},disabled:!1}),o.footer.push(e.submitButton),e.cancelButton=new t({id:"configurationCancel",value:g.cancel_button,events:{onClick:function(){e.modalWindow.destroy()}}}),n===m?(o.header=g.header_config_modver,o.modverPlaceholder=g.ph_header_config_modver,s.rows=[{rowId:"modelVersionRow"}],s.modal_title="",e.submitButton.disable(),o.footer.push(e.cancelButton)):n===f&&(o.header=g.header_config_pc,s.rows=[{rowId:"productConfRow"}],s.modal_title="",o.footer.push(e.cancelButton)),o.content=r(s),o},onSubmitCallback:function(){var e=this.configurationType,t=this.getActiveModel(),i=this.getActiveModelVersion(),n=this.getActiveProdConfig(),o=c.getFLWebModelEventsObj("flweb-model-events");i.physicalid?n.physicalid?o.publish({event:"mod-PC-selection-successful",data:{itemID:this.itemID,model:t,modelVer:i,pc:n,filterCompiledForm:n.filterCompiledForm}}):this.publishSelectedModVer():e===m&&(d.alertMessage("success",null,g.attachedConfigurationFilterRemoved),o.publish({event:"allmod-selection-successful",data:{itemID:this.itemID}})),this.modalWindow.destroy()},searchModVer:function(){var e=this,t=(e.configurationType,{searchTitle:g.label_search_modelVer,allowedTypes:h.type_products,role:"",criteria:"",bMultiSel:!1,in_apps_callback:function(t){e._retrieveItemInModelVersionDataset("pid:"+t[0].id)}});if(e.allModels){var i="";e.allModels.forEach(function(e){var t=e.id;i+='[BASED_ON_MODEL]:"'+t+'" OR '}),t.additionalQuery="("+i.substring(0,i.length-4)+")"}else e.getActiveModel()&&e.getActiveModel().objId&&(t.additionalQuery='[BASED_ON_MODEL]:"'+e.getActiveModel().objId+'"');s.launchSearch(t)},searchPC:function(){var e=this,t=e.getActiveModelVersion().physicalid,i=(e.configurationType,{searchTitle:g.label_search_pc,allowedTypes:h.type_productConfiguration,role:"",criteria:"",bMultiSel:!1,additionalQuery:'[BASED_ON_MODEL_VERSION_PID]:"'+t+'"'});null!==t?(i.in_apps_callback=function(t){e._retrieveItemInProductConfigurationDataset("pid:"+t[0].id)},s.launchSearch(i)):d.alertMessage("error",null,"Please select Model Version","")},_cleanAutocompleteDatasets:function(e){e&&e.datasets.forEach(function(t){e.removeDataset(t.id)})},_retrieveItemInModelVersionDataset:function(e){var t=this;e&&e.indexOf("pid")>=0&&(e=e.substring(4)),t.modVerAutoComplete.datasets.forEach(function(i){i.items.forEach(function(i){if(i.modelVersionID.indexOf("pid")>=0&&(i.modelVersionID=i.modelVersionID.substring(4)),i.modelVersionID===e)return t.modVerAutoComplete.onSelect(i),void t.modVerAutoComplete.dispatchEvent("onSelect",[i])})})},_retrieveItemInProductConfigurationDataset:function(e){var t=this;e&&e.indexOf("pid")>=0&&(e=e.substring(4)),t.pcAutoComplete.datasets.forEach(function(i){i.items.forEach(function(i){if(i.physicalid.indexOf("pid")>=0&&(i.physicalid=i.physicalid.substring(4)),i.physicalid===e)return t.pcAutoComplete.onSelect(i),void t.pcAutoComplete.dispatchEvent("onSelect",[i])})})},publishSelectedModVer:function(){var e=this,t=e.getActiveModel(),i=e.getActiveModelVersion(),n=(e.getActiveProdConfig(),c.getFLWebModelEventsObj("flweb-model-events"));r.createVolatileFilter({modelID:t.physicalid,modelName:t.name,modelVerName:i.backEndName,modelVerRev:i.revision}).then(function(o){n.publish({event:"mod-PC-selection-successful",data:{itemID:e.itemID,model:t,modelVer:i,pc:null,filterCompiledForm:o.filterBinaryForExpand}})})},formAutocomplMVDataset:function(){var e=this,t=[],i=e.getActiveModel(),n=e.getActiveModelVersion();e.allModels?e.allModels.forEach(function(e){e.physicalid?e.physicalid:e.id,t.push(r.getModelVersionFromModelPID(e))}):i.physicalid&&t.push(r.getModelVersionFromModelPID(i)),l.makeMultipleServiceCalls(t,!0).then(function(t){var o,r=[];t.forEach(function(t,n){e.allModels?o=e.allModels[n]:i.physicalid&&(o=i),t.forEach(function(e){r.push({modelVersionID:e.id,modelVersionName:e.attributes.MarketingName,revision:e.revision,current:e.current,value:e.attributes.MarketingName+" "+e.revision,subLabel:e.current_NLS,backEndName:e.name,model:o})})}),e.modVerAutoComplete.addDataset({name:"model_version_select_data",items:r}),n.physicalid&&e._retrieveItemInModelVersionDataset(n.physicalid)})}}}),define("DS/CATFLCockpitWidget/utils/contextManager.util",["UWA/Class","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util"],function(e,t,i){"use strict";return e.singleton({_selectedItems:[],getContext:function(e){return this.treeDocument=e,this.elements={container:widget.body},this.displayNotification=function(e){"error"===e.eventID?t.alertMessage("error",null,e.msg||e):"warning"===e.eventID?t.alertMessage("error",null,e.msg||e):t.alertMessage("success",null,e.msg||e)},this},init:function(e){this.options={widget:widget},this._parent(e)},addSelection:function(e){var t=this;UWA.is(e,"array")?e.forEach(function(e){t._selectedItems.push(e)}):(e.object="",this._selectedItems.push(e))},setBIFilter:function(e){this._biFilter=e,this.isIndexMode=function(){return!0}},isRoot:function(e){return e.isRoot()},getRoots:function(){return this.treeDocument.getRoots()},getChildren:function(e){return e.getChildren()||[]},getRelationID:function(e){return e.options.instance?e.options.instance.physicalid:null},getReference:function(e){return e.getID()},getParent:function(e){var t=e.getParent();return null!=t&&void 0!==t&&t.isVirtual&&t.isVirtual()&&(t=t.getParent()),t},getType:function(e){return e.getType()},getName:function(e){return e.getLabel()},getSelectedNodes:function(){return this._selectedItems},author:function(){return!0},resetSelection:function(){this._selectedItems=[],this._biFilter=null,this.isIndexMode=null},getSecurityContext:function(){return{SecurityContext:"ctx::"+i.getSecurityContext()}},getSetting:function(e){var t=null;switch(e){case"tenant":t=i.getTenant();break;case"securityContext":t=i.getSecurityContext()}return t}})}),define("DS/CATFLCockpitWidget/components/CommandsCtrl/PasteEvolutionEffectivityCmd",["DS/CfgEffectivityCommands/commands/CfgPasteEvolutionEffectivityCmd","DS/CATFLCockpitWidget/utils/contextManager.util"],function(e,t){"use strict";return e.extend({getData:function(){var e=t.getSelectedNodes(),i=[],n=[];return e.forEach(function(e){i.push({id:e.getID(),alias:e.getLabel(),isRoot:!1,VPMRef:e.getType(),parentID:e.getParent().getID(),parentalias:e.getParent().getLabel()}),n.push(e._attributes.nodeModel)}),{selectedNodes:i,nodes:e,padNodes:n}}})}),define("DS/CATFLCockpitWidget/components/CommandsCtrl/ExtendEvolutionEffectivityCmd",["DS/CfgEffectivityCommands/commands/CfgExtendEvolutionEffectivityCmd","DS/CATFLCockpitWidget/utils/contextManager.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util"],function(e,t,i,n){"use strict";return e.extend({init:function(e){var t=e||{};this._parent(t,{mode:"exclusive",isAsynchronous:!0})},getData:function(){var e=t.getSelectedNodes(),i=[];return e.forEach(function(e){i.push({id:e.getID(),alias:e.getLabel(),isRoot:!1,VPMRef:e.getType(),parentID:e.getParent().getID(),parentalias:e.getParent().getLabel()})}),{selectedNodes:i,nodes:e}}})}),define("DS/CATFLCockpitWidget/components/CommandsCtrl/CopyEvolutionEffectivityCmd",["DS/CfgEffectivityCommands/commands/CfgCopyEvolutionEffectivityCmd","DS/CATFLCockpitWidget/utils/contextManager.util"],function(e,t){"use strict";return e.extend({getData:function(){var e=t.getSelectedNodes(),i=[];return e.forEach(function(e){i.push({id:e.getID(),alias:e.getLabel(),isRoot:!1,VPMRef:e.getType(),parentID:e.getParent().getID(),parentalias:e.getParent().getLabel()})}),{selectedNodes:i,nodes:e}}})}),define("DS/CATFLCockpitWidget/components/CommandsCtrl/AddToConfigurationRevisionCmd",["DS/CfgEffectivityCommands/commands/CfgAddToConfigurationRevisionCmd","DS/CATFLCockpitWidget/utils/contextManager.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o){"use strict";return e.extend({init:function(e){var t=e||{};this._parent(t,{mode:"exclusive",isAsynchronous:!0})},getData:function(){var e=t.getSelectedNodes(),i=[];return e.forEach(function(e){i.push({id:e.getID(),alias:e.getLabel(),isRoot:!1,VPMRef:e.getType(),parentID:e.getParent().getID(),parentalias:e.getParent().getLabel()})}),{selectedNodes:i,nodes:e}}})}),define("DS/CATFLCockpitWidget/components/CommandsCtrl/PasteVariantEffectivityCmd",["DS/CfgEffectivityCommands/commands/CfgPasteEffectivityCmd","DS/CATFLCockpitWidget/utils/contextManager.util"],function(e,t){"use strict";return e.extend({getData:function(){var e=t.getSelectedNodes(),i=[],n=[];return e.forEach(function(e){i.push({id:e.getID(),alias:e.getLabel(),isRoot:!1,VPMRef:e.getType(),parentID:e.getParent().getID(),parentalias:e.getParent().getLabel()}),n.push(e._attributes.nodeModel)}),{selectedNodes:i,nodes:e,padNodes:n}}})}),define("DS/CATFLCockpitWidget/components/CommandsCtrl/EditEvolutionEffectivityCmd",["DS/CfgEffectivityCommands/commands/CfgEvolutionCmd","DS/CATFLCockpitWidget/utils/contextManager.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o){"use strict";return e.extend({init:function(e){var t=e||{};this._parent(t,{mode:"exclusive",isAsynchronous:!0})},getData:function(){var e=t.getSelectedNodes()[0];return{selectedNodes:[{id:e.getID(),alias:e.getLabel(),isRoot:!1,VPMRef:e.getType(),parentID:e.getParent().getID(),parentalias:e.getParent().getLabel()}],nodes:e}}})}),define("DS/CATFLCockpitWidget/components/CommandsCtrl/EditVariantEffectivityCmd",["DS/CfgEffectivityCommands/commands/CfgVariantEffectivityCmd","DS/CATFLCockpitWidget/utils/contextManager.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o){"use strict";return e.extend({init:function(e){var t=e||{};this._parent(t,{mode:"exclusive",isAsynchronous:!0})},getData:function(){var e=t.getSelectedNodes()[0];return{selectedNodes:[{id:e.getID(),alias:e.getLabel(),isRoot:!1,VPMRef:e.getType(),parentID:e.getParent().getID(),parentalias:e.getParent().getLabel()}],nodes:e}}})}),define("DS/CATFLCockpitWidget/commands/CATFLNextGenFilterCmd",["DS/ENONextGenFilterCmd/commands/ENONextGenFilterCmd","DS/CATFLCockpitWidget/utils/contextManager.util"],function(e,t){"use strict";return e.extend({init:function(e){this.name=e.ID,this.viewController=e.viewController,e.context?this.context=t.getContext():this.context=e.context,this._parent(e)},getAppParams:function(){return{widgetId:widget.id,appId:widget.id}},getSelectorManager:function(){return this.viewController.contentView.getTreeDocument().getXSO()||null},getRoots:function(){var e=this.viewController.contentView.getTreeDocument().getRoots()[0];return[{id:e.getID(),filtered:0,Label:e.getLabel()}]},getSelection:function(){var e={path:[],label:[]},t=[],i=this.viewController.contentView.getTreeDocument().getRoots()[0];if(i&&(t=[i]),t.forEach(function(t){e.path.push([t.getID()]),e.label.push([t.getLabel()])}),this.viewController.contentView.getTreeDocument().getSelectedNodes()){var n=this.viewController.contentView.getTreeDocument().getSelectedNodes();n.length>=1&&n[0].getID()!==t[0].getID()&&n.forEach(function(t){e.path.push(t.getOccurencePath()),e.label.push([t.getLabel()])})}return e}})}),define("DS/CATFLCockpitWidget/components/CommandsCtrl/EditConfigurationContextCmd",["DS/CfgConfigurationCommands/commands/CfgEditConfigurationContextCmd","DS/CATFLCockpitWidget/utils/contextManager.util"],function(e,t){"use strict";return e.extend({getData:function(){var e=t.getSelectedNodes(),i=[];return e.forEach(function(e){i.push({id:e.getID(),alias:e.getLabel()})}),{selectedNodes:i}}})}),define("DS/CATFLCockpitWidget/components/CommandsCtrl/CopyVariantEffectivityCmd",["DS/CfgEffectivityCommands/commands/CfgCopyEffectivityCmd","DS/CATFLCockpitWidget/utils/contextManager.util"],function(e,t){"use strict";return e.extend({getData:function(){var e=t.getSelectedNodes(),i=[];return e.forEach(function(e){i.push({id:e.getID(),alias:e.getLabel(),isRoot:!1,VPMRef:e.getType(),parentID:e.getParent().getID(),parentalias:e.getParent().getLabel()})}),{selectedNodes:i,nodes:e}}})}),define("DS/CATFLCockpitWidget/services/implementlink.service",["DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/xhr.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n){var o=e.getFullConfig();return{getRefImplementLinks:function(e){var r=o.webservices.createLogItem+e+o.webservices.keyMaskForService+o.masks.logItemImplementLinksMask;return i.get(r).then(function(e){var t=JSON.parse(e).member[0];return{implemented:t["Implemented by"],implementing:t.Implementing}}).catch(function(e){t.displayError(e,null,null,n.msg_generic_error_get_failed)})},getInstanceImplementLinks:function(e,r){var s=this.confAllImplPathsOnNodes(e,r,!0),a=!1;if(s&&s.payload){let e=!1,t=!1;s.payload.isImplementingPath&&s.payload.isImplementingPath.length>0&&(e=!0),s.payload.isImplementedByPath&&s.payload.isImplementedByPath.length>0&&(t=!0),e||t||(a=!0)}else a=!0;if(a)return Promise.resolve();var l=o.webservices.getLogItemOccImplementLink;return i.post(l,JSON.stringify(s.payload),0).then(function(e){var t=JSON.parse(e).member,i=[];return t&&t.forEach(function(e){let t=e.selectedoccpath,n=UWA.is(t,"string")?t:t[t.length-1];s.pathData[n][t.toString()].forEach(function(t){i.push({node:t,implemented:e.isImplementedBy,implementing:e.isImplementing})})}),i}).catch(function(e){t.displayError(e,null,null,n.msg_generic_error_get_failed)})},confAllImplPathsOnNodes:function(e,t,i,n){let o=this,r={},s={},a=!0,l=!0;if(n&&(a=n.bIsImplementing||!0,l=n.bIsImplementedBy||!0),t){let e=widget.getValue("configurable_expand")||{};if(e.isImplementing?s.isImplementingPath=[]:a=!1,e.isImplementedBy?s.isImplementedByPath=[]:l=!1,!a&&!l)return{}}else s.isImplementingPath=[],s.isImplementedByPath=[];if(e&&e.length>0){let t,n;e.forEach(function(e){if(!e.isRoot()){t=e.options.instance.physicalid;let u=[];if(t&&(r[t]||(r[t]={}),a&&(n=o.getAllImplPaths("implementing",e,[],[])).forEach(function(i){u.push(i.join("|")),r[t][i]?r[t][i].push(e):(r[t][i]=[e],s.isImplementingPath.push(i))}),l&&(n=o.getAllImplPaths("implemented",e,[],[])).forEach(function(i){let n=i.join("|");if(u.indexOf(n)<0)u.push(n),r[t][i]?r[t][i].push(e):(r[t][i]=[e],s.isImplementedByPath.push(i));else{s.isImplementedByPath.some(e=>i.every((t,i)=>t===e[i]))||s.isImplementedByPath.push(i)}}),i)){var c=e.getNodesByRelId("implementinginst"+t)[0],d=e.getNodesByRelId("implementedinst"+t)[0];c&&c.remove(),d&&d.remove()}}})}return{pathData:r,payload:s}},formAllImplPathsOnNodes:function(e,t){var i,n=this,o={};let r=!0,s=!0;if(t){let e=widget.getValue("configurable_expand")||{};if(e.isImplementing||(r=!1),e.isImplementedBy||(s=!1),!r&&!s)return o}return e&&e.length>0&&e.forEach(function(e){e.isRoot()||(i=e.options.instance.physicalid)&&(o[i]={},r&&(o[i].implementing=n.getAllImplPaths("implementing",e,[],[])),s&&(o[i].implementedBy=n.getAllImplPaths("implemented",e,[],[])))}),o},getAllImplPaths:function(e,t,i,n){var o=t.options.actualParent||t.getParent();if(o){if(i.push(t.options.instance.physicalid),o.isRoot())return i.reverse(),n.push(i),n;if(o.options.implementLinks&&o.options.implementLinks[e]){var r=i.slice();r.reverse(),n.push(r)}return this.getAllImplPaths(e,o,i,n)}},createScopeLinks:function(e){var t=o.webservices.createScopeLinks;return i.post(t,JSON.stringify(e)).then(function(e){return e})},deleteImplementLinks:function(e){var t=o.webservices.deleteImplementLinks;return i.post(t,JSON.stringify(e)).then(function(e){return e})},createOccurrenceLinks:function(e){var t=o.webservices.createOccurrenceLinks;return i.post(t,JSON.stringify(e)).then(function(e){return e})},deleteOccurrenceLinks:function(e){var t=o.webservices.deleteOccurrenceLinks;return i.post(t,JSON.stringify(e)).then(function(e){return e})}}}),define("DS/CATFLCockpitWidget/services/document.service",["DS/DocumentManagement/DocumentManagement","DS/CATFLCockpitWidget/utils/config.util","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json"],function(e,t,i){"use strict";var n=JSON.parse(i);return{getDocument:function(i,o){return new Promise(function(r,s){e.getDocumentsFromParent({getVersions:!0,relInfo:{parentDirection:"from",parentId:i,parentRelName:o?n.rel_specification:n.rel_document},securityContext:t.getSecurityContext(),tenant:t.getTenant(),tenantUrl:t.getServiceURL("3DSpace"),onFailure:function(e){s(e)},onComplete:function(e){r(e)}})})},createDocument:function(i,n,o){return new Promise(function(r,s){if(n.length>0){var a=n[0],l={title:a.name.replace(/\.[^/.]+$/,""),fileInfo:{comments:"Test file upload",file:a},relInfo:{parentId:i,parentRelName:o,parentDirection:"from"}},c={tenant:t.getTenant(),securityContext:t.getSecurityContext(),tenantUrl:t.getServiceURL("3DSpace"),onFailure:s,onComplete:r},d=t.getAuthorizedWorkUnder();d&&(c.additionalHeaders=d),e.createDocument(l,c)}else r()})},downloadDocument:function(i){var n=this;return new Promise(function(o,r){var s={tenant:t.getTenant(),securityContext:t.getSecurityContext(),tenantUrl:t.getServiceURL("3DSpace"),onFailure:r,onComplete:function(e){n.launchDownloadfromURLs(e),o()}};e.downloadDocuments(i,s)})},launchDownloadfromURLs:function(e){var t=this;e.reduce(function(e,i){return new Promise(function(n,o){e.then(function(){t._downloadFromFCS(i.downloadUrl),setTimeout(function(){n()},106)})})},new Promise(function(e,t){e()}))},_downloadFromFCS:function(e){var t=document.createElement("div");t.style.display="none",e+="&__fcs__attachment=true",t.innerHTML='<a href="'+e+'" download></a>';var i=t.querySelector("a");document.body.appendChild(t),setTimeout(function(){i.click(),document.body.removeChild(t)},66)},removeDocument:function(i,o,r){return new Promise(function(s,a){var l={relInfo:{parentId:i,parentRelName:r?n.rel_specification:n.rel_document,parentDirection:"from"},tenant:t.getTenant(),securityContext:t.getSecurityContext(),tenantUrl:t.getServiceURL("3DSpace"),onComplete:s,onFailure:a},c=t.getAuthorizedWorkUnder();c&&(l.additionalHeaders=c),e.disconnectDocumentFromParent(o,l)})},attachDocument:function(i,n,o){return new Promise(function(r,s){var a={relInfo:{parentId:i,parentRelName:o,parentDirection:"from"},tenant:t.getTenant(),securityContext:t.getSecurityContext(),tenantUrl:t.getServiceURL("3DSpace"),onComplete:r,onFailure:s},l=t.getAuthorizedWorkUnder();l&&(a.additionalHeaders=l),e.connectDocumentToParent(n,a)})}}}),define("DS/CATFLCockpitWidget/services/space.service",["DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/model.events.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o){var r=e.getFullConfig();return{getSpaceHierarchy:function(e){return i.get(r.webservices.getSpaceHierarchy+e).then(function(e){return JSON.parse(e).spaceHierarchy}).catch(function(e){var i=o.error_get_space_hierarchy,n=e.error.message.slice(e.error.message.indexOf("ResponseCode"));n&&n.indexOf("404")>=0&&(i=o.error_missing_space_media),t.displayError(e,null,null,i)})},createSPPConnection:function(e,s){var a={SPPConnections:[{Objects:[],Spaces:[]}]};return e instanceof Array&&e.length>20&&t.alertMessage("warning",null,o.replace(o.msg_bulkOperation_limitReached,{limit:20})),e.forEach(function(e){a.SPPConnections[0].Objects.push({physicalid:e.options.physicalid,logicalid:e.options.logicalid,majorid:e.options.majorid,type:e.options.type})}),s.forEach(function(e){a.SPPConnections[0].Spaces.push({physicalid:e.options.physicalid,logicalid:e.options.logicalid,majorid:e.options.majorid,type:e.options.type||r.identifiers.type_design_ref})}),i.post(r.webservices.createSPPConnection,JSON.stringify(a),0).then(function(i){return t.alertMessage("success",null,o.msg_assign_spaces_success),n.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-update-cues",data:e}),JSON.parse(i)},function(e){var i=e.error.message.slice(e.error.message.indexOf("ResponseCode"));if(i){if(i.indexOf("401")>=0)return void t.displayError("error",o.error_assign_space_failed_title,o.error_assign_space_failed_subtitle,null);if(i.indexOf("404")>=0)return void t.displayError("error",null,null,o.error_missing_space_media)}t.displayError("error",null,null,o.error_generic_system_and_network)})},navigateSPPConnection:function(e){return i.makeServiceCall(r.webservices.navigateSPPConnection,"POST",JSON.stringify({physicalids:e}),!0).then(function(e){return JSON.parse(e).results}).catch(function(e){var i=o.error_get_spaces_attached,n=e.error.message.slice(e.error.message.indexOf("ResponseCode"));n&&n.indexOf("404")>=0&&(i=o.error_missing_space_media),t.displayError(e,null,null,i)})},deleteSPPConnection:function(e,s){return i.post(r.webservices.deleteSPPConnection,JSON.stringify({physicalids:e})).then(function(){t.alertMessage("success",null,o.msg_delete_spaces_success),n.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-update-cues",data:s})},function(e){let i=e.error.message.slice(e.error.message.indexOf("ResponseCode"));if(i){if(i.indexOf("401")>=0)return void t.displayError("error",o.error_del_space_failed_title,o.error_assign_space_failed_subtitle,null);if(i.indexOf("404")>=0)return void t.displayError("error",null,null,o.error_missing_space_media)}t.displayError("error",null,null,o.error_generic_system_and_network)})}}}),define("DS/CATFLCockpitWidget/services/dimensions.service",["DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/xhr.util"],function(e,t){"use strict";var i=e.getFullConfig();return{getAllDimensions:function(e){return t.get(e.webservices.getDimensionsFromDictionary).then(function(t){e.dimensions={},JSON.parse(t).results.forEach(function(t){var i={};t.Units.forEach(function(e){i[e.Name]={label:e.label,NLSName:e.NLSName}}),e.dimensions[t.Name]={MKSUnit:t.MKSUnit,NLS:t.NLS,Units:i}})})},convertValues:function(e){return t.post(i.webservices.convertValues,JSON.stringify(e)).then(function(e){return JSON.parse(e)})}}}),define("DS/CATFLCockpitWidget/components/ConfirmationWindow_Generic/ConfirmationWindow",["DS/UIKIT/Modal","DS/UIKIT/Input/Button","DS/CATFLCockpitWidget/utils/model.events.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n){return{createWindow:function(t,i,o,r,s,a,l){var c=this;c._confirmCallBack=s,c._cancelCallBack=a,c._closeCallBack=l,c.header=i,c.submit=r||n.label_submit;var d=c._createFooter();c.confirmationWindow=new e({closable:!0,header:i,body:o,footer:d,events:{onHide:function(){c._closeCallBack&&"function"==typeof c._closeCallBack&&c._closeCallBack(),this.destroy()}}}),c.confirmationWindow.inject(t),c.confirmationWindow.show()},_createFooter:function(e){var i=this,o=[],r=new t({id:"confirmation-fail",value:n.cancel_button,events:{onClick:function(){i._cancelCallBack&&"function"==typeof i._cancelCallBack&&i._cancelCallBack(),i._closeConfirmWindow()}}}),s=new t({id:"confirmation-success",value:i.submit,className:"primary",events:{onClick:function(){i._confirmCallBack(),i._closeConfirmWindow()}.bind(i)}});return o.push(s),o.push(r),o},_closeConfirmWindow:function(){this.confirmationWindow.hide()}}}),define("DS/CATFLCockpitWidget/utils/preferences.util",["UWA/Core","DS/ENOXWidgetPreferences/js/ENOXWidgetPreferences","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/services/common.service","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r){"use strict";var s=i.getFullConfig(),a=s.localStorageKeys,l=s.identifiers;return{buildPreferences:function(e){return t.addPlatformSelectionPreferenceToWidget({roles:["SAX"]}),t.addCredentialPreferenceToWidget({usePreferredCredentials:!0}).then(function(){widget.addPreference({name:a.disableIndexAcceleration,type:"boolean",label:o.label_disable_index_mode,defaultValue:!1}),widget.addPreference({name:a.showSpecDocs,type:"boolean",label:o.label_show_spec_doc,defaultValue:!1}),widget.addPreference({name:a.timeoutIndex,type:"list",label:o.label_time_enable_indexing,defaultValue:"180",options:[{label:o.label_one_minute,value:"60"},{label:o.label_three_minute,value:"180"},{label:o.label_five_minute,value:"300"},{label:o.label_ten_minute,value:"600"}]}),widget.addPreference({name:a.depthFlattenedView,label:o.label_depth_flat_view,type:"range",defaultValue:"2",step:"1",min:"2",max:"10"}),widget.addPreference({name:a.depthFlattenedViewArchitectureItemOnly,label:o.label_depth_flat_view_arch,type:"range",defaultValue:"4",step:"1",min:"2",max:"10"}),widget.addPreference({name:a.workunderpos,type:"list",label:o.label_work_under_position,defaultValue:"bottom-right",options:[{label:o.label_upper_left,value:"top-left"},{label:o.label_upper_right,value:"top-right"},{label:o.label_lower_left,value:"bottom-left"},{label:o.label_lower_right,value:"bottom-right"},{label:o.label_free_pos,value:l.workUnder_pos_freeValue}]}),i.cleanRecentlyAuthoredItemsInLocalStorage()})},saveUserCustomAttributes:function(e){let t=e.extensions,i=e.userAdditionalAttributes,o=e.isForPhysicalProduct,r=o?s.localStorageKeys.userAdditionalAttributesForPhysicalProduct:s.localStorageKeys.userAdditionalAttributes,a={extensions:t,userAdditionalAttributes:i};o?s.userAdditionalAttributesForPhysicalProduct=i:s.userAdditionalAttributes=i,t||i?(a=JSON.stringify(a),localStorage.setItem(r,a),widget.setValue(r,a)):(localStorage.removeItem(r),widget.setValue(r,null)),n.setUserPreferences({name:r,value:a})},getNSaveUserCustomAttributes:function(e){let t=e?s.localStorageKeys.userAdditionalAttributesForPhysicalProduct:s.localStorageKeys.userAdditionalAttributes,i=widget.getValue(t)||localStorage.getItem(t);if(i){localStorage.setItem(t,i),widget.setValue(t,i);let n=JSON.parse(i);return e?s.userAdditionalAttributesForPhysicalProduct=n.userAdditionalAttributes:s.userAdditionalAttributes=n.userAdditionalAttributes,Promise.resolve(n)}return n.getUserPreferences(t).then(function(i){return i&&0!==Object.keys(i).length&&(localStorage.setItem(t,JSON.stringify(i)),widget.setValue(t,JSON.stringify(i)),e?s.userAdditionalAttributesForPhysicalProduct=i.userAdditionalAttributes:s.userAdditionalAttributes=i.userAdditionalAttributes),i})},saveUserCustomViews:function(e,t){let i=s.localStorageKeys.customViews,o={customViews:e,currentCustomViewIdentifier:t},r=JSON.stringify(o);localStorage.setItem(i,r),widget.setValue(i,r),n.setUserPreferences({name:i,value:r})},getUserCustomViews:function(){let e=s.localStorageKeys.customViews,t=widget.getValue(e)||localStorage.getItem(e);return t?Promise.resolve(JSON.parse(t)):n.getUserPreferences(e).then(function(t){return 0!==Object.keys(t).length&&(localStorage.setItem(e,JSON.stringify(t)),widget.setValue(e,JSON.stringify(t))),t})}}}),define("DS/CATFLCockpitWidget/components/CommandsCtrl/command.controller",["DS/CATFLCockpitWidget/utils/modelObj.util","DS/CATFLCockpitWidget/utils/contextManager.util"],function(e,t){"use strict";return{init:function(e,t){e&&this._generateCommand(e,t)},_generateCommand:function(i,n){var o,r=this;switch(t.resetSelection(),i){case"FilterByPCCmd":require(["DS/CfgBaseUX/scripts/CfgData","DS/CfgFilterUX/CfgPCChooser"],function(e,t){e.singleProductId=n.model_version;var i=n;t.create(i)});break;case"HistoryCommand":n.forEach(function(i){o=new e(i),t.addSelection(o)}),require(["DS/LifecycleCmd/HistoryCmd","css!DS/egraph/views.css"],function(e){r.historyCmd=new e({context:t.getContext(),ID:"HistoryHdr"}),r._beginCommand(r.historyCmd)});break;case"DuplicateCommand":widget._biFilter&&t.setBIFilter(widget._biFilter),n.forEach(function(i){o=new e(i),t.addSelection(o)}),require(["DS/LifecycleCmd/DuplicateCmd"],function(e){r.duplicateCmd=new e({context:t.getContext(),ID:"DuplicateHdr"}),r._beginCommand(r.duplicateCmd)});break;case"MaturityCommand":n.forEach(function(i){o=new e(i),t.addSelection(o)}),require(["DS/LifecycleCmd/MaturityCmd","css!DS/egraph/views.css"],function(e){r.maturityCmd=new e({context:t.getContext(),ID:"MaturityHdr"}),r._beginCommand(r.maturityCmd)});break;case"EditConfigurationContextCmd":n.forEach(function(i){o=new e(i),t.addSelection(o)}),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/EditConfigurationContextCmd"],function(e){r.editConfigurationContextCmd=new e,r.editConfigurationContextCmd.execute()});break;case"CopyVariantEffectivityCmd":n.items.forEach(function(i){o=new e(i),t.addSelection(o)}),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/CopyVariantEffectivityCmd"],function(e){r.copyVariantEffectivityCmd=new e(n),r.copyVariantEffectivityCmd.execute()});break;case"PasteVariantEffectivityCmd":n.items.forEach(function(i){o=new e(i),t.addSelection(o)}),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/PasteVariantEffectivityCmd"],function(e){r.pasteVariantEffectivityCmd=new e,r.pasteVariantEffectivityCmd.execute()});break;case"EditVariantEffectivityCmd":n.items.forEach(function(i){o=new e(i),t.addSelection(o)}),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/EditVariantEffectivityCmd"],function(e){r.editVariantEffectivityCmd=new e(n),r.editVariantEffectivityCmd.execute()});break;case"CopyEvolutionEffectivityCmd":n.items.forEach(function(i){o=new e(i),t.addSelection(o)}),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/CopyEvolutionEffectivityCmd"],function(e){r.copyEvolutionEffectivityCmd=new e(n),r.copyEvolutionEffectivityCmd.execute()});break;case"PasteEvolutionEffectivityCmd":n.items.forEach(function(i){o=new e(i),t.addSelection(o)}),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/PasteEvolutionEffectivityCmd"],function(e){r.pasteEvolutionEffectivityCmd=new e,r.pasteEvolutionEffectivityCmd.execute()});break;case"EditEvolutionEffectivityCmd":n.items.forEach(function(i){o=new e(i),t.addSelection(o)}),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/EditEvolutionEffectivityCmd"],function(e){r.editEvolutionEffectivityCmd=new e(n),r.editEvolutionEffectivityCmd.execute()});break;case"ExtendEvolutionEffectivityCmd":n.items.forEach(function(i){o=new e(i),t.addSelection(o)}),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/ExtendEvolutionEffectivityCmd"],function(e){r.editEvolutionEffectivityCmd=new e,r.editEvolutionEffectivityCmd.execute()});break;case"AddToConfigurationRevisionCmd":n.items.forEach(function(i){o=new e(i),t.addSelection(o)}),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/AddToConfigurationRevisionCmd"],function(e){r.addToConfigurationRevisionCmd=new e,r.addToConfigurationRevisionCmd.execute()});break;case"ChangeOwnerCommand":n.forEach(function(i){(o=new e(i)).options={grid:{"ds6w:type":i.displayType,"ds6wg:revision":i.revision,"ds6wg:responsible":i.owner},icons:i.icons},t.addSelection(o)}),require(["DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ActionBar_ChangeOwnerCmd"],function(e){r.changeOwnerCmd=new e({context:t.getContext(),ID:"ActionBar_ChangeOwner"}),r._beginCommand(r.changeOwnerCmd)});break;case"CompareCmd":n.forEach(function(i){t.addSelection(new e(i))}),require(["DS/CompareCmd/CompareCmd"],function(e){r.compareCmd=new e({context:t.getContext(),ID:"CompareHdr"}),r._beginCommand(r.compareCmd)});break;case"ShareCmd":n.forEach(function(i){(o=new e(i)).options={grid:{"ds6w:type":i.displayType,"ds6wg:revision":i.revision,"ds6wg:responsible":i.owner},subLabel:i.owner,icons:i.icons},t.addSelection(o)}),require(["DS/ENOCollabSharingCmds/commands/AccessRightCmd/ActionBar_AccessRightCmd"],function(e){r.shareCmd=new e({context:t.getContext(),ID:"ActionBar_AccessRightCmd"}),r._beginCommand(r.shareCmd)});break;case"ReserveCmd":n.forEach(function(i){new e(i);t.addSelection(new e(i))}),require(["DS/ENOCollabSharingCmds/commands/ReserveCmd/ActionBar_ReserveCmd"],function(e){r.reserveHdr=new e({context:t.getContext(),ID:"ReserveHdr"}),r._beginCommand(r.reserveHdr)});break;case"UnreserveCmd":n.forEach(function(i){t.addSelection(new e(i))}),require(["DS/ENOCollabSharingCmds/commands/UnreserveCmd/ActionBar_UnreserveCmd"],function(e){r.unreserveHdr=new e({context:t.getContext(),ID:"UnreserveHdr"}),r._beginCommand(r.unreserveHdr)});break;case"NGFilterCmd":require(["DS/CATFLCockpitWidget/commands/CATFLNextGenFilterCmd"],function(e){r.nextgenFilterCmd=new e({context:t.getContext(),ID:"CATFLNextGenFilterCmd",viewController:n.viewController}),r._beginCommand(r.nextgenFilterCmd)});break;case"ReplaceByLatestRevCmd":n.forEach(function(e){t.addSelection(e)}),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/ReplaceByLatestRevisionCmd"],function(e){r.replaceByLatestRevCmd=new e({context:t.getContext(),ID:"ReplaceByLatestRevisionCmd"}),r._beginCommand(r.replaceByLatestRevCmd)});break;case"ReplaceByRevCmd":n.getSelectedNodes().forEach(function(e){e.options.grid["ds6w:responsible"]=e.options.grid.owner,e.options.grid["ds6w:type"]=e.options.grid.type,t.addSelection(e)}),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/ReplaceByRevisionCmd"],function(e){r.replaceByRevisionCmd=new e({context:t.getContext(n),ID:"ReplaceByRevCmd"}),r._beginCommand(r.replaceByRevisionCmd)})}},_beginCommand:function(e){e.begin()}}}),define("DS/CATFLCockpitWidget/parser/index.parser",["DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","WebappsUtils/WebappsUtils","text!DS/CATFLCockpitWidget/assets/config/mapping.conf.json","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json"],function(e,t,i,n,o){"use strict";var r=JSON.parse(n),s=t.getFullConfig(),a=s.identifiers;s.localStorageKeys;return{attributes:function(t){let i=this,n=[],o=e.getUserCustomAttributes(),a=[];return o&&o.forEach(function(e){e.manipulationUnit&&a.push(e.curi)}),t&&t.forEach(function(t){let o,l,c={};for(o in t)if(l=r[o],"ds6w:label"===o)c.label=t[o];else if("ds6wg:revision"===o)c.revision=t[o];else if("ds6wg:PLMReference.V_isLastVersion"===o)c.isLastVersion="TRUE"===t[o];else if("ds6w:islastrevision"!==o||c.hasOwnProperty("isLastVersion"))if("ds6w:status"===o)c.status=t[o],c[l]=s.MAPPING_MATURITY[t[o].split(".")[1]]||t.current;else if("ds6w:responsible"===o)c.owner=t[o];else if("ds6w:reserved"===o)c.isReserved=t[o];else if("ds6w:created"===o||"ds6w:modified"===o)c[l]=e.formatDate(t[o]);else if("ds6w:description"===o)c.description=t[o];else if("ds6w:type"===o){let e=s.mappingType[t[o]];e&&e.nlsName&&(c[l]=e.nlsName),c.actualType=t[o]}else if("type_icon_url"===o)c.icons={iconPath:t[o],iconSize:{height:"16px",width:"16px"}};else if("ds6w:identifier"===o)c[l]=t[o];else if("ds6wg:architectureextension.v_architecturenumber"===o)c[l]=t[o];else if("taxonomies"===o){let e,n=t[o];if(Array.isArray(n))for(var d=0;d<n.length&&null===(e=i.getKindOfRFLPFromTaxonomy(n[d]));d++);else e=i.getKindOfRFLPFromTaxonomy(n);c.kindOfRFLP=e,c[o]=t[o]}else a.indexOf(o)>=0?(c[o+"_actual"]=t[o],c[o]=""):c[o]=t[o];else c.isLastVersion="TRUE"===t[o];"R"===c.kindOfRFLP&&(c.isLastVersion=void 0),n.push(c)}),n},parseDataToNodeFormat:function(e){let t=e.data,i=[];return t.forEach(function(t){let n={physicalid:t.physicalid,label:t.label,type:t.actualType||t.type,icons:[t.icons]};e.virtual&&(n.virtual=e.virtual),n.grid=JSON.parse(JSON.stringify(t)),i.push(n)}),i},getKindOfRFLPFromTaxonomy:function(e){return e.indexOf(a.type_usecase)>=0||e.indexOf(a.type_requirement)>=0||e.indexOf(a.type_reqSpec)>=0||e.indexOf(a.type_reqGroup)>=0?"R":e.indexOf(a.type_act_functref)>=0?"F":e.indexOf(a.type_act_logref)>=0?"L":e.indexOf(a.type_act_physical)>=0?"P":null},defaultExpandParser:function(n,o){let l=n,c={},d=[],u={},p=t.getUser("isTrigram"),g=t.getUser("isFullName"),m=e.getUserCustomAttributes(),f=[],h=[];if(m&&m.forEach(function(e){e.manipulationUnit&&f.push(e.curi),e.multiValuated&&h.push(e.curi)}),!l)return{};"string"==typeof n&&(l=JSON.parse(n).results);for(var v=0;v<l.length;v++){let n=l[v];if(n.attributes){var C={},b={grid:{}};let o;for(var y=0;y<n.attributes.length;y++){C[n.attributes[y].name]=n.attributes[y].value;var _=r[n.attributes[y].name];if("did"===n.attributes[y].name)o=parseInt(n.attributes[y].value,10),c[o]=n;else if("taxonomies"===n.attributes[y].name)-1!==n.attributes[y].value.indexOf(a.type_act_logref)?(b.type=a.type_act_logref,b.grid.kindOfRFLP="L"):-1!==n.attributes[y].value.indexOf(a.type_act_loginstance)&&(b.type=a.type_act_loginstance);else if("physicalid"===n.attributes[y].name||"logicalid"===n.attributes[y].name||"majorid"===n.attributes[y].name)b[n.attributes[y].name]=n.attributes[y].value,b.resourceid=n.attributes[y].value,b.grid[n.attributes[y].name]=n.attributes[y].value;else if("ds6w:label"===n.attributes[y].name)b.label=n.attributes[y].value;else if("ds6w:type"===n.attributes[y].name){var D=s.mappingType[n.attributes[y].value];D?(b.grid[_]=D.nlsName,b.icons=[t.getTypeIconUrl(n.attributes[y].value)]):(b.grid[_]=n.attributes[y].value,b.icons=[t.getTypeIconUrl(a.type_act_logref)]),b.grid.actualType=n.attributes[y].value}else if("ds6w:status"===n.attributes[y].name)b[_]=n.attributes[y].value,b.grid[_]=s.MAPPING_MATURITY[n.attributes[y].value.split(".")[1]];else if("ds6w:created"===n.attributes[y].name||"ds6w:modified"===n.attributes[y].name)b.grid[_]=e.formatDate(n.attributes[y].value);else if("ds6wg:plmreference.v_islastversion"===n.attributes[y].name)b.grid.isLastVersion="TRUE"===n.attributes[y].value;else if("ds6w:reserved"===n.attributes[y].name)b.grid.isReserved=n.attributes[y].value;else if("ds6w:reservedBy"===n.attributes[y].name)b.grid.reservedBy=n.attributes[y].value?n.attributes[y].value:"";else if("ds6wg:EXC_PROTECTION_EXISTS"===n.attributes[y].name)b.grid.isIPProtected="TRUE"===n.attributes[y].value;else if("ro.plminstance.v_effectivitycompiledform"===n.attributes[y].name)b[_]=n.attributes[y].value;else{var S=_||n.attributes[y].name;h.indexOf(S)>=0?f.indexOf(S)>=0?(b.grid[S+"_actual"]||(b.grid[S+"_actual"]=[]),b.grid[S+"_actual"].push(n.attributes[y].value)):(b.grid[S]||(b.grid[S]=[]),b.grid[S].push(n.attributes[y].value)):void 0!==b.grid[S]?(Array.isArray(b.grid[S])||(b.grid[S+"_actual"]?(b.grid[S]=[b.grid[S+"_actual"]],b.grid[S+"_actual"]=void 0):b.grid[S]=[b.grid[S]]),b.grid[S].push(n.attributes[y].value)):f.indexOf(S)>=0?(b.grid[S+"_actual"]=n.attributes[y].value,b.grid[S]=""):b.grid[S]=n.attributes[y].value}}b.type===a.type_act_logref&&(b.grid.isIPProtected||(b.grid.isIPProtected=!1),b.grid.isReservedByOther=!1,"FALSE"===b.grid.isReserved?(b.isReserved=b.grid.isReserved,b.grid.isReserved=i.getWebappsAssetUrl("CATFLCockpitWidget","icons/I_CheckIn.png")):b.grid.reservedBy===p||b.grid.reservedBy===g?(b.isReserved=b.grid.isReserved,b.grid.isReserved=i.getWebappsAssetUrl("CATFLCockpitWidget","icons/I_lock.png")):(b.isReserved=b.grid.isReserved,b.grid.isReserved=i.getWebappsAssetUrl("CATFLCockpitWidget","icons/I_ReservedByOthers.png"),b.grid.isReservedByOther=!0),m&&m.forEach(function(e){e.bo?void 0===b.grid[e.curi]&&(b.grid[e.curi]=""):void 0===b.grid["instance_"+e.curi]&&(b.grid["instance_"+e.curi]="")}),b.grid.description=b.grid.description||"",b.grid.architectureNumber=b.grid.architectureNumber||"",b.grid.instance_description=""),n.attributes=b,b.type===a.type_act_loginstance&&(n.attributes.grid=Object.assign({},C,b.grid)),u[n.attributes.physicalid]=o}else if(n.path)d.push(n.path);else if(n.icon__default_thumbnail_2d){var w=n.icon__default_thumbnail_2d;for(y=0;y<w.length;y++){var I=w[y].did,A=w[y].icon,F=w[y].thumbnail_2d;I.forEach(function(e){c[e].attributes.icons=[{iconPath:A,iconSize:{height:"16px",width:"16px"}}],c[e].attributes.thumbnail=F})}}}let k={};return o.forEach(function(e){let t=u[e],i=[];d.forEach(function(e){e.indexOf(t)>=0&&i.push(e)}),k[e]={map:c,paths:i}}),k},progressiveExpandParser:function(t){let i=this,n={},o={},r={};if(t){let s=t.results||[],l=e.getUserCustomAttributes(),c=[],d=[];l&&l.forEach(function(e){e.manipulationUnit&&c.push(e.curi),e.multiValuated&&d.push(e.curi)});for(let e=0;e<s.length;e++){let t,n=s[e];-1!==n.taxonomies.indexOf(a.type_act_logref)?o[(t=i.parseProgressiveExpandItemAttr(n,c,d)).resourceid]={attributes:t}:-1!==n.taxonomies.indexOf(a.type_act_loginstance)&&(r[(t=i.parseProgressiveExpandInstAttr(n,c,d)).from]?r[t.from].push({attributes:t}):r[t.from]=[{attributes:t}])}n.references=o,n.instances=r}return n},parseProgressiveExpandItemAttr:function(n,o,l){if(n){let p=t.getUser("isTrigram"),g=t.getUser("isFullName");var c={grid:{}};for(let i in n){let p=r[i];if("taxonomies"===i)c.type=a.type_act_logref,c.grid.kindOfRFLP="L";else if("physicalid"===i||"logicalid"===i||"majorid"===i||"resourceid"===i)c[i]=n[i],c.grid[i]=n[i];else if("ds6w:label"===i)c.label=n[i];else if("ds6w:type"===i){var d=s.mappingType[n[i]];d?(c.grid[p]=d.nlsName,c.icons=[t.getTypeIconUrl(n[i])]):(c.grid[p]=n[i],c.icons=[t.getTypeIconUrl(a.type_act_logref)]),c.grid.actualType=n[i]}else if("ds6w:status"===i)c[p]=n[i],c.grid[p]=s.MAPPING_MATURITY[n[i].split(".")[1]];else if("ds6w:created"===i||"ds6w:modified"===i)c.grid[p]=e.formatDate(n[i]);else if("ds6wg:plmreference.v_islastversion"===i)c.grid.isLastVersion="TRUE"===n[i];else if("ds6w:reserved"===i)c.grid.isReserved=n[i];else if("ds6w:reservedBy"===i)c.grid.reservedBy=n[i]?n[i]:"";else if("ds6wg:EXC_PROTECTION_EXISTS"===i)c.grid.isIPProtected="TRUE"===n[i];else if("ro.plminstance.v_effectivitycompiledform"===i)c[p]=n[i];else{var u=p||i;l.indexOf(u)>=0?o.indexOf(u)>=0?(c.grid[u+"_actual"]||(c.grid[u+"_actual"]=[]),c.grid[u+"_actual"].push(n[i])):(c.grid[u]||(c.grid[u]=[]),c.grid[u].push(n[i])):void 0!==c.grid[u]?(Array.isArray(c.grid[u])||(c.grid[u+"_actual"]?(c.grid[u]=[c.grid[u+"_actual"]],c.grid[u+"_actual"]=void 0):c.grid[u]=[c.grid[u]]),c.grid[u].push(n[i])):o.indexOf(u)>=0?(c.grid[u+"_actual"]=n[i],c.grid[u]=""):c.grid[u]=n[i]}}if(c.type===a.type_act_logref){c.grid.isIPProtected||(c.grid.isIPProtected=!1),c.grid.isReservedByOther=!1,"FALSE"===c.grid.isReserved?(c.isReserved=c.grid.isReserved,c.grid.isReserved=i.getWebappsAssetUrl("CATFLCockpitWidget","icons/I_CheckIn.png")):c.grid.reservedBy===p||c.grid.reservedBy===g?(c.isReserved=c.grid.isReserved,c.grid.isReserved=i.getWebappsAssetUrl("CATFLCockpitWidget","icons/I_lock.png")):(c.isReserved=c.grid.isReserved,c.grid.isReserved=i.getWebappsAssetUrl("CATFLCockpitWidget","icons/I_ReservedByOthers.png"),c.grid.isReservedByOther=!0);let t=e.getUserCustomAttributes();t&&t.forEach(function(e){e.bo&&void 0===c.grid[e.curi]&&(c.grid[e.curi]="")}),c.grid.description=c.grid.description||"",c.grid.architectureNumber=c.grid.architectureNumber||""}return c.physicalid||(c.physicalid=c.resourceid),c}},parseProgressiveExpandInstAttr:function(i,n,o){if(i){var l={grid:{}};for(let e in i){let u=r[e];if("taxonomies"===e)l.type=a.type_act_loginstance;else if("physicalid"===e||"logicalid"===e||"majorid"===e||"resourceid"===e)l[e]=i[e],l.grid[e]=i[e];else if("from"===e||"to"===e)l[e]=i[e];else if("ds6w:label"===e)l.label=i[e];else if("ds6w:description"===e)l.grid.instance_description=i[e];else if("ds6w:type"===e){var c=s.mappingType[i[e]];c?(l.grid[u]=c.nlsName,l.icons=[t.getTypeIconUrl(i[e])]):(l.grid[u]=i[e],l.icons=[t.getTypeIconUrl(a.type_act_logref)]),l.grid.actualType=i[e]}else{var d=u||e;o.indexOf(d)>=0?n.indexOf(d)>=0?(l.grid[d+"_actual"]||(l.grid[d+"_actual"]=[]),l.grid[d+"_actual"].push(i[e])):(l.grid[d]||(l.grid[d]=[]),l.grid[d].push(i[e])):void 0!==l.grid[d]?(Array.isArray(l.grid[d])||(l.grid[d+"_actual"]?(l.grid[d]=[l.grid[d+"_actual"]],l.grid[d+"_actual"]=void 0):l.grid[d]=[l.grid[d]]),l.grid[d].push(i[e])):n.indexOf(d)>=0?(l.grid[d+"_actual"]=i[e],l.grid[d]=""):l.grid[d]=i[e]}}let u=e.getUserCustomAttributes();return u&&u.forEach(function(e){e.bo||void 0===l.grid["instance_"+e.curi]&&(l.grid["instance_"+e.curi]="")}),l.physicalid||(l.physicalid=l.resourceid),l}}}}),define("DS/CATFLCockpitWidget/commands/RelatedObjectCmd",["UWA/Utils/InterCom","DS/CATFLCockpitWidget/utils/config.util","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json"],function(e,t,i){"use strict";JSON.parse(i);return{execute:function(i,n){var o=t.form3DXContent([n]),r=new e.Socket("compassPageSocket");r.subscribeServer("com.ds.compass",window.parent),r.dispatchEvent("onSetX3DContent",o,"compassPageSocket"),o.appId=i,r.dispatchEvent("onLaunchApp",o,"compassPageSocket")}}}),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.filter",["UWA/Core","DS/DataGridView/DataGridViewSetFilterView","DS/DataGridView/DataGridViewStringRegExpFilterView","DS/DataGridView/DataGridViewNumberFilterView","DS/TreeModel/SetFilter","DS/TreeModel/StringRegExpFilter","DS/TreeModel/NumberFilter","DS/CATFLCockpitWidget/services/common.service","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l){return{createFilterOnAttributeDisciplines:function(e,t){var i=this;return e.inherit({isDataFiltered:function(e){return this._parent(e)||!t.call(i,e)},_applyFilterModel:function(e){if(this.filterManager){if(this.filterManager.model.prepareUpdate&&this.filterManager.model.prepareUpdate(),this._listOfFilteredData.forEach(function(e){e.decrementFilteredCount()}),this._listOfFilteredData=[],!this.filterModel)return this.filterManager.publish("filterModelChange",{propertyId:this.propertyId,filter:this}),this.filterManager.filterModel[this.propertyId]&&delete this.filterManager.filterModel[this.propertyId].filterModel,void(this.filterManager.model.pushUpdate&&this.filterManager.model.pushUpdate({updateType:WUXModelUpdateTypes.Filtering}));this.filterManager.filterModel[this.propertyId].filterModel=this.filterModel;var t=this;this.filterManager.model.processDescendants&&this.filterManager.model.processDescendants({treeTraversalOrder:"postOrder",processNode:function(e){if(!0!==this._preventFiltering)if(e.nodeModel.canBeFiltered(t.propertyId)&&t.isDataFiltered(e.nodeModel))this.incrementFilteredCount(),t._listOfFilteredData.push(this);else{function i(e){if(e!==o){!function(e){var i=t._listOfFilteredData.indexOf(e);-1!==i?(t._listOfFilteredData.splice(i,1),e.decrementFilteredCount()):e._preventFiltering=!0}(e);var n=e.getChildren();n&&n.forEach(function(e){i(e)})}}this.getParents().forEach(function(e){e._preventFiltering=!0});var n=this.getParent(),o=this,r=n.getParent();childrenLogicalParent=r.getChildren(),childrenLogicalParent.forEach(function(e){e._options.type.includes("Category")&&i(e)})}else delete this._preventFiltering}}),this.filterManager.publish("filterModelChange",{propertyId:this.propertyId,filter:this}),this.filterManager.model.pushUpdate&&this.filterManager.model.pushUpdate({updateType:WUXModelUpdateTypes.Filtering})}}})},registerFiltersOnDisciplines:function(e,a,l){var c=this.createFilterOnAttributeDisciplines(o,l),d=this.createFilterOnAttributeDisciplines(s,l),u=this.createFilterOnAttributeDisciplines(r,l),p=e.getTreeDocument().getFilterManager();p.registerFilter("set"+a,c),p.registerFilter("number"+a,d),p.registerFilter("stringRegexp"+a,u);var g=e.getFilterViewManager();g.registerFilterView("set"+a,t.inherit({})),g.registerFilterView("number"+a,n.inherit({})),g.registerFilterView("stringRegexp"+a,i.inherit({}))},createFilterModelWithCustomCondition:function(t,i){var n=e.clone(i);for(var o in n)switch(n[o].filterId){case"stringRegexp":n[o].filterId="stringRegexp"+t,n[o].filterModel={};break;case"set":n[o].filterId="set"+t,n[o].filterModel=[];break;case"number":n[o].filterId="number"+t,n[o].filterModel={}}return n},registerAndCreateFilterOnDisciplines:function(e,t,i){var n=null;if("PilotingDisciplines"===t)n=this.isNodePilotingDiscipline;else{if("Disciplines"!==t)return null;n=this.isNodeDiscipline}return this.registerFiltersOnDisciplines(e,t,n),this.createFilterModelWithCustomCondition(t,i)},copyOldFilterModelInNewFilterModel:function(e,t){for(var i in e)t[i]&&t[i].filterModel&&(e[i].filterModel=t[i].filterModel)},changeFilterModel:function(e,t){var i=e.getTreeDocument().getFilterManager().filterModel;this.copyOldFilterModelInNewFilterModel(t,i),e.getTreeDocument().setFilterModel(t)},isNodePilotingDiscipline:function(e){var t=!1,i=!1,n=!1,o=e._options.linkInfo;o&&(t="ref"===o.objType&&"implementing"===o.linkType,e._options.grid.kindOfRFLP&&(i="L"===e._options.grid.kindOfRFLP),n=!!e.getParent().getParent()._options.grid.architectureNumber);return t&&i&&n},isNodeDiscipline:function(e){var t=!1,i=!1,n=e._options.linkInfo;if(n){t="implementing"===n.linkType&&"inst"===n.objType,i="RFLVPMLogicalReference"===e._options.type;var o=e.getParent().getParent();hasLogicalRefParentWithAN=!!o._options.grid.architectureNumber}return t&&i&&hasLogicalRefParentWithAN}}}),define("DS/CATFLCockpitWidget/components/ConvergenceCues/ConvergenceCues.export",["DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/implementlink.service","DS/CATFLCockpitWidget/utils/common.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n){"use strict";return{exportCuesForItems:function(){var o,r,s=this.contentView.treeDocument.getSelectedNodes(),a=[];if(s.length<=0)i.alertMessage("error",null,n.error_cue_export_noSelItems);else if(o=this.contentView.treeDocument.getRoots()[0].options.physicalid,1!==s.length||s[0]._options.physicalid!==o){for(var l=[],c=!1,d=0;d<s.length;d++)s[d].options.instance&&(r=s[d].options.instance.physicalid,a.push(r),l.push(s[d]),s[d].options.cueDetails&&(c=!0));var u=t.confAllImplPathsOnNodes(l,!1,!1);a&&a.length>0&&(s.length>20&&i.alertMessage("info",null,n.info_download_short_while),c&&i.alertMessage("warning",null,n.msg_cue_export_warning),e.exportVisualCues(a,u.payload))}else i.alertMessage("error",null,n.error_export_cue_computation_root)}}}),define("DS/CATFLCockpitWidget/components/WelcomePanel/welcomepanel.controller",["DS/CoreEvents/ModelEvents","DS/CATFLCockpitWidget/utils/model.events.util","DS/ENOXWelcomePanel/js/ENOXWelcomePanel","text!DS/CATFLCockpitWidget/assets/config/welcomepanel.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o){"use strict";var r=JSON.parse(n),s=!1;return{init:function(n){s||this.mapNLSLabels();var o=new e,a={collapsed:!1,activities:r.activities,parentContainer:n,modelEvents:o};o.addEventListener("welcome-panel-action-selected",function(e){"action_new_logical_ref"===e.id?t.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"create-new-logical-item",data:{selectedItem:null}}):"action_conf_convergence_cues"===e.id&&t.getFLWebModelEventsObj("flweb-model-events").publish({event:"flcockpit-convergence-cues-checklist"})}),new i(a).render()},mapNLSLabels:function(){r.activities&&r.activities.forEach(function(e){e.title=o[e.title],e.actions&&e.actions.forEach(function(e){e.text=o[e.text]})}),s=!0}}}),define("DS/CATFLCockpitWidget/components/SecurityContextSelector/securityContextSelectionWindow",["DS/UIKIT/Modal","DS/UIKIT/Input/Button","DS/CATFLCockpitWidget/utils/model.events.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n){return{createWindow:function(t,i,o,r,s){this._callBack=s,this.header=i,this.submit=r||n.label_submit;var a=this._createFooter();this.confirmationWindow=new e({closable:!1,header:i,body:o,footer:a,events:{onHide:function(){this.destroy()}}}),this.confirmationWindow.inject(t),this.confirmationWindow.show()},_createFooter:function(e){var i=this,n=[],o=new t({id:"confirmation-success",value:i.submit,className:"primary",events:{onClick:function(){i._callBack()}.bind(i)}});return n.push(o),n},_closeConfirmWindow:function(){this.confirmationWindow.hide()}}}),define("DS/CATFLCockpitWidget/services/pno.service",["DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/xhr.util"],function(e,t){var i=e.getFullConfig();return{getPnO:function(e){return t.get(i.webservices.pno+e).then(function(e){return JSON.parse(e)})}}});var map={};define("DS/CATFLCockpitWidget/utils/pno.util",["DS/CATFLCockpitWidget/services/pno.service"],function(e){return{getFullName:function(t){return void 0===map[t]&&(map[t]=e.getPnO(t)),map[t].then(function(e){return e.firstname+" "+e.lastname})}}}),define("DS/CATFLCockpitWidget/components/RefineSelection/RefineSelection",["DS/Windows/Dialog","DS/Controls/Button","DS/Handlebars/Handlebars","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget","text!DS/CATFLCockpitWidget/components/RefineSelection/RefineSelection.html","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util"],function(e,t,i,n,o,r,s){"use strict";var a=r.getFullConfig(),l=a.identifiers,c=[{id:"structureInstances",nlsName:n.label_structure_instances,checkedByDefault:!0,subcategory:[{id:"onlystructureleaves",nlsName:n.label_only_structure_leaves,checkedByDefault:!1},{id:"onlykeyarchcomp",nlsName:n.label_only_key_arch_comp,checkedByDefault:!1}]},{id:"implementing",nlsName:n.label_implementing,checkedByDefault:!1,subcategory:[{id:"implementingReq",nlsName:n.label_requirement,checkedByDefault:!1},{id:"implementingFunc",nlsName:n.label_functional,checkedByDefault:!1},{id:"implementingLog",nlsName:n.label_logical,checkedByDefault:!1}]},{id:"isimplementing",nlsName:n.label_is_implementing,checkedByDefault:!1,subcategory:[{id:"isimplementingReq",nlsName:n.label_requirement,checkedByDefault:!1},{id:"isimplementingFunc",nlsName:n.label_functional,checkedByDefault:!1},{id:"isimplementingLog",nlsName:n.label_logical,checkedByDefault:!1}]},{id:"implmentedBy",nlsName:n.label_implemented_by,checkedByDefault:!1,subcategory:[{id:"implmentedByLog",nlsName:n.label_logical,checkedByDefault:!1},{id:"implmentedByPrd",nlsName:n.label_product,checkedByDefault:!1}]},{id:"isImplmentedBy",nlsName:n.label_is_implemented_by,checkedByDefault:!1,subcategory:[{id:"isImplmentedByLog",nlsName:n.label_logical,checkedByDefault:!1},{id:"isImplmentedByPrd",nlsName:n.label_product,checkedByDefault:!1}]},{id:"proposedsolution",nlsName:n.label_proposed_solution,checkedByDefault:!1},{id:"specDocs",nlsName:n.label_spec_documents,checkedByDefault:!1}],d={main:i.compile(o)},u=function(e){this.selectedNodes=e,this.render()};return u.prototype.render=function(){var i=this;i.dialog=new e({title:n.label_refine_selection,content:d.main({Header:i.selectedNodes.length+" "+n.label_data_grid,CategoryObject:c,CombCuesid:"combcues",CombCuesName:n.label_only_comb_cues}),height:630,width:340,resizableFlag:!1,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new t({label:n.label_refine,emphasize:"primary",onClick:function(){var e,t=!0;if(i.contentDiv.querySelector(".checkbox-refine-by-cues").checked)for(e=0;e<i.selectedNodes.length;e++)void 0===i.selectedNodes[e].options.cueDetails?i.selectedNodes[e].unselect():"group"!==i.selectedNodes[e].options.cueDetails.cue&&i.selectedNodes[e].unselect();else for(e=0;e<i.selectedNodes.length;e++){var o=i.dialog.elements.container;if(o.querySelector("#structureInstances").checked||i.selectedNodes[e].options.virtual)if(!o.querySelector("#onlystructureleaves").checked||i.selectedNodes[e].options.virtual||i._isNodeLeaf(i.selectedNodes[e]))if(!o.querySelector("#onlykeyarchcomp").checked||i.selectedNodes[e].options.virtual||i.selectedNodes[e].options.grid.architectureNumber){if(i.selectedNodes[e].options.virtual){if(!o.querySelector("#implementingReq").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementingref")&&"R"===i.selectedNodes[e].options.grid.kindOfRFLP){i.selectedNodes[e].unselect();continue}if(!o.querySelector("#implementingFunc").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementingref")&&"F"===i.selectedNodes[e].options.grid.kindOfRFLP){i.selectedNodes[e].unselect();continue}if(!o.querySelector("#implementingLog").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementingref")&&"L"===i.selectedNodes[e].options.grid.kindOfRFLP){i.selectedNodes[e].unselect();continue}if(!o.querySelector("#isimplementingReq").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementinginst")&&"R"===i.selectedNodes[e].options.grid.kindOfRFLP){i.selectedNodes[e].unselect();continue}if(!o.querySelector("#isimplementingFunc").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementinginst")&&"F"===i.selectedNodes[e].options.grid.kindOfRFLP){i.selectedNodes[e].unselect();continue}if(!o.querySelector("#isimplementingLog").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementinginst")&&"L"===i.selectedNodes[e].options.grid.kindOfRFLP){i.selectedNodes[e].unselect();continue}if(!o.querySelector("#implmentedByLog").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementedref")&&"L"===i.selectedNodes[e].options.grid.kindOfRFLP){i.selectedNodes[e].unselect();continue}if(!o.querySelector("#implmentedByPrd").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementedref")&&"P"===i.selectedNodes[e].options.grid.kindOfRFLP){i.selectedNodes[e].unselect();continue}if(!o.querySelector("#isImplmentedByLog").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementedinst")&&"L"===i.selectedNodes[e].options.grid.kindOfRFLP){i.selectedNodes[e].unselect();continue}if(!o.querySelector("#isImplmentedByPrd").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementedinst")&&"P"===i.selectedNodes[e].options.grid.kindOfRFLP){i.selectedNodes[e].unselect();continue}if(!o.querySelector("#proposedsolution").checked&&i.selectedNodes[e].getParent().getType()===l.type_proposed_solution){i.selectedNodes[e].unselect();continue}if(!o.querySelector("#specDocs").checked&&i.selectedNodes[e].getParent().getType()===l.type_spec_document){i.selectedNodes[e].unselect();continue}if("DIF"===i.selectedNodes[e].options.grid.kindOfRFLP){i.selectedNodes[e].unselect();continue}}}else i.selectedNodes[e].unselect();else i.selectedNodes[e].unselect();else i.selectedNodes[e].unselect()}for(e=0;e<i.selectedNodes.length;e++)if(!1!==i.selectedNodes[e].isSelected()){t=!1;break}if(t){for(e=0;e<i.selectedNodes.length;e++)i.selectedNodes[e].select();s.alertMessage("warning",null,n.warn_refine_selection_empty_result)}i._saveUserSelection(),i.dialog.close()}}),Close:new t({emphasize:"secondary",onClick:function(){i.dialog.close()}})}}),i.dialog.elements.container.classList.add("flweb-refine-selection-panel"),i.contentDiv=i.dialog.elements._contentDiv;var o=JSON.parse(localStorage.getItem(a.localStorageKeys.refineSelectionOptions));null!==o&&i.contentDiv.querySelectorAll("[type=checkbox]").forEach(function(e){e.checked=o[e.id].checked,e.indeterminate=o[e.id].indeterminate,e.disabled=o[e.id].disabled}),i._disableRefineByCategoryCheckboxes(i.contentDiv.querySelector("#combcues").checked),i._checkifOkButtonIsEnabled(),c.forEach(function(e){if(i.contentDiv.querySelector("#"+e.id).addEventListener("click",function(t){"structureInstances"===e.id?i._disableStructureSubCategoriesCheckboxes():i._updateSubcategorySelection(e),i._checkifOkButtonIsEnabled()}),void 0!==e.subcategory)for(var t=0;t<e.subcategory.length;t++){var n=e.subcategory[t];i.contentDiv.querySelector("#"+n.id).addEventListener("click",function(){"onlystructureleaves"===n.id||"onlykeyarchcomp"===n.id?i._updateStructureRootCategory():i._updateRootCategorySelection(e),i._checkifOkButtonIsEnabled()})}}),i.contentDiv.querySelector("#combcues").addEventListener("click",function(e){i._disableRefineByCategoryCheckboxes(e.currentTarget.checked),i._checkifOkButtonIsEnabled()})},u.prototype._saveUserSelection=function(){var e={};this.contentDiv.querySelectorAll("[type=checkbox]").forEach(function(t){e[t.id]={checked:t.checked,indeterminate:t.indeterminate,disabled:t.disabled}}),localStorage.setItem(a.localStorageKeys.refineSelectionOptions,JSON.stringify(e))},u.prototype._updateSubcategorySelection=function(e){var t=this;void 0!==e.subcategory&&e.subcategory.forEach(function(i){t.contentDiv.querySelector("#"+i.id).checked=t.contentDiv.querySelector("#"+e.id).checked})},u.prototype._updateRootCategorySelection=function(e){var t=this.contentDiv.querySelectorAll("[parentid="+e.id+"]:checked").length;t===e.subcategory.length?(this.contentDiv.querySelector("#"+e.id).checked=!0,this.contentDiv.querySelector("#"+e.id).indeterminate=!1):t>0?(this.contentDiv.querySelector("#"+e.id).indeterminate=!0,this.contentDiv.querySelector("#"+e.id).checked=!0):0===t&&(this.contentDiv.querySelector("#"+e.id).checked=!1,this.contentDiv.querySelector("#"+e.id).indeterminate=!1)},u.prototype._isNodeLeaf=function(e){if(!e.isVisible())return!1;if(e.isExpanded()&&e.options.children.length>0)for(var t=0;t<e.options.children.length;t++)if(e.options.children[t].options.physicalid)return!1;return!0},u.prototype._updateStructureRootCategory=function(){0===this.contentDiv.querySelectorAll("[parentid=structureInstances]:checked").length?(this.contentDiv.querySelector("#structureInstances").checked=!0,this.contentDiv.querySelector("#structureInstances").indeterminate=!1):(this.contentDiv.querySelector("#structureInstances").checked=!0,this.contentDiv.querySelector("#structureInstances").indeterminate=!0)},u.prototype._disableStructureSubCategoriesCheckboxes=function(){var e=this.contentDiv.querySelector("#structureInstances").checked||this.contentDiv.querySelector("#structureInstances").indeterminate||!1;this.contentDiv.querySelectorAll("[parentid=structureInstances]").forEach(function(t){t.disabled=!e}),this.contentDiv.querySelectorAll("[parentid=structureInstances]:not([disabled]):checked").length>0&&(this.contentDiv.querySelector("#structureInstances").indeterminate=!0)},u.prototype._disableRefineByCategoryCheckboxes=function(e){this.contentDiv.querySelectorAll(".checkbox-refine-by-category, .checkbox-refine-by-subcategory").forEach(function(t){t.disabled=e}),e||this._disableStructureSubCategoriesCheckboxes()},u.prototype._checkifOkButtonIsEnabled=function(){0===this.contentDiv.querySelectorAll("[type=checkbox]:not([disabled]):checked").length?this.dialog.buttons.Ok.disabled=!0:this.dialog.buttons.Ok.disabled=!1},u}),define("DS/CATFLCockpitWidget/components/ImplementLinks/CATFLTraceabilityMatrixFilter",["DS/Controls/Button","DS/Controls/Toggle","DS/Controls/Expander","DS/Controls/LineEditor","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/CATFLCockpitWidget/utils/common.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a){"use strict";var l=function(e,t){this.wrapper=e,this.filterParams={options:{},allocation:{},references:{},instances:{},FilterNames:{}},this.render(t)};return l.prototype.render=function(t){var i=this;if(i.filterimmersiveFrame&&i.filterDialog)i.filterimmersiveFrame.show(),i.filterDialog.show();else{i.filterimmersiveFrame=new r({}),i.filterimmersiveFrame.inject(t);var n=i._createFilterContent();i.filterDialog=new o({immersiveFrame:i.filterimmersiveFrame,title:a.header_filters,content:n,resizableFlag:!0,autoCloseFlag:!1,buttons:{Ok:new e({label:a.apply_button,onClick:function(e){i.wrapper.trMatrix.applyFilter(i.filterParams)}}),Reset:new e({label:a.reset_button,onClick:function(e){i.resetMode=!0,i.filterDialog.content.remove(),i.filterDialog.content=i._createFilterContent(),i.resetMode=!1}})}}),i.filterDialog.addEventListener("close",function(e){e.preventDefault(),e.stopPropagation(),i.filterDialog.hide(),i.filterimmersiveFrame.hide()})}},l.prototype._createFilterContent=function(){var e=UWA.createElement("div",{class:"filter-trMatrix-container"});return this._createOptionsContent().inject(e),this._createAllocationContent().inject(e),this._createReferencesContent().inject(e),this._createInstancesContent().inject(e),this._createNamesContent().inject(e),e},l.prototype._createOptionsContent=function(){var e=this,n=new i({header:a.header_options,body:new UWA.Element("div"),style:"styled",expandedFlag:!0});e.filterParams.options.displayParents=!0;var o=new t({type:"checkbox",label:a.header_disp_parents,checkFlag:!0});return o.addEventListener("buttonclick",function(t){e.filterParams.options.displayParents=t.dsModel.checkFlag}),o.inject(n.body),n},l.prototype._createAllocationContent=function(){var e=this,n=new i({header:a.header_allocation,body:new UWA.Element("div"),style:"styled",expandedFlag:!0});e.filterParams.allocation.allocated=!0;var o=new t({type:"checkbox",label:a.header_allocated,checkFlag:!0});o.addEventListener("buttonclick",function(t){e.filterParams.allocation.allocated=t.dsModel.checkFlag}),o.inject(n.body),e.filterParams.allocation.notAllocated=!0;var r=new t({type:"checkbox",label:a.header_not_allocated,checkFlag:!0});return r.addEventListener("buttonclick",function(t){e.filterParams.allocation.notAllocated=t.dsModel.checkFlag}),r.inject(n.body),n},l.prototype._createReferencesContent=function(){var e=new i({header:a.header_references,body:new UWA.Element("div"),style:"styled",expandedFlag:!0}),t=this.wrapper.typesMap.references;if(t){var n=Object.keys(t).sort(function(e,i){return t[e].name.toLowerCase()<t[i].name.toLowerCase()?-1:t[e].name.toLowerCase()>t[i].name.toLowerCase()?1:0}).reduce(function(e,i){return e[i]=t[i],e},{});for(var o in n)this._declareType("references",e.body,o)}return e},l.prototype._createInstancesContent=function(){var e=new i({header:"Instances",body:new UWA.Element("div"),style:"styled",expandedFlag:!0}),t=this.wrapper.typesMap.instances;if(t)for(var n in t)t.hasOwnProperty(n)&&this._declareType("instances",e.body,n);return new UWA.Element("div")},l.prototype._createNamesContent=function(){var e=this,o=new i({header:a.header_names,body:new UWA.Element("div"),style:"styled",expandedFlag:!0});e.filterParams.FilterNames.FilterNamesString="",e.filterParams.FilterNames.FilterCheckToDo="";var r=new n({placeholder:a.ph_enter_text});r.addEventListener("change",function(t){var i=t.dsModel.value,n=i?i.trim():"",o="";if(n.length>0){var r=n.startsWith("*"),s=n.endsWith("*");r&&(n=n.substring(1)),s&&(n=n.substring(0,n.length-1)),n.length>0&&(o=r&&!s?"endsWith":!r&&s?"startsWith":"includes")}e.filterParams.FilterNames.FilterNamesString=n,e.filterParams.FilterNames.FilterCheckToDo=o}),r.inject(o.body),e.filterParams.FilterNames.ApplyToRows=!0;var s=new t({type:"checkbox",label:a.header_app_to_rows,checkFlag:!0});s.addEventListener("buttonclick",function(t){e.filterParams.FilterNames.ApplyToRows=t.dsModel.checkFlag}),s.inject(o.body),e.filterParams.FilterNames.ApplyToColumns=!0;var l=new t({type:"checkbox",label:a.header_app_to_cols,checkFlag:!0});return l.addEventListener("buttonclick",function(t){e.filterParams.FilterNames.ApplyToColumns=t.dsModel.checkFlag}),l.inject(o.body),o},l.prototype._declareType=function(e,i,n){var o,r=this,s=r.wrapper.typesMap[e][n];r.types||(r.types={}),r.types.hasOwnProperty(n)?(o=r.types[n],r.resetMode&&(r.filterParams[e][n]=!0,o.el.checkFlag=!0),o.el.inject(i)):((o={}).el=new t({type:"checkbox",label:s.name,checkFlag:!0}),o.el.addEventListener("buttonclick",function(t){r.filterParams[e][n]=t.dsModel.checkFlag}),r.filterParams[e][n]=!0,o.el.inject(i),this.types[n]=o)},l}),define("DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrixToolbarActions",["DS/CATFLWebMatrix/ExcelExporter","DS/CATFLCockpitWidget/components/ImplementLinks/CATFLTraceabilityMatrixFilter","DS/CATFLCockpitWidget/utils/common.util"],function(e,t,i){"use strict";return{executeToolbarCmd:function(n){var o=n.id,r=n.toolbarCtx,s=r.wrapper,a=s.trMatrix;if("collapse_btn"===o){var l=1!==a.rows.length||a.rows[0].isVisible()?0:1;a.setExpandLevel(l),r.catflGeneratedToolbar.getNodeModelByID("expAll_btn")._associatedView.count=-1}else if("export_btn"===o){var c=e.createXML(a.generateExcelData({prefixes:{}}));i.downloadFile("TraceabilityMatrix.xml",c)}else if("switchMatrix_btn"===o){var d=!s.getOption("inverted");s.setOption("inverted",d),s.createMatrix(),r.catflGeneratedToolbar.getNodeModelByID("expAll_btn")._associatedView.count=-1,s.trMatrix.inject(s.trMatrixContainer)}else"filter_btn"===o&&(r.trMatrixFilter?r.trMatrixFilter.render():r.trMatrixFilter=new t(s,s.container))}}}),define("DS/CATFLCockpitWidget/components/ExportCSV/ExportCSV",["DS/DataGridView/DataGridView","DS/Windows/Dialog","DS/Controls/Button","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/Handlebars/Handlebars","DS/UIKIT/Modal","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/xhr.util","text!DS/CATFLCockpitWidget/components/ExportCSV/ExportCSV.html","text!DS/CATFLCockpitWidget/components/ExportCSV/PreviewFormat.html","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u,p){"use strict";var g=a.getFullConfig(),m={bodyModal:r.compile(d),bodyPreviewFormat:r.compile(u)},f=function(e,t,i){var r=this;r.root={id:e,name:t},r.modelInfo=i,r.container=widget.body,r.render(),r.availableAttributes=new n({useAsyncPreExpand:!0}),r.availableAttributes.addChild([new o({key:"Col0",ds6w:"ds6w:label",bo:!0,grid:{iconType:"object-reference",name:g.nlsBasicAttributesBO["ds6w:label"],declaredIn:p.label_all_levels}}),new o({key:"Col1",ds6w:"ds6wg:revision",bo:!0,grid:{iconType:"object-reference",name:g.nlsBasicAttributesBO["ds6wg:revision"],declaredIn:p.label_all_levels}}),new o({key:"Col2",ds6w:"ds6w:isLastRevision",bo:!0,grid:{iconType:"object-reference",name:g.nlsBasicAttributesBO["ds6w:isLastRevision"],declaredIn:p.label_all_levels}}),new o({key:"Col3",ds6w:"ds6w:label",bo:!1,grid:{iconType:"object-instance",name:g.nlsBasicAttributesBO["ds6w:label"],declaredIn:p.label_all_levels}}),new o({key:"Col4",ds6w:"ds6w:status",bo:!0,grid:{iconType:"object-reference",name:g.nlsBasicAttributesBO["ds6w:status"],declaredIn:p.label_all_levels}}),new o({key:"Col5",ds6w:"ds6w:responsible",bo:!0,grid:{iconType:"object-reference",name:g.nlsBasicAttributesBO["ds6w:responsible"],declaredIn:p.label_all_levels}}),new o({key:"Col6",ds6w:"ds6w:reserved",bo:!0,grid:{iconType:"object-reference",name:g.nlsBasicAttributesBO["ds6w:reserved"],declaredIn:p.label_all_levels}}),new o({key:"Col7",ds6w:"ds6w:created",bo:!0,grid:{iconType:"object-reference",name:g.nlsBasicAttributesBO["ds6w:created"],declaredIn:p.label_all_levels}}),new o({key:"Col8",ds6w:"ds6w:modified",bo:!0,grid:{iconType:"object-reference",name:g.nlsBasicAttributesBO["ds6w:modified"],declaredIn:p.label_all_levels}}),new o({key:"Col9",ds6w:"ds6w:description",bo:!0,grid:{iconType:"object-reference",name:g.nlsBasicAttributesBO["ds6w:description"],declaredIn:p.label_all_levels}}),new o({key:"Col10",ds6w:"ds6w:type",bo:!0,grid:{iconType:"object-reference",name:g.nlsBasicAttributesBO["ds6w:type"],declaredIn:p.label_all_levels}}),new o({key:"Col11",ds6w:"ds6w:identifier",bo:!0,grid:{iconType:"object-reference",name:g.nlsBasicAttributesBO["ds6w:identifier"],declaredIn:p.label_all_levels}}),new o({key:"Col12",ds6w:"ds6wg:architectureextension.v_architecturenumber",bo:!0,grid:{iconType:"object-reference",name:p.label_arch_no,declaredIn:p.label_all_levels}})]);var s=[],a=l.getUserCustomAttributes(),c=l.getUserCustomAttributes(!0);a&&s.push(...a),c&&s.push(...c),s&&s.length>0&&s.forEach(function(e,t){let i;if(e.dimension){var n=g.dimensions[e.dimension];e.manipulationUnit?(e.nls=e.nls+" ("+n.Units[e.manipulationUnit].NLSName+")",i={dimension:e.dimension,manipulationUnit:e.manipulationUnit,MKSUnit:n.MKSUnit}):e.nls=e.nls+" ("+n.Units[n.MKSUnit].NLSName+")"}r.availableAttributes.addChild(new o({key:"UsrCol"+t,ds6w:e.curi,bo:e.bo,UoM:i,grid:{iconType:e.bo?"object-reference":"object-instance",name:e.nls,declaredIn:e.declaredIn}}))}),r.restorePreviousAttributesSelection()};return f.prototype.render=function(){var e=this;e.modal=new s({header:p.action_export,body:m.bodyModal({NLS:p,defaultFileName:e.root.name}),footer:'<button type="button" class="btn btn-primary btn-export">'+p.action_export+'</button><button type="button" class="btn btn-default btn-preview">'+p.label_preview_format+'</button><button type="button" class="btn btn-default btn-close">'+p.cancel_button+"</button>",events:{onHide:function(){this.destroy()}}}).inject(e.container);var t=e.modal.elements.body.querySelector("#export-all-levels"),i=e.modal.elements.body.querySelector("#input-nb-level-exported"),n=e.modal.elements.body.querySelector(".file-name-user-input"),o=e.modal.elements.footer.querySelector(".btn-export"),r=e.modal.elements.footer.querySelector(".btn-preview");t.addEventListener("click",function(e){t.checked?i.disabled=!0:i.disabled=!1});var a=JSON.parse(localStorage.getItem(g.localStorageKeys.exportCSVOptions));null!==a&&(-1!==a.expandLevels&&(t.checked=!1,i.disabled=!1,i.value=a.expandLevels),a.addProposedSolutions||(e.modal.elements.body.querySelector("#export-specification-documents").checked=!1),a.addSpecDocs||(e.modal.elements.body.querySelector("#export-proposed-solution").checked=!1),a.addDiscRef||(e.modal.elements.body.querySelector("#export-discipline-references").checked=!1)),e.modal.elements.body.querySelector(".fonticon-cog").addEventListener("click",function(){e.renderAttributesSelector()}),e.modal.elements.footer.querySelector(".btn-close").addEventListener("click",function(){e.modal.hide()}),r.addEventListener("click",function(){e.renderPreviewFormat()}),n.addEventListener("input",function(e){0===n.value.length?(o.disabled=!0,r.disabled=!0):(o.disabled=!1,r.disabled=!1)}),i.addEventListener("change",function(e){var t=parseInt(i.value,10);isNaN(t)||t<0?i.value=0:i.value=t}),o.addEventListener("click",function(){e.launchExport(),e.modal.hide()}),e.modal.show()},f.prototype.launchExport=function(){var e=this.modal.elements.body.querySelector("#export-all-levels"),t=this.modal.elements.body.querySelector("#input-nb-level-exported"),i=this.modal.elements.body.querySelector(".file-name-user-input").value+".csv",n={root_physicalid:this.root.id,exportSpecDoc:this.modal.elements.body.querySelector("#export-specification-documents").checked,exportProposedSolution:this.modal.elements.body.querySelector("#export-proposed-solution").checked,exportDisciplineReferences:this.modal.elements.body.querySelector("#export-discipline-references").checked,exportFileName:i};if(e.checked?n.expand_iter=-1:n.expand_iter=parseInt(t.value,10),widget.getValue("ngFilter")&&widget.getValue("ngFilter").length>0&&widget.getValue("ngFilter").contains("filterId")){var o=JSON.parse(widget.getValue("ngFilter"));n.ngFilterV2={filterTitle:o.filterTitle,CVQueryV2:o.CVQueryV2}}else if(this.modelInfo&&this.modelInfo.modelVersion&&this.modelInfo.modelVersion.physicalid){var r=widget.getValue("currentConfig").filterCompiledForm,s=this.modelInfo.modelVersion.name+" "+this.modelInfo.modelVersion.revision;if(this.modelInfo.pc&&this.modelInfo.pc.physicalid){var a=this.modelInfo.pc.label?this.modelInfo.pc.label:this.modelInfo.pc.name;a.startsWith("[")&&a.endsWith("]")&&(a=a.slice(1,a.length-1)),s=s+" "+a}n.configFilteringContext={filter_compiledform:r,filter_info:s}}var d=[];this.availableAttributes.getSelectedNodes().forEach(function(e){var t={key:e.options.key,bo:e.options.bo,ds6w:e.options.ds6w,display:e.options.grid.name};e.options.UoM&&(t.UoM=e.options.UoM),d.push(t)}),n.selectedColumns=d,localStorage.setItem(g.localStorageKeys.exportCSVOptions,JSON.stringify({expandLevels:n.expand_iter,addProposedSolutions:n.exportProposedSolution,addSpecDocs:n.exportSpecDoc,addDiscRef:n.exportDisciplineReferences})),c.post(g.webservices.exportCSV,JSON.stringify(n),0).then(function(e){l.downloadFile(i,e,!0)}).catch(function(e){e&&e.errorResp&&l.alertMessage("error",null,e.errorResp.message)}),widget.getValue("ngFilter")&&widget.getValue("ngFilter").length>0&&!widget.getValue("ngFilter").contains("filterId")&&l.alertMessage("warning",null,p.warn_exportcsv_ngfilter_notsaved)},f.prototype.renderAttributesSelector=function(){var n=this;n.restorePreviousAttributesSelection(),n.dialog=new t({title:p.attributes_browser+" - "+p.label_select_attributes,height:500,width:700,resizableFlag:!1,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new i({label:p.save_button,emphasize:"primary",onClick:function(){var e=[];n.dgv.treeDocument.getSelectedNodes().forEach(function(t,i){e.push({ds6w:t.options.ds6w,bo:t.options.bo})}),localStorage.setItem(g.localStorageKeys.exportCSVSelectedColumns,JSON.stringify(e)),n.dialog.close()}}),Close:new i({label:p.cancel_button,emphasize:"secondary",onClick:function(){n.dialog.close()}})}}),n.dialog.addEventListener("close",function(){n.dgv.getNodesXSO().unsubscribe(o),n.dgv.getNodesXSO().unsubscribe(r),n.dialog.destroy()}),n.dgv=new e({identifier:"LogicalProductDefinition_ExportCSV",height:"inherit",treeDocument:n.availableAttributes,selectionBehavior:{unselectAllOnEmptyArea:!1},columns:[{typeRepresentation:"icon",dataIndex:"iconType",width:40},{text:p.label_name,dataIndex:"name"},{text:p.label_declared_in,dataIndex:"declaredIn"}],defaultColumnDef:{typeRepresentation:"string",width:"auto"},onContextualEvent:function(e){var t=[];return e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e,{insertRow:!1,expandCollapse:!0,pin:!0,firstColumnsVisibility:!1,columnsManagement:!1})),t},getCellTooltip:function(e){return e.nodeModel&&0===e.columnID?{shortHelp:e.nodeModel.options.bo?p.label_declared_in_reference:p.label_declared_in_instance,updateModel:!1}:n.dgv.getCellDefaultTooltip(e)}}),n.dialog.elements._contentDiv.appendChild(n.dgv.getContent()),n.dgv.treeDocument.setFilterModel({name:{filterId:"stringRegexp"},declaredIn:{filterId:"stringRegexp"}});var o=n.dgv.getNodesXSO().onPostAdd(n.updateAttributesSelectorSaveButtonDisabledState.bind(n)),r=n.dgv.getNodesXSO().onPostRemove(n.updateAttributesSelectorSaveButtonDisabledState.bind(n))},f.prototype.restorePreviousAttributesSelection=function(){this.availableAttributes.unselectAll();var e=JSON.parse(localStorage.getItem(g.localStorageKeys.exportCSVSelectedColumns));null===e?this.availableAttributes.selectAll():this.availableAttributes.getAllDescendants().forEach(function(t){for(var i=0;i<e.length;i++)e[i].ds6w===t.options.ds6w&&e[i].bo===t.options.bo&&t.select()})},f.prototype.updateAttributesSelectorSaveButtonDisabledState=function(){0===this.availableAttributes.getSelectedNodes().length?this.dialog.buttons.Ok.disabled=!0:this.dialog.buttons.Ok.disabled=!1},f.prototype.renderPreviewFormat=function(){var o=this,r=o.modal.elements.body.querySelector(".file-name-user-input").value,s={fileName:0===r.length?"":r+".csv",exportedBy:a.getUser("isFullName"),exportedOn:(new Date).toLocaleString("fr-FR",{timeZone:"UTC"}),exportSpecDocs:o.modal.elements.body.querySelector("#export-specification-documents").checked?p.label_yes:p.label_no,exportProposedSolutions:o.modal.elements.body.querySelector("#export-proposed-solution").checked?p.label_yes:p.label_no,exportDiscRef:o.modal.elements.body.querySelector("#export-discipline-references").checked?p.label_yes:p.label_no},l=o.modal.elements.body.querySelector("#export-all-levels"),c=o.modal.elements.body.querySelector("#input-nb-level-exported");l.checked?s.expandLevels=p.label_all_levels:s.expandLevels=parseInt(c.value,10),widget.getValue("ngFilter")&&widget.getValue("ngFilter").length>0&&widget.getValue("ngFilter").contains("filterId")?s.appliedConfiguration=JSON.parse(widget.getValue("ngFilter")).filterTitle:o.modelInfo&&o.modelInfo.model&&o.modelInfo.model.physicalid?o.modelInfo.modelVersion&&o.modelInfo.modelVersion.physicalid?(s.appliedConfiguration=o.modelInfo.modelVersion.name+" "+o.modelInfo.modelVersion.revision+" ",o.modelInfo.pc&&o.modelInfo.pc.physicalid?s.appliedConfiguration+=o.modelInfo.pc.name:s.appliedConfiguration+=p.label_all):s.appliedConfiguration=p.label_all_models:s.appliedConfiguration=p.label_none,o.dialog=new t({title:p.label_preview,height:460,width:700,resizableFlag:!1,modalFlag:!0,immersiveFrame:widget.immersiveFrame,content:m.bodyPreviewFormat({NLS:p,infos:s}),buttons:{Ok:new i({label:p.action_export,emphasize:"primary",onClick:function(){o.launchExport(),o.dialog.close(),o.modal.hide()}}),Close:new i({label:p.cancel_button,emphasize:"secondary",onClick:function(){o.dialog.close()}})}}),o.dialog.addEventListener("close",function(){o.dialog.destroy()}),o.dialog.elements.container.classList.add("flweb-cockpit-export-csv-preview-format");var d=[];o.restorePreviousAttributesSelection(),o.availableAttributes.getSelectedNodes().forEach(function(e){var t={text:e.options.grid.name,dataIndex:e.options.key};e.options.bo||(t.icon={iconName:"object-instance"}),d.push(t)}),o.dgv=new e({identifier:"LogicalProductDefinition_ExportCSV_PreviewFormat",height:"inherit",treeDocument:new n({useAsyncPreExpand:!0}),rowSelection:"none",columns:d,placeholder:p.label_preview_warning_values_filled_at_actual_export,defaultColumnDef:{typeRepresentation:"string",width:"auto"},onContextualEvent:function(e){return!1}}),o.dialog.elements._contentDiv.querySelector(".dgv-container").appendChild(o.dgv.getContent())},f}),define("DS/CATFLCockpitWidget/components/ArchitectureNumber/monoInstantiationStatus",["DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/config.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n){"use strict";var o=i.getFullConfig();return{downloadStatus:function(i,r,s){this.root={id:i},this.container=widget.body;var a=r+"_"+n.label_mono_nstantiation_filename+".csv",l={root_physicalid:this.root.id,exportFileName:a};if(s&&s.modelVersion&&s.modelVersion.physicalid){var c=widget.getValue("currentConfig").filterCompiledForm,d=s.modelVersion.name+" "+s.modelVersion.revision;s.pc&&s.pc.physicalid&&(d=d+" "+s.pc.label),l.configFilteringContext={filter_compiledform:c,filter_info:d}}t.post(o.webservices.exportMonoInstantiationStatus,JSON.stringify(l),0).then(function(t){e.downloadFile(a,t,!0),e.alertMessage("success",null,n.msg_arch_unicity_export_success)}).catch(function(t){t&&t.errorResp&&e.alertMessage("error",null,t.errorResp.message)})}}}),define("DS/CATFLCockpitWidget/services/thumbnail.service",["DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/WAFData/WAFData"],function(e,t,i,n){"use strict";var o=i.getFullConfig();i.getFullConfig().webservices.getCSRFToken;return{createFCSTicket:function(){var t=o.webservices.generateFCSTicket;return e.makeServiceCall(t,"PUT")},checkInThumbNail:function(e,t,i){var n=this,o={};o.method=i,o.headers={},t&&(o.data=t);return new Promise(function(t,i){n.createPromiseFunction(e,o,t,i)})},createPromiseFunction:function(e,t,o,r){t.onComplete=o,t.onFailure=r,t.onTimeout=r,e.indexOf("?")>=0?e+="&tenant="+i.getTenant():e+="?tenant="+i.getTenant(),n.authenticatedRequest(e,t)}}}),define("DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrix",["DS/Menu/Menu","DS/CATFLWebMatrix/TraceabilityMatrix","DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrixToolbar","DS/CATFLCockpitWidget/components/ConfirmationWindow_Generic/ConfirmationWindow","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/services/implementlink.service","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a){"use strict";var l=JSON.parse(s);return{init:function(e){var n=this;n.field={inverted:!1,expandLevel:0},n.firstSystem=e.system1,n.secondSystem=e.system2,n.linkType=e.linkType,n.typesMap=e.typesMap,n.trMatrixModelEvents=e.modelEvents;var r=n.container=UWA.createElement("div",{class:"trmatrix-main-container"}),s=UWA.createElement("div",{class:"trmatrix-toolbar-container"}).inject(r);if(n.trMatrixToolbar=new i(n,s),n.trMatrixContainer=UWA.createElement("div",{class:"traceability-matrix-container"}).inject(r),n.field.rows=[],n.field.columns=[],n.firstSystem.getChildren()&&n.secondSystem.getChildren())return n.firstSystem.getChildren().forEach(function(e){n.field.rows.push(n.generateStructure(e,!0))}),n.secondSystem.getChildren().forEach(function(e){n.field.columns.push(n.generateStructure(e,!1))}),t.resetRefRefMap(),n.createMatrix(),n.trMatrix&&n.trMatrix.inject(n.trMatrixContainer),r;o.alertMessage("error",null,"",a.msg_system_missing_children)},createMatrix:function(){var e=this;e.trMatrix&&e.trMatrix.container.remove();var i={rows:e.field.inverted?e.field.columns:e.field.rows,columns:e.field.inverted?e.field.rows:e.field.columns},o={onContextMenu:e.manageContextualMenuEvt.bind(e),onNewCell:e.manageCellDisplay.bind(e)};e.trMatrix=new t.Matrix(i,o),e.trMatrix.onCellSelected=function(i,o,r){if(t.Matrix.prototype.onCellSelected.call(this,i,o,r),!e.trMatrix.loading&&i&&i.getState()===t.CellState.NORMAL)if(i.relations.length>0){var s=o.data&&o.data.name?o.data.name:"",l=r.data&&r.data.name?r.data.name:"",c=UWA.createElement("p",{html:a.msg_delete_implementLink_confrimation+s+" & "+l});n.createWindow(e.container,a.label_delete_implementLink_header,c,a.action_delete,e.deleteImplementLink.bind(e,i,o,r))}else e.createImplementLink(i,o,r)}},generateStructure:function(e,t){var i,n,o=e.options.label||e.options.grid.name;o+=" "+e.options.grid.revision,e.options.instance&&e.options.instance.name&&(o+="("+e.options.instance.name+")"),i={id:e.options.instance?e.options.instance.physicalid:e.options.physicalid,type:e.options.instance.type,name:o+" "+e.options.grid.revision,refId:e.options.physicalid,refType:e.options.grid.actualType,node:e,isContext:t,children:[],relations:e.relations};var r=e.getChildren();if(r)for(n=0;n<r.length;n++)i.children.push(this.generateStructure(r[n],t));return i},_setLoading:function(e){this.trMatrix.loading=e,this.trMatrix.table.toggleClass("loading",e)},createImplementLink:function(e,i,n){var s=this;e.setState(t.CellState.LOADING),s._setLoading(!0);var l=s.formDataObjFromCell(i,n);r.createOccurrenceLinks(l).then(function(r){var c={id:e.id};c.path=i.getPath(),s._setLoading(!1),e.setState(t.CellState.NORMAL),e.addRelation(c),s.trMatrix.registerRelation(i,n,c);var d={};i.data.isContext?(d.firstSystemNode=i.data.node,d.secondSystemNode=n.data.node,d.ctxPath=l[0].implementing):(d.secondSystemNode=i.data.node,d.firstSystemNode=n.data.node,d.ctxPath=l[0].implemented),s.trMatrixModelEvents.publish({event:"occLink-refresh",data:d}),o.alertMessage("success",null,"",a.msg_occ2occ_create_success)})},deleteImplementLink:function(e,i,n){var s=this;e.setState(t.CellState.LOADING),s._setLoading(!0);var l=s.formDataObjFromCell(i,n);r.deleteOccurrenceLinks(l).then(function(r){s._setLoading(!1),e.setState(t.CellState.NORMAL);var c=e.relations[0];e.removeRelation(c),s.trMatrix.unregisterRelation(i,n,c);var d={};i.data.isContext?(d.firstSystemNode=i.data.node,d.secondSystemNode=n.data.node,d.ctxPath=l[0].implementing):(d.secondSystemNode=i.data.node,d.firstSystemNode=n.data.node,d.ctxPath=l[0].implemented),s.trMatrixModelEvents.publish({event:"occLink-refresh",data:d}),o.alertMessage("success",null,"",a.msg_delete_link_success)})},formDataObjFromCell:function(e,t){var i,n,o=this.getPathFromNodeToRoot(e.data.node,[]),r=this.getPathFromNodeToRoot(t.data.node,[]),s=o.path,a=r.path,l=[];return o.root===this.firstSystem.options.physicalid?(i=s,n=a):(i=a,n=s),"implementing"===this.linkType?l.push({implementing:i,implemented:n}):l.push({implementing:n,implemented:i}),l},getPathFromNodeToRoot:function(e,t){return e.isRoot()?(t.reverse(),{path:t,root:e.options.physicalid}):(t.push(e.options.instance.physicalid),this.getPathFromNodeToRoot(e.getParent(),t))},manageCellDisplay:function(e,i,n){i.data.refType!==l.type_chapter&&n.data.refType!==l.type_chapter||e.setState(t.CellState.DISABLED)},manageContextualMenuEvt:function(t,i){e.show(this.getContextualMenu(t),{input:"mouse",position:{x:i.pageX,y:i.pageY},submenu:"auto"})},getContextualMenu:function(e){var t=this;return[{type:"PushItem",title:a.action_set_root,fonticon:{content:"wux-ui-3ds wux-ui-3ds-open"},action:{callback:function(){t.trMatrix.setCurrentRoot(e)}}}]},getOption:function(e){if(this.field&&this.field.hasOwnProperty(e))return this.field[e]},setOption:function(e,t){this.field||(this.field={}),this.field[e]=t}}}),define("DS/CATFLCockpitWidget/CATFLCockpitWidgetMain",["DS/CATFLCockpitWidget/CATFLCockpitWidgetComponent","DS/CATFLCockpitWidget/services/config.service","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/components/SecurityContextSelector/securityContextSelectionWindow","DS/WUXAutoComplete/AutoComplete","DS/CATFLCockpitWidget/utils/preferences.util","DS/PlatformAPI/PlatformAPI","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget","css!DS/CATFLCockpitWidget/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l){"use strict";var c=i.getFullConfig(),d=c.localStorageKeys,u=c.identifiers;return{onLoad:function(){var a=widget.body;a.empty(),void 0===widget.getValue(d.componentView)&&widget.setValue(d.componentView,d.structuredView),widget.getValue("configurable_expand")||widget.setValue("configurable_expand",{refDocs:!0,specDocs:!0,proposedSolution:!0,implementedBy:!0,isImplementedBy:!0,implementing:!0,isImplementing:!0}),i.getPlatformServices().then(function(c){var d=[];if(d.push(i.retrieveCurrentUser()),d.push(i.retrieveCSRFToken()),d.push(s.getNSaveUserCustomAttributes()),d.push(s.getNSaveUserCustomAttributes(!0)),i.refreshCSRFToken(),c&&c.optionList&&!c.defaultValue&&!i.getSecurityContext()){n.alertMessage("info",null,l.msg_noPrefCredWarning);var u=UWA.createElement("div",{styles:{width:"100%",display:"flex"}}),p=UWA.createElement("div",{html:l.msg_selectPrefCredential,styles:{flex:.4,"padding-right":"10px","font-weight":"bold"}}),g=UWA.createElement("div",{styles:{flex:.6}}),m=new r({elementsTree:c.optionList,multiSearchMode:!1,allowFreeInputFlag:!1,allowResetToUndefinedByUIFlag:!1});p.inject(u),m.inject(g),g.inject(u),o.createWindow(widget.body,l.label_secCtxSelectCmpntHeader,u,l.set_button,function(){var r=m.value;r&&""!=r?(c.defaultValue=r,s.buildPreferences({credentialList:c}).then(function(){widget.setValue("widgetSecCtxPref",r),o._closeConfirmWindow(),Promise.all(d).then(function(){t.extendConfiguration(i.getFullConfig()).finally(function(){e.init(widget.body)})})})):n.alertMessage("error",null,null,l.msg_selectCredential)})}else{if(!1===c){var f=UWA.createElement("div",{styles:{height:"100%",width:"100%","font-size":"14px",display:"flex","flex-direction":"column"}}),h=UWA.createElement("div",{styles:{margin:"auto",width:"60%",padding:"10px"}}),v=UWA.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-3x wux-ui-3ds-alert",styles:{height:"100%",float:"left","padding-right":"9px","padding-top":"5px",color:"#77797C"}}),C=UWA.createElement("div",{html:l.label_widgetError+"<br>"+l.label_noCredentialError,styles:{"font-size":"18px",color:"#77797C",height:"100%"}});return v.inject(h),C.inject(h),h.inject(f),f.inject(a),1}c.defaultValue||""==i.getSecurityContext()||(c.defaultValue=i.getSecurityContext()),s.buildPreferences({credentialList:c}).then(function(){Promise.all(d).then(function(){t.extendConfiguration(i.getFullConfig()).finally(function(){e.init(widget.body)})})})}})},onRefresh:function(){widget.body.empty(),a.publish("NGFilter.RemoveConfigurationRevision_"+widget.id),e.init(widget.body),enoviaServerFilterWidget&&(enoviaServerFilterWidget.tenant=i.getTenant())},endEdit:function(){n.getUserWorkUnderPositionPref()===u.workUnder_pos_freeValue?n.setCfgAuthoringContextDragEvent():n.unsetCfgAuthoringContextDragEvent()}}}),define("DS/CATFLCockpitWidget/components/WIWItemCreationModal/WIWItemCreationModal",["UWA/Core","DS/UIKIT/Mask","DS/Windows/Dialog","DS/Controls/Toggle","DS/Controls/Button","DS/CATFLCockpitWidget/components/WIWItemCreationModal/WIWItemCreationModalView","DS/Handlebars/Handlebars4","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/architectureNumber.util","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/UIKIT/Autocomplete","DS/CATFLCockpitWidget/services/model.service","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","text!DS/CATFLCockpitWidget/components/WIWItemCreationModal/WIWItemCreationModal.html","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,g,m,f,h,v){f=JSON.parse(f);return{init:function(e,t,i){return this.windowTitle=t.winInfo.title,this.okBtnTxt=t.winInfo.submitBtn,this.action=t.winInfo.action,this.changeControl=t.changecontrol,this.cfgCtxInfo=i,this.duplicateP2LWarningIDs={},this.activeModel=null,this.activeModelVersion=null,this.createModal(e,t),"createLogRefFromDiagram"===this.action&&(this.instanceCount=t.instanceCount,this.previousModelVersion=JSON.parse(localStorage.getItem("flwebcockpit-selectedModelVersion-"+t.SelectionContext.LinkedSystem)),this.cfgCtxInfo.bCopyEff&&this.addCopyEffView(),this.cfgCtxInfo.bApplyConfig&&this.pushSelectModelVerView(t.SelectionContext.LinkedSystem)),this.pushSetArchView(t)},createModal:function(e,i){let n=this,r=s.compile(h),a=!!n.cfgCtxInfo&&n.cfgCtxInfo.bCopyEff,l=!!n.cfgCtxInfo&&n.cfgCtxInfo.bApplyConfig,d=UWA.createElement("div",{html:r({copyEff:a,workUnderEvol:l,workUnderEvolTitle:v.action_apply_evol_eff}),class:"wiw-set-architecture-number"});d.getElement(".table-wrapper").setStyles({"padding-bottom":"20px"}),d.inject(e),n.modalWindow=e;let p=n.modalWindow.getElement(".wiw-footer");if(new o({label:n.okBtnTxt,emphasize:"primary",onClick:function(e){n.architectureIdMap=[];let i,o,r=0,s=[],a=n.modalWindow.getElements(".item-row"),l=null,d=null;t.mask(n.modalWindow);let u={};for(let e=0;e<a.length;e++){let t={},p=a[e];if(!p.getChildren()[0].getAttribute("status")||"ko"===p.getChildren()[0].getAttribute("status")){r++;continue}let g,m=p.getAttribute("data-id");i=p.querySelectorAll('[required = "true"]'),o=!1;for(let e=0;e<i.length;e++){let t=i[e];if("true"===t.getAttribute("editable"))if(""==t.getElement("input").value.trim()){t.getElement("input").scrollIntoView(),t.getElement("input").addClassName("errordiv"),c.alertMessage("error",null,v.req_field_error_header,t.getAttribute("name")+v.arch_number_required_field),o=!0;break}}if(o)break;g=p.getElement(".archidcell")?p.getElement(".archidcell").getHTML():p.querySelector('[architectureidcolumn = "true"]').getElement("input").value.trim();let f=null,h=null,C={};p.getChildren().forEach(function(e){if("true"===e.getAttribute("architectureidcolumn")){if(f=e.getAttribute("id"),"true"===e.getAttribute("editable")){let t=e.getChildren()&&e.getChildren()[0];h=t.dsModel.value}else h=e.getHTML();C[f]=h}}),"createLogRefFromDiagram"===n.action?(m=p.getAttribute("data-id"),u[l=p.getAttribute("data-instance")]=g,d=p.getAttribute("data-type"),t.referenceID=m,t.instanceID=l,t.ArchitectureNumber=g,d&&(t.logicalRefType=d),t.addRefRef=p.getAttribute("addRefRef"),t.ArchitectureNumberTokens=C,n.architectureIdMap.push(t)):"setArcNumPhysical"===n.action&&(s.push(p.getAttribute("data-id")),p.getChildren()[0].hasClassName("archNo-td-checkbox")&&(m=p.getAttribute("data-id"),l=p.getAttribute("data-instance"),n.architectureIdMap.push({referenceID:m,instanceID:l,ArchitectureNumber:g,ArchitectureNumberTokens:C})))}if(r===a.length&&(c.alertMessage("error",null,v.log_ref_selection_error),o=!0),o)t.unmask(n.modalWindow);else if("createLogRefFromDiagram"===n.action)n.createLogRefServiceCall(u);else if("setArcNumPhysical"===n.action){var p={architectureNumbers:n.architectureIdMap};n.callPromiseService(p,s)}}}).inject(p),i.showBulkRecomputation&&"createLogRefFromDiagram"===n.action)new o({label:v.label_reEvaluate_ArchNo,onClick:function(e){u.executeRecompute({isWIWcall:!0,an_action:i.AN_ACTION,rows:n.modalWindow.getElement(".itemDetails").getChildren("tr"),SelectionContext:i.SelectionContext})}}).inject(p);new o({label:v.cancel_button,emphasize:"secondary",onClick:function(e){n.modalWindow.destroy(),window.dscef&&("createLogRefFromDiagram"===n.action?dscef.sendString("createLogicalReferencesFromDiagramCanceledNotif"):"setArcNumPhysical"===n.action&&dscef.sendString("setArchitectureNumberOnPSpoolCanceledNotif"))}}).inject(p);n.modalWindow.addEventListener("close",function(e){window.dscef&&(dscef.sendString("createLogicalReferencesFromDiagramClosedNotif"),"createLogRefFromDiagram"===n.action?dscef.sendString("createLogicalReferencesFromDiagramCanceledNotif"):"setArcNumPhysical"===n.action&&dscef.sendString("setArchitectureNumberOnPSpoolCanceledNotif"))})},createLogRefServiceCall:function(e){(i=this).instanceCount&&i.instanceCount>100&&c.alertMessage("warning",null,v.msg_manyItemsToItemize);var t={},i=this;t.SelectionContext=i.collection.SelectionContext,t.ListSelectedInstances=i.architectureIdMap,t.AN_ACTION=i.collection.AN_ACTION,i.activeModelVersion&&i.activeModelVersion.physicalid?l.applyWorkUnderEvolution({model:i.activeModel,modelVer:i.activeModelVersion},!0).then(function(n){i.callPromiseService(t,e),localStorage.setItem("flwebcockpit-selectedModelVersion-"+i.collection.SelectionContext.LinkedSystem,JSON.stringify({modelVersion:i.activeModelVersion.physicalid}))}):i.callPromiseService(t,e)},callPromiseService:function(e,t){if("createLogRefFromDiagram"===this.action){var i=[];for(var n in this.duplicateP2LWarningIDs){this.duplicateP2LWarningIDs[n]===t[n]&&i.push(n)}e.ignoreP2LWarningIDs=i,this.duplicateP2LWarningIDs={},this.changeControl&&d.setAuthIDforWIW("change",this.changeControl),a.createItemFromDialogue(e,0).then(this.createFromDiagramServiceCallback.bind(this,t),this.serviceCallFailureFunction.bind(this))}else"setArcNumPhysical"===this.action&&(this.removeCSS(t),a.setArchitectureNumberOnPSpool(e,0).then(this.setArchitectureNumberOnPSpoolServiceCallback.bind(this),this.serviceCallFailureFunction.bind(this)))},setArchitectureNumberOnPSpoolServiceCallback:function(e){var i=JSON.parse(e);if(200===i.status){c.alertMessage("success",null,"",v.msg_set_arch_num_onP),this.modalWindow.destroy();var n={status:200,ModifiedPReferences:[]};for(var o in i)1==i[o]&&n.ModifiedPReferences.push(o);window.dscef&&dscef.sendString("setArchitectureNumberOnPSpoolEndNotif",JSON.stringify(n))}else if(400===i.status){var r,s=null,a=this.modalWindow.getElement(".itemDetails").getElements("tr"),l=[],d=[];a.forEach(function(e){var t=e.getAttribute("data-id");"NOCSGROUP"==i[t]||"FROZEN_REV"==i[t]||"NO_MODIFY_ACCESS"==i[t]?l.push(t):"KO"!=i[t]&&"UNICITY_KO"!=i[t]||d.push(t)}),l.length>0?(s="errordiv",this.setCSS(l,s),r={type:"error",message:v.msg_error_set_architecture_number_unselect_reference}):d.length>0?(s="errordiv",this.setCSS(d,s),r={type:"error",message:v.arch_number_unique_error}):r={type:"error",message:v.msg_set_arch_num_failed},r&&(t.unmask(this.modalWindow),c.alertMessage(r.type,null,"",r.message))}},setCSS:function(e,t){var i=this;e.forEach(function(e){var n=i.modalWindow.getElement('.itemDetails tr[data-id ="'+e+'"]'),o=n.getElement(".archidcell");if(t)if(o)o.addClassName(t),o.setStyle("color","#EA4F37"),o.scrollIntoView();else{var r=n.querySelector('[architectureidcolumn = "true"]');o.addClassName(t),r.getElement("input").setStyle("color","#EA4F37"),r.getElement("input").scrollIntoView()}else{if(!o)o=(r=n.querySelector('[architectureidcolumn = "true"]')).getElement("input");o.hasClassName("errordiv")&&o.setStyle("color","hsl(0, 0%, 0%)")}})},removeCSS:function(){for(var e=this.modalWindow.getElement(".itemDetails").getElements("tr"),t=0;t<e.length;t++)for(var i=0;i<e[t].getChildren().length;i++)e[t].getChildren()[i].hasClassName("archidcell errordiv")&&(e[t].getChildren()[i].removeClassName("errordiv"),e[t].getChildren()[i].setStyle("color","hsl(0, 0%, 0%)"))},createFromDiagramServiceCallback:function(e,i){var n=JSON.parse(i),o=this;if(200===n.status)if(o.copyEffToggle&&o.copyEffToggle.checkFlag){let e=Object.keys(o.cfgCtxInfo.mapIdToItemModel),t=[],i={},r=[];e.forEach(function(e){t.push({pid:e})}),m.getEffectivityInfo(o.cfgCtxInfo.instIds,"XML").then(function(e){let s=e;if(s){for(let e in s){let t=[],n=s[e];if("YES"===n.hasEffectivity){let o=n.content.Evolution&&n.content.Evolution.Current?n.content.Evolution.Current:null;o&&t.push({domain:"Evolution",content:o}),i[e]=t}}n.ImplementLinks.forEach(function(e){i[e.discipline.instanceID]&&r.push({pid:e.item.instanceID,expressions:i[e.discipline.instanceID]})}),r&&r.length>0?m.setMultipleFilterableObjectInfo(r,t).then(function(){c.alertMessage("success",null,"",v.create_log_ref_from_dialog_success),o.modalWindow.destroy(),window.dscef&&dscef.sendString("createLogicalReferencesFromDiagramEndNotif",JSON.stringify(n))},function(e){c.displayError(e,null,null,v.msg_error_wiw_copy_eff_failed),o.modalWindow.destroy(),window.dscef&&dscef.sendString("createLogicalReferencesFromDiagramEndNotif",JSON.stringify(n))}):(c.alertMessage("success",null,"",v.create_log_ref_from_dialog_success),o.modalWindow.destroy(),window.dscef&&dscef.sendString("createLogicalReferencesFromDiagramEndNotif",JSON.stringify(n)))}else c.alertMessage("success",null,"",v.create_log_ref_from_dialog_success),o.modalWindow.destroy(),window.dscef&&dscef.sendString("createLogicalReferencesFromDiagramEndNotif",JSON.stringify(n))})}else c.alertMessage("success",null,"",v.create_log_ref_from_dialog_success),o.modalWindow.destroy(),window.dscef&&dscef.sendString("createLogicalReferencesFromDiagramEndNotif",JSON.stringify(n));else if(400===n.status){var r=o.modalWindow.getElement(".itemDetails").getElements("tr"),s=!1,a=!1,l=!1,d=null,u=null;r.forEach(function(t){var i=t.getAttribute("data-instance");"NON_COMPLIANCE"===n[i]?(u=!0,d="#EA4F37"):"NOCSGROUP"==n[i]?(l=!0,d="#844138"):"UNICITY_KO"==n[i]?(s=!0,d="#EA4F37"):"P2L_DUPLICATE_WARNING"==n[i]?(o.duplicateP2LWarningIDs[i]=e[i],a=!0,d="#E87B00"):d=null;var r=t.getElement(".archidcell");if(d){if(r)r.addClassName("errordiv"),r.setStyle("color",d),r.scrollIntoView();else(c=t.querySelector('[architectureidcolumn = "true"]')).getElement("input").setStyle("color",d),c.getElement("input").scrollIntoView()}else{var c;if(!r)r=(c=t.querySelector('[architectureidcolumn = "true"]')).getElement("input");r.setStyle("color","hsl(0, 0%, 0%)")}}),u?(t.unmask(o.modalWindow),c.alertMessage("error",null,"",v.msg_arch_number_non_compliance)):l?(t.unmask(o.modalWindow),c.alertMessage("error",null,"",v.msg_error_set_architecture_number_nocsgroup)):s?(t.unmask(o.modalWindow),c.alertMessage("error",null,"",v.arch_number_unique_error)):a?(t.unmask(o.modalWindow),c.alertMessage("warning",null,"",v.msg_error_create_fromDiagram_p2lwarning)):c.alertMessage("error",null,"",v.msg_set_arch_num_failed)}else t.unmask(o.modalWindow),c.alertMessage("error",null,"",v.instance_creation_failed)},serviceCallFailureFunction:function(e){window.dscef&&(e.error&&e.error.message&&e.error.message.contains("timedout")?dscef.sendString("createLogicalReferencesFromDiagramRequestTimedoutNotif"):dscef.sendString("createLogicalReferencesFromDiagramRequestFailedNotif"));var i="";e.errorResp&&e.errorResp.message?i=e.errorResp.message:e.error&&e.error.message?i=e.error.message:e.message&&(i=e.message),t.unmask(this.modalWindow),c.alertMessage("error",null,"",i)},addCopyEffView:function(){var e=this,t=e.modalWindow.getElement(".copy-effectivity");e.copyEffToggle=new n({type:"switch",label:v.action_copy_effectivity,checkFlag:!0}).inject(t),e.copyEffToggle.addEventListener("change",function(t){let i=e.modVerAutoComplete.isDisabled();e.copyEffToggle.checkFlag?(!i&&e.modVerAutoComplete.setDisabled(!0),e.modVerAutoComplete.unselectAll(),e.activeModelVersion=null,d.setAuthIDforWIW("evolution",null),e._WIWItemCreationModalView.applyCopyEffectivity()):(i&&e.modVerAutoComplete.setDisabled(!1),e._WIWItemCreationModalView.resetApplicableEvolution())})},pushSelectModelVerView:function(e){var t=this;let i=t.cfgCtxInfo.itemModels;t.cfgCtxInfo.mapIdToItemModel={};var n=t.modalWindow.getElement(".config-selection").getElement(".autoCompleteSection");t.modVerAutoComplete=new g({showSuggestsOnFocus:!0,placeholder:v.ph_header_config_modver,disabled:t.cfgCtxInfo.bCopyEff,events:{onSelect:function(e){let i=t.cfgCtxInfo.mapIdToItemModel[e.model];t.activeModel={physicalid:i.physicalid,name:i.name},t.activeModelVersion={physicalid:e.physicalid?e.physicalid:e.modelVersionID,name:e.name?e.name:e.modelVersionName,revision:e.revision,backEndName:e.backEndName},t._WIWItemCreationModalView.applySelectedConfiguration(e)},onUnselect:function(){this.selectedItems&&0===this.selectedItems.length&&(t.activeModel=null,t.activeModelVersion=null,d.setAuthIDforWIW("evolution",null),t._WIWItemCreationModalView.resetApplicableEvolution())}}});let o=[],r=[];i.forEach(e=>{r.push(e.physicalid),t.cfgCtxInfo.mapIdToItemModel[e.physicalid]=e,o.push(m.getModelVersionFromModelPID(e))}),Promise.all(o).then(function(e){let i=[],o=[];e.forEach((e,t)=>{let n=r[t];e.forEach(e=>{o.indexOf(e.id)<0&&i.push({modelVersionID:e.id,modelVersionName:e.attributes.MarketingName,revision:e.revision,value:e.attributes.MarketingName+" "+e.revision,subLabel:e.current_NLS,backEndName:e.name,model:n})})}),t.modVerAutoComplete.addDataset({name:"model_version_select_data",items:i}),!t.cfgCtxInfo.bCopyEff&&t.previousModelVersion&&t.previousModelVersion.modelVersion&&t._retrieveModelVersionFromDataset(t.previousModelVersion.modelVersion),t.modVerAutoComplete.inject(n)})},pushSetArchView:function(e){return this.collection=e,this._WIWItemCreationModalView=new r({collection:e,cfgCtxInfo:this.cfgCtxInfo}),this._WIWItemCreationModalView.render(this.modalWindow),this.modalWindow},_retrieveModelVersionFromDataset:function(e){var t=this;e&&e.indexOf("pid")>=0&&(e=e.substring(4)),t.modVerAutoComplete.datasets.forEach(function(i){i.items.forEach(function(i){if(i.modelVersionID.indexOf("pid")>=0&&(i.modelVersionID=i.modelVersionID.substring(4)),i.modelVersionID===e)return t.modVerAutoComplete.onSelect(i),void t.modVerAutoComplete.dispatchEvent("onSelect",[i])})})}}}),define("DS/CATFLCockpitWidget/services/modeler.service",["DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/pno.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/group.util","DS/CATFLCockpitWidget/services/dimensions.service","DS/CATFLCockpitWidget/parser/database.parser","WebappsUtils/WebappsUtils","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l){"use strict";var c=t.getFullConfig();return{expand:function(t){var i=c.webservices.dsfl_getLogItem+"structure",o=t.depth?t.depth:"0",r=s.defaultExpandParser,a=t.parser?t.parser:r,d={physicalids:t.itemIDs,depthLevel:o,filterExpression:t.configFilter};return n.post(i,JSON.stringify(d),0).then(function(e){return a(JSON.parse(e).rootObjects,t.itemIDs)}).catch(function(t){var i=t.error.message.slice(t.error.message.indexOf("ResponseCode")),n=l.error_get_structure;i&&i.indexOf("404")>=0&&(n=l.error_get_structure_media),e.displayError(t,null,null,n)})},getAttributes:function(t){var i=c.webservices.dsfl_getLogItem+t.itemID+"/attributes",o=t.parser?t.parser:s.defaultExpandParser;return n.get(i).then(function(e){return o(JSON.parse(e).rootObjects,[t.itemID]).then(function(e){if(e&&e[t.itemID]){var i=e[t.itemID];return i.map[i.rootUuid]}})}).catch(function(t){var i=t.error.message.slice(t.error.message.indexOf("ResponseCode")),n=l.error_get_logitem;i&&i.indexOf("404")>=0&&(n=l.error_get_logitem_media),e.displayError(t,null,null,n)})},getInstanceAttributes:function(t){var i=c.webservices.dsfl_getLogItem+t.parentID+"/dslog:LogInstance/"+t.instID+"/attributes",o=t.parser?t.parser:s.defaultInstanceParser;return n.get(i).then(function(e){let i=o(JSON.parse(e).rootObjects,[t.instID]);if(i&&i[t.instID]){var n=i[t.instID];return n.map[n.rootUuid]}}).catch(function(t){var i=t.error.message.slice(t.error.message.indexOf("ResponseCode")),n=l.error_get_logitem;i&&i.indexOf("404")>=0&&(n=l.error_get_logitem_media),e.displayError(t,null,null,n)})},defaultCRSParser:function(t){return{physicalid:t.id,label:t.title,type:t.type,grid:{kindOfRFLP:t.kindOfRFLP,revision:t.revision,description:t.description,name:t.name,type:t.typeNLS||t.type,actualType:t.type,creationDate:e.formatDate(t.created),modificationDate:e.formatDate(t.modified),maturity:t.state,owner:t.owner,architectureNumber:t.architectureNumber}}},refreshTreeNodeModel:function(i,n,o){var s=this,a=[];let l,d={},u=[],p=e.getUserCustomAttributes();return p&&p.forEach(function(e){e.manipulationUnit&&e.manipulationUnit!==c.dimensions[e.dimension].MKSUnit?d[e.curi]=e:e.manipulationUnit&&u.push(e.curi)}),o&&(l=o.getGroupingOptions()),Object.keys(i).forEach(function(e){var l=i[e];n&&t.SAXStorage().setItem(c.localStorageKeys.recentlyAuthored+e,Date.now()),a.push(new UWA.Promise(function(t,i){s.getAttributes({itemID:e}).then(function(i){if(l&&l.length<=0&&(l=o.treeDocument.getMappedNodesFromId(e)),i.attributes&&i.attributes.grid)if("#DENIED!"===i.attributes.grid.owner)l.forEach(function(e){e.getParent().removeChild(e)}),t();else{let e=[],n=[];for(let t in d){let o=d[t];if(""===i.attributes.grid[t]&&i.attributes.grid[t+"_actual"]){let r;o.multiValuated&&Array.isArray(i.attributes.grid[t+"_actual"])?0===(r=i.attributes.grid[t+"_actual"]).length?r=[(r=0).toString()]:r.map(e=>e.toString()):r=[(r=+i.attributes.grid[t+"_actual"]||0).toString()],e.push({UnitFrom:c.dimensions[o.dimension].MKSUnit,UnitTo:o.manipulationUnit,Dimension:o.dimension,Values:r}),n.push(t)}}u.forEach(function(e,t){var n=i.attributes.grid[e+"_actual"];n&&(i.attributes.grid[e]=n)}),e.length>0?r.convertValues(e).then(function(e){e.Response&&(n.forEach(function(t,n){e.Response[n].ConvertedValues&&(i.attributes.grid[t]=UWA.is(e.Response[n].ConvertedValues,"string")?e.Response[n].ConvertedValues.split(";")[0]:e.Response[n].ConvertedValues)}),l.forEach(function(e){e.updateOptions(i.attributes)})),t()}):(l.forEach(function(e){e.updateOptions(i.attributes)}),t())}else t()})}))}),Promise.all(a).then(()=>{l&&o.groupRows(l)})},refreshInstanceNodeModel:function(i,n){var s=this,a=[];let l={},d=[],u=e.getUserCustomAttributes();u&&u.forEach(function(e){e.bo||(l[e.curi]=e,e.manipulationUnit&&e.manipulationUnit!==c.dimensions[e.dimension].MKSUnit&&d.push(e.curi))});let p=widget.getValue("groupingEnabled");return Object.keys(i).forEach(function(e){var d=i[e];let u=d[0].getParent();p&&!u.getID&&(u=o.getGroupNodeParent(u));let g=u.options.physicalid;n&&t.SAXStorage().setItem(c.localStorageKeys.recentlyAuthoredStructure+g,Date.now()),a.push(s.getInstanceAttributes({parentID:g,instID:e}).then(function(e){if(e.attributes&&e.attributes.grid){let t=[],i=[];for(let n in l){let o=l[n];if(o.bo||(n="instance_"+n),""===e.attributes.grid[n]&&e.attributes.grid[n+"_actual"]){let r;o.multiValuated&&Array.isArray(e.attributes.grid[n+"_actual"])?0===(r=e.attributes.grid[n+"_actual"]).length?r=[(r=0).toString()]:r.map(e=>e.toString()):r=[(r=+e.attributes.grid[n+"_actual"]||0).toString()],t.push({UnitFrom:c.dimensions[o.dimension].MKSUnit,UnitTo:o.manipulationUnit,Dimension:o.dimension,Values:r}),i.push(n)}}t.length>0?r.convertValues(t).then(function(t){t.Response&&(i.forEach(function(i,n){t.Response[n].ConvertedValues&&(e.attributes.grid[i]=UWA.is(t.Response[n].ConvertedValues,"string")?t.Response[n].ConvertedValues.split(";")[0]:t.Response[n].ConvertedValues)}),d.forEach(function(t){t.updateOptions(e.attributes)}))}):d.forEach(function(t){t.updateOptions(e.attributes)})}}))}),Promise.all(a)},navigate:function(t){let i=c.webservices.getItems+c.webservices.keyFieldForService;t.fields&&(i+=t.fields.join());let o=t.payload;return n.post(i,JSON.stringify(o),0).then(function(e){e=e&&UWA.is(e,"string")?JSON.parse(e):e;let t={};if(e.member&&e.member.length>0){e.member.forEach(function(e,i){let n,r={};e.outputs;for(n in e)r[n]=s.attributes(e[n]);t[o[i]]=r})}return t},function(t){e.displayError(t,null,null,l.msg_generic_error_get_failed)})}}}),define("DS/CATFLCockpitWidget/model/CATFLCockpitTreeDocument",["UWA/Core","DS/TreeModel/TreeDocument","DS/CATFLCockpitWidget/services/modeler.service","DS/CATFLCockpitWidget/services/index.service","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json"],function(e,t,i,n,o,r,s){"use strict";var a=JSON.parse(s);return t.extend({isMain:!1,_activeNode:null,defaultOptions:{shouldAcceptDrop:function(e){return!1}},init:function(t){this.mappedNodesToIds={},t=e.extend(e.clone(this.defaultOptions),t),this._parent(t),t.isMain&&(this.isMain=t.isMain)},updateTags:function(){this.isMain&&this.getModelEvents().publish({event:"setPathTags",context:this})},onRootAdded:function(){this.isMain&&this.getModelEvents().publish({event:"onRootAdded",context:this})},setActiveNode:function(e){null!==this._activeNode&&(this._activeNode.setActive(!1),this._activeNode.setColor("rgba(0, 0, 0, 0)")),this._activeNode=e,this._activeNode.setActive(!0),this._activeNode.setColor("rgba(54,142,196, 0.8)")},getActiveNode:function(e){return this._activeNode},empty:function(){this.mappedNodesToIds={},this._getTrueRoot().empty(),this._numberOfNodesInDocument=0},getRealRoots:function(t){var i=[],n=this.getRoots(t);if(null!=n&&n.forEach(function(e){if(e.isVirtual()){var t=e.getChildren();t&&t.length>0&&(i=i.concat(t))}else i.push(e)}),Boolean(t)&&e.is(this._getChildrenFilterInfo,"function")){var o=this._getChildrenFilterInfo();if(o&&e.is(o.childrenBeforeFiltering,"array")){var r=i;i=o.childrenBeforeFiltering.slice(0),r.forEach(function(e){i.indexOf(e)<0&&i.push(e)})}}return i},getRoots:function(t){var i=this._parent();if(Boolean(t)&&e.is(this._getChildrenFilterInfo,"function")){var n=this._getChildrenFilterInfo();if(n&&e.is(n.childrenBeforeFiltering,"array")){var o=i;i=n.childrenBeforeFiltering.slice(0),o.forEach(function(e){i.indexOf(e)<0&&i.push(e)})}}return i},removeRoot:function(t,i,n){this._doNotBroadcastSelect=!0;var o=this.hasOwnProperty("detachedRoots")?this.detachedRoots.indexOf(t):-1;if(o>=0)this.detachedRoots.splice(o,1);else{if(this.getRealRoots().indexOf(t)>=0)t.getParent().removeChild(t);if((!e.is(n,"boolean")||!n)&&e.is(this._getChildrenFilterInfo,"function")){var r=this._getChildrenFilterInfo();if(r&&e.is(r.childrenBeforeFiltering,"array")){var s=r.childrenBeforeFiltering.indexOf(t);s>=0&&r.childrenBeforeFiltering.splice(s,1)}if(r&&e.is(r.filteredOutChildren,"array")){var a=r.filteredOutChildren.indexOf(t);a>=0&&r.filteredOutChildren.splice(a,1)}}}if(this._doNotBroadcastSelect=!1,!e.is(i,"boolean")||!i){var l=this.getRealRoots().length;e.is(this.detachedRoots,"array")&&(l+=this.detachedRoots.length),this.getModelEvents().publish({event:"onRemoveRoot",data:{pid:t.getID(),remainingRoots:l}});var c=null;this.getRealRoots().length>0?c=this.getRealRoots()[0]:e.is(this.detachedRoots,"array")&&this.detachedRoots.length>0&&(c=this.detachedRoots[0]),this.getModelEvents().publish({event:"onRootAdded",data:{isremove:!0,added_node:c,nb_root:l}})}},getNodesByIDPath:function(e){var t=[];return this.getRealRoots().forEach(function(i){!function e(t,i,n,o){if(t.getID()===i[n])if(n===i.length-1)o.push(t);else{var r=t.getChildren();r&&r.length>0&&(n+=1,r.forEach(function(t){e(t,i,n,o)}))}}(i,e,0,t)}),t},getNodesById:function(e){var t=[];return this.getRoots().forEach(function(i){var n=i.getNodesById(e);t=t.concat(n)}),t},getMappedNodesFromId:function(e){return this.mappedNodesToIds&&this.mappedNodesToIds[e]?this.mappedNodesToIds[e]:this.getNodesById(e)},searchRootById:function(e){var t,i=this.getRoots(!0);this.hasOwnProperty("detachedRoots")&&(i=i.concat(this.detachedRoots));for(var n=0;n<i.length;n++)if(i[n].options.physicalid===e){t=i[n];break}return t},applyFilter:function(t,r){for(var s=this,l=[],c=o.checkIfRecentlyAuthored(t.filterRootIds[0],!0),d=0;d<t.filterRootIds.length;d++){var u=s.searchRootById(t.filterRootIds[d]);u&&(u.options.CVQuery=t.CVQuery,l.push(u))}if(t.empty&&t.filterRootIds&&1===t.filterRootIds.length){var p=t.filterRootIds[0],g={},m=s.getConfigurationContext();m&&m.filterCompiledForm&&(g.configFilter=m.filterCompiledForm),c?(g.itemIDs=[p],i.expand(g).then(function(e){e=e?e[l[0].options.physicalid]:{},s.onExpandComplete(l,r,c,e)})):(g.itemID=p,n.expand(g).then(function(e){e=e?e[l[0].options.physicalid]:{},s.onExpandComplete(l,r,c,e)}))}if(t.CVQuery.union||t.CVQuery.intersection||t.CVQuery.minus){var f=e.clone(t.CVQuery);if(f.union&&f.union.expand&&f.union.expand.length>1){for(var h=[],v=0;v<f.union.expand.length;v++){f.union.expand[v].volume_filter&&h.push(v)}for(var C=0;C<h.length;C++)f.union.expand.splice(h[C],1)}f.select_bo=a.index_services.select_bo.slice(),f.select_rel=a.index_services.select_rel.slice();var b=o.getUserCustomAttributesCURI();f.select_bo=f.select_bo.concat(b.bo),f.select_rel=f.select_rel.concat(b.rel),f.compute_select_bo=a.index_services.select_img,f.label=widget.getValue("appId")+"-"+Math.random(),n.multiexpand({data:f}).then(s.onExpandComplete.bind(s,l,r,c))}},onExpandComplete:function(e,t,i,n){try{this.prepareUpdate();var o=!1;if(n.map&&0!==Object.keys(n.map).length&&(i||n.paths&&0!==n.paths.length)||(o=!0),o)e.forEach(function(e){let t=e.getChildren();for(let i=t.length-1;i>=0;i--)t[i].getID()&&e.removeChild(t[i]);e.expand()}),t({response:null,recentlyAuthored:i});else n.srcFromNGFilter=!0,t({treedocument:this,root_nodes:e,response:n,expand_level:-1,selectPathLeaf:!1,recentlyAuthored:i})}catch(e){console.error("error in filtering",e)}finally{this.pushUpdate()}},setConfigurationContext:function(e){this._configurationContext={model:e.model,modelVersion:e.modelVer,pc:e.pc,filterCompiledForm:e.filterCompiledForm}},getConfigurationContext:function(){return this._configurationContext?this._configurationContext:null},addToMappedNodes:function(e){this.mappedNodesToIds[e.options.physicalid]?this.mappedNodesToIds[e.options.physicalid].push(e):this.mappedNodesToIds[e.options.physicalid]=[e]},removeFromMappedNodes:function(e){if(this.mappedNodesToIds[e.options.physicalid]){for(var t=this.mappedNodesToIds[e.options.physicalid],i=t.length-1;i>=0;i--){t[i]._id===e._id&&t.splice(i,1)}t.length<=0&&delete this.mappedNodesToIds[e.options.physicalid]}}})}),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.attachment",["DS/UIKIT/Mask","DS/UIKIT/Modal","DS/UIKIT/SuperModal","DS/UIKIT/Input/Button","DS/ENOXEmptyContent/js/ENOXEmptyContent","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/search.util","DS/CATFLCockpitWidget/utils/refresh.util","DS/CATFLCockpitWidget/utils/gridview.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/group.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/document.service","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/components/ArchitectureNumber/architectureNumber","DS/CATFLCockpitWidget/components/ConfirmationWindow_Generic/ConfirmationWindow","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,g,m,f,h,v,C,b){"use strict";var y=r.getFullConfig(),_=(y.localStorageKeys,y.identifiers);return{addExistingDoc:function(e,t){var i=this.addExistingDocAsInstance.bind(this,e,t);a.launchSearch({searchTitle:b.label_search_doc,allowedTypes:_.types_addExistingDoc,role:"",criteria:_.type_documents,bMultiSel:!0,in_apps_callback:i})},addExistingDocAsInstance:function(t,i,n){if(n){var o,r;e.mask(widget.body,b.msg_processing),i&&(o=_.rel_specification,r="specificationDocumentsCategory");var a=[];return n.forEach(function(e){var i=e.id?e.id:e.objectId;a.push(m.attachDocument(t.options.physicalid,i,o))}),Promise.all(a).then(function(){e.unmask(widget.body),s.alertMessage("success",null,b.msg_attach_doc_success),p.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-documents-by-id",data:{nodes:[t],docType:r}})},function(t){e.unmask(widget.body),s.displayError(t,b.msg_add_item_error,null,b.replace(b.error_no_access,{errorOp:b.action_insert_existing+" "+b.label_document}))})}},setArchitectureNumber:function(t,i){let n=!1;i&&i.newParent&&(n=!0);let o=document.body.querySelector(".fl-cockpit-content-list-container");e.mask(o,b.msg_loading);let r,a,l={};if(n){r={newParentID:i.newParent.options.physicalid};let e=[];t.forEach(function(t){e.push({instanceID:t.options.instance.physicalid,referenceID:t.options.physicalid})}),r.instances=e}else r=[],Array.isArray(t)?(a=[],t.forEach(function(e){let t=e.options.physicalid,i={referenceID:t};if(e.options.instance){let n=e.options.instance.physicalid;i.instanceID=n,a.push(n),l[t]?l[t].push(n):l[t]=[n]}r.push(i)})):r.push({referenceID:t});let c=[];n?c.push(g.getANProposalForReparent(r)):(c.push(g.getArchitectureNumberProposal(r)),a&&a.length>0&&c.push(h.getEffectivityInfo(a))),Promise.all(c).then(function(e){let o=JSON.parse(e[0]),r=e[1],s=!1,a={};if(n&&(i.selectedNodes=t),r){let e,t;for(let i in r)"YES"===(e=r[i]).hasEffectivity&&(t=e.content&&e.content.Evolution)&&t.Current&&t.Projected&&(a[i]={current:t.Current.replace(/(\r\n|\n|\r)/gm," "),projected:t.Projected.replace(/(\r\n|\n|\r)/gm," ")},s||(s=!0));o.bEffectivityCol=s,o.instEffectivity=a}v.init(o,i)}).catch(function(e){s.displayError(e,null,b.error_header,b.error_get_archno_proposal)}).finally(function(t){e.unmask(o)})},detachArchitectureReferenceExtension:function(t,i){e.mask(i,b.msg_processing);var n=this,o=[];t.forEach(function(e){o.push(e.options.physicalid)}),g.detachArchitectureReferenceExtension(o,"VALIDATE_AND_REMOVE").then(function(t){var r=JSON.parse(t);if(r.requirePreprocess){var a=UWA.createElement("div",{styles:{"min-height":"100px","max-height":"210px","overflow-y":"auto"}});a.innerText=r.message,C.createWindow(widget.body,b.action_remove_architecture_number,a,b.label_archNum_remove_confirm_preprocess,function(){e.mask(i,b.msg_processing),g.detachArchitectureReferenceExtension(o,"PRE_PROCESS_AND_REMOVE").then(function(e){var t="success";(e=JSON.parse(e)).ignored&&(t="warning"),s.alertMessage(t,null,e.message),n.detachArchNumUpdateView(o)},function(e){s.displayError(e,null,b.error_header,b.error_rem_archno)}).finally(function(t){e.unmask(i)})})}else s.alertMessage("success",null,r.message),n.detachArchNumUpdateView(o)}).catch(function(e){s.displayError(e,null,b.error_header,b.error_rem_archno)}).finally(function(t){e.unmask(i)})},detachArchNumUpdateView:function(e){var t=widget.getValue("currentOpenedItem");t&&e.indexOf(t)>=0&&p.getFLWebModelEventsObj("flweb-model-events").publish({event:"idcard-refresh"}),p.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-nodes-by-id",data:{arrayOfPID:e,tagAsRecentlyAuthored:!0,dontLoadSpaceInfo:!0}})},openModalSolutionSelection:function(e){var i=this,r=new n({value:b.label_search,className:"primary"});r.addEvent("onClick",function(){a.launchSearch({searchTitle:b.label_search_product,allowedTypes:_.type_act_physical,role:"",criteria:_.type_act_physical,bMultiSel:!1,in_apps_callback:function(t){i.updateSolutionID(t[0].id,l,d,e)}})});var l=new o({sentences:[{type:"dom",DOMelement:r.getContent()},{type:"drop",text:b.msg_drop_to_open}]}),c=b.action_set_proposed_solution+" - ";1===e.length?c+=e[0].options.label:c=c+e.length+" "+b.label_objects;var d=new t({header:c,className:"site-reset",closable:!0,body:l._containerEmptyContent}).inject(widget.body);s.makeDroppable(d.elements.content,"",function(t){null!==t&&f.getKindOfRFLP([t[0].objectId]).then(function(n){"P"===n[0]?i.updateSolutionID(t[0].objectId,l,d,e):s.alertMessage("error",null,b.error_dropped_item_not_physical)})}),d.show()},detachDocuments:function(t){e.mask(widget.body,b.msg_processing);let i=widget.getValue("groupingEnabled");var n=[],o=[],r=[];return t.forEach(function(e){var t=e.getParent().getParent();i&&!t.getID&&(t=u.getGroupNodeParent(t));var s=t.options.physicalid,a="specificationDocumentsCategory"===e.getParent().options.type;a?r.push(e):o.push(e);var l=e.options.physicalid;n.push(m.removeDocument(s,l,a))}),Promise.all(n).then(function(){1===t.length?s.alertMessage("success",null,t[0].options.label+b.msg_detach_document):s.alertMessage("success",null,t.length+b.msg_detach_documents),o.length>0&&p.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"remove-items-from-category",data:{nodes:o,categoryType:"attachedDocumentsCategory"}}),r.length>0&&p.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"remove-items-from-category",data:{nodes:r,categoryType:"specificationDocumentsCategory"}}),e.unmask(widget.body)},function(t){s.displayError(t,null,b.error_remove_item),e.unmask(widget.body)})},detachSolution:function(e,t,i){var n,o=[];let a=widget.getValue("groupingEnabled");for(n in t)o.push({refId:n,solIds:t[n]});return g.detachSolution(o).then(function(t){var n=[];i.forEach(function(t){var i=t.options.physicalid,o=t.getParent();if(o){var s=o.getParent();if(a&&!s.getID&&(s=u.getGroupNodeParent(s)),a&&s.isRoot()){let e=o.getParent();o.getChildren().forEach(function(e){e.options.physicalid===i&&e.remove()}),o.getChildren()&&0!==o.getChildren().length||o.remove(),u.removeGroupNodesOnEmpty(e)}else{(e.getMappedNodesFromId(s.options.physicalid)||[s]).forEach(function(e){n.push(e);var t=e.options.instance?e.options.instance.physicalid:"",o=e.getNodesByRelId("proposedsolution"+t)[0];o.getChildren().forEach(function(e){e.options.physicalid===i&&e.remove()}),o.getChildren()&&0!==o.getChildren().length||o.remove(),e.expand()})}r.SAXStorage().setItem(y.localStorageKeys.recentlyAuthored+s.options.physicalid,Date.now())}}),s.alertMessage("success",null,b.msg_remove_solution_success),n.length>0&&p.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-update-cues",data:n})}).catch(function(e){s.displayError(e,null,b.error_header,b.error_rem_prop_soln)})},addExistingItem:function(e,t,i){var n,o=this.addExistingItemAsInstance.bind(this,e,t,i);n=_.type_act_logref,a.launchSearch({searchTitle:b.label_search_logref,allowedTypes:n,role:"",criteria:n,bMultiSel:!0,in_apps_callback:o})},addExistingItemAsInstance:function(t,i,n,o){e.mask(i,b.msg_processing);var r={instances:[]};if(o)for(var a=0;a<o.length;a++)r.instances.push({referencedID:o[a].id?o[a].id:o[a].objectId,attributes:{}});g.createLogItemInstanceNew(r,t.options.physicalid).then(function(e){var i=[];if(o.forEach(function(e){i.push(e["ds6w:label"]+" "+e["ds6wg:revision"])}),e&&e.member){var r=n.getMappedNodesFromId(t.options.physicalid);r||(r=[t]),l.addChildrenToParent(n,r,e.member,!1),s.alertMessage("success",null,b.msg_header_add_success,b.msg_add_success+i.toString())}},function(e){s.displayError(e,null,b.error_header,b.msg_add_item_error)}),e.unmask(i)},updateSolutionID:function(e,t,i,n){var o=[],r=!1,a=!1;return n.forEach(function(t){o.push({refId:t.options.physicalid,solIds:[e]})}),g.updateSolutionIDAttributes(o).then(function(e){for(var t in e)if(e[t].ignoredAlreadyExist.length>0&&(r=!0),e[t].success.length>0&&(a=!0),a&&r)break;r&&s.alertMessage("error",null,b.msg_proposed_solution_ignored),a&&(s.alertMessage("success",null,b.msg_proposed_solution_added),p.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-update-cues",data:n}),p.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-solutions-by-id",data:n}))}).catch(function(e){s.displayError(e,null,b.error_header,b.error_add_prop_soln)}).finally(function(){t.destroy(),i.destroy()})}}}),define("DS/CATFLCockpitWidget/mixins/CATFLBIGroup",["DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/index.service","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n){"use strict";return{_applyGrouping:function(t,i){let n=this;n.filterMod=t;let o=e.getFLWebModelEventsObj("flweb-model-events");return n.options||(n.options={}),!0===n.options.groupingFilterInProgress?(console.debug("Grouping with filter in progress"),Promise.resolve()):new Promise(e=>{n.cleanGrouping(i),n.options.groupingFilterInProgress=!0;let r=Array.isArray(i.roots)&&i.roots.length?i.roots:t.options.model.getRoots();n._removeChildren({roots:r,noGroupUpdate:i.noGroupUpdate}).then(()=>{if(i.groups.length&&r){n.options.groups=i.groups;for(let e=0;e<n.options.groups.length;e++)for(let t=0;t<n.options.groups[e].object.length;t++)if(Array.isArray(n.options.groups[e].object[t].object)){let i="",o=n.options.groups[e].object[t].object;for(let e=0;e<o.length;e++)i+=o[e],-1===n.options.selectedTags.indexOf(i)&&n.options.selectedTags.push(i),i+="/";let r=n.options.groups[e].object[t].object.join("/");n.options.realSelectedTags.push(r)}else{let i=[n.options.groups[e].object[t].object];if(Array.isArray(n.options.groups[e].object[t].merged))for(let o=0;o<n.options.groups[e].object[t].merged.length;o++)i.push(n.options.groups[e].object[t].merged[o].object),n.options.mergedMap[n.options.groups[e].object[t].merged[o].object]=n.options.groups[e].object[t].object;n.options.selectedTags=n.options.selectedTags.concat(i),n.options.realSelectedTags=n.options.realSelectedTags.concat(i)}var s;n.options.selectedTags=n.options.selectedTags.filter(function(e,t){return n.options.selectedTags.indexOf(e)===t}),n.options.realSelectedTags=n.options.realSelectedTags.filter(function(e,t){return n.options.realSelectedTags.indexOf(e)===t}),!0!==i.noGroupUpdate&&(s=n._retrieveGrpsOnNode(r[0],t,i)),s.then(()=>{n.options.isGroupingApplied=!0,o.publish({event:"flcockpit-filterBI-applyGrouping-done",data:{status:!0}}),n.options.groupingFilterInProgress=!1,e()})}else o.publish({event:"flweb-load-item",data:{itemPID:t.options.model.getRoots()[0].options.physicalid}}),n.options.isGroupingApplied=!1,o.publish({event:"flcockpit-filterBI-applyGrouping-done",data:{status:!0}}),n.options.groupingFilterInProgress=!1,e()})})},isGroupingApplied:function(){return this.options&&this.options.isGroupingApplied},cleanGrouping:function(e){this.options.mapGrpNodes={},this.options.isGroupingApplied=!1,this.options.groupPredicates=[],this.options.selectedTags=[],this.options.realSelectedTags=[],this.options.mergedMap={},this.options.groupingFilterInProgress=!1;for(var t=Array.isArray(e.roots)&&e.roots.length?e.roots:this.filterMod.options.model.getRoots(),i=0;i<t.length;i++)t[i].options.childComputed=!1},_removeChildren:function(e){let t=this,i=t.filterMod.options.model;return new Promise(n=>{var o=e.roots;i.prepareUpdate();var r=[];for(let i=0;i<o.length;i++){var s=o[i];if(s){var a=s.getState(),l=[],c=0;let i=s.getChildren();for(;i.length-c;){var d=!0;if(i[c].options.originalChildrenInformation&&Object.keys(i[c].options.originalChildrenInformation).length>0){let e=t.getChildrenfromGroupNode(i[c]);e&&e.length>0&&("NA"===i[c].options.identifier||"False"===i[c].options.identifier?e.forEach(t=>{!t.getID||t.getID()&&""!==t.getID()?i.push(...e):s.addChild(t)}):i.push(...e))}else void 0!==i[c].getID()&&""!==i[c].getID()||(d=!1,!e.noGroupUpdate&&i[c].options.isGroupingNode&&(d=!0));if(d){var u=s.removeChild(i[c]);l.push({rootID:s.getID(),node:u})}else c++}e.noGroupUpdate||(s.setState({state:"collapsed"}),s.childComputed=!1),"expanded"!==a&&"partiallyExpanded"!==a||(r=r.concat(l))}}i.pushUpdate(),n(r)})},_retrieveGrpsOnNode:function(e,i,n){let o=this;console.info("Applying grouping on node ",e.getLabel());let r=o.options.groupPredicates=[];for(let e=0;e<n.groups.length;e++)r.push(n.groups[e].predicate);let s={filterBI:i._biFilter,data:{},pathIds:[e.getOccurencePath()],grouping:n,is2D:!0,filter_facets:r};return t.getGroupingNodes(s).then(t=>o._buildGrpsOnNode(e,t,n.groups))},_buildGrpsOnNode:function(e,t,i){var n=this;return new Promise(o=>{t=UWA.is(t,"string")?JSON.parse(t):t;let r=i[0].object.map(e=>e.object);var s={},a=n.options.mapGrpNodes[e.getID()]={},l=[],c=!1;for(let o=0;o<t.results.length;o++)if(t.results[o].synthesis){var d=t.results[o].synthesis&&t.results[o].synthesis.facets?t.results[o].synthesis.facets:[];if((d=d.slice().sort(function(e,t){return r.indexOf(e.object)-r.indexOf(t.object)})).length)for(let t=0;t<d.length;t++){var u=d[t];if(u.sixw){var p=u.sixw.split("/"),g=p[p.length-1];-1!==n.options.groupPredicates.indexOf(g)&&n._buildGrping(u,e,s,l,a,i)}}else t.results[o].synthesis.name.contains("Other")&&t.results[o].synthesis.value>0&&(c=!0)}!0===c&&n._createOtherNode(a,e,g,l),e.setState({state:"expanded"}),o()})},_buildGrping:function(e,t,n,o,r,s){let a=this,l=e.sixw.split("/"),c=l[l.length-1],d=UWA.Utils.splat(e.object),u=t,p=d.join("/");a.options.mergedMap[p]&&(p=a.options.mergedMap[p]);var g,m=null;for(let e=0;s&&e<s.length;e++){let t=s[e];if(t.object)for(let e=0;e<t.object.length&&null===m;e++)t.object[e].object===p&&(m=t.object[e])}if(-1!==a.options.realSelectedTags.indexOf(p)||!0===u.isGroupingNode)if(n[p])(g=n[p]).options.merged=!0,g.options.grp=g.options.grp.concat(d),o.push(d);else{var f=d[d.length-1];g=new i({isGroupingNode:!0,resourceid:"sax-groupingNode-"+f+"-",label:m?m.dispText:f,dispText:m?m.dispText:void 0,grid:{groupValue:f},parentNode:u,ds6w:c,grp:d,groupingIntent:a.options.groups,children:[]}),o.push(d),u.addChild(g),g.options.grpSelected=!0,r[p]=g,n[p]=g}return g},_createOtherNode:function(e,t,o,r){var s=new i({isGroupingNode:!0,resourceid:"sax-groupingNode-other",label:n.groupingNode.other,grid:{groupValue:n.groupingNode.other},parentNode:t,isOther:!0,ds6w:o,grp:r,groupingIntent:this.options.groups,children:[]});return e.other=s,t.addChild(s),s},expandGroupNode:function(e){let i=this,n=e.gridViewUtilCtx,o=e.selectedNode,r=e.level;e.state&&e.state;if(!0===o.options.contentRetrieved);else{let e=parseInt(r),l=!1,c=[];c[0]={},c[0].predicate=o.options.groupingIntent[0].predicate,c[0].predLevel=o.options.groupingIntent[0].predLevel,c[0].other=o.options.isOther;let d=o.getGroups();if(o.options.isOther){let e=[];for(let t=0;t<d.length;t++)e.push({object:d[t]});0==e.length&&(l=!0),c[0].object=e}else o.options.merged?c[0].object=o.options.groupingIntent[0].object:c[0].object=[{object:d}];var s;if(l){var a=i.options.groups;c=[{predicate:a[0].predicate,predLevel:!0,object:[],other:!0}],a.forEach(e=>{c[0].object.push(e.object[0])}),s={filterBI:i.filterMod._biFilter,expandLevel:e,data:{},pathIds:[o.getOccurencePath()],groupingFilter:c},t.expandGroupingNode(s).then(e=>{n.createStructFromProgExpand({treeDocument:i.filterMod.options.model,rootNode:o,data:e}),o.preExpandDone()})}else s={filterBI:i.filterMod._biFilter,expandLevel:e,data:{},pathIds:[o.getOccurencePath()],groupingFilter:c},t.expandGroupingNode(s).then(e=>{n.createStructFromProgExpand({treeDocument:i.filterMod.options.model,rootNode:o,data:e}),o.preExpandDone()})}},getChildrenfromGroupNode:function(e){let t=this,i=[];return e.getChildren().forEach((e,n)=>{e.getID?i.push(e):i.push(...t.getChildrenfromGroupNode(e))}),i}}}),define("DS/CATFLCockpitWidget/parser/database.parser",["DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/pno.util","WebappsUtils/WebappsUtils","DS/CATFLCockpitWidget/services/logitem.service","text!DS/CATFLCockpitWidget/assets/config/mapping.conf.json","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json"],function(e,t,i,n,o,r,s,a){"use strict";var l=JSON.parse(s),c=t.getFullConfig();c.identifiers,c.localStorageKeys;return{attributes:function(t){let i=[],n=[],o={},r=e.getUserCustomAttributes(),s=[];if(r&&r.forEach(function(e){o[e.selectable.toLowerCase()]=e,e.manipulationUnit&&n.push(e.curi),e.multiValuated&&s.push(e.curi)}),t){if(!Array.isArray(t)&&("string"==typeof t||"object"==typeof t&&!t.member))return t;(t=t.member||t).forEach(function(t){let r,a,c={};for(r in t)if(a=l[r],"id"===r)c.physicalid=t[r];else if("title"===r)c.label=t[r];else if("revision"===r)c.revision=t[r];else if("isLastVersion"===r)c.isLastVersion="TRUE"===t[r];else if("state"===r)c.status=t[r],c.maturity=t[r];else if("owner"===r)c.owner=t[r];else if("ds6w:reserved"===r)c.isReserved=t[r];else if("created"===r)c.creationDate=e.formatDate(t[r]);else if("modified"===r)c.modificationDate=e.formatDate(t[r]);else if("description"===r)c.description=t[r];else if("type"===r)c.type=t.typeNLS||t[r],c.actualType=t.typeDB||t[r];else if("type_icon_url"===r)c.icons={iconPath:t[r],iconSize:{height:"16px",width:"16px"}};else if("name"===r)c.name=t[r];else if("architectureNumber"===r)c.architectureNumber=t[r];else{var d=o[r.toLowerCase()];if(d){if(s.indexOf(d.curi)>=0){var u=[];t[r]&&(u=t[r].split(/\u0007/)),c[d.curi]=u}else c[d.curi]=t[r]||"";n.indexOf(d.curi)>=0&&(c[d.curi+"_actual"]=c[d.curi],c[d.curi]="")}else c[r]=t[r]}i.push(c)})}return i},parseDBSpaceData:function(e){let t=[];return e.forEach(function(e){let i={physicalid:e.objPhysicalId,label:e.objLabel,revision:e.objRevision,type:e.objType,connectionId:e.ownerPhysicalId,connectionType:e.ownerType};t.push(i)}),t},defaultInstanceParser:function(t,i){var n={},o={};let r=[],s=[],a={},l=e.getUserCustomAttributes();l&&l.forEach(function(e){o[e.selectable.toLowerCase()]=e,e.manipulationUnit&&r.push(e.curi),e.multiValuated&&s.push(e.curi)}),t.forEach(function(t){var i={grid:{}};if(t.attributes&&t.attributes.length)for(var l=0;l<t.attributes.length;l++){var c=t.attributes[l].name,d=t.attributes[l].value;if("PLMInstance.PLM_ExternalID"===c)i.grid.instanceName=d;else if("PLMInstance.V_description"===c)i.grid.instance_description=d;else if("modified"===c)i.instance={modificationDate:e.formatDate(d)};else{var u=o[c.toLowerCase()];if(u&&!u.bo){if(s.indexOf(u.curi)>=0){var p=[];d&&(p=d.split(/\u0007/)),i.grid["instance_"+u.curi]=p}else i.grid["instance_"+u.curi]=d||"";r.indexOf(u.curi)>=0&&(i.grid["instance_"+u.curi+"_actual"]=i.grid["instance_"+u.curi],i.grid["instance_"+u.curi]="")}}}t.attributes=i,n[t.uuid]=t,a[t.physicalid]=t.uuid});let c={};return i.forEach(function(e){c[e]={map:n,rootUuid:a[e]}}),c},defaultExpandParser:function(i,r){var s={},a={};let l={},d=e.getUserCustomAttributes(),u=[],p=[];d&&d.forEach(function(e){a[e.selectable.toLowerCase()]=e,e.manipulationUnit&&u.push(e.curi),e.multiValuated&&p.push(e.curi)}),i.forEach(function(i){var n={physicalid:i.physicalid,resourceid:i.physicalid,type:c.identifiers.type_act_logref,grid:{architectureNumber:"",kindOfRFLP:"L"}},r=c.mappingType[i.type];if(r&&r.nlsName?n.grid.type=r.nlsName:n.grid.type=i.type,r&&r.icon?n.icons=[t.getTypeIconUrl(i.type)]:n.icons=[t.getTypeIconUrl(c.identifiers.type_act_logref)],n.grid.actualType=i.type,i.attributes&&i.attributes.length){for(var d=0;d<i.attributes.length;d++){var g=i.attributes[d].name,m=i.attributes[d].value;if("PLMEntity.V_Name"===g||"Title"===g)n.label=m;else if("name"===g)n.grid.name=m;else if("PLMEntity.V_description"===g)n.grid.description=m||"";else if("revision"===g)n.grid.revision=m;else if("current"===g)n.maturity=m,n.grid.maturity=c.MAPPING_MATURITY[m];else if("owner"===g)n.grid.owner=m;else if("originated"===g)n.grid.creationDate=e.formatDate(m);else if("modified"===g)n.grid.modificationDate=e.formatDate(m);else if("reserved"===g)n.grid.isReserved=m;else if("reservedby"===g)n.grid.reservedBy=m||"";else if("PLMReference.V_isLastVersion"===g)n.grid.isLastVersion="TRUE"===m;else if("ArchitectureExtension.V_ArchitectureNumber"===g)n.grid.architectureNumber=m;else{var f=a[g.toLowerCase()];if(f){if(p.indexOf(f.curi)>=0){var h=[];m&&(h=m.split(/\u0007/)),n.grid[f.curi]=h}else n.grid[f.curi]=m||"";u.indexOf(f.curi)>=0&&(n.grid[f.curi+"_actual"]=n.grid[f.curi],n.grid[f.curi]="")}}}var v=t.getUser("isTrigram"),C=t.getUser("isFullName");n.type===c.identifiers.type_act_logref&&("FALSE"===n.grid.isReserved?(n.isReserved=n.grid.isReserved,n.grid.isReserved=o.getWebappsAssetUrl("CATFLCockpitWidget","icons/I_CheckIn.png")):n.grid.reservedBy===v||n.grid.reservedBy===C?(n.isReserved=n.grid.isReserved,n.grid.isReserved=o.getWebappsAssetUrl("CATFLCockpitWidget","icons/I_lock.png")):(n.isReserved=n.grid.isReserved,n.grid.isReserved=o.getWebappsAssetUrl("CATFLCockpitWidget","icons/I_ReservedByOthers.png")))}i.attributes=n,s[i.uuid]=i,l[i.physicalid]=i.uuid});let g={};r.forEach(function(e){g[e]={map:s,rootUuid:l[e]}});let m=[];for(let e in s)s.hasOwnProperty(e)&&function(){let t=s[e];"#DENIED!"!==t.attributes.grid.owner&&m.push(n.getFullName(t.attributes.grid.owner).then(function(e){t.attributes.grid.owner=e}))}();return Promise.all(m).then(function(){return g})},parseItemToConfigCtx:function(e){let t={};return e&&e.length>0&&e.forEach(function(e){let i=e.contextOf,n=e.content&&e.content.results&&e.content.results.length>0?e.content.results[0]:null;if(n&&i.length>0){let o={};o.backEndName=n.computed.label.value[0],o.name=n.data[0].value[0],o.physicalid=e.modelPID;for(let e=0;e<i.length;e++){let n,r=i[e],s={};t[r]?(n=t[r].displayValue,(s=t[r].contexts)[o.physicalid]||(n+=","+o.name,s[o.physicalid]=o)):(n=o.name,s[o.physicalid]=o),t[r]={displayValue:n,contexts:s}}}}),t}}}),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.effectivity",["DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/parser/database.parser","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s){"use strict";var a=t.getFullConfig(),l={modifiedEditCfgCtx:function(t){let i=this,r=i.contentListView.contentView.getTreeDocument();if("cfgEditConfigurationContext"===t.commandName){let t,s=[],a=r.getSelectedNodes(),c=i.contentListView.contentView.layout.getColumnVisibleFlag("ConfigurationContext");a&&a.length>0?(t=a[0].options.physicalid===i.itemId||!1,a.forEach(function(e){s.push(e.options.physicalid)})):(t=!0,s.push(i.itemId));let d=!!c;t?n.getConfigContextInfo([i.itemId]).then(function(t){if(t){t.referencesInfo;let n,a=o.parseItemToConfigCtx(t.contextInfo)[i.itemId];if(a&&a.contexts){n=[];for(let e in a.contexts)n.push({name:a.contexts[e].backEndName,physicalid:e})}let c=e.getFLWebModelEventsObj("flweb-model-events"),u=widget.getValue("modelAttached"),p=widget.getValue("currentConfig"),g=function(){widget.setValue("modelAttached",n),widget.setValue("currentConfig",null),i._loadItemWithConfigCtx(n)};u?a?(widget.setValue("modelAttached",n),p&&Object.keys(a.contexts).indexOf(p.model.physicalid)<0&&(d=!1,g())):(d=!1,c.publish({event:"mod-selection-removed",data:{itemID:i.itemId}})):a?(d=!1,g()):d&&l.updateCfgCtxColumn(s,r)}}):d&&l.updateCfgCtxColumn(s,r)}},updateCfgCtxColumn:function(e,t){var i=this,n={relids:[],pids:e},o=[],r=a.gridview.additionalColumnsModules.cfgContext;if(r){var s=new Promise(function(e,t){r.updateAttributes(n,function(t){var i=UWA.is(t,"string")?JSON.parse(t):t;e(i)},i)});o.push(s),o.length?Promise.all(o).then(function(i){let n=i&&i[0]?i[0].pids:{};t.withTransactionUpdate(function(){e.forEach(function(e){t.getMappedNodesFromId(e).forEach(function(t){let i={grid:n[e]};t.updateOptions(i)})})})}).catch(e=>{console.log("An Error Occured")}):console.info("No cfg ctx to update")}},refreshEffectivityChanges:function(t){t=JSON.parse(t);let i=this.contentListView.contentView.getTreeDocument(),n=t.commandName,o=t.response?t.response.results:null,r=widget.getValue("currentConfig"),s=[],a=[];switch(n){case"cfgExtendEvolutionEffectivity":case"cfgEditEvolution":case"cfgPasteEvolution":if("cfgExtendEvolutionEffectivity"===n?(o=t.response.resources).forEach(function(e){"SUCCESS"===e.status&&e.identifier?a.push(e.identifier):"FAILED"===e.status&&s.push(e.errorDetails)}):o.forEach(function(e){e.existing&&"SUCCESS"===e.status?a.push(e.existing.pid):"FAILED"===e.status&&s.push(e.errorDetails)}),r&&a.length>0)return void e.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-refresh"});a.length&&l.refreshCfgValues({treeDocument:i,relids:a});break;case"cfgInlineVariant":case"cfgEditVariant":case"cfgPasteVariant":let c,d=[];if(o.forEach(function(e){"SUCCESS"===e.status?e.new?(c={oldId:e.existing.pid,newId:e.new.pid},d.push(c)):a.push(e.existing.pid):"FAILED"===e.status&&s.push(e.errorDetails)}),r&&r.pc&&r.pc.id&&(d.length>0||a.length>0))return void e.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-refresh"});d.length&&l.splitInstance({treeDocument:i,couples:d}),a.length&&l.refreshCfgValues({treeDocument:i,relids:a})}},refreshCfgValues:function(e){var t=this;if(e.relids&&e.relids){var i=e.pids||[],n=e.relMap||{};(i.length<=0||Object.keys(n).length<=0)&&e.relids.forEach(function(t){var o=e.treeDocument.getRoots()[0].getNodesByRelId(t);o&&o.length&&(o.forEach((e,t)=>{i.push(e.getID())}),n[t]?n[t].push(...o):n[t]=o)});var o={relids:e.relids,pids:i},r=[],l=a.gridview.additionalColumnsModules.cfgEffectivty;if(l){var c=new Promise(function(e,i){l.updateAttributes(o,function(t){var i=UWA.is(t,"string")?JSON.parse(t):t;e(i)},t)});r.push(c),r.length?Promise.all(r).then(function(t){let i={};t&&t.length&&t.forEach(e=>{e.relids&&(i=e.relids)}),e.treeDocument.withTransactionUpdate(function(){e.relids.forEach(function(e){var t=n[e];if(t&&t.length){var o=i[e];o.VariantEffectivity.trim()||(o.VariantEffectivity=s.label_none),o&&t.forEach(e=>{e.updateOptions({grid:o})})}})})}).catch(e=>{console.log("An Error Occured")}):console.info("No cfg to update")}else console.info("No cfg Module")}else console.error("no relids to refresh")},splitInstance:function(e){let t,i,n,o,s,a,c,d={},u=[],p=[];e.treeDocument.withTransactionUpdate(function(){try{for(let l=0;l<e.couples.length;l++)if(t=e.couples[l].oldId,i=e.couples[l].newId,(n=e.treeDocument.getRoots()[0].getNodesByRelId(t))&&n.length>0){d[t]?d[t].push(...n):d[t]=n,d[i]||(d[i]=[]),u.indexOf(t)<0&&u.push(t),u.indexOf(i)<0&&u.push(i);for(let e=0;e<n.length;e++)(o=n[e])&&(p.push(o.getID()),(s=o.getParent())&&((c=UWA.clone(o.options,!1)).grid=UWA.clone(o.options.grid),c.instance=UWA.clone(o.options.instance),(a=new r(c)).setRelationID(i),a.options.instance.physicalid=i,a.options.hasBeenExpanded=!1,a.options.noIndexOrDBExpand=!1,a.collapse(),s.insertBefore(a,o),a.options.actualParent=s,d[i].push(a)))}}catch(e){console.error("error >>:",e)}finally{console.info("splitInstance done")}}),e.relids=u,e.pids=p,e.relMap=d,l.refreshCfgValues(e)}};return l}),define("DS/CATFLCockpitWidget/services/index.service",["DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/xhr.util","WebappsUtils/WebappsUtils","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/parser/index.parser","text!DS/CATFLCockpitWidget/assets/config/mapping.conf.json","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","text!DS/CATFLCockpitWidget/assets/config/expandv2.conf.json"],function(e,t,i,n,o,r,s,a,l){"use strict";var c=JSON.parse(s),d=t.getFullConfig(),u=d.identifiers,p=d.localStorageKeys,g=JSON.parse(l);return{fetch:function(e,n){var o={physicalid:e,label:"CATFLCockpit-ExecuteFetch",select_predicate:n,tenant:t.getTenant()};return i.makeServiceCall(d.webservices.fetchService,"POST",JSON.stringify(o),!0,null,{timeout:0}).then(function(e){var t=JSON.parse(e).results,i=[];return t.forEach(function(e){for(var t={},n=e.attributes,o=0;o<n.length;o++)if("type_icon_url"!==n[o].name&&"preview_url"!==n[o].name){var r=t[n[o].name];r?(r.value&&!Array.isArray(r.value)&&(r.value=[r.value]),n[o].value&&(r.value||(r.value=[]),r.value.push(n[o].value)),r.dispValue&&!Array.isArray(r.dispValue)&&(r.dispValue=[r.dispValue]),n[o].dispValue&&(r.dispValue||(r.dispValue=[]),r.dispValue.push(n[o].dispValue))):t[n[o].name]=n[o]}i.push(t)}),i})},expand:function(t){var n=d.webservices.expandService,o=widget.getValue("component-view");void 0!==t.expandIter&&null!==t.expandIter||(t.expandIter="1",o===p.flattenedView?t.expandIter=widget.getPreference(p.depthFlattenedView).value:o===p.flattenedViewOnlyArchitectureItem&&(t.expandIter=widget.getPreference(p.depthFlattenedViewArchitectureItemOnly).value));var s=t.select_bo?t.select_bo:d.identifiers.index_services.select_bo.slice(),a=t.select_rel?t.select_rel:d.identifiers.index_services.select_rel.slice(),l=e.getUserCustomAttributesCURI();s=s.concat(l.bo),a=a.concat(l.rel);var c={config_filter:t.configFilter?t.configFilter:"",expand_iter:t.expandIter,select_bo:s,select_rel:a,compute_select_bo:u.index_services.select_img,type_filter_rel:t.type_filter_rel?t.type_filter_rel:["RFLVPMLogicalInstance","RFLVPMLogicalRepInstance"],label:"CATFLCockpit-ExecuteExpand",local:"en",with_synthesis_attributes:!0};t.itemID?(c.root_physicalid=t.itemID,t.node&&o===p.structuredView&&(c.root_path_physicalid=[t.node.getOccurencePath()])):t.multiplePathIDs?(c.root_path_physicalid=t.multiplePathIDs,c.paths=t.multiplePathIDs):(c.root_path_physicalid=t.multipleIDs,t.occPaths&&t.occPaths.length>0&&(c.root_path_physicalid=t.occPaths));var g=t.parser?t.parser:r.defaultExpandParser;return i.makeServiceCall(n,"POST",JSON.stringify(c),!0,null,{timeout:0}).then(function(e){var i=JSON.parse(e).results;if(i&&0!==i.length){let e=t.itemID?[t.itemID]:t.multipleIDs;return g(i,e)}return null})},multiexpand:function(e){var n=d.webservices.multiexpandService+"?SecurityContext="+t.getSecurityContext(),o=e.data.parser?e.data.parser:this.defaultExpandParser;return i.makeServiceCall(n,"POST",JSON.stringify(e.data),!0,null,{timeout:0}).then(o)},defaultExpandParser:function(i,o){var r,s=i,a={},l=[],p=t.getUser("isTrigram"),g=t.getUser("isFullName");let m,f=e.getUserCustomAttributes(),h=[],v=[];if(f&&f.forEach(function(e){e.manipulationUnit&&h.push(e.curi),e.multiValuated&&v.push(e.curi)}),"string"==typeof i&&(s=JSON.parse(i).results),!s)return{};for(var C=0;C<s.length;C++)if(void 0!==(r=s[C]).attributes){var b={},y={grid:{}};let i;for(var _=0;_<r.attributes.length;_++){b[r.attributes[_].name]=r.attributes[_].value;var D=c[r.attributes[_].name];if("did"===r.attributes[_].name)i=parseInt(r.attributes[_].value,10),a[i]=r;else if("taxonomies"===r.attributes[_].name)-1!==r.attributes[_].value.indexOf(u.type_act_logref)?y.type=u.type_act_logref:-1!==r.attributes[_].value.indexOf(u.type_act_loginstance)&&(y.type=u.type_act_loginstance);else if("physicalid"===r.attributes[_].name||"logicalid"===r.attributes[_].name||"majorid"===r.attributes[_].name)y[r.attributes[_].name]=r.attributes[_].value,y.grid[r.attributes[_].name]=r.attributes[_].value;else if("ds6w:label"===r.attributes[_].name)y.label=r.attributes[_].value;else if("ds6w:type"===r.attributes[_].name){var S=d.mappingType[r.attributes[_].value];S?(y.grid[D]=S.nlsName,y.icons=[t.getTypeIconUrl(r.attributes[_].value)]):(y.grid[D]=r.attributes[_].value,y.icons=[t.getTypeIconUrl(u.type_act_logref)]),y.grid.actualType=r.attributes[_].value}else if("ds6w:status"===r.attributes[_].name)y[D]=r.attributes[_].value,y.grid[D]=d.MAPPING_MATURITY[r.attributes[_].value.split(".")[1]];else if("ds6w:created"===r.attributes[_].name||"ds6w:modified"===r.attributes[_].name)y.grid[D]=e.formatDate(r.attributes[_].value);else if("ds6wg:plmreference.v_islastversion"===r.attributes[_].name)y.grid.isLastVersion="TRUE"===r.attributes[_].value;else if("ds6w:reserved"===r.attributes[_].name)y.grid.isReserved=r.attributes[_].value;else if("ds6w:reservedBy"===r.attributes[_].name)y.grid.reservedBy=r.attributes[_].value?r.attributes[_].value:"";else if("ds6wg:EXC_PROTECTION_EXISTS"===r.attributes[_].name)y.grid.isIPProtected="TRUE"===r.attributes[_].value;else if("ro.plminstance.v_effectivitycompiledform"===r.attributes[_].name)y[D]=r.attributes[_].value;else{var w=D||r.attributes[_].name;v.indexOf(w)>=0?h.indexOf(w)>=0?(y.grid[w+"_actual"]||(y.grid[w+"_actual"]=[]),y.grid[w+"_actual"].push(r.attributes[_].value)):(y.grid[w]||(y.grid[w]=[]),y.grid[w].push(r.attributes[_].value)):void 0!==y.grid[w]?(Array.isArray(y.grid[w])||(y.grid[w+"_actual"]?(y.grid[w]=[y.grid[w+"_actual"]],y.grid[w+"_actual"]=void 0):y.grid[w]=[y.grid[w]]),y.grid[w].push(r.attributes[_].value)):h.indexOf(w)>=0?(y.grid[w+"_actual"]=r.attributes[_].value,y.grid[w]=""):y.grid[w]=r.attributes[_].value}}y.type===u.type_act_logref?(y.grid.isIPProtected||(y.grid.isIPProtected=!1),y.grid.isReservedByOther=!1,"FALSE"===y.grid.isReserved?(y.isReserved=y.grid.isReserved,y.grid.isReserved=n.getWebappsAssetUrl("CATFLCockpitWidget","icons/I_CheckIn.png")):y.grid.reservedBy===p||y.grid.reservedBy===g?(y.isReserved=y.grid.isReserved,y.grid.isReserved=n.getWebappsAssetUrl("CATFLCockpitWidget","icons/I_lock.png")):(y.isReserved=y.grid.isReserved,y.grid.isReserved=n.getWebappsAssetUrl("CATFLCockpitWidget","icons/I_ReservedByOthers.png"),y.grid.isReservedByOther=!0),f&&f.forEach(function(e){e.bo?void 0===y.grid[e.curi]&&(y.grid[e.curi]=""):void 0===y.grid["instance_"+e.curi]&&(y.grid["instance_"+e.curi]="")}),y.grid.description=y.grid.description||"",y.grid.architectureNumber=y.grid.architectureNumber||"",r.attributes=y):(r.attributes=y,r.attributes.grid=b),r.attributes.physicalid===o&&(m=i)}else if(void 0!==r.path){let e=r.path;m&&(e=e.slice(e.indexOf(m))),l.push(e)}else if(r.icon__default_thumbnail_2d){var I=r.icon__default_thumbnail_2d;for(_=0;_<I.length;_++){var A=I[_].did,F=I[_].icon,k=I[_].thumbnail_2d;A.forEach(function(e){a[e].attributes.icons=[{iconPath:F,iconSize:{height:"16px",width:"16px"}}],a[e].attributes.thumbnail=k})}}return{map:a,paths:l}},expandV2:function(e){var t=d.webservices.progressiveExpand;return"Flat"===e.synthType&&(g.withConfigFilter_FlatSynth_Json.batch.expands[0].label="SAX_FlatSynthWithCfg_"+Date.now(),g.withConfigFilter_FlatSynth_Json.batch.expands[0].root.physical_id=e.forSynthesis.IDs,e.forSynthesis.configFilter?(g.withConfigFilter_FlatSynth_Json.batch.expands[0].filter.config_filter=e.forSynthesis.configFilter,g.withConfigFilter_FlatSynth_Json.batch.expands[0].filter.all&&delete g.withConfigFilter_FlatSynth_Json.batch.expands[0].filter.all):(g.withConfigFilter_FlatSynth_Json.batch.expands[0].filter.all=1,g.withConfigFilter_FlatSynth_Json.batch.expands[0].filter.config_filter&&delete g.withConfigFilter_FlatSynth_Json.batch.expands[0].filter.config_filter)),i.makeServiceCall(t,"POST",JSON.stringify(g.withConfigFilter_FlatSynth_Json),!0,null,{timeout:0})},navigate:function(n){n.attributes=n.attributes.concat(e.getUserCustomAttributesCURI().bo);let o=d.webservices.navigateService+"?SecurityContext="+t.getSecurityContext();return i.makeServiceCall(o,"POST",JSON.stringify(n),!0,null,{timeout:0}).then(function(e){if((e=e&&UWA.is(e,"string")?JSON.parse(e):e)&&e.infos&&"OK"===e.infos.status){let t,i=e.result,n={};return i.forEach(function(e){let i={};i.input_object=r.attributes([e.input_object]);let o=e.outputs;for(t in o)i[t]=r.attributes(o[t]);n[e.input_object.physicalid]=i}),n}})},getGroupingNodes:function(e){for(var n=e.data||{},o=e.filterBI,r={},s=[],a=0;a<e.pathIds.length;a++){var l=e.pathIds[a][0];void 0===r[l]&&(r[l]=[],s.push(l)),r[l].push(e.pathIds[a])}n.rootPhID=s[0];var c={};if("function"!=typeof o.getGroupingSpec)return console.error("WSIndexCommon.getGroupingNodes: getGroupingSpec not found on FBIProxy"),void reject();{let t=[],i=e.grouping.groups,r="GetGroupingNodes-sax";t.push([n.rootPhID]),c=o.getGroupingSpec(t,i,r)}var u=d.webservices.progressiveExpand+"?output_format=cvjson&SecurityContext="+t.getSecurityContext();return i.makeServiceCall(u,"POST",JSON.stringify(c),!0,null,{timeout:0})},expandGroupingNode:function(n){let o,s=n.FBIProxy||n.filterBI,a={},l=[];for(let e=0;e<n.pathIds.length;e++){let t=n.pathIds[e][0];void 0===a[t]&&(a[t]=[],l.push(t)),a[t].push(n.pathIds[e])}let c=n.data.expandLevel||-1;var u=widget.getValue("component-view");u===p.flattenedView?c=widget.getPreference(p.depthFlattenedView).value:u===p.flattenedViewOnlyArchitectureItem&&(c=widget.getPreference(p.depthFlattenedViewArchitectureItemOnly).value);var g={groupingIntent:n.groupingFilter};g.root_path_physicalid=a[l[0]];var m=s.getExpandSpec(l[0],g),f={},h=n.select_bo?n.select_bo:d.identifiers.index_services.select_bo.slice(),v=n.select_rel?n.select_rel:d.identifiers.index_services.select_rel.slice(),C=e.getUserCustomAttributesCURI();h=h.concat(C.bo),v=v.concat(C.rel),f.select_object=h,f.select_relation=v,o={batch:m.batch,outputs:f};var b=d.webservices.progressiveExpand+"?output_format=cvjson&SecurityContext="+t.getSecurityContext();return i.makeServiceCall(b,"POST",JSON.stringify(o),!0,null,{timeout:0}).then(e=>(e=UWA.is(e,"string")?JSON.parse(e):e,r.progressiveExpandParser(e)))},expandOnlyOtherGroupingNode:function(n){let o,s=n.FBIProxy||n.filterBI,a={},l=[];for(let e=0;e<n.pathIds.length;e++){let t=n.pathIds[e][0];void 0===a[t]&&(a[t]=[],l.push(t)),a[t].push(n.pathIds[e])}let c=n.data.expandLevel||-1,u="Expand-Level-"+(-1===c?"All":c);var p=n.batch?n.batch:this.createBatch({queryLabel:u,pathsWithRoot:a,expandLevel:c,FBIProxy:s,groupingIntent:n.groupingIntent}),g={},m=n.select_bo?n.select_bo:d.identifiers.index_services.select_bo.slice(),f=n.select_rel?n.select_rel:d.identifiers.index_services.select_rel.slice(),h=e.getUserCustomAttributesCURI();m=m.concat(h.bo),f=f.concat(h.rel),g.select_object=m,g.select_relation=f,n.select_relation&&-1===g.select_relation.indexOf("ro.plminstance.v_treeorder")&&(g.select_relation=g.select_relation.concat(n.select_relation)),g.select_object=g.select_object.filter(function(e,t,i){return i.indexOf(e)===t}),o={batch:p,outputs:g};var v=d.webservices.progressiveExpand+"?output_format=cvjson&SecurityContext="+t.getSecurityContext();return i.makeServiceCall(v,"POST",JSON.stringify(o),!0,null,{timeout:0}).then(e=>(e=UWA.is(e,"string")?JSON.parse(e):e,r.progressiveExpandParser(e)))},createBatch:function(e){for(var t={expands:[]},i=e.pathsWithRoot,n=e.expandLevel,o=Object.keys(i),r=e.queryLabel,s=0;s<o.length;s++){for(var a=i[o[s]],l=[],c=0;c<a.length;c++)l.push({physical_id_path:a[c]});var d=e.FBIProxy.getFilterSpec(o[s],{V2:{prefixPathArray:l,appQueryObj:{}}}),u=(e.FBIProxy.getGroupingSpec(o,e.groupingIntent,"grpFL"),this.buildAggregationProcessor(l,n));Array.isArray(d.aggregation_processors)&&d.aggregation_processors.length>0&&(u=u?u.concat(d.aggregation_processors):d.aggregation_processors),t.expands.push({label:r,root:{physical_id:o[s]},filter:d.filter,aggregation_processors:u})}return t},buildAggregationProcessor:function(e,t){var i;return t>-1&&(i=[{truncate:{max_distance_from_prefix:t,prefix_filter:{prefix_path:e}}}]),i}}}),define("DS/CATFLCockpitWidget/utils/gridview.util",["DS/UIKIT/Mask","DS/CATFLCockpitWidget/model/CATFLCockpitTreeDocument","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/model.events.util","WebappsUtils/WebappsUtils","DS/CATFLCockpitWidget/mixins/CATFLBIGroup","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/document.service","DS/CATFLCockpitWidget/services/index.service","DS/CATFLCockpitWidget/services/modeler.service","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/services/implementlink.service","DS/CATFLCockpitWidget/services/space.service","DS/CATFLCockpitWidget/parser/index.parser","DS/CATFLCockpitWidget/parser/database.parser","text!DS/CATFLCockpitWidget/assets/config/navigate.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,g,m,f,h,v,C){"use strict";var b=o.getFullConfig(),y=b.identifiers,_=b.localStorageKeys,D=JSON.parse(v),S={createTreeDocumentFromIndexResponse:function(e,i,o,r){var s,a,l,c,d={},p=[],g=e.map,m=e.paths,f=!1,h={},v=widget.getValue(_.componentView),C=widget.getValue("ngFilter"),b=C&&C.length>0;if(i||(f=!0,i=new t({useAsyncPreExpand:!0}),this._addExpandCollapseBehaviors(i,r,!1)),!f&&o||(g[m[0][0]].attributes.noIndexOrDBExpand=!0,o=this._addLogItemIndexResponse(i,null,g[m[0][0]]),0==Object.keys(i.mappedNodesToIds).length&&o.options.physicalid.length>0&&(i.mappedNodesToIds[o.options.physicalid]=[o])),1===m.length&&1===m[0].length)return i;i.prepareUpdate();let D={};i.getRoots()[0].getAllDescendants().forEach(function(e){e.options.type===y.type_act_logref&&e.options.instance&&(D[e.options.instance.physicalid]||(D[e.options.instance.physicalid]=[]),D[e.options.instance.physicalid].push(e))});var S,w=o;h[m[0][0]]=i.getRoots()[0];for(var I=0;I<m.length;I++)for(var A=1;A<m[I].length;A+=2)if(s=g[m[I][A]],(a=g[m[I][A+1]]).attributes.type!==y.type_act_logref||v!==_.flattenedViewOnlyArchitectureItem||0!==a.attributes.grid.architectureNumber.length){if(v===_.structuredView||s.alreadyAdded||(s.alreadyAdded=!0),(b||v!==_.structuredView&&A<m[I].length-2)&&(a.attributes.noIndexOrDBExpand=!0),v===_.structuredView?w=h[c=m[I].slice(0,A).join("|")]?h[c]:o:v===_.structuredView||f||b||e.srcFromNGFilter||(w=l||o),S=h[c=m[I].slice(0,A).join("|")]?h[c]:o,D){let e=D[s.attributes.physicalid],t=S.getOccurencePath();if(e&&t){let i;t.push(s.attributes.physicalid,a.attributes.physicalid);let n=JSON.stringify(t);for(let t=0;t<e.length;t++)if(JSON.stringify(e[t].getOccurencePath())===n){i=!0,h[c=m[I].slice(0,A+2).join("|")]=e[t];break}if(i)continue}}if(a.attributes.type===y.type_act_logref){var F=a.attributes.physicalid;if(n.checkIfRecentlyAuthored(F,!0)){var k={};s&&(k.pid=s.attributes.physicalid,k.visualCue=s.attributes.visualCue,k.name=s.attributes.label),p.push(u.expand({itemIDs:[F],depth:"1",configFilter:r}).then(this.addStructureToChild.bind(this,F,w,k,D)));break}h[c=m[I].slice(0,A+2).join("|")]?l=h[c]:(l=this._addLogItemIndexResponse(w,s,a,S),h[c]=l,l.options.type===y.type_act_logref&&l.options.instance&&(D[l.options.instance.physicalid]||(D[l.options.instance.physicalid]=[]),D[l.options.instance.physicalid].push(l)),n.checkIfRecentlyAuthored(F)&&(void 0===d[F]&&(d[F]=[]),d[F].push(l)))}}return n.checkIfRecentlyAuthored(o.options.physicalid)&&(d[o.options.physicalid]=[o]),Object.keys(d).length>0&&p.push(u.refreshTreeNodeModel(d),!1),Promise.all(p).finally(function(){i.pushUpdate(),b&&(o.options.noIndexOrDBExpand=!0),i&&i.getRoots()[0].expand()}),i},addStructureToChild:function(e,t,i,n,o){let r=o[e],s=r.map[r.rootUuid];this._addLogItemDslogModelerResponse(t,s,r.map,i,null,n)},createTreeDocumentFromDslogModelerResponse:function(e,i){i||(i=new t({useAsyncPreExpand:!0})),i.prepareUpdate(),this._addLogItemDslogModelerResponse(i,e.map[e.rootUuid],e.map);var n=i.getRoots()[0];return 0==Object.keys(i.mappedNodesToIds).length&&n.options.physicalid.length>0&&(i.mappedNodesToIds[n.options.physicalid]=[n]),this._addExpandCollapseBehaviors(i,null,!0),i.pushUpdate(),i.getRoots()[0].expand(),i},_addLogItemIndexResponse:function(e,t,n,o){var r=JSON.parse(JSON.stringify(n));if(null!==t)for(var s in r.attributes.instance={physicalid:t.attributes.physicalid,visualCue:t.attributes.visualCue,effectivitycompiledform:t.attributes.effectivitycompiledform,modificationDate:t.attributes.grid.modificationDate},r.attributes.grid.instanceName=t.attributes.label,t.attributes.grid)t.attributes.grid.hasOwnProperty(s)&&(r.attributes.grid["instance_"+s]=t.attributes.grid[s]);r.attributes.children=[];var a=e.addChild(new i(r.attributes));return t&&a.setRelationID(t.attributes.physicalid),o&&(a.options.actualParent=o),a},_addLogItemDslogModelerResponse:function(e,t,n,o,r,s){var a=this,l=r||0;!r&&e.options.actualDepth&&(l=e.options.actualDepth+1);var c,d,u=JSON.parse(JSON.stringify(t)),p=widget.getValue(_.componentView),g=!0;p===_.flattenedView?c=widget.getPreference(_.depthFlattenedView).value:p===_.flattenedViewOnlyArchitectureItem&&(c=widget.getPreference(_.depthFlattenedViewArchitectureItemOnly).value,e.getRoot&&0==u.attributes.grid.architectureNumber.length&&(g=!1,d=e));var m=!1;if(s&&void 0!==o){let t=s[o.pid],i=e.getOccurencePath();if(t&&i){i.push(o.pid,u.attributes.physicalid);let e=JSON.stringify(i);for(let i=0;i<t.length;i++)if(JSON.stringify(t[i].getOccurencePath())===e){m=!0,d=t[i];break}}}!m&&g&&(u.attributes.children=[],d=new i(u.attributes),o&&d.setRelationID(o.pid),d.options.actualParent=e,d.options.actualDepth=l,p!==_.structuredView&&void 0!==e.getRoot&&l<=parseInt(c,10)?e.getRoot().addChild(d):e.addChild(d),o&&(d.options.instance={physicalid:o.pid,visualCue:o.visualCue,modificationDate:o.modificationDate},d.options.grid.instanceName=o.name,d.options.grid.cue="",d.options.grid.instance_actualType=o.actualType,d.options.grid.instance_description=o.description||"",d.options.grid=Object.assign(d.options.grid,o.customAttributes)),s&&o&&d.options.type===y.type_act_logref&&d.options.instance&&(s[d.options.instance.physicalid]||(s[d.options.instance.physicalid]=[]),s[d.options.instance.physicalid].push(d))),u.instances&&(d.options.noIndexOrDBExpand=!0,++l,u.instances.forEach(function(e){var t=a._getInstDetailsFromModelerResp(e);a._addLogItemDslogModelerResponse(d,n[e.toUuid],n,t,l,s)}))},_getInstDetailsFromModelerResp:function(e){if(!e)return;var t,i={},o={},r=n.getUserCustomAttributes();let s=[],a=[];r&&r.forEach(function(e){i[e.selectable.toLowerCase()]=e,e.manipulationUnit&&s.push(e.curi),e.multiValuated&&a.push(e.curi)});for(var l={pid:e.physicalid,visualCue:e.visualCue,customAttributes:o,actualType:e.type},c=0;c<e.attributes.length;c++)if("PLMInstance.PLM_ExternalID"===e.attributes[c].name)l.name=e.attributes[c].value;else if("PLMInstance.V_description"===e.attributes[c].name)l.description=e.attributes[c].value;else if("modified"===e.attributes[c].name)l.modificationDate=n.formatDate(e.attributes[c].value);else if("owner"===e.attributes[c].name)t=e.attributes[c].value;else{var d=i[e.attributes[c].name.toLowerCase()];if(d){if(a.indexOf(d.curi)>=0){var u=[];e.attributes[c].value&&(u=e.attributes[c].value.split(/\u0007/)),o["instance_"+d.curi]=u}else o["instance_"+d.curi]=e.attributes[c].value||"";s.indexOf(d.curi)>=0&&(o["instance_"+d.curi+"_actual"]=o["instance_"+d.curi],o["instance_"+d.curi]="")}}return o["instance_ds6w:responsible"]=t,l.customAttributes=o,l},_createCategoryNode:function(e,t){return e.addChild(new i(t))},_addExpandCollapseBehaviors:function(e,t,i){var n=this;e.onPreExpand(function(t){if(t.target.options.isGroupingNode){if(t.target.options.hasBeenExpanded)return void t.target.preExpandDone();a.expandGroupNode({level:"1",selectedNode:t.target,gridViewUtilCtx:n,params:{collectionView:{getContent:function(){return widget.body},treeDocument:e},onPreExpand:!0}})}else{if(t.target.options.hasBeenExpanded||t.target.options.type!==y.type_act_logref)return void t.target.preExpandDone();S.expandNodestoNLevel({level:"1",selectedNodes:[t.target],params:{collectionView:{getContent:function(){return widget.body},treeDocument:e},onPreExpand:!0}})}}),e.onPostExpand(function(e){this.getModelEvents().publish({event:"colorizeNodesFromTagger"})})},crRecTimeoutToCheckTreeDocExp:function(e,t){var i=this;e&&(e.isExpanding()?setTimeout(function(){i.crRecTimeoutToCheckTreeDocExp(e,t)},200):t())},addDBExpandCallBack:function(e,t,i,n){var o=this;if(!i.map[i.rootUuid]||i.map[i.rootUuid].instances){n&&!t&&(t={},n.getRoots()[0].getAllDescendants().forEach(function(e){e.options.type===y.type_act_logref&&e.options.instance&&(t[e.options.instance.physicalid]||(t[e.options.instance.physicalid]=[]),t[e.options.instance.physicalid].push(e))}));var r=i.map[i.rootUuid].instances;n&&n.prepareUpdate(),r.forEach(function(n){var r=o._getInstDetailsFromModelerResp(n);o._addLogItemDslogModelerResponse(e,i.map[n.toUuid],i.map,r,null,t)}),n&&n.pushUpdate()}},addDBNavigate:function(e,t){let i,n=this,o=widget.getValue(_.componentView),s=[],a=[];for(i=e.length-1;i>=0;i--){var l=e[i];l.options.physicalid&&(l.isRoot()||l.options.instance&&l.options.instance.physicalid)?s.indexOf(l.options.physicalid)<0&&s.push(l.options.physicalid):e.splice(i,1)}let c=!0,d=!0,p=!0,g=!0,m=!0;if(t&&t.navigateTypes){let e=t.navigateTypes,i=widget.getValue("configurable_expand")||{};c=e.indexOf("ZONE")>=0||!1,d=e.indexOf("SPECIFICATION_DOCUMENT")>=0&&i.specDocs||!1,p=e.indexOf("PROPOSED_SOLUTION")>=0&&i.proposedSolution||!1,g=e.indexOf("IMPLEMENTEDBY_LINK")>=0&&i.implementedBy||!1,m=e.indexOf("IMPLEMENTING_LINK")>=0&&i.implementing||!1}if(c&&a.push("dsmvlog:Reference.SPPConnection.Details"),d&&a.push("dsmvlog:Reference.SpecificationDocument.Details"),p&&a.push("dsmvlog:Reference.ProposedSolution.Details"),g&&o===_.structuredView&&a.push("dsmvlog:Reference.ImplementLink.ImplementedBy.Details"),m&&o===_.structuredView&&a.push("dsmvlog:Reference.ImplementLink.Implementing.Details"),!(a.length<=0))return u.navigate({payload:s,fields:a}).then(function(i){let s=[],l=!1;e.forEach(function(e){let r=i[e.options.physicalid];if(r){let i,s=[e];for(i in t&&t.treeDocument&&(s=t.treeDocument.getMappedNodesFromId(e.options.physicalid)),0==Object.keys(r).length&&c?r.SPPConnections=[]:1===Object.keys(r).length&&d&&1===a.length&&(r.specificationDocument=[]),g&&!r["Implemented by"]&&(e.options.implementLinks||(e.options.implementLinks={}),e.options.implementLinks.implemented=!1),m&&!r.Implementing&&(e.options.implementLinks||(e.options.implementLinks={}),e.options.implementLinks.implementing=!1),l||!m&&!g||(l=!0),r)if("proposedsolution"===i)s.forEach(function(e){n.updateSolutionsOnNode(e,r[i],t)});else if("Implementing"===i&&o===_.structuredView){let e={objType:"ref",linkType:"implementing"};s.forEach(function(o){n.updateLinksOnNode(e,o,r[i],t)})}else if("Implemented by"===i&&o===_.structuredView){let e={objType:"ref",linkType:"implemented"};s.forEach(function(o){n.updateLinksOnNode(e,o,r[i],t)})}else if("specificationDocument"===i)s.forEach(function(e){n.updateDocsOnNode(y.type_spec_document,e,r[i],t)});else if("SPPConnections"===i){var u=h.parseDBSpaceData(r[i]);s.forEach(function(e){n.updateSpacesOnNode(e,u)})}}e.options.instance&&s.push(e.options.physicalid)}),l&&s.length>0&&r.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-referenceLinks-loaded",data:s})})},addIndexNavigate:function(e,t){let i,n=this,o=widget.getValue(_.componentView),s=Object.assign({},D.basic);for(s.input_physical_ids=[],i=e.length-1;i>=0;i--){var a=e[i];a.options.physicalid&&(a.isRoot()||a.options.instance&&a.options.instance.physicalid)?s.input_physical_ids.push(a.options.physicalid):e.splice(i,1)}if(0==s.input_physical_ids.length)return;s.label="navigate_rel_logref",s.primitives=[],s.patterns={},s.patternTypeFilters={};let l=D[y.type_act_logref],c=!0,u=!0,p=!0,g=!0,m=!0,h=widget.getValue("configurable_expand")||{};if(t&&t.navigateTypes){let e=t.navigateTypes;c=e.indexOf("ZONE")>=0||!1,u=e.indexOf("SPECIFICATION_DOCUMENT")>=0&&h.specDocs||!1,p=e.indexOf("PROPOSED_SOLUTION")>=0&&h.proposedSolution||!1,g=e.indexOf("IMPLEMENTEDBY_LINK")>=0&&h.implementedBy||!1,m=e.indexOf("IMPLEMENTING_LINK")>=0&&h.implementing||!1}return c&&(s.primitives.push(l.ZONE.primitives),s.patterns.ZONE=l.ZONE.patterns),u&&(s.primitives.push(l.SPECIFICATION_DOCUMENT.primitives),s.patterns.SPECIFICATION_DOCUMENT=l.SPECIFICATION_DOCUMENT.patterns),p&&(s.primitives.push(l.PROPOSED_SOLUTION.primitives),s.patterns.PROPOSED_SOLUTION=l.PROPOSED_SOLUTION.patterns),g&&o===_.structuredView&&(s.primitives.push(l.IMPLEMENTEDBY_LINK.primitives),s.patterns.IMPLEMENTEDBY_LINK=l.IMPLEMENTEDBY_LINK.patterns,s.patternTypeFilters.IMPLEMENTEDBY_LINK=l.IMPLEMENTEDBY_LINK.patternTypeFilters),m&&o===_.structuredView&&(s.primitives.push(l.IMPLEMENTING_LINK.primitives),s.patterns.IMPLEMENTING_LINK=l.IMPLEMENTING_LINK.patterns,s.patternTypeFilters.IMPLEMENTING_LINK=l.IMPLEMENTING_LINK.patternTypeFilters),s.primitives.length<=0?void 0:d.navigate(s).then(function(i){let s=[],a=!1;e.forEach(function(e){let r=i[e.options.physicalid];if(r){let i;for(i in c&&!r.ZONE&&(r.ZONE=[]),g&&!r.IMPLEMENTEDBY_LINK&&(e.options.implementLinks||(e.options.implementLinks={}),e.options.implementLinks.implemented=!1),m&&!r.IMPLEMENTING_LINK&&(e.options.implementLinks||(e.options.implementLinks={}),e.options.implementLinks.implementing=!1),a||!m&&!g||(a=!0),r)if("PROPOSED_SOLUTION"===i)n.updateSolutionsOnNode(e,r[i],t);else if("IMPLEMENTING_LINK"===i&&o===_.structuredView){let o={objType:"ref",linkType:"implementing"},s=n.formImplLinksFromNavigatedData(r[i]);s=f.attributes(s),n.updateLinksOnNode(o,e,s,t)}else if("IMPLEMENTEDBY_LINK"===i&&o===_.structuredView){let o={objType:"ref",linkType:"implemented"},s=n.formImplLinksFromNavigatedData(r[i]);s=f.attributes(s),n.updateLinksOnNode(o,e,s,t)}else if("REFERENCE_DOCUMENT"===i)n.updateDocsOnNode(y.type_attach_document,e,r[i],t);else if("SPECIFICATION_DOCUMENT"===i)n.updateDocsOnNode(y.type_spec_document,e,r[i],t);else if("ZONE"===i){let t=n.formSpacesFromNavigatedData(r[i]);t=f.attributes(t),n.updateSpacesOnNode(e,t)}}e.options.instance&&s.push(e.options.physicalid)}),a&&s.length>0&&r.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-referenceLinks-loaded",data:s})})},formImplLinksFromNavigatedData:function(e){let t=[];return e&&e.length>0&&e.forEach(function(e){let i=e.elements[0];i.implementlink={id:e.owner.physicalid},t.push(i)}),t},formSpacesFromNavigatedData:function(e){let t=[];return e&&e.length>0&&e.forEach(function(e){let i=e.elements[0];i.connectionId=e.owner.physicalid,t.push(i)}),t},updateSolutionsOnNode:function(e,t,n){let r=e.options.instance?e.options.instance.physicalid:"",s=e.getNodesByRelId("proposedsolution"+r)[0];!t||t.length<=0?s&&e.removeChild(s):(e.options.hasProposedSolution=!0,s?s.removeChildren():((s=new i({label:C.label_proposed_solution,icons:[{iconName:"product"}],type:"proposedSolutionCategory",editableFlag:!1})).setRelationID("proposedsolution"+r),e.addChild(s),e.updateOptions()),this.validateNLSTypesForItems(t).then(function(){f.parseDataToNodeFormat({virtual:!0,data:t}).forEach(function(e){e.icons[0]||(e.icons=[o.getTypeIconUrl(y.type_act_physical)]),s.addChild(new i(e))}),n&&n.bExpand&&s.expand()}))},validateNLSTypesForItems:function(e){let t=[],i=[];if(e.forEach(function(e){e.type||(t.indexOf(e.actualType)<0&&t.push(e.actualType),i.push(e))}),t.length>0){let e={"ds6w:type":t};return l.getPredicateValues(e).then(function(e){if(e){let t,n=e["ds6w:type"];for(t in i.forEach(function(e){!e.type&&n[e.actualType]&&(e.type=n[e.actualType])}),n)b.mappingType[t]||(b.mappingType[t]={}),b.mappingType[t].nlsName=n[t]}})}return Promise.resolve()},updateLinksOnNode:function(e,t,n,r){let s=this,a=t.options.instance?t.options.instance.physicalid:"",l=e.linkType+e.objType,c=C[l],d=t.getNodesByRelId(l+a)[0];!n||n.length<=0?d&&t.removeChild(d):(d?d.removeChildren():((d=s._createCategoryNode(t,{label:c,type:"implementLinksCategory",icons:[{iconName:"forward"}],editableFlag:!1})).setRelationID(l+a),t.addChild(d),t.updateOptions()),"ref"===e.objType&&(t.options.implementLinks||(t.options.implementLinks={}),n&&n.length>0?t.options.implementLinks[e.linkType]=!0:t.options.implementLinks[e.linkType]=!1),s.validateNLSTypesForItems(n).then(function(){f.parseDataToNodeFormat({virtual:!0,data:n}).forEach(function(n){n.linkInfo=JSON.parse(JSON.stringify(e));let r=n.implementlink||n.grid.implementlink;n.linkInfo.implementId=r?r.id:null;let s=n.implementLinkContext||n.grid.implementLinkContext;s||"ref"!==e.objType||("implementing"===e.linkType?(s=C.implementingref+": "+t.options.label+" "+t.options.grid.revision+"::",s+=C.implementedref+": "+n.label+" "+n.grid.revision):(s=C.implementingref+": "+n.label+" "+n.grid.revision+"::",s+=C.implementedref+": "+t.options.label+" "+t.options.grid.revision)),s&&(s=s.split("::"),n.grid.titleTooltip="",s.forEach(function(e){n.grid.titleTooltip+=e+"\n"}),n.grid.titleTooltip=n.grid.titleTooltip.substr(0,n.grid.titleTooltip.length-1)),n.icons[0]||("R"===n.grid.kindOfRFLP?n.icons=[o.getTypeIconUrl(y.type_requirement)]:"F"===n.grid.kindOfRFLP?n.icons=[o.getTypeIconUrl(y.type_act_functref)]:"L"===n.grid.kindOfRFLP?n.icons=[o.getTypeIconUrl(y.type_act_logref)]:"P"===n.grid.kindOfRFLP&&(n.icons=[o.getTypeIconUrl(y.type_act_physical)])),d.addChild(new i(n))}),r&&r.bExpand&&d.expand()}))},updateDocsOnNode:function(e,t,n,r){let s,a=t.options.instance?t.options.instance.physicalid:"",l=t.getNodesByRelId(e+a)[0];s=e===y.type_attach_document?C.label_ref_documents:C.label_spec_documents,!n||n.length<=0?l&&t.removeChild(l):(l?l.removeChildren():((l=new i({label:s,icons:[{iconName:"doc"}],type:e,editableFlag:!1})).setRelationID(e+a),t.addChild(l),t.updateOptions()),this.validateNLSTypesForItems(n).then(function(){f.parseDataToNodeFormat({virtual:!0,data:n}).forEach(function(e){e.icons[0]||(e.icons=[o.getTypeIconUrl(y.type_document)]),l.addChild(new i(e))}),r&&r.bExpand&&l.expand()}))},updateSpacesOnNode:function(e,t){if(!t||t.length<=0)e.options.assignedSpacesPID=[],e.updateOptions({grid:{assignedSpaces:""}});else{var i={assignedSpacesPID:[],grid:{assignedSpaces:""}};e.options.grid.assignedSpaces="";for(var n=0;n<t.length;n++)i.assignedSpacesPID.push({obj:t[n].physicalid,owner:t[n].connectionId}),i.grid.assignedSpaces+=t[n].label+", ";i.grid.assignedSpaces=i.grid.assignedSpaces.slice(0,-2),e.updateOptions(i)}},_addOccImplementLinksToNode:function(e){var t=this;if(!e.isRoot())return g.getInstanceImplementLinks([e],!0).then(function(e){e&&e.forEach(function(e){t.manageImplementLinkResp(e.node,"inst",e,{keepNodes:!0})})})},manageImplementLinkResp:function(e,t,i,n){var o=this,r=e.options.instance?e.options.instance.physicalid:"";if("ref"===t&&(e.options.implementLinks||(e.options.implementLinks={})),i){var s;if(!i.implementing&&!n.keepNodes)(s=e.getNodesByRelId("implementing"+t+r)[0])&&s.remove();if(!i.implemented&&!n.keepNodes)(s=e.getNodesByRelId("implemented"+t+r)[0])&&s.remove();["implementing","implemented"].forEach(function(s){if(i[s]){var a=C[s+t],l=e.getNodesByRelId(s+t+r)[0];l?n.keepNodes||l.removeChildren():(l=o._createCategoryNode(e,{label:a,type:"implementLinksCategory",icons:[{iconName:"forward"}]})).setRelationID(s+t+r);var c=i[s]&&i[s].member?i[s].member:i[s];"ref"===t&&(c&&c.length>0?e.options.implementLinks[s]=!0:e.options.implementLinks[s]=!1);var d={objType:t,linkType:s};o._parseImplementLinksAndAddToNode(c,d,l),n&&n.bExpand&&l.expand()}})}},_parseImplementLinksAndAddToNode:function(e,t,n){var r=!1;"inst"===t.objType&&(r=!0),e.forEach(function(e){var s,a,l;let c=e.implementlink;if(r&&(e=e.reference&&e.reference.member?e.reference.member[0]:e.reference),"R"===e.kindOfRFLP)s=y.type_requirement,a=[o.getTypeIconUrl(s)];else if("F"===e.kindOfRFLP)s=y.type_act_functref,a=[o.getTypeIconUrl(s)];else if("L"===e.kindOfRFLP)s=y.type_act_logref,a=[o.getTypeIconUrl(s)];else{if("P"!==e.kindOfRFLP)return;s=y.type_act_physical,a=[o.getTypeIconUrl(s)]}var d=u.defaultCRSParser(e);d.type=s,d.icons=a,d.grid.isLastVersion="TRUE"===e.isLastVersion,d.virtual=!0,d.linkInfo=JSON.parse(JSON.stringify(t)),d.linkInfo.implementId=c?c.id:null,(l=c?c.implementLinkContext:null)&&(l=l.split("::"),d.grid.titleTooltip="",l.forEach(function(e){d.grid.titleTooltip+=e+"\n"}),d.grid.titleTooltip=d.grid.titleTooltip.substr(0,d.grid.titleTooltip.length-1)),n.addChild(new i(d)),n.updateOptions()}),null===n.getChildren()&&n.getParent().removeChild(n)},addAssignedSpacesAttribute:function(e){let t=this,i=[];if(null==e||0===e.length)return Promise.resolve();let o=e.filter(function(e){return e.options.physicalid}),r=[],s=[];if(widget.getPreference(_.disableIndexAcceleration).value)r=o;else{let e=n.sortNodesIntoDBandIndex(o,!1);r=e.databaseNodes,s=e.indexNodes}return 0==r.length&&0===s.length?Promise.resolve():(r.length>0&&i.push(t.addDBNavigate(r,{navigateTypes:["ZONE"]})),s.length>0&&i.push(t.addIndexNavigate(s,{navigateTypes:["ZONE"]})),Promise.all(i))},expandNodestoNLevel:function(t){let i=t.level,o=t.selectedNodes,r=[];for(var s=0;s<o.length;s++){let e,t=o[s];"1"===i?e=!t.options.hasBeenExpanded:"2"===i?t.options.dontExpandTwoLvl?e=!1:t.options.hasBeenExpanded?t.getChildren().forEach(function(t){t.options.type===y.type_act_logref&&t.options.instance&&(t.options.hasBeenExpanded||(e=!0))}):e=!0:"-1"===i&&(t.options.dontExpandAllLvl?e=!1:t.options.hasBeenExpanded?(t.getAllDescendants().forEach(function(t){t.options.type===y.type_act_logref&&t.options.instance&&(t.options.hasBeenExpanded||(e=!0))}),e||(e=!1)):e=!0),e?r.push(t):"-1"===i?t.expandAll():t.expandNLevels({numberOfLevelsToExpand:i})}if(r.length>0){var a=i||"-1";e.mask(t.params.collectionView.getContent(),C.msg_processing),n.createBatchServiceReqExecution(r,a,t.params)}},createStructFromProgExpand:function(e){let t=this,i=e.treeDocument,n=e.rootNode,o=e.data,r=widget.getValue(_.componentView);if(!o||Object.keys(o.instances).length<=0)return n.options.hasBeenExpanded=!0,i;let s,a=o.references,l=o.instances,c=n.options.resourceid||n.options.physicalid;n.options.isGroupingNode&&(c=(s=t.getParentOfGroupingNode(n)).options.resourceid||s.options.physicalid),i.prepareUpdate();for(let e in l)if(e===c){let i=l[e];for(let e=0;e<i.length;e++){let o,l=i[e],c=a[l.attributes.to];if((c.attributes.type!==y.type_act_logref||r!==_.flattenedViewOnlyArchitectureItem||0!==c.attributes.grid.architectureNumber.length)&&c.attributes.type===y.type_act_logref){let e=s||n;o=t._addLogItemIndexResponse(n,l,c,e)}}}return n.options.hasBeenExpanded=!0,i.pushUpdate(),i&&i.getRoots()[0].expand(),i},getParentOfGroupingNode:function(e){let t,i=this;if(e)return!(t=e.getParent()).isGroupingNode&&t.getID().length>0?t:i.getParentOfGroupingNode(t)}};return S}),define("DS/CATFLCockpitWidget/services/logitem.service",["DS/CATFLCockpitWidget/services/index.service","DS/CATFLCockpitWidget/services/modeler.service","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/utils/gridview.util","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d){"use strict";var u=o.getFullConfig(),p=u.identifiers,g=u.localStorageKeys;return{createLogItem:function(e){var t=u.webservices.createLogItem;return i.post(t,JSON.stringify(e)).then(function(e){var t=JSON.parse(e).member[0];return o.SAXStorage().setItem(g.recentlyAuthoredStructure+t.id,Date.now()),n.setAuthoringMode(t.id),t}).catch(function(e){n.displayError(e,null,null,d.error_create_item)})},createLogItemInstanceNew:function(e,t){var r=u.webservices.createLogItemInstanceNew+t+"/dslog:LogInstancePRIVATE";return i.post(r,JSON.stringify(e)).then(function(e){o.SAXStorage().setItem(g.recentlyAuthoredStructure+t,Date.now());var i=(e=JSON.parse(e)).member&&e.member[0]?e.member[0].reference:null;return i&&o.SAXStorage().setItem(g.recentlyAuthoredStructure+i,Date.now()),n.setAuthoringMode(),e})},getlogRefDiagramProposal:function(e){var t=u.webservices.createLogRefFromDiagramProp;return i.post(t,JSON.stringify(e),0).then(function(e){return JSON.parse(e)})},getDataForSetArchNumberOnPSpool:function(e){var t=u.webservices.getDataForSetArchNumberOnPSpool;return i.post(t,JSON.stringify(e),0).then(function(e){return JSON.parse(e)})},setArchitectureNumberOnPSpool:function(e,t){var n=u.webservices.setArchitectureNumberOnPSpool;return i.post(n,JSON.stringify(e),t)},createItemFromDialogue:function(e,t){var n=u.webservices.createLogRefFromDiagram;return i.post(n,JSON.stringify(e),t)},deleteLogItemInstance:function(e,t){t instanceof Array&&t.length>20&&n.alertMessage("warning",null,d.replace(d.msg_bulkOperation_limitReached,{limit:20}));var o="/resources/v1/modeler/dslog/dslog:LogItemPRIVATE/"+e+"/dslog:LogInstancePRIVATE/DELETE";return i.post(o,JSON.stringify(t),0).then(function(e){return n.setAuthoringMode(),JSON.parse(e)})},getLogItemWithExpand:function(t,i){var r=this;if(widget.getPreference(g.disableIndexAcceleration).value||n.checkIfRecentlyAuthored(t,!0))return r._expandFromModeler(t,i);var s=widget.getValue("ngFilter");if(s&&s.length>0){var l=JSON.parse(s);if(l.CVQuery.union||l.CVQuery.intersection||l.CVQuery.minus){var c=UWA.clone(l.CVQuery);if(c.union&&c.union.expand&&c.union.expand.length>1){for(var d=[],u=0;u<c.union.expand.length;u++){c.union.expand[u].volume_filter&&d.push(u)}for(var m=0;m<d.length;m++)c.union.expand.splice(d[m],1)}c.select_bo=p.index_services.select_bo.slice(),c.select_rel=p.index_services.select_rel.slice();var f=n.getUserCustomAttributesCURI();return c.select_bo=c.select_bo.concat(f.bo),c.select_rel=c.select_rel.concat(f.rel),c.compute_select_bo=p.index_services.select_img,c.label=widget.getValue("appId")+"-"+Math.random(),e.multiexpand({data:c}).then(function(e){return a.createTreeDocumentFromIndexResponse(e)})}}return e.expand({itemID:t,configFilter:i}).then(function(e){return null===e?(o.SAXStorage().setItem(g.recentlyAuthoredStructure+t,Date.now()),r._expandFromModeler(t,i)):a.createTreeDocumentFromIndexResponse(e[t],null,null,i)})},_expandFromModeler:function(e,i){var n=widget.getValue("component-view"),o="1";return n===g.flattenedView?o=widget.getPreference(g.depthFlattenedView).value:n===g.flattenedViewOnlyArchitectureItem&&(o=widget.getPreference(g.depthFlattenedViewArchitectureItemOnly).value),t.expand({itemIDs:[e],depth:o,configFilter:i}).then(function(t){return a.createTreeDocumentFromDslogModelerResponse(t[e])})},updateAttribute:function(e){var t=[],o=u.webservices.updateAttributes;return e instanceof Array&&e.length>1e3&&n.alertMessage("warning",null,d.replace(d.msg_bulkOperation_limitReached,{limit:1e3})),e.forEach(function(e){var i={method:"PATCH",body:[],queryParams:{select:["physicalid","modified"]}};for(var n in e.instID?i.path="model/rel/"+e.instID:i.path="model/bus/"+e.refID,e.attributes)e.attributes.hasOwnProperty(n)&&(e.attributes[n]&&e.attributes[n].unitName&&e.attributes[n].dimensionType?i.body.push({op:"replace",path:n,value:e.attributes[n].value,unitName:e.attributes[n].unitName,dimensionType:e.attributes[n].dimensionType}):i.body.push({op:"replace",path:n,value:e.attributes[n]}),i.queryParams.select.push("attribute["+n+"]"));t.push(i)}),i.makeServiceCall(o,"PUT",JSON.stringify({requests:t})).then(function(e){var t=JSON.parse(e).results,i=[];for(var n in t)0!==t[n].body.errors.length&&i.push({physicalid:t[n].body.physicalid,errors:t[n].body.errors});return 0!==i.length?Promise.reject({error:{message:d.msg_error_no_modification_possible,errorList:i}}):t})},getLogItemModel:function(e){var t=u.webservices.dsfl_getLogItem+e+"/model";return i.get(t).then(function(e){var t={};e=JSON.parse(e);var i=null;return Object.keys(e).length>0&&e.rootObjects.length>0&&(i=[],e.rootObjects.forEach(function(e){(t={}).physicalid=e.physicalid?e.physicalid:null;for(var n=0;n<e.attributes.length;n++)"id"==e.attributes[n].name?t.id=e.attributes[n].value:"name"==e.attributes[n].name&&(t.name=e.attributes[n].value);i.push(t)})),i}).catch(function(e){var t=e.error.message.slice(e.error.message.indexOf("ResponseCode")),i=d.error_get_model;t&&t.indexOf("404")>=0&&(i=d.error_get_model_media),n.displayError(e,null,null,i)})},getLogItemAttributes:function(e){return t.getAttributes({itemID:e})},displayMoreAttributes:function(t,i,o){var r=this,s=[],a=[],l=[],c=[],u=[];i.forEach(function(e){s.push(e.options.physicalid),void 0===l[e.options.physicalid]&&(l[e.options.physicalid]=[]),l[e.options.physicalid].push(e),e.options.instance&&e.options.instance.physicalid&&(a.push(e.options.instance.physicalid),void 0===c[e.options.instance.physicalid]&&(c[e.options.instance.physicalid]=[]),c[e.options.instance.physicalid].push(e))});var p=[],g=[],m=n.getUserCustomAttributes(o);m&&m.forEach(function(e){e.bo?p.push(e.curi):g.push(e.curi)}),p.length>0&&u.push(e.fetch(s,p).then(function(e){r._mapFetchResultsToTreeNodeModel(e,l,!1,o),t.requestDelayedModelData()})),g.length>0&&a.length>0&&u.push(e.fetch(a,g).then(function(e){r._mapFetchResultsToTreeNodeModel(e,c,!0),t.requestDelayedModelData()})),u.length>0?Promise.all(u).then(function(){1===i.length?o?n.alertMessage("info",null,d.msg_additional_attributes_displayed_success_single_solution):n.alertMessage("info",null,d.msg_additional_attributes_displayed_success_single):o?n.alertMessage("info",null,d.msg_additional_attributes_displayed_success_multiple_solutions):n.alertMessage("info",null,d.msg_additional_attributes_displayed_success_multiple)}):n.alertMessage("warning",null,d.warning_no_additional_attributes_to_displayed)},_mapFetchResultsToTreeNodeModel:function(e,t,i,o){let r=n.getUserCustomAttributes(o),s=[];r&&r.forEach(function(e){e.manipulationUnit&&s.push(e.curi)});for(var a=0;a<e.length;a++){var l={grid:{}};for(var c in e[a])if("resourceid"!==c){var d=e[a][c].dispValue||e[a][c].value;i?s.indexOf(c)>=0?(l.grid["instance_"+c+"_actual"]=d,l.grid["instance_"+c]=""):l.grid["instance_"+c]=d:o?s.indexOf(c)>=0?(l.grid["physical_"+c+"_actual"]=d,l.grid["physical_"+c]=""):l.grid["physical_"+c]=d:s.indexOf(c)>=0?(l.grid[c+"_actual"]=d,l.grid[c]=""):l.grid[c]=d}for(var u=t[e[a].resourceid.value],p=0;p<u.length;p++)u[p].updateOptions(l)}},getCustomField:function(e){var t="",o="";void 0!==e&&null!=e&&(t=e.options.physicalid,o=e.options.label+" "+e.options.grid.revision);var r=u.webservices.dsfl_getCustomFields;return i.post(r,JSON.stringify({parentID:t}),0).then(function(e){return JSON.parse(e)}).catch(function(e){var t=d.replace(d.error_get_customFields,{title:o});return e.errorResp&&e.errorResp.message&&500!==e.errorResp.status?t+=e.errorResp.message:UWA.is(e.error,"string")&&(t+=e.error),n.alertMessage("error",null,t),Promise.reject()})},refreshTreeNodeModel:function(e,i,n){return t.refreshTreeNodeModel(e,i,n)},refreshInstanceNodeModel:function(e,i){return t.refreshInstanceNodeModel(e,i)},getArchitectureNumberProposal:function(e){var t=u.webservices.getArchitectureNumberProposal;return i.post(t,JSON.stringify(e),0)},getANProposalForReparent:function(e){var t=u.webservices.getANProposalForReparent;return i.post(t,JSON.stringify(e),0)},setArchitectureNumber:function(e){e.architectureNumbers&&e.architectureNumbers instanceof Array&&e.architectureNumbers.length>100&&n.alertMessage("warning",null,d.replace(d.msg_bulkOperation_limitReached,{limit:100}));var t=u.webservices.setArchitectureNumber;return i.post(t,JSON.stringify(e),0)},setANandReparent:function(e){e.architectureNumbers&&e.architectureNumbers instanceof Array&&e.architectureNumbers.length>5&&n.alertMessage("warning",null,d.replace(d.msg_bulkOperation_limitReached,{limit:5}));var t=u.webservices.setANandReparent+u.webservices.getLogInstMask;return i.post(t,JSON.stringify(e),0)},detachArchitectureReferenceExtension:function(e,t){e instanceof Array&&e.length>100&&n.alertMessage("warning",null,d.replace(d.msg_bulkOperation_limitReached,{limit:100}));var o={SelectedReferences:e,action:t},r=u.webservices.detachArchitectureReferenceExtension;return i.post(r,JSON.stringify(o),0)},updateSolutionIDAttributes:function(e){e instanceof Array&&e.length>20&&n.alertMessage("warning",null,d.replace(d.msg_bulkOperation_limitReached,{limit:20}));var t=u.webservices.addSolutions;return i.post(t,JSON.stringify(e),0).then(function(e){return JSON.parse(e)})},detachSolution:function(e){var t=u.webservices.removeSolutions;return i.post(t,JSON.stringify(e),0)},replaceWithExistingRef:function(e,t,o,r){var s=u.webservices.replaceWithExistingRef+u.webservices.getLogInstMask;return i.post(s,JSON.stringify([{referenceID:o,instanceID:t,replaceWith:r}])).then(function(e){return n.setAuthoringMode(),JSON.parse(e)})},replaceWithNewRef:function(e,t,o,r,s){var a=u.webservices.replaceWithExistingRef+u.webservices.getLogInstMask,l={};s&&Object.keys(s).length>0&&(l.CustomFields=s),r&&(l.type=r),l.attributes=o?{title:o}:{};var c={replaceWith:"newReference",instanceID:t,newReference:l};return Object.keys(s).length>0&&(c.CustomFields=s),i.post(a,JSON.stringify([c])).then(function(e){return n.setAuthoringMode(),JSON.parse(e)})},replaceWithNewRevision:function(e){var t=u.webservices.replaceWithExistingRef+u.webservices.getLogInstMask;return e instanceof Array&&e.length>100&&n.alertMessage("warning",null,d.replace(d.msg_bulkOperation_limitReached,{limit:100})),i.post(t,JSON.stringify(e),0).then(function(e){return n.setAuthoringMode(),JSON.parse(e)})},reparentInstances:function(e){var t=u.webservices.reparentInstances+u.webservices.getLogInstMask;return e instanceof Array&&e.length>5&&n.alertMessage("warning",null,d.replace(d.msg_bulkOperation_limitReached,{limit:5})),i.post(t,JSON.stringify(e),0).then(function(e){return n.setAuthoringMode(),e})},getSubTypes:function(){return i.post(u.webservices.dslog_getSubTypes,JSON.stringify([u.identifiers.type_act_logref]),0).then(function(e){return JSON.parse(e)})},getSubTypesOfLogicalReferenceAndInstance:function(){return i.post(u.webservices.getTypeInfo,JSON.stringify([u.identifiers.type_act_logref,u.identifiers.type_act_loginstance]),0).then(function(e){var t=JSON.parse(e),i={};for(var n in t)if(t.hasOwnProperty(n)){var o=t[n];void 0!==o.parent&&(void 0===i[o.parent]&&(i[o.parent]=[o.parent]),i[o.parent].push(n))}return i})},consolidateLogicalDefinition:function(e){return e.instanceIds&&e.instanceIds instanceof Array&&e.instanceIds.length>1e3&&n.alertMessage("warning",null,d.replace(d.msg_bulkOperation_limitReached,{limit:1e3})),i.post(u.webservices.consolidateLogDefn,JSON.stringify(e),0).then(function(e){return JSON.parse(e)})},compareWithLastOutfitted:function(e){return i.post(u.webservices.compareWithLastOutfitted,JSON.stringify(e),0).then(function(e){return JSON.parse(e)}).catch(function(e){return Promise.reject(e)})},recomputeArchNum:function(e){return i.post(u.webservices.recomputeArchNum,JSON.stringify(e),0).then(function(e){return JSON.parse(e)}).catch(function(e){return Promise.reject(e)})},checkToUpdateSpace:function(e){var t=e.map(function(e){return e.options.physicalid});return i.post(u.webservices.checkToUpdateSpace,JSON.stringify(t),0).then(function(e){return JSON.parse(e)},function(e){return Promise.reject(e)})}}}),define("DS/CATFLCockpitWidget/utils/refresh.util",["DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/services/modeler.service","DS/CATFLCockpitWidget/services/document.service","DS/CATFLCockpitWidget/services/space.service","DS/CATFLCockpitWidget/services/implementlink.service","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/gridview.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/group.util","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","DS/UIKIT/Mask","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,g,m){"use strict";var f=c.getFullConfig(),h=f.localStorageKeys;return{addChildrenToParent:function(e,t,i,n){var o=[],r={},a=[];n=n||!1,e.prepareUpdate(),t.forEach(function(e){i.forEach(function(t){var i=new u({hasBeenExpanded:!1,noIndexOrDBExpand:!1,physicalid:t.reference,instance:{physicalid:t.id},grid:{physicalid:t.reference,instanceName:t.name,instance_description:""},actualParent:e,children:[]});t.id&&i.setRelationID(t.id),e.addChild(i),a.indexOf(e.options.physicalid)<0&&(a.push(e.options.physicalid),c.SAXStorage().setItem(h.recentlyAuthoredStructure+e.options.physicalid,Date.now())),o.indexOf(t.reference)<0&&o.push(t.reference),Object.keys(r).indexOf(t.id)<0&&(r[t.id]=i)})}),e.pushUpdate(),s.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-nodes-by-id",data:{arrayOfPID:o,tagAsRecentlyAuthored:n}})},refreshNodeDetails:function(t){var i=this,n=t.arrayOfPID,o=t.tagAsRecentlyAuthored,r={},s=[],l=[];n&&(n.forEach(function(e){var t=i.contentView.treeDocument.getMappedNodesFromId(e);if(r[e]=t||[],t&&t.length>0)for(var n=0;n<t.length;n++){var o=t[0];if(o.options.physicalid&&(o.isRoot()||o.options.instance&&o.options.instance.physicalid)){l.push(o);break}}}),s.push(e.refreshTreeNodeModel(r,o,i.contentView)),t.dontLoadSpaceInfo||s.push(a.addDBNavigate(l,{navigateTypes:["ZONE"],treeDocument:i.contentView.treeDocument})),Promise.all(s).then(()=>{}))},refreshInstDetailsonNode:function(t){let i,n=this,o=[],r={},s=Object.keys(t.instIdMap),a=[];if(s.forEach(function(e){(i=t.instIdMap[e])&&i instanceof Array||(i=n.contentView.treeDocument.getRoots()[0].getNodesByRelId(e)),a.push(i[0].options.physicalid),r[e]=i||[]}),t.bInstance&&o.push(e.refreshInstanceNodeModel(r,!0)),t.bEffectivity){var l={relids:s,pids:a},c=f.gridview.additionalColumnsModules.cfgEffectivty;c&&o.push(new Promise(function(e,t){c.updateAttributes(l,function(i){var n=UWA.is(i,"string")?JSON.parse(i):i;e(n),t("Error in Cfg_updateAttributes")},n)}).then(function(e){let t=e?e.relids:{};n.contentView.treeDocument.withTransactionUpdate(function(){s.forEach(function(e){var i=r[e],n=t[e];n&&(n.VariantEffectivity.trim()||(n.VariantEffectivity=m.label_none),i.forEach(e=>{e.updateOptions({grid:n})}))})})}))}Promise.all(o).then(()=>{let e=n.contentView.getGroupingOptions();e&&n.contentView.groupRows(e)})},refreshSpacesonNode:function(e){e&&(e.forEach(function(e){c.SAXStorage().setItem(h.recentlyAuthored+e.options.physicalid,Date.now())}),a.addDBNavigate(e,{navigateTypes:["ZONE"],treeDocument:this.contentView.treeDocument}))},refreshSolutionsonNode:function(e){e&&(e.forEach(function(e){c.SAXStorage().setItem(h.recentlyAuthored+e.options.physicalid,Date.now())}),a.addDBNavigate(e,{navigateTypes:["PROPOSED_SOLUTION"],treeDocument:this.contentView.treeDocument}))},refreshDocumentsOnNodes:function(e){var t=e.nodes,i=e.docType;t&&(t.forEach(function(e){c.SAXStorage().setItem(h.recentlyAuthored+e.options.physicalid,Date.now())}),"attachedDocumentsCategory"===i?a.addDBNavigate(t,{navigateTypes:["REFERENCE_DOCUMENT"],treeDocument:this.contentView.treeDocument}):"specificationDocumentsCategory"===i?a.addDBNavigate(t,{navigateTypes:["SPECIFICATION_DOCUMENT"],treeDocument:this.contentView.treeDocument}):a.addDBNavigate(t,{navigateTypes:["SPECIFICATION_DOCUMENT","REFERENCE_DOCUMENT"],treeDocument:this.contentView.treeDocument}))},refreshReferenceLinksOnNodes:function(e){e&&(e.forEach(function(e){c.SAXStorage().setItem(h.recentlyAuthored+e.options.physicalid,Date.now())}),a.addDBNavigate(e,{navigateTypes:["IMPLEMENTEDBY_LINK","IMPLEMENTING_LINK"],treeDocument:this.contentView.treeDocument}))},removeItemsFromCatogry:function(e){var t=this,i=e.nodes,n=e.categoryType;let o=widget.getValue("groupingEnabled");i&&i.length>0&&i.forEach(function(e){var i=e.options.physicalid,r=e.getParent();if(r){var s=r.getParent();if(o&&!s.getID&&(s=d.getGroupNodeParent(s)),o&&s.isRoot()){let e=r.getParent();r.getChildren().forEach(function(e){e.options.physicalid===i&&e.remove()}),r.getChildren()&&0!==r.getChildren().length||r.remove(),d.removeGroupNodesOnEmpty(e)}else{(t.contentView.treeDocument.getMappedNodesFromId(s.options.physicalid)||[s]).forEach(function(e){var t=e.options.instance?e.options.instance.physicalid:"",o=e.getNodesByRelId(n+t)[0];o.getChildren().forEach(function(e){e.options.physicalid===i&&e.remove()}),o.getChildren()&&0!==o.getChildren().length||o.remove(),e.expand()})}}})},refreshNodesOnReparent:function(e){var t=e.resp,i=e.params,n=e.newParent,o=e.instArray;t=t&&UWA.is(t,"string")?JSON.parse(t):t;var r=i.collectionView.treeDocument.getMappedNodesFromId(n.options.physicalid),s=t&&t.member?t.member:[];o.forEach(function(e,t){c.SAXStorage().setItem(h.recentlyAuthoredStructure+e.getParent().options.physicalid,Date.now());var n=i.collectionView.treeDocument.getMappedNodesFromId(e.options.physicalid)||[e];for(t=n.length-1;t>=0;t--){var o=n[t];if(o.options.instance.physicalid===e.options.instance.physicalid){var r=o.getParent();r.removeChild(o),r.expand()}}}),this.addChildrenToParent(i.collectionView.treeDocument,r,s,!0),p.unmask(i.collectionView.getContent()),l.alertMessage("success",null,m.msg_reparentSuccess)},refreshNodesOnReplace:function(e){let t=e.replaceDetails,i=e.selectedNodes,n=this.contentView.treeDocument,o={};if(t&&t.length>0){let e={},d=[],u={};i.forEach(function(t){e[t.options.instance.physicalid]=t});for(var r=0;r<t.length;r++){c.SAXStorage().setItem(h.recentlyAuthoredStructure+t[r].parent,Date.now());let i=t[r].old,s=e[i];o[t[r].new.instance]=s;var a=n.getMappedNodesFromId(s.options.physicalid);a||(a=[s]);for(var l=a.length-1;l>=0;l--){let e=a[l];e.options.instance.physicalid===i&&(n.removeFromMappedNodes(e),e.removeChildren(),e.collapse(),e.updateOptions({hasBeenExpanded:!1,noIndexOrDBExpand:!1,dontExpandTwoLvl:!1,dontExpandAllLvl:!1,configContexts:void 0,physicalid:t[r].new.reference,instance:{physicalid:t[r].new.instance},grid:{physicalid:t[r].new.reference,configCtx:void 0}}),e.setRelationID(t[r].new.instance),n.addToMappedNodes(e))}d.push(t[r].new.reference),u[t[r].new.instance]=s}s.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-nodes-by-id",data:{arrayOfPID:d,tagAsRecentlyAuthored:!0}}),s.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-inst-by-id",data:{instIdMap:u,bInstance:!0,bEffectivity:!0}})}},refreshConnectedDIFNode:function(e){var t={itemID:e.options.physicalid};return i.getAttributes(t).then(function(t){e.updateOptions({grid:{maturity:t.attributes.grid.maturity}}),e.updateOptions({grid:{owner:t.attributes.grid.owner}})}).catch(function(e){CommonUtils.alertMessage("error",null,e.errorResp.message)})}}}),define("DS/CATFLCockpitWidget/utils/architectureNumber.util",["UWA/Core","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/services/logitem.service","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n){"use strict";return{executeRecompute:function(e){let o,r,s,a,l,c,d,u,p=this,g=e.isWIWcall,m=e.an_action,f=e.rows,h=[],v=!0,C={AN_ACTION:m,anColumns:[],instances:[]},b=!1;for(let t=0;t<f.length;t++){var y=f[t];if("ok"===y.getChildren()[0].getAttribute("status")){h.push(y),o=g?y.getAttribute("data-id"):y.getAttribute("referenceID"),r=y.getElement(".archidcell").innerText,s=y.querySelectorAll('[required = "true"]'),a=!1,c=null,d=null,u={},l={},y.getElements("[architectureidcolumn=true]").forEach(e=>{if(c=e.getAttribute("id"),"true"===e.getAttribute("editable")){let t=e.getChildren()&&e.getChildren()[0];d=t.dsModel.value}else d=e.getHTML();u[c]=d,b||C.anColumns.push(c)}),C.anColumns.length>0&&(b=!0),e.forReparent?Array.isArray(y.getAttribute("instanceIDs"))?l.instanceIDs=y.getAttribute("instanceIDs"):l.instanceIDs=y.getAttribute("instanceIDs").split(","):l.instanceID=g?y.getAttribute("data-instance"):y.getAttribute("instanceID"),l.referenceID=o,l.ArchitectureNumber=r,l.ArchitectureNumberTokens=u,C.instances.push(l),y.getAttribute("data-type")&&(C.logicalRefType=y.getAttribute("data-type")),v=!1}}v?t.alertMessage("error",null,n.log_ref_selection_error):(e.SelectionContext&&(C.SelectionContext=e.SelectionContext),i.recomputeArchNum(C).then(function(e){p.updateRowsOnRecompute(g,e,h),t.alertMessage("success",null,"",n.msg_recompute_setArch_success)},function(e){t.displayError(e,null,null,n.error_recompute_failed)}))},updateRowsOnRecompute:function(e,t,i){let n,o,r=this,s=e?"data-instance":"referenceID";i.forEach(function(e){o=t[e.getAttribute(s)],Object.keys(o).forEach(function(t){if(n=e.getElement("#"+t))if("true"===n.getAttribute("editable")){let e=n.getChildren()[0].dsModel;e.value=o[t];let i=e.elementsList;if(i){let n;for(let e=0;e<i.length;e++)if(i[e].value===o[t]){n=e;break}n&&(e.selectedIndex=n,e._applySelectedIndex())}}else n.setHTML(o[t]);e.getElement("#ANRecompute")&&e.getElement("#ANRecompute").hasClassName("errordiv")&&e.getElement("#ANRecompute").removeClassName("errordiv")}),r.updateArchitectureID(null,e,!0)})},updateArchitectureID:function(e,t,i){let n=t.getElements("[architectureidcolumn=true]");var o="",r=null;e&&e.removeClassName&&e.removeClassName("errordiv"),n.forEach(e=>{if("true"===e.getAttribute("editable")){let t=e.getChildren()&&e.getChildren()[0];o+=t.dsModel._properties.valueToCommit?t.dsModel._properties.valueToCommit.value:t.dsModel.value?t.dsModel.value:""}else o+=e.getHTML()}),(r=t.getElement(".archidcell"))&&r.getText()!=o&&(r.setText(o),r.removeClassName("errordiv"),!i&&t.getElement("#ANRecompute")&&t.getElement("#ANRecompute").addClassName("errordiv"))}}}),define("DS/CATFLCockpitWidget/components/SpaceAssignment/SpaceAssignment",["DS/CATFLCockpitWidget/model/CATFLCockpitTreeDocument","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","DS/Handlebars/Handlebars","DS/DataGridView/DataGridView","DS/Windows/Dialog","DS/Controls/Button","DS/UIKIT/Mask","DS/CATFLCockpitWidget/services/space.service","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/search.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/gridview.util","text!DS/CATFLCockpitWidget/components/SpaceAssignment/SpaceAssignment.html","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,g,m,f){"use strict";var h=c.getFullConfig(),v=h.identifiers,C=h.localStorageKeys,b={main:i.compile(m)},y=function(e){this.logicalRef=e;var t=this;l.checkToUpdateSpace([e]).then(function(i){t.pilotingDisciplineWarnMsg=null,"WARNING_PILOTDISC"==i[e.options.physicalid]&&(t.pilotingDisciplineWarnMsg=f.msg_has_piloting_discipline_warn),t.render()},function(e){d.displayError(e,null,null,f.msg_generic_error_get_failed)})};return y.prototype.render=function(){var e=this;e.dialog=new o({title:f.action_assign_space+" - "+e.logicalRef.options.label,content:b.main({labelSpaceConceptRoot:f.label_space_concept_root,labelNoSelection:f.message_no_space_concept_root_selected,iconTooltip:f.select_space_concept_root,warningMsg:e.pilotingDisciplineWarnMsg}),height:500,width:700,resizableFlag:!0,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new r({label:f.label_assign,emphasize:"primary",disabled:!0,onClick:function(){s.mask(e.dialog.elements._mainContentDiv,f.msg_processing);var t=e.treeDocument.getSelectedNodes(),i=e.logicalRef.options.assignedSpacesPID,n=[],o=[];i&&i.length>0&&(e.treeDocument.getAllDescendants().forEach(function(e){i.forEach(function(t){e.options.physicalid!==t.obj||e.isSelected()||n.push(t.owner)})}),n.length>0&&o.push(a.deleteSPPConnection(n,[e.logicalRef]))),t.length>0&&(t=t.filter(function(e){if(i&&i.length>0)for(var t=0;t<i.length;t++)if(e.options.physicalid===i[t].obj)return!1;return!0})).length>0&&o.push(a.createSPPConnection([e.logicalRef],t)),Promise.all(o).then(function(){o.length,p.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-spaces-by-id",data:[e.logicalRef]}),e.dialog.close()}).catch(function(){s.unmask(e.dialog.elements._mainContentDiv)})}}),Cancel:new r({emphasize:"secondary",onClick:function(){e.dialog.close()}})}}),e.dialog.addEventListener("close",function(){e.dialog.destroy()}),e.dialog.elements.container.classList.add("flweb-space-assigment-panel"),new r({label:f.label_search,emphasize:"primary",icon:{iconName:"search"}}).inject(e.dialog.elements.container.querySelector(".search-icon")).getContent().addEventListener("buttonclick",function(){u.launchSearch({searchTitle:f.label_search_spConceptRoot,allowedTypes:v.type_spaceRoot,role:"",criteria:v.type_spaceRoot,bMultiSel:!1,in_apps_callback:function(t){e._loadSpaceHierarchy(t[0].id,t[0]["ds6w:label"],t[0]["ds6wg:revision"])}})});var t=widget.getValue(C.previousSpaceHierarchy);t&&(t=JSON.parse(t),e._loadSpaceHierarchy(t.id,t.label,t.revision))},y.prototype._loadSpaceHierarchy=function(e,t,i){var n=this;a.getSpaceHierarchy(e).then(function(o){o.length>1&&(n.dialog.elements.container.querySelector(".label-space-concept-root-name").textContent=t,widget.setValue(C.previousSpaceHierarchy,JSON.stringify({id:e,label:t,revision:i})),n._createDataGridView(t,i,o,n.logicalRef.options.assignedSpacesPID))})},y.prototype._createDataGridView=function(i,o,r,s){var a=this;a.treeDocument=new e({useAsyncPreExpand:!0}),a.treeDocument.prepareUpdate(),a.treeDocument.options.shouldBeSelected=function(e){return e.options.type===v.type_design_ref};var l=a.treeDocument.addChild(new t({label:i,isSpaceRoot:!0,icons:[{iconPath:c.getServiceURL("3DSpace")+"/snresources/images/icons/small/I_SppSpaceConceptRoot.png",iconSize:{height:"16px",width:"16px"}}],grid:{revision:o}}));r.forEach(function(e){a._parseSpaceNode(l,e)}),s&&l.getAllDescendants().forEach(function(e){for(var t=0;t<s.length;t++)s[t].obj===e.options.physicalid&&e.select()}),a.treeDocument.getXSO().onPostAdd(a._activateOkButton.bind(a)),a.treeDocument.getXSO().onPostRemove(a._activateOkButton.bind(a)),a.treeDocument.setFilterModel({label:{filterId:"stringRegexp"},revision:{filterId:"stringRegexp"}}),a.treeDocument.pushUpdate(),a.treeDocument.expandAll();var d=new n({identifier:"SystemArchitectureRelease_SpaceAssignment",height:"inherit",treeDocument:a.treeDocument,selectionBehavior:{unselectAllOnEmptyArea:!1},columns:[{text:h.nlsBasicAttributesBO["ds6w:label"],dataIndex:"tree",alwaysVisibleFlag:!0,pinned:"left"},{text:h.nlsBasicAttributesBO["ds6wg:revision"],dataIndex:"revision"},{text:h.nlsBasicAttributesBO["ds6w:description"],dataIndex:"description"},{text:h.nlsBasicAttributesBO["ds6wg:PLMReference.V_isLastVersion"],dataIndex:"isLastVersion",typeRepresentation:"boolean",width:95,visibleFlag:!1},{text:h.nlsBasicAttributesBO["ds6w:modified"],dataIndex:"modificationDate",visibleFlag:!1},{text:h.nlsBasicAttributesBO["ds6w:created"],dataIndex:"creationDate",visibleFlag:!1},{text:h.nlsBasicAttributesBO["ds6w:status"],dataIndex:"maturity",visibleFlag:!1},{text:h.nlsBasicAttributesBO["ds6w:responsible"],dataIndex:"owner",visibleFlag:!1},{text:h.nlsBasicAttributesBO["ds6w:reserved"],dataIndex:"isReserved",typeRepresentation:"boolean",width:95,visibleFlag:!1},{text:h.nlsBasicAttributesBO["ds6w:type"],dataIndex:"type",visibleFlag:!1}],defaultColumnDef:{typeRepresentation:"string",width:"auto"},sortModel:[{dataIndex:"tree",sort:"asc"}]}),u=a.dialog.elements._contentDiv.querySelector(".dgv-container");u.innerHTML="",u.appendChild(d.getContent())},y.prototype._parseSpaceNode=function(e,i){var n=this;if(void 0===i.icons){var o=e.addChild(new t({physicalid:i.physicalid,label:i.title,type:i.type,grid:{description:i.description,isLastVersion:"TRUE"===i.isLastRevision,maturity:h.MAPPING_MATURITY[i.maturityState],type:i.nlsType,owner:i.ownerFullName,isReserved:"TRUE"===i.reservation,revision:i.revision}}));o.options.icons=[{iconSize:{height:"16px",width:"16px"}}],o.options.type===v.type_space_concept_node?o.options.icons[0].iconPath=c.getServiceURL("3DSpace")+"/snresources/images/icons/small/I_SppSpaceConceptNode.png":o.options.type===v.type_design_ref&&(o.options.icons[0].iconPath=c.getServiceURL("3DSpace")+"/snresources/images/icons/small/I_3DPart.png"),o.options.grid.creationDate=d.formatDate(i.creationDate),o.options.grid.modificationDate=d.formatDate(i.modificationDate),i.children&&i.children.forEach(function(e){n._parseSpaceNode(o,e)})}},y.prototype._activateOkButton=function(){this.dialog.buttons.Ok.disabled=!1},y}),define("DS/CATFLCockpitWidget/services/predicate.service",["DS/CATFLCockpitWidget/services/logitem.service","DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/xhr.util"],function(e,t,i,n){"use strict";var o,r,s=i.getFullConfig(),a=i.getFullConfig().identifiers;return{getLtypes:function(){return o||(o=e.getSubTypesOfLogicalReferenceAndInstance()),o},getPredicatesForLtypes:function(){var e=this;return r||(r=e.getLtypes().then(function(t){return e.getPredicates(t[a.type_act_logref],t[a.type_act_loginstance]).catch(function(t){return r=null,e.getPredicatesForLtypes()})})),r},getPredicates:function(e,t){return Promise.all([this._splicedGetPropertiesForClass(e),this._splicedGetPropertiesForClass(t)]).then(function(e){return[e[0],e[1]]})},getPropertiesPredicates:function(e){var t=s.webservices.getInfoProperties,i=[];for(var o in e){var r=[];for(var a in e[o])r.push(a);i.push({type:o,attributes:r})}return i.length>0?n.post(t,JSON.stringify(i)):Promise.resolve(null)},getNLSPredicates:function(e){var i=e.map(e=>e.curi),n=i.join(",");return new Promise(function(o,r){t.getResourcesInfo(n,{apiVersion:"R2019x",tenantId:widget.getValue("x3dPlatformId"),lang:widget.lang||"en",onComplete:function(e){var t="string"==typeof e?JSON.parse(e):e;Array.isArray(t)&&i.length===t.length||r(new Error("inconsistent nls answer compare to input"));var n={};i.forEach(function(e,i){n[e]=t[i].label}),o(n)},onFailure:function(){var t={};e.forEach(function(e,i){t[e.curi]=e.nls}),o(t)}})})},_splicedGetPropertiesForClass:function(e){if(0===e.length)return[];var i=[],n=[];if(e.length>25)for(var o=0;o<e.length;o+=25)i.push(e.slice(o,o+25));else i.push(e);for(var r=0;r<i.length;r++)n.push(new Promise(function(e,n){t.getPropertiesForClass(i[r],{apiVersion:"R2019x",lang:widget.lang||"en",tenantId:widget.getValue("x3dPlatformId"),onComplete:function(t){e(t)},onFailure:function(t){t.stack.contains("timedout")?n(t):e([])}})}));return Promise.all(n).then(function(e){return[].concat.apply([],e)})}}}),define("DS/CATFLCockpitWidget/components/PropertiesPanel/propertiespanel.controller",["DS/CoreEvents/ModelEvents","DS/EditPropWidget/EditPropWidget","DS/EditPropWidget/constants/EditPropConstants","DS/EditPropWidget/models/EditPropModel","DS/EditPropWidget/models/EditPropAttributeModel","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/refresh.util","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l){"use strict";let c=JSON.parse(a);return{init:function(n,o){this.contentView=o,this.modelEvents=new e,this.parentContainer=n;var s=[i.FACET_PROPERTIES,i.FACET_SHARING,i.FACET_INSTANCE,i.FACET_EFFECTIVITY,i.FACET_CHANGE,i.FACET_iCHANGE,i.FACET_IPPROTECTION,i.FACET_SWYMCOMMENTS],a={typeOfDisplay:i.ALL,selectionType:i.NO_SELECTION,facets:s,extraNotif:!0,editMode:!1,readOnly:!1,context:{getSecurityContext:function(){return{SecurityContext:r.getSecurityContext()}}}};return this.EditPropWidget=new t(a),this.addAttachmentsTab(),this.addSpecDocsTab(),this.EditPropWidget.elements.container.inject(this.parentContainer),this},loadModel:function(e,t){var i=this,o=[],s=[];e.forEach(function(e){s.push(e.physicalid);var a=new n({metatype:e.metatype?e.metatype:t,objectId:e.physicalid,tenant:r.getTenant(),source:"3DSpace"});a.set("isTransient",!1),a.addEvent("onSave",function(){i.modelEvents.publish({event:"properties-panel-on-save",data:s})}),o.push(a)}),i.EditPropWidget.initDatas(o)},addAttachmentsTab:function(){this.EditPropWidget.addFacets([{require:"DS/CATFLCockpitWidget/components/PropertiesPanel/facets/RelatedDocumentsFacet",alwaysVisible:!0,services:["3DSpace"],inheritance:!0,content:null,facet:{name:"REFERENCE_DOCUMENT",icon:"attach",text:l.label_attachmentsTab},options:{appContext:{contentView:this.contentView},specificationDocuments:!1}}])},addSpecDocsTab:function(){widget.getValue("configurable_expand");c.showSpecDocs&&widget.getPreference(c.showSpecDocs)&&widget.getPreference(c.showSpecDocs).value&&this.EditPropWidget.addFacets([{require:"DS/CATFLCockpitWidget/components/PropertiesPanel/facets/RelatedDocumentsFacet",alwaysVisible:!0,services:["3DSpace"],inheritance:!0,content:null,facet:{name:"SPECIFICATION_DOCUMENT",icon:"docs",text:l.label_specifcationsTab},options:{appContext:{contentView:this.contentView},specificationDocuments:!0}}])}}}),define("DS/CATFLCockpitWidget/utils/checkArchitectureNumberUnicity.util",["UWA/Core","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/services/index.service","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n){"use strict";return{checkArchitectureNumberUnicityOnEffectivity:function(e,i){var n=e||[],o={};return(n=n.filter(function(e){return e.options.grid.architectureNumber})).length<1?Promise.reject(new Error("AN_not_assigned")):(n=n.reduce(function(e,t){return e[[t.options.grid.architectureNumber]]=(e[t.options.grid.architectureNumber]||[]).concat(t),e},{}),n=Object.values(n).filter(function(e){return e.length>=2}),(n=[].concat.apply([],n))&&n.length>0?t.allFilterModelVersionsValidation(n,i,!0).then(function(e){return e&&e.length>0&&e.forEach(function(e,t){var i=e.instances.reduce(function(e,t){return e[[t.nodeInstance.options.grid.architectureNumber]]=(e[t.nodeInstance.options.grid.architectureNumber]||[]).concat(t),e},{});for(var n in i){var r=i[n].reduce(function(e,t){return e[[t.filterValidationStatus]]=(e[t.filterValidationStatus]||[]).concat(t),e},{});o[n]||(o[n]={}),r.valid&&r.valid.length>0&&r.valid.forEach(function(t,i){o[n][t.nodeInstance.options.instance.physicalid]||(o[n][t.nodeInstance.options.instance.physicalid]={nodeInstance:t.nodeInstance,intersectionEffectivity:[]}),r.valid.length>=2&&o[n][t.nodeInstance.options.instance.physicalid].intersectionEffectivity.push(e.modelversion)}),r.invalid&&r.invalid.length>0&&r.invalid.forEach(function(e,t){o[n][e.nodeInstance.options.instance.physicalid]||(o[n][e.nodeInstance.options.instance.physicalid]={nodeInstance:e.nodeInstance,intersectionEffectivity:[]})})}}),o}).catch(function(e){return Promise.reject(e)}):Promise.resolve({}))},updateEffectivityCompiledFormForNodes:function(e){var t=[],n={};return e&&e.forEach(function(e,i){e.options.instance&&e.options.instance.physicalid&&(t.push(e.options.instance.physicalid),n[e.options.instance.physicalid]=e)}),t.length>0?i.fetch(t,["ro.plminstance.v_effectivitycompiledform"]).then(function(e){if(e)for(var t=0;t<e.length;t++){var i=n[e[t].resourceid.value];e[t]["ro.plminstance.v_effectivitycompiledform"]&&void 0!==e[t]["ro.plminstance.v_effectivitycompiledform"]?i.options.instance.effectivitycompiledform=e[t]["ro.plminstance.v_effectivitycompiledform"].value:i.options.instance.effectivitycompiledform=void 0}}):Promise.resolve()},updateDisplayedCurrentEvolutionForNodes:function(e){var i={};return t.getEffectivityInfo(e).then(function(e){for(var t in e){var n=e[t];if(n.content&&n.content.Evolution){var o=n.content.Evolution.Current;i[t]=o?o.replace(/(\r\n|\n|\r)/gm," "):""}}return i})}}}),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.creation",["DS/UIKIT/Mask","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/refresh.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/document.service","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l){"use strict";var c=JSON.parse(a);return{createDocument:function(n,o,r){this.launchFileExplorer(n.options.physicalid,function(r){var a,d;o&&(a=c.rel_specification,d="specificationDocumentsCategory"),e.mask(widget.body,l.msg_creating),s.createDocument(n.options.physicalid,r,a).then(function(o){e.unmask(widget.body),t.alertMessage("success",null,l.msg_header_create_success,o.data[0].dataelements.title+l.msg_add_doc_success),i.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-documents-by-id",data:{nodes:[n],docType:d}})},function(i){e.unmask(widget.body),t.displayError(i,l.error_creation,null,l.replace(l.error_no_access,{errorOp:l.action_insert_new+" "+l.label_document}))})})},createNewItemReference:function(e,i,n){var o={items:[{attributes:{}}]};return""!==e.trim()&&(o.items[0].attributes.title=e),i&&(o.items[0].type=i),Object.keys(n).length>0&&(o.items[0].CustomFields=n),r.createLogItem(o).then(function(i){if(i)return t.alertMessage("success",null,l.msg_header_create_success,e+l.msg_create_success),i})},createNewItemInstance:function(e,i,n,o,s){var a=o;a||(a="dslog:LogItemPRIVATE");var c={instances:[{attributes:{},referencedItem:{type:a,attributes:{}}}]};return Object.keys(s).length>0&&(c.instances[0].referencedItem.CustomFields=JSON.parse(JSON.stringify(s))),""!==n.trim()&&(c.instances[0].referencedItem.attributes.title=n),r.createLogItemInstanceNew(c,e).then(function(e){return 0===n.length&&c.name&&c.name.length>0&&(n=c.name.slice(0,-2)),n.length>0?t.alertMessage("success",null,l.msg_header_create_success,n+l.msg_create_success):t.alertMessage("success",null,l.msg_header_create_success,l.create_log_ref_from_dialog_success),e},function(e){t.displayError(e,null,l.error_creation,l.msg_add_item_error)})},duplicateExistingItem:function(e,t,i){var n={items:[{referencedObject:{ID:e},attributes:i}]};return t&&(n.items[0].classificationObject={ID:t}),r.createLogItem(n,"dslog:LogItem")},launchFileExplorer:function(e,i){var n=t.getFileInput();n.addEventListener("change",function(e){e.preventDefault(),e.stopImmediatePropagation();var t,o=[];t=null!==e.target.files&&e.target.files.length>0?e.target.files:e.dataTransfer.files;for(var r=0;r<t.length;r++)o.push(t[r]);i(o),n.destroy()}),n.click()}}}),define("DS/CATFLCockpitWidget/components/AttributesManagement/AttributesManagement",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/DataGridView/DataGridView","DS/UIKIT/Mask","DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/ClassificationUtil/ClassificationUtil","DS/CATFLCockpitWidget/services/predicate.service","DS/Windows/Dialog","DS/Controls/Button","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/preferences.util","DS/CATFLCockpitWidget/utils/model.events.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,g,m){"use strict";var f=d.getFullConfig(),h=d.getFullConfig().identifiers,v={"http://www.w3.org/2001/XMLSchema#boolean":"boolean","http://www.w3.org/2001/XMLSchema#integer":"integer","http://www.w3.org/2001/XMLSchema#real":"number","http://www.w3.org/2001/XMLSchema#timestamp":"date"},C=function(e,t,i){var n=this;this.isForPhysicalProduct=e||!1,this.dialogTitle=e?m.attributes_browser_for_physical_product:m.attributes_browser,this.isForPhysicalProduct?(this.types=t||[],this.typesInstance=i||[],this.render()):s.getLtypes().then(function(e){n.types=e[h.type_act_logref],n.typesInstance=e[h.type_act_loginstance],n.render()})};return C.prototype.render=function(){var t=this;t.dialog=new a({title:t.dialogTitle+" - "+m.label_select_extensions,height:500,width:700,resizableFlag:!0,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new l({label:m.label_next,emphasize:"primary"}),Cancel:new l({emphasize:"secondary"})}}),t.dialog.addEventListener("close",function(){t.dialog.destroy()}),t.dgv=new i({identifier:"SystemArchitectureRelease_AttributesManagement_DGV",height:"inherit",treeDocument:new e({useAsyncPreExpand:!0}),selectionBehavior:{unselectAllOnEmptyArea:!1},columns:[{typeRepresentation:"icon",dataIndex:"iconType",width:40},{text:m.label_name,dataIndex:"name"},{text:m.label_declared_in,dataIndex:"declaredIn"}],defaultColumnDef:{typeRepresentation:"string",width:"auto"},onContextualEvent:function(e){var t=[];return e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e,{insertRow:!0,expandCollapse:!0,pin:!0,firstColumnsVisibility:!1,columnsManagement:!1})),t},getCellTooltip:function(e){return e.nodeModel&&0===e.columnID?{shortHelp:t.isForPhysicalProduct?m.label_declared_in_physical_product:e.nodeModel.options.isOnInstance?m.label_declared_in_instance:m.label_declared_in_reference,updateModel:!1}:t.dgv.getCellDefaultTooltip(e)}}),t.dialog.elements._contentDiv.appendChild(t.dgv.getContent()),t.dgv.treeDocument.setFilterModel({name:{filterId:"stringRegexp"}}),t.dgv.sortModel=[{dataIndex:"iconType",sort:"desc"},{dataIndex:"name",sort:"asc"}],t.renderListOfExtensions()},C.prototype.renderListOfExtensions=function(){var e=this;n.mask(e.dialog.elements._contentDiv,m.msg_loading);var i=[];e.types&&e.types.length>0&&i.push(c.getExtensionsForClass(e.types)),e.typesInstance&&e.typesInstance.length>0&&i.push(c.getExtensionsForClass(e.typesInstance,!0)),Promise.all(i).then(function(i){e.dgv.treeDocument.empty();for(var o=[{},{}],r=0;r<i.length;r++)for(var s=1===r,a=0;a<i[r].length;a++)for(var c=i[r][a].interfaces,d=0;d<c.length;d++)if("Yes"!==c[d].automatic){var u=c[d].name;void 0===o[r][u]?o[r][u]={uri:c[d].name,isOnInstance:s,grid:{iconType:s?"object-instance":"object-reference",name:c[d].nlsName,declaredIn:[i[r][a].name]}}:o[r][u].grid.declaredIn.push(i[r][a].name)}for(r=0;r<o.length;r++)for(var p in o[r])o[r].hasOwnProperty(p)&&(o[r][p].grid.declaredIn.length===i[r].length&&(o[r][p].grid.declaredIn=m.label_all_levels),e.dgv.treeDocument.addChild(new t(o[r][p])));var g=e.isForPhysicalProduct?f.localStorageKeys.userAdditionalAttributesForPhysicalProduct:f.localStorageKeys.userAdditionalAttributes,h=JSON.parse(localStorage.getItem(g)),v=h?h.extensions:null;null!==v&&e.dgv.treeDocument.getAllDescendants().forEach(function(e){-1!==v.indexOf(e.options.uri)&&e.select()}),e.dgv.treeDocument.getFilterManager().setPropertyFilterModel("declaredIn",{filterId:"set"}),e.dgv.reapplySortModel(),e.dialog.title=e.dialogTitle+" - "+m.label_select_extensions,e.dialog.buttons={Ok:new l({label:m.label_next,emphasize:"primary",onClick:function(){e.renderListOfAttributes()}}),Cancel:new l({emphasize:"secondary",onClick:function(){e.dialog.close()}})},n.unmask(e.dialog.elements._contentDiv)})},C.prototype.renderListOfAttributes=function(){var e=this;n.mask(e.dialog.elements._contentDiv,m.msg_loading);for(var i=e.dgv.treeDocument.getSelectedNodes(),o=[],a=[],c=[],d=0;d<i.length;d++)o.push(i[d].options.uri),i[d].options.isOnInstance?a.push(i[d].options.uri):c.push(i[d].options.uri);var u=[];if(this.isForPhysicalProduct){var C=e.types.concat(c),b=e.typesInstance.concat(a);u.push(s.getPredicates(C,b))}else u.push(s.getPredicatesForLtypes()),u.push(s.getPredicates(c,a));u.push(r.classificationAttributesPromise({apiVersion:"R2019x",lang:"fr"})),Promise.all(u).then(function(i){var r=[{},{},{}],a=[[],[],[]];e.isForPhysicalProduct?(a[0]=i[0][0],a[1]=i[0][1],a[2]=i[1]):(a[0]=i[0][0].concat(i[1][0]),a[1]=i[0][1].concat(i[1][1]),a[2]=i[2]),a.forEach(function(e,t){for(var i=0;i<e.length;i++)for(var n=e[i],s=0;s<n.properties.length;s++){var a=n.properties[s],l=n.classInfo.curi.replace("ds6w:","").replace("ds6wg:","");void 0===r[t][a.originCuri]&&(a.declaredIn=[],r[t][a.originCuri]=a,-1!==o.indexOf(l)&&(a.isOnExtension=!0)),2!==t&&r[t][a.originCuri].declaredIn.push(l)}}),e.dgv.treeDocument.empty();for(var c=0;c<r.length;c++)for(var d in r[c])if(r[c].hasOwnProperty(d)){var u=r[c][d];if(0===c&&-1===f.identifiers.index_services.select_bo.indexOf(u.curi.toLowerCase())||1===c&&-1===f.identifiers.index_services.select_rel.indexOf(u.curi.toLowerCase())||2===c){var C=new t({attribute:u,isOnInstance:1===c,isClassification:2===c,isOnExtension:u.isOnExtension,grid:{iconType:0===c||2===c?"object-reference":"object-instance",name:u.label,declaredIn:u.declaredIn.length===a[c].length||2===c?m.label_all_levels:u.declaredIn.join()},declaredInArray:u.declaredIn});e.dgv.treeDocument.addChild(C)}}var b=e.isForPhysicalProduct?f.localStorageKeys.userAdditionalAttributesForPhysicalProduct:f.localStorageKeys.userAdditionalAttributes,y=JSON.parse(localStorage.getItem(b));if(y){var _={bo:[],rel:[]};y.userAdditionalAttributes&&y.userAdditionalAttributes.forEach(function(e){e.bo?_.bo.push(e.curi):_.rel.push(e.curi)}),(_.bo.length>0||_.rel.length>0)&&e.dgv.treeDocument.getAllDescendants().forEach(function(e){e.options.isOnInstance&&-1!==_.rel.indexOf(e.options.attribute.curi)?e.select():e.options.isOnInstance||-1===_.bo.indexOf(e.options.attribute.curi)||e.select()})}e.dgv.treeDocument.getFilterManager().setPropertyFilterModel("declaredIn",{filterId:"stringRegexp"}),e.dgv.reapplySortModel(),e.dialog.title=e.dialogTitle+" - "+m.label_select_attributes,e.dialog.buttons={Ok:new l({label:m.action_close,emphasize:"primary",onClick:function(){var t,i={},n=e.dgv.treeDocument.getSelectedNodes();0!==n.length&&(t=[],n.forEach(function(n){var o={curi:n.options.attribute.curi,nls:n.options.attribute.label,type:v[n.options.attribute.dataType]||"string",isClassification:n.options.isClassification,bo:!n.options.isOnInstance,isOnExtension:n.options.isOnExtension,isOnPhysicalProduct:e.isForPhysicalProduct,rangeValues:n.options.attribute.rangeValues,selectable:n.options.attribute.selectable,dimension:n.options.attribute.dimension,manipulationUnit:n.options.attribute.manipulationUnit,declaredIn:n.options.grid.declaredIn,declaredInArray:n.options.declaredInArray,readOnly:"computed"===n.options.attribute.nature||"ReadOnly"===n.options.attribute.userAccess};if(t.push(o),!n.options.isClassification){var r;r=n.options.attribute.declaredIn.includes(h.type_act_logref)?h.type_act_logref:n.options.attribute.declaredIn[0],i[r]||(i[r]={});var s=n.options.attribute.originCuri.replace("ds6w:","").replace("ds6wg:","");i[r][s]=o}})),s.getPropertiesPredicates(i).then(function(n){n&&(n=JSON.parse(n)).forEach(function(e,t){e.info.forEach(function(t,n){i[e.type][t.Name].multiValuated="Yes"===t.MultiValuated,i[e.type][t.Name].multiValuated&&(i[e.type][t.Name].readOnly=!0)})}),p.saveUserCustomAttributes({extensions:o,userAdditionalAttributes:t,isForPhysicalProduct:e.isForPhysicalProduct});var r=g.getFLWebModelEventsObj("flcockpit-content-list-view");r.publish({event:"content-list-view-refresh"}),r.publish({event:"content-list-view-refresh-columns"})}),e.dialog.close()}}),Cancel:new l({label:m.action_back,emphasize:"secondary",onClick:function(){e.renderListOfExtensions()}})},n.unmask(e.dialog.elements._contentDiv)})},C}),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.columns",["DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/group.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/dimensions.service","DS/CATFLCockpitWidget/services/predicate.service","DS/CATFLCockpitWidget/utils/model.events.util","DS/Utilities/StringUtils","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l){var c=e.getFullConfig(),d=c.identifiers,u=c.localStorageKeys;return{getDataGridViewColumns:async function(e){this.contentView=e;var t=e.invalidateLayout.bind(e),i=this.getBaseColumns(t);return this.addAdditionalColumns(i,t),await this.addUserAdditionalColumns(i,t),i},getBaseColumns:function(e){var t=new Intl.Collator,i=[{value:!0,icon:{iconName:"check",fontIconFamily:1,className:"sax-is-last-version-true"}},{value:!1,icon:{iconName:"close",fontIconFamily:1,className:"sax-is-last-version-false"}}];return[{text:c.nlsBasicAttributesBO["ds6w:label"],dataIndex:"tree",editableFlag:!0,sortableFlag:!0,alwaysVisibleFlag:!0,pinned:"left",width:300,setCellValue:this._defaultSetCellValue.bind(this,e,"title"),getCellEditableState:this._defaultGetCellEditableState,compareFunction:function(e,i,n,o){var r=n.options.type,s=o.options.type;return"attachedDocumentsCategory"===r?-1:"attachedDocumentsCategory"===s?1:"specificationDocumentsCategory"===r?-1:"specificationDocumentsCategory"===s?1:"proposedSolutionCategory"===r?-1:"proposedSolutionCategory"===s?1:"implementLinksCategory"===r?-1:"implementLinksCategory"===s?1:a.compareLocal(e,i,{intlCollator:t})}},{text:l.action_cue_status,dataIndex:"cue",alignment:"center",typeRepresentation:"icon",sortableFlag:!0,compareFunction:function(e,t,i,n,o){return e===t?0:"group"===e?-1:"group"===t?1:"alert"===e?-1:"alert"===t?1:"status-ko"===e?-1:"status-ko"===t?1:"attention"===e?-1:"attention"===t?1:"info"===e?-1:"info"===t?1:"status-ok"===e?-1:"status-ok"===t?1:void 0},groupableFlag:!1},{text:c.nlsBasicAttributesBO["ds6wg:revision"],dataIndex:"revision",getCellTypeRepresentation:this._getCellTypeResentation.bind(null,"revision"),hyperlinkTarget:"_self",getCellValue:this._defaultGetCellValueForClickableColumn.bind(this,"revision"),getCellGroupingKey:this._getCellGroupingKey.bind(this,"revision")},{text:c.nlsBasicAttributesBO["ds6wg:PLMReference.V_isLastVersion"],dataIndex:"isLastVersion",typeRepresentation:"customBoolean",width:95,getCellSemantics:function(){return{possibleValues:i}},getCellGroupingKey:this._getCellGroupingKey.bind(this,"isLastVersion")},{text:c.nlsBasicAttributesBO["ds6w:label"],icon:{iconName:"object-instance"},dataIndex:"instanceName",editableFlag:!0,setCellValue:this._defaultSetCellValue.bind(this,e,"instanceName"),getCellEditableState:this._defaultGetCellEditableState,getCellGroupingKey:this._getCellGroupingKey.bind(this,"instanceName")},{text:c.nlsBasicAttributesBO["ds6w:status"],dataIndex:"maturity",getCellTypeRepresentation:this._getCellTypeResentation.bind(null,"maturity"),hyperlinkTarget:"_self",getCellValue:this._defaultGetCellValueForClickableColumn.bind(this,"maturity"),getCellGroupingKey:this._getCellGroupingKey.bind(this,"maturity")},{text:c.nlsBasicAttributesBO["ds6w:responsible"],dataIndex:"owner",typeRepresentation:"url",getCellTypeRepresentation:this._getCellTypeResentation.bind(null,"owner"),hyperlinkTarget:"_self",getCellValue:this._defaultGetCellValueForClickableColumn.bind(this,"owner"),getCellGroupingKey:this._getCellGroupingKey.bind(this,"owner")},{text:c.nlsBasicAttributesBO["ds6w:reserved"],dataIndex:"isReserved",alignment:"center",typeRepresentation:"image",width:95,getCellGroupingKey:this._getCellGroupingKey.bind(this,"isReserved")},{text:c.nlsBasicAttributesBO["ds6w:modified"],dataIndex:"modificationDate",getCellValue:this._defaultGetCellValueForDate.bind(this,"modificationDate")},{text:c.nlsBasicAttributesBO["ds6w:description"],dataIndex:"description",editableFlag:!0,setCellValue:this._defaultSetCellValue.bind(this,e,"description"),getCellEditableState:this._defaultGetCellEditableState},{text:c.nlsBasicAttributesBO["ds6w:description"],icon:{iconName:"object-instance"},dataIndex:"instance_description",setCellValue:this._defaultSetCellValue.bind(this,e,"instance_description"),visibleFlag:!1,editableFlag:!0},{text:c.nlsBasicAttributesBO["ds6w:type"],dataIndex:"type"},{text:c.nlsBasicAttributesBO["ds6w:identifier"],dataIndex:"name"},{text:c.nlsBasicAttributesBO["ds6w:created"],dataIndex:"creationDate",getCellValue:this._defaultGetCellValueForDate.bind(this,"creationDate")},{text:l.label_arch_no,dataIndex:"architectureNumber",getCellTypeRepresentation:this._getCellTypeResentation.bind(null,"architectureNumber"),hyperlinkTarget:"_self",getCellValue:this._defaultGetCellValueForClickableColumn.bind(this,"architectureNumber"),getCellGroupingKey:this._getCellGroupingKey.bind(this,"architectureNumber")},{text:l.label_assigned_spaces,dataIndex:"assignedSpaces",typeRepresentation:"url",hyperlinkTarget:"_self",sortableFlag:!1,groupableFlag:!1,getCellValue:this._defaultGetCellValueForClickableColumn.bind(this,"assignedSpaces"),getCellGroupingKey:this._getCellGroupingKey.bind(this,"assignedSpaces")},{text:l.label_IPProtection_status,dataIndex:"isIPProtected",typeRepresentation:"boolean",visibleFlag:!1,width:95,getCellGroupingKey:this._getCellGroupingKey.bind(this,"isIPProtected")}]},addAdditionalColumns:function(e){let t=this;if(c.gridview&&c.gridview._additionalColumns){let i=c.gridview._additionalColumns;i.forEach(function(e){let i={};i="VariantEffectivity"===e.dataIndex?{typeRepresentation:"url",hyperlinkTarget:"_self",groupableFlag:!1,getCellValue:t._defaultGetCellValueForClickableColumn.bind(t,"VariantEffectivity")}:{groupableFlag:!1,getCellValue:function(t){if(!t||!t.nodeModel)return;return t.nodeModel.options.grid[e.dataIndex]}},UWA.extend(e,i),delete e.onCellRequest}),e.push(...i)}},addUserAdditionalColumns:async function(e,i){var n=this,o=t.getUserCustomAttributes()||[],s=t.getUserCustomAttributes(!0)||[],a=o.concat(s),l=await r.getNLSPredicates(a),d=a.map(e=>e.curi),u=Array.from(new Set(d.filter((e,t)=>d.indexOf(e)!==t))),p=1;a.forEach(function(t){var o={text:l[t.curi],typeRepresentation:t.type,setCellValue:n._additionalAttributeSetCellValue.bind(n,i,t),isCustomAttribute:!0},r=u.includes(t.curi);if(t.dimension){var s=c.dimensions[t.dimension];t.manipulationUnit?(o.text=o.text+" ("+s.Units[t.manipulationUnit].NLSName+")",o.groupableFlag=!1):o.text=o.text+" ("+s.Units[s.MKSUnit].NLSName+")"}if(t.readOnly?o.editableFlag=!1:o.getCellEditableState=n._additionalAttributeGetCellEditableState.bind(n,t),t.bo?t.isOnPhysicalProduct?(o.dataIndex="physical_"+t.curi,o.icon={iconName:"3dproduct"}):o.dataIndex=t.curi:(o.dataIndex="instance_"+t.curi,o.icon={iconName:"object-instance"}),t.isClassification&&r&&(o.getCellValue=n._additionalAttributeWithSharedPredicates.bind(n,o.dataIndex),o.initialDataIndex=o.dataIndex,o.dataIndex=o.dataIndex+"_"+p,p++),"date"===t.type&&t.multiValuated&&(o.typeRepresentation="string",o.getCellValue=n._additionalAttributeGetCellValue.bind(n,o.dataIndex,t)),"boolean"===t.type)t.multiValuated?o.typeRepresentation="string":o.getCellValue=function(e){var t=e.nodeModel.options.grid[o.dataIndex];if(t){if("TRUE"===t.toUpperCase())return!0;if("FALSE"===t.toUpperCase())return!1}};else if(void 0!==t.rangeValues){o.typeRepresentation="string",o.editionPolicy="EditionOnClick";for(var a=[],d=0;d<t.rangeValues.length;d++)a.push(t.rangeValues[d].nlsValue);o.getCellSemantics=function(e){if(e&&e.cellModel){var t=e.cellModel;if(Array.isArray(t))return null}return{possibleValues:a}},o.getCellValue=function(e){if(e&&e.nodeModel){var i=e.nodeModel.options.grid[o.dataIndex];if(i){var n=t.rangeValues.find(function(e){return e.value===i});if(n)return n.nlsValue}}}}e.push(o)})},_getCellTypeResentation:function(e,t){return t.nodeModel?(t.nodeModel.options.type!==d.type_act_logref||t.nodeModel.options.virtual)&&("maturity"!==e&&"owner"!==e||t.nodeModel.options.type!==d.type_act_logref||!t.nodeModel.options.linkInfo||"implementing"!==t.nodeModel.options.linkInfo.linkType||"ref"!==t.nodeModel.options.linkInfo.objType)&&("maturity"!==e&&"owner"!==e||!(t.nodeModel.getParent()&&t.nodeModel.getParent().options.type===d.type_spec_document||"DIF"===t.nodeModel.options.grid.kindOfRFLP))?"string":"url":"string"},_defaultGetCellEditableState:function(e){return!(!e.nodeModel||e.nodeModel.options.type!==d.type_act_logref||e.nodeModel.options.virtual)&&!(t.checkIfMaturityIsReleasedOrObsolete(e.nodeModel.options.maturity)||e.nodeModel.options.grid&&e.nodeModel.options.grid.isReservedByOther)},_additionalAttributeGetCellEditableState:function(e,t){var i=!1;return!e.isOnExtension&&!e.isClassification&&e.declaredInArray&&t&&t.nodeModel&&(e.bo&&!e.declaredInArray.includes(t.nodeModel.options.grid.actualType)||!e.bo&&!e.declaredInArray.includes(t.nodeModel.options.grid.instance_actualType))&&(i=!0),!i&&this._defaultGetCellEditableState(t)},_defaultGetCellValueForClickableColumn:function(e,t){var i=t.nodeModel.options.physicalid,n=l.label_none;("architectureNumber"===e&&(t.nodeModel.getParent()&&t.nodeModel.getParent().options.type===d.type_spec_document||"F"===t.nodeModel.options.grid.kindOfRFLP||"R"===t.nodeModel.options.grid.kindOfRFLP||"DIF"===t.nodeModel.options.grid.kindOfRFLP)||0==t.rowID&&"VariantEffectivity"===e||!i||i.length<=0)&&(n="");var o=t.nodeModel.options.grid[e]||n;return"url"===this._getCellTypeResentation(e,t)?{label:o}:o},_defaultSetCellValue:function(o,r,a,d,p){var g=this,m="instanceName"===r||"instance_description"===r;let f=c.adminStatus.ReferenceTitleMaxLength||100;if("title"===r&&(0===d.length||d.length>f)){if(0===d.length)t.alertMessage("error",null,l.msg_mandatory_field_title);else if(d.length>f){let e=l.replace(l.msg_too_long_field_title,{fieldName:l.label_title,maxLength:f});t.alertMessage("error",null,e)}o({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1})}else{var h;if("instanceName"===r){let e=c.adminStatus.InstanceNameMaxLength||100;if(d.length>e){let i=l.replace(l.msg_too_long_field_title,{fieldName:l.label_instance_title,maxLength:e});return t.alertMessage("error",null,i),void o({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1})}h=n.updateAttribute([{refID:a.nodeModel.options.physicalid,instID:a.nodeModel.options.instance.physicalid,attributes:{"PLMInstance.PLM_ExternalID":d}}])}else if("instance_description"===r)h=n.updateAttribute([{refID:a.nodeModel.options.physicalid,instID:a.nodeModel.options.instance.physicalid,attributes:{"PLMInstance.V_description":d}}]);else{var v={};"title"===r?v["PLMEntity.V_Name"]=d:"description"===r?v["PLMEntity.V_description"]=d:v[r]=d,h=n.updateAttribute([{refID:a.nodeModel.options.physicalid,attributes:v}])}g.contentView.displayModalLoader(l.msg_processing),h.then(function(n){if("title"===r||"description"===r){var l=widget.getValue("currentOpenedItem");l&&l===a.nodeModel.options.physicalid&&s.getFLWebModelEventsObj("flweb-model-events").publish({event:"idcard-refresh"})}var c=n[0].body.modified?t.formatDate(n[0].body.modified.value[0]):null;if((g.contentView.treeDocument.getMappedNodesFromId(a.nodeModel.options.physicalid)||[a.nodeModel]).forEach(function(e){"title"===r?(e.options.label=d,e.options.grid.modificationDate=c):m?e.options.instance.physicalid===a.nodeModel.options.instance.physicalid&&(e.options.grid[r]=d,e.options.instance.modificationDate=c):(e.options.grid[r]=d,e.options.grid.modificationDate=c)}),m){let t=widget.getValue("groupingEnabled"),n=a.nodeModel.getParent();t&&!n.getID&&(n=i.getGroupNodeParent(n)),e.SAXStorage().setItem(u.recentlyAuthoredStructure+n.getID(),Date.now())}else e.SAXStorage().setItem(u.recentlyAuthored+a.nodeModel.getID(),Date.now());o({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0});let p=g.contentView.getGroupingOptions();p&&g.contentView.groupRows(p)}).catch(function(){o({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1}),t.displayError({},l.msg_error_no_modification_possible,null,l.msg_error_modification_not_allowed)}).finally(function(){g.contentView.removeModalLoader(l.msg_processing)})}},_additionalAttributeSetCellValue:function(e,i,r,s,a){let d,u,p=this,g=!1;if(p.contentView.displayModalLoader(l.msg_processing),i.manipulationUnit&&i.manipulationUnit!==c.dimensions[i.dimension].MKSUnit)g=!0;else if("boolean"===i.type)s=s.toString().toUpperCase();else if("integer"===i.type||"number"===i.type)s=s.toString();else if("date"===i.type)s=s.getFullYear()+"/"+(s.getMonth()+1)+"/"+s.getDate()+"@12:00:00:GMT";else if(void 0!==i.rangeValues){var m=i.rangeValues.find(function(e){return e.nlsValue===s});void 0!==m&&(s=m.value)}if(r.cellModel&&("date"===i.type&&new Date(s).getTime()===new Date(r.cellModel).getTime()||s===r.cellModel))return;let f={refID:r.nodeModel.options.physicalid,attributes:{}},h=function(i){e({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1}),i.isOnExtension?t.displayError({},l.msg_error_no_modification_possible,null,l.msg_error_edit_attributes_on_extensions_failed):t.displayError({},l.msg_error_no_modification_possible,null,l.msg_error_modification_not_allowed)};i.manipulationUnit?(s=s.toString(),f.attributes[i.selectable]={unitName:i.manipulationUnit,dimensionType:i.dimension,value:s}):f.attributes[i.selectable]=s,!i.bo&&r.nodeModel.options.instance&&(f.instID=r.nodeModel.options.instance.physicalid),g?(convertValPayload=[{UnitFrom:i.manipulationUnit,UnitTo:c.dimensions[i.dimension].MKSUnit,Dimension:i.dimension,Values:[s]}],u=o.convertValues(convertValPayload).then(function(t){t.Response&&(d=UWA.is(t.Response[0].ConvertedValues,"string")?t.Response[0].ConvertedValues.split(";")[0]:t.Response[0].ConvertedValues[0],n.updateAttribute([f]).then(function(t){p._checkUpdateAttributeResults(e,t,r,i,s,d)}).catch(function(){h(i)}))})):u=i.manipulationUnit?n.updateAttribute([f]).then(function(t){p._checkUpdateAttributeResults(e,t,r,i,s,s)}).catch(function(){h(i)}):n.updateAttribute([f]).then(function(t){p._checkUpdateAttributeResults(e,t,r,i,s)}).catch(function(){h(i)}),u.finally(function(){p.contentView.removeModalLoader(l.msg_processing);let e=p.contentView.getGroupingOptions();e&&p.contentView.groupRows(e)})},_defaultGetCellValueForDate:function(e,i){if(i&&i.nodeModel&&i.nodeModel.options.grid[e])return t.displayDate(i.nodeModel.options.grid[e])},_additionalAttributeGetCellValue:function(e,t,i){if(i&&i.nodeModel){var n=i.nodeModel.getAttributeValue(e);if("date"===t.type&&n){var o={year:"numeric",month:"short",day:"numeric"};return Array.isArray(n)?n=n.map(function(e){return new Date(e).toLocaleDateString(void 0,o)}):new Date(n).toLocaleDateString(void 0,o)}return n}},_additionalAttributeWithSharedPredicates:function(e,t){return t.nodeModel.options.grid[e]},_checkUpdateAttributeResults:function(i,n,o,r,s,a){var c=n[0].body.modified?t.formatDate(n[0].body.modified.value[0]).getTime():null,d=c!==new Date(o.nodeModel.options.grid.modificationDate).getTime(),p=c!==(o.nodeModel.options.instance?new Date(o.nodeModel.options.instance.modificationDate).getTime():null);n[0].body["attribute["+r.selectable+"]"];if(d&&r.bo||p&&!r.bo){let i={grid:{}},l=!1;r.bo?(i.grid[r.curi]=s,a&&(i.grid[r.curi+"_actual"]=a),i.grid.modificationDate=t.formatDate(n[0].body.modified.value[0]),e.SAXStorage().setItem(u.recentlyAuthored+o.nodeModel.getID(),Date.now())):(l=!0,i.grid["instance_"+r.curi]=s,a&&(i.grid["instance_"+r.curi+"_actual"]=a),i.instance={modificationDate:t.formatDate(n[0].body.modified.value[0])},e.SAXStorage().setItem(u.recentlyAuthoredStructure+o.nodeModel.getParent().getID(),Date.now())),(this.contentView.treeDocument.getMappedNodesFromId(o.nodeModel.options.physicalid)||[o.nodeModel]).forEach(function(e){l?e.options.instance.physicalid===o.nodeModel.options.instance.physicalid&&e.updateOptions(i):e.updateOptions(i)}),t.setAuthoringMode()}else i({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1}),r.isOnExtension?t.displayError({},l.msg_error_no_modification_possible,null,l.msg_error_edit_attributes_on_extensions_failed):t.displayError({},l.msg_error_no_modification_possible,null,l.msg_error_edit_attributes_not_on_extensions_failed)},_getCellGroupingKey:function(e,t){let i=this;if(t.nodeModel&&t.columnID){let n=i.contentView.getColumnOrGroup(t.columnID).typeRepresentation,o=t.nodeModel.options.grid[e];if("icon"===n){if("cue"===e){let e;switch(o){case"group":e="cue_combined";break;case"alert":e="cue_critical";break;case"status-ko":e="cue_error";break;case"attention":e="cue_warning";break;case"info":e="cue_info"}return l[e]}}else{if("customBoolean"===n)return o?l.label_true:l.label_false;if("image"===n&&"isReserved"===e){return"TRUE"===t.nodeModel.options[e]?l.label_true:l.label_false}}return t.nodeModel.options.grid[e]}}}}),define("DS/CATFLCockpitWidget/components/SpaceAssignment/Copy/SpaceAssignmentCopy",["DS/Handlebars/Handlebars","DS/Windows/Dialog","DS/Controls/Button","DS/CATFLCockpitWidget/utils/gridview.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/services/space.service","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/components/ConfirmationWindow_Generic/ConfirmationWindow","text!DS/CATFLCockpitWidget/components/SpaceAssignment/Copy/SpaceAssignmentCopy.html","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d){e.compile(c);return{open:function(e,t){this.item=e,this.treeDocument=t,this.treeDocument.getSelectedNodes()[0].unselect(),this.tokenPostAdd=t.getXSO().onPostAdd(this._onXSOChanged.bind(this,e,t)),this.tokenPostRemove=t.getXSO().onPostRemove(this._onXSOChanged.bind(this,e,t)),r.alertMessage("success",null,d.msg_copy_space_success)},validateAndSubmit:function(){var e=this;if(void 0!==e.selectedNodes&&0!==e.selectedNodes.length){var t="";a.checkToUpdateSpace(e.selectedNodes).then(function(i){if(e.selectedNodes.forEach(function(e){"WARNING_PILOTDISC"==i[e.options.physicalid]&&(t+=e.options.label+"<br>")}),e._cleanAndDestroy(),""!==t){var n=UWA.createElement("div",{html:d.msg_has_piloting_discipline_list+"<br>"+t,styles:{"min-height":"100px","max-height":"210px","overflow-y":"auto"}});l.createWindow(widget.body,d.label_confirm_warn_piloting_header,n,d.label_confrim_warn_piloting_button,function(){e._submit()})}else e._submit()},function(t){e._cleanAndDestroy(),r.displayError(t,null,null,d.msg_generic_error_get_failed)})}else e._cleanAndDestroy()},_submit:function(){var e=this,t=[];e.item.options.assignedSpacesPID&&e.item.options.assignedSpacesPID.length>0&&e.item.options.assignedSpacesPID.forEach(function(e){t.push({options:{physicalid:e.obj}})});var i,n=[],a=[];if(e.selectedNodes.forEach(function(e){var t=e.options.assignedSpacesPID;if(t&&t.length>0)for(var i=0;i<t.length;i++)n.push(t[i].owner),a.push(e)}),0===n.length){if(0==t.length)return void r.displayError("error",null,d.msg_error_no_space_assigned_src_dest);i=Promise.resolve()}else i=s.deleteSPPConnection(n,a);i.then(function(){(t.length>0?i.then(function(){return s.createSPPConnection(e.selectedNodes,t)}):Promise.resolve()).then(function(){o.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-spaces-by-id",data:e.selectedNodes})})})},_onXSOChanged:function(e,t){this.selectedNodes=t.getSelectedNodes().filter(function(t){return t.options.physicalid!==e.options.physicalid})},_cleanAndDestroy:function(){this.treeDocument.getXSO().unsubscribe(this.tokenPostAdd),this.treeDocument.getXSO().unsubscribe(this.tokenPostRemove)}}}),define("DS/CATFLCockpitWidget/components/ArchitectureNumber/architectureNumberView",["UWA/Core","UWA/Class/View","DS/Handlebars/Handlebars","DS/UIKIT/Tooltip","DS/Controls/LineEditor","DS/WUXAutoComplete/AutoComplete","DS/Controls/Toggle","DS/UIKIT/Mask","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/architectureNumber.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u){"use strict";return t.extend({name:"architectureNumberView",tagName:"div",collection:null,toupdate:null,spinner:null,setCollection:function(e){return this.collection=e,this.columnNames=this.collection.columnNames,this.columnDetails=this.collection.columns,this.itemDetails=this.collection.rows,this},createTableComponent:function(t,i,n,o){var r=e.createElement(t,n);return o&&r.appendText(o),r.inject(i),r},createDynamicColHeader:function(e){var t=this,i={};t.columnNames.forEach(function(n){t.columnDetails[n].architectureIdColumn&&(i.class="archidcolumn"),t.createTableComponent("th",e,i,t.columnDetails[n].label)})},createCheckBox:function(e,t,i){var n=new s({type:"checkbox",value:0,checkFlag:!0});n.addEventListener(t,i),n.inject(e)},createTableHeaderView:function(t,i,n){var o,r=this,s=e.createElement("tr");return o=r.createTableComponent("th",s,{status:"ok",id:"archNo-th-checkbox"}),r.createCheckBox(o,"change",function(e){r.toggleAllEvent(e,this,r.container)}),r.createTableComponent("th",s,{},"#"),r.createDynamicColHeader(s),this.collection.showRowLevelRecomputation&&r.createTableComponent("th",s,{},u.label_reEvaluate_ArchNo),r.createTableComponent("th",s,{},u.arch_no_header),r.collection.bEffectivityCol&&r.createTableComponent("th",s,{},u.label_current_evolution),s},createInActiveTableRow:function(t){var i,o,r,s,a=this,l="",c=a.columnNames,d=a.columnDetails;i=a.createTableComponent("tr",t.parent,t.elementProperty),t.fontIcon&&(o=a.createTableComponent("td",i,t.checkBoxCol.elementProperty),e.createElement("span",{class:t.checkBoxCol.fontIconClass}).inject(o),t.itemDetails.forbidSetANErrorMessages.forEach(function(e){l=l+e+"<br><br>"}),new n({target:o,body:l})),a.createTableComponent("td",i,{editable:!1,styles:{"background-color":"#f9f9f9"}},t.itemCount),c.forEach(function(e){r=d[e],s={id:r.key,name:r.label,architectureidcolumn:void 0!==r.architectureIdColumn&&r.architectureIdColumn,required:r.required,editable:!1,styles:{"background-color":"#f9f9f9"}},a.createTableComponent("td",i,s,t.itemDetails[e])}),a.collection.showRowLevelRecomputation&&(s={id:"ANRecompute",architectureidcolumn:!1,required:!1,editable:!1,styles:{"background-color":"#f9f9f9"}},a.createTableComponent("td",i,s)),a.createTableComponent("td",i,{styles:{"background-color":"#f9f9f9"}},void 0).addClassName("archidcell"),a.addEffectivityColumnDetails(i,t.itemDetails,!0)},createTableBodyView:function(t,i){var n,s,a,l,c,p,g,m,f,h,v=this;let C=v.columnDetails;for(var b=v.itemDetails,y=t.getElement(".itemDetails"),_=0;_<b.length;_++)if(b[_].forbidSetAN&&Array.isArray(b[_].forbidSetANReasons))f="",h="",null,D=null,"REPARENT_BLANK_AN"===b[_].forbidSetANReasons[0]?(f="fonticon fonticon-checkbox-on",D={referenceID:b[_].referenceID,instanceIDs:b[_].instanceIDs,instanceID:null},m="onlyReparent"):(f="fonticon fonticon-status-ko",h="iconColor",D={referenceID:b[_].referenceID,instanceID:null,instanceIDs:null},m="ko"),v.createInActiveTableRow({itemDetails:b[_],parent:y,elementProperty:D,checkBox:!1,fontIcon:!0,itemCount:_+1,checkBoxCol:{elementProperty:{class:h,styles:{"background-color":"#f9f9f9"},status:m},fontIconClass:f}});else{n=v.createTableComponent("tr",t.getElement(".itemDetails"),{referenceID:b[_].referenceID,instanceIDs:b[_].instanceIDs,instanceID:b[_].instanceID}),s="",a="",g=v.createTableComponent("td",n,{status:"ok",id:"archNo-td-checkbox",styles:{"background-color":"#D5E8F2"}}),v.createCheckBox(g,"buttonclick",function(e){v.toggleEvent(e,this,v.container)}),v.createTableComponent("td",n,{html:_+1,editable:!1,styles:{"background-color":"#D5E8F2"}}),v.columnNames.forEach(function(e){var t,i;if(l=C[e],c={id:l.key,name:l.label,architectureidcolumn:l.architectureIdColumn||!1,required:l.required,editable:l.editable,styles:{"background-color":"#D5E8F2"}},p=v.createTableComponent("td",n,c),l.editable)if("enum"===l.format){var g=l.range,m=l.rangeLabel,f=l.rangeTooltip,h="",y=[];h=""!==b[_][e]?b[_][e]:l.defaultValue?l.defaultValue:"";for(var D=0;D<g.length;D++)y.push({label:m?m[D]:g[D],value:g[D],description:f&&f[D]?f[D]:null});(t=new r({elementsTree:y,multiSearchMode:!1,allowFreeInputFlag:!1,allowResetToUndefinedByUIFlag:!1,value:h})).inject(p),i=t.getContent().getElement("input"),t.addEventListener("change",d.updateArchitectureID.bind(v,i,n,!1))}else t=new o({className:"form-control",placeholder:u.ph_enter+C[e].label,attributes:{autocomplete:"off",name:l.label},value:b[_][e],requiredFlag:l.required}),p.classList.add("architecture-number-line-editor"),t.inject(p),(i=t._myInput).addEventListener("keyup",d.updateArchitectureID.bind(v,i,n,!1)),i.addEventListener("keydown",v.nextEditableCell);else p.setHTML(b[_][e]);C[e].architectureIdColumn&&(a="enum"===l.format?t.value?t.value:"":b[_][e],s+=a)}),v.collection.showRowLevelRecomputation&&(c={id:"ANRecompute",architectureidcolumn:!1,required:!1,editable:!1,styles:{"background-color":"#D5E8F2",cursor:"pointer"}},p=v.createTableComponent("td",n,c),e.createElement("span",{class:"fonticon fonticon-compute"}).inject(p),p.addEventListener("click",function(e){"ok"===e.currentTarget.closest("tr").getChildren()[0].getAttribute("status")&&d.executeRecompute({an_action:v.collection.AN_ACTION,rows:[e.currentTarget.closest("tr")],forReparent:v.collection.forReparent})}));var D={class:"archidcell",styles:{"background-color":"#D5E8F2"}};v.createTableComponent("td",n,D).appendText(s),v.addEffectivityColumnDetails(n,b[_],!1)}},addEffectivityColumnDetails:function(t,i,n){let o=this,r=n?"#f9f9f9":"#D5E8F2";if(o.collection.bEffectivityCol){let n={},s={architectureIdColumn:!1,editable:!1,format:"string",required:!1,styles:{"background-color":r}};n.currentEvolution=e.extend(s,{key:"currentEvolution",label:u.label_current_evolution});let a=o.createTableComponent("td",t,n.currentEvolution),l=i.instanceIDs;if(l&&l.length>0){let e="";l.forEach(t=>{o.collection.instEffectivity[t]&&(e+=o.collection.instEffectivity[t].current)}),a.setHTML(e)}}},toggleAllEvent:function(e,t,i){var n=t.getParent(),o=n.getAttribute("status"),r=i.getElements("#archNo-td-checkbox"),s=!0;"ok"===o?(s=!1,n.setAttribute("status","ko")):n.setAttribute("status","ok");for(var a=0;a<r.length;a++){r[a].getParent().getChildren().forEach(function(e,t){var i=e.getElement(".wux-controls-checkbox"),n=e.getElement(".wux-ui-fa.wux-icon");s?(0==t&&(e.setAttribute("status","ok"),i.dsModel.checkFlag=!0,n.addClassName("wux-ui-fa-check")),e.setStyle("background-color","#D5E8F2"),"lineEditor"===e.getAttribute("type")&&(e.getChildren()[0].getChildren()[0].readOnly=!1)):(0==t&&(e.setAttribute("status","ko"),i.dsModel.checkFlag=!1,n.removeClassName("wux-ui-fa-check")),e.setStyle("background-color","hsl(0, 0%, 98%)"),"lineEditor"===e.getAttribute("type")&&(e.getChildren()[0].getChildren()[0].readOnly=!0))})}},toggleEvent:function(e,t,i){var n=t.getParent(),o=n.getAttribute("status");"ok"===o?(n.getParent().getChildren().forEach(function(e){e.setStyle("background-color","hsl(0, 0%, 98%)"),"lineEditor"===e.getAttribute("type")&&(e.getChildren()[0].getChildren()[0].readOnly=!0)}),n.setAttribute("status","ko")):"ko"===o&&(n.getParent().getChildren().forEach(function(e){e.setStyle("background-color","#D5E8F2"),"lineEditor"===e.getAttribute("type")&&(e.getChildren()[0].getChildren()[0].readOnly=!1)}),n.setAttribute("status","ok"));for(var r=i.getElements("#archNo-td-checkbox"),s=i.getElements("#archNo-th-checkbox")[0].getParent().getChildren()[0],a=s.getElement(".wux-controls-checkbox"),l=s.getElement(".wux-ui-fa.wux-icon"),c=!0,d=0,u=0;u<r.length;u++)"ko"===r[u].getAttribute("status")&&c?c=!1:"ok"===r[u].getAttribute("status")&&d++;c?(a.dsModel.checkFlag=!0,l.removeClassName("wux-toggle-mixed-icon"),l.addClassName("wux-ui-fa-check")):!c&&d>0?(l.removeClassName("wux-ui-fa-check"),l.addClassName("wux-toggle-mixed-icon")):0===d&&(a.dsModel.checkFlag=!1,l.removeClassName("wux-toggle-mixed-icon"))},render:function(e){var t=this;t.container=e;var i=this.collection.columnNames,n=this.collection.columns,o=(this.collection.rows,0),r=u.arch_no_identifier_message+(t.collection.showRowLevelRecomputation?u.arch_no_recompute_message:"");t.collection.forReparent&&(r+="<br>"+u.label_reparent_archNo_header),t.createTableComponent("p",e.getElement(".identifier-msg"),{html:r}),t.columnNames.forEach(function(e){t.columnDetails[e].architectureIdColumn&&o++}),t.createTableHeaderView(i,n,o).inject(e.getElement(".columnHeader")),t.createTableBodyView(e,o)},nextEditableCell:function(e){if(e.stopPropagation(),9==e.which){e.preventDefault();var t=e.currentTarget.closest("td"),i=t.closest("tr").getChildren(),n=!1;if(t.cellIndex<i.length-1)for(var o=t.cellIndex+1;o<i.length;o++)if("true"==i[o].getAttribute("editable")){i[o].getElement("input").focus(),n=!0;break}if(!n){var r=e.currentTarget.closest("tr").nextSibling;r&&r.getElement("[editable=true] div input").focus()}}}})}),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.replace",["DS/UIKIT/Mask","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/search.util","DS/CATFLCockpitWidget/utils/refresh.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/utils/model.events.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a){"use strict";var l=i.getFullConfig().identifiers,c=i.getFullConfig().localStorageKeys;return{replaceByExisting:function(e,t,i,o,r){var s,c=this.replaceByExistingCallback.bind(this,e,t,i,o,r);s=l.type_act_logref,n.launchSearch({searchTitle:a.label_search_logref,allowedTypes:s,role:"",criteria:s,bMultiSel:!1,in_apps_callback:c})},replaceByExistingCallback:function(n,o,l,d,u,p){var g=u.getContent();e.mask(g,a.msg_processing),p&&1===p.length?r.replaceWithExistingRef(n,o,p[0].id?p[0].id:p[0].objectId,"otherReference").then(function(o){e.unmask(g);var r=o.member?o.member[0]:null,l=[],p={};if(r){i.SAXStorage().setItem(c.recentlyAuthoredStructure+n,Date.now());var m=d.options.instance.physicalid,f=u.treeDocument.getMappedNodesFromId(d.options.physicalid);f||(f=[d]);for(var h=f.length-1;h>=0;h--){var v=f[h];v.options.instance.physicalid===m&&(u.treeDocument.removeFromMappedNodes(v),v.removeChildren(),v.collapse(),v.updateOptions({hasBeenExpanded:!1,noIndexOrDBExpand:!1,dontExpandTwoLvl:!1,dontExpandAllLvl:!1,configContexts:void 0,physicalid:r.reference,instance:{physicalid:r.id},grid:{instanceName:r.name,physicalid:r.reference,configCtx:void 0}}),v.setRelationID(r.id),u.treeDocument.addToMappedNodes(v))}l.push(r.reference),p[r.id]=d,s.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-nodes-by-id",data:{arrayOfPID:l,tagAsRecentlyAuthored:!1}}),s.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-inst-by-id",data:{instIdMap:p,bInstance:!0,bEffectivity:!0}})}t.alertMessage("success",null,a.msg_replace_success)}).catch(function(i){e.unmask(g),t.displayError(i,null,null,a.error_repl_failed)}):t.alertMessage("error",null,a.msg_select_single_Logical)}}}),define("DS/CATFLCockpitWidget/services/DisplayConnectedDIFStructure.service",["DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/services/index.service","DS/CATFLCockpitWidget/utils/common.util"],function(e,t,i,n){var o=t.getFullConfig(),r={primitives:[{navigate_to_rel:{id:1,rel_type:["VPLMrel_47_PLMConnection_47_V_Owner"]},navigate_to_sr:{id:2,mode:"last",filter:{role:["325"],semantics:["1"]}}}],patterns:{LAYOUT_OR_SHEET:[{id:1},{id:2}]},patternTypeFilters:{LAYOUT_OR_SHEET:{typesToReturn:["DIFLayout","DIFSheet"]}},attributes:["physicalid","logicalid","majorid","ds6w:type","ds6w:description","ds6w:identifier","ds6w:label","ds6wg:revision","current","ds6w:status","owner","taxonomies","ds6w:responsible","ds6w:created","ds6w:modified","ds6w:lastmodifiedBy","ds6w:islastrevision","ds6w:project","ds6w:organizationresponsible","ds6w:reserved","ds6w:reservedBy","ds6wg:ArchitectureExtension.V_ArchitectureNumber"],fileAttributes:["icon","thumbnail_2d"],flags:["returnMatches"],version:3,label:"$User-$ApplicationName-$Timestamp"};return{GetConnectedDIFs:function(e){for(var t=[],o=0;o<e.length;o++)t.push(e[o].options.physicalid);return r.input_physical_ids=t,i.navigate(r).then(function(e){return e}).catch(function(e){e&&e.errorResp&&n.alertMessage("error",null,e.errorResp.message)})},GetExpandedDIFStructure:function(t){for(var i={batch:{expands:[]},outputs:{format:"entity_relation_occurrence",select_object:["physicalid","logicalid","majorid","ds6w:type","ds6w:description","ds6w:identifier","ds6w:label","ds6wg:revision","current","ds6w:status","owner","taxonomies","ds6w:responsible","ds6w:created","ds6w:modified","ds6w:lastmodifiedBy","ds6w:islastrevision","ds6w:project","ds6w:organizationresponsible","ds6w:reserved","ds6w:reservedBy","ds6wg:ArchitectureExtension.V_ArchitectureNumber"],select_relation:["physicalid","ds6w:label","ds6w:type"]}},r=0;r<t.length;r++)i.batch.expands.push({label:"CATFLCockpit-ExecuteExpand",root:{physical_id:t[r]},filter:{all:1},graph:{descending_condition_relation:{uql:'flattenedtaxonomies:"reltypes/DIFSheetInstance" OR flattenedtaxonomies:"reltypes/DIFViewInstance"'}},aggregation_processors:[{truncate:{max_distance_from_prefix:3,prefix_filter:{prefix_path:[{physical_id_path:[t[r]]}]}}}]});var s=o.webservices.progressiveExpand+"?output_format=cvjson";return e.makeServiceCall(s,"POST",JSON.stringify(i),!0,null,{timeout:0}).then(function(e){return e}).catch(function(e){e&&e.errorResp&&n.alertMessage("error",null,e.errorResp.message)})}}}),define("DS/CATFLCockpitWidget/components/BulkEdition/BulkEditionDialog",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/DataGridView/DataGridView","DS/Handlebars/Handlebars","DS/Windows/Dialog","DS/Controls/Button","DS/UIKIT/Mask","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","text!DS/CATFLCockpitWidget/components/BulkEdition/BulkEditionDialog.html","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,g){var m=l.getFullConfig();n.compile(p),JSON.parse(u);return{open:function(n,s){var a=this;a.item=n,a.collectionView=s,a.treeDocument=s.treeDocument,a.availableAttributes=new e({useAsyncPreExpand:!0}),a.availableAttributes.addChild([new t({ds6w:"ds6w:label",dataIndex:"title",selectable:"PLMEntity.V_Name",bo:!0,grid:{iconType:"object-reference",name:m.nlsBasicAttributesBO["ds6w:label"],declaredIn:g.label_all_levels}}),new t({ds6w:"ds6w:description",dataIndex:"description",selectable:"PLMEntity.V_description",bo:!0,grid:{iconType:"object-reference",name:m.nlsBasicAttributesBO["ds6w:description"],declaredIn:g.label_all_levels}})]),n.options.instance&&(a.availableAttributes.addChild(new t({ds6w:"ds6w:label",dataIndex:"instanceName",selectable:"PLMInstance.PLM_ExternalID",bo:!1,grid:{iconType:"object-instance",name:m.nlsBasicAttributesBO["ds6w:label"],declaredIn:g.label_all_levels}}),1),a.availableAttributes.addChild(new t({ds6w:"ds6w:description",dataIndex:"description",selectable:"PLMInstance.V_description",bo:!1,grid:{iconType:"object-instance",name:m.nlsBasicAttributesBO["ds6w:description"],declaredIn:g.label_all_levels}})));var l=c.getUserCustomAttributes();l&&l.forEach(function(e,i){!e.bo&&!n.options.instance||e.readOnly||(!e.declaredInArray||e.isOnExtension||e.isClassification||e.bo&&e.declaredInArray.includes(a.item.options.grid.actualType)||!e.bo&&e.declaredInArray.includes(a.item.options.grid.instance_actualType))&&a.availableAttributes.addChild(new t({ds6w:e.curi,selectable:e.selectable,bo:e.bo,dimension:e.dimension,manipulationUnit:e.manipulationUnit,grid:{iconType:e.bo?"object-reference":"object-instance",name:e.nls,declaredIn:e.declaredIn},declaredInArray:e.declaredInArray,isOnExtension:e.isOnExtension,type:e.type}))}),a.dialogDGV=new o({title:g.attributes_browser+" - "+g.label_select_attributes,height:500,width:700,resizableFlag:!1,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new r({label:g.action_copy,emphasize:"primary",disabled:!0,onClick:function(){a.selectedAttributes=a.dgv.treeDocument.getSelectedNodes(),a.treeDocument.getSelectedNodes()[0].unselect(),a.tokenPostAdd=a.treeDocument.getXSO().onPostAdd(a._onXSOChanged.bind(a,a.item,a.treeDocument)),a.tokenPostRemove=a.treeDocument.getXSO().onPostRemove(a._onXSOChanged.bind(a,a.item,a.treeDocument)),c.alertMessage("success",null,g.msg_copy_attributes_success),a.dialogDGV.close()}}),Close:new r({emphasize:"secondary",onClick:function(){a.dialogDGV.close()}})}}),a.dgv=new i({identifier:"LogicalProductDefinition_CopyAttributes_AttributesSelector",height:"inherit",treeDocument:a.availableAttributes,selectionBehavior:{unselectAllOnEmptyArea:!1},columns:[{typeRepresentation:"icon",dataIndex:"iconType",width:40},{text:g.label_name,dataIndex:"name"},{text:g.label_declared_in,dataIndex:"declaredIn"}],defaultColumnDef:{typeRepresentation:"string",width:"auto"},onContextualEvent:function(e){var t=[];return e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e,{insertRow:!0,expandCollapse:!0,pin:!0,firstColumnsVisibility:!1,columnsManagement:!1})),t},getCellTooltip:function(e){return e.nodeModel&&0===e.columnID?{shortHelp:e.nodeModel.options.bo?g.label_declared_in_reference:g.label_declared_in_instance,updateModel:!1}:a.dgv.getCellDefaultTooltip(e)}}),a.dialogDGV.elements._contentDiv.appendChild(a.dgv.getContent()),a.dgv.treeDocument.setFilterModel({name:{filterId:"stringRegexp"},declaredIn:{filterId:"stringRegexp"}}),a.tokenPostAdd=a.dgv.treeDocument.getXSO().onPostAdd(function(){a.dialogDGV.buttons.Ok.disabled=!1}),a.tokenPostRemove=a.dgv.treeDocument.getXSO().onPostRemove(function(){0===a.dgv.treeDocument.getSelectedNodes().length&&(a.dialogDGV.buttons.Ok.disabled=!0)}),a.dialogDGV.addEventListener("close",function(){a.dialogDGV.destroy()})},_postSelectionCall:function(){this.treeDocument.getSelectedNodes()[0].unselect(),this.tokenPostAdd=this.treeDocument.getXSO().onPostAdd(this._onXSOChanged.bind(this,this.item,this.treeDocument)),this.tokenPostRemove=this.treeDocument.getXSO().onPostRemove(this._onXSOChanged.bind(this,this.item,this.treeDocument))},submit:function(){var e=this;if(void 0!==e.selectedNodes&&0!==e.selectedNodes.length){s.mask(widget.body,g.msg_processing);var t,i=[],n=!1,o=!1,r={};e.selectedNodes.forEach(function(s){var a={},l={},c={objectLabel:s.options.label,instance_pid:s.options.instance?s.options.instance.physicalid:null,icons:[s.options.icons[0]],refAttributes:[],instAttributes:[]};r[s.options.physicalid]=c;for(var d=0;d<e.selectedAttributes.length;d++){var u=e.selectedAttributes[d].options.dataIndex||e.selectedAttributes[d].options.ds6w,p=!1,g=e.selectedAttributes[d].options.isOnExtension;!e.selectedAttributes[d].options.declaredInArray||g?p=!0:(e.selectedAttributes[d].options.bo&&e.selectedAttributes[d].options.declaredInArray.includes(s.options.grid.actualType)||!e.selectedAttributes[d].options.bo&&e.selectedAttributes[d].options.declaredInArray.includes(s.options.grid.instance_actualType))&&(p=!0),e.selectedAttributes[d].options.bo?c.refAttributes.push({name:e.selectedAttributes[d].options.grid.name,iconType:e.selectedAttributes[d].options.grid.iconType,copySuccessful:!1,isDeclaredIn:p,isOnExtension:g,responsibleForError:void 0}):c.instAttributes.push({name:e.selectedAttributes[d].options.grid.name,iconType:e.selectedAttributes[d].options.grid.iconType,copySuccessful:!1,isDeclaredIn:p,isOnExtension:g,responsibleForError:void 0}),"title"===u?a[e.selectedAttributes[d].options.selectable]=e.item.options.label:"instanceName"===u?l[e.selectedAttributes[d].options.selectable]=e.item.options.grid.instanceName:e.selectedAttributes[d].options.bo?e.selectedAttributes[d].options.manipulationUnit?a[e.selectedAttributes[d].options.selectable]={unitName:e.selectedAttributes[d].options.manipulationUnit,dimensionType:e.selectedAttributes[d].options.dimension,value:e.item.options.grid[u]}:"date"===e.selectedAttributes[d].options.type?(t=(t=new Date(e.item.options.grid[u])).getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()+"@12:00:00:GMT",a[e.selectedAttributes[d].options.selectable]=t):a[e.selectedAttributes[d].options.selectable]=e.item.options.grid[u]:e.selectedAttributes[d].options.manipulationUnit?l[e.selectedAttributes[d].options.selectable]={unitName:e.selectedAttributes[d].options.manipulationUnit,dimensionType:e.selectedAttributes[d].options.dimension,value:e.item.options.grid["instance_"+u]}:"date"===e.selectedAttributes[d].options.type?(t=(t=new Date(e.item.options.grid["instance_"+u])).getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()+"@12:00:00:GMT",a[e.selectedAttributes[d].options.selectable]=t):l[e.selectedAttributes[d].options.selectable]=e.item.options.grid["instance_"+u]}Object.keys(a).length>0&&(i.push({refID:s.options.physicalid,attributes:a}),n=!0),Object.keys(l).length>0&&s.options.instance&&(i.push({instID:s.options.instance.physicalid,attributes:l}),o=!0)}),a.updateAttribute(i).then(function(t){mapResp={};for(var i=0;i<t.length;i++)mapResp[t[i].body.physicalid]=t[i].body;for(var s={grid:{}},a={grid:{}},d=0;d<e.selectedAttributes.length;d++){var u=e.selectedAttributes[d].options.dataIndex||e.selectedAttributes[d].options.ds6w;"title"===u?s.label=e.item.options.label:e.selectedAttributes[d].options.bo?(e.selectedAttributes[d].options.manipulationUnit&&(s.grid[u+"_actual"]=e.item.options.grid[u+"_actual"]),s.grid[u]=e.item.options.grid[u]):"instanceName"===u?a.grid[u]=e.item.options.grid[u]:(e.selectedAttributes[d].options.manipulationUnit&&(a.grid["instance_"+u+"_actual"]=e.item.options.grid["instance_"+u+"_actual"]),a.grid["instance_"+u]=e.item.options.grid["instance_"+u])}for(var p=0;p<e.selectedNodes.length;p++){var g,f,h,v,C=e.selectedNodes[p],b=!1,y=!1;if(n){g=mapResp[C.options.physicalid],h=g&&g.modified?c.formatDate(g.modified.value[0]):null;var _=new Date(C.options.grid.modificationDate);b=!(!h||!_)&&h.getTime()!==_.getTime()}if(o&&C.options.instance){f=mapResp[C.options.instance.physicalid],v=f&&f.modified?c.formatDate(f.modified.value[0]):null;var D=C.options.instance?new Date(C.options.instance.modificationDate):null;y=!(!v||!D)&&v.getTime()!==D.getTime()}n&&b&&l.SAXStorage().setItem(m.localStorageKeys.recentlyAuthored+C.options.physicalid,Date.now()),o&&y&&l.SAXStorage().setItem(m.localStorageKeys.recentlyAuthoredStructure+C.getParent().options.physicalid,Date.now()),(e.treeDocument.getMappedNodesFromId(C.options.physicalid)||[C]).forEach(function(e){b&&(s.grid.modificationDate=h,e.updateOptions(JSON.parse(JSON.stringify(s))),r[C.options.physicalid].refAttributes.forEach(function(e,t){e.copySuccessful=!0})),e.options.instance&&e.options.instance.physicalid===C.options.instance.physicalid&&y&&(a.instance={modificationDate:v},e.updateOptions(JSON.parse(JSON.stringify(a))),r[C.options.physicalid].instAttributes.forEach(function(e,t){e.copySuccessful=!0}))})}let S=e.collectionView.getGroupingOptions();S&&e.collectionView.groupRows(S),e._createSummaryPastDialog(r)}).catch(function(t){if(t&&t.error&&t.error.errorList){for(var i in itemsResponsibleForError=[],itemsResponsibleForError=t.error.errorList.map(function(e){return e.physicalid}),r){var n=r[i].refAttributes.concat(r[i].instAttributes);for(var o in n){n[o];itemsResponsibleForError.includes(i)||itemsResponsibleForError.includes(r[i].instance_pid)?n[o].responsibleForError=!0:n[o].responsibleForError=!1}}e._createSummaryPastDialog(r)}else c.displayError(t,g.error_copy_attributes_failed,null,"")}).finally(function(){s.unmask(widget.body),setTimeout(function(){e._cleanAndDestroy()},500)})}else e._cleanAndDestroy()},_onXSOChanged:function(e,t){this.selectedNodes=t.getSelectedNodes().filter(function(t){return t.options.physicalid!==e.options.physicalid})},_cleanAndDestroy:function(){this.treeDocument.getXSO().unsubscribe(this.tokenPostAdd),this.treeDocument.getXSO().unsubscribe(this.tokenPostRemove),this.dialogDGV&&(this.dialogDGV.destroy(),this.dialogDGV=null)},_createSummaryPastDialog:function(n){for(var s in this.treedocumentSummaryPaste=new e({useAsyncPreExpand:!0}),n){var a=n[s],d=new t({label:a.objectLabel,icons:a.icons});this.treedocumentSummaryPaste.addChild(d);var u=a.refAttributes.concat(a.instAttributes);for(var p in u){var m=u[p],f="";m.copySuccessful||(f=!0===m.responsibleForError?m.isDeclaredIn?m.isOnExtension?g.msg_copy_attribute_on_extension_failed:g.msg_copy_attribute_failed_not_allowed:g.msg_copy_attribute_on_type_failed:!1===m.responsibleForError?g.msg_copy_all_attributes_failed:m.isDeclaredIn?m.isOnExtension?g.msg_copy_attribute_on_extension_failed:g.msg_copy_attribute_failed:g.msg_copy_attribute_on_type_failed),d.addChild(new t({label:m.name,icons:[m.iconType],grid:{copySuccessful:m.copySuccessful,message:f}}))}}this.treedocumentSummaryPaste.expandAll();var h=new i({identifier:"LogicalProductDefinition_SummaryPasteAttributes",height:"inherit",treeDocument:this.treedocumentSummaryPaste,rowSelection:"none",columns:[{dataIndex:"tree",text:g.label_title,width:"30%"},{typeRepresentation:"boolean",text:g.label_copy_successful,dataIndex:"copySuccessful",width:95,getCellClassName:function(e){return e&&e.nodeModel?!0===e.nodeModel.options.grid.copySuccessful?"sax-is-copySuccessful-true":"sax-is-copySuccessful-false":null}},{text:g.label_information,dataIndex:"message"}],defaultColumnDef:{typeRepresentation:"string",width:"auto"},onContextualEvent:function(e){var t=[];return e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e,{insertRow:!0,expandCollapse:!0,pin:!0,firstColumnsVisibility:!1,columnsManagement:!1})),t}}),v=new o({title:g.title_summary_paste_attributes,height:500,width:1e3,resizableFlag:!1,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Apply:new r({label:g.action_export,emphasize:"secondary",onClick:function(){var e=h.getAsCSV(),t=g.action_export+"_"+g.title_summary_paste_attributes+".csv",i=new Date,n=l.getUser("isFullName");e=g.title_summary_paste_attributes+"\nFile Name,"+t+"\nExport Date Time,"+i+"\nExported By,"+n+"\n\n\n"+e,c.downloadFile(t,e,!0),c.alertMessage("success",null,g.msg_summary_paste_attributes_export_success)}}),Close:new r({emphasize:"primary",onClick:function(){v.close()}})}});v.addEventListener("close",function(){v.destroy()}),v.elements._contentDiv.appendChild(h.getContent()),h.treeDocument.setFilterModel({tree:{filterId:"stringRegexp"}})}}}),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.additionalcolumns",["DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/dimensions.service","DS/CATFLCockpitWidget/utils/model.events.util","DS/Utilities/StringUtils","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s){var a=e.getFullConfig();a.identifiers,a.localStorageKeys;return{_getAdditionalColumns:function(e){return e.gridview||(e.gridview={}),Promise.all([this._getConfigurationColumns(e)])},_getConfigurationColumns:function(e){let t=[],i={},n=[];var o=new Promise(function(e){require(["DS/CfgWebAppEffectivityUX/scripts/CfgConfigurationContextColumn"],function(n){n.isAdditionalColumnsAvailable(function(o){if(!0===o){let e=[];n.getAdditionalColumnsUX(e),e.forEach(e=>{e.columnModule="cfgContext",t.push(e)}),i.cfgContext=n}e()}),o.name="Add "+n.getName()})});n.push(o);var r=new Promise(function(e){require(["DS/CfgWebAppEffectivityUX/scripts/CfgEffectivityColumns"],function(n){n.isAdditionalColumnsAvailable(function(o){if(!0===o){let e=[];n.getAdditionalColumnsUX(e),e.forEach(e=>{e.columnModule="cfgEffectivty",t.push(e)}),i.cfgEffectivty=n}e()}),r.name="Add "+n.getName()})});n.push(r);var s=new Promise(function(e){require(["DS/CfgWebAppEffectivityUX/scripts/CfgConfigurationRevisionColumn"],function(n){n.isAdditionalColumnsAvailable(function(o){if(!0===o){let e=[];n.getAdditionalColumnsUX(e),e.forEach(e=>{e.columnModule="cfgRevision",t.push(e)}),i.cfgRevision=n}e()}),s.name="Add "+n.getName()})});return n.push(s),Promise.all(n).then(function(){t.length>0&&(e.gridview._additionalColumns?e.gridview._additionalColumns.push(...t):e.gridview._additionalColumns=t),Object.keys(i).length>0&&(e.gridview.additionalColumnsModules=i)})}}}),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.deletion",["DS/UIKIT/Mask","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/group.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/document.service","DS/CATFLCockpitWidget/utils/config.util","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l){"use strict";var c=JSON.parse(a);return{deleteLogItemInstance:function(n){var r=n.collectionView.getContent(),a=n.collectionView.treeDocument.getSelectedNodes();e.mask(r,l.msg_processing);let d=widget.getValue("groupingEnabled");var u={},p={};a.forEach(function(e){var t=e.options.instance.physicalid,n=e.getParent();d&&!n.getID&&(n=i.getGroupNodeParent(n));let o=n.options.physicalid;void 0===u[o]&&(u[o]=[],p[o]=[]),u[o].push(t),p[o].push(e)});var g=[],m={success:[],failure:[],errorMessages:[]};for(var f in u)s.SAXStorage().setItem(c.recentlyAuthoredStructure+f,Date.now()),u.hasOwnProperty(f)&&g.push(o.deleteLogItemInstance(f,u[f]).then(this.updateViewOnDelete.bind(this,n.collectionView.treeDocument,p[f],"success",m)).catch(this.updateViewOnDelete.bind(this,n.collectionView.treeDocument,p[f],"failure",m)));Promise.all(g).finally(function(){if(m&&m.success.length>0){let e=n.collectionView.getGroupingOptions();e&&n.collectionView.groupRows(e),t.alertMessage("success",null,l.msg_inst_detach_success+m.success.toString())}if(m&&m.failure.length>0){let e=m.failure.toString();if(m.errorMessages&&Object.keys(m.errorMessages).length>0){e+="<br><br>"+l.error_details;for(let t in m.errorMessages)e+="<br><b>"+m.errorMessages[t].toString()+"</b><br>",t.indexOf("\n\n")>=0&&(t=t.split("\n\n")[1]),e+=t}t.alertMessage("error",null,null,l.msg_inst_detach_failure+e)}e.unmask(r)})},updateViewOnDelete:function(e,t,n,o,r){let a=widget.getValue("groupingEnabled"),l=t[0].getParent();a&&!l.getID&&(l=i.getGroupNodeParent(l));let d=l.options.physicalid;"success"===n?(o.success.push(l.options.label),a&&l.isRoot()?t.forEach(function(e){let t=e.getParent();t.getChildren().forEach(function(t){t.options.instance&&t.options.instance.physicalid===e.options.instance.physicalid&&t.remove()}),i.removeGroupNodesOnEmpty(t)}):t.forEach(function(t){let i;(i=e.getMappedNodesFromId(d)).forEach(function(e){e.getChildren().forEach(function(e){e.options.instance&&e.options.instance.physicalid===t.options.instance.physicalid&&e.remove()}),e.expand()})}),s.SAXStorage().setItem(c.recentlyAuthoredStructure+d,Date.now())):(r.errorResp&&r.errorResp.message&&(Object.keys(o.errorMessages).indexOf(r.errorResp.message)<0?o.errorMessages[r.errorResp.message]=[l.options.label]:o.errorMessages[r.errorResp.message].push(l.options.label)),o.failure.push(l.options.label))}}}),define("DS/CATFLCockpitWidget/services/config.service",["DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/CATFLCockpitWidget/services/dimensions.service","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.additionalcolumns","text!DS/CATFLCockpitWidget/assets/config/mapping.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s){"use strict";var a={PRIVATE:"Private",IN_WORK:"In Work",FROZEN:"Frozen",RELEASED:"Released",OBSOLETE:"Obsolete"};JSON.parse(r);return{extendConfiguration:function(e){return Promise.all([this._getSubTypesMetaData(e),this._getBasicAttributesProperties(e),this._getAdditionalAttributesRangeValues(e),this._getNlsMaturityValues(e),this._getConfiguredAdminStatus(e),o._getAdditionalColumns(e),t.getAllDimensions(e)])},_getNlsMaturityValues:function(t){return new Promise(function(i,n){e.getNlsOfPropertiesValues(JSON.stringify({"ds6w:status":["PRIVATE","IN_WORK","FROZEN","RELEASED","OBSOLETE"]}),{apiVersion:"R2019x",tenantId:widget.getValue("x3dPlatformId"),lang:widget.lang||"en",onComplete:function(e){var n=e["ds6w:status"];for(var o in t.MAPPING_MATURITY={},n)n.hasOwnProperty(o)&&(t.MAPPING_MATURITY[o]=n[o]);i()},onFailure:function(){t.MAPPING_MATURITY=a,i()}})})},_getBasicAttributesProperties:function(t){return new Promise(function(i,n){e.getPropertiesForClass(t.identifiers.type_act_logref+","+t.identifiers.type_act_loginstance,{apiVersion:"R2019x",lang:widget.lang||"en",tenantId:widget.getValue("x3dPlatformId"),onComplete:function(e){t.nlsBasicAttributesBO={},t.nlsBasicAttributesRel={},e[0].properties.forEach(function(e){-1!==t.identifiers.index_services.select_bo.indexOf(e.curi.toLowerCase())&&(t.nlsBasicAttributesBO[e.curi]=e.label)}),e[1].properties.forEach(function(e){-1!==t.identifiers.index_services.select_rel.indexOf(e.curi)&&(t.nlsBasicAttributesRel[e.curi]=e.label)}),i()},onFailure:function(){n()}})})},_getAdditionalAttributesRangeValues:function(t){var i=n.getUserCustomAttributes()||[],o=n.getUserCustomAttributes(!0)||[],r=i.concat(o),s={};return r.forEach(function(e){if(void 0!==e.rangeValues){s[e.curi]=[];for(var t=0;t<e.rangeValues.length;t++)s[e.curi].push(e.rangeValues[t].value)}}),new Promise(function(t,i){e.getNlsOfPropertiesValues(JSON.stringify(s),{apiVersion:"R2019x",tenantId:widget.getValue("x3dPlatformId"),lang:widget.lang||"en",onComplete:function(e){r.forEach(function(t){if(void 0!==e[t.curi])for(var i in t.rangeValues=[],e[t.curi])t.rangeValues.push({value:i,nlsValue:e[t.curi][i]})}),t()},onFailure:function(){t()}})})},_getSubTypesMetaData:function(e){return e.logicalRefSubTypes=[],i.post(e.webservices.dsfl_getSubTypesMetaData,JSON.stringify([e.identifiers.type_act_logref]),0).then(function(t){e.logicalRefSubTypes=JSON.parse(t).Types,e.logicalRefSubTypes.forEach(function(t){void 0===e.mappingType[t.Name]&&(e.mappingType[t.Name]={nlsName:t.NLS,icon:t.IconName})})}).catch(function(e){var t=e.error.message.slice(e.error.message.indexOf("ResponseCode")),i=s.error_get_subtypes;t&&t.indexOf("404")>=0&&(i=s.error_get_subtypes_media),n.displayError(e,null,null,i)})},_getConfiguredAdminStatus:function(e){let t=e.webservices.getReadOnlyAdminSettings;return e.adminStatus={},i.post(t,JSON.stringify({})).then(function(t){for(var i in t=JSON.parse(t))"status"!==i&&(e.adminStatus[i]=t[i])}).catch(function(e){})}}}),define("DS/CATFLCockpitWidget/components/ImplementLinks/implementLinks.controller",["DS/UIKIT/Mask","DS/Windows/Dialog","DS/CATFLCockpitWidget/utils/search.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/gridview.util","DS/CATFLCockpitWidget/utils/group.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/modeler.service","DS/CATFLCockpitWidget/services/implementlink.service","DS/CATFLCockpitWidget/model/CATFLCockpitTreeDocument","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrix","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,g,m,f,h){"use strict";var v=JSON.parse(m),C=JSON.parse(f);return{manageRef2RefImplRel:function(e){var t=v.type_usecase+","+v.type_requirement+","+v.type_reqSpec+","+v.type_reqGroup+","+v.type_act_functref+","+v.type_act_logref+","+v.type_act_physical;i.launchSearch({allowedTypes:t,role:"",criteria:t,bMultiSel:!0,in_apps_callback:function(t){var i,o=e.selectedNode,s=[],a=[];t.forEach(function(e){a.push(e.id)}),l.getKindOfRFLP(a).then(function(e){e&&e.length>0&&(e.forEach(function(e,t){i={},"P"===e?(i.implementing=a[t],i.implemented=o.options.physicalid):(i.implementing=o.options.physicalid,i.implemented=a[t]),s.push(i)}),d.createScopeLinks(s).then(function(e){r.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-refLinks-by-id",data:[o]}),n.alertMessage("success","",h.msg_ref2ref_create_success)}).catch(function(e){n.displayError(e,null,null,h.error_create_refref_link)}))},function(e){n.displayError(e,null,h.error_create_refref_link)})}})},manageOcc2OccImplRel:function(t){var i=this;let p=widget.getValue(C.componentView);var g=widget.body.querySelector(".fl-cockpit-app-container");e.mask(g,h.msg_loading);var m=t.selectedNode,f=m.getParent().getRelationID();f=f.slice(0,f.indexOf("ref"));var v=m.getParent().getParent();widget.getValue("groupingEnabled")&&!v.getID&&(v=a.getGroupNodeParent(v)),c.expand({itemIDs:[v.options.physicalid,m.options.physicalid]}).then(function(e){i.instToNodeMap={},i.refTypes=[],i.instTypes=[];var t=i.mapParentToChildren(e[v.options.physicalid]),a=i.mapParentToChildren(e[m.options.physicalid]);if(t&&a){if(!t.getChildren()||!a.getChildren())return void n.alertMessage("error",null,"",h.msg_system_missing_children);var c=new u({useAsyncPreExpand:!0});c.addChild(t),c.addChild(a);var g=[];g.push(l.getTypeSchemaDetails({Type:i.refTypes,Relationship:i.instTypes})),g.push(d.getInstanceImplementLinks(Object.values(i.instToNodeMap))),o.makeMultipleServiceCalls(g,!0).then(function(e){var n=e[0],o=e[1],l=i.mapRefNInstTypes(n);o.forEach(function(e){if(e[f]){var t=e.node,i=[];e[f].forEach(function(n){i.push({id:e.node.options.instance.physicalid,path:n.path,state:"nochange"}),t.relations=i})}}),i.trMatrixModelEvents=r.createAppEventObject("trMatrix-model-events"),i.trMatrixModelEvents.subscribe({event:"occLink-refresh"},function(e){if(e&&e.firstSystemNode){var t=v.getTreeDocument().getNodesById(e.firstSystemNode.options.physicalid);t&&t.forEach(function(t){let i=d.getAllImplPaths(f,t,[],[]);t.options.instance.physicalid===e.firstSystemNode.options.instance.physicalid&&i.indexOf(e.ctxPath)&&(r.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-update-cues",data:[t]}),p===C.structuredView&&t.options.hasBeenExpanded&&s._addOccImplementLinksToNode(t))})}}),i.launchTraceabilityMatrix({system1:t,system2:a,linkType:f,typesMap:l,modelEvents:i.trMatrixModelEvents})})}}).catch(function(e){n.displayError(e,null,null,h.error_manage_occocc_link)}).finally(function(){e.unmask(g)})},mapParentToChildren:function(e){var t,i=e.map,n=e.rootUuid;return i[n]&&(t=this.createNodeStruct(null,i[n],i,null)),t},createNodeStruct:function(e,t,i,n){var o,r=this,s=new p(t.attributes);e?e.addChild(s):o||(o=s),r.refTypes.indexOf(s.options.grid.actualType)<0&&r.refTypes.push(s.options.grid.actualType),n&&(s.options.instance={physicalid:n.pid,type:n.type,name:n.name},r.instToNodeMap[n.pid]=s,r.instTypes.indexOf(n.type)<0&&r.instTypes.push(n.type));var a=t.instances||t.relations;return a&&a.forEach(function(e){let t;if(e.attributes)for(let i=0;i<e.attributes.length;i++)if("PLMInstance.PLM_ExternalID"===e.attributes[i].name){t=e.attributes[i].value;break}r.createNodeStruct(s,i[e.toUuid],i,{pid:e.physicalid,type:e.type,name:t})}),o},mapRefNInstTypes:function(e){var t,i={references:{},instances:{}};return this.refTypes.forEach(function(n){t=e.Type[n],i.references[n]={name:t.TypeNLS||n,parent:t.Hierarchy}}),this.instTypes.forEach(function(n){t=e.Relationship[n],i.instances[n]={name:t.RelationshipNLS||n,parent:t.Hierarchy}}),i},launchTraceabilityMatrix:function(e){var i=e.system1.options.label+" "+e.system1.options.grid.revision,n=e.system2.options.label+" "+e.system2.options.grid.revision,o=g.init(e);if(o){var r=new t({title:h.replace(h.header_traceability_matrix,{system1:i,system2:n}),content:o,height:500,width:700,resizableFlag:!0,modalFlag:!0,immersiveFrame:widget.immersiveFrame});r.addEventListener("close",function(){r.destroy()})}},deleteImplRel:function(e){var t,i=e.selectedNodes,o=[];i.forEach(function(e){(t=e.options.linkInfo)&&o.push(t.implementId)}),o.length>0&&d.deleteImplementLinks(o).then(function(o){var s,l=[];let c=widget.getValue("groupingEnabled");i.forEach(function(i){t=i.options.linkInfo;var n=i.getParent().getParent();c&&!n.getID&&(n=a.getGroupNodeParent(n)),(s=e.treeDocument.getMappedNodesFromId(n.options.physicalid))||(s=[n]),s.forEach(function(e){l.push(e);var i=e.options.instance?e.options.instance.physicalid:"",n=e.getNodesByRelId(t.linkType+t.objType+i)[0];n&&(n.getChildren().forEach(function(e){e.options.linkInfo.implementId===t.implementId&&e.remove()}),n.getChildren()&&0!==n.getChildren().length||n.remove()),e.expand()})}),n.alertMessage("success","",h.msg_delete_link_success),r.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-update-cues",data:l})}).catch(function(e){n.displayError(e,null,null,h.error_delete_link)})}}}),define("DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCues.actions",["UWA/Core","DS/UIKIT/Modal","DS/UIKIT/Mask","DS/UIKIT/Iconbar","DS/UIKIT/Scroller","DS/UIKIT/Input/Button","DS/UIKIT/Input/Toggle","DS/Handlebars/Handlebars4","WebappsUtils/WebappsUtils","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/gridview.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/implementlink.service","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.attachment","DS/CATFLCockpitWidget/components/SpaceAssignment/SpaceAssignment","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","text!DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCueActions.html","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,g,m,f,h,v,C,b){"use strict";var y=JSON.parse(v);return{displayCuesActionsonInstance:function(e,t,i){var n=this;n.container=t.triptych._rightPanelContent,n.cueActionsInfo={},n.userPref=e,n.appContext=t,n.rowData=i,n.refresh(),n.container.getElementsByClassName("EditProp_MasterContain")[0].hide(),n.appContext.triptych.modelEvents.subscribe({event:"triptych-hide-panel"},function(e){if("right"===e){var t=n.container.getElementsByClassName("EditProp_MasterContain");t&&t[0].isHidden()&&t[0].show()}}),n.appContext.triptych.modelEvents.publish({event:"triptych-show-panel",data:"right"})},getCuesActionlistContent:function(){var t=this.cuesContainer=e.createElement("div",{class:"ConvergenceCues_ActionsContainer"}),i=a.compile(C),n={};n.header=b.replace(b.header_cues_actions,{title:this.rowData.instParentTitle}),n.cueRows=this.getCuesRowListContent(this.cuesActionList),t.addContent(i(n));var r=t.getElement(".actionlist-container").remove(),s=t.getElement(".container-scroll");return new o({element:r}).inject(s),this.manageEvents(),this.subscribeToEvents(),t},getCuesRowListContent:function(t){var i=this,n=[];if(t){var o;i.cueMsgList={};var r,s=l.getWebappsAssetUrl("CATFLCockpitWidget","icons")+"/I_RFLPLMImplementConnection.png",a=widget.getValue("currentConfig"),c=!1;a&&a.modelVersion&&(a.modelVersion.current===y.state_act_Release||a.modelVersion.current===y.state_act_Obsolete)?c=!0:i.rowData.nodeModel.options.grid.maturity!==y.state_act_Released&&i.rowData.nodeModel.options.grid.maturity!==y.state_act_Obsolete||(c=!0),t.forEach(function(t){i.cueActionsInfo[t.id]=t;var a=t.msg,l={};if(t.itemsInfo){var d=[];t.itemsInfo.forEach(function(t,i){if(d.indexOf(t.itemPhysicalId)<0){d.push(t.itemPhysicalId),l[i]=t,t.displayText=t.itemTitle+" "+t.itemRevision;var n=e.createElement("div",{id:i,draggable:!0,class:"drag-text",html:' <span class="wux-ui-3ds wux-ui-3ds-lg wux-ui-3ds-drag-grip"></span> '+t.displayText+" "}),o=a.split(t.displayText);o.length>=0&&o.forEach(function(e,t){0==t?a=o[t]:a+=" "+n.outerHTML+" "+o[t]})}})}a.indexOf("\n")>=0&&a.split("\n").forEach(function(e,t){0==t?a=e:a+="<br>"+e});i.cueActionsInfo[t.id].cueLinks=l,r=t.icon&&t.icon.indexOf("https")>=0?t.icon:s,o={cueId:t.id,cueSeverity:t.severity.toUpperCase(),cueImg:r,cueTitle:t.title,cueSubtitle:a},y.cues_with_actions.indexOf(t.id)>=0&&!c&&(o.isLink="link"),n.push(o)})}return n},manageEvents:function(){var e=this;e.cuesContainer.getElements(".drag-text").forEach(function(t){t.addEventListener("dragstart",function(t){var i=t.target.getParent().getParent().getParent().id,n=e.cueActionsInfo[i].cueLinks[t.target.id],o={protocol:"3DXContent",version:"1.1",source:widget&&widget.getValue("appId"),widgetId:widget.id,data:{items:[{envId:c.getTenant(),serviceId:"3DSpace",contextId:"ctx::"+c.getSecurityContext(),objectId:n.itemPhysicalId,objectType:n.itemType,displayName:n.displayText}]}};t.dataTransfer.setData("Text",JSON.stringify(o))})}),e.cuesContainer.getElements(".link").forEach(function(t){t.addEventListener("click",function(t){var i=t.target.getParent().getParent().id;e.manageActionLinks(i,e.rowData)})})},subscribeToEvents:function(){p.getFLWebModelEventsObj("flweb-model-events");p.getFLWebModelEventsObj("flcockpit-content-list-view").subscribe({event:"refresh-cues-report"},this.refresh.bind(this))},manageActionLinks:function(e,t){"ENOXSolutionsCueNoSolution"===e?f.openModalSolutionSelection([t.nodeModel]):"ENOXSpaceAssignmentsCueNoAssignment"!==e&&"ENOXSpaceAssignmentsCueMultipleAssignments"!==e||("ENOXSpaceAssignmentsCueMultipleAssignments"!==e||t.nodeModel.options.assignedSpacesPID?new h(t.nodeModel):u.addAssignedSpacesAttribute([t.nodeModel]).then(()=>{new h(t.nodeModel)}))},refresh:function(){var e=this.container.getElementsByClassName("ConvergenceCues_ActionsContainer");e&&e[0]&&e[0].destroy(),this.getCuesReport()},getCuesReport:function(){var e=this,t=e.userPref.cues_state,i=Object.values(t),n=e.userPref.combined_state,o=e.rowData.nodeModel,r=!1;o.options.cueDetails&&"group"===o.options.cueDetails.cue&&(r=!0);var s=m.confAllImplPathsOnNodes([o],!1,!1);g.getCuesReportOnInstance(i,e.rowData.instanceID,s.payload).then(function(i){if(i){var o=i[e.rowData.instanceID],s=i.cueNLSInfo,a={};if(e.cuesActionList=[],o&&(o.forEach(function(i){a=t[i.cueId];var n=i.cueMessageInfo;e.cuesActionList.push({id:i.cueId,title:i.cueLabel,icon:i.cueIcon,msg:n?n.Message:i.cueMessage,severity:a?a.cueSeverity:"",itemsInfo:n?n.RelatedObjects:null})}),r&&n&&n.active)){var l="<b>"+b.label_operator+": "+b["label_operator_"+n.operator]+"</b>\n";for(var c in n.combinedCues){var d=n.combinedCues[c];l+=s[c]+" = "+b["val_"+d]+"\n"}var u={id:"combined_conv_state",title:b.header_combined_convg_cues,msg:l,severity:"COMBINED",itemsInfo:null};e.cuesActionList.splice(0,0,u)}var p=e.getCuesActionlistContent(),g=e.container.getElementsByClassName("ConvergenceCues_ActionsContainer");g&&g[0]&&g[0].destroy(),p.inject(e.container)}})}}}),define("DS/CATFLCockpitWidget/components/DisciplineIterations/lastOutfittedState.compare",["UWA/Core","DS/Windows/Dialog","DS/Controls/Button","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/implementlink.service","DS/CATFLCockpitWidget/components/CommandsCtrl/command.controller","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a){"use strict";var l=function(e){this.options=e};return l.prototype.render=function(){var e=this,s={instanceId:e.options.selectedNodes[0].options.instance.physicalid,occurrenceInfo:r.confAllImplPathsOnNodes(e.options.selectedNodes,!1,!1).payload};o.compareWithLastOutfitted(s).then(function(n){var o=e.getCompareOptionsContainer(n);e.dialog=new t({title:a.compareWithLastOutfitted,content:o,width:350,resizableFlag:!0,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Cancel:new i({emphasize:"secondary",onClick:function(){e.dialog.close()}})}}),e.dialog.addEventListener("close",function(){e.dialog.destroy()})}).catch(function(e){n.displayError(e,null,null,a.error_compare_last_outfitted)})},l.prototype.getCompareOptionsContainer=function(t){var i=e.createElement("div",{class:"compare-options-container"}),n=e.createElement("div",{class:"compare-options-subcontainer"}).inject(i);this._createItemCompareSection(t.compareLogicalItem).inject(n);var o=e.createElement("div",{class:"compare-options-subcontainer"}).inject(i);this._createPilotingDiscCompareSection(t.pilotingDisciplines).inject(o);var r=e.createElement("div",{class:"compare-options-subcontainer"}).inject(i);return this._createPropSolnCompareSection(t.proposedSolutions).inject(r),i},l.prototype._createItemCompareSection=function(t){var n=this,o=t.left,r=t.right,s=o.title+" "+o.revision,l=r.title+" "+r.revision,c=e.createElement("div",{class:"compare-item-container"});e.createElement("div",{class:"compare-options-subheader",html:a.label_log_ref}).inject(c);var d=e.createElement("div",{class:"compare-item-subcontainer"}).inject(c),u=e.createElement("div",{class:"compare-row-container"}).inject(d);e.createElement("div",{html:s+" with "+l}).inject(u);var p=[];return p.push({physicalid:o.physicalid,label:s},{physicalid:r.physicalid,label:l}),new i({label:a.compare,emphasize:"primary",onClick:function(){n.launchCompare(p)}}).inject(u),c},l.prototype._createPilotingDiscCompareSection=function(t){var n=this,o=e.createElement("div",{class:"compare-item-container"});e.createElement("div",{class:"compare-options-subheader",html:a.header_subtitle_piloting_disc}).inject(o);var r=e.createElement("div",{class:"compare-item-subcontainer"}).inject(o);if(t)return t&&t.compare&&t.compare.forEach(function(t){var o=e.createElement("div",{class:"compare-row-container"}).inject(r),s=t.left,l=t.right,c=s.title+" "+s.revision,d=l.title+" "+l.revision;e.createElement("div",{html:c+a.anchor_with+d}).inject(o);var u=[];u.push({physicalid:s.physicalid,label:c},{physicalid:l.physicalid,label:d}),new i({label:a.compare,emphasize:"primary",onClick:function(){n.launchCompare(u)}}).inject(o)}),t&&t.unchanged&&n._createViewRowDispSection({type:"pilotingDisciplines",items:t.unchanged,value:a.label_unchanged,container:r}),t&&t.newlyDefined&&n._createViewRowDispSection({type:"pilotingDisciplines",items:t.newlyDefined,value:a.label_newlyDefined,container:r}),t&&t.previouslyDefined&&n._createViewRowDispSection({type:"pilotingDisciplines",items:t.previouslyDefined,value:a.label_previouslyDefined,container:r}),o;r.innerHTML=a.label_none},l.prototype._createPropSolnCompareSection=function(t){var n=this,o=[],r=e.createElement("div",{class:"compare-item-container"}),s=e.createElement("div",{class:"compare-options-subheader"}).inject(r);e.createElement("div",{html:a.label_proposed_solution}).inject(s);var l=e.createElement("div",{class:"compare-item-subcontainer"}).inject(r);if(t){if(t&&t.compare){var c=e.createElement("div",{class:"compare-row-container"}).inject(l),d=e.createElement("div",{class:"solns-container"}).inject(c);t.compare.forEach(function(t){var i=t.title+" "+t.revision;e.createElement("div",{html:i}).inject(d),o.push({physicalid:t.physicalid,label:i})})}return t&&t.unchanged&&(n._createViewRowDispSection({type:"proposedSolutions",items:t.unchanged,value:a.label_unchanged,container:l}),t.unchanged.forEach(function(e){o.push({physicalid:e.physicalid,label:e.title+" "+e.revision})})),t&&t.newlyDefined&&(n._createViewRowDispSection({type:"proposedSolutions",items:t.newlyDefined,value:a.label_newlyDefined,container:l}),t.newlyDefined.forEach(function(e){o.push({physicalid:e.physicalid,label:e.title+" "+e.revision})})),t&&t.previouslyDefined&&(n._createViewRowDispSection({type:"proposedSolutions",items:t.previouslyDefined,value:a.label_previouslyDefined,container:l}),t.previouslyDefined.forEach(function(e){o.push({physicalid:e.physicalid,label:e.title+" "+e.revision})})),o&&o.length>1&&new i({label:a.compare_all,emphasize:"primary",onClick:function(){n.launchCompare(o)}}).inject(s),r}l.innerHTML=a.label_none},l.prototype._createViewRowDispSection=function(t){var i=e.createElement("div",{class:"info-row-container"}).inject(t.container);e.createElement("div",{html:"<b><em>"+t.value+"</em></b>"}).inject(i);var n=e.createElement("div",{class:"info-row-container"}).inject(i),o=e.createElement("div").inject(n);t.items.forEach(function(t){e.createElement("div",{html:t.title+" "+t.revision}).inject(o)})},l.prototype.launchCompare=function(e){s.init("CompareCmd",e)},l}),define("DS/CATFLCockpitWidget/components/ArchitectureNumber/checkArchitectureNumberUnicity",["UWA/Core","DS/UIKIT/Mask","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/config.util","DS/Windows/Dialog","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/DataGridView/DataGridView","DS/Controls/Toggle","DS/Controls/ButtonGroup","DS/Controls/Button","DS/CollectionView/ResponsiveLargeTilesCollectionView","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/utils/checkArchitectureNumberUnicity.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,g,m,f){"use strict";o.getFullConfig();var h=function(e){this.refWithConfig=e.refWithConfig,this.nodesToCheck=e.nodesToCheck,this.dialog=null,this.gridView=null,this.gridViewAdditionalColumns=e.gridViewAdditionalColumns,this._createCheckANUnicityComponent()};return h.prototype._createModalArchitectureNumberUnicity=function(){var t=this,i=new r({title:f.action_architecture_number_unicity_effectivity,height:500,width:900,resizableFlag:!0,modalFlag:!0,immersiveFrame:widget.immersiveFrame,visibleFlag:!1});i.addEventListener("close",function(){i.destroy(),t.gridView&&t.gridView.destroy()});var n=e.createElement("div",{class:"container-unicity-AN"});return i.elements._contentDiv.appendChild(n),i},h.prototype._displayModalArchitectureNumberUnicity=function(){this.dialog&&!this.dialog.visibleFlag&&(this.dialog.visibleFlag=!0)},h.prototype._createCheckANUnicityComponent=function(){var e=this;g.getConfigContextInfo([e.refWithConfig.options.physicalid]).then(function(t){t?t.contextInfo&&t.contextInfo.length>0?(e.dialog=e._createModalArchitectureNumberUnicity(),t.contextInfo.length>1?(e._displayModalArchitectureNumberUnicity(),e._manageComponentForMoreThanOneModel(t)):e._manageComponentForOneModel(t)):i.alertMessage("error",null,f.error_no_model_attached):i.alertMessage("error",null,f.error_info_models)})},h.prototype._manageComponentForOneModel=function(e){var n=this,o=e.contextInfo[0].content&&e.contextInfo[0].content.results&&e.contextInfo[0].content.results.length>0?e.contextInfo[0].content.results[0]:null,r="",s="";o.data&&o.data.length>0&&o.data[0]&&o.data[0].value&&o.data[0].value.length>0&&o.data[0].value[0]&&"Marketing Name"==o.data[0].name&&(s=o.data[0].value[0]),o.basicData.forEach((e,t)=>{"name"===e.name&&e.value&&e.value.length>0&&e.value[0]&&(r=e.value[0])});var a={physicalid:o.physicalID,name:r,title:s};t.mask(n.dialog.elements._contentDiv,f.msg_loading),n._manageCheckANUnicityForModel(a).then(function(){t.unmask(n.dialog.elements._contentDiv)}).catch(function(e){switch(t.unmask(n.dialog.elements._contentDiv),n.dialog.close(),e.message){case"No_ModelVersions":i.alertMessage("error",null,f.replace(f.msg_no_modelVersions,{modelName:a.title}));break;default:i.alertMessage("error",null,f.error_check_an_services_failed)}})},h.prototype._manageComponentForMoreThanOneModel=function(e){var n=this;n.tilecollectionOfModels=n.displayModelListChoice(e.contextInfo,n.dialog.elements._contentDiv.getElementsByClassName("container-unicity-AN")[0]),n.tilecollectionOfModels.onSelectionAdd(function(){n.dialog.buttons.Ok.disabled=!1}),n.dialog.title=f.action_architecture_number_unicity_effectivity+" - "+n.refWithConfig.options.label+" - "+f.label_select_model,n.dialog.buttons={Ok:new u({label:f.label_next,emphasize:"primary",onClick:function(){if(n.tilecollectionOfModels&&n.tilecollectionOfModels.TreedocModel&&n.tilecollectionOfModels.TreedocModel.getSelectedNodes().length>0){t.mask(n.dialog.elements._contentDiv,f.msg_loading),n.dialog.buttons.Ok.disabled=!0;var o=n.tilecollectionOfModels.TreedocModel.getSelectedNodes()[0].options.dataModel;n._manageCheckANUnicityForModel(o).then(function(){n.dialog.buttons.Reset=new u({label:f.action_previous,emphasize:"secondary",onClick:function(){n._manageComponentForMoreThanOneModel(e)}}),n.dialog._applyButtons(),t.unmask(n.dialog.elements._contentDiv)}).catch(function(e){switch(t.unmask(n.dialog.elements._contentDiv),e.message){case"No_ModelVersions":i.alertMessage("error",null,f.replace(f.msg_no_modelVersions,{modelName:o.title})),n.tilecollectionOfModels.TreedocModel.unselectAll();break;default:i.alertMessage("error",null,f.error_check_an_services_failed),n.dialog.close()}})}},disabled:!0}),Cancel:new u({emphasize:"secondary",onClick:function(){n.dialog.close()}})}},h.prototype.displayDuplicatedArchitectureNumbers=function(t,i,n){var o=[{text:f.label_title,dataIndex:"tree",editableFlag:!1,sortableFlag:!0,alwaysVisibleFlag:!0,pinned:"left"},{text:f.label_an_valid,dataIndex:"isANValid",typeRepresentation:"boolean",width:80,getCellClassName:function(e){return e&&e.nodeModel?!0===e.nodeModel.options.grid.isANValid?"sax-is-valid-AN-true":"sax-is-valid-AN-false":null},alwaysVisibleFlag:!0},{text:f.label_intersection_effectivity,dataIndex:"intersectionEffectivity",typeRepresentation:"string",alwaysVisibleFlag:!0},{text:f.label_current_evolution,dataIndex:"effCurrentEvol",alwaysVisibleFlag:!0,sortableFlag:!1,editableFlag:!1}];if(n)for(var r in n)n[r].index?o.splice(n[r].index,0,n[r]):o.push(n[r]);var c=new l({identifier:"grid-view-unicity-AN-effectivity",height:"inherit",treeDocument:new s({useAsyncPreExpand:!0}),columns:o,rowSelection:"none",defaultColumnDef:{width:"auto"},onContextualEvent:function(e){var t=[];return e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e,{insertRow:!1,expandCollapse:!0,pin:!0,firstColumnsVisibility:!1,columnsManagement:!1})),t}});c.treeDocument.setFilterModel({label:{filterId:"stringRegexp"},isANValid:{filterId:"set",filterModel:[]},intersectionEffectivity:{filterId:"stringRegexp"}}),c.treeDocument.empty();var d=[];return Object.values(t)&&Object.values(t).length>0&&Object.values(t).forEach((e,t)=>{d=d.concat(Object.keys(e))}),m.updateDisplayedCurrentEvolutionForNodes(d).then(function(n){var o=n;for(var r in i.appendChild(c.getContent()),c.treeDocument.prepareUpdate(),t){var s=new a({label:r,icons:["progress-3"]});for(var l in t[r]){var d={isANValid:!(t[r][l].intersectionEffectivity.length>0),intersectionEffectivity:t[r][l].intersectionEffectivity.map(function(e){return e.displayValue+"-"+e.revision}).join(","),effCurrentEvol:o[l]};d=e.merge(d,t[r][l].nodeInstance.options.grid);var u=new a({label:t[r][l].nodeInstance.options.label,icons:t[r][l].nodeInstance.options.icons,grid:d});s.addChild(u)}c.treeDocument.addRoot(s)}return c.treeDocument.expandAll(),c.treeDocument.pushUpdate(),c})},h.prototype._createMessageContentInDialog=function(t){var i=e.createElement("div",{class:"dialogMessage",html:t});this.dialog.elements._contentDiv.getElementsByClassName("container-unicity-AN")[0].empty(),this.dialog.elements._contentDiv.getElementsByClassName("container-unicity-AN")[0].appendChild(i)},h.prototype._manageCheckANUnicityForModel=function(e){var t=this;return m.checkArchitectureNumberUnicityOnEffectivity(t.nodesToCheck,e).then(function(i){if(t._displayModalArchitectureNumberUnicity(),t.dialog.title=f.action_architecture_number_unicity_effectivity+" - "+t.refWithConfig.options.label+" - "+e.title,0!==Object.keys(i).length)return t.dialog.buttons={SaveAll:new u({label:f.action_export,emphasize:"primary",onClick:function(){t.exportCSV(e)}}),Close:new u({emphasize:"secondary",onClick:function(){t.dialog.close()}})},t.dialog._applyButtons(),t.displayDuplicatedArchitectureNumbers(i,t.dialog.elements._contentDiv.getElementsByClassName("container-unicity-AN")[0],t.gridViewAdditionalColumns).then(function(e){t.gridView=e});t._createMessageContentInDialog(f.msg_no_an_duplication),t.dialog.buttons={Close:new u({emphasize:"secondary",onClick:function(){t.dialog.close()}})}}).catch(function(i){switch(i.message){case"AN_not_assigned":return t._displayModalArchitectureNumberUnicity(),t.dialog.title=f.action_architecture_number_unicity_effectivity+" - "+e.title,t._createMessageContentInDialog(f.msg_an_not_assigned),t.dialog.buttons={Close:new u({emphasize:"secondary",onClick:function(){t.dialog.close()}})},Promise.resolve();default:return Promise.reject(i)}})},h.prototype.displayModelListChoice=function(e,t){var i=new s,n=new p({selectionBehavior:{canMultiSelect:!1,toggle:!1,unselectAllOnEmptyArea:!1}}).inject(t);return e.forEach((e,t)=>{var n=e.content&&e.content.results&&e.content.results.length>0?e.content.results[0]:null;if(n){var r="",s="",l="",c="",d=o.getServiceURL("3DSpace")+"/common/images/I_Model_Thumbnail.png";n.data&&n.data.length>0&&n.data[0]&&n.data[0].value&&n.data[0].value.length>0&&n.data[0].value[0]&&"Marketing Name"==n.data[0].name&&(r=n.data[0].value[0]),n.basicData.forEach((e,t)=>{"name"===e.name&&e.value&&e.value.length>0&&e.value[0]&&(s=e.value[0]),"owner"===e.name&&e.value&&e.value.length>0&&e.value[0]&&(l=e.value[0]),"current"===e.name&&e.value&&e.value.length>0&&e.value[0]&&(c=e.value[0])});var u=new a({label:r,thumbnail:n.preview_url&&""!==n.preview_url?n.preview_url:d,subLabel:s+" | "+l,description:f.label_maturity+" : "+c,dataModel:{physicalid:n.physicalID,name:s,title:r}});i.addRoot(u)}}),n.loadApplicativeModel(i),n},h.prototype.exportCSV=function(e){var t=this.gridView.treeDocument,n=[{text:f.label_arch_no,dataIndex:"architectureNo"}];this.gridView.columns.forEach((e,t)=>{n.push({text:e.textExport?e.textExport:e.text,dataIndex:e.dataIndex})});var r=new l({treeDocument:new s({useAsyncPreExpand:!0}),columns:n,defaultColumnDef:{width:"auto"}});r.treeDocument.empty(),r.treeDocument.prepareUpdate(),t&&t.getChildren()&&t.getChildren().forEach((e,t)=>{var i=new a({label:"",grid:{architectureNo:e.options.label}});r.treeDocument.addChild(i),e.getChildren().forEach((e,t)=>{var i=new a({label:e.options.label,grid:e.options.grid});r.treeDocument.addChild(i)})}),r.treeDocument.expandAll(),r.treeDocument.pushUpdate();var c=r.getAsCSV(),d=this.refWithConfig.options.label+"_"+e.title+"_"+f.label_an_unicity_on_effectivity_filename+".csv",u=new Date,p=o.getUser("isFullName"),g=f.label_none;widget.getValue("ngFilter")?g=JSON.parse(widget.getValue("ngFilter")).filterTitle:widget.getValue("currentConfig")&&(g=widget.getValue("currentConfig").modelVersion.name+" "+widget.getValue("currentConfig").modelVersion.revision+" "+widget.getValue("currentConfig").pc.label),c=f.action_architecture_number_unicity_effectivity+"\n"+f.label_filename+","+d+"\n"+f.label_export_datetime_utcformat+","+u+"\n"+f.label_exported_by+","+p+"\n"+f.label_applied_product_configuration+","+g+"\n\n\n"+c,i.downloadFile(d,c,!0),i.alertMessage("success",null,f.msg_an_unicity_on_effectivity_export_success)},h}),define("DS/CATFLCockpitWidget/components/WIWItemCreationModal/WIWItemCreationModalView",["UWA/Core","UWA/Class/View","DS/Handlebars/Handlebars","DS/UIKIT/Spinner","DS/UIKIT/Input/Text","DS/UIKIT/Scroller","DS/UIKIT/Tooltip","DS/Controls/LineEditor","DS/WUXAutoComplete/AutoComplete","DS/Controls/Toggle","DS/UIKIT/Mask","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/architectureNumber.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,g,m){"use strict";return t.extend({name:"WIWItemCreationModalView",tagName:"div",collection:null,toupdate:null,spinner:null,init:function(t){t=e.clone(t||{},!1),this._parent(t),this.collection=t.collection,this.action=t.collection.winInfo.action},setCollection:function(e){return this.collection=e,this.action=e.winInfo.action,this},createTableComponent:function(t,i,n){var o=e.createElement(t,n);return o.inject(i),o},createTableHeaderView:function(t,i,n){var o=this,r=null,s=e.createElement("tr"),a=o.createTableComponent("th",s,{status:"ok",class:"archNo-th-checkbox"});(r=new c({type:"checkbox",value:0,checkFlag:!0})).addEventListener("change",function(e){o.toggleAllEvent(e,this,o.container)}),r.inject(a);o.createTableComponent("th",s,{html:"#"});t.forEach(function(e){var t={html:i[e].label};i[e].architectureIdColumn&&(t.class="archidcolumn"),o.createTableComponent("th",s,t)}),this.collection.showRowLevelRecomputation&&o.createTableComponent("th",s,{styles:{"background-color":"#E2E4E3"}}).appendText(m.label_reEvaluate_ArchNo),n>=1&&o.createTableComponent("th",s,{html:m.arch_no_header});let l=o.options.cfgCtxInfo;return l&&(l.bCopyEff||l.bApplyConfig)&&o.createTableComponent("th",s,{html:m.label_apply_evolution}),s},createMetaDataOfRow:function(e){var t={};return t["data-id"]=e.referenceID,t["data-instance"]=e.instanceID,e.logicalRefType&&(t["data-type"]=e.logicalRefType),t.addRefRef=e.addRefRef,t},createTableBodyView:function(t,i,n,o,r){let d,u,p=this,f=null,h=!0,v=p.options.cfgCtxInfo;for(let C=0;C<o.length;C++){h=!0!==o[C].forbidSetAN;let b=p.createMetaDataOfRow(o[C]);b.class="item-row";let y=p.createTableComponent("tr",t.getElement(".itemDetails"),b),_="",D="";if(h){let e=p.createTableComponent("td",y,{status:"ok",class:"archNo-td-checkbox",styles:{"background-color":"#D5E8F2"}});(f=new c({type:"checkbox",value:0,checkFlag:!0})).addEventListener("buttonclick",function(e){p.toggleEvent(e,this,p.container)}),f.inject(e)}else{let t=p.createTableComponent("td",y,{class:"iconColor",styles:{color:"#EA4F37"}});e.createElement("span",{class:"fonticon fonticon-status-ko"}).inject(t);let i="";o[C].forbidSetANErrorMessages.forEach(function(e){i=i+e+"<br><br>"}),new s({target:t,body:i})}if(h){if(p.createTableComponent("td",y,{html:C+1,editable:!1,styles:{"background-color":"#D5E8F2"}}),i.forEach(function(e){let t,i,r=n[e];if(u={id:r.key,name:r.label,architectureidcolumn:void 0!==r.architectureIdColumn&&r.architectureIdColumn,required:r.required,editable:r.editable,styles:{"background-color":"#D5E8F2"}},d=p.createTableComponent("td",y,u),r.editable)if(d.setAttribute("type","lineEditor"),"enum"===r.format){let n=r.range,s=r.rangeLabel,a=r.rangeTooltip,c="",u=[];c=""!==o[C][e]?o[C][e]:r.defaultValue?r.defaultValue:"";for(let e=0;e<n.length;e++)u.push({label:s?s[e]:n[e],value:n[e],description:a&&a[e]?a[e]:null});(t=new l({elementsTree:u,multiSearchMode:!1,allowFreeInputFlag:!1,allowResetToUndefinedByUIFlag:!1})).value=c,t.inject(d),i=t.getContent().getElement("input"),t.addEventListener("change",g.updateArchitectureID.bind(p,i,y,!1))}else(t=new a({className:"form-control",placeholder:"Enter "+n[e].label,attributes:{autocomplete:"off",name:r.label},value:o[C][e],requiredFlag:r.required})).inject(d),(i=t._myInput).addEventListener("keyup",g.updateArchitectureID.bind(p,i,y,!1)),i.addEventListener("keydown",p.nextEditableCell);else d.setHTML(o[C][e]);n[e].architectureIdColumn&&(D="enum"===r.format?t.value?t.value:"":o[C][e],_+=D)}),p.collection.showRowLevelRecomputation&&(u={id:"ANRecompute",architectureidcolumn:!1,required:!1,editable:!1,styles:{"background-color":"#D5E8F2",cursor:"pointer"}},d=p.createTableComponent("td",y,u),e.createElement("span",{class:"fonticon fonticon-compute"}).inject(d),d.addEventListener("click",function(e){"ok"===e.currentTarget.closest("tr").getChildren()[0].getAttribute("status")&&g.executeRecompute({isWIWcall:!0,an_action:p.collection.AN_ACTION,rows:[e.currentTarget.closest("tr")],SelectionContext:p.collection.SelectionContext})})),r>=1){let e={class:"archidcell",html:_,styles:{"background-color":"#D5E8F2"}};p.createTableComponent("td",y,e)}}else if(p.createTableComponent("td",y,{html:C+1,editable:!1,styles:{"background-color":"#f9f9f9"}}),i.forEach(function(e){let t=n[e],i={id:t.key,name:t.label,architectureidcolumn:void 0!==t.architectureIdColumn&&t.architectureIdColumn,required:t.required,editable:!1,styles:{"background-color":"#f9f9f9"}};p.createTableComponent("td",y,i).setHTML(o[C][e])}),p.collection.showRowLevelRecomputation&&(u={id:"ANRecompute",architectureidcolumn:!1,required:!1,editable:!1,styles:{"background-color":"#f9f9f9"}},d=p.createTableComponent("td",y,u)),r>=1){let e={class:"archidcell",styles:{"background-color":"#f9f9f9"}};p.createTableComponent("td",y,e)}if(v&&(v.bCopyEff||v.bApplyConfig)){let e=h?"#D5E8F2":"#f9f9f9",t={id:"applicableEvolution",name:m.label_apply_evolution,architectureidcolumn:!1,required:!1,editable:!1,styles:{"background-color":e}};p.createTableComponent("td",y,t).setHTML(o[C].applicableEvolution)}}},toggleAllEvent:function(e,t,i){var n=t.getParent(),o=n.getAttribute("status"),r=i.getElements(".archNo-td-checkbox"),s=!0;"ok"===o?(s=!1,n.setAttribute("status","ko")):n.setAttribute("status","ok");for(var a=0;a<r.length;a++){r[a].getParent().getChildren().forEach(function(e,t){var i=e.getElement(".wux-controls-checkbox"),n=e.getElement(".wux-ui-fa.wux-icon");s?(0==t&&(e.setAttribute("status","ok"),i.dsModel.checkFlag=!0,n.addClassName("wux-ui-fa-check")),e.setStyle("background-color","#D5E8F2"),"lineEditor"===e.getAttribute("type")&&(e.getChildren()[0].getChildren()[0].readOnly=!1)):(0==t&&(e.setAttribute("status","ko"),i.dsModel.checkFlag=!1,n.removeClassName("wux-ui-fa-check")),e.setStyle("background-color","hsl(0, 0%, 98%)"),"lineEditor"===e.getAttribute("type")&&(e.getChildren()[0].getChildren()[0].readOnly=!0))})}},toggleEvent:function(e,t,i){var n=t.getParent(),o=n.getAttribute("status");"ok"===o?(n.getParent().getChildren().forEach(function(e){e.setStyle("background-color","hsl(0, 0%, 98%)"),"lineEditor"===e.getAttribute("type")&&(e.getChildren()[0].getChildren()[0].readOnly=!0)}),n.setAttribute("status","ko")):"ko"===o&&(n.getParent().getChildren().forEach(function(e){e.setStyle("background-color","#D5E8F2"),"lineEditor"===e.getAttribute("type")&&(e.getChildren()[0].getChildren()[0].readOnly=!1)}),n.setAttribute("status","ok"));for(var r=i.getElements(".archNo-td-checkbox"),s=i.getElements(".archNo-th-checkbox")[0].getParent().getChildren()[0],a=s.getElement(".wux-controls-checkbox"),l=s.getElement(".wux-ui-fa.wux-icon"),c=!0,d=0,u=0;u<r.length;u++)"ko"===r[u].getAttribute("status")&&c?c=!1:"ok"===r[u].getAttribute("status")&&d++;c?(a.dsModel.checkFlag=!0,l.removeClassName("wux-toggle-mixed-icon"),l.addClassName("wux-ui-fa-check")):!c&&d>0?(l.removeClassName("wux-ui-fa-check"),l.addClassName("wux-toggle-mixed-icon")):0===d&&(a.dsModel.checkFlag=!1,l.removeClassName("wux-toggle-mixed-icon"))},render:function(e){this.container=e;let t=this.collection.columnNames,i=this.collection.columns,n=this.collection.rows;this.createTableComponent("sup",e.getElement(".identifier-msg"),{html:m.arch_no_identifier_message});let o,r=0;t.forEach(function(e,t){i[e].architectureIdColumn&&(r++,o||(o=t))});let s=this.options.cfgCtxInfo;if(s&&(s.bCopyEff||s.bApplyConfig)&&s.effectivityResponse){let e={};for(let t in s.effectivityResponse){let i=s.effectivityResponse[t];if(i&&"YES"===i.hasEffectivity){let n=i.content&&i.content.Evolution;e[t]=n.Current.replace(/(\r\n|\n|\r)/gm," ")}}n.forEach(t=>{let i=Array.isArray(t.instanceID)?t.instanceID:[t.instanceID];t.evolutionEffectivity="";let n=[];i.forEach(i=>{let o=e[i];o&&n.indexOf(o)<0&&(t.evolutionEffectivity+=o,n.push(o))}),s.bCopyEff&&(t.applicableEvolution=t.evolutionEffectivity)})}this.createTableHeaderView(t,i,r).inject(e.getElement(".columnHeader")),this.createTableBodyView(e,t,i,n,r)},nextEditableCell:function(e){if(e.stopPropagation(),9==e.which){e.preventDefault();var t=e.currentTarget.getParent().getParent(),i=t.cellIndex,n=t.getParent().getChildren(),o=n.length,r=!1;if(i<o-1)for(var s=i+1;s<o;s++)if("true"==n[s].getAttribute("editable")){n[s].getChildren()[0].getChildren()[0].focus(),r=!0;break}if(!r){var a=e.currentTarget.getParent().getParent().getParent().nextSibling;a&&a.getElementsByClassName("wux-controls-abstract wux-controls-lineeditor")[0].getChildren()[0].focus()}}},applyCopyEffectivity:function(){let e=this.container.getElements(".item-row"),t=this.collection.rows;e.forEach((e,i)=>{e.getElement("#applicableEvolution").setText(t[i].evolutionEffectivity)})},applySelectedConfiguration:function(e){let t=this.container.getElements(".item-row"),i=e.modelVersionName+": Model Version "+e.modelVersionName+"-"+e.revision+"<";t.forEach(e=>{e.getElement("#applicableEvolution").setText(i)})},resetApplicableEvolution:function(){this.container.getElements(".item-row").forEach(e=>{e.getElement("#applicableEvolution").setText("")})}})}),define("DS/CATFLCockpitWidget/components/DisciplineIterations/consolidateDefinition",["UWA/Core","DS/UIKIT/Mask","DS/Windows/Dialog","DS/Controls/Button","DS/Controls/ButtonGroup","DS/Controls/Toggle","DS/DataGridView/DataGridView","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/implementlink.service","DS/CATFLCockpitWidget/model/CATFLCockpitTreeDocument","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,g){"use strict";var m=function(e){this.options=e};return m.prototype.render=function(){var e=this,t=e.getConsolidateOptionsContainer();e.dialog=new i({title:g.header_consolidate_log_defn,content:t,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new n({label:g.action_consolidate,emphasize:"primary",onClick:e._performCollectDefinitionOperation.bind(e)}),Cancel:new n({emphasize:"secondary",onClick:function(){e.dialog.close()}})}}),e.dialog.addEventListener("close",function(){e.dialog.destroy()})},m.prototype.getConsolidateOptionsContainer=function(){var t=this,i=e.createElement("div",{class:"consolidate-options-container"});return t.optsButtonGroup=new o({type:"checkbox"}),t.optsButtonGroup.addChild(new r({type:"checkbox",label:g.label_copy_spaces,checkFlag:!0})),t.optsButtonGroup.addChild(new r({type:"checkbox",label:g.label_remove_spaces,checkFlag:!0})),t.optsButtonGroup.addChild(new r({type:"checkbox",label:g.label_freeze_log_ref,checkFlag:!0})),t.optsButtonGroup.addEventListener("change",function(e){var i=t.optsButtonGroup._getButtonList(),n=t.dialog.buttons.Ok,o=i.every(function(e){return!e.checkFlag});n.disabled=!!o}),t.optsButtonGroup.inject(i),i},m.prototype._performCollectDefinitionOperation=function(){var n=this;if(n.processing)a.alertMessage("info",null,g.info_process_in_progress);else{n.processing=!0,t.mask(n.dialog.content,g.msg_processing);var o={},r=[],s=n.options.selectedNodes;s.forEach(function(e){o[e.options.physicalid]=e,r.push(e.options.instance.physicalid)});var u=d.confAllImplPathsOnNodes(s,!1,!1),p={copyAssignedDesignSpaces:n.optsButtonGroup.getButton(0).checkFlag,removePreviouslyAssignedDesignSpaces:n.optsButtonGroup.getButton(1).checkFlag,freezeLogicalReference:n.optsButtonGroup.getButton(2).checkFlag},m={consolidateLogicalDefinition:p,instanceIds:r,occurrenceInfo:u.payload};c.consolidateLogicalDefinition(m).then(function(t){l.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-nodes-by-id",data:{arrayOfPID:Object.keys(o),tagAsRecentlyAuthored:!0}}),l.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-refLinks-by-id",data:Object.values(o)});var r=t.rowsData,s=[],a=0;for(var c in r){var d=r[c],u={},m=o[d.referenceId];u.title={value:m.options.label,tooltip:m.options.label},u.revision={value:m.options.grid.revision,tooltip:m.options.grid.revision},u.maturity={value:d.maturity,tooltip:d.maturity},u.instTitle={value:d.instanceTitle,tooltip:d.instanceTitle};var f={value:"",tooltip:""};if(d.status)if("processed"===d.status.toLowerCase())f.value="check",a++;else if("error"===d.status.toLowerCase()?f.value="wrong":f.value="status-noway",d.errors&&d.errors.length>0){var h=d.errors.join("\r\n");f.tooltip=h}u.status=f;var v={frozen:"",inwork:"",tooltip:""};d.pilotingDisciplines&&(v.frozen=d.pilotingDisciplines.frozen.join("\r\n"),v.inwork=d.pilotingDisciplines.inwork.join("\r\n")),u.pilotingDisc=v;var C={value:"",tooltip:""};p.removePreviouslyAssignedDesignSpaces&&(d.spacesRemoved&&(C.value=d.spacesRemoved.join("\r\n")),u.removedSpaces=C);var b={value:"",tooltip:""};p.copyAssignedDesignSpaces&&(d.spacesAdded&&(b.value=d.spacesAdded.join("\r\n")),u.addedSpaces=b);var y={value:"",tooltip:""};p.freezeLogicalReference&&(d.movedToFrozen&&("moved"===d.movedToFrozen.value.toLowerCase()?y.value="check":"notmoved"===d.movedToFrozen.value.toLowerCase()?y.value="wrong":"moverestrictedfromopenness"===d.movedToFrozen.value.toLowerCase()?y.value="status-ko":y.value="status-noway",y.tooltip=d.movedToFrozen.tooltip.join()),u.freezeLR=y),s.push(u)}var _=e.createElement("div",{class:"report-consolidation-container"});e.createElement("div",{html:"<em>"+g.replace(g.msg_consolidation_processed_report,{countOk:a,totalCount:s.length})+"<em>"}).inject(_);var D=e.createElement("div",{class:"report-consolidation-dgv"}).inject(_),S=(n._createDataGridView({items:s,consolidateOptions:p}).inject(D),new i({title:g.header_summary_consolidate_log_defn,height:500,width:1100,minHeight:500,minWidth:1100,content:_,modalFlag:!0,resizableFlag:!0,immersiveFrame:widget.immersiveFrame}));S.addEventListener("close",function(){S.destroy()})}).catch(function(e){a.displayError(e,null,null,g.error_consolidate_definition)}).finally(function(){n.processing=!1,t.unmask(n.dialog.content),n.dialog.close()})}},m.prototype._createDataGridView=function(e){var t=new u({useAsyncPreExpand:!0});t.prepareUpdate();var i=e.consolidateOptions;e.items.forEach(function(e){var n={label:e.title.value,grid:{revision:e.revision.value,maturity:e.maturity.value,instanceTitle:e.instTitle.value,status:e.status.value,pilotingDisc_frozen:e.pilotingDisc.frozen,pilotingDisc_inwork:e.pilotingDisc.inwork},item:e,editableFlag:!1};i.removePreviouslyAssignedDesignSpaces&&(n.grid.removedSpaces=e.removedSpaces.value),i.copyAssignedDesignSpaces&&(n.grid.addedSpaces=e.addedSpaces.value),i.freezeLogicalReference&&(n.grid.freezeLR=e.freezeLR.value),t.addChild(new p(n))}),t.setFilterModel({label:{filterId:"stringRegexp"},revision:{filterId:"stringRegexp"},maturity:{filterId:"stringRegexp"},instanceTitle:{filterId:"stringRegexp"},pilotingDisc_frozen:{filterId:"stringRegexp"},pilotingDisc_inwork:{filterId:"stringRegexp"},addedSpaces:{filterId:"stringRegexp"},removedSpaces:{filterId:"stringRegexp"}}),t.pushUpdate();var n=new s({identifier:"SystemArchitectureRelease_ConsolidateDefnReport",height:"inherit",treeDocument:t,columns:this._getDataGridViewColumns(i),rowSelection:"none",defaultColumnDef:{typeRepresentation:"string",width:"auto"},sortModel:[{dataIndex:"tree",sort:"asc"}],getCellTooltip:function(e){let t;return e.nodeModel&&(t=n.getColumnOrGroup(e.columnID)),!t||"status"!==t.dataIndex&&"freezeLR"!==t.dataIndex?n.getCellDefaultTooltip(e):{shortHelp:e.nodeModel.options.item[t.dataIndex].tooltip,updateModel:!1}},onContextualEvent:function(){return!1}});return n.getContent()},m.prototype._getDataGridViewColumns=function(e){var t=[{text:g.label_title,dataIndex:"tree",alwaysVisibleFlag:!0,pinned:"left"},{text:g.label_revision,dataIndex:"revision",width:80,pinned:"left"},{text:g.label_maturity,dataIndex:"maturity",width:120,pinned:"left"},{text:g.label_instance_title,dataIndex:"instanceTitle",pinned:"left"},{text:g.label_piloting_disciplines,dataIndex:"pilotingDisc",children:[{dataIndex:"pilotingDisc_inwork",text:g.label_inwork,typeRepresentation:"textBlock",autoRowHeightFlag:!0},{dataIndex:"pilotingDisc_frozen",text:g.label_frozen,typeRepresentation:"textBlock",autoRowHeightFlag:!0,width:140}]},{text:g.label_consolidation_status,dataIndex:"status",alignment:"center",typeRepresentation:"icon",width:80}];if(e.copyAssignedDesignSpaces||e.removePreviouslyAssignedDesignSpaces){var i={text:g.label_design_spaces,dataIndex:"designSpaces",children:[]};e.copyAssignedDesignSpaces&&i.children.push({text:g.label_added,dataIndex:"addedSpaces",typeRepresentation:"textBlock",autoRowHeightFlag:!0}),e.removePreviouslyAssignedDesignSpaces&&i.children.push({text:g.label_removed,dataIndex:"removedSpaces",typeRepresentation:"textBlock",autoRowHeightFlag:!0}),t.push(i)}return e.freezeLogicalReference&&t.push({text:g.label_status_freeze,dataIndex:"freezeLR",alignment:"center",typeRepresentation:"icon",width:100}),t},m}),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.configure.expand",["UWA/Core","DS/UIKIT/Mask","DS/Windows/Dialog","DS/Controls/Button","DS/Controls/ButtonGroup","DS/Controls/Toggle","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/implementlink.service","DS/CATFLCockpitWidget/model/CATFLCockpitTreeDocument","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","DS/CATFLCockpitWidget/components/PropertiesPanel/propertiespanel.controller","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,g,m){"use strict";var f=JSON.parse(g),h=function(e){this.options=e};return h.prototype.render=function(e){var t=this,o=t.getExpandOptionsContainer();t.dialog=new i({title:m.action_configure_expand,content:o,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new n({label:m.apply_button,emphasize:"primary",disabled:!0,onClick:t._applyConfiguredExpandOperation.bind(t,e)}),Cancel:new n({emphasize:"secondary",onClick:function(){t.dialog.close()}})}}),t.dialog.addEventListener("close",function(){t.dialog.destroy()})},h.prototype.getExpandOptionsContainer=function(){let t=this,i=widget.getValue("configurable_expand"),n=!1;i||(n=!0,i={});let a=widget.getValue(f.componentView)!==f.structuredView,l=e.createElement("div",{class:"configure-expand-options-container"});return t.optsButtonGroup=new o({type:"checkbox"}),t.optsButtonGroup.addChild(new r({type:"checkbox",label:m.label_implementing,value:"implementing",checkFlag:i.implementing||n,disabled:a})),t.optsButtonGroup.addChild(new r({type:"checkbox",label:m.label_is_implementing,value:"isImplementing",checkFlag:i.isImplementing||n,disabled:a})),t.optsButtonGroup.addChild(new r({type:"checkbox",label:m.label_implemented_by,value:"implementedBy",checkFlag:i.implementedBy||n,disabled:a})),t.optsButtonGroup.addChild(new r({type:"checkbox",label:m.label_is_implemented_by,value:"isImplementedBy",checkFlag:i.isImplementedBy||n,disabled:a})),t.optsButtonGroup.addChild(new r({type:"checkbox",label:m.label_proposed_solution,value:"proposedSolution",checkFlag:i.proposedSolution||n})),t.optsButtonGroup.addChild(new r({type:"checkbox",label:m.label_spec_documents,value:"specDocs",checkFlag:i.specDocs||n})),t.optsButtonGroup.addEventListener("change",function(e){let n,o=Object.keys(i)||[],r=t.optsButtonGroup.value,a=!1;r.indexOf("isImplementing")>=0&&r.indexOf("implementing")<0&&(t.optsButtonGroup.getButtonFromValue("implementing").checkFlag=!0,a=!0),r.indexOf("isImplementedBy")>=0&&r.indexOf("implementedBy")<0&&(t.optsButtonGroup.getButtonFromValue("implementedBy").checkFlag=!0,a=!0),a&&(r=t.optsButtonGroup.value,s.alertMessage("warning",null,m.msg_config_exp_occLink_warning)),n=r.length==o.length&&r.every(function(e,t){return o.indexOf(e)>=0});var l=t.dialog.buttons.Ok;l.disabled=!!n}),t.optsButtonGroup.inject(l),l},h.prototype._applyConfiguredExpandOperation=function(e){let t={};this.optsButtonGroup.value.forEach(function(e){t[e]=!0}),widget.setValue("configurable_expand",t),Object.keys(t).length<6?e._actionsContainer.querySelector("#configure-expand").addClassName("active"):e._actionsContainer.querySelector("#configure-expand").removeClassName("active"),a.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-refresh"}),this.dialog.close()},h}),define("DS/CATFLCockpitWidget/components/CreateLogicalItemModal/logRef.createPanel.modalWindow",["UWA/Core","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/WUXAutoComplete/AutoComplete","DS/Controls/Button","DS/Controls/LineEditor","DS/Controls/SpinBox","DS/Controls/Toggle","DS/UIKIT/Mask","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.creation","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/refresh.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/thumbnail.service","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.attachment","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","text!DS/CATFLCockpitWidget/components/CreateLogicalItemModal/ModalCreationLogical.html"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,g,m,f,h,v,C,b,y,_,D){"use strict";var S=m.getFullConfig(),w=S.localStorageKeys,I=S.identifiers;return{createFieldRowDiv:function(t,i,n,o,r){var s=e.createElement("div",{class:t});i&&s.setStyles(i);var a=e.createElement("label",{html:n}),l=e.createElement("div",{class:"field-container"});return a.inject(l),l.inject(s),o.addClassName("elem-container"),o.inject(s),s},formatSubTypeList:function(e){if(this.logRefSubTypes=m.getFullConfig().logicalRefSubTypes,this.logRefSubTypes&&this.logRefSubTypes.length<1&&(this.showSubtype=!1),this.logRefSubTypesCurated=[],this.showSubtype&&e){var t=null,i=null,n=null;for(var t in e){n=!1;for(var o=0;o<this.logRefSubTypes.length;o++)if(t===(i=this.logRefSubTypes[o]).Name){this.logRefSubTypesCurated.push(i),n=!0;break}n||this.logRefSubTypesCurated.push({NLS:t,Name:t,Package:e[t],PackageName:e[t],Parent:I.type_act_logref})}this.logRefSubTypesCurated.sort(function(e,t){return e.NLS.toLowerCase()<t.NLS.toLowerCase()?1:e.NLS.toLowerCase()>t.NLS.toLowerCase()?-1:0}),this.logRefSubTypesCurated.sort(function(e,t){return e.PackageName.toLowerCase()<t.PackageName.toLowerCase()?1:e.PackageName.toLowerCase()>t.PackageName.toLowerCase()?-1:0}),this.logRefSubTypesCurated.reverse()}},createAutocomplete:function(){var e=null,t=null,i=null,s=new n({shouldBeSelected:function(e){return!e.options.isPackage}}),a=null;s.prepareUpdate();for(var l=null,c=0;c<this.logRefSubTypesCurated.length;c++)"True"!==(l=this.logRefSubTypesCurated[c]).Abstract&&(!(t=l.PackageName)||null!==e&&e===t||(null!==i&&(s.addRoot(i),i.expandAll()),i=new o({label:t,value:l.Package,isPackage:!0}),e=t),a=m.getServiceURL("3DSpace")+"/snresources/images/icons/small/"+l.IconName,i.addChild(new o({label:l.NLS,icons:[a],isPackage:!1,value:l.Name})));null!==i&&(s.addRoot(i),i.expandAll()),s.pushUpdate();var d=new r({elementsTree:s,multiSearchMode:!1,allowFreeInputFlag:!1,allowResetToUndefinedByUIFlag:!1});return d.getContent().addClassName("basicFieldAttribute"),d.addEventListener("change",this.manageEmptyField.bind(this,d,!0)),d.value=[localStorage.getItem("prevSelSubType")||I.type_act_logref],d},createCustomFields:function(t,i){var n,o,s,d=this,u=null;t.forEach(function(t){var p,g={};if(u=i[t],n=u.format,o=void 0!==u.editable&&!u.editable,p=null,s=null,null,"string"==n||"number"==n||"enum"==n||"boolean"==n){switch(n){case"string":(p=new a({placeholder:b.ph_title,value:void 0===u.value?void 0===u.defaultValue?"":u.defaultValue:u.value,disabled:o,selectAllOnFocus:!0,displayClearFieldButtonFlag:!0})).getContent().getElement("input").addClassName("customFieldAttribute"),g.type="textBox",g.required=u.required,p.addEventListener("change",d.manageEmptyField.bind(d,p,g.required));break;case"enum":var m=u.range,f=u.rangeLabel,h="";h=u.value?u.value:u.defaultValue?u.defaultValue:"";for(var v=[],C=0;C<m.length;C++)v.push({label:void 0!==f?f[C]:m[C],value:m[C]});(p=new r({elementsTree:v,multiSearchMode:!1,allowFreeInputFlag:!1,allowResetToUndefinedByUIFlag:!1,disabled:o})).value=h,g.type="dropDown",g.required=u.required,p.addEventListener("change",d.manageEmptyField.bind(d,p,g.required));break;case"number":h="";u.defaultValue&&(h=u.defaultValue),u.value&&(h=u.value),p=new l({value:h,maxValue:1e7,stepValue:1,disabled:o}),g.type="numberBox",g.required=u.required,p.addEventListener("change",d.manageEmptyField.bind(d,p,g.required));break;case"boolean":p=new c({type:"switch",disabled:o,checkFlag:void 0===u.value?void 0!==u.defaultValue&&u.defaultValue:u.value}),g.type="checkBox",g.required=u.required;break;default:return}s=e.createElement("div",{class:"custom-field-container"}),g.element=p,g.label=u.label,g.key=t,p.inject(s),p.getContent().addClassName("customFieldAttribute"),d.createFieldRowDiv("customFieldRow",null,u.label,s,null).inject(d.logRefCreateForm),d._inputElemList.push(g)}})},createFooter:function(){var e=null,t=null,i=null,n={};if(null===this.rootID)e=b.msg_create_and_open,t="btn-create-and-close";else if(this.isReplaceCall)e=b.msg_create_and_replace,t="btn-replace-and-close";else{e=b.action_create,i=b.msg_create_and_close,t="btn-create";var o=new s({label:i});o.getContent().classList.add("btn-create-and-close")}var r=new s({label:e});r.getContent().classList.add(t);var a=new s({label:b.action_close,onClick:function(e){document.getElementById("create-logicalref-immersiveFrame").destroy()}});return a.getContent().classList.add("btn-close"),n={Cancel:a,Ok:r},null!=i&&o&&(n.Apply=o),n},createTitleField:function(){var t,i=new a({placeholder:b.ph_title,selectAllOnFocus:!0,sizeInCharNumber:S.adminStatus.ReferenceTitleMaxLength||100,displayClearFieldButtonFlag:!0});i.getContent().getElement("input").addClassName("basicFieldAttribute"),t={type:"textBoxNameField",required:!1,element:i},this._inputElemList.push(t);var n=e.createElement("div",{class:"title-box"});i.inject(n),this.createFieldRowDiv("titleFieldRow",null,b.label_title,n,null).inject(this.logRefCreateForm)},createTypeField:function(){var t=this.createAutocomplete(),i={type:"dropDownTypeField",required:!1,element:t,label:b.label_type};this._inputElemList.push(i);var n=e.createElement("div",{class:"item-type-selector"});t.inject(n),this.createFieldRowDiv("typeFieldRow",null,b.label_type,n,null).inject(this.logRefCreateForm)},create:function(n,o,r,s,a,l,c){var d=this;d._inputElemList=[],d.showSubtype=a,d.isReplaceCall=s,d.modelEventsContentListView=h.getFLWebModelEventsObj("flcockpit-content-list-view"),d.parentID=o?o.options.physicalid:null,d.rootID=o?o.getRoot().options.physicalid:null,d.parentItem=o,o&&d.isReplaceCall&&(d.replaceRefId=o.getParent().options.physicalid,d.replaceInsId=o.options.instance.physicalid,d.replaceRootId=o.getRoot().options.physicalid);var u=d.createFooter(),p=new t({domId:"create-logicalref-immersiveFrame"});null!=n&&p.inject(n),d.logRefCreateForm=e.createElement("div",{class:"logRef-create-form"}),d.modal=new i({title:b.action_add_new,content:d.logRefCreateForm,domId:"create-logicalref-dialog",immersiveFrame:p,width:450,resizableFlag:!0,buttons:u,modalFlag:!0}),d.modal.close=function(){document.getElementById("create-logicalref-immersiveFrame").destroy()},d.createTitleField(),d.showSubtype&&(d.formatSubTypeList(l),d.createTypeField());var g=r.fieldNames,m=r.fields;for(var f in g&&d.createCustomFields(g,m),d.modal.buttons){var v=d.modal.buttons[f];null===d.rootID||d.isReplaceCall||v.getContent().hasClassName("btn-create")&&(v.onClick=function(){d._createReferenceItem(!1,c)}),d.isReplaceCall?v.getContent().hasClassName("btn-replace-and-close")&&(v.onClick=function(){d._createReferenceItem(!0,c)}):v.getContent().hasClassName("btn-create-and-close")&&(v.onClick=function(){d._createReferenceItem(!0,c)})}return d.modal},_createReferenceItem:function(e,t){for(var i,n,o,r,s=this,a={},l=0;l<s._inputElemList.length;l++)if("textBoxNameField"===(r=s._inputElemList[l]).type)i=r.element.value.trim();else if("dropDownTypeField"===r.type){if(!r.element.value||""==r.element.value)return g.alertMessage("error",null,b.req_field_error_header,b.replace(b.error_field_reqd,{field:r.label})),r.element.getContent().getElement("input").addClassName("error-empty-field"),void r.element.getContent().focus();n=r.element.value,localStorage.setItem("prevSelSubType",n)}else{if("checkBox"===r.type)o=r.element.checkFlag;else if(o=r.element.value,r.required&&(!o||""==r.element.value))return g.alertMessage("error",null,b.req_field_error_header,b.replace(b.error_field_reqd,{field:r.label})),r.element.getContent().getElement("input").addClassName("error-empty-field"),void r.element.getContent().focus();a[r.key]=o}d.mask(s.modal.elements._contentDiv,b.msg_creating),(s.isReplaceCall&&s.replaceRefId&&s.replaceInsId?p.replaceWithNewRef(s.replaceRefId,s.replaceInsId,i,n,a):null===s.rootID?u.createNewItemReference(i,n,a):u.createNewItemInstance(s.parentID,s.rootID,i,n,a)).then(function(i){if(d.unmask(s.modal.elements._contentDiv),null!==s.rootID||s.isReplaceCall)if(s.isReplaceCall&&s.replaceRootId)if(document.getElementById("create-logicalref-immersiveFrame").destroy(),200==i.status||i.member){var n=i.member?i.member[0]:null,o=[],r={};if(n){m.SAXStorage().setItem(w.recentlyAuthoredStructure+s.replaceRefId,Date.now());var a=s.parentItem.options.instance.physicalid;(u=t.getMappedNodesFromId(s.parentItem.options.physicalid))||(u=[selectedNode]);for(var l=u.length-1;l>=0;l--){var c=u[l];c.options.instance.physicalid===a&&(t.removeFromMappedNodes(c),c.removeChildren(),c.collapse(),c.updateOptions({hasBeenExpanded:!1,noIndexOrDBExpand:!1,dontExpandTwoLvl:!1,dontExpandAllLvl:!1,configContexts:void 0,physicalid:n.reference,instance:{physicalid:n.id},grid:{instanceName:n.name,physicalid:n.reference,hasEffectivity:void 0,configCtx:void 0}}),c.setRelationID(n.id),t.addToMappedNodes(c))}o.push(n.reference),r[n.id]=s.parentItem,h.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-nodes-by-id",data:{arrayOfPID:o,tagAsRecentlyAuthored:!0}}),h.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-inst-by-id",data:{instIdMap:r,bInstance:!0,bEffectivity:!0}})}g.alertMessage("success",null,"",b.msg_replace_success)}else g.alertMessage("error",null,"",i.message);else{var u;if(e&&document.getElementById("create-logicalref-immersiveFrame").destroy(),i&&i.member)(u=t.getMappedNodesFromId(s.parentItem.options.physicalid))||(u=[s.parentItem]),f.addChildrenToParent(t,u,i.member,!0)}else document.getElementById("create-logicalref-immersiveFrame").destroy(),h.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:i.id?i.id:i.physicalid}})},function(e){document.getElementById("create-logicalref-immersiveFrame").destroy(),g.displayError(e,null,null,b.error_create_item)})},manageEmptyField:function(e,t){t&&(e.value&&e.value.length>0?e.getContent().getElement("input").removeClassName("error-empty-field"):e.getContent().getElement("input").addClassName("error-empty-field"))}}}),define("DS/CATFLCockpitWidget/utils/DisplayConnectedDIFStructure.util",["DS/CATFLCockpitWidget/services/DisplayConnectedDIFStructure.service","DS/CATFLCockpitWidget/parser/index.parser","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.columns","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a){var l=new Map,c={},d=n.getFullConfig(),u={DisplayConnectedDIFStructure:function(t){return payload={"ds6w:type":["DIFView","DIFLayout","DIFSheet"]},r.getPredicateValues(payload).then(function(e){return c=e["ds6w:type"]}),e.GetConnectedDIFs(t).then(function(i){for(var n=[],r=0,s=0;s<t.length;s++)if(void 0!==i[t[s].options.physicalid].LAYOUT_OR_SHEET){for(var c=[],d=0;d<i[t[s].options.physicalid].LAYOUT_OR_SHEET.length;d++)n.push(i[t[s].options.physicalid].LAYOUT_OR_SHEET[d].physicalid),c.push(i[t[s].options.physicalid].LAYOUT_OR_SHEET[d].physicalid);l.set(t[s].options.physicalid,c)}else++r;if(0!==n.length)return e.GetExpandedDIFStructure(n).then(function(e){var i;i="string"==typeof e?JSON.parse(e):e;var{PathsIDWithLRef:n,mapDIFIdsAttr:s}=u._ExpandV2Parser(l,i);u._UpdateDIFOnNode(t,n,s),1===t.length?o.alertMessage("info",null,a.msg_diagrams_loaded_success_single):o.alertMessage("info",null,a.msg_diagrams_loading_success_multiple),r>0&&(1===r?o.alertMessage("warning",null,a.warn_DisplayConDIF_no_connected_diagram_single):o.alertMessage("warning",null,a.replace(a.warn_DisplayConDIF_no_connected_diagram_multiple,{count:r})))}).catch(function(e){e&&e.errorResp&&o.alertMessage("error",null,e.errorResp.message)});1===t.length?o.alertMessage("warning",null,a.warn_DisplayConDIF_emptyConDIF_single):o.alertMessage("warning",null,a.warn_DisplayConDIF_emptyConDIF_multiple)}).catch(function(e){e&&e.errorResp&&o.alertMessage("error",null,e.errorResp.message)})},_ExpandV2Parser:function(e,t){for(var i=[],n={},o=0;o<t.results.length;o++)void 0!==t.results[o].Path&&i.push(t.results[o].Path);for(o=0;o<i.length;o++)for(const[t,n]of e)for(var r=Array.isArray(n)?n:[n],s=0;s<r.length;s++)i[o].includes(r[s])&&i[o].unshift(t);for(o=0;o<t.results.length;o++)void 0!==t.results[o].resourceid&&(n[t.results[o].resourceid]=u._createDGVAttrToPredicatsAttrMap(t.results[o]));return{PathsIDWithLRef:i,mapDIFIdsAttr:n}},_UpdateDIFOnNode:function(e,t,n){for(var o=0;o<e.length;o++){var r=e[o].options.instance?e[o].options.instance.physicalid:"",s=e[o].getNodesByRelId("connectedDIF"+r)[0];if(s)s.empty(),u._computeConnectedDIFSTructureUnderDIFCategoryNode(e[o],t,s,n);else{for(var l=0;l<t.length;l++)if(t[l][0]===e[o].options.physicalid){(s=new i({label:a.label_diagrams,icons:[{iconName:"fl-diagrams"}],type:"DiagramsCategory",editableFlag:!1})).setRelationID("connectedDIF"+r),e[o].addChild(s),e[o].updateOptions(),s.updateOptions();break}u._computeConnectedDIFSTructureUnderDIFCategoryNode(e[o],t,s,n)}}},_createDGVAttrToPredicatsAttrMap:function(e){var t,i,r,s={},a={iconSize:{height:"16px",width:"16px"}};"DIFLayout"===e["ds6w:type"]?a.iconPath=n.getServiceURL("3DSpace")+"/snresources/images/icons/small/I_VPMNavDifLayout.png":"DIFSheet"===e["ds6w:type"]?a.iconPath=n.getServiceURL("3DSpace")+"/snresources/images/icons/small/I_VPMNavDifSheet.png":"DIFView"===e["ds6w:type"]&&(a.iconPath=n.getServiceURL("3DSpace")+"/snresources/images/icons/small/I_VPMNavDifView.png"),s.physicalid=e.resourceid,s.label=e["ds6w:label"],s.icons=[a],s.type=e["ds6w:type"],s.description=e["ds6w:description"],s.virtual=!0,t=e["ds6w:created"]?o.formatDate(e["ds6w:created"]):"",i=e["ds6w:modified"]?o.formatDate(e["ds6w:modified"]):"",r=e.current?d.MAPPING_MATURITY[e.current]:"";var l={creationDate:t,description:e["ds6w:description"],isLastVersion:e["ds6w:islastrevision"],maturity:r,revision:e["ds6wg:revision"],physicalid:e.resourceid,modificationDate:i,owner:e["ds6w:responsible"],type:c[e["ds6w:type"]],name:e["ds6w:label"],kindOfRFLP:"DIF",actualType:e["ds6w:type"]};return s.grid=l,s},_computeConnectedDIFSTructureUnderDIFCategoryNode:function(e,t,n,o){for(var r=[],s=0;s<t.length;s++)if(t[s][0]===e.options.physicalid){s>0?t[s-1][1]!==t[s][1]&&(r=[],u._attachRootDIFNodeToconnectedDIFCategory(r,o[t[s][1]],n)):u._attachRootDIFNodeToconnectedDIFCategory(r,o[t[s][1]],n);for(var a=r.length,l=3;l<t[s].length;l+=2)s>0?t[s][l]!==t[s-1][l]&&(DIFNode=new i(o[t[s][l]]),r.push(DIFNode),3===l?r[0].addChild(r[a]):u._attachnode(r,r[a]),r[a].updateOptions(),a++):(DIFNode=new i(o[t[s][l]]),r.push(DIFNode),3===l?r[0].addChild(r[a]):r[a-1].addChild(r[a]),r[a].updateOptions(),a++)}},_attachRootDIFNodeToconnectedDIFCategory:function(e,t,n){var o=new i(t);e.push(o),n.addChild(e[0]),e[0].updateOptions()},_attachnode:function(e,t){for(var i=e.length-1;i>=0;i--)if("DIFSheet"===e[i].options.type){e[i].addChild(t);break}}};return u}),define("DS/CATFLCockpitWidget/components/IDCard/idcard.controller",["UWA/Class/Model","DS/CoreEvents/ModelEvents","DS/UIKIT/DropdownMenu","DS/ENOXIDCard/js/IDCard","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.attachment","WebappsUtils/WebappsUtils","DS/CATFLCockpitWidget/commands/RelatedObjectCmd","DS/CATFLCockpitWidget/components/CommandsCtrl/command.controller","DS/CATFLCockpitWidget/components/ExportCSV/ExportCSV","DS/CATFLCockpitWidget/components/ArchitectureNumber/monoInstantiationStatus","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,g,m,f,h,v){"use strict";var C=JSON.parse(f),b=JSON.parse(h);return{init:function(e,o,r,s){var a=this;a.activeItem={},a.activeModel={},a.activeModelVersion={},a.activePC={},a.idcardModelEvents=new t,a.itemData=o.itemData,a.idcardModel=a.createIDCardModel(o,s),a.subscribeToIdCardEvents(),a.subscribeToGlobalEvents();var c=new n({model:a.idcardModel});return c.render().inject(e),c.attachResizeSensor(),a.idcard=c,a.idCardMenu=new i({maxItemsBeforeScroll:16,items:[{name:"setArchNo",text:v.set_architecture_number,fonticon:"progress-3"},{name:"setConfigCtx",text:v.action_edit_config_ctx,fonticon:"3dproduct-pencil"},{className:"divider"},{name:"revisions",text:v.revisions,fonticon:"flow-branch-list"},{name:"revisionExplorer",text:v.revision_explorer,fonticon:"flow-branch"},{name:"duplicate",text:v.duplicate,fonticon:"duplicate"},{name:"compareWith",text:v.compare,fonticon:"part-compare"},{name:"maturity",text:v.maturity,fonticon:"collaborative-lifecycle-management"},{className:"divider"},{name:"reserve",text:v.action_lock,fonticon:"lock"},{name:"unreserve",text:v.action_unlock,fonticon:"lock-open"},{name:"moveTo",text:v.action_move_to,fonticon:"move-to"},{className:"divider"},{name:"relatedObjs",text:v.relations,fonticon:"object-related"},{fonticon:"fonticon fonticon-progress-3-ok ",name:"ANUnicity",text:v.action_architecture_number_unicity_effectivity},{text:v.action_export,fonticon:"export",items:[{name:"exportStructure",text:v.action_export_structure},{name:"monoInstant",text:v.action_mono_instantiation_status}]}],target:c.container.querySelector(".actions-menu-icon"),events:{onShow:function(e,t){var i=a.activeModelVersion?a.activeModelVersion:null,n=a.itemData,o=!1;(!i||i.current!==C.state_act_Release&&i.current!==C.state_act_Obsolete)&&(!n||n.attributes.grid.maturity!==C.state_act_Released&&n.attributes.grid.maturity!==C.state_act_Obsolete)||(o=!0),o?(this.disableItem("setArchNo"),this.disableItem("reserve"),this.disableItem("unreserve")):(this.enableItem("setArchNo"),this.enableItem("reserve"),this.enableItem("unreserve"));var r=widget.getValue("component-view");widget.getValue("modelAttached")&&r!==b.flattenedView&&r!==b.flattenedViewOnlyArchitectureItem?this.enableItem("ANUnicity"):this.disableItem("ANUnicity")},onClick:function(e,t){var i=o.itemData.physicalid,n=o.itemData.label?o.itemData.label:o.itemData.attributes.label;if("maturity"===t.name)u.init("MaturityCommand",[{physicalid:i,label:n}]);else if("revisions"===t.name)u.init("HistoryCommand",[{physicalid:i,label:n,type:o.itemData.type,displayType:o.itemData.attributes.grid.type,revision:o.itemData.attributes.grid.revision,current:o.itemData.attributes.grid.maturity,icons:o.itemData.attributes.grid.icons}]);else if("duplicate"===t.name)u.init("DuplicateCommand",[{physicalid:i,type:o.itemData.type,label:n,displayType:o.itemData.attributes.grid.type,revision:o.itemData.attributes.grid.revision,current:o.itemData.attributes.grid.maturity,icons:o.itemData.attributes.icons}]);else if("moveTo"===t.name)u.init("ChangeOwnerCommand",[{physicalid:i,type:o.itemData.type,label:n,displayType:o.itemData.attributes.grid.type,revision:o.itemData.attributes.grid.revision,owner:o.itemData.attributes.grid.owner,icons:o.itemData.attributes.icons}]);else if("share"===t.name)u.init("ShareCmd",[{physicalid:i,type:o.itemData.type,label:n,displayType:o.itemData.attributes.grid.type,revision:o.itemData.attributes.grid.revision,owner:o.itemData.attributes.grid.owner,icons:o.itemData.attributes.icons}]);else if("compareWith"===t.name)u.init("CompareCmd",[{physicalid:i,label:n}]);else if("setArchNo"===t.name)l.setArchitectureNumber(i);else if("setConfigCtx"===t.name){o.contentView.getTreeDocument().unselectAll();var r=[{context:a,physicalid:i,label:n,type:o.itemData.type}];u.init("EditConfigurationContextCmd",r)}else"relatedObjs"===t.name?d.execute("ENORIPE_AP",new m(o.itemData.attributes)):"revisionExplorer"===t.name?a.versionExplHandler.apply(a):"reserve"===t.name?(null,i,(r=[]).push({physicalid:i,relID:"",parent:{physicalid:""}}),u.init("ReserveCmd",r)):"unreserve"===t.name?(null,i,(r=[]).push({physicalid:i,relID:"",parent:{physicalid:""}}),u.init("UnreserveCmd",r)):"exportStructure"===t.name?new p(i,n,{model:a.activeModel,modelVersion:a.activeModelVersion,pc:a.activePC}):"monoInstant"===t.name?g.downloadStatus(i,n,{model:a.activeModel,modelVersion:a.activeModelVersion,pc:a.activePC}):"ANUnicity"===t.name&&a.idcardModelEvents.publish({event:"check-unicity-AN"})}}}),r.subscribe({event:"triptych-panel-visible"},function(e){"right"===e&&c.toggleInformationIcon(!0)}),r.subscribe({event:"triptych-panel-hidden"},function(e){"right"===e&&c.toggleInformationIcon(!1)}),a.parentContainer=e.parentElement,a.parentContainer.classList.add("flweb-cockpit-idcard-minified"),a},subscribeToIdCardEvents:function(){var e=this;e.idcardModelEvents.subscribe({event:"idcard-open-modelVersion-selector"},e.modVerNameClickHandler.bind(e)),e.idcardModelEvents.subscribe({event:"idcard-open-configuration-selector"},e.configurationClickHandler.bind(e)),e.idcardModelEvents.subscribe({event:"idcard-open-version-explorer"},e.versionExplHandler.bind(e)),e.idcardModelEvents.subscribe({event:"idcard-minified"},function(){e.parentContainer.classList.add("flweb-cockpit-idcard-minified")}),e.idcardModelEvents.subscribe({event:"idcard-expanded"},function(){e.parentContainer.classList.remove("flweb-cockpit-idcard-minified")}),e.idcardModelEvents.subscribe({event:"idcard-attributes-clicked"},e.attributeClickHandler.bind(e,{id:e.itemData.physicalid,type:e.itemData.type,name:e.itemData.attributes.label}))},subscribeToGlobalEvents:function(){if(!o.getSubscriptionList().includes("idCardController")){var e=o.getFLWebModelEventsObj("flweb-model-events");e.subscribe({event:"idcard-refresh"},this._refreshIDCardInformation.bind(this)),e.subscribe({event:"mod-PC-selection-successful"},this._updateIDCardOnConfigSelectionDone.bind(this)),e.subscribe({event:"allmod-selection-successful"},this._updateIDCardOnAllModelSelection.bind(this)),e.subscribe({event:"mod-selection-removed"},this._updateIDCardOnModelRemoved.bind(this)),e.subscribe({event:"flweb-ngfilter-added"},this.updateNGFilter.bind(this)),e.subscribe({event:"flweb-ngfilter-removed"},this.updateNGFilter.bind(this)),o.addToSubscriptionList("idCardController")}},createIDCardModel:function(e,t){var i=e.itemData;this.setCurrentItem(i.physicalid,i.attributes.label,i.attributes.grid.revision);var n=i.attributes.grid.description?i.attributes.grid.description:v.label_noDescription,o=i.attributes.grid.architectureNumber?i.attributes.grid.architectureNumber:v.label_none;return new UWA.Class.Model({minified:!0,name:i.attributes.label,version:i.attributes.grid.revision,configuration:"",thumbnail:c.getWebappsAssetUrl("CATFLCockpitWidget","img/I_VPMNavLogical108x144.png"),withHomeButton:!1,showBackButton:t,withExpandCollapseButton:!0,withActionsButton:!0,withInformationButton:!0,withToggleMinifiedButton:!0,modelEvents:this.idcardModelEvents,freezones:['<p title="'+n+'">'+n+"</p>"],attributes:[{id:"ds6w:who/ds6w:responsible",name:v.label_owner,value:i.attributes.grid.owner,displayWhenMinified:!0,type:"type-hyperlink",editable:!0},{id:"ds6w:what/ds6w:status",name:v.label_maturity,value:i.attributes.grid.maturity,editable:!0,type:"type-hyperlink",displayWhenMinified:!0},{id:"ds6w:when/ds6w:created",name:v.label_creation_date,value:a.displayDate(i.attributes.grid.creationDate),displayWhenMinified:!0},{id:"ds6w:when/ds6w:modified",name:v.label_modification_date,value:a.displayDate(i.attributes.grid.modificationDate),displayWhenMinified:!0},{id:"ds6w:when/ds6w:architectureNo",name:v.label_arch_no,value:o,type:"type-hyperlink",editable:!0}]})},updateIDCardData:function(e){e.forEach(function(e){var t=e.key,i=e.value,n=e.editable;if(e.isAttributeSet){for(var o=this.idcardModel.get("attributes"),r=[],s=0;s<o.length;s++)s!==t?r.push({id:o[s].id,name:o[s].name,value:o[s].value,editable:o[s].editable,type:o[s].type,displayWhenMinified:o[s].displayWhenMinified}):(o[s].value=i,r.push({id:o[s].id,name:o[s].name,value:i,editable:n,type:e.type,displayWhenMinified:o[s].displayWhenMinified}));this.idcardModel.set("attributes",r)}else this.idcardModel.set(t,i)}.bind(this))},_updateIDCardOnConfigSelectionDone:function(e){a.alertMessage("success",null,v.attachedConfigurationUpdated);var t=v.label_all;e.pc&&(t="["+(t=e.pc.label?e.pc.label:e.pc.name)+"]"),this.updateIDCardData([{key:"version",value:"",isAttributeSet:!1},{key:"modelVersion",value:e.modelVer.name,isAttributeSet:!1},{key:"versionModel",value:e.modelVer.revision,isAttributeSet:!1},{key:"configuration",value:t,isAttributeSet:!1}]),this.setCurrentModel(e.model.physicalid,e.model.id,e.model.name),this.setCurrentModelVersion(e.modelVer.physicalid?e.modelVer.physicalid:e.modelVer.id,e.modelVer.name,e.modelVer.revision,e.modelVer.backEndName,e.modelVer.current),null!==e.pc?this.setCurrentPC(e.pc.physicalid,e.pc.name,e.pc.revision,t):this.setCurrentPC(null,null,null,v.label_all),widget.setValue("currentConfig",{model:this.activeModel,modelVersion:this.activeModelVersion,pc:this.activePC,filterCompiledForm:e.filterCompiledForm})},_updateIDCardOnAllModelSelection:function(){this.updateIDCardData([{key:"version",value:"",isAttributeSet:!1},{key:"modelVersion",value:v.label_all_models,isAttributeSet:!1},{key:"versionModel",value:"",isAttributeSet:!1},{key:"configuration",value:"",isAttributeSet:!1}]),this.setCurrentModel(null,null,null),this.setCurrentModelVersion(null,null,null,null),this.setCurrentPC(null,null,null,null),widget.setValue("currentConfig",null)},_updateIDCardOnModelRemoved:function(e){this.updateIDCardData([{key:"version",value:this.activeItem.revision?this.activeItem.revision:v.label_active_rev,isAttributeSet:!1},{key:"modelVersion",value:"",isAttributeSet:!1},{key:"versionModel",value:"",isAttributeSet:!1},{key:"configuration",value:"",isAttributeSet:!1}]),this.setCurrentModel(null,null,null),this.setCurrentModelVersion(null,null,null,null),this.setCurrentPC(null,null,null,null),widget.setValue("currentConfig",null),widget.setValue("modelAttached",null),a.alertMessage("success",null,v.attachedConfigurationRemoved)},attributeClickHandler:function(e,t){if(t.attributeName===v.label_maturity){var i={};i.physicalid=e.id,i.label=e.name,(n=[]).push(i),u.init("MaturityCommand",n)}else if(t.attributeName===v.label_owner){var n;(n={}).physicalid=e.id,n.label=e.name,n.type=e.type,n.displayType=this.itemData.attributes.grid.type,n.revision=this.itemData.attributes.grid.revision,n.owner=this.itemData.attributes.grid.owner,n.icons=this.itemData.attributes.icons,u.init("ChangeOwnerCommand",[n])}else if(t.attributeName===v.label_arch_no){var o=e.id;e.name?e.name:v.label_none;l.setArchitectureNumber(o)}},modVerNameClickHandler:function(){var e=this,t=widget.getValue("modelAttached"),i=[],n={};t.forEach(function(e){e.id||(i.push(e.physicalid),n[e.physicalid]=e)}),i.length>0?s.getItemInfo(i).then(function(i){(i=i.member).forEach(function(e){e.objectid&&(n[e.physicalid].id=e.objectid)}),t=Object.values(n),require(["DS/CATFLCockpitWidget/components/ModelPCSelector/configurationSelector"],function(t){var i=t.init("MODELVERSION",e.itemData.physicalid,widget.getValue("modelAttached"),e.activeModelVersion);i.inject(e.parentContainer),i.show()}.bind(e))}):require(["DS/CATFLCockpitWidget/components/ModelPCSelector/configurationSelector"],function(t){var i=t.init("MODELVERSION",e.itemData.physicalid,widget.getValue("modelAttached"),e.activeModelVersion);i.inject(e.parentContainer),i.show()}.bind(e))},configurationClickHandler:function(){var e=this,t=widget.getValue("ngFilter");e.idcardModel.get("configuration");t&&t.length>0?o.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-ngFilter-open"}):require(["DS/CATFLCockpitWidget/components/ModelPCSelector/configurationSelector"],function(t){var i=t.init("PC",e.itemData.physicalid,e.activeModel,e.activeModelVersion,e.activePC,e.activeItem);i.inject(e.parentContainer),i.show()}.bind(e))},versionExplHandler:function(){var e={};if(widget.getValue("modelAttached")){if(!this.activeModelVersion.id||!this.activeModel.physicalid)return void a.alertMessage("info",null,v.info_modelVersion_not_set);e.id=this.activeModelVersion.id,e.kind=C.type_modelVersion,e.model=this.activeModel,e.modelVer=this.activeModelVersion,e.itemData=this.activeItem,e.isConfigured=!1}else e.id=this.itemData.physicalid,e.kind=this.itemData.type,e.isConfigured=!0;require(["DS/CATFLCockpitWidget/components/VersionExplorer/versionexplorer.controller"],function(t){t.displayVersionGraph({modelKey:e})})},updateNGFilter:function(e){var t="";e.filterName||e.filterTitle?(t=e.filterTitle?"["+e.filterTitle+"]":"["+e.filterName+"]",this.updateIDCardData([{key:"version",value:"",editable:!1,isAttributeSet:!1},{key:"modelVersion",value:"",isAttributeSet:!1},{key:"versionModel",value:"",isAttributeSet:!1},{key:"configuration",value:t,editable:!1,isAttributeSet:!1}])):widget.getValue("modelAttached")&&!this.activeModelVersion.physicalid?this._updateIDCardOnAllModelSelection():this.updateIDCardData([{key:"version",value:this.activeModelVersion.revision?"":this.activeItem.revision,isAttributeSet:!1},{key:"modelVersion",value:this.activeModelVersion.name?this.activeModelVersion.name:"",isAttributeSet:!1},{key:"versionModel",value:this.activeModelVersion.revision?this.activeModelVersion.revision:"",isAttributeSet:!1},{key:"configuration",value:this.activePC.label,isAttributeSet:!1}])},_refreshIDCardInformation:function(){var e=this;r.getLogItemAttributes(e.itemData.physicalid).then(function(t){var i=t.attributes,n=i.grid.architectureNumber||v.label_none;e.idcard.container.getElement(".free-zone-0").setHTML("<p>"+(i.grid.description||v.label_noDescription)+"</p>"),e.updateIDCardData([{key:"name",value:i.label,editable:!1,isAttributeSet:!1},{key:0,value:i.grid.owner,editable:!0,isAttributeSet:!0},{key:1,value:i.grid.maturity,editable:!0,isAttributeSet:!0},{key:3,value:a.displayDate(i.grid.modificationDate),editable:!1,isAttributeSet:!0},{key:4,value:n,editable:!0,isAttributeSet:!0}]),e.itemData.attributes.label=i.label,e.itemData.attributes.maturity=i.maturity,e.itemData.attributes.grid.maturity=i.grid.maturity,e.itemData.attributes.grid.owner=i.grid.owner,e.itemData.attributes.grid.description=i.grid.description,e.itemData.attributes.grid.modificationDate=i.grid.modificationDate,e.itemData.attributes.grid.architectureNumber=n})},setCurrentItem:function(e,t,i){this.activeItem={physicalid:e,id:e,name:t,revision:i}},setCurrentModel:function(e,t,i,n){this.activeModel={physicalid:e||t,id:t,name:i,revision:n}},setCurrentModelVersion:function(e,t,i,n,o){this.activeModelVersion={physicalid:e,id:e,name:t,revision:i,backEndName:n,current:o}},setCurrentPC:function(e,t,i,n){this.activePC={physicalid:e,id:e,name:t,label:n,revision:i}}}}),define("DS/CATFLCockpitWidget/utils/gridview.util.extended",["DS/UIKIT/Mask","DS/CATFLCockpitWidget/model/CATFLCockpitTreeDocument","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","WebappsUtils/WebappsUtils","DS/Utilities/Utils","DS/CATFLCockpitWidget/utils/gridview.util","DS/CATFLCockpitWidget/utils/pno.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/document.service","DS/CATFLCockpitWidget/services/index.service","DS/CATFLCockpitWidget/services/modeler.service","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/services/implementlink.service","DS/CATFLCockpitWidget/services/space.service","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,g,m,f,h,v,C){"use strict";var b=JSON.parse(h),y=JSON.parse(v);return{expandNFetchOtherNodes:function(e,t,i){var o;if("-1"===i){if(0===(o=t.getAllDescendants().filter(function(e){return!(e.options.type!==b.type_act_logref||!e.options.instance)&&!e.options.hasBeenExpanded})).length)return void t.expandAll()}else if(0===(o=t.getChildren().filter(function(e){return!(e.options.type!==b.type_act_logref||!e.options.instance)&&!e.options.hasBeenExpanded})).length)return void t.expandNLevels({numberOfLevelsToExpand:i});t.expand(),n.createBatchServiceReqExecution(o,i,e,!0,t)},getExpandServicesForBatchCalls:function(e,t,i,o,r){let s=this,l=[],c=widget.getPreference(y.disableIndexAcceleration).value,d=widget.getValue(y.componentView),u=!1;if(!i){let i=[];if(e.forEach(function(e){("1"!==o||"1"===o&&!e.options.noIndexOrDBExpand)&&i.push(e)}),c)l.push(s.addDBExpandForBatch(i,t,o,r));else{var p=n.sortNodesIntoDBandIndex(i,!0);p.indexNodes.length>0&&l.push(s.addIndexExpandForBatch(p.indexNodes,t,o,r)),p.databaseNodes.length>0&&l.push(s.addDBExpandForBatch(p.databaseNodes,t,o,r))}d===y.structuredView&&("2"!==o&&"-1"!==o||(u=!0),l.push(s.addOccImplementLinksToNodesInBatch(e,null,{bExpand:u})))}let g=[],m=[];if(c)g=e;else{let t=n.sortNodesIntoDBandIndex(e,!1);g=t.databaseNodes,m=t.indexNodes}let f=["SPECIFICATION_DOCUMENT","PROPOSED_SOLUTION","REFERENCE_DOCUMENT","IMPLEMENTING_LINK","IMPLEMENTEDBY_LINK"];return i||"2"!==o&&"-1"!==o||(u=!0),g.length>0&&l.push(a.addDBNavigate(g,{navigateTypes:f,bExpand:u})),m.length>0&&l.push(a.addIndexNavigate(m,{navigateTypes:f,bExpand:u})),l},addIndexExpandForBatch:function(e,t,i,n){var o=this,r=[],s=[],l={};let c,d=widget.getValue(y.componentView),p=widget.getValue("ngFilter");return p&&p.length>0?("1"!==i&&e.forEach(function(e){o.expandNFetchOtherNodes(n,e,i)}),Promise.resolve()):(e.forEach(function(e){c||(c=e.getTreeDocument()),("1"!==i||"1"===i&&!e.options.noIndexOrDBExpand)&&(r.push(e.options.physicalid),d===y.structuredView&&s.push(e.getOccurencePath()),l[e.options.physicalid]=e)}),r.length<=0?Promise.resolve():u.expand({multipleIDs:r,configFilter:t,expandIter:i,occPaths:s}).then(function(r){e.forEach(function(e){let s=e.options.physicalid;a.createTreeDocumentFromIndexResponse(r[s],c,e,t),"1"!==i&&o.expandNFetchOtherNodes(n,e,i)})}))},addDBExpandForBatch:function(e,t,i,n){var o=this;0;var r=[],s={};let l,c=widget.getValue("ngFilter");return c&&c.length>0?("1"!==i&&e.forEach(function(e){o.expandNFetchOtherNodes(n,e,i)}),Promise.resolve()):(e.forEach(function(e){l||(l=e.getTreeDocument()),("1"!==i||"1"===i&&!e.options.noIndexOrDBExpand)&&(r.push(e.options.physicalid),s[e.options.physicalid]=e)}),r.length<=0?Promise.resolve():p.expand({itemIDs:r,depth:"-1"===i?"0":i,configFilter:t}).then(function(t){e.forEach(function(e){let r=e.options.physicalid;a.addDBExpandCallBack(e,null,t[r],l),"1"!==i&&o.expandNFetchOtherNodes(n,e,i)})}))},addOccImplementLinksToNodesInBatch:function(e,t,i){for(var n={},o=0;o<e.length;o++)e[o].isRoot()||(n[e[o].options.instance.physicalid]=e[o]);return 0,widget.getValue(y.componentView)!==y.structuredView?Promise.resolve():m.getInstanceImplementLinks(e,!0).then(function(e){if(0,e){(i=i||{}).keepNodes=!0,e.forEach(function(e){a.manageImplementLinkResp(e.node,"inst",e,i)})}t&&t()})}}}),define("DS/CATFLCockpitWidget/components/ContextualMenu/contextualmenu.actions",["DS/UIKIT/Mask","DS/Windows/Dialog","DS/Controls/Button","DS/CATFLCockpitWidget/components/AttributesManagement/AttributesManagement","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.attachment","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/index.service","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/refresh.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/gridview.util.extended","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u,p){"use strict";var g=a.getFullConfig(),m=(g.identifiers,g.localStorageKeys);return{openAttributesManagementForProposedSolution:function(e){for(var t=[],i=0;i<e.length;i++)-1===t.indexOf(e[0].options.type)&&t.push(e[0].options.type);new n(!0,t,null)},getNodeInfoForEffectivity:function(e,t){var i,n=[];return t.forEach(function(t){i=t.getParent();var o={context:e,physicalid:t.options.instance.physicalid,label:t.options.grid.instanceName,type:t.options.type,parent:{physicalid:i.options.physicalid,label:i.options.label,type:i.options.type},nodeModel:t};n.push(o)}),n},replaceByNewRevision:function(t,i){e.mask(i.collectionView.getContent(),p.msg_processing);for(var n=[],o=[],s=[],c=[],u=0;u<t.length;u++){if(!t[u].options.instance||!t[u].options.instance.physicalid)return e.unmask(i.collectionView.getContent()),void l.createReportStatusPanel(p.label_replace_new_rev_report,{error:[p.msg_remove_root]});o.push(t[u].options.physicalid),s.push(t[u].getParent().options.physicalid),n.push({replaceWith:"newRevision",instanceID:t[u].options.instance.physicalid}),c.push(t[u])}for(u=0;u<s.length;u++)if(o.includes(s[u]))return e.unmask(i.collectionView.getContent()),void l.createReportStatusPanel(p.label_replace_new_rev_report,{error:[p.msg_Replace_Parent_Child]});r.replaceWithNewRevision(n).then(function(t){if(e.unmask(i.collectionView.getContent()),200==t.status||t.member){for(var n=t.member?t.member:null,o=[],r={},u=[],g=0;g<s.length;g++)a.SAXStorage().setItem(m.recentlyAuthoredStructure+s[g],Date.now());n&&(c.forEach(function(e,t){var s=e.options.instance.physicalid;u.push(e.options.label);var a=i.collectionView.treeDocument.getMappedNodesFromId(e.options.physicalid);a||(a=[e]);for(var l=a.length-1;l>=0;l--){var c=a[l];c.options.instance.physicalid===s&&(i.collectionView.treeDocument.removeFromMappedNodes(c),c.removeChildren(),c.collapse(),c.updateOptions({hasBeenExpanded:!1,noIndexOrDBExpand:!1,dontExpandTwoLvl:!1,dontExpandAllLvl:!1,configContexts:void 0,physicalid:n[t].reference,instance:{physicalid:n[t].id},grid:{instanceName:n[t].name,physicalid:n[t].reference,configCtx:void 0}}),c.setRelationID(n[t].id),i.collectionView.treeDocument.addToMappedNodes(c))}o.push(n[t].reference),r[n[t].id]=e}),d.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-nodes-by-id",data:{arrayOfPID:o,tagAsRecentlyAuthored:!0}}),d.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-inst-by-id",data:{instIdMap:r,bInstance:!0,bEffectivity:!0}}));var f=u.map(e=>e+" "+p.msg_replace_success);l.createReportStatusPanel(p.label_replace_new_rev_report,{success:f})}else l.createReportStatusPanel(p.label_replace_new_rev_report,{error:[t.message]})}).catch(function(t){e.unmask(i.collectionView.getContent()),l.displayError(t,null,null,p.error_repl_failed)})},reparentAction:function(e,t,i){i.instances.every(function(e){return!e.options.grid.architectureNumber||""===e.options.grid.architectureNumber})?this.showGenericConfirmWindow(e,t,i):g.adminStatus.ReparentEnforceSetAN?o.setArchitectureNumber(i.instances,{newParent:e[0],params:t}):this.showGenericConfirmWindow(e,t,i)},showGenericConfirmWindow:function(n,o,s){for(var a=0;a<s.instances.length;a++)if(n[0].options.physicalid===s.instances[a].options.physicalid)return void l.alertMessage("error",null,p.msg_reparent_cyclic_error);var d=s.nameList,u=new t({title:p.label_reparent,content:UWA.createElement("p",{html:p.msg_reparent_confirm+n[0].options.label+" ? <br>"+d}),modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new i({label:p.label_reparent,emphasize:"primary",onClick:function(){u.close(),e.mask(o.collectionView.getContent(),p.msg_processing);var t=[];s.instances.forEach(function(e){t.push({parentID:n[0].options.physicalid,instanceID:e.options.instance.physicalid,itemID:e.options.physicalid})}),r.reparentInstances(t).then(function(e){c.refreshNodesOnReparent({resp:e,params:o,newParent:n[0],instArray:s.instances})},function(t){e.unmask(o.collectionView.getContent()),l.displayError(t,null,null,p.error_reparent_failed)})}}),Cancel:new i({emphasize:"secondary",onClick:function(){u.close()}})}});return u.addEventListener("close",function(){u.destroy()}),u},checkInstanceCount:function(e,t){s.expandV2({forSynthesis:{IDs:e[0].options.physicalid,configFilter:t},synthType:"Flat"}).then(function(e){var t=null;e=e.slice(0,-2),(e=JSON.parse(e)).results&&(t=((t=e.results[0].synthesis.value)-1)/2)&&t>1e3&&l.alertMessage("warning",null,p.replace(p.msg_expand_largeData_warning))},function(){l.alertMessage("error",null,"",p.msg_generic_error_get_failed)})}}}),define("DS/CATFLCockpitWidget/components/ArchitectureNumber/architectureNumber",["UWA/Core","DS/UIKIT/Mask","DS/Windows/Dialog","DS/Controls/Button","DS/Windows/ImmersiveFrame","DS/CATFLCockpitWidget/components/ArchitectureNumber/architectureNumberView","DS/UIKIT/Input/Button","DS/Handlebars/Handlebars4","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/refresh.util","DS/CATFLCockpitWidget/utils/architectureNumber.util","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","text!DS/CATFLCockpitWidget/components/ArchitectureNumber/architectureNumber.html","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,g,m,f,h){return m=JSON.parse(m),{init:function(e,t){return t?(this.forReparent=!0,this.newParentID=t.newParent.options.physicalid,this.reparentRefreshData={params:t.params,newParent:t.newParent,instArray:t.selectedNodes,resp:null}):this.forReparent=!1,this.duplicateP2LWarningIDs={},this.createModal(e),this.pushSetArchView(e)},createModal:function(e){var o=this,r=a.compile(f),s=(o.forReparent?h.label_reparent_set_archNo:h.label_set_arch_no)+" - ";1===e.rows.length?s+=e.rows[0].title:s+=e.rows.length+" "+h.label_objects;UWA.createElement("div",{html:r()});var d={Cancel:new n({onClick:function(e){o.modalWindow.destroy()}}),Ok:new n({label:o.forReparent?h.label_reparent:h.set_button,onClick:function(i){t.mask(o.modalWindow.elements._contentDiv,h.msg_processing);for(var n=[],r=0,s=o.modalWindow.getContent().getElement(".itemDetails").getChildren("tr"),a=0;a<s.length;a++)("ko"===s[a].getChildren()[0].getAttribute("status")||s[a].getChildren()[0].hasClassName("iconColor"))&&r++;if(r===s.length)return l.alertMessage("error",null,h.log_ref_selection_error),void t.unmask(o.modalWindow.elements._contentDiv);var d,u={},p=null;for(a=0;a<s.length;a++){var g,m=s[a],f=(p={},m.getAttribute("referenceID")),v=m.querySelectorAll('[required = "true"]'),C=!1;if(!m.getChildren()[0].getAttribute("status")||"ko"===m.getChildren()[0].getAttribute("status")){o.reparentRefreshData&&o.reparentRefreshData.instArray.forEach(function(e,t,i){e.options.physicalid!==f||i.splice(t,1)});continue}if("onlyReparent"===m.getChildren()[0].getAttribute("status")){d=Array.isArray(m.getAttribute("instanceIDs"))?m.getAttribute("instanceIDs"):[m.getAttribute("instanceIDs")],n.push({referenceID:f,instanceIDs:d});continue}for(var b=0;b<v.length;b++){if(requiredCell=v[b],"true"===requiredCell.getAttribute("editable"))if(""==requiredCell.getElement("input").value.trim()){requiredCell.getElement("input").scrollIntoView(),requiredCell.getElement("input").addClassName("errordiv"),l.alertMessage("error",null,h.req_field_error_header,requiredCell.getAttribute("name")+h.arch_number_required_field),C=!0;break}}if(C)break;if((g=m.getElement(".archidcell")?m.getElement(".archidcell").getHTML():m.querySelector('[architectureidcolumn = "true"]').getElement("input").value.trim())==m.getElement("#existing").getHTML()){t.unmask(o.modalWindow.elements._contentDiv),l.alertMessage("error",null,"",h.existing_architecture_number_error),m.getElement(".archidcell")?m.getElement(".archidcell").addClassName("errordiv"):row.querySelector('[architectureidcolumn = "true"]').addClassName("errordiv"),C=!0;break}u[f]=g;var y=null,_=null,D={};m.getElements("[architectureidcolumn=true]").forEach(e=>{if(y=e.getAttribute("id"),"true"===e.getAttribute("editable")){let t=e.getChildren()&&e.getChildren()[0];_=t.dsModel.value}else _=e.getHTML();D[y]=_});let e=m.getAttribute("instanceIDs");e?p.instanceIDs=Array.isArray(e)?e:e.split(","):m.getAttribute("instanceID")&&(p.instanceID=m.getAttribute("instanceID")),p.referenceID=f,p.ArchitectureNumber=g,p.ArchitectureNumberTokens=D,n.push(p)}if(C)t.unmask(o.modalWindow.elements._contentDiv);else{var S=o.setPayload(n,u);S.AN_ACTION=e.AN_ACTION,o.removeCSS(),o.forReparent?c.setANandReparent(S).then(function(e){e=JSON.parse(e),o.setArchitectureNumber(e,u)}).catch(function(e){t.unmask(o.modalWindow.elements._contentDiv),l.displayError(e,null,null,h.error_set_archno)}):c.setArchitectureNumber(S).then(function(e){e=JSON.parse(e),o.setArchitectureNumber(e,u)}).catch(function(e){t.unmask(o.modalWindow.elements._contentDiv),l.displayError(e,null,null,h.error_set_archno)})}}})};e.showBulkRecomputation&&(d.Apply=new n({label:h.label_reEvaluate_ArchNo,onClick:function(){g.executeRecompute({an_action:e.AN_ACTION,rows:o.modalWindow.getContent().getElement(".itemDetails").getChildren("tr"),forReparent:o.forReparent})}})),o.modalWindow=new i({title:s,content:r(),domId:"set-architecture-number",immersiveFrame:widget.immersiveFrame,width:900,height:400,resizableFlag:!0,modalFlag:!0,buttons:d})},pushSetArchView:function(e){return this._architectureNumberView=new r,e.forReparent=this.forReparent,this._architectureNumberView.setCollection(e).render(this.modalWindow.getContent()),this.modalWindow},modalSubmit:function(){},setPayload:function(e,t){var i={},n=[];for(var o in this.duplicateP2LWarningIDs){this.duplicateP2LWarningIDs[o]===t[o]&&n.push(o)}return this.forReparent?(i.newParentID=this.newParentID,i.instances=e):i.architectureNumbers=e,i.ignoreP2LWarningIDs=n,this.duplicateP2LWarningIDs={},i},setCSS:function(e,t){var i=this;e.forEach(function(e){var n=i.modalWindow.getContent().getElement('.itemDetails tr[referenceID ="'+e+'"]'),o=n.getElement(".archidcell");if(t)if(o)o.addClassName(t),o.scrollIntoView();else{var r=n.querySelector('[architectureidcolumn = "true"]');r.addClassName(t),r.getElement("input").scrollIntoView()}else o||(o=n.querySelector('[architectureidcolumn = "true"]')),o.hasClassName("errordiv")&&o.removeClassName("errordiv")})},removeCSS:function(){for(var e=this.modalWindow.getContent().getElement(".itemDetails").getElements("tr"),t=0;t<e.length;t++)for(var i=0;i<e[t].getChildren().length;i++)e[t].getChildren()[i].hasClassName("archidcell errordiv")&&e[t].getChildren()[i].removeClassName("errordiv")},setArchitectureNumber:function(e,i){var n=this,o=n.modalWindow.getContent().getElement(".itemDetails").getElements("tr");if(t.unmask(n.modalWindow.elements._contentDiv),e.status&&200!=e.status){var r,s=null,a=[],c=[],d=[],g=[],m=[];o.forEach(function(t){var o=t.getAttribute("referenceID");"NON_COMPLIANCE"===e[o]?m.push(o):"NOCSGROUP"==e[o]||"FROZEN_REV"==e[o]||"NO_MODIFY_ACCESS"==e[o]?a.push(o):"KO"==e[o]||"UNICITY_KO"==e[o]?c.push(o):"P2L_DUPLICATE_WARNING"==e[o]?(n.duplicateP2LWarningIDs[o]=i[o],d.push(o)):"UNICITY_OK"==e[o]&&g.push(o)}),m.length>0?(s="errordiv",n.setCSS(m,s),n.duplicateP2LWarningIDs={},r={type:"error",message:h.msg_arch_number_non_compliance}):a.length>0?(s="errordiv",n.setCSS(a,s),n.duplicateP2LWarningIDs={},r={type:"error",message:h.msg_error_set_architecture_number_unselect_reference}):c.length>0?(s="errordiv",n.setCSS(c,s),n.duplicateP2LWarningIDs={},r={type:"error",message:h.arch_number_unique_error}):d.length>0?(s="errordiv",n.setCSS(d,s),r={type:"warning",message:h.msg_error_set_architecture_number_p2lwarning}):r={type:"error",message:h.msg_set_arch_num_failed},r&&(t.unmask(n.modalWindow.elements._contentDiv),l.alertMessage(r.type,null,"",r.message))}else{if(n.forReparent)n.reparentRefreshData.resp=e,p.refreshNodesOnReparent(n.reparentRefreshData),l.alertMessage("success",null,"",h.msg_reparent_setArch_success);else{var f=[];for(var v in e)i.hasOwnProperty(v)&&f.push(v);u.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-nodes-by-id",data:{arrayOfPID:f,tagAsRecentlyAuthored:!0,dontLoadSpaceInfo:!0}});var C=widget.getValue("currentOpenedItem");C&&f.indexOf(C)>=0&&u.getFLWebModelEventsObj("flweb-model-events").publish({event:"idcard-refresh"}),l.alertMessage("success",null,"",h.set_arch_number_success)}n.modalWindow.destroy()}}}}),define("DS/CATFLCockpitWidget/mixins/CATFLBIFilter",["UWA/Class","UWA/Class/Events","DS/Utilities/Utils","DS/ENOFilterBIUX/FilterBIComponentProxy","DS/CATFLCockpitWidget/mixins/CATFLBIGroup","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/gridview.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/index.service","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.controller","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","text!DS/CATFLCockpitWidget/assets/config/mapping.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,g,m,f){"use strict";var h=JSON.parse(g),v=JSON.parse(m);return e.extend(t,{_biFilter:null,filterInitialized:!1,_id2removeFromFilterProxy:[],_filterAlreadyTreatedRoot:[],defaultOptions:{model:null},init:function(e){this.options={model:e.view?e.view.treeDocument:void 0,view:e.view},this.initializeBI()},initializeBI:function(e){this._createProxy()},cleanProxy:function(){this._biFilter&&this._biFilter.cleanProxy&&this._biFilter.cleanProxy()},removeRootFromFilterProxy:function(e){this._biFilter&&(this._biFilter.resetNGFilterUI({appId:widget.id,widgetId:widget.id,rootIds:e.rootId2remove}),this._biFilter.removeRoot(e.rootId2remove))},addFilter:function(e){},loadFilters:function(e){},onModifyPreferences:function(e){},onApplyNGFilter:function(e){null!==e&&this.options.model.applyFilter(e,this.processNGFilter.bind(this,e))},processNGFilter:function(e,t){if(o.isGroupingApplied())this.onGroupingEvent({groups:o.options.groups});else{if(e.empty)widget.setValue("ngFilter",null),widget._biFilter=null,l.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-ngfilter-removed",data:{filterName:null}});else{e&&e.filterMdl&&delete e.filterMdl;let t=this._biFilter.hasFilter(e.filterRootIds[0]);t.filterId&&(e.filterId=t.filterId),widget.setValue("ngFilter",JSON.stringify(e)),widget._biFilter=this._biFilter,l.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-ngfilter-added",data:{filterName:e.filterName,filterTitle:e.filterTitle}})}t.response?(t.recentlyAuthored&&!e.empty&&r.alertMessage("warning",null,f.warn_indexed_data_filtered),t.treedocument.empty(),t.treedocument.hasBeenExpanded=!0,t.recentlyAuthored&&e.empty?a.createTreeDocumentFromDslogModelerResponse(t.response,t.treedocument):a.createTreeDocumentFromIndexResponse(t.response,t.treedocument)):r.alertMessage("info",null,f.msg_no_match_in_filter)}},onSetPathTags:function(){if(this._biFilter){var e=this;setTimeout(function(){var t={nodes:[],paths:[]},i={};function n(e){if(!e.isHidden()){var o=e.getRealPath().map(function(e){return function(e){return i.hasOwnProperty(e)||(t.nodes.push(e),i[e]=t.nodes.length-1),i[e]}(e.getID())});t.paths.push(o);var r=e.getChildren();r&&r.forEach(function(e){n(e)})}}e.options.model.getRealRoots().forEach(function(e){n(e)}),e._biFilter.setPathTags(t)})}},onSetTagsWithExpandSynthesis:function(){if(this._biFilter&&this.options.model&&this.options.model.getRealRoots()[0]){var e=this;setTimeout(function(){var t=e.options.model.getRealRoots()[0],i=t?t.getID():null;e._biFilter.setTagsWithExpandSynthesis&&i&&e._biFilter.setTagsWithExpandSynthesis([i],{type_filter_rel:["RFLVPMLogicalInstance","RFLPLMFunctionalInstance"]})})}},onTagsLoadingComplete:function(){},onFilterBIColorize:function(e){if(this.colorizeActivated=!0,e){this.predicateKind=e.tagColors&&e.tagColors.length?e.tagColors[0].type:null;for(var t=this.colorMap={map:{}},i=0;i<e.tagColors.length;i++){if(void 0===t.predicate){var n=e.tagColors[i].predicate.split("/"),o=n[n.length-1];t.predicate=o}var r=e.tagColors[i].object;UWA.is(e.tagColors[i].object,"array")&&(r=e.tagColors[i].object.join("/"),this.predicateKind="arrayPredicates"),t.map[r]=e.tagColors[i].color,t.map[e.tagColors[i].dispValue]=e.tagColors[i].color}this.colorizeNodes()}},colorizeNodes:function(){var e=this,t=v[this.colorMap.predicate]||this.colorMap.predicate;e.options.view.columns.find(e=>e.dataIndex===t)?e.options.model.withTransactionUpdate(function(){e.options.model.getAllDescendants().forEach(function(i){if(i.isVisible()&&!i.options.virtual){var n=t?i.options[t]?i.options[t]:i.options.grid[t]:void 0,o=null;if("date"===e.predicateKind){var r=new Date(n),s=r.getFullYear()+"/"+(r.getMonth()+1).toString().padStart(2,"0")+"/"+r.getDate().toString().padStart(2,"0"),a=r.getFullYear()+"/"+(r.getMonth()+1).toString().padStart(2,"0"),l=r.getFullYear();o=e.colorMap.map[s]?e.colorMap.map[s]:e.colorMap.map[a]?e.colorMap.map[a]:e.colorMap.map[l]?e.colorMap.map[l]:"rgba(0, 0, 0, 0)"}else"type"==t?o=e.colorMap.map[i.options.grid[t]]?e.colorMap.map[i.options.grid[t]]:"rgba(0, 0, 0, 0)":o||(o=e.colorMap.map[i.options[t]]?e.colorMap.map[i.options[t]]:e.colorMap.map[i.options.grid[t]]?e.colorMap.map[i.options.grid[t]]:"rgba(0, 0, 0, 0)");o||(o=e.colorMap.map[n]?e.colorMap.map[n]:"rgba(0, 0, 0, 0)");var c={color:o,isBeingCut:!1,grid:{bi_color:o}};i.updateOptions(c)}})}):(r.alertMessage("error",null,f.error_filter_colorize_predicate),this.onFilterBIUnColorize())},onFilterBIUnColorize:function(){var e=this;this.colorizeActivated=!1,e.options.model.withTransactionUpdate(function(){e.options.model.getRealRoots().forEach(function(e){var t={color:"rgba(0, 0, 0, 0)",grid:{bi_color:"rgba(0, 0, 0, 0)"}};e.updateOptions(t),e.getAllDescendants().forEach(function(e){e.updateOptions(t)})})})},onFilterBIFilteringEvent:function(e){var t=this;(t.getAllModels?t.getAllModels():[t.options.model]).forEach(function(i){i.withTransactionUpdate(function(){i.getRoots(!0).slice(0).forEach(function(e){e.filterIn(!0)});var n=i.getRealRoots(!0).slice(0);n.forEach(function(e){e.filterIn(!0)});var o=e.filteredSubjectList;if(o){for(var r=e.nodes,s=[],a={},l=function(e){return r[e]},c=0;c<o.length;c++){var d=o[c];a.hasOwnProperty(d)||s.push(d.map(l))}s.forEach(function(e){i.getNodesByIDPath(e).forEach(function(e){e._filterStatus="IN",e.getParents().forEach(function(e){e._filterStatus="IN"})})});n.forEach(function(e){!function e(t,i){if("IN"===t._filterStatus){var n=t.getChildren();n&&n.length>0&&n.slice(0).forEach(function(t){e(t)})}else t.filterOut(),i&&i.push(t),!0;delete t._filterStatus}(e);var t=!1;if(e.options._childrenFilterInfo){var i=e.options._childrenFilterInfo.filteredOutChildren;i&&i.length>0&&(t=!0)}t&&(e.setState({state:"partiallyExpanded"}),e.options.padstate="partiallyExpanded"),t=!1})}else console.error("Invalid Argument : %o",e);t.onSetPathTags()})})},onGroupingEvent:function(e){var t=this,i=widget.getValue("component-view");t.options.fromGroupingEvent=!0;var n=l.getFLWebModelEventsObj("flweb-model-events"),s=n.subscribe({event:"flcockpit-filterBI-applyGrouping-done"},function(e){n.unsubscribe(s),t.options.fromGroupingEvent&&(t._biFilter.setGroupingStatus(e),delete t.options.fromGroupingEvent)});"structured-view"!==i?(r.alertMessage("error",null,f.error_action_unavailable_in_flattened_view),n.publish({event:"flcockpit-filterBI-applyGrouping-done",data:{status:!1}}),t._biFilter._biFilter.myTagProxy.clearLocalGrouping()):(e.fromGroupingEvent=!0,o._applyGrouping(t,e))},onFilterClose:function(e){},_createProxy:function(){var e=this,t={tenant:s.getTenant(),processingMode:"appProcessing",colorize:!0,widgetId:widget.id,appId:widget.id,enableGrouping:{},ExpandSynthesisON:!0};UWA.is(e.onFilterFilteringEvent,"function")&&(t.events={addFilterChangeListener:e.onFilterFilteringEvent.bind(e)}),e._biFilter=new n(t),e._biFilter.addEvent("TagsLoadingComplete",e.onTagsLoadingComplete,e),e._biFilter.addEvent("NGFilter_Close",e.onFilterClose,e),e._biFilter.addEvent("FilterBIColorize",e.onFilterBIColorize,e),e._biFilter.addEvent("FilterBIUnColorize",e.onFilterBIUnColorize,e),e._biFilter.addEvent("FilterBIFilteringEvent",e.onFilterBIFilteringEvent,e),e._biFilter.addEvent("FilterBIGroupingEvent",e.onGroupingEvent,e);var i=e.options.model;if(void 0!==i&&(e.options.model.getModelEvents().subscribe({event:"onRootAdded"},e.onSetTagsWithExpandSynthesis.bind(e)),e.options.model.getModelEvents().subscribe({event:"colorizeNodesFromTagger"},function(){e.colorizeActivated&&e.colorizeNodes()})),UWA.is(e._biFilter.setNGFilterOptions,"function")){var o={expandServices:["progressive","expand"],appId:widget.id};e._biFilter.setNGFilterOptions(o),e._biFilter.addEvent("ApplyNGFilter",e.onApplyNGFilter,e),void 0!==i&&(e.options.model._isVolumeFilter=!0)}e.filterInitialized=!0,e.dispatchEvent("filterInitialized",e.filterInitialized)},updateModel:function(e){var t=this;t.options.view=e,t.options.model=e.treeDocument,t.options.model.getModelEvents().subscribe({event:"onRootAdded"},t.onSetTagsWithExpandSynthesis.bind(t)),t.options.model.getModelEvents().subscribe({event:"colorizeNodesFromTagger"},function(){t.colorizeActivated&&t.colorizeNodes()}),t.options.model._isVolumeFilter=!0,o.isGroupingApplied()&&(t._biFilter._biFilter.myTagProxy.clearLocalGrouping(),o.cleanGrouping({roots:[]}))},retrieveFilterInfo:function(e,t){var i=t.objectId;this._biFilter.retrieveFilters({filterObjects:[t],droppedEnvId:widget.getValue("x3dPlatformId"),doNotFillTheTagger:!1,callback:this.processFilterInfo.bind(this,e,i)})},processFilterInfo:function(e,t,i){var n=this;if(i&&Array.isArray(i.success)&&i.success.length>0){var o=i.success[0],a=o.rootId,c={filterRootIds:[a],empty:!1,filterName:o.filterName,filterTitle:o.filterTitle,filterId:t,CVQuery:o.filter.CVQuery,CVQueryV2:o.filter.CVQueryV2};e.itemId!==a?u.getKindOfRFLP([a]).then(function(t){if(t&&"L"===t[0]){var i=l.getFLWebModelEventsObj("flcockpit-content-list-view"),o=i.subscribe({event:"content-list-view-refresh-complete"},function(e){r.isItemAuthored(),i.unsubscribe(o),n.crRecTimeoutToCheckTreeDocExp(e,c)});e.load(a)}else{r.alertMessage("error",null,f.error_invalid_filter);var d=widget.getValue("ngFilter");if(d&&d.length>0){var u=JSON.parse(d);u.filterId?e.contentListView.catflBIFilter._biFilter.retrieveFilters({filterObjects:[{envId:s.getTenant(),serviceId:"3DSpace",contextId:"ctx::"+s.getSecurityContext(),objectId:u.filterId,objectType:h.type_act_advfilter,displayName:u.filterTitle}],droppedEnvId:s.getTenant(),doNotFillTheTagger:!1}):(e.contentListView.catflBIFilter._biFilter.resetNGFilterUI({appId:widget.id,widgetId:widget.id,rootIds:[e.itemId]}),e.contentListView.catflBIFilter._biFilter.removeRoot(e.itemId),c={filterRootIds:[e.itemId],empty:!0,filterName:""},r.alertMessage("warning",null,f.warn_clear_filter),e.contentListView.catflBIFilter._biFilter.dispatchEvent("ApplyNGFilter",c))}}}):r.isItemAuthored()?r.alertMessage("warning",null,f.warn_filter_only_indexed_mode):(n.onSetTagsWithExpandSynthesis(),e.contentListView.catflBIFilter._biFilter.dispatchEvent("ApplyNGFilter",c))}else i&&Array.isArray(i.failure)&&i.failure.length>0&&r.alertMessage(i.failure[0].eventID,null,i.failure[0].msg)},crRecTimeoutToCheckTreeDocExp:function(e,t){var i=this;e.contentListView&&e.contentListView.contentView.treeDocument&&(e.contentListView.contentView.treeDocument.isExpanding()?setTimeout(function(){i.crRecTimeoutToCheckTreeDocExp(e,t)},200):e.contentListView.catflBIFilter._biFilter.dispatchEvent("ApplyNGFilter",t))}})}),define("DS/CATFLCockpitWidget/CATFLCockpitWidgetComponent",["DS/CoreEvents/ModelEvents","DS/UIKIT/Mask","DS/Windows/ImmersiveFrame","DS/ENOXTriptych/js/ENOXTriptych","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/CATFLCockpitWidget/components/IDCard/idcard.controller","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.controller","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.effectivity","DS/CATFLCockpitWidget/components/PropertiesPanel/propertiespanel.controller","DS/CATFLCockpitWidget/components/WelcomePanel/welcomepanel.controller","DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCues.controller","DS/CATFLCockpitWidget/components/ArchitectureNumber/checkArchitectureNumberUnicity","DS/CATFLCockpitWidget/utils/checkArchitectureNumberUnicity.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/search.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/mixins/CATFLBIFilter","DS/PlatformAPI/PlatformAPI","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,g,m,f,h,v,C,b,y,_,D,S){"use strict";var w=m.getFullConfig(),I=w.identifiers,A=w.localStorageKeys;return h.configureSearch(),{init:function(e){var t=this;f.clearSubscriptionList();var n=f.createAppEventObject("flweb-model-events"),r=UWA.createElement("div");r.classList.add("fl-cockpit-app-container"),widget.immersiveFrame=new i({}),widget.immersiveFrame.setContentInBackgroundLayer(r),widget.immersiveFrame.inject(e),t._initTriptychComponent(r),d.init(t),t.contentListView=s.init(t.contentListContainer),t.welcomePanelController=c.init(t.triptych.getLeftPanelContent()),t.propertiesPanel=l.init(t.triptych.getRightPanelContent(),t.contentListView.contentView),t.contentListView.modelEvents.subscribe({event:"selected-item-changed"},function(e){var i=t.triptych._rightPanelContent.getElementsByClassName("EditProp_MasterContain");i&&i[0].isHidden()&&i[0].show(),t.propertiesPanel.loadModel(e,"businessobject")}),t.contentListView.modelEvents.subscribe({event:"open-properties-panel"},function(){t.triptych.modelEvents.publish({event:"triptych-show-panel",data:"right"})}),t.contentListView.modelEvents.subscribe({event:"close-properties-panel"},function(){t.triptych.modelEvents.publish({event:"triptych-hide-panel",data:"right"})}),t.propertiesPanel.modelEvents.subscribe({event:"properties-panel-on-save"},function(e){e.indexOf(t.itemId)>=0&&n.publish({event:"idcard-refresh"})});var u=widget.getValue("previouslyOpenedItems");u&&(t.previouslyOpenedItems=JSON.parse(u));var p=widget.getValue("X3DContentId");if(t.previouslyOpenedItems&&t.previouslyOpenedItems.length>0){let e,i=widget.getValue("ngFilter"),n=t.previouslyOpenedItems[t.previouslyOpenedItems.length-1];if(i&&i.length>0&&(e=JSON.parse(i)),e&&e.filterId){t.contentListView.catflBIFilter=new _({view:t.contentListView.contentView}),delete t.itemId,n&&t.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:n});let i={envId:m.getTenant(),serviceId:"3DSpace",contextId:"ctx::"+m.getSecurityContext(),objectId:e.filterId,objectType:I.type_act_advfilter,displayName:e.filterTitle};t.contentListView.catflBIFilter.retrieveFilterInfo(t,i)}else i&&(t.contentListView.catflBIFilter||(t.contentListView.catflBIFilter=new _({view:t.contentListView.contentView})),n&&t.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:n})),t.load(n,!0)}else if(p){var h=JSON.parse(p).data.items;if(h.length>1)g.alertMessage("error",null,S.error_open_several_obj);else{var C=h[0],b=C.objectId,y=C.objectType;if(C.envId=C.envId?C.envId:m.getTenant(),y&&""!==y)if(y===I.type_act_advfilter){t.contentListView.catflBIFilter=new _({});var w=t.contentListView.contentView.treeDocument.getRoots()[0];w&&t.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:w.getID()}),t.contentListView.catflBIFilter.retrieveFilterInfo(t,C)}else v.getKindOfRFLP([b]).then(function(e){e&&"L"===e[0]?t.load(b):g.alertMessage("error",S.msg_invalid_type,S.msg_open_invalid_type)});else{var A=[];A.push(b),v.getItemInfo(A).then(function(e){(e=e.member).forEach(function(e){if(e.type===I.type_act_advfilter){t.contentListView.catflBIFilter=new _({});var i=t.contentListView.contentView.treeDocument.getRoots()[0];i&&t.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:i.getID()}),t.contentListView.catflBIFilter.retrieveFilterInfo(t,e)}else v.getKindOfRFLP([b]).then(function(e){e&&"L"===e[0]?t.load(b):g.alertMessage("error",S.msg_invalid_type,S.msg_open_invalid_type)})})})}}}t.previouslyOpenedItems||(t.previouslyOpenedItems=[]),n.subscribe({event:"flweb-load-item"},function(e){if(t.load(e.itemPID),t.contentListView.catflBIFilter){var i=t.contentListView.contentView.treeDocument.getRoots()[0];i&&t.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:i.getID()})}}),n.subscribe({event:"flweb-drop-item"},function(e){t.manageIDCardDrop(e.item)}),n.subscribe({event:"allmod-selection-successful"},t.updateUserPrefOnItemConf.bind(t,"allmod-selection-successful")),n.subscribe({event:"mod-PC-selection-successful"},t.updateUserPrefOnItemConf.bind(t,"mod-PC-selection-successful")),n.subscribe({event:"mod-selection-removed"},t.updateUserPrefOnItemConf.bind(t,"mod-selection-removed")),widget.bSubscribedToCfgEvents||(D.subscribe("cfgEditConfigurationContextModification_"+widget.id,a.modifiedEditCfgCtx.bind(t)),D.subscribe("cfgEffectivityModifications_"+widget.id,a.refreshEffectivityChanges.bind(t)),D.subscribe(o.myAuthkey,function(e){var i=e.change,n={};n.type=I.workUnder_change,n.id=i.id,n.name=i.name,n.id&&t.updateUserPrefOnWorkUnder(n,"active")}),D.subscribe("sessionEff",function(e){var i={};i.type=I.workUnder_evolution,i.ACId=e.ACId,i.evolutionExpression=e.evolutionExpression,i.dictionaryContext=e.dictionaryContext,i.displayExpression=e.displayExpression,i.ACId&&t.updateUserPrefOnWorkUnder(i,"active")}),D.subscribe("toggleActiveSE"+o.myAuthkey,function(){t.updateUserPrefOnWorkUnder(null,"active")}),D.subscribe("toggleDeActiveSE"+o.myAuthkey,function(e){t.updateUserPrefOnWorkUnder(null,"deactive")}),D.subscribe("removeAuthCtxSessionEvent"+o.myAuthkey,function(e){t.updateUserPrefOnWorkUnder(null,"remove")}),D.subscribe("toggleActiveCA"+o.myAuthkey,function(e){t.updateUserPrefOnWorkUnder(null,"active")}),D.subscribe("toggleDeActiveCA"+o.myAuthkey,function(e){t.updateUserPrefOnWorkUnder(null,"deactive")}),D.subscribe("removeAuthCtxEvent"+o.myAuthkey,function(e){t.updateUserPrefOnWorkUnder(null,"remove")}),widget.bSubscribedToCfgEvents=!0)},load:function(e,t){var i=this,n={},r=[];""!==e?(t||i.previouslyOpenedItems[i.previouslyOpenedItems.length-1]===e||i.previouslyOpenedItems.push(e),i.itemId=e,widget.setValue("currentOpenedItem",i.itemId),widget.setValue("previouslyOpenedItems",JSON.stringify(i.previouslyOpenedItems)),widget.deleteValue("ngFilter"),widget.setValue("evolutionView",I.view_evolution_current),r.push(b.getLogItemAttributes(e)),r.push(b.getLogItemModel(e)),r.push(v.getUserPreferences(I.user_pref_openedItems_conf)),r.push(v.getUserPreferences(I.user_pref_workunder)),y.makeMultipleServiceCalls(r,!0).then(function(t){if(n.itemData=t[0],n.modelData=t[1],n.usrPrfItemConf=t[2],n.usrPrfWorkUnder=t[3],n.usrPrfWorkUnder){var r=UWA.is(n.usrPrfWorkUnder,"string")?JSON.parse(n.usrPrfWorkUnder):n.usrPrfWorkUnder,s=()=>{"deactive"===r.status?o.deactivateBubble():o.activateBubble()};if(r.type===I.workUnder_change){var a={change:{id:r.id,name:r.name}};o.set(a,s)}else if(r.type===I.workUnder_evolution){a={ACId:r.ACId,evolutionExpression:r.evolutionExpression,dictionaryContext:r.dictionaryContext,displayExpression:r.displayExpression};o.setEffectivity(a,s)}}g.cleanDragNDrop(i.contentListView.contentView.getContent()),widget.setTitle(n.itemData.attributes.label),n.modelData&&n.modelData.length>0?widget.setValue("modelAttached",n.modelData):(widget.setValue("modelAttached",null),widget.setValue("currentConfig",null)),i._createIdCard(n),i.contentListContainer.getElementsByClassName("modelPCSelector").length&&(i.contentListContainer.getElementsByClassName("modelPCSelector")[0].destroy(),i.contentListContainer.getElementsByClassName("modal-overlay in")[0].destroy()),n.modelData&&n.modelData.length>0?i._loadItemWithConfigCtx(n.modelData,n.usrPrfItemConf):i.contentListView.refresh(e)}).catch(function(e){i.previouslyOpenedItems=[],g.makeDroppable(i.contentListView.contentView.getContent(),S.msg_drop_to_open,i.contentListView.manageDropInGridView.bind(i.contentListView))}),i.propertiesPanel.loadModel([{physicalid:i.itemId,rootPID:i.itemId}],"businessobject")):g.alertMessage("error",null,S.error_non_existing_item)},_loadItemWithConfigCtx:function(e,t){var i=this,n=f.getFLWebModelEventsObj("flweb-model-events"),o=widget.getValue("currentConfig");t=t&&UWA.is(t,"string")?JSON.parse(t):t;var r=[];if(e.forEach(function(e){r.push(e.physicalid)}),t){var s,a,l,c=t[i.itemId];if(c&&(s=c.model,a=c.modelVersion,l=c.pc),!c||r.indexOf(s)<0)return void n.publish({event:"allmod-selection-successful",data:{itemID:i.itemId}});var d=[];s&&d.push(s),a&&d.push(a),l&&d.push(l),v.getItemInfo(d).then(function(e){var t,o,r;(e=e.member).forEach(function(e){e.type===I.type_model?((t={}).physicalid=e.physicalid,t.name=e.name,t.id=e.objectid):e.type===I.type_products?((o={}).physicalid=e.physicalid,o.backEndName=e.name,o.name=e.title,o.revision=e.revision,o.current=e.current):I.type_productConfiguration&&((r={}).physicalid=e.physicalid,r.name=e.title,r.filterCompiledForm=e.filterCompiledForm)}),r?n.publish({event:"mod-PC-selection-successful",data:{itemID:i.itemId,model:t,modelVer:o,pc:r,filterCompiledForm:r.filterCompiledForm}}):C.createVolatileFilter({modelID:t.physicalid,modelName:t.name,modelVerName:o.backEndName,modelVerRev:o.revision}).then(function(e){n.publish({event:"mod-PC-selection-successful",data:{itemID:i.itemId,model:t,modelVer:o,pc:null,filterCompiledForm:e.filterBinaryForExpand}})})})}else{var u;o&&(u=o.model?o.model.physicalid:o.physicalid),(!o||u&&r.indexOf(u)<0)&&n.publish({event:"allmod-selection-successful",data:{itemID:i.itemId}})}},_initCfgAuthoringContext:function(e){var t=g.getUserWorkUnderPositionPref();if(o.initialize2(e,widget.getValue("appId"),"show",t,function(e){console.warn(e)},{isEditable:!0,isEvolution:!0,isChange:!0,isMovable:!0,resetDefault:!1}),t===I.workUnder_pos_freeValue){var i=widget.getValue("bubble-top"),n=widget.getValue("bubble-left"),r=e.querySelector("#BubbleContainer");r&&(i&&n&&r.setStyles({top:i,left:n}),g.setCfgAuthoringContextDragEvent(e))}},_initTriptychComponent:function(e){var t=f.createAppEventObject("flweb-triptych-model-events"),i={left:{resizable:!0,overMobile:!1,minWidth:300},right:{resizable:!0,overMobile:!1},container:e,withtransition:!0,modelEvents:t},o=document.createElement("div");o.classList.add("fl-cockpit-triptych-main-container","fl-cockpit-idcard-container-hidden"),this.idcardContainer=document.createElement("div"),this.idcardContainer.classList.add("fl-cockpit-idcard-container"),this.contentListContainer=document.createElement("div"),this.contentListContainer.classList.add("fl-cockpit-content-list-container"),o.appendChild(this.idcardContainer),o.appendChild(this.contentListContainer);var r=document.createElement("div");r.classList.add("fl-cockpit-triptych-right-container");var s=document.createElement("div");s.classList.add("fl-cockpit-triptych-left-container"),this._initCfgAuthoringContext(o),this.triptych=new n,this.triptych.init(i,s,o,r),this.triptych.modelEvents=t},_createIdCard:function(e){var t=this;t.idcardContainer.innerHTML="",t.triptych.getMainPanelContainer().querySelector(".fl-cockpit-triptych-main-container").classList.remove("fl-cockpit-idcard-container-hidden"),e.contentView=t.contentListView.contentView;var i=t.idcard=r.init(t.idcardContainer,e,t.triptych.modelEvents,t.previouslyOpenedItems&&t.previouslyOpenedItems.length>1);i.idcardModelEvents.subscribe({event:"triptych-toggle-panel"},function(){var e=g.formObjForEditProp(t.contentListView.contentView.treeDocument.getSelectedNodes());t.contentListView.modelEvents.publish({event:"selected-item-changed",data:e}),t.triptych.modelEvents.publish({event:"triptych-toggle-panel",data:"right"})}),i.idcardModelEvents.subscribe({event:"welcome-panel-toggle"},function(){t.triptych.modelEvents.publish({event:"triptych-toggle-panel",data:"left"})}),i.idcardModelEvents.subscribe({event:"idcard-back"},function(){if(t.previouslyOpenedItems.length>1){t.previouslyOpenedItems.pop();var e=t.previouslyOpenedItems[t.previouslyOpenedItems.length-1];t.load(e,!0);var i=t.contentListView.contentView.treeDocument.getRoots()[0];i&&t.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:i.getID()})}}),i.idcardModelEvents.subscribe({event:"check-unicity-AN"},function(){if(widget.getPreference(A.disableIndexAcceleration).value||g.isItemAuthored())g.alertMessage("warning",null,S.warn_check_an_duplication_only_indexed_mode);else{var e=[],i=t.contentListView.contentView.treeDocument.getRoots()[0],n=[];i&&(n=i.getChildren()),e.push(p.updateEffectivityCompiledFormForNodes(n));var o;o=n.filter(function(e){return e.options.grid.architectureNumber&&!e.options.linkInfo&&"RFLVPMLogicalReference"===e.options.type&&e.options.instance}),Promise.all(e).then(function(e){var t=[{dataIndex:"revision",text:w.nlsBasicAttributesBO["ds6wg:revision"],textExport:w.nlsBasicAttributesBO["ds6wg:revision"],visibleFlag:!0,editableFlag:!1,pinned:"left",width:90,index:1},{icon:{iconName:"object-instance"},dataIndex:"instanceName",text:w.nlsBasicAttributesBO["ds6w:label"],textExport:S.label_title_instance,visibleFlag:!0,editableFlag:!1,index:2}];new u({refWithConfig:i,nodesToCheck:o,gridViewAdditionalColumns:t})})}}),g.makeDroppable(t.idcardContainer.querySelector(".xapp-id-card-container"),S.msg_drop_to_open,t.manageIDCardDrop.bind(t))},manageIDCardDrop:function(e){var t=this,i=f.getFLWebModelEventsObj("flweb-model-events");if(e&&e.length>0&&e[0].envId!==m.getTenant()){if(!g.validateTenant(e[0]))return;t.previouslyOpenedItems=[],t.contentListView.catflBIFilter&&(t.contentListView.catflBIFilter._biFilter._biFilter._tenantId=m.getTenant())}if(e&&e.length>0&&e[0].objectType===I.type_act_advfilter){var n=e[0],o=t.contentListView.catflBIFilter;o||(o=new _({view:t.contentListView.contentView}),t.itemId=e[0].objectId);var r=t.contentListView.contentView.treeDocument.getRoots()[0];r&&o.removeRootFromFilterProxy({rootId2remove:r.getID()}),o.retrieveFilterInfo(t,n),i.publish({event:"flweb-drop-success"})}else e&&e.length>0?v.getKindOfRFLP([e[0].objectId]).then(function(n){if(n&&"L"===n[0]){if(t.load(e[0].objectId),t.contentListView.catflBIFilter){var o=t.contentListView.contentView.treeDocument.getRoots()[0];o&&t.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:o.getID()})}i.publish({event:"flweb-drop-success"})}else g.alertMessage("error",null,S.msg_drop_invalid_type)}).catch(function(e){g.displayError(e,null,null,S.msg_drop_invalid_type)}):g.alertMessage("error",null,S.msg_drop_invalid_type)},updateUserPrefOnItemConf:function(e,t){v.getUserPreferences(I.user_pref_openedItems_conf).then(function(i){if(i){var n=UWA.is(i,"string")?JSON.parse(i):i,o=!1;if("allmod-selection-successful"===e||"mod-selection-removed"===e)n[t.itemID]&&(delete n[t.itemID],o=!0);else{if(!n[t.itemID]){if(Object.keys(n).length==I.limit_usrPref_openedItems_conf)delete n[Object.keys(n)[0]];n[t.itemID]={}}n[t.itemID].model=t.model.physicalid,n[t.itemID].modelVersion=t.modelVer.physicalid,n[t.itemID].pc=t.pc?t.pc.physicalid:null,o=!0}o&&v.setUserPreferences({name:I.user_pref_openedItems_conf,value:JSON.stringify(n)}).then(function(){})}})},updateUserPrefOnWorkUnder:function(e,t){e&&t?(e.status=t,v.setUserPreferences({name:I.user_pref_workunder,value:JSON.stringify(e)}).then(function(){})):"active"===t||"deactive"===t?v.getUserPreferences(I.user_pref_workunder).then(function(e){if(e){var i=UWA.is(e,"string")?JSON.parse(e):e;i.status=t,v.setUserPreferences({name:I.user_pref_workunder,value:JSON.stringify(i)}).then(function(){})}}):v.setUserPreferences({name:I.user_pref_workunder,value:null}).then(function(){})}}}),define("DS/CATFLCockpitWidget/components/VersionExplorer/versionexplorer.controller",["UWA/Core","DS/UIKIT/Mask","DS/UIKIT/Input/Toggle","DS/ENOFloatingPanel/ENOFloatingPanel","DS/ENOXVersionExplorerController/VersionExplorerController","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/refresh.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/model.service","DS/ApplicationFrame/ActionBar","DS/CATFLCockpitWidget/CATFLCockpitWidgetComponent","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,g,m,f,h,v){"use strict";f=JSON.parse(f);var C=JSON.parse(h);return new g({context:{displayNotification:function(e){"error"===e.eventID?l.alertMessage("error",null,e.msg):"warning"===e.eventID?l.alertMessage("warning",null,e.msg):l.alertMessage("success",null,e.msg)}},file:"CATFLCockpitWidgetAFR.xml",module:"CATFLCockpitWidget"}),{initializeVersionExplorer:function(t){var i=e.createElement("div",{class:"arch-version-expl-content"});if(widget.getValue("currentConfig")){var r=e.createElement("div",{class:"evolution-view-content"}).inject(i);this.createEvolutionView(r)}var s=e.createElement("div",{class:"version-expl-content"}).inject(i),a=e.merge(t,{className:"fl-cockpit-version-expl",body:i,closable:!0,animate:!0,resizable:!0,autocenter:!0,visible:!0,limitParent:!0,overlay:!0,title:v.revision_explorer,events:{onClose:function(){}}});return this._verExplDlg=new n(a),this._verExplDlg.onClose=this.onVersionExplClose.bind(this),this.versionGraphComponent=new o({versionGraphContainer:s,widget:widget}),this.callBackOnVersionCreation=t.versionCreationCallBack?t.versionCreationCallBack:null,this.versionGraphComponent.subscribeEvent("ENOXVersionExplorerOpenVersion",this.openVersion.bind(this,t.modelKey.isReplaceCall?t.modelKey.isReplaceCall:null)),this.versionGraphComponent.subscribeEvent("ENOXVersionExplorerNewVersionCreated",this.onNewVersionCreation.bind(this)),this.versionGraphComponent},onNewVersionCreation:function(e){this.callBackOnVersionCreation&&this.callBackOnVersionCreation(),l.setAuthoringMode(),a.SAXStorage().setItem(C.recentlyAuthored+e.options.id,Date.now())},displayVersionGraph:function(e){var t=this;t.oldEvolValue=widget.getValue("evolutionView"),t.options=e;var i=e.modelKey;this.versionGraphComponent&&delete this.versionGraphComponent,t.initializeVersionExplorer(e),t.versionGraphComponent.setCheckVersionExternalFunction("ENOXVersionExplorerCreateNewRevision",function(){return t.isCreateNewRevision(i)}),t.versionGraphComponent.setCheckVersionExternalFunction("ENOXVersionExplorerDeleteVersion",function(){return e.modelKey.isConfigured}),t.versionGraphComponent.setCheckVersionExternalFunction("ENOXVersionExplorerShowMaturity",function(){return e.modelKey.isConfigured}),t.versionGraphComponent.setCheckVersionExternalFunction("ENOXVersionExplorerCreateNewBranch",function(){return e.modelKey.isConfigured}),t.versionGraphComponent.setCheckVersionExternalFunction("ENOXVersionExplorerDuplicate",function(){return e.modelKey.isConfigured}),t.versionGraphComponent.setCheckVersionExternalFunction("ENOXVersionExplorerOpenVersion",function(e){return!0}),t.versionGraphComponent.publishEvent("ENOXVersionExplorerLoadVersionModel",{id:i.id,type:i.kind,dataModelType:r.DATA_MODEL_TYPES.MODEL_ER,securityContext:a.getSecurityContext(),tenantId:a.getTenant(),onComplete:function(){t.versionGraphComponent.publishEvent("ENOXVersionExplorerSetActiveVersion",{id:i.id})}}),t._verExplDlg.inject(widget.body)},openSelectedVersion:function(e){t.mask(widget.body,v.msg_loading);var i=this,n=e.options.id,o=i.options.modelKey;if(o.kind===f.type_modelVersion){var r=e.options.grid,s={physicalid:r.physicalid?r.physicalid:r.id,name:r.title,revision:r.revision,current:r.current,backEndName:o.modelVer.backEndName},a=d.getFLWebModelEventsObj("flweb-model-events");p.createVolatileFilter({modelID:o.model.physicalid,modelName:o.model.name,modelVerName:s.backEndName,modelVerRev:s.revision}).then(function(e){a.publish({event:"mod-PC-selection-successful",data:{itemID:o.itemData.physicalid,model:o.model,modelVer:s,pc:null,filterCompiledForm:e.filterBinaryForExpand}}),i._verExplDlg.destroy()})}else{n=e.options.id;d.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:n}}),i.versionGraphComponent.publishEvent("ENOXVersionExplorerSetActiveVersion",{id:n})}t.unmask(widget.body),i._verExplDlg.destroy()},openVersion:function(e,t){(t&&t.options?t.options.id:null)&&!e&&this.openSelectedVersion(t)},isCreateNewRevision:function(e){return e.kind!==f.type_modelVersion},createEvolutionView:function(t){var n=widget.getValue("evolutionView"),o=e.createElement("div",{class:"evolution-subview"}).inject(t);e.createElement("div",{class:"header-evol-subview",html:v.header_evolution_view}).inject(o);var r=e.createElement("div",{class:"official-toggle-evol-subview"}).inject(o),s=new i({name:"officialToggle",value:"officialToggle",className:"primary",label:v.label_official_view,checked:!1,events:{onChange:function(e,t){this.isChecked()&&(l.uncheck(),widget.setValue("evolutionView",f.view_evolution_current))}}}).inject(r),a=e.createElement("div",{class:"projected-toggle-evol-subview"}).inject(o),l=new i({name:"projectedToggle",value:"projectedToggle",className:"primary",label:v.label_projected_view,checked:!1,events:{onChange:function(e){this.isChecked()&&(s.uncheck(),widget.setValue("evolutionView",f.view_evolution_projected))}}}).inject(a);n===f.view_evolution_current?s.check():l.check()},onVersionExplClose:function(){var e=this,t=widget.getValue("currentConfig"),i=d.getFLWebModelEventsObj("flweb-model-events");e.oldEvolValue!==widget.getValue("evolutionView")?(p.createVolatileFilter({modelID:t.model.physicalid,modelName:t.model.name,modelVerName:t.modelVersion.backEndName,modelVerRev:t.modelVersion.revision}).then(function(n){i.publish({event:"mod-PC-selection-successful",data:{itemID:e.options.modelKey.itemData.physicalid,model:t.model,modelVer:t.modelVersion,pc:null,filterCompiledForm:n.filterBinaryForExpand}})}),e._verExplDlg.destroy()):e._verExplDlg.destroy()}}}),define("DS/CATFLCockpitWidget/components/ContextualMenu/contextualmenu.factory",["DS/UIKIT/Mask","DS/CfgBaseUX/scripts/CfgData","DS/CATFLCockpitWidget/components/BulkEdition/BulkEditionDialog","DS/CATFLCockpitWidget/components/ConfirmationWindow_Generic/ConfirmationWindow","DS/CATFLCockpitWidget/components/ContextualMenu/contextualmenu.actions","DS/CATFLCockpitWidget/components/DisciplineIterations/consolidateDefinition","DS/CATFLCockpitWidget/components/DisciplineIterations/lastOutfittedState.compare","DS/CATFLCockpitWidget/components/RefineSelection/RefineSelection","DS/CATFLCockpitWidget/components/SpaceAssignment/Copy/SpaceAssignmentCopy","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.attachment","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.creation","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.replace","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.deletion","DS/CATFLCockpitWidget/components/ImplementLinks/implementLinks.controller","DS/CATFLCockpitWidget/components/SpaceAssignment/SpaceAssignment","DS/CATFLCockpitWidget/components/VersionExplorer/versionexplorer.controller","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/document.service","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/gridview.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/group.util","DS/CATFLCockpitWidget/mixins/CATFLBIGroup","DS/CATFLCockpitWidget/components/CommandsCtrl/command.controller","DS/CATFLCockpitWidget/commands/RelatedObjectCmd","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget","DS/CATFLCockpitWidget/utils/DisplayConnectedDIFStructure.util"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,g,m,f,h,v,C,b,y,_,D,S,w,I,A,F){"use strict";var k=b.getFullConfig(),E=function(e,t,i,n,o,r){var s={type:"PushItem",title:e};return r&&(s.icon=r),t&&(s.fonticon={family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-"+t}),i&&(s.action={callback:i.bind(x)}),n&&(s.state="disabled",o&&(s.tooltip=o)),s},T=function(e){var t=[];e[0].getRoot().options.physicalid;return e.forEach(function(e){var i=e.getParent(),n=e.options.instance;t.push({physicalid:e.options.physicalid,label:e.options.label,type:e.options.type,relID:n&&n.physicalid?n.physicalid:"",parent:{physicalid:i&&i.options?i.options.physicalid:""}})}),t},x={createAddToConfigurationRevisionMenu:function(e,t){return E(A.add_to_config_rev,"configuration-add",function(){var i={items:o.getNodeInfoForEffectivity(t,e)};w.init("AddToConfigurationRevisionCmd",i)})},createSpaceAssignmentMenu:function(e,t){return E(A.action_assign_space,"space-management",function(){e.options.assignedSpacesPID?new m(e):y.addAssignedSpacesAttribute([e]).then(()=>{new m(e)})},t,A.error_action_unavailable_in_release)},createCollapseAllMenu:function(e){return E(A.action_collapse_all,"flow-tree-expand-up",function(){e.forEach(function(e){e.collapseAll()})})},createCompareWithLastOutfitted:function(e,t){return E(A.compareWithLastOutfitted,"part-compare",function(){var i=e[0].options.maturity;-1==i.indexOf("PRIVATE")&&-1==i.indexOf("IN_WORK")||C.alertMessage("warning",null,A.warn_incomplete_definition),new s({selectedNodes:e,view:t}).render()})},createConsolidateLogicalDefinitionMenu:function(e,t){return E(A.header_consolidate_log_defn,"merge",function(){new r({selectedNodes:e,view:t.collectionView}).render()})},createCompareMenu:function(e){return E(A.compare,"part-compare",function(){var t=[];e.forEach(function(e){t.push({physicalid:e.options.physicalid,label:e.options.label})}),w.init("CompareCmd",t)})},createCopyMenu:function(e,t,n){var o=E(A.action_copy,"copy");return o.submenu=[E(A.label_copy_attributes,"attributes",function(){i.open(e[0],t.collectionView),n.dataCopied="attributes-copied"}),E(A.label_space_assignement_copy_2,"space-management",function(){l.open(e[0],t.collectionView.treeDocument),n.dataCopied="spaces-copied"})],o},createPasteCommand:function(e,t,n){return"attributes-copied"===t.dataCopied?E(A.label_paste_attributes,"paste",function(){t.dataCopied=null,i.submit()},n,A.error_action_unavailable_in_release):E(A.label_space_assignement_copy,"paste",function(){t.dataCopied=null,l.validateAndSubmit()},n,A.error_action_unavailable_in_release)},createCreateImplementLinkOccToOccMenu:function(e,t){return E(A.action_create_implrel_occ2occ,"convergence-state",function(){g.manageOcc2OccImplRel({selectedNode:e[0]})},t,A.error_action_unavailable_in_release)},createCreateImplementLinkRefToRefMenu:function(e,t){return E(A.action_create_implrel_ref2ref,"convergence-state",function(){g.manageRef2RefImplRel({selectedNode:e})},t,A.error_action_unavailable_in_release)},createDeleteImplementLinkMenu:function(e,t,i,o){return E(A.action_delete_impl_rel,"remove",function(){var o=A.label_delete_implementLink_header+" - ";1===e.length?o+=e[0].options.label:o+=e.length+" "+A.label_objects;var r=UWA.createElement("p",{html:A.msg_delete_manyimplementLink_confirmation});n.createWindow(widget.body,o,r,A.action_delete,function(){g.deleteImplRel({treeDocument:i.collectionView.treeDocument,rootNode:t,selectedNodes:e})})},o,A.error_action_unavailable_in_release)},createDetachMenu:function(t,i,o,r,s){var a=E(A.label_detach,"tree-delete",function(){var s=UWA.createElement("div");UWA.createElement("p",{html:A.msg_detach_log_confirm}).inject(s),o&&UWA.createElement("div",{class:"warn-stable-with-archno",html:'<span class="wux-ui-3ds wux-ui-3ds-attention" style=""></span>'+A.warn_detach_item_with_archNo}).inject(s),!o&&r&&UWA.createElement("div",{class:"warn-stable-with-archno",html:'<span class="wux-ui-3ds wux-ui-3ds-attention" style=""></span>'+A.warn_detach_stable_item}).inject(s);var a=A.label_detach+" - ";1===t.length?a+=t[0].options.label:a=a+t.length+" "+A.label_objects,n.createWindow(widget.body,a,s,A.label_detach,function(){e.mask(i.collectionView.getContent(),A.msg_processing),p.deleteLogItemInstance(i)})});return"structured-view"!==widget.getValue("component-view")?(a.state="disabled",a.tooltip=A.error_action_unavailable_in_flattened_view):s&&(a.state="disabled",a.tooltip=A.error_action_unavailable_in_release),a},createDisplayMoreAttributesMenu:function(e,t,i){return E(A.action_display_more_attributes,"attributes-add",function(){h.displayMoreAttributes(e,t,i)})},createDocumentDownloadMenu:function(e){return E(A.action_download,"download",function(){var t=[];e.forEach(function(e,i){t.push(e.options.physicalid)}),v.downloadDocument(t).then(function(){C.alertMessage("success",null,A.msg_download_success)})})},createDocumentDetachMenu:function(e){return E(A.label_detach,"tree-delete",function(){c.detachDocuments(e)})},createDuplicateMenu:function(e){return E(A.duplicate,"duplicate",function(){var t=[{physicalid:e.options.physicalid,label:e.options.label,type:e.options.type,displayType:e.options.grid.type,revision:e.options.grid.revision,current:e.options.grid.maturity,icons:e.options.icons}];w.init("DuplicateCommand",t)})},createEditConfigurationContextMenu:function(e,t){return E(A.action_edit_config_ctx,"3dproduct-pencil",function(){var t=[];e.forEach(function(e){t.push({physicalid:e.options.physicalid,label:e.options.label,type:e.options.type,displayType:e.options.grid.type,revision:e.options.grid.revision,owner:e.options.grid.owner,icons:e.options.icons})}),w.init("EditConfigurationContextCmd",t)})},createVariantEffectivityMenu:function(e,i,n,r){var s=E(A.action_variant_effectivity,"variants-and-options",!1);return s.submenu=[],n||(r=!0),s.submenu.push(E(A.action_copy,"copy",function(){var t={items:o.getNodeInfoForEffectivity(i,e),treeDocument:i.collectionView.treeDocument};w.init("CopyVariantEffectivityCmd",t)},r),E(A.label_paste,"paste",function(){var t={items:o.getNodeInfoForEffectivity(i,e),treeDocument:i.collectionView.treeDocument};w.init("PasteVariantEffectivityCmd",t)},!t.isVariantEffAvailable),E(A.action_edit,"pencil",function(){var t={items:o.getNodeInfoForEffectivity(i,e),treeDocument:i.collectionView.treeDocument};w.init("EditVariantEffectivityCmd",t)},r)),s},createEvolutionEffectivityMenu:function(e,i,n,r){var s=E(A.action_evolution_effectivity,"evolution-effectivity",!1);return s.submenu=[],n||(r=!0),s.submenu.push(E(A.action_copy,"copy",function(){var t={items:o.getNodeInfoForEffectivity(i,e),treeDocument:i.collectionView.treeDocument};w.init("CopyEvolutionEffectivityCmd",t)},r),E(A.label_paste,"paste",function(){var t={items:o.getNodeInfoForEffectivity(i,e),treeDocument:i.collectionView.treeDocument};w.init("PasteEvolutionEffectivityCmd",t)},!t.isEvolutionEffAvailable),E(A.action_edit,"pencil",function(){var t={items:o.getNodeInfoForEffectivity(i,e),treeDocument:i.collectionView.treeDocument};w.init("EditEvolutionEffectivityCmd",t)},r),E(A.action_extend_evolution,"evolution-effectivity-extension",function(){var t={items:o.getNodeInfoForEffectivity(i,e)};e instanceof Array&&e.length>1e3&&C.alertMessage("warning",null,A.replace(A.msg_bulkOperation_limitReached,{limit:1e3})),w.init("ExtendEvolutionEffectivityCmd",t)})),s},createExpandMenu:function(e,t){var i,n,r=E(A.action_expand,"flow-tree-expand-down");"structured-view"!==widget.getValue("component-view")&&(i=!0,n=A.error_action_unavailable_in_flattened_view);var s=!1;return S.isGroupingApplied()&&t[0].isRoot()&&(s=!0),r.submenu=[E(A.label_one_level,null,function(){y.expandNodestoNLevel({level:"1",selectedNodes:t,params:e})}),E(A.label_two_levels,null,function(){var i=widget.getValue("currentConfig");i&&i.filterCompiledForm&&i.filterCompiledForm,t.length>1&&C.alertMessage("warning",null,A.msg_expandMultiLvl_multiSelect_warning),y.expandNodestoNLevel({level:"2",selectedNodes:t,params:e})},i,n),E(A.label_all_levels,null,function(){var i=null,n=widget.getValue("currentConfig");n&&n.filterCompiledForm&&(i=n.filterCompiledForm),1===t.length?o.checkInstanceCount(t,i):t.length>1&&C.alertMessage("warning",null,A.msg_expandMultiLvl_multiSelect_warning),y.expandNodestoNLevel({level:"-1",selectedNodes:t,params:e})},i||s,n)],r},createInformationMenu:function(e,t){return E(A.action_information,"info",function(){var i=C.formObjForEditProp(e);t.publish({event:"selected-item-changed",data:i}),t.publish({event:"open-properties-panel"})})},createInsertNewMenu:function(e,t,i){var n=E(A.action_insert_new,"new-create");return n.submenu=[E(A.label_log_ref,!1,function(){t.publish({event:"create-new-logical-item",data:{selectedItem:e[0]}})}),E(A.label_as_specification,!1,function(){d.createDocument(e[0],!0)})],widget.getValue(k.localStorageKeys.componentView)!==k.localStorageKeys.structuredView?(n.state="disabled",n.tooltip=A.error_action_unavailable_in_flattened_view):i&&(n.state="disabled",n.tooltip=A.error_action_unavailable_in_release),n},createInsertExistingMenu:function(e,t,i){var n=E(A.action_insert_existing,"plus");return n.submenu=[E(A.label_log_ref,!1,function(){c.addExistingItem(e[0],t.getContent(),t.treeDocument)}),E(A.label_as_specification,!1,function(){c.addExistingDoc(e[0],!0,t.getContent())})],widget.getValue(k.localStorageKeys.componentView)!==k.localStorageKeys.structuredView?(n.state="disabled",n.tooltip=A.error_action_unavailable_in_flattened_view):i&&(n.state="disabled",n.tooltip=A.error_action_unavailable_in_release),n},createImplementLinkInformationMenu:function(e,t){return E(A.action_impLink_information,"info",function(){var i=C.formObjForEditProp(e,!0);t.publish({event:"selected-item-changed",data:i}),t.publish({event:"open-properties-panel"})})},createMaturityMenu:function(e){return E(A.maturity,"collaborative-lifecycle-management",function(){var t=[];e.forEach(function(e){var i={};i.physicalid=e.options.physicalid,i.label=e.options.label,t.push(i)}),w.init("MaturityCommand",t)})},createMoveToMenu:function(e){return E(A.action_move_to,"move-to",function(){var t=[];e.forEach(function(e){t.push({physicalid:e.options.physicalid,label:e.options.label,type:e.options.type,displayType:e.options.grid.type,revision:e.options.grid.revision,owner:e.options.grid.owner,icons:e.options.icons})}),w.init("ChangeOwnerCommand",t)})},createShareMenu:function(e){return E(A.action_share,"forward",function(){var t=[];e.forEach(function(e){t.push({physicalid:e.options.physicalid,label:e.options.label,type:e.options.type,displayType:e.options.grid.type,revision:e.options.grid.revision,owner:e.options.grid.owner,icons:e.options.icons})}),w.init("ShareCmd",t)})},createOpenAttributesManagementForProposedSolutions:function(e){return E(A.attributes_management_proposed_solutions,"attributes",function(){o.openAttributesManagementForProposedSolution(e,!0)})},createOpenInSAXMenu:function(e){return E(A.action_open,"open",function(){_.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:e[0].options.physicalid}})})},createOpenWithMenu:function(e){var t;return e&&e.length>0&&((t=E(A.action_open_with,"open-menu-dot")).submenu=[],e.forEach(function(e){t.submenu.push(E(e.text,e.fonticon,e.handler,null,null,e.icon))})),t},createRefineMenu:function(e){return E(A.action_refine_selection,"list-delete",function(){new a(e)})},createRelationsMenu:function(e){return E(A.relations,"object-related",function(){I.execute("ENORIPE_AP",e)})},createRemoveArchitectureNumberMenu:function(e,t,i){return E(A.action_remove_architecture_number,"remove",function(){c.detachArchitectureReferenceExtension(e,t)},i,A.error_action_unavailable_in_release)},createRemoveProposedSolutionMenu:function(e,t,i){var n,o,r,s={};let a=widget.getValue("groupingEnabled");for(var l=0;l<t.length;l++)o=t[l].getParent().getParent(),a&&!o.getID&&(o=D.getGroupNodeParent(o)),r=o.options.physicalid,!i&&C.checkIfMaturityIsReleasedOrObsolete(o.options.maturity)&&(i=!0),(n=s[r]?s[r]:[]).push(t[l].options.physicalid),s[r]=n;var d=E(A.action_remove_proposed_solution,"remove",function(){c.detachSolution(e,s,t)});return i&&(d.state="disabled",d.tooltip=A.error_action_unavailable_in_release),d},createReparentMenu:function(e,t,i,n){var r=E(A.action_reparent,"tree-reorder",null,n,A.error_action_unavailable_in_release);return r.submenu=[E(A.action_clear_reparent,"tree-reorder",function(){i.reparentInstances=null,C.alertMessage("success",null,A.msg_reparentCleared)}),E(A.action_newparent,"tree-reorder",function(){o.reparentAction(e,t,i.reparentInstances),i.reparentInstances=null})],r},createReplaceByMenu:function(e,t,i,n){var r;(r="structured-view"!==widget.getValue("component-view")?E(A.action_replace,"replace",!1,!0,A.error_action_unavailable_in_flattened_view):E(A.action_replace,"replace",!1,n,A.error_action_unavailable_in_release)).submenu=[];var s=E(A.action_replace_new_rev,"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-replace",function(){o.replaceByNewRevision(e,t)});return r.submenu.push(s),r.submenu.push(E(A.action_replace_latest_rev,"replace-by-latest-version",function(){w.init("ReplaceByLatestRevCmd",e)}),E(A.action_replace_other_rev,"replace-by-revision",function(){w.init("ReplaceByRevCmd",t.collectionView.treeDocument)})),1===e.length&&e[0].options.instance&&e[0].options.instance.physicalid&&r.submenu.push(E(A.action_replace_exist_ref,"replace-by-existing",function(){var i=e[0].getParent().options.physicalid,n=e[0].options.instance.physicalid,o=e[0].getRoot().options.physicalid;u.replaceByExisting(i,n,o,e[0],t.collectionView)}),E(A.action_replace_new_ref,"replace",function(){e[0].getParent().options.physicalid,e[0].options.instance.physicalid,e[0].getRoot().options.physicalid;i.publish({event:"create-new-logical-item",data:{selectedItem:e[0],isReplaceCall:!0}})})),r},createRevisionExplorerMenu:function(e){return E(A.revision_explorer,"flow-branch",function(){f.displayVersionGraph({modelKey:{id:e.options.physicalid,kind:e.options.type,isConfigured:!0}})})},createRevisionsMenu:function(e){return E(A.revisions,"flow-branch-list",function(){var t=[{physicalid:e.options.physicalid,label:e.options.label,type:e.options.type,displayType:e.options.grid.type,revision:e.options.grid.revision,current:e.options.grid.maturity,icons:e.options.icons}];w.init("HistoryCommand",t)})},createReserveMenu:function(e,t){return E(A.action_lock,"lock",function(){w.init("ReserveCmd",T(e))},t,A.error_action_unavailable_in_release)},createSelectToReparentMenu:function(e,t,i,n){return E(A.action_select_toreparent,"tree-reorder",function(){var i="";if(e&&e.length>0){for(var n=0;n<e.length;n++){if(!e[n].options.instance||!e[n].options.instance.physicalid)return void C.alertMessage("error",null,"",A.msg_remove_root);i=i+e[n].options.label+"<br>"}t.reparentInstances={instances:e,nameList:i},C.alertMessage("success",null,A.msg_reparentSaved)}},i,n)},createSetArchitectureNumberMenu:function(e,t){return E(A.set_architecture_number,"progress-3",function(){c.setArchitectureNumber(e,!1)},t,A.error_action_unavailable_in_release)},createSetProposedSolutionMenu:function(e,t){return E(A.action_set_proposed_solution,"3dproduct-add",function(){c.openModalSolutionSelection(e)},t,A.error_action_unavailable_in_release)},createUnreserveMenu:function(e,t){return E(A.action_unlock,"lock-open",function(){w.init("UnreserveCmd",T(e))},t,A.error_action_unavailable_in_release)},createDisplayConnectedDIFStructureMenu:function(e){return E(A.action_display_connected_DIF_structure,"display-layout-vertical-33",function(){F.DisplayConnectedDIFStructure(e)})}};return x}),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.contextualmenu",["DS/CATFLCockpitWidget/components/ContextualMenu/contextualmenu.actions","DS/CATFLCockpitWidget/components/ContextualMenu/contextualmenu.factory","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o){"use strict";var r=n.getFullConfig(),s=r.identifiers,a=r.localStorageKeys;return{getMenu:function(e,n,l){var c=!1,d=!1,u=!1,p=!1,g=!1,m=!1,f=!1,h=e.collectionView.treeDocument.getRoots()[0],v=r.adminStatus,C=e.modelInfo;C&&C.modelVersion&&(C.modelVersion.current===s.state_act_Release||C.modelVersion.current===s.state_act_Obsolete)?d=!0:h&&i.checkIfMaturityIsReleasedOrObsolete(h.options.maturity)&&(d=!0);var b=e.collectionView.treeDocument.getSelectedNodes(),y=!1,_=!1;if(b[0].isRoot()&&(_=!0),1===b.length&&(b[0].isRoot()&&(y=!0),b[0].options.linkInfo&&(p=!0),b[0].options.linkInfo&&"implementing"==b[0].options.linkInfo.linkType&&"ref"==b[0].options.linkInfo.objType&&(f=!0),g||!b[0].options.maturity||-1===b[0].options.maturity.indexOf(s.state_act_Frozen)&&-1===b[0].options.maturity.indexOf(s.state_act_Released.toUpperCase())||!b[0].options.grid.architectureNumber||""===b[0].options.grid.architectureNumber||(g=!0),!m&&v.ReparentEnforceSetAN&&b[0].options.grid.architectureNumber&&""!==b[0].options.grid.architectureNumber&&(m=!0)),b.length>1)for(var D=!1,S=!1,w=0;w<b.length&&(b[w].options.grid.kindOfRFLP!==b[0].options.grid.kindOfRFLP&&(c=!0),i.checkIfMaturityIsReleasedOrObsolete(b[w].options.maturity)&&(u=!0),!c||!u);w++)D||(b[w].options.linkInfo?(p=!0,S||("implementing"==b[w].options.linkInfo.linkType&&"ref"==b[w].options.linkInfo.objType?f=!0:(S=!0,f=!1))):(D=!0,p=!1)),g||!b[w].options.maturity||-1===b[w].options.maturity.indexOf(s.state_act_Frozen)&&-1===b[w].options.maturity.indexOf(s.state_act_Released.toUpperCase())||!b[w].options.grid.architectureNumber||""===b[w].options.grid.architectureNumber||(g=!0),!m&&v.ReparentEnforceSetAN&&b[w].options.grid.architectureNumber&&""!==b[w].options.grid.architectureNumber&&(m=!0);else u=i.checkIfMaturityIsReleasedOrObsolete(b[0].options.maturity);var I=t.createOpenWithMenu(l),A=t.createInformationMenu(b,n),F=t.createRefineMenu(b),k=t.createImplementLinkInformationMenu(b,n),E=t.createExpandMenu(e,b),T=t.createCollapseAllMenu(b),x=t.createReserveMenu(b,d),L=t.createUnreserveMenu(b,d),N=t.createMoveToMenu(b),M=(t.createShareMenu(b),t.createDisplayConnectedDIFStructureMenu(b));if(c||b[0].options.type===s.type_requirement||b[0].options.type===s.type_act_functref||"R"===b[0].options.grid.kindOfRFLP||"F"===b[0].options.grid.kindOfRFLP){var O=[];return b[0].options.type!==s.type_requirement&&b[0].options.type!==s.type_act_functref&&"R"!==b[0].options.grid.kindOfRFLP&&"F"!==b[0].options.grid.kindOfRFLP||(I&&(O.push(I),O.push({type:"SeparatorItem"})),1===b.length&&b[0].options.linkInfo&&"ref"===b[0].options.linkInfo.objType&&O.push(t.createCreateImplementLinkOccToOccMenu(b,d),{type:"SeparatorItem"})),b.length>1&&O.push(F,{type:"SeparatorItem"}),O.push(A),p&&O.push(k),p&&O.push({type:"SeparatorItem"},t.createDeleteImplementLinkMenu(b,h,e,d)),O}if(b[0].options.type===s.type_act_physical||"P"===b[0].options.grid.kindOfRFLP){var W=[];return I&&W.push(I,{type:"SeparatorItem"}),b.length>1&&W.push(F),1===b.length&&b[0].options.linkInfo&&"ref"===b[0].options.linkInfo.objType&&W.push(t.createCreateImplementLinkOccToOccMenu(b,d)),p||W.push(t.createOpenAttributesManagementForProposedSolutions(b),t.createDisplayMoreAttributesMenu(e.collectionView,b,!0)),W.push({type:"SeparatorItem"},A),p&&W.push(k),function(){for(var e=0;e<b.length;e++)if("proposedSolutionCategory"!==b[e].getParent().options.type)return!1;return!0}()?W.push({type:"SeparatorItem"},t.createRemoveProposedSolutionMenu(e.collectionView.treeDocument,b,d||u)):p&&W.push({type:"SeparatorItem"},t.createDeleteImplementLinkMenu(b,h,e,d)),W}if(b[0].getParent().options.type===s.type_spec_document){var P=[];return I&&P.push(I,{type:"SeparatorItem"}),b.length>1&&P.push(F,{type:"SeparatorItem"}),P.push(N,{type:"SeparatorItem"},t.createDocumentDownloadMenu(b),A,{type:"SeparatorItem"},t.createDocumentDetachMenu(b)),P}if(b[0].options.type===s.type_act_logref||"L"===b[0].options.grid.kindOfRFLP){var V=[],R=null,U=this.reparentInstances;if(widget.getValue("component-view")!==a.structuredView)y||(R=t.createSelectToReparentMenu(b,null,!0,o.error_action_unavailable_in_flattened_view));else if(U&&U.instances.length>0&&1===b.length){var B=!1;(d||i.checkIfMaturityIsReleasedOrObsolete(b[0].options.maturity))&&(B=!0),R=t.createReparentMenu(b,e,this,B)}else R=U&&U.instances.length>0&&b.length>1||y?null:t.createSelectToReparentMenu(b,this,d,o.error_action_unavailable_in_release);1!==b.length||y||V.push(t.createOpenInSAXMenu(b)),I&&V.push(I),V.length>0&&V.push({type:"SeparatorItem"}),b.length>1&&V.push(F);for(var j=0;j<b.length;j++)if("implementLinksCategory"===b[j].getParent().options.type)return p&&V.push(t.createDisplayMoreAttributesMenu(e.collectionView,b),{type:"SeparatorItem"}),1===b.length&&b[0].options.linkInfo&&"ref"===b[0].options.linkInfo.objType&&V.push(t.createCreateImplementLinkOccToOccMenu(b,d),{type:"SeparatorItem"}),f&&V.push(t.createMaturityMenu(b),{type:"SeparatorItem"},t.createMoveToMenu(b),{type:"SeparatorItem"}),V.push(A),p&&V.push(k),V.push({type:"SeparatorItem"}),p&&V.push(t.createDeleteImplementLinkMenu(b,h,e,d)),V;V.push(E,T,{type:"SeparatorItem"}),1===b.length&&V.push(t.createCopyMenu(b,e,this)),this.dataCopied&&V.push(t.createPasteCommand(b,this,d||u)),1===b.length&&V.push(t.createInsertNewMenu(b,n,d||u),t.createInsertExistingMenu(b,e.collectionView,d||u)),V.push(t.createSetArchitectureNumberMenu(b,d||u));for(w=0;w<b.length;w++)if(void 0!==b[w].options.grid.architectureNumber&&""!==b[w].options.grid.architectureNumber){V.push(t.createRemoveArchitectureNumberMenu(b,e.collectionView.getContent(),d||u));break}return V.push(t.createSetProposedSolutionMenu(b,d||u)),V.push(t.createEditConfigurationContextMenu(b,e)),y||_||(v.ConfiguredRevisionEnabled&&V.push(t.createAddToConfigurationRevisionMenu(b,e)),V.push(t.createVariantEffectivityMenu(b,e,1===b.length,!1)),V.push(t.createEvolutionEffectivityMenu(b,e,1===b.length,!1))),1===b.length&&(V.push(t.createSpaceAssignmentMenu(b[0],d||u)),"structured-view"===widget.getValue("component-view")&&V.push(t.createCreateImplementLinkRefToRefMenu(b[0],d||u))),!v.LogicalConsolidationEnabled||y||_||V.push(t.createConsolidateLogicalDefinitionMenu(b,e)),y||V.push(t.createReplaceByMenu(b,e,n,d)),null!==R&&V.push(R),V.push({type:"SeparatorItem"}),1===b.length&&V.push(t.createRevisionsMenu(b[0]),t.createRevisionExplorerMenu(b[0]),t.createDuplicateMenu(b[0])),b.length<=2&&V.push(t.createCompareMenu(b)),v.FullCompareEnabled&&1==b.length&&!y&&V.push(t.createCompareWithLastOutfitted(b,e.collectionView)),V.push(t.createMaturityMenu(b),{type:"SeparatorItem"}),V.push(x,L,N,{type:"SeparatorItem"}),V.push(M,t.createRelationsMenu(b[0]),A),y||_||V.push({type:"SeparatorItem"},t.createDetachMenu(b,e,m,g,d)),V}if("DIF"===b[0].options.grid.kindOfRFLP)return[t.createMaturityMenu(b),{type:"SeparatorItem"},N,{type:"SeparatorItem"},t.createRelationsMenu(b[0]),A]}}}),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.toolbar",["UWA/Core","DS/CoreEvents/ModelEvents","DS/ENOXCollectionToolBar/js/ENOXCollectionToolBarV2","DS/Menu/Menu","DS/CATFLCockpitWidget/mixins/CATFLBIGroup","DS/CATFLCockpitWidget/components/AttributesManagement/AttributesManagement","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.contextualmenu","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.configure.expand","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/preferences.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u,p){"use strict";var g=d.getFullConfig().localStorageKeys,m=d.getFullConfig().identifiers,f=d.getFullConfig(),h=function(e,t,i){this.container=e,this.gridView=t,this.modelEvents=i,this.createToolbarOptions(),this.render()};return h.prototype.createToolbarOptions=function(){var e=this,t=widget.getValue(g.componentView),i=widget.getValue("configurable_expand"),n="";i&&Object.keys(i).length<6&&(n="active");var o=[{id:"addaction",text:p.action_add,loadHelpRsc:{helpResourceFile:"CATFLCockpitWidget/help",resourceID:"addaction"},fonticon:"plus",handler:function(){},content:[{text:p.label_log_ref,className:"header"},{id:"create-new-logical-ref",text:p.action_add_new},{id:"create-existing-ref",text:p.action_add_existing}]},{id:"ngFilter",text:p.action_adv_filter,loadHelpRsc:{helpResourceFile:"CATFLCockpitWidget/help",resourceID:"ngFilter"},fonticon:"filter",disabled:!0},{id:"cues-status",text:p.action_cue_status,loadHelpRsc:{helpResourceFile:"CATFLCockpitWidget/help",resourceID:"cuesStatus"},fonticon:"dataflow-input-output",content:[{id:"compute-cues",fonticon:"compute",text:p.action_compute_cues},{id:"clear-cues",fonticon:"clear",text:p.action_clear_cues},{id:"export-cues",fonticon:"export",text:p.action_export_cues}],disabled:!0},{id:"attributes-management",text:p.attributes_management,loadHelpRsc:{helpResourceFile:"CATFLCockpitWidget/help",resourceID:"attributesManagement"},fonticon:"attributes"},{id:"configure-expand",text:p.action_configure_expand,loadHelpRsc:{helpResourceFile:"CATFLCockpitWidget/help",resourceID:"configureExpand"},className:n,fonticon:"flow-tree-expand-down-cog"}];f.adminStatus.LogicalConsolidationEnabled&&o.splice(2,0,{id:"specificFilter",text:p.action_specific_filter,fonticon:"filter-add",loadHelpRsc:{helpResourceFile:"CATFLCockpitWidget/help",resourceID:"specificFilter"},content:[{id:"noFilterDisciplines",text:p.action_no_filter,selectable:!0,selected:!0},{id:"filterAllDisciplines",text:p.action_discipline_filter,selectable:!0},{id:"filterPilotingDisciplines",text:p.action_piloting_discipline_filter,selectable:!0}],disabled:!0}),e.toolbarOptions={showItemCount:!1,multiselActions:[],actions:o,views:[{id:g.structuredView,fonticon:"tree-table",text:p.action_structured,loadHelpRsc:{helpResourceFile:"CATFLCockpitWidget/help",resourceID:"structuredView"}},{id:g.flattenedView,fonticon:"table",text:p.replace(p.action_flattened,{levelCnt:parseInt(widget.getPreference(g.depthFlattenedView).value,10)}),loadHelpRsc:{helpResourceFile:"CATFLCockpitWidget/help",resourceID:"flattenedView"}},{id:g.flattenedViewOnlyArchitectureItem,fonticon:"table",text:p.replace(p.action_flattened_arch,{levelCnt:parseInt(widget.getPreference(g.depthFlattenedViewArchitectureItemOnly).value,10)}),loadHelpRsc:{helpResourceFile:"CATFLCockpitWidget/help",resourceID:"flattenedViewOnlyArchitectureItem"}}],currentView:t,modelEvents:e.modelEvents,useWebUITooltip:!0},e.modelEvents.subscribe({event:"enox-collection-toolbar-multiselect-icon-update-count"},function(t){0===t?e.container.classList.remove("show-multisel-actions"):e.container.classList.add("show-multisel-actions")}),e.modelEvents.subscribe({event:"enox-collection-toolbar-action-activated"},function(t){var i=widget.getValue("modelAttached"),n=e.gridView.treeDocument.getRoots()[0],o=widget.getValue("component-view"),s=e.gridView.treeDocument.getSelectedNodes(),l=!1,d=null,u=null;if(i&&i.modelVersion&&(i.modelVersion.current===m.state_act_Release||i.modelVersion.current===m.state_act_Obsolete)?l=!0:(!n||n.options.grid.maturity!==m.state_act_Released&&n.options.grid.maturity!==m.state_act_Obsolete)&&(!s||1!=s.length||s[0].options.grid.maturity!==m.state_act_Released&&s[0].options.grid.maturity!==m.state_act_Obsolete)||(l=!0),"ngFilter"===t)e.modelEvents.publish({event:"content-list-view-ngFilter-open"});else if("compute-cues"===t)e.modelEvents.publish({event:"content-list-view-validate-cues"});else if("clear-cues"===t)e.modelEvents.publish({event:"content-list-view-clear-cues"});else if("export-cues"===t)e.modelEvents.publish({event:"content-list-view-export-cues"});else if("create-new-logical-ref"===t){if(e.gridView.treeDocument.getSelectedNodes().length>0){if(l)return void c.alertMessage("error",null,"",p.error_additem_in_release);if(o===g.flattenedView||o===g.flattenedViewOnlyArchitectureItem)return void c.alertMessage("error",null,"",p.error_additem_in_flattened)}e.modelEvents.publish({event:"create-new-logical-item"})}else if("create-existing-ref"===t){if(e.gridView.treeDocument.getSelectedNodes().length>0){if(l)return void c.alertMessage("error",null,"",p.error_additem_in_release);if(o===g.flattenedView||o===g.flattenedViewOnlyArchitectureItem)return void c.alertMessage("error",null,"",p.error_additem_in_flattened)}e.modelEvents.publish({event:"content-view-add-existing-item"})}else if("attributes-management"===t)new r;else if("configure-expand"===t){new a({}).render(e.enoxCollectionToolbar)}else if("noFilterDisciplines"===t)e.enoxCollectionToolbar._actionsContainer.querySelector("#specificFilter").classList.remove("active-action"),e.modelEvents.publish({event:"content-list-view-noFilterDisciplines"});else if("filterPilotingDisciplines"===t){if(d=widget.getValue("configurable_expand"),u=widget.getValue("component-view"),!d.implementing)return c.alertMessage("error",null,p.error_filter_missing_implementing),void e.toogleDefaultDropdownItem("specificFilter");if("structured-view"!==u)return c.alertMessage("error",null,p.error_specific_filter_flattened_view),void e.toogleDefaultDropdownItem("specificFilter");e.enoxCollectionToolbar._actionsContainer.querySelector("#specificFilter").classList.add("active-action"),e.modelEvents.publish({event:"content-list-view-filterPilotingDisciplines"})}else if("filterAllDisciplines"===t){if(d=widget.getValue("configurable_expand"),u=widget.getValue("component-view"),!d.implementing||!d.isImplementing)return c.alertMessage("error",null,p.error_filter_missing_implementing_isImplementing),void e.toogleDefaultDropdownItem("specificFilter");if("structured-view"!==u)return c.alertMessage("error",null,p.error_specific_filter_flattened_view),void e.toogleDefaultDropdownItem("specificFilter");e.enoxCollectionToolbar._actionsContainer.querySelector("#specificFilter").classList.add("active-action"),e.modelEvents.publish({event:"content-list-view-filterDisciplines"})}}),e.modelEvents.subscribe({event:"enox-collection-toolbar-switch-view-activated"},function(t){widget.setValue(g.componentView,t),e.modelEvents.publish({event:"content-list-view-refresh"})}),e.modelEvents.subscribe({event:"content-list-view-refresh-complete"},function(t){if(e._firstRefreshComplete||(e.enoxCollectionToolbar._actionsIconBar.enableItem("ngFilter"),e.enoxCollectionToolbar._actionsIconBar.enableItem("cues-status"),e.enoxCollectionToolbar._actionsIconBar.enableItem("specificFilter"),e._firstRefreshComplete=!0),f.adminStatus.LogicalConsolidationEnabled){var i=e.enoxCollectionToolbar._actionsContainer.querySelector("#specificFilter");i&&i.classList.remove("active-action"),e.toogleDefaultDropdownItem("specificFilter")}u.getUserCustomViews().then(function(t){t&&t.customViews&&e.gridView.getCustomViewsManager().setCustomViews(t.customViews,t.currentCustomViewIdentifier,!0)})})},h.prototype.toogleDefaultDropdownItem=function(e){var t=this.enoxCollectionToolbar._actionsIconBar.getItem(e);if(t){var i=t.content.options.items,n=null;for(var o of i)if(o.selected){n=o.id;break}var r=t.content.component;if(r&&n){var s=r.getItem(n);r.toggleSelection(s)}}},h.prototype.render=function(){var e=this;e.container.empty(),e.enoxCollectionToolbar=new i(e.toolbarOptions),e.enoxCollectionToolbar.inject(e.container,"top"),setTimeout(function(){var t=e.enoxCollectionToolbar._actionsIconBar.getItem("iconViewsActionBar");t&&t.elements.container.addEventListener("click",function(e){let i=t.content.options.items;var n=t.content.component&&t.content.component.elements.container;if(n){var r=n.getElement("#flattened-view"),s=n.getElement("#flattend-view-only-architecture-item");o.isGroupingApplied()&&"structured-view"!==e.target?(r.addClassName("disabled"),s.addClassName("disabled"),e.preventDefault()):(r.removeClassName("disabled"),s.removeClassName("disabled"))}else i&&o.isGroupingApplied()?(i[1].disabled=!0,i[2].disabled=!0):(i[1].disabled=!1,i[2].disabled=!1)}),e.container.getElement("#structured")&&e.modelEvents.publish({event:"enox-collection-toolbar-color-selected-action",data:{id:"structured"}})},200),e.enoxCollectionToolbar._actionsContainer.querySelector("#iconMultipleActionBar").addEventListener("click",function(t){var i={openFromToolbar:!0,collectionView:e.gridView};widget.getValue("modelAttached")&&(i.bModelAttached=!0,i.modelInfo=widget.getValue("currentConfig")),n.show(s.getMenu(i,e.modelEvents),{input:"mouse",position:{x:t.pageX,y:t.pageY},submenu:"auto"})})},h}),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.controller",["UWA/Core","DS/CoreEvents/ModelEvents","DS/CATFLCockpitWidget/model/CATFLCockpitTreeDocument","DS/UIKIT/Mask","DS/DataGridView/DataGridView","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgBaseUX/scripts/CfgData","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.toolbar","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.contextualmenu","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.attachment","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.effectivity","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.columns","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.filter","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/preferences.util","DS/CATFLCockpitWidget/utils/contextManager.util","DS/CATFLCockpitWidget/mixins/CATFLBIFilter","DS/CATFLCockpitWidget/mixins/CATFLBIGroup","DS/CATFLCockpitWidget/components/CommandsCtrl/command.controller","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/implementlink.service","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/services/dimensions.service","DS/CATFLCockpitWidget/components/CreateLogicalItemModal/logRef.createPanel.modalWindow","DS/CATFLCockpitWidget/components/SpaceAssignment/SpaceAssignment","DS/CATFLCockpitWidget/components/VersionExplorer/versionexplorer.controller","DS/CATFLCockpitWidget/components/ConvergenceCues/ConvergenceCues.export","DS/Utilities/Utils","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/refresh.util","DS/CATFLCockpitWidget/utils/gridview.util","DS/CATFLCockpitWidget/parser/database.parser","DS/PlatformAPI/PlatformAPI","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,g,m,f,h,v,C,b,y,_,D,S,w,I,A,F,k,E,T,x,L,N,M,O){"use strict";var W=E.getFullConfig(),P=W.localStorageKeys,V=W.identifiers,R=[];return{init:function(t){var r=this;r.modelEvents=m.createAppEventObject("flcockpit-content-list-view");var s=m.getFLWebModelEventsObj("flweb-model-events");s.subscribe({event:"allmod-selection-successful"},r.viewNonFilteredContent.bind(r)),s.subscribe({event:"mod-PC-selection-successful"},r.modelPCSelected.bind(r)),s.subscribe({event:"mod-selection-removed"},r.viewNonFilteredContent.bind(r));var d=e.createElement("div",{class:"fl-cockpit-toolbar-container"});return t.appendChild(d),r.contentViewContainer=document.createElement("div"),r.contentViewContainer.classList.add("fl-cockpit-data-grid-view-container"),r.contentView=new o({identifier:"SystemArchitectureRelease_ContentView",height:"inherit",treeDocument:new i({useAsyncPreExpand:!0}),selectionBehavior:{unselectAllOnEmptyArea:!1},showNodeKPIColorFlag:!0,rowDragEnabledFlag:!0,cellDragEnabledFlag:!0,defaultColumnDef:{typeRepresentation:"string",width:"auto"},rowGroupingOptions:{depth:1,hideGroupedColumns:!1},onContextualEvent:function(e){if(e.cellInfos){if(e.cellInfos&&-1===e.cellInfos.rowID)return r.customViewsManager._customViewsDialog&&(C.isGroupingApplied()?r.customViewsManager._customViewsDialog._groupingSelectionChips.visibleFlag=!1:r.customViewsManager._customViewsDialog._groupingSelectionChips.visibleFlag=!0),e.collectionView.buildDefaultContextualMenu(e);widget.getValue("modelAttached")&&(e.bModelAttached=!0,e.modelInfo=widget.getValue("currentConfig")),e.cellInfos.nodeModel.isSelected()||(e.collectionView.treeDocument.unselectAll(),e.cellInfos.nodeModel.select());var t=e.collectionView.treeDocument.getSelectedNodes();return t.length>1?l.getMenu(e,r.modelEvents):1===t.length?y.getTypeHierarchy(t[0].options.grid.actualType).then(function(i){return T.getOpenWithCompatibleApps(t[0],i).then(function(t){return l.getMenu(e,r.modelEvents,t)})}):void 0}},getCellTooltip:function(e){return e.nodeModel&&0===e.columnID&&e.nodeModel._options.grid.titleTooltip?{shortHelp:e.nodeModel._options.grid.titleTooltip,updateModel:!1}:e.nodeModel&&1===e.columnID&&e.nodeModel._options.grid.cueTooltip?{shortHelp:e.nodeModel._options.grid.cueTooltip,updateModel:!1}:r.contentView.getCellDefaultTooltip(e)}}),u.getDataGridViewColumns(r.contentView).then(function(e){r.contentView.onDelayedModelDataRequest=k.debounce(r.getDelayedModelData.bind(r),200),r.contentView.columns=e,r.contentView.onDragStartCell=function(e,t){return e.dataTransfer.setData("Text",JSON.stringify(T.create3DXJsonFromDGVSelection(r.contentView.treeDocument.getSelectedNodes()))),!1},r.contentView.onDragStartRowHeader=function(e,t){return e.dataTransfer.setData("Text",JSON.stringify(T.create3DXJsonFromDGVSelection([t.nodeModel]))),!0},r.customViewsManager=r.contentView.getCustomViewsManager(),r.customViewsManager.onCustomViewsSave=r.onCustomViewsSave.bind(r),r.customViewsManager.showCustomViewsDialog(),r.customViewsManager._customViewsDialog.visibleFlag=!1,new a(d,r.contentView,r.modelEvents),r.setPADContext(),r.contentView.inject(r.contentViewContainer),t.appendChild(r.contentViewContainer),r.modelEvents.subscribe({event:"content-list-view-ngFilter-open"},function(){widget.getPreference(P.disableIndexAcceleration).value?T.alertMessage("warning",null,O.warn_filter_only_indexed_mode):b.init("NGFilterCmd",{viewController:r})}),r.modelEvents.subscribe({event:"content-list-view-validate-cues"},r.validateCuesForItems.bind(r,null,!1)),r.modelEvents.subscribe({event:"content-list-view-clear-cues"},r.clearCuesForItems.bind(r)),r.modelEvents.subscribe({event:"content-list-view-update-cues"},r.updateCuesForItems.bind(r)),r.modelEvents.subscribe({event:"content-list-view-export-cues"},F.exportCuesForItems.bind(r)),r.modelEvents.subscribe({event:"create-new-logical-item"},function(e){n.mask(r.contentView.getContent(),O.msg_loading);var i=null,o=!1;void 0!==e&&void 0!==e.selectedItem?i=e.selectedItem:1===r.contentView.treeDocument.getSelectedNodes().length&&(i=r.contentView.treeDocument.getSelectedNodes()[0]),e&&e.isReplaceCall&&(o=!0),g.getCustomField(i).then(function(e){var s=V.param_subtype_key;y.getParameterizationSetting([s]).then(function(a){var l=!a||a[s];if(l)g.getSubTypes().then(function(s){w.create(t.getParent(),i,e,o,l,s,r.contentView.treeDocument);n.unmask(r.contentView.getContent())},function(e){T.alertMessage("error",null,O.error_get_subtypes),n.unmask(r.contentView.getContent())});else{w.create(t.getParent(),i,e,o,l,null,r.contentView.treeDocument);n.unmask(r.contentView.getContent())}},function(){n.unmask(r.contentView.getContent())})},function(){n.unmask(r.contentView.getContent())})}),r.modelEvents.subscribe({event:"content-view-add-existing-item"},function(e){var t;if(e&&e.selectedItem)t=e.selectedItem;else{if(1!==r.contentView.treeDocument.getSelectedNodes().length)return void T.alertMessage("error",null,O.msg_select_single_Logical);t=r.contentView.treeDocument.getSelectedNodes()[0]}c.addExistingItem(t,r.contentViewContainer,r.contentView.treeDocument)}),r.modelEvents.subscribe({event:"content-list-view-refresh"},function(e){if(null!=e)r.refresh(e.itemID,e.expandFilterBinary);else{var t=widget.getValue("currentConfig");t&&t.filterCompiledForm?r.refresh(null,t.filterCompiledForm):r.refresh()}r.contentView.reapplySortModel()}),r.modelEvents.subscribe({event:"content-list-view-refresh-columns"},function(){u.getDataGridViewColumns(r.contentView).then(function(e){r.contentView.columns=e,r.contentView.layout.applyColumns()})}),r.modelEvents.subscribe({event:"refresh-nodes-by-id"},x.refreshNodeDetails.bind(r)),r.modelEvents.subscribe({event:"refresh-inst-by-id"},x.refreshInstDetailsonNode.bind(r)),r.modelEvents.subscribe({event:"refresh-spaces-by-id"},x.refreshSpacesonNode.bind(r)),r.modelEvents.subscribe({event:"refresh-solutions-by-id"},x.refreshSolutionsonNode.bind(r)),r.modelEvents.subscribe({event:"refresh-documents-by-id"},x.refreshDocumentsOnNodes.bind(r)),r.modelEvents.subscribe({event:"refresh-refLinks-by-id"},x.refreshReferenceLinksOnNodes.bind(r)),r.modelEvents.subscribe({event:"remove-items-from-category"},x.removeItemsFromCatogry.bind(r)),r.modelEvents.subscribe({event:"refresh-items-on-replace"},x.refreshNodesOnReplace.bind(r)),r.contentView.addEventListener("click",r.manageClickInGridView.bind(r)),r.contentView.sortModel=[{dataIndex:"tree",sort:"asc"}],T.makeDroppable(r.contentView.getContent(),O.msg_drop_to_open,r.manageDropInGridView.bind(r)),M.subscribe("DS/PADUtils/PADCommandProxy/refresh",r.refreshGridViewOnItemUpdate.bind(r)),M.subscribe("Lifecycle.Modification",function(e){var t=JSON.parse(e);if(t&&t.Refresh&&t.Refresh.created&&t.Refresh.created.length>0){for(var i=[],n=0;n<t.Refresh.created.length;n++)i.push(t.Refresh.created[n].sourceObjectId);r.refreshGridViewOnItemUpdate({data:{authored:{modified:i}}})}})}),r},setPADContext:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){e.contentView.getEditMode=function(){return!0},e.contentView.getPADTreeDocument=function(){return e.contentView.getTreeDocument()},e.contentView.getSelectedNodes=function(){return h.getSelectedNodes()||e.contentView.getTreeDocument().getSelectedNodes()},e.contentView.displayNotification=function(e){"error"===e.eventID?T.alertMessage("error",null,e.msg||e):"warning"===e.eventID?T.alertMessage("error",null,e.msg||e):T.alertMessage("success",null,e.msg||e)},e.contentView.getSecurityContext=function(){return{SecurityContext:"ctx::"+E.getSecurityContext()}},t.set(e.contentView)})},onCustomViewsSave:function(e,t){let i=this.contentView.getCustomViewsManager(),n=i.getCurrentCustomView().groupingOptions;widget.setValue("groupingEnabled",!!n),f.saveUserCustomViews(e,t);let o=this.contentView.getTreeDocument().getRoots()[0];o._isExpanded||(o.expand(),f.getUserCustomViews().then(function(e){e&&e.customViews&&i.setCustomViews(e.customViews,e.currentCustomViewIdentifier,!0)}))},manageClickInGridView:function(e,t){if(t&&t.nodeModel&&t.columnID&&!(t.columnID<0)){var i=t.nodeModel.options.type===V.type_act_logref,n=t.nodeModel.getParent().options.type===V.type_spec_document,o="DIF"===t.nodeModel.options.grid.kindOfRFLP,a=t.nodeModel.options.virtual;if(i||n||o){var l=this.contentView.columns[t.columnID].dataIndex,d=e.target.className,u=widget.getValue("currentConfig"),p=this.contentView.treeDocument.getRoots()[0],g=!1;if(u&&u.modelVersion&&(u.modelVersion.current===V.state_act_Release||u.modelVersion.current===V.state_act_Obsolete)?g=!0:(!p||p.options.grid.maturity!==V.state_act_Released&&p.options.grid.maturity!==V.state_act_Obsolete)&&("VariantEffectivity"===l||t.nodeModel.options.grid.maturity!==V.state_act_Released&&t.nodeModel.options.grid.maturity!==V.state_act_Obsolete)||(g=!0),"cue"===l){if(V.clickable_cue_icons.some(function(e){return d.indexOf(e)>=0})){var f=m.getFLWebModelEventsObj("flweb-model-events"),h={};h.rootID=this.contentView.treeDocument.getRoots()[0].options.physicalid,h.instanceID=t.nodeModel._options.instance.physicalid,h.instParentID=t.nodeModel._options.physicalid,h.instParentTitle=t.nodeModel._options.label+" "+t.nodeModel._options.grid.revision,h.nodeModel=t.nodeModel,f.publish({event:"flcockpit-convergence-cues-actions",data:h})}}else if("revision"===l&&i&&!a)A.displayVersionGraph({modelKey:{id:t.nodeModel.options.physicalid,kind:t.nodeModel.options.type,isConfigured:!0}});else if("maturity"===l&&(n||!a||a&&t.nodeModel.options.type===V.type_act_logref&&t.nodeModel.options.linkInfo&&"implementing"==t.nodeModel.options.linkInfo.linkType&&"ref"==t.nodeModel.options.linkInfo.objType||a&&"DIF"===t.nodeModel.options.grid.kindOfRFLP))b.init("MaturityCommand",[{physicalid:t.nodeModel.options.physicalid,label:t.nodeModel.options.label}]);else if("owner"===l&&(n||!a||a&&t.nodeModel.options.type===V.type_act_logref&&t.nodeModel.options.linkInfo&&"implementing"==t.nodeModel.options.linkInfo.linkType&&"ref"==t.nodeModel.options.linkInfo.objType||a&&"DIF"===t.nodeModel.options.grid.kindOfRFLP))b.init("ChangeOwnerCommand",[{physicalid:t.nodeModel.options.physicalid,type:t.nodeModel.options.type,label:t.nodeModel.options.label,displayType:t.nodeModel.options.grid.type,revision:t.nodeModel.options.grid.revision,owner:t.nodeModel.options.grid.owner,icons:t.nodeModel.options.icons}]);else if(i&&!a&&"architectureNumber"===l){if(g)return void T.alertMessage("error",null,"",O.error_authOperations_in_release);c.setArchitectureNumber([t.nodeModel])}else if(i&&"VariantEffectivity"===l){let i=e.dsModel.layout.getColumnOptionValue(t.columnID,"columnModule");if(i){let e=W.gridview.additionalColumnsModules[i]||{},n=e.getOnCellClickCB;if(n){var v=n.call(e,l);v&&(window.cfgCmdWidgetData={_isDecouplingActivated:!0,_isConfigAvailable:!0},r.checkDecouplingActivation().then(function(e){e&&!1===e.isEditVariantEnabled?s.isEditVariantEnabled=!1:s.isEditVariantEnabled=!0}).catch(function(){s.isEditVariantEnabled=!0}).finally(function(){v(t)}))}}}else if(i&&!a&&"assignedSpaces"===l){if(g)return void T.alertMessage("error",null,"",O.error_authOperations_in_release);new I(t.nodeModel)}}}},manageDropInGridView:function(e){var t=this,i=m.getFLWebModelEventsObj("flweb-model-events");i.subscribe({event:"flweb-drop-success"},function(){T.cleanDragNDrop(t.contentView.getContent())}),i.publish({event:"flweb-drop-item",data:{item:e}})},getDelayedModelData:function(t){let i,n,o,r,s,a=this,l=t.collectionView,c=l.treeDocument,d=l.layout.columns,u=widget.getValue("ngFilter");if(t.displayedColumnsIndexes.length>0){t.displayedColumnsIndexes.indexOf(l.layout.getColumnIndex("assignedSpaces"))>=0&&(i=!0),(t.displayedColumnsIndexes.indexOf(l.layout.getColumnIndex("Effectivity"))>=0||t.displayedColumnsIndexes.indexOf(l.layout.getColumnIndex("VariantEffectivity"))>=0||t.displayedColumnsIndexes.indexOf(l.layout.getColumnIndex("CurrentEvolutionEffectivity"))>=0||t.displayedColumnsIndexes.indexOf(l.layout.getColumnIndex("ProjectedEvolutionEffectivity"))>=0)&&(n=!0),t.displayedColumnsIndexes.indexOf(l.layout.getColumnIndex("ConfigurationContext"))>=0&&(o=!0),t.displayedColumnsIndexes.indexOf(l.layout.getColumnIndex("ConfigurationRevision"))>=0&&(s=!0,u&&u.length>0&&(r=!0));let m={},f=T.getUserCustomAttributes()||[],h=T.getUserCustomAttributes(!0)||[],v=f.concat(h);v&&v.forEach(function(e){e.isOnPhysicalProduct?m["physical_"+e.curi]=e:e.bo?m[e.curi]=e:m["instance_"+e.curi]=e});let C=[],b=Object.keys(m),y={},_=[],D={};t.displayedColumnsIndexes.forEach(function(e){if(d[e]&&b.indexOf(d[e].dataIndex)>=0){let t=m[d[e].dataIndex],i=t.dimension+"_"+t.manipulationUnit;t.manipulationUnit&&t.manipulationUnit!==W.dimensions[t.dimension].MKSUnit?(C.push(d[e].dataIndex),y[i]||(y[i]=[]),y[i].push(d[e].dataIndex),D[i]={UnitFrom:W.dimensions[t.dimension].MKSUnit,UnitTo:t.manipulationUnit,Dimension:t.dimension,Values:[]}):t.manipulationUnit&&_.push(d[e].dataIndex)}});let w=[],I=[],A={},F=[],k=[],E={},x=[],N=[],M=[];for(let e=t.startNodeIndex;e<=t.endNodeIndex;e++){let t=l.model[e];if(t){V.type_act_logref==t.options.type&&(i&&!t.options.assignedSpacesPID&&N.push(t),!o||t.options.grid.ConfigurationContext||t.options.linkInfo||x.push(t.options.physicalid),n&&t.options.instance&&!t.options.grid.Effectivity&&(w.push(t.options.instance.physicalid),I.push(t.options.physicalid),A[t.options.instance.physicalid]=t),r?t.options.grid.ConfigurationRevision||(t.options.instance&&F.push(t.options.instance.physicalid),k.push(t.options.physicalid),E[t.options.physicalid]=t):s&&t.updateOptions({grid:{ConfigurationRevision:""}}));let e=!1;C.forEach(function(i){if(!t.options.grid[i]&&t.options.grid[i+"_actual"]){let n=t.options.grid[i+"_actual"]||0;e=!0;let o=m[i],r=D[o.dimension+"_"+o.manipulationUnit];o.multiValuated&&Array.isArray(n)?n.forEach((e,t)=>{r.Values.indexOf(e)<0&&r.Values.push(e)}):r.Values.indexOf(n)<0&&r.Values.push(n)}}),e&&M.push(t),_.forEach(function(e){var i=t.options.grid[e+"_actual"];i&&t.setAttribute(e,i)})}}let P=[];if(N.length>0&&P.push(L.addAssignedSpacesAttribute(N)),x.length>0){var p={relids:[],pids:x};(g=W.gridview.additionalColumnsModules.cfgContext)&&P.push(new Promise(function(t,i){g.updateAttributes(p,function(n){var o=e.is(n,"string")?JSON.parse(n):n;t(o),i("Error in Cfg_updateAttributes")},a)}).then(function(e){let t=e?e.pids:{};c.withTransactionUpdate(function(){x.forEach(function(e){c.getMappedNodesFromId(e).forEach(function(i){let n={grid:{ConfigurationContext:t[e].ConfigurationContext}};i.updateOptions(n)})})})}))}if(w.length>0){p={relids:w,pids:I};(g=W.gridview.additionalColumnsModules.cfgEffectivty)&&P.push(new Promise(function(t,i){g.updateAttributes(p,function(n){var o=e.is(n,"string")?JSON.parse(n):n;t(o),i("Error in Cfg_updateAttributes")},a)}).then(function(e){let t=e?e.relids:{};c.withTransactionUpdate(function(){w.forEach(function(e){var i=A[e],n=t[e];n&&(n.VariantEffectivity.trim()||(n.VariantEffectivity=O.label_none),i.updateOptions({grid:n}))})})}))}if(k.length>0||F.length>0){var g;p={pids:k,relids:F};(g=W.gridview.additionalColumnsModules.cfgRevision)&&P.push(new Promise(function(t,i){g.updateAttributes(p,function(n){var o=e.is(n,"string")?JSON.parse(n):n;t(o),i("Error in CfgRev_updateAttributes")},a)}).then(function(e){let t=e?e.pids:{};Object.keys(t).length>0&&c.withTransactionUpdate(function(){k.forEach(function(e){var i=E[e],n=t[e];n&&i.updateOptions({grid:n})})})}))}if(C.length>0&&M.length>0){for(let e in D)if(D[e].Values.length<=0){delete D[e];let t=y[e];for(let e of t)C.splice(C.indexOf(e),1)}P.push(S.convertValues(Object.values(D)).then(function(t){let i={},n=Object.keys(D);t.Response&&(t.Response.forEach(function(t,o){let r={},s=e.is(t.ValuesToConvert,"string")?t.ValuesToConvert.split(";"):t.ValuesToConvert,a=e.is(t.ConvertedValues,"string")?t.ConvertedValues.split(";"):t.ConvertedValues;s.forEach(function(e,t){r[e]=a[t]}),i[n[o]]=r}),M.forEach(function(e,t){C.forEach(function(t,n){let o=m[t];if(e.options.grid[t+"_actual"])if(o.multiValuated&&Array.isArray(e.options.grid[t+"_actual"])){var r=[];e.options.grid[t+"_actual"].forEach((e,t)=>{let n=i[o.dimension+"_"+o.manipulationUnit][e];r.push(n)}),e.setAttribute(t,r)}else{let n=i[o.dimension+"_"+o.manipulationUnit][e.options.grid[t+"_actual"]];e.setAttribute(t,n)}})}))}))}P.length>0&&Promise.all(P)}},refreshGridViewOnItemUpdate:function(e){let t=this,i=[],n=[],o={};if(e.data.authored){let r=t.contentView.treeDocument.getRoots();if(r&&r.length>0){let s=r[0].options.physicalid;e.data.authored.deleted&&e.data.authored.deleted.forEach(function(e){t.contentView.treeDocument.getMappedNodesFromId(e).forEach(function(e){e.getParent().removeChild(e)})}),e.data.authored.modified&&e.data.authored.modified.forEach(function(e){e===s&&m.getFLWebModelEventsObj("flweb-model-events").publish({event:"idcard-refresh"});let r=t.contentView.treeDocument.getMappedNodesFromId(e);r&&r.length>0?r.forEach(function(t){void 0===t.getParent()||t.getParent().options.type!==W.identifiers.type_attach_document&&t.getParent().options.type!==W.identifiers.type_spec_document?"DIFSheet"===t.options.type&&t.options.virtual||t.options.virtual||t.options.virtual?x.refreshConnectedDIFNode(t):i.push(e):n.push(t.getParent().getParent())}):(r=t.contentView.treeDocument.getRoots()[0].getNodesByRelId(e))&&r.length>0&&(o[e]=r)})}T.setAuthoringMode(),i.length>0&&t.modelEvents.publish({event:"refresh-nodes-by-id",data:{arrayOfPID:i,tagAsRecentlyAuthored:!0}}),n.length>0&&t.modelEvents.publish({event:"refresh-documents-by-id",data:{nodes:n}}),Object.keys(o).length>0&&t.modelEvents.publish({event:"refresh-inst-by-id",data:{instIdMap:o,bInstance:!0,bEffectivity:!1}})}},refresh:function(e,t,i){if(!e){if(void 0===this.contentView.treeDocument.getRoots()[0])return;e=this.contentView.treeDocument.getRoots()[0].options.physicalid}n.mask(this.contentView.getContent(),O.msg_loading),this.contentView.treeDocument.empty(),this._cueGlobalCount=null,this.selectedItemsForCues={},g.getLogItemWithExpand(e,t).then(this.itemPageRefCallBack.bind(this,i))},itemPageRefCallBack:function(e,t){var i=this;t.options.shouldBeSelected=function(e){return e.options.physicalid&&e.options.physicalid.length>0},i.contentView.treeDocument=t,i.contentView.invalidateLayout({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1}),i.configData&&i.contentView.treeDocument.setConfigurationContext(i.configData),n.unmask(i.contentView.getContent()),i.catflBIFilter?i.catflBIFilter.updateModel(i.contentView):i.catflBIFilter=new v({view:i.contentView}),setTimeout(function(){i.catflBIFilter.onSetTagsWithExpandSynthesis(),i.contentView.reapplySortModel()},1e3),i.contentView.treeDocument.getXSO().onPostAdd(i._onXSOChanged.bind(i)),i.contentView.treeDocument.getXSO().onPostRemove(i._onXSOChanged.bind(i));var o={revision:{filterId:"stringRegexp"},instanceName:{filterId:"stringRegexp"},owner:{filterId:"stringRegexp"},modificationDate:{filterId:"stringRegexp"},description:{filterId:"stringRegexp"},type:{filterId:"stringRegexp"},name:{filterId:"stringRegexp"},creationDate:{filterId:"stringRegexp"},architectureNumber:{filterId:"stringRegexp"},instance_description:{filterId:"stringRegexp"}};if(i.contentView.columns.forEach(function(e){e.isCustomAttribute&&("integer"===e.typeRepresentation?o[e.dataIndex]={filterId:"number"}:o[e.dataIndex]={filterId:"stringRegexp"})}),o.maturity={filterId:"set",filterModel:Object.values(W.MAPPING_MATURITY)},i.contentView.treeDocument.setFilterModel(o),W.adminStatus.LogicalConsolidationEnabled){var r=p.registerAndCreateFilterOnDisciplines(i.contentView,"PilotingDisciplines",o),s=p.registerAndCreateFilterOnDisciplines(i.contentView,"Disciplines",o);for(var a of R)i.modelEvents.unsubscribe(a);(R=[]).push(i.modelEvents.subscribe({event:"content-list-view-noFilterDisciplines"},function(){p.changeFilterModel(i.contentView,o)})),R.push(i.modelEvents.subscribe({event:"content-list-view-filterPilotingDisciplines"},function(e){p.changeFilterModel(i.contentView,r)},!0)),R.push(i.modelEvents.subscribe({event:"content-list-view-filterDisciplines"},function(e){p.changeFilterModel(i.contentView,s)}))}e&&i.selectNodesById(e),L.crRecTimeoutToCheckTreeDocExp(i.contentView.treeDocument,function(){i.modelEvents.publish({event:"content-list-view-refresh-complete",data:{contentListView:i}})})},modelPCSelected:function(e){this.configData=e,this.refresh(e.itemID,e.filterCompiledForm)},getNLSValueCueSeverity:function(e){var t="";return"WARNING"===e?t=O.cue_warning:"ERROR"===e?t=O.cue_error:"CRITICAL"===e?t=O.cue_critical:"INFO"===e?t=O.cue_info:"COMBINED"===e&&(t=O.cue_combined),t},viewNonFilteredContent:function(e){this.configData=null,this.refresh(e.itemID)},_onXSOChanged:function(){var e=this,t=e.contentView.treeDocument.getSelectedNodes(),i=!1,n=[],o=widget.body.getElement(".triptych-right");o&&!o.hasClassName("close")&&(i=!0,n=T.formObjForEditProp(t)),setTimeout(function(){i&&e.modelEvents.publish({event:"selected-item-changed",data:n}),e.modelEvents.publish({event:"enox-collection-toolbar-multiselect-icon-update-count",data:t.length})});var r=E.form3DXContent(t);E.setObjectOnCompass(r),E.launchCrossAppSelection(t)},selectNodesById:function(e){var t=this.contentView.treeDocument.getRoots()[0];e.forEach(function(e){e===t.options.physicalid?t.select():t.getNodesById(e).length>0&&t.getNodesById(e)[0].select()})},validateCuesForItems:function(e,t){var i=this,o=!1;e?o=!0:e=i.contentView.treeDocument.getSelectedNodes();var r,s,a=[];if(!t&&e.length<=0)T.alertMessage("error",null,O.error_cue_computation_noSelItems);else if(i.selectedItemsForCues||(i.selectedItemsForCues={}),i._cueGlobalCount||(i._cueGlobalCount={COMBINED:0,CRITICAL:0,ERROR:0,WARNING:0,INFO:0}),i._cueComputedIds||(i._cueComputedIds=[]),r=i.contentView.treeDocument.getRoots()[0].options.physicalid,t||1!==e.length||e[0]._options.physicalid!==r){for(var l=!1,c=[],d=0;d<e.length;d++)e[d]._options.instance?(s=e[d]._options.instance.physicalid,a.push(s),i.selectedItemsForCues[s]=e[d],c.push(e[d])):l||e[d]._options.physicalid===r||(l=!0);var u=_.confAllImplPathsOnNodes(c,!1,!1);if(a&&a.length>0){var p=i.contentView.getContent();n.mask(p,O.msg_processing),y.validateVisualCues(a,u.payload).then(function(e){if(e){if(i.mapCueResponse(a,e),i.selectedItemsForCues)for(var n in i.selectedItemsForCues){var r=i.selectedItemsForCues[n],s="",l=r._options.cueDetails;if(l&&l.cue.length<=0)r.setAttribute("cue",l.cue);else if(l&&i._cueGlobalCount){for(var c in i._cueGlobalCount){0!==s.length&&(s+="; "),s+=i.getNLSValueCueSeverity(c)+":"+i._cueGlobalCount[c]}l.cueTooltip.indexOf(O.total)>=0&&(l.cueTooltip=l.cueTooltip.substring(0,l.cueTooltip.indexOf(O.total))),l.cueTooltip+=O.total+" "+s,r.setAttribute("cue",l.cue),r.setAttribute("cueTooltip",l.cueTooltip)}}t||T.alertMessage("success",null,O.msg_cue_computation_complete),o&&m.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-cues-report"})}}).catch(function(e){return CommonUtil.displayError(e,null,null,O.msg_generic_error_get_failed),Promise.reject()}).finally(function(){n.unmask(p)})}!t&&l&&T.alertMessage("warning",null,O.warn_cue_computation_otherTypes)}else T.alertMessage("error",null,O.error_cue_computation_root)},mapCueResponse:function(e,t){var i,n,o=this;e.forEach(function(e){var r=o.selectedItemsForCues[e],s=t[e];if(i={COMBINED:0,CRITICAL:0,ERROR:0,WARNING:0,INFO:0},r&&s){n="COMBINED"===s.cueSeverity?"group":"CRITICAL"===s.cueSeverity?"alert":"ERROR"===s.cueSeverity?"status-ko":"WARNING"===s.cueSeverity?"attention":"INFO"===s.cueSeverity?"info":"status-ok",o._cueComputedIds.indexOf(e)<0&&o._cueComputedIds.push(e);var a="",l="-",c=s.cueCount?s.cueCount:s.cueRowCount;if(c){if(l="",r._options.cueDetails){var d=r._options.cueDetails.cueCount;for(var u in d)d[u]>0&&o._cueGlobalCount[u]>=d[u]&&(o._cueGlobalCount[u]-=d[u])}for(var u in c)i[u]=c[u],o._cueGlobalCount[u]+=c[u];for(var p in i){var g=i[p];if(g>0)0!==l.length&&(l+="; "),l+=o.getNLSValueCueSeverity(p)+":"+g}a=O.row+" "+l+"\n"}r._options.cueDetails={cue:n,cueTooltip:a,cueCount:c}}})},clearCuesForItems:function(){var e=this.contentView.treeDocument.getSelectedNodes();if(e.length<=0)T.alertMessage("error",null,O.error_cue_clear_noSelItems);else if(this._cueComputedIds&&0!==this._cueComputedIds.length){for(var t=0;t<e.length;t++){if((a=e[t])._options.instance){var i=a._options.instance.physicalid,n=a._options.cueDetails?a._options.cueDetails.cueCount:null;if(n)for(var o in n)n[o]>0&&(this._cueGlobalCount[o]-=n[o]);this._cueComputedIds.indexOf(i)>=0&&this._cueComputedIds.splice(this._cueComputedIds.indexOf(i),1),delete this.selectedItemsForCues[i];var r="";if(this._cueGlobalCount)for(var s in this._cueGlobalCount)0!==r.length&&(r+="; "),r+=s+":"+this._cueGlobalCount[s];if(this.selectedItemsForCues)for(var o in this.selectedItemsForCues){var a,l=(a=this.selectedItemsForCues[o])._options.cueDetails;if(l&&0!==r.length){var c=l.cueTooltip;c=c.substring(0,c.indexOf(O.total))+O.total+" "+r,l.cueTooltip=c,a.setAttribute("cueTooltip",c)}}e[t].setAttribute("cue",""),e[t].setAttribute("cueTooltip",""),delete e[t]._options.cueDetails}}0==this._cueComputedIds.length&&(this._cueGlobalCount=null),this.modelEvents.publish({event:"close-properties-panel"}),T.alertMessage("success",null,O.msg_cue_clear_success)}else T.alertMessage("error",null,O.error_cue_clear_noCueComputation)},updateCuesForItems:function(e){var t=this,i=[];e&&e.length>0&&(e.forEach(function(e){var n=e.options.instance?e.options.instance.physicalid:null;t._cueComputedIds&&n&&t._cueComputedIds.indexOf(n)>=0&&i.push(e)}),t.validateCuesForItems(i,!0))}}}),define("DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCues.combinedState",["UWA/Core","DS/UIKIT/Modal","DS/UIKIT/Mask","DS/UIKIT/Iconbar","DS/UIKIT/Scroller","DS/UIKIT/Input/Button","DS/Controls/ButtonGroup","DS/Controls/Toggle","WebappsUtils/WebappsUtils","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.controller","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,g,m,f){"use strict";return m=JSON.parse(m),{displayCombinedConvergenceView:function(e){var i=this.getCombinedConvDefCont(e),n=this.getCombinedConvFooterActions(e);this.combinedCuesModal=new t({className:"combined_convergence_definition",closable:!0,header:f.header_combined_convg_cues,body:i,footer:n}).inject(widget.body),this.combinedCuesModal.show()},getCombinedConvDefCont:function(t){var i,n,r=this,l=e.createElement("div",{class:"combined-conv-maincontainer"}),c=e.createElement("div",{class:"operator-container"}).inject(l);e.createElement("div",{class:"operator-label",html:f.label_operator}).inject(c),"or"===t.operator?(n=!0,i=!1):(i=!0,n=!1);var d=new s({type:"radio"}).inject(c);d.addChild(new a({type:"radio",label:f.label_operator_and,value:"and",checkFlag:i})),d.addChild(new a({type:"radio",label:f.label_operator_or,value:"or",checkFlag:n})),d.addEventListener("change",function(e){r.submitButton.isDisabled()&&e.dsModel.value[0]!==t.operator&&r.submitButton.enable()});var u=e.createElement("div",{class:"combined-conv-container"}).inject(l),p=e.createElement("div",{class:"ccs-header-container"}).inject(u);e.createElement("section",{class:"ccs-title",html:f.label_title}).inject(p),e.createElement("section",{class:"ccs-operation",html:f.label_contribution}).inject(p);var g=e.createElement("div",{class:"combined-cues-container"}).inject(u),m=e.createElement("div",{class:"cues-scroll-container"}).inject(g),h=e.createElement("div",{class:"cues-rowCont-container"}).inject(m);return r.getCuesRowListContent(t.cuesList,h),new o({element:m}).inject(g),l},getCombinedConvFooterActions:function(e){var t=this,i=[];return t.submitButton=new r({id:"combinedConvDefSubmit",value:f.save_button,className:"primary",disabled:!0,events:{onClick:t.onSubmitCombinedCuesDef.bind(t,e.callback)}}),t.cancelButton=new r({id:"combinedConvDefCancel",value:f.cancel_button,events:{onClick:function(){t.combinedCuesModal.destroy()}}}),i.push(t.submitButton),i.push(t.cancelButton),i},getCuesRowListContent:function(t,i){var n,o=this;t&&t.forEach(function(t){n=e.createElement("div",{class:"ccs-row-container",id:"ccs_"+t.id}).inject(i),e.createElement("img",{class:"ccs-icon hidden-xs",src:t.icon_url}).inject(n),e.createElement("section",{class:"ccs-title",html:t.title}).inject(n),t.combinedState||(t.combinedState="ignore"),new r({className:"btn_operation",name:t.combinedState,value:f["val_"+t.combinedState],dropdown:{items:[{name:"yes",text:f.val_yes},{name:"no",text:f.val_no},{name:"ignore",text:f.val_ignore}]},events:{onDropdownClick:function(e,t){this.getName()!==t.name&&(this.setName(t.name),this.setValue(t.text),o.submitButton.isDisabled()&&o.submitButton.enable())}}}).inject(n)})},onSubmitCombinedCuesDef:function(e,t,i){var n,o,r={},s=this.combinedCuesModal.getContent().getElement(".wux-controls-buttongroup .wux-controls-toggle[checked]");s&&(this.combinedCuesModal.getContent().getElements(".ccs-row-container").forEach(function(e){"ignore"!==(o=e.getElement(".btn_operation").name)&&(n=e.id.substring(4),r[n]=o)}),e({operator:s.dsModel.value,combinedCues:r}),this.combinedCuesModal.destroy())}}}),define("DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCues.checklist",["UWA/Core","DS/UIKIT/Modal","DS/UIKIT/Mask","DS/UIKIT/Iconbar","DS/UIKIT/Scroller","DS/UIKIT/Input/Button","DS/UIKIT/Input/Toggle","WebappsUtils/WebappsUtils","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.controller","DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCues.combinedState","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,g,m,f){"use strict";return m=JSON.parse(m),{displayCuesChecklist:function(e,i){this.ccsConfiguration=i,this.allCuesChecked=!0;var n=this.getCuesChecklistContent(e),o=this.getCuesChecklistFooterActions();this.cuesModal=new t({className:"convergence_cues_checklist",closable:!0,header:f.header_convg_cues_checklist,body:n,footer:o,events:{onHide:function(){this.destroy()}}}).inject(widget.body),this.cuesModal.show()},getCuesChecklistContent:function(t){var i=e.createElement("div",{class:"cues-checklist-maincontainer"}),n=e.createElement("div",{class:"cues-checklist-container"}).inject(i),r=e.createElement("div",{class:"header-container"}).inject(n),s=e.createElement("div",{class:"checklist-container"}).inject(n),a=e.createElement("div",{class:"checklist-scroll-container"}).inject(s),l=e.createElement("div",{class:"checklist-rowCont-container"}).inject(a);return this.getCuesRowListContent(t,l,r),new o({element:a}).inject(s),i},getCuesChecklistFooterActions:function(){var e=this,t=[];return e.combinedConv=e.getCombinedConvergenceContainer(),t.push(e.combinedConv),e.submitButton=new r({id:"cuesChecklistSubmit",value:f.save_button,className:"primary",events:{onClick:e.onSubmitCuesChecklist.bind(e)},disabled:!0}),e.cancelButton=new r({id:"cuesChecklistCancel",value:f.cancel_button,events:{onClick:function(){e.cuesModal.destroy()}}}),t.push(e.submitButton),t.push(e.cancelButton),t},getCombinedConvergenceContainer:function(){var t=this,i=!1,n=e.createElement("div",{class:"combined-convergence-footer"});return t.ccsConfiguration&&t.ccsConfiguration.active&&(i=!0),t.confCombinedConvCB=new s({type:"checkbox",className:"primary",id:"cb_combined_conv",label:"",checked:i,events:{onChange:function(){this.isChecked()?t.confCombinedConvBtn.enable():t.confCombinedConvBtn.disable(),t.submitButton.isDisabled()&&t.submitButton.enable()}}}).inject(n),t.confCombinedConvBtn=new r({id:"combined-convergence-configure",class:"combined-convergence-configure",icon:"pencil",disabled:!i,events:{onClick:t._configureCombinedConvergence.bind(t)}}).inject(n),e.createElement("section",{class:"combined-convergence-label",html:f.action_combined_convergence}).inject(n),n},getCuesRowListContent:function(t,i,n){var o=this;let l=[];if(t){var d,u,p,g=a.getWebappsAssetUrl("CATFLCockpitWidget","icons"),m=e.createElement("div",{class:"cue-header-container"}).inject(n);e.createElement("section",{class:"cue-title",html:f.label_title}).inject(m),e.createElement("section",{class:"cue-severity",html:f.label_severity}).inject(m);var h=new s({type:"checkbox",className:"primary",id:"cb_select",label:"",checked:!1,events:{onChange:function(e){this.isChecked()||!this.isChecked()&&h.getContent().classList.contains("mixed")?o._selectAllHandler.call(o,h):o._selectNoneHandler.call(o,h)}}}).inject(m);t.forEach(function(t){p=t.icon&&t.icon.indexOf("https")>=0?t.icon:g+"/I_RFLPLMImplementConnection.png",d=e.createElement("div",{class:"cue-row-container",id:t.id}).inject(i),e.createElement("img",{class:"cue-icon hidden-xs",src:p}).inject(d),e.createElement("section",{class:"cue-title",html:t.title}).inject(d),"CRITICAL"===t.severity?u=f.val_critical:"ERROR"===t.severity?u=f.val_error:"WARNING"===t.severity?u=f.val_warning:(t.severity="INFO",u=f.val_info),new r({className:"btn_severity "+t.severity.toUpperCase(),name:t.severity,value:u,dropdown:{items:[{name:"CRITICAL",text:f.val_critical},{name:"ERROR",text:f.val_error},{name:"WARNING",text:f.val_warning},{name:"INFO",text:f.val_info}]},events:{onDropdownClick:function(e,t){if(this.getName()!==t.name){this.setName(t.name),this.setValue(t.text);var i=this.getContent();"CRITICAL"===t.name?(i.addClassName("CRITICAL"),i.removeClassName("ERROR"),i.removeClassName("WARNING"),i.removeClassName("INFO")):"ERROR"===t.name?(i.addClassName("ERROR"),i.removeClassName("CRITICAL"),i.removeClassName("WARNING"),i.removeClassName("INFO")):"WARNING"===t.name?(i.addClassName("WARNING"),i.removeClassName("CRITICAL"),i.removeClassName("ERROR"),i.removeClassName("INFO")):(i.addClassName("INFO"),i.removeClassName("CRITICAL"),i.removeClassName("ERROR"),i.removeClassName("WARNING")),i.parentNode.getElement('input[type="checkbox"]').checked?o.submitButton.isDisabled()&&o.submitButton.enable():c.alertMessage("warning",null,f.warn_cue_unselected)}}}}).inject(d),new s({type:"checkbox",className:"primary",id:"cb_"+t.id,label:"",checked:t.checked,events:{onChange:function(){var e=o.cuesModal.getContent().getElements(".cue-row-container"),t=o.cuesModal.getContent().getElements(".cue-row-container input:checked");0===t.length?(h.setMixed(!1),h.uncheck(),o.allCuesChecked=!1):e.length===t.length?(o.allCuesChecked=!0,h.setMixed(!1),h.check()):(h.setMixed(!0),h.check()),o.submitButton.isDisabled()&&o.submitButton.enable(),t&&0==t.length&&(o.confCombinedConvCB.uncheck(),o.confCombinedConvBtn.disable(),o.ccsConfiguration={})}}}).inject(d),t.checked?l.push(t.id):o.allCuesChecked=!1}),o.allCuesChecked?h.check():l.length>0&&(h.check(),h.setMixed(!0))}},onSubmitCuesChecklist:function(e,t){var i,n,o,r=this,s={},a={},l=[];r.cuesModal.getContent().getElements(".cue-row-container input:checked").forEach(function(e){C=e.id.substring(3),i=r.cuesModal.getContent().getElement("#"+C),o=i.getElement(".btn_severity"),n=o.name,s[C]={cueId:C,cueSeverity:n},l.push(C)}),a.cues_state=s;var p=r.cuesModal.getContent().getElement("#cb_combined_conv"),g=!1;if(p&&p.checked){if(Object.keys(s).length<=0)return void c.alertMessage("error","",f.error_cues_for_combination,"");var h=r.ccsConfiguration.combinedCues,v=[];if(l&&h){for(var C in h)if(l.indexOf(C)<0){var b=r.cuesModal.getContent().getElement("#"+C+" .cue-title");v.push(b.innerText)}if(v.length>0)return void c.alertMessage("error","",f.replace(f.error_combined_cues_missing,{missingCues:v.join()}),"")}g=!0}r.ccsConfiguration.active=g,a.combined_state=r.ccsConfiguration,u.setUserPreferences({name:m.user_pref_cues,value:JSON.stringify(a)}).then(function(e){d.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-refresh"}),r.cuesModal.destroy(),c.alertMessage("success","",f.msg_cues_saved_success,"")})},_selectAllHandler:function(e){var t=this.cuesModal.getContent().getElements(".cue-row-container input[type=checkbox]");t&&(t.forEach(function(e){e.checked=!0}),this.allCuesChecked=!0,e.setMixed(!1),e.check()),this.submitButton.isDisabled()&&this.submitButton.enable()},_selectNoneHandler:function(e){var t=this.cuesModal.getContent().getElements(".cue-row-container input[type=checkbox]");t&&(t.forEach(function(e){e.checked=!1}),this.allCuesChecked=!1,e.setMixed(!1),e.uncheck()),this.submitButton.isDisabled()&&this.submitButton.enable(),this.confCombinedConvCB.uncheck(),this.confCombinedConvBtn.disable(),this.ccsConfiguration={}},_configureCombinedConvergence:function(){var e,t,i=this,n=[],o=i.ccsConfiguration,r=o.operator,s=o.combinedCues||{},a=i.cuesModal.getContent().getElements(".cue-row-container input:checked");a&&0!=a.length?(a.forEach(function(o){e=o.id.substring(3);var r=i.cuesModal.getContent().getElement("#"+e);t=s[e],n.push({id:e,icon_url:r.getElement(".cue-icon").src,title:r.getElement(".cue-title").innerHTML,combinedState:t})}),g.displayCombinedConvergenceView({active:!0,operator:r,cuesList:n,callback:function(e){i.ccsConfiguration=e,i.submitButton.isDisabled()&&i.submitButton.enable()}})):c.alertMessage("error","",f.error_cues_for_combination,"")}}}),define("DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCues.controller",["UWA/Core","DS/UIKIT/Mask","DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCues.checklist","DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCues.actions","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/CATFLCockpitWidgetComponent","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,s,a,l,c,d,u){"use strict";return c=JSON.parse(c),{init:function(e){this.appContext=e,this.cuesChecklist=[];var t=s.getFLWebModelEventsObj("flweb-model-events");t.subscribe({event:"flcockpit-convergence-cues-checklist"},this.displayCuesChecklist.bind(this)),t.subscribe({event:"flcockpit-convergence-cues-actions"},this.displayCuesActionLinks.bind(this))},displayCuesChecklist:function(){var e=this;e.cuesChecklist.length>0?e.viewCuesChecklist():a.getVisualCues().then(function(t){t.cues.length>0&&(t.cues.forEach(function(t){e.cuesChecklist.push({id:t.cueId,title:t.cueLabel,icon:t.cueIcon})}),e.viewCuesChecklist())})},viewCuesChecklist:function(){var e=this;a.getUserPreferences(c.user_pref_cues).then(function(t){if(t){var n=t.cues_state||t,o=t.combined_state||{};e.cuesChecklist.forEach(function(e){n.hasOwnProperty(e.id)?(e.checked=!0,e.severity=n[e.id].cueSeverity):(e.checked=!1,e.severity="INFO")})}i.displayCuesChecklist(e.cuesChecklist,o)})},displayCuesActionLinks:function(e){var t=this;a.getUserPreferences(c.user_pref_cues).then(function(i){i&&Object.keys(i).length>0&&n.displayCuesActionsonInstance(i,t.appContext,e)})}}});