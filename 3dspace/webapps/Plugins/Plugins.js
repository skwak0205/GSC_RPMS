define("DS/Plugins/RenderPass",["DS/Visualization/ThreeJS_DS","DS/Visualization/RenderMode"],function(e,s){"use strict";var t=1,i=function(i,r,n,a,o,l,h){this.scene=i,this.lockScene=!1,this.name=h,this.id="R"+t++,this.forcePolygonOffset=e.PolygonOffsetForceStatus.DEFAULT,this.overrideMaterial=n,this.renderFaceMode=null,this.renderLineMode=null,this.renderPointMode=null,!0===a?this.renderFaceMode=s.facesMask:null!=a&&(this.renderFaceMode=a||0),!0===o?this.renderLineMode=s.linesMask:null!=o&&(this.renderLineMode=o||e.HideAllRenderLineMode),!0===l?this.renderPointMode=s.pointsMask:null!=l&&(this.renderPointMode=l||0),this.forceMaterialDoubleSide=!1,this.oldRenderFaceMode=0,this.oldRenderFaces=null,this.oldRenderLineMode=e.HideAllRenderLineMode,this.oldRenderPointMode=0,this.oldRenderPoints=null,this.oldRenderSurfacicPoints=!1,this.needsSwap=!1,this.order=0,this.renderPluginsPre=!0,this.renderPluginsPost=!0,this.oldRenderPluginsPre=!0,this.oldRenderPluginsPost=!0,this.disableColorWrite=!1,this.disableDepthWrite=!1,this.disableDepthTest=!1,this.disableBackFaceCulling=!1,this.disableClippingPlanes=!1,this.enableStencilTest=!1,this.enableStencilWrite=!1,this.stencilOpFrontFaces="KEEP",this.stencilOpBackFaces="KEEP",this.stencilOpFrontFacesZFail="KEEP",this.stencilOpBackFacesZFail="KEEP",this.stencilFunc="ALWAYS",this.depthFunc=null,this.materialToUse=null,this.hideSurfacesAndUnclipedMeshes=!1,this.cullFaceMode="back",this.disableBackFaceClipPlanes=!1,this.renderCuttingElements=!1,this.cuttingScene=null,this.isCustomPass=!1,this.disableToneMapping=!1,this.stencilRef=100,this.defaults={},this.cameraName="main",this.idString="main",this.customCamera=null,this.useRenderPriorityOpacity=!1,this.isOITPass=!1,this.dlsToDisableFunc=null,this.composer=null,this.ignoreNoZ=!1,this.disabledByDefault=!1,this.order=0,this.isRobotPass=!1,this.oldRenderPointMode=null,this.renderToScreen=!1,this.renderSurfacicPoints=!1,this.renderedComposerContext=null,this.stateSortingResultFrom=null,this.stateSortingResults={},this.updateStateSortingResult=!0,this.enableGSSOCache=!0,this.forceMaterialMode=!1,this.transformProjectionMatrixCB=null,this.multiRenderCB=null,this._postRenderCB=null,this._preRenderCB=null,this._checkScene=!0};return i.prototype={getDefaultState:function(){return{enabled:!this.disabledByDefault,renderPlugins:!1,renderToCanvas:!1}},setMultiRenderCB:function(e){this.multiRenderCB=e},setStateSortingResultFrom:function(e,s){this.stateSortingResultFrom=e,this.updateStateSortingResult=s},getUsedStateSortingResult:function(s,t,i){var r=this._getStateSortingResultId(t,i);if(this.stateSortingResults[r])return this.stateSortingResults[r];var n=new e.StateSortingResult(this,s.materialToUse);return n.init(),this.stateSortingResults[r]=n,n},setForceMaterialMode:function(e){this.forceMaterialMode=e},setRenderPluginsPre:function(e){this.renderPluginsPre=e},setGSSOCache:function(e){this.enableGSSOCache=e},setRenderPluginsPost:function(e){this.renderPluginsPost=e},setMaterialToUse:function(e){this.materialToUse=e},setDisableColorWrite:function(e){this.disableColorWrite=e},setUseRenderPriorityOpacity:function(e){this.useRenderPriorityOpacity=e},setCustomCamera:function(e){this.customCamera=e},setDisableDepthWrite:function(e){this.disableDepthWrite=e},setDisableDepthTest:function(e){this.disableDepthTest=e},setDisableBackFaceCulling:function(e){this.disableBackFaceCulling=e},setForceMaterialDoubleSide:function(e){this.forceMaterialDoubleSide=e},setDisableClippingPlanes:function(e){this.disableClippingPlanes=e},setEnableStencilWrite:function(e){this.enableStencilWrite=e},setEnableStencilTest:function(e){this.enableStencilTest=e},setCameraName:function(e){this.cameraName=e},setStencilOps:function(e,s){this.stencilOpFrontFaces=e,this.stencilOpBackFaces=s,this.stencilOpFrontFacesZFail=e,this.stencilOpBackFacesZFail=s},setStencilOpsSeparate:function(e,s,t,i){this.stencilOpFrontFaces=e,this.stencilOpBackFaces=s,this.stencilOpFrontFacesZFail=t,this.stencilOpBackFacesZFail=i},setStencilFunc:function(e){this.stencilFunc=e},setCullFaceMode:function(e){this.cullFaceMode=e},setHideSurfacesAndUnclippedMeshes:function(e){this.hideSurfacesAndUnclipedMeshes=e},setDisableBackFaceClipPlanes:function(e){this.disableBackFaceClipPlanes=e},setCuttingScene:function(e){this.cuttingScene=e},setRenderCuttingElements:function(e){this.renderCuttingElements&&!e&&this.setCuttingScene(null),this.renderCuttingElements=e},setCustomPass:function(){this.isCustomPass=!0},setDisableToneMapping:function(e){this.disableToneMapping=e},setDepthFunc:function(e){this.depthFunc=e},setScene:function(e){this.scene=e},setDLsToDisableFunc:function(e){this.dlsToDisableFunc=e},setDLsState:function(e,s){if(this.dlsToDisableFunc){var t=this.dlsToDisableFunc;e.forEach(function(e){t(e)&&(e.active=s)})}},setTransformProjectionMatrixCB:function(e){this.transformProjectionMatrixCB=e},activateAllDLs:function(e){for(var s=0;s<e.length;s++)e[s].active=!0},getCamera:function(e,s){return this.customCamera||e[s]||(this.composer?this.composer.camera:null)},render:function(){var e=arguments[0].info.renderTime;if(e.push(this.name),null===this.multiRenderCB)this.render_internal.apply(this,arguments);else for(var s=0;this.multiRenderCB(this,s++);)this.render_internal.apply(this,arguments);e.pop()},_getStateSortingResultId:function(e,s){return e?e.id+(e._checkCamera?"_"+s.id:"")+(this._checkScene?"_"+this.scene.id:""):-1},_getStateSortingResult:function(s,t,i){var r=this._getStateSortingResultId(s,i);if(this.stateSortingResults[r])return this.stateSortingResults[r];var n=new e.StateSortingResult(this,t.materialToUse);return n.init(),this.stateSortingResults[r]=n,n},render_internal:function(s,t,i,r,n,a,o,l,h,u){var d,c=o[l],f=s.context;this.scene.overrideMaterial=this.overrideMaterial,s.forcePolygonOffset=this.forcePolygonOffset,this.renderedComposerContext=a;var p=null;this.depthFunc&&(p=s.getDepthFunc(),s.setDepthFunc(f[this.depthFunc])),f.stencilFunc(f[this.stencilFunc],this.stencilRef,255),f.stencilOpSeparate(f.FRONT,f.KEEP,f[this.stencilOpFrontFacesZFail],f[this.stencilOpFrontFaces]),f.stencilOpSeparate(f.BACK,f.KEEP,f[this.stencilOpBackFacesZFail],f[this.stencilOpBackFaces]),this.enableStencilTest&&f.enable(f.STENCIL_TEST),null!==this.renderFaceMode&&(this.oldRenderFaceMode=s.renderFaceMode,s.renderFaceMode=this.renderFaceMode),null!==this.renderLineMode&&(this.oldRenderLineMode=s.renderLineMode,s.renderLineMode=this.renderLineMode),this.forceMaterialDoubleSide&&(s.forceMaterialDoubleSide=!0),null!==this.renderPointMode&&(this.oldRenderPointMode=s.renderPointMode,s.renderPointMode=this.renderPointMode),this.oldRenderPluginsPre=s.enableRenderPluginsPre,s.enableRenderPluginsPre=this.renderPluginsPre,this.oldRenderPluginsPost=s.enableRenderPluginsPost,s.enableRenderPluginsPost=this.renderPluginsPost,s.setFaceCulling("back"==this.cullFaceMode?e.CullFaceBack:"front"==this.cullFaceMode?e.CullFaceFront:e.CullFaceNone),0!=this.disableBackFaceClipPlanes&&(s.disableBackFaceClipPlanes=this.disableBackFaceClipPlanes);var g=s.clipPlanesEnabled;this.disableClippingPlanes&&(s.clipPlanesEnabled=!1),this.disableColorWrite&&s.setDisableColorWrite(!0),this.disableDepthWrite&&s.setDisableDepthWrite(!0),this.disableDepthTest&&s.setDisableDepthTest(!0),this.enableStencilWrite&&s.setEnableStencilWrite(!0),this.disableBackFaceCulling&&s.setDisableBackFaceCulling(!0);var m=[];this.hideSurfacesAndUnclipedMeshes&&this.scene.traverse(function(s){if(s instanceof e.Mesh&&s.visible){var t=s.material;t&&!1===t.enableClipPlanes&&(m.push(s),s.visible=!1)}});var P=s.materialToUse;!e.MaterialHasPriority[P]&&this.materialToUse&&(s.materialToUse=this.materialToUse),this.cuttingScene&&(s.cuttingScene=this.cuttingScene),s.setCurrentPass(this),s.autoClearStencil=!1,s.autoClearDepth=!1,s.autoClear=!1;var C=s.gammaInput,S=s.gammaOutput;this.disableToneMapping&&(s.gammaInput=!1,s.gammaOutput=!1);var R,D=s.renderVolumesOnly;s.renderVolumesOnly=this.hideSurfacesAndUnclipedMeshes,this.useRenderPriorityOpacity&&s.materialToUse===e.MaterialToUse.originalMaterial&&(s.useRenderPriorityOpacity=!0),this.forceMaterialMode&&(R=s.materialMode,s.materialMode=!0),null!==this.transformProjectionMatrixCB&&(s.transformProjectionMatrixCB=this.transformProjectionMatrixCB);var b=this.updateStateSortingResult,v=null;v=this.stateSortingResultFrom&&this.stateSortingResultFrom.renderedComposerContext?this.stateSortingResultFrom._getStateSortingResult(this.stateSortingResultFrom.renderedComposerContext,s,c):this._getStateSortingResult(a,s,c),this.setDLsState(v._displayLists,!1),s.activateSplitScreenMode(!(!u&&i));for(this._preRenderCB&&this._preRenderCB(s),u?s.render(this.scene,this.getCamera(o,l),void 0,void 0,void 0,v,b,!0):s.render(this.scene,this.getCamera(o,l),i,!1,!1,v,b,!0),this._postRenderCB&&this._postRenderCB(s),null!==this.transformProjectionMatrixCB&&(s.transformProjectionMatrixCB=null),this.forceMaterialMode&&(s.materialMode=R),this.activateAllDLs(v._displayLists),this.useRenderPriorityOpacity&&(s.useRenderPriorityOpacity=!1),s.renderVolumesOnly=D,s.gammaInput=C,s.gammaOutput=S,s.setCurrentPass(null),this.cuttingScene&&(s.cuttingScene=null),s.materialToUse=P,d=0;d<m.length;d++)m[d].visible=!0;s.setDisableColorWrite(!1),this.disableClippingPlanes&&(s.clipPlanesEnabled=g),this.disableBackFaceCulling&&s.setDisableBackFaceCulling(!1),s.setDisableDepthWrite(!1),s.setDisableDepthTest(!1),s.setEnableStencilWrite(!1),this.enableStencilTest&&f.disable(f.STENCIL_TEST),null!==this.renderFaceMode&&(s.renderFaceMode=this.oldRenderFaceMode),null!==this.renderLineMode&&(s.renderLineMode=this.oldRenderLineMode),null!==this.renderPointMode&&(s.renderPointMode=this.oldRenderPointMode),0!=this.disableBackFaceClipPlanes&&(s.disableBackFaceClipPlanes=0),s.enableRenderPluginsPre=this.oldRenderPluginsPre,s.enableRenderPluginsPost=this.oldRenderPluginsPost,s.forceMaterialDoubleSide=!1,this.scene.overrideMaterial=null,f.stencilFunc(f.ALWAYS,0,255),f.stencilOp(f.KEEP,f.KEEP,f.KEEP),p&&s.setDepthFunc(p),s.forcePolygonOffset=e.PolygonOffsetForceStatus.DEFAULT}},i}),define("Plugins/RenderPass",["DS/Plugins/RenderPass","DS/DSMigration/DSMigration"],function(e,s){return s.deprecateModule("Plugins/RenderPass"),e}),define("DS/Plugins/MaskPass",["DS/Visualization/ThreeJS_DS"],function(e){"use strict";return null}),define("Plugins/MaskPass",["DS/Plugins/MaskPass","DS/DSMigration/DSMigration"],function(e,s){return s.deprecateModule("Plugins/MaskPass"),e}),define("DS/Plugins/ClearMaskPass",["DS/Visualization/ThreeJS_DS"],function(e){"use strict";return null}),define("Plugins/ClearMaskPass",["DS/Plugins/ClearMaskPass","DS/DSMigration/DSMigration"],function(e,s){return s.deprecateModule("Plugins/ClearMaskPass"),e}),define("DS/Plugins/PluginPass",["DS/Visualization/ThreeJS_DS"],function(e){"use strict";var s=function(e,s,t,i,r){this.scene=e,this.camera=s,this.name=t,this.cameraName="main",this.plugin=i,this.plugin.init(r),this.composer=null,this.stateSortingResults={}};return s.prototype={getDefaultState:function(){return{enabled:!1,renderPlugins:!1}},setCameraName:function(e){this.cameraName=e},setScene:function(e){this.scene=e},render:function(s,t,i,r,n,a,o,l,h){var u=o[l],d=null;this.stateSortingResults[a.id]?d=this.stateSortingResults[a.id]:((d=new e.StateSortingResult(this,-1)).init(),this.stateSortingResults[a.id]=d),s.doRenderPlugins([this.plugin],this.scene,u,i,d)},dispose:function(){this.plugin.dispose()}},s}),define("Plugins/PluginPass",["DS/Plugins/PluginPass","DS/DSMigration/DSMigration"],function(e,s){return s.deprecateModule("Plugins/PluginPass"),e}),define("DS/Plugins/UserPass",["UWA/Class"],function(e){"use strict";var s=0;return e.extend({init:function(e){this.id=s++,this.manager=e.manager,this.name=e.name,this.renderList=e.renderList,this.enabled=!0,this._passes=[],this._inserted=!1,this._cameraName=null},enable:function(e){var s;for(this.enabled=!!e,s=0;s<this._passes.length;s++)this._passes[s].disabledByDefault=!this.enabled;this.manager._getMainComposer().enableCustomPassNEW(this._passes)},_setupPasses:function(){var e;for(e=0;e<this._passes.length-1;e++)this._passes[e].userPass=this},_setCameraName:function(e){this._cameraName=e}})}),define("DS/Plugins/UserRenderList",["UWA/Class"],function(e){"use strict";var s=0;return e.extend({init:function(e){this.name=e,this.id=s++},_getIdString:function(){return"_userIdString_"+this.id+(this.name?"_"+this.name:"")}})}),define("DS/Plugins/ShaderPass",["DS/Visualization/ThreeJS_DS"],function(e){"use strict";var s=1,t=function(t,i,r){this.textureID=void 0!==i?i:"tDiffuse",this.uniforms=e.UniformsUtils.clone(t.uniforms),this.name=r,this.id="S"+s++,this.defines={},t.defines&&(this.defines=Object.assign({},t.defines)),this.material=new e.ShaderMaterial({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,defines:this.defines}),this.material.force=!0,this.material.polygonOffset=!0,this.material.polygonOffsetFactor=0,this.material.polygonOffsetUnits=0,this.renderToScreen=!1,this.disableDepthTest=!0,this.needsSwap=!0,this.composer=null,this.requiredComposers=[],this.forceRenderTarget=null,this.order=0,this.isCustomPass=!1,this.defaults={},this.linkedComposerContexts=[],this.idString="main",this.changeRenderTargetProperties=null,this.enableWarmStart=!1,this.beforeRenderCB=null,this.afterRenderCB=null,this.requiredReadBuffer=null,this.isOITPass=!1,this.composer=null,this.disabledByDefault=!1,this.order=0,this.gammaCorrectionPass=!1,this.isRobotPass=!1,this.stateSortingResults={},this.geometry=[e.createPlaneGeometryDS(2,2)],this.quad=new e.Mesh(this.geometry,null),this.quad.frustumCulled=!1,this.quad.visibilityFree=!0,this.shaderPassScene=new e.Scene,this.shaderPassScene.add(this.quad)};return t.prototype={_updateMaterialShader:function(e){this.material.dispose(),this.material.fragmentShader=e.fragmentShader,this.material.vertexShader=e.vertexShader},compileShader:function(e){e&&e.initMaterial(this.material,[],this.quad,null,this.material.programManager.getProgramID(this.quad,null,0),null,0),this.material.needsUpdate=!0},setForceRenderTarget:function(e){this.forceRenderTarget=e},addRequiredComposer:function(e){this.requiredComposers.push(e)},setCustomPass:function(){this.isCustomPass=!0},getDefaultState:function(){return{enabled:!this.disabledByDefault,renderToCanvas:!1,isLastPass:!1}},addLinkedEffectComposerContext:function(e){this.linkedComposerContexts.indexOf(e)<0&&(this.linkedComposerContexts.push(e),e.useCount++)},shareDepth:function(e,s,t){var i=e.composerContext.forceRenderTarget;i&&i.shareDepthFrom===t||(i&&i.dispose(),(i=e.renderTargetPool.buildRenderTarget(e.composerContext.width,e.composerContext.height,e.composerContext.renderTargetProperties.options,null,t,!0)).generateMipmaps=!1,e.composerContext.forceRenderTarget=i,this.requiredReadBuffer=t)},render:function(s,t,i,r,n,a,o,l,h,u){var d,c=s.info.renderTime;for(c.push(this.name),!n&&this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=t),this.beforeRenderCB&&this.beforeRenderCB(t),d=0;d<this.requiredComposers.length;d++){var f=this.requiredComposers[d];f.bShareDepth&&this.shareDepth(f,s,t),f.needsCameraUpdate&&(this.requiredComposers[d].composerContext.cameraName=a.cameraName);var p=f.getAllPasses();if(p.length>0&&void 0!==p[0].uniforms){var g=p[0].uniforms;void 0!==g[this.textureID]&&(g[this.textureID].value=t)}this.requiredComposers[d].render(void 0,void 0,o,h)}this.quad.material=this.material,s.setCurrentPass(this),s.autoClearStencil=!1,s.autoClearDepth=!1,s.activateSplitScreenMode(!i),s.setDisableDepthTest(this.disableDepthTest),null!==this.forceRenderTarget&&(i=this.forceRenderTarget);var m=a?a.id:-1,P=null;this.stateSortingResults[m]?P=this.stateSortingResults[m]:((P=new e.StateSortingResult(this,-1)).init(),this.stateSortingResults[m]=P);var C=s.renderFaceMode;s.renderFaceMode=0,u?s.render(this.shaderPassScene,this.composer.camera,void 0,void 0,void 0,P,!0):s.render(this.shaderPassScene,this.composer.camera,i,!1,void 0,P,!0),s.renderFaceMode=C,s.setDisableDepthTest(!1),s.setCurrentPass(null),this.afterRenderCB&&this.afterRenderCB(),c.pop()}},t}),define("Plugins/ShaderPass",["DS/Plugins/ShaderPass","DS/DSMigration/DSMigration"],function(e,s){return s.deprecateModule("Plugins/ShaderPass"),e}),define("DS/Plugins/XMLV6SmartLoaderPassPlugin",["DS/VisuLoaders/XMLV6SmartLoaderPassPlugin"],function(e){"use strict";return e}),define("Plugins/XMLV6SmartLoaderPassPlugin",["DS/Plugins/XMLV6SmartLoaderPassPlugin","DS/DSMigration/DSMigration"],function(e,s){return s.deprecateModule("Plugins/XMLV6SmartLoaderPassPlugin"),e}),define("DS/Plugins/ClearPass",["DS/Visualization/ThreeJS_DS"],function(e){"use strict";var s=1,t=function(t){this.name=t,this.id="C"+s++,this.clearColor=null,this.clearAlpha=1,this.oldClearColor=new e.Color,this.oldClearAlpha=1,this.clear=!0,this.clearbColor=!1,this.clearDepth=!1,this.needsSwap=!1,this.clearStencil=!1,this.clearStencilValue=null,this.invertTarget=!1,this.scene=null,this.idString=null,this.composer=null,this.order=0,this.disabledByDefault=!1,this.isCustomPass=!1,this.isRobotPass=!1,this.defaults={clear:!0,doClearDepth:!1}};return t.prototype={getDefaultState:function(){return{enabled:!this.disabledByDefault,clear:this.defaults.clear,clearColor:this.clearColor,clearAlpha:this.clearAlpha,doClearDepth:this.defaults.doClearDepth,renderToCanvas:!1}},setClearStencil:function(e){this.clearStencil=e},setClearDepth:function(e){this.clearDepth=e},setCustomPass:function(){this.isCustomPass=!0},setScene:function(e){this.scene=e},render:function(e,s,t,i,r,n,a,o,l,h){if(!this.idString||!this.scene||0!==this.scene.getNbWebGLObjects(this.idString)){var u=e.info.renderTime;u.push(this.name);var d=e.context;this.clearColor&&(this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),null!==this.clearStencilValue?d.clearStencil(this.clearStencilValue):d.clearStencil(100),e.autoClear=!1,e.autoClearColor=this.clear||this.clearbColor,e.autoClearDepth=this.clear||this.clearDepth,e.autoClearStencil=this.clear||this.clearStencil,e.setCurrentPass(this);var c,f=null;h||(f=this.invertTarget?s:t),e.setRenderTarget(f),e.splitScreenMode?e.activateSplitScreenMode(!f):(c=e.getScissorTest(),e.enableScissorTest(!1)),e.clear(this.clear||this.clearbColor,this.clear||this.clearDepth,this.clear||this.clearStencil),e.splitScreenMode||e.enableScissorTest(c),e.setCurrentPass(null),u.pop()}}},t}),define("Plugins/ClearPass",["DS/Plugins/ClearPass","DS/DSMigration/DSMigration"],function(e,s){return s.deprecateModule("Plugins/ClearPass"),e}),define("DS/Plugins/ComposerContext",["DS/Visualization/ThreeJS_DS"],function(e){"use strict";var s=1,t=30;function i(e){!e&&t>0&&(console.warn("Rendering EffectComposer without specifying a result name"),t--)}var r=30,n=function(t,i,n,a){if(this.id=s++,void 0===t){var o=window.innerWidth||1,l=window.innerHeight||1;e.LinearFilter,e.LinearFilter,e.RGBFormat;t=new e.WebGLRenderTargetProperties(o,l,"uint")}this.renderTargetProperties=t,this.width=this.renderTargetProperties?this.renderTargetProperties.width:void 0,this.height=this.renderTargetProperties?this.renderTargetProperties.height:void 0,this.originalRenderTargetProperties=t,this.name=n,this.readBuffer=null,this.writeBuffer=null,this.renderResults={},this.usedBy=[],this.useCount=1,this.keepResult=!1,this.forceRenderTarget=a,this.passes=[],this.passStates=[],this.composer=i,i.contexts.push(this),this.needsUpdate=!0,this.cameras=[],this.updateStates(),this.onEffectComposerChange=null,Object.defineProperty(this,"renderTarget2",{get:function(){var e;for(e in r>0&&(console.warn("Accessing renderTarget2 deprecated property"),r--),this.renderResults)return this.renderResults[e];return null}}),this.beforeRenderCB=null,this.afterRenderCB=null,this.needRequiredReadBuffer=!1,this.cameraName="",this.clearReadBuffer=0,this.noIdCheck=!1,this.enableGSSOCache=!0,this._forbidRenderableState=0,this._checkCamera=!1};return n.prototype={getPassState:function(e){var s,t=this.passes.indexOf(e);return t<0&&e&&(t=this.passes.length,this.passes.push(e),(s=e.getDefaultState()).pass=e,this.passStates[t]=s),this.passStates[t]},updateStates:function(){var e,s=this.composer.getAllPasses(),t=[];for(e=0;e<s.length;e++)t.push(this.getPassState(s[e]));this.passes=s,this.passStates=t,this.onEffectComposerChange&&this.onEffectComposerChange(this)},setBeforeRenderCB:function(e){this.beforeRenderCB=e},setAfterRenderCB:function(e){this.afterRenderCB=e},enablePass:function(e,s){if(e){var t=this.getPassState(e);!!t.enabled!=!!s&&this.composer&&this.composer.renderer.resetGSSOCache(),t.enabled=s}},setAsLastPass:function(e,s){e&&(this.getPassState(e).isLastPass=s)},enableRenderCuttingElementsPasses:function(e){var s,t=0;for(t=0;t<this.passes.length;t++)(s=this.passes[t]).renderCuttingElements&&!s.disabledByDefault&&this.enablePass(s,e)},setPassClear:function(e,s,t,i){var r=this.getPassState(e);r.clear=s,void 0!==t&&(r.clearColor=t),void 0!==i&&(r.clearAlpha=i)},setPassRenderToCanvas:function(e,s){this.getPassState(e).renderToCanvas=s},setPassClearDepth:function(e,s){this.getPassState(e).doClearDepth=s},setRenderPlugins:function(e,s){this.getPassState(e).renderPlugins=s},setCamera:function(e,s){this.getPassState(e).camera=s},setCameraName:function(e){this.cameraName=e},setTransformCameraCB:function(e){this.transformCameraCB=e},clearReadBufferIfRequired:function(e,s){0!==this.clearReadBuffer&&(2!==this.clearReadBuffer&&e.pushRenderTarget(this.readBuffer),this.clearReadBuffer=0,this.readBuffer=null)},swapBuffers:function(e,s,t){var i=this.writeBuffer;this.writeBuffer=this.readBuffer,this.readBuffer=i,this.readBuffer||this.acquireReadBuffer(e,s),!this.writeBuffer&&t&&this.acquireWriteBuffer(e,s)},useWarmStart:function(e,s){var t=this.getPassState(e).warmStart[s];this.readBuffer&&(renderTargetPool.pushRenderTarget(this.readBuffer),this.readBuffer=null),this.readBuffer=t,this.clearReadBuffer=2},saveReadRenderTargetForLatterWarmStart:function(e,s,t){var i=this.getPassState(e);i.warmStart||(i.warmStart={});var r=i.warmStart[t];r&&s.pushRenderTarget(r),i.warmStart[t]=this.readBuffer,this.clearReadBuffer=2},changeRenderTargetProperties:function(e,s,t){this.clearReadBuffer=1,this.writeBuffer&&s.pushRenderTarget(this.writeBuffer,this),this.writeBuffer=null,e.width=this.width,e.height=this.height,this.renderTargetProperties=e,this.acquireWriteBuffer(s,t)},linkToShaderPassUniform:function(e,s){e.addLinkedEffectComposerContext(this),this.usedBy.indexOf(s)<0&&this.usedBy.push(s)},linkTo_internal:function(e,s,t){var r;for(this.noIdCheck||i(t),e.value=this.renderResults[t],r=0;r<this.usedBy.length;r++)if(this.usedBy[r]===e)return;this.usedBy.push(e)},removeLinks:function(){this.usedBy=[]},updateLinks:function(e){var s;for(this.noIdCheck||i(e),s=0;s<this.usedBy.length;s++)this.usedBy[s].value=this.forceRenderTarget?this.forceRenderTarget:this.renderResults[e]},restoreOriginalRenderTargetProperties:function(e,s){e.areRenderTargetOptionsEqual(this.renderTargetProperties,this.originalRenderTargetProperties)||(this.renderTargetProperties=this.originalRenderTargetProperties,this.renderResults[s]&&(e.pushRenderTarget(this.renderResults[s]),this.renderResults[s]=null))},acquireWriteBuffer:function(e,s){this.noIdCheck||i(s),this.renderTargetProperties&&(this.renderResults[s]?(this.writeBuffer=this.renderResults[s],this.renderResults[s]=null):this.writeBuffer||(this.writeBuffer=e.buildRenderTarget(this.renderTargetProperties.width,this.renderTargetProperties.height,this.renderTargetProperties.options||this.renderTargetProperties.optionsId,this)))},acquireReadBuffer:function(e,s){this.noIdCheck||i(s),this.renderTargetProperties&&(this.readBuffer||(this.readBuffer=e.buildRenderTarget(this.renderTargetProperties.width,this.renderTargetProperties.height,this.renderTargetProperties.options,this)))},getResult:function(e,s){var t=this.renderResults[e];return s&&(this.renderResults[e]=null),t},selectResult:function(e,s){this.renderResults[s]=this.writeBuffer,this.writeBuffer=null,this.renderResults[s]&&(this.renderResults[s].useCount=this.useCount),this.writeBuffer&&(e.pushRenderTarget(this.writeBuffer,this),this.writeBuffer=null),this.readBuffer&&(e.pushRenderTarget(this.readBuffer,this),this.readBuffer=null)},releaseRenderTargets:function(e,s){var t=this.renderResults[s];!this.keepResult&&t&&(t.useCount--,t.useCount<=0&&(e.pushRenderTarget(t,this),this.renderResults[s]=null))},setSize:function(e,s,t){if(this.width!==e||this.height!==s){var i,r;for(r=0;r<this.passStates.length;r++){void 0;var n=this.passes[r];n.requiredReadBuffer&&(n.requiredReadBuffer.dispose(),n.requiredReadBuffer=null)}for(i in this.renderResults)!this.renderResults[i]||t&&i!=t||this.renderResults[i].dispose();t||(this.renderResults={}),this.originalRenderTargetProperties&&(this.originalRenderTargetProperties.width=e,this.originalRenderTargetProperties.height=s),this.renderTargetProperties&&(this.renderTargetProperties.width=e,this.renderTargetProperties.height=s),this.forceRenderTarget&&this.forceRenderTarget.dispose(),this.forceRenderTarget=null,t||(this.readBuffer&&this.readBuffer.dispose(),this.readBuffer=null,this.writeBuffer&&this.writeBuffer.dispose(),this.writeBuffer=null),this.width=e,this.height=s}},dispose:function(){this.setSize(0,0)},setGSSOCache:function(e){this.enableGSSOCache=e},setOnEffectComposerChangeCallback:function(e){this.onEffectComposerChange=e,e&&e(this)}},n}),define("Plugins/ComposerContext",["DS/Plugins/ComposerContext","DS/DSMigration/DSMigration"],function(e,s){return s.deprecateModule("Plugins/ComposerContext"),e}),define("DS/Plugins/CSSNodesPass",["DS/Visualization/ThreeJS_DS"],function(e){"use strict";var s=function(e,s){this.scene=e,this.name=s,this.cameraName="main"};return s.prototype={getDefaultState:function(){return{enabled:!1,renderPlugins:!1}},setScene:function(e){this.scene=e},render:function(e,s,t,i,r,n,a,o,l){var h=a[o];e.updateCSSNodes(this.scene,h)}},s}),define("DS/Plugins/EffectComposer",["DS/Visualization/ThreeJS_DS","DS/Plugins/ShaderPass","DS/Plugins/ComposerContext","DS/Plugins/ClearPass"],function(e,s,t,i){"use strict";var r="--\x3e";function n(e){var s=e.slice(r.length);return s.startsWith("(")&&s.endsWith(")")&&(s=s.slice(1,s.length-1),!0),{list:s,privateList:!1}}function a(e,s){var t,i,a,o,l="passes",h=!1,u=!1;if(s){if((t=s.indexOf(e.name))<0)throw new Error("unknown added pass");for(i=t;i>=0&&!h;i--)(a=s[i]).startsWith(r)&&(l=(o=n(a)).list,u=o.privateList,h=!0)}else t=e.order;return{order:t,list:l,privateList:u}}function o(e,s,t){e.splice.apply(e,[s,0].concat(t))}var l=function(e){this.name=e,this.preCustomPasses=[],this.passes=[],this.postCustomPasses=[],this.privateList=!1};l.prototype.addPass=function(e,s,t){if(this.passes.length&&void 0!==s)for(var i=0;i<this.passes.length;i++){if(s<a(this.passes[i],t).order)return void this.passes.splice(i,0,e)}this.passes.push(e)};var h=0,u=function(s,i,a,o){var u,d,c,f;if(this.renderer=s,this.renderTargetPool=a,this.orderedPassNames=o||null,this.id=h,h++,this.contexts=[],this.passLists=[],o)for(u=0;u<o.length;u++){var p;if((d=o[u]).startsWith(r))c=(f=n(d)).list,(p=new l(c)).privateList=f.privateList,this.passLists.push(p)}else this.passLists.push(new l("passes"));for(this.passListIndex={},u=0;u<this.passLists.length;u++)this.passListIndex[this.passLists[u].name]=u;this.preCustomPasses=[],this.postCustomPasses=[],this.camera=new e.OrthographicCamera(-1,1,1,-1,0,1),this.camera._renderingRole=e._CameraRoles.FULL_SCREEN,this.geometry=[e.createPlaneGeometryDS(2,2)],this.quad=new e.Mesh(this.geometry,null),this.quad.frustumCulled=!1,this.quad.visibilityFree=!0,this.shaderPassScene=new e.Scene,this.shaderPassScene.add(this.quad),this.renderScene=null,this.enabled=!0,this.composerContext=i?new t(i,this):null,this.bShareDepth=!1,this.needsCameraUpdate=!1,this.keepResult=!1};return u.prototype={dispose:function(){this.quad.dispose()},getAllPasses:function(e){var s,t,i=[];for(s=e=e||0;s<this.passLists.length;s++)(t=this.passLists[s]).preCustomPasses.length&&(i=i.concat(t.preCustomPasses)),i=i.concat(t.passes),t.postCustomPasses.length&&(i=i.concat(t.postCustomPasses));return i},setComposerContext:function(e){this.composerContext=e},updateComposerContexts:function(e){var s;for(s=0;s<this.contexts.length;s++)this.contexts[s].updateStates(e)},swapBuffers:function(e,s,t){this.composerContext.swapBuffers(e,s,t)},addPass:function(e){var s=a(e,this.orderedPassNames),t=s.order;this.passLists[this.passListIndex[s.list]].addPass(e,t,this.orderedPassNames),e.composer=this,this.updateComposerContexts()},insertPass:function(e,s,t){t.splice(s,0,e),e.composer=this,this.updateComposerContexts()},enablePass:function(e,s){this.composerContext.enablePass(e,s)},linkToShaderPassUniform:function(e,s,t){this.composerContext.linkToShaderPassUniform(e,s,t)},removeLinks:function(){this.composerContext.removeLinks()},updateScene:function(e){this.renderScene=e;var s,t,i=this.getAllPasses(),r=i.length;for(t=0;t<r;t++)(s=i[t]).setScene&&!s.lockScene&&s.setScene(e)},getRenderResult:function(e){return this.composerContext.renderResults[e]},findRequiredReabBuffer:function(e,t){if(!this.composerContext.needRequiredReadBuffer)return[{forceWriteBufferIndex:-1,requiredReadBuffer:null}];t=t||0;for(var i,r=this.getAllPasses(),n=r.length,a=-1,o=e,l=null,h=e;h<n;h++){if(i=r[h],h>=t&&i&&i.requiredReadBuffer&&this.composerContext.getPassState(i).enabled){l=i.requiredReadBuffer,-1===a&&(a=e),o=h;break}i instanceof s&&this.composerContext.getPassState(i).enabled&&(a=h)}l||(a=-1);var u=[{forceWriteBufferIndex:a,requiredReadBuffer:l}];return e!==o&&(u=u.concat(this.findRequiredReabBuffer(o,o+1))),u},render:function(e,s,t,r,n){if(this.enabled)if(this.composerContext.needsUpdate||!this.composerContext.keepResult){var a=this.renderer.info.renderTime;a.push(this.composerContext.name),this.renderer._forbidRenderableState|=this.composerContext._forbidRenderableState,this.composerContext.restoreOriginalRenderTargetProperties(this.renderTargetPool,r),this.composerContext.acquireWriteBuffer(this.renderTargetPool,r),void 0!==s&&this.composerContext.writeBuffer&&(this.composerContext.writeBuffer.activeCubeFace=s),this.composerContext.beforeRenderCB&&this.composerContext.beforeRenderCB(this.composerContext);var o,l,h,u,d=this.getAllPasses(),c=d.length,f=0;if(n){if((f=d.indexOf(n))<0)return void a.pop();this.composerContext.useWarmStart(n,r)}var p=!1,g=0===f,m=this.findRequiredReabBuffer(f),P=0,C=m[P++];for(l=f;l<c;l++){var S=null;if((o=d[l]).gammaCorrectionPass&&(p=!0),h=this.composerContext.getPassState(o),void 0!==o.clear&&(o.clear=h.clear,o.clearColor=h.clearColor,o.clearAlpha=h.clearAlpha),o.setClearDepth&&o.setClearDepth(h.doClearDepth),o.setRenderPluginsPre&&o.setRenderPluginsPre(h.renderPlugins),o.setRenderPluginsPost&&o.setRenderPluginsPost(h.renderPlugins),S=h.cameraName?h.cameraName:this.composerContext.cameraName?this.composerContext.cameraName:o.cameraName,h.isLastPass)break;if(h.enabled){var R=o.needsSwap&&f!==l&&!g;if(l===C.forceWriteBufferIndex?(this.composerContext.readBuffer&&this.renderTargetPool.pushRenderTarget(this.composerContext.readBuffer),this.composerContext.readBuffer=this.composerContext.writeBuffer,this.composerContext.writeBuffer=C.requiredReadBuffer,C=m[P++]):R&&this.swapBuffers(this.renderTargetPool,r,!o.changeRenderTargetProperties),o.changeRenderTargetProperties&&this.composerContext.changeRenderTargetProperties(o.changeRenderTargetProperties,this.renderTargetPool,r),o.enableWarmStart&&o!==n&&this.composerContext.saveReadRenderTargetForLatterWarmStart(o,this.renderTargetPool,r),o.setDisableToneMapping&&p&&o.setDisableToneMapping(!0),this.composerContext.forceRenderTarget?o.render(this.renderer,this.composerContext.readBuffer,this.composerContext.forceRenderTarget,e,g,this.composerContext,t,S,r,h.renderToCanvas):o.render(this.renderer,this.composerContext.readBuffer,this.composerContext.writeBuffer,e,g,this.composerContext,t,S,r,h.renderToCanvas),o.requiredReadBuffer&&(this.composerContext.clearReadBuffer=2),this.composerContext.clearReadBufferIfRequired(this.renderTargetPool,r),o instanceof i||(g=!1),o.linkedComposerContexts)for(u=0;u<o.linkedComposerContexts.length;u++)o.linkedComposerContexts[u].releaseRenderTargets(this.renderTargetPool,r)}}this.composerContext.selectResult(this.renderTargetPool,r),this.composerContext.releaseRenderTargets(this.renderTargetPool,r),this.composerContext.updateLinks(r),this.composerContext.afterRenderCB&&this.composerContext.afterRenderCB(this.composerContext),this.renderer._forbidRenderableState&=~this.composerContext._forbidRenderableState,a.pop()}else this.renderer.setRenderTarget(this.composerContext.renderResults[r])},setSize:function(e,s){this.composerContext&&this.composerContext.setSize(e,s)},insertCustomPassAfterPass:function(e,s){var t,i=this.passLists[this.passListIndex.main],r=i.preCustomPasses,n=i.postCustomPasses;if(e.setCustomPass(),s)if((t=r.indexOf(s))>=0)r.splice(t+1,0,e);else{if(!((t=n.indexOf(s))>=0))throw new Error("Reference custom pass not found");n.splice(t+1,0,e)}else n.splice(0,0,e);this.updateComposerContexts()},insertCustomPassBefore:function(e,s){var t,i=this.passLists[this.passListIndex.main],r=i.preCustomPasses,n=i.postCustomPasses;if(e.setCustomPass(),s)if((t=r.indexOf(s))>=0)r.splice(t,0,e);else{if(!((t=n.indexOf(s))>=0))throw new Error("Reference custom pass not found");n.splice(t,0,e)}else r.push(e);this.updateComposerContexts()},getPassList:function(e){return this.passLists[this.passListIndex[e]]},insertCustomPassBeforeNEW:function(e,s){if(!s)return!1;e instanceof Array||(e=[e]);var t,i,r,n,a,l=!1;if("string"==typeof s||s instanceof String){if((r=this.getPassList(s)).privateList)return!1;o(r.preCustomPasses,r.preCustomPasses.length-1,e)}else{for(t=0;t<this.passLists.length&&!l;t++)for(a=[(r=this.passLists[t]).preCustomPasses,r.postCustomPasses],i=0;i<a.length&&!l;i++)(n=a[i].indexOf(s))>=0&&(o(a[i],n,e),l=!0);if(!l)return console.warn("ERROR: Reference custom pass not found"),!1}for(t=0;t<e.length;t++)e[t].composer=this;return this.updateComposerContexts(),!0},insertCustomPassAfterNEW:function(e,s){if(!s)return!1;e instanceof Array||(e=[e]);var t,i,r,n,a,l=!1;if("string"==typeof s||s instanceof String){if((r=this.getPassList(s)).privateList)return!1;o(r.postCustomPasses,0,e)}else{for(t=0;t<this.passLists.length&&!l;t++)for(a=[(r=this.passLists[t]).preCustomPasses,r.postCustomPasses],i=0;i<a.length&&!l;i++)(n=a[i].indexOf(s))>=0&&(o(a[i],n+1,e),l=!0);if(!l)return console.warn("ERROR: Reference custom pass not found"),!1}for(t=0;t<e.length;t++)e[t].composer=this;return this.updateComposerContexts(),!0},removeCustomPassNEW:function(e){var s,t,i,r,n,a,o=e[0];for(s=0;s<this.passLists.length&&!r;s++)for(a=[(n=this.passLists[s]).preCustomPasses,n.postCustomPasses],t=0;t<a.length&&!r;t++)(i=a[t].indexOf(o))>=0&&(a[t].splice(i,e.length),r=!0);this.updateComposerContexts()},enableCustomPassNEW:function(e){var s,t,i;for(s=0;s<e.length;s++)for(t=e[s],i=0;i<this.contexts.length;i++)this.contexts[i].enablePass(t,!t.disabledByDefault);this.updateComposerContexts()},removePasses:function(e){var s,t,i,r,n,a;for(s=0;s<this.passLists.length&&!t;s++){for(i=this.passLists[s].passes,t=!1,n=0;n<e.length;n++)(r=i.indexOf(e[n]))>=0&&(t=!0,i[r]=null);if(t){for(a=0,n=0;n<i.length;n++)i[n]&&(i[a]=i[n],a++);i.length=a}}this.updateComposerContexts()},updateLinks:function(e){this.composerContext.updateLinks(e)},getPostEffectPasses:function(){var e=this.passListIndex.postEffects1,s=[],t=0;for(t=e;t<this.passLists.length;t++)t>e&&(s=s.concat(this.passLists[t].preCustomPasses)),s=(s=s.concat(this.passLists[t].passes)).concat(this.passLists[t].postCustomPasses);return s}},u}),define("Plugins/EffectComposer",["DS/Plugins/EffectComposer","DS/DSMigration/DSMigration"],function(e,s){return s.deprecateModule("Plugins/EffectComposer"),e}),define("DS/Plugins/UserSceneGraphPass",["DS/Plugins/UserPass","DS/Plugins/RenderPass","DS/Visualization/RenderMode"],function(e,s,t){function i(e){return!!e}return e.extend({init:function(e){this._parent(e),this.mainPass=new s(null,null,null,null,null,null,"_UserSceneGraphPass_"+this.id+"_"+this.name),this.sectionCappingPass=new s(null,null,null,t.facesMask,!1,!1,"passSectionCappingFrontFaces"),this.sectionCappingPass.setRenderCuttingElements(!0),this.sectionCappingPass.setEnableStencilTest(!0),this.sectionCappingPass.setEnableStencilWrite(!0),this.sectionCappingPass.setDisableColorWrite(!0),this.sectionCappingPass.setDisableDepthWrite(!0),this.sectionCappingPass.setStencilFunc("ALWAYS"),this.sectionCappingPass.setStencilOps("INCR_WRAP","DECR_WRAP"),this.sectionCappingPass.setDisableBackFaceCulling(!0),this.sectionCappingPass.setHideSurfacesAndUnclippedMeshes(!0),this.sectionCappingPass.setDisableBackFaceClipPlanes(1),this.sectionCappingPass.setRenderPluginsPre(!1),this.sectionCappingPass.setRenderPluginsPost(!1),this.sectionCappingPass.ignoreNoZ=!0,this._passes.push(this.mainPass),this._passes.push(this.sectionCappingPass)},setDisableColorWrite:function(e){this._passes[0].setDisableColorWrite(i(e))},setDisableDepthWrite:function(e){this._passes[0].setDisableDepthWrite(i(e))},setDisableBackFaceCulling:function(e){this._passes[0].setDisableBackFaceCulling(i(e))},setEnableStencilWrite:function(e){this._passes[0].setEnableStencilWrite(i(e))},setEnableStencilTest:function(e){this._passes[0].setEnableStencilTest(i(e))},setStencilOps:function(e,s){this._passes[0].setStencilOps(e,s)},setStencilOpsSeparate:function(e,s,t,i){this._passes[0].setStencilOpsSeparate(e,s,t,i)},setStencilFunc:function(e){this._passes[0].setStencilFunc(e)},setCullFaceMode:function(e){this._passes[0].setCullFaceMode(e)},setDepthFunc:function(e){this._passes[0].setDepthFunc(e)}})}),define("DS/Plugins/UserClearPass",["DS/Plugins/UserPass","DS/Plugins/ClearPass"],function(e,s){return e.extend({init:function(e){this._parent(e);var t=new s("_UserClearPass_"+this.id+"_"+this.name);t.defaults.clear=!1,t.clear=!1,this._passes.push(t)},setClearDepth:function(e){this._passes[0].defaults.doClearDepth=!!e},setClearStencil:function(e,s){void 0!==s&&(this._passes[0].clearStencilValue=s),this._passes[0].clearStencil=e}})}),define("DS/Plugins/UserRenderPass",["DS/Plugins/UserPass","DS/Plugins/RenderPass"],function(e,s){function t(e){return!!e}return e.extend({init:function(e){this._parent(e);var t=new s(null,null,null,null,null,null,"_UserRenderPass_"+this.id+"_"+this.name);this._passes.push(t)},setDisableColorWrite:function(e){this._passes[0].setDisableColorWrite(t(e))},setDisableDepthWrite:function(e){this._passes[0].setDisableDepthWrite(t(e))},setDisableBackFaceCulling:function(e){this._passes[0].setDisableBackFaceCulling(t(e))},setEnableStencilWrite:function(e){this._passes[0].setEnableStencilWrite(t(e))},setEnableStencilTest:function(e){this._passes[0].setEnableStencilTest(t(e))},setStencilOps:function(e,s){this._passes[0].setStencilOps(e,s)},setStencilOpsSeparate:function(e,s,t,i){this._passes[0].setStencilOpsSeparate(e,s,t,i)},setStencilFunc:function(e){this._passes[0].setStencilFunc(e)},setCullFaceMode:function(e){this._passes[0].setCullFaceMode(e)},setDepthFunc:function(e){this._passes[0].setDepthFunc(e)},_setCameraName:function(e){this._parent(e),this._passes[0].setCameraName(e)}})}),define("DS/Plugins/UserPassManager",["UWA/Class","DS/Plugins/UserRenderPass","DS/Plugins/UserClearPass","DS/Plugins/UserRenderList","DS/Plugins/UserPass","DS/Plugins/UserSceneGraphPass"],function(e,s,t,i,r,n){"use strict";var a=e.extend({init:function(e){this.viewer=e,this._activeUserPasses=[],this._activeRenderLists=null,this._updateRenderLists()},createUserRenderPass:function(e,t){var i=new s({manager:this,name:e,renderList:t});return t&&this._setUserPassRenderList(i,t),i},createUserClearPass:function(e,s){var i=new t({manager:this,name:e,renderList:s});return s&&this._setUserPassRenderList(i,s),i},createUserSceneGraphPass:function(e,s){var t=new n({manager:this,name:e,renderList:s});return s&&this._setUserPassRenderList(t,s),t},getSystemPass:function(e){return o[e]||null},insertUserPassAfterPass:function(e,s){var t;e._systemPass?console.warn("ERROR: Invalid arguments"):e._inserted?console.warn("ERROR: Already inserted pass"):(s instanceof r?(t=s._passes[s._passes.length-1],e._setCameraName(s._cameraName)):(t=s._list,e._setCameraName(s._cameraName)),this._getMainComposer().insertCustomPassAfterNEW(e._passes,t)&&(e._inserted=!0,this._activeUserPasses.push(e),this._updateRenderLists()))},insertUserPassBeforePass:function(e,s){var t;e._systemPass?console.warn("ERROR: Invalid arguments"):e._inserted?console.warn("ERROR: Already inserted pass"):(s instanceof r?(t=s._passes[0],e._setCameraName(s._cameraName)):(t=s._list,e._setCameraName(s._cameraName)),this._getMainComposer().insertCustomPassBeforeNEW(e._passes,t)&&(e._inserted=!0,this._activeUserPasses.push(e),this._updateRenderLists()))},removeUserPass:function(e){var s=this._activeUserPasses.indexOf(e);s>=0&&(this._getMainComposer().removeCustomPassNEW(e._passes),this._activeUserPasses.splice(s,1),e._inserted=!1,this._updateRenderLists())},_setUserPassRenderList:function(e,s){var t;for(t=0;t<e._passes.length;t++)e._passes[t].idString=s._getIdString()},_updateRenderLists:function(){var e,s;for(this._activeRenderLists=["main","noz","noEffectNoz","afterHighlightNoZ","dialog","furtive","onTop"],e=0;e<this._activeUserPasses.length;e++)if((s=this._activeUserPasses[e]).renderList&&s.enabled){var t=s.renderList._getIdString();this._activeRenderLists.indexOf(t)<0&&this._activeRenderLists.push(t)}},_getActiveRenderLists:function(){return this._activeRenderLists},_getMainComposer:function(){return this.viewer.renderer.mainComposer},_dispose:function(){this.viewer=null,this._activeUserPasses=null,this._activeRenderLists=null}}),o={infinitePlane:{_list:"infPlane",_systemPass:!0,_cameraName:"main"},main:{_list:"main",_systemPass:!0,_cameraName:"main"},noz:{_list:"noz",_systemPass:!0,_cameraName:"main"},noEffectNoz:{_list:"noEffectNoz",_systemPass:!0,_cameraName:"mainNoJittering"},afterHighlightNoz:{_list:"afterHighlightNoz",_systemPass:!0,_cameraName:"mainNoJittering"},robot:{_list:"robot",_systemPass:!0,_cameraName:"mainNoJittering"},canvas2D:{_list:"canvas2D",_systemPass:!0,_cameraName:"mainNoJittering"},dialog:{_list:"dialog",_systemPass:!0,_cameraName:"mainNoJittering"},onTop:{_list:"onTop",_systemPass:!0,_cameraName:"mainNoJittering"},furtive:{_list:"furtive",_systemPass:!0,_cameraName:"mainNoJittering"}};return a});