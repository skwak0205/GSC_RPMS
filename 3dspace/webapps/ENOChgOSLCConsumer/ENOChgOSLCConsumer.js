define("DS/ENOChgOSLCConsumer/scripts/ENOECMOSLCConsumer",["UWA/Class","DS/LifecycleServices/LifecycleServicesSettings","DS/LifecycleCmd/OSLCConsumerCmd","UWA/Drivers/Alone","UWA/Widget","i18n!DS/ENOChgOSLCConsumer/assets/nls/ECMOSLC"],function(UWAClass,LifecycleServicesSettings,OSLCConsumerCmd,Alone,Widget,NLS){"use strict";var ENOECMOSLCConsumer=UWAClass.extend({targetWindow:null,setup:function(){console.log("inside ENOECMOSLCConsumer.init() ..."),window.widget=new Widget,top.COMPASS_CONFIG={},top.COMPASS_CONFIG.userId=top.curUserId,top.COMPASS_CONFIG.lang=top.emxUIConstants.BROWSER_LANGUAGE,top.COMPASS_CONFIG.myAppsBaseUrl=top.myAppsURL+"/resources/AppsMngt"},setupWithExternalSetting:function(e){this.externalSettings=e,window.widget=new Widget},loadDelegatedUICreate:function(e,t){LifecycleServicesSettings.app_initialization(function(){var t=new OSLCConsumerCmd;t.setup({title:NLS.ECM_OSLC_Select_Reported_Against,resourceType:"http://open-services.net/ns/rm#Requirement",operation:"selectionDialog",proxyType:"Requirement Proxy",providerFilter:"RM",securityContext:top.curSecCtx||"",tenantId:top.curTenant||"OnPremise",singleObject:!0,notification:e}),t.execute()})},loadDelegatedUIForCreateExternalChangeAction:function(e){LifecycleServicesSettings.app_initialization(function(){var t=new OSLCConsumerCmd;t.setup({title:NLS.ECM_OSLC_Create_External_Change,resourceType:"http://open-services.net/ns/cm#ChangeRequest",operation:"creationDialog",proxyType:"Change Proxy",providerFilter:"CM",securityContext:top.curSecCtx||"",tenantId:top.curTenant||"OnPremise",singleObject:!0,notification:e}),t.execute()})},loadDelegatedUIForAddExistExternalChangeAction:function(e){LifecycleServicesSettings.app_initialization(function(){var t=new OSLCConsumerCmd;t.setup({title:NLS.ECM_OSLC_Select_External_Change,resourceType:"http://open-services.net/ns/cm#ChangeRequest",operation:"selectionDialog",proxyType:"Change Proxy",providerFilter:"CM",securityContext:top.curSecCtx||"",tenantId:top.curTenant||"OnPremise",singleObject:!1,notification:e}),t.execute()})},launchDelegatedUIWithExternalSetting:function(e){var t=this;LifecycleServicesSettings.app_initialization(function(){var n=new OSLCConsumerCmd;n.setup({title:NLS.ECM_OSLC_Select_Reported_Against,resourceType:"http://open-services.net/ns/rm#Requirement",operation:"selectionDialog",proxyType:"Requirement Proxy",providerFilter:"RM",securityContext:t.externalSettings.curSecCtx||"",tenantId:t.externalSettings.platformId||"OnPremise",singleObject:!0,notification:e}),n.execute()},t.externalSettings)},createChangeActionPostProcess:function(e){if(console.log("inside ENOECMOSLCConsumer.createChangeActionPostProcess() ..."),e&&e.objects&&e.objects.length>0){var t=document.createElement("FORM");t.target="listHidden",t.action="../enterprisechangemgtapp/ECMFullSearchPostProcess.jsp",t.method="post";var n=emxUICore.findFrame(top,"detailsDisplay");if(n){var a=getParamValuesByName(n.location.href,"objectId");if(a){for(var i=e.objects,r=0;r<i.length;r++){var o=i[r];if(o&&o.proxy&&o.proxy.id){var l="|"+o.proxy.id+"|"+a+"|",s=document.createElement("INPUT");s.value=l,s.type="hidden",s.name="emxTableRowId",t.appendChild(s)}}(s=document.createElement("INPUT")).value=a,s.type="hidden",s.name="parentOID",t.appendChild(s),(s=document.createElement("INPUT")).value=a,s.type="hidden",s.name="objectId",t.appendChild(s),(s=document.createElement("INPUT")).value="EnterpriseChangeMgt",s.type="hidden",s.name="suiteKey",t.appendChild(s),(s=document.createElement("INPUT")).value="enterprisechangemgt",s.type="hidden",s.name="SuiteDirectory",t.appendChild(s),(s=document.createElement("INPUT")).value="emxEnterpriseChangeMgtStringResource",s.type="hidden",s.name="StringResourceFileId",t.appendChild(s),(s=document.createElement("INPUT")).value="relationship_ChangeAction",s.type="hidden",s.name="targetRelName",t.appendChild(s),(s=document.createElement("INPUT")).value="CreateExternalChangeAction",s.type="hidden",s.name="functionality",t.appendChild(s),(s=document.createElement("INPUT")).value="Create",s.type="hidden",s.name="mode",t.appendChild(s),(s=document.createElement("INPUT")).value="true",s.type="hidden",s.name="isTo",t.appendChild(s),(s=document.createElement("INPUT")).value="TRUE",s.type="hidden",s.name="oslcCreateUI",t.appendChild(s),document.body.appendChild(t),addSecureToken(t),t.submit(),removeSecureToken(t),document.body.removeChild(t)}}}},createChangePostProcessCommon:function(result){var that=this;if(result&&result.objects&&result.objects.length>0){var localDoc=document;if(null!=that.targetWindow&&null!=that.targetWindow){var windowPath=that.targetWindow;try{var windowActual=eval(windowPath)}catch(e){console.error(e)}localDoc=windowActual.document}var domFieldNameActual=localDoc.getElementsByName("ReportedAgainstDisplay")[0],domFieldNameDisplay=localDoc.getElementsByName("ReportedAgainst")[0],domFieldNameOID=localDoc.getElementsByName("ReportedAgainstOID")[0],varFieldNameActual="",varFieldNameDisplay="",varFieldNameOID="",isfirstId=!0;if(domFieldNameActual&&domFieldNameDisplay&&domFieldNameOID){for(var arr=result.objects,i=0;i<arr.length;i++){var obj=arr[i],proxyObj=obj.proxy;proxyObj&&proxyObj.id&&proxyObj.dataelements&&proxyObj.dataelements.name&&(isfirstId?(varFieldNameOID=proxyObj.id,varFieldNameDisplay=proxyObj.dataelements.name,isfirstId=!1):(varFieldNameOID=varFieldNameOID+"|"+proxyObj.id,varFieldNameDisplay=varFieldNameDisplay+"|"+proxyObj.dataelements.name))}domFieldNameDisplay.value=varFieldNameDisplay,domFieldNameOID.value=varFieldNameOID,domFieldNameActual.value=varFieldNameDisplay}}},createReportedAgainstPostProcessCommon:function(e){if(e&&e.objects&&e.objects.length>0){var t=document.getElementsByName("txtIssueAffectedItem")[0],n=document.getElementsByName("txtActualAffectedItem")[0],a="",i="",r=!0;if(t&&n){for(var o=e.objects,l=0;l<o.length;l++){var s=o[l].proxy;s&&s.id&&s.dataelements&&s.dataelements.name&&(r?(i=s.id,a=s.dataelements.name,r=!1):(i=i+"|"+s.id,a=a+"|"+s.dataelements.name))}t.value=a,n.value=i}}}});return ENOECMOSLCConsumer});