define("DS/PlatformServicesData/Geovia",["UWA/Class"],function(e){"use strict";return e.singleton({get3DPlayProvider:function(){return"GEOVIA"}})}),define("DS/PlatformServicesData/OnePart",["UWA/Core","UWA/Class","DS/SNInfraUX/Logger"],function(e,t,i){"use strict";return t.singleton({getActions:function(t){if(e.is(t)&&e.is(t.models,"array")){require(["DS/SNResultUX_karma_tst/onePartActions/CompareManager"],function(e){var i={actions:[],status:"success"},n=e.getNbObjectsToCompare({widget_id:t.widget_id});if(1===t.models.length){var o=e.isAlreadyAdded({widget_id:t.widget_id,id:t.models[0].get("id")});if(i.actions.push({id:t.models[0].get("id"),actions:[{title:"View default configuration",icon:"attributes",id:"view-default-config",multisel:!1,sourcejs:"DS/SNResultUX_karma_tst/onePartActions/ConfigViewer"}]}),i.actions[0].actions.push({title:"View all configurations",icon:"view-small-tile",id:"view-all-configs",multisel:!1,sourcejs:"DS/SNResultUX_karma_tst/onePartActions/ConfigViewer"}),o?i.actions[0].actions.push({title:"Remove from Compare",icon:"compare-delete",id:"remove-from-compare",multisel:!0,sourcejs:"DS/SNResultUX_karma_tst/onePartActions/AddRemoveCompare"}):i.actions[0].actions.push({title:"Add to Compare",icon:"compare-add",id:"add-to-compare",multisel:!0,sourcejs:"DS/SNResultUX_karma_tst/onePartActions/AddRemoveCompare"}),n>0){var a=!0;1===n&&o&&(a=!1),a&&i.actions[0].actions.push({title:"Launch Compare",icon:"compare-on",id:"start-compare",multisel:!0,sourcejs:"DS/SNResultUX_karma_tst/onePartActions/Compare"})}t.onComplete.call(void 0,i)}else{for(var r=0;r<t.models.length;r++)i.actions.push({id:t.models[r].get("id"),actions:[{title:"Add to Compare",icon:"compare-add",id:"add-to-compare",multisel:!0,sourcejs:"DS/SNResultUX_karma_tst/onePartActions/AddRemoveCompare"}]}),i.actions[r].actions.push({title:"Remove from Compare",icon:"compare-delete",id:"remove-from-compare",multisel:!0,sourcejs:"DS/SNResultUX_karma_tst/onePartActions/AddRemoveCompare"}),i.actions[r].actions.push({title:"Launch Compare",icon:"compare-on",id:"start-compare",multisel:!0,sourcejs:"DS/SNResultUX_karma_tst/onePartActions/Compare"});t.onComplete.call(void 0,i)}})}},is3DPlayAvailable:function(t){e.is(t)&&e.is(t.onComplete,"function")&&t.onComplete.call(void 0,{availability:!0})},get3DPlayOptions:function(t){if(e.is(t)&&e.is(t.onComplete,"function")&&e.is(t.onFailure,"function")){var n=t.model,o=t.defaultPlayOptions;if(e.is(n)&&e.is(o)){if(e.is(o.input)&&e.is(o.input.asset)){o.input.asset.provider="FILE",o.input.asset.serverurl=t.serviceURL,o.input.asset.physicalid=n.id,o.input.asset.dtype=n.get("ds6w:type_value"),o.input.asset.requiredAuth="passport",o.input.asset.requestsOptions={authentication:"passport"},o.input.asset.filename="/fetch/RAW/application/part/?&source=consolidation-cs_onepart&uri="+encodeURIComponent(n.get("ds6w:source_value")),i.log("play3DOptions.input.asset.filename = "+o.input.asset.filename);var a=n.get("ds6w:label");if(i.log("modelLabel = "+a),e.is(a,"string")){var r=a.indexOf(".");if(r>=0){var s=a.substring(r+1,a.length);e.is(s)&&(o.input.asset.format=s,i.log("play3DOptions.input.asset.format = "+s))}}}t.onComplete.call(void 0,o)}}},getFacets:function(t){if(e.is(t)&&e.is(t.constants)&&e.is(t.setFacets,"function")){var i=[t.constants.FACET_PROPERTIES];t.setFacets.call(void 0,i)}}})}),define("DS/PlatformServicesData/Netvibes",["UWA/Core","UWA/Class","UWA/Class/Debug"],function(e,t,i){"use strict";return t.singleton(i,{name:"DS/PlatformServicesData/Netvibes",executeAction:function(t){if(!e.is(t,"object")||!t.actionsHelper||!e.is(t.actionsHelper.getModel,"function"))throw new Error("invalid input to action handler");switch(t.action_id){case"open_netvibes_article":var i=t.actionsHelper.getModel().get("ds6w:context");window.open(i)}},getActionsPath:function(e){},getActions:function(e){},getDoubleClickAction:function(t){e.is(t,"object")&&e.is(t.model)&&e.is(t.appID)&&"X3DSEAR_AP"===t.appID&&"search_topbar_suggest"===t.client_feature&&t.onComplete.call(void 0,{id:"open_netvibes_article",sourceJS:"DS/PlatformServicesData/Netvibes"})}})}),define("DS/PlatformServicesData/3DSpacePreviewLoader",["UWA/Core","UWA/Class","UWA/Promise","UWA/Class/Debug","DS/SNInfraUX/Logger","DS/WAFData/WAFData","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(e,t,i,n,o,a,r){"use strict";return t.singleton(n,{getPreviewPath:function(t){if(e.is(t))return"/resources/SNAPI/search_preview_delegation/preview?tenant="+t;o.error("platformID not found!")},get3DSpaceServiceURL:function(e){return new i(function(t,i){r.getServiceUrl({serviceName:"3DSpace",platformId:e,onComplete:function(e){t(e)},onFailure:function(e){i(e)}})})},getRequestBody:function(e){var t=[];return t[0]={id:e.searchmodel.id,type:e.searchmodel.getType(),source:e.searchmodel.getSourceID()},{appName:"",objects:t,platformId:e.searchmodel.getPlatformID(),applicativeInfo:{}}},getPreviewModules:function(t){var i=t.searchmodel.getPlatformID(),n=this;return n.get3DSpaceServiceURL(i).then(function(e){return e+n.getPreviewPath(i)}).then(function(i){return o.log("In last url::"+i),new Promise(function(r,s){a.authenticatedRequest(i,{method:"POST",headers:{"Content-Type":"application/json"},data:JSON.stringify(n.getRequestBody(t)),onComplete:function(t){if(o.log("Handler Info (From server):"+t),t=JSON.parse(t),e.is(t,"array")&&e.is(t.length)&&e.is(t[0].status)&&e.equals(t[0].status.result,"failure")){var i=t[0].status.message;o.log(i),s(new Error(i))}else r(t)},onFailure:function(e){o.log("Failed to fetch the preview handler!"),o.log("Error: "+e),s(new Error(e))},onTimeout:function(){o.log("Timeout occurred while fatching the preview handler!"),s(new Error("Timeout occurred!"))}})})})}})}),define("DS/PlatformServicesData/PreviewProxy",["UWA/Core","DS/SNInfraUX/Logger","DS/SNInfraUX/SearchPreviewContainer","DS/PlatformServicesData/3DSpacePreviewLoader"],function(e,t,i,n){"use strict";return i.extend({_response:{},init:function(e){this._parent(e)},getPrimaryContent:function(i){if(!e.is(i)||!e.is(i.searchmodel))throw t.error("PreviewProxy.getPrimaryContent invalid options",i),new Error("PreviewProxy.getPrimaryContent invalid options");var n=[];e.is(this._response,"array")&&e.is(this._response.length)&&e.is(this._response[0]["primary-handler"])?(n.push(this._response[0]["primary-handler"]),require(n,function(n){t.log("Primary preview handler loaded successfully!");var o=new n;e.is(o.getPrimaryContent,"function")&&o.getPrimaryContent(i)},function(){t.log("Error occurred while loading primary preview handler, going for default treatment"),require(["DS/SNResultUX/views/utils/3DSpacePreview"],function(t){var n=new t;e.is(n.getPrimaryContent,"function")&&n.getPrimaryContent(i)})})):(t.log("Response is not valid or doesn't contain primary preview handler. Considering default treatment."),require(["DS/SNResultUX/views/utils/3DSpacePreview"],function(t){var n=new t;e.is(n.getPrimaryContent,"function")&&n.getPrimaryContent(i)}))},getSecondaryContent:function(i){if(!e.is(i)||!e.is(i.searchmodel))throw t.error("PreviewProxy.getSecondaryContent invalid options",i),new Error("PreviewProxy.getSecondaryContent invalid options");var n=this._parent,o=[];e.is(this._response,"array")&&e.is(this._response.length)&&e.is(this._response[0]["secondary-handler"])?(o.push(this._response[0]["secondary-handler"]),require(o,function(e){t.log("Secondary preview handler loaded successfully!"),(new e).getSecondaryContent(i)},function(){t.log("Failed to load secondary preview handler!"),n(i)})):(t.log("Response is not valid / doesn't contains secondary preview handler. Considering default treatment."),n(i))},setPreviewModule:function(e){var i=this;return n.getPreviewModules(e).then(function(e){i._response=e},function(e){throw t.log(e),e})}})}),define("DS/PlatformServicesData/3DSpace",["UWA/Core","UWA/Class","UWA/Class/Debug","DS/SNInfraUX/SearchSettings","DS/SNInfraUX/Logger","DS/SNInfraUX/SearchUtils","DS/SNInfraUX/ServiceDelegationLoader","DS/WAFData/WAFData","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","text!DS/PlatformServicesData/assets/3DSpace.json","i18n!DS/SNResultUX/assets/nls/SNResultUX.json","DS/PlatformServicesData/PreviewProxy","DS/SNResultUX/utils/ResultsUtils"],function(e,t,i,n,o,a,r,s,l,c,u,d,p){"use strict";return t.singleton(i,{name:"DS/PlatformServicesData/3DSpace",_3DSpaceDefaultPreview:null,_previewServices:null,_previewObject:{},init:function(){this._3DSpaceDefaultPreview=null,this._previewServices=JSON.parse(c)},getActionsPath:function(t){if(!e.is(t)||!e.is(t.platformID))throw new Error("INVALID inputs for getActionsPath, platformID is missing");return"/resources/SNAPI/search_delegation/actions?tenant="+t.platformID},getActions:function(t){if(e.is(t)&&e.is(t.models,"array")&&e.is(t.data,"object")){var i=0,o=function(e){for(i=0;i<t.models.length;i++)if(t.models[i].get("id")===e)return t.models[i]},a=function(t,i,n){e.is(t.cmdInfo,"object")&&(e.is(t.cmdInfo.type,"string")&&(t.cmdInfo.type=[t.cmdInfo.type]),e.is(n,"array")?t.cmdInfo.type=t.cmdInfo.type.concat(n):e.is(n,"string")&&t.cmdInfo.type.push(n))},r=!1,l=t.models;for(i=0;i<l.length;i++){var c=l[i];if(e.is(c.isAShowOnlyObject,"function")&&!0===c.isAShowOnlyObject()){r=!0;break}}if(!1===r){var u={method:"POST"};if(u.headers=t.headers||{},u.headers["Content-Type"]="application/json",u.url=t.serviceURL+this.getActionsPath({platformID:t.data.platformId}),t.data.applicativeInfo.addOpenWith=!1,1===t.models.length)if(n.getOption("add_open_with"))t.data.applicativeInfo.addOpenWith=!0;else{var d=t.data.applicativeInfo;e.is(d,"object")&&e.is(d.clientAppInfo,"object")&&e.is(d.clientAppInfo.addinmode,"string")&&d.clientAppInfo.addinmode.length>0&&(t.data.applicativeInfo.addOpenWith=!0)}if(t.data.objects.length===t.models.length)for(i=0;i<t.data.objects.length;i++)t.data.objects[i].isRecentObject=t.models[i].isARecentSearchResult();u.data=JSON.stringify(t.data),u.onComplete=function(i){var n=e.is(i,"string")?i.length>0?JSON.parse(i):{}:i;if(!0===t.data.applicativeInfo.addOpenWith&&e.is(n.actions,"array"))for(var r=0;r<n.actions.length;r++){var s=n.actions[r];if(e.is(s,"object")){var l=s.id,c=o(l);if(e.is(c)&&!c.isARecentSearchResult()){var u=c.get("ds6w:kind_value");if(e.is(u)&&e.is(s.actions,"array"))for(var d=0;d<s.actions.length;d++){var p=s.actions[d];if("3DCompass_#OpenWith"===p.id){a(p,0,u);break}}}}}e.is(t.onComplete,"function")&&t.onComplete.call(void 0,n)},u.onFailure=function(i){e.is(t.onFailure,"function")&&t.onFailure.call(void 0,{type:"web_service_failure",error:i})},s.authenticatedRequest(u.url,u)}else{e.is(t.onComplete,"function")&&t.onComplete.call(void 0,{})}}},is3DPlayAvailable:function(t){var i=function(e){t.onComplete.call(void 0,{availability:e})};if(e.is(t)&&e.is(t.onComplete,"function")){var n=t.model;if(e.is(n)){var o=!1;e.is(n.isAShowOnlyObject,"function")&&(o=n.isAShowOnlyObject()),!1===o?require(["DS/3DPlaySupport/AssetSupport"],function(e){const o={provider:"EV6",tenant:n.getPlatformID(),physicalid:n.id,type:n.get("ds6w:type_value"),requiredAuth:"passport",requestsOptions:{authentication:"passport"},contextid:t.skeleton?t.skeleton.getSecurityContext():null};e.checkSupport(o,{usage:"preview"},function(e){i(!0===e)})}):i(!1)}else i(!1)}},get3DPlayOptions:function(t){if(e.is(t)&&e.is(t.onComplete,"function")&&e.is(t.onFailure,"function")){var i=t.model,n=t.defaultPlayOptions;if(e.is(i)&&e.is(n)&&e.is(t.serviceURL,"string")&&e.is(n.input)&&e.is(n.input.asset)){var o=i.get("ds6w:type_value");if(n.input.asset.provider="EV6",n.input.asset.serverurl=t.serviceURL,n.input.asset.tenant=i.getPlatformID(),n.input.asset.physicalid=i.id,n.input.asset.dtype=o,n.input.asset.requiredAuth="passport",n.input.asset.requestsOptions={authentication:"passport"},e.is(n.options)&&e.is(n.options.loading)&&("VPMReference"===o||"PLMProductDS"===o)){n.options.loading="onclick";var a=document.createElement("div",{styles:{"background-image":"url("+i._attributes.preview_url+")","background-size":"contain","background-position":"center","background-repeat":"no-repeat",height:"100%","background-color":"white"}});n.options.splashscreen={custom:a}}t.onComplete.call(void 0,n)}}},getSubjectURI:function(e){var t=e.subjects,i={};return t.forEach(function(e){i[e.id]="pid://"+e.id}),i},getTaggerService:function(e){return"3DSpace"},getFacets:function(t){var i=this;if(e.is(t)&&e.is(t.model)&&e.is(t.constants)&&e.is(t.setFacets,"function")&&e.is(t.addFacets,"function")){n.getOption("search_web_in_win")&&e.is(t.setContext,"function")&&t.setContext.call(void 0,{getSecurityContext:function(){return{SecurityContext:a.getSecurityContext()}}}),this._getAvailableRoles({platformID:t.model.getPlatformID(),onComplete:function(i){i.indexOf("PAR")>=0&&e.is(t.setReadOnly,"function")&&t.setReadOnly.call(void 0,!1);var n=[t.constants.FACET_PROPERTIES],o=[{text:u.get("section.properties.title"),name:t.constants.FACET_PROPERTIES,icon:"attributes",expandedFlag:!0}];t.setFacets.call(void 0,n,o)}});var r=!1;if(e.is(t.model.isAShowOnlyObject,"function")&&(r=t.model.isAShowOnlyObject()),!1===r){require(["DS/ENORIPE_Relations/RelationsTabSettings"],function(o){var a={appID:"X3DSEAR_AP",isDraggable:!0,addinmode:n.getOption("addinmode"),lockedApp:n.getOption("lockedapp")};o.isAvailable(t.model,a).then(function(n){if(e.is(n,"object")&&e.is(n.facetInfo)){var o=[{text:n.facetInfo.facet.text,name:n.facetInfo.facet.name,icon:n.facetInfo.facet.icon,expandedFlag:!1,height:"450px"}];e.is(n.facetInfo,"object")&&(n.facetInfo.position=1),t.addFacets([n.facetInfo],o)}else i.log("facets info is NOT in good format")},function(){i.log("this facet is not available for this context = "+o)})},function(e){o.warn("Cannot load "+e.requireModules)})}}},getRelations:function(t){if(e.is(t,"object")){var i=t.model;if(e.is(i,"object")&&e.is(t.onComplete,"function")){var n={parents:[],children:[],drawings:[],simulations:[],configurations:[]},a=i.getPlatformID();l.getServiceUrl({serviceName:i.getServiceID(),platformId:a,onComplete:function(r){s.authenticatedRequest(r+"/resources/enorelnav/navigate/setpreferences?tenant="+a,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",data:JSON.stringify({widgetId:"preview-8cae85",relations:["v6_structure_to","v6_structure_from","v6_drawing_from","simulation_from"],countmanagement:!1}),onComplete:function(){s.authenticatedRequest(r+"/resources/enorelnav/navigate/getecosystem?tenant="+a,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",data:JSON.stringify({widgetId:"preview-8cae85",ids:[i.get("id")]}),onComplete:function(){var l={widgetId:"preview-8cae85",id:i.get("id"),debug:!1};s.authenticatedRequest(r+"/resources/enorelnav/navigate/detail?tenant="+a,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",data:JSON.stringify(l),onComplete:function(a){var r=JSON.parse(a);if(e.is(r.newstructure)){var s=function(e,t){o.log(e+":"+t.length+function(e){for(var t=" ",i=0;i<e.length;i++)t+=e[i]["ds6w:label"]+", ";return t}(t))},l=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].id);return t};e.is(r.newstructure.v6_structure_from,"array")&&(s("Parents",r.newstructure.v6_structure_from),n.parents=l(r.newstructure.v6_structure_from)),e.is(r.newstructure.v6_structure_to,"array")&&(s("Children",r.newstructure.v6_structure_to),n.children=l(r.newstructure.v6_structure_to)),e.is(r.newstructure.v6_drawing_from,"array")&&(s("Drawings",r.newstructure.v6_drawing_from),n.drawings=l(r.newstructure.v6_drawing_from)),e.is(r.newstructure.simulation_from,"array")&&(s("Simulations",r.newstructure.simulation_from),n.simulations=l(r.newstructure.simulation_from)),n.model=i,t.onComplete.call(void 0,n)}},onFailure:function(i){o.log(i),e.is(t.onFailure,"function")&&t.onFailure.call(void 0,n)},onTimeout:function(i){o.log(i),e.is(t.onFailure,"function")&&t.onFailure.call(void 0,n)}})},onFailure:function(i){o.log(i),e.is(t.onFailure,"function")&&t.onFailure.call(void 0,n)},onTimeout:function(i){o.log(i),e.is(t.onFailure,"function")&&t.onFailure.call(void 0,n)}})},onFailure:function(i){o.log(i),e.is(t.onFailure,"function")&&t.onFailure.call(void 0,n)},onTimeout:function(i){o.log(i),e.is(t.onFailure,"function")&&t.onFailure.call(void 0,n)}})},onFailure:function(i){o.log(i),e.is(t.onFailure,"function")&&t.onFailure.call(void 0,n)}})}}},getDoubleClickAction:function(t){if(e.is(t,"object")&&e.is(t.model)&&e.is(t.appID)){let i=t.model;if("X3DSEAR_AP"===t.appID){if("Document"===i.getType()&&"search_topbar_suggest"===t.client_feature){let e=i.getPlatformID(),t=i.id,n=a.identifyClientInfo().identifier;l.getServiceUrl({serviceName:"3DDashboard",platformId:e,onComplete:function(i){p.openResourceInApplicationWidget({baseUrl:i,clientId:n,appId:"ENXWDOC_AP",platformId:e,objectId:t})}})}else if(!1===t.model.isAShowOnlyObject()){let n={method:"POST"};n.headers=t.headers||{Accept:"application/json","Accept-Language":a.getLanguage()},n.headers["Content-Type"]="application/json",n.url=t.serviceURL+"/resources/SNAPI/search_delegation/doubleClickAction?tenant="+t.model.getPlatformID();let o=e.is(t.data)?t.data:{appName:a.SEARCH_APP_ID,object:{id:i.id,type:i.getType(),isRecentObject:i.isARecentSearchResult(),source:i.getSourceID()},platformId:i.getPlatformID()};if(e.is(t.skeleton)&&!e.is(o.applicativeInfo)){let i=t.skeleton.getOption("in_apps_search");o.applicativeInfo={incontextMode:e.is(i),clientAppInfo:a.identifyClientInfo(t.skeleton.getOption("addinMode"))}}n.data=JSON.stringify(o),n.onComplete=function(i){let n=JSON.parse(i);e.is(t.onComplete,"function")&&t.onComplete.call(void 0,{id:n.actionId,sourceJS:n.handlerJs})},n.onFailure=function(i){e.is(t.onFailure,"function")&&t.onFailure.call(void 0,{type:"web_service_failure",error:i})},s.authenticatedRequest(n.url,n)}}}},_getAvailableRoles:function(t){e.is(t)&&e.is(t.platformID)&&e.is(t.onComplete,"function")&&a.getGrantedRoles(function(i){for(var n=[],o=0;o<i.length;o++){var a=i[o];e.is(a)&&e.is(a.platforms,"array")&&(0===a.platforms.length||a.platforms.indexOf(t.platformID)>=0)&&n.push(a.id)}t.onComplete.call(void 0,n)})},getRenderPreview:function(t){if(e.is(t)&&e.is(t.searchmodel)&&e.is(t.onComplete,"function")){var i=this,a=function(e){require(["DS/SNResultUX/views/utils/3DSpacePreview"],function(t){i._3DSpaceDefaultPreview=new t,e.onComplete.call(void 0,i._3DSpaceDefaultPreview)})};if(n.getOption("activate3DSpacePreviewDelegation")){var s=new d;s.setPreviewModule(t).then(function(){t.onComplete.call(void 0,s)},function(){a(t)})}else if(e.is(i._previewServices)){var l=i._previewServices.previewTypeSources;if(e.is(l)){var c="3DSpace_"+t.searchmodel.get("ds6w:type_value"),u=l[c];if(e.is(u)){var p=i._previewObject[c];e.is(p)?t.onComplete.call(void 0,p):r.load({servicesData:l,serviceID:c,platformID:t.searchmodel.getPlatformID()}).then(function(e){var n=new e;t.onComplete.call(void 0,n),i._previewObject[c]=n},function(){o.log("OLD::Error in loading service delegation"),null===i._3DSpaceDefaultPreview?a(t):t.onComplete.call(void 0,i._3DSpaceDefaultPreview)})}else o.log("OLD:: Not present in JSON file"),null===i._3DSpaceDefaultPreview?a(t):t.onComplete.call(void 0,i._3DSpaceDefaultPreview)}}}}})});