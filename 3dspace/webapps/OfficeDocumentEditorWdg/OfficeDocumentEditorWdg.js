define("DS/OfficeDocumentEditorWdg/Widget",["UWA/Core","UWA/Utils","UWA/Event","DS/UIKIT/Input/Button","DS/UIKIT/Alert","DS/OfficeDocumentEditorClient/Editor","i18n!OfficeDocumentEditorWdg/assets/nls/widget","css!OfficeDocumentEditorWdg/Widget"],function(e,t,i,a,r,n,l){"use strict";const c={alertContainer:{},container:{},load:function(){widget.body.empty(),widget.setTitle(widget.getValue("title"));const e=c.getUrl();c.displayContentFromUrl(e)},notify:function(t,i){var a="error";["warning","error"].indexOf(i)>-1&&(a=i),new r({closable:!0,className:"officedocumenteditor-notify",visible:!0,messages:[{message:e.createElement("div",{html:[e.createElement("span",{text:t})]}),className:a}]}).inject(c.alertContainer)},getUrl:function(){var e,i=t.parseUrl(widget.getValue("url")),a="",r=i.source;return r&&"about:blank"!==r&&(a="https"===(e=i.protocol)?r:"http"===e?r:"http://"+r),a.trim()},displayContentFromUrl:function(t){c.alertContainer=e.createElement("div",{class:"alert-container"}).inject(widget.body);const r=e.createElement("div",{styles:{height:"100%",display:"flex","flex-direction":"column","align-items":"stretch"}}),o=e.createElement("div",{styles:{height:"100%"}}),s=e.createElement("div");new a({className:"input-submit primary",value:l.saveButton,events:{onClick:function(t){i.stop(t);let a={};try{a=JSON.parse(widget.getValue("callbackUrlParams"))}catch(t){}let r={};try{r=JSON.parse(widget.getValue("callbackUrlHeaders"))}catch(t){}n.save({callbackUrl:widget.getValue("callbackUrl"),params:a,headers:r,filenameForUpload:widget.getValue("callbackUrlFilenameForUpload")}).then(function(e){e&&e.success?c.notify(l.saveSuccess,"primary"):c.notify(l.saveError)}).catch(function(t){e.log("Error:",t),c.notify(l.saveError)})}}}).inject(s),s.inject(r),o.inject(r),r.inject(widget.body),c.container=r,n.init({title:widget.getValue("title"),ext:widget.getValue("ext"),url:widget.getValue("url"),docKeyToUse:widget.getValue("docKeyToUse"),callbackUrl:widget.getValue("callbackUrl"),readOnly:widget.getValue("readOnly"),useIframe:widget.getValue("useIframe"),rootElem:o}).catch(function(e){switch(e){case n.ERROR.NO_DOCUMENT_Url_PROVIDED:c.notify(l.noDocumentUrlProvided);break;case n.ERROR.SERVICE_NOT_FOUND:c.notify(l.serviceNotFound);break;default:c.notify(l.unknownError)}})}};return c});