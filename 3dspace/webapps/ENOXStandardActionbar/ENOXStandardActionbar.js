define("DS/ENOXStandardActionbar/js/ENOXStandardActionbar",["UWA/Controls/Abstract","UWA/Class/View","DS/UIKIT/Iconbar","DS/UIKIT/DropdownMenu","DS/Core/ModelEvents","DS/ENOXViewFilter/js/ENOXViewFilter","DS/ResizeSensor/js/ResizeSensor","DS/UIKIT/Mask","i18n!DS/ENOXCollectionToolBar/assets/nls/ENOXCollectionToolBar","css!DS/ENOXStandardActionbar/css/ENOXStandardActionbar.css"],function(t,e,i,n,o,s,r,a,c){"use strict";return Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var n=arguments[1],o=0;o<i;){var s=e[o];if(t.call(n,s,o,e))return o;o++}return-1}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var n=arguments[1],o=0;o<i;){var s=e[o];if(t.call(n,s,o,e))return s;o++}}}),t.extend({init:function(t){this.options=UWA.clone(t,!1);this._listSubscription=[],this.modelEvent=t.modelEvent?t.modelEvent:new o,this.wrapperContainer=UWA.createElement("div",{class:""}).inject(this.options.parentContainer),this.actionBar=UWA.createElement("div",{class:"actionBar"}).inject(this.wrapperContainer),UWA.merge(this.options,{showItemCount:!1,parentContainer:null}),UWA.is(this.options.onSearch,"function")&&this._listSubscription.push(this.modelEvent.subscribe({event:"onSearch"},t.onSearch)),UWA.is(this.options.onSort,"function")&&this._listSubscription.push(this.modelEvent.subscribe({event:"onSort"},t.onSort)),UWA.is(this.options.onSwitch,"function")&&this._listSubscription.push(this.modelEvent.subscribe({event:"onSwitch"},t.onSwitch));var e=this;this._listSubscription.push(this.modelEvent.subscribe({event:"enox-standard-action-bar-update-count"},function(t){e.updateCount(t)})),this._parent(this.options),this.render()},render:function(){var t=this;this.options.showItemCount&&(this.counterContainer=UWA.createElement("div",{class:"countContainer"}).inject(this.actionBar),this.updateCount(0)),this.MidMenuContainer=UWA.createElement("div",{class:"midMenuContainer"}).inject(this.actionBar);var e=UWA.createElement("div",{class:"actionsContainer"}).inject(this.actionBar);if(this.options.searchOptions){this.initSearch();var n=UWA.createElement("span",{class:"fonticon fonticon-search search-icon"}).inject(e);n.addEvents({click:function(e){t.searchHandler(n)}}),this.searchIcon=n}if(this.options.sortOptions&&(this.options.sortOptions.order||(this.options.sortOptions.order="DESC"),this.options.sortOptions.attributes)){var o=UWA.createElement("div",{class:"sortContainer"}).inject(e);this.addSortComponent(o)}if(this.options.groupByOptions){var s=UWA.createElement("div",{class:"groupByContainer"}).inject(e);this.addGroupByComponent(s)}var c=UWA.createElement("div",{styles:{class:"iconBarContainer"}});this.iconBar=new i({renderTo:c,items:[],class:"actionbar-iconbar"}).inject(e),this.renderIconBar(),this.actionsContainer=e,this.resizeActionBar(),setTimeout(function(){new r(t.actionBar,function(){t.resizeActionBar()}),t.resizeActionBar(),a.unmask(t.wrapperContainer)},100)},renderIconBar:function(){var t=this.options.actions,e=this.options.sortOptions,i=this.options.switchViews;t&&e&&this.iconBar.addItem({className:"divider actionbar-divider"}),t&&this.addActions(t),(!t&&e&&i||t&&i)&&this.iconBar.addItem({className:"divider actionbar-divider"}),i&&this.addSwitchers(i),this.iconBar.menu.elements.wrapper.addClassName("actionbar-iconbar-items")},updateCount:function(t){var e=c.Item;t>=0&&(e=t+" "+e),this.counterContainer.setContent(e)},addGroupByComponent:function(t){UWA.createElement("div",{text:c.groupBy,class:"groupContainer"}).inject(t);var e=UWA.createElement("div",{class:"sta-menu",styles:{color:"#368ec4"}}).inject(t);this.addGroupByAttributes(this.options.groupByOptions.attributes,e)},addGroupByAttributes:function(t,e){var i=this;t.forEach(function(t){t.selectable=!0});var o=t.find(function(t){return!0===t.selected});o||(o=t[0],t[0].selected=!0),e.set("text",o.text),this.groupBySelection=o.id,new n({target:e,items:[t],events:{onClick:function(t,n){e.set("text",n.text),i.groupBySelection=n.id;var o={attribute:i.groupBySelection};i.publishEvent("onGroup",o)}}})},addSortComponent:function(t){UWA.createElement("div",{text:c.sortBy,class:"sortByContainer"}).inject(t);var e=UWA.createElement("div",{class:"sta-menu",styles:{color:"#368ec4"}}).inject(t),i=UWA.createElement("span").inject(t);this.addSortAttributes(this.options.sortOptions.attributes,e),this.addSortOrder(this.options.sortOptions.order,i)},addSortAttributes:function(t,e){var i=this;t.forEach(function(t){t.selectable=!0});var o=t.find(function(t){return!0===t.selected});o||(o=t[0],t[0].selected=!0),e.set("text",o.text),this.sortAttribute=o.id,new n({target:e,renderTo:i.actionBar,items:[t],events:{onClick:function(t,n){e.set("text",n.text),i.sortAttribute=n.id;var o={attribute:i.sortAttribute,order:i.options.sortOptions.order};i.resizeActionBar(),i.publishEvent("onSort",o)}}})},addSortOrder:function(t,e){var i="up",n=this;"ASC"===t&&(i="down"),e.set("class","fonticon fonticon-"+i+" orderSpan"),e.addEvents({click:function(t){"ASC"===n.options.sortOptions.order?(e.set("class","fonticon fonticon-up orderSpan"),n.options.sortOptions.order="DESC"):(e.set("class","fonticon fonticon-down orderSpan"),n.options.sortOptions.order="ASC");var i={attribute:n.sortAttribute,order:n.options.sortOptions.order};n.publishEvent("onSort",i)}})},destroy:function(){this._parent();for(var t=this._listSubscription.length,e=0;e<t;e++)this.modelEvent.unsubscribe(this._listSubscription[e])},addActions:function(t){for(var e=t.length,i=function(){},n=0;n<e;n++){var o=t[n];o.name=o.id;var s=o.disable?"iconbar-item-disable":"iconbar-item",r="iconbar-item-disable"===s?i:o.handler;this.iconBar.addItem({className:s,id:o.id,fonticon:o.fonticon,text:o.text,handler:r.bind(o)}),this.enableAction(o.id,!o.disable)}},addSwitchers:function(t){var e=[],i=t.find(function(t){return!0===t.selected});i||(i=t[0],t[0].selected=!0);for(var n=0;n<t.length;n++)t[n].selected,1!=t[n].selected&&(t[n].selected=!1),e.push({id:t[n].id,fonticon:t[n].fonticon,text:t[n].text,selected:t[n].selected,handler:this.switchHandler.bind(this,e)});if(this.options.switchViews.length>2){var o={options:{items:e},type:"icondropdown"};this.iconBar.addItem({id:i.id,fonticon:i.fonticon,text:i.text,content:o})}else this.iconBar.addItem({id:i.id,fonticon:i.fonticon,text:i.text,handler:this.switchView.bind(this,e)});this.target=this.iconBar.menu.items.find(function(t){return t.fonticon===i.fonticon}),this.setStyle(this.target.elements.icon)},switchHandler:function(t,e,i){var n=this,o=this.iconBar.menu.items.find(function(t){return t.fonticon===n.target.fonticon});if(i){o.tooltip.options.target.lastChild.className=i.elements.icon.className;var s=t.findIndex(function(t){return t.id===i.id});o.tooltip.elements.body.textContent=t[s].text,this.publishEvent("onSwitch",i.id)}},switchView:function(t,e,i){var n=t.findIndex(function(t){return!1===t.selected}),o=0;0==n&&(o=1),t[n].selected=!0,t[o].selected=!1,this.target.tooltip.elements.body.textContent=t[n].text,this.target.tooltip.options.target.lastChild.className="fonticon fonticon-"+t[n].fonticon,this.publishEvent("onSwitch",t[n].id)},setStyle:function(t){t&&t.setStyles({color:"#368ec4",opacity:"1"})},defaultStyle:function(t){t&&(t.setStyles({color:"grey"}),t.addEvents({mouseover:function(e){t.setStyles({opacity:"1"})},mouseout:function(e){"grey"===t.style.color&&t.setStyles({opacity:"0.5"})}}))},enableAction:function(t,e){var i=this.iconBar.menu.items.find(function(e){return e.id===t});e?this.iconBar.menu.enableItem(i.id):this.iconBar.menu.disableItem(i.id)},searchHandler:function(t){this.searchComp.container.isHidden()?(this.searchComp.show(),this.setStyle(t)):(this.searchComp.hide(),this.defaultStyle(t))},initSearch:function(){var t=this;this.options.searchOptions.onSearch=function(e){t.publishEvent("onSearch",e)},this.options.searchOptions.parentContainer=this.MidMenuContainer,this.searchComp=new s(this.options.searchOptions),this.searchComp.hide()},setSearchVisibility:function(t){t?(this.searchComp.show(),this.setStyle(this.searchIcon)):(this.searchComp.hide(),this.defaultStyle(this.searchIcon))},setSearchText:function(t){this.searchComp&&this.searchComp.setText(t)},publishEvent:function(t,e){this.modelEvent.publish({event:t,data:e})},onRender:function(){this.elements.container.setStyles({height:"auto"}),a.mask(this.wrapperContainer)},resizeActionBar:function(){var t=this.counterContainer?this.counterContainer.offsetWidth:0,e=this.actionBar.offsetWidth-(t+this.actionsContainer.offsetWidth+5);e>0&&this.MidMenuContainer.setStyle("width",e+"px"),this.searchComp&&(e<300?this.searchComp.inject(this.wrapperContainer):this.searchComp.inject(this.MidMenuContainer),this.searchComp.resizeSearch())}})});