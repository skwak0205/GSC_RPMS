var WUXModelUpdateTypes={Addition:1,Removal:2,Expand:4,Sorting:8,Grouping:16,Selection:32,PreSelection:64,AttributesChange:128,VisibilityChange:256,Filtering:512};Object.freeze(WUXModelUpdateTypes);var WUXModelChangeStates={Unchanged:0,AttributesChanged:1,NodeAdded:2,NodeToBeRemoved:4};Object.freeze(WUXModelChangeStates);let treeDocumentSnapshots=[],snapshotTreeDocument=function(e){let t=[],n=e._getTrueRoot(),i=e.getRoots();return i&&i.length>0&&t.push({node:n,children:[...i]}),e.processDescendants({processNode:function(e){let n=e.nodeModel,i=n.getChildren();i&&i.length>0&&t.push({node:n,children:[...i]})}}),t},getSnapshotIndex=function(e){for(var t=0;t<treeDocumentSnapshots.length;t++)if(treeDocumentSnapshots[t].treeDocument===e)return t};define("DS/TreeModel/ModelUtils",[],function(){"use strict";return{bindEventOnDocument:function(e,t,n,i){e&&t&&(e._listeners||(e._listeners=[]),e._listeners.push(t.subscribe({event:n},i)))},cleanBindingOnDocument:function(e,t){e&&e._listeners&&t&&(e._listeners.forEach(function(e){t.unsubscribe(e)}),e._listeners=[])},sortNodesByRowID:function(e){e&&e.sort(function(e,t){return e._getRowID()-t._getRowID()})},moveNodes:function(e,t,n){n||(n={}),void 0===n.direction&&(n.direction=1),n.isSortedArray||this.sortNodesByRowID(e);let i=t.getParent();for(var o=e.length-1;o>=0;o--)e[o].__keepSelection=!0,e[o].remove();if(0===n.direction){let n=t.getChildren()?t.getChildren().length:0;return t.addChild(e),0===n&&t.expand(),t}{let r=t._getLocalID();for(o=e.length-1;o>=0;o--){let t=r+(n.direction>0?1:0);i.addChild(e[o],t),delete e[o].__keepSelection}return i}},getHierachySet:function(e){let t=new Set;for(var n=0;n<e.length;n++){let i=e[n];for(;i&&!i._isTrueRoot();){let e=t.size;if(t.add(i),e===t.size)break;i=i.getParent()}}return t},saveTreeDocumentOrder:function(e){if(e){let t=snapshotTreeDocument(e),n=getSnapshotIndex(e);n>=0?treeDocumentSnapshots[n].snapshot=t:treeDocumentSnapshots.push({treeDocument:e,snapshot:t})}},destroyTreeDocumentOrderSnapshot:function(e){if(e){let t=getSnapshotIndex(e);t>=0&&treeDocumentSnapshots.splice(t,1)}},restoreTreeDocumentOrder:function(e){let t=getSnapshotIndex(e);if(void 0!==t){let n=treeDocumentSnapshots[t].snapshot;n.length>0&&(e.prepareUpdate(),e.executeWithoutEvents(function(){let t=e.getUseChangeTransactionMode();e.setUseChangeTransactionMode(!1);for(let t=0;t<n.length;t++){let o=n[t],r=o.children,s=o.node.getChildren();for(var i=0;i<r.length;i++)s&&s[i]===r[i]||r[i].getTreeDocument()!==e||o.node.addChild(r[i],i,{treeDocument:e})}e.setUseChangeTransactionMode(t)}),e.pushUpdate())}}}}),define("DS/TreeModel/DataModelSet",["DS/CoreEvents/ModelEvents"],function(e){"use strict";var t=-1;function n(n){this._id=t++,this._setData(n),this._modelEvents=new e({target:this})}function i(){this._listOfDataModels={}}return n.prototype._getData=function(e){return this._data},n.prototype._setData=function(e){this._data=e},n.prototype._getID=function(){return this._id},n.prototype._getDataModelSet=function(){return this._dataModelSet},n.prototype._getModelEvents=function(){return this._modelEvents},n.prototype._setDataModelSet=function(e){this._dataModelSet=e},n.prototype._getInfos=function(){return{}},n.prototype.update=function(e){void 0!==e&&UWA.extend(this._data,e,!0),this._modelEvents.publish({event:"DataModel:update",data:e,context:this})},i.prototype.getDataModel=function(e){return this._listOfDataModels[e]},i.prototype.createDataModel=function(e){var t=new n(e);return t._setDataModelSet(this),this._listOfDataModels[t._getID()]=t,t},i}),define("DS/TreeModel/BaseFilter",["UWA/Core","DS/Core/BaseComponent"],function(e,t){"use strict";return t.inherit({name:"filter",publishedProperties:{filterManager:{defaultValue:null,type:"object",readOnly:!0},filterId:{defaultValue:"",type:"string",readOnly:!0},propertyId:{defaultValue:"",type:"string",readOnly:!0},filterModel:{defaultValue:void 0,type:"object"},defaultFilterModel:{defaultValue:null,type:"object",noNeedToApplyFlag:!0},filterOptions:{defaultValue:void 0,type:"object"}},getFilterByConditionId:function(){return this.filterId},isDataFiltered:function(e){return!1},isEmpty:function(e,t){return!1},reset:function(){this.filterModel=this.defaultFilterModel},canBeReset:function(){return!this.filterModelsAreEqual(this.filterModel,this.defaultFilterModel)},filterModelsAreEqual:function(t,n){return!(t&&!e.equals(t,{})&&!e.equals(t,[])||n&&!e.equals(n,{})&&!e.equals(n,[]))||e.equals(t,n)},_build:function(){this._listOfFilteredData=[]},destroy:function(){this._listOfFilteredData.forEach(function(e){e.decrementFilteredCount()}),this._listOfFilteredData=[],this._parent()},_applyFilterModel:function(e){var t=this.filterManager;if(t){var n=t.model;if(n&&n.prepareUpdate&&n.prepareUpdate(),this._listOfFilteredData.forEach(function(e){e.decrementFilteredCount()}),this._listOfFilteredData=[],!this.filterModel)return t.publish("filterModelChange",{propertyId:this.propertyId,filter:this}),t.filterModel[this.propertyId]&&delete t.filterModel[this.propertyId].filterModel,void(n&&n.pushUpdate&&n.pushUpdate({updateType:WUXModelUpdateTypes.Filtering}));t.filterModel[this.propertyId].filterModel=this.filterModel;var i=this;if(n&&n.processDescendants){this.filterOptions&&this.filterOptions.keepChildren&&n.processDescendants({treeTraversalOrder:"preOrder",processNode:function(e){if(!e.nodeModel.canBeFiltered(i.propertyId)||!i.isDataFiltered(e.nodeModel))return i._preventFilteringOnNodeAndDescendants(e.nodeModel),{shouldProcessDescendants:!1}}});var o=this.isEmpty();n.processDescendants({treeTraversalOrder:"postOrder",processNode:function(e){var t=!1;(!0===e.nodeModel._preventFiltering&&(delete e.nodeModel._preventFiltering,t=!0),!t&&e.nodeModel.canBeFiltered(i.propertyId)&&i.isDataFiltered(e.nodeModel))?(e.nodeModel.incrementFilteredCount(),i._listOfFilteredData.push(e.nodeModel)):e.nodeModel.isFiltered()||e.nodeModel.getParents().forEach(function(e){e._preventFiltering=!0,i.filterOptions&&i.filterOptions.ensureVisible&&!o&&!e.isExpanded()&&e.expand()})}})}t.publish("filterModelChange",{propertyId:this.propertyId,filter:this}),n&&n.pushUpdate&&n.pushUpdate({updateType:WUXModelUpdateTypes.Filtering})}},_applyFilterOptions:function(){},_applyProperties:function(e){this._parent(e),this.isDirty("filterModel")&&this._applyFilterModel(e.filterModel)},_preventFilteringOnNodeAndDescendants:function(e){if(e){e._preventFiltering=!0;var t=e.getChildren();if(t){var n=this;t.forEach(function(e){n._preventFilteringOnNodeAndDescendants(e)})}}},getListOfFilteredData:function(){return this._listOfFilteredData},getAttributeValueForFiltering:function(e,t){if(e)return e.options&&e.options.getAttributeValueForFiltering?e.options.getAttributeValueForFiltering(t):e.getAttributeValue(t)}})}),define("DS/TreeModel/ConditionAndSetBaseFilter",["DS/TreeModel/BaseFilter"],function(e){"use strict";return e.inherit({name:"conditionandsetfilter",publishedProperties:{},isDataFiltered:function(e){if(!this.filterModel)return!1;var t=this._getOrCreateCurrentFilter();return!!t&&t.isDataFiltered(e)},isEmpty:function(e,t){const n=void 0!==e?e:this.filterModel;if(!n)return!0;const i=void 0!==t?t:this.filterManager?this.filterManager.model:null;var o=this._getOrCreateCurrentFilter(n);return!o||o.isEmpty(e,i)},_createFilter:function(e){var t=null,n=this.filterManager;if(n&&e){var i=n.getFilterClassName(e);i&&(t=new i({filterManager:null,propertyId:this.propertyId,filterModel:this.filterModel,filterId:e,filterOptions:this.filterOptions}))}return t},_getOrCreateFilterWithArray:function(){return this._filterWithArray||(this._filterWithArray=this._createFilter("set")),this._filterWithArray},_getOrCreateFilterWithCondition:function(){return this._filterWithCondition||(this._filterWithCondition=this._createFilter(this.getFilterByConditionId())),this._filterWithCondition},_getOrCreateCurrentFilter:function(e){const t=void 0!==e?e:this.filterModel;return Array.isArray(t)?this._getOrCreateFilterWithArray():this._getOrCreateFilterWithCondition()},_getCurrentFilter:function(){return Array.isArray(this.filterModel)?this._filterWithArray:this._filterWithCondition},_applyFilterModel:function(e){var t=this._getCurrentFilter();t&&(t.filterModel=this.filterModel),this._parent(e)}})}),define("DS/TreeModel/TreeNodeModel",["UWA/Core","UWA/Class","DS/CoreEvents/ModelEvents","DS/Utilities/Debug","DS/Utilities/Utils","DS/Utilities/Array","DS/Utilities/Data","DS/Utilities/RAFDispatcher","DS/Utilities/TreeUtils","DS/TreeModel/ModelUtils"],function(e,t,n,i,o,r,s,a,d,l){"use strict";var h=-1;const p={noChildren:"noExpandState",noChildrenCollapsed:"noExpandStateExpand",noChildrenExpanded:"noExpandStateCollapse",expanding:"expandingState",partiallyExpanded:"partiallyExpandedState",expanded:"collapseState",collapsed:"expandState"},u={noExpandState:"noChildren",noExpandStateExpand:"noChildrenCollapsed",noExpandStateCollapse:"noChildrenExpanded",expandingState:"expanding",partiallyExpandedState:"partiallyExpanded",collapseState:"expanded",expandState:"collapsed"};function c(t){var i=this;this.defaultOptions={label:"",badges:{topLeft:null,topRight:null,bottomLeft:null,bottomRight:null},icons:[],grid:{},children:null,data:{},useAsyncPreExpand:void 0,getAttributeValueForFiltering:function(e){return i.getAttributeValue(e)}},this._options=e.extend(e.clone(this.defaultOptions),t);i=this;if(Object.defineProperty(this,"options",{get:function(){if(i._isUsingDataModel()){var t={getAttributeValueForFiltering:function(e){return i.getAttributeValue(e)}};return i._getDataModel()._data=e.extend(t,i._getDataModel()._data),i._getDataModel()._data}return i._options},set:function(e){i._isUsingDataModel()?i._getDataModel()._setData(e):i._options=e}}),i._listOfChildren=null,Object.defineProperty(this,"__children",{get:function(){return i._isUsingDataModel()?i._listOfChildren:i.options.children},set:function(e){i._isUsingDataModel()?i._listOfChildren=e:i.options.children=e}}),this._modelEvents=new n({target:this}),this._id=h++,this._nodeIsAsync=!1,this._isHighlighted=!1,this._isHidden=!1,this.__expandAllCounter=0,this._nodeDepth=-1,this._rowID=null,this._parentNode=null,this._expandState="noExpandState",this.__dataModelID=null,this.options.children){this._preventResetChildren=0===this.options.children.length,this._expandState="expandState";var o=this.options.children;this.__children=[],this.options.children=[],this.addChild(o)}this._setChangeStates(WUXModelChangeStates.Unchanged),this.options._isTrueRoot&&(c.prototype.addRoot=function(e,t){return this.addChild(e,t)});i=this;this._modelEvents.subscribe({event:"DataModel:update"},function(e){e.stopPropagation(),i.withTransactionUpdate(function(){i.notifyModelUpdate(e.data.grid)})})}function f(e){c.call(this,e)}return c.prototype._setDataModel=function(e){this.__dataModelSet=e._getDataModelSet(),this.__dataModelID=e._getID(),e._getModelEvents()._addParent(this.getModelEvents()),this.notifyModelUpdate()},c.prototype._removeDataModel=function(e){void 0!==this.__dataModelID&&this.__dataModelSet&&(e._getModelEvents()._unsetParent(this.getModelEvents()),this.__dataModelID=null,this.__dataModelSet=null),this.notifyModelUpdate()},c.prototype._getDataModel=function(){return this.__dataModelSet.getDataModel(this.__dataModelID)},c.prototype._isUsingDataModel=function(){return null!==this.__dataModelID&&void 0!==this.__dataModelID},c.prototype.getModelEvents=function(){return this._modelEvents},c.prototype.addEventListener=function(e,t){return this.getModelEvents().addEventListener(e,t)},c.prototype.removeEventListener=function(e){this.getModelEvents().unsubscribe(e)},c.prototype._getRowID=function(e){return(e||null===this._rowID)&&(this._rowID=this._computeRowID()),this._rowID},c.prototype._getID=function(){return this._id},c.prototype.addChild=function(e,t,n){var o,r="[TreeNodeModel] -- Add child --";if(i.beginMeasure(r),e instanceof Array)o=this._loadModel(e,this,t,n);else{if(e instanceof c){if(e.isAscendantOf(this))return void console.warn("TreeNodeModel: Cannot add a parent node as a child");var s=e.getParent();s&&s.removeChild(e,!0,n)}o=this._loadModel([e],this,t,n)}return i.endMeasure(r),o},c.prototype.moveChild=function(e,t,n){e.__keepSelection=!0,this.addChild(e,t,n),delete e.__keepSelection},c.prototype.notifyModelUpdate=function(e){var t=this._getNodeInfos();e&&(t.attributes=e),this._modelEvents.publish({event:"nodeModelUpdate",data:t,context:this})},c.prototype.setAttribute=function(e,t){if(!this.options.grid.hasOwnProperty(e)||Array.isArray(t)&&this.options.grid[e]===t||0!==o.compare(this.options.grid[e],t)){if((!this._referenceValues||!this._referenceValues.hasOwnProperty(e))&&this.options.grid.hasOwnProperty(e)&&0!==o.compare(this.options.grid[e],t)){var n=this.getTreeDocument();!this._changeTransactionModeDisabled&&n&&n.getUseChangeTransactionMode()&&(this.setReferenceValue(e,this.options.grid[e]),this._setChangeStates(WUXModelChangeStates.AttributesChanged,"add"))}this.options.grid[e]=t;var i=this._getNodeInfos();i.changedAttribute=e,i.changedAttributeValue=t,this._modelEvents.publish({event:"attributeChanged",data:i,context:this});var r={};r[e]=t,this.notifyModelUpdate(r)}},c.prototype.removeAttribute=function(e){if(this.options.grid.hasOwnProperty(e)){delete this.options.grid[e];var t=this._getNodeInfos();t.changedAttribute=e,this._modelEvents.publish({event:"attributeChanged",data:t,context:this});var n={};n[e]=void 0,this.notifyModelUpdate(n)}},c.prototype.updateOptions=function(e){var t={};if(e&&e.grid){var n=this.getTreeDocument();for(var i in e.grid)this.options.grid[i]!==e.grid[i]&&(t[i]=e.grid[i],this._referenceValues&&this._referenceValues.hasOwnProperty(i)||!this.options.grid.hasOwnProperty(i)||this._changeTransactionModeDisabled||!n||!n.getUseChangeTransactionMode()||(this.setReferenceValue(i,this.options.grid[i]),this._setChangeStates(WUXModelChangeStates.AttributesChanged,"add")))}this._isUsingDataModel()?this._getDataModel().update(e):("object"==typeof e&&null!==e&&o.extendObjectInstanceWithNewInside(this.options,e,!0),this.withTransactionUpdate(function(){this.notifyModelUpdate(t)}))},c.prototype.onAttributeChange=function(e){return this._modelEvents.subscribe({event:"attributeChanged"},e)},c.prototype.getReferenceValue=function(e){return this._referenceValues&&this._referenceValues.hasOwnProperty(e)?this._referenceValues[e]:this.options.grid[e]},c.prototype.hasReferenceValue=function(e){return this._referenceValues&&this._referenceValues.hasOwnProperty(e)},c.prototype.getReferenceValues=function(){return this._referenceValues},c.prototype.setReferenceValue=function(t,n){this._referenceValues||(this._referenceValues={}),this._referenceValues[t]=e.clone(n,!1),0!==o.compare(this.options.grid[t],n)&&this._setChangeStates(WUXModelChangeStates.AttributesChanged,"add")},c.prototype.getReferenceLabel=function(){return this._referenceLabel?this._referenceLabel:this.getLabel()},c.prototype.setReferenceLabel=function(e){this._referenceLabel=e,0!==o.compare(this.getLabel(),e)&&this._setChangeStates(WUXModelChangeStates.AttributesChanged,"add")},c.prototype.resetToReferenceValues=function(){var t=this._changeTransactionModeDisabled;if(this._changeTransactionModeDisabled=!0,this._setChangeStates(WUXModelChangeStates.AttributesChanged,"remove"),this._referenceValues){var n=this,i={};Object.keys(this._referenceValues).forEach(function(t){n.options.grid.hasOwnProperty(t)&&0!==o.compare(n.options.grid[t],n._referenceValues[t])&&(i[t]=e.clone(n._referenceValues[t],!1))}),this._referenceValues=null,this.updateOptions({grid:i})}this._referenceLabel&&(this.setLabel(this._referenceLabel),this._referenceLabel=null),this._changeTransactionModeDisabled=t},c.prototype.setValuesAsReference=function(){this._setChangeStates(WUXModelChangeStates.AttributesChanged,"remove"),(this._referenceValues||this._referenceLabel)&&(this._referenceValues=null,this._referenceLabel=null,this.notifyModelUpdate())},c.prototype.getChangeStates=function(){return this._changeStates},c.prototype._setChangeStates=function(e,t){var n=this._changeStates;"add"===t?this._changeStates|=e:"remove"===t?this._changeStates&=~e:this._changeStates=e;var i=this.getTreeDocument();i&&(n===WUXModelChangeStates.Unchanged&&this._changeStates!==WUXModelChangeStates.Unchanged?i._managePendingChanges("add"):n!==WUXModelChangeStates.Unchanged&&this._changeStates===WUXModelChangeStates.Unchanged&&i._managePendingChanges("remove"))},c.prototype.cancelChanges=function(e){if(e){var t=this.getChildren();if(t)for(var n=t.length;n>=0;n--){var i=t[n];i&&i.cancelChanges(!0)}}if(this._changeStates&WUXModelChangeStates.NodeAdded){var o=this.getParent();o&&o.removeChild(this,!0)}else this._changeStates&WUXModelChangeStates.AttributesChanged&&this.resetToReferenceValues(),this._changeStates&WUXModelChangeStates.NodeToBeRemoved&&(this._setChangeStates(WUXModelChangeStates.NodeToBeRemoved,"remove"),this.notifyModelUpdate());this._setChangeStates(WUXModelChangeStates.Unchanged)},c.prototype.acceptChanges=function(e){var t=0;if(e){var n=this.getChildren();if(n)for(var i=n.length;i>=0;i--){var o=n[i];if(o)t|=o.acceptChanges(!0)}}if(this._changeStates&WUXModelChangeStates.NodeToBeRemoved){var r=this.getParent();r&&r.removeChild(this,!0),t|=WUXModelUpdateTypes.Removal}else this._changeStates&WUXModelChangeStates.AttributesChanged&&(this.setValuesAsReference(),t|=WUXModelUpdateTypes.AttributesChange),this._changeStates&WUXModelChangeStates.NodeAdded&&(this._changeStates&=~WUXModelChangeStates.NodeAdded,this.notifyModelUpdate(),t|=WUXModelUpdateTypes.Addition);return this._setChangeStates(WUXModelChangeStates.Unchanged),{updateType:t}},c.prototype.prepareUpdate=function(){this._modelEvents.publish({event:"prepareUpdate",data:this._getNodeInfos(),context:this})},c.prototype.pushUpdate=function(e){this._modelEvents.publish({event:"pushUpdatePrivate",data:this._getNodeInfos(),context:this,options:e}),this._modelEvents.publish({event:"pushUpdate",data:this._getNodeInfos(),context:this,options:e})},c.prototype.insertBefore=function(e,t){if(this.prepareUpdate(),t){e.getParent()&&e.remove();var n=t._getLocalID();this.addChild(e,n)}else this.addChild(e);this.pushUpdate({updateType:WUXModelUpdateTypes.Addition})},c.prototype._setParent=function(e){this._parentNode=e,this._nodeDepth=e.getNodeDepth()+1},c.prototype._unsetParent=function(){this._parentNode=null,this._nodeDepth=-1},c.prototype.highlight=function(){this._isHighlighted=!0,this._modelEvents.publish({event:"highlight",data:this._getNodeInfos(),context:this})},c.prototype.unhighlight=function(){this._isHighlighted=!1,this._modelEvents.publish({event:"unhighlight",data:this._getNodeInfos(),context:this})},c.prototype.onHighlight=function(e){return this._modelEvents.subscribe({event:"highlight"},e)},c.prototype.onUnhighlight=function(e){return this._modelEvents.subscribe({event:"unhighlight"},e)},c.prototype.isHighlighted=function(){return this._isHighlighted},c.prototype.preSelect=function(e){var t=this.getTreeDocument();t?this.isPreSelected()?t.getXSO().get().length>1&&t.options.shouldBeSelected.call(t,this)&&(this.prepareUpdate(),e&&t.getPXSO().unique(this),this._isPreSelected=!0,this.pushUpdate({updateType:WUXModelUpdateTypes.PreSelection})):t.options.shouldBeSelected.call(t,this)&&(this.prepareUpdate(),e?t.getPXSO().unique(this):t.getPXSO().add(this),this._isPreSelected=!0,this.pushUpdate({updateType:WUXModelUpdateTypes.PreSelection})):console.warn("You tried to pre-select a treeNode which is not attached to a tree document")},c.prototype.unPreSelect=function(){if(this.isPreSelected()){var e=this.getTreeDocument();e?(this.prepareUpdate(),e.getPXSO().remove(this),this._isPreSelected=!1,this.pushUpdate({updateType:WUXModelUpdateTypes.PreSelection})):console.warn("You tried to pre-select a treeNode which is not attached to a tree document")}},c.prototype.isPreSelected=function(){var e=this.getTreeDocument();return e?e.getPXSO().isIn(this):this._isPreSelected},c.prototype.select=function(e){var t=this.getTreeDocument();if(t){if(this.isSelected({treeDocument:t})){if(t.getXSO().get().length>1&&t.options.shouldBeSelected.call(t,this)){if(this.prepareUpdate(),e){n=t.getXSO().get();t.getXSO().unique(this),n.forEach(function(e){e.selectionChangeIsNotFromUI()})}this._isSelected=!0,this.selectionChangeIsNotFromUI(),this.pushUpdate({updateType:WUXModelUpdateTypes.Selection})}}else if(t.options.shouldBeSelected.call(t,this)){if(this.prepareUpdate(),e){var n=t.getXSO().get();t.getXSO().unique(this),n.forEach(function(e){e.selectionChangeIsNotFromUI()})}else t.getXSO().add(this);this._isSelected=!0,this.selectionChangeIsNotFromUI(),this.pushUpdate({updateType:WUXModelUpdateTypes.Selection})}}else console.warn("You tried to select a treeNode which is not attached to a tree document")},c.prototype.isSelectionChangeFromUI=function(){return Boolean(this.__selectionChangeisFromUI)},c.prototype.selectionChangeIsFromUI=function(){this.__selectionChangeisFromUI=!0},c.prototype.selectionChangeIsNotFromUI=function(){this.__selectionChangeisFromUI=!1},c.prototype.unselect=function(e){if(this.isSelected(e)){var t=e&&e.treeDocument?e.treeDocument:this.getTreeDocument();t?(this.prepareUpdate(),t.getXSO().remove(this),this._isSelected=!1,this.pushUpdate({updateType:WUXModelUpdateTypes.Selection})):console.warn("You tried to select a treeNode which is not attached to a tree document")}},c.prototype.onSelect=function(e){return this._modelEvents.subscribe({event:"select"},e)},c.prototype.onUnselect=function(e){return this._modelEvents.subscribe({event:"unselect"},e)},c.prototype.onPreselect=function(e){return this._modelEvents.subscribe({event:"preselect"},e)},c.prototype.onUnpreselect=function(e){return this._modelEvents.subscribe({event:"unpreselect"},e)},c.prototype.isSelected=function(e){var t=e&&e.treeDocument?e.treeDocument:this.getTreeDocument();return t?t.getXSO().isIn(this):this._isSelected},c.prototype.hide=function(e){if(!0!==this._isHidden){this.prepareUpdate(),this._isHidden=!0,e||(this.unhighlight(),this.unselect()),this._modelEvents.publish({event:"hide",data:this._getNodeInfos(),context:this});var t=this.getFirstVisibleParent();t&&t._updateExpanderState(),this.pushUpdate({updateType:WUXModelUpdateTypes.VisibilityChange})}},c.prototype.show=function(){this.prepareUpdate(),this._isHidden=!1,this._modelEvents.publish({event:"show",data:this._getNodeInfos(),context:this});var e=this.getFirstVisibleParent();e&&e._updateExpanderState(),this.pushUpdate({updateType:WUXModelUpdateTypes.VisibilityChange})},c.prototype.isHidden=function(){return this._isHidden},c.prototype.hideChildNodes=function(){this.withTransactionUpdate(function(){this.hasChildren()&&(this.getChildren().forEach(function(e){e.hide()}),this._updateExpanderState())})},c.prototype.showChildNodes=function(){this.withTransactionUpdate(function(){this.hasChildren()&&(this.getChildren().forEach(function(e){e.show()}),this._updateExpanderState())})},c.prototype._loadModel=function(t,n,i,o){this.prepareUpdate();for(var r,s=t.length,a=0;a<s;a++){var d,l=t[a];l instanceof c?d=l:(d={},(d=e.extend({label:"",icons:[],grid:{},badges:null,data:null,manager:null},l)).children=void 0,d.manager=void 0,delete d.expandedState),n&&(r=n._addChild(d,i,o)),l instanceof c||!l.children||(l.children.length>0?this._loadModel(l.children,r,void 0,o):(r.__children=[],r._expandState="expandState"),"expanded"!==l.expandedState&&"partiallyExpanded"!==l.expandedState||(r.expand(),r.setState({state:l.expandedState})))}return this.pushUpdate({updateType:WUXModelUpdateTypes.Addition}),r},c.prototype.destroy=function(){if(this.hasChildren()){this.getChildren().forEach(function(e){e.destroy()})}for(var e in this._modelEvents.unsubscribeAll(),this._modelEvents=null,delete this._modelEvents,this.defaultOptions=null,this)this.hasOwnProperty(e)&&"function"!=typeof this[e]&&(this[e]=null)},c.prototype._propagateDepth=function(){if(this.hasChildren()){var e=this;this.getChildren().forEach(function(t){t._nodeDepth=e.getNodeDepth()+1,t._propagateDepth()})}},c.prototype._addChild=function(e,t,n){var i=this._addChildNode(e,t,n);i._nodeDepth=this.getNodeDepth()+1,i._propagateDepth();var o=i._getNodeInfos();return o.nodeIndex=i._localID,this._modelEvents.publish({event:"addChild",data:o,context:this}),i},c.prototype.getNthChild=function(e){if(this.getChildren())return this.getChildren()[e]},c.prototype.getLastChild=function(){return this.getChildren()[this.getChildren().length-1]},c.prototype._dump=function(t,n){n||(n={}),t=e.extend({properties:[function(){return{property:"label",value:this.options.label}},function(){return{property:"grid",value:this.options.grid}},function(){return{property:"icons",value:this.options.icons}}]},t);var i=this;t.properties.forEach(function(t){if("function"===e.typeOf(t)){var o=t.call(i);n[o.property]=o.value}});var o=this.getChildren();return o?(n.children=[],o.forEach(function(e){n.children.push(e._dump(t))}),n):n},c.prototype.dump=function(e,t){return this._dump(e,t)},c.prototype.isAscendantOf=function(e){for(var t=e;t&&!t.options.isRoot;){if(t===this)return!0;t=t.getParent()}return!1},c.prototype.isVisible=function(){return this._isVisible()},c.prototype._getLocalID=function(){var e=this.getParent();if(e){var t=e.getChildren();if(t)return t.indexOf(this)}return 0},c.prototype._isTrueRoot=function(){return!!this.options&&this.options._isTrueRoot},c.prototype.remove=function(e){var t=this.getParent();if(t)return t.removeChild(this,e);console.warn("Cannot remove this node because its father is undefined")},c.prototype.empty=function(){var e=this;this.withTransactionUpdate(function(){e.getModelEvents().publish({event:"empty"});for(var t=e.getChildren()||[],n=t.length-1;n>=0;n--)t[n].remove();e._fakeNodesTable&&(e._fakeNodesTable=void 0,delete e._fakeNodesTable)})},c.prototype.removeChild=function(e,t,n){if(void 0!==e){var i;this.prepareUpdate();var o,r=this.getChildren();"number"==typeof e?e=r[o=e]:o=r.indexOf(e);var s=n&&n.treeDocument?n.treeDocument:this.getTreeDocument();if(!this._changeTransactionModeDisabled&&s&&s.getUseChangeTransactionMode()&&!t)!e||e._changeStates&WUXModelChangeStates.NodeToBeRemoved||(e._setChangeStates(WUXModelChangeStates.NodeToBeRemoved,"add"),e.notifyModelUpdate());else{this._modelEvents.publish({event:"preRemoveChild",data:e._getNodeInfos(),context:this}),e._unsetParent(),e._detach(null),-1!==o&&(i=r.splice(o,1)[0]),0!==r.length||this._preventResetChildren||(this.__children=null);for(var a=!0,d=0;d<r.length;d++)if(!1===r[d].isHidden()&&!1===r[d].isFiltered()){a=!1;break}a&&this._updateExpanderState(n),this._modelEvents.publish({event:"removeChild",data:e._getNodeInfos(),context:this})}return this.pushUpdate({updateType:WUXModelUpdateTypes.Removal}),i}console.warn("Cannot remove an undefined child")},c.prototype.removeChildren=function(e){this.prepareUpdate();var t=[],n=this.getChildren();if(e&&!1===e.sendEventForEachNode){var i=e&&e.treeDocument?e.treeDocument:this.getTreeDocument(),o=!0,r=!this._changeTransactionModeDisabled&&i&&i.getUseChangeTransactionMode();r||this._modelEvents.publish({event:"preRemoveChildren",data:n,context:this});for(a=0;a<n.length;a++){var s=n[a];!1===s.isHidden()&&!1===s.isFiltered()&&(o=!1),r?(r=!0,!s||s._changeStates&WUXModelChangeStates.NodeToBeRemoved||(s._setChangeStates(WUXModelChangeStates.NodeToBeRemoved,"add"),s.notifyModelUpdate())):(t.push(s),s._unsetParent(),s._detach(null))}r||(o&&this._updateExpanderState(e),this.__children=null,this._modelEvents.publish({event:"removeChildren",data:n,context:this}))}else if(n)for(var a=n.length-1;a>=0;a--)t.push(this.removeChild(n[0],void 0,e));return this.pushUpdate({updateType:WUXModelUpdateTypes.Removal}),t},c.prototype._addChildNode=function(e,t,n){var i,o=n&&n.treeDocument?n.treeDocument:this.getTreeDocument();if(e instanceof c){var r=(i=e).getParent();r&&r.removeChild(i,!0,n)}else{i=new(o&&o.options.nodeModelClass?o.options.nodeModelClass:c)(e)}return o?i._modelEvents._setParent(o._getTrueRoot()._modelEvents):i._modelEvents._setParent(this._modelEvents),this.__children||(this.__children=[]),void 0===t?t=this.__children.push(i)-1:this.__children.splice(t,0,i),i._localID=t,i._parentNode=this,this._updateExpanderState(n),!this._changeTransactionModeDisabled&&o&&o.getUseChangeTransactionMode()&&i._setChangeStates(WUXModelChangeStates.NodeAdded,"add"),i},c.prototype._detach=function(){this._rowID=null,delete this.__trueRoot,this.hasChildren()&&r.optimizedForEach(this.getChildren(),function(e,t){e._detach()})},c.prototype.isExpanded=function(){if(this.hasNoRepresentation())return!0;if(0===this._depth)return!0;var e=this.getState();return"expanded"===e||"partiallyExpanded"===e||"noChildrenExpanded"===e},c.prototype.onPreExpand=function(e){return this._modelEvents.subscribe({event:"preExpand"},e)},c.prototype.onPreExpandAll=function(e){return this._modelEvents.subscribe({event:"preExpandAll"},e)},c.prototype.onPostExpand=function(e){return this._modelEvents.subscribe({event:"postExpand"},e)},c.prototype.onPreCollapse=function(e){return this._modelEvents.subscribe({event:"preCollapse"},e)},c.prototype.onPostCollapse=function(e){return this._modelEvents.subscribe({event:"postCollapse"},e)},c.prototype.preExpandDone=function(t){t=e.extend({preventExpandAll:!1,state:"expanded"},t);var n=this.getTree();n&&n._syncRowIndexes(),this._modelEvents.publish({event:"PRE_EXPAND_DONE",context:this,data:t})},c.prototype._getNodeInfos=function(){return{nodeModel:this,virtualRowID:this._rowID,nodeLocalID:this._localID}},c.prototype.setState=function(t){null!==(t=e.extend({state:null},t)).state&&("noChildren"===this.getState()&&"expanding"===t.state||(this.prepareUpdate(),this._expandState=p[t.state],this._modelEvents.publish({event:"expandStateChange",context:this,data:t}),this.pushUpdate({updateType:WUXModelUpdateTypes.Expand})))},c.prototype.getState=function(){return u[this._expandState]},c.prototype.expand=function(e){return this._privateExpand(e)},c.prototype.expandNLevels=function(t){return t=e.extend({expandAll:!1,numberOfLevelsToExpand:1},t),this._privateExpand(t)},c.prototype._privateExpand=function(t,n,o){var s=this,a=t&&t.treeDocument?t.treeDocument:this.getTreeDocument(),l=void 0!==s.options.useAsyncPreExpand?s.options.useAsyncPreExpand:!!a&&a.options.useAsyncPreExpand;if(t=e.extend({expandAll:!1,interactiveExpandAll:!1,numberOfLevelsToExpand:1,onExpandComplete:function(e){}},t),void 0===n&&(n=0),n++,void 0===o&&(o=this,this.__expandAllCounter=0),l){o._beginOfSubExpand(t);var h=s.getChildren(),u=!0;if(h&&0===h.length&&(u=!1),h)for(var c=0;c<h.length;c++)if(!1===h[c].isHidden()&&!1===h[c].isFiltered()){u=!1;break}if(u&&"expandState"!==s._expandState&&"noExpandStateExpand"!==s._expandState)t.onExpandComplete&&t.onExpandComplete.call(s,t),o._endOfSubExpand(t);else{s.setState({state:"expanding"});var f=e.extend(s._getNodeInfos(),t);i.log("watching pre expand on ",s.options.label),s._modelEvents.subscribeOnce({event:"PRE_EXPAND_DONE"},function(e){i.log("2) async pre expand done! ",s.options.label),function(e,a){if(void 0===a&&(a="expanded"),s._expandState=p[a],s._isExpanded=!0,s._updateExpanderState(),s._modelEvents.publish({event:"expand",data:f,context:s}),i.log("3) expand ",s.options.label),t.expandAll||n<t.numberOfLevelsToExpand){var d=s.getVisibleChildren();d&&!e?r.optimizedForEach(d,function(e,i){e._privateExpand(t,n,o)}):t.onExpandComplete&&t.onExpandComplete.call(s,t)}s._modelEvents.publish({event:"postExpandPrivate",data:f,context:s}),o._endOfSubExpand(t),s._modelEvents.publish({event:"postExpand",data:f,context:s}),i.log("4) post expand on ",s.options.label)}.call(this,e.data.preventExpandAll,e.data.state)}),i.log("1) pre expand ",s.options.label),s._modelEvents.publish({event:"preExpandPrivate",data:f,context:s}),s._modelEvents.publish({event:"preExpand",data:f,context:s})}}else{let n=!1,r=function(r){n=!0,o._beginOfSubExpand(t),"expandState"===r._expandState&&r.setState({state:"expanding"});var a=e.extend(r._getNodeInfos(),t);i.log("1) pre expand ",r.options.label),s._modelEvents.publish({event:"preExpandPrivate",data:a,context:r}),s._modelEvents.publish({event:"preExpand",data:a,context:r}),i.log("2) sync pre expand done! ",r.options.label);r._expandState=p.expanded,r._isExpanded=!0,r._modelEvents.publish({event:"expand",data:a,context:r}),i.log("3) expand ",r.options.label)},a=function(n){var r=e.extend(n._getNodeInfos(),t);n._modelEvents.publish({event:"postExpandPrivate",data:r,context:n}),o._endOfSubExpand(t),n._modelEvents.publish({event:"postExpand",data:r,context:n}),i.log("4) post expand on ",n.options.label)},l=function(e,n){if(e.options.useAsyncPreExpand)return e._privateExpand(t,n,o),{processSelf:!1,processChildren:!1};var i=e.getChildren(),r=!0;if(i&&i.length)for(var a=0;a<i.length;a++)if(!1===i[a].isHidden()&&!1===i[a].isFiltered()){r=!1;break}return r&&"expandState"!==s._expandState?{processSelf:!1,processChildren:!1}:t.expandAll||n<t.numberOfLevelsToExpand-1?{processSelf:!0,processChildren:!0}:{processSelf:!0,processChildren:!1}};d.processTreeIterative(this,{functionName:"getChildren"},{preCallback:r,postCallback:a},l,"preAndPostOrder"),n||(o._beginOfSubExpand(t),t.onExpandComplete&&t.onExpandComplete.call(s,t),o._endOfSubExpand(t))}},c.prototype._beginOfSubExpand=function(e){this.prepareUpdate(),this.__expandAllCounter++,1===this.__expandAllCounter&&e&&e.expandAll&&this._modelEvents.publish({event:"preExpandAll",data:this._getNodeInfos(),context:this})},c.prototype._endOfSubExpand=function(e){this.__expandAllCounter--,this.pushUpdate({updateType:WUXModelUpdateTypes.Expand}),0===this.__expandAllCounter&&e&&e.expandAll&&this._modelEvents.publish({event:"postExpandAll",data:this._getNodeInfos(),context:this}),this.__expandAllCounter<0&&console.error("too many calls of _endOfSubExpand")},c.prototype.withTransactionUpdate=function(e){if(e){var t;this.prepareUpdate();try{t=e.call(this,this._getNodeInfos())}finally{this.pushUpdate(t)}}},c.prototype.expandAll=function(e){this.prepareUpdate(),this.options._isTrueRoot||this.expand({expandAll:!0,onExpandComplete:e&&e.onExpandComplete}),this.pushUpdate({updateType:WUXModelUpdateTypes.Expand})},c.prototype.processDescendants=function(t){return t=e.extend({async:!1,onlyVisibleNodes:!1,processNode:function(e){},treeTraversalOrder:"preOrder",onComplete:function(){}},t),this._getDescendantAndProcess(void 0,t)},c.prototype._getDescendantAndProcess=function(t,n){let i=this;(n=e.extend({async:!1,onlyVisibleNodes:!1,treeTraversalOrder:"preOrder"},n)).treeDocument||(n.treeDocument=this.getTreeDocument()),void 0===t?t=[]:t.push(this);var o=this.getChildren();if(o)if(void 0===n.onCompleteCB){let e=function(e){if(e===i)return{processSelf:!1,processChildren:!0};let t=!n.onlyVisibleNodes||e.isExpanded();return{processSelf:(!n.onlyVisibleNodes||(n.treeDocument&&n.treeDocument._isNodeVisibleCache(e)||!n.treeDocument&&e.isVisible()))&&e!==i,processChildren:t}},o=function(e){let i;return void 0!==n.processNode&&(i=n.processNode.call(e,e._getNodeInfos())),t.push(e),{stopProcessing:!!i&&i.stopProcessing,processChildren:!i||i.shouldProcessDescendants}};d.processTreeIterative(this,{functionName:"getChildren"},o,e,n.treeTraversalOrder)}else s.forEach(o,function(e){"postOrder"===n.treeTraversalOrder&&e._getDescendantAndProcess(t,n),void 0!==n.processNode&&n.processNode.call(e,e._getNodeInfos()),"preOrder"===n.treeTraversalOrder&&e._getDescendantAndProcess(t,n)},50,n.onCompleteCB);return t},c.prototype.getAllDescendants=function(e){return this._getDescendantAndProcess(void 0,e)},c.prototype.collapseAll=function(){this.prepareUpdate(),this._modelEvents.publish({event:"preCollapseAll",data:this._getNodeInfos(),context:this}),this.options._isTrueRoot||this.collapse(),this.processDescendants({processNode:function(){this.collapse()}}),this._modelEvents.publish({event:"postCollapseAll",data:this._getNodeInfos(),context:this}),this.pushUpdate({updateType:WUXModelUpdateTypes.Expand})},c.prototype.matchSearch=function(){!0!==this._isMatchingSearch&&(this._isMatchingSearch=!0,this.prepareUpdate(),this._modelEvents.publish({event:"matchSearch",data:this._getNodeInfos(),context:this}),this.pushUpdate())},c.prototype.unmatchSearch=function(){!1!==this._isMatchingSearch&&(this._isMatchingSearch=!1,this.prepareUpdate(),this._modelEvents.publish({event:"unmatchSearch",data:this._getNodeInfos(),context:this}),this.pushUpdate())},c.prototype.isMatchingSearch=function(){return this._isMatchingSearch},c.prototype.collapse=function(e){this.hasNoRepresentation()||(void 0===e&&(e={notify:!0}),"noChildrenExpanded"===this.getState()?(this._expandState="noExpandStateExpand",this._isExpanded=!1):(this.getChildren()||"expanded"===this.getState())&&(this._expandState="expandState",this._isExpanded=!1),e.notify&&(this.prepareUpdate(),this._modelEvents.publish({event:"preCollapse",data:{nodeModel:this,virtualRowID:this._rowID},context:this}),this._modelEvents.publish({event:"collapse",data:{nodeModel:this,virtualRowID:this._rowID},context:this}),this._modelEvents.publish({event:"postCollapse",data:{nodeModel:this,virtualRowID:this._rowID},context:this}),this.pushUpdate({updateType:WUXModelUpdateTypes.Expand})))},c.prototype.search=function(t,n){var i={nodeModel:this};if(!(t=e.extend({match:function(e){},shouldStop:function(e){return!1},useTransaction:!0},t)).shouldStop(this)){if(t.useTransaction&&this.prepareUpdate(),void 0===n)n=[];else t.match(i)&&n.push(this);var o=this.getChildren();return o&&o.forEach(function(e){e.search(t,n)}),this._modelEvents.publish({event:"search",data:this._getNodeInfos(),context:this}),t.useTransaction&&this.pushUpdate(),n}},c.prototype.getNumberOfDescendants=function(e){void 0===e&&(e=0);var t=this.getChildren();if(t){for(var n=0;n<t.length;n++)void 0!==t[n].options.multipleNodesRep?e+=t[n].options.multipleNodesRep:e++;t.forEach(function(t){e=t.getNumberOfDescendants(e)})}return e},c.prototype.getNumberOfVisibleDescendants=function(e){void 0===e&&(e=0);var t=this.getVisibleChildren();if(t){for(var n=0;n<t.length;n++)void 0!==t[n].options.multipleNodesRep?e+=t[n].options.multipleNodesRep:t[n].hasRowID()&&e++;t.forEach(function(t){e=t.getNumberOfVisibleDescendants(e)})}return e},c.prototype.getTree=function(){if(this.options._isTrueRoot)return this.options.tree;var e=this.getRoot();return e?e._tree:void 0},c.prototype.getRoot=function(){for(var e=this;e&&!e.isRoot();)e=e.getParent();return e},c.prototype.getPath=function(){var e=[];return e.push(this),this._getAndProcessParents(function(t){e.push(t.nodeModel)}),e.reverse()},c.prototype.buildPath=function(t){return t=e.extend({path:"",buildPath:function(e,t,n){return e+t.options.label+"/"}},t),this.getPath().forEach(function(e,n){t.path=t.buildPath.call(e,t.path,e,n)}),t.path},c.prototype._getAndProcessParents=function(e){for(var t=this;t&&!t.isRoot();)(t=t.getParent())&&void 0!==e&&e.call(t,t._getNodeInfos()),0;return t},c.prototype._getTrueRoot=function(){var e=this;if(!this.__trueRoot){for(;e&&!e._isTrueRoot()&&!e.__trueRoot;)e=e.getParent();if(e)for(this.__trueRoot=e&&e.__trueRoot?e.__trueRoot:e,e=this.getParent();e&&!e._isTrueRoot()&&!e.__trueRoot;)e.__trueRoot=this.__trueRoot,e=e.getParent()}return this.__trueRoot},c.prototype.getTreeDocument=function(){var e=this._getTrueRoot();if(e)return e._treeDocument},c.prototype.reverseExpand=function(){for(var e=this;e&&!e.isRoot();)(e=e.getParent()).isExpanded()||e.expand()},c.prototype.getParents=function(e){for(var t=this,n=[];t;)!(t=t.getParent())||!e&&t.options._isTrueRoot||n.push(t);return n},c.prototype.getFirstVisibleParent=function(e){for(var t=this;t&&!t.isVisible();)t=t.getParent();return t},c.prototype.getBrothers=function(){var e=this.getParent(),t=this;if(e)return e.getChildren().filter(function(e){return e!==t})},c.prototype.getNextBrother=function(){var e=this.getParent();if(e){var t=e.getChildren();if(t){var n=t.indexOf(this);if(n>-1){if(n+1<t.length)return t[n+1];e.getNextBrother()}}}},c.prototype.getPreviousBrother=function(){var e=this.getParent();if(e){var t=e.getChildren();if(t){var n=t.indexOf(this);if(n>0)return t[n-1]}}},c.prototype._getLastVisibleNode=function(){if(!1===this.hasChildren()||!0===this.hasChildren()&&!1===this.isExpanded())return this;var e=this.getChildren();return e[e.length-1]._getLastVisibleNode()},c.prototype.getPreviousNode=function(){var e,t=this.getPreviousBrother();t?e=!1===t.hasChildren()||!0===t.hasChildren()&&!1===t.isExpanded()?t:t._getLastVisibleNode():e=this.getParent();if(!e._isTrueRoot())return e},c.prototype.getNextNode=function(e){if(this.hasChildren()&&!e)return this.getChildren()[0];var t=this.getNextBrother();if(t)return t;var n=this.getParent();return n?n.getNextNode(!0):void 0},c.prototype.getNextVisibleNode=function(){var e=this.getNextNode(this.hasChildren()&&!this.isExpanded());return e&&!1===e.isVisible()?e.getNextVisibleNode():e},c.prototype.getPreviousVisibleNode=function(){var e=this.getPreviousNode();return e&&!1===e.isVisible()?e.getPreviousVisibleNode():e},c.prototype._getPreviousBrothers=function(){var e=[],t=this.getParent();if(t)for(var n=t.getChildren(),i=n.indexOf(this),o=0;o<i;o++)e.push(n[o]);return e},c.prototype._computeRowID=function(){if(this.isVisible()&&this.hasRowID()){var e=0,t=function(t){t._getPreviousBrothers().filter(function(e){return e.isVisible()&&e.hasRowID()}).forEach(function(t){e=e+t.getNumberOfVisibleDescendants()+1,void 0!==t.options.multipleNodesRep&&(e=e+t.options.multipleNodesRep-1)})};t(this);var n=this.getParents(!0).filter(function(e){return(e.isVisible()||e._isTrueRoot())&&e.hasRowID()});if(n.length>1)for(var i=0;i<n.length;i++){var o=n[i];o.options._isTrueRoot||(e++,void 0!==o.options.multipleNodesRep&&(e=e+o.options.multipleNodesRep-1)),t(o)}return e}return null},c.prototype.hasChildren=function(){var e=this.getChildren();return!!(e&&e.length>0)},c.prototype.canBeExpandedAll=function(){if(this.canBeExpanded()){if(!this.hasChildren())return!0;for(var e=this.getChildren(),t=0;t<e.length;t++)if(e[t].canBeExpanded())return!0}return!1},c.prototype.canBeExpanded=function(){return"noChildren"!==this.getState()&&"noChildrenCollapsed"!==this.getState()&&"noChildrenExpanded"!==this.getState()},c.prototype.getParent=function(){return this._parentNode},c.prototype.isLastChild=function(){if(!this.getParent())return!1;for(var e=this.getParent().getChildren(),t=e.indexOf(this)+1;t<e.length;t++){var n=e[t];if(!1===n.isHidden()&&!1===n.isFiltered())return!1}return!0},c.prototype.getNthParent=function(e){for(var t=this,n=0;t&&n<e;)t=t.getParent(),n++;return t},c.prototype.getNodeDepth=function(){return null===this._nodeDepth&&void 0===this._nodeDepth&&(this._nodeDepth=this.getParents().length),this._nodeDepth},c.prototype.isRoot=function(){var e=this.getParent();return!(0!==this.getNodeDepth()||!e||!e._isTrueRoot())},c.prototype._isVisible=function(e){let t;if(e&&(t=e.get(this)),void 0===t){let e=this;for(t=!0;!0===t&&e&&(t=e._getSelfVisibility(),!e.isRoot());)(e=e.getParent())||(t=!1)}return e&&e.set(this,t),t},c.prototype._getSelfVisibility=function(){if(this.isHidden()||this.isFiltered())return!1;if(!this.isRoot()){var e=this.getParent();if(e&&!e.isExpanded())return!1}return!0},c.prototype._updateExpanderState=function(t){var n=this.getChildren();switch(e.typeOf(n)){case"string":this._expandState="asyncState",this._nodeIsAsync=!0;break;case"array":var i=!0;if(0===n.length){let e=!1;if(void 0!==this.options.useAsyncPreExpand)e=this.options.useAsyncPreExpand;else{const n=t&&t.treeDocument?t.treeDocument:this.getTreeDocument();n&&(e=n.options.useAsyncPreExpand)}e&&(i=!1)}else for(var o=0;o<n.length;o++)if(!1===n[o].isHidden()&&!1===n[o].isFiltered()){i=!1;break}i?this.isExpanded()?this._expandState="noExpandStateCollapse":this._expandState="noExpandStateExpand":this.isExpanded()?this._expandState="collapseState":this._expandState="expandState",this._nodeIsAsync=!1;break;default:this._expandState="noExpandState"}},c.prototype.getChildren=function(){return this.__children},c.prototype.getNumberOfChildren=function(){var e=this.getChildren();return e?e.length:0},c.prototype.getVisibleChildren=function(e){var t=this.getChildren();if(t instanceof Array&&t.length>0){if(e)return t.filter(function(e){return!e.isHidden()});{let e=this.getTreeDocument();return t.filter(function(t){return e?e._isNodeVisibleCache(t):t.isVisible()})}}},c.prototype.getNumberOfVisibleChildren=function(e){var t=0,n=this.getChildren();return n instanceof Array&&n.length>0&&(e?n.forEach(function(e){e.isHidden()||t++}):n.forEach(function(e){e.isVisible()&&t++})),t},c.prototype.getLabel=function(){return this.options.label},c.prototype.getIcons=function(){return this.options.icons},c.prototype.setIcons=function(e){this.updateOptions({icons:e})},c.prototype.setLabel=function(e){if(!this._referenceLabel&&this.getLabel()!==e){var t=this.getTreeDocument();!this._changeTransactionModeDisabled&&t&&t.getUseChangeTransactionMode()&&(this.setReferenceLabel(this.getLabel()),this._setChangeStates(WUXModelChangeStates.AttributesChanged,"add"))}this.updateOptions({label:e})},c.prototype.setBadges=function(t){if(null!==t){this.options.badges||(this.options.badges={});var n=e.extend(this.options.badges,t);this.updateOptions({badges:n})}else this.options.badges=null,this.updateOptions({badges:null})},c.prototype.getBadges=function(){return this.options.badges},c.prototype.hasBadges=function(){var e=this.getBadges();return!!e&&Object.keys(e).some(function(t){return e[t]})},c.prototype.sortChildren=function(t){if(t=e.extend({isRecursive:!1,sortFunction:function(e,t){return e.options.label<t.options.label?-1:1}},t),this.hasChildren()){this.prepareUpdate();var n=this.getChildren();if(n.sort(t.sortFunction),t.isRecursive)for(var i=0,o=n.length;i<o;i++)n[i].hasChildren()&&n[i].sortChildren(t);this._modelEvents.publish({event:"sortChildren",data:this._getNodeInfos(),context:this}),this.pushUpdate({updateType:WUXModelUpdateTypes.Sorting})}},f.prototype=Object.create(c.prototype),f.prototype.constructor=f,f.prototype._isFromOriginalModel=function(){return!1},c.prototype._isFromOriginalModel=function(){return!0},c.NODE_SOURCE={MODEL:0,GROUPING:1},c.prototype.getNodeSource=function(){return c.NODE_SOURCE.MODEL},f.prototype.getNodeSource=function(){return c.NODE_SOURCE.GROUPING},f.prototype._canBeGrouped=function(){return!1},c.prototype._canBeGrouped=function(){return!0},f.prototype.getIdentifier=function(){return this._options.identifier},f.prototype._getFakeNodesTable=function(){return this._options.fakeNodesTable},c.prototype._getFakeNodesTable=function(){return this._fakeNodesTable},f.prototype.getProperty=function(){return this._options.property},f.prototype.getOriginalChildrenInformation=function(){return Object.assign({},this._options.originalChildrenInformation)},f.prototype._setOriginalChildrenInformation=function(e){e.childrenCount===this._options.originalChildrenInformation.childrenCount&&e.notHiddenNotFilteredChildrenCount===this._options.originalChildrenInformation.notHiddenNotFilteredChildrenCount||(this._options.originalChildrenInformation=Object.assign({},e)),e.notHiddenNotFilteredChildrenCount>0?(this.isHidden()&&this.show(),this.isExpanded()||this.expand()):this.isHidden()||this.hide(),0===e.childrenCount&&this.remove()},c.prototype._addCallbacksForGrouping=function(){var e=this._getTrueRoot();if(!e.__groupingCallbackSet){e.__groupingCallbackSet=!0;var t=function(t){var n=t.data.nodeModel,i=n.getParent();if(n&&n._isFromOriginalModel()&&i&&!i._isFromOriginalModel()){e.prepareUpdate();var o=i.getOriginalChildrenInformation().notHiddenNotFilteredChildrenCount,r=i._updateOriginalChildrenInformation().notHiddenNotFilteredChildrenCount-o;(a=i.getParent())._isFromOriginalModel()&&i._updateGroupingNodeOptions(a._groupingOptions);for(var s=i.getParent();!s._isFromOriginalModel();s=s.getParent()){var a,d=s.getOriginalChildrenInformation();d.notHiddenNotFilteredChildrenCount+=r,s._setOriginalChildrenInformation(d),(a=s.getParent())._isFromOriginalModel()&&s._updateGroupingNodeOptions(a._groupingOptions)}e.pushUpdate({updateType:WUXModelUpdateTypes.Grouping})}};e.addEventListener("show",t),e.addEventListener("hide",t);var n=function(e){if(e._isFromOriginalModel()){var t=e.getChildren();t&&t.length>0&&!t[0]._isFromOriginalModel()&&t.forEach(function(t){t._updateOriginalChildrenInformation(),t._updateGroupingNodeOptions(e._groupingOptions)})}};e.addEventListener("filter",function(){n(e),e.processDescendants({processNode:function(e){n(e.nodeModel)}})})}},f.prototype._updateOriginalChildrenInformation=function(){var e=0,t=0,n=this.getChildren();if(n)for(var i=n.length;i>0;i--){var o=n[i-1],r=o._updateOriginalChildrenInformation();e+=r.childrenCount,t+=r.notHiddenNotFilteredChildrenCount,0===r.childrenCount&&delete this._getFakeNodesTable()[o.getIdentifier()]}return this._setOriginalChildrenInformation({childrenCount:e,notHiddenNotFilteredChildrenCount:t}),{childrenCount:e,notHiddenNotFilteredChildrenCount:t}},c.prototype._updateOriginalChildrenInformation=function(){return{childrenCount:1,notHiddenNotFilteredChildrenCount:this.isHidden()||this.isFiltered()?0:1}},f.prototype._updateGroupingNodeOptions=function(e){var t=this.getChildren(),n=[];if(t&&t.forEach(function(t){n=n.concat(t._updateGroupingNodeOptions(e))}),e.updateGroupingNodeOptions)e.updateGroupingNodeOptions.call(this,n);else{var i=this.getOriginalChildrenInformation();this.updateOptions({label:this.getProperty()+": "+this.getIdentifier()+" ("+i.notHiddenNotFilteredChildrenCount+")"})}return n},c.prototype._updateGroupingNodeOptions=function(e){return this},c.prototype._groupChild=function(e,t,n){if(n&&0!==n.length){var i;void 0!==(i=t.getNodeGroupingKey?t.getNodeGroupingKey(e,n[0]):e.getAttributeValue(n[0]))&&""!==i||(i="NA");var o=this._getFakeNodesTable(),r=o[i];r||(r=new f({property:n[0],identifier:i,fakeNodesTable:{},originalChildrenInformation:{childrenCount:0,notHiddenNotFilteredChildrenCount:0}}),o[i]=r,this.addChild(r)),r.isHidden()&&r.show(),n.shift(),r._groupChild(e,t,n)}else e.getParent()!==this&&this.moveChild(e)},f.prototype._groupChildren=function(e){},c.prototype._groupChildren=function(e){var t=this.getChildren();if(t)for(var n=0,i=0;i<t.length;){var o=t[i];if(o._isFromOriginalModel()){o.__initialIdxInParentChildren=n++;var r=e.propertiesToGroup.slice();this._groupChild(o,e,r)}else i++}},f.prototype.groupChildren=function(e){},c.prototype.groupChildren=function(e){this.prepareUpdate();var t=this.getTreeDocument(),n=t.getUseChangeTransactionMode();if(t.setUseChangeTransactionMode(!1),this.ungroupChildren(e&&e.propertiesToGroup),this._groupingOptions||(this._groupingOptions=e),e&&e.propertiesToGroup&&e.propertiesToGroup.length>0){this._fakeNodesTable||(this._fakeNodesTable={}),this._addCallbacksForGrouping(),this._groupChildren(e);var i=this.getChildren();i&&i.length>0&&!i[0]._isFromOriginalModel()&&i.forEach(function(t){t._updateOriginalChildrenInformation(),t._updateGroupingNodeOptions(e)})}this._modelEvents.publish({event:"groupChildren",data:this._getNodeInfos(),context:this}),t.setUseChangeTransactionMode(n),this.pushUpdate({updateType:WUXModelUpdateTypes.Grouping})},f.prototype._removeGrouping=function(e,t,n,i){var o=this.getChildren();if(o&&o.length>0){for(var r=i||!t||t.length<=n||t[n]!==this.getProperty(),s=o.length;s>0;s--){var a=o[s-1];a._removeGrouping(e,t,n+1,r)&&delete this._getFakeNodesTable()[a.getIdentifier()]}return r?this.remove(!0):this.hide(),r}},c.prototype._removeGrouping=function(e,t,n,i){return e!==this.getParent()&&e.moveChild(this),!1},f.prototype.ungroupChildren=function(e){},c.prototype.ungroupChildren=function(e){var t=this.getChildren();if(t&&0!==t.length&&this._getFakeNodesTable()){for(var n=t.length;n>0;n--){var i=t[n-1];if(!i._isFromOriginalModel())i._removeGrouping(this,e,0,!1)&&delete this._getFakeNodesTable()[i.getIdentifier()]}0===Object.keys(this._getFakeNodesTable()).length&&(this._fakeNodesTable=void 0,delete this._fakeNodesTable),t.sort(function(e,t){return void 0===e.__initialIdxInParentChildren?void 0===t.__initialIdxInParentChildren?0:1:void 0===t.__initialIdxInParentChildren?void 0===e.__initialIdxInParentChildren?0:-1:e.__initialIdxInParentChildren<t.__initialIdxInParentChildren?-1:1})}},c.prototype.getAttributeValue=function(e){return"label"===e?this.getLabel():this.options.grid[e]},c.prototype.isFiltered=function(){return void 0!==this.__filterCpt&&this.__filterCpt>0},f.prototype.canBeFiltered=function(){return!1},c.prototype.canBeFiltered=function(e){return!0},c.prototype.hasNoRepresentation=function(){return!1},c.prototype.hasRowID=function(){return!this.hasNoRepresentation()},c.prototype.incrementFilteredCount=function(){if(this.__filterCpt||(this.__filterCpt=0),this.__filterCpt++,1===this.__filterCpt){let e=this.getParent();e&&e._updateExpanderState()}this._rowID=null},c.prototype.decrementFilteredCount=function(){if(this.__filterCpt--,0===this.__filterCpt){let e=this.getParent();e&&e._updateExpanderState()}},c.prototype.getFilteredCount=function(){return void 0===this.__filterCpt&&(this.__filterCpt=0),this.__filterCpt},c.extendNode=function(t){var n=function(n){t.defaultOptions&&(this.defaultOptions=e.extend(e.clone(c.prototype.defaultOptions),t.defaultOptions)),void 0===this.defaultOptions&&(this.defaultOptions={}),this.options=e.extend(this.defaultOptions,n),c.call(this,n)};for(var i in(n.prototype=Object.create(this.prototype)).constructor=n,n.extendNode=this.extendNode,t){var o=t[i];"defaultOptions"!==i&&(n.prototype[i]="function"==typeof o?function(e,t,n){return function(){const i=this._parent;e.prototype[t]&&(this._parent=e.prototype[t]);const o=n.apply(this,arguments);return this._parent=i,o}}(c,i,o):o)}return n},c.prototype.selectAll=function(){var e=this.getTreeDocument();if(e){var t=this;this.withTransactionUpdate(function(){var n=[];t.processDescendants({processNode:function(t){e.options.shouldBeSelected.call(e,t.nodeModel)&&n.push(t.nodeModel)}}),e.getXSO().add(n)})}},c.prototype.areAllChildrenSelected=function(){var e=!0;if(this.hasChildren())for(var t=this.getChildren(),n=0;n<t.length&&e;n++)!1===t[n].isSelected()&&(e=!1);return e},c.prototype.areAllChildrenUnselected=function(){var e=!0;if(this.hasChildren())for(var t=this.getChildren(),n=0;n<t.length&&e;n++)!0===t[n].isSelected()&&(e=!1);return e},c.prototype.unselectAll=function(e){let t=e&&e.treeDocument?e.treeDocument:void 0;this.withTransactionUpdate(function(){this.processDescendants({processNode:function(t){t.nodeModel.unselect(e)},treeDocument:t})})},c.createTreeNodeDataModel=function(e,t){var n=new c,i=e.createDataModel(t);return n._setDataModel(i),n},c.prototype.getStructurePath=function(){return this.buildPath({buildPath:function(e,t,n){return e+t._getLocalID()+"/"}})},c.prototype.buildStringIdentifierArray=function(){var e=[],t=this.getParents(!0);if(t.length>1)for(var n=t.length-2;n>=0;n--){let i=t[n].stringIdentifier?t[n].stringIdentifier:t[n].options.label;e.push(i)}if(t.length>0){let t=this.stringIdentifier?this.stringIdentifier:this.options.label;e.push(t)}return e},c}),define("DS/TreeModel/ConditionBaseFilter",["DS/TreeModel/BaseFilter"],function(e){"use strict";return e.inherit({name:"conditionbasefilter",publishedProperties:{},isDataFiltered:function(e){var t=this.getAttributeValueForFiltering(e,this.propertyId),n=this.filterModel;if(!n||!n.condition1)return!1;const i=Object.keys(n).length-(void 0!==n.operator?1:0);for(let e=1;e<=i;e++){const i=n["condition"+e],o=this.isConditionMatched(i,t);if(!n.operator)return!o;if("and"===n.operator&&!o)return!0;if("or"===n.operator&&o)return!1}return n.operator&&"or"===n.operator},isEmpty:function(e,t){const n=void 0!==e?e:this.filterModel;return!n||!n.condition1||this.isConditionEmpty(n.condition1)},isConditionEmpty:function(e){return!0},isConditionMatched:function(e,t){return!1}})}),define("DS/TreeModel/StringRegExpFilter",["DS/TreeModel/ConditionBaseFilter","DS/Utilities/StringUtils"],function(e,t){"use strict";return e.inherit({name:"stringregexpfilter",publishedProperties:{},isConditionEmpty:function(e){return!e||"empty"!==e.type&&"notEmpty"!==e.type&&(void 0===e.filter||null===e.filter||""===e.filter)},isConditionMatched:function(e,n){if(!e||""===e.filter)return!0;if("empty"===e.type)return""===n||null==n;if("notEmpty"===e.type)return!(""===n||null==n);let i=void 0,o=e.filter;try{switch(e.type){case"contains":i=new RegExp(t.toComparable(o,{toLowerCase:!1}),"i");break;case"equal":i=new RegExp("^"+t.toComparable(o,{toLowerCase:!1})+"$","i");break;case"startsWith":i=new RegExp("^"+t.toComparable(o,{toLowerCase:!1}),"i");break;case"endsWith":i=new RegExp(t.toComparable(o,{toLowerCase:!1})+"$","i")}}catch(e){return!1}return!i||i.test(t.toComparable(n,{toLowerCase:!1}))}})}),define("DS/TreeModel/SetFilter",["DS/TreeModel/BaseFilter"],function(e){"use strict";var t=function(e,t){return!e.some(function(e){return UWA.equals(e,t)})};return e.inherit({name:"setfilter",publishedProperties:{},isDataFiltered:function(e){if(!this.filterModel)return!1;var n=this.getAttributeValueForFiltering(e,this.propertyId);return 0!==this.filterModel.length&&t.call(this,this.filterModel,n)},isEmpty:function(e,n){const i=void 0!==n?n:this.filterManager?this.filterManager.model:null;if(!i)return!0;const o=void 0!==e?e:this.filterModel;if(!o||0===o.length)return!0;var r=!1,s=this;return i.search({shouldStop:function(){return r},match:function(e){var n=s.getAttributeValueForFiltering(e.nodeModel,s.propertyId);t.call(s,o,n)&&(r=!0)},useTransaction:!1}),!r}})}),define("DS/TreeModel/StringStdExpFilter",["DS/TreeModel/StringRegExpFilter"],function(e){"use strict";return e.inherit({name:"stringstdexpfilter",publishedProperties:{},isConditionMatched:function(e,t){let n=Object.assign(e,{filter:e.filter.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")});return this._parent(n,t)}})}),define("DS/TreeModel/TreeNodeModelProxy",["DS/TreeModel/TreeNodeModel","DS/Utilities/Array"],function(e,t){"use strict";function n(t){e.call(this,t)}var i;function o(t){var i,o=this.getTreeDocument();if(o&&o.options&&(i=o.options.proxy),void 0!==i){i.options;var r=n[i.type];if(r){var s=r[t];if(s)return s.call(this)}}return e.prototype[t].call(this)}return n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.setCurrentContext=function(e){e&&(i=e.document)},n.prototype.isRoot=function(){return o.call(this,"isRoot")},n.prototype._isTrueRoot=function(){return function(t){var i,o=this.getTreeDocument();if(o&&o.options&&(i=o.options.proxy),void 0!==i){var r=i.options,s=n[i.type];if(s){var a=s[t];if(a)return a.call(this,r)}}return e.prototype[t].call(this)}.call(this,"_isTrueRoot")},n.prototype.getTreeDocument=function(){if(i)return i;if(this._treeDocument)return this._treeDocument;var e=this.getParent();return null!=e?e.getTreeDocument():void 0},n.prototype.addChild=function(t,n){var i;if(t instanceof Array)i=this._loadModel(t,this);else{if(t instanceof e){var o=t.getParent();o&&o.removeChild(t)}i=this._loadModel([t],this,n)}return i},n.prototype.getNodeDepth=function(){return o.call(this,"getNodeDepth")},n.prototype.getParents=function(e){for(var t=this,n=[];t;)!(t=t.getParent())||!e&&t._isTrueRoot()||n.push(t),t&&t._isTrueRoot()&&(t=void 0);return n},n.SUBSET={isRoot:function(){return this.getParent()._isTrueRoot()},_isTrueRoot:function(e){return this===e.target},getNodeDepth:function(){return this.getParents().length}},n.FLATTEN={getNodeDepth:function(){return 0},getChildren:function(){return this._isTrueRoot()?this.getAllDescendants():[]}},n}),define("DS/TreeModel/NumberWithConditionFilter",["DS/TreeModel/ConditionBaseFilter","DS/Utilities/StringUtils"],function(e,t){"use strict";return e.inherit({name:"numberWithConditionFilter",publishedProperties:{},isConditionEmpty:function(e){return!e||(Array.isArray(e.filter)&&"range"===e.type?void 0===e.filter[0]||void 0===e.filter[1]:"empty"!==e.type&&"notEmpty"!==e.type&&(void 0===e.filter||null===e.filter||""===e.filter))},isConditionMatched:function(e,t){if(this.isConditionEmpty(e))return!0;switch(e.type){case"range":return t>=e.filter[0]&&t<=e.filter[1];case"equal":return t===e.filter;case"notEqual":return t!==e.filter;case"lessThan":return t<e.filter;case"lessThanOrEqual":return t<=e.filter;case"greaterThan":return t>e.filter;case"greaterThanOrEqual":return t>=e.filter;case"empty":return""===t||null==t;case"notEmpty":return!(""===t||null==t);default:return!0}}})}),define("DS/TreeModel/StringFilter",["DS/TreeModel/ConditionAndSetBaseFilter"],function(e){"use strict";return e.inherit({name:"stringfilter",publishedProperties:{},getFilterByConditionId:function(){return"stringStdexp"}})}),define("DS/TreeModel/NumberFilter",["DS/TreeModel/ConditionAndSetBaseFilter"],function(e){"use strict";return e.inherit({name:"numberfilter",publishedProperties:{},getFilterByConditionId:function(){return"numberWithCondition"}})}),define("DS/TreeModel/FilterManager",["DS/Core/BaseComponent","DS/CoreEvents/ModelEvents","DS/TreeModel/SetFilter","DS/TreeModel/StringRegExpFilter","DS/TreeModel/StringStdExpFilter","DS/TreeModel/StringFilter","DS/TreeModel/NumberFilter","DS/TreeModel/NumberWithConditionFilter"],function(e,t,n,i,o,r,s,a){"use strict";var d=function(e,t,n){var i=0,o=this._listOfFilters[e];if(void 0!==o){if(o.filterId===t.filterId)return o.filterOptions=t.filterOptions,o.filterModel=t.filterModel,n&&n.isUserInteraction||(o.defaultFilterModel=t.filterModel),3;o.destroy(),this._listOfFilters[e]=void 0,delete this._listOfFilters[e],i=1}this.filterModel[e]=t;var r=this.FILTERS_MAP[t.filterId];return r?(this._listOfFilters[e]=new r({filterManager:this,propertyId:e,filterModel:t.filterModel,defaultFilterModel:t.filterModel,filterId:t.filterId,filterOptions:t.filterOptions}),1+i):(console.log("No filter has been registered for id ",t.filterId),0)};return e.inherit({name:"filtermanager",publishedProperties:{model:{defaultValue:void 0,type:"object",readOnly:!0},filterModel:{defaultValue:{},type:"object"}},registerFilter:function(e,t){this.FILTERS_MAP[e]=t},getFilterClassName:function(e){return this.FILTERS_MAP[e]},setPropertyFilterModel:function(e,t,n){0===d.call(this,e,t,n)&&(this.filterModel[e]=void 0,delete this.filterModel[e],this.publish("filterModelChange",{propertyId:e,filter:void 0}))},resetPropertyFilterModel:function(e){var t=this._listOfFilters[e];t&&t.reset()},reapplyPropertyFilterModel:function(e){var t=this._listOfFilters[e];void 0!==t&&t._applyFilterModel()},subscribe:function(e,t){return this._modelEvents.subscribe({event:e},t)},unsubscribe:function(e){return this._modelEvents.unsubscribe(e)},publish:function(e,t){0===this._preventPublishEvent&&this._modelEvents.publish({event:e,data:t,context:this})},isDataFiltered:function(e){for(var t in this._listOfFilters)if(this._listOfFilters[t].isDataFiltered(e))return!0;return!1},getFilters:function(){return this._listOfFilters},_build:function(){this.FILTERS_MAP={set:n,string:r,number:s,stringStdexp:o,stringRegexp:i,numberWithCondition:a},this._listOfFilters={},this._modelEvents=new t,this._preventPublishEvent=0},_applyFilterModel:function(e){var t=this,n=Object.keys(this._listOfFilters),i=Object.keys(this.filterModel);t._preventPublishEvent++,i.forEach(function(e){0===d.call(t,e,t.filterModel[e])&&(t.filterModel[e]=void 0,delete t.filterModel[e]);var i=n.indexOf(e);-1!==i&&n.splice(i,1)}),n.forEach(function(e){t._listOfFilters[e].destroy(),delete t._listOfFilters[e]}),t._preventPublishEvent--,this.publish("filterModelChange")},_applyProperties:function(e){this._parent(e),this.isDirty("filterModel")&&this._applyFilterModel(e.filterModel)}})}),define("DS/TreeModel/DataSourceBase",["DS/Core/BaseComponent","DS/TreeModel/ModelUtils","DS/CoreEvents/ModelEvents","DS/TreeModel/FilterManager"],function(e,t,n,i){"use strict";return e.inherit({name:"DataSourceBase",publishedProperties:{},numberOfRowsPerRequest:100,rowsOffsetToTriggerRequest:20,_modelEvents:new n,getModelItems:function(e){},getCurrentFindResult:function(e){},pushUpdatesNotifications:function(e,t){this._modelEvents.publish({event:"pushUpdatesNotifications",data:{dataToUpdateArray:e,callback:t}})},convertPushUpdatesNotificationsWithContext:function(e,t){return e},setFilterModel:function(e){this._filterManager&&UWA.equals(this._filterManager.filterModel,e)||(this._filterManager?this._filterManager.filterModel=e:this._createFilterManager(e))},getFilterManager:function(){return this._filterManager||this._createFilterManager(),this._filterManager},reapplyFilterModel:function(){if(this._filterManager){var e=this._filterManager.filterModel;this._filterManager.filterModel={},this._filterManager.filterModel=e}},_createFilterManager:function(e){this._filterManager||(this._filterManager=new i({model:this,filterModel:e||{}}))},_applyProperties:function(){}})}),define("DS/TreeModel/TreeDocument",["UWA/Core","UWA/Class","DS/Core/Core","DS/TreeModel/TreeNodeModel","DS/Selection/XSO","DS/CoreEvents/ModelEvents","DS/Utilities/Array","DS/Utilities/Data","DS/TreeModel/FilterManager","DS/TreeModel/ModelUtils"],function(e,t,n,i,o,r,s,a,d,l){"use strict";return t.extend({defaultOptions:{dataModelSet:null,useAsyncPreExpand:!1,shouldBeSelected:function(e){return!0},shouldBeEditable:function(e){return!0},shouldAcceptDrag:function(e){return!0},shouldAcceptDrop:function(e){return!0},insert:function(e,t,n){this.withTransactionUpdate(function(){t.insertBefore(e,n)},this)},nodeModelClass:i},init:function(t){this._parent(t),this._isExpandingCounter=0,this.options=e.extend(e.clone(this.defaultOptions),t),this._modelEvents=new r;var n=function(e,t){return e._getID()===t._getID()},i=function(e){return e._getID()};this._xso=new o({getElementID:i,useUniqueID:!0,areEquals:n}),this._pxso=new o({getElementID:i,useUniqueID:!0,areEquals:n}),this._listeners=[],this._XSOEventListeners=[],this._PXSOEventListeners=[],this._numberOfNodesInDocument=0,this._useChangeTransactionMode=!1,this._pendingChangesCount=0,this._createTrueRoot(),!0===this.options.useAsyncPreExpand&&this.onPreExpand(function(e){e.target.preExpandDone()})},getModelEvents:function(){return this._trueRoot?this._trueRoot._modelEvents:null},_bindEventOnDocument:function(e,t){this._listeners.push(this._trueRoot._modelEvents.subscribe({event:e},t))},_bindEventOnXSO:function(e,t){this._XSOEventListeners.push(this.getXSO()[e](t))},_bindEventOnPXSO:function(e,t){this._PXSOEventListeners.push(this.getPXSO()[e](t))},_isNodeVisibleCache:function(e){this.__visibilityMap__||(this.__visibilityMap__=new Map);var t=this.__visibilityMap__.get(e);return void 0===t&&(t=e._isVisible(this.__visibilityMap__)),t},_cleanVisibilityCache:function(){this.__visibilityMap__=void 0},_cleanBindings:function(){var e=this;this._listeners.forEach(function(t){e._trueRoot._modelEvents.unsubscribe(t)}),this._listeners=[];var t=this.getXSO();this._XSOEventListeners.forEach(function(e){t.unsubscribe(e)}),this._XSOEventListeners=[];var n=this.getPXSO();this._PXSOEventListeners.forEach(function(e){n.unsubscribe(e)}),this._PXSOEventListeners=[]},destroy:function(){this._getTrueRoot()&&(this._getTrueRoot()._modelEvents.publish({event:"preDestroyDocument"}),this._cleanBindings(),this._getTrueRoot()._treeDocument=null,this._getTrueRoot().destroy()),this._trueRoot=null,this._xso=null,this._pxso=null},isInTransaction:function(){return this._updateCnt>0},_observeEvents:function(e){var t=this;function n(e){t._isExpandingCounter--,0===t._isExpandingCounter&&t._requireRowsIndexing()}this._cleanBindings(),this._updateCnt=0,this._bindEventOnDocument("active",function(e){t._activeNode&&t._activeNode.inactive(),t._activeNode=e.target}),this._bindEventOnDocument("addChild",function(e){t._requireRowsIndexing(),t._numberOfNodesInDocument++}),this._bindEventOnDocument("removeChild",function(e){t._requireRowsIndexing(),t._numberOfNodesInDocument--}),this._bindEventOnDocument("removeChildren",function(e){var n=e.data,i=n?n.length:0;t._requireRowsIndexing(),t._numberOfNodesInDocument-=i}),this._bindEventOnDocument("hide",function(e){t._requireRowsIndexing()}),this._bindEventOnDocument("show",function(e){t._requireRowsIndexing()}),this._bindEventOnDocument("preRemoveChild",function(e){var n=e.data.nodeModel;n.__keepSelection||(n.unselect({treeDocument:t}),n.unselectAll({treeDocument:t}))}),this._bindEventOnDocument("preRemoveChildren",function(e){for(var n=e.data,i=0;i<n;i++){var o=n[i];o.__keepSelection||(o.unselect({treeDocument:t}),o.unselectAll({treeDocument:t}))}}),this._bindEventOnDocument("preExpandAll",function(e){t._isExpandingCounter++}),this._bindEventOnDocument("documentPreExpandAll",function(e){t._isExpandingCounter++}),this._bindEventOnDocument("preExpandPrivate",function(e){t._isExpandingCounter++}),this._bindEventOnDocument("postExpandAll",n),this._bindEventOnDocument("documentPostExpandAll",n),this._bindEventOnDocument("postExpandPrivate",n),this._bindEventOnDocument("postCollapse",function(){t._requireRowsIndexing()}),this._bindEventOnDocument("postCollapseAll",function(){t._requireRowsIndexing()}),this._bindEventOnDocument("sortChildren",function(){t._requireRowsIndexing()}),this._bindEventOnDocument("filter",function(){t._requireRowsIndexing()}),this._bindEventOnDocument("prepareUpdate",function(){t._updateCnt++}),this._bindEventOnDocument("pushUpdatePrivate",function(e){t._updateCnt<=0?console.warn("A call has been made on pushUpdate without a previous call to prepareUpdate"):(t._updatePendingType||(t._updatePendingType=0),e.options&&e.options.updateType&&(t._updatePendingType=t._updatePendingType|e.options.updateType)),t._updateCnt-1==0&&(t._updatePendingType&WUXModelUpdateTypes.Expand&&e.data&&e.data.nodeModel&&!1===e.data.nodeModel.isExpanded()&&!0===e.data.nodeModel.hasChildren()&&(e.data.nodeModel.processDescendants({treeDocument:this,onlyVisibleNodes:!1,processNode:function(e){e&&e.nodeModel&&(e.nodeModel._rowID=null)}}),t._requireRowsIndexing()),!0===t.__requireRowsIndexing&&t._indexRowIndexes())}),this._bindEventOnDocument("pushUpdate",function(e){(t._updateCnt--,t._updateCnt<0&&console.warn("A call has been made on pushUpdate without a previous call to prepareUpdate"),0===t._updateCnt)&&(!0===t.__requireRowsIndexing&&t._indexRowIndexes(),t._getTrueRoot()._modelEvents.publish({event:"modelUpdate",context:t,options:{updateType:t._updatePendingType},data:e.data}),t._updatePendingType=0)});var i=function(e,n){t.prepareUpdate(),e.forEach(function(e){e._isSelected=n,e._modelEvents.publish({event:n?"select":"unselect",data:e._getNodeInfos(),context:e}),e.isSelectionChangeFromUI()&&e.selectionChangeIsNotFromUI()}),t.pushUpdate({updateType:WUXModelUpdateTypes.Selection})};this._bindEventOnXSO("onPostAdd",function(e){i(e,!0)}),this._bindEventOnXSO("onPostRemove",function(e){i(e,!1)});var o=function(e,t){e.forEach(function(e){e._isPreSelected=t,e._modelEvents.publish({event:t?"preselect":"unpreselect",data:e._getNodeInfos(),context:e})})};this._bindEventOnPXSO("onPostAdd",function(e){o(e,!0)}),this._bindEventOnPXSO("onPreRemove",function(e){o(e,!1)}),this._bindEventOnPXSO("onPostRemove",function(e){o(e,!1)}),this._bindEventOnXSO("onPreEmpty",function(e){t.prepareUpdate(),e.forEach(function(e){e._isSelected=!1})}),this._bindEventOnXSO("onEmpty",function(e){t.pushUpdate({updateType:WUXModelUpdateTypes.Selection})})},_requireRowsIndexing:function(){this.__requireRowsIndexing=!0,this._cleanVisibilityCache()},_indexRowIndexes:function(){var e=-1;this.processDescendants({onlyVisibleNodes:!0,processNode:function(t){var n=t.nodeModel;n.hasRowID()&&(void 0!==n.options.multipleNodesRep?e+=n.options.multipleNodesRep:e++,n._rowID=e)}}),this.__requireRowsIndexing=!1},getXSO:function(){return this._xso},getPXSO:function(){return this._pxso},_createTrueRoot:function(e){if(void 0===e){var t=this.options.nodeModelClass||i;this._trueRoot=new t({_isTrueRoot:!0,label:"",useAsyncPreExpand:this.options.useAsyncPreExpand})}else this._trueRoot=e,this._trueRoot.options.label="trueroot",this._trueRoot.options._isTrueRoot=!0,this._trueRoot.options.useAsyncPreExpand=e.options.useAsyncPreExpand,this._trueRoot._rowID=-1;this._trueRoot._treeDocument=this,this.getModelEvents()._addParent(this._modelEvents),this._observeEvents()},usesAsyncDndCallbacks:function(){return!1},_shouldAcceptDrop:function(e){return this.options.shouldAcceptDrop.call(e.target,e.target._getNodeInfos())},subscribe:function(e,t){return this.getModelEvents().subscribe(e,t)},unsubscribe:function(e){return this.getModelEvents().unsubscribe(e)},addEventListener:function(e,t){return this.getModelEvents().addEventListener(e,t)},removeEventListener:function(e){this.getModelEvents().unsubscribe(e)},addModelEventListener:function(e,t){return this.getModelEvents().addEventListener(e,t)},loadModel:function(e,t,n){return void 0===t&&(t=this._trueRoot),this._trueRoot._treeDocument=this,this._trueRoot._loadModel(e,t,n)},_getTrueRoot:function(){return this._trueRoot},_getRealTrueRoot:function(){return this._trueRoot},addRoot:function(e,t){return this._getTrueRoot().addChild(e,t,{treeDocument:this})},addChild:function(e,t){return this._getTrueRoot().addChild(e,t,{treeDocument:this})},insertBefore:function(e,t){return this._getTrueRoot().insertBefore(e,t)},removeRoot:function(e){return this._getTrueRoot().removeChild(e)},removeRoots:function(){var e=[],t=this;return this.withTransactionUpdate(function(){for(var n=t.getRoots(),i=n.length-1;i>=0;i--)e.unshift(n[i]),n[i].remove()}),this.getModelEvents().publish({event:"documentRemoveRoots",data:e}),e},expandNLevels:function(e){var t=this._getTrueRoot().getChildren();t&&(this.prepareUpdate(),s.optimizedForEach(t,function(t,n){t.expandNLevels(e)}),this.pushUpdate({updateType:WUXModelUpdateTypes.Expand}))},expandAll:function(){var e=this._getTrueRoot(),t=e.getChildren();if(t){this.prepareUpdate(),e._modelEvents.publish({event:"documentPreExpandAll",data:e._getNodeInfos(),context:e});var n=0,i=e._endOfSubExpand;e._endOfSubExpand=function(o){i.call(e,o),0===this.__expandAllCounter&&++n===t.length&&e._modelEvents.publish({event:"documentPostExpandAll",data:e._getNodeInfos(),context:e})};let o=this;s.optimizedForEach(t,function(t,n){t._privateExpand({expandAll:!0,treeDocument:o},void 0,e)}),this.pushUpdate({updateType:WUXModelUpdateTypes.Expand})}},collapseAll:function(){var e=this._getTrueRoot(),t=this._getTrueRoot().getChildren();t&&(this.prepareUpdate(),e._modelEvents.publish({event:"documentPreCollapseAll",data:e._getNodeInfos(),context:e}),s.optimizedForEach(t,function(e,t){e.collapseAll()}),e._modelEvents.publish({event:"documentPostCollapseAll",data:e._getNodeInfos(),context:e}),this.pushUpdate({updateType:WUXModelUpdateTypes.Expand}))},getAllDescendants:function(e){var t=this._getTrueRoot();if(t)return t.getAllDescendants(e)},_dump:function(e){return this._getTrueRoot()._dump(e)},dump:function(e){return this._dump(e)},getNthRoot:function(e){if(this._getTrueRoot().getChildren())return this._getTrueRoot().getChildren()[e]},getRoots:function(){return this.getChildren()},buildPath:function(e){return this._getTrueRoot().buildPath(e)},getChildren:function(){return this._getTrueRoot().getChildren()||[]},computeNodeFromLabels:function(e){if(!e||0===e.length)return null;var t=[],n=this._getTrueRoot();return e.find(function(e){var i=n.getChildren();return!i||!(n=i.find(function(t){return t.getLabel()===e}))||(t.push(n),!1)}),t.length>0?t[t.length-1]:null},prepareUpdate:function(){const e=this._getRealTrueRoot();if(e)return e.prepareUpdate()},pushUpdate:function(e){const t=this._getRealTrueRoot();if(t)return t.pushUpdate(e)},withTransactionUpdate:function(e){return this._getRealTrueRoot().withTransactionUpdate(e)},executeWithoutEvents:function(e){if(e){let t=this.getModelEvents();t.disableEvents(),e.call(this),t.enableEvents()}},getSelectedNodes:function(){return this._xso.get()},processSelectedNodes:function(t){t=e.extend({processNode:function(e){},onComplete:function(){}},t),this.prepareUpdate();var n=this;a.forEach(this.getXSO().get(),function(e){void 0!==t.processNode&&t.processNode.call(e,e._getNodeInfos())},50,function(){t.onComplete(),n.pushUpdate()})},processDescendants:function(e){e||(e={}),e.treeDocument=this,this._getTrueRoot().processDescendants(e)},getNumberOfVisibleDescendants:function(){var e=0;return this.processDescendants({onlyVisibleNodes:!0,processNode:function(){e++}}),e},selectAll:function(){this._getTrueRoot().selectAll()},unselectAll:function(){this.getXSO().empty()},isEveryNodeSelected:function(){return this.getXSO().get().length&&this._numberOfNodesInDocument===this.getXSO().get().length},isExpanding:function(){return this._isExpandingCounter>0},empty:function(){this._getTrueRoot().empty(),this._numberOfNodesInDocument=0},setUseChangeTransactionMode:function(e){this._useChangeTransactionMode=e},getUseChangeTransactionMode:function(){return this._useChangeTransactionMode},cancelChanges:function(){var e=this;this.withTransactionUpdate(function(){e._getTrueRoot().cancelChanges(!0)}),this._managePendingChanges("reset")},acceptChanges:function(){var e=this;this.withTransactionUpdate(function(){return e._getTrueRoot().acceptChanges(!0)}),this._managePendingChanges("reset")},hasPendingChanges:function(){return this._pendingChangesCount>0},_managePendingChanges:function(e){var t=this._pendingChangesCount;this._pendingChangesCount="reset"!==e?this._pendingChangesCount+("add"===e?1:-1):0,(0===t&&0!==this._pendingChangesCount||0!==t&&0===this._pendingChangesCount)&&this._getTrueRoot()._modelEvents.publish({event:"pendingStateChange"})},resetToReferenceValues:function(){var e=this;this.withTransactionUpdate(function(){e.processDescendants({treeTraversalOrder:"postOrder",processNode:function(e){e.nodeModel.resetToReferenceValues()}})})},setValuesAsReference:function(){var e=this;this.withTransactionUpdate(function(){e.processDescendants({treeTraversalOrder:"postOrder",processNode:function(e){e.nodeModel.setValuesAsReference()}})})},onNodeModelUpdate:function(e){return this.getModelEvents().subscribe({event:"nodeModelUpdate"},e)},onPreExpand:function(e){return this.getModelEvents().unsubscribeAll({event:"preExpand"}),this.getModelEvents().subscribe({event:"preExpand"},e)},onUpdate:function(e){return this.getModelEvents().subscribe({event:"modelUpdate"},e)},onPreExpandAll:function(e){return this.getModelEvents().subscribe({event:"preExpandAll"},e)},onPostExpand:function(e){return this.getModelEvents().subscribe({event:"postExpand"},e)},onPreCollapse:function(e){return this.getModelEvents().subscribe({event:"preCollapse"},e)},onPostCollapse:function(e){return this.getModelEvents().subscribe({event:"postCollapse"},e)},search:function(e){return this._getTrueRoot().search(e)},groupRoots:function(e){this._getTrueRoot().groupChildren(e)},ungroupRoots:function(){this._getTrueRoot().ungroupChildren()},_createFilterManager:function(e){if(!this._filterManager){this._filterManager=new d({model:this,filterModel:e||{}});let t=this,n=this._getTrueRoot();this._filterManager.subscribe("filterModelChange",function(e){t.processDescendants({processNode(e){e&&e.nodeModel&&e.nodeModel._updateExpanderState()}}),n._modelEvents.publish({event:"filter",data:n._getNodeInfos(),context:n})}),n._modelEvents.publish({event:"filter",data:n._getNodeInfos(),context:n})}},setFilterModel:function(t){this._filterManager&&e.equals(this._filterManager.filterModel,t)||(this.prepareUpdate(),this._filterManager?this._filterManager.filterModel=t:this._createFilterManager(t),this.pushUpdate({updateType:WUXModelUpdateTypes.Filtering}))},reapplyFilterModel:function(){if(this._filterManager){this.prepareUpdate();var e=this._filterManager.filterModel;this._filterManager.filterModel={},this._filterManager.filterModel=e,this.pushUpdate({updateType:WUXModelUpdateTypes.Filtering})}},getFilterManager:function(){return this._filterManager||this._createFilterManager(),this._filterManager},flattenTreeDocument:function(e){var t=[],n=this,i=!1,o=0;return setTimeout(function(){var r=function(e,t){return void 0===t&&(t=[]),(e.isVisible()||e._isTrueRoot())&&(e._isTrueRoot()||t.push(e),e.hasChildren()&&e.getChildren().forEach(function(e){r(e,t)})),t},s=function(){0===o&&(i&&(t.length=0,r(n._getTrueRoot(),t),i=!1),e&&e.onUpdate&&e.onUpdate({flattenedTreeDocument:t}))};i=!0,s(),n.addEventListener("prepareUpdate",function(){o++,s()}),n.addEventListener("pushUpdate",function(){o>0&&(o--,s())}),["addChild","removeChild","hide","show","expand","collapse"].forEach(function(e){n.addEventListener(e,function(){i=!0,s()})})}),t},getNodeFromStructurePath:function(e){var t=this._getTrueRoot(),n=e.split("/");return n.pop(),n.forEach(function(e,n){t=t.getChildren()[e]}),t},getNodesFromIdentifierStringArray:function(e){var t={};if(!e)return t;t.nbNotFoundItems=e.length,t.nodeModelArray=[];var n=this._getTrueRoot();for(const i of e){let e=n.getChildren();if(!e)return t;let o=!1;for(const r of e){if((r.stringIdentifier?r.stringIdentifier:r.options.label)===i){o=!0,t.nbNotFoundItems--,t.nodeModelArray.push(r),n=r;break}}if(!o)return t}return t}})}),define("DS/TreeModel/TreeDocumentProxy",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModelProxy"],function(e,t){"use strict";var n=e.extend({defaultOptions:{proxy:void 0,nodeModelClass:t,baseDocument:void 0},init:function(e){this._parent(e),e&&e.baseDocument&&this._createTrueRoot(e.baseDocument._trueRoot)},_getTrueRoot:function(){if(void 0!==this.options.proxy){var t=this.options.proxy,i=t.options,o=t.type,r=n[o];if(r&&r._getTrueRoot)return r._getTrueRoot.call(this,i)}return e.prototype._getTrueRoot.call(this)}});return n.SUBSET={_getTrueRoot:function(e){return e.target}},n});