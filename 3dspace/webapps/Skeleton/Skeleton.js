var __extends=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("DS/Skeleton/SkeletonLayout",["require","exports","DS/Controls/Abstract","UWA/Core","DS/Core/WebUXComponents","DS/Windows/DockingElement","DS/Utilities/Dom","DS/Utilities/Utils","DS/Utilities/WUXUWAUtils"],function(e,t,n,i,o,a,l,s,r){"use strict";var h=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=e.apply(this,t)||this;return r.extendingClassFlag,i}return __extends(t,e),t.prototype.init=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._mediumViewportLimit=800,this._smallViewportLimit=400,this._skeletonPrefKey="wux-skeleton-layout",this._leftContainerCollapsedState=!0,this._rightContainerCollapsedState=!0,this._avoidLoop=!1,this._latestViewportSize="wide",e.prototype.init.apply(this,t)},Object.defineProperty(t,"publishedProperties",{get:function(){return{leftContainerContent:{defaultValue:null,type:"object"},rightContainerContent:{defaultValue:null,type:"object"},navigationContainerContent:{defaultValue:null,type:"object"},navigationContainerHeight:{defaultValue:void 0,type:"integer"},centerContainerContent:{defaultValue:null,type:"object"},statusContainerContent:{defaultValue:null,type:"object"},statusContainerHeight:{defaultValue:void 0,type:"integer"},idCardContainerContent:{defaultValue:null,type:"object"},idCardContainerHeight:{defaultValue:void 0,type:"integer"},leftContainerCollapsedFlag:{defaultValue:!0,type:"boolean"},rightContainerCollapsedFlag:{defaultValue:!0,type:"boolean"},leftContainerWidth:{defaultValue:480,type:"integer"},rightContainerWidth:{defaultValue:480,type:"integer"},leftContainerMinWidth:{defaultValue:20,type:"integer"},leftContainerMaxWidth:{defaultValue:screen.width,type:"integer"},rightContainerMinWidth:{defaultValue:20,type:"integer"},rightContainerMaxWidth:{defaultValue:screen.width,type:"integer"},navigationContainerVisibleFlag:{defaultValue:!0,type:"boolean"},idCardContainerVisibleFlag:{defaultValue:!0,type:"boolean"},statusContainerVisibleFlag:{defaultValue:!0,type:"boolean"},identifier:{defaultValue:"",type:"string",readOnly:!0,category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){e.prototype.buildView.call(this),this._buildLayout()},t.prototype._buildLayout=function(){this.elements.container.addClassName("wux-layouts-skeleton"),this.elements.statusSiblingContainer=new i.Element("div",{class:"wux-skeleton-status-sibling-container"}).inject(this.elements.container),this.elements.parentLeftContainer=new i.Element("div",{class:"wux-skeleton-parent-left-container"}),this.elements.leftContainer=new i.Element("div",{class:"wux-skeleton-left-container"}),this.elements.leftDockingElement=new a({side:WUXDockAreaEnum.LeftDockArea,dockingZoneContent:this.elements.parentLeftContainer,dockingZoneSize:this.leftContainerWidth,minSize:this.leftContainerMinWidth,maxSize:this.leftContainerMaxWidth,collapsibleFlag:!0,visibleCollapserFlag:!1,collapseDockingZoneFlag:this.leftContainerCollapsedFlag}),this.elements.leftDockingElement.inject(this.elements.statusSiblingContainer),this.elements.parentRightContainer=new i.Element("div",{class:"wux-skeleton-parent-right-container"}),this.elements.rightContainer=new i.Element("div",{class:"wux-skeleton-right-container"}),this.elements.rightDockingElement=new a({side:WUXDockAreaEnum.RightDockArea,dockingZoneContent:this.elements.parentRightContainer,dockingZoneSize:this.rightContainerWidth,minSize:this.rightContainerMinWidth,maxSize:this.rightContainerMaxWidth,collapsibleFlag:!0,visibleCollapserFlag:!1,collapseDockingZoneFlag:this.rightContainerCollapsedFlag}),this.elements.leftDockingElement.freeZoneContent=this.elements.rightDockingElement.getContent(),this.elements.centralContainer=new i.Element("div",{class:"wux-skeleton-central-container"}),this.elements.navigationContainer=new i.Element("div",{class:"wux-skeleton-navigation-container"}).inject(this.elements.centralContainer),this.elements.idCardContainer=new i.Element("div",{class:"wux-skeleton-id-container"}).inject(this.elements.centralContainer),this.elements.centerContentContainer=new i.Element("div",{class:"wux-skeleton-center-content-container"}).inject(this.elements.centralContainer),this.elements.rightDockingElement.freeZoneContent=this.elements.centralContainer,this.elements.statusContainer=new i.Element("div",{class:"wux-skeleton-status-container"}).inject(this.elements.container),this.elements.leftContainer.inject(this.elements.parentLeftContainer),this.elements.rightContainer.inject(this.elements.parentRightContainer)},t.prototype._postBuildView=function(){if(""!==this.identifier){var e=s.getDataFromLocalPreferences(this,this._skeletonPrefKey,"left_docking_element_collapsed_flag"),t=s.getDataFromLocalPreferences(this,this._skeletonPrefKey,"right_docking_element_collapsed_flag"),n=s.getDataFromLocalPreferences(this,this._skeletonPrefKey,"left_docking_element_width"),i=s.getDataFromLocalPreferences(this,this._skeletonPrefKey,"right_docking_element_width");e&&(this.leftContainerCollapsedFlag=e,this._leftContainerCollapsedState=e),t&&(this.rightContainerCollapsedFlag=t,this._rightContainerCollapsedState=t),n&&(this.leftContainerWidth=n),i&&(this.rightContainerWidth=i)}},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("leftContainerContent")&&this._applyLeftContainerContent(t.leftContainerContent),this.isDirty("rightContainerContent")&&this._applyRightContainerContent(t.rightContainerContent),this.isDirty("navigationContainerContent")&&this._applyNavigationContainerContent(t.navigationContainerContent),this.isDirty("centerContainerContent")&&this._applyCenterContainerContent(t.centerContainerContent),this.isDirty("statusContainerContent")&&this._applyStatusContainerContent(t.statusContainerContent),this.isDirty("centerContainerContent")&&this._applyCenterContainerContent(t.centerContainerContent),this.isDirty("idCardContainerContent")&&this._applyIdCardContainerContent(t.idCardContainerContent),this.isDirty("navigationContainerHeight")&&this._applyNavigationContainerHeight(t.navigationContainerHeight),this.isDirty("statusContainerHeight")&&this._applyStatusContainerHeight(t.statusContainerHeight),this.isDirty("idCardContainerHeight")&&this._applyIdCardContainerHeight(t.idCardContainerHeight),this.isDirty("leftContainerCollapsedFlag")&&this._applyLeftContainerCollapsedFlag(t.leftContainerCollapsedFlag),this.isDirty("rightContainerCollapsedFlag")&&this._applyRightContainerCollapsedFlag(t.rightContainerCollapsedFlag),this.isDirty("leftContainerWidth")&&this._applyLeftContainerWidth(t.leftContainerWidth),this.isDirty("rightContainerWidth")&&this._applyRightContainerWidth(t.rightContainerWidth),this.isDirty("leftContainerMinWidth")&&this._applyLeftContainerMinWidth(t.leftContainerMinWidth),this.isDirty("leftContainerMaxWidth")&&this._applyLeftContainerMaxWidth(t.leftContainerMaxWidth),this.isDirty("rightContainerMinWidth")&&this._applyRightContainerMinWidth(t.rightContainerMinWidth),this.isDirty("rightContainerMaxWidth")&&this._applyRightContainerMaxWidth(t.rightContainerMaxWidth),this.isDirty("navigationContainerVisibleFlag")&&this._applyNavigationContainerVisibleFlag(t.navigationContainerVisibleFlag),this.isDirty("idCardContainerVisibleFlag")&&this._applyIdCardContainerVisibleFlag(t.idCardContainerVisibleFlag),this.isDirty("statusContainerVisibleFlag")&&this._applyStatusContainerVisibleFlag(t.statusContainerVisibleFlag)},t.prototype._handleEvents=function(){l.addResizeObserver(this,this.elements.container,this._onSkeletonResize);var e=this;l.addEventOnElement(this,this.elements.container,"dimensionsChanged",function(){e._updateCenterContentContainerHeight(),e._updateStatusSiblingContainerHeight()}),l.addEventOnElement(this,this.elements.leftDockingElement,"collapse",function(t){t.stopPropagation(),e.fire("leftContainerCollapse")}),l.addEventOnElement(this,this.elements.leftDockingElement,"expand",function(t){t.stopPropagation(),e.fire("leftContainerExpand")}),l.addEventOnElement(this,this.elements.leftDockingElement,"dockResize",function(t){t.stopPropagation(),e.elements.leftDockingElement.elements.container.removeClassName("wux-windows-docking-element-resizing");var n=e.elements.leftDockingElement.elements.dockingZone.offsetWidth;e._saveDockingElementWidthInPreferences("left",n),e.leftContainerWidth=n,e.fire("leftContainerResized")}),l.addEventOnElement(this,this.elements.leftDockingElement,"dockIsResizing",function(t){t.stopPropagation(),e.elements.leftDockingElement.elements.container.addClassName("wux-windows-docking-element-resizing"),e._managePanelsStacking("left"),e.fire("leftContainerIsResizing")}),l.addEventOnElement(this,this.elements.rightDockingElement,"collapse",function(t){t.stopPropagation(),e.fire("rightContainerCollapse")}),l.addEventOnElement(this,this.elements.rightDockingElement,"expand",function(t){t.stopPropagation(),e.fire("rightContainerExpand")}),l.addEventOnElement(this,this.elements.rightDockingElement,"dockResize",function(t){t.stopPropagation();var n=e.elements.rightDockingElement.elements.dockingZone.offsetWidth;e._saveDockingElementWidthInPreferences("right",n),e.rightContainerWidth=n,e.fire("rightContainerResized")}),l.addEventOnElement(this,this.elements.rightDockingElement,"dockIsResizing",function(t){t.stopPropagation(),e._managePanelsStacking("right"),e.fire("rightContainerIsResizing")})},t.prototype._setContentOnElement=function(e,t,n){e&&e.remove(),t&&(i.is(t,"element")&&(t=new i.extendElement(t)),n.appendChild(t))},t.prototype._applyLeftContainerContent=function(e){this._setContentOnElement(e,this.leftContainerContent,this.elements.leftContainer)},t.prototype._applyRightContainerContent=function(e){this._setContentOnElement(e,this.rightContainerContent,this.elements.rightContainer)},t.prototype._applyNavigationContainerContent=function(e){this._setContentOnElement(e,this.navigationContainerContent,this.elements.navigationContainer)},t.prototype._applyCenterContainerContent=function(e){this._setContentOnElement(e,this.centerContainerContent,this.elements.centerContentContainer)},t.prototype._applyStatusContainerContent=function(e){this._setContentOnElement(e,this.statusContainerContent,this.elements.statusContainer)},t.prototype._applyIdCardContainerContent=function(e){this._setContentOnElement(e,this.idCardContainerContent,this.elements.idCardContainer)},t.prototype._applyNavigationContainerHeight=function(e){this.navigationContainerHeight?this.elements.navigationContainer.style.height=this.navigationContainerHeight+"px":this.elements.navigationContainer.style.height="auto",this._updateCenterContentContainerHeight()},t.prototype._applyStatusContainerHeight=function(e){this.statusContainerHeight?this.elements.statusContainer.style.height=this.statusContainerHeight+"px":this.elements.statusContainer.style.height="auto",this._updateStatusSiblingContainerHeight()},t.prototype._applyIdCardContainerHeight=function(e){this.idCardContainerHeight?this.elements.idCardContainer.style.height=this.idCardContainerHeight+"px":this.elements.idCardContainer.style.height="auto",this._updateCenterContentContainerHeight()},t.prototype._collapseBothDockingElements=function(){!1===this.leftContainerCollapsedFlag&&(this._properties.leftContainerCollapsedFlag.value=!0,this.elements.leftDockingElement.collapseDockingZoneFlag=this.leftContainerCollapsedFlag,this._leftContainerCollapsedState=!1),!1===this.rightContainerCollapsedFlag&&(this._properties.rightContainerCollapsedFlag.value=!0,this.elements.rightDockingElement.collapseDockingZoneFlag=this.rightContainerCollapsedFlag,this._rightContainerCollapsedState=!1),this._updateDockingElementForViewportSize("both")},t.prototype._updateDockingElementForViewportSize=function(e){var t=this.elements.container.offsetWidth;if(t&&t<=this._smallViewportLimit){for(var n=e?"left"===e?["right"]:"right"===e?["left"]:["left","right"]:[],i=0;i<n.length;i++){var o=n[i];!1!==this.leftContainerCollapsedFlag||!1!==this.rightContainerCollapsedFlag||this._avoidLoop||(this._avoidLoop=!0,this[o+"ContainerCollapsedFlag"]=!0,this["_"+o+"CollapsedState"]=!1)}this.leftContainerCollapsedFlag||(this.elements.leftDockingElement.maxSize=void 0,this.elements.leftDockingElement.dockingZoneSize="100%",this.elements.leftDockingElement.resizableFlag=!1),this.rightContainerCollapsedFlag||(this.elements.rightDockingElement.maxSize=void 0,this.elements.rightDockingElement.dockingZoneSize="100%",this.elements.rightDockingElement.resizableFlag=!1)}else this.elements.leftDockingElement.dockingZoneSize=this.leftContainerWidth,this.elements.rightDockingElement.dockingZoneSize=this.rightContainerWidth;this._avoidLoop&&(this._avoidLoop=!1)},t.prototype._applyLeftContainerCollapsedFlag=function(e){this.elements.leftDockingElement.collapseDockingZoneFlag=this.leftContainerCollapsedFlag,this._updateDockingElementForViewportSize("left"),this._leftContainerCollapsedState=this.leftContainerCollapsedFlag},t.prototype._updateCenterContentContainerHeight=function(){var e=this.idCardContainerVisibleFlag?this.idCardContainerHeight?this.idCardContainerHeight:this.elements.idCardContainer.offsetHeight:0,t=this.navigationContainerVisibleFlag?this.navigationContainerHeight:0,n=e?t?e+t:e:t;this.elements.centerContentContainer.style.height=n?"calc(100% - ("+n+"px)":"100%"},t.prototype._updateStatusSiblingContainerHeight=function(){var e=this.statusContainerVisibleFlag?this.statusContainerHeight:0;this.elements.statusSiblingContainer.style.height=e?"calc(100% - ("+e+"px)":"100%"},t.prototype._applyRightContainerCollapsedFlag=function(e){this.elements.rightDockingElement.collapseDockingZoneFlag=this.rightContainerCollapsedFlag,this._updateDockingElementForViewportSize("right"),this._rightContainerCollapsedState=this.rightContainerCollapsedFlag},t.prototype._applyLeftContainerWidth=function(e){this._updateDockingElementForViewportSize()},t.prototype._applyLeftContainerMinWidth=function(e){this.elements.leftDockingElement.minSize=this.leftContainerMinWidth},t.prototype._applyLeftContainerMaxWidth=function(e){this.elements.leftDockingElement.maxSize=this.leftContainerMaxWidth},t.prototype._applyRightContainerWidth=function(e){this._updateDockingElementForViewportSize()},t.prototype._applyRightContainerMinWidth=function(e){this.elements.rightDockingElement.minSize=this.rightContainerMinWidth},t.prototype._applyRightContainerMaxWidth=function(e){this.elements.rightDockingElement.maxSize=this.rightContainerMaxWidth},t.prototype._applyNavigationContainerVisibleFlag=function(e){this.navigationContainerVisibleFlag?this.elements.navigationContainer.removeClassName("wux-skeleton-layout-hidden"):this.elements.navigationContainer.addClassName("wux-skeleton-layout-hidden"),this._updateCenterContentContainerHeight()},t.prototype._applyIdCardContainerVisibleFlag=function(e){this.idCardContainerVisibleFlag?this.elements.idCardContainer.removeClassName("wux-skeleton-layout-hidden"):this.elements.idCardContainer.addClassName("wux-skeleton-layout-hidden"),this._updateCenterContentContainerHeight()},t.prototype._applyStatusContainerVisibleFlag=function(e){this.statusContainerVisibleFlag?this.elements.statusContainer.removeClassName("wux-skeleton-layout-hidden"):this.elements.statusContainer.addClassName("wux-skeleton-layout-hidden"),this._updateStatusSiblingContainerHeight()},t.prototype._onSkeletonResize=function(){this.elements.container.offsetWidth<=this._mediumViewportLimit&&this.elements.container.offsetWidth>this._smallViewportLimit?(this.elements.leftDockingElement.overlayDockingZoneFlag=!0,this.elements.rightDockingElement.overlayDockingZoneFlag=!1,this.elements.rightDockingElement.dockingZoneSize=this.rightContainerWidth,this._rightContainerCollapsedState||(this.rightContainerCollapsedFlag=!1),!1===this._leftContainerCollapsedState&&!1===this._rightContainerCollapsedState?(this.leftContainerCollapsedFlag=!0,this._leftContainerCollapsedState=!1):this._leftContainerCollapsedState||(this.leftContainerCollapsedFlag=!1),this.elements.leftDockingElement.resizableFlag=!0,this.elements.rightDockingElement.resizableFlag=!0,this._latestViewportSize="medium"):this.elements.container.offsetWidth<=this._smallViewportLimit?(this.elements.leftDockingElement.overlayDockingZoneFlag=!0,this.elements.rightDockingElement.overlayDockingZoneFlag=!0,"small"!==this._latestViewportSize&&this._collapseBothDockingElements(),this.elements.leftDockingElement.dockingZoneSize="100%",this.elements.rightDockingElement.dockingZoneSize="100%",this._latestViewportSize="small"):(this.elements.leftDockingElement.overlayDockingZoneFlag=!1,this.elements.rightDockingElement.overlayDockingZoneFlag=!1,this._leftContainerCollapsedState||(this.leftContainerCollapsedFlag=!1,this._leftContainerCollapsedState=!1),this._rightContainerCollapsedState||(this.rightContainerCollapsedFlag=!1,this._rightContainerCollapsedState=!1),this.elements.leftDockingElement.resizableFlag=!0,this.elements.rightDockingElement.resizableFlag=!0,this._latestViewportSize="wide"),this._managePanelsStacking("right");var e={leftPanelCollapseFlag:this.leftContainerCollapsedFlag,rightPanelCollapseFlag:this.rightContainerCollapsedFlag,leftPanelOverlayFlag:this.elements.leftDockingElement.overlayDockingZoneFlag,rightPanelOverlayFlag:this.elements.rightDockingElement.overlayDockingZoneFlag,newSkeletonDimensions:{width:this.elements.container.offsetWidth,height:this.elements.container.offsetHeight}};this.fire("skeletonResized",e)},t.prototype._managePanelsStacking=function(e){if(!this.leftContainerCollapsedFlag&&!this.rightContainerCollapsedFlag){var t=this.elements.leftDockingElement.elements.dockingZone.offsetWidth+this.elements.rightDockingElement.elements.dockingZone.offsetWidth+20;if("right"===e){var n=s.getDataFromLocalPreferences(this,this._skeletonPrefKey,"left_docking_element_width");n||(n=this.leftContainerWidth),t>=this.elements.container.offsetWidth?(this.elements.leftDockingElement.maxSize=this.elements.container.offsetWidth-(this.elements.rightDockingElement.elements.dockingZone.offsetWidth+20),this.elements.leftDockingElement.dockingZoneSize=this.elements.leftDockingElement.maxSize):this.elements.leftDockingElement.maxSize<this.leftContainerMaxWidth?(this.elements.leftDockingElement.maxSize=this.elements.container.offsetWidth-(this.elements.rightDockingElement.elements.dockingZone.offsetWidth+20),this.elements.leftDockingElement.dockingZoneSize=n<this.elements.leftDockingElement.maxSize?n:this.elements.leftDockingElement.maxSize):(this.elements.leftDockingElement.maxSize=this.leftContainerMaxWidth,this.elements.leftDockingElement.dockingZoneSize=n<this.elements.leftDockingElement.maxSize?n:this.elements.leftDockingElement.maxSize)}else if("left"===e){var i=s.getDataFromLocalPreferences(this,this._skeletonPrefKey,"right_docking_element_width");i||(i=this.rightContainerWidth),t>=this.elements.container.offsetWidth?(this.elements.rightDockingElement.maxSize=this.elements.container.offsetWidth-(this.elements.leftDockingElement.elements.dockingZone.offsetWidth+20),this.elements.rightDockingElement.dockingZoneSize=this.elements.rightDockingElement.maxSize):this.elements.rightDockingElement.maxSize<this.rightContainerMaxWidth?(this.elements.rightDockingElement.maxSize=this.elements.container.offsetWidth-(this.elements.leftDockingElement.elements.dockingZone.offsetWidth+20),this.elements.rightDockingElement.dockingZoneSize=i<this.elements.rightDockingElement.maxSize?i:this.elements.rightDockingElement.maxSize):(this.elements.rightDockingElement.maxSize=this.rightContainerMaxWidth,this.elements.rightDockingElement.dockingZoneSize=i<this.elements.rightDockingElement.maxSize?i:this.elements.rightDockingElement.maxSize)}}},t.prototype._saveDockingElementWidthInPreferences=function(e,t){""!==this.identifier&&s.saveDataInLocalPreferences(this,this._skeletonPrefKey,"left"===e?"left_docking_element_width":"right_docking_element_width",t)},t.prototype.setCollapseFlagFromUIInteraction=function(e,t){"left"===e?(this.leftContainerCollapsedFlag=t,""!==this.identifier&&s.saveDataInLocalPreferences(this,this._skeletonPrefKey,"left_docking_element_collapsed_flag",t)):"right"===e&&(this.rightContainerCollapsedFlag=t,""!==this.identifier&&s.saveDataInLocalPreferences(this,this._skeletonPrefKey,"right_docking_element_collapsed_flag",t))},t.prototype.destroy=function(){l.removeResizeObserver(this,this.elements.container,this._onSkeletonResize),e.prototype.destroy.call(this)},t}(n);return o.addClass(h,"skeletonLayout"),h});