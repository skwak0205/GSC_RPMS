define("DS/OptimizationPanel/KPIsettings/ConfigList",["DS/OptimizationPanel/KPIsettings/ConfigComponent","DS/CoreEvents/ModelEvents","css!DS/OptimizationPanel/KPIsettings/PanelKPI.css"],function(t,e){"use strict";var i=function(t){this._parentModelEvents=t&&t.modelEvents?t.modelEvents:"other",this._id=t&&t.id?t.id:"other",this._myModelEvents=new e,this._myModelEvents.id=t.id,this._meExt=t&&t.meExt?t.meExt:"other ext channel",this._init(t)};return i.prototype._init=function(t){this._configList=t&&t.modelC0.tabId[this._id].configList?t.modelC0.tabId[this._id].configList:[],this._initDom(t)},i.prototype._initDom=function(e){if(this._content=document.createElement("div"),this._content.classList.add("config-list"),this._subscribeEvents(e),0===this._configList.length)e.modelC0.tabId[this._id].configList=[];else for(var i=0;i<this._configList.length;i++)this._config[i]=new t({name:e.modelC0.defConfig[this._configList[i]].name,modelEvents:this._parentModelEvents,current:this._configList[i]===e.modelC0.current,myME:this._myModelEvents,id:this._configList[i],modelC0:e.modelC0}),this._config[i].inject(this._content),this._activeConfig=e.modelC0.current},i.prototype._subscribeEvents=function(e){this._listSubscription=[],this._listSubscription2=[],this._config=[];var i=this;i._listSubscription.push(i._parentModelEvents.subscribe({event:"optimkpipresenter-create-config"},function(n){var s,o=document.querySelectorAll(".config-content"),c=[];if(o.length){for(var l=0;l<o.length;l++)c[l]=parseInt(o[l].id.substring(6,8));s=Math.max.apply(null,c),s+=1}else s=0;if(n.id===i._myModelEvents.id){var r="config"+(n.config+""+s).substring(14,16);i._config[s]=new t({name:n.config+""+s,modelEvents:i._parentModelEvents,current:!0,myME:i._myModelEvents,id:r,modelC0:e.modelC0}),i._config[s].inject(i._content);var d=i._content.querySelector("#"+r);e.modelC0.tabId[i._id].configList.push(r),e.modelC0.defConfig[r]={id:r,name:d.firstChild.lastChild.innerHTML,definition:n.def},i._parentModelEvents.publish({event:"config-created",data:e.modelC0.defConfig[r]})}})),i._listSubscription.push(i._parentModelEvents.subscribe({event:"config-current-change"},function(t){"zeroActive"!==t?(e.modelC0.current=t,i._activeConfig=t,i._meExt.publish({event:"current-config-active",data:i._activeConfig})):(i._activeConfig=null,i._meExt.publish({event:"current-config-active",data:i._activeConfig}))})),i._listSubscription2.push(i._myModelEvents.subscribe({event:"delete-config"},function(t){var n=i._content.querySelector("#"+t);i._content.removeChild(n),i._parentModelEvents.publish({event:"delete-config",data:t}),delete e.modelC0.defConfig[t];for(var s=0;s<e.modelC0.tabId[i._id].configList.length;s++)e.modelC0.tabId[i._id].configList[s]===t&&e.modelC0.tabId[i._id].configList.splice(s,1);"true"===n.lastChild.firstChild.getAttribute("checked")&&(i._activeConfig=null,i._meExt.publish({event:"current-config-active",data:i._activeConfig}),e.modelC0.current=null)})),i._listSubscription.push(i._parentModelEvents.subscribe({event:"config-name-change"},function(t){i._meExt.publish({event:"config-name-change",data:t})}))},i.prototype.inject=function(t){t.appendChild(this._content)},i.prototype.destroy=function(){var t=0;for(this._length=this._listSubscription.length,t=0;t<this._length;t++)this._parentModelEvents.unsubscribe(this._listSubscription[t]);for(this._length2=this._listSubscription2.length,t=0;t<this._length2;t++)this._myModelEvents.unsubscribe(this._listSubscription2[t]);for(this._length3=this._content.children.length,t=0;t<this._length3;t++)for(var e=0;e<this._config.length;e++)void 0!==this._config[e]&&this._config[e].destroy();this._content=null},i});