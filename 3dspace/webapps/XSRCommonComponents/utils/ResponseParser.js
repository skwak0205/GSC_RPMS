define("DS/XSRCommonComponents/utils/ResponseParser",["UWA/Core"],function(e){return{attributesParser:function(e,r){if(!Array.isArray(e))throw new Error("Ouups ! invalid input");for(var s={},t=e,a=0;a<t.length;a++){var i=t[a],n=i.name;switch(i.format&&"ds6w_facet"===i.format&&(n=i.name.split("/").pop()),r&&n.startsWith("ds6w")&&Array.isArray(r.classes)&&r.properties&&(-1===r.classes.indexOf(n)&&r.classes.push(n),Array.isArray(r.withNlsProp)&&-1!==r.withNlsProp.indexOf(n)&&(r.properties[n]||(r.properties[n]=[]),-1===r.properties[n].indexOf(i.value)&&r.properties[n].push(i.value))),n){case"resourceid":s.resourceid=i.value,s.physicalid=i.value;break;case"type_icon_url":s.icons||(s.icons=[]),s.icons.push(i.value);break;case"preview_url":case"thumbnail_2d":s.thumbnail=i.value;break;case"ds6w:type":s["ds6w:type_value"]=i.value;break;case"ds6w:status":s["ds6w:status_value"]=i.value;break;case"ds6wg:PLMReference.V_isLastVersion":s.isLastVersion="boolean"==typeof i.value?i.value:"TRUE"===i.value.toUpperCase(),s["ds6wg:PLMReference.V_isLastVersion"]=s.isLastVersion;break;case"bo.PLMReference.v_versionid":s.versionid=i.value;break;default:s[n]=i.value}}return s},parseFetchResult:function(e,r){var s=e.results||[],t=[],a=this,i=null;return r&&(i={withNlsProp:r,classes:[],properties:{}}),s.forEach(function(e){0===e.attributes.length||e.sort&&"#DELETE#"===e.sort.sortType?t.push({deleted:!0}):t.push(a.attributesParser(e.attributes,i))}),{results:t,nlsTracker:i}},cleanExpandParsedData:function(e){if(e){if(e.root=void 0,e.nodes){for(var r in e.nodes)e.nodes.hasOwnProperty(r)&&(e.nodes[r]=void 0);e.nodes=void 0}if(e.iconsSet&&(e.iconsSet=void 0),Array.isArray(e.paths)){for(var s=0;s<e.paths.length;s++)e.paths[s]=void 0;e.paths=void 0}e=void 0}},parseAndBuildIRPCStructure:function(e,r){var s=this.parseExpandResult(e,r);if(!s||!s.nodes||!Array.isArray(s.paths))throw new Error("Ouups ! invalid input");s.iconsSet=s.iconsSet||[];for(var t=0;t<s.iconsSet.length;t++)for(var a=s.iconsSet[t],i=0;i<a.did.length;i++){var n=a.did[i],o=s.nodes[n];o.icons&&Array.isArray(o.icons)||(o.icons=[]),o.icons.push(a.icon),o.thumbnail||(o.thumbnail=a.thumbnail_2d)}return s.paths.forEach(function(e){var r=e.length;if(1===Math.abs(r%2))for(var t=0;t<e.length;t++){var a=s.nodes[e[t]],i=t+1<r?s.nodes[e[t+1]]:null;if(0===Math.abs(t%2)){if(a.children||(a.children=[]),i){for(var n=!1,o=0;o<a.children.length;o++)if(a.children[o].did===i.did){n=!0;break}n||a.children.push(i)}}else i&&(a.instanceOf=i)}else console.error("incomplete path")}),s.root=s.paths.length>=1&&s.paths[0].length>=1?s.nodes[s.paths[0][0]]:null,s},parseExpandResult:function(r,s){if(!r||!Array.isArray(r.results))throw new Error("Ouups ! invalid input");var t={nodes:{},root:null,paths:[],nlsTracker:{withNlsProp:s,classes:[],properties:{}},iconsSet:[]},a=this;return r.results.forEach(function(r){if(r.hasOwnProperty("attributes")){var s=a.attributesParser(r.attributes,t.nlsTracker);e.is(s.did)&&(t.nodes[s.did]=s)}else r.hasOwnProperty("path")?t.paths.push(r.path):r.hasOwnProperty("icon__default_thumbnail_2d")&&(t.iconsSet=r.icon__default_thumbnail_2d)}),t}}});