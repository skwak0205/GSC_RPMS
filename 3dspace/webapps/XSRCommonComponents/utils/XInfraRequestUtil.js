define("DS/XSRCommonComponents/utils/XInfraRequestUtil",["UWA/Class/Model","UWA/Promise","DS/XSRCommonComponents/utils/RequestUtil","DS/XSRCommonComponents/utils/TypeUtils","DS/XSRCommonComponents/utils/TypeServicesUtil","DS/XSRCommonComponents/utils/Constants"],function(e,t,s,r,n,i){"use strict";return e.extend({setup:function(e){this.id=e.id,this.xInfraAppVersion="v1",this.corpus="dsspec"},urlForInvoke:function(){return"resources/"+this.xInfraAppVersion+"/modeler/"+this.corpus+"/"+this.uriType+"/"+this.corpus+":"+this.id},urlForClasses:function(){return"resources/"+this.xInfraAppVersion+"/modeler/"+this.corpus+"/"+this.corpus+":"+this.id},urlForGet:function(e){var t=r.getKeyMapping(e);return"resources/"+this.xInfraAppVersion+"/modeler/"+this.corpus+"/"+this.corpus+":"+t+"/"+this.id},urlForGetSubTypes:function(e){if(this.id="getRawMaterialSubTypes")return i.RM_BASE_URL+"Raw_Material/getRawMaterialSubTypes";var t=r.getKeyMapping(e);return"resources/"+this.xInfraAppVersion+"/modeler/"+this.corpus+"/"+this.corpus+":"+t+"/"+this.id},urlForUpdate:function(e){var t=r.getKeyMapping(e);return"resources/"+this.xInfraAppVersion+"/modeler/"+this.corpus+"/"+this.corpus+":"+t+"/"+this.id},invoke:function(e){var r;this.uriType="invoke",r=e&&e.data?JSON.stringify(e.data):'{"dummy" : "dummy"}';var n=e&&e.mask?this.urlForInvoke()+"?$mask="+this.corpus+":"+e.mask:this.urlForInvoke();return new t(function(e,t){s.send3DSpaceRequest(n,"POST",{type:"json",headers:{"Content-type":"application/json"},data:r},function(t){var s=t;t&&"string"==typeof t&&(s=JSON.parse(t),e(s)),e(s)},t)})},create:function(e){this.uriType="classes";var r=e&&e.data?JSON.stringify(e.data):"",n=e&&e.mask?this.urlForClasses()+"?$mask="+this.corpus+":"+e.mask:this.urlForClasses();return new t(function(e,t){s.send3DSpaceRequest(n,"POST",{type:"json",headers:{"Content-type":"application/json"},data:r},function(t){var s=t;t&&"string"==typeof t&&(s=JSON.parse(t),e(s)),e(s)},t)})},get:function(e){this.uriType="resources";e&&e.typeName&&e.typeName;return this.keyMappingForGetUpdate(e).then(r=>{var n=e&&e.mask?r+"?$mask="+this.corpus+":"+e.mask:r;return new t(function(e,t){s.send3DSpaceRequest(n,"GET",{type:"json",headers:{"Content-type":"application/json"}},e,t)})})},getSubtypes:function(e){var r=e&&e.typeName?e.typeName:"",n=this.urlForGetSubTypes(r);return new t(function(e,t){s.send3DSpaceRequest(n,"GET",{type:"json",headers:{"Content-type":"application/json"}},e,t)})},update:function(e){this.uriType="resources";var r=e&&e.data?JSON.stringify(e.data):"",n=e&&e.typeActualName?e.typeActualName:e.typeName,i=e&&e.mask?this.urlForUpdate(n)+"?$mask="+this.corpus+":"+e.mask:this.urlForUpdate(n);return new t(function(e,t){s.send3DSpaceRequest(i,"PATCH",{type:"json",headers:{"Content-type":"application/json"},data:r},e,t)})},keyMappingForGetUpdate:function(e){var s=this;return new t((t,i)=>{var o=r.getKeyMapping(e.typeActual||e.typeName),a="resources/"+s.xInfraAppVersion+"/modeler/"+s.corpus+"/"+s.corpus+":"+o+"/"+s.id;"notfound"==o?(console.log(e.typeActual),(new n).isValidItemToOpen(e.typeActual||e.typeName).then(n=>{if(n.isValidType){var i={objectType:e.typeActual,displayType:e.typeName};n.isRawM?r.addToRawMaterial([i]):r.addToPhysicalProduct([i]),a="resources/"+s.xInfraAppVersion+"/modeler/"+s.corpus+"/"+s.corpus+":PhysicalProduct/"+s.id,t(a)}})):t(a)})}})});