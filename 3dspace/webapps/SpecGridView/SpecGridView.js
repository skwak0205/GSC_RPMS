define("DS/SpecGridView/SpecGridView",["UWA/Core","UWA/Class","DS/SpecGridView/model/GridTreeDocument","DS/SpecGridView/controller/TileViewManager","DS/SpecGridView/controller/GridViewManager","DS/XSRCommonComponents/utils/Constants","DS/SpecGridView/controller/GridCollectionToolBar","i18n!DS/SpecGridView/assets/nls/SpecGridView","css!DS/SpecGridView/SpecGridView.css"],function(e,t,i,r,s,n,a,o){"use strict";return t.extend({init:function(t){this._parentView=t,this.itemId=t.itemId,this.container=t.container,this.enableCrossWidgetFeature=t.enableCrossWidgetFeature,this.appCore=t.appCore,this.modelEvents=t.appCore.specViewerModelEvents,this.basicModelEvents=t.appCore.basicModelEvents,this.currentTabKey=t.currentTabKey,this.dvgOpts=t.dvgOpts,this.parentModel=t.parentModel,this.enableInteractiveRightPanel=t.enableInteractiveRightPanel,this.preferredView=widget.getValue("grid-preferred-view-"+this.currentTabKey)||t.preferredView,this.toolbarContainer=e.createElement("div",{id:"multigrid-toolbar"}).inject(this.container),this.statusBarInfo=t.statusIconForTileView;var n=t.isColorized,o={appCore:this.appCore,preferredView:this.preferredView,currentTabKey:this.currentTabKey,container:this.container};this.toolbar=new a(o),this.multigrid=e.createElement("div",{id:"multigrid"}).inject(this.container),this.emptyMsg(),this.subscribeEvents();var d={modelEvents:this.modelEvents,enableCrossWidgetFeature:this.enableCrossWidgetFeature,currentTabKey:this.currentTabKey,isColorized:n,appCore:this.appCore,enableRightInteractivity:this.enableInteractiveRightPanel,parentModel:t.parentModel};this.gridTreeDocument=new i(d),this.model=this.gridTreeDocument.getTreeDocuments(),this.appCore.specRouteManager&&this.appCore.specRouteManager.setCurrentTreeDocument(this.model),this.tileManager=new r({container:this.multigrid,itemId:this.itemId,appCore:this.appCore,model:this.model,currentTabKey:this.currentTabKey}),this.tileManager.setStatusBarInfo(this.statusBarInfo),this.gridManager=new s({container:this.multigrid,itemId:this.itemId,appCore:this.appCore,model:this.model,currentTabKey:this.currentTabKey,dvgOpts:this.dvgOpts,parentModel:this.parentModel})},drawTileView:function(){this.gridManager&&this.gridManager.hide(),this.tileManager?this.tileManager.show():(this.tileManager=new r({container:this.multigrid,itemId:this.itemId,appCore:this.appCore,model:this.model,columns:this.cols,currentTabKey:this.currentTabKey}),this.tileManager.setStatusBarInfo(this.statusBarInfo),this.tileManager.drawGrid())},drawGridView:function(){this.tileManager&&this.tileManager.hide(),this.gridManager?this.gridManager.show():(this.gridManager=new s({container:this.multigrid,itemId:this.itemId,appCore:this.appCore,model:this.model,columns:this.cols,currentTabKey:this.currentTabKey,dvgOpts:this.dvgOpts}),this.gridManager.drawGrid())},unGroupRoots:function(){this.gridTreeDocument&&(this.gridTreeDocument.unGroupRoots(),this.removeGroupingTable(),this.getTreeDocument().acceptChanges())},subscribeEvents:function(){this.subs=[]},switchView:function(e){n.GRID_VIEW===e?(this.toolbar.enableCommands(["personalize","Wraptext","Unwraptext","ResetChanges"]),this.currentView=n.GRID_VIEW,this.drawGridView()):n.BIG_TILE===e&&(this.toolbar.disableCommands(["personalize","Wraptext","Unwraptext","ResetChanges"]),this.currentView=n.BIG_TILE,this.drawTileView(),this.currentTabKey===n.BOM_TAB&&this.model.collapseAll(),this.model&&this.model.getOriginalGridRoots().length<=0&&this._showEmptyView())},switchMadeFromItem:function(e){this.toolbar.disableCommands(["personalize","Wraptext","Unwraptext","ResetChanges"])},setToolBarActions:function(e){var t=e.actions;t=this.updateToolbarCmdsStatus(t),this.toolbar.setActions(t),this.toolbar.setCurrentModel(this.model),this.toolbar.draw(this.toolbarContainer),this.isTileViewRendered&&this.toolbar.disableCommands(["personalize","Wraptext","Unwraptext","ResetChanges"])},getGridNodes:function(){return this.model.getOriginalGridRoots()},getGridNodeCount:function(){return this.model.getOriginalGridRoots().length},setColumns:function(e){return this.cols=e,this.gridManager?this.gridManager.setColumns(e):""},hideColumns:function(e,t){for(let i=0;i<e.length;i++)t.indexOf(e[i].dataIndex)>-1&&(e[i].visibleFlag=!1)},addColumn:function(e,t){if(this.gridManager){var i=this.gridManager.columns.find(function(t){return t.dataIndex===e.dataIndex});this.gridManager.addColumn(e,t,i)}},removeColumns:function(e){var t=this;t.gridManager&&e.forEach(function(e){var i=t.gridManager.columns.find(function(t){return t.dataIndex===e});t.gridManager.removeColumn(e,i)})},addChildColumns:function(e,t){this.gridManager&&this.gridManager.addChildColumns(e,t)},getGridViewInstance:function(){return this.gridView},render:function(e){var t=!this.preferredView||this.preferredView!==n.BIG_TILE;this.isTileViewRendered=!t,this.gridManager&&(this.gridManager.drawGrid(e,!t),this.gridManager.grid&&(this.gridView=this.gridManager.grid)),this.tileManager&&this.tileManager.drawGrid(e,t),this.currentView=t?n.GRID_VIEW:n.BIG_TILE},highlightCell:function(e,t){this.gridManager&&this.gridManager.highlightCell(e,t)},setColumnVisibilityFlag:function(e,t){var i=this;e.forEach(function(e){i.gridManager.setColumnVisibilityFlag(e,t)})},addRootNodes:function(e,t){e&&(this.gridTreeDocument.addRoot(e,!1),this.model.getOriginalGridRoots().length>0&&this._hideEmptyView())},addTagger:function(){this.appCore.specTagsFilter&&(this.appCore.specTagsFilter.setWorkingContainer(this.container),this.appCore.specTagsFilter.addItemsToTagger(this.getTreeDocument().getOriginalGridRoots()))},updateItemsOnTagger:function(e){this.appCore.specTagsFilter&&this.appCore.specTagsFilter.addItemsToTagger(e)},removeItemsOnTagger:function(e){this.appCore.specTagsFilter&&this.appCore.specTagsFilter.removeItemsOnTagger(e)},checkAndUpdatePersistency:function(e){this.updateGroupByIfAny(e)},updateGroupByIfAny:function(e){if(e)this.groupRoots(e);else{var t=this.getGroupByColumns();t&&t.length>0&&this.groupRoots(t)}},getGroupByColumns:function(){let e=this.currentTabKey?"xsr-grid-propertiesToGroup-"+this.currentTabKey:"xsr-grid-propertiesToGroup";return widget.getValue(e)},setGroupByColumns:function(e){let t=this.currentTabKey?"xsr-grid-propertiesToGroup-"+this.currentTabKey:"xsr-grid-propertiesToGroup";widget.setValue(t,e)},removeRootNodes:function(e){e&&(this.gridTreeDocument.removeRoot(e),this.model.getOriginalGridRoots().length<=0&&this._showEmptyView())},removeGroupingTable:function(){this.model.removeFakeGridTable()},groupRoots:function(e){let t=this.getPreferredView();t?n.GRID_VIEW==t?this.gridManager.grid.getTreeDocument().getRoots().length>0&&this.gridManager.grid.groupRows({dataIndexesToGroup:Array.isArray(e)?e:[e]}):n.BIG_TILE==t&&this.gridTreeDocument.groupRoots(e):this.isTileViewRendered?this.gridTreeDocument.groupRoots(e):this.gridManager.grid.getTreeDocument().getRoots().length>0&&this.gridManager.grid.groupRows({dataIndexesToGroup:Array.isArray(e)?e:[e]})},getPreferredView:function(){var e="grid-preferred-view-"+this.currentTabKey;return null==widget.getValue(e)?n.GRID_VIEW:widget.getValue(e)},unselectAll:function(){this.model.unselectAll()},getTreeDocument:function(){return this.model},exportGrid:function(e){var t={fileName:e?e+"__"+(new Date).toString().split(" ").splice(1,4).join(" ")+".csv":this.currentTabKey+"_"+(new Date).toString().split(" ").splice(1,4).join(" ")+".csv",columnSeparator:widget.getValue("column-seperator")};this.gridManager.exportCSV(t)},personalize:function(){this.tileManager&&this.currentView===n.BIG_TILE||this.gridManager&&this.gridManager.personalizeColumns()},displayEmptyObjectView:function(){this.tileManager&&this.currentView===n.BIG_TILE&&this._showEmptyView()},_showEmptyView:function(){this.tileManager&&this.currentView===n.BIG_TILE&&(this._emptyContentMsg.setStyle("display","flex"),this.tileManager.hide())},_hideEmptyView:function(){this.tileManager&&this.currentView===n.BIG_TILE&&(this.tileManager.show(),this._emptyContentMsg.setStyle("display","none"))},emptyMsg:function(){this._emptyContentMsg=e.createElement("div",{class:"grid-empty-tile wux-datagridview-emptycontentmessage"});var t=e.createElement("div");t.innerHTML=o.NoObjectsFound,t.inject(this._emptyContentMsg),this._emptyContentMsg.setStyle("display","none"),this._emptyContentMsg.inject(this.multigrid)},destroy:function(){this.toolbar.destroy(),this.multigrid.destroy(),this.gridTreeDocument.destroy(),this.gridManager&&this.gridManager.destroy(),this.tileManager&&this.tileManager.destroy(),this.subs&&this.modelEvents&&this.modelEvents.unsubscribeList(this.subs),this.appCore.specTagsFilter&&this.appCore.specTagsFilter.resetFilterData()},updateToolbarCmdsStatus(e){if(this.parentModel&&!this.parentModel.getMaturityBasedDisabledCommands)return e;const t=new Set(this.parentModel.getMaturityBasedDisabledCommands());for(let i of e)i.disabled=t.has(i.key);return e}})});