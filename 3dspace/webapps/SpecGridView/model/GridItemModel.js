define("DS/SpecGridView/model/GridItemModel",["DS/Tree/TreeNodeModel","UWA/Core","DS/XSRCommonComponents/utils/Utils","DS/XSRCommonComponents/utils/TypeUtils","DS/XSRCommonComponents/utils/RequestUtil","DS/XSRCommonComponents/utils/XInfraRequestUtil","DS/XSRCommonComponents/utils/IndexServiceProvider","DS/XSRCommonComponents/utils/Constants"],function(t,e,o,i,n,r,s,p){"use strict";function c(e){this._parentNode={_nodeDepth:1},this.pathElement={externalPath:[]};var o=this.showChildren?this.showChildren:e&&e.showChildren?e.showChildren:null;this.options={children:o,useAsyncPreExpand:!1,filteringContext:{isFilterOutBySearch:!0,isFilterOutByTagger:!0,isFilterOutByNG:!0},grid:{physicalId:void 0,id:void 0,"ds6w:type":void 0,"ds6w:type_value":void 0,"ds6w:policy":void 0,"ds6w:policy_value":void 0,name:void 0,"ds6w:identifier":void 0,"ds6w:label":void 0,"ds6w:description":void 0,"ds6w:globalType":void 0,"ds6w:reserved":void 0,isLastVersion:void 0,"ds6wg:PLMReference.V_isLastVersion":void 0,"ds6w:reservedBy":void 0,owner:void 0,"ds6w:responsible":void 0,"ds6wg:revision":void 0,"ds6w:status":void 0,"ds6w:status_value":void 0,"ds6w:created":void 0,"ds6w:lastModifiedBy":void 0,"ds6w:modified":void 0,typeIcon:[]},icons:[],thumbnail:void 0,thumbnail_2d:void 0,label:void 0,subLabel:void 0,description:void 0},t.call(this,this.options)}var a=function(t,e){if(t.indexOf("all")>=0)return!0;var o=e;if(Array.isArray(o)){for(var i=!0,n=0;n<o.length;n++){var r=o[n];if(-1===t.indexOf(r)){i=!1;break}}return i}return t.indexOf(o)>=0||void 0};return c.prototype=Object.create(t.prototype),c.prototype.shouldBeEditable=function(){return!1},c.prototype.getType=function(){return this.options.grid["ds6w:type"]},c.prototype.getPolicy=function(){return this.options.grid["ds6w:policy"]},c.prototype.getDisplayName=function(){return this.getLabel()+" "+this.getRevision()},c.prototype.getName=c.prototype.getIdentifier=function(){return this.options.grid["ds6w:identifier"]},c.prototype.getDescription=function(){return this.options.grid["ds6w:description"]},c.prototype.setDescription=function(t){this.options.grid["ds6w:description"]=t},c.prototype.getPhysicalId=c.prototype.getID=function(){return this.options.grid.physicalId},c.prototype.getTitle=function(){return this.options.grid["ds6w:label"]},c.prototype.setTitle=function(t){this.options.grid["ds6w:label"]=this.options.grid.tree=t},c.prototype.getLabel=function(){return this.options.grid["ds6w:label"]},c.prototype.getParentId=function(){return this.options.grid.parentId},c.prototype.getTypeActualName=function(){return this.options.grid["ds6w:type_value"]},c.prototype.getPolicyActualName=function(){return this.options.grid["ds6w:policy_value"]},c.prototype.getTypeIcon=function(){return this.options.icons},c.prototype.getGlobalType=function(){return this.options.grid["ds6w:globalType"]},c.prototype.getReserved=function(){return this.options.grid["ds6w:reserved"]},c.prototype.setReserved=function(t){this.options.grid["ds6w:reserved"]=t},c.prototype.getOwner=c.prototype.getResponsible=function(){return this.options.grid["ds6w:responsible"]},c.prototype.setOwner=c.prototype.setResponsible=function(t){this.options.grid["ds6w:responsible"]=t},c.prototype.getRevision=function(){return this.options.grid["ds6wg:revision"]},c.prototype.getThumbnail=function(){return this.options.thumbnail_2d||this.options.thumbnail},c.prototype.getMaturity=function(){return this.options.grid["ds6w:status"]},c.prototype.setMaturity=function(t){this.options.grid["ds6w:status"]=t},c.prototype.getMaturityActualName=function(){return this.options.grid["ds6w:status_value"]},c.prototype.setMaturityActualName=function(t){this.options.grid["ds6w:status_value"]=t},c.prototype.getModifedDate=function(){return this.options.grid["ds6w:modified"]},c.prototype.setModifedDate=function(t){this.options.grid["ds6w:modified"]=t},c.prototype.getOriginatedDate=function(){return this.options.grid["ds6w:created"]},c.prototype.getCurrentAccess=function(){return this.options.grid.currentAccess},c.prototype.setCurrentAccess=function(t){this.options.grid.currentAccess=t},c.prototype.hasAccess=function(t){var e=this.getCurrentAccess();if(e)return a(e,t);if(this.currentTabKey===p.MEI_TAB||void 0!==this.getMEIInterface&&this.getMEIInterface()===p.MEI_INTERFACE){var o=this.getMaturity();if(o===p.MATURITY_RELEASED||o===p.WELCOMEPANEL_ID_RELEASED||o===p.WELCOMEPANEL_ID_OBSOLETE||o===p.OBSOLETE)return!1}return!0},c.prototype.updateSpecDetails_async=function(){var t=this,e=new r({id:this.getID()}),o={mask:"SpecAndRelatedInfoObjectMask",typeActual:this.getTypeActualName(),typeName:this.getType()};e.get(o).then(function(e){if(void 0!==e.member[0]["@id"]){var o=e.member[0];if(t.options.grid.cestamp=o.cestamp,t.options.grid.currentAccess=o.access||"",o.specificationReport){var i=o.specificationReport.member[0];if(t.options.grid.specReportPid=i["@id"]||"",t.options.grid.specReportType=i.typedisplayName||"",t.options.grid.specReportTypeActualName=i.typeactualName||"",t.options.grid.specReportTypeSymbolicName=i.symbolicTypeName||"",t.options.grid.specReportName=i.name||"",t.options.grid.specReportRevision=i.revision||"",t.options.grid.specReportMaturity=i.maturitydisplayName||"",t.options.grid.specReportMaturityActualName=i.maturityactualName||"",t.options.grid.specReportCreator=i.creator||"",t.options.grid.specReportDescription=i.description||"",t.options.grid.specReportTitle=i.title||"",t.options.grid.specReportCurrentAccess=i.access||"",t.options.grid.isReportCheckedIn=!(!i.hasReport||""===i.hasReport||null===i.hasReport||void 0===i.hasReport),i.template){var n=i.template.member[0];t.options.grid.templatePid=n["@id"],t.options.grid.templateTitle=n.title||"",t.options.grid.templateName=n.name||"",t.options.grid.templateRevision=n.revision||"",t.options.grid.templateState=n.maturityactualName||""}}if(o.changeDetails){var r=o.changeDetails[t.getID()];if(r){if(Array.isArray(r))for(var s=0;s<r.length;s++){var p=r[s];if("Complete"!=p.current){r=p;break}}t.options.grid.changeActionName=r.name,t.options.grid.changeActionState=r.current,t.options.grid.changeActionId=r.physicalid,t.options.grid.changeActionType=r.type,t.options.grid.changeActionpolicy=r.policy,t.options.grid.changeActionRelType=r.relationship,t.options.grid.changeActionRelID=r["physicalid[connection]"],t.options.grid.changeActionRequestedFor=r["attribute[Requested Change]"],t.options.grid.changeActionTitle=r["attribute[Synopsis]"]}}}t.updateOptions(t.options)}).catch(function(t){console.log(t)})},c.prototype.getSpecReportCurrentAccess=function(){return this.options.grid.specReportCurrentAccess},c.prototype.hasAccessOnSpecReport=function(t){var e=this.getSpecReportCurrentAccess();return!e||a(e,t)},c.prototype.getTemplatePid=function(){return this.options.grid.templatePid},c.prototype.getTemplateTitle=function(){return this.options.grid.templateTitle},c.prototype.getTemplateName=function(){return this.options.grid.templateName},c.prototype.getTemplateRev=function(){return this.options.grid.templateRevision},c.prototype.getTemplateState=function(){return this.options.grid.templateState},c.prototype.getSpecReportPid=function(){return this.options.grid.specReportPid},c.prototype.getSpecReportType=function(){return this.options.grid.specReportType},c.prototype.isReportCheckedIn=function(){return this.options.grid.isReportCheckedIn},c.prototype.getSpecReportTypeActualName=function(){return this.options.grid.specReportTypeActualName},c.prototype.getSpecReportTypeSymbolicName=function(){return this.options.grid.specReportTypeSymbolicName},c.prototype.getSpecReportName=function(){return this.options.grid.specReportName},c.prototype.getSpecReportRevision=function(){return this.options.grid.specReportRevision},c.prototype.getSpecReportMaturity=function(){return this.options.grid.specReportMaturity},c.prototype.getSpecReportMaturityActualName=function(){return this.options.grid.specReportMaturityActualName},c.prototype.getSpecReportCreator=function(){return this.options.grid.specReportCreator},c.prototype.getSpecReportDescription=function(){return this.options.grid.specReportDescription},c.prototype.getSpecReportTitle=function(){return this.options.grid.specReportTitle},c.prototype.isChangeConnected=function(){return!!this.options.grid.changeActionId},c.prototype.getChangeActionId=function(){return this.options.grid.changeActionId},c.prototype.getChangeActionTitle=function(){return this.options.grid.changeActionTitle},c.prototype.getChangeActionName=function(){return this.options.grid.changeActionName},c.prototype.getChangeActionRequestedFor=function(){return this.options.grid.changeActionRequestedFor},c.prototype.getChangeActionState=function(){return this.options.grid.changeActionState},c.prototype.getChangeActionType=function(){return this.options.grid.changeActionType},c.prototype.updateAddtitionalValues=function(){this.options.label=this.getTitle(),this.options.subLabel=this.getTileSubLabel(),this.options.contextualMenu=[null]},c.prototype.setTileDescription=function(t){this.options.description=t},c.prototype.setTypeIcon=function(t){var e=this,o=function(t){var o,i=(o=t)&&o.startsWith("http")?o:o.indexOf("/")>=0?n.get3DSpaceURL().concat(o):o?n.get3DSpaceURL().concat("/snresources/images/icons/small/"+o+".png"):void 0;i&&-1===e.options.grid.typeIcon.indexOf(i)&&0===e.options.grid.typeIcon.length&&(e.options.grid.typeIcon.push(i),e.options.icons.push(i))};Array.isArray(t)?o(t[0]):o(t)},c.prototype.setThumbnail2d=function(t){t&&t.startsWith("http")?this.options.thumbnail_2d=t:this.options.thumbnail_2d=t?n.get3DSpaceURL().concat(t):i.isPhysicalProduct(this.getTypeActualName())?o.getIconFormXSR("product"):o.getIconFormXSR("document")},c.prototype.setThumbnail=function(t){t&&t.startsWith("http")?this.options.thumbnail=t:this.options.thumbnail=t?n.get3DSpaceURL().concat(t):i.isPhysicalProduct(this.getTypeActualName())?o.getIconFormXSR("product"):o.getIconFormXSR("document")},c.prototype.setTaggerFilterState=function(t){this.options.filteringContext.isFilterOutByTagger=t},c.prototype.setSearchFilterState=function(t){this.options.filteringContext.isFilterOutBySearch=t},c.prototype.setNGFilterState=function(t){this.options.filteringContext.isFilterOutByNG=t},c.prototype.setColor=function(t){this.options.color=t,this.updateOptions(this.options)},c.prototype.applyFilters=function(){var t=this;t.options.filteringContext.isFilterOutByTagger&&t.options.filteringContext.isFilterOutBySearch&&t.options.filteringContext.isFilterOutByNG?this.show():this.hide()},c.prototype.getTreeModel=function(){return this.options.grid.tree=this.options.grid["ds6w:label"],this.updateOptions(this.options),this},c.prototype.updateOtherDetails=function(){this.updateAddtitionalValues(),this.updateSpecDetails_async(),this.updateThumbnail_async(),this.updateOptions(this.options)},c.prototype.getNodesById=function(t){var e={listOfFoundNodes:[]};return this._getNodesById(t,e),e.listOfFoundNodes},c.prototype._getNodesById=function(t,e){var o=!1;if(this.getID()===t)e.listOfFoundNodes.push(this),o=!0;else{var i=this.getChildren();if(i)for(var n=0;i&&n<i.length;n++)o="function"==typeof i[n]._getNodesById&&i[n]._getNodesById(t,e)||o}return o},c.prototype.sync=function(){this.appCore&&this.appCore.specViewerModelEvents&&this.appCore.specViewerModelEvents.publish({event:"grid-sync-node-data",data:this.getID()})},c.prototype.updateThumbnail_async=function(){var t,e=this;this.getID()&&(new s).fetchItemData([this.getID()],["preview_url"]).then(function(o){if(o){var i=o.results?o.results[0]:void 0,n=i?i.attributes:void 0;if(n)for(var r=0;r<n.length;r++)if("preview_url"===n[r].name){t=n[r].value;break}}e.setThumbnail(t),e.updateOptions(e.options)}).catch(function(t){console.log(t)})},c.prototype.setPhysicalId=c.prototype.setID=function(t){this.options.grid.physicalId=t},c.prototype.setName=c.prototype.setIdentifier=function(t){this.options.grid["ds6w:identifier"]=t},c.prototype.setPolicy=function(t){this.options.grid["ds6w:policy"]=t},c.prototype.setPolicyActualName=function(t){this.options.grid["ds6w:policy_value"]=t},c.prototype.setTypeActualName=function(t){this.options.grid["ds6w:type_value"]=t},c.prototype.setType=function(t){this.options.grid["ds6w:type"]=t},c.prototype.isPrivate=function(){return this.getMaturityActualName().toUpperCase()===p.MATURITY_PRIVATE},c.prototype.isInWork=function(){return this.getMaturityActualName().toUpperCase()===p.MATURITY_IN_WORK},c.prototype.isFrozen=function(){return this.getMaturityActualName().toUpperCase()===p.MATURITY_FROZEN},c.prototype.isReleased=function(){return this.getMaturityActualName().toUpperCase()===p.MATURITY_RELEASED},c.prototype.isObsolete=function(){return this.getMaturityActualName().toUpperCase()===p.MATURITY_OBSOLETE},c});