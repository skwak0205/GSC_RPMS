define("DS/SpecGridView/controller/TileViewManager",["UWA/Core","UWA/Class","DS/ResizeSensor/js/ResizeSensor","DS/XSRCommonComponents/utils/Utils","DS/XSRCommonComponents/components/XSpecDnD/DragDropUtil","DS/SpecGridView/collection/LargeTilesCollectionView","DS/XSRCommonComponents/utils/Constants"],function(e,t,i,n,a,s,l){"use strict";return t.extend({init:function(t){var i=t;this._parent(i),this.appCore=i.appCore,this.itemId=i.itemId;var n=i.container;i.columns;this.modelEvents=i.appCore.specViewerModelEvents,this.model=i.model,this.currentTabKey=i.currentTabKey,this.basicModelEvents=i.appCore.basicModelEvents,this.container=e.createElement("div",{id:"grid-tile-view"}).inject(n),this._subscribe()},_subscribe:function(){this.eventList=[]},drawGrid:function(e,t){var i=this;i.modelEvents;this.currentTabKey===l.BOM_TAB&&i.model.collapseAll(),i.grid=new s({model:i.model,domId:"spec-large-tile-view",useDragAndDrop:!0,allowUnsafeHTMLContent:!0,displayedOptionalCellProperties:["contextualMenu","statusbarIcons","description","activeFlag"],selectionBehavior:{unselectAllOnEmptyArea:!0,toggle:!0,canMultiSelect:!0,enableShiftSelection:!0,enableFeedbackForActiveCell:!0,canInteractiveMultiselectWithCheckboxClick:!0},onDragStartCell:function(e,t){t.nodeModel.select();var s=(new a).prepareDragData(i.model.getSelectedNodes());e.dataTransfer.effectAllowed="all",n.dragStartedInXSR=!0,e.dataTransfer.setData("text",s)},onDragEndCell:function(e,t){return n.dragStartedInXSR=!1,!0}}),i.grid.onContextualEvent={this:this,callback:function(e){if(e&&e.cellInfos&&e.cellInfos.manager){e.cellInfos.manager.getTreeDocument().getSelectedNodes();var t=i.currentTabKey?l.GRID_CONTEXT_MENU+"-"+i.currentTabKey:l.GRID_CONTEXT_MENU;i.modelEvents.publish({event:t,data:e})}}},i.grid.getStatusbarIcons=function(e){return e._canBeGrouped()?i.statusBarInfo?i.statusBarInfo.statusBarIcons:[]:e.options.groupedChildCollapsed?["expand-right"]:["expand-down"]},i.grid.getStatusbarIconsTooltips=function(e){if(!e._canBeGrouped()){var t=e.options.groupedChildCollapsed?["Expand"]:["Collapse"];return e.options.icons=[],t}return i.statusBarInfo?i.statusBarInfo.statusBarTooltip:[]},i.grid.onStatusbarIconPointerDown=function(e,t){var n=e.cellInfos.nodeModel;if(n._canBeGrouped()){if(i.statusBarInfo){e.cellInfos.manager.unselectAll();var a=i.statusBarInfo.statusBarPointerDownEventId[e.clickedIconIndex],s=n;s.select();var r={data:s};i.basicModelEvents.publish({event:l.EVENT_LAUNCH_COMMAND,data:{commandId:a,context:{item:r}}})}}else n.options.groupedChildCollapsed?(n.expand(),n.options.groupedChildCollapsed=!1):(n.collapse(),n.options.groupedChildCollapsed=!0),n.updateOptions(n.options)},i.grid.getDescription=function(e){return i.tileContentContainer=i.getTileDescription(e),i.tileContentContainer};i.grid.onCellDoubleClick(function(e){if(e&&e.nodeModel&&e.nodeModel.getID){var t=e.nodeModel.getTypeActualName(),a=e.nodeModel.getID();if(!a)return;n.isValidItemOnOpen(t)?i.basicModelEvents.publish({event:l.OPEN_SPECIFICATION_VIEW,data:{typeActual:t,itemPid:a}}):i.basicModelEvents.publish({event:l.EVENT_LAUNCH_COMMAND,data:{commandId:l.INFORMATION_CMD,context:{item:e.nodeModel}}})}}.bind(this)),t?i.hide():i.show(),i.grid.inject(i.container)},setStatusBarInfo:function(e){this.statusBarInfo=e},attachResizer:function(){var e=this,t=e.container.getChildren();t&&t[0]&&new i(t[0],function(){e.tileWidthManagement()})},hide:function(){this.container.setStyle("display","none")},show:function(){this.container.setStyle("display","block"),this.tileWidthManagement(),this.attachResizer()},tileWidthManagement:function(){var e=this.container,t=this.container.offsetWidth;t<370?(e.hasClassName("xsr-tile-attr-hide-label")&&e.removeClassName("xsr-tile-attr-hide-label"),e.hasClassName("xsr-tile-attr-column-view")&&e.removeClassName("xsr-tile-attr-column-view"),e.addClassName("xsr-tile-minified")):t>371&&t<665?(e.hasClassName("xsr-tile-minified")&&e.removeClassName("xsr-tile-minified"),e.hasClassName("xsr-tile-attr-column-view")&&e.removeClassName("xsr-tile-attr-column-view"),e.addClassName("xsr-tile-attr-hide-label")):t>666&&t<830?(e.hasClassName("xsr-tile-attr-hide-label")&&e.removeClassName("xsr-tile-attr-hide-label"),e.hasClassName("xsr-tile-attr-column-view")&&e.removeClassName("xsr-tile-attr-column-view"),e.addClassName("xsr-tile-attr-column-view")):t>831&&(e.hasClassName("xsr-tile-attr-column-view")&&e.removeClassName("xsr-tile-attr-column-view"),e.hasClassName("xsr-tile-attr-hide-label")&&e.removeClassName("xsr-tile-attr-hide-label"),e.hasClassName("xsr-tile-minified")&&e.removeClassName("xsr-tile-minified"))},getTileDescription:function(t){if(t.getPreferredTileAttribute){let i=widget.getValue(l.PERSISTENCY_BOM_VIEW);return null==i&&(i=!0),"function"==typeof t.getType&&"Test Method Specification"===t.getType()?function(t){for(var i=new e.createElement("div",{class:"xsr-tile-description"}),n=0;n<t.length;n++){var a=t[n],s=new e.createElement("div",{class:""}).inject(i),l=new e.createElement("div",{class:""}).inject(s);l.innerText=a.value?a.value:"-",l.inject(s)}return i}(t.getPreferredTileAttribute()):function(t){for(var i=new e.createElement("div",{class:"xsr-tile-attr-collection-field"}),n=0;n<t.length;n++){var a=t[n],s=new e.createElement("div",{class:"xsr-tile-attr-field"}).inject(i),l=new e.createElement("div",{class:"xsr-tile-attr-label"});l.innerText=a.name+" : ",l.inject(s);var r=new e.createElement("div",{class:"xsr-tile-attr-value"}).inject(s);r.innerText=a.value?a.value:"-",r.inject(s),a.showMinified?r.addClassName("xsr-tile-show-minified"):r.addClassName("xsr-tile-hide-minified")}return i}(t.getPreferredTileAttribute(i))}return""},destroy:function(){this.eventList&&this.eventList.length>0&&this.modelEvents.unsubscribeList(this.eventList)}})});