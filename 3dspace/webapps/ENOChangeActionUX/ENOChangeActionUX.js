define("DS/ENOChangeActionUX/scripts/Services/CATeamDataGridViewToolbar",["i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e){"use strict";var t=Object.create(null);return t.toolbar=null,t.viewData={menu:[{type:"PushItem",title:e.CHG_CA_Pref_Grid_Label,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-view-list"},action:{module:"DS/ENOChangeActionUX/scripts/Views/CATeamDataGridLayout",func:"changeView"},tooltip:e.CHG_CA_Pref_Grid_Label},{type:"PushItem",title:e.CHG_CA_Pref_Tile_Label,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-view-small-tile"},action:{module:"DS/ENOChangeActionUX/scripts/Views/CATeamTileViewLayout",func:"changeView"},tooltip:e.CHG_CA_Pref_Tile_Label}]},t.writetoolbarDefination=function(){var t={entries:[{id:"ContextHeader",dataElements:{value:e.ECM_CA_Team_Counter_Members,typeRepresentation:"string"},readOnly:!0,category:"status",disabled:!0},{id:"addMember",className:"menu-context",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"plus",fontIconFamily:1}},position:"far",action:{module:"DS/ENOChangeActionUX/scripts/Views/CATeamDataGridLayout",func:"launchAddMemberPanel"},tooltip:e.ECM_CA_Team_Actions_AddMembers,category:"addRemove"},{id:"removeMember",className:"menu-context unabledRemoveContext",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"trash",fontIconFamily:1}},position:"far",action:{module:"DS/ENOChangeActionUX/scripts/Views/CATeamDataGridLayout",func:"removeMember"},tooltip:e.ECM_CA_Remove_context,category:"addRemove"},{id:"addContext",className:"menu-context",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"filter",fontIconFamily:1}},position:"far",action:{module:"DS/ENOChangeActionUX/scripts/Views/CAMemberFilterLayout",func:"launchFilterMemberPanel"},tooltip:e.ECM_CA_Team_Actions_FilterMembers,category:"addRemove"},{id:"view",dataElements:{typeRepresentation:"functionMenuIcon",icon:{iconName:"view-legacy-thb",fontIconFamily:1},value:this.viewData},position:"far",category:"View"}]};return JSON.stringify(t)},t}),define("DS/ENOChangeActionUX/scripts/Models/CAMemberModel",["UWA/Class/Model","DS/ENOChgServices/scripts/services/ChgMembersServices","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e,t,i){"use strict";return e.extend({idAttribute:"id",setup:function(){var e=this;this.addEvent("onChange:role",function(t){var i=e.convertRoleToNlsRole(t.get("role"));t.set("rolesToDisplay",i)})},fetch:function(e){console.log("fetch called")},parse:function(e){var i={};i.rolesToDisplay="",i.userName=e.name;var n=this.get("role");return void 0===n?i.role=e.role:""!=n&&(i.role=n+", "+e.role),i.rolesToDisplay=this.convertRoleToNlsRole(e.role),i.fullName=e.fullName,i.id=e.id,i.type=e.type,i.role.split(", ").indexOf("reviewer")>=0&&(t.reviewerType.typeOfReviewer=i.type),i},convertRoleToNlsRole:function(e){var t="",n="",o=this.get("rolesToDisplay");(void 0===o&&(o=""),e.indexOf("owner")>=0)&&(t=i.ECM_CA_Team_Owner,""!=o?o.indexOf(t)<0?o=n=o+", "+t:n=o:o=n=t);e.indexOf("contributor")>=0&&(t=i.ECM_CA_Team_AddMembers_Assignee,""!=o?o.indexOf(t)<0?o=n=o+", "+t:n=o:o=n=t);e.indexOf("reviewer")>=0&&(t=i.ECM_CA_Team_AddMembers_Reviewer,""!=o?o.indexOf(t)<0?o=n=o+", "+t:n=o:o=n=t);e.indexOf("follower")>=0&&(t=i.ECM_CA_Team_AddMembers_Follower,""!=o?o.indexOf(t)<0?o=n=o+", "+t:n=o:o=n=t);return n}})}),define("DS/ENOChangeActionUX/scripts/CAPreferencesManager",["UWA/Class","DS/ENOChgServices/scripts/services/ChgApplicationPreferencesManager"],function(e,t){"use strict";return e.singleton({_prefStructure:{ChangeAction:{"CASummary.IDCard.Size":void 0,"CASummary.CA.Selection":void 0,"CASummary.Filter.Selection":void 0,"CASummary.View.Selection":void 0,"CASummary.Delete.PID":[],"CASummary.last.Index.Time":void 0,"CASummary.Mobile":void 0,"CASummary.Desktop":void 0,"IDCard.SlideIn.Size":void 0,"IDCard.Dependency.SlideIn.Size":void 0,"IDCard.Applicability.SlideIn.Size":void 0,"IDCard.Attachment.SlideIn.Size":void 0,"IDCard.FlowdownProposed.SlideIn.Size":void 0,"IDCard.Flowdown.SlideIn.upCA":void 0,"IDCard.Approval.Task.SlideIn":void 0}},_APP_KEY:"ChangeAction",_CASUMMARY_IDCARD_SIZE:"CASummary.IDCard.Size",_CASUMMARY_CA_SELECTION:"CASummary.CA.Selection",_CASUMMARY_FILTER_SELECTION:"CASummary.Filter.Selection",_CASUMMARY_VIEW_SELECTION:"CASummary.View.Selection",_CASUMMARY_DELETE_PID:"CASummary.Delete.PID",_CASUMMARY_LAST_INDEX_TIME:"CASummary.last.Index.Time",_CASUMMARY_LAST_DELETE_TIME:"CASummary.last.Delete.Time",_CASUMMARY_MOBILE:"CASummary.Mobile",_CASUMMARY_DESKTOP:"CASummary.Desktop",_IDCARD_SLIDEIN_SIZE:"IDCard.SlideIn.Size",_IDCARD_DEPENDENCY_SLIDEIN_SIZE:"IDCard.Dependency.SlideIn.Size",_IDCARD_APPLICABILITY_SLIDEIN_SIZE:"IDCard.Applicability.SlideIn.Size",_IDCARD_ATTACHMENT_SLIDEIN_SIZE:"IDCard.Attachment.SlideIn.Size",_IDCARD_FLOWDOWNPROPOSED_SLIDEIN_SIZE:"IDCard.FlowdownProposed.SlideIn.Size",_IDCARD_FLOWDOWN_SLIDEIN_UPCA:"IDCard.Flowdown.SlideIn.upCA",_IDCARD_APPROVAL_TASK_SLIDEIN:"IDCard.Approval.Task.SlideIn",initialize:function(){t.initialize(this._APP_KEY,this._prefStructure,!0,!0)},updatePreference:function(e,i){t.updatePreference(e,i)},getPreference:function(e){return t.getPreference(e)},updateIDCardSize:function(e){this.updatePreference(this._CASUMMARY_IDCARD_SIZE,e)},getIDCardSize:function(){return this.getPreference(this._CASUMMARY_IDCARD_SIZE)},updateCASelection:function(e){this.updatePreference(this._CASUMMARY_CA_SELECTION,e)},getCASelection:function(){return this.getPreference(this._CASUMMARY_CA_SELECTION)},updateCASummaryFilterSelection:function(e){this.updatePreference(this._CASUMMARY_FILTER_SELECTION,e)},getCASummaryFilterSelection:function(){return this.getPreference(this._CASUMMARY_FILTER_SELECTION)},updateCASummaryViewSelection:function(e){this.updatePreference(this._CASUMMARY_VIEW_SELECTION,e)},getCASummaryViewSelection:function(){return this.getPreference(this._CASUMMARY_VIEW_SELECTION)},updateIDCardSlideInSize:function(e){switch(e.type){case"applicability":this.updateApplicabilitySlideInSize(e);break;case"dependency":this.updateDependencySlideInSize(e);break;case"attachment":this.updateAttachmentSlideInSize(e);break;case"flowdownProposed":this.updateflowdownProposedSlideInSize(e);break;case"approvals":this.updateApprovalTaskSlideInSize(e);break;default:console.log("Wrong Facet Selected")}},getIDCardSlideInSize:function(e){var t=null;switch(e.type){case"applicability":t=this.getApplicabilitySlideInSize();break;case"dependency":t=this.getDependencySlideInSize();break;case"attachment":t=this.getAttachmentSlideInSize();break;case"flowdownProposed":t=this.getflowdownProposedSlideInSize();break;case"approvals":t=this.getApprovalTaskSlideInSize();break;default:console.log("Wrong Facet Selected")}return t},addToCASummaryDeletePID:function(e){var t=this.getCASummaryViewSelection();null==t&&(t=[]),t.push(e),this.updatePreference(this._CASUMMARY_DELETE_PID,t)},removeFromCASummaryDeletePID:function(e){this.updatePreference(this._CASUMMARY_DELETE_PID,e)},getCASummaryViewSelection:function(){return this.getPreference(this._CASUMMARY_DELETE_PID)},getLastIndexTime:function(){return this.getPreference(this._CASUMMARY_LAST_INDEX_TIME)},updateLastIndexTime:function(e){this.updatePreference(this._CASUMMARY_LAST_INDEX_TIME,e)},getLastDeleteTime:function(){return this.getPreference(this._CASUMMARY_LAST_DELETE_TIME)},updateLastDeleteTime:function(e){this.updatePreference(this._CASUMMARY_LAST_DELETE_TIME,e)},getCASummaryViewDesktop:function(){return this.getPreference(this._CASUMMARY_DESKTOP)},updateCASummaryViewDesktop:function(e){this.updatePreference(this._CASUMMARY_DESKTOP,e)},getCASummaryViewMobile:function(){return this.getPreference(this._CASUMMARY_MOBILE)},updateCASummaryViewMobile:function(e){this.updatePreference(this._CASUMMARY_MOBILE,e)},getDependencySlideInSize:function(){return this.getPreference(this._IDCARD_DEPENDENCY_SLIDEIN_SIZE)},updateDependencySlideInSize:function(e){this.updatePreference(this._IDCARD_DEPENDENCY_SLIDEIN_SIZE,e)},getApplicabilitySlideInSize:function(){return this.getPreference(this._IDCARD_APPLICABILITY_SLIDEIN_SIZE)},updateApplicabilitySlideInSize:function(e){this.updatePreference(this._IDCARD_APPLICABILITY_SLIDEIN_SIZE,e)},getAttachmentSlideInSize:function(){return this.getPreference(this._IDCARD_ATTACHMENT_SLIDEIN_SIZE)},updateAttachmentSlideInSize:function(e){this.updatePreference(this._IDCARD_ATTACHMENT_SLIDEIN_SIZE,e)},getApprovalTaskSlideInSize:function(){return this.getPreference(this._IDCARD_APPROVAL_TASK_SLIDEIN)},updateApprovalTaskSlideInSize:function(e){this.updatePreference(this._IDCARD_APPROVAL_TASK_SLIDEIN,e)},updateflowdownProposedSlideInSize:function(e){this.updatePreference(this._IDCARD_FLOWDOWNPROPOSED_SLIDEIN_SIZE,e)},getflowdownProposedSlideInSize:function(){return this.getPreference(this._IDCARD_FLOWDOWNPROPOSED_SLIDEIN_SIZE)},getFlowdownSlideInUpCA:function(){return this.getPreference(this._IDCARD_FLOWDOWN_SLIDEIN_UPCA)},updateFlowdownSlideInUpCA:function(e){this.updatePreference(this._IDCARD_FLOWDOWN_SLIDEIN_UPCA,e)}})}),define("DS/ENOChangeActionUX/scripts/Services/ChgChangeActionServices",["DS/Foundation/WidgetUwaUtils","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","i18n!DS/ENOChgServices/assets/nls/ChgServiceNLS","DS/PlatformAPI/PlatformAPI","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgInfraService"],function(e,t,i,n,o,a){"use strict";return{URL:null,_SCPreferred:null,_theListSC:null,_theListSC_NLS:null,_SCPreferredDB:null,fetchSubTypes:function(e){var t=this;a.makeWSCall("/resources/dictionary/getTypeInfo","POST","enovia","application/json",'["Change Action"]',function(i){if(Object.keys(i).length>1){o.getGlobalVariable().changeActionSubTypes=[];var n=[];Object.keys(i).forEach(function(e){var i=t.fetchNLSForSubType(e);n.push(i)}),Promise.all(n).then(function(){o.getGlobalVariable().changeActionSubTypePresent=!0;var t=[],i=0;Object.keys(o.getGlobalVariable().changeActionSubTypes).forEach(function(e){var n=o.getGlobalVariable().changeActionSubTypes[e];t[i]={label:n,value:e},i++}),t.sort(function(e,t){return e.label.toUpperCase()>t.label.toUpperCase()?1:-1}),o.getGlobalVariable().changeActionSubTypes=t,null!=e&&e()})}else if(1==Object.keys(i).length){var a=Object.keys(i),s={};s[a[0]]=a[0],o.getGlobalVariable().changeActionSubTypePresent=!1,o.getGlobalVariable().changeActionSubTypes=[],o.getGlobalVariable().changeActionSubTypes.push(s),null!=e&&e()}else null!=e&&e()},function(t){o.getGlobalVariable().changeActionSubTypePresent=!1,null!=e&&e()},!0)},fetchNLSForSubType:function(e){return new Promise(function(t,i){var n="/resources/dictionary/class/"+e+"/attributes";a.makeWSCall(n,"GET","enovia","application/json","",function(i){UWA.is(i.NLSName)&&""!=i.NLSName?o.getGlobalVariable().changeActionSubTypes[e]=i.NLSName:o.getGlobalVariable().changeActionSubTypes[e]=e,t()},function(i){o.getGlobalVariable().changeActionSubTypes[e]=e,t()},!0)})},PopulatePreferences:function(){return new Promise(function(e,t){var i=""!=widget.getValue("x3dPlatformId")&&null!=widget.getValue("x3dPlatformId")&&"OnPremise"!=widget.getValue("x3dPlatformId"),n=[],o=a.PopulateViewPreferences(),s=a.PopulateSCPreferences();if(i){var r=a.populateTenantPreferences();n.push(s,r,o)}else n.push(s,o);Promise.all(n).then(function(t){a.ComputeList(t[0].collabspacesDetails),i&&widget.addPreference(t[1].TenantPreference),e("success")})})},getExpressionValue:function(){return new Promise(function(e,t){a.makeWSCall("/resources/v2/e6w/service/ExpresssionSearch/CHG*,ECM*","GET","enovia","application/json","",function(t){var i=["CHG_CHANGE_MATURITY","CHG_OPEN_WITH_COLLAB","CHG_CREATE_CA_AUTO_PROMOTE","CHG_ADD_MASS_PROPOSED","CHG_OPENWITH","CHG_CA_VIEWS_ENHANCEMENT","CHG_CHANGE_GROUP","CHG_TRANSFER_REALIZED_CUST_TYPE","CHG_IA_COLUMN_ASSESSMENT","CHG_IA_CUSTOM_VIEW","CHG_IA_COLUMN_ASSESSMEN","ECMEnableDefaultChangeAnalysis","CHG_OLD_CA_CREATE","CHG_NATIVE_BREADCRUMB"];t&&t.data&&t.data.forEach(function(e){if(e.dataelements){var t=Object.keys(e.dataelements);for(var n in t)i.indexOf(t[n])>=0&&e.dataelements&&(o.getGlobalVariable()[t[n]]=e.dataelements[t[n]])}}),e()},t,!0)})},onRefresh:function(){var e="ctx::"+widget.getValue("SC");console.log("Setting security Context: "+e),o.getGlobalVariable().caGlobalObject.mySecurityContext=e,e=e.replace("ctx::",""),o.getGlobalVariable().myRole=e.substring(0,e.indexOf(".")),o.getGlobalVariable().collabspace=e.substring(e.lastIndexOf(".")+1,e.length)},IsChangeAction:function(e,t){return new Promise(function(i,n){var o="/resources/modeler/change/changeaction/pid:"+e;t||(t=!0),a.makeWSCall(o,"GET","enovia","application/json","",function(e){i({isChangeAction:"TRUE"})},function(){i({isChangeAction:"FALSE"})},t)})},createCA:function(e,t,i){a.makeWSCall("/resources/modeler/change/changeaction","POST","enovia","application/json",e,t,i)},getJSONForCACreation:function(e,t){var i,n=this,o={version:"v0",changeaction:{cestamp:"0000",title:e.title,description:e.description,severity:e.severity,add:{proposed:[],context:[],people:[],referentials:[]}}};return e.changeorder&&null!=e.changeorder&&""!=e.changeorder&&(o.changeaction.changeorder="pid:"+e.changeorder),(i=e.context).length>0&&i.forEach(function(e){o.changeaction.add.context.push("pid:"+e)}),(i=e.referential).length>0&&i.forEach(function(e){o.changeaction.add.referentials.push("pid:"+e)}),(i=e.assignee).length>0&&i.forEach(function(e){var t=n.getAssigneeBlockToAdd(e);o.changeaction.add.people.push(t)}),(i=e.reviewer).length>0&&i.forEach(function(e){var t=n.getReviewerBlockToAdd(e);o.changeaction.add.people.push(t)}),(i=e.follower).length>0&&i.forEach(function(e){var t=n.getFollowerBlockToAdd(e);o.changeaction.add.people.push(t)}),(i=e.proposed).length>0&&i.forEach(function(e){var i=t.allowedOperationActivity[e].defaultOperation,n=t.allowedOperationActivity[e].defaultActivity,a={where:{id:"pid:"+e},operation:{name:i},activities:[]};if(n){var s="";switch(n){case"Release":s={what:{operation:"ChangeStatus","target state":"Release"}};break;case"Obsolete":s={what:{operation:"ChangeStatus","target state":"Obsolete"}};break;case"Modify":default:s={what:{operation:"Modify"}}}a.activities.push(s)}o.changeaction.add.proposed.push(a)}),o},getAssigneeBlockToAdd:function(e){var t={name:"",role:"contributor"};return t.name=e,t},getReviewerBlockToAdd:function(e){var t={name:"",role:"reviewer"};return t.name=e,t},getFollowerBlockToAdd:function(e){var t={name:"",role:"follower"};return t.name=e,t}}}),define("DS/ENOChangeActionUX/scripts/Views/CATempAutocomplete",["UWA/Core","UWA/Event","UWA/String","DS/W3DXComponents/Views/Temp/DeprecatedAutocomplete","DS/UIKIT/Spinner","WebappsUtils/WebappsUtils","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgMembersServices","i18n!DS/W3DXComponents/assets/nls/Views/Temp/TempAutocomplete","css!DS/W3DXComponents/W3DXComponents"],function(e,t,i,n,o,a,s,r,l){"use strict";var c,d,p=n.extend({_prevText:"",_suggestsIndex:0,defaultOptions:{attributes:{type:"autocomplete"},className:"temp-autocomplete"},resizeSuggests:function(){},init:function(e){this._parent(e),e=e||{},this.collection=e.collection?e.collection:null,this.getSuggestions=e.getSuggestions||this.getSuggestions,this.suggestDistinction=e.suggestDistinction||this.suggestDistinction},attachEvents:function(){this._parent.apply(this,arguments),this.elements.input.addEvent("keydown",this.onKeyDown.bind(this))},getId:function(){return this.elements.input.id},getName:function(){return this.elements.input.name},getFormattedLabel:function(e){return this.options.labelFormat.replace(/\{(\w+)\}/g,function(t,i){return UWA.is(e,"string")?e:e[i]})},suggestDistinction:function(e){return!1},successProcess:function(e,t){if(0===(e=UWA.is(e,"string")?this.dataParse(e):e).length&&this.options.onEmailAddress&&i.isEmail(t)){var n=this.options.onEmailAddress(t);n&&(e=[n])}e.length>0&&(this.dataCache[t]=e),this.dispatchEvent("onUpdateSuggests",[e]),this.elements.spin.hide(),this.typeTimeout=null},onUpdateSuggests:function(e){var n,o,a,c,d=this,p=this.elements;if(p.suggests.empty(),Array.isArray(e)&&e.length>0){for(var u=function(){var e=function(e){var t=d.options.suggestKey?e[d.options.suggestKey]:i.stripTags(d.getFormattedSuggest(e));d.elements.input.set({"data-key":t}),d.dispatchEvent("onSelect",[t,e,c])}.bind(this,C);!!navigator.userAgent.match(/(iPhone|iPad|iPod)/g)?o.addEvent("touchstart",e):(o.addEvent("click",e),o.addEvent("mouseover",function(e){var i=t.getElement(e);p.suggests.getElement(".selected")&&p.suggests.getElement(".selected").removeClassName("selected"),i&&i.parentNode&&i.parentNode.addClassName("selected")}))},h=Math.min(e.length,8),m=0;m<h;m++){var g,f,C=e[m],v=this.getFormattedSuggest(C);if(v=(c=this.suggestDistinction(C))?v+" ("+c+")":v,this.options.suggestKey&&(this.itemCache[C[this.options.suggestKey].toLowerCase()]=C),n=UWA.createElement("li"),o=UWA.createElement("a").inject(n),g=f="","Person"===C.type)if(1==s.getGlobalVariable().isSwymInstalled){var A=C.identifier;g="<div class='chg-team-profile-picture' style='"+("background-image: url(&quot;"+(s.getGlobalVariable().swymURL+"/api/user/getpicture/login/"+A+"/format/normal")+"&quot;);width: 20px;height: 20px;background-size: cover;")+"'> </div>"}else{var w=C.name,b=r.getAvatarDetails(w);g="<div class='chg-team-profile-picture chg-team-search-text' style='"+("background:"+b.avatarColor+";")+"'>"+b.avatarStr+"</div>"}else if("Route Template"===C.type){f="/snresources/images/icons/small/iconSmallRouteTemplate.gif",g="<img src= "+s.getGlobalVariable().computeUrl(f)+">"}s.getGlobalVariable().computeUrl(f);o.setHTML('<div class = "suggest-img-label">'+g+'<div class="item-label" style="flex:1;margin-left: 3px;"  >'+v+"</div></div>"),n.inject(p.suggests),c?(n.addClassName("distinct"),this.options.unlockDistinctClick?u():n.addClassName("locked")):u()}(a=this.elements.suggests.getElement("li:not(.locked)"))&&a.addClassName("selected"),d._suggestsIndex=0,this.resizeSuggests()}else n=UWA.createElement("li"),(o=UWA.createElement("a").inject(n)).setHTML(l.NoResults),n.inject(p.suggests),n.addClassName("error-suggest");this.dispatchEvent("onShowSuggests")},getFocus:function(e,t){this.elements.input.focus(),"reviewer"===e.categoryId&&"Route Template"===e.type&&!0===t?this.elements.input.readOnly=!0:this.elements.input.readOnly=!1},onSelect:function(e,t){t&&(this.elements.input.value=this.getFormattedLabel(t),this.resetInput(),this.onHideSuggests(),setTimeout(function(){this.getFocus(t,!0)}.bind(this),100))},onBlur:function(e){setTimeout(function(){this.dispatchEvent("onHideSuggests")}.bind(this),200)},onFocus:function(e){var i=this,n=this.elements,o=t.getElement(e);n.input.value===this.options.placeholder&&(n.input.value=""),this.getSuggestions(o.value,this.dataCache,function(e){i.successProcess(e,o.value)}),this.dispatchEvent("onFocused",e)},onShowSuggests:function(){var e=this.elements;e.input.value.length>0&&e.container.addClassName(this.options.className+"-suggestsDisplayed")},onKeyDown:function(e){var i=this,n=i.elements.suggests.getElements("li:not(.locked)"),o=n[i._suggestsIndex];function a(e){var t=i._suggestsIndex+e;n[t]&&(o.removeClassName("selected"),i._suggestsIndex=t,n[t].addClassName("selected"))}if(i.elements.container.hasClassName(this.options.className+"-suggestsDisplayed")){switch(e.code){case"Escape":i.onHideSuggests();break;case"ArrowDown":a(1);break;case"ArrowUp":a(-1);break;case"Enter":case"NumpadEnter":o&&o.getElement("a")&&o.getElement("a").triggerEvent("click");break;default:return}t.stop(e)}else"ArrowDown"===e.code&&i.onShowSuggests()},onKeyUp:function(e){var t=this,i=this.elements.input,n=i.value;if(n!==this._prevText)return 0===n.trim().length?(this.resetInput(),this.onHideSuggests(),void(this.typeTimeout=null)):(this._prevText=n,i.removeAttribute("data-key"),void(n.length>=this.options.minLength&&(clearTimeout(this.typeTimeout),this.showSpin(),this.typeTimeout=setTimeout(function(){this.getSuggestions(n,this.dataCache,function(e){t.successProcess(e,n)})}.bind(this),this.options.typeDelay))))},resetInput:function(e){this.elements.input.value="",this._prevText="";var t=document.createEvent("HTMLEvents");t.initEvent("change",!1,!0),this.elements.input.dispatchEvent(t),e&&this.resetCache()},showSpin:function(){var e,t=this.elements;t.suggests.empty(),this.elements.spin.show(),(e=UWA.createElement("li")).addClassName("li-spinner"),this.elements.spin.inject(e),e.inject(t.suggests),this.dispatchEvent("onShowSuggests")},buildSkeleton:function(){this._parent.apply(this,arguments),this.options.id&&(this.elements.input.id=this.options.id),this.options.name&&(this.elements.input.name=this.options.name),this.options.title&&(this.elements.input.title=this.options.title),this.options.attributes&&this.elements.input.set(this.options.attributes),this.elements.spin=new o({className:"small"}),new u(this.elements.input,this.options.container)}});function u(t,i){var n;function o(){var e,i,o;for(e=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,o=0;o<c.length;o++)null!=(i=e[c[o]])&&(n.style[c[o]]=i);n.disabled="disabled",n.style.whiteSpace="pre",n.style.position="absolute",n.style.top=n.style.left="-9999em"}function a(){var e,o;(e=t.value||"")!==n.value&&(n.setText(e),o=n.offsetWidth+d,i&&i.offsetWidth&&(o=i.offsetWidth>n.offsetWidth?n.offsetWidth:i.offsetWidth-4),t.style.width=o+"px")}function s(e){var i;t[(i=e?"remove":"add")+"Event"]("keydown",a),t[i+"Event"]("keyup",a),t[i+"Event"]("input",a),t[i+"Event"]("paste",a),t[i+"Event"]("change",a)}return n=e.createElement("span"),document.body.appendChild(n),o(),s(),a(),{remap:o,refresh:a,destroy:function(){s(!0),n.destroy(),t.style.width=""}}}return c=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent","webkitBoxSizing","mozBoxSizing","boxSizing","padding","border"],d=20,p}),define("DS/ENOChangeActionUX/scripts/Models/CAContextModel",["UWA/Class/Model","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e,t){"use strict";return e.extend({idAttribute:"id",parse:function(e){var i={Access:!0};return i.maturityField=t.ECM_CA_Table_Header_Maturity+":",i.ownerField=t.ECM_CA_Table_Header_Owner+":",i.current=UWA.is(e.info.currentNLS)?e.info.currentNLS:e.info.current,i.type=UWA.is(e.info.typeNLS)?e.info.typeNLS:e.info.type,i.objectType=e.info.type,i.revision=e.info.revision,i.image=e.image,i.id=e.id,i.objectName=e.info["display name"],i.objectTitle=e.info["display name"],""!=i.current&&"Cannot be found"!=i.current&&"Access denied"!=i.current&&null!=i.current||(i.Access=!1),i}})}),define("DS/ENOChangeActionUX/scripts/Views/CACustomContextTileView",["UWA/Core","UWA/Utils","DS/Handlebars/Handlebars4","DS/W3DXComponents/Views/Item/TileView"],function(e,t,i,n){"use strict";return n.extend({name:"CACustomContextTile",template:function(){return'                            <div class="'+this.getClassNames("-check")+' {{#unless withMultisel}}hidden{{/unless}}">                                <div class="toggle toggle-primary">                                    <input type="checkbox" name="radios" value="" id="checkbox-Context-{{id}}">                                    <label class="control-label" for="checkbox-Context-{{id}}"></label>                                </div>                            </div>                              <div class="'+this.getClassNames("-sub-container")+'" {{#if Access}} draggable="true"{{/if}}>                                  <div class="'+this.getClassNames("-header")+'">                                    {{#if image}}<img src="{{#unless lazyLoading}}{{image}}{{/unless}}" {{getImgAttrs imgAttrs}} class="'+this.getClassNames("-image")+'" draggable="false"/>{{/if}}                                  </div>                                  <div class="'+this.getClassNames("-body")+'">                                    {{#if icon}}<img src="{{icon}}" class="'+this.getClassNames("-icon")+'" draggable="false"/>{{/if}}                                      {{#if namePref}}<div class="'+this.getClassNames("-title")+'" title="{{{objectName}}}&nbsp;{{{revision}}}">{{{objectName}}}&nbsp;{{{revision}}}</div>{{/if}}\t\t\t\t\t\t\t\t\t  {{#unless namePref}}<div class="'+this.getClassNames("-title")+'" title="{{{objectTitle}}}&nbsp;{{{revision}}}">{{{objectTitle}}}&nbsp;{{{revision}}}</div>{{/unless}}                                      {{#if titlePref}}<div class="'+this.getClassNames("-subtitle")+'" title="{{{objectName}}}">{{{objectName}}}</div>{{/if}}\t\t\t\t\t\t\t\t\t  {{#unless titlePref}}<div class="'+this.getClassNames("-subtitle")+'" title="{{{objectTitle}}}">{{{objectTitle}}}</div>{{/unless}}                                     <div class="'+this.getClassNames("-content")+'">\t\t\t\t\t\t\t\t\t\t{{#if current}}<div class="'+this.getClassNames("-Maturity")+'" title="{{{maturityName}}}">\t\t\t\t\t\t\t\t\t\t\t<table>\t\t\t\t\t\t\t\t\t\t\t\t<tr>\t\t\t\t\t\t\t\t\t\t\t\t\t<td class="'+this.getClassNames("-maturityField")+'">{{{maturityField}}}</td>\t\t\t\t\t\t\t\t\t\t\t\t\t<td class="'+this.getClassNames("-maturityValue")+'">&nbsp;{{{current}}}</td>\t\t\t\t\t\t\t\t\t\t\t\t</tr>\t\t\t\t\t\t\t\t\t\t\t</table>\t\t\t\t\t\t\t\t\t\t</div>{{/if}}\t\t\t\t\t\t\t\t\t\t{{#if ownerFullname}}<div class="'+this.getClassNames("-Owner")+'" title="{{{ownerFullname}}}">\t\t\t\t\t\t\t\t\t\t<table>\t\t\t\t\t\t\t\t\t\t\t\t<tr>\t\t\t\t\t\t\t\t\t\t\t\t\t<td class="'+this.getClassNames("-ownerField")+'">{{{ownerField}}}</td>\t\t\t\t\t\t\t\t\t\t\t\t\t<td class="'+this.getClassNames("-onwerValue")+'">&nbsp;{{{ownerFullname}}}</td>\t\t\t\t\t\t\t\t\t\t\t\t</tr>\t\t\t\t\t\t\t\t\t\t\t</table>\t\t\t\t\t\t\t\t\t\t</div>{{/if}}\t\t\t\t\t\t\t\t\t</div>                                    <ps-progress  class="'+this.getClassNames("-progress")+'"></ps-progress>                                </div>                                <div class="'+this.getClassNames("-actions")+'">                                    <div class="actions-inline-container">                                      <div class="action-container single-action hidden">                                           <div class="action-icon-wrapper"><span class="fonticon fonticon-2x"></span></div>                                      </div>                                      <div class="action-container actions-inline-dotted hidden">                                           <div class="action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-down-open"></span></div>                                      </div>                                    </div>                                </div>                            </div>                      '}})}),define("DS/ENOChangeActionUX/scripts/Views/EmptyView",["UWA/Core","UWA/Class/View"],function(e,t){"use strict";return t.extend({tagName:"div",className:"chg-empty-text-view",render:function(t){var i=e.createElement("div",{class:"chg-empty-text text-center",text:t});return this.container.setContent(i),this}})}),define("DS/ENOChangeActionUX/scripts/Models/CAReferentialModel",["UWA/Class/Model"],function(e){"use strict";return e.extend({idAttribute:"id",parse:function(e){var t={Access:!0};return t.type=UWA.is(e.info.typeNLS)?e.info.typeNLS:e.info.type,t.objectType=e.info.type,t.revision=e.info.revision,t.image=e.image,t.id=e.id,t.current=(UWA.is(e.info.currentNLS),e.info.currentNLS),t.objectName=e.info["display name"],t.objectTitle=e.info["display name"],""!=t.current&&"Cannot be found"!=t.current&&"Access denied"!=t.current&&null!=t.current||(t.Access=!1),t}})}),define("DS/ENOChangeActionUX/scripts/Views/CAModals",["DS/UIKIT/Form","DS/UIKIT/Modal","UWA/Core","DS/UIKIT/Input/Button","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChgServices/scripts/services/ChgErrors"],function(e,t,i,n,o,a){"use strict";var s={modalHeader:null,modalFooterButtons:null,modalBody:null,modalObject:null,_createModal:function(){var e=s.createFooterButtons();return this.modalObject=new t({closable:!0,header:"<h4>"+s.modalHeader+"</h4>",body:s.createModalBody(),footer:e,events:{onHide:function(){s.modalObject.destroy()}.bind(s.modalObject)}}),this.modalObject},createFooterButtons:function(){for(var e=s.modalFooterButtons,t=[],i=0;i<e.buttons.length;i++)"Cancel"==e.buttons[i].buttonValue?t[i]=new n({value:o.ECM_CA_Cancel,events:{onClick:function(){s.modalObject.hide()}}}):t[i]=new n({value:e.buttons[i].buttonValue,className:"primary"});return t},createModalBody:function(){for(var t=s.modalBody.mBody,i=[],n=0;n<t.length;n++){var r=!1;"textarea"===t[n].fieldType&&(r=!0),i[n]={type:t[n].fieldType,value:t[n].fieldValue,label:t[n].fieldLabel,placeholder:t[n].fieldPlaceHolder,className:t[n].fieldClassName,rows:t[n].fieldRows,html:t[n].html,required:r}}return new e({fields:i,events:{onInvalid:function(){a.error(o.ECM_CA_MandFieldMissing_error)}}})},clearModalValues:function(){this.modalHeader=null,this.modalFooterButtons=null,this.modalBody=null,this.modalObject=null}};return s}),define("DS/ENOChangeActionUX/scripts/Views/CACustomizedRefActionsView",["UWA/Class/View","DS/UIKIT/Iconbar","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices"],function(e,t,i,n){"use strict";return e.extend({name:"refActionsView",tagName:"div",className:"actionsDiv",init:function(e){this._parent.call(this,e)},setup:function(){},render:function(){this.name;this.container.empty(),this.containerReference=this.container;var e=new UWA.Element("div");return e.setAttributes({id:"DivForRefActionsView"}),e.setStyle("height","100%"),this.buildIconBar(e),e.inject(this.containerReference),this},buildIconBar:function(e){var o=this,a=!0,s=n.getCurrentModel();if(UWA.is(s)&&UWA.is(s.get("userAccess"))){var r=s.get("userAccess");(r.AddReferential&&"false"===r.AddReferential||!r.AddReferential)&&(a=!1)}var l=[];a&&(l.push({id:"add",text:i.ECM_CA_Add_Referential,fonticon:"plus",overflow:!1,selectable:!1,handler:function(){var e=o.collection.findWhere({id:"add"});o.dispatchEvent("onActionClick",{model:e})}}),l.push({id:"upload",text:i.ECM_CA_Upload_Referential,fonticon:"upload",overflow:!1,selectable:!1,handler:function(){var e=o.collection.findWhere({id:"upload"});o.dispatchEvent("onActionClick",{model:e})}}));this.iconbar=new t({renderTo:e,items:l})}})}),define("DS/ENOChangeActionUX/scripts/CASpinner",["DS/UIKIT/Mask"],function(e){"use strict";var t={wait:!1,keepActive:!1,is3DSpace:!1,doWait:function(i,n){if(!1===t.keepActive&&t.isWaiting())t.endWait(i);else if(t.isWaiting())return;e.mask(i,n),t.wait=!0},endWait:function(i){t.isWaiting()&&(e.unmask(i),t.wait=!1,t.keepActive=!1)},set3DSpace:function(e){t.is3DSpace=e},if3DSpace:function(){return t.is3DSpace},isWaiting:function(){return t.wait}};return t}),define("DS/ENOChangeActionUX/scripts/Models/CATeamDataGridViewModel",["UWA/Class/Model","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/TreeModel/DataModelSet","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgMembersServices","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChgServices/scripts/services/ChgDataProcess"],function(e,t,i,n,o,a,s,r){"use strict";return e.extend({init:function(){},createTreeDocument:function(){var e=new n;return new t({dataModelSet:e})},loadData:function(e,t){var o=new n;e.prepareUpdate();for(var a=0;a<t.length;a++){var s=new UWA.Element("div",{class:"members"}),r=new UWA.Element("span",{html:t[a].fullName});new UWA.Element("img",{class:"member-name-col-img",src:t[a].image}).inject(s),r.inject(s);var l="",c=t[a].roleNLS;UWA.is(t[a].approvalStatus)&&"None"!=t[a].approvalStatus&&(l=this.createSignOffInformation(t[a])),"Person"==t[a].type?(t[a].person_name=this.createCustomPersonNameField(t[a]),t[a].thumbnail=this.getPersonImageDiv(t[a],!0)):(t[a].person_name=this.createCustomRouteTemplateNameField(t[a]),t[a].thumbnail=t[a].image);var d=i.createTreeNodeDataModel(o,{label:t[a].fullName,subLabel:l,description:c,grid:t[a],icons:[t[a].icon],thumbnail:t[a].thumbnail,contextualMenu:["Copy1","Move1"],statusbarIcons:[],statusbarIconsTooltips:[]});e.addChild(d)}e.pushUpdate()},createSignOffInformation:function(e){var t="Reject"==e.approvalStatus?s.ECM_CA_Team_Rejected:s.ECM_CA_Team_Approved,i=r.escapeHTML(e.comments);return"<b>"+s.ECM_CA_TeamView_Reviewer_SignOff+"</b> : "+t+"\n"+i},createCustomPersonNameField:function(e){var t=new UWA.Element("div",{class:"members"}),i=this.getPersonImageDiv(e);i.addClassName("assignee");var n=UWA.createElement("span",{class:"userName",html:e.fullName});return i.inject(t),n.inject(t),t.outerHTML},getPersonImageDiv:function(e,t){var i="/api/user/getpicture/login/"+e.name+"/format/normal",n=(i=o.getGlobalVariable().computeSwymUrl(i),new UWA.Element("div",{})),s="";if(o.getGlobalVariable().isSwymInstalled)(s=UWA.createElement("img",{src:i})).addClassName("userIcon");else{var r=a.getAvatarDetails(e.fullName);s=UWA.createElement("div",{html:r.avatarStr}),1==t?(s.addClassName("chg-member-profile-picture"),s.addClassName("chg-team-profile-text")):s.addClassName("avatarIcon"),s.style.setProperty("background",r.avatarColor)}return s.inject(n),n},createCustomRouteTemplateNameField:function(e){var t=new UWA.Element("div",{class:"members"}),i=new UWA.Element("span",{html:e.fullName});return new UWA.Element("img",{class:"member-name-col-img",src:e.image}).inject(t),i.inject(t),t.outerHTML}})}),define("DS/ENOChangeActionUX/scripts/Views/CAFlowdownInfoPopOverBodyView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","UWA/Promise","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/TreeModel/DataModelSet","DS/DataGridView/DataGridView","DS/i3DXCompassPlatformServices/OpenWith","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgPropertiesServices","require"],function(e,t,i,n,o,a,s,r,l,c,d,p,u){"use strict";return e.extend({init:function(e){this.options=e,this._parent.call(this,e)},setup:function(){this.dataModel=this.buildFlwodownInforModel()},render:function(){this.options.container.empty();var e=UWA.createElement("div",{class:"ppoover-body-container-component"}),t=this.buildDatagridView();return e.setContent(t),e.inject(this.options.container),this},buildFlwodownInforModel:function(){var e=this.options.objectsSelected,t=new r,i=this.treeDocument=new a({dataModelSet:t,useAsyncPreExpand:!0});if("flowdownFrom"===this.options.bodyFor)for(var n in e){if(l=e[n]){var o={id:l.caID,title:l.caTitle,type:"Change Action",typeNLS:"Change Action",icon:l.icon},s=this.createTreeModel(t,o);i.addChild(s)}}else if("flowdownFor"===this.options.bodyFor)for(var n in e){var l;if(l=e[n]){o={id:l.id,title:l.info["display name"],type:l.info.type,typeNLS:l.info.typeNLS,icon:l.info.icon},s=this.createTreeModel(t,o);i.addChild(s)}}return i.prepareUpdate(),i.pushUpdate(),i},createTreeModel:function(e,t){var i,n;d.getGlobalVariable();return new s.createTreeNodeDataModel(e,{label:t.title,children:[],icons:(i=t,n=[],n.push(i.icon),n),grid:{},data:{forObject:t},idData:{forID:t.id}})},buildDatagridView:function(){var e=this.dataModel;this.options.bodyFor;var i=this.dataGridView=new l({columns:[{text:t.ECM_CA_Table_Header_Title,dataIndex:"tree",width:"91%"}],treeDocument:e,showModelChangesFlag:!0,autoRowHeightFlag:!0});return i.rowSelection="single",i.cellSelection="none",this.setDefaultProperties(i),i},setDefaultProperties:function(e){var t=this;e.onContextualEvent=function(e){return e.cellInfos&&e.cellInfos.rowID>-1?t.showRMBMenu(e.cellInfos).then(function(e){return e}):[]}},openWith:function(e,i){return new o(function(n,o){var a=null,s=[];s.push(i);var r=e.getContentForCompassInteraction(s),l=new c;l.set3DXContent(r);var p=[];UWA.is(l.retrieveCompatibleApps,"function")&&l.retrieveCompatibleApps(function(e){e.forEach(function(e){p.push({type:"PushItem",title:e.text,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+e.fonticon},action:{callback:function(t){e.handler()}}})});var i=d.getGlobalVariable();p.length>0&&i.isNative?"true"==i.CHG_OPENWITH&&(a={type:"PushItem",title:t.ECM_CA_Command_OpenWith_RichClient,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-export"},submenu:p}):p.length>0&&(a={type:"PushItem",title:t.ECM_CA_Command_OpenWith,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-export"},submenu:p}),n(a)})})},showRMBMenu:function(e){var i=this;return new o(function(n,a){var s=u("DS/ENOChgServices/scripts/services/ChgIDCardCommonServices"),r=[],l={objectId:e.nodeModel.options.data.forObject.id.replace("pid:",""),objectType:e.nodeModel.options.data.forObject.type,displayName:e.nodeModel.options.data.forObject.title,displayType:e.nodeModel.options.data.forObject.typeNLS,facetName:"proposed"},c=i.openWith(s,l),p=[];p.push(c),o.all(p).then(function(e){e[0]&&r.push(e[0]),d.getGlobalVariable().CHG_OPEN_WITH_COLLAB,r.push({type:"PushItem",title:t.ECM_CA_Properties,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-attributes"},action:{callback:function(e){i.showPropertyPanel()}}}),n(r)})})},showPropertyPanel:function(){var e=this.treeDocument.getSelectedNodes()[0].options.idData.forID;e=e.slice(4,e.length),p.createPropertiesComponent(e)},destroy:function(){this.dataGridView.destroy()}})}),define("DS/ENOChangeActionUX/scripts/Views/CASlideInFormView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/UIKIT/Modal","DS/UIKIT/Input/Button","DS/UIKIT/Form","UWA/Class/Model","DS/UIKIT/Scroller","DS/PlatformAPI/PlatformAPI","DS/ENOChgRouter5/scripts/ChgRouter"],function(e,t,i,n,o,a,s,r,l,c,d){"use strict";return e.extend({slideinContainer:"",skeletonContainer:"",form:"",invokedFrom:"",isSlideOpen:!1,setup:function(e){var t=this;if(UWA.is(e)&&(this.invokedFrom=e.invokedFrom),"gov"==this.invokedFrom){var i=d.getDependency("xChangeApp");d.getDependency("applicationChannel").subscribe({event:"triptych-panel-hidden"},function(e){"right"===e&&1==t.isSlideOpen&&t.hideSlideIn()});for(var o=i.infoPanel.childNodes,a=0;a<o.length;a++){var s=o[a].className;UWA.is(s)&&"secondmainContainer-sidepanel"===s?(o[a].empty(),this.slideinContainer=o[a],o[a].style.display="block"):o[a].style.display="none"}this.skeletonContainer=n.extendElement(document.body).getElement(".triptych-main")}else this.slideinContainer=n.extendElement(document.body).getElement("#slidein-container"),this.skeletonContainer=n.extendElement(document.body).getElement("#skeleton-container"),this.slideinContainer.innerHTML=""},render:function(){return this},buildSlideIn:function(e){if(UWA.is(this.slideinContainer)){this.form=e;var t=UWA.createElement("div",{id:"slideInContent",styles:{display:"table",height:"100%",width:"100%"}});t.setAttribute("data-rec-id","slideInContentCA"),this.getHeader().inject(t),this.getBody().inject(t),this.getFooter().inject(t),e.slideInReference=this,t.inject(this.slideinContainer);var i=this;widget.addEvent("onResize",function(){setTimeout(function(){var e=i.slideinContainer.getElement("#slideInBody .form .form-group .object-list");i.slideinContainer.clientWidth>0&&(window.matchMedia("(max-width: 768px)").matches?(i.slideinContainer.style.width="100%",e&&e.setStyle("width","100%")):(i.slideinContainer.style.width="400px",e&&e.setStyle("width","378px")))},100)}),c.subscribe("ca-back-to-summary-hide-slidein",function(){i.hideSlideIn()})}},getHeader:function(){var e=this.form.getHeading(),t=UWA.createElement("div",{id:"slideInHeader",styles:{padding:"2px 14px",borderBottom:"1px solid #d1d4d4"},html:[{tag:"div",styles:{width:"100%"},html:{tag:"h5",html:e}},{tag:"div",styles:{top:"0",right:"0",height:"35px",width:"50px",position:"fixed"}}]});return t.setAttribute("data-rec-id","slideInHeaderCA"),t},getFooter:function(){var e=UWA.createElement("div",{id:"slideInFooterRow",styles:{display:"flex",flexDirection:"row",justifyContent:"flex-end"},html:this.form.getFooter()});e.setAttribute("data-rec-id","slideInFooterRowCA");var i=UWA.createElement("div",{id:"slideInFooter",styles:{display:"table-footer-group"},html:e});return i.setAttribute("data-rec-id","slideInFooterCA"),new a({value:t.ECM_CA_Cancel,className:"proposedButtons add-cancel-btn"}).inject(e).addEvent("onClick",this.onCancelButtonClick.bind(this)),i},onCancelButtonClick:function(){this.hideSlideIn()},getBody:function(){var e=UWA.createElement("div",{id:"slideInBody"});return this.form.getBody().inject(e),e},showSlideIn:function(){if(UWA.is(this.slideinContainer)){var e=this.slideinContainer.getElement("#slideInBody .form .form-group .object-list");window.matchMedia("(max-width: 768px)").matches?(this.slideinContainer.style.width="100%","gov"!=this.invokedFrom&&(this.skeletonContainer.style.marginRight="100%"),e&&e.setStyle("width","100% !important")):(this.slideinContainer.style.width="400px","gov"!=this.invokedFrom&&(this.skeletonContainer.style.marginRight="400px"),e&&e.setStyle("width","378px !important")),this.slideinContainer.style.borderLeftWidth="1px",this.skeletonContainer.style.opacity=".5",this.skeletonContainer.style.pointerEvents="none"}if("gov"==this.invokedFrom){this.isSlideOpen=!0;var t=d.getDependency("applicationChannel");t.publish({event:"triptych-show-panel",data:"right"}),t.publish({event:"information-panel-visible",data:null})}},hideSlideIn:function(){if(UWA.is(this.slideinContainer)){this.slideinContainer.innerHTML="",this.slideinContainer.style.width="0",this.slideinContainer.style.borderLeftWidth="0",this.skeletonContainer.style.marginRight="0",this.skeletonContainer.style.opacity="1",this.skeletonContainer.style.pointerEvents="inherit";"gov"!=this.invokedFrom&&this.skeletonContainer.setStyle("width","calc( 100% - 0px )")}"gov"==this.invokedFrom&&(this.isSlideOpen=!1,d.getDependency("applicationChannel").publish({event:"triptych-hide-panel",data:"right"}))}})}),define("DS/ENOChangeActionUX/scripts/Services/CARealizedFlowdownToolbar",["i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e){"use strict";var t=Object.create(null);return t.toolbar=null,t.selectionOptions={menu:[{type:"PushItem",title:"SelectAll",fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-list-ok"},action:{module:"DS/ENOChangeActionUX/scripts/Views/CARealizedOperationView",func:"selectAll"},tooltip:"Select All"},{type:"PushItem",title:"UnselectAll",fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-list-delete"},action:{module:"DS/ENOChangeActionUX/scripts/Views/CARealizedOperationView",func:"UnselectAll"},tooltip:"Unselect All"}]},t.filterData={menu:[{type:"CheckItem",id:"Analysis Pending",title:e.ECM_FLOWDOWNSTATUS_ANALYSIS_PENDING,action:{module:"DS/ENOChangeActionUX/scripts/Views/CARealizedFlowdownView",func:"filterByFlowdownStatusAnalysisPending"},tooltip:e.ECM_FLOWDOWNSTATUS_ANALYSIS_PENDING},{type:"CheckItem",id:"Ignored",title:e.ECM_FLOWDOWNSTATUS_IGNORED,action:{module:"DS/ENOChangeActionUX/scripts/Views/CARealizedFlowdownView",func:"filterByFlowdownStatusIgnored"},tooltip:e.ECM_FLOWDOWNSTATUS_IGNORED},{type:"CheckItem",id:"Flowdown Pending",title:e.ECM_FLOWDOWNSTATUS_FLOWDOWN_PENDING,action:{module:"DS/ENOChangeActionUX/scripts/Views/CARealizedFlowdownView",func:"filterByFlowdownStatusFlowdownPending"},tooltip:e.ECM_FLOWDOWNSTATUS_FLOWDOWN_PENDING},{type:"CheckItem",id:"Flowdown Complete",title:e.ECM_FLOWDOWNSTATUS_FLOWDOWN_COMPLETE,action:{module:"DS/ENOChangeActionUX/scripts/Views/CARealizedFlowdownView",func:"filterByFlowdownStatusFlowdownComplete"},tooltip:e.ECM_FLOWDOWNSTATUS_FLOWDOWN_COMPLETE}]},t.writetoolbarDefination=function(){var t={entries:[{id:"seach",className:"menu-context",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"search",fontIconFamily:1}},position:"far",action:{module:"DS/ENOChangeActionUX/scripts/Views/CARealizedFlowdownView",func:"searchRealized"},tooltip:e.ECM_CA_Search_RealizedChanges,category:"addRemove"},{id:"filter",className:"menu-context",dataElements:{typeRepresentation:"sortingdropdown",icon:{iconName:"list-filter",fontIconFamily:1},value:this.filterData},position:"far",tooltip:e.ECM_CA_Filter_By_Flowdown_Status,category:"addRemove"}]};return JSON.stringify(t)},t}),define("DS/ENOChangeActionUX/scripts/Models//CAContextDataGridViewModel",["UWA/Class/Model","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/TreeModel/DataModelSet","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e,t,i,n,o){"use strict";return e.extend({init:function(){},createTreeDocument:function(){var e=new n;return new t({dataModelSet:e})},loadData:function(e,t){var a=new n;e.prepareUpdate();for(var s=0;s<t.length;s++){var r=t[s].name+" | "+t[s].ownerFullName,l=t[s].currentNLS,c=o.ECM_CA_Table_Header_Title+": "+t[s].title+"\n"+o.ECM_CA_Table_Header_Name+": "+t[s].name+"\n"+o.ECM_CA_Table_Header_Owner+": "+t[s].ownerFullName+"\n"+o.ECM_CA_Maturity_State+": "+t[s].currentNLS,d=i.createTreeNodeDataModel(a,{label:t[s].title,subLabel:r,description:l,grid:t[s],icons:[t[s].icon],thumbnail:t[s].image,customTooltip:c,contextualMenu:["Copy1","Move1"]});e.addChild(d)}e.pushUpdate()}})}),define("DS/ENOChangeActionUX/scripts/SearchConfiguration",["UWA/Core","UWA/Utils/InterCom","UWA/Class/Model","DS/ENO6WPlugins/jQuery","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable"],function(e,t,i,n,o){"use strict";var a=function(e){this.multiSelectVal=e,this.socketName="search_socket_"+(new Date).getTime(),this.socket=new t.Socket(this.socketName,{dispatchRetryInterval:5}),this.socket.subscribeServer("SearchComServer"),this.listener=this.objectsSelected.bind(this),this.socket.addListener("Selected_Objects_search",this.listener);var i=this.options();this.socket.dispatchEvent("RegisterContext",i)};return a.prototype.destroy=function(){var e={};e.widget_id=widget?widget.id:null,this.socket.dispatchEvent("unregisterSearchContext",e),this.socket.unsubscribeServer("SearchComServer"),this.socket.removeListener("Selected_Objects_search",this.listener),this.socket.disconnect()},a.prototype.options=function(e,t,i,a,s,r,l,c){var d={};if(d.title=e,d.multiSel=this.multiSelectVal,d.mode="furtive",d.app_socket_id=this.socketName,d.widget_id=widget?widget.id:null,d.default_with_precond=!0,d.show_precond=!1,d.idcard_activated=!1,d.role=i,d.tenant=o.getGlobalVariable().tenant,t&&"Person"!=t&&(d.precond="(",t=t.split(","),n.each(t,function(t,i){"referentials"==e?(d.precond+=0!==t?" AND ":"flattenedtaxonomies:(",d.precond+='NOT "types/'+i.trim()+'"'):(0!==t&&(d.precond+=" OR "),d.precond+='flattenedtaxonomies:"types/'+i.trim()+'"')}),"referentials"==e&&(d.precond+=")"),d.precond+=")",""!=s&&(d.precond+=s),"Depend"===e&&(d.precond+=' AND (NOT flattenedtaxonomies:"interfaces/Change On Hold") AND (NOT current:"On Hold" AND NOT current:"Cancelled")')),"Person"===t){var p="";p="reviewer"!==r||"reviewer"===r&&"Person"===enoviaServerCAWidget.reviewerType.typeOfReviewer?'(flattenedtaxonomies:"types/Person" AND policycurrent:"Person.Active")':"reviewer"===r&&"Route Template"===enoviaServerCAWidget.reviewerType.typeOfReviewer?'(flattenedtaxonomies:"types/Route Template" AND route_95_base_95_purpose:"Approval" AND (route_95_template_95_availability: "Enterprise" OR route_95_template_95_availability: "'+l+'" ) AND policycurrent:"Route Template.Active" AND latestrevision:"TRUE")':'(flattenedtaxonomies:"types/Route Template" AND route_95_base_95_purpose:"Approval" AND (route_95_template_95_availability: "Enterprise" OR route_95_template_95_availability: "'+l+'" ) AND policycurrent:"Route Template.Active" AND latestrevision:"TRUE") OR (flattenedtaxonomies:"types/Person" AND policycurrent:"Person.Active")',d.precond=p}return a&&(d.default_search_criteria=a),d},a.prototype.activate=function(e,t,i,n,o,a,s,r,l){var c=this.options(e,t,i,o,a,s,r,l);this.callback&&(this.callback=void 0),this.callback=n;var d={};d.widget_id=widget?widget.id:null,this.socket.dispatchEvent("unregisterSearchContext",d),this.socket.dispatchEvent("RegisterContext",c),this.socket.dispatchEvent("InContextSearch",c)},a.prototype.isAvailable=function(){return e.is(this.socket)},a.prototype.objectsSelected=function(e){var t=[];if(this.callback){for(var n=0;n<e.length;n++){var o=[],a=new i(e[n]);o.push(a.get("id")),o.push(a.get("ds6w:identifier")),o.push(a.get("ds6w:type")),o.push(a.get("ds6w:policy")),o.push(a.get("type_icon_url")),t.push(o)}this.callback(t)}},a}),define("DS/ENOChangeActionUX/scripts/Models/CARealizedActivityModel",["UWA/Class/Model","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e,t){"use strict";return e.extend({idAttribute:"id",setup:function(){},fetch:function(e){console.log("fetch called")},parse:function(e){var i="Cannot be found",n={};n.id=e.id,n.activityName=[],n.activityName=e.operation[0].split(" "),n.status=e.status;var o={},a={};if(UWA.is(e.after)){o.id=e.after.id,UWA.is(e.after.owner)&&(o.owner=e.after.owner);var s=e.after.info;UWA.is(s)||(s=e.after.instanceof.info,o.id=e.after.instanceof.id,o.Instanceid=e.after.id),o.Access=!0,UWA.is(e.after.name)&&(o.instanceName=e.after.name),o.type=s.typeNLS,o.objectType=s.type,"Access denied"==o.type?(o.title=t.ECM_CA_Access_Denied,o.name=t.ECM_CA_Access_Denied,o.instanceName="",s.revision=""):o.type==i?(o.title=t.ECM_CA_Cannot_be_found,o.name=t.ECM_CA_Cannot_be_found,o.instanceName="",s.revision=""):(o.title=s["display name"],o.name=s["display name"]),o.revision=s.revision,""!=o.revision&&o.revision!=i&&"Access denied"!=o.revision&&null!=o.revision||(o.revision=""),o.maturity=s.currentNLS,o.NameRevison=o.name+"  "+o.revision,""!=o.maturity&&o.maturity!=i&&"Access denied"!=o.maturity&&null!=o.maturity||(o.Access=!1),n.Afterobject=o}if(UWA.is(e.before)){a.id=e.before.id,UWA.is(e.before.owner)&&(a.owner=e.before.owner),a.type=e.before.typeNLS,a.objectType=e.before.type;s=e.before.info;UWA.is(s)||(s=e.before.instanceof.info,a.id=e.before.instanceof.id,a.Instanceid=e.before.id),a.Access=!0,UWA.is(e.before.name)&&(a.instanceName=e.before.name),a.type=s.typeNLS,a.objectType=s.type,"Access denied"==a.type?(a.title=t.ECM_CA_Access_Denied,a.name=t.ECM_CA_Access_Denied,a.instanceName="",s.revision=""):a.type==i?(a.title=t.ECM_CA_Cannot_be_found,a.name=t.ECM_CA_Cannot_be_found,a.instanceName="",s.revision=""):(a.title=s["display name"],a.name=s["display name"]),a.revision=s.revision,""!=a.revision&&a.revision!=i&&"Access denied"!=a.revision&&null!=a.revision||(a.revision=""),a.maturity=s.currentNLS,a.NameRevison=a.name+"  "+a.revision,""!=a.maturity&&a.maturity!=i&&"Access denied"!=a.maturity&&null!=a.maturity||(a.Access=!1),n.Beforeobject=a}return UWA.is(e.receivingChangeAction)&&(n.receivingChangeAction=e.receivingChangeAction),n.transferReason=UWA.is(e.transferReason)?e.transferReason:"",n.transferReasonNLS="",UWA.is(e.transferReason)&&("simple"==n.transferReason?n.transferReasonNLS=t.ECM_CA_Realized_Transfer_Move:n.transferReasonNLS="early"==n.transferReason?t.ECM_CA_Realized_Transfer_EarlyCompl:t.ECM_CA_Realized_Transfer_DelayedCompl),this.UpdateGrammar(n),n},UpdateGrammar:function(e){var i=e.activityName,n=e.status,o=e.receivingChangeAction,a=e.transferReason,s=e.transferReasonNLS,r=e.id;e.ActivityDetails=[],e.OriginalActivityDetails=[],UWA.is(i)&&Array.isArray(i)&&i.forEach(function(i){if(""!=i){var l={id:r,actName:i,NLSName:i,BeforeExists:!1,AfterExists:!1,BeforeGrammar:"",AfterGrammar:"",status:n,receivingChangeAction:o,transferReason:a,transferReasonNLS:s,sameAsWhere:!1,launchREOnWhere:!1,launchREAccess:!0};if("Add"==i)l.NLSName=t.ECM_CA_NewRealized_Add_Operation,l.AfterExists=!0,l.launchREOnWhere=!0;else if("Cut"==i)l.NLSName=t.ECM_CA_NewRealized_Cut_Operation,l.BeforeExists=!0,l.launchREOnWhere=!0;else if("AddAlternate"==i)l.NLSName=t.ECM_CA_NewRealized_AddAlternate_Operation,l.AfterExists=!0,l.launchREOnWhere=!0;else if("AltSubFor"==i)l.NLSName=t.ECM_CA_NewRealized_AltSubFor_Operation,l.AfterExists=!0,l.launchREOnWhere=!0;else if("AddSubstitute"==i)l.NLSName=t.ECM_CA_NewRealized_AddSubstitute_Operation,l.AfterExists=!0,l.launchREOnWhere=!0;else if("SubstitutionContextAdded"==i)l.NLSName=t.ECM_CA_NewRealized_SubstitutionContextAdded_Operation,l.AfterExists=!0,l.launchREOnWhere=!0;else if("SubtitutionContextRemoved"==i)l.NLSName=t.ECM_CA_NewRealized_SubtitutionContextRemoved_Operation,l.AfterExists=!0,l.launchREOnWhere=!0;else if("AltQualified"==i)l.NLSName=t.ECM_CA_NewRealized_AltQualified_Operation,l.AfterExists=!0,l.launchREOnWhere=!0;else if("AltObsolete"==i)l.NLSName=t.ECM_CA_NewRealized_AltObsolete_Operation,l.AfterExists=!0,l.launchREOnWhere=!0;else if("Replace"==i)l.NLSName=t.ECM_CA_NewRealized_Replace_Operation,l.BeforeExists=!0,l.AfterExists=!0,l.BeforeGrammar=t.ECM_CA_Replace_Before,l.AfterGrammar=t.ECM_CA_Replace_After,l.launchREOnWhere=!0;else if("AddInFamily"==i)l.NLSName=t.ECM_CA_NewRealized_AddInFamily_Operation,l.AfterExists=!0,e.Beforeobject&&(l.BeforeGrammar=t.ECM_CA_AddInFamily_Before,l.BeforeExists=!0),l.launchREOnWhere=!0;else if("Modify"==i)l.NLSName=t.ECM_CA_NewRealized_Modified,e.Afterobject&&e.Afterobject.owner&&e.Afterobject.id!=e.Afterobject.owner.id?(l.NLSName=t.ECM_CA_NewRealized_ModifiedUsage,l.AfterExists=!0):l.sameAsWhere=!0,l.launchREOnWhere=!0;else if("EditVariant"===i)l.NLSName=t.ECM_CA_REALIZED_EDITVARIANT,e.Afterobject&&e.Afterobject.owner&&e.Afterobject.id!=e.Afterobject.owner.id?(l.NLSName=t.ECM_CA_REALIZED_EDITVARIANT,l.AfterExists=!0):l.sameAsWhere=!0;else if("ConfiguredEditVariant"===i)l.NLSName=t.ECM_CA_REALIZED_CONFIGUREDEDITVARIANT,e.Afterobject&&e.Afterobject.owner&&e.Afterobject.id!=e.Afterobject.owner.id?(l.NLSName=t.ECM_CA_REALIZED_CONFIGUREDEDITVARIANT,l.AfterExists=!0):l.sameAsWhere=!0;else if("Move"==i)l.NLSName=t.ECM_CA_NewRealized_Moved,e.Afterobject&&e.Afterobject.owner&&e.Afterobject.id!=e.Afterobject.owner.id&&(l.AfterExists=!0),l.launchREOnWhere=!0;else if(i.contains("ChangeStatus")){var c=i.substring(13);l.NLSName=t.ECM_CA_NewRealized_ChangedStatus,i.contains("#")&&c&&"unknown"!=c&&(c=c.replace("_"," "),l.AfterGrammar=t.ECM_CA_NewRealized_Current_Maturity,l.AfterMaturity=c,l.AfterExists=!0,l.sameAsWhere=!0),l.launchREOnWhere=!0}else"TransferOwnership"==i||"ChangeResponsible"==i?(l.NLSName=t.ECM_CA_NewRealized_transferownership,l.sameAsWhere=!0,l.launchREOnWhere=!0):"ConfiguredDelete"==i?(l.NLSName=t.ECM_CA_NewRealized_ConfiguredDelete,l.BeforeExists=!0,l.launchREOnWhere=!0):"ConfiguredReplace"==i?(l.NLSName=t.ECM_CA_NewRealized_ConfiguredReplace,l.BeforeExists=!0,l.AfterExists=!0,l.BeforeGrammar=t.ECM_CA_Replace_Before,l.AfterGrammar=t.ECM_CA_Replace_After,l.launchREOnWhere=!0):"EvolveInstance"==i?(l.NLSName=t.ECM_CA_NewRealized_EvolveInstance,l.BeforeExists=!0):"ConfiguredMove"==i?(l.NLSName=t.ECM_CA_NewRealized_ConfiguredMove,l.BeforeExists=!0,l.launchREOnWhere=!0):"NewMinorVersion"==i?(l.NLSName=t.ECM_CA_NewRealized_NewMinorVersion_OperationSuffix,l.BeforeExists=!0,l.BeforeGrammar=t.ECM_CA_Previous_Revision,l.sameAsWhere=!0):"NewVersion"==i?(l.NLSName=t.ECM_CA_NewRealized_NewVersion_OperationSuffix,l.BeforeExists=!0,l.BeforeGrammar=t.ECM_CA_Previous_Revision,l.sameAsWhere=!0):"Clone"==i?(l.NLSName=t.ECM_CA_NewRealized_Clone_OperationSuffix,l.BeforeExists=!0,l.BeforeGrammar=t.ECM_CA_Original_Object,l.sameAsWhere=!0):"Evolve"==i?(l.NLSName=t.ECM_CA_NewRealized_Evolve_OperationSuffix,l.BeforeExists=!0,l.BeforeGrammar=t.ECM_CA_Original_Object,l.sameAsWhere=!0):"NewEvolution"==i?(l.NLSName=t.ECM_CA_NewRealized_NewEvolution_OperationSuffix,l.BeforeExists=!0,l.BeforeGrammar=t.ECM_CA_Original_Object,l.sameAsWhere=!0):"Create"==i?(l.NLSName=t.ECM_CA_NewRealized_Create_Operation,l.launchREAccess=!0,l.launchREOnWhere=!0):"Extend"==i?(l.NLSName=t.ECM_CA_NewRealized_Extend_Operation,l.AfterExists=!0):"Delete"==i?(l.sameAsWhere=!0,l.NLSName=t.ECM_CA_NewRealized_Delete_Operation,l.launchREAccess=!1):l.NLSName=i;l.taggerId=l.NLSName+l.id,UWA.is(e.Afterobject)&&l.AfterExists&&(l.After=e.Afterobject),UWA.is(e.Beforeobject)&&l.BeforeExists&&(l.Before=e.Beforeobject),e.ActivityDetails.push(l)}}),e.OriginalActivityDetails=e.ActivityDetails}})}),define("DS/ENOChangeActionUX/scripts/Views/CACustomTeamTileView",["UWA/Core","DS/W3DXComponents/Views/Item/TileView"],function(e,t){"use strict";return t.extend({name:"CACustomTeamTile",template:function(){return'                            <div class="'+this.getClassNames("-check")+' {{#unless withMultisel}}hidden{{/unless}}">                                <div class="toggle toggle-primary">                                    <input type="checkbox" name="radios" value="" id="checkbox-{{cid}}">                                    <label class="control-label" for="checkbox-{{cid}}"></label>                                </div>                            </div>                              <div class="'+this.getClassNames("-sub-container")+'" draggable="true">                                  <div class="'+this.getClassNames("-header")+'">{{{image}}}</div>                                  <div class="'+this.getClassNames("-body")+'">                                    {{#if icon}}<img src="{{icon}}" class="'+this.getClassNames("-icon")+'" draggable="false"/>{{/if}}                                      <div class="'+this.getClassNames("-title")+'">{{{title}}}</div>                                      <div class="'+this.getClassNames("-subtitle")+'">{{{subtitle}}}</div>                                      <div class="'+this.getClassNames("-content")+'" title="{{{rolesToDisplay}}}">{{{rolesToDisplay}}}</div>                                    <ps-progress  class="'+this.getClassNames("-progress")+'"></ps-progress>                                </div>                                <div class="'+this.getClassNames("-actions")+'">                                    <div class="actions-inline-container">                                      <div class="action-container single-action hidden">                                        <div class="action-icon-wrapper"><span class="fonticon fonticon-2x"></span></div>                                      </div>                                      <div class="action-container actions-inline-dotted hidden">                                        <div class="action-icon-wrapper">                                          <span class="fonticon fonticon-down-open-big"></span>                                        </div>                                      </div>                                    </div>                                </div>                            </div>                      '}})}),define("DS/ENOChangeActionUX/scripts/Views/CAMemberFilterView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","UWA/Core","DS/Handlebars/Handlebars4"],function(e,t,i,n){return e.extend({name:"teamfilter",tagName:"div",className:"teamview",setup:function(){this.template='                                                <div class="'+this.getClassNames("-role-filter")+'">                                                    <table class="filter-table table">                                                        <tr >                                                            <td style="color: gray;">'+t.ECM_CA_Team_Filter_byName+'</td>                                                            <td>                                                                <div class="filter-input">                                                                    <input type="text" placeholder="'+t.ECM_CA_Team_SearchTeamMembers_PlaceHolder+'" class="form-control form-control-root filtertext">                                                                    <div class="clear-filter fonticon fonticon-cancel-circled"></div>                                                                </div>                                                            </td>                                                        </tr>                                                        <tr >                                                            <td style="color: gray;">'+t.ECM_CA_Team_Filter_byResponsibilities+'</td>                                                            <td class="teamview-filter toggle-primary">                                                                <div class="toggle-container toggle-filter-view">                                                                    <div class="toggle toggle-root">                                                                        <input type="checkbox" value="option1" id="allToggle" class="roleFilter" checked>                                                                        <label class="control-label" for="allToggle" style="color: gray;">'+t.ECM_CA_Team_Filter_All+'</label>                                                                    </div>                                                                    <div class="toggle toggle-root">                                                                        <input type="checkbox" value="option1" id="assigneeToggle" class="roleFilter">                                                                        <label class="control-label" for="assigneeToggle" style="color: gray;">'+t.ECM_CA_Team_Filter_Assignees+'</label>                                                                    </div>                                                                    <div class="toggle toggle-root">                                                                        <input type="checkbox" value="option1" id="revMemToggle" class="roleFilter">                                                                        <label class="control-label" for="revMemToggle" style="color: gray;">'+t.ECM_CA_Team_Filter_Reviewers+'</label>                                                                    </div>                                                                    <div class="toggle toggle-root">                                                                        <input type="checkbox" value="option1" id="followMemToggle" class="roleFilter">                                                                        <label class="control-label" for="followMemToggle" style="color: gray;">'+t.ECM_CA_Team_Filter_Followers+"</label>                                                                    </div>                                                                </div>                                                            </td>                                                        </tr>                                                    </table>                                                </div>",this.renderer=this.getTemplate(this.template)},init:function(e){e=i.clone(e||{},!1),this._parent.call(this,e)},render:function(){this.name,this.cid;this.container.empty(),containerReference=this.container;var e=UWA.createElement("div",{class:"teamview-role-filter",styles:{height:"10%"}}),t=this.renderer();return e.addContent(t),e.inject(containerReference),this},injectSubView:function(e,t){var i=this.container.getElement(t);e&&i&&i.grab(e.render().getContent())},getTemplate:function(e){var t=n.compile(e),i=this;return i.data={placeholder:i.options.placeholder},function(){return t(i.data)}},domEvents:{"keyup .filtertext":function(e){var t=e.target.value,i=this.container.getElement(".clear-filter");t.length>0?i.setStyle("visibility","visible"):i.setStyle("visibility","hidden"),this.dispatchEvent("memberFilterKeyUp",arguments)},"click .clear-filter":function(e){this.container.getElement(".clear-filter").setStyle("visibility","hidden");var t=this.container.getElement(".filtertext");if(t){t.value=""}this.dispatchEvent("memberFilterKeyUp",{target:{value:""}})},"focus .filtertext":function(){var e=document.getElementsByClassName("searchfiler-input-container");e.addClassName("highlighted-border"),e.removeClassName("border-without-focus")},"click .roleFilter":function(){this.dispatchEvent("memberRoleFilter",arguments)}}})}),define("DS/ENOChangeActionUX/scripts/CATagNavigatorProxy",["i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","UWA/Core","UWA/Class","UWA/Class/Debug","UWA/Class/Events","DS/TagNavigatorProxy/TagNavigatorProxy","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable"],function(e,t,i,n,o,a,s){"use strict";return i.extend(n,o,{bExecuteTagger:!0,_initTaggerProxy:function(e){var i=this,n=new Promise(function(o,r){return i.bExecuteTagger?i.taggerProxy?n:(l=i.taggerProxyOptions={filteringMode:"FilteringOnServer",events:{}},i.allSubjects=[],i.allActivitySubjects=[],i.subjectsMapByPredValue={},i.filters={},d=i._taggerProxyEvents={onFilterChange:i.onFilterChange,onFilterSubjectsChange:i.onFilterChange,addUnfocusSubjectsListener:i.onUnfocusSubjects,addFilterChangeListener:i.onFilterChange,addCriteriaChangeListener:i.onFilterChange},widget&&!s.getGlobalVariable().is3DSpace?l=t.extend({widgetId:widget.id,tenant:s.getGlobalVariable().tenant},l,!0):s.getGlobalVariable().is3DSpace&&(l=t.extend({contextId:"context1"},l,!0)),i.widget=widget,void(s.getGlobalVariable().isNative?require(["DS/ENOChangeActionUX/scripts/CAWebInWinTaggerProxy"],function(t){if(l.events=d,!s.getGlobalVariable().widgetId){var n=Math.random();n.toString(36);var a=n.toString(36).substr(2,9);s.getGlobalVariable().widgetId="ChangeMgt"+a}l.widgetId=s.getGlobalVariable().widgetId,l.proxyId=s.getGlobalVariable().widgetId+"ChangeAction_Facet_"+e,c=i.taggerProxy=new t(l),widget=i.widget,o(c)}):(c=i.taggerProxy=a.createProxy(l,d),i.taggerProxy.addFilterChangeListener(i.onFilterChange,i),o(c)))):n;var l,c,d});return n},_setSubjectTags:function(e,t){if(this.bExecuteTagger){this.viewName=t;switch(t){case"Properties":this._setSubjectTagsForProperties(e);case"Team":this._setSubjectTagsForTeam(e);break;case"Proposed":this._setSubjectTagsForProposed(e);break;case"Realized":this._setSubjectTagsForRealized(e,"Realized");break;case"RealizedFlowdown":this._setSubjectTagsForRealized(e,"RealizedFlowdown");break;case"Referential":this._setSubjectTagsForReferentials(e);break;case"Context":this._setSubjectTagsForContext(e);break;default:console.log("incorrect view selected")}this.taggerProxy}},_setSubjectTagsForProperties:function(e){if(this.bExecuteTagger){var t={};return this._setTagsForInternal("Properties",t),t}},_setSubjectTagsForTeam:function(t){if(this.bExecuteTagger){for(var i={},n=t,o=[],a=0;a<n.length;a++){var s=n.at(a),r=[];if(s){o.push(s.cid);var l={},c=s.get("fullName");l.sixw="ds6w:who/"+e.ECM_CA_MEMBER_TAG,l.type="xsd:string",l.dispValue=c,l.object=c,r.push(l),s.get("rolesToDisplay").split(", ").forEach(function(t){var i={};i.sixw="ds6w:who/"+e.ECM_CA_Summary_Table_Label_Role,i.type="xsd:string",i.dispValue=t,i.object=t,r.push(i)})}r.length&&(i[s.get("id")]=r)}return this._setTagsForInternal("Team",i),i}},_setSubjectTagsForProposed:function(t){if(this.bExecuteTagger){for(var i={},n=t,o=0;o<n.length;o++){var a=n.at(o),s=[];if(a){var r={},l="Create"==a.get("operationActual")?"UnAssigned":a.get("maturity");r.sixw="ds6w:what/"+e.ECM_CA_Table_Header_Maturity,r.type="xsd:string",r.dispValue=l,r.object=l,s.push(r);var c={},d="Create"==a.get("operationActual")?"UnAssigned":a.get("revision");c.sixw="ds6w:what/"+e.ECM_CA_Proposed_Operation_Revision,c.type="xsd:string",c.dispValue=d,c.object=d,s.push(c);var p={},u=a.get("type");p.sixw="ds6w:what/"+e.ECM_CA_Proposed_Operation_Type,p.type="xsd:string",p.dispValue=u,p.object=u,s.push(p);var h={},m="Create"==a.get("operationActual")?"UnAssigned":a.get("collabSpace");h.sixw="ds6w:where/"+e.ECM_CA_COLLABSPACE_TAG,h.type="xsd:string",h.dispValue=m,h.object=m,s.push(h);var g={},f="Create"==a.get("operationActual")?"UnAssigned":a.get("ownerFullname");g.sixw="ds6w:who/"+e.ECM_CA_RESPONSIBLE_TAG,g.type="xsd:string",g.dispValue=f,g.object=f,s.push(g);var C={},v=a.get("operationDisplay");C.sixw="ds6w:what/"+e.ECM_CA_Proposed_Operation_Operation,C.type="xsd:string",C.dispValue=v,C.object=v,s.push(C)}s.length&&(i[a.get("id")]=s)}return this._setTagsForInternal("Proposed",i),i}},_setSubjectTagsForRealized:function(t,i){if(this.bExecuteTagger){var n={},o=t;if(!o)return n;for(var a=0;a<o.length;a++){var s=o.at(a),r=[];if(s){s.get("id");var l={},c=s.get("maturity");l.sixw="ds6w:what/"+e.ECM_CA_Table_Header_Maturity,l.type="xsd:string",l.dispValue=c,l.object=c,r.push(l);var d={},p=s.get("revision");d.sixw="ds6w:what/"+e.ECM_CA_Proposed_Operation_Revision,d.type="xsd:string",d.dispValue=p,d.object=p,r.push(d);var u={},h=s.get("type");u.sixw="ds6w:what/"+e.ECM_CA_Proposed_Operation_Type,u.type="xsd:string",u.dispValue=h,u.object=h,r.push(u);var m={},g=s.get("collabSpace");m.sixw="ds6w:where/"+e.ECM_CA_COLLABSPACE_TAG,m.type="xsd:string",m.dispValue=g,m.object=g,r.push(m);var f={},C=s.get("ownerFullname");f.sixw="ds6w:who/"+e.ECM_CA_RESPONSIBLE_TAG,f.type="xsd:string",f.dispValue=C,f.object=C,r.push(f),s.get("activities").forEach(function(t){var i=t.get("ActivityDetails")[0],n={};if(n.sixw="ds6w:what/"+e.ECM_CA_Realized_Tagger_Activity_Change,n.type="xsd:string",n.dispValue=i.NLSName,n.object=i.NLSName,n.activityDetails="activity-"+i.taggerId,r.push(n),!i.sameAsWhere){if(i.AfterExists){var o={},a=t.get("Afterobject").type;o.sixw="ds6w:what/"+e.ECM_CA_Proposed_Operation_Type,o.type="xsd:string",o.dispValue=a,o.object=a,o.activityDetails="activityAfter-"+i.taggerId,r.push(o)}if(i.BeforeExists){o={},a=t.get("Beforeobject").type;o.sixw="ds6w:what/"+e.ECM_CA_Proposed_Operation_Type,o.type="xsd:string",o.dispValue=a,o.object=a,o.activityDetails="activityBefore-"+i.taggerId,r.push(o)}}})}r.length&&(n[s.get("id")]=r)}return this._setTagsForInternal(i,n),n}},_setSubjectTagsForReferentials:function(t){if(this.bExecuteTagger){for(var i={},n=null==t.length,o=0==n?t:t.getChildren(),a=0;a<o.length;a++){var s=0==n?o.at(a):o[a].options.grid,r=[];if(s){var l={},c=0==n?s.get("objectTitle"):s.title;l.sixw="ds6w:what/"+e.ECM_CA_Proposed_Operation_Name,l.type="xsd:string",l.dispValue=c,l.object=c,r.push(l);var d={},p=0==n?s.get("type"):s.typeNLS;d.sixw="ds6w:what/"+e.ECM_CA_Proposed_Operation_Type,d.type="xsd:string",d.dispValue=p,d.object=p,r.push(d);var u={},h=0==n?s.get("revision"):s.revision;u.sixw="ds6w:what/"+e.ECM_CA_Proposed_Operation_Revision,u.type="xsd:string",u.dispValue=h,u.object=h,r.push(u);var m={},g=0==n?s.get("current"):s.currentNLS;m.sixw="ds6w:what/"+e.ECM_CA_Table_Header_Maturity,m.type="xsd:string",m.dispValue=g,m.object=g,r.push(m);var f={},C=0==n?s.get("ownerFullname"):s.ownerFullName;f.sixw="ds6w:who/"+e.ECM_CA_RESPONSIBLE_TAG,f.type="xsd:string",f.dispValue=C,f.object=C,r.push(f)}if(r.length)i[0==n?s.get("id"):s.id]=r}return this._setTagsForInternal("Referential",i),i}},_setSubjectTagsForContext:function(t){if(this.bExecuteTagger){for(var i={},n=null==t.length,o=0==n?t:t.getChildren(),a=0;a<o.length;a++){var s=0==n?o.at(a):o[a].options.grid,r=[];if(s){var l={},c=0==n?s.get("objectTitle"):s.title;l.sixw="ds6w:what/"+e.ECM_CA_Proposed_Operation_Name,l.type="xsd:string",l.dispValue=c,l.object=c,r.push(l);var d={},p=0==n?s.get("type"):s.typeNLS;d.sixw="ds6w:what/"+e.ECM_CA_Proposed_Operation_Type,d.type="xsd:string",d.dispValue=p,d.object=p,r.push(d);var u={},h=0==n?s.get("revision"):s.revision;u.sixw="ds6w:what/"+e.ECM_CA_Proposed_Operation_Revision,u.type="xsd:string",u.dispValue=h,u.object=h,r.push(u);var m={},g=0==n?s.get("current"):s.currentNLS;m.sixw="ds6w:what/"+e.ECM_CA_Table_Header_Maturity,m.type="xsd:string",m.dispValue=g,m.object=g,r.push(m);var f={},C=0==n?s.get("ownerFullname"):s.ownerFullName;f.sixw="ds6w:who/"+e.ECM_CA_RESPONSIBLE_TAG,f.type="xsd:string",f.dispValue=C,f.object=C,r.push(f)}if(r.length)i[0==n?s.get("id"):s.id]=r}return this._setTagsForInternal("Context",i),i}},activateTaggerProxy:function(){var e=this.taggerProxy;this.taggerProxy&&(e.activate(),e.toggleProxyFocus(!0))},deactivateTaggerProxy:function(){var e=this.taggerProxy;this.taggerProxy&&e.deactivate()},_indexTagForFiltering:function(e,t){var i,n,o,a;return this.subjectsMapByPredValue[o=e.sixw]||(this.subjectsMapByPredValue[o]={}),this.subjectsMapByPredValue[e.sixw][typeof e.object]||(this.subjectsMapByPredValue[e.sixw][typeof e.object]={}),(n=this.subjectsMapByPredValue[e.sixw][typeof e.object])[a=e.object]||(n[a]={}),"string"!==(i=e.type)&&"integer"!==i&&"date"!==i&&"tree"!==i&&(i="string"),this.subjectsMapByPredValue[e.sixw][typeof e.object][a][t]||(this.subjectsMapByPredValue[e.sixw][typeof e.object][a][t]={field:e.field,dispValue:e.dispValue,type:i,uri:e.object,activityDetails:[]}),e.activityDetails&&this.subjectsMapByPredValue[e.sixw][typeof e.object][a][t].activityDetails.push(e.activityDetails),this},unloadAllTags:function(){return this.allTags={},this.allSubjects=[],this.allActivitySubjects=[],this.subjectsMapByPredValue={},this},_setTagsForInternal:function(e,t){var i,n,o,a,s,r;for(n in this.unloadAllTags(),i=!0,this.filters&&this.filters.allfilters&&(i=0===Object.keys(this.filters.allfilters).length),this.allTags=t,t)for(a=t[n],this.allSubjects.push(n),s=0,r=a.length;s<r;s++)o=a[s],this._indexTagForFiltering(o,n),o.activityDetails&&(o.activityDetails.indexOf("activity-")>=0&&this.allActivitySubjects.push(o.activityDetails.replace("activity-","")),o.activityDetails.indexOf("activityAfter-")>=0&&this.allActivitySubjects.push(o.activityDetails.replace("activityAfter-","")),o.activityDetails.indexOf("activityBefore-")>=0&&this.allActivitySubjects.push(o.activityDetails.replace("activityBefore-","")));return this.onFilterChange(this.filters,i),this},onFilterChange:function(i,n){if(i){var o,a,s,r,l,c,d,p,u,h,m,g,f,C,v,A,w,b,S,y,_,E,D,O,N,M,I,x,T,V,R,P,U;this.filters=i,o=i.allfilters,s=[],U=[],[],u=0,f={},m={},P={};var F=0,W=!1;for(l in d={},o){for(h=o[l],d[l]||(d[l]={}),D=0,M=h.length;D<M;D++)if((A=h[D]).object,b=A.object,this.subjectsMapByPredValue[l]){if("date"===A.type||"tree"===A.type||Array.isArray(b))for(E in T=this.subjectsMapByPredValue[l][typeof b])y=T[E],R=A.object.toString(),E.substring(0,R.length)===R&&t.extend(f,y);else f=this.subjectsMapByPredValue[l][typeof A.object][b]||{};for(g in f)if(d[l][g]=1,m[g]||(m[g]=0),m[g]+=1,f[g].activityDetails){var j=f[g].activityDetails;if(j.length){W=!0;for(var k={},L=0;L<j.length;L++){if(j[L].indexOf("activity-")>=0)P[j[L]]||(P[j[L]]=0),P[j[L]]+=1;else if(j[L].indexOf("activityAfter-")>=0)P[z=j[L].replace("After","")]||(P[z]=0),P[z]+=1,k[z]||(k[z]=1);else if(j[L].indexOf("activityBefore-")>=0){var z;k[z=j[L].replace("Before","")]||(P[z]||(P[z]=0),P[z]+=1)}}}}f={}}(l.indexOf(e.ECM_CA_Proposed_Operation_Type)>=0||l.indexOf(e.ECM_CA_Realized_Tagger_Activity_Change)>=0)&&F++,u++}if(0===u)s=this.allSubjects,U=this.allActivitySubjects;else{for(g in m)m[g]>=u&&s.push(g);if(W)for(g in P)P[g]>=F&&U.push(g.replace("activity-",""));else U=this.allActivitySubjects}for(p={},r={},O=0,I=s.length;O<I;O++)for(g=s[O],S=this.allTags[g],r[g]=S,N=0,x=S.length;N<x;N++)c=(A=S[N]).sixw+A.field+A.object+typeof A.object,"string"!==(_=A.type)&&"integer"!==_&&"date"!==_&&"tree"!==_&&(_="string"),p[c]||(p[c]={object:A.object,sixw:A.sixw,field:A.field,dispValue:A.dispValue,count:0,type:_}),p[c].count+=1;for(l in V=function(e){return e.object===E},o)if("date"!==(h=o[l])[0].type)for(_ in this.subjectsMapByPredValue[l])for(E in this.subjectsMapByPredValue[l][_])if(f=this.subjectsMapByPredValue[l][_][E],!h.detect(V))for(g in f)-1===s.indexOf(g)&&!Object.keys(o).some(function(e){return e!==l&&!d[e][g]})&&(w=f[g].uri,a=f[g].field,p[c=l+a+w]||(p[c]={object:w,sixw:l,field:a,dispValue:f[g].dispValue,count:0,type:f[g].type}),p[c].count+=1,r[g]||(r[g]=[]),r[g].push(p[c]));for(c in C=[],p)v=p[c],C.push(v);if(this.taggerProxy&&this.taggerProxy.setTags(r,C),!n)switch(this.viewName){case"Team":this.dispatchEvent("onMembersTaggerProxyFilterChange",[s]);break;case"Proposed":this.dispatchEvent("onProposedTaggerProxyFilterChange",[s]);break;case"Realized":this.dispatchEvent("onRealizedTaggerProxyFilterChange",[s,U]);break;case"RealizedFlowdown":this.dispatchEvent("onRealizedFlowdownTaggerProxyFilterChange",[s,U]);break;case"Referential":this.dispatchEvent("onReferentalTaggerFilterChange",[s]);break;case"Context":this.dispatchEvent("onContextTaggerFilterChange",[s]);break;default:console.log("incorrect view selected")}return!1}}})}),define("DS/ENOChangeActionUX/scripts/Models/CATransRealDispModel",["UWA/Class/Model","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","UWA/Core","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgErrors"],function(e,t,i,n,o,a,s){"use strict";return e.extend({idAttribute:"id",setup:function(){},parse:function(e){this.set("canEdit",!0),this.set("caType",{displayValue:"Change Action",actualValue:e.defaultCATypeNLS}),this.set("reasonForChangeForActivity",{displayValue:t.ECM_CA_Realized_Transfer_Move,actualValue:"simple"});var i=e;if(this.set("canEdit",!0),this.set("mode",e.mode),UWA.is(i.id)){var n={};this.set("id",i.id),i.set("objectId",i.id),n.objectType=i.get("objectType")?i.get("objectType"):"",n.objectName=i.get("objectTitle"),n.objectRev=i.get("revision")?i.get("revision"):"",n.objectName=n.objectName+" "+n.objectRev,n.objectID=i.get("objectId")?i.get("objectId").replace("pid:",""):"",n.id="pid:"+n.objectID,n.maturity=i.get("maturity")?i.get("maturity"):"",n.policy=i.get("policy")?i.get("policy"):"",n.image={imageValue:i.get("icon")?i.get("icon"):""},this.set("objectName",n.objectName),this.set("changeaction",n)}},add:function(e,t,n){var o={id:"pid:"+t},a=this,s=t,r=[s];i.getAdditionObjectInfo(r).then(function(t){o.objectType=t.additionObjectInfo[s].type,o.objectName=t.additionObjectInfo[s].objectTitle,o.objectRev=t.additionObjectInfo[s].revision,o.objectName=o.objectName+" "+o.objectRev,o.objectID=t.additionObjectInfo[s].pid,o.id="pid:"+o.objectID,o.policy=t.additionObjectInfo[s].policy,o.image={imageValue:t.additionObjectInfo[s].icon};var i=a.get(e);UWA.is(i,"object")&&a.unset(e),a.set(e,o)},function(e){return console.log("Populate Security Context failed"),Promise.reject(e)})},remove:function(e,t,i){var n=this.get(e),o=this.get("reasonForChangeForActivity");UWA.is(n,"object")&&(this.unset("reasonForChangeForActivity",{silent:!0}),this.unset(e)),this.set("reasonForChangeForActivity",o)},proposedTypeAheadCallback:function(e,t,n){var r=t.trim()+"*",l=i.getCurrentModel(),c=l?l.get("id"):"",d="";""!=c&&(d="NOT (physicalid:"+(c=c.replace("pid:",""))+")");var p="";p=""!==d?'(flattenedtaxonomies:"types/Change Action")'+d+'AND (current:Prepare OR current:"In Work") AND (NOT flattenedtaxonomies:"interfaces/Change On Hold"':'(flattenedtaxonomies:"types/Change Action") AND (current:Prepare OR current:"In Work") AND (NOT flattenedtaxonomies:"interfaces/Change On Hold"',"*"!=r&&(p+=" AND "+r);var u={with_indexing_date:!0,with_nls:!1,label:"yus-1515078503005",locale:"en",select_predicate:["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:responsible","ds6wg:fullname"],select_file:["icon","thumbnail_2d"],query:p+=")",order_by:"desc",order_field:"relevance",nresults:1e3,start:"0",source:[],tenant:o.getGlobalVariable().tenant};u=JSON.stringify(u);a.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",u,function(e){if(e&&e.results){var t=e.results,i=[];Array.isArray(t)&&t.forEach(function(e){var t=e.attributes;if(Array.isArray(t)){var n="",o="",a="",s="",r="";t.forEach(function(e){e.name.indexOf("resourceid")>=0&&(n=e.value),e.name.indexOf("label")>=0&&(a=e.value),e.name.indexOf("identifier")>=0&&(o=e.value),e.name.indexOf("type_icon_url")>=0&&(s=e.value),void 0!==(r=a)&&""!==r||(r=o)}),i.push({value:n,label:r,image:s})}}),n(i)}},function(e,t){s.error(t.error.errorMessage),n([])},{isfederated:!0})}})}),define("DS/ENOChangeActionUX/scripts/Views/CACustomSwitchView",["UWA/Core","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/UIKIT/Input/Button","DS/UIKIT/Input/ButtonGroup","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e,t,i,n,o){"use strict";return t.extend({tagName:"div",domEvents:{},id:function(){return"CACustomSwitchView_"+this.cid},setup:function(e){this._parent.apply(this,arguments)},render:function(){this.container.empty(!0);var t=this;this.toggleDiv&&this.toggleDiv.destroy(),this.toggleDiv=e.createElement("div",{class:"proposed-toggle",html:[{tag:"h5",html:o.ECM_CA_Proposed_Object_Add,styles:{"margin-right":"10px"}}]}),(this.existingBtn||this.newBtn)&&(this.existingBtn&&this.existingBtn.destroy(),this.newBtn&&this.newBtn.destroy());var a=this.existingBtn=new i({value:o.ECM_CA_Proposed_Object_Add_Existing,id:"Existing",active:!0}),s=this.newBtn=new i({value:o.ECM_CA_Proposed_Object_Add_New,id:"New"});"TRUE"===t.model.get("createNewToggle")?(a.setClassName("small"),s.setClassName("primary small")):(a.setClassName("primary small"),s.setClassName("small"));var r=new n({type:"radio",name:"toggle-proposed",id:"toggle-proposed",buttons:[a,s],events:{onClick:function(e,t){this.dispatchEvent("onButtonClick",t)}}}),l=this.ButtonEvents={onButtonClick:function(e){"Existing"===e.getId()?t.model.set("createNewToggle","FALSE"):t.model.set("createNewToggle","TRUE")}};return this.listenTo(r,l),r.inject(this.toggleDiv),this.toggleDiv.inject(this.container),this},destroy:function(){this._parent.apply(this,arguments)}})}),define("DS/ENOChangeActionUX/scripts/CAWebInWinTaggerProxy",["DS/SNResultUX/webinwin/WebInWinTaggerProxy","UWA/Core","UWA/Class","UWA/Class/Debug","UWA/Class/Events"],function(e,t,i,n,o){"use strict";return e.extend(n,o,{_proxyId:"ChangeAction_Facet_",init:function(e){this._parent.call(this,e)},_dispatchEvent:function(e){if(!t.is(e,"object")||!t.is(e.notif_name)||void 0===e.notif_parameters)throw console.log("E_INVALIDARG, expect to have parameters.notif_name arg & parameters.notif_parameters in _dispathTowin !!!"),"No parameters.notif_name arg & parameters.notif_parameters given to _dispathTowin method !";console.log("ResultWebInWin._dispathTowin for "+e.notif_name);var i=t.is(e.notif_parameters,"string")?e.notif_parameters:JSON.stringify(e.notif_parameters);"undefined"!=typeof dscef?dscef.sendString(e.notif_name+"="+i):"undefined"!=typeof CATCefSendString&&CATCefSendString(e.notif_name+"="+i)}})}),define("DS/ENOChangeActionUX/scripts/Search",["DS/ENO6WPlugins/jQuery","UWA/Core","UWA/Utils/InterCom","UWA/Class/Model","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","require"],function(e,t,i,n,o,a){"use strict";var s=function(e,t){e&&e.precond&&(this.precond=e.precond),e&&e.excludeList&&(this.excludeList=e.excludeList),e&&"realized"===e.from&&(this.fromRealized=!0),this.socketName="search_socket_"+(new Date).getTime(),this.socket=new i.Socket(this.socketName,{dispatchRetryInterval:5}),this.socket.subscribeServer("SearchComServer"),this.listener=this.objectsSelected.bind(this),this.socket.addListener("Selected_Objects_search",this.listener);var n=this.options(e);t&&(n.idcard_activated=!0),this.socket.dispatchEvent("RegisterContext",n)};return s.prototype.destroy=function(){var e={};e.widget_id=widget?widget.id:null,this.socket.dispatchEvent("unregisterSearchContext",e),this.socket.unsubscribeServer("SearchComServer"),this.socket.removeListener("Selected_Objects_search",this.listener),this.socket.disconnect()},s.prototype.options=function(t,i,n,a,s,r){var l={multiSel:!1};return l.title=t.title,l.mode="furtive",l.app_socket_id=this.socketName,l.widget_id=widget?widget.id:null,l.default_with_precond=!0,l.show_precond=!1,l.idcard_activated=!1,l.select_result_max_idcard=!1,l.source=["3dspace"],l.tenant=o.getGlobalVariable().tenant,l.role=enoviaServer.role,t.types&&(l.precond="(",n=t.types.split(","),e.each(n,function(e,t){0!==e&&(l.precond+=" OR "),l.precond+='flattenedtaxonomies:"types/'+t.trim()+'"'}),l.precond+=")",t.excludedSearchTypes&&(l.precond+=t.excludedSearchTypes)),t.default_search_criteria&&(l.default_search_criteria=t.default_search_criteria),l},s.prototype.activate=function(e,i,n,r,l,c,d){var p=this;if(o.getGlobalVariable().isNative)if(!0===this.fromRealized){var u=a("DS/ENOChgServices/scripts/services/ChgNativeInitService");a("DS/ENOChangeActionUX/scripts/Views/CANewRealizedView")._tempReferenceToWinSearchCallback=e.callback;var h="SearchCA";u.DispatchEventToWin(h,p.precond)}else{u=a("DS/ENOChgServices/scripts/services/ChgNativeInitService");var m=a("DS/ENOChangeActionUX/scripts/Views/OperationForm");e&&e.callback&&(m.prototype._tempReferenceToWinSearchCallback=e.callback);h="Add_Proposed";u.DispatchEventToWin(h,"NewProposedChange")}else if(o.getGlobalVariable().is3DSpace){window.addEventListener("storage",function(e){if(e.storageArea===sessionStorage)if(null!=sessionStorage.searchList&&""!=sessionStorage.searchList){var t=sessionStorage.searchList.split(",");s._tempReferenceTo3DSpaceSearchCallback(t),sessionStorage.removeItem("searchList")}else console.log("inside EVENT ******************************************")});showChooser("../common/emxFullSearch.jsp?field=TYPES=type_ChangeAction:ECM_CHANGE_ONHOLD!=True:CURRENT=policy_ChangeAction.state_Prepare,policy_ChangeAction.state_InWork&table=AEFGeneralSearchResults&selection=single&formName=BCform&submitAction=refreshCaller&hideHeader=true&HelpMarker=emxhelpfullsearch&submitURL=../enterprisechangemgtapp/ECMWebSearchUtil.jsp?fromOperation=searchDependency",850,630),s._tempReferenceTo3DSpaceSearchCallback=e.callback}else{var g=this.options(e);t.is(e.callback,"function")||(g.mode="default"),e&&e.callback&&(this.callback=e.callback);var f={};f.widget_id=widget?widget.id:null,this.socket.dispatchEvent("unregisterSearchContext",f),this.socket.dispatchEvent("RegisterContext",g),this.socket.dispatchEvent("InContextSearch",g);p=this;this.socket.addListener("onCloseTransient",function(e){p.socket.dispatchEvent("UnregisterContext",{widget_id:f.widget_id})})}},s.prototype.isAvailable=function(){return t.is(this.socket)},s.prototype.objectsSelected=function(e){var t=[];if(this.callback){for(var i=0;i<e.length;i++){var o=new n(e[i]);t.push(o.get("id"))}this.callback(t)}},s}),define("DS/ENOChangeActionUX/scripts/Views/CASlideInTransferRealizedView",["UWA/Class/View","DS/PlatformAPI/PlatformAPI","DS/ENOChgRouter5/scripts/ChgRouter","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core"],function(e,t,i,n,o,a){"use strict";return e.extend({slideinContainer:"",skeletonContainer:"",invokedFrom:"",isSlideOpen:!1,setup:function(e){var t=this;if(UWA.is(e)&&(this.invokedFrom=e.invokedFrom),"gov"==this.invokedFrom){var n=i.getDependency("xChangeApp");i.getDependency("applicationChannel").subscribe({event:"triptych-panel-hidden"},function(e){"right"===e&&1==t.isSlideOpen&&t.hideSlideIn()});for(var o=n.infoPanel.childNodes,s=0;s<o.length;s++){var r=o[s].className;UWA.is(r)&&"secondmainContainer-sidepanel"===r?(o[s].empty(),this.slideinContainer=o[s],o[s].style.display="block"):o[s].style.display="none"}this.skeletonContainer=a.extendElement(document.body).getElement(".triptych-main")}else this.slideinContainer=a.extendElement(document.body).getElement("#slidein-container"),this.skeletonContainer=a.extendElement(document.body).getElement("#skeleton-container"),this.slideinContainer.innerHTML=""},render:function(){return this},buildSlideIn:function(e){if(UWA.is(this.slideinContainer)&&UWA.is(e)){this.form=e;var i=UWA.createElement("div",{id:"slideInContent",styles:{display:"table",height:"100%",width:"100%"}});i.setAttribute("data-rec-id","slideInContentCA"),this.getHeader().inject(i),this.getBody().inject(i),this.getFooter().inject(i),e.slideInReference=this,i.inject(this.slideinContainer);var n=this;widget.addEvent("onResize",function(){setTimeout(function(){n.slideinContainer.clientWidth>0&&(window.matchMedia("(max-width: 768px)").matches?n.slideinContainer.style.width="100%":n.slideinContainer.style.width="400px")},100)}),t.subscribe("ca-back-to-summary-hide-slidein",function(){n.hideSlideIn()})}},getHeader:function(){var e=this.form.getHeading(),t=UWA.createElement("div",{id:"slideInHeader",styles:{padding:"2px 14px",borderBottom:"1px solid #d1d4d4"},html:[{tag:"div",styles:{width:"100%",marginRight:"50px"},html:{tag:"h5",html:e}}]});return t.setAttribute("data-rec-id","slideInHeaderCA"),t},getFooter:function(){var e=UWA.createElement("div",{id:"slideInFooterRow",styles:{display:"flex",flexDirection:"row",justifyContent:"flex-end"},html:{tag:"div",html:this.form.getFooter()}});e.setAttribute("data-rec-id","slideInFooterRowCA");var t=UWA.createElement("div",{id:"slideInFooter",styles:{display:"table-footer-group"},html:e});return t.setAttribute("data-rec-id","slideInFooterCA"),t},getBody:function(){var e=UWA.createElement("div",{id:"slideInBody"});return e.setAttribute("data-rec-id","slideInBodyCA"),this.form.getBody().inject(e),e},showSlideIn:function(){UWA.is(this.slideinContainer)&&(window.matchMedia("(max-width: 768px)").matches?this.slideinContainer.style.width="100%":this.slideinContainer.style.width="400px",this.slideinContainer.style.borderLeftWidth="1px",this.skeletonContainer.style.opacity=".5",this.skeletonContainer.style.pointerEvents="none");if("gov"==this.invokedFrom){this.isSlideOpen=!0;var e=i.getDependency("applicationChannel");e.publish({event:"triptych-show-panel",data:"right"}),e.publish({event:"information-panel-visible",data:null})}},hideSlideIn:function(){(UWA.is(this.slideinContainer)&&(this.slideinContainer.innerHTML="",this.slideinContainer.style.width="0",this.slideinContainer.style.borderLeftWidth="0",this.skeletonContainer.style.opacity="1",this.skeletonContainer.style.pointerEvents="inherit",this.destroy()),"gov"==this.invokedFrom)&&(this.isSlideOpen=!1,i.getDependency("applicationChannel").publish({event:"triptych-hide-panel",data:"right"}))},destroy:function(){this.slideinContainer=null,this.skeletonContainer=null}})}),define("DS/ENOChangeActionUX/scripts/Views/CATeamFilterView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","UWA/Core","DS/Handlebars/Handlebars4"],function(e,t,i,n){return e.extend({name:"teamfilter",tagName:"div",className:"teamview",setup:function(){this.template='                                                <div class="'+this.getClassNames("-role-filter")+'">                                                    <table class="filter-table table">                                                        <tr >                                                            <td style="color: gray;">'+t.ECM_CA_Team_Filter_byName+'</td>                                                            <td>                                                                <div class="filter-input">                                                                    <input type="text" placeholder="'+t.ECM_CA_Team_SearchTeamMembers_PlaceHolder+'" class="form-control form-control-root filtertext">                                                                    <div class="clear-filter fonticon fonticon-cancel-circled"></div>                                                                </div>                                                            </td>                                                        </tr>                                                        <tr >                                                            <td style="color: gray;">'+t.ECM_CA_Team_Filter_byRoles+'</td>                                                            <td class="teamview-filter toggle-primary">                                                                <div class="toggle-container toggle-filter-view">                                                                    <div class="toggle toggle-root">                                                                        <input type="checkbox" value="option1" id="assigneeToggle" class="roleFilter">                                                                        <label class="control-label" for="assigneeToggle" style="color: gray;">'+t.ECM_CA_Team_Filter_Assignees+'</label>                                                                    </div>                                                                    <div class="toggle toggle-root">                                                                        <input type="checkbox" value="option1" id="revMemToggle" class="roleFilter">                                                                        <label class="control-label" for="revMemToggle" style="color: gray;">'+t.ECM_CA_Team_Filter_Reviewers+'</label>                                                                    </div>                                                                    <div class="toggle toggle-root">                                                                        <input type="checkbox" value="option1" id="followMemToggle" class="roleFilter">                                                                        <label class="control-label" for="followMemToggle" style="color: gray;">'+t.ECM_CA_Team_Filter_Followers+"</label>                                                                    </div>                                                                </div>                                                            </td>                                                        </tr>                                                    </table>                                                </div>",this.renderer=this.getTemplate(this.template)},init:function(e){e=i.clone(e||{},!1),this._parent.call(this,e)},render:function(){this.name,this.cid;this.container.empty(),containerReference=this.container;var e=UWA.createElement("div",{class:"teamview-role-filter",styles:{height:"10%","padding-bottom":"10px"}}),t=this.renderer();return e.addContent(t),e.inject(containerReference),this},injectSubView:function(e,t){var i=this.container.getElement(t);e&&i&&i.grab(e.render().getContent())},getTemplate:function(e){var t=n.compile(e),i=this;return i.data={placeholder:i.options.placeholder},function(){return t(i.data)}},domEvents:{"keyup .filtertext":function(e){var t=e.target.value,i=this.container.getElement(".clear-filter");t.length>0?i.setStyle("visibility","visible"):i.setStyle("visibility","hidden"),this.dispatchEvent("memberFilterKeyUp",arguments)},"click .clear-filter":function(e){this.container.getElement(".clear-filter").setStyle("visibility","hidden");var t=this.container.getElement(".filtertext");if(t){t.value=""}this.dispatchEvent("memberFilterKeyUp",{target:{value:""}})},"focus .filtertext":function(){var e=document.getElementsByClassName("searchfiler-input-container");e.addClassName("highlighted-border"),e.removeClassName("border-without-focus")},"click .roleFilter":function(){this.dispatchEvent("memberRoleFilter",arguments)}}})}),define("DS/ENOChangeActionUX/scripts/Services/CAContextDataGridViewToolbar",["i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e){"use strict";var t=Object.create(null);return t.toolbar=null,t.viewData={menu:[{type:"PushItem",title:e.CHG_CA_Pref_Grid_Label,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-view-list"},action:{module:"DS/ENOChangeActionUX/scripts/Views/CAContextDataGridLayout",func:"changeView"},tooltip:e.CHG_CA_Pref_Grid_Label},{type:"PushItem",title:e.CHG_CA_Pref_Tile_Label,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-view-small-tile"},action:{module:"DS/ENOChangeActionUX/scripts/Views/CAContextTileViewLayout",func:"changeView"},tooltip:e.CHG_CA_Pref_Tile_Label}]},t.writetoolbarDefination=function(){var t={entries:[{id:"ContextHeader",dataElements:{value:e.ECM_CA_Context_Counter_Title,typeRepresentation:"string"},readOnly:!0,category:"status",disabled:!0},{id:"addContext",className:"menu-context",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"plus",fontIconFamily:1}},position:"far",action:{module:"DS/ENOChangeActionUX/scripts/Views/CAContextDataGridLayout",func:"searchContext"},tooltip:e.ECM_CA_Add_Context,category:"addRemove"},{id:"removeContext",className:"menu-context unabledRemoveContext",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"trash",fontIconFamily:1}},position:"far",action:{module:"DS/ENOChangeActionUX/scripts/Views/CAContextDataGridLayout",func:"removeContext"},tooltip:e.ECM_CA_Remove_context,category:"addRemove"},{id:"view",dataElements:{typeRepresentation:"functionMenuIcon",icon:{iconName:"view-legacy-thb",fontIconFamily:1},value:this.viewData},position:"far",category:"View"}]};return JSON.stringify(t)},t}),define("DS/ENOChangeActionUX/scripts/Views/CAProposedSearchFilterView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/Handlebars/Handlebars4"],function(e,t,i,n,o){"use strict";return e.extend({name:"searchfilter",tagName:"div",className:"operations-filter",setup:function(){this.template='                                                <div class="'+this.getClassNames("-container")+'">                                                  <div class="'+this.getClassNames("-sub-container")+'">                                                    <div class="'+this.getClassNames("-input-container")+' border-without-focus">                                                      <input type="text" class="form-control form-control-root filtertext" placeholder="{{placeholder}}">                                                      <div class="clear-filter fonticon fonticon-cancel-circled"></div>                                                      <span class="search-span"><i id="filtersearch" class="fonticon fonticon-search"></i></span>                                                    </div>                                                  </div>                                                </div>',this.renderer=this.getTemplate(this.template)},init:function(e){e=n.clone(e||{},!1),this._parent.call(this,e)},render:function(){this.name,this.cid;this.container.empty();var e=this.container,t=UWA.createElement("div",{class:"search-main-container hidden",styles:{width:"99.5%",height:"10%"}});t.setAttribute("data-rec-id","search-main-container-CA");var i=this.renderer();return t.addContent(i),t.inject(e),this},injectSubView:function(e,t){var i=this.container.getElement(t);e&&i&&i.grab(e.render().getContent())},getTemplate:function(e){var t=o.compile(e),i=this;return i.data={placeholder:i.options.placeholder},function(){return t(i.data)}},domEvents:{"keyup .filtertext":function(e){var t=e.target.value,i=this.container.getElement(".clear-filter");t.length>0?i.setStyle("visibility","visible"):i.setStyle("visibility","hidden"),this.dispatchEvent("keyup",arguments)},"click .clear-filter":function(e){this.container.getElement(".clear-filter").setStyle("visibility","hidden");var t=this.container.getElement(".filtertext");if(t){t.value=""}this.dispatchEvent("keyup",{target:{value:""}})},"focus .filtertext":function(){var e=document.getElementsByClassName("searchfiler-input-container");e.addClassName("highlighted-border"),e.removeClassName("border-without-focus")}}})}),define("DS/ENOChangeActionUX/scripts/Views/CAProposedActivitiesView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/Handlebars/Handlebars4","DS/W3DXComponents/Views/Item/ActionsInlineView","DS/W3DXComponents/Collections/ActionsCollection","DS/W3DXComponents/Views/Item/MultiselView","DS/UIKIT/DropdownMenu","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices"],function(e,t,i,n,o,a,s,r,l,c){"use strict";o.registerHelper("getChangeMaturity",function(e,i){if(e){var n="";if(e===t.ECM_CA_Proposed_Activity_ChangeStatus){var o="";"Release"===i?o=t.ECM_CA_Proposed_Activity_State_Release:"Obsolete"===i?o=t.ECM_CA_Proposed_Activity_State_Obsolete:"Restore"===i&&(o=t.ECM_CA_Proposed_Activity_State_Restore),n='<span style="color:#B4B6BA;">'+t.ECM_CA_Proposed_ChangeMaturityTo+" </span>"+o}return n}}),o.registerHelper("getActivityName",function(e){if(e)return e===t.ECM_CA_Proposed_Activity_ChangeStatus&&(e=t.ECM_CA_Proposed_ActivityName_ChangeMaturity),e}),o.registerHelper("getReasonForChange",function(e){return e=e?'<span style="color:#B4B6BA;">'+t.ECM_CA_Proposed_Activity_Description+' :</span> <span title="'+e+'">'+e+"</span>":'<span style="color:#B4B6BA;">'+t.ECM_CA_Proposed_Activity_Description+" : </span>"});var d={selUnselAllContainer:null,selUnselMultisel:null,_createView_TestProposed:function(i,n,p){return e.extend({name:"proposedActivities",className:"proposed-activities-activities-holder",activityModel:n,activityIdx:p,setup:function(){this.template='                                            <div class="proposed-activities-container">                                                <div class="proposed-activities">                                                    <div class="activitues-header">                                                        <div class="activities-chevron icon-class" id="chevron-'+this.activityIdx+'">                                                            <div class="action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-expand-down" id={{@index}}></span></div>                                                        </div>                                                        <div class="'+this.getClassNames("-activities-counter")+'">                                                            <span class="'+this.getClassNames("-activities-title")+'">{{title}}</span>                                                            <span class="'+this.getClassNames("-activities-count")+'">{{activityNum}}</span>                                                        </div>                                                        <div class="'+this.getClassNames("-actions")+'"></div>                                                        <div class="'+this.getClassNames("-activitiesMultisel")+'"></div>                                                    </div>                                                    <div class="activity-content">                                                        {{#each activities}}                                                            <div class="activity-indivisual-container" id="act-indi-cont-{{@index}}">                                                            <div class="activity-indivisual" id="act-indi-{{@index}}">                                                                <div class="act-chk-container"><input type="checkbox" class="chkbox-act hidden" id="act-chk-{{@index}}"></div>                                                                <div class="activity-name" id="act-name-{{@index}}"> {{#getActivityName activityName}}{{/getActivityName}}</div>                                                                <div class="activity-change-status" id="act-change-status-{{@index}}">{{#getChangeMaturity activityName activityTargetState}}{{/getChangeMaturity}}</div>                                                                <div class="activity-desc activity-ellipsis-info-1" id="act-desc-{{@index}}">{{#getReasonForChange activityDesc}}{{/getReasonForChange}}</div>                                                              </div>                                                                <div class="activity-actions">                                                                    <div class="activity-action-container" id="activity-action-container-{{@index}}">                                                                        <div class="action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-down-open"></span></div>                                                                    </div>                                                                </div>                                                            </div>                                                        {{/each}}                                                    <div>                                                </div>                                                </div>',this._initActionsView(),this._initMultiSelView(),this.renderer=this.getTemplate(this.template,this.activityModel)},render:function(){this.container.empty();var e=i?widget.body:this.container,t=UWA.createElement("div",{class:"main-proposed-activities-container"});t.setAttribute("data-rec-id","main-proposed-activities-container-CA");var n=this.renderer();t.addContent(n),t.inject(e),this.data.activities.length>0&&"Restore"!=this.data.activities[0].activityTargetState?this.injectSubView(this.actionsView,"."+this.name+"-actions"):0==this.data.activities.length&&this.injectSubView(this.actionsView,"."+this.name+"-actions"),this.injectSubView(this.proposedMultiSelView,"."+this.name+"-activitiesMultisel");for(var o=this.data.activityNum,a=this,s=0;s<o;s++){var r=this.container.getElement("#activity-action-container-"+s);if(r){r.addEvent("click",function(e){var t=e.currentTarget.id.split("-")[3];t=parseInt(t),a._initDropDown(this,a.data.activities[t])})}}return d.container=a,this.activitiesToRemove=[],this.selectedActivityItems=[],this},_initActionsView:function(){var e=[],i={id:"add",title:t.ECM_CA_Proposed_Add_Activity,icon:"plus",overflow:!1},n={id:"selectAll",title:t.SelectAll,icon:"select-all",overflow:!1},o={id:"unSelectAll",title:t.UnSelectAll,icon:"select-none",overflow:!1};e.push(n),e.push(o);var r=!0,l=c.getCurrentModel();if(UWA.is(l)&&UWA.is(l.get("userAccess"))){var p=l.get("userAccess");(p&&p.AddProposed&&"false"===p.AddProposed||!p.AddProposed)&&(r=!1)}r&&e.unshift(i);var u=new s(e);this.actionsView=new a({collection:u});var h=this,m=this._actionsViewEvents={onActionClick:function(){d.selUnselAllContainer=this.container,d.selUnselMultisel=this.proposedMultiSelView,h.dispatchEvent("onActionClickActivities",arguments)}};this.listenTo(this.actionsView,m)},_initMultiSelView:function(){var e=this,i={collection:new s,withMultisel:!0,useInfiniteScroll:!1,usePullToRefresh:!1,buildMultiselActions:function(i){var n=!0,o=c.getCurrentModel();if(UWA.is(o)&&UWA.is(o.get("userAccess"))){var a=o.get("userAccess");(a&&a.DeleteProposed&&"false"===a.DeleteProposed||!a.DeleteProposed)&&(n=!1)}var s=[],r={id:"remove",text:t.ECM_CA_Referential_MultiSelActions_Remove,fonticon:"trash",icon:"I_ChangeCnxObjTrash",multisel:!0,handler:function(t){e.dispatchEvent("removeMultiSelActvities",[t])}};return n&&s.push(r),s},events:{onMultiselOff:function(){d.container=e.container;for(var t=e.container.getElements(".activity-indivisual-container"),i=0;i<t.length;i++)t[i].removeClassName("selected-border");e.selectedActivityItems.length=0,e.activitiesToRemove.length=0,d.deactivateMultisel(e.container)},onMultiselOn:function(){d.container=e.container,d.activateMultisel(e.container)}}};d.multiSelView=this.proposedMultiSelView=new r(i)},_initDropDown:function(e,i){var n=this,o=[],a={text:t.ECM_CA_Action_Edit,icon:"fonticon fonticon-pencil",handler:function(t){t.preventDefault(),n.dispatchEvent("editActivity",[e,i,arguments[0]])}},s={text:t.ECM_CA_Referential_MultiSelActions_Remove,fonticon:"trash",icon:"I_ChangeCnxObjTrash",handler:function(t){t.preventDefault(),n.dispatchEvent("deleteActivity",[e,i,arguments[0]])}},r=!0,d=c.getCurrentModel();UWA.is(d)&&UWA.is(d.get("userAccess"))&&(((p=d.get("userAccess"))&&p.DeleteProposed&&"false"===p.DeleteProposed||!p.DeleteProposed)&&(r=!1));var p,u=!0;UWA.is(d)&&UWA.is(d.get("userAccess"))&&(((p=d.get("userAccess"))&&p.AddProposed&&"false"===p.AddProposed||!p.AddProposed)&&(u=!1));(r||u)&&(o.push(a),o.push(s)),this.dropDown?(this.dropDown.destroy(),this.dropDown=null):(this.dropDown=new l({target:e,items:o}),this.dropDown.show())},injectSubView:function(e,t){var i=this.container.getElement(t);e&&i&&i.grab(e.render().getContent())},getTemplate:function(e,i){var n=o.compile(e),a=[];i.forEach(function(e){var t={};t.activityName=e.get("activityName"),t.activityDesc=e.get("activityDesc"),t.activityTargetState=e.get("targetState"),t.objectId=e.get("objectId"),t.id=e.get("id"),t.activityActual=e.get("activityActual"),a.push(t)}),this.data={activityNum:a.length,title:t.ECM_CA_Proposed_Change_Activities_Label,activities:a};var s=this;return function(){return n(s.data)}},domEvents:{"click .activities-chevron":function(e){e.target.id;var t=e.target.className;t.indexOf("expand-right")>0?e.target.className=t.replace("right","down").trim():t.indexOf("expand-down")>0&&(e.target.className=t.replace("down","right").trim());var i=this.container.getElement(".activity-content");i.hasClassName("hidden")?i.removeClassName("hidden"):i.addClassName("hidden")},"click .activity-indivisual":function(e){},"click .chkbox-act":function(e){e.target;var t=e.target.id.split("-"),i=t[t.length-1],n=parseInt(i),o=this.activityModel.at(n),a=this.container.getElement("#act-indi-cont-"+i);a.hasClassName("selected-border")?a.removeClassName("selected-border"):a.addClassName("selected-border");var s=this.selectedActivityItems.indexOf(o.cid);if(-1===s?(this.selectedActivityItems.push(o.cid),this.activitiesToRemove.push(o),d.activateMultisel(this.container)):(this.selectedActivityItems.splice(s,1),this.activitiesToRemove.splice(s,1),0===this.activitiesToRemove.length&&d.deactivateMultisel(this.container)),this.proposedMultiSelView){var r={isActive:!0};r.selectedObjects=this.activitiesToRemove,this.proposedMultiSelView.buildMultisel(r)}}}})},deactivateMultisel:function(e){e.getElements(".activity-action-container").forEach(function(e){e.removeClassName("hidden")}),e.getElements(".chkbox-act").forEach(function(e){e.checked&&(e.checked=!1),e.addClassName("hidden")})},activateMultisel:function(e){e.getElements(".activity-action-container").forEach(function(e){e.addClassName("hidden")}),e.getElements(".chkbox-act").forEach(function(e){e.removeClassName("hidden")})},selectAll:function(){var e=d.selUnselAllContainer;if(e){d.activateMultisel(e);for(var t=e.getElements(".chkbox-act"),i=0;i<t.length;i++){var n=t[i];n.checked||n.click()}}},unselectAll:function(){d.selUnselMultisel&&(d.selUnselMultisel.exitMultisel(),d.selUnselMultisel.dispatchEvent("onMultiselOff",[d.selUnselMultisel,!1]))},resizeActivites:function(e){}};return d}),define("DS/ENOChangeActionUX/scripts/Views/CAHeaderTemplate",["UWA/Core","DS/Handlebars/Handlebars","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable"],function(e,t,i,n){"use strict";var o={getTemplate:function(t){var i=t.caModel,n=t.isApplicability,a=t.isDependency,s=t.isGroup,r=t.attachmentCount,l=t.flowdownDependencyCount,c=e.extendElement(document.body).getElement(".owner-name-section").clientWidth;return c>600?o.getThreeRowsTemplate(i,n,a,s,r,l):c<600&&c>375?o.getTwoRowsTemplate(i,n,a,s,r,l):o.getSingleRowsTemplate(i,n,a,s,r,l)},getThreeRowsTemplate:function(e,t,n,a,s,r){var l='                    <div class="owner-section-id-card">                        <table>                            <tr>                                <td>                                    {{#if transnferAllowed}}<div class="ca-header-options"><label>'+i.ECM_CA_Owner_TAG+'</label> <a class="cursorPointer" id="transfer-owner" title="'+e.get("ownerDisplayName")+'">'+e.get("ownerDisplayName")+'</a></div>                                    {{else}}<div class="ca-header-options"><label>'+i.ECM_CA_Owner_TAG+'</label> <text title="'+e.get("ownerDisplayName")+'">'+e.get("ownerDisplayName")+'</text></div>                                    {{/if}}                                </td>                                <td>                                    {{#if transnferAllowed}}<div class="ca-header-options"><label>'+i.ECM_CA_COLLABSPACE_TAG+' :</label> <a class="cursorPointer" id="change-collab-space" title="'+e.get("project_space_title")+'">'+e.get("project_space_title")+'</a></div>                                    {{else}}<div class="ca-header-options"><label>'+i.ECM_CA_COLLABSPACE_TAG+'</label> <text title="'+e.get("project_space_title")+'">'+e.get("project_space_title")+'</text></div>                                    {{/if}}                                </td>                                <td>                                    {{#if transnferAllowed}}<div class="ca-header-options"><label>'+i.ECM_CA_ORGANIZATION_TAG+'</label> <a class="cursorPointer" id="change-org" title="'+e.get("organization_title")+'">'+e.get("organization_title")+'</a></div>                                    {{else}}<div class="ca-header-options"><label>'+i.ECM_CA_ORGANIZATION_TAG+'</label> <text title="'+e.get("organization_title")+'">'+e.get("organization_title")+'</text></div>                                    {{/if}}                                </td>                            </tr>                            <tr>                                <td>                                    <div class="ca-header-options"><label>'+i.ECM_CA_APPLICABILITY_TAG+'</label> <a class="cursorPointer" id="applicability-launch" title="'+t+'">'+t+'</a></div>                                </td>                                <td>                                    <div class="ca-header-options"><label>'+i.ECM_CA_DEPENDENCY_TAG+'</label> <a class="cursorPointer" id="dependency-launch" title="'+n+'">'+n+'</a></div>                                </td>                                <td>                                    {{#if coallowed}}<div class="ca-header-options"><label>'+i.ECM_CA_GOVERNING_CO+'</label> <a class="cursorPointer" id="chg-order-launch" title="'+e.get("changeOrderName")+'">'+e.get("changeOrderName")+'</a></div>                                    {{else}}<div class="ca-header-options"><label>'+i.ECM_CA_GOVERNING_CO+'</label> <text title="'+e.get("changeOrderName")+'">'+e.get("changeOrderName")+'</text></div>                                    {{/if}}                                </td>                            </tr>                            <tr>                            {{#if enableAttachment}}                            <td>\t\t\t\t\t\t\t\t<div class="ca-header-options"><label>'+i.ECM_CA_ATTACHMENT_TAG+'</label> <a class="cursorPointer" id="attachment-launch" title="'+s+'">'+s+'</a></div>\t\t\t\t\t\t\t</td>                            {{/if}}                            {{#if enableGroup}}                            <td>                                <div class="ca-header-options ca-header-group"><div class="ca-header-group"><label>'+i.ECM_CA_CREATE_GROUP_TAG+'</label> <a class="cursorPointer groupPadding" id="caCreateGroup-launch">'+a+'</a><div id="groupEditDiv" class ="deActiveContainer"></div></div></div>                            </td>                            {{/if}}                            {{#if enableFlowdown}}                            <td>                                <div class="ca-header-options"><label>'+i.ECM_CA_FLOWDOWN_TAG+'</label> <a class="cursorPointer" id="flowdown-launch" title="'+r+'">'+r+"</a></div>                            </td>                            {{/if}}                            </tr>                        </table>                    </div>";return o.getModelForTemplate(l,e,r)()},getTwoRowsTemplate:function(e,t,n,a,s,r){var l='                    <div class="owner-section-id-card">                        <table>                            <tr>                                <td>                                    {{#if transnferAllowed}}<div class="ca-header-options"><label>'+i.ECM_CA_Owner_TAG+'</label> <a class="cursorPointer" id="transfer-owner" title="'+e.get("ownerDisplayName")+'">'+e.get("ownerDisplayName")+'</a></div>                                    {{else}}<div class="ca-header-options"><label>'+i.ECM_CA_Owner_TAG+'</label> <text title="'+e.get("ownerDisplayName")+'">'+e.get("ownerDisplayName")+'</text></div>                                    {{/if}}                                </td>                                <td>                                    {{#if transnferAllowed}}<div class="ca-header-options"><label>'+i.ECM_CA_COLLABSPACE_TAG+' :</label> <a class="cursorPointer" id="change-collab-space" title="'+e.get("project_space_title")+'">'+e.get("project_space_title")+'</a></div>                                    {{else}}<div class="ca-header-options"><label>'+i.ECM_CA_COLLABSPACE_TAG+'</label> <text title="'+e.get("project_space_title")+'">'+e.get("project_space_title")+'</text></div>                                    {{/if}}                                </td>                            </tr>                            <tr>                                <td>                                    {{#if transnferAllowed}}<div class="ca-header-options"><label>'+i.ECM_CA_ORGANIZATION_TAG+'</label> <a class="cursorPointer" id="change-org" title="'+e.get("organization_title")+'">'+e.get("organization_title")+'</a></div>                                    {{else}}<div class="ca-header-options"><label>'+i.ECM_CA_ORGANIZATION_TAG+'</label> <text title="'+e.get("organization_title")+'">'+e.get("organization_title")+'</text></div>                                    {{/if}}                                </td>                                <td>                                    <div class="ca-header-options"><label>'+i.ECM_CA_APPLICABILITY_TAG+'</label> <a class="cursorPointer" id="applicability-launch" title="'+t+'">'+t+'</a></div>                                </td>                            </tr>                            <tr>                                <td>                                    <div class="ca-header-options"><label>'+i.ECM_CA_DEPENDENCY_TAG+'</label> <a class="cursorPointer" id="dependency-launch" title="'+n+'">'+n+'</a></div>                                </td>                                <td>                                    {{#if coallowed}}<div class="ca-header-options"><label>'+i.ECM_CA_GOVERNING_CO+'</label> <a class="cursorPointer" id="chg-order-launch" title="'+e.get("changeOrderName")+'">'+e.get("changeOrderName")+'</a></div>                                    {{else}}<div class="ca-header-options"><label>'+i.ECM_CA_GOVERNING_CO+'</label> <text title="'+e.get("changeOrderName")+'">'+e.get("changeOrderName")+'</text></div>                                    {{/if}}                                </td>                            </tr>                            <tr>                            {{#if enableAttachment}}                            <td>\t\t\t\t\t\t\t\t<div class="ca-header-options"><label>'+i.ECM_CA_ATTACHMENT_TAG+'</label> <a class="cursorPointer" id="attachment-launch" title="'+s+'">'+s+'</a></div>\t\t\t\t\t\t\t</td>                            {{/if}}                            {{#if enableGroup}}                            <td>                                <div class="ca-header-options"><label>'+i.ECM_CA_CREATE_GROUP_TAG+'</label> <a class="cursorPointer" id="caCreateGroup-launch" title="'+a+'">'+a+'</a></div>                            </td>                            {{/if}}                            {{#if enableFlowdown}}                            <td>                                <div class="ca-header-options"><label>'+i.ECM_CA_FLOWDOWN_TAG+'</label> <a class="cursorPointer" id="flowdown-launch" title="'+r+'">'+r+"</a></div>                            </td>                            {{/if}}                            </tr>                        </table>                    </div>";return o.getModelForTemplate(l,e,r)()},getSingleRowsTemplate:function(e,t,n,a,s,r){var l='                    <div class="owner-section-id-card">                        <table>                            <tr>                                <td>                                    {{#if transnferAllowed}}<div class="ca-header-options"><label>'+i.ECM_CA_Owner_TAG+'</label> <a class="cursorPointer" id="transfer-owner" title="'+e.get("ownerDisplayName")+'">'+e.get("ownerDisplayName")+'</a></div>                                    {{else}}<div class="ca-header-options"><label>'+i.ECM_CA_Owner_TAG+'</label> <text title="'+e.get("ownerDisplayName")+'">'+e.get("ownerDisplayName")+'</text></div>                                    {{/if}}                                </td>                            </tr>                            <tr>                                <td>                                    <div class="ca-header-options"><label>'+i.ECM_CA_APPLICABILITY_TAG+'</label> <a class="cursorPointer" id="applicability-launch" title="'+t+'">'+t+'</a></div>                                </td>                            </tr>                            <tr>                                <td>                                    <div class="ca-header-options"><label>'+i.ECM_CA_DEPENDENCY_TAG+'</label> <a class="cursorPointer" id="dependency-launch" title="'+n+'">'+n+'</a></div>                                </td>                            </tr>                            <tr>                                <td>                                    {{#if coallowed}}<div class="ca-header-options"><label>'+i.ECM_CA_GOVERNING_CO+'</label> <a class="cursorPointer" id="chg-order-launch" title="'+e.get("changeOrderName")+'">'+e.get("changeOrderName")+'</a></div>                                    {{else}}<div class="ca-header-options"><label>'+i.ECM_CA_GOVERNING_CO+'</label> <text title="'+e.get("changeOrderName")+'">'+e.get("changeOrderName")+'</text></div>                                    {{/if}}                                </td>                            </tr>                            {{#if enableAttachment}}                            <tr>                                <td>                                    <div class="ca-header-options"><label>'+i.ECM_CA_ATTACHMENT_TAG+'</label> <a class="cursorPointer" id="attachment-launch" title="'+s+'">'+s+'</a></div>                                </td>                            </tr>                            {{/if}}                            {{#if enableGroup}}                            <tr>                                <td>                                    <div class="ca-header-options"><label>'+i.ECM_CA_CREATE_GROUP_TAG+'</label> <a class="cursorPointer" id="caCreateGroup-launch" title="'+a+'">'+a+'</a></div>                                </td>                            </tr>                            {{/if}}                            {{#if enableFlowdown}}                            <td>                                <div class="ca-header-options"><label>'+i.ECM_CA_FLOWDOWN_TAG+'</label> <a class="cursorPointer" id="flowdown-launch" title="'+r+'">'+r+"</a></div>                            </td>                            {{/if}}                        </table>                    </div>";return o.getModelForTemplate(l,e,r)()},getModelForTemplate:function(e,i,o){var a=t.compile(e),s=i.get("userAccess"),r=!1,l=!1,c=!1;null!=s&&(r="true"===s.AddCO,l="true"===s.Transfer);"true"===n.getGlobalVariable().CHG_CHANGE_GROUP&&(c=!0);var d={coallowed:r,transnferAllowed:l,enableGroup:c,enableAttachment:"true"!=n.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT,enableFlowdown:o>0};return function(){return a(d)}}};return o}),define("DS/ENOChangeActionUX/scripts/Views/CAAttachmentView",["DS/PlatformAPI/PlatformAPI","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable"],function(e,t,i){"use strict";var n={create:function(e){var t=this,o={};o=UWA.merge(o,e),require(["DS/ENOXAttachmentsUX/AttachmentsPane"],function(e){t.id=o.caPhysicalId.slice(4);for(var a=i.getGlobalVariable(),s=a.referentialsSearchForbiddenType.split(","),r=(a.referentialsSearchType.split(","),a.tenantMappings),l=[],c=0;c<r.length;c++)a.tenant==r[c].platformId&&(l=r[c]);n.attachmentsPane=new e({parentObject:{parentId:t.id,relationName:"Related Item"},connectorOptions:{fetchSecurityContext:function(){return a.getSecurityContext()},platformUrls:l},supportedTypes:{excludedTypes:s,includedTypes:["*"]}}),t.modelEvents=n.attachmentsPane.modelEvents,t.subscribeToEvents(),n.attachmentsPane.inject(o.target)})},subscribeToEvents:function(){var o=this;o.modelEvents.subscribe({event:"attach-attachment-complete"},function(t){console.log("attached.....!");var i=t.document.dataelements;i.id=t.document.id;var n={attached:[]};n.attached.push(i);t={id:o.id,referentials:n};e.publish("ca-update-attachment-complete",t)}),o.modelEvents.subscribe({event:"upload-attachment-complete"},function(t){console.log("uploaded.....!");for(var i={attached:[]},n=0;n<t.documents.length;n++){var a=t.documents[n].dataelements;a.id=t.documents[n].id,i.attached.push(a)}t={id:o.id,referentials:i};e.publish("ca-update-attachment-complete",t)}),o.modelEvents.subscribe({event:"detach-attachment-complete"},function(t){console.log("detached.....!");var i={};i.detached=t.id;t={id:o.id,referentials:i};e.publish("ca-update-attachment-complete",t)}),o.modelEvents.subscribe({event:"user-clicks-attach"},function(e){if(console.log("user-clicks-attach.....!"),i.getGlobalVariable().isNative){t.DispatchEventToWin("Add_Attachment","Attachment")}}),o.modelEvents.subscribe({event:"context-menu-requested"},function(e){if(console.log("context-menu-requested.....!"),i.getGlobalVariable().isNative)var o=e.data[0].id;n.contextMenu=e.contextMenu,t.DispatchEventToWin("Referential_ContextMenu",o)})},OnSearchComplete:function(e){for(var t=e.split(","),i=[],o=0;o<t.length;o++)i.push(t[o]);n.attachmentsPane.attachAttachments(i)},DisplayContextMenu:function(e){console.log("CAAttachmentView: DisplayContextMenu.....!");for(var t=0;t<e.length;t++)n.contextMenu.addItem(e[t])}};return n}),define("DS/ENOChangeActionUX/scripts/Controller/CADependencyGridController",["UWA/Core","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/Core/Core","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/UIKIT/SuperModal","UWA/Class","DS/PlatformAPI/PlatformAPI","DS/i3DXCompassPlatformServices/OpenWith","DS/CollectionView/CollectionViewStatusBar","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgDependencyServices","DS/ENOChgServices/scripts/services/ChgPropertiesServices","DS/ENOChgServices/scripts/services/ChgDataProcess","DS/UIKIT/Input/Text","DS/UIKIT/Input/Button","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/UIKIT/DropdownMenu","DS/UIKIT/Dropdown","DS/ENOChgServices/scripts/services/ChgDataService","DS/ENOChgServices/scripts/services/ChgInfraService","require"],function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v,A,w,b,S){"use strict";var y={dependencyElem:{},dependencyType:null,setCADependencyModel:function(e){y.caDependencyModel=e},buildUpstreamDependencyModel:function(e,i,n,o){return e&&e.forEach(function(n){if(n&&n.id===i){var o={};o.id=n.id,o.state=n.current,o.stateNLS=n.currentNLS,o.dueDate=n.duedate,o.responsible=n.owner,o.responsibleFullName=n.ownerFullName,o.name=n.name,o.title=n.title,o.type=n.type,o.dependencyLinks=[],o.chgDecompose=[],o.codependencyLinks=[],o.stacking=[],Array.isArray(n.prereq)&&n.prereq.length>0&&n.prereq.forEach(function(i){var n={};n.linkId=i.id,n.toID=i.toId,n.consumed=i.consumed,e.forEach(function(e){e.id===i.toId&&(n.id=e.id,n.state=e.current,n.stateNLS=e.currentNLS,n.dueDate=e.duedate,n.responsible=e.owner,n.responsibleFullName=e.ownerFullName,n.name=e.name,n.title=e.title,n.type=e.type,n.dependencyType=t.ECM_CA_Depend_Label_New,n.dependencyValueType="Dependency")}),o.dependencyLinks.push(n)}),Array.isArray(n.coreq)&&n.coreq.length>0&&n.coreq.forEach(function(n){var a={};a.linkId=n.id,a.toID=n.toId,a.consumed=n.consumed,e.forEach(function(e){e.id===n.toId&&(a.id=e.id,a.state=e.current,a.stateNLS=e.currentNLS,a.dueDate=e.duedate,a.responsible=e.owner,a.responsibleFullName=e.ownerFullName,a.name=e.name,a.title=e.title,a.type=e.type,a.dependencyType=t.ECM_CA_CO_Depend_Label,a.dependencyValueType="Co-Dependency")}),y.caDependencyModel?a.id!=y.caDependencyModel.get("caId")&&a.id!=i&&o.dependencyLinks.push(a):o.dependencyLinks.push(a)}),Array.isArray(n.flowdownFrom)&&n.flowdownFrom.length>0&&n.flowdownFrom.forEach(function(i){var n={};n.linkId=i.id,n.toID=i.toId,n.consumed=i.consumed,e.forEach(function(e){e.id===i.toId&&(n.id=e.id,n.state=e.current,n.stateNLS=e.currentNLS,n.dueDate=e.duedate,n.responsible=e.owner,n.responsibleFullName=e.ownerFullName,n.name=e.name,n.title=e.title,n.type=e.type,n.dependencyType=t.ECM_CA_FLOW_Depend_Label,n.dependencyValueType="Flowdown")}),o.dependencyLinks.push(n)}),Array.isArray(n.group)&&n.group.length>0&&"true"==d.getGlobalVariable().CHG_CHANGE_GROUP&&n.group.forEach(function(i){var n={};n.linkId=i.id,n.toID=i.toId,n.consumed=i.consumed,e.forEach(function(e){e.id===i.toId&&(n.id=e.id,n.state=e.current,n.stateNLS=e.currentNLS,n.dueDate=e.duedate,n.responsible=e.owner,n.responsibleFullName=e.ownerFullName,n.name=e.name,n.title=e.title,n.type=e.type,n.dependencyType=t.ECM_CA_Group_Dependency,n.dependencyValueType="Group Dependency")}),o.dependencyLinks.push(n)}),y.dependencyElem=o}}),y.dependencyElem},buildDownstreamDependencyModel:function(e,i,n,o){return e&&e.forEach(function(n){if(n&&n.id===i){var o={};o.id=n.id,o.state=n.current,o.stateNLS=n.currentNLS,o.dueDate=n.duedate,o.responsible=n.owner,o.responsibleFullName=n.ownerFullName,o.name=n.name,o.title=n.title,o.type=n.type,o.dependencyLinks=[],o.chgDecompose=[],o.codependencyLinks=[],o.stacking=[],e.forEach(function(e){if(e&&e.id!==i){if(Array.isArray(e.prereq)&&e.prereq.length>0){var a=e;e.prereq.forEach(function(e){if(e.toId===i){var s={};s.linkId=e.id,s.toID=e.toId,s.consumed=e.consumed,s.id=a.id,s.state=a.current,s.stateNLS=a.currentNLS,s.dueDate=a.duedate,s.responsible=a.owner,s.responsibleFullName=n.ownerFullName,s.name=a.name,s.title=a.title,s.type=a.type,s.dependencyType=t.ECM_CA_Depend_Label_New,s.dependencyValueType="Dependency",o.dependencyLinks.push(s)}})}if(Array.isArray(e.flowdownFrom)&&e.flowdownFrom.length>0){a=e;e.flowdownFrom.forEach(function(e){if(e.toId===i){var n={};n.linkId=e.id,n.toID=e.toId,n.consumed=e.consumed,n.id=a.id,n.state=a.current,n.stateNLS=a.currentNLS,n.dueDate=a.duedate,n.responsible=a.owner,n.responsibleFullName=a.ownerFullName,n.name=a.name,n.title=a.title,n.type=a.type,n.dependencyType=t.ECM_CA_FLOW_Depend_Label,n.dependencyValueType="Flowdown",o.dependencyLinks.push(n)}})}Array.isArray(e.group)&&e.group.length>0&&"true"==d.getGlobalVariable().CHG_CHANGE_GROUP&&e.group.forEach(function(n){var a=e;if(n.toId===i){var s={};s.linkId=n.id,s.toID=n.toId,s.consumed=n.consumed,s.id=a.id,s.state=a.current,s.stateNLS=a.currentNLS,s.dueDate=a.duedate,s.responsible=a.owner,s.responsibleFullName=a.ownerFullName,s.name=a.name,s.title=a.title,s.type=a.type,s.dependencyType=t.ECM_CA_Group_Dependency,s.dependencyValueType="Group Dependency",o.dependencyLinks.push(s)}})}}),Array.isArray(n.coreq)&&n.coreq.length>0&&n.coreq.forEach(function(n){var a={};a.linkId=n.id,a.toID=n.toId,a.consumed=n.consumed,e.forEach(function(e){e.id===n.toId&&(a.id=e.id,a.state=e.current,a.stateNLS=e.currentNLS,a.dueDate=e.duedate,a.responsible=e.owner,a.responsibleFullName=e.ownerFullName,a.name=e.name,a.title=e.title,a.type=e.type,a.dependencyType=t.ECM_CA_CO_Depend_Label,a.dependencyValueType="Co-Dependency")}),y.caDependencyModel?a.id!=y.caDependencyModel.get("caId")&&a.id!=i&&o.dependencyLinks.push(a):o.dependencyLinks.push(a)}),y.dependencyElem=o}}),y.dependencyElem},getTreeModelForDataGridView:function(){var e=new n({useAsyncPreExpand:!0}),t=null;return(t="Downstream"==y.caDependencyModel.get("stream")?y.caDependencyModel.get("downstreamDependencyObjects"):y.caDependencyModel.get("upstreamDependencyObjects"))&&t.dependencyLinks&&0===t.dependencyLinks.length||t&&t.dependencyLinks&&t.dependencyLinks.forEach(function(t){var i=y.createTreeNodeModel(t);e.addRoot(i)}),e},getChildNodesOfTarget:function(e){y.caDependencyModel.getTargetDependencies(e.options.data.objectId),r.subscribe("dependency:ChildNodes:ready"+widget.id,function(){var t=[],i=null;(i="Downstream"==y.caDependencyModel.get("stream")?y.caDependencyModel.get("downstreamChildNodes"):y.caDependencyModel.get("upstreamChildNodes"))&&i.dependencyLinks&&0===i.dependencyLinks.length||i&&i.dependencyLinks&&i.dependencyLinks.forEach(function(i){if(e.getParent().options.resourceid!=i.id){var n=y.createTreeNodeModel(i);t.push(n)}}),e.addChild(t),e.preExpandDone(),r.unsubscribe("dependency:ChildNodes:ready"+widget.id)})},createTreeNodeModel:function(e){var t=e.title,i=d.getGlobalVariable();const n=d.getGlobalVariable().changeActionSubTypes.map(e=>e.value);var a,s=e.dependencyType;a="Dependency"===e.dependencyValueType?"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-dependency":"Co-Dependency"===e.dependencyValueType?"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-codependency":"Group Dependency"===e.dependencyValueType?"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-group-add":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-down";var r=new UWA.Element("i",{id:"dependencyTypeIconDiv",class:"contextMenuImages "+a+" dependencyFontIconCustom",title:s}),l={id:e.responsible,fullName:e.responsibleFullName},c=h.createCustomOwnerField(l),p={name:e.name+r.outerHTML,maturity:e.stateNLS,owner:c,dependency:e.dependencyType,dependencyValueType:e.dependencyValueType};return""!=e.dueDate&&(e.dueDate=new UWA.Date(e.dueDate).strftime("%Y-%m-%d"),p.dueDate=e.dueDate),new o({label:t,children:[],icons:function(e){var t=[];return"Change Action"===e.type?t.push(i.baseURL+"/common/images/iconSmallChangeAction.png"):n.includes(e.type)?t.push(i.baseURL+`/common/images/iconSmall${e.type}.png`):"Change Order"===e.type&&t.push(i.baseURL+"/common/images/iconSmallChangeOrder.png"),t}(e),badges:function(e){var t={};return!0===e.consumed&&"Flowdown"!=e.dependencyValueType?t.bottomRight="http://upload.wikimedia.org/wikipedia/commons/0/00/Lock_icon_blue.gif":t.bottomRight="",t}(e),grid:p,data:{modelID:e.id,objectId:e.id,objectType:e.type,displayName:t,displayType:e.type,dependencyType:e.dependencyType,dependencyValueType:e.dependencyValueType,fullName:e.responsibleFullName,caName:e.name},resourceid:e.id,linkid:e.linkId,useAsyncPreExpand:!0})},showRMBMenu:function(e,i){return new Promise(function(e,n){var o=S("DS/ENOChgServices/scripts/services/ChgIDCardCommonServices"),a=y.caDependencyModel.get("userAccess"),s=[],r=i.nodeModel.options.data.objectId.replace("pid:",""),l=i.nodeModel.options.data.objectType,c=i.nodeModel.options.data.displayName,u=i.nodeModel.options.data.displayType,h={objectId:r,objectType:l,displayName:c,displayType:u,facetName:"dependency"},m=y.openWith(o,h),g=p.getDependUserAccess(i.nodeModel.options.data.objectId),f=[];f.push(m),f.push(g),Promise.all(f).then(function(n){n[0]&&s.push(n[0]),"false"!=d.getGlobalVariable().CHG_OPEN_WITH_COLLAB&&s.push({type:"PushItem",title:t.ECM_CA_Explore_With_Central,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open-in-a-new-window"},action:{callback:function(e){y.openIn3DSpace()}}}),s.push({type:"PushItem",title:t.ECM_CA_Properties,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-attributes"},action:{callback:function(e){y.showPropertyPanel()}}}),s.push({type:"PushItem",title:t.ECM_CA_CopyLink,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-link"},action:{callback:function(e){b.getCopyLink(i)}}}),s.push({type:"PushItem",title:t.ECM_CA_RELATIONAL_EXPLORER,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-object-related"},action:{callback:function(e){var t=new Array(r);o.openRelationalExplorer(t)}}}),"true"==n[1].dependUserAccess.Synchronization&&s.push({type:"PushItem",title:t.ECM_COLLABORATE_CHG_DEPENDENCY,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-change-action-sync"},action:{callback:function(e){y.syncChangeDependency()}}}),"false"!==a.dependUserAccess.edit&&s.push({type:"PushItem",title:t.ECM_CA_Remove_Referential,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-trash"},action:{callback:function(e){y.removeDependency()}}}),e(s)})})},openWith:function(e,i){return new Promise(function(n,o){var a=null,s=[];s.push(i);var r=e.getContentForCompassInteraction(s),c=new l;c.set3DXContent(r);var p=[];UWA.is(c.retrieveCompatibleApps,"function")&&c.retrieveCompatibleApps(function(e){e.forEach(function(e){p.push({type:"PushItem",title:e.text,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+e.fonticon},action:{callback:function(t){e.handler()}}})});var i=d.getGlobalVariable();p.length>0&&i.isNative?"true"==i.CHG_OPENWITH&&(a={type:"PushItem",title:t.ECM_CA_Command_OpenWith_RichClient,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-export"},submenu:p}):p.length>0&&(a={type:"PushItem",title:t.ECM_CA_Command_OpenWith,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-export"},submenu:p}),n(a)})})},showNotification:function(e,t,i,n,o,a,s){var r={level:e,title:t,subtitle:i,message:n,sticky:o,allowUnsafeHTML:s||!1};window.notifs||(window.notifs=f,C.setNotificationManager(window.notifs)),a?C.inject(a):C.elements.container.isInjected()||C.inject(),window.notifs.addNotif(r)},openIn3DSpace:function(){var e=S("DS/ENOChgServices/scripts/services/ChgNativeInitService"),t=y.caDependencyModel.get("dataGridView").getTreeDocument().getSelectedNodes()[0].options.resourceid;t=t.slice(4,t.length);var i=d.getGlobalVariable();if(i.isNative)e.DispatchEventToWin("ExploreInCollabNApproval",t);else{var n="/common/emxTree.jsp?mode=insert&objectId="+t,o=i.getSecurityContext().replace("ctx::",""),a=i.computeUrl("/common/emxFrameworkContextManager.jsp?SecurityContext="+o+"&forwardUrl="+n),s=window.open();s.opener=null,s.location.href=a}},showPropertyPanel:function(){var e=y.caDependencyModel.get("dataGridView").getTreeDocument().getSelectedNodes()[0].options.resourceid;e=e.slice(4,e.length),u.createPropertiesComponent(e)},syncChangeDependency:function(){var e=S("DS/ENOChgServices/scripts/services/ChgErrors"),i=y.caDependencyModel.get("dataGridView").getTreeDocument();p.syncDependency(i).then(function(e){var i,n=new a({closable:!0,renderTo:widget.body});i="<p>\t\t\t\t\t\t\t\t\x3c!--h6></h6--\x3e\t\t\t\t\t\t\t\t<ul>\t\t\t\t\t\t\t\t\t<li>"+t.ECM_CA_EBOMSync_Successful+"</li>\t\t\t\t\t\t\t\t</ul>\t\t\t\t\t\t\t</p>",n.dialog({body:i,title:t.ECM_CA_Action_EBOMSync_CollabStatus,buttons:[{className:"primary",value:t.ECM_CA_Collab_Dialog_Done,action:function(e){e.hide()}}]})},function(i){i?e.error(i):e.error(t.ECM_CA_Action_EBOMSync_Failed)})},removeDependency:function(){var e=S("DS/ENOChgServices/scripts/services/ChgErrors"),i=y.caDependencyModel.get("dataGridView").getTreeDocument(),n=i.getSelectedNodes()[0];n?"Group Dependency"==n.options.grid.dependencyValueType?e.error(t.ECM_CA_REMOVE_GROUP_DEPENDENCY_ERROR):p.removeDependencyLink(i,n).then(function(){if(n.isRoot()){if(i.removeRoot(n),"Upstream"==y.caDependencyModel.get("stream")){if(y.caDependencyModel.get("upstreamDependencyObjects").dependencyLinks.forEach(function(e,t,i){e.id==n.options.resourceid&&e.dependencyValueType==n.options.data.dependencyValueType&&i.splice(t,1)}),"Co-Dependency"==n.options.data.dependencyValueType)y.caDependencyModel.get("downstreamDependencyObjects").dependencyLinks.forEach(function(e,t,i){e.id==n.options.resourceid&&"Co-Dependency"==e.dependencyValueType&&i.splice(t,1)})}else if(y.caDependencyModel.get("downstreamDependencyObjects").dependencyLinks.forEach(function(e,t,i){e.id==n.options.resourceid&&e.dependencyValueType==n.options.data.dependencyValueType&&i.splice(t,1)}),"Co-Dependency"==n.options.data.dependencyValueType)y.caDependencyModel.get("upstreamDependencyObjects").dependencyLinks.forEach(function(e,t,i){e.id==n.options.resourceid&&"Co-Dependency"==e.dependencyValueType&&i.splice(t,1)});if(y.caDependencyModel.get("upstreamDependencyObjects").dependencyLinks.length+y.caDependencyModel.get("downstreamDependencyObjects").dependencyLinks.length===0){var e=y.caDependencyModel.get("caId").substring(4);r.publish("dependency:data:ready"+widget.id,e)}}else{n.getParent().removeChild(n)}},function(e){console.log("Remove link failed")}):e.error(t.ECM_NO_NODE_SELECTED)},updateStatusBar:function(e){e.buildStatusBar([{type:c.STATUS.NB_ITEMS},{type:c.STATUS.NB_SELECTED_ROWS}])},addDependency:function(e){var t=S("DS/ENOChgServices/scripts/services/ChgNativeInitService"),i=S("DS/ENOChgServices/scripts/services/ChgIDCardCommonServices");window.addEventListener("storage",function(e){if(e.storageArea===sessionStorage)if(null!=sessionStorage.searchList&&""!=sessionStorage.searchList){for(var t=sessionStorage.searchList.split(","),i=0;i<t.length;i++){var n={};n.value=t[i],n.label="";var o={0:[n.value]};y.OnSearchComplete(o)}sessionStorage.removeItem("searchList")}else console.log("inside EVENT ******************************************")}),y.dependencyType=e.type;var n,o=d.getGlobalVariable();if(o.isNative)n="Dependency"==y.dependencyType?"Add_Dependency":"Add_CoDependency",t.DispatchEventToWin(n,"Add_Dependency");else if(o.is3DSpace){showChooser("../common/emxFullSearch.jsp?field=TYPES=type_ChangeOrder,type_ChangeAction:ECM_CHANGE_ON_HOLD!=TRUE:CURRENT!=policy_Cancelled.state_Cancelled&table=AEFGeneralSearchResults&selection=single&formName=BCform&submitAction=refreshCaller&hideHeader=true&HelpMarker=emxhelpfullsearch&submitURL=../enterprisechangemgtapp/ECMWebSearchUtil.jsp?fromOperation=searchDependency",850,630)}else{var a=i.activateSearch("Change Action, Change Order","Dependency");i.search("Dependency","Change Action, Change Order",y.OnSearchComplete,"Depend",a)}},OnSearchComplete:function(e){var t,i,n={},o=y.caDependencyModel.get("stream"),a=y.caDependencyModel.get("dataGridView").getTreeDocument(),s=y.caDependencyModel.get("caId"),l=a.getSelectedNodes()[0];t=UWA.is(l)?l.options.resourceid:s,i=d.getGlobalVariable().isNative?"pid:"+(e=e.split(","))[0]:"pid:"+e[0][0];var c="Dependency"===y.dependencyType?"prerequisite":"corequisite";n="prerequisite"==c?"Upstream"==o?{version:"v0",type:c,to:i,from:t}:{version:"v0",type:c,to:t,from:i}:{version:"v0",type:c,to:i,from:t},p.addDependencyLink(JSON.stringify(n)).then(function(e){if(UWA.is(l)){n=[];"Upstream"==o?(t=y.buildUpstreamDependencyModel(e.elements,e.originid),n=y.getNewlyAddedDependencyElem(t,l)):n=(t=y.buildDownstreamDependencyModel(e.elements,l.options.resourceid)).dependencyLinks;c=[];n.forEach(function(e){var t=y.createTreeNodeModel(e);c.push(t)}),l.addChild(c),l.expand()}else{var t,i=y.caDependencyModel.get("dataGridView"),n=[];if("Upstream"==o)t=y.buildUpstreamDependencyModel(e.elements,s),n=y.getNewlyAddedDependencyElem(t,i.treeDocument),y.caDependencyModel.set("upstreamDependencyObjects",t),"Co-Dependency"==n[0].dependencyValueType&&(t=y.buildDownstreamDependencyModel(e.elements,s),y.caDependencyModel.set("downstreamDependencyObjects",t));else{t=y.buildDownstreamDependencyModel(e.elements,s),n=y.getNewlyAddedDependencyElem(t,i.treeDocument);var a=y.caDependencyModel.get("downstreamDependencyObjects");a.dependencyLinks.push(n[0]),y.caDependencyModel.set("downstreamDependencyObjects",a),"Co-Dependency"==n[0].dependencyValueType&&(t=y.buildUpstreamDependencyModel(e.elements,s),y.caDependencyModel.set("upstreamDependencyObjects",t))}var c=[];n.forEach(function(e){var t=y.createTreeNodeModel(e);c.push(t)}),i.treeDocument.addRoot(c);var d=y.caDependencyModel.get("upstreamDependencyObjects").dependencyLinks.length+y.caDependencyModel.get("downstreamDependencyObjects").dependencyLinks.length;if(1==d||2==d){var p=s.substring(4);r.publish("dependency:data:ready"+widget.id,p)}}},function(e){console.log("Add link failed in view")})},getNewlyAddedDependencyElem:function(e,t){var i=[];return e.dependencyLinks.forEach(function(e){var n=!0,o=e.id,a=e.dependencyValueType;t.getChildren().forEach(function(e){var t=e.options.resourceid,i=e.options.grid.dependencyValueType;o==t&&a==i&&(n=!1)}),n&&i.push(e)}),i},updateUX:function(){var e=y.caDependencyModel,t=e.get("stream"),i=e.get("dataGridView"),n=e.get("caId");p.changeActionDependencyModel.set("stream",t),p.changeActionDependencyModel.set("dataGridView",i),p.changeActionDependencyModel.set("caId",n),y.setCADependencyModel(p.changeActionDependencyModel);var o=y.getTreeModelForDataGridView();y.caDependencyModel.get("dataGridView").treeDocument=o}};return y}),define("DS/ENOChangeActionUX/scripts/CACommonIgnore",["UWA/Core","DS/ENOChgServices/scripts/services/ChgRealizedServices","DS/ENOChgServices/scripts/services/ChgErrors","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChgServices/scripts/services/ChgInfodialog","DS/UIKIT/Mask","require"],function(e,t,i,n,o,a,s){"use strict";return{ignoreNodes:function(e,i,s,r){var l=n.ECM_CA_Realized_Ignore_Change_Content+"<br><br>",c=[{label:n.ECM_CA_OK_Button_Label,handler:function(){"undefined"!=i&&null!=i&&a.mask(i),t.ignoreChangeRealized(e,s,r),o.closeDialog()},className:"primary"},{label:n.ECM_CA_Cancel,handler:function(){o.closeDialog()},className:"default"}],d={title:n.ECM_CA_Realized_Ignore_Change,content:l,buttonArray:c};o.launchInfoDailog(d)}}}),define("DS/ENOChangeActionUX/scripts/Views/CACustomReferentialTileView",["UWA/Core","UWA/Utils","DS/W3DXComponents/Views/Item/TileView"],function(e,t,i){"use strict";return i.extend({name:"CACustomReferentialTile",template:function(){return'                            <div class="'+this.getClassNames("-check")+' {{#unless withMultisel}}hidden{{/unless}}">                                <div class="toggle toggle-primary">                                    <input type="checkbox" name="radios" value="" id="checkbox-Referential-{{id}}">                                    <label class="control-label" for="checkbox-Referential-{{id}}"></label>                                </div>                            </div>                              <div class="'+this.getClassNames("-sub-container")+'" {{#if Access}} draggable="true"{{/if}}>                                  <div class="'+this.getClassNames("-header")+'">                                    {{#if image}}<img src="{{#unless lazyLoading}}{{image}}{{/unless}}" {{getImgAttrs imgAttrs}} class="'+this.getClassNames("-image")+'" draggable="false"/>{{/if}}                                  </div>                                  <div class="'+this.getClassNames("-body")+'">                                    {{#if icon}}<img src="{{icon}}" class="'+this.getClassNames("-icon")+'" draggable="false"/>{{/if}}                                      {{#if namePref}}<div class="'+this.getClassNames("-title")+'" title="{{{objectName}}}&nbsp;{{{revision}}}">{{{objectName}}}&nbsp;{{{revision}}}</div>{{/if}}\t\t\t\t\t\t\t\t\t  {{#unless namePref}}<div class="'+this.getClassNames("-title")+'" title="{{{objectTitle}}}&nbsp;{{{revision}}}">{{{objectTitle}}}&nbsp;{{{revision}}}</div>{{/unless}}                                      {{#if titlePref}}<div class="'+this.getClassNames("-subtitle")+'" title="{{{objectName}}}">{{{objectName}}}</div>{{/if}}\t\t\t\t\t\t\t\t\t  {{#unless titlePref}}<div class="'+this.getClassNames("-subtitle")+'" title="{{{objectTitle}}}">{{{objectTitle}}}</div>{{/unless}}                                     <div class="'+this.getClassNames("-content")+'">\t\t\t\t\t\t\t\t\t\t{{#if current}}<div class="'+this.getClassNames("-Maturity")+'" title="{{{maturityName}}}">\t\t\t\t\t\t\t\t\t\t\t<table>\t\t\t\t\t\t\t\t\t\t\t\t<tr>\t\t\t\t\t\t\t\t\t\t\t\t\t<td class="'+this.getClassNames("-maturityField")+'">{{{maturityField}}}</td>\t\t\t\t\t\t\t\t\t\t\t\t\t<td class="'+this.getClassNames("-maturityValue")+'">&nbsp;{{{current}}}</td>\t\t\t\t\t\t\t\t\t\t\t\t</tr>\t\t\t\t\t\t\t\t\t\t\t</table>\t\t\t\t\t\t\t\t\t\t</div>{{/if}}\t\t\t\t\t\t\t\t\t\t{{#if ownerFullname}}<div class="'+this.getClassNames("-Owner")+'" title="{{{ownerFullname}}}">\t\t\t\t\t\t\t\t\t\t<table>\t\t\t\t\t\t\t\t\t\t\t\t<tr>\t\t\t\t\t\t\t\t\t\t\t\t\t<td class="'+this.getClassNames("-ownerField")+'">{{{ownerField}}}</td>\t\t\t\t\t\t\t\t\t\t\t\t\t<td class="'+this.getClassNames("-onwerValue")+'">&nbsp;{{{ownerFullname}}}</td>\t\t\t\t\t\t\t\t\t\t\t\t</tr>\t\t\t\t\t\t\t\t\t\t\t</table>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</div>{{/if}}                                    <ps-progress  class="'+this.getClassNames("-progress")+'"></ps-progress>                                </div>                                <div class="'+this.getClassNames("-actions")+'">                                    <div class="actions-inline-container">                                      <div class="action-container single-action hidden">                                           <div class="action-icon-wrapper"><span class="fonticon fonticon-2x"></span></div>                                      </div>                                      <div class="action-container actions-inline-dotted hidden">                                           <div class="action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-down-open"></span></div>                                      </div>                                    </div>                                </div>                            </div>                      '}})}),define("DS/ENOChangeActionUX/scripts/Views/CACustomSeverityView",["UWA/Core","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/UIKIT/Input/Button","DS/UIKIT/Input/ButtonGroup","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e,t,i,n,o){"use strict";return t.extend({tagName:"div",domEvents:{},id:function(){return"CACustomSeverityView_"+this.cid},setup:function(e){this._parent.apply(this,arguments)},render:function(){this.container.empty(!0);var t=this;t.model.set("severity","Low"),this.SevButtonGroupDiv=e.createElement("div",{class:"form-group",html:[{tag:"h5",html:o.ECM_CA_Severity,styles:{"margin-bottom":"3px"}}]});var a=new n({type:"radio",name:"Severity",id:"Severity",buttons:[new i({value:o.ECM_CA_Severity_Low,id:"Low",className:"success small",active:!0}),new i({value:o.ECM_CA_Severity_Medium,id:"Medium",className:"warning small"}),new i({value:o.ECM_CA_Severity_High,id:"High",className:"error small"})],events:{onClick:function(e,t){this.dispatchEvent("onButtonClick",t),console.log(t)}}});a.inject(this.SevButtonGroupDiv);var s=this.ButtonEvents={onButtonClick:function(e){t.model.set("severity",e.getValue())}};return this.listenTo(a,s),this.SevButtonGroupDiv.inject(this.container),this},destroy:function(){this._parent.apply(this,arguments)}})}),define("DS/ENOChangeActionUX/scripts/CAMakeDroppable",["DS/DataDragAndDrop/DataDragAndDrop","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/UIKIT/Mask","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e,t,i,n,o){"use strict";var a={makeDroppable:function(n,s){e.droppable(n,{drop:function(e,r,l){if(l.stopPropagation&&l.stopPropagation(),l.preventDefault&&l.preventDefault(),l.dataTransfer&&l.dataTransfer.dropEffect&&(l.dataTransfer.dropEffect="copy"),UWA.is(e)&&""!=e){var c=JSON.parse(e),d=i.checkTenantInforamation(c);if(0!=d.TenantInfoMissing.length)t.error(o.CHG_GOV_Pref_PlatformMissing_Error);else if(0!=d.DiffTenantData.length)t.error(o.CHG_GOV_Pref_PlatformDoesNotMatch_Error);else{c=i.removeDuplicatesToBeDroppedObjects(c);var p=i.filterBasedOnServiceId(c);if(p.incorrectServiceInfo&&Array.isArray(p.incorrectServiceInfo)&&p.incorrectServiceInfo.length>0){var u=o.CHG_GOV_WARN_DROP_SKIPPED+"<br/>";for(var h in p.incorrectServiceInfo)u+=p.incorrectServiceInfo[h]+"<br/>";t.warn(u,"false")}a.ExecuteDrop(c,s)}}else t.error(o.CHG_GOV_Drop_Not_Supported);n.setStyle("borderWidth","0px")},over:function(){arguments[0].setStyles({borderStyle:"solid",borderColor:"#368ec4",borderWidth:"1px"})},leave:function(){arguments[0].setStyle("borderWidth","0px")}})},ExecuteDrop:function(e,i){if(e){var n=e.data.items;UWA.is(n)&&UWA.is(n.length)&&n.length>0&&i(n)}else t.error(o.CHG_GOV_Drop_Not_Supported)}};return a}),define("DS/ENOChangeActionUX/scripts/Models/CAActivityModelForDisplayView",["UWA/Class/Model","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","UWA/Core"],function(e,t,i,n){"use strict";return e.extend({idAttribute:"id",setup:function(){this.addEvent("onChange:activityDisplaySelect",function(e){this.updateActivityDisplayInfo(e)}),this.addEvent("onChange:activityActual",function(e){this.updateActivityDisplaySelectInfo(e)})},parse:function(e){var t=e.model;this.set("canEdit",!0),this.set("operationId",t.get("operationId")),this.set("operationIdx",t.get("operationIdx"));var i={};i.objectID=t.get("objectId").replace("pid:",""),this.set("proposedObject",i),this.updateAllowedActivityInfo(this),UWA.is(t.id)&&(this.set("id",t.id),this.set("isEdit",!0),this.set("activityActual","ChangeStatus"==t.get("activityActual")?t.get("targetState"):t.get("activityActual")),this.updateActivityDisplaySelectInfo(this),this.set("reasonForChange",UWA.String.unescapeHTML(t.get("activityDesc"))))},updateAllowedActivityInfo:function(e){UWA.is(e.get("proposedObject"))&&UWA.is(e.get("proposedObject").objectID)?require(["DS/ENOChangeActionUX/scripts/Services/CAProposedViewServices","DS/ENOChgServices/scripts/services/ChgProposedServices"],function(n,o){var a=e.get("proposedObject").objectID,s=[];s.push("pid:"+a);let r=t.getGlobalVariable().IDCard.model.id;o.getAllowedOperationActivity(s,r).then(function(t){var o=[];if(t.allowedOperationActivity[a].allowedActivity.forEach(function(e){var s=t.allowedOperationActivity[a].allowedOperation,r=n.getOperationNameOnUI(e);"Release"==e||"Obsolete"==e?r=i.ECM_CA_Proposed_Activity_ChangeMaturity+": "+r:"Modify"==e&&s.includes("Restore")&&(r=i.ECM_CA_Proposed_Activity_ChangeMaturity+": "+i.ECM_CA_Proposed_Activity_State_Restore),"Modify"==e&&s.includes("Restore")?o.push({displayValue:r,actualValue:"Restore"}):o.push({displayValue:r,actualValue:e})}),e.set("activityDisplayOptions",o),!e.get("isEdit")){var s=t.allowedOperationActivity[a].defaultActivity;UWA.is(s)||(s=1==o.length?o[0].actualValue:void 0),e.set("activityActual",s)}},function(e){return console.log("Get allowed operation/activity failed"),Promise.reject(e)})}):(e.unset("activityDisplayOptions"),e.unset("activityActual"))},updateActivityDisplaySelectInfo:function(e){var t=e.get("activityActual");require(["DS/ENOChangeActionUX/scripts/Services/CAProposedViewServices"],function(n){var o=n.getOperationNameOnUI(t);"Release"!=t&&"Obsolete"!=t||(o=i.ECM_CA_Proposed_Activity_ChangeMaturity+": "+o),"Release(Demote)"==t&&(o=i.ECM_CA_Proposed_Activity_ChangeMaturity+": "+t),"Restore"==t&&(o=i.ECM_CA_Proposed_Activity_ChangeMaturity+": "+t),e.set("activityDisplaySelect",{displayValue:o,actualValue:t},{silent:!0}),e.set("activityDisplay",o)})},updateActivityDisplayInfo:function(e){var t=e.get("activityDisplaySelect");if(UWA.is(t)&&UWA.is(t.actualValue)){t.actualValue;e.set("activityActual",t.actualValue,{silent:!0}),e.set("activityDisplay",t.displayValue)}}})}),define("DS/ENOChangeActionUX/scripts/Views/CAPopOverBodyView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/Handlebars/Handlebars4","DS/UIKIT/Scroller","text!DS/ENOChangeActionUX/scripts/Templates/CAMultipleSelectedProposedTemplate.html"],function(e,t,i,n,o,a,s){"use strict";return e.extend({init:function(e){this.options=e,this._parent.call(this,e)},setup:function(){"multipleSelectedProposed"===this.options.bodyOf?this.template=s:"flowdownFromMultiple"===this.options.bodyOf&&(this.template=CAFlowdownFromMultipleTemplate)},render:function(){this.options.container.empty(),this.renderer=this.getTemplate(s,this.options.objectsSelected);var e=this.renderer(),t=UWA.createElement("div",{class:"ppoover-body-container-component"});return t.setContent(e),t.inject(this.options.container),this},domEvents:{"click .supp-icon":function(e){var t=e.target.id.split("-")[2].replace("pid:",""),i=this.container.getElement("#selected-proposed-label-obejct-"+t),n=this.container.getElement(".proposed-popover-body");this.dispatchEvent("crossClicked",[t]),setTimeout(function(){i&&n&&n.removeChild(i)},100)}},getTemplate:function(e,t){var i=o.compile(e),n=[];for(var a in t){var s={},r={},l=t[a];l&&(r={displayText:l.proposedTitle+" "+l.proposedRevision,id:l.proposedId.replace("pid:","")}),s.details=r,n.push(s)}var c={changes:n};return function(){return i(c)}}})}),define("DS/ENOChangeActionUX/scripts/Models/CAFlowDownModel",["UWA/Class/Model","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","UWA/Core","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgInfraService"],function(e,t,i,n,o){"use strict";return e.extend({idAttribute:"id",setup:function(){},parse:function(e){var t=e.model;if(this.set("canEdit",!0),this.set("mode",e.mode),this.set("caType",{displayValue:"Change Action",actualValue:e.defaultCATypeNLS}),UWA.is(t.id)){var i={};this.set("id",t.id),t.set("objectId",t.id),i.objectType=t.get("objectType")?t.get("objectType"):"",i.objectActualName=t.get("synopsis"),void 0!==i.objectActualName&&""!==i.objectActualName||(i.objectActualName=t.get("objectName")),i.objectRev=t.get("revision")?t.get("revision"):"",i.objectName=i.objectActualName+" "+i.objectRev,i.objectID=t.get("objectId")?t.get("objectId").replace("pid:",""):"",i.maturity=t.get("maturity")?t.get("maturity"):"",i.policy=t.get("policy")?t.get("policy"):"",i.image={imageValue:t.get("icon")?t.get("icon"):""},this.set("objectName",i.objectName),this.set("proposedObject",i)}},add:function(e,i,n){var o={},a=this,s=i,r=[s];t.getAdditionObjectInfo(r).then(function(t){o.objectType=t.additionObjectInfo[s].type,o.objectActualName=t.additionObjectInfo[s].synopsis,void 0!==o.objectActualName&&""!==o.objectActualName||(o.objectActualName=t.additionObjectInfo[s].objectName),o.objectRev=t.additionObjectInfo[s].revision,o.objectName=o.objectActualName+" "+o.objectRev,o.objectID=t.additionObjectInfo[s].pid,o.policy=t.additionObjectInfo[s].policy,o.image={imageValue:t.additionObjectInfo[s].icon};var i=a.get(e);UWA.is(i,"object")&&a.unset(e),a.set(e,o)},function(e){return console.log("Populate Security Context failed"),Promise.reject(e)})},remove:function(e,t,i){var n=this.get(e);UWA.is(n,"object")&&(this.unset("operationActual",{silent:!0}),this.unset(e))}})}),define("DS/ENOChangeActionUX/scripts/Views/CACustomTitleView",["UWA/Core","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/UIKIT/Input/Text","UWA/Class/Model","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e,t,i,n,o){"use strict";return t.extend({tagName:"div",domEvents:{},id:function(){return"CACustomSeverityView_"+this.cid},setup:function(e){this._parent.apply(this,arguments)},render:function(){this.container.empty(!0);var t=this;this.TitleDiv=e.createElement("div",{class:"form-group",html:[{tag:"label",html:[{tag:"div",html:[{tag:"span",html:o.ECM_CA_Abstract},{tag:"sup",html:"*",class:"required-field",styles:{color:"#e87b00","padding-left":"5px"}}]}]}]});var n=new i({name:"CA_Title",id:"CA_Title",className:"mandatory_input",value:"",multiline:!1,rows:1,required:!0,placeholder:o.ECM_CA_Abstract_PlaceHolder});return n.elements.input.onkeyup=function(){var e=n.elements.input.value;t.model.set("createObjectTitle",e)},n.elements.input.onblur=function(){var e=n.elements.input;""==e.value?e.style.borderColor="red":e.style.borderColor=""},n.inject(this.TitleDiv),this.TitleDiv.inject(this.container),this},destroy:function(){this._parent.apply(this,arguments)}})}),define("DS/ENOChangeActionUX/scripts/Models/CAProposedActivityModel",["UWA/Class/Model","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChgServices/scripts/services/ChgDataProcess"],function(e,t,i){"use strict";return e.extend({idAttribute:"id",setup:function(){},fetch:function(e){console.log("fetch called")},parse:function(e){var t={};if(t.id=e.id,t.operationId="",t.operationIdx="",t.status=e.status,t.activityActual=e.what.operation,t.activityName=this.getOperationNameOnUI(e.what.operation),t.objectId=e.objectId,e.what["target state"]&&(t.targetState=e.what["target state"]),e.why.comment&&e.why.comment.text){var i=UWA.String.escapeHTML(e.why.comment.text);t.activityDesc=i}else t.activityDesc="";return t},getOperationNameOnUI:function(e){var i="";switch(e){case"None":i=t.ECM_CA_Proposed_Activity_Modify;break;case"NewVersion":i=t.ECM_CA_Proposed_Operation_Revision;break;case"NewMinorVersion":i=t.ECM_CA_Proposed_Operation_MinorRevision;break;case"NewEvolution":i=t.ECM_CA_Proposed_Operation_Evolution;break;case"Create":i=t.ECM_CA_Proposed_Operation_Create;break;case"Modify":i=t.ECM_CA_Proposed_Activity_Modify;break;case"ChangeStatus":i=t.ECM_CA_Proposed_Activity_ChangeStatus;break;case"Release":i=t.ECM_CA_Proposed_Activity_State_Release;break;case"Obsolete":i=t.ECM_CA_Proposed_Activity_State_Obsolete;break;default:i="??Something went wrong??"}return i}})}),define("DS/ENOChangeActionUX/scripts/Views/CALabelManagerView",["UWA/Core","UWA/Utils","DS/W3DXComponents/Views/Item/LabelManagerView","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgMembersServices","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgErrors","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e,t,i,n,o,a,s,r,l){"use strict";return i.extend({init:function(e){this._parent(e),this.autoCompleteArr=[],this.searchIconArr=[],this.OnSearchComplete=this.OnSearchComplete.bind(this)},addObject:function(e,t,i,n,o){if(this.categoryId&&t!==this.categoryId){var a="Person";"assignee"===this.categoryId?a=l.ECM_CA_Summary_Contributor:"reviewer"===this.categoryId?a=l.ECM_CA_Summary_Reviewer:"follower"===this.categoryId&&(a=l.ECM_CA_Summary_Follower),this.categoryId="";var s=l.ECM_WARN_INCORRECT_CATEGORY+a;r.warn(s)}else{var c=this.options.multipleRoles;i.categoryId=t,!1===c&&this.removeObject(e);var d=this.autocomplete.getFormattedLabel(i);this.renderOneLabel(e,d,o);var p={selection:e,categoryId:t,prevDistinction:n,item:i};this.newObjects.push(p);var u=null;this.searchIconArr.forEach(function(e){t===e.category&&(u=e.searchIcon)}),"reviewer"===i.categoryId&&"Route Template"===i.type&&u.setStyle("pointer-events","none"),this.categoryId="",this.dispatchEvent("onUpdate",[this.newObjects,t])}},removeObject:function(e){var t,i,n,o,a=this.container.getElement('[data-id="'+e+'"]');if(a){var s=(t=this.newObjects,i="selection",n=e,t.forEach(function(e){e[i]===n&&(o=e)}),o),r="";this.newObjects.indexOf(s);s.item&&(r=s.item.categoryId);var l=null;this.autoCompleteArr.forEach(function(e){r===e.category&&(l=e.autocomplete)}),l&&l.getFocus(s.item,!1);var c=null;this.searchIconArr.forEach(function(e){r===e.category&&(c=e.searchIcon)}),c&&c.setStyle("pointer-events","all"),this.newObjects.splice(this.newObjects.indexOf(s),1),a.remove(),this.dispatchEvent("onUpdate",[this.newObjects,r])}},attachAutocomplete:function(t,i){var n=this;e.extend(this.options,{collection:this.collection,container:i,events:{onSelect:function(e,t,i){if(t)if(l&&l===t.category)n.addObject(e,l,t,i,this.getContent());else{for(var o=n.autoCompleteArr.length,a="",s=0;s<o;s++){var r=n.autoCompleteArr[s];if(r){var l=r.category;if(l===t.category){a=r.autocomplete.elements.form;break}}}n.addObject(e,l,t,i,a)}},onFocused:function(e){n.onFocus(e)}},attributes:{"data-category":t}});var o=null;return(o=this.options.autocompleteExtension?this.autocomplete=new this.options.autocompleteExtension(this.options):this.autocomplete=new PatchedAutocomplete(this.options))&&this.autoCompleteArr.push({autocomplete:o,category:t}),this.autocomplete.inject(i)},OnSearchComplete:function(e){if(s.getGlobalVariable().isNative){for(var t=e.split(","),i=[],n=0;n<t.length;n++)i[n]=t[n].split();this.dispatchEvent("onPersonSelect",[i,this.categoryId])}else this.dispatchEvent("onPersonSelect",[e,this.categoryId])},attachSearchIcon:function(e,t){var i=this,r="Person";"assignee"===e?r=l.ECM_CA_Summary_Contributor:"reviewer"===e?r=l.ECM_CA_Summary_Reviewer:"follower"===e&&(r=l.ECM_CA_Summary_Follower);var c=this.searchIcon=UWA.createElement("div",{class:"search-icon-autocomplete",html:{tag:"span",class:"search-span fonticon fonticon-search",title:l.SEARCH_STR+r,events:{click:function(){if(i.categoryId=e,s.getGlobalVariable().isNative){var t={categoryId:e,reviewerType:a.reviewerType.typeOfReviewer},r=JSON.stringify(t);n.DispatchEventToWin("Add_Member",r)}else i.SearchObj=o.activateSearch("Person","Contributors"),o.search("Contributors","Person",i.OnSearchComplete,"Contributors",i.SearchObj,e)}}}});return c&&this.searchIconArr.push({searchIcon:c,category:e}),c.inject(t)},onRender:function(){for(var e=this.options.categories,t=0;t<e.length;t++){var i=this.container.getElement("#"+e[t].id+"-wrapper");i&&(i.setStyle("display","flex"),i.setStyle("align-items","center")),this.attachAutocomplete(e[t].id,this.container.getElement("#"+e[t].id+"-wrapper")),this.attachSearchIcon(e[t].id,this.container.getElement("#"+e[t].id+"-wrapper"))}}})}),define("DS/ENOChangeActionUX/scripts/Views/CAApplicabilityView",["UWA/Class/View","UWA/Core","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable"],function(e,t,i){"use strict";return{_createView_Applicability:function(t){return e.extend({tagName:"div",className:"generic-detail6",render:function(){var e=this.container,t=new UWA.Element("div");t.setAttributes({id:"FacetDivForApplicabilityContext"}),t.setStyles({height:"100%"}),e.addContent(t);var n=this.model.id,o=i.getGlobalVariable().isNative?"Native":"Dashboard";require(["DS/CfgEvolutionUX/CfgEvolutionLayoutFactory"],function(e){var a={mode:"Applicability",objectid:n.replace("pid:",""),parent:t,environment:o};a.tenant=i.getGlobalVariable().tenant;e.create(a)})}})}}}),define("DS/ENOChangeActionUX/scripts/Models/ChgChangeGroupModel",["UWA/Class/Model","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/TreeModel/DataModelSet"],function(e,t,i,n){"use strict";return e.extend({init:function(){},createTreeDocument:function(){return new t({})},loadData:function(e,t,i){e.prepareUpdate();for(var n=t.groups,o=0;o<n.length;o++){var a=this.createNode(n[o].title,n[o].id);i&&n[o].id==i.id||e.addRoot(a)}e.pushUpdate()},createNode:function(e,t){return new i({label:e,value:t})}})}),define("DS/ENOChangeActionUX/scripts/CAWidgetConfiguration",["DS/ENO6WPlugins/jQuery","DS/MessageBus/MessageBus","DS/PlatformAPI/PlatformAPI","DS/EditPropWidget/models/EditPropModel","DS/ENOChgServices/scripts/services/ChgPropertiesServices","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgNativeInitService"],function(e,t,i,n,o,a,s){"use strict";var r={setupIntercomConnections:function(e,t,i){t.compassSocketName=i+"EventSocket",t.compassSocket=new t.InterCom.Socket(t.compassSocketName),t.compassSocket.subscribeServer("com.ds.compass",window.parent),t.prefIntercomServer=new t.InterCom.Server("changeaction.intercom.server"),t.prefIntercomServer.addListener("onAddPref",function(i,n){if("RefreshMe"!=i.name){i.value?e.setValue(i.name,i.value):e.deleteValue(i.name);i.name.split("changeaction-preference_")}else t.onRefresh()})},onClickItem:function(t,r){var l,c,d,p,u,h,m=a.getGlobalVariable().collabspace;d=(p=e(this)).hasClass("selected"),c=p.attr("data-pid"),p.attr("data-type"),h=p.attr("data-selectedItem");var g=JSON.parse(h);if(UWA.is(g.Instanceid)&&(c=g.Instanceid),d){-1===a.getGlobalVariable().arrOid.indexOf(c)&&a.getGlobalVariable().arrOid.push(c),c=a.getGlobalVariable().arrOid[a.getGlobalVariable().arrOid.length-1]}else{for(var f in a.getGlobalVariable().arrOid)if(a.getGlobalVariable().arrOid[f]===c){a.getGlobalVariable().arrOid.splice(f,1);break}if(0==a.getGlobalVariable().arrOid.length){if(u=null,c=null,s.DispatchEventToWin("Add_to_CSO",a.getGlobalVariable().arrOid.toString()),a.getGlobalVariable().is3DSpace)if(C=window.top)(v=C.findFrame(window.top,"detailsDisplay"))&&(v.ids=""),getTopWindow().ds&&emxUICore.setIdtoCompass()}else c=a.getGlobalVariable().arrOid[a.getGlobalVariable().arrOid.length-1]}if(c){var C,v;if(u=c,a.getGlobalVariable().is3DSpace)if(C=window.top)(v=C.findFrame(window.top,"detailsDisplay"))&&(v.ids="",v.ids="~|"+c+"~"),getTopWindow().ds&&emxUICore.setIdtoCompass();l={objectId:c,envId:a.getGlobalVariable().tenant,contextId:null!=m?m.replace("ctx::",""):""},r.compassSocket.dispatchEvent("onSetObject",l,r.compassSocketName),s.DispatchEventToWin("Add_to_CSO",a.getGlobalVariable().arrOid.toString())}else r.compassSocket.dispatchEvent("onResetObject",{},r.compassSocketName),s.DispatchEventToWin("Remove_From_CSO",c);if(a.getGlobalVariable().is3DSpace){var A=new n({tenant:a.getGlobalVariable().tenant,objectId:u}),w=[];u&&w.push(A);var b=o.getPropertiesComponent();b&&b.initData(w)}else{var S=[];null!=u&&S.push(u);var y={data:{paths:[]}};if(S.length>0&&y.data.paths.push(S),i.publish("DS/PADUtils/PADCommandProxy/select",y),d&&h){var _=JSON.parse(h),E={[_.id]:{id:_.id,name:_.name,title:_.title,type:_.type}},D={metadata:{appId:t.id,appName:t.getValue("appId"),timestamp:Math.floor(Date.now())},data:{paths:[_.id],attributes:E},version:"1.0"};i.publish("DS/Object/select",D);var O={operation:"select",operationVersion:"1.0",appId:t.id,appName:t.getValue("appId"),content:{version:"1.1",id:_.id,name:_.name,title:_.title,type:_.type}};i.publish("webinwin:web:notification",JSON.stringify(O))}}}};return window.CAWidgetConfiguration=r,r}),define("DS/ENOChangeActionUX/scripts/ChangeActionInit",["UWA/Core","UWA/Class","UWA/Class/Debug","UWA/Class/Events","DS/ENOChangeActionUX/scripts/Services/ChgChangeActionServices","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChangeActionUX/scripts/CAPreferencesManager"],function(e,t,i,n,o,a,s,r){"use strict";return t.extend(i,n,{init:function(e){r.initialize(),this._options=e,console.log(e)},loadInfraForWidget:function(){return new Promise(function(e,t){o.PopulatePreferences().then(function(t){o.getExpressionValue().then(function(t){s.caSubTypesFetched().then(function(t){e()})})})})},loadWidget:function(e){if("undefined"==typeof dscef||a.getGlobalVariable().isPoweredBy){var t=null,i=widget.getValue("X3DContentId")?JSON.parse(widget.getValue("X3DContentId")):null,n=widget.getValue("TransientCAPid"),s=(d=widget.getValue("originatingPid"),p=widget.getValue("objName"),u=widget.getValue("originatingcaName"),h=widget.getValue("status"),widget.getValue("nameTitlePref"));if(null===i||void 0!==widget.getValue("lastRootNodeID")||widget.getValue("clearInPreview"))if(n){if(UWA.is(n)){c={blockError:!0};o.IsChangeAction(n,c).then(function(t){"TRUE"===t.isChangeAction?e({type:"IDCard",options:{transientCAPid:"pid:"+n,originatingCAPid:d,originatingCAName:u,objNametoFilterforFlowDown:p,isFromFlowDown:h,nameTitlePref:s}}):""!=that.caGlobalObject.mySecurityContext&&e({type:"LoadSummary",options:null})})}}else{if(""!=a.getGlobalVariable().getSecurityContext().mySecurityContext)e({type:"LoadSummary",options:null})}else{var r=i.data;if(null!==r&&r.items.length>0){var l=r.items[r.items.length-1];if(t=l.objectId,UWA.is(t)){var c={blockError:!0};o.IsChangeAction(t,c).then(function(i){"TRUE"===i.isChangeAction?e({type:"IDCard",options:{transientCAPid:"pid:"+t,originatingCAPid:d,originatingCAName:u,objNametoFilterforFlowDown:p,isFromFlowDown:h,nameTitlePref:s}}):""!=a.getGlobalVariable().getSecurityContext()&&e({type:"LoadSummary",options:null})},function(e){return console.log("widget initilization failed"),Promise.reject(e)})}}}}else{widget.body.empty();var d="",p="",u="",h=!1;this._options&&this._options.flowdown&&(d=this._options.flowdown.originatingPid,p=this._options.flowdown.objName,h=this._options.flowdown.status,u=this._options.flowdown.originatingcaName,nameTitlePref=this._options.flowdown.nameTitlePref);var m="pid:"+this._options.information.pid;e({type:"IDCard",options:c={transientCAPid:m,originatingCAPid:d,originatingCAName:u,objNametoFilterforFlowDown:p,isFromFlowDown:h,nameTitlePref:"Title"}})}}})}),define("DS/ENOChangeActionUX/scripts/Services/CAContextDataGridViewServices",["DS/ENOChgServices/scripts/services/ChgDataService","DS/ENOChgServices/scripts/services/ChgContextServices","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChangeActionUX/scripts/Services/CAContextDataGridViewToolbar","DS/ENOChgServices/scripts/services/ChgPropertiesServices","require","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChgGovernanceUX/scripts/util/DocumentUtils"],function(e,t,i,n,o,a,s,r){"use strict";var l=Object.create(null);return l.CONTRAINTS={DEBUG_TRACES:!0},l.getColumns=function(){return[{text:s.ECM_CA_Table_Header_Title,dataIndex:"tree",editableFlag:!1},{text:s.ECM_CA_Table_Header_Name,dataIndex:"name",editableFlag:!1,icon:[]},{text:s.ECM_CA_Maturity_State,dataIndex:"currentNLS",editableFlag:!1},{text:s.ECM_CA_Table_Header_Owner,dataIndex:"ownerFullName",editableFlag:!1}]},l.changeView=function(e){if("GridView"==e)this.currentView="Grid",(t=n.toolbar.getNodeModelByID("view"))&&"view-list"!=t.options.grid.semantics.icon.iconName&&t.updateOptions({grid:{semantics:{icon:{iconName:"view-list"}}},tooltip:s.CHG_CA_Pref_Grid_Label}),(i=document.querySelector(".toolbar-context-div .wux-ui-3ds-view-list"))&&i.addClassName("currentView"),(o=document.querySelector(".toolbar-context-div .wux-ui-3ds-view-small-tile"))&&o.removeClassName("currentView"),(a=document.querySelector(".contextgridView"))&&(a.removeClassName("hideView"),a.removeClassName("nonVisible"),a.addClassName("showView")),(r=document.querySelector(".contexttileView"))&&(r.removeClassName("showView"),r.addClassName("hideView"));else if("TileView"==e){var t,i,o,a,r;this.currentView="Tile",(t=n.toolbar.getNodeModelByID("view"))&&"view-small-tile"!=t.options.grid.semantics.icon.iconName&&t.updateOptions({grid:{semantics:{icon:{iconName:"view-small-tile"}}},tooltip:s.CHG_CA_Pref_Tile_Labels}),(i=document.querySelector(".toolbar-context-div .wux-ui-3ds-view-list"))&&i.removeClassName("currentView"),(o=document.querySelector(".toolbar-context-div .wux-ui-3ds-view-small-tile"))&&o.addClassName("currentView"),(a=document.querySelector(".contextgridView"))&&(a.removeClassName("showView"),a.addClassName("hideView")),(r=document.querySelector(".contexttileView"))&&(r.removeClassName("hideView"),r.addClassName("showView"))}},l.getCAContextForGridView=function(e){return new Promise(function(i,n){t.getCAContextData(e).then(function(e){console.log("--web service response : "+e);var t=e.changeaction.context;if(t.length>0)l.processContexts(t).then(function(e){console.log(e),i(e)});else{var n={contextInfo:[],contextId:[]};i(n)}})})},l.processContexts=function(e){return new Promise(function(t,n){console.log(e);var o=[],a=[];if(e.forEach(function(e){var t=e.hasOwnProperty("id")?e.id.slice(4):e;o.push(t)}),0===e.length){var r={};r.contextInfo=a,r.contextId=o,t(r)}var l="",c="",d="",p="",u="",h="",m="",g="",f="",C="",v="",A="";i.getAdditionObjectInfo(o,["name","title","collabSpace","icon","image"]).then(function(i){for(var n=0;n<e.length;n++){var r=e[n],w=r.hasOwnProperty("id")?r.id.slice(4):r;if(i.additionObjectInfo.hasOwnProperty(w)){var b=i.additionObjectInfo[w];l=b.objectName,c=b.objectTitle,d=b.collabSpace,p=b.icon,u=b.image,m=b.type,v=b.policy,f=b.revision,g=b.typeNLS,C=b.stateNLS,h=b.ownerFullname,A=r.hasOwnProperty("info")?r.info.isConfigured:""}"Access denied"==r.info.typeNLS?(c=s.ECM_CA_Access_Denied,d="",l="",h="",p="",u=""):"Cannot be found"==r.info.typeNLS&&(c=s.ECM_CA_Cannot_be_found,d="",l="",h="",p="",u="");var S={id:w,type:m,typeNLS:g,title:c,name:l,revision:f,policy:v,currentNLS:C,collabSpace:d,isConfigured:A,image:u,icon:p,ownerFullName:h};a.push(S)}var y={};y.contextInfo=a,y.contextId=o,t(y)})})},l.showRMBMenuOnGrid=function(e,t){return new Promise(function(n,o){var s="false";t.cellInfos.nodeModel.getTreeDocument().getSelectedNodes().length>1&&(s="true");var c=t.cellInfos.nodeModel.options.grid.id,d=t.cellInfos.nodeModel.options.grid.type,p=t.cellInfos.nodeModel.options.grid.name,u=t.cellInfos.nodeModel.options.grid.title,h=t.cellInfos.nodeModel.options.grid.type,m={objectId:c,objectType:d,type:h,displayName:p,displayType:u,facetName:"context"};[].push(m);var g=i.openWith(m);if("false"==s)var f=a("DS/ENOChangeActionUX/scripts/Views/CAContextDataGridLayout");var C=[],v=[];v.push(g),Promise.all(v).then(function(i){null!=i[0]&&C.push(i[0]),C.push(l.getProperiesMenu(e,t));var o=[];o.push(c),r.getDocuments(o).then(function(i){"TRUE"===i[0].dataelements.isDocumentType&&(C.push(l.getDownloadMenu(o)),C.push(l.getPreviewMenu(o))),f.userAccess&&f.userAccess.DeleteContext&&"true"===f.userAccess.DeleteContext&&C.push(l.getDeleteMenu(e,t)),n(C)})})})},l.getProperiesMenu=function(e,t){return{type:"PushItem",title:s.ECM_CA_Properties,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-attributes"},action:{callback:function(){var e=t.cellInfos.nodeModel.options.grid.id;o.createPropertiesComponent(e)}}}},l.getDeleteMenu=function(e,t){return{type:"PushItem",title:s.ECM_CA_Remove_context,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-trash"},action:{callback:function(){require(["DS/ENOChangeActionUX/scripts/Views/CAContextDataGridLayout"],function(e){e.removeContext(t.cellInfos)})}}}},l.getDownloadMenu=function(e){return{type:"PushItem",title:s.ECM_CA_Download,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-download"},action:{callback:function(){r.download(e)}}}},l.getPreviewMenu=function(e){return{type:"PushItem",title:s.ECM_CA_Preview,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x fonticon-eye"},action:{callback:function(){r.preview(e)}}}},l}),define("DS/ENOChangeActionUX/scripts/Models/CARealizedModel",["UWA/Class/Model","DS/ENOChangeActionUX/scripts/Models/CARealizedActivityModel","UWA/Class/Promise","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e,t,i,n){"use strict";var o="Cannot be found";return e.extend({idAttribute:"id",fetch:function(e){var i=this;this.set("Access",!0),this.id=this.get("where").id;var a=this.get("where").info;this.set("id",this.get("where").id),this.set("operation","Modified"),a.currentNLS!=o&&this.set("maturity",a.currentNLS),a["display name"]!=o&&"Access denied"!=a["display name"]?(this.set("name",a["display name"]),this.set("objectName",a["display name"]),this.set("objectTitle",a["display name"])):a["display name"]==o?(this.set("name",a.typeNLS),this.set("objectName",a.typeNLS),this.set("objectTitle",n.ECM_CA_Cannot_be_found)):(this.set("name",a.typeNLS),this.set("objectName",a.typeNLS),this.set("objectTitle",n.ECM_CA_Access_Denied)),a.revision!=o?this.set("revision",a.revision):this.set("revision",""),this.set("type",a.typeNLS),this.set("objectType",a.type),""!=this.get("maturity")&&"Access denied"!=this.get("maturity")&&"Cannot be found"!=this.get("maturity")&&null!=this.get("maturity")||this.set("Access",!1);var s=UWA.is(a.isConfigured)?a.isConfigured:"false";if(this.set("isConfigured",s),UWA.is(this.get("amo"))){var r=new UWA.Class.Collection,l=this.get("amo"),c=this.get("id");Array.isArray(l)&&(l.forEach(function(e){if(null!=r.get(e.id));else{var n=new t(e,{parse:!0});UWA.is(n.get("Afterobject"))&&n.get("Afterobject").id!=c&&(n.get("ActivityDetails")[0].AfterExists=!0,n.get("ActivityDetails")[0].After=n.get("Afterobject")),UWA.is(n.get("Beforeobject"))&&n.get("Beforeobject").id!=c&&(UWA.is(n.get("Afterobject"))?UWA.is(n.get("Afterobject"))&&n.get("Afterobject").id!=n.get("Beforeobject").id&&(n.get("ActivityDetails")[0].BeforeExists=!0,n.get("ActivityDetails")[0].Before=n.get("Beforeobject")):(n.get("ActivityDetails")[0].BeforeExists=!0,n.get("ActivityDetails")[0].Before=n.get("Beforeobject"))),n.get("ActivityDetails")[0].AfterExists||n.get("ActivityDetails")[0].BeforeExists||(n.get("ActivityDetails")[0].sameAsWhere=!0),"false"==i.get("isConfigured")?(i.set("status",n.get("status"),{silent:!0}),i.set("receivingChangeAction",n.get("receivingChangeAction"),{silent:!0}),i.set("transferReason",n.get("transferReason"),{silent:!0}),i.set("transferReasonNLS",n.get("transferReasonNLS"),{silent:!0})):n.get("ActivityDetails").forEach(function(e){e.TransferExists=!0}),r.add(n)}}),this.set("activities",r,{silent:!0}))}return e.ajax=function(e,t){t.onComplete({})},e.url="dummyURL",this._parent(e)},parse:function(e){var t=[],i=this.get("activities");UWA.is(i)?(i.forEach(function(e,i){UWA.is(e.get("Afterobject"))&&UWA.is(e.get("Afterobject").id)&&t.push(e.get("Afterobject").id.replace("pid:","")),UWA.is(e.get("Beforeobject"))&&e.get("Beforeobject").id&&t.push(e.get("Beforeobject").id.replace("pid:",""))}),UWA.is(e)&&UWA.is(e.additionObjectInfo)&&(t.forEach(function(t){i.forEach(function(i,a){UWA.is(i.get("Afterobject"))&&(UWA.is(i.get("Afterobject").id)&&t==i.get("Afterobject").id.replace("pid:","")&&UWA.is(e.additionObjectInfo[t])?(i.get("Afterobject").name=e.additionObjectInfo[t].objectName,i.get("Afterobject").title==o?i.get("Afterobject").title=n.ECM_CA_Cannot_be_found:"Access denied"==i.get("Afterobject").title?i.get("Afterobject").title=n.ECM_CA_Access_Denied:i.get("Afterobject").title=e.additionObjectInfo[t].objectTitle,i.get("Afterobject").icon=e.additionObjectInfo[t].icon,i.get("Afterobject").collabSpace=e.additionObjectInfo[t].collabSpace,i.get("Afterobject").ownerFullname=e.additionObjectInfo[t].ownerFullname):UWA.is(i.get("Afterobject").id)||(i.get("Afterobject").title=n.ECM_CA_Cannot_be_found)),UWA.is(i.get("Beforeobject"))&&(UWA.is(i.get("Beforeobject").id)&&t==i.get("Beforeobject").id.replace("pid:","")&&UWA.is(e.additionObjectInfo[t])?(i.get("Beforeobject").name=e.additionObjectInfo[t].objectName,i.get("Beforeobject").title==o?i.get("Beforeobject").title=n.ECM_CA_Cannot_be_found:"Access denied"==i.get("Beforeobject").title?i.get("Beforeobject").title=n.ECM_CA_Access_Denied:i.get("Beforeobject").title=e.additionObjectInfo[t].objectTitle,i.get("Beforeobject").icon=e.additionObjectInfo[t].icon,i.get("Beforeobject").collabSpace=e.additionObjectInfo[t].collabSpace,i.get("Beforeobject").ownerFullname=e.additionObjectInfo[t].ownerFullname):UWA.is(i.get("Beforeobject").id)||(i.get("Beforeobject").title=n.ECM_CA_Cannot_be_found))})}),this.unset("activities",{silent:!0}),this.set("activities",i))):(this.set("amo",e.amo),this.set("where",e.where));return this},enrichActivities:function(e){return new i(function(t,n){var o=[];e.get("activities").forEach(function(e,t){UWA.is(e.get("Afterobject"))&&UWA.is(e.get("Afterobject").id)&&1==e.get("Afterobject").Access&&o.push(e.get("Afterobject").id.replace("pid:","")),UWA.is(e.get("Beforeobject"))&&UWA.is(e.get("Beforeobject").id)&&1==e.get("Beforeobject").Access&&o.push(e.get("Beforeobject").id.replace("pid:",""))}),o.length>0&&require(["DS/ENOChgServices/scripts/services/ChgIDCardCommonServices"],function(e){e.getAdditionObjectInfo(o).then(function(e){t(e)},function(e){return console.log("failed from getting additional info"),i.reject(e)})})})}})}),define("DS/ENOChangeActionUX/scripts/Collection/CARealizedCollection",["UWA/Core","UWA/Class/Collection","DS/ENOChangeActionUX/scripts/Models/CARealizedModel"],function(e,t,i){"use strict";return t.extend({model:i,setup:function(){},fetch:function(e){var t;return t=e.data=this.operations=e.RealizedArr,e.ajax=function(e,i){i.onComplete(t)},this.url="dummyURL",this._parent(e)}})}),define("DS/ENOChangeActionUX/scripts/Views/CAFlowDownRealizedForm",["DS/E6WCommonUI/Views/DetailsDisplayView","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","UWA/Date","UWA/Controls/Abstract","DS/PlatformAPI/PlatformAPI","DS/UIKIT/Input/Button","DS/ENOChangeActionUX/scripts/Search","DS/ENOChangeActionUX/scripts/Models/CAFlowDownModel","DS/ENOChangeActionUX/scripts/Views/CACustomTitleView","DS/ENOChangeActionUX/scripts/Views/CACustomSeverityView","DS/ENOChangeActionUX/scripts/CASpinner","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgRealizedServices","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgErrors","DS/TransientWidget/TransientWidget","DS/ENOChangeActionUX/scripts/Controller/CADependencyGridController","require"],function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v,A){"use strict";var w=a.extend({displayViewModel:null,proposedCallback:null,selectedOperation:null,detailsView:null,allCATypes:[],init:function(t){var i=this;i.allCATypes=[],1==h.getGlobalVariable().changeActionSubTypePresent&&h.getGlobalVariable().changeActionSubTypes.forEach(function(e){var n={};n.actualValue=e.value,n.displayValue=e.label,"Change Action"==e.value&&(t.defaultCATypeNLS=e.label),i.allCATypes.push(n)}),this.proposedCallback=t.callback,this.displayViewModel=new c(t,{parse:!0}),this.detailsView=new e,this.options=t},getHeading:function(){return"Existing"===this.displayViewModel.get("mode")?t.ECM_CA_FLOWDOWN_TO_EXISTING:"NewCA"===this.displayViewModel.get("mode")?t.ECM_CA_FLOWDOWN_TO_NEW:void 0},getBody:function(){var e=this,t=UWA.createElement("div",{id:"formBody"});new(UWA.Class.View.extend({setup:function(){"Existing"===e.options.mode&&this.listenTo(this.model,"onChange",this.render),this.listenTo(this.model,"onChange:createObjectTitle",e.updateBtnState)},render:function(){t.setContent(""),e.detailsView.setConfig(e.getConfig()),e.detailsView.model=e.displayViewModel,e.detailsView.tenant=h.getGlobalVariable().tenant,e.detailsView.context=enoviaServer.context,e.detailsView.render().inject(t),arguments&&arguments.length>0&&e.updateBtnState(arguments[0])}}))({model:e.displayViewModel}).render();return t},getConfig:function(){var e,i=[];e=new Date;var n,o="";o=o+"NOT ("+this.options.contextCAId.replace("pid","physicalid")+")";var a=new l({title:"Change Action",precond:n='AND (current:Prepare OR current:"In Work") AND (NOT flattenedtaxonomies:"interfaces/Change On Hold")',excludeList:o,from:"realized",types:"Change Action"},!1);return"Existing"===this.displayViewModel.get("mode")&&i.push({readWrite:!UWA.is(this.displayViewModel.id),type:"object",name:"proposedObject",label:t.ECM_CA_Widget_Title,attributeToDisplay:"objectName",singleObjectOnly:!0,searchTitle:t.ECM_CA_Widget_Title,searchTypes:"Change Action",required:!UWA.is(this.displayViewModel.id),imageAttribute:"image",typeAheadCallback:this.displayViewModel.proposedTypeAheadCallback,fieldHTMLId:"proposedObject",excludeSearchTypes:o+n,search:a}),"NewCA"===this.displayViewModel.get("mode")&&(1==h.getGlobalVariable().changeActionSubTypePresent&&i.push({required:!0,readWrite:"true",name:"caType",label:t.ECM_CA_Type,type:"select",values:this.allCATypes}),i.push({required:!0,label:t.ECM_CA_Pref_Title_Label,name:"createObjectTitle",customView:d}),i.push({readWrite:"true",name:"descriptionOfObj",label:t.ECM_CA_Realized_Transfer_Description,type:"textarea",numberOfDisplayLines:3,numberOfEditableLines:3}),i.push({label:t.ECM_CA_Realized_Transfer_Severity,name:"severity",customView:p}),i.push({label:t.ECM_CA_Realized_Transfer_DueDate,name:"dueDate",readWrite:"true",type:"date",min:e})),i},getFooter:function(){var e=this,i=w.footer=UWA.Element("div",{});new r({value:t.ECM_CA_Realized_Flowdown_OK,className:"primary proposedButtons",disabled:!0}).inject(i).elements.input.onclick=function(){e.onSaveButtonClick()};new r({value:t.ECM_CA_Realized_Transfer_Cancel,className:"proposedButtons"}).inject(i);return i},onSaveButtonClick:function(){s.subscribe("dependency:update:UX"+widget.id,function(){v.updateUX(),s.unsubscribe("dependency:update:UX"+widget.id)});var e=function(e){try{let t=A("DS/ENOChgProbes/scripts/ChgCloudProbeUtils");var i;i="attribute_EstimatedCompletionDate"==e.changeaction.attributes[2].name?{type:e.changeaction.type,isKindOfType:"Change Action",dueDate:e.changeaction.attributes[2].value}:{type:e.changeaction.type,isKindOfType:"Change Action",dueDate:""},t.cloudProbeUtils.sendChgObjectCreateTrackerEvent({createData:i,View:"Flowdown"})}catch(e){console.log(e)}var n=g.getCurrentModel(),o="";n&&(o=n.get("synopsis")),e&&e.changeaction&&f.success(t.ECM_DOWNSTREAM_FLOWDOWN_DEPENDENCY_SUCCESS+": "+o,!1),u.endWait(widget.body)};if(this.detailsView.isModelValid()){if("NewCA"===this.displayViewModel.get("mode")){var i=this.getCreateEditData(this.displayViewModel),n=this.getFlowDownData(this.displayViewModel);m.flowDownToNewChangeAction(i,n,e)}else if("Existing"===this.displayViewModel.get("mode")){n=this.getFlowDownData(this.displayViewModel);var o={id:"pid:"+this.displayViewModel.get("proposedObject").objectID,name:this.displayViewModel.get("proposedObject").objectActualName,originChangeActionId:this.options.contextCAId};m.flowDownToExistingChangeAction(o,n,e)}u.doWait(widget.body)}else f.error(t.ECM_CA_Realized_Transfer_MandAttrErr)},getCreateEditData:function(e){var t="";if(UWA.is(e)){var i=e.get("createObjectTitle"),n=e.get("descriptionOfObj");n||(n="");var a=e.get("severity"),s="";if(UWA.is(e.get("dueDate"))){var r,l;r=e.get("dueDate").actualValue,s=(l=new Date(r)).getMonth()+1+"/"+l.getDate()+"/"+l.getFullYear();var c=o.strftime(new Date(s),"%Y-%m-%d")}var d="Change Action";1==h.getGlobalVariable().changeActionSubTypePresent&&(d=e.get("caType").actualValue),t={type:d,description:n,synopsis:i,severity:a,scheduledCompletionDate:c}}return t},getFlowDownData:function(e){return{idsToFlowdown:this.options.ids}},updateBtnState:function(){var e=arguments[0];if(e){var t,i=e.get("createObjectTitle"),n=e.get("proposedObject");if(i&&""!=i.trim()||n&&""!=n.objectID){if(w.footer)(t=w.footer).firstChild.disabled=!1,t.firstChild.removeClassName("disabled")}else if(w.footer)(t=w.footer).firstChild.disabled=!0,t.firstChild.addClassName("disabled")}}});return w}),define("DS/ENOChangeActionUX/scripts/Services/CARealizedViewServices",["UWA/Core","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChangeActionUX/scripts/Collection/CARealizedCollection","DS/ENOChangeActionUX/scripts/Models/CARealizedModel","DS/ENORIPE_Relations/RelationsTabSettings","DS/ENORIPE_Relations/views/RelationsTab","DS/ENOFloatingPanel/ENOFloatingPanel","DS/ENOChangeActionUX/scripts/Views/CAFlowDownRealizedForm","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/ENOChgServices/scripts/services/ChgDataService","DS/UIKIT/Popover","DS/ENOChangeActionUX/scripts/Views/CAPopOverBodyView","DS/PlatformAPI/PlatformAPI","UWA/Utils/InterCom","DS/ENOChgServices/scripts/services/ChgErrors","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e,t,i,n,o,a,s,r,t,l,c,d,p,u,h,m,g,f){var C={proposedFlowdownMapping:{},selectedProposedItems:{},flowdownForInfo:[],flowdownandForInfo:[],createRealizedCollection_space:function(e,t){var i=new UWA.Class.Collection;return Array.isArray(e)&&e.forEach(function(e){if(null!=i.get(e.where.id));else{var t=new n(e);t.fetch({}),i.add(t)}}),i},createRealizedCollection:function(e,n){if(t.getGlobalVariable().is3DSpace)return this.createRealizedCollection_space(e,n);var o={RealizedArr:e},a=new i;return a.fetch(o),a.forEach(function(e){e.fetch(o)}),a},loadRelationsExplorer:function(e){let i=[e.model.get("id").substr(4)],n=t.getGlobalVariable().getSecurityContext(),o=widget.id,a="ENORIPE-InApp-"+o,s=a+"/onOK",r=a+"/onCancel";h.unsubscribe(s),h.unsubscribe(r);let l=[];i.forEach(function(e){var i={envId:t.getGlobalVariable().tenant,serviceId:"3DSpace",contextId:n,objectId:e.replace("pid:","")};l.push(i)});var c=widget.getValue("appId");c||(c="ENOWCHA_AP"),h.subscribe(s,function(t){var i=[];let n=[];for(let e in t)n.push(t[e].id);d.getObjectInfo(n,["type","name","title","revision"]).then(function(t){console.log(t);for(let e in t){var n=t[e],o={proposedId:n.id,proposedTitle:n.dataelements.title,objName:n.dataelements.name,proposedRevision:n.dataelements.revision};i.push(o)}if(C[e.idToSetObjs]){C[e.idToSetObjs].fromRelationsTab||(C[e.idToSetObjs].fromRelationsTab=[]);var a=C[e.idToSetObjs].fromRelationsTab.map(function(e){return e.proposedId});for(var s in i){(o=i[s])&&a&&-1===a.indexOf(o.proposedId)&&C[e.idToSetObjs].fromRelationsTab.push(o)}}else C[e.idToSetObjs]={fromRelationsTab:i};e.callback(C[e.idToSetObjs])})}),h.subscribe(r,function(e){console.log("Cancel button clicked...!")});var p={protocol:"3DXContent",version:"1.1",source:c,widgetId:widget.id,inAppMode:!0,inAppOptions:{relationSet:"AutoModeProfile",localUID:o},data:{items:l}},u=UWA.is(widget)&&widget.id?"caCompassSocket_"+widget.id:"caCcompassSocket";this._compass_socket||(this._compass_socket=new m.Socket(u),this._compass_socket.subscribeServer("com.ds.compass",t.getGlobalVariable().compassWindow)),this._compass_socket.dispatchEvent("onSetX3DContent",p,u);var g={appId:"ENORIPE_AP"};this._compass_socket.dispatchEvent("onLaunchApp",g,u)},loadRelationsTab:function(e){h.unsubscribe("DS/PADUtils/PADCommandProxy/select");var i=this,n=e.model.get("id").substr(4),r=new UWA.Class.Model({source:"3DSpace",tenant:t.getGlobalVariable().tenant,objectId:n,id:n}),l={getPlatformID:function(){return t.getGlobalVariable().tenant},getServiceID:function(){return"3DSpace"}};o.isAvailable(l,{isDraggable:!0,isProfilesVisible:!0,appID:"ENORIPE_ECM",isExternal:!0}).then(function(t){var n=e.model.get("objectInfo"),o=new s({animate:!0,autocenter:!0,closable:!0,limitParent:!1,overlay:!1,resizable:!0,visible:!0,header:"<h4>"+f.ECA_CA_RELATIONAL_EXPLORER_HEADING+" - "+n+"</h4>",footer:"<button type='button' class='btn btn-primary'>"+f.ECM_CA_Close+"</button> ",events:{onClose:function(){}}});o.getContent().getElements(".btn").forEach(function(e){e.addEvent("click",function(){o.hide()})});var l=new UWA.createElement("div",{styles:{height:"500px",width:"500px"}});l.inject(o.elements.body),o.inject(widget.body).show(),i.facetRelationsModule=new a,i.facetRelationsModule.updateFacetExternal(r),i.facetRelationsModule.elements.container.inject(l),h.subscribe("DS/PADUtils/PADCommandProxy/select",function(t){if(widget&&t&&t.data){var i=t.data.paths;if(i&&Array.isArray(i)){var n=[];for(var o in i){var a=i[o],s=t.data.attrData;if(s)for(var r in s){var l=s[r];if(l.id===a[0]){var c={proposedId:l.id,proposedTitle:l.name,objName:l.name,proposedRevision:l.revision};n.push(c)}}}if(C[e.idToSetObjs]){C[e.idToSetObjs].fromRelationsTab||(C[e.idToSetObjs].fromRelationsTab=[]);var d=C[e.idToSetObjs].fromRelationsTab.map(function(e){return e.proposedId});for(var o in n){(c=n[o])&&d&&-1===d.indexOf(c.proposedId)&&C[e.idToSetObjs].fromRelationsTab.push(c)}}else C[e.idToSetObjs]={fromRelationsTab:n};e.callback(C[e.idToSetObjs])}}})})},launchSearchForSelectedProposed:function(e){if(t.getGlobalVariable().isNative){this.callbackForAddSelectedProposed=e.callback,this.objectIDSelected=e.idToSetObjs;c.DispatchEventToWin("Search_Flowdown_Proposed","SearchFlowdownProposed")}else{C.OnSearchComplete=C.OnSearchComplete.bind(this),this.callbackForAddSelectedProposed=e.callback,this.objectIDSelected=e.idToSetObjs;var i=C.SearchObj=l.activateSearch(t.getGlobalVariable().proposedSearchType,"multiple_proposed");l.search(f.ECM_SELECTED_PROPOSED_OBJECTS,t.getGlobalVariable().proposedSearchType,C.OnSearchComplete,"multiple_proposed",i)}},OnSearchComplete:function(e){if(t.getGlobalVariable().isNative){for(var i=e.split("~"),n=[],o=0;o<i.length;o++)n.push(i[o]);for(var a=[],s=0;s<i.length;s++)a.push(n[s].split(","));var r=[];for(o=0;o<a.length;o++){var l={proposedId:(c=a[o])[0],objName:c[1],proposedTitle:c[2],proposedRevision:c[3]};r.push(l)}}else for(r=[],o=0;o<e.length;o++){var c;l={objName:(c=e[o])[1],proposedId:c[0],proposedTitle:c[5],proposedRevision:c[6]};r.push(l)}C[this.objectIDSelected]?(C[this.objectIDSelected].fromFreeSearch||(C[this.objectIDSelected].fromFreeSearch=[]),C[this.objectIDSelected].fromFreeSearch=C[this.objectIDSelected].fromFreeSearch.concat(r)):C[this.objectIDSelected]={fromFreeSearch:r},this.callbackForAddSelectedProposed(C[this.objectIDSelected])},buildPanelForFlowdownRealized:function(t){var i=t.contextObj,n=t.moreInfo;if(n){var o={ids:n.ids,contextCAId:i.model.get("id"),mode:n.mode,Entity:"ChangeAction",model:new UWA.Class.Model};o.callback=i.AfterSaveTransReal;var a=new r(o),l=new s({animate:!0,autocenter:!0,closable:!0,limitParent:!1,overlay:!1,resizable:!0,visible:!0,header:"<h4> Flowdown to new Change Action</h4>",footer:"<button type='button' class='btn btn-primary'>Close</button> ",events:{onClose:function(){}}});l.getContent().getElements(".btn").forEach(function(e){e.addEvent("click",function(){l.hide()})});var c=new UWA.createElement("div",{styles:{height:"500px",width:"500px"}});c.inject(l.elements.body);e.extendElement(document.body).getElement("#skeleton-container");l.inject(widget.body).show(),a.getBody().inject(c)}},setSelectedProposedPerRealizedObject:function(e){this.selectedproposedObjectsArr=[],this.selectedproposedObjectsArr=e},getSelectedProposedPerRealizedObject:function(){return this.selectedproposedObjectsArr},setFlowdownForInfo:function(e){this.flowdownForInfo.push(e)},getFlowdownForInfo:function(){return this.flowdownForInfo},setInfoForSelectedItem:function(e){var t=Object.keys(e);for(var i in t){var n=e[t[i]];this.flowdownandForInfo[t[i]]=n}},getInfoForSelectedItem:function(){return this.flowdownandForInfo},setSelectedObjectIds:function(e){this.selectedObjectIds||(this.selectedObjectIds=[]),-1===this.selectedObjectIds.indexOf(e)&&this.selectedObjectIds.push(e)},getSelectedObjectIds:function(){return this.selectedObjectIds},setflowdownActivityPointer:function(e){this._flowdownActivityPointer=e},getflowdownActivityPointer:function(){return this._flowdownActivityPointer},setflowdownOperationPointer:function(e){this._flowdownOperationPointer=e},getflowdownOperationPointer:function(){return this._flowdownOperationPointer}};return C}),define("DS/ENOChangeActionUX/scripts/Views/CAReferentialView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChangeActionUX/scripts/Models/CAReferentialModel","DS/W3DXComponents/Views/Layout/GridScrollView","DS/W3DXComponents/Collections/ActionsCollection","DS/W3DXComponents/Views/Layout/TableScrollView","DS/W3DXComponents/Views/Item/RowView","DS/W3DXComponents/Views/Item/SetView","DS/DataDragAndDrop/DataDragAndDrop","DS/DocumentManagement/DocumentManagement","DS/ENOChangeActionUX/scripts/CAWidgetConfiguration","DS/ENOChangeActionUX/scripts/CASpinner","DS/W3DXComponents/Views/EmptyView","DS/ENOChangeActionUX/scripts/Views/CACustomReferentialTileView","DS/ENOChangeActionUX/scripts/Views/CACustomizedRefActionsView","DS/ENOChangeActionUX/scripts/CATagNavigatorProxy","UWA/Controls/Input","DS/i3DXCompassPlatformServices/OpenWith","DS/PlatformAPI/PlatformAPI","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/ENOChgServices/scripts/services/ChgPropertiesServices","DS/ENOChgServices/scripts/services/ChgReferentialServices","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENO6WPlugins/jQuery","DS/ENOChgGovernanceUX/scripts/util/DocumentUtils"],function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v,A,w,b,S,y,_,E,D){"use strict";var O={_model:null,caTagNavigatorProxy:null,selectedModelsForDrag:{},isCheckSelected:!1,multiSelOn:!1,_createView_Referential:function(t,i){return e.extend({model:i,setup:function(){var e=this;if(e.model){var t=this.model.get("referentials");O.originalReferentialsCollection=new UWA.Class.Collection(t.toArray());var i=O.caTagNavigatorProxy=this.caTagNavigatorProxy=new g;i._initTaggerProxy("Referential").then(function(n){i._setSubjectTags(t,"Referential");var o=e._externalEvents={onReferentalTaggerFilterChange:function(e){O.filterTaggerChange(e)}};e.listenTo(i,o),w.setTaggerObject("Referential",i)},function(e){return console.log("Tagger initilization failed"),Promise.reject(e)})}},render:function(){w.setCurrModel(this.model),O._model=this.model;var e=O.refrerentialView=O.getReferentialListView(this.model.get("referentials")),t={onMultiselOff:function(){O.isCheckSelected=!1,O.multiSelOn=!1;var e=Object.keys(O.selectedModelsForDrag);for(var t in e)delete O.selectedModelsForDrag[e[t]]},onMultiselOn:function(){O.isCheckSelected=!0,O.multiSelOn=!0}};this.listenTo(e,t),this.listenTo(this.model,"onChange:referentials",O.updateUIOnRefresh),this.listenTo(this.model,"onChange:userAccess",O.updateHeaderOnAccessUpdate);var i=new UWA.Element("div",{styles:{height:"100%",width:"99.9%"}});i.setAttributes({id:"divForReferentialContent"}),i.inject(this.container),e.render().inject(i),setTimeout(function(){var e=document.querySelector("#divForReferentialContent");e&&O.makeDroppable(e)},1e3),w.setCallbacksForOpenWith("referential")}})},getReferentialListView:function(e){var i=t.ECM_CA_Table_Header_Title,o=t.ECM_CA_Table_Header_Name;return new r({collection:e,detail:{title:t.ECM_CA_CounterView_Title},actions:{collection:O.getTopActions(),events:{onActionClick:function(e){var t=e.model.get("id");switch(t){case"add":O.searchReferential();break;case"upload":O.uploadReferential();break;default:console.log(t+" is not permitted.")}}},view:m},buildMultiselActions:function(e){var i=[],n=!0,o=w.getCurrentModel();if(UWA.is(o.get("userAccess"))){var a=o.get("userAccess");(a.DeleteReferential&&"false"===a.DeleteReferential||!a.DeleteReferential)&&(n=!1)}var s={id:"download",text:t.ECM_CA_Download,fonticon:"download",icon:"I_ChangeCnxObjDownload",multisel:!0,handler:function(e){var i=[];e.forEach(function(e){i.push(e.get("id").slice(4))});var n=[];D.getDocuments(i).then(function(e){e.forEach(function(e){"TRUE"===e.dataelements.isDocumentType&&n.push(e.id)}),n.length<i.length&&_.info(t.ECM_CA_Download_Skipped),D.download(n)})}};if(i.push(s),!1===n)return i;var r={id:"delete",text:t.ECM_CA_Referential_MultiSelActions_Remove,fonticon:"trash",icon:"I_ChangeCnxObjTrash",multisel:!0,handler:function(e){var t=[];e.forEach(function(e){t.push(e.get("id"))}),O.removeReferential(t,!0)}};return A.getGlobalVariable().isNative&&(r.icon="I_ChangeCnxObjTrash"),i.push(r),i},contents:{views:[{id:"tile",title:t.ECM_CA_Switch_TileView,view:n,itemView:h,default:!0},{id:"table",title:t.ECM_CA_Switch_TableView,view:a,itemView:s}],selectionMode:"nullToMany",useInfiniteScroll:!1,usePullToRefresh:!1,emptyView:u.extend({defaultOptions:{icon:"drag-drop",title:t.ECM_CA_Referential_Drop_Here}}),events:{onItemViewClick:function(){var e=document.createElement("input");if(e.setAttribute("data-pid",arguments[1].model.get("id").replace("pid:","")),e.setAttribute("data-type",arguments[1].model.get("objectType")),O.selectedModelsForDrag[arguments[1].model.get("id")]){!0===O.isCheckSelected&&delete O.selectedModelsForDrag[arguments[1].model.get("id")],0===(t=Object.keys(O.selectedModelsForDrag)).length&&!1===O.multiSelOn&&(O.isCheckSelected=!1)}else{if(!O.isCheckSelected){var t=Object.keys(O.selectedModelsForDrag);for(var i in t)delete O.selectedModelsForDrag[t[i]];A.getGlobalVariable().arrOid&&A.getGlobalVariable().arrOid.length&&A.getGlobalVariable().arrOid.splice(0,A.getGlobalVariable().arrOid.length)}e.setAttribute("class","selected"),O.selectedModelsForDrag[arguments[1].model.get("id")]=arguments[1].model}var n={};n.id=arguments[1].model.get("id").replace("pid:",""),n.name=arguments[1].model.get("objectName"),n.title=arguments[1].model.get("objectTitle"),n.type=arguments[1].model.get("objectType"),e.setAttribute("data-selectedItem",JSON.stringify(n)),d.onClickItem.call(e,widget,A.getGlobalVariable())},onItemViewCheck:function(){var e=document.createElement("input");(e.setAttribute("data-pid",arguments[1].model.get("id").replace("pid:","")),e.setAttribute("data-type",arguments[1].model.get("objectType")),arguments[2].target.checked)?(O.caTagNavigatorProxy.deactivateTaggerProxy(),O.selectedModelsForDrag[arguments[1].model.get("id")]=arguments[1].model,e.setAttribute("class","selected"),O.isCheckSelected=!0):(O.caTagNavigatorProxy.activateTaggerProxy(),O.selectedModelsForDrag[arguments[1].model.get("id")]&&(delete O.selectedModelsForDrag[arguments[1].model.get("id")],0===Object.keys(O.selectedModelsForDrag).length&&!1===O.multiSelOn&&(O.isCheckSelected=!1)));var t={};t.id=arguments[1].model.get("id").replace("pid:",""),t.name=arguments[1].model.get("objectName"),t.title=arguments[1].model.get("objectTitle"),t.type=arguments[1].model.get("objectType"),e.setAttribute("data-selectedItem",JSON.stringify(t)),d.onClickItem.call(e,widget,A.getGlobalVariable())},onItemViewDrag:function(){if((i=Object.keys(O.selectedModelsForDrag)).length&&O.isCheckSelected){var e=!1,t=arguments[1].model.get("id"),i=Object.keys(O.selectedModelsForDrag);for(var n in i){if(O.selectedModelsForDrag[i[n]].id===t){e=!0;break}}if(e)arguments[1]=O.selectedModelsForDrag;else(o={})[arguments[1].model.get("id")]=arguments[1].model,arguments[1]=o}else{var o;(o={})[arguments[1].model.get("id")]=arguments[1].model,arguments[1]=o}var a={caId:O._model.get("id")};w.onItemViewDragForContents(arguments,a)}},headers:[{property:"objectTitle",sortable:!0,label:i},{property:"objectName",sortable:!0,label:o},{property:"current",sortable:!0,label:t.ECM_CA_Table_Header_Maturity},{property:"ownerFullname",sortable:!0,label:t.ECM_CA_Table_Header_Owner},{label:t.ECM_CA_Table_Header_Action,actions:!0}],itemViewOptions:O.getitemViewOptions()}})},getitemViewOptions:function(){return{mapping:{title:"objectTitle",subtitle:"objectName",content:"content"},actionButtonBinding:function(e){e.container.getElement(".actions-inline-dotted").removeClassName("hidden"),e.container.getElement(".actions-inline-dotted").addEvent("click",function(t){e.dispatchEvent("onActionClickDotted",e)})},events:{onActionClickDotted:function(e){O.itemView=e,e.model.get("Access")&&A.getGlobalVariable().isNative?b.DispatchEventToWin("Referential_ContextMenu",e.model.get("id").replace("pid:","")):O.DisplayContextMenu([])}}}},DisplayContextMenu:function(e){var i=this,n=[];if(i.itemView&&i.itemView.model&&i.itemView.model.get("Access")){var o={objectId:i.itemView.model.get("id").replace("pid:",""),objectType:i.itemView.model.get("objectType"),displayName:i.itemView.model.get("objectTitle"),displayType:i.itemView.model.get("type"),facetName:"referential"},a={facetName:"referential",selectedItem:o};w.setSelectedItem(a);var s=[];s.push(o);var r=w.getContentForCompassInteraction(s),l=new C;l.set3DXContent(r,!0);var c=[];UWA.is(l.retrieveCompatibleApps,"function")&&l.retrieveCompatibleApps(function(o){o.forEach(function(e){c.push({text:e.text,fonticon:e.fonticon,multisel:!1,handler:e.handler})}),c.length>0&&A.getGlobalVariable().isNative?"true"==A.getGlobalVariable().CHG_OPENWITH&&n.push({id:"OpenWith",text:t.ECM_CA_Command_OpenWith_RichClient,fonticon:"export",icon:"fonticon-export",multisel:!1,items:c}):c.length>0&&n.push({id:"OpenWith",text:t.ECM_CA_Command_OpenWith,fonticon:"export",icon:"fonticon-export",multisel:!1,items:c}),A.getGlobalVariable().isNative||"false"==A.getGlobalVariable().CHG_OPEN_WITH_COLLAB||n.push({id:"Details",text:t.ECM_CA_Explore_With_Central,fonticon:"window",icon:"fonticon-window",multisel:!0,handler:function(e){var t="/common/emxTree.jsp?mode=insert&objectId="+i.itemView.model.get("id").replace("pid:",""),n=A.getGlobalVariable().getSecurityContext().replace("ctx::",""),o=A.getGlobalVariable().computeUrl("/common/emxFrameworkContextManager.jsp?SecurityContext="+n+"&forwardUrl="+t),a=window.open();a.opener=null,a.location.href=o}}),n.push({id:"Properties",text:t.ECM_CA_Properties,fonticon:"attributes",icon:"I_ChangeCnxObjProps",multisel:!0,handler:function(e){var t=i.itemView.model.get("id").replace("pid:","");S.createPropertiesComponent(t)}}),D.getDocuments([i.itemView.model.get("id").slice("4")]).then(function(o){var a={id:"download",text:t.ECM_CA_Download,fonticon:"download",icon:"I_ChangeCnxObjDownload",multisel:!0,handler:function(e){var t=i.itemView.model.get("id").slice("4"),n=[];n.push(t);D.download(n)}},s={id:"preview",text:t.ECM_CA_Preview,fonticon:"eye",icon:"I_ChgPreviewIcon",multisel:!0,handler:function(e){var t=i.itemView.model.get("objectId").slice("4"),n=[];n.push(t),D.preview(n)}};i.itemView&&i.itemView.model&&"TRUE"===o[0].dataelements.isDocumentType&&(n.push(a),n.push(s));var r=!0,l=w.getCurrentModel();if(UWA.is(l.get("userAccess"))){var c=l.get("userAccess");(c.DeleteReferential&&"false"===c.DeleteReferential||!c.DeleteReferential)&&(r=!1)}!0===r&&n.push({id:"remove",text:t.ECM_CA_Remove_Referential,fonticon:"trash",icon:"I_ChangeCnxObjTrash",multisel:!0,handler:function(e){var t=i.itemView.model.get("id"),n=[];n.push(t),O.removeReferential(n,!1)}}),n.unshift.apply(n,e);var d=O.itemView.container.getElement(".actions-inline-dotted .action-icon-wrapper");w._initDropDown(n,d)})})}},getTopActions:function(){var e=!0,i=w.getCurrentModel();if(UWA.is(i)&&UWA.is(i.get("userAccess"))){var n=i.get("userAccess");(n.AddReferential&&"false"===n.AddReferential||!n.AddReferential)&&(e=!1)}var a=[];return e&&(a.push({id:"add",title:t.ECM_CA_Add_Referential,icon:"plus",overflow:!1}),a.push({id:"upload",title:t.ECM_CA_Upload_Referential,icon:"upload",overflow:!1})),new o(a)},makeDroppable:function(e){l.droppable(e,{drop:function(e,i,n){if(n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault(),n.dataTransfer&&n.dataTransfer.dropEffect&&(n.dataTransfer.dropEffect="copy"),UWA.is(n)&&UWA.is(n.dataTransfer.files)&&0!=n.dataTransfer.files.length){var o=n.dataTransfer.files;O.createDocument(o),O.AfterDrop()}else if(UWA.is(e)&&""!=e){var a=JSON.parse(e),s=w.checkTenantInforamation(a);if(0!=s.TenantInfoMissing.length)_.error(t.ECM_CA_Pref_PlatformMissing_Error);else if(0!=s.DiffTenantData.length)_.error(t.ECM_CA_Pref_PlatformDoesNotMatch_Error);else{a=w.removeDuplicatesToBeDroppedObjects(a);var r=w.filterBasedOnServiceId(a);if(r.incorrectServiceInfo&&Array.isArray(r.incorrectServiceInfo)&&r.incorrectServiceInfo.length>0){var l=t.ECM_WARN_DROP_SKIPPED+"<br/>";for(var c in r.incorrectServiceInfo)l+=r.incorrectServiceInfo[c]+"<br/>";_.warn(l,"false")}O.ExecuteDrop(r.dataJSON)}}else p.endWait(widget.body),_.error(t.ECM_CA_Drop_Not_Supported)},over:function(){arguments[0].setStyles({borderStyle:"solid",borderColor:"blue",borderWidth:"1px"})},leave:function(){arguments[0].setStyle("borderWidth","0px")}})},ExecuteDrop:function(e){if(e){var i=e.data.items;if(UWA.is(i)&&UWA.is(i.length)&&i.length>0){for(var n=[],o=0,a=0;a<i.length;a++){var s=[];-1!=O._model.get("referentialsExcludeList").indexOf("pid:"+i[a].objectId)?o++:(s.push(i[a].objectId),n.push(s))}0!=o&&_.warn(t.ECM_CA_Referential_Already_Added),0!=n.length&&O.addReferential(n)}else p.endWait(widget.body),_.error(t.ECM_CA_Drop_Not_Supported)}O.AfterDrop()},AfterDrop:function(){document.querySelector("#divForReferentialContent").setStyle("borderWidth","0px")},searchReferential:function(){if(A.getGlobalVariable().isNative){var e="";if(UWA.is(A.getGlobalVariable().referentialsSearchForbiddenType)&&UWA.is(A.getGlobalVariable().referentialsSearchForbiddenType)){e="(";var t=A.getGlobalVariable().referentialsSearchForbiddenType;t=t.split(","),E.each(t,function(t,i){e+=0!==t?" AND ":"flattenedtaxonomies:(",e+='NOT "types/'+i.trim()+'"'}),e+="))";var i=O._model.get("id")?O._model.get("id").slice(4):"";""!=i&&(e+=' AND (NOT ecm_95_related_95_usage:"'+i+'")')}b.DispatchEventToWin("Add_Referentials",e)}else O.SearchObj=w.activateSearch(A.getGlobalVariable().referentialsSearchType,"referentials"),w.search("referentials",A.getGlobalVariable().referentialsSearchForbiddenType,O.OnSearchComplete,"referentials",O.SearchObj)},uploadReferential:function(e){var t=new f.File("Input.File",{visibility:"hidden",styles:{display:"none"}});t.elements.container.setStyle("display","none"),t.elements.input.accept="all",t.elements.input.multiple=!0,t.elements.input.addEventListener("change",function(e){t.destroy(),t=null;var i=e.target.files;O.createDocument(i)},!1),t.elements.input.addEventListener("click",function(e){e.stopPropagation()}),t.inject(document.body),t.elements.input.click()},createDocument:function(e){p.doWait(widget.body);for(var i,n="",o=0;i=e[o];o++){n=i.name;var a={onFailure:function(e){p.endWait(widget.body),UWA.is(e)&&UWA.is(e.error)&&""!=e.error?_.error(e.error):_.error(t.ECM_CA_Drop_Not_Supported)},onComplete:function(e){w.getCADetails(O._model.get("id")).then(function(e){var t=e.changeaction.referentials;O.updateUIOnReferentialAdd(t),p.endWait(widget.body)},function(e){return console.log("failed"),p.endWait(widget.body),Promise.reject(e)})},onTimeout:function(){p.endWait(widget.body),console.log("timed out, try again!")}};a.tenantUrl=A.getGlobalVariable().baseURL,a.tenant=A.getGlobalVariable().tenant,a.securityContext=A.getGlobalVariable().getSecurityContext();var s={parentDirection:"from",parentRelName:"Related Item",parentId:O._model.get("id").replace("pid:","")},r={title:n?n.slice(0,n.lastIndexOf(".")):"",fileInfo:{file:i},relInfo:s};c.createDocument(r,a)}},addReferential:function(e){var t=O.addToReferentialJSON(e);y.addReferentialToCA(t,O._model.get("id"),function(e){var t=e.changeaction.referentials;O.updateUIOnReferentialAdd(t)},null)},updateUIOnReferentialAdd:function(e){for(var t=O._model.get("referentials"),n=0;n<e.length;n++)t.unshift(new i(e[n],{parse:!0}));w.enrichCollection(t).then(function(e){w.updateExcludeList(O._model,"referentials"),O.originalReferentialsCollection=new UWA.Class.Collection(t.toArray()),O.refrerentialView.collection.reset(),O.refrerentialView.collection.push(O.originalReferentialsCollection.toArray());O.caTagNavigatorProxy._setSubjectTags(t,"Referential")}),O._model.set("referentials",t);var o={id:O._model.id,referentials:O._model.get("referentials").toArray()};v.publish("ca-IDCard-on-add-remove-referential",o)},updateUIOnRefresh:function(e){var t=this.model.get("referentials"),i=new UWA.Class.Collection(t.toArray());O.originalReferentialsCollection=i,t.reset(),O.refrerentialView.collection.reset(),O.refrerentialView.collection.push(i.toArray()),t.push(O.originalReferentialsCollection.toArray());this.caTagNavigatorProxy._setSubjectTags(O.originalReferentialsCollection,"Referential")},removeReferential:function(e,t){var i=O.removeReferentialJSON(e),n=JSON.parse(i).changeaction.delete.referentials;y.removeReferentialFromCA(i,O._model.get("id"),function(e){var t=O._model.get("referentials");t.reset(),t.add(O.originalReferentialsCollection.toArray()),t.remove(n),w.updateExcludeList(O._model,"referentials"),O.originalReferentialsCollection=new UWA.Class.Collection(t.toArray()),O._model.set("referentials",t),O.refrerentialView.collection.reset(),O.refrerentialView.collection.push(O.originalReferentialsCollection.toArray());var i={id:O._model.get("id"),referentials:t};v.publish("ca-IDCard-on-add-remove-referential",i);O.caTagNavigatorProxy._setSubjectTags(t,"Referential")},null)},OnSearchComplete:function(e){if(A.getGlobalVariable().isNative){for(var t=e.split("~"),i=[],n=0;n<t.length;n++)i.push(t[n]);for(var o=[],a=0;a<t.length;a++)o.push(i[a].split(","));O.addReferential(o)}else O.addReferential(e)},addToReferentialJSON:function(e){return JSON.stringify({version:"v0",changeaction:{add:{referentials:O.jsonReferential(e)}}})},jsonReferential:function(e){for(var t=[],i="",n=0;n<e.length;n++){i="pid:"+e[n][0],t.push(i)}return t},jsonRemoveReferential:function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i]);return t},removeReferentialJSON:function(e){return JSON.stringify({version:"v0",changeaction:{delete:{referentials:O.jsonRemoveReferential(e)}}})},filterTaggerChange:function(e){var t=O.refrerentialView.collection,i=[];for(var n in e){var o=e[n],a=O.originalReferentialsCollection.toArray(),s=O.originalReferentialsCollection.findWhere({id:o});s&&i.push(s)}if(t.length!=O.originalReferentialsCollection.length){t.reset();a=O.originalReferentialsCollection.toArray();t.add(a)}var r=t.without(i);t.remove(r)},updateHeaderOnAccessUpdate:function(){O.refrerentialView.actionsView.collection.reset(),O.refrerentialView.actionsView.collection.push(O.getTopActions().toArray()),O.refrerentialView.actionsView.show()}};return O}),define("DS/ENOChangeActionUX/scripts/Services/CATeamDataGridViewServices",["DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgMembersServices","DS/ENOChangeActionUX/scripts/Services/CATeamDataGridViewToolbar","WebappsUtils/WebappsUtils","require","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e,t,i,n,o,a,s,r){"use strict";var l=Object.create(null);return l.getColumns=function(){return[{text:r.ECM_CA_Table_Header_Name,dataIndex:"person_name",editableFlag:!1,allowUnsafeHTMLContent:!0,width:"200",getCellGroupingKey:function(e){return e.nodeModel.options.grid.fullName}},{text:r.ECM_CA_Summary_Table_Label_Role,dataIndex:"roleNLS",editableFlag:!1}]},l.changeView=function(e){if("GridView"==e)this.currentView="Grid",(t=n.toolbar.getNodeModelByID("view"))&&"view-list"!=t.options.grid.semantics.icon.iconName&&t.updateOptions({grid:{semantics:{icon:{iconName:"view-list"}}},tooltip:r.CHG_CA_Pref_Grid_Label}),(i=document.querySelector(".toolbar-team-div .wux-ui-3ds-view-list"))&&i.addClassName("currentView"),(o=document.querySelector(".toolbar-team-div .wux-ui-3ds-view-small-tile"))&&o.removeClassName("currentView"),(a=document.querySelector(".teamgridView"))&&(a.removeClassName("hideView"),a.removeClassName("nonVisible"),a.addClassName("showView")),(s=document.querySelector(".teamtileView"))&&(s.removeClassName("showView"),s.addClassName("hideView"));else if("TileView"==e){var t,i,o,a,s;this.currentView="Tile",(t=n.toolbar.getNodeModelByID("view"))&&"view-small-tile"!=t.options.grid.semantics.icon.iconName&&t.updateOptions({grid:{semantics:{icon:{iconName:"view-small-tile"}}},tooltip:r.CHG_CA_Pref_Tile_Labels}),(i=document.querySelector(".toolbar-team-div .wux-ui-3ds-view-list"))&&i.removeClassName("currentView"),(o=document.querySelector(".toolbar-team-div .wux-ui-3ds-view-small-tile"))&&o.addClassName("currentView"),(a=document.querySelector(".teamgridView"))&&(a.removeClassName("showView"),a.addClassName("hideView")),(s=document.querySelector(".teamtileView"))&&(s.removeClassName("hideView"),s.addClassName("showView"))}},l.viewData={menu:[{type:"PushItem",title:r.CHG_CA_Pref_Grid_Label,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-view-list"},action:{module:"DS/ENOChangeActionUX/scripts/Views/CATeamDataGridLayout",func:"changeView"},tooltip:r.CHG_CA_Pref_Grid_Label},{type:"PushItem",title:r.CHG_CA_Pref_Tile_Label,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-view-small-tile"},action:{module:"DS/ENOChangeActionUX/scripts/Views/CATeamTileViewLayout",func:"changeView"},tooltip:r.CHG_CA_Pref_Tile_Label}]},l.writetoolbarDefination=function(){var e={entries:[{id:"ContextHeader",dataElements:{value:r.ECM_CA_Team_Counter_Members,typeRepresentation:"string"},readOnly:!0,category:"status",disabled:!0},{id:"addContext",className:"menu-context",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"plus",fontIconFamily:1}},position:"far",action:{module:"DS/ENOChangeActionUX/scripts/Views/CATeamDataGridLayout",func:"launchAddMemberPanel"},tooltip:r.ECM_CA_Add_Context,category:"addRemove"},{id:"removeContext",className:"menu-context unabledRemoveContext",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"trash",fontIconFamily:1}},position:"far",action:{module:"DS/ENOChangeActionUX/scripts/Views/CATeamDataGridLayout",func:"removeMember"},tooltip:r.ECM_CA_Remove_context,category:"addRemove"},{id:"addContext",className:"menu-context",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"filter",fontIconFamily:1}},position:"far",action:{module:"DS/ENOChangeActionUX/scripts/Views/CAMemberFilterLayout",func:"launchFilterMemberPanel"},tooltip:r.ECM_CA_Team_Actions_FilterMembers,category:"addRemove"},{id:"view",dataElements:{typeRepresentation:"sortingdropdown",icon:{iconName:"view-legacy-thb",fontIconFamily:1},value:this.viewData},position:"far",category:"View"}]};return JSON.stringify(e)},l.getCAPeopleForGridView=function(t){return new Promise(function(i,n){var o="/resources/modeler/change/changeaction/"+t+"?people=1";e.makeWSCall(o,"GET","enovia","application/json","",function(e){e.changeaction.people.length>0?l.processPeoples(e).then(function(e){console.log(e),i(e)}):i(e={peopleInfo:[],peopleId:[]})},n,!1)})},l.processPeoples=function(e){var i=e.changeaction.people,n=e.changeaction.routeTemplates;return new Promise(function(e,o){console.log(i);var a=[],r=[],c=[],d=[],p={},u=[];n.length>0&&u.push(n[0].id.slice(4)),i.forEach(function(e){c.push(e.name)}),t.getUserFullNameFromIDs(c).then(function(o){console.log(o),u.push(o[c[0]].id.slice(4)),t.getAdditionObjectInfo(u).then(function(t){for(var c=0;c<u.length;c++){var h=t.additionObjectInfo[u[c]];p[h.type]={icon:h.icon,image:h.image}}var m=p.Person.icon,g=p.Person.image;for(c=0;c<i.length;c++){var f=i[c].name;if(1==s.getGlobalVariable().isSwymInstalled){var C=s.getGlobalVariable().swymURL+"/api/user/getpicture/login/"+f+"/format/normal";i[c].image=C}else i[c].image=g;if(i[c].icon=m,"templateReviewer"!=i[c].role&&"routeReviewer"!=i[c].role)if(d.includes(f)){var v=d.indexOf(f);r[v].role=r[v].role+", "+i[c].role,r[v].roleNLS=r[v].roleNLS+", "+l.getRoleNLS(i[c].role)}else if(o&&o[f]){var A=o[f].userDisplayName;i[c].fullName=A,i[c].id=o[f].id,i[c].type="Person",i[c].roleNLS=l.getRoleNLS(i[c].role),r.push(i[c]),d.push(f),a.push(i[c].id)}}for(c=0;c<n.length;c++)n[c].type="Route Template",n[c].role="reviewer",n[c].roleNLS=l.getRoleNLS(n[c].role),n[c].fullName=n[c].name,n[c].image=p["Route Template"].image,n[c].icon=p["Route Template"].icon,r.push(n[c]);var w={};w.peopleInfo=r,w.peopleId=a,e(w)})})})},l.getRoleNLS=function(e){var t="";switch(e){case"owner":t=r.ECM_CA_Team_Owner;break;case"contributor":t=r.ECM_CA_Summary_Contributor;break;case"reviewer":t=r.ECM_CA_Summary_Reviewer;break;case"follower":t=r.ECM_CA_Summary_Follower;break;default:t=e}return t},l.showRMBMenuOnGrid=function(e,t){return new Promise(function(i,n){var o="false",s={},r=t.cellInfos.nodeModel.getTreeDocument().getSelectedNodes(),c=r[0].options.grid.role;s.currentObjType=r[0].options.grid.type;var d=0;r.length>1&&(o="true"),c.indexOf("contributor")>=0?(s.contributor="delete",d++):s.contributor="add",c.indexOf("reviewer")>=0?(s.reviewer="delete",d++):s.reviewer="add",c.indexOf("follower")>=0?(s.follower="delete",d++):s.follower="add";var p=c.indexOf("owner")>=0;if(0==p&&1==d&&(s.showConfirmation=!0),"false"==o)var u=a("DS/ENOChangeActionUX/scripts/Views/CATeamDataGridLayout");var h=[];if("Person"==s.currentObjType){h.push(l.getContributorMenu(e,t,s));var m=u.teamlayoutModel.getChildren();u.isRouteTempleteAttached=!1;for(var g=0;g<m.length;g++){"Route Template"==m[g].options.grid.type&&(u.isRouteTempleteAttached=!0)}u.isRouteTempleteAttached||h.push(l.getReviewerMenu(e,t,s)),h.push(l.getFollowerMenu(e,t,s))}0==p&&h.push(l.getDeleteMenu(e,t,s)),i(h)})},l.getContributorMenu=function(e,t,i){var n={type:"CheckItem",title:r.ECM_CA_Assignees,action:{callback:function(){require(["DS/ENOChangeActionUX/scripts/Views/CATeamDataGridLayout"],function(e){console.log("Contributor : "+i.contributor),i.role="contributor",e.updatePersonRole(t.cellInfos,i)})}}};return"delete"==i.contributor&&(n.state="selected"),n},l.getFollowerMenu=function(e,t,i){var n={type:"CheckItem",title:r.ECM_CA_Followers,action:{callback:function(){require(["DS/ENOChangeActionUX/scripts/Views/CATeamDataGridLayout"],function(e){console.log("Follower : "+i.follower),i.role="follower",e.updatePersonRole(t.cellInfos,i)})}}};return"delete"==i.follower&&(n.state="selected"),n},l.getReviewerMenu=function(e,t,i){var n={type:"CheckItem",title:r.ECM_CA_Reviewers,action:{callback:function(){require(["DS/ENOChangeActionUX/scripts/Views/CATeamDataGridLayout"],function(e){console.log("Reviewer : "+i.reviewer),i.role="reviewer",e.updatePersonRole(t.cellInfos,i)})}}};return"delete"==i.reviewer&&(n.state="selected"),n},l.getDeleteMenu=function(e,t,i){return{type:"PushItem",title:r.ECM_CA_Remove_context,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-trash"},action:{callback:function(){require(["DS/ENOChangeActionUX/scripts/Views/CATeamDataGridLayout"],function(e){console.log("remove "),i.role=[],"delete"==i.contributor&&i.role.push("contributor"),"delete"==i.reviewer&&i.role.push("reviewer"),"delete"==i.follower&&i.role.push("follower"),i.showConfirmation=!1,e.updatePersonRole(t.cellInfos,i)})}}}},l}),define("DS/ENOChangeActionUX/scripts/Views/CARealizedActivitiesView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/Handlebars/Handlebars4","DS/ENOChangeActionUX/scripts/CAWidgetConfiguration","DS/W3DXComponents/Views/Item/ActionsInlineView","DS/W3DXComponents/Collections/ActionsCollection","DS/W3DXComponents/Views/Item/MultiselView","DS/ENOChangeActionUX/scripts/CASpinner","DS/TransientWidget/TransientWidget","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/ENOChgServices/scripts/services/ChgRealizedServices","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENOChgRouter5/scripts/ChgRouter","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENOChangeActionUX/scripts/CACommonIgnore"],function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v){"use strict";o.registerHelper("getActivityDetails",function(e,i){var n="Cannot be found",o="";if(p.getGlobalVariable().is3DSpace,UWA.is(e)){if(e.BeforeExists&&e.AfterExists?o+='<div class="Realized-activity-tile-newline">':o+='<div class="Realized-activity-tile-inline">',o+='<div class="Realized-activity-tile">',"AddInFamily"==e.actName){if(e.AfterExists){if(o+='<div class="Realized-activity-After">',UWA.is(e.AfterGrammar)&&""!=e.AfterGrammar&&(o=o+'<div class="Realized-activity-After-Grammar">'+e.AfterGrammar+"</div>"),UWA.is(e.AfterMaturity)&&""!=e.AfterMaturity)o=o+'<div class="Realized-activity-After-Maturity">'+e.AfterMaturity+"</div>";else if(UWA.is(e.After)){var a=UWA.is(e.After.id)?e.After.id.substr(4):"",s=UWA.is(e.After.Instanceid)?e.After.Instanceid.substr(4):a,r=e.After.title.replace("<","&lt;");UWA.is(r)&&""!=r||(r=e.After.name.replace("<","&lt;"));var l=UWA.is(e.After.instanceName)&&""!=e.After.instanceName?"("+e.After.instanceName.replace("<","&lt;")+")":"";o=o+'<div class="Activity-box Access'+e.After.Access+' id="drag-'+e.After.id+'" draggable="true" >',UWA.is(e.After.type)&&e.After.type!=n&&(o=o+'<div class="Realized-checked-action"><input type="checkbox" class="checkbox-Before" id="checkbox-Before-'+e.After.id+'"Instanceid='+s+"></div>",o=(o+='<div class="Realized-activity-After-icon-div">')+'<img class="Realized-activity-After-icon" id="Realized-activity-After-icon-'+e.After.id+'" src ='+e.After.icon+"></img></div>"),o=(o=(o=o+'<div class="Realized-activity-desc-After" id="Realized-activity-desc-After-{{@index}}" title="'+r+" "+e.After.revision+'">'+r+"</div>")+'<div class="Realized-activity-revision-After" id="Realized-activity-revision-After-{{@index}}">'+e.After.revision+"</div>")+'<div class="Realized-activity-desc-After" id="Realized-activity-desc-After-{{@index}}" title="'+l+'">'+l+"</div>",UWA.is(e.After.type)&&e.After.type!=n&&(o=o+'<div class="Realized-activity-action-open fonticon fonticon-2x fonticon-down-open" id="Realized-activity-action-open-'+a+'"Instanceid='+s+"></div>"),o+="</div>"}o+="</div>"}e.BeforeExists&&(o+='<div class="Realized-activity-Before">',UWA.is(e.BeforeGrammar)&&""!=e.BeforeGrammar&&(o=o+'<div class="Realized-activity-Before-Grammar">'+e.BeforeGrammar+"</div>"),UWA.is(e.Before)&&(a=UWA.is(e.Before.id)?e.Before.id.substr(4):"",s=UWA.is(e.Before.Instanceid)?e.Before.Instanceid.substr(4):a,r=e.Before.title.replace("<","&lt;"),UWA.is(r)&&""!=r||(r=e.Before.name.replace("<","&lt;")),l=UWA.is(e.Before.instanceName)&&""!=e.Before.instanceName?"("+e.Before.instanceName.replace("<","&lt;")+")":"",o=o+'<div class="Activity-box Access'+e.Before.Access+'" id="drag-'+e.Before.id+'"  draggable="true">',UWA.is(e.Before.type)&&e.Before.type!=n&&(o=o+'<div class="Realized-checked-action"><input type="checkbox" class="checkbox-Before" id="checkbox-Before-'+e.Before.id+'"Instanceid='+s+"></div>",o=(o+='<div class="Realized-activity-Before-icon-div">')+'<img class="Realized-activity-Before-icon" id="Realized-activity-Before-icon-'+e.Before.id+'" src ='+e.Before.icon+"></img></div>"),o=(o=(o=o+'<div class="Realized-activity-desc-Before" id="Realized-activity-desc-Before-{{@index}}" title="'+r+" "+e.Before.revision+'">'+r+"</div>")+'<div class="Realized-activity-revision-Before" id="Realized-activity-revision-Before-{{@index}}">'+e.Before.revision+"</div>")+'<div class="Realized-activity-desc-Before" id="Realized-activity-desc-Before-{{@index}}" title="'+l+'">'+l+"</div>",UWA.is(e.Before.type)&&e.Before.type!=n&&(o=o+'<div class="Realized-activity-action-open fonticon fonticon-2x fonticon-down-open" id="Realized-activity-action-open-'+a+'"Instanceid='+s+"></div>"),o+="</div>"),o+="</div>")}else e.BeforeExists&&(o+='<div class="Realized-activity-Before">',UWA.is(e.BeforeGrammar)&&""!=e.BeforeGrammar&&(o=o+'<div class="Realized-activity-Before-Grammar">'+e.BeforeGrammar+"</div>"),UWA.is(e.Before)&&(a=UWA.is(e.Before.id)?e.Before.id.substr(4):"",s=UWA.is(e.Before.Instanceid)?e.Before.Instanceid.substr(4):a,r=e.Before.title.replace("<","&lt;"),UWA.is(r)&&""!=r||(r=e.Before.name.replace("<","&lt;")),l=UWA.is(e.Before.instanceName)&&""!=e.Before.instanceName?"("+e.Before.instanceName.replace("<","&lt;")+")":"",o=o+'<div class="Activity-box Access'+e.Before.Access+'" id="drag-'+e.Before.id+'"  draggable="true">',UWA.is(e.Before.type)&&e.Before.type!=n&&(o=o+'<div class="Realized-checked-action"><input type="checkbox" class="checkbox-Before" id="checkbox-Before-'+e.Before.id+'"Instanceid='+s+"></div>",o=(o+='<div class="Realized-activity-Before-icon-div">')+'<img class="Realized-activity-Before-icon" id="Realized-activity-Before-icon-'+e.Before.id+'" src ='+e.Before.icon+"></img></div>"),o=(o=(o=o+'<div class="Realized-activity-desc-Before" id="Realized-activity-desc-Before-{{@index}}" title="'+r+" "+e.Before.revision+'">'+r+"</div>")+'<div class="Realized-activity-revision-Before" id="Realized-activity-revision-Before-{{@index}}">'+e.Before.revision+"</div>")+'<div class="Realized-activity-desc-Before" id="Realized-activity-desc-Before-{{@index}}" title="'+l+'">'+l+"</div>",UWA.is(e.Before.type)&&e.Before.type!=n&&(o=o+'<div class="Realized-activity-action-open fonticon fonticon-2x fonticon-down-open" id="Realized-activity-action-open-'+a+'"Instanceid='+s+"></div>"),o+="</div>"),o+="</div>"),e.AfterExists&&(o+='<div class="Realized-activity-After">',UWA.is(e.AfterGrammar)&&""!=e.AfterGrammar&&(o=o+'<div class="Realized-activity-After-Grammar">'+e.AfterGrammar+"</div>"),UWA.is(e.AfterMaturity)&&""!=e.AfterMaturity?o=o+'<div class="Realized-activity-After-Maturity">'+e.AfterMaturity+"</div>":UWA.is(e.After)&&(a=UWA.is(e.After.id)?e.After.id.substr(4):"",s=UWA.is(e.After.Instanceid)?e.After.Instanceid.substr(4):a,r=e.After.title.replace("<","&lt;"),UWA.is(r)&&""!=r||(r=e.After.name.replace("<","&lt;")),l=UWA.is(e.After.instanceName)&&""!=e.After.instanceName?"("+e.After.instanceName.replace("<","&lt;")+")":"",o=o+'<div class="Activity-box Access'+e.After.Access+' id="drag-'+e.After.id+'" draggable="true" >',UWA.is(e.After.type)&&e.After.type!=n&&(o=o+'<div class="Realized-checked-action"><input type="checkbox" class="checkbox-Before" id="checkbox-Before-'+e.After.id+'"Instanceid='+s+"></div>",o=(o+='<div class="Realized-activity-After-icon-div">')+'<img class="Realized-activity-After-icon" id="Realized-activity-After-icon-'+e.After.id+'" src ='+e.After.icon+"></img></div>"),o=(o=(o=o+'<div class="Realized-activity-desc-After" id="Realized-activity-desc-After-{{@index}}" title="'+r+" "+e.After.revision+'">'+r+"</div>")+'<div class="Realized-activity-revision-After" id="Realized-activity-revision-After-{{@index}}">'+e.After.revision+"</div>")+'<div class="Realized-activity-desc-After" id="Realized-activity-desc-After-{{@index}}" title="'+l+'">'+l+"</div>",UWA.is(e.After.type)&&e.After.type!=n&&(o=o+'<div class="Realized-activity-action-open fonticon fonticon-2x fonticon-down-open" id="Realized-activity-action-open-'+a+'"Instanceid='+s+"></div>"),o+="</div>"),o+="</div>");o+="</div>",e.TransferExists&&"Transferred"==e.status&&UWA.is(e.receivingChangeAction)&&(r=e.receivingChangeAction.synopsis.replace("<","&lt;"),e.BeforeExists&&e.AfterExists,o=(o+='<div class="Realized-activity-individual-transfer" id="Realized-activity-individual-transfer-{{@index}}">')+'<div class="Realized-activity-transfer-tile">                                         <div class="Realized-activity-transferTo">'+t.ECM_CA_Realized_TransferTo+':</div>                                         <div class="Realized-activity-transferToCAName" id="'+e.receivingChangeAction.id+'" title="'+r+'">'+r+'</div></div>                                         <div class="Realized-activity-transfer-Reason-tile">                                         <div class="Realized-activity-transferReasonText">'+t.ECM_CA_Realized_Transfer_Reason+': </div>                                         <div class="Realized-activity-transferReasonNLS" title="'+e.transferReasonNLS+'" >'+e.transferReasonNLS+"</div></div>",o+="</div>"),o+="</div>"}return o}),o.registerHelper("isValidForSelection",function(e){var t="",i="act-chk-"+this.id;return this.Details.sameAsWhere||(t+='<input type="checkbox" class="chkbox-act hidden" id="'+i+'"}}">'),t});var A={activitiesToExplore:[],actions:[],validateModelSelection:function(e){var t,i,n,o=!1;return(t=e.get("ActivityDetails"))&&(o=!0,(i=t[0].After)?i.Access||(o=!1):(n=t[0].Before)&&n.Access||(o=!1)),o},_createView_NewRealizedActivity:function(i){return e.extend({tagName:"div",className:"realized-activity-details",name:"RealizedActivities",activityModel:i.activityModels,idcardView:i.idcardView,activityIdx:i.activityIdx,caModel:i.caModel,isFromFlowDown:i.flowdownOptions.isFromFlowDown,flowdownOptions:i.flowdownOptions,selectedModelsForDrag:{},selectedActivityItems:[],activitiesToRemove:[],setup:function(){this.template='<div class="Realized-activities-container">                                                    <div class="Realized-activities">                                                        <div class="Realized-activitues-header">                                                        <div class="Realized-activities-chevron Realized-icon-class" id="activities-chevron-'+this.activityIdx+'">                                                                <div>                                                                <div class="Realized-action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-expand-down" id={{@index}}></span></div>                                                                </div>                                                            </div>                                                            <div class="Real-activities-counter"><span class="realized-counter"> {{RealizedactivityNls}}</span> <span class="realized-counter-num"> {{activityNum}} </span></div>                                                        <div class="'+this.getClassNames("-actions")+'"></div>                                                        <div class="'+this.getClassNames("-activitiesMultisel")+'"></div>                                                        </div>                                                        <div class="Realized-activity-content">                                                            {{#each activities}}                                                                <div class="Realized-activity-individual" id="Realized-activity-individual-{{id}}">                                                                \x3c!--div class="Realized-activity-name-container"><div class="act-chk-container"><input type="checkbox" class="chkbox-act hidden" id="act-chk-{{id}}"></div--\x3e                                                                <div class="Realized-activity-name-container"><div class="act-chk-container">{{#isValidForSelection id}} {{/isValidForSelection}}</div>                                                                <div class="Realized-activity-name"> {{activityDesc}}</div></div>                                                                <div class="Realized-activity-individual-details"> {{#getActivityDetails Details}}{{/getActivityDetails}}</div>                                                            </div>                                                            {{/each}}                                                        <div>                                                    </div>                                                </div>',this._initActionsView(),this._initMultiSelView(),this.renderer=this.getTemplate(this.template,this.activityModel);this.activityModel.get("activities");this.listenTo(this.activityModel,"onChange:activities",this.render)},render:function(){this.container.empty(),c.doWait(widget.body);var e=this.idcarView?widget.body:this.container,t=UWA.createElement("div",{class:"main-Realized-activities-container"}),i=this.renderer();t.addContent(i),t.inject(e),("true"==this.activityModel.get("isConfigured")||p.getGlobalVariable().isNative)&&(this.injectSubView(this.actionsView,"."+this.name+"-actions"),this.injectSubView(this.realizedMultiSelView,"."+this.name+"-activitiesMultisel"),this.actionsView&&this.actionsView.dispatchEvent("onShow"),this.realizedMultiSelView&&this.realizedMultiSelView.dispatchEvent("onShow"));for(var n=this.data.activityNum,o=this,s=0;s<n;s++){var r=this.container.getElement("#activity-action-container-"+s);if(r){r.addEvent("click",function(e){e.currentTarget.id.split("-")[3]})}}var l=this.container.getElements(".checkbox-Before");for(s=0;s<l.length;s++)if(l[s]){l[s].addEvent("click",function(e){var t=e.target.checked,i=document.createElement("input"),n=e.target.id.replace("checkbox-Before-",""),s=e.target,r={};if(r.Instanceid=s.getAttribute("Instanceid"),t){var l=o.getModelFromSelectedID(n);o.selectedModelsForDrag[l.get("id")]=l,r.id=l.get("id").replace("pid:",""),r.name=l.get("objectName"),r.title=l.get("objectTitle"),r.type=l.get("objectType")}else{var c=Object.keys(o.selectedModelsForDrag);for(var d in c)c[d]===n&&delete o.selectedModelsForDrag[c[d]]}i.setAttribute("data-pid",e.target.id.replace("checkbox-Before-pid:","")),i.setAttribute("data-selectedItem",JSON.stringify(r)),t&&i.setAttribute("class","selected"),a.onClickItem.call(i,widget,p.getGlobalVariable());for(var u=this;u&&u.parentNode;)if((u=u.parentElement)&&u.className&&u.className.contains("Activity-box")){t?u.addClassName&&u.addClassName("selected-border"):u.removeClassName&&u.removeClassName("selected-border");break}let h=o.caModel.id.slice(4),m=[];c=Object.keys(o.selectedModelsForDrag);for(let e=0;e<c.length;e++){let t={id:c[e].slice(4)},i=new C({grid:t});m.push(i)}if(0==c.length){let e=new C({});m.push(e)}(new f).addRoot(m),0!=c.length&&m[0].getTreeDocument().selectAll(),g.getDependency("applicationChannel").publish({event:"update-property-panel-data",data:{context:m[0],PhysicalID:h,type:"ChangeAction",load:!0}})})}return c.endWait(widget.body),this},TransferRealized:function(e){var i=this;if(this.activitiesToRemove.length){var n=[],o=[];if(this.activitiesToRemove.forEach(function(e,t){var a;i.validateSelection(e)&&"Transferred"!=e.get("status")?(a=UWA.is(e.get("Afterobject"))?UWA.is(e.get("Afterobject").Instanceid)?e.get("Afterobject").Instanceid:e.get("Afterobject").id:UWA.is(e.get("Beforeobject"))?UWA.is(e.get("Beforeobject").Instanceid)?e.get("Beforeobject").Instanceid:e.get("Beforeobject").id:e.get("id"),n.push(a)):o.push(e.get("id"))}),n.length>0){var a={selectedIDs:n,transferMode:e};i.dispatchEvent("transferSelectedItems",[a])}o.length>0&&(o.length==i.activitiesToRemove.length?m.error(t.ECM_CA_Invalid_Selection_Error):m.warn(t.ECM_CA_Invalid_Selection_Warning))}},AfterSaveTransReal:function(e){},_initMultiSelView:function(){var e=this,t={collection:new r,withMultisel:!0,useInfiniteScroll:!1,usePullToRefresh:!1,buildMultiselActions:function(t){return e.getMultiselActions(t)},events:{onMultiselOff:function(){e.deactivateMultisel()},onMultiselOn:function(){e.activateMultisel()},onActionClickDotted:function(){widget.body.getParent("body").addClassName("for-mobile")}}};this.multiSelView&&this.multiSelView.destroy(),this.realizedMultiSelView=A.multiSelView=new l(t)},validateSelection:function(e){var t,i,n,o=!1;return(t=e.get("ActivityDetails"))&&(o=!0,(i=t[0].After)?i.Access||(o=!1):(n=t[0].Before)&&n.Access||(o=!1)),o},getMultiselActions:function(e){var i=this,n=[];UWA.is(e)&&p.getGlobalVariable().isNative&&n.push({id:null,text:t.ECM_CA_Command_ExploreWith,fonticon:null,icon:null,multisel:!0,items:[{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmExploreInContextHdr",icon:"I_FindInContext",multisel:!0,text:t.ECM_CA_Command_ExploreContext,handler:function(e){var i=[];p.getGlobalVariable().allSelectedActivity.forEach(function(e,t){var n;UWA.is(e.get("Afterobject"))&&(n=UWA.is(e.get("Afterobject").Instanceid)?e.get("Afterobject").Instanceid:e.get("Afterobject").id,i.push(n.replace("pid:",""))),UWA.is(e.get("Beforeobject"))&&(n=UWA.is(e.get("Beforeobject").Instanceid)?e.get("Beforeobject").Instanceid:e.get("Beforeobject").id,i.push(n.replace("pid:","")))}),i&&i.length>0?u.DispatchEventToWin("MultiSelMenu_ExploreInContext_New",i):m.error(t.ECM_CA_Realized_Invalid_Explore_Selection)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ExploreInMSB",icon:"I_SendToPPRNavigatorWithParent",multisel:!0,text:t.ECM_CA_Command_ExploreMSB,handler:function(e){var i=[];p.getGlobalVariable().allSelectedActivity.forEach(function(e,t){var n;UWA.is(e.get("Afterobject"))&&(n=UWA.is(e.get("Afterobject").Instanceid)?e.get("Afterobject").Instanceid:e.get("Afterobject").id,i.push(n.replace("pid:",""))),UWA.is(e.get("Beforeobject"))&&(n=UWA.is(e.get("Beforeobject").Instanceid)?e.get("Beforeobject").Instanceid:e.get("Beforeobject").id,i.push(n.replace("pid:","")))}),i&&i.length>0?u.DispatchEventToWin("ExploreInMSB",i):m.error(t.ECM_CA_Realized_Invalid_Explore_Selection)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmExploreParentsHdr",icon:"I_GetParents",multisel:!0,text:t.ECM_CA_Command_ExploreParents,handler:function(e){var t=[];p.getGlobalVariable().allSelectedActivity.forEach(function(e,i){var n;UWA.is(e.get("Afterobject"))&&(n=UWA.is(e.get("Afterobject").Instanceid)?e.get("Afterobject").Instanceid:e.get("Afterobject").id,t.push(n.replace("pid:",""))),UWA.is(e.get("Beforeobject"))&&(n=UWA.is(e.get("Beforeobject").Instanceid)?e.get("Beforeobject").Instanceid:e.get("Beforeobject").id,t.push(n.replace("pid:","")))}),u.DispatchEventToWin("ExploreParents",t)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ExploreInPPR",icon:"I_SendToPPRNavigatorWithParent",multisel:!0,text:t.ECM_CA_Command_ExploreMfg,handler:function(e){var t=[];p.getGlobalVariable().allSelectedActivity.forEach(function(e,i){var n;UWA.is(e.get("Afterobject"))&&(n=UWA.is(e.get("Afterobject").Instanceid)?e.get("Afterobject").Instanceid:e.get("Afterobject").id,t.push(n.replace("pid:",""))),UWA.is(e.get("Beforeobject"))&&(n=UWA.is(e.get("Beforeobject").Instanceid)?e.get("Beforeobject").Instanceid:e.get("Beforeobject").id,t.push(n.replace("pid:","")))}),u.DispatchEventToWin("ExploreInPPR",t)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmMultiDagExploreInCmd",icon:"I_ExploreInRFLPNavigator",multisel:!0,text:t.ECM_CA_Command_ExploreSys,handler:function(e){var t=[];p.getGlobalVariable().allSelectedActivity.forEach(function(e,i){var n;UWA.is(e.get("Afterobject"))&&(n=UWA.is(e.get("Afterobject").Instanceid)?e.get("Afterobject").Instanceid:e.get("Afterobject").id,t.push(n.replace("pid:",""))),UWA.is(e.get("Beforeobject"))&&(n=UWA.is(e.get("Beforeobject").Instanceid)?e.get("Beforeobject").Instanceid:e.get("Beforeobject").id,t.push(n.replace("pid:","")))}),u.DispatchEventToWin("ExploreInRFLP",t)}}]});var o=window.matchMedia("(max-width: 768px)"),a=t.ECM_CA_Realized_Transfer_ExistingCA,s=t.ECM_CA_Realized_Transfer_NewCA,r=t.ECM_CA_Realized_Transfer;if(o.matches&&(a=t.ECM_CA_Existing,s=t.ECM_CA_New,r=t.ECM_CA_Realized_Mobile_Transfer),"true"==this.activityModel.get("isConfigured")){var l={id:"ignore",text:t.ECM_CA_Realized_Ignore_Change,fonticon:"ignore",icon:"I_ChangeIgnore_22",multisel:!0,handler:function(e){var n=[];if(i.activitiesToRemove.length){i.activitiesToRemove.forEach(function(e,t){var o;i.validateSelection(e)&&(o=UWA.is(e.get("Afterobject"))?UWA.is(e.get("Afterobject").Instanceid)?e.get("Afterobject").Instanceid:e.get("Afterobject").id:UWA.is(e.get("Beforeobject"))?UWA.is(e.get("Beforeobject").Instanceid)?e.get("Beforeobject").Instanceid:e.get("Beforeobject").id:e.get("id"),n.push(o))});let e=model._attributes.objectId;if(e="pid:"+e,n.length>0)var o={originChangeActionId:e,idsToReject:n};v.ignoreNodes(o,widget.body,function(e){"success"===e.status&&(i.dispatchEvent("ignoreSelectedItems",[e]),m.success(t.ECM_CA_Realized_Ignore_Success),c.endWait(widget.body))},function(e,i){c.endWait(widget.body),i&&i.errorMessage?m.error(i.errorMessage):m.error(t.ECM_CA_Realized_Ignore_ERR_MSG)})}}};(d=i.caModel.get("userAccess"))&&"true"===d.RealizedReject&&n.push(l);var d,h={id:"transfer",text:r,fonticon:"sync",icon:"transfer_realized_new",multisel:!0,items:[{id:"Transfer_NewCA",text:s,fonticon:"new-create",icon:"I_FlowDownToNewCA",multisel:!0,handler:function(e){m.info(t.ECM_CA_Realized_Activity_Selection_Info);i.TransferRealized("New")}},{id:"Transfer_existingca",text:a,fonticon:"plus",icon:"I_FlowDownToExisting",multisel:!0,handler:function(e){m.info(t.ECM_CA_Realized_Activity_Selection_Info),i.TransferRealized("Existing")}}]};(d=i.caModel.get("userAccess"))&&"true"===d.MoveRealizedChange&&n.push(h)}return n},_initActionsView:function(){var e=this,i=[{id:"SelectAll",title:t.SelectAll,icon:"select-all",overflow:!1},{id:"UnSelectAll",title:t.UnSelectAll,icon:"select-none",overflow:!1}],n=new r(i);this.actionsView&&this.actionsView.destroy(),this.actionsView=new s({collection:n});var o=this._actionsViewEvents={onActionClick:function(){switch(arguments[1].model.get("id")){case"SelectAll":this.realizedMultiSelView&&e.selectAll();break;case"UnSelectAll":this.realizedMultiSelView&&e.UnselectAll()}}};this.listenTo(this.actionsView,o)},injectSubView:function(e,t){var i=this.container.getElement(t);e&&i&&i.grab(e.render().getContent())},getTemplate:function(e,i){var n=o.compile(e),a=[];i.get("activities").forEach(function(e){e.get("ActivityDetails").forEach(function(t){if(UWA.is(t)&&""!=t){var i={};i.activityDesc=t.NLSName,i.id=e.id.replace("pid:",""),i.Details=t,a.push(i)}})}),this.data={RealizedactivityNls:t.ECM_CA_RealizedActivities,activityNum:a.length,activities:a};var s=this;return function(){return n(s.data)}},domEvents:{"click .Realized-activities-chevron":function(e){e.target.id;var t=e.target.className;t.indexOf("expand-right")>0?e.target.className=t.replace("right","down").trim():t.indexOf("expand-down")>0&&(e.target.className=t.replace("down","right").trim());var i=this.container.getElement(".Realized-activity-content");i.hasClassName("hidden")?i.removeClassName("hidden"):i.addClassName("hidden")},"click .activity-individual":function(e){},"click .Realized-activity-action-open":function(e){var t=e.target.id,i=e.target,n="pid:"+(t=t.replace("Realized-activity-action-open-","")),o=this.getModelFromSelectedID(n);i&&(i.getParent().hasClassName("Accessfalse")?i.Access=!1:i.Access=!0,i.modelid=t,i.model=o,i.Instanceid=i.getAttribute("Instanceid"),this.itemView=i,this.dispatchEvent("onContextMenu",i))},"click .chkbox-act":function(e){e.target;for(var t=e.target.id.split("-"),i=t[t.length-1],n=this.container.getElements("#Realized-activity-individual-"+i),o=this.container.getElements("#act-chk-"+i),a=0;a<n.length;a++){var s=n[a],r=o[a];s.hasClassName("selected-border")?(s.removeClassName("selected-border"),r.checked=!1):(s.addClassName("selected-border"),r.checked=!0)}var l=this.activityModel.get("activities").findWhere({id:"pid:"+i}),c=this.selectedActivityItems.indexOf(l.cid);if(-1===c)this.selectedActivityItems.push(l.cid),this.activitiesToRemove.push(l),this.activateMultisel(this.container),p.getGlobalVariable().allSelectedActivity.push(l),p.getGlobalVariable().allSelectedActivityId.push(l.cid);else{this.selectedActivityItems.splice(c,1),this.activitiesToRemove.splice(c,1),0===this.activitiesToRemove.length&&this.deactivateMultisel(this.container);var d=p.getGlobalVariable().allSelectedActivityId.indexOf(l.cid);-1!=d&&(p.getGlobalVariable().allSelectedActivity.splice(d,1),p.getGlobalVariable().allSelectedActivityId.splice(d,1))}if(this.realizedMultiSelView){var u={isActive:!0};u.selectedObjects=this.activitiesToRemove,this.realizedMultiSelView.destroyDropDown();this.realizedMultiSelView.buildMultisel(u)}},"click .Realized-activity-transferToCAName":function(e){var t=e.target.id;if(t=t.replace("pid:",""),p.getGlobalVariable().is3DSpace){var i=widget.getUrl(),n=(i=i.substring(0,i.indexOf("/enterprisechangemgt")))+"/common/emxTree.jsp?mode=insert&objectId="+t;window.open(n)}else if(p.getGlobalVariable().isNative){var o={TransientCAPid:t};u.DispatchEventToWin("OpenCATransferTo",t)}else{o={TransientCAPid:t};d.showWidget("ENOWCHA_AP","",o,{mode:"panel",height:800,width:650})}},"dragstart .Activity-box":function(e){var t=e.target.id.substr(5),i=!1,n=Object.keys(this.selectedModelsForDrag);for(key in n)if(n[key]===t){i=!0;break}var o={};if(!1===i){var a=this.getModelFromSelectedID(t);o[a.get("id")]=a}else o=this.selectedModelsForDrag;Array.prototype.unshift.call(arguments,o),Array.prototype.unshift.call(arguments,{}),this.dispatchEvent("onItemViewDrag",arguments)}},getModelFromSelectedID:function(e){for(var t=null,i=this.activityModel.get("activities"),n=0;n<i.length;n++){var o=i.at(n);if(o){var a=o.get("Beforeobject");if(a&&a.id===e){t=a;break}var s=o.get("Afterobject");if(s&&s.id===e){t=s;break}}}var r=new UWA.Class.Model;return r.set("id",t.id),r.set("objectName",t.name),r.set("type",t.type),r.set("title",t.title),r.set("revision",t.revision),r.set("objectTitle",t.title),r.set("objectType",t.objectType),r.set("Access",t.Access),r},deactivateMultisel:function(){for(var e=this.container,t=e.getElements(".Realized-actions-container"),i=0;i<t.length;i++){t[i].removeClassName("no-actions")}var n=e.getElements(".checkbox-Before"),o=e.getElements(".chkbox-act");for(i=0;i<n.length;i++){n[i].removeClassName("hidden")}for(i=0;i<o.length;i++){var a=o[i],s=a.getAttribute("id").replace("act-chk-",""),r=this.activityModel.get("activities").findWhere({id:"pid:"+s}),l=p.getGlobalVariable().allSelectedActivityId.indexOf(r.cid);-1!=l&&(p.getGlobalVariable().allSelectedActivity.splice(l,1),p.getGlobalVariable().allSelectedActivityId.splice(l,1)),a.checked&&(a.checked=!1),a.addClassName("hidden")}var c=e.getElements(".Realized-activity-individual");for(i=0;i<c.length;i++){c[i].removeClassName("selected-border")}},activateMultisel:function(){for(var e=this.container,t=e.getElements(".Realized-actions-container"),i=0;i<t.length;i++){t[i].addClassName("no-actions")}var n=e.getElements(".checkbox-Before"),o=e.getElements(".chkbox-act");for(i=0;i<n.length;i++){var a=n[i];a.checked&&a.click(),a.addClassName("hidden")}for(i=0;i<o.length;i++){o[i].removeClassName("hidden")}},selectAll:function(){this.activateMultisel();for(var e=this.container.getElements(".chkbox-act"),t=0;t<e.length;t++){var i=e[t];i.checked||i.click()}},UnselectAll:function(){this.activateMultisel();for(var e=this.container.getElements(".chkbox-act"),t=0;t<e.length;t++){var i=e[t];i.checked&&i.click()}}})},calledFromNativeInterop:function(e){var i=e.refPid,n=[];p.getGlobalVariable().allSelectedActivity.forEach(function(e,t){var o,a;UWA.is(e.get("Afterobject"))&&((a=e.get("Afterobject").id)&&(a=a.replace("pid:","")),i.indexOf(a)>=0&&(o=UWA.is(e.get("Afterobject").Instanceid)?e.get("Afterobject").Instanceid:e.get("Afterobject").id,n.push(o.replace("pid:",""))));UWA.is(e.get("Beforeobject"))&&((a=e.get("Beforeobject").id)&&(a=a.replace("pid:","")),i.indexOf(a)>=0&&(o=UWA.is(e.get("Beforeobject").Instanceid)?e.get("Beforeobject").Instanceid:e.get("Beforeobject").id,n.push(o.replace("pid:",""))))}),n&&n.length>0?u.DispatchEventToWin("MultiSelMenu_ExploreInContext_New",n):m.error(t.ECM_CA_Realized_Invalid_Explore_Selection)}};return A}),define("DS/ENOChangeActionUX/scripts/Services/CADependenciesViewServices",["UWA/Core","DS/UIKIT/Mask","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOFloatingPanel/ENOFloatingPanel","DS/ENOChangeActionUX/scripts/Views/CAFlowDownRealizedForm","DS/ENOChgServices/scripts/services/ChgRealizedServices","DS/ENOChangeActionUX/scripts/Controller/CADependencyGridController","DS/PlatformAPI/PlatformAPI","DS/ENOChgServices/scripts/services/ChgErrors","DS/TransientWidget/TransientWidget","require","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e,t,i,n,o,a,s,r,l,c,d,p){"use strict";var u={addFlowdownDependency:function(e){u.options=e;var t=e.options.moreInfo;s.caDependencyModel.get("dataGridView").getTreeDocument().getSelectedNodes()[0]?l.warn(p.ECM_CA_FLOWDOWN_ADD_TO_CO_ERR_MSG):t&&"NewCA"===t.mode?u.buildPanelForToCreateFlowdownDependency(e):u.addExistingflowdown(e)},buildPanelForToCreateFlowdownDependency:function(e){var t=e.options.contextCAId,a=e.options.moreInfo;if(a){var s={ids:a.ids,contextCAId:t,mode:a.mode,Entity:"ChangeAction",model:new UWA.Class.Model,callback:function(){alert("testing...")}},r=new o(s),l=new n({animate:!0,autocenter:!0,closable:!0,limitParent:!1,overlay:!1,resizable:!0,visible:!0,footer:"",events:{onClose:function(){}}}),c=new UWA.createElement("div");"NewCA"===a.mode&&c.setStyles({height:"500px",width:"400px",overflow:"auto"}),c.inject(l.elements.body),l.inject(widget.body).show(),r.getBody().inject(c),l.elements.header.innerHTML='                    <div class="floatingPanel_Header">                        <div class="floatingPanel_RightButtons">                            <span class="right-actions  fonticon fonticon-cancel" title="Close"></span>                        </div>                        <span class="floatingPanel_title">                            <span>'+r.getHeading()+"</span>                        </span>                    </div>",r.getFooter().inject(l.elements.footer),l.getContent().getElements(".proposedButtons").forEach(function(e){e.addEvent("click",function(){l.hide()})}),l.getContent().getElements(".fonticon-cancel").forEach(function(e){e.addEvent("click",function(){l.hide()})}),i.getGlobalVariable().isNative&&l.elements.body.getParent(".floatingPanelComponent")&&l.elements.body.getParent(".floatingPanelComponent").setStyle("z-index","9999")}},addExistingflowdown:function(e){var t=d("DS/ENOChgServices/scripts/services/ChgNativeInitService"),n=d("DS/ENOChgServices/scripts/services/ChgIDCardCommonServices");r.subscribe("dependency:update:UX"+widget.id,function(){s.updateUX(),r.unsubscribe("dependency:update:UX"+widget.id)}),window.addEventListener("storage",function(e){if(e.storageArea===sessionStorage)if(null!=sessionStorage.searchList&&""!=sessionStorage.searchList){for(var t=sessionStorage.searchList.split(","),i=0;i<t.length;i++){var n={};n.value=t[i],n.label="";var o={0:[n.value]};u.OnSearchComplete(o)}sessionStorage.removeItem("searchList")}else console.log("inside EVENT ******************************************")});var o=i.getGlobalVariable();if(o.isNative){t.DispatchEventToWin("Add_Flowdown_Dependency","Add_Flowdown_Dependency")}else if(o.is3DSpace){showChooser("../common/emxFullSearch.jsp?field=TYPES=type_ChangeAction:ECM_CHANGE_ON_HOLD!=TRUE:CURRENT!=policy_Cancelled.state_Cancelled&table=AEFGeneralSearchResults&selection=single&formName=BCform&submitAction=refreshCaller&hideHeader=true&HelpMarker=emxhelpfullsearch&submitURL=../enterprisechangemgtapp/ECMWebSearchUtil.jsp?fromOperation=searchDependency",850,630)}else{var a=n.activateSearch("Change Action","Flowdown");n.search("Flowdown","Change Action",u.OnSearchComplete,"Flowdown",a)}},OnSearchComplete:function(e){var t={};if(i.getGlobalVariable().isNative){for(var n=e.split("~"),o=[],s=0;s<n.length;s++)o.push(n[s]);for(var r=[],l=0;l<n.length;l++)r.push(o[l].split(","));var c=[];for(s=0;s<r.length;s++){var d=r[s];c.push("pid:"+d[0])}}else for(c=[],s=0;s<e.length;s++){d=e[s];c.push("pid:"+d[0]),t[c[s]]=d[5]}var p={idsToFlowdown:void 0},h={id:c[0],name:t[c[0]],originChangeActionId:u.options.options.contextCAId};a.flowDownToExistingChangeAction(h,p,u.onSuccessCallback)},onSuccessCallback:function(e){var i=d("DS/ENOChgServices/scripts/services/ChgIDCardCommonServices").getCurrentModel(),n="";i&&(n=i.get("synopsis")),e&&e.changeaction&&(u.data=e,l.success(p.ECM_DOWNSTREAM_FLOWDOWN_DEPENDENCY_SUCCESS+": "+n,!1)),t.unmask(widget.body)}};return u}),define("DS/ENOChangeActionUX/scripts/Views/CAIDCardView",["UWA/Class/View","UWA/Core","DS/EditPropWidget/EditPropWidget","DS/EditPropWidget/constants/EditPropConstants","DS/EditPropWidget/models/EditPropModel","UWA/Date","DS/ENOChangeActionUX/scripts/CATagNavigatorProxy","UWA/Class/Collection","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","text!DS/ENOChgServices/assets/ChangeActionMapping.json","DS/PlatformAPI/PlatformAPI","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgIDCardHeaderServices","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENOChgServices/scripts/services/ChgDataProcess","require"],function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f){"use strict";var C={referentialCollection:null,containerReference:null,refObject:null,Currmodel:null,caPhysicalId:null,_createView_IdCard:function(t,i,n,o){return e.extend({tagName:t,className:i,model:o,setup:function(e){this.listenTo(this.model,"onChange:people",C.renderPropertiesComponent),this.listenTo(this.model,"onChange:userAccess",C.renderPropertiesComponent),d.subscribe("ca-IDCard-on-add-remove-referential",function(e){var t=h.getCAthumbnailUrl(C.Currmodel);C.Currmodel.set("image",t);var i=document.body.querySelector("#attachment-launch");null!=i&&(i.title=i.innerHTML=e.referentials.length)}),d.subscribe("ca-update-attachment-complete",function(e){var t=C.Currmodel.get("referentials"),i="pid:"+e.id;if(null!=e.referentials.attached){var n=e.referentials.attached;f(["DS/ENOChangeActionUX/scripts/Models/CAReferentialModel"],function(e){for(var o=0;o<n.length;o++){var a={},s=n[o];a.id="pid:"+s.id,a.info={type:s.type,typeNLS:s.typeNLS,revision:s.revision,currentNLS:s.stateNLS,"display name":s.name},t.unshift(new e(a,{parse:!0}))}u.enrichCollection(t).then(function(e){C.Currmodel.set("referentials",t);var n={id:i,referentials:t.toArray()};d.publish("ca-IDCard-on-add-remove-referential",n)})})}else if(null!=e.referentials.detached){var o="pid:"+e.referentials.detached;t.remove(o),C.Currmodel.set("referentials",t);var a={id:i,referentials:t.toArray()};d.publish("ca-IDCard-on-add-remove-referential",a)}});var t=C.caTagNavigatorProxy=this.caTagNavigatorProxy=new s;t._initTaggerProxy("Properties").then(function(e){var i=new r;t._setSubjectTags(i,"Properties"),u.setTaggerObject("Properties",t)},function(e){console.log("Tagger initilization failed")})},render:function(){C.referentialCollection=null,C.refObject=this,C.Currmodel=this.model,C.caPhysicalId=this.model.id,console.log(this.model._attributes);C.containerReference=this.container;var e=new UWA.Element("div");e.setAttributes({id:"DivForEditProp"}),e.setStyle("height","100%"),C.containerReference.addContent(e)}})},createPropertiesComponent:function(){var e=!0,t=!1,a=this.Currmodel.get("userAccess");a&&"true"===a.Edit&&(e=!1,t=!0);var s=new i({typeOfDisplay:n.ONLY_EDIT_PROPERTIES,selectionType:n.NO_SELECTION,extraNotif:!0,editMode:!1,setEditButton:t,readOnly:e,context:{getSecurityContext:function(){return{SecurityContext:p.getGlobalVariable().getSecurityContext()}}},events:{onNotification:function(e){m.message(e.msg,e.eventID)}}}),r=C.refObject.model.id.substr(4),l=[],c=new o({metatype:"businessobject",tenant:p.getGlobalVariable().tenant,objectId:r});return c.addEvent("onSave",function(e){C.updateCAModelOnSave(this)}),l.push(c),setTimeout(function(){s.initDatas(l),widget.addEvent("onResize",function(){setTimeout(function(){s.onResize()},100)})},500),p.getGlobalVariable().PropWidget=s,s},renderPropertiesComponent:function(){C.refObject.model;var e=document.getElementById("DivForEditProp");e&&(e.empty(),C.createPropertiesComponent().inject(e))},updateCAModelOnSave:function(e){if(e.get("Synopsis")){var t=e.get("Synopsis").value,i=g.escapeHTML(t);C.Currmodel.set("subtitle",i),C.Currmodel.set("synopsis",i),C.Currmodel.set("title",i)}if(e.get("description")){var n=e.get("description").value;C.Currmodel.set("description",n)}if(e.get("Severity")){var o=e.get("Severity").value;C.Currmodel.set("severity",o);JSON.parse(c)[C.Currmodel.get("severity")]}if(e.get("Estimated Start Date")){var s="%Y-%m-%d",r=e.get("Estimated Start Date").value;r=r?a.strftime(C.formatDateObj(r),s):"",C.Currmodel.set("created",r)}if(e.get("Estimated Completion Date")){s="%Y-%m-%d";var p=e.get("Estimated Completion Date").value;""===(p=p?a.strftime(C.formatDateObj(p),s):"")&&(p=l.ECM_CA_DUEDATE_UNASSIGNED),C.Currmodel.set("due",p)}var u={id:C.Currmodel.id,title:C.Currmodel.get("synopsis"),description:C.Currmodel.get("description"),dueDate:C.Currmodel.get("due"),estStartDate:C.Currmodel.get("created"),severity:C.Currmodel.get("severity")};d.publish("ca-IDCard-on-change-id-card-details",u)},formatDateObj:function(e){var t=e.split("@"),i=null;if(t.length>1){var n=t[0].split("/"),o=n[0],a=n[1]-1,s=n[2],r=t[1].split(":"),l=r[0],c=r[1],d=r[2];(i=new Date).setUTCFullYear(o),i.setUTCDate(1),i.setUTCMonth(a),i.setUTCDate(s),i.setUTCHours(l),i.setUTCMinutes(c),i.setUTCSeconds(d)}return i}};return C}),define("DS/ENOChangeActionUX/scripts/Views/ActivityForm",["i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","UWA/Controls/Abstract","DS/UIKIT/Input/Button","DS/ENOChgServices/scripts/services/ChgErrors","DS/E6WCommonUI/Views/DetailsDisplayView","DS/ENOChangeActionUX/scripts/Models/CAActivityModelForDisplayView","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable"],function(e,t,i,n,o,a,s,r,l){"use strict";return n.extend({cloneModel:null,activityCallback:null,slideInReference:null,detailsView:null,init:function(e){UWA.is(e)&&(this.activityCallback=e.callback,this.cloneModel=new r(e,{parse:!0}))},getHeading:function(){return this.cloneModel.id?e.ECM_CA_Proposed_Activity_Heading_Edit:e.ECM_CA_Proposed_Activity_Heading_Add},getBody:function(){var e=this,t=UWA.createElement("div",{id:"formBody"});t.setAttribute("data-rec-id","formBodyCA");new(UWA.Class.View.extend({setup:function(){this.listenTo(this.model,"onChange",this.render)},render:function(){UWA.is(arguments[0])&&arguments[0].hasChanged("reasonForChange")||(t.setContent(""),e.detailsView=new s,e.detailsView.setConfig(e.getConfig()),e.detailsView.model=e.cloneModel,e.detailsView.tenant=l.getGlobalVariable().tenant,e.detailsView.context=enoviaServer.context,e.detailsView.render().inject(t))}}))({model:e.cloneModel}).render();return t},getConfig:function(){var t=[];return t.push({readWrite:!0,name:"activityDisplaySelect",label:e.ECM_CA_Proposed_Change_Activity,type:"select",required:!0,values:this.cloneModel.get("activityDisplayOptions")}),t.push({readWrite:"true",name:"reasonForChange",label:e.ECM_CA_Proposed_Activity_Description,type:"textarea",numberOfDisplayLines:3,numberOfEditableLines:3}),t},getFooter:function(){var t=UWA.Element("div",{});if(UWA.is(this.cloneModel.id)){if(UWA.is(this.cloneModel.id)){new o({value:e.ECM_CA_Button_Label_Save,className:"primary proposedButtons"}).inject(t).addEvent("onClick",this.onSaveButtonClick.bind(this))}}else new o({value:e.ECM_CA_Button_Label_Add,className:"primary proposedButtons"}).inject(t).addEvent("onClick",this.onAddButtonClick.bind(this)),new o({value:e.ECM_CA_Button_Label_AddAnother,className:"proposedButtons"}).inject(t).addEvent("onClick",this.onAddAnotherButtonClick.bind(this));return t},onAddButtonClick:function(){this.detailsView.isModelValid()?(this.activityCallback(this.cloneModel),this.slideInReference.hideSlideIn()):a.error(e.ECM_CA_MandFieldMissing_error)},onAddAnotherButtonClick:function(){this.detailsView.isModelValid()?(this.activityCallback(this.cloneModel),this.cloneModel.set("reasonForChange",""),this.cloneModel.set("canEdit",!0)):a.error(e.ECM_CA_MandFieldMissing_error)},onSaveButtonClick:function(){this.detailsView.isModelValid()?(this.activityCallback(this.cloneModel),this.slideInReference.hideSlideIn()):a.error(e.ECM_CA_MandFieldMissing_error)}})}),define("DS/ENOChangeActionUX/scripts/Collection/CAContextCollection",["UWA/Core","UWA/Class/Collection","DS/ENOChangeActionUX/scripts/Models/CAContextModel"],function(e,t,i){"use strict";return t.extend({model:i,setup:function(){},fetch:function(e){var t;return t=e.data=this.contextArr=e.contextArr,e.ajax=function(e,i){i.onComplete(t)},this.url="dummyURL",this._parent(e)}})}),define("DS/ENOChangeActionUX/scripts/Services/CAContextViewServices",["UWA/Core","DS/ENOChangeActionUX/scripts/Collection/CAContextCollection"],function(e,t){"use strict";return{createContextCollection:function(e){var i={contextArr:e},n=new t;return n.fetch(i),n}}}),define("DS/ENOChangeActionUX/scripts/Views/CAContextView",["DS/ENOChangeActionUX/scripts/CAWidgetConfiguration","DS/ENOChangeActionUX/scripts/Models/CAContextModel","DS/ENOChangeActionUX/scripts/CASpinner","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/DataDragAndDrop/DataDragAndDrop","DS/W3DXComponents/Collections/ActionsCollection","DS/W3DXComponents/Views/Item/SetView","DS/W3DXComponents/Views/Layout/GridScrollView","DS/ENOChangeActionUX/scripts/Views/CACustomContextTileView","DS/W3DXComponents/Views/Layout/TableScrollView","DS/W3DXComponents/Views/Item/RowView","DS/W3DXComponents/Views/EmptyView","UWA/Class/View","UWA/Core","DS/ENOChangeActionUX/scripts/CATagNavigatorProxy","DS/i3DXCompassPlatformServices/OpenWith","DS/PlatformAPI/PlatformAPI","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChangeActionUX/scripts/Services/CAContextViewServices","DS/ENOChgServices/scripts/services/ChgContextServices","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/ENOChgServices/scripts/services/ChgPropertiesServices"],function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v,A,w,b,S,y){"use strict";return u.extend({name:"DS/ENOChangeActionUX/scripts/Views/CAContextView",viewName:"Context",className:"ca-context-view",contextualView:{collection:{},actionsView:{collection:{}}},caTagNavigatorProxy:{},isCheckSelected:!1,multiSelOn:!1,selectedModelsForDrag:[],itemView:{container:{}},SearchObj:{},originalContextCollection:{},model:{},physicalId:"",contextExcludeList:[],setup:function(e){var t=this;if(t.physicalId=e.physicalId,t.model=new UWA.Class.Collection,t.contextualView.collection=new UWA.Class.Collection,t.caTagNavigatorProxy=new m,f.subscribe("ca-user-access-updated",function(e){t.updateHeaderOnAccessUpdate(e)}),e.model){var i=this.model.get("context");t.originalContextCollection=new UWA.Class.Collection(i.toArray());var n=t.caTagNavigatorProxy=this.caTagNavigatorProxy=new m;n._initTaggerProxy("Context").then(function(e){n._setSubjectTags(i,"Context");var o=t._externalEvents={onContextTaggerFilterChange:function(e){t.filterTaggerChange(e)}};t.listenTo(n,o),v.setTaggerObject("Context",n)},function(e){console.log("Tagger initilization failed")})}},render:function(){var e=this;return e.container.style.setProperty("height","100%"),e.container.style.setProperty("width","100%"),w.getCAContextData(e.physicalId).then(function(t){if(UWA.is(t.changeaction.context)){var i=t.changeaction.context,n=A.createContextCollection(i);v.enrichCollection(n).then(function(t){e.model=n,e.updateExcludeList(e.model),e.originalContextCollection=new UWA.Class.Collection(n.toArray());var i=e.caTagNavigatorProxy=new m;i._initTaggerProxy(e.viewName).then(function(t){i._setSubjectTags(e.model,e.viewName);var n=e._externalEvents={onContextTaggerFilterChange:function(t){e.filterTaggerChange(t)}};e.listenTo(i,n),v.setTaggerObject(e.viewName,i)},function(e){console.log("Tagger initilization failed")});var o=C.getGlobalVariable();e.contextualView=e.getContextListView(e.model);var a={onMultiselOff:function(){e.isCheckSelected=!1,e.multiSelOn=!1;var t=Object.keys(e.selectedModelsForDrag);for(var i in t)delete e.selectedModelsForDrag[t[i]];o.arrOid&&o.arrOid.length&&o.arrOid.splice(0,o.arrOid.length)},onMultiselOn:function(){e.isCheckSelected=!0,e.multiSelOn=!0}};e.listenTo(e.contextualView,a),e.listenTo(e.model,"onChange:context",e.render),e.listenTo(e.model,"onChange:userAccess",e.updateHeaderOnAccessUpdate);var s=o.isNative?1e3:0;setTimeout(function(){e.caTagNavigatorProxy&&e.caTagNavigatorProxy._setSubjectTags(e.model,e.viewName)},s);var r=e.container.getElement("#divForContextContent");r||((r=new UWA.Element("div",{styles:{height:"100%",width:"99.9%"}})).setAttributes({id:"divForContextContent"}),r.inject(e.container)),e.contextualView.render().inject(r)})}}),setTimeout(function(){var t=document.querySelector("#divForContextContent");t&&e.makeDroppable(t)},1e3),v.setCallbacksForOpenWith("context"),e},getContextListView:function(t){var i=this,o=n.ECM_CA_Table_Header_Title,a=n.ECM_CA_Table_Header_Name;return i.contextualView=new s({collection:t,detail:{title:n.ECM_CA_Context_Counter_Title},actions:{collection:i.getcontextTopActions(),events:{onActionClick:function(e,t,n){var o=t.model.get("id");switch(o){case"add":i.searchContext();break;default:console.log(o+" is not permitted.")}}}},buildMultiselActions:function(e){var t=[],o=!0;if(UWA.is(v.getCurrentModel().get("userAccess"))){var a=v.getCurrentModel().get("userAccess");(a&&a.DeleteContext&&"false"===a.DeleteContext||!a.DeleteContext)&&(o=!1)}if(!1===o)return t;var s={id:"remove",text:n.ECM_CA_Remove_context,fonticon:"trash",icon:"I_ChangeCnxObjTrash",multisel:!0,handler:function(e){var t=[];e.forEach(function(e){t.push(e.get("id"))}),i.removeContext(t,!0)}};return C.getGlobalVariable().isNative&&(s.icon="I_ChangeCnxObjTrash"),t.push(s),t},contents:{views:[{id:"tile",title:n.ECM_CA_Switch_TileView,view:r,itemView:l},{id:"table",title:n.ECM_CA_Switch_TableView,view:c,itemView:d}],selectionMode:"nullToMany",useInfiniteScroll:!1,usePullToRefresh:!1,emptyView:p.extend({defaultOptions:{icon:"drag-drop",title:n.ECM_CA_Context_Drop_Here}}),events:{onItemViewClick:function(){var t=document.createElement("input");t.setAttribute("data-pid",arguments[1].model.get("id").replace("pid:","")),t.setAttribute("data-type",arguments[1].model.get("type"));var n=i.selectedModelsForDrag[arguments[1].model.get("id")],o=C.getGlobalVariable();if(n){!0===i.isCheckSelected?delete i.selectedModelsForDrag[arguments[1].model.get("id")]:t.setAttribute("class","selected"),0===(a=Object.keys(i.selectedModelsForDrag)).length&&!1===i.multiSelOn&&(i.isCheckSelected=!1)}else{if(!1===i.isCheckSelected){var a=Object.keys(i.selectedModelsForDrag);for(var s in a)delete i.selectedModelsForDrag[a[s]];o.arrOid&&o.arrOid.length&&o.arrOid.splice(0,o.arrOid.length)}t.setAttribute("class","selected"),i.selectedModelsForDrag[arguments[1].model.get("id")]=arguments[1].model}var r={};r.id=arguments[1].model.get("id").replace("pid:",""),r.name=arguments[1].model.get("objectName"),r.title=arguments[1].model.get("objectTitle"),r.type=arguments[1].model.get("objectType"),t.setAttribute("data-selectedItem",JSON.stringify(r)),e.onClickItem.call(t,widget,o)},onItemViewCheck:function(){var t=document.createElement("input");(t.setAttribute("data-pid",arguments[1].model.get("id").replace("pid:","")),t.setAttribute("data-type",arguments[1].model.get("type")),arguments[2].target.checked)?(i.caTagNavigatorProxy.deactivateTaggerProxy(),i.selectedModelsForDrag[arguments[1].model.get("id")]=arguments[1].model,t.setAttribute("class","selected"),i.isCheckSelected=!0):(i.caTagNavigatorProxy.activateTaggerProxy(),i.selectedModelsForDrag[arguments[1].model.get("id")]&&(delete i.selectedModelsForDrag[arguments[1].model.get("id")],0===Object.keys(i.selectedModelsForDrag).length&&!1===i.multiSelOn&&(i.isCheckSelected=!1)));var n={};n.id=arguments[1].model.get("id").replace("pid:",""),n.name=arguments[1].model.get("objectName"),n.title=arguments[1].model.get("objectTitle"),n.type=arguments[1].model.get("objectType"),t.setAttribute("data-selectedItem",JSON.stringify(n)),e.onClickItem.call(t,widget,C.getGlobalVariable())},onItemViewDrag:function(){if((n=Object.keys(i.selectedModelsForDrag)).length&&i.isCheckSelected){var e=!1,t=arguments[1].model.get("id"),n=Object.keys(i.selectedModelsForDrag);for(var o in n){if(i.selectedModelsForDrag[n[o]].id===t){e=!0;break}}if(e)arguments[1]=i.selectedModelsForDrag;else(a={})[arguments[1].model.get("id")]=arguments[1].model,arguments[1]=a}else{var a;(a={})[arguments[1].model.get("id")]=arguments[1].model,arguments[1]=a}var s={caId:i.physicalId};v.onItemViewDragForContents(arguments,s)}},headers:[{property:"objectTitle",sortable:!0,label:o},{property:"objectName",sortable:!0,label:a},{property:"current",sortable:!0,label:n.ECM_CA_Table_Header_Maturity},{property:"ownerFullname",sortable:!0,label:n.ECM_CA_Table_Header_Owner},{label:n.ECM_CA_Table_Header_Action,actions:!0}],itemViewOptions:i.getitemViewOptions()}}),i.contextualView},getcontextTopActions:function(){var e=!0,t=v.getCurrentModel();if(UWA.is(t)&&UWA.is(t.get("userAccess"))){var i=t.get("userAccess");(i.AddContext&&"false"===i.AddContext||!i.AddContext)&&(e=!1)}var o=[];return e&&o.push({id:"add",title:n.ECM_CA_Add_Context,icon:"plus",overflow:!1}),new a(o)},DisplayContextMenu:function(e){var t=this,i=[];if(t.itemView&&t.itemView.model&&t.itemView.model.get("Access")){var o={objectId:t.itemView.model.get("id").replace("pid:",""),objectType:t.itemView.model.get("objectType"),displayName:t.itemView.model.get("objectTitle"),displayType:t.itemView.model.get("type"),facetName:"context"},a={facetName:"context",selectedItem:o};v.setSelectedItem(a);var s=[];s.push(o);var r=v.getContentForCompassInteraction(s),l=new g;l.set3DXContent(r,!0);var c=[];UWA.is(l.retrieveCompatibleApps,"function")&&l.retrieveCompatibleApps(function(o){o.forEach(function(e){c.push({text:e.text,fonticon:e.fonticon,multisel:!1,handler:e.handler})});var a=C.getGlobalVariable();c.length>0&&a.isNative?"true"==a.CHG_OPENWITH&&i.push({id:"OpenWith",text:n.ECM_CA_Command_OpenWith_RichClient,fonticon:"export",icon:"fonticon-export",multisel:!1,items:c}):c.length>0&&i.push({id:"OpenWith",text:n.ECM_CA_Command_OpenWith,fonticon:"export",icon:"fonticon-export",multisel:!1,items:c}),a.isNative||"false"==a.CHG_OPEN_WITH_COLLAB||i.push({id:"Details",text:n.ECM_CA_Explore_With_Central,fonticon:"window",icon:"fonticon-window",multisel:!0,handler:function(e){var i="/common/emxTree.jsp?mode=insert&objectId="+t.itemView.model.get("id").replace("pid:",""),n=a.getSecurityContext().replace("ctx::",""),o=a.computeUrl("/common/emxFrameworkContextManager.jsp?SecurityContext="+n+"&forwardUrl="+i),s=window.open();s.opener=null,s.location.href=o}}),i.push({id:"Properties",text:n.ECM_CA_Properties,fonticon:"attributes",icon:"I_ChangeCnxObjProps",multisel:!0,handler:function(e){var i=t.itemView.model.get("id").replace("pid:","");y.createPropertiesComponent(i)}});var s=!0,r=v.getCurrentModel();if(UWA.is(r.get("userAccess"))){var l=r.get("userAccess");(l.DeleteContext&&"false"===l.DeleteContext||!l.DeleteContext)&&(s=!1)}1==s&&i.push({id:"remove",text:n.ECM_CA_Remove_context,fonticon:"trash",icon:"I_ChangeCnxObjTrash",multisel:!0,handler:function(e){var i=t.itemView.model.get("id"),n=[];n.push(i),t.removeContext(n,!1)}}),i.unshift.apply(i,e);var d=t.itemView.container.getElement(".actions-inline-dotted .action-icon-wrapper");v._initDropDown(i,d)})}},getitemViewOptions:function(){var e=this;return{actionButtonBinding:function(e){e.container.getElement(".actions-inline-dotted").removeClassName("hidden"),e.container.getElement(".actions-inline-dotted").addEvent("click",function(t){e.dispatchEvent("onActionClickDotted",e)})},events:{onActionClickDotted:function(t){e.itemView=t,t.model.get("Access")&&C.getGlobalVariable().isNative?(A.currentContext=e,S.DispatchEventToWin("Context_ContextMenu",t.model.get("id").replace("pid:",""))):e.DisplayContextMenu([])}}}},makeDroppable:function(e){var t=this;o.droppable(e,{drop:function(e,o,a){if(a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault(),a.dataTransfer&&a.dataTransfer.dropEffect&&(a.dataTransfer.dropEffect="copy"),UWA.is(e)&&""!=e){var s=JSON.parse(e),r=v.checkTenantInforamation(s);if(0!=r.TenantInfoMissing.length)b.error(n.ECM_CA_Pref_PlatformMissing_Error);else if(0!=r.DiffTenantData.length)b.error(n.ECM_CA_Pref_PlatformDoesNotMatch_Error);else{s=v.removeDuplicatesToBeDroppedObjects(s);var l=v.filterBasedOnServiceId(s);if(l.incorrectServiceInfo&&Array.isArray(l.incorrectServiceInfo)&&l.incorrectServiceInfo.length>0){var c=n.ECM_WARN_DROP_SKIPPED+"<br/>";for(var d in l.incorrectServiceInfo)c+=l.incorrectServiceInfo[d]+"<br/>";b.warn(c,"false")}t.ExecuteDrop(s)}}else i.endWait(widget.body),b.error(n.ECM_CA_Drop_Not_Supported)},over:function(){arguments[0].setStyles({borderStyle:"solid",borderColor:"blue",borderWidth:"1px"})},leave:function(){arguments[0].setStyle("borderWidth","0px")}})},ExecuteDrop:function(e){if(e){var t=e.data.items;if(UWA.is(t)&&UWA.is(t.length)&&t.length>0){for(var o=[],a=0,s=0;s<t.length;s++){var r=[];-1!=this.contextExcludeList.indexOf("pid:"+t[s].objectId)?a++:(r.push(t[s].objectId),o.push(r))}0!=a&&b.warn(n.ECM_CA_Context_Already_Added),0!=o.length&&this.addContext(o)}}else i.endWait(widget.body),b.error(n.ECM_CA_Drop_Not_Supported);document.querySelector("#divForContextContent").setStyle("borderWidth","0px")},searchContext:function(){var e=this.OnSearchComplete.bind(this),t=C.getGlobalVariable();if(t.isNative){A.currentContext=this,S.DispatchEventToWin("Add_Context","Context")}else this.SearchObj=v.activateSearch(t.contextSearchType,"context"),v.search("context",t.contextSearchType,e,"context",this.SearchObj,void 0,this.contextExcludeList)},OnSearchComplete:function(e){if(C.getGlobalVariable().isNative){for(var t=e.split("~"),i=[],n=0;n<t.length;n++)i.push(t[n]);for(var o=[],a=0;a<t.length;a++)o.push(i[a].split(","));this.addContext(o)}else this.addContext(e)},updateUIOnRefresh:function(e){var t=this.model.get("context"),i=new UWA.Class.Collection(t.toArray());this.originalContextCollection=i,t.reset(),this.contextualView.collection.reset(),this.contextualView.collection.push(i.toArray()),t.push(this.originalContextCollection.toArray());this.caTagNavigatorProxy._setSubjectTags(this.originalContextCollection,"Context")},addContext:function(e){var n=this,o=n.addToContextJSON(e);JSON.parse(o);v.editCA(o,n.physicalId,function(e){for(var o=n.model,a=e.changeaction.context,s=0;s<a.length;s++)o.unshift(new t(a[s],{parse:!0}));v.enrichCollection(o).then(function(e){n.updateExcludeList(n.model),n.originalContextCollection=new UWA.Class.Collection(o.toArray()),n.contextualView.collection.reset(),n.contextualView.collection.push(n.originalContextCollection.toArray()),n.caTagNavigatorProxy._setSubjectTags(o,"Context"),i.endWait(widget.body)})},null)},addToContextJSON:function(e){return JSON.stringify({version:"v0",changeaction:{add:{context:this.jsonContext(e)}}})},jsonContext:function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];t.push("pid:"+n[0])}return t},removeContext:function(e,t){var n=this,o=n.removeContextJSON(e),a=JSON.parse(o).changeaction.delete.context;v.editCA(o,n.physicalId,function(e){var t=n.model;t.reset(),t.add(n.originalContextCollection.toArray()),t.remove(a),n.updateExcludeList(n.model),n.originalContextCollection=new UWA.Class.Collection(t.toArray()),n.contextualView.collection.reset(),n.contextualView.collection.push(n.originalContextCollection.toArray());n.caTagNavigatorProxy._setSubjectTags(t,"Context"),i.endWait(widget.body)},null)},removeContextJSON:function(e){return JSON.stringify({version:"v0",changeaction:{delete:{context:this.jsonRemoveContext(e)}}})},jsonRemoveContext:function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i]);return t},filterTaggerChange:function(e){var t=this.contextualView.collection;if(null!=t){var i=[];for(var n in e){var o=e[n],a=this.originalContextCollection.toArray(),s=this.originalContextCollection.findWhere({id:o});s&&i.push(s)}if(t.length!=this.originalContextCollection.length){t.reset();a=this.originalContextCollection.toArray();t.add(a)}var r=t.without(i);t.remove(r)}},updateHeaderOnAccessUpdate:function(){this.contextualView.actionsView.collection.reset(),this.contextualView.actionsView.collection.push(this.getcontextTopActions().toArray()),this.contextualView.actionsView.show()},updateExcludeList:function(e){var t=this;t.contextExcludeList=[],t.model.forEach(function(e,i){t.contextExcludeList.push(e.get("id"))})}})}),define("DS/ENOChangeActionUX/scripts/Views/ChgChangeActionAutoComplete",["UWA/Core","DS/WUXAutoComplete/AutoComplete","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/ENOChangeActionUX/scripts/Models/ChgChangeGroupModel","DS/ENOChgServices/scripts/services/ChgDataService","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","require"],function(e,t,i,n,o,a,s,r){"use strict";return{selection:null,myAutoComplete:null,autoCompleteModel:null,selectedItemsValue:[],loadAutoComplete:function(e,t){var i=this;if(i.autoCompleteModel=(new o).createTreeDocument(),i.createAutoComplete(i.autoCompleteModel),this.myAutoComplete.inject(e),t){var n=(new o).createNode(t.title,t.id);this.myAutoComplete.value=t.title,i.autoCompleteModel.addRoot(n,0),n.select()}window.myAutoComplete=this.myAutoComplete,a.getListOfGroups().then(function(e){var n=e;(new o).loadData(i.autoCompleteModel,n,t)},function(e){return Promise.reject(e)})},createAutoComplete:function(e,i){var n=this;n.selection=null,this.myAutoComplete=new t({multiSearchMode:!1,elementsTree:e,placeholder:s.ECM_CA_AUTOCOMPLETE_PLACEHOLDER,customFilterMessage:s.ECM_CA_OPTIONS_PLACEHOLDER}),this.myAutoComplete.addEventListener("change",function(e){var t=null;if(e.dsModel.selectedItems)t=e.dsModel.selectedItems.options;n.selection=t})},getSelection:function(){return this.selection}}}),define("DS/ENOChangeActionUX/scripts/Views/ChgChangeActionCreateGroup",["UWA/Core","DS/ENOChgServices/scripts/components/ChgCommonSelectDailog","DS/ENOChangeActionUX/scripts/Views/ChgChangeActionAutoComplete","DS/ENOChgServices/scripts/services/ChgDataService","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/PlatformAPI/PlatformAPI","DS/UIKIT/Mask","require"],function(e,t,i,n,o,a,s,r){"use strict";return{createGroup:function(e){var r=null,l=[{label:o.ECM_CA_Button_Done,handler:function(){var o=i.getSelection();if(null!=o&&null!=o&&""!=o.label){null!=(u=document.getElementById("outer-ca-div"))&&null!=u&&s.mask(u);var r=o.label,l=o.value;if("createGroupFromIdCard"==e.facetName){var d="";e.model._attributes.groupid&&(d=e.model._attributes.groupid);var p={title:r,changeactions:[e.model.id],oldGroupId:d,availbleGroupId:l};""==d&&-1==l.indexOf("pid:")?n.createGroupForChangeAction(p).then(function(t){e.model.fetch(c),a.publish("ca-IDCard-on-change-group",p)},function(e){return Promise.reject(e)}):""==r||null==r?n.removeGroupFromCA(p).then(function(t){e.model.fetch(c),a.publish("ca-IDCard-on-change-group",p)},function(e){return Promise.reject(e)}):""!=r&&""!=d&&-1==l.indexOf("pid:")?n.removeGroupFromCA(p).then(function(t){n.createGroupForChangeAction(p).then(function(t){e.model.fetch(c),a.publish("ca-IDCard-on-change-group",p)},function(e){return Promise.reject(e)})},function(e){return Promise.reject(e)}):""!=r&&""!=d&&l.indexOf("pid:")>-1?d!=l?n.removeGroupFromCA(p).then(function(t){n.updateGroupToAddCA(p).then(function(t){e.model.fetch(c),a.publish("ca-IDCard-on-change-group",p)},function(e){return Promise.reject(e)})},function(e){return Promise.reject(e)}):(u=document.getElementById("outer-ca-div"))&&s.unmask(u):""!=r&&""==d&&l.indexOf("pid:")>-1&&n.updateGroupToAddCA(p).then(function(t){e.model.fetch(c),a.publish("ca-IDCard-on-change-group",p)},function(e){return Promise.reject(e)})}else if("createGroupFromSummary"==e.facetName)if(d=e.oldGroupId,p={title:r,changeactions:e.ChangeActionList,oldGroupId:d,availbleGroupId:l},""==d&&l.indexOf("pid:")>-1)n.updateGroupToAddCA(p).then(function(e){p.groupId=e.id,a.publish("ca-IDCard-on-change-group",p)},function(e){return Promise.reject(e)});else if(""==r||null==r)n.removeGroupFromCA(p).then(function(e){a.publish("ca-IDCard-on-change-group",p)},function(e){return Promise.reject(e)});else if(""==d&&-1==l.indexOf("pid:"))n.createGroupForChangeAction(p).then(function(e){p.groupId=e.id,a.publish("ca-IDCard-on-change-group",p)},function(e){return Promise.reject(e)});else if(""!=d&&l.indexOf("pid:")>-1){var u;d!=l?n.removeGroupFromCA(p).then(function(e){n.updateGroupToAddCA(p).then(function(e){p.groupId=e.id,a.publish("ca-IDCard-on-change-group",p)},function(e){return Promise.reject(e)})},function(e){return Promise.reject(e)}):(u=document.getElementById("outer-ca-div"))&&s.unmask(u)}else""!=r&&""!=d&&-1==l.indexOf("pid:")&&n.removeGroupFromCA(p).then(function(e){n.createGroupForChangeAction(p).then(function(e){p.groupId=e.id,a.publish("ca-IDCard-on-change-group",p)},function(e){return Promise.reject(e)})},function(e){return Promise.reject(e)});t.closeDialog()}else"createGroupFromIdCard"==e.facetName&&e.model._attributes.groupid?(d="",e.model._attributes.groupid&&(d=e.model._attributes.groupid),p={title:r,changeactions:[e.model.id],oldGroupId:d},n.removeGroupFromCA(p).then(function(t){e.model.fetch(c),a.publish("ca-IDCard-on-change-group",p)},function(e){return Promise.reject(e)}),t.closeDialog()):"createGroupFromSummary"==e.facetName&&e.oldGroupId&&(d=e.oldGroupId,p={title:r,changeactions:e.ChangeActionList,oldGroupId:d},n.removeGroupFromCA(p).then(function(e){a.publish("ca-IDCard-on-change-group",p)},function(e){return Promise.reject(e)}),t.closeDialog())},className:"primary"},{label:o.ECM_CA_Cancel,handler:function(){t.closeDialog()},className:"default"}],c={title:o.ECM_GROUP_DIALOG_TITLE,content:"<div id='caAutoCDivPop'></div>",buttonArray:l,target:widget.body};t.launchInfoDailog(c);var d=document.querySelector("#caAutoCDivPop");if("createGroupFromIdCard"==e.facetName){r=void 0;e.model._attributes.groupid&&(r={id:e.model._attributes.groupid,title:e.model._attributes.group})}else if("createGroupFromSummary"==e.facetName){r=void 0;""!=e.oldGroupId&&(r={id:e.oldGroupId,title:e.oldGroupTitle})}i.loadAutoComplete(d,r)}}}),define("DS/ENOChangeActionUX/scripts/Views/CADependenciesGridView",["UWA/Class/View","UWA/Core","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/DataGridView/DataGridView","DS/ENOChangeActionUX/scripts/Controller/CADependencyGridController","DS/CollectionView/CollectionViewStatusBar","DS/ENOChgServices/scripts/services/ChgDependencyServices","DS/ENOChangeActionUX/scripts/Services/CADependenciesViewServices","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/Tweakers/GeneratedToolbar","DS/ENOChangeActionUX/scripts/CAMakeDroppable","DS/PlatformAPI/PlatformAPI","DS/ENOChgRouter5/scripts/ChgRouter","DS/ENOChgGovernanceUX/scripts/config/ChgGovAppGlobalConfig","DS/ENOChgServices/scripts/services/ChgDataProcess","require"],function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g){"use strict";var f=e.extend({name:"dependViewGrid",tag:"div",className:"dependenciesView",stream:i.ECM_CA_UPSTREAM_DEPENDENCY,caDependencyModel:null,init:function(e){f.caDependencyModel=s.changeActionDependencyModel,e&&(f.caId=e.id,f.caDependencyModel.set("caId",e.id),f.caDependencyModel.set("showFlowdown",e.showFlowdown)),this._parent.call(this,e.id)},setup:function(){},render:function(){this.container&&this.container.empty(),this.containerReference=this.container;var e=new UWA.Element("div");e.setAttributes({id:"dependencyView-main-container"}),e.inject(this.containerReference),this.caDependencyDatagridViewHeader=UWA.createElement("div",{id:"dependViewGrid-header-container",class:"dependViewGrid-header-container"}),this.caDependencyDatagridViewContent=UWA.createElement("div",{id:"dependViewGrid-content-container",class:"dependViewGrid-content-container"}),o.setCADependencyModel(f.caDependencyModel),!f.caDependencyModel.get("upstreamDependencyObjects").dependencyLinks.length&&f.caDependencyModel.get("downstreamDependencyObjects").dependencyLinks.length?f.caDependencyModel.set("stream","Downstream"):f.caDependencyModel.set("stream","Upstream");var t=o.getTreeModelForDataGridView();this.setTreeModelDefaultProperties(t);var i=this.gridView=this.buildDependencyGridView(t);f.caDependencyModel.set("dataGridView",i),i.inject(this.caDependencyDatagridViewContent);var n=f.caDependencyModel.get("userAccess").dependUserAccess.edit;"false"==l.getGlobalVariable().isFullLicence&&(n="false");var a=this.buildGridToolbar(i,f.caDependencyModel.get("stream"),n);a.inject(this.caDependencyDatagridViewHeader),this.setDependencyGridDefaultProperties(i,a),d.makeDroppable(this.caDependencyDatagridViewContent,this.dropHandler),this.caDependencyDatagridViewHeader.inject(e),this.caDependencyDatagridViewContent.inject(e)},dropHandler(e){console.log("dropHandler called"+e);for(var t=[],i=[],n=0;n<e.length;n++)(i=[]).push(e[n].objectId),i.push(e[n].displayType),i.push(e[n].serviceId),t.push(i);o.OnSearchComplete(t)},buildDependencyGridView:function(e){var t=[{text:i.ECM_CA_Table_Header_Title,dataIndex:"tree",width:"150",pinned:"left",filterId:"stringRegexp",filterModel:""},{text:i.ECM_CA_Pref_Name_Label,dataIndex:"name",width:"180",typeRepresentation:"string",allowUnsafeHTMLContent:!0,filterId:"stringRegexp",filterModel:"",getCellGroupingKey:function(e){return e.nodeModel.options.data.caName}},{text:i.ECM_CA_Table_Header_Maturity,dataIndex:"maturity",typeRepresentation:"string",filterId:"set",filterModel:[]},{text:i.ECM_CA_Depend_Label,dataIndex:"dependency",width:"150",typeRepresentation:"string",filterId:"set",filterModel:[]},{text:i.ECM_CA_RESPONSIBLE_TAG,dataIndex:"owner",allowUnsafeHTMLContent:!0,filterId:"stringRegexp",filterModel:"",getCellGroupingKey:function(e){return e.nodeModel.options.data.fullName}},{text:i.ECM_CA_DueDate,dataIndex:"dueDate",typeRepresentation:"date",editableFlag:!1}],o=new n({treeDocument:e,columns:t,showModelChangesFlag:!0,autoRowHeightFlag:!0,identifier:"chgDependencyGrid"}),a=m.getDefaultFilter(t);return e.setFilterModel(a),o},getJSONToolbar:function(e,t){var n={entries:[],typeRepresentations:{"stream-combo":{stdTemplate:"comboSelector",semantics:{possibleValues:[{value:i.ECM_CA_UPSTREAM_DEPENDENCY},{value:i.ECM_CA_DOWNSTREAM_DEPENDENCY}]}}}},o={id:"stream-combo",dataElements:{typeRepresentation:"stream-combo",value:e,displayLabel:!0,label:i.ECM_CA_DEPENDENCY_COMBO_LABEL}},a={id:"add-main",dataElements:{typeRepresentation:"functionMenuIcon",icon:{iconName:"plus",fontIconFamily:1},tooltip:i.ECM_CA_Button_Label_Add,position:"far"},children:[]},s={id:"flow-down-main",title:i.ECA_CA_ADD_FLOWDOWN_LABEL,dataElements:{typeRepresentation:"PushItem",icon:{iconName:"flow-down",fontIconFamily:1},tooltip:i.ECA_CA_ADD_FLOWDOWN_LABEL,position:"far"},children:[]},r={type:"PushItem",title:i.ECM_CA_ChangeAction_Definition,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-new-create"},action:{module:"DS/ENOChangeActionUX/scripts/Services/CADependenciesViewServices",func:"addFlowdownDependency",argument:{options:{contextCAId:f.caId,moreInfo:{mode:"NewCA"}}}}},c={type:"PushItem",title:i.ECM_CA_Realized_Transfer_ExistingCA,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-plus"},action:{module:"DS/ENOChangeActionUX/scripts/Services/CADependenciesViewServices",func:"addFlowdownDependency",argument:{options:{contextCAId:f.caId,moreInfo:{mode:"Existing"}}}}};s.children.push(r),s.children.push(c);var d={id:"add-dep",title:i.ECM_CA_ADD_DEPENDENCY,dataElements:{typeRepresentation:"PushItem",icon:{iconName:"dependency",fontIconFamily:1},action:{module:"DS/ENOChangeActionUX/scripts/Controller/CADependencyGridController",func:"addDependency",argument:{type:"Dependency"}},tooltip:i.ECM_CA_ADD_DEPENDENCY,position:"far"}},p={id:"add-co-dep",title:i.ECM_CA_ADD_CO_DEPENDENCY,dataElements:{typeRepresentation:"PushItem",icon:{iconName:"codependency",fontIconFamily:1},action:{module:"DS/ENOChangeActionUX/scripts/Controller/CADependencyGridController",func:"addDependency",argument:{type:"CoDependency"}},tooltip:i.ECM_CA_ADD_CO_DEPENDENCY,position:"far"}},u={id:"remove",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"remove",fontIconFamily:1},action:{module:"DS/ENOChangeActionUX/scripts/Controller/CADependencyGridController",func:"removeDependency"},tooltip:i.ECM_CA_REMOVE_DEPENDENCY,position:"far"}};n.entries.push(o),"true"==t&&(a.children.push(d),a.children.push(p));var h=f.caDependencyModel.get("showFlowdown");return"true"==l.getGlobalVariable().isLiteLicence&&"false"==l.getGlobalVariable().isFullLicence&&(h="false"),"true"==h&&a.children.push(s),a.children.length>0&&n.entries.push(a),"true"==t&&n.entries.push(u),n},buildGridToolbar:function(e,t,n){var a=this,s=i.ECM_CA_UPSTREAM_DEPENDENCY;"Downstream"===t&&(s=i.ECM_CA_DOWNSTREAM_DEPENDENCY);var r=this.getJSONToolbar(s,n),l=this.toolbar=e.setToolbar(JSON.stringify(r));if("Upstream"===t)try{e.getToolbar().getNodeModelByID("add-main").options.grid.data.menu.find((t,i)=>{if("flow-down-main"===t.id)return e.getToolbar().getNodeModelByID("add-main").options.grid.data.menu.splice(i,1),!0}),0==e.getToolbar().getNodeModelByID("add-main").options.grid.data.menu.length?e.getToolbar().updateNodeModel("add-main",{disabled:!0}):console.log("")}catch(e){}var c=l.getNodeModelByID("stream-combo");return c.options.grid.data==i.ECM_CA_UPSTREAM_DEPENDENCY?c.updateOptions({tooltip:i.ECM_CA_UPSTREAM_DEPENDENCY_TOOLTIP}):c.updateOptions({tooltip:i.ECM_CA_DOWNSTREAM_DEPENDENCY_TOOLTIP}),c.onAttributeChange(function(e){var t,n="Upstream";e.data.changedAttributeValue==i.ECM_CA_UPSTREAM_DEPENDENCY?t=i.ECM_CA_UPSTREAM_DEPENDENCY_TOOLTIP:(t=i.ECM_CA_DOWNSTREAM_DEPENDENCY_TOOLTIP,n="Downstream"),e.target.updateOptions({tooltip:t}),o.caDependencyModel.set("stream",n);var s=o.getTreeModelForDataGridView();a.setTreeModelDefaultProperties(s);var r=o.caDependencyModel.get("dataGridView");r.treeDocument=s;try{if(f.caDependencyModel.get("showFlowdown"))if("Downstream"==n){var l=a.getFlowdownMenu();r.getToolbar().getNodeModelByID("add-main").options.grid.data.menu.push(l),r.getToolbar().updateNodeModel("add-main",{disabled:!1})}else r.getToolbar().getNodeModelByID("add-main").options.grid.data.menu.find((e,t)=>{if("flow-down-main"===e.id)return r.getToolbar().getNodeModelByID("add-main").options.grid.data.menu.splice(t,1),!0}),0==r.getToolbar().getNodeModelByID("add-main").options.grid.data.menu.length?r.getToolbar().updateNodeModel("add-main",{disabled:!0}):console.log("")}catch(e){}}),l},setDependencyGridDefaultProperties:function(e,t){e.addEventListener("allCellsRendered",function(){e.buildStatusBar([{type:a.STATUS.CUSTOM,id:"totalItems",dataElements:{typeRepresentation:"string",value:i.CHG_GOV_StatusBar_TotalItems+e.getTreeDocument().getNumberOfVisibleDescendants()}},{type:a.STATUS.CUSTOM,id:"selectedGridCount",dataElements:{typeRepresentation:"string",value:i.CHG_GOV_StatusBar_SelectedItems+e.getTreeDocument().getSelectedNodes().length}}])}),e.getTreeDocument().getXSO().onRemove(function(t){e.elements.statusBar.getNodeModelByID("selectedGridCount").updateOptions({grid:{data:i.CHG_GOV_StatusBar_SelectedItems+t.getTreeDocument().getSelectedNodes().length}})}),e.getTreeDocument().getXSO().onAdd(function(t){e.elements.statusBar.getNodeModelByID("selectedGridCount").updateOptions({grid:{data:i.CHG_GOV_StatusBar_SelectedItems+t.getTreeDocument().getSelectedNodes().length}})}),e.addEventListener("dblclick",function(e,t){t.nodeModel.isKindOfType;let i=null;"Change Order"===t.nodeModel.options.data.objectType?(i=h.ROUTE_CO_DETAILS,t.nodeModel.isKindOfType="ChangeOrder",t.nodeModel.id=t.nodeModel.options.data.objectId.slice(4)):"Change Action"===t.nodeModel.options.data.objectType&&(i=h.ROUTE_CA_DETAILS,t.nodeModel.isKindOfType="ChangeAction",t.nodeModel.id=t.nodeModel.options.data.objectId.slice(4)),null!=i&&u.navigate(i,{id:t.nodeModel.options.data.objectId.slice(4),name:t.nodeModel.options.data.caName,title:t.nodeModel.options.data.displayName,nodeModel:{model:t.nodeModel}})}),e.onContextualEvent=function(e){var t=[];if(!e.cellInfos)return t;if(e.cellInfos.rowID>-1)return o.showRMBMenu(f.caId,e.cellInfos).then(function(e){return e});e.collectionView.columns.length,e.cellInfos.columnID;return t=e.collectionView.buildDefaultContextualMenu(e,{pin:!0,firstColumnsVisibility:!0,columnsManagement:!0,sizeColumnToFit:!1})},e.rowSelection="single",e.cellSelection="none"},setTreeModelDefaultProperties:function(e){e.onPreExpand(function(e){e.target.hasChildren()?e.target.preExpandDone():o.getChildNodesOfTarget(e.target)})},getFlowdownMenu:function(){var e={id:"flow-down-main",title:i.ECA_CA_ADD_FLOWDOWN_LABEL,type:"PushItem",icon:{iconName:"flow-down",fontIconFamily:1},tooltip:i.ECA_CA_ADD_FLOWDOWN_LABEL,position:"far",submenu:[]},t={type:"PushItem",title:i.ECM_CA_ChangeAction_Definition,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-new-create"},action:{module:"DS/ENOChangeActionUX/scripts/Services/CADependenciesViewServices",func:"addFlowdownDependency",argument:{options:{contextCAId:f.caId,moreInfo:{mode:"NewCA"}}}}},n={type:"PushItem",title:i.ECM_CA_Realized_Transfer_ExistingCA,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-plus"},action:{module:"DS/ENOChangeActionUX/scripts/Services/CADependenciesViewServices",func:"addFlowdownDependency",argument:{options:{contextCAId:f.caId,moreInfo:{mode:"Existing"}}}}};return e.submenu.push(t),e.submenu.push(n),e}});return f}),define("DS/ENOChangeActionUX/scripts/Views/CASlideInView",["UWA/Class/View","DS/ENOChangeActionUX/scripts/Views/CAApplicabilityView","DS/ENOChangeActionUX/scripts/Views/CADependenciesGridView","DS/ENOChangeActionUX/scripts/Views/CAAttachmentView","DS/ENOChangeActionUX/scripts/CAPreferencesManager","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/PlatformAPI/PlatformAPI","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core"],function(e,t,i,n,o,a,s,r,l,c){"use strict";return e.extend({slideinContainer:"",skeletonContainer:"",setup:function(){this.slideinContainer=c.extendElement(document.body).getElement("#slidein-container"),this.skeletonContainer=c.extendElement(document.body).getElement("#skeleton-container"),this.resizerContainer=c.extendElement(document.body).getElement("#layout-resizer-div"),this.slideinContainer.empty(),this.slideinContainer.innerHTML="",this.facetName=this.options.facetName,"applicability"===this.facetName&&s.unsubscribe("applicability:update:notification")},render:function(){return this},buildSlideIn:function(){if(UWA.is(this.slideinContainer)&&(UWA.is(this.model)||"approvals"==this.options.facetName)){var e=UWA.createElement("div",{id:"slideInContent",styles:{display:"table",height:"99%",width:"100%"}});"approvals"!=this.options.facetName&&this.getHeader().inject(e),this.getBody().inject(e),e.inject(this.slideinContainer),e.set({events:{touchmove:function(e){e.stopPropagation()}}});var t=this;widget.addEvent("onResize",function(){setTimeout(function(){if(t.slideinContainer&&t.slideinContainer.clientWidth>0)if(window.matchMedia("(max-width: 768px)").matches)t.slideinContainer.style.width="100%",t.resizerContainer&&(t.resizerContainer.style.right="100%");else{var e={type:t.options.facetName},i=o.getIDCardSlideInSize(e);if(i&&i.Desktop){var n=parseInt(i.Desktop);jQuery(".right-container")[0]&&(n=jQuery(".right-container")[0].offsetWidth-150),i.Desktop=Math.min(parseInt(i.Desktop),n),t.slideinContainer.style.width=i.Desktop+"px",t.resizerContainer&&(t.resizerContainer.style.right=i.Desktop+"px")}}},100)}),this._handlerKeyUp=function(e){27==e.which&&t.hideSlideIn()},UWA.extendElement(document).addEvent("keyup",this._handlerKeyUp),s.subscribe("ca-back-to-summary-hide-slidein",function(){t.hideSlideIn()})}},getHeader:function(){var e="";"applicability"===this.options.facetName?e=r.ECM_CA_APPLIBILITY_VIEW:"dependency"===this.options.facetName?e=r.ECM_CA_DEPENDENCY_VIEW:"attachment"===this.options.facetName&&(e=r.ECM_CA_ATTACHMENT_VIEW);var t=UWA.createElement("div",{id:"slideInHeader",styles:{padding:"2px 14px",borderBottom:"1px solid #d1d4d4"}}),i=UWA.createElement("div",{class:"applicability-form-header",html:[{tag:"h5",styles:{flex:1},html:e}]}).inject(t);return UWA.createElement("span",{class:"close fonticon fonticon-cancel cursorPointer",title:r.ECM_CA_Close}).inject(i).addEvent("click",this.onCloseButtonClick.bind(this)),t},onCloseButtonClick:function(){this.hideSlideIn()},getBody:function(){var e=UWA.createElement("div",{id:"slideInBodyForApplicability"}),o=null;if("applicability"===this.options.facetName)o=new(t._createView_Applicability()),s.subscribe("applicability:update:notification",function(e){""!=JSON.parse(e).content.applicability_DisplayValue?o.model.set("applicabilitySet","true"):o.model.set("applicabilitySet","false")}),o.model=this.model;else if("dependency"===this.options.facetName){a.setCurrModel(this.model);var r=this.model.get("userAccess"),l=!0;UWA.is(r)&&(l="true"==r.FlowdownFrom),(c={}).id=this.model.get("id"),c.widgetId=widget.id,c.widgetTitle=widget.title,c.showFlowdown=l,o=new i(c)}else if("attachment"===this.options.facetName){var c={caPhysicalId:this.model.id,target:e};n.create(c)}else"approvals"===this.options.facetName&&(e=this.options.taskContainer);return"attachment"!=this.options.facetName&&"approvals"!=this.options.facetName&&(o.container=e,this.facetView=o,o.render()),e},showSlideIn:function(){if(UWA.is(this.slideinContainer)){if(this.resizerContainer&&(this.resizerContainer.style.display="block"),window.matchMedia("(max-width: 768px)").matches)this.slideinContainer.style.width="100%",this.resizerContainer&&(this.resizerContainer.style.right="100%");else{var e={type:this.options.facetName},t=o.getIDCardSlideInSize(e);if(t&&t.Desktop){var i=parseInt(t.Desktop);jQuery(".right-container")[0]&&(i=jQuery(".right-container")[0].offsetWidth-150),t.Desktop=Math.min(parseInt(t.Desktop),i),this.slideinContainer.style.width=t.Desktop+"px",this.resizerContainer&&(this.resizerContainer.style.right=t.Desktop+"px")}else this.slideinContainer.style.width="600px",this.resizerContainer&&(this.resizerContainer.style.right="600px");this.slideinContainer.style.minWidth="250px"}this.slideinContainer.style.borderLeftWidth="1px",this.skeletonContainer.style.opacity=".5",this.skeletonContainer.style.pointerEvents="none"}},hideSlideIn:function(){if(UWA.is(this.slideinContainer)){if(this.slideinContainer){var e=this.slideinContainer.style.width,t="Desktop";window.matchMedia("(max-width: 768px)").matches&&(t="Mobile");var i={type:this.options.facetName},n=o.getIDCardSlideInSize(i);n?(n[t]=e,"0px"!=e&&o.updateIDCardSlideInSize(n)):(i[t]=e,"0px"!=e&&o.updateIDCardSlideInSize(i))}this.slideinContainer.innerHTML="",this.slideinContainer.style.width="0",this.slideinContainer.style.minWidth="0",this.resizerContainer&&(this.resizerContainer.style.right="0px",this.resizerContainer.style.display="none"),this.slideinContainer.style.borderLeftWidth="0",this.skeletonContainer.style.opacity="1";this.skeletonContainer.setStyle("width","calc( 100% - 0px )"),this.skeletonContainer.style.pointerEvents="inherit",this.destroy()}},destroy:function(){null!=this.facetView&&this.facetView.destroy(),this.facetView=null,this.slideinContainer=null,this.resizerContainer=null,this.skeletonContainer=null,"applicability"===this.options.facetName&&s.unsubscribe("applicability:update:notification")}})}),define("DS/ENOChangeActionUX/scripts/Views/CAViewCommon",["i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChangeActionUX/scripts/Views/CAModals","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/UIKIT/Input/Text","DS/UIKIT/SuperModal","DS/ENOChangeActionUX/scripts/CASpinner","DS/PlatformAPI/PlatformAPI","DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ActionBar_ChangeOwnerCmd","DS/ENO6WPlugins/jQuery","DS/ENOChangeActionUX/scripts/Views/CASlideInView","DS/ENOChangeActionUX/scripts/Views/CAHeaderTemplate","DS/Controls/Loader","DS/Controls/TooltipModel","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgIDCardHeaderServices","DS/ENOChgServices/scripts/services/ChgRealizedServices","DS/ENOChgServices/scripts/services/ChgDependencyServices","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENORouteMgmt/Views/Dialogs/ChooseUsersFromUserGroup","DS/CoreEvents/Events","require"],function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v,A,w,b,S,y,_){"use strict";var E={model:null,handleContextMenuClickRefresh:function(e){var t={};s.doWait(widget.body),t.onComplete=function(e){m.getGlobalVariable().arrOid=[];g.getCurrentModel();s.endWait(widget.body),m.getGlobalVariable().isNative&&A.DispatchEventToWin("UpdateFrameTitle")};var i={id:e.id};r.publish("ca-IDCard-on-change-refresh",i),e.fetch(t)},Refresh_Native:function(){var e=m.getGlobalVariable().IDCard.model;E.handleContextMenuClickRefresh(e)},handleContextMenuClickCancel:function(i){E.model=i,t.clearModalValues(),t.modalHeader=e.ECM_CA_Cancel,t.modalFooterButtons={buttons:[{buttonValue:e.ECM_CA_Button_Done,buttonEvent:""},{buttonValue:"Cancel",buttonEvent:""}]},t.modalBody={mBody:[{fieldType:"html",fieldLabel:e.ECM_CA_Reason_label,fieldValue:"",fieldPlaceHolder:e.ECM_CA_Reason_placeholder_cancel,fieldClassName:"Cancel",fieldID:"Cancel",html:"<div id='CancelFormDiv'></div>"}]};var o=E.createReasonInputElem("Cancel"),a=t._createModal();a.inject(widget.body).show(),a.elements.footer.childNodes[0].addEventListener("click",function(){E.SetOnCancel(a)});var s=n.extendElement(document.body).getElement("#CancelFormDiv");null!=s&&(s.innerHTML="",o.inject(s));var r=document.getElementById("Cancel_Reason");r&&r.focus()},SetOnCancel:function(t){var i=n.extendElement(document.body).getElements(".reason_input");if(""==i[0].value.trim())i[0].getParent(".form-group").addClassName("has-error"),b.warn(e.ECM_CA_ReasonMissing_error);else{var o="/resources/modeler/change/changeaction/"+E.model.id+"/cancel",a={reasonForCancel:g.sanitizeText(i[0].value)};w.makeWSCall(o,"PUT","enovia","application/json",JSON.stringify(a),E.onCancelCompleteCallback,null),t.destroy()}},onCancelCompleteCallback:function(t){E.model.set("current","Cancelled"),E.model.set("currentDisplay",e.ECM_CA_State_Cancelled);var i={id:E.model.id,maturity:"Cancelled"};r.publish("ca-IDCard-on-change-cancel",i)},handleContextMenuClickCOEdit:function(i){E.model=i,g.setCurrModel(i);var o=null;t.clearModalValues(),t.modalHeader=e.ECM_CA_Action_ChangeOrder_Edit,t.modalFooterButtons={buttons:[{buttonValue:e.ECM_CA_Button_Done,buttonEvent:""},{buttonValue:"Cancel",buttonEvent:""}]},t.modalBody={mBody:[{fieldType:"html",fieldLabel:"Change Order",fieldValue:"",fieldPlaceHolder:e.ECM_CA_Action_ChangeOrder_Edit_placeholder_comment,fieldClassName:"ChangeOrder",fieldID:"ChangeOrder",html:"<div id='COEditFormDiv'></div>"}]},o=t._createModal();var a=E.createSearchInputElem("ChangeOrder",o);o.inject(widget.body).show(),o.elements.footer.childNodes[0].addEventListener("click",function(){E.AssignCO(o)}),o.elements.footer.childNodes[0].disabled=!0;var s=n.extendElement(document.body).getElement("#COEditFormDiv");null!=s&&(s.innerHTML="",a.inject(s)),UWA.is(E.model.get("changeOrderId"))&&""!=E.model.get("changeOrderId")&&(n.extendElement(document.body).getElement("#ChangeOrder").value=E.model.get("changeOrderName"))},AssignCO:function(i){var o="",a=n.extendElement(document.body).getElement("#ChangeOrder_hidden");""==a.value?t.message("No Change Order selected","error"):o=a.value;var r=JSON.stringify({version:"v0",changeaction:{modify:{},add:{}}});if(""!=o){o="pid:"+o;var l=JSON.parse(r),c=!1;UWA.is(E.model.get("changeOrderId"))&&""!=E.model.get("changeOrderId")&&(c=!0),c?l.changeaction.modify.changeorder=o:l.changeaction.add.changeorder=o,r=JSON.stringify(l)}var d=E.model.id,p=function(e){E.onCompleteAssignCO(e),s.endWait(widget.body)},u=function(t){s.endWait(widget.body),b.error(e.ECM_CA_Action_ChangeOrder_Edit_Failure)};this.AssignCO.onCompleteCallback=p,this.AssignCO.onFailureCallback=u,s.doWait(widget.body),g.editCA(r,d,p,u),i&&i.destroy()},onCompleteAssignCO:function(e){var t=e.changeaction;E.model.set("changeOrderName",t.changeorder.info["display name"]),E.model.set("changeOrderId",t.changeorder.id)},createSearchInputElem:function(t,i){var n,o="";return"ChangeOrder"===t&&(o=e.ECM_CA_ChangeOrder,n=e.ECM_CA_Action_ChangeOrder_Edit_placeholder_comment),UWA.createElement("div",{id:"NewOwnerDiv",html:[{tag:"div",class:"label-container",html:[{tag:"h5",html:o},{tag:"span",class:"mand-asterisk fonticon fonticon-asterisk-alt"}]},{tag:"span",class:"flexAlignField",html:{tag:"div",class:"searchfilter-input-container",html:[{tag:"input",class:"form-control form-control-root filtertext",id:t,placeholder:n,readonly:"true"},{tag:"span",class:"cancel-span",html:E.createCancelBtnSpan(t)},{tag:"span",class:"search-span",html:E.createSearchBtnSpan(t,i)},{tag:"input",type:"hidden",name:t+"_hidden",id:t+"_hidden",value:""}]}}]})},createReasonInputElem:function(t){var i="";return"Cancel"===t?i=e.ECM_CA_Reason_placeholder_cancel:"Hold"===t?i=e.ECM_CA_Reason_placeholder_hold:"Resume"===t&&(i=e.ECM_CA_Reason_placeholder_resume),UWA.createElement("div",{id:"ReasonDiv",html:[{tag:"div",class:"label-container",html:[{tag:"h5",html:e.ECM_CA_Reason_label},{tag:"span",class:"mand-asterisk fonticon fonticon-asterisk-alt"}]},new o({label:"Reason",id:t+"_Reason",className:"reason_input form-control",value:"",required:!0,multiline:!0,rows:3,placeholder:i,events:{onChange:E.reasonChange}})]})},createSearchBtnSpan:function(e,t){var i,n,o="",a=null;"ChangeOrder"===e&&(i="Add_CO",n="Change Order",o="ChangeOrder",a=g.activateSearch(n,o));var s=UWA.createElement("span",{class:"default fonticon fonticon-search",id:"Search_"+e+"_btn"});return s.set({events:{click:function(s){m.getGlobalVariable().isNative?A.DispatchEventToWin(i,e+"_Edit"):g.search(e,n,function(i){"ChangeOrder"===e&&(t.elements.footer.childNodes[0].disabled=!1,f.populateCOSearchResults(e+"_Edit",i,!1));var n=c("#Search_"+e+"_btn");n&&n.css("display","none")},o,a)}}}),[{html:s}]},createCancelBtnSpan:function(e){var t=UWA.createElement("span",{class:"clear-filter fonticon fonticon-cancel-circled",id:"transfercancel"});return t.set({events:{click:function(t){var i=c("#"+e);i&&i.val("");var n=c("#transfercancel"),o=c("#Search_"+e+"_btn");n&&(n.css("visibility","hidden"),n.css("display","none")),o&&o.css("display","block"),"ChangeOrder"===e&&(modalObject.elements.footer.childNodes[0].disabled=!0)}}}),[{html:t}]},reasonChange:function(){var e=n.extendElement(document.body).getElement("#Reason");e&&e.value?e.style.borderColor="#0099cc":e&&(e.style.borderColor="#d0432b")},handleContextMenuClickHold:function(i){E.model=i,t.clearModalValues(),t.modalHeader=e.ECM_CA_Hold_label,t.modalFooterButtons={buttons:[{buttonValue:e.ECM_CA_Button_Done,buttonEvent:""},{buttonValue:"Cancel",buttonEvent:""}]},t.modalBody={mBody:[{fieldType:"html",fieldLabel:e.ECM_CA_Reason_label,fieldValue:"",fieldPlaceHolder:e.ECM_CA_Reason_placeholder_hold,fieldClassName:"Hold",fieldID:"Hold",html:"<div id='HoldFormDiv'></div>"}]};var o=E.createReasonInputElem("Hold"),a=t._createModal();a.inject(widget.body).show(),a.elements.footer.childNodes[0].addEventListener("click",function(){E.SetOnHold(a)});var s=n.extendElement(document.body).getElement("#HoldFormDiv");null!=s&&(s.innerHTML="",o.inject(s));var r=document.getElementById("Hold_Reason");r&&r.focus()},SetOnHold:function(t){var i=n.extendElement(document.body).getElements(".reason_input");if(""==i[0].value.trim())i[0].getParent(".form-group").addClassName("has-error"),b.warn(e.ECM_CA_ReasonMissing_error);else{var o="/resources/modeler/change/changeaction/"+E.model.id+"/setOnHold",a={reasonForOnHoldResume:g.sanitizeText(i[0].value)};w.makeWSCall(o,"PUT","enovia","application/json",JSON.stringify(a),E.onHoldCompleteCallback,null),t.destroy()}},onHoldCompleteCallback:function(t){E.model.set("holdValue",e.ECM_CA_State_On_Hold),E.model.set("holdStatus","true"),E.model.set("TableStateVal",e.ECM_CA_State_On_Hold);var i={id:E.model.id,onHold:"true"};r.publish("ca-IDCard-on-change-hold-status",i)},handleContextMenuClickResume:function(i){E.model=i,t.clearModalValues(),t.modalHeader=e.ECM_CA_Resume_label,t.modalFooterButtons={buttons:[{buttonValue:e.ECM_CA_Button_Done,buttonEvent:""},{buttonValue:"Cancel",buttonEvent:""}]},t.modalBody={mBody:[{fieldType:"html",fieldLabel:e.ECM_CA_Reason_label,fieldValue:"",fieldPlaceHolder:e.ECM_CA_Reason_placeholder_resume,fieldClassName:"Resume",fieldID:"Resume",html:"<div id='ResumeFormDiv'></div>"}]};var o=E.createReasonInputElem("Resume"),a=t._createModal();a.inject(widget.body).show(),a.elements.footer.childNodes[0].addEventListener("click",function(){E.SetResume(a)});var s=n.extendElement(document.body).getElement("#ResumeFormDiv");null!=s&&(s.innerHTML="",o.inject(s));var r=document.getElementById("Resume_Reason");r&&r.focus()},SetResume:function(t){var i=n.extendElement(document.body).getElements(".reason_input");if(""==i[0].value.trim())i[0].getParent(".form-group").addClassName("has-error"),b.warn(e.ECM_CA_ReasonMissing_error);else{var o="/resources/modeler/change/changeaction/"+E.model.id+"/resume",a={reasonForOnHoldResume:g.sanitizeText(i[0].value)};w.makeWSCall(o,"PUT","enovia","application/json",JSON.stringify(a),E.onResumeCompleteCallback,null),t.destroy()}},onResumeCompleteCallback:function(t){E.model.set("holdValue",""),E.model.set("holdStatus",null),E.model.set("TableStateVal",e.get("ECM_CA_State_"+E.model.get("current")));var i={id:E.model.id,onHold:"false"};r.publish("ca-IDCard-on-change-hold-status",i)},handleContextMenuClickWorkUnder:function(t){E.model=t;var i=E.model?E.model.id:"",n="/resources/modeler/change/changeaction/"+i+"?editability=1&attributes=1",o=function(t,i){b.error(e.ECM_CA_Action_WorkUnder_Forbidden)},a=function(t){var n=t.changeaction;if(n&&n.editability)if(E.model.set("editability",n.editability),"allowed"===n.editability.work_under){if(m.getGlobalVariable().isPoweredBy){var o="",a=n.name,s=n.description;if(n.attributes){var l=n.attributes;UWA.is(l)&&l.forEach(function(e){"attribute_Synopsis"===e.name&&(o=e.value)})}var c={operation:"Work_Under",operationVersion:"1.0",content:{id:i.replace("pid:",""),name:a,title:o,description:s}};r.publish("webinwin:web:notification",JSON.stringify(c))}else A.DispatchEventToWin("Work_Under","TRUE")}else b.error(e.ECM_CA_Action_WorkUnder_Forbidden)};this.handleContextMenuClickWorkUnder.onCompleteCallback=a,this.handleContextMenuClickWorkUnder.onFailureCallback=o;w.makeWSCall(n,"GET","enovia","application/json","",a,o,!1)},handleContextMenuClickApproveOrReject:function(i,n){E.model=i;var o="";t.clearModalValues(),"Approve"==n?(t.modalHeader=e.ECM_CA_Approve_label,o=e.ECM_CA_Approval_placeholder_comment):(t.modalHeader=e.ECM_CA_Reject_label,o=e.ECM_CA_Rejection_placeholder_comment),t.modalFooterButtons={buttons:[{buttonValue:e.ECM_CA_Button_Done,buttonEvent:""},{buttonValue:"Cancel",buttonEvent:""}]},t.modalBody={mBody:[{fieldType:"textarea",fieldLabel:e.ECM_CA_Comment_label,fieldValue:"",fieldPlaceHolder:o,fieldClassName:"reason_input",fieldRows:"3"}]};var a=t._createModal();a.inject(widget.body).show(),c(".reason_input")[0].focus(),a.elements.footer.childNodes[0].addEventListener("click",function(){E.SetApproveOrReject(a,i,n)})},handleContextMenuClickAcceptTask:function(t){var i="/resources/modeler/change/inboxtask/accept/"+t.get("inboxTaskId");s.doWait(widget.body),w.makeWSCall(i,"PUT","enovia","*/*","",function(i){t.fetch({}),b.success(e.ECM_CA_Task_Accept_Success),s.endWait(widget.body)},null)},handleOpenCurrentCA:function(e){E.model=e;var t=E.model.id;t=t.replace("pid:","");A.DispatchEventToWin("ExploreInCollabNApproval",t)},SetApproveOrReject:function(t,i,o){var a=n.extendElement(document.body).getElements(".reason_input"),l=i.get("inboxTaskId");if(""==a[0].value.trim())a[0].getParent(".form-group").addClassName("has-error"),b.warn(e.ECM_CA_CommentsMissing_error);else{E.model.id;var c="/resources/modeler/change/inboxtask/pid="+l,d=JSON.stringify({action:o,comments:g.sanitizeText(a[0].value)}),p=function(e){var t={id:E.model.id,approvalStatus:o};r.publish("ca-IDCard-on-change-approval-status",t),s.endWait(widget.body);i.fetch({})};this.SetApproveOrReject.onSuccessfullCallback=p,s.doWait(widget.body),w.makeWSCall(c,"PUT","enovia","application/json",d,p,null),t.destroy()}},handleContexualMenuClickEBOMSync:function(e){E.model=e;var t="/resources/modeler/change/changeaction/"+E.model.id+"/synchronize";w.makeWSCall(t,"PUT","enovia","application/json","",E.onEBOMSyncCompleteCallback,null)},onEBOMSyncCompleteCallback:function(t){var i,n=new a({closable:!0,renderTo:widget.body}),o="";t&&"true"===t.OPERATION_STATUS?o=e.ECM_CA_EBOMSync_Successful:t&&"false"===t.OPERATION_STATUS&&(o=e.ECM_CA_EBOMSync_Failure),i="<p>                                \x3c!--h6></h6--\x3e                                <ul>                                    <li>"+o+"</li>                                </ul>                            </p>",n.dialog({body:i,title:e.ECM_CA_Action_EBOMSync_CollabStatus,buttons:[{className:"primary",value:e.ECM_CA_Collab_Dialog_Done,action:function(e){e.hide()}}]})},getUserActions:function(t){var i=[];if("Cancelled"!=t.get("current")){var n=t.get("userAccess");t.get("holdStatus");i.push({text:e.ECM_CA_Action_Refresh,icon:"arrows-ccw",handler:function(e){E.handleContextMenuClickRefresh(this.model)}}),"true"===n.Resume&&i.push({text:e.ECM_CA_Action_Resume,icon:"play",handler:function(e){E.handleContextMenuClickResume(this.model)}}),"true"===n.AddCO&&i.push({text:e.ECM_CA_Action_ChangeOrder_Edit,icon:"link",handler:function(e){E.handleContextMenuClickCOEdit(this.model)}}),"true"===n.Hold&&i.push({text:e.ECM_CA_Action_Hold,icon:"pause",handler:function(e){E.handleContextMenuClickHold(this.model)}}),"true"===n.Cancel&&i.push({text:e.ECM_CA_Action_Cancel,icon:"block",handler:function(e){E.handleContextMenuClickCancel(this.model)}}),"true"===n.Transfer&&i.push({text:e.ECM_CA_Action_Move,icon:"move-to",handler:function(e){E.handleContextMenuClickTransferOwnership(this.model)}}),"true"==n.WorkUnder&&(m.getGlobalVariable().isNative||m.getGlobalVariable().isPoweredBy)&&i.push({text:e.ECM_CA_Action_WorkUnder,icon:"hardhat",handler:function(e){E.handleContextMenuClickWorkUnder(this.model)}}),"true"==n.Synchronization&&i.push({text:e.ECM_CA_EBOM_Sync_Action,icon:"change-action-sync",handler:function(e){E.handleContexualMenuClickEBOMSync(this.model)}}),m.getGlobalVariable().isNative&&i.push({text:e.ECM_CA_Action_OpenCurrentCA,icon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open-in-a-new-window",handler:function(e){E.handleOpenCurrentCA(this.model)}})}return i},getattributesMapping:function(){return{title:"title",ownerName:"ownerName",description:"lifecycleHTML"}},handleContextMenuClickTransferOwnership:function(e){var t={_selectedItems:[],getSelectedNodes:function(){return this._selectedItems},addSelection:function(e,t){this._selectedItems=[];var i=this;UWA.is(e,"array")?e.forEach(function(e){i._selectedItems.push(e)}):i._selectedItems.push(e)},getReference:function(e){return getID()},getParent:function(e){return e.getParent()},getType:function(e){return getType()},getName:function(e){return getLabel()},securityContext:{SecurityContext:m.getGlobalVariable().getSecurityContext(),tenant:m.getGlobalVariable().tenant},getSecurityContext:function(){return this.securityContext}},i=UWA.extend(e,{getID:function(){return e.get("id").substring(4)},getLabel:function(){return e.get("name")},getOwner:function(){return e.get("owner")},getType:function(){return e.get("type")},getDisplayName:function(){return e.get("name")},object:{revision:e.get("version")}});t.addSelection(i);var n=new l({context:t,ID:"ActionBar_ChangeOwner"});r.subscribe("DS/PADUtils/PADCommandProxy/refresh",function(t){E.refreshModelAfterTransfer(e,n)}),n.begin()},refreshModelAfterTransfer:function(e,t){console.log("In refreshModelAfterTransfer"),r.unsubscribe("DS/PADUtils/PADCommandProxy/refresh");var i={onComplete:function(){null!=t&&null!=t.transferOwnershipPanel&&t.transferOwnershipPanel.close()}};e.fetch(i),console.log("Out refreshModelAfterTransfer")},createOwnerSectionTemplate:function(t){E.modelForOwnerTemplate=t;var i=e.ECM_CA_NO_LABEL,n=e.ECM_CA_NO_LABEL,o=t._attributes.group?t._attributes.group:e.ECM_CA_UMASSIGNED_LABEL;"true"===t.get("dependencyFound")&&(i=e.ECM_CA_YES_LABEL),"true"===t.get("applicabilitySet")&&(n=e.ECM_CA_YES_LABEL);var a=t.get("attachmentCount")?t.get("attachmentCount"):0,s={caModel:t,isApplicability:n,isDependency:i,isGroup:o,attachmentCount:a,flowdownDependencyCount:v.changeActionDependencyModel&&v.changeActionDependencyModel.get("flowdownDependencyCount")?v.changeActionDependencyModel.get("flowdownDependencyCount"):0};return p.getTemplate(s)},showHideDependencyLoader:function(){var t=n.extendElement(document.body).getElement("#ca-header-dependency-div"),i=n.extendElement(document.body).getElement("#ca-header-dependency-loader-div"),o=n.extendElement(document.body).getElement("#dependency-launch");if(i&&i.empty(),v.changeActionDependenciesLoaded){if(o){m.getGlobalVariable();v.changeActionDependencyModel.get("upstreamDependencyObjects").dependencyLinks.length+v.changeActionDependencyModel.get("downstreamDependencyObjects").dependencyLinks.length>0?(o.setContent(e.ECM_CA_YES_LABEL),o.set("title",e.ECM_CA_DEPENDENCY_YES_TOOLTIP)):(o.setContent(e.ECM_CA_NO_LABEL),o.set("title",e.ECM_CA_DEPENDENCY_NO_TOOLTIP)),o.show()}}else{var a=new u;o&&o.hide(),a.height="15",a.tooltipInfos=new h({shortHelp:"Loading..."}),t&&(a.inject(i),a.on())}if(t=n.extendElement(document.body).getElement("#ca-header-dependency-div-small"),i=n.extendElement(document.body).getElement("#ca-header-dependency-loader-div-small"),o=n.extendElement(document.body).getElement("#dependency-launch-small"),i&&i.empty(),v.changeActionDependenciesLoaded){if(o){m.getGlobalVariable();v.changeActionDependencyModel.get("upstreamDependencyObjects").dependencyLinks.length+v.changeActionDependencyModel.get("downstreamDependencyObjects").dependencyLinks.length>0?(o.setContent(e.ECM_CA_YES_LABEL),o.set("title",e.ECM_CA_YES_LABEL)):(o.setContent(e.ECM_CA_NO_LABEL),o.set("title",e.ECM_CA_NO_LABEL)),o.show()}}else{a=new u;o&&o.hide(),a.height="15",a.tooltipInfos=new h({shortHelp:"Loading..."}),t&&(a.inject(i),a.on())}},handleUnresolvedGroup:function(e,t){require(["DS/CoreEvents/Events"],function(t){t.subscribeOnce({event:"ON_SPLIT_ROUTENODE"},function(t){e.fetch({})})});var i=m.getGlobalVariable(),n=i.getSecurityContext();n=n.substring(5);var o=i.tenant,a={};a.routeId=t,a.securityContext=n,a.tentant=o;(new S).show(a)},addEventsForTitleSection:function(e){var t;(t=n.extendElement(document.body).getElement("#transfer-owner"))&&t.addEvent("click",function(t){E.handleContextMenuClickTransferOwnership(e)}),(t=n.extendElement(document.body).getElement("#change-collab-space"))&&t.addEvent("click",function(t){E.handleContextMenuClickTransferOwnership(e)}),(t=n.extendElement(document.body).getElement("#change-org"))&&t.addEvent("click",function(t){E.handleContextMenuClickTransferOwnership(e)});var i=n.extendElement(document.body).getElement("#applicability-launch");i&&i.addEvent("click",function(t){var i=new d({facetName:"applicability",model:e});i.buildSlideIn(),i.showSlideIn()});var o=n.extendElement(document.body).getElement("#applicability-launch-small");o&&o.addEvent("click",function(t){var i=new d({facetName:"applicability",model:e});i.buildSlideIn(),i.showSlideIn()}),E.showHideDependencyLoader();var a=n.extendElement(document.body).getElement("#dependency-launch");a&&a.addEvent("click",function(t){var i=new d({facetName:"dependency",model:e});i.buildSlideIn(),i.showSlideIn()});var s=n.extendElement(document.body).getElement("#dependency-launch-small");s&&s.addEvent("click",function(t){var i=new d({facetName:"dependency",model:e});i.buildSlideIn(),i.showSlideIn()});var r=n.extendElement(document.body).getElement("#attachment-launch");r&&r.addEvent("click",function(t){var i=new d({facetName:"attachment",model:e});i.buildSlideIn(),i.showSlideIn()});var l=n.extendElement(document.body).getElement("#caCreateGroup-launch");if(l){var c={target:l,title:e._attributes.group,groupPid:e._attributes.groupid};null!=c.groupPid&&l.addEvent("mouseover",function(e){require(["DS/ENOChgActionProp/scripts/ChgGropCADialog"],function(e){e.setGroupCATooltop(c)})}),l.addEvent("click",function(t){var i={facetName:"createGroupFromIdCard",model:e};require(["DS/ENOChangeActionUX/scripts/Views/ChgChangeActionCreateGroup"],function(e){e.createGroup(i)})})}var p=n.extendElement(document.body).getElement("#chg-order-launch");p&&p&&p.addEvent("click",function(t){E.handleContextMenuClickCOEdit(e)});var u=n.extendElement(document.body).getElement("#flowdown-launch");u&&u.addEvent("click",function(t){"0"!==t.target.title&&(m.getGlobalVariable().flowdownLinkClicked=!0,E.launchFlowdownPanel(e))})},launchFlowdownPanel:function(e){if(2==m.getGlobalVariable().IDCard.getSelectedFacet()){var t=_("DS/ENOChangeActionUX/scripts/Views/CANewProposedView");t&&t.addProposedWithFlowdown()}else m.getGlobalVariable().IDCard.selectFacet(2)}};return E}),define("DS/ENOChangeActionUX/scripts/Views/CAApprovalsView",["DS/ENORouteMgmt/Commands/RouteTaskView","DS/ENORouteMgmt/Views/RightPanelInfoView","DS/ENORouteMgmt/Views/Form/TaskViewUtil","DS/ENORouteMgmt/Views/Loader/ChangeTaskAssigneeChooser","DS/ENOChangeActionUX/scripts/Views/CASlideInView","DS/PlatformAPI/PlatformAPI","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgDataService","DS/ENOChgServices/scripts/services/ChgNativeInitService","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e,t,i,n,o,a,s,r,l,c){"use strict";let d,p,u,h;var m={create:function(e){e.id=this.id=e.caPhysicalId.slice(4),m.target=e.target,m.refreshRouteView(e),a.unsubscribe("ca-IDCard-on-change-refresh"),a.subscribe("ca-approval-view",function(e){e.target=m.target,e.id=e.id.slice(4),m.refreshRouteView(e)}),a.subscribe("ca-IDCard-on-change-refresh",function(e){e.target=m.target,e.id=e.id.slice(4),m.refreshRouteView(e)})},refreshRouteView:function(i){let n=null;document.getElementById("ca-Task-container")||(n=UWA.createElement("div",{id:"ca-Task-container"})),r.getRouteBasedOnContentId(i.id).then(function(a){var r=m.checkResponse(a.data);let g=s.getGlobalVariable();var f=i.target;if(r){var C={id:r.id,renderType:"container",securityContext:g.getSecurityContext(),tenant:g.tenant},v=document.getElementById("viewTaskContainerExternal"),A=document.getElementById("InitiateTaskPropertiesBody"),w=document.getElementById("approvalViewDiv"),b=document.getElementById("tileViewDiv");null!=v&&v.remove(),null!=w&&w.remove(),null!=A&&A.remove(),null!=b&&b.remove(),e.init(C,f);let i=new t(n);var S;widget.routeMgmtMediator.subscribe("route-task-open-click-view-mode",function(e){i.init(e,"taskActionMode"),(S=new o({facetName:"approvals",taskContainer:n})).buildSlideIn(),S.showSlideIn()}),widget.routeMgmtMediator.subscribe("route-task-open-click-edit-mode",function(e){i.init(e,"taskEditMode"),(S=new o({facetName:"approvals",taskContainer:n})).buildSlideIn(),S.showSlideIn()}),widget.routeMgmtMediator.subscribe("route-task-close-click-view-mode",function(e){null!=S&&S.hideSlideIn()}),widget.routeMgmtMediator.subscribe("route-task-close-click-edit-mode",function(e){null!=S&&S.hideSlideIn()}),widget.routeMgmtMediator.subscribe("task-action-on-save",function(e){var t={onComplete:function(e){e.id,e.get("current");null!=S&&S.hideSlideIn()}};s.getGlobalVariable().IDCard.model.fetch(t)}),widget.routeMgmtMediator.subscribe("launch-task-assignee-search",function(e){if(console.log("launch-task-assignee-search Event"),s.getGlobalVariable().isNative){d=e.taskProperties,p=e.taskGraphModel,h=e.invokeFrom,u=e.routeInfo;l.DispatchEventToWin("Search_Task_Assignee","Task_Assignee")}})}else{null!=(v=document.getElementById("viewTaskContainerExternal"))&&v.remove(),null!=(b=document.getElementById("tileViewDiv"))&&b.remove();var y=UWA.createElement("div",{styles:{width:"100%",height:"100%",position:"relative"},id:"tileViewDiv",class:"content-approval-tile-div approvaltileView"}),_=UWA.createElement("div",{class:"showEmptyView",id:"approvalViewDiv"});UWA.createElement("div",{id:"approvalContentDiv",html:c.ECM_CA_Approval_TaskView_PlaceHolder}).inject(_),_.inject(y),y.inject(f)}})},checkResponse:function(e){let t,i,n=function(e,t){var i=new Date(e.dataelements.modified),n=new Date(t.dataelements.modified);return i.getTime()>n.getTime()?e:t};for(var o=0;o<e.length;o++){let a=e[o];if("Started"==a.dataelements.routeStatus)return a;if("Not Started"==a.dataelements.routeStatus)return a;"Stopped"==a.dataelements.routeStatus?t=null==t?a:n(t,a):"Finished"==a.dataelements.routeStatus&&(i=null==i?a:n(i,a))}return null!=t?t:i},OnSearchComplete:function(e){let t=e.split(","),o=[];o.push(t[0]),r.getObjectInfo(o,["name","type","identifier","label","title"]).then(function(e){let t=e[0],o=[],a={};a="Person"==t.type?{id:t.id,"ds6w:label":t.dataelements.fullname,"ds6w:identifier":t.dataelements.name,"ds6w:type_value":t.type,"ds6w:type":t.type}:{id:t.id,"ds6w:label":t.dataelements.title,"ds6w:identifier":t.dataelements.name,"ds6w:type_value":t.type,"ds6w:type":t.type},o.push(a),"form"==h?i.populateAssigneeField(d,p,u,o):"dialog"==h&&n.populateAssigneeField(d,o)})}};return m}),define("DS/ENOChangeActionUX/scripts/Views/CAProposedFlowdownPopoverView",["UWA/Class/View","DS/UIKIT/Popover","DS/ENOChangeActionUX/scripts/Views/CAFlowdownInfoPopOverBodyView"],function(e,t,i){"use strict";return e.extend({init:function(e){this.options=e,this._parent.call(this,e)},setup:function(){},render:function(){return this.container.empty(),this.launchMultiplePopover(),this},launchMultiplePopover:function(){this.proposedPopover&&this.proposedPopover.destroy();var e=this.options.target,n=this.proposedPopover=new t({className:"flowdown-items",target:e,position:"right",trigger:"click touch",autoHideOnClickOutside:!0,title:"flowdown info"}).show(),o={objectsSelected:this.options.data,container:n.elements.body,bodyOf:"multipleFlowdownInformation",bodyFor:this.options.popoverFor};this.popOverBodyview&&this.popOverBodyview.destroy(),(this.popOverBodyview=new i(o)).render()}})}),define("DS/ENOChangeActionUX/scripts/Views/CASlideInForAddFlowndownProposed",["UWA/Class/View","UWA/Core","DS/ENOChangeActionUX/scripts/CAPreferencesManager","DS/UIKIT/Modal","DS/Handlebars/Handlebars4","DS/PlatformAPI/PlatformAPI","DS/ENOChgRouter5/scripts/ChgRouter","text!DS/ENOChangeActionUX/scripts/Templates/CAAddProposedFlowdownTemplate.html"],function(e,t,i,n,o,a,s,r){"use strict";return e.extend({invokedFrom:"",isSlideOpen:!1,init:function(e){this._parent.call(this,e)},setup:function(e){var i=this;if(UWA.is(e)&&(this.invokedFrom=e.invokedFrom),"gov"==this.invokedFrom){var n=s.getDependency("xChangeApp");s.getDependency("applicationChannel").subscribe({event:"triptych-panel-hidden"},function(e){"right"===e&&1==i.isSlideOpen&&i.hideSlideIn()});for(var o=n.infoPanel.childNodes,a=0;a<o.length;a++){var r=o[a].className;UWA.is(r)&&"secondmainContainer-sidepanel"===r?(o[a].empty(),this.slideinContainer=o[a],o[a].style.display="block"):o[a].style.display="none"}this.skeletonContainer=t.extendElement(document.body).getElement(".triptych-main")}else this.slideinContainer=t.extendElement(document.body).getElement("#slidein-container"),this.skeletonContainer=t.extendElement(document.body).getElement("#skeleton-container"),this.resizerContainer=t.extendElement(document.body).getElement("#layout-resizer-div"),this.resizerContainer.addClassName("flowdown-proposed-slidein"),this.slideinContainer.empty(),this.slideinContainer.innerHTML=""},render:function(){return this},buildSlideIn:function(e){if(UWA.is(this.slideinContainer)&&UWA.is(e)){this.caProposedFlowdownPanel=e;var t=UWA.createElement("div",{id:"slideInContent",styles:{display:"block",height:"calc(100% - 10px)",width:"100%"}});e.container=t,t.inject(this.slideinContainer),t.set({events:{touchmove:function(e){e.stopPropagation()}}}),this.caProposedFlowdownPanel.render();var n=this;widget.addEvent("onResize",function(){setTimeout(function(){if(n.slideinContainer&&n.slideinContainer.clientWidth>0)if(window.matchMedia("(max-width: 768px)").matches)n.slideinContainer.style.width="100%",n.resizerContainer&&(n.resizerContainer.style.right="100%");else{var e={type:n.options.facetName},t=i.getIDCardSlideInSize(e);if(t&&t.Desktop){var o=t.Desktop,a=o.replace("px",""),s=parseInt(a),r=jQuery(".right-container")[0],l=s;r&&(l=r.offsetWidth-150),s>l?(n.slideinContainer.style.width=l+"px",n.resizerContainer&&(n.resizerContainer.style.right=l+"px")):(n.slideinContainer.style.width=o,n.resizerContainer&&(n.resizerContainer.style.right=o))}}},100)}),a.subscribe("ca-proposed-flowdown-slidein-closed",function(){n.hideSlideIn()}),this._handlerKeyUp=function(e){27==e.which&&n.hideSlideIn()},UWA.extendElement(document).addEvent("keyup",this._handlerKeyUp),a.subscribe("ca-back-to-summary-hide-slidein",function(){n.hideSlideIn()})}},showSlideIn:function(){if(UWA.is(this.slideinContainer)){if(this.resizerContainer&&(this.resizerContainer.style.display="block"),window.matchMedia("(max-width: 768px)").matches)this.slideinContainer.style.width="100%",this.resizerContainer&&(this.resizerContainer.style.right="100%");else{var e={type:this.options.facetName},n=i.getIDCardSlideInSize(e);if(n&&n.Desktop){var o=n.Desktop.replace("px","");if(""!=o){var a=parseInt(o),r=jQuery(".right-container")[0],l=a;r&&(l=r.offsetWidth-150),a<750?a<r.offsetWidth?(this.slideinContainer.style.width=r.offsetWidth-50+"px",this.resizerContainer&&(this.resizerContainer.style.right=r.offsetWidth-50+"px")):(this.slideinContainer.style.width="750px",this.resizerContainer&&(this.resizerContainer.style.right="750px")):a>=750&&(a<=l?(this.slideinContainer.style.width=n.Desktop,this.resizerContainer&&(this.resizerContainer.style.right=n.Desktop)):(this.slideinContainer.style.width=l+"px",this.resizerContainer&&(this.resizerContainer.style.right=l+"px")))}}else this.slideinContainer.style.width="1000px",this.resizerContainer&&(this.resizerContainer.style.right="1000px")}this.slideinContainer.style.borderLeftWidth="1px",this.skeletonContainer.style.opacity=".5",this.skeletonContainer.style.pointerEvents="none"}if("gov"==this.invokedFrom){this.isSlideOpen=!0;var c=s.getDependency("applicationChannel");c.publish({event:"triptych-show-panel",data:"right"});let e=t.extendElement(document.body).getElement(".flowdown-panel-close");t.extendElement(document.body).getElement(".triptych-right").style.width=this.slideinContainer.style.width,e.classList.add("displaynone"),c.publish({event:"information-panel-visible",data:null})}},hideSlideIn:function(){if(UWA.is(this.slideinContainer)){if(this.slideinContainer){var e=this.slideinContainer.style.width,t="Desktop";window.matchMedia("(max-width: 768px)").matches&&(t="Mobile");var n={type:this.options.facetName},o=i.getIDCardSlideInSize(n);o?(o[t]=e,"0px"!=e&&i.updateIDCardSlideInSize(o)):n&&(n[t]=e,"0px"!=e&&i.updateIDCardSlideInSize(n))}this.slideinContainer.innerHTML="",this.slideinContainer.style.width="0",this.slideinContainer.style.minWidth="0",this.resizerContainer&&(this.resizerContainer.style.right="0px",this.resizerContainer.style.display="none"),this.slideinContainer.style.borderLeftWidth="0",this.skeletonContainer.style.opacity="1";"gov"!=this.invokedFrom&&this.skeletonContainer.setStyle("width","calc( 100% - 0px )"),this.skeletonContainer.style.pointerEvents="inherit",this.destroy()}"gov"==this.invokedFrom&&(this.isSlideOpen=!1,s.getDependency("applicationChannel").publish({event:"triptych-hide-panel",data:"right"}))},destroy:function(){this.slideinContainer=null,this.resizerContainer=null,this.skeletonContainer=null}})}),define("DS/ENOChangeActionUX/scripts/Views/CAContextDataGridView",["UWA/Class/View","DS/DataGridView/DataGridView","DS/CollectionView/ResponsiveTilesCollectionView","DS/CollectionView/CollectionViewStatusBar","DS/ENOChangeActionUX/scripts/Services/CAContextDataGridViewServices","DS/ENOChangeActionUX/scripts/Services/CAContextDataGridViewToolbar","DS/ENOChgServices/scripts/services/ChgInfraService","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e,t,i,n,o,a,s,r){"use strict";return e.extend({name:"DS/ENOChangeActionUX/scripts/Views/CAContextDataGriView",viewName:"ContextView",className:"ca-context-view",physicalId:"",dataGrid:null,tileView:null,toolbar:null,treeDocument:null,columns:null,contextExcludeList:[],init:function(e){var l=this;l.options=e;var c=l.processColumns(),d={treeDocument:l.options.treeDocument,columns:c,cellSelection:"none",rowSelection:"multiple",cellDragEnabledFlag:!0,placeholder:r.ECM_CA_Context_Drop_Here,identifier:"width",defaultColumnDef:{width:"auto",resizableFlag:!0,sortableFlag:!0},onContextualEvent:function(e){var t=[];if(e&&e.collectionView&&e.cellInfos){if(e.cellInfos.rowID>-1)return o.showRMBMenuOnGrid(l,e).then(function(e){return e});e.collectionView.columns.length,e.cellInfos.columnID;t=e.collectionView.buildDefaultContextualMenu(e,{pin:!0,firstColumnsVisibility:!0,columnsManagement:!0,sizeColumnToFit:!1})}return t},onDragStartRowHeader:function(e,t){return s.readyDragContent(e,t),!0},onDragStartCell:function(e,t){return console.log(e),s.readyDragContent(e,t),!0}};d=UWA.merge(d,l.options);var p={model:l.options.treeDocument,height:"inherit",allowUbsafeHTMLContent:!0,displayedOptionalCellProperties:["contextualMenu","description","propertiesList","activeFlag"],useDragAndDrop:!0,onDragStartCell:function(e,t){s.readyDragContent(e,t)},onDragEnterBlankDefault:function(e){},onDragEnterBlank:function(e){}};l.dataGrid=new t(d),l.tileView=new i(p);var u={callback:function(e){if(e&&e.cellInfos&&e.cellInfos.cellModel)return o.showRMBMenuOnGrid(l,e).then(function(e){return e})}};l.tileView.onContextualEvent=u,a.toolbar=l.dataGrid.setToolbar(a.writetoolbarDefination()),l.toolbar=a.toolbar,0!=e.buildStatusBar&&(l.dataGrid.buildStatusBar([{type:n.STATUS.NB_ITEMS},{type:n.STATUS.NB_SELECTED_ROWS}]),l.tileView.buildStatusBar([{type:n.STATUS.NB_ITEMS},{type:n.STATUS.NB_SELECTED_ROWS}]))},render:function(){return this.contextViewDiv=UWA.createElement("div",{id:"outer-context-div",styles:{width:"100%",height:"100%",display:"inline-block"},class:"outer-context-div"}),this.toolbarDiv=UWA.createElement("div",{styles:{width:"100%"},class:"toolbar-context-div"}),this.gridViewDiv=UWA.createElement("div",{styles:{width:"100%",height:"calc(100% - 40px)",position:"relative"},class:"grid-context-div contextgridView hideView"}),this.tileViewDiv=UWA.createElement("div",{styles:{width:"100%",height:"calc(100% - 40px)",position:"relative"},class:"tile-context-div contexttileView showView"}),this.emptyTileViewDiv=UWA.createElement("div",{class:"hideView",id:"contextEmptyTileViewDiv"}),UWA.createElement("div",{html:r.ECM_CA_Context_Drop_Here,styles:{"align-self":"center"}}).inject(this.emptyTileViewDiv),this.dataGrid.inject(this.gridViewDiv),this.tileView.inject(this.tileViewDiv),this.toolbar.inject(this.toolbarDiv),this.emptyTileViewDiv.inject(this.tileViewDiv),this.contextViewDiv.addContent(this.toolbarDiv),this.contextViewDiv.addContent(this.gridViewDiv),this.contextViewDiv.addContent(this.tileViewDiv),this.contextViewDiv},processColumns:function(){return this.options.column}})}),define("DS/ENOChangeActionUX/scripts/Views/CAContextTileViewLayout",["UWA/Core","DS/ENOChangeActionUX/scripts/Services/CAContextDataGridViewServices"],function(e,t){"use strict";return{changeView:function(e){setTimeout(function(){t.changeView("TileView")},100)},showEmptyView:function(){var e=document.getElementById("contextEmptyTileViewDiv");e&&(e.removeClassName("hideView"),e.addClassName("showEmptyView"))},hideEmptyView:function(){var e=document.getElementById("contextEmptyTileViewDiv");e&&(e.addClassName("hideView"),e.removeClassName("showEmptyView"))}}}),define("DS/ENOChangeActionUX/scripts/Views/CAContextDataGridLayout",["DS/UIKIT/Mask","DS/ENOChangeActionUX/scripts/Views/CAContextDataGridView","DS/ENOChangeActionUX/scripts/Models//CAContextDataGridViewModel","DS/ENOChangeActionUX/scripts/Services/CAContextDataGridViewServices","DS/ENOChangeActionUX/scripts/Views/CAContextTileViewLayout","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/DataDragAndDrop/DataDragAndDrop","DS/PlatformAPI/PlatformAPI","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENOChangeActionUX/scripts/CASpinner","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/ENOChangeActionUX/scripts/CATagNavigatorProxy","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e,t,i,n,o,a,s,r,l,c,d,p,u,h){"use strict";var m={create:function(e){var a={};(a=UWA.merge(a,e)).hasOwnProperty("columns")||(a.columns=n.getColumns()),this.contextlayoutModel=a.treeDocument=(new i).createTreeDocument();var r=new t(a);this.contextView=r,this.target=a.target,r.render().inject(this.target),this.physicalId=a.caPhysicalId,l.unsubscribe("ca-user-access-updated"),l.unsubscribe("ca-IDCard-on-change-refresh"),l.subscribe("ca-user-access-updated",function(e){m.userAccess=e,m.updateToolBar(m.userAccess)}),l.subscribe("ca-IDCard-on-change-refresh",function(e){m.contextlayoutModel.empty(),m.refreshGrid()}),this.refreshGrid(),m.caTagNavigatorProxy=new u,m.viewName="Context",m.contextlayoutModel.getXSO().onPostAdd(function(){m.contextlayoutModel.getXSO().get().length>0&&m.userAccess&&"true"===m.userAccess.DeleteContext&&(console.log("Unable Remove Button"),m.enableCommand("removeContext"))}),m.contextlayoutModel.getXSO().onPostRemove(function(){0==m.contextlayoutModel.getXSO().get().length&&(console.log("Disable Remove Button"),m.disableCommand("removeContext"))}),m.makeDroppable(this.target),s.getUserAccess(m.physicalId).then(function(e){m.userAccess=e.userAccess,m.updateToolBar(m.userAccess),o.changeView(),document.querySelector(".toolbar-context-div .wux-ui-3ds-trash").parentElement.parentElement.setAttribute("disabled",!0),document.querySelector(".toolbar-context-div .wux-tweakers-string-label").setStyles({color:"#777",fontWeight:"bold",fontSize:"20px"})})},refreshGrid:function(){n.getCAContextForGridView(m.physicalId).then(function(e){var t=e.contextInfo;m.contextExcludeList=e.contextId,m.loadDataInGrid(t),m.caTagNavigatorProxy._initTaggerProxy(m.viewName).then(function(e){m.caTagNavigatorProxy._setSubjectTags(m.contextlayoutModel,m.viewName);var t=m._externalEvents={onContextTaggerFilterChange:function(e){m.filterTaggerChange(e)}};m.contextView.listenTo(m.caTagNavigatorProxy,t),s.setTaggerObject(m.viewName,m.caTagNavigatorProxy)},function(e){console.log("Tagger initilization failed")})})},loadDataInGrid:function(t){(new i).loadData(m.contextlayoutModel,t),0==m.contextlayoutModel.getChildren().length?o.showEmptyView():o.hideEmptyView(),e.unmask(m.target)},searchContext:function(){var e=a.getGlobalVariable();if(e.isNative){p.DispatchEventToWin("Add_Context","Context")}else m.SearchObj=s.activateSearch(e.contextSearchType,"context"),s.search("context",e.contextSearchType,m.OnSearchComplete,"context",m.SearchObj,m.contextExcludeList)},OnSearchComplete:function(e){if(a.getGlobalVariable().isNative){for(var t=e.split("~"),i=[],n=0;n<t.length;n++)i.push(t[n]);for(var o=[],s=0;s<t.length;s++)o.push(i[s].split(","));m.addContext(o)}else m.addContext(e)},addContext:function(t){var i=m.target;d.doWait(i);var a=m.modifyContextJSON(t,"add");JSON.parse(a);s.editCA(a,m.physicalId,function(e){if((i=e.changeaction.context).length>0){var t=i.filter(e=>!m.contextExcludeList.includes(e.id.slice(4)));n.processContexts(t).then(function(e){var t=e.contextInfo;m.contextExcludeList=m.contextExcludeList.concat(e.contextId),o.hideEmptyView(),m.loadDataInGrid(t),m.caTagNavigatorProxy._setSubjectTags(m.contextlayoutModel,m.viewName)})}else{var i=[];m.contextExcludeList=[],m.loadDataInGrid(i)}},function(){i&&e.isMasked(i)&&e.unmask(i)})},modifyContextJSON:function(e,t){return JSON.stringify({version:"v0",changeaction:{addRemove:{context:m.jsonContext(e,t)}}}).replace("addRemove",t)},jsonContext:function(e,t){for(var i=[],n=0;n<e.length;n++)if("add"===t){var o=e[n];i.push("pid:"+o[0])}else i.push("pid:"+e[n]);return i},removeContext:function(){if(0==m.contextlayoutModel.getSelectedNodes().length);else{for(var e=m.contextlayoutModel.getSelectedNodes().length,t=[],i=0;i<e;i++){var n=m.contextlayoutModel.getSelectedNodes()[0].options.grid.id;m.contextlayoutModel.getSelectedNodes()[0].remove(),t.push(n)}m.contextExcludeList=m.contextExcludeList.filter(e=>!t.includes(e));var a=m.modifyContextJSON(t,"delete");JSON.parse(a);s.editCA(a,m.physicalId,function(e){0==e.changeaction.context.length&&o.showEmptyView(),m.caTagNavigatorProxy._setSubjectTags(m.contextlayoutModel,m.viewName)},null)}},makeDroppable:function(e){r.droppable(e,{drop:function(e,t,i){if(i.stopPropagation&&i.stopPropagation(),i.preventDefault&&i.preventDefault(),i.dataTransfer&&i.dataTransfer.dropEffect&&(i.dataTransfer.dropEffect="copy"),UWA.is(e)&&""!=e){var n=JSON.parse(e),o=s.checkTenantInforamation(n);if(0!=o.TenantInfoMissing.length)c.error(h.ECM_CA_Pref_PlatformMissing_Error);else if(0!=o.DiffTenantData.length)c.error(h.ECM_CA_Pref_PlatformDoesNotMatch_Error);else{n=s.removeDuplicatesToBeDroppedObjects(n);var a=s.filterBasedOnServiceId(n);if(a.incorrectServiceInfo&&Array.isArray(a.incorrectServiceInfo)&&a.incorrectServiceInfo.length>0){var r=h.ECM_WARN_DROP_SKIPPED+"<br/>";for(var l in a.incorrectServiceInfo)r+=a.incorrectServiceInfo[l]+"<br/>";c.warn(r,"false")}m.ExecuteDrop(n)}}else d.endWait(widget.body),c.error(h.ECM_CA_Drop_Not_Supported)},over:function(){arguments[0].setStyles({borderStyle:"solid",borderColor:"blue",borderWidth:"1px"})},leave:function(){arguments[0].setStyle("borderWidth","0px")}})},ExecuteDrop:function(e){if(e){var t=e.data.items;if(UWA.is(t)&&UWA.is(t.length)&&t.length>0){for(var i=[],n=0,o=0;o<t.length;o++){var a=[];-1!=m.contextExcludeList.indexOf(t[o].objectId)?n++:(a.push(t[o].objectId),i.push(a))}0!=n&&c.warn(h.ECM_CA_Context_Already_Added),0!=i.length&&m.addContext(i)}}else d.endWait(widget.body),c.error(h.ECM_CA_Drop_Not_Supported);m.target.setStyle("borderWidth","0px")},updateToolBar:function(e){e&&e.DeleteContext&&"false"===e.DeleteContext?(m.disableCommand("addContext"),m.disableCommand("removeContext")):(m.enableCommand("addContext"),m.contextlayoutModel.getXSO().get().length>0&&m.enableCommand("removeContext"))},enableCommand:function(e){m.contextView.dataGrid.getToolbar().updateNodeModel(e,{disabled:!1})},disableCommand:function(e){m.contextView.dataGrid.getToolbar().updateNodeModel(e,{disabled:!0})},filterTaggerChange:function(e){n.processContexts(e).then(function(e){var t=e.contextInfo;m.contextlayoutModel.empty(),m.loadDataInGrid(t)}),console.log(e)},changeView:function(){n.changeView("GridView")}};return m}),define("DS/ENOChangeActionUX/scripts/Collection/CAMembersCollection",["UWA/Core","UWA/Class/Collection","DS/ENOChangeActionUX/scripts/Models/CAMemberModel"],function(e,t,i){"use strict";return t.extend({model:i,setup:function(){},fetch:function(e){var t;return t=e.data=this.membersArr=e.membersArr,e.ajax=function(e,i){i.onComplete(t)},this.url="dummyURL",this._parent(e)}})}),define("DS/ENOChangeActionUX/scripts/Services/CATeamViewServices",["UWA/Core","DS/ENOChangeActionUX/scripts/Models/CAMemberModel","DS/ENOChangeActionUX/scripts/Collection/CAMembersCollection"],function(e,t,i){"use strict";return{rearrangeMembersByRole:function(e,i,n){Array.isArray(i)&&i.forEach(function(t){var i=t.name,n=e.findWhere({userName:i});n&&n.set("role","")}),Array.isArray(i)&&i.forEach(function(i){var o=i.name,a=e.findWhere({userName:o});if(a){var s=a.get("role"),r=i.role,l=[];s.length&&(l=s.split(","));-1===(c=l.indexOf(r))&&(0===l.length?l.push(r):(r=" "+r,l.push(r)),a.set("role",l.toString()))}else{for(var c=0;c<n.length;c++){var d=!1,p=n[c];if(p.name===i.name){d=!0,i.id="pid:"+p.id,i.fullName=p.fullName;r=i.role;i.role=r,"Route Template"!=p.type&&(i.type="Person");break}}d&&e.add(new t(i,{parse:!0}))}}),n.forEach(function(t){var n=t.name;if(!1===function(e){for(var t=!1,n=0;n<i.length;n++)e===i[n].name&&(t=!0);return t}(n)){var o=e.findWhere({userName:n});o&&e.remove(o)}})},createMembersCollection:function(e){var t={membersArr:e},n=new i;return n.fetch(t),n}}}),define("DS/ENOChangeActionUX/scripts/Views/CATransferRealizedForm",["UWA/Controls/Abstract","DS/ENOChangeActionUX/scripts/Models/CATransRealDispModel","DS/E6WCommonUI/Views/DetailsDisplayView","DS/UIKIT/Input/Button","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChangeActionUX/scripts/CASpinner","DS/ENOChangeActionUX/scripts/Views/CACustomTitleView","DS/ENOChangeActionUX/scripts/Search","DS/ENOChangeActionUX/scripts/Views/CACustomSeverityView","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgRealizedServices","DS/ENOChgServices/scripts/services/ChgErrors"],function(e,t,i,n,o,a,s,r,l,c,d,p){var u=e.extend({displayViewModel:null,SaveTransRealCallback:null,slideInReference:null,selectedOperation:null,detailsView:null,that:this,options:null,allCATypes:[],init:function(e){var n=this;n.allCATypes=[],1==c.getGlobalVariable().changeActionSubTypePresent&&c.getGlobalVariable().changeActionSubTypes.forEach(function(t){var i={};i.actualValue=t.value,i.displayValue=t.label,"Change Action"==t.value&&(e.defaultCATypeNLS=t.label),n.allCATypes.push(i)}),UWA.is(e)&&(this.SaveTransRealCallback=e.callback,this.displayViewModel=new t(e,{parse:!0}),this.detailsView=new i,this.options=e)},getHeading:function(){return"Existing"===this.options.Mode?o.ECM_CA_Realized_Transfer_Heading_ExistingCA:"New"===this.options.Mode?o.ECM_CA_Realized_Transfer_NewCA:void 0},getBody:function(){var e=this,t=UWA.createElement("div",{id:"formBody"});t.setAttribute("data-rec-id","formBodyCA");new(UWA.Class.View.extend({setup:function(){"Existing"===e.options.Mode&&this.listenTo(this.model,"onChange",this.render),this.listenTo(this.model,"onChange:createObjectTitle",e.updateBtnState)},render:function(){t.setContent(""),e.detailsView.setConfig(e.getConfig()),e.detailsView.model=e.displayViewModel,e.detailsView.tenant=c.getGlobalVariable().tenant,e.detailsView.context=enoviaServer.context,e.detailsView.render().inject(t),arguments&&arguments.length>0&&e.updateBtnState(arguments[0])}}))({model:e.displayViewModel}).render();return t},getFooter:function(){var e=this,t=u.footer=UWA.Element("div",{});return new n({value:o.ECM_CA_Realized_Transfer_Save,className:"primary proposedButtons",disabled:!0}).inject(t).elements.input.onclick=function(){e.onSaveButtonClick()},new n({value:o.ECM_CA_Realized_Transfer_Cancel,className:"proposedButtons"}).inject(t).addEvent("onClick",this.onCancelButtonClick.bind(this)),t},getCreateEditData:function(e){var t="";if(UWA.is(e)){var i=e.get("createObjectTitle"),n=e.get("descriptionOfObj");n||(n="");var o=e.get("severity"),a="",s="Change Action";if(1==c.getGlobalVariable().changeActionSubTypePresent&&(s=e.get("caType").actualValue),UWA.is(e.get("dueDate"))){var r,l;r=e.get("dueDate").actualValue;var d=(l=new Date(r)).getMonth()+1,p=l.getDate();a=l.getFullYear()+"-"+d+"-"+p}t={type:s,description:n,synopsis:i,severity:o,scheduledCompletionDate:a}}return t},getTransferRealizedData:function(e){return{transferPurpose:e.get("reasonForChangeForActivity").actualValue,transferComment:"textofTransfer",idsToTransfer:this.options.ids}},onSaveButtonClick:function(){var e=this,t=function(t){e.slideInReference.hideSlideIn(),a.endWait(widget.body),p.success(o.ECM_CA_Realized_Transfer_Success),e.SaveTransRealCallback(t)};if(this.detailsView.isModelValid()){if("New"===this.options.Mode){var i=this.getCreateEditData(this.displayViewModel),n=this.getTransferRealizedData(this.displayViewModel);a.doWait(widget.body),d.createCAAndTransferRealized(i,n,t,function(t){a.endWait(widget.body),e.slideInReference.hideSlideIn()})}else if("Existing"===this.options.Mode){i=this.getTransferData(this.displayViewModel),n=this.getTransferRealizedData(this.displayViewModel);a.doWait(widget.body),d.transferRealized(i,n,t)}}else p.error(o.ECM_CA_Realized_Transfer_MandAttrErr)},onCancelButtonClick:function(){this.slideInReference.hideSlideIn()},getConfig:function(){var e,t=[];if(e=new Date,"New"===this.options.Mode&&(1==c.getGlobalVariable().changeActionSubTypePresent&&"true"==c.getGlobalVariable().CHG_TRANSFER_REALIZED_CUST_TYPE&&t.push({required:!0,readWrite:"true",name:"caType",label:o.ECM_CA_Type,type:"select",values:this.allCATypes}),t.push({required:!0,label:"Title",name:"createObjectTitle",customView:s}),t.push({readWrite:"true",name:"descriptionOfObj",label:o.ECM_CA_Realized_Transfer_Description,type:"textarea",numberOfDisplayLines:3,numberOfEditableLines:3}),t.push({label:o.ECM_CA_Realized_Transfer_Severity,name:"severity",customView:l}),t.push({label:o.ECM_CA_Realized_Transfer_DueDate,name:"dueDate",readWrite:"true",type:"date",min:e}),t.push({readWrite:"true",name:"reasonForChangeForActivity",label:o.ECM_CA_Realized_Transfer_ReasonForTransfer,type:"select",values:this.getTransferOptionsValues()})),"Existing"===this.options.Mode){var i,n="";n=n+"NOT ("+this.options.contextCAId.replace("pid","physicalid")+")";var a=new r({title:"Change Action",precond:i='AND (current:Prepare OR current:"In Work") AND (NOT flattenedtaxonomies:"interfaces/Change On Hold")',excludeList:n,from:"realized",types:"Change Action"},!1);t.push({readWrite:!UWA.is(this.displayViewModel.id),type:"object",name:"changeaction",label:o.ECM_CA_Widget_Title,attributeToDisplay:"objectName",singleObjectOnly:!0,searchTitle:o.ECM_CA_Widget_Title,searchTypes:"Change Action",required:!UWA.is(this.displayViewModel.id),imageAttribute:"image",typeAheadCallback:this.displayViewModel.proposedTypeAheadCallback,fieldHTMLId:"changeaction",excludeSearchTypes:n+i,search:a}),t.push({readWrite:"true",name:"reasonForChangeForActivity",label:o.ECM_CA_Realized_Transfer_ReasonForTransfer,type:"select",values:this.getTransferOptionsValues()})}return t},getTransferData:function(e){return{version:"v0",changeaction:e.get("changeaction")}},updateBtnState:function(){var e=arguments[0];if(e){var t,i=e.get("createObjectTitle"),n=e.get("changeaction");if(i&&""!=i.trim()||n&&""!=n.objectID){if(u.footer)(t=u.footer).firstChild.disabled=!1,t.firstChild.removeClassName("disabled")}else if(u.footer)(t=u.footer).firstChild.disabled=!0,t.firstChild.addClassName("disabled")}},getTransferOptionsValues:function(){var e=[];return"true"===this.options.RealizedTransferBit&&e.push({displayValue:o.ECM_CA_Realized_Transfer_EarlyCompl,actualValue:"early"},{displayValue:o.ECM_CA_Realized_Transfer_DelayedCompl,actualValue:"late"}),e.push({displayValue:o.ECM_CA_Realized_Transfer_Move,actualValue:"simple"}),e}});return u}),define("DS/ENOChangeActionUX/scripts/Views/CATeamTileViewLayout",["UWA/Core","DS/ENOChangeActionUX/scripts/Services/CATeamDataGridViewServices"],function(e,t){"use strict";return{changeView:function(e){setTimeout(function(){t.changeView("TileView")},100)},showEmptyView:function(){var e=document.getElementById("teamEmptyTileViewDiv");e&&(e.removeClassName("hideView"),e.addClassName("showEmptyView"))},hideEmptyView:function(){var e=document.getElementById("teamEmptyTileViewDiv");e&&(e.addClassName("hideView"),e.removeClassName("showEmptyView"))}}}),define("DS/ENOChangeActionUX/scripts/Views/CAPanelAddMemberView",["UWA/Core","UWA/Utils","DS/W3DXComponents/Views/Item/PanelAddMemberView","DS/ENOChangeActionUX/scripts/Views/CALabelManagerView","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices"],function(e,t,i,n,o){"use strict";return i.extend({name:"CAPanelAddMemberView",buildBody:function(){var t=this,i=e.extend({spreadClick:!0,events:{onUpdate:function(e,i){t.elements.buttons.save.setDisabled(e.length<1),t.labels=e,t.dispatchEvent("onUpdateLabels",[t.labels,i])},onPersonSelect:function(e,i){for(var n=[],o=0;o<e.length;o++){var a={objectId:e[o][0],objectType:e[o][2],displayType:e[o][3]};n.push(a)}var s={data:{items:n}};t.dispatchEvent("onPersonSelect",[s,i])}}},this.options);this.addMemberBody=new n(i),o.setLabelManagerView(this.addMemberBody),this.elements.labelmanager=e.createElement("div",{class:"paneladdmember-item-view-body",html:this.addMemberBody.render()})},onSaveCalled:function(){var e=this.labels;this.saveProcess(e),this.resetViewAfterSave()},resetViewAfterSave:function(){this.buildSkeleton(),this.render()},onCancelCalled:function(){this.resetView(),document.querySelector(".teamViewSet-contents").removeClassName("teamview-opaque");var e=document.querySelector(".set-container .set-contents");e&&e.setStyle("height","calc( 100% - 50px)")}})}),define("DS/ENOChangeActionUX/scripts/Views/CAFlowdownProposedRealizedView",["UWA/Core","UWA/Class","UWA/Class/View","DS/ENOChangeActionUX/scripts/Services/CARealizedViewServices"],function(e,t,i,n){return i.extend({init:function(e){this._options=e,console.log(e)},setup:function(){},render:function(){console.log("render called")}})}),define("DS/ENOChangeActionUX/scripts/Views/CAMemberFilterLayout",["DS/ENOChangeActionUX/scripts/Views/CAMemberFilterView"],function(e){"use strict";var t={createMemberFilter:function(i){t.teamlayoutModel=i.model,new e({events:{memberFilterKeyUp:function(e){t.enteredText=e.target.value;var i={filteringMode:"name",text:t.enteredText};t.filterCollectionAndUpdateUI(i)},memberRoleFilter:function(e){var i={filteringMode:"role",text:t.enteredText?t.enteredText:"",assigneeInclude:!1,reviewInclude:!1,followInclude:!1},n=document.getElementById("allToggle"),o=document.getElementById("assigneeToggle");o&&o.checked&&(i.assigneeInclude=!0);var a=document.getElementById("revMemToggle");a&&a.checked&&(i.reviewInclude=!0);var s=document.getElementById("followMemToggle");s&&s.checked&&(i.followInclude=!0),0==i.assigneeInclude&&0==i.reviewInclude&&0==i.followInclude||1==i.assigneeInclude&&1==i.reviewInclude&&1==i.followInclude||"allToggle"==e.target.id&&1==n.checked?(i.allInclude=!0,n.checked=!0,o.checked=!1,a.checked=!1,s.checked=!1):(i.allInclude=!1,n.checked=!1),t.filterCollectionAndUpdateUI(i)}}}).render().inject(i.target)},filterCollectionAndUpdateUI:function(e){var i=e.text;t.teamlayoutModel.setFilterModel({fullName:{filterId:"stringRegexp",filterModel:{condition1:{type:"contains",filter:i}}},role:{filterId:"stringRegexp"}});var n=t.teamlayoutModel.getFilterManager().getFilters().role,o={};0==e.allInclude&&(1==e.assigneeInclude&&(o.condition1={type:"contains",filter:"contributor"}),1==e.reviewInclude&&(o.hasOwnProperty("condition1")?(o.operator="or",o.condition2={type:"contains",filter:"reviewer"}):o.condition1={type:"contains",filter:"reviewer"}),1==e.followInclude&&(o.hasOwnProperty("condition1")?(o.operator="or",o.condition2={type:"contains",filter:"follower"}):o.condition1={type:"contains",filter:"follower"}),n.filterModel=o)},launchFilterMemberPanel:function(){var e=document.querySelector(".addmemberView"),t=document.querySelector(".filtermemberView"),i=document.querySelector(".teamgridView"),n=document.querySelector(".teamtileView"),o=document.querySelector(".toolbar-team-div .wux-ui-3ds-filter");e.hide(),i.removeClassName("teamview-opaque"),n.removeClassName("teamview-opaque"),"block"==t.style.display?(t.hide(),o.removeClassName("currentView"),i.style.height="calc(100% - 40px)",n.style.height="calc(100% - 40px)"):(t.show(),o.addClassName("currentView"),i.style.height="calc(100% - 158px)",n.style.height="calc(100% - 158px)")}};return t}),define("DS/ENOChangeActionUX/scripts/Views/CATeamSetView",["UWA/Class/View","DS/W3DXComponents/Views/Item/SetView","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","UWA/Core","DS/Handlebars/Handlebars4","DS/ENOChangeActionUX/scripts/Views/CAPanelAddMemberView","DS/ENOChangeActionUX/scripts/Views/CATeamFilterView","DS/ENOChgServices/scripts/services/ChgMembersServices"],function(e,t,i,n,o,a,s,r){return t.extend({name:"teamViewSet",setup:function(){this._initAddMembersPanelView(),this._initFilterMembersPanelView(),this._parent.call(this,{})},template:function(){return'                        <div class="'+this.getClassNames("-header")+'">                            <div class="'+this.getClassNames("-detail")+'"></div>                            <div class="'+this.getClassNames("-actions")+'"></div>                            <div class="'+this.getClassNames("-multiselHeader")+'"></div>                            <div class="'+this.getClassNames("-switcher")+'"></div>                        </div>                        <div class="'+this.getClassNames("-addMembers")+'"></div>                        <div class="'+this.getClassNames("-filterMembers")+'"></div>                        <div class="'+this.getClassNames("-contents")+'"></div>                    '},_initAddMembersPanelView:function(){var e,t,i=this;return e=this.addMebersView=new a(this.getAddMebersOptions()),t=this._addMemberViewEvents={onUpdateLabels:function(){if(arguments&&arguments[0]){var e=arguments[0];if(e&&Array.isArray(e)&&e.length>0){var t=!1;e.forEach(function(e){var i=e&&e.item?e.item.type:"";"reviewer"===e.item.categoryId&&(t=!0),!e||"reviewer"!==e.item.categoryId||""!==r.reviewerType.typeOfReviewer&&""!==i||(r.reviewerType={typeOfReviewer:i,labelSelected:!0})}),t||(r.reviewerType={typeOfReviewer:"",labelSelected:!1})}else"reviewer"===arguments[1]&&(r.reviewerType={typeOfReviewer:"",labelSelected:!1})}},onPersonSelect:function(e,t){i.dispatchEvent("onPersonSelect",[e,t])}},this.listenTo(e,t),e},getAddMebersOptions:function(){return this.getOption("addMembers")},_initFilterMembersPanelView:function(){var e,t;return t=this._filterMembersEvent={memberFilterKeyUp:function(){this.dispatchEvent("memberFilterKeyUp",arguments)}},e=this.filterMebersView=new s(this.getFilterMebersOptions()),this.listenTo(e,t),e},getFilterMebersOptions:function(){return this.getOption("filterMembers")},onRender:function(){this.injectSubView(this.addMebersView,"."+this.name+"-addMembers"),this.addMebersView.show(),this.injectSubView(this.filterMebersView,"."+this.name+"-filterMembers");this._parent.call(this,{})},setLabel:function(e){var t=this.addMebersView.addMemberBody.autoCompleteArr,i=null;t.forEach(function(t){e.category===t.category&&(i=t.autocomplete)}),i&&(i.elements.input.set({"data-key":e.categoryId}),i.dispatchEvent("onSelect",[e.categoryId,e,!1]))}})}),define("DS/ENOChangeActionUX/scripts/Views/CANewTeamView",["UWA/Class/View","UWA/Core","DS/W3DXComponents/Views/EmptyView","DS/W3DXComponents/Views/Layout/GridScrollView","DS/W3DXComponents/Views/Layout/TableScrollView","DS/W3DXComponents/Views/Item/RowView","DS/W3DXComponents/Collections/ActionsCollection","DS/ENOChangeActionUX/scripts/Views/CATeamSetView","DS/ENOChangeActionUX/scripts/Views/CACustomTeamTileView","DS/ENOChangeActionUX/scripts/Views/CATempAutocomplete","DS/ENOChangeActionUX/scripts/CASpinner","DS/ENOChangeActionUX/scripts/CATagNavigatorProxy","WebappsUtils/WebappsUtils","DS/UIKIT/DropdownMenu","DS/DataDragAndDrop/DataDragAndDrop","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChangeActionUX/scripts/CAWidgetConfiguration","DS/i3DXCompassPlatformServices/OpenWith","DS/PlatformAPI/PlatformAPI","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChangeActionUX/scripts/Services/CATeamViewServices","DS/ENOChgServices/scripts/services/ChgMembersServices","DS/ENOChgServices/scripts/services/ChgNativeInitService"],function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v,A,w,b,S,y,_){"use strict";var E=e.extend({init:function(e){e&&(this.model=e.model),this._parent.call(this,e)},setup:function(){if(this.model){var e=this.model.get("people"),t=this,i=this.caTagNavigatorProxy=new p;i._initTaggerProxy("Team").then(function(n){i._setSubjectTags(e,"Team");var o=t._externalEvents={onMembersTaggerProxyFilterChange:function(e){t.filterTaggerChange(e)}};t.listenTo(i,o),b.setTaggerObject("Team",i)},function(e){return console.log("Tagger initilization failed"),Promise.reject(e)})}},render:function(){var e=this;E.selectedModelsForDrag={},E.isCheckSelected=!1,E.multiSelOn=!1,y.reviewerType.labelSelected=!1,b.getCurrentModel()||b.setCurrModel(this.model);var t=E.originalCollection=new UWA.Class.Collection(this.model.get("people").toArray()),i=E.teamSetView=this.buildTeamSetView(this.model.get("people")),n={onMultiselOff:function(){E.isCheckSelected=!1,E.multiSelOn=!1;var e=Object.keys(E.selectedModelsForDrag);for(var t in e)delete E.selectedModelsForDrag[e[t]];A.getGlobalVariable().arrOid&&A.getGlobalVariable().arrOid.length&&A.getGlobalVariable().arrOid.splice(0,A.getGlobalVariable().arrOid.length);var i=a.getElement(".paneladdmember-item-view-container");i&&i.hasClassName("expanded")&&document.querySelector(".teamViewSet-contents").addClassName("teamview-opaque")},onMultiselOn:function(){E.isCheckSelected=!0,E.multiSelOn=!0,e.memberSetView.addMebersView.onCancelCalled()},onPersonSelect:function(t,i){e.ExecuteDropForMemberAssignmentPanel(t,i)}};this.listenTo(i,n);var o=this.container.getElement("#divForTeamViewContent");o?o.empty():(o=new UWA.Element("div",{styles:{height:"100%",width:"99.9%"}})).setAttributes({id:"divForTeamViewContent"}),o.inject(this.container),i.render().inject(o),setTimeout(function(){if(!A.getGlobalVariable().isNative){var t=document.querySelector(".teamViewSet-contents");t&&e.makeDroppable(t,e);var i=document.querySelector("#assignee-wrapper"),n=document.querySelector("#reviewer-wrapper"),o=document.querySelector("#follower-wrapper");i&&e.makeMemberSectionDroppable(i,e),n&&e.makeMemberSectionDroppable(n,e),o&&e.makeMemberSectionDroppable(o,e);var s=a.getElement(".paneladdmember-item-view-container");s&&s.removeClassName("expanded")}},1e3),this.container.getElement(".teamViewSet-filterMembers").setStyle("display","none");var a=this.container.getElement(".teamViewSet-addMembers");a.setStyle("display","none"),this.listenTo(this.model,"onChange:people",this.render),this.listenTo(this.model,"onChange:userAccess",this.updateHeaderOnAccessUpdate);var s=A.getGlobalVariable().contextUser+"_comments";this.listenTo(this.model,"onChange:"+s,this.refreshUIOnCommentChange);var r=A.getGlobalVariable().contextUser+"_approvalStatus";this.listenTo(this.model,"onChange:"+r,this.refreshUIOnCommentChange);e=this;t.forEach(function(t){if(t&&t.get("role").indexOf("reviewer")>=0){var i=t.get("userName")+"_comments",n=t.get("userName")+"_approvalStatus";e.listenTo(e.model,"onChange:"+i,e.refreshUIOnCommentChange),e.listenTo(e.model,"onChange:"+n,e.refreshUIOnCommentChange)}});var l=A.getGlobalVariable().isNative?1e3:0;setTimeout(function(){e.caTagNavigatorProxy&&e.caTagNavigatorProxy._setSubjectTags(e.model.get("people"),"Team")},l)},makeMemberSectionDroppable:function(e,t){m.droppable(e,{drop:function(e,i,n){if(n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault(),n.dataTransfer&&n.dataTransfer.dropEffect&&(n.dataTransfer.dropEffect="copy"),UWA.is(e)&&""!=e){var o=JSON.parse(e),a=b.checkTenantInforamation(o);if(0!=a.TenantInfoMissing.length)w.error(g.ECM_CA_Pref_PlatformMissing_Error);else if(0!=a.DiffTenantData.length)w.error(g.ECM_CA_Pref_PlatformDoesNotMatch_Error);else{o=b.removeDuplicatesToBeDroppedObjects(o);var s=i.id.split("-")[0];t.ExecuteDropForMemberAssignmentPanel(o,s)}}else w.error(g.ECM_CA_Drop_Not_Supported);document.querySelector("#assignee-wrapper").setStyle("borderWidth","0px"),document.querySelector("#reviewer-wrapper").setStyle("borderWidth","0px"),document.querySelector("#follower-wrapper").setStyle("borderWidth","0px")},over:function(){arguments[0].setStyles({borderStyle:"dashed",borderColor:"#368ec4",borderWidth:"2px"})},leave:function(){arguments[0].setStyle("borderWidth","0px")}})},makeDroppable:function(e,t){m.droppable(e,{drop:function(e,i,n){d.doWait(widget.body);if(n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault(),n.dataTransfer&&n.dataTransfer.dropEffect&&(n.dataTransfer.dropEffect="copy"),UWA.is(e)&&""!=e){var o=JSON.parse(e),a=b.checkTenantInforamation(o);if(0!=a.TenantInfoMissing.length)w.error(g.ECM_CA_Pref_PlatformMissing_Error);else if(0!=a.DiffTenantData.length)w.error(g.ECM_CA_Pref_PlatformDoesNotMatch_Error);else{o=b.removeDuplicatesToBeDroppedObjects(o);var s=b.filterBasedOnServiceId(o);if(s.incorrectServiceInfo&&Array.isArray(s.incorrectServiceInfo)&&s.incorrectServiceInfo.length>0){var r=g.ECM_WARN_DROP_SKIPPED+"<br/>";for(var l in s.incorrectServiceInfo)r+=s.incorrectServiceInfo[l]+"<br/>";w.warn(r,"false")}t.ExecuteDrop(o),n.currentTarget.setStyle("borderWidth","0px")}}else d.endWait(widget.body),w.error(g.ECM_CA_Drop_Not_Supported)},over:function(){arguments[0].setStyles({borderStyle:"solid",borderColor:"blue",borderWidth:"1px"})},leave:function(){arguments[0].setStyle("borderWidth","0px")}})},ExecuteDropForMemberAssignmentPanel:function(e,t){var i=this,n=[];if(e&&e.data&&e.data.items){var o=e.data.items;if(UWA.is(o)&&UWA.is(o.length)&&o.length>0){for(var a=[],s=0;s<o.length;s++)o[s].objectId&&a.push(o[s].objectId);0!=a.length?b.getAdditionObjectInfo(a).then(function(e){for(var o=0;o<a.length;o++){var s={},r=e.additionObjectInfo[a[o]];if(r.type&&"Person"===r.type)if(!1===(c="Route Template"===y.reviewerType.typeOfReviewer)||"reviewer"!=t)s.id=r.pid,s.identifier=r.objectName,s.name=r.fullName,s.type="Person",s.categoryId=t+s.identifier,s.category=t,i.memberSetView&&i.memberSetView.setLabel(s),n.push(s);else{var l=g.ECM_CA_ROUTE_TEMPLATE;"Person"===y.reviewerType.typeOfReviewer&&(l=g.ECM_CA_PERSON),w.error(l+" "+g.ECM_CA_PERSON_ROUTE_MIXED_ERROR)}else if(r.type&&"Route Template"===r.type){if("reviewer"!=t)return void w.error(g.ECM_ERR_WRONG_CATEGORY);var c=!1;if(new UWA.Class.Collection(i.model.get("people").toArray()).forEach(function(e){e&&e.get("role").indexOf("reviewer")>=0&&(c=!0)}),"Person"!==y.reviewerType.typeOfReviewer&&"Route Template"!==y.reviewerType.typeOfReviewer||(c=!0),!1===c)s.id=r.pid,s.name=r.objectName,s.identifier=r.objectName,s.fullName=r.objectName,s.type="Route Template",s.roles="reviewer",s.categoryId=t+s.identifier,s.category=t,i.memberSetView&&i.memberSetView.setLabel(s),n.push(s);else{l=g.ECM_CA_ROUTE_TEMPLATE;"Person"===y.reviewerType.typeOfReviewer&&(l=g.ECM_CA_PERSON),w.error(l+" "+g.ECM_CA_PERSON_ROUTE_MIXED_ERROR)}}else w.error(g.ECM_ERR_NO_PERSON_NO_ROUTETEMPLATE)}},function(e){return console.log("Failed in getting person id"),Promise.reject(e)}):w.error(g.ECM_CA_Drop_Not_Supported)}}else d.endWait(widget.body),w.error(g.ECM_CA_Drop_Not_Supported)},ExecuteDrop:function(e){var t=this,i=[];if(e){var n=e.data.items;if(UWA.is(n)&&UWA.is(n.length)&&n.length>0){for(var o=[],a=[],s=[],r=[],l=0;l<n.length;l++)n[l].objectId&&("3DSpace"==n[l].serviceId?(o.push(n[l].objectId),s.push(n[l].displayName)):"3DSwym"==n[l].serviceId&&"pno:Person"==n[l].objectType&&(a.push(n[l].objectId.replace("iam:","")),r.push(n[l].displayName)));var c=function(e,n,o){for(var a=0;a<n.length;a++){var s={},r=e.additionObjectInfo[n[a]];if(r&&r.type&&"Person"===r.type)s.id=r.pid,s.name=r.objectName,s.fullName=o[a],s.type="Person",s.roles="contributor",i.push(s);else if(r.type&&"Route Template"===r.type){var l=!1;if(new UWA.Class.Collection(t.model.get("people").toArray()).forEach(function(e){e&&e.get("role").indexOf("reviewer")>=0&&(l=!0)}),!1===l)s.id=r.pid,s.name=r.objectName,s.fullName=r.objectName,s.type="Route Template",s.roles="reviewer",i.push(s);else{var c=g.ECM_CA_ROUTE_TEMPLATE;"Person"===y.reviewerType.typeOfReviewer&&(c=g.ECM_CA_PERSON),w.error(c+" "+g.ECM_CA_PERSON_ROUTE_MIXED_ERROR)}}else w.error("Some of the object is not of type Person or Route Template")}t.addPersonAs(i)};0!=o.length||0!=a.length?(0!=o.length&&b.getAdditionObjectInfo(o).then(function(e){c(e,o,s)},function(e){return console.log("Failed in getting person id"),Promise.reject(e)}),0!=a.length&&b.getAdditionSwymPersonInfo(a).then(function(e){c(e,a,r)},function(e){return console.log("Failed in getting person id"),Promise.reject(e)})):(d.endWait(widget.body),w.error(g.ECM_CA_Drop_Not_Supported))}}else d.endWait(widget.body),w.error(g.ECM_CA_Drop_Not_Supported);document.querySelector("#divForTeamViewContent").setStyle("borderWidth","0px")},buildTeamSetView:function(e){var s=this,d=s;return this.memberSetView=new r({collection:e,detail:{title:g.ECM_CA_Team_Counter_Members},actions:{collection:this.getTopActions(),events:{onActionClick:function(e,t,i){var n=t.model.get("id");switch(n){case"add":s.launchAddMembersView();break;case"filter":s.launchFilterMembersViews();break;default:console.log(n+" is not permitted.")}}}},buildMultiselActions:function(e){var t=[],i=!1;document.querySelector(".teamViewSet-contents").removeClassName("teamview-opaque");var n=b.getCurrentModel();if(UWA.is(n)&&UWA.is(n.get("userAccess"))){var o=n.get("userAccess");o&&(o.RemoveContributor&&"true"===o.RemoveContributor||o.RemoveReviewer&&"true"===o.RemoveReviewer||o.RemoveFollower&&"true"===o.RemoveFollower)&&(i=!0)}var a={id:"delete",text:g.ECM_CA_Team_MultiSelActions_Remove,fonticon:"trash",icon:"I_ChangeCnxObjTrash",multisel:!0,handler:function(e){d.onRemoveSelectedMembers(e)}};return A.getGlobalVariable().isNative&&(a.icon="I_ChangeCnxObjTrash"),i&&t.push(a),t},addMembers:{collection:s.collection,placeholder:g.ECM_CA_Team_AddMembers_PlaceHolder,title:g.ECM_CA_Team_AddMembers_PlaceHolder,categories:[{id:"assignee",name:g.ECM_CA_Team_AddMembers_Assignee,isDefault:"true"},{id:"reviewer",name:g.ECM_CA_Team_AddMembers_Reviewer},{id:"follower",name:g.ECM_CA_Team_AddMembers_Follower}],unlockDistinctClick:!0,getSuggestions:function(e,i,n){var o,a;if(e){a&&a.cancel();var s=this;o={text:e.trim(),onComplete:function(e){console.log("onComplete getSuggestions");var t=s.options.attributes["data-category"];e.forEach(function(e){e.categoryId=t+e.identifier,e.category=t}),n(e)},onFailure:function(){w.error(g.ECM_CA_Team_SearchTeamMembers_Failure,"error")}};var r=s.options.attributes["data-category"],l=d.model.get("people"),c=d.model.get("owner");t.extend(o,{categoryId:r,members:l,contextUser:c}),a=y.getSuggestionsForRoutesAndMembers(o)}},suggestDistinction:function(e){console.log("in suggestDistinction");var t=s.model.get("people").findWhere({userName:e.identifier});if(!t)return!1;var i="";return"Person"===t.get("type")?i=t.get("rolesToDisplay"):"Route Template"===t.get("type")&&(i=t.get("rolesToDisplay")),i},suggestFormat:"{name}",labelFormat:"{name}",suggestKey:"categoryId",typeDelay:1e3,minLength:3,multipleRoles:!0,autocompleteExtension:c,saveProcess:function(e){if(Array.isArray(e)&&e.length>0){var t=!0;e.forEach(function(e){var i=e.item;"reviewer"===i.categoryId&&y.reviewerType.typeOfReviewer!=i.type&&(t=!1)})}if(t)s.onSaveHandler(e,s);else{var i=g.ECM_CA_ROUTE_TEMPLATE;"Person"===y.reviewerType.typeOfReviewer&&(i=g.ECM_CA_PERSON),w.error(i+" "+g.ECM_CA_PERSON_ROUTE_MIXED_ERROR)}},onClose:function(){s.container.getElement(".teamViewSet-addMembers").setStyle("display","none");var e=document.querySelector("#assignee-wrapper"),t=document.querySelector("#reviewer-wrapper"),i=document.querySelector("#follower-wrapper");e&&s.makeMemberSectionDroppable(e,s),t&&s.makeMemberSectionDroppable(t,s),i&&s.makeMemberSectionDroppable(i,s)}},filterMembers:{fromIDCard:!1,collection:s.collection,placeholder:g.ECM_CA_Searchby_NameTitle,events:{memberFilterKeyUp:function(e){s.enteredText=e.target.value;var t={filteringMode:"name",text:s.enteredText};s.filterCollectionAndUpdateUI(t)},memberRoleFilter:function(){var e={filteringMode:"role",text:s.enteredText?s.enteredText:""};s.filterCollectionAndUpdateUI(e)}}},contents:{views:[{id:"tile",title:g.ECM_CA_Team_Switch_TileView,view:n,itemView:l,default:!0},{id:"table",title:g.ECM_CA_Switch_TableView,view:o,itemView:a}],selectionMode:"nullToMany",useInfiniteScroll:!1,usePullToRefresh:!1,emptyView:i.extend({defaultOptions:{icon:"members",title:g.ECM_CA_Team_EmptyView_Title}}),events:{onItemViewClick:function(){var e=document.createElement("input");if(e.setAttribute("data-pid",arguments[1].model.get("id").replace("pid:","")),e.setAttribute("data-type",arguments[1].model.get("type")),E.selectedModelsForDrag[arguments[1].model.get("id")]){!0===E.isCheckSelected?delete E.selectedModelsForDrag[arguments[1].model.get("id")]:e.setAttribute("class","selected"),0===(t=Object.keys(E.selectedModelsForDrag)).length&&!1===E.multiSelOn&&(E.isCheckSelected=!1)}else{if(!1===E.isCheckSelected){var t=Object.keys(E.selectedModelsForDrag);for(var i in t)delete E.selectedModelsForDrag[t[i]];A.getGlobalVariable().arrOid&&A.getGlobalVariable().arrOid.length&&A.getGlobalVariable().arrOid.splice(0,A.getGlobalVariable().arrOid.length)}e.setAttribute("class","selected"),E.selectedModelsForDrag[arguments[1].model.get("id")]=arguments[1].model}var n={};n.id=arguments[1].model.get("id").replace("pid:",""),n.name=arguments[1].model.get("userName"),n.title=arguments[1].model.get("fullName"),n.type=arguments[1].model.get("type"),e.setAttribute("data-selectedItem",JSON.stringify(n)),f.onClickItem.call(e,widget,A.getGlobalVariable())},onItemViewCheck:function(){var e=document.createElement("input");(e.setAttribute("data-pid",arguments[1].model.get("id").replace("pid:","")),e.setAttribute("data-type",arguments[1].model.get("type")),arguments[2].target.checked)?(d.caTagNavigatorProxy.deactivateTaggerProxy(),E.selectedModelsForDrag[arguments[1].model.get("id")]=arguments[1].model,e.setAttribute("class","selected"),E.isCheckSelected=!0):(d.caTagNavigatorProxy.activateTaggerProxy(),E.selectedModelsForDrag[arguments[1].model.get("id")]&&(delete E.selectedModelsForDrag[arguments[1].model.get("id")],0===Object.keys(E.selectedModelsForDrag).length&&!1===E.multiSelOn&&(E.isCheckSelected=!1)));var t={};t.id=arguments[1].model.get("id").replace("pid:",""),t.name=arguments[1].model.get("userName"),t.title=arguments[1].model.get("fullName"),t.type=arguments[1].model.get("type"),e.setAttribute("data-selectedItem",JSON.stringify(t)),f.onClickItem.call(e,widget,A.getGlobalVariable())},onItemViewDrag:function(){if((i=Object.keys(E.selectedModelsForDrag)).length&&E.isCheckSelected){var e=!1,t=arguments[1].model.get("id"),i=Object.keys(E.selectedModelsForDrag);for(var n in i){if(E.selectedModelsForDrag[i[n]].id===t){e=!0;break}}if(e)arguments[1]=E.selectedModelsForDrag;else(o={})[arguments[1].model.get("id")]=arguments[1].model,arguments[1]=o}else{var o;(o={})[arguments[1].model.get("id")]=arguments[1].model,arguments[1]=o}var a={caId:b.getCurrentModel().get("id")};b.onItemViewDragForContents(arguments,a)}},headers:[{property:"fullName",sortable:!0,label:g.ECM_CA_Summary_Table_Label_Name},{property:"rolesToDisplay",sortable:!0,label:g.ECM_CA_Summary_Table_Label_Role},{label:g.ECM_CA_Referential_Table_Label_Action,actions:!0}],itemViewOptions:{templateHelpers:{imgAttrs:function(){var e={"data-1":"data-1","data-2":"data-2",class:"tile-image landscape"};return e["model-title"]=s.model.get("title"),e}},mapping:{title:function(){var e="";return"Person"===this.model.get("type")?e=g.ECM_CA_PERSON:"Route Template"===this.model.get("type")&&(e=g.ECM_CA_ROUTE_TEMPLATE),"<div class='removeMargin'><div class='div-title-teamview'>"+this.model.get("fullName")+"</div><div class='div-type-teamview' style='color:gray;font-size:12px;' >"+e+" </div></div>"},subtitle:function(){s.model.get("owner");var e=this.model.get("userName"),t=e+"_comments",i="";i=null!=s.model.get(t)&&""!=s.model.get(t)?s.model.get(t):"";var n=!1,o=this.model.get("role");o&&!Array.isArray(o)&&(o=o.split(", ")),o&&o.forEach(function(e){"reviewer"!==e&&"contributor"!==e||(n=!0)});t=e+"_approvalStatus";var a="";a=null!=s.model.get(t)&&""!=s.model.get(t)?s.model.get(t):"";var r=g.get("ECM_CA_"+a+"_label");if(!0===n&&""!=a&&""!=i)return"<div class='removeMargin'><div class='signOff'><b>"+g.ECM_CA_TeamView_Reviewer_SignOff+"</b>"+r+"</div><div class='comment' title='"+i+"'>"+i+"</div></div>"},image:function(){var e="";if("Person"===this.model.get("type"))if(1==A.getGlobalVariable().isSwymInstalled){var t=this.model.get("userName");e="<div class='chg-team-profile-picture' style='"+("background-image: url(&quot;"+(A.getGlobalVariable().swymURL+"/api/user/getpicture/login/"+t+"/format/normal")+"&quot;);")+"background-size: cover;'> </div>"}else{var i=this.model.get("fullName"),n=y.getAvatarDetails(i);e="<div class='chg-team-profile-picture chg-team-profile-text' style='"+("background:"+n.avatarColor)+"'>"+n.avatarStr+"</div>"}else if("Route Template"===this.model.get("type")){e="<img src='"+u.getWebappsAssetUrl("ENOChangeActionUX","images/iconRouteTemplate108x144.png")+"' class='chg-team-route-template tile-image landscape' draggable='false'/>"}return e}},actionButtonBinding:function(e){e.container.getElement(".actions-inline-dotted").removeClassName("hidden"),e.container.getElement(".actions-inline-dotted").addEvent("click",function(t){e.dispatchEvent("onActionClickDotted",e)})},contextualActions:function(){var e=[],t=this,i={id:t.get("id"),name:t.get("userName"),type:t.get("type")},n=[],o=null,a=null,s=null;n.push(i);var r=!1;UWA.is(d.model)&&UWA.is(d.model.get("userAccess"))&&((l=d.model.get("userAccess"))&&(l.AddContributor&&"true"===l.AddContributor||l.AddReviewer&&"true"===l.AddReviewer||l.AddFollower&&"true"===l.AddFollower)&&(r=!0));var l,c=!1;UWA.is(d.model)&&UWA.is(d.model.get("userAccess"))&&((l=d.model.get("userAccess"))&&(l.RemoveContributor&&"true"===l.RemoveContributor||l.RemoveReviewer&&"true"===l.RemoveReviewer||l.RemoveFollower&&"true"===l.RemoveFollower)&&(c=!0));"Person"===i.type?(o={text:g.ECM_CA_Team_AddMembers_Assignee},s={text:g.ECM_CA_Team_AddMembers_Follower},a={text:g.ECM_CA_Team_AddMembers_Reviewer},(r||c)&&(e.push(o),"Route Template"!=y.reviewerType.typeOfReviewer&&e.push(a),e.push(s))):"Route Template"===i.type&&"false"!=A.getGlobalVariable().CHG_OPEN_WITH_COLLAB&&e.push({id:"Details",text:g.ECM_CA_Explore_With_Central,fonticon:"window",icon:"fonticon-window",multisel:!0,handler:function(e){var i=t.get("id").replace("pid:","");if(A.getGlobalVariable().isNative)_.DispatchEventToWin("ExploreInCollabNApproval",i);else{var n="/common/emxTree.jsp?mode=insert&objectId="+i,o=A.getGlobalVariable().getSecurityContext().replace("ctx::",""),a=A.getGlobalVariable().computeUrl("/common/emxFrameworkContextManager.jsp?SecurityContext="+o+"&forwardUrl="+n),s=window.open();s.opener=null,s.location.href=a}}});var p=this.get("role"),u=[];if(p&&(u=p.split(", ")),Array.isArray(u)){var h=u.indexOf("owner");-1===h&&(r||c)&&e.push({text:g.ECM_CA_Team_MultiSelActions_Remove,fonticon:"trash",icon:"I_ChangeCnxObjTrash",handler:function(){var e=t.get("role");e=e.split(", ");var o=[];e.forEach(function(e){e=e.charAt(0).toLowerCase()+e.slice(1),o.push(e)}),i.roles=o,d.removePersonAs(n)}}),(h=u.indexOf("contributor"))>=0&&o?(o.icon="fonticon fonticon-role-delete",o.handler=function(){i.roles="contributor",d.removePersonAs(n)}):o&&(o.icon="fonticon fonticon-role-add",o.handler=function(){i.roles="contributor",d.addPersonAs(n)}),(h=u.indexOf("reviewer"))>=0&&a&&"Route Template"!=y.reviewerType.typeOfReviewer?(a.icon="fonticon fonticon-role-delete",a.handler=function(){i.roles="reviewer",d.removePersonAs(n)}):a&&"Route Template"!=y.reviewerType.typeOfReviewer&&(a.icon="fonticon fonticon-role-add",a.handler=function(){i.roles="reviewer",d.addPersonAs(n)}),(h=u.indexOf("follower"))>=0&&s?(s.icon="fonticon fonticon-role-delete",s.handler=function(){i.roles="follower",d.removePersonAs(n)}):s&&(s.icon="fonticon fonticon-role-add",s.handler=function(){i.roles="follower",d.addPersonAs(n)})}return e},events:{onActionClickDotted:function(e){var t=this,i={objectId:e.model.get("id").replace("pid:",""),objectType:e.model.get("type"),displayName:e.model.get("userName"),displayType:e.model.get("type")},n=[];n.push(i);var o=b.getContentForCompassInteraction(n),a=new C;a.set3DXContent(o);var s=[];UWA.is(a.retrieveCompatibleApps,"function")&&a.retrieveCompatibleApps(function(i){t.dropDown&&(t.dropDown.destroy(),t.dropDown=null),e._updateContextualActions();var n=e.contextualActions,o=e.container.getElement(".actions-inline-dotted .action-icon-wrapper");i.forEach(function(e){s.push({text:e.text,fonticon:e.fonticon,multisel:!1,handler:e.handler})}),s.length>0&&A.getGlobalVariable().isNative?"true"==A.getGlobalVariable().CHG_OPENWITH&&n.push({id:"OpenWith",text:g.ECM_CA_Command_OpenWith_RichClient,fonticon:"export",icon:"fonticon-export",multisel:!1,items:s}):s.length>0&&n.push({id:"OpenWith",text:g.ECM_CA_Command_OpenWith,fonticon:"export",icon:"fonticon-export",multisel:!1,items:s}),0===n.length&&n.push({text:g.ECM_CA_Command_NO_Action});var a={items:n,target:o,className:"CA_ConnectedObj_DropDown"};t.dropDown=new h(a),t.dropDown&&t.dropDown.show()})}}}}})},getTopActions:function(e){var t=[{id:"filter",title:g.ECM_CA_Team_Actions_FilterMembers,icon:"filter",overflow:!1}],i={id:"add",title:g.ECM_CA_Team_Actions_AddMembers,icon:"plus",overflow:!1},n=!1,o=null,a=b.getCurrentModel();return UWA.is(a)&&UWA.is(a.get("userAccess"))?o=a.get("userAccess"):e&&(o=e),o&&(o.AddContributor&&"true"===o.AddContributor||o.AddReviewer&&"true"===o.AddReviewer||o.AddFollower&&"true"===o.AddFollower)&&(n=!0),n&&t.unshift(i),new s(t)},launchAddMembersView:function(){var e,t,i=this.container.getElement(".teamViewSet-addMembers");"none"===i.getStyle("display")?(i.setStyle("display","block"),document.querySelector(".teamViewSet-contents").addClassName("teamview-opaque"),(e=i.getElement(".paneladdmember-item-view-container"))&&e.addClassName("expanded"),i.getElement("tr:not(.hidden) input").focus(),this.container.getElement(".teamViewSet-filterMembers").setStyle("display","none"),(t=this.container.getElement(".set-container .set-contents"))&&t.setStyle("height","calc( 100% - 275px)")):(i.setStyle("display","none"),(e=i.getElement(".paneladdmember-item-view-container"))&&e.removeClassName("expanded"),document.querySelector(".teamViewSet-contents").removeClassName("teamview-opaque"),(t=this.container.getElement(".set-container .set-contents"))&&t.setStyle("height","calc( 100% - 50px)"))},onSaveHandler:function(e,t){var i=[];e.forEach(function(e){var t="";"assignee"===e.categoryId&&(t="contributor"),"reviewer"===e.categoryId&&(t="reviewer"),"follower"===e.categoryId&&(t="follower");var n={};n.id=e.item.id,n.name=e.item.identifier,n.roles=t,n.fullName=e.item.name,n.type=e.item.type,i.push(n)}),t.addPersonAs(i)},launchFilterMembersViews:function(){var e,t=this.container.getElement(".teamViewSet-filterMembers"),i=this.container.getElement(".teamfilter-role-filter");"none"===t.getStyle("display")?(t.setStyle("display","block"),i.addClassName("highlighted-border"),i.getElement("tr:not(.hidden) input").focus(),this.container.getElement(".teamViewSet-addMembers").setStyle("display","none"),(e=this.container.getElement(".set-container .set-contents"))&&e.setStyle("height","calc( 100% - 200px)")):(t.setStyle("display","none"),(e=this.container.getElement(".set-container .set-contents"))&&e.setStyle("height","calc( 100% - 50px)"));document.querySelector(".teamViewSet-contents").removeClassName("teamview-opaque")},filterCollectionAndUpdateUI:function(e){var t=[],i=e.text;!0!==this.isForbiddenChar(i)&&(t=this.filterMembersCollection(i),t=this.filterByRoles(t),E.teamSetView.collection.reset(),E.teamSetView.collection.push(t))},isForbiddenChar:function(e){for(var t=!1,i='"#$@%*,?\\<>[]|:/',n=0;n<i.length;n++){var o=i[n];if(-1!=e.indexOf(o)){t=!0;break}}return!0===t&&(i=i.split("").join(" "),w.error(g.ECM_CA_Team_SearchTeamMembers_ForbiddenChars+i)),t},filterMembersCollection:function(e){var t=E.originalCollection,i=new UWA.Class.Collection(t.toArray());return d.endWait(widget.body),i.filter(function(t){var i=!1,n=t.get("fullName"),o=e;if(n&&o&&o.length&&(n=n.toLowerCase(),o=o.toLowerCase(),i=n.indexOf(o)>=0),void 0!==o&&0!==o.length||(i=!0),1==i)return t})},filterByRoles:function(e){var t=new UWA.Class.Collection(e);return new UWA.Class.Collection(t.toArray()).filter(function(e){var t=!1,i=e.get("role").split(", "),n=document.getElementById("assigneeToggle"),o=!1;n&&n.checked&&(o=!0);var a=document.getElementById("revMemToggle"),s=!1;a&&a.checked&&(s=!0);var r=document.getElementById("followMemToggle"),l=!1;switch(r&&r.checked&&(l=!0),0==o&&0==s&&0==l&&(t=!0),!0){case o||s||l:i.forEach(function(e){("contributor"==e&&o||"reviewer"==e&&s||"follower"==e&&l)&&(t=!0)})}if(1==t)return e})},getPeopleJSON:function(e,t){var i=[];return Array.isArray(t)?t.forEach(function(t){i.push({name:e,role:t})}):i.push({name:e,role:t}),i},createRemovePeopleJSON:function(e,t){return JSON.stringify({version:"v0",changeaction:{delete:{people:e,routeTemplates:t}}})},jsonPeople:function(e,t,i){Array.isArray(t)?t.forEach(function(t){i.push({name:e[1],role:t})}):i.push({name:e[1],role:t})},addPersonAs:function(e){d.doWait(widget.body);var t,i=[],n=[],o=this;e.forEach(function(e){var a=e.id,s=e.name,r=e.type;t=e.roles;var l=[];l.push(a),l.push(s),"Person"===r?(l.push("Person"),l.push("Person"),o.jsonPeople(l,t,i)):"Route Template"===r&&n.push("pid:"+a)});var a=JSON.stringify({version:"v0",changeaction:{add:{routeTemplates:n,people:i}}}),s=o.model.get("id");y.addPersonToCA(a,s,function(t){var i=t.changeaction.people,n=t.changeaction.routeTemplates;Array.isArray(n)&&n.length>0?(y.reviewerType.typeOfReviewer="Route Template",n.forEach(function(e){i.push({name:e.name,role:"reviewer",type:"Route Template"})})):y.reviewerType.typeOfReviewer="Person";S.rearrangeMembersByRole(E.originalCollection,i,e);var a=o.model.get("owner");e.forEach(function(e){if(a===e.name){var t=[],i=o.model.get("contextUserRole");i=i.split(", ");var n=e.roles,s=n.charAt(0).toUpperCase()+n.slice(1);s=g.get("ECM_CA_Summary_"+s),i.forEach(function(e){t.push(e)}),-1===t.indexOf(s.trim())&&t.push(s);var r="";t.length&&(r=t.join(", ")),o.model.set("contextUserRole",r)}});var s=o.model.get("people");s.reset(),s.push(E.originalCollection.toArray()),E.teamSetView.collection.reset(),E.teamSetView.collection.push(E.originalCollection.toArray());o.caTagNavigatorProxy._setSubjectTags(E.originalCollection,"Team");var r={id:t.changeaction.id,allpersons:y.getFormatedMemberDetails(E.teamSetView.collection._models),addedPersons:e};v.publish("ca-IDCard-on-change-add-person",r);var l=document.querySelector(".teamViewSet-contents");l&&o.makeDroppable(l,o);var c=document.querySelector("#assignee-wrapper"),p=document.querySelector("#reviewer-wrapper"),u=document.querySelector("#follower-wrapper");c&&o.makeMemberSectionDroppable(c,o),p&&o.makeMemberSectionDroppable(p,o),u&&o.makeMemberSectionDroppable(u,o),d.endWait(widget.body)},function(e,t){t&&w.error(t.errorMessage),d.endWait(widget.body)})},onRemoveSelectedMembers:function(e){var t=[];e.forEach(function(e){var i=e.get("role");i.indexOf("Assignee")>=0&&(i=i.replace("Assignee","contributor"));var n=i.split(", "),o=[];n.forEach(function(e){e=e.charAt(0).toLowerCase()+e.slice(1),o.push(e)});var a={};a.id=e.get("id"),a.name=e.get("userName"),a.type=e.get("type"),a.roles=o,-1===n.indexOf("owner")?t.push(a):w.warn(g.ECM_CA_TeamView_Owner_Remove_Forbidden)}),t.length&&this.removePersonAs(t)},removePersonAs:function(e){d.doWait(widget.body);var t=this,i=[],n=[];e.forEach(function(e){if("Person"===e.type){e.id.substr(4);var o=e.name,a=e.roles,s=t.getPeopleJSON(o,a);i=i.concat(s)}else"Route Template"===e.type&&n.push(e.id)});var o=t.createRemovePeopleJSON(i,n),a=t.model.get("id");y.removePersonFromCA(o,a,function(i){var n=i.changeaction.people;S.rearrangeMembersByRole(E.originalCollection,n,e);var o=t.model.get("owner");e.forEach(function(e){var i=e.roles;if(o===e.name){var n=[],a=t.model.get("contextUserRole");if(a=a.split(", "),Array.isArray(i))i.forEach(function(e){var t=e.charAt(0).toUpperCase()+e.slice(1);t=g.get("ECM_CA_Summary_"+t),a.forEach(function(e){e!=t&&n.push(e)})});else{var s=i.charAt(0).toUpperCase()+i.slice(1);s=g.get("ECM_CA_Summary_"+s),a.forEach(function(e){e!=s&&(0===n.length?n.push(e):(e=" "+e,n.push(e)))})}t.model.set("contextUserRole",n.toString())}});var a,s=!1;(a=E.originalCollection)&&a.forEach(function(e){var t=e.get("role"),i=[];t.length&&(i=t.split(", ")),i.indexOf("reviewer")>=0&&(y.reviewerType.typeOfReviewer=e.get("type"),s=!0)}),s||(y.reviewerType={typeOfReviewer:"",labelSelected:!1}),(a=t.model.get("people")).reset(),a.push(E.originalCollection.toArray()),E.teamSetView.collection.reset(),E.teamSetView.collection.push(E.originalCollection.toArray());t.caTagNavigatorProxy._setSubjectTags(E.originalCollection,"Team"),t.caTagNavigatorProxy.activateTaggerProxy();var r={id:i.changeaction.id,allpersons:y.getFormatedMemberDetails(E.teamSetView.collection._models),removedPersons:e};v.publish("ca-IDCard-on-change-remove-person",r),d.endWait(widget.body)},function(e,t){d.endWait(widget.body),w.error(t.errorMessage)})},filterTaggerChange:function(e){var t=E.teamSetView.collection,i=[];for(var n in e){var o=e[n],a=E.originalCollection.toArray(),s=E.originalCollection.findWhere({id:o});s&&i.push(s)}if(t.length!=E.originalCollection.length){t.reset();a=E.originalCollection.toArray();t.add(a)}var r=t.without(i);t.remove(r)},refreshUIOnCommentChange:function(){var e=new UWA.Class.Collection(arguments[0].get("people").toArray()),t=E.teamSetView.collection;t.reset(),t.add(e.toArray())},updateHeaderOnAccessUpdate:function(){E.teamSetView.actionsView.collection.reset(),E.teamSetView.actionsView.collection.push(this.getTopActions(arguments[1]).toArray()),E.teamSetView.actionsView.show()}});return E}),define("DS/ENOChangeActionUX/scripts/Views/CATeamDataGridView",["UWA/Class/View","DS/DataGridView/DataGridView","DS/CollectionView/ResponsiveTilesCollectionView","DS/CollectionView/CollectionViewStatusBar","DS/ENOChangeActionUX/scripts/Views/CAMemberFilterLayout","DS/ENOChangeActionUX/scripts/Services/CATeamDataGridViewServices","DS/ENOChangeActionUX/scripts/Services/CATeamDataGridViewToolbar","DS/ENOChgServices/scripts/services/ChgInfraService","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e,t,i,n,o,a,s,r,l){"use strict";return e.extend({init:function(e){var o=this;o.options=e;var c=o.processColumns(),d={treeDocument:o.options.treeDocument,columns:c,cellSelection:"none",rowSelection:"multiple",cellDragEnabledFlag:!0,placeholder:l.ECM_CA_Context_Drop_Here,identifier:"width",defaultColumnDef:{width:"auto",resizableFlag:!0,sortableFlag:!0},onContextualEvent:function(e){var t=[];if(e&&e.collectionView&&e.cellInfos){if(e.cellInfos.rowID>-1)return a.showRMBMenuOnGrid(o,e).then(function(e){return e});e.collectionView.columns.length,e.cellInfos.columnID;t=e.collectionView.buildDefaultContextualMenu(e,{pin:!0,firstColumnsVisibility:!0,columnsManagement:!0,sizeColumnToFit:!1})}return t},onDragStartRowHeader:function(e,t){return r.readyDragContent(e,t),!0},onDragStartCell:function(e,t){return console.log(e),r.readyDragContent(e,t),!0}};d=UWA.merge(d,o.options);var p={model:o.options.treeDocument,height:"inherit",allowUnsafeHTMLContent:!0,displayedOptionalCellProperties:["contextualMenu","description","propertiesList","activeFlag"],useDragAndDrop:!0,onDragStartCell:function(e,t){r.readyDragContent(e,t)},onDragEnterBlankDefault:function(e){},onDragEnterBlank:function(e){}};o.dataGrid=new t(d),o.tileView=new i(p);var u={callback:function(e){if(e&&e.cellInfos&&e.cellInfos.cellModel)return a.showRMBMenuOnGrid(o,e).then(function(e){return e})}};o.tileView.onContextualEvent=u,s.toolbar=o.dataGrid.setToolbar(s.writetoolbarDefination()),o.toolbar=s.toolbar,0!=e.buildStatusBar&&(o.dataGrid.buildStatusBar([{type:n.STATUS.NB_ITEMS},{type:n.STATUS.NB_SELECTED_ROWS}]),o.tileView.buildStatusBar([{type:n.STATUS.NB_ITEMS},{type:n.STATUS.NB_SELECTED_ROWS}]))},render:function(){this.teamViewDiv=UWA.createElement("div",{id:"outer-team-div",styles:{width:"100%",height:"100%",display:"inline-block"},class:"outer-team-div"}),this.toolbarDiv=UWA.createElement("div",{styles:{width:"100%"},class:"toolbar-team-div"}),this.addMemberDiv=UWA.createElement("div",{styles:{width:"100%",position:"relative"},class:"add-member-team-div addmemberView hideView"}),this.filterMemberDiv=UWA.createElement("div",{styles:{position:"relative"},class:"filter-member-team-div filtermemberView hideView"}),this.gridViewDiv=UWA.createElement("div",{styles:{width:"100%",height:"calc(100% - 40px)",position:"relative"},class:"grid-team-div teamgridView hideView"}),this.tileViewDiv=UWA.createElement("div",{styles:{width:"100%",height:"calc(100% - 40px)",position:"relative"},class:"tile-team-div teamtileView showView"}),this.emptyTileViewDiv=UWA.createElement("div",{class:"hideView",id:"teamEmptyTileViewDiv"}),UWA.createElement("div",{html:l.ECM_CA_Context_Drop_Here,styles:{"align-self":"center"}}).inject(this.emptyTileViewDiv);var e={target:this.filterMemberDiv,model:this.options.treeDocument};return o.createMemberFilter(e),this.dataGrid.inject(this.gridViewDiv),this.tileView.inject(this.tileViewDiv),this.toolbar.inject(this.toolbarDiv),this.emptyTileViewDiv.inject(this.tileViewDiv),this.teamViewDiv.addContent(this.toolbarDiv),this.teamViewDiv.addContent(this.filterMemberDiv),this.teamViewDiv.addContent(this.addMemberDiv),this.teamViewDiv.addContent(this.gridViewDiv),this.teamViewDiv.addContent(this.tileViewDiv),this.teamViewDiv},processColumns:function(){return this.options.column}})}),define("DS/ENOChangeActionUX/scripts/Views/CATeamDataGridLayout",["DS/UIKIT/Mask","DS/ENOChangeActionUX/scripts/CAMakeDroppable","DS/ENOChangeActionUX/scripts/Views/CATeamDataGridView","DS/ENOChangeActionUX/scripts/Models/CATeamDataGridViewModel","DS/ENOChangeActionUX/scripts/Services/CATeamDataGridViewServices","DS/ENOChangeActionUX/scripts/Views/CATeamTileViewLayout","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgMembersServices","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgIDCardHeaderServices","DS/PlatformAPI/PlatformAPI","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button","DS/WUXAutoComplete/AutoComplete","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/ENOChangeActionUX/scripts/CASpinner","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENOChgServices/scripts/services/ChgDataProcess","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v,A,w,b){"use strict";var S={create:function(e){var s={};(s=UWA.merge(s,e)).hasOwnProperty("columns")||(s.columns=o.getColumns()),this.teamlayoutModel=s.treeDocument=(new n).createTreeDocument();var r=new i(s);this.teamView=r,this.target=s.target,r.render().inject(this.target),this.physicalId=s.caPhysicalId,d.unsubscribe("ca-user-access-updated"),d.unsubscribe("ca-IDCard-on-change-refresh"),d.subscribe("ca-user-access-updated",function(e){S.userAccess=e,S.updateToolBar(S.userAccess)}),d.subscribe("ca-IDCard-on-change-refresh",function(e){S.teamlayoutModel.empty(),S.refreshGrid()}),this.refreshGrid(),S.teamlayoutModel.getXSO().onPostAdd(function(){S.teamlayoutModel.getXSO().get().length>0&&S.userAccess&&"true"==S.userAccess.RemoveFollower&&(console.log("Unable Remove Button"),S.enableCommand("removeMember"))}),S.teamlayoutModel.getXSO().onPostRemove(function(){0==S.teamlayoutModel.getXSO().get().length&&(console.log("Disable Remove Button"),S.disableCommand("removeMember"))}),t.makeDroppable(this.target,S.executeMemberViewDrop),l.getUserAccess(S.physicalId).then(function(e){S.userAccess=e.userAccess,S.updateToolBar(S.userAccess),a.changeView(),S.disableCommand("removeMember"),document.querySelector(".toolbar-team-div .wux-tweakers-string-label").setStyles({color:"#777",fontWeight:"bold",fontSize:"20px"})})},refreshGrid:function(){o.getCAPeopleForGridView(S.physicalId).then(function(e){var t=e.peopleInfo;c.getCompletedTaskDetails(S.physicalId).then(function(e){e&&UWA.is(e.completedTaskDetail)?(t=S.addApprovalInfoToPerson(t,e.completedTaskDetail),S.loadDataInGrid(t)):S.loadDataInGrid(t)})})},addApprovalInfoToPerson:function(e,t){for(var i=t.inboxTasks,n=0;n<i.length;n++)for(var o=i[n].owner,a=0;a<e.length;a++)if(o==e[a].name){e[a].approvalStatus=i[n].approvalStatus,e[a].comments=i[n].comments;break}return e},loadDataInGrid:function(e){(new n).loadData(S.teamlayoutModel,e),r.reviewerType.typeOfReviewer="";for(var t=0;t<e.length;t++){var i=e[t];i.role.includes("reviewer")&&(r.reviewerType.typeOfReviewer=i.type)}C.endWait(widget.body)},updatePersonRole:function(e,t){if(console.log("updatePersonRole"),0==S.teamlayoutModel.getSelectedNodes().length);else{var i=S.teamlayoutModel.getSelectedNodes()[0].options.grid.name,n=t.role,o=Array.isArray(n)?t[n[0]]:t[n],a=[],s=[];"Route Template"==t.currentObjType&&a.push(S.teamlayoutModel.getSelectedNodes()[0].options.grid.id),"Person"==t.currentObjType&&(s=S.makeJsonWithRole(i,n)),"delete"==o&&1==t.showConfirmation?S.showConfirmationDialog(o,s,a):S.updateCAPeople(o,s,a)}},showConfirmationDialog:function(e,t,i){var n=new p({});new u({immersiveFrame:n,title:b.ECM_CA_Team_Remove_Title,content:b.ECM_CA_Team_Remove_Message,activeFlag:!1,modelFlag:!0,width:500,buttons:{No:new h({onClick:function(e){n.destroy()}}),Yes:new h({onClick:function(o){n.destroy(),S.updateCAPeople(e,t,i)}})}}).addEventListener("close",function(e){n&&n.destroy()});var o=document.getElementById("outer-team-div");n.inject(o)},updateCAPeople:function(e,t,i){var n=S.createAddDeletePeopleJSON(e,t,i);r.addPersonToCA(n,S.physicalId,function(e){o.processPeoples(e).then(function(e){var t=e.peopleInfo;S.teamlayoutModel.empty(),S.loadDataInGrid(t)})},function(e,t){})},createAddDeletePeopleJSON:function(e,t,i){return JSON.stringify({version:"v0",changeaction:{adddelete:{people:t,routeTemplates:i}}}).replace("adddelete",e)},makeJsonWithRole:function(e,t){var i=[];return Array.isArray(t)?t.forEach(function(t){i.push({name:e,role:t})}):i.push({name:e,role:t}),i},removeMember:function(){if(0==S.teamlayoutModel.getSelectedNodes().length);else{for(var e=[],t=[],i=S.teamlayoutModel.getSelectedNodes(),n=0;n<i.length;n++){var a=i[n],s=a.options.grid.type;if("Person"==s){var l=a.options.grid.name,c=a.options.grid.role;if(c.indexOf("owner")>=0)A.warn(b.ECM_CA_TeamView_Owner_Remove_Forbidden);else{var d=[];c.indexOf("contributor")>=0&&d.push("contributor"),c.indexOf("reviewer")>=0&&d.push("reviewer"),c.indexOf("follower")>=0&&d.push("follower");var p=S.makeJsonWithRole(l,d);t=t.concat(p)}}else"Route Template"==s&&e.push(a.options.grid.id)}var u=S.createAddDeletePeopleJSON("delete",t,e);r.addPersonToCA(u,S.physicalId,function(e){o.processPeoples(e).then(function(e){var t=e.peopleInfo;S.teamlayoutModel.empty(),S.loadDataInGrid(t)})},function(e,t){})}},addMember:function(e,t){var i=S.createAddDeletePeopleJSON("add",e,t);C.doWait(widget.body);r.addPersonToCA(i,S.physicalId,function(e){o.processPeoples(e).then(function(e){var t=e.peopleInfo;S.teamlayoutModel.empty(),S.loadDataInGrid(t)})},function(e,t){})},launchAddMemberPanel:function(){var e=document.querySelector(".addmemberView"),i=document.querySelector(".filtermemberView"),n=document.querySelector(".teamgridView"),o=document.querySelector(".teamtileView"),a=document.querySelector(".toolbar-team-div .wux-ui-3ds-plus");if(n.style.height="calc(100% - 40px)",o.style.height="calc(100% - 40px)",i.hide(),e.empty(),"block"==e.style.display)return e.hide(),n.removeClassName("teamview-opaque"),o.removeClassName("teamview-opaque"),void a.removeClassName("currentView");e.show(),n.addClassName("teamview-opaque"),o.addClassName("teamview-opaque"),a.addClassName("currentView"),S.modelForAssignee=new g,S.modelForReviwer=new g,S.modelForFollower=new g,S.modelForAssignee.getFilterManager().registerFilter("identifierNameFilter",w.identifierNameFilter),S.modelForReviwer.getFilterManager().registerFilter("identifierNameFilter",w.identifierNameFilter),S.modelForFollower.getFilterManager().registerFilter("identifierNameFilter",w.identifierNameFilter),S.updateAutocompleteModel({reviewer:!0,assignee:!0}),S.autoCompleteFollower=new m({elementsTree:S.modelForFollower,placeholder:b.ECM_CA_Team_AddMembers_PlaceHolder,customFilterMessage:b.ECM_CA_Team_Auto_No_Seach_found,filterCB:function(e){S.modelForFollower.setFilterModel({value:{filterId:"identifierNameFilter",filterModel:{text:e}}})}}),S.autoCompleteAssignee=new m({elementsTree:S.modelForAssignee,placeholder:b.ECM_CA_Team_AddMembers_PlaceHolder,customFilterMessage:b.ECM_CA_Team_Auto_No_Seach_found,filterCB:function(e){S.modelForAssignee.setFilterModel({value:{filterId:"identifierNameFilter",filterModel:{text:e}}})}}),S.autoCompleteReviwer=new m({elementsTree:S.modelForReviwer,placeholder:b.ECM_CA_Team_AddMembersRouteTemplate_PlaceHolder,customFilterMessage:b.ECM_CA_Team_Auto_No_Seach_found,filterCB:function(e){var t;S.modelForReviwer.setFilterModel({value:{filterId:"identifierNameFilter",filterModel:{text:e}}}),t=this.selectedItems||[],S.filterOutAutocompleteModel(0===t.length?"Both":t[0].options.type)}});var c=UWA.createElement("div",{class:"add-member-container",styles:{width:"100%"}}).inject(e),d=UWA.createElement("div",{class:"add-member-body-container"}).inject(c),p=UWA.createElement("div",{class:"add-member-button-container"}).inject(c),u=UWA.createElement("table",{class:"add-member-table"}).inject(d),f=UWA.createElement("tr",{class:"add-member-table-row"}).inject(u);UWA.createElement("td",{content:"<span>"+b.ECM_CA_Team_AddMembers_Assignee+"</span>",class:"add-member-table-col"}).inject(f);var C=UWA.createElement("td",{class:"assignee-field add-member-table-col"}).inject(f);S.autoCompleteAssignee.inject(C);UWA.createElement("span",{class:"fonticon fonticon-search  assignee-field-search",events:{click:function(e){if(S.searchCategotyId="assignee",s.getGlobalVariable().isNative){var t={categoryId:S.searchCategotyId,reviewerType:r.reviewerType.typeOfReviewer},i=JSON.stringify(t);v.DispatchEventToWin("Add_Member",i)}else{var n=l.activateSearch("Person","Contributors");l.search(b.ECM_CA_Team_Contributors,"Person",S.OnSearchComplete,"Contributors",n,void 0,S.searchCategotyId)}}}}).inject(C);var A=UWA.createElement("tr",{class:"add-member-table-row"}).inject(u);UWA.createElement("td",{content:"<span>"+b.ECM_CA_Team_AddMembers_Reviewer+"</span>",class:"add-member-table-col"}).inject(A);var y=UWA.createElement("td",{class:"reviewer-field add-member-table-col"}).inject(A);S.autoCompleteReviwer.inject(y);UWA.createElement("span",{class:"fonticon fonticon-search  reviewer-field-search",events:{click:function(e){if(S.searchCategotyId="reviewer",s.getGlobalVariable().isNative){var t={categoryId:S.searchCategotyId,reviewerType:r.reviewerType.typeOfReviewer},i=JSON.stringify(t);v.DispatchEventToWin("Add_Member",i)}else{var n=l.activateSearch("Person","Contributors");l.search(b.ECM_CA_Team_Reviewers,"Person",S.OnSearchComplete,"Contributors",n,void 0,S.searchCategotyId)}}}}).inject(y);var _=UWA.createElement("tr",{class:"add-member-table-row"}).inject(u);UWA.createElement("td",{content:"<span>"+b.ECM_CA_Team_AddMembers_Follower+"</span>",class:"add-member-table-col"}).inject(_);var E=UWA.createElement("td",{class:"follower-field add-member-table-col"}).inject(_);S.autoCompleteFollower.inject(E);UWA.createElement("span",{class:"fonticon fonticon-search  follower-field-search",events:{click:function(e){if(S.searchCategotyId="follower",s.getGlobalVariable().isNative){var t={categoryId:S.searchCategotyId,reviewerType:r.reviewerType.typeOfReviewer},i=JSON.stringify(t);v.DispatchEventToWin("Add_Member",i)}else{var n=l.activateSearch("Person","Contributors");l.search(b.ECM_CA_Team_Followers,"Person",S.OnSearchComplete,"Contributors",n,void 0,S.searchCategotyId)}}}}).inject(E);S.addChangeEventListerner(),t.makeDroppable(C,S.ExecuteDropForAssigneeField),t.makeDroppable(E,S.ExecuteDropForFollowerField),1==S.isRouteTempleteAttached?A.addClassName("teamview-opaque"):t.makeDroppable(y,S.ExecuteDropForReviewerField),S.myButtonPrimary=new h({label:b.ECM_CA_Button_Label_Add,emphasize:"primary",disabled:"true"}).inject(p);var D=new h({label:b.ECM_CA_Cancel,emphasize:"secondary"}).inject(p);S.myButtonPrimary.addEventListener("buttonclick",function(t){e.empty();var i=[],s=[];if(null!=S.autoCompleteAssignee.selectedItems)for(var r=0;r<S.autoCompleteAssignee.selectedItems.length;r++)i.push({name:S.autoCompleteAssignee.selectedItems[r].options.identifier,role:"contributor"});if(null!=S.autoCompleteReviwer.selectedItems)for(r=0;r<S.autoCompleteReviwer.selectedItems.length;r++)"Person"==S.autoCompleteReviwer.selectedItems[r].options.type?i.push({name:S.autoCompleteReviwer.selectedItems[r].options.identifier,role:"reviewer"}):s.push("pid:"+S.autoCompleteReviwer.selectedItems[r].options.id);if(null!=S.autoCompleteFollower.selectedItems)for(r=0;r<S.autoCompleteFollower.selectedItems.length;r++)i.push({name:S.autoCompleteFollower.selectedItems[r].options.identifier,role:"follower"});S.addMember(i,s),e.hide(),a.removeClassName("currentView"),n.removeClassName("teamview-opaque"),o.removeClassName("teamview-opaque")}),D.addEventListener("buttonclick",function(t){e.empty(),e.hide(),a.removeClassName("currentView"),n.removeClassName("teamview-opaque"),o.removeClassName("teamview-opaque")})},filterOutAutocompleteModel:function(e,t){var i=[],n=null!=t?t:"";"Both"==e?(i.push("Route Template"),i.push("Person")):i.push(e),S.autoCompleteReviwer._model.setFilterModel({name:{filterId:"stringRegexp",filterModel:{condition1:{type:"contains",filter:n}}},type:{filterId:"set",filterModel:i}})},updateAutocompleteModel:function(e){S.isRouteTempleteAttached=!1;for(var t={},i=S.teamlayoutModel.getChildren(),n=0;n<i.length;n++){var o=i[n].options.grid;t[o.name]=o.roleNLS,"Route Template"==o.type&&(S.isRouteTempleteAttached=!0)}var a={categoryId:"assignee",contextUser:s.getGlobalVariable().contextUser},l={categoryId:"reviewer",contextUser:s.getGlobalVariable().contextUser};1==e.reviewer&&0==S.isRouteTempleteAttached&&r.getListMember(l).then(function(e){S.modelForReviwer.empty(),S.modelForReviwer.prepareUpdate();for(var i=0;i<e.length;i++){var n=e[i].identifier;if(e[i].label=e[i].name,!t.hasOwnProperty(n)||(e[i].label=e[i].label+" ("+t[n]+")",1!=t[n].contains("Approver"))){var o=new f({label:e[i].label,value:e[i].value,name:e[i].name,identifier:e[i].identifier,type:e[i].type,grid:{type:e[i].type,name:e[i].name},id:e[i].id});S.modelForReviwer.addRoot(o)}}S.modelForReviwer.pushUpdate()}),1==e.assignee&&r.getListMember(a).then(function(e){S.modelForAssignee.empty(),S.modelForFollower.empty(),S.modelForAssignee.prepareUpdate(),S.modelForFollower.prepareUpdate();for(var i=0;i<e.length;i++){var n=e[i].identifier;if(e[i].label=e[i].name,!t.hasOwnProperty(n)||(e[i].label=e[i].label+" ("+t[n]+")",1!=t[n].contains("Assignee"))){var o=new f({label:e[i].label,value:e[i].value,name:e[i].name,identifier:e[i].identifier,type:e[i].type,id:e[i].id});S.modelForAssignee.addRoot(o)}}for(i=0;i<e.length;i++){n=e[i].identifier;if(e[i].label=e[i].name,!t.hasOwnProperty(n)||(e[i].label=e[i].label+" ("+t[n]+")",1!=t[n].contains("Informed User"))){var a=new f({label:e[i].label,value:e[i].value,name:e[i].name,identifier:e[i].identifier,type:e[i].type,id:e[i].id});S.modelForFollower.addRoot(a)}}S.modelForAssignee.pushUpdate(),S.modelForFollower.pushUpdate()})},addChangeEventListerner:function(){S.autoCompleteReviwer.addEventListener("change",function(){var e=S.autoCompleteReviwer.selectedItems,t=e.length;if(0===t&&(S.myButtonPrimary.disabled=!0),t>0){S.myButtonPrimary.disabled=!1;var i=e[t-1];S.autoCompleteReviwer.elementsTree.getChildren().findIndex(function(e){if(e.options.name==i.options.name)return!0})<0&&(S.autoCompleteReviwer._selectionChips.removeChip(i.options.label),S.autoCompleteReviwer.selectedItems.pop(),S.autoCompleteReviwer.value.pop())}if(1==t)if("Route Template"==i.options.type){var n=i.options.grid.name;S.filterOutAutocompleteModel("Route Template",n),S.autoCompleteReviwer._hidePopup()}else"Person"==i.options.type&&S.filterOutAutocompleteModel("Person");else 0==t&&(S.filterOutAutocompleteModel("Both"),S.autoCompleteReviwer.elements.popup&&1==S.autoCompleteReviwer.elements.popup.visibleFlag&&(S.autoCompleteReviwer._hidePopup(),S.autoCompleteReviwer._showPopup()))}),S.autoCompleteFollower.addEventListener("change",function(){var e=S.autoCompleteFollower.selectedItems,t=e.length;if(0===t&&(S.myButtonPrimary.disabled=!0),t>0){S.myButtonPrimary.disabled=!1;var i=e[t-1];S.autoCompleteFollower.elementsTree.getChildren().findIndex(function(e){if(e.options.name==i.options.name)return!0})<0&&(S.autoCompleteFollower._selectionChips.removeChip(i.options.label),S.autoCompleteFollower.selectedItems.pop(),S.autoCompleteFollower.value.pop())}}),S.autoCompleteAssignee.addEventListener("change",function(){var e=S.autoCompleteAssignee.selectedItems,t=e.length;if(0===t&&(S.myButtonPrimary.disabled=!0),t>0){S.myButtonPrimary.disabled=!1;var i=e[t-1];S.autoCompleteAssignee.elementsTree.getChildren().findIndex(function(e){if(e.options.name==i.options.name)return!0})<0&&(S.autoCompleteAssignee._selectionChips.removeChip(i.options.label),S.autoCompleteAssignee.selectedItems.pop(),S.autoCompleteAssignee.value.pop())}})},OnSearchComplete:function(e){var t=[];if(s.getGlobalVariable().isNative){for(var i=e.split("~"),n=[],o=0;o<i.length;o++)n.push(i[o]);for(var a=[],r=0;r<i.length;r++)a.push(n[r].split(","));e=a}for(var l=0;l<e.length;l++)t.push({objectId:e[l][0],objectType:e[l][2],displayType:e[l][3],serviceId:e[l][7]});var c={data:{}};c.data.items=t,S.ExecuteDropForMemberAssignmentPanel(c,S.searchCategotyId)},ExecuteDropForAssigneeField:function(e){var t={data:{}};t.data.items=e,S.ExecuteDropForMemberAssignmentPanel(t,"assignee")},ExecuteDropForReviewerField:function(e){var t={data:{}};t.data.items=e,S.ExecuteDropForMemberAssignmentPanel(t,"reviewer")},ExecuteDropForFollowerField:function(e){var t={data:{}};t.data.items=e,S.ExecuteDropForMemberAssignmentPanel(t,"follower")},ExecuteDropForMemberAssignmentPanel:function(e,t){if(e&&e.data&&e.data.items){var i=e.data.items;if(UWA.is(i)&&UWA.is(i.length)&&i.length>0){for(var n=[],o=[],a=[],s=0;s<i.length;s++)i[s].objectId&&(null==i[s].serviceId||"3DSpace"==i[s].serviceId||i[s].serviceId.indexOf("3dspace")>-1?i[s].objectId.indexOf("pid:")>-1?n.push(i[s].objectId.replace("pid:","")):n.push(i[s].objectId):"3DSwym"==i[s].serviceId&&"pno:Person"==i[s].objectType&&(o.push(i[s].objectId.replace("iam:","")),a.push(i[s].displayName)));0!=n.length||0!=o.length?l.getAdditionObjectInfo(n).then(function(e){for(var i=[],a=0;a<n.length;a++){var s=e.additionObjectInfo[n[a]];if(s.type&&"Person"===s.type){if(!1===(c="Route Template"===r.reviewerType.typeOfReviewer)||"reviewer"!=t)i.push(s.pid);else{var l=b.ECM_CA_ROUTE_TEMPLATE;"Person"===r.reviewerType.typeOfReviewer&&(l=b.ECM_CA_PERSON),A.error(l+" "+b.ECM_CA_PERSON_ROUTE_MIXED_ERROR)}}else{if(!s.type||"Route Template"!==s.type)return void A.error(b.ECM_ERR_NO_PERSON_NO_ROUTETEMPLATE);if("reviewer"!=t)return void A.error(b.ECM_ERR_WRONG_CATEGORY);var c=!1;if(S.teamlayoutModel.getChildren().forEach(function(e){e&&e.options.grid.role.indexOf("reviewer")>=0&&(c=!0)}),!1===c)i.push(s.pid);else{l=b.ECM_CA_ROUTE_TEMPLATE;"Person"===r.reviewerType.typeOfReviewer&&(l=b.ECM_CA_PERSON),A.error(l+" "+b.ECM_CA_PERSON_ROUTE_MIXED_ERROR)}}}if(o.length>0&&(i=i.concat(o)),"follower"==t)for(var d=0;d<i.length;d++)try{S.autoCompleteFollower._model.getRoots().find(e=>e.options.id===i[d]).select()}catch(e){S.autoCompleteFollower._model.getRoots().find(e=>e.options.identifier===i[d]).select()}else if("reviewer"==t)for(d=0;d<i.length;d++)try{S.autoCompleteReviwer._model.getRoots().find(e=>e.options.id===i[d]).select()}catch(t){try{S.autoCompleteReviwer._model.getRoots().find(e=>e.options.identifier===i[d]).select()}catch(t){let n=e.additionObjectInfo[i[d]];if("Route Template"==n.type){let e=new f({label:n.objectTitle,name:n.objectName,type:n.type,grid:{type:n.type,name:n.objectName},id:n.pid});S.autoCompleteReviwer._model.addRoot(e),S.autoCompleteReviwer._model.getRoots().find(e=>e.options.id===i[d]).select()}}}else if("assignee"==t)for(d=0;d<i.length;d++)try{S.autoCompleteAssignee._model.getRoots().find(e=>e.options.id===i[d]).select()}catch(e){S.autoCompleteAssignee._model.getRoots().find(e=>e.options.identifier===i[d]).select()}},function(e){return console.log("Failed in getting person id"),Promise.reject(e)}):A.error(b.ECM_CA_Drop_Not_Supported)}}else A.error(b.ECM_CA_Drop_Not_Supported)},executeMemberViewDrop:function(e){for(var t=[],i=[],n=!1,o=0;o<e.length;o++)e[o].objectId&&("3DSpace"==e[o].serviceId?e[o].objectId.indexOf("pid:")>-1?t.push(e[o].objectId.replace("pid:","")):t.push(e[o].objectId):"3DSwym"==e[o].serviceId&&"pno:Person"==e[o].objectType&&i.push(e[o].objectId.replace("iam:","")));0!=t.length||0!=i.length?l.getAdditionObjectInfo(t).then(function(e){for(var o=[],a=[],s=0;s<t.length;s++){var l=e.additionObjectInfo[t[s]];if(l.type&&"Person"===l.type)o.push({name:l.objectName,role:"contributor"});else if(l.type&&"Route Template"===l.type){var c=!1;if(S.teamlayoutModel.getChildren().forEach(function(e){e&&e.options.grid.role.indexOf("reviewer")>=0&&(c=!0)}),!1===c)a.push("pid:"+l.pid);else{var d=b.ECM_CA_ROUTE_TEMPLATE;"Person"===r.reviewerType.typeOfReviewer&&(d=b.ECM_CA_PERSON),A.error(d+" "+b.ECM_CA_PERSON_ROUTE_MIXED_ERROR)}}else n=!0}for(s=0;s<i.length;s++)o.push({name:i[s],role:"contributor"});n&&A.error("Some of the object is not of type Person or Route Template"),S.addMember(o,a)},function(e){return console.log("Failed in getting person id"),Promise.reject(e)}):(C.endWait(widget.body),A.error(b.ECM_CA_Drop_Not_Supported))},updateToolBar:function(e){var t=!0;e&&(t=!e.AddFollower||"false"!==e.AddFollower),1==t?(S.enableCommand("addMember"),S.teamlayoutModel.getXSO().get().length>0&&S.enableCommand("removeMember")):(S.disableCommand("addMember"),S.disableCommand("removeMember"))},enableCommand:function(e){S.teamView.dataGrid.getToolbar().updateNodeModel(e,{disabled:!1})},disableCommand:function(e){S.teamView.dataGrid.getToolbar().updateNodeModel(e,{disabled:!0})},changeView:function(e){o.changeView("GridView")}};return S}),define("DS/ENOChangeActionUX/scripts/Collection/CAReferentialCollection",["UWA/Core","UWA/Class/Collection","DS/ENOChangeActionUX/scripts/Models/CAReferentialModel"],function(e,t,i){"use strict";return t.extend({model:i,setup:function(){},fetch:function(e){var t;return t=e.data=this.referentialsArr=e.referentialsArr,e.ajax=function(e,i){i.onComplete(t)},this.url="dummyURL",this._parent(e)}})}),define("DS/ENOChangeActionUX/scripts/Services/CAReferentialServices",["UWA/Core","DS/ENOChangeActionUX/scripts/Collection/CAReferentialCollection"],function(e,t){"use strict";return{createReferentialCollection:function(e){var i={referentialsArr:e},n=new t;return n.fetch(i),n}}}),define("DS/ENOChangeActionUX/scripts/Models/CADependencyModel",["UWA/Class/Model","DS/ENOChgServices/scripts/services/ChgDependencyServices","DS/ENOChangeActionUX/scripts/Controller/CADependencyGridController","DS/PlatformAPI/PlatformAPI"],function(e,t,i,n){"use strict";return e.extend({defaults:function(){return{id:"",userAccess:null}},setup:function(){var e=this;n.unsubscribe("load-dependency"+widget.id),n.subscribe("load-dependency"+widget.id,function(o){i.caDependencyModel&&i.caDependencyModel.set("caId",o),e.fetch(o).then(function(){t.changeActionDependenciesLoaded=!0,t.changeActionDependencyModel=e;var i=o.substring(4);n.publish("dependency:data:ready"+widget.id,i),n.publish("dependency:update:UX"+widget.id);var a={Physicalid:o};n.publish("dependency:update:View"+widget.id,a)})}),n.unsubscribe("ca-IDCard-on-change-maturity"),n.subscribe("ca-IDCard-on-change-maturity",function(e){t.changeActionDependencyModel&&t.changeActionDependencyModel.updateDependUserAccess(e.id)}),n.unsubscribe("ca-IDCard-on-change-transfer-responsibility"),n.subscribe("ca-IDCard-on-change-transfer-responsibility",function(e){t.changeActionDependencyModel&&t.changeActionDependencyModel.updateDependUserAccess(e.id)}),n.unsubscribe("ca-IDCard-on-change-holdValue"),n.subscribe("ca-IDCard-on-change-holdValue",function(e){t.changeActionDependencyModel&&t.changeActionDependencyModel.updateDependUserAccess(e.id)})},fetch:function(e){var n=this;return new Promise(function(o,a){var s=t.getDependUserAccess(e),r=t.getCADependencies(e),l=[];l.push(s),l.push(r),Promise.all(l).then(function(e){var a=e[0];n.set("userAccess",a);var s=e[1];s&&s.elements?t.getDependencyOwnerFullName(s.elements).then(function(e){var t=i.buildUpstreamDependencyModel(e,s.originid);n.set("upstreamDependencyObjects",t);var a=0;t&&t.dependencyLinks&&Array.isArray(t.dependencyLinks)&&t.dependencyLinks.forEach(function(e,t){"Flowdown"===e.dependencyValueType&&a++});n.set("flowdownDependencyCount",a),t=i.buildDownstreamDependencyModel(e,s.originid),n.set("downstreamDependencyObjects",t),o()}):o()})})},parse:function(e){},getTargetDependencies:function(e){var o=this;t.getCADependencies(e).then(function(e){e&&e.elements?t.getDependencyOwnerFullName(e.elements).then(function(t){var a=i.buildUpstreamDependencyModel(t,e.originid);o.set("upstreamChildNodes",a),a=i.buildDownstreamDependencyModel(t,e.originid),o.set("downstreamChildNodes",a),n.publish("dependency:ChildNodes:ready"+widget.id)}):n.publish("dependency:ChildNodes:ready"+widget.id)})},updateDependUserAccess:function(e){var i=this;t.getDependUserAccess(e).then(function(e){var t=e;i.set("userAccess",t)})}})}),define("DS/ENOChangeActionUX/scripts/Models/CAModel",["UWA/Class/Model","DS/WebappsUtils/WebappsUtils","DS/ENOChangeActionUX/scripts/Models/CARealizedModel","DS/ENOChangeActionUX/scripts/Collection/CARealizedCollection","DS/ENOChangeActionUX/scripts/CASpinner","UWA/Date","UWA/Class/Promise","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","text!DS/ENOChgServices/assets/ChangeActionMapping.json","require","DS/ENOChangeActionUX/scripts/Models/CADependencyModel","DS/PlatformAPI/PlatformAPI","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgApplicabilityServices","DS/ENOChgServices/scripts/services/ChgDependencyServices","DS/ENOChangeActionUX/scripts/Services/CAContextViewServices","DS/ENOChgServices/scripts/services/ChgDataProcess"],function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f){"use strict";return e.extend({idAttribute:"id",setup:function(){var e=JSON.parse(l).Show_Accept_Task;e&&"true"===e?this.set("showAcceptTask",!0):this.set("showAcceptTask",!1),this.addEvent("onChange:severity",function(e){e.set("severityDisplay",r.get("ECM_CA_Severity_"+e.get("severity")))}),this.addEvent("onChange:ownerDisplayName",function(e){this.refreshCAHeader(e);var t={id:e.id,newOwner:e.get("ownerDisplayName"),userName:e.get("owner")};p.publish("ca-IDCard-on-change-transfer-responsibility",t)}),this.addEvent("onChange:referentials",function(e){this.setCAThumbnail(e)}),this.addEvent("onChange:current",function(e){this.refreshCAHeader(e);var t=e.get("current"),i=e.get("currentDisplay"),n=c("DS/ENOChgServices/scripts/services/ChgNativeInitService");if(u.getGlobalVariable().isNative){if(""!=t&&["Approved","Complete","Prepare","Cancelled","In Approval"].indexOf(t)>0){n.DispatchEventToWin("Work_Under","FALSE")}}var o={id:e.id,maturity:t,maturityDisplay:i};p.publish("ca-IDCard-on-change-maturity",o),p.publish("ca-approval-view",o)}),this.addEvent("onChange:holdValue",function(e){this.refreshCAHeader(e);var t={id:e.id,holdValue:e.get("holdValue")};p.publish("ca-IDCard-on-change-holdValue",t)}),this.addEvent("onChange:isGroup",function(e){this.refreshCAHeader(e)}),this.addEvent("onChange:applicabilitySet",function(e){this.refreshCAHeader(e,!0);var t=c("DS/ENOChgServices/scripts/services/ChgIDCardHeaderServices");h.refreshApplicabilityView(e.get("id")),t.createLifecycleSpanContent(e)}),this.addEvent("onChange:owner",function(e){this.refreshCAHeader(e)}),this.addEvent("onChange:changeOrderName",function(e){this.refreshCAHeader(e),c("DS/ENOChgServices/scripts/services/ChgIDCardHeaderServices").createLifecycleSpanContent(e)})},refreshCAHeader:function(e,t){var i=this;require(["DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgIDCardHeaderServices","UWA/Class/Promise","DS/ENOChangeActionUX/scripts/Views/CAViewCommon","DS/ENOChgServices/scripts/services/ChgDataService"],function(t,n,o,a,s){var r=[],l=t.getUserAccess(e.get("id")),c=n.getCompletedTaskDetails(e.get("id")),d=s.getFinalApprovedRT(e.get("id"));r.push(l,d,c);let u={"ds6w:project":[e.get("project_space")],"ds6w:organizationResponsible":[e.get("organization")]},h=i.getNLSValuesPromiseWrapper(u);if(r.push(h),"In Approval"==e.get("current")){var m=n.getTaskDetails(e.get("id"));r.push(m)}o.all(r).then(function(t){t.forEach(function(t){if(t&&UWA.is(t.userAccess))e.set("userAccess","",{silent:!0}),e.set("userAccess",t.userAccess),p.publish("ca-user-access-updated",t.userAccess);else if(t&&UWA.is(t.taskDetail)){e.set("approveOrRejectIcon",!1),e.set("acceptTaskIcon",!1);var i=t.taskDetail.toBeAccepted,n=t.taskDetail.toBeAssessed;if(UWA.is(i)&&i.length>0&&UWA.is(i[0].current)&&"Assigned"===i[0].current&&UWA.is(i[0].approvalStatus)&&"None"===i[0].approvalStatus&&(e.set("acceptTaskIcon",!0),e.set("inboxTaskId",i[0].id)),UWA.is(n)&&n.length>0)for(var o=0;o<n.length;o++)if(UWA.is(n[o].current)&&"Assigned"===n[o].current&&UWA.is(n[o].approvalStatus)&&"None"===n[o].approvalStatus){e.set("approveOrRejectIcon",!0),e.set("inboxTaskId",n[o].id);break}}else if(t&&UWA.is(t.completedTaskDetail))for(var a=t.completedTaskDetail.route,s=(UWA.is(a)&&UWA.is(a.routeStatus)&&a.routeStatus,t.completedTaskDetail.inboxTasks),r=0;r<s.length;r++)UWA.is(s[r].owner)&&""!=s[r].owner&&"None"!=s[r].approvalStatus?(e.set(s[r].owner+"_approvalStatus",void 0),e.set(s[r].owner+"_approvalStatus",s[r].approvalStatus),UWA.is(s[r].comments)&&""!=s[r].comments?(e.set(s[r].owner+"_comments",void 0),e.set(s[r].owner+"_comments",s[r].comments)):e.set(s[r].owner+"_comments","")):(e.set(s[r].owner+"_comments",""),e.set(s[r].owner+"_approvalStatus",""));else if(t&&UWA.is(t.ApprovedRTs)){e.set("acceptUserGroupIcon",!1);var l=f.processAllApprovedRoutes(t.ApprovedRTs);""!=l&&(e.set("acceptUserGroupIcon",!0),e.set("routeIDForUserGroup",l))}else if(t&&UWA.is(t.CSOrgNLS)){let i=t.CSOrgNLS["ds6w:organizationResponsible"][e.get("organization")],n=t.CSOrgNLS["ds6w:project"][e.get("project_space")];e.set("organization_title",i),e.set("project_space_title",n)}});var i=a.createOwnerSectionTemplate(e);e.unset("ownerName"),e.set("ownerName",i),a.addEventsForTitleSection(e),n.createLifecycleSpanContent(e)},function(e){return console.log("failed"),o.reject(e)})})},fetch:function(e){var t=this;require(["DS/ENOChangeActionUX/scripts/Views/CAViewCommon"],function(e){p.publish("load-dependency"+widget.id,t.id),m.changeActionDependenciesLoaded=!1,m.changeActionDependencyModel=null,e.showHideDependencyLoader(),p.unsubscribe("dependency:data:ready"+widget.id),p.subscribe("dependency:data:ready"+widget.id,function(){e.showHideDependencyLoader()})}),e.method="GET";return e.ajax=function(e,i){require(["DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgMembersServices","DS/ENOChgServices/scripts/services/ChgDataService","UWA/Class/Promise"],function(e,n,o,a){var s=[t.id.replace("pid:","")],r=[],l=e.getCADetails(t.id),c=o.getObjectInfo(s,["icon","image"]);r.push(l,c),a.all(r).then(function(o){var s;o[0].changeaction?((s=o[0]).changeaction.icon=o[1][0].dataelements.icon,s.changeaction.image=o[1][0].dataelements.image):((s=o[1]).changeaction.icon=o[0][0].dataelements.icon,s.changeaction.image=o[0][0].dataelements.image);var r=[],l=s.changeaction.people;l.length&&l.forEach(function(e){r.push(e.name)}),e.getUserFullNameFromIDs(r).then(function(o){n._addFullNameToPersonObject(s,o),i.onComplete(s),e.setCurrModel(t)},function(e){return a.reject(e)})},function(e){return console.log("failed"),a.reject(e)})})},e.url="dummyURL",this._parent(e)},parse:function(e){var i=this,n=c("DS/ENOChgServices/scripts/services/ChgIDCardCommonServices"),s=u.getGlobalVariable();if(UWA.is(e)){if(UWA.is(e.changeaction)){i.set("icon",e.changeaction.icon),i.set("image",e.changeaction.image),UWA.is(e.changeaction.group)?(i.set("group",e.changeaction.group.title),i.set("groupid",e.changeaction.group.id)):(i.set("group",void 0),i.set("groupid",void 0)),i.set("id",e.changeaction.id);var d=e.changeaction.attributes;UWA.is(d)&&d.forEach(function(t){if("attribute_ActualCompletionDate"===t.name)i.set("actualDue",UWA.is(t.value)&&""!==t.value?a.strftime(new Date(t.value),"%Y-%m-%d"):"");else if("attribute_ActualStartDate"===t.name)i.set("actualCreated",UWA.is(t.value)&&""!==t.value?a.strftime(new Date(t.value),"%Y-%m-%d"):"");else if("attribute_BypassPlants"===t.name)i.set("bypassPlants",t.value);else if("attribute_CategoryofChange"===t.name)i.set("categoryofChange",t.value);else if("attribute_EstimatedCompletionDate"===t.name)i.set("due",UWA.is(t.value)&&""!==t.value?a.strftime(new Date(t.value),"%Y-%m-%d"):""),""===i.get("due")&&i.set("due",r.ECM_CA_DUEDATE_UNASSIGNED);else if("attribute_EstimatedStartDate"===t.name)i.set("created",UWA.is(t.value)&&""!==t.value?a.strftime(new Date(t.value),"%Y-%m-%d"):"");else if("attribute_Originator"===t.name)i.set("originator",t.value);else if("attribute_ReasonForCancel"===t.name)i.set("reasonForCancel",t.value);else if("attribute_ResponsibleManufacturingEngineer"===t.name)i.set("responsibleManufacturingEngineer",t.value);else if("attribute_Severity"===t.name)i.set("severity","",{silent:!0}),i.set("severity",t.value);else if("attribute_Synopsis"===t.name){i.set("synopsis",t.value);var n="";n=f.escapeHTML(t.value),s.flowdownOptions&&!0===s.flowdownOptions.isFromFlowDown&&(n=n+" "+r.ECM_CA_Flowdown_From_Title+" "+s.flowdownOptions.originatingCAName),i.set("title",n),i.set("subtitle",e.changeaction.name)}else if("project"===t.name)s.project_space=t.value,i.set("project_space",t.value);else if("current"===t.name){i.set("current",t.value,{silent:!0});var o=i.get("currentDisplay");console.log(o);var l=i.get("current"),d=c("DS/ENOChgServices/scripts/services/ChgNativeInitService");if(u.getGlobalVariable().isNative){if(""!=l&&["Approved","Complete","Prepare","Cancelled","In Approval"].indexOf(l)>0){n="Work_Under";d.DispatchEventToWin(n,"FALSE")}}var h={id:i.id,maturity:l,maturityDisplay:o};p.publish("ca-IDCard-on-change-maturity",h),p.publish("ca-approval-view",h)}else"currentNLS"===t.name?i.set("currentDisplay",t.value):"organization"===t.name?(s.organization=t.value,i.set("organization",t.value)):"modified"===t.name?i.set("modified",UWA.is(t.value)&&""!==t.value?a.strftime(new Date(t.value),"%Y-%m-%d"):""):"interface[Change On Hold]"===t.name&&("TRUE"==t.value?(i.set("holdStatus","true"),i.set("holdValue",r.ECM_CA_State_On_Hold,{silent:!0})):(i.set("holdStatus",null),i.set("holdValue","",{silent:!0})),i.get("holdStatus")?i.set("TableStateVal",r.ECM_CA_State_On_Hold):i.set("TableStateVal",r.get("ECM_CA_State_"+i.get("current"))))}),UWA.is(e.changeaction.people)&&(i.set("owner",e.changeaction.people[0].name,{silent:!0}),i.set("ownerDisplayName",e.changeaction.people[0].fullName,{silent:!0}),i.set("ownerId",e.changeaction.people[0].id)),i.set("name",e.changeaction.name),"Change Action"===e.changeaction.type&&i.set("type","Change Action"),i.set("lifecycleHTML","<span id ='lifecycleSpan'></span>");var m=e.changeaction.applicability;if(h.getApplicabilityExpression(m)?i.set("applicabilitySet","false",{silent:!0}):i.set("applicabilitySet","true",{silent:!0}),UWA.is(e.changeaction.changeorder)&&UWA.is(e.changeaction.changeorder.id)?(i.set("changeOrderName",e.changeaction.changeorder.info["display name"],{silent:!0}),i.set("changeOrderId",e.changeaction.changeorder.id)):(i.set("changeOrderName",r.ECM_CA_DUEDATE_UNASSIGNED,{silent:!0}),i.set("changeOrderId",void 0)),UWA.is(e.changeaction.referentials)){var C=e.changeaction.referentials;i.set("attachmentCount",C.length),require(["DS/ENOChangeActionUX/scripts/Services/CAReferentialServices"],function(e){var t=e.createReferentialCollection(C);n.enrichCollection(t).then(function(e){i.set("referentials",t),n.updateExcludeList(i,"referentials")})})}if(require(["DS/ENOChangeActionUX/scripts/Views/CAViewCommon"],function(e){var t=e.createOwnerSectionTemplate(i);i.unset("ownerName"),i.set("ownerName",t),e.addEventsForTitleSection(i)}),UWA.is(e.changeaction.context)){var v=e.changeaction.context,A=g.createContextCollection(v);n.enrichCollection(A).then(function(e){i.set("context",A),n.updateExcludeList(i,"context")})}if(i.set("roleField",r.ECM_CA_Summary_Role),i.set("ownerField",r.ECM_CA_Summary_Owner),i.set("dueDateField",r.ECM_CA_Summary_DueDate),UWA.is(i.get("contextUserRole"))||i.set("contextUserRole",r.ECM_CA_Team_Owner),null!=s.newlyAssignCAIds&&""!=s.newlyAssignCAIds&&-1!=s.newlyAssignCAIds.indexOf(e.id)?(this.set("newlyAssign","yes"),this.set("newlyAssignTitle",r.ECM_CA_Notification_Newly_Assigned_CA),this.set("isNewlyAssign",r.ECM_CA_isNewlyAssigned_Yes)):(this.set("newlyAssign",null),this.set("isNewlyAssign",r.ECM_CA_isNewlyAssigned_No)),UWA.is(e.changeaction.people)){i=this;var w=[],b=[];if(e.changeaction.people.forEach(function(e){if("templateReviewer"!=e.role)if(w.indexOf(e.id)>=0){var t=i.isInArray(e,b),n=null;t>=0&&(n=b[t]),n&&(n.role+=", "+e.role)}else w.push(e.id),e.type="Person",b.push(e)}),UWA.is(e.changeaction.routeTemplates))e.changeaction.routeTemplates.forEach(function(e){e&&(w.push(e.id),e.type="Route Template",e.role="reviewer",e.fullName=e.name,b.push(e))});require(["DS/ENOChangeActionUX/scripts/Services/CATeamViewServices"],function(e){var t=e.createMembersCollection(b);i.set("people",t,{silent:!0});var n=t.findWhere({userName:s.contextUser});UWA.is(n)?i.set("contextUserRole",n.get("rolesToDisplay")):i.set("contextUserRole","other")})}}else{this.set("id",e.id),this.set("name",e.name),"Name"==s.NamePref?this.set("title",e.name):this.set("title",e.attributes.Synopsis),this.set("type",e.type),this.set("current",e.state),this.set("currentDisplay",r.get("ECM_CA_State_"+this.get("current"))),this.set("synopsis",e.attributes.Synopsis),"Name"==s.NamePref?this.set("subtitle",e.attributes.Synopsis):this.set("subtitle",e.name),this.set("created",UWA.is(e.attributes.EstimatedStartDate)&&""!==e.attributes.EstimatedStartDate?a.strftime(new Date(e.attributes.EstimatedStartDate),"%Y-%m-%d"):""),this.set("due",UWA.is(e.attributes.EstimatedCompletionDate)&&""!==e.attributes.EstimatedCompletionDate?a.strftime(new Date(e.attributes.EstimatedCompletionDate),"%Y-%m-%d"):""),this.set("severity",e.attributes.Severity),this.set("severityDisplay",r.get("ECM_CA_Severity_"+this.get("severity"))),this.set("owner",e.owner),this.set("ownerDisplayName",e.ownerDisplayName),this.set("contextUserRole",e.contextUserRole),null!=s.newlyAssignCAIds&&""!=s.newlyAssignCAIds&&-1!=s.newlyAssignCAIds.indexOf(e.id)?(this.set("newlyAssign","yes"),this.set("newlyAssignTitle",r.ECM_CA_Notification_Newly_Assigned_CA),this.set("isNewlyAssign",r.ECM_CA_isNewlyAssigned_Yes)):(this.set("newlyAssign",null),this.set("isNewlyAssign",r.ECM_CA_isNewlyAssigned_No)),this.set("roleField",r.ECM_CA_Summary_Role),this.set("ownerField",r.ECM_CA_Summary_Owner),this.set("dueDateField",r.ECM_CA_Summary_DueDate);var S=JSON.parse(l),y=S[this.get("severity")];y=UWA.is(y)&&""!=y?"images/"+y:"images/"+(y=S._default),this.set("image",t.getWebappsAssetUrl(s.frameWorkName,y)),this.set("holdStatus","True"==e["Change On Hold"]?"true":null),this.set("holdValue",UWA.is(this.get("holdStatus"))&&"true"==this.get("holdStatus")?r.ECM_CA_State_On_Hold:""),this.get("holdStatus")?this.set("TableStateVal",r.ECM_CA_State_On_Hold):this.set("TableStateVal",r.get("ECM_CA_State_"+this.get("current"))),""===this.get("due")&&this.set("due",r.ECM_CA_DUEDATE_UNASSIGNED)}this.refreshCAHeader(this)}else o.endWait(widget.body)},isInArray:function(e,t){var i=-1;return t.forEach(function(t,n){e.id===t.id&&(i=n)}),i},createRealizedCollection_space:function(e,t){var n=new UWA.Class.Collection;return Array.isArray(e)&&e.forEach(function(e){if(null!=n.get(e.where.id));else{var t=new i(e);t.fetch({}),n.add(t)}}),n},createRealizedCollection_native:function(e){var t=new UWA.Class.Collection;return Array.isArray(e)&&e.forEach(function(e){if(null!=t.get(e.where.id));else{var n=new i(e);n.fetch({}),t.add(n)}}),t},createRealizedCollection:function(e,t){if(u.getGlobalVariable().is3DSpace)return this.createRealizedCollection_space(e,t);var i={RealizedArr:e},o=new n;return o.fetch(i),o.forEach(function(e){e.fetch(i)}),o},setCAThumbnail:function(e){var t=c("DS/ENOChgServices/scripts/services/ChgIDCardHeaderServices").getCAthumbnailUrl(e);e.set("image",t)},getNLSValuesPromiseWrapper:function(e){return new s(function(t,i){require(["DS/ENOChgServices/scripts/services/ChgInfraService"],function(n){n.getNLSValuesPromise(e).then(function(e){let i={};i.CSOrgNLS=e,t(i)},function(e){i(e)})})})}})}),define("DS/ENOChangeActionUX/scripts/CreateCAForm",["DS/UIKIT/Input/Text","UWA/Core","UWA/Date","DS/UIKIT/Form","DS/UIKIT/Input/Button","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/UIKIT/Modal","DS/UIKIT/Input/ButtonGroup","DS/UIKIT/Input/Date","DS/ENOChangeActionUX/scripts/CASpinner","DS/ENOChangeActionUX/scripts/Models/CAModel","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENO6WPlugins/jQuery","DS/UIKIT/Input/Select","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgIDCardHeaderServices","DS/ENOChangeActionUX/scripts/Services/ChgChangeActionServices","DS/ENOChgServices/scripts/services/ChgProposedServices","css!DS/ENOChangeActionUX/ENOChangeActionUX"],function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v,A,w){"use strict";var b={CACreateModal:void 0,onCloseCallback:null,severityButtonGroup:null,currentModelObjectForRefresh:void 0,createOrEditFlag:!0,calendarOnClickDueDate:function(e){t.extendElement(document.body).getElement("#DueDate").click()},pushFormContentOnHide:function(){b.formFieldContent.reset(),b.formFieldContent.unvalidate(),null!=b.onCloseCallback&&null!=b.onCloseCallback&&event&&event.srcElement&&event.srcElement.className&&event.srcElement.className.contains("fonticon-cancel")&&b.onCloseCallback()},dueDateOnChange:function(){var e=t.extendElement(document.body).getElement("#DueDate"),n=t.extendElement(document.body).getElement("#DueDate_hidden");if(e.value){var o="%m/%d/%Y";n.value=i.strftime(this.getDate(),o),o="%Y-%m-%d",e.value=i.strftime(this.getDate(),o)}else e.value="",n.value="";var a=h("#duedatecancel"),s=h("#calenderspan");a&&(a.css("display","block"),a.css("visibility","visible")),s&&s.css("display","none")},createBody:function(e){var t=e&&e.changeaction?e.changeaction.title:void 0,i=e&&e.changeaction?e.changeaction.description:void 0,n=!0,s=!1,l=!1;switch(e&&e.changeaction?e.changeaction.severity:void 0){case"Medium":n=!1,s=!0;break;case"High":n=!1,l=!0}var c=UWA.createElement("div",{html:[{tag:"div",id:"AbstractDiv",styles:{"margin-bottom":"15px","font-size":"14px"},html:[{tag:"div",class:"label-container",html:[{tag:"h5",html:a.ECM_CA_Abstract},{tag:"span",class:"mand-asterisk fonticon fonticon-asterisk-alt"}]},{tag:"div",html:UWA.createElement("div",{class:"form-group",html:b.createTextField("Abstract",t)})}]},{tag:"div",id:"DescriptionDiv",styles:{"margin-bottom":"15px","font-size":"14px"},html:[{tag:"div",class:"label-container",html:[{tag:"h5",html:a.ECM_CA_Description}]},{tag:"div",html:UWA.createElement("div",{class:"form-group",html:b.createTextField("Description",i)})}]},{tag:"div",id:"SeverityDiv",styles:{"margin-bottom":"15px","font-size":"14px"},html:[{tag:"h5",html:a.ECM_CA_Severity},{tag:"div",html:UWA.createElement("div",{class:"form-group",html:b.severityButtonGroup=new r({type:"radio",name:"Severity",id:"Severity",buttons:[new o({value:a.ECM_CA_Severity_Low,id:"Low",className:"success small",active:n}),new o({value:a.ECM_CA_Severity_Medium,id:"Medium",className:"warning small",active:s}),new o({value:a.ECM_CA_Severity_High,id:"High",className:"error small",active:l})]})})}]},{tag:"div",id:"DueDateDiv",styles:{"margin-bottom":"15px","font-size":"14px"},html:[{tag:"h5",html:a.ECM_CA_DueDate},{tag:"span",class:"due-date-span",html:b.createDueDateElem()},{tag:"input",type:"hidden",name:"DueDate_hidden",id:"DueDate_hidden",value:""}]}]});if(t&&""!==t.trim()?(b.doneBtn.elements.input.disabled=!1,b.doneBtn.elements.input.removeClassName("disabled"),b.beginWorkBtn.elements.input.disabled=!1,b.beginWorkBtn.elements.input.removeClassName("disabled")):(b.doneBtn.elements.input.disabled=!0,b.doneBtn.elements.input.addClassName("disabled"),b.beginWorkBtn.elements.input.disabled=!0,b.beginWorkBtn.elements.input.addClassName("disabled")),1==u.getGlobalVariable().changeActionSubTypePresent){var d=b.createSubTypeField();c.prepend(d)}return c},createSubTypeField:function(){var e=u.getGlobalVariable().changeActionSubTypes;return UWA.createElement("div",{id:"TypeDiv",styles:{"margin-bottom":"15px","font-size":"14px"},html:[{tag:"div",class:"label-container",html:[{tag:"h5",html:a.ECM_CA_Type},{tag:"span",class:"mand-asterisk fonticon fonticon-asterisk-alt"}]},{tag:"div",html:new m({required:!0,id:"CATypeSelect",name:"CATypeSelect",custom:!1,placeholder:!1,options:e})}]})},createTextField:function(t,i){var n=new e({name:t,id:t,className:"Abstract"===t?"mandatory_input":"",value:i||"",multiline:"Abstract"!==t,rows:"Abstract"===t?1:2,required:"Abstract"===t,placeholder:"Abstract"===t?a.ECM_CA_Abstract_PlaceHolder:a.ECM_CA_Description_PlaceHolder});return n.elements.input.onkeyup=function(){var e=b.formFieldContent.getValue("Abstract");e&&""!=e.trim()?(b.doneBtn.elements.input.disabled=!1,b.doneBtn.elements.input.removeClassName("disabled"),b.beginWorkBtn.elements.input.disabled=!1,b.beginWorkBtn.elements.input.removeClassName("disabled")):(b.doneBtn.elements.input.disabled=!0,b.doneBtn.elements.input.addClassName("disabled"),b.beginWorkBtn.elements.input.disabled=!0,b.beginWorkBtn.elements.input.addClassName("disabled"))},n},createDueDateElem:function(){return[{styles:{border:"1px solid #b4b6ba","border-radius":"5px",display:"flex","background-color":"#f4f5f6"},html:UWA.createElement("span",{class:"date-input-container",html:[new l({name:"DueDate",id:"DueDate",required:!1,min:new Date,value:"",placeholder:a.ECM_CA_Date_PlaceHolder,events:{onChange:b.dueDateOnChange}}),{tag:"span",class:"cancel-span",html:b.createCancelBtnSpan()},{tag:"span",class:"calendar-span",html:b.createCalenderSpan()}]})}]},createCalenderSpan:function(){var e=UWA.createElement("span",{class:"fonticon fonticon-calendar",id:"calenderspan"});return e.set({events:{click:function(e){t.extendElement(document.body).getElement("#DueDate").click()}}}),[{html:e}]},createCancelBtnSpan:function(){var e=UWA.createElement("span",{class:"clear-filter fonticon fonticon-cancel-circled",id:"duedatecancel"});return e.set({events:{click:function(e){var t=h("#DueDate"),i=h("#DueDate_Hidden");t&&t.val(""),i&&i.val("");var n=h("#duedatecancel"),o=h("#calenderspan");n&&n.css("display","none"),o&&o.css("display","block")}}}),[{html:e}]},formFieldContent:new n({fields:[{type:"html",name:"CAFormBody",id:"CAFormBody",html:"<div id='CAFormDiv'></div>"}],events:{onInvalid:function(){g.error(a.ECM_CA_MandFieldMissing_error)}}}),physicalIDContainer:new e({name:"PhysicalID",id:"PhysicalID",required:!1,value:"",hide:!0}),CANameContainer:new e({name:"CAName",id:"CAName",required:!1,value:"",hide:!0}),cancelButton:new o({value:a.ECM_CA_Cancel,events:{onClick:function(){b.CACreateModal.hide();var e=b.physicalIDContainer.getValue();""!=e&&b.createOrEditFlag&&(b.createIDCardEdit(e),b.physicalIDContainer.setValue(""))}}}),checkSCAndProceed:function(e){""!=u.getGlobalVariable().mySecurityContext?e():p.populateSecurityContext().then(function(t){e()},function(e){console.log("ENOChgActionCMDs: populate security context failed")})},createCAFromActionBar:function(e,i,n){var o=this,r=[],l="",c=u.getGlobalVariable();return new Promise(function(d,u){var h=e.proposed,m=[],g=function(){m.push(b.caSubTypesFetched()),h.length>0&&(h.forEach(function(e){r.push("pid:"+e)}),m.push(A.getAllowedOperationActivity(r))),Promise.all(m).then(function(r){r.forEach(function(e){e&&UWA.is(e.allowedOperationActivity)&&(r=e)}),l=v.getJSONForCACreation(e,r),o.CACreateModal=null,o.onCloseCallback=n,o.CACreateModal=new s({closable:!0,header:"<h4>"+a.ECM_CA_ChangeAction_Definition+"</h4>",body:b.formFieldContent,footer:[b.createAndAddButton(l,i),b.beginWorkButton(l,i),b.cancelButton],events:{onHide:b.pushFormContentOnHide.bind(b.CACreateModal)}}),o.CACreateModal.inject(widget.body).show();var c=t.extendElement(document.body).getElement("#CAFormDiv");c.innerHTML="",o.createBody(l).inject(c);var p=document.getElementById("Abstract");p&&p.focus();var u=t.extendElement(document.body).getElement("#EditCADiv");u&&u.hide(),b.doneBtn.show(),b.beginWorkBtn.show(),d(b)},function(e){console.log("Issue in retrieving subtypes")})};if(c.tenant||(c.tenant=widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise"),c.tenantMappings){for(var f=c.tenantMappings,C=0;C<f.length;C++)c.tenant==f[C].platformId&&(c.baseURL=f[C]["3DSpace"],c.federatedURL=f[C]["3DSearch"]);""!=c.mySecurityContext?g():p.populateSecurityContext().then(function(e){g()},function(e){console.log("ENOChgActionCMDs: populate security context failed")})}else p.populate3DSpaceURL().then(function(e){""!=c.mySecurityContext?g():p.populateSecurityContext().then(function(e){g()},function(e){console.log("ENOChgActionCMDs: populate security context failed")})},function(e){console.log("ENOChgActionCMDs: populate base URL failed")})})},createAndAddButton:function(e,t){return b.doneBtn=new o({value:a.ECM_CA_Create,className:"primary",disabled:!0,onCompleteCallback:function(e){c.endWait(b.CACreateModal.getBody()),b.CACreateModal.hide(),t(e)},onFailureCallback:function(e,i){c.endWait(b.CACreateModal.getBody()),t({changeaction:void 0})}}),b.doneBtn.elements.input.onclick=function(){if(b.formFieldContent.validate(!1,!1)){c.doWait(b.CACreateModal.getBody());var t=b.getCreateEditData("create");null!=e&&(e.changeaction.add.proposed.length>0&&(t.changeaction.proposed=e.changeaction.add.proposed),e.changeaction.add.context.length>0&&(t.changeaction.context=e.changeaction.add.context),e.changeaction.add.people.length>0&&(t.changeaction.people=e.changeaction.add.people),e.changeaction.add.referentials.length>0&&(t.changeaction.referentials=e.changeaction.add.referentials),e.changeaction.changeorder&&(t.changeaction.changeorder=e.changeaction.changeorder)),p.createCA(JSON.stringify(t),b.doneBtn.options.onCompleteCallback,b.doneBtn.options.onFailureCallback)}},b.doneBtn},cancelButton:new o({value:a.ECM_CA_Cancel,events:{onClick:function(){b.CACreateModal.hide();var e=b.physicalIDContainer.getValue();""!=e&&b.createOrEditFlag&&(b.createIDCardEdit(e),b.physicalIDContainer.setValue("")),null!=b.onCloseCallback&&null!=b.onCloseCallback&&b.onCloseCallback()}}}),beginWorkButton:function(e,t){return b.beginWorkBtn=new o({value:a.ECM_CA_Begin_Work,disabled:!0,onCompleteCallback:function(e){var i=e.changeaction.id.replace("pid:","");C.promoteChangeAction(i,"In Work").then(function(i){if(e.changeaction&&e.changeaction.attributes){var n=e.changeaction.attributes;UWA.is(n)&&n.forEach(function(e){"current"===e.name&&(e.value="In Work"),"currentNLS"===e.name&&(e.value=i.maturity)})}t(e),c.endWait(b.CACreateModal.getBody()),b.CACreateModal.hide()},function(i){return c.endWait(b.CACreateModal.getBody()),b.CACreateModal.hide(),t(e),Promise.reject(i)})},onFailureCallback:function(e,i){c.endWait(b.CACreateModal.getBody()),t({changeaction:void 0})}}),b.beginWorkBtn.elements.input.onclick=function(){if(b.formFieldContent.validate(!1,!1)){c.doWait(b.CACreateModal.getBody());var t=b.getCreateEditData("create");null!=e&&(e.changeaction.add.proposed.length>0&&(t.changeaction.proposed=e.changeaction.add.proposed),e.changeaction.add.context.length>0&&(t.changeaction.context=e.changeaction.add.context),e.changeaction.add.people.length>0&&(t.changeaction.people=e.changeaction.add.people),e.changeaction.add.referentials.length>0&&(t.changeaction.referentials=e.changeaction.add.referentials),e.changeaction.changeorder&&(t.changeaction.changeorder=e.changeaction.changeorder)),p.createCA(JSON.stringify(t),b.beginWorkBtn.options.onCompleteCallback,b.beginWorkBtn.options.onFailureCallback)}},b.beginWorkBtn},getCreateEditData:function(e){b.formFieldContent.getValues();var t=f.sanitizeText(b.formFieldContent.getValue("Abstract")),i=b.formFieldContent.getValue("Description"),n=b.severityButtonGroup.getActive()[0].getId(),o=b.formFieldContent.getValue("DueDate_hidden"),a=(b.formFieldContent.getValue("EstimatedStartDate_hidden"),b.formFieldContent.getValue("ChangeOrder_hidden"),b.formFieldContent.getValue("CATypeSelect"));a=f.sanitizeText(null==a||"Change Action"==a?"type_ChangeAction":"type_"+a);var s="";return"create"==e&&(s={version:"v0",changeaction:{name:"",revision:"-",type:a,description:i,attributes:[{name:"Synopsis",value:t},{name:"Estimated Completion Date",value:o},{name:"Severity",value:n}]}}),s},caSubTypesFetched:function(){return new Promise(function(e,t){null!=u.getGlobalVariable().changeActionSubTypes?e():p.fetchSubTypes(e,t)})}};return b}),define("DS/ENOChangeActionUX/scripts/Views/CARealizedOperationView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/Handlebars/Handlebars4","DS/ENOChangeActionUX/scripts/Views/CARealizedActivitiesView","DS/ENOChangeActionUX/scripts/Views/CARealizedActivitiesForFlowdown","DS/UIKIT/Scroller","DS/TransientWidget/TransientWidget","DS/i3DXCompassPlatformServices/OpenWith","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/ENOChgServices/scripts/services/ChgPropertiesServices","DS/ENOChangeActionUX/scripts/Services/CARealizedViewServices","DS/ENOChgServices/scripts/services/ChgRealizedServices","DS/UIKIT/Popover","DS/ENOChangeActionUX/scripts/Views/CAPopOverBodyView","text!DS/ENOChangeActionUX/scripts/Templates/CARealizedOpeationForFlowdownTemplate.html","DS/ENOChangeActionUX/scripts/CASpinner","DS/ENOChgGovernanceUX/scripts/util/DocumentUtils","DS/ENOChgServices/scripts/services/ChgErrors"],function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v,A,w,b){"use strict";o.registerHelper("equalsToOne",function(e){return 1===e.length}),o.registerHelper("isContextualMenuAvailable",function(e){return'<div class="context-actions-container">                                            <div class="action-icon-wrapper"><span class="Realized-operation-action-open fonticon fonticon-2x fonticon-down-open" id="Realized-Op-Clicked-'+e.displayId+'"></span></div>                                    </div>'}),o.registerHelper("getWhereDetails",function(e,i){var n=window.matchMedia("(max-width: 768px)"),o=(e.id.substr(4),'<div class="Realized-change-info-text" id="info-text-'+i+'">');return UWA.is(e)&&(o=o+'<div class="Realized-change-TNR-text" id="TNR-text-'+i+'">                                                    <div class="Realized-change-TNR-text_sub">                                                    <div class="Realized-change-TNR-Preference" id="TNR-Preference-'+i+'">',UWA.is(e.icon)&&""!=e.icon&&(o=o+'<img class="Realized-change-info-icon" id="info-icon-'+i+'" src ='+e.icon+"></img>"),UWA.is(e.name)&&""!=e.name&&(o=o+'<div class="Realized-name-title" id="Realized-name-title-'+i+'" title="'+e.name+" "+e.revision+'">                                                       <span class="Realized-name-span" id="Realized-name-span-'+i+'">'+e.name+'</span>                                                        <span class="Realized-revision-span" id="Realized-revision-span-'+i+'">'+e.revision+"</span>                                                       </div>"),o+="</div>",!n.matches&&UWA.is(e.maturity)&&""!=e.maturity&&(o=o+'<div class="Realized-Mobile-Maturity hidden" id="Realized-Mobile-Maturity-'+i+'">                                                       <span class="Realized-Maturity-span" id="Realized-Maturity-span-'+i+'">'+e.maturity+"</span>                                                       </div>"),n.matches&&UWA.is(e.maturity)&&""!=e.maturity&&(o=o+'<div class="Realized-Mobile-Maturity" id="Realized-Mobile-Maturity-'+i+'">                                                       <span class="Realized-Maturity-span" id="Realized-Maturity-span-'+i+'">'+e.maturity+"</span>                                                       </div>"),o+="</div >",n.matches||(o=(o=o+'<div class="Realized-title-Operation hidden" id="Realized-title-Operation-'+i+'">                                                       <span class="Realized-Operation-span" id="Realized-Operation-span-'+i+'">'+e.activities+"</span>                                                       </div>")+'<div class="Realized-title-name" id="Realized-title-name-'+i+'" title="'+e.title+'">                                                       <span class="Realized-title-span" id="Realized-title-span-'+i+'">'+e.title+"</span>                                                       </div>"),n.matches&&(o=(o=o+'<div class="Realized-title-Operation" id="Realized-title-Operation-'+i+'" title="'+e.activities+'">                                                       <span class="Realized-Operation-span" id="Realized-Operation-span-'+i+'">'+e.activities+"</span>                                                       </div>")+'<div class="Realized-title-name hidden" id="Realized-title-name-'+i+'">                                                       <span class="Realized-title-span" id="Realized-title-span-'+i+'">'+e.title+"</span>                                                       </div>"),o+="</div>",o=n.matches?o+'<div class="Realized-change-info-text-1 hidden" id="Realized-change-info-text-1-'+i+'">':o+'<div class="Realized-change-info-text-1 " id="Realized-change-info-text-1-'+i+'">',UWA.is(e.maturity)&&""!=e.maturity&&(o=(o=o+'<div class="Realized-change-info-text-2 " id="Realized-change-info-text-2-'+i+'>"')+'<p class="emptypara">                                                        <span class="empty"></span>                                                    </p>                                                    <p class="Realized-change-maturity" id="Realized-change-maturity-'+i+'">                                                        <span class="Realized-change-maturity-span" id="mat-span-'+i+'">'+e.maturityNLS+' :</span>                                                        <span class="Realized-change-maturityValue-span" id="matval-span-'+i+'">'+e.maturity+"</span>                                                    </p>                                                   </div>"),UWA.is(e.collabspace)&&(o=o+'<div class="Realized-change-info-text-3" id="info-text-3-'+i+'">                                                    <p class="emptypara">                                                        <span class="empty"></span>                                                    </p>                                                    <p class="Realized-change-collabspace" id="collabspace-'+i+'">                                                        <span class="Realized-change-collabspace-span" id="collab-span-'+i+'">'+e.collabspaceNLS+' :</span>                                                        <span class="Realized-change-collabspace-value-span" id="collab-span-value-'+i+'">'+e.collabspace+"</span>                                                    </p> </div>"),o=(o+="</div>")+'<div class="Realized-transfer-info-text-1 " id="Realized-transfer-info-text-1-'+i+'">',UWA.is(e.status)&&"Transferred"==e.status&&(UWA.is(e.targetCA)&&(o=o+'<div class="Realized-transfer-info-text-3" id="info-text-3-'+i+'">                                                    <p class="emptypara">                                                        <span class="empty"></span>                                                    </p>                                        <p class="Realized-change-targetCA" id="targetCA-'+i+'">                                        <span class="Realized-change-targetCA-span" id="targetCA-span-'+i+'">'+t.ECM_CA_Realized_TransferTo+' :</span>                                        <span class="Realized-change-targetCA-value-span" id="'+e.targetCAID+'">'+e.targetCA+"</span>                                  </p> </div>"),UWA.is(e.transferReasonNLS)&&(o=o+'<div class="Realized-transfer-info-text-4" id="info-text-4-'+i+'">                                                    <p class="emptypara">                                                        <span class="empty"></span>                                                    </p>                                                        <p class="Realized-change-transferComment" id="transferComment-'+i+'">                                                        <span class="Realized-change-transferComment-span" id="transferComment-span-'+i+'">'+t.ECM_CA_Realized_Transfer_Reason+' :</span>                                                        <span class="Realized-change-transferComment-value-span" id="transferComment-value-'+i+'">'+e.transferReasonNLS+"</span>                                                    </p> </div>")),o+="</div>"),o+"</div>"}),o.registerHelper("ifDraggableRealized",function(e){return!1===e?"draggable='false'":"draggable='true'"});var S={_createView_NewRealized:function(i){return e.extend({tagName:i.viewTagName,className:i.className,idcardView:i.idcardView,name:"RealizedOperation",RealizedModel:i.realizedModel,caModel:i.caModel,isFromFlowDown:i.flowdownOptions.isFromFlowDown,flowdownOptions:i.flowdownOptions,container:null,selectedTilesIDs:[],setup:function(){this.RealizedModel.get("id");this.flowdownOptions&&this.flowdownOptions.isFromProposedFlowdown?this.template=v:this.template='<div class="'+this.getClassNames("-container")+'">                                            {{#each changes}}                                            <div class="'+this.getClassNames("-sub-container")+'">                                                <div class="Realized-tile-collapsed" id="Realized-collapsed-{{@index}}" \t\t\t\t\t\t\t\t\t\t\t\t{{#ifDraggableRealized Details.access}}{{/ifDraggableRealized}}>                                                    <div class="Realized-accordion-div Realized-icon-class" id="Realized-accordion-div-{{@index}}"><div>                                                    <div class="Realized-action-icon-wrapper Realized-accordion-div-inner" id="Realized-accordion-div-inner-{{@index}}"><span class="fonticon fonticon-2x fonticon-expand-right" id={{@index}}></span></div>                                                    <div class="Realized-checked-action"><input type="checkbox" class="Realized-checkbox-accord hidden" id="Realized-checkbox-accord-{{Details.id}}"></div>                                                </div>                                            </div>                                            <div class="Realized-tile-inner" id="inner-{{@index}}">{{#getWhereDetails Details @index}}{{/getWhereDetails}}</div>                                                <div class="Realized-actions-container Realized-icon-class-1" id="Realized-operation-action-container-{{Details.displayId}}">{{#isContextualMenuAvailable Details}}{{/isContextualMenuAvailable}}</div>                                            </div>                                            <div class="Realized-tile-expanded hidden" id="Realized-expanded-{{@index}}"></div>                                            </div>                                            {{/each}}                                        </div>',S.selectedTilesIDs=[],this.listenTo(this.RealizedModel,"onChange:selectedProposed",this.render),this._parent.apply(this,arguments)},render:function(){this.container.empty(),this.selectedProposedArr=[],this.flowdownOptions.isFromProposedFlowdown?this.renderer=this.buildTemplateForProposedFlowdown(this.template,this.RealizedModel):this.renderer=this.getTemplate(this.template,this.RealizedModel);var e=this.idcardView?widget.body:this.container,t=UWA.createElement("div",{class:"main-Realized-operation-container"}),i=UWA.createElement("div",{class:"ChangeComponent"}),n=this.renderer();i.setContent(n),t.addContent(i),new r({element:t}).inject(e);var o=this;return S.container=o,setTimeout(function(){S.onResize()},0),o.selectedProposedArr.forEach(function(e){var t=e.idx,i=o.container.getElement("#inner-"+t);i&&!e.ifExists&&i.setStyle("flex","1")}),p.setCallbacksForOpenWith("realized"),A.isWaiting()&&A.endWait(widget.body),this},injectSubView:function(e,t){var i=this.container.getElement(t);e&&i&&i.grab(e.render().getContent())},_initActivitiesView:function(e,t){var i=this,n={idcardView:!1,activityModels:e,activityIdx:t,caModel:this.caModel,flowdownOptions:this.flowdownOptions},o=null;o=this.flowdownOptions&&this.flowdownOptions.isFromProposedFlowdown?this.flowdownActivitiesView=new s(n):new(a._createView_NewRealizedActivity(n));var r=this.ActivityEvents={onContextMenu:function(e){S.itemView=e,S.itemView.Access&&d.getGlobalVariable().isNative?u.DispatchEventToWin("Realized_ContextMenu",S.itemView.modelid):S.DisplayContextMenu([])},onItemViewDrag:function(){i.dispatchEvent("onItemViewDrag",arguments)},activityCheckBoxClicked:function(){i.dispatchEvent("activityCheckBoxClicked",arguments)},flowDownActivityObjects:function(){i.dispatchEvent("flowDownActivityObjects",arguments)},transferSelectedItems:function(){i.dispatchEvent("transferSelectedItems",arguments)}};this.listenTo(o,r),this.activitiesViewArr.push(o)},buildDataForTemplate:function(e){var i=[];this.activitiesViewArr=[];UWA.is(e)&&(e.forEach(function(e,n){var o={},a={maturityNLS:t.ECM_CA_Maturity,collabspaceNLS:t.ECM_CA_CollabSpace,statusNLS:t.ECM_CA_Realized_statusNLS,TransferNLS:t.ECM_CA_Realized_TransferNLS,maturity:e.get("maturity"),collabspace:e.get("collabSpaceTitle"),name:UWA.is(e.get("objectName"))?e.get("objectName"):e.get("name"),revision:e.get("revision"),title:UWA.is(e.get("objectTitle"))?e.get("objectTitle"):e.get("name"),icon:e.get("icon"),id:e.get("id"),access:e.get("Access"),displayId:e.get("id").substr(4),changeReason:e.get("changeReason"),status:e.get("status"),isConfigured:e.get("isConfigured"),transferReasonNLS:UWA.is(e.get("transferReasonNLS"))?e.get("transferReasonNLS"):"",targetCAID:UWA.is(e.get("receivingChangeAction"))?e.get("receivingChangeAction").id:"",targetCA:UWA.is(e.get("receivingChangeAction"))?e.get("receivingChangeAction").name:"",selectedProposedText:t.ECM_PROPOSED_SELECTED_PROPOSED,flowdownStatusText:t.ECM_PROPOSED_FLOWDOWN_STATUS,selectedProposedExists:!1,transferred:"Transferred"===e.get("status"),transferredText:t.ECM_CA_FLOWDOWN_TRANSFERRED_REALIZED_WARNING},s=[];e.get("activities").forEach(function(e){e.get("ActivityDetails").forEach(function(e){UWA.is(e)&&""!=e&&s.indexOf(e.NLSName)<0&&s.push(e.NLSName)})}),a.activities=s.toString();var r=UWA.is(e.get("objectTitle"))?e.get("objectTitle"):e.get("name"),l=UWA.is(e.get("objectName"))?e.get("objectName"):e.get("name"),c=UWA.is(e.get("receivingChangeAction"))?e.get("receivingChangeAction").synopsis:"";a.name=r.replace("<","&lt;"),a.title=l.replace("<","&lt;"),a.targetCA=c.replace("<","&lt;"),o.Details=a,i.push(o)}),g.setSelectedProposedPerRealizedObject({})),this.data={RealizedNls:t.ECM_CA_RealizedChanges,RealizedNum:i.length,changes:i}},buildTemplateForProposedFlowdown:function(e,t){var i=o.compile(e);this.buildDataForTemplate(t);var n=this;return function(){return i(n.data)}},getTemplate:function(e,t){var i=o.compile(e);this.buildDataForTemplate(t);var n=this;return function(){return i(n.data)}},domEvents:{"click .Realized-accordion-div-inner":function(e){var t=e.target.id,i=e.target.className;i.indexOf("expand-right")>0?e.target.className=i.replace("right","down").trim():i.indexOf("expand-down")>0&&(e.target.className=i.replace("down","right").trim()),S.expandTile(t,i)},"click .Realized-tile-inner":function(e){if(!(e.target.className.indexOf("down-open")>=0||0==e.target.className.indexOf("Realized-change-targetCA-value-span")||e.target.className.indexOf("supp-icon")>=0||e.target.className.indexOf("multiple-proposed")>=0)){var t=e.target.id.split("-"),i=t[t.length-1],n=this.container.getElement("#Realized-accordion-div-inner-"+i);if(n)if(n.className.indexOf("hidden")>0)return;var o=n.getElementsByTagName("span")[0].className;o.indexOf("expand-right")>0?n.getElementsByTagName("span")[0].className=o.replace("right","down").trim():o.indexOf("expand-down")>0&&(n.getElementsByTagName("span")[0].className=o.replace("down","right").trim()),S.expandTile(i)}},"click .Realized-checkbox-accord":function(e){for(var t=e.target.checked,i=e.target,n=0;i&&i.parentNode;)(i=i.parentElement)&&i.className&&i.className.contains("Realized-tile-collapsed")&&(n=i.id,t?i.addClassName("selected-border"):i.removeClassName("selected-border"));var o=n.split("-"),a=o[o.length-1],s=parseInt(a),r=this.RealizedModel.at(s),l=document.createElement("input");l.setAttribute("data-pid",e.target.id.replace("Realized-checkbox-accord-pid:","")),t&&l.setAttribute("class","selected");var c={};c.id=r.get("id").replace("pid:",""),c.name=r.get("objectName"),c.title=r.get("objectTitle"),c.type=r.get("objectType"),l.setAttribute("data-selectedItem",JSON.stringify(c)),CAWidgetConfiguration.onClickItem.call(l,widget,d.getGlobalVariable()),Array.prototype.unshift.call(arguments,r),this.dispatchEvent("onCheckboxClick",arguments)},"click .checkbox-Before":function(e){var t=e.target.outerHTML,i=t.indexOf("instanceid"),n=t.substring(i);n="pid:"+(n=n.replace(/instanceid=\"|">/g,"")),this.dispatchEvent("onCheckboxClickNative",n)},"click .Realized-operation-action-open":function(e){var t=e.target.id,i=this.container.getElement("#"+t);t=t.replace("Realized-Op-Clicked-","");var n=this.RealizedModel.findWhere({id:"pid:"+t});UWA.is(n)&&(i.model=n),i.modelid=t,S.itemView=i,S.itemView.model.get("Access")&&d.getGlobalVariable().isNative?u.DispatchEventToWin("Realized_ContextMenu",t):S.DisplayContextMenu([])},"click .Realized-operation-related-object":function(e){},"dragstart .Realized-tile-collapsed":function(e){var t=this.RealizedModel,i=(e.target,e.target.id.split("-")),n=i[i.length-1],o=parseInt(n),a=t.at(o),s={};s[a.get("id")]=a,Array.prototype.unshift.call(arguments,s),Array.prototype.unshift.call(arguments,{}),this.dispatchEvent("onItemViewDrag",arguments)},"click .Realized-change-targetCA-value-span":function(e){var t=e.target.id;if(t=t.replace("pid:",""),d.getGlobalVariable().is3DSpace){var i=widget.getUrl(),n=(i=i.substring(0,i.indexOf("/enterprisechangemgt")))+"/common/emxTree.jsp?mode=insert&objectId="+t;window.open(n)}else if(d.getGlobalVariable().isNative){var o={TransientCAPid:t};u.DispatchEventToWin("OpenCATransferTo",t)}else{o={X3DContentId:JSON.stringify({protocol:"3DXContent",source:widget.name,data:{items:[{envId:d.getGlobalVariable().tenant,serviceId:"3DSpace",objectId:t}]}}),x3dPlatformId:d.getGlobalVariable().tenant};widget.getValue("appId")&&"ENOWCHG_AP"==widget.getValue("appId")?l.showWidget("ENOWCHG_AP","",o,{mode:"panel",height:800,width:650}):l.showWidget("ENOWCHA_AP","",o,{mode:"panel",height:800,width:650})}}},destroy:function(){this.flowdownActivitiesView&&this.flowdownActivitiesView.destroy(),this._parent.apply(this,arguments)}})},DisplayContextMenu:function(e){var i=this,n=[];if(i.itemView&&i.itemView.model&&i.itemView.model.get("Access")){var o={objectId:i.itemView.model.get("id").replace("pid:",""),objectType:i.itemView.model.get("objectType"),displayName:i.itemView.model.get("objectTitle"),displayType:i.itemView.model.get("type"),facetName:"realized"},a={facetName:"realized",selectedItem:o};p.setSelectedItem(a);var s=[];s.push(o);var r=p.getContentForCompassInteraction(s),l=new c;l.set3DXContent(r,!0);var u=[];if(UWA.is(l.retrieveCompatibleApps,"function")){if(d.getGlobalVariable().is3DSpace&&!window.x3DPlatformServices&&!window.COMPASS_CONFIG){const e=getTopWindow().document.createElement("div");e.id="hiddenDivForCompassInNewWindow",e.style.display="none",getTopWindow().document.body.appendChild(e),window.COMPASS_CONFIG={myAppsBaseUrl:d.getGlobalVariable().baseURL,userId:"",lang:navigator.language,compassTarget:e.id}}l.retrieveCompatibleApps(function(o){o.forEach(function(e){u.push({text:e.text,fonticon:e.fonticon,multisel:!1,handler:e.handler})}),u.length>0&&d.getGlobalVariable().isNative?"true"==d.getGlobalVariable().CHG_OPENWITH&&n.push({id:"OpenWith",text:t.ECM_CA_Command_OpenWith_RichClient,fonticon:"export",icon:"fonticon-export",multisel:!1,items:u}):u.length>0&&n.push({id:"OpenWith",text:t.ECM_CA_Command_OpenWith,fonticon:"export",icon:"fonticon-export",multisel:!1,items:u}),d.getGlobalVariable().isNative||"false"==d.getGlobalVariable().CHG_OPEN_WITH_COLLAB||n.push({id:"Details",text:t.ECM_CA_Explore_With_Central,fonticon:"window",icon:"fonticon-window",multisel:!0,handler:function(){if(d.getGlobalVariable().is3DSpace){var e=i.itemView.modelid,t=widget.getUrl(),n=(t=t.substring(0,t.indexOf("/enterprisechangemgt")))+"/common/emxTree.jsp?objectId="+e;(o=window.open()).opener=null,o.location.href=n}else{n="/common/emxTree.jsp?mode=insert&objectId="+(e=i.itemView.modelid);var o,a=d.getGlobalVariable().getSecurityContext().replace("ctx::",""),s=d.getGlobalVariable().computeUrl("/common/emxFrameworkContextManager.jsp?SecurityContext="+a+"&forwardUrl="+n);(o=window.open()).opener=null,o.location.href=s}}});var a={id:"Compare",text:t.ECM_COMPARE_PREVIOUS,fonticon:"compare-on",icon:"I_Compare",multisel:!1,handler:function(e){var t=UWA.is(i.itemView.Instanceid)?i.itemView.Instanceid:i.itemView.modelid,n=[];n.push(t);i.itemView.model.get("amo").forEach(function(e){e.operation.forEach(function(t){if((t=t.trim()).indexOf("NewMinorVersion")>-1||t.indexOf("NewVersion")>-1||t.indexOf("Clone")>-1||t.indexOf("NewEvolution")>-1){var i=e.before&&e.before.id?e.before.id.replace("pid:",""):"";return n.push(i),void!0}})}),p.openCompareApp(n)}};i.itemView.model&&!0===i.isCompareCmdAllowed()&&1!=d.getGlobalVariable().isNative&&1!=d.getGlobalVariable().is3DSpace&&n.push(a);var s={id:"Properties",text:t.ECM_CA_Properties,fonticon:"attributes",icon:"I_ChangeCnxObjProps",multisel:!0,handler:function(e){var t=UWA.is(i.itemView.Instanceid)?i.itemView.Instanceid:i.itemView.modelid;h.createPropertiesComponent(t)}};n.push(s),w.getDocuments([i.itemView.model.get("id").slice("4")]).then(function(o){var a={id:"download",text:t.ECM_CA_Download,fonticon:"download",icon:"I_ChangeCnxObjDownload",multisel:!0,handler:function(e){var t=i.itemView.model.get("id").slice("4"),n=[];n.push(t);w.download(n)}},s={id:"preview",text:t.ECM_CA_Preview,fonticon:"eye",icon:"I_ChgPreviewIcon",multisel:!0,handler:function(e){var t=i.itemView.model.get("id").slice("4"),n=[];n.push(t),w.preview(n)}};i.itemView&&i.itemView.model&&"TRUE"===o[0].dataelements.isDocumentType&&(n.push(a),n.push(s)),n.push.apply(n,e),p._initDropDown(n,S.itemView)})})}}},isCompareCmdAllowed:function(){var e=!1,t=this.itemView.model.get("amo");return t?(t.forEach(function(t){t.operation.forEach(function(t){((t=t.trim()).indexOf("NewMinorVersion")>-1||t.indexOf("NewVersion")>-1||t.indexOf("Clone")>-1||t.indexOf("NewEvolution")>-1)&&(e=!0)})}),e):e},expandTile:function(e){this.makeActivitiesView(this.container.RealizedModel.at(e),e);var t=this.container.getElement("#Realized-expanded-"+e);if(t){var i=t.className;if(i.indexOf("hidden")>0){t.className=i.replace("hidden","").trim(),this.selectedTilesIDs.push(e);var n=t.getElement(".Realized-title-name");UWA.is(n)&&(n.className=n.className.replace("hidden","").trim())}else if(t.className=i+" hidden",UWA.is(this.selectedTilesIDs))for(var o=this.selectedTilesIDs.length-1;o>=0;o--)if(this.selectedTilesIDs[o]===e){this.selectedTilesIDs.splice(o,1);break}}var a=this.container.getElement("#Realized-collapsed-"+e);a&&(a.style.borderBottom.indexOf("hidden")>=0?a.style.borderBottom="":a.style.borderBottom="hidden"),window.matchMedia("(max-width: 768px)").matches&&S.resizeForMobile(e)},makeActivitiesView:function(e,t){var i=this,n="#Realized-expanded-"+t,o=this.container.getElement(n);if(o){if(o.getElement(".realized-activity-details"))return;var r={idcardView:!1,activityModels:e,activityIdx:t,caModel:this.container.caModel,flowdownOptions:this.container.flowdownOptions},l=null;l=this.container.flowdownOptions&&this.container.flowdownOptions.isFromProposedFlowdown?this.flowdownActivitiesView=new s(r):new(a._createView_NewRealizedActivity(r));var c={onContextMenu:function(e){S.itemView=e,S.itemView.Access&&d.getGlobalVariable().isNative?u.DispatchEventToWin("Realized_ContextMenu",S.itemView.modelid):S.DisplayContextMenu([])},onItemViewDrag:function(){i.dispatchEvent("onItemViewDrag",arguments)},activityCheckBoxClicked:function(){i.dispatchEvent("activityCheckBoxClicked",arguments)},flowDownActivityObjects:function(){i.dispatchEvent("flowDownActivityObjects",arguments)},transferSelectedItems:function(){this.dispatchEvent("transferSelectedItems",arguments)},ignoreSelectedItems:function(){this.dispatchEvent("ignoreSelectedItems",arguments)}};this.container.listenTo(l,c),i.container.injectSubView(l,n)}},resizeForMobile:function(e){var t,i=this.container.getElement("#info-text-"+e);(i&&i.setStyles({"flex-direction":"column"}),i=this.container.getElement("#Realized-change-info-text-1-"+e))&&((t=i.className).indexOf("hidden")>0?i.className=t.replace("hidden","").trim():i.className=t+" hidden");(i=this.container.getElement("#Realized-transfer-info-text-1-"+e))&&((t=i.className).indexOf("hidden")>0?i.className=t.replace("hidden","").trim():i.className=t+" hidden");(i=this.container.getElement("#Realized-title-name-"+e))&&((t=i.className).indexOf("hidden")>0?i.className=t.replace("hidden","").trim():i.className=t+" hidden");(i=this.container.getElement("#Realized-Mobile-Maturity-"+e))&&((t=i.className).indexOf("hidden")>0?i.className=t.replace("hidden","").trim():i.className=t+" hidden");(i=this.container.getElement("#Realized-title-Operation-"+e))&&((t=i.className).indexOf("hidden")>0?i.className=t.replace("hidden","").trim():i.className=t+" hidden")},collapseTiles:function(){if(this.container){for(var e=this.container.getElements(".Realized-tile-expanded"),t=0;t<e.length;t++){(o=(n=e[t]).className).indexOf("hidden")>0||(n.className=o+" hidden")}UWA.is(this.selectedTilesIDs)&&(this.selectedTilesIDs=[]);var i=window.matchMedia("(max-width: 768px)").matches;for(e=this.container.getElements(".Realized-change-info-text"),t=0;t<e.length;t++){var n=e[t];i?n.setStyles({"flex-direction":"column"}):n.setStyles({"flex-direction":"row"})}e=this.container.getElements(".Realized-change-info-text-1");for(t=0;t<e.length;t++){(o=(n=e[t]).className).indexOf("hidden")>0&&!i?n.className=o.replace("hidden","").trim():o.indexOf("hidden")<=0&&i&&(n.className=o+" hidden")}e=this.container.getElements(".Realized-transfer-info-text-1");for(t=0;t<e.length;t++){(o=(n=e[t]).className).indexOf("hidden")>0&&!i?n.className=o.replace("hidden","").trim():o.indexOf("hidden")<=0&&i&&(n.className=o+" hidden")}for(e=this.container.getElements(".Realized-title-name"),t=0;t<e.length;t++){(o=(n=e[t]).className).indexOf("hidden")>0&&!i?n.className=o.replace("hidden","").trim():o.indexOf("hidden")<=0&&i&&(n.className=o+" hidden")}for(e=this.container.getElements(".Realized-Mobile-Maturity"),t=0;t<e.length;t++){(o=(n=e[t]).className).indexOf("hidden")>0&&i?n.className=o.replace("hidden","").trim():o.indexOf("hidden")<=0&&!i&&(n.className=o+" hidden")}for(e=this.container.getElements(".Realized-title-Operation"),t=0;t<e.length;t++){var o;(o=(n=e[t]).className).indexOf("hidden")>0&&i?n.className=o.replace("hidden","").trim():o.indexOf("hidden")<=0&&!i&&(n.className=o+" hidden")}}},deactivateMultisel:function(){for(var e=S.container.container,t=e.getElements(".Realized-actions-container"),i=0;i<t.length;i++){t[i].removeClassName("no-actions")}var n=e.getElements(".Realized-accordion-div-inner"),o=e.getElements(".Realized-checkbox-accord");for(i=0;i<n.length;i++){var a=n[i];a.removeClassName("hidden");var s=a.getElementsByTagName("span")[0].className;s.indexOf("expand-down")>0&&(a.getElementsByTagName("span")[0].className=s.replace("down","right").trim());var r=o[i];r.checked&&(r.click(),r.checked=!1),r.addClassName("hidden")}var l=e.getElements(".Realized-tile-collapsed");for(i=0;i<l.length;i++){l[i].removeClassName("selected-border")}},activateMultisel:function(){for(var e=S.container.container,t=e.getElements(".Realized-actions-container"),i=0;i<t.length;i++){t[i].addClassName("no-actions")}var n=e.getElements(".Realized-accordion-div-inner"),o=e.getElements(".Realized-checkbox-accord");for(i=0;i<n.length;i++){var a=n[i];o[i].removeClassName("hidden"),a.addClassName("hidden")}var s=e.getElements(".Realized-tile-collapsed");for(i=0;i<s.length;i++){s[i].style.borderBottom=""}},selectAll:function(){this.activateMultisel();var e=S.container.container,t=e.getElements(".Realized-checkbox-accord"),i=e.getElements(".checkbox-Before"),n=e.getElements(".Realized-tile-expanded.hidden");if(i.length>0&&0==n.length)for(var o=0;o<i.length;o++){(a=i[o]).checked||a.click()}else for(o=0;o<t.length;o++){var a;(a=t[o]).checked||a.click()}},UnselectAll:function(){var e=S.container.container,t=e.getElements(".Realized-checkbox-accord"),i=e.getElements(".checkbox-Before"),n=e.getElements(".Realized-tile-expanded.hidden");if(i.length>0&&0==n.length)for(var o=0;o<i.length;o++){(a=i[o]).checked&&a.click()}else for(o=0;o<t.length;o++){var a;(a=t[o]).checked&&a.click()}},onResize:function(){var e=this.selectedTilesIDs;S.collapseTiles(),UWA.is(e)&&e.forEach(function(e,t){S.expandTile(e)})},expandAllActivity:function(){for(var e=S.container.container,t=e.getElements(".Realized-accordion-div-inner"),i=e.getElements(".Realized-tile-expanded.hidden"),n=[],o=0;o<t.length;o++){var a=t[o];a.children[0].className.indexOf("expand-right")>0?a.children[0].click():i.length>0&&a.children[0].click(),n.push(a.children[0].id)}setTimeout(function(){for(var t=0;t<n.length;t++){var i=n[t];e.getElements("#Realized-expanded-"+i)[0].getElements(".fonticon-select-all")}},500)},collapseAllActivity:function(){for(var e=S.container.container,t=e.getElements(".Realized-accordion-div-inner"),i=e.getElements(".Realized-tile-expanded.hidden"),n=0;n<t.length;n++){var o=t[n];o.children[0].className.indexOf("expand-down")>0?o.children[0].click():0==i.length&&o.children[0].click();var a=o.children[0].id;e.getElements("#Realized-expanded-"+a)[0].getElements(".fonticon-select-none")}}};return S}),define("DS/ENOChangeActionUX/scripts/Views/CANewRealizedView",["UWA/Class/View","DS/ENOChangeActionUX/scripts/Views/CARealizedOperationView","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/Handlebars/Handlebars4","DS/W3DXComponents/Views/Item/CounterView","DS/W3DXComponents/Views/Item/ActionsInlineView","DS/W3DXComponents/Collections/ActionsCollection","DS/W3DXComponents/Views/Item/MultiselView","DS/ENOChangeActionUX/scripts/Collection/CARealizedCollection","DS/ENOChangeActionUX/scripts/Views/CAProposedSearchFilterView","DS/ENOChangeActionUX/scripts/Views/CASlideInTransferRealizedView","DS/ENOChangeActionUX/scripts/Views/CATransferRealizedForm","DS/ENOChangeActionUX/scripts/Views/CAFlowDownRealizedForm","DS/ENOChangeActionUX/scripts/CASpinner","DS/ENOChangeActionUX/scripts/Services/CARealizedViewServices","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgIDCardHeaderServices","DS/ENOChgServices/scripts/services/ChgRealizedServices","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/ENOChgRouter5/scripts/ChgRouter","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/PlatformAPI/PlatformAPI","DS/ENOChgGovernanceUX/scripts/wrapper/ChgGovBIFilter","DS/UIKIT/DropdownMenu","DS/ENOChangeActionUX/scripts/CACommonIgnore","DS/ENOChgServices/scripts/services/ChgDataService","require","DS/ENOChgGovernanceUX/scripts/util/DocumentUtils"],function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v,A,w,b,S,y,_,E,D,O,N,M,I,x,T){"use strict";var V={sortingFirstTime:!0,filteredText:"",_tempReferenceToWinSearchCallback:null,realizedCollection:new d,invokedFrom:"",filteredObjectIds:null,filteredActivities:null,groupid:void 0,_createView_NewRealized:function(n,o,d,m,I){return e.extend({name:"changeView",tagName:n,className:o,currModel:null,model:m,flowdownOptions:I,filteredText:I.objNametoFilterforFlowDown,RealizedModel:null,modelsToRemove:[],selectedOperationItems:[],setup:function(){var e=this;V.Realized_Filter_Map=b.getCARealizedFilterMapping(),V.lastFilterView=null,V.isGroupSelectionActive=!1,V.groupid=void 0,V.filteredObjectIds=void 0,V.filteredActivities=void 0,D.unsubscribe("ca-realized-collection-updated"+widget.id+this.model.id),D.unsubscribe("ca-IDCard-on-change-refresh"),D.unsubscribe("ca-IDCard-on-change-maturity"),D.subscribe("ca-realized-collection-updated"+widget.id+this.model.id,function(t){e.render(),e.resetText()}),D.subscribe("ca-IDCard-on-change-refresh",function(e){V.updateRealizedCollection(e)}),D.unsubscribe(`caRealizedChanges:${widget.id}`),D.unsubscribe(`caRealizedChanges of ${widget.id}`),D.subscribe(`caRealizedChanges:${widget.id}`,function(){require(["DS/ENOChgGovernanceUX/scripts/wrapper/ChgGovBIFilter"],function(e){e._initializationPromiseBIFilter||e.initializeBIFilter(),e._cleanBIFilterProxy(),e.cleanPathTag();for(var t=[],i=V.getRealizedCollection(),n=0;n<i.length;n++){var o=i.at(n);if(o){var a=o.get("id");a=a.replace("pid:",""),t.push(a),o.get("activities").forEach(function(e){e.get("ActivityDetails").forEach(function(e){if(!e.sameAsWhere){if(e.AfterExists){var i=e.After.id;i=i.replace("pid:",""),t.push(i)}if(e.BeforeExists){var n=e.Before.id;n=n.replace("pid:",""),t.push(n)}}})})}}e._onSetPathTagsForProposedRealized(t,{options:{id:"caRealizedChanges"}})})}),D.subscribe(`caRealizedChanges of ${widget.id}`,function(t){for(var i=t.matchingIDs,n=[],o=0;o<i.length;o++)n.push("pid:"+i[o]);V.filteredObjectIds=n,e.filterRealizedCollection()}),D.subscribe("ca-IDCard-on-change-maturity",function(e){V.updateRealizedCollection(e)}),g.isWaiting()||g.doWait(widget.body),this.template='                                            <div class="'+this.getClassNames("-container")+'">                                            <div class="Realized-Operations-header">                                                     <div class="'+this.getClassNames("-RealizedCounter")+'"></div>                                                    <div class="'+this.getClassNames("-RealizedActions")+'"></div>                                                    <div class="'+this.getClassNames("-realizedMultisel")+'"></div>                                               </div>                                               <div class="'+this.getClassNames("-Search-container")+'"></div>                                              <div class="'+this.getClassNames("-Realizedoperation-container")+'"></div>                                            <div>',V.invokedFrom=this.model.invokedFrom,V.id=this.model.id,this.loadFilteredRealizedData(V.Realized_Filter_Map.DEFAULT)},initSubViews:function(){this._initActionsView(),this._initCounterView(),null!=V.lastFilterView&&"DEFAULT"!==V.lastFilterView||this._initMultiSelView(),this._initSearchFilterView(this.originalRealizedCollection),this._initOperationView(this.originalRealizedCollection)},resetText:function(){this.filteredText="",this.filteredRealizedCollection=new UWA.Class.Collection(this.originalRealizedCollection.toArray())},render:function(){console.log("Realized Rendering Started"),C.getGlobalVariable().allSelectedActivity=[],C.getGlobalVariable().allSelectedActivityId=[],this.currModel=this.model,A.setCurrModel(this.model);var e=V.getRealizedCollection(),n=this;"gov"!=V.invokedFrom&&(this.listenTo(this.currModel,"onChange:realized",this.render),e&&this.listenTo(this.currModel,"onChange:realized",this.resetText)),this.originalRealizedCollection=e,n.initSubViews(),this.renderer=this.getTemplate(this.template);var o=this.name,a=(this.cid,null);UWA.is(this.containerReference)&&(a=this.containerReference.getElement(".main-Realized-change-container"),UWA.is(a)&&(a.empty(),a.destroy(),a=null)),this.containerReference=this.container,UWA.is(a)||(a=this.mainContainerDiv=UWA.createElement("div",{class:"main-Realized-change-container",styles:{width:"100%",height:"100%"}})),a.addEvent("resize",function(){setTimeout(function(){t.onResize()},50)});var s=this.renderer();a.addContent(s),a.inject(this.containerReference),this.injectSubView(this.counterView,"."+o+"-RealizedCounter"),this.injectSubView(this.actionsView,"."+o+"-RealizedActions"),this.injectSubView(this.searchFilterView,"."+o+"-Search-container"),this.injectSubView(this.operationView,"."+o+"-Realizedoperation-container"),this.actionsView&&this.actionsView.dispatchEvent("onShow"),this.counterView&&this.counterView.dispatchEvent("onShow"),null!=V.lastFilterView&&"DEFAULT"!==V.lastFilterView||(this.injectSubView(this.realizedMultiSelView,"."+o+"-realizedMultisel"),this.realizedMultiSelView&&this.realizedMultiSelView.dispatchEvent("onShow"));n=this;V.filterViewMenu=new N({target:a.querySelector("div.changeView-RealizedActions span.fonticon-list-filter"),multiSelect:!1,closeOnClick:!0,items:[{name:"DEFAULT",text:i.ECM_CA_Filter_Realized_Menu_Default,selected:null==V.lastFilterView||"DEFAULT"===V.lastFilterView,selectable:!0},{name:"TRANSFERRED",text:i.ECM_CA_Filter_Realized_Menu_Transferred,selected:"TRANSFERRED"===V.lastFilterView,selectable:!0},{name:"IGNORED",text:i.ECM_CA_Filter_Realized_Menu_Ignored,selected:"IGNORED"===V.lastFilterView,selectable:!0}],events:{onClick:function(e,t){t=V.filterViewMenu.getSelectedItems()[0];var i=1;switch(V.lastFilterView=t.name,t.name){case"DEFAULT":i=V.Realized_Filter_Map.DEFAULT;break;case"TRANSFERRED":i=V.Realized_Filter_Map.TRANSFERRED;break;case"IGNORED":i=V.Realized_Filter_Map.IGNORED}n.loadFilteredRealizedData(i)}}});var r=[];V.getFilterValuesByOperation().forEach(function(e,t){r.push({name:t,text:e.actDisplayName,selected:!1,selectable:!0})}),V.filterOperationViewMenu=new N({target:a.querySelector("div.changeView-RealizedActions span.fonticon-filter"),multiSelect:!0,closeOnClick:!0,items:r,events:{onClick:function(e,t){var i=V.filterOperationViewMenu.getSelectedItems(),o=[];i.forEach(function(e,t){o.push(e.name)}),V.filteredActivities=o,n.filterRealizedCollection()}}})},loadFilteredRealizedData:function(e){var t=this;b.getCARealizedData(this.model.id,e).then(function(e){if(e.changeaction.group&&e.changeaction.group.id&&(V.groupid=e.changeaction.group.id),Array.isArray(e.changeaction.context)&&e.changeaction.context.length>0&&(V.context=e.changeaction.context),UWA.is(e.changeaction.realized)){var i=f.createRealizedCollection(e.changeaction.realized);b.enrichCollectionForRealized(i).then(function(e){t.model&&(V.setRealizedCollection(e,t.model.id),(t.model.isSelected||t.model.get("isSelected"))&&require(["DS/ENOChgGovernanceUX/scripts/wrapper/ChgGovBIFilter"],function(e){e._initializationPromiseBIFilter||e.initializeBIFilter(),e._cleanBIFilterProxy(),e.cleanPathTag();for(var t=[],i=V.getRealizedCollection(),n=0;n<i.length;n++){var o=i.at(n);if(o){var a=o.get("id");a=a.replace("pid:",""),t.push(a),o.get("activities").forEach(function(e){e.get("ActivityDetails").forEach(function(e){if(!e.sameAsWhere){if(e.AfterExists){var i=e.After.id;i=i.replace("pid:",""),t.push(i)}if(e.BeforeExists){var n=e.Before.id;n=n.replace("pid:",""),t.push(n)}}})})}}e._onSetPathTagsForProposedRealized(t,{options:{id:"caRealizedChanges"}})}))})}})},injectSubView:function(e,t){var i=this.containerReference.getElement(t);e&&i&&i.grab(e.render().getContent())},getTemplate:function(e){var t=a.compile(e),n=[];this.activitiesViewArr=[],UWA.is(this.originalRealizedCollection)&&this.originalRealizedCollection.forEach(function(e,t){n.push({})}),this.data={RealizedNls:i.ECM_CA_RealizedChanges,RealizedNum:n.length,changes:n};var o=this;return function(){return t(o.data)}},_initCounterView:function(e){this.counterView&&this.counterView.destroy(),this.counterView=new s({title:i.ECM_CA_RealizedChanges,collection:UWA.is(e)?e:this.originalRealizedCollection})},_initActionsView:function(){var e=i.ECM_CA_Sort_ProposedChanges_Title,n=[];A.getCurrentModel();V.groupid&&"true"==C.getGlobalVariable().CHG_CHANGE_GROUP&&0==C.getGlobalVariable().is3DSpace&&n.push({id:"contextRealized",title:1==V.isGroupSelectionActive?i.ECM_CA_REALIZED_CONTEXT_REALIZED_TOOLTIP:i.ECM_CA_REALIZED_GROUP_REALIZED_TOOLTIP,icon:1==V.isGroupSelectionActive?"checkbox-on":"select-all-checkboxes",overflow:!1}),n.push({id:"search",title:i.ECM_CA_Search_RealizedChanges,icon:"search",overflow:!1},{id:"sort",title:e,icon:"sort-alpha-asc",overflow:!1},{id:"ExpandMenu",title:i.ECM_CA_Expand,icon:"flow-tree-expand-down",overflow:!1}),null!=V.lastFilterView&&"DEFAULT"!==V.lastFilterView||n.push({id:"SelectAll",title:i.SelectAll,icon:"select-all",overflow:!1},{id:"UnSelectAll",title:i.UnSelectAll,icon:"select-none",overflow:!1},{id:"filterOperationView",title:i.ECM_CA_Filter_Realized_Operations,icon:"filter",overflow:!1}),n.push({id:"filterView",title:i.ECM_CA_Filter_Realized,icon:"list-filter",overflow:!1});var o=new l(n);this.actionsView&&this.actionsView.destroy(),this.actionsView=new r({collection:o});var a=this._actionsViewEvents={onActionClick:function(){var e=arguments[1].model.get("id"),i=(arguments[1].model.get("title"),document.getElementsByClassName("fonticon fonticon-flow-tree-expand-down")),n=!0;switch(0!=i.length?n=!1:i=document.getElementsByClassName("fonticon fonticon-flow-tree-expand-up"),e){case"contextRealized":this.handleGroupRealized();break;case"sort":this.sortRealized();break;case"search":this.searchRealized(this);break;case"ExpandMenu":if(this.multiSelView){var o=document.getElementsByClassName("fonticon fonticon-select-all"),a=document.getElementsByClassName("fonticon fonticon-select-none");if(0!=o.length&&0!=a)var s=this.disableIcon(o,"select-all"),r=this.disableIcon(a,"select-none");"Expand All"===this.actionTitle?(this.expand=!1,this.actionTitle="Collapse All",C.getGlobalVariable().isNative||0!=o.length&&0!=a.length&&(s.removeAttribute("style"),r.removeAttribute("style")),t.collapseAllActivity()):(this.expand=!0,this.actionTitle="Expand All",C.getGlobalVariable().isNative||0!=o.length&&0!=a.length&&(this.disableIconStyle(s),this.disableIconStyle(r)),t.expandAllActivity()),this.changeExpandIcon(i,n)}break;case"SelectAll":if(this.multiSelView){if(O._deactivate(),0!=(c=document.getElementsByClassName("fonticon fonticon-flow-tree-expand-down")).length){var l=this.disableIcon(c,"expand-down");this.disableIconStyle(l)}t.selectAll()}break;case"UnSelectAll":var c;if(this.multiSelView)if(O._activate(),t.UnselectAll(),this.multiSelView.exitMultisel(),this.multiSelView.dispatchEvent("onMultiselOff",[this.multiSelView,!1]),0!=(c=document.getElementsByClassName("fonticon fonticon-flow-tree-expand-down")).length)(l=this.disableIcon(c,"expand-down")).removeAttribute("style");break;case"filterView":V.filterViewMenu.show();break;case"filterOperationView":V.filterOperationViewMenu.show()}}};this.listenTo(this.actionsView,a)},TransferRealized:function(e){var t=this,n=t.model.get("userAccess");if(e&&e.ids.length>0){var o={ids:e.ids,contextCAId:t.model.get("id"),Mode:e.mode,Entity:"ChangeAction",RealizedTransferBit:n.RealizedTransfer,callback:function(){C.getGlobalVariable().arrOid=[],t.loadFilteredRealizedData(V.Realized_Filter_Map.DEFAULT)}},a=new h(o),s=new u({invokedFrom:V.invokedFrom});s.buildSlideIn(a),s.showSlideIn()}e&&e.incorrectSelectedIds&&e.incorrectSelectedIds.length>0&&(e.incorrectSelectedIds.length==t.modelsToRemove.length?v.error(i.ECM_CA_Invalid_Selection_Error):v.warn(i.ECM_CA_Invalid_Selection_Warning))},handleGroupRealized:function(){var e=document.getElementsByClassName("fonticon fonticon-select-all-checkboxes");g.doWait(widget.body);var t=A.getCurrentModel();t.get("id").replace("pid:","");0!=e.length&&V.groupid?(V.isGroupSelectionActive=!0,b.getGroupCARealizedData(V.groupid).then(function(e){if(UWA.is(e.realized)){var i=f.createRealizedCollection(e.realized);b.enrichCollectionForRealized(i).then(function(e){V.setRealizedCollection(e,t.id)})}})):(V.isGroupSelectionActive=!1,b.getCARealizedData(t.id,V.Realized_Filter_Map.DEFAULT).then(function(e){if(V.lastFilterView="DEFAULT",UWA.is(e.changeaction.realized)){var i=f.createRealizedCollection(e.changeaction.realized);b.enrichCollectionForRealized(i).then(function(e){V.setRealizedCollection(e,t.id)})}}))},changeShowGroupIcon:function(e,t){e.length>0&&(e[0].className=t?"fonticon fonticon-select-all-checkboxes":"fonticon fonticon-checkbox-on")},sortRealized:function(){var e=new UWA.Class.Collection,t=document.getElementsByClassName("fonticon fonticon-sort-alpha-asc"),i=!0;0!=t.length?i=!1:t=document.getElementsByClassName("fonticon fonticon-sort-alpha-desc");var n,o=[],a=[],s=[],r={};if((n=(c=this).filteredRealizedCollection?c.filteredRealizedCollection:c.originalRealizedCollection).length>0){var l=[];n.sortBy(function(e,t,i){var l=e.get("objectTitle"),c=e.get("revision").toLowerCase(),d=l.toLowerCase()+c;r[d]=l,a.push(d),a.sort(),i.length-1===t&&a.forEach(function(e){var t=r[e];s=n.where({objectTitle:t}),Array.isArray(s)&&s.forEach(function(t){t&&null==t.get("IdentifierWithRevision")?o.push(t):t&&t.get("IdentifierWithRevision")&&t.get("IdentifierWithRevision").toLowerCase()===e&&o.push(t)})})}),l=o,i||1==V.sortingFirstTime||l.reverse();e=new UWA.Class.Collection(l);this.filteredRealizedCollection?this.filteredRealizedCollection=e:this.originalRealizedCollection=e,document.querySelector(".Realized-operations-details").innerHTML="";var c=this;g.doWait(widget.body),setTimeout(function(){c.operationView.destroy();c.operationView=c._initOperationView(e);c.injectSubView(c.operationView,"."+c.name+"-Realizedoperation-container"),g.endWait(widget.body)},100),this.RealizedModel=e,null!=V.lastFilterView&&"DEFAULT"!==V.lastFilterView||(this.realizedMultiSelView.destroy(),this._initMultiSelView(),this.injectSubView(this.realizedMultiSelView,"."+this.name+"-realizedMultisel"),this.selectedOperationItems.splice(0,this.selectedOperationItems.length),this.modelsToRemove.splice(0,this.modelsToRemove.length)),!1===V.sortingFirstTime&&this.changeSortIcon(t,i),V.sortingFirstTime=!1}},changeSortIcon:function(e,t){e.length>0&&(e[0].className=t?"fonticon fonticon-sort-alpha-asc":"fonticon fonticon-sort-alpha-desc")},changeExpandIcon:function(e,t){e.length>0&&(e[0].className=t?"fonticon fonticon-flow-tree-expand-down":"fonticon fonticon-flow-tree-expand-up")},disableIconStyle:function(e){e.setStyle("pointer-events","none"),e.setStyle("color","#b4b6ba")},disableIcon:function(e,t){for(var i=0;i<=e.length;i++){var n=0;if(e[i].offsetParent&&e[i].outerHTML.includes(t)&&e[i].offsetParent.outerHTML.includes("action-container")){n=i;break}}return e[n].closest(".action-container")},searchRealized:function(e){document.getElementsByClassName("search-main-container");var t=e.containerReference.getElement(".search-main-container");if(t.hasClassName("hidden")){t.removeClassName("hidden");var i=t.getElement(".searchfilter-input-container");i.addClassName("highlighted-border"),i.removeClassName("border-without-focus"),t.getElement("input").focus()}else t.addClassName("hidden");var n=t.hasClassName("hidden"),o=e.containerReference.getElement(".main-Realized-operation-container");!n&&o?o.setStyle("height","calc(100% - 100px)"):o&&o.setStyle("height","calc(100% - 50px)")},_initOperationView:function(e){this.operationView&&this.operationView.destroy();var i={tagName:"div",className:"Realized-operations-details",idcarView:!1,caModel:this.model,realizedModel:e,flowdownOptions:this.flowdownOptions},n=this.operationView=new(t._createView_NewRealized(i)),o=this,a=this._operationsEvents={onCheckboxClick:function(e){var i=this.selectedOperationItems.indexOf(e.cid);if(-1===i)this.selectedOperationItems.push(e.cid),this.modelsToRemove.push(e),O._deactivate();else if(this.selectedOperationItems.splice(i,1),this.modelsToRemove.splice(i,1),0===this.modelsToRemove.length){t.deactivateMultisel(),O._activate();var n=document.getElementsByClassName("fonticon fonticon-flow-tree-expand-down");if(0!=n.length)this.disableIcon(n,"expand-down").removeAttribute("style")}if(this.multiSelView){var o={isActive:!0};o.selectedObjects=this.modelsToRemove,this.multiSelView.destroyDropDown();var a=[];if(C.getGlobalVariable().isNative){for(var s=0;s<o.selectedObjects.length;s++){var r;r=o.selectedObjects[s].id,a.push(r.replace("pid:",""))}V.operationsToExplore=this.modelsToRemove,S.DispatchEventToWin("MultiSel_ExpInCtx_RealizedOperation_CmdChk",a)}else this.multiSelView.buildMultisel(o);let e=V.id.slice(4),t=[];for(let e=0;e<o.selectedObjects.length;e++){let i={id:o.selectedObjects[e].id.slice(4)},n=new E({grid:i});t.push(n)}if(0==o.selectedObjects.length){let e=new E({});t.push(e)}(new _).addRoot(t),0!=o.selectedObjects.length&&t[0].getTreeDocument().selectAll(),y.getDependency("applicationChannel").publish({event:"update-property-panel-data",data:{context:t[0],PhysicalID:e,type:"ChangeAction",load:!0}})}},onItemViewDrag:function(){var e;e=this.buildStructureToDragForOperation(arguments),arguments[1]=e;var t=V.context,i=[];Array.isArray(t)&&t.forEach(function(e){var t=e.id;t&&i.push(t.substr(4))});var n={caId:o.model.get("id"),caContextIds:i,typeOfDrag:"Realized"};A.onItemViewDragForContents(arguments,n)},transferSelectedItems:function(){var e=arguments[0];if(e&&e.selectedIDs.length>0){var t={ids:e.selectedIDs,mode:e.transferMode};o.TransferRealized(t)}},ignoreSelectedItems:function(){o.loadFilteredRealizedData(V.Realized_Filter_Map.DEFAULT)},onCheckboxClickNative:function(e){if(this.multiSelView){var t={isActive:!0};this.modelsToRemove.push(e),t.selectedObjects=this.modelsToRemove,this.multiSelView.destroyDropDown(),C.getGlobalVariable().isNative&&this.multiSelView.buildMultisel(t)}}};return this.listenTo(n,a),n},buildStructureToDragForOperation:function(e){var t={};if(this.modelsToRemove.length)for(var i in this.modelsToRemove){var n=this.modelsToRemove[i];n&&(t[n.get("id")]=n)}else t=e[1];return t},AfterSaveTransReal:function(e){},_initSearchFilterView:function(){this.searchFilterView&&this.searchFilterView.destroy();var e=this.searchFilterView=new p({fromIDCard:!1,collection:this.originalRealizedCollection,placeholder:i.ECM_CA_Searchby_NameTitle}),t=this._operationsEvents={keyup:function(e){this.refineRealized(e)}};this.listenTo(e,t)},refineRealized:function(e){var t=e.target.value;V.enteredText=t,this.filterRealized()},filterRealized:function(){this.filteredRealizedCollection&&this.filteredRealizedCollection.length&&this.filteredRealizedCollection.reset();var e=this.originalRealizedCollection.filter(this.filterNameBased);this.filteredRealizedCollection=new UWA.Class.Collection(e);var t=document.querySelector(".Realized-operations-details");t||t.destroy();var i=this;if(g.doWait(widget.body),setTimeout(function(){i.operationView.destroy();i.operationView=i._initOperationView(i.filteredRealizedCollection);i.injectSubView(i.operationView,"."+i.name+"-Realizedoperation-container"),g.endWait(widget.body)},100),this.counterView.destroy(),this._initCounterView(this.filteredRealizedCollection),this.injectSubView(this.counterView,"."+this.name+"-RealizedCounter"),null!=V.lastFilterView&&"DEFAULT"!==V.lastFilterView||(this.realizedMultiSelView.destroy(),this._initMultiSelView(),this.injectSubView(this.realizedMultiSelView,"."+this.name+"-realizedMultisel"),this.selectedOperationItems.splice(0,this.selectedOperationItems.length),this.modelsToRemove.splice(0,this.modelsToRemove.length)),!C.getGlobalVariable().is3DSpace)this.filteredRealizedCollection},filterNameBased:function(e){var t=!1,i=e.get("objectName"),n=e.get("objectTitle"),o=V.enteredText;if(o&&o.length){O._deactivate(),i&&(i=i.toLowerCase()),n&&(n=n.toLowerCase()),o=o.toLowerCase();var a=i.indexOf(o);if(a<0&&(a=n.indexOf(o)),t=a>=0,""===V.filteredText)e.get("activities").forEach(function(e){var i=[],n=e.get("OriginalActivityDetails")[0];if(1==t&&n.sameAsWhere)i.push(n);else{var a=-1;if(n.AfterExists){var s=e.get("Afterobject"),r=s.name,l=s.title;if(r&&(r=r.toLowerCase()),l&&(l=l.toLowerCase()),(a=r.indexOf(o))<0&&(a=l.indexOf(o)),a<0&&s.instanceName)a=s.instanceName.toLowerCase().indexOf(o.toLowerCase())}if(a<0&&n.BeforeExists){var c=e.get("Beforeobject");r=c.name,l=c.title;if(r&&(r=r.toLowerCase()),l&&(l=l.toLowerCase()),(a=r.indexOf(o))<0&&(a=l.indexOf(o)),a<0&&c.instanceName)a=c.instanceName.toLowerCase().indexOf(o.toLowerCase())}a>=0&&i.push(n)}i.length>0&&(t=!0),e.set("ActivityDetails",i,{silent:!0})})}void 0!==o&&0!==o.length||(e.get("activities").forEach(function(e){var t=e.get("OriginalActivityDetails");e.set("ActivityDetails",t,{silent:!0})}),t=!0,O._activate());if(1==t)return e},_initMultiSelView:function(){var e=this,i={collection:new l,withMultisel:!0,useInfiniteScroll:!1,usePullToRefresh:!1,buildMultiselActions:function(t){return e.getMultiselActions(t)},events:{onMultiselOff:function(){O._activate(),t.deactivateMultisel(),e.modelsToRemove.splice(0,e.modelsToRemove.length),e.selectedOperationItems.splice(0,e.selectedOperationItems.length),this.isInMultiselMode=!1;var i=document.getElementsByClassName("fonticon fonticon-flow-tree-expand-down");0!=i.length&&e.disableIcon(i,"expand-down").removeAttribute("style")},onMultiselOn:function(){O._deactivate(),t.activateMultisel(),this.isInMultiselMode=!0;var i=document.getElementsByClassName("fonticon fonticon-flow-tree-expand-down");if(0!=i.length){var n=e.disableIcon(i,"expand-down");e.disableIconStyle(n)}},onActionClickDotted:function(){var e=widget.body.getParent("body");e&&e.addClassName("for-mobile")}}};this.multiSelView&&this.multiSelView.destroy(),this.modelsToRemove.splice(0,this.modelsToRemove.length),this.selectedOperationItems.splice(0,this.selectedOperationItems.length),this.multiSelView=this.realizedMultiSelView=new c(i),V.multiSelView=this.multiSelView},getMultiselActions:function(e){var t,n=this,o=[],a=C.getGlobalVariable().isNative;if(a&&e.result&&(t=!0),t||!a){var s={id:"ignore",text:i.ECM_CA_Realized_Ignore_Change,fonticon:"ignore",icon:"I_ChangeIgnore_22",multisel:!0,handler:function(e){var t=[];n.modelsToRemove.length&&n.modelsToRemove.forEach(function(e,i){t.push(e.get("id"))});var o={originChangeActionId:A.getCurrentModel().id,idsToReject:t};M.ignoreNodes(o,widget.body,function(e){"success"===e.status&&(C.getGlobalVariable().arrOid=[],n.loadFilteredRealizedData(V.Realized_Filter_Map.DEFAULT),v.success(i.ECM_CA_Realized_Ignore_Success),g.endWait(widget.body))},function(e,t){g.endWait(widget.body),t&&t.errorMessage?v.error(t.errorMessage):v.error(i.ECM_CA_Realized_Ignore_ERR_MSG)})}};(p=n.model.get("userAccess"))&&"true"===p.RealizedReject&&o.push(s);var r=window.matchMedia("(max-width: 768px)"),l=i.ECM_CA_Realized_Transfer_ExistingCA,c=i.ECM_CA_Realized_Transfer_NewCA,d=i.ECM_CA_Realized_Transfer;r.matches&&(l=i.ECM_CA_Existing,c=i.ECM_CA_New,d=i.ECM_CA_Realized_Mobile_Transfer);var p,u={id:"transfer",text:d,fonticon:"sync",icon:"transfer_realized_new",multisel:!0,items:[{id:"Transfer_NewCA",text:c,fonticon:"new-create",icon:"I_FlowDownToNewCA",multisel:!0,handler:function(e){if(n.modelsToRemove.length){var t=[],i=[];n.modelsToRemove.forEach(function(e,n){e.get("Access")&&"Transferred"!=e.get("status")?t.push(e.get("id")):i.push(e.get("id"))})}var o={ids:t,mode:"New",incorrectSelectedIds:i};n.TransferRealized(o)}},{id:"Transfer_existingca",text:l,fonticon:"plus",icon:"I_FlowDownToExisting",multisel:!0,handler:function(e){if(n.modelsToRemove.length){var t=[],i=[];n.modelsToRemove.forEach(function(e,n){e.get("Access")&&"Transferred"!=e.get("status")?t.push(e.get("id")):i.push(e.get("id"))})}var o={ids:t,mode:"Existing",incorrectSelectedIds:i};n.TransferRealized(o)}}]};(p=n.model.get("userAccess"))&&"true"===p.MoveRealizedChange&&o.push(u);var h={id:"download",text:i.ECM_CA_Download,fonticon:"download",icon:"I_ChangeCnxObjDownload",multisel:!0,handler:function(e){var t=[];C.getGlobalVariable().isNative&&(e=e.selectedObjs),e.forEach(function(e){t.push(e.get("id").slice(4))});var n=[];T.getDocuments(t).then(function(e){e.forEach(function(e){"TRUE"===e.dataelements.isDocumentType&&n.push(e.id)}),n.length<t.length&&v.info(i.ECM_CA_Download_Skipped),T.download(n)})}};o.push(h)}var m={id:"changematurity",text:i.ECM_CA_Change_Maturity,fonticon:"promote",icon:"I_ChangeCnxObjPromote",multisel:!0,handler:function(e){w.changeMaturity(e,n.model)}};if("false"!=C.getGlobalVariable().CHG_CHANGE_MATURITY&&o.push(m),UWA.is(e)&&C.getGlobalVariable().isNative){var f=[];if(null==e.result){for(var b=0;b<e.length;b++){var y;y=e[b],f.push(y.replace("pid:",""))}n.exploreRefIds=f}else""!=e.result&&(n.exploreRefIds=e.result.refPid);o.push({id:null,text:i.ECM_CA_Command_ExploreWith,fonticon:null,icon:null,multisel:!0,items:[{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmExploreInContextHdr",icon:"I_FindInContext",multisel:!0,text:i.ECM_CA_Command_ExploreContext,handler:function(e){var t=[],o=[],a=(o=n.exploreRefIds)[0].includes("pid:");a&&n.modelsToRemove.forEach(function(e,i){var n=e.get("id");n&&(n=n.replace("pid:","")),o.indexOf(n)>=0&&t.push(e.get("id").replace("pid:",""))}),a||(t=o),t&&t.length>0?S.DispatchEventToWin("MultiSelMenu_ExploreInContext_New",t):v.error(i.ECM_CA_Realized_Invalid_Explore_Selection)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ExploreInMSB",icon:"I_SendToPPRNavigatorWithParent",multisel:!0,text:i.ECM_CA_Command_ExploreMSB,handler:function(e){var t=[],o=[],a=(o=n.exploreRefIds)[0].includes("pid:");a&&n.modelsToRemove.forEach(function(e,i){var n=e.get("id");n&&(n=n.replace("pid:","")),o.indexOf(n)>=0&&t.push(e.get("id").replace("pid:",""))}),a||(t=o),t&&t.length>0?S.DispatchEventToWin("ExploreInMSB",t):v.error(i.ECM_CA_Realized_Invalid_Explore_Selection)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmExploreParentsHdr",icon:"I_GetParents",multisel:!0,text:i.ECM_CA_Command_ExploreParents,handler:function(e){var t=[],i=[],o=(i=n.exploreRefIds)[0].includes("pid:");o&&n.modelsToRemove.forEach(function(e,n){var o=e.get("id");o&&(o=o.replace("pid:","")),i.indexOf(o)>=0&&t.push(e.get("id").replace("pid:",""))}),o||(t=i),S.DispatchEventToWin("ExploreParents",t)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ExploreInPPR",icon:"I_SendToPPRNavigatorWithParent",multisel:!0,text:i.ECM_CA_Command_ExploreMfg,handler:function(e){var t=[],i=[],o=(i=n.exploreRefIds)[0].includes("pid:");o&&n.modelsToRemove.forEach(function(e,n){var o=e.get("id");o&&(o=o.replace("pid:","")),i.indexOf(o)>=0&&t.push(e.get("id").replace("pid:",""))}),o||(t=i),S.DispatchEventToWin("ExploreInPPR",t)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmMultiDagExploreInCmd",icon:"I_ExploreInRFLPNavigator",multisel:!0,text:i.ECM_CA_Command_ExploreSys,handler:function(e){var t=[],i=[],o=(i=n.exploreRefIds)[0].includes("pid:");o&&n.modelsToRemove.forEach(function(e,n){var o=e.get("id");o&&(o=o.replace("pid:","")),i.indexOf(o)>=0&&t.push(e.get("id").replace("pid:",""))}),o||(t=i),S.DispatchEventToWin("ExploreInRFLP",t)}}]}),o.push({accelerator:"",availabilityMode:null,id:null,icon:null,items:[{accelerator:"Ctrl+O",availabilityMode:"Normal=YES CommandSet=YES Editability=YES SmallScale=YES LargeScale=YES ",id:"OpenFromCA",icon:"I_OpenDB",multisel:!0,text:i.ECM_CA_Command_Open,handler:function(e){var t=[],i=[],o=(i=n.exploreRefIds)[0].includes("pid:");o&&n.modelsToRemove.forEach(function(e,n){var o=e.get("id");o&&(o=o.replace("pid:","")),i.indexOf(o)>=0&&t.push(e.get("id").replace("pid:",""))}),o||(t=i),S.DispatchEventToWin("Open",t)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ExploreInCentral",icon:"I_ExploreInCentral_normal",multisel:!0,text:i.ECM_CA_Command_Explore3DSpace,handler:function(e){var t=[],i=[],o=(i=n.exploreRefIds)[0].includes("pid:");o&&n.modelsToRemove.forEach(function(e,n){var o=e.get("id");o&&(o=o.replace("pid:","")),i.indexOf(o)>=0&&t.push(e.get("id").replace("pid:",""))}),o||(t=i),S.DispatchEventToWin("ExploreInCollabNApproval",t)}},{accelerator:"Ctrl+Shift+O",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ENOVIA_Open_OpenAdvanced",icon:"I_OpenAdvDB",multisel:!0,text:i.ECM_CA_Command_OpenAdv,handler:function(e){var t=[],i=[],o=(i=n.exploreRefIds)[0].includes("pid:");o&&n.modelsToRemove.forEach(function(e,n){var o=e.get("id");o&&(o=o.replace("pid:","")),i.indexOf(o)>=0&&t.push(e.get("id").replace("pid:",""))}),o||(t=i),S.DispatchEventToWin("OpenAdv",t)}}],multisel:!0,text:i.ECM_CA_Command_OpenWith})}return o},domEvents:{"click .Realized-accordion-div":function(e){}},destroy:function(){this.modelsToRemove.splice(0,this.modelsToRemove.length),this.selectedOperationItems.splice(0,this.selectedOperationItems.length),this.stopListening(),this.model=null,this._parent()},filterRealizedCollection:function(){this.filteredRealizedCollection&&this.filteredRealizedCollection.length&&this.filteredRealizedCollection.reset();var e=V.filteredObjectIds,i=V.filteredActivities,n=[];this.originalRealizedCollection.toArray().forEach(function(t){var o=!1;e&&e.indexOf(t.get("id"))>=0||null==e?t.get("activities").forEach(function(e){var t=e.get("OriginalActivityDetails"),n=[];t.forEach(function(e){(i&&(i.indexOf(e.actName.split("#")[0])>=0||0==i.length)||null==i)&&n.push(e)}),n.length>0&&(o=!0),e.set("ActivityDetails",n,{silent:!0})}):t.get("activities").forEach(function(t){var n=t.get("OriginalActivityDetails"),a=[];n.forEach(function(t){if(!t.sameAsWhere&&(i&&(i.indexOf(t.actName.split("#")[0])>=0||0==i.length)||null==i)){if(t.AfterExists){var n=t.After.id;e&&e.indexOf(n)>=0&&a.push(t)}if(t.BeforeExists){var o=t.Before.id;e&&e.indexOf(o)>=0&&a.push(t)}}}),a.length>0&&(o=!0),t.set("ActivityDetails",a,{silent:!0})});t&&o&&n.push(t)});var o=new UWA.Class.Collection(n);document.querySelector(".Realized-operations-details").innerHTML="",this.operationView.destroy();this.operationView=this._initOperationView(o);if(this.injectSubView(this.operationView,"."+this.name+"-Realizedoperation-container"),this.filteredText&&o){var a=this;o.forEach(function(e,i){var n=a.container.getElement("#Realized-accordion-div-inner-"+i);if(n){var o=n.getElementsByTagName("span")[0].className;o.indexOf("expand-right")>0&&(n.getElementsByTagName("span")[0].className=o.replace("right","down").trim())}t.expandTile(i)});this.container.getElements(".fonticon-expand-right")}this.containerReference.getElement(".realized-counter-num");this.counterView.destroy(),this._initCounterView(o),this.injectSubView(this.counterView,"."+this.name+"-RealizedCounter"),null!=V.lastFilterView&&"DEFAULT"!==V.lastFilterView||(this.realizedMultiSelView.destroy(),this._initMultiSelView(),this.injectSubView(this.realizedMultiSelView,"."+this.name+"-realizedMultisel"),this.selectedOperationItems.splice(0,this.selectedOperationItems.length),this.modelsToRemove.splice(0,this.modelsToRemove.length))}})},updateRealizedCollection:function(e){let t=e.id,i=e.groupId;1==V.isGroupSelectionActive?b.getGroupCARealizedData(i).then(function(e){if(UWA.is(e.realized)){var i=f.createRealizedCollection(e.realized);b.enrichCollectionForRealized(i).then(function(e){V.setRealizedCollection(e,t)})}}):b.getCARealizedData(t,V.Realized_Filter_Map.DEFAULT).then(function(e){if(V.lastFilterView="DEFAULT",UWA.is(e.changeaction.realized)){var i=f.createRealizedCollection(e.changeaction.realized);b.enrichCollectionForRealized(i).then(function(e){V.setRealizedCollection(e,t)})}})},getRealizedCollection:function(){return this.realizedCollection},setRealizedCollection:function(e,t){this.realizedCollection=e,D.publish("ca-realized-collection-updated"+widget.id+t,{})},OnSearchComplete:function(e){var t=e.replace(",",""),i=[];i.push(t),V._tempReferenceToWinSearchCallback(i)},calledFromNativeInterop:function(e){var t={isActive:!0};t.selectedObjects={selectedObjs:V.operationsToExplore,result:e,length:V.operationsToExplore.length},V.multiSelView.buildMultisel(t)},getFilterValuesByOperation:function(){for(var e=this.getRealizedCollection(),t=new Map,i=0;i<e.length;i++){var n=e.at(i);if(n)n.get("activities").forEach(function(e){e.get("ActivityDetails").forEach(function(e){t.set(e.actName.split("#")[0],{actDisplayName:e.NLSName})})})}return t}};return V}),define("DS/ENOChangeActionUX/scripts/Views/CARealizedView",["UWA/Core","UWA/Class","UWA/Class/Debug","UWA/Class/Events","DS/ENOChangeActionUX/scripts/Views/CANewRealizedView","DS/ENOChangeActionUX/scripts/Views/CAFlowdownProposedRealizedView","DS/ENOChangeActionUX/scripts/Services/CARealizedViewServices","text!DS/ENOChangeActionUX/scripts/Templates/CARealizedViewTemplate.html"],function(e,t,i,n,o,a,s,r){return t.extend(i,n,{init:function(e){this._options=e,console.log(e),this._options.template=r},buildRealizedView:function(){return this._options&&this._options.isFromProposedFlowdown?this.realizedView=new a(this._options):this.realizedView=o._createView_NewRealized("div","test-realized-facet",!0,this._options.caModel,this._options),this.realizedView}})}),define("DS/ENOChangeActionUX/scripts/Services/CAProposedViewServices",["UWA/Core","DS/ENOChangeActionUX/scripts/Collection/CAProposedCollection","DS/UIKIT/Popover","DS/ENOChangeActionUX/scripts/Views/CAPopOverBodyView","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/DataGridView/DataGridView","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/TreeModel/DataModelSet","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e,t,i,n,o,a,s,r,l,c){"use strict";var d={createProposedCollection:function(e,i){var n={proposedArr:e,url:"dummyURL"},o=null;return(o=null!=i&&null!=i?i:new t).fetch(n),o},getOperationNameOnUI:function(e){var t="";switch(e){case"None":t=c.ECM_CA_Proposed_Activity_Modify;break;case"NewVersion":t=c.ECM_CA_Proposed_Operation_Revision;break;case"NewMinorVersion":t=c.ECM_CA_Proposed_Operation_MinorRevision;break;case"NewEvolution":t=c.ECM_CA_Proposed_Operation_Evolution;break;case"Create":t=c.ECM_CA_Proposed_Operation_Operation_Create;break;case"Modify":t=c.ECM_CA_Proposed_Activity_Modify;break;case"ChangeStatus":t=c.ECM_CA_Proposed_Activity_ChangeStatus;break;case"Release":t=c.ECM_CA_Proposed_Activity_State_Release;break;case"Obsolete":t=c.ECM_CA_Proposed_Activity_State_Obsolete;break;case"Restore":t=c.ECM_CA_Proposed_Activity_State_Restore;break;default:t=c.ECM_CA_Proposed_Activity_NoActivity}return t},buildFlowdownData:function(e,t){var i,n=[],o=[],a=[],s=[],r={},l=d.getPreviousFlowdownObjects(),c=e.proposedArrToAdd,p=null;for(var u in c&&(p=Object.keys(c)),p){var h=[],m=[],g=[],f=c[p[u]],C=l["pid:"+p[u]];if(f&&f.participateInflowdown){var v=null;for(var A in"Flowdown Pending"!==f.flowdownStatusValue&&"Flowdown Complete"!==f.flowdownStatusValue||(v={id:"pid:"+p[u],add:{},status:f.flowdownStatusValue},-1===n.indexOf("pid:"+p[u])&&n.push("pid:"+p[u])),f.resolutionItems){var w=f.resolutionItems[A];if(("Flowdown Pending"===f.flowdownStatusValue||"Flowdown Complete"===f.flowdownStatusValue)&&f.isResolutionObjectChanged){if(C&&C.resolutionItems){var b=C.resolutionItems;for(var S in b){var y=b[S];y&&y.flowdownAlreadyResolved&&(y.proposedActivityId?g.push(y.proposedActivityId):y.proposedId&&g.push(y.proposedId))}}if(w&&w.fromAddResolutionTab)-1===(_=w.proposedId).indexOf("pid:")&&(_="pid:"+_);else if(w){var _;-1===(_=w.proposedId).indexOf("pid:")&&(_="pid:"+_),m.push(_)}}}"Analysis Pending"===f.flowdownStatusValue&&a.push("pid:"+p[u]),"Ignored"===f.flowdownStatusValue&&o.push("pid:"+p[u]),(h&&h.length>0||g&&g.length>0||m&&m.length>0)&&(h&&h.length>0&&(v.add.direct=h),m&&m.length>0&&(v.add.proposed=m),g&&g.length>0&&(v.remove=g)),UWA.is(v)&&s.push(v)}}return(r={}).receivingChangeActionId=t,r.originChangeActionId=e.moreInfo.caID,n&&n.length>0&&(r.toFlowdown=n),a&&a.length>0&&(r.toDiscard=a),o&&o.length>0&&(r.toIgnore=o),s&&s.length>0&&(r.resolutionManagement=s),i=JSON.stringify(r),d.resetPreviouslySelectedFlowdownOjects(p),i},cacheFlowdownModelData:function(e){d[e.id]=e,UWA.is(d.cachedFlowdownModels)||(d.cachedFlowdownModels={}),d.cachedFlowdownModels[e.id]=e},setPreviousFlowdownObjects:function(e){d.previousFlowdownObjects=e},getPreviousFlowdownObjects:function(){return d.previousFlowdownObjects},resetPreviouslySelectedFlowdownOjects:function(e){for(var t in e){var i=e[t],n=d.getPreviousFlowdownObjects();n["pid:"+i]=[],delete n["pid:"+i]}d.previousFlowdownObjects=null}};return d}),define("DS/ENOChangeActionUX/scripts/Views/CAProposedOperationView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/Handlebars/Handlebars4","DS/UIKIT/Scroller","DS/ENOChangeActionUX/scripts/Views/CAProposedActivitiesView","DS/ENOChangeActionUX/scripts/Views/CAProposedFlowdownPopoverView","DS/ENOChangeActionUX/scripts/CAWidgetConfiguration","DS/ENO6WPlugins/jQuery","DS/TransientWidget/TransientWidget","DS/i3DXCompassPlatformServices/OpenWith","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/ENOChgServices/scripts/services/ChgPropertiesServices","DS/ENOXVersionExplorerController/VersionExplorerController","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","DS/ENOXVersionExplorerUtils/VersionExplorerSettings","DS/ENOChgServices/scripts/services/ChgProposedServices","DS/ENOChangeActionUX/scripts/Services/CAProposedViewServices","DS/ENOChgGovernanceUX/scripts/util/DocumentUtils","DS/ENOChgServices/scripts/services/ChgErrors"],function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v,A,w,b,S){"use strict";var y="Cannot be found";o.registerHelper("getMoreText",function(){return t.ECM_CA_Proposed_More_Reason}),o.registerHelper("ifNotCreate",function(e,i){return e===t.ECM_CA_Proposed_Operation_Create?'<span style="visibility:hidden">'+i+"</span>":"<label>"+t.ECM_CA_Maturity+" : </label>                            <span>"+i+"</span>"}),o.registerHelper("ifDraggable",function(e,i){return e===t.ECM_CA_Proposed_Operation_Create||!1===i?"draggable='false'":"draggable='true'"}),o.registerHelper("fillMiddleContainer",function(e,i){var n="";n='<div class="proposedOperation-sub-container-second">';var o=function(e,i){var n="";if(e.status||e.solution){if(n='<div class="proposedOperation-status-solution-container flex-container add-margin-left">',e.status&&(n+='                        <div class="proposedOperation-status-container">                            <label> '+t.ECM_CA_PROPOSED_PROPOSAL_STATUS+'</label>                            <span class="proposed-status-value">'+e.statusNLS+"</span>                        </div>"),e.solution){var o=e.solution.isReleased,a='                        <div class="proposedOperation-solution-container add-margin-left">                            <label>'+t.ECM_CA_PROPOSED_RESOLUTION+'</label>                            <div class="proposed-solution-value-with-action flex-container">                                <span class="proposed-solution-value" title="'+e.solution.displayString+'" id="'+e.solution.id+'">'+e.solution.displayString+"</span>";o||(a+='<span class="fonticon fonticon-attention attention-superscript" title=" '+t.ECM_CA_RESOLUTION_NON_RELEASED_OBJECT_WARNING+'"></span>'),n+=a+='<div class="proposedOperation-solutions-actions-container solution-icon-class" id="solution-action-container-'+i+'">                                    <div class="context-actions-container">                                        <div class="action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-down-open"></span></div>                                    </div>                                </div>                            </div>                        </div>'}n+="</div>"}return n}(e,i);n+=o,n+='<div class="proposedOperation-flowdown-info-container flex-container add-margin-left" id="flowdown-info-container-'+i+'"></div>';var a=function(e,i){var n="";return UWA.is(e.changeReason)&&""!=e.changeReason&&(n='                    <div class="proposedOperation-change-reason-container flex-container add-margin-left">                        <label class="proposedOperation-reason-label-container">'+t.ECM_CA_REASON_CHANGE_LABEL+'</label>                        <div class="proposedOperation-reason-text-container" title="'+e.changeReason+'">'+e.changeReason+' </div>                        <div class="proposedOperation-more-container" id="more-container-'+i+'">'+t.ECM_CA_Proposed_More_Reason+"</div>                    </div>"),n}(e,i);return n+=a,n+="</div>"});var _={activitiesToRemove:[],selectedActivityItems:[],proOpnView:null,_createView_TestProposed:function(i,n,d,p,g){return e.extend({name:"proposedOperation",tagName:i,className:n,proposedModel:p,contextCAId:g.get("id"),contextCAName:g.get("title"),contextCAModel:g,setup:function(){this.template='                                    <div class="'+this.getClassNames("-main-main-container")+'">                                    {{#each changes}}                                        <div class="'+this.getClassNames("-main-container")+'" id="main-container-{{@index}}">                                            <div class="'+this.getClassNames("-collpased-container")+'" id="collapsed-{{@index}}" {{#ifDraggable operation access}}{{/ifDraggable}}>                                                <div class="'+this.getClassNames("-accordion-container icon-class expander")+' accordion-div" id="accordion-div-{{@index}}">                                                    <div>                                                        <div class="action-icon-wrapper accordion-div-inner"><span class="fonticon fonticon-2x fonticon-expand-right" id={{@index}}></span></div>                                                        <div class="checked-action"><input type="checkbox" class="checkbox-accord hidden" id="checkbox-accord-{{@index}}"></div>                                                    </div>                                                </div>                                                <div class="'+this.getClassNames("-container")+'" id="proposedOp-container-{{@index}}">                                                    <div class="'+this.getClassNames("-sub-container-first")+'">                                                        <div class="'+this.getClassNames("-name-revision-container")+' ellipsis-info" title="{{name}} {{revision}}">                                                            {{#if icon}}<div class="'+this.getClassNames("-icon-container")+'"><img class="Realized-change-info-icon" id="info-icon-{{@index}}" src ={{icon}}></img></div>{{/if}}                                                            <div class="'+this.getClassNames("-name-container")+'">{{name}}</div>                                                            <div class="'+this.getClassNames("-revision-container")+'"><span>{{revision}}<span></div>                                                            {{#if isLastVersion}}<div class="'+this.getClassNames("-higher-revision-container")+' fonticon fonticon-flow-branch-list" title="'+t.ECM_PROPOSED_HIGHER_REVISION_EXISTS+'" id="highrevision-container-{{@index}}"></div>{{/if}}                                                        </div>                                                        <div class="'+this.getClassNames("-more-info-container")+'">                                                            <div class="'+this.getClassNames("-desc-op-container")+' mobile-hidden">                                                                {{#if nameBoolean}}<div class="'+this.getClassNames("-desc-container")+' ellipsis-info-1" title="{{desc}}" id="op-title-desc-{{@index}}">                                                                    <label>'+t.ECM_CA_Proposed_Operation_Name+' : </label>                                                                    <span>{{desc}}</span>                                                                </div>{{/if}}                                                                {{#if nameBoolean}}<div class="'+this.getClassNames("-op-container")+'" id="op-op-desc-{{@index}}">                                                                    <label>'+t.ECM_CA_Proposed_Operation_Operation+' :</label>                                                                    <span>{{operation}}</span>                                                                </div>{{/if}}                                                        </div>                                                        <div class="'+this.getClassNames("-mat-collab-container")+'">                                                            {{#if nameBoolean}}<div class="'+this.getClassNames("-mat-container")+'">{{#ifNotCreate operation maturity}}{{/ifNotCreate}}</div>{{/if}}                                                            {{#if nameBoolean}}<div class="'+this.getClassNames("-collab-container")+' ellipsis-info-1">                                                                <label>'+t.ECM_CA_COLLABSPACE_TAG+' :</label>                                                                <span>{{collabspace}}</span>                                                            </div>{{/if}}                                                        </div>                                                        {{#if nameBoolean}}<div class="'+this.getClassNames("-collab-container-op-container")+' monitor-hidden">                                                                <label>'+t.ECM_CA_Proposed_Operation_Operation+' :</label>                                                                <span>{{operation}}</span>                                                            </div>{{/if}}                                                        </div>                                                    </div>                                                {{#fillMiddleContainer this @index}}{{/fillMiddleContainer}}                                            </div>                                                <div class="'+this.getClassNames("-actions-container icon-class-1")+'" id="operation-action-container-{{@index}}">                                                    <div class="context-actions-container">                                                        <div class="action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-down-open"></span></div>                                                    </div>                                                </div>                                            </div>                                        <div class="proposed-tile-expanded hidden" id="expanded-{{@index}}"></div>                                        </div>                                    {{/each}}                                    </div>',this.myProposedModel=p;var e=this;widget.addEvent("onResize",function(){setTimeout(function(){_.onResize()},100)}),_.selectedTilesMap={forEach:function(t){for(var i=0;i<e.proposedModel.length;i++)UWA.is(this[i])&&t(this[i],i,this)},set:function(e,t){this[e]=t}},_.selectedTilesIDMap={forEach:function(t){for(var i=0;i<e.proposedModel.length;i++)UWA.is(this[i])&&t(this[i],i,this)},set:function(e,t){this[e]=t}}},render:function(){this.container.empty(),h.setCurrModel(this.contextCAModel),this.renderer=this.getTemplate(this.template,this.myProposedModel);d?widget.body:this.container;var e=UWA.createElement("div",{class:"operations-main-container"});e.setAttribute("data-rec-id","operations-main-container-CA"),e.setStyle("height","calc(100% - 50px)"),e.setStyle("overflow","auto");var t;t=this.renderer(),e.addContent(t),new a({element:e}).inject(this.container);for(var i=_.proOpnView=this,n=0;n<i.data.changes.length;n++){var o=this.container.getElement("#operation-action-container-"+n);if(o){o.addEvent("click",function(e){var t=e.currentTarget.id.split("-")[3];t=parseInt(t);var n=i.data.changes[t].id,o=i.proposedModel.findWhere({id:n});UWA.is(o)&&(this.model=o),_.itemView=this,"Create"!=o.get("operationActual")&&o.get("Access")&&u.getGlobalVariable().isNative?m.DispatchEventToWin("Proposed_ContextMenu",o.get("objectId").replace("pid:","")):_.DisplayContextMenu([])})}var s=this.container.getElement("#solution-action-container-"+n);if(s){s.addEvent("click",function(e){var t=e.currentTarget.id.split("-")[3];t=parseInt(t);var n=i.data.changes[t].id,o=i.proposedModel.findWhere({id:n});if(UWA.is(o)&&(this.model=o),_.itemView=this,"Create"!=o.get("operationActual")&&o.get("Access")&&u.getGlobalVariable().isNative){var a="",s=o.get("resolutionItems");if(UWA.is(s)&&Array.isArray(s))for(var r=0;r<s.length;r++){var l=s[r];l&&(a=l.id.replace("pid:",""))}m.DispatchEventToWin("Resolution_ContextMenu",a)}else _.displayContextualMenuForSolutionItem([])})}var r=this.container.getElement("#flowdown-info-container-"+n),l=i.data.changes[n].flowdownInfo;if(l&&r){var c={parentContainer:r,data:l,index:n,name:i.data.changes[n].name};i._buildFlowdownView(c)}}return _.container=i,h.setCallbacksForOpenWith("proposed"),this},injectSubView:function(e,t){var i=this.container.getElement(t);e&&i&&i.grab(e.render().getContent())},_initActivitiesView:function(e,t){this.activitiesView=new(s._createView_TestProposed(!1,e,t)),this._actvitiesEvents={deleteActivity:function(){var e={};e.operationIdx=t,this.dispatchEvent("deleteActivity",[arguments[1],e])},editActivity:function(){var e={};e.operationIdx=t,this.dispatchEvent("editActivity",[arguments[1],e])},onActionClickActivities:function(){var e=this.myProposedModel.at(t),i=arguments[1].model.get("id"),n={};n.operationIdx=t,n.idOfAction=i,this.dispatchEvent("onActionClickActivities",[e,n])},removeMultiSelActvities:function(){var e={};e.operationIdx=t,this.dispatchEvent("removeMultiSelActvities",[arguments[0],e])}};this.listenTo(this.activitiesView,this._actvitiesEvents),this.activitiesViewArr.push(this.activitiesView)},_buildFlowdownView:function(e){var i=e.parentContainer,n=e.data,o=e.index,a=e.name;if(n.flowdownFor&&n.flowdownFrom&&1===n.flowdownFor.length&&1===n.flowdownFrom.length){var s=!0,r="";n.flowdownFor[0].info["display name"]==y?(r=t.ECM_CA_Cannot_be_found,s=!1):"Access Denied"==n.flowdownFor[0].info["display name"]?(r=t.ECM_CA_Access_Denied,s=!1):(r=n.flowdownFor[0].info["display name"],s=!0);var l={flowDownFromName:n.flowdownFrom[0].caName,flowDownFromID:n.flowdownFrom[0].caID,flowDownFromTitle:n.flowdownFrom[0].caTitle,flowDownFromIcon:n.flowdownFrom[0].icon,flowDownFromImage:n.flowdownFrom[0].image,flowdownForObjectId:n.flowdownFor[0].id,flowdownForObjectTitle:r,flowdownForObjectType:n.flowdownFor[0].info.type,flowdownForObjectTypeNLS:n.flowdownFor[0].info.typeNLS,flowDownForIcon:n.flowdownFor[0].info.icon,flowDownForImage:n.flowdownFor[0].info.image,name:a,flowdownBoolean:s},c="";c=UWA.is(l.flowDownFromIcon)&&""!=l.flowDownFromIcon?'                            <span><img class="Realized-change-info-icon" src="'+l.flowDownFromIcon+'"></img></span>                            <span                            class="proposed-flowdown-from-value"                             title="'+l.flowDownFromTitle+'"                            id= "'+l.flowDownFromID+"-"+o+'"                            objname = "'+l.name+'" >                                '+l.flowDownFromTitle+"                            </span>":'                            <span                            class="proposed-flowdown-from-value"                             title="'+l.flowDownFromTitle+'"                            id= "'+l.flowDownFromID+"-"+o+'"                            objname = "'+l.name+'" >                                '+l.flowDownFromTitle+"                            </span>";var d="";d=UWA.is(l.flowDownForIcon)&&""!=l.flowDownForIcon?'                            <span><img class="Realized-change-info-icon" src="'+l.flowDownForIcon+'"></img></span>                            <span                            class="proposed-flowdown-for-value"                            title="'+l.flowdownForObjectTitle+'"                            id= "'+l.flowdownForObjectId+"-"+o+'">                                '+l.flowdownForObjectTitle+"                            </span>":'                            <span                            class="proposed-flowdown-for-value"                            title="'+l.flowdownForObjectTitle+'"                            id= "'+l.flowdownForObjectId+"-"+o+'">                                '+l.flowdownForObjectTitle+"                            </span>";var p="";"Cannot be found"!=l.flowDownFromName&&""!=l.flowDownFromName&&(p='                            <div class="proposedOperation-solutions-actions-container flowdown-action-container solution-icon-class" id="flowdown-from-action-container-'+o+'"                                 info="'+l.name+"~"+l.flowDownFromName+'">                                <div class="context-actions-container">                                    <div class="action-icon-wrapper">                                        <span class="fonticon fonticon-2x fonticon-down-open" id= "'+l.flowDownFromID+"-"+o+'"></span>                                    </div>                                </div>                            </div>');var u="";"Cannot be found"!=l.flowdownForObjectTitle&&""!=l.flowdownForObjectTitle&&(u='                            <div class="proposedOperation-solutions-actions-container flowdown-action-container solution-icon-class" id="flowdown-for-action-container-'+o+'"                                info="'+l.flowdownForObjectTitle+"~"+l.flowdownForObjectType+"~ "+l.flowdownForObjectTypeNLS+'">                                <div class="context-actions-container">                                    <div class="action-icon-wrapper">                                                <span class="fonticon fonticon-2x fonticon-down-open" id= "'+l.flowdownForObjectId+"-"+o+'"></span>                                    </div>                                </div>                            </div>');var h='                        <div class="proposedOperation-flowdown-info-container flex-container">                            <div class="proposedOperation-flowdown-from-container flex-container">                                <label>'+t.ECM_CA_FLOWDOWN_FROM_LABEL+'</label>                                <div class="proposed-flowdownfrom-value-with-action flex-container">                                    '+c+"                                    "+p+'                                </div>                            </div>                            <div class="proposedOperation-flowdown-for-container flex-container">                                <label>'+t.ECM_CA_FLOWDOWN_FOR_LABEL+'</label>                                <div class="proposed-flowdownfor-value-with-action flex-container">                                    '+d+"                                    "+u+"                                </div>                            </div>                        </div>"}else l={flowDownFromLength:n.flowdownFrom.length,flowdownForLength:n.flowdownFor.length},h='                        <div class="proposedOperation-flowdown-info-container flex-container">                            <div class="proposedOperation-flowdown-from-container flex-container">                                <label>'+t.ECM_CA_FLOWDOWN_FROM_LABEL+'</label>                                <div class="proposed-flowdownfrom-value-with-action flex-container">                                    <a                                    class="proposed-flowdown-from-value flowdown-from-value-link"                                     id="flowdown-from-value-link-'+o+'"                                    title="'+l.flowDownFromLength+'"                                    >                                        '+l.flowDownFromLength+" "+t.ECM_SELECTED_PROPOSED_ITEMS_LABEL+'                                    </a>                                </div>                            </div>                            <div class="proposedOperation-flowdown-for-container flex-container add-margin-left">                                <label>'+t.ECM_CA_FLOWDOWN_FOR_LABEL+'</label>                                <div class="proposed-flowdownfor-value-with-action flex-container">                                    <a                                    class="proposed-flowdown-for-value flowdown-for-value-link"                                    id="flowdown-for-value-link-'+o+'"                                    title="'+l.flowdownForLength+'"                                    >                                        '+l.flowdownForLength+" "+t.ECM_SELECTED_PROPOSED_ITEMS_LABEL+"                                    </a>                                </div>                            </div>                        </div>";i&&""!=h&&s&&(i.empty(),i.addContent(h))},getTemplate:function(e,i){var n=o.compile(e),a=this,s=[];this.activitiesViewArr=[];_.proposedModel;return i.forEach(function(e,i){"Create"!=e.get("operationActual")&&"Flowdown"!=e.get("operationActual")&&e.get("Access");var n=!1;UWA.is(e.get("isLastVersion"))&&(n=!!(n="true"!==e.get("isLastVersion")));var o=!0;UWA.is(e.get("objectTitle"))&&(o=e.get("objectTitle")!==t.ECM_CA_Access_Denied&&e.get("objectTitle")!==t.ECM_CA_Cannot_be_found);var r={operation:e.get("operationDisplay"),operationActual:e.get("operationActual"),maturity:e.get("maturity"),name:UWA.is(e.get("objectName"))?e.get("objectName"):e.get("name"),icon:e.get("icon"),revision:e.get("revision"),changeReason:e.get("changeReason"),id:e.get("id"),objectId:e.get("objectId"),desc:e.get("objectTitle"),access:e.get("Access"),collabspace:e.get("collabSpaceTitle"),isLastVersion:n,status:e.get("status"),statusNLS:e.get("statusNLS"),nameBoolean:o};if("Flowdown"===e.get("operationActual")){var l="";l=e.get("flowdownForObjectTitle")==y?t.ECM_CA_Cannot_be_found:"Access Denied"==e.get("flowdownForObjectTitle")?t.ECM_CA_Access_Denied:e.get("flowdownForObjectTitle");var c={flowdownFor:[],flowdownFrom:[]};c.flowdownFrom.push({caID:e.get("flowDownFromId"),caTitle:e.get("flowDownFromTitle"),caName:e.get("flowDownFromName"),icon:e.get("flowdownFromIcon"),image:e.get("flowdownFromImage")}),c.flowdownFor.push({id:e.get("flowdownForObjectId"),info:{"display name":l,type:e.get("flowdownForObjectType"),typeNLS:e.get("flowdownForObjectTypeNLS"),icon:e.get("flowdownForIcon"),image:e.get("flowdownForImage")}}),r.flowdownInfo=a.flowdownInfo=c}else r.flowdownInfo=a.flowdownInfo=e.get("flowdownInfo");if(UWA.is(e.get("resolutionItems"))){var d=e.get("resolutionItems");for(i=0;i<d.length;i++){var p=d[i];if(p){var u=p.info["display name"]==y?t.ECM_CA_Cannot_be_found:"Access Denied"==p.info["display name"]?t.ECM_CA_Access_Denied:p.info["display name"],h=p.info.revision,m=p.info.current,g=!1;"RELEASED"!=m&&"Release"!=m||(g=!0);var f=u+" "+h;""!=f&&(r.solution={id:p.id,displayString:f,isReleased:g})}}}r.operation=e.get("Access")?e.get("operationDisplay"):void 0,r.name=e.get("objectTitle"),r.desc=UWA.is(e.get("objectName"))?e.get("objectName"):e.get("name"),s.push(r)}),this.data={changes:s},function(){return n(a.data)}},domEvents:{"click .proposed-flowdown-from-value":function(e){var t=e.target.id.split("-")[e.target.id.split("-").length-1],i=this.data.changes[t].flowdownInfo.flowdownFrom;if(i){var n={target:e.target,data:i,popoverFor:"flowdownFrom"};this.flowdownFromPopoverView&&this.flowdownFromPopoverView.destroy(),(this.flowdownFromPopoverView=new r(n)).render()}},"click .proposed-flowdown-for-value":function(e){var t=e.target.id.split("-")[e.target.id.split("-").length-1],i=this.data.changes[t].flowdownInfo.flowdownFor;if(i){var n={target:e.target,data:i,popoverFor:"flowdownFor"};this.flowdownForPopoverView&&this.flowdownForPopoverView.destroy(),(this.flowdownForPopoverView=new r(n)).render()}},"click .flowdown-action-container":function(e){e.target.id;var t=e.target.getParent(".flowdown-action-container"),i=t.getAttribute("info"),n=t.id.split("-")[1];if("from"===n)var o=i.split("~")[1],a="Change Action",s="Change Action";else if("for"===n)o=i.split("~")[0],a=i.split("~")[1],s=i.split("~")[2];var r=t.getElement(".fonticon-down-open").id.split("-")[0],l=t.id.split("-")[4];l=parseInt(l);var c=this.data.changes[l].id,d=this.proposedModel.findWhere({id:c});UWA.is(d)&&(this.model=d),_.itemView=this,_.parentContainer=t;var p={elemId:r.replace("pid:",""),fromName:o,typeNLS:a,type:s};if(_.setFlowdownContextOptions(p),"Create"!=d.get("operationActual")&&d.get("Access")&&u.getGlobalVariable().isNative){var h=r.replace("pid:","");m.DispatchEventToWin("FlowdownFrom_ContextMenu",h)}else _.displayContextualMenuForFlowdownForItem([])},"click .accordion-div-inner":function(e){var t=e.target.id,i=(this.container.getElement("#proposedOp-container-"+t),e.target.className);i.indexOf("expand-right")>0?e.target.className=i.replace("right","down").trim():i.indexOf("expand-down")>0&&(e.target.className=i.replace("down","right").trim()),_.accordionClassName=e.target.className,_.expandTile(t,i)},"click .proposedOperation-collpased-container":function(e){if(!(e.target.className.indexOf("down")>=0||e.target.className.indexOf("right")>=0||e.target.className.indexOf("checkbox")>=0||e.target.className.indexOf("more-container")>=0||e.target.className.indexOf("higher-revision-container")>=0||e.target.className.indexOf("multiple-flowdown")>=0||e.target.className.indexOf("actions-container")>=0)){var t=e.target,i=(t.className.indexOf("proposedOperation-collpased-container")>=0?t:function(e){for(;(e=e.parentNode)&&!e.classList.contains("proposedOperation-collpased-container"););return e}(t)).id.split("-"),n=i[i.length-1],o=this.container.getElement("#checkbox-accord-"+n);o&&!o.hasClassName("hidden")||_.changeAccordIconAndExpandTile(n)}},"click .checkbox-accord":function(e){var t=this.myProposedModel,i=(e.target,e.target.id.split("-")),n=i[i.length-1],o=parseInt(n),a=t.at(o);(s=this.container.getElement("#main-container-"+n)).hasClassName("selected-border")?s.removeClassName("selected-border"):s.addClassName("selected-border");var s=document.createElement("input"),r={};r.id=a.get("objectId").replace("pid:",""),r.name=a.get("objectName"),r.title=a.get("objectTitle"),r.type=a.get("objectType"),s.setAttribute("data-pid",a.get("objectId").replace("pid:","")),s.setAttribute("data-type",a.get("type")),s.setAttribute("data-selectedItem",JSON.stringify(r)),e.target.checked?(s.setAttribute("class","selected"),l.onClickItem.call(s,widget,u.getGlobalVariable())):l.onClickItem.call(s,widget,u.getGlobalVariable()),Array.prototype.unshift.call(arguments,a),this.dispatchEvent("onCheckboxClick",arguments)},"click .proposedOperation-more-container":function(e){var i=e.target.id.split("-"),n=i[i.length-1],o=this.container.getElement("#collapsed-"+n),a="";o&&(a=o.id);var s=c("#"+a).find(".proposedOperation-reason-text-container");s&&("none"===s.css("max-height")?(s.css("max-height","3.6em"),s.css("overflow","auto"),s.css("white-space","inherit")):(s.css("max-height","none"),s.css("overflow","hidden"),s.css("white-space","nowrap")));var r=c("#"+a).find(".proposedOperation-more-container");r&&(r.text()===t.ECM_CA_Proposed_Less_Reason?r.text(t.ECM_CA_Proposed_More_Reason):r.text(t.ECM_CA_Proposed_Less_Reason))},dragstart:function(e){var t=this.myProposedModel,i=(e.target,e.target.id.split("-")),n=i[i.length-1],o=parseInt(n),a=t.at(o);Array.prototype.unshift.call(arguments,a),Array.prototype.unshift.call(arguments,{}),this.dispatchEvent("onItemViewDrag",arguments)},"click .proposedOperation-higher-revision-container":function(e){var t=this.myProposedModel,i=(e.target,e.target.id.split("-")),n=i[i.length-1],o=parseInt(n),a=t.at(o);"Complete"!=a.get("status")&&_.launchRevisionExplorerForSolutionItems(a,!1)}},destroy:function(){return this.activitiesView&&this.stopListening(this.activitiesView,this._actvitiesEvents),this.stopListening(this.myProposedModel),this.myProposedModel=null,this._parent.apply(this,arguments)}})},displayContextualMenuForFlowdownForItem:function(e){var i=this,n=[],o=_.getFlowdownContextOptions();if(i.itemView&&i.itemView.model&&i.itemView.model.get("Access")){var a=o.elemId,s=o.typeNLS,r=o.fromName,l=o.type,c={objectId:a,objectType:s,displayName:r,displayType:l,facetName:"proposed"};o={facetName:"proposed",selectedItem:c};h.setSelectedItem(o);var d=[];d.push(c);var f=h.getContentForCompassInteraction(d),C=new p;C.set3DXContent(f,!0);var v=[];UWA.is(C.retrieveCompatibleApps,"function")&&C.retrieveCompatibleApps(function(o){o.forEach(function(e){v.push({text:e.text,fonticon:e.fonticon,multisel:!1,handler:e.handler})}),v.length>0&&u.getGlobalVariable().isNative?"true"==u.getGlobalVariable().CHG_OPENWITH&&n.push({id:"OpenWith",text:t.ECM_CA_Command_OpenWith_RichClient,fonticon:"export",icon:"fonticon-export",multisel:!1,items:v}):v.length>0&&n.push({id:"OpenWith",text:t.ECM_CA_Command_OpenWith,fonticon:"export",icon:"fonticon-export",multisel:!1,items:v});var s=i.itemView.model;u.getGlobalVariable().isNative||"false"==u.getGlobalVariable().CHG_OPEN_WITH_COLLAB||"Create"==s.get("operationActual")||n.push({id:"Details",text:t.ECM_CA_Explore_With_Central,fonticon:"window",icon:"fonticon-window",multisel:!0,handler:function(e){var t="/common/emxTree.jsp?mode=insert&objectId="+a,i=u.getGlobalVariable().getSecurityContext().replace("ctx::",""),n=u.getGlobalVariable().computeUrl("/common/emxFrameworkContextManager.jsp?SecurityContext="+i+"&forwardUrl="+t),o=window.open();o.opener=null,o.location.href=n}});var r={id:"Properties",text:t.ECM_CA_Properties,fonticon:"attributes",icon:"I_ChangeCnxObjProps",multisel:!0,handler:function(e){var t=a;g.createPropertiesComponent(t)}},l={id:"ChangeAssessment",text:t.ECM_CA_Proposed_Change_Assessment,fonticon:"component",icon:"I_ChangeCnxObjProps",multisel:!0,handler:function(e){var t=[a];u.getGlobalVariable().isNative?m.DispatchEventToWin("ChangeAssessment",itemID.replace("pid:","")):h.openRelationalExplorer(t)}};1==s.get("Access")&&(n.push(r),n.push(l)),e.push.apply(e,n),h._initDropDown(e,_.parentContainer)})}},displayContextualMenuForSolutionItem:function(e){var i=this,n=[];if(i.itemView&&i.itemView.model&&i.itemView.model.get("Access")){var o="",a="",s="",r="",l=null,c=i.itemView.model.get("resolutionItems");if(UWA.is(c)&&Array.isArray(c))for(var d=0;d<c.length;d++){(l=c[d])&&(o=l.id.replace("pid:",""),a=l.info.type,s=l.info["display name"],r=l.info.typeNLS)}var m={objectId:o,objectType:a,displayName:s,displayType:r,facetName:"proposed"},f={facetName:"proposed",selectedItem:m};h.setSelectedItem(f);var C=[];C.push(m);var v=h.getContentForCompassInteraction(C),A=new p;A.set3DXContent(v,!0);var w=[];UWA.is(A.retrieveCompatibleApps,"function")&&A.retrieveCompatibleApps(function(a){a.forEach(function(e){w.push({id:e.text,text:e.text,fonticon:e.fonticon,multisel:!1,handler:e.handler})}),w.length>0&&u.getGlobalVariable().isNative?"true"==u.getGlobalVariable().CHG_OPENWITH&&n.push({id:"OpenWith",text:t.ECM_CA_Command_OpenWith_RichClient,fonticon:"export",icon:"fonticon-export",multisel:!1,items:w}):w.length>0&&n.push({id:"OpenWith",text:t.ECM_CA_Command_OpenWith,fonticon:"export",icon:"fonticon-export",multisel:!1,items:w});var s=i.itemView.model;u.getGlobalVariable().isNative||"false"==u.getGlobalVariable().CHG_OPEN_WITH_COLLAB||"Create"==s.get("operationActual")||n.push({id:"Details",text:t.ECM_CA_Explore_With_Central,fonticon:"window",icon:"fonticon-window",multisel:!0,handler:function(e){var t="/common/emxTree.jsp?mode=insert&objectId="+o,i=u.getGlobalVariable().getSecurityContext().replace("ctx::",""),n=u.getGlobalVariable().computeUrl("/common/emxFrameworkContextManager.jsp?SecurityContext="+i+"&forwardUrl="+t),a=window.open();a.opener=null,a.location.href=n}});var r={id:"Properties",text:t.ECM_CA_Properties,fonticon:"attributes",icon:"I_ChangeCnxObjProps",multisel:!0,handler:function(e){var t=o;g.createPropertiesComponent(t)}};1==s.get("Access")&&"Create"!=s.get("operationActual")&&n.push(r);var l={id:"Resolution-Remove",text:t.ECM_CA_Remove_Proposed_Changes,fonticon:"trash",icon:"I_ChangeCnxObjTrash",handler:function(e){if("Flowdown"!=i.itemView.model.get("operationActual")){var t={proposedId:i.itemView.model.get("id"),selectedObjID:""},n=_.getJSONForAddResolution(t);_.proOpnView.dispatchEvent("OnAddResolutionItem",[n])}else if("Flowdown"===i.itemView.model.get("operationActual")){var o="",a=i.itemView.model.get("resolutionItems");if(a)o=a[0].id;t={amoID:i.itemView.model.get("amoID"),upstreamCAId:i.itemView.model.get("flowDownFromId"),selectedObjID:"",resolutionItemId:o};_.proOpnView.dispatchEvent("OnAddResolutionItemForFlowdown",[t])}}},c=!0,d=h.getCurrentModel();if(UWA.is(d)&&UWA.is(d.get("userAccess"))){var p=d.get("userAccess");(p&&p.DeleteProposed&&"false"===p.DeleteProposed||!p.DeleteProposed)&&(c=!1)}1==c&&n.push(l),e.push.apply(e,n),h._initDropDown(e,_.itemView)})}},DisplayContextMenu:function(e){var i=this,n=[];if(i.itemView&&i.itemView.model&&i.itemView.model.get("Access")){var o={objectId:i.itemView.model.get("objectId").replace("pid:",""),objectType:i.itemView.model.get("objectType"),displayName:i.itemView.model.get("objectTitle"),displayType:i.itemView.model.get("type"),facetName:"proposed"},a={facetName:"proposed",selectedItem:o};h.setSelectedItem(a);var s=[];s.push(o);var r=h.getContentForCompassInteraction(s),l=new p;l.set3DXContent(r,!0);var c=[];UWA.is(l.retrieveCompatibleApps,"function")&&l.retrieveCompatibleApps(function(o){o.forEach(function(e){c.push({id:e.text,text:e.text,fonticon:e.fonticon,multisel:!1,handler:e.handler})}),c.length>0&&u.getGlobalVariable().isNative?"true"==u.getGlobalVariable().CHG_OPENWITH&&n.push({id:"OpenWith",text:t.ECM_CA_Command_OpenWith_RichClient,fonticon:"export",icon:"fonticon-export",multisel:!1,items:c}):c.length>0&&n.push({id:"OpenWith",text:t.ECM_CA_Command_OpenWith,fonticon:"export",icon:"fonticon-export",multisel:!1,items:c});var a=i.itemView.model;u.getGlobalVariable().isNative||"false"==u.getGlobalVariable().CHG_OPEN_WITH_COLLAB||"Create"==a.get("operationActual")||n.push({id:"Details",text:t.ECM_CA_Explore_With_Central,fonticon:"window",icon:"fonticon-window",multisel:!0,handler:function(e){var t="/common/emxTree.jsp?mode=insert&objectId="+i.itemView.model.get("objectId").replace("pid:",""),n=u.getGlobalVariable().getSecurityContext().replace("ctx::",""),o=u.getGlobalVariable().computeUrl("/common/emxFrameworkContextManager.jsp?SecurityContext="+n+"&forwardUrl="+t),a=window.open();a.opener=null,a.location.href=o}});var s=[];s.push({id:"identifybyVersionSearch",text:t.ECM_CA_PROPOSED_IDENTIFY_SOLUTION_VERSIONS,fonticon:"flow-branch-list",icon:"I_ChangeCnxObjVersionSearch",handler:function(){i.launchRevisionExplorerForSolutionItems(i.itemView.model,!0)}}),s.push({id:"identifybySearch",text:t.ECM_CA_PROPOSED_IDENTIFY_SOLUTION_SEARCH,fonticon:"search",icon:"I_ChangeCnxObjSearch",handler:function(){i.launchSearchForSolutionItems(i.itemView.model)}});var r={text:t.ECM_CA_PROPOSED_IDENTIFY_SOLUTION,fonticon:"target-add",icon:"I_ChangeCnxObjEdit",items:s},l=!0,d=h.getCurrentModel();if(UWA.is(d)&&UWA.is(d.get("userAccess"))){var p=d.get("userAccess");(p&&p.AddProposed&&"false"===p.AddProposed||!p.AddProposed)&&(l=!1)}var f=!0,C=i.itemView.model.get("operationActual");"None"!=C&&"Flowdown"!=C&&(f=!1);var v=i.itemView.model.get("activities");v&&v.length>0&&f&&v.forEach(function(e){e&&f&&("Modify"!=e.get("activityActual")&&(f=!1))});var A=i.itemView.model.get("status");1==a.get("Access")&&l&&f&&"Complete"!=A&&"true"===u.getGlobalVariable().isFullLicence&&n.push(r);var w;if((w=_._getStatusCommands(i.itemView.model)).length>0){var S={text:t.ECM_CA_PROPOSED_PROPOSAL_STATUS,items:w};1==a.get("Access")&&n.push(S)}var y={text:t.ECM_CA_Edit_Proposed_Changs,fonticon:"pencil",icon:"I_ChangeCnxObjEdit",handler:function(){var e=[];i.itemView.model.id;a&&e.push(a),i.proOpnView.dispatchEvent("editProposed",[i.itemView,e,arguments[0]])}};1==a.get("Access")&&l&&"Flowdown"!=C&&n.push(y),n.push.apply(n,e);var E={id:"Properties",text:t.ECM_CA_Properties,fonticon:"attributes",icon:"I_ChangeCnxObjProps",multisel:!0,handler:function(e){var t=i.itemView.model.get("objectId").replace("pid:","");g.createPropertiesComponent(t)}};1==a.get("Access")&&"Create"!=a.get("operationActual")&&n.push(E),b.getDocuments([i.itemView.model.get("objectId").slice("4")]).then(function(e){var o={id:"download",text:t.ECM_CA_Download,fonticon:"download",icon:"I_ChangeCnxObjDownload",multisel:!0,handler:function(e){var t=i.itemView.model.get("objectId").slice("4"),n=[];n.push(t);b.download(n)}},s={id:"preview",text:t.ECM_CA_Preview,fonticon:"eye",icon:"I_ChgPreviewIcon",multisel:!0,handler:function(e){var t=i.itemView.model.get("objectId").slice("4"),n=[];n.push(t),b.preview(n)}};i.itemView&&i.itemView.model&&"TRUE"===e[0].dataelements.isDocumentType&&"Flowdown"!=C&&(n.push(o),n.push(s));var r={id:"ChangeAssessment",text:t.ECM_CA_Proposed_Change_Assessment,fonticon:"component",icon:"I_ChangeCnxObjProps",multisel:!0,handler:function(e){var t=i.itemView.model.get("objectId"),n=[t];u.getGlobalVariable().isNative?m.DispatchEventToWin("ChangeAssessment",t.replace("pid:","")):h.openRelationalExplorer(n)}};l&&n.push(r);var c={text:t.ECM_CA_Remove_Proposed_Changes,fonticon:"trash",icon:"I_ChangeCnxObjTrash",handler:function(e){var t=[],n=(i.itemView.model.id,i.itemView.model);n&&t.push(n),i.proOpnView.dispatchEvent("deleteProposed",[i.itemView,t,arguments[0]])}},d=!0,p=h.getCurrentModel();if(UWA.is(p)&&UWA.is(p.get("userAccess"))){var g=p.get("userAccess");(g&&g.DeleteProposed&&"false"===g.DeleteProposed||!g.DeleteProposed)&&(d=!1)}1==d&&"Flowdown"!=a.get("operationActual")&&n.push(c),h._initDropDown(n,_.itemView)})})}},_getStatusCommands:function(e){var i=e.get("operationActual"),n=[],o=this,a=!0,s=!0,r=!0,l=!0,c=!0,d=h.getCurrentModel();if(UWA.is(d)&&UWA.is(d.get("userAccess"))){var p=d.get("userAccess");(p&&p.proposedStatusAsComplete&&"false"===p.proposedStatusAsComplete||!p.proposedStatusAsComplete)&&(a=!1),(p&&p.proposedStatusAsPartial&&"false"===p.proposedStatusAsPartial||!p.proposedStatusAsPartial)&&(s=!1),(p&&p.proposedStatusAsIgnored&&"false"===p.proposedStatusAsIgnored||!p.proposedStatusAsIgnored)&&!1,(p&&p.proposedStatusAsNotStarted&&"false"===p.proposedStatusAsNotStarted||!p.proposedStatusAsNotStarted)&&(r=!1),(p&&p.proposedStatusAsRejected&&"false"===p.proposedStatusAsRejected||!p.proposedStatusAsRejected)&&(l=!1),(p&&p.proposedStatusAsStarted&&"false"===p.proposedStatusAsStarted||!p.proposedStatusAsStarted)&&(c=!1)}return"Flowdown"!=i&&r&&n.push({id:"status-not-started",text:t.ECM_PROPOSED_STATUS_NOT_STARTED_COMMAND,handler:function(){o.updateProposedStatus(e,"Not Started")}}),c&&n.push({id:"status-started",text:t.ECM_PROPOSED_STATUS_STARTED_COMMAND,handler:function(){o.updateProposedStatus(e,"Started")}}),a&&n.push({id:"status-complete",text:t.ECM_PROPOSED_STATUS_COMPLETE_COMMAND,handler:function(){o.updateProposedStatus(e,"Complete")}}),s&&n.push({id:"status-partial",text:t.ECM_PROPOSED_STATUS_PARTIAL_COMMAND,handler:function(){o.updateProposedStatus(e,"Partial")}}),l&&n.push({id:"status-rejected",text:t.ECM_PROPOSED_STATUS_REJECT_COMMAND,handler:function(){o.updateProposedStatus(e,"Rejected")}}),n},OnSearchComplete:function(e){var t=_.itemView.model,i="";if(u.getGlobalVariable().isNative){for(var n=e.split("~"),o=[],a=0;a<n.length;a++)o.push(n[a]);for(var s=[],r=0;r<n.length;r++)s.push(o[r].split(","));var l=[];for(a=0;a<s.length;a++){var c=s[a];l.push(c[0])}i=l[0]}else if(e){var d=e[0];d&&Array.isArray(d)&&(i=d[0])}if("Flowdown"===t.get("operationActual")){var p="",h=t.get("resolutionItems");if(h&&h[0])p=h[0].id;var m={amoID:t.get("amoID"),upstreamCAId:t.get("flowDownFromId"),selectedObjID:i,resolutionItemId:p};_.proOpnView.dispatchEvent("OnAddResolutionItemForFlowdown",[m])}else{m={proposedId:t.get("id"),selectedObjID:i};var g=_.getJSONForAddResolution(m);_.proOpnView.dispatchEvent("OnAddResolutionItem",[g])}},updateProposedStatus:function(e,t){if("Flowdown"===e.get("operationActual")){var i=e.get("resolutionItems"),n="";i&&i[0]&&(n=i[0].id);var o={amoID:e.get("amoID"),status:t,upstreamCAId:e.get("flowDownFromId")};""!=n&&(o.resolutionID=n),this.proOpnView.dispatchEvent("OnUpdateProposedStatusForFlowdown",[o])}else{o={selectedIDs:[e.get("id")],status:t};var a=_.getJSONForUpdateStatus(o);this.proOpnView.dispatchEvent("OnUpdateProposedStatus",[a])}},launchSearchForSolutionItems:function(e){if(u.getGlobalVariable().isNative){m.DispatchEventToWin("Add_Resolution","AddResolutionItem")}else{var t=h.activateSearch(u.getGlobalVariable().proposedSearchType,"resolutionItems");h.search("Identify Solutions",u.getGlobalVariable().proposedSearchType,this.OnSearchComplete,"resolutionItems",t)}},launchRevisionExplorerForSolutionItems:function(e,i){var n=this,o=e.get("objectId"),a=e.get("objectType");this._versionExplorerContainer=UWA.createElement("div",{styles:{height:"100%",width:"100%"}}),this.versionExplorer=new f({versionGraphContainer:this._versionExplorerContainer,selectionMode:C.SELECTION_MODES.SINGLE_SELECT_ONLY,autoUpdate:!0,showToolbar:!1,displayMode:C.DISPLAY_MODES.SUBWAY_VIEW,widget:widget});var s={};s.displayMode=C.DISPLAY_MODES.SUBWAY_VIEW,v.loadUserSettingsPromise(s).then(function(){n.versionExplorer.publishEvent("ENOXVersionExplorerLoadVersionModel",{id:o,tenantId:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",type:a,securityContext:u.getGlobalVariable().getSecurityContext().replace("ctx::",""),dataModelType:C.DATA_MODEL_TYPES.MODEL_ER}),n.versionExplorer.subscribeEvent("ENOXVersionExplorerModalOK",function(o){var a=[],s=o;if(s&&Array.isArray(s))for(var r=0;r<s.length;r++){var l=s[r];if(l&&l._options&&l._options.data){var c=l._options.data.id;a.push(c)}}if(a.length>0)if(i)if("Flowdown"===e.get("operationActual")){var d="",p=e.get("resolutionItems");if(p&&p[0])d=p[0].id;var u={amoID:e.get("amoID"),upstreamCAId:e.get("flowDownFromId"),selectedObjID:a[0],resolutionItemId:d};n.proOpnView.dispatchEvent("OnAddResolutionItemForFlowdown",[u])}else{u={proposedId:e.get("id"),selectedObjID:a[0]};var h=_.getJSONForAddResolution(u);n.proOpnView.dispatchEvent("OnAddResolutionItem",[h])}else if("Complete"===e.get("status"))S.error(t.ECM_CA_PROPOSED_STATUS_COMPLETED_ERR);else{u={};a[0]="pid:"+a[0],u.objectsToAddArr=a,u.proposedToRemove=e,n.proOpnView.dispatchEvent("onHigherRevisionSelected",[u])}else S.warn(t.ECM_CA_RESOLUTION_NO_OBJECT_SELECTED_WARNING)}),n.versionExplorer.subscribeEvent("ENOXVersionExplorerModalCancel",function(){})}),this.versionExplorer.showDialog({clientX:0,clientY:0},widget.body,!0)},changeAccordIconAndExpandTile:function(e){var t=this.container.getElement("#accordion-div-"+e),i=t.getElementsByTagName("span")[0].className;i.indexOf("expand-right")>0?t.getElementsByTagName("span")[0].className=i.replace("right","down").trim():i.indexOf("expand-down")>0&&(t.getElementsByTagName("span")[0].className=i.replace("down","right").trim()),_.accordionClassName=t.getElementsByTagName("span")[0].className,_.expandTile(e)},expandTile:function(e){this.makeActivitiesView(this.container.myProposedModel.at(e),e);var t=document.getElementById("expanded-"+e);if(t){var i=t.className;if(i.indexOf("hidden")>0){t.className=i.replace("hidden","").trim();if(t&&t.getElement){t.getElement(".activity-content");var n=t.getElement(".activities-chevron").children[0].children[0],o=n.className;o.indexOf("expand-right")>0&&(n.className=o.replace("right","down").trim())}}else t.className=i+" hidden"}var a=document.getElementById("collapsed-"+e);a&&(a.style.borderBottom.indexOf("hidden")>=0?a.style.borderBottom="":a.style.borderBottom="hidden"),_.selectedTilesIDMap.set(e,e),_.selectedTilesMap.set(e,a),_.onResize(e)},makeActivitiesView:function(e,t){var i=e.get("activities"),n="#expanded-"+t,o=this.container.getElement(n);if(o){if(o.getElement(".proposed-activities-activities-holder"))return;this.activitiesView=new(s._createView_TestProposed(!1,i,t)),this._actvitiesEvents={deleteActivity:function(){var e={};e.operationIdx=t,this.dispatchEvent("deleteActivity",[arguments[1],e])},editActivity:function(){var e={};e.operationIdx=t,this.dispatchEvent("editActivity",[arguments[1],e])},onActionClickActivities:function(){var e=this.myProposedModel.at(t),i=arguments[1].model.get("id"),n={};n.operationIdx=t,n.idOfAction=i,this.dispatchEvent("onActionClickActivities",[e,n])},removeMultiSelActvities:function(){var e={};e.operationIdx=t,this.dispatchEvent("removeMultiSelActvities",[arguments[0],e])}};this.container.listenTo(this.activitiesView,this._actvitiesEvents),this.container.injectSubView(this.activitiesView,n)}},deactivateMultisel:function(){for(var e=_.container.container,t=e.getElements(".proposedOperation-actions-container"),i=0;i<t.length;i++){t[i].removeClassName("no-actions")}var n=e.getElements(".accordion-div-inner"),o=e.getElements(".checkbox-accord");for(i=0;i<n.length;i++){var a=n[i];a.removeClassName("hidden");var s=a.getElementsByTagName("span")[0].className;s.indexOf("expand-down")>0&&(a.getElementsByTagName("span")[0].className=s.replace("down","right").trim());var r=o[i];r.checked&&(r.checked=!1),r.addClassName("hidden")}var l=e.getElements(".proposedOperation-main-container");for(i=0;i<l.length;i++){l[i].removeClassName("selected-border")}_.onResize()},activateMultisel:function(){for(var e=_.container.container,t=e.getElements(".proposedOperation-actions-container"),i=0;i<t.length;i++){t[i].addClassName("no-actions")}var n=e.getElements(".accordion-div-inner"),o=e.getElements(".checkbox-accord");for(i=0;i<n.length;i++){var a=n[i];o[i].removeClassName("hidden"),a.addClassName("hidden")}var s=e.getElements(".proposed-tile-expanded");for(i=0;i<s.length;i++){var r=s[i];!1===r.hasClassName("hidden")&&r.addClassName("hidden")}var l=e.getElements(".proposed-tile-collapsed");for(i=0;i<l.length;i++){l[i].style.borderBottom=""}_.onResize()},resizeForTabletView:function(e,t){e.middleSubContainer&&(t.indexOf("expand-right")>=0?e.middleSubContainer.css("display","none"):t.indexOf("expand-down")>=0&&(e.middleSubContainer.css("display","block"),e.middleSubContainer.css("padding-top","3px"),e.middleSubContainer.css("border-right","none"))),e.secondSubContainer&&e.secondSubContainer.css("flex-basis","auto"),null!=e.matCollabContainerElem&&e.matCollabContainerElem.css("display","block"),null!=e.matContainerElem&&e.matContainerElem.css("margin-right","0px"),null!=e.collabContainerElem&&e.collabContainerElem.css("margin-left","0px"),null!=e.moreInfoContainerElem&&(e.moreInfoContainerElem.css("flex-direction","row"),e.moreInfoContainerElem.css("-webkit-flex-direction","row"),e.moreInfoContainerElem.css("-ms-flex-direction","row"),t.indexOf("expand-down")>=0?e.moreInfoContainerElem.css("padding-bottom","10px"):t.indexOf("expand-right")>=0&&(e.moreInfoContainerElem.css("border-bottom","none"),e.moreInfoContainerElem.css("padding-bottom","0px"))),e.flowDownContainer&&(t.indexOf("expand-right")>=0&&e.flowDownContainer.css("display","none"),t.indexOf("expand-down")>=0&&e.flowDownContainer.css("display","flex")),e.statusResolutionContainer&&(t.indexOf("expand-right")>=0&&e.statusResolutionContainer.css("display","none"),t.indexOf("expand-down")>=0&&e.statusResolutionContainer.css("display","flex")),e.collapsedOperationContainer&&e.collapsedOperationContainer.css("display","none"),e.nameOperationContainer&&e.nameOperationContainer.css("display","block"),null!=e.reasonElem[0]&&(t.indexOf("expand-right")>=0?(e.reasonElem.css("display","none"),e.flowDownElem&&e.flowDownElem.css("display","none"),e.moreElem&&e.moreElem.css("display","none")):t.indexOf("expand-down")>=0&&(e.reasonElem.css("display","-webkit-box"),e.reasonElem.css("display","flex"),e.reasonElem.css("display","-moz-box"),e.reasonElem.css("display","-webkit-flexbox"),e.reasonElem.css("display","-ms-flexbox"),e.reasonElem.css("display","-webkit-flex"),e.reasonElem.css("display","flex"),e.reasonElem.css("margin-top","10px"),e.flowDownElem&&(e.flowDownElem.css("display","-webkit-box"),e.flowDownElem.css("display","flex"),e.flowDownElem.css("display","-moz-box"),e.flowDownElem.css("display","-webkit-flexbox"),e.flowDownElem.css("display","-ms-flexbox"),e.flowDownElem.css("display","-webkit-flex"),e.flowDownElem.css("display","flex"),e.flowDownElem.css("margin-top","10px")),e.moreElem&&0!=e.reasonElem[0].clientHeight&&(e.reasonElem[0].clientHeight<e.reasonElem[0].scrollHeight||"none"===e.reasonElem.css("max-height"))&&(e.moreElem.css("display","-webkit-box"),e.moreElem.css("display","-moz-box"),e.moreElem.css("display","-webkit-flexbox"),e.moreElem.css("display","-ms-flexbox"),e.moreElem.css("display","-webkit-flex"),e.moreElem.css("display","flex"))))},resizeForMobileView:function(e,t){e.collapsedOperationContainer&&(t.indexOf("expand-down")>=0?e.collapsedOperationContainer.css("display","none"):t.indexOf("expand-right")>=0&&e.collapsedOperationContainer.css("display","flex")),e.nameOperationContainer&&(t.indexOf("expand-down")>=0?e.nameOperationContainer.css("display","block"):t.indexOf("expand-right")>=0&&e.nameOperationContainer.css("display","none")),e.matCollabContainerElem&&(t.indexOf("expand-down")>=0?e.matCollabContainerElem.css("display","block"):t.indexOf("expand-right")>=0&&e.matCollabContainerElem.css("display","none")),e.middleSubContainer&&(t.indexOf("expand-right")>=0?e.middleSubContainer.css("display","none"):t.indexOf("expand-down")>=0&&(e.middleSubContainer.css("display","block"),e.middleSubContainer.css("padding-top","3px"),e.middleSubContainer.css("border-right","none"))),e.secondSubContainer&&e.secondSubContainer.css("flex-basis","auto"),e.moreInfoContainerElem&&(t.indexOf("expand-down")>=0||t.indexOf("expand-right")>=0&&e.matCollabContainerElem.css("display","none")),e.flowDownContainer&&(t.indexOf("expand-right")>=0&&e.flowDownContainer.css("display","none"),t.indexOf("expand-down")>=0&&e.flowDownContainer.css("display","flex")),e.statusResolutionContainer&&(t.indexOf("expand-right")>=0&&e.statusResolutionContainer.css("display","none"),t.indexOf("expand-down")>=0&&e.statusResolutionContainer.css("display","flex")),e.reasonElem[0]&&(t.indexOf("expand-right")>=0?(e.reasonElem.css("display","none"),e.flowDownElem&&e.flowDownElem.css("display","none"),e.moreElem&&e.moreElem.css("display","none")):t.indexOf("expand-down")>=0?(e.reasonElem.css("display","-webkit-box"),e.reasonElem.css("display","-moz-box"),e.reasonElem.css("display","-webkit-flexbox"),e.reasonElem.css("display","-ms-flexbox"),e.reasonElem.css("display","-webkit-flex"),e.reasonElem.css("display","flex"),e.reasonElem.css("margin-top","5px"),e.flowDownElem&&(e.flowDownElem.css("display","-webkit-box"),e.flowDownElem.css("display","-moz-box"),e.flowDownElem.css("display","-webkit-flexbox"),e.flowDownElem.css("display","-ms-flexbox"),e.flowDownElem.css("display","-webkit-flex"),e.flowDownElem.css("display","flex"),e.flowDownElem.css("margin-top","5px")),e.moreElem&&0!=e.reasonElem[0].clientHeight&&(e.reasonElem[0].clientHeight<e.reasonElem[0].scrollHeight||"none"===e.reasonElem.css("max-height"))&&(e.moreElem.css("display","-webkit-box"),e.moreElem.css("display","-moz-box"),e.moreElem.css("display","-webkit-flexbox"),e.moreElem.css("display","-ms-flexbox"),e.moreElem.css("display","-webkit-flex"),e.moreElem.css("display","flex"),e.moreElem.css("margin-top","5px"))):""===t&&e.reasonElem.css("display","none"))},resizeForOthers:function(e,t){e.middleSubContainer&&(e.middleSubContainer.css("display","block"),e.middleSubContainer.css("border-right","2px solid #d1d4d4")),e.secondSubContainer&&(e.secondSubContainer.css("-webkit-box-flex","1"),e.secondSubContainer.css("-moz-box-flex","1"),e.secondSubContainer.css("-ms-flex","1"),e.secondSubContainer.css("-webkit-flex","1"),e.secondSubContainer.css("flex","1")),e.reasonElem&&(e.reasonElem.css("margin-top","0px"),e.reasonElem.css("display","-webkit-box"),e.reasonElem.css("display","-ms-flexbox"),e.reasonElem.css("display","-moz-box"),e.reasonElem.css("display","-webkit-flexbox"),e.reasonElem.css("display","-ms-flexbox"),e.reasonElem.css("display","-webkit-flex"),e.reasonElem.css("display","flex")),e.flowDownElem&&(e.flowDownElem.css("margin-top","0px"),e.flowDownElem.css("display","-webkit-box"),e.flowDownElem.css("max-height","3.6em"),e.flowDownElem.css("display","-ms-flexbox"),e.flowDownElem.css("display","-moz-box"),e.flowDownElem.css("display","-webkit-flexbox"),e.flowDownElem.css("display","-ms-flexbox"),e.flowDownElem.css("display","-webkit-flex"),e.flowDownElem.css("display","flex"),e.flowDownElem.css("align-items","center")),e.moreElem&&e.moreElem.css("display","none"),e.firstSubContainer&&(e.firstSubContainer.css("border-bottom","none"),e.firstSubContainer.css("padding-bottom","0px")),e.secondSubContainer&&e.secondSubContainer.css("margin-right","30px"),e.matCollabContainerElem&&e.matCollabContainerElem.css("display","block"),e.matContainerElem&&e.matContainerElem.css("margin-right","0px"),e.collabContainerElem&&e.collabContainerElem.css("margin-left","0px"),e.moreInfoContainerElem&&(e.moreInfoContainerElem.css("flex-direction","row"),e.moreInfoContainerElem.css("-webkit-flex-direction","row"),e.moreInfoContainerElem.css("-ms-flex-direction","row"),e.moreInfoContainerElem.css("border-bottom","none"),e.moreInfoContainerElem.css("padding-bottom","0px")),e.changeReasonText&&(e.changeReasonText.css("max-height","none"),e.changeReasonText.css("overflow","hidden"),e.changeReasonText.css("white-space","nowrap")),e.flowDownContainer&&e.flowDownContainer.css("display","flex"),e.statusResolutionContainer&&e.statusResolutionContainer.css("display","flex"),e.nameOperationContainer&&e.nameOperationContainer.css("display","block"),e.collapsedOperationContainer&&e.collapsedOperationContainer.css("display","none")},resizeProposedOperations:function(e,t){void 0===e&&(e=_.collapsedTile);var i={};if(e){var n=e.id.trim();i.reasonElem=c("#"+n).find(".proposedOperation-change-reason-container"),i.flowDownElem=c("#"+n).find(".proposedOperation-flowdown-from"),i.moreElem=c("#"+n).find(".proposedOperation-more-container"),i.firstSubContainer=c("#"+n).find(".proposedOperation-sub-container-first"),i.middleSubContainer=c("#"+n).find(".proposedOperation-sub-container-middle"),i.secondSubContainer=c("#"+n).find(".proposedOperation-sub-container-second"),i.matCollabContainerElem=c("#"+n).find(".proposedOperation-mat-collab-container"),i.matContainerElem=c("#"+n).find(".proposedOperation-mat-container"),i.collabContainerElem=c("#"+n).find(".proposedOperation-collab-container"),i.moreInfoContainerElem=c("#"+n).find(".proposedOperation-more-info-container"),i.proposedOpActionsContainerElem=c(".proposedview-proposedActions"),i.statusResolutionContainer=c("#"+n).find(".proposedOperation-status-solution-container"),i.flowDownContainer=c("#"+n).find(".proposedOperation-flowdown-info-container"),i.changeReasonText=c("#"+n).find(".proposedOperation-reason-text-container"),i.nameOperationContainer=c("#"+n).find(".proposedOperation-desc-op-container"),i.collapsedOperationContainer=c("#"+n).find(".proposedOperation-collab-container-op-container")}var o="laptop",a=window.matchMedia("(max-width: 992px) and (min-width: 768px)"),s=window.matchMedia("(max-width: 768px)");switch(a.matches&&(o="tablet"),s.matches&&(o="mobile"),o){case"tablet":_.resizeForTabletView(i,t);break;case"mobile":_.resizeForMobileView(i,t);break;case"laptop":_.resizeForOthers(i,t);break;default:console.log("invalid viewport selected")}},onResize:function(e){_.selectedTilesMap.forEach(function(e,t){var i="",n="";e&&(n=e.id);var o=c("#"+n).find(".fonticon");o&&(i=o[0].className),_.resizeProposedOperations(e,i)})},getJSONForUpdateStatus:function(e){var t=_.getJSONForModifyProposed(),i="";if(""!=e.status&&(i=e.status),UWA.is(e.selectedIDs)&&Array.isArray(e.selectedIDs))for(var n=0;n<e.selectedIDs.length;n++){var o=e.selectedIDs[n];if(""!=o){var a={id:o,status:i};t.changeaction.modify.proposed.push(a)}}return t},getJSONForAddResolution:function(e){var t=_.getJSONForModifyProposed(),i=[];""!=e.selectedObjID&&i.push("pid:"+e.selectedObjID);var n={id:e.proposedId,resolution:i};return t.changeaction.modify.proposed.push(n),t},getJSONForModifyOperation:function(e){var t=_.getJSONForModifyProposed();UWA.is(e.activityActual)&&"NoSelection"!=e.activityActual&&(t.changeaction.add.proposed=[]);var i=e.operation,n=e.operationWHY,o=e.status,a="",s="";if("Create"==i)a={id:e.pid,operation:{name:i,type:e.objectType,"display name":e.objectName},why:{comment:{text:n}}},t.changeaction.modify.proposed.push(a);else for(var r=e.proposedIDArr,l=0;l<r.length;l++){var c=r[l];if("NoSelection"==i?a={id:c,why:{comment:{text:n}},status:o}:(a={id:c,operation:{name:i},why:{comment:{text:n}}}).operation["evolution name"]=e.evolutionName,t.changeaction.modify.proposed.push(a),UWA.is(e.activityActual)&&"NoSelection"!=e.activityActual){s={id:c,activities:[]};var d="";"Modify"==e.activityActual?d={what:{operation:"Modify"},why:{comment:{text:e.reasonForChangeForActivity}}}:"Release"==e.activityActual?d={what:{operation:"ChangeStatus","target state":"Release"},why:{comment:{text:e.reasonForChangeForActivity}}}:"Obsolete"==e.activityActual?d={what:{operation:"ChangeStatus","target state":"Obsolete"},why:{comment:{text:e.reasonForChangeForActivity}}}:"Restore"==e.activityActual&&(d={what:{operation:"ChangeStatus","target state":"Restore"},why:{comment:{text:e.reasonForChangeForActivity}}}),s.activities.push(d),t.changeaction.add.proposed.push(s)}}return t},getJSONForModifyProposed:function(){var e=_.getCABaseJSONForOperations();return e.changeaction.modify={proposed:[]},e},getJSONForAddProposed:function(){var e=_.getCABaseJSONForOperations();return e.changeaction.add={proposed:[]},e},getCABaseJSONForOperations:function(){return JSON.parse(JSON.stringify({version:"v0",changeaction:{cestamp:"0000",add:{},delete:{},modify:{}}}))},getFlowdownContextOptions:function(){return _.flowdownForContextOptions},setFlowdownContextOptions:function(e){_.flowdownForContextOptions=e}};return _}),define("DS/ENOChangeActionUX/scripts/Models/CAProposedModel",["UWA/Class/Model","DS/ENOChangeActionUX/scripts/Models/CAProposedActivityModel","DS/ENOChangeActionUX/scripts/Services/CAProposedViewServices","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","require","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChgServices/scripts/services/ChgDataProcess"],function(e,t,i,n,o,a,s){"use strict";return e.extend({idAttribute:"id",setup:function(){},fetch:function(e){var t=e.proposedArr;return e.ajax=function(e,i){myoptions.onComplete(t)},e.url="dummyURL",this._parent(e)},parse:function(e){var i="Cannot be found",n={};if(e.flowdownElements)n=this._parseForFlowdownOperation(e);else{n.id=e.id,n.Access=!0;var o=e.where.info;if(n.operationActual=e.operation.name,n.operationDisplay=this.getOperationNameOnUI(e.operation.name),UWA.is(e.operation.name)&&"Create"==e.operation.name?(n.maturity="",n.policy="",n.revision="",n.type=e.operation.type,n.name=e.operation["display name"],n.objectName=e.operation["display name"],n.objectTitle=e.operation["display name"],n.objectId=e.id):(n.maturity=o.currentNLS,n.policy=o.policy,n.revision=o.revision,n.type=o.typeNLS,n.name=o["display name"],n.objectName=o["display name"],o["display name"]!=i&&"Access denied"!=o["display name"]?n.objectTitle=o["display name"]:"Access denied"==o["display name"]?n.objectTitle=a.ECM_CA_Access_Denied:n.objectTitle=a.ECM_CA_Cannot_be_found,n.objectType=o.type,n.objectId=e.where.id,n.evolutionName=e.operation["evolution name"],""!=n.maturity&&"Access denied"!=n.maturity&&n.maturity!=i&&null!=n.maturity||(n.Access=!1)),e.why.comment&&e.why.comment.text){var s=UWA.String.escapeHTML(e.why.comment.text);n.changeReason=s}else n.changeReason="";if(e.flowdownInfo&&e.flowdownInfo.flowdownFrom&&1===e.flowdownInfo.flowdownFrom.length?(n.flowdownInfo=e.flowdownInfo,n.flowDownFromName=e.flowdownInfo.flowdownFrom[0].caName,n.flowDownFromId=e.flowdownInfo.flowdownFrom[0].caID,n.flowDownFromTitle=e.flowdownInfo.flowdownFrom[0].caTitle,n.flowdownForObjectId=e.flowdownInfo.flowdownFor[0].id,n.flowdownForObjectTitle=e.flowdownInfo.flowdownFor[0].info["display name"],n.flowdownForObjectType=e.flowdownInfo.flowdownFor[0].info.type,n.flowdownForObjectTypeNLS=e.flowdownInfo.flowdownFor[0].info.typeNLS):e.flowdownInfo&&e.flowdownInfo.flowdownFrom&&e.flowdownInfo.flowdownFrom.length>1?n.flowdownInfo=e.flowdownInfo:(n.flowdownForObjectId="",n.flowdownForObjectTitle="",n.flowdownForObjectType="",n.flowdownForObjectTypeNLS="",n.flowDownFromTitle="",n.flowDownFromId="",n.flowDownFromName="",n.flowdownInfo=null),UWA.is(e.activities)&&o["display name"]!=i&&"Access denied"!=o["display name"]){var r=new UWA.Class.Collection,l=e.activities;Array.isArray(l)&&(l.forEach(function(i){i.objectId=e.where.id,null!=r.get(i.id)||r.add(new t(i,{parse:!0}))}),this.set("activities",r))}UWA.is(e.resolution)&&Array.isArray(e.resolution)?n.resolutionItems=e.resolution:n.resolutionItems=[],UWA.is(e.status)&&""!=e.status?o["display name"]!=i&&"Access denied"!=o["display name"]&&(n.status=e.status,"Not Started"===n.status&&(n.statusNLS=a.ECM_PROPOSED_STATUS_NOT_STARTED_COMMAND),"Started"===n.status&&(n.statusNLS=a.ECM_PROPOSED_STATUS_STARTED_COMMAND),"Ignored"===n.status&&(n.statusNLS=a.ECM_PROPOSED_STATUS_IGNORE_COMMAND),"Rejected"===n.status&&(n.statusNLS=a.ECM_PROPOSED_STATUS_REJECT_COMMAND),"Complete"===n.status&&(n.statusNLS=a.ECM_PROPOSED_STATUS_COMPLETE_COMMAND),"Partial"===n.status&&(n.statusNLS=a.ECM_PROPOSED_STATUS_PARTIAL_COMMAND)):n.status=""}return n},_parseForFlowdownOperation:function(e){var t={},i="Cannot be found";t.Access=!0,t.id=e.id;var n=e.where.info;t.operationActual="Flowdown",t.operationDisplay=this.getOperationNameOnUI("Flowdown"),t.flowdownInfo=e.flowdownInfo,t.maturity=n.currentNLS,t.policy=n.policy,t.revision=n.revision,t.type=n.typeNLS,t.name=n["display name"],t.objectName=n["display name"],n["display name"]!=i&&"Access denied"!=n["display name"]?(t.objectTitle=n["display name"],t.flowdownForObjectTitle=n["display name"]):"Access denied"==n["display name"]?(t.objectTitle=a.ECM_CA_Access_Denied,t.flowdownForObjectTitle=a.ECM_CA_Access_Denied):(t.objectTitle=a.ECM_CA_Cannot_be_found,t.flowdownForObjectTitle=a.ECM_CA_Cannot_be_found),t.objectType=n.type,t.objectId=e.where.id,t.flowdownForObjectId=e.where.id,t.flowdownForObjectType=n.type,t.flowdownForObjectTypeNLS=n.typeNLS;var o=e.flowdownElements,s=(o.map(function(e){return e.elementPointedCAId}),e.flowdownResolutions);if(e.flowdownResolutions.length>0){var r=[];for(var l in s){var c=s[l];c&&c.resolutionObject&&r.push(c.resolutionObject)}t.resolutionItems=r}else t.resolutionItems=[];for(var l in o)if(n["display name"]!=i&&"Access denied"!=n["display name"]){var d=o[l];d&&(t.flowDownFromTitle=d.elementPointedCATitle,t.flowDownFromId=d.elementPointedCAId,t.amoID=d.elementPointedId,t.flowDownFromName=d.elementPointedCATitle,t.status=d.elementStatus,t.syncStatus=d.elementSyncStatus,"Flowdown Pending"!==t.status&&"Started"!==t.status||(t.statusNLS=a.ECM_PROPOSED_STATUS_STARTED_COMMAND),"Rejected"===t.status&&(t.statusNLS=a.ECM_PROPOSED_STATUS_REJECT_COMMAND),"Flowdown Complete"!==t.status&&"Complete"!==t.status||(t.statusNLS=a.ECM_PROPOSED_STATUS_COMPLETE_COMMAND),"Flowdown Complete"!==t.status&&"Complete"!==t.status||"Updated"!==t.syncStatus&&"Transferred"!==t.syncStatus||(t.statusNLS=a.ECM_PROPOSED_STATUS_STARTED_COMMAND))}return""!=t.maturity&&"Access denied"!=t.maturity&&t.maturity!=i&&null!=t.maturity||(t.Access=!1),e.why&&e.why.comment&&e.why.comment.text?t.changeReason=e.why.comment.text:t.changeReason="",t},getOperationNameOnUI:function(e){var t="";switch(e){case"None":t=a.ECM_CA_Proposed_Activity_Modify;break;case"NewVersion":t=a.ECM_CA_Proposed_Operation_Revision;break;case"NewMinorVersion":t=a.ECM_CA_Proposed_Operation_MinorRevision;break;case"NewEvolution":t=a.ECM_CA_Proposed_Operation_Evolution;break;case"Create":t=a.ECM_CA_Proposed_Operation_Create;break;case"Modify":t=a.ECM_CA_Proposed_Activity_Modify;break;case"ChangeStatus":t=a.ECM_CA_Proposed_Activity_ChangeStatus;break;case"Release":t=a.ECM_CA_Proposed_Activity_State_Release;break;case"Obsolete":t=a.ECM_CA_Proposed_Activity_State_Obsolete;break;case"Flowdown":t=a.ECM_CA_Proposed_Operation_Flowdown;break;default:t="??Something went wrong??"}return t}})}),define("DS/ENOChangeActionUX/scripts/Collection/CAProposedCollection",["UWA/Core","UWA/Class/Collection","DS/ENOChangeActionUX/scripts/Models/CAProposedModel"],function(e,t,i){"use strict";return t.extend({model:i,setup:function(){},fetch:function(e){var t;return t=e.data=this.proposedArr=e.proposedArr,e.ajax=function(e,i){i.onComplete(t)},this.url="dummyURL",this._parent(e)}})}),define("DS/ENOChangeActionUX/scripts/Views/CARealizedActivitiesSelectedProposedView",["UWA/Class/View","UWA/Core","DS/Handlebars/Handlebars4","DS/PlatformAPI/PlatformAPI","DS/ENOChangeActionUX/scripts/Services/CARealizedViewServices","DS/ENOChangeActionUX/scripts/Services/CAProposedViewServices","DS/UIKIT/Popover","DS/ENOChangeActionUX/scripts/Views/CAPopOverBodyView","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e,t,i,n,o,a,s,r,l){"use strict";return e.extend({clonedContent:[],init:function(e){this.options=e,this.clonedContent=this.options.data,this._parent.call(this,e)},setup:function(){this.template='                <div class="selected-proposed-container">                    <span class="selected-proposed-label">{{selectedProposedLabel}}</span>                    {{#if singleItem}}                    <span class="selected-proposed-label-obejct text" title="{{itemTitle}}">                        <span class="formatted-label"> {{itemTitle}}</span>                        <span class="supp-icon" id={{id}}></span>                    </span>                    {{else}}                    <span><a class="multiple-proposed" id="targetid">{{itemLength}} '+l.ECM_SELECTED_PROPOSED_ITEMS_LABEL+"</a></span>                    {{/if}}                </div>",this.renderer=this.getTemplate()},render:function(){this.container.empty();var e=this.renderer();return this.container.addContent(e),this},getTemplate:function(){var e=i.compile(this.template),t=this;this.data={};var n=this.clonedContent,o="";if(UWA.is(n)&&Array.isArray(n)){if(n&&1===n.length){var a=n[0].proposedTitle,s=n[0].proposedRevision,r=n[0].proposedId.replace("pid:","");o=a+" "+s}else n&&n.length>1&&(o=n.length+" "+l.ECM_SELECTED_PROPOSED_ITEMS_LABEL);this.data={selectedProposedLabel:l.ECM_SELECTED_PROPOSED_OBJECTS,singleItem:1===n.length&&n.length>0,itemTitle:o,itemLength:n.length},UWA.is(r)&&""!=r&&(this.data.id=r)}return function(){return e(t.data)}},domEvents:{"click .multiple-proposed":function(e){e.stopPropagation(),e.preventDefault();var t=this.options.data,i={target:e.target,selectedItems:t,contextObj:this};this.launchMultiplePopover(i)},"click .supp-icon":function(e){this.resetContent(e)}},launchMultiplePopover:function(e){this.proposedPopover&&this.proposedPopover.destroy();var t=this.proposedPopover=new s({className:"selectedPopover",target:e.target,position:"right",trigger:"click touch",autoHideOnClickOutside:!0,title:l.ECM_SELECTED_PROPOSED_OBJECTS,events:{onShow:function(){document.querySelector(".popover")&&document.querySelector(".popover").show()}}}).show(),i={objectsSelected:e.selectedItems,container:t.elements.body,bodyOf:"multipleSelectedProposed"};this.popOverBodyview&&this.popOverBodyview.destroy();var n=this.popOverBodyview=new r(i);n.render();var o=this;this.updateContent=this.updateContent.bind(this);var a={crossClicked:function(e){var t=e,i=o.options.baseAMO;this.updateContent(t);var n={itemObjID:t,amoID:i};this.dispatchEvent("crossClicked",[n])}};this.listenTo(n,a)},resetContent:function(e){this.container.empty(),this.options.statusComboBox.selectedIndex=0,this.options.idOfContextObj&&(o[this.options.idOfContextObj].fromFreeSearch=[],o[this.options.idOfContextObj].fromRelationsTab=[],o[this.options.idOfContextObj].fromAddResolutionTab=[]);var t=this.options.amoBasedInfo;if(t){var i=Object.keys(t);for(var n in i){var a=t[i[n]];a&&a.resolutionItems&&(a.resolutionItems=[],a=null)}}t=null},updateContent:function(e){var t=this.clonedContent.filter(function(t){return e=e.replace("pid:",""),t.proposedId.replace("pid:","")!=e});if(this.clonedContent=t,1===t.length){var i=t[0].proposedTitle,n=t[0].proposedRevision,o=t[0].proposedId.replace("pid:",""),a=i+" "+n;(s=this.container.getElement(".selected-proposed-container")).innerHTML="",s.innerHTML='                    <span class="selected-proposed-label">'+l.ECM_SELECTED_PROPOSED_OBJECTS+'</span>                        <span class="selected-proposed-label-obejct text">                            <span class="formatted-label">'+a+'</span>                            <span class="supp-icon" id="'+o+'"}></span>                        </span>'}else if(t.length>1){var s;(s=this.container.getElement(".multiple-proposed")).innerHTML="",s.innerHTML=t.length+" "+l.ECM_SELECTED_PROPOSED_ITEMS_LABEL}else this.resetContent()},destroy:function(){}})}),define("DS/ENOChangeActionUX/scripts/Models/CAProposedModelForDisplayView",["UWA/Class/Model","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","UWA/Core","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChangeActionUX/scripts/Services/CAProposedViewServices","DS/ENOChgServices/scripts/services/ChgErrors"],function(e,t,i,n,o,a,s,r){"use strict";return e.extend({idAttribute:"id",setup:function(){this.addEvent("onChange:operationDisplaySelect",function(e){this.updateOperationDisplayInfo(e)}),this.addEvent("onChange:operationActual",function(e){this.updateOperationDisplaySelectInfo(e)}),this.addEvent("onChange:activityDisplaySelect",function(e){this.updateActivityDisplayInfo(e)}),this.addEvent("onChange:activityActual",function(e){this.updateActivityDisplaySelectInfo(e)}),this.addEvent("onChange:proposedObject",function(e){this.updateAllowedOperationInfo(e)}),this.addEvent("onChange:createNewToggle",function(e){UWA.is(e.get("createNewToggle"))&&"TRUE"==e.get("createNewToggle")?e.set("isCreateOperation",!0):e.set("isCreateOperation",!1)})},parse:function(e){var i=e.model;if(this.set("canEdit",!0),UWA.is(e.selectedOperation)){var n=[{displayValue:"",actualValue:"NoSelection"},{displayValue:s.getOperationNameOnUI("None"),actualValue:"None"},{displayValue:s.getOperationNameOnUI("NewEvolution"),actualValue:"NewEvolution"},{displayValue:s.getOperationNameOnUI("NewMinorVersion"),actualValue:"NewMinorVersion"},{displayValue:s.getOperationNameOnUI("NewVersion"),actualValue:"NewVersion"}];this.set("operationDisplayOptions",n);var o={displayValue:"",actualValue:"NoSelection"};this.set("operationDisplaySelect",o),this.set("operationDisplay",o.displayValue),this.set("operationActual",o.actualValue);var a=[{displayValue:s.getOperationNameOnUI("NoSelection"),actualValue:"NoSelection"},{displayValue:s.getOperationNameOnUI("Modify"),actualValue:"Modify"},{displayValue:t.ECM_CA_Proposed_Activity_ChangeMaturity+": "+s.getOperationNameOnUI("Release"),actualValue:"Release"},{displayValue:t.ECM_CA_Proposed_Activity_ChangeMaturity+": "+s.getOperationNameOnUI("Obsolete"),actualValue:"Obsolete"},{displayValue:t.ECM_CA_Proposed_Activity_ChangeMaturity+": "+s.getOperationNameOnUI("Restore"),actualValue:"Restore"}];this.set("activityDisplayOptions",a);var r={displayValue:s.getOperationNameOnUI("NoSelection"),actualValue:"NoSelection"};this.set("activityDisplaySelect",r),this.set("activityDisplay",r.displayValue),this.set("activityActual",r.actualValue)}else if(UWA.is(i.id)){var l={};this.set("isEdit",!0),this.set("id",i.id),l.objectType=i.get("objectType"),l.objectName=i.get("objectTitle"),l.objectRev=i.get("revision"),l.objectName=l.objectName+" "+l.objectRev,l.objectID=i.get("objectId").replace("pid:",""),l.maturity=i.get("maturity"),l.policy=i.get("policy"),l.image={imageValue:i.get("icon")},this.set("createObjectTitle",i.get("name")),this.set("createObjectType",i.get("type")),this.set("proposedObject",l),this.set("evolutionName",UWA.is(i.get("evolutionName"))?i.get("evolutionName"):""),this.set("operationActual",i.get("operationActual")),"Create"==i.get("operationActual")?this.set("isCreateOperation",!0):this.set("isCreateOperation",!1),"NewEvolution"==i.get("operationActual")?this.set("isEvolutionOperation",!0):this.set("isEvolutionOperation",!1),this.updateOperationDisplaySelectInfo(this),this.updateAllowedOperationInfo(this),this.set("reasonForChange",UWA.String.unescapeHTML(i.get("changeReason")))}},add:function(e,t,i){var n={},o=this,s=t,r=[s];a.getAdditionObjectInfo(r).then(function(t){n.objectType=t.additionObjectInfo[s].type,n.objectName=t.additionObjectInfo[s].objectTitle,n.objectRev=t.additionObjectInfo[s].revision,n.objectName=n.objectName+" "+n.objectRev,n.objectID=t.additionObjectInfo[s].pid,n.policy=t.additionObjectInfo[s].policy,n.image={imageValue:t.additionObjectInfo[s].icon},n.maturity=t.additionObjectInfo[s].stateNLS;var i=o.get(e);UWA.is(i,"object")&&o.unset(e),o.set(e,n)},function(e){return console.log("Populate Security Context failed"),Promise.reject(e)})},remove:function(e,t,i){var n=this.get(e);UWA.is(n,"object")&&(this.unset("operationActual",{silent:!0}),this.unset(e))},updateOperationDisplaySelectInfo:function(e){var t=e.get("operationActual");require(["DS/ENOChangeActionUX/scripts/Services/CAProposedViewServices"],function(i){var n=i.getOperationNameOnUI(t);e.set("operationDisplaySelect",{displayValue:n,actualValue:t},{silent:!0}),e.set("operationDisplay",n)})},updateActivityDisplaySelectInfo:function(e){var i=e.get("activityActual");require(["DS/ENOChangeActionUX/scripts/Services/CAProposedViewServices"],function(n){var o=n.getOperationNameOnUI(i);"Release"!=i&&"Obsolete"!=i&&"Restore"!=i||(o=t.ECM_CA_Proposed_Activity_ChangeMaturity+": "+o),e.set("activityDisplaySelect",{displayValue:o,actualValue:i},{silent:!0}),e.set("activityDisplay",o)})},updateActivityDisplayInfo:function(e){var t=e.get("activityDisplaySelect");if(UWA.is(t)&&UWA.is(t.actualValue)){t.actualValue;e.set("activityActual",t.actualValue,{silent:!0}),e.set("activityDisplay",t.displayValue)}},updateOperationDisplayInfo:function(e){var t=e.get("operationDisplaySelect");if(UWA.is(t)&&UWA.is(t.actualValue)){var i=t.actualValue;UWA.is(i)&&"Create"==i?e.set("isCreateOperation",!0):e.set("isCreateOperation",!1),UWA.is(i)&&"NewEvolution"==i?e.set("isEvolutionOperation",!0):e.set("isEvolutionOperation",!1),e.set("operationActual",t.actualValue,{silent:!0}),e.set("operationDisplay",t.displayValue);var n;void 0!==(n=e.get("activityDisplayOptions"))&&1==n.length?"Obsolete"==e.get("proposedObject").maturity&&e.set("activityActual","Restore"):e.set("activityActual","NoSelection")}},updateAllowedOperationInfo:function(e){UWA.is(e.get("proposedObject"))&&UWA.is(e.get("proposedObject").objectID)?require(["DS/ENOChangeActionUX/scripts/Services/CAProposedViewServices","DS/ENOChgServices/scripts/services/ChgProposedServices"],function(i,o){var a=e.get("proposedObject").objectID,s=e.id,r=[];r.push("pid:"+a);let l=n.getGlobalVariable().IDCard.model.id;o.getAllowedOperationActivity(r,l,s).then(function(n){var o=[];n.allowedOperationActivity[a].allowedOperation.forEach(function(e){o.push({displayValue:i.getOperationNameOnUI(e),actualValue:e})});const s=o.some(e=>"Restore"===e.actualValue);if(s&&(o=o.filter(function(e){return"Restore"!=e.actualValue})),e.set("operationDisplayOptions",o),!e.get("isEdit")){e.set("operationActual",n.allowedOperationActivity[a].defaultOperation);var r=n.allowedOperationActivity[a].defaultActivity;"Obsolete"==e.get("proposedObject").maturity&&s&&(r="Restore"),r=UWA.is(r)?r:"NoSelection",e.set("activityActual",r);var l=[];l.push({displayValue:i.getOperationNameOnUI("NoSelection"),actualValue:"NoSelection"}),n.allowedOperationActivity[a].allowedActivity.forEach(function(n){var o=i.getOperationNameOnUI(n);"Release"==n||"Obsolete"==n?o=t.ECM_CA_Proposed_Activity_ChangeMaturity+": "+o:"Modify"==n&&"Obsolete"==e.get("proposedObject").maturity&&s&&(o=t.ECM_CA_Proposed_Activity_ChangeMaturity+": "+t.ECM_CA_Proposed_Activity_State_Restore),"Modify"==n&&"Obsolete"==e.get("proposedObject").maturity&&s?(l.pop(),l.push({displayValue:o,actualValue:"Restore"})):l.push({displayValue:o,actualValue:n})}),e.set("activityDisplayOptions",l)}},function(e){return console.log("Get allowed operation/activity failed"),Promise.reject(e)})}):(e.unset("operationDisplayOptions"),e.unset("operationActual"),e.unset("activityActual"))},proposedTypeAheadCallback:function(e,t,i){var a="flattenedtaxonomies:(",s=e.searchTypes;(s=s.split(",")).forEach(function(e,t){0!=t&&(a+=" OR "),a+='"types/'+e.trim()+'"'});var l={with_indexing_date:!0,label:"yus-1515078503005",locale:"en",select_predicate:["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:responsible","ds6wg:name","ds6wg:revision"],select_file:["icon","thumbnail_2d"],query:t,order_by:"desc",order_field:"relevance",nresults:1e3,start:"0",source:["3dspace"],specific_source_parameter:{"3dspace":{additional_query:a+=")"}},tenant:n.getGlobalVariable().tenant},c=(l=JSON.stringify(l),{isfederated:!0});return""!=t.trim()?o.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",l,function(e){var t=[];if(e.infos&&e.infos.nresults>0)for(var n=e.results,o=0;o<e.infos.nresults;o++){var a=n[o];if(a&&a.attributes){for(var s,r,l,c,d,p=0;p<a.attributes.length;p++){var u=a.attributes[p];u.name.indexOf("type")>=0&&u.value,u.name.indexOf("identifier")>=0&&(s=u.value||""),u.name.indexOf("type_icon_url")>=0&&(r=u.value||""),u.name.indexOf("label")>=0&&(l=u.value||""),u.name.indexOf("resourceid")>=0&&(c=u.value||""),u.name.indexOf("revision")>=0&&(d=u.value||"")}t.push({value:c,label:(l||s)+" "+d,image:r})}}i(t)},function(e,t){console.log("failure"),r.error(t.error.errorMessage),i([])},c):void 0}})}),define("DS/ENOChangeActionUX/scripts/Views/OperationForm",["DS/E6WCommonUI/Views/DetailsDisplayView","UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","UWA/Controls/Abstract","DS/UIKIT/Input/Button","DS/ENOChangeActionUX/scripts/Search","DS/ENOChangeActionUX/scripts/Models/CAProposedModelForDisplayView","DS/ENOChangeActionUX/scripts/Views/CACustomSwitchView","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable"],function(e,t,i,n,o,a,s,r,l,c,d,p){"use strict";return a.extend({displayViewModel:null,proposedCallback:null,slideInReference:null,selectedOperation:null,detailsView:null,init:function(t){UWA.is(t)&&(this.proposedCallback=t.callback,this.displayViewModel=new l(t,{parse:!0}),this.detailsView=new e,UWA.is(t.selectedOperation)&&(this.selectedOperation=t.selectedOperation,this.isMassUpdate=!0))},getHeading:function(){return this.isMassUpdate?i.ECM_CA_Proposed_Operation_Heading_MassUpdate:this.displayViewModel.get("isEdit")?i.ECM_CA_Proposed_Operation_Heading_Edit:i.ECM_CA_Add_Proposed_Change},getBody:function(){var e=this,t=UWA.createElement("div",{id:"formBody"});t.setAttribute("data-rec-id","formBodyCA");new(UWA.Class.View.extend({setup:function(){this.listenTo(this.model,"onChange",this.render)},render:function(){UWA.is(arguments[0])&&(arguments[0].hasChanged("reasonForChange")||arguments[0].hasChanged("evolutionName")||arguments[0].hasChanged("createObjectType")||arguments[0].hasChanged("createObjectTitle")||arguments[0].hasChanged("reasonForChangeForActivity"))||(t.setContent(""),e.detailsView.setConfig(e.getConfig()),e.detailsView.model=e.displayViewModel,e.detailsView.tenant=p.getGlobalVariable().tenant,e.detailsView.context=enoviaServer.context,e.detailsView.render().inject(t))}}))({model:e.displayViewModel}).render();return t},getConfig:function(){var e=[],t=new r({},!1);if(UWA.is(this.selectedOperation)||("true"==p.getGlobalVariable().CHG_ALLOW_CREATE_NEW_PROPOSED&&(this.isMassUpdate||this.displayViewModel.get("isEdit")||e.push({name:"createNewToggle",label:i.ECM_CA_Proposed_Operation_Operation_Create,customView:c})),this.isMassUpdate||this.displayViewModel.get("isCreateOperation")||e.push({readWrite:!UWA.is(this.displayViewModel.id),type:"object",name:"proposedObject",label:i.ECM_CA_Proposed_Operation_ProposedObject,attributeToDisplay:"objectName",singleObjectOnly:!0,searchTitle:i.ECM_CA_Proposed_Change_label,searchTypes:p.getGlobalVariable().proposedSearchType,required:!UWA.is(this.displayViewModel.id),imageAttribute:"image",typeAheadCallback:this.displayViewModel.proposedTypeAheadCallback,fieldHTMLId:"proposedObject",search:t})),!this.displayViewModel.get("isCreateOperation")){var n=!0;this.isMassUpdate&&(n=!1),e.push({readWrite:"true",name:"operationDisplaySelect",label:i.ECM_CA_Proposed_Operation_Operation,type:"select",required:n,values:this.displayViewModel.get("operationDisplayOptions")})}return this.displayViewModel.get("isEvolutionOperation")&&!this.displayViewModel.get("isCreateOperation")&&e.push({readWrite:"true",name:"evolutionName",label:i.ECM_CA_Operation_Evolution_Name,type:"text",required:!0,numberOfEditableLines:1,numberOfDisplayLines:1,fieldHTMLId:"evolutionName"}),this.displayViewModel.get("isCreateOperation")&&e.push({readWrite:"true",name:"createObjectType",label:i.ECM_CA_Operation_Create_ObjectType,type:"text",required:!0,numberOfEditableLines:1,numberOfDisplayLines:1,fieldHTMLId:"createObjectType"}),this.displayViewModel.get("isCreateOperation")&&e.push({readWrite:"true",name:"createObjectTitle",label:i.ECM_CA_Operation_Create_ObjectTitle,type:"text",required:!0,numberOfEditableLines:1,numberOfDisplayLines:1,fieldHTMLId:"createObjectTitle"}),e.push({readWrite:"true",name:"reasonForChange",label:i.ECM_CA_Proposed_Activity_ReasonForChange,type:"textarea",numberOfDisplayLines:3,numberOfEditableLines:3}),/*!this.isMassUpdate &&*/!UWA.is(this.displayViewModel.get("operationActual"))||this.displayViewModel.get("isCreateOperation")||this.displayViewModel.get("isEdit")||e.push({readWrite:!0,name:"activityDisplaySelect",label:i.ECM_CA_Proposed_Change_Activity,type:"select",values:this.displayViewModel.get("activityDisplayOptions")}),UWA.is(this.displayViewModel.get("activityActual"))&&"NoSelection"!=this.displayViewModel.get("activityActual")&&!this.displayViewModel.get("isCreateOperation")&&e.push({readWrite:"true",name:"reasonForChangeForActivity",label:i.ECM_CA_Proposed_Activity_Description,type:"textarea",numberOfDisplayLines:3,numberOfEditableLines:3}),e},getFooter:function(){var e=UWA.Element("div",{class:"slideinFooterBtns"});if(e.setAttribute("data-rec-id","slideinFooterBtnsCA"),UWA.is(this.selectedOperation))new s({value:i.ECM_CA_Button_Label_Save,className:"primary proposedButtons"}).inject(e).addEvent("onClick",this.onMassUpdateButtonClick.bind(this));else if(UWA.is(this.displayViewModel.id)){if(UWA.is(this.displayViewModel.id)){new s({value:i.ECM_CA_Button_Label_Save,className:"primary proposedButtons"}).inject(e).addEvent("onClick",this.onSaveButtonClick.bind(this))}}else{new s({value:i.ECM_CA_Button_Label_Add,className:"primary proposedButtons add"}).inject(e).addEvent("onClick",this.onAddButtonClick.bind(this)),new s({value:i.ECM_CA_Button_Label_AddAnother,className:"proposedButtons add-another add-cancel-btn"}).inject(e).addEvent("onClick",this.onAddAnotherButtonClick.bind(this))}return e},onAddButtonClick:function(){this.detailsView.isModelValid()?(this.proposedCallback(this.displayViewModel),this.slideInReference.hideSlideIn()):d.error(i.ECM_CA_MandFieldMissing_error)},onAddAnotherButtonClick:function(){this.detailsView.isModelValid()?(this.proposedCallback(this.displayViewModel),this.displayViewModel.clear(),this.displayViewModel.set("canEdit",!0)):d.error(i.ECM_CA_MandFieldMissing_error)},onSaveButtonClick:function(){this.detailsView.isModelValid()?(this.proposedCallback(this.displayViewModel),this.slideInReference.hideSlideIn()):d.error(i.ECM_CA_MandFieldMissing_error)},onMassUpdateButtonClick:function(){this.detailsView.isModelValid()?(this.proposedCallback(this.displayViewModel,this.selectedOperation),this.slideInReference.hideSlideIn()):d.error(i.ECM_CA_MandFieldMissing_error)},OnSearchComplete:function(e){for(var t=e.split("~"),i=[],n=0;n<t.length;n++)i.push(t[n]);for(var o=[],a=0;a<t.length;a++)o.push(i[a].split(","));var s=[];s.push(o[0][0]),this._tempReferenceToWinSearchCallback(s)}})}),define("DS/ENOChangeActionUX/scripts/Views/CAProposedHeaderView",["UWA/Class/View","DS/ENOChangeActionUX/scripts/Views/CAProposedOperationView","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/Handlebars/Handlebars4","DS/W3DXComponents/Views/Item/CounterView","DS/W3DXComponents/Views/Item/ActionsInlineView","DS/W3DXComponents/Collections/ActionsCollection","DS/W3DXComponents/Views/Item/MultiselView","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/ENOChgGovernanceUX/scripts/util/DocumentUtils"],function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m){"use strict";var g={_createView_TestHeader:function(n,o,f,C,v,A){return e.extend({name:"proposedview",tagName:n,className:o,currModel:null,proposedModel:C,caModel:A,model:A,setup:function(){this.template='                                            <div class="'+this.getClassNames("-header")+'">                                                    <div class="'+this.getClassNames("-proposedCounter")+'"></div>                                                    <div class="'+this.getClassNames("-proposedActions")+'"></div>                                                    <div class="'+this.getClassNames("-proposedMultisel")+'"></div>                                            <div>',this.myProposedModel=C,this._initCounterView(),this._initActionsView(v),this._initMultiSelView(),this.renderer=this.getTemplate(this.template);var e=this;widget.addEvent("onResize",function(){setTimeout(function(){if(UWA.is(e.actionsView)){e.actionsView.destroy();var t=e.container.getElement(".proposedview-proposedActions");e._initActionsView(v),e.actionsView&&t&&(t.empty(),t.grab(e.actionsView.render().getContent()),e.actionsView&&e.actionsView.dispatchEvent("onShow"))}},100)})},render:function(){var e=this.name;this.caModel&&u.setCurrModel(this.caModel);this.cid;this.container.empty();var t=this.container,i=UWA.createElement("div",{class:"proposedview-counter-details",styles:{width:"99.5%",height:"10%"}});i.setAttribute("data-rec-id","proposedview-counter-details-CA");var n=this.renderer();return i.addContent(n),i.inject(t),this.injectSubView(this.counterView,"."+e+"-proposedCounter"),this.injectSubView(this.actionsView,"."+e+"-proposedActions"),this.injectSubView(this.proposedMultiSelView,"."+e+"-proposedMultisel"),this.actionsView&&this.actionsView.dispatchEvent("onShow"),this.counterView&&this.counterView.dispatchEvent("onShow"),this.proposedMultiSelView&&this.proposedMultiSelView.dispatchEvent("onShow"),this},_initCounterView:function(){this.counterView=new s({title:i.ECM_CA_ProposedChanges,collection:this.myProposedModel})},_initActionsView:function(e){var t;t="asc"==e?"sort-alpha-desc":"sort-alpha-asc";var n=i.ECM_CA_Sort_ProposedChanges_Title,o=[{id:"search",title:i.ECM_CA_Search_ProposedChanges,icon:"search",overflow:!1},{id:"sort",title:n,icon:t,overflow:!1}],a={id:"filterOperationView",title:i.ECM_CA_Filter_Realized_Operations,icon:"filter",overflow:!1},s={id:"selectAll",title:i.SelectAll,icon:"select-all",overflow:!1},c={id:"unSelectAll",title:i.UnSelectAll,icon:"select-none",overflow:!1},p=!0,h=u.getCurrentModel();if(UWA.is(h)&&UWA.is(h.get("userAccess"))){var m=h.get("userAccess");(m&&m.AddProposed&&"false"===m.AddProposed||!m.AddProposed)&&(p=!1)}p&&("true"===d.getGlobalVariable().CHG_ADD_MASS_PROPOSED?(o.unshift({id:"define",title:i.ECM_CA_Define_ProposedChange,icon:"plus",overflow:!1}),o.unshift({id:"add",title:i.ECM_CA_Add_ProposedChanges,icon:"list-add",overflow:!1})):o.unshift({id:"define",title:i.ECM_CA_Add_ProposedChanges,icon:"plus",overflow:!1})),o.push(a),o.push(s),o.push(c);var g=new l(o);this.actionsView=new r({collection:g});var f=this._actionsViewEvents={onActionClick:function(){Array.prototype.unshift.call(arguments,this.actionsView),this.dispatchEvent("onActionClick",arguments)}};this.listenTo(this.actionsView,f)},_initMultiSelView:function(){var e=this,n={collection:new l,withMultisel:!0,useInfiniteScroll:!1,usePullToRefresh:!1,buildMultiselActions:function(t){var n=[],o=!0,a=u.getCurrentModel();UWA.is(t)&&null!=t&&null!=t&&d.getGlobalVariable().isNative&&(n.push({id:null,text:i.ECM_CA_Command_ExploreWith,fonticon:null,icon:null,multisel:!0,items:[{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmExploreInContextHdr",icon:"I_FindInContext",multisel:!0,text:i.ECM_CA_Command_ExploreContext,handler:function(i){Array.prototype.unshift.call(arguments,t),e.dispatchEvent("exploreInContext",arguments)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ExploreInMSB",icon:"I_SendToPPRNavigatorWithParent",multisel:!0,text:i.ECM_CA_Command_ExploreMSB,handler:function(i){Array.prototype.unshift.call(arguments,t),e.dispatchEvent("exploreInMsb",arguments)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmExploreParentsHdr",icon:"I_GetParents",multisel:!0,text:i.ECM_CA_Command_ExploreParents,handler:function(i){Array.prototype.unshift.call(arguments,t),e.dispatchEvent("exploreInParents",arguments)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ExploreInPPR",icon:"I_SendToPPRNavigatorWithParent",multisel:!0,text:i.ECM_CA_Command_ExploreMfg,handler:function(i){Array.prototype.unshift.call(arguments,t),e.dispatchEvent("exploreInPPR",arguments)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmMultiDagExploreInCmd",icon:"I_ExploreInRFLPNavigator",multisel:!0,text:i.ECM_CA_Command_ExploreSys,handler:function(i){Array.prototype.unshift.call(arguments,t),e.dispatchEvent("exploreInRFLP",arguments)}}]}),n.push({accelerator:"",availabilityMode:null,id:null,icon:null,items:[{accelerator:"Ctrl+O",availabilityMode:"Normal=YES CommandSet=YES Editability=YES SmallScale=YES LargeScale=YES ",id:"OpenFromCA",icon:"I_OpenDB",multisel:!0,text:i.ECM_CA_Command_Open,handler:function(i){Array.prototype.unshift.call(arguments,t),e.dispatchEvent("open",arguments)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ExploreInCentral",icon:"I_ExploreInCentral_normal",multisel:!0,text:i.ECM_CA_Command_Explore3DSpace,handler:function(i){Array.prototype.unshift.call(arguments,t),e.dispatchEvent("exploreInCollabNApproval",arguments)}},{accelerator:"Ctrl+Shift+O",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ENOVIA_Open_OpenAdvanced",icon:"I_OpenAdvDB",multisel:!0,text:i.ECM_CA_Command_OpenAdv,handler:function(i){Array.prototype.unshift.call(arguments,t),e.dispatchEvent("openAdv",arguments)}}],multisel:!0,text:i.ECM_CA_Command_OpenWith}));var s={id:"download",text:i.ECM_CA_Download,fonticon:"download",icon:"I_ChangeCnxObjDownload",multisel:!0,handler:function(e){var t=[];e.forEach(function(e){t.push(e.get("objectId").slice(4))});var n=[];m.getDocuments(t).then(function(e){e.forEach(function(e){"TRUE"===e.dataelements.isDocumentType&&n.push(e.id)}),n.length<t.length&&p.info(i.ECM_CA_Download_Skipped),m.download(n)})}};n.push(s);var r={id:"mass-update",text:i.ECM_CA_Proposed_Mass_Update,fonticon:"pencil",icon:"I_ChangeCnxObjEdit",multisel:!0,handler:function(t){Array.prototype.unshift.call(arguments,t),e.dispatchEvent("massUpdateMultiSel",arguments)}};a=u.getCurrentModel();UWA.is(a)&&UWA.is(a.get("userAccess"))&&((C=a.get("userAccess"))&&C.AddProposed&&"false"===C.AddProposed||C.AddProposed);var l=e._getStatusCommands(t);if(l.length>0){var c={id:"status-update",text:i.ECM_CA_PROPOSED_PROPOSAL_STATUS,items:l,multisel:!0};n.push(c)}var g={id:"changematurity",text:i.ECM_CA_Change_Maturity,fonticon:"promote",icon:"I_ChangeCnxObjPromote",multisel:!0,handler:function(t){Array.prototype.unshift.call(arguments,t),e.dispatchEvent("changematurityMultiSel",arguments)}},f=!0;UWA.is(a)&&UWA.is(a.get("userAccess"))&&(((C=a.get("userAccess"))&&C.AddProposed&&"false"===C.AddProposed||!C.AddProposed)&&(f=!1));f&&n.push(r),"false"!=d.getGlobalVariable().CHG_CHANGE_MATURITY&&n.push(g);var C,v={id:"ChangeAssessment",text:i.ECM_CA_Proposed_Change_Assessment,fonticon:"component",icon:"I_ChangeCnxObjEdit",multisel:!0,handler:function(e){var t=[],i=[];e.forEach(function(e){var n=e.get("objectId");null!=n&&null!=n&&""!=n||(n=e.get("id")),t.push(n),i.push(n.replace("pid:",""))}),d.getGlobalVariable().isNative?h.DispatchEventToWin("ChangeAssessment",i):u.openRelationalExplorer(t)}};(f&&n.push(v),UWA.is(a)&&UWA.is(a.get("userAccess")))&&(((C=a.get("userAccess"))&&C.DeleteProposed&&"false"===C.DeleteProposed||!C.DeleteProposed)&&(o=!1));return o&&n.push({id:"remove",text:i.ECM_CA_Referential_MultiSelActions_Remove,fonticon:"trash",icon:"I_ChangeCnxObjTrash",multisel:!0,handler:function(t){var i=[],n=!1;t.forEach(function(e){"Flowdown"===e.get("operationActual")?n=!0:i.push(e)}),n&&p.warn("flowdown operaion will be skipped for remove"),Array.prototype.unshift.call(arguments,i),e.dispatchEvent("removeMultiSel",arguments)}}),n},events:{onMultiselOff:function(){t.deactivateMultisel(),d.getGlobalVariable().arrOid&&d.getGlobalVariable().arrOid.length&&d.getGlobalVariable().arrOid.splice(0,d.getGlobalVariable().arrOid.length),e.dispatchEvent("emptySelectedModels",arguments)},onMultiselOn:function(){t.activateMultisel()}}};g.multiSelView=this.proposedMultiSelView=new c(n)},injectSubView:function(e,t){var i=this.container.getElement(t);e&&i&&i.grab(e.render().getContent())},getTemplate:function(e){var t=a.compile(e);return function(){return t()}},domEvents:{"click .accordion-div":function(e){}},_getStatusCommands:function(e){var t=this,n=[],o=!0,a=!0,s=!0,r=!0,l=!0,c=u.getCurrentModel();if(UWA.is(c)&&UWA.is(c.get("userAccess"))){var d=c.get("userAccess");(d&&d.proposedStatusAsComplete&&"false"===d.proposedStatusAsComplete||!d.proposedStatusAsComplete)&&(o=!1),(d&&d.proposedStatusAsPartial&&"false"===d.proposedStatusAsPartial||!d.proposedStatusAsPartial)&&(l=!1),(d&&d.proposedStatusAsIgnored&&"false"===d.proposedStatusAsIgnored||!d.proposedStatusAsIgnored)&&!1,(d&&d.proposedStatusAsNotStarted&&"false"===d.proposedStatusAsNotStarted||!d.proposedStatusAsNotStarted)&&(a=!1),(d&&d.proposedStatusAsRejected&&"false"===d.proposedStatusAsRejected||!d.proposedStatusAsRejected)&&(s=!1),(d&&d.proposedStatusAsStarted&&"false"===d.proposedStatusAsStarted||!d.proposedStatusAsStarted)&&(r=!1)}return a&&n.push({id:"status-not-started",text:i.ECM_PROPOSED_STATUS_NOT_STARTED_COMMAND,handler:function(){t.updateProposedStatus(e,"Not Started")}}),r&&n.push({id:"status-started",text:i.ECM_PROPOSED_STATUS_STARTED_COMMAND,handler:function(){t.updateProposedStatus(e,"Started")}}),o&&n.push({id:"status-complete",text:i.ECM_PROPOSED_STATUS_COMPLETE_COMMAND,handler:function(){t.updateProposedStatus(e,"Complete")}}),l&&n.push({id:"status-partial",text:i.ECM_PROPOSED_STATUS_PARTIAL_COMMAND,handler:function(){t.updateProposedStatus(e,"Partial")}}),s&&n.push({id:"status-rejected",text:i.ECM_PROPOSED_STATUS_REJECT_COMMAND,handler:function(){t.updateProposedStatus(e,"Rejected")}}),n},updateProposedStatus:function(e,t){var n=[],o=[],a={},s=!1;e.forEach(function(e){if("Flowdown"===e.get("operationActual")){s=!0;var i=e.get("amoID"),r=e.get("flowDownFromId"),l={amoID:i,status:t,upstreamCAId:r};a[r]||(a[r]={},a[r].flowdownStatusObjArr=[]),a[r].flowdownStatusObjArr.push(l)}else{var c=e.get("id");n.push(c),o.push(c.replace("pid:",""))}}),s&&"Not Started"===t&&p.error(i.ECM_CA_Flowdown_Operation_NoStarted_Massupdate_Forbid);var r={selectedIDs:n,status:t};s&&"Not Started"!=t&&(r.flowdownIds=a),this.dispatchEvent("updateStatusFromMultiSel",[r])},destroy:function(){return this.stopListening(),this.myProposedModel=null,this.counterView.destroy(),this.actionsView.destroy(),this.proposedMultiSelView.destroy(),this._parent.apply(this,arguments)}})}};return g}),define("DS/ENOChangeActionUX/scripts/Views/CARealizedFlowdownView",["UWA/Class/View","DS/ENOChangeActionUX/scripts/Views/CARealizedOperationView","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/Handlebars/Handlebars4","DS/PlatformAPI/PlatformAPI","DS/UIKIT/Mask","DS/W3DXComponents/Views/Item/ActionsInlineView","DS/W3DXComponents/Collections/ActionsCollection","DS/W3DXComponents/Views/Item/MultiselView","DS/ENOChangeActionUX/scripts/Collection/CARealizedCollection","DS/ENOChangeActionUX/scripts/Views/CAProposedSearchFilterView","DS/ENOChangeActionUX/scripts/CATagNavigatorProxy","DS/ENOChangeActionUX/scripts/CASpinner","DS/ENOChangeActionUX/scripts/Services/CARealizedViewServices","DS/ENOChangeActionUX/scripts/Services/CARealizedFlowdownToolbar","DS/ENOChangeActionUX/scripts/Services/CAProposedViewServices","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgIDCardHeaderServices","DS/ENOChgServices/scripts/services/ChgRealizedServices","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/Tweakers/TypeRepresentationFactory","DS/Tweakers/GeneratedToolbar"],function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v,A,w,b,S,y,_,E){"use strict";var D={caTagNavigatorProxy:null,sortingFirstTime:!0,filteredText:"",_tempReferenceToWinSearchCallback:null,realizedFlowdownCollection:new p,_createView_NewRealized:function(n,o,p,h,C){return e.extend({name:"changeView",tagName:n,className:o,currModel:null,model:h,flowdownOptions:C,filteredText:C.objNametoFilterforFlowDown,RealizedModel:null,modelsToRemove:[],selectedOperationItems:[],setup:function(){m.isWaiting()||m.if3DSpace()||m.doWait(this.container),this.template=this.flowdownOptions.template;var e=this;s.subscribe("ca-realized-flowdown-collection-updated"+widget.id,function(t){e.render(),e.resetText()}),D.Realized_Filter_Map=S.getCARealizedFilterMapping(),S.getCARealizedData(this.model.id,D.Realized_Filter_Map.DEFAULT).then(function(t){if(UWA.is(t.changeaction.realized)){var i=g.createRealizedCollection(t.changeaction.realized);S.enrichCollectionForRealized(i).then(function(t){D.setRealizedFlowdownCollection(t),m.endWait(e.container)})}})},initSubViews:function(){this.RealizedModel=D.getRealizedFlowdownCollection();this.originalRealizedCollection&&(this._initToolbar(),this._initMultiSelView(),this._initSearchFilterView(this.originalRealizedCollection),this._initOperationView(this.originalRealizedCollection))},resetText:function(){this.filteredText="",this.filteredRealizedCollection=new UWA.Class.Collection(this.originalRealizedCollection.toArray())},render:function(){m.doWait(this.container),this.currModel=this.model,w.setCurrModel(this.model);var e=D.getRealizedFlowdownCollection(),i=this;this.listenTo(this.currModel,"onChange:realized",this.render),e&&this.listenTo(this.currModel,"onChange:realized",this.resetText),setTimeout(function(){i.container.className.indexOf("flowdown-objects")>=0&&(m.wait=!0,m.endWait(i.container))},1e3),this.filteredRealizedCollection=this.originalRealizedCollection=e,i.initSubViews(),this.renderer=this.getTemplate(this.template);var n=this.name,o=(this.cid,null);UWA.is(this.containerReference)&&(o=this.containerReference.getElement(".main-Realized-change-container"),UWA.is(o)&&(o.empty(),o.destroy(),o=null)),D.containerReference=this.containerReference=this.container,UWA.is(o)||(o=this.mainContainerDiv=UWA.createElement("div",{class:"main-Realized-change-container",styles:{width:"100%",height:"100%"}})),o.addEvent("resize",function(){setTimeout(function(){t.onResize()},50)});var a=this.renderer();if(o.addContent(a),o.inject(this.containerReference),this.injectSubView(this.realizedMultiSelView,"."+n+"-realizedMultisel"),this.injectSubView(this.searchFilterView,"."+n+"-Search-container"),this.injectSubView(this.operationView,"."+n+"-Realizedoperation-container"),this.realizedMultiSelView&&this.realizedMultiSelView.dispatchEvent("onShow"),null!=D.toolbar){var s=this.containerReference.getElement(".changeView-RealizedActions");D.toolbar.inject(s)}},injectSubView:function(e,t){var i=this.containerReference.getElement(t);e&&i&&i.grab(e.render().getContent())},getTemplate:function(e){var t=a.compile(e),n=[];this.activitiesViewArr=[],UWA.is(this.originalRealizedCollection)&&this.originalRealizedCollection.forEach(function(e,t){n.push({})}),this.data={RealizedNls:i.ECM_CA_RealizedChanges,RealizedNum:n.length,changes:n};var o=this;return function(){return t(o.data)}},_initToolbar:function(){let e=f.writetoolbarDefination();var t=JSON.parse(e),i=new _;i.registerTypeRepresentations({sortingdropdown:{stdTemplate:"functionMenuIcon",semantics:{label:"action",icon:"plus"}}});var n=E.prototype.createTreeDocument(t);D.toolbar=new E({items:n,direction:"horizontal",typeRepresentationFactory:i,context:this})},_initActionsView:function(){var e=[],t={id:"search",title:i.ECM_CA_Search_RealizedChanges,icon:"search",overflow:!1};e.push(t);var n=new c(e);this.actionsView&&this.actionsView.destroy(),this.actionsView=new l({collection:n});var o=this._actionsViewEvents={onActionClick:function(e,t,i){switch(t.model.get("id")){case"search":this.searchRealized(this)}}};this.listenTo(this.actionsView,o)},searchRealized:function(e){document.getElementsByClassName("search-main-container");var t=e.containerReference.getElement(".search-main-container");if(t.hasClassName("hidden")){t.removeClassName("hidden");var i=t.getElement(".searchfilter-input-container");i.addClassName("highlighted-border"),i.removeClassName("border-without-focus"),t.getElement("input").focus()}else t.addClassName("hidden");var n=t.hasClassName("hidden"),o=e.containerReference.getElement(".main-Realized-operation-container");!n&&o?o.setStyle("height","calc(100% - 100px)"):o&&o.setStyle("height","calc(100% - 50px)")},_initOperationView:function(e){this.operationView&&this.operationView.destroy();var i={viewTagName:"div",className:"Realized-operations-details",idcarView:!1,caModel:this.model,realizedModel:e,flowdownOptions:this.flowdownOptions},n=this.operationView=new(t._createView_NewRealized(i)),o=this._operationsEvents={onCheckboxClick:function(e){var i=this.selectedOperationItems.indexOf(e.cid);if(-1===i?(this.selectedOperationItems.push(e.cid),this.modelsToRemove.push(e)):(this.selectedOperationItems.splice(i,1),this.modelsToRemove.splice(i,1),0===this.modelsToRemove.length&&t.deactivateMultisel()),this.multiSelView){var n={isActive:!0};n.selectedObjects=this.modelsToRemove,this.multiSelView.destroyDropDown();var o=[];if(v.getGlobalVariable().isNative){for(var a=0;a<n.selectedObjects.length;a++){var s;s=n.selectedObjects[a].id,o.push(s.replace("pid:",""))}g.setflowdownOperationPointer(this),y.DispatchEventToWin("MultiSel_ExpInCtx_RealizedFlowdownOperation_CmdChk",o)}else this.multiSelView.buildMultisel(n)}}};return this.listenTo(n,o),n},_initSearchFilterView:function(){this.searchFilterView&&this.searchFilterView.destroy();var e=this.searchFilterView=new u({fromIDCard:!1,collection:this.originalRealizedCollection,placeholder:i.ECM_CA_Searchby_NameTitle}),t=this._operationsEvents={keyup:function(e){this.refineRealized(e)}};this.listenTo(e,t)},refineRealized:function(e){var t=e.target.value;D.enteredText=t,this.filterForFlowdownObjects()},filterForFlowdownObjects:function(){this.filteredRealizedCollection&&this.filteredRealizedCollection.length&&this.filteredRealizedCollection.reset();let e=D.toolbar.getNodeModelByID("filter").options.grid.data.menu;for(var t in e)e[t].state="unselected";var i=this.originalRealizedCollection.filter(this.filterNameBased);this.filteredRealizedCollection=new UWA.Class.Collection(i);var n=document.querySelector(".flowdown-objects .Realized-operations-details");null!=n&&n.destroy();var o=this,a=document.querySelector(".flowdown-objects");if(r.mask(a),setTimeout(function(){o.operationView.destroy();o.operationView=o._initOperationView(o.filteredRealizedCollection);o.injectSubView(o.operationView,"."+o.name+"-Realizedoperation-container"),r.unmask(a)},100),this.realizedMultiSelView.destroy(),this._initMultiSelView(),this.injectSubView(this.realizedMultiSelView,"."+this.name+"-realizedMultisel"),this.selectedOperationItems.splice(0,this.selectedOperationItems.length),this.modelsToRemove.splice(0,this.modelsToRemove.length),!v.getGlobalVariable().is3DSpace)this.filteredRealizedCollection},filterNameBased:function(e){var t=!1,i=e.get("objectName"),n=e.get("objectTitle"),o=D.enteredText;if(o&&o.length){i&&(i=i.toLowerCase()),n&&(n=n.toLowerCase()),o=o.toLowerCase();var a=i.indexOf(o);if(a<0&&(a=n.indexOf(o)),t=a>=0,""===D.filteredText)e.get("activities").forEach(function(e){var i=e.get("OriginalActivityDetails"),n=[];i.forEach(function(e){if(1==t&&e.sameAsWhere)n.push(e);else{var i=-1;if(e.AfterExists){var a=e.After,s=a.name,r=a.title;s&&(s=s.toLowerCase()),r&&(r=r.toLowerCase()),(i=s.indexOf(o))<0&&(i=r.indexOf(o))}if(i<0&&e.BeforeExists){var l=e.Before;s=l.name,r=l.title;s&&(s=s.toLowerCase()),r&&(r=r.toLowerCase()),(i=s.indexOf(o))<0&&(i=r.indexOf(o))}i>=0&&n.push(e)}}),n.length>0&&(t=!0),e.set("ActivityDetails",n,{silent:!0})})}void 0!==o&&0!==o.length||(e.get("activities").forEach(function(e){var t=e.get("OriginalActivityDetails");e.set("ActivityDetails",t,{silent:!0})}),t=!0);if(1==t)return e},filterActivityNameBased:function(e){return-1},_initMultiSelView:function(){var e=this,i={collection:new c,withMultisel:!0,useInfiniteScroll:!1,usePullToRefresh:!1,buildMultiselActions:function(t){return e.getFlowdownStatusUpdateCmd(t)},events:{onMultiselOff:function(){var i=this.container.getElement(".fonticon-flow-down");i&&i.removeClassName("hidden");t.deactivateMultisel(),e.modelsToRemove.splice(0,e.modelsToRemove.length),e.selectedOperationItems.splice(0,e.selectedOperationItems.length)},onMultiselOn:function(){var e=this.container.getElement(".fonticon-flow-down");e&&e.addClassName("hidden"),t.activateMultisel()},onActionClickDotted:function(){var e=widget.body.getParent("body");e&&e.addClassName("for-mobile")}}};this.multiSelView&&this.multiSelView.destroy(),this.modelsToRemove.splice(0,this.modelsToRemove.length),this.selectedOperationItems.splice(0,this.selectedOperationItems.length),this.multiSelView=this.realizedMultiSelView=new d(i),D.multiSelView=this.multiSelView},getFlowdownStatusUpdateCmd:function(e){var n=[],o=this,a={id:"SelectAll",text:i.SelectAll,fonticon:"select-all",multisel:!0,handler:function(){var e=o.container.getElement(".fonticon-flow-down");e&&e.addClassName("hidden"),o.multiSelView&&t.selectAll()}},s={id:"UnSelectAll",text:i.UnSelectAll,fonticon:"select-none",multisel:!0,handler:function(){var e=o.container.getElement(".fonticon-flow-down");e&&e.removeClassName("hidden"),o.multiSelView&&(o.multiSelView.exitMultisel(),o.multiSelView.dispatchEvent("onMultiselOff",[o.multiSelView,!1]))}},r=[],l={id:"flowdown-pending",text:i.ECM_FLOWDOWNSTATUS_ANALYSIS_PENDING,multisel:!0,handler:function(e){if(v.getGlobalVariable().isNative)e=e.selectedObjs;var t=o._buildDataForFlowdownAMOs(e,"Analysis Pending");g.setInfoForSelectedItem(t)}},c={id:"ignored-flowdown",text:i.ECM_FLOWDOWNSTATUS_IGNORED,multisel:!0,handler:function(e){if(v.getGlobalVariable().isNative)e=e.selectedObjs;var t=o._buildDataForFlowdownAMOs(e,"Ignored");g.setInfoForSelectedItem(t)}},d={id:"flowdown-resolution-pending",text:i.ECM_FLOWDOWNSTATUS_FLOWDOWN_PENDING,multisel:!0,handler:function(e){if(v.getGlobalVariable().isNative)e=e.selectedObjs;var t=o._buildDataForFlowdownAMOs(e,"Flowdown Pending");g.setInfoForSelectedItem(t)}},p={id:"flowdown-resolve",text:i.ECM_FLOWDOWNSTATUS_FLOWDOWN_COMPLETE,multisel:!0,handler:function(e){if(v.getGlobalVariable().isNative)e=e.selectedObjs;var t=o._buildDataForFlowdownAMOs(e,"Flowdown Complete");g.setInfoForSelectedItem(t)}};r.push(l),r.push(c),r.push(d),r.push(p);var u={text:i.ECM_FLOWDOWNSTATUS_COMMAND,items:r};return this.RealizedModel.length!=e.length&&n.push(a),n.push(s),n.push(u),n},domEvents:{"click .Realized-accordion-div":function(e){}},_buildDataForFlowdownAMOs:function(e,t){var i={};if(UWA.is(e))for(var n in e){var o=e[n];if(UWA.is(o)){var a=o.get("amo");for(var s in a){var r=a[s];if(UWA.is(r))i[r.id.substr(4)]={participateInflowdown:!0,flowdownStatusValue:t}}}}return i},calledFromNativeInterop:function(e){var t={};t.isActive=!0,t.selectedObjects={selectedObjs:this.modelsToRemove,result:e,length:this.modelsToRemove.length},this.realizedMultiSelView.buildMultisel(t)},destroy:function(){this.modelsToRemove.splice(0,this.modelsToRemove.length),this.selectedOperationItems.splice(0,this.selectedOperationItems.length),this.stopListening(this.model),this.model=null,this.stopListening(this.currModel),this.currModel=null,this.operationView.destroy(),this._parent()}})},getRealizedFlowdownCollection:function(){return this.realizedFlowdownCollection},setRealizedFlowdownCollection:function(e){this.realizedFlowdownCollection=e,s.publish("ca-realized-flowdown-collection-updated"+widget.id,{})},searchRealized:function(){document.getElementsByClassName("search-main-container");var e=D.containerReference.getElement(".search-main-container");if(e.hasClassName("hidden")){e.removeClassName("hidden");var t=e.getElement(".searchfilter-input-container");t.addClassName("highlighted-border"),t.removeClassName("border-without-focus"),e.getElement("input").focus()}else e.addClassName("hidden");var i=e.hasClassName("hidden"),n=D.containerReference.getElement(".main-Realized-operation-container");!i&&n?n.setStyle("height","calc(100% - 100px)"):n&&n.setStyle("height","calc(100% - 50px)")},filterByFlowdownStatusAnalysisPending:function(){D.filterByFlowdownStatus("Analysis Pending")},filterByFlowdownStatusIgnored:function(){D.filterByFlowdownStatus("Ignored")},filterByFlowdownStatusFlowdownPending:function(){D.filterByFlowdownStatus("Flowdown Pending")},filterByFlowdownStatusFlowdownComplete:function(){D.filterByFlowdownStatus("Flowdown Complete")},filterByFlowdownStatus:function(e){let t=D.toolbar.getNodeModelByID("filter").options.grid.data.menu;for(var i in t){let n=t[i];n.id==e?"selected"==n.state?(n.state="unselected",e=""):n.state="selected":n.state="unselected"}D.filterForFlowdownStatus(e)},filterForFlowdownStatus:function(e){let t=D.currentView;D.flowdownStatus=e,D.filteredRealizedCollectionByFlowdownStatus&&D.filteredRealizedCollectionByFlowdownStatus.length&&D.filteredRealizedCollectionByFlowdownStatus.reset();var i=t.originalRealizedCollection.filter(D.filterFlowdwonStatus);t.filteredRealizedCollection=new UWA.Class.Collection(i),document.querySelector(".flowdown-objects .Realized-operations-details").destroy();var n=document.querySelector(".flowdown-objects");if(r.mask(n),setTimeout(function(){t.operationView.destroy();t.operationView=t._initOperationView(t.filteredRealizedCollection);t.injectSubView(t.operationView,"."+t.name+"-Realizedoperation-container"),r.unmask(n)},100),t.realizedMultiSelView.destroy(),t._initMultiSelView(),t.injectSubView(t.realizedMultiSelView,"."+t.name+"-realizedMultisel"),t.selectedOperationItems.splice(0,t.selectedOperationItems.length),t.modelsToRemove.splice(0,t.modelsToRemove.length),!v.getGlobalVariable().is3DSpace)t.filteredRealizedCollection},filterFlowdwonStatus:function(e){let t=!1,i=C.getPreviousFlowdownObjects(),n=D.flowdownStatus;if(n&&n.length){e.get("activities").forEach(function(e){let o=e.get("OriginalActivityDetails");var a=[];o.forEach(function(e){let t=Object.keys(i),o=e.id;"Analysis Pending"!=n||t.includes(o)?t.includes(o)&&i[o].flowdownStatus==n&&a.push(e):a.push(e)}),a.length>0&&(t=!0),e.set("ActivityDetails",a,{silent:!0})})}void 0!==n&&0!==n.length||(e.get("activities").forEach(function(e){let t=e.get("OriginalActivityDetails");e.set("ActivityDetails",t,{silent:!0})}),t=!0);if(1==t)return e}};return D}),define("DS/ENOChangeActionUX/scripts/Views/CAProposedFlowDownBodyView",["UWA/Class/View","UWA/Class","UWA/Core","UWA/Class/Debug","UWA/Class/Events","DS/ENOChangeActionUX/scripts/Views/CANewRealizedView","DS/ENOChangeActionUX/scripts/Views/CARealizedFlowdownView","text!DS/ENOChangeActionUX/scripts/Templates/CARealizedViewTemplate.html","text!DS/ENOChangeActionUX/scripts/Templates/CAFlowdownRealizedBodyTemplate.html"],function(e,t,i,n,o,a,s,r,l){"use strict";return t.extend(n,o,{init:function(e){this._options=e},buildFlowdownPanelBody:function(){var e=null;if(this._options.isFromProposedFlowdown){this._options.template=l;var t=s._createView_NewRealized("div","flowdown-objects",!0,this._options.upstreamCAModel,this._options);s.currentView=e=new t}else{this._options.template=r,e=new(t=a._createView_NewRealized("div","test-realized-facet",!0,this._options.upstreamCAModel,this._options))}return e}})}),define("DS/ENOChangeActionUX/scripts/Views/CARealizedActivitiesForFlowdown",["UWA/Class/View","UWA/Core","DS/UIKIT/Mask","DS/UIKIT/Popover","DS/Handlebars/Handlebars4","DS/PlatformAPI/PlatformAPI","DS/W3DXComponents/Views/Item/ActionsInlineView","DS/W3DXComponents/Collections/ActionsCollection","DS/W3DXComponents/Views/Item/MultiselView","DS/ENOChgServices/scripts/services/ChgProposedServices","DS/ENOChangeActionUX/scripts/Services/CARealizedViewServices","DS/ENOChangeActionUX/scripts/Services/CAProposedViewServices","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChangeActionUX/scripts/Views/CARealizedActivitiesSelectedProposedView","DS/Controls/ComboBox","text!DS/ENOChangeActionUX/scripts/Templates/CARealizedActivitiesProposedFlowownTemplate.html","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v,A){"use strict";return o.registerHelper("ifborderclass",function(e,t,i,n){var o="",a="Realized-activity-individual-same-where-"+n;return e.sameAsWhere||(a="Realized-activity-individual-not-same-where-"+n),a+=" Realized-activity-individual",o=e.addBorderClass?o+'<div class= "'+(a+=" bottom-border")+'" id="Realized-activity-individual-'+t+'">':o+'<div class= "'+a+'" id="Realized-activity-individual-'+t+'">'}),o.registerHelper("isMultiSelAvailable",function(e){var t="",i="act-chk-"+this.id;return this.Details.sameAsWhere?this.Details.sameAsWhere&&"NewVersion"===this.Details.actName?t+='<input type="checkbox" class="chkbox-act hidden" id="'+i+'"}}">':this.Details.sameAsPrev||(t+='<input type="checkbox" class="chkbox-act hidden" id="'+i+'"}}">'):t+='<input type="checkbox" class="chkbox-act hidden" id="'+i+'"}}">',t}),o.registerHelper("ifGreater",function(e,t){return e.length>0?t.fn(this):t.inverse(this)}),o.registerHelper("ifDeleted",function(e,t){return UWA.is(e)&&"Cannot be found"!=e?t.fn(this):t.inverse(this)}),o.registerHelper("fillSelectedProposed",function(e,t,i){return e.selectedProposedItems,""}),e.extend({name:"RealizedActivities",className:"realized-activity-details",checkBoxes:[],_idBasedInfo:{},_amoBasedInfo:{},init:function(e){this.options=e,d.selectedProposedItems={fromFreeSearch:[],fromRelationsTab:[]},this.selectedActivityItems=[],this.activitiesToRemove=[],this._parent.call(this,e)},setup:function(){this.template=v;var e=this.options.activityModels;this._amoBasedInfo={},this._idBasedInfo={},this._initMultiSelView(),this._initContentsView();var t=c.getFlowdownMappingForSlideIn();t&&(this.mappingPerAMO=this._setSelectedProposedItems(t)),this.renderer=this._getTemplate(this.template,e);e.get("activities");this.listenTo(e,"onChange:activities",this.render)},render:function(){this.container.empty();var e=this.options.idcarView?widget.body:this.container,t=UWA.createElement("div",{class:"main-Realized-activities-container"}),i=this.renderer();t.addContent(i),t.inject(e),this._injectSubView(this.realizedMultiSelView,"."+this.name+"-activitiesMultisel");var n=this.container.getElements(".status-combo-box");this.flowdownStatusComboMapping={};var o=0;for(o in n){this.container.getElements(".Realized-activity-individual.bottom-border");var a=this.container.getElements(".Realized-activity-individual.bottom-border")[o].id.split("-")[3],s=this._initflowdownStatusCombo(a),r=n[o];if(r&&s){r.addContent(s);var l=r.className.split(" ")[0];""!=l&&(this.flowdownStatusComboMapping[l]=s)}}if(this._renderSelectedProposedItemsContainer(),this._amoBasedInfo[a]){var c=this.mappingPerAMO["pid:"+a]?this.mappingPerAMO["pid:"+a].resolutionItems:[],p=this._amoBasedInfo[a]?this._amoBasedInfo[a].resolutionItems:[];if(p){var u=p.map(function(e){return e.proposedId}),h=c.filter(function(e){var t=e.proposedId;if(-1===u.indexOf(t))return e});this._amoBasedInfo[a].resolutionItems=p.concat(h)}else this._amoBasedInfo[a].resolutionItems=c;this._amoBasedInfo[a].participateInflowdown=!1,this._amoBasedInfo[a].isResolutionObjectChanged=!1,d.setInfoForSelectedItem(this._amoBasedInfo)}return this.realizedMultiSelView&&this.realizedMultiSelView.dispatchEvent("onShow"),this},domEvents:{"click .Realized-activities-chevron":function(e){e.target.id;var t=e.target.className;t.indexOf("expand-right")>0?e.target.className=t.replace("right","down").trim():t.indexOf("expand-down")>0&&(e.target.className=t.replace("down","right").trim());var i=this.container.getElement(".Realized-activity-content");i.hasClassName("hidden")?i.removeClassName("hidden"):i.addClassName("hidden")},"click .activity-individual":function(e){},"click .Realized-activity-action-open":function(e){var t=e.target.id,i=e.target;t=t.replace("Realized-activity-action-open-","");var n=this._getModelFromSelectedID(t);i&&(i.getParent().hasClassName("Accessfalse")?i.Access=!1:i.Access=!0,i.modelid=t.substr(4),i.model=n,i.Instanceid=i.getAttribute("Instanceid"),this.itemView=i,this.dispatchEvent("onContextMenu",i))},"click .chkbox-act":function(e){e.target;for(var t=e.target.id.split("-"),i=t[t.length-1],n=(parseInt(i),this.container.getElements("#Realized-activity-individual-"+i)),o=this.container.getElements("#act-chk-"+i),a=0;a<n.length;a++){var s=n[a],r=o[a];if(s.hasClassName("selected-border")){if(s.removeClassName("selected-border"),r)r.checked=!1,this._amoBasedInfo[i].participateInflowdown=!1}else s.addClassName("selected-border"),r&&(r.checked=!0)}var l=this.options.activityModels.get("activities").findWhere({id:"pid:"+i}),c=this.selectedActivityItems.indexOf(l.cid);if(-1===c?(this.selectedActivityItems.push(l.cid),this.activitiesToRemove.push(l),this._activateMultisel(this.container)):(this.selectedActivityItems.splice(c,1),this.activitiesToRemove.splice(c,1),0===this.activitiesToRemove.length&&this._deactivateMultisel(this.container)),this.realizedMultiSelView){var p={isActive:!0};p.selectedObjects=this.activitiesToRemove,this.realizedMultiSelView.destroyDropDown();var u=[];g.getGlobalVariable().isNative?(this.activitiesToRemove.forEach(function(e,t){var i;(function(e){var t,i,n,o=!1;return(t=e.get("ActivityDetails"))&&(o=!0,(i=t[0].After)?i.Access||(o=!1):(n=t[0].Before)&&n.Access||(o=!1)),o})(e)&&(UWA.is(e.get("Afterobject"))&&(i=e.get("Afterobject").id,u.push(i.replace("pid:",""))),UWA.is(e.get("Beforeobject"))&&(i=e.get("Beforeobject").id,u.push(i.replace("pid:",""))))}),d.setflowdownActivityPointer(this),h.DispatchEventToWin("MultiSel_ExpInCtx_RealizedFlowdownActivity_CmdChk",u)):this.realizedMultiSelView.buildMultisel(p)}},"click .Realized-operation-related-object":function(e){var t=e.target.getAttribute("info").split("~"),i=e.target.getParent(".Realized-activity-individual"),n="";if(i){var o=i.id;n=o.split("-")[o.split("-").length-1]}var a=e.target.getAttribute("whereInfo"),s="",r="";""!=a&&(s=a.split("~")[0],r=a.split("~")[1]);var l=e.target.id.split("-"),c=l[l.length-1],p=l[l.length-2],u=e.target.getAttribute("class").split(" ")[e.target.getAttribute("class").split(" ").length-1];this._setSelectActivityClassName(u),this._setSelectActivityIdx(p),this.selectedActivityModel=this._getModelFromSelectedID(c);var h={objInfo:t[0],objType:t[1],objTypeNLS:t[2],target:e.target,idOfobj:c,idToSetObjs:c+"-"+p,whereId:s,amoID:n,whereDisplayName:r};d.setSelectedObjectIds(h.idToSetObjs),this._setInfoBasedOnId(h),this._setInfoBasedOnAMO(h),this._displayContextualMenu(h)}},_renderSelectedProposedItemsContainer:function(){var e=Object.keys(this.mappingPerAMO);for(var t in e){var i=e[t];if(UWA.is(i)){i=i.substr(4);var n=this.container.getElement("#Realized-activity-individual-"+i);if(!n)continue;var o=n.getElement(".selected-proposed-container"),a=o.id,s=a.split("-")[1],r=a.split("-")[a.split("-").length-1],l="",c="."+(l=-1===s.indexOf("not")?"samewhere-status-"+r:"notsamewhere-status-"+r),d=this.flowdownStatusComboMapping[l],p=this.container.getElement(c),u={data:this.mappingPerAMO["pid:"+i].resolutionItems,container:o,statusContainer:p,statusComboBox:d,flowdownStatus:this.mappingPerAMO["pid:"+i].flowdownStatus,alredySelected:!0,baseAMO:i};this._buildSelectedProposedView(u)}}},_setInfoBasedOnId:function(e){-1===Object.keys(this._idBasedInfo).indexOf(e.amoID)&&(this._idBasedInfo[e.amoID]={objType:e.objType,objTypeNLS:e.objTypeNLS,objTitle:e.objInfo})},_setInfoBasedOnAMO:function(e){if(-1===Object.keys(this._amoBasedInfo).indexOf(e.amoID)){this._amoBasedInfo[e.amoID]={};var t=this.options.activityModels.get("objectName"),i=this.options.activityModels.get("objectTitle"),n=this.options.activityModels.get("revision"),o=this.options.activityModels.get("type"),a=this.options.activityModels.get("id");this._amoBasedInfo[e.amoID]={flowdownInfo:{flowdownFor:{objName:t,objTitle:i,objRevision:n,objType:o,objID:a}}}}},_setSelectActivityIdx:function(e){this.activitySelectIdx=e},_getSelectActivityIdx:function(){return this.activitySelectIdx},_setSelectActivityClassName:function(e){this.activitySelectClassName=e},_getSelectActivityClassName:function(){return this.activitySelectClassName},_initMultiSelView:function(){var e=this,t={collection:new r,withMultisel:!0,useInfiniteScroll:!1,usePullToRefresh:!1,buildMultiselActions:function(e){return this._getMultiselActions(e)},events:{onMultiselOff:function(){e.selectedActivityItems.length=0,e.activitiesToRemove.length=0,e._deactivateMultisel()},onMultiselOn:function(){e._activateMultisel()},onActionClickDotted:function(){widget.body.getParent("body").addClassName("for-mobile")}}};t.buildMultiselActions=t.buildMultiselActions.bind(this),this.realizedMultiSelView&&this.realizedMultiSelView.destroy(),this.realizedMultiSelView=new l(t)},_initflowdownStatusCombo:function(e){var t=new C({elementsList:[A.ECM_FLOWDOWNSTATUS_ANALYSIS_PENDING,A.ECM_FLOWDOWNSTATUS_IGNORED,A.ECM_FLOWDOWNSTATUS_FLOWDOWN_PENDING,A.ECM_FLOWDOWNSTATUS_FLOWDOWN_COMPLETE],placeholder:this.options.flowdownStatus,touchMode:!0,displayStyle:"normal"}),i=this;return t.addEventListener("change",function(t){var n=t.dsModel.value,o="Analysis Pending";A.ECM_FLOWDOWNSTATUS_IGNORED===n&&(o="Ignored"),A.ECM_FLOWDOWNSTATUS_FLOWDOWN_PENDING===n&&(o="Flowdown Pending"),A.ECM_FLOWDOWNSTATUS_FLOWDOWN_COMPLETE===n&&(o="Flowdown Complete"),i._amoBasedInfo[e]?(i._amoBasedInfo[e].flowdownStatusValue=o,i._amoBasedInfo[e].participateInflowdown=!0,d.setInfoForSelectedItem(i._amoBasedInfo)):(i._amoBasedInfo[e]={},i._amoBasedInfo[e].flowdownStatusValue=o,i._amoBasedInfo[e].participateInflowdown=!0,d.setInfoForSelectedItem(i._amoBasedInfo))}),t.selectedIndex=0,t},_initContentsView:function(){},_getMultiselActions:function(e){var t=[],i=this,n={id:"SelectAll",text:A.SelectAll,fonticon:"select-all",multisel:!0,handler:function(){var e=i.container.getElement(".fonticon-flow-down");e&&e.addClassName("hidden"),i.realizedMultiSelView&&i._selectAll()}},o={id:"UnSelectAll",text:A.UnSelectAll,fonticon:"select-none",multisel:!0,handler:function(){i.realizedMultiSelView&&(i.realizedMultiSelView.exitMultisel(),i.realizedMultiSelView.dispatchEvent("onMultiselOff",[i.realizedMultiSelView,!1]))}},a=[],s={id:"flowdown-pending",text:A.ECM_FLOWDOWNSTATUS_ANALYSIS_PENDING,multisel:!0,handler:function(e){if(g.getGlobalVariable().isNative)e=e.selectedObjs;if(UWA.is(e)){var t=e.map(function(e){return e.get("id")});if(i.flowdownStatusComboMapping){var n=Object.keys(i.flowdownStatusComboMapping);for(var o in n){var a=i.container.getElement("."+n[o]);if(a&&""!=a){var s=a.id;if(-1!=t.indexOf("pid:"+s)){var r=i.flowdownStatusComboMapping[n[o]];r&&(r.selectedIndex=0)}}}}}}},r={id:"ignored-flowdown",text:A.ECM_FLOWDOWNSTATUS_IGNORED,multisel:!0,handler:function(e){if(g.getGlobalVariable().isNative)e=e.selectedObjs;if(UWA.is(e)){var t=e.map(function(e){return e.get("id")});if(i.flowdownStatusComboMapping){var n=Object.keys(i.flowdownStatusComboMapping);for(var o in n){var a=i.container.getElement("."+n[o]);if(a&&""!=a){var s=a.id;if(-1!=t.indexOf("pid:"+s)){var r=i.flowdownStatusComboMapping[n[o]];r&&(r.selectedIndex=1)}}}}}}},l={id:"flowdown-resolution-pending",text:A.ECM_FLOWDOWNSTATUS_FLOWDOWN_PENDING,multisel:!0,handler:function(e){if(g.getGlobalVariable().isNative)e=e.selectedObjs;if(UWA.is(e)){var t=e.map(function(e){return e.get("id")});if(i.flowdownStatusComboMapping){var n=Object.keys(i.flowdownStatusComboMapping);for(var o in n){var a=i.container.getElement("."+n[o]);if(a&&""!=a){var s=a.id;if(-1!=t.indexOf("pid:"+s)){var r=i.flowdownStatusComboMapping[n[o]];r&&(r.selectedIndex=2)}}}}}}},c={id:"flowdown-resolve",text:A.ECM_FLOWDOWNSTATUS_FLOWDOWN_COMPLETE,multisel:!0,handler:function(e){if(g.getGlobalVariable().isNative)e=e.selectedObjs;if(UWA.is(e)){var t=e.map(function(e){return e.get("id")});if(i.flowdownStatusComboMapping){var n=Object.keys(i.flowdownStatusComboMapping);for(var o in n){var a=i.container.getElement("."+n[o]);if(a&&""!=a){var s=a.id;if(-1!=t.indexOf("pid:"+s)){var r=i.flowdownStatusComboMapping[n[o]];r&&(r.selectedIndex=3)}}}}}}};a.push(s),a.push(r),a.push(l),a.push(c);var d={text:A.ECM_FLOWDOWNSTATUS_COMMAND,items:a};return this.checkBoxes.length!=e.length&&t.push(n),t.push(o),t.push(d),t},_getModelFromSelectedID:function(e){for(var t=null,i=this.options.activityModels.get("activities"),n=0;n<i.length;n++){var o=i.at(n);if(o){var a=o.get("Beforeobject");if(a&&a.id===e){t=a;break}var s=o.get("Afterobject");if(s&&s.id===e){t=s;break}}}var r=new UWA.Class.Model;return t&&(r.set("id",t.id),r.set("objectName",t.name),r.set("type",t.type),r.set("typeNLS",t.objectType),r.set("title",t.title),r.set("revision",t.revision),r.set("objectTitle",t.title),r.set("objectType",t.objectType),r.set("Access",t.Access)),r},_selectAll:function(){this._activateMultisel();for(var e=this.container.getElements(".chkbox-act"),t=0;t<e.length;t++){var i=e[t];i.checked||i.click()}},_injectSubView:function(e,t){var i=this.container.getElement(t);e&&i&&i.grab(e.render().getContent())},_getTemplate:function(e,t){var i=o.compile(e),n=[],a=[],s=[],r=this,l=t.get("activities"),c=(t.get("amo"),0);return l.forEach(function(e){e.get("ActivityDetails").forEach(function(t,i){if(UWA.is(t)&&""!=t){var o={};r.options.flowdownOptions.isFromProposedFlowdown&&(o.isFromProposedFlowdown=!0),o.activityDesc=t.NLSName,o.id=e.id.replace("pid:","");var l=t;UWA.is(e.get("Afterobject"))&&t.AfterExists&&(l.After=e.get("Afterobject")),UWA.is(e.get("Beforeobject"))&&t.BeforeExists&&(l.Before={},l.Before=e.get("Beforeobject")),r._prepareIdStructureForRELaunch(l);var d=r.options.flowdownStatus;l.flowdownStatus=d,r.mappingPerAMO[l.id]&&r.mappingPerAMO[l.id].resolutionItems&&(l.selectedProposedItems=r.mappingPerAMO[l.id].resolutionItems),l.isTransferred="Transferred"===l.status,l.transferredText=A.ECM_CA_FLOWDOWN_TRANSFERRED_REALIZED_WARNING,o.Details=l,o.Details.addBorderClass=!0;var p=n[n.length-1];p&&(p.id===o.id?(o.Details.sameAsPrev=!0,e.get("ActivityDetails").length!==i+1&&(o.Details.addBorderClass=!1),p.Details.addBorderClass=!1):p.Details.addBorderClass=!0),o.Details.sameAsWhere?a.push(o):s.push(o),n.push(o),c++}})}),this.data={RealizedactivityNls:A.ECM_CA_RealizedActivities,activityNum:c,activities:n,sameWhereActivites:a,notSameWhereActivities:s,flowdownStatusTitle:A.ECM_PROPOSED_FLOWDOWN_STATUS},function(){return i(r.data)}},_prepareIdStructureForRELaunch:function(e){e.RELaunchInfo={};var t=this.options.activityModels.get("where"),i="";t&&(i=t.id),e.launchREAccess&&e.launchREOnWhere&&(e.RELaunchInfo={REId:i,REDisplayName:t.info["display name"]+" "+t.info.revision,WhereId:i,WhereDisplayName:t.info["display name"]+" "+t.info.revision}),e.launchREAccess&&!e.launchREOnWhere&&(e.Before&&(e.RELaunchInfo={REId:e.Before.id,REDisplayName:e.Before.title+" "+e.Before.revision,WhereId:i,WhereDisplayName:t.info["display name"]+" "+t.info.revision}),e.After&&(e.RELaunchInfo={REId:e.After.id,REDisplayName:e.After.title+" "+e.After.revision,WhereId:i,WhereDisplayName:t.info["display name"]+" "+t.info.revision}))},_deactivateMultisel:function(){for(var e=this.container,t=e.getElements(".Realized-activity-individual-action"),i=0;i<t.length;i++){t[i].removeClassName("no-actions")}var n=e.getElements(".flowdown-status-dropdown");for(i=0;i<n.length;i++){n[i].removeClassName("no-actions")}var o=e.getElements(".checkbox-Before"),a=e.getElements(".chkbox-act");for(i=0;i<o.length;i++){o[i].removeClassName("hidden")}for(i=0;i<a.length;i++){var s=a[i];s.checked&&(s.checked=!1),s.addClassName("hidden")}var r=e.getElements(".Realized-activity-individual");for(i=0;i<r.length;i++){r[i].removeClassName("selected-border")}},_activateMultisel:function(){for(var e=this.container,t=e.getElements(".Realized-activity-individual-action"),i=0;i<t.length;i++){t[i].addClassName("no-actions")}var n=e.getElements(".flowdown-status-dropdown");for(i=0;i<n.length;i++){n[i].addClassName("no-actions")}var o=e.getElements(".checkbox-Before"),a=e.getElements(".chkbox-act");for(i=0;i<o.length;i++){var s=o[i];s.checked&&s.click(),s.addClassName("hidden")}for(i=0;i<a.length;i++){a[i].removeClassName("hidden")}this.checkBoxes.length=a.length},_displayContextualMenu:function(e){var t=this;t.contextOptions=e;e=e;var i=[],n={id:"relations-launch",text:A.ECA_CA_IDENTIFY_BY_RELATIONS,fonticon:"object-related",icon:"I_Relations",multisel:!0,handler:function(e){var i=t.contextOptions,n=new UWA.Class.Model;n.set("id",i.idOfobj),n.set("objectInfo",i.objInfo);var o={model:n};if(o.idToSetObjs=i.idToSetObjs,t._renderSelectedProposed=t._renderSelectedProposed.bind(t),o.callback=t._renderSelectedProposed,g.getGlobalVariable().isNative)d.loadRelationsTab(o);else{i.idOfobj;d.loadRelationsExplorer(o)}}},o={id:"freesearch-launch",text:A.ECA_CA_IDENTIFY_BY_SEARCH,fonticon:"search",icon:"I_ChangeCnxObjSearch",multisel:!0,handler:function(e){var i=t.contextOptions;t._renderSelectedProposed=t._renderSelectedProposed.bind(t),i.callback=t._renderSelectedProposed,d.launchSearchForSelectedProposed(i)}},a={id:"addresolution-launch",text:A.ECA_CA_ADD_FOR_RESOLUTION,fonticon:"flow-branch-list",icon:"I_ChangeCnxObjVersionSearch",multisel:!0,handler:function(e){var i=t.contextOptions;if(t._renderSelectedProposed=t._renderSelectedProposed.bind(t),d[i.idToSetObjs]){d[i.idToSetObjs].fromAddResolutionTab||(d[i.idToSetObjs].fromAddResolutionTab=[]);var n={proposedId:i.whereId.substr(4),proposedTitle:i.whereDisplayName,objName:"prd-100-0023423",proposedRevision:"",fromAddResolutionTab:!0};d[i.idToSetObjs].fromAddResolutionTab.push(n)}else d[i.idToSetObjs]={fromAddResolutionTab:[{proposedId:i.whereId.substr(4),proposedTitle:i.whereDisplayName,objName:"prd-100-0023423",proposedRevision:"",fromAddResolutionTab:!0}]};t._renderSelectedProposed(d[i.idToSetObjs])}};i.push(n),i.push(o),i.push(a),u._initDropDown(i,e.target)},_renderSelectedProposed:function(e){var t=[],i=Object.keys(e);for(var n in i){var o=e[i[n]];t=t.concat(o)}var a=this._getSelectActivityClassName(),s=this._getSelectActivityIdx();a="#"+a;var r=this.container.getElement(a);r.empty();var l,c="";l="."+(c=-1===a.split("-")[1].indexOf("not")?"samewhere-status-"+s:"notsamewhere-status-"+s);var p=this.flowdownStatusComboMapping[c],u=this.container.getElement(l),h="Analysis Pending";A.ECM_FLOWDOWNSTATUS_IGNORED===p.value&&(h="Ignored"),A.ECM_FLOWDOWNSTATUS_FLOWDOWN_PENDING===p.value&&(h="Flowdown Pending"),A.ECM_FLOWDOWNSTATUS_FLOWDOWN_COMPLETE===p.value&&(h="Flowdown Complete");var m=this.contextOptions.amoID;if(this._amoBasedInfo[m].resolutionItems=t,this._amoBasedInfo[m].flowdownStatusValue=h,d.setInfoForSelectedItem(this._amoBasedInfo),this._amoBasedInfo[m].resolutionItems.length>=1&&r){var g={data:this._amoBasedInfo[m].resolutionItems,container:r,statusContainer:u,idOfContextObj:this.contextOptions.idToSetObjs,statusComboBox:p,alreadySelected:!1,amoBasedInfo:this._amoBasedInfo,baseAMO:m};this._buildSelectedProposedView(g),this._amoBasedInfo[m].participateInflowdown=!0,this._amoBasedInfo[m].isResolutionObjectChanged=!0}0===this._amoBasedInfo[m].resolutionItems.length&&(p.selectedIndex=0)},_buildSelectedProposedView:function(e){if(UWA.is(e.data)){var t=new f(e);t.render();var i=this,n={crossClicked:function(e){var t=e.itemObjID,n=e.amoID,o=i._amoBasedInfo[n].resolutionItems,a=o.map(function(e){return e.proposedId}).indexOf(t);if(a>=0&&o.splice(a,1),i.contextOptions&&i.contextOptions.idToSetObjs){var s=d[i.contextOptions.idToSetObjs].fromFreeSearch;if(s)(a=s.map(function(e){return e.proposedId}).indexOf(t))>=0&&s.splice(a,1);var r=d[i.contextOptions.idToSetObjs].fromRelationsTab;if(r)(a=r.map(function(e){return e.proposedId}).indexOf(t))>=0&&r.splice(a,1)}}};this.listenTo(t,n)}if(UWA.is(e.flowdownStatus)&&""!=e.flowdownStatus){var o=0;"Ignored"===e.flowdownStatus&&(o=1),"Flowdown Pending"!==e.flowdownStatus&&"Started"!==e.flowdownStatus&&"Rejected"!==e.flowdownStatus||(o=2),"Flowdown Complete"!==e.flowdownStatus&&"Complete"!==e.flowdownStatus||(o=3),e.statusComboBox.selectedIndex=o}else e.statusComboBox.selectedIndex=2},_setSelectedProposedItems:function(e){var t={},i=Object.keys(e),n=this.options.caModel.get("id");for(var o in i){var a=e[i[o]];if(a.caID===n&&(t[a.amoID]||(t[a.amoID]=[])),a&&Array.isArray(a.resolution)&&a.resolution.length>0){var s=[];for(var r in a.resolution){var l=a.resolution[r];if(l){var c={objName:l.objectData.info["display name"],proposedId:l.objectData.id,proposedRevision:l.objectData.info.revision,proposedTitle:l.objectData.info["display name"],flowdownAlreadyResolved:!0};UWA.is(l.proposedId)?(c.proposedActivityId=l.proposedId,c.directResolution=!1,c.proposedResolution=!0):(c.directResolution=!0,c.proposedResolution=!1),a.caID===n&&(t[a.amoID]||(t[a.amoID]=[]),s.push(c))}}UWA.is(t[a.amoID])&&(t[a.amoID].resolutionItems=s,t[a.amoID].flowdownStatus=a.flowdownStatus)}UWA.is(t[a.amoID])&&(t[a.amoID].flowdownStatus=a.flowdownStatus)}return p.setPreviousFlowdownObjects(t),t},calledFromNativeInterop:function(e){var t={};t.isActive=!0,t.selectedObjects={selectedObjs:this.activitiesToRemove,result:e,length:this.activitiesToRemove.length},this.realizedMultiSelView.buildMultisel(t)},destroy:function(){if(this._idBasedInfo){var e=Object.keys(this._idBasedInfo);for(var t in e){var i=this._idBasedInfo[e[t]];i&&(i.objType&&(i.objType=""),i.objTitle&&(i.objTitle=""),i.objTypeNLS&&(i.objTypeNLS=""),i.selectedItems&&(i.selectedItems=[]))}}if(this._amoBasedInfo){e=Object.keys(this._amoBasedInfo);for(var n in e){var o=this._amoBasedInfo[e[n]];o&&(o=null)}this._amoBasedInfo=null}return this.selectedActivityItems&&this.selectedActivityItems.length>0&&this.activitiesToRemove&&this.activitiesToRemove.length>0&&(this.selectedActivityItems=this.selectedActivityItems.splice(0,this.selectedActivityItems.length-1),this.activitiesToRemove=this.activitiesToRemove.splice(0,this.activitiesToRemove.length-1),this.selectedActivityItems=null,this.activitiesToRemove=null),this._parent.apply(this,arguments)}})}),define("DS/ENOChangeActionUX/scripts/Views/CAProposedFlowdownPanel",["UWA/Class/View","UWA/Core","DS/UIKIT/Modal","DS/UIKIT/Mask","DS/Handlebars/Handlebars4","DS/ENOChangeActionUX/scripts/Views/CAProposedSearchFilterView","DS/ENOChangeActionUX/scripts/Views/CAProposedFlowDownBodyView","DS/Controls/ComboBox","DS/PlatformAPI/PlatformAPI","DS/ENOChgServices/scripts/services/ChgDependencyServices","DS/ENOChgServices/scripts/services/ChgRealizedServices","DS/ENOChgServices/scripts/services/ChgProposedServices","DS/ENOChangeActionUX/scripts/Services/CARealizedViewServices","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENOChangeActionUX/scripts/CAPreferencesManager","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","text!DS/ENOChangeActionUX/scripts/Templates/CAAddProposedFlowdownTemplate.html","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C){"use strict";return e.extend({init:function(e){this.upstreamCAInfo={},this.selectedProposedInfo={},this.mappingBasedOnUpstreamCA={},this.caModel=e.caModel,this._parent.call(this,e)},setup:function(){},render:function(){this.container.setAttributes({class:"add-proposed-flowdown-container"}),this._initSearchFilterView(),this._initUpstreamCAValuesCombo(),this._initUpStreamRealizedView();var e=this.createModalDialogBody();this.onCancelClick=this.onCancelClick.bind(this),this.container.addContent(e);var t=this.container.getElement(".upstream-ca-values");t&&this.upStreamCAComboBox&&this.upStreamCAComboBox.inject(t);var i=this.container.getElement(".functional-area-values");i&&this.functionalAreaComboBox&&this.functionalAreaComboBox.inject(i);var n=this.container.getElement(".flowdown-proposed-search-container");if(n&&this.searchFilterView){n.addContent(this.searchFilterView.render().getContent());var o=this.container.getElement(".search-main-container");o&&o.removeClassName("hidden")}var a=this.container.getElement(".flowdown-objects");a&&this.descrtipView&&(this.descrtipView.container=a,a.addContent(this.descrtipView.render()));var s=this.container.getElement(".flowdown-panel-close"),r=this;s.addEvent("click",function(e){l.publish("ca-proposed-flowdown-slidein-closed",{}),r.dispatchEvent("onCancelClicked")});var c=this.container.getElement(".btn-primary");r=this;c.addEvent("click",function(e){var t={proposedArrToAdd:u.getInfoForSelectedItem(),moreInfo:r.upstreamCAInfo[r.selectedIdx]};l.publish("ca-proposed-flowdown-slidein-closed",{}),r.dispatchEvent("onDoneClicked",[t]),l.unsubscribe("DS/PADUtils/PADCommandProxy/select");var i=u.getSelectedObjectIds();for(var n in i){var o=i[n],a=u[o];if(!a){var s=Object.keys(u);n=s.indexOf(o.split("-")[0]);a=u[s[n]]}a&&(a.fromFreeSearch=[],a.fromRelationsTab=[],a.fromAddResolutionTab=[])}r.destroy()});var d=this.container.getElement(".btn-apply");r=this;d.addEvent("click",function(e){var t={proposedArrToAdd:u.getInfoForSelectedItem(),moreInfo:r.upstreamCAInfo[r.selectedIdx]};r.dispatchEvent("onDoneClicked",[t]),l.unsubscribe("DS/PADUtils/PADCommandProxy/select");var i=u.getSelectedObjectIds();for(var n in i){var o=i[n],a=u[o];if(!a){var s=Object.keys(u);n=s.indexOf(o.split("-")[0]);a=u[s[n]]}a&&(a.fromFreeSearch=[],a.fromRelationsTab=[],a.fromAddResolutionTab=[])}});var p=this.container.getElement(".cancel-btn");r=this;return p.addEvent("click",function(e){l.unsubscribe("DS/PADUtils/PADCommandProxy/select"),l.publish("ca-proposed-flowdown-slidein-closed",{}),r.dispatchEvent("onCancelClicked",[{}]);var t=u.getSelectedObjectIds();for(var i in t){var n=t[i],o=u[n];if(!o){i=(s=Object.keys(u)).indexOf(n.split("-")[0]);o=u[s[i]]}o&&(o.fromFreeSearch=[],o.fromRelationsTab=[],o.fromAddResolutionTab=[])}var a=u.getInfoForSelectedItem(),s=Object.keys(a);for(var c in s){var d=a[s[c]];d&&(d=null)}a=null,r.destroy()}),this},createModalDialogBody:function(){return this.getTemplate(f)()},getTemplate:function(e){var t=o.compile(e),i={panelTitle:C.ECM_CA_ADD_PROPOSED_FLOWDOWN,upstreamCAComboTitle:C.ECM_UPSTREAM_CA_COMBO_TITLE,changeDisciplineTitle:C.ECM_CHANGE_DISCIPLINE_TITLE,doneBtnTitle:C.ECM_CA_Button_Done,applyBtnTitle:C.ECA_CA_BUTTON_APPLY,cancelBtnTitle:C.ECM_CA_Cancel};return function(){return t(i)}},domEvents:{},_initSearchFilterView:function(){this.searchFilterView&&this.searchFilterView.destroy();var e=this.searchFilterView=new a({fromIDCard:!1,placeholder:C.ECM_CA_Searchby_NameTitle}),t=this._operationsEvents={keyup:function(e){this._refineRealized(e)}};this.listenTo(e,t)},_initUpstreamCAValuesCombo:function(){var e=[],t=c.changeActionDependencyModel;if(t){var i=t.get("upstreamDependencyObjects");if(i&&i.dependencyLinks&&Array.isArray(i.dependencyLinks)){var n=i.dependencyLinks,o=this,a=0;n.forEach(function(t,i){if("Flowdown"===t.dependencyValueType){var n=t.title,s={caID:t.id,caTitle:n};o.upstreamCAInfo[a++]=s,e.push(n)}})}}var s=this.upStreamCAComboBox=new r({elementsList:e,enableSearchFlag:!1,actionOnClickFlag:!1,touchMode:!0,displayStyle:"normal"}),l=(o=this,0),d=m.getFlowdownSlideInUpCA();if(d){var p=this.options.caModel.get("id");(l=d[p])||(l=0)}o.selectedIdx=l,s.selectedIndex=l,s.addEventListener("change",function(e){var t=o.selectedIdx=e.dsModel.selectedIndex,i=o.options.caModel.get("id");d||(d={}),d[i]=t,m.updateFlowdownSlideInUpCA(d),o._initUpStreamRealizedView(t);var n=o.container.getElement(".flowdown-objects");n&&(n.empty(),o.descrtipView.container=n,n.addContent(o.descrtipView.render()))})},_initUpStreamRealizedView:function(e){e=0;var t=m.getFlowdownSlideInUpCA();t&&((e=t[this.options.caModel.get("id")])||(e=0));var i=new UWA.Class.Model;if(this.upstreamCAInfo[e]){var n=this.upstreamCAInfo[e].caID,o=this.mappingBasedOnUpstreamCA[n];i.set("id",n);var a={isFromProposedFlowdown:!0,upstreamCAModel:i,downstreamCAModel:this.options.caModel};UWA.is(o)&&(a.selectedProposedInfo=o);var r=this.flowdownBody=new s(a);this.descrtipView=r.buildFlowdownPanelBody()}else h.error(C.NOUPSTREAM_REALIZED_OBJECTS_FOUND)},_refineRealized:function(e){this.descrtipView.refineRealized(e)},onCancelClick:function(){this.destroy()},destroy:function(){this.container.empty(),g.getGlobalVariable().flowdownLinkClicked&&(g.getGlobalVariable().flowdownLinkClicked=!1,l.unsubscribe("flowdown:slidein:open")),this.descrtipView.destroy()}})}),define("DS/ENOChangeActionUX/scripts/Views/chgCAProposedFlowdownPanel",["UWA/Class/View","UWA/Core","DS/UIKIT/Modal","DS/UIKIT/Mask","DS/Handlebars/Handlebars4","DS/ENOChangeActionUX/scripts/Views/CAProposedSearchFilterView","DS/ENOChangeActionUX/scripts/Views/CAProposedFlowDownBodyView","DS/ENOChangeActionUX/scripts/Services/CAProposedViewServices","DS/Controls/ComboBox","DS/PlatformAPI/PlatformAPI","DS/ENOChgServices/scripts/services/ChgDependencyServices","DS/ENOChgServices/scripts/services/ChgRealizedServices","DS/ENOChgServices/scripts/services/ChgProposedServices","DS/ENOChangeActionUX/scripts/Services/CARealizedViewServices","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENOChangeActionUX/scripts/CAPreferencesManager","DS/ENOChangeActionUX/scripts/Views/EmptyView","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgRouter5/scripts/ChgRouter","text!DS/ENOChangeActionUX/scripts/Templates/chgCAAddProposedFlowdownTemplate.html","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v,A,w){"use strict";return e.extend({init:function(e){this.upstreamCAInfo=[],this.selectedProposedInfo={},this.mappingBasedOnUpstreamCA={},this.caModel=e.caModel,this._parent.call(this,e)},setup:function(){this._initUpstreamCAValuesCombo()},render:function(){if(this.container.setAttributes({class:"chg-add-proposed-flowdown-container"}),this.upstreamCAInfo.length>0){this._initSearchFilterView(),this._initUpStreamRealizedView();var e=this.createModalDialogBody();this.onCancelClick=this.onCancelClick.bind(this),this.container.addContent(e);var t=this.container.getElement(".upstream-ca-values");t&&this.upStreamCAComboBox&&this.upStreamCAComboBox.inject(t);var i=this.container.getElement(".functional-area-values");i&&this.functionalAreaComboBox&&this.functionalAreaComboBox.inject(i);var n=this.container.getElement(".flowdown-proposed-search-container");if(n&&this.searchFilterView){n.addContent(this.searchFilterView.render().getContent());var o=this.container.getElement(".search-main-container");o&&o.removeClassName("hidden")}var a=this.container.getElement(".flowdown-objects");a&&this.descrtipView&&(this.descrtipView.container=a,a.addContent(this.descrtipView.render()));var s=this.container.getElement(".btn-primary"),l=this;s.addEvent("click",function(e){var t={proposedArrToAdd:h.getInfoForSelectedItem(),moreInfo:l.upstreamCAInfo[l.selectedIdx]};c.publish("ca-proposed-flowdown-slidein-closed",{}),console.log(u.mapping),console.log(r),l.dispatchEvent("onDoneClicked",[t]),c.unsubscribe("DS/PADUtils/PADCommandProxy/select");var i=h.getSelectedObjectIds();for(var n in i){var o=i[n],a=h[o];if(!a){var s=Object.keys(h);n=s.indexOf(o.split("-")[0]);a=h[s[n]]}a&&(a.fromFreeSearch=[],a.fromRelationsTab=[],a.fromAddResolutionTab=[])}});var d=this.container.getElement(".btn-apply");l=this;d.addEvent("click",function(e){var t={proposedArrToAdd:h.getInfoForSelectedItem(),moreInfo:l.upstreamCAInfo[l.selectedIdx]};l.dispatchEvent("onDoneClicked",[t]),c.unsubscribe("DS/PADUtils/PADCommandProxy/select");var i=h.getSelectedObjectIds();for(var n in i){var o=i[n],a=h[o];if(!a){var s=Object.keys(h);n=s.indexOf(o.split("-")[0]);a=h[s[n]]}a&&(a.fromFreeSearch=[],a.fromRelationsTab=[],a.fromAddResolutionTab=[])}});var p=this.container.getElement(".cancel-btn");l=this;p.addEvent("click",function(e){c.unsubscribe("DS/PADUtils/PADCommandProxy/select"),c.publish("ca-proposed-flowdown-slidein-closed",{}),l.dispatchEvent("onCancelClicked",[{}]);var t=h.getSelectedObjectIds();for(var i in t){var n=t[i],o=h[n];if(!o){i=(s=Object.keys(h)).indexOf(n.split("-")[0]);o=h[s[i]]}o&&(o.fromFreeSearch=[],o.fromRelationsTab=[],o.fromAddResolutionTab=[])}var a=h.getInfoForSelectedItem(),s=Object.keys(a);for(var r in s){var d=a[s[r]];d&&(d=null)}a=null,v.getDependency("applicationChannel").publish({event:"triptych-hide-panel",data:"right"})})}else{let e=(new f).render("No upstream Change Action found");this.container.setContent(e)}return this},createModalDialogBody:function(){return this.getTemplate(A)()},getTemplate:function(e){var t=o.compile(e),i={upstreamCAComboTitle:w.ECM_UPSTREAM_CA_COMBO_TITLE,changeDisciplineTitle:w.ECM_CHANGE_DISCIPLINE_TITLE,doneBtnTitle:w.ECM_CA_Button_Done,applyBtnTitle:w.ECA_CA_BUTTON_APPLY,cancelBtnTitle:w.ECM_CA_Cancel};return function(){return t(i)}},domEvents:{},_initSearchFilterView:function(){this.searchFilterView&&this.searchFilterView.destroy();var e=this.searchFilterView=new a({fromIDCard:!1,placeholder:w.ECM_CA_Searchby_NameTitle}),t=this._operationsEvents={keyup:function(e){this._refineRealized(e)}};this.listenTo(e,t)},_initUpstreamCAValuesCombo:function(){var e=[],t=d.changeActionDependencyModel;if(t){var i=t.get("upstreamDependencyObjects");if(i&&i.dependencyLinks&&Array.isArray(i.dependencyLinks)){var n=i.dependencyLinks,o=this,a=0;n.forEach(function(t,i){if("Flowdown"===t.dependencyValueType){var n=t.title,s={caID:t.id,caTitle:n};o.upstreamCAInfo[a++]=s,e.push(n)}})}}var s=this.upStreamCAComboBox=new l({elementsList:e,enableSearchFlag:!1,actionOnClickFlag:!1,touchMode:!0,displayStyle:"normal"}),r=(o=this,0),c=g.getFlowdownSlideInUpCA();if(c){var p=this.options.caModel.get("id");(r=c[p])||(r=0)}o.selectedIdx=r,s.selectedIndex=r,s.addEventListener("change",function(e){var t=o.selectedIdx=e.dsModel.selectedIndex,i=o.options.caModel.get("id");c||(c={}),c[i]=t,g.updateFlowdownSlideInUpCA(c),o._initUpStreamRealizedView(t);var n=o.container.getElement(".flowdown-objects");n&&(n.empty(),o.descrtipView.container=n,n.addContent(o.descrtipView.render()))})},_initUpStreamRealizedView:function(e){e=0;var t=g.getFlowdownSlideInUpCA();t&&((e=t[this.options.caModel.get("id")])||(e=0));var i=new UWA.Class.Model;if(this.upstreamCAInfo[e]){var n=this.upstreamCAInfo[e].caID,o=this.mappingBasedOnUpstreamCA[n];i.set("id",n);var a={isFromProposedFlowdown:!0,upstreamCAModel:i,downstreamCAModel:this.options.caModel};UWA.is(o)&&(a.selectedProposedInfo=o);var r=this.flowdownBody=new s(a);this.descrtipView=r.buildFlowdownPanelBody()}else m.error(w.NOUPSTREAM_REALIZED_OBJECTS_FOUND)},_refineRealized:function(e){this.descrtipView.refineRealized(e)},onCancelClick:function(){},destroy:function(){this.container.empty(),C.getGlobalVariable().flowdownLinkClicked&&(C.getGlobalVariable().flowdownLinkClicked=!1,c.unsubscribe("flowdown:slidein:open")),this.descrtipView.destroy()}})}),define("DS/ENOChangeActionUX/scripts/Views/CANewProposedView",["UWA/Class/View","DS/ENOChangeActionUX/scripts/Views/CAProposedHeaderView","DS/ENOChangeActionUX/scripts/Views/CAProposedSearchFilterView","DS/ENOChangeActionUX/scripts/Views/CAProposedOperationView","DS/W3DXComponents/Views/EmptyView","DS/DataDragAndDrop/DataDragAndDrop","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/PlatformAPI/PlatformAPI","DS/Handlebars/Handlebars4","DS/ENOChangeActionUX/scripts/Collection/CAProposedCollection","DS/ENOChangeActionUX/scripts/CASpinner","DS/ENOChangeActionUX/scripts/Models/CAProposedModel","DS/ENOChangeActionUX/scripts/Views/CASlideInFormView","DS/ENOChangeActionUX/scripts/Views/OperationForm","DS/ENOChangeActionUX/scripts/Views/ActivityForm","DS/ENOChangeActionUX/scripts/Models/CAProposedActivityModel","DS/ENOChangeActionUX/scripts/Views/CAProposedActivitiesView","DS/UIKIT/DropdownMenu","DS/UIKIT/Popover","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgIDCardHeaderServices","DS/ENOChangeActionUX/scripts/Services/CAProposedViewServices","DS/ENOChgServices/scripts/services/ChgProposedServices","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/ENOChangeActionUX/scripts/Views/CAProposedFlowdownPanel","DS/ENOChangeActionUX/scripts/Views/chgCAProposedFlowdownPanel","DS/ENOChangeActionUX/scripts/Views/CASlideInForAddFlowndownProposed","DS/ENOChgServices/scripts/services/ChgDependencyServices","DS/ENOChgRouter5/scripts/ChgRouter","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENOChgGovernanceUX/scripts/wrapper/ChgGovBIFilter"],function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v,A,w,b,S,y,_,E,D,O,N,M,I,x,T,V,R,P,U){"use strict";var F="desc",W={modelsToRemove:[],selectedOperationItems:[],itemsToSort:{},sortingFirstTime:!0,proposedCollection:new p,invokedFrom:"",filteredObjectIds:null,filteredActivities:null,_createView_TestProposed:function(n,o,a,r){return e.extend({name:"changeView",tagName:n,className:o,currModel:null,model:r,ChangeView:null,proposedModel:null,setup:function(){this.template='<div class="'+this.getClassNames("-container")+'">                                            <div class="'+this.getClassNames("-header-container")+'"></div>                                            <div class="'+this.getClassNames("-searchfilter-container")+'"></div>                                            <div class="'+this.getClassNames("-opdetails-container")+'"></div>                                          </div>';var e=this;W.filteredObjectIds=void 0,W.filteredActivities=void 0,c.unsubscribe("ca-proposed-collection-updated"+widget.id),c.unsubscribe("ca-IDCard-on-change-refresh"),c.subscribe("ca-proposed-collection-updated"+widget.id,function(t){e.render()}),c.unsubscribe(`caProposedChanges:${widget.id}`),c.unsubscribe(`caProposedChanges of ${widget.id}`),c.subscribe(`caProposedChanges:${widget.id}`,function(){require(["DS/ENOChgGovernanceUX/scripts/wrapper/ChgGovBIFilter"],function(e){e._initializationPromiseBIFilter||e.initializeBIFilter(),e._cleanBIFilterProxy(),e.cleanPathTag();for(var t=[],i=W.getProposedCollection(),n=0;n<i.length;n++){var o=i.at(n);if(o){var a=o.get("objectId");a=a.replace("pid:",""),t.push(a)}}e._onSetPathTagsForProposedRealized(t,{options:{id:"caProposedChanges"}})})}),c.subscribe(`caProposedChanges of ${widget.id}`,function(e){for(var t=e.matchingIDs,i=[],n=0;n<t.length;n++)i.push("pid:"+t[n]);W.filteredObjectIds=i,W.filterProposedCollection()}),c.subscribe("ca-IDCard-on-change-refresh",function(e){W.updateProposedCollection(e)}),widget.addEvent("onResize",function(){if(t.multiSelView)if(b.getGlobalVariable().isNative)null!=t.selectionStateFromNative&&null!=t.selectionStateFromNative&&t.multiSelView.buildMultisel(t.selectionStateFromNative);else{var e={isActive:!0,selectedObjects:[]};t.multiSelView.buildMultisel(e),e.selectedObjects=W.modelsToRemove,t.multiSelView.buildMultisel(e)}}),W.invokedFrom=e.model.invokedFrom;let i={id:e.model.id};W.updateProposedCollection(i),c.subscribe("flowdown:slidein:open",function(){W.addProposedWithFlowdown()})},initSubViews:function(){W.proposedModel=W.getProposedCollection();UWA.is(W.originalProposedCollection)||(W.originalProposedCollection=W.proposedModel);W.proposedModel&&(this._initHeaderView(W.proposedModel),this._initSearchFilterView(W.proposedModel),this._initOperationView(W.proposedModel))},render:function(){W.modelsToRemove=[],W.currModel=this.model,W.ChangeView=this,_.setCurrModel(this.model),"gov"==W.invokedFrom&&(b.getGlobalVariable().IDCard={model:{id:this.model.id}});var e=W.getProposedCollection();W.originalProposedCollection=e,this.containerReference=this.container,this.initSubViews(),this.renderer=this.getTemplate(this.template);var t=this.name,i=null;UWA.is(this.containerReference)&&(i=this.containerReference.getElement(".main-proposed-change-container"),UWA.is(i)&&(i.empty(),i.destroy(),i=null)),W.selectedOperationItems&&W.selectedOperationItems.length&&W.selectedOperationItems.splice(0,W.selectedOperationItems.length),UWA.is(i)||(i=this.mainContainerDiv=UWA.createElement("div",{class:"main-proposed-change-container",styles:{width:"99.9%",height:"100%"}})).setAttribute("data-rec-id","main-proposed-change-container-CA");var n=this.renderer();i.addContent(n),i.inject(this.containerReference);var o=this;setTimeout(function(){o.injectSubView(o.proposedHeaderView,"."+t+"-header-container"),o.injectSubView(o.searchFilterView,"."+t+"-searchfilter-container"),o.injectSubView(o.operationView,"."+t+"-opdetails-container"),u.endWait(o.container)},0),o.model.isSelected&&require(["DS/ENOChgGovernanceUX/scripts/wrapper/ChgGovBIFilter"],function(t){t._initializationPromiseBIFilter||t.initializeBIFilter(),t._cleanBIFilterProxy(),t.cleanPathTag();for(var i=[],n=e,o=0;o<n.length;o++){var a=n.at(o);if(a){var s=a.get("objectId");s=s.replace("pid:",""),i.push(s)}}t._onSetPathTagsForProposedRealized(i,{options:{id:"caProposedChanges"}})}),setTimeout(function(){var e=document.querySelector(".main-proposed-change-container");e&&W.makeDroppable(e)},1e3)},injectSubView:function(e,t){var i=this.containerReference.getElement(t);e&&i&&i.grab(e.render().getContent())},getTemplate:function(e){var t=d.compile(e);this.data={changes:W.proposedModel};return function(){return t()}},_initHeaderView:function(e){var i=this.proposedHeaderView=new(t._createView_TestHeader("div","operations-header",!1,W.proposedModel,F,this.model)),n=this,o=this._actionsEvents={removeMultiSel:function(e){W.removeSelectedProposed(e)},exploreInContext:function(e){var t=[];e.forEach(function(e,i){UWA.is(e.get("objectId"))&&t.push(e.get("objectId").replace("pid:",""))}),N.DispatchEventToWin("MultiSelMenu_ExploreInContext_New",t)},exploreInRFLP:function(e){var t=[];e.forEach(function(e,i){UWA.is(e.get("objectId"))&&t.push(e.get("objectId").replace("pid:",""))}),N.DispatchEventToWin("ExploreInRFLP",t)},exploreInPPR:function(e){var t=[];e.forEach(function(e,i){UWA.is(e.get("objectId"))&&t.push(e.get("objectId").replace("pid:",""))}),N.DispatchEventToWin("ExploreInPPR",t)},exploreInMsb:function(e){var t=[];e.forEach(function(e,i){UWA.is(e.get("objectId"))&&t.push(e.get("objectId").replace("pid:",""))}),N.DispatchEventToWin("ExploreInMSB",t)},exploreInParents:function(e){var t=[];e.forEach(function(e,i){UWA.is(e.get("objectId"))&&t.push(e.get("objectId").replace("pid:",""))}),N.DispatchEventToWin("ExploreParents",t)},open:function(e){var t=[];e.forEach(function(e,i){UWA.is(e.get("objectId"))&&t.push(e.get("objectId").replace("pid:",""))}),N.DispatchEventToWin("Open",t)},exploreInCollabNApproval:function(e){var t=[];e.forEach(function(e,i){UWA.is(e.get("objectId"))&&t.push(e.get("objectId").replace("pid:",""))}),N.DispatchEventToWin("ExploreInCollabNApproval",t)},openAdv:function(e){var t=[];e.forEach(function(e,i){UWA.is(e.get("objectId"))&&t.push(e.get("objectId").replace("pid:",""))}),N.DispatchEventToWin("OpenAdv",t)},massUpdateMultiSel:function(e){var t=[],i=null;Array.isArray(e)?i=e:e.selectedObjs&&Array.isArray(e.selectedObjs)&&(i=e.selectedObjs),i.forEach(function(e){"Create"==e.get("operationActual")||"Flowdown"==e.get("operationActual")?y.warn(s.ECM_CA_Proposed_Operation_Create_Massupdate_Forbid):e.get("Access")?e.id?t.push(e.id):e.get("id")&&t.push(e.get("id")):y.warn(s.ECM_CA_Proposed_Operation_NoAccess_Massupdate_Forbid)}),t.length>0&&W.massUpdateMultiSelectedOperations(t)},changematurityMultiSel:function(e){E.changeMaturity(e,this.model,this.massPromoteProposedCallBack)},emptySelectedModels:function(){W.emptySelectedModels()},onActionClick:function(e,t,i,o){var a=i.model.get("id");switch(a){case"sort":var s=document.getElementsByClassName("tooltip")[0];s&&s.destroy(),F="asc"==F?"desc":"asc",W.sortProposed();break;case"search":W.searchProposed(n);break;case"add":W.addProposed();break;case"define":o.stopPropagation(),W.buildDropdownForAddProposed(i);break;case"selectAll":W.selectAll();break;case"unSelectAll":W.unselectAll();break;case"filterOperationView":o.stopPropagation(),W.makeOperationFilter(i);break;default:console.log(a+" is not permitted.")}},updateStatusFromMultiSel:function(e){var t,i,n=[],o=[];e.selectedIDs&&e.selectedIDs.length>0&&(t=W.updateStatusForNormalProposed(e)),e.flowdownIds&&(i=W.updateStatusForFlowdownProposed(e)),n.push(t),n.push(i),Promise.all(n).then(function(e){e.forEach(function(e){if(e&&e.totalProposed){var t=e.totalProposed,i=O.getCachedFlowdownData();UWA.is(i)&&(t=t.concat(i)),t=W._mappedFlowdownInfo(t);for(var n=[],a=0,s=0;s<t.length;s++)-1==o.indexOf(t[s].where.id)&&(n.push(t[s]),W.itemsToSort[a++]=t[s].id);var r=D.createProposedCollection(n);W.ChangeView.stopListening(W.originalProposedCollection),W.originalProposedCollection=null,W.originalProposedCollection=r,_.enrichCollection(r,"objectId",!0).then(function(e){W.setProposedCollection(r)})}else if(e&&e.flowdownProposed){var l=W.currModel.get("id");O.getDataForProposedFacet(l).then(function(e){if(UWA.is(e)&&UWA.is(e.proposedData)){var t=[],i=e.proposedData;Object.keys(W.itemsToSort).length&&(t=W.getSortedItems(i)),t=t.length?t:i;var n=D.createProposedCollection(t);W.ChangeView.stopListening(W.originalProposedCollection),W.originalProposedCollection=null,W.originalProposedCollection=n,_.enrichCollection(n,"objectId",!0).then(function(e){W.setProposedCollection(n)})}})}})})}};return this.listenTo(i,o),i},_initSearchFilterView:function(){var e=this.searchFilterView=new i({fromIDCard:!1,collection:W.proposedModel,placeholder:s.ECM_CA_Searchby_NameTitle}),t=this._operationsEvents={keyup:function(e){W.refineProposed(e)}};this.listenTo(e,t)},_initOperationView:function(){this.model.get("id"),this.model.get("synopsis");var e=this.operationView=W.createOperationView(this.model),t=this,i=this._operationsEvents={onCheckboxClick:function(e){W.operationSelected(e)},onItemViewDrag:function(){console.log("in drag of New Proposed");var e={};if(W.modelsToRemove.length)for(var i in W.modelsToRemove){var n=W.modelsToRemove[i];n&&(e[n.get("id")]=n)}else e[arguments[1].get("id")]=arguments[1];arguments[1]=e;var o=W.context,a=[];Array.isArray(o)&&o.forEach(function(e){var t=e.id;t&&a.push(t.substr(4))});var s={caId:t.model.get("id"),caContextIds:a,typeOfDrag:"Proposed"};_.onItemViewDragForContents(arguments,s)},deleteActivity:function(e,t){var i=[e];W.removeSelectedActivities(i,t)},editActivity:function(e,t){var i={};i.model=new C({id:e.id,what:{operation:e.activityActual,"target state":e.activityTargetState},why:{comment:{text:UWA.String.unescapeHTML(e.activityDesc)}},objectId:e.objectId},{parse:!0}),i.model.set("operationIdx",t.operationIdx),i.callback=W.editActivityCallback;var n=new f(i),o=new m({invokedFrom:W.invokedFrom});o.buildSlideIn(n),o.showSlideIn()},removeMultiSelActvities:function(e,t){W.removeSelectedActivities(e,t)},editProposed:function(e,t,i){W.editSelectedProposed(t)},deleteProposed:function(e,t,i){W.removeSelectedProposed(t)},onActionClickActivities:function(e,t){switch(t.idOfAction){case"add":if(e.get("Access")){var i=new C;i.set("operationId",e.get("id")),i.set("operationIdx",t.operationIdx),i.set("objectId",e.get("objectId"));var n={};n.model=i,n.callback=W.addActivityCallback;var o=new f(n),a=new m({invokedFrom:W.invokedFrom});a.buildSlideIn(o),a.showSlideIn()}else y.warn(s.ECM_CA_Proposed_Operation_NoAccess_AddActivity_Forbid);break;case"selectAll":v.selectAll();break;case"unSelectAll":v.unselectAll()}},onHigherRevisionSelected:function(e){var t=e.objectsToAddArr,i=e.proposedToRemove.get("changeReason"),n=(e.proposedToRemove.get("status"),e.proposedToRemove.get("activities")),o=e.proposedToRemove;W.removeSelectedProposed([o],function(){var e=new UWA.Class.Model,o={objectID:t[0].substr(4)};e.set("proposedObject",o),e.set("operationActual","None"),e.set("reasonForChange",i),e.set("activities",n),W.addProposedbySearch(e,function(){u.endWait(widget.body)})})},OnUpdateProposedStatus:function(e){var t=[],i=W.currModel.get("id"),n="";null!=i&&(n="/resources/modeler/change/changeaction/"+i+"?proposed=1"),""!=n&&S.makeWSCall(n,"PUT","enovia","application/json",JSON.stringify(e),function(e){var i=e.changeaction.proposed,n=O.getCachedFlowdownData();UWA.is(n)&&(i=i.concat(n)),i=W._mappedFlowdownInfo(i);for(var o=[],a=0,s=0;s<i.length;s++)-1==t.indexOf(i[s].where.id)&&(o.push(i[s]),W.itemsToSort[a++]=i[s].id);var r=D.createProposedCollection(o);W.ChangeView.stopListening(W.originalProposedCollection),W.originalProposedCollection=null,W.originalProposedCollection=r,_.enrichCollection(r,"objectId",!0).then(function(e){W.setProposedCollection(r)})},null)},OnUpdateProposedStatusForFlowdown:function(e){W.updateProposedStatusForFlowdown(e)},OnAddResolutionItemForFlowdown:function(e){W.addResolutionItemForFlowdown(e)},OnAddResolutionItem:function(e){var t=[],i=W.currModel.get("id"),n="";null!=i&&(n="/resources/modeler/change/changeaction/"+i+"?proposed=1"),""!=n&&S.makeWSCall(n,"PUT","enovia","application/json",JSON.stringify(e),function(e){var i=e.changeaction.proposed,n=O.getCachedFlowdownData();UWA.is(n)&&(i=i.concat(n)),i=W._mappedFlowdownInfo(i);for(var o=[],a=0,s=0;s<i.length;s++)-1==t.indexOf(i[s].where.id)&&(o.push(i[s]),W.itemsToSort[a++]=i[s].id);var r=D.createProposedCollection(o);W.ChangeView.stopListening(W.originalProposedCollection),W.originalProposedCollection=null,W.originalProposedCollection=r,_.enrichCollection(r,"objectId",!0).then(function(e){W.setProposedCollection(r)})},null)}};return this.listenTo(e,i),e},domEvents:{},destroy:function(){W.modelsToRemove.splice(0,W.modelsToRemove.length),W.selectedOperationItems.splice(0,W.selectedOperationItems.length),this.stopListening(this.model),this.model=null}})},updateProposedCollection:function(e){let t=e.id;null!=t&&O.getDataForProposedFacet(t).then(function(e){if(UWA.is(e)&&UWA.is(e.proposedData)){Array.isArray(e.context)&&e.context.length>0&&(W.context=e.context);let t=D.createProposedCollection(e.proposedData);_.enrichCollection(t,"objectId",!0).then(function(e){e.forEach(function(e){"Flowdown"===e.get("operationActual")&&D.cacheFlowdownModelData(e)}),W.setProposedCollection(e)})}})},getProposedCollection:function(){return this.proposedCollection},setProposedCollection:function(e,t){this.proposedCollection=e,1!=t&&c.publish("ca-proposed-collection-updated"+widget.id,{})},createOperationView:function(e){return 0===W.proposedModel.length?new o({icon:"drag-drop",title:s.ECM_CA_Drop_EmptyView}):new(n._createView_TestProposed("div","operations-details",!1,W.proposedModel,e))},getSortedItems:function(e){for(var t=[],i=Object.keys(W.itemsToSort),n=0;n<i.length;n++)for(var o=W.itemsToSort[i[n]],a=0;a<e.length;a++)if(e[a].id===o){t.push(e[a]);break}return t},operationSelected:function(e){var i=W.selectedOperationItems.indexOf(e.cid);if(-1===i?(W.selectedOperationItems.push(e.cid),W.modelsToRemove.push(e)):(W.selectedOperationItems.splice(i,1),W.modelsToRemove.splice(i,1),0===W.modelsToRemove.length&&n.deactivateMultisel()),t.multiSelView){var o={isActive:!0};o.selectedObjects=W.modelsToRemove;t.multiSelView.buildMultisel(o);let e=W.currModel.id.slice(4),i=[];for(let e=0;e<o.selectedObjects.length;e++){let t={id:o.selectedObjects[e]._attributes.objectId.slice(4)},n=new P({grid:t});i.push(n)}if(0==o.selectedObjects.length){let e=new P({});i.push(e)}(new R).addRoot(i),0!=o.selectedObjects.length&&i[0].getTreeDocument().selectAll(),V.getDependency("applicationChannel").publish({event:"update-property-panel-data",data:{context:i[0],PhysicalID:e,type:"ChangeAction",load:!0}})}},editActivityCallback:function(e){u.doWait(widget.body);var t=n.getJSONForModifyProposed(),i="";"Modify"==e.get("activityActual")?i={id:e.get("id"),what:{operation:"Modify"},why:{comment:{text:e.get("reasonForChange")}}}:"Release"==e.get("activityActual")?i={id:e.get("id"),what:{operation:"ChangeStatus","target state":"Release"},why:{comment:{text:e.get("reasonForChange")}}}:"Obsolete"==e.get("activityActual")?i={id:e.get("id"),what:{operation:"ChangeStatus","target state":"Obsolete"},why:{comment:{text:e.get("reasonForChange")}}}:"Restore"==e.get("activityActual")&&(i={id:e.get("id"),what:{operation:"ChangeStatus","target state":"Restore"},why:{comment:{text:e.get("reasonForChange")}}});t.changeaction.modify.proposed.push(i);var o=W.currModel.get("id"),a="";null!=o&&(a="/resources/modeler/change/changeaction/"+o+"?proposed=1"),""!=a&&S.makeWSCall(a,"PUT","enovia","application/json",JSON.stringify(t),function(t){var i=t.changeaction.proposed,o=O.getCachedFlowdownData();UWA.is(o)&&(i=i.concat(o)),i=W._mappedFlowdownInfo(i);var a=D.createProposedCollection(i);W.ChangeView.stopListening(W.originalProposedCollection),W.originalProposedCollection=null,W.originalProposedCollection=a,_.enrichCollection(a,"objectId",!0).then(function(t){setTimeout(function(){W.setProposedCollection(a),n.changeAccordIconAndExpandTile(e.get("operationIdx"))},100)})},null)},addActivityCallback:function(e){u.doWait(widget.body);var t=[];t.push(e.get("operationId"));var i="";"Modify"==e.get("activityActual")?i={what:{operation:"Modify"},why:{comment:{text:e.get("reasonForChange")}}}:"Release"==e.get("activityActual")?i={what:{operation:"ChangeStatus","target state":"Release"},why:{comment:{text:e.get("reasonForChange")}}}:"Obsolete"==e.get("activityActual")?i={what:{operation:"ChangeStatus","target state":"Obsolete"},why:{comment:{text:e.get("reasonForChange")}}}:"Restore"==e.get("activityActual")&&(i={what:{operation:"ChangeStatus","target state":"Restore"},why:{comment:{text:e.get("reasonForChange")}}});var o=W.getJSONForAddActivity(t,i),a=W.currModel.get("id"),s="";null!=a&&(s="/resources/modeler/change/changeaction/"+a+"?proposed=1"),""!=s&&S.makeWSCall(s,"PUT","enovia","application/json",JSON.stringify(o),function(t){var i=t.changeaction.proposed,o=O.getCachedFlowdownData();UWA.is(o)&&(i=i.concat(o)),i=W._mappedFlowdownInfo(i);var a=D.createProposedCollection(i);W.ChangeView.stopListening(W.originalProposedCollection),W.originalProposedCollection=null,W.originalProposedCollection=a,_.enrichCollection(a,"objectId",!0).then(function(t){setTimeout(function(){W.setProposedCollection(a),n.changeAccordIconAndExpandTile(e.get("operationIdx"))},100)})},null)},removeSelectedActivities:function(e,t){u.doWait(widget.body);var i=[];e.forEach(function(e){e.id?i.push(e.id):e.get("id")&&i.push(e.get("id"))});var o=W.getJSONForDeleteOperation(i),a="/resources/modeler/change/changeaction/"+W.currModel.get("id")+"?proposed=1";S.makeWSCall(a,"PUT","enovia","application/json",JSON.stringify(o),function(e){var i=e.changeaction.proposed,o=O.getCachedFlowdownData();UWA.is(o)&&(i=i.concat(o)),i=W._mappedFlowdownInfo(i);var a=[];Object.keys(W.itemsToSort).length&&(a=W.getSortedItems(i)),a=a.length?a:i;var s=D.createProposedCollection(a);W.ChangeView.stopListening(W.originalProposedCollection),W.originalProposedCollection=null,W.originalProposedCollection=s,_.enrichCollection(s,"objectId",!0).then(function(e){W.setProposedCollection(s),n.changeAccordIconAndExpandTile(t.operationIdx)})},null)},editSelectedProposed:function(e){var t={};t.model=e[0],t.callback=W.editProposedCallback;var i=new g(t),n=new m({invokedFrom:W.invokedFrom});n.buildSlideIn(i),n.showSlideIn()},editProposedCallback:function(e){u.doWait(widget.body);var t=e.id,i=W.currModel.get("id"),o="";i&&(o="/resources/modeler/change/changeaction/"+i+"?proposed=1");var a={};if(e.get("isCreateOperation"))a.pid=e.id,a.operation="Create",a.objectType=e.get("createObjectType"),a.objectName=e.get("createObjectTitle"),a.operationWHY=e.get("reasonForChange");else{var s=[];s.push(e.id),a.proposedIDArr=s,a.operation=e.get("operationActual"),a.evolutionName=e.get("evolutionName"),a.operationWHY=e.get("reasonForChange"),a.status=e.get("status")}var r=n.getJSONForModifyOperation(a);""!=o&&S.makeWSCall(o,"PUT","enovia","application/json",JSON.stringify(r),function(e){console.log(t);var i=e.changeaction.proposed,n=O.getCachedFlowdownData();UWA.is(n)&&(i=i.concat(n)),i=W._mappedFlowdownInfo(i);var o=[];Object.keys(W.itemsToSort).length&&(o=W.getSortedItems(i)),o=o.length?o:i;var a=D.createProposedCollection(o);W.ChangeView.stopListening(W.originalProposedCollection),W.originalProposedCollection=null,W.originalProposedCollection=a,_.enrichCollection(a,"objectId",!0).then(function(e){W.setProposedCollection(a);var i=0;for(i=0;i<o.length&&o[i].id!=t;i++);setTimeout(function(){document.getElementById(i).click()},700)})},null)},removeSelectedProposed:function(e,t){u.doWait(widget.body);var i=[];Array.isArray(e)?i=e:e.selectedObjs&&Array.isArray(e.selectedObjs)&&(i=e.selectedObjs);var n=[];Array.isArray(i)&&i.forEach(function(e){n.push(e.get("id"))});var o=W.getJSONForDeleteOperation(n),a="/resources/modeler/change/changeaction/"+W.currModel.get("id")+"?proposed=1";S.makeWSCall(a,"PUT","enovia","application/json",JSON.stringify(o),function(e){var n=e.changeaction.proposed,o=O.getCachedFlowdownData();UWA.is(o)&&(n=n.concat(o)),n=W._mappedFlowdownInfo(n);var a=[];Object.keys(W.itemsToSort).length&&(a=W.getSortedItems(n)),a=a.length?a:n;var s=D.createProposedCollection(a);W.ChangeView.stopListening(W.originalProposedCollection),W.originalProposedCollection=null,W.originalProposedCollection=s,_.enrichCollection(s,"objectId",!0).then(function(e){W.setProposedCollection(s)});for(var r=0;r<i.length;r++){var l=W.modelsToRemove.indexOf(i[r]);l>=0&&(W.modelsToRemove.splice(l,1),r--)}t&&t(),u.endWait(widget.body)},null)},getJSONForAddOperation:function(e){var t=W.getJSONForAddProposed(),i=e.operation,n=e.operationWHY;if("Create"==i){var o={operation:{name:i,type:e.objectType,"display name":e.objectName},why:{comment:{text:n}},activities:[]};t.changeaction.add.proposed.push(o)}else for(var a=e.proposedIDArr,s=0;s<a.length;s++){o={where:{id:a[s]},operation:{name:i},why:{comment:{text:n}},activities:[]};"NewEvolution"==i&&(o.operation["evolution name"]=e.evolutionName),t.changeaction.add.proposed.push(o)}return t},getJSONForAddProposed:function(){var e=W.getCABaseJSONForOperations();return e.changeaction.add={proposed:[]},e},getJSONForDeleteOperation:function(e){var t=W.getJSONForDeleteProposed();return t.changeaction.delete.proposed=e,t},getJSONForDeleteProposed:function(){var e=W.getCABaseJSONForOperations();return e.changeaction.delete={proposed:[]},e},getCABaseJSONForOperations:function(){return JSON.parse(JSON.stringify({version:"v0",changeaction:{cestamp:"0000",add:{},delete:{},modify:{}}}))},sortDropDown:function(e){var t="";t="asc"==F?"sort-alpha-desc":"sort-alpha-asc";var i=[{text:s.ECM_CA_Abstract,fonticon:t,handler:function(e){W.sortProposed(F),F="asc"==F?"desc":"asc",e.stopPropagation()}}],n=e.container;null!=this.dropDown&&this.dropDown.destroy(),this.dropDown=new A({target:n,items:i}),this.dropDown.show()},buildDropdownForAddProposed:function(e){var t;if(t=W.isUpstreamFlowdownDependencyAvailable()){var i=[{id:"addproposed",text:s.ECM_CA_Add_ProposedChanges,multisel:!0,handler:function(e){W.defineProposed()}}];t&&i.push({id:"addproposedflowdown",text:s.ECM_CA_Add_ProposedChanges_Flowdown,multisel:!0,handler:function(e){if("gov"==W.invokedFrom){let e=V.getDependency("xChangeApp"),t=W.currModel.id.slice(4);e._applicationChannel.publish({event:"update-property-panel-contextdata",data:{context:t,type:"ChangeAction",facetSelect:"CA_Flowdown"}}),e._applicationChannel.publish({event:"information-panel-open",data:null})}else W.addProposedWithFlowdown()}}),_._initDropDown(i,e.container)}else W.defineProposed()},sortProposed:function(e){var t=new UWA.Class.Collection,i=null,n=!0;void 0===e||null==e?0!=(i=document.getElementsByClassName("fonticon fonticon-sort-alpha-asc")).length?n=!1:i=document.getElementsByClassName("fonticon fonticon-sort-alpha-desc"):(n="asc"==e,!(i=document.getElementsByClassName("fonticon fonticon-sort-alpha-asc")).length>0&&(i=document.getElementsByClassName("fonticon fonticon-sort-alpha-desc")));var o=[],a=[],s={};if(W.proposedModel.length>0){var r=[];W.proposedModel.sortBy(function(e,t,i){var n=e.get("objectTitle"),r=(n+e.get("revision")).toLowerCase();s[r]=n,a.push(r),a.sort(),i.length-1===t&&a.forEach(function(e){var t=s[e],i=null;i=W.proposedModel.where({objectTitle:t}),Array.isArray(i)&&i.forEach(function(t){t&&t.get("IdentifierWithRevision").toLowerCase()===e&&o.push(t)})})}),r=o,n||r.reverse();t=new UWA.Class.Collection(r);W.proposedModel=t;var l=W.ChangeView,c=l.containerReference.getElement(".changeView-opdetails-container");c.empty(),u.doWait(c),setTimeout(function(){l.operationView&&l.operationView.destroy();var e=l.operationView=l._initOperationView(t);e&&c&&c.grab(e.render().getContent()),u.endWait(c)},100);var d=l.containerReference.getElement(".changeView-header-container");d.empty();var p=l.proposedHeaderView=l._initHeaderView(t);p&&d&&d.grab(p.render().getContent()),W.modelsToRemove.splice(0,W.modelsToRemove.length),W.selectedOperationItems.splice(0,W.selectedOperationItems.length),W.changeSortIcon(i,n)}},changeSortIcon:function(e,t){e.length>0&&(e[0].className=t?"fonticon fonticon-sort-alpha-asc":"fonticon fonticon-sort-alpha-desc")},searchProposed:function(e){document.getElementsByClassName("search-main-container");var t=e.containerReference.getElement(".search-main-container");if(t&&t.hasClassName("hidden")){t.removeClassName("hidden");var i=t.getElement(".searchfilter-input-container");i.addClassName("highlighted-border"),i.removeClassName("border-without-focus"),t.getElement("input").focus()}else t.addClassName("hidden");var n=t.hasClassName("hidden"),o=e.containerReference.getElement(".operations-main-container");n?o.setStyle("height","calc(100% - 50px)"):o.setStyle("height","calc(100% - 100px)")},selectAll:function(){if(n.activateMultisel(),n||n.container){var e=n.container.container;if(e)for(var t=e.getElements(".checkbox-accord"),i=0;i<t.length;i++){var o=t[i];o.checked||o.click()}}},unselectAll:function(){var e=n.container.container;if(e)for(var i=e.getElements(".checkbox-accord"),o=0;o<i.length;o++){var a=i[o];a.checked&&a.click()}t.multiSelView&&(t.multiSelView.exitMultisel(),t.multiSelView.dispatchEvent("onMultiselOff",[t.multiSelView,!1]))},defineProposed:function(){var e=new h,t={};t.model=e,t.callback=this.addProposedbySearch;var i=new g(t),n=new m({invokedFrom:W.invokedFrom});n.buildSlideIn(i),n.showSlideIn()},addProposedWithFlowdown:function(e){var t=this.ChangeView.model,i={caModel:t,invokedFrom:W.invokedFrom},n={onDoneClicked:function(){var e=arguments[0];UWA.is(e)&&W.addProposedFromSlideIn(e)},onCancelClicked:function(){_.activateDeactiveTaggerProxies(2,3)}};if("gov"==W.invokedFrom){var o=new I(i);W.ChangeView.listenTo(o,n),o.container=e.target,o.render()}else{var a=new M(i);_.activateDeactiveTaggerProxies(3,2),W.ChangeView.listenTo(a,n);var s={facetName:"flowdownProposed",caModel:t,invokedFrom:W.invokedFrom},r=new x(s);r.buildSlideIn(a),r.showSlideIn()}},addProposed:function(){if(b.getGlobalVariable().isNative){N.DispatchEventToWin("Add_Proposed","AddProposedChange")}else W.SearchObj=_.activateSearch(b.getGlobalVariable().proposedSearchType,"multiple_proposed"),_.search("multiple_proposed",b.getGlobalVariable().proposedSearchType,W.OnSearchComplete,"multiple_proposed",W.SearchObj)},addProposedbySearch:function(e,t){u.doWait(widget.body);var i=[],n=W.currModel.get("id"),o="",a={};n&&(o="/resources/modeler/change/changeaction/"+n+"?proposed=1"),e.get("isCreateOperation")?(a.operation="Create",a.objectType=e.get("createObjectType"),a.objectName=e.get("createObjectTitle"),a.operationWHY=e.get("reasonForChange")):(i.push("pid:"+e.get("proposedObject").objectID),a.proposedIDArr=i,a.operation=e.get("operationActual"),a.operationWHY=e.get("reasonForChange"),a.evolutionName=e.get("evolutionName"));var s=W.getJSONForAddOperation(a);if(t)e.get("activities").forEach(function(e){var t=e.get("activityActual"),i=e.get("activityDesc");if(UWA.is(t)&&"NoSelection"!=t){var n="";"Modify"==t?n={what:{operation:"Modify"},why:{comment:{text:i}}}:"Release"==t?n={what:{operation:"ChangeStatus","target state":"Release"},why:{comment:{text:i}}}:"Obsolete"==t&&(n={what:{operation:"ChangeStatus","target state":"Obsolete"},why:{comment:{text:i}}}),""!=n&&s.changeaction.add.proposed[0].activities.push(n)}});else if(UWA.is(e.get("activityActual"))&&"NoSelection"!=e.get("activityActual")){var r="";"Modify"==e.get("activityActual")?r={what:{operation:"Modify"},why:{comment:{text:e.get("reasonForChangeForActivity")}}}:"Release"==e.get("activityActual")?r={what:{operation:"ChangeStatus","target state":"Release"},why:{comment:{text:e.get("reasonForChangeForActivity")}}}:"Obsolete"==e.get("activityActual")?r={what:{operation:"ChangeStatus","target state":"Obsolete"},why:{comment:{text:e.get("reasonForChangeForActivity")}}}:"Restore"==e.get("activityActual")&&(r={what:{operation:"ChangeStatus","target state":"Restore"},why:{comment:{text:e.get("reasonForChangeForActivity")}}}),s.changeaction.add.proposed[0].activities.push(r)}""!=o&&(console.log("Time to add Proposed changes::START "+(new Date).getTime()),S.makeWSCall(o,"PUT","enovia","application/json",JSON.stringify(s),function(e){console.log("Time to add Proposed changes::END "+(new Date).getTime());var t=e.changeaction.proposed,n=O.getCachedFlowdownData();UWA.is(n)&&(t=t.concat(n)),t=W._mappedFlowdownInfo(t);for(var o=[],a=0,s=0;s<t.length;s++)-1!=i.indexOf(t[s].where.id)&&(o.push(t[s]),W.itemsToSort[a++]=t[s].id);for(s=0;s<t.length;s++)-1==i.indexOf(t[s].where.id)&&(o.push(t[s]),W.itemsToSort[a++]=t[s].id);var r=D.createProposedCollection(o);W.ChangeView.stopListening(W.originalProposedCollection),W.originalProposedCollection=null,W.originalProposedCollection=r,_.enrichCollection(r,"objectId",!0).then(function(e){W.setProposedCollection(r)})},function(){u.endWait(widget.body)}))},refineProposed:function(e){var t=e.target.value;W.enteredText=t,W.filterProposed(),void 0===t||0===t.length?(U._activate(),c.publish(`caProposedChanges:${widget.id}`,{})):U._deactivate()},filterProposed:function(){var e;W.bComingFromSearchFilter=!0,e=W.originalProposedCollection.filter(W.filterNameBased);var t=W.ChangeView,i=new UWA.Class.Collection(e);W.proposedCollection=W.proposedModel=i;var n=t.containerReference.getElement(".changeView-opdetails-container");n.empty(),u.doWait(n);var o=t.operationView=t._initOperationView(i);setTimeout(function(){o&&n&&n.grab(o.render().getContent()),u.endWait(n)},100);var a=t.containerReference.getElement(".changeView-header-container");a.empty();var s=t.proposedHeaderView=t._initHeaderView(i);s&&a&&a.grab(s.render().getContent()),W.modelsToRemove.splice(0,W.modelsToRemove.length),W.selectedOperationItems.splice(0,W.selectedOperationItems.length)},filterNameBased:function(e){var t=!1,i=e.get("objectName"),n=e.get("objectTitle"),o=W.enteredText;if(o&&o.length){i&&(i=i.toLowerCase()),n&&(n=n.toLowerCase()),o=o.toLowerCase();var a=i?i.indexOf(o):-1;a<0&&(a=i?n.indexOf(o):-1),t=a>=0}if(void 0!==o&&0!==o.length||(t=!0),1==t)return e},makeDroppable:function(e){a.droppable(e,{drop:function(e,t,i){if(i.stopPropagation&&i.stopPropagation(),i.preventDefault&&i.preventDefault(),i.dataTransfer&&i.dataTransfer.dropEffect&&(i.dataTransfer.dropEffect="copy"),UWA.is(e)&&""!=e){var n=JSON.parse(e),o=_.checkTenantInforamation(n);if(0!=o.TenantInfoMissing.length)y.error(s.ECM_CA_Pref_PlatformMissing_Error);else if(0!=o.DiffTenantData.length)y.error(s.ECM_CA_Pref_PlatformDoesNotMatch_Error);else{n=_.removeDuplicatesToBeDroppedObjects(n);var a=_.filterBasedOnServiceId(n);if(a.incorrectServiceInfo&&Array.isArray(a.incorrectServiceInfo)&&a.incorrectServiceInfo.length>0){var r=s.ECM_WARN_DROP_SKIPPED+"<br/>";for(var l in a.incorrectServiceInfo)r+=a.incorrectServiceInfo[l]+"<br/>";y.warn(r,"false")}W.ExecuteDrop(n)}}else u.endWait(widget.body),y.error(s.ECM_CA_Drop_Not_Supported);document.querySelector(".main-proposed-change-container").setStyle("borderWidth","0px")},over:function(){arguments[0].setStyles({borderStyle:"solid",borderColor:"blue",borderWidth:"1px"})},leave:function(){arguments[0].setStyle("borderWidth","0px")}})},excludeAlreadyConnectedProposed:function(e){var t=!1;if(e&&e.data&&e.data.items&&W&&W.originalProposedCollection&&W.originalProposedCollection.proposedArr)for(var i=0;i<W.originalProposedCollection.proposedArr.length;i++)if(W.originalProposedCollection.proposedArr[i].where.id)for(var n=0;n<e.data.items.length;n++)e.data.items[n].objectId==W.originalProposedCollection.proposedArr[i].where.id.replace("pid:","")&&(e.data.items.splice(n,1),n-=1,t=!0);return t&&y.warn(s.ECM_CA_Proposed_Already_Added),e},ExecuteDrop:function(e){if(e){var t=e.data.items;if(UWA.is(t)&&UWA.is(t.length)&&t.length>0){for(var i=[],n=0;n<t.length;n++){var o="pid:"+t[n].objectId;i.push(o)}0!=i.length&&W.addProposedbyDrop(i)}}else u.endWait(widget.body),y.error(s.ECM_CA_Drop_Not_Supported);document.querySelector(".main-proposed-change-container").setStyle("borderWidth","0px")},addProposedbyDrop:function(e){u.doWait(widget.body);b.getGlobalVariable().IDCard.model.id;var t=W.getJSONForAddProposed();e.forEach(function(e){var i={where:{id:e},operation:{name:"Default"}};t.changeaction.add.proposed.push(i)});var i=W.currModel.get("id"),n="";i&&(n="/resources/modeler/change/changeaction/"+i+"?proposed=1"),""!=n?(console.log("Time to add Proposed changes::START "+(new Date).getTime()),S.makeWSCall(n,"PUT","enovia","application/json",JSON.stringify(t),function(t){console.log("Time to add Proposed changes::END "+(new Date).getTime());var i=t.changeaction.proposed,n=O.getCachedFlowdownData();UWA.is(n)&&(i=i.concat(n)),i=W._mappedFlowdownInfo(i);for(var o=[],a=0;a<i.length;a++)-1!=e.indexOf(i[a].where.id)&&o.push(i[a]);for(a=0;a<i.length;a++)-1==e.indexOf(i[a].where.id)&&o.push(i[a]);var s=D.createProposedCollection(o);W.ChangeView.stopListening(W.originalProposedCollection),W.originalProposedCollection=null,W.originalProposedCollection=s,_.enrichCollection(s,"objectId",!0).then(function(e){W.setProposedCollection(s)})},function(){})):u.endWait(widget.body)},getJSONForAddActivity:function(e,t){for(var i=W.getJSONForAddProposed(),n=0;n<e.length;n++){var o={id:e[n],activities:[t]};i.changeaction.add.proposed.push(o)}return i},filterProposedCollection:function(){var e=W.filteredObjectIds,t=W.filteredActivities,i=[];if(this.originalProposedCollection.toArray().forEach(function(n){var o=!1;if(e&&e.indexOf(n.get("objectId"))>=0||null==e){var a=n.get("operationActual");(t&&(t.indexOf(a)>=0||0==t.length)||null==t)&&(o=!0)}n&&o&&i.push(n)}),i&&i.length){var n=new UWA.Class.Collection(i);if(W.filteredbyTaggerCollection=W.proposedModel=n,W.ChangeView){var o=W.ChangeView,a=o.containerReference.getElement(".changeView-opdetails-container");a&&a.empty(),u.doWait(a),setTimeout(function(){var e=o.operationView=o._initOperationView(n);e&&a&&(a.grab(e.render().getContent()),u.endWait(a))},100);var s=o.containerReference.getElement(".changeView-header-container");s&&s.empty(),W.selectedOperationItems.splice(0,W.selectedOperationItems.length),W.modelsToRemove.splice(0,W.modelsToRemove.length);var r=o.proposedHeaderView=o._initHeaderView(n);r&&s&&s.grab(r.render().getContent())}}},massUpdateMultiSelectedOperations:function(e){var t=new h,i={};i.model=t,i.callback=this.massUpdateProposedCallback,i.selectedOperation=e;var n=new g(i),o=new m({invokedFrom:W.invokedFrom});o.buildSlideIn(n),o.showSlideIn()},emptySelectedModels:function(){W.modelsToRemove.splice(0,W.modelsToRemove.length),W.selectedOperationItems.splice(0,W.selectedOperationItems.length)},massUpdateProposedCallback:function(e,t){u.doWait(widget.body),W.emptySelectedModels();var i=W.currModel.get("id"),o="";i&&(o="/resources/modeler/change/changeaction/"+i+"?proposed=1");var a={};a.proposedIDArr=t,a.operation=e.get("operationActual"),a.operationWHY=e.get("reasonForChange"),a.evolutionName=e.get("evolutionName"),a.activityActual=e.get("activityActual"),a.reasonForChangeForActivity=e.get("reasonForChangeForActivity");var s=n.getJSONForModifyOperation(a);""!=o&&S.makeWSCall(o,"PUT","enovia","application/json",JSON.stringify(s),function(e){var t=[],i=e.changeaction.proposed,n=O.getCachedFlowdownData();UWA.is(n)&&(i=i.concat(n)),i=W._mappedFlowdownInfo(i),Object.keys(W.itemsToSort).length&&(t=W.getSortedItems(i)),t=t.length?t:i;var o=D.createProposedCollection(t);W.ChangeView.stopListening(W.originalProposedCollection),W.originalProposedCollection=null,W.originalProposedCollection=o,_.enrichCollection(o,"objectId",!0).then(function(e){W.setProposedCollection(o)})},null)},calledFromNativeInterop:function(e){var i={isActive:!0};e.refPid=[e.refPid],i.selectedObjects={selectedObjs:W.operationsToExplore,result:e,length:W.operationsToExplore.length},t.selectionStateFromNative=i,t.multiSelView.buildMultisel(i)},OnSearchComplete:function(e){if(b.getGlobalVariable().isNative){for(var t=e.split("~"),i=[],n=0;n<t.length;n++)i.push(t[n]);for(var o=[],a=0;a<t.length;a++)o.push(i[a].split(","));var s=[];for(n=0;n<o.length;n++){var r=o[n];s.push("pid:"+r[0])}W.addProposedbyDrop(s)}else{for(s=[],n=0;n<e.length;n++){r=e[n];s.push("pid:"+r[0])}W.addProposedbyDrop(s)}},massPromoteProposedCallBack:function(){console.log("massPromoteProposedCallBack")},addProposedFromSlideIn:function(e){var t=W.currModel.get("id"),i=D.buildFlowdownData(e,t);u.doWait(widget.body);S.makeWSCall("/resources/modeler/change/flowdown","PUT","enovia","application/json",i,function(e){var t=W.currModel.get("id");O.getDataForProposedFacet(t).then(function(e){if(UWA.is(e)&&UWA.is(e.proposedData)){let o=O.getFlowdownMappingForSlideIn();o&&D.setPreviousFlowdownObjects(o);var t=[],i=e.proposedData;Object.keys(W.itemsToSort).length&&(t=W.getSortedItems(i)),t=t.length?t:i;var n=D.createProposedCollection(t);W.ChangeView.stopListening(W.originalProposedCollection),W.originalProposedCollection=null,W.originalProposedCollection=n,_.enrichCollection(n,"objectId",!0).then(function(e){W.setProposedCollection(n)})}})},function(){u.endWait(widget.body)})},_mappedFlowdownInfo:function(e){var t=e,i=O.mapping,n=t.map(function(e,t){return{idx:t,proposedId:e.id}}),o=[],a=Object.keys(i);for(var s in a){var r=i[a[s]];if(r&&r.resolution){for(var l in r.resolution){var c=r.resolution[l];if(c&&c.proposedId)for(var d in n){var p=n[d];if(p&&p.proposedId===c.proposedId){o.push(c);var u=t[p.idx];if(u){u.flowdownInfo||(u.flowdownInfo={flowdownFor:[],flowdownFrom:[]});var h={where:{id:c.objectData.id,info:{"display name":c.objectData.info["display name"],type:c.objectData.info.type,typeNLS:c.objectData.info.current}}};u.flowdownInfo.flowdownFor.push(h.where);var m={caID:r.caID,caTitle:r.caTitle,caName:r.caName};u.flowdownInfo.flowdownFrom.push(m)}}}}r.resolution=o}}return t},updateProposedStatusForFlowdown:function(e){u.doWait(widget.body);var t=W.currModel.get("id"),i=e.upstreamCAId,n=e.amoID,o="";e.status;"Started"===e.status&&(o="Flowdown Pending"),"Complete"===e.status&&(o="Flowdown Complete"),"Rejected"===e.status&&(o="Rejected");var a={id:n,status:o};"Rejected"===o&&e.resolutionID&&""!=e.resolutionID&&(a.reject=[e.resolutionID]);var s={receivingChangeActionId:t,originChangeActionId:i,resolutionManagement:[a]};"Flowdown Complete"===o&&(s.toFlowdown=[n]);var r=JSON.stringify(s);S.makeWSCall("/resources/modeler/change/flowdown","PUT","enovia","application/json",r,function(e){var t=W.currModel.get("id");O.getDataForProposedFacet(t).then(function(e){if(UWA.is(e)&&UWA.is(e.proposedData)){var t=[],i=e.proposedData;Object.keys(W.itemsToSort).length&&(t=W.getSortedItems(i)),t=t.length?t:i;var n=D.createProposedCollection(t);W.ChangeView.stopListening(W.originalProposedCollection),W.originalProposedCollection=null,W.originalProposedCollection=n,_.enrichCollection(n,"objectId",!0).then(function(e){W.setProposedCollection(n)})}})},function(){alert("faiilure"),u.endWait(widget.body)})},addResolutionItemForFlowdown:function(e){u.doWait(widget.body);var t=W.currModel.get("id"),i=e.upstreamCAId,n=e.amoID,o=e.selectedObjID,a=e.resolutionItemId,s={},r=[],l="Flowdown Pending";""!=o&&(s.direct=["pid:"+o],l="Flowdown Complete"),""!=a&&r.push(a);var c={receivingChangeActionId:t,originChangeActionId:i,resolutionManagement:[{id:n,status:l,add:s,remove:r}]},d=JSON.stringify(c);d=JSON.stringify(c);S.makeWSCall("/resources/modeler/change/flowdown","PUT","enovia","application/json",d,function(e){var t=W.currModel.get("id");O.getDataForProposedFacet(t).then(function(e){if(UWA.is(e)&&UWA.is(e.proposedData)){var t=[],i=e.proposedData;Object.keys(W.itemsToSort).length&&(t=W.getSortedItems(i)),t=t.length?t:i;var n=D.createProposedCollection(t);W.ChangeView.stopListening(W.originalProposedCollection),W.originalProposedCollection=null,W.originalProposedCollection=n,_.enrichCollection(n,"objectId",!0).then(function(e){W.setProposedCollection(n)})}})},function(){alert("faiilure"),u.endWait(widget.body)})},updateStatusForNormalProposed:function(e){return new Promise(function(t,i){var o=n.getJSONForUpdateStatus(e),a=W.currModel.get("id"),s="";null!=a&&(s="/resources/modeler/change/changeaction/"+a+"?proposed=1"),""!=s&&S.makeWSCall(s,"PUT","enovia","application/json",JSON.stringify(o),function(e){var i=e.changeaction.proposed;t({totalProposed:i})},null)})},updateStatusForFlowdownProposed:function(e){return new Promise(function(t,i){u.doWait(widget.body);var n=W.currModel.get("id"),o=e.flowdownIds,a=[],s=Object.keys(o);for(var r in s){var l=o[s[r]].flowdownStatusObjArr;for(var c in s[r],l){var d=l[c];d&&a.push({id:d.amoID,status:d.status})}}var p={receivingChangeActionId:n,resolutionManagement:a},h=JSON.stringify(p);S.makeWSCall("/resources/modeler/change/flowdown","PUT","enovia","application/json",h,function(e){t({flowdownProposed:e})},function(){u.endWait(widget.body)})})},isUpstreamFlowdownDependencyAvailable:function(){var e=!1,t=T.changeActionDependencyModel;if(t){var i=t.get("upstreamDependencyObjects");if(i&&i.dependencyLinks&&Array.isArray(i.dependencyLinks)){i.dependencyLinks.forEach(function(t,i){"Flowdown"===t.dependencyValueType&&(e=!0)})}}return e},getFilterValuesByOperation:function(){for(var e=this.getProposedCollection(),t=new Map,i=0;i<e.length;i++){var n=e.at(i);n&&t.set(n.get("operationActual"),{actDisplayName:n.get("operationDisplay")})}return t},makeOperationFilter:function(e){var t=[];W.getFilterValuesByOperation().forEach(function(e,i){t.push({name:i,text:e.actDisplayName,selected:null!=W.filteredActivities&&W.filteredActivities.includes(i),selectable:!0})}),W.filterOperationViewMenu&&W.filterOperationViewMenu.destroy(),W.filterOperationViewMenu=new A({target:e.container,multiSelect:!0,closeOnClick:!0,items:t,events:{onClick:function(e,t){var i=W.filterOperationViewMenu.getSelectedItems(),n=[];i.forEach(function(e,t){n.push(e.name)}),W.filteredActivities=n,W.filterProposedCollection()}}}),W.filterOperationViewMenu.show()}};return W}),define("DS/ENOChangeActionUX/scripts/CANativeInterop",["DS/ENOChangeActionUX/scripts/Views/CAViewCommon","DS/ENOChangeActionUX/scripts/Views/CAContextView","DS/ENOChangeActionUX/scripts/Views/CAReferentialView","DS/ENOChangeActionUX/scripts/Views/OperationForm","DS/ENOChangeActionUX/scripts/Views/CANewProposedView","DS/ENOChangeActionUX/scripts/Views/CANewRealizedView","DS/ENOChangeActionUX/scripts/Controller/CADependencyGridController","DS/ENOChangeActionUX/scripts/Views/CARealizedOperationView","DS/ENOChangeActionUX/scripts/Views/CAProposedOperationView","DS/ENOChangeActionUX/scripts/Views/CARealizedActivitiesView","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/ENOChangeActionUX/scripts/Services/CAContextViewServices","DS/ENOChgServices/scripts/services/ChgIDCardHeaderServices","DS/ENOChangeActionUX/scripts/Services/CADependenciesViewServices","DS/ENOChangeActionUX/scripts/Services/CARealizedViewServices","DS/ENOChangeActionUX/scripts/Views/CALabelManagerView","DS/ENOChangeActionUX/scripts/Views/CATeamDataGridLayout","DS/ENOChangeActionUX/scripts/Views/CAContextDataGridLayout","DS/ENOChangeActionUX/scripts/Views/CAAttachmentView","DS/ENOChangeActionUX/scripts/Views/CAApprovalsView","DS/WebappsUtils/WebappsUtils","DS/ENOChgGovernanceUX/scripts/view/facets/issue/ChgIssueDataGridLayout","DS/ENOChgGovernanceUX/scripts/view/changeAction/facets/context/ChgCAcontextDataGridLayout","DS/ENOChgGovernanceUX/scripts/view/changeAction/facets/members/ChgCAAddMemberLayout","DS/ENOChgGovernanceUX/scripts/components/attachmentView/ChgAttachmentView","DS/ENOChgGovernanceUX/scripts/view/changeAction/facets/approvals/ChgCAApprovalsView","require","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v,A,w,b,S,y,_,E,D,O,N,M){"use strict";var I={CurrModel:null,issueDGV:y,ContextMenu:{},Refresh_Native:function(){e.handleContextMenuClickRefresh(d.getGlobalVariable().IDCard.model)},OnSearchComplete:function(e,t){var r="";switch(t){case"Context":r="true"!=d.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT?A:h.currentContext;break;case"Add_Referentials":r=i;break;case"ProposedChange":r=new n;break;case"AddProposedChange":r=o;break;case"AddResolutionItem":r=l;break;case"Add_Dependency":r=s;break;case"SearchCA":r=a;break;case"Add_Flowdown_Dependency":r=g;break;case"SearchFlowdownProposed":r=f;break;case"Add_Member":r="true"!=d.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT?v:C;break;case"Add_Attachment":r=w;break;case"Search_Task_Assignee":r=b;break;case"CHG_Add_Member":r=D;break;case"CHG_Add_Attachment":r=E;break;case"CHG_Add_Existing_Issue":r=I.issueDGV;break;case"CHG_Add_Context":r=_;break;case"CHG_Search_Task_Assignee":r=O}if(""==r||"Add_Member"==t&&"true"==d.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT||r.OnSearchComplete(e),""!=r&&"Add_Member"===t&&"true"==d.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT){var c=p.getLabelManagerView(this.addMemberBody);c&&c.OnSearchComplete(e)}},OnCAStateChange:function(){var e=d.getGlobalVariable().IDCard.model,t=[];t.push(e),m.changeMaturityExecute(t,e)},drop_Native:function(e){if(UWA.is(e)&&UWA.is(e.where))var n="";switch(e.where){case"Context":n=t;break;case"Referential":n=i;break;case"Proposed":n=o}""!=n&&n.ExecuteDrop(e)},GetMultiselContextMenu:function(e){if(UWA.is(e)&&""!=e&&UWA.is(e.MultiselectOwnerComp))if("RealizedActivity_CmdChk"==e.MultiselectOwnerComp)c.calledFromNativeInterop(e);else if("RealizedOperation_CmdChk"==e.MultiselectOwnerComp)a.calledFromNativeInterop(e);else if("ProposedOperation_CmdChk"==e.MultiselectOwnerComp)o.calledFromNativeInterop(e);else if("RealizedFlowdownActivity_CmdChk"==e.MultiselectOwnerComp){f.getflowdownActivityPointer().calledFromNativeInterop(e)}else if("RealizedFlowdownOperation_CmdChk"==e.MultiselectOwnerComp){f.getflowdownOperationPointer().calledFromNativeInterop(e)}},GetContextMenu:function(e){if(UWA.is(e)&&UWA.is(e.where))var t="";switch(e.where){case"Context":t=h.currentContext;break;case"Referential":t="true"!=d.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT?w:i;break;case"Proposed":t=l;break;case"Resolution":case"FlowdownFrom":case"FlowdownFor":t=l;break;case"Realized":t=r}if(""!=t){I.ContextMenu.pid=e.pid;var n=[];UWA.is(I.ContextMenu.explore)||(I.ContextMenu.explore={accelerator:"Ctrl+E",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmSendToNewVPMCmdRoot",icon:"I_SendToVPMNavigator",multisel:!0,text:M.ECM_CA_Command_Explore,handler:function(e){u.DispatchEventToWin("Explore",I.ContextMenu.pid)}},"Referential"==e.where&&"true"!=d.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(I.ContextMenu.explore.icon=S.getWebappsAssetUrl("ENOChangeActionUX","images/I_SendToVPMNavigator.png"))),UWA.is(I.ContextMenu.exploreInPPR)||(I.ContextMenu.exploreInPPR={accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ExploreInPPR",icon:"I_SendToPPRNavigatorWithParent",multisel:!0,text:M.ECM_CA_Command_ExploreMfg,handler:function(e){u.DispatchEventToWin("ExploreInPPR",I.ContextMenu.pid)}},"Referential"==e.where&&"true"!=d.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(I.ContextMenu.exploreInPPR.icon=S.getWebappsAssetUrl("ENOChangeActionUX","images/I_SendToPPRNavigatorWithParent.png"))),UWA.is(I.ContextMenu.exploreInMSB)||(I.ContextMenu.exploreInMSB={accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ExploreInMSB",icon:"I_SendToPPRNavigatorWithParent",multisel:!0,text:M.ECM_CA_Command_ExploreMSB,handler:function(e){r&&r.itemView&&r.itemView.Instanceid?u.DispatchEventToWin("ExploreInMSB",r.itemView.Instanceid):u.DispatchEventToWin("ExploreInMSB",I.ContextMenu.pid)}},"Referential"==e.where&&"true"!=d.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(I.ContextMenu.exploreInMSB.icon=S.getWebappsAssetUrl("ENOChangeActionUX","images/I_SendToPPRNavigatorWithParent.png"))),UWA.is(I.ContextMenu.exploreInRFLP)||(I.ContextMenu.exploreInRFLP={accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmMultiDagExploreInCmd",icon:"I_ExploreInRFLPNavigator",multisel:!0,text:M.ECM_CA_Command_ExploreSys,handler:function(e){u.DispatchEventToWin("ExploreInRFLP",I.ContextMenu.pid)}},"Referential"==e.where&&"true"!=d.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(I.ContextMenu.exploreInRFLP.icon=S.getWebappsAssetUrl("ENOChangeActionUX","images/I_ExploreInRFLPNavigator.png"))),UWA.is(I.ContextMenu.exploreInCentral)||(I.ContextMenu.exploreInCentral={accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ExploreInCentral",icon:"I_ExploreInCentral_normal",multisel:!0,text:M.ECM_CA_Command_Explore3DSpace,handler:function(e){u.DispatchEventToWin("ExploreInCollabNApproval",I.ContextMenu.pid)}},"Referential"==e.where&&"true"!=d.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(I.ContextMenu.exploreInCentral.icon=S.getWebappsAssetUrl("ENOChangeActionUX","images/I_ExploreInCentral_normal.png"))),UWA.is(I.ContextMenu.exploreParents)||(I.ContextMenu.exploreParents={accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmExploreParentsHdr",icon:"I_GetParents",multisel:!0,text:M.ECM_CA_Command_ExploreParents,handler:function(e){u.DispatchEventToWin("ExploreParents",I.ContextMenu.pid)}},"Referential"==e.where&&"true"!=d.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(I.ContextMenu.exploreParents.icon=S.getWebappsAssetUrl("ENOChangeActionUX","images/I_GetParents.png"))),UWA.is(I.ContextMenu.exploreinContext)||(I.ContextMenu.exploreinContext={accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmExploreInContextHdr",icon:"I_FindInContext",multisel:!0,text:M.ECM_CA_Command_ExploreContext,handler:function(e){r&&r.itemView&&r.itemView.Instanceid?u.DispatchEventToWin("ExploreinContext",r.itemView.Instanceid):u.DispatchEventToWin("ExploreinContext",I.ContextMenu.pid)}},"Referential"==e.where&&"true"!=d.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(I.ContextMenu.exploreinContext.icon=S.getWebappsAssetUrl("ENOChangeActionUX","images/I_FindInContext.png"))),UWA.is(I.ContextMenu.Open)||(I.ContextMenu.Open={accelerator:"Ctrl+O",availabilityMode:"Normal=YES CommandSet=YES Editability=YES SmallScale=YES LargeScale=YES ",id:"OpenFromCA",icon:"I_OpenDB",multisel:!0,text:M.ECM_CA_Command_Open,handler:function(e){u.DispatchEventToWin("Open",I.ContextMenu.pid)}},"Referential"==e.where&&"true"!=d.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(I.ContextMenu.Open.icon=S.getWebappsAssetUrl("ENOChangeActionUX","images/I_OpenDB.png"))),UWA.is(I.ContextMenu.OpenCA)||(I.ContextMenu.OpenCA={accelerator:"Ctrl+I",availabilityMode:"Normal=YES CommandSet=YES Editability=YES SmallScale=YES LargeScale=YES ",id:"OpenCAFromCA",icon:"I_OpenDB",multisel:!0,text:M.ECM_CA_Command_Open,handler:function(e){u.DispatchEventToWin("OpenCA",I.ContextMenu.pid)}},"Referential"==e.where&&"true"!=d.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(I.ContextMenu.OpenCA.icon=S.getWebappsAssetUrl("ENOChangeActionUX","images/I_OpenDB.png"))),UWA.is(I.ContextMenu.openAdv)||(I.ContextMenu.openAdv={accelerator:"Ctrl+Shift+O",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ENOVIA_Open_OpenAdvanced",icon:"I_OpenAdvDB",multisel:!0,text:M.ECM_CA_Command_OpenAdv,handler:function(e){u.DispatchEventToWin("OpenAdv",I.ContextMenu.pid)}},"Referential"==e.where&&"true"!=d.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(I.ContextMenu.openAdv.icon=S.getWebappsAssetUrl("ENOChangeActionUX","images/I_OpenAdvDB.png"))),UWA.is(I.ContextMenu.openRO)||(I.ContextMenu.openRO={accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ENOVIA_Open_OpenInSideWaySession",icon:"I_OpenInReadOnly",multisel:!0,text:M.ECM_CA_Command_OpenRO,handler:function(e){u.DispatchEventToWin("OpenReadOnly",I.ContextMenu.pid)}},"Referential"==e.where&&"true"!=d.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(I.ContextMenu.openRO.icon=S.getWebappsAssetUrl("ENOChangeActionUX","images/I_OpenInReadOnly.png"))),UWA.is(I.ContextMenu.Properties)||(I.ContextMenu.Properties={accelerator:"Alt+Enter",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ImmSearchProperty",icon:"I_Properties",multisel:!0,text:"Native_Properties",handler:function(e){u.DispatchEventToWin("Properties",I.ContextMenu.pid)}},"Referential"==e.where&&"true"!=d.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(I.ContextMenu.Properties.icon=S.getWebappsAssetUrl("ENOChangeActionUX","images/I_Properties.png")));var o={accelerator:"",availabilityMode:null,id:null,icon:null,items:I.GetSupportedExploreCommands(e),multisel:!0,text:M.ECM_CA_Command_ExploreWith},a={accelerator:"",availabilityMode:null,id:null,icon:null,items:I.GetSupportedOpenCommands(e),multisel:!0,text:M.ECM_CA_Command_OpenWith_RichClient};e.hasOwnProperty("explore")&&n.push(I.ContextMenu.explore),o.items.length>0&&n.push(o),e.hasOwnProperty("open")&&n.push(I.ContextMenu.Open),e.hasOwnProperty("openCA")&&n.push(I.ContextMenu.OpenCA),a.items.length>0&&n.push(a),"Resolution"===e.where?t.displayContextualMenuForSolutionItem(n):"FlowdownFrom"===e.where?t.displayContextualMenuForFlowdownForItem(n):"FlowdownFor"===e.where?t.displayContextualMenuForFlowdownFromItem(n):t.DisplayContextMenu(n)}},GetSupportedExploreCommands:function(e){var t=[];return["exploreInRFLP","exploreInPPR","exploreParents","exploreInMSB","exploreinContext"].forEach(function(i){e.hasOwnProperty(i)&&I.ContextMenu.hasOwnProperty(i)&&t.push(I.ContextMenu[i])}),t},GetSupportedOpenCommands:function(e){var t=[];return["exploreInCentral","openAdv","openRO"].forEach(function(i){e.hasOwnProperty(i)&&I.ContextMenu.hasOwnProperty(i)&&t.push(I.ContextMenu[i])}),t}};return I}),define("DS/ENOChangeActionUX/scripts/CAIDCard",["DS/W3DXComponents/IdCard","DS/ENOChangeActionUX/scripts/Views/CAIDCardView","DS/ENOChangeActionUX/scripts/Views/CANewTeamView","DS/ENOChangeActionUX/scripts/Views/CANewProposedView","DS/ENOChangeActionUX/scripts/Views/CARealizedView","DS/ENOChangeActionUX/scripts/Views/CAReferentialView","DS/ENOChangeActionUX/scripts/Views/CAContextView","DS/ENOChangeActionUX/scripts/Views/CATeamDataGridLayout","DS/ENOChangeActionUX/scripts/Views/CAApprovalsView","DS/ENOChangeActionUX/scripts/Views/CAContextDataGridLayout","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChangeActionUX/scripts/Views/CAViewCommon","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChangeActionUX/scripts/Models/CAModel","UWA/Core","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable"],function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g){"use strict";var f={CurrModel:null,FacetViews:[],getRendererMap:function(e,h){f.Flush(),f.skeletonContainer=m.extendElement(document.body).getElement("#skeleton-container");var C=[],v=0;C.push({name:v.toString(),text:u.ECM_CA_Properties,icon:"newspaper",handler:function(){var e=t._createView_IdCard("div","generic-detail",!0,this.model);f.BuildView(this.getSelectedFacet(),"IDCardView",e)}}),"true"==g.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(v++,C.push({name:v.toString(),text:u.ECM_CA_Team,icon:"users",handler:function(){f.BuildView(this.getSelectedFacet(),"TeamView",i)}})),"true"!=g.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(v++,C.push({name:v.toString(),text:u.ECM_CA_Team,icon:"users",handler:function(){f.BuildView(this.getSelectedFacet(),"TeamGridView",r)}})),v++,C.push({name:v.toString(),text:u.ECM_CA_ProposedChanges,icon:"change-action-proposed",handler:function(){var e=n._createView_TestProposed("div","test-proposed-facet",!0,this.model);f.BuildView(this.getSelectedFacet(),"ProposedView",e)}}),v++,C.push({name:v.toString(),text:u.ECM_CA_RealizedChanges,icon:"change-action-realized",handler:function(){var e={caModel:this.model},t=new o(e).buildRealizedView();f.BuildView(this.getSelectedFacet(),"RealizedView",t)}}),"true"==g.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(v++,C.push({name:v.toString(),text:u.ECM_CA_Referential_label,icon:"attach",handler:function(){var e=a._createView_Referential(!0,this.model);f.BuildView(this.getSelectedFacet(),"ReferentialView",e)}})),v++,C.push({name:v.toString(),text:u.ECM_CA_Approvals,icon:"status-ok",handler:function(){f.BuildView(this.getSelectedFacet(),"ApprovalsView",l)}}),"true"==g.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(v++,C.push({name:v.toString(),text:u.ECM_CA_Proposed_Change_Context,icon:"3d-object",handler:function(){f.BuildView(this.getSelectedFacet(),"ContextView",s)}})),"true"!=g.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(v++,C.push({name:v.toString(),text:u.ECM_CA_Proposed_Change_Context,icon:"3d-object",handler:function(){f.BuildView(this.getSelectedFacet(),"ContextGridView",c)}}));var A=g.getPreviewURLArray(),w="",b=h.transientCAPid.slice(4);null!=A&&A.hasOwnProperty(b)&&(w=A[b]);return w=""!=w&&null!=w?w:function(){return this.get("image")},{model:f.CreateModel(e,h.transientCAPid),thumbnailUrl:w,attributesMapping:{title:"title",ownerName:"ownerName",description:"lifecycleHTML"},actions:function(){if(null!=this.get("userAccess"))return p.getUserActions(this)},facets:C,events:{onRender:function(){console.info("<--- onRender ---\x3e")},onFacetSelect:function(e,t){"0"===e&&g.getGlobalVariable().PropWidget&&setTimeout(function(){g.getGlobalVariable().PropWidget.onResize()},100),2===(e=parseInt(e))&&g.getGlobalVariable().flowdownLinkClicked&&n.addProposedWithFlowdown(),t=parseInt(t),d.activateDeactiveTaggerProxies(e,t)}}}},CreateModel:function(e,t){var i=new h({id:t,lifecycleHTML:"<span id ='lifecycleSpan'></span>"});return i.fetch({}),f.CurrModel=i,i},BuildView:function(e,t,i){if(e=parseInt(e),f.HideAllViews(),f.FacetViews&&null==f.FacetViews[e]){var n=new UWA.Element("div");n.setAttributes({id:t}),n.setStyle("height","calc(100% - 150px)"),n.setStyle("flex-grow","1");var o=null;if("TeamView"===t||"DependencyView"===t)o=new i(a={model:f.CurrModel});else if("ContextView"===t)o=new i(a={physicalId:f.CurrModel.id});else if("ContextGridView"===t||"TeamGridView"===t||"ApprovalsView"===t){var a={caPhysicalId:f.CurrModel.id,target:n};n.setStyle("height","calc(100% - 166px)"),i.create(a)}else{(o=new i).model=f.CurrModel}"ContextView"===t?o.render().inject(n):"ContextGridView"!==t&&"TeamGridView"!==t&&"ApprovalsView"!==t&&(o.container=n,n.addContent(o.render())),f.FacetViews[e]=n,f.skeletonContainer.addContent(f.FacetViews[e])}else f.FacetViews&&null!=f.FacetViews[e]&&f.FacetViews[e].show()},HideAllViews:function(){f.FacetViews.forEach(function(e){UWA.is(e)&&e.hide()})},Flush:function(){f.FacetViews=[null,null,null,null,null,null,null,null]}};return f}),define("DS/ENOChangeActionUX/scripts/Services/CAIDCardServices",["UWA/Core","DS/W3DXComponents/IdCard","DS/PlatformAPI/PlatformAPI","DS/ENOChangeActionUX/scripts/CAIDCard","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable"],function(e,t,i,n,o){"use strict";return{getCAIDCard:function(a){this.caGlobalObject||(this.caGlobalObject=o.getGlobalVariable());var s=this._leftPanel=new UWA.createElement("div",{id:"skeleton-container",styles:{height:"100%",width:"100%",display:"flex","flex-direction":"column"}}),r=new UWA.createElement("div",{id:"layout-resizer-div",class:"layout-resizer"});this._rightResizer=r,this._resizeEventRegister();var l=this._rightPanel=new UWA.createElement("div",{id:"slidein-container",styles:{height:"100%",width:"0",position:"fixed",zIndex:"3",top:"0",right:"0",overflowX:"auto",borderLeft:"0 solid #d1d4d4",background:"white"}}),c=new UWA.createElement("div",{id:"main-container",styles:{height:"100%",width:"100%",display:"flex"}});s.inject(c),r.inject(c),l.inject(c),a.target?c.inject(a.target):c.inject(widget.body);s=e.extendElement(document.body).getElement("#skeleton-container");this.caGlobalObject.flowdownOptions=a;var d=new t(n.getRendererMap({},a));d.render().inject(s),a.isFromFlowDown?d.selectFacet(3):d.selectFacet(0),i.unsubscribe("flowdown:slidein:open"),o.getGlobalVariable().flowdownLinkClicked=!1,this.caGlobalObject.IDCard=d,this.caGlobalObject.IDCard.addEvent("onRefresh",function(){n.HideAllViews(),n.Flush()})},_resizeEventRegister:function(){var e=this;this._currentRight="540";var t=!1,i=null,n=null,o=function(o){i=e._currentRight,n=o.clientX?o.clientX:o.touches&&o.touches[0]?o.touches[0].clientX:0,t=!0,"touchstart"===o.type?(document.addEventListener("touchmove",a),document.addEventListener("touchend",s)):"mousedown"===o.type&&(document.addEventListener("mousemove",a),document.addEventListener("mouseup",s))},a=function(o){var a=o.clientX?o.clientX:o.touches&&o.touches[0]?o.touches[0].clientX:0,s=250;if(e._rightResizer.hasClassName("flowdown-proposed-slidein")&&(s=750),t){if(e._currentRight=+i+ +(n-a),e._currentRight=Math.max(e._currentRight,s),jQuery(".right-container")&&jQuery(".right-container")[0]){var r=jQuery(".right-container")[0].offsetWidth-150;e._currentRight=Math.min(e._currentRight,r)}e._resizePanels()}},s=function(n){t=!1,i=e._currentRight,"touchend"===n.type?(document.removeEventListener("touchmove",a),document.removeEventListener("touchend",s)):"mouseup"===n.type&&(document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",s))};this._rightResizer.addEventListener("mousedown",o),this._rightResizer.addEventListener("touchstart",o)},_resizePanels:function(){this._rightResizer.setStyle("right",this._currentRight),this._rightPanel.setStyle("width",this._currentRight);var e="calc( 100% - "+this._currentRight+"px )";this._leftPanel.setStyle("width",e)}}});